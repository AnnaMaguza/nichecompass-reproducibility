[True]
Run timestamp: 07092023_153734_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6976; val_auprc_score: 0.6691; val_best_acc_score: 0.5078; val_best_f1_score: 0.6699; train_kl_reg_loss: 67550.9389; train_edge_recon_loss: 3535446.9280; train_gene_expr_recon_loss: 20600712.2121; train_masked_gp_l1_reg_loss: 62193.3906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 861646.6828; train_chrom_access_recon_loss: 2640207.3295; train_global_loss: 27767757.3333; train_optim_loss: 27767757.3333; val_kl_reg_loss: 101602.6074; val_edge_recon_loss: 4064506.4375; val_gene_expr_recon_loss: 19004136.7500; val_masked_gp_l1_reg_loss: 57284.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 713657.2500; val_chrom_access_recon_loss: 2577638.6875; val_global_loss: 26518827.0000; val_optim_loss: 26518827.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7234; val_auprc_score: 0.7084; val_best_acc_score: 0.5948; val_best_f1_score: 0.6991; train_kl_reg_loss: 116818.9463; train_edge_recon_loss: 3537594.6932; train_gene_expr_recon_loss: 18803619.7273; train_masked_gp_l1_reg_loss: 53746.9685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 574192.2879; train_chrom_access_recon_loss: 2502590.4091; train_global_loss: 25588563.0909; train_optim_loss: 25588563.0909; val_kl_reg_loss: 115135.8535; val_edge_recon_loss: 4059844.1250; val_gene_expr_recon_loss: 18571027.7500; val_masked_gp_l1_reg_loss: 52295.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 447082.2188; val_chrom_access_recon_loss: 2509789.0000; val_global_loss: 25755174.5000; val_optim_loss: 25755174.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8163; val_auprc_score: 0.7925; val_best_acc_score: 0.7456; val_best_f1_score: 0.7318; train_kl_reg_loss: 102890.1094; train_edge_recon_loss: 3526706.0417; train_gene_expr_recon_loss: 18557882.9697; train_masked_gp_l1_reg_loss: 53277.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 359889.6586; train_chrom_access_recon_loss: 2480117.5455; train_global_loss: 25080763.6364; train_optim_loss: 25080763.6364; val_kl_reg_loss: 89735.6084; val_edge_recon_loss: 4001465.4062; val_gene_expr_recon_loss: 18355535.7500; val_masked_gp_l1_reg_loss: 54976.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 286994.6562; val_chrom_access_recon_loss: 2495327.5312; val_global_loss: 25284034.5000; val_optim_loss: 25284034.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8520; val_auprc_score: 0.8222; val_best_acc_score: 0.7762; val_best_f1_score: 0.7976; train_kl_reg_loss: 85027.3674; train_edge_recon_loss: 3487243.4015; train_gene_expr_recon_loss: 18406483.1515; train_masked_gp_l1_reg_loss: 56710.7318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239694.3956; train_chrom_access_recon_loss: 2467067.1932; train_global_loss: 24742226.4242; train_optim_loss: 24742226.4242; val_kl_reg_loss: 69088.6553; val_edge_recon_loss: 3708195.2188; val_gene_expr_recon_loss: 18348090.2500; val_masked_gp_l1_reg_loss: 58418.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 198359.6250; val_chrom_access_recon_loss: 2501535.6250; val_global_loss: 24883687.5000; val_optim_loss: 24883687.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8485; val_auprc_score: 0.8105; val_best_acc_score: 0.7722; val_best_f1_score: 0.7943; train_kl_reg_loss: 73920.5060; train_edge_recon_loss: 3187992.3674; train_gene_expr_recon_loss: 18300862.6061; train_masked_gp_l1_reg_loss: 59988.1012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169745.4808; train_chrom_access_recon_loss: 2456407.2614; train_global_loss: 24248916.2727; train_optim_loss: 24248916.2727; val_kl_reg_loss: 96675.6914; val_edge_recon_loss: 3014946.8750; val_gene_expr_recon_loss: 18109422.5000; val_masked_gp_l1_reg_loss: 61596.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144901.5000; val_chrom_access_recon_loss: 2467439.5625; val_global_loss: 23894982.7500; val_optim_loss: 23894982.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8662; val_auprc_score: 0.8278; val_best_acc_score: 0.7969; val_best_f1_score: 0.8075; train_kl_reg_loss: 101914.5762; train_edge_recon_loss: 2953940.6326; train_gene_expr_recon_loss: 18181922.2727; train_masked_gp_l1_reg_loss: 62210.6234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126235.4647; train_chrom_access_recon_loss: 2438267.8371; train_global_loss: 23864491.4848; train_optim_loss: 23864491.4848; val_kl_reg_loss: 102910.4277; val_edge_recon_loss: 3000634.9062; val_gene_expr_recon_loss: 18046489.7500; val_masked_gp_l1_reg_loss: 63163.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110117.6641; val_chrom_access_recon_loss: 2479349.9062; val_global_loss: 23802667.0000; val_optim_loss: 23802667.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8937; val_auprc_score: 0.8562; val_best_acc_score: 0.8240; val_best_f1_score: 0.8336; train_kl_reg_loss: 99079.8324; train_edge_recon_loss: 2940556.5795; train_gene_expr_recon_loss: 18065631.1212; train_masked_gp_l1_reg_loss: 64177.2855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98002.0563; train_chrom_access_recon_loss: 2427081.5606; train_global_loss: 23694528.6061; train_optim_loss: 23694528.6061; val_kl_reg_loss: 93708.7939; val_edge_recon_loss: 2888492.5312; val_gene_expr_recon_loss: 17931591.7500; val_masked_gp_l1_reg_loss: 65312.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87475.8281; val_chrom_access_recon_loss: 2454725.4688; val_global_loss: 23521306.7500; val_optim_loss: 23521306.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9012; val_auprc_score: 0.8709; val_best_acc_score: 0.8326; val_best_f1_score: 0.8432; train_kl_reg_loss: 96856.0447; train_edge_recon_loss: 2874540.2235; train_gene_expr_recon_loss: 17974843.0000; train_masked_gp_l1_reg_loss: 66310.5103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79251.1906; train_chrom_access_recon_loss: 2413314.8939; train_global_loss: 23505115.6970; train_optim_loss: 23505115.6970; val_kl_reg_loss: 96785.9414; val_edge_recon_loss: 2874385.4688; val_gene_expr_recon_loss: 17913299.2500; val_masked_gp_l1_reg_loss: 67473.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71852.3516; val_chrom_access_recon_loss: 2457065.0312; val_global_loss: 23480861.5000; val_optim_loss: 23480861.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9085; val_auprc_score: 0.8835; val_best_acc_score: 0.8391; val_best_f1_score: 0.8486; train_kl_reg_loss: 100534.1862; train_edge_recon_loss: 2828015.1970; train_gene_expr_recon_loss: 17898445.0303; train_masked_gp_l1_reg_loss: 68468.0562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65935.4970; train_chrom_access_recon_loss: 2406667.7311; train_global_loss: 23368065.7879; train_optim_loss: 23368065.7879; val_kl_reg_loss: 99330.1084; val_edge_recon_loss: 2861673.3438; val_gene_expr_recon_loss: 17728142.0000; val_masked_gp_l1_reg_loss: 69405.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60586.9883; val_chrom_access_recon_loss: 2425000.7188; val_global_loss: 23244138.2500; val_optim_loss: 23244138.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9025; val_auprc_score: 0.8712; val_best_acc_score: 0.8334; val_best_f1_score: 0.8493; train_kl_reg_loss: 101203.4992; train_edge_recon_loss: 2814896.8750; train_gene_expr_recon_loss: 17804853.8485; train_masked_gp_l1_reg_loss: 70395.8950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56300.8911; train_chrom_access_recon_loss: 2394949.6326; train_global_loss: 23242600.6667; train_optim_loss: 23242600.6667; val_kl_reg_loss: 99629.5732; val_edge_recon_loss: 2863240.5938; val_gene_expr_recon_loss: 17756590.0000; val_masked_gp_l1_reg_loss: 71428.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52642.7305; val_chrom_access_recon_loss: 2414905.6562; val_global_loss: 23258436.0000; val_optim_loss: 23258436.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9165; val_auprc_score: 0.8891; val_best_acc_score: 0.8493; val_best_f1_score: 0.8570; train_kl_reg_loss: 97553.6315; train_edge_recon_loss: 2800334.2159; train_gene_expr_recon_loss: 17736883.9697; train_masked_gp_l1_reg_loss: 72210.0509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49348.2814; train_chrom_access_recon_loss: 2385852.7121; train_global_loss: 23142182.6667; train_optim_loss: 23142182.6667; val_kl_reg_loss: 94734.3447; val_edge_recon_loss: 2837841.6250; val_gene_expr_recon_loss: 17707665.2500; val_masked_gp_l1_reg_loss: 73264.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46700.9062; val_chrom_access_recon_loss: 2422476.0312; val_global_loss: 23182680.7500; val_optim_loss: 23182680.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9243; val_auprc_score: 0.8965; val_best_acc_score: 0.8692; val_best_f1_score: 0.8762; train_kl_reg_loss: 97976.8350; train_edge_recon_loss: 2794341.0568; train_gene_expr_recon_loss: 17664539.5000; train_masked_gp_l1_reg_loss: 73990.0476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44422.4174; train_chrom_access_recon_loss: 2374771.2727; train_global_loss: 23050041.0303; train_optim_loss: 23050041.0303; val_kl_reg_loss: 94687.3496; val_edge_recon_loss: 2791382.5938; val_gene_expr_recon_loss: 17603114.0000; val_masked_gp_l1_reg_loss: 74679.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42171.4062; val_chrom_access_recon_loss: 2419777.1250; val_global_loss: 23025812.5000; val_optim_loss: 23025812.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9261; val_auprc_score: 0.8983; val_best_acc_score: 0.8673; val_best_f1_score: 0.8743; train_kl_reg_loss: 96274.7408; train_edge_recon_loss: 2783036.5530; train_gene_expr_recon_loss: 17594890.6667; train_masked_gp_l1_reg_loss: 75528.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40823.1283; train_chrom_access_recon_loss: 2368453.4205; train_global_loss: 22959006.8182; train_optim_loss: 22959006.8182; val_kl_reg_loss: 96005.8359; val_edge_recon_loss: 2787765.1562; val_gene_expr_recon_loss: 17666907.2500; val_masked_gp_l1_reg_loss: 76343.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39574.7305; val_chrom_access_recon_loss: 2435864.5625; val_global_loss: 23102460.7500; val_optim_loss: 23102460.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9229; val_auprc_score: 0.8963; val_best_acc_score: 0.8651; val_best_f1_score: 0.8706; train_kl_reg_loss: 94714.5831; train_edge_recon_loss: 2764245.8409; train_gene_expr_recon_loss: 17544233.1515; train_masked_gp_l1_reg_loss: 77188.3772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38477.7384; train_chrom_access_recon_loss: 2361930.4432; train_global_loss: 22880790.2727; train_optim_loss: 22880790.2727; val_kl_reg_loss: 93412.1094; val_edge_recon_loss: 2827230.9375; val_gene_expr_recon_loss: 17465924.6250; val_masked_gp_l1_reg_loss: 78058.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37506.3906; val_chrom_access_recon_loss: 2401812.2812; val_global_loss: 22903944.2500; val_optim_loss: 22903944.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9273; val_auprc_score: 0.9039; val_best_acc_score: 0.8665; val_best_f1_score: 0.8749; train_kl_reg_loss: 93947.4022; train_edge_recon_loss: 2757507.2462; train_gene_expr_recon_loss: 17490497.2879; train_masked_gp_l1_reg_loss: 78547.3770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36559.7035; train_chrom_access_recon_loss: 2354754.5455; train_global_loss: 22811813.6061; train_optim_loss: 22811813.6061; val_kl_reg_loss: 91867.9297; val_edge_recon_loss: 2803233.2500; val_gene_expr_recon_loss: 17529966.0000; val_masked_gp_l1_reg_loss: 79223.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36186.5000; val_chrom_access_recon_loss: 2412651.5938; val_global_loss: 22953129.2500; val_optim_loss: 22953129.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9377; val_auprc_score: 0.9173; val_best_acc_score: 0.8807; val_best_f1_score: 0.8874; train_kl_reg_loss: 92845.9064; train_edge_recon_loss: 2738722.5076; train_gene_expr_recon_loss: 17447256.6667; train_masked_gp_l1_reg_loss: 79897.9420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35479.9105; train_chrom_access_recon_loss: 2347773.2992; train_global_loss: 22741976.3030; train_optim_loss: 22741976.3030; val_kl_reg_loss: 96047.2988; val_edge_recon_loss: 2751861.7500; val_gene_expr_recon_loss: 17204426.6250; val_masked_gp_l1_reg_loss: 80552.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34773.9570; val_chrom_access_recon_loss: 2357673.4062; val_global_loss: 22525335.2500; val_optim_loss: 22525335.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9354; val_auprc_score: 0.9112; val_best_acc_score: 0.8726; val_best_f1_score: 0.8791; train_kl_reg_loss: 91895.7952; train_edge_recon_loss: 2743925.0720; train_gene_expr_recon_loss: 17377857.8636; train_masked_gp_l1_reg_loss: 81118.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34208.8101; train_chrom_access_recon_loss: 2339211.2008; train_global_loss: 22668216.8788; train_optim_loss: 22668216.8788; val_kl_reg_loss: 94136.0518; val_edge_recon_loss: 2776885.3750; val_gene_expr_recon_loss: 17426603.0000; val_masked_gp_l1_reg_loss: 81806.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33955.7969; val_chrom_access_recon_loss: 2403018.5938; val_global_loss: 22816405.5000; val_optim_loss: 22816405.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9339; val_auprc_score: 0.9099; val_best_acc_score: 0.8794; val_best_f1_score: 0.8853; train_kl_reg_loss: 90328.0125; train_edge_recon_loss: 2738179.9015; train_gene_expr_recon_loss: 17339751.6061; train_masked_gp_l1_reg_loss: 82397.3349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33440.2195; train_chrom_access_recon_loss: 2332988.5909; train_global_loss: 22617085.5758; train_optim_loss: 22617085.5758; val_kl_reg_loss: 90372.2480; val_edge_recon_loss: 2777973.1250; val_gene_expr_recon_loss: 17353076.2500; val_masked_gp_l1_reg_loss: 82999.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33188.4023; val_chrom_access_recon_loss: 2380724.9688; val_global_loss: 22718334.7500; val_optim_loss: 22718334.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9341; val_auprc_score: 0.9126; val_best_acc_score: 0.8740; val_best_f1_score: 0.8814; train_kl_reg_loss: 87577.0780; train_edge_recon_loss: 2736822.2045; train_gene_expr_recon_loss: 17277362.2273; train_masked_gp_l1_reg_loss: 83626.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32688.3749; train_chrom_access_recon_loss: 2325831.0795; train_global_loss: 22543908.0000; train_optim_loss: 22543908.0000; val_kl_reg_loss: 89488.7480; val_edge_recon_loss: 2809881.3125; val_gene_expr_recon_loss: 17267546.0000; val_masked_gp_l1_reg_loss: 84305.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32556.7070; val_chrom_access_recon_loss: 2395323.6562; val_global_loss: 22679102.0000; val_optim_loss: 22679102.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9406; val_auprc_score: 0.9200; val_best_acc_score: 0.8837; val_best_f1_score: 0.8898; train_kl_reg_loss: 86851.4994; train_edge_recon_loss: 2721989.4280; train_gene_expr_recon_loss: 17247264.2273; train_masked_gp_l1_reg_loss: 84756.4066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32210.7910; train_chrom_access_recon_loss: 2321111.5606; train_global_loss: 22494183.8788; train_optim_loss: 22494183.8788; val_kl_reg_loss: 86726.4307; val_edge_recon_loss: 2770350.5000; val_gene_expr_recon_loss: 17182552.7500; val_masked_gp_l1_reg_loss: 85377.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32244.7715; val_chrom_access_recon_loss: 2369151.9688; val_global_loss: 22526403.7500; val_optim_loss: 22526403.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9394; val_auprc_score: 0.9133; val_best_acc_score: 0.8872; val_best_f1_score: 0.8943; train_kl_reg_loss: 85617.2728; train_edge_recon_loss: 2735967.6364; train_gene_expr_recon_loss: 17200341.7879; train_masked_gp_l1_reg_loss: 84326.8076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27877.2406; train_chrom_access_recon_loss: 2315141.6288; train_global_loss: 22449272.2727; train_optim_loss: 22449272.2727; val_kl_reg_loss: 87864.0107; val_edge_recon_loss: 2737122.7812; val_gene_expr_recon_loss: 17194931.7500; val_masked_gp_l1_reg_loss: 83765.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25888.4805; val_chrom_access_recon_loss: 2369465.7188; val_global_loss: 22499038.5000; val_optim_loss: 22499038.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9426; val_auprc_score: 0.9199; val_best_acc_score: 0.8888; val_best_f1_score: 0.8952; train_kl_reg_loss: 88137.2754; train_edge_recon_loss: 2709242.4659; train_gene_expr_recon_loss: 17205816.9697; train_masked_gp_l1_reg_loss: 83643.4036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25570.6915; train_chrom_access_recon_loss: 2316634.7197; train_global_loss: 22429045.5152; train_optim_loss: 22429045.5152; val_kl_reg_loss: 89235.2793; val_edge_recon_loss: 2752826.5625; val_gene_expr_recon_loss: 17286144.3750; val_masked_gp_l1_reg_loss: 83590.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25395.3672; val_chrom_access_recon_loss: 2361480.1875; val_global_loss: 22598672.5000; val_optim_loss: 22598672.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9417; val_auprc_score: 0.9166; val_best_acc_score: 0.8877; val_best_f1_score: 0.8938; train_kl_reg_loss: 88729.0765; train_edge_recon_loss: 2712828.1818; train_gene_expr_recon_loss: 17200188.5455; train_masked_gp_l1_reg_loss: 83575.2433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25287.9716; train_chrom_access_recon_loss: 2315049.9242; train_global_loss: 22425659.0909; train_optim_loss: 22425659.0909; val_kl_reg_loss: 89468.6055; val_edge_recon_loss: 2753742.3750; val_gene_expr_recon_loss: 17128407.5000; val_masked_gp_l1_reg_loss: 83597.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25259.8672; val_chrom_access_recon_loss: 2358312.4688; val_global_loss: 22438789.2500; val_optim_loss: 22438789.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9429; val_auprc_score: 0.9144; val_best_acc_score: 0.8933; val_best_f1_score: 0.9002; train_kl_reg_loss: 89612.8436; train_edge_recon_loss: 2719625.9773; train_gene_expr_recon_loss: 17190595.0303; train_masked_gp_l1_reg_loss: 83611.9921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25165.4081; train_chrom_access_recon_loss: 2312827.7197; train_global_loss: 22421438.8788; train_optim_loss: 22421438.8788; val_kl_reg_loss: 89762.3291; val_edge_recon_loss: 2723487.7812; val_gene_expr_recon_loss: 17101400.0000; val_masked_gp_l1_reg_loss: 83660.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25154.1016; val_chrom_access_recon_loss: 2356093.6562; val_global_loss: 22379558.0000; val_optim_loss: 22379558.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9473; val_auprc_score: 0.9308; val_best_acc_score: 0.8880; val_best_f1_score: 0.8945; train_kl_reg_loss: 88245.2500; train_edge_recon_loss: 2712963.2348; train_gene_expr_recon_loss: 17183776.5606; train_masked_gp_l1_reg_loss: 83697.5608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25073.2405; train_chrom_access_recon_loss: 2314013.9091; train_global_loss: 22407769.6667; train_optim_loss: 22407769.6667; val_kl_reg_loss: 87657.9482; val_edge_recon_loss: 2734608.2188; val_gene_expr_recon_loss: 17243480.0000; val_masked_gp_l1_reg_loss: 83746.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25045.2148; val_chrom_access_recon_loss: 2363572.0625; val_global_loss: 22538110.2500; val_optim_loss: 22538110.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9452; val_auprc_score: 0.9278; val_best_acc_score: 0.8847; val_best_f1_score: 0.8893; train_kl_reg_loss: 100106.7884; train_edge_recon_loss: 2773603.2917; train_gene_expr_recon_loss: 17064197.3182; train_masked_gp_l1_reg_loss: 83508.8207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23954.8242; train_chrom_access_recon_loss: 2357672.8674; train_global_loss: 22403043.8182; train_optim_loss: 22403043.8182; val_kl_reg_loss: 60364.6001; val_edge_recon_loss: 2809654.8750; val_gene_expr_recon_loss: 16827589.5000; val_masked_gp_l1_reg_loss: 83411.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23106.2148; val_chrom_access_recon_loss: 2343532.7188; val_global_loss: 22147659.2500; val_optim_loss: 22147659.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9388; val_auprc_score: 0.9144; val_best_acc_score: 0.8780; val_best_f1_score: 0.8867; train_kl_reg_loss: 105265.1655; train_edge_recon_loss: 2752744.3371; train_gene_expr_recon_loss: 16853952.1515; train_masked_gp_l1_reg_loss: 83419.4379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22810.1304; train_chrom_access_recon_loss: 2290636.9091; train_global_loss: 22108827.9394; train_optim_loss: 22108827.9394; val_kl_reg_loss: 61013.9141; val_edge_recon_loss: 2799317.7188; val_gene_expr_recon_loss: 16826888.6250; val_masked_gp_l1_reg_loss: 83422.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22583.9004; val_chrom_access_recon_loss: 2301131.9375; val_global_loss: 22094358.0000; val_optim_loss: 22094358.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9413; val_auprc_score: 0.9170; val_best_acc_score: 0.8855; val_best_f1_score: 0.8924; train_kl_reg_loss: 104928.0273; train_edge_recon_loss: 2766952.7803; train_gene_expr_recon_loss: 16835415.3939; train_masked_gp_l1_reg_loss: 83444.5843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22425.5207; train_chrom_access_recon_loss: 2280466.7235; train_global_loss: 22093633.0303; train_optim_loss: 22093633.0303; val_kl_reg_loss: 61579.7891; val_edge_recon_loss: 2768152.2812; val_gene_expr_recon_loss: 16836429.7500; val_masked_gp_l1_reg_loss: 83464.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22260.0195; val_chrom_access_recon_loss: 2322938.1250; val_global_loss: 22094823.7500; val_optim_loss: 22094823.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9441; val_auprc_score: 0.9224; val_best_acc_score: 0.8869; val_best_f1_score: 0.8941; train_kl_reg_loss: 104797.4466; train_edge_recon_loss: 2754991.0720; train_gene_expr_recon_loss: 16802348.9545; train_masked_gp_l1_reg_loss: 83483.5004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22123.5839; train_chrom_access_recon_loss: 2277518.6629; train_global_loss: 22045263.1515; train_optim_loss: 22045263.1515; val_kl_reg_loss: 63461.8394; val_edge_recon_loss: 2782901.6562; val_gene_expr_recon_loss: 16633648.8750; val_masked_gp_l1_reg_loss: 83503.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21969.0195; val_chrom_access_recon_loss: 2284924.2344; val_global_loss: 21870410.5000; val_optim_loss: 21870410.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9458; val_auprc_score: 0.9244; val_best_acc_score: 0.8880; val_best_f1_score: 0.8941; train_kl_reg_loss: 104025.2934; train_edge_recon_loss: 2754546.8485; train_gene_expr_recon_loss: 16762538.0909; train_masked_gp_l1_reg_loss: 83539.0914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21830.8212; train_chrom_access_recon_loss: 2273103.4962; train_global_loss: 21999583.4242; train_optim_loss: 21999583.4242; val_kl_reg_loss: 63749.3716; val_edge_recon_loss: 2768320.7500; val_gene_expr_recon_loss: 16665018.2500; val_masked_gp_l1_reg_loss: 83565.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21690.9004; val_chrom_access_recon_loss: 2289845.9062; val_global_loss: 21892190.5000; val_optim_loss: 21892190.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9398; val_auprc_score: 0.9182; val_best_acc_score: 0.8807; val_best_f1_score: 0.8874; train_kl_reg_loss: 103572.3905; train_edge_recon_loss: 2745133.7841; train_gene_expr_recon_loss: 16743849.8182; train_masked_gp_l1_reg_loss: 83594.2417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21570.4526; train_chrom_access_recon_loss: 2270645.4394; train_global_loss: 21968365.9697; train_optim_loss: 21968365.9697; val_kl_reg_loss: 64026.0327; val_edge_recon_loss: 2806963.5625; val_gene_expr_recon_loss: 16765433.0000; val_masked_gp_l1_reg_loss: 83621.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21438.5098; val_chrom_access_recon_loss: 2312353.8750; val_global_loss: 22053836.5000; val_optim_loss: 22053836.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9429; val_auprc_score: 0.9235; val_best_acc_score: 0.8837; val_best_f1_score: 0.8903; train_kl_reg_loss: 102725.1165; train_edge_recon_loss: 2746495.5530; train_gene_expr_recon_loss: 16738009.6515; train_masked_gp_l1_reg_loss: 83647.1558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21330.5834; train_chrom_access_recon_loss: 2269436.3258; train_global_loss: 21961644.1818; train_optim_loss: 21961644.1818; val_kl_reg_loss: 64328.3320; val_edge_recon_loss: 2776609.5938; val_gene_expr_recon_loss: 16618107.5000; val_masked_gp_l1_reg_loss: 83669.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21202.5703; val_chrom_access_recon_loss: 2309129.9375; val_global_loss: 21873047.7500; val_optim_loss: 21873047.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9461; val_auprc_score: 0.9247; val_best_acc_score: 0.8880; val_best_f1_score: 0.8930; train_kl_reg_loss: 101360.1921; train_edge_recon_loss: 2744914.2311; train_gene_expr_recon_loss: 16731873.5455; train_masked_gp_l1_reg_loss: 83703.7369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21097.9302; train_chrom_access_recon_loss: 2268738.0076; train_global_loss: 21951687.4848; train_optim_loss: 21951687.4848; val_kl_reg_loss: 64378.9204; val_edge_recon_loss: 2769374.7812; val_gene_expr_recon_loss: 16717746.3750; val_masked_gp_l1_reg_loss: 83732.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20990.5195; val_chrom_access_recon_loss: 2325082.0625; val_global_loss: 21981304.2500; val_optim_loss: 21981304.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9438; val_auprc_score: 0.9217; val_best_acc_score: 0.8877; val_best_f1_score: 0.8944; train_kl_reg_loss: 100731.3823; train_edge_recon_loss: 2744767.7879; train_gene_expr_recon_loss: 16728242.2424; train_masked_gp_l1_reg_loss: 83702.7660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20866.4929; train_chrom_access_recon_loss: 2267964.2576; train_global_loss: 21946274.9697; train_optim_loss: 21946274.9697; val_kl_reg_loss: 64585.1030; val_edge_recon_loss: 2761099.0000; val_gene_expr_recon_loss: 16722788.6250; val_masked_gp_l1_reg_loss: 83686.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20832.8711; val_chrom_access_recon_loss: 2299002.2188; val_global_loss: 21951993.0000; val_optim_loss: 21951993.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9442; val_auprc_score: 0.9266; val_best_acc_score: 0.8810; val_best_f1_score: 0.8875; train_kl_reg_loss: 101023.0752; train_edge_recon_loss: 2742185.9545; train_gene_expr_recon_loss: 16723601.6212; train_masked_gp_l1_reg_loss: 83680.2785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20819.8145; train_chrom_access_recon_loss: 2267479.5606; train_global_loss: 21938790.4242; train_optim_loss: 21938790.4242; val_kl_reg_loss: 64563.2495; val_edge_recon_loss: 2785875.0312; val_gene_expr_recon_loss: 16726818.2500; val_masked_gp_l1_reg_loss: 83676.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20806.7441; val_chrom_access_recon_loss: 2325471.5938; val_global_loss: 22007210.0000; val_optim_loss: 22007210.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9446; val_auprc_score: 0.9263; val_best_acc_score: 0.8837; val_best_f1_score: 0.8907; train_kl_reg_loss: 100767.4986; train_edge_recon_loss: 2741246.0076; train_gene_expr_recon_loss: 16714624.4242; train_masked_gp_l1_reg_loss: 83675.1841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20794.7469; train_chrom_access_recon_loss: 2264937.3333; train_global_loss: 21926044.8485; train_optim_loss: 21926044.8485; val_kl_reg_loss: 65016.4194; val_edge_recon_loss: 2797367.9375; val_gene_expr_recon_loss: 16807404.2500; val_masked_gp_l1_reg_loss: 83672.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20781.6992; val_chrom_access_recon_loss: 2327258.8438; val_global_loss: 22101502.0000; val_optim_loss: 22101502.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9428; val_auprc_score: 0.9206; val_best_acc_score: 0.8898; val_best_f1_score: 0.8964; train_kl_reg_loss: 101062.2425; train_edge_recon_loss: 2744451.8712; train_gene_expr_recon_loss: 16717153.1061; train_masked_gp_l1_reg_loss: 83673.1753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20770.3859; train_chrom_access_recon_loss: 2267660.2917; train_global_loss: 21934771.2121; train_optim_loss: 21934771.2121; val_kl_reg_loss: 65026.8257; val_edge_recon_loss: 2758059.7188; val_gene_expr_recon_loss: 16906587.5000; val_masked_gp_l1_reg_loss: 83672.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20758.7129; val_chrom_access_recon_loss: 2315038.3750; val_global_loss: 22149142.5000; val_optim_loss: 22149142.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 58 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9422
val AUPRC score: 0.9264
val best accuracy score: 0.8810
val best F1 score: 0.8881
val target rna MSE score: 2.4764
val source rna MSE score: 0.8989
val target atac MSE score: 0.5003
val source atac MSE score: 0.1126
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
