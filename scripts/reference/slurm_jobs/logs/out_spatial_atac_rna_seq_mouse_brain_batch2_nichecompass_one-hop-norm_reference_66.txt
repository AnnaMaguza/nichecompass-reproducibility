[True]
Run timestamp: 26072023_022138_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9635; val_auprc_score: 0.9645; val_best_acc_score: 0.6533; val_best_f1_score: 0.7420; train_kl_reg_loss: 2617.7082; train_edge_recon_loss: 3472211.5278; train_gene_expr_recon_loss: 319122.1875; train_masked_gp_l1_reg_loss: 1590.3919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10837499.8889; train_global_loss: 14633041.6667; train_optim_loss: 14633041.6667; val_kl_reg_loss: 5332.1001; val_edge_recon_loss: 4057676.5000; val_gene_expr_recon_loss: 311297.0000; val_masked_gp_l1_reg_loss: 1360.9121; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10756521.0000; val_global_loss: 15132188.0000; val_optim_loss: 15132188.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9367; val_auprc_score: 0.9393; val_best_acc_score: 0.5703; val_best_f1_score: 0.6993; train_kl_reg_loss: 22607.8700; train_edge_recon_loss: 3487717.3056; train_gene_expr_recon_loss: 298809.3924; train_masked_gp_l1_reg_loss: 1318.8317; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10593821.4444; train_global_loss: 14404274.6667; train_optim_loss: 14404274.6667; val_kl_reg_loss: 36915.3750; val_edge_recon_loss: 4061353.2500; val_gene_expr_recon_loss: 282947.8750; val_masked_gp_l1_reg_loss: 1322.2820; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10503818.0000; val_global_loss: 14886357.0000; val_optim_loss: 14886357.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9219; val_auprc_score: 0.9210; val_best_acc_score: 0.6122; val_best_f1_score: 0.7204; train_kl_reg_loss: 48794.8316; train_edge_recon_loss: 3505710.2500; train_gene_expr_recon_loss: 274781.6111; train_masked_gp_l1_reg_loss: 1391.7729; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10409319.0000; train_global_loss: 14239997.4444; train_optim_loss: 14239997.4444; val_kl_reg_loss: 41127.1641; val_edge_recon_loss: 4059522.2500; val_gene_expr_recon_loss: 263906.8125; val_masked_gp_l1_reg_loss: 1486.1648; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10300934.0000; val_global_loss: 14666976.0000; val_optim_loss: 14666976.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9140; val_auprc_score: 0.9086; val_best_acc_score: 0.6726; val_best_f1_score: 0.7521; train_kl_reg_loss: 64293.2409; train_edge_recon_loss: 3514834.6111; train_gene_expr_recon_loss: 255480.6667; train_masked_gp_l1_reg_loss: 1541.1820; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10202174.1111; train_global_loss: 14038323.8889; train_optim_loss: 14038323.8889; val_kl_reg_loss: 52662.2656; val_edge_recon_loss: 4055861.0000; val_gene_expr_recon_loss: 248853.4219; val_masked_gp_l1_reg_loss: 1589.2413; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10139681.0000; val_global_loss: 14498646.0000; val_optim_loss: 14498646.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9058; val_auprc_score: 0.8993; val_best_acc_score: 0.7425; val_best_f1_score: 0.7916; train_kl_reg_loss: 75552.6771; train_edge_recon_loss: 3520813.5833; train_gene_expr_recon_loss: 244617.6806; train_masked_gp_l1_reg_loss: 1610.3455; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10107469.4444; train_global_loss: 13950063.8889; train_optim_loss: 13950063.8889; val_kl_reg_loss: 67856.0625; val_edge_recon_loss: 4049196.2500; val_gene_expr_recon_loss: 239871.8750; val_masked_gp_l1_reg_loss: 1627.7158; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10034049.0000; val_global_loss: 14392600.0000; val_optim_loss: 14392600.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8886; val_auprc_score: 0.8766; val_best_acc_score: 0.7906; val_best_f1_score: 0.8133; train_kl_reg_loss: 82976.0833; train_edge_recon_loss: 3518601.8056; train_gene_expr_recon_loss: 236308.9931; train_masked_gp_l1_reg_loss: 1636.3645; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9944766.0000; train_global_loss: 13784289.3333; train_optim_loss: 13784289.3333; val_kl_reg_loss: 60268.1797; val_edge_recon_loss: 4028353.7500; val_gene_expr_recon_loss: 235252.2656; val_masked_gp_l1_reg_loss: 1639.5227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9951150.0000; val_global_loss: 14276664.0000; val_optim_loss: 14276664.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8833; val_auprc_score: 0.8738; val_best_acc_score: 0.7879; val_best_f1_score: 0.7866; train_kl_reg_loss: 79770.5443; train_edge_recon_loss: 3515276.2500; train_gene_expr_recon_loss: 233474.1250; train_masked_gp_l1_reg_loss: 1643.9591; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9894248.3333; train_global_loss: 13724413.0000; train_optim_loss: 13724413.0000; val_kl_reg_loss: 63293.5781; val_edge_recon_loss: 3967281.5000; val_gene_expr_recon_loss: 231715.2812; val_masked_gp_l1_reg_loss: 1646.0281; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9921077.0000; val_global_loss: 14185014.0000; val_optim_loss: 14185014.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8838; val_auprc_score: 0.8645; val_best_acc_score: 0.8029; val_best_f1_score: 0.8144; train_kl_reg_loss: 73505.3720; train_edge_recon_loss: 3489665.5556; train_gene_expr_recon_loss: 227485.9132; train_masked_gp_l1_reg_loss: 1655.0366; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9796858.6667; train_global_loss: 13589170.6667; train_optim_loss: 13589170.6667; val_kl_reg_loss: 55118.0469; val_edge_recon_loss: 3708181.5000; val_gene_expr_recon_loss: 231196.1406; val_masked_gp_l1_reg_loss: 1660.1390; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9912059.0000; val_global_loss: 13908215.0000; val_optim_loss: 13908215.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8723; val_auprc_score: 0.8535; val_best_acc_score: 0.7855; val_best_f1_score: 0.8071; train_kl_reg_loss: 54048.8147; train_edge_recon_loss: 3318374.8056; train_gene_expr_recon_loss: 230221.4010; train_masked_gp_l1_reg_loss: 1672.5095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9804058.8889; train_global_loss: 13408376.4444; train_optim_loss: 13408376.4444; val_kl_reg_loss: 57012.0508; val_edge_recon_loss: 3074819.7500; val_gene_expr_recon_loss: 236488.5469; val_masked_gp_l1_reg_loss: 1692.8888; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9967339.0000; val_global_loss: 13337352.0000; val_optim_loss: 13337352.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8585; val_auprc_score: 0.8384; val_best_acc_score: 0.7689; val_best_f1_score: 0.7934; train_kl_reg_loss: 95072.6484; train_edge_recon_loss: 3007203.9167; train_gene_expr_recon_loss: 232766.3663; train_masked_gp_l1_reg_loss: 1717.3110; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9899981.3333; train_global_loss: 13236741.6667; train_optim_loss: 13236741.6667; val_kl_reg_loss: 126495.3594; val_edge_recon_loss: 2974979.5000; val_gene_expr_recon_loss: 231711.8750; val_masked_gp_l1_reg_loss: 1745.7444; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9897663.0000; val_global_loss: 13232595.0000; val_optim_loss: 13232595.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8688; val_auprc_score: 0.8445; val_best_acc_score: 0.7786; val_best_f1_score: 0.8021; train_kl_reg_loss: 124812.7248; train_edge_recon_loss: 2948263.3889; train_gene_expr_recon_loss: 227701.0104; train_masked_gp_l1_reg_loss: 1765.0681; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9848625.5556; train_global_loss: 13151167.7778; train_optim_loss: 13151167.7778; val_kl_reg_loss: 97758.9531; val_edge_recon_loss: 2946216.2500; val_gene_expr_recon_loss: 229093.7188; val_masked_gp_l1_reg_loss: 1781.8250; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9873954.0000; val_global_loss: 13148805.0000; val_optim_loss: 13148805.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8827; val_auprc_score: 0.8619; val_best_acc_score: 0.7905; val_best_f1_score: 0.8093; train_kl_reg_loss: 108406.1806; train_edge_recon_loss: 2946230.0833; train_gene_expr_recon_loss: 226246.2674; train_masked_gp_l1_reg_loss: 1795.9300; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9785013.4444; train_global_loss: 13067691.8889; train_optim_loss: 13067691.8889; val_kl_reg_loss: 109518.2031; val_edge_recon_loss: 2916372.0000; val_gene_expr_recon_loss: 226313.3281; val_masked_gp_l1_reg_loss: 1805.9082; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9827706.0000; val_global_loss: 13081716.0000; val_optim_loss: 13081716.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8830; val_auprc_score: 0.8585; val_best_acc_score: 0.7912; val_best_f1_score: 0.8091; train_kl_reg_loss: 108760.6962; train_edge_recon_loss: 2912326.0278; train_gene_expr_recon_loss: 225195.3142; train_masked_gp_l1_reg_loss: 1815.3768; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9844400.1111; train_global_loss: 13092497.6667; train_optim_loss: 13092497.6667; val_kl_reg_loss: 100306.7969; val_edge_recon_loss: 2940782.0000; val_gene_expr_recon_loss: 225023.7969; val_masked_gp_l1_reg_loss: 1822.0200; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9824388.0000; val_global_loss: 13092322.0000; val_optim_loss: 13092322.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8935; val_auprc_score: 0.8713; val_best_acc_score: 0.8102; val_best_f1_score: 0.8269; train_kl_reg_loss: 102840.2856; train_edge_recon_loss: 2916703.7778; train_gene_expr_recon_loss: 224300.7552; train_masked_gp_l1_reg_loss: 1831.4804; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748657.1111; train_global_loss: 12994333.3333; train_optim_loss: 12994333.3333; val_kl_reg_loss: 98030.5312; val_edge_recon_loss: 2910359.5000; val_gene_expr_recon_loss: 224716.1719; val_masked_gp_l1_reg_loss: 1840.4524; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9814565.0000; val_global_loss: 13049512.0000; val_optim_loss: 13049512.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9087; val_auprc_score: 0.8870; val_best_acc_score: 0.8320; val_best_f1_score: 0.8443; train_kl_reg_loss: 101279.4983; train_edge_recon_loss: 2905088.1667; train_gene_expr_recon_loss: 224153.0747; train_masked_gp_l1_reg_loss: 1852.9002; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9812487.7778; train_global_loss: 13044861.4444; train_optim_loss: 13044861.4444; val_kl_reg_loss: 88786.9375; val_edge_recon_loss: 2867433.2500; val_gene_expr_recon_loss: 224576.0625; val_masked_gp_l1_reg_loss: 1865.8005; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9809528.0000; val_global_loss: 12992190.0000; val_optim_loss: 12992190.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9139; val_auprc_score: 0.8898; val_best_acc_score: 0.8484; val_best_f1_score: 0.8601; train_kl_reg_loss: 97308.2283; train_edge_recon_loss: 2868571.2778; train_gene_expr_recon_loss: 222452.2882; train_masked_gp_l1_reg_loss: 1879.9705; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9774198.7778; train_global_loss: 12964410.5556; train_optim_loss: 12964410.5556; val_kl_reg_loss: 100503.1250; val_edge_recon_loss: 2879037.0000; val_gene_expr_recon_loss: 223144.7188; val_masked_gp_l1_reg_loss: 1896.8679; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9788840.0000; val_global_loss: 12993422.0000; val_optim_loss: 12993422.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9256; val_auprc_score: 0.9045; val_best_acc_score: 0.8607; val_best_f1_score: 0.8678; train_kl_reg_loss: 102001.2543; train_edge_recon_loss: 2847397.2778; train_gene_expr_recon_loss: 221232.9635; train_masked_gp_l1_reg_loss: 1914.2342; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9795731.2222; train_global_loss: 12968277.0000; train_optim_loss: 12968277.0000; val_kl_reg_loss: 92368.4219; val_edge_recon_loss: 2823491.7500; val_gene_expr_recon_loss: 223730.6250; val_masked_gp_l1_reg_loss: 1938.5745; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9822538.0000; val_global_loss: 12964068.0000; val_optim_loss: 12964068.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9252; val_auprc_score: 0.8998; val_best_acc_score: 0.8570; val_best_f1_score: 0.8667; train_kl_reg_loss: 102408.9479; train_edge_recon_loss: 2834331.0556; train_gene_expr_recon_loss: 220058.5521; train_masked_gp_l1_reg_loss: 1952.2847; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9735668.7778; train_global_loss: 12894419.6667; train_optim_loss: 12894419.6667; val_kl_reg_loss: 92130.7422; val_edge_recon_loss: 2859371.0000; val_gene_expr_recon_loss: 221739.5312; val_masked_gp_l1_reg_loss: 1964.8785; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9780272.0000; val_global_loss: 12955478.0000; val_optim_loss: 12955478.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9376; val_auprc_score: 0.9203; val_best_acc_score: 0.8681; val_best_f1_score: 0.8782; train_kl_reg_loss: 98353.3533; train_edge_recon_loss: 2813955.6111; train_gene_expr_recon_loss: 219831.6528; train_masked_gp_l1_reg_loss: 1975.5635; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697997.2222; train_global_loss: 12832113.6667; train_optim_loss: 12832113.6667; val_kl_reg_loss: 100383.3594; val_edge_recon_loss: 2808999.5000; val_gene_expr_recon_loss: 220778.4062; val_masked_gp_l1_reg_loss: 1989.6595; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9761516.0000; val_global_loss: 12893667.0000; val_optim_loss: 12893667.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9406; val_auprc_score: 0.9223; val_best_acc_score: 0.8759; val_best_f1_score: 0.8848; train_kl_reg_loss: 105296.0278; train_edge_recon_loss: 2789327.8611; train_gene_expr_recon_loss: 219256.3594; train_masked_gp_l1_reg_loss: 1999.5785; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9712493.4444; train_global_loss: 12828373.1111; train_optim_loss: 12828373.1111; val_kl_reg_loss: 98726.8828; val_edge_recon_loss: 2769663.0000; val_gene_expr_recon_loss: 221382.3125; val_masked_gp_l1_reg_loss: 2007.5250; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9774340.0000; val_global_loss: 12866120.0000; val_optim_loss: 12866120.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9454; val_auprc_score: 0.9274; val_best_acc_score: 0.8810; val_best_f1_score: 0.8896; train_kl_reg_loss: 103341.6102; train_edge_recon_loss: 2786788.6389; train_gene_expr_recon_loss: 217813.6597; train_masked_gp_l1_reg_loss: 2017.9614; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9632658.1111; train_global_loss: 12742619.8889; train_optim_loss: 12742619.8889; val_kl_reg_loss: 98935.0469; val_edge_recon_loss: 2790086.7500; val_gene_expr_recon_loss: 219913.1406; val_masked_gp_l1_reg_loss: 2028.1226; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9742504.0000; val_global_loss: 12853467.0000; val_optim_loss: 12853467.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9478; val_auprc_score: 0.9314; val_best_acc_score: 0.8855; val_best_f1_score: 0.8920; train_kl_reg_loss: 99696.2040; train_edge_recon_loss: 2792826.6944; train_gene_expr_recon_loss: 218754.0052; train_masked_gp_l1_reg_loss: 2037.6529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9702872.1111; train_global_loss: 12816186.4444; train_optim_loss: 12816186.4444; val_kl_reg_loss: 94905.1953; val_edge_recon_loss: 2791631.7500; val_gene_expr_recon_loss: 219615.9062; val_masked_gp_l1_reg_loss: 2049.9004; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9740199.0000; val_global_loss: 12848402.0000; val_optim_loss: 12848402.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9522; val_auprc_score: 0.9375; val_best_acc_score: 0.8919; val_best_f1_score: 0.8973; train_kl_reg_loss: 96185.2483; train_edge_recon_loss: 2779438.5833; train_gene_expr_recon_loss: 218670.3385; train_masked_gp_l1_reg_loss: 2061.2789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9677470.3333; train_global_loss: 12773825.7778; train_optim_loss: 12773825.7778; val_kl_reg_loss: 91838.2500; val_edge_recon_loss: 2772387.7500; val_gene_expr_recon_loss: 219718.5469; val_masked_gp_l1_reg_loss: 2070.1787; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9725770.0000; val_global_loss: 12811785.0000; val_optim_loss: 12811785.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9572; val_auprc_score: 0.9427; val_best_acc_score: 0.9023; val_best_f1_score: 0.9071; train_kl_reg_loss: 98064.1788; train_edge_recon_loss: 2767511.9722; train_gene_expr_recon_loss: 217593.6441; train_masked_gp_l1_reg_loss: 2080.6752; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9655863.6667; train_global_loss: 12741114.2222; train_optim_loss: 12741114.2222; val_kl_reg_loss: 90771.8672; val_edge_recon_loss: 2770759.5000; val_gene_expr_recon_loss: 219710.5156; val_masked_gp_l1_reg_loss: 2088.4949; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9719596.0000; val_global_loss: 12802926.0000; val_optim_loss: 12802926.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9590; val_auprc_score: 0.9428; val_best_acc_score: 0.9097; val_best_f1_score: 0.9140; train_kl_reg_loss: 92943.3498; train_edge_recon_loss: 2759930.6944; train_gene_expr_recon_loss: 217964.0260; train_masked_gp_l1_reg_loss: 2097.6857; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9704972.6667; train_global_loss: 12777908.3333; train_optim_loss: 12777908.3333; val_kl_reg_loss: 94323.6719; val_edge_recon_loss: 2760802.2500; val_gene_expr_recon_loss: 218036.7969; val_masked_gp_l1_reg_loss: 2105.9990; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9708363.0000; val_global_loss: 12783632.0000; val_optim_loss: 12783632.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9524; val_auprc_score: 0.9376; val_best_acc_score: 0.8925; val_best_f1_score: 0.8982; train_kl_reg_loss: 138039.8325; train_edge_recon_loss: 2990436.6111; train_gene_expr_recon_loss: 227933.0347; train_masked_gp_l1_reg_loss: 2128.7255; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9780665.0000; train_global_loss: 13139203.1111; train_optim_loss: 13139203.1111; val_kl_reg_loss: 26387.3750; val_edge_recon_loss: 2888819.0000; val_gene_expr_recon_loss: 230413.6406; val_masked_gp_l1_reg_loss: 2153.7502; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9845747.0000; val_global_loss: 12993521.0000; val_optim_loss: 12993521.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9557; val_auprc_score: 0.9402; val_best_acc_score: 0.9015; val_best_f1_score: 0.9049; train_kl_reg_loss: 132036.9818; train_edge_recon_loss: 2883097.9722; train_gene_expr_recon_loss: 228377.1007; train_masked_gp_l1_reg_loss: 2172.3682; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9800290.1111; train_global_loss: 13045974.3333; train_optim_loss: 13045974.3333; val_kl_reg_loss: 24971.0352; val_edge_recon_loss: 2851292.7500; val_gene_expr_recon_loss: 229737.6562; val_masked_gp_l1_reg_loss: 2192.9023; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9819268.0000; val_global_loss: 12927462.0000; val_optim_loss: 12927462.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9565; val_auprc_score: 0.9403; val_best_acc_score: 0.8996; val_best_f1_score: 0.9043; train_kl_reg_loss: 99002.2839; train_edge_recon_loss: 2837019.5556; train_gene_expr_recon_loss: 227509.9045; train_masked_gp_l1_reg_loss: 2206.5938; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9678639.1111; train_global_loss: 12844377.4444; train_optim_loss: 12844377.4444; val_kl_reg_loss: 32293.1562; val_edge_recon_loss: 2850343.5000; val_gene_expr_recon_loss: 227259.0781; val_masked_gp_l1_reg_loss: 2219.7292; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9781705.0000; val_global_loss: 12893820.0000; val_optim_loss: 12893820.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9564; val_auprc_score: 0.9419; val_best_acc_score: 0.9012; val_best_f1_score: 0.9063; train_kl_reg_loss: 91825.7839; train_edge_recon_loss: 2819353.6944; train_gene_expr_recon_loss: 225834.3177; train_masked_gp_l1_reg_loss: 2226.2711; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776211.2222; train_global_loss: 12915451.2222; train_optim_loss: 12915451.2222; val_kl_reg_loss: 32708.7969; val_edge_recon_loss: 2826387.2500; val_gene_expr_recon_loss: 227248.8594; val_masked_gp_l1_reg_loss: 2230.9810; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9786396.0000; val_global_loss: 12874972.0000; val_optim_loss: 12874972.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9552; val_auprc_score: 0.9377; val_best_acc_score: 0.9038; val_best_f1_score: 0.9076; train_kl_reg_loss: 85866.5017; train_edge_recon_loss: 2811218.1944; train_gene_expr_recon_loss: 225316.4479; train_masked_gp_l1_reg_loss: 2228.4045; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9662833.3333; train_global_loss: 12787462.7778; train_optim_loss: 12787462.7778; val_kl_reg_loss: 33660.7891; val_edge_recon_loss: 2822745.2500; val_gene_expr_recon_loss: 226007.3906; val_masked_gp_l1_reg_loss: 2225.0803; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9757401.0000; val_global_loss: 12842040.0000; val_optim_loss: 12842040.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9611; val_auprc_score: 0.9463; val_best_acc_score: 0.9066; val_best_f1_score: 0.9098; train_kl_reg_loss: 86245.7812; train_edge_recon_loss: 2802332.2500; train_gene_expr_recon_loss: 224294.8438; train_masked_gp_l1_reg_loss: 2223.4714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9691162.4444; train_global_loss: 12806258.8889; train_optim_loss: 12806258.8889; val_kl_reg_loss: 33908.4922; val_edge_recon_loss: 2797548.0000; val_gene_expr_recon_loss: 226119.7031; val_masked_gp_l1_reg_loss: 2221.4026; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9764026.0000; val_global_loss: 12823824.0000; val_optim_loss: 12823824.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9559; val_auprc_score: 0.9384; val_best_acc_score: 0.9033; val_best_f1_score: 0.9087; train_kl_reg_loss: 85478.6432; train_edge_recon_loss: 2805698.5833; train_gene_expr_recon_loss: 224146.7222; train_masked_gp_l1_reg_loss: 2220.1307; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9710801.1111; train_global_loss: 12828345.2222; train_optim_loss: 12828345.2222; val_kl_reg_loss: 34322.9844; val_edge_recon_loss: 2811261.7500; val_gene_expr_recon_loss: 226187.5156; val_masked_gp_l1_reg_loss: 2218.6709; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9771311.0000; val_global_loss: 12845302.0000; val_optim_loss: 12845302.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9606; val_auprc_score: 0.9468; val_best_acc_score: 0.9097; val_best_f1_score: 0.9138; train_kl_reg_loss: 84724.9592; train_edge_recon_loss: 2798301.2778; train_gene_expr_recon_loss: 225264.2778; train_masked_gp_l1_reg_loss: 2217.7967; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9747649.7778; train_global_loss: 12858158.0000; train_optim_loss: 12858158.0000; val_kl_reg_loss: 34971.2969; val_edge_recon_loss: 2799841.7500; val_gene_expr_recon_loss: 226021.2344; val_masked_gp_l1_reg_loss: 2216.8730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9767191.0000; val_global_loss: 12830242.0000; val_optim_loss: 12830242.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9602
Val AUPRC score: 0.9445
Val best accuracy score: 0.9066
Val best F1 score: 0.9115
Val gene expr MSE score: 0.5331
Val chrom access MSE score: 0.0875
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
