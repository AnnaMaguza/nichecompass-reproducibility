[True]
Run timestamp: 07082023_192329_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8913; val_auprc_score: 0.9077; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 36347.0046; train_edge_recon_loss: 354065.8160; train_gene_expr_recon_loss: 1313292.0833; train_masked_gp_l1_reg_loss: 4577.2407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167191.2500; train_chrom_access_recon_loss: 2858546.8611; train_global_loss: 4734020.1944; train_optim_loss: 4734020.1944; val_kl_reg_loss: 45122.4453; val_edge_recon_loss: 406601.5312; val_gene_expr_recon_loss: 1042282.6250; val_masked_gp_l1_reg_loss: 4097.3198; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162646.5469; val_chrom_access_recon_loss: 1815846.3750; val_global_loss: 3476597.0000; val_optim_loss: 3476597.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9086; val_auprc_score: 0.9205; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31895.3987; train_edge_recon_loss: 367333.3056; train_gene_expr_recon_loss: 914173.5069; train_masked_gp_l1_reg_loss: 3990.1637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159835.0625; train_chrom_access_recon_loss: 1592431.5833; train_global_loss: 3069659.0278; train_optim_loss: 3069659.0278; val_kl_reg_loss: 55521.1094; val_edge_recon_loss: 406592.2500; val_gene_expr_recon_loss: 821417.7500; val_masked_gp_l1_reg_loss: 3944.4858; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156401.9688; val_chrom_access_recon_loss: 1443002.5000; val_global_loss: 2886880.0000; val_optim_loss: 2886880.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9051; val_auprc_score: 0.9160; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 29973.1122; train_edge_recon_loss: 365367.7917; train_gene_expr_recon_loss: 815816.4167; train_masked_gp_l1_reg_loss: 4024.3121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153643.2240; train_chrom_access_recon_loss: 1410168.0278; train_global_loss: 2778992.9444; train_optim_loss: 2778992.9444; val_kl_reg_loss: 25789.2578; val_edge_recon_loss: 406573.1250; val_gene_expr_recon_loss: 784967.0000; val_masked_gp_l1_reg_loss: 4129.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150110.3906; val_chrom_access_recon_loss: 1385567.8750; val_global_loss: 2757137.5000; val_optim_loss: 2757137.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8993; val_auprc_score: 0.9115; val_best_acc_score: 0.5061; val_best_f1_score: 0.6694; train_kl_reg_loss: 24619.9685; train_edge_recon_loss: 363392.3993; train_gene_expr_recon_loss: 775731.0764; train_masked_gp_l1_reg_loss: 4178.2661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147090.5365; train_chrom_access_recon_loss: 1372671.6111; train_global_loss: 2687683.9167; train_optim_loss: 2687683.9167; val_kl_reg_loss: 24810.7227; val_edge_recon_loss: 406552.3438; val_gene_expr_recon_loss: 756732.1250; val_masked_gp_l1_reg_loss: 4215.5801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143163.4375; val_chrom_access_recon_loss: 1363221.0000; val_global_loss: 2698695.2500; val_optim_loss: 2698695.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8902; val_auprc_score: 0.9018; val_best_acc_score: 0.5127; val_best_f1_score: 0.6723; train_kl_reg_loss: 24820.1233; train_edge_recon_loss: 362821.4271; train_gene_expr_recon_loss: 753033.5278; train_masked_gp_l1_reg_loss: 4228.3242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139782.4306; train_chrom_access_recon_loss: 1346200.1806; train_global_loss: 2630885.9444; train_optim_loss: 2630885.9444; val_kl_reg_loss: 27014.2168; val_edge_recon_loss: 406499.7812; val_gene_expr_recon_loss: 737282.3750; val_masked_gp_l1_reg_loss: 4236.4399; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135435.3750; val_chrom_access_recon_loss: 1350870.1250; val_global_loss: 2661338.5000; val_optim_loss: 2661338.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8719; val_auprc_score: 0.8847; val_best_acc_score: 0.5213; val_best_f1_score: 0.6757; train_kl_reg_loss: 25507.6068; train_edge_recon_loss: 362303.3576; train_gene_expr_recon_loss: 739111.9028; train_masked_gp_l1_reg_loss: 4237.9322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131836.0477; train_chrom_access_recon_loss: 1344525.8611; train_global_loss: 2607522.7222; train_optim_loss: 2607522.7222; val_kl_reg_loss: 24233.2891; val_edge_recon_loss: 406407.3438; val_gene_expr_recon_loss: 724236.2500; val_masked_gp_l1_reg_loss: 4236.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127292.0938; val_chrom_access_recon_loss: 1341865.1250; val_global_loss: 2628270.5000; val_optim_loss: 2628270.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8666; val_auprc_score: 0.8735; val_best_acc_score: 0.5430; val_best_f1_score: 0.6843; train_kl_reg_loss: 25077.7546; train_edge_recon_loss: 361614.2361; train_gene_expr_recon_loss: 725439.1319; train_masked_gp_l1_reg_loss: 4242.4791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123657.4540; train_chrom_access_recon_loss: 1335133.0417; train_global_loss: 2575164.1389; train_optim_loss: 2575164.1389; val_kl_reg_loss: 24434.9844; val_edge_recon_loss: 406144.5312; val_gene_expr_recon_loss: 709938.8750; val_masked_gp_l1_reg_loss: 4246.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119140.1562; val_chrom_access_recon_loss: 1334806.7500; val_global_loss: 2598711.5000; val_optim_loss: 2598711.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8584; val_auprc_score: 0.8561; val_best_acc_score: 0.6268; val_best_f1_score: 0.7233; train_kl_reg_loss: 25354.0805; train_edge_recon_loss: 361090.0312; train_gene_expr_recon_loss: 708145.4931; train_masked_gp_l1_reg_loss: 4249.9483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115598.5998; train_chrom_access_recon_loss: 1329798.9306; train_global_loss: 2544237.0833; train_optim_loss: 2544237.0833; val_kl_reg_loss: 22974.8906; val_edge_recon_loss: 405576.8125; val_gene_expr_recon_loss: 698251.8750; val_masked_gp_l1_reg_loss: 4249.1304; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111228.3984; val_chrom_access_recon_loss: 1328796.1250; val_global_loss: 2571077.0000; val_optim_loss: 2571077.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8421; val_auprc_score: 0.8312; val_best_acc_score: 0.7114; val_best_f1_score: 0.7645; train_kl_reg_loss: 25155.3694; train_edge_recon_loss: 360357.9688; train_gene_expr_recon_loss: 698305.3681; train_masked_gp_l1_reg_loss: 4255.0104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107845.6832; train_chrom_access_recon_loss: 1327402.1806; train_global_loss: 2523321.5833; train_optim_loss: 2523321.5833; val_kl_reg_loss: 23477.2988; val_edge_recon_loss: 404234.6562; val_gene_expr_recon_loss: 689093.9375; val_masked_gp_l1_reg_loss: 4257.5298; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103696.0859; val_chrom_access_recon_loss: 1323638.5000; val_global_loss: 2548398.0000; val_optim_loss: 2548398.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8163; val_auprc_score: 0.8047; val_best_acc_score: 0.7246; val_best_f1_score: 0.7627; train_kl_reg_loss: 24905.2502; train_edge_recon_loss: 359656.9028; train_gene_expr_recon_loss: 689117.6181; train_masked_gp_l1_reg_loss: 4268.9470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100530.1788; train_chrom_access_recon_loss: 1319859.2361; train_global_loss: 2498338.1111; train_optim_loss: 2498338.1111; val_kl_reg_loss: 23578.5430; val_edge_recon_loss: 402889.1875; val_gene_expr_recon_loss: 681019.0000; val_masked_gp_l1_reg_loss: 4272.8120; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96671.5938; val_chrom_access_recon_loss: 1318805.2500; val_global_loss: 2527236.5000; val_optim_loss: 2527236.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7994; val_auprc_score: 0.7892; val_best_acc_score: 0.7231; val_best_f1_score: 0.7432; train_kl_reg_loss: 24824.2591; train_edge_recon_loss: 359225.8611; train_gene_expr_recon_loss: 683702.7778; train_masked_gp_l1_reg_loss: 4277.8424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93770.2326; train_chrom_access_recon_loss: 1317741.0556; train_global_loss: 2483542.0556; train_optim_loss: 2483542.0556; val_kl_reg_loss: 24750.4766; val_edge_recon_loss: 401292.6250; val_gene_expr_recon_loss: 675324.2500; val_masked_gp_l1_reg_loss: 4279.1616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90257.8047; val_chrom_access_recon_loss: 1314540.5000; val_global_loss: 2510444.7500; val_optim_loss: 2510444.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7980; val_auprc_score: 0.7827; val_best_acc_score: 0.7091; val_best_f1_score: 0.7476; train_kl_reg_loss: 24523.7459; train_edge_recon_loss: 358287.4167; train_gene_expr_recon_loss: 677622.7431; train_masked_gp_l1_reg_loss: 4287.3254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87633.9826; train_chrom_access_recon_loss: 1314729.7639; train_global_loss: 2467085.0278; train_optim_loss: 2467085.0278; val_kl_reg_loss: 23284.7344; val_edge_recon_loss: 397731.7812; val_gene_expr_recon_loss: 671112.5000; val_masked_gp_l1_reg_loss: 4293.7544; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84458.4219; val_chrom_access_recon_loss: 1311031.0000; val_global_loss: 2491912.0000; val_optim_loss: 2491912.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7985; val_auprc_score: 0.7837; val_best_acc_score: 0.7056; val_best_f1_score: 0.7567; train_kl_reg_loss: 24034.1372; train_edge_recon_loss: 357416.4549; train_gene_expr_recon_loss: 673496.4583; train_masked_gp_l1_reg_loss: 4304.8293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82081.0165; train_chrom_access_recon_loss: 1308247.8750; train_global_loss: 2449580.7222; train_optim_loss: 2449580.7222; val_kl_reg_loss: 22795.8398; val_edge_recon_loss: 395018.0938; val_gene_expr_recon_loss: 668102.4375; val_masked_gp_l1_reg_loss: 4312.9829; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79197.2266; val_chrom_access_recon_loss: 1307999.3750; val_global_loss: 2477426.0000; val_optim_loss: 2477426.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7976; val_auprc_score: 0.7819; val_best_acc_score: 0.7208; val_best_f1_score: 0.7558; train_kl_reg_loss: 23889.0864; train_edge_recon_loss: 355968.9375; train_gene_expr_recon_loss: 671556.4583; train_masked_gp_l1_reg_loss: 4326.7714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77038.3837; train_chrom_access_recon_loss: 1309512.8889; train_global_loss: 2442292.5000; train_optim_loss: 2442292.5000; val_kl_reg_loss: 21892.5938; val_edge_recon_loss: 389887.6250; val_gene_expr_recon_loss: 665491.2500; val_masked_gp_l1_reg_loss: 4333.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74413.0625; val_chrom_access_recon_loss: 1305285.5000; val_global_loss: 2461303.7500; val_optim_loss: 2461303.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7987; val_auprc_score: 0.7880; val_best_acc_score: 0.7187; val_best_f1_score: 0.7551; train_kl_reg_loss: 23257.7103; train_edge_recon_loss: 354619.4826; train_gene_expr_recon_loss: 667048.8264; train_masked_gp_l1_reg_loss: 4349.4727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72450.2491; train_chrom_access_recon_loss: 1299344.9861; train_global_loss: 2421070.6667; train_optim_loss: 2421070.6667; val_kl_reg_loss: 22580.3906; val_edge_recon_loss: 385832.6250; val_gene_expr_recon_loss: 662162.2500; val_masked_gp_l1_reg_loss: 4360.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70056.2969; val_chrom_access_recon_loss: 1302891.6250; val_global_loss: 2447883.7500; val_optim_loss: 2447883.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8115; val_auprc_score: 0.8045; val_best_acc_score: 0.7269; val_best_f1_score: 0.7624; train_kl_reg_loss: 22989.9811; train_edge_recon_loss: 352263.3646; train_gene_expr_recon_loss: 662364.3889; train_masked_gp_l1_reg_loss: 4374.0603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68257.6667; train_chrom_access_recon_loss: 1297058.0000; train_global_loss: 2407307.4722; train_optim_loss: 2407307.4722; val_kl_reg_loss: 23180.1602; val_edge_recon_loss: 379147.0938; val_gene_expr_recon_loss: 660159.3750; val_masked_gp_l1_reg_loss: 4384.3232; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66064.6719; val_chrom_access_recon_loss: 1300414.5000; val_global_loss: 2433350.0000; val_optim_loss: 2433350.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8193; val_auprc_score: 0.8136; val_best_acc_score: 0.7321; val_best_f1_score: 0.7642; train_kl_reg_loss: 22801.2888; train_edge_recon_loss: 349030.6042; train_gene_expr_recon_loss: 664849.6250; train_masked_gp_l1_reg_loss: 4398.4376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64412.6918; train_chrom_access_recon_loss: 1294654.8056; train_global_loss: 2400147.4722; train_optim_loss: 2400147.4722; val_kl_reg_loss: 22048.3867; val_edge_recon_loss: 370024.0312; val_gene_expr_recon_loss: 659192.3750; val_masked_gp_l1_reg_loss: 4410.1787; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62407.4531; val_chrom_access_recon_loss: 1298765.1250; val_global_loss: 2416847.5000; val_optim_loss: 2416847.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8287; val_auprc_score: 0.8199; val_best_acc_score: 0.7423; val_best_f1_score: 0.7699; train_kl_reg_loss: 22973.4273; train_edge_recon_loss: 344021.1528; train_gene_expr_recon_loss: 664881.0208; train_masked_gp_l1_reg_loss: 4432.6870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60905.9900; train_chrom_access_recon_loss: 1297995.4306; train_global_loss: 2395209.7222; train_optim_loss: 2395209.7222; val_kl_reg_loss: 22086.1836; val_edge_recon_loss: 356285.5625; val_gene_expr_recon_loss: 659385.0625; val_masked_gp_l1_reg_loss: 4451.9614; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59068.9805; val_chrom_access_recon_loss: 1297369.5000; val_global_loss: 2398647.2500; val_optim_loss: 2398647.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8454; val_auprc_score: 0.8376; val_best_acc_score: 0.7541; val_best_f1_score: 0.7784; train_kl_reg_loss: 23987.9388; train_edge_recon_loss: 337669.2257; train_gene_expr_recon_loss: 663562.6806; train_masked_gp_l1_reg_loss: 4472.8116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57691.9714; train_chrom_access_recon_loss: 1293405.7083; train_global_loss: 2380790.3056; train_optim_loss: 2380790.3056; val_kl_reg_loss: 25125.9219; val_edge_recon_loss: 342459.0938; val_gene_expr_recon_loss: 656955.2500; val_masked_gp_l1_reg_loss: 4491.4448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56011.5664; val_chrom_access_recon_loss: 1295257.3750; val_global_loss: 2380300.5000; val_optim_loss: 2380300.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8466; val_auprc_score: 0.8366; val_best_acc_score: 0.7569; val_best_f1_score: 0.7804; train_kl_reg_loss: 27032.1265; train_edge_recon_loss: 329396.8472; train_gene_expr_recon_loss: 659514.6181; train_masked_gp_l1_reg_loss: 4510.2317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54740.8880; train_chrom_access_recon_loss: 1288073.5278; train_global_loss: 2363268.2222; train_optim_loss: 2363268.2222; val_kl_reg_loss: 28535.3945; val_edge_recon_loss: 331693.3125; val_gene_expr_recon_loss: 655668.2500; val_masked_gp_l1_reg_loss: 4529.2485; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53186.2148; val_chrom_access_recon_loss: 1293444.0000; val_global_loss: 2367056.5000; val_optim_loss: 2367056.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8580; val_auprc_score: 0.8473; val_best_acc_score: 0.7639; val_best_f1_score: 0.7896; train_kl_reg_loss: 30484.8038; train_edge_recon_loss: 321711.2396; train_gene_expr_recon_loss: 656036.5417; train_masked_gp_l1_reg_loss: 4549.1476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52007.6363; train_chrom_access_recon_loss: 1283222.9722; train_global_loss: 2348012.3056; train_optim_loss: 2348012.3056; val_kl_reg_loss: 32412.0547; val_edge_recon_loss: 320973.8750; val_gene_expr_recon_loss: 654627.1250; val_masked_gp_l1_reg_loss: 4570.3799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50562.2461; val_chrom_access_recon_loss: 1291116.3750; val_global_loss: 2354262.0000; val_optim_loss: 2354262.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8610; val_auprc_score: 0.8477; val_best_acc_score: 0.7666; val_best_f1_score: 0.7939; train_kl_reg_loss: 32547.8160; train_edge_recon_loss: 316852.9861; train_gene_expr_recon_loss: 658610.9097; train_masked_gp_l1_reg_loss: 4592.0707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49474.1450; train_chrom_access_recon_loss: 1292200.2361; train_global_loss: 2354278.1667; train_optim_loss: 2354278.1667; val_kl_reg_loss: 30758.6758; val_edge_recon_loss: 320790.9375; val_gene_expr_recon_loss: 652599.8125; val_masked_gp_l1_reg_loss: 4613.9106; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48140.3984; val_chrom_access_recon_loss: 1289108.0000; val_global_loss: 2346011.7500; val_optim_loss: 2346011.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8743; val_auprc_score: 0.8644; val_best_acc_score: 0.7801; val_best_f1_score: 0.7993; train_kl_reg_loss: 31293.3711; train_edge_recon_loss: 314784.4688; train_gene_expr_recon_loss: 653593.9306; train_masked_gp_l1_reg_loss: 4636.4389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47131.3789; train_chrom_access_recon_loss: 1285464.7917; train_global_loss: 2336904.4167; train_optim_loss: 2336904.4167; val_kl_reg_loss: 29746.7227; val_edge_recon_loss: 317304.4062; val_gene_expr_recon_loss: 651820.7500; val_masked_gp_l1_reg_loss: 4659.8052; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45886.9141; val_chrom_access_recon_loss: 1287334.6250; val_global_loss: 2336753.2500; val_optim_loss: 2336753.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8865; val_auprc_score: 0.8751; val_best_acc_score: 0.7947; val_best_f1_score: 0.8061; train_kl_reg_loss: 30301.1738; train_edge_recon_loss: 312385.2118; train_gene_expr_recon_loss: 656651.0556; train_masked_gp_l1_reg_loss: 4679.7462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44951.7556; train_chrom_access_recon_loss: 1285953.5278; train_global_loss: 2334922.4722; train_optim_loss: 2334922.4722; val_kl_reg_loss: 30192.4512; val_edge_recon_loss: 315009.3438; val_gene_expr_recon_loss: 650199.0625; val_masked_gp_l1_reg_loss: 4700.5571; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43805.2812; val_chrom_access_recon_loss: 1285439.3750; val_global_loss: 2329346.0000; val_optim_loss: 2329346.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8943; val_auprc_score: 0.8752; val_best_acc_score: 0.8063; val_best_f1_score: 0.8177; train_kl_reg_loss: 30208.1660; train_edge_recon_loss: 310474.5278; train_gene_expr_recon_loss: 651829.2986; train_masked_gp_l1_reg_loss: 4719.8610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42948.3676; train_chrom_access_recon_loss: 1281150.5417; train_global_loss: 2321330.7778; train_optim_loss: 2321330.7778; val_kl_reg_loss: 29129.2871; val_edge_recon_loss: 309979.3125; val_gene_expr_recon_loss: 649219.1250; val_masked_gp_l1_reg_loss: 4742.4614; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41890.2891; val_chrom_access_recon_loss: 1283353.2500; val_global_loss: 2318313.7500; val_optim_loss: 2318313.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9015; val_auprc_score: 0.8879; val_best_acc_score: 0.8139; val_best_f1_score: 0.8213; train_kl_reg_loss: 28104.4638; train_edge_recon_loss: 325681.8576; train_gene_expr_recon_loss: 944721.0764; train_masked_gp_l1_reg_loss: 4826.9706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40885.3676; train_chrom_access_recon_loss: 1355133.4306; train_global_loss: 2699353.1667; train_optim_loss: 2699353.1667; val_kl_reg_loss: 14886.3408; val_edge_recon_loss: 323966.8438; val_gene_expr_recon_loss: 933746.3125; val_masked_gp_l1_reg_loss: 4953.3257; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39528.2773; val_chrom_access_recon_loss: 1356036.0000; val_global_loss: 2673117.0000; val_optim_loss: 2673117.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9086; val_auprc_score: 0.8946; val_best_acc_score: 0.8244; val_best_f1_score: 0.8290; train_kl_reg_loss: 27174.7307; train_edge_recon_loss: 317078.4549; train_gene_expr_recon_loss: 936349.9514; train_masked_gp_l1_reg_loss: 5055.8150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38405.9449; train_chrom_access_recon_loss: 1352382.4444; train_global_loss: 2676447.2778; train_optim_loss: 2676447.2778; val_kl_reg_loss: 16294.8154; val_edge_recon_loss: 311772.3750; val_gene_expr_recon_loss: 930272.5000; val_masked_gp_l1_reg_loss: 5179.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37025.8750; val_chrom_access_recon_loss: 1354915.2500; val_global_loss: 2655460.5000; val_optim_loss: 2655460.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9047; val_auprc_score: 0.8896; val_best_acc_score: 0.8224; val_best_f1_score: 0.8293; train_kl_reg_loss: 26227.3561; train_edge_recon_loss: 309677.7188; train_gene_expr_recon_loss: 935027.6667; train_masked_gp_l1_reg_loss: 5268.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35982.3290; train_chrom_access_recon_loss: 1353282.1944; train_global_loss: 2665466.0833; train_optim_loss: 2665466.0833; val_kl_reg_loss: 18760.2480; val_edge_recon_loss: 310284.3750; val_gene_expr_recon_loss: 924467.7500; val_masked_gp_l1_reg_loss: 5369.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34715.3477; val_chrom_access_recon_loss: 1352913.2500; val_global_loss: 2646511.0000; val_optim_loss: 2646511.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9119; val_auprc_score: 0.8993; val_best_acc_score: 0.8294; val_best_f1_score: 0.8361; train_kl_reg_loss: 25305.7318; train_edge_recon_loss: 304756.2014; train_gene_expr_recon_loss: 925995.2639; train_masked_gp_l1_reg_loss: 5440.3470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33769.8108; train_chrom_access_recon_loss: 1348471.7361; train_global_loss: 2643739.0556; train_optim_loss: 2643739.0556; val_kl_reg_loss: 20841.7930; val_edge_recon_loss: 304954.8125; val_gene_expr_recon_loss: 920590.8750; val_masked_gp_l1_reg_loss: 5521.3257; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32627.9531; val_chrom_access_recon_loss: 1350997.1250; val_global_loss: 2635534.0000; val_optim_loss: 2635534.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9141; val_auprc_score: 0.9008; val_best_acc_score: 0.8310; val_best_f1_score: 0.8359; train_kl_reg_loss: 25042.8151; train_edge_recon_loss: 303130.3194; train_gene_expr_recon_loss: 924438.3264; train_masked_gp_l1_reg_loss: 5514.4774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32457.3869; train_chrom_access_recon_loss: 1348484.7639; train_global_loss: 2639068.0833; train_optim_loss: 2639068.0833; val_kl_reg_loss: 20944.9707; val_edge_recon_loss: 306213.8125; val_gene_expr_recon_loss: 919745.7500; val_masked_gp_l1_reg_loss: 5508.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32265.7227; val_chrom_access_recon_loss: 1350532.3750; val_global_loss: 2635210.5000; val_optim_loss: 2635210.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9114; val_auprc_score: 0.8963; val_best_acc_score: 0.8293; val_best_f1_score: 0.8370; train_kl_reg_loss: 24894.1254; train_edge_recon_loss: 303111.8750; train_gene_expr_recon_loss: 922876.3472; train_masked_gp_l1_reg_loss: 5508.6447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32148.2224; train_chrom_access_recon_loss: 1347122.3472; train_global_loss: 2635661.5278; train_optim_loss: 2635661.5278; val_kl_reg_loss: 20925.7148; val_edge_recon_loss: 304480.1250; val_gene_expr_recon_loss: 919569.5000; val_masked_gp_l1_reg_loss: 5508.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31996.9688; val_chrom_access_recon_loss: 1350172.3750; val_global_loss: 2632653.5000; val_optim_loss: 2632653.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9147; val_auprc_score: 0.8979; val_best_acc_score: 0.8335; val_best_f1_score: 0.8429; train_kl_reg_loss: 24701.6658; train_edge_recon_loss: 301962.3681; train_gene_expr_recon_loss: 926041.8472; train_masked_gp_l1_reg_loss: 5509.9142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31887.2700; train_chrom_access_recon_loss: 1346218.7361; train_global_loss: 2636321.7500; train_optim_loss: 2636321.7500; val_kl_reg_loss: 20975.5000; val_edge_recon_loss: 301578.4375; val_gene_expr_recon_loss: 919091.2500; val_masked_gp_l1_reg_loss: 5511.8511; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31753.0664; val_chrom_access_recon_loss: 1350365.5000; val_global_loss: 2629275.7500; val_optim_loss: 2629275.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9146; val_auprc_score: 0.9012; val_best_acc_score: 0.8306; val_best_f1_score: 0.8385; train_kl_reg_loss: 24695.4382; train_edge_recon_loss: 303680.8785; train_gene_expr_recon_loss: 926845.0556; train_masked_gp_l1_reg_loss: 5514.0118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31650.6858; train_chrom_access_recon_loss: 1348515.3194; train_global_loss: 2640901.3889; train_optim_loss: 2640901.3889; val_kl_reg_loss: 21108.9297; val_edge_recon_loss: 302590.5625; val_gene_expr_recon_loss: 918666.8125; val_masked_gp_l1_reg_loss: 5517.0532; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31527.8516; val_chrom_access_recon_loss: 1349967.2500; val_global_loss: 2629378.5000; val_optim_loss: 2629378.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8993
val AUPRC score: 0.8877
val best accuracy score: 0.8176
val best F1 score: 0.8200
val target rna MSE score: 3.7917
val source rna MSE score: 3.2289
val target atac MSE score: 0.1361
val source atac MSE score: 0.0201
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
