[True]
Run timestamp: 24072023_170544_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9709; val_auprc_score: 0.9697; val_best_acc_score: 0.8495; val_best_f1_score: 0.8246; train_kl_reg_loss: 1792.1963; train_edge_recon_loss: 34658669.3333; train_gene_expr_recon_loss: 3179137.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1082660.8333; train_global_loss: 38922259.1111; train_optim_loss: 38922259.1111; val_kl_reg_loss: 1645.8245; val_edge_recon_loss: 40237040.0000; val_gene_expr_recon_loss: 3188223.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083964.5000; val_global_loss: 44510872.0000; val_optim_loss: 44510872.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9145; val_auprc_score: 0.9062; val_best_acc_score: 0.8343; val_best_f1_score: 0.8418; train_kl_reg_loss: 1596.2842; train_edge_recon_loss: 34536881.3333; train_gene_expr_recon_loss: 3088797.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1076498.0278; train_global_loss: 38703772.8889; train_optim_loss: 38703772.8889; val_kl_reg_loss: 1345.8411; val_edge_recon_loss: 35229464.0000; val_gene_expr_recon_loss: 3087942.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1082568.2500; val_global_loss: 39401320.0000; val_optim_loss: 39401320.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8572; val_auprc_score: 0.8465; val_best_acc_score: 0.7604; val_best_f1_score: 0.7912; train_kl_reg_loss: 4348.6873; train_edge_recon_loss: 31712117.1111; train_gene_expr_recon_loss: 2986055.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077196.3333; train_global_loss: 35779718.0000; train_optim_loss: 35779718.0000; val_kl_reg_loss: 13193.6094; val_edge_recon_loss: 28955760.0000; val_gene_expr_recon_loss: 3041843.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079043.1250; val_global_loss: 33089842.0000; val_optim_loss: 33089842.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8840; val_auprc_score: 0.8709; val_best_acc_score: 0.7999; val_best_f1_score: 0.8027; train_kl_reg_loss: 27738.5414; train_edge_recon_loss: 28557518.2222; train_gene_expr_recon_loss: 2978672.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073513.8333; train_global_loss: 32637442.8889; train_optim_loss: 32637442.8889; val_kl_reg_loss: 44536.0820; val_edge_recon_loss: 28193232.0000; val_gene_expr_recon_loss: 2978394.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1072703.6250; val_global_loss: 32288866.0000; val_optim_loss: 32288866.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8867; val_auprc_score: 0.8616; val_best_acc_score: 0.8033; val_best_f1_score: 0.8175; train_kl_reg_loss: 55218.8268; train_edge_recon_loss: 28116763.1111; train_gene_expr_recon_loss: 2837259.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060984.1667; train_global_loss: 32070224.8889; train_optim_loss: 32070224.8889; val_kl_reg_loss: 61884.3672; val_edge_recon_loss: 28013370.0000; val_gene_expr_recon_loss: 2826232.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063146.6250; val_global_loss: 31964632.0000; val_optim_loss: 31964632.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9045; val_auprc_score: 0.8761; val_best_acc_score: 0.8387; val_best_f1_score: 0.8514; train_kl_reg_loss: 65245.3615; train_edge_recon_loss: 27789395.3333; train_gene_expr_recon_loss: 2744389.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052787.3958; train_global_loss: 31651817.7778; train_optim_loss: 31651817.7778; val_kl_reg_loss: 65083.0781; val_edge_recon_loss: 27455554.0000; val_gene_expr_recon_loss: 2785954.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056763.3750; val_global_loss: 31363356.0000; val_optim_loss: 31363356.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9215; val_auprc_score: 0.8955; val_best_acc_score: 0.8626; val_best_f1_score: 0.8734; train_kl_reg_loss: 65719.8963; train_edge_recon_loss: 27210204.4444; train_gene_expr_recon_loss: 2714681.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047520.2917; train_global_loss: 31038126.2222; train_optim_loss: 31038126.2222; val_kl_reg_loss: 65189.3008; val_edge_recon_loss: 27219930.0000; val_gene_expr_recon_loss: 2722929.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052542.0000; val_global_loss: 31060592.0000; val_optim_loss: 31060592.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9273; val_auprc_score: 0.9004; val_best_acc_score: 0.8670; val_best_f1_score: 0.8769; train_kl_reg_loss: 66763.6814; train_edge_recon_loss: 27106637.7778; train_gene_expr_recon_loss: 2695662.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048033.1597; train_global_loss: 30917097.3333; train_optim_loss: 30917097.3333; val_kl_reg_loss: 67078.0469; val_edge_recon_loss: 27199904.0000; val_gene_expr_recon_loss: 2725630.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051273.2500; val_global_loss: 31043886.0000; val_optim_loss: 31043886.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9265; val_auprc_score: 0.9002; val_best_acc_score: 0.8673; val_best_f1_score: 0.8749; train_kl_reg_loss: 67797.3090; train_edge_recon_loss: 27123286.4444; train_gene_expr_recon_loss: 2636828.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043194.4931; train_global_loss: 30871107.1111; train_optim_loss: 30871107.1111; val_kl_reg_loss: 70469.3594; val_edge_recon_loss: 27523532.0000; val_gene_expr_recon_loss: 2671902.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048665.2500; val_global_loss: 31314570.0000; val_optim_loss: 31314570.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9391; val_auprc_score: 0.9198; val_best_acc_score: 0.8813; val_best_f1_score: 0.8870; train_kl_reg_loss: 70994.5486; train_edge_recon_loss: 26862060.0000; train_gene_expr_recon_loss: 2597035.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032047.7986; train_global_loss: 30562138.0000; train_optim_loss: 30562138.0000; val_kl_reg_loss: 73934.2578; val_edge_recon_loss: 27080602.0000; val_gene_expr_recon_loss: 2676929.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040545.0000; val_global_loss: 30872008.0000; val_optim_loss: 30872008.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9371; val_auprc_score: 0.9110; val_best_acc_score: 0.8816; val_best_f1_score: 0.8879; train_kl_reg_loss: 73969.9635; train_edge_recon_loss: 27014037.5556; train_gene_expr_recon_loss: 2556251.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033667.8056; train_global_loss: 30677926.4444; train_optim_loss: 30677926.4444; val_kl_reg_loss: 73443.5781; val_edge_recon_loss: 27198058.0000; val_gene_expr_recon_loss: 2599187.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1039772.0000; val_global_loss: 30910460.0000; val_optim_loss: 30910460.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9414; val_auprc_score: 0.9245; val_best_acc_score: 0.8822; val_best_f1_score: 0.8894; train_kl_reg_loss: 73884.8681; train_edge_recon_loss: 26983239.3333; train_gene_expr_recon_loss: 2535575.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1034339.6389; train_global_loss: 30627039.1111; train_optim_loss: 30627039.1111; val_kl_reg_loss: 72947.6094; val_edge_recon_loss: 27189680.0000; val_gene_expr_recon_loss: 2557836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1036082.5000; val_global_loss: 30856546.0000; val_optim_loss: 30856546.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9402; val_auprc_score: 0.9163; val_best_acc_score: 0.8868; val_best_f1_score: 0.8938; train_kl_reg_loss: 73975.8333; train_edge_recon_loss: 26922195.1111; train_gene_expr_recon_loss: 2513172.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031185.8403; train_global_loss: 30540529.3333; train_optim_loss: 30540529.3333; val_kl_reg_loss: 74056.8125; val_edge_recon_loss: 26851460.0000; val_gene_expr_recon_loss: 2560019.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032714.3125; val_global_loss: 30518250.0000; val_optim_loss: 30518250.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9414; val_auprc_score: 0.9204; val_best_acc_score: 0.8856; val_best_f1_score: 0.8926; train_kl_reg_loss: 76723.9210; train_edge_recon_loss: 27023013.5556; train_gene_expr_recon_loss: 2476777.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1022905.7361; train_global_loss: 30599420.8889; train_optim_loss: 30599420.8889; val_kl_reg_loss: 77694.0156; val_edge_recon_loss: 27198776.0000; val_gene_expr_recon_loss: 2509984.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030220.0000; val_global_loss: 30816674.0000; val_optim_loss: 30816674.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9429; val_auprc_score: 0.9226; val_best_acc_score: 0.8905; val_best_f1_score: 0.8963; train_kl_reg_loss: 77118.6415; train_edge_recon_loss: 27030815.3333; train_gene_expr_recon_loss: 2437572.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014900.8403; train_global_loss: 30560407.1111; train_optim_loss: 30560407.1111; val_kl_reg_loss: 74938.5938; val_edge_recon_loss: 27114842.0000; val_gene_expr_recon_loss: 2508264.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028040.4375; val_global_loss: 30726084.0000; val_optim_loss: 30726084.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9453; val_auprc_score: 0.9239; val_best_acc_score: 0.8888; val_best_f1_score: 0.8945; train_kl_reg_loss: 75407.5990; train_edge_recon_loss: 26780330.0000; train_gene_expr_recon_loss: 2440467.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1022817.2778; train_global_loss: 30319022.6667; train_optim_loss: 30319022.6667; val_kl_reg_loss: 76401.1094; val_edge_recon_loss: 26887158.0000; val_gene_expr_recon_loss: 2481055.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027247.8750; val_global_loss: 30471864.0000; val_optim_loss: 30471864.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9494; val_auprc_score: 0.9311; val_best_acc_score: 0.8956; val_best_f1_score: 0.9013; train_kl_reg_loss: 77274.0547; train_edge_recon_loss: 26834048.6667; train_gene_expr_recon_loss: 2410778.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015984.9792; train_global_loss: 30338085.5556; train_optim_loss: 30338085.5556; val_kl_reg_loss: 78408.9219; val_edge_recon_loss: 26924462.0000; val_gene_expr_recon_loss: 2450754.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022442.8750; val_global_loss: 30476066.0000; val_optim_loss: 30476066.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9533; val_auprc_score: 0.9367; val_best_acc_score: 0.9003; val_best_f1_score: 0.9066; train_kl_reg_loss: 80730.4653; train_edge_recon_loss: 26775304.8889; train_gene_expr_recon_loss: 2404178.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1019753.8542; train_global_loss: 30279967.5556; train_optim_loss: 30279967.5556; val_kl_reg_loss: 78921.7500; val_edge_recon_loss: 26827064.0000; val_gene_expr_recon_loss: 2441172.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021862.6250; val_global_loss: 30369020.0000; val_optim_loss: 30369020.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9580; val_auprc_score: 0.9345; val_best_acc_score: 0.9120; val_best_f1_score: 0.9155; train_kl_reg_loss: 78507.5564; train_edge_recon_loss: 26773208.2222; train_gene_expr_recon_loss: 2383395.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012392.3611; train_global_loss: 30247503.3333; train_optim_loss: 30247503.3333; val_kl_reg_loss: 76662.5781; val_edge_recon_loss: 26758730.0000; val_gene_expr_recon_loss: 2446126.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021414.7500; val_global_loss: 30302932.0000; val_optim_loss: 30302932.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9609; val_auprc_score: 0.9452; val_best_acc_score: 0.9120; val_best_f1_score: 0.9165; train_kl_reg_loss: 76674.7023; train_edge_recon_loss: 26557978.4444; train_gene_expr_recon_loss: 2388609.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017063.5972; train_global_loss: 30040326.2222; train_optim_loss: 30040326.2222; val_kl_reg_loss: 74722.7188; val_edge_recon_loss: 26584100.0000; val_gene_expr_recon_loss: 2445893.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020371.6250; val_global_loss: 30125088.0000; val_optim_loss: 30125088.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9589; val_auprc_score: 0.9409; val_best_acc_score: 0.9066; val_best_f1_score: 0.9124; train_kl_reg_loss: 76226.5547; train_edge_recon_loss: 26555106.2222; train_gene_expr_recon_loss: 2377822.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011490.4722; train_global_loss: 30020645.3333; train_optim_loss: 30020645.3333; val_kl_reg_loss: 78271.5703; val_edge_recon_loss: 26685202.0000; val_gene_expr_recon_loss: 2415464.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016828.8125; val_global_loss: 30195766.0000; val_optim_loss: 30195766.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9628; val_auprc_score: 0.9486; val_best_acc_score: 0.9146; val_best_f1_score: 0.9197; train_kl_reg_loss: 80826.2491; train_edge_recon_loss: 26545902.0000; train_gene_expr_recon_loss: 2360687.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011667.4097; train_global_loss: 29999083.5556; train_optim_loss: 29999083.5556; val_kl_reg_loss: 82044.5000; val_edge_recon_loss: 26298032.0000; val_gene_expr_recon_loss: 2419180.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014504.5000; val_global_loss: 29813760.0000; val_optim_loss: 29813760.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9632; val_auprc_score: 0.9489; val_best_acc_score: 0.9111; val_best_f1_score: 0.9142; train_kl_reg_loss: 82361.6111; train_edge_recon_loss: 26449845.1111; train_gene_expr_recon_loss: 2344131.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001435.4097; train_global_loss: 29877773.1111; train_optim_loss: 29877773.1111; val_kl_reg_loss: 82038.4609; val_edge_recon_loss: 26622474.0000; val_gene_expr_recon_loss: 2402489.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013864.1250; val_global_loss: 30120866.0000; val_optim_loss: 30120866.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9649; val_auprc_score: 0.9513; val_best_acc_score: 0.9134; val_best_f1_score: 0.9171; train_kl_reg_loss: 84226.5911; train_edge_recon_loss: 26482798.8889; train_gene_expr_recon_loss: 2330528.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007356.2083; train_global_loss: 29904909.3333; train_optim_loss: 29904909.3333; val_kl_reg_loss: 85201.1562; val_edge_recon_loss: 26541358.0000; val_gene_expr_recon_loss: 2381790.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011255.3125; val_global_loss: 30019606.0000; val_optim_loss: 30019606.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9659; val_auprc_score: 0.9542; val_best_acc_score: 0.9119; val_best_f1_score: 0.9160; train_kl_reg_loss: 85259.4939; train_edge_recon_loss: 26514870.8889; train_gene_expr_recon_loss: 2315984.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003795.1667; train_global_loss: 29919909.7778; train_optim_loss: 29919909.7778; val_kl_reg_loss: 85348.8203; val_edge_recon_loss: 26618954.0000; val_gene_expr_recon_loss: 2398701.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013143.4375; val_global_loss: 30116148.0000; val_optim_loss: 30116148.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9670; val_auprc_score: 0.9552; val_best_acc_score: 0.9175; val_best_f1_score: 0.9216; train_kl_reg_loss: 85428.7821; train_edge_recon_loss: 26487923.3333; train_gene_expr_recon_loss: 2389406.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008581.5972; train_global_loss: 29971341.3333; train_optim_loss: 29971341.3333; val_kl_reg_loss: 35231.9609; val_edge_recon_loss: 26735792.0000; val_gene_expr_recon_loss: 2486368.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022408.6250; val_global_loss: 30279800.0000; val_optim_loss: 30279800.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9661; val_auprc_score: 0.9513; val_best_acc_score: 0.9194; val_best_f1_score: 0.9232; train_kl_reg_loss: 86517.8516; train_edge_recon_loss: 26441834.6667; train_gene_expr_recon_loss: 2405490.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016298.8194; train_global_loss: 29950141.5556; train_optim_loss: 29950141.5556; val_kl_reg_loss: 35856.2461; val_edge_recon_loss: 26689410.0000; val_gene_expr_recon_loss: 2456846.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019483.9375; val_global_loss: 30201596.0000; val_optim_loss: 30201596.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9692; val_auprc_score: 0.9566; val_best_acc_score: 0.9236; val_best_f1_score: 0.9269; train_kl_reg_loss: 87988.3012; train_edge_recon_loss: 26504137.3333; train_gene_expr_recon_loss: 2394532.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018001.3472; train_global_loss: 30004659.7778; train_optim_loss: 30004659.7778; val_kl_reg_loss: 35223.7344; val_edge_recon_loss: 26514992.0000; val_gene_expr_recon_loss: 2469369.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021251.1875; val_global_loss: 30040838.0000; val_optim_loss: 30040838.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9666; val_auprc_score: 0.9471; val_best_acc_score: 0.9201; val_best_f1_score: 0.9232; train_kl_reg_loss: 86820.3628; train_edge_recon_loss: 26426115.1111; train_gene_expr_recon_loss: 2385234.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014153.8125; train_global_loss: 29912323.5556; train_optim_loss: 29912323.5556; val_kl_reg_loss: 35160.1367; val_edge_recon_loss: 26479456.0000; val_gene_expr_recon_loss: 2463993.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020024.3750; val_global_loss: 29998634.0000; val_optim_loss: 29998634.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9705; val_auprc_score: 0.9592; val_best_acc_score: 0.9254; val_best_f1_score: 0.9278; train_kl_reg_loss: 87034.7214; train_edge_recon_loss: 26465578.6667; train_gene_expr_recon_loss: 2393777.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017749.3056; train_global_loss: 29964140.0000; train_optim_loss: 29964140.0000; val_kl_reg_loss: 34212.0391; val_edge_recon_loss: 26347348.0000; val_gene_expr_recon_loss: 2461332.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020116.8125; val_global_loss: 29863008.0000; val_optim_loss: 29863008.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 30 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9649
Val AUPRC score: 0.9521
Val best accuracy score: 0.9140
Val best F1 score: 0.9185
Val gene expr MSE score: 0.7001
Val chrom access MSE score: 0.1121
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
