[True]
Run timestamp: 07092023_175419_69.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_69']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1133 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5654, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7581; val_auprc_score: 0.7790; val_best_acc_score: 0.5110; val_best_f1_score: 0.6714; train_kl_reg_loss: 75995.3545; train_edge_recon_loss: 3552236.8531; train_gene_expr_recon_loss: 28138577.4809; train_masked_gp_l1_reg_loss: 95335.5810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1315972.4637; train_chrom_access_recon_loss: 4004679.7309; train_global_loss: 37182797.4046; train_optim_loss: 37182797.4046; val_kl_reg_loss: 96459.2677; val_edge_recon_loss: 4064236.4000; val_gene_expr_recon_loss: 26149942.4000; val_masked_gp_l1_reg_loss: 89060.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 848487.0000; val_chrom_access_recon_loss: 3779790.4667; val_global_loss: 35027975.2000; val_optim_loss: 35027975.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8644; val_auprc_score: 0.8680; val_best_acc_score: 0.6609; val_best_f1_score: 0.7395; train_kl_reg_loss: 105908.9398; train_edge_recon_loss: 3525904.5477; train_gene_expr_recon_loss: 25910222.7023; train_masked_gp_l1_reg_loss: 85465.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 573849.0382; train_chrom_access_recon_loss: 3818442.6412; train_global_loss: 34019793.3130; train_optim_loss: 34019793.3130; val_kl_reg_loss: 95724.6297; val_edge_recon_loss: 4053279.4000; val_gene_expr_recon_loss: 25565457.6000; val_masked_gp_l1_reg_loss: 83726.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 378037.4062; val_chrom_access_recon_loss: 3724889.2833; val_global_loss: 33901114.9333; val_optim_loss: 33901114.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9032; val_auprc_score: 0.8926; val_best_acc_score: 0.8081; val_best_f1_score: 0.8301; train_kl_reg_loss: 89302.3565; train_edge_recon_loss: 3507577.2710; train_gene_expr_recon_loss: 25505017.6031; train_masked_gp_l1_reg_loss: 86491.7286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 286331.2443; train_chrom_access_recon_loss: 3766447.4485; train_global_loss: 33241167.8626; train_optim_loss: 33241167.8626; val_kl_reg_loss: 72531.4750; val_edge_recon_loss: 3842693.2833; val_gene_expr_recon_loss: 25206028.1333; val_masked_gp_l1_reg_loss: 90488.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219559.0312; val_chrom_access_recon_loss: 3683074.7833; val_global_loss: 33114375.3333; val_optim_loss: 33114375.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8854; val_auprc_score: 0.8684; val_best_acc_score: 0.8088; val_best_f1_score: 0.8258; train_kl_reg_loss: 63755.0727; train_edge_recon_loss: 3291479.4924; train_gene_expr_recon_loss: 25339749.7405; train_masked_gp_l1_reg_loss: 96988.4311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181157.7731; train_chrom_access_recon_loss: 3738610.5573; train_global_loss: 32711741.0229; train_optim_loss: 32711741.0229; val_kl_reg_loss: 57349.1776; val_edge_recon_loss: 3226488.5667; val_gene_expr_recon_loss: 25141190.6667; val_masked_gp_l1_reg_loss: 105030.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154665.1562; val_chrom_access_recon_loss: 3667841.9667; val_global_loss: 32352566.4000; val_optim_loss: 32352566.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8795; val_auprc_score: 0.8681; val_best_acc_score: 0.7886; val_best_f1_score: 0.8110; train_kl_reg_loss: 77204.9201; train_edge_recon_loss: 3019342.6966; train_gene_expr_recon_loss: 25053501.2366; train_masked_gp_l1_reg_loss: 106901.6478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131341.2776; train_chrom_access_recon_loss: 3705482.3092; train_global_loss: 32093773.9847; train_optim_loss: 32093773.9847; val_kl_reg_loss: 91955.2297; val_edge_recon_loss: 2978747.9667; val_gene_expr_recon_loss: 24838334.5333; val_masked_gp_l1_reg_loss: 107664.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112048.5625; val_chrom_access_recon_loss: 3627272.6500; val_global_loss: 31756022.4000; val_optim_loss: 31756022.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8878; val_auprc_score: 0.8765; val_best_acc_score: 0.7957; val_best_f1_score: 0.8164; train_kl_reg_loss: 90698.7296; train_edge_recon_loss: 2945094.4656; train_gene_expr_recon_loss: 24799456.2901; train_masked_gp_l1_reg_loss: 109148.2736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100290.0871; train_chrom_access_recon_loss: 3662298.0115; train_global_loss: 31706985.8168; train_optim_loss: 31706985.8168; val_kl_reg_loss: 94512.0479; val_edge_recon_loss: 2931389.9000; val_gene_expr_recon_loss: 24556463.6000; val_masked_gp_l1_reg_loss: 110575.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90410.0938; val_chrom_access_recon_loss: 3586340.1333; val_global_loss: 31369691.8667; val_optim_loss: 31369691.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8993; val_auprc_score: 0.8891; val_best_acc_score: 0.8102; val_best_f1_score: 0.8235; train_kl_reg_loss: 93534.4224; train_edge_recon_loss: 2915732.6985; train_gene_expr_recon_loss: 24587034.5496; train_masked_gp_l1_reg_loss: 111789.7367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83796.7249; train_chrom_access_recon_loss: 3630711.2061; train_global_loss: 31422599.2672; train_optim_loss: 31422599.2672; val_kl_reg_loss: 95312.2755; val_edge_recon_loss: 2922377.0000; val_gene_expr_recon_loss: 24407238.4000; val_masked_gp_l1_reg_loss: 113282.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78406.9688; val_chrom_access_recon_loss: 3559375.2167; val_global_loss: 31175990.8000; val_optim_loss: 31175990.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9016; val_auprc_score: 0.8910; val_best_acc_score: 0.8162; val_best_f1_score: 0.8261; train_kl_reg_loss: 90183.5571; train_edge_recon_loss: 2903519.8092; train_gene_expr_recon_loss: 24415459.3740; train_masked_gp_l1_reg_loss: 114276.6239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74250.7214; train_chrom_access_recon_loss: 3602060.2977; train_global_loss: 31199750.4580; train_optim_loss: 31199750.4580; val_kl_reg_loss: 91998.4885; val_edge_recon_loss: 2901015.1833; val_gene_expr_recon_loss: 24407790.4000; val_masked_gp_l1_reg_loss: 115777.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70410.8047; val_chrom_access_recon_loss: 3559353.4000; val_global_loss: 31146345.2000; val_optim_loss: 31146345.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9212; val_auprc_score: 0.9093; val_best_acc_score: 0.8432; val_best_f1_score: 0.8570; train_kl_reg_loss: 89916.1079; train_edge_recon_loss: 2866779.7863; train_gene_expr_recon_loss: 24277698.7023; train_masked_gp_l1_reg_loss: 116781.1732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67503.5310; train_chrom_access_recon_loss: 3577283.1756; train_global_loss: 30995962.4427; train_optim_loss: 30995962.4427; val_kl_reg_loss: 88419.4083; val_edge_recon_loss: 2818966.9000; val_gene_expr_recon_loss: 24118549.4667; val_masked_gp_l1_reg_loss: 117708.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65317.7188; val_chrom_access_recon_loss: 3517153.5833; val_global_loss: 30726115.2000; val_optim_loss: 30726115.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9290; val_auprc_score: 0.9157; val_best_acc_score: 0.8595; val_best_f1_score: 0.8668; train_kl_reg_loss: 91568.2428; train_edge_recon_loss: 2827392.1565; train_gene_expr_recon_loss: 24116197.9237; train_masked_gp_l1_reg_loss: 118805.9974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62847.9280; train_chrom_access_recon_loss: 3552009.8893; train_global_loss: 30768822.1527; train_optim_loss: 30768822.1527; val_kl_reg_loss: 91418.0458; val_edge_recon_loss: 2819674.0833; val_gene_expr_recon_loss: 24034940.9333; val_masked_gp_l1_reg_loss: 119719.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61561.9258; val_chrom_access_recon_loss: 3495651.5667; val_global_loss: 30622966.8000; val_optim_loss: 30622966.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9368; val_auprc_score: 0.9272; val_best_acc_score: 0.8649; val_best_f1_score: 0.8738; train_kl_reg_loss: 93798.8288; train_edge_recon_loss: 2782191.4370; train_gene_expr_recon_loss: 23990622.8244; train_masked_gp_l1_reg_loss: 120905.3071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59495.4787; train_chrom_access_recon_loss: 3532460.0954; train_global_loss: 30579474.0153; train_optim_loss: 30579474.0153; val_kl_reg_loss: 94842.9146; val_edge_recon_loss: 2820037.7667; val_gene_expr_recon_loss: 23923506.9333; val_masked_gp_l1_reg_loss: 122405.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57943.1406; val_chrom_access_recon_loss: 3476850.5000; val_global_loss: 30495588.0000; val_optim_loss: 30495588.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9499; val_auprc_score: 0.9405; val_best_acc_score: 0.8812; val_best_f1_score: 0.8865; train_kl_reg_loss: 93749.1617; train_edge_recon_loss: 2774288.0401; train_gene_expr_recon_loss: 23872137.7863; train_masked_gp_l1_reg_loss: 123006.0971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56865.4034; train_chrom_access_recon_loss: 3513170.2901; train_global_loss: 30433216.8550; train_optim_loss: 30433216.8550; val_kl_reg_loss: 91634.8589; val_edge_recon_loss: 2751853.4833; val_gene_expr_recon_loss: 23706108.9333; val_masked_gp_l1_reg_loss: 123489.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55723.0234; val_chrom_access_recon_loss: 3444960.4000; val_global_loss: 30173771.8667; val_optim_loss: 30173771.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9474; val_auprc_score: 0.9347; val_best_acc_score: 0.8841; val_best_f1_score: 0.8909; train_kl_reg_loss: 92231.0507; train_edge_recon_loss: 2765696.6889; train_gene_expr_recon_loss: 23784780.0153; train_masked_gp_l1_reg_loss: 124459.7983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54802.3350; train_chrom_access_recon_loss: 3497635.9943; train_global_loss: 30319605.7863; train_optim_loss: 30319605.7863; val_kl_reg_loss: 92199.4552; val_edge_recon_loss: 2773708.1833; val_gene_expr_recon_loss: 23695730.2667; val_masked_gp_l1_reg_loss: 125180.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53818.0117; val_chrom_access_recon_loss: 3444514.9500; val_global_loss: 30185150.9333; val_optim_loss: 30185150.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9530; val_auprc_score: 0.9416; val_best_acc_score: 0.8890; val_best_f1_score: 0.8935; train_kl_reg_loss: 93278.1740; train_edge_recon_loss: 2750766.8492; train_gene_expr_recon_loss: 23697471.1450; train_masked_gp_l1_reg_loss: 125828.6000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52859.8600; train_chrom_access_recon_loss: 3483551.7901; train_global_loss: 30203756.5191; train_optim_loss: 30203756.5191; val_kl_reg_loss: 90918.7307; val_edge_recon_loss: 2753712.0500; val_gene_expr_recon_loss: 23550938.1333; val_masked_gp_l1_reg_loss: 126604.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52201.0391; val_chrom_access_recon_loss: 3416505.6167; val_global_loss: 29990880.8000; val_optim_loss: 29990880.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9564; val_auprc_score: 0.9458; val_best_acc_score: 0.8950; val_best_f1_score: 0.9000; train_kl_reg_loss: 91384.6938; train_edge_recon_loss: 2742860.2805; train_gene_expr_recon_loss: 23610126.1374; train_masked_gp_l1_reg_loss: 127159.1654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51540.2674; train_chrom_access_recon_loss: 3468066.8359; train_global_loss: 30091137.2824; train_optim_loss: 30091137.2824; val_kl_reg_loss: 90331.2026; val_edge_recon_loss: 2750715.4667; val_gene_expr_recon_loss: 23519269.3333; val_masked_gp_l1_reg_loss: 127675.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50965.7656; val_chrom_access_recon_loss: 3413654.2500; val_global_loss: 29952612.1333; val_optim_loss: 29952612.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9567; val_auprc_score: 0.9398; val_best_acc_score: 0.8971; val_best_f1_score: 0.9017; train_kl_reg_loss: 89990.7198; train_edge_recon_loss: 2727756.0782; train_gene_expr_recon_loss: 23532157.4198; train_masked_gp_l1_reg_loss: 128392.3798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50380.8248; train_chrom_access_recon_loss: 3458490.7328; train_global_loss: 29987168.1985; train_optim_loss: 29987168.1985; val_kl_reg_loss: 87973.5333; val_edge_recon_loss: 2741426.6000; val_gene_expr_recon_loss: 23434038.4000; val_masked_gp_l1_reg_loss: 128978.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49921.9648; val_chrom_access_recon_loss: 3392028.5167; val_global_loss: 29834367.4667; val_optim_loss: 29834367.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9618; val_auprc_score: 0.9521; val_best_acc_score: 0.9025; val_best_f1_score: 0.9066; train_kl_reg_loss: 89464.3575; train_edge_recon_loss: 2727675.4885; train_gene_expr_recon_loss: 23465673.4046; train_masked_gp_l1_reg_loss: 129427.7529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49523.4980; train_chrom_access_recon_loss: 3445267.9408; train_global_loss: 29907032.3206; train_optim_loss: 29907032.3206; val_kl_reg_loss: 86919.4661; val_edge_recon_loss: 2738708.3833; val_gene_expr_recon_loss: 23346463.7333; val_masked_gp_l1_reg_loss: 130153.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49724.0508; val_chrom_access_recon_loss: 3378613.1833; val_global_loss: 29730582.9333; val_optim_loss: 29730582.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9633; val_auprc_score: 0.9536; val_best_acc_score: 0.9058; val_best_f1_score: 0.9079; train_kl_reg_loss: 88634.3724; train_edge_recon_loss: 2727861.6031; train_gene_expr_recon_loss: 23403004.0763; train_masked_gp_l1_reg_loss: 130440.2237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48919.2786; train_chrom_access_recon_loss: 3437226.1279; train_global_loss: 29836085.6031; train_optim_loss: 29836085.6031; val_kl_reg_loss: 88034.4781; val_edge_recon_loss: 2739060.1500; val_gene_expr_recon_loss: 23362639.7333; val_masked_gp_l1_reg_loss: 130896.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48502.6445; val_chrom_access_recon_loss: 3377019.9667; val_global_loss: 29746152.1333; val_optim_loss: 29746152.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9628; val_auprc_score: 0.9526; val_best_acc_score: 0.9061; val_best_f1_score: 0.9105; train_kl_reg_loss: 87343.6608; train_edge_recon_loss: 2723008.8779; train_gene_expr_recon_loss: 23337256.6870; train_masked_gp_l1_reg_loss: 131364.5979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48468.5887; train_chrom_access_recon_loss: 3427379.8244; train_global_loss: 29754822.1832; train_optim_loss: 29754822.1832; val_kl_reg_loss: 85043.0516; val_edge_recon_loss: 2736379.9000; val_gene_expr_recon_loss: 23241841.2000; val_masked_gp_l1_reg_loss: 131858.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48370.0156; val_chrom_access_recon_loss: 3364136.7833; val_global_loss: 29607629.0667; val_optim_loss: 29607629.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9684; val_auprc_score: 0.9587; val_best_acc_score: 0.9185; val_best_f1_score: 0.9214; train_kl_reg_loss: 86801.4665; train_edge_recon_loss: 2718796.8683; train_gene_expr_recon_loss: 23257827.7863; train_masked_gp_l1_reg_loss: 132287.0302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48135.7302; train_chrom_access_recon_loss: 3415987.8473; train_global_loss: 29659836.7634; train_optim_loss: 29659836.7634; val_kl_reg_loss: 83850.1141; val_edge_recon_loss: 2719185.2500; val_gene_expr_recon_loss: 23289194.0000; val_masked_gp_l1_reg_loss: 132840.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48376.3828; val_chrom_access_recon_loss: 3383754.3667; val_global_loss: 29657199.6000; val_optim_loss: 29657199.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9704; val_auprc_score: 0.9625; val_best_acc_score: 0.9188; val_best_f1_score: 0.9211; train_kl_reg_loss: 86120.9135; train_edge_recon_loss: 2706819.7042; train_gene_expr_recon_loss: 23219377.8473; train_masked_gp_l1_reg_loss: 133112.4048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48179.2936; train_chrom_access_recon_loss: 3407717.0267; train_global_loss: 29601327.2366; train_optim_loss: 29601327.2366; val_kl_reg_loss: 85225.2911; val_edge_recon_loss: 2706947.3167; val_gene_expr_recon_loss: 23131322.6667; val_masked_gp_l1_reg_loss: 133369.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47970.1797; val_chrom_access_recon_loss: 3359101.6000; val_global_loss: 29463936.6667; val_optim_loss: 29463936.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9705; val_auprc_score: 0.9630; val_best_acc_score: 0.9171; val_best_f1_score: 0.9203; train_kl_reg_loss: 85757.9227; train_edge_recon_loss: 2706591.9866; train_gene_expr_recon_loss: 23169777.7405; train_masked_gp_l1_reg_loss: 133859.6460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48166.2917; train_chrom_access_recon_loss: 3400414.1336; train_global_loss: 29544567.6947; train_optim_loss: 29544567.6947; val_kl_reg_loss: 85714.3698; val_edge_recon_loss: 2717662.5333; val_gene_expr_recon_loss: 23062985.4667; val_masked_gp_l1_reg_loss: 134365.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48377.2969; val_chrom_access_recon_loss: 3340573.8667; val_global_loss: 29389680.1333; val_optim_loss: 29389680.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9728; val_auprc_score: 0.9665; val_best_acc_score: 0.9206; val_best_f1_score: 0.9230; train_kl_reg_loss: 85065.7410; train_edge_recon_loss: 2711648.2882; train_gene_expr_recon_loss: 23141121.8779; train_masked_gp_l1_reg_loss: 134564.4014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48478.7371; train_chrom_access_recon_loss: 3393680.8492; train_global_loss: 29514559.8321; train_optim_loss: 29514559.8321; val_kl_reg_loss: 85102.6781; val_edge_recon_loss: 2707340.2333; val_gene_expr_recon_loss: 23149950.8000; val_masked_gp_l1_reg_loss: 134822.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48827.7188; val_chrom_access_recon_loss: 3363933.4500; val_global_loss: 29489977.2000; val_optim_loss: 29489977.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9704; val_auprc_score: 0.9620; val_best_acc_score: 0.9171; val_best_f1_score: 0.9199; train_kl_reg_loss: 85149.1554; train_edge_recon_loss: 2691845.4809; train_gene_expr_recon_loss: 23094202.1679; train_masked_gp_l1_reg_loss: 135225.5606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48770.2190; train_chrom_access_recon_loss: 3390144.2996; train_global_loss: 29445336.9160; train_optim_loss: 29445336.9160; val_kl_reg_loss: 85189.9724; val_edge_recon_loss: 2712855.6167; val_gene_expr_recon_loss: 23069595.3333; val_masked_gp_l1_reg_loss: 135688.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49036.8516; val_chrom_access_recon_loss: 3333034.5833; val_global_loss: 29385399.6000; val_optim_loss: 29385399.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9703; val_auprc_score: 0.9597; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 84900.6884; train_edge_recon_loss: 2695196.6088; train_gene_expr_recon_loss: 23033252.5649; train_masked_gp_l1_reg_loss: 135841.9263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48877.6797; train_chrom_access_recon_loss: 3380093.8664; train_global_loss: 29378163.3435; train_optim_loss: 29378163.3435; val_kl_reg_loss: 83585.1932; val_edge_recon_loss: 2715112.7167; val_gene_expr_recon_loss: 23038697.8667; val_masked_gp_l1_reg_loss: 136156.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49143.8086; val_chrom_access_recon_loss: 3322979.6500; val_global_loss: 29345675.4667; val_optim_loss: 29345675.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9733; val_auprc_score: 0.9662; val_best_acc_score: 0.9258; val_best_f1_score: 0.9285; train_kl_reg_loss: 88709.3506; train_edge_recon_loss: 2716528.3893; train_gene_expr_recon_loss: 22650212.2290; train_masked_gp_l1_reg_loss: 133608.8136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40304.6153; train_chrom_access_recon_loss: 3337302.2844; train_global_loss: 28966665.6641; train_optim_loss: 28966665.6641; val_kl_reg_loss: 63917.9943; val_edge_recon_loss: 2716674.2667; val_gene_expr_recon_loss: 22612659.3333; val_masked_gp_l1_reg_loss: 133211.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38511.2773; val_chrom_access_recon_loss: 3279582.2333; val_global_loss: 28844558.1333; val_optim_loss: 28844558.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9750; val_auprc_score: 0.9688; val_best_acc_score: 0.9268; val_best_f1_score: 0.9296; train_kl_reg_loss: 88606.2510; train_edge_recon_loss: 2708833.9351; train_gene_expr_recon_loss: 22577758.1221; train_masked_gp_l1_reg_loss: 133199.2560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38378.5735; train_chrom_access_recon_loss: 3323797.7137; train_global_loss: 28870573.9084; train_optim_loss: 28870573.9084; val_kl_reg_loss: 67547.8010; val_edge_recon_loss: 2700057.5333; val_gene_expr_recon_loss: 22479610.9333; val_masked_gp_l1_reg_loss: 133267.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38236.4961; val_chrom_access_recon_loss: 3274928.6000; val_global_loss: 28693648.8000; val_optim_loss: 28693648.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9758; val_auprc_score: 0.9696; val_best_acc_score: 0.9275; val_best_f1_score: 0.9312; train_kl_reg_loss: 85592.3457; train_edge_recon_loss: 2703020.3645; train_gene_expr_recon_loss: 22549143.4504; train_masked_gp_l1_reg_loss: 133359.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38267.3243; train_chrom_access_recon_loss: 3321263.2557; train_global_loss: 28830646.2137; train_optim_loss: 28830646.2137; val_kl_reg_loss: 74806.2474; val_edge_recon_loss: 2704012.3500; val_gene_expr_recon_loss: 22460923.0667; val_masked_gp_l1_reg_loss: 133299.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38231.2031; val_chrom_access_recon_loss: 3289015.1333; val_global_loss: 28700288.9333; val_optim_loss: 28700288.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9741; val_auprc_score: 0.9646; val_best_acc_score: 0.9272; val_best_f1_score: 0.9294; train_kl_reg_loss: 83525.7090; train_edge_recon_loss: 2704712.9485; train_gene_expr_recon_loss: 22502769.6947; train_masked_gp_l1_reg_loss: 133331.7026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37810.1258; train_chrom_access_recon_loss: 3315563.3359; train_global_loss: 28777713.8626; train_optim_loss: 28777713.8626; val_kl_reg_loss: 68224.6734; val_edge_recon_loss: 2727396.9167; val_gene_expr_recon_loss: 22447477.2000; val_masked_gp_l1_reg_loss: 133242.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37711.5703; val_chrom_access_recon_loss: 3261440.0500; val_global_loss: 28675492.8000; val_optim_loss: 28675492.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9776; val_auprc_score: 0.9726; val_best_acc_score: 0.9349; val_best_f1_score: 0.9366; train_kl_reg_loss: 81436.9504; train_edge_recon_loss: 2698284.3931; train_gene_expr_recon_loss: 22450572.4885; train_masked_gp_l1_reg_loss: 133344.0023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37784.0245; train_chrom_access_recon_loss: 3307690.9103; train_global_loss: 28709112.8855; train_optim_loss: 28709112.8855; val_kl_reg_loss: 69862.1891; val_edge_recon_loss: 2693888.7167; val_gene_expr_recon_loss: 22421138.5333; val_masked_gp_l1_reg_loss: 133463.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37760.5078; val_chrom_access_recon_loss: 3267671.4333; val_global_loss: 28623784.9333; val_optim_loss: 28623784.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9785; val_auprc_score: 0.9730; val_best_acc_score: 0.9357; val_best_f1_score: 0.9379; train_kl_reg_loss: 80212.7078; train_edge_recon_loss: 2691378.8359; train_gene_expr_recon_loss: 22420176.6412; train_masked_gp_l1_reg_loss: 133434.2668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37946.2118; train_chrom_access_recon_loss: 3301536.0515; train_global_loss: 28664684.6870; train_optim_loss: 28664684.6870; val_kl_reg_loss: 70661.9464; val_edge_recon_loss: 2691576.4500; val_gene_expr_recon_loss: 22354280.6667; val_masked_gp_l1_reg_loss: 133542.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38120.8438; val_chrom_access_recon_loss: 3251555.6167; val_global_loss: 28539736.5333; val_optim_loss: 28539736.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9790; val_auprc_score: 0.9720; val_best_acc_score: 0.9332; val_best_f1_score: 0.9361; train_kl_reg_loss: 79692.0660; train_edge_recon_loss: 2692266.8702; train_gene_expr_recon_loss: 22393056.8550; train_masked_gp_l1_reg_loss: 133503.9153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38124.6050; train_chrom_access_recon_loss: 3300461.5210; train_global_loss: 28637105.8473; train_optim_loss: 28637105.8473; val_kl_reg_loss: 71591.4917; val_edge_recon_loss: 2700317.7833; val_gene_expr_recon_loss: 22357782.2667; val_masked_gp_l1_reg_loss: 133539.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38193.5586; val_chrom_access_recon_loss: 3249862.7167; val_global_loss: 28551288.4000; val_optim_loss: 28551288.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9737; val_auprc_score: 0.9654; val_best_acc_score: 0.9258; val_best_f1_score: 0.9292; train_kl_reg_loss: 78087.3391; train_edge_recon_loss: 2681016.2309; train_gene_expr_recon_loss: 22372051.9237; train_masked_gp_l1_reg_loss: 133595.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38298.3397; train_chrom_access_recon_loss: 3298429.9885; train_global_loss: 28601479.4046; train_optim_loss: 28601479.4046; val_kl_reg_loss: 72308.0078; val_edge_recon_loss: 2710461.9500; val_gene_expr_recon_loss: 22344971.4667; val_masked_gp_l1_reg_loss: 133588.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38274.5898; val_chrom_access_recon_loss: 3252289.2667; val_global_loss: 28551892.6667; val_optim_loss: 28551892.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9777; val_auprc_score: 0.9702; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 77484.4284; train_edge_recon_loss: 2686541.0420; train_gene_expr_recon_loss: 22360387.0687; train_masked_gp_l1_reg_loss: 133613.1180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38362.3198; train_chrom_access_recon_loss: 3294772.8359; train_global_loss: 28591160.7023; train_optim_loss: 28591160.7023; val_kl_reg_loss: 72725.1984; val_edge_recon_loss: 2690053.8000; val_gene_expr_recon_loss: 22296464.5333; val_masked_gp_l1_reg_loss: 133721.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38367.1875; val_chrom_access_recon_loss: 3239804.1333; val_global_loss: 28471137.4667; val_optim_loss: 28471137.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9784; val_auprc_score: 0.9723; val_best_acc_score: 0.9333; val_best_f1_score: 0.9353; train_kl_reg_loss: 76049.0090; train_edge_recon_loss: 2687048.8912; train_gene_expr_recon_loss: 22307470.4275; train_masked_gp_l1_reg_loss: 133769.9439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38487.2408; train_chrom_access_recon_loss: 3287798.9008; train_global_loss: 28530624.5191; train_optim_loss: 28530624.5191; val_kl_reg_loss: 71624.7604; val_edge_recon_loss: 2703508.9000; val_gene_expr_recon_loss: 22264910.5333; val_masked_gp_l1_reg_loss: 133868.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38361.7852; val_chrom_access_recon_loss: 3239780.2500; val_global_loss: 28452054.5333; val_optim_loss: 28452054.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9782; val_auprc_score: 0.9710; val_best_acc_score: 0.9340; val_best_f1_score: 0.9358; train_kl_reg_loss: 76421.0358; train_edge_recon_loss: 2680989.9733; train_gene_expr_recon_loss: 22301885.3893; train_masked_gp_l1_reg_loss: 133881.3089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38414.0434; train_chrom_access_recon_loss: 3283878.4332; train_global_loss: 28515470.1069; train_optim_loss: 28515470.1069; val_kl_reg_loss: 73006.3094; val_edge_recon_loss: 2698387.7500; val_gene_expr_recon_loss: 22285801.0667; val_masked_gp_l1_reg_loss: 133832.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38466.7344; val_chrom_access_recon_loss: 3227799.6500; val_global_loss: 28457292.5333; val_optim_loss: 28457292.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9801; val_auprc_score: 0.9754; val_best_acc_score: 0.9373; val_best_f1_score: 0.9390; train_kl_reg_loss: 75980.2974; train_edge_recon_loss: 2687805.6508; train_gene_expr_recon_loss: 22273516.7634; train_masked_gp_l1_reg_loss: 133900.6094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38434.9362; train_chrom_access_recon_loss: 3275706.8950; train_global_loss: 28485345.2214; train_optim_loss: 28485345.2214; val_kl_reg_loss: 71631.5849; val_edge_recon_loss: 2681173.4333; val_gene_expr_recon_loss: 22256623.2000; val_masked_gp_l1_reg_loss: 134072.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38485.0508; val_chrom_access_recon_loss: 3226872.2667; val_global_loss: 28408858.5333; val_optim_loss: 28408858.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9833; val_auprc_score: 0.9783; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 75337.0047; train_edge_recon_loss: 2686291.7061; train_gene_expr_recon_loss: 22244798.8092; train_masked_gp_l1_reg_loss: 134145.0921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38574.3374; train_chrom_access_recon_loss: 3275172.6756; train_global_loss: 28454319.5725; train_optim_loss: 28454319.5725; val_kl_reg_loss: 71254.2422; val_edge_recon_loss: 2696126.4833; val_gene_expr_recon_loss: 22278796.4000; val_masked_gp_l1_reg_loss: 134201.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38563.0000; val_chrom_access_recon_loss: 3218492.2500; val_global_loss: 28437434.6667; val_optim_loss: 28437434.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9813; val_auprc_score: 0.9767; val_best_acc_score: 0.9414; val_best_f1_score: 0.9432; train_kl_reg_loss: 75233.9742; train_edge_recon_loss: 2680418.9618; train_gene_expr_recon_loss: 22229778.6412; train_masked_gp_l1_reg_loss: 134359.0271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38560.6741; train_chrom_access_recon_loss: 3275130.7214; train_global_loss: 28433482.0611; train_optim_loss: 28433482.0611; val_kl_reg_loss: 73392.1828; val_edge_recon_loss: 2682833.2167; val_gene_expr_recon_loss: 22242594.2667; val_masked_gp_l1_reg_loss: 134465.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38605.1133; val_chrom_access_recon_loss: 3220190.2000; val_global_loss: 28392081.8667; val_optim_loss: 28392081.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9834; val_auprc_score: 0.9769; val_best_acc_score: 0.9465; val_best_f1_score: 0.9476; train_kl_reg_loss: 74488.6283; train_edge_recon_loss: 2683102.0878; train_gene_expr_recon_loss: 22216460.5038; train_masked_gp_l1_reg_loss: 134485.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38586.2937; train_chrom_access_recon_loss: 3273474.7519; train_global_loss: 28420597.7252; train_optim_loss: 28420597.7252; val_kl_reg_loss: 74263.5349; val_edge_recon_loss: 2676082.3000; val_gene_expr_recon_loss: 22206671.8667; val_masked_gp_l1_reg_loss: 134567.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38700.8047; val_chrom_access_recon_loss: 3216959.4833; val_global_loss: 28347245.0667; val_optim_loss: 28347245.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9799; val_auprc_score: 0.9708; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 74097.8409; train_edge_recon_loss: 2685598.2004; train_gene_expr_recon_loss: 22187747.3893; train_masked_gp_l1_reg_loss: 134690.2864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38658.8901; train_chrom_access_recon_loss: 3271118.9809; train_global_loss: 28391911.4198; train_optim_loss: 28391911.4198; val_kl_reg_loss: 72914.6562; val_edge_recon_loss: 2696300.8500; val_gene_expr_recon_loss: 22218685.0667; val_masked_gp_l1_reg_loss: 134844.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38550.7578; val_chrom_access_recon_loss: 3242674.5000; val_global_loss: 28403969.2000; val_optim_loss: 28403969.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9850; val_auprc_score: 0.9807; val_best_acc_score: 0.9461; val_best_f1_score: 0.9466; train_kl_reg_loss: 73867.3132; train_edge_recon_loss: 2681452.0019; train_gene_expr_recon_loss: 22173322.0763; train_masked_gp_l1_reg_loss: 134933.9710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38634.5125; train_chrom_access_recon_loss: 3266757.1947; train_global_loss: 28368967.1450; train_optim_loss: 28368967.1450; val_kl_reg_loss: 71901.5609; val_edge_recon_loss: 2683999.3500; val_gene_expr_recon_loss: 22162291.0667; val_masked_gp_l1_reg_loss: 134986.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38597.1055; val_chrom_access_recon_loss: 3224279.7833; val_global_loss: 28316055.6000; val_optim_loss: 28316055.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9846; val_auprc_score: 0.9814; val_best_acc_score: 0.9470; val_best_f1_score: 0.9487; train_kl_reg_loss: 74108.9095; train_edge_recon_loss: 2680556.0802; train_gene_expr_recon_loss: 22148746.3969; train_masked_gp_l1_reg_loss: 135124.1252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38642.1988; train_chrom_access_recon_loss: 3267183.2233; train_global_loss: 28344360.8244; train_optim_loss: 28344360.8244; val_kl_reg_loss: 70383.9729; val_edge_recon_loss: 2688175.5167; val_gene_expr_recon_loss: 22082875.3333; val_masked_gp_l1_reg_loss: 135284.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38516.6797; val_chrom_access_recon_loss: 3207897.1167; val_global_loss: 28223131.8667; val_optim_loss: 28223131.8667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9807; val_auprc_score: 0.9732; val_best_acc_score: 0.9406; val_best_f1_score: 0.9417; train_kl_reg_loss: 73399.6379; train_edge_recon_loss: 2684463.7290; train_gene_expr_recon_loss: 22139498.6107; train_masked_gp_l1_reg_loss: 135386.7223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38639.9394; train_chrom_access_recon_loss: 3266999.8874; train_global_loss: 28338388.4885; train_optim_loss: 28338388.4885; val_kl_reg_loss: 72396.2708; val_edge_recon_loss: 2714088.9333; val_gene_expr_recon_loss: 22171615.2000; val_masked_gp_l1_reg_loss: 135503.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38703.5859; val_chrom_access_recon_loss: 3216408.0333; val_global_loss: 28348716.4000; val_optim_loss: 28348716.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9845; val_auprc_score: 0.9801; val_best_acc_score: 0.9452; val_best_f1_score: 0.9466; train_kl_reg_loss: 73135.5451; train_edge_recon_loss: 2685884.2195; train_gene_expr_recon_loss: 22131049.0687; train_masked_gp_l1_reg_loss: 135603.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38682.4283; train_chrom_access_recon_loss: 3266319.4905; train_global_loss: 28330674.4733; train_optim_loss: 28330674.4733; val_kl_reg_loss: 70021.2927; val_edge_recon_loss: 2692116.2667; val_gene_expr_recon_loss: 22102284.9333; val_masked_gp_l1_reg_loss: 135781.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38741.2734; val_chrom_access_recon_loss: 3210175.9500; val_global_loss: 28249122.6667; val_optim_loss: 28249122.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9839; val_auprc_score: 0.9799; val_best_acc_score: 0.9438; val_best_f1_score: 0.9456; train_kl_reg_loss: 73649.4518; train_edge_recon_loss: 2675021.0248; train_gene_expr_recon_loss: 22088427.9695; train_masked_gp_l1_reg_loss: 135802.5641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38730.6091; train_chrom_access_recon_loss: 3262409.1145; train_global_loss: 28274040.7786; train_optim_loss: 28274040.7786; val_kl_reg_loss: 72313.4745; val_edge_recon_loss: 2689287.5500; val_gene_expr_recon_loss: 22142579.7333; val_masked_gp_l1_reg_loss: 135922.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38599.7383; val_chrom_access_recon_loss: 3203932.9333; val_global_loss: 28282635.6000; val_optim_loss: 28282635.6000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9847; val_auprc_score: 0.9797; val_best_acc_score: 0.9454; val_best_f1_score: 0.9465; train_kl_reg_loss: 73815.0236; train_edge_recon_loss: 2675313.2844; train_gene_expr_recon_loss: 22076307.1756; train_masked_gp_l1_reg_loss: 136031.8449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38755.8281; train_chrom_access_recon_loss: 3260290.9809; train_global_loss: 28260513.9084; train_optim_loss: 28260513.9084; val_kl_reg_loss: 71946.6156; val_edge_recon_loss: 2681904.8333; val_gene_expr_recon_loss: 22026052.5333; val_masked_gp_l1_reg_loss: 136108.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38699.0898; val_chrom_access_recon_loss: 3220253.2833; val_global_loss: 28174965.4667; val_optim_loss: 28174965.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9835; val_auprc_score: 0.9786; val_best_acc_score: 0.9452; val_best_f1_score: 0.9463; train_kl_reg_loss: 72936.2204; train_edge_recon_loss: 2679397.6698; train_gene_expr_recon_loss: 22065477.3130; train_masked_gp_l1_reg_loss: 136273.5086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38710.4401; train_chrom_access_recon_loss: 3261129.4447; train_global_loss: 28253924.5649; train_optim_loss: 28253924.5649; val_kl_reg_loss: 71680.6505; val_edge_recon_loss: 2693563.9333; val_gene_expr_recon_loss: 22176917.6000; val_masked_gp_l1_reg_loss: 136427.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38775.4609; val_chrom_access_recon_loss: 3217489.5500; val_global_loss: 28334855.6000; val_optim_loss: 28334855.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9857; val_auprc_score: 0.9823; val_best_acc_score: 0.9492; val_best_f1_score: 0.9500; train_kl_reg_loss: 72755.0901; train_edge_recon_loss: 2678714.5515; train_gene_expr_recon_loss: 22041853.3588; train_masked_gp_l1_reg_loss: 136512.0736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38802.8927; train_chrom_access_recon_loss: 3261553.9924; train_global_loss: 28230192.1069; train_optim_loss: 28230192.1069; val_kl_reg_loss: 70474.8448; val_edge_recon_loss: 2678074.3167; val_gene_expr_recon_loss: 22028073.7333; val_masked_gp_l1_reg_loss: 136665.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38689.1953; val_chrom_access_recon_loss: 3214293.7833; val_global_loss: 28166272.5333; val_optim_loss: 28166272.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9849; val_auprc_score: 0.9795; val_best_acc_score: 0.9503; val_best_f1_score: 0.9511; train_kl_reg_loss: 73136.1501; train_edge_recon_loss: 2680515.4122; train_gene_expr_recon_loss: 22019845.1450; train_masked_gp_l1_reg_loss: 136732.6280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38700.7320; train_chrom_access_recon_loss: 3257560.1660; train_global_loss: 28206490.0611; train_optim_loss: 28206490.0611; val_kl_reg_loss: 71076.9734; val_edge_recon_loss: 2682032.1667; val_gene_expr_recon_loss: 22133524.8000; val_masked_gp_l1_reg_loss: 136679.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38602.9297; val_chrom_access_recon_loss: 3217646.0000; val_global_loss: 28279562.4000; val_optim_loss: 28279562.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9838; val_auprc_score: 0.9764; val_best_acc_score: 0.9472; val_best_f1_score: 0.9482; train_kl_reg_loss: 73062.3591; train_edge_recon_loss: 2673996.9790; train_gene_expr_recon_loss: 21999830.7328; train_masked_gp_l1_reg_loss: 136949.3938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38762.6160; train_chrom_access_recon_loss: 3257437.8416; train_global_loss: 28180039.6183; train_optim_loss: 28180039.6183; val_kl_reg_loss: 71064.3286; val_edge_recon_loss: 2674501.7000; val_gene_expr_recon_loss: 22039047.4667; val_masked_gp_l1_reg_loss: 136922.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38622.4531; val_chrom_access_recon_loss: 3211884.3667; val_global_loss: 28172042.1333; val_optim_loss: 28172042.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9854; val_auprc_score: 0.9820; val_best_acc_score: 0.9470; val_best_f1_score: 0.9476; train_kl_reg_loss: 73022.8633; train_edge_recon_loss: 2672407.3187; train_gene_expr_recon_loss: 22001227.4504; train_masked_gp_l1_reg_loss: 137057.0692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38763.2320; train_chrom_access_recon_loss: 3257603.0802; train_global_loss: 28180081.0229; train_optim_loss: 28180081.0229; val_kl_reg_loss: 70064.6771; val_edge_recon_loss: 2683464.7667; val_gene_expr_recon_loss: 22118803.4667; val_masked_gp_l1_reg_loss: 137188.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38637.5820; val_chrom_access_recon_loss: 3211764.6667; val_global_loss: 28259923.7333; val_optim_loss: 28259923.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9880; val_auprc_score: 0.9856; val_best_acc_score: 0.9511; val_best_f1_score: 0.9524; train_kl_reg_loss: 72486.1715; train_edge_recon_loss: 2673966.2615; train_gene_expr_recon_loss: 21976485.4198; train_masked_gp_l1_reg_loss: 137309.5011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38757.7383; train_chrom_access_recon_loss: 3255545.9141; train_global_loss: 28154551.0992; train_optim_loss: 28154551.0992; val_kl_reg_loss: 72567.3375; val_edge_recon_loss: 2669565.0167; val_gene_expr_recon_loss: 22061693.0667; val_masked_gp_l1_reg_loss: 137417.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38709.4258; val_chrom_access_recon_loss: 3213908.8500; val_global_loss: 28193862.4000; val_optim_loss: 28193862.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9842; val_auprc_score: 0.9786; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 73865.9614; train_edge_recon_loss: 2668784.4962; train_gene_expr_recon_loss: 21922137.1756; train_masked_gp_l1_reg_loss: 136030.8109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35012.7042; train_chrom_access_recon_loss: 3248796.2653; train_global_loss: 28084627.3893; train_optim_loss: 28084627.3893; val_kl_reg_loss: 73413.0760; val_edge_recon_loss: 2684936.4667; val_gene_expr_recon_loss: 22054396.6667; val_masked_gp_l1_reg_loss: 135476.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34310.0000; val_chrom_access_recon_loss: 3217708.0833; val_global_loss: 28200240.1333; val_optim_loss: 28200240.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9872; val_auprc_score: 0.9827; val_best_acc_score: 0.9530; val_best_f1_score: 0.9541; train_kl_reg_loss: 73990.4518; train_edge_recon_loss: 2672266.7767; train_gene_expr_recon_loss: 21933552.2443; train_masked_gp_l1_reg_loss: 135312.2619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34041.5979; train_chrom_access_recon_loss: 3253308.7901; train_global_loss: 28102472.0305; train_optim_loss: 28102472.0305; val_kl_reg_loss: 73507.7760; val_edge_recon_loss: 2676395.5333; val_gene_expr_recon_loss: 21974440.0000; val_masked_gp_l1_reg_loss: 135187.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33787.5195; val_chrom_access_recon_loss: 3213072.4333; val_global_loss: 28106392.0000; val_optim_loss: 28106392.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9874; val_auprc_score: 0.9833; val_best_acc_score: 0.9541; val_best_f1_score: 0.9551; train_kl_reg_loss: 74452.7929; train_edge_recon_loss: 2672264.3798; train_gene_expr_recon_loss: 21920561.2977; train_masked_gp_l1_reg_loss: 135132.5731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33606.9562; train_chrom_access_recon_loss: 3251122.1718; train_global_loss: 28087140.1985; train_optim_loss: 28087140.1985; val_kl_reg_loss: 73990.3391; val_edge_recon_loss: 2677183.7500; val_gene_expr_recon_loss: 21924399.7333; val_masked_gp_l1_reg_loss: 135087.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33424.4062; val_chrom_access_recon_loss: 3217757.3333; val_global_loss: 28061843.2000; val_optim_loss: 28061843.2000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9872; val_auprc_score: 0.9837; val_best_acc_score: 0.9539; val_best_f1_score: 0.9549; train_kl_reg_loss: 74504.7726; train_edge_recon_loss: 2668944.3302; train_gene_expr_recon_loss: 21924275.5573; train_masked_gp_l1_reg_loss: 135069.6397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33299.6037; train_chrom_access_recon_loss: 3251166.3874; train_global_loss: 28087260.2595; train_optim_loss: 28087260.2595; val_kl_reg_loss: 73941.2057; val_edge_recon_loss: 2663150.2833; val_gene_expr_recon_loss: 22036482.1333; val_masked_gp_l1_reg_loss: 135028.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33181.5664; val_chrom_access_recon_loss: 3220925.4833; val_global_loss: 28162709.3333; val_optim_loss: 28162709.3333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9875; val_auprc_score: 0.9839; val_best_acc_score: 0.9526; val_best_f1_score: 0.9534; train_kl_reg_loss: 74741.2552; train_edge_recon_loss: 2663727.3263; train_gene_expr_recon_loss: 21920532.5802; train_masked_gp_l1_reg_loss: 135045.6155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33065.9208; train_chrom_access_recon_loss: 3249895.8092; train_global_loss: 28077008.4122; train_optim_loss: 28077008.4122; val_kl_reg_loss: 73576.6766; val_edge_recon_loss: 2683148.7500; val_gene_expr_recon_loss: 22036698.4000; val_masked_gp_l1_reg_loss: 135043.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32923.5938; val_chrom_access_recon_loss: 3205334.3500; val_global_loss: 28166725.0667; val_optim_loss: 28166725.0667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9872; val_auprc_score: 0.9840; val_best_acc_score: 0.9512; val_best_f1_score: 0.9521; train_kl_reg_loss: 74764.5650; train_edge_recon_loss: 2670706.8340; train_gene_expr_recon_loss: 21922251.3740; train_masked_gp_l1_reg_loss: 135041.4016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32829.7854; train_chrom_access_recon_loss: 3254928.4122; train_global_loss: 28090522.1985; train_optim_loss: 28090522.1985; val_kl_reg_loss: 73910.2953; val_edge_recon_loss: 2671224.8333; val_gene_expr_recon_loss: 21996149.3333; val_masked_gp_l1_reg_loss: 135041.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32716.4980; val_chrom_access_recon_loss: 3211114.6333; val_global_loss: 28120157.2000; val_optim_loss: 28120157.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9875; val_auprc_score: 0.9849; val_best_acc_score: 0.9506; val_best_f1_score: 0.9519; train_kl_reg_loss: 74600.4329; train_edge_recon_loss: 2669944.6641; train_gene_expr_recon_loss: 21922362.0458; train_masked_gp_l1_reg_loss: 135055.5699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32652.3504; train_chrom_access_recon_loss: 3251891.3225; train_global_loss: 28086506.2748; train_optim_loss: 28086506.2748; val_kl_reg_loss: 74556.8609; val_edge_recon_loss: 2678116.0667; val_gene_expr_recon_loss: 21997878.6667; val_masked_gp_l1_reg_loss: 135061.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32536.5547; val_chrom_access_recon_loss: 3199465.0000; val_global_loss: 28117615.0667; val_optim_loss: 28117615.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9865; val_auprc_score: 0.9811; val_best_acc_score: 0.9493; val_best_f1_score: 0.9503; train_kl_reg_loss: 75180.1534; train_edge_recon_loss: 2666413.7424; train_gene_expr_recon_loss: 21912596.0763; train_masked_gp_l1_reg_loss: 134921.4679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32168.9001; train_chrom_access_recon_loss: 3252314.0210; train_global_loss: 28073594.3969; train_optim_loss: 28073594.3969; val_kl_reg_loss: 74604.0255; val_edge_recon_loss: 2683558.4167; val_gene_expr_recon_loss: 22008072.9333; val_masked_gp_l1_reg_loss: 134851.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32107.7578; val_chrom_access_recon_loss: 3212606.3667; val_global_loss: 28145801.8667; val_optim_loss: 28145801.8667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9864; val_auprc_score: 0.9823; val_best_acc_score: 0.9506; val_best_f1_score: 0.9518; train_kl_reg_loss: 75105.2288; train_edge_recon_loss: 2666728.0611; train_gene_expr_recon_loss: 21896552.0305; train_masked_gp_l1_reg_loss: 134824.5007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32084.8688; train_chrom_access_recon_loss: 3250567.7786; train_global_loss: 28055862.3511; train_optim_loss: 28055862.3511; val_kl_reg_loss: 74503.0604; val_edge_recon_loss: 2677392.6833; val_gene_expr_recon_loss: 21982172.9333; val_masked_gp_l1_reg_loss: 134799.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32061.2891; val_chrom_access_recon_loss: 3218125.1167; val_global_loss: 28119055.8667; val_optim_loss: 28119055.8667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9863; val_auprc_score: 0.9779; val_best_acc_score: 0.9528; val_best_f1_score: 0.9539; train_kl_reg_loss: 75168.8208; train_edge_recon_loss: 2666727.9752; train_gene_expr_recon_loss: 21902516.4733; train_masked_gp_l1_reg_loss: 134786.0703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32043.0815; train_chrom_access_recon_loss: 3250243.3511; train_global_loss: 28061485.7557; train_optim_loss: 28061485.7557; val_kl_reg_loss: 74739.3458; val_edge_recon_loss: 2684095.0167; val_gene_expr_recon_loss: 22035714.5333; val_masked_gp_l1_reg_loss: 134773.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32025.0312; val_chrom_access_recon_loss: 3209703.7500; val_global_loss: 28171052.8000; val_optim_loss: 28171052.8000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9854; val_auprc_score: 0.9810; val_best_acc_score: 0.9503; val_best_f1_score: 0.9516; train_kl_reg_loss: 75087.2903; train_edge_recon_loss: 2668042.0954; train_gene_expr_recon_loss: 21917090.4733; train_masked_gp_l1_reg_loss: 134769.2222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32009.8055; train_chrom_access_recon_loss: 3254044.5878; train_global_loss: 28081043.3740; train_optim_loss: 28081043.3740; val_kl_reg_loss: 74388.5807; val_edge_recon_loss: 2671844.3500; val_gene_expr_recon_loss: 22060418.2667; val_masked_gp_l1_reg_loss: 134759.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31993.7266; val_chrom_access_recon_loss: 3212552.0000; val_global_loss: 28185957.2000; val_optim_loss: 28185957.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 109 min 56 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9876
val AUPRC score: 0.9817
val best accuracy score: 0.9524
val best F1 score: 0.9531
val target rna MSE score: 0.7607
val source rna MSE score: 0.1422
val target atac MSE score: 0.4850
val source atac MSE score: 0.0792
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
