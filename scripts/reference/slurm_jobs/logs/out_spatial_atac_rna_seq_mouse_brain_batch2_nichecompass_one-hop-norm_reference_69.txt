[True]
Run timestamp: 24072023_170624_69.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_69']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9704; val_auprc_score: 0.9717; val_best_acc_score: 0.8942; val_best_f1_score: 0.8993; train_kl_reg_loss: 2366.4848; train_edge_recon_loss: 34655959.1111; train_gene_expr_recon_loss: 3208028.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10776701.8889; train_global_loss: 48643057.7778; train_optim_loss: 48643057.7778; val_kl_reg_loss: 3294.2764; val_edge_recon_loss: 40440788.0000; val_gene_expr_recon_loss: 3218318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10958287.0000; val_global_loss: 54620688.0000; val_optim_loss: 54620688.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9301; val_auprc_score: 0.9247; val_best_acc_score: 0.8200; val_best_f1_score: 0.8426; train_kl_reg_loss: 2126.4350; train_edge_recon_loss: 34648318.2222; train_gene_expr_recon_loss: 3103077.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10736495.0000; train_global_loss: 48490016.4444; train_optim_loss: 48490016.4444; val_kl_reg_loss: 2383.8313; val_edge_recon_loss: 38948940.0000; val_gene_expr_recon_loss: 3067953.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10871270.0000; val_global_loss: 52890544.0000; val_optim_loss: 52890544.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8645; val_auprc_score: 0.8567; val_best_acc_score: 0.7653; val_best_f1_score: 0.7897; train_kl_reg_loss: 2498.3044; train_edge_recon_loss: 33447012.0000; train_gene_expr_recon_loss: 2964052.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10619796.3333; train_global_loss: 47033360.0000; train_optim_loss: 47033360.0000; val_kl_reg_loss: 5360.6133; val_edge_recon_loss: 30160150.0000; val_gene_expr_recon_loss: 2978701.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10831293.0000; val_global_loss: 43975504.0000; val_optim_loss: 43975504.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8610; val_best_acc_score: 0.7800; val_best_f1_score: 0.7929; train_kl_reg_loss: 17266.8798; train_edge_recon_loss: 29190906.8889; train_gene_expr_recon_loss: 2952415.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10691441.7778; train_global_loss: 42852031.5556; train_optim_loss: 42852031.5556; val_kl_reg_loss: 37840.3320; val_edge_recon_loss: 28666800.0000; val_gene_expr_recon_loss: 2943434.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10762830.0000; val_global_loss: 42410904.0000; val_optim_loss: 42410904.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8817; val_auprc_score: 0.8560; val_best_acc_score: 0.7887; val_best_f1_score: 0.8081; train_kl_reg_loss: 56319.4740; train_edge_recon_loss: 28470546.0000; train_gene_expr_recon_loss: 2801816.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10498487.1111; train_global_loss: 41827168.8889; train_optim_loss: 41827168.8889; val_kl_reg_loss: 72654.3984; val_edge_recon_loss: 28418442.0000; val_gene_expr_recon_loss: 2793189.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10639376.0000; val_global_loss: 41923664.0000; val_optim_loss: 41923664.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8969; val_auprc_score: 0.8695; val_best_acc_score: 0.8238; val_best_f1_score: 0.8360; train_kl_reg_loss: 80474.8125; train_edge_recon_loss: 27859375.7778; train_gene_expr_recon_loss: 2692397.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10384918.2222; train_global_loss: 41017166.6667; train_optim_loss: 41017166.6667; val_kl_reg_loss: 87484.0781; val_edge_recon_loss: 28027364.0000; val_gene_expr_recon_loss: 2685497.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10524697.0000; val_global_loss: 41325044.0000; val_optim_loss: 41325044.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9094; val_auprc_score: 0.8767; val_best_acc_score: 0.8486; val_best_f1_score: 0.8592; train_kl_reg_loss: 91984.0243; train_edge_recon_loss: 27556956.4444; train_gene_expr_recon_loss: 2608329.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10334642.4444; train_global_loss: 40591912.8889; train_optim_loss: 40591912.8889; val_kl_reg_loss: 96068.2188; val_edge_recon_loss: 27689814.0000; val_gene_expr_recon_loss: 2636282.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10468509.0000; val_global_loss: 40890672.0000; val_optim_loss: 40890672.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9250; val_auprc_score: 0.9038; val_best_acc_score: 0.8631; val_best_f1_score: 0.8703; train_kl_reg_loss: 99993.7986; train_edge_recon_loss: 27412823.5556; train_gene_expr_recon_loss: 2549980.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10239730.6667; train_global_loss: 40302528.4444; train_optim_loss: 40302528.4444; val_kl_reg_loss: 104911.0703; val_edge_recon_loss: 27332162.0000; val_gene_expr_recon_loss: 2584855.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10396317.0000; val_global_loss: 40418244.0000; val_optim_loss: 40418244.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9310; val_auprc_score: 0.9093; val_best_acc_score: 0.8707; val_best_f1_score: 0.8772; train_kl_reg_loss: 108265.6623; train_edge_recon_loss: 27392023.3333; train_gene_expr_recon_loss: 2490469.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10249072.8889; train_global_loss: 40239831.5556; train_optim_loss: 40239831.5556; val_kl_reg_loss: 108338.5469; val_edge_recon_loss: 27493772.0000; val_gene_expr_recon_loss: 2535530.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10342056.0000; val_global_loss: 40479696.0000; val_optim_loss: 40479696.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9275; val_auprc_score: 0.8974; val_best_acc_score: 0.8711; val_best_f1_score: 0.8774; train_kl_reg_loss: 105688.7396; train_edge_recon_loss: 27505494.0000; train_gene_expr_recon_loss: 2471366.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10230391.3333; train_global_loss: 40312940.4444; train_optim_loss: 40312940.4444; val_kl_reg_loss: 96152.7500; val_edge_recon_loss: 27591922.0000; val_gene_expr_recon_loss: 2517532.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10329279.0000; val_global_loss: 40534884.0000; val_optim_loss: 40534884.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9283; val_auprc_score: 0.8996; val_best_acc_score: 0.8733; val_best_f1_score: 0.8815; train_kl_reg_loss: 90832.2986; train_edge_recon_loss: 27395441.5556; train_gene_expr_recon_loss: 2452255.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10142274.2222; train_global_loss: 40080804.0000; train_optim_loss: 40080804.0000; val_kl_reg_loss: 85610.5312; val_edge_recon_loss: 27441954.0000; val_gene_expr_recon_loss: 2477837.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10276006.0000; val_global_loss: 40281408.0000; val_optim_loss: 40281408.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9362; val_auprc_score: 0.9134; val_best_acc_score: 0.8825; val_best_f1_score: 0.8891; train_kl_reg_loss: 89901.6328; train_edge_recon_loss: 27214592.6667; train_gene_expr_recon_loss: 2413269.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10071841.7778; train_global_loss: 39789606.2222; train_optim_loss: 39789606.2222; val_kl_reg_loss: 96161.4219; val_edge_recon_loss: 26964542.0000; val_gene_expr_recon_loss: 2453362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10221457.0000; val_global_loss: 39735524.0000; val_optim_loss: 39735524.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9332; val_auprc_score: 0.9067; val_best_acc_score: 0.8816; val_best_f1_score: 0.8883; train_kl_reg_loss: 107919.7960; train_edge_recon_loss: 27073274.6667; train_gene_expr_recon_loss: 2382893.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10041682.8889; train_global_loss: 39605770.2222; train_optim_loss: 39605770.2222; val_kl_reg_loss: 118539.6484; val_edge_recon_loss: 27215094.0000; val_gene_expr_recon_loss: 2419100.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10177977.0000; val_global_loss: 39930712.0000; val_optim_loss: 39930712.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9431; val_auprc_score: 0.9248; val_best_acc_score: 0.8825; val_best_f1_score: 0.8889; train_kl_reg_loss: 127484.6493; train_edge_recon_loss: 27023508.0000; train_gene_expr_recon_loss: 2360521.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9999020.0000; train_global_loss: 39510534.2222; train_optim_loss: 39510534.2222; val_kl_reg_loss: 132651.6875; val_edge_recon_loss: 27202774.0000; val_gene_expr_recon_loss: 2397321.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10174520.0000; val_global_loss: 39907268.0000; val_optim_loss: 39907268.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9352; val_auprc_score: 0.9115; val_best_acc_score: 0.8831; val_best_f1_score: 0.8900; train_kl_reg_loss: 136092.3802; train_edge_recon_loss: 27053703.3333; train_gene_expr_recon_loss: 2324085.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9971167.6667; train_global_loss: 39485049.3333; train_optim_loss: 39485049.3333; val_kl_reg_loss: 135947.5312; val_edge_recon_loss: 27125574.0000; val_gene_expr_recon_loss: 2379481.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10135485.0000; val_global_loss: 39776488.0000; val_optim_loss: 39776488.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9440; val_auprc_score: 0.9216; val_best_acc_score: 0.8909; val_best_f1_score: 0.8963; train_kl_reg_loss: 138018.2361; train_edge_recon_loss: 27124826.2222; train_gene_expr_recon_loss: 2318346.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9975527.0000; train_global_loss: 39556717.3333; train_optim_loss: 39556717.3333; val_kl_reg_loss: 137406.7031; val_edge_recon_loss: 26974228.0000; val_gene_expr_recon_loss: 2359856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10111898.0000; val_global_loss: 39583388.0000; val_optim_loss: 39583388.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9411; val_auprc_score: 0.9148; val_best_acc_score: 0.8871; val_best_f1_score: 0.8933; train_kl_reg_loss: 142035.9931; train_edge_recon_loss: 26953591.7778; train_gene_expr_recon_loss: 2294078.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9954370.1111; train_global_loss: 39344076.4444; train_optim_loss: 39344076.4444; val_kl_reg_loss: 139893.2344; val_edge_recon_loss: 27240622.0000; val_gene_expr_recon_loss: 2348604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10086852.0000; val_global_loss: 39815972.0000; val_optim_loss: 39815972.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9461; val_auprc_score: 0.9271; val_best_acc_score: 0.8911; val_best_f1_score: 0.8968; train_kl_reg_loss: 142364.4184; train_edge_recon_loss: 27004680.6667; train_gene_expr_recon_loss: 2284073.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890617.1111; train_global_loss: 39321735.5556; train_optim_loss: 39321735.5556; val_kl_reg_loss: 142060.9375; val_edge_recon_loss: 27251950.0000; val_gene_expr_recon_loss: 2319214.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10049435.0000; val_global_loss: 39762660.0000; val_optim_loss: 39762660.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9473; val_auprc_score: 0.9298; val_best_acc_score: 0.8878; val_best_f1_score: 0.8940; train_kl_reg_loss: 145152.8316; train_edge_recon_loss: 26979308.2222; train_gene_expr_recon_loss: 2258753.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9909034.4444; train_global_loss: 39292249.3333; train_optim_loss: 39292249.3333; val_kl_reg_loss: 142825.5000; val_edge_recon_loss: 27130314.0000; val_gene_expr_recon_loss: 2330924.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10056939.0000; val_global_loss: 39661004.0000; val_optim_loss: 39661004.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9513; val_auprc_score: 0.9342; val_best_acc_score: 0.8923; val_best_f1_score: 0.8975; train_kl_reg_loss: 146208.8976; train_edge_recon_loss: 26912343.7778; train_gene_expr_recon_loss: 2264085.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9855823.0000; train_global_loss: 39178460.8889; train_optim_loss: 39178460.8889; val_kl_reg_loss: 143009.6875; val_edge_recon_loss: 27255732.0000; val_gene_expr_recon_loss: 2302117.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10015310.0000; val_global_loss: 39716168.0000; val_optim_loss: 39716168.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9544; val_auprc_score: 0.9400; val_best_acc_score: 0.8969; val_best_f1_score: 0.9005; train_kl_reg_loss: 144386.3767; train_edge_recon_loss: 26956168.0000; train_gene_expr_recon_loss: 2247297.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9794077.6667; train_global_loss: 39141929.7778; train_optim_loss: 39141929.7778; val_kl_reg_loss: 143235.0625; val_edge_recon_loss: 27153608.0000; val_gene_expr_recon_loss: 2302403.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10022468.0000; val_global_loss: 39621716.0000; val_optim_loss: 39621716.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9541; val_auprc_score: 0.9355; val_best_acc_score: 0.9034; val_best_f1_score: 0.9070; train_kl_reg_loss: 144568.1302; train_edge_recon_loss: 26888746.8889; train_gene_expr_recon_loss: 2242578.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9837716.6667; train_global_loss: 39113610.6667; train_optim_loss: 39113610.6667; val_kl_reg_loss: 141638.7500; val_edge_recon_loss: 26939752.0000; val_gene_expr_recon_loss: 2298963.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10006650.0000; val_global_loss: 39387000.0000; val_optim_loss: 39387000.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9505; val_auprc_score: 0.9324; val_best_acc_score: 0.8968; val_best_f1_score: 0.9007; train_kl_reg_loss: 144009.9201; train_edge_recon_loss: 26818478.4444; train_gene_expr_recon_loss: 2244554.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9838990.7778; train_global_loss: 39046034.6667; train_optim_loss: 39046034.6667; val_kl_reg_loss: 140848.9844; val_edge_recon_loss: 27119434.0000; val_gene_expr_recon_loss: 2298742.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10002059.0000; val_global_loss: 39561084.0000; val_optim_loss: 39561084.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9539; val_auprc_score: 0.9389; val_best_acc_score: 0.9006; val_best_f1_score: 0.9038; train_kl_reg_loss: 143473.1024; train_edge_recon_loss: 26911268.8889; train_gene_expr_recon_loss: 2245363.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9829591.6667; train_global_loss: 39129696.4444; train_optim_loss: 39129696.4444; val_kl_reg_loss: 140560.8594; val_edge_recon_loss: 27059492.0000; val_gene_expr_recon_loss: 2298358.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10012001.0000; val_global_loss: 39510412.0000; val_optim_loss: 39510412.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9548; val_auprc_score: 0.9363; val_best_acc_score: 0.9020; val_best_f1_score: 0.9059; train_kl_reg_loss: 142091.9080; train_edge_recon_loss: 26836322.4444; train_gene_expr_recon_loss: 2242423.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9857146.5556; train_global_loss: 39077984.4444; train_optim_loss: 39077984.4444; val_kl_reg_loss: 139659.8750; val_edge_recon_loss: 27017438.0000; val_gene_expr_recon_loss: 2298747.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10019920.0000; val_global_loss: 39475768.0000; val_optim_loss: 39475768.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9552; val_auprc_score: 0.9368; val_best_acc_score: 0.8968; val_best_f1_score: 0.9018; train_kl_reg_loss: 141144.8003; train_edge_recon_loss: 27019592.8889; train_gene_expr_recon_loss: 2280092.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9882248.5556; train_global_loss: 39323078.2222; train_optim_loss: 39323078.2222; val_kl_reg_loss: 74187.4219; val_edge_recon_loss: 27106776.0000; val_gene_expr_recon_loss: 2356416.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10096644.0000; val_global_loss: 39634024.0000; val_optim_loss: 39634024.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9532; val_auprc_score: 0.9367; val_best_acc_score: 0.8989; val_best_f1_score: 0.9037; train_kl_reg_loss: 139454.7049; train_edge_recon_loss: 26959069.1111; train_gene_expr_recon_loss: 2293384.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9864464.6667; train_global_loss: 39256373.3333; train_optim_loss: 39256373.3333; val_kl_reg_loss: 73592.8750; val_edge_recon_loss: 27192832.0000; val_gene_expr_recon_loss: 2350394.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10070590.0000; val_global_loss: 39687408.0000; val_optim_loss: 39687408.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9594; val_auprc_score: 0.9443; val_best_acc_score: 0.9056; val_best_f1_score: 0.9093; train_kl_reg_loss: 141061.8628; train_edge_recon_loss: 26972948.8889; train_gene_expr_recon_loss: 2298325.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9923155.8889; train_global_loss: 39335492.0000; train_optim_loss: 39335492.0000; val_kl_reg_loss: 73785.9688; val_edge_recon_loss: 26896652.0000; val_gene_expr_recon_loss: 2342496.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10067379.0000; val_global_loss: 39380312.0000; val_optim_loss: 39380312.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9567; val_auprc_score: 0.9414; val_best_acc_score: 0.9027; val_best_f1_score: 0.9070; train_kl_reg_loss: 139729.7483; train_edge_recon_loss: 27006727.7778; train_gene_expr_recon_loss: 2284311.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9889040.5556; train_global_loss: 39319809.7778; train_optim_loss: 39319809.7778; val_kl_reg_loss: 73872.7969; val_edge_recon_loss: 27084578.0000; val_gene_expr_recon_loss: 2339782.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10065850.0000; val_global_loss: 39564080.0000; val_optim_loss: 39564080.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9585; val_auprc_score: 0.9449; val_best_acc_score: 0.9042; val_best_f1_score: 0.9083; train_kl_reg_loss: 139748.5885; train_edge_recon_loss: 26954713.1111; train_gene_expr_recon_loss: 2278187.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9907979.7778; train_global_loss: 39280628.8889; train_optim_loss: 39280628.8889; val_kl_reg_loss: 73772.5938; val_edge_recon_loss: 26768074.0000; val_gene_expr_recon_loss: 2337307.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10060367.0000; val_global_loss: 39239520.0000; val_optim_loss: 39239520.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9568; val_auprc_score: 0.9446; val_best_acc_score: 0.9006; val_best_f1_score: 0.9050; train_kl_reg_loss: 140229.1788; train_edge_recon_loss: 26934510.0000; train_gene_expr_recon_loss: 2283363.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9922644.2222; train_global_loss: 39280747.1111; train_optim_loss: 39280747.1111; val_kl_reg_loss: 73522.6250; val_edge_recon_loss: 27060952.0000; val_gene_expr_recon_loss: 2338620.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10071454.0000; val_global_loss: 39544548.0000; val_optim_loss: 39544548.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9540; val_auprc_score: 0.9380; val_best_acc_score: 0.8967; val_best_f1_score: 0.9016; train_kl_reg_loss: 140799.4983; train_edge_recon_loss: 26921393.7778; train_gene_expr_recon_loss: 2283672.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9869843.5556; train_global_loss: 39215708.8889; train_optim_loss: 39215708.8889; val_kl_reg_loss: 73096.3594; val_edge_recon_loss: 27015648.0000; val_gene_expr_recon_loss: 2337309.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10061465.0000; val_global_loss: 39487516.0000; val_optim_loss: 39487516.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9528; val_auprc_score: 0.9363; val_best_acc_score: 0.8988; val_best_f1_score: 0.9036; train_kl_reg_loss: 140372.3351; train_edge_recon_loss: 27067349.5556; train_gene_expr_recon_loss: 2296011.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9893039.5556; train_global_loss: 39396772.4444; train_optim_loss: 39396772.4444; val_kl_reg_loss: 73719.5625; val_edge_recon_loss: 27248166.0000; val_gene_expr_recon_loss: 2338711.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10074415.0000; val_global_loss: 39735012.0000; val_optim_loss: 39735012.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9585; val_auprc_score: 0.9432; val_best_acc_score: 0.9080; val_best_f1_score: 0.9115; train_kl_reg_loss: 141147.9028; train_edge_recon_loss: 26974137.5556; train_gene_expr_recon_loss: 2289836.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9923633.7778; train_global_loss: 39328755.5556; train_optim_loss: 39328755.5556; val_kl_reg_loss: 73240.0859; val_edge_recon_loss: 27002334.0000; val_gene_expr_recon_loss: 2339409.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10074085.0000; val_global_loss: 39489068.0000; val_optim_loss: 39489068.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9512; val_auprc_score: 0.9339; val_best_acc_score: 0.8973; val_best_f1_score: 0.9024; train_kl_reg_loss: 141129.7569; train_edge_recon_loss: 26946550.0000; train_gene_expr_recon_loss: 2289841.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9932607.5556; train_global_loss: 39310128.4444; train_optim_loss: 39310128.4444; val_kl_reg_loss: 73549.1562; val_edge_recon_loss: 27253542.0000; val_gene_expr_recon_loss: 2340278.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10071338.0000; val_global_loss: 39738708.0000; val_optim_loss: 39738708.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9552; val_auprc_score: 0.9394; val_best_acc_score: 0.9019; val_best_f1_score: 0.9063; train_kl_reg_loss: 141050.6910; train_edge_recon_loss: 26904702.6667; train_gene_expr_recon_loss: 2296246.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9932895.2222; train_global_loss: 39274896.0000; train_optim_loss: 39274896.0000; val_kl_reg_loss: 73449.1094; val_edge_recon_loss: 27107680.0000; val_gene_expr_recon_loss: 2339953.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10068141.0000; val_global_loss: 39589224.0000; val_optim_loss: 39589224.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9585; val_auprc_score: 0.9422; val_best_acc_score: 0.9091; val_best_f1_score: 0.9126; train_kl_reg_loss: 141226.9670; train_edge_recon_loss: 26880377.7778; train_gene_expr_recon_loss: 2281572.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9889735.0000; train_global_loss: 39192912.8889; train_optim_loss: 39192912.8889; val_kl_reg_loss: 73328.7188; val_edge_recon_loss: 26752594.0000; val_gene_expr_recon_loss: 2338671.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10063991.0000; val_global_loss: 39228584.0000; val_optim_loss: 39228584.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9552; val_auprc_score: 0.9388; val_best_acc_score: 0.9004; val_best_f1_score: 0.9050; train_kl_reg_loss: 140402.5417; train_edge_recon_loss: 26890193.5556; train_gene_expr_recon_loss: 2287432.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9904210.2222; train_global_loss: 39222238.6667; train_optim_loss: 39222238.6667; val_kl_reg_loss: 73421.1172; val_edge_recon_loss: 27131188.0000; val_gene_expr_recon_loss: 2339902.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10079933.0000; val_global_loss: 39624444.0000; val_optim_loss: 39624444.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9557; val_auprc_score: 0.9384; val_best_acc_score: 0.9050; val_best_f1_score: 0.9090; train_kl_reg_loss: 141299.4983; train_edge_recon_loss: 26890338.0000; train_gene_expr_recon_loss: 2288438.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9900646.4444; train_global_loss: 39220722.6667; train_optim_loss: 39220722.6667; val_kl_reg_loss: 73510.2344; val_edge_recon_loss: 26902976.0000; val_gene_expr_recon_loss: 2338117.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10062082.0000; val_global_loss: 39376688.0000; val_optim_loss: 39376688.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9565; val_auprc_score: 0.9414; val_best_acc_score: 0.9045; val_best_f1_score: 0.9079; train_kl_reg_loss: 141338.1215; train_edge_recon_loss: 27034781.1111; train_gene_expr_recon_loss: 2291448.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9923225.4444; train_global_loss: 39390793.7778; train_optim_loss: 39390793.7778; val_kl_reg_loss: 73211.9062; val_edge_recon_loss: 27167952.0000; val_gene_expr_recon_loss: 2339215.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10071220.0000; val_global_loss: 39651600.0000; val_optim_loss: 39651600.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9574; val_auprc_score: 0.9436; val_best_acc_score: 0.9006; val_best_f1_score: 0.9051; train_kl_reg_loss: 140457.2865; train_edge_recon_loss: 26856286.4444; train_gene_expr_recon_loss: 2277347.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9873455.2222; train_global_loss: 39147545.3333; train_optim_loss: 39147545.3333; val_kl_reg_loss: 73128.8672; val_edge_recon_loss: 27175138.0000; val_gene_expr_recon_loss: 2338020.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10056905.0000; val_global_loss: 39643192.0000; val_optim_loss: 39643192.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9558; val_auprc_score: 0.9398; val_best_acc_score: 0.9022; val_best_f1_score: 0.9065; train_kl_reg_loss: 140411.1701; train_edge_recon_loss: 26961461.1111; train_gene_expr_recon_loss: 2290272.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9940068.4444; train_global_loss: 39332212.4444; train_optim_loss: 39332212.4444; val_kl_reg_loss: 73001.6250; val_edge_recon_loss: 27019104.0000; val_gene_expr_recon_loss: 2337771.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10058604.0000; val_global_loss: 39488480.0000; val_optim_loss: 39488480.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9559; val_auprc_score: 0.9409; val_best_acc_score: 0.9007; val_best_f1_score: 0.9052; train_kl_reg_loss: 140398.3073; train_edge_recon_loss: 26958359.3333; train_gene_expr_recon_loss: 2283531.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9876157.6667; train_global_loss: 39258445.3333; train_optim_loss: 39258445.3333; val_kl_reg_loss: 73400.4609; val_edge_recon_loss: 27040038.0000; val_gene_expr_recon_loss: 2339540.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10070956.0000; val_global_loss: 39523936.0000; val_optim_loss: 39523936.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9539; val_auprc_score: 0.9376; val_best_acc_score: 0.8989; val_best_f1_score: 0.9037; train_kl_reg_loss: 141114.8212; train_edge_recon_loss: 26990001.3333; train_gene_expr_recon_loss: 2276575.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9885343.8889; train_global_loss: 39293035.5556; train_optim_loss: 39293035.5556; val_kl_reg_loss: 73688.4531; val_edge_recon_loss: 27334970.0000; val_gene_expr_recon_loss: 2339530.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10062817.0000; val_global_loss: 39811004.0000; val_optim_loss: 39811004.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9525; val_auprc_score: 0.9341; val_best_acc_score: 0.8988; val_best_f1_score: 0.9036; train_kl_reg_loss: 140670.2934; train_edge_recon_loss: 26976323.1111; train_gene_expr_recon_loss: 2274299.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9904144.5556; train_global_loss: 39295436.0000; train_optim_loss: 39295436.0000; val_kl_reg_loss: 73570.8516; val_edge_recon_loss: 27207756.0000; val_gene_expr_recon_loss: 2339013.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10081777.0000; val_global_loss: 39702116.0000; val_optim_loss: 39702116.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 15 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9563
Val AUPRC score: 0.9397
Val best accuracy score: 0.9049
Val best F1 score: 0.9088
Val gene expr MSE score: 0.5732
Val chrom access MSE score: 0.0918
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
