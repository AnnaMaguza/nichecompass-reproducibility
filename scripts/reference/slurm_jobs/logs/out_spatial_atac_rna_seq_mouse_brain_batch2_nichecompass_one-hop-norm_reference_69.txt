[True]
Run timestamp: 07082023_192737_69.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_69']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8730; val_auprc_score: 0.8918; val_best_acc_score: 0.5039; val_best_f1_score: 0.6684; train_kl_reg_loss: 33717.4421; train_edge_recon_loss: 352009.3750; train_gene_expr_recon_loss: 1194832.6389; train_masked_gp_l1_reg_loss: 8816.6959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166875.4219; train_chrom_access_recon_loss: 2302041.6528; train_global_loss: 4058293.2500; train_optim_loss: 4058293.2500; val_kl_reg_loss: 13716.2441; val_edge_recon_loss: 406537.9688; val_gene_expr_recon_loss: 1060126.3750; val_masked_gp_l1_reg_loss: 7611.7236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162439.6875; val_chrom_access_recon_loss: 1614770.5000; val_global_loss: 3265202.5000; val_optim_loss: 3265202.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8708; val_auprc_score: 0.8886; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 14931.4550; train_edge_recon_loss: 357743.2188; train_gene_expr_recon_loss: 967670.2222; train_masked_gp_l1_reg_loss: 7292.5102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159615.1562; train_chrom_access_recon_loss: 1577087.6806; train_global_loss: 3084340.2778; train_optim_loss: 3084340.2778; val_kl_reg_loss: 14047.4854; val_edge_recon_loss: 406565.0938; val_gene_expr_recon_loss: 845328.1875; val_masked_gp_l1_reg_loss: 7131.2720; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156098.3594; val_chrom_access_recon_loss: 1392112.6250; val_global_loss: 2821283.0000; val_optim_loss: 2821283.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8706; val_auprc_score: 0.8893; val_best_acc_score: 0.5034; val_best_f1_score: 0.6682; train_kl_reg_loss: 16042.1522; train_edge_recon_loss: 358842.0312; train_gene_expr_recon_loss: 823860.2986; train_masked_gp_l1_reg_loss: 7291.7591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153112.1042; train_chrom_access_recon_loss: 1414296.1806; train_global_loss: 2773444.5000; train_optim_loss: 2773444.5000; val_kl_reg_loss: 15668.1328; val_edge_recon_loss: 406558.3438; val_gene_expr_recon_loss: 779588.5000; val_masked_gp_l1_reg_loss: 7478.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149190.2656; val_chrom_access_recon_loss: 1345714.5000; val_global_loss: 2704198.0000; val_optim_loss: 2704198.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8686; val_auprc_score: 0.8857; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 17913.9625; train_edge_recon_loss: 359574.8194; train_gene_expr_recon_loss: 776664.7292; train_masked_gp_l1_reg_loss: 7511.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145730.7795; train_chrom_access_recon_loss: 1384293.6111; train_global_loss: 2691688.9444; train_optim_loss: 2691688.9444; val_kl_reg_loss: 17324.9180; val_edge_recon_loss: 406559.4062; val_gene_expr_recon_loss: 749862.7500; val_masked_gp_l1_reg_loss: 7502.9546; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141233.1875; val_chrom_access_recon_loss: 1326815.7500; val_global_loss: 2649299.0000; val_optim_loss: 2649299.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8630; val_auprc_score: 0.8790; val_best_acc_score: 0.5088; val_best_f1_score: 0.6706; train_kl_reg_loss: 18853.5430; train_edge_recon_loss: 359677.4062; train_gene_expr_recon_loss: 751840.1042; train_masked_gp_l1_reg_loss: 7484.2077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137452.4115; train_chrom_access_recon_loss: 1365403.2361; train_global_loss: 2640710.9167; train_optim_loss: 2640710.9167; val_kl_reg_loss: 18105.5430; val_edge_recon_loss: 406528.6562; val_gene_expr_recon_loss: 732091.6250; val_masked_gp_l1_reg_loss: 7451.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132669.9375; val_chrom_access_recon_loss: 1315376.7500; val_global_loss: 2612224.2500; val_optim_loss: 2612224.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8592; val_auprc_score: 0.8717; val_best_acc_score: 0.5162; val_best_f1_score: 0.6738; train_kl_reg_loss: 20454.4364; train_edge_recon_loss: 360126.4479; train_gene_expr_recon_loss: 735790.5139; train_masked_gp_l1_reg_loss: 7422.2046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128802.7387; train_chrom_access_recon_loss: 1356992.5278; train_global_loss: 2609588.8611; train_optim_loss: 2609588.8611; val_kl_reg_loss: 18205.3379; val_edge_recon_loss: 406474.0625; val_gene_expr_recon_loss: 715999.5000; val_masked_gp_l1_reg_loss: 7370.2690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123959.4688; val_chrom_access_recon_loss: 1306870.8750; val_global_loss: 2578879.5000; val_optim_loss: 2578879.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8667; val_auprc_score: 0.8700; val_best_acc_score: 0.5340; val_best_f1_score: 0.6806; train_kl_reg_loss: 20889.6947; train_edge_recon_loss: 360140.4444; train_gene_expr_recon_loss: 720848.1389; train_masked_gp_l1_reg_loss: 7328.0636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120114.2674; train_chrom_access_recon_loss: 1348902.2917; train_global_loss: 2578222.9167; train_optim_loss: 2578222.9167; val_kl_reg_loss: 18506.8320; val_edge_recon_loss: 406228.5312; val_gene_expr_recon_loss: 703435.0000; val_masked_gp_l1_reg_loss: 7266.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115343.7500; val_chrom_access_recon_loss: 1300405.5000; val_global_loss: 2551186.0000; val_optim_loss: 2551186.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8630; val_auprc_score: 0.8585; val_best_acc_score: 0.5892; val_best_f1_score: 0.7049; train_kl_reg_loss: 21378.4902; train_edge_recon_loss: 360002.5764; train_gene_expr_recon_loss: 705091.8958; train_masked_gp_l1_reg_loss: 7228.2919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111620.2682; train_chrom_access_recon_loss: 1330990.9306; train_global_loss: 2536312.4444; train_optim_loss: 2536312.4444; val_kl_reg_loss: 21347.1914; val_edge_recon_loss: 405776.1875; val_gene_expr_recon_loss: 689379.1250; val_masked_gp_l1_reg_loss: 7174.0581; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107027.4922; val_chrom_access_recon_loss: 1294998.7500; val_global_loss: 2525702.7500; val_optim_loss: 2525702.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8450; val_auprc_score: 0.8381; val_best_acc_score: 0.6601; val_best_f1_score: 0.7382; train_kl_reg_loss: 22429.5126; train_edge_recon_loss: 359387.7917; train_gene_expr_recon_loss: 694923.6111; train_masked_gp_l1_reg_loss: 7146.7253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103486.2882; train_chrom_access_recon_loss: 1329282.7361; train_global_loss: 2516656.6667; train_optim_loss: 2516656.6667; val_kl_reg_loss: 20458.7617; val_edge_recon_loss: 404998.5625; val_gene_expr_recon_loss: 681655.7500; val_masked_gp_l1_reg_loss: 7102.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99148.4062; val_chrom_access_recon_loss: 1289899.7500; val_global_loss: 2503263.5000; val_optim_loss: 2503263.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8241; val_auprc_score: 0.8204; val_best_acc_score: 0.6890; val_best_f1_score: 0.7480; train_kl_reg_loss: 22588.3963; train_edge_recon_loss: 359566.7674; train_gene_expr_recon_loss: 685641.7083; train_masked_gp_l1_reg_loss: 7084.3390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95858.0339; train_chrom_access_recon_loss: 1323400.5417; train_global_loss: 2494139.7222; train_optim_loss: 2494139.7222; val_kl_reg_loss: 21505.4258; val_edge_recon_loss: 404178.7812; val_gene_expr_recon_loss: 674462.0625; val_masked_gp_l1_reg_loss: 7049.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91858.4219; val_chrom_access_recon_loss: 1285211.2500; val_global_loss: 2484265.0000; val_optim_loss: 2484265.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8122; val_auprc_score: 0.8080; val_best_acc_score: 0.7203; val_best_f1_score: 0.7550; train_kl_reg_loss: 23111.4234; train_edge_recon_loss: 358954.0347; train_gene_expr_recon_loss: 679013.7847; train_masked_gp_l1_reg_loss: 7036.4654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88858.3854; train_chrom_access_recon_loss: 1323297.3056; train_global_loss: 2480271.4167; train_optim_loss: 2480271.4167; val_kl_reg_loss: 20929.9766; val_edge_recon_loss: 402839.5938; val_gene_expr_recon_loss: 669647.2500; val_masked_gp_l1_reg_loss: 7011.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85226.3594; val_chrom_access_recon_loss: 1281319.8750; val_global_loss: 2466975.0000; val_optim_loss: 2466975.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7963; val_auprc_score: 0.7879; val_best_acc_score: 0.7134; val_best_f1_score: 0.7323; train_kl_reg_loss: 22990.7431; train_edge_recon_loss: 358590.7535; train_gene_expr_recon_loss: 673835.3889; train_masked_gp_l1_reg_loss: 7007.9364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82525.3177; train_chrom_access_recon_loss: 1318501.8333; train_global_loss: 2463451.9444; train_optim_loss: 2463451.9444; val_kl_reg_loss: 22500.8379; val_edge_recon_loss: 401080.5938; val_gene_expr_recon_loss: 664870.0000; val_masked_gp_l1_reg_loss: 6989.3311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79262.8125; val_chrom_access_recon_loss: 1278200.6250; val_global_loss: 2452904.5000; val_optim_loss: 2452904.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7972; val_auprc_score: 0.7848; val_best_acc_score: 0.7158; val_best_f1_score: 0.7373; train_kl_reg_loss: 22734.4770; train_edge_recon_loss: 357880.5417; train_gene_expr_recon_loss: 670305.6944; train_masked_gp_l1_reg_loss: 6982.0081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76820.9549; train_chrom_access_recon_loss: 1312974.6944; train_global_loss: 2447698.3889; train_optim_loss: 2447698.3889; val_kl_reg_loss: 22594.8047; val_edge_recon_loss: 399174.9375; val_gene_expr_recon_loss: 661629.3750; val_masked_gp_l1_reg_loss: 6970.2129; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73864.6719; val_chrom_access_recon_loss: 1275090.5000; val_global_loss: 2439324.5000; val_optim_loss: 2439324.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7969; val_auprc_score: 0.7787; val_best_acc_score: 0.6990; val_best_f1_score: 0.7525; train_kl_reg_loss: 22797.7830; train_edge_recon_loss: 357116.4132; train_gene_expr_recon_loss: 670341.5833; train_masked_gp_l1_reg_loss: 6972.0054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71663.3793; train_chrom_access_recon_loss: 1314378.5417; train_global_loss: 2443269.7222; train_optim_loss: 2443269.7222; val_kl_reg_loss: 21552.9102; val_edge_recon_loss: 395849.7500; val_gene_expr_recon_loss: 659118.6875; val_masked_gp_l1_reg_loss: 6964.8071; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68999.7031; val_chrom_access_recon_loss: 1272142.3750; val_global_loss: 2424628.2500; val_optim_loss: 2424628.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8075; val_auprc_score: 0.7957; val_best_acc_score: 0.7231; val_best_f1_score: 0.7572; train_kl_reg_loss: 22537.6895; train_edge_recon_loss: 355861.6562; train_gene_expr_recon_loss: 665210.7083; train_masked_gp_l1_reg_loss: 6970.8437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67010.0148; train_chrom_access_recon_loss: 1311601.0972; train_global_loss: 2429192.0000; train_optim_loss: 2429192.0000; val_kl_reg_loss: 20051.0039; val_edge_recon_loss: 390623.3438; val_gene_expr_recon_loss: 658121.1250; val_masked_gp_l1_reg_loss: 6960.4155; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64590.9961; val_chrom_access_recon_loss: 1270063.6250; val_global_loss: 2410410.5000; val_optim_loss: 2410410.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8132; val_auprc_score: 0.7997; val_best_acc_score: 0.7334; val_best_f1_score: 0.7645; train_kl_reg_loss: 21798.0263; train_edge_recon_loss: 354405.3889; train_gene_expr_recon_loss: 663767.3472; train_masked_gp_l1_reg_loss: 6966.4460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62785.5859; train_chrom_access_recon_loss: 1305381.3750; train_global_loss: 2415104.1389; train_optim_loss: 2415104.1389; val_kl_reg_loss: 20539.0000; val_edge_recon_loss: 385776.6875; val_gene_expr_recon_loss: 655554.2500; val_masked_gp_l1_reg_loss: 6965.0645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60589.2656; val_chrom_access_recon_loss: 1267757.1250; val_global_loss: 2397181.5000; val_optim_loss: 2397181.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8069; val_auprc_score: 0.7948; val_best_acc_score: 0.7241; val_best_f1_score: 0.7590; train_kl_reg_loss: 21690.2046; train_edge_recon_loss: 352189.3924; train_gene_expr_recon_loss: 662126.9861; train_masked_gp_l1_reg_loss: 6978.2898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58942.3581; train_chrom_access_recon_loss: 1309208.8472; train_global_loss: 2411136.1111; train_optim_loss: 2411136.1111; val_kl_reg_loss: 19428.3242; val_edge_recon_loss: 379711.7500; val_gene_expr_recon_loss: 654882.0000; val_masked_gp_l1_reg_loss: 6981.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56935.4883; val_chrom_access_recon_loss: 1266052.1250; val_global_loss: 2383991.5000; val_optim_loss: 2383991.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8085; val_auprc_score: 0.8029; val_best_acc_score: 0.7239; val_best_f1_score: 0.7555; train_kl_reg_loss: 21305.5610; train_edge_recon_loss: 349902.4306; train_gene_expr_recon_loss: 659542.6181; train_masked_gp_l1_reg_loss: 6996.7899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55434.2478; train_chrom_access_recon_loss: 1297527.0139; train_global_loss: 2390708.6667; train_optim_loss: 2390708.6667; val_kl_reg_loss: 19732.9941; val_edge_recon_loss: 373814.8750; val_gene_expr_recon_loss: 652776.0000; val_masked_gp_l1_reg_loss: 6999.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53598.4297; val_chrom_access_recon_loss: 1263936.8750; val_global_loss: 2370859.0000; val_optim_loss: 2370859.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8140; val_auprc_score: 0.8040; val_best_acc_score: 0.7305; val_best_f1_score: 0.7613; train_kl_reg_loss: 21283.5686; train_edge_recon_loss: 346606.5243; train_gene_expr_recon_loss: 656955.0278; train_masked_gp_l1_reg_loss: 7015.0507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52221.6146; train_chrom_access_recon_loss: 1299320.1250; train_global_loss: 2383401.8889; train_optim_loss: 2383401.8889; val_kl_reg_loss: 19946.2500; val_edge_recon_loss: 363977.9062; val_gene_expr_recon_loss: 651590.0000; val_masked_gp_l1_reg_loss: 7022.5269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50537.3398; val_chrom_access_recon_loss: 1262029.7500; val_global_loss: 2355103.7500; val_optim_loss: 2355103.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8261; val_auprc_score: 0.8200; val_best_acc_score: 0.7397; val_best_f1_score: 0.7622; train_kl_reg_loss: 21638.5428; train_edge_recon_loss: 341850.8681; train_gene_expr_recon_loss: 659422.0417; train_masked_gp_l1_reg_loss: 7041.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49275.7925; train_chrom_access_recon_loss: 1297878.5417; train_global_loss: 2377107.6389; train_optim_loss: 2377107.6389; val_kl_reg_loss: 20344.4785; val_edge_recon_loss: 352940.2812; val_gene_expr_recon_loss: 651452.7500; val_masked_gp_l1_reg_loss: 7052.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47724.4727; val_chrom_access_recon_loss: 1260801.1250; val_global_loss: 2340315.5000; val_optim_loss: 2340315.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8432; val_auprc_score: 0.8365; val_best_acc_score: 0.7557; val_best_f1_score: 0.7762; train_kl_reg_loss: 22806.8192; train_edge_recon_loss: 334194.1806; train_gene_expr_recon_loss: 657993.0625; train_masked_gp_l1_reg_loss: 7073.8759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46566.8845; train_chrom_access_recon_loss: 1296809.2639; train_global_loss: 2365444.0556; train_optim_loss: 2365444.0556; val_kl_reg_loss: 22411.6641; val_edge_recon_loss: 337145.3125; val_gene_expr_recon_loss: 650963.5000; val_masked_gp_l1_reg_loss: 7092.4360; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45146.8281; val_chrom_access_recon_loss: 1258637.7500; val_global_loss: 2321397.5000; val_optim_loss: 2321397.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8482; val_auprc_score: 0.8400; val_best_acc_score: 0.7572; val_best_f1_score: 0.7823; train_kl_reg_loss: 26201.7732; train_edge_recon_loss: 324866.9306; train_gene_expr_recon_loss: 653561.1597; train_masked_gp_l1_reg_loss: 7120.8949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44083.9618; train_chrom_access_recon_loss: 1294665.5278; train_global_loss: 2350500.2222; train_optim_loss: 2350500.2222; val_kl_reg_loss: 26416.6348; val_edge_recon_loss: 324970.6875; val_gene_expr_recon_loss: 649847.6875; val_masked_gp_l1_reg_loss: 7149.0088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42772.8711; val_chrom_access_recon_loss: 1256905.5000; val_global_loss: 2308062.5000; val_optim_loss: 2308062.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8676; val_auprc_score: 0.8603; val_best_acc_score: 0.7712; val_best_f1_score: 0.7908; train_kl_reg_loss: 29902.0319; train_edge_recon_loss: 317401.4062; train_gene_expr_recon_loss: 654384.7986; train_masked_gp_l1_reg_loss: 7174.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41794.1745; train_chrom_access_recon_loss: 1290842.4722; train_global_loss: 2341499.6111; train_optim_loss: 2341499.6111; val_kl_reg_loss: 29167.0508; val_edge_recon_loss: 319309.2188; val_gene_expr_recon_loss: 648139.2500; val_masked_gp_l1_reg_loss: 7194.0386; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40588.2422; val_chrom_access_recon_loss: 1254837.0000; val_global_loss: 2299234.7500; val_optim_loss: 2299234.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8871; val_auprc_score: 0.8728; val_best_acc_score: 0.7991; val_best_f1_score: 0.8084; train_kl_reg_loss: 30326.9355; train_edge_recon_loss: 312871.6840; train_gene_expr_recon_loss: 653404.5833; train_masked_gp_l1_reg_loss: 7215.1455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39680.4206; train_chrom_access_recon_loss: 1287188.9583; train_global_loss: 2330687.7500; train_optim_loss: 2330687.7500; val_kl_reg_loss: 27782.4414; val_edge_recon_loss: 312488.0938; val_gene_expr_recon_loss: 647477.9375; val_masked_gp_l1_reg_loss: 7236.6104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38562.8633; val_chrom_access_recon_loss: 1253177.8750; val_global_loss: 2286726.0000; val_optim_loss: 2286726.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9082; val_auprc_score: 0.8932; val_best_acc_score: 0.8266; val_best_f1_score: 0.8306; train_kl_reg_loss: 29441.6361; train_edge_recon_loss: 308912.1146; train_gene_expr_recon_loss: 648179.5556; train_masked_gp_l1_reg_loss: 7261.0347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37729.5916; train_chrom_access_recon_loss: 1292692.5694; train_global_loss: 2324216.5000; train_optim_loss: 2324216.5000; val_kl_reg_loss: 27536.2344; val_edge_recon_loss: 307399.6562; val_gene_expr_recon_loss: 646569.3750; val_masked_gp_l1_reg_loss: 7279.4697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36693.9609; val_chrom_access_recon_loss: 1251384.2500; val_global_loss: 2276863.0000; val_optim_loss: 2276863.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9204; val_auprc_score: 0.9070; val_best_acc_score: 0.8413; val_best_f1_score: 0.8445; train_kl_reg_loss: 26571.7977; train_edge_recon_loss: 320572.3125; train_gene_expr_recon_loss: 968913.9167; train_masked_gp_l1_reg_loss: 7391.6899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35778.2279; train_chrom_access_recon_loss: 1364610.4583; train_global_loss: 2723838.4167; train_optim_loss: 2723838.4167; val_kl_reg_loss: 14131.4307; val_edge_recon_loss: 312738.3438; val_gene_expr_recon_loss: 953395.2500; val_masked_gp_l1_reg_loss: 7588.7646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34562.0273; val_chrom_access_recon_loss: 1321568.8750; val_global_loss: 2643984.5000; val_optim_loss: 2643984.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9205; val_auprc_score: 0.9071; val_best_acc_score: 0.8413; val_best_f1_score: 0.8474; train_kl_reg_loss: 25409.1643; train_edge_recon_loss: 308152.0694; train_gene_expr_recon_loss: 957627.5139; train_masked_gp_l1_reg_loss: 7790.2831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33570.2509; train_chrom_access_recon_loss: 1358052.3194; train_global_loss: 2690601.5833; train_optim_loss: 2690601.5833; val_kl_reg_loss: 15870.4043; val_edge_recon_loss: 306428.6562; val_gene_expr_recon_loss: 948321.0000; val_masked_gp_l1_reg_loss: 8023.7998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32349.5078; val_chrom_access_recon_loss: 1319941.2500; val_global_loss: 2630934.5000; val_optim_loss: 2630934.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9224; val_auprc_score: 0.9064; val_best_acc_score: 0.8452; val_best_f1_score: 0.8530; train_kl_reg_loss: 24047.1706; train_edge_recon_loss: 301762.8264; train_gene_expr_recon_loss: 956455.4167; train_masked_gp_l1_reg_loss: 8176.7088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31417.8483; train_chrom_access_recon_loss: 1363534.8056; train_global_loss: 2685394.7778; train_optim_loss: 2685394.7778; val_kl_reg_loss: 17764.3320; val_edge_recon_loss: 301379.7812; val_gene_expr_recon_loss: 943380.5000; val_masked_gp_l1_reg_loss: 8350.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30282.8730; val_chrom_access_recon_loss: 1317811.2500; val_global_loss: 2618969.5000; val_optim_loss: 2618969.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9230; val_auprc_score: 0.9018; val_best_acc_score: 0.8496; val_best_f1_score: 0.8549; train_kl_reg_loss: 23686.2153; train_edge_recon_loss: 298455.6910; train_gene_expr_recon_loss: 953678.2708; train_masked_gp_l1_reg_loss: 8468.5866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29428.4065; train_chrom_access_recon_loss: 1363005.3750; train_global_loss: 2676722.5556; train_optim_loss: 2676722.5556; val_kl_reg_loss: 19417.3320; val_edge_recon_loss: 299355.4375; val_gene_expr_recon_loss: 937590.6250; val_masked_gp_l1_reg_loss: 8602.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28392.3789; val_chrom_access_recon_loss: 1315315.8750; val_global_loss: 2608673.7500; val_optim_loss: 2608673.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9236; val_auprc_score: 0.9118; val_best_acc_score: 0.8448; val_best_f1_score: 0.8522; train_kl_reg_loss: 23532.5126; train_edge_recon_loss: 297078.3993; train_gene_expr_recon_loss: 943727.6389; train_masked_gp_l1_reg_loss: 8582.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28227.6560; train_chrom_access_recon_loss: 1348707.5278; train_global_loss: 2649856.3889; train_optim_loss: 2649856.3889; val_kl_reg_loss: 19724.8516; val_edge_recon_loss: 299346.8438; val_gene_expr_recon_loss: 937868.2500; val_masked_gp_l1_reg_loss: 8566.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28047.2363; val_chrom_access_recon_loss: 1315043.5000; val_global_loss: 2608597.0000; val_optim_loss: 2608597.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9241; val_auprc_score: 0.9055; val_best_acc_score: 0.8482; val_best_f1_score: 0.8581; train_kl_reg_loss: 23654.1359; train_edge_recon_loss: 297559.2951; train_gene_expr_recon_loss: 950847.3681; train_masked_gp_l1_reg_loss: 8565.5641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27940.5970; train_chrom_access_recon_loss: 1357736.0694; train_global_loss: 2666303.0278; train_optim_loss: 2666303.0278; val_kl_reg_loss: 19710.5312; val_edge_recon_loss: 297197.8750; val_gene_expr_recon_loss: 937025.7500; val_masked_gp_l1_reg_loss: 8562.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27802.2617; val_chrom_access_recon_loss: 1314985.7500; val_global_loss: 2605285.0000; val_optim_loss: 2605285.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9183; val_auprc_score: 0.8973; val_best_acc_score: 0.8428; val_best_f1_score: 0.8515; train_kl_reg_loss: 23323.3941; train_edge_recon_loss: 297266.9792; train_gene_expr_recon_loss: 944960.2986; train_masked_gp_l1_reg_loss: 8563.4661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27702.2151; train_chrom_access_recon_loss: 1352207.8333; train_global_loss: 2654024.1667; train_optim_loss: 2654024.1667; val_kl_reg_loss: 19643.4297; val_edge_recon_loss: 299607.5000; val_gene_expr_recon_loss: 936875.6875; val_masked_gp_l1_reg_loss: 8564.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27579.4688; val_chrom_access_recon_loss: 1314772.0000; val_global_loss: 2607043.0000; val_optim_loss: 2607043.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9262; val_auprc_score: 0.9095; val_best_acc_score: 0.8503; val_best_f1_score: 0.8590; train_kl_reg_loss: 23270.0977; train_edge_recon_loss: 297310.2951; train_gene_expr_recon_loss: 944501.8611; train_masked_gp_l1_reg_loss: 8567.4492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27485.8108; train_chrom_access_recon_loss: 1350067.2778; train_global_loss: 2651202.8333; train_optim_loss: 2651202.8333; val_kl_reg_loss: 19644.8438; val_edge_recon_loss: 297806.0938; val_gene_expr_recon_loss: 936442.0000; val_masked_gp_l1_reg_loss: 8571.3271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27373.0059; val_chrom_access_recon_loss: 1314709.7500; val_global_loss: 2604547.0000; val_optim_loss: 2604547.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9169
val AUPRC score: 0.9043
val best accuracy score: 0.8348
val best F1 score: 0.8417
val target rna MSE score: 3.7306
val source rna MSE score: 3.0219
val target atac MSE score: 0.1298
val source atac MSE score: 0.0188
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
