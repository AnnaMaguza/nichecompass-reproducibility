[True]
Run timestamp: 10102023_062117_168.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_168']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6192; val_auprc_score: 0.6142; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 37248.5566; train_edge_recon_loss: 729286.7074; train_gene_expr_recon_loss: 23623761.6667; train_masked_gp_l1_reg_loss: 103964.6892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3376940.8371; train_chrom_access_recon_loss: 2332303.3068; train_global_loss: 30203505.7879; train_optim_loss: 30203505.7879; val_kl_reg_loss: 70665.5830; val_edge_recon_loss: 813183.8828; val_gene_expr_recon_loss: 21306300.5000; val_masked_gp_l1_reg_loss: 85250.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2352388.7500; val_chrom_access_recon_loss: 2182411.0938; val_global_loss: 26810198.7500; val_optim_loss: 26810198.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6932; val_auprc_score: 0.6822; val_best_acc_score: 0.5427; val_best_f1_score: 0.6832; train_kl_reg_loss: 74598.9569; train_edge_recon_loss: 740056.3674; train_gene_expr_recon_loss: 21356854.2424; train_masked_gp_l1_reg_loss: 79617.5515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1575258.9119; train_chrom_access_recon_loss: 2203326.7159; train_global_loss: 26029712.9394; train_optim_loss: 26029712.9394; val_kl_reg_loss: 76921.2002; val_edge_recon_loss: 812604.9844; val_gene_expr_recon_loss: 20979210.2500; val_masked_gp_l1_reg_loss: 76890.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 969263.6875; val_chrom_access_recon_loss: 2181886.6250; val_global_loss: 25096777.2500; val_optim_loss: 25096777.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7670; val_auprc_score: 0.7593; val_best_acc_score: 0.6220; val_best_f1_score: 0.7143; train_kl_reg_loss: 72634.4737; train_edge_recon_loss: 733236.4460; train_gene_expr_recon_loss: 21115977.9091; train_masked_gp_l1_reg_loss: 76159.9427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 676202.3954; train_chrom_access_recon_loss: 2184834.6837; train_global_loss: 24859045.9697; train_optim_loss: 24859045.9697; val_kl_reg_loss: 72693.0693; val_edge_recon_loss: 811611.3359; val_gene_expr_recon_loss: 20749668.7500; val_masked_gp_l1_reg_loss: 75865.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 462866.2500; val_chrom_access_recon_loss: 2171522.0000; val_global_loss: 24344227.2500; val_optim_loss: 24344227.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8247; val_auprc_score: 0.7972; val_best_acc_score: 0.7606; val_best_f1_score: 0.7803; train_kl_reg_loss: 66690.5716; train_edge_recon_loss: 728753.2614; train_gene_expr_recon_loss: 20952608.6061; train_masked_gp_l1_reg_loss: 76511.9616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 355851.9744; train_chrom_access_recon_loss: 2172387.6951; train_global_loss: 24352804.1212; train_optim_loss: 24352804.1212; val_kl_reg_loss: 62774.8589; val_edge_recon_loss: 807739.2812; val_gene_expr_recon_loss: 20518326.0000; val_masked_gp_l1_reg_loss: 77088.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 275144.8750; val_chrom_access_recon_loss: 2143623.4688; val_global_loss: 23884695.7500; val_optim_loss: 23884695.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8685; val_auprc_score: 0.8373; val_best_acc_score: 0.7507; val_best_f1_score: 0.7943; train_kl_reg_loss: 61545.7364; train_edge_recon_loss: 724572.1458; train_gene_expr_recon_loss: 20815925.6667; train_masked_gp_l1_reg_loss: 78191.4150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232468.8897; train_chrom_access_recon_loss: 2159293.9148; train_global_loss: 24071997.6667; train_optim_loss: 24071997.6667; val_kl_reg_loss: 56262.0913; val_edge_recon_loss: 795094.0469; val_gene_expr_recon_loss: 20422579.2500; val_masked_gp_l1_reg_loss: 79360.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200042.2344; val_chrom_access_recon_loss: 2141518.4688; val_global_loss: 23694855.7500; val_optim_loss: 23694855.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8869; val_auprc_score: 0.8553; val_best_acc_score: 0.8149; val_best_f1_score: 0.8310; train_kl_reg_loss: 57065.2891; train_edge_recon_loss: 715586.6032; train_gene_expr_recon_loss: 20669878.2121; train_masked_gp_l1_reg_loss: 80753.8298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179786.7857; train_chrom_access_recon_loss: 2149761.3542; train_global_loss: 23852832.0909; train_optim_loss: 23852832.0909; val_kl_reg_loss: 57137.6875; val_edge_recon_loss: 750848.9844; val_gene_expr_recon_loss: 20498451.7500; val_masked_gp_l1_reg_loss: 82259.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162438.5781; val_chrom_access_recon_loss: 2140103.3750; val_global_loss: 23691239.5000; val_optim_loss: 23691239.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8736; val_auprc_score: 0.8397; val_best_acc_score: 0.7996; val_best_f1_score: 0.8233; train_kl_reg_loss: 56608.0533; train_edge_recon_loss: 678893.6212; train_gene_expr_recon_loss: 20549750.0303; train_masked_gp_l1_reg_loss: 83152.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148351.3954; train_chrom_access_recon_loss: 2140532.4167; train_global_loss: 23657288.0000; train_optim_loss: 23657288.0000; val_kl_reg_loss: 62846.2290; val_edge_recon_loss: 652083.7734; val_gene_expr_recon_loss: 20220119.2500; val_masked_gp_l1_reg_loss: 84089.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136284.9844; val_chrom_access_recon_loss: 2108962.1406; val_global_loss: 23264385.0000; val_optim_loss: 23264385.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8786; val_auprc_score: 0.8505; val_best_acc_score: 0.8025; val_best_f1_score: 0.8257; train_kl_reg_loss: 66780.1622; train_edge_recon_loss: 637127.9583; train_gene_expr_recon_loss: 20432969.0303; train_masked_gp_l1_reg_loss: 85043.9229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126101.9869; train_chrom_access_recon_loss: 2129392.2064; train_global_loss: 23477415.5455; train_optim_loss: 23477415.5455; val_kl_reg_loss: 66980.7686; val_edge_recon_loss: 633747.3047; val_gene_expr_recon_loss: 20015035.5000; val_masked_gp_l1_reg_loss: 86081.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118394.5000; val_chrom_access_recon_loss: 2084074.3125; val_global_loss: 23004314.0000; val_optim_loss: 23004314.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8906; val_auprc_score: 0.8604; val_best_acc_score: 0.8125; val_best_f1_score: 0.8289; train_kl_reg_loss: 68326.1462; train_edge_recon_loss: 625762.7491; train_gene_expr_recon_loss: 20350157.1212; train_masked_gp_l1_reg_loss: 86693.7949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111968.6321; train_chrom_access_recon_loss: 2124587.7936; train_global_loss: 23367496.1818; train_optim_loss: 23367496.1818; val_kl_reg_loss: 67537.7227; val_edge_recon_loss: 628713.1641; val_gene_expr_recon_loss: 20121311.2500; val_masked_gp_l1_reg_loss: 87366.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106289.1328; val_chrom_access_recon_loss: 2110200.2969; val_global_loss: 23121419.0000; val_optim_loss: 23121419.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9021; val_auprc_score: 0.8824; val_best_acc_score: 0.8203; val_best_f1_score: 0.8380; train_kl_reg_loss: 67907.1915; train_edge_recon_loss: 619709.8911; train_gene_expr_recon_loss: 20267478.7879; train_masked_gp_l1_reg_loss: 88084.0816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101654.7876; train_chrom_access_recon_loss: 2115663.1231; train_global_loss: 23260497.9091; train_optim_loss: 23260497.9091; val_kl_reg_loss: 68612.6338; val_edge_recon_loss: 618271.4062; val_gene_expr_recon_loss: 19689830.2500; val_masked_gp_l1_reg_loss: 88800.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97703.9062; val_chrom_access_recon_loss: 2056272.2656; val_global_loss: 22619490.7500; val_optim_loss: 22619490.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9099; val_auprc_score: 0.8860; val_best_acc_score: 0.8299; val_best_f1_score: 0.8454; train_kl_reg_loss: 67255.9477; train_edge_recon_loss: 613993.3371; train_gene_expr_recon_loss: 20176571.9697; train_masked_gp_l1_reg_loss: 89185.9201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94301.3410; train_chrom_access_recon_loss: 2105182.4223; train_global_loss: 23146490.8182; train_optim_loss: 23146490.8182; val_kl_reg_loss: 68273.8506; val_edge_recon_loss: 612473.9453; val_gene_expr_recon_loss: 19908538.0000; val_masked_gp_l1_reg_loss: 89945.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92362.9922; val_chrom_access_recon_loss: 2080524.8594; val_global_loss: 22852119.5000; val_optim_loss: 22852119.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9149; val_auprc_score: 0.8950; val_best_acc_score: 0.8431; val_best_f1_score: 0.8528; train_kl_reg_loss: 66850.9971; train_edge_recon_loss: 609224.3769; train_gene_expr_recon_loss: 20106354.8182; train_masked_gp_l1_reg_loss: 90393.5298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89154.3267; train_chrom_access_recon_loss: 2101050.6553; train_global_loss: 23063028.4848; train_optim_loss: 23063028.4848; val_kl_reg_loss: 66784.0449; val_edge_recon_loss: 610174.9219; val_gene_expr_recon_loss: 19877702.0000; val_masked_gp_l1_reg_loss: 90899.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87331.2656; val_chrom_access_recon_loss: 2093719.9375; val_global_loss: 22826612.5000; val_optim_loss: 22826612.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9256; val_auprc_score: 0.9064; val_best_acc_score: 0.8581; val_best_f1_score: 0.8663; train_kl_reg_loss: 66225.1259; train_edge_recon_loss: 604472.8352; train_gene_expr_recon_loss: 20022821.8788; train_masked_gp_l1_reg_loss: 91422.3391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85282.5484; train_chrom_access_recon_loss: 2091425.1383; train_global_loss: 22961649.9697; train_optim_loss: 22961649.9697; val_kl_reg_loss: 65071.4800; val_edge_recon_loss: 605469.7578; val_gene_expr_recon_loss: 19915227.7500; val_masked_gp_l1_reg_loss: 91743.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83744.7969; val_chrom_access_recon_loss: 2084291.1719; val_global_loss: 22845548.2500; val_optim_loss: 22845548.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9259; val_auprc_score: 0.9055; val_best_acc_score: 0.8587; val_best_f1_score: 0.8653; train_kl_reg_loss: 66342.9368; train_edge_recon_loss: 602308.7652; train_gene_expr_recon_loss: 19957986.6364; train_masked_gp_l1_reg_loss: 92340.8960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82496.6836; train_chrom_access_recon_loss: 2088087.2973; train_global_loss: 22889563.3636; train_optim_loss: 22889563.3636; val_kl_reg_loss: 65157.4282; val_edge_recon_loss: 606334.9766; val_gene_expr_recon_loss: 19739285.2500; val_masked_gp_l1_reg_loss: 92648.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81557.2266; val_chrom_access_recon_loss: 2053610.2188; val_global_loss: 22638593.5000; val_optim_loss: 22638593.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9234; val_auprc_score: 0.8946; val_best_acc_score: 0.8546; val_best_f1_score: 0.8662; train_kl_reg_loss: 66360.1709; train_edge_recon_loss: 600154.2244; train_gene_expr_recon_loss: 19914143.1212; train_masked_gp_l1_reg_loss: 89393.2378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65702.0716; train_chrom_access_recon_loss: 2080765.2330; train_global_loss: 22816517.7273; train_optim_loss: 22816517.7273; val_kl_reg_loss: 67437.6035; val_edge_recon_loss: 605105.6953; val_gene_expr_recon_loss: 19703899.0000; val_masked_gp_l1_reg_loss: 87926.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60334.7773; val_chrom_access_recon_loss: 2078674.8125; val_global_loss: 22603377.2500; val_optim_loss: 22603377.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9325; val_auprc_score: 0.9100; val_best_acc_score: 0.8659; val_best_f1_score: 0.8748; train_kl_reg_loss: 67335.5792; train_edge_recon_loss: 598721.1667; train_gene_expr_recon_loss: 19912853.2727; train_masked_gp_l1_reg_loss: 87644.9774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59565.6722; train_chrom_access_recon_loss: 2079098.2689; train_global_loss: 22805219.0303; train_optim_loss: 22805219.0303; val_kl_reg_loss: 67894.3291; val_edge_recon_loss: 597414.1328; val_gene_expr_recon_loss: 19875023.2500; val_masked_gp_l1_reg_loss: 87521.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59055.9922; val_chrom_access_recon_loss: 2075458.2969; val_global_loss: 22762367.5000; val_optim_loss: 22762367.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9257; val_auprc_score: 0.9038; val_best_acc_score: 0.8541; val_best_f1_score: 0.8653; train_kl_reg_loss: 67462.6406; train_edge_recon_loss: 599949.5521; train_gene_expr_recon_loss: 19911401.4545; train_masked_gp_l1_reg_loss: 87448.2731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58680.1282; train_chrom_access_recon_loss: 2078466.5000; train_global_loss: 22803408.6667; train_optim_loss: 22803408.6667; val_kl_reg_loss: 67069.0171; val_edge_recon_loss: 607479.6562; val_gene_expr_recon_loss: 19753335.5000; val_masked_gp_l1_reg_loss: 87416.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58395.3906; val_chrom_access_recon_loss: 2060395.9062; val_global_loss: 22634092.5000; val_optim_loss: 22634092.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9217; val_auprc_score: 0.9015; val_best_acc_score: 0.8520; val_best_f1_score: 0.8611; train_kl_reg_loss: 67582.1580; train_edge_recon_loss: 599821.3902; train_gene_expr_recon_loss: 19901637.6364; train_masked_gp_l1_reg_loss: 87385.1133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58025.8414; train_chrom_access_recon_loss: 2079081.8314; train_global_loss: 22793533.8788; train_optim_loss: 22793533.8788; val_kl_reg_loss: 68154.4092; val_edge_recon_loss: 604339.3828; val_gene_expr_recon_loss: 19647392.5000; val_masked_gp_l1_reg_loss: 87406.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57836.7930; val_chrom_access_recon_loss: 2049807.5625; val_global_loss: 22514935.7500; val_optim_loss: 22514935.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9332; val_auprc_score: 0.9157; val_best_acc_score: 0.8662; val_best_f1_score: 0.8723; train_kl_reg_loss: 67834.4662; train_edge_recon_loss: 598892.4811; train_gene_expr_recon_loss: 19890662.5152; train_masked_gp_l1_reg_loss: 87398.0122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57586.8978; train_chrom_access_recon_loss: 2077994.8807; train_global_loss: 22780369.2424; train_optim_loss: 22780369.2424; val_kl_reg_loss: 67779.8623; val_edge_recon_loss: 599265.7969; val_gene_expr_recon_loss: 19597391.5000; val_masked_gp_l1_reg_loss: 87358.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57334.8359; val_chrom_access_recon_loss: 2078046.5312; val_global_loss: 22487176.0000; val_optim_loss: 22487176.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9251; val_auprc_score: 0.9049; val_best_acc_score: 0.8528; val_best_f1_score: 0.8618; train_kl_reg_loss: 67934.2750; train_edge_recon_loss: 596622.6269; train_gene_expr_recon_loss: 19877539.8485; train_masked_gp_l1_reg_loss: 87372.3216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57096.1999; train_chrom_access_recon_loss: 2075806.7784; train_global_loss: 22762372.0909; train_optim_loss: 22762372.0909; val_kl_reg_loss: 68478.3818; val_edge_recon_loss: 603332.9219; val_gene_expr_recon_loss: 19727327.7500; val_masked_gp_l1_reg_loss: 87368.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56881.6875; val_chrom_access_recon_loss: 2071229.3281; val_global_loss: 22614618.7500; val_optim_loss: 22614618.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9300; val_auprc_score: 0.9071; val_best_acc_score: 0.8635; val_best_f1_score: 0.8711; train_kl_reg_loss: 68196.6349; train_edge_recon_loss: 598270.6913; train_gene_expr_recon_loss: 19858116.5152; train_masked_gp_l1_reg_loss: 87392.3732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56676.4111; train_chrom_access_recon_loss: 2075025.0758; train_global_loss: 22743677.6667; train_optim_loss: 22743677.6667; val_kl_reg_loss: 68601.9463; val_edge_recon_loss: 603660.6484; val_gene_expr_recon_loss: 19795459.7500; val_masked_gp_l1_reg_loss: 87387.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56492.8906; val_chrom_access_recon_loss: 2073728.8281; val_global_loss: 22685331.0000; val_optim_loss: 22685331.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9360; val_auprc_score: 0.9141; val_best_acc_score: 0.8713; val_best_f1_score: 0.8763; train_kl_reg_loss: 68114.8862; train_edge_recon_loss: 596946.0530; train_gene_expr_recon_loss: 19867794.6667; train_masked_gp_l1_reg_loss: 87424.8965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56289.6299; train_chrom_access_recon_loss: 2074987.8788; train_global_loss: 22751558.0909; train_optim_loss: 22751558.0909; val_kl_reg_loss: 68064.7646; val_edge_recon_loss: 597317.1797; val_gene_expr_recon_loss: 19743847.7500; val_masked_gp_l1_reg_loss: 87431.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56062.0156; val_chrom_access_recon_loss: 2068427.7500; val_global_loss: 22621152.0000; val_optim_loss: 22621152.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9355; val_auprc_score: 0.9155; val_best_acc_score: 0.8675; val_best_f1_score: 0.8758; train_kl_reg_loss: 68133.2298; train_edge_recon_loss: 596615.5009; train_gene_expr_recon_loss: 19857424.7273; train_masked_gp_l1_reg_loss: 87429.9746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55879.8637; train_chrom_access_recon_loss: 2075455.9924; train_global_loss: 22740939.4848; train_optim_loss: 22740939.4848; val_kl_reg_loss: 68740.8818; val_edge_recon_loss: 597794.2734; val_gene_expr_recon_loss: 19561277.5000; val_masked_gp_l1_reg_loss: 87463.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55678.6367; val_chrom_access_recon_loss: 2061804.9219; val_global_loss: 22432760.0000; val_optim_loss: 22432760.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9293; val_auprc_score: 0.9119; val_best_acc_score: 0.8579; val_best_f1_score: 0.8663; train_kl_reg_loss: 68133.1502; train_edge_recon_loss: 596741.6761; train_gene_expr_recon_loss: 19850607.5152; train_masked_gp_l1_reg_loss: 87469.6655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55465.4812; train_chrom_access_recon_loss: 2073350.8087; train_global_loss: 22731768.3636; train_optim_loss: 22731768.3636; val_kl_reg_loss: 68180.6436; val_edge_recon_loss: 606572.1094; val_gene_expr_recon_loss: 19521276.2500; val_masked_gp_l1_reg_loss: 87489.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55353.8555; val_chrom_access_recon_loss: 2051088.4062; val_global_loss: 22389961.5000; val_optim_loss: 22389961.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9332; val_auprc_score: 0.9155; val_best_acc_score: 0.8662; val_best_f1_score: 0.8746; train_kl_reg_loss: 68148.9556; train_edge_recon_loss: 596749.8144; train_gene_expr_recon_loss: 19837525.1818; train_masked_gp_l1_reg_loss: 87495.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55090.0355; train_chrom_access_recon_loss: 2073470.8674; train_global_loss: 22718480.6364; train_optim_loss: 22718480.6364; val_kl_reg_loss: 68403.3525; val_edge_recon_loss: 599226.0156; val_gene_expr_recon_loss: 19718302.0000; val_masked_gp_l1_reg_loss: 87511.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54927.7422; val_chrom_access_recon_loss: 2070593.7812; val_global_loss: 22598964.7500; val_optim_loss: 22598964.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9205; val_auprc_score: 0.8982; val_best_acc_score: 0.8520; val_best_f1_score: 0.8635; train_kl_reg_loss: 71768.5331; train_edge_recon_loss: 704268.5028; train_gene_expr_recon_loss: 19247411.2424; train_masked_gp_l1_reg_loss: 87130.6259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53138.0473; train_chrom_access_recon_loss: 2089744.7765; train_global_loss: 22253461.5758; train_optim_loss: 22253461.5758; val_kl_reg_loss: 34176.2163; val_edge_recon_loss: 709430.9844; val_gene_expr_recon_loss: 18974821.5000; val_masked_gp_l1_reg_loss: 87032.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52539.7070; val_chrom_access_recon_loss: 2020078.7969; val_global_loss: 21878079.5000; val_optim_loss: 21878079.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9236; val_auprc_score: 0.9036; val_best_acc_score: 0.8520; val_best_f1_score: 0.8613; train_kl_reg_loss: 73867.2049; train_edge_recon_loss: 690797.1278; train_gene_expr_recon_loss: 19106849.8182; train_masked_gp_l1_reg_loss: 86952.8799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52310.6580; train_chrom_access_recon_loss: 2016489.1080; train_global_loss: 22027266.7879; train_optim_loss: 22027266.7879; val_kl_reg_loss: 36106.4092; val_edge_recon_loss: 706944.5781; val_gene_expr_recon_loss: 18843444.7500; val_masked_gp_l1_reg_loss: 86835.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52050.2148; val_chrom_access_recon_loss: 1997270.6250; val_global_loss: 21722652.2500; val_optim_loss: 21722652.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9249; val_auprc_score: 0.9018; val_best_acc_score: 0.8603; val_best_f1_score: 0.8677; train_kl_reg_loss: 71977.0767; train_edge_recon_loss: 687873.9053; train_gene_expr_recon_loss: 19059830.8788; train_masked_gp_l1_reg_loss: 86751.5266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51799.7569; train_chrom_access_recon_loss: 2005260.1761; train_global_loss: 21963493.3333; train_optim_loss: 21963493.3333; val_kl_reg_loss: 35023.0186; val_edge_recon_loss: 703501.2188; val_gene_expr_recon_loss: 18887667.7500; val_masked_gp_l1_reg_loss: 86631.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51518.9023; val_chrom_access_recon_loss: 2001276.0781; val_global_loss: 21765618.0000; val_optim_loss: 21765618.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9252; val_auprc_score: 0.9052; val_best_acc_score: 0.8573; val_best_f1_score: 0.8659; train_kl_reg_loss: 70292.0076; train_edge_recon_loss: 683332.1922; train_gene_expr_recon_loss: 19052867.6364; train_masked_gp_l1_reg_loss: 86550.6252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51259.0640; train_chrom_access_recon_loss: 2001565.8977; train_global_loss: 21945867.4545; train_optim_loss: 21945867.4545; val_kl_reg_loss: 35146.4722; val_edge_recon_loss: 699683.7969; val_gene_expr_recon_loss: 18806715.5000; val_masked_gp_l1_reg_loss: 86465.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50953.4258; val_chrom_access_recon_loss: 1999884.1094; val_global_loss: 21678849.7500; val_optim_loss: 21678849.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9331; val_auprc_score: 0.9156; val_best_acc_score: 0.8641; val_best_f1_score: 0.8728; train_kl_reg_loss: 68367.0180; train_edge_recon_loss: 680035.6326; train_gene_expr_recon_loss: 19049628.6364; train_masked_gp_l1_reg_loss: 86358.7946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50694.9280; train_chrom_access_recon_loss: 1999642.3030; train_global_loss: 21934727.1515; train_optim_loss: 21934727.1515; val_kl_reg_loss: 35179.9048; val_edge_recon_loss: 687457.8516; val_gene_expr_recon_loss: 18736279.2500; val_masked_gp_l1_reg_loss: 86264.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50396.1602; val_chrom_access_recon_loss: 1964675.2344; val_global_loss: 21560252.7500; val_optim_loss: 21560252.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9236; val_auprc_score: 0.9011; val_best_acc_score: 0.8579; val_best_f1_score: 0.8673; train_kl_reg_loss: 66835.3861; train_edge_recon_loss: 674235.3295; train_gene_expr_recon_loss: 19037260.5758; train_masked_gp_l1_reg_loss: 86166.5375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50149.6522; train_chrom_access_recon_loss: 1997284.6496; train_global_loss: 21911931.8182; train_optim_loss: 21911931.8182; val_kl_reg_loss: 34343.9429; val_edge_recon_loss: 684357.9141; val_gene_expr_recon_loss: 18865825.2500; val_masked_gp_l1_reg_loss: 86064.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49923.4922; val_chrom_access_recon_loss: 1987660.6250; val_global_loss: 21708175.2500; val_optim_loss: 21708175.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9274; val_auprc_score: 0.9076; val_best_acc_score: 0.8608; val_best_f1_score: 0.8687; train_kl_reg_loss: 65319.0382; train_edge_recon_loss: 669097.6316; train_gene_expr_recon_loss: 19001667.3636; train_masked_gp_l1_reg_loss: 85966.7706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49692.6305; train_chrom_access_recon_loss: 1992432.5511; train_global_loss: 21864176.0000; train_optim_loss: 21864176.0000; val_kl_reg_loss: 35216.0884; val_edge_recon_loss: 674445.8203; val_gene_expr_recon_loss: 18850832.7500; val_masked_gp_l1_reg_loss: 85875.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49466.3164; val_chrom_access_recon_loss: 1965990.1875; val_global_loss: 21661826.5000; val_optim_loss: 21661826.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9245; val_auprc_score: 0.9040; val_best_acc_score: 0.8568; val_best_f1_score: 0.8657; train_kl_reg_loss: 63646.9003; train_edge_recon_loss: 664340.7519; train_gene_expr_recon_loss: 18989227.9091; train_masked_gp_l1_reg_loss: 85777.3233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49253.5224; train_chrom_access_recon_loss: 1992187.3409; train_global_loss: 21844433.6970; train_optim_loss: 21844433.6970; val_kl_reg_loss: 35086.0474; val_edge_recon_loss: 668854.1016; val_gene_expr_recon_loss: 18786173.0000; val_masked_gp_l1_reg_loss: 85669.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49061.3164; val_chrom_access_recon_loss: 1991915.8594; val_global_loss: 21616760.5000; val_optim_loss: 21616760.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9188; val_auprc_score: 0.8934; val_best_acc_score: 0.8514; val_best_f1_score: 0.8627; train_kl_reg_loss: 62493.6198; train_edge_recon_loss: 658853.2453; train_gene_expr_recon_loss: 18993710.3939; train_masked_gp_l1_reg_loss: 85556.8770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48840.4441; train_chrom_access_recon_loss: 1992242.9034; train_global_loss: 21841697.0606; train_optim_loss: 21841697.0606; val_kl_reg_loss: 35924.1440; val_edge_recon_loss: 661291.6641; val_gene_expr_recon_loss: 18915158.0000; val_masked_gp_l1_reg_loss: 85491.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48659.9180; val_chrom_access_recon_loss: 1984543.6719; val_global_loss: 21731069.2500; val_optim_loss: 21731069.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9251; val_auprc_score: 0.9017; val_best_acc_score: 0.8576; val_best_f1_score: 0.8664; train_kl_reg_loss: 61639.3968; train_edge_recon_loss: 654833.1515; train_gene_expr_recon_loss: 18969741.9091; train_masked_gp_l1_reg_loss: 85314.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47921.6969; train_chrom_access_recon_loss: 1987945.2576; train_global_loss: 21807395.8788; train_optim_loss: 21807395.8788; val_kl_reg_loss: 36269.9927; val_edge_recon_loss: 657498.1094; val_gene_expr_recon_loss: 18833769.7500; val_masked_gp_l1_reg_loss: 85214.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47688.1211; val_chrom_access_recon_loss: 1963413.5625; val_global_loss: 21623853.0000; val_optim_loss: 21623853.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9238; val_auprc_score: 0.9043; val_best_acc_score: 0.8530; val_best_f1_score: 0.8642; train_kl_reg_loss: 61647.6404; train_edge_recon_loss: 653347.9886; train_gene_expr_recon_loss: 18967577.9697; train_masked_gp_l1_reg_loss: 85169.6024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47606.0689; train_chrom_access_recon_loss: 1987626.9110; train_global_loss: 21802976.0606; train_optim_loss: 21802976.0606; val_kl_reg_loss: 36072.5386; val_edge_recon_loss: 663350.4453; val_gene_expr_recon_loss: 18675672.7500; val_masked_gp_l1_reg_loss: 85135.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47538.0312; val_chrom_access_recon_loss: 1967905.5000; val_global_loss: 21475674.2500; val_optim_loss: 21475674.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9254; val_auprc_score: 0.9034; val_best_acc_score: 0.8624; val_best_f1_score: 0.8716; train_kl_reg_loss: 61405.4715; train_edge_recon_loss: 654866.7225; train_gene_expr_recon_loss: 18973192.9394; train_masked_gp_l1_reg_loss: 85109.4705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47487.5270; train_chrom_access_recon_loss: 1988812.6212; train_global_loss: 21810874.6364; train_optim_loss: 21810874.6364; val_kl_reg_loss: 36257.0371; val_edge_recon_loss: 658089.2656; val_gene_expr_recon_loss: 18864451.5000; val_masked_gp_l1_reg_loss: 85085.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47435.3672; val_chrom_access_recon_loss: 1985057.2812; val_global_loss: 21676377.5000; val_optim_loss: 21676377.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9266; val_auprc_score: 0.9104; val_best_acc_score: 0.8573; val_best_f1_score: 0.8668; train_kl_reg_loss: 61366.7333; train_edge_recon_loss: 652343.5568; train_gene_expr_recon_loss: 18981534.0303; train_masked_gp_l1_reg_loss: 85071.8024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47402.4711; train_chrom_access_recon_loss: 1988197.6288; train_global_loss: 21815916.5758; train_optim_loss: 21815916.5758; val_kl_reg_loss: 36375.0747; val_edge_recon_loss: 660601.1875; val_gene_expr_recon_loss: 18818129.5000; val_masked_gp_l1_reg_loss: 85049.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47361.8555; val_chrom_access_recon_loss: 1970694.7500; val_global_loss: 21618212.0000; val_optim_loss: 21618212.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9247; val_auprc_score: 0.9096; val_best_acc_score: 0.8560; val_best_f1_score: 0.8665; train_kl_reg_loss: 61141.0222; train_edge_recon_loss: 653092.5227; train_gene_expr_recon_loss: 18968508.6667; train_masked_gp_l1_reg_loss: 85036.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47335.9626; train_chrom_access_recon_loss: 1988010.6326; train_global_loss: 21803125.0606; train_optim_loss: 21803125.0606; val_kl_reg_loss: 36528.2231; val_edge_recon_loss: 660800.7578; val_gene_expr_recon_loss: 18800900.2500; val_masked_gp_l1_reg_loss: 85019.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47301.7969; val_chrom_access_recon_loss: 1964338.9844; val_global_loss: 21594890.0000; val_optim_loss: 21594890.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9279; val_auprc_score: 0.9131; val_best_acc_score: 0.8546; val_best_f1_score: 0.8653; train_kl_reg_loss: 61192.4354; train_edge_recon_loss: 652927.4157; train_gene_expr_recon_loss: 18970110.7879; train_masked_gp_l1_reg_loss: 85006.9339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47272.6191; train_chrom_access_recon_loss: 1988413.8977; train_global_loss: 21804924.1515; train_optim_loss: 21804924.1515; val_kl_reg_loss: 36477.6919; val_edge_recon_loss: 658408.2422; val_gene_expr_recon_loss: 18656671.5000; val_masked_gp_l1_reg_loss: 84987.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47236.8789; val_chrom_access_recon_loss: 1964172.0781; val_global_loss: 21447954.2500; val_optim_loss: 21447954.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9241; val_auprc_score: 0.9057; val_best_acc_score: 0.8512; val_best_f1_score: 0.8610; train_kl_reg_loss: 60907.0498; train_edge_recon_loss: 652025.1259; train_gene_expr_recon_loss: 18981535.4848; train_masked_gp_l1_reg_loss: 84975.7405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47215.2807; train_chrom_access_recon_loss: 1987547.8030; train_global_loss: 21814206.3636; train_optim_loss: 21814206.3636; val_kl_reg_loss: 36507.9731; val_edge_recon_loss: 657231.3516; val_gene_expr_recon_loss: 18743310.2500; val_masked_gp_l1_reg_loss: 84960.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47182.6523; val_chrom_access_recon_loss: 1957455.8438; val_global_loss: 21526647.5000; val_optim_loss: 21526647.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9237; val_auprc_score: 0.9036; val_best_acc_score: 0.8544; val_best_f1_score: 0.8647; train_kl_reg_loss: 60874.0756; train_edge_recon_loss: 649811.1231; train_gene_expr_recon_loss: 18981235.1515; train_masked_gp_l1_reg_loss: 84949.9790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47162.3555; train_chrom_access_recon_loss: 1990348.0170; train_global_loss: 21814380.6364; train_optim_loss: 21814380.6364; val_kl_reg_loss: 36619.0552; val_edge_recon_loss: 660224.4609; val_gene_expr_recon_loss: 18639984.5000; val_masked_gp_l1_reg_loss: 84937.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47133.4336; val_chrom_access_recon_loss: 1965516.2344; val_global_loss: 21434416.2500; val_optim_loss: 21434416.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9280; val_auprc_score: 0.9113; val_best_acc_score: 0.8589; val_best_f1_score: 0.8696; train_kl_reg_loss: 60886.3516; train_edge_recon_loss: 649894.7936; train_gene_expr_recon_loss: 18973877.7879; train_masked_gp_l1_reg_loss: 84926.3857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47110.7263; train_chrom_access_recon_loss: 1990252.3523; train_global_loss: 21806948.2727; train_optim_loss: 21806948.2727; val_kl_reg_loss: 36751.0103; val_edge_recon_loss: 652276.5781; val_gene_expr_recon_loss: 18758235.2500; val_masked_gp_l1_reg_loss: 84910.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47084.3867; val_chrom_access_recon_loss: 1985009.8906; val_global_loss: 21564266.5000; val_optim_loss: 21564266.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9209; val_auprc_score: 0.8976; val_best_acc_score: 0.8514; val_best_f1_score: 0.8620; train_kl_reg_loss: 60729.3246; train_edge_recon_loss: 650306.2424; train_gene_expr_recon_loss: 18978106.3939; train_masked_gp_l1_reg_loss: 84900.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47063.6172; train_chrom_access_recon_loss: 1989036.1989; train_global_loss: 21810142.1515; train_optim_loss: 21810142.1515; val_kl_reg_loss: 36822.9639; val_edge_recon_loss: 655513.1484; val_gene_expr_recon_loss: 18679648.0000; val_masked_gp_l1_reg_loss: 84888.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47035.7148; val_chrom_access_recon_loss: 1966834.0000; val_global_loss: 21470742.0000; val_optim_loss: 21470742.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9257; val_auprc_score: 0.9088; val_best_acc_score: 0.8557; val_best_f1_score: 0.8661; train_kl_reg_loss: 60569.7698; train_edge_recon_loss: 648494.2017; train_gene_expr_recon_loss: 18977678.4545; train_masked_gp_l1_reg_loss: 84877.1288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47016.9216; train_chrom_access_recon_loss: 1986719.1098; train_global_loss: 21805355.6061; train_optim_loss: 21805355.6061; val_kl_reg_loss: 36996.1021; val_edge_recon_loss: 653919.3516; val_gene_expr_recon_loss: 18783505.5000; val_masked_gp_l1_reg_loss: 84861.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46984.1367; val_chrom_access_recon_loss: 1976991.0625; val_global_loss: 21583258.2500; val_optim_loss: 21583258.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9203; val_auprc_score: 0.8987; val_best_acc_score: 0.8520; val_best_f1_score: 0.8654; train_kl_reg_loss: 60592.7222; train_edge_recon_loss: 649146.0871; train_gene_expr_recon_loss: 18972715.6667; train_masked_gp_l1_reg_loss: 84849.9362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46966.2308; train_chrom_access_recon_loss: 1987937.3883; train_global_loss: 21802208.0303; train_optim_loss: 21802208.0303; val_kl_reg_loss: 37018.9619; val_edge_recon_loss: 654023.3828; val_gene_expr_recon_loss: 18829697.0000; val_masked_gp_l1_reg_loss: 84833.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46936.4141; val_chrom_access_recon_loss: 1975379.0312; val_global_loss: 21627888.2500; val_optim_loss: 21627888.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9225; val_auprc_score: 0.9005; val_best_acc_score: 0.8528; val_best_f1_score: 0.8654; train_kl_reg_loss: 60544.3133; train_edge_recon_loss: 648200.1023; train_gene_expr_recon_loss: 18973806.6667; train_masked_gp_l1_reg_loss: 84815.1902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46858.6453; train_chrom_access_recon_loss: 1986567.6894; train_global_loss: 21800792.5758; train_optim_loss: 21800792.5758; val_kl_reg_loss: 37004.3784; val_edge_recon_loss: 652505.5078; val_gene_expr_recon_loss: 18637872.2500; val_masked_gp_l1_reg_loss: 84805.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46837.3984; val_chrom_access_recon_loss: 1967373.5781; val_global_loss: 21426399.5000; val_optim_loss: 21426399.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9244; val_auprc_score: 0.9092; val_best_acc_score: 0.8538; val_best_f1_score: 0.8650; train_kl_reg_loss: 60573.9963; train_edge_recon_loss: 647291.1259; train_gene_expr_recon_loss: 18994027.3333; train_masked_gp_l1_reg_loss: 84800.6462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46830.7174; train_chrom_access_recon_loss: 1990327.0398; train_global_loss: 21823850.7879; train_optim_loss: 21823850.7879; val_kl_reg_loss: 37221.3955; val_edge_recon_loss: 648717.9922; val_gene_expr_recon_loss: 18811365.0000; val_masked_gp_l1_reg_loss: 84796.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46824.2695; val_chrom_access_recon_loss: 1976896.2188; val_global_loss: 21605821.2500; val_optim_loss: 21605821.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9231; val_auprc_score: 0.8991; val_best_acc_score: 0.8563; val_best_f1_score: 0.8660; train_kl_reg_loss: 60493.9591; train_edge_recon_loss: 648245.7614; train_gene_expr_recon_loss: 18969639.6061; train_masked_gp_l1_reg_loss: 84793.6945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46819.6348; train_chrom_access_recon_loss: 1990717.8049; train_global_loss: 21800710.6667; train_optim_loss: 21800710.6667; val_kl_reg_loss: 36971.5620; val_edge_recon_loss: 650813.7188; val_gene_expr_recon_loss: 18857964.7500; val_masked_gp_l1_reg_loss: 84790.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46814.5312; val_chrom_access_recon_loss: 1974930.6250; val_global_loss: 21652284.7500; val_optim_loss: 21652284.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9191; val_auprc_score: 0.8988; val_best_acc_score: 0.8512; val_best_f1_score: 0.8644; train_kl_reg_loss: 60472.7676; train_edge_recon_loss: 647898.8816; train_gene_expr_recon_loss: 18971500.7576; train_masked_gp_l1_reg_loss: 84788.8911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46810.4527; train_chrom_access_recon_loss: 1989183.6231; train_global_loss: 21800654.8182; train_optim_loss: 21800654.8182; val_kl_reg_loss: 37112.5654; val_edge_recon_loss: 654941.1875; val_gene_expr_recon_loss: 18843821.7500; val_masked_gp_l1_reg_loss: 84786.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46805.8594; val_chrom_access_recon_loss: 1992607.6562; val_global_loss: 21660075.2500; val_optim_loss: 21660075.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9356; val_auprc_score: 0.9221; val_best_acc_score: 0.8627; val_best_f1_score: 0.8724; train_kl_reg_loss: 60396.0402; train_edge_recon_loss: 647724.5900; train_gene_expr_recon_loss: 18954241.9697; train_masked_gp_l1_reg_loss: 84784.5451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46802.5544; train_chrom_access_recon_loss: 1986845.6288; train_global_loss: 21780795.3333; train_optim_loss: 21780795.3333; val_kl_reg_loss: 37041.8345; val_edge_recon_loss: 649454.7344; val_gene_expr_recon_loss: 18734172.5000; val_masked_gp_l1_reg_loss: 84782.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46798.4297; val_chrom_access_recon_loss: 1972963.7031; val_global_loss: 21525212.5000; val_optim_loss: 21525212.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9211; val_auprc_score: 0.9005; val_best_acc_score: 0.8525; val_best_f1_score: 0.8644; train_kl_reg_loss: 60383.4418; train_edge_recon_loss: 649936.1884; train_gene_expr_recon_loss: 18966599.0303; train_masked_gp_l1_reg_loss: 84780.3891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46790.3877; train_chrom_access_recon_loss: 1987964.7538; train_global_loss: 21796454.0909; train_optim_loss: 21796454.0909; val_kl_reg_loss: 37124.0254; val_edge_recon_loss: 654271.4297; val_gene_expr_recon_loss: 18878222.5000; val_masked_gp_l1_reg_loss: 84779.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46788.1914; val_chrom_access_recon_loss: 1969067.2031; val_global_loss: 21670253.2500; val_optim_loss: 21670253.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9249; val_auprc_score: 0.9032; val_best_acc_score: 0.8546; val_best_f1_score: 0.8674; train_kl_reg_loss: 60427.7818; train_edge_recon_loss: 648231.5189; train_gene_expr_recon_loss: 18959570.8485; train_masked_gp_l1_reg_loss: 84778.8474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46787.4905; train_chrom_access_recon_loss: 1986327.5909; train_global_loss: 21786123.9697; train_optim_loss: 21786123.9697; val_kl_reg_loss: 37165.5508; val_edge_recon_loss: 649744.3281; val_gene_expr_recon_loss: 18823319.0000; val_masked_gp_l1_reg_loss: 84778.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46786.8086; val_chrom_access_recon_loss: 1980096.0156; val_global_loss: 21621889.5000; val_optim_loss: 21621889.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9249; val_auprc_score: 0.9070; val_best_acc_score: 0.8568; val_best_f1_score: 0.8687; train_kl_reg_loss: 60387.6583; train_edge_recon_loss: 647493.4375; train_gene_expr_recon_loss: 18962482.5455; train_masked_gp_l1_reg_loss: 84778.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46786.2704; train_chrom_access_recon_loss: 1987607.7235; train_global_loss: 21789535.4545; train_optim_loss: 21789535.4545; val_kl_reg_loss: 37125.3965; val_edge_recon_loss: 650400.1797; val_gene_expr_recon_loss: 18856013.2500; val_masked_gp_l1_reg_loss: 84777.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46785.7227; val_chrom_access_recon_loss: 1973006.4531; val_global_loss: 21648109.2500; val_optim_loss: 21648109.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9291; val_auprc_score: 0.9142; val_best_acc_score: 0.8565; val_best_f1_score: 0.8656; train_kl_reg_loss: 60398.4154; train_edge_recon_loss: 648647.4214; train_gene_expr_recon_loss: 18969074.7879; train_masked_gp_l1_reg_loss: 84777.4493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46785.2612; train_chrom_access_recon_loss: 1986471.5720; train_global_loss: 21796155.6364; train_optim_loss: 21796155.6364; val_kl_reg_loss: 36876.7725; val_edge_recon_loss: 654942.2344; val_gene_expr_recon_loss: 18797271.0000; val_masked_gp_l1_reg_loss: 84777.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46784.7305; val_chrom_access_recon_loss: 1969209.6562; val_global_loss: 21589861.5000; val_optim_loss: 21589861.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 31 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9191
val AUPRC score: 0.8966
val best accuracy score: 0.8503
val best F1 score: 0.8631
val target rna MSE score: 1.3682
val source rna MSE score: 0.9247
val target atac MSE score: 0.3143
val source atac MSE score: 0.1343
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
