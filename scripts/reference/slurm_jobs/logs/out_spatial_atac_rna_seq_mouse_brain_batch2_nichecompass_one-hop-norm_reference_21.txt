[True]
Run timestamp: 24072023_162413_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9005; val_auprc_score: 0.9126; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8929.7974; train_edge_recon_loss: 353292.8438; train_gene_expr_recon_loss: 31712123.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1091659.9306; train_global_loss: 33166005.3333; train_optim_loss: 33166005.3333; val_kl_reg_loss: 18452.0000; val_edge_recon_loss: 406603.7188; val_gene_expr_recon_loss: 30185972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1082694.5000; val_global_loss: 31693722.0000; val_optim_loss: 31693722.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8876; val_auprc_score: 0.9009; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 37921.8963; train_edge_recon_loss: 376474.2882; train_gene_expr_recon_loss: 28720646.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064363.6528; train_global_loss: 30199406.2222; train_optim_loss: 30199406.2222; val_kl_reg_loss: 54772.9531; val_edge_recon_loss: 406611.7188; val_gene_expr_recon_loss: 27445188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060372.3750; val_global_loss: 28966944.0000; val_optim_loss: 28966944.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8516; val_auprc_score: 0.8646; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 72698.3932; train_edge_recon_loss: 392899.3924; train_gene_expr_recon_loss: 26113682.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041703.1528; train_global_loss: 27620983.5556; train_optim_loss: 27620983.5556; val_kl_reg_loss: 91984.0781; val_edge_recon_loss: 406604.7188; val_gene_expr_recon_loss: 24912226.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037553.0000; val_global_loss: 26448368.0000; val_optim_loss: 26448368.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8523; val_auprc_score: 0.8620; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 109919.8802; train_edge_recon_loss: 400529.2882; train_gene_expr_recon_loss: 24097152.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1019945.2778; train_global_loss: 25627547.5556; train_optim_loss: 25627547.5556; val_kl_reg_loss: 122402.6875; val_edge_recon_loss: 406603.0625; val_gene_expr_recon_loss: 23605454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020474.1250; val_global_loss: 25154934.0000; val_optim_loss: 25154934.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8499; val_auprc_score: 0.8557; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 127980.6233; train_edge_recon_loss: 403178.9236; train_gene_expr_recon_loss: 23045970.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997814.5833; train_global_loss: 24574945.1111; train_optim_loss: 24574945.1111; val_kl_reg_loss: 132264.5312; val_edge_recon_loss: 406586.9375; val_gene_expr_recon_loss: 22790096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008972.8750; val_global_loss: 24337920.0000; val_optim_loss: 24337920.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8582; val_auprc_score: 0.8605; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 141210.2448; train_edge_recon_loss: 404372.9410; train_gene_expr_recon_loss: 22315779.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993211.5764; train_global_loss: 23854574.0000; train_optim_loss: 23854574.0000; val_kl_reg_loss: 141187.1875; val_edge_recon_loss: 406573.3125; val_gene_expr_recon_loss: 22170406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001322.0000; val_global_loss: 23719488.0000; val_optim_loss: 23719488.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8620; val_auprc_score: 0.8605; val_best_acc_score: 0.5058; val_best_f1_score: 0.6693; train_kl_reg_loss: 148409.6979; train_edge_recon_loss: 404953.9653; train_gene_expr_recon_loss: 21875933.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992082.5903; train_global_loss: 23421379.5556; train_optim_loss: 23421379.5556; val_kl_reg_loss: 143415.0312; val_edge_recon_loss: 406540.5625; val_gene_expr_recon_loss: 21827620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997986.7500; val_global_loss: 23375562.0000; val_optim_loss: 23375562.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8673; val_auprc_score: 0.8584; val_best_acc_score: 0.5124; val_best_f1_score: 0.6722; train_kl_reg_loss: 144524.4323; train_edge_recon_loss: 405073.7257; train_gene_expr_recon_loss: 21529916.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982776.5000; train_global_loss: 23062291.3333; train_optim_loss: 23062291.3333; val_kl_reg_loss: 142887.6562; val_edge_recon_loss: 406482.5938; val_gene_expr_recon_loss: 21610502.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 995516.2500; val_global_loss: 23155388.0000; val_optim_loss: 23155388.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8631; val_auprc_score: 0.8500; val_best_acc_score: 0.5203; val_best_f1_score: 0.6755; train_kl_reg_loss: 141522.8125; train_edge_recon_loss: 404955.6667; train_gene_expr_recon_loss: 21173103.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975091.9444; train_global_loss: 22694674.0000; train_optim_loss: 22694674.0000; val_kl_reg_loss: 136293.1094; val_edge_recon_loss: 406396.3125; val_gene_expr_recon_loss: 21437156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990015.2500; val_global_loss: 22969862.0000; val_optim_loss: 22969862.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8723; val_auprc_score: 0.8601; val_best_acc_score: 0.5462; val_best_f1_score: 0.6871; train_kl_reg_loss: 137777.4080; train_edge_recon_loss: 404791.8507; train_gene_expr_recon_loss: 21115960.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976064.4097; train_global_loss: 22634593.7778; train_optim_loss: 22634593.7778; val_kl_reg_loss: 130457.4297; val_edge_recon_loss: 406241.4375; val_gene_expr_recon_loss: 21349190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988952.2500; val_global_loss: 22874840.0000; val_optim_loss: 22874840.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8759; val_auprc_score: 0.8694; val_best_acc_score: 0.5800; val_best_f1_score: 0.7027; train_kl_reg_loss: 133968.6823; train_edge_recon_loss: 404422.2118; train_gene_expr_recon_loss: 21190065.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978787.1736; train_global_loss: 22707243.7778; train_optim_loss: 22707243.7778; val_kl_reg_loss: 129187.7578; val_edge_recon_loss: 406054.6250; val_gene_expr_recon_loss: 21278118.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988202.1250; val_global_loss: 22801562.0000; val_optim_loss: 22801562.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8704; val_auprc_score: 0.8539; val_best_acc_score: 0.6182; val_best_f1_score: 0.7206; train_kl_reg_loss: 129749.9922; train_edge_recon_loss: 404295.5035; train_gene_expr_recon_loss: 20968901.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971306.3750; train_global_loss: 22474253.3333; train_optim_loss: 22474253.3333; val_kl_reg_loss: 126655.5000; val_edge_recon_loss: 405815.4062; val_gene_expr_recon_loss: 21213410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987443.1875; val_global_loss: 22733324.0000; val_optim_loss: 22733324.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8687; val_auprc_score: 0.8587; val_best_acc_score: 0.6545; val_best_f1_score: 0.7384; train_kl_reg_loss: 127530.4757; train_edge_recon_loss: 403957.0104; train_gene_expr_recon_loss: 20934309.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972263.1944; train_global_loss: 22438060.2222; train_optim_loss: 22438060.2222; val_kl_reg_loss: 123368.4375; val_edge_recon_loss: 405508.9375; val_gene_expr_recon_loss: 21146708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984889.4375; val_global_loss: 22660476.0000; val_optim_loss: 22660476.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8768; val_auprc_score: 0.8664; val_best_acc_score: 0.6968; val_best_f1_score: 0.7604; train_kl_reg_loss: 124490.0573; train_edge_recon_loss: 403374.1840; train_gene_expr_recon_loss: 20968495.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967515.7014; train_global_loss: 22463874.8889; train_optim_loss: 22463874.8889; val_kl_reg_loss: 118899.0469; val_edge_recon_loss: 405004.3125; val_gene_expr_recon_loss: 21103828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984567.1250; val_global_loss: 22612300.0000; val_optim_loss: 22612300.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8734; val_auprc_score: 0.8608; val_best_acc_score: 0.7176; val_best_f1_score: 0.7711; train_kl_reg_loss: 121615.4991; train_edge_recon_loss: 402877.4236; train_gene_expr_recon_loss: 20840609.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965425.4375; train_global_loss: 22330527.5556; train_optim_loss: 22330527.5556; val_kl_reg_loss: 117619.1719; val_edge_recon_loss: 404650.6562; val_gene_expr_recon_loss: 21038356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982308.8125; val_global_loss: 22542934.0000; val_optim_loss: 22542934.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8863; val_auprc_score: 0.8723; val_best_acc_score: 0.7522; val_best_f1_score: 0.7914; train_kl_reg_loss: 119629.1536; train_edge_recon_loss: 402313.0590; train_gene_expr_recon_loss: 20756234.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968279.6736; train_global_loss: 22246456.0000; train_optim_loss: 22246456.0000; val_kl_reg_loss: 115174.4297; val_edge_recon_loss: 404045.5000; val_gene_expr_recon_loss: 21013642.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982300.5625; val_global_loss: 22515162.0000; val_optim_loss: 22515162.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8896; val_auprc_score: 0.8767; val_best_acc_score: 0.7701; val_best_f1_score: 0.8017; train_kl_reg_loss: 115554.9766; train_edge_recon_loss: 401719.1458; train_gene_expr_recon_loss: 20756838.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968878.9028; train_global_loss: 22242991.3333; train_optim_loss: 22242991.3333; val_kl_reg_loss: 111408.1562; val_edge_recon_loss: 403712.3438; val_gene_expr_recon_loss: 20962968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980421.1875; val_global_loss: 22458510.0000; val_optim_loss: 22458510.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9037; val_auprc_score: 0.8929; val_best_acc_score: 0.8084; val_best_f1_score: 0.8280; train_kl_reg_loss: 112838.4514; train_edge_recon_loss: 400936.4097; train_gene_expr_recon_loss: 20746451.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968177.4722; train_global_loss: 22228403.3333; train_optim_loss: 22228403.3333; val_kl_reg_loss: 110236.2734; val_edge_recon_loss: 403077.3438; val_gene_expr_recon_loss: 20952786.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980223.2500; val_global_loss: 22446324.0000; val_optim_loss: 22446324.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9049; val_auprc_score: 0.8938; val_best_acc_score: 0.8325; val_best_f1_score: 0.8446; train_kl_reg_loss: 111687.5547; train_edge_recon_loss: 400183.2882; train_gene_expr_recon_loss: 20632625.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966348.9306; train_global_loss: 22110845.1111; train_optim_loss: 22110845.1111; val_kl_reg_loss: 104211.4453; val_edge_recon_loss: 402438.3438; val_gene_expr_recon_loss: 20876448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977644.5625; val_global_loss: 22360742.0000; val_optim_loss: 22360742.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9082; val_auprc_score: 0.8949; val_best_acc_score: 0.8433; val_best_f1_score: 0.8510; train_kl_reg_loss: 108286.5851; train_edge_recon_loss: 399770.5347; train_gene_expr_recon_loss: 20701936.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969437.0625; train_global_loss: 22179431.3333; train_optim_loss: 22179431.3333; val_kl_reg_loss: 101807.9922; val_edge_recon_loss: 401836.1875; val_gene_expr_recon_loss: 20877648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979257.5625; val_global_loss: 22360550.0000; val_optim_loss: 22360550.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9111; val_auprc_score: 0.8964; val_best_acc_score: 0.8447; val_best_f1_score: 0.8504; train_kl_reg_loss: 106697.8516; train_edge_recon_loss: 398698.1111; train_gene_expr_recon_loss: 20644869.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966266.0972; train_global_loss: 22116531.5556; train_optim_loss: 22116531.5556; val_kl_reg_loss: 99983.7031; val_edge_recon_loss: 401483.3438; val_gene_expr_recon_loss: 20847406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977530.9375; val_global_loss: 22326404.0000; val_optim_loss: 22326404.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9137; val_auprc_score: 0.8988; val_best_acc_score: 0.8457; val_best_f1_score: 0.8491; train_kl_reg_loss: 104303.2205; train_edge_recon_loss: 398170.2396; train_gene_expr_recon_loss: 20460732.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957446.2361; train_global_loss: 21920651.5556; train_optim_loss: 21920651.5556; val_kl_reg_loss: 98001.0234; val_edge_recon_loss: 400677.7188; val_gene_expr_recon_loss: 20798944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976094.0625; val_global_loss: 22273716.0000; val_optim_loss: 22273716.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9136; val_auprc_score: 0.8959; val_best_acc_score: 0.8437; val_best_f1_score: 0.8444; train_kl_reg_loss: 103603.2188; train_edge_recon_loss: 396837.8854; train_gene_expr_recon_loss: 20498451.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963788.4653; train_global_loss: 21962681.1111; train_optim_loss: 21962681.1111; val_kl_reg_loss: 95188.8125; val_edge_recon_loss: 399986.8750; val_gene_expr_recon_loss: 20778708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974861.0000; val_global_loss: 22248744.0000; val_optim_loss: 22248744.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9195; val_auprc_score: 0.9050; val_best_acc_score: 0.8487; val_best_f1_score: 0.8476; train_kl_reg_loss: 101441.8793; train_edge_recon_loss: 396450.7083; train_gene_expr_recon_loss: 20549938.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958314.5625; train_global_loss: 22006146.0000; train_optim_loss: 22006146.0000; val_kl_reg_loss: 94746.5781; val_edge_recon_loss: 399688.1562; val_gene_expr_recon_loss: 20775878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974690.5625; val_global_loss: 22245002.0000; val_optim_loss: 22245002.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9249; val_auprc_score: 0.9121; val_best_acc_score: 0.8503; val_best_f1_score: 0.8473; train_kl_reg_loss: 99879.1424; train_edge_recon_loss: 395291.1562; train_gene_expr_recon_loss: 20418288.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961338.4375; train_global_loss: 21874797.5556; train_optim_loss: 21874797.5556; val_kl_reg_loss: 93988.8359; val_edge_recon_loss: 398789.9688; val_gene_expr_recon_loss: 20740084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974015.5625; val_global_loss: 22206878.0000; val_optim_loss: 22206878.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9238; val_auprc_score: 0.9109; val_best_acc_score: 0.8438; val_best_f1_score: 0.8395; train_kl_reg_loss: 103301.8759; train_edge_recon_loss: 395799.8576; train_gene_expr_recon_loss: 20636305.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956464.6319; train_global_loss: 22091872.0000; train_optim_loss: 22091872.0000; val_kl_reg_loss: 87992.6875; val_edge_recon_loss: 398409.9375; val_gene_expr_recon_loss: 20950046.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974633.0625; val_global_loss: 22411082.0000; val_optim_loss: 22411082.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9184; val_auprc_score: 0.9038; val_best_acc_score: 0.8403; val_best_f1_score: 0.8358; train_kl_reg_loss: 97302.4002; train_edge_recon_loss: 394802.3299; train_gene_expr_recon_loss: 20678918.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962146.9167; train_global_loss: 22133170.4444; train_optim_loss: 22133170.4444; val_kl_reg_loss: 86003.0938; val_edge_recon_loss: 398052.2188; val_gene_expr_recon_loss: 20850090.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972860.0625; val_global_loss: 22307006.0000; val_optim_loss: 22307006.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9170; val_auprc_score: 0.9020; val_best_acc_score: 0.8386; val_best_f1_score: 0.8325; train_kl_reg_loss: 97718.3663; train_edge_recon_loss: 394056.8715; train_gene_expr_recon_loss: 20662546.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960652.7222; train_global_loss: 22114974.8889; train_optim_loss: 22114974.8889; val_kl_reg_loss: 87847.8281; val_edge_recon_loss: 397778.1250; val_gene_expr_recon_loss: 20851826.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973447.5000; val_global_loss: 22310900.0000; val_optim_loss: 22310900.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9161; val_auprc_score: 0.8978; val_best_acc_score: 0.8316; val_best_f1_score: 0.8247; train_kl_reg_loss: 95357.5417; train_edge_recon_loss: 393607.5694; train_gene_expr_recon_loss: 20436939.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957327.0347; train_global_loss: 21883231.3333; train_optim_loss: 21883231.3333; val_kl_reg_loss: 88071.3438; val_edge_recon_loss: 397116.0938; val_gene_expr_recon_loss: 20823768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972031.2500; val_global_loss: 22280988.0000; val_optim_loss: 22280988.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9269; val_auprc_score: 0.9163; val_best_acc_score: 0.8364; val_best_f1_score: 0.8274; train_kl_reg_loss: 94011.5417; train_edge_recon_loss: 394292.1597; train_gene_expr_recon_loss: 20622859.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957786.3611; train_global_loss: 22068948.8889; train_optim_loss: 22068948.8889; val_kl_reg_loss: 85841.5156; val_edge_recon_loss: 396808.5312; val_gene_expr_recon_loss: 20807514.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971566.2500; val_global_loss: 22261730.0000; val_optim_loss: 22261730.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9296; val_auprc_score: 0.9193; val_best_acc_score: 0.8418; val_best_f1_score: 0.8321; train_kl_reg_loss: 93234.5174; train_edge_recon_loss: 393137.4931; train_gene_expr_recon_loss: 20643972.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962797.5833; train_global_loss: 22093142.0000; train_optim_loss: 22093142.0000; val_kl_reg_loss: 87674.2188; val_edge_recon_loss: 397044.2188; val_gene_expr_recon_loss: 20835466.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973816.7500; val_global_loss: 22294000.0000; val_optim_loss: 22294000.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9235; val_auprc_score: 0.9123; val_best_acc_score: 0.8354; val_best_f1_score: 0.8267; train_kl_reg_loss: 95227.6788; train_edge_recon_loss: 392362.1701; train_gene_expr_recon_loss: 20612117.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960706.0278; train_global_loss: 22060413.5556; train_optim_loss: 22060413.5556; val_kl_reg_loss: 88650.6875; val_edge_recon_loss: 397046.3125; val_gene_expr_recon_loss: 20818520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972296.4375; val_global_loss: 22276512.0000; val_optim_loss: 22276512.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9241; val_auprc_score: 0.9136; val_best_acc_score: 0.8345; val_best_f1_score: 0.8250; train_kl_reg_loss: 94926.7370; train_edge_recon_loss: 392670.4028; train_gene_expr_recon_loss: 20550410.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 952559.4722; train_global_loss: 21990567.1111; train_optim_loss: 21990567.1111; val_kl_reg_loss: 87514.4375; val_edge_recon_loss: 397024.0312; val_gene_expr_recon_loss: 20797344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972493.4375; val_global_loss: 22254376.0000; val_optim_loss: 22254376.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 58 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9185
Val AUPRC score: 0.9025
Val best accuracy score: 0.8471
Val best F1 score: 0.8464
Val gene expr MSE score: 0.5107
Val chrom access MSE score: 0.0890
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
