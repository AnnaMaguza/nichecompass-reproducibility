[True]
Run timestamp: 07082023_174228_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8868; val_auprc_score: 0.9046; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23543.7940; train_edge_recon_loss: 36445.6220; train_gene_expr_recon_loss: 1218346.4722; train_masked_gp_l1_reg_loss: 4632.7116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167235.0625; train_chrom_access_recon_loss: 2319824.0972; train_global_loss: 3770027.7222; train_optim_loss: 3770027.7222; val_kl_reg_loss: 15587.6650; val_edge_recon_loss: 40660.2461; val_gene_expr_recon_loss: 1004746.7500; val_masked_gp_l1_reg_loss: 4196.0503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162549.9062; val_chrom_access_recon_loss: 1678263.1250; val_global_loss: 2906003.5000; val_optim_loss: 2906003.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8851; val_auprc_score: 0.9005; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13638.4274; train_edge_recon_loss: 38102.7569; train_gene_expr_recon_loss: 897033.0903; train_masked_gp_l1_reg_loss: 4101.5802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159576.8542; train_chrom_access_recon_loss: 1492642.6806; train_global_loss: 2605095.4167; train_optim_loss: 2605095.4167; val_kl_reg_loss: 13118.8330; val_edge_recon_loss: 40659.7031; val_gene_expr_recon_loss: 853044.5000; val_masked_gp_l1_reg_loss: 4099.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156035.3438; val_chrom_access_recon_loss: 1425969.0000; val_global_loss: 2492926.5000; val_optim_loss: 2492926.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8760; val_auprc_score: 0.8926; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16254.3191; train_edge_recon_loss: 38390.4926; train_gene_expr_recon_loss: 811531.5208; train_masked_gp_l1_reg_loss: 4213.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153217.8003; train_chrom_access_recon_loss: 1398581.4444; train_global_loss: 2422189.1389; train_optim_loss: 2422189.1389; val_kl_reg_loss: 19776.9473; val_edge_recon_loss: 40660.3047; val_gene_expr_recon_loss: 784003.2500; val_masked_gp_l1_reg_loss: 4341.8667; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149548.4219; val_chrom_access_recon_loss: 1393281.8750; val_global_loss: 2391612.7500; val_optim_loss: 2391612.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8693; val_auprc_score: 0.8877; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21327.0990; train_edge_recon_loss: 38914.1011; train_gene_expr_recon_loss: 756988.1875; train_masked_gp_l1_reg_loss: 4366.1101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146249.6788; train_chrom_access_recon_loss: 1370114.8889; train_global_loss: 2337960.0278; train_optim_loss: 2337960.0278; val_kl_reg_loss: 21537.2363; val_edge_recon_loss: 40659.4258; val_gene_expr_recon_loss: 753690.6250; val_masked_gp_l1_reg_loss: 4358.9287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141881.1250; val_chrom_access_recon_loss: 1371278.1250; val_global_loss: 2333405.5000; val_optim_loss: 2333405.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8647; val_auprc_score: 0.8800; val_best_acc_score: 0.5054; val_best_f1_score: 0.6691; train_kl_reg_loss: 21913.0751; train_edge_recon_loss: 38975.7331; train_gene_expr_recon_loss: 731582.1597; train_masked_gp_l1_reg_loss: 4344.3264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138095.1146; train_chrom_access_recon_loss: 1348356.5417; train_global_loss: 2283266.9444; train_optim_loss: 2283266.9444; val_kl_reg_loss: 22640.6699; val_edge_recon_loss: 40657.1406; val_gene_expr_recon_loss: 735666.3750; val_masked_gp_l1_reg_loss: 4322.0674; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133261.1719; val_chrom_access_recon_loss: 1357810.3750; val_global_loss: 2294357.7500; val_optim_loss: 2294357.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8711; val_auprc_score: 0.8834; val_best_acc_score: 0.5120; val_best_f1_score: 0.6720; train_kl_reg_loss: 23390.4620; train_edge_recon_loss: 39064.2908; train_gene_expr_recon_loss: 716547.6319; train_masked_gp_l1_reg_loss: 4291.5798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129311.4375; train_chrom_access_recon_loss: 1339486.4306; train_global_loss: 2252091.8056; train_optim_loss: 2252091.8056; val_kl_reg_loss: 23518.4453; val_edge_recon_loss: 40653.0234; val_gene_expr_recon_loss: 721763.2500; val_masked_gp_l1_reg_loss: 4246.7134; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124358.1250; val_chrom_access_recon_loss: 1348613.5000; val_global_loss: 2263153.0000; val_optim_loss: 2263153.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8768; val_auprc_score: 0.8799; val_best_acc_score: 0.5181; val_best_f1_score: 0.6740; train_kl_reg_loss: 23956.9412; train_edge_recon_loss: 39091.5382; train_gene_expr_recon_loss: 700476.6458; train_masked_gp_l1_reg_loss: 4218.2112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120427.1936; train_chrom_access_recon_loss: 1332592.7917; train_global_loss: 2220763.2500; train_optim_loss: 2220763.2500; val_kl_reg_loss: 24333.4863; val_edge_recon_loss: 40643.0469; val_gene_expr_recon_loss: 708803.2500; val_masked_gp_l1_reg_loss: 4180.9419; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115560.8438; val_chrom_access_recon_loss: 1340889.2500; val_global_loss: 2234410.7500; val_optim_loss: 2234410.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8629; val_auprc_score: 0.8577; val_best_acc_score: 0.5406; val_best_f1_score: 0.6826; train_kl_reg_loss: 24820.8292; train_edge_recon_loss: 39114.6892; train_gene_expr_recon_loss: 693948.8264; train_masked_gp_l1_reg_loss: 4150.2565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111762.3385; train_chrom_access_recon_loss: 1328082.0833; train_global_loss: 2201879.0556; train_optim_loss: 2201879.0556; val_kl_reg_loss: 24315.3945; val_edge_recon_loss: 40620.2227; val_gene_expr_recon_loss: 697666.0625; val_masked_gp_l1_reg_loss: 4109.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107085.0391; val_chrom_access_recon_loss: 1334351.7500; val_global_loss: 2208148.2500; val_optim_loss: 2208148.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8469; val_auprc_score: 0.8418; val_best_acc_score: 0.5763; val_best_f1_score: 0.6976; train_kl_reg_loss: 25105.6198; train_edge_recon_loss: 39123.9167; train_gene_expr_recon_loss: 679242.0972; train_masked_gp_l1_reg_loss: 4086.4580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103492.5764; train_chrom_access_recon_loss: 1319800.4028; train_global_loss: 2170851.0556; train_optim_loss: 2170851.0556; val_kl_reg_loss: 24654.3164; val_edge_recon_loss: 40591.9922; val_gene_expr_recon_loss: 689025.8750; val_masked_gp_l1_reg_loss: 4055.4839; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99092.1797; val_chrom_access_recon_loss: 1329594.3750; val_global_loss: 2187014.2500; val_optim_loss: 2187014.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8387; val_auprc_score: 0.8363; val_best_acc_score: 0.5982; val_best_f1_score: 0.7072; train_kl_reg_loss: 25413.8045; train_edge_recon_loss: 39144.1793; train_gene_expr_recon_loss: 671923.1181; train_masked_gp_l1_reg_loss: 4037.7038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95752.5078; train_chrom_access_recon_loss: 1311173.3472; train_global_loss: 2147444.6806; train_optim_loss: 2147444.6806; val_kl_reg_loss: 25184.8145; val_edge_recon_loss: 40567.4336; val_gene_expr_recon_loss: 682324.2500; val_masked_gp_l1_reg_loss: 4013.7439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91696.1875; val_chrom_access_recon_loss: 1325096.6250; val_global_loss: 2168883.0000; val_optim_loss: 2168883.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8346; val_auprc_score: 0.8377; val_best_acc_score: 0.6341; val_best_f1_score: 0.7237; train_kl_reg_loss: 25421.0666; train_edge_recon_loss: 39139.2778; train_gene_expr_recon_loss: 669072.9028; train_masked_gp_l1_reg_loss: 4001.8352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88662.3976; train_chrom_access_recon_loss: 1308854.0556; train_global_loss: 2135151.5000; train_optim_loss: 2135151.5000; val_kl_reg_loss: 24769.7773; val_edge_recon_loss: 40533.1797; val_gene_expr_recon_loss: 677363.3750; val_masked_gp_l1_reg_loss: 3985.4780; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85001.8594; val_chrom_access_recon_loss: 1321482.2500; val_global_loss: 2153136.0000; val_optim_loss: 2153136.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8339; val_auprc_score: 0.8295; val_best_acc_score: 0.6749; val_best_f1_score: 0.7442; train_kl_reg_loss: 25117.0744; train_edge_recon_loss: 39127.3390; train_gene_expr_recon_loss: 661809.6250; train_masked_gp_l1_reg_loss: 3981.2370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82287.8012; train_chrom_access_recon_loss: 1305775.8056; train_global_loss: 2118098.8611; train_optim_loss: 2118098.8611; val_kl_reg_loss: 24143.1719; val_edge_recon_loss: 40501.5547; val_gene_expr_recon_loss: 673676.9375; val_masked_gp_l1_reg_loss: 3967.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79006.6719; val_chrom_access_recon_loss: 1318470.5000; val_global_loss: 2139766.5000; val_optim_loss: 2139766.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8405; val_auprc_score: 0.8400; val_best_acc_score: 0.6982; val_best_f1_score: 0.7544; train_kl_reg_loss: 24775.9414; train_edge_recon_loss: 39106.9253; train_gene_expr_recon_loss: 661920.7917; train_masked_gp_l1_reg_loss: 3965.3726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76569.8655; train_chrom_access_recon_loss: 1309806.3194; train_global_loss: 2116145.2500; train_optim_loss: 2116145.2500; val_kl_reg_loss: 23442.4629; val_edge_recon_loss: 40470.3672; val_gene_expr_recon_loss: 670862.3750; val_masked_gp_l1_reg_loss: 3954.3079; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73625.7109; val_chrom_access_recon_loss: 1316039.5000; val_global_loss: 2128394.7500; val_optim_loss: 2128394.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8500; val_auprc_score: 0.8466; val_best_acc_score: 0.7257; val_best_f1_score: 0.7698; train_kl_reg_loss: 24159.5938; train_edge_recon_loss: 39078.6402; train_gene_expr_recon_loss: 656232.7361; train_masked_gp_l1_reg_loss: 3949.3308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71440.7552; train_chrom_access_recon_loss: 1300678.5694; train_global_loss: 2095539.6528; train_optim_loss: 2095539.6528; val_kl_reg_loss: 23342.8359; val_edge_recon_loss: 40450.8516; val_gene_expr_recon_loss: 667660.6875; val_masked_gp_l1_reg_loss: 3937.8857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68789.8594; val_chrom_access_recon_loss: 1313307.7500; val_global_loss: 2117490.0000; val_optim_loss: 2117490.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8661; val_auprc_score: 0.8631; val_best_acc_score: 0.7537; val_best_f1_score: 0.7861; train_kl_reg_loss: 23744.6365; train_edge_recon_loss: 39033.5690; train_gene_expr_recon_loss: 653358.6597; train_masked_gp_l1_reg_loss: 3939.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66808.9475; train_chrom_access_recon_loss: 1296406.1111; train_global_loss: 2083291.3333; train_optim_loss: 2083291.3333; val_kl_reg_loss: 23390.4727; val_edge_recon_loss: 40413.3516; val_gene_expr_recon_loss: 665269.5000; val_masked_gp_l1_reg_loss: 3936.1619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64406.8203; val_chrom_access_recon_loss: 1310491.0000; val_global_loss: 2107907.2500; val_optim_loss: 2107907.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8706; val_auprc_score: 0.8665; val_best_acc_score: 0.7805; val_best_f1_score: 0.8013; train_kl_reg_loss: 23457.9570; train_edge_recon_loss: 39015.5694; train_gene_expr_recon_loss: 653280.0000; train_masked_gp_l1_reg_loss: 3937.7888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62616.1259; train_chrom_access_recon_loss: 1294537.7917; train_global_loss: 2076845.2222; train_optim_loss: 2076845.2222; val_kl_reg_loss: 22477.0059; val_edge_recon_loss: 40383.6211; val_gene_expr_recon_loss: 663520.8750; val_masked_gp_l1_reg_loss: 3935.0071; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60446.1250; val_chrom_access_recon_loss: 1308951.7500; val_global_loss: 2099714.5000; val_optim_loss: 2099714.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8814; val_auprc_score: 0.8717; val_best_acc_score: 0.8033; val_best_f1_score: 0.8159; train_kl_reg_loss: 23039.0903; train_edge_recon_loss: 38974.6736; train_gene_expr_recon_loss: 651703.7847; train_masked_gp_l1_reg_loss: 3932.9447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58825.0582; train_chrom_access_recon_loss: 1298248.5833; train_global_loss: 2074724.1250; train_optim_loss: 2074724.1250; val_kl_reg_loss: 21725.3477; val_edge_recon_loss: 40328.8203; val_gene_expr_recon_loss: 662048.9375; val_masked_gp_l1_reg_loss: 3927.7515; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56854.7188; val_chrom_access_recon_loss: 1309665.3750; val_global_loss: 2094551.0000; val_optim_loss: 2094551.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8881; val_auprc_score: 0.8801; val_best_acc_score: 0.8165; val_best_f1_score: 0.8241; train_kl_reg_loss: 22465.1159; train_edge_recon_loss: 38932.6337; train_gene_expr_recon_loss: 650342.9722; train_masked_gp_l1_reg_loss: 3933.4602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55376.5677; train_chrom_access_recon_loss: 1294404.4722; train_global_loss: 2065455.2222; train_optim_loss: 2065455.2222; val_kl_reg_loss: 21370.7617; val_edge_recon_loss: 40288.9258; val_gene_expr_recon_loss: 660225.2500; val_masked_gp_l1_reg_loss: 3930.5398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53568.2812; val_chrom_access_recon_loss: 1306905.3750; val_global_loss: 2086289.1250; val_optim_loss: 2086289.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8919; val_auprc_score: 0.8808; val_best_acc_score: 0.8207; val_best_f1_score: 0.8244; train_kl_reg_loss: 21977.6183; train_edge_recon_loss: 38875.0768; train_gene_expr_recon_loss: 648508.4931; train_masked_gp_l1_reg_loss: 3934.6660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52218.3338; train_chrom_access_recon_loss: 1291001.3194; train_global_loss: 2056515.5000; train_optim_loss: 2056515.5000; val_kl_reg_loss: 20721.4922; val_edge_recon_loss: 40233.5039; val_gene_expr_recon_loss: 658989.6250; val_masked_gp_l1_reg_loss: 3933.4902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50568.5078; val_chrom_access_recon_loss: 1305160.5000; val_global_loss: 2079607.1250; val_optim_loss: 2079607.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8940; val_auprc_score: 0.8835; val_best_acc_score: 0.8251; val_best_f1_score: 0.8240; train_kl_reg_loss: 21708.6007; train_edge_recon_loss: 38832.9449; train_gene_expr_recon_loss: 649187.3819; train_masked_gp_l1_reg_loss: 3940.0470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49331.4770; train_chrom_access_recon_loss: 1292724.8611; train_global_loss: 2055725.2917; train_optim_loss: 2055725.2917; val_kl_reg_loss: 19677.8203; val_edge_recon_loss: 40163.2695; val_gene_expr_recon_loss: 659404.2500; val_masked_gp_l1_reg_loss: 3942.5283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47816.6797; val_chrom_access_recon_loss: 1303741.0000; val_global_loss: 2074745.5000; val_optim_loss: 2074745.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8990; val_auprc_score: 0.8881; val_best_acc_score: 0.8261; val_best_f1_score: 0.8259; train_kl_reg_loss: 21244.7715; train_edge_recon_loss: 38782.4674; train_gene_expr_recon_loss: 647322.6875; train_masked_gp_l1_reg_loss: 3952.7266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46687.8976; train_chrom_access_recon_loss: 1290865.5139; train_global_loss: 2048856.0556; train_optim_loss: 2048856.0556; val_kl_reg_loss: 20730.3789; val_edge_recon_loss: 40161.0742; val_gene_expr_recon_loss: 655523.6250; val_masked_gp_l1_reg_loss: 3952.9741; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45291.8164; val_chrom_access_recon_loss: 1301020.6250; val_global_loss: 2066680.5000; val_optim_loss: 2066680.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9047; val_auprc_score: 0.8889; val_best_acc_score: 0.8274; val_best_f1_score: 0.8240; train_kl_reg_loss: 21043.9909; train_edge_recon_loss: 38723.7539; train_gene_expr_recon_loss: 645055.0486; train_masked_gp_l1_reg_loss: 3962.9800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44243.1523; train_chrom_access_recon_loss: 1286354.7500; train_global_loss: 2039383.6806; train_optim_loss: 2039383.6806; val_kl_reg_loss: 20569.3008; val_edge_recon_loss: 40065.5938; val_gene_expr_recon_loss: 654157.3125; val_masked_gp_l1_reg_loss: 3965.2603; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42954.3672; val_chrom_access_recon_loss: 1299287.7500; val_global_loss: 2060999.5000; val_optim_loss: 2060999.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9190; val_auprc_score: 0.9080; val_best_acc_score: 0.8406; val_best_f1_score: 0.8314; train_kl_reg_loss: 20895.4162; train_edge_recon_loss: 38656.8077; train_gene_expr_recon_loss: 641411.3819; train_masked_gp_l1_reg_loss: 3967.5368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41985.4431; train_chrom_access_recon_loss: 1284291.1528; train_global_loss: 2031207.7500; train_optim_loss: 2031207.7500; val_kl_reg_loss: 20078.1035; val_edge_recon_loss: 39958.9492; val_gene_expr_recon_loss: 653047.5000; val_masked_gp_l1_reg_loss: 3966.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40790.7344; val_chrom_access_recon_loss: 1297041.2500; val_global_loss: 2054883.1250; val_optim_loss: 2054883.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9198; val_auprc_score: 0.9070; val_best_acc_score: 0.8328; val_best_f1_score: 0.8200; train_kl_reg_loss: 20728.1461; train_edge_recon_loss: 38584.5998; train_gene_expr_recon_loss: 641038.6389; train_masked_gp_l1_reg_loss: 3970.9002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39891.1562; train_chrom_access_recon_loss: 1286217.2778; train_global_loss: 2030430.7222; train_optim_loss: 2030430.7222; val_kl_reg_loss: 19873.8730; val_edge_recon_loss: 39887.7812; val_gene_expr_recon_loss: 651894.3750; val_masked_gp_l1_reg_loss: 3970.5369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38780.7578; val_chrom_access_recon_loss: 1294879.5000; val_global_loss: 2049286.7500; val_optim_loss: 2049286.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9241; val_auprc_score: 0.9098; val_best_acc_score: 0.8263; val_best_f1_score: 0.8124; train_kl_reg_loss: 20630.5909; train_edge_recon_loss: 38517.4961; train_gene_expr_recon_loss: 638800.6597; train_masked_gp_l1_reg_loss: 3976.7889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37949.5056; train_chrom_access_recon_loss: 1286287.8056; train_global_loss: 2026162.8333; train_optim_loss: 2026162.8333; val_kl_reg_loss: 19600.3281; val_edge_recon_loss: 39812.0508; val_gene_expr_recon_loss: 651135.3125; val_masked_gp_l1_reg_loss: 3978.7209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36920.0625; val_chrom_access_recon_loss: 1292361.7500; val_global_loss: 2043808.2500; val_optim_loss: 2043808.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9222; val_auprc_score: 0.9100; val_best_acc_score: 0.8508; val_best_f1_score: 0.8578; train_kl_reg_loss: 18078.0141; train_edge_recon_loss: 40054.7170; train_gene_expr_recon_loss: 919531.6806; train_masked_gp_l1_reg_loss: 4041.7888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35967.6684; train_chrom_access_recon_loss: 1354643.5417; train_global_loss: 2372317.3889; train_optim_loss: 2372317.3889; val_kl_reg_loss: 14335.1738; val_edge_recon_loss: 40301.4492; val_gene_expr_recon_loss: 928633.1875; val_masked_gp_l1_reg_loss: 4150.7222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34680.2422; val_chrom_access_recon_loss: 1366831.6250; val_global_loss: 2388932.5000; val_optim_loss: 2388932.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9183; val_auprc_score: 0.9086; val_best_acc_score: 0.8456; val_best_f1_score: 0.8544; train_kl_reg_loss: 16344.1892; train_edge_recon_loss: 40111.8776; train_gene_expr_recon_loss: 907380.6389; train_masked_gp_l1_reg_loss: 4246.5895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33623.1135; train_chrom_access_recon_loss: 1348043.8750; train_global_loss: 2349750.2500; train_optim_loss: 2349750.2500; val_kl_reg_loss: 14038.8584; val_edge_recon_loss: 40327.6562; val_gene_expr_recon_loss: 921392.3750; val_masked_gp_l1_reg_loss: 4352.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32328.9102; val_chrom_access_recon_loss: 1364064.0000; val_global_loss: 2376504.0000; val_optim_loss: 2376504.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9219; val_auprc_score: 0.9086; val_best_acc_score: 0.8487; val_best_f1_score: 0.8571; train_kl_reg_loss: 15898.6421; train_edge_recon_loss: 40116.5981; train_gene_expr_recon_loss: 902050.2431; train_masked_gp_l1_reg_loss: 4416.5673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31354.2437; train_chrom_access_recon_loss: 1346794.8472; train_global_loss: 2340631.1944; train_optim_loss: 2340631.1944; val_kl_reg_loss: 13933.3350; val_edge_recon_loss: 40334.4883; val_gene_expr_recon_loss: 916014.5000; val_masked_gp_l1_reg_loss: 4484.4604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30176.5078; val_chrom_access_recon_loss: 1361890.0000; val_global_loss: 2366833.2500; val_optim_loss: 2366833.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9265; val_auprc_score: 0.9174; val_best_acc_score: 0.8561; val_best_f1_score: 0.8627; train_kl_reg_loss: 15725.4779; train_edge_recon_loss: 40133.3051; train_gene_expr_recon_loss: 896657.5208; train_masked_gp_l1_reg_loss: 4525.9322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29302.4043; train_chrom_access_recon_loss: 1343068.8056; train_global_loss: 2329413.4444; train_optim_loss: 2329413.4444; val_kl_reg_loss: 14221.2793; val_edge_recon_loss: 40303.4805; val_gene_expr_recon_loss: 911519.8750; val_masked_gp_l1_reg_loss: 4570.4795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28252.4336; val_chrom_access_recon_loss: 1359753.3750; val_global_loss: 2358621.0000; val_optim_loss: 2358621.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9261; val_auprc_score: 0.9126; val_best_acc_score: 0.8584; val_best_f1_score: 0.8645; train_kl_reg_loss: 15635.9957; train_edge_recon_loss: 40116.4249; train_gene_expr_recon_loss: 894744.4375; train_masked_gp_l1_reg_loss: 4560.1317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28083.1955; train_chrom_access_recon_loss: 1348625.1111; train_global_loss: 2331765.3611; train_optim_loss: 2331765.3611; val_kl_reg_loss: 14456.4629; val_edge_recon_loss: 40298.0234; val_gene_expr_recon_loss: 910898.5000; val_masked_gp_l1_reg_loss: 4551.1113; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27896.0586; val_chrom_access_recon_loss: 1359543.2500; val_global_loss: 2357643.5000; val_optim_loss: 2357643.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9257; val_auprc_score: 0.9094; val_best_acc_score: 0.8560; val_best_f1_score: 0.8625; train_kl_reg_loss: 15748.2489; train_edge_recon_loss: 40121.4987; train_gene_expr_recon_loss: 892264.8750; train_masked_gp_l1_reg_loss: 4549.8820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27786.1248; train_chrom_access_recon_loss: 1343088.4722; train_global_loss: 2323559.1111; train_optim_loss: 2323559.1111; val_kl_reg_loss: 14410.5469; val_edge_recon_loss: 40304.1719; val_gene_expr_recon_loss: 910627.1250; val_masked_gp_l1_reg_loss: 4546.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27643.6621; val_chrom_access_recon_loss: 1359470.2500; val_global_loss: 2357002.7500; val_optim_loss: 2357002.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9287; val_auprc_score: 0.9172; val_best_acc_score: 0.8611; val_best_f1_score: 0.8667; train_kl_reg_loss: 15682.5220; train_edge_recon_loss: 40111.5343; train_gene_expr_recon_loss: 896554.4028; train_masked_gp_l1_reg_loss: 4545.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27541.1161; train_chrom_access_recon_loss: 1350188.0139; train_global_loss: 2334622.9167; train_optim_loss: 2334622.9167; val_kl_reg_loss: 14382.4336; val_edge_recon_loss: 40285.5586; val_gene_expr_recon_loss: 910231.4375; val_masked_gp_l1_reg_loss: 4543.8315; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27416.0039; val_chrom_access_recon_loss: 1359276.0000; val_global_loss: 2356135.2500; val_optim_loss: 2356135.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9240; val_auprc_score: 0.9141; val_best_acc_score: 0.8518; val_best_f1_score: 0.8590; train_kl_reg_loss: 15664.3433; train_edge_recon_loss: 40107.7105; train_gene_expr_recon_loss: 892295.6736; train_masked_gp_l1_reg_loss: 4543.4725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27321.2454; train_chrom_access_recon_loss: 1345380.8333; train_global_loss: 2325313.3056; train_optim_loss: 2325313.3056; val_kl_reg_loss: 14394.1680; val_edge_recon_loss: 40300.2812; val_gene_expr_recon_loss: 909791.7500; val_masked_gp_l1_reg_loss: 4543.3716; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27207.9785; val_chrom_access_recon_loss: 1358882.1250; val_global_loss: 2355119.7500; val_optim_loss: 2355119.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9210
val AUPRC score: 0.9088
val best accuracy score: 0.8484
val best F1 score: 0.8575
val target rna MSE score: 4.1759
val source rna MSE score: 3.2440
val target atac MSE score: 0.1408
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
