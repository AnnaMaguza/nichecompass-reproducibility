[True]
Run timestamp: 09102023_200211_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7763; val_auprc_score: 0.7943; val_best_acc_score: 0.6252; val_best_f1_score: 0.7164; train_kl_reg_loss: 46499.7795; train_edge_recon_loss: 3500659.2710; train_gene_expr_recon_loss: 13451231.0076; train_masked_gp_l1_reg_loss: 36500.3128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2406597.8469; train_chrom_access_recon_loss: 2256083.8397; train_global_loss: 21697572.1374; train_optim_loss: 21697572.1374; val_kl_reg_loss: 75991.6833; val_edge_recon_loss: 4058165.5667; val_gene_expr_recon_loss: 12782210.2667; val_masked_gp_l1_reg_loss: 45058.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 599916.3750; val_chrom_access_recon_loss: 2179066.8583; val_global_loss: 19740408.6667; val_optim_loss: 19740408.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8090; val_auprc_score: 0.8171; val_best_acc_score: 0.7106; val_best_f1_score: 0.7496; train_kl_reg_loss: 65721.1059; train_edge_recon_loss: 3487655.2214; train_gene_expr_recon_loss: 12631423.1221; train_masked_gp_l1_reg_loss: 46973.9648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 314700.4466; train_chrom_access_recon_loss: 2168989.5248; train_global_loss: 18715463.4504; train_optim_loss: 18715463.4504; val_kl_reg_loss: 57113.3927; val_edge_recon_loss: 3950165.3333; val_gene_expr_recon_loss: 12496110.4667; val_masked_gp_l1_reg_loss: 49018.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179951.0625; val_chrom_access_recon_loss: 2138546.7000; val_global_loss: 18870905.8667; val_optim_loss: 18870905.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8457; val_auprc_score: 0.8446; val_best_acc_score: 0.7493; val_best_f1_score: 0.7760; train_kl_reg_loss: 67265.2960; train_edge_recon_loss: 3184574.5611; train_gene_expr_recon_loss: 12452689.7176; train_masked_gp_l1_reg_loss: 52447.9214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140236.0366; train_chrom_access_recon_loss: 2143852.8760; train_global_loss: 18041066.4733; train_optim_loss: 18041066.4733; val_kl_reg_loss: 80299.4984; val_edge_recon_loss: 3002593.5667; val_gene_expr_recon_loss: 12429026.1333; val_masked_gp_l1_reg_loss: 55984.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111394.9766; val_chrom_access_recon_loss: 2109561.8583; val_global_loss: 17788860.1333; val_optim_loss: 17788860.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8777; val_auprc_score: 0.8666; val_best_acc_score: 0.7945; val_best_f1_score: 0.8129; train_kl_reg_loss: 80978.4531; train_edge_recon_loss: 2953197.4676; train_gene_expr_recon_loss: 12295918.5878; train_masked_gp_l1_reg_loss: 58286.2005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103588.1232; train_chrom_access_recon_loss: 2120660.6250; train_global_loss: 17612629.4962; train_optim_loss: 17612629.4962; val_kl_reg_loss: 75530.4068; val_edge_recon_loss: 2935408.7667; val_gene_expr_recon_loss: 12214524.8667; val_masked_gp_l1_reg_loss: 60342.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100664.9062; val_chrom_access_recon_loss: 2095973.6750; val_global_loss: 17482444.8000; val_optim_loss: 17482444.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9175; val_auprc_score: 0.9010; val_best_acc_score: 0.8472; val_best_f1_score: 0.8567; train_kl_reg_loss: 81840.4622; train_edge_recon_loss: 2833526.7920; train_gene_expr_recon_loss: 12147196.8168; train_masked_gp_l1_reg_loss: 62365.2607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95197.2399; train_chrom_access_recon_loss: 2098326.8006; train_global_loss: 17318453.4198; train_optim_loss: 17318453.4198; val_kl_reg_loss: 82911.3495; val_edge_recon_loss: 2831556.1000; val_gene_expr_recon_loss: 12065608.3333; val_masked_gp_l1_reg_loss: 64053.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89595.2969; val_chrom_access_recon_loss: 2074744.7500; val_global_loss: 17208469.9333; val_optim_loss: 17208469.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9269; val_auprc_score: 0.9143; val_best_acc_score: 0.8587; val_best_f1_score: 0.8639; train_kl_reg_loss: 84637.7402; train_edge_recon_loss: 2790162.7195; train_gene_expr_recon_loss: 12046353.2137; train_masked_gp_l1_reg_loss: 65366.5399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85224.1277; train_chrom_access_recon_loss: 2082981.9323; train_global_loss: 17154726.2595; train_optim_loss: 17154726.2595; val_kl_reg_loss: 83215.1281; val_edge_recon_loss: 2823033.6333; val_gene_expr_recon_loss: 12004344.6000; val_masked_gp_l1_reg_loss: 66476.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81158.1484; val_chrom_access_recon_loss: 2053912.6750; val_global_loss: 17112140.0000; val_optim_loss: 17112140.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9303; val_auprc_score: 0.9182; val_best_acc_score: 0.8627; val_best_f1_score: 0.8713; train_kl_reg_loss: 80915.0969; train_edge_recon_loss: 2780206.5382; train_gene_expr_recon_loss: 11953102.3664; train_masked_gp_l1_reg_loss: 67548.5711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78654.7349; train_chrom_access_recon_loss: 2065275.8979; train_global_loss: 17025703.2366; train_optim_loss: 17025703.2366; val_kl_reg_loss: 77285.3672; val_edge_recon_loss: 2797200.6333; val_gene_expr_recon_loss: 11999845.6000; val_masked_gp_l1_reg_loss: 68476.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76664.7891; val_chrom_access_recon_loss: 2058794.0917; val_global_loss: 17078267.6667; val_optim_loss: 17078267.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9372; val_auprc_score: 0.9246; val_best_acc_score: 0.8707; val_best_f1_score: 0.8774; train_kl_reg_loss: 76858.8323; train_edge_recon_loss: 2759738.3302; train_gene_expr_recon_loss: 11889041.1679; train_masked_gp_l1_reg_loss: 69455.9213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74551.4543; train_chrom_access_recon_loss: 2056257.5334; train_global_loss: 16925903.2977; train_optim_loss: 16925903.2977; val_kl_reg_loss: 75762.9776; val_edge_recon_loss: 2780058.9500; val_gene_expr_recon_loss: 11856604.0000; val_masked_gp_l1_reg_loss: 70197.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72845.2344; val_chrom_access_recon_loss: 2031253.2333; val_global_loss: 16886721.1333; val_optim_loss: 16886721.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9420; val_auprc_score: 0.9316; val_best_acc_score: 0.8791; val_best_f1_score: 0.8849; train_kl_reg_loss: 75815.0833; train_edge_recon_loss: 2744199.6450; train_gene_expr_recon_loss: 11820498.1832; train_masked_gp_l1_reg_loss: 71034.5265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71741.9537; train_chrom_access_recon_loss: 2043095.6737; train_global_loss: 16826385.0153; train_optim_loss: 16826385.0153; val_kl_reg_loss: 77254.2958; val_edge_recon_loss: 2751204.3167; val_gene_expr_recon_loss: 11802310.8000; val_masked_gp_l1_reg_loss: 71744.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70662.5859; val_chrom_access_recon_loss: 2026695.5917; val_global_loss: 16799873.1333; val_optim_loss: 16799873.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9523; val_auprc_score: 0.9438; val_best_acc_score: 0.8894; val_best_f1_score: 0.8943; train_kl_reg_loss: 73529.8982; train_edge_recon_loss: 2743071.5324; train_gene_expr_recon_loss: 11763151.8168; train_masked_gp_l1_reg_loss: 72269.1784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70509.3019; train_chrom_access_recon_loss: 2032031.3721; train_global_loss: 16754563.0916; train_optim_loss: 16754563.0916; val_kl_reg_loss: 73915.1318; val_edge_recon_loss: 2717646.0333; val_gene_expr_recon_loss: 11756316.2667; val_masked_gp_l1_reg_loss: 72965.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71681.3984; val_chrom_access_recon_loss: 2013731.3833; val_global_loss: 16706255.6667; val_optim_loss: 16706255.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9527; val_auprc_score: 0.9424; val_best_acc_score: 0.8913; val_best_f1_score: 0.8974; train_kl_reg_loss: 73302.8693; train_edge_recon_loss: 2721895.0134; train_gene_expr_recon_loss: 11713484.4122; train_masked_gp_l1_reg_loss: 73376.3654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71524.9849; train_chrom_access_recon_loss: 2025191.3874; train_global_loss: 16678775.0458; train_optim_loss: 16678775.0458; val_kl_reg_loss: 73075.7443; val_edge_recon_loss: 2715398.3500; val_gene_expr_recon_loss: 11689669.7333; val_masked_gp_l1_reg_loss: 73811.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72585.5234; val_chrom_access_recon_loss: 2012561.3750; val_global_loss: 16637103.2667; val_optim_loss: 16637103.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9523; val_auprc_score: 0.9409; val_best_acc_score: 0.8949; val_best_f1_score: 0.8988; train_kl_reg_loss: 71218.9904; train_edge_recon_loss: 2721944.9141; train_gene_expr_recon_loss: 11653919.0382; train_masked_gp_l1_reg_loss: 74246.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72207.5853; train_chrom_access_recon_loss: 2013890.1460; train_global_loss: 16607427.4046; train_optim_loss: 16607427.4046; val_kl_reg_loss: 69509.4674; val_edge_recon_loss: 2727637.7333; val_gene_expr_recon_loss: 11662231.5333; val_masked_gp_l1_reg_loss: 74633.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71896.1406; val_chrom_access_recon_loss: 1990994.0417; val_global_loss: 16596901.6667; val_optim_loss: 16596901.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9535; val_auprc_score: 0.9405; val_best_acc_score: 0.8968; val_best_f1_score: 0.9017; train_kl_reg_loss: 71322.5828; train_edge_recon_loss: 2712306.6145; train_gene_expr_recon_loss: 11620544.2290; train_masked_gp_l1_reg_loss: 74851.7065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71999.9165; train_chrom_access_recon_loss: 2008404.9094; train_global_loss: 16559430.0076; train_optim_loss: 16559430.0076; val_kl_reg_loss: 70451.5698; val_edge_recon_loss: 2717191.5167; val_gene_expr_recon_loss: 11597217.2667; val_masked_gp_l1_reg_loss: 75082.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71922.5469; val_chrom_access_recon_loss: 1984993.5083; val_global_loss: 16516860.0000; val_optim_loss: 16516860.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9581; val_auprc_score: 0.9490; val_best_acc_score: 0.8954; val_best_f1_score: 0.9009; train_kl_reg_loss: 69352.4488; train_edge_recon_loss: 2703839.0992; train_gene_expr_recon_loss: 11577925.5344; train_masked_gp_l1_reg_loss: 75428.7197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71491.6256; train_chrom_access_recon_loss: 2001730.0315; train_global_loss: 16499767.4656; train_optim_loss: 16499767.4656; val_kl_reg_loss: 71598.9344; val_edge_recon_loss: 2726834.8500; val_gene_expr_recon_loss: 11569602.8000; val_masked_gp_l1_reg_loss: 75656.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71543.8906; val_chrom_access_recon_loss: 1984762.5167; val_global_loss: 16499999.0000; val_optim_loss: 16499999.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9593; val_auprc_score: 0.9510; val_best_acc_score: 0.9018; val_best_f1_score: 0.9060; train_kl_reg_loss: 70483.4895; train_edge_recon_loss: 2704661.1450; train_gene_expr_recon_loss: 11547943.2443; train_masked_gp_l1_reg_loss: 75864.5555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71156.4457; train_chrom_access_recon_loss: 1993865.7500; train_global_loss: 16463974.6260; train_optim_loss: 16463974.6260; val_kl_reg_loss: 70374.4094; val_edge_recon_loss: 2732568.5000; val_gene_expr_recon_loss: 11622938.6000; val_masked_gp_l1_reg_loss: 75997.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71554.1094; val_chrom_access_recon_loss: 1996193.4750; val_global_loss: 16569626.9333; val_optim_loss: 16569626.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9580; val_auprc_score: 0.9477; val_best_acc_score: 0.8977; val_best_f1_score: 0.9036; train_kl_reg_loss: 68389.5986; train_edge_recon_loss: 2700479.9275; train_gene_expr_recon_loss: 11503702.0458; train_masked_gp_l1_reg_loss: 76181.6745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70955.9030; train_chrom_access_recon_loss: 1986089.6040; train_global_loss: 16405798.6641; train_optim_loss: 16405798.6641; val_kl_reg_loss: 70739.6708; val_edge_recon_loss: 2731194.3000; val_gene_expr_recon_loss: 11541726.4000; val_masked_gp_l1_reg_loss: 76277.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71042.8594; val_chrom_access_recon_loss: 1975641.0083; val_global_loss: 16466622.2000; val_optim_loss: 16466622.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9615; val_auprc_score: 0.9499; val_best_acc_score: 0.9068; val_best_f1_score: 0.9103; train_kl_reg_loss: 68331.3717; train_edge_recon_loss: 2695172.6756; train_gene_expr_recon_loss: 11480185.3511; train_masked_gp_l1_reg_loss: 76486.2274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70723.2683; train_chrom_access_recon_loss: 1981998.4246; train_global_loss: 16372897.3359; train_optim_loss: 16372897.3359; val_kl_reg_loss: 69395.1562; val_edge_recon_loss: 2709159.1500; val_gene_expr_recon_loss: 11474623.8667; val_masked_gp_l1_reg_loss: 76579.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70377.6953; val_chrom_access_recon_loss: 1963857.6083; val_global_loss: 16363992.8000; val_optim_loss: 16363992.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9583; val_auprc_score: 0.9490; val_best_acc_score: 0.8996; val_best_f1_score: 0.9041; train_kl_reg_loss: 67267.9683; train_edge_recon_loss: 2693882.4103; train_gene_expr_recon_loss: 11445812.7328; train_masked_gp_l1_reg_loss: 76652.8972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70301.9872; train_chrom_access_recon_loss: 1972838.5344; train_global_loss: 16326756.5725; train_optim_loss: 16326756.5725; val_kl_reg_loss: 68210.6177; val_edge_recon_loss: 2726134.7500; val_gene_expr_recon_loss: 11451733.2000; val_masked_gp_l1_reg_loss: 76902.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70276.4844; val_chrom_access_recon_loss: 1965561.2417; val_global_loss: 16358817.8667; val_optim_loss: 16358817.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9651; val_auprc_score: 0.9545; val_best_acc_score: 0.9119; val_best_f1_score: 0.9151; train_kl_reg_loss: 67498.9379; train_edge_recon_loss: 2694948.2347; train_gene_expr_recon_loss: 11425710.4580; train_masked_gp_l1_reg_loss: 76808.8079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69938.8314; train_chrom_access_recon_loss: 1970522.0324; train_global_loss: 16305427.4046; train_optim_loss: 16305427.4046; val_kl_reg_loss: 67966.6307; val_edge_recon_loss: 2699136.5667; val_gene_expr_recon_loss: 11491168.8667; val_masked_gp_l1_reg_loss: 76828.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70073.2109; val_chrom_access_recon_loss: 1962164.0083; val_global_loss: 16367338.2000; val_optim_loss: 16367338.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9695; val_auprc_score: 0.9593; val_best_acc_score: 0.9196; val_best_f1_score: 0.9225; train_kl_reg_loss: 66435.8343; train_edge_recon_loss: 2686011.5019; train_gene_expr_recon_loss: 11421931.7023; train_masked_gp_l1_reg_loss: 76900.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69795.6803; train_chrom_access_recon_loss: 1968048.7624; train_global_loss: 16289123.7405; train_optim_loss: 16289123.7405; val_kl_reg_loss: 65842.9263; val_edge_recon_loss: 2686248.3833; val_gene_expr_recon_loss: 11406008.3333; val_masked_gp_l1_reg_loss: 77005.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70006.5859; val_chrom_access_recon_loss: 1947292.9917; val_global_loss: 16252405.8667; val_optim_loss: 16252405.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9685; val_auprc_score: 0.9589; val_best_acc_score: 0.9146; val_best_f1_score: 0.9168; train_kl_reg_loss: 66911.6347; train_edge_recon_loss: 2680915.3053; train_gene_expr_recon_loss: 11383699.6412; train_masked_gp_l1_reg_loss: 77078.7507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69582.8905; train_chrom_access_recon_loss: 1961910.5677; train_global_loss: 16240098.8244; train_optim_loss: 16240098.8244; val_kl_reg_loss: 64899.3422; val_edge_recon_loss: 2694249.7333; val_gene_expr_recon_loss: 11440182.8000; val_masked_gp_l1_reg_loss: 77085.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69571.1953; val_chrom_access_recon_loss: 1959989.7000; val_global_loss: 16305978.6000; val_optim_loss: 16305978.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9682; val_auprc_score: 0.9572; val_best_acc_score: 0.9206; val_best_f1_score: 0.9228; train_kl_reg_loss: 65351.1551; train_edge_recon_loss: 2684906.8511; train_gene_expr_recon_loss: 11366405.2137; train_masked_gp_l1_reg_loss: 77144.4492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69301.9602; train_chrom_access_recon_loss: 1956290.2624; train_global_loss: 16219399.9389; train_optim_loss: 16219399.9389; val_kl_reg_loss: 66330.2273; val_edge_recon_loss: 2693661.5167; val_gene_expr_recon_loss: 11407117.6000; val_masked_gp_l1_reg_loss: 77183.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69447.1250; val_chrom_access_recon_loss: 1954102.8000; val_global_loss: 16267842.1333; val_optim_loss: 16267842.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9686; val_auprc_score: 0.9554; val_best_acc_score: 0.9190; val_best_f1_score: 0.9214; train_kl_reg_loss: 65730.1230; train_edge_recon_loss: 2683964.1794; train_gene_expr_recon_loss: 11341532.5802; train_masked_gp_l1_reg_loss: 77198.0889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69177.4529; train_chrom_access_recon_loss: 1952104.3664; train_global_loss: 16189706.7023; train_optim_loss: 16189706.7023; val_kl_reg_loss: 63945.4589; val_edge_recon_loss: 2693200.0500; val_gene_expr_recon_loss: 11378560.5333; val_masked_gp_l1_reg_loss: 77086.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68831.5625; val_chrom_access_recon_loss: 1940464.5083; val_global_loss: 16222089.6000; val_optim_loss: 16222089.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9635; val_best_acc_score: 0.9224; val_best_f1_score: 0.9249; train_kl_reg_loss: 65000.6342; train_edge_recon_loss: 2682220.5038; train_gene_expr_recon_loss: 11345378.4046; train_masked_gp_l1_reg_loss: 77057.7402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69100.4228; train_chrom_access_recon_loss: 1952191.7109; train_global_loss: 16190949.4122; train_optim_loss: 16190949.4122; val_kl_reg_loss: 65858.8859; val_edge_recon_loss: 2690660.7167; val_gene_expr_recon_loss: 11408159.4000; val_masked_gp_l1_reg_loss: 77042.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69327.1719; val_chrom_access_recon_loss: 1947012.5083; val_global_loss: 16258061.4667; val_optim_loss: 16258061.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9729; val_auprc_score: 0.9663; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 64168.9475; train_edge_recon_loss: 2678426.8740; train_gene_expr_recon_loss: 11310491.0076; train_masked_gp_l1_reg_loss: 77035.5190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69119.9574; train_chrom_access_recon_loss: 1947656.1336; train_global_loss: 16146898.4504; train_optim_loss: 16146898.4504; val_kl_reg_loss: 62315.0544; val_edge_recon_loss: 2693141.0333; val_gene_expr_recon_loss: 11313762.2000; val_masked_gp_l1_reg_loss: 77165.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69307.2109; val_chrom_access_recon_loss: 1931807.4917; val_global_loss: 16147498.6000; val_optim_loss: 16147498.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9703; val_auprc_score: 0.9600; val_best_acc_score: 0.9206; val_best_f1_score: 0.9233; train_kl_reg_loss: 78110.8746; train_edge_recon_loss: 2717919.9561; train_gene_expr_recon_loss: 10402542.1069; train_masked_gp_l1_reg_loss: 76616.2586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66755.7233; train_chrom_access_recon_loss: 1800746.8779; train_global_loss: 15142691.7481; train_optim_loss: 15142691.7481; val_kl_reg_loss: 31413.7630; val_edge_recon_loss: 2698330.3500; val_gene_expr_recon_loss: 10451096.6000; val_masked_gp_l1_reg_loss: 75921.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67774.0625; val_chrom_access_recon_loss: 1784596.7417; val_global_loss: 15109132.4000; val_optim_loss: 15109132.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9692; val_auprc_score: 0.9577; val_best_acc_score: 0.9171; val_best_f1_score: 0.9208; train_kl_reg_loss: 63575.4779; train_edge_recon_loss: 2689716.6889; train_gene_expr_recon_loss: 10372272.6870; train_masked_gp_l1_reg_loss: 74970.8065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68169.2291; train_chrom_access_recon_loss: 1794250.5305; train_global_loss: 15062955.3588; train_optim_loss: 15062955.3588; val_kl_reg_loss: 37352.5169; val_edge_recon_loss: 2689163.7000; val_gene_expr_recon_loss: 10393314.5333; val_masked_gp_l1_reg_loss: 73934.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68790.6719; val_chrom_access_recon_loss: 1779845.7083; val_global_loss: 15042402.6667; val_optim_loss: 15042402.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9740; val_auprc_score: 0.9688; val_best_acc_score: 0.9232; val_best_f1_score: 0.9256; train_kl_reg_loss: 57465.6156; train_edge_recon_loss: 2675367.6660; train_gene_expr_recon_loss: 10358604.4809; train_masked_gp_l1_reg_loss: 72775.7827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68830.8200; train_chrom_access_recon_loss: 1790311.3139; train_global_loss: 15023355.5802; train_optim_loss: 15023355.5802; val_kl_reg_loss: 41411.9849; val_edge_recon_loss: 2689377.1500; val_gene_expr_recon_loss: 10354932.8000; val_masked_gp_l1_reg_loss: 71719.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68847.3203; val_chrom_access_recon_loss: 1770490.2333; val_global_loss: 14996778.2000; val_optim_loss: 14996778.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9715; val_auprc_score: 0.9622; val_best_acc_score: 0.9244; val_best_f1_score: 0.9258; train_kl_reg_loss: 54662.1636; train_edge_recon_loss: 2671682.8454; train_gene_expr_recon_loss: 10332325.4198; train_masked_gp_l1_reg_loss: 70558.2603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68868.9830; train_chrom_access_recon_loss: 1786163.4466; train_global_loss: 14984261.1298; train_optim_loss: 14984261.1298; val_kl_reg_loss: 42342.3573; val_edge_recon_loss: 2686774.3000; val_gene_expr_recon_loss: 10362340.0000; val_masked_gp_l1_reg_loss: 69513.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68691.9375; val_chrom_access_recon_loss: 1770466.3500; val_global_loss: 15000128.0667; val_optim_loss: 15000128.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9734; val_auprc_score: 0.9657; val_best_acc_score: 0.9254; val_best_f1_score: 0.9277; train_kl_reg_loss: 52055.2830; train_edge_recon_loss: 2672175.1698; train_gene_expr_recon_loss: 10319923.2595; train_masked_gp_l1_reg_loss: 68694.6429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68806.9281; train_chrom_access_recon_loss: 1785095.7901; train_global_loss: 14966751.0458; train_optim_loss: 14966751.0458; val_kl_reg_loss: 44251.1570; val_edge_recon_loss: 2686428.7667; val_gene_expr_recon_loss: 10364078.2667; val_masked_gp_l1_reg_loss: 67765.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68919.5469; val_chrom_access_recon_loss: 1771935.0333; val_global_loss: 15003379.2000; val_optim_loss: 15003379.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9734; val_auprc_score: 0.9632; val_best_acc_score: 0.9264; val_best_f1_score: 0.9284; train_kl_reg_loss: 51145.1162; train_edge_recon_loss: 2668265.9046; train_gene_expr_recon_loss: 10316288.8473; train_masked_gp_l1_reg_loss: 66926.8658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68696.9534; train_chrom_access_recon_loss: 1784387.8426; train_global_loss: 14955711.6107; train_optim_loss: 14955711.6107; val_kl_reg_loss: 43373.1026; val_edge_recon_loss: 2671448.6333; val_gene_expr_recon_loss: 10286242.1333; val_masked_gp_l1_reg_loss: 66253.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68874.2812; val_chrom_access_recon_loss: 1758575.1833; val_global_loss: 14894767.0667; val_optim_loss: 14894767.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9736; val_auprc_score: 0.9651; val_best_acc_score: 0.9264; val_best_f1_score: 0.9294; train_kl_reg_loss: 51113.3863; train_edge_recon_loss: 2668083.5267; train_gene_expr_recon_loss: 10307009.6870; train_masked_gp_l1_reg_loss: 65552.4317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68664.8906; train_chrom_access_recon_loss: 1782808.9427; train_global_loss: 14943232.9008; train_optim_loss: 14943232.9008; val_kl_reg_loss: 44381.5799; val_edge_recon_loss: 2679441.7167; val_gene_expr_recon_loss: 10270653.9333; val_masked_gp_l1_reg_loss: 64850.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68753.8047; val_chrom_access_recon_loss: 1762298.4500; val_global_loss: 14890379.6667; val_optim_loss: 14890379.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9743; val_auprc_score: 0.9659; val_best_acc_score: 0.9293; val_best_f1_score: 0.9313; train_kl_reg_loss: 49465.6056; train_edge_recon_loss: 2665587.7099; train_gene_expr_recon_loss: 10292695.9847; train_masked_gp_l1_reg_loss: 64333.3780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68629.8494; train_chrom_access_recon_loss: 1777275.6708; train_global_loss: 14917988.2901; train_optim_loss: 14917988.2901; val_kl_reg_loss: 44840.8060; val_edge_recon_loss: 2673733.4333; val_gene_expr_recon_loss: 10342638.4000; val_masked_gp_l1_reg_loss: 63815.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68506.4609; val_chrom_access_recon_loss: 1764167.9667; val_global_loss: 14957701.6000; val_optim_loss: 14957701.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9768; val_auprc_score: 0.9713; val_best_acc_score: 0.9320; val_best_f1_score: 0.9334; train_kl_reg_loss: 50059.5489; train_edge_recon_loss: 2661272.5668; train_gene_expr_recon_loss: 10293163.3969; train_masked_gp_l1_reg_loss: 63345.8310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68515.9340; train_chrom_access_recon_loss: 1777516.9542; train_global_loss: 14913874.2901; train_optim_loss: 14913874.2901; val_kl_reg_loss: 46670.5437; val_edge_recon_loss: 2673225.0000; val_gene_expr_recon_loss: 10312139.0000; val_masked_gp_l1_reg_loss: 62902.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68583.6719; val_chrom_access_recon_loss: 1765277.5083; val_global_loss: 14928798.1333; val_optim_loss: 14928798.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9750; val_auprc_score: 0.9644; val_best_acc_score: 0.9329; val_best_f1_score: 0.9354; train_kl_reg_loss: 49539.9324; train_edge_recon_loss: 2658682.8569; train_gene_expr_recon_loss: 10274926.8015; train_masked_gp_l1_reg_loss: 62493.7961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68510.5895; train_chrom_access_recon_loss: 1776571.1918; train_global_loss: 14890725.0458; train_optim_loss: 14890725.0458; val_kl_reg_loss: 46886.2086; val_edge_recon_loss: 2676813.7167; val_gene_expr_recon_loss: 10310296.1333; val_masked_gp_l1_reg_loss: 62116.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68774.1250; val_chrom_access_recon_loss: 1761967.1000; val_global_loss: 14926854.1333; val_optim_loss: 14926854.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9757; val_auprc_score: 0.9648; val_best_acc_score: 0.9342; val_best_f1_score: 0.9362; train_kl_reg_loss: 49078.8543; train_edge_recon_loss: 2662546.7424; train_gene_expr_recon_loss: 10253942.0916; train_masked_gp_l1_reg_loss: 61727.7241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68618.6237; train_chrom_access_recon_loss: 1770213.0277; train_global_loss: 14866127.1603; train_optim_loss: 14866127.1603; val_kl_reg_loss: 45449.3315; val_edge_recon_loss: 2683345.5333; val_gene_expr_recon_loss: 10288237.9333; val_masked_gp_l1_reg_loss: 61266.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68346.5000; val_chrom_access_recon_loss: 1758931.0583; val_global_loss: 14905577.4667; val_optim_loss: 14905577.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9784; val_auprc_score: 0.9718; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 50165.0430; train_edge_recon_loss: 2655133.2061; train_gene_expr_recon_loss: 10235635.9084; train_masked_gp_l1_reg_loss: 60790.3371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57451.4607; train_chrom_access_recon_loss: 1767191.2376; train_global_loss: 14826367.2290; train_optim_loss: 14826367.2290; val_kl_reg_loss: 46989.2901; val_edge_recon_loss: 2661662.4000; val_gene_expr_recon_loss: 10255556.4000; val_masked_gp_l1_reg_loss: 60605.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55734.4180; val_chrom_access_recon_loss: 1743350.7667; val_global_loss: 14823898.8000; val_optim_loss: 14823898.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9775; val_auprc_score: 0.9714; val_best_acc_score: 0.9342; val_best_f1_score: 0.9363; train_kl_reg_loss: 51224.5553; train_edge_recon_loss: 2661578.6737; train_gene_expr_recon_loss: 10234392.8092; train_masked_gp_l1_reg_loss: 60533.2980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55338.9479; train_chrom_access_recon_loss: 1765497.9790; train_global_loss: 14828566.3282; train_optim_loss: 14828566.3282; val_kl_reg_loss: 47703.3247; val_edge_recon_loss: 2676917.6833; val_gene_expr_recon_loss: 10221903.6000; val_masked_gp_l1_reg_loss: 60464.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54989.1914; val_chrom_access_recon_loss: 1753046.0750; val_global_loss: 14815023.5333; val_optim_loss: 14815023.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9744; val_auprc_score: 0.9633; val_best_acc_score: 0.9297; val_best_f1_score: 0.9316; train_kl_reg_loss: 51350.4847; train_edge_recon_loss: 2656309.9485; train_gene_expr_recon_loss: 10230840.8550; train_masked_gp_l1_reg_loss: 60406.0145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54767.0022; train_chrom_access_recon_loss: 1764534.5458; train_global_loss: 14818208.8626; train_optim_loss: 14818208.8626; val_kl_reg_loss: 47523.0927; val_edge_recon_loss: 2678458.0500; val_gene_expr_recon_loss: 10246994.4667; val_masked_gp_l1_reg_loss: 60368.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54546.0859; val_chrom_access_recon_loss: 1751180.5500; val_global_loss: 14839070.0667; val_optim_loss: 14839070.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9790; val_auprc_score: 0.9730; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 51428.0258; train_edge_recon_loss: 2650497.9218; train_gene_expr_recon_loss: 10230562.1832; train_masked_gp_l1_reg_loss: 60311.0595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54345.6833; train_chrom_access_recon_loss: 1765311.9647; train_global_loss: 14812456.8397; train_optim_loss: 14812456.8397; val_kl_reg_loss: 47746.1445; val_edge_recon_loss: 2672186.4000; val_gene_expr_recon_loss: 10266799.1333; val_masked_gp_l1_reg_loss: 60270.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54186.3750; val_chrom_access_recon_loss: 1756761.1417; val_global_loss: 14857949.9333; val_optim_loss: 14857949.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9771; val_auprc_score: 0.9688; val_best_acc_score: 0.9333; val_best_f1_score: 0.9346; train_kl_reg_loss: 52204.8345; train_edge_recon_loss: 2653591.2939; train_gene_expr_recon_loss: 10238308.4351; train_masked_gp_l1_reg_loss: 60225.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54005.8944; train_chrom_access_recon_loss: 1767106.4990; train_global_loss: 14825442.4656; train_optim_loss: 14825442.4656; val_kl_reg_loss: 49007.9594; val_edge_recon_loss: 2672467.8833; val_gene_expr_recon_loss: 10248516.8000; val_masked_gp_l1_reg_loss: 60171.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53827.6250; val_chrom_access_recon_loss: 1751613.2583; val_global_loss: 14835605.6667; val_optim_loss: 14835605.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9782; val_auprc_score: 0.9733; val_best_acc_score: 0.9328; val_best_f1_score: 0.9349; train_kl_reg_loss: 52005.2449; train_edge_recon_loss: 2657322.4504; train_gene_expr_recon_loss: 10230154.5344; train_masked_gp_l1_reg_loss: 60134.7207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53697.2698; train_chrom_access_recon_loss: 1764561.5677; train_global_loss: 14817875.7786; train_optim_loss: 14817875.7786; val_kl_reg_loss: 48891.7716; val_edge_recon_loss: 2677994.4333; val_gene_expr_recon_loss: 10253567.5333; val_masked_gp_l1_reg_loss: 60076.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53513.2148; val_chrom_access_recon_loss: 1757476.1500; val_global_loss: 14851519.8667; val_optim_loss: 14851519.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9800; val_auprc_score: 0.9756; val_best_acc_score: 0.9361; val_best_f1_score: 0.9382; train_kl_reg_loss: 52027.5984; train_edge_recon_loss: 2654725.9084; train_gene_expr_recon_loss: 10239574.6870; train_masked_gp_l1_reg_loss: 60031.2745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52394.0498; train_chrom_access_recon_loss: 1767884.8760; train_global_loss: 14826638.3664; train_optim_loss: 14826638.3664; val_kl_reg_loss: 48762.0703; val_edge_recon_loss: 2662954.6333; val_gene_expr_recon_loss: 10277448.8667; val_masked_gp_l1_reg_loss: 60010.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52223.5664; val_chrom_access_recon_loss: 1752287.5167; val_global_loss: 14853687.0000; val_optim_loss: 14853687.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9769; val_auprc_score: 0.9704; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 52093.8439; train_edge_recon_loss: 2660939.3569; train_gene_expr_recon_loss: 10231710.9389; train_masked_gp_l1_reg_loss: 60000.0353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52177.3173; train_chrom_access_recon_loss: 1767804.2395; train_global_loss: 14824725.6947; train_optim_loss: 14824725.6947; val_kl_reg_loss: 48738.6091; val_edge_recon_loss: 2673772.9500; val_gene_expr_recon_loss: 10240736.2667; val_masked_gp_l1_reg_loss: 59991.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52129.8945; val_chrom_access_recon_loss: 1755286.2500; val_global_loss: 14830656.0000; val_optim_loss: 14830656.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9802; val_auprc_score: 0.9745; val_best_acc_score: 0.9380; val_best_f1_score: 0.9394; train_kl_reg_loss: 52034.8972; train_edge_recon_loss: 2649264.5668; train_gene_expr_recon_loss: 10228482.5725; train_masked_gp_l1_reg_loss: 59984.6752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52099.6265; train_chrom_access_recon_loss: 1764658.6393; train_global_loss: 14806524.9313; train_optim_loss: 14806524.9313; val_kl_reg_loss: 48804.6513; val_edge_recon_loss: 2650384.3667; val_gene_expr_recon_loss: 10292531.7333; val_masked_gp_l1_reg_loss: 59976.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52056.2422; val_chrom_access_recon_loss: 1760401.4417; val_global_loss: 14864155.1333; val_optim_loss: 14864155.1333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9752; val_auprc_score: 0.9656; val_best_acc_score: 0.9336; val_best_f1_score: 0.9351; train_kl_reg_loss: 52097.8130; train_edge_recon_loss: 2656435.6698; train_gene_expr_recon_loss: 10234977.9466; train_masked_gp_l1_reg_loss: 59969.4606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52028.0824; train_chrom_access_recon_loss: 1766489.2481; train_global_loss: 14821998.1679; train_optim_loss: 14821998.1679; val_kl_reg_loss: 48863.1737; val_edge_recon_loss: 2689481.3000; val_gene_expr_recon_loss: 10272401.2667; val_masked_gp_l1_reg_loss: 59963.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51999.0430; val_chrom_access_recon_loss: 1763172.9417; val_global_loss: 14885881.6000; val_optim_loss: 14885881.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 57 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9788
val AUPRC score: 0.9725
val best accuracy score: 0.9341
val best F1 score: 0.9363
val target rna MSE score: 1.7057
val source rna MSE score: 0.6003
val target atac MSE score: 0.3343
val source atac MSE score: 0.1039
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
