[True]
Run timestamp: 07092023_143506_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1133 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5654, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7963; val_auprc_score: 0.8036; val_best_acc_score: 0.5407; val_best_f1_score: 0.6838; train_kl_reg_loss: 87129.0343; train_edge_recon_loss: 3539872.4427; train_gene_expr_recon_loss: 16721042.1374; train_masked_gp_l1_reg_loss: 82150.3516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1135538.2753; train_chrom_access_recon_loss: 3953561.1813; train_global_loss: 25519293.5573; train_optim_loss: 25519293.5573; val_kl_reg_loss: 104841.4917; val_edge_recon_loss: 4062878.1833; val_gene_expr_recon_loss: 15707105.2000; val_masked_gp_l1_reg_loss: 74372.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 568425.1250; val_chrom_access_recon_loss: 3846894.4833; val_global_loss: 24364517.3333; val_optim_loss: 24364517.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8329; val_auprc_score: 0.8459; val_best_acc_score: 0.7373; val_best_f1_score: 0.7632; train_kl_reg_loss: 98141.1896; train_edge_recon_loss: 3520354.3015; train_gene_expr_recon_loss: 15561268.1450; train_masked_gp_l1_reg_loss: 73606.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 341061.2834; train_chrom_access_recon_loss: 3790480.4962; train_global_loss: 23384912.1221; train_optim_loss: 23384912.1221; val_kl_reg_loss: 95004.9849; val_edge_recon_loss: 4017076.6000; val_gene_expr_recon_loss: 15429734.6000; val_masked_gp_l1_reg_loss: 75066.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202144.8281; val_chrom_access_recon_loss: 3783979.5833; val_global_loss: 23603005.8667; val_optim_loss: 23603005.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8544; val_auprc_score: 0.8451; val_best_acc_score: 0.7639; val_best_f1_score: 0.7898; train_kl_reg_loss: 76893.9002; train_edge_recon_loss: 3363206.9599; train_gene_expr_recon_loss: 15371917.9008; train_masked_gp_l1_reg_loss: 80499.1232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150015.3078; train_chrom_access_recon_loss: 3749370.3397; train_global_loss: 22791903.4962; train_optim_loss: 22791903.4962; val_kl_reg_loss: 85828.9057; val_edge_recon_loss: 3141145.4667; val_gene_expr_recon_loss: 15244613.2000; val_masked_gp_l1_reg_loss: 87959.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114439.3672; val_chrom_access_recon_loss: 3745892.7333; val_global_loss: 22419880.5333; val_optim_loss: 22419880.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8896; val_auprc_score: 0.8796; val_best_acc_score: 0.7961; val_best_f1_score: 0.8087; train_kl_reg_loss: 101509.4720; train_edge_recon_loss: 2991149.7557; train_gene_expr_recon_loss: 15198773.8321; train_masked_gp_l1_reg_loss: 88548.0243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93637.1411; train_chrom_access_recon_loss: 3707919.9141; train_global_loss: 22181538.0000; train_optim_loss: 22181538.0000; val_kl_reg_loss: 102613.5365; val_edge_recon_loss: 2934804.7500; val_gene_expr_recon_loss: 15045216.4667; val_masked_gp_l1_reg_loss: 90603.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79414.7344; val_chrom_access_recon_loss: 3695636.2667; val_global_loss: 21948288.8000; val_optim_loss: 21948288.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9106; val_auprc_score: 0.8975; val_best_acc_score: 0.8336; val_best_f1_score: 0.8436; train_kl_reg_loss: 101024.3874; train_edge_recon_loss: 2909380.2672; train_gene_expr_recon_loss: 15022855.4198; train_masked_gp_l1_reg_loss: 92499.0810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70612.8640; train_chrom_access_recon_loss: 3671090.6813; train_global_loss: 21867462.6412; train_optim_loss: 21867462.6412; val_kl_reg_loss: 101881.6729; val_edge_recon_loss: 2879736.2500; val_gene_expr_recon_loss: 14925578.0667; val_masked_gp_l1_reg_loss: 94468.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64200.0430; val_chrom_access_recon_loss: 3666900.3833; val_global_loss: 21732764.1333; val_optim_loss: 21732764.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9322; val_auprc_score: 0.9171; val_best_acc_score: 0.8628; val_best_f1_score: 0.8699; train_kl_reg_loss: 101016.6780; train_edge_recon_loss: 2843757.8931; train_gene_expr_recon_loss: 14880889.8168; train_masked_gp_l1_reg_loss: 96374.8724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59374.2403; train_chrom_access_recon_loss: 3637094.7882; train_global_loss: 21618508.3969; train_optim_loss: 21618508.3969; val_kl_reg_loss: 98414.9344; val_edge_recon_loss: 2814770.7500; val_gene_expr_recon_loss: 14840386.7333; val_masked_gp_l1_reg_loss: 98279.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55497.5469; val_chrom_access_recon_loss: 3642683.1000; val_global_loss: 21550033.8667; val_optim_loss: 21550033.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9351; val_auprc_score: 0.9227; val_best_acc_score: 0.8688; val_best_f1_score: 0.8762; train_kl_reg_loss: 100092.3527; train_edge_recon_loss: 2818954.3034; train_gene_expr_recon_loss: 14774438.6183; train_masked_gp_l1_reg_loss: 99956.6536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52993.3696; train_chrom_access_recon_loss: 3611049.2366; train_global_loss: 21457484.6107; train_optim_loss: 21457484.6107; val_kl_reg_loss: 102425.1000; val_edge_recon_loss: 2818845.2833; val_gene_expr_recon_loss: 14656185.1333; val_masked_gp_l1_reg_loss: 101186.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50352.2812; val_chrom_access_recon_loss: 3587512.7000; val_global_loss: 21316506.4000; val_optim_loss: 21316506.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9337; val_auprc_score: 0.9169; val_best_acc_score: 0.8680; val_best_f1_score: 0.8756; train_kl_reg_loss: 99627.0564; train_edge_recon_loss: 2797785.7958; train_gene_expr_recon_loss: 14660566.5267; train_masked_gp_l1_reg_loss: 102535.3083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49051.5494; train_chrom_access_recon_loss: 3581799.0878; train_global_loss: 21291365.4351; train_optim_loss: 21291365.4351; val_kl_reg_loss: 97701.6469; val_edge_recon_loss: 2823192.0833; val_gene_expr_recon_loss: 14615921.3333; val_masked_gp_l1_reg_loss: 103591.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48071.0586; val_chrom_access_recon_loss: 3599210.2167; val_global_loss: 21287689.3333; val_optim_loss: 21287689.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9435; val_auprc_score: 0.9291; val_best_acc_score: 0.8798; val_best_f1_score: 0.8848; train_kl_reg_loss: 96223.8347; train_edge_recon_loss: 2783396.6508; train_gene_expr_recon_loss: 14566429.7710; train_masked_gp_l1_reg_loss: 104883.5963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47173.4941; train_chrom_access_recon_loss: 3556639.6927; train_global_loss: 21154747.0534; train_optim_loss: 21154747.0534; val_kl_reg_loss: 93036.2469; val_edge_recon_loss: 2791079.3333; val_gene_expr_recon_loss: 14559555.0000; val_masked_gp_l1_reg_loss: 106092.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46589.4219; val_chrom_access_recon_loss: 3562839.5000; val_global_loss: 21159191.8667; val_optim_loss: 21159191.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9472; val_auprc_score: 0.9362; val_best_acc_score: 0.8849; val_best_f1_score: 0.8919; train_kl_reg_loss: 93758.4243; train_edge_recon_loss: 2778485.1660; train_gene_expr_recon_loss: 14486476.8550; train_masked_gp_l1_reg_loss: 107007.4690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45787.0082; train_chrom_access_recon_loss: 3538174.6698; train_global_loss: 21049689.6794; train_optim_loss: 21049689.6794; val_kl_reg_loss: 93554.7161; val_edge_recon_loss: 2756789.9000; val_gene_expr_recon_loss: 14422682.2667; val_masked_gp_l1_reg_loss: 108080.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45625.1602; val_chrom_access_recon_loss: 3534926.3667; val_global_loss: 20961659.3333; val_optim_loss: 20961659.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9450; val_auprc_score: 0.9290; val_best_acc_score: 0.8848; val_best_f1_score: 0.8905; train_kl_reg_loss: 92117.4338; train_edge_recon_loss: 2758531.3340; train_gene_expr_recon_loss: 14419370.6947; train_masked_gp_l1_reg_loss: 108907.1367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44915.8280; train_chrom_access_recon_loss: 3522103.0305; train_global_loss: 20945945.4198; train_optim_loss: 20945945.4198; val_kl_reg_loss: 91275.6271; val_edge_recon_loss: 2777459.5167; val_gene_expr_recon_loss: 14353429.3333; val_masked_gp_l1_reg_loss: 109781.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44334.3203; val_chrom_access_recon_loss: 3526323.3833; val_global_loss: 20902603.6000; val_optim_loss: 20902603.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9600; val_auprc_score: 0.9514; val_best_acc_score: 0.9016; val_best_f1_score: 0.9044; train_kl_reg_loss: 89550.0159; train_edge_recon_loss: 2748702.4656; train_gene_expr_recon_loss: 14336472.9695; train_masked_gp_l1_reg_loss: 110539.1959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43811.2423; train_chrom_access_recon_loss: 3498738.5420; train_global_loss: 20827814.4427; train_optim_loss: 20827814.4427; val_kl_reg_loss: 88213.6865; val_edge_recon_loss: 2748490.0667; val_gene_expr_recon_loss: 14317681.4667; val_masked_gp_l1_reg_loss: 111278.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43516.5156; val_chrom_access_recon_loss: 3511932.7333; val_global_loss: 20821112.2667; val_optim_loss: 20821112.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9556; val_auprc_score: 0.9444; val_best_acc_score: 0.8945; val_best_f1_score: 0.8994; train_kl_reg_loss: 89256.1789; train_edge_recon_loss: 2731106.5916; train_gene_expr_recon_loss: 14283311.4351; train_masked_gp_l1_reg_loss: 111882.5331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43092.0398; train_chrom_access_recon_loss: 3484564.5897; train_global_loss: 20743213.1908; train_optim_loss: 20743213.1908; val_kl_reg_loss: 87770.8672; val_edge_recon_loss: 2739738.6000; val_gene_expr_recon_loss: 14310016.6667; val_masked_gp_l1_reg_loss: 112689.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43017.9336; val_chrom_access_recon_loss: 3513787.5667; val_global_loss: 20807021.4667; val_optim_loss: 20807021.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9573; val_auprc_score: 0.9472; val_best_acc_score: 0.9006; val_best_f1_score: 0.9041; train_kl_reg_loss: 86620.1502; train_edge_recon_loss: 2732493.7729; train_gene_expr_recon_loss: 14233060.2443; train_masked_gp_l1_reg_loss: 113314.7294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42495.4039; train_chrom_access_recon_loss: 3470564.0324; train_global_loss: 20678548.0916; train_optim_loss: 20678548.0916; val_kl_reg_loss: 88309.4365; val_edge_recon_loss: 2738742.4500; val_gene_expr_recon_loss: 14163216.4667; val_masked_gp_l1_reg_loss: 113798.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42034.1172; val_chrom_access_recon_loss: 3479204.7000; val_global_loss: 20625305.6000; val_optim_loss: 20625305.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9637; val_auprc_score: 0.9571; val_best_acc_score: 0.9045; val_best_f1_score: 0.9076; train_kl_reg_loss: 86369.7669; train_edge_recon_loss: 2733249.6660; train_gene_expr_recon_loss: 14189198.4809; train_masked_gp_l1_reg_loss: 114369.2644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41793.2151; train_chrom_access_recon_loss: 3458896.5897; train_global_loss: 20623876.9771; train_optim_loss: 20623876.9771; val_kl_reg_loss: 88154.4844; val_edge_recon_loss: 2727947.5667; val_gene_expr_recon_loss: 14143671.8000; val_masked_gp_l1_reg_loss: 114901.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41460.4609; val_chrom_access_recon_loss: 3471058.0167; val_global_loss: 20587193.8667; val_optim_loss: 20587193.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9645; val_auprc_score: 0.9560; val_best_acc_score: 0.9091; val_best_f1_score: 0.9127; train_kl_reg_loss: 86182.0398; train_edge_recon_loss: 2714496.5782; train_gene_expr_recon_loss: 14127859.0687; train_masked_gp_l1_reg_loss: 115257.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41245.1544; train_chrom_access_recon_loss: 3446586.8874; train_global_loss: 20531627.4046; train_optim_loss: 20531627.4046; val_kl_reg_loss: 89086.2172; val_edge_recon_loss: 2737329.1500; val_gene_expr_recon_loss: 14104262.1333; val_masked_gp_l1_reg_loss: 115846.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41495.2969; val_chrom_access_recon_loss: 3458645.5500; val_global_loss: 20546664.2667; val_optim_loss: 20546664.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9641; val_auprc_score: 0.9540; val_best_acc_score: 0.9080; val_best_f1_score: 0.9114; train_kl_reg_loss: 85345.7911; train_edge_recon_loss: 2711623.9618; train_gene_expr_recon_loss: 14094079.5115; train_masked_gp_l1_reg_loss: 116353.6505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40989.0534; train_chrom_access_recon_loss: 3432624.3969; train_global_loss: 20481016.5038; train_optim_loss: 20481016.5038; val_kl_reg_loss: 86173.0172; val_edge_recon_loss: 2730070.7667; val_gene_expr_recon_loss: 14019911.6000; val_masked_gp_l1_reg_loss: 116852.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40764.9766; val_chrom_access_recon_loss: 3443255.5333; val_global_loss: 20437027.7333; val_optim_loss: 20437027.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9687; val_auprc_score: 0.9602; val_best_acc_score: 0.9154; val_best_f1_score: 0.9184; train_kl_reg_loss: 85009.4250; train_edge_recon_loss: 2713240.5057; train_gene_expr_recon_loss: 14065907.4351; train_masked_gp_l1_reg_loss: 117208.6191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40584.7469; train_chrom_access_recon_loss: 3424406.9065; train_global_loss: 20446357.5115; train_optim_loss: 20446357.5115; val_kl_reg_loss: 85398.7250; val_edge_recon_loss: 2714312.9833; val_gene_expr_recon_loss: 14046319.9333; val_masked_gp_l1_reg_loss: 117642.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40521.1406; val_chrom_access_recon_loss: 3428197.2500; val_global_loss: 20432392.6667; val_optim_loss: 20432392.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9692; val_auprc_score: 0.9583; val_best_acc_score: 0.9162; val_best_f1_score: 0.9189; train_kl_reg_loss: 83838.3107; train_edge_recon_loss: 2702149.0973; train_gene_expr_recon_loss: 14021450.5878; train_masked_gp_l1_reg_loss: 118043.8356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40398.4302; train_chrom_access_recon_loss: 3413425.4924; train_global_loss: 20379305.8779; train_optim_loss: 20379305.8779; val_kl_reg_loss: 83689.4344; val_edge_recon_loss: 2717814.1333; val_gene_expr_recon_loss: 13994810.8000; val_masked_gp_l1_reg_loss: 118278.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40265.6250; val_chrom_access_recon_loss: 3425957.8000; val_global_loss: 20380816.5333; val_optim_loss: 20380816.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9713; val_auprc_score: 0.9611; val_best_acc_score: 0.9251; val_best_f1_score: 0.9271; train_kl_reg_loss: 82533.7404; train_edge_recon_loss: 2699488.3206; train_gene_expr_recon_loss: 13985786.9771; train_masked_gp_l1_reg_loss: 118833.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40090.8007; train_chrom_access_recon_loss: 3403145.5095; train_global_loss: 20329878.5802; train_optim_loss: 20329878.5802; val_kl_reg_loss: 83753.1016; val_edge_recon_loss: 2686165.5833; val_gene_expr_recon_loss: 14023034.2667; val_masked_gp_l1_reg_loss: 119207.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39951.0625; val_chrom_access_recon_loss: 3434953.0333; val_global_loss: 20387065.0667; val_optim_loss: 20387065.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9732; val_auprc_score: 0.9629; val_best_acc_score: 0.9229; val_best_f1_score: 0.9266; train_kl_reg_loss: 82696.9492; train_edge_recon_loss: 2694767.2214; train_gene_expr_recon_loss: 13959510.6489; train_masked_gp_l1_reg_loss: 119578.3724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39901.1185; train_chrom_access_recon_loss: 3394686.4218; train_global_loss: 20291140.7328; train_optim_loss: 20291140.7328; val_kl_reg_loss: 82820.0026; val_edge_recon_loss: 2696824.7167; val_gene_expr_recon_loss: 13984299.2000; val_masked_gp_l1_reg_loss: 120016.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40361.2930; val_chrom_access_recon_loss: 3416426.6000; val_global_loss: 20340748.2667; val_optim_loss: 20340748.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9699; val_auprc_score: 0.9590; val_best_acc_score: 0.9268; val_best_f1_score: 0.9292; train_kl_reg_loss: 82038.8117; train_edge_recon_loss: 2695977.1737; train_gene_expr_recon_loss: 13927937.0229; train_masked_gp_l1_reg_loss: 120230.5336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39772.4377; train_chrom_access_recon_loss: 3389896.9065; train_global_loss: 20255852.8855; train_optim_loss: 20255852.8855; val_kl_reg_loss: 83035.1938; val_edge_recon_loss: 2693038.2667; val_gene_expr_recon_loss: 13877433.9333; val_masked_gp_l1_reg_loss: 120781.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40096.6367; val_chrom_access_recon_loss: 3409044.1667; val_global_loss: 20223430.1333; val_optim_loss: 20223430.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9757; val_auprc_score: 0.9692; val_best_acc_score: 0.9313; val_best_f1_score: 0.9331; train_kl_reg_loss: 81000.9737; train_edge_recon_loss: 2696871.2595; train_gene_expr_recon_loss: 13894756.5267; train_masked_gp_l1_reg_loss: 120992.5153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39701.5205; train_chrom_access_recon_loss: 3381384.2710; train_global_loss: 20214706.9466; train_optim_loss: 20214706.9466; val_kl_reg_loss: 79178.8490; val_edge_recon_loss: 2691836.2500; val_gene_expr_recon_loss: 13889916.0667; val_masked_gp_l1_reg_loss: 121061.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39369.0625; val_chrom_access_recon_loss: 3393607.1833; val_global_loss: 20214969.6000; val_optim_loss: 20214969.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9755; val_auprc_score: 0.9670; val_best_acc_score: 0.9295; val_best_f1_score: 0.9322; train_kl_reg_loss: 81087.1537; train_edge_recon_loss: 2693139.0573; train_gene_expr_recon_loss: 13867150.7405; train_masked_gp_l1_reg_loss: 121517.5781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39525.3456; train_chrom_access_recon_loss: 3372995.4924; train_global_loss: 20175415.4504; train_optim_loss: 20175415.4504; val_kl_reg_loss: 81392.0370; val_edge_recon_loss: 2695909.6667; val_gene_expr_recon_loss: 13878647.7333; val_masked_gp_l1_reg_loss: 121969.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39461.5547; val_chrom_access_recon_loss: 3390939.3833; val_global_loss: 20208320.4000; val_optim_loss: 20208320.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9737; val_auprc_score: 0.9664; val_best_acc_score: 0.9239; val_best_f1_score: 0.9261; train_kl_reg_loss: 80617.2511; train_edge_recon_loss: 2695562.5229; train_gene_expr_recon_loss: 13848934.4656; train_masked_gp_l1_reg_loss: 122142.7639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39506.6823; train_chrom_access_recon_loss: 3365584.6927; train_global_loss: 20152348.3969; train_optim_loss: 20152348.3969; val_kl_reg_loss: 81973.6292; val_edge_recon_loss: 2701316.1000; val_gene_expr_recon_loss: 13858654.3333; val_masked_gp_l1_reg_loss: 122417.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39296.7891; val_chrom_access_recon_loss: 3383294.8667; val_global_loss: 20186952.9333; val_optim_loss: 20186952.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9727; val_auprc_score: 0.9619; val_best_acc_score: 0.9291; val_best_f1_score: 0.9319; train_kl_reg_loss: 84667.7969; train_edge_recon_loss: 2711915.3607; train_gene_expr_recon_loss: 13587111.7634; train_masked_gp_l1_reg_loss: 120525.5040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35086.1815; train_chrom_access_recon_loss: 3323322.6851; train_global_loss: 19862629.2366; train_optim_loss: 19862629.2366; val_kl_reg_loss: 62535.5938; val_edge_recon_loss: 2719259.1833; val_gene_expr_recon_loss: 13549841.1333; val_masked_gp_l1_reg_loss: 120294.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34564.9766; val_chrom_access_recon_loss: 3323233.2833; val_global_loss: 19809728.8000; val_optim_loss: 19809728.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9769; val_auprc_score: 0.9705; val_best_acc_score: 0.9286; val_best_f1_score: 0.9308; train_kl_reg_loss: 82669.1627; train_edge_recon_loss: 2688789.0000; train_gene_expr_recon_loss: 13552199.2366; train_masked_gp_l1_reg_loss: 120244.1017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34536.4733; train_chrom_access_recon_loss: 3307577.2844; train_global_loss: 19786015.2519; train_optim_loss: 19786015.2519; val_kl_reg_loss: 65965.2521; val_edge_recon_loss: 2703127.5833; val_gene_expr_recon_loss: 13522903.0667; val_masked_gp_l1_reg_loss: 120427.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34550.7734; val_chrom_access_recon_loss: 3317014.5667; val_global_loss: 19763988.5333; val_optim_loss: 19763988.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9759; val_auprc_score: 0.9666; val_best_acc_score: 0.9334; val_best_f1_score: 0.9353; train_kl_reg_loss: 79374.8340; train_edge_recon_loss: 2692617.1450; train_gene_expr_recon_loss: 13526690.2672; train_masked_gp_l1_reg_loss: 120241.5780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34457.0226; train_chrom_access_recon_loss: 3301221.1221; train_global_loss: 19754601.8931; train_optim_loss: 19754601.8931; val_kl_reg_loss: 67585.9049; val_edge_recon_loss: 2702950.2500; val_gene_expr_recon_loss: 13516946.2667; val_masked_gp_l1_reg_loss: 120192.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34386.5664; val_chrom_access_recon_loss: 3299475.7167; val_global_loss: 19741537.0667; val_optim_loss: 19741537.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9814; val_auprc_score: 0.9747; val_best_acc_score: 0.9407; val_best_f1_score: 0.9423; train_kl_reg_loss: 76583.3789; train_edge_recon_loss: 2684693.2176; train_gene_expr_recon_loss: 13503736.1450; train_masked_gp_l1_reg_loss: 120028.0964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34347.0224; train_chrom_access_recon_loss: 3293119.7844; train_global_loss: 19712507.5878; train_optim_loss: 19712507.5878; val_kl_reg_loss: 69567.5109; val_edge_recon_loss: 2667463.8333; val_gene_expr_recon_loss: 13512679.4000; val_masked_gp_l1_reg_loss: 120013.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34406.5508; val_chrom_access_recon_loss: 3306079.7500; val_global_loss: 19710210.5333; val_optim_loss: 19710210.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9779; val_auprc_score: 0.9728; val_best_acc_score: 0.9320; val_best_f1_score: 0.9339; train_kl_reg_loss: 75638.1371; train_edge_recon_loss: 2684292.6813; train_gene_expr_recon_loss: 13478992.6260; train_masked_gp_l1_reg_loss: 119922.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34273.4536; train_chrom_access_recon_loss: 3287012.8435; train_global_loss: 19680132.3664; train_optim_loss: 19680132.3664; val_kl_reg_loss: 68376.1417; val_edge_recon_loss: 2708466.3833; val_gene_expr_recon_loss: 13500470.8667; val_masked_gp_l1_reg_loss: 119723.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34132.9180; val_chrom_access_recon_loss: 3297448.6500; val_global_loss: 19728618.1333; val_optim_loss: 19728618.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9815; val_auprc_score: 0.9768; val_best_acc_score: 0.9400; val_best_f1_score: 0.9422; train_kl_reg_loss: 74194.0016; train_edge_recon_loss: 2683658.1698; train_gene_expr_recon_loss: 13473994.1145; train_masked_gp_l1_reg_loss: 119698.0927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34099.4438; train_chrom_access_recon_loss: 3286060.3130; train_global_loss: 19671704.1374; train_optim_loss: 19671704.1374; val_kl_reg_loss: 70502.8104; val_edge_recon_loss: 2668437.7667; val_gene_expr_recon_loss: 13432662.2667; val_masked_gp_l1_reg_loss: 119589.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33978.0625; val_chrom_access_recon_loss: 3279185.3167; val_global_loss: 19604355.6000; val_optim_loss: 19604355.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9807; val_auprc_score: 0.9717; val_best_acc_score: 0.9407; val_best_f1_score: 0.9424; train_kl_reg_loss: 73401.2321; train_edge_recon_loss: 2681715.2901; train_gene_expr_recon_loss: 13432026.4351; train_masked_gp_l1_reg_loss: 119500.5629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33931.1007; train_chrom_access_recon_loss: 3272968.5630; train_global_loss: 19613543.1450; train_optim_loss: 19613543.1450; val_kl_reg_loss: 70601.7443; val_edge_recon_loss: 2681014.4667; val_gene_expr_recon_loss: 13394814.6000; val_masked_gp_l1_reg_loss: 119491.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33845.7031; val_chrom_access_recon_loss: 3275349.5000; val_global_loss: 19575116.9333; val_optim_loss: 19575116.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9805; val_auprc_score: 0.9747; val_best_acc_score: 0.9390; val_best_f1_score: 0.9405; train_kl_reg_loss: 72240.4566; train_edge_recon_loss: 2677315.5248; train_gene_expr_recon_loss: 13426829.2672; train_masked_gp_l1_reg_loss: 119429.1598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33776.2617; train_chrom_access_recon_loss: 3269844.9599; train_global_loss: 19599435.5878; train_optim_loss: 19599435.5878; val_kl_reg_loss: 68141.4901; val_edge_recon_loss: 2691796.4833; val_gene_expr_recon_loss: 13433078.3333; val_masked_gp_l1_reg_loss: 119454.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33702.8086; val_chrom_access_recon_loss: 3273547.9667; val_global_loss: 19619722.0000; val_optim_loss: 19619722.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9805; val_auprc_score: 0.9718; val_best_acc_score: 0.9396; val_best_f1_score: 0.9416; train_kl_reg_loss: 72331.8471; train_edge_recon_loss: 2676857.1031; train_gene_expr_recon_loss: 13403078.4809; train_masked_gp_l1_reg_loss: 119471.4893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33619.7354; train_chrom_access_recon_loss: 3260928.9542; train_global_loss: 19566287.5725; train_optim_loss: 19566287.5725; val_kl_reg_loss: 70074.0479; val_edge_recon_loss: 2671228.0000; val_gene_expr_recon_loss: 13386018.2000; val_masked_gp_l1_reg_loss: 119390.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33518.2109; val_chrom_access_recon_loss: 3268551.5500; val_global_loss: 19548780.6667; val_optim_loss: 19548780.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9812; val_auprc_score: 0.9763; val_best_acc_score: 0.9410; val_best_f1_score: 0.9428; train_kl_reg_loss: 72679.7021; train_edge_recon_loss: 2673496.7500; train_gene_expr_recon_loss: 13394405.8855; train_masked_gp_l1_reg_loss: 119345.5627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33450.9848; train_chrom_access_recon_loss: 3260137.0916; train_global_loss: 19553516.0153; train_optim_loss: 19553516.0153; val_kl_reg_loss: 70208.0880; val_edge_recon_loss: 2684489.1000; val_gene_expr_recon_loss: 13377266.6000; val_masked_gp_l1_reg_loss: 119306.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33396.1562; val_chrom_access_recon_loss: 3267508.5667; val_global_loss: 19552174.5333; val_optim_loss: 19552174.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9825; val_auprc_score: 0.9780; val_best_acc_score: 0.9421; val_best_f1_score: 0.9434; train_kl_reg_loss: 71292.4447; train_edge_recon_loss: 2675842.9065; train_gene_expr_recon_loss: 13386770.5267; train_masked_gp_l1_reg_loss: 119258.2177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33312.3231; train_chrom_access_recon_loss: 3257377.5515; train_global_loss: 19543854.0000; train_optim_loss: 19543854.0000; val_kl_reg_loss: 70227.7677; val_edge_recon_loss: 2669975.0333; val_gene_expr_recon_loss: 13407801.6667; val_masked_gp_l1_reg_loss: 119257.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33236.2930; val_chrom_access_recon_loss: 3269359.7667; val_global_loss: 19569858.1333; val_optim_loss: 19569858.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9820; val_auprc_score: 0.9755; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 71373.4269; train_edge_recon_loss: 2670859.2500; train_gene_expr_recon_loss: 13381094.7634; train_masked_gp_l1_reg_loss: 119208.3874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33198.9358; train_chrom_access_recon_loss: 3250743.8206; train_global_loss: 19526478.6107; train_optim_loss: 19526478.6107; val_kl_reg_loss: 70242.8219; val_edge_recon_loss: 2679767.4333; val_gene_expr_recon_loss: 13396220.4000; val_masked_gp_l1_reg_loss: 119218.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33133.3789; val_chrom_access_recon_loss: 3261884.7000; val_global_loss: 19560467.3333; val_optim_loss: 19560467.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9824; val_auprc_score: 0.9756; val_best_acc_score: 0.9427; val_best_f1_score: 0.9440; train_kl_reg_loss: 71365.0160; train_edge_recon_loss: 2671567.8092; train_gene_expr_recon_loss: 13359955.8779; train_masked_gp_l1_reg_loss: 119159.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33083.1551; train_chrom_access_recon_loss: 3247393.8989; train_global_loss: 19502525.0687; train_optim_loss: 19502525.0687; val_kl_reg_loss: 68480.8286; val_edge_recon_loss: 2686639.3833; val_gene_expr_recon_loss: 13401081.6000; val_masked_gp_l1_reg_loss: 119089.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32990.9375; val_chrom_access_recon_loss: 3260521.2500; val_global_loss: 19568803.0667; val_optim_loss: 19568803.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9836; val_auprc_score: 0.9777; val_best_acc_score: 0.9450; val_best_f1_score: 0.9460; train_kl_reg_loss: 71535.8599; train_edge_recon_loss: 2673177.2443; train_gene_expr_recon_loss: 13328918.0916; train_masked_gp_l1_reg_loss: 117669.5558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29424.2066; train_chrom_access_recon_loss: 3241859.8492; train_global_loss: 19462584.7023; train_optim_loss: 19462584.7023; val_kl_reg_loss: 71148.8552; val_edge_recon_loss: 2674090.9667; val_gene_expr_recon_loss: 13384890.3333; val_masked_gp_l1_reg_loss: 117129.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28753.9238; val_chrom_access_recon_loss: 3263466.5500; val_global_loss: 19539479.7333; val_optim_loss: 19539479.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9853; val_auprc_score: 0.9790; val_best_acc_score: 0.9495; val_best_f1_score: 0.9505; train_kl_reg_loss: 72005.6102; train_edge_recon_loss: 2667995.0916; train_gene_expr_recon_loss: 13332897.9924; train_masked_gp_l1_reg_loss: 116976.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28552.4963; train_chrom_access_recon_loss: 3241907.9790; train_global_loss: 19460335.2824; train_optim_loss: 19460335.2824; val_kl_reg_loss: 72485.9682; val_edge_recon_loss: 2672543.6833; val_gene_expr_recon_loss: 13383729.1333; val_masked_gp_l1_reg_loss: 116883.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28362.4512; val_chrom_access_recon_loss: 3249355.8167; val_global_loss: 19523360.0000; val_optim_loss: 19523360.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9823; val_auprc_score: 0.9765; val_best_acc_score: 0.9454; val_best_f1_score: 0.9463; train_kl_reg_loss: 72933.8514; train_edge_recon_loss: 2666700.7424; train_gene_expr_recon_loss: 13330780.2672; train_masked_gp_l1_reg_loss: 116801.9698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28250.4766; train_chrom_access_recon_loss: 3242870.9924; train_global_loss: 19458338.3359; train_optim_loss: 19458338.3359; val_kl_reg_loss: 71977.9438; val_edge_recon_loss: 2693783.0167; val_gene_expr_recon_loss: 13377785.6667; val_masked_gp_l1_reg_loss: 116753.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28128.4277; val_chrom_access_recon_loss: 3262045.8000; val_global_loss: 19550474.5333; val_optim_loss: 19550474.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9828; val_auprc_score: 0.9773; val_best_acc_score: 0.9445; val_best_f1_score: 0.9455; train_kl_reg_loss: 72950.8539; train_edge_recon_loss: 2669958.7214; train_gene_expr_recon_loss: 13326417.5496; train_masked_gp_l1_reg_loss: 116692.7173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28022.8600; train_chrom_access_recon_loss: 3242999.9408; train_global_loss: 19457042.5802; train_optim_loss: 19457042.5802; val_kl_reg_loss: 73012.9583; val_edge_recon_loss: 2686050.4167; val_gene_expr_recon_loss: 13323245.6000; val_masked_gp_l1_reg_loss: 116670.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27935.7969; val_chrom_access_recon_loss: 3243369.5167; val_global_loss: 19470285.6000; val_optim_loss: 19470285.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9824; val_auprc_score: 0.9777; val_best_acc_score: 0.9448; val_best_f1_score: 0.9463; train_kl_reg_loss: 72968.4274; train_edge_recon_loss: 2673951.3531; train_gene_expr_recon_loss: 13330329.2748; train_masked_gp_l1_reg_loss: 116644.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27861.7257; train_chrom_access_recon_loss: 3243306.0973; train_global_loss: 19465060.9008; train_optim_loss: 19465060.9008; val_kl_reg_loss: 71989.6938; val_edge_recon_loss: 2693076.5833; val_gene_expr_recon_loss: 13321099.2000; val_masked_gp_l1_reg_loss: 116620.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27780.2695; val_chrom_access_recon_loss: 3256141.7000; val_global_loss: 19486707.3333; val_optim_loss: 19486707.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9861; val_auprc_score: 0.9804; val_best_acc_score: 0.9497; val_best_f1_score: 0.9508; train_kl_reg_loss: 72890.1357; train_edge_recon_loss: 2666068.3874; train_gene_expr_recon_loss: 13322894.2519; train_masked_gp_l1_reg_loss: 116603.7983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27716.2214; train_chrom_access_recon_loss: 3244198.9065; train_global_loss: 19450371.6336; train_optim_loss: 19450371.6336; val_kl_reg_loss: 72615.5271; val_edge_recon_loss: 2675690.8667; val_gene_expr_recon_loss: 13337973.5333; val_masked_gp_l1_reg_loss: 116580.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27639.8965; val_chrom_access_recon_loss: 3262663.0167; val_global_loss: 19493162.6667; val_optim_loss: 19493162.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9854; val_auprc_score: 0.9816; val_best_acc_score: 0.9475; val_best_f1_score: 0.9490; train_kl_reg_loss: 73142.2072; train_edge_recon_loss: 2664288.7385; train_gene_expr_recon_loss: 13327459.7023; train_masked_gp_l1_reg_loss: 116570.8093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27588.4755; train_chrom_access_recon_loss: 3243638.3492; train_global_loss: 19452688.2137; train_optim_loss: 19452688.2137; val_kl_reg_loss: 72633.3807; val_edge_recon_loss: 2667992.5833; val_gene_expr_recon_loss: 13317908.3333; val_masked_gp_l1_reg_loss: 116539.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27489.2461; val_chrom_access_recon_loss: 3255022.2333; val_global_loss: 19457584.5333; val_optim_loss: 19457584.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9842; val_auprc_score: 0.9779; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 72696.9292; train_edge_recon_loss: 2666985.8378; train_gene_expr_recon_loss: 13321787.8397; train_masked_gp_l1_reg_loss: 116534.3593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27440.7292; train_chrom_access_recon_loss: 3241460.7691; train_global_loss: 19446906.4427; train_optim_loss: 19446906.4427; val_kl_reg_loss: 71876.7437; val_edge_recon_loss: 2669941.7667; val_gene_expr_recon_loss: 13344263.6000; val_masked_gp_l1_reg_loss: 116526.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27380.3711; val_chrom_access_recon_loss: 3255638.6000; val_global_loss: 19485626.6667; val_optim_loss: 19485626.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9843; val_auprc_score: 0.9808; val_best_acc_score: 0.9465; val_best_f1_score: 0.9482; train_kl_reg_loss: 72485.9414; train_edge_recon_loss: 2658409.1088; train_gene_expr_recon_loss: 13311389.2748; train_masked_gp_l1_reg_loss: 116519.2649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27334.6459; train_chrom_access_recon_loss: 3240269.5191; train_global_loss: 19426407.7557; train_optim_loss: 19426407.7557; val_kl_reg_loss: 71826.8344; val_edge_recon_loss: 2674706.1667; val_gene_expr_recon_loss: 13349799.5333; val_masked_gp_l1_reg_loss: 116510.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27264.1230; val_chrom_access_recon_loss: 3256697.1667; val_global_loss: 19496804.5333; val_optim_loss: 19496804.5333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9846; val_auprc_score: 0.9808; val_best_acc_score: 0.9477; val_best_f1_score: 0.9490; train_kl_reg_loss: 72750.4108; train_edge_recon_loss: 2665718.3950; train_gene_expr_recon_loss: 13319187.6107; train_masked_gp_l1_reg_loss: 116500.3706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27233.8935; train_chrom_access_recon_loss: 3240827.7156; train_global_loss: 19442218.3664; train_optim_loss: 19442218.3664; val_kl_reg_loss: 72462.6776; val_edge_recon_loss: 2671053.2833; val_gene_expr_recon_loss: 13363074.4000; val_masked_gp_l1_reg_loss: 116478.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27159.6914; val_chrom_access_recon_loss: 3249066.0833; val_global_loss: 19499295.4667; val_optim_loss: 19499295.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9853; val_auprc_score: 0.9799; val_best_acc_score: 0.9493; val_best_f1_score: 0.9509; train_kl_reg_loss: 72460.2657; train_edge_recon_loss: 2667838.6546; train_gene_expr_recon_loss: 13309420.9160; train_masked_gp_l1_reg_loss: 116487.2077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27102.1835; train_chrom_access_recon_loss: 3241076.4752; train_global_loss: 19434385.6794; train_optim_loss: 19434385.6794; val_kl_reg_loss: 71485.3401; val_edge_recon_loss: 2668250.0833; val_gene_expr_recon_loss: 13372609.6667; val_masked_gp_l1_reg_loss: 116467.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27042.6387; val_chrom_access_recon_loss: 3269669.7333; val_global_loss: 19525525.6000; val_optim_loss: 19525525.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9826; val_auprc_score: 0.9767; val_best_acc_score: 0.9464; val_best_f1_score: 0.9477; train_kl_reg_loss: 72246.5525; train_edge_recon_loss: 2664219.0153; train_gene_expr_recon_loss: 13304360.8092; train_masked_gp_l1_reg_loss: 116314.0109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26667.1817; train_chrom_access_recon_loss: 3240479.6756; train_global_loss: 19424287.2824; train_optim_loss: 19424287.2824; val_kl_reg_loss: 72103.3875; val_edge_recon_loss: 2685627.4167; val_gene_expr_recon_loss: 13344913.0000; val_masked_gp_l1_reg_loss: 116248.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26607.9414; val_chrom_access_recon_loss: 3255399.9833; val_global_loss: 19500899.7333; val_optim_loss: 19500899.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9840; val_auprc_score: 0.9787; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 72534.8969; train_edge_recon_loss: 2664017.3607; train_gene_expr_recon_loss: 13306852.3206; train_masked_gp_l1_reg_loss: 116225.8393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26587.7801; train_chrom_access_recon_loss: 3239169.2653; train_global_loss: 19425387.4046; train_optim_loss: 19425387.4046; val_kl_reg_loss: 72289.5339; val_edge_recon_loss: 2671390.3500; val_gene_expr_recon_loss: 13380514.9333; val_masked_gp_l1_reg_loss: 116205.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26566.3145; val_chrom_access_recon_loss: 3265737.8667; val_global_loss: 19532704.9333; val_optim_loss: 19532704.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9837; val_auprc_score: 0.9773; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 72611.5459; train_edge_recon_loss: 2662906.1240; train_gene_expr_recon_loss: 13300521.3511; train_masked_gp_l1_reg_loss: 116194.0918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26550.7747; train_chrom_access_recon_loss: 3238130.7805; train_global_loss: 19416914.6870; train_optim_loss: 19416914.6870; val_kl_reg_loss: 72488.3516; val_edge_recon_loss: 2668944.7500; val_gene_expr_recon_loss: 13340174.0667; val_masked_gp_l1_reg_loss: 116180.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26533.6816; val_chrom_access_recon_loss: 3251584.9500; val_global_loss: 19475906.9333; val_optim_loss: 19475906.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9859; val_auprc_score: 0.9823; val_best_acc_score: 0.9496; val_best_f1_score: 0.9507; train_kl_reg_loss: 72753.1546; train_edge_recon_loss: 2666885.3053; train_gene_expr_recon_loss: 13311686.7328; train_masked_gp_l1_reg_loss: 116173.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26520.8692; train_chrom_access_recon_loss: 3243401.9866; train_global_loss: 19437421.3740; train_optim_loss: 19437421.3740; val_kl_reg_loss: 72390.8797; val_edge_recon_loss: 2666168.2833; val_gene_expr_recon_loss: 13317824.8667; val_masked_gp_l1_reg_loss: 116164.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26506.2949; val_chrom_access_recon_loss: 3249512.6500; val_global_loss: 19448567.6000; val_optim_loss: 19448567.6000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9851; val_auprc_score: 0.9777; val_best_acc_score: 0.9492; val_best_f1_score: 0.9504; train_kl_reg_loss: 72671.8210; train_edge_recon_loss: 2657799.1947; train_gene_expr_recon_loss: 13305541.2214; train_masked_gp_l1_reg_loss: 116161.1313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26497.1891; train_chrom_access_recon_loss: 3239437.1031; train_global_loss: 19418107.6641; train_optim_loss: 19418107.6641; val_kl_reg_loss: 72487.4005; val_edge_recon_loss: 2672335.4500; val_gene_expr_recon_loss: 13398096.8667; val_masked_gp_l1_reg_loss: 116152.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26483.9570; val_chrom_access_recon_loss: 3287624.9333; val_global_loss: 19573181.2000; val_optim_loss: 19573181.2000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9849; val_auprc_score: 0.9779; val_best_acc_score: 0.9492; val_best_f1_score: 0.9499; train_kl_reg_loss: 72828.5523; train_edge_recon_loss: 2667789.5229; train_gene_expr_recon_loss: 13303222.4504; train_masked_gp_l1_reg_loss: 116149.4970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26475.8949; train_chrom_access_recon_loss: 3237862.0553; train_global_loss: 19424328.0153; train_optim_loss: 19424328.0153; val_kl_reg_loss: 72655.9240; val_edge_recon_loss: 2683211.4833; val_gene_expr_recon_loss: 13365382.7333; val_masked_gp_l1_reg_loss: 116141.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26464.5078; val_chrom_access_recon_loss: 3260236.3333; val_global_loss: 19524093.3333; val_optim_loss: 19524093.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9830; val_auprc_score: 0.9783; val_best_acc_score: 0.9460; val_best_f1_score: 0.9477; train_kl_reg_loss: 72632.8241; train_edge_recon_loss: 2665801.2290; train_gene_expr_recon_loss: 13302453.5878; train_masked_gp_l1_reg_loss: 116139.4406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26456.1768; train_chrom_access_recon_loss: 3238386.2882; train_global_loss: 19421869.6031; train_optim_loss: 19421869.6031; val_kl_reg_loss: 72157.1365; val_edge_recon_loss: 2666316.1167; val_gene_expr_recon_loss: 13332361.4667; val_masked_gp_l1_reg_loss: 116135.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26444.8340; val_chrom_access_recon_loss: 3259725.7667; val_global_loss: 19473141.6000; val_optim_loss: 19473141.6000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9867; val_auprc_score: 0.9817; val_best_acc_score: 0.9506; val_best_f1_score: 0.9516; train_kl_reg_loss: 72551.0917; train_edge_recon_loss: 2665753.7748; train_gene_expr_recon_loss: 13302541.5191; train_masked_gp_l1_reg_loss: 116131.6411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26437.9671; train_chrom_access_recon_loss: 3240542.8912; train_global_loss: 19423958.9008; train_optim_loss: 19423958.9008; val_kl_reg_loss: 72302.0099; val_edge_recon_loss: 2666004.4833; val_gene_expr_recon_loss: 13358292.6667; val_masked_gp_l1_reg_loss: 116126.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26428.3438; val_chrom_access_recon_loss: 3264069.1667; val_global_loss: 19503223.4667; val_optim_loss: 19503223.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9852; val_auprc_score: 0.9811; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 72579.2787; train_edge_recon_loss: 2664465.2290; train_gene_expr_recon_loss: 13301052.7481; train_masked_gp_l1_reg_loss: 116111.8439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26391.1606; train_chrom_access_recon_loss: 3239245.4771; train_global_loss: 19419845.6031; train_optim_loss: 19419845.6031; val_kl_reg_loss: 72660.5443; val_edge_recon_loss: 2676819.7167; val_gene_expr_recon_loss: 13384921.8000; val_masked_gp_l1_reg_loss: 116105.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26385.3027; val_chrom_access_recon_loss: 3254836.6500; val_global_loss: 19531729.2000; val_optim_loss: 19531729.2000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9838; val_auprc_score: 0.9779; val_best_acc_score: 0.9448; val_best_f1_score: 0.9467; train_kl_reg_loss: 72577.1441; train_edge_recon_loss: 2663790.9046; train_gene_expr_recon_loss: 13302161.5420; train_masked_gp_l1_reg_loss: 116102.8466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26383.1833; train_chrom_access_recon_loss: 3238188.7156; train_global_loss: 19419204.2901; train_optim_loss: 19419204.2901; val_kl_reg_loss: 72451.6849; val_edge_recon_loss: 2678791.8500; val_gene_expr_recon_loss: 13325550.8667; val_masked_gp_l1_reg_loss: 116100.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26381.2441; val_chrom_access_recon_loss: 3251093.3333; val_global_loss: 19470369.0667; val_optim_loss: 19470369.0667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9857; val_auprc_score: 0.9819; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 72619.3377; train_edge_recon_loss: 2663986.6202; train_gene_expr_recon_loss: 13310939.0534; train_masked_gp_l1_reg_loss: 116098.4485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26379.8655; train_chrom_access_recon_loss: 3240403.1546; train_global_loss: 19430426.5649; train_optim_loss: 19430426.5649; val_kl_reg_loss: 72868.6865; val_edge_recon_loss: 2677172.4333; val_gene_expr_recon_loss: 13318921.0667; val_masked_gp_l1_reg_loss: 116097.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26378.1953; val_chrom_access_recon_loss: 3251170.1500; val_global_loss: 19462607.4667; val_optim_loss: 19462607.4667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9858; val_auprc_score: 0.9802; val_best_acc_score: 0.9514; val_best_f1_score: 0.9524; train_kl_reg_loss: 72615.7100; train_edge_recon_loss: 2666869.2214; train_gene_expr_recon_loss: 13306361.2214; train_masked_gp_l1_reg_loss: 116096.1249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26376.8210; train_chrom_access_recon_loss: 3238780.7538; train_global_loss: 19427099.8626; train_optim_loss: 19427099.8626; val_kl_reg_loss: 72253.8974; val_edge_recon_loss: 2645862.5000; val_gene_expr_recon_loss: 13353320.8000; val_masked_gp_l1_reg_loss: 116094.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26375.3789; val_chrom_access_recon_loss: 3260018.3333; val_global_loss: 19473925.4667; val_optim_loss: 19473925.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 83 min 22 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9842
val AUPRC score: 0.9780
val best accuracy score: 0.9462
val best F1 score: 0.9480
val target rna MSE score: 0.8200
val source rna MSE score: 0.1723
val target atac MSE score: 0.5040
val source atac MSE score: 0.0823
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
