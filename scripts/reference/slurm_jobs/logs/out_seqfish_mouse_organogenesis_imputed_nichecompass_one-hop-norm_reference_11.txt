[True]
Run timestamp: 01082023_061626_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9136; val_auprc_score: 0.9838; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 17225.3936; train_edge_recon_loss: 11528.9227; train_gene_expr_recon_loss: 537928.4531; train_masked_gp_l1_reg_loss: 7692.9131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58258.2423; train_global_loss: 632633.9259; train_optim_loss: 632633.9259; val_kl_reg_loss: 13956.4756; val_edge_recon_loss: 11903.5967; val_gene_expr_recon_loss: 424233.4375; val_masked_gp_l1_reg_loss: 5970.6318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53356.1680; val_global_loss: 509420.2917; val_optim_loss: 509420.2917
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9046; val_auprc_score: 0.9825; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 13931.2993; train_edge_recon_loss: 11651.7833; train_gene_expr_recon_loss: 385865.5093; train_masked_gp_l1_reg_loss: 5842.6276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49281.7416; train_global_loss: 466572.9635; train_optim_loss: 466572.9635; val_kl_reg_loss: 12944.3569; val_edge_recon_loss: 11828.3302; val_gene_expr_recon_loss: 339844.1458; val_masked_gp_l1_reg_loss: 5893.3486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45322.2109; val_global_loss: 415832.3958; val_optim_loss: 415832.3958
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8850; val_auprc_score: 0.9776; val_best_acc_score: 0.8596; val_best_f1_score: 0.9240; train_kl_reg_loss: 13004.0063; train_edge_recon_loss: 11564.7129; train_gene_expr_recon_loss: 297176.8339; train_masked_gp_l1_reg_loss: 5985.5239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41942.6573; train_global_loss: 369673.7344; train_optim_loss: 369673.7344; val_kl_reg_loss: 12409.9090; val_edge_recon_loss: 11865.8669; val_gene_expr_recon_loss: 261437.5938; val_masked_gp_l1_reg_loss: 6050.7563; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38632.8711; val_global_loss: 330396.9948; val_optim_loss: 330396.9948
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8626; val_auprc_score: 0.9740; val_best_acc_score: 0.8736; val_best_f1_score: 0.9305; train_kl_reg_loss: 12466.2600; train_edge_recon_loss: 11478.2789; train_gene_expr_recon_loss: 248632.9106; train_masked_gp_l1_reg_loss: 6087.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35811.6947; train_global_loss: 314476.3183; train_optim_loss: 314476.3183; val_kl_reg_loss: 11549.0887; val_edge_recon_loss: 11807.8055; val_gene_expr_recon_loss: 239437.1745; val_masked_gp_l1_reg_loss: 6129.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33088.1445; val_global_loss: 302012.1042; val_optim_loss: 302012.1042
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8511; val_auprc_score: 0.9699; val_best_acc_score: 0.8630; val_best_f1_score: 0.9255; train_kl_reg_loss: 11401.3970; train_edge_recon_loss: 11360.2776; train_gene_expr_recon_loss: 236126.1481; train_masked_gp_l1_reg_loss: 6174.0139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30898.5566; train_global_loss: 295960.3947; train_optim_loss: 295960.3947; val_kl_reg_loss: 10454.3529; val_edge_recon_loss: 11862.0148; val_gene_expr_recon_loss: 232400.0625; val_masked_gp_l1_reg_loss: 6221.7085; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28867.1094; val_global_loss: 289805.2396; val_optim_loss: 289805.2396
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8538; val_auprc_score: 0.9713; val_best_acc_score: 0.8748; val_best_f1_score: 0.9313; train_kl_reg_loss: 10445.0630; train_edge_recon_loss: 11495.2848; train_gene_expr_recon_loss: 230656.0480; train_masked_gp_l1_reg_loss: 6262.9800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27394.0798; train_global_loss: 286253.4560; train_optim_loss: 286253.4560; val_kl_reg_loss: 9616.5804; val_edge_recon_loss: 11679.8446; val_gene_expr_recon_loss: 228278.7708; val_masked_gp_l1_reg_loss: 6303.1987; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26107.1016; val_global_loss: 281985.5000; val_optim_loss: 281985.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8473; val_auprc_score: 0.9689; val_best_acc_score: 0.8698; val_best_f1_score: 0.9279; train_kl_reg_loss: 9708.3730; train_edge_recon_loss: 11413.1022; train_gene_expr_recon_loss: 226887.7347; train_masked_gp_l1_reg_loss: 6330.1467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25038.4215; train_global_loss: 279377.7818; train_optim_loss: 279377.7818; val_kl_reg_loss: 9018.7786; val_edge_recon_loss: 11922.6328; val_gene_expr_recon_loss: 224747.0625; val_masked_gp_l1_reg_loss: 6353.8447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23951.9531; val_global_loss: 275994.2604; val_optim_loss: 275994.2604
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8459; val_auprc_score: 0.9677; val_best_acc_score: 0.8723; val_best_f1_score: 0.9297; train_kl_reg_loss: 9097.1503; train_edge_recon_loss: 11357.1980; train_gene_expr_recon_loss: 223948.1930; train_masked_gp_l1_reg_loss: 6366.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22943.7769; train_global_loss: 273713.1817; train_optim_loss: 273713.1817; val_kl_reg_loss: 8465.6554; val_edge_recon_loss: 11914.5540; val_gene_expr_recon_loss: 222174.2917; val_masked_gp_l1_reg_loss: 6377.6748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21919.8984; val_global_loss: 270852.0677; val_optim_loss: 270852.0677
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8476; val_auprc_score: 0.9698; val_best_acc_score: 0.8720; val_best_f1_score: 0.9294; train_kl_reg_loss: 8581.8830; train_edge_recon_loss: 11199.7880; train_gene_expr_recon_loss: 221506.1308; train_masked_gp_l1_reg_loss: 6379.3860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20982.2035; train_global_loss: 268649.3883; train_optim_loss: 268649.3883; val_kl_reg_loss: 8061.7513; val_edge_recon_loss: 11600.2988; val_gene_expr_recon_loss: 219636.5000; val_masked_gp_l1_reg_loss: 6377.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20035.4785; val_global_loss: 265711.8854; val_optim_loss: 265711.8854
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8522; val_auprc_score: 0.9703; val_best_acc_score: 0.8729; val_best_f1_score: 0.9304; train_kl_reg_loss: 8149.1810; train_edge_recon_loss: 11182.3737; train_gene_expr_recon_loss: 219261.9800; train_masked_gp_l1_reg_loss: 6366.8744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19177.6987; train_global_loss: 264138.1076; train_optim_loss: 264138.1076; val_kl_reg_loss: 7672.9300; val_edge_recon_loss: 11416.1925; val_gene_expr_recon_loss: 217305.0677; val_masked_gp_l1_reg_loss: 6351.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18317.0840; val_global_loss: 261063.0339; val_optim_loss: 261063.0339
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8652; val_auprc_score: 0.9731; val_best_acc_score: 0.8711; val_best_f1_score: 0.9291; train_kl_reg_loss: 7762.1152; train_edge_recon_loss: 11126.4670; train_gene_expr_recon_loss: 217230.7801; train_masked_gp_l1_reg_loss: 6326.9705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17547.6747; train_global_loss: 259994.0090; train_optim_loss: 259994.0090; val_kl_reg_loss: 7346.3830; val_edge_recon_loss: 11696.5252; val_gene_expr_recon_loss: 215653.3151; val_masked_gp_l1_reg_loss: 6297.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16780.5586; val_global_loss: 257774.4896; val_optim_loss: 257774.4896
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8685; val_auprc_score: 0.9726; val_best_acc_score: 0.8705; val_best_f1_score: 0.9287; train_kl_reg_loss: 7420.9725; train_edge_recon_loss: 11185.4652; train_gene_expr_recon_loss: 215410.9439; train_masked_gp_l1_reg_loss: 6260.0345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16095.7505; train_global_loss: 256373.1661; train_optim_loss: 256373.1661; val_kl_reg_loss: 6978.9749; val_edge_recon_loss: 11774.0381; val_gene_expr_recon_loss: 214145.4792; val_masked_gp_l1_reg_loss: 6219.3560; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15413.5557; val_global_loss: 254531.4115; val_optim_loss: 254531.4115
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8776; val_auprc_score: 0.9752; val_best_acc_score: 0.8719; val_best_f1_score: 0.9293; train_kl_reg_loss: 7122.2960; train_edge_recon_loss: 11160.7711; train_gene_expr_recon_loss: 213617.0611; train_masked_gp_l1_reg_loss: 6172.7066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14809.9108; train_global_loss: 252882.7474; train_optim_loss: 252882.7474; val_kl_reg_loss: 6697.2953; val_edge_recon_loss: 11737.1681; val_gene_expr_recon_loss: 212348.8125; val_masked_gp_l1_reg_loss: 6121.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14207.0459; val_global_loss: 251111.5573; val_optim_loss: 251111.5573
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8798; val_auprc_score: 0.9768; val_best_acc_score: 0.8770; val_best_f1_score: 0.9324; train_kl_reg_loss: 6848.2674; train_edge_recon_loss: 10929.7702; train_gene_expr_recon_loss: 211908.7763; train_masked_gp_l1_reg_loss: 6062.9777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13671.3321; train_global_loss: 249421.1244; train_optim_loss: 249421.1244; val_kl_reg_loss: 6436.8186; val_edge_recon_loss: 11099.1987; val_gene_expr_recon_loss: 210438.1016; val_masked_gp_l1_reg_loss: 6000.4438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13138.9072; val_global_loss: 247113.4635; val_optim_loss: 247113.4635
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8814; val_auprc_score: 0.9752; val_best_acc_score: 0.8750; val_best_f1_score: 0.9311; train_kl_reg_loss: 6594.0065; train_edge_recon_loss: 10940.8010; train_gene_expr_recon_loss: 210224.8200; train_masked_gp_l1_reg_loss: 5931.7623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12666.6656; train_global_loss: 246358.0550; train_optim_loss: 246358.0550; val_kl_reg_loss: 6232.7072; val_edge_recon_loss: 11524.0213; val_gene_expr_recon_loss: 208844.1562; val_masked_gp_l1_reg_loss: 5856.0063; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12197.7490; val_global_loss: 244654.6328; val_optim_loss: 244654.6328
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8865; val_auprc_score: 0.9776; val_best_acc_score: 0.8778; val_best_f1_score: 0.9319; train_kl_reg_loss: 6355.5743; train_edge_recon_loss: 11100.5571; train_gene_expr_recon_loss: 208570.1010; train_masked_gp_l1_reg_loss: 5774.9046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11784.0009; train_global_loss: 243585.1369; train_optim_loss: 243585.1369; val_kl_reg_loss: 6059.1705; val_edge_recon_loss: 11304.3490; val_gene_expr_recon_loss: 207288.4948; val_masked_gp_l1_reg_loss: 5687.4634; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11374.5781; val_global_loss: 241714.0599; val_optim_loss: 241714.0599
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8863; val_auprc_score: 0.9754; val_best_acc_score: 0.8768; val_best_f1_score: 0.9316; train_kl_reg_loss: 6123.5511; train_edge_recon_loss: 10915.0550; train_gene_expr_recon_loss: 206988.2778; train_masked_gp_l1_reg_loss: 5597.8566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11011.0172; train_global_loss: 240635.7564; train_optim_loss: 240635.7564; val_kl_reg_loss: 5818.8969; val_edge_recon_loss: 11505.3813; val_gene_expr_recon_loss: 205902.5885; val_masked_gp_l1_reg_loss: 5504.2510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10652.9043; val_global_loss: 239384.0234; val_optim_loss: 239384.0234
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8822; val_auprc_score: 0.9752; val_best_acc_score: 0.8764; val_best_f1_score: 0.9312; train_kl_reg_loss: 5900.0038; train_edge_recon_loss: 10905.2831; train_gene_expr_recon_loss: 205430.3003; train_masked_gp_l1_reg_loss: 5406.9209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10336.1775; train_global_loss: 237978.6852; train_optim_loss: 237978.6852; val_kl_reg_loss: 5584.5719; val_edge_recon_loss: 11363.7970; val_gene_expr_recon_loss: 203961.9818; val_masked_gp_l1_reg_loss: 5302.5171; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10022.6406; val_global_loss: 236235.5078; val_optim_loss: 236235.5078
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8859; val_auprc_score: 0.9754; val_best_acc_score: 0.8748; val_best_f1_score: 0.9301; train_kl_reg_loss: 5677.9694; train_edge_recon_loss: 10749.3487; train_gene_expr_recon_loss: 203843.9028; train_masked_gp_l1_reg_loss: 5197.6290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9744.3965; train_global_loss: 235213.2465; train_optim_loss: 235213.2465; val_kl_reg_loss: 5372.2358; val_edge_recon_loss: 11588.7962; val_gene_expr_recon_loss: 202390.9688; val_masked_gp_l1_reg_loss: 5088.1792; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9467.5205; val_global_loss: 233907.6901; val_optim_loss: 233907.6901
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8982; val_auprc_score: 0.9801; val_best_acc_score: 0.8862; val_best_f1_score: 0.9350; train_kl_reg_loss: 5464.3931; train_edge_recon_loss: 10831.2465; train_gene_expr_recon_loss: 202316.4491; train_masked_gp_l1_reg_loss: 4979.1412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9221.1048; train_global_loss: 232812.3342; train_optim_loss: 232812.3342; val_kl_reg_loss: 5153.6274; val_edge_recon_loss: 11050.0693; val_gene_expr_recon_loss: 201307.6719; val_masked_gp_l1_reg_loss: 4866.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8974.8789; val_global_loss: 231352.8984; val_optim_loss: 231352.8984
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8957; val_auprc_score: 0.9781; val_best_acc_score: 0.8828; val_best_f1_score: 0.9330; train_kl_reg_loss: 5254.4136; train_edge_recon_loss: 10655.5521; train_gene_expr_recon_loss: 200798.5437; train_masked_gp_l1_reg_loss: 4757.0999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8755.5711; train_global_loss: 230221.1785; train_optim_loss: 230221.1785; val_kl_reg_loss: 4972.1388; val_edge_recon_loss: 11450.0975; val_gene_expr_recon_loss: 199352.5443; val_masked_gp_l1_reg_loss: 4644.4121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8536.2012; val_global_loss: 228955.3906; val_optim_loss: 228955.3906
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8952; val_auprc_score: 0.9792; val_best_acc_score: 0.8862; val_best_f1_score: 0.9349; train_kl_reg_loss: 5049.2168; train_edge_recon_loss: 10662.2075; train_gene_expr_recon_loss: 199326.8961; train_masked_gp_l1_reg_loss: 4537.2119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8338.4277; train_global_loss: 227913.9606; train_optim_loss: 227913.9606; val_kl_reg_loss: 4766.6602; val_edge_recon_loss: 10973.5260; val_gene_expr_recon_loss: 198118.9141; val_masked_gp_l1_reg_loss: 4426.4854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8138.9019; val_global_loss: 226424.4922; val_optim_loss: 226424.4922
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9027; val_auprc_score: 0.9804; val_best_acc_score: 0.8866; val_best_f1_score: 0.9348; train_kl_reg_loss: 4851.2546; train_edge_recon_loss: 10515.2518; train_gene_expr_recon_loss: 197905.9531; train_masked_gp_l1_reg_loss: 4323.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7956.4839; train_global_loss: 225552.0932; train_optim_loss: 225552.0932; val_kl_reg_loss: 4560.6328; val_edge_recon_loss: 11179.2692; val_gene_expr_recon_loss: 196618.7500; val_masked_gp_l1_reg_loss: 4217.4243; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7773.7080; val_global_loss: 224349.7786; val_optim_loss: 224349.7786
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9042; val_auprc_score: 0.9799; val_best_acc_score: 0.8900; val_best_f1_score: 0.9368; train_kl_reg_loss: 4656.5986; train_edge_recon_loss: 10562.4384; train_gene_expr_recon_loss: 196533.3519; train_masked_gp_l1_reg_loss: 4118.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7606.2463; train_global_loss: 223477.5839; train_optim_loss: 223477.5839; val_kl_reg_loss: 4413.9111; val_edge_recon_loss: 11220.0283; val_gene_expr_recon_loss: 195330.2760; val_masked_gp_l1_reg_loss: 4019.0688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7438.0205; val_global_loss: 222421.2917; val_optim_loss: 222421.2917
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9034; val_auprc_score: 0.9796; val_best_acc_score: 0.8914; val_best_f1_score: 0.9371; train_kl_reg_loss: 4467.4573; train_edge_recon_loss: 10527.9359; train_gene_expr_recon_loss: 195185.4204; train_masked_gp_l1_reg_loss: 3923.7294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7281.7280; train_global_loss: 221386.2717; train_optim_loss: 221386.2717; val_kl_reg_loss: 4246.2450; val_edge_recon_loss: 11233.0918; val_gene_expr_recon_loss: 194000.4609; val_masked_gp_l1_reg_loss: 3825.6936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7124.3223; val_global_loss: 220429.8125; val_optim_loss: 220429.8125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8933; val_auprc_score: 0.9772; val_best_acc_score: 0.8954; val_best_f1_score: 0.9403; train_kl_reg_loss: 2460.3140; train_edge_recon_loss: 10564.8675; train_gene_expr_recon_loss: 333064.7731; train_masked_gp_l1_reg_loss: 4105.5467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6421.7150; train_global_loss: 356617.2170; train_optim_loss: 356617.2170; val_kl_reg_loss: 1973.6113; val_edge_recon_loss: 10337.3617; val_gene_expr_recon_loss: 284601.0677; val_masked_gp_l1_reg_loss: 4095.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5654.8853; val_global_loss: 306662.7865; val_optim_loss: 306662.7865
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9125; val_auprc_score: 0.9807; val_best_acc_score: 0.9068; val_best_f1_score: 0.9467; train_kl_reg_loss: 2032.2747; train_edge_recon_loss: 10000.0470; train_gene_expr_recon_loss: 261540.2760; train_masked_gp_l1_reg_loss: 3909.7952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5100.8444; train_global_loss: 282583.2355; train_optim_loss: 282583.2355; val_kl_reg_loss: 1786.3136; val_edge_recon_loss: 9997.4054; val_gene_expr_recon_loss: 242059.5260; val_masked_gp_l1_reg_loss: 3713.5151; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4609.9434; val_global_loss: 262166.7031; val_optim_loss: 262166.7031
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9195; val_auprc_score: 0.9818; val_best_acc_score: 0.9162; val_best_f1_score: 0.9520; train_kl_reg_loss: 1868.2329; train_edge_recon_loss: 9538.7183; train_gene_expr_recon_loss: 231535.8741; train_masked_gp_l1_reg_loss: 3535.4000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4252.7484; train_global_loss: 250730.9742; train_optim_loss: 250730.9742; val_kl_reg_loss: 1676.1278; val_edge_recon_loss: 9495.1484; val_gene_expr_recon_loss: 222046.2839; val_masked_gp_l1_reg_loss: 3359.5798; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3925.1055; val_global_loss: 240502.2448; val_optim_loss: 240502.2448
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9194; val_auprc_score: 0.9821; val_best_acc_score: 0.9202; val_best_f1_score: 0.9543; train_kl_reg_loss: 1754.0291; train_edge_recon_loss: 9192.8334; train_gene_expr_recon_loss: 216610.5064; train_masked_gp_l1_reg_loss: 3211.1038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3672.5223; train_global_loss: 234440.9957; train_optim_loss: 234440.9957; val_kl_reg_loss: 1586.6820; val_edge_recon_loss: 9027.2070; val_gene_expr_recon_loss: 211017.7943; val_masked_gp_l1_reg_loss: 3071.8330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3434.9463; val_global_loss: 228138.4661; val_optim_loss: 228138.4661

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9220; val_auprc_score: 0.9833; val_best_acc_score: 0.9212; val_best_f1_score: 0.9548; train_kl_reg_loss: 1699.5847; train_edge_recon_loss: 8974.1823; train_gene_expr_recon_loss: 211261.8637; train_masked_gp_l1_reg_loss: 2980.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3386.3660; train_global_loss: 228302.3733; train_optim_loss: 228302.3733; val_kl_reg_loss: 1562.4171; val_edge_recon_loss: 8904.1536; val_gene_expr_recon_loss: 210286.7344; val_masked_gp_l1_reg_loss: 2950.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3358.7720; val_global_loss: 227062.5885; val_optim_loss: 227062.5885
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9194; val_auprc_score: 0.9819; val_best_acc_score: 0.9198; val_best_f1_score: 0.9540; train_kl_reg_loss: 1680.1129; train_edge_recon_loss: 8916.5232; train_gene_expr_recon_loss: 210514.1062; train_masked_gp_l1_reg_loss: 2937.1236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3337.9580; train_global_loss: 227385.8232; train_optim_loss: 227385.8232; val_kl_reg_loss: 1563.9804; val_edge_recon_loss: 8955.1813; val_gene_expr_recon_loss: 210012.6745; val_masked_gp_l1_reg_loss: 2923.6787; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3316.5964; val_global_loss: 226772.1016; val_optim_loss: 226772.1016
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9230; val_auprc_score: 0.9822; val_best_acc_score: 0.9173; val_best_f1_score: 0.9521; train_kl_reg_loss: 1668.9072; train_edge_recon_loss: 8942.1445; train_gene_expr_recon_loss: 209802.9734; train_masked_gp_l1_reg_loss: 2911.0146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3296.1253; train_global_loss: 226621.1644; train_optim_loss: 226621.1644; val_kl_reg_loss: 1546.6342; val_edge_recon_loss: 9485.9139; val_gene_expr_recon_loss: 208985.5755; val_masked_gp_l1_reg_loss: 2898.2236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3274.9448; val_global_loss: 226191.2839; val_optim_loss: 226191.2839
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9234; val_auprc_score: 0.9831; val_best_acc_score: 0.9229; val_best_f1_score: 0.9556; train_kl_reg_loss: 1656.5955; train_edge_recon_loss: 8973.6707; train_gene_expr_recon_loss: 209226.8027; train_masked_gp_l1_reg_loss: 2885.4597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3254.4522; train_global_loss: 225996.9812; train_optim_loss: 225996.9812; val_kl_reg_loss: 1534.3664; val_edge_recon_loss: 8909.8381; val_gene_expr_recon_loss: 208375.4062; val_masked_gp_l1_reg_loss: 2872.7319; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3233.1753; val_global_loss: 224925.5182; val_optim_loss: 224925.5182

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 11 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9103
val AUPRC score: 0.9807
val best accuracy score: 0.8954
val best F1 score: 0.9398
val target rna MSE score: 23.5453
val source rna MSE score: 88.7827
Val cat covariate0 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
