[True]
Run timestamp: 07092023_164222_50.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_50']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6796; val_auprc_score: 0.6542; val_best_acc_score: 0.5032; val_best_f1_score: 0.6679; train_kl_reg_loss: 63162.6360; train_edge_recon_loss: 3568343.9091; train_gene_expr_recon_loss: 20581399.0606; train_masked_gp_l1_reg_loss: 63757.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 868117.5464; train_chrom_access_recon_loss: 881123.8636; train_global_loss: 26025904.7273; train_optim_loss: 26025904.7273; val_kl_reg_loss: 113740.7891; val_edge_recon_loss: 4064884.1250; val_gene_expr_recon_loss: 18871597.7500; val_masked_gp_l1_reg_loss: 59009.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 731032.3125; val_chrom_access_recon_loss: 848564.6016; val_global_loss: 24688829.0000; val_optim_loss: 24688829.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7517; val_auprc_score: 0.7322; val_best_acc_score: 0.6241; val_best_f1_score: 0.7150; train_kl_reg_loss: 113674.1536; train_edge_recon_loss: 3532493.0076; train_gene_expr_recon_loss: 18821290.8485; train_masked_gp_l1_reg_loss: 55437.5967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 597261.0668; train_chrom_access_recon_loss: 835123.3134; train_global_loss: 23955279.8485; train_optim_loss: 23955279.8485; val_kl_reg_loss: 107300.4297; val_edge_recon_loss: 4058983.6562; val_gene_expr_recon_loss: 18486479.7500; val_masked_gp_l1_reg_loss: 53639.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 473044.7188; val_chrom_access_recon_loss: 834970.4609; val_global_loss: 24014418.0000; val_optim_loss: 24014418.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8145; val_auprc_score: 0.7934; val_best_acc_score: 0.7203; val_best_f1_score: 0.7267; train_kl_reg_loss: 101696.3627; train_edge_recon_loss: 3522217.5379; train_gene_expr_recon_loss: 18556658.2727; train_masked_gp_l1_reg_loss: 53935.8633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 384146.1832; train_chrom_access_recon_loss: 825607.9233; train_global_loss: 23444262.1818; train_optim_loss: 23444262.1818; val_kl_reg_loss: 92478.6084; val_edge_recon_loss: 4000491.6875; val_gene_expr_recon_loss: 18339855.0000; val_masked_gp_l1_reg_loss: 55075.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 308001.5000; val_chrom_access_recon_loss: 841118.0547; val_global_loss: 23637021.5000; val_optim_loss: 23637021.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8460; val_auprc_score: 0.8077; val_best_acc_score: 0.7783; val_best_f1_score: 0.8033; train_kl_reg_loss: 83054.5974; train_edge_recon_loss: 3473637.7955; train_gene_expr_recon_loss: 18379797.7576; train_masked_gp_l1_reg_loss: 56903.9745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 258482.9602; train_chrom_access_recon_loss: 820601.6392; train_global_loss: 23072478.7576; train_optim_loss: 23072478.7576; val_kl_reg_loss: 63425.7739; val_edge_recon_loss: 3565243.2500; val_gene_expr_recon_loss: 18212506.5000; val_masked_gp_l1_reg_loss: 58557.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216304.9844; val_chrom_access_recon_loss: 838410.7188; val_global_loss: 22954448.5000; val_optim_loss: 22954448.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8709; val_auprc_score: 0.8355; val_best_acc_score: 0.8006; val_best_f1_score: 0.8147; train_kl_reg_loss: 81225.4348; train_edge_recon_loss: 3128655.2500; train_gene_expr_recon_loss: 18287930.8485; train_masked_gp_l1_reg_loss: 60530.5016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185520.2195; train_chrom_access_recon_loss: 818448.9536; train_global_loss: 22562311.2727; train_optim_loss: 22562311.2727; val_kl_reg_loss: 103193.5791; val_edge_recon_loss: 2937655.0312; val_gene_expr_recon_loss: 18164290.5000; val_masked_gp_l1_reg_loss: 61686.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157862.6406; val_chrom_access_recon_loss: 832052.2344; val_global_loss: 22256739.0000; val_optim_loss: 22256739.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8872; val_auprc_score: 0.8549; val_best_acc_score: 0.8168; val_best_f1_score: 0.8304; train_kl_reg_loss: 103958.0315; train_edge_recon_loss: 2934936.8712; train_gene_expr_recon_loss: 18172566.0909; train_masked_gp_l1_reg_loss: 62464.5540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138183.0698; train_chrom_access_recon_loss: 813364.1354; train_global_loss: 22225472.6061; train_optim_loss: 22225472.6061; val_kl_reg_loss: 106918.4307; val_edge_recon_loss: 2946553.9375; val_gene_expr_recon_loss: 17850350.8750; val_masked_gp_l1_reg_loss: 63547.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120372.4375; val_chrom_access_recon_loss: 812038.3906; val_global_loss: 21899781.7500; val_optim_loss: 21899781.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9027; val_auprc_score: 0.8690; val_best_acc_score: 0.8366; val_best_f1_score: 0.8470; train_kl_reg_loss: 105464.8597; train_edge_recon_loss: 2871888.4924; train_gene_expr_recon_loss: 18058719.7273; train_masked_gp_l1_reg_loss: 64810.6665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107807.9645; train_chrom_access_recon_loss: 809404.5388; train_global_loss: 22018096.4545; train_optim_loss: 22018096.4545; val_kl_reg_loss: 102514.8711; val_edge_recon_loss: 2904295.4062; val_gene_expr_recon_loss: 17823701.7500; val_masked_gp_l1_reg_loss: 65983.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96663.3750; val_chrom_access_recon_loss: 813909.8203; val_global_loss: 21807069.5000; val_optim_loss: 21807069.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9118; val_auprc_score: 0.8735; val_best_acc_score: 0.8552; val_best_f1_score: 0.8635; train_kl_reg_loss: 103696.5885; train_edge_recon_loss: 2854171.2083; train_gene_expr_recon_loss: 17968654.6061; train_masked_gp_l1_reg_loss: 66980.4866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88208.2045; train_chrom_access_recon_loss: 805594.9403; train_global_loss: 21887306.1818; train_optim_loss: 21887306.1818; val_kl_reg_loss: 102503.8057; val_edge_recon_loss: 2844047.6250; val_gene_expr_recon_loss: 17860601.5000; val_masked_gp_l1_reg_loss: 68122.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81005.7422; val_chrom_access_recon_loss: 813692.4453; val_global_loss: 21769973.7500; val_optim_loss: 21769973.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9196; val_auprc_score: 0.8922; val_best_acc_score: 0.8584; val_best_f1_score: 0.8673; train_kl_reg_loss: 103415.8217; train_edge_recon_loss: 2833459.1856; train_gene_expr_recon_loss: 17874297.2727; train_masked_gp_l1_reg_loss: 69040.7979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74883.6113; train_chrom_access_recon_loss: 801808.4924; train_global_loss: 21756905.0909; train_optim_loss: 21756905.0909; val_kl_reg_loss: 101879.8779; val_edge_recon_loss: 2817099.4688; val_gene_expr_recon_loss: 17726967.7500; val_masked_gp_l1_reg_loss: 70050.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69488.6094; val_chrom_access_recon_loss: 809566.6094; val_global_loss: 21595051.7500; val_optim_loss: 21595051.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9277; val_auprc_score: 0.9040; val_best_acc_score: 0.8649; val_best_f1_score: 0.8726; train_kl_reg_loss: 103073.2206; train_edge_recon_loss: 2801138.7424; train_gene_expr_recon_loss: 17811971.5152; train_masked_gp_l1_reg_loss: 70924.5982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65260.4611; train_chrom_access_recon_loss: 799448.4062; train_global_loss: 21651817.1212; train_optim_loss: 21651817.1212; val_kl_reg_loss: 103742.6592; val_edge_recon_loss: 2807562.5938; val_gene_expr_recon_loss: 17478386.0000; val_masked_gp_l1_reg_loss: 71594.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61420.1953; val_chrom_access_recon_loss: 800791.1953; val_global_loss: 21323496.5000; val_optim_loss: 21323496.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9226; val_auprc_score: 0.8912; val_best_acc_score: 0.8665; val_best_f1_score: 0.8742; train_kl_reg_loss: 99564.4656; train_edge_recon_loss: 2795669.2348; train_gene_expr_recon_loss: 17739887.2424; train_masked_gp_l1_reg_loss: 72590.3802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58305.1261; train_chrom_access_recon_loss: 795554.6799; train_global_loss: 21561571.0303; train_optim_loss: 21561571.0303; val_kl_reg_loss: 100054.0371; val_edge_recon_loss: 2817719.1250; val_gene_expr_recon_loss: 17536549.2500; val_masked_gp_l1_reg_loss: 73499.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55587.1719; val_chrom_access_recon_loss: 802490.5469; val_global_loss: 21385900.7500; val_optim_loss: 21385900.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9235; val_auprc_score: 0.8952; val_best_acc_score: 0.8635; val_best_f1_score: 0.8719; train_kl_reg_loss: 100885.5105; train_edge_recon_loss: 2781004.3333; train_gene_expr_recon_loss: 17644257.2121; train_masked_gp_l1_reg_loss: 74211.9721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53105.3120; train_chrom_access_recon_loss: 792103.4261; train_global_loss: 21445567.6667; train_optim_loss: 21445567.6667; val_kl_reg_loss: 99646.8926; val_edge_recon_loss: 2787295.3125; val_gene_expr_recon_loss: 17361729.0000; val_masked_gp_l1_reg_loss: 75071.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51202.1484; val_chrom_access_recon_loss: 795244.1094; val_global_loss: 21170189.5000; val_optim_loss: 21170189.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9269; val_auprc_score: 0.8985; val_best_acc_score: 0.8684; val_best_f1_score: 0.8749; train_kl_reg_loss: 97631.5513; train_edge_recon_loss: 2779133.2500; train_gene_expr_recon_loss: 17598228.2121; train_masked_gp_l1_reg_loss: 75758.8905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49283.3294; train_chrom_access_recon_loss: 790295.5928; train_global_loss: 21390330.8788; train_optim_loss: 21390330.8788; val_kl_reg_loss: 97661.5898; val_edge_recon_loss: 2792522.8125; val_gene_expr_recon_loss: 17561953.0000; val_masked_gp_l1_reg_loss: 76343.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47753.3438; val_chrom_access_recon_loss: 799048.7812; val_global_loss: 21375284.2500; val_optim_loss: 21375284.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9300; val_auprc_score: 0.8989; val_best_acc_score: 0.8748; val_best_f1_score: 0.8815; train_kl_reg_loss: 96370.1219; train_edge_recon_loss: 2763202.6932; train_gene_expr_recon_loss: 17536917.6364; train_masked_gp_l1_reg_loss: 77074.4264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46329.8950; train_chrom_access_recon_loss: 787987.7973; train_global_loss: 21307882.6364; train_optim_loss: 21307882.6364; val_kl_reg_loss: 96885.4951; val_edge_recon_loss: 2766385.6875; val_gene_expr_recon_loss: 17392828.0000; val_masked_gp_l1_reg_loss: 77801.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45240.5977; val_chrom_access_recon_loss: 793447.5625; val_global_loss: 21172588.7500; val_optim_loss: 21172588.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9349; val_auprc_score: 0.9141; val_best_acc_score: 0.8783; val_best_f1_score: 0.8850; train_kl_reg_loss: 93913.0239; train_edge_recon_loss: 2758221.4621; train_gene_expr_recon_loss: 17475710.3788; train_masked_gp_l1_reg_loss: 78416.5212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43960.1443; train_chrom_access_recon_loss: 785286.9110; train_global_loss: 21235508.5758; train_optim_loss: 21235508.5758; val_kl_reg_loss: 94987.7148; val_edge_recon_loss: 2743833.5938; val_gene_expr_recon_loss: 17299243.5000; val_masked_gp_l1_reg_loss: 79086.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42818.2188; val_chrom_access_recon_loss: 793306.5156; val_global_loss: 21053275.2500; val_optim_loss: 21053275.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9362; val_auprc_score: 0.9183; val_best_acc_score: 0.8732; val_best_f1_score: 0.8795; train_kl_reg_loss: 93511.7056; train_edge_recon_loss: 2752001.7500; train_gene_expr_recon_loss: 17420526.0909; train_masked_gp_l1_reg_loss: 79731.5498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41919.9257; train_chrom_access_recon_loss: 783497.9811; train_global_loss: 21171188.9697; train_optim_loss: 21171188.9697; val_kl_reg_loss: 91766.6992; val_edge_recon_loss: 2782436.4688; val_gene_expr_recon_loss: 17218625.1250; val_masked_gp_l1_reg_loss: 80447.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41336.5781; val_chrom_access_recon_loss: 793897.5625; val_global_loss: 21008510.0000; val_optim_loss: 21008510.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9314; val_auprc_score: 0.9045; val_best_acc_score: 0.8705; val_best_f1_score: 0.8774; train_kl_reg_loss: 91870.7185; train_edge_recon_loss: 2737314.3485; train_gene_expr_recon_loss: 17388989.4242; train_masked_gp_l1_reg_loss: 80991.4356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40501.1762; train_chrom_access_recon_loss: 781112.6667; train_global_loss: 21120779.7879; train_optim_loss: 21120779.7879; val_kl_reg_loss: 93687.2246; val_edge_recon_loss: 2797400.6875; val_gene_expr_recon_loss: 17334892.2500; val_masked_gp_l1_reg_loss: 81550.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39819.6367; val_chrom_access_recon_loss: 793455.2891; val_global_loss: 21140805.2500; val_optim_loss: 21140805.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9285; val_auprc_score: 0.9019; val_best_acc_score: 0.8726; val_best_f1_score: 0.8796; train_kl_reg_loss: 90081.9309; train_edge_recon_loss: 2743605.1515; train_gene_expr_recon_loss: 17338452.4545; train_masked_gp_l1_reg_loss: 82045.0146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39092.0643; train_chrom_access_recon_loss: 779385.2500; train_global_loss: 21072661.8182; train_optim_loss: 21072661.8182; val_kl_reg_loss: 88065.8271; val_edge_recon_loss: 2790387.8438; val_gene_expr_recon_loss: 17339603.0000; val_masked_gp_l1_reg_loss: 82668.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38568.1016; val_chrom_access_recon_loss: 791509.7656; val_global_loss: 21130802.2500; val_optim_loss: 21130802.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9305; val_auprc_score: 0.9050; val_best_acc_score: 0.8761; val_best_f1_score: 0.8833; train_kl_reg_loss: 89002.7383; train_edge_recon_loss: 2737984.6591; train_gene_expr_recon_loss: 17283254.5606; train_masked_gp_l1_reg_loss: 83199.5722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38069.2166; train_chrom_access_recon_loss: 777024.8570; train_global_loss: 21008535.4545; train_optim_loss: 21008535.4545; val_kl_reg_loss: 86321.2588; val_edge_recon_loss: 2804430.8125; val_gene_expr_recon_loss: 17208471.5000; val_masked_gp_l1_reg_loss: 83640.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37439.8516; val_chrom_access_recon_loss: 785135.5781; val_global_loss: 21005439.0000; val_optim_loss: 21005439.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9411; val_auprc_score: 0.9188; val_best_acc_score: 0.8858; val_best_f1_score: 0.8922; train_kl_reg_loss: 87538.0695; train_edge_recon_loss: 2732928.6970; train_gene_expr_recon_loss: 17231835.7121; train_masked_gp_l1_reg_loss: 84210.4071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36845.3587; train_chrom_access_recon_loss: 774627.1553; train_global_loss: 20947985.4848; train_optim_loss: 20947985.4848; val_kl_reg_loss: 86813.0654; val_edge_recon_loss: 2762014.0312; val_gene_expr_recon_loss: 17211389.2500; val_masked_gp_l1_reg_loss: 84944.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36625.2578; val_chrom_access_recon_loss: 782208.7500; val_global_loss: 20963995.2500; val_optim_loss: 20963995.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9385; val_auprc_score: 0.9138; val_best_acc_score: 0.8853; val_best_f1_score: 0.8907; train_kl_reg_loss: 87776.3092; train_edge_recon_loss: 2728476.1629; train_gene_expr_recon_loss: 17216100.4242; train_masked_gp_l1_reg_loss: 85373.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36209.1251; train_chrom_access_recon_loss: 773141.1705; train_global_loss: 20927076.1515; train_optim_loss: 20927076.1515; val_kl_reg_loss: 87288.6748; val_edge_recon_loss: 2764133.2500; val_gene_expr_recon_loss: 16946639.8750; val_masked_gp_l1_reg_loss: 85769.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35762.9258; val_chrom_access_recon_loss: 776581.1172; val_global_loss: 20696175.0000; val_optim_loss: 20696175.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9454; val_auprc_score: 0.9181; val_best_acc_score: 0.8952; val_best_f1_score: 0.8998; train_kl_reg_loss: 86168.4954; train_edge_recon_loss: 2723831.0303; train_gene_expr_recon_loss: 17156788.7879; train_masked_gp_l1_reg_loss: 86259.4484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35308.2930; train_chrom_access_recon_loss: 771022.3712; train_global_loss: 20859378.4242; train_optim_loss: 20859378.4242; val_kl_reg_loss: 83953.7383; val_edge_recon_loss: 2753530.6250; val_gene_expr_recon_loss: 16998739.3750; val_masked_gp_l1_reg_loss: 86897.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35206.0234; val_chrom_access_recon_loss: 777822.1250; val_global_loss: 20736150.0000; val_optim_loss: 20736150.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9451; val_auprc_score: 0.9196; val_best_acc_score: 0.8944; val_best_f1_score: 0.9000; train_kl_reg_loss: 85585.5794; train_edge_recon_loss: 2725780.8939; train_gene_expr_recon_loss: 17119139.3182; train_masked_gp_l1_reg_loss: 87319.0399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34686.2810; train_chrom_access_recon_loss: 769384.2434; train_global_loss: 20821895.1818; train_optim_loss: 20821895.1818; val_kl_reg_loss: 84341.7559; val_edge_recon_loss: 2737838.3125; val_gene_expr_recon_loss: 17035880.2500; val_masked_gp_l1_reg_loss: 87915.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34402.6016; val_chrom_access_recon_loss: 782813.3984; val_global_loss: 20763191.5000; val_optim_loss: 20763191.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9424; val_auprc_score: 0.9162; val_best_acc_score: 0.8917; val_best_f1_score: 0.8969; train_kl_reg_loss: 85935.9428; train_edge_recon_loss: 2720190.8106; train_gene_expr_recon_loss: 17095429.0152; train_masked_gp_l1_reg_loss: 88210.4038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34086.0196; train_chrom_access_recon_loss: 768454.1392; train_global_loss: 20792306.6364; train_optim_loss: 20792306.6364; val_kl_reg_loss: 84635.0020; val_edge_recon_loss: 2751202.9375; val_gene_expr_recon_loss: 16957874.7500; val_masked_gp_l1_reg_loss: 88722.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33927.9766; val_chrom_access_recon_loss: 770166.7109; val_global_loss: 20686529.5000; val_optim_loss: 20686529.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9507; val_auprc_score: 0.9277; val_best_acc_score: 0.8968; val_best_f1_score: 0.9012; train_kl_reg_loss: 83604.7470; train_edge_recon_loss: 2708641.8712; train_gene_expr_recon_loss: 17050792.9848; train_masked_gp_l1_reg_loss: 89175.2531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33701.3316; train_chrom_access_recon_loss: 766631.6544; train_global_loss: 20732547.7576; train_optim_loss: 20732547.7576; val_kl_reg_loss: 82050.5215; val_edge_recon_loss: 2748260.2500; val_gene_expr_recon_loss: 16898695.2500; val_masked_gp_l1_reg_loss: 89654.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33337.7305; val_chrom_access_recon_loss: 773864.2812; val_global_loss: 20625862.5000; val_optim_loss: 20625862.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9510; val_auprc_score: 0.9340; val_best_acc_score: 0.8947; val_best_f1_score: 0.8998; train_kl_reg_loss: 91467.7475; train_edge_recon_loss: 2733800.1288; train_gene_expr_recon_loss: 16773260.0758; train_masked_gp_l1_reg_loss: 89207.9934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29337.6363; train_chrom_access_recon_loss: 756062.7074; train_global_loss: 20473136.3333; train_optim_loss: 20473136.3333; val_kl_reg_loss: 62427.6113; val_edge_recon_loss: 2750133.1250; val_gene_expr_recon_loss: 16604259.3750; val_masked_gp_l1_reg_loss: 88878.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28407.0098; val_chrom_access_recon_loss: 762217.5000; val_global_loss: 20296323.2500; val_optim_loss: 20296323.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9491; val_auprc_score: 0.9287; val_best_acc_score: 0.8952; val_best_f1_score: 0.9005; train_kl_reg_loss: 89524.1534; train_edge_recon_loss: 2718817.5455; train_gene_expr_recon_loss: 16684014.4091; train_masked_gp_l1_reg_loss: 89155.0436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28329.0216; train_chrom_access_recon_loss: 749445.7064; train_global_loss: 20359285.6061; train_optim_loss: 20359285.6061; val_kl_reg_loss: 63687.0166; val_edge_recon_loss: 2768325.4688; val_gene_expr_recon_loss: 16499096.2500; val_masked_gp_l1_reg_loss: 89511.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28278.0391; val_chrom_access_recon_loss: 752961.4609; val_global_loss: 20201860.0000; val_optim_loss: 20201860.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9507; val_auprc_score: 0.9280; val_best_acc_score: 0.8987; val_best_f1_score: 0.9039; train_kl_reg_loss: 85581.7612; train_edge_recon_loss: 2713495.5000; train_gene_expr_recon_loss: 16601543.7879; train_masked_gp_l1_reg_loss: 89747.5810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28223.5563; train_chrom_access_recon_loss: 746832.1913; train_global_loss: 20265424.4848; train_optim_loss: 20265424.4848; val_kl_reg_loss: 64744.9854; val_edge_recon_loss: 2706723.4688; val_gene_expr_recon_loss: 16528920.8750; val_masked_gp_l1_reg_loss: 90017.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28227.8926; val_chrom_access_recon_loss: 759489.1562; val_global_loss: 20178124.7500; val_optim_loss: 20178124.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9500; val_auprc_score: 0.9241; val_best_acc_score: 0.8990; val_best_f1_score: 0.9030; train_kl_reg_loss: 84287.1838; train_edge_recon_loss: 2707054.3523; train_gene_expr_recon_loss: 16548887.5455; train_masked_gp_l1_reg_loss: 90243.3501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28158.2984; train_chrom_access_recon_loss: 745983.0350; train_global_loss: 20204613.8485; train_optim_loss: 20204613.8485; val_kl_reg_loss: 66884.0737; val_edge_recon_loss: 2761137.2188; val_gene_expr_recon_loss: 16582373.3750; val_masked_gp_l1_reg_loss: 90587.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28179.5664; val_chrom_access_recon_loss: 761692.4844; val_global_loss: 20290855.0000; val_optim_loss: 20290855.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9532; val_auprc_score: 0.9340; val_best_acc_score: 0.9030; val_best_f1_score: 0.9082; train_kl_reg_loss: 80708.8594; train_edge_recon_loss: 2712637.2992; train_gene_expr_recon_loss: 16497310.4545; train_masked_gp_l1_reg_loss: 90808.8772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28076.1886; train_chrom_access_recon_loss: 744577.8087; train_global_loss: 20154119.5758; train_optim_loss: 20154119.5758; val_kl_reg_loss: 67628.2432; val_edge_recon_loss: 2726861.2188; val_gene_expr_recon_loss: 16434140.0000; val_masked_gp_l1_reg_loss: 91075.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27922.0215; val_chrom_access_recon_loss: 749757.2344; val_global_loss: 20097385.0000; val_optim_loss: 20097385.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9529; val_auprc_score: 0.9345; val_best_acc_score: 0.9033; val_best_f1_score: 0.9091; train_kl_reg_loss: 78514.7159; train_edge_recon_loss: 2708157.4621; train_gene_expr_recon_loss: 16467143.3939; train_masked_gp_l1_reg_loss: 91365.8230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27936.2199; train_chrom_access_recon_loss: 742931.4337; train_global_loss: 20116049.0606; train_optim_loss: 20116049.0606; val_kl_reg_loss: 67896.6406; val_edge_recon_loss: 2748853.5938; val_gene_expr_recon_loss: 16485154.6250; val_masked_gp_l1_reg_loss: 91649.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27879.0410; val_chrom_access_recon_loss: 756216.1484; val_global_loss: 20177650.7500; val_optim_loss: 20177650.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9526; val_auprc_score: 0.9242; val_best_acc_score: 0.9073; val_best_f1_score: 0.9129; train_kl_reg_loss: 78048.1630; train_edge_recon_loss: 2708453.4394; train_gene_expr_recon_loss: 16433278.5303; train_masked_gp_l1_reg_loss: 91936.8026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27802.2094; train_chrom_access_recon_loss: 742550.9451; train_global_loss: 20082070.1515; train_optim_loss: 20082070.1515; val_kl_reg_loss: 66054.1836; val_edge_recon_loss: 2721364.3125; val_gene_expr_recon_loss: 16316734.7500; val_masked_gp_l1_reg_loss: 92190.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27732.7734; val_chrom_access_recon_loss: 749040.4922; val_global_loss: 19973115.7500; val_optim_loss: 19973115.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9548; val_auprc_score: 0.9312; val_best_acc_score: 0.9046; val_best_f1_score: 0.9084; train_kl_reg_loss: 76129.9148; train_edge_recon_loss: 2692395.9735; train_gene_expr_recon_loss: 16403357.1667; train_masked_gp_l1_reg_loss: 92473.3529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27644.9692; train_chrom_access_recon_loss: 741510.2169; train_global_loss: 20033511.4848; train_optim_loss: 20033511.4848; val_kl_reg_loss: 69521.4170; val_edge_recon_loss: 2730526.5938; val_gene_expr_recon_loss: 16209739.8750; val_masked_gp_l1_reg_loss: 92638.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27495.3340; val_chrom_access_recon_loss: 751907.5000; val_global_loss: 19881829.5000; val_optim_loss: 19881829.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9547; val_auprc_score: 0.9383; val_best_acc_score: 0.8976; val_best_f1_score: 0.9019; train_kl_reg_loss: 74724.7139; train_edge_recon_loss: 2697765.9091; train_gene_expr_recon_loss: 16364255.6212; train_masked_gp_l1_reg_loss: 92936.6064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27419.5942; train_chrom_access_recon_loss: 740428.2112; train_global_loss: 19997530.5758; train_optim_loss: 19997530.5758; val_kl_reg_loss: 69712.2285; val_edge_recon_loss: 2753282.6250; val_gene_expr_recon_loss: 16314866.8750; val_masked_gp_l1_reg_loss: 93240.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27265.7656; val_chrom_access_recon_loss: 753269.8203; val_global_loss: 20011637.5000; val_optim_loss: 20011637.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9621; val_auprc_score: 0.9502; val_best_acc_score: 0.9084; val_best_f1_score: 0.9117; train_kl_reg_loss: 73486.6244; train_edge_recon_loss: 2697754.8712; train_gene_expr_recon_loss: 16330897.9394; train_masked_gp_l1_reg_loss: 93551.6336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27239.2668; train_chrom_access_recon_loss: 739172.0199; train_global_loss: 19962102.1212; train_optim_loss: 19962102.1212; val_kl_reg_loss: 65474.6108; val_edge_recon_loss: 2754489.7812; val_gene_expr_recon_loss: 16215706.5000; val_masked_gp_l1_reg_loss: 93793.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27176.4121; val_chrom_access_recon_loss: 737684.1406; val_global_loss: 19894324.7500; val_optim_loss: 19894324.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9567; val_auprc_score: 0.9367; val_best_acc_score: 0.9014; val_best_f1_score: 0.9063; train_kl_reg_loss: 73340.4212; train_edge_recon_loss: 2699706.3712; train_gene_expr_recon_loss: 16304347.4848; train_masked_gp_l1_reg_loss: 94119.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27130.1124; train_chrom_access_recon_loss: 739119.2737; train_global_loss: 19937763.7273; train_optim_loss: 19937763.7273; val_kl_reg_loss: 67064.2510; val_edge_recon_loss: 2734225.9688; val_gene_expr_recon_loss: 16118079.3750; val_masked_gp_l1_reg_loss: 94448.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27041.7051; val_chrom_access_recon_loss: 747062.7500; val_global_loss: 19787921.5000; val_optim_loss: 19787921.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9594; val_auprc_score: 0.9414; val_best_acc_score: 0.9124; val_best_f1_score: 0.9160; train_kl_reg_loss: 72545.0045; train_edge_recon_loss: 2693016.9129; train_gene_expr_recon_loss: 16263095.1515; train_masked_gp_l1_reg_loss: 94721.0839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26972.1287; train_chrom_access_recon_loss: 737006.0275; train_global_loss: 19887356.3030; train_optim_loss: 19887356.3030; val_kl_reg_loss: 66049.3765; val_edge_recon_loss: 2704889.5625; val_gene_expr_recon_loss: 16083282.6250; val_masked_gp_l1_reg_loss: 94993.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26837.5059; val_chrom_access_recon_loss: 739292.0234; val_global_loss: 19715345.7500; val_optim_loss: 19715345.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9540; val_auprc_score: 0.9318; val_best_acc_score: 0.9035; val_best_f1_score: 0.9079; train_kl_reg_loss: 73728.5827; train_edge_recon_loss: 2690975.8750; train_gene_expr_recon_loss: 16239774.2273; train_masked_gp_l1_reg_loss: 95218.3092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26742.1792; train_chrom_access_recon_loss: 736931.1468; train_global_loss: 19863370.5152; train_optim_loss: 19863370.5152; val_kl_reg_loss: 67649.7861; val_edge_recon_loss: 2710646.5312; val_gene_expr_recon_loss: 16092503.1250; val_masked_gp_l1_reg_loss: 95544.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26803.0430; val_chrom_access_recon_loss: 738951.5625; val_global_loss: 19732099.5000; val_optim_loss: 19732099.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9526; val_auprc_score: 0.9345; val_best_acc_score: 0.9006; val_best_f1_score: 0.9048; train_kl_reg_loss: 71681.4893; train_edge_recon_loss: 2690233.4394; train_gene_expr_recon_loss: 16207866.7424; train_masked_gp_l1_reg_loss: 95760.1709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26701.9850; train_chrom_access_recon_loss: 736273.0758; train_global_loss: 19828516.8485; train_optim_loss: 19828516.8485; val_kl_reg_loss: 66322.8872; val_edge_recon_loss: 2740564.9688; val_gene_expr_recon_loss: 16094223.1250; val_masked_gp_l1_reg_loss: 96125.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26675.7578; val_chrom_access_recon_loss: 737241.6328; val_global_loss: 19761154.7500; val_optim_loss: 19761154.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9561; val_auprc_score: 0.9354; val_best_acc_score: 0.9081; val_best_f1_score: 0.9123; train_kl_reg_loss: 70822.2095; train_edge_recon_loss: 2690932.3447; train_gene_expr_recon_loss: 16175320.6667; train_masked_gp_l1_reg_loss: 96406.8194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26597.4563; train_chrom_access_recon_loss: 735313.2178; train_global_loss: 19795393.0000; train_optim_loss: 19795393.0000; val_kl_reg_loss: 66717.4478; val_edge_recon_loss: 2734537.9688; val_gene_expr_recon_loss: 16073823.6250; val_masked_gp_l1_reg_loss: 96674.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26613.5039; val_chrom_access_recon_loss: 742204.0938; val_global_loss: 19740571.0000; val_optim_loss: 19740571.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9560; val_auprc_score: 0.9368; val_best_acc_score: 0.9087; val_best_f1_score: 0.9127; train_kl_reg_loss: 69703.9384; train_edge_recon_loss: 2689834.0720; train_gene_expr_recon_loss: 16133268.5758; train_masked_gp_l1_reg_loss: 96989.9106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26514.5143; train_chrom_access_recon_loss: 731226.8466; train_global_loss: 19747537.6364; train_optim_loss: 19747537.6364; val_kl_reg_loss: 64645.0845; val_edge_recon_loss: 2732957.5625; val_gene_expr_recon_loss: 16033541.5000; val_masked_gp_l1_reg_loss: 97316.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26530.0176; val_chrom_access_recon_loss: 733967.3594; val_global_loss: 19688957.7500; val_optim_loss: 19688957.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9606; val_auprc_score: 0.9424; val_best_acc_score: 0.9164; val_best_f1_score: 0.9195; train_kl_reg_loss: 70430.2518; train_edge_recon_loss: 2685733.9015; train_gene_expr_recon_loss: 16107261.7424; train_masked_gp_l1_reg_loss: 97586.0906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26407.5775; train_chrom_access_recon_loss: 731564.3456; train_global_loss: 19718984.0000; train_optim_loss: 19718984.0000; val_kl_reg_loss: 65346.2461; val_edge_recon_loss: 2715079.6875; val_gene_expr_recon_loss: 15950454.3750; val_masked_gp_l1_reg_loss: 97803.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26408.1797; val_chrom_access_recon_loss: 737562.2891; val_global_loss: 19592654.7500; val_optim_loss: 19592654.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9581; val_auprc_score: 0.9360; val_best_acc_score: 0.9095; val_best_f1_score: 0.9132; train_kl_reg_loss: 69669.5341; train_edge_recon_loss: 2689219.1970; train_gene_expr_recon_loss: 16048378.6515; train_masked_gp_l1_reg_loss: 98123.1474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26376.8260; train_chrom_access_recon_loss: 729969.1042; train_global_loss: 19661736.8182; train_optim_loss: 19661736.8182; val_kl_reg_loss: 65477.8472; val_edge_recon_loss: 2702402.5312; val_gene_expr_recon_loss: 16061334.1250; val_masked_gp_l1_reg_loss: 98442.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26239.9355; val_chrom_access_recon_loss: 738272.4844; val_global_loss: 19692168.7500; val_optim_loss: 19692168.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9551; val_auprc_score: 0.9318; val_best_acc_score: 0.9054; val_best_f1_score: 0.9103; train_kl_reg_loss: 68824.9583; train_edge_recon_loss: 2679032.5606; train_gene_expr_recon_loss: 16023010.8788; train_masked_gp_l1_reg_loss: 98799.2790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26256.1085; train_chrom_access_recon_loss: 729928.2585; train_global_loss: 19625852.0000; train_optim_loss: 19625852.0000; val_kl_reg_loss: 64166.2803; val_edge_recon_loss: 2726608.5312; val_gene_expr_recon_loss: 15763680.5000; val_masked_gp_l1_reg_loss: 99159.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26234.6719; val_chrom_access_recon_loss: 725244.2578; val_global_loss: 19405093.7500; val_optim_loss: 19405093.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9593; val_auprc_score: 0.9398; val_best_acc_score: 0.9130; val_best_f1_score: 0.9168; train_kl_reg_loss: 68779.7965; train_edge_recon_loss: 2677530.7311; train_gene_expr_recon_loss: 15978034.5606; train_masked_gp_l1_reg_loss: 99495.4020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26262.3973; train_chrom_access_recon_loss: 729661.3920; train_global_loss: 19579764.0303; train_optim_loss: 19579764.0303; val_kl_reg_loss: 64883.7827; val_edge_recon_loss: 2723149.9688; val_gene_expr_recon_loss: 15972820.3750; val_masked_gp_l1_reg_loss: 99752.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26199.8359; val_chrom_access_recon_loss: 733846.3359; val_global_loss: 19620653.0000; val_optim_loss: 19620653.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9574; val_auprc_score: 0.9365; val_best_acc_score: 0.9049; val_best_f1_score: 0.9095; train_kl_reg_loss: 68573.7246; train_edge_recon_loss: 2687671.5871; train_gene_expr_recon_loss: 15942181.9697; train_masked_gp_l1_reg_loss: 100186.9626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26140.7633; train_chrom_access_recon_loss: 728599.1610; train_global_loss: 19553354.1515; train_optim_loss: 19553354.1515; val_kl_reg_loss: 66005.6279; val_edge_recon_loss: 2725002.1250; val_gene_expr_recon_loss: 15972389.8750; val_masked_gp_l1_reg_loss: 100556.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26007.8184; val_chrom_access_recon_loss: 737820.0000; val_global_loss: 19627781.5000; val_optim_loss: 19627781.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9602; val_auprc_score: 0.9432; val_best_acc_score: 0.9065; val_best_f1_score: 0.9117; train_kl_reg_loss: 68231.5077; train_edge_recon_loss: 2682870.5265; train_gene_expr_recon_loss: 15910960.0000; train_masked_gp_l1_reg_loss: 100863.8987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26008.9017; train_chrom_access_recon_loss: 727910.8580; train_global_loss: 19516845.6667; train_optim_loss: 19516845.6667; val_kl_reg_loss: 67060.1982; val_edge_recon_loss: 2752679.8125; val_gene_expr_recon_loss: 15935183.0000; val_masked_gp_l1_reg_loss: 101158.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25946.4043; val_chrom_access_recon_loss: 735103.1016; val_global_loss: 19617130.5000; val_optim_loss: 19617130.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9650; val_auprc_score: 0.9500; val_best_acc_score: 0.9186; val_best_f1_score: 0.9213; train_kl_reg_loss: 68806.0871; train_edge_recon_loss: 2679922.0682; train_gene_expr_recon_loss: 15866485.9545; train_masked_gp_l1_reg_loss: 101471.5251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25923.5238; train_chrom_access_recon_loss: 727461.7500; train_global_loss: 19470070.9091; train_optim_loss: 19470070.9091; val_kl_reg_loss: 64302.4502; val_edge_recon_loss: 2704613.6250; val_gene_expr_recon_loss: 15928729.5000; val_masked_gp_l1_reg_loss: 101838.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25961.0586; val_chrom_access_recon_loss: 732595.7344; val_global_loss: 19558042.0000; val_optim_loss: 19558042.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9611; val_auprc_score: 0.9455; val_best_acc_score: 0.9135; val_best_f1_score: 0.9162; train_kl_reg_loss: 67080.6149; train_edge_recon_loss: 2682712.6250; train_gene_expr_recon_loss: 15843461.3636; train_masked_gp_l1_reg_loss: 101427.4563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24399.2035; train_chrom_access_recon_loss: 727845.2045; train_global_loss: 19446926.5455; train_optim_loss: 19446926.5455; val_kl_reg_loss: 64739.1943; val_edge_recon_loss: 2736363.4062; val_gene_expr_recon_loss: 15932705.0000; val_masked_gp_l1_reg_loss: 101228.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23920.7520; val_chrom_access_recon_loss: 740181.0938; val_global_loss: 19599137.0000; val_optim_loss: 19599137.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9626; val_auprc_score: 0.9454; val_best_acc_score: 0.9164; val_best_f1_score: 0.9189; train_kl_reg_loss: 68149.2038; train_edge_recon_loss: 2679681.8712; train_gene_expr_recon_loss: 15826912.8636; train_masked_gp_l1_reg_loss: 101201.4234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23779.8144; train_chrom_access_recon_loss: 726783.4915; train_global_loss: 19426508.7879; train_optim_loss: 19426508.7879; val_kl_reg_loss: 65532.9756; val_edge_recon_loss: 2696313.6562; val_gene_expr_recon_loss: 15842333.8750; val_masked_gp_l1_reg_loss: 101179.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23657.6133; val_chrom_access_recon_loss: 734353.9844; val_global_loss: 19463371.7500; val_optim_loss: 19463371.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9611; val_auprc_score: 0.9407; val_best_acc_score: 0.9140; val_best_f1_score: 0.9168; train_kl_reg_loss: 68245.6218; train_edge_recon_loss: 2687482.9545; train_gene_expr_recon_loss: 15831976.0909; train_masked_gp_l1_reg_loss: 101197.9384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23574.5576; train_chrom_access_recon_loss: 727586.2282; train_global_loss: 19440063.4848; train_optim_loss: 19440063.4848; val_kl_reg_loss: 65097.9546; val_edge_recon_loss: 2709999.3438; val_gene_expr_recon_loss: 15867846.7500; val_masked_gp_l1_reg_loss: 101215.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23487.1934; val_chrom_access_recon_loss: 736776.2188; val_global_loss: 19504423.7500; val_optim_loss: 19504423.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9610; val_auprc_score: 0.9415; val_best_acc_score: 0.9130; val_best_f1_score: 0.9157; train_kl_reg_loss: 68063.3314; train_edge_recon_loss: 2677130.3636; train_gene_expr_recon_loss: 15824881.1818; train_masked_gp_l1_reg_loss: 101247.4766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23437.1042; train_chrom_access_recon_loss: 727364.9498; train_global_loss: 19422124.2424; train_optim_loss: 19422124.2424; val_kl_reg_loss: 65058.3877; val_edge_recon_loss: 2752301.7812; val_gene_expr_recon_loss: 15956991.1250; val_masked_gp_l1_reg_loss: 101277.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23367.9473; val_chrom_access_recon_loss: 744704.6719; val_global_loss: 19643702.0000; val_optim_loss: 19643702.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 30 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9594
val AUPRC score: 0.9391
val best accuracy score: 0.9124
val best F1 score: 0.9170
val target rna MSE score: 1.2696
val source rna MSE score: 0.3948
val target atac MSE score: 0.4926
val source atac MSE score: 0.1102
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
