[True]
Run timestamp: 07082023_184943_50.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_50']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8950; val_auprc_score: 0.9090; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5972.7000; train_edge_recon_loss: 35649.2964; train_gene_expr_recon_loss: 1189082.5972; train_masked_gp_l1_reg_loss: 8290.7778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119105.0069; train_chrom_access_recon_loss: 945342.9236; train_global_loss: 2303443.2917; train_optim_loss: 2303443.2917; val_kl_reg_loss: 5627.8271; val_edge_recon_loss: 40659.9414; val_gene_expr_recon_loss: 1059511.5000; val_masked_gp_l1_reg_loss: 6304.2778; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116795.4609; val_chrom_access_recon_loss: 560126.2500; val_global_loss: 1789025.2500; val_optim_loss: 1789025.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9043; val_auprc_score: 0.9127; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5547.2607; train_edge_recon_loss: 36402.9722; train_gene_expr_recon_loss: 1005910.9861; train_masked_gp_l1_reg_loss: 5740.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115497.9618; train_chrom_access_recon_loss: 516279.8368; train_global_loss: 1685379.1111; train_optim_loss: 1685379.1111; val_kl_reg_loss: 5671.3857; val_edge_recon_loss: 40660.6250; val_gene_expr_recon_loss: 920451.8125; val_masked_gp_l1_reg_loss: 5528.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113974.6250; val_chrom_access_recon_loss: 480849.5625; val_global_loss: 1567136.2500; val_optim_loss: 1567136.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9129; val_auprc_score: 0.9235; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9196.2467; train_edge_recon_loss: 37169.5569; train_gene_expr_recon_loss: 877060.3681; train_masked_gp_l1_reg_loss: 5915.3168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112811.6363; train_chrom_access_recon_loss: 477821.8438; train_global_loss: 1519974.9583; train_optim_loss: 1519974.9583; val_kl_reg_loss: 14528.9385; val_edge_recon_loss: 40661.8945; val_gene_expr_recon_loss: 808634.2500; val_masked_gp_l1_reg_loss: 6286.8413; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111335.2344; val_chrom_access_recon_loss: 469723.6250; val_global_loss: 1451170.7500; val_optim_loss: 1451170.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9072; val_auprc_score: 0.9165; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17933.7773; train_edge_recon_loss: 38519.3746; train_gene_expr_recon_loss: 792897.7153; train_masked_gp_l1_reg_loss: 6337.0114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110040.3307; train_chrom_access_recon_loss: 471157.3646; train_global_loss: 1436885.5694; train_optim_loss: 1436885.5694; val_kl_reg_loss: 17254.9297; val_edge_recon_loss: 40661.6367; val_gene_expr_recon_loss: 754558.3750; val_masked_gp_l1_reg_loss: 6373.6841; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108313.2812; val_chrom_access_recon_loss: 456639.1562; val_global_loss: 1383801.0000; val_optim_loss: 1383801.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9050; val_auprc_score: 0.9125; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18007.5966; train_edge_recon_loss: 38547.1953; train_gene_expr_recon_loss: 753046.8889; train_masked_gp_l1_reg_loss: 6423.6002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106780.1293; train_chrom_access_recon_loss: 456101.5625; train_global_loss: 1378906.9722; train_optim_loss: 1378906.9722; val_kl_reg_loss: 18998.6719; val_edge_recon_loss: 40660.6445; val_gene_expr_recon_loss: 724353.3750; val_masked_gp_l1_reg_loss: 6476.5913; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104784.7734; val_chrom_access_recon_loss: 448124.1250; val_global_loss: 1343398.1250; val_optim_loss: 1343398.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8952; val_auprc_score: 0.9037; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20480.0944; train_edge_recon_loss: 38765.4622; train_gene_expr_recon_loss: 726552.1944; train_masked_gp_l1_reg_loss: 6478.2506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103074.1068; train_chrom_access_recon_loss: 450540.6285; train_global_loss: 1345890.7361; train_optim_loss: 1345890.7361; val_kl_reg_loss: 20346.7324; val_edge_recon_loss: 40658.9922; val_gene_expr_recon_loss: 703508.5000; val_masked_gp_l1_reg_loss: 6464.2217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100882.1250; val_chrom_access_recon_loss: 444257.5312; val_global_loss: 1316118.1250; val_optim_loss: 1316118.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8716; val_auprc_score: 0.8782; val_best_acc_score: 0.5066; val_best_f1_score: 0.6696; train_kl_reg_loss: 20840.0464; train_edge_recon_loss: 38837.8602; train_gene_expr_recon_loss: 706996.7986; train_masked_gp_l1_reg_loss: 6445.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99070.5938; train_chrom_access_recon_loss: 447518.1528; train_global_loss: 1319709.2361; train_optim_loss: 1319709.2361; val_kl_reg_loss: 20371.1289; val_edge_recon_loss: 40654.5195; val_gene_expr_recon_loss: 690521.0625; val_masked_gp_l1_reg_loss: 6415.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96781.9375; val_chrom_access_recon_loss: 441584.8125; val_global_loss: 1296329.3750; val_optim_loss: 1296329.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8530; val_auprc_score: 0.8532; val_best_acc_score: 0.5209; val_best_f1_score: 0.6754; train_kl_reg_loss: 21289.8036; train_edge_recon_loss: 38875.3051; train_gene_expr_recon_loss: 694308.9583; train_masked_gp_l1_reg_loss: 6400.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94930.7847; train_chrom_access_recon_loss: 446509.8160; train_global_loss: 1302314.7361; train_optim_loss: 1302314.7361; val_kl_reg_loss: 20498.2246; val_edge_recon_loss: 40641.5508; val_gene_expr_recon_loss: 680449.2500; val_masked_gp_l1_reg_loss: 6370.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92614.0469; val_chrom_access_recon_loss: 439527.7500; val_global_loss: 1280101.7500; val_optim_loss: 1280101.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8418; val_auprc_score: 0.8415; val_best_acc_score: 0.5509; val_best_f1_score: 0.6871; train_kl_reg_loss: 21424.7567; train_edge_recon_loss: 38893.4015; train_gene_expr_recon_loss: 687043.2292; train_masked_gp_l1_reg_loss: 6351.5285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90764.6146; train_chrom_access_recon_loss: 442560.3333; train_global_loss: 1287037.8750; train_optim_loss: 1287037.8750; val_kl_reg_loss: 20675.6133; val_edge_recon_loss: 40615.3086; val_gene_expr_recon_loss: 672083.5000; val_masked_gp_l1_reg_loss: 6319.5186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88459.8516; val_chrom_access_recon_loss: 438089.0625; val_global_loss: 1266242.8750; val_optim_loss: 1266242.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8229; val_auprc_score: 0.8223; val_best_acc_score: 0.5864; val_best_f1_score: 0.7023; train_kl_reg_loss: 21381.8730; train_edge_recon_loss: 38884.3689; train_gene_expr_recon_loss: 676924.5486; train_masked_gp_l1_reg_loss: 6305.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86633.5243; train_chrom_access_recon_loss: 439983.3472; train_global_loss: 1270113.3333; train_optim_loss: 1270113.3333; val_kl_reg_loss: 20661.1289; val_edge_recon_loss: 40588.8672; val_gene_expr_recon_loss: 665017.0625; val_masked_gp_l1_reg_loss: 6284.5483; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84359.7500; val_chrom_access_recon_loss: 436732.6250; val_global_loss: 1253644.0000; val_optim_loss: 1253644.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8234; val_auprc_score: 0.8302; val_best_acc_score: 0.6091; val_best_f1_score: 0.7115; train_kl_reg_loss: 21173.6866; train_edge_recon_loss: 38866.6576; train_gene_expr_recon_loss: 670535.6181; train_masked_gp_l1_reg_loss: 6269.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82566.6007; train_chrom_access_recon_loss: 439431.7465; train_global_loss: 1258844.1389; train_optim_loss: 1258844.1389; val_kl_reg_loss: 20395.4551; val_edge_recon_loss: 40559.6367; val_gene_expr_recon_loss: 659173.3750; val_masked_gp_l1_reg_loss: 6248.0415; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80345.1406; val_chrom_access_recon_loss: 435542.4688; val_global_loss: 1242264.1250; val_optim_loss: 1242264.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8285; val_auprc_score: 0.8340; val_best_acc_score: 0.6463; val_best_f1_score: 0.7283; train_kl_reg_loss: 20970.1552; train_edge_recon_loss: 38844.8746; train_gene_expr_recon_loss: 668346.4931; train_masked_gp_l1_reg_loss: 6240.8996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78605.3941; train_chrom_access_recon_loss: 439022.9618; train_global_loss: 1252030.7917; train_optim_loss: 1252030.7917; val_kl_reg_loss: 19973.3438; val_edge_recon_loss: 40517.3320; val_gene_expr_recon_loss: 654730.1250; val_masked_gp_l1_reg_loss: 6225.2051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76450.5781; val_chrom_access_recon_loss: 434358.1875; val_global_loss: 1232254.7500; val_optim_loss: 1232254.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8286; val_auprc_score: 0.8303; val_best_acc_score: 0.6757; val_best_f1_score: 0.7421; train_kl_reg_loss: 20642.7823; train_edge_recon_loss: 38827.7474; train_gene_expr_recon_loss: 660131.2292; train_masked_gp_l1_reg_loss: 6221.6897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74768.9253; train_chrom_access_recon_loss: 435629.0833; train_global_loss: 1236221.4583; train_optim_loss: 1236221.4583; val_kl_reg_loss: 19770.0215; val_edge_recon_loss: 40491.3203; val_gene_expr_recon_loss: 651072.6250; val_masked_gp_l1_reg_loss: 6211.6143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72689.0703; val_chrom_access_recon_loss: 433396.0312; val_global_loss: 1223630.7500; val_optim_loss: 1223630.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8324; val_auprc_score: 0.8366; val_best_acc_score: 0.6981; val_best_f1_score: 0.7506; train_kl_reg_loss: 20272.2216; train_edge_recon_loss: 38773.0451; train_gene_expr_recon_loss: 659879.3542; train_masked_gp_l1_reg_loss: 6207.2322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71074.7049; train_chrom_access_recon_loss: 438670.4931; train_global_loss: 1234877.0556; train_optim_loss: 1234877.0556; val_kl_reg_loss: 19067.3828; val_edge_recon_loss: 40447.8906; val_gene_expr_recon_loss: 648517.7500; val_masked_gp_l1_reg_loss: 6201.9067; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69084.3438; val_chrom_access_recon_loss: 432384.6250; val_global_loss: 1215703.8750; val_optim_loss: 1215703.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8467; val_auprc_score: 0.8475; val_best_acc_score: 0.7278; val_best_f1_score: 0.7657; train_kl_reg_loss: 19932.6024; train_edge_recon_loss: 38746.6237; train_gene_expr_recon_loss: 657672.7014; train_masked_gp_l1_reg_loss: 6202.8003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67545.3255; train_chrom_access_recon_loss: 436590.0694; train_global_loss: 1226690.1250; train_optim_loss: 1226690.1250; val_kl_reg_loss: 18428.8203; val_edge_recon_loss: 40404.5820; val_gene_expr_recon_loss: 646652.5625; val_masked_gp_l1_reg_loss: 6195.8374; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65645.4297; val_chrom_access_recon_loss: 431550.5312; val_global_loss: 1208877.7500; val_optim_loss: 1208877.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8559; val_auprc_score: 0.8579; val_best_acc_score: 0.7533; val_best_f1_score: 0.7794; train_kl_reg_loss: 19583.4766; train_edge_recon_loss: 38718.0078; train_gene_expr_recon_loss: 655275.7292; train_masked_gp_l1_reg_loss: 6198.8343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64187.2383; train_chrom_access_recon_loss: 436100.0243; train_global_loss: 1220063.2917; train_optim_loss: 1220063.2917; val_kl_reg_loss: 17930.2969; val_edge_recon_loss: 40363.9727; val_gene_expr_recon_loss: 645354.3750; val_masked_gp_l1_reg_loss: 6195.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62395.7891; val_chrom_access_recon_loss: 430784.7188; val_global_loss: 1203024.7500; val_optim_loss: 1203024.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8665; val_auprc_score: 0.8682; val_best_acc_score: 0.7743; val_best_f1_score: 0.7930; train_kl_reg_loss: 19170.9021; train_edge_recon_loss: 38672.9115; train_gene_expr_recon_loss: 652402.3472; train_masked_gp_l1_reg_loss: 6204.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61028.9214; train_chrom_access_recon_loss: 435029.0938; train_global_loss: 1212508.8472; train_optim_loss: 1212508.8472; val_kl_reg_loss: 17770.2148; val_edge_recon_loss: 40347.9766; val_gene_expr_recon_loss: 643021.2500; val_masked_gp_l1_reg_loss: 6206.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59343.8672; val_chrom_access_recon_loss: 430313.2188; val_global_loss: 1197003.2500; val_optim_loss: 1197003.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8806; val_auprc_score: 0.8794; val_best_acc_score: 0.7963; val_best_f1_score: 0.8102; train_kl_reg_loss: 18774.8140; train_edge_recon_loss: 38642.6797; train_gene_expr_recon_loss: 650675.9444; train_masked_gp_l1_reg_loss: 6210.0296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58056.5334; train_chrom_access_recon_loss: 434005.5764; train_global_loss: 1206365.5833; train_optim_loss: 1206365.5833; val_kl_reg_loss: 18226.9531; val_edge_recon_loss: 40334.1875; val_gene_expr_recon_loss: 640357.9375; val_masked_gp_l1_reg_loss: 6209.5840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56471.7656; val_chrom_access_recon_loss: 429647.9375; val_global_loss: 1191248.2500; val_optim_loss: 1191248.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8880; val_auprc_score: 0.8847; val_best_acc_score: 0.8088; val_best_f1_score: 0.8177; train_kl_reg_loss: 18402.8633; train_edge_recon_loss: 38580.1111; train_gene_expr_recon_loss: 646226.3611; train_masked_gp_l1_reg_loss: 6215.7489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55260.5260; train_chrom_access_recon_loss: 432412.0000; train_global_loss: 1197097.5833; train_optim_loss: 1197097.5833; val_kl_reg_loss: 17778.6094; val_edge_recon_loss: 40297.4727; val_gene_expr_recon_loss: 639089.4375; val_masked_gp_l1_reg_loss: 6217.8765; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53772.7500; val_chrom_access_recon_loss: 428935.7812; val_global_loss: 1186091.8750; val_optim_loss: 1186091.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8947; val_auprc_score: 0.8926; val_best_acc_score: 0.8227; val_best_f1_score: 0.8249; train_kl_reg_loss: 18240.3715; train_edge_recon_loss: 38548.7053; train_gene_expr_recon_loss: 647325.9514; train_masked_gp_l1_reg_loss: 6225.7980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52631.3832; train_chrom_access_recon_loss: 434109.5868; train_global_loss: 1197081.8194; train_optim_loss: 1197081.8194; val_kl_reg_loss: 17148.0176; val_edge_recon_loss: 40238.8594; val_gene_expr_recon_loss: 638171.3750; val_masked_gp_l1_reg_loss: 6224.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51228.4961; val_chrom_access_recon_loss: 428285.3438; val_global_loss: 1181296.7500; val_optim_loss: 1181296.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8986; val_auprc_score: 0.8909; val_best_acc_score: 0.8236; val_best_f1_score: 0.8234; train_kl_reg_loss: 17947.3155; train_edge_recon_loss: 38493.2053; train_gene_expr_recon_loss: 647566.3472; train_masked_gp_l1_reg_loss: 6229.5408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50163.4032; train_chrom_access_recon_loss: 432411.6944; train_global_loss: 1192811.5139; train_optim_loss: 1192811.5139; val_kl_reg_loss: 16996.9609; val_edge_recon_loss: 40176.0625; val_gene_expr_recon_loss: 636802.6250; val_masked_gp_l1_reg_loss: 6233.4448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48849.3750; val_chrom_access_recon_loss: 427641.5625; val_global_loss: 1176700.0000; val_optim_loss: 1176700.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9097; val_auprc_score: 0.9041; val_best_acc_score: 0.8341; val_best_f1_score: 0.8292; train_kl_reg_loss: 17685.4078; train_edge_recon_loss: 38429.7192; train_gene_expr_recon_loss: 643623.5556; train_masked_gp_l1_reg_loss: 6240.6358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47848.9210; train_chrom_access_recon_loss: 431122.2083; train_global_loss: 1184950.4167; train_optim_loss: 1184950.4167; val_kl_reg_loss: 16688.5059; val_edge_recon_loss: 40117.3086; val_gene_expr_recon_loss: 635621.5000; val_masked_gp_l1_reg_loss: 6240.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46613.0469; val_chrom_access_recon_loss: 426992.5625; val_global_loss: 1172273.2500; val_optim_loss: 1172273.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9155; val_auprc_score: 0.9062; val_best_acc_score: 0.8341; val_best_f1_score: 0.8256; train_kl_reg_loss: 17510.7858; train_edge_recon_loss: 38378.1098; train_gene_expr_recon_loss: 644614.2986; train_masked_gp_l1_reg_loss: 6247.8114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45674.0030; train_chrom_access_recon_loss: 429256.4097; train_global_loss: 1181681.4444; train_optim_loss: 1181681.4444; val_kl_reg_loss: 16514.8320; val_edge_recon_loss: 40045.1875; val_gene_expr_recon_loss: 634378.0625; val_masked_gp_l1_reg_loss: 6250.2397; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44515.0312; val_chrom_access_recon_loss: 426445.8438; val_global_loss: 1168149.2500; val_optim_loss: 1168149.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9246; val_auprc_score: 0.9150; val_best_acc_score: 0.8366; val_best_f1_score: 0.8241; train_kl_reg_loss: 17328.5002; train_edge_recon_loss: 38306.6602; train_gene_expr_recon_loss: 643860.4861; train_masked_gp_l1_reg_loss: 6258.1408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43636.0855; train_chrom_access_recon_loss: 430466.9549; train_global_loss: 1179856.8472; train_optim_loss: 1179856.8472; val_kl_reg_loss: 16138.5859; val_edge_recon_loss: 39950.4688; val_gene_expr_recon_loss: 633622.3750; val_masked_gp_l1_reg_loss: 6261.6084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42549.2617; val_chrom_access_recon_loss: 425889.2500; val_global_loss: 1164411.5000; val_optim_loss: 1164411.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9231; val_auprc_score: 0.9132; val_best_acc_score: 0.8270; val_best_f1_score: 0.8141; train_kl_reg_loss: 17152.3381; train_edge_recon_loss: 38245.4996; train_gene_expr_recon_loss: 643531.8611; train_masked_gp_l1_reg_loss: 6270.5709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41723.9258; train_chrom_access_recon_loss: 429165.7674; train_global_loss: 1176089.9722; train_optim_loss: 1176089.9722; val_kl_reg_loss: 16135.8232; val_edge_recon_loss: 39885.0781; val_gene_expr_recon_loss: 632294.2500; val_masked_gp_l1_reg_loss: 6272.3608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40701.4648; val_chrom_access_recon_loss: 425265.2500; val_global_loss: 1160554.2500; val_optim_loss: 1160554.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9314; val_auprc_score: 0.9254; val_best_acc_score: 0.8477; val_best_f1_score: 0.8603; train_kl_reg_loss: 14361.0053; train_edge_recon_loss: 40035.8372; train_gene_expr_recon_loss: 878539.1597; train_masked_gp_l1_reg_loss: 6374.1936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39815.7982; train_chrom_access_recon_loss: 454407.3090; train_global_loss: 1433533.2639; train_optim_loss: 1433533.2639; val_kl_reg_loss: 12065.7334; val_edge_recon_loss: 40383.5352; val_gene_expr_recon_loss: 863803.7500; val_masked_gp_l1_reg_loss: 6564.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38654.6172; val_chrom_access_recon_loss: 449893.2188; val_global_loss: 1411365.5000; val_optim_loss: 1411365.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9329; val_auprc_score: 0.9282; val_best_acc_score: 0.8511; val_best_f1_score: 0.8630; train_kl_reg_loss: 13000.0202; train_edge_recon_loss: 40110.8316; train_gene_expr_recon_loss: 872491.3472; train_masked_gp_l1_reg_loss: 6718.5301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37706.3685; train_chrom_access_recon_loss: 453890.3924; train_global_loss: 1423917.5000; train_optim_loss: 1423917.5000; val_kl_reg_loss: 11169.0977; val_edge_recon_loss: 40386.5742; val_gene_expr_recon_loss: 858210.2500; val_masked_gp_l1_reg_loss: 6893.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36537.0469; val_chrom_access_recon_loss: 449108.2500; val_global_loss: 1402304.3750; val_optim_loss: 1402304.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9355; val_auprc_score: 0.9290; val_best_acc_score: 0.8557; val_best_f1_score: 0.8661; train_kl_reg_loss: 12456.2904; train_edge_recon_loss: 40099.5981; train_gene_expr_recon_loss: 867752.5764; train_masked_gp_l1_reg_loss: 6999.1001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35638.7057; train_chrom_access_recon_loss: 453905.0799; train_global_loss: 1416851.3472; train_optim_loss: 1416851.3472; val_kl_reg_loss: 10811.2285; val_edge_recon_loss: 40366.2383; val_gene_expr_recon_loss: 853993.1250; val_masked_gp_l1_reg_loss: 7107.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34542.5547; val_chrom_access_recon_loss: 448501.0625; val_global_loss: 1395322.0000; val_optim_loss: 1395322.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9286; val_auprc_score: 0.9178; val_best_acc_score: 0.8517; val_best_f1_score: 0.8626; train_kl_reg_loss: 12064.6985; train_edge_recon_loss: 40085.5924; train_gene_expr_recon_loss: 866424.4722; train_masked_gp_l1_reg_loss: 7171.8650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33708.8668; train_chrom_access_recon_loss: 453027.3854; train_global_loss: 1412482.8889; train_optim_loss: 1412482.8889; val_kl_reg_loss: 10841.5674; val_edge_recon_loss: 40349.2969; val_gene_expr_recon_loss: 850322.1250; val_masked_gp_l1_reg_loss: 7236.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32694.4453; val_chrom_access_recon_loss: 447962.0625; val_global_loss: 1389406.3750; val_optim_loss: 1389406.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9337; val_auprc_score: 0.9232; val_best_acc_score: 0.8618; val_best_f1_score: 0.8709; train_kl_reg_loss: 11995.5791; train_edge_recon_loss: 40071.6037; train_gene_expr_recon_loss: 863072.2153; train_masked_gp_l1_reg_loss: 7204.5991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32579.7398; train_chrom_access_recon_loss: 454882.2396; train_global_loss: 1409805.9861; train_optim_loss: 1409805.9861; val_kl_reg_loss: 11043.6406; val_edge_recon_loss: 40347.2773; val_gene_expr_recon_loss: 849801.4375; val_masked_gp_l1_reg_loss: 7178.2202; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32440.2383; val_chrom_access_recon_loss: 447891.2500; val_global_loss: 1388702.1250; val_optim_loss: 1388702.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9350; val_auprc_score: 0.9222; val_best_acc_score: 0.8642; val_best_f1_score: 0.8729; train_kl_reg_loss: 12139.9380; train_edge_recon_loss: 40077.0508; train_gene_expr_recon_loss: 865396.6181; train_masked_gp_l1_reg_loss: 7173.3653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32342.9440; train_chrom_access_recon_loss: 453121.1875; train_global_loss: 1410251.1250; train_optim_loss: 1410251.1250; val_kl_reg_loss: 11039.0312; val_edge_recon_loss: 40345.7656; val_gene_expr_recon_loss: 849493.0000; val_masked_gp_l1_reg_loss: 7163.4956; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32220.5762; val_chrom_access_recon_loss: 447820.4062; val_global_loss: 1388082.2500; val_optim_loss: 1388082.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9323; val_auprc_score: 0.9238; val_best_acc_score: 0.8608; val_best_f1_score: 0.8699; train_kl_reg_loss: 11996.6678; train_edge_recon_loss: 40064.9019; train_gene_expr_recon_loss: 857861.5833; train_masked_gp_l1_reg_loss: 7158.8065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32127.9651; train_chrom_access_recon_loss: 451059.2396; train_global_loss: 1400269.1389; train_optim_loss: 1400269.1389; val_kl_reg_loss: 10945.4404; val_edge_recon_loss: 40340.7891; val_gene_expr_recon_loss: 849266.8750; val_masked_gp_l1_reg_loss: 7153.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32013.9180; val_chrom_access_recon_loss: 447783.8438; val_global_loss: 1387504.5000; val_optim_loss: 1387504.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9360; val_auprc_score: 0.9293; val_best_acc_score: 0.8641; val_best_f1_score: 0.8724; train_kl_reg_loss: 11989.9808; train_edge_recon_loss: 40063.3181; train_gene_expr_recon_loss: 859708.0625; train_masked_gp_l1_reg_loss: 7151.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31925.2515; train_chrom_access_recon_loss: 453754.4965; train_global_loss: 1404592.3194; train_optim_loss: 1404592.3194; val_kl_reg_loss: 10994.6172; val_edge_recon_loss: 40326.5312; val_gene_expr_recon_loss: 848963.1250; val_masked_gp_l1_reg_loss: 7148.8765; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31817.6016; val_chrom_access_recon_loss: 447769.9688; val_global_loss: 1387020.7500; val_optim_loss: 1387020.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9329
val AUPRC score: 0.9249
val best accuracy score: 0.8503
val best F1 score: 0.8634
val target rna MSE score: 3.8415
val source rna MSE score: 3.2556
val target atac MSE score: 0.1332
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
