[True]
Run timestamp: 09102023_215722_50.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_50']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7894; val_auprc_score: 0.8042; val_best_acc_score: 0.5255; val_best_f1_score: 0.6771; train_kl_reg_loss: 54225.3036; train_edge_recon_loss: 3508673.4637; train_gene_expr_recon_loss: 13371279.1985; train_masked_gp_l1_reg_loss: 88514.1586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1899879.0043; train_chrom_access_recon_loss: 2868587.8702; train_global_loss: 21791159.0076; train_optim_loss: 21791159.0076; val_kl_reg_loss: 85418.2531; val_edge_recon_loss: 4063336.7833; val_gene_expr_recon_loss: 12654045.1333; val_masked_gp_l1_reg_loss: 79673.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 412472.1562; val_chrom_access_recon_loss: 2781972.4833; val_global_loss: 20076918.1333; val_optim_loss: 20076918.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8435; val_auprc_score: 0.8507; val_best_acc_score: 0.7417; val_best_f1_score: 0.7488; train_kl_reg_loss: 73335.0895; train_edge_recon_loss: 3498096.2672; train_gene_expr_recon_loss: 12577467.8168; train_masked_gp_l1_reg_loss: 78299.3885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217152.6107; train_chrom_access_recon_loss: 2762030.7214; train_global_loss: 19206381.7710; train_optim_loss: 19206381.7710; val_kl_reg_loss: 73692.2188; val_edge_recon_loss: 3942150.7000; val_gene_expr_recon_loss: 12373352.2667; val_masked_gp_l1_reg_loss: 79422.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128171.8516; val_chrom_access_recon_loss: 2729773.7333; val_global_loss: 19326562.8000; val_optim_loss: 19326562.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8840; val_auprc_score: 0.8706; val_best_acc_score: 0.7955; val_best_f1_score: 0.8169; train_kl_reg_loss: 66844.2459; train_edge_recon_loss: 3155767.4924; train_gene_expr_recon_loss: 12440280.4198; train_masked_gp_l1_reg_loss: 89132.5817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103021.4534; train_chrom_access_recon_loss: 2733937.3607; train_global_loss: 18588983.6031; train_optim_loss: 18588983.6031; val_kl_reg_loss: 87178.9859; val_edge_recon_loss: 2913087.6500; val_gene_expr_recon_loss: 12372207.4000; val_masked_gp_l1_reg_loss: 96149.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88871.2266; val_chrom_access_recon_loss: 2737982.8667; val_global_loss: 18295477.8667; val_optim_loss: 18295477.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8975; val_auprc_score: 0.8804; val_best_acc_score: 0.8158; val_best_f1_score: 0.8323; train_kl_reg_loss: 88302.4976; train_edge_recon_loss: 2877741.0611; train_gene_expr_recon_loss: 12287332.0763; train_masked_gp_l1_reg_loss: 96321.6992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81854.9673; train_chrom_access_recon_loss: 2702870.6050; train_global_loss: 18134422.9924; train_optim_loss: 18134422.9924; val_kl_reg_loss: 90988.9646; val_edge_recon_loss: 2847923.5833; val_gene_expr_recon_loss: 12226933.0000; val_masked_gp_l1_reg_loss: 97171.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76975.1562; val_chrom_access_recon_loss: 2706574.9833; val_global_loss: 18046567.3333; val_optim_loss: 18046567.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9198; val_auprc_score: 0.9002; val_best_acc_score: 0.8534; val_best_f1_score: 0.8634; train_kl_reg_loss: 88903.4665; train_edge_recon_loss: 2833650.1603; train_gene_expr_recon_loss: 12159393.2977; train_masked_gp_l1_reg_loss: 97672.9285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73583.3562; train_chrom_access_recon_loss: 2677584.0782; train_global_loss: 17930787.2824; train_optim_loss: 17930787.2824; val_kl_reg_loss: 81655.8906; val_edge_recon_loss: 2816918.3000; val_gene_expr_recon_loss: 12104307.6000; val_masked_gp_l1_reg_loss: 98408.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70766.8828; val_chrom_access_recon_loss: 2685374.4167; val_global_loss: 17857431.0667; val_optim_loss: 17857431.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9224; val_auprc_score: 0.9042; val_best_acc_score: 0.8588; val_best_f1_score: 0.8690; train_kl_reg_loss: 86895.3999; train_edge_recon_loss: 2800839.3492; train_gene_expr_recon_loss: 12052849.4351; train_masked_gp_l1_reg_loss: 99488.3983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67742.6560; train_chrom_access_recon_loss: 2657631.0019; train_global_loss: 17765446.2672; train_optim_loss: 17765446.2672; val_kl_reg_loss: 85364.6542; val_edge_recon_loss: 2814295.4000; val_gene_expr_recon_loss: 11956422.7333; val_masked_gp_l1_reg_loss: 100759.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66097.9609; val_chrom_access_recon_loss: 2655681.5000; val_global_loss: 17678622.1333; val_optim_loss: 17678622.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9244; val_auprc_score: 0.9071; val_best_acc_score: 0.8527; val_best_f1_score: 0.8629; train_kl_reg_loss: 82322.7965; train_edge_recon_loss: 2789730.4008; train_gene_expr_recon_loss: 11963712.5725; train_masked_gp_l1_reg_loss: 101425.0747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63437.4847; train_chrom_access_recon_loss: 2639233.8760; train_global_loss: 17639862.0840; train_optim_loss: 17639862.0840; val_kl_reg_loss: 81750.5453; val_edge_recon_loss: 2809259.8833; val_gene_expr_recon_loss: 11903182.2667; val_masked_gp_l1_reg_loss: 102549.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62461.5508; val_chrom_access_recon_loss: 2648306.1833; val_global_loss: 17607510.7333; val_optim_loss: 17607510.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9407; val_auprc_score: 0.9266; val_best_acc_score: 0.8740; val_best_f1_score: 0.8805; train_kl_reg_loss: 82654.4079; train_edge_recon_loss: 2771938.4313; train_gene_expr_recon_loss: 11887650.7710; train_masked_gp_l1_reg_loss: 103302.0107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60638.4807; train_chrom_access_recon_loss: 2622319.2691; train_global_loss: 17528503.3817; train_optim_loss: 17528503.3817; val_kl_reg_loss: 83952.3427; val_edge_recon_loss: 2778605.4667; val_gene_expr_recon_loss: 11862060.0667; val_masked_gp_l1_reg_loss: 103796.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59437.3711; val_chrom_access_recon_loss: 2642351.4167; val_global_loss: 17530202.6667; val_optim_loss: 17530202.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9464; val_auprc_score: 0.9308; val_best_acc_score: 0.8800; val_best_f1_score: 0.8873; train_kl_reg_loss: 81704.1182; train_edge_recon_loss: 2748629.8664; train_gene_expr_recon_loss: 11824987.5038; train_masked_gp_l1_reg_loss: 104460.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58539.9070; train_chrom_access_recon_loss: 2606448.6107; train_global_loss: 17424770.2595; train_optim_loss: 17424770.2595; val_kl_reg_loss: 81805.8104; val_edge_recon_loss: 2754294.8667; val_gene_expr_recon_loss: 11763208.0000; val_masked_gp_l1_reg_loss: 105046.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57501.8555; val_chrom_access_recon_loss: 2605781.2833; val_global_loss: 17367638.9333; val_optim_loss: 17367638.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9463; val_auprc_score: 0.9360; val_best_acc_score: 0.8775; val_best_f1_score: 0.8837; train_kl_reg_loss: 81337.2690; train_edge_recon_loss: 2748067.2271; train_gene_expr_recon_loss: 11770608.5725; train_masked_gp_l1_reg_loss: 105368.4356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57057.8110; train_chrom_access_recon_loss: 2595298.1412; train_global_loss: 17357737.4656; train_optim_loss: 17357737.4656; val_kl_reg_loss: 80159.3911; val_edge_recon_loss: 2767265.8000; val_gene_expr_recon_loss: 11728310.6000; val_masked_gp_l1_reg_loss: 105697.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56730.4766; val_chrom_access_recon_loss: 2600198.2667; val_global_loss: 17338361.2000; val_optim_loss: 17338361.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9451; val_auprc_score: 0.9276; val_best_acc_score: 0.8837; val_best_f1_score: 0.8897; train_kl_reg_loss: 79884.1738; train_edge_recon_loss: 2743122.8626; train_gene_expr_recon_loss: 11719851.7710; train_masked_gp_l1_reg_loss: 106401.5047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56357.2245; train_chrom_access_recon_loss: 2581539.2462; train_global_loss: 17287156.8550; train_optim_loss: 17287156.8550; val_kl_reg_loss: 79024.0646; val_edge_recon_loss: 2756326.0333; val_gene_expr_recon_loss: 11640679.4667; val_masked_gp_l1_reg_loss: 106449.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56287.4492; val_chrom_access_recon_loss: 2576759.6167; val_global_loss: 17215525.2000; val_optim_loss: 17215525.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9492; val_auprc_score: 0.9359; val_best_acc_score: 0.8814; val_best_f1_score: 0.8879; train_kl_reg_loss: 79642.5533; train_edge_recon_loss: 2726007.8378; train_gene_expr_recon_loss: 11668400.6031; train_masked_gp_l1_reg_loss: 106901.4935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55902.2266; train_chrom_access_recon_loss: 2571000.0229; train_global_loss: 17207854.8168; train_optim_loss: 17207854.8168; val_kl_reg_loss: 80100.1031; val_edge_recon_loss: 2759191.3667; val_gene_expr_recon_loss: 11612716.3333; val_masked_gp_l1_reg_loss: 107273.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55380.9375; val_chrom_access_recon_loss: 2579484.9500; val_global_loss: 17194147.6000; val_optim_loss: 17194147.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9562; val_auprc_score: 0.9447; val_best_acc_score: 0.8965; val_best_f1_score: 0.9007; train_kl_reg_loss: 78695.3117; train_edge_recon_loss: 2730533.6412; train_gene_expr_recon_loss: 11632159.9008; train_masked_gp_l1_reg_loss: 107591.1847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55775.5279; train_chrom_access_recon_loss: 2560560.9027; train_global_loss: 17165316.5496; train_optim_loss: 17165316.5496; val_kl_reg_loss: 77691.5813; val_edge_recon_loss: 2726757.7833; val_gene_expr_recon_loss: 11575685.2667; val_masked_gp_l1_reg_loss: 107843.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56311.4062; val_chrom_access_recon_loss: 2563082.0833; val_global_loss: 17107370.8667; val_optim_loss: 17107370.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9540; val_auprc_score: 0.9412; val_best_acc_score: 0.8918; val_best_f1_score: 0.8970; train_kl_reg_loss: 77623.2523; train_edge_recon_loss: 2721150.3321; train_gene_expr_recon_loss: 11597201.9084; train_masked_gp_l1_reg_loss: 107892.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57610.4461; train_chrom_access_recon_loss: 2553455.1832; train_global_loss: 17114933.6794; train_optim_loss: 17114933.6794; val_kl_reg_loss: 78085.8448; val_edge_recon_loss: 2741913.6000; val_gene_expr_recon_loss: 11603837.4000; val_masked_gp_l1_reg_loss: 108272.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59414.5430; val_chrom_access_recon_loss: 2563518.9333; val_global_loss: 17155043.8000; val_optim_loss: 17155043.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9643; val_auprc_score: 0.9552; val_best_acc_score: 0.9093; val_best_f1_score: 0.9114; train_kl_reg_loss: 77549.2966; train_edge_recon_loss: 2717119.7271; train_gene_expr_recon_loss: 11552347.0687; train_masked_gp_l1_reg_loss: 108216.6388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59067.3460; train_chrom_access_recon_loss: 2544833.6183; train_global_loss: 17059133.6947; train_optim_loss: 17059133.6947; val_kl_reg_loss: 76831.9120; val_edge_recon_loss: 2691661.3667; val_gene_expr_recon_loss: 11532393.6667; val_masked_gp_l1_reg_loss: 108548.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59835.2422; val_chrom_access_recon_loss: 2545388.9667; val_global_loss: 17014659.1333; val_optim_loss: 17014659.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9592; val_auprc_score: 0.9471; val_best_acc_score: 0.9019; val_best_f1_score: 0.9064; train_kl_reg_loss: 76012.2648; train_edge_recon_loss: 2701380.2061; train_gene_expr_recon_loss: 11516290.3053; train_masked_gp_l1_reg_loss: 108611.0352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59449.1939; train_chrom_access_recon_loss: 2534289.4179; train_global_loss: 16996032.3435; train_optim_loss: 16996032.3435; val_kl_reg_loss: 78050.8161; val_edge_recon_loss: 2696433.4667; val_gene_expr_recon_loss: 11505553.2000; val_masked_gp_l1_reg_loss: 108738.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58865.9453; val_chrom_access_recon_loss: 2551128.8667; val_global_loss: 16998771.4667; val_optim_loss: 16998771.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9646; val_auprc_score: 0.9561; val_best_acc_score: 0.9105; val_best_f1_score: 0.9137; train_kl_reg_loss: 76482.7845; train_edge_recon_loss: 2709330.6050; train_gene_expr_recon_loss: 11497289.1908; train_masked_gp_l1_reg_loss: 108600.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58816.7024; train_chrom_access_recon_loss: 2530219.2366; train_global_loss: 16980738.5725; train_optim_loss: 16980738.5725; val_kl_reg_loss: 74914.0938; val_edge_recon_loss: 2722514.5833; val_gene_expr_recon_loss: 11505698.6667; val_masked_gp_l1_reg_loss: 109015.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59467.9492; val_chrom_access_recon_loss: 2546364.0667; val_global_loss: 17017975.4667; val_optim_loss: 17017975.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9620; val_auprc_score: 0.9511; val_best_acc_score: 0.9068; val_best_f1_score: 0.9085; train_kl_reg_loss: 75629.6626; train_edge_recon_loss: 2705620.2233; train_gene_expr_recon_loss: 11453405.3740; train_masked_gp_l1_reg_loss: 108910.3652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58644.9096; train_chrom_access_recon_loss: 2519723.2233; train_global_loss: 16921933.7557; train_optim_loss: 16921933.7557; val_kl_reg_loss: 75550.0151; val_edge_recon_loss: 2728600.5000; val_gene_expr_recon_loss: 11374000.9333; val_masked_gp_l1_reg_loss: 109140.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59057.9297; val_chrom_access_recon_loss: 2517531.4833; val_global_loss: 16863881.0000; val_optim_loss: 16863881.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9652; val_auprc_score: 0.9556; val_best_acc_score: 0.9099; val_best_f1_score: 0.9127; train_kl_reg_loss: 74316.5985; train_edge_recon_loss: 2700882.6298; train_gene_expr_recon_loss: 11434434.5802; train_masked_gp_l1_reg_loss: 109059.1929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58627.4949; train_chrom_access_recon_loss: 2514045.4599; train_global_loss: 16891366.0000; train_optim_loss: 16891366.0000; val_kl_reg_loss: 74126.7068; val_edge_recon_loss: 2712248.7333; val_gene_expr_recon_loss: 11370493.8667; val_masked_gp_l1_reg_loss: 109390.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58822.9414; val_chrom_access_recon_loss: 2510866.2667; val_global_loss: 16835948.6667; val_optim_loss: 16835948.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9716; val_auprc_score: 0.9637; val_best_acc_score: 0.9194; val_best_f1_score: 0.9210; train_kl_reg_loss: 74124.2480; train_edge_recon_loss: 2697559.2347; train_gene_expr_recon_loss: 11408507.3893; train_masked_gp_l1_reg_loss: 109115.4578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58656.5050; train_chrom_access_recon_loss: 2508174.3092; train_global_loss: 16856137.2061; train_optim_loss: 16856137.2061; val_kl_reg_loss: 74870.8948; val_edge_recon_loss: 2700493.9500; val_gene_expr_recon_loss: 11429014.8667; val_masked_gp_l1_reg_loss: 109007.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58510.1094; val_chrom_access_recon_loss: 2514131.0667; val_global_loss: 16886028.8000; val_optim_loss: 16886028.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9665; val_auprc_score: 0.9560; val_best_acc_score: 0.9148; val_best_f1_score: 0.9176; train_kl_reg_loss: 74138.1109; train_edge_recon_loss: 2699976.3359; train_gene_expr_recon_loss: 11396809.7328; train_masked_gp_l1_reg_loss: 108944.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58592.3993; train_chrom_access_recon_loss: 2503357.6870; train_global_loss: 16841818.6794; train_optim_loss: 16841818.6794; val_kl_reg_loss: 75699.0755; val_edge_recon_loss: 2719164.8500; val_gene_expr_recon_loss: 11386762.4667; val_masked_gp_l1_reg_loss: 109136.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58673.3008; val_chrom_access_recon_loss: 2506965.0000; val_global_loss: 16856400.3333; val_optim_loss: 16856400.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9674; val_auprc_score: 0.9583; val_best_acc_score: 0.9139; val_best_f1_score: 0.9169; train_kl_reg_loss: 74729.8347; train_edge_recon_loss: 2687713.7443; train_gene_expr_recon_loss: 11375717.7634; train_masked_gp_l1_reg_loss: 108969.5211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58639.5363; train_chrom_access_recon_loss: 2496915.5439; train_global_loss: 16802685.9389; train_optim_loss: 16802685.9389; val_kl_reg_loss: 74094.8943; val_edge_recon_loss: 2711741.7167; val_gene_expr_recon_loss: 11288653.8667; val_masked_gp_l1_reg_loss: 108959.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58600.7383; val_chrom_access_recon_loss: 2501068.7833; val_global_loss: 16743120.3333; val_optim_loss: 16743120.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9697; val_auprc_score: 0.9616; val_best_acc_score: 0.9190; val_best_f1_score: 0.9214; train_kl_reg_loss: 73318.3958; train_edge_recon_loss: 2687211.0019; train_gene_expr_recon_loss: 11359291.1832; train_masked_gp_l1_reg_loss: 108859.6371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58672.4318; train_chrom_access_recon_loss: 2492948.1031; train_global_loss: 16780300.7557; train_optim_loss: 16780300.7557; val_kl_reg_loss: 74205.8219; val_edge_recon_loss: 2696708.4000; val_gene_expr_recon_loss: 11304995.5333; val_masked_gp_l1_reg_loss: 109286.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58813.3125; val_chrom_access_recon_loss: 2489743.1500; val_global_loss: 16733752.0667; val_optim_loss: 16733752.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9691; val_auprc_score: 0.9587; val_best_acc_score: 0.9196; val_best_f1_score: 0.9225; train_kl_reg_loss: 73405.0375; train_edge_recon_loss: 2692501.0172; train_gene_expr_recon_loss: 11338289.6947; train_masked_gp_l1_reg_loss: 108843.2372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58549.0241; train_chrom_access_recon_loss: 2487974.3073; train_global_loss: 16759562.3130; train_optim_loss: 16759562.3130; val_kl_reg_loss: 73375.1708; val_edge_recon_loss: 2711294.9333; val_gene_expr_recon_loss: 11293966.8000; val_masked_gp_l1_reg_loss: 109079.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59094.2812; val_chrom_access_recon_loss: 2493680.8000; val_global_loss: 16740491.6000; val_optim_loss: 16740491.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9706; val_auprc_score: 0.9606; val_best_acc_score: 0.9221; val_best_f1_score: 0.9250; train_kl_reg_loss: 72527.3504; train_edge_recon_loss: 2689568.2176; train_gene_expr_recon_loss: 11321245.0076; train_masked_gp_l1_reg_loss: 108940.4223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58773.3198; train_chrom_access_recon_loss: 2481480.3550; train_global_loss: 16732534.6489; train_optim_loss: 16732534.6489; val_kl_reg_loss: 73406.9927; val_edge_recon_loss: 2713800.0000; val_gene_expr_recon_loss: 11302290.2667; val_masked_gp_l1_reg_loss: 109215.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59453.9531; val_chrom_access_recon_loss: 2493825.4833; val_global_loss: 16751991.7333; val_optim_loss: 16751991.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9692; val_auprc_score: 0.9598; val_best_acc_score: 0.9158; val_best_f1_score: 0.9183; train_kl_reg_loss: 91580.1948; train_edge_recon_loss: 2755334.0973; train_gene_expr_recon_loss: 10487884.6412; train_masked_gp_l1_reg_loss: 106787.0864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56014.7528; train_chrom_access_recon_loss: 2308785.3187; train_global_loss: 15806386.0763; train_optim_loss: 15806386.0763; val_kl_reg_loss: 33699.0072; val_edge_recon_loss: 2734834.8167; val_gene_expr_recon_loss: 10415770.4667; val_masked_gp_l1_reg_loss: 105764.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56439.6680; val_chrom_access_recon_loss: 2306322.6000; val_global_loss: 15652830.8000; val_optim_loss: 15652830.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9708; val_auprc_score: 0.9605; val_best_acc_score: 0.9210; val_best_f1_score: 0.9239; train_kl_reg_loss: 72625.8613; train_edge_recon_loss: 2708290.6031; train_gene_expr_recon_loss: 10446719.0763; train_masked_gp_l1_reg_loss: 104886.0227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56887.1479; train_chrom_access_recon_loss: 2298875.1250; train_global_loss: 15688283.8092; train_optim_loss: 15688283.8092; val_kl_reg_loss: 40661.4049; val_edge_recon_loss: 2709228.7833; val_gene_expr_recon_loss: 10412381.6667; val_masked_gp_l1_reg_loss: 103901.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57016.3594; val_chrom_access_recon_loss: 2293949.0667; val_global_loss: 15617138.8667; val_optim_loss: 15617138.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9687; val_auprc_score: 0.9582; val_best_acc_score: 0.9181; val_best_f1_score: 0.9206; train_kl_reg_loss: 65153.3375; train_edge_recon_loss: 2699499.9179; train_gene_expr_recon_loss: 10420688.4351; train_masked_gp_l1_reg_loss: 102650.1135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57273.6141; train_chrom_access_recon_loss: 2288588.1947; train_global_loss: 15633853.4962; train_optim_loss: 15633853.4962; val_kl_reg_loss: 45176.6172; val_edge_recon_loss: 2704436.3667; val_gene_expr_recon_loss: 10406488.0667; val_masked_gp_l1_reg_loss: 101363.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57254.8359; val_chrom_access_recon_loss: 2299294.2000; val_global_loss: 15614013.2000; val_optim_loss: 15614013.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9715; val_auprc_score: 0.9617; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 61287.8479; train_edge_recon_loss: 2697044.5782; train_gene_expr_recon_loss: 10401355.9160; train_masked_gp_l1_reg_loss: 100165.0598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57445.4784; train_chrom_access_recon_loss: 2285695.3197; train_global_loss: 15602994.1908; train_optim_loss: 15602994.1908; val_kl_reg_loss: 48386.5555; val_edge_recon_loss: 2655645.0667; val_gene_expr_recon_loss: 10386996.6667; val_masked_gp_l1_reg_loss: 98987.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57359.9219; val_chrom_access_recon_loss: 2285452.6167; val_global_loss: 15532828.7333; val_optim_loss: 15532828.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9688; val_auprc_score: 0.9571; val_best_acc_score: 0.9197; val_best_f1_score: 0.9221; train_kl_reg_loss: 60105.7639; train_edge_recon_loss: 2683095.1489; train_gene_expr_recon_loss: 10383441.0611; train_masked_gp_l1_reg_loss: 97772.6558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57434.5472; train_chrom_access_recon_loss: 2278972.0582; train_global_loss: 15560821.1679; train_optim_loss: 15560821.1679; val_kl_reg_loss: 47434.8307; val_edge_recon_loss: 2701812.8000; val_gene_expr_recon_loss: 10355020.5333; val_masked_gp_l1_reg_loss: 96747.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57400.6836; val_chrom_access_recon_loss: 2280545.6833; val_global_loss: 15538961.8667; val_optim_loss: 15538961.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9740; val_auprc_score: 0.9686; val_best_acc_score: 0.9259; val_best_f1_score: 0.9288; train_kl_reg_loss: 59228.9987; train_edge_recon_loss: 2687187.4771; train_gene_expr_recon_loss: 10375248.2748; train_masked_gp_l1_reg_loss: 96017.0026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57418.0025; train_chrom_access_recon_loss: 2276352.1851; train_global_loss: 15551451.8550; train_optim_loss: 15551451.8550; val_kl_reg_loss: 48821.4620; val_edge_recon_loss: 2680069.3333; val_gene_expr_recon_loss: 10387490.5333; val_masked_gp_l1_reg_loss: 95415.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57484.1758; val_chrom_access_recon_loss: 2283847.2500; val_global_loss: 15553127.4667; val_optim_loss: 15553127.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9711; val_auprc_score: 0.9604; val_best_acc_score: 0.9263; val_best_f1_score: 0.9287; train_kl_reg_loss: 59300.4775; train_edge_recon_loss: 2680156.2786; train_gene_expr_recon_loss: 10364237.6183; train_masked_gp_l1_reg_loss: 94777.6713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57409.4445; train_chrom_access_recon_loss: 2272738.1737; train_global_loss: 15528619.6336; train_optim_loss: 15528619.6336; val_kl_reg_loss: 51404.5669; val_edge_recon_loss: 2689643.7333; val_gene_expr_recon_loss: 10361436.6000; val_masked_gp_l1_reg_loss: 94286.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57426.7148; val_chrom_access_recon_loss: 2277745.8833; val_global_loss: 15531944.8000; val_optim_loss: 15531944.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9730; val_auprc_score: 0.9627; val_best_acc_score: 0.9267; val_best_f1_score: 0.9285; train_kl_reg_loss: 58608.7420; train_edge_recon_loss: 2680909.3263; train_gene_expr_recon_loss: 10349576.6718; train_masked_gp_l1_reg_loss: 93639.4281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57431.3019; train_chrom_access_recon_loss: 2269821.9008; train_global_loss: 15509987.4733; train_optim_loss: 15509987.4733; val_kl_reg_loss: 51610.3849; val_edge_recon_loss: 2687484.6667; val_gene_expr_recon_loss: 10378824.2667; val_masked_gp_l1_reg_loss: 93058.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57686.9297; val_chrom_access_recon_loss: 2283260.7000; val_global_loss: 15551924.9333; val_optim_loss: 15551924.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9704; val_auprc_score: 0.9588; val_best_acc_score: 0.9232; val_best_f1_score: 0.9259; train_kl_reg_loss: 57156.2348; train_edge_recon_loss: 2684753.2844; train_gene_expr_recon_loss: 10338444.7863; train_masked_gp_l1_reg_loss: 92636.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57557.7468; train_chrom_access_recon_loss: 2270305.7395; train_global_loss: 15500854.7099; train_optim_loss: 15500854.7099; val_kl_reg_loss: 52185.1076; val_edge_recon_loss: 2693320.7500; val_gene_expr_recon_loss: 10291208.4667; val_masked_gp_l1_reg_loss: 92073.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57143.9258; val_chrom_access_recon_loss: 2271233.3333; val_global_loss: 15457164.6667; val_optim_loss: 15457164.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9739; val_auprc_score: 0.9653; val_best_acc_score: 0.9243; val_best_f1_score: 0.9269; train_kl_reg_loss: 57655.1346; train_edge_recon_loss: 2677791.8034; train_gene_expr_recon_loss: 10318936.1832; train_masked_gp_l1_reg_loss: 91579.5126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57344.6364; train_chrom_access_recon_loss: 2263300.0821; train_global_loss: 15466607.2901; train_optim_loss: 15466607.2901; val_kl_reg_loss: 51071.6039; val_edge_recon_loss: 2704174.4167; val_gene_expr_recon_loss: 10271537.5333; val_masked_gp_l1_reg_loss: 91074.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57437.2695; val_chrom_access_recon_loss: 2267283.3833; val_global_loss: 15442578.0667; val_optim_loss: 15442578.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9729; val_auprc_score: 0.9633; val_best_acc_score: 0.9231; val_best_f1_score: 0.9247; train_kl_reg_loss: 56941.3417; train_edge_recon_loss: 2671383.4885; train_gene_expr_recon_loss: 10302003.3664; train_masked_gp_l1_reg_loss: 90612.2304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57372.4809; train_chrom_access_recon_loss: 2261149.7462; train_global_loss: 15439462.6718; train_optim_loss: 15439462.6718; val_kl_reg_loss: 51152.3224; val_edge_recon_loss: 2704043.6167; val_gene_expr_recon_loss: 10287699.8667; val_masked_gp_l1_reg_loss: 90189.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57468.9961; val_chrom_access_recon_loss: 2262783.3000; val_global_loss: 15453337.0000; val_optim_loss: 15453337.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9762; val_auprc_score: 0.9693; val_best_acc_score: 0.9298; val_best_f1_score: 0.9324; train_kl_reg_loss: 56918.2396; train_edge_recon_loss: 2672653.7385; train_gene_expr_recon_loss: 10285812.1908; train_masked_gp_l1_reg_loss: 89815.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57345.6307; train_chrom_access_recon_loss: 2261126.2261; train_global_loss: 15423671.5954; train_optim_loss: 15423671.5954; val_kl_reg_loss: 51905.7323; val_edge_recon_loss: 2672793.0000; val_gene_expr_recon_loss: 10257289.6667; val_masked_gp_l1_reg_loss: 89534.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57333.2383; val_chrom_access_recon_loss: 2253629.8583; val_global_loss: 15382485.9333; val_optim_loss: 15382485.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9745; val_auprc_score: 0.9662; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 57463.4031; train_edge_recon_loss: 2675618.3359; train_gene_expr_recon_loss: 10275695.0611; train_masked_gp_l1_reg_loss: 89027.3873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57143.4145; train_chrom_access_recon_loss: 2259238.9781; train_global_loss: 15414186.6107; train_optim_loss: 15414186.6107; val_kl_reg_loss: 54542.8266; val_edge_recon_loss: 2669201.7333; val_gene_expr_recon_loss: 10253796.4667; val_masked_gp_l1_reg_loss: 88526.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57102.0352; val_chrom_access_recon_loss: 2269600.7333; val_global_loss: 15392770.6000; val_optim_loss: 15392770.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9786; val_auprc_score: 0.9699; val_best_acc_score: 0.9360; val_best_f1_score: 0.9378; train_kl_reg_loss: 57442.9551; train_edge_recon_loss: 2670561.2786; train_gene_expr_recon_loss: 10274119.4656; train_masked_gp_l1_reg_loss: 88177.6217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57213.2773; train_chrom_access_recon_loss: 2255814.7805; train_global_loss: 15403329.3817; train_optim_loss: 15403329.3817; val_kl_reg_loss: 54994.6443; val_edge_recon_loss: 2662208.3500; val_gene_expr_recon_loss: 10265446.2667; val_masked_gp_l1_reg_loss: 87912.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57440.3008; val_chrom_access_recon_loss: 2270699.7667; val_global_loss: 15398701.0667; val_optim_loss: 15398701.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9739; val_auprc_score: 0.9660; val_best_acc_score: 0.9283; val_best_f1_score: 0.9308; train_kl_reg_loss: 57078.9747; train_edge_recon_loss: 2676678.1107; train_gene_expr_recon_loss: 10261580.7634; train_masked_gp_l1_reg_loss: 87583.6178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57211.1031; train_chrom_access_recon_loss: 2254184.7166; train_global_loss: 15394317.3130; train_optim_loss: 15394317.3130; val_kl_reg_loss: 51677.7151; val_edge_recon_loss: 2682227.2000; val_gene_expr_recon_loss: 10277670.0000; val_masked_gp_l1_reg_loss: 87423.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57194.8047; val_chrom_access_recon_loss: 2267104.1333; val_global_loss: 15423297.0667; val_optim_loss: 15423297.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9759; val_auprc_score: 0.9703; val_best_acc_score: 0.9297; val_best_f1_score: 0.9322; train_kl_reg_loss: 56053.5869; train_edge_recon_loss: 2666781.7653; train_gene_expr_recon_loss: 10260184.0000; train_masked_gp_l1_reg_loss: 87176.2076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57358.9050; train_chrom_access_recon_loss: 2254854.3216; train_global_loss: 15382408.8550; train_optim_loss: 15382408.8550; val_kl_reg_loss: 53207.7927; val_edge_recon_loss: 2705641.3333; val_gene_expr_recon_loss: 10214200.2667; val_masked_gp_l1_reg_loss: 87049.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57492.7578; val_chrom_access_recon_loss: 2248286.8333; val_global_loss: 15365878.2000; val_optim_loss: 15365878.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9775; val_auprc_score: 0.9690; val_best_acc_score: 0.9332; val_best_f1_score: 0.9351; train_kl_reg_loss: 56286.7192; train_edge_recon_loss: 2671699.2977; train_gene_expr_recon_loss: 10243661.5267; train_masked_gp_l1_reg_loss: 86733.2799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57412.7442; train_chrom_access_recon_loss: 2252033.0954; train_global_loss: 15367826.5954; train_optim_loss: 15367826.5954; val_kl_reg_loss: 52785.8961; val_edge_recon_loss: 2666543.3833; val_gene_expr_recon_loss: 10257364.2000; val_masked_gp_l1_reg_loss: 86524.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57470.0703; val_chrom_access_recon_loss: 2268479.9667; val_global_loss: 15389168.3333; val_optim_loss: 15389168.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9754; val_auprc_score: 0.9679; val_best_acc_score: 0.9287; val_best_f1_score: 0.9306; train_kl_reg_loss: 55749.5032; train_edge_recon_loss: 2665148.4905; train_gene_expr_recon_loss: 10236603.3359; train_masked_gp_l1_reg_loss: 86160.0879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57422.5217; train_chrom_access_recon_loss: 2249042.4542; train_global_loss: 15350126.3511; train_optim_loss: 15350126.3511; val_kl_reg_loss: 55172.8646; val_edge_recon_loss: 2674597.9000; val_gene_expr_recon_loss: 10195385.0667; val_masked_gp_l1_reg_loss: 85905.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57503.3125; val_chrom_access_recon_loss: 2262304.9000; val_global_loss: 15330869.7333; val_optim_loss: 15330869.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9747; val_auprc_score: 0.9662; val_best_acc_score: 0.9299; val_best_f1_score: 0.9316; train_kl_reg_loss: 54986.0317; train_edge_recon_loss: 2663669.3168; train_gene_expr_recon_loss: 10212499.7557; train_masked_gp_l1_reg_loss: 85551.4827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57459.2838; train_chrom_access_recon_loss: 2241938.4637; train_global_loss: 15316104.2595; train_optim_loss: 15316104.2595; val_kl_reg_loss: 54222.6026; val_edge_recon_loss: 2687460.4500; val_gene_expr_recon_loss: 10192955.3333; val_masked_gp_l1_reg_loss: 85180.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57496.2305; val_chrom_access_recon_loss: 2245667.1667; val_global_loss: 15322982.5333; val_optim_loss: 15322982.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9792; val_auprc_score: 0.9737; val_best_acc_score: 0.9376; val_best_f1_score: 0.9391; train_kl_reg_loss: 55459.0513; train_edge_recon_loss: 2662901.7863; train_gene_expr_recon_loss: 10203220.0458; train_masked_gp_l1_reg_loss: 84974.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57491.1072; train_chrom_access_recon_loss: 2240732.3931; train_global_loss: 15304778.9847; train_optim_loss: 15304778.9847; val_kl_reg_loss: 52067.7464; val_edge_recon_loss: 2679342.2667; val_gene_expr_recon_loss: 10195264.9333; val_masked_gp_l1_reg_loss: 84664.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57462.2305; val_chrom_access_recon_loss: 2245905.9833; val_global_loss: 15314706.8667; val_optim_loss: 15314706.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9787; val_auprc_score: 0.9728; val_best_acc_score: 0.9356; val_best_f1_score: 0.9368; train_kl_reg_loss: 55285.5259; train_edge_recon_loss: 2663149.8740; train_gene_expr_recon_loss: 10211787.0611; train_masked_gp_l1_reg_loss: 84544.4580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57373.9706; train_chrom_access_recon_loss: 2241156.3950; train_global_loss: 15313297.3130; train_optim_loss: 15313297.3130; val_kl_reg_loss: 54591.2823; val_edge_recon_loss: 2678126.8000; val_gene_expr_recon_loss: 10225065.5333; val_masked_gp_l1_reg_loss: 84517.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57357.9531; val_chrom_access_recon_loss: 2254155.4167; val_global_loss: 15353815.1333; val_optim_loss: 15353815.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9782; val_auprc_score: 0.9700; val_best_acc_score: 0.9382; val_best_f1_score: 0.9400; train_kl_reg_loss: 55101.5959; train_edge_recon_loss: 2662666.7385; train_gene_expr_recon_loss: 10198354.8321; train_masked_gp_l1_reg_loss: 84177.3916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57321.1741; train_chrom_access_recon_loss: 2239014.6918; train_global_loss: 15296636.4733; train_optim_loss: 15296636.4733; val_kl_reg_loss: 52939.2888; val_edge_recon_loss: 2669739.0667; val_gene_expr_recon_loss: 10177381.7333; val_masked_gp_l1_reg_loss: 84003.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57346.7656; val_chrom_access_recon_loss: 2240242.1000; val_global_loss: 15281652.2667; val_optim_loss: 15281652.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9791; val_auprc_score: 0.9714; val_best_acc_score: 0.9399; val_best_f1_score: 0.9414; train_kl_reg_loss: 55119.8238; train_edge_recon_loss: 2663187.2118; train_gene_expr_recon_loss: 10188424.0000; train_masked_gp_l1_reg_loss: 83832.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57368.5074; train_chrom_access_recon_loss: 2235972.6116; train_global_loss: 15283904.8779; train_optim_loss: 15283904.8779; val_kl_reg_loss: 53430.4492; val_edge_recon_loss: 2676420.2833; val_gene_expr_recon_loss: 10164148.6667; val_masked_gp_l1_reg_loss: 83707.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57656.3789; val_chrom_access_recon_loss: 2249150.1333; val_global_loss: 15284512.7333; val_optim_loss: 15284512.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9790; val_auprc_score: 0.9726; val_best_acc_score: 0.9352; val_best_f1_score: 0.9368; train_kl_reg_loss: 54367.9454; train_edge_recon_loss: 2660066.3454; train_gene_expr_recon_loss: 10192693.3053; train_masked_gp_l1_reg_loss: 83476.5377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57543.1240; train_chrom_access_recon_loss: 2236905.0143; train_global_loss: 15285052.2366; train_optim_loss: 15285052.2366; val_kl_reg_loss: 53588.8552; val_edge_recon_loss: 2693044.7167; val_gene_expr_recon_loss: 10169762.4667; val_masked_gp_l1_reg_loss: 83399.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57438.3125; val_chrom_access_recon_loss: 2243049.5167; val_global_loss: 15300283.6000; val_optim_loss: 15300283.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9796; val_auprc_score: 0.9724; val_best_acc_score: 0.9400; val_best_f1_score: 0.9419; train_kl_reg_loss: 54080.5874; train_edge_recon_loss: 2669082.2748; train_gene_expr_recon_loss: 10194311.0153; train_masked_gp_l1_reg_loss: 83159.2136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57399.4545; train_chrom_access_recon_loss: 2237349.5906; train_global_loss: 15295382.1374; train_optim_loss: 15295382.1374; val_kl_reg_loss: 50874.5799; val_edge_recon_loss: 2669689.7333; val_gene_expr_recon_loss: 10206290.6667; val_masked_gp_l1_reg_loss: 83021.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57646.4766; val_chrom_access_recon_loss: 2241469.9333; val_global_loss: 15308992.9333; val_optim_loss: 15308992.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9788; val_auprc_score: 0.9711; val_best_acc_score: 0.9369; val_best_f1_score: 0.9388; train_kl_reg_loss: 54654.8155; train_edge_recon_loss: 2658733.6412; train_gene_expr_recon_loss: 10189137.2137; train_masked_gp_l1_reg_loss: 82775.4882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57537.2307; train_chrom_access_recon_loss: 2236827.9151; train_global_loss: 15279666.3359; train_optim_loss: 15279666.3359; val_kl_reg_loss: 53947.9891; val_edge_recon_loss: 2661202.7667; val_gene_expr_recon_loss: 10199490.7333; val_masked_gp_l1_reg_loss: 82662.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57596.4102; val_chrom_access_recon_loss: 2245570.9333; val_global_loss: 15300471.6000; val_optim_loss: 15300471.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9791; val_auprc_score: 0.9715; val_best_acc_score: 0.9404; val_best_f1_score: 0.9424; train_kl_reg_loss: 55382.1871; train_edge_recon_loss: 2661411.2824; train_gene_expr_recon_loss: 10170370.9084; train_masked_gp_l1_reg_loss: 80586.4456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48552.4805; train_chrom_access_recon_loss: 2233667.4313; train_global_loss: 15249970.7710; train_optim_loss: 15249970.7710; val_kl_reg_loss: 54662.7268; val_edge_recon_loss: 2667909.8500; val_gene_expr_recon_loss: 10163840.5333; val_masked_gp_l1_reg_loss: 80131.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47161.6797; val_chrom_access_recon_loss: 2246603.5000; val_global_loss: 15260309.8000; val_optim_loss: 15260309.8000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9811; val_auprc_score: 0.9749; val_best_acc_score: 0.9422; val_best_f1_score: 0.9438; train_kl_reg_loss: 56607.6970; train_edge_recon_loss: 2659489.2195; train_gene_expr_recon_loss: 10172274.6947; train_masked_gp_l1_reg_loss: 80043.7650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46828.1223; train_chrom_access_recon_loss: 2234629.1842; train_global_loss: 15249872.7099; train_optim_loss: 15249872.7099; val_kl_reg_loss: 55395.9437; val_edge_recon_loss: 2636125.5833; val_gene_expr_recon_loss: 10126095.1333; val_masked_gp_l1_reg_loss: 79968.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46510.1758; val_chrom_access_recon_loss: 2240330.0833; val_global_loss: 15184424.8667; val_optim_loss: 15184424.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9798; val_auprc_score: 0.9731; val_best_acc_score: 0.9413; val_best_f1_score: 0.9431; train_kl_reg_loss: 56809.3234; train_edge_recon_loss: 2661585.0821; train_gene_expr_recon_loss: 10175047.7863; train_masked_gp_l1_reg_loss: 79901.1876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46319.1117; train_chrom_access_recon_loss: 2233008.3483; train_global_loss: 15252670.8321; train_optim_loss: 15252670.8321; val_kl_reg_loss: 56132.4336; val_edge_recon_loss: 2667462.8333; val_gene_expr_recon_loss: 10120572.5333; val_masked_gp_l1_reg_loss: 79840.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46065.8281; val_chrom_access_recon_loss: 2233507.7833; val_global_loss: 15203581.5333; val_optim_loss: 15203581.5333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9810; val_auprc_score: 0.9761; val_best_acc_score: 0.9430; val_best_f1_score: 0.9446; train_kl_reg_loss: 57123.0945; train_edge_recon_loss: 2660765.7863; train_gene_expr_recon_loss: 10167705.9237; train_masked_gp_l1_reg_loss: 79810.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45886.4430; train_chrom_access_recon_loss: 2233348.7653; train_global_loss: 15244640.0458; train_optim_loss: 15244640.0458; val_kl_reg_loss: 56161.5867; val_edge_recon_loss: 2669267.6000; val_gene_expr_recon_loss: 10164929.4667; val_masked_gp_l1_reg_loss: 79772.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45813.8125; val_chrom_access_recon_loss: 2248112.9000; val_global_loss: 15264058.5333; val_optim_loss: 15264058.5333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9807; val_auprc_score: 0.9730; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 57240.5307; train_edge_recon_loss: 2651513.9160; train_gene_expr_recon_loss: 10162204.9237; train_masked_gp_l1_reg_loss: 79727.6466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45612.9921; train_chrom_access_recon_loss: 2233045.9580; train_global_loss: 15229345.9771; train_optim_loss: 15229345.9771; val_kl_reg_loss: 56019.1677; val_edge_recon_loss: 2669610.4833; val_gene_expr_recon_loss: 10138634.2667; val_masked_gp_l1_reg_loss: 79688.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45476.5508; val_chrom_access_recon_loss: 2236229.4667; val_global_loss: 15225659.4000; val_optim_loss: 15225659.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9795; val_auprc_score: 0.9712; val_best_acc_score: 0.9410; val_best_f1_score: 0.9428; train_kl_reg_loss: 56833.2476; train_edge_recon_loss: 2658154.5687; train_gene_expr_recon_loss: 10155913.7328; train_masked_gp_l1_reg_loss: 79651.9643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45374.9883; train_chrom_access_recon_loss: 2233104.9103; train_global_loss: 15229033.4580; train_optim_loss: 15229033.4580; val_kl_reg_loss: 55950.7396; val_edge_recon_loss: 2669953.7333; val_gene_expr_recon_loss: 10118940.0667; val_masked_gp_l1_reg_loss: 79646.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45256.1367; val_chrom_access_recon_loss: 2237957.6500; val_global_loss: 15207705.2000; val_optim_loss: 15207705.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9779; val_auprc_score: 0.9698; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 57306.8754; train_edge_recon_loss: 2648459.8130; train_gene_expr_recon_loss: 10146983.0534; train_masked_gp_l1_reg_loss: 79437.3079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44333.5535; train_chrom_access_recon_loss: 2231246.3702; train_global_loss: 15207767.0153; train_optim_loss: 15207767.0153; val_kl_reg_loss: 56017.3187; val_edge_recon_loss: 2684387.4667; val_gene_expr_recon_loss: 10098185.6667; val_masked_gp_l1_reg_loss: 79384.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44197.2969; val_chrom_access_recon_loss: 2236027.2833; val_global_loss: 15198198.5333; val_optim_loss: 15198198.5333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9784; val_auprc_score: 0.9700; val_best_acc_score: 0.9395; val_best_f1_score: 0.9412; train_kl_reg_loss: 57323.4306; train_edge_recon_loss: 2653263.3779; train_gene_expr_recon_loss: 10154623.9847; train_masked_gp_l1_reg_loss: 79364.1158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44156.0731; train_chrom_access_recon_loss: 2232592.7824; train_global_loss: 15221323.7023; train_optim_loss: 15221323.7023; val_kl_reg_loss: 56312.3099; val_edge_recon_loss: 2660184.5833; val_gene_expr_recon_loss: 10134831.6000; val_masked_gp_l1_reg_loss: 79348.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44115.6133; val_chrom_access_recon_loss: 2235054.7917; val_global_loss: 15209848.0667; val_optim_loss: 15209848.0667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9773; val_auprc_score: 0.9641; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 57565.4138; train_edge_recon_loss: 2650229.4695; train_gene_expr_recon_loss: 10151391.3817; train_masked_gp_l1_reg_loss: 79337.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44085.3157; train_chrom_access_recon_loss: 2234457.3292; train_global_loss: 15217066.0992; train_optim_loss: 15217066.0992; val_kl_reg_loss: 56246.9961; val_edge_recon_loss: 2660455.1667; val_gene_expr_recon_loss: 10129186.6000; val_masked_gp_l1_reg_loss: 79325.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44053.7344; val_chrom_access_recon_loss: 2244737.5333; val_global_loss: 15214006.1333; val_optim_loss: 15214006.1333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9801; val_auprc_score: 0.9740; val_best_acc_score: 0.9394; val_best_f1_score: 0.9415; train_kl_reg_loss: 57728.6895; train_edge_recon_loss: 2658025.0191; train_gene_expr_recon_loss: 10151921.5954; train_masked_gp_l1_reg_loss: 79316.3387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44029.1830; train_chrom_access_recon_loss: 2233023.8349; train_global_loss: 15224044.5802; train_optim_loss: 15224044.5802; val_kl_reg_loss: 56217.2289; val_edge_recon_loss: 2663309.7667; val_gene_expr_recon_loss: 10146872.0667; val_masked_gp_l1_reg_loss: 79305.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44007.6680; val_chrom_access_recon_loss: 2242434.9083; val_global_loss: 15232146.8667; val_optim_loss: 15232146.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 58 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9782
val AUPRC score: 0.9715
val best accuracy score: 0.9352
val best F1 score: 0.9375
val target rna MSE score: 1.5857
val source rna MSE score: 0.4883
val target atac MSE score: 0.4843
val source atac MSE score: 0.1501
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
