[True]
Run timestamp: 10102023_113824_253.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_253']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7803; val_auprc_score: 0.8004; val_best_acc_score: 0.5410; val_best_f1_score: 0.6827; train_kl_reg_loss: 76430.1100; train_edge_recon_loss: 756581.4313; train_gene_expr_recon_loss: 22156808.3664; train_masked_gp_l1_reg_loss: 60639.0684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3973185.9394; train_chrom_access_recon_loss: 11104383.5954; train_global_loss: 38128028.4885; train_optim_loss: 38128028.4885; val_kl_reg_loss: 85797.6458; val_edge_recon_loss: 812495.2542; val_gene_expr_recon_loss: 21335449.8667; val_masked_gp_l1_reg_loss: 65650.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 905671.0625; val_chrom_access_recon_loss: 10988658.0667; val_global_loss: 34193722.4000; val_optim_loss: 34193722.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8473; val_auprc_score: 0.8561; val_best_acc_score: 0.7648; val_best_f1_score: 0.7613; train_kl_reg_loss: 81493.3049; train_edge_recon_loss: 737114.2171; train_gene_expr_recon_loss: 20851588.9160; train_masked_gp_l1_reg_loss: 66227.8881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 472874.3058; train_chrom_access_recon_loss: 10736192.5725; train_global_loss: 32945491.1450; train_optim_loss: 32945491.1450; val_kl_reg_loss: 80476.4573; val_edge_recon_loss: 803706.1167; val_gene_expr_recon_loss: 21093922.1333; val_masked_gp_l1_reg_loss: 67273.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 280942.8750; val_chrom_access_recon_loss: 10908067.6667; val_global_loss: 33234388.2667; val_optim_loss: 33234388.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9141; val_auprc_score: 0.9069; val_best_acc_score: 0.8335; val_best_f1_score: 0.8460; train_kl_reg_loss: 68716.2054; train_edge_recon_loss: 717193.3545; train_gene_expr_recon_loss: 20610106.3817; train_masked_gp_l1_reg_loss: 68924.6332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228678.1854; train_chrom_access_recon_loss: 10613606.0305; train_global_loss: 32307224.9466; train_optim_loss: 32307224.9466; val_kl_reg_loss: 65692.6935; val_edge_recon_loss: 716566.4625; val_gene_expr_recon_loss: 20774130.8000; val_masked_gp_l1_reg_loss: 71037.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199536.3125; val_chrom_access_recon_loss: 10745398.6000; val_global_loss: 32572362.2667; val_optim_loss: 32572362.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9202; val_auprc_score: 0.9113; val_best_acc_score: 0.8447; val_best_f1_score: 0.8523; train_kl_reg_loss: 73564.4259; train_edge_recon_loss: 651657.5305; train_gene_expr_recon_loss: 20335253.4046; train_masked_gp_l1_reg_loss: 73024.4820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184686.9435; train_chrom_access_recon_loss: 10483186.9542; train_global_loss: 31801373.8931; train_optim_loss: 31801373.8931; val_kl_reg_loss: 79899.7646; val_edge_recon_loss: 631919.7708; val_gene_expr_recon_loss: 20565272.6667; val_masked_gp_l1_reg_loss: 75153.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173303.6250; val_chrom_access_recon_loss: 10603285.0667; val_global_loss: 32128835.3333; val_optim_loss: 32128835.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9282; val_auprc_score: 0.9156; val_best_acc_score: 0.8518; val_best_f1_score: 0.8611; train_kl_reg_loss: 77281.1508; train_edge_recon_loss: 620765.6889; train_gene_expr_recon_loss: 20154965.1603; train_masked_gp_l1_reg_loss: 76543.2448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163233.4324; train_chrom_access_recon_loss: 10418306.8855; train_global_loss: 31511095.4962; train_optim_loss: 31511095.4962; val_kl_reg_loss: 75106.4797; val_edge_recon_loss: 616876.3583; val_gene_expr_recon_loss: 20468264.8000; val_masked_gp_l1_reg_loss: 77887.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153528.9062; val_chrom_access_recon_loss: 10611472.5333; val_global_loss: 32003136.0000; val_optim_loss: 32003136.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9326; val_auprc_score: 0.9189; val_best_acc_score: 0.8556; val_best_f1_score: 0.8649; train_kl_reg_loss: 74916.1008; train_edge_recon_loss: 610152.5219; train_gene_expr_recon_loss: 19983919.5725; train_masked_gp_l1_reg_loss: 78754.9061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147372.6464; train_chrom_access_recon_loss: 10345321.6565; train_global_loss: 31240437.4962; train_optim_loss: 31240437.4962; val_kl_reg_loss: 72271.1708; val_edge_recon_loss: 607811.9000; val_gene_expr_recon_loss: 20219780.1333; val_masked_gp_l1_reg_loss: 79812.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142273.7656; val_chrom_access_recon_loss: 10419789.2000; val_global_loss: 31541738.4000; val_optim_loss: 31541738.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9338; val_auprc_score: 0.9208; val_best_acc_score: 0.8610; val_best_f1_score: 0.8683; train_kl_reg_loss: 72346.0696; train_edge_recon_loss: 604988.8015; train_gene_expr_recon_loss: 19855780.7176; train_masked_gp_l1_reg_loss: 80611.9667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137018.2705; train_chrom_access_recon_loss: 10262005.9389; train_global_loss: 31012751.8931; train_optim_loss: 31012751.8931; val_kl_reg_loss: 71864.0552; val_edge_recon_loss: 610952.8667; val_gene_expr_recon_loss: 20042556.5333; val_masked_gp_l1_reg_loss: 81459.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132647.5000; val_chrom_access_recon_loss: 10390106.6667; val_global_loss: 31329588.1333; val_optim_loss: 31329588.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9413; val_auprc_score: 0.9299; val_best_acc_score: 0.8716; val_best_f1_score: 0.8765; train_kl_reg_loss: 70334.1153; train_edge_recon_loss: 602545.4389; train_gene_expr_recon_loss: 19725706.2748; train_masked_gp_l1_reg_loss: 81913.8816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130286.1693; train_chrom_access_recon_loss: 10203509.0076; train_global_loss: 30814294.9466; train_optim_loss: 30814294.9466; val_kl_reg_loss: 69647.3266; val_edge_recon_loss: 601349.7792; val_gene_expr_recon_loss: 19906899.6000; val_masked_gp_l1_reg_loss: 82721.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129080.6875; val_chrom_access_recon_loss: 10337498.0667; val_global_loss: 31127196.6667; val_optim_loss: 31127196.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9448; val_auprc_score: 0.9353; val_best_acc_score: 0.8739; val_best_f1_score: 0.8804; train_kl_reg_loss: 68322.4720; train_edge_recon_loss: 598968.4742; train_gene_expr_recon_loss: 19622268.8550; train_masked_gp_l1_reg_loss: 82973.7219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126196.1014; train_chrom_access_recon_loss: 10155678.4962; train_global_loss: 30654408.2137; train_optim_loss: 30654408.2137; val_kl_reg_loss: 67175.6792; val_edge_recon_loss: 599735.0375; val_gene_expr_recon_loss: 19864210.6667; val_masked_gp_l1_reg_loss: 83678.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125261.3047; val_chrom_access_recon_loss: 10314048.6000; val_global_loss: 31054110.1333; val_optim_loss: 31054110.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9559; val_auprc_score: 0.9489; val_best_acc_score: 0.8914; val_best_f1_score: 0.8950; train_kl_reg_loss: 67320.4112; train_edge_recon_loss: 594956.0320; train_gene_expr_recon_loss: 19522363.3893; train_masked_gp_l1_reg_loss: 84013.3932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122908.2572; train_chrom_access_recon_loss: 10102208.9618; train_global_loss: 30493770.3969; train_optim_loss: 30493770.3969; val_kl_reg_loss: 67102.3469; val_edge_recon_loss: 595870.6042; val_gene_expr_recon_loss: 19786701.4667; val_masked_gp_l1_reg_loss: 84458.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121545.5625; val_chrom_access_recon_loss: 10231506.8000; val_global_loss: 30887185.2000; val_optim_loss: 30887185.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9575; val_auprc_score: 0.9494; val_best_acc_score: 0.8918; val_best_f1_score: 0.8967; train_kl_reg_loss: 66029.3189; train_edge_recon_loss: 594034.5740; train_gene_expr_recon_loss: 19411025.7099; train_masked_gp_l1_reg_loss: 84797.6119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119926.5601; train_chrom_access_recon_loss: 10046150.1145; train_global_loss: 30321963.9847; train_optim_loss: 30321963.9847; val_kl_reg_loss: 66483.7000; val_edge_recon_loss: 594995.2375; val_gene_expr_recon_loss: 19716265.0667; val_masked_gp_l1_reg_loss: 85172.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118680.8594; val_chrom_access_recon_loss: 10237994.4000; val_global_loss: 30819590.4000; val_optim_loss: 30819590.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9568; val_auprc_score: 0.9475; val_best_acc_score: 0.8954; val_best_f1_score: 0.8991; train_kl_reg_loss: 65215.4390; train_edge_recon_loss: 591162.3569; train_gene_expr_recon_loss: 19344869.8015; train_masked_gp_l1_reg_loss: 85522.2352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117139.3683; train_chrom_access_recon_loss: 10005856.1527; train_global_loss: 30209765.1756; train_optim_loss: 30209765.1756; val_kl_reg_loss: 64929.6198; val_edge_recon_loss: 593625.1417; val_gene_expr_recon_loss: 19557148.4000; val_masked_gp_l1_reg_loss: 85914.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116807.0625; val_chrom_access_recon_loss: 10127320.3333; val_global_loss: 30545745.3333; val_optim_loss: 30545745.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9638; val_auprc_score: 0.9572; val_best_acc_score: 0.9078; val_best_f1_score: 0.9109; train_kl_reg_loss: 64606.5891; train_edge_recon_loss: 589012.2772; train_gene_expr_recon_loss: 19269801.9237; train_masked_gp_l1_reg_loss: 86192.6767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114881.7483; train_chrom_access_recon_loss: 9940652.8015; train_global_loss: 30065148.0458; train_optim_loss: 30065148.0458; val_kl_reg_loss: 65096.0604; val_edge_recon_loss: 587862.4250; val_gene_expr_recon_loss: 19502396.0000; val_masked_gp_l1_reg_loss: 86580.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114689.9531; val_chrom_access_recon_loss: 10121039.5333; val_global_loss: 30477663.8667; val_optim_loss: 30477663.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9625; val_auprc_score: 0.9553; val_best_acc_score: 0.9043; val_best_f1_score: 0.9081; train_kl_reg_loss: 64093.5296; train_edge_recon_loss: 585741.5510; train_gene_expr_recon_loss: 19202640.8550; train_masked_gp_l1_reg_loss: 86917.9204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112940.7312; train_chrom_access_recon_loss: 9900026.5420; train_global_loss: 29952361.1298; train_optim_loss: 29952361.1298; val_kl_reg_loss: 64707.7729; val_edge_recon_loss: 588384.7083; val_gene_expr_recon_loss: 19507774.5333; val_masked_gp_l1_reg_loss: 87253.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112305.9688; val_chrom_access_recon_loss: 10076531.1333; val_global_loss: 30436958.2667; val_optim_loss: 30436958.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9607; val_auprc_score: 0.9498; val_best_acc_score: 0.9051; val_best_f1_score: 0.9086; train_kl_reg_loss: 63228.0424; train_edge_recon_loss: 586301.9394; train_gene_expr_recon_loss: 19140426.5954; train_masked_gp_l1_reg_loss: 87651.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111213.3552; train_chrom_access_recon_loss: 9863750.2672; train_global_loss: 29852571.1603; train_optim_loss: 29852571.1603; val_kl_reg_loss: 63707.7992; val_edge_recon_loss: 588462.9583; val_gene_expr_recon_loss: 19482112.1333; val_masked_gp_l1_reg_loss: 87932.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110490.1094; val_chrom_access_recon_loss: 10053771.4667; val_global_loss: 30386476.1333; val_optim_loss: 30386476.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9636; val_auprc_score: 0.9555; val_best_acc_score: 0.9074; val_best_f1_score: 0.9104; train_kl_reg_loss: 62454.9387; train_edge_recon_loss: 584560.4060; train_gene_expr_recon_loss: 19091859.8321; train_masked_gp_l1_reg_loss: 88368.3430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109770.4798; train_chrom_access_recon_loss: 9829138.6336; train_global_loss: 29766152.4733; train_optim_loss: 29766152.4733; val_kl_reg_loss: 63075.3745; val_edge_recon_loss: 585892.8667; val_gene_expr_recon_loss: 19399118.0000; val_masked_gp_l1_reg_loss: 88706.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110625.6875; val_chrom_access_recon_loss: 10035835.9333; val_global_loss: 30283254.4000; val_optim_loss: 30283254.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9657; val_auprc_score: 0.9572; val_best_acc_score: 0.9123; val_best_f1_score: 0.9146; train_kl_reg_loss: 61597.4252; train_edge_recon_loss: 584992.7867; train_gene_expr_recon_loss: 19052782.5496; train_masked_gp_l1_reg_loss: 88991.5309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108929.3795; train_chrom_access_recon_loss: 9786179.4351; train_global_loss: 29683472.9008; train_optim_loss: 29683472.9008; val_kl_reg_loss: 61261.4732; val_edge_recon_loss: 586317.6958; val_gene_expr_recon_loss: 19287225.6000; val_masked_gp_l1_reg_loss: 89402.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109161.6250; val_chrom_access_recon_loss: 9918628.2000; val_global_loss: 30051997.0667; val_optim_loss: 30051997.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9641; val_auprc_score: 0.9556; val_best_acc_score: 0.9123; val_best_f1_score: 0.9154; train_kl_reg_loss: 61338.9538; train_edge_recon_loss: 583748.5515; train_gene_expr_recon_loss: 18982447.9237; train_masked_gp_l1_reg_loss: 89647.5977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108032.4088; train_chrom_access_recon_loss: 9733191.8321; train_global_loss: 29558407.3130; train_optim_loss: 29558407.3130; val_kl_reg_loss: 60974.3969; val_edge_recon_loss: 587202.3500; val_gene_expr_recon_loss: 19295760.1333; val_masked_gp_l1_reg_loss: 90189.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108547.8203; val_chrom_access_recon_loss: 9920325.5333; val_global_loss: 30063000.2667; val_optim_loss: 30063000.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9640; val_auprc_score: 0.9540; val_best_acc_score: 0.9070; val_best_f1_score: 0.9100; train_kl_reg_loss: 60662.1249; train_edge_recon_loss: 582408.3774; train_gene_expr_recon_loss: 18919353.2214; train_masked_gp_l1_reg_loss: 90459.8583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107569.3418; train_chrom_access_recon_loss: 9680251.6412; train_global_loss: 29440704.5496; train_optim_loss: 29440704.5496; val_kl_reg_loss: 60457.7760; val_edge_recon_loss: 587937.2333; val_gene_expr_recon_loss: 19216977.0667; val_masked_gp_l1_reg_loss: 90944.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107786.2266; val_chrom_access_recon_loss: 9889471.4667; val_global_loss: 29953573.4667; val_optim_loss: 29953573.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9659; val_auprc_score: 0.9566; val_best_acc_score: 0.9124; val_best_f1_score: 0.9163; train_kl_reg_loss: 60234.7317; train_edge_recon_loss: 582707.5673; train_gene_expr_recon_loss: 18873447.0992; train_masked_gp_l1_reg_loss: 91166.8371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107178.8177; train_chrom_access_recon_loss: 9645403.9618; train_global_loss: 29360138.9924; train_optim_loss: 29360138.9924; val_kl_reg_loss: 61668.5727; val_edge_recon_loss: 589390.5292; val_gene_expr_recon_loss: 19135537.6000; val_masked_gp_l1_reg_loss: 91476.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107481.5469; val_chrom_access_recon_loss: 9802335.6667; val_global_loss: 29787890.1333; val_optim_loss: 29787890.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9695; val_auprc_score: 0.9620; val_best_acc_score: 0.9173; val_best_f1_score: 0.9203; train_kl_reg_loss: 60031.4204; train_edge_recon_loss: 583127.9566; train_gene_expr_recon_loss: 18833881.4504; train_masked_gp_l1_reg_loss: 91962.8590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106901.7239; train_chrom_access_recon_loss: 9597757.2977; train_global_loss: 29273662.8092; train_optim_loss: 29273662.8092; val_kl_reg_loss: 60950.0768; val_edge_recon_loss: 582213.6417; val_gene_expr_recon_loss: 19104607.0667; val_masked_gp_l1_reg_loss: 92292.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106847.0000; val_chrom_access_recon_loss: 9843691.5333; val_global_loss: 29790601.7333; val_optim_loss: 29790601.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9715; val_auprc_score: 0.9647; val_best_acc_score: 0.9159; val_best_f1_score: 0.9194; train_kl_reg_loss: 59524.3034; train_edge_recon_loss: 584722.7891; train_gene_expr_recon_loss: 18778891.4809; train_masked_gp_l1_reg_loss: 92666.7070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106671.9369; train_chrom_access_recon_loss: 9558920.0038; train_global_loss: 29181397.3130; train_optim_loss: 29181397.3130; val_kl_reg_loss: 60010.8253; val_edge_recon_loss: 582884.6750; val_gene_expr_recon_loss: 19139749.2000; val_masked_gp_l1_reg_loss: 92998.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107630.7891; val_chrom_access_recon_loss: 9749802.3333; val_global_loss: 29733074.9333; val_optim_loss: 29733074.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9678; val_auprc_score: 0.9586; val_best_acc_score: 0.9162; val_best_f1_score: 0.9200; train_kl_reg_loss: 60143.0759; train_edge_recon_loss: 579997.4055; train_gene_expr_recon_loss: 18730231.5878; train_masked_gp_l1_reg_loss: 93570.6831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106916.9716; train_chrom_access_recon_loss: 9522003.7099; train_global_loss: 29092863.3588; train_optim_loss: 29092863.3588; val_kl_reg_loss: 61615.1104; val_edge_recon_loss: 584162.5708; val_gene_expr_recon_loss: 19023325.3333; val_masked_gp_l1_reg_loss: 93945.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107712.5859; val_chrom_access_recon_loss: 9762486.6667; val_global_loss: 29633247.7333; val_optim_loss: 29633247.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9691; val_auprc_score: 0.9598; val_best_acc_score: 0.9166; val_best_f1_score: 0.9200; train_kl_reg_loss: 60296.4890; train_edge_recon_loss: 581284.2948; train_gene_expr_recon_loss: 18694294.0458; train_masked_gp_l1_reg_loss: 94206.5255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106737.7892; train_chrom_access_recon_loss: 9494815.4885; train_global_loss: 29031634.6107; train_optim_loss: 29031634.6107; val_kl_reg_loss: 60978.2052; val_edge_recon_loss: 580749.7208; val_gene_expr_recon_loss: 18958692.1333; val_masked_gp_l1_reg_loss: 94544.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107430.7891; val_chrom_access_recon_loss: 9673707.0000; val_global_loss: 29476100.8000; val_optim_loss: 29476100.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9699; val_auprc_score: 0.9613; val_best_acc_score: 0.9185; val_best_f1_score: 0.9218; train_kl_reg_loss: 59923.9117; train_edge_recon_loss: 580870.3698; train_gene_expr_recon_loss: 18649013.0687; train_masked_gp_l1_reg_loss: 94956.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106724.6422; train_chrom_access_recon_loss: 9459856.0000; train_global_loss: 28951344.7634; train_optim_loss: 28951344.7634; val_kl_reg_loss: 59680.4362; val_edge_recon_loss: 581665.4500; val_gene_expr_recon_loss: 19020030.2667; val_masked_gp_l1_reg_loss: 95371.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108745.5938; val_chrom_access_recon_loss: 9720925.0667; val_global_loss: 29586419.0667; val_optim_loss: 29586419.0667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9186; val_auprc_score: 0.9063; val_best_acc_score: 0.8351; val_best_f1_score: 0.8490; train_kl_reg_loss: 39881.5993; train_edge_recon_loss: 741117.2925; train_gene_expr_recon_loss: 17474237.1450; train_masked_gp_l1_reg_loss: 97621.2172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115218.6489; train_chrom_access_recon_loss: 8893745.0916; train_global_loss: 27361821.0382; train_optim_loss: 27361821.0382; val_kl_reg_loss: 13217.6363; val_edge_recon_loss: 742359.6167; val_gene_expr_recon_loss: 17311622.7333; val_masked_gp_l1_reg_loss: 98055.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124812.0781; val_chrom_access_recon_loss: 8962123.0000; val_global_loss: 27252190.8000; val_optim_loss: 27252190.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9087; val_auprc_score: 0.8945; val_best_acc_score: 0.8294; val_best_f1_score: 0.8439; train_kl_reg_loss: 18486.6847; train_edge_recon_loss: 736166.3201; train_gene_expr_recon_loss: 17156169.1679; train_masked_gp_l1_reg_loss: 96665.0920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130442.8974; train_chrom_access_recon_loss: 8836663.0267; train_global_loss: 26974593.0992; train_optim_loss: 26974593.0992; val_kl_reg_loss: 10561.6124; val_edge_recon_loss: 735745.1917; val_gene_expr_recon_loss: 17331522.2667; val_masked_gp_l1_reg_loss: 93614.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127219.1797; val_chrom_access_recon_loss: 8981601.4667; val_global_loss: 27280264.6667; val_optim_loss: 27280264.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8999; val_auprc_score: 0.8862; val_best_acc_score: 0.8172; val_best_f1_score: 0.8387; train_kl_reg_loss: 18326.5409; train_edge_recon_loss: 712649.5076; train_gene_expr_recon_loss: 17058899.9466; train_masked_gp_l1_reg_loss: 91090.5856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126462.3137; train_chrom_access_recon_loss: 8813111.6832; train_global_loss: 26820540.6260; train_optim_loss: 26820540.6260; val_kl_reg_loss: 13115.9747; val_edge_recon_loss: 703299.1333; val_gene_expr_recon_loss: 17291424.1333; val_masked_gp_l1_reg_loss: 89529.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126830.7734; val_chrom_access_recon_loss: 8943040.8000; val_global_loss: 27167240.1333; val_optim_loss: 27167240.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9153; val_auprc_score: 0.9003; val_best_acc_score: 0.8380; val_best_f1_score: 0.8524; train_kl_reg_loss: 19869.3656; train_edge_recon_loss: 681412.0391; train_gene_expr_recon_loss: 17055918.0229; train_masked_gp_l1_reg_loss: 86698.3509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123927.5799; train_chrom_access_recon_loss: 8801473.9313; train_global_loss: 26769299.3740; train_optim_loss: 26769299.3740; val_kl_reg_loss: 10627.7439; val_edge_recon_loss: 686256.6042; val_gene_expr_recon_loss: 17292581.8667; val_masked_gp_l1_reg_loss: 84473.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122043.9844; val_chrom_access_recon_loss: 8944654.6000; val_global_loss: 27140638.4000; val_optim_loss: 27140638.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9028; val_auprc_score: 0.8901; val_best_acc_score: 0.8209; val_best_f1_score: 0.8360; train_kl_reg_loss: 19281.9175; train_edge_recon_loss: 709912.4771; train_gene_expr_recon_loss: 17023218.6565; train_masked_gp_l1_reg_loss: 82782.9591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120557.9527; train_chrom_access_recon_loss: 8805234.5687; train_global_loss: 26760988.4580; train_optim_loss: 26760988.4580; val_kl_reg_loss: 13243.8695; val_edge_recon_loss: 721903.9167; val_gene_expr_recon_loss: 17277971.3333; val_masked_gp_l1_reg_loss: 80581.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118524.5234; val_chrom_access_recon_loss: 8971046.1333; val_global_loss: 27183271.0667; val_optim_loss: 27183271.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8971; val_auprc_score: 0.8822; val_best_acc_score: 0.8147; val_best_f1_score: 0.8342; train_kl_reg_loss: 19332.3559; train_edge_recon_loss: 678334.8831; train_gene_expr_recon_loss: 16963009.6718; train_masked_gp_l1_reg_loss: 78681.6464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116313.6212; train_chrom_access_recon_loss: 8777877.7557; train_global_loss: 26633549.8626; train_optim_loss: 26633549.8626; val_kl_reg_loss: 14315.2602; val_edge_recon_loss: 664230.4458; val_gene_expr_recon_loss: 17265748.5333; val_masked_gp_l1_reg_loss: 76915.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113611.1484; val_chrom_access_recon_loss: 8982676.0333; val_global_loss: 27117498.1333; val_optim_loss: 27117498.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8983; val_auprc_score: 0.8820; val_best_acc_score: 0.8165; val_best_f1_score: 0.8389; train_kl_reg_loss: 21341.4950; train_edge_recon_loss: 646900.6250; train_gene_expr_recon_loss: 16929390.0458; train_masked_gp_l1_reg_loss: 75973.8971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112887.6563; train_chrom_access_recon_loss: 8770247.1565; train_global_loss: 26556740.9313; train_optim_loss: 26556740.9313; val_kl_reg_loss: 17309.5204; val_edge_recon_loss: 625425.8208; val_gene_expr_recon_loss: 17265097.2000; val_masked_gp_l1_reg_loss: 75210.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111788.7109; val_chrom_access_recon_loss: 8952144.0667; val_global_loss: 27046974.2667; val_optim_loss: 27046974.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8972; val_auprc_score: 0.8857; val_best_acc_score: 0.8107; val_best_f1_score: 0.8327; train_kl_reg_loss: 24457.1870; train_edge_recon_loss: 623690.1703; train_gene_expr_recon_loss: 16911823.0458; train_masked_gp_l1_reg_loss: 74398.7148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111462.9656; train_chrom_access_recon_loss: 8757706.5038; train_global_loss: 26503538.5344; train_optim_loss: 26503538.5344; val_kl_reg_loss: 21616.7202; val_edge_recon_loss: 612136.2917; val_gene_expr_recon_loss: 17074805.4667; val_masked_gp_l1_reg_loss: 73460.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110651.0469; val_chrom_access_recon_loss: 8913932.5333; val_global_loss: 26806602.9333; val_optim_loss: 26806602.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8930; val_auprc_score: 0.8747; val_best_acc_score: 0.8063; val_best_f1_score: 0.8308; train_kl_reg_loss: 28635.5174; train_edge_recon_loss: 604611.6546; train_gene_expr_recon_loss: 16872776.7023; train_masked_gp_l1_reg_loss: 72612.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109654.4543; train_chrom_access_recon_loss: 8754860.1718; train_global_loss: 26443151.0992; train_optim_loss: 26443151.0992; val_kl_reg_loss: 26728.2777; val_edge_recon_loss: 600646.2250; val_gene_expr_recon_loss: 17005007.6000; val_masked_gp_l1_reg_loss: 71883.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108111.2891; val_chrom_access_recon_loss: 8851519.4000; val_global_loss: 26663897.4667; val_optim_loss: 26663897.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9018; val_auprc_score: 0.8894; val_best_acc_score: 0.8146; val_best_f1_score: 0.8344; train_kl_reg_loss: 31111.2267; train_edge_recon_loss: 595424.1574; train_gene_expr_recon_loss: 16847143.8397; train_masked_gp_l1_reg_loss: 71006.4658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107895.0564; train_chrom_access_recon_loss: 8736886.7366; train_global_loss: 26389467.3893; train_optim_loss: 26389467.3893; val_kl_reg_loss: 28861.6499; val_edge_recon_loss: 593679.9375; val_gene_expr_recon_loss: 17087871.0667; val_masked_gp_l1_reg_loss: 70243.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107099.4844; val_chrom_access_recon_loss: 8868929.3333; val_global_loss: 26756685.8667; val_optim_loss: 26756685.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8997; val_auprc_score: 0.8843; val_best_acc_score: 0.8158; val_best_f1_score: 0.8371; train_kl_reg_loss: 32542.5791; train_edge_recon_loss: 591094.1517; train_gene_expr_recon_loss: 16816116.4504; train_masked_gp_l1_reg_loss: 69458.7262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106524.6118; train_chrom_access_recon_loss: 8724492.7748; train_global_loss: 26340229.2214; train_optim_loss: 26340229.2214; val_kl_reg_loss: 30865.1620; val_edge_recon_loss: 592782.8458; val_gene_expr_recon_loss: 17012072.7333; val_masked_gp_l1_reg_loss: 68882.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105718.9922; val_chrom_access_recon_loss: 8838888.6667; val_global_loss: 26649209.6000; val_optim_loss: 26649209.6000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9023; val_auprc_score: 0.8869; val_best_acc_score: 0.8177; val_best_f1_score: 0.8366; train_kl_reg_loss: 33642.9164; train_edge_recon_loss: 588916.3387; train_gene_expr_recon_loss: 16829962.8015; train_masked_gp_l1_reg_loss: 68309.6129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105081.4862; train_chrom_access_recon_loss: 8741490.8855; train_global_loss: 26367404.0916; train_optim_loss: 26367404.0916; val_kl_reg_loss: 32371.4625; val_edge_recon_loss: 589280.0458; val_gene_expr_recon_loss: 17058257.6000; val_masked_gp_l1_reg_loss: 67803.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104563.9766; val_chrom_access_recon_loss: 8882107.6667; val_global_loss: 26734384.8000; val_optim_loss: 26734384.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9084; val_auprc_score: 0.8930; val_best_acc_score: 0.8266; val_best_f1_score: 0.8395; train_kl_reg_loss: 34403.2245; train_edge_recon_loss: 586889.0649; train_gene_expr_recon_loss: 16801784.0840; train_masked_gp_l1_reg_loss: 67281.5595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103905.5211; train_chrom_access_recon_loss: 8729105.0840; train_global_loss: 26323368.4733; train_optim_loss: 26323368.4733; val_kl_reg_loss: 32918.0555; val_edge_recon_loss: 590541.4042; val_gene_expr_recon_loss: 17035406.5333; val_masked_gp_l1_reg_loss: 66689.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103422.0781; val_chrom_access_recon_loss: 8883297.7667; val_global_loss: 26712276.0000; val_optim_loss: 26712276.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9110; val_auprc_score: 0.8964; val_best_acc_score: 0.8328; val_best_f1_score: 0.8467; train_kl_reg_loss: 34808.3084; train_edge_recon_loss: 585192.5239; train_gene_expr_recon_loss: 16798480.4504; train_masked_gp_l1_reg_loss: 66269.3500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102846.8571; train_chrom_access_recon_loss: 8725026.2099; train_global_loss: 26312623.7099; train_optim_loss: 26312623.7099; val_kl_reg_loss: 32862.3757; val_edge_recon_loss: 583682.0625; val_gene_expr_recon_loss: 17086802.7333; val_masked_gp_l1_reg_loss: 65951.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102107.7500; val_chrom_access_recon_loss: 8900580.2667; val_global_loss: 26771987.3333; val_optim_loss: 26771987.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9141; val_auprc_score: 0.8966; val_best_acc_score: 0.8367; val_best_f1_score: 0.8488; train_kl_reg_loss: 35240.7974; train_edge_recon_loss: 583988.5267; train_gene_expr_recon_loss: 16763444.8015; train_masked_gp_l1_reg_loss: 65616.2144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101863.7461; train_chrom_access_recon_loss: 8715933.7252; train_global_loss: 26266087.7863; train_optim_loss: 26266087.7863; val_kl_reg_loss: 34485.5387; val_edge_recon_loss: 586313.8042; val_gene_expr_recon_loss: 17044790.9333; val_masked_gp_l1_reg_loss: 65361.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101653.1641; val_chrom_access_recon_loss: 8903906.9333; val_global_loss: 26736513.2000; val_optim_loss: 26736513.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9161; val_auprc_score: 0.9023; val_best_acc_score: 0.8331; val_best_f1_score: 0.8458; train_kl_reg_loss: 35953.9655; train_edge_recon_loss: 583938.9523; train_gene_expr_recon_loss: 16762665.6107; train_masked_gp_l1_reg_loss: 64685.5878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82738.4392; train_chrom_access_recon_loss: 8711588.2824; train_global_loss: 26241570.8550; train_optim_loss: 26241570.8550; val_kl_reg_loss: 34758.7049; val_edge_recon_loss: 590713.6792; val_gene_expr_recon_loss: 17004143.8667; val_masked_gp_l1_reg_loss: 64411.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79597.7656; val_chrom_access_recon_loss: 8884013.6667; val_global_loss: 26657639.6000; val_optim_loss: 26657639.6000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9166; val_auprc_score: 0.9029; val_best_acc_score: 0.8355; val_best_f1_score: 0.8486; train_kl_reg_loss: 36272.7259; train_edge_recon_loss: 583468.2719; train_gene_expr_recon_loss: 16740648.4046; train_masked_gp_l1_reg_loss: 64315.2119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78833.0520; train_chrom_access_recon_loss: 8697852.0305; train_global_loss: 26201389.5267; train_optim_loss: 26201389.5267; val_kl_reg_loss: 34836.9922; val_edge_recon_loss: 582988.9000; val_gene_expr_recon_loss: 17032381.4667; val_masked_gp_l1_reg_loss: 64216.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78232.9609; val_chrom_access_recon_loss: 8857182.8667; val_global_loss: 26649838.5333; val_optim_loss: 26649838.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9165; val_auprc_score: 0.9026; val_best_acc_score: 0.8376; val_best_f1_score: 0.8520; train_kl_reg_loss: 36575.0998; train_edge_recon_loss: 581120.2066; train_gene_expr_recon_loss: 16738478.1832; train_masked_gp_l1_reg_loss: 64160.5203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77781.6430; train_chrom_access_recon_loss: 8699795.5687; train_global_loss: 26197911.1298; train_optim_loss: 26197911.1298; val_kl_reg_loss: 34930.4266; val_edge_recon_loss: 588127.0333; val_gene_expr_recon_loss: 16957187.9333; val_masked_gp_l1_reg_loss: 64096.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77446.5391; val_chrom_access_recon_loss: 8827985.2333; val_global_loss: 26549772.6667; val_optim_loss: 26549772.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9182; val_auprc_score: 0.9084; val_best_acc_score: 0.8403; val_best_f1_score: 0.8500; train_kl_reg_loss: 36663.2198; train_edge_recon_loss: 581692.2939; train_gene_expr_recon_loss: 16741338.6336; train_masked_gp_l1_reg_loss: 64024.7554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77161.2086; train_chrom_access_recon_loss: 8697450.7023; train_global_loss: 26198330.9313; train_optim_loss: 26198330.9313; val_kl_reg_loss: 35477.7281; val_edge_recon_loss: 587785.2917; val_gene_expr_recon_loss: 17002822.2667; val_masked_gp_l1_reg_loss: 63951.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76798.9609; val_chrom_access_recon_loss: 8862106.2000; val_global_loss: 26628941.6000; val_optim_loss: 26628941.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9162; val_auprc_score: 0.9049; val_best_acc_score: 0.8355; val_best_f1_score: 0.8484; train_kl_reg_loss: 36840.6853; train_edge_recon_loss: 582697.0601; train_gene_expr_recon_loss: 16751459.4885; train_masked_gp_l1_reg_loss: 63894.0921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76620.5767; train_chrom_access_recon_loss: 8702787.4084; train_global_loss: 26214299.3130; train_optim_loss: 26214299.3130; val_kl_reg_loss: 35309.9073; val_edge_recon_loss: 591616.9292; val_gene_expr_recon_loss: 16944030.6667; val_masked_gp_l1_reg_loss: 63815.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76256.2031; val_chrom_access_recon_loss: 8821050.3667; val_global_loss: 26532079.6000; val_optim_loss: 26532079.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9187; val_auprc_score: 0.9063; val_best_acc_score: 0.8371; val_best_f1_score: 0.8506; train_kl_reg_loss: 37080.3324; train_edge_recon_loss: 583928.5177; train_gene_expr_recon_loss: 16746240.0992; train_masked_gp_l1_reg_loss: 63744.1125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76106.5519; train_chrom_access_recon_loss: 8701147.6107; train_global_loss: 26208247.1756; train_optim_loss: 26208247.1756; val_kl_reg_loss: 35832.1740; val_edge_recon_loss: 586182.5542; val_gene_expr_recon_loss: 16997127.4667; val_masked_gp_l1_reg_loss: 63681.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75810.1953; val_chrom_access_recon_loss: 8893787.6667; val_global_loss: 26652422.0000; val_optim_loss: 26652422.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9196; val_auprc_score: 0.9069; val_best_acc_score: 0.8393; val_best_f1_score: 0.8518; train_kl_reg_loss: 37291.5370; train_edge_recon_loss: 582883.9728; train_gene_expr_recon_loss: 16734243.0458; train_masked_gp_l1_reg_loss: 63602.2158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75678.3594; train_chrom_access_recon_loss: 8696469.6489; train_global_loss: 26190168.6718; train_optim_loss: 26190168.6718; val_kl_reg_loss: 36020.5453; val_edge_recon_loss: 582538.3333; val_gene_expr_recon_loss: 16996040.1333; val_masked_gp_l1_reg_loss: 63552.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75357.7734; val_chrom_access_recon_loss: 8827193.5333; val_global_loss: 26580702.6667; val_optim_loss: 26580702.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9198; val_auprc_score: 0.9077; val_best_acc_score: 0.8417; val_best_f1_score: 0.8511; train_kl_reg_loss: 37504.3671; train_edge_recon_loss: 580851.4027; train_gene_expr_recon_loss: 16744589.2824; train_masked_gp_l1_reg_loss: 63483.5416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75153.8871; train_chrom_access_recon_loss: 8710013.8473; train_global_loss: 26211596.2901; train_optim_loss: 26211596.2901; val_kl_reg_loss: 36108.3466; val_edge_recon_loss: 585929.9875; val_gene_expr_recon_loss: 16950346.7333; val_masked_gp_l1_reg_loss: 63425.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74812.0000; val_chrom_access_recon_loss: 8811168.8000; val_global_loss: 26521791.7333; val_optim_loss: 26521791.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9223; val_auprc_score: 0.9099; val_best_acc_score: 0.8437; val_best_f1_score: 0.8546; train_kl_reg_loss: 37496.9226; train_edge_recon_loss: 583079.0520; train_gene_expr_recon_loss: 16718084.2901; train_masked_gp_l1_reg_loss: 63349.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74746.5676; train_chrom_access_recon_loss: 8697967.3740; train_global_loss: 26174724.0916; train_optim_loss: 26174724.0916; val_kl_reg_loss: 36098.6724; val_edge_recon_loss: 582653.1292; val_gene_expr_recon_loss: 16901068.2667; val_masked_gp_l1_reg_loss: 63281.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74516.1016; val_chrom_access_recon_loss: 8787964.8667; val_global_loss: 26445582.9333; val_optim_loss: 26445582.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9214; val_auprc_score: 0.9108; val_best_acc_score: 0.8413; val_best_f1_score: 0.8526; train_kl_reg_loss: 37500.0042; train_edge_recon_loss: 582102.2252; train_gene_expr_recon_loss: 16729134.5725; train_masked_gp_l1_reg_loss: 63223.2176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74317.2026; train_chrom_access_recon_loss: 8695868.9313; train_global_loss: 26182146.2595; train_optim_loss: 26182146.2595; val_kl_reg_loss: 36094.9938; val_edge_recon_loss: 586164.1500; val_gene_expr_recon_loss: 16976515.1333; val_masked_gp_l1_reg_loss: 63163.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74198.5156; val_chrom_access_recon_loss: 8894869.9667; val_global_loss: 26631006.1333; val_optim_loss: 26631006.1333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9222; val_auprc_score: 0.9067; val_best_acc_score: 0.8453; val_best_f1_score: 0.8555; train_kl_reg_loss: 37853.3961; train_edge_recon_loss: 578480.9866; train_gene_expr_recon_loss: 16730398.2061; train_masked_gp_l1_reg_loss: 63110.9550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74025.8965; train_chrom_access_recon_loss: 8687647.0725; train_global_loss: 26171516.4122; train_optim_loss: 26171516.4122; val_kl_reg_loss: 36615.5664; val_edge_recon_loss: 580823.1125; val_gene_expr_recon_loss: 16992359.9333; val_masked_gp_l1_reg_loss: 63046.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73735.0625; val_chrom_access_recon_loss: 8844853.8000; val_global_loss: 26591434.4000; val_optim_loss: 26591434.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9237; val_auprc_score: 0.9112; val_best_acc_score: 0.8467; val_best_f1_score: 0.8577; train_kl_reg_loss: 38212.5119; train_edge_recon_loss: 581191.0196; train_gene_expr_recon_loss: 16742994.6260; train_masked_gp_l1_reg_loss: 62980.2645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73588.2668; train_chrom_access_recon_loss: 8700789.8855; train_global_loss: 26199756.5649; train_optim_loss: 26199756.5649; val_kl_reg_loss: 37152.9674; val_edge_recon_loss: 581806.3500; val_gene_expr_recon_loss: 16930505.2667; val_masked_gp_l1_reg_loss: 62917.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73416.2422; val_chrom_access_recon_loss: 8817294.3000; val_global_loss: 26503093.0667; val_optim_loss: 26503093.0667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9228; val_auprc_score: 0.9072; val_best_acc_score: 0.8471; val_best_f1_score: 0.8579; train_kl_reg_loss: 38260.2652; train_edge_recon_loss: 580648.7018; train_gene_expr_recon_loss: 16711960.8702; train_masked_gp_l1_reg_loss: 62857.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73148.9036; train_chrom_access_recon_loss: 8682279.7176; train_global_loss: 26149156.3817; train_optim_loss: 26149156.3817; val_kl_reg_loss: 36778.4310; val_edge_recon_loss: 580857.7917; val_gene_expr_recon_loss: 16934009.6000; val_masked_gp_l1_reg_loss: 62809.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72980.3672; val_chrom_access_recon_loss: 8825943.4667; val_global_loss: 26513379.4667; val_optim_loss: 26513379.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9233; val_auprc_score: 0.9083; val_best_acc_score: 0.8490; val_best_f1_score: 0.8600; train_kl_reg_loss: 38359.7719; train_edge_recon_loss: 581858.3535; train_gene_expr_recon_loss: 16728962.0534; train_masked_gp_l1_reg_loss: 62729.1613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71029.3878; train_chrom_access_recon_loss: 8699379.1374; train_global_loss: 26182317.8626; train_optim_loss: 26182317.8626; val_kl_reg_loss: 36994.8357; val_edge_recon_loss: 580412.4542; val_gene_expr_recon_loss: 16900856.7333; val_masked_gp_l1_reg_loss: 62693.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70738.2578; val_chrom_access_recon_loss: 8829003.0000; val_global_loss: 26480698.8000; val_optim_loss: 26480698.8000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9236; val_auprc_score: 0.9131; val_best_acc_score: 0.8451; val_best_f1_score: 0.8568; train_kl_reg_loss: 38397.3962; train_edge_recon_loss: 582224.2610; train_gene_expr_recon_loss: 16708352.8550; train_masked_gp_l1_reg_loss: 62675.4360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70647.4577; train_chrom_access_recon_loss: 8685466.7863; train_global_loss: 26147764.0000; train_optim_loss: 26147764.0000; val_kl_reg_loss: 37124.2789; val_edge_recon_loss: 586429.1875; val_gene_expr_recon_loss: 17042894.2000; val_masked_gp_l1_reg_loss: 62661.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70546.6953; val_chrom_access_recon_loss: 8876952.4333; val_global_loss: 26676608.0000; val_optim_loss: 26676608.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9194; val_auprc_score: 0.9011; val_best_acc_score: 0.8402; val_best_f1_score: 0.8534; train_kl_reg_loss: 38405.1124; train_edge_recon_loss: 580853.0658; train_gene_expr_recon_loss: 16727133.9160; train_masked_gp_l1_reg_loss: 62649.7320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70475.6118; train_chrom_access_recon_loss: 8694705.6756; train_global_loss: 26174223.0076; train_optim_loss: 26174223.0076; val_kl_reg_loss: 37099.0747; val_edge_recon_loss: 586213.6833; val_gene_expr_recon_loss: 16918950.0667; val_masked_gp_l1_reg_loss: 62640.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70413.1328; val_chrom_access_recon_loss: 8807210.1333; val_global_loss: 26482527.0667; val_optim_loss: 26482527.0667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9271; val_auprc_score: 0.9139; val_best_acc_score: 0.8525; val_best_f1_score: 0.8639; train_kl_reg_loss: 38485.1910; train_edge_recon_loss: 579075.7610; train_gene_expr_recon_loss: 16721553.3130; train_masked_gp_l1_reg_loss: 62631.7095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70362.4371; train_chrom_access_recon_loss: 8692646.2557; train_global_loss: 26164754.7023; train_optim_loss: 26164754.7023; val_kl_reg_loss: 37094.9867; val_edge_recon_loss: 580568.3292; val_gene_expr_recon_loss: 17016560.9333; val_masked_gp_l1_reg_loss: 62623.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70306.5938; val_chrom_access_recon_loss: 8882375.4667; val_global_loss: 26649529.8667; val_optim_loss: 26649529.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 46 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9225
val AUPRC score: 0.9084
val best accuracy score: 0.8463
val best F1 score: 0.8548
val target rna MSE score: 1.8599
val source rna MSE score: 0.6986
val target atac MSE score: 0.3513
val source atac MSE score: 0.1069
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
