[True]
Run timestamp: 10082023_203349_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7370; val_auprc_score: 0.7693; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 117171.7643; train_edge_recon_loss: 3732224.4695; train_gene_expr_recon_loss: 26842598.4580; train_masked_gp_l1_reg_loss: 75435.7272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241692.7164; train_chrom_access_recon_loss: 6800756.8969; train_global_loss: 37809879.8473; train_optim_loss: 37809879.8473; val_kl_reg_loss: 130851.6583; val_edge_recon_loss: 4065751.3500; val_gene_expr_recon_loss: 23314852.9333; val_masked_gp_l1_reg_loss: 76689.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233695.8281; val_chrom_access_recon_loss: 6437637.0667; val_global_loss: 34259479.4667; val_optim_loss: 34259479.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7577; val_auprc_score: 0.7822; val_best_acc_score: 0.5858; val_best_f1_score: 0.6979; train_kl_reg_loss: 132290.8505; train_edge_recon_loss: 3632046.5191; train_gene_expr_recon_loss: 23106086.0458; train_masked_gp_l1_reg_loss: 78668.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224328.7699; train_chrom_access_recon_loss: 6415728.8702; train_global_loss: 33589149.4962; train_optim_loss: 33589149.4962; val_kl_reg_loss: 162938.5010; val_edge_recon_loss: 4060082.3333; val_gene_expr_recon_loss: 22465919.4667; val_masked_gp_l1_reg_loss: 77268.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213881.5938; val_chrom_access_recon_loss: 6325016.6667; val_global_loss: 33305106.9333; val_optim_loss: 33305106.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8505; val_auprc_score: 0.8510; val_best_acc_score: 0.7387; val_best_f1_score: 0.7564; train_kl_reg_loss: 152072.9813; train_edge_recon_loss: 3546631.9370; train_gene_expr_recon_loss: 22266144.3053; train_masked_gp_l1_reg_loss: 75828.3098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203407.3923; train_chrom_access_recon_loss: 6324281.7519; train_global_loss: 32568366.5954; train_optim_loss: 32568366.5954; val_kl_reg_loss: 135101.7182; val_edge_recon_loss: 3981650.3500; val_gene_expr_recon_loss: 22119661.6000; val_masked_gp_l1_reg_loss: 75305.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193054.0938; val_chrom_access_recon_loss: 6292099.1000; val_global_loss: 32796872.8000; val_optim_loss: 32796872.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8876; val_auprc_score: 0.8744; val_best_acc_score: 0.8076; val_best_f1_score: 0.8223; train_kl_reg_loss: 127277.6437; train_edge_recon_loss: 3397306.2328; train_gene_expr_recon_loss: 22062723.1145; train_masked_gp_l1_reg_loss: 76907.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183608.1280; train_chrom_access_recon_loss: 6287513.6565; train_global_loss: 32135336.7481; train_optim_loss: 32135336.7481; val_kl_reg_loss: 136279.1750; val_edge_recon_loss: 3189063.4167; val_gene_expr_recon_loss: 21980126.1333; val_masked_gp_l1_reg_loss: 80983.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174477.3750; val_chrom_access_recon_loss: 6251591.5333; val_global_loss: 31812522.2667; val_optim_loss: 31812522.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8905; val_auprc_score: 0.8771; val_best_acc_score: 0.8087; val_best_f1_score: 0.8235; train_kl_reg_loss: 147645.5362; train_edge_recon_loss: 3083526.8683; train_gene_expr_recon_loss: 21903765.2977; train_masked_gp_l1_reg_loss: 82897.3235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166495.5965; train_chrom_access_recon_loss: 6256979.9847; train_global_loss: 31641310.4733; train_optim_loss: 31641310.4733; val_kl_reg_loss: 164224.5281; val_edge_recon_loss: 2999393.0333; val_gene_expr_recon_loss: 21877890.6667; val_masked_gp_l1_reg_loss: 83617.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158830.0156; val_chrom_access_recon_loss: 6239113.8667; val_global_loss: 31523070.1333; val_optim_loss: 31523070.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9016; val_auprc_score: 0.8824; val_best_acc_score: 0.8263; val_best_f1_score: 0.8426; train_kl_reg_loss: 161749.3427; train_edge_recon_loss: 2950630.1565; train_gene_expr_recon_loss: 21751184.2901; train_masked_gp_l1_reg_loss: 84415.7221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152600.1512; train_chrom_access_recon_loss: 6232559.9809; train_global_loss: 31333139.6031; train_optim_loss: 31333139.6031; val_kl_reg_loss: 154835.6688; val_edge_recon_loss: 2953155.7167; val_gene_expr_recon_loss: 21835238.8000; val_masked_gp_l1_reg_loss: 85740.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146767.9219; val_chrom_access_recon_loss: 6255809.2000; val_global_loss: 31431547.2000; val_optim_loss: 31431547.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9102; val_auprc_score: 0.8929; val_best_acc_score: 0.8362; val_best_f1_score: 0.8497; train_kl_reg_loss: 156775.6812; train_edge_recon_loss: 2922126.3034; train_gene_expr_recon_loss: 21594284.6107; train_masked_gp_l1_reg_loss: 87022.8360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141286.4676; train_chrom_access_recon_loss: 6196626.4504; train_global_loss: 31098122.4122; train_optim_loss: 31098122.4122; val_kl_reg_loss: 153980.5323; val_edge_recon_loss: 2919459.9000; val_gene_expr_recon_loss: 21493150.8000; val_masked_gp_l1_reg_loss: 88596.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135904.7656; val_chrom_access_recon_loss: 6157886.9000; val_global_loss: 30948978.2667; val_optim_loss: 30948978.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9202; val_auprc_score: 0.9060; val_best_acc_score: 0.8504; val_best_f1_score: 0.8604; train_kl_reg_loss: 152973.8980; train_edge_recon_loss: 2896319.0897; train_gene_expr_recon_loss: 21471828.5496; train_masked_gp_l1_reg_loss: 89631.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131024.9896; train_chrom_access_recon_loss: 6172934.3702; train_global_loss: 30914712.0458; train_optim_loss: 30914712.0458; val_kl_reg_loss: 150833.5719; val_edge_recon_loss: 2883012.9000; val_gene_expr_recon_loss: 21400822.5333; val_masked_gp_l1_reg_loss: 90707.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126370.0938; val_chrom_access_recon_loss: 6161811.9667; val_global_loss: 30813558.9333; val_optim_loss: 30813558.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9184; val_auprc_score: 0.9023; val_best_acc_score: 0.8456; val_best_f1_score: 0.8581; train_kl_reg_loss: 148818.4654; train_edge_recon_loss: 2880522.1469; train_gene_expr_recon_loss: 21383421.6947; train_masked_gp_l1_reg_loss: 91826.3212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122124.1560; train_chrom_access_recon_loss: 6157073.5000; train_global_loss: 30783786.2443; train_optim_loss: 30783786.2443; val_kl_reg_loss: 146180.7812; val_edge_recon_loss: 2908439.0333; val_gene_expr_recon_loss: 21342032.2667; val_masked_gp_l1_reg_loss: 93043.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117967.5781; val_chrom_access_recon_loss: 6128059.1333; val_global_loss: 30735723.2000; val_optim_loss: 30735723.2000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9254; val_auprc_score: 0.9129; val_best_acc_score: 0.8527; val_best_f1_score: 0.8616; train_kl_reg_loss: 144410.0787; train_edge_recon_loss: 2872953.0286; train_gene_expr_recon_loss: 21290477.9084; train_masked_gp_l1_reg_loss: 94057.9475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114131.9701; train_chrom_access_recon_loss: 6136067.4847; train_global_loss: 30652098.3359; train_optim_loss: 30652098.3359; val_kl_reg_loss: 140703.5010; val_edge_recon_loss: 2859530.2500; val_gene_expr_recon_loss: 21285452.8000; val_masked_gp_l1_reg_loss: 95006.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110325.7578; val_chrom_access_recon_loss: 6141180.5667; val_global_loss: 30632199.3333; val_optim_loss: 30632199.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9211; val_auprc_score: 0.9070; val_best_acc_score: 0.8475; val_best_f1_score: 0.8572; train_kl_reg_loss: 138106.2190; train_edge_recon_loss: 2858372.9275; train_gene_expr_recon_loss: 21230215.8321; train_masked_gp_l1_reg_loss: 96072.3058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106872.4787; train_chrom_access_recon_loss: 6125923.5534; train_global_loss: 30555563.3282; train_optim_loss: 30555563.3282; val_kl_reg_loss: 136867.1833; val_edge_recon_loss: 2881196.4000; val_gene_expr_recon_loss: 21242605.2000; val_masked_gp_l1_reg_loss: 96970.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103553.1484; val_chrom_access_recon_loss: 6133424.6333; val_global_loss: 30594617.7333; val_optim_loss: 30594617.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9298; val_auprc_score: 0.9156; val_best_acc_score: 0.8612; val_best_f1_score: 0.8688; train_kl_reg_loss: 136381.4591; train_edge_recon_loss: 2847015.8893; train_gene_expr_recon_loss: 21182617.0840; train_masked_gp_l1_reg_loss: 97890.1357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100499.5463; train_chrom_access_recon_loss: 6117555.6260; train_global_loss: 30481959.7405; train_optim_loss: 30481959.7405; val_kl_reg_loss: 130165.8792; val_edge_recon_loss: 2844552.6000; val_gene_expr_recon_loss: 21111373.0667; val_masked_gp_l1_reg_loss: 98888.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97568.7266; val_chrom_access_recon_loss: 6092243.7667; val_global_loss: 30374791.2000; val_optim_loss: 30374791.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9380; val_auprc_score: 0.9281; val_best_acc_score: 0.8643; val_best_f1_score: 0.8696; train_kl_reg_loss: 131359.8859; train_edge_recon_loss: 2830790.5534; train_gene_expr_recon_loss: 21090555.6031; train_masked_gp_l1_reg_loss: 99771.8980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94927.2093; train_chrom_access_recon_loss: 6095914.8053; train_global_loss: 30343319.9695; train_optim_loss: 30343319.9695; val_kl_reg_loss: 128586.9979; val_edge_recon_loss: 2839982.4167; val_gene_expr_recon_loss: 21094152.1333; val_masked_gp_l1_reg_loss: 100720.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92361.2266; val_chrom_access_recon_loss: 6063907.5333; val_global_loss: 30319710.8000; val_optim_loss: 30319710.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9361; val_auprc_score: 0.9237; val_best_acc_score: 0.8669; val_best_f1_score: 0.8748; train_kl_reg_loss: 128515.8465; train_edge_recon_loss: 2830047.3454; train_gene_expr_recon_loss: 21041039.1908; train_masked_gp_l1_reg_loss: 101462.8708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90038.2461; train_chrom_access_recon_loss: 6086209.7481; train_global_loss: 30277313.3282; train_optim_loss: 30277313.3282; val_kl_reg_loss: 127253.0781; val_edge_recon_loss: 2836744.6333; val_gene_expr_recon_loss: 21023225.8667; val_masked_gp_l1_reg_loss: 102362.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87752.6328; val_chrom_access_recon_loss: 6093530.9667; val_global_loss: 30270868.4000; val_optim_loss: 30270868.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9352; val_auprc_score: 0.9194; val_best_acc_score: 0.8690; val_best_f1_score: 0.8744; train_kl_reg_loss: 128757.4210; train_edge_recon_loss: 2807889.4198; train_gene_expr_recon_loss: 21005822.0153; train_masked_gp_l1_reg_loss: 103171.1857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85658.7604; train_chrom_access_recon_loss: 6083051.5153; train_global_loss: 30214350.3969; train_optim_loss: 30214350.3969; val_kl_reg_loss: 125332.1776; val_edge_recon_loss: 2815065.5667; val_gene_expr_recon_loss: 20916047.8667; val_masked_gp_l1_reg_loss: 103838.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83601.6562; val_chrom_access_recon_loss: 6052151.6667; val_global_loss: 30096037.4667; val_optim_loss: 30096037.4667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9434; val_auprc_score: 0.9319; val_best_acc_score: 0.8764; val_best_f1_score: 0.8818; train_kl_reg_loss: 123263.6985; train_edge_recon_loss: 2805532.5706; train_gene_expr_recon_loss: 20953510.7023; train_masked_gp_l1_reg_loss: 104663.4079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81546.9150; train_chrom_access_recon_loss: 6065276.6947; train_global_loss: 30133794.0000; train_optim_loss: 30133794.0000; val_kl_reg_loss: 121999.8969; val_edge_recon_loss: 2817168.9000; val_gene_expr_recon_loss: 20894628.8000; val_masked_gp_l1_reg_loss: 105423.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79649.9766; val_chrom_access_recon_loss: 6031819.6667; val_global_loss: 30050691.6000; val_optim_loss: 30050691.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9422; val_auprc_score: 0.9321; val_best_acc_score: 0.8754; val_best_f1_score: 0.8825; train_kl_reg_loss: 121662.3862; train_edge_recon_loss: 2795722.0305; train_gene_expr_recon_loss: 20894476.0153; train_masked_gp_l1_reg_loss: 106239.4881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77758.6591; train_chrom_access_recon_loss: 6056123.7214; train_global_loss: 30051982.2748; train_optim_loss: 30051982.2748; val_kl_reg_loss: 119339.8943; val_edge_recon_loss: 2814012.6833; val_gene_expr_recon_loss: 20901974.0000; val_masked_gp_l1_reg_loss: 106932.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75956.5469; val_chrom_access_recon_loss: 6047265.5667; val_global_loss: 30065480.4000; val_optim_loss: 30065480.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9468; val_auprc_score: 0.9343; val_best_acc_score: 0.8816; val_best_f1_score: 0.8859; train_kl_reg_loss: 119770.3276; train_edge_recon_loss: 2788452.3931; train_gene_expr_recon_loss: 20916187.6336; train_masked_gp_l1_reg_loss: 107843.0057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74213.5975; train_chrom_access_recon_loss: 6068053.5840; train_global_loss: 30074520.5038; train_optim_loss: 30074520.5038; val_kl_reg_loss: 120607.5750; val_edge_recon_loss: 2791804.0167; val_gene_expr_recon_loss: 20894575.8667; val_masked_gp_l1_reg_loss: 108492.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72545.6953; val_chrom_access_recon_loss: 6051506.4000; val_global_loss: 30039531.6000; val_optim_loss: 30039531.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9510; val_auprc_score: 0.9390; val_best_acc_score: 0.8894; val_best_f1_score: 0.8946; train_kl_reg_loss: 118661.6996; train_edge_recon_loss: 2783054.2691; train_gene_expr_recon_loss: 20849503.4809; train_masked_gp_l1_reg_loss: 109158.0231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70965.4939; train_chrom_access_recon_loss: 6048433.4046; train_global_loss: 29979776.3206; train_optim_loss: 29979776.3206; val_kl_reg_loss: 118620.6599; val_edge_recon_loss: 2801005.1833; val_gene_expr_recon_loss: 20878477.4667; val_masked_gp_l1_reg_loss: 109835.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69363.1641; val_chrom_access_recon_loss: 6055178.0667; val_global_loss: 30032481.3333; val_optim_loss: 30032481.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9519; val_auprc_score: 0.9401; val_best_acc_score: 0.8897; val_best_f1_score: 0.8951; train_kl_reg_loss: 118019.4822; train_edge_recon_loss: 2769667.6469; train_gene_expr_recon_loss: 20828018.4580; train_masked_gp_l1_reg_loss: 110519.9116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67836.6576; train_chrom_access_recon_loss: 6045430.8511; train_global_loss: 29939493.0229; train_optim_loss: 29939493.0229; val_kl_reg_loss: 117479.1995; val_edge_recon_loss: 2777353.6833; val_gene_expr_recon_loss: 20835628.8000; val_masked_gp_l1_reg_loss: 111235.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66319.6250; val_chrom_access_recon_loss: 6031110.3000; val_global_loss: 29939127.8667; val_optim_loss: 29939127.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9567; val_auprc_score: 0.9454; val_best_acc_score: 0.8934; val_best_f1_score: 0.8972; train_kl_reg_loss: 115071.0707; train_edge_recon_loss: 2768109.4523; train_gene_expr_recon_loss: 20814377.9237; train_masked_gp_l1_reg_loss: 111832.6128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64999.2417; train_chrom_access_recon_loss: 6046651.5076; train_global_loss: 29921041.8321; train_optim_loss: 29921041.8321; val_kl_reg_loss: 113954.1604; val_edge_recon_loss: 2779322.6333; val_gene_expr_recon_loss: 20808092.8000; val_masked_gp_l1_reg_loss: 112557.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63621.9844; val_chrom_access_recon_loss: 6043806.2667; val_global_loss: 29921356.0000; val_optim_loss: 29921356.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9571; val_auprc_score: 0.9468; val_best_acc_score: 0.8979; val_best_f1_score: 0.9026; train_kl_reg_loss: 114055.5165; train_edge_recon_loss: 2757473.8416; train_gene_expr_recon_loss: 20750677.8168; train_masked_gp_l1_reg_loss: 113206.9712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62334.6740; train_chrom_access_recon_loss: 6030970.5573; train_global_loss: 29828719.3435; train_optim_loss: 29828719.3435; val_kl_reg_loss: 112970.6271; val_edge_recon_loss: 2770905.8667; val_gene_expr_recon_loss: 20806791.8667; val_masked_gp_l1_reg_loss: 113891.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61062.8906; val_chrom_access_recon_loss: 6004345.2333; val_global_loss: 29869967.6000; val_optim_loss: 29869967.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9585; val_auprc_score: 0.9494; val_best_acc_score: 0.8956; val_best_f1_score: 0.8998; train_kl_reg_loss: 111596.9193; train_edge_recon_loss: 2751380.6679; train_gene_expr_recon_loss: 20745817.2672; train_masked_gp_l1_reg_loss: 114533.5204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59917.1009; train_chrom_access_recon_loss: 6026201.1832; train_global_loss: 29809446.7634; train_optim_loss: 29809446.7634; val_kl_reg_loss: 110384.6495; val_edge_recon_loss: 2772556.2000; val_gene_expr_recon_loss: 20795700.2667; val_masked_gp_l1_reg_loss: 115132.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58859.7773; val_chrom_access_recon_loss: 6020022.9667; val_global_loss: 29872656.0000; val_optim_loss: 29872656.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9640; val_auprc_score: 0.9532; val_best_acc_score: 0.9037; val_best_f1_score: 0.9070; train_kl_reg_loss: 111153.4062; train_edge_recon_loss: 2750326.6832; train_gene_expr_recon_loss: 20711174.9160; train_masked_gp_l1_reg_loss: 115824.0075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57717.3729; train_chrom_access_recon_loss: 6021709.9580; train_global_loss: 29767906.3664; train_optim_loss: 29767906.3664; val_kl_reg_loss: 109491.1901; val_edge_recon_loss: 2744827.2000; val_gene_expr_recon_loss: 20773276.9333; val_masked_gp_l1_reg_loss: 116211.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56593.9805; val_chrom_access_recon_loss: 6038285.4333; val_global_loss: 29838686.9333; val_optim_loss: 29838686.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9641; val_auprc_score: 0.9551; val_best_acc_score: 0.9084; val_best_f1_score: 0.9121; train_kl_reg_loss: 109304.2358; train_edge_recon_loss: 2742997.8206; train_gene_expr_recon_loss: 20677412.4885; train_masked_gp_l1_reg_loss: 116974.2410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55620.2569; train_chrom_access_recon_loss: 6015764.8550; train_global_loss: 29718073.8015; train_optim_loss: 29718073.8015; val_kl_reg_loss: 108166.5589; val_edge_recon_loss: 2752769.5000; val_gene_expr_recon_loss: 20695377.3333; val_masked_gp_l1_reg_loss: 117589.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54575.7188; val_chrom_access_recon_loss: 6015803.1000; val_global_loss: 29744282.9333; val_optim_loss: 29744282.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9677; val_auprc_score: 0.9609; val_best_acc_score: 0.9117; val_best_f1_score: 0.9152; train_kl_reg_loss: 121930.2727; train_edge_recon_loss: 2800139.3874; train_gene_expr_recon_loss: 21399080.3359; train_masked_gp_l1_reg_loss: 117681.1785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54855.5643; train_chrom_access_recon_loss: 6084148.0191; train_global_loss: 30577834.8702; train_optim_loss: 30577834.8702; val_kl_reg_loss: 55012.6000; val_edge_recon_loss: 2783068.4333; val_gene_expr_recon_loss: 21413914.0000; val_masked_gp_l1_reg_loss: 118298.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54519.0547; val_chrom_access_recon_loss: 6075633.4333; val_global_loss: 30500446.2667; val_optim_loss: 30500446.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9660; val_auprc_score: 0.9563; val_best_acc_score: 0.9091; val_best_f1_score: 0.9119; train_kl_reg_loss: 117177.7977; train_edge_recon_loss: 2758988.0992; train_gene_expr_recon_loss: 21296307.4198; train_masked_gp_l1_reg_loss: 118759.6193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53798.0064; train_chrom_access_recon_loss: 6071706.2290; train_global_loss: 30416737.2672; train_optim_loss: 30416737.2672; val_kl_reg_loss: 59100.0578; val_edge_recon_loss: 2770988.3167; val_gene_expr_recon_loss: 21156612.8000; val_masked_gp_l1_reg_loss: 119059.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52950.3438; val_chrom_access_recon_loss: 6016937.2000; val_global_loss: 30175648.5333; val_optim_loss: 30175648.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9675; val_auprc_score: 0.9594; val_best_acc_score: 0.9135; val_best_f1_score: 0.9168; train_kl_reg_loss: 107081.0187; train_edge_recon_loss: 2748534.5057; train_gene_expr_recon_loss: 21284446.0916; train_masked_gp_l1_reg_loss: 119276.7416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52278.2837; train_chrom_access_recon_loss: 6100042.7748; train_global_loss: 30411659.2214; train_optim_loss: 30411659.2214; val_kl_reg_loss: 63229.6328; val_edge_recon_loss: 2749321.2500; val_gene_expr_recon_loss: 21328402.9333; val_masked_gp_l1_reg_loss: 119598.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51713.8242; val_chrom_access_recon_loss: 6096292.7333; val_global_loss: 30408558.1333; val_optim_loss: 30408558.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9683; val_auprc_score: 0.9619; val_best_acc_score: 0.9123; val_best_f1_score: 0.9142; train_kl_reg_loss: 98812.6458; train_edge_recon_loss: 2740035.2748; train_gene_expr_recon_loss: 21349458.3664; train_masked_gp_l1_reg_loss: 119860.6850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51154.5862; train_chrom_access_recon_loss: 6099435.0458; train_global_loss: 30458756.5191; train_optim_loss: 30458756.5191; val_kl_reg_loss: 62524.7109; val_edge_recon_loss: 2746229.4833; val_gene_expr_recon_loss: 21288106.2667; val_masked_gp_l1_reg_loss: 119954.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50415.5352; val_chrom_access_recon_loss: 6049538.4000; val_global_loss: 30316768.9333; val_optim_loss: 30316768.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9708; val_auprc_score: 0.9641; val_best_acc_score: 0.9140; val_best_f1_score: 0.9172; train_kl_reg_loss: 96431.0994; train_edge_recon_loss: 2732003.3092; train_gene_expr_recon_loss: 21338311.2061; train_masked_gp_l1_reg_loss: 119523.3483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50121.7926; train_chrom_access_recon_loss: 6098281.7481; train_global_loss: 30434672.6718; train_optim_loss: 30434672.6718; val_kl_reg_loss: 64247.9307; val_edge_recon_loss: 2746999.6167; val_gene_expr_recon_loss: 21330466.2667; val_masked_gp_l1_reg_loss: 119398.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49889.5820; val_chrom_access_recon_loss: 6069808.5000; val_global_loss: 30380810.2667; val_optim_loss: 30380810.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9699; val_auprc_score: 0.9613; val_best_acc_score: 0.9186; val_best_f1_score: 0.9215; train_kl_reg_loss: 97327.6183; train_edge_recon_loss: 2730244.3550; train_gene_expr_recon_loss: 21283348.7939; train_masked_gp_l1_reg_loss: 119352.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49702.8960; train_chrom_access_recon_loss: 6078365.2481; train_global_loss: 30358341.7710; train_optim_loss: 30358341.7710; val_kl_reg_loss: 65344.6146; val_edge_recon_loss: 2740531.2000; val_gene_expr_recon_loss: 21295383.2000; val_masked_gp_l1_reg_loss: 119320.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49513.3594; val_chrom_access_recon_loss: 6067792.2000; val_global_loss: 30337885.3333; val_optim_loss: 30337885.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9667; val_auprc_score: 0.9598; val_best_acc_score: 0.9109; val_best_f1_score: 0.9144; train_kl_reg_loss: 96968.6316; train_edge_recon_loss: 2734429.2385; train_gene_expr_recon_loss: 21292796.5649; train_masked_gp_l1_reg_loss: 119290.7411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49364.7241; train_chrom_access_recon_loss: 6088086.8740; train_global_loss: 30380936.9466; train_optim_loss: 30380936.9466; val_kl_reg_loss: 66042.0714; val_edge_recon_loss: 2753713.4667; val_gene_expr_recon_loss: 21349893.0667; val_masked_gp_l1_reg_loss: 119252.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49174.6094; val_chrom_access_recon_loss: 6081953.4000; val_global_loss: 30420027.8667; val_optim_loss: 30420027.8667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9698; val_auprc_score: 0.9628; val_best_acc_score: 0.9119; val_best_f1_score: 0.9147; train_kl_reg_loss: 96711.6491; train_edge_recon_loss: 2725887.0897; train_gene_expr_recon_loss: 21315966.6870; train_masked_gp_l1_reg_loss: 119211.0625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48955.1342; train_chrom_access_recon_loss: 6098554.1794; train_global_loss: 30405286.0000; train_optim_loss: 30405286.0000; val_kl_reg_loss: 64874.4810; val_edge_recon_loss: 2743643.8167; val_gene_expr_recon_loss: 21340888.9333; val_masked_gp_l1_reg_loss: 119167.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48740.4570; val_chrom_access_recon_loss: 6078552.5333; val_global_loss: 30395867.6000; val_optim_loss: 30395867.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9647
val AUPRC score: 0.9548
val best accuracy score: 0.9095
val best F1 score: 0.9137
val target rna MSE score: 1.1604
val source rna MSE score: 43.5890
val target atac MSE score: 0.5630
val source atac MSE score: 4.3251
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
