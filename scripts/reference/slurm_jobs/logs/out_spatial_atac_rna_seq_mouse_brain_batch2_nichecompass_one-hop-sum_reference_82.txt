[True]
Run timestamp: 10082023_224413_82.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_82']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7723; val_auprc_score: 0.7956; val_best_acc_score: 0.5079; val_best_f1_score: 0.6682; train_kl_reg_loss: 128506.6188; train_edge_recon_loss: 3814123.0382; train_gene_expr_recon_loss: 50601276.4885; train_masked_gp_l1_reg_loss: 94589.0569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245850.3288; train_chrom_access_recon_loss: 81745868.8550; train_global_loss: 136630215.0229; train_optim_loss: 136630215.0229; val_kl_reg_loss: 141942.1974; val_edge_recon_loss: 4064197.6167; val_gene_expr_recon_loss: 40038621.8667; val_masked_gp_l1_reg_loss: 94606.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 244134.4062; val_chrom_access_recon_loss: 70485984.0000; val_global_loss: 115069489.0667; val_optim_loss: 115069489.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7743; val_auprc_score: 0.7968; val_best_acc_score: 0.6508; val_best_f1_score: 0.7165; train_kl_reg_loss: 204510.3221; train_edge_recon_loss: 3825172.2233; train_gene_expr_recon_loss: 39031736.3359; train_masked_gp_l1_reg_loss: 89187.8002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241489.5398; train_chrom_access_recon_loss: 69837066.9924; train_global_loss: 113229163.3588; train_optim_loss: 113229163.3588; val_kl_reg_loss: 183075.8292; val_edge_recon_loss: 4055074.7500; val_gene_expr_recon_loss: 37700744.5333; val_masked_gp_l1_reg_loss: 86209.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238366.5469; val_chrom_access_recon_loss: 69373321.0667; val_global_loss: 111636791.4667; val_optim_loss: 111636791.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8085; val_auprc_score: 0.8224; val_best_acc_score: 0.6982; val_best_f1_score: 0.7434; train_kl_reg_loss: 195092.2943; train_edge_recon_loss: 3640587.4447; train_gene_expr_recon_loss: 37241305.6489; train_masked_gp_l1_reg_loss: 84823.1123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234390.1738; train_chrom_access_recon_loss: 68979222.1374; train_global_loss: 110375420.7634; train_optim_loss: 110375420.7634; val_kl_reg_loss: 206292.3573; val_edge_recon_loss: 3977257.5833; val_gene_expr_recon_loss: 37116154.6667; val_masked_gp_l1_reg_loss: 84282.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230210.7500; val_chrom_access_recon_loss: 68991513.8667; val_global_loss: 110605714.1333; val_optim_loss: 110605714.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8805; val_auprc_score: 0.8736; val_best_acc_score: 0.7947; val_best_f1_score: 0.8085; train_kl_reg_loss: 172044.0042; train_edge_recon_loss: 3496251.5057; train_gene_expr_recon_loss: 36759481.8779; train_masked_gp_l1_reg_loss: 84483.1170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225860.4057; train_chrom_access_recon_loss: 68404745.3130; train_global_loss: 109142866.1985; train_optim_loss: 109142866.1985; val_kl_reg_loss: 155283.0219; val_edge_recon_loss: 3397364.2500; val_gene_expr_recon_loss: 36749127.4667; val_masked_gp_l1_reg_loss: 85214.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221352.8594; val_chrom_access_recon_loss: 68410913.6000; val_global_loss: 109019256.0000; val_optim_loss: 109019256.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8799; val_auprc_score: 0.8668; val_best_acc_score: 0.8006; val_best_f1_score: 0.8187; train_kl_reg_loss: 190524.0958; train_edge_recon_loss: 3130145.1737; train_gene_expr_recon_loss: 36480789.8015; train_masked_gp_l1_reg_loss: 85940.2875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216875.6720; train_chrom_access_recon_loss: 68017163.5725; train_global_loss: 108121438.2290; train_optim_loss: 108121438.2290; val_kl_reg_loss: 216209.2385; val_edge_recon_loss: 3043574.4000; val_gene_expr_recon_loss: 36588420.0000; val_masked_gp_l1_reg_loss: 86584.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212361.2500; val_chrom_access_recon_loss: 68289216.2667; val_global_loss: 108436362.6667; val_optim_loss: 108436362.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8851; val_auprc_score: 0.8714; val_best_acc_score: 0.8005; val_best_f1_score: 0.8181; train_kl_reg_loss: 207361.1947; train_edge_recon_loss: 3025836.8416; train_gene_expr_recon_loss: 36253744.2748; train_masked_gp_l1_reg_loss: 87211.6445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207967.3590; train_chrom_access_recon_loss: 67684257.5878; train_global_loss: 107466379.1145; train_optim_loss: 107466379.1145; val_kl_reg_loss: 207412.1562; val_edge_recon_loss: 3025147.3000; val_gene_expr_recon_loss: 36256269.6000; val_masked_gp_l1_reg_loss: 87945.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203533.1250; val_chrom_access_recon_loss: 67628123.2000; val_global_loss: 107408429.8667; val_optim_loss: 107408429.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9022; val_auprc_score: 0.8902; val_best_acc_score: 0.8145; val_best_f1_score: 0.8292; train_kl_reg_loss: 199998.6552; train_edge_recon_loss: 2982047.5286; train_gene_expr_recon_loss: 36016615.6947; train_masked_gp_l1_reg_loss: 88718.9944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199275.5204; train_chrom_access_recon_loss: 67171231.2672; train_global_loss: 106657887.7557; train_optim_loss: 106657887.7557; val_kl_reg_loss: 188051.3135; val_edge_recon_loss: 2975136.0167; val_gene_expr_recon_loss: 36127866.1333; val_masked_gp_l1_reg_loss: 89705.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194986.0156; val_chrom_access_recon_loss: 67601908.8000; val_global_loss: 107177654.9333; val_optim_loss: 107177654.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9115; val_auprc_score: 0.8988; val_best_acc_score: 0.8317; val_best_f1_score: 0.8405; train_kl_reg_loss: 191416.3860; train_edge_recon_loss: 2964724.3569; train_gene_expr_recon_loss: 35820319.6947; train_masked_gp_l1_reg_loss: 90320.8953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190886.8182; train_chrom_access_recon_loss: 66924331.3282; train_global_loss: 106181999.4504; train_optim_loss: 106181999.4504; val_kl_reg_loss: 191081.9917; val_edge_recon_loss: 2947572.1833; val_gene_expr_recon_loss: 35861718.6667; val_masked_gp_l1_reg_loss: 91175.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186862.9375; val_chrom_access_recon_loss: 66993123.4667; val_global_loss: 106271536.5333; val_optim_loss: 106271536.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9261; val_auprc_score: 0.9157; val_best_acc_score: 0.8479; val_best_f1_score: 0.8556; train_kl_reg_loss: 186182.9433; train_edge_recon_loss: 2928848.3435; train_gene_expr_recon_loss: 35677596.8550; train_masked_gp_l1_reg_loss: 92170.5510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183017.1274; train_chrom_access_recon_loss: 66684549.4351; train_global_loss: 105752365.0687; train_optim_loss: 105752365.0687; val_kl_reg_loss: 180813.1104; val_edge_recon_loss: 2926400.2667; val_gene_expr_recon_loss: 35677024.5333; val_masked_gp_l1_reg_loss: 93109.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179261.4531; val_chrom_access_recon_loss: 66507801.3333; val_global_loss: 105564407.4667; val_optim_loss: 105564407.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9343; val_auprc_score: 0.9250; val_best_acc_score: 0.8605; val_best_f1_score: 0.8690; train_kl_reg_loss: 182277.0635; train_edge_recon_loss: 2901171.1508; train_gene_expr_recon_loss: 35519030.5954; train_masked_gp_l1_reg_loss: 94090.5915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175592.0199; train_chrom_access_recon_loss: 66406345.1298; train_global_loss: 105278505.9542; train_optim_loss: 105278505.9542; val_kl_reg_loss: 183280.8188; val_edge_recon_loss: 2899822.2833; val_gene_expr_recon_loss: 35574529.0667; val_masked_gp_l1_reg_loss: 94774.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172022.5938; val_chrom_access_recon_loss: 66483280.8000; val_global_loss: 105407712.5333; val_optim_loss: 105407712.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9421; val_auprc_score: 0.9305; val_best_acc_score: 0.8715; val_best_f1_score: 0.8791; train_kl_reg_loss: 180231.7904; train_edge_recon_loss: 2874268.8225; train_gene_expr_recon_loss: 35368142.3817; train_masked_gp_l1_reg_loss: 95954.0967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168554.8414; train_chrom_access_recon_loss: 66116606.5954; train_global_loss: 104803758.5344; train_optim_loss: 104803758.5344; val_kl_reg_loss: 181083.7031; val_edge_recon_loss: 2853606.6833; val_gene_expr_recon_loss: 35434461.0667; val_masked_gp_l1_reg_loss: 96965.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165117.0938; val_chrom_access_recon_loss: 66299680.2667; val_global_loss: 105030911.4667; val_optim_loss: 105030911.4667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9440; val_auprc_score: 0.9335; val_best_acc_score: 0.8739; val_best_f1_score: 0.8807; train_kl_reg_loss: 178234.2926; train_edge_recon_loss: 2856840.1202; train_gene_expr_recon_loss: 35280560.0305; train_masked_gp_l1_reg_loss: 97844.4030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161788.5221; train_chrom_access_recon_loss: 65928466.8092; train_global_loss: 104503734.2901; train_optim_loss: 104503734.2901; val_kl_reg_loss: 177970.3833; val_edge_recon_loss: 2861730.5500; val_gene_expr_recon_loss: 35259044.0000; val_masked_gp_l1_reg_loss: 98664.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158473.6875; val_chrom_access_recon_loss: 65753332.5333; val_global_loss: 104309213.8667; val_optim_loss: 104309213.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9489; val_auprc_score: 0.9381; val_best_acc_score: 0.8845; val_best_f1_score: 0.8902; train_kl_reg_loss: 173521.5017; train_edge_recon_loss: 2841950.4256; train_gene_expr_recon_loss: 35133954.0458; train_masked_gp_l1_reg_loss: 99571.6445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155357.4297; train_chrom_access_recon_loss: 65616334.7176; train_global_loss: 104020689.7099; train_optim_loss: 104020689.7099; val_kl_reg_loss: 176070.8250; val_edge_recon_loss: 2841893.6500; val_gene_expr_recon_loss: 35408188.5333; val_masked_gp_l1_reg_loss: 100460.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152264.6562; val_chrom_access_recon_loss: 66186867.2000; val_global_loss: 104865744.5333; val_optim_loss: 104865744.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9540; val_auprc_score: 0.9472; val_best_acc_score: 0.8886; val_best_f1_score: 0.8926; train_kl_reg_loss: 170505.0883; train_edge_recon_loss: 2831736.1985; train_gene_expr_recon_loss: 35005321.4198; train_masked_gp_l1_reg_loss: 101377.9602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149285.5757; train_chrom_access_recon_loss: 65308294.8092; train_global_loss: 103566520.9160; train_optim_loss: 103566520.9160; val_kl_reg_loss: 168064.8792; val_edge_recon_loss: 2831029.6500; val_gene_expr_recon_loss: 35306318.4000; val_masked_gp_l1_reg_loss: 102181.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146394.8750; val_chrom_access_recon_loss: 65864988.2667; val_global_loss: 104418977.0667; val_optim_loss: 104418977.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9548; val_auprc_score: 0.9458; val_best_acc_score: 0.8918; val_best_f1_score: 0.8968; train_kl_reg_loss: 166886.6335; train_edge_recon_loss: 2825492.9733; train_gene_expr_recon_loss: 35016770.0000; train_masked_gp_l1_reg_loss: 103075.2303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143596.0672; train_chrom_access_recon_loss: 65391596.3359; train_global_loss: 103647417.4046; train_optim_loss: 103647417.4046; val_kl_reg_loss: 165327.3760; val_edge_recon_loss: 2818878.7500; val_gene_expr_recon_loss: 35172881.0667; val_masked_gp_l1_reg_loss: 103960.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140938.4375; val_chrom_access_recon_loss: 65927756.8000; val_global_loss: 104329745.0667; val_optim_loss: 104329745.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9559; val_auprc_score: 0.9484; val_best_acc_score: 0.8930; val_best_f1_score: 0.8971; train_kl_reg_loss: 163779.6306; train_edge_recon_loss: 2812365.6660; train_gene_expr_recon_loss: 34905353.6031; train_masked_gp_l1_reg_loss: 104803.9965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138329.3794; train_chrom_access_recon_loss: 65155769.7405; train_global_loss: 103280402.1985; train_optim_loss: 103280402.1985; val_kl_reg_loss: 164194.7521; val_edge_recon_loss: 2804633.2833; val_gene_expr_recon_loss: 35039276.8000; val_masked_gp_l1_reg_loss: 105572.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135789.7656; val_chrom_access_recon_loss: 65628196.5333; val_global_loss: 103877661.3333; val_optim_loss: 103877661.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9543; val_auprc_score: 0.9464; val_best_acc_score: 0.8895; val_best_f1_score: 0.8940; train_kl_reg_loss: 161129.0447; train_edge_recon_loss: 2804874.6011; train_gene_expr_recon_loss: 34826247.9237; train_masked_gp_l1_reg_loss: 106395.8209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133463.2597; train_chrom_access_recon_loss: 64988005.9542; train_global_loss: 103020116.8244; train_optim_loss: 103020116.8244; val_kl_reg_loss: 160898.8927; val_edge_recon_loss: 2825507.5833; val_gene_expr_recon_loss: 35005111.0667; val_masked_gp_l1_reg_loss: 107325.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131100.2500; val_chrom_access_recon_loss: 65476407.7333; val_global_loss: 103706348.8000; val_optim_loss: 103706348.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9597; val_auprc_score: 0.9532; val_best_acc_score: 0.8937; val_best_f1_score: 0.8975; train_kl_reg_loss: 157401.1803; train_edge_recon_loss: 2800059.2557; train_gene_expr_recon_loss: 34722532.8855; train_masked_gp_l1_reg_loss: 108181.7899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128926.0357; train_chrom_access_recon_loss: 64724207.1145; train_global_loss: 102641308.1527; train_optim_loss: 102641308.1527; val_kl_reg_loss: 152400.6625; val_edge_recon_loss: 2825894.9167; val_gene_expr_recon_loss: 34847112.9333; val_masked_gp_l1_reg_loss: 108818.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126765.9922; val_chrom_access_recon_loss: 65014951.7333; val_global_loss: 103075945.6000; val_optim_loss: 103075945.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9602; val_auprc_score: 0.9531; val_best_acc_score: 0.8946; val_best_f1_score: 0.8984; train_kl_reg_loss: 155261.9198; train_edge_recon_loss: 2795292.3282; train_gene_expr_recon_loss: 34699128.8397; train_masked_gp_l1_reg_loss: 109561.2112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124714.9897; train_chrom_access_recon_loss: 64727081.1908; train_global_loss: 102611040.1832; train_optim_loss: 102611040.1832; val_kl_reg_loss: 151228.2427; val_edge_recon_loss: 2817159.8667; val_gene_expr_recon_loss: 34870102.0000; val_masked_gp_l1_reg_loss: 110179.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122747.5078; val_chrom_access_recon_loss: 64897213.3333; val_global_loss: 102968632.0000; val_optim_loss: 102968632.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9621; val_auprc_score: 0.9553; val_best_acc_score: 0.8991; val_best_f1_score: 0.9037; train_kl_reg_loss: 152626.6703; train_edge_recon_loss: 2788541.3435; train_gene_expr_recon_loss: 34651476.7939; train_masked_gp_l1_reg_loss: 111177.6013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120780.1323; train_chrom_access_recon_loss: 64686614.9924; train_global_loss: 102511217.7099; train_optim_loss: 102511217.7099; val_kl_reg_loss: 151421.9667; val_edge_recon_loss: 2796846.7500; val_gene_expr_recon_loss: 34839480.5333; val_masked_gp_l1_reg_loss: 111895.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118814.1094; val_chrom_access_recon_loss: 64848465.3333; val_global_loss: 102866926.9333; val_optim_loss: 102866926.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9674; val_auprc_score: 0.9591; val_best_acc_score: 0.9104; val_best_f1_score: 0.9135; train_kl_reg_loss: 150232.4276; train_edge_recon_loss: 2786364.8282; train_gene_expr_recon_loss: 34577750.5344; train_masked_gp_l1_reg_loss: 112707.0570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116973.5944; train_chrom_access_recon_loss: 64494200.4885; train_global_loss: 102238229.0076; train_optim_loss: 102238229.0076; val_kl_reg_loss: 146754.7042; val_edge_recon_loss: 2786780.6167; val_gene_expr_recon_loss: 34748083.4667; val_masked_gp_l1_reg_loss: 113382.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115134.6719; val_chrom_access_recon_loss: 65071609.3333; val_global_loss: 102981748.2667; val_optim_loss: 102981748.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9622; val_auprc_score: 0.9551; val_best_acc_score: 0.9004; val_best_f1_score: 0.9030; train_kl_reg_loss: 149906.4194; train_edge_recon_loss: 2788578.8893; train_gene_expr_recon_loss: 34705249.4046; train_masked_gp_l1_reg_loss: 113553.3024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113157.3281; train_chrom_access_recon_loss: 64502582.5954; train_global_loss: 102373027.6641; train_optim_loss: 102373027.6641; val_kl_reg_loss: 152290.3885; val_edge_recon_loss: 2789833.3000; val_gene_expr_recon_loss: 34685480.0000; val_masked_gp_l1_reg_loss: 113610.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110905.9453; val_chrom_access_recon_loss: 64472277.6000; val_global_loss: 102324396.8000; val_optim_loss: 102324396.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9622; val_auprc_score: 0.9552; val_best_acc_score: 0.9022; val_best_f1_score: 0.9055; train_kl_reg_loss: 151266.2776; train_edge_recon_loss: 2781683.2462; train_gene_expr_recon_loss: 34499215.7863; train_masked_gp_l1_reg_loss: 114213.1687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109157.5827; train_chrom_access_recon_loss: 64367331.1756; train_global_loss: 102022867.1756; train_optim_loss: 102022867.1756; val_kl_reg_loss: 148698.2198; val_edge_recon_loss: 2803626.7167; val_gene_expr_recon_loss: 34741477.7333; val_masked_gp_l1_reg_loss: 114843.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107428.8438; val_chrom_access_recon_loss: 64720089.8667; val_global_loss: 102636164.8000; val_optim_loss: 102636164.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9653; val_auprc_score: 0.9592; val_best_acc_score: 0.9057; val_best_f1_score: 0.9094; train_kl_reg_loss: 147824.4693; train_edge_recon_loss: 2772105.4122; train_gene_expr_recon_loss: 34397091.2214; train_masked_gp_l1_reg_loss: 115752.2821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105814.4203; train_chrom_access_recon_loss: 64185301.0687; train_global_loss: 101723888.6718; train_optim_loss: 101723888.6718; val_kl_reg_loss: 145209.6042; val_edge_recon_loss: 2805448.6667; val_gene_expr_recon_loss: 34570845.7333; val_masked_gp_l1_reg_loss: 116445.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104188.2578; val_chrom_access_recon_loss: 64339426.4000; val_global_loss: 102081562.1333; val_optim_loss: 102081562.1333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9697; val_auprc_score: 0.9618; val_best_acc_score: 0.9123; val_best_f1_score: 0.9151; train_kl_reg_loss: 145168.3253; train_edge_recon_loss: 2771717.1794; train_gene_expr_recon_loss: 34390182.5802; train_masked_gp_l1_reg_loss: 117362.7831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102688.3843; train_chrom_access_recon_loss: 64211457.8626; train_global_loss: 101738577.4046; train_optim_loss: 101738577.4046; val_kl_reg_loss: 145355.9802; val_edge_recon_loss: 2775959.1333; val_gene_expr_recon_loss: 34528056.5333; val_masked_gp_l1_reg_loss: 118055.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101203.0156; val_chrom_access_recon_loss: 64489724.0000; val_global_loss: 102158355.7333; val_optim_loss: 102158355.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9289; val_auprc_score: 0.9204; val_best_acc_score: 0.8503; val_best_f1_score: 0.8540; train_kl_reg_loss: 170566.4905; train_edge_recon_loss: 3051282.3531; train_gene_expr_recon_loss: 39373560.2443; train_masked_gp_l1_reg_loss: 119698.4419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109271.7910; train_chrom_access_recon_loss: 66392898.8702; train_global_loss: 109217278.2901; train_optim_loss: 109217278.2901; val_kl_reg_loss: 25285.2410; val_edge_recon_loss: 2933954.8833; val_gene_expr_recon_loss: 40598857.8667; val_masked_gp_l1_reg_loss: 120021.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114366.3594; val_chrom_access_recon_loss: 66941977.3333; val_global_loss: 110734464.5333; val_optim_loss: 110734464.5333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9291; val_auprc_score: 0.9166; val_best_acc_score: 0.8546; val_best_f1_score: 0.8625; train_kl_reg_loss: 118489.8125; train_edge_recon_loss: 2869037.9160; train_gene_expr_recon_loss: 39964242.5649; train_masked_gp_l1_reg_loss: 117369.0193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113033.5474; train_chrom_access_recon_loss: 66510191.9695; train_global_loss: 109692364.8244; train_optim_loss: 109692364.8244; val_kl_reg_loss: 32652.9947; val_edge_recon_loss: 2837249.9500; val_gene_expr_recon_loss: 39739477.6000; val_masked_gp_l1_reg_loss: 114593.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111154.9922; val_chrom_access_recon_loss: 66805779.7333; val_global_loss: 109640907.7333; val_optim_loss: 109640907.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9395; val_auprc_score: 0.9225; val_best_acc_score: 0.8742; val_best_f1_score: 0.8808; train_kl_reg_loss: 79713.2177; train_edge_recon_loss: 2782698.1622; train_gene_expr_recon_loss: 39268188.0000; train_masked_gp_l1_reg_loss: 111968.8284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109077.7663; train_chrom_access_recon_loss: 66191801.3435; train_global_loss: 108543447.2672; train_optim_loss: 108543447.2672; val_kl_reg_loss: 38747.9906; val_edge_recon_loss: 2784488.3000; val_gene_expr_recon_loss: 39281454.9333; val_masked_gp_l1_reg_loss: 109358.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106995.5078; val_chrom_access_recon_loss: 66554577.0667; val_global_loss: 108875623.4667; val_optim_loss: 108875623.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9392; val_auprc_score: 0.9208; val_best_acc_score: 0.8744; val_best_f1_score: 0.8814; train_kl_reg_loss: 70748.3347; train_edge_recon_loss: 2745881.8435; train_gene_expr_recon_loss: 38964656.3359; train_masked_gp_l1_reg_loss: 108898.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106682.7075; train_chrom_access_recon_loss: 66028523.3893; train_global_loss: 108025390.6565; train_optim_loss: 108025390.6565; val_kl_reg_loss: 40304.6276; val_edge_recon_loss: 2767553.1167; val_gene_expr_recon_loss: 39158077.8667; val_masked_gp_l1_reg_loss: 108604.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106377.8594; val_chrom_access_recon_loss: 66441370.4000; val_global_loss: 108622286.9333; val_optim_loss: 108622286.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9395; val_auprc_score: 0.9224; val_best_acc_score: 0.8775; val_best_f1_score: 0.8844; train_kl_reg_loss: 70228.9999; train_edge_recon_loss: 2748708.0573; train_gene_expr_recon_loss: 38971763.0229; train_masked_gp_l1_reg_loss: 108316.0647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106094.8198; train_chrom_access_recon_loss: 66147087.9389; train_global_loss: 108152199.0229; train_optim_loss: 108152199.0229; val_kl_reg_loss: 41115.4758; val_edge_recon_loss: 2766542.1167; val_gene_expr_recon_loss: 38937532.2667; val_masked_gp_l1_reg_loss: 108023.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105804.5391; val_chrom_access_recon_loss: 66222903.2000; val_global_loss: 108181921.0667; val_optim_loss: 108181921.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9390; val_auprc_score: 0.9230; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 69665.5092; train_edge_recon_loss: 2740033.2958; train_gene_expr_recon_loss: 38925639.9389; train_masked_gp_l1_reg_loss: 107723.8627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105516.1379; train_chrom_access_recon_loss: 66118372.2443; train_global_loss: 108066950.9618; train_optim_loss: 108066950.9618; val_kl_reg_loss: 41771.2445; val_edge_recon_loss: 2760724.5833; val_gene_expr_recon_loss: 39085445.0667; val_masked_gp_l1_reg_loss: 107414.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105224.7188; val_chrom_access_recon_loss: 66675978.6667; val_global_loss: 108776558.4000; val_optim_loss: 108776558.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9384; val_auprc_score: 0.9198; val_best_acc_score: 0.8743; val_best_f1_score: 0.8801; train_kl_reg_loss: 68815.5296; train_edge_recon_loss: 2735250.8702; train_gene_expr_recon_loss: 38886821.9847; train_masked_gp_l1_reg_loss: 107097.8867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104938.6978; train_chrom_access_recon_loss: 66127768.0000; train_global_loss: 108030692.9466; train_optim_loss: 108030692.9466; val_kl_reg_loss: 42556.2008; val_edge_recon_loss: 2771500.3333; val_gene_expr_recon_loss: 38969473.0667; val_masked_gp_l1_reg_loss: 106774.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104631.3203; val_chrom_access_recon_loss: 66234872.0000; val_global_loss: 108229810.1333; val_optim_loss: 108229810.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 42 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9649
val AUPRC score: 0.9574
val best accuracy score: 0.9069
val best F1 score: 0.9117
val target rna MSE score: 1.4248
val source rna MSE score: 103.5495
val target atac MSE score: 0.1283
val source atac MSE score: 0.9968
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
