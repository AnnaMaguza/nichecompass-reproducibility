[True]
Run timestamp: 10082023_214308_61.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_61']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7856; val_auprc_score: 0.8045; val_best_acc_score: 0.5645; val_best_f1_score: 0.6937; train_kl_reg_loss: 168558.3745; train_edge_recon_loss: 3741684.4275; train_gene_expr_recon_loss: 48354054.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25765462.1985; train_global_loss: 78029760.2137; train_optim_loss: 78029760.2137; val_kl_reg_loss: 178726.3865; val_edge_recon_loss: 4062013.8667; val_gene_expr_recon_loss: 38465376.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23257877.2000; val_global_loss: 65963993.6000; val_optim_loss: 65963993.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7708; val_auprc_score: 0.8005; val_best_acc_score: 0.6082; val_best_f1_score: 0.7027; train_kl_reg_loss: 176225.5047; train_edge_recon_loss: 3796629.5687; train_gene_expr_recon_loss: 38619196.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23251432.1374; train_global_loss: 65843483.8473; train_optim_loss: 65843483.8473; val_kl_reg_loss: 121239.6620; val_edge_recon_loss: 4059084.7333; val_gene_expr_recon_loss: 37177362.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23013710.6667; val_global_loss: 64371397.8667; val_optim_loss: 64371397.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8103; val_auprc_score: 0.8284; val_best_acc_score: 0.7277; val_best_f1_score: 0.7314; train_kl_reg_loss: 150409.9043; train_edge_recon_loss: 3745578.9981; train_gene_expr_recon_loss: 37519792.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23035427.2824; train_global_loss: 64451208.7023; train_optim_loss: 64451208.7023; val_kl_reg_loss: 210425.3042; val_edge_recon_loss: 4043300.6333; val_gene_expr_recon_loss: 36695059.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22871070.9333; val_global_loss: 63819854.9333; val_optim_loss: 63819854.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8816; val_auprc_score: 0.8837; val_best_acc_score: 0.7747; val_best_f1_score: 0.8023; train_kl_reg_loss: 170399.7164; train_edge_recon_loss: 3586427.3511; train_gene_expr_recon_loss: 36887737.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22842842.9771; train_global_loss: 63487407.2061; train_optim_loss: 63487407.2061; val_kl_reg_loss: 175898.3156; val_edge_recon_loss: 3976110.2667; val_gene_expr_recon_loss: 36355628.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22707314.0000; val_global_loss: 63214951.4667; val_optim_loss: 63214951.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8837; val_auprc_score: 0.8814; val_best_acc_score: 0.7879; val_best_f1_score: 0.8002; train_kl_reg_loss: 144740.8765; train_edge_recon_loss: 3480826.3798; train_gene_expr_recon_loss: 36540333.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22748603.6489; train_global_loss: 62914504.0611; train_optim_loss: 62914504.0611; val_kl_reg_loss: 132125.6255; val_edge_recon_loss: 3355041.3667; val_gene_expr_recon_loss: 36109896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22656309.7333; val_global_loss: 62253373.3333; val_optim_loss: 62253373.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8913; val_auprc_score: 0.8831; val_best_acc_score: 0.8029; val_best_f1_score: 0.8169; train_kl_reg_loss: 172255.8336; train_edge_recon_loss: 3085163.5095; train_gene_expr_recon_loss: 36275285.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22605177.8626; train_global_loss: 62137882.2595; train_optim_loss: 62137882.2595; val_kl_reg_loss: 184918.7156; val_edge_recon_loss: 3009238.6833; val_gene_expr_recon_loss: 35801462.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22416708.2667; val_global_loss: 61412327.4667; val_optim_loss: 61412327.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8999; val_auprc_score: 0.8869; val_best_acc_score: 0.8161; val_best_f1_score: 0.8345; train_kl_reg_loss: 180400.8062; train_edge_recon_loss: 2987503.6317; train_gene_expr_recon_loss: 36042953.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22478344.4580; train_global_loss: 61689202.8092; train_optim_loss: 61689202.8092; val_kl_reg_loss: 178903.3813; val_edge_recon_loss: 2945245.7500; val_gene_expr_recon_loss: 35451159.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22344374.6667; val_global_loss: 60919683.4667; val_optim_loss: 60919683.4667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9082; val_auprc_score: 0.8952; val_best_acc_score: 0.8246; val_best_f1_score: 0.8383; train_kl_reg_loss: 175054.9825; train_edge_recon_loss: 2939963.7691; train_gene_expr_recon_loss: 35831058.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22351375.8626; train_global_loss: 61297453.0687; train_optim_loss: 61297453.0687; val_kl_reg_loss: 162995.6292; val_edge_recon_loss: 2961205.3833; val_gene_expr_recon_loss: 35479908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22302258.9333; val_global_loss: 60906367.7333; val_optim_loss: 60906367.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9239; val_auprc_score: 0.9137; val_best_acc_score: 0.8448; val_best_f1_score: 0.8537; train_kl_reg_loss: 173156.5079; train_edge_recon_loss: 2898926.3034; train_gene_expr_recon_loss: 35641811.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22243328.2443; train_global_loss: 60957222.9618; train_optim_loss: 60957222.9618; val_kl_reg_loss: 169140.8969; val_edge_recon_loss: 2894907.0833; val_gene_expr_recon_loss: 35354188.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22271039.7333; val_global_loss: 60689275.7333; val_optim_loss: 60689275.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9324; val_auprc_score: 0.9222; val_best_acc_score: 0.8568; val_best_f1_score: 0.8650; train_kl_reg_loss: 166792.6498; train_edge_recon_loss: 2879201.9218; train_gene_expr_recon_loss: 35504874.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22154847.8473; train_global_loss: 60705716.8244; train_optim_loss: 60705716.8244; val_kl_reg_loss: 164451.1094; val_edge_recon_loss: 2877142.4000; val_gene_expr_recon_loss: 35170219.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22146043.8667; val_global_loss: 60357856.2667; val_optim_loss: 60357856.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9395; val_auprc_score: 0.9283; val_best_acc_score: 0.8720; val_best_f1_score: 0.8750; train_kl_reg_loss: 161784.5864; train_edge_recon_loss: 2850038.4504; train_gene_expr_recon_loss: 35321304.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22042647.3893; train_global_loss: 60375775.2977; train_optim_loss: 60375775.2977; val_kl_reg_loss: 158516.5187; val_edge_recon_loss: 2868032.4500; val_gene_expr_recon_loss: 35071977.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22055792.9333; val_global_loss: 60154319.2000; val_optim_loss: 60154319.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9513; val_auprc_score: 0.9436; val_best_acc_score: 0.8818; val_best_f1_score: 0.8892; train_kl_reg_loss: 157085.0689; train_edge_recon_loss: 2836027.7996; train_gene_expr_recon_loss: 35216824.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21985781.7252; train_global_loss: 60195719.3282; train_optim_loss: 60195719.3282; val_kl_reg_loss: 151359.7833; val_edge_recon_loss: 2839095.2000; val_gene_expr_recon_loss: 34847528.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21917473.0667; val_global_loss: 59755457.3333; val_optim_loss: 59755457.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9567; val_auprc_score: 0.9473; val_best_acc_score: 0.8964; val_best_f1_score: 0.9003; train_kl_reg_loss: 155001.5714; train_edge_recon_loss: 2816711.0134; train_gene_expr_recon_loss: 35110141.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21944966.4733; train_global_loss: 60026820.6412; train_optim_loss: 60026820.6412; val_kl_reg_loss: 152871.1219; val_edge_recon_loss: 2796605.4333; val_gene_expr_recon_loss: 34782394.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21798932.5333; val_global_loss: 59530804.0000; val_optim_loss: 59530804.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9422; val_best_acc_score: 0.8942; val_best_f1_score: 0.8974; train_kl_reg_loss: 151684.4257; train_edge_recon_loss: 2795981.7347; train_gene_expr_recon_loss: 35020542.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21877992.9466; train_global_loss: 59846201.7099; train_optim_loss: 59846201.7099; val_kl_reg_loss: 153625.7542; val_edge_recon_loss: 2804536.0500; val_gene_expr_recon_loss: 34756713.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21797311.6000; val_global_loss: 59512186.9333; val_optim_loss: 59512186.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9550; val_auprc_score: 0.9452; val_best_acc_score: 0.8973; val_best_f1_score: 0.9009; train_kl_reg_loss: 148230.4735; train_edge_recon_loss: 2791264.2920; train_gene_expr_recon_loss: 34892786.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21784721.6947; train_global_loss: 59617002.6870; train_optim_loss: 59617002.6870; val_kl_reg_loss: 146280.9531; val_edge_recon_loss: 2809429.9667; val_gene_expr_recon_loss: 34535445.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21673295.7333; val_global_loss: 59164452.2667; val_optim_loss: 59164452.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9596; val_auprc_score: 0.9512; val_best_acc_score: 0.8995; val_best_f1_score: 0.9037; train_kl_reg_loss: 144365.2152; train_edge_recon_loss: 2787039.4618; train_gene_expr_recon_loss: 34811989.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21739103.9542; train_global_loss: 59482497.4046; train_optim_loss: 59482497.4046; val_kl_reg_loss: 143458.9896; val_edge_recon_loss: 2810694.4667; val_gene_expr_recon_loss: 34648084.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21769835.4667; val_global_loss: 59372074.1333; val_optim_loss: 59372074.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9638; val_auprc_score: 0.9562; val_best_acc_score: 0.9066; val_best_f1_score: 0.9106; train_kl_reg_loss: 141582.3316; train_edge_recon_loss: 2771082.6336; train_gene_expr_recon_loss: 34732269.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21687570.6870; train_global_loss: 59332505.1908; train_optim_loss: 59332505.1908; val_kl_reg_loss: 140221.5438; val_edge_recon_loss: 2781648.8167; val_gene_expr_recon_loss: 34534696.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21667107.4667; val_global_loss: 59123674.4000; val_optim_loss: 59123674.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9662; val_auprc_score: 0.9599; val_best_acc_score: 0.9088; val_best_f1_score: 0.9117; train_kl_reg_loss: 138498.8229; train_edge_recon_loss: 2773617.4981; train_gene_expr_recon_loss: 34655198.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21679093.4962; train_global_loss: 59246408.0305; train_optim_loss: 59246408.0305; val_kl_reg_loss: 139013.9156; val_edge_recon_loss: 2772617.6000; val_gene_expr_recon_loss: 34457481.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21622565.4667; val_global_loss: 58991677.3333; val_optim_loss: 58991677.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9656; val_auprc_score: 0.9585; val_best_acc_score: 0.9109; val_best_f1_score: 0.9142; train_kl_reg_loss: 135976.3447; train_edge_recon_loss: 2763740.6927; train_gene_expr_recon_loss: 34589561.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21646803.8931; train_global_loss: 59136083.1756; train_optim_loss: 59136083.1756; val_kl_reg_loss: 136693.0021; val_edge_recon_loss: 2801290.5333; val_gene_expr_recon_loss: 34380502.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21591725.7333; val_global_loss: 58910210.6667; val_optim_loss: 58910210.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9705; val_auprc_score: 0.9656; val_best_acc_score: 0.9190; val_best_f1_score: 0.9229; train_kl_reg_loss: 133251.9076; train_edge_recon_loss: 2756473.6813; train_gene_expr_recon_loss: 34497621.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21578023.4656; train_global_loss: 58965370.1069; train_optim_loss: 58965370.1069; val_kl_reg_loss: 133119.0823; val_edge_recon_loss: 2751262.4667; val_gene_expr_recon_loss: 34100308.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21393352.5333; val_global_loss: 58378042.4000; val_optim_loss: 58378042.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9686; val_auprc_score: 0.9617; val_best_acc_score: 0.9153; val_best_f1_score: 0.9179; train_kl_reg_loss: 129754.7403; train_edge_recon_loss: 2762992.4275; train_gene_expr_recon_loss: 34443344.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21552210.2290; train_global_loss: 58888301.9542; train_optim_loss: 58888301.9542; val_kl_reg_loss: 130899.8875; val_edge_recon_loss: 2761103.9000; val_gene_expr_recon_loss: 34301724.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21504152.9333; val_global_loss: 58697880.5333; val_optim_loss: 58697880.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9719; val_auprc_score: 0.9676; val_best_acc_score: 0.9170; val_best_f1_score: 0.9197; train_kl_reg_loss: 128473.5220; train_edge_recon_loss: 2749688.6164; train_gene_expr_recon_loss: 34358231.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21523243.6947; train_global_loss: 58759637.0992; train_optim_loss: 58759637.0992; val_kl_reg_loss: 126184.9703; val_edge_recon_loss: 2749681.0833; val_gene_expr_recon_loss: 34012730.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21360796.4000; val_global_loss: 58249393.0667; val_optim_loss: 58249393.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9710; val_auprc_score: 0.9634; val_best_acc_score: 0.9163; val_best_f1_score: 0.9197; train_kl_reg_loss: 126660.5429; train_edge_recon_loss: 2751587.2099; train_gene_expr_recon_loss: 34290756.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21476774.8550; train_global_loss: 58645778.5038; train_optim_loss: 58645778.5038; val_kl_reg_loss: 126255.7823; val_edge_recon_loss: 2772029.0667; val_gene_expr_recon_loss: 34288550.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21706858.8000; val_global_loss: 58893694.1333; val_optim_loss: 58893694.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9712; val_auprc_score: 0.9653; val_best_acc_score: 0.9204; val_best_f1_score: 0.9223; train_kl_reg_loss: 124335.8538; train_edge_recon_loss: 2751615.1450; train_gene_expr_recon_loss: 34325442.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21512847.4046; train_global_loss: 58714240.9771; train_optim_loss: 58714240.9771; val_kl_reg_loss: 120333.8979; val_edge_recon_loss: 2767137.9667; val_gene_expr_recon_loss: 34074660.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21379124.1333; val_global_loss: 58341257.3333; val_optim_loss: 58341257.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9704; val_auprc_score: 0.9651; val_best_acc_score: 0.9189; val_best_f1_score: 0.9220; train_kl_reg_loss: 122932.2148; train_edge_recon_loss: 2750288.1698; train_gene_expr_recon_loss: 34180801.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21424285.1756; train_global_loss: 58478306.9618; train_optim_loss: 58478306.9618; val_kl_reg_loss: 122087.7375; val_edge_recon_loss: 2761459.8500; val_gene_expr_recon_loss: 33937617.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21305591.3333; val_global_loss: 58126756.8000; val_optim_loss: 58126756.8000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9483; val_auprc_score: 0.9380; val_best_acc_score: 0.8824; val_best_f1_score: 0.8894; train_kl_reg_loss: 123177.6719; train_edge_recon_loss: 2961344.9618; train_gene_expr_recon_loss: 37166598.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21885373.7863; train_global_loss: 62136494.7176; train_optim_loss: 62136494.7176; val_kl_reg_loss: 48183.0099; val_edge_recon_loss: 2843500.4667; val_gene_expr_recon_loss: 36548408.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21772288.5333; val_global_loss: 61212381.0667; val_optim_loss: 61212381.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9489; val_auprc_score: 0.9384; val_best_acc_score: 0.8861; val_best_f1_score: 0.8921; train_kl_reg_loss: 125398.0242; train_edge_recon_loss: 2831975.7252; train_gene_expr_recon_loss: 37060833.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21894952.9771; train_global_loss: 61913159.7252; train_optim_loss: 61913159.7252; val_kl_reg_loss: 46974.2458; val_edge_recon_loss: 2832957.3667; val_gene_expr_recon_loss: 36734721.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21821038.8000; val_global_loss: 61435692.8000; val_optim_loss: 61435692.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9528; val_auprc_score: 0.9422; val_best_acc_score: 0.8871; val_best_f1_score: 0.8928; train_kl_reg_loss: 120317.6518; train_edge_recon_loss: 2823937.7385; train_gene_expr_recon_loss: 37345134.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21874910.2443; train_global_loss: 62164300.0305; train_optim_loss: 62164300.0305; val_kl_reg_loss: 40076.7083; val_edge_recon_loss: 2819161.5833; val_gene_expr_recon_loss: 37150443.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21828076.9333; val_global_loss: 61837758.6667; val_optim_loss: 61837758.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9596; val_auprc_score: 0.9508; val_best_acc_score: 0.9053; val_best_f1_score: 0.9090; train_kl_reg_loss: 105830.4355; train_edge_recon_loss: 2770890.6794; train_gene_expr_recon_loss: 37235630.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21826246.4733; train_global_loss: 61938598.2901; train_optim_loss: 61938598.2901; val_kl_reg_loss: 47939.0656; val_edge_recon_loss: 2761524.3333; val_gene_expr_recon_loss: 36841763.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21835897.3333; val_global_loss: 61487125.0667; val_optim_loss: 61487125.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9589; val_auprc_score: 0.9452; val_best_acc_score: 0.9066; val_best_f1_score: 0.9093; train_kl_reg_loss: 97043.2208; train_edge_recon_loss: 2751535.6126; train_gene_expr_recon_loss: 37102494.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21849093.4809; train_global_loss: 61800167.0229; train_optim_loss: 61800167.0229; val_kl_reg_loss: 49716.0435; val_edge_recon_loss: 2746962.4833; val_gene_expr_recon_loss: 36789542.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21777766.1333; val_global_loss: 61363987.4667; val_optim_loss: 61363987.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9623; val_auprc_score: 0.9504; val_best_acc_score: 0.9049; val_best_f1_score: 0.9076; train_kl_reg_loss: 96244.8123; train_edge_recon_loss: 2745720.6947; train_gene_expr_recon_loss: 37006441.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21766075.6947; train_global_loss: 61614482.3817; train_optim_loss: 61614482.3817; val_kl_reg_loss: 50549.6052; val_edge_recon_loss: 2735037.5667; val_gene_expr_recon_loss: 36496554.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21627618.5333; val_global_loss: 60909760.0000; val_optim_loss: 60909760.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9601; val_auprc_score: 0.9510; val_best_acc_score: 0.9033; val_best_f1_score: 0.9063; train_kl_reg_loss: 94426.9209; train_edge_recon_loss: 2749154.3569; train_gene_expr_recon_loss: 37025062.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21789954.2290; train_global_loss: 61658598.1985; train_optim_loss: 61658598.1985; val_kl_reg_loss: 51288.2594; val_edge_recon_loss: 2753961.5833; val_gene_expr_recon_loss: 36737460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21689087.6000; val_global_loss: 61231797.3333; val_optim_loss: 61231797.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9623; val_auprc_score: 0.9487; val_best_acc_score: 0.9097; val_best_f1_score: 0.9123; train_kl_reg_loss: 92741.4052; train_edge_recon_loss: 2731622.2634; train_gene_expr_recon_loss: 37003099.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21795354.2748; train_global_loss: 61622818.0153; train_optim_loss: 61622818.0153; val_kl_reg_loss: 52116.6018; val_edge_recon_loss: 2740081.5833; val_gene_expr_recon_loss: 36546024.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21520428.9333; val_global_loss: 60858651.7333; val_optim_loss: 60858651.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 2 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9694
val AUPRC score: 0.9622
val best accuracy score: 0.9212
val best F1 score: 0.9236
val target rna MSE score: 1.2067
val source rna MSE score: 2090.1781
val target atac MSE score: 0.1246
val source atac MSE score: 0.9724
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
