[True]
Run timestamp: 10082023_235938_108.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_108']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7610; val_auprc_score: 0.7829; val_best_acc_score: 0.5207; val_best_f1_score: 0.6757; train_kl_reg_loss: 105470.9151; train_edge_recon_loss: 3866098.7424; train_gene_expr_recon_loss: 46935294.7176; train_masked_gp_l1_reg_loss: 85040.2187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245587.6889; train_chrom_access_recon_loss: 27921815.7405; train_global_loss: 79159307.8779; train_optim_loss: 79159307.8779; val_kl_reg_loss: 66447.0440; val_edge_recon_loss: 4064088.2000; val_gene_expr_recon_loss: 40009494.4000; val_masked_gp_l1_reg_loss: 85541.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242062.9375; val_chrom_access_recon_loss: 26265378.6667; val_global_loss: 70733012.2667; val_optim_loss: 70733012.2667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7780; val_auprc_score: 0.7975; val_best_acc_score: 0.5569; val_best_f1_score: 0.6882; train_kl_reg_loss: 132539.1944; train_edge_recon_loss: 3757659.8817; train_gene_expr_recon_loss: 39151217.2519; train_masked_gp_l1_reg_loss: 86729.2127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237512.0792; train_chrom_access_recon_loss: 25979374.7328; train_global_loss: 69345032.3053; train_optim_loss: 69345032.3053; val_kl_reg_loss: 190065.6927; val_edge_recon_loss: 4061773.1500; val_gene_expr_recon_loss: 37466666.9333; val_masked_gp_l1_reg_loss: 85392.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232040.5312; val_chrom_access_recon_loss: 25708484.6667; val_global_loss: 67744424.0000; val_optim_loss: 67744424.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7929; val_auprc_score: 0.8118; val_best_acc_score: 0.7005; val_best_f1_score: 0.7217; train_kl_reg_loss: 186923.0186; train_edge_recon_loss: 3571830.3492; train_gene_expr_recon_loss: 37239395.2366; train_masked_gp_l1_reg_loss: 82235.5385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225662.1681; train_chrom_access_recon_loss: 25627410.7481; train_global_loss: 66933457.0992; train_optim_loss: 66933457.0992; val_kl_reg_loss: 179549.7833; val_edge_recon_loss: 4041971.3167; val_gene_expr_recon_loss: 36828932.5333; val_masked_gp_l1_reg_loss: 80112.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219295.0156; val_chrom_access_recon_loss: 25462024.8000; val_global_loss: 66811886.1333; val_optim_loss: 66811886.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8574; val_auprc_score: 0.8530; val_best_acc_score: 0.7707; val_best_f1_score: 0.7899; train_kl_reg_loss: 168718.1498; train_edge_recon_loss: 3545606.6756; train_gene_expr_recon_loss: 36755643.7863; train_masked_gp_l1_reg_loss: 80496.3231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213220.1709; train_chrom_access_recon_loss: 25422535.2061; train_global_loss: 66186220.0916; train_optim_loss: 66186220.0916; val_kl_reg_loss: 172436.0990; val_edge_recon_loss: 3909172.3500; val_gene_expr_recon_loss: 36493101.3333; val_masked_gp_l1_reg_loss: 81255.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 207207.9375; val_chrom_access_recon_loss: 25334829.0667; val_global_loss: 66198002.4000; val_optim_loss: 66198002.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8843; val_auprc_score: 0.8756; val_best_acc_score: 0.7995; val_best_f1_score: 0.8166; train_kl_reg_loss: 146633.9470; train_edge_recon_loss: 3421579.5210; train_gene_expr_recon_loss: 36463913.8626; train_masked_gp_l1_reg_loss: 82419.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201524.9002; train_chrom_access_recon_loss: 25268113.9237; train_global_loss: 65584185.8321; train_optim_loss: 65584185.8321; val_kl_reg_loss: 140818.2135; val_edge_recon_loss: 3283536.0000; val_gene_expr_recon_loss: 36287141.8667; val_masked_gp_l1_reg_loss: 83483.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195936.4531; val_chrom_access_recon_loss: 25200466.9333; val_global_loss: 65191383.2000; val_optim_loss: 65191383.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8759; val_auprc_score: 0.8670; val_best_acc_score: 0.7842; val_best_f1_score: 0.8039; train_kl_reg_loss: 170647.7729; train_edge_recon_loss: 3096666.4905; train_gene_expr_recon_loss: 36254897.8015; train_masked_gp_l1_reg_loss: 84854.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190737.8830; train_chrom_access_recon_loss: 25162342.5496; train_global_loss: 64960146.6870; train_optim_loss: 64960146.6870; val_kl_reg_loss: 185364.5323; val_edge_recon_loss: 3060029.4667; val_gene_expr_recon_loss: 35980302.1333; val_masked_gp_l1_reg_loss: 85931.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185736.9062; val_chrom_access_recon_loss: 25018779.3333; val_global_loss: 64516143.7333; val_optim_loss: 64516143.7333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8825; val_auprc_score: 0.8670; val_best_acc_score: 0.7971; val_best_f1_score: 0.8130; train_kl_reg_loss: 181749.3187; train_edge_recon_loss: 3016559.6870; train_gene_expr_recon_loss: 36042289.1603; train_masked_gp_l1_reg_loss: 86932.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181147.4367; train_chrom_access_recon_loss: 25037796.2748; train_global_loss: 64546474.8397; train_optim_loss: 64546474.8397; val_kl_reg_loss: 178419.0729; val_edge_recon_loss: 3022580.2000; val_gene_expr_recon_loss: 35741068.0000; val_masked_gp_l1_reg_loss: 88078.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176622.9844; val_chrom_access_recon_loss: 24919946.8000; val_global_loss: 64126717.8667; val_optim_loss: 64126717.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8995; val_auprc_score: 0.8883; val_best_acc_score: 0.8137; val_best_f1_score: 0.8302; train_kl_reg_loss: 176565.7777; train_edge_recon_loss: 2982316.4447; train_gene_expr_recon_loss: 35841897.7710; train_masked_gp_l1_reg_loss: 89067.5478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172446.4082; train_chrom_access_recon_loss: 24950995.7405; train_global_loss: 64213289.8626; train_optim_loss: 64213289.8626; val_kl_reg_loss: 176200.9073; val_edge_recon_loss: 2966292.1833; val_gene_expr_recon_loss: 35501066.9333; val_masked_gp_l1_reg_loss: 90115.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168296.8281; val_chrom_access_recon_loss: 24816000.2667; val_global_loss: 63717971.2000; val_optim_loss: 63717971.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9034; val_auprc_score: 0.8892; val_best_acc_score: 0.8231; val_best_f1_score: 0.8385; train_kl_reg_loss: 169355.3007; train_edge_recon_loss: 2952179.2385; train_gene_expr_recon_loss: 35686290.8092; train_masked_gp_l1_reg_loss: 91053.4770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164332.3198; train_chrom_access_recon_loss: 24856285.0992; train_global_loss: 63919496.0916; train_optim_loss: 63919496.0916; val_kl_reg_loss: 165229.1500; val_edge_recon_loss: 2933907.6000; val_gene_expr_recon_loss: 35640422.1333; val_masked_gp_l1_reg_loss: 92123.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160436.0469; val_chrom_access_recon_loss: 24870982.8000; val_global_loss: 63863102.1333; val_optim_loss: 63863102.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9145; val_auprc_score: 0.8993; val_best_acc_score: 0.8372; val_best_f1_score: 0.8485; train_kl_reg_loss: 164809.7932; train_edge_recon_loss: 2923776.7118; train_gene_expr_recon_loss: 35556854.0000; train_masked_gp_l1_reg_loss: 93035.2892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156857.8249; train_chrom_access_recon_loss: 24776760.9466; train_global_loss: 63672094.9008; train_optim_loss: 63672094.9008; val_kl_reg_loss: 161542.4365; val_edge_recon_loss: 2928926.1833; val_gene_expr_recon_loss: 35376335.4667; val_masked_gp_l1_reg_loss: 94181.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153312.5312; val_chrom_access_recon_loss: 24722514.6667; val_global_loss: 63436810.9333; val_optim_loss: 63436810.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9160; val_auprc_score: 0.9028; val_best_acc_score: 0.8382; val_best_f1_score: 0.8520; train_kl_reg_loss: 162352.8624; train_edge_recon_loss: 2907751.4504; train_gene_expr_recon_loss: 35385409.4656; train_masked_gp_l1_reg_loss: 94979.7257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149989.5254; train_chrom_access_recon_loss: 24684880.4733; train_global_loss: 63385363.3893; train_optim_loss: 63385363.3893; val_kl_reg_loss: 158047.0135; val_edge_recon_loss: 2913017.5667; val_gene_expr_recon_loss: 35231159.0667; val_masked_gp_l1_reg_loss: 95990.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146678.0781; val_chrom_access_recon_loss: 24627648.8000; val_global_loss: 63172544.8000; val_optim_loss: 63172544.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9262; val_auprc_score: 0.9144; val_best_acc_score: 0.8517; val_best_f1_score: 0.8613; train_kl_reg_loss: 158720.1310; train_edge_recon_loss: 2889189.9561; train_gene_expr_recon_loss: 35258777.6641; train_masked_gp_l1_reg_loss: 96908.1246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143649.1682; train_chrom_access_recon_loss: 24608021.6183; train_global_loss: 63155266.8397; train_optim_loss: 63155266.8397; val_kl_reg_loss: 163231.3031; val_edge_recon_loss: 2872395.6167; val_gene_expr_recon_loss: 34996374.4000; val_masked_gp_l1_reg_loss: 97749.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140664.1875; val_chrom_access_recon_loss: 24533528.8000; val_global_loss: 62803942.1333; val_optim_loss: 62803942.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9329; val_auprc_score: 0.9244; val_best_acc_score: 0.8558; val_best_f1_score: 0.8637; train_kl_reg_loss: 155791.0630; train_edge_recon_loss: 2879466.3397; train_gene_expr_recon_loss: 35186697.1450; train_masked_gp_l1_reg_loss: 99549.0466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137817.2166; train_chrom_access_recon_loss: 24571852.0611; train_global_loss: 63031172.7939; train_optim_loss: 63031172.7939; val_kl_reg_loss: 159162.7646; val_edge_recon_loss: 2893099.8500; val_gene_expr_recon_loss: 34988438.4000; val_masked_gp_l1_reg_loss: 100513.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135058.2500; val_chrom_access_recon_loss: 24523209.2000; val_global_loss: 62799482.4000; val_optim_loss: 62799482.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9392; val_auprc_score: 0.9297; val_best_acc_score: 0.8677; val_best_f1_score: 0.8739; train_kl_reg_loss: 152910.8198; train_edge_recon_loss: 2850089.9828; train_gene_expr_recon_loss: 35056391.8626; train_masked_gp_l1_reg_loss: 101270.8024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132509.9214; train_chrom_access_recon_loss: 24502082.7176; train_global_loss: 62795256.0611; train_optim_loss: 62795256.0611; val_kl_reg_loss: 154251.2458; val_edge_recon_loss: 2854684.2500; val_gene_expr_recon_loss: 35064792.2667; val_masked_gp_l1_reg_loss: 102194.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129994.3984; val_chrom_access_recon_loss: 24525241.0667; val_global_loss: 62831160.8000; val_optim_loss: 62831160.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9457; val_auprc_score: 0.9346; val_best_acc_score: 0.8789; val_best_f1_score: 0.8830; train_kl_reg_loss: 151493.8136; train_edge_recon_loss: 2849157.4656; train_gene_expr_recon_loss: 34984877.3740; train_masked_gp_l1_reg_loss: 102890.5967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127571.7837; train_chrom_access_recon_loss: 24466430.2901; train_global_loss: 62682421.4656; train_optim_loss: 62682421.4656; val_kl_reg_loss: 148939.6510; val_edge_recon_loss: 2831587.8667; val_gene_expr_recon_loss: 34872240.2667; val_masked_gp_l1_reg_loss: 103861.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125263.1328; val_chrom_access_recon_loss: 24444980.5333; val_global_loss: 62526872.2667; val_optim_loss: 62526872.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9500; val_auprc_score: 0.9425; val_best_acc_score: 0.8840; val_best_f1_score: 0.8879; train_kl_reg_loss: 149905.2166; train_edge_recon_loss: 2831084.7214; train_gene_expr_recon_loss: 34897759.0992; train_masked_gp_l1_reg_loss: 104512.1412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122996.9837; train_chrom_access_recon_loss: 24447457.9389; train_global_loss: 62553716.1221; train_optim_loss: 62553716.1221; val_kl_reg_loss: 147430.7292; val_edge_recon_loss: 2824413.1167; val_gene_expr_recon_loss: 34849084.5333; val_masked_gp_l1_reg_loss: 105197.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120778.3906; val_chrom_access_recon_loss: 24462228.0000; val_global_loss: 62509132.8000; val_optim_loss: 62509132.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9527; val_auprc_score: 0.9439; val_best_acc_score: 0.8868; val_best_f1_score: 0.8899; train_kl_reg_loss: 146884.4040; train_edge_recon_loss: 2818211.6260; train_gene_expr_recon_loss: 34850065.5115; train_masked_gp_l1_reg_loss: 106150.8864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118663.0355; train_chrom_access_recon_loss: 24399169.5420; train_global_loss: 62439145.1298; train_optim_loss: 62439145.1298; val_kl_reg_loss: 147335.5521; val_edge_recon_loss: 2828038.8667; val_gene_expr_recon_loss: 34815238.1333; val_masked_gp_l1_reg_loss: 106939.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116415.1094; val_chrom_access_recon_loss: 24535395.3333; val_global_loss: 62549363.4667; val_optim_loss: 62549363.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9557; val_auprc_score: 0.9480; val_best_acc_score: 0.8942; val_best_f1_score: 0.8974; train_kl_reg_loss: 145333.7728; train_edge_recon_loss: 2804682.8473; train_gene_expr_recon_loss: 34771716.3053; train_masked_gp_l1_reg_loss: 107822.1657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114434.6606; train_chrom_access_recon_loss: 24368866.6718; train_global_loss: 62312856.4885; train_optim_loss: 62312856.4885; val_kl_reg_loss: 145711.6781; val_edge_recon_loss: 2804933.8167; val_gene_expr_recon_loss: 34704414.0000; val_masked_gp_l1_reg_loss: 108506.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112361.8281; val_chrom_access_recon_loss: 24374404.4000; val_global_loss: 62250331.7333; val_optim_loss: 62250331.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9599; val_auprc_score: 0.9541; val_best_acc_score: 0.9000; val_best_f1_score: 0.9020; train_kl_reg_loss: 141851.5172; train_edge_recon_loss: 2801262.9542; train_gene_expr_recon_loss: 34722148.9466; train_masked_gp_l1_reg_loss: 109393.2897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110388.9568; train_chrom_access_recon_loss: 24329858.0916; train_global_loss: 62214903.9389; train_optim_loss: 62214903.9389; val_kl_reg_loss: 140606.9000; val_edge_recon_loss: 2823947.0500; val_gene_expr_recon_loss: 34555429.8667; val_masked_gp_l1_reg_loss: 110135.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108453.6016; val_chrom_access_recon_loss: 24223194.6667; val_global_loss: 61961766.6667; val_optim_loss: 61961766.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9596; val_auprc_score: 0.9516; val_best_acc_score: 0.9019; val_best_f1_score: 0.9054; train_kl_reg_loss: 141281.2789; train_edge_recon_loss: 2789589.2385; train_gene_expr_recon_loss: 34621012.3817; train_masked_gp_l1_reg_loss: 110988.9744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106477.2056; train_chrom_access_recon_loss: 24287972.6412; train_global_loss: 62057321.5878; train_optim_loss: 62057321.5878; val_kl_reg_loss: 141646.2760; val_edge_recon_loss: 2782302.0833; val_gene_expr_recon_loss: 34392867.2000; val_masked_gp_l1_reg_loss: 111843.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104591.3906; val_chrom_access_recon_loss: 24154583.4667; val_global_loss: 61687834.6667; val_optim_loss: 61687834.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9596; val_auprc_score: 0.9526; val_best_acc_score: 0.9030; val_best_f1_score: 0.9077; train_kl_reg_loss: 138611.4478; train_edge_recon_loss: 2783340.9427; train_gene_expr_recon_loss: 34599853.4046; train_masked_gp_l1_reg_loss: 112645.3947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102842.5749; train_chrom_access_recon_loss: 24269044.5649; train_global_loss: 62006338.3206; train_optim_loss: 62006338.3206; val_kl_reg_loss: 135457.2188; val_edge_recon_loss: 2802746.4500; val_gene_expr_recon_loss: 34461715.6000; val_masked_gp_l1_reg_loss: 113362.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101126.5156; val_chrom_access_recon_loss: 24170257.8667; val_global_loss: 61784668.5333; val_optim_loss: 61784668.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9660; val_auprc_score: 0.9594; val_best_acc_score: 0.9073; val_best_f1_score: 0.9103; train_kl_reg_loss: 136238.3789; train_edge_recon_loss: 2780101.8435; train_gene_expr_recon_loss: 34584294.6565; train_masked_gp_l1_reg_loss: 114183.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99425.0667; train_chrom_access_recon_loss: 24293004.4427; train_global_loss: 62007247.9389; train_optim_loss: 62007247.9389; val_kl_reg_loss: 135642.0625; val_edge_recon_loss: 2799501.7000; val_gene_expr_recon_loss: 34506447.7333; val_masked_gp_l1_reg_loss: 114959.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97769.8281; val_chrom_access_recon_loss: 24273325.8667; val_global_loss: 61927646.1333; val_optim_loss: 61927646.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9707; val_auprc_score: 0.9653; val_best_acc_score: 0.9177; val_best_f1_score: 0.9199; train_kl_reg_loss: 134090.4597; train_edge_recon_loss: 2775679.0649; train_gene_expr_recon_loss: 34533568.1832; train_masked_gp_l1_reg_loss: 115705.4522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96215.0607; train_chrom_access_recon_loss: 24246505.6183; train_global_loss: 61901764.2443; train_optim_loss: 61901764.2443; val_kl_reg_loss: 129147.0932; val_edge_recon_loss: 2759715.1000; val_gene_expr_recon_loss: 34495534.0000; val_masked_gp_l1_reg_loss: 116487.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94753.0859; val_chrom_access_recon_loss: 24241764.5333; val_global_loss: 61837400.2667; val_optim_loss: 61837400.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9713; val_auprc_score: 0.9653; val_best_acc_score: 0.9188; val_best_f1_score: 0.9208; train_kl_reg_loss: 131502.1385; train_edge_recon_loss: 2771827.7080; train_gene_expr_recon_loss: 34461171.7710; train_masked_gp_l1_reg_loss: 117635.3387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93337.1985; train_chrom_access_recon_loss: 24217044.9008; train_global_loss: 61792518.6260; train_optim_loss: 61792518.6260; val_kl_reg_loss: 131170.3286; val_edge_recon_loss: 2779025.9333; val_gene_expr_recon_loss: 34477507.4667; val_masked_gp_l1_reg_loss: 118761.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91914.3438; val_chrom_access_recon_loss: 24231404.9333; val_global_loss: 61829784.8000; val_optim_loss: 61829784.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9648; val_auprc_score: 0.9572; val_best_acc_score: 0.9100; val_best_f1_score: 0.9124; train_kl_reg_loss: 132297.5143; train_edge_recon_loss: 2762829.3244; train_gene_expr_recon_loss: 34478896.5954; train_masked_gp_l1_reg_loss: 116936.7922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91380.5382; train_chrom_access_recon_loss: 24273927.0992; train_global_loss: 61856267.6641; train_optim_loss: 61856267.6641; val_kl_reg_loss: 133529.1078; val_edge_recon_loss: 2792206.3000; val_gene_expr_recon_loss: 34325376.6667; val_masked_gp_l1_reg_loss: 116079.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90987.0938; val_chrom_access_recon_loss: 24194447.0667; val_global_loss: 61652626.9333; val_optim_loss: 61652626.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9582; val_auprc_score: 0.9522; val_best_acc_score: 0.8938; val_best_f1_score: 0.8980; train_kl_reg_loss: 128648.2033; train_edge_recon_loss: 3273103.3034; train_gene_expr_recon_loss: 42135673.8321; train_masked_gp_l1_reg_loss: 115959.7570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93474.1298; train_chrom_access_recon_loss: 25673487.9084; train_global_loss: 71420347.4198; train_optim_loss: 71420347.4198; val_kl_reg_loss: 13873.4412; val_edge_recon_loss: 3238689.1333; val_gene_expr_recon_loss: 41255650.9333; val_masked_gp_l1_reg_loss: 115862.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95841.3438; val_chrom_access_recon_loss: 25429019.3333; val_global_loss: 70148937.0667; val_optim_loss: 70148937.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9588; val_auprc_score: 0.9517; val_best_acc_score: 0.8932; val_best_f1_score: 0.8953; train_kl_reg_loss: 143141.9516; train_edge_recon_loss: 3203576.1870; train_gene_expr_recon_loss: 41185732.5191; train_masked_gp_l1_reg_loss: 115751.8333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97098.8851; train_chrom_access_recon_loss: 25480054.7481; train_global_loss: 70225355.9084; train_optim_loss: 70225355.9084; val_kl_reg_loss: 15398.0657; val_edge_recon_loss: 3155268.7000; val_gene_expr_recon_loss: 40762234.6667; val_masked_gp_l1_reg_loss: 115620.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98045.5312; val_chrom_access_recon_loss: 25411994.1333; val_global_loss: 69558560.0000; val_optim_loss: 69558560.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9539; val_auprc_score: 0.9471; val_best_acc_score: 0.8861; val_best_f1_score: 0.8912; train_kl_reg_loss: 153614.2557; train_edge_recon_loss: 3146026.8626; train_gene_expr_recon_loss: 40889106.1679; train_masked_gp_l1_reg_loss: 115447.7156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98538.3764; train_chrom_access_recon_loss: 25451250.2901; train_global_loss: 69853984.2137; train_optim_loss: 69853984.2137; val_kl_reg_loss: 15219.5102; val_edge_recon_loss: 3135737.1500; val_gene_expr_recon_loss: 40628069.8667; val_masked_gp_l1_reg_loss: 115245.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98899.9844; val_chrom_access_recon_loss: 25331589.7333; val_global_loss: 69324760.5333; val_optim_loss: 69324760.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9545; val_auprc_score: 0.9492; val_best_acc_score: 0.8841; val_best_f1_score: 0.8894; train_kl_reg_loss: 156122.5943; train_edge_recon_loss: 3107776.2672; train_gene_expr_recon_loss: 40677185.9847; train_masked_gp_l1_reg_loss: 115009.2962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99068.8647; train_chrom_access_recon_loss: 25393687.2214; train_global_loss: 69548850.0458; train_optim_loss: 69548850.0458; val_kl_reg_loss: 16025.2806; val_edge_recon_loss: 3065046.8500; val_gene_expr_recon_loss: 40594925.3333; val_masked_gp_l1_reg_loss: 114751.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99159.6719; val_chrom_access_recon_loss: 25484714.0000; val_global_loss: 69374623.2000; val_optim_loss: 69374623.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9555; val_auprc_score: 0.9510; val_best_acc_score: 0.8861; val_best_f1_score: 0.8878; train_kl_reg_loss: 155099.5927; train_edge_recon_loss: 3087861.8206; train_gene_expr_recon_loss: 40577619.5725; train_masked_gp_l1_reg_loss: 114698.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99162.4741; train_chrom_access_recon_loss: 25367830.9160; train_global_loss: 69402272.4275; train_optim_loss: 69402272.4275; val_kl_reg_loss: 15708.8410; val_edge_recon_loss: 3085104.2167; val_gene_expr_recon_loss: 40185362.1333; val_masked_gp_l1_reg_loss: 114665.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99165.1953; val_chrom_access_recon_loss: 25304138.4000; val_global_loss: 68804142.1333; val_optim_loss: 68804142.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9524; val_auprc_score: 0.9448; val_best_acc_score: 0.8866; val_best_f1_score: 0.8882; train_kl_reg_loss: 154490.9821; train_edge_recon_loss: 3084492.0286; train_gene_expr_recon_loss: 40567026.9313; train_masked_gp_l1_reg_loss: 114630.5927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99165.3494; train_chrom_access_recon_loss: 25353686.8397; train_global_loss: 69373492.0611; train_optim_loss: 69373492.0611; val_kl_reg_loss: 15544.0433; val_edge_recon_loss: 3087646.1667; val_gene_expr_recon_loss: 40381455.7333; val_masked_gp_l1_reg_loss: 114595.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99164.1250; val_chrom_access_recon_loss: 25245992.5333; val_global_loss: 68944398.9333; val_optim_loss: 68944398.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9579; val_auprc_score: 0.9536; val_best_acc_score: 0.8897; val_best_f1_score: 0.8932; train_kl_reg_loss: 154381.1875; train_edge_recon_loss: 3073584.2767; train_gene_expr_recon_loss: 40552366.0458; train_masked_gp_l1_reg_loss: 114556.8235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99160.7248; train_chrom_access_recon_loss: 25359039.1145; train_global_loss: 69353088.3664; train_optim_loss: 69353088.3664; val_kl_reg_loss: 15548.3286; val_edge_recon_loss: 3074694.6000; val_gene_expr_recon_loss: 40238693.3333; val_masked_gp_l1_reg_loss: 114516.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99157.1094; val_chrom_access_recon_loss: 25222478.6667; val_global_loss: 68765087.7333; val_optim_loss: 68765087.7333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9534; val_auprc_score: 0.9461; val_best_acc_score: 0.8849; val_best_f1_score: 0.8886; train_kl_reg_loss: 154253.7284; train_edge_recon_loss: 3075839.4580; train_gene_expr_recon_loss: 40519040.2443; train_masked_gp_l1_reg_loss: 114474.7007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99152.0980; train_chrom_access_recon_loss: 25332437.4656; train_global_loss: 69295197.6183; train_optim_loss: 69295197.6183; val_kl_reg_loss: 15747.3171; val_edge_recon_loss: 3070809.4000; val_gene_expr_recon_loss: 40404098.6667; val_masked_gp_l1_reg_loss: 114430.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99144.9375; val_chrom_access_recon_loss: 25283200.2667; val_global_loss: 68987432.0000; val_optim_loss: 68987432.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9657
val AUPRC score: 0.9608
val best accuracy score: 0.9051
val best F1 score: 0.9076
val target rna MSE score: 16.2868
val source rna MSE score: 460.9017
val target atac MSE score: 0.3536
val source atac MSE score: 4.8071
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
