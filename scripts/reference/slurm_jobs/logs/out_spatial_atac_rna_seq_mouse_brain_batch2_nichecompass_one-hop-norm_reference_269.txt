[True]
Run timestamp: 10102023_125120_269.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_269']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7780; val_auprc_score: 0.7992; val_best_acc_score: 0.5259; val_best_f1_score: 0.6754; train_kl_reg_loss: 93206.8522; train_edge_recon_loss: 762207.6842; train_gene_expr_recon_loss: 22093396.9466; train_masked_gp_l1_reg_loss: 56764.1906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4069523.0525; train_chrom_access_recon_loss: 11175354.2214; train_global_loss: 38250452.8397; train_optim_loss: 38250452.8397; val_kl_reg_loss: 99036.5922; val_edge_recon_loss: 812632.2125; val_gene_expr_recon_loss: 20714354.0000; val_masked_gp_l1_reg_loss: 60858.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 991098.1875; val_chrom_access_recon_loss: 10705161.2667; val_global_loss: 33383140.4000; val_optim_loss: 33383140.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8760; val_auprc_score: 0.8804; val_best_acc_score: 0.7789; val_best_f1_score: 0.7586; train_kl_reg_loss: 85925.3657; train_edge_recon_loss: 739505.6875; train_gene_expr_recon_loss: 20854278.1221; train_masked_gp_l1_reg_loss: 62277.8310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 506538.4642; train_chrom_access_recon_loss: 10835140.1756; train_global_loss: 33083665.4809; train_optim_loss: 33083665.4809; val_kl_reg_loss: 86066.4568; val_edge_recon_loss: 794861.7708; val_gene_expr_recon_loss: 20434306.5333; val_masked_gp_l1_reg_loss: 64342.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 286675.3438; val_chrom_access_recon_loss: 10531471.1333; val_global_loss: 32197724.1333; val_optim_loss: 32197724.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9055; val_auprc_score: 0.8987; val_best_acc_score: 0.8153; val_best_f1_score: 0.8266; train_kl_reg_loss: 73681.2215; train_edge_recon_loss: 705769.5072; train_gene_expr_recon_loss: 20567829.6947; train_masked_gp_l1_reg_loss: 66442.6781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231035.0850; train_chrom_access_recon_loss: 10671278.9237; train_global_loss: 32316037.0229; train_optim_loss: 32316037.0229; val_kl_reg_loss: 79192.9557; val_edge_recon_loss: 669720.1917; val_gene_expr_recon_loss: 20213397.7333; val_masked_gp_l1_reg_loss: 68584.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197842.5625; val_chrom_access_recon_loss: 10469846.0667; val_global_loss: 31698582.8000; val_optim_loss: 31698582.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9166; val_auprc_score: 0.9072; val_best_acc_score: 0.8385; val_best_f1_score: 0.8485; train_kl_reg_loss: 81867.9311; train_edge_recon_loss: 640858.5205; train_gene_expr_recon_loss: 20347256.3969; train_masked_gp_l1_reg_loss: 70922.6183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180985.0864; train_chrom_access_recon_loss: 10570852.5344; train_global_loss: 31892743.0992; train_optim_loss: 31892743.0992; val_kl_reg_loss: 82816.9974; val_edge_recon_loss: 633614.4375; val_gene_expr_recon_loss: 19962680.0000; val_masked_gp_l1_reg_loss: 72852.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166918.6875; val_chrom_access_recon_loss: 10284684.0000; val_global_loss: 31203565.3333; val_optim_loss: 31203565.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9290; val_auprc_score: 0.9152; val_best_acc_score: 0.8538; val_best_f1_score: 0.8616; train_kl_reg_loss: 79628.2437; train_edge_recon_loss: 621342.9404; train_gene_expr_recon_loss: 20161848.6260; train_masked_gp_l1_reg_loss: 74542.0967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157606.3513; train_chrom_access_recon_loss: 10488690.1527; train_global_loss: 31583658.4122; train_optim_loss: 31583658.4122; val_kl_reg_loss: 82114.4615; val_edge_recon_loss: 618182.5167; val_gene_expr_recon_loss: 19736979.2000; val_masked_gp_l1_reg_loss: 76044.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148801.5938; val_chrom_access_recon_loss: 10256228.6000; val_global_loss: 30918350.6667; val_optim_loss: 30918350.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9348; val_auprc_score: 0.9242; val_best_acc_score: 0.8641; val_best_f1_score: 0.8712; train_kl_reg_loss: 77011.7160; train_edge_recon_loss: 612664.4060; train_gene_expr_recon_loss: 19998244.5496; train_masked_gp_l1_reg_loss: 77240.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141521.9937; train_chrom_access_recon_loss: 10405185.8168; train_global_loss: 31311869.2672; train_optim_loss: 31311869.2672; val_kl_reg_loss: 75059.3651; val_edge_recon_loss: 611145.8958; val_gene_expr_recon_loss: 19679076.9333; val_masked_gp_l1_reg_loss: 78372.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135579.4062; val_chrom_access_recon_loss: 10162776.9333; val_global_loss: 30742011.3333; val_optim_loss: 30742011.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9411; val_auprc_score: 0.9297; val_best_acc_score: 0.8711; val_best_f1_score: 0.8785; train_kl_reg_loss: 74491.3689; train_edge_recon_loss: 607075.0425; train_gene_expr_recon_loss: 19872493.1298; train_masked_gp_l1_reg_loss: 79258.6977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130223.6090; train_chrom_access_recon_loss: 10335379.5573; train_global_loss: 31098921.4198; train_optim_loss: 31098921.4198; val_kl_reg_loss: 70552.2016; val_edge_recon_loss: 604796.5708; val_gene_expr_recon_loss: 19584284.8000; val_masked_gp_l1_reg_loss: 80106.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126130.2578; val_chrom_access_recon_loss: 10154140.2000; val_global_loss: 30620009.4667; val_optim_loss: 30620009.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9396; val_auprc_score: 0.9288; val_best_acc_score: 0.8694; val_best_f1_score: 0.8751; train_kl_reg_loss: 72040.1541; train_edge_recon_loss: 603237.5587; train_gene_expr_recon_loss: 19753365.7710; train_masked_gp_l1_reg_loss: 80902.1091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122406.9718; train_chrom_access_recon_loss: 10267587.3206; train_global_loss: 30899539.7557; train_optim_loss: 30899539.7557; val_kl_reg_loss: 72828.1214; val_edge_recon_loss: 605430.2042; val_gene_expr_recon_loss: 19479409.7333; val_masked_gp_l1_reg_loss: 81901.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119582.2656; val_chrom_access_recon_loss: 10026252.2000; val_global_loss: 30385404.2667; val_optim_loss: 30385404.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9464; val_auprc_score: 0.9356; val_best_acc_score: 0.8794; val_best_f1_score: 0.8834; train_kl_reg_loss: 70442.2966; train_edge_recon_loss: 598424.9685; train_gene_expr_recon_loss: 19638451.9542; train_masked_gp_l1_reg_loss: 82340.7747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116470.5921; train_chrom_access_recon_loss: 10200131.4275; train_global_loss: 30706262.0153; train_optim_loss: 30706262.0153; val_kl_reg_loss: 69148.3057; val_edge_recon_loss: 598198.1542; val_gene_expr_recon_loss: 19291517.0667; val_masked_gp_l1_reg_loss: 83022.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114401.3672; val_chrom_access_recon_loss: 10025709.4000; val_global_loss: 30181997.0667; val_optim_loss: 30181997.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9507; val_auprc_score: 0.9422; val_best_acc_score: 0.8861; val_best_f1_score: 0.8906; train_kl_reg_loss: 68569.5158; train_edge_recon_loss: 596130.9480; train_gene_expr_recon_loss: 19549604.9313; train_masked_gp_l1_reg_loss: 83514.6005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111876.7690; train_chrom_access_recon_loss: 10133375.4580; train_global_loss: 30543072.1679; train_optim_loss: 30543072.1679; val_kl_reg_loss: 65492.8133; val_edge_recon_loss: 597986.9625; val_gene_expr_recon_loss: 19257413.2000; val_masked_gp_l1_reg_loss: 84156.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111409.1641; val_chrom_access_recon_loss: 9917294.5333; val_global_loss: 30033753.0667; val_optim_loss: 30033753.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9560; val_auprc_score: 0.9485; val_best_acc_score: 0.8930; val_best_f1_score: 0.8977; train_kl_reg_loss: 67129.1435; train_edge_recon_loss: 593925.4862; train_gene_expr_recon_loss: 19466972.5344; train_masked_gp_l1_reg_loss: 84667.9546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109320.2492; train_chrom_access_recon_loss: 10085271.6260; train_global_loss: 30407287.0229; train_optim_loss: 30407287.0229; val_kl_reg_loss: 65684.5945; val_edge_recon_loss: 595160.1417; val_gene_expr_recon_loss: 19239448.6667; val_masked_gp_l1_reg_loss: 85147.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108070.2344; val_chrom_access_recon_loss: 9938889.5333; val_global_loss: 30032400.8000; val_optim_loss: 30032400.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9600; val_auprc_score: 0.9527; val_best_acc_score: 0.9002; val_best_f1_score: 0.9026; train_kl_reg_loss: 66086.6514; train_edge_recon_loss: 593317.2414; train_gene_expr_recon_loss: 19381472.7176; train_masked_gp_l1_reg_loss: 85629.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106824.3461; train_chrom_access_recon_loss: 10025741.6412; train_global_loss: 30259072.2901; train_optim_loss: 30259072.2901; val_kl_reg_loss: 64204.1755; val_edge_recon_loss: 591122.6125; val_gene_expr_recon_loss: 19198979.3333; val_masked_gp_l1_reg_loss: 86279.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106907.1562; val_chrom_access_recon_loss: 9856769.2667; val_global_loss: 29904263.3333; val_optim_loss: 29904263.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9623; val_auprc_score: 0.9556; val_best_acc_score: 0.9039; val_best_f1_score: 0.9071; train_kl_reg_loss: 65254.3543; train_edge_recon_loss: 589360.1951; train_gene_expr_recon_loss: 19315103.0840; train_masked_gp_l1_reg_loss: 86599.8891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105851.5745; train_chrom_access_recon_loss: 9969380.4275; train_global_loss: 30131549.7252; train_optim_loss: 30131549.7252; val_kl_reg_loss: 63714.0495; val_edge_recon_loss: 593694.7292; val_gene_expr_recon_loss: 19036503.7333; val_masked_gp_l1_reg_loss: 87056.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105179.2031; val_chrom_access_recon_loss: 9790645.0000; val_global_loss: 29676793.6000; val_optim_loss: 29676793.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9622; val_auprc_score: 0.9525; val_best_acc_score: 0.9051; val_best_f1_score: 0.9067; train_kl_reg_loss: 64656.3527; train_edge_recon_loss: 587119.2820; train_gene_expr_recon_loss: 19244461.0229; train_masked_gp_l1_reg_loss: 87653.8411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105431.5329; train_chrom_access_recon_loss: 9918976.8931; train_global_loss: 30008298.9466; train_optim_loss: 30008298.9466; val_kl_reg_loss: 64489.3284; val_edge_recon_loss: 592740.4708; val_gene_expr_recon_loss: 19055518.9333; val_masked_gp_l1_reg_loss: 88048.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105405.3359; val_chrom_access_recon_loss: 9811083.0000; val_global_loss: 29717286.0000; val_optim_loss: 29717286.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9644; val_auprc_score: 0.9572; val_best_acc_score: 0.9070; val_best_f1_score: 0.9092; train_kl_reg_loss: 64011.2583; train_edge_recon_loss: 585521.8387; train_gene_expr_recon_loss: 19157946.7786; train_masked_gp_l1_reg_loss: 88664.0751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106091.9476; train_chrom_access_recon_loss: 9854889.5573; train_global_loss: 29857125.4046; train_optim_loss: 29857125.4046; val_kl_reg_loss: 64613.5664; val_edge_recon_loss: 592465.1000; val_gene_expr_recon_loss: 18880115.4667; val_masked_gp_l1_reg_loss: 89185.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105984.7109; val_chrom_access_recon_loss: 9648930.7333; val_global_loss: 29381294.8000; val_optim_loss: 29381294.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9664; val_auprc_score: 0.9578; val_best_acc_score: 0.9128; val_best_f1_score: 0.9152; train_kl_reg_loss: 62970.3910; train_edge_recon_loss: 584932.2366; train_gene_expr_recon_loss: 19120333.0229; train_masked_gp_l1_reg_loss: 89646.9541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106791.6520; train_chrom_access_recon_loss: 9805324.5038; train_global_loss: 29769998.7634; train_optim_loss: 29769998.7634; val_kl_reg_loss: 61828.7641; val_edge_recon_loss: 588171.2417; val_gene_expr_recon_loss: 18876181.8667; val_masked_gp_l1_reg_loss: 90115.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107813.8125; val_chrom_access_recon_loss: 9676500.5333; val_global_loss: 29400612.5333; val_optim_loss: 29400612.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9678; val_auprc_score: 0.9586; val_best_acc_score: 0.9161; val_best_f1_score: 0.9186; train_kl_reg_loss: 62997.9421; train_edge_recon_loss: 582581.7114; train_gene_expr_recon_loss: 19042749.0992; train_masked_gp_l1_reg_loss: 90632.7514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108330.9640; train_chrom_access_recon_loss: 9753617.0992; train_global_loss: 29640909.4962; train_optim_loss: 29640909.4962; val_kl_reg_loss: 63142.6456; val_edge_recon_loss: 580827.0125; val_gene_expr_recon_loss: 18888763.6000; val_masked_gp_l1_reg_loss: 91011.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108273.4531; val_chrom_access_recon_loss: 9665055.9333; val_global_loss: 29397075.6000; val_optim_loss: 29397075.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9659; val_auprc_score: 0.9588; val_best_acc_score: 0.9144; val_best_f1_score: 0.9165; train_kl_reg_loss: 61666.8679; train_edge_recon_loss: 585259.5902; train_gene_expr_recon_loss: 19011024.0000; train_masked_gp_l1_reg_loss: 91543.6791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108897.5658; train_chrom_access_recon_loss: 9734914.4885; train_global_loss: 29593306.2901; train_optim_loss: 29593306.2901; val_kl_reg_loss: 64651.8203; val_edge_recon_loss: 585886.8000; val_gene_expr_recon_loss: 18784383.0667; val_masked_gp_l1_reg_loss: 91287.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108328.8438; val_chrom_access_recon_loss: 9627164.8000; val_global_loss: 29261702.2667; val_optim_loss: 29261702.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9412; val_auprc_score: 0.9307; val_best_acc_score: 0.8690; val_best_f1_score: 0.8747; train_kl_reg_loss: 84605.8924; train_edge_recon_loss: 623397.0720; train_gene_expr_recon_loss: 19308141.0687; train_masked_gp_l1_reg_loss: 88941.6994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122612.8876; train_chrom_access_recon_loss: 10149903.7710; train_global_loss: 30377602.4122; train_optim_loss: 30377602.4122; val_kl_reg_loss: 66014.2487; val_edge_recon_loss: 602066.2292; val_gene_expr_recon_loss: 18811949.0667; val_masked_gp_l1_reg_loss: 85554.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112224.4062; val_chrom_access_recon_loss: 9680444.8667; val_global_loss: 29358252.5333; val_optim_loss: 29358252.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9315; val_auprc_score: 0.9239; val_best_acc_score: 0.8548; val_best_f1_score: 0.8625; train_kl_reg_loss: 79168715560801.6562; train_edge_recon_loss: 635429.7977; train_gene_expr_recon_loss: 19498284.9618; train_masked_gp_l1_reg_loss: 84558.1225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130373.9699; train_chrom_access_recon_loss: 10187881.9237; train_global_loss: 79168745861753.1250; train_optim_loss: 79168745861753.1250; val_kl_reg_loss: 86332.7417; val_edge_recon_loss: 627280.1792; val_gene_expr_recon_loss: 18863330.2667; val_masked_gp_l1_reg_loss: 83568.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126076.8281; val_chrom_access_recon_loss: 9707975.1333; val_global_loss: 29494562.2667; val_optim_loss: 29494562.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9398; val_auprc_score: 0.9324; val_best_acc_score: 0.8662; val_best_f1_score: 0.8731; train_kl_reg_loss: 172001619.8343; train_edge_recon_loss: 618366.7347; train_gene_expr_recon_loss: 19260354.5344; train_masked_gp_l1_reg_loss: 83004.5338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126843.6790; train_chrom_access_recon_loss: 9955850.5878; train_global_loss: 202046038.2137; train_optim_loss: 202046038.2137; val_kl_reg_loss: 12698557266155146.0000; val_edge_recon_loss: 616851.4333; val_gene_expr_recon_loss: 18905253.3333; val_masked_gp_l1_reg_loss: 82229.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122450.4922; val_chrom_access_recon_loss: 9723441.2000; val_global_loss: 12698557293621322.0000; val_optim_loss: 12698557293621322.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8992; val_auprc_score: 0.8986; val_best_acc_score: 0.8102; val_best_f1_score: 0.8219; train_kl_reg_loss: 2750669337072.3750; train_edge_recon_loss: 648746.4423; train_gene_expr_recon_loss: 19294974.7176; train_masked_gp_l1_reg_loss: 83594.0690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123668.0764; train_chrom_access_recon_loss: 10007965.3206; train_global_loss: 2750699510757.5420; train_optim_loss: 2750699510757.5420; val_kl_reg_loss: 248733.0490; val_edge_recon_loss: 779460.1500; val_gene_expr_recon_loss: 19023418.2667; val_masked_gp_l1_reg_loss: 88826.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125906.5625; val_chrom_access_recon_loss: 9707710.6667; val_global_loss: 29974054.0000; val_optim_loss: 29974054.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8997; val_auprc_score: 0.8981; val_best_acc_score: 0.8126; val_best_f1_score: 0.8223; train_kl_reg_loss: 72764299.9908; train_edge_recon_loss: 770980.1011; train_gene_expr_recon_loss: 19121495.5420; train_masked_gp_l1_reg_loss: 86373.0222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91379.2245; train_chrom_access_recon_loss: 9852719.8550; train_global_loss: 102687243.8321; train_optim_loss: 102687243.8321; val_kl_reg_loss: 182750.2448; val_edge_recon_loss: 764760.6333; val_gene_expr_recon_loss: 18867611.2000; val_masked_gp_l1_reg_loss: 85093.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85807.0859; val_chrom_access_recon_loss: 9684144.7333; val_global_loss: 29670167.6000; val_optim_loss: 29670167.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9130; val_auprc_score: 0.9071; val_best_acc_score: 0.8333; val_best_f1_score: 0.8436; train_kl_reg_loss: 157536.9603; train_edge_recon_loss: 747502.0611; train_gene_expr_recon_loss: 19055404.0153; train_masked_gp_l1_reg_loss: 84506.5245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85107.2932; train_chrom_access_recon_loss: 9800673.2214; train_global_loss: 29930729.8931; train_optim_loss: 29930729.8931; val_kl_reg_loss: 128664.3875; val_edge_recon_loss: 737804.3833; val_gene_expr_recon_loss: 18749202.8000; val_masked_gp_l1_reg_loss: 84067.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84435.5781; val_chrom_access_recon_loss: 9613386.3333; val_global_loss: 29397561.8667; val_optim_loss: 29397561.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9226; val_auprc_score: 0.9125; val_best_acc_score: 0.8471; val_best_f1_score: 0.8540; train_kl_reg_loss: 128108.8520; train_edge_recon_loss: 706657.9098; train_gene_expr_recon_loss: 19051539.6641; train_masked_gp_l1_reg_loss: 83838.5637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83951.9205; train_chrom_access_recon_loss: 9808029.9542; train_global_loss: 29862126.9313; train_optim_loss: 29862126.9313; val_kl_reg_loss: 87208.7536; val_edge_recon_loss: 697298.6000; val_gene_expr_recon_loss: 18838000.6667; val_masked_gp_l1_reg_loss: 83757.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83702.2266; val_chrom_access_recon_loss: 9618840.8667; val_global_loss: 29408809.0667; val_optim_loss: 29408809.0667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9111; val_auprc_score: 0.9137; val_best_acc_score: 0.8337; val_best_f1_score: 0.8323; train_kl_reg_loss: 1927989.2979; train_edge_recon_loss: 754382.0453; train_gene_expr_recon_loss: 18184729.6565; train_masked_gp_l1_reg_loss: 83559.2399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80613.9084; train_chrom_access_recon_loss: 9450477.0687; train_global_loss: 30481751.1603; train_optim_loss: 30481751.1603; val_kl_reg_loss: 47777.0651; val_edge_recon_loss: 764305.9042; val_gene_expr_recon_loss: 17752736.4000; val_masked_gp_l1_reg_loss: 83378.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79087.8594; val_chrom_access_recon_loss: 9120397.9333; val_global_loss: 27847683.4667; val_optim_loss: 27847683.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9093; val_auprc_score: 0.9072; val_best_acc_score: 0.8320; val_best_f1_score: 0.8343; train_kl_reg_loss: 329880.7331; train_edge_recon_loss: 753106.2276; train_gene_expr_recon_loss: 18045846.8779; train_masked_gp_l1_reg_loss: 83095.0601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78709.4228; train_chrom_access_recon_loss: 9291493.2824; train_global_loss: 28582131.5420; train_optim_loss: 28582131.5420; val_kl_reg_loss: 46904.8977; val_edge_recon_loss: 761999.7000; val_gene_expr_recon_loss: 17764942.2667; val_masked_gp_l1_reg_loss: 82741.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78425.5547; val_chrom_access_recon_loss: 9160829.2667; val_global_loss: 27895844.4000; val_optim_loss: 27895844.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9190; val_auprc_score: 0.9206; val_best_acc_score: 0.8385; val_best_f1_score: 0.8458; train_kl_reg_loss: 79474.2118; train_edge_recon_loss: 743581.4537; train_gene_expr_recon_loss: 17975151.1985; train_masked_gp_l1_reg_loss: 82386.7767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78162.1428; train_chrom_access_recon_loss: 9276916.5115; train_global_loss: 28235672.1374; train_optim_loss: 28235672.1374; val_kl_reg_loss: 42723.4930; val_edge_recon_loss: 755147.4708; val_gene_expr_recon_loss: 17750331.8667; val_masked_gp_l1_reg_loss: 82049.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77964.1250; val_chrom_access_recon_loss: 9115784.2333; val_global_loss: 27824001.3333; val_optim_loss: 27824001.3333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9229; val_auprc_score: 0.9186; val_best_acc_score: 0.8438; val_best_f1_score: 0.8509; train_kl_reg_loss: 72986.1681; train_edge_recon_loss: 743019.0067; train_gene_expr_recon_loss: 17948016.6412; train_masked_gp_l1_reg_loss: 81817.4067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77900.2384; train_chrom_access_recon_loss: 9279534.1069; train_global_loss: 28203273.5725; train_optim_loss: 28203273.5725; val_kl_reg_loss: 662622.7612; val_edge_recon_loss: 752020.9708; val_gene_expr_recon_loss: 17683017.6000; val_masked_gp_l1_reg_loss: 81548.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77751.5859; val_chrom_access_recon_loss: 9135092.4667; val_global_loss: 28392053.4667; val_optim_loss: 28392053.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9213; val_auprc_score: 0.9181; val_best_acc_score: 0.8440; val_best_f1_score: 0.8502; train_kl_reg_loss: 1593405.3376; train_edge_recon_loss: 739900.7619; train_gene_expr_recon_loss: 17980321.3893; train_masked_gp_l1_reg_loss: 81320.0477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77503.3736; train_chrom_access_recon_loss: 9306072.1603; train_global_loss: 29778523.2672; train_optim_loss: 29778523.2672; val_kl_reg_loss: 42369.1727; val_edge_recon_loss: 749807.3375; val_gene_expr_recon_loss: 17674250.5333; val_masked_gp_l1_reg_loss: 81030.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77383.7266; val_chrom_access_recon_loss: 9055130.2667; val_global_loss: 27679971.4667; val_optim_loss: 27679971.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9238; val_auprc_score: 0.9183; val_best_acc_score: 0.8468; val_best_f1_score: 0.8504; train_kl_reg_loss: 213729717065.8741; train_edge_recon_loss: 734162.1016; train_gene_expr_recon_loss: 17894666.6260; train_masked_gp_l1_reg_loss: 80786.7799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77191.1583; train_chrom_access_recon_loss: 9255347.3130; train_global_loss: 213757752934.6412; train_optim_loss: 213757752934.6412; val_kl_reg_loss: 42007.5969; val_edge_recon_loss: 745264.5042; val_gene_expr_recon_loss: 17665586.2667; val_masked_gp_l1_reg_loss: 80521.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76991.0469; val_chrom_access_recon_loss: 9072700.4667; val_global_loss: 27683072.9333; val_optim_loss: 27683072.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9227; val_auprc_score: 0.9205; val_best_acc_score: 0.8471; val_best_f1_score: 0.8504; train_kl_reg_loss: 70738.4506; train_edge_recon_loss: 727697.6875; train_gene_expr_recon_loss: 17888158.5344; train_masked_gp_l1_reg_loss: 80296.3991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76720.4191; train_chrom_access_recon_loss: 9279862.0954; train_global_loss: 28123473.6336; train_optim_loss: 28123473.6336; val_kl_reg_loss: 43328.5281; val_edge_recon_loss: 742200.3208; val_gene_expr_recon_loss: 17657823.8667; val_masked_gp_l1_reg_loss: 80028.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76510.0234; val_chrom_access_recon_loss: 9083937.4667; val_global_loss: 27683828.2667; val_optim_loss: 27683828.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9282; val_auprc_score: 0.9238; val_best_acc_score: 0.8511; val_best_f1_score: 0.8589; train_kl_reg_loss: 69919.2975; train_edge_recon_loss: 723990.9709; train_gene_expr_recon_loss: 17872935.2595; train_masked_gp_l1_reg_loss: 79781.9628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76394.3269; train_chrom_access_recon_loss: 9253628.9542; train_global_loss: 28076650.7176; train_optim_loss: 28076650.7176; val_kl_reg_loss: 42016.2742; val_edge_recon_loss: 736071.7708; val_gene_expr_recon_loss: 17614860.3333; val_masked_gp_l1_reg_loss: 79561.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76160.5000; val_chrom_access_recon_loss: 9070046.6000; val_global_loss: 27618716.6667; val_optim_loss: 27618716.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9316; val_auprc_score: 0.9268; val_best_acc_score: 0.8569; val_best_f1_score: 0.8644; train_kl_reg_loss: 68656.8176; train_edge_recon_loss: 717567.6093; train_gene_expr_recon_loss: 17848667.9466; train_masked_gp_l1_reg_loss: 79343.5980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75961.1453; train_chrom_access_recon_loss: 9244278.3702; train_global_loss: 28034475.4504; train_optim_loss: 28034475.4504; val_kl_reg_loss: 43287.3706; val_edge_recon_loss: 730456.7750; val_gene_expr_recon_loss: 17554493.4000; val_masked_gp_l1_reg_loss: 79117.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75813.6719; val_chrom_access_recon_loss: 9025909.0667; val_global_loss: 27509078.8000; val_optim_loss: 27509078.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9294; val_auprc_score: 0.9219; val_best_acc_score: 0.8546; val_best_f1_score: 0.8607; train_kl_reg_loss: 67217.3848; train_edge_recon_loss: 714280.5749; train_gene_expr_recon_loss: 17851539.9389; train_masked_gp_l1_reg_loss: 78949.1638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75710.3457; train_chrom_access_recon_loss: 9232561.3435; train_global_loss: 28020258.7176; train_optim_loss: 28020258.7176; val_kl_reg_loss: 38494.8141; val_edge_recon_loss: 727920.4542; val_gene_expr_recon_loss: 17570434.6667; val_masked_gp_l1_reg_loss: 78796.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75546.0312; val_chrom_access_recon_loss: 9062577.1333; val_global_loss: 27553769.2000; val_optim_loss: 27553769.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9337; val_auprc_score: 0.9291; val_best_acc_score: 0.8601; val_best_f1_score: 0.8671; train_kl_reg_loss: 64719.6941; train_edge_recon_loss: 711130.6646; train_gene_expr_recon_loss: 17839916.5191; train_masked_gp_l1_reg_loss: 78616.3267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75323.5763; train_chrom_access_recon_loss: 9238769.4275; train_global_loss: 28008476.0000; train_optim_loss: 28008476.0000; val_kl_reg_loss: 41160.3740; val_edge_recon_loss: 719398.2417; val_gene_expr_recon_loss: 17615245.7333; val_masked_gp_l1_reg_loss: 78435.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75028.7500; val_chrom_access_recon_loss: 9056995.9333; val_global_loss: 27586264.2667; val_optim_loss: 27586264.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9332; val_auprc_score: 0.9292; val_best_acc_score: 0.8603; val_best_f1_score: 0.8657; train_kl_reg_loss: 64439.8107; train_edge_recon_loss: 704331.6789; train_gene_expr_recon_loss: 17837384.3359; train_masked_gp_l1_reg_loss: 78303.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74886.4739; train_chrom_access_recon_loss: 9238646.6985; train_global_loss: 27997992.3359; train_optim_loss: 27997992.3359; val_kl_reg_loss: 41312.0188; val_edge_recon_loss: 715057.4292; val_gene_expr_recon_loss: 17580445.2667; val_masked_gp_l1_reg_loss: 78169.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74704.5781; val_chrom_access_recon_loss: 9068244.7333; val_global_loss: 27557933.7333; val_optim_loss: 27557933.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9231; val_auprc_score: 0.9166; val_best_acc_score: 0.8452; val_best_f1_score: 0.8522; train_kl_reg_loss: 65347.1393; train_edge_recon_loss: 702574.0515; train_gene_expr_recon_loss: 17840467.0153; train_masked_gp_l1_reg_loss: 78056.3385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74640.0925; train_chrom_access_recon_loss: 9225789.2672; train_global_loss: 27986873.8931; train_optim_loss: 27986873.8931; val_kl_reg_loss: 40156.1151; val_edge_recon_loss: 713696.0500; val_gene_expr_recon_loss: 17586630.8000; val_masked_gp_l1_reg_loss: 77893.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74387.1797; val_chrom_access_recon_loss: 9069016.0667; val_global_loss: 27561780.8000; val_optim_loss: 27561780.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9275; val_auprc_score: 0.9221; val_best_acc_score: 0.8511; val_best_f1_score: 0.8579; train_kl_reg_loss: 63171.5368; train_edge_recon_loss: 700329.7548; train_gene_expr_recon_loss: 17800773.9695; train_masked_gp_l1_reg_loss: 77802.9018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72629.5593; train_chrom_access_recon_loss: 9227088.7023; train_global_loss: 27941796.3206; train_optim_loss: 27941796.3206; val_kl_reg_loss: 40382.5310; val_edge_recon_loss: 712665.0833; val_gene_expr_recon_loss: 17570039.2667; val_masked_gp_l1_reg_loss: 77747.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72388.5938; val_chrom_access_recon_loss: 9031778.0667; val_global_loss: 27505001.0667; val_optim_loss: 27505001.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9279; val_auprc_score: 0.9166; val_best_acc_score: 0.8553; val_best_f1_score: 0.8630; train_kl_reg_loss: 62756.4090; train_edge_recon_loss: 699558.0086; train_gene_expr_recon_loss: 17778129.5420; train_masked_gp_l1_reg_loss: 77722.0077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72313.8358; train_chrom_access_recon_loss: 9215365.0687; train_global_loss: 27905844.9466; train_optim_loss: 27905844.9466; val_kl_reg_loss: 40313.4250; val_edge_recon_loss: 712978.7750; val_gene_expr_recon_loss: 17666223.4667; val_masked_gp_l1_reg_loss: 77695.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72261.5234; val_chrom_access_recon_loss: 9100435.6000; val_global_loss: 27669909.0667; val_optim_loss: 27669909.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9297; val_auprc_score: 0.9232; val_best_acc_score: 0.8575; val_best_f1_score: 0.8632; train_kl_reg_loss: 62855.4657; train_edge_recon_loss: 699523.7514; train_gene_expr_recon_loss: 17794564.2519; train_masked_gp_l1_reg_loss: 77675.7697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72214.6488; train_chrom_access_recon_loss: 9231288.9695; train_global_loss: 27938122.8855; train_optim_loss: 27938122.8855; val_kl_reg_loss: 39806.6534; val_edge_recon_loss: 710351.6708; val_gene_expr_recon_loss: 17608879.2667; val_masked_gp_l1_reg_loss: 77653.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72169.1406; val_chrom_access_recon_loss: 9084746.4000; val_global_loss: 27593608.1333; val_optim_loss: 27593608.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9265; val_auprc_score: 0.9194; val_best_acc_score: 0.8486; val_best_f1_score: 0.8556; train_kl_reg_loss: 62599.2290; train_edge_recon_loss: 699278.7958; train_gene_expr_recon_loss: 17791783.7328; train_masked_gp_l1_reg_loss: 77632.3293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72137.6183; train_chrom_access_recon_loss: 9224997.3740; train_global_loss: 27928429.1145; train_optim_loss: 27928429.1145; val_kl_reg_loss: 39379.2596; val_edge_recon_loss: 711321.2917; val_gene_expr_recon_loss: 17519347.2000; val_masked_gp_l1_reg_loss: 77609.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72095.2266; val_chrom_access_recon_loss: 9026207.5667; val_global_loss: 27445961.2000; val_optim_loss: 27445961.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9265; val_auprc_score: 0.9194; val_best_acc_score: 0.8521; val_best_f1_score: 0.8583; train_kl_reg_loss: 62716.4358; train_edge_recon_loss: 698214.8798; train_gene_expr_recon_loss: 17794499.5573; train_masked_gp_l1_reg_loss: 77589.6618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72058.1215; train_chrom_access_recon_loss: 9224953.1908; train_global_loss: 27930031.7405; train_optim_loss: 27930031.7405; val_kl_reg_loss: 40027.8010; val_edge_recon_loss: 711163.4458; val_gene_expr_recon_loss: 17607593.2667; val_masked_gp_l1_reg_loss: 77568.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72032.1719; val_chrom_access_recon_loss: 9081865.0667; val_global_loss: 27590249.4667; val_optim_loss: 27590249.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9228; val_auprc_score: 0.9177; val_best_acc_score: 0.8498; val_best_f1_score: 0.8567; train_kl_reg_loss: 62850.6720; train_edge_recon_loss: 697499.2443; train_gene_expr_recon_loss: 17784771.2137; train_masked_gp_l1_reg_loss: 77546.9796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72012.4283; train_chrom_access_recon_loss: 9221746.9733; train_global_loss: 27916427.4656; train_optim_loss: 27916427.4656; val_kl_reg_loss: 40159.5161; val_edge_recon_loss: 712852.5500; val_gene_expr_recon_loss: 17638863.6000; val_masked_gp_l1_reg_loss: 77524.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71978.6875; val_chrom_access_recon_loss: 9095822.3333; val_global_loss: 27637199.6000; val_optim_loss: 27637199.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9250; val_auprc_score: 0.9198; val_best_acc_score: 0.8538; val_best_f1_score: 0.8606; train_kl_reg_loss: 62813.3472; train_edge_recon_loss: 696816.3917; train_gene_expr_recon_loss: 17840859.9313; train_masked_gp_l1_reg_loss: 77503.1709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71954.1007; train_chrom_access_recon_loss: 9219003.1374; train_global_loss: 27968950.1221; train_optim_loss: 27968950.1221; val_kl_reg_loss: 40055.1315; val_edge_recon_loss: 710863.4208; val_gene_expr_recon_loss: 17523236.9333; val_masked_gp_l1_reg_loss: 77480.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71923.9219; val_chrom_access_recon_loss: 8987174.2000; val_global_loss: 27410733.7333; val_optim_loss: 27410733.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9317; val_auprc_score: 0.9243; val_best_acc_score: 0.8599; val_best_f1_score: 0.8648; train_kl_reg_loss: 62587.0691; train_edge_recon_loss: 696815.3874; train_gene_expr_recon_loss: 17781840.9618; train_masked_gp_l1_reg_loss: 77453.8983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71903.2497; train_chrom_access_recon_loss: 9227958.8702; train_global_loss: 27918559.4198; train_optim_loss: 27918559.4198; val_kl_reg_loss: 40218.2203; val_edge_recon_loss: 708519.7208; val_gene_expr_recon_loss: 17650256.3333; val_masked_gp_l1_reg_loss: 77428.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71867.7344; val_chrom_access_recon_loss: 9084992.4000; val_global_loss: 27633282.5333; val_optim_loss: 27633282.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9276; val_auprc_score: 0.9221; val_best_acc_score: 0.8541; val_best_f1_score: 0.8603; train_kl_reg_loss: 62802.8947; train_edge_recon_loss: 695812.7390; train_gene_expr_recon_loss: 17776547.0992; train_masked_gp_l1_reg_loss: 77406.4917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71842.6022; train_chrom_access_recon_loss: 9216074.8550; train_global_loss: 27900486.8702; train_optim_loss: 27900486.8702; val_kl_reg_loss: 40239.5526; val_edge_recon_loss: 711456.5333; val_gene_expr_recon_loss: 17585844.5333; val_masked_gp_l1_reg_loss: 77379.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71806.8047; val_chrom_access_recon_loss: 9111744.1333; val_global_loss: 27598470.6667; val_optim_loss: 27598470.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9262; val_auprc_score: 0.9221; val_best_acc_score: 0.8518; val_best_f1_score: 0.8598; train_kl_reg_loss: 62625.2367; train_edge_recon_loss: 697212.7772; train_gene_expr_recon_loss: 17774432.4122; train_masked_gp_l1_reg_loss: 77355.9182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71797.2204; train_chrom_access_recon_loss: 9216882.8321; train_global_loss: 27900306.5649; train_optim_loss: 27900306.5649; val_kl_reg_loss: 40078.6234; val_edge_recon_loss: 709204.4375; val_gene_expr_recon_loss: 17547776.8667; val_masked_gp_l1_reg_loss: 77329.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71778.5781; val_chrom_access_recon_loss: 9058435.8667; val_global_loss: 27504604.0000; val_optim_loss: 27504604.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9260; val_auprc_score: 0.9219; val_best_acc_score: 0.8515; val_best_f1_score: 0.8572; train_kl_reg_loss: 62554.3709; train_edge_recon_loss: 696118.3917; train_gene_expr_recon_loss: 17782753.3282; train_masked_gp_l1_reg_loss: 77303.1341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71744.6428; train_chrom_access_recon_loss: 9228176.3588; train_global_loss: 27918650.1679; train_optim_loss: 27918650.1679; val_kl_reg_loss: 40269.5766; val_edge_recon_loss: 708517.1458; val_gene_expr_recon_loss: 17547743.8000; val_masked_gp_l1_reg_loss: 77280.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71719.3281; val_chrom_access_recon_loss: 9041847.8667; val_global_loss: 27487378.0000; val_optim_loss: 27487378.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9288; val_auprc_score: 0.9231; val_best_acc_score: 0.8558; val_best_f1_score: 0.8622; train_kl_reg_loss: 62912.6903; train_edge_recon_loss: 695941.7996; train_gene_expr_recon_loss: 17781034.3435; train_masked_gp_l1_reg_loss: 77268.9193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71532.2773; train_chrom_access_recon_loss: 9227017.0916; train_global_loss: 27915707.0382; train_optim_loss: 27915707.0382; val_kl_reg_loss: 40500.3453; val_edge_recon_loss: 709235.0833; val_gene_expr_recon_loss: 17513617.0667; val_masked_gp_l1_reg_loss: 77261.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71508.1328; val_chrom_access_recon_loss: 8982339.0333; val_global_loss: 27394461.4667; val_optim_loss: 27394461.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9214; val_auprc_score: 0.9150; val_best_acc_score: 0.8508; val_best_f1_score: 0.8567; train_kl_reg_loss: 62678.4951; train_edge_recon_loss: 696060.1703; train_gene_expr_recon_loss: 17766709.9847; train_masked_gp_l1_reg_loss: 77256.2792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71500.7943; train_chrom_access_recon_loss: 9216353.4847; train_global_loss: 27890559.1908; train_optim_loss: 27890559.1908; val_kl_reg_loss: 40081.2188; val_edge_recon_loss: 708541.4000; val_gene_expr_recon_loss: 17506793.4000; val_masked_gp_l1_reg_loss: 77251.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71495.1172; val_chrom_access_recon_loss: 9047468.4667; val_global_loss: 27451632.1333; val_optim_loss: 27451632.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9265; val_auprc_score: 0.9213; val_best_acc_score: 0.8494; val_best_f1_score: 0.8570; train_kl_reg_loss: 62548.1971; train_edge_recon_loss: 696175.2004; train_gene_expr_recon_loss: 17768735.3053; train_masked_gp_l1_reg_loss: 77247.1780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71490.0821; train_chrom_access_recon_loss: 9219637.5420; train_global_loss: 27895833.5115; train_optim_loss: 27895833.5115; val_kl_reg_loss: 40047.5641; val_edge_recon_loss: 708221.6833; val_gene_expr_recon_loss: 17587834.6667; val_masked_gp_l1_reg_loss: 77242.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71485.9219; val_chrom_access_recon_loss: 9080636.2000; val_global_loss: 27565468.2667; val_optim_loss: 27565468.2667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9257; val_auprc_score: 0.9180; val_best_acc_score: 0.8500; val_best_f1_score: 0.8567; train_kl_reg_loss: 2764939.4879; train_edge_recon_loss: 696236.3927; train_gene_expr_recon_loss: 17805219.8473; train_masked_gp_l1_reg_loss: 77238.8869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71482.7255; train_chrom_access_recon_loss: 9226761.7634; train_global_loss: 30641879.0840; train_optim_loss: 30641879.0840; val_kl_reg_loss: 39958.4768; val_edge_recon_loss: 708315.6333; val_gene_expr_recon_loss: 17477385.5333; val_masked_gp_l1_reg_loss: 77234.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71480.0156; val_chrom_access_recon_loss: 9017052.3667; val_global_loss: 27391426.2667; val_optim_loss: 27391426.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9265; val_auprc_score: 0.9184; val_best_acc_score: 0.8570; val_best_f1_score: 0.8631; train_kl_reg_loss: 62100.7357; train_edge_recon_loss: 696811.6307; train_gene_expr_recon_loss: 17775231.3969; train_masked_gp_l1_reg_loss: 77231.0921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71476.0656; train_chrom_access_recon_loss: 9215119.5267; train_global_loss: 27897970.4275; train_optim_loss: 27897970.4275; val_kl_reg_loss: 39864.4482; val_edge_recon_loss: 708239.9917; val_gene_expr_recon_loss: 17595092.4000; val_masked_gp_l1_reg_loss: 77227.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71472.7734; val_chrom_access_recon_loss: 9093294.4000; val_global_loss: 27585190.9333; val_optim_loss: 27585190.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9265; val_auprc_score: 0.9207; val_best_acc_score: 0.8499; val_best_f1_score: 0.8588; train_kl_reg_loss: 61959.5099; train_edge_recon_loss: 695899.8540; train_gene_expr_recon_loss: 17775693.3969; train_masked_gp_l1_reg_loss: 77223.2329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71469.4865; train_chrom_access_recon_loss: 9221683.6031; train_global_loss: 27903929.2519; train_optim_loss: 27903929.2519; val_kl_reg_loss: 40005.6266; val_edge_recon_loss: 707345.8292; val_gene_expr_recon_loss: 17586457.2667; val_masked_gp_l1_reg_loss: 77219.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71465.0000; val_chrom_access_recon_loss: 9085094.2000; val_global_loss: 27567587.6000; val_optim_loss: 27567587.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9264; val_auprc_score: 0.9192; val_best_acc_score: 0.8494; val_best_f1_score: 0.8574; train_kl_reg_loss: 62166.7751; train_edge_recon_loss: 696295.4094; train_gene_expr_recon_loss: 17785650.7252; train_masked_gp_l1_reg_loss: 77215.1245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71461.9299; train_chrom_access_recon_loss: 9224577.5954; train_global_loss: 27917367.7557; train_optim_loss: 27917367.7557; val_kl_reg_loss: 39604.8076; val_edge_recon_loss: 709936.0417; val_gene_expr_recon_loss: 17552083.6000; val_masked_gp_l1_reg_loss: 77210.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71458.7109; val_chrom_access_recon_loss: 9067876.6000; val_global_loss: 27518168.8000; val_optim_loss: 27518168.8000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9283; val_auprc_score: 0.9231; val_best_acc_score: 0.8545; val_best_f1_score: 0.8597; train_kl_reg_loss: 62079.1374; train_edge_recon_loss: 696374.2400; train_gene_expr_recon_loss: 17762494.9237; train_masked_gp_l1_reg_loss: 77206.2170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71455.8299; train_chrom_access_recon_loss: 9216958.3206; train_global_loss: 27886568.5954; train_optim_loss: 27886568.5954; val_kl_reg_loss: 40353.8951; val_edge_recon_loss: 708990.8792; val_gene_expr_recon_loss: 17481355.6000; val_masked_gp_l1_reg_loss: 77201.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71452.0781; val_chrom_access_recon_loss: 9055967.3667; val_global_loss: 27435322.0000; val_optim_loss: 27435322.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9272; val_auprc_score: 0.9195; val_best_acc_score: 0.8529; val_best_f1_score: 0.8575; train_kl_reg_loss: 61951.2556; train_edge_recon_loss: 696216.8073; train_gene_expr_recon_loss: 17767617.8168; train_masked_gp_l1_reg_loss: 77199.9054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71433.5480; train_chrom_access_recon_loss: 9205747.6374; train_global_loss: 27880167.3130; train_optim_loss: 27880167.3130; val_kl_reg_loss: 39727.1055; val_edge_recon_loss: 708264.2250; val_gene_expr_recon_loss: 17531957.7333; val_masked_gp_l1_reg_loss: 77199.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71431.0312; val_chrom_access_recon_loss: 9062967.6333; val_global_loss: 27491548.8000; val_optim_loss: 27491548.8000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9257; val_auprc_score: 0.9203; val_best_acc_score: 0.8550; val_best_f1_score: 0.8602; train_kl_reg_loss: 62184.1268; train_edge_recon_loss: 695741.3531; train_gene_expr_recon_loss: 17819423.6107; train_masked_gp_l1_reg_loss: 77198.4979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71430.3365; train_chrom_access_recon_loss: 9219080.6107; train_global_loss: 27945057.8015; train_optim_loss: 27945057.8015; val_kl_reg_loss: 39728.1695; val_edge_recon_loss: 709769.7000; val_gene_expr_recon_loss: 17525622.2667; val_masked_gp_l1_reg_loss: 77197.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71429.7578; val_chrom_access_recon_loss: 9042434.9333; val_global_loss: 27466183.2000; val_optim_loss: 27466183.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9263; val_auprc_score: 0.9187; val_best_acc_score: 0.8542; val_best_f1_score: 0.8607; train_kl_reg_loss: 62143.2593; train_edge_recon_loss: 696880.3440; train_gene_expr_recon_loss: 17814743.0992; train_masked_gp_l1_reg_loss: 77197.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71429.2331; train_chrom_access_recon_loss: 9219031.0305; train_global_loss: 27941424.7939; train_optim_loss: 27941424.7939; val_kl_reg_loss: 39798.6242; val_edge_recon_loss: 707578.8750; val_gene_expr_recon_loss: 17591243.9333; val_masked_gp_l1_reg_loss: 77196.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71428.8438; val_chrom_access_recon_loss: 9064086.6000; val_global_loss: 27551332.4000; val_optim_loss: 27551332.4000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9276; val_auprc_score: 0.9222; val_best_acc_score: 0.8530; val_best_f1_score: 0.8588; train_kl_reg_loss: 62188.2798; train_edge_recon_loss: 696696.6918; train_gene_expr_recon_loss: 17784819.8779; train_masked_gp_l1_reg_loss: 77196.1800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71428.3151; train_chrom_access_recon_loss: 9223925.5267; train_global_loss: 27916254.3359; train_optim_loss: 27916254.3359; val_kl_reg_loss: 39666.6922; val_edge_recon_loss: 707587.8917; val_gene_expr_recon_loss: 17578709.8667; val_masked_gp_l1_reg_loss: 77195.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71427.8750; val_chrom_access_recon_loss: 9073336.0667; val_global_loss: 27547924.6667; val_optim_loss: 27547924.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 40 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9253
val AUPRC score: 0.9211
val best accuracy score: 0.8504
val best F1 score: 0.8566
val target rna MSE score: 1.7372
val source rna MSE score: 0.9864
val target atac MSE score: 0.3311
val source atac MSE score: 0.1037
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
