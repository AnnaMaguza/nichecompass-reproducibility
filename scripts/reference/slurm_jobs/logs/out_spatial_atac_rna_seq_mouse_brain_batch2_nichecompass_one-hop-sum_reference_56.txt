[True]
Run timestamp: 10082023_212440_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7206; val_auprc_score: 0.7583; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 127978.4658; train_edge_recon_loss: 3807870.7328; train_gene_expr_recon_loss: 46394776.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1383301.8292; train_global_loss: 51713927.4198; train_optim_loss: 51713927.4198; val_kl_reg_loss: 163039.5495; val_edge_recon_loss: 4065834.1667; val_gene_expr_recon_loss: 39276978.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1298719.7167; val_global_loss: 44804572.0000; val_optim_loss: 44804572.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7578; val_auprc_score: 0.7834; val_best_acc_score: 0.6036; val_best_f1_score: 0.7031; train_kl_reg_loss: 170455.7068; train_edge_recon_loss: 3678282.7462; train_gene_expr_recon_loss: 38136882.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1285594.5802; train_global_loss: 43271215.5725; train_optim_loss: 43271215.5725; val_kl_reg_loss: 188364.4813; val_edge_recon_loss: 4058775.8167; val_gene_expr_recon_loss: 37516513.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1264021.8000; val_global_loss: 43027675.7333; val_optim_loss: 43027675.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8128; val_auprc_score: 0.8238; val_best_acc_score: 0.7257; val_best_f1_score: 0.7270; train_kl_reg_loss: 182180.5916; train_edge_recon_loss: 3569943.1412; train_gene_expr_recon_loss: 36934041.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1265186.3874; train_global_loss: 41951352.3053; train_optim_loss: 41951352.3053; val_kl_reg_loss: 166886.0552; val_edge_recon_loss: 4013878.0833; val_gene_expr_recon_loss: 37181551.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1261513.1750; val_global_loss: 42623828.8000; val_optim_loss: 42623828.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8720; val_best_acc_score: 0.7828; val_best_f1_score: 0.8021; train_kl_reg_loss: 158732.4659; train_edge_recon_loss: 3531190.3950; train_gene_expr_recon_loss: 36594121.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1258782.9284; train_global_loss: 41542827.7863; train_optim_loss: 41542827.7863; val_kl_reg_loss: 161425.1271; val_edge_recon_loss: 3883387.8667; val_gene_expr_recon_loss: 36773597.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248653.9333; val_global_loss: 42067064.2667; val_optim_loss: 42067064.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8838; val_auprc_score: 0.8731; val_best_acc_score: 0.7959; val_best_f1_score: 0.8096; train_kl_reg_loss: 133839.5242; train_edge_recon_loss: 3392519.2882; train_gene_expr_recon_loss: 36337224.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1253070.2328; train_global_loss: 41116653.8015; train_optim_loss: 41116653.8015; val_kl_reg_loss: 139761.8589; val_edge_recon_loss: 3189025.2833; val_gene_expr_recon_loss: 36685985.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1250135.6750; val_global_loss: 41264908.0000; val_optim_loss: 41264908.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8916; val_auprc_score: 0.8805; val_best_acc_score: 0.8065; val_best_f1_score: 0.8158; train_kl_reg_loss: 166584.3668; train_edge_recon_loss: 3053398.6069; train_gene_expr_recon_loss: 36158051.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1249747.0563; train_global_loss: 40627781.3435; train_optim_loss: 40627781.3435; val_kl_reg_loss: 172343.7865; val_edge_recon_loss: 3023351.0833; val_gene_expr_recon_loss: 36174331.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1239223.5750; val_global_loss: 40609249.6000; val_optim_loss: 40609249.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9038; val_auprc_score: 0.8913; val_best_acc_score: 0.8222; val_best_f1_score: 0.8367; train_kl_reg_loss: 170073.3781; train_edge_recon_loss: 2985205.9466; train_gene_expr_recon_loss: 35854363.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1241761.7452; train_global_loss: 40251403.9084; train_optim_loss: 40251403.9084; val_kl_reg_loss: 161477.7760; val_edge_recon_loss: 2972722.0500; val_gene_expr_recon_loss: 36174692.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1237567.8000; val_global_loss: 40546460.2667; val_optim_loss: 40546460.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9081; val_auprc_score: 0.8935; val_best_acc_score: 0.8304; val_best_f1_score: 0.8439; train_kl_reg_loss: 162358.3397; train_edge_recon_loss: 2944474.9485; train_gene_expr_recon_loss: 35645560.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1236106.7118; train_global_loss: 39988500.7328; train_optim_loss: 39988500.7328; val_kl_reg_loss: 165465.4375; val_edge_recon_loss: 2927368.3667; val_gene_expr_recon_loss: 35926098.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1232425.7167; val_global_loss: 40251359.2000; val_optim_loss: 40251359.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9174; val_auprc_score: 0.9052; val_best_acc_score: 0.8424; val_best_f1_score: 0.8548; train_kl_reg_loss: 160239.1150; train_edge_recon_loss: 2899157.6565; train_gene_expr_recon_loss: 35505917.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1233134.3989; train_global_loss: 39798448.2748; train_optim_loss: 39798448.2748; val_kl_reg_loss: 156774.6667; val_edge_recon_loss: 2893438.8167; val_gene_expr_recon_loss: 35606654.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1225112.7750; val_global_loss: 39881979.7333; val_optim_loss: 39881979.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9159; val_auprc_score: 0.8977; val_best_acc_score: 0.8471; val_best_f1_score: 0.8593; train_kl_reg_loss: 154658.1390; train_edge_recon_loss: 2883255.3282; train_gene_expr_recon_loss: 35369579.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1230730.2901; train_global_loss: 39638223.3282; train_optim_loss: 39638223.3282; val_kl_reg_loss: 147306.9656; val_edge_recon_loss: 2899719.1667; val_gene_expr_recon_loss: 35622976.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1223954.0083; val_global_loss: 39893956.5333; val_optim_loss: 39893956.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9183; val_auprc_score: 0.9042; val_best_acc_score: 0.8506; val_best_f1_score: 0.8622; train_kl_reg_loss: 148265.6813; train_edge_recon_loss: 2870506.9294; train_gene_expr_recon_loss: 35197574.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1224518.8235; train_global_loss: 39440865.4351; train_optim_loss: 39440865.4351; val_kl_reg_loss: 146775.2167; val_edge_recon_loss: 2890070.8667; val_gene_expr_recon_loss: 35420514.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1219554.2333; val_global_loss: 39676914.1333; val_optim_loss: 39676914.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9269; val_auprc_score: 0.9113; val_best_acc_score: 0.8584; val_best_f1_score: 0.8680; train_kl_reg_loss: 145201.3303; train_edge_recon_loss: 2854175.3702; train_gene_expr_recon_loss: 35123605.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1223965.9819; train_global_loss: 39346948.2748; train_optim_loss: 39346948.2748; val_kl_reg_loss: 144008.4865; val_edge_recon_loss: 2842467.9500; val_gene_expr_recon_loss: 35383778.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1220985.4417; val_global_loss: 39591240.8000; val_optim_loss: 39591240.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9382; val_auprc_score: 0.9288; val_best_acc_score: 0.8669; val_best_f1_score: 0.8743; train_kl_reg_loss: 141875.8181; train_edge_recon_loss: 2845794.8206; train_gene_expr_recon_loss: 34987954.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220468.2424; train_global_loss: 39196093.6489; train_optim_loss: 39196093.6489; val_kl_reg_loss: 138171.6667; val_edge_recon_loss: 2832478.4000; val_gene_expr_recon_loss: 35264005.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214990.1000; val_global_loss: 39449645.6000; val_optim_loss: 39449645.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9358; val_auprc_score: 0.9246; val_best_acc_score: 0.8674; val_best_f1_score: 0.8730; train_kl_reg_loss: 136746.5798; train_edge_recon_loss: 2831168.6393; train_gene_expr_recon_loss: 34926703.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219464.6469; train_global_loss: 39114083.1145; train_optim_loss: 39114083.1145; val_kl_reg_loss: 130963.1031; val_edge_recon_loss: 2854542.7000; val_gene_expr_recon_loss: 35229105.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217702.2583; val_global_loss: 39432312.8000; val_optim_loss: 39432312.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9406; val_auprc_score: 0.9290; val_best_acc_score: 0.8735; val_best_f1_score: 0.8797; train_kl_reg_loss: 132447.1507; train_edge_recon_loss: 2816525.1183; train_gene_expr_recon_loss: 34799998.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1215735.8817; train_global_loss: 38964706.9008; train_optim_loss: 38964706.9008; val_kl_reg_loss: 128193.5359; val_edge_recon_loss: 2830604.5167; val_gene_expr_recon_loss: 35054962.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217117.3750; val_global_loss: 39230877.8667; val_optim_loss: 39230877.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9457; val_auprc_score: 0.9356; val_best_acc_score: 0.8832; val_best_f1_score: 0.8872; train_kl_reg_loss: 127321.1859; train_edge_recon_loss: 2825225.1775; train_gene_expr_recon_loss: 34730922.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214593.6307; train_global_loss: 38898062.1069; train_optim_loss: 38898062.1069; val_kl_reg_loss: 129182.6818; val_edge_recon_loss: 2815970.0000; val_gene_expr_recon_loss: 35076509.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214850.2917; val_global_loss: 39236512.2667; val_optim_loss: 39236512.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9514; val_auprc_score: 0.9407; val_best_acc_score: 0.8890; val_best_f1_score: 0.8949; train_kl_reg_loss: 125287.8164; train_edge_recon_loss: 2802162.1260; train_gene_expr_recon_loss: 34691382.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214086.6784; train_global_loss: 38832919.1756; train_optim_loss: 38832919.1756; val_kl_reg_loss: 125103.0026; val_edge_recon_loss: 2779730.4833; val_gene_expr_recon_loss: 34933231.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1213496.3917; val_global_loss: 39051561.6000; val_optim_loss: 39051561.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9504; val_auprc_score: 0.9409; val_best_acc_score: 0.8836; val_best_f1_score: 0.8887; train_kl_reg_loss: 123356.8556; train_edge_recon_loss: 2790830.9351; train_gene_expr_recon_loss: 34593411.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212048.8406; train_global_loss: 38719648.2443; train_optim_loss: 38719648.2443; val_kl_reg_loss: 126282.0068; val_edge_recon_loss: 2795581.8000; val_gene_expr_recon_loss: 34984421.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1212786.7333; val_global_loss: 39119072.5333; val_optim_loss: 39119072.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9544; val_auprc_score: 0.9457; val_best_acc_score: 0.8928; val_best_f1_score: 0.8965; train_kl_reg_loss: 121345.5440; train_edge_recon_loss: 2785546.6279; train_gene_expr_recon_loss: 34563029.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212286.3254; train_global_loss: 38682207.6031; train_optim_loss: 38682207.6031; val_kl_reg_loss: 118466.3396; val_edge_recon_loss: 2810329.7833; val_gene_expr_recon_loss: 34947657.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1209069.4333; val_global_loss: 39085522.6667; val_optim_loss: 39085522.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9583; val_auprc_score: 0.9490; val_best_acc_score: 0.9012; val_best_f1_score: 0.9033; train_kl_reg_loss: 117080.3816; train_edge_recon_loss: 2787663.3550; train_gene_expr_recon_loss: 34537130.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211806.1202; train_global_loss: 38653680.2443; train_optim_loss: 38653680.2443; val_kl_reg_loss: 116670.4036; val_edge_recon_loss: 2770604.9500; val_gene_expr_recon_loss: 34851891.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1208967.2333; val_global_loss: 38948134.1333; val_optim_loss: 38948134.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9619; val_auprc_score: 0.9546; val_best_acc_score: 0.9019; val_best_f1_score: 0.9053; train_kl_reg_loss: 116350.1868; train_edge_recon_loss: 2770790.5725; train_gene_expr_recon_loss: 34463855.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1210890.8788; train_global_loss: 38561887.3893; train_optim_loss: 38561887.3893; val_kl_reg_loss: 115056.9734; val_edge_recon_loss: 2784465.9000; val_gene_expr_recon_loss: 34755947.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1206748.2917; val_global_loss: 38862218.4000; val_optim_loss: 38862218.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9581; val_auprc_score: 0.9483; val_best_acc_score: 0.9008; val_best_f1_score: 0.9049; train_kl_reg_loss: 113726.3320; train_edge_recon_loss: 2767587.2824; train_gene_expr_recon_loss: 34379838.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208909.1803; train_global_loss: 38470060.9771; train_optim_loss: 38470060.9771; val_kl_reg_loss: 111864.5943; val_edge_recon_loss: 2785141.5833; val_gene_expr_recon_loss: 34782217.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1209127.3417; val_global_loss: 38888351.4667; val_optim_loss: 38888351.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9659; val_auprc_score: 0.9610; val_best_acc_score: 0.9085; val_best_f1_score: 0.9121; train_kl_reg_loss: 111571.5375; train_edge_recon_loss: 2765612.2156; train_gene_expr_recon_loss: 34340714.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208627.1212; train_global_loss: 38426525.7099; train_optim_loss: 38426525.7099; val_kl_reg_loss: 111726.3391; val_edge_recon_loss: 2769075.9000; val_gene_expr_recon_loss: 34637933.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1205554.3083; val_global_loss: 38724290.6667; val_optim_loss: 38724290.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9655; val_auprc_score: 0.9588; val_best_acc_score: 0.9074; val_best_f1_score: 0.9106; train_kl_reg_loss: 110311.1428; train_edge_recon_loss: 2753360.8855; train_gene_expr_recon_loss: 34253081.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207432.6527; train_global_loss: 38324186.3817; train_optim_loss: 38324186.3817; val_kl_reg_loss: 110373.7708; val_edge_recon_loss: 2771484.7500; val_gene_expr_recon_loss: 34660189.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1206246.2917; val_global_loss: 38748293.8667; val_optim_loss: 38748293.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9644; val_auprc_score: 0.9569; val_best_acc_score: 0.9072; val_best_f1_score: 0.9096; train_kl_reg_loss: 108776.3999; train_edge_recon_loss: 2746693.3073; train_gene_expr_recon_loss: 34291342.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1210125.1632; train_global_loss: 38356937.1298; train_optim_loss: 38356937.1298; val_kl_reg_loss: 109723.7510; val_edge_recon_loss: 2762878.1500; val_gene_expr_recon_loss: 34611658.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1207225.8167; val_global_loss: 38691485.6000; val_optim_loss: 38691485.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9678; val_auprc_score: 0.9603; val_best_acc_score: 0.9138; val_best_f1_score: 0.9167; train_kl_reg_loss: 111720.6933; train_edge_recon_loss: 2777253.6756; train_gene_expr_recon_loss: 34940322.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1234592.4084; train_global_loss: 39063889.1603; train_optim_loss: 39063889.1603; val_kl_reg_loss: 74845.4536; val_edge_recon_loss: 2764473.9500; val_gene_expr_recon_loss: 35153322.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1224777.7667; val_global_loss: 39217420.0000; val_optim_loss: 39217420.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9699; val_auprc_score: 0.9605; val_best_acc_score: 0.9167; val_best_f1_score: 0.9187; train_kl_reg_loss: 110467.0581; train_edge_recon_loss: 2761037.9771; train_gene_expr_recon_loss: 34792272.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1225475.6937; train_global_loss: 38889252.8855; train_optim_loss: 38889252.8855; val_kl_reg_loss: 75581.1854; val_edge_recon_loss: 2759235.8667; val_gene_expr_recon_loss: 35007575.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218394.5250; val_global_loss: 39060787.2000; val_optim_loss: 39060787.2000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9702; val_auprc_score: 0.9638; val_best_acc_score: 0.9178; val_best_f1_score: 0.9199; train_kl_reg_loss: 106306.6469; train_edge_recon_loss: 2744914.9466; train_gene_expr_recon_loss: 34691181.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1221924.1202; train_global_loss: 38764326.8092; train_optim_loss: 38764326.8092; val_kl_reg_loss: 77896.7833; val_edge_recon_loss: 2758019.9000; val_gene_expr_recon_loss: 35037231.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218368.4333; val_global_loss: 39091516.8000; val_optim_loss: 39091516.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9725; val_auprc_score: 0.9684; val_best_acc_score: 0.9193; val_best_f1_score: 0.9214; train_kl_reg_loss: 102699.5068; train_edge_recon_loss: 2737800.2080; train_gene_expr_recon_loss: 34662642.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220836.0153; train_global_loss: 38723978.4427; train_optim_loss: 38723978.4427; val_kl_reg_loss: 77728.4927; val_edge_recon_loss: 2734391.3167; val_gene_expr_recon_loss: 35004282.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221799.9833; val_global_loss: 39038202.6667; val_optim_loss: 39038202.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9690; val_auprc_score: 0.9619; val_best_acc_score: 0.9163; val_best_f1_score: 0.9188; train_kl_reg_loss: 102835.9450; train_edge_recon_loss: 2737867.0878; train_gene_expr_recon_loss: 34622018.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219891.1994; train_global_loss: 38682612.6718; train_optim_loss: 38682612.6718; val_kl_reg_loss: 78109.7859; val_edge_recon_loss: 2765262.7833; val_gene_expr_recon_loss: 34853248.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1212002.9500; val_global_loss: 38908624.8000; val_optim_loss: 38908624.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9685; val_auprc_score: 0.9628; val_best_acc_score: 0.9142; val_best_f1_score: 0.9167; train_kl_reg_loss: 102612.2805; train_edge_recon_loss: 2727618.4256; train_gene_expr_recon_loss: 34582034.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219187.8139; train_global_loss: 38631453.3130; train_optim_loss: 38631453.3130; val_kl_reg_loss: 78389.9625; val_edge_recon_loss: 2768584.1500; val_gene_expr_recon_loss: 35047396.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221493.9167; val_global_loss: 39115865.6000; val_optim_loss: 39115865.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9716; val_auprc_score: 0.9661; val_best_acc_score: 0.9173; val_best_f1_score: 0.9201; train_kl_reg_loss: 101906.1815; train_edge_recon_loss: 2735282.5267; train_gene_expr_recon_loss: 34563154.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218335.7567; train_global_loss: 38618679.0534; train_optim_loss: 38618679.0534; val_kl_reg_loss: 78037.8099; val_edge_recon_loss: 2756379.2833; val_gene_expr_recon_loss: 34961820.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218514.5250; val_global_loss: 39014753.0667; val_optim_loss: 39014753.0667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9686; val_auprc_score: 0.9609; val_best_acc_score: 0.9146; val_best_f1_score: 0.9166; train_kl_reg_loss: 101497.4241; train_edge_recon_loss: 2736416.3015; train_gene_expr_recon_loss: 34577959.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219843.2634; train_global_loss: 38635716.3969; train_optim_loss: 38635716.3969; val_kl_reg_loss: 79161.9760; val_edge_recon_loss: 2750744.8333; val_gene_expr_recon_loss: 34833311.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1215380.0000; val_global_loss: 38878597.6000; val_optim_loss: 38878597.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 23 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9657
val AUPRC score: 0.9555
val best accuracy score: 0.9086
val best F1 score: 0.9112
val target rna MSE score: 1.0040
val source rna MSE score: 24.8861
val target atac MSE score: 0.5689
val source atac MSE score: 8.2738
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
