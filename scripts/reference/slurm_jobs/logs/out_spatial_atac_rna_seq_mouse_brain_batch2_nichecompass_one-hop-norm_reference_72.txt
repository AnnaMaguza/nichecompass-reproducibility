[True]
Run timestamp: 09102023_232324_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6547; val_auprc_score: 0.6434; val_best_acc_score: 0.5116; val_best_f1_score: 0.6707; train_kl_reg_loss: 50718.7600; train_edge_recon_loss: 3515783.9508; train_gene_expr_recon_loss: 14032821.9697; train_masked_gp_l1_reg_loss: 89673.3510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2964974.3239; train_chrom_access_recon_loss: 6935727.6667; train_global_loss: 27589700.0909; train_optim_loss: 27589700.0909; val_kl_reg_loss: 88358.9893; val_edge_recon_loss: 4064546.6250; val_gene_expr_recon_loss: 12936928.7500; val_masked_gp_l1_reg_loss: 75058.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1639484.7500; val_chrom_access_recon_loss: 6680644.3125; val_global_loss: 25485021.0000; val_optim_loss: 25485021.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6660; val_auprc_score: 0.6535; val_best_acc_score: 0.5355; val_best_f1_score: 0.6787; train_kl_reg_loss: 96034.5285; train_edge_recon_loss: 3524986.7879; train_gene_expr_recon_loss: 12840128.8182; train_masked_gp_l1_reg_loss: 72735.6881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 893253.2197; train_chrom_access_recon_loss: 6589056.9394; train_global_loss: 24016196.0303; train_optim_loss: 24016196.0303; val_kl_reg_loss: 113765.6445; val_edge_recon_loss: 4063112.1562; val_gene_expr_recon_loss: 12712554.3750; val_masked_gp_l1_reg_loss: 71921.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 435491.9688; val_chrom_access_recon_loss: 6584686.6250; val_global_loss: 23981532.5000; val_optim_loss: 23981532.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7379; val_auprc_score: 0.7274; val_best_acc_score: 0.6644; val_best_f1_score: 0.7069; train_kl_reg_loss: 93429.7143; train_edge_recon_loss: 3516838.1591; train_gene_expr_recon_loss: 12679363.9242; train_masked_gp_l1_reg_loss: 72426.2702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 295541.9841; train_chrom_access_recon_loss: 6533962.0076; train_global_loss: 23191562.1515; train_optim_loss: 23191562.1515; val_kl_reg_loss: 79520.4912; val_edge_recon_loss: 4033877.5000; val_gene_expr_recon_loss: 12548807.1250; val_masked_gp_l1_reg_loss: 73878.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206495.2031; val_chrom_access_recon_loss: 6531683.0625; val_global_loss: 23474263.0000; val_optim_loss: 23474263.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8120; val_auprc_score: 0.7842; val_best_acc_score: 0.7340; val_best_f1_score: 0.7715; train_kl_reg_loss: 76679.9920; train_edge_recon_loss: 3470977.0947; train_gene_expr_recon_loss: 12575174.0000; train_masked_gp_l1_reg_loss: 75951.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167859.2372; train_chrom_access_recon_loss: 6495057.9924; train_global_loss: 22861699.9394; train_optim_loss: 22861699.9394; val_kl_reg_loss: 67066.4185; val_edge_recon_loss: 3505703.7500; val_gene_expr_recon_loss: 12483639.7500; val_masked_gp_l1_reg_loss: 79345.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139788.1406; val_chrom_access_recon_loss: 6541589.8750; val_global_loss: 22817133.5000; val_optim_loss: 22817133.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8245; val_auprc_score: 0.7943; val_best_acc_score: 0.7394; val_best_f1_score: 0.7870; train_kl_reg_loss: 79344.7688; train_edge_recon_loss: 3100808.3220; train_gene_expr_recon_loss: 12556507.5909; train_masked_gp_l1_reg_loss: 88212.1903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126725.8830; train_chrom_access_recon_loss: 6476631.1364; train_global_loss: 22428230.0000; train_optim_loss: 22428230.0000; val_kl_reg_loss: 96173.6338; val_edge_recon_loss: 3026985.3125; val_gene_expr_recon_loss: 12495175.5000; val_masked_gp_l1_reg_loss: 96302.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114711.2891; val_chrom_access_recon_loss: 6509658.3125; val_global_loss: 22339006.7500; val_optim_loss: 22339006.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8292; val_auprc_score: 0.7968; val_best_acc_score: 0.7402; val_best_f1_score: 0.7826; train_kl_reg_loss: 102953.1078; train_edge_recon_loss: 2956881.4167; train_gene_expr_recon_loss: 12458261.9242; train_masked_gp_l1_reg_loss: 94943.7298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106011.6175; train_chrom_access_recon_loss: 6423369.1364; train_global_loss: 22142421.0000; train_optim_loss: 22142421.0000; val_kl_reg_loss: 106277.6934; val_edge_recon_loss: 3010021.0312; val_gene_expr_recon_loss: 12425214.7500; val_masked_gp_l1_reg_loss: 94218.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99483.3125; val_chrom_access_recon_loss: 6399344.5000; val_global_loss: 22134559.7500; val_optim_loss: 22134559.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8650; val_auprc_score: 0.8373; val_best_acc_score: 0.7716; val_best_f1_score: 0.7967; train_kl_reg_loss: 100902.1399; train_edge_recon_loss: 2938167.9242; train_gene_expr_recon_loss: 12395066.9091; train_masked_gp_l1_reg_loss: 94147.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93985.5415; train_chrom_access_recon_loss: 6400155.7879; train_global_loss: 22022425.7273; train_optim_loss: 22022425.7273; val_kl_reg_loss: 96611.1104; val_edge_recon_loss: 2919812.0938; val_gene_expr_recon_loss: 12413665.7500; val_masked_gp_l1_reg_loss: 94073.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89659.1094; val_chrom_access_recon_loss: 6480867.3750; val_global_loss: 22094688.5000; val_optim_loss: 22094688.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8619; val_auprc_score: 0.8283; val_best_acc_score: 0.7918; val_best_f1_score: 0.8098; train_kl_reg_loss: 94909.2096; train_edge_recon_loss: 2917242.4242; train_gene_expr_recon_loss: 12318960.9848; train_masked_gp_l1_reg_loss: 94140.4628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86408.7125; train_chrom_access_recon_loss: 6371462.7197; train_global_loss: 21883124.4545; train_optim_loss: 21883124.4545; val_kl_reg_loss: 95594.2412; val_edge_recon_loss: 2910778.1562; val_gene_expr_recon_loss: 12271912.3750; val_masked_gp_l1_reg_loss: 94626.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83892.4141; val_chrom_access_recon_loss: 6463968.8750; val_global_loss: 21920772.0000; val_optim_loss: 21920772.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8795; val_auprc_score: 0.8412; val_best_acc_score: 0.8079; val_best_f1_score: 0.8251; train_kl_reg_loss: 94999.0965; train_edge_recon_loss: 2870875.8258; train_gene_expr_recon_loss: 12258517.0758; train_masked_gp_l1_reg_loss: 95111.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81837.9934; train_chrom_access_recon_loss: 6350937.7045; train_global_loss: 21752279.4545; train_optim_loss: 21752279.4545; val_kl_reg_loss: 93378.8154; val_edge_recon_loss: 2905144.5000; val_gene_expr_recon_loss: 12246138.8750; val_masked_gp_l1_reg_loss: 96142.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79747.8906; val_chrom_access_recon_loss: 6407854.7500; val_global_loss: 21828407.5000; val_optim_loss: 21828407.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8968; val_auprc_score: 0.8579; val_best_acc_score: 0.8318; val_best_f1_score: 0.8474; train_kl_reg_loss: 95118.3512; train_edge_recon_loss: 2849015.1288; train_gene_expr_recon_loss: 12202947.6818; train_masked_gp_l1_reg_loss: 96856.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78181.5187; train_chrom_access_recon_loss: 6326141.6970; train_global_loss: 21648261.5152; train_optim_loss: 21648261.5152; val_kl_reg_loss: 92579.4658; val_edge_recon_loss: 2842372.3750; val_gene_expr_recon_loss: 12111310.2500; val_masked_gp_l1_reg_loss: 97442.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76317.7266; val_chrom_access_recon_loss: 6315176.5000; val_global_loss: 21535198.7500; val_optim_loss: 21535198.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8964; val_auprc_score: 0.8518; val_best_acc_score: 0.8364; val_best_f1_score: 0.8508; train_kl_reg_loss: 98226.3390; train_edge_recon_loss: 2803429.9924; train_gene_expr_recon_loss: 12153860.1364; train_masked_gp_l1_reg_loss: 98349.2966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74633.5138; train_chrom_access_recon_loss: 6305278.2348; train_global_loss: 21533777.4242; train_optim_loss: 21533777.4242; val_kl_reg_loss: 97308.6680; val_edge_recon_loss: 2812895.3125; val_gene_expr_recon_loss: 12149432.1250; val_masked_gp_l1_reg_loss: 98988.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73560.6562; val_chrom_access_recon_loss: 6346412.9375; val_global_loss: 21578598.7500; val_optim_loss: 21578598.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9027; val_auprc_score: 0.8657; val_best_acc_score: 0.8418; val_best_f1_score: 0.8520; train_kl_reg_loss: 95880.1796; train_edge_recon_loss: 2797742.0758; train_gene_expr_recon_loss: 12114118.5606; train_masked_gp_l1_reg_loss: 99676.2817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71813.6869; train_chrom_access_recon_loss: 6287239.9697; train_global_loss: 21466470.8485; train_optim_loss: 21466470.8485; val_kl_reg_loss: 95114.8418; val_edge_recon_loss: 2820785.9688; val_gene_expr_recon_loss: 11958771.3750; val_masked_gp_l1_reg_loss: 100231.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70497.2266; val_chrom_access_recon_loss: 6274604.6250; val_global_loss: 21320004.7500; val_optim_loss: 21320004.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9131; val_auprc_score: 0.8770; val_best_acc_score: 0.8501; val_best_f1_score: 0.8635; train_kl_reg_loss: 96584.8421; train_edge_recon_loss: 2780007.0644; train_gene_expr_recon_loss: 12061192.6212; train_masked_gp_l1_reg_loss: 100888.1536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69468.1173; train_chrom_access_recon_loss: 6256598.4621; train_global_loss: 21364739.1212; train_optim_loss: 21364739.1212; val_kl_reg_loss: 95500.5098; val_edge_recon_loss: 2813747.4375; val_gene_expr_recon_loss: 11997748.3750; val_masked_gp_l1_reg_loss: 101230.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68304.1875; val_chrom_access_recon_loss: 6280667.2500; val_global_loss: 21357199.0000; val_optim_loss: 21357199.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9174; val_auprc_score: 0.8901; val_best_acc_score: 0.8595; val_best_f1_score: 0.8686; train_kl_reg_loss: 95957.8568; train_edge_recon_loss: 2766798.5152; train_gene_expr_recon_loss: 12027556.8182; train_masked_gp_l1_reg_loss: 101795.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67778.4324; train_chrom_access_recon_loss: 6241042.0000; train_global_loss: 21300929.3939; train_optim_loss: 21300929.3939; val_kl_reg_loss: 94102.8701; val_edge_recon_loss: 2782949.9062; val_gene_expr_recon_loss: 11916535.8750; val_masked_gp_l1_reg_loss: 102156.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67000.5156; val_chrom_access_recon_loss: 6227209.8125; val_global_loss: 21189955.5000; val_optim_loss: 21189955.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9112; val_auprc_score: 0.8771; val_best_acc_score: 0.8520; val_best_f1_score: 0.8620; train_kl_reg_loss: 93614.9802; train_edge_recon_loss: 2770875.6061; train_gene_expr_recon_loss: 11982146.5909; train_masked_gp_l1_reg_loss: 102642.2624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66555.1927; train_chrom_access_recon_loss: 6218223.8258; train_global_loss: 21234058.4848; train_optim_loss: 21234058.4848; val_kl_reg_loss: 91434.1475; val_edge_recon_loss: 2826274.1250; val_gene_expr_recon_loss: 11914047.7500; val_masked_gp_l1_reg_loss: 103181.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66058.1094; val_chrom_access_recon_loss: 6273334.1875; val_global_loss: 21274329.5000; val_optim_loss: 21274329.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9317; val_auprc_score: 0.9052; val_best_acc_score: 0.8670; val_best_f1_score: 0.8758; train_kl_reg_loss: 92836.6694; train_edge_recon_loss: 2763495.1326; train_gene_expr_recon_loss: 11955026.6061; train_masked_gp_l1_reg_loss: 103430.0606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65369.7640; train_chrom_access_recon_loss: 6206885.1818; train_global_loss: 21187043.4545; train_optim_loss: 21187043.4545; val_kl_reg_loss: 90802.2070; val_edge_recon_loss: 2772192.6250; val_gene_expr_recon_loss: 11868601.7500; val_masked_gp_l1_reg_loss: 103647.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64935.2617; val_chrom_access_recon_loss: 6177092.3750; val_global_loss: 21077271.5000; val_optim_loss: 21077271.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9247; val_auprc_score: 0.8866; val_best_acc_score: 0.8700; val_best_f1_score: 0.8772; train_kl_reg_loss: 93025.5290; train_edge_recon_loss: 2745405.3258; train_gene_expr_recon_loss: 11933486.6970; train_masked_gp_l1_reg_loss: 104163.3724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64649.5165; train_chrom_access_recon_loss: 6192356.9470; train_global_loss: 21133087.3636; train_optim_loss: 21133087.3636; val_kl_reg_loss: 92777.7539; val_edge_recon_loss: 2785752.5312; val_gene_expr_recon_loss: 11849284.2500; val_masked_gp_l1_reg_loss: 104436.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64196.0664; val_chrom_access_recon_loss: 6196202.5625; val_global_loss: 21092649.0000; val_optim_loss: 21092649.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9192; val_auprc_score: 0.8851; val_best_acc_score: 0.8643; val_best_f1_score: 0.8727; train_kl_reg_loss: 90599.5543; train_edge_recon_loss: 2743616.7159; train_gene_expr_recon_loss: 11905331.0909; train_masked_gp_l1_reg_loss: 104707.4388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63897.0021; train_chrom_access_recon_loss: 6181311.2273; train_global_loss: 21089462.9697; train_optim_loss: 21089462.9697; val_kl_reg_loss: 91894.7832; val_edge_recon_loss: 2783906.0938; val_gene_expr_recon_loss: 11863040.6250; val_masked_gp_l1_reg_loss: 105319.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64161.5117; val_chrom_access_recon_loss: 6222613.3750; val_global_loss: 21130937.2500; val_optim_loss: 21130937.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9306; val_auprc_score: 0.9050; val_best_acc_score: 0.8670; val_best_f1_score: 0.8734; train_kl_reg_loss: 90279.6315; train_edge_recon_loss: 2749532.1364; train_gene_expr_recon_loss: 11863836.8788; train_masked_gp_l1_reg_loss: 105512.1912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63539.9647; train_chrom_access_recon_loss: 6154586.4167; train_global_loss: 21027287.2424; train_optim_loss: 21027287.2424; val_kl_reg_loss: 92821.7842; val_edge_recon_loss: 2738691.5938; val_gene_expr_recon_loss: 11788930.1250; val_masked_gp_l1_reg_loss: 105693.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63077.8281; val_chrom_access_recon_loss: 6233954.8750; val_global_loss: 21023169.7500; val_optim_loss: 21023169.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9271; val_auprc_score: 0.8958; val_best_acc_score: 0.8665; val_best_f1_score: 0.8735; train_kl_reg_loss: 89448.1188; train_edge_recon_loss: 2744497.1629; train_gene_expr_recon_loss: 11839086.7424; train_masked_gp_l1_reg_loss: 105965.1860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63005.3171; train_chrom_access_recon_loss: 6143038.4470; train_global_loss: 20985041.0000; train_optim_loss: 20985041.0000; val_kl_reg_loss: 89618.7344; val_edge_recon_loss: 2777415.1562; val_gene_expr_recon_loss: 11778983.6250; val_masked_gp_l1_reg_loss: 106117.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62643.0000; val_chrom_access_recon_loss: 6146631.3125; val_global_loss: 20961410.0000; val_optim_loss: 20961410.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9357; val_auprc_score: 0.9066; val_best_acc_score: 0.8769; val_best_f1_score: 0.8815; train_kl_reg_loss: 87578.0791; train_edge_recon_loss: 2739569.0833; train_gene_expr_recon_loss: 11808943.9242; train_masked_gp_l1_reg_loss: 106459.5861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62483.2277; train_chrom_access_recon_loss: 6120080.5303; train_global_loss: 20925114.3333; train_optim_loss: 20925114.3333; val_kl_reg_loss: 89687.9502; val_edge_recon_loss: 2729664.9688; val_gene_expr_recon_loss: 11859078.7500; val_masked_gp_l1_reg_loss: 106725.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62500.0195; val_chrom_access_recon_loss: 6239365.6250; val_global_loss: 21087022.7500; val_optim_loss: 21087022.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9226; val_auprc_score: 0.8881; val_best_acc_score: 0.8568; val_best_f1_score: 0.8676; train_kl_reg_loss: 87062.9755; train_edge_recon_loss: 2753277.2576; train_gene_expr_recon_loss: 11783555.2424; train_masked_gp_l1_reg_loss: 106694.5130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62129.6712; train_chrom_access_recon_loss: 6109272.4470; train_global_loss: 20901992.1515; train_optim_loss: 20901992.1515; val_kl_reg_loss: 89593.6973; val_edge_recon_loss: 2806638.1250; val_gene_expr_recon_loss: 11816303.1250; val_masked_gp_l1_reg_loss: 106997.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62156.3281; val_chrom_access_recon_loss: 6243749.4375; val_global_loss: 21125438.5000; val_optim_loss: 21125438.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9388; val_auprc_score: 0.9142; val_best_acc_score: 0.8735; val_best_f1_score: 0.8800; train_kl_reg_loss: 87618.7868; train_edge_recon_loss: 2731897.5265; train_gene_expr_recon_loss: 11769060.2121; train_masked_gp_l1_reg_loss: 107204.5123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61828.5925; train_chrom_access_recon_loss: 6100723.6212; train_global_loss: 20858333.3333; train_optim_loss: 20858333.3333; val_kl_reg_loss: 89686.0420; val_edge_recon_loss: 2765583.9375; val_gene_expr_recon_loss: 11697018.3750; val_masked_gp_l1_reg_loss: 107500.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61840.4570; val_chrom_access_recon_loss: 6182210.0000; val_global_loss: 20903838.2500; val_optim_loss: 20903838.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9392; val_auprc_score: 0.9144; val_best_acc_score: 0.8769; val_best_f1_score: 0.8809; train_kl_reg_loss: 86544.7792; train_edge_recon_loss: 2730108.1023; train_gene_expr_recon_loss: 11743550.3182; train_masked_gp_l1_reg_loss: 107633.5291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61433.8044; train_chrom_access_recon_loss: 6084944.8182; train_global_loss: 20814215.2121; train_optim_loss: 20814215.2121; val_kl_reg_loss: 88976.1025; val_edge_recon_loss: 2747392.1562; val_gene_expr_recon_loss: 11706939.3750; val_masked_gp_l1_reg_loss: 107869.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61118.1641; val_chrom_access_recon_loss: 6083209.1250; val_global_loss: 20795504.5000; val_optim_loss: 20795504.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9416; val_auprc_score: 0.9139; val_best_acc_score: 0.8880; val_best_f1_score: 0.8932; train_kl_reg_loss: 86040.0234; train_edge_recon_loss: 2710958.5682; train_gene_expr_recon_loss: 11717467.4091; train_masked_gp_l1_reg_loss: 108064.3239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60977.5288; train_chrom_access_recon_loss: 6067145.6894; train_global_loss: 20750653.6364; train_optim_loss: 20750653.6364; val_kl_reg_loss: 86512.8418; val_edge_recon_loss: 2731002.5625; val_gene_expr_recon_loss: 11658977.0000; val_masked_gp_l1_reg_loss: 108192.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60763.5312; val_chrom_access_recon_loss: 6129247.2500; val_global_loss: 20774695.5000; val_optim_loss: 20774695.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9371; val_auprc_score: 0.9194; val_best_acc_score: 0.8783; val_best_f1_score: 0.8828; train_kl_reg_loss: 109656.3522; train_edge_recon_loss: 2817009.0644; train_gene_expr_recon_loss: 11073262.6970; train_masked_gp_l1_reg_loss: 108743.0039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59173.6204; train_chrom_access_recon_loss: 5828442.0758; train_global_loss: 19996286.5455; train_optim_loss: 19996286.5455; val_kl_reg_loss: 42660.9170; val_edge_recon_loss: 2822808.2188; val_gene_expr_recon_loss: 11091008.8750; val_masked_gp_l1_reg_loss: 108770.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58881.5938; val_chrom_access_recon_loss: 5867073.5000; val_global_loss: 19991204.5000; val_optim_loss: 19991204.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9418; val_auprc_score: 0.9202; val_best_acc_score: 0.8818; val_best_f1_score: 0.8857; train_kl_reg_loss: 90456.4770; train_edge_recon_loss: 2749005.3523; train_gene_expr_recon_loss: 11025851.1061; train_masked_gp_l1_reg_loss: 108316.1783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58882.9589; train_chrom_access_recon_loss: 5764731.2348; train_global_loss: 19797243.3030; train_optim_loss: 19797243.3030; val_kl_reg_loss: 49758.8218; val_edge_recon_loss: 2755797.9062; val_gene_expr_recon_loss: 10927568.0000; val_masked_gp_l1_reg_loss: 107910.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58933.0820; val_chrom_access_recon_loss: 5782056.0000; val_global_loss: 19682023.7500; val_optim_loss: 19682023.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9377; val_auprc_score: 0.9070; val_best_acc_score: 0.8786; val_best_f1_score: 0.8822; train_kl_reg_loss: 79517.8827; train_edge_recon_loss: 2724108.3144; train_gene_expr_recon_loss: 10999396.6667; train_masked_gp_l1_reg_loss: 107499.9719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58642.9917; train_chrom_access_recon_loss: 5752548.8182; train_global_loss: 19721714.4242; train_optim_loss: 19721714.4242; val_kl_reg_loss: 56740.9023; val_edge_recon_loss: 2789232.7500; val_gene_expr_recon_loss: 10968908.1250; val_masked_gp_l1_reg_loss: 107111.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58316.0117; val_chrom_access_recon_loss: 5842004.4375; val_global_loss: 19822314.2500; val_optim_loss: 19822314.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9359; val_auprc_score: 0.9078; val_best_acc_score: 0.8815; val_best_f1_score: 0.8860; train_kl_reg_loss: 73796.1398; train_edge_recon_loss: 2726534.5530; train_gene_expr_recon_loss: 10986038.7727; train_masked_gp_l1_reg_loss: 106675.5650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58167.5324; train_chrom_access_recon_loss: 5740434.4318; train_global_loss: 19691647.0303; train_optim_loss: 19691647.0303; val_kl_reg_loss: 61452.1689; val_edge_recon_loss: 2740932.5938; val_gene_expr_recon_loss: 10912475.2500; val_masked_gp_l1_reg_loss: 106256.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57772.2578; val_chrom_access_recon_loss: 5793437.8750; val_global_loss: 19672326.7500; val_optim_loss: 19672326.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9468; val_auprc_score: 0.9281; val_best_acc_score: 0.8877; val_best_f1_score: 0.8922; train_kl_reg_loss: 71762.2723; train_edge_recon_loss: 2713887.4962; train_gene_expr_recon_loss: 10959280.4848; train_masked_gp_l1_reg_loss: 105886.7495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57694.6643; train_chrom_access_recon_loss: 5728476.0303; train_global_loss: 19636987.7273; train_optim_loss: 19636987.7273; val_kl_reg_loss: 58582.7256; val_edge_recon_loss: 2739977.5000; val_gene_expr_recon_loss: 11076699.5000; val_masked_gp_l1_reg_loss: 105377.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57525.2109; val_chrom_access_recon_loss: 5849048.8750; val_global_loss: 19887211.7500; val_optim_loss: 19887211.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9430; val_auprc_score: 0.9183; val_best_acc_score: 0.8823; val_best_f1_score: 0.8871; train_kl_reg_loss: 70885.2448; train_edge_recon_loss: 2717230.1553; train_gene_expr_recon_loss: 10952484.3636; train_masked_gp_l1_reg_loss: 105053.6220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57309.2057; train_chrom_access_recon_loss: 5722488.9773; train_global_loss: 19625451.6061; train_optim_loss: 19625451.6061; val_kl_reg_loss: 61135.1655; val_edge_recon_loss: 2762029.5938; val_gene_expr_recon_loss: 10993527.1250; val_masked_gp_l1_reg_loss: 104741.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57273.1953; val_chrom_access_recon_loss: 5811815.0000; val_global_loss: 19790520.5000; val_optim_loss: 19790520.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9491; val_auprc_score: 0.9289; val_best_acc_score: 0.8869; val_best_f1_score: 0.8922; train_kl_reg_loss: 70186.1850; train_edge_recon_loss: 2716453.8826; train_gene_expr_recon_loss: 10934992.8030; train_masked_gp_l1_reg_loss: 104278.5402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56989.1298; train_chrom_access_recon_loss: 5715928.7955; train_global_loss: 19598829.5152; train_optim_loss: 19598829.5152; val_kl_reg_loss: 61445.2856; val_edge_recon_loss: 2732680.6562; val_gene_expr_recon_loss: 10863169.5000; val_masked_gp_l1_reg_loss: 104116.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56766.7734; val_chrom_access_recon_loss: 5773828.3125; val_global_loss: 19592008.2500; val_optim_loss: 19592008.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9492; val_auprc_score: 0.9294; val_best_acc_score: 0.8936; val_best_f1_score: 0.8960; train_kl_reg_loss: 67972.8693; train_edge_recon_loss: 2699379.1250; train_gene_expr_recon_loss: 10925863.3939; train_masked_gp_l1_reg_loss: 103806.3191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56941.8060; train_chrom_access_recon_loss: 5712179.8788; train_global_loss: 19566143.3939; train_optim_loss: 19566143.3939; val_kl_reg_loss: 63635.7725; val_edge_recon_loss: 2735690.0312; val_gene_expr_recon_loss: 10913154.3750; val_masked_gp_l1_reg_loss: 103431.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56714.4180; val_chrom_access_recon_loss: 5733084.6250; val_global_loss: 19605710.2500; val_optim_loss: 19605710.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9437; val_auprc_score: 0.9236; val_best_acc_score: 0.8858; val_best_f1_score: 0.8912; train_kl_reg_loss: 68868.6850; train_edge_recon_loss: 2704570.7197; train_gene_expr_recon_loss: 10912280.8636; train_masked_gp_l1_reg_loss: 103171.3021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56314.6681; train_chrom_access_recon_loss: 5700422.3106; train_global_loss: 19545628.5152; train_optim_loss: 19545628.5152; val_kl_reg_loss: 64174.0122; val_edge_recon_loss: 2749080.1875; val_gene_expr_recon_loss: 10916776.8750; val_masked_gp_l1_reg_loss: 102923.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56123.5000; val_chrom_access_recon_loss: 5781114.2500; val_global_loss: 19670191.7500; val_optim_loss: 19670191.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9468; val_auprc_score: 0.9322; val_best_acc_score: 0.8874; val_best_f1_score: 0.8920; train_kl_reg_loss: 67687.6845; train_edge_recon_loss: 2692022.7197; train_gene_expr_recon_loss: 10891129.1970; train_masked_gp_l1_reg_loss: 102680.2726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55773.7548; train_chrom_access_recon_loss: 5684684.5530; train_global_loss: 19493978.0909; train_optim_loss: 19493978.0909; val_kl_reg_loss: 63155.6465; val_edge_recon_loss: 2751059.7500; val_gene_expr_recon_loss: 10797004.2500; val_masked_gp_l1_reg_loss: 102422.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55638.4688; val_chrom_access_recon_loss: 5727865.8125; val_global_loss: 19497146.7500; val_optim_loss: 19497146.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9495; val_auprc_score: 0.9268; val_best_acc_score: 0.8931; val_best_f1_score: 0.8978; train_kl_reg_loss: 67714.6493; train_edge_recon_loss: 2693204.1932; train_gene_expr_recon_loss: 10884247.8030; train_masked_gp_l1_reg_loss: 102260.0821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55328.5312; train_chrom_access_recon_loss: 5692986.1970; train_global_loss: 19495741.4848; train_optim_loss: 19495741.4848; val_kl_reg_loss: 66436.5088; val_edge_recon_loss: 2710528.8125; val_gene_expr_recon_loss: 10833478.2500; val_masked_gp_l1_reg_loss: 102072.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55163.6641; val_chrom_access_recon_loss: 5722944.5625; val_global_loss: 19490624.0000; val_optim_loss: 19490624.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9514; val_auprc_score: 0.9266; val_best_acc_score: 0.8992; val_best_f1_score: 0.9035; train_kl_reg_loss: 68182.0756; train_edge_recon_loss: 2691014.7992; train_gene_expr_recon_loss: 10870231.5303; train_masked_gp_l1_reg_loss: 101744.4382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55007.3423; train_chrom_access_recon_loss: 5682124.1742; train_global_loss: 19468304.4242; train_optim_loss: 19468304.4242; val_kl_reg_loss: 65717.5957; val_edge_recon_loss: 2705209.1562; val_gene_expr_recon_loss: 10806651.7500; val_masked_gp_l1_reg_loss: 101501.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55014.7031; val_chrom_access_recon_loss: 5768245.6875; val_global_loss: 19502340.5000; val_optim_loss: 19502340.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9553; val_auprc_score: 0.9382; val_best_acc_score: 0.9017; val_best_f1_score: 0.9062; train_kl_reg_loss: 67575.4242; train_edge_recon_loss: 2686792.1174; train_gene_expr_recon_loss: 10856777.6515; train_masked_gp_l1_reg_loss: 101291.1048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54766.6800; train_chrom_access_recon_loss: 5670839.0076; train_global_loss: 19438041.9697; train_optim_loss: 19438041.9697; val_kl_reg_loss: 65526.2441; val_edge_recon_loss: 2691721.1562; val_gene_expr_recon_loss: 10841134.0000; val_masked_gp_l1_reg_loss: 101293.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54753.0703; val_chrom_access_recon_loss: 5711647.6875; val_global_loss: 19466074.7500; val_optim_loss: 19466074.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9461; val_auprc_score: 0.9271; val_best_acc_score: 0.8877; val_best_f1_score: 0.8933; train_kl_reg_loss: 68785.0716; train_edge_recon_loss: 2688811.8788; train_gene_expr_recon_loss: 10846218.4848; train_masked_gp_l1_reg_loss: 100943.9432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54600.7943; train_chrom_access_recon_loss: 5664365.9394; train_global_loss: 19423726.1515; train_optim_loss: 19423726.1515; val_kl_reg_loss: 65105.4053; val_edge_recon_loss: 2756731.1875; val_gene_expr_recon_loss: 10832143.1250; val_masked_gp_l1_reg_loss: 100752.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54606.6602; val_chrom_access_recon_loss: 5706751.4375; val_global_loss: 19516091.5000; val_optim_loss: 19516091.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9565; val_auprc_score: 0.9413; val_best_acc_score: 0.9019; val_best_f1_score: 0.9051; train_kl_reg_loss: 67257.3084; train_edge_recon_loss: 2689736.4394; train_gene_expr_recon_loss: 10835750.6515; train_masked_gp_l1_reg_loss: 100485.0009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54541.1411; train_chrom_access_recon_loss: 5660879.1439; train_global_loss: 19408649.6667; train_optim_loss: 19408649.6667; val_kl_reg_loss: 65822.6616; val_edge_recon_loss: 2705482.0625; val_gene_expr_recon_loss: 10884731.6250; val_masked_gp_l1_reg_loss: 100284.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54474.8555; val_chrom_access_recon_loss: 5722347.3125; val_global_loss: 19533142.7500; val_optim_loss: 19533142.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9578; val_auprc_score: 0.9452; val_best_acc_score: 0.8987; val_best_f1_score: 0.9044; train_kl_reg_loss: 66446.0285; train_edge_recon_loss: 2692794.2462; train_gene_expr_recon_loss: 10818628.1212; train_masked_gp_l1_reg_loss: 100145.3239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54537.2830; train_chrom_access_recon_loss: 5652467.1288; train_global_loss: 19385018.1515; train_optim_loss: 19385018.1515; val_kl_reg_loss: 64565.1958; val_edge_recon_loss: 2705136.5000; val_gene_expr_recon_loss: 10821813.3750; val_masked_gp_l1_reg_loss: 100061.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54498.6641; val_chrom_access_recon_loss: 5729859.1250; val_global_loss: 19475934.2500; val_optim_loss: 19475934.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9504; val_auprc_score: 0.9270; val_best_acc_score: 0.9006; val_best_f1_score: 0.9050; train_kl_reg_loss: 65764.8868; train_edge_recon_loss: 2688727.7689; train_gene_expr_recon_loss: 10808198.2576; train_masked_gp_l1_reg_loss: 99885.2261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54411.6793; train_chrom_access_recon_loss: 5648107.9773; train_global_loss: 19365095.6667; train_optim_loss: 19365095.6667; val_kl_reg_loss: 65023.1572; val_edge_recon_loss: 2726902.2500; val_gene_expr_recon_loss: 10718529.5000; val_masked_gp_l1_reg_loss: 99836.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54525.6992; val_chrom_access_recon_loss: 5661681.8750; val_global_loss: 19326498.7500; val_optim_loss: 19326498.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9540; val_auprc_score: 0.9336; val_best_acc_score: 0.9044; val_best_f1_score: 0.9089; train_kl_reg_loss: 66349.2520; train_edge_recon_loss: 2687784.5038; train_gene_expr_recon_loss: 10801444.8485; train_masked_gp_l1_reg_loss: 99637.6825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54314.0036; train_chrom_access_recon_loss: 5642132.3030; train_global_loss: 19351662.7879; train_optim_loss: 19351662.7879; val_kl_reg_loss: 65174.6714; val_edge_recon_loss: 2704636.8438; val_gene_expr_recon_loss: 10756097.0000; val_masked_gp_l1_reg_loss: 99492.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54359.9609; val_chrom_access_recon_loss: 5731447.3125; val_global_loss: 19411208.7500; val_optim_loss: 19411208.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9548; val_auprc_score: 0.9320; val_best_acc_score: 0.9017; val_best_f1_score: 0.9061; train_kl_reg_loss: 66384.3865; train_edge_recon_loss: 2681700.4545; train_gene_expr_recon_loss: 10796033.8182; train_masked_gp_l1_reg_loss: 99441.6587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54352.6394; train_chrom_access_recon_loss: 5641570.1894; train_global_loss: 19339483.2424; train_optim_loss: 19339483.2424; val_kl_reg_loss: 64092.2749; val_edge_recon_loss: 2711188.5312; val_gene_expr_recon_loss: 10762585.5000; val_masked_gp_l1_reg_loss: 99274.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54447.9062; val_chrom_access_recon_loss: 5671557.5625; val_global_loss: 19363146.0000; val_optim_loss: 19363146.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9536; val_auprc_score: 0.9343; val_best_acc_score: 0.9030; val_best_f1_score: 0.9070; train_kl_reg_loss: 66496.0390; train_edge_recon_loss: 2692997.4886; train_gene_expr_recon_loss: 10789526.2121; train_masked_gp_l1_reg_loss: 99174.3262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54322.9206; train_chrom_access_recon_loss: 5635874.2121; train_global_loss: 19338391.3333; train_optim_loss: 19338391.3333; val_kl_reg_loss: 64532.7300; val_edge_recon_loss: 2729443.8750; val_gene_expr_recon_loss: 10797028.0000; val_masked_gp_l1_reg_loss: 99190.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54318.6094; val_chrom_access_recon_loss: 5703208.6250; val_global_loss: 19447723.0000; val_optim_loss: 19447723.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9563; val_auprc_score: 0.9361; val_best_acc_score: 0.9062; val_best_f1_score: 0.9108; train_kl_reg_loss: 65219.2650; train_edge_recon_loss: 2685979.2424; train_gene_expr_recon_loss: 10775582.0455; train_masked_gp_l1_reg_loss: 99130.3981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54327.5794; train_chrom_access_recon_loss: 5625057.8106; train_global_loss: 19305296.3636; train_optim_loss: 19305296.3636; val_kl_reg_loss: 66632.1587; val_edge_recon_loss: 2698819.6250; val_gene_expr_recon_loss: 10763326.2500; val_masked_gp_l1_reg_loss: 99049.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54198.3398; val_chrom_access_recon_loss: 5705402.8750; val_global_loss: 19387429.0000; val_optim_loss: 19387429.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9563; val_auprc_score: 0.9387; val_best_acc_score: 0.9027; val_best_f1_score: 0.9065; train_kl_reg_loss: 67495.1870; train_edge_recon_loss: 2678999.5795; train_gene_expr_recon_loss: 10747843.5455; train_masked_gp_l1_reg_loss: 97281.6031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46659.1713; train_chrom_access_recon_loss: 5619551.4848; train_global_loss: 19257830.7273; train_optim_loss: 19257830.7273; val_kl_reg_loss: 66021.5474; val_edge_recon_loss: 2711794.4375; val_gene_expr_recon_loss: 10771183.8750; val_masked_gp_l1_reg_loss: 96687.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45110.2695; val_chrom_access_recon_loss: 5689868.4375; val_global_loss: 19380665.0000; val_optim_loss: 19380665.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9593; val_auprc_score: 0.9428; val_best_acc_score: 0.9041; val_best_f1_score: 0.9084; train_kl_reg_loss: 67565.4753; train_edge_recon_loss: 2681662.8068; train_gene_expr_recon_loss: 10743355.8939; train_masked_gp_l1_reg_loss: 96563.2047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44886.7447; train_chrom_access_recon_loss: 5617553.0455; train_global_loss: 19251587.0000; train_optim_loss: 19251587.0000; val_kl_reg_loss: 66307.6943; val_edge_recon_loss: 2709916.7812; val_gene_expr_recon_loss: 10731319.6250; val_masked_gp_l1_reg_loss: 96517.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44741.0977; val_chrom_access_recon_loss: 5693045.8750; val_global_loss: 19341847.5000; val_optim_loss: 19341847.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9586; val_auprc_score: 0.9463; val_best_acc_score: 0.9038; val_best_f1_score: 0.9065; train_kl_reg_loss: 67732.2989; train_edge_recon_loss: 2685427.4697; train_gene_expr_recon_loss: 10735217.5606; train_masked_gp_l1_reg_loss: 96473.3802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44605.3714; train_chrom_access_recon_loss: 5611715.0530; train_global_loss: 19241170.9394; train_optim_loss: 19241170.9394; val_kl_reg_loss: 65525.0337; val_edge_recon_loss: 2694942.9062; val_gene_expr_recon_loss: 10649562.2500; val_masked_gp_l1_reg_loss: 96450.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44498.2070; val_chrom_access_recon_loss: 5676693.5625; val_global_loss: 19227672.2500; val_optim_loss: 19227672.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9593; val_auprc_score: 0.9406; val_best_acc_score: 0.9108; val_best_f1_score: 0.9137; train_kl_reg_loss: 67078.2227; train_edge_recon_loss: 2679150.2121; train_gene_expr_recon_loss: 10732587.8333; train_masked_gp_l1_reg_loss: 96435.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44440.5198; train_chrom_access_recon_loss: 5608387.5379; train_global_loss: 19228080.2424; train_optim_loss: 19228080.2424; val_kl_reg_loss: 65116.7754; val_edge_recon_loss: 2699041.2188; val_gene_expr_recon_loss: 10776900.0000; val_masked_gp_l1_reg_loss: 96418.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44378.4180; val_chrom_access_recon_loss: 5667938.3125; val_global_loss: 19349792.2500; val_optim_loss: 19349792.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9598; val_auprc_score: 0.9470; val_best_acc_score: 0.9049; val_best_f1_score: 0.9091; train_kl_reg_loss: 67924.7399; train_edge_recon_loss: 2680654.2538; train_gene_expr_recon_loss: 10739077.1515; train_masked_gp_l1_reg_loss: 96387.5885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44283.1469; train_chrom_access_recon_loss: 5610667.3106; train_global_loss: 19238994.1818; train_optim_loss: 19238994.1818; val_kl_reg_loss: 66912.0425; val_edge_recon_loss: 2697971.2812; val_gene_expr_recon_loss: 10773359.5000; val_masked_gp_l1_reg_loss: 96366.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44207.8555; val_chrom_access_recon_loss: 5706486.6875; val_global_loss: 19385303.5000; val_optim_loss: 19385303.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9532; val_auprc_score: 0.9358; val_best_acc_score: 0.8995; val_best_f1_score: 0.9050; train_kl_reg_loss: 68437.1489; train_edge_recon_loss: 2678612.9773; train_gene_expr_recon_loss: 10737895.1818; train_masked_gp_l1_reg_loss: 96337.3053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44118.6116; train_chrom_access_recon_loss: 5614513.6970; train_global_loss: 19239914.8485; train_optim_loss: 19239914.8485; val_kl_reg_loss: 66201.3184; val_edge_recon_loss: 2734749.0000; val_gene_expr_recon_loss: 10638159.5000; val_masked_gp_l1_reg_loss: 96320.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44037.6055; val_chrom_access_recon_loss: 5586568.1250; val_global_loss: 19166036.7500; val_optim_loss: 19166036.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9552; val_auprc_score: 0.9396; val_best_acc_score: 0.8998; val_best_f1_score: 0.9037; train_kl_reg_loss: 68889.5754; train_edge_recon_loss: 2674369.8939; train_gene_expr_recon_loss: 10742310.3939; train_masked_gp_l1_reg_loss: 96308.7640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43977.0616; train_chrom_access_recon_loss: 5616516.3106; train_global_loss: 19242371.9091; train_optim_loss: 19242371.9091; val_kl_reg_loss: 67165.6641; val_edge_recon_loss: 2715207.6562; val_gene_expr_recon_loss: 10788387.1250; val_masked_gp_l1_reg_loss: 96293.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43905.3555; val_chrom_access_recon_loss: 5675858.9375; val_global_loss: 19386818.5000; val_optim_loss: 19386818.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9591; val_auprc_score: 0.9416; val_best_acc_score: 0.9065; val_best_f1_score: 0.9105; train_kl_reg_loss: 68831.2828; train_edge_recon_loss: 2684912.0530; train_gene_expr_recon_loss: 10733933.5909; train_masked_gp_l1_reg_loss: 96282.1785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43837.0518; train_chrom_access_recon_loss: 5610299.0000; train_global_loss: 19238095.1212; train_optim_loss: 19238095.1212; val_kl_reg_loss: 66908.6787; val_edge_recon_loss: 2694434.0625; val_gene_expr_recon_loss: 10782903.7500; val_masked_gp_l1_reg_loss: 96265.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43789.3711; val_chrom_access_recon_loss: 5743103.4375; val_global_loss: 19427404.5000; val_optim_loss: 19427404.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9611; val_auprc_score: 0.9450; val_best_acc_score: 0.9078; val_best_f1_score: 0.9118; train_kl_reg_loss: 68545.5107; train_edge_recon_loss: 2679562.8030; train_gene_expr_recon_loss: 10724625.4242; train_masked_gp_l1_reg_loss: 96263.3058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43738.6684; train_chrom_access_recon_loss: 5604438.7197; train_global_loss: 19217174.5152; train_optim_loss: 19217174.5152; val_kl_reg_loss: 67429.1504; val_edge_recon_loss: 2704163.3750; val_gene_expr_recon_loss: 10673475.7500; val_masked_gp_l1_reg_loss: 96247.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43698.8281; val_chrom_access_recon_loss: 5664061.6250; val_global_loss: 19249077.0000; val_optim_loss: 19249077.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9525; val_auprc_score: 0.9332; val_best_acc_score: 0.9011; val_best_f1_score: 0.9059; train_kl_reg_loss: 68867.3041; train_edge_recon_loss: 2680071.8485; train_gene_expr_recon_loss: 10729974.0909; train_masked_gp_l1_reg_loss: 96225.3754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43611.2050; train_chrom_access_recon_loss: 5606627.9848; train_global_loss: 19225377.9697; train_optim_loss: 19225377.9697; val_kl_reg_loss: 66809.7012; val_edge_recon_loss: 2708246.0000; val_gene_expr_recon_loss: 10688727.2500; val_masked_gp_l1_reg_loss: 96198.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43554.4570; val_chrom_access_recon_loss: 5644379.0625; val_global_loss: 19247914.0000; val_optim_loss: 19247914.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9596; val_auprc_score: 0.9436; val_best_acc_score: 0.9076; val_best_f1_score: 0.9121; train_kl_reg_loss: 68436.0536; train_edge_recon_loss: 2688171.1856; train_gene_expr_recon_loss: 10720424.1212; train_masked_gp_l1_reg_loss: 96021.2685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42758.7657; train_chrom_access_recon_loss: 5599410.2121; train_global_loss: 19215221.6364; train_optim_loss: 19215221.6364; val_kl_reg_loss: 67230.7969; val_edge_recon_loss: 2694283.6250; val_gene_expr_recon_loss: 10812100.7500; val_masked_gp_l1_reg_loss: 95955.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42597.6094; val_chrom_access_recon_loss: 5681409.8125; val_global_loss: 19393577.7500; val_optim_loss: 19393577.7500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9563; val_auprc_score: 0.9395; val_best_acc_score: 0.9044; val_best_f1_score: 0.9083; train_kl_reg_loss: 68723.6932; train_edge_recon_loss: 2677987.2841; train_gene_expr_recon_loss: 10726923.5909; train_masked_gp_l1_reg_loss: 95936.3801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42579.9337; train_chrom_access_recon_loss: 5607358.3788; train_global_loss: 19219509.3030; train_optim_loss: 19219509.3030; val_kl_reg_loss: 67045.5439; val_edge_recon_loss: 2718341.2188; val_gene_expr_recon_loss: 10736336.0000; val_masked_gp_l1_reg_loss: 95923.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42562.0898; val_chrom_access_recon_loss: 5643838.1250; val_global_loss: 19304045.7500; val_optim_loss: 19304045.7500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9538; val_auprc_score: 0.9307; val_best_acc_score: 0.9035; val_best_f1_score: 0.9081; train_kl_reg_loss: 68732.4424; train_edge_recon_loss: 2677601.6553; train_gene_expr_recon_loss: 10733899.5606; train_masked_gp_l1_reg_loss: 95917.7318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42546.6079; train_chrom_access_recon_loss: 5610575.2045; train_global_loss: 19229273.0000; train_optim_loss: 19229273.0000; val_kl_reg_loss: 67129.1611; val_edge_recon_loss: 2731500.7812; val_gene_expr_recon_loss: 10647865.0000; val_masked_gp_l1_reg_loss: 95909.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42529.9531; val_chrom_access_recon_loss: 5637490.6250; val_global_loss: 19222425.7500; val_optim_loss: 19222425.7500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9598; val_auprc_score: 0.9464; val_best_acc_score: 0.9070; val_best_f1_score: 0.9104; train_kl_reg_loss: 68590.4068; train_edge_recon_loss: 2679534.9205; train_gene_expr_recon_loss: 10724786.7424; train_masked_gp_l1_reg_loss: 95905.1721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42523.5007; train_chrom_access_recon_loss: 5606518.1364; train_global_loss: 19217858.8788; train_optim_loss: 19217858.8788; val_kl_reg_loss: 66986.0586; val_edge_recon_loss: 2715752.6875; val_gene_expr_recon_loss: 10713570.0000; val_masked_gp_l1_reg_loss: 95901.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42511.5508; val_chrom_access_recon_loss: 5627780.5625; val_global_loss: 19262502.5000; val_optim_loss: 19262502.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 3 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9556
val AUPRC score: 0.9344
val best accuracy score: 0.8998
val best F1 score: 0.9029
val target rna MSE score: 1.7294
val source rna MSE score: 0.8662
val target atac MSE score: 0.3263
val source atac MSE score: 0.1384
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
