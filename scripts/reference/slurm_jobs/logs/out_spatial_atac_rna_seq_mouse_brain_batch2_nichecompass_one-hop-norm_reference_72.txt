[True]
Run timestamp: 07082023_193523_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8910; val_auprc_score: 0.9088; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31464.8962; train_edge_recon_loss: 352609.2014; train_gene_expr_recon_loss: 1329841.5139; train_masked_gp_l1_reg_loss: 16387.6663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167024.4896; train_chrom_access_recon_loss: 2719481.1250; train_global_loss: 4616808.8611; train_optim_loss: 4616808.8611; val_kl_reg_loss: 12008.4102; val_edge_recon_loss: 406575.4688; val_gene_expr_recon_loss: 1085700.0000; val_masked_gp_l1_reg_loss: 12143.8779; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162590.6094; val_chrom_access_recon_loss: 1673948.8750; val_global_loss: 3352967.2500; val_optim_loss: 3352967.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8916; val_auprc_score: 0.9063; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 11343.3024; train_edge_recon_loss: 355143.2465; train_gene_expr_recon_loss: 970055.2847; train_masked_gp_l1_reg_loss: 10677.0790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159792.1701; train_chrom_access_recon_loss: 1516812.9722; train_global_loss: 3023824.1111; train_optim_loss: 3023824.1111; val_kl_reg_loss: 10979.7656; val_edge_recon_loss: 406561.6250; val_gene_expr_recon_loss: 873813.0000; val_masked_gp_l1_reg_loss: 9679.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156427.1250; val_chrom_access_recon_loss: 1411423.0000; val_global_loss: 2868884.5000; val_optim_loss: 2868884.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8905; val_auprc_score: 0.9076; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 13363.4642; train_edge_recon_loss: 356555.3090; train_gene_expr_recon_loss: 837126.0347; train_masked_gp_l1_reg_loss: 9886.3500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153689.9149; train_chrom_access_recon_loss: 1402065.5417; train_global_loss: 2772686.6111; train_optim_loss: 2772686.6111; val_kl_reg_loss: 15253.7383; val_edge_recon_loss: 406571.9062; val_gene_expr_recon_loss: 790125.1250; val_masked_gp_l1_reg_loss: 10079.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150074.2500; val_chrom_access_recon_loss: 1375438.0000; val_global_loss: 2747542.5000; val_optim_loss: 2747542.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8851; val_auprc_score: 0.8989; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 17486.6922; train_edge_recon_loss: 358725.7604; train_gene_expr_recon_loss: 783534.9861; train_masked_gp_l1_reg_loss: 10004.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146798.5660; train_chrom_access_recon_loss: 1382323.3750; train_global_loss: 2698873.4444; train_optim_loss: 2698873.4444; val_kl_reg_loss: 16769.2070; val_edge_recon_loss: 406555.1250; val_gene_expr_recon_loss: 756797.7500; val_masked_gp_l1_reg_loss: 9921.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142469.3125; val_chrom_access_recon_loss: 1351962.5000; val_global_loss: 2684475.2500; val_optim_loss: 2684475.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8732; val_auprc_score: 0.8858; val_best_acc_score: 0.5147; val_best_f1_score: 0.6731; train_kl_reg_loss: 18647.4572; train_edge_recon_loss: 358701.4410; train_gene_expr_recon_loss: 750789.8125; train_masked_gp_l1_reg_loss: 9904.4249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138758.3663; train_chrom_access_recon_loss: 1352942.6389; train_global_loss: 2629744.0833; train_optim_loss: 2629744.0833; val_kl_reg_loss: 19227.7090; val_edge_recon_loss: 406514.3750; val_gene_expr_recon_loss: 733545.1250; val_masked_gp_l1_reg_loss: 9850.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134039.1250; val_chrom_access_recon_loss: 1339367.7500; val_global_loss: 2642544.5000; val_optim_loss: 2642544.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8649; val_auprc_score: 0.8731; val_best_acc_score: 0.5210; val_best_f1_score: 0.6753; train_kl_reg_loss: 20096.1797; train_edge_recon_loss: 360113.6597; train_gene_expr_recon_loss: 729634.2153; train_masked_gp_l1_reg_loss: 9789.4905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130176.9592; train_chrom_access_recon_loss: 1344539.0833; train_global_loss: 2594349.5833; train_optim_loss: 2594349.5833; val_kl_reg_loss: 19880.0625; val_edge_recon_loss: 406418.0938; val_gene_expr_recon_loss: 718848.3750; val_masked_gp_l1_reg_loss: 9690.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125330.2500; val_chrom_access_recon_loss: 1330187.1250; val_global_loss: 2610354.2500; val_optim_loss: 2610354.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8645; val_auprc_score: 0.8725; val_best_acc_score: 0.5330; val_best_f1_score: 0.6789; train_kl_reg_loss: 21234.5056; train_edge_recon_loss: 359770.8264; train_gene_expr_recon_loss: 716057.3125; train_masked_gp_l1_reg_loss: 9630.8963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121491.2005; train_chrom_access_recon_loss: 1337689.0556; train_global_loss: 2565873.7778; train_optim_loss: 2565873.7778; val_kl_reg_loss: 19986.8672; val_edge_recon_loss: 406210.7812; val_gene_expr_recon_loss: 704706.6250; val_masked_gp_l1_reg_loss: 9545.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116725.9219; val_chrom_access_recon_loss: 1322649.3750; val_global_loss: 2579825.0000; val_optim_loss: 2579825.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8539; val_auprc_score: 0.8529; val_best_acc_score: 0.5702; val_best_f1_score: 0.6940; train_kl_reg_loss: 21916.4173; train_edge_recon_loss: 359902.8472; train_gene_expr_recon_loss: 702330.2014; train_masked_gp_l1_reg_loss: 9502.5985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113000.9705; train_chrom_access_recon_loss: 1329810.4028; train_global_loss: 2536463.4444; train_optim_loss: 2536463.4444; val_kl_reg_loss: 21242.0977; val_edge_recon_loss: 405805.8125; val_gene_expr_recon_loss: 692816.3750; val_masked_gp_l1_reg_loss: 9440.0205; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108425.2266; val_chrom_access_recon_loss: 1316593.1250; val_global_loss: 2554322.5000; val_optim_loss: 2554322.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8372; val_auprc_score: 0.8376; val_best_acc_score: 0.6236; val_best_f1_score: 0.7179; train_kl_reg_loss: 23239.4959; train_edge_recon_loss: 359718.5312; train_gene_expr_recon_loss: 688650.3403; train_masked_gp_l1_reg_loss: 9399.9521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104908.0920; train_chrom_access_recon_loss: 1321188.1389; train_global_loss: 2507104.5833; train_optim_loss: 2507104.5833; val_kl_reg_loss: 22392.0859; val_edge_recon_loss: 405245.5938; val_gene_expr_recon_loss: 683397.6250; val_masked_gp_l1_reg_loss: 9347.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100605.5781; val_chrom_access_recon_loss: 1311549.6250; val_global_loss: 2532537.5000; val_optim_loss: 2532537.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8152; val_auprc_score: 0.8152; val_best_acc_score: 0.6746; val_best_f1_score: 0.7400; train_kl_reg_loss: 23299.6174; train_edge_recon_loss: 360038.8785; train_gene_expr_recon_loss: 682365.2639; train_masked_gp_l1_reg_loss: 9319.8830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97339.1884; train_chrom_access_recon_loss: 1316400.3750; train_global_loss: 2488763.1944; train_optim_loss: 2488763.1944; val_kl_reg_loss: 22653.5859; val_edge_recon_loss: 404196.8125; val_gene_expr_recon_loss: 676928.3750; val_masked_gp_l1_reg_loss: 9275.4580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93368.0938; val_chrom_access_recon_loss: 1307718.2500; val_global_loss: 2514140.5000; val_optim_loss: 2514140.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8082; val_auprc_score: 0.8033; val_best_acc_score: 0.7140; val_best_f1_score: 0.7505; train_kl_reg_loss: 23712.2020; train_edge_recon_loss: 359504.0868; train_gene_expr_recon_loss: 674924.7431; train_masked_gp_l1_reg_loss: 9257.1131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90389.7448; train_chrom_access_recon_loss: 1313953.4583; train_global_loss: 2471741.3056; train_optim_loss: 2471741.3056; val_kl_reg_loss: 23474.6289; val_edge_recon_loss: 402750.3438; val_gene_expr_recon_loss: 671469.8750; val_masked_gp_l1_reg_loss: 9235.1201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86784.2266; val_chrom_access_recon_loss: 1303646.5000; val_global_loss: 2497360.7500; val_optim_loss: 2497360.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8058; val_auprc_score: 0.7980; val_best_acc_score: 0.7264; val_best_f1_score: 0.7359; train_kl_reg_loss: 23727.1549; train_edge_recon_loss: 358714.8993; train_gene_expr_recon_loss: 671682.8958; train_masked_gp_l1_reg_loss: 9230.5825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84093.9609; train_chrom_access_recon_loss: 1309275.0556; train_global_loss: 2456724.5833; train_optim_loss: 2456724.5833; val_kl_reg_loss: 23431.1973; val_edge_recon_loss: 400497.7188; val_gene_expr_recon_loss: 667440.5000; val_masked_gp_l1_reg_loss: 9210.1270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80849.0469; val_chrom_access_recon_loss: 1300401.7500; val_global_loss: 2481830.2500; val_optim_loss: 2481830.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7991; val_auprc_score: 0.7864; val_best_acc_score: 0.7086; val_best_f1_score: 0.7471; train_kl_reg_loss: 23688.7016; train_edge_recon_loss: 357963.1111; train_gene_expr_recon_loss: 669531.8819; train_masked_gp_l1_reg_loss: 9205.3301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78432.0547; train_chrom_access_recon_loss: 1312747.2500; train_global_loss: 2451568.3056; train_optim_loss: 2451568.3056; val_kl_reg_loss: 22548.8496; val_edge_recon_loss: 397575.6250; val_gene_expr_recon_loss: 664149.0000; val_masked_gp_l1_reg_loss: 9200.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75508.2812; val_chrom_access_recon_loss: 1297217.0000; val_global_loss: 2466199.5000; val_optim_loss: 2466199.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8107; val_auprc_score: 0.8016; val_best_acc_score: 0.7204; val_best_f1_score: 0.7605; train_kl_reg_loss: 23369.7559; train_edge_recon_loss: 356781.0938; train_gene_expr_recon_loss: 664988.9653; train_masked_gp_l1_reg_loss: 9213.3535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73333.1441; train_chrom_access_recon_loss: 1305500.1250; train_global_loss: 2433186.4444; train_optim_loss: 2433186.4444; val_kl_reg_loss: 21778.9199; val_edge_recon_loss: 393031.4375; val_gene_expr_recon_loss: 662030.3750; val_masked_gp_l1_reg_loss: 9210.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70697.6250; val_chrom_access_recon_loss: 1294752.2500; val_global_loss: 2451501.5000; val_optim_loss: 2451501.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8210; val_auprc_score: 0.8135; val_best_acc_score: 0.7311; val_best_f1_score: 0.7652; train_kl_reg_loss: 23063.0267; train_edge_recon_loss: 355005.6042; train_gene_expr_recon_loss: 665793.7014; train_masked_gp_l1_reg_loss: 9216.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68736.9540; train_chrom_access_recon_loss: 1304557.4861; train_global_loss: 2426373.6944; train_optim_loss: 2426373.6944; val_kl_reg_loss: 21886.5234; val_edge_recon_loss: 386961.1250; val_gene_expr_recon_loss: 659530.4375; val_masked_gp_l1_reg_loss: 9222.7217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66360.9375; val_chrom_access_recon_loss: 1292444.5000; val_global_loss: 2436406.2500; val_optim_loss: 2436406.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8237; val_auprc_score: 0.8111; val_best_acc_score: 0.7371; val_best_f1_score: 0.7661; train_kl_reg_loss: 22700.4466; train_edge_recon_loss: 352629.5799; train_gene_expr_recon_loss: 662899.8403; train_masked_gp_l1_reg_loss: 9242.2394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64593.5838; train_chrom_access_recon_loss: 1304751.0972; train_global_loss: 2416816.8056; train_optim_loss: 2416816.8056; val_kl_reg_loss: 21605.3828; val_edge_recon_loss: 380507.5938; val_gene_expr_recon_loss: 657844.1250; val_masked_gp_l1_reg_loss: 9257.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62443.5859; val_chrom_access_recon_loss: 1289877.8750; val_global_loss: 2421535.7500; val_optim_loss: 2421535.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8301; val_auprc_score: 0.8217; val_best_acc_score: 0.7396; val_best_f1_score: 0.7682; train_kl_reg_loss: 22281.9047; train_edge_recon_loss: 349756.5764; train_gene_expr_recon_loss: 656903.5000; train_masked_gp_l1_reg_loss: 9282.8826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60837.6306; train_chrom_access_recon_loss: 1297208.3056; train_global_loss: 2396270.7778; train_optim_loss: 2396270.7778; val_kl_reg_loss: 21307.7637; val_edge_recon_loss: 371387.7500; val_gene_expr_recon_loss: 657256.7500; val_masked_gp_l1_reg_loss: 9295.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58875.5430; val_chrom_access_recon_loss: 1288111.3750; val_global_loss: 2406234.5000; val_optim_loss: 2406234.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8356; val_auprc_score: 0.8277; val_best_acc_score: 0.7476; val_best_f1_score: 0.7693; train_kl_reg_loss: 22370.8746; train_edge_recon_loss: 346116.1215; train_gene_expr_recon_loss: 658161.5139; train_masked_gp_l1_reg_loss: 9311.0312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57410.0638; train_chrom_access_recon_loss: 1299216.7500; train_global_loss: 2392586.3333; train_optim_loss: 2392586.3333; val_kl_reg_loss: 21544.1523; val_edge_recon_loss: 361486.4062; val_gene_expr_recon_loss: 656262.5000; val_masked_gp_l1_reg_loss: 9325.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55613.6562; val_chrom_access_recon_loss: 1286379.2500; val_global_loss: 2390612.0000; val_optim_loss: 2390612.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8524; val_auprc_score: 0.8457; val_best_acc_score: 0.7638; val_best_f1_score: 0.7825; train_kl_reg_loss: 22775.5072; train_edge_recon_loss: 340852.4028; train_gene_expr_recon_loss: 656244.9444; train_masked_gp_l1_reg_loss: 9347.7725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54264.8003; train_chrom_access_recon_loss: 1295050.4444; train_global_loss: 2378535.8889; train_optim_loss: 2378535.8889; val_kl_reg_loss: 22406.1836; val_edge_recon_loss: 350936.3750; val_gene_expr_recon_loss: 655211.1875; val_masked_gp_l1_reg_loss: 9361.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52619.2500; val_chrom_access_recon_loss: 1284251.2500; val_global_loss: 2374785.5000; val_optim_loss: 2374785.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8665; val_auprc_score: 0.8577; val_best_acc_score: 0.7815; val_best_f1_score: 0.7966; train_kl_reg_loss: 24243.4902; train_edge_recon_loss: 334000.5035; train_gene_expr_recon_loss: 659517.3403; train_masked_gp_l1_reg_loss: 9381.9436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51383.8663; train_chrom_access_recon_loss: 1296629.6389; train_global_loss: 2375156.8333; train_optim_loss: 2375156.8333; val_kl_reg_loss: 24650.3750; val_edge_recon_loss: 336961.4375; val_gene_expr_recon_loss: 654879.3750; val_masked_gp_l1_reg_loss: 9405.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49872.3594; val_chrom_access_recon_loss: 1282741.1250; val_global_loss: 2358510.2500; val_optim_loss: 2358510.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8855; val_auprc_score: 0.8768; val_best_acc_score: 0.8045; val_best_f1_score: 0.8145; train_kl_reg_loss: 26791.2012; train_edge_recon_loss: 325330.4340; train_gene_expr_recon_loss: 653523.9583; train_masked_gp_l1_reg_loss: 9437.0248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48745.3628; train_chrom_access_recon_loss: 1289147.0000; train_global_loss: 2352974.9722; train_optim_loss: 2352974.9722; val_kl_reg_loss: 28522.8438; val_edge_recon_loss: 324249.3125; val_gene_expr_recon_loss: 654015.8750; val_masked_gp_l1_reg_loss: 9469.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47353.7891; val_chrom_access_recon_loss: 1280758.6250; val_global_loss: 2344369.5000; val_optim_loss: 2344369.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8962; val_auprc_score: 0.8798; val_best_acc_score: 0.8239; val_best_f1_score: 0.8333; train_kl_reg_loss: 30051.0367; train_edge_recon_loss: 316060.8819; train_gene_expr_recon_loss: 656165.6736; train_masked_gp_l1_reg_loss: 9497.2018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46307.7439; train_chrom_access_recon_loss: 1291510.3333; train_global_loss: 2349592.8611; train_optim_loss: 2349592.8611; val_kl_reg_loss: 30565.4668; val_edge_recon_loss: 315381.7500; val_gene_expr_recon_loss: 652449.8125; val_masked_gp_l1_reg_loss: 9521.9385; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45019.8828; val_chrom_access_recon_loss: 1279274.3750; val_global_loss: 2332213.2500; val_optim_loss: 2332213.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9140; val_auprc_score: 0.8972; val_best_acc_score: 0.8441; val_best_f1_score: 0.8520; train_kl_reg_loss: 31703.7276; train_edge_recon_loss: 308914.7847; train_gene_expr_recon_loss: 649125.7847; train_masked_gp_l1_reg_loss: 9542.5224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44056.8694; train_chrom_access_recon_loss: 1285472.5139; train_global_loss: 2328816.2222; train_optim_loss: 2328816.2222; val_kl_reg_loss: 31124.1484; val_edge_recon_loss: 306899.8750; val_gene_expr_recon_loss: 651934.6875; val_masked_gp_l1_reg_loss: 9572.9316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42868.4727; val_chrom_access_recon_loss: 1277222.1250; val_global_loss: 2319622.2500; val_optim_loss: 2319622.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9192; val_auprc_score: 0.8987; val_best_acc_score: 0.8503; val_best_f1_score: 0.8608; train_kl_reg_loss: 31329.3166; train_edge_recon_loss: 304835.3507; train_gene_expr_recon_loss: 653224.1250; train_masked_gp_l1_reg_loss: 9585.0896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41971.8312; train_chrom_access_recon_loss: 1287221.2500; train_global_loss: 2328166.9722; train_optim_loss: 2328166.9722; val_kl_reg_loss: 30337.1699; val_edge_recon_loss: 303172.7188; val_gene_expr_recon_loss: 650595.7500; val_masked_gp_l1_reg_loss: 9619.0381; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40866.0039; val_chrom_access_recon_loss: 1275030.1250; val_global_loss: 2309620.7500; val_optim_loss: 2309620.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9288; val_auprc_score: 0.9131; val_best_acc_score: 0.8573; val_best_f1_score: 0.8650; train_kl_reg_loss: 30913.3303; train_edge_recon_loss: 302955.1354; train_gene_expr_recon_loss: 652961.5694; train_masked_gp_l1_reg_loss: 9649.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40031.7227; train_chrom_access_recon_loss: 1285697.3611; train_global_loss: 2322208.8889; train_optim_loss: 2322208.8889; val_kl_reg_loss: 30755.2109; val_edge_recon_loss: 302878.5625; val_gene_expr_recon_loss: 649210.9375; val_masked_gp_l1_reg_loss: 9675.2666; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39004.0156; val_chrom_access_recon_loss: 1272841.1250; val_global_loss: 2304365.0000; val_optim_loss: 2304365.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9236; val_auprc_score: 0.9071; val_best_acc_score: 0.8475; val_best_f1_score: 0.8560; train_kl_reg_loss: 28839.9935; train_edge_recon_loss: 315301.5625; train_gene_expr_recon_loss: 1014760.3472; train_masked_gp_l1_reg_loss: 9821.4098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38050.4497; train_chrom_access_recon_loss: 1364496.0278; train_global_loss: 2771269.8333; train_optim_loss: 2771269.8333; val_kl_reg_loss: 16010.3281; val_edge_recon_loss: 308795.7500; val_gene_expr_recon_loss: 996839.7500; val_masked_gp_l1_reg_loss: 10103.8799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36770.8047; val_chrom_access_recon_loss: 1345916.8750; val_global_loss: 2714437.2500; val_optim_loss: 2714437.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9189; val_auprc_score: 0.8969; val_best_acc_score: 0.8475; val_best_f1_score: 0.8559; train_kl_reg_loss: 28293.9566; train_edge_recon_loss: 306424.2292; train_gene_expr_recon_loss: 999209.7847; train_masked_gp_l1_reg_loss: 10388.4685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35717.0707; train_chrom_access_recon_loss: 1357430.6389; train_global_loss: 2737464.1667; train_optim_loss: 2737464.1667; val_kl_reg_loss: 16389.4414; val_edge_recon_loss: 303368.7500; val_gene_expr_recon_loss: 991310.5000; val_masked_gp_l1_reg_loss: 10713.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34421.9297; val_chrom_access_recon_loss: 1343668.3750; val_global_loss: 2699872.2500; val_optim_loss: 2699872.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9229; val_auprc_score: 0.9047; val_best_acc_score: 0.8482; val_best_f1_score: 0.8558; train_kl_reg_loss: 25773.2211; train_edge_recon_loss: 301301.8125; train_gene_expr_recon_loss: 996074.9167; train_masked_gp_l1_reg_loss: 10929.7734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33432.8837; train_chrom_access_recon_loss: 1353708.3472; train_global_loss: 2721220.8611; train_optim_loss: 2721220.8611; val_kl_reg_loss: 17804.2734; val_edge_recon_loss: 301214.4062; val_gene_expr_recon_loss: 986203.2500; val_masked_gp_l1_reg_loss: 11179.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32229.7070; val_chrom_access_recon_loss: 1341835.3750; val_global_loss: 2690467.0000; val_optim_loss: 2690467.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9240; val_auprc_score: 0.9049; val_best_acc_score: 0.8533; val_best_f1_score: 0.8602; train_kl_reg_loss: 24728.8190; train_edge_recon_loss: 298404.0417; train_gene_expr_recon_loss: 986674.4306; train_masked_gp_l1_reg_loss: 11352.0002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31332.8049; train_chrom_access_recon_loss: 1352699.5556; train_global_loss: 2705191.6667; train_optim_loss: 2705191.6667; val_kl_reg_loss: 18709.9004; val_edge_recon_loss: 299547.3125; val_gene_expr_recon_loss: 982282.4375; val_masked_gp_l1_reg_loss: 11552.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30248.5078; val_chrom_access_recon_loss: 1339977.3750; val_global_loss: 2682318.0000; val_optim_loss: 2682318.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9264; val_auprc_score: 0.9052; val_best_acc_score: 0.8535; val_best_f1_score: 0.8620; train_kl_reg_loss: 24096.4188; train_edge_recon_loss: 297156.2257; train_gene_expr_recon_loss: 987860.2986; train_masked_gp_l1_reg_loss: 11493.4465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30080.1432; train_chrom_access_recon_loss: 1351085.8333; train_global_loss: 2701772.3611; train_optim_loss: 2701772.3611; val_kl_reg_loss: 19036.0039; val_edge_recon_loss: 296988.0312; val_gene_expr_recon_loss: 980955.7500; val_masked_gp_l1_reg_loss: 11447.0400; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29893.6719; val_chrom_access_recon_loss: 1339351.5000; val_global_loss: 2677672.0000; val_optim_loss: 2677672.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9302; val_auprc_score: 0.9111; val_best_acc_score: 0.8596; val_best_f1_score: 0.8655; train_kl_reg_loss: 24253.2491; train_edge_recon_loss: 297275.6597; train_gene_expr_recon_loss: 988340.2500; train_masked_gp_l1_reg_loss: 11443.3235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29781.8125; train_chrom_access_recon_loss: 1349881.9028; train_global_loss: 2700976.2222; train_optim_loss: 2700976.2222; val_kl_reg_loss: 19222.5469; val_edge_recon_loss: 296836.7188; val_gene_expr_recon_loss: 980520.6250; val_masked_gp_l1_reg_loss: 11431.5635; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29637.3555; val_chrom_access_recon_loss: 1339318.5000; val_global_loss: 2676967.5000; val_optim_loss: 2676967.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9298; val_auprc_score: 0.9032; val_best_acc_score: 0.8600; val_best_f1_score: 0.8665; train_kl_reg_loss: 24005.1144; train_edge_recon_loss: 297007.0799; train_gene_expr_recon_loss: 980870.0764; train_masked_gp_l1_reg_loss: 11429.7554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29532.1141; train_chrom_access_recon_loss: 1348914.7222; train_global_loss: 2691758.8889; train_optim_loss: 2691758.8889; val_kl_reg_loss: 19032.6836; val_edge_recon_loss: 294556.8438; val_gene_expr_recon_loss: 980338.0000; val_masked_gp_l1_reg_loss: 11428.8965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29403.5371; val_chrom_access_recon_loss: 1339066.1250; val_global_loss: 2673826.0000; val_optim_loss: 2673826.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9288; val_auprc_score: 0.9101; val_best_acc_score: 0.8564; val_best_f1_score: 0.8638; train_kl_reg_loss: 23940.0432; train_edge_recon_loss: 297337.2500; train_gene_expr_recon_loss: 982971.1042; train_masked_gp_l1_reg_loss: 11430.9835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29305.8793; train_chrom_access_recon_loss: 1350765.1944; train_global_loss: 2695750.4722; train_optim_loss: 2695750.4722; val_kl_reg_loss: 19281.0801; val_edge_recon_loss: 294610.5625; val_gene_expr_recon_loss: 979947.3750; val_masked_gp_l1_reg_loss: 11434.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29188.5742; val_chrom_access_recon_loss: 1338974.3750; val_global_loss: 2673437.0000; val_optim_loss: 2673437.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 12 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9251
val AUPRC score: 0.9079
val best accuracy score: 0.8535
val best F1 score: 0.8628
val target rna MSE score: 3.8149
val source rna MSE score: 3.1436
val target atac MSE score: 0.1348
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
