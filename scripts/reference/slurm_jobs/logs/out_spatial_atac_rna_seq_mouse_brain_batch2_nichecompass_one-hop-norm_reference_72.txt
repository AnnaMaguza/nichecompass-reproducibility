[True]
Run timestamp: 26072023_022712_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9084; val_auprc_score: 0.9204; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16185.3657; train_edge_recon_loss: 3490655.0833; train_gene_expr_recon_loss: 319344.4479; train_masked_gp_l1_reg_loss: 1672.6056; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108761038.2222; train_global_loss: 112588896.8889; train_optim_loss: 112588896.8889; val_kl_reg_loss: 19383.5625; val_edge_recon_loss: 4065812.2500; val_gene_expr_recon_loss: 304590.0625; val_masked_gp_l1_reg_loss: 1561.3667; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 108213048.0000; val_global_loss: 112604392.0000; val_optim_loss: 112604392.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8871; val_auprc_score: 0.8939; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 38944.0634; train_edge_recon_loss: 3553656.9444; train_gene_expr_recon_loss: 300972.1354; train_masked_gp_l1_reg_loss: 1587.8420; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105883422.2222; train_global_loss: 109778583.1111; train_optim_loss: 109778583.1111; val_kl_reg_loss: 47614.2031; val_edge_recon_loss: 4065836.0000; val_gene_expr_recon_loss: 284219.8125; val_masked_gp_l1_reg_loss: 1657.2156; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106060152.0000; val_global_loss: 110459480.0000; val_optim_loss: 110459480.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8702; val_auprc_score: 0.8700; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 76355.6445; train_edge_recon_loss: 3577309.1111; train_gene_expr_recon_loss: 278119.7274; train_masked_gp_l1_reg_loss: 1747.3990; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103896925.3333; train_global_loss: 107830457.7778; train_optim_loss: 107830457.7778; val_kl_reg_loss: 89860.0234; val_edge_recon_loss: 4065742.5000; val_gene_expr_recon_loss: 263635.7500; val_masked_gp_l1_reg_loss: 1855.1699; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104074832.0000; val_global_loss: 108495928.0000; val_optim_loss: 108495928.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8700; val_auprc_score: 0.8713; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 104981.9401; train_edge_recon_loss: 3629890.4444; train_gene_expr_recon_loss: 263496.4757; train_masked_gp_l1_reg_loss: 1906.5520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102076504.8889; train_global_loss: 106076780.4444; train_optim_loss: 106076780.4444; val_kl_reg_loss: 76569.7578; val_edge_recon_loss: 4065823.5000; val_gene_expr_recon_loss: 250517.2656; val_masked_gp_l1_reg_loss: 1946.9011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102459568.0000; val_global_loss: 106854424.0000; val_optim_loss: 106854424.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8814; val_auprc_score: 0.8833; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 118735.3455; train_edge_recon_loss: 3618444.1111; train_gene_expr_recon_loss: 249546.3073; train_masked_gp_l1_reg_loss: 1957.0660; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100991778.6667; train_global_loss: 104980462.2222; train_optim_loss: 104980462.2222; val_kl_reg_loss: 100431.5547; val_edge_recon_loss: 4065891.2500; val_gene_expr_recon_loss: 240459.1250; val_masked_gp_l1_reg_loss: 1957.7509; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101289408.0000; val_global_loss: 105698144.0000; val_optim_loss: 105698144.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8908; val_auprc_score: 0.8903; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 140837.1953; train_edge_recon_loss: 3625118.9444; train_gene_expr_recon_loss: 241411.0885; train_masked_gp_l1_reg_loss: 1942.8070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99265688.8889; train_global_loss: 103275000.0000; train_optim_loss: 103275000.0000; val_kl_reg_loss: 129222.3438; val_edge_recon_loss: 4065844.0000; val_gene_expr_recon_loss: 233319.8594; val_masked_gp_l1_reg_loss: 1913.2847; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100306584.0000; val_global_loss: 104736880.0000; val_optim_loss: 104736880.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8925; val_auprc_score: 0.8860; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 155419.0903; train_edge_recon_loss: 3623191.0556; train_gene_expr_recon_loss: 234311.5035; train_masked_gp_l1_reg_loss: 1880.4590; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99457066.6667; train_global_loss: 103471867.5556; train_optim_loss: 103471867.5556; val_kl_reg_loss: 121080.6562; val_edge_recon_loss: 4065369.7500; val_gene_expr_recon_loss: 228951.3281; val_masked_gp_l1_reg_loss: 1834.1376; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99852696.0000; val_global_loss: 104269936.0000; val_optim_loss: 104269936.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8641; val_auprc_score: 0.8563; val_best_acc_score: 0.5097; val_best_f1_score: 0.6710; train_kl_reg_loss: 167320.0816; train_edge_recon_loss: 3612113.7222; train_gene_expr_recon_loss: 229039.3698; train_masked_gp_l1_reg_loss: 1795.1972; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98553248.0000; train_global_loss: 102563516.4444; train_optim_loss: 102563516.4444; val_kl_reg_loss: 154773.5625; val_edge_recon_loss: 4064422.5000; val_gene_expr_recon_loss: 224169.8750; val_masked_gp_l1_reg_loss: 1745.7789; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99314264.0000; val_global_loss: 103759376.0000; val_optim_loss: 103759376.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8521; val_auprc_score: 0.8432; val_best_acc_score: 0.5404; val_best_f1_score: 0.6848; train_kl_reg_loss: 183615.1042; train_edge_recon_loss: 3602178.6389; train_gene_expr_recon_loss: 224160.0590; train_masked_gp_l1_reg_loss: 1708.3688; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97774430.2222; train_global_loss: 101786094.2222; train_optim_loss: 101786094.2222; val_kl_reg_loss: 135392.6250; val_edge_recon_loss: 4063090.7500; val_gene_expr_recon_loss: 220652.6562; val_masked_gp_l1_reg_loss: 1662.9238; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98852816.0000; val_global_loss: 103273616.0000; val_optim_loss: 103273616.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8361; val_auprc_score: 0.8334; val_best_acc_score: 0.5597; val_best_f1_score: 0.6933; train_kl_reg_loss: 185795.5139; train_edge_recon_loss: 3610003.9722; train_gene_expr_recon_loss: 219831.9531; train_masked_gp_l1_reg_loss: 1631.4167; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97028410.6667; train_global_loss: 101045673.7778; train_optim_loss: 101045673.7778; val_kl_reg_loss: 195962.8750; val_edge_recon_loss: 4062209.2500; val_gene_expr_recon_loss: 218201.4062; val_masked_gp_l1_reg_loss: 1593.6770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98899608.0000; val_global_loss: 103377576.0000; val_optim_loss: 103377576.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8380; val_auprc_score: 0.8385; val_best_acc_score: 0.6160; val_best_f1_score: 0.7199; train_kl_reg_loss: 194658.8038; train_edge_recon_loss: 3601726.3889; train_gene_expr_recon_loss: 219489.6753; train_masked_gp_l1_reg_loss: 1567.2317; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97824603.5556; train_global_loss: 101842046.2222; train_optim_loss: 101842046.2222; val_kl_reg_loss: 137456.0312; val_edge_recon_loss: 4059479.0000; val_gene_expr_recon_loss: 216752.2812; val_masked_gp_l1_reg_loss: 1535.6177; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98461776.0000; val_global_loss: 102877000.0000; val_optim_loss: 102877000.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8350; val_auprc_score: 0.8305; val_best_acc_score: 0.6346; val_best_f1_score: 0.7277; train_kl_reg_loss: 182471.7222; train_edge_recon_loss: 3615348.6944; train_gene_expr_recon_loss: 217191.9809; train_masked_gp_l1_reg_loss: 1514.8564; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97047900.4444; train_global_loss: 101064426.6667; train_optim_loss: 101064426.6667; val_kl_reg_loss: 194474.8438; val_edge_recon_loss: 4058164.2500; val_gene_expr_recon_loss: 215040.4531; val_masked_gp_l1_reg_loss: 1489.7129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98295408.0000; val_global_loss: 102764576.0000; val_optim_loss: 102764576.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8423; val_auprc_score: 0.8389; val_best_acc_score: 0.6717; val_best_f1_score: 0.7445; train_kl_reg_loss: 195591.3976; train_edge_recon_loss: 3587964.3056; train_gene_expr_recon_loss: 216613.8420; train_masked_gp_l1_reg_loss: 1475.0096; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97078032.0000; train_global_loss: 101079675.5556; train_optim_loss: 101079675.5556; val_kl_reg_loss: 158143.5625; val_edge_recon_loss: 4054733.5000; val_gene_expr_recon_loss: 214681.0312; val_masked_gp_l1_reg_loss: 1455.6091; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98305800.0000; val_global_loss: 102734816.0000; val_optim_loss: 102734816.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8465; val_auprc_score: 0.8434; val_best_acc_score: 0.7043; val_best_f1_score: 0.7606; train_kl_reg_loss: 187432.1319; train_edge_recon_loss: 3593863.3056; train_gene_expr_recon_loss: 216654.7934; train_masked_gp_l1_reg_loss: 1446.6120; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96738610.6667; train_global_loss: 100738008.0000; train_optim_loss: 100738008.0000; val_kl_reg_loss: 174190.9688; val_edge_recon_loss: 4051605.7500; val_gene_expr_recon_loss: 213650.0781; val_masked_gp_l1_reg_loss: 1432.2480; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98186912.0000; val_global_loss: 102627792.0000; val_optim_loss: 102627792.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8521; val_auprc_score: 0.8505; val_best_acc_score: 0.7354; val_best_f1_score: 0.7732; train_kl_reg_loss: 189848.7083; train_edge_recon_loss: 3583523.1944; train_gene_expr_recon_loss: 216358.8733; train_masked_gp_l1_reg_loss: 1424.4257; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96985398.2222; train_global_loss: 100976554.6667; train_optim_loss: 100976554.6667; val_kl_reg_loss: 146584.5781; val_edge_recon_loss: 4045438.7500; val_gene_expr_recon_loss: 213177.7812; val_masked_gp_l1_reg_loss: 1413.1697; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97975448.0000; val_global_loss: 102382064.0000; val_optim_loss: 102382064.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8550; val_auprc_score: 0.8509; val_best_acc_score: 0.7600; val_best_f1_score: 0.7833; train_kl_reg_loss: 183055.5799; train_edge_recon_loss: 3584283.4444; train_gene_expr_recon_loss: 214426.0000; train_masked_gp_l1_reg_loss: 1409.3903; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96750506.6667; train_global_loss: 100733680.0000; train_optim_loss: 100733680.0000; val_kl_reg_loss: 164782.4062; val_edge_recon_loss: 4038981.7500; val_gene_expr_recon_loss: 212456.7812; val_masked_gp_l1_reg_loss: 1400.0955; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97869552.0000; val_global_loss: 102287176.0000; val_optim_loss: 102287176.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8616; val_auprc_score: 0.8569; val_best_acc_score: 0.7798; val_best_f1_score: 0.7867; train_kl_reg_loss: 182427.1545; train_edge_recon_loss: 3578072.7500; train_gene_expr_recon_loss: 214412.9340; train_masked_gp_l1_reg_loss: 1393.7721; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96528164.4444; train_global_loss: 100504471.1111; train_optim_loss: 100504471.1111; val_kl_reg_loss: 143295.1406; val_edge_recon_loss: 4027400.2500; val_gene_expr_recon_loss: 212133.4375; val_masked_gp_l1_reg_loss: 1385.8335; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97864208.0000; val_global_loss: 102248424.0000; val_optim_loss: 102248424.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8609; val_auprc_score: 0.8533; val_best_acc_score: 0.7741; val_best_f1_score: 0.7676; train_kl_reg_loss: 179855.1285; train_edge_recon_loss: 3571787.7778; train_gene_expr_recon_loss: 213800.9653; train_masked_gp_l1_reg_loss: 1382.9036; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96679134.2222; train_global_loss: 100645961.7778; train_optim_loss: 100645961.7778; val_kl_reg_loss: 152505.8438; val_edge_recon_loss: 4011714.7500; val_gene_expr_recon_loss: 211543.2969; val_masked_gp_l1_reg_loss: 1378.3005; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97706088.0000; val_global_loss: 102083232.0000; val_optim_loss: 102083232.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8607; val_auprc_score: 0.8507; val_best_acc_score: 0.7700; val_best_f1_score: 0.7662; train_kl_reg_loss: 173874.2101; train_edge_recon_loss: 3568641.8611; train_gene_expr_recon_loss: 214782.9583; train_masked_gp_l1_reg_loss: 1377.0053; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96970129.7778; train_global_loss: 100928806.2222; train_optim_loss: 100928806.2222; val_kl_reg_loss: 149957.2188; val_edge_recon_loss: 3990173.0000; val_gene_expr_recon_loss: 211191.8750; val_masked_gp_l1_reg_loss: 1374.2014; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97889552.0000; val_global_loss: 102242248.0000; val_optim_loss: 102242248.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8635; val_auprc_score: 0.8533; val_best_acc_score: 0.7540; val_best_f1_score: 0.7839; train_kl_reg_loss: 174093.9028; train_edge_recon_loss: 3556334.8889; train_gene_expr_recon_loss: 213115.2153; train_masked_gp_l1_reg_loss: 1377.1728; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96167966.2222; train_global_loss: 100112886.2222; train_optim_loss: 100112886.2222; val_kl_reg_loss: 142658.0000; val_edge_recon_loss: 3960963.2500; val_gene_expr_recon_loss: 210795.6719; val_masked_gp_l1_reg_loss: 1373.2704; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97706488.0000; val_global_loss: 102022280.0000; val_optim_loss: 102022280.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8680; val_auprc_score: 0.8531; val_best_acc_score: 0.7720; val_best_f1_score: 0.7983; train_kl_reg_loss: 166947.4236; train_edge_recon_loss: 3555447.5833; train_gene_expr_recon_loss: 212393.6528; train_masked_gp_l1_reg_loss: 1370.2381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96317120.8889; train_global_loss: 100253281.7778; train_optim_loss: 100253281.7778; val_kl_reg_loss: 145892.3125; val_edge_recon_loss: 3917326.0000; val_gene_expr_recon_loss: 210556.9688; val_masked_gp_l1_reg_loss: 1365.1879; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97448000.0000; val_global_loss: 101723136.0000; val_optim_loss: 101723136.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8719; val_auprc_score: 0.8592; val_best_acc_score: 0.7848; val_best_f1_score: 0.8002; train_kl_reg_loss: 166163.4444; train_edge_recon_loss: 3535509.6667; train_gene_expr_recon_loss: 211654.4115; train_masked_gp_l1_reg_loss: 1363.1651; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96069964.4444; train_global_loss: 99984655.1111; train_optim_loss: 99984655.1111; val_kl_reg_loss: 141047.6562; val_edge_recon_loss: 3855593.7500; val_gene_expr_recon_loss: 210425.1875; val_masked_gp_l1_reg_loss: 1358.4172; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97472040.0000; val_global_loss: 101680464.0000; val_optim_loss: 101680464.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8705; val_auprc_score: 0.8558; val_best_acc_score: 0.7851; val_best_f1_score: 0.8044; train_kl_reg_loss: 159246.8281; train_edge_recon_loss: 3520146.3889; train_gene_expr_recon_loss: 213208.3281; train_masked_gp_l1_reg_loss: 1361.0304; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96040894.2222; train_global_loss: 99934856.0000; train_optim_loss: 99934856.0000; val_kl_reg_loss: 139185.3438; val_edge_recon_loss: 3791538.7500; val_gene_expr_recon_loss: 210268.8906; val_masked_gp_l1_reg_loss: 1360.2720; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97291456.0000; val_global_loss: 101433808.0000; val_optim_loss: 101433808.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8739; val_auprc_score: 0.8611; val_best_acc_score: 0.7856; val_best_f1_score: 0.8028; train_kl_reg_loss: 154713.5642; train_edge_recon_loss: 3488481.6944; train_gene_expr_recon_loss: 211534.0122; train_masked_gp_l1_reg_loss: 1361.2500; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95883591.1111; train_global_loss: 99739681.7778; train_optim_loss: 99739681.7778; val_kl_reg_loss: 134490.6250; val_edge_recon_loss: 3690633.0000; val_gene_expr_recon_loss: 210238.4062; val_masked_gp_l1_reg_loss: 1360.0220; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97226888.0000; val_global_loss: 101263608.0000; val_optim_loss: 101263608.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8738; val_auprc_score: 0.8617; val_best_acc_score: 0.7833; val_best_f1_score: 0.7996; train_kl_reg_loss: 146900.1528; train_edge_recon_loss: 3445898.5278; train_gene_expr_recon_loss: 211585.6233; train_masked_gp_l1_reg_loss: 1361.9329; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95837063.1111; train_global_loss: 99642808.8889; train_optim_loss: 99642808.8889; val_kl_reg_loss: 126129.5156; val_edge_recon_loss: 3576692.2500; val_gene_expr_recon_loss: 210090.0469; val_masked_gp_l1_reg_loss: 1361.4050; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97102016.0000; val_global_loss: 101016288.0000; val_optim_loss: 101016288.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8933; val_auprc_score: 0.8790; val_best_acc_score: 0.7877; val_best_f1_score: 0.8152; train_kl_reg_loss: 158460.8238; train_edge_recon_loss: 3774531.2778; train_gene_expr_recon_loss: 218858.6580; train_masked_gp_l1_reg_loss: 1370.3641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96474223.1111; train_global_loss: 100627445.3333; train_optim_loss: 100627445.3333; val_kl_reg_loss: 89357.2812; val_edge_recon_loss: 3884031.0000; val_gene_expr_recon_loss: 213160.2969; val_masked_gp_l1_reg_loss: 1373.5480; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97577312.0000; val_global_loss: 101765232.0000; val_optim_loss: 101765232.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8941; val_auprc_score: 0.8779; val_best_acc_score: 0.8041; val_best_f1_score: 0.8011; train_kl_reg_loss: 151501.6172; train_edge_recon_loss: 3696156.1389; train_gene_expr_recon_loss: 217197.8698; train_masked_gp_l1_reg_loss: 1375.3327; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96541880.0000; train_global_loss: 100608110.2222; train_optim_loss: 100608110.2222; val_kl_reg_loss: 91511.3359; val_edge_recon_loss: 3956135.7500; val_gene_expr_recon_loss: 212720.5625; val_masked_gp_l1_reg_loss: 1377.7512; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97595256.0000; val_global_loss: 101857000.0000; val_optim_loss: 101857000.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8920; val_auprc_score: 0.8755; val_best_acc_score: 0.8115; val_best_f1_score: 0.8110; train_kl_reg_loss: 125433.9358; train_edge_recon_loss: 3758965.1944; train_gene_expr_recon_loss: 225320.2587; train_masked_gp_l1_reg_loss: 1383.0656; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96393085.3333; train_global_loss: 100504188.4444; train_optim_loss: 100504188.4444; val_kl_reg_loss: 67443.5938; val_edge_recon_loss: 4007090.2500; val_gene_expr_recon_loss: 212527.7969; val_masked_gp_l1_reg_loss: 1389.0258; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97381064.0000; val_global_loss: 101669512.0000; val_optim_loss: 101669512.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8956; val_auprc_score: 0.8808; val_best_acc_score: 0.8088; val_best_f1_score: 0.8070; train_kl_reg_loss: 109881.9835; train_edge_recon_loss: 3841976.7500; train_gene_expr_recon_loss: 221194.2847; train_masked_gp_l1_reg_loss: 1391.9084; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96269203.5556; train_global_loss: 100443648.0000; train_optim_loss: 100443648.0000; val_kl_reg_loss: 71276.9062; val_edge_recon_loss: 4000491.0000; val_gene_expr_recon_loss: 211331.7812; val_masked_gp_l1_reg_loss: 1396.6810; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97366256.0000; val_global_loss: 101650752.0000; val_optim_loss: 101650752.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8939; val_auprc_score: 0.8810; val_best_acc_score: 0.8096; val_best_f1_score: 0.8076; train_kl_reg_loss: 86791.6597; train_edge_recon_loss: 3823743.5000; train_gene_expr_recon_loss: 221927.8281; train_masked_gp_l1_reg_loss: 1393.7572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96299547.5556; train_global_loss: 100433404.4444; train_optim_loss: 100433404.4444; val_kl_reg_loss: 72823.2500; val_edge_recon_loss: 4001479.2500; val_gene_expr_recon_loss: 211378.0625; val_masked_gp_l1_reg_loss: 1389.9351; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97380896.0000; val_global_loss: 101667968.0000; val_optim_loss: 101667968.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8924; val_auprc_score: 0.8748; val_best_acc_score: 0.8068; val_best_f1_score: 0.8051; train_kl_reg_loss: 96044.5755; train_edge_recon_loss: 3779959.4167; train_gene_expr_recon_loss: 226788.0312; train_masked_gp_l1_reg_loss: 1388.1575; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96443837.3333; train_global_loss: 100548018.6667; train_optim_loss: 100548018.6667; val_kl_reg_loss: 78033.7969; val_edge_recon_loss: 4001532.0000; val_gene_expr_recon_loss: 211175.4531; val_masked_gp_l1_reg_loss: 1385.9072; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97220936.0000; val_global_loss: 101513064.0000; val_optim_loss: 101513064.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8951; val_auprc_score: 0.8778; val_best_acc_score: 0.8094; val_best_f1_score: 0.8068; train_kl_reg_loss: 99984.3559; train_edge_recon_loss: 3781936.9444; train_gene_expr_recon_loss: 223865.9167; train_masked_gp_l1_reg_loss: 1384.5312; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96449544.0000; train_global_loss: 100556714.6667; train_optim_loss: 100556714.6667; val_kl_reg_loss: 83217.3594; val_edge_recon_loss: 3996732.0000; val_gene_expr_recon_loss: 210745.8125; val_masked_gp_l1_reg_loss: 1382.8369; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97081088.0000; val_global_loss: 101373168.0000; val_optim_loss: 101373168.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8921; val_auprc_score: 0.8740; val_best_acc_score: 0.8092; val_best_f1_score: 0.8058; train_kl_reg_loss: 99407.6042; train_edge_recon_loss: 3852333.9167; train_gene_expr_recon_loss: 222227.1354; train_masked_gp_l1_reg_loss: 1381.4303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96062455.1111; train_global_loss: 100237805.3333; train_optim_loss: 100237805.3333; val_kl_reg_loss: 78957.3594; val_edge_recon_loss: 3994488.5000; val_gene_expr_recon_loss: 210870.5938; val_masked_gp_l1_reg_loss: 1379.8667; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97197640.0000; val_global_loss: 101483336.0000; val_optim_loss: 101483336.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 43 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8915
Val AUPRC score: 0.8768
Val best accuracy score: 0.7925
Val best F1 score: 0.8083
Val gene expr MSE score: 0.5241
Val chrom access MSE score: 0.0883
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
