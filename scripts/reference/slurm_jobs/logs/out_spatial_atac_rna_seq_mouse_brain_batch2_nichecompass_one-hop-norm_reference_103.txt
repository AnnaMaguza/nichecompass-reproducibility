[True]
Run timestamp: 10102023_013550_103.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_103']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7111; val_auprc_score: 0.6791; val_best_acc_score: 0.5021; val_best_f1_score: 0.6675; train_kl_reg_loss: 53622.6945; train_edge_recon_loss: 3510978.6439; train_gene_expr_recon_loss: 14127046.6818; train_masked_gp_l1_reg_loss: 31883.5206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3672558.0265; train_chrom_access_recon_loss: 11585735.3788; train_global_loss: 32981824.9091; train_optim_loss: 32981824.9091; val_kl_reg_loss: 103880.5303; val_edge_recon_loss: 4065119.9062; val_gene_expr_recon_loss: 13016841.1250; val_masked_gp_l1_reg_loss: 37972.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2063418.0000; val_chrom_access_recon_loss: 11180997.2500; val_global_loss: 30468229.0000; val_optim_loss: 30468229.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6780; val_auprc_score: 0.6579; val_best_acc_score: 0.5621; val_best_f1_score: 0.6854; train_kl_reg_loss: 98131.0343; train_edge_recon_loss: 3522230.4735; train_gene_expr_recon_loss: 12872439.3333; train_masked_gp_l1_reg_loss: 39862.9566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1128900.0237; train_chrom_access_recon_loss: 11032593.6061; train_global_loss: 28694157.4545; train_optim_loss: 28694157.4545; val_kl_reg_loss: 101222.2119; val_edge_recon_loss: 4061839.6875; val_gene_expr_recon_loss: 12622864.6250; val_masked_gp_l1_reg_loss: 41291.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 549590.1250; val_chrom_access_recon_loss: 10864402.2500; val_global_loss: 28241210.7500; val_optim_loss: 28241210.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7590; val_auprc_score: 0.7401; val_best_acc_score: 0.6948; val_best_f1_score: 0.6990; train_kl_reg_loss: 91310.1970; train_edge_recon_loss: 3515057.7424; train_gene_expr_recon_loss: 12709375.8939; train_masked_gp_l1_reg_loss: 42250.7862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 371876.8741; train_chrom_access_recon_loss: 10936946.0303; train_global_loss: 27666817.3636; train_optim_loss: 27666817.3636; val_kl_reg_loss: 80073.2832; val_edge_recon_loss: 4036474.0625; val_gene_expr_recon_loss: 12590892.8750; val_masked_gp_l1_reg_loss: 43366.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 254775.9844; val_chrom_access_recon_loss: 10823406.5000; val_global_loss: 27828988.5000; val_optim_loss: 27828988.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8365; val_auprc_score: 0.8061; val_best_acc_score: 0.7665; val_best_f1_score: 0.7938; train_kl_reg_loss: 75135.0746; train_edge_recon_loss: 3478996.2992; train_gene_expr_recon_loss: 12602237.7727; train_masked_gp_l1_reg_loss: 44698.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204493.8629; train_chrom_access_recon_loss: 10850389.0303; train_global_loss: 27255950.1515; train_optim_loss: 27255950.1515; val_kl_reg_loss: 55433.1987; val_edge_recon_loss: 3552287.6875; val_gene_expr_recon_loss: 12537698.8750; val_masked_gp_l1_reg_loss: 46561.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167688.1406; val_chrom_access_recon_loss: 10837437.7500; val_global_loss: 27197107.5000; val_optim_loss: 27197107.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8570; val_auprc_score: 0.8181; val_best_acc_score: 0.7775; val_best_f1_score: 0.8017; train_kl_reg_loss: 83118.1229; train_edge_recon_loss: 3061469.1818; train_gene_expr_recon_loss: 12549365.6667; train_masked_gp_l1_reg_loss: 49574.8182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148033.0696; train_chrom_access_recon_loss: 10811303.8182; train_global_loss: 26702864.6970; train_optim_loss: 26702864.6970; val_kl_reg_loss: 99013.2393; val_edge_recon_loss: 2932255.0000; val_gene_expr_recon_loss: 12471810.7500; val_masked_gp_l1_reg_loss: 51951.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131655.0938; val_chrom_access_recon_loss: 10723070.0000; val_global_loss: 26409755.0000; val_optim_loss: 26409755.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8725; val_auprc_score: 0.8328; val_best_acc_score: 0.8020; val_best_f1_score: 0.8233; train_kl_reg_loss: 99776.5647; train_edge_recon_loss: 2930180.3144; train_gene_expr_recon_loss: 12460037.2879; train_masked_gp_l1_reg_loss: 53352.0184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120302.7025; train_chrom_access_recon_loss: 10739954.0303; train_global_loss: 26403602.8485; train_optim_loss: 26403602.8485; val_kl_reg_loss: 97109.5928; val_edge_recon_loss: 2921073.9062; val_gene_expr_recon_loss: 12354753.0000; val_masked_gp_l1_reg_loss: 54754.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111078.4219; val_chrom_access_recon_loss: 10801501.3750; val_global_loss: 26340271.5000; val_optim_loss: 26340271.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8994; val_auprc_score: 0.8671; val_best_acc_score: 0.8372; val_best_f1_score: 0.8497; train_kl_reg_loss: 102294.5679; train_edge_recon_loss: 2849018.6174; train_gene_expr_recon_loss: 12397832.3788; train_masked_gp_l1_reg_loss: 55991.9256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104590.8427; train_chrom_access_recon_loss: 10694983.9394; train_global_loss: 26204712.4242; train_optim_loss: 26204712.4242; val_kl_reg_loss: 100501.4570; val_edge_recon_loss: 2823843.9688; val_gene_expr_recon_loss: 12297266.7500; val_masked_gp_l1_reg_loss: 57228.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99610.1719; val_chrom_access_recon_loss: 10672340.3750; val_global_loss: 26050790.5000; val_optim_loss: 26050790.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8940; val_auprc_score: 0.8501; val_best_acc_score: 0.8332; val_best_f1_score: 0.8474; train_kl_reg_loss: 102135.1049; train_edge_recon_loss: 2831203.1212; train_gene_expr_recon_loss: 12338300.3182; train_masked_gp_l1_reg_loss: 58222.4689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95684.0605; train_chrom_access_recon_loss: 10647526.6515; train_global_loss: 26073071.7879; train_optim_loss: 26073071.7879; val_kl_reg_loss: 98005.1553; val_edge_recon_loss: 2834369.3750; val_gene_expr_recon_loss: 12197930.2500; val_masked_gp_l1_reg_loss: 59278.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92055.3281; val_chrom_access_recon_loss: 10532897.3750; val_global_loss: 25814535.0000; val_optim_loss: 25814535.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8934; val_auprc_score: 0.8540; val_best_acc_score: 0.8329; val_best_f1_score: 0.8491; train_kl_reg_loss: 99109.6980; train_edge_recon_loss: 2834334.3182; train_gene_expr_recon_loss: 12287584.8939; train_masked_gp_l1_reg_loss: 60157.8952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89625.1352; train_chrom_access_recon_loss: 10605097.3939; train_global_loss: 25975909.3939; train_optim_loss: 25975909.3939; val_kl_reg_loss: 99558.5430; val_edge_recon_loss: 2835281.8125; val_gene_expr_recon_loss: 12154955.3750; val_masked_gp_l1_reg_loss: 60967.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87459.7578; val_chrom_access_recon_loss: 10484545.5000; val_global_loss: 25722769.2500; val_optim_loss: 25722769.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9013; val_auprc_score: 0.8659; val_best_acc_score: 0.8426; val_best_f1_score: 0.8564; train_kl_reg_loss: 98011.2380; train_edge_recon_loss: 2810280.6326; train_gene_expr_recon_loss: 12226612.5000; train_masked_gp_l1_reg_loss: 61765.6253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86046.4974; train_chrom_access_recon_loss: 10565548.1364; train_global_loss: 25848264.5758; train_optim_loss: 25848264.5758; val_kl_reg_loss: 94670.8506; val_edge_recon_loss: 2848540.0938; val_gene_expr_recon_loss: 12261744.6250; val_masked_gp_l1_reg_loss: 62627.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84859.3047; val_chrom_access_recon_loss: 10621242.8750; val_global_loss: 25973685.5000; val_optim_loss: 25973685.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9027; val_auprc_score: 0.8650; val_best_acc_score: 0.8426; val_best_f1_score: 0.8547; train_kl_reg_loss: 94349.5969; train_edge_recon_loss: 2804970.0038; train_gene_expr_recon_loss: 12186608.2121; train_masked_gp_l1_reg_loss: 63241.2490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83829.8468; train_chrom_access_recon_loss: 10532860.7576; train_global_loss: 25765859.8182; train_optim_loss: 25765859.8182; val_kl_reg_loss: 93250.7080; val_edge_recon_loss: 2834461.7812; val_gene_expr_recon_loss: 12150299.7500; val_masked_gp_l1_reg_loss: 64030.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83403.4453; val_chrom_access_recon_loss: 10533867.2500; val_global_loss: 25759312.5000; val_optim_loss: 25759312.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8997; val_auprc_score: 0.8741; val_best_acc_score: 0.8366; val_best_f1_score: 0.8485; train_kl_reg_loss: 92155.7267; train_edge_recon_loss: 2799077.3371; train_gene_expr_recon_loss: 12129749.1061; train_masked_gp_l1_reg_loss: 64631.2428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82121.3282; train_chrom_access_recon_loss: 10477185.6515; train_global_loss: 25644920.2424; train_optim_loss: 25644920.2424; val_kl_reg_loss: 88100.6445; val_edge_recon_loss: 2834117.6875; val_gene_expr_recon_loss: 12065747.5000; val_masked_gp_l1_reg_loss: 65340.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81786.3359; val_chrom_access_recon_loss: 10439662.0000; val_global_loss: 25574754.0000; val_optim_loss: 25574754.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9144; val_auprc_score: 0.8844; val_best_acc_score: 0.8520; val_best_f1_score: 0.8601; train_kl_reg_loss: 89753.6700; train_edge_recon_loss: 2790683.7576; train_gene_expr_recon_loss: 12096535.7879; train_masked_gp_l1_reg_loss: 65933.7873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80453.4955; train_chrom_access_recon_loss: 10456880.3636; train_global_loss: 25580240.9394; train_optim_loss: 25580240.9394; val_kl_reg_loss: 90308.2832; val_edge_recon_loss: 2820193.6875; val_gene_expr_recon_loss: 12074977.3750; val_masked_gp_l1_reg_loss: 66520.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79557.2656; val_chrom_access_recon_loss: 10438094.8750; val_global_loss: 25569652.2500; val_optim_loss: 25569652.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9136; val_auprc_score: 0.8870; val_best_acc_score: 0.8581; val_best_f1_score: 0.8700; train_kl_reg_loss: 90411.4515; train_edge_recon_loss: 2788281.4659; train_gene_expr_recon_loss: 12047423.0909; train_masked_gp_l1_reg_loss: 66973.2714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78509.1342; train_chrom_access_recon_loss: 10421862.5909; train_global_loss: 25493461.1212; train_optim_loss: 25493461.1212; val_kl_reg_loss: 88561.8232; val_edge_recon_loss: 2757023.6250; val_gene_expr_recon_loss: 11931361.8750; val_masked_gp_l1_reg_loss: 67563.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78380.0156; val_chrom_access_recon_loss: 10424062.0000; val_global_loss: 25346953.0000; val_optim_loss: 25346953.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9182; val_auprc_score: 0.8884; val_best_acc_score: 0.8579; val_best_f1_score: 0.8684; train_kl_reg_loss: 88172.9741; train_edge_recon_loss: 2776428.3333; train_gene_expr_recon_loss: 12010456.7121; train_masked_gp_l1_reg_loss: 67949.1153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77022.1236; train_chrom_access_recon_loss: 10382265.9848; train_global_loss: 25402295.3333; train_optim_loss: 25402295.3333; val_kl_reg_loss: 86742.2021; val_edge_recon_loss: 2777321.1875; val_gene_expr_recon_loss: 11975174.6250; val_masked_gp_l1_reg_loss: 68363.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76484.6016; val_chrom_access_recon_loss: 10452790.5000; val_global_loss: 25436878.0000; val_optim_loss: 25436878.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9096; val_auprc_score: 0.8716; val_best_acc_score: 0.8517; val_best_f1_score: 0.8620; train_kl_reg_loss: 87079.2261; train_edge_recon_loss: 2764950.9129; train_gene_expr_recon_loss: 11982554.1364; train_masked_gp_l1_reg_loss: 68805.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75583.0341; train_chrom_access_recon_loss: 10363931.8333; train_global_loss: 25342904.5152; train_optim_loss: 25342904.5152; val_kl_reg_loss: 85551.0635; val_edge_recon_loss: 2840391.6250; val_gene_expr_recon_loss: 11898009.5000; val_masked_gp_l1_reg_loss: 69348.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74993.9141; val_chrom_access_recon_loss: 10419284.6250; val_global_loss: 25387579.0000; val_optim_loss: 25387579.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9117; val_auprc_score: 0.8794; val_best_acc_score: 0.8546; val_best_f1_score: 0.8645; train_kl_reg_loss: 84545.2663; train_edge_recon_loss: 2765381.2273; train_gene_expr_recon_loss: 11950082.9091; train_masked_gp_l1_reg_loss: 69783.5174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74381.6192; train_chrom_access_recon_loss: 10322983.2424; train_global_loss: 25267157.6970; train_optim_loss: 25267157.6970; val_kl_reg_loss: 79639.5273; val_edge_recon_loss: 2812677.8438; val_gene_expr_recon_loss: 11868163.0000; val_masked_gp_l1_reg_loss: 70236.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74531.9609; val_chrom_access_recon_loss: 10263717.2500; val_global_loss: 25168966.0000; val_optim_loss: 25168966.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9210; val_auprc_score: 0.8916; val_best_acc_score: 0.8641; val_best_f1_score: 0.8712; train_kl_reg_loss: 87656.5199; train_edge_recon_loss: 2749100.3939; train_gene_expr_recon_loss: 11919338.1515; train_masked_gp_l1_reg_loss: 70532.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73498.7847; train_chrom_access_recon_loss: 10304523.5303; train_global_loss: 25204650.5152; train_optim_loss: 25204650.5152; val_kl_reg_loss: 87136.3848; val_edge_recon_loss: 2770056.3750; val_gene_expr_recon_loss: 11831573.2500; val_masked_gp_l1_reg_loss: 70978.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73663.9453; val_chrom_access_recon_loss: 10230280.2500; val_global_loss: 25063689.2500; val_optim_loss: 25063689.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9248; val_auprc_score: 0.8980; val_best_acc_score: 0.8659; val_best_f1_score: 0.8721; train_kl_reg_loss: 85555.8068; train_edge_recon_loss: 2745695.9659; train_gene_expr_recon_loss: 11892710.5758; train_masked_gp_l1_reg_loss: 71226.4852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72876.1074; train_chrom_access_recon_loss: 10282617.9394; train_global_loss: 25150682.9091; train_optim_loss: 25150682.9091; val_kl_reg_loss: 82462.2363; val_edge_recon_loss: 2768853.0938; val_gene_expr_recon_loss: 11814082.8750; val_masked_gp_l1_reg_loss: 71492.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72601.1094; val_chrom_access_recon_loss: 10344602.1250; val_global_loss: 25154093.2500; val_optim_loss: 25154093.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9277; val_auprc_score: 0.9068; val_best_acc_score: 0.8608; val_best_f1_score: 0.8719; train_kl_reg_loss: 85954.9416; train_edge_recon_loss: 2730298.4318; train_gene_expr_recon_loss: 11867901.4242; train_masked_gp_l1_reg_loss: 71849.8220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71959.1766; train_chrom_access_recon_loss: 10258338.8788; train_global_loss: 25086302.4545; train_optim_loss: 25086302.4545; val_kl_reg_loss: 84618.8145; val_edge_recon_loss: 2797967.3750; val_gene_expr_recon_loss: 11831882.7500; val_masked_gp_l1_reg_loss: 72169.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71771.1562; val_chrom_access_recon_loss: 10356280.8750; val_global_loss: 25214690.5000; val_optim_loss: 25214690.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9291; val_auprc_score: 0.9015; val_best_acc_score: 0.8721; val_best_f1_score: 0.8803; train_kl_reg_loss: 84306.9544; train_edge_recon_loss: 2730689.3447; train_gene_expr_recon_loss: 11829454.2879; train_masked_gp_l1_reg_loss: 72470.3615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71317.2550; train_chrom_access_recon_loss: 10215490.5909; train_global_loss: 25003728.7576; train_optim_loss: 25003728.7576; val_kl_reg_loss: 83936.1318; val_edge_recon_loss: 2723510.0312; val_gene_expr_recon_loss: 11785679.2500; val_masked_gp_l1_reg_loss: 72789.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71424.9609; val_chrom_access_recon_loss: 10163288.6250; val_global_loss: 24900629.0000; val_optim_loss: 24900629.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9304; val_auprc_score: 0.9043; val_best_acc_score: 0.8726; val_best_f1_score: 0.8792; train_kl_reg_loss: 83636.4956; train_edge_recon_loss: 2729826.6667; train_gene_expr_recon_loss: 11807872.4545; train_masked_gp_l1_reg_loss: 73049.3716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70836.9962; train_chrom_access_recon_loss: 10199450.3788; train_global_loss: 24964672.3636; train_optim_loss: 24964672.3636; val_kl_reg_loss: 84160.9678; val_edge_recon_loss: 2758813.0938; val_gene_expr_recon_loss: 11809299.3750; val_masked_gp_l1_reg_loss: 73328.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70658.0938; val_chrom_access_recon_loss: 10190388.3750; val_global_loss: 24986649.2500; val_optim_loss: 24986649.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9253; val_auprc_score: 0.8919; val_best_acc_score: 0.8678; val_best_f1_score: 0.8756; train_kl_reg_loss: 82292.6413; train_edge_recon_loss: 2748353.8030; train_gene_expr_recon_loss: 11784350.9545; train_masked_gp_l1_reg_loss: 73480.3368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70379.9899; train_chrom_access_recon_loss: 10177900.8030; train_global_loss: 24936758.4545; train_optim_loss: 24936758.4545; val_kl_reg_loss: 80864.4180; val_edge_recon_loss: 2764893.4062; val_gene_expr_recon_loss: 11780360.7500; val_masked_gp_l1_reg_loss: 73693.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70443.6250; val_chrom_access_recon_loss: 10132921.3750; val_global_loss: 24903178.2500; val_optim_loss: 24903178.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9270; val_auprc_score: 0.8969; val_best_acc_score: 0.8716; val_best_f1_score: 0.8778; train_kl_reg_loss: 82306.3156; train_edge_recon_loss: 2734697.6136; train_gene_expr_recon_loss: 11765560.5909; train_masked_gp_l1_reg_loss: 73958.2193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70166.5468; train_chrom_access_recon_loss: 10143585.5303; train_global_loss: 24870274.6970; train_optim_loss: 24870274.6970; val_kl_reg_loss: 83718.3740; val_edge_recon_loss: 2766995.0312; val_gene_expr_recon_loss: 11682414.5000; val_masked_gp_l1_reg_loss: 74138.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69761.7188; val_chrom_access_recon_loss: 10132047.0000; val_global_loss: 24809074.7500; val_optim_loss: 24809074.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9292; val_auprc_score: 0.9015; val_best_acc_score: 0.8716; val_best_f1_score: 0.8785; train_kl_reg_loss: 81816.6183; train_edge_recon_loss: 2717668.5227; train_gene_expr_recon_loss: 11726882.2424; train_masked_gp_l1_reg_loss: 74378.6089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69749.4966; train_chrom_access_recon_loss: 10117901.1667; train_global_loss: 24788396.5152; train_optim_loss: 24788396.5152; val_kl_reg_loss: 80820.6992; val_edge_recon_loss: 2785701.0625; val_gene_expr_recon_loss: 11667202.0000; val_masked_gp_l1_reg_loss: 74550.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69808.9531; val_chrom_access_recon_loss: 10177853.2500; val_global_loss: 24855936.2500; val_optim_loss: 24855936.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9215; val_auprc_score: 0.8927; val_best_acc_score: 0.8627; val_best_f1_score: 0.8717; train_kl_reg_loss: 104006.8739; train_edge_recon_loss: 2848405.9432; train_gene_expr_recon_loss: 10584853.7727; train_masked_gp_l1_reg_loss: 74687.2073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67837.6458; train_chrom_access_recon_loss: 9370612.9545; train_global_loss: 23050404.5455; train_optim_loss: 23050404.5455; val_kl_reg_loss: 24390.4263; val_edge_recon_loss: 2831634.0000; val_gene_expr_recon_loss: 10425116.6250; val_masked_gp_l1_reg_loss: 74274.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68373.4219; val_chrom_access_recon_loss: 9110249.5000; val_global_loss: 22534038.5000; val_optim_loss: 22534038.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9328; val_auprc_score: 0.9067; val_best_acc_score: 0.8804; val_best_f1_score: 0.8853; train_kl_reg_loss: 89110.3065; train_edge_recon_loss: 2756670.8485; train_gene_expr_recon_loss: 10515822.2879; train_masked_gp_l1_reg_loss: 73572.3900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67955.7191; train_chrom_access_recon_loss: 9197564.8030; train_global_loss: 22700696.0606; train_optim_loss: 22700696.0606; val_kl_reg_loss: 32101.1401; val_edge_recon_loss: 2777334.3125; val_gene_expr_recon_loss: 10581434.0000; val_masked_gp_l1_reg_loss: 72795.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67650.8594; val_chrom_access_recon_loss: 9229647.1250; val_global_loss: 22760963.0000; val_optim_loss: 22760963.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9282; val_auprc_score: 0.8935; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 71293.2844; train_edge_recon_loss: 2734642.3447; train_gene_expr_recon_loss: 10504025.3182; train_masked_gp_l1_reg_loss: 71946.1802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67477.3745; train_chrom_access_recon_loss: 9187490.7727; train_global_loss: 22636875.2121; train_optim_loss: 22636875.2121; val_kl_reg_loss: 37307.7456; val_edge_recon_loss: 2765181.6875; val_gene_expr_recon_loss: 10443217.5000; val_masked_gp_l1_reg_loss: 71073.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67230.7188; val_chrom_access_recon_loss: 9196801.7500; val_global_loss: 22580812.2500; val_optim_loss: 22580812.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9282; val_auprc_score: 0.8986; val_best_acc_score: 0.8710; val_best_f1_score: 0.8802; train_kl_reg_loss: 64688.1660; train_edge_recon_loss: 2721713.2273; train_gene_expr_recon_loss: 10472419.4848; train_masked_gp_l1_reg_loss: 70211.6145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67117.7931; train_chrom_access_recon_loss: 9163360.4848; train_global_loss: 22559510.7879; train_optim_loss: 22559510.7879; val_kl_reg_loss: 41116.3223; val_edge_recon_loss: 2739020.5938; val_gene_expr_recon_loss: 10471177.0000; val_masked_gp_l1_reg_loss: 69451.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66959.1875; val_chrom_access_recon_loss: 9208320.7500; val_global_loss: 22596044.5000; val_optim_loss: 22596044.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9303; val_auprc_score: 0.9056; val_best_acc_score: 0.8743; val_best_f1_score: 0.8814; train_kl_reg_loss: 60477.8654; train_edge_recon_loss: 2723921.7841; train_gene_expr_recon_loss: 10458621.7424; train_masked_gp_l1_reg_loss: 68778.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66785.7717; train_chrom_access_recon_loss: 9150990.6970; train_global_loss: 22529576.4848; train_optim_loss: 22529576.4848; val_kl_reg_loss: 43072.5596; val_edge_recon_loss: 2749490.9375; val_gene_expr_recon_loss: 10436266.2500; val_masked_gp_l1_reg_loss: 68051.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67327.9922; val_chrom_access_recon_loss: 9152713.0000; val_global_loss: 22516921.5000; val_optim_loss: 22516921.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9302; val_auprc_score: 0.9035; val_best_acc_score: 0.8764; val_best_f1_score: 0.8835; train_kl_reg_loss: 58699.8116; train_edge_recon_loss: 2717743.0947; train_gene_expr_recon_loss: 10426063.0455; train_masked_gp_l1_reg_loss: 67395.1609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66948.9461; train_chrom_access_recon_loss: 9127734.6212; train_global_loss: 22464584.7576; train_optim_loss: 22464584.7576; val_kl_reg_loss: 43377.1924; val_edge_recon_loss: 2735133.7188; val_gene_expr_recon_loss: 10438263.7500; val_masked_gp_l1_reg_loss: 66750.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66863.2969; val_chrom_access_recon_loss: 9163837.0000; val_global_loss: 22514224.2500; val_optim_loss: 22514224.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9338; val_auprc_score: 0.9140; val_best_acc_score: 0.8764; val_best_f1_score: 0.8834; train_kl_reg_loss: 58165.2808; train_edge_recon_loss: 2706632.8144; train_gene_expr_recon_loss: 10407265.0303; train_masked_gp_l1_reg_loss: 66102.4106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66485.5036; train_chrom_access_recon_loss: 9106058.5758; train_global_loss: 22410709.5152; train_optim_loss: 22410709.5152; val_kl_reg_loss: 46021.1919; val_edge_recon_loss: 2745696.2500; val_gene_expr_recon_loss: 10286261.0000; val_masked_gp_l1_reg_loss: 65508.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66612.9375; val_chrom_access_recon_loss: 9013700.8750; val_global_loss: 22223800.7500; val_optim_loss: 22223800.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9371; val_auprc_score: 0.9145; val_best_acc_score: 0.8783; val_best_f1_score: 0.8858; train_kl_reg_loss: 55503.4425; train_edge_recon_loss: 2705917.5152; train_gene_expr_recon_loss: 10386887.7424; train_masked_gp_l1_reg_loss: 64982.1618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66409.4223; train_chrom_access_recon_loss: 9073683.4394; train_global_loss: 22353383.6364; train_optim_loss: 22353383.6364; val_kl_reg_loss: 46685.1113; val_edge_recon_loss: 2719989.5625; val_gene_expr_recon_loss: 10287577.7500; val_masked_gp_l1_reg_loss: 64480.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66201.3828; val_chrom_access_recon_loss: 9080110.0000; val_global_loss: 22265043.7500; val_optim_loss: 22265043.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9358; val_auprc_score: 0.9116; val_best_acc_score: 0.8791; val_best_f1_score: 0.8867; train_kl_reg_loss: 54508.5546; train_edge_recon_loss: 2703016.9394; train_gene_expr_recon_loss: 10372219.8788; train_masked_gp_l1_reg_loss: 64024.6416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66341.2456; train_chrom_access_recon_loss: 9050667.7424; train_global_loss: 22310778.8182; train_optim_loss: 22310778.8182; val_kl_reg_loss: 47046.2671; val_edge_recon_loss: 2738280.0312; val_gene_expr_recon_loss: 10249990.8750; val_masked_gp_l1_reg_loss: 63618.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66128.2578; val_chrom_access_recon_loss: 9050552.5000; val_global_loss: 22215617.0000; val_optim_loss: 22215617.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9337; val_auprc_score: 0.9119; val_best_acc_score: 0.8756; val_best_f1_score: 0.8829; train_kl_reg_loss: 54667.0105; train_edge_recon_loss: 2701061.2083; train_gene_expr_recon_loss: 10354706.7727; train_masked_gp_l1_reg_loss: 63191.0598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66003.3204; train_chrom_access_recon_loss: 9038349.8788; train_global_loss: 22277979.4242; train_optim_loss: 22277979.4242; val_kl_reg_loss: 47982.4941; val_edge_recon_loss: 2727636.4688; val_gene_expr_recon_loss: 10268864.8750; val_masked_gp_l1_reg_loss: 62841.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66025.1953; val_chrom_access_recon_loss: 8990069.0000; val_global_loss: 22163418.7500; val_optim_loss: 22163418.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9402; val_auprc_score: 0.9148; val_best_acc_score: 0.8802; val_best_f1_score: 0.8843; train_kl_reg_loss: 53330.1810; train_edge_recon_loss: 2694610.1629; train_gene_expr_recon_loss: 10335472.0000; train_masked_gp_l1_reg_loss: 62436.2433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65791.9026; train_chrom_access_recon_loss: 9020087.5000; train_global_loss: 22231728.0000; train_optim_loss: 22231728.0000; val_kl_reg_loss: 46306.7104; val_edge_recon_loss: 2748779.5625; val_gene_expr_recon_loss: 10281513.0000; val_masked_gp_l1_reg_loss: 62097.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65616.8594; val_chrom_access_recon_loss: 8965340.1250; val_global_loss: 22169653.7500; val_optim_loss: 22169653.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9431; val_auprc_score: 0.9212; val_best_acc_score: 0.8839; val_best_f1_score: 0.8878; train_kl_reg_loss: 54472.2991; train_edge_recon_loss: 2703839.7538; train_gene_expr_recon_loss: 10323496.3182; train_masked_gp_l1_reg_loss: 61742.3650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65494.6796; train_chrom_access_recon_loss: 9012708.6364; train_global_loss: 22221753.9697; train_optim_loss: 22221753.9697; val_kl_reg_loss: 47414.1562; val_edge_recon_loss: 2716034.9688; val_gene_expr_recon_loss: 10229265.0000; val_masked_gp_l1_reg_loss: 61420.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65703.4766; val_chrom_access_recon_loss: 8991601.8750; val_global_loss: 22111439.5000; val_optim_loss: 22111439.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9382; val_auprc_score: 0.9152; val_best_acc_score: 0.8810; val_best_f1_score: 0.8857; train_kl_reg_loss: 53390.5732; train_edge_recon_loss: 2691925.8371; train_gene_expr_recon_loss: 10306771.1364; train_masked_gp_l1_reg_loss: 61173.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65500.2933; train_chrom_access_recon_loss: 8999048.7121; train_global_loss: 22177810.5758; train_optim_loss: 22177810.5758; val_kl_reg_loss: 44541.6719; val_edge_recon_loss: 2711169.7812; val_gene_expr_recon_loss: 10358936.0000; val_masked_gp_l1_reg_loss: 60970.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65524.2344; val_chrom_access_recon_loss: 9045196.8750; val_global_loss: 22286339.0000; val_optim_loss: 22286339.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9423; val_auprc_score: 0.9181; val_best_acc_score: 0.8885; val_best_f1_score: 0.8948; train_kl_reg_loss: 55408.7974; train_edge_recon_loss: 2694390.4962; train_gene_expr_recon_loss: 10292316.9394; train_masked_gp_l1_reg_loss: 60771.7253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65386.4403; train_chrom_access_recon_loss: 8982239.7576; train_global_loss: 22150514.3636; train_optim_loss: 22150514.3636; val_kl_reg_loss: 47204.8345; val_edge_recon_loss: 2720313.1875; val_gene_expr_recon_loss: 10239847.7500; val_masked_gp_l1_reg_loss: 60588.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65192.3086; val_chrom_access_recon_loss: 8940529.6250; val_global_loss: 22073676.5000; val_optim_loss: 22073676.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9421; val_auprc_score: 0.9164; val_best_acc_score: 0.8874; val_best_f1_score: 0.8926; train_kl_reg_loss: 53189.2937; train_edge_recon_loss: 2697762.4811; train_gene_expr_recon_loss: 10292568.2576; train_masked_gp_l1_reg_loss: 60377.8664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65167.9970; train_chrom_access_recon_loss: 8979376.3030; train_global_loss: 22148442.2727; train_optim_loss: 22148442.2727; val_kl_reg_loss: 46737.5527; val_edge_recon_loss: 2737318.0312; val_gene_expr_recon_loss: 10253404.6250; val_masked_gp_l1_reg_loss: 60202.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65379.6562; val_chrom_access_recon_loss: 8949931.5000; val_global_loss: 22112974.2500; val_optim_loss: 22112974.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9401; val_auprc_score: 0.9178; val_best_acc_score: 0.8842; val_best_f1_score: 0.8884; train_kl_reg_loss: 52623.1899; train_edge_recon_loss: 2692914.5568; train_gene_expr_recon_loss: 10283236.2727; train_masked_gp_l1_reg_loss: 60057.0631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65150.5199; train_chrom_access_recon_loss: 8980102.7727; train_global_loss: 22134084.5758; train_optim_loss: 22134084.5758; val_kl_reg_loss: 47506.8428; val_edge_recon_loss: 2736809.6875; val_gene_expr_recon_loss: 10190793.6250; val_masked_gp_l1_reg_loss: 59877.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65092.4297; val_chrom_access_recon_loss: 8947174.7500; val_global_loss: 22047254.7500; val_optim_loss: 22047254.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9504; val_auprc_score: 0.9321; val_best_acc_score: 0.8923; val_best_f1_score: 0.8982; train_kl_reg_loss: 52953.6001; train_edge_recon_loss: 2696608.0758; train_gene_expr_recon_loss: 10279756.8636; train_masked_gp_l1_reg_loss: 59698.6502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65122.0853; train_chrom_access_recon_loss: 8974832.3864; train_global_loss: 22128971.7576; train_optim_loss: 22128971.7576; val_kl_reg_loss: 46586.8701; val_edge_recon_loss: 2701005.6562; val_gene_expr_recon_loss: 10307533.2500; val_masked_gp_l1_reg_loss: 59564.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64847.0508; val_chrom_access_recon_loss: 9090062.5000; val_global_loss: 22269599.2500; val_optim_loss: 22269599.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9396; val_auprc_score: 0.9110; val_best_acc_score: 0.8837; val_best_f1_score: 0.8903; train_kl_reg_loss: 51470.1157; train_edge_recon_loss: 2699889.3447; train_gene_expr_recon_loss: 10254945.8788; train_masked_gp_l1_reg_loss: 59412.2846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64875.9472; train_chrom_access_recon_loss: 8944155.9545; train_global_loss: 22074749.4545; train_optim_loss: 22074749.4545; val_kl_reg_loss: 46546.2461; val_edge_recon_loss: 2746354.9375; val_gene_expr_recon_loss: 10170957.3750; val_masked_gp_l1_reg_loss: 59295.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64738.6641; val_chrom_access_recon_loss: 8960307.3750; val_global_loss: 22048200.5000; val_optim_loss: 22048200.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9471; val_auprc_score: 0.9225; val_best_acc_score: 0.8944; val_best_f1_score: 0.9003; train_kl_reg_loss: 51448.3952; train_edge_recon_loss: 2678243.1705; train_gene_expr_recon_loss: 10242519.4394; train_masked_gp_l1_reg_loss: 59131.4599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64872.1069; train_chrom_access_recon_loss: 8933591.0076; train_global_loss: 22029805.6667; train_optim_loss: 22029805.6667; val_kl_reg_loss: 46791.5200; val_edge_recon_loss: 2703011.8750; val_gene_expr_recon_loss: 10186144.0000; val_masked_gp_l1_reg_loss: 58935.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64909.3633; val_chrom_access_recon_loss: 8893668.6250; val_global_loss: 21953460.7500; val_optim_loss: 21953460.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9513; val_auprc_score: 0.9334; val_best_acc_score: 0.8923; val_best_f1_score: 0.8981; train_kl_reg_loss: 51964.2375; train_edge_recon_loss: 2675653.7424; train_gene_expr_recon_loss: 10226090.3939; train_masked_gp_l1_reg_loss: 58795.0366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64763.4675; train_chrom_access_recon_loss: 8912558.1212; train_global_loss: 21989824.8788; train_optim_loss: 21989824.8788; val_kl_reg_loss: 46413.8984; val_edge_recon_loss: 2700709.7500; val_gene_expr_recon_loss: 10198388.2500; val_masked_gp_l1_reg_loss: 58696.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64791.8828; val_chrom_access_recon_loss: 8902099.3750; val_global_loss: 21971099.0000; val_optim_loss: 21971099.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9528; val_auprc_score: 0.9369; val_best_acc_score: 0.8968; val_best_f1_score: 0.9000; train_kl_reg_loss: 50449.0762; train_edge_recon_loss: 2687680.5720; train_gene_expr_recon_loss: 10219038.6970; train_masked_gp_l1_reg_loss: 58548.9977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64812.0653; train_chrom_access_recon_loss: 8910838.9091; train_global_loss: 21991368.3939; train_optim_loss: 21991368.3939; val_kl_reg_loss: 45986.8159; val_edge_recon_loss: 2712988.6875; val_gene_expr_recon_loss: 10122681.2500; val_masked_gp_l1_reg_loss: 58422.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64760.6367; val_chrom_access_recon_loss: 8826898.1250; val_global_loss: 21831738.0000; val_optim_loss: 21831738.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9545; val_auprc_score: 0.9368; val_best_acc_score: 0.9009; val_best_f1_score: 0.9039; train_kl_reg_loss: 50709.7422; train_edge_recon_loss: 2697874.2424; train_gene_expr_recon_loss: 10208578.9394; train_masked_gp_l1_reg_loss: 58342.3050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64872.1921; train_chrom_access_recon_loss: 8898255.2500; train_global_loss: 21978632.8182; train_optim_loss: 21978632.8182; val_kl_reg_loss: 46859.7100; val_edge_recon_loss: 2681945.1562; val_gene_expr_recon_loss: 10182003.3750; val_masked_gp_l1_reg_loss: 58213.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64743.3477; val_chrom_access_recon_loss: 8896072.1250; val_global_loss: 21929836.2500; val_optim_loss: 21929836.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9522; val_auprc_score: 0.9288; val_best_acc_score: 0.8987; val_best_f1_score: 0.9014; train_kl_reg_loss: 50788.7232; train_edge_recon_loss: 2690615.0341; train_gene_expr_recon_loss: 10203940.4394; train_masked_gp_l1_reg_loss: 58110.8557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64711.7006; train_chrom_access_recon_loss: 8904245.6667; train_global_loss: 21972412.3939; train_optim_loss: 21972412.3939; val_kl_reg_loss: 46315.4751; val_edge_recon_loss: 2698920.6875; val_gene_expr_recon_loss: 10126083.7500; val_masked_gp_l1_reg_loss: 58002.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64612.5742; val_chrom_access_recon_loss: 8832221.0625; val_global_loss: 21826156.5000; val_optim_loss: 21826156.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9555; val_auprc_score: 0.9389; val_best_acc_score: 0.9003; val_best_f1_score: 0.9053; train_kl_reg_loss: 50124.7397; train_edge_recon_loss: 2686494.9886; train_gene_expr_recon_loss: 10204979.3636; train_masked_gp_l1_reg_loss: 57906.7109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64569.8581; train_chrom_access_recon_loss: 8898660.1364; train_global_loss: 21962735.8485; train_optim_loss: 21962735.8485; val_kl_reg_loss: 46558.2114; val_edge_recon_loss: 2685521.3750; val_gene_expr_recon_loss: 10268304.1250; val_masked_gp_l1_reg_loss: 57793.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64636.7812; val_chrom_access_recon_loss: 8899988.8750; val_global_loss: 22022803.7500; val_optim_loss: 22022803.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9482; val_auprc_score: 0.9281; val_best_acc_score: 0.8933; val_best_f1_score: 0.8980; train_kl_reg_loss: 49913.6820; train_edge_recon_loss: 2683615.8788; train_gene_expr_recon_loss: 10182457.5455; train_masked_gp_l1_reg_loss: 57694.6515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64658.0134; train_chrom_access_recon_loss: 8878986.3258; train_global_loss: 21917326.3030; train_optim_loss: 21917326.3030; val_kl_reg_loss: 46298.1875; val_edge_recon_loss: 2732939.7812; val_gene_expr_recon_loss: 10124250.1250; val_masked_gp_l1_reg_loss: 57562.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64460.3398; val_chrom_access_recon_loss: 8847586.7500; val_global_loss: 21873096.7500; val_optim_loss: 21873096.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9490; val_auprc_score: 0.9275; val_best_acc_score: 0.8947; val_best_f1_score: 0.8996; train_kl_reg_loss: 50645.3130; train_edge_recon_loss: 2669897.4848; train_gene_expr_recon_loss: 10187373.3030; train_masked_gp_l1_reg_loss: 57443.7844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64553.4432; train_chrom_access_recon_loss: 8885204.3333; train_global_loss: 21915117.5152; train_optim_loss: 21915117.5152; val_kl_reg_loss: 49657.5874; val_edge_recon_loss: 2715283.3750; val_gene_expr_recon_loss: 10232345.0000; val_masked_gp_l1_reg_loss: 57322.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64581.3906; val_chrom_access_recon_loss: 8890717.8750; val_global_loss: 22009906.7500; val_optim_loss: 22009906.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9523; val_auprc_score: 0.9352; val_best_acc_score: 0.9001; val_best_f1_score: 0.9032; train_kl_reg_loss: 49949.4216; train_edge_recon_loss: 2682116.4432; train_gene_expr_recon_loss: 10181681.0606; train_masked_gp_l1_reg_loss: 57214.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64491.9850; train_chrom_access_recon_loss: 8866618.1288; train_global_loss: 21902071.2727; train_optim_loss: 21902071.2727; val_kl_reg_loss: 45823.2998; val_edge_recon_loss: 2723304.2500; val_gene_expr_recon_loss: 10173348.8750; val_masked_gp_l1_reg_loss: 57134.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64870.2305; val_chrom_access_recon_loss: 8924569.3750; val_global_loss: 21989051.0000; val_optim_loss: 21989051.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9520; val_auprc_score: 0.9334; val_best_acc_score: 0.8998; val_best_f1_score: 0.9036; train_kl_reg_loss: 48765.1810; train_edge_recon_loss: 2674182.5227; train_gene_expr_recon_loss: 10177736.6061; train_masked_gp_l1_reg_loss: 56838.9150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55524.1978; train_chrom_access_recon_loss: 8868934.5530; train_global_loss: 21881981.8182; train_optim_loss: 21881981.8182; val_kl_reg_loss: 47158.1230; val_edge_recon_loss: 2696342.0625; val_gene_expr_recon_loss: 10167104.8750; val_masked_gp_l1_reg_loss: 56726.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53664.9141; val_chrom_access_recon_loss: 8941398.3750; val_global_loss: 21962395.7500; val_optim_loss: 21962395.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9528; val_auprc_score: 0.9294; val_best_acc_score: 0.8992; val_best_f1_score: 0.9009; train_kl_reg_loss: 49981.6602; train_edge_recon_loss: 2678779.1174; train_gene_expr_recon_loss: 10169667.8030; train_masked_gp_l1_reg_loss: 56700.5040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53441.9789; train_chrom_access_recon_loss: 8862759.7424; train_global_loss: 21871330.7576; train_optim_loss: 21871330.7576; val_kl_reg_loss: 47945.4009; val_edge_recon_loss: 2711666.5625; val_gene_expr_recon_loss: 10129226.1250; val_masked_gp_l1_reg_loss: 56678.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53251.7930; val_chrom_access_recon_loss: 8857925.0000; val_global_loss: 21856693.7500; val_optim_loss: 21856693.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9535; val_auprc_score: 0.9346; val_best_acc_score: 0.9014; val_best_f1_score: 0.9058; train_kl_reg_loss: 50338.8410; train_edge_recon_loss: 2670441.4091; train_gene_expr_recon_loss: 10169207.6818; train_masked_gp_l1_reg_loss: 56659.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53101.1234; train_chrom_access_recon_loss: 8861967.3636; train_global_loss: 21861716.3939; train_optim_loss: 21861716.3939; val_kl_reg_loss: 47867.9224; val_edge_recon_loss: 2716235.5000; val_gene_expr_recon_loss: 10139296.8750; val_masked_gp_l1_reg_loss: 56643.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52945.3125; val_chrom_access_recon_loss: 8855212.9375; val_global_loss: 21868202.2500; val_optim_loss: 21868202.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9491; val_auprc_score: 0.9301; val_best_acc_score: 0.8982; val_best_f1_score: 0.9023; train_kl_reg_loss: 50396.8074; train_edge_recon_loss: 2675594.6250; train_gene_expr_recon_loss: 10157657.6515; train_masked_gp_l1_reg_loss: 56628.1518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52891.5287; train_chrom_access_recon_loss: 8854580.7576; train_global_loss: 21847749.6364; train_optim_loss: 21847749.6364; val_kl_reg_loss: 47968.6152; val_edge_recon_loss: 2727746.5938; val_gene_expr_recon_loss: 10129950.6250; val_masked_gp_l1_reg_loss: 56619.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52807.3320; val_chrom_access_recon_loss: 8986587.6250; val_global_loss: 22001680.2500; val_optim_loss: 22001680.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 58 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9531
val AUPRC score: 0.9356
val best accuracy score: 0.8944
val best F1 score: 0.8980
val target rna MSE score: 2.4776
val source rna MSE score: 1.1038
val target atac MSE score: 0.3228
val source atac MSE score: 0.1351
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
