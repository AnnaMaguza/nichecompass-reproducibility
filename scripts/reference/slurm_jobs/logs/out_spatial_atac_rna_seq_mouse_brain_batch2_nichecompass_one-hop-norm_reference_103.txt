[True]
Run timestamp: 07082023_204052_103.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_103']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9142; val_auprc_score: 0.9233; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 17679.2581; train_edge_recon_loss: 350818.6632; train_gene_expr_recon_loss: 651309.7569; train_masked_gp_l1_reg_loss: 8668.5498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 267690.8681; train_global_loss: 1296167.0972; train_optim_loss: 1296167.0972; val_kl_reg_loss: 15905.4668; val_edge_recon_loss: 406499.7188; val_gene_expr_recon_loss: 590098.4375; val_masked_gp_l1_reg_loss: 7372.4199; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 261922.5625; val_global_loss: 1281798.6250; val_optim_loss: 1281798.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8916; val_auprc_score: 0.8997; val_best_acc_score: 0.5218; val_best_f1_score: 0.6764; train_kl_reg_loss: 13890.4672; train_edge_recon_loss: 356373.6840; train_gene_expr_recon_loss: 578026.4097; train_masked_gp_l1_reg_loss: 7015.7340; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263949.2031; train_global_loss: 1219255.5000; train_optim_loss: 1219255.5000; val_kl_reg_loss: 11704.5508; val_edge_recon_loss: 406395.5000; val_gene_expr_recon_loss: 543927.0000; val_masked_gp_l1_reg_loss: 6761.9805; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257838.1562; val_global_loss: 1226627.2500; val_optim_loss: 1226627.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8698; val_auprc_score: 0.8731; val_best_acc_score: 0.5461; val_best_f1_score: 0.6872; train_kl_reg_loss: 15179.9009; train_edge_recon_loss: 357722.4201; train_gene_expr_recon_loss: 533923.9861; train_masked_gp_l1_reg_loss: 6828.5716; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258895.2188; train_global_loss: 1172550.0972; train_optim_loss: 1172550.0972; val_kl_reg_loss: 16740.5195; val_edge_recon_loss: 406250.5625; val_gene_expr_recon_loss: 510677.5625; val_masked_gp_l1_reg_loss: 6934.7222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253897.4688; val_global_loss: 1194500.8750; val_optim_loss: 1194500.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8659; val_auprc_score: 0.8657; val_best_acc_score: 0.5737; val_best_f1_score: 0.6986; train_kl_reg_loss: 18447.9614; train_edge_recon_loss: 358602.4826; train_gene_expr_recon_loss: 503591.9653; train_masked_gp_l1_reg_loss: 6923.6222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256145.8264; train_global_loss: 1143711.9028; train_optim_loss: 1143711.9028; val_kl_reg_loss: 17896.7344; val_edge_recon_loss: 406028.8438; val_gene_expr_recon_loss: 489695.3125; val_masked_gp_l1_reg_loss: 6865.5474; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251188.2344; val_global_loss: 1171674.6250; val_optim_loss: 1171674.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8714; val_auprc_score: 0.8662; val_best_acc_score: 0.6320; val_best_f1_score: 0.7259; train_kl_reg_loss: 19210.7507; train_edge_recon_loss: 358473.2431; train_gene_expr_recon_loss: 485055.8333; train_masked_gp_l1_reg_loss: 6809.6714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252192.5694; train_global_loss: 1121742.0833; train_optim_loss: 1121742.0833; val_kl_reg_loss: 18909.2383; val_edge_recon_loss: 405392.5000; val_gene_expr_recon_loss: 474175.5625; val_masked_gp_l1_reg_loss: 6731.0410; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248999.9219; val_global_loss: 1154208.2500; val_optim_loss: 1154208.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8798; val_auprc_score: 0.8759; val_best_acc_score: 0.7404; val_best_f1_score: 0.7847; train_kl_reg_loss: 19313.6148; train_edge_recon_loss: 357871.5556; train_gene_expr_recon_loss: 475058.5660; train_masked_gp_l1_reg_loss: 6680.2606; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251149.0330; train_global_loss: 1110073.0278; train_optim_loss: 1110073.0278; val_kl_reg_loss: 18391.6758; val_edge_recon_loss: 403686.4688; val_gene_expr_recon_loss: 463143.3438; val_masked_gp_l1_reg_loss: 6611.7065; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247289.1875; val_global_loss: 1139122.3750; val_optim_loss: 1139122.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8772; val_auprc_score: 0.8713; val_best_acc_score: 0.7980; val_best_f1_score: 0.8108; train_kl_reg_loss: 19673.3490; train_edge_recon_loss: 357357.7188; train_gene_expr_recon_loss: 461301.4375; train_masked_gp_l1_reg_loss: 6577.8599; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248608.9792; train_global_loss: 1093519.3611; train_optim_loss: 1093519.3611; val_kl_reg_loss: 19467.8984; val_edge_recon_loss: 400352.8125; val_gene_expr_recon_loss: 453743.5000; val_masked_gp_l1_reg_loss: 6528.7803; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245830.1250; val_global_loss: 1125923.1250; val_optim_loss: 1125923.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8824; val_auprc_score: 0.8720; val_best_acc_score: 0.7695; val_best_f1_score: 0.8029; train_kl_reg_loss: 19832.7285; train_edge_recon_loss: 355645.4340; train_gene_expr_recon_loss: 453348.9549; train_masked_gp_l1_reg_loss: 6507.2216; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247664.2969; train_global_loss: 1082998.6111; train_optim_loss: 1082998.6111; val_kl_reg_loss: 18032.0508; val_edge_recon_loss: 392138.8438; val_gene_expr_recon_loss: 448565.5000; val_masked_gp_l1_reg_loss: 6471.8896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244720.2812; val_global_loss: 1109928.5000; val_optim_loss: 1109928.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8942; val_auprc_score: 0.8796; val_best_acc_score: 0.8145; val_best_f1_score: 0.8270; train_kl_reg_loss: 19190.9824; train_edge_recon_loss: 351517.6493; train_gene_expr_recon_loss: 447989.4236; train_masked_gp_l1_reg_loss: 6462.6203; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246046.3594; train_global_loss: 1071207.0625; train_optim_loss: 1071207.0625; val_kl_reg_loss: 18132.9316; val_edge_recon_loss: 368160.5312; val_gene_expr_recon_loss: 445395.9375; val_masked_gp_l1_reg_loss: 6446.0015; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244033.6875; val_global_loss: 1082169.0000; val_optim_loss: 1082169.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8910; val_auprc_score: 0.8769; val_best_acc_score: 0.8041; val_best_f1_score: 0.8191; train_kl_reg_loss: 20369.3509; train_edge_recon_loss: 335509.8924; train_gene_expr_recon_loss: 450289.4444; train_masked_gp_l1_reg_loss: 6455.5883; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247347.4809; train_global_loss: 1059971.7361; train_optim_loss: 1059971.7361; val_kl_reg_loss: 23367.0625; val_edge_recon_loss: 329271.2500; val_gene_expr_recon_loss: 445905.4062; val_masked_gp_l1_reg_loss: 6473.7295; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243880.2812; val_global_loss: 1048897.7500; val_optim_loss: 1048897.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9038; val_auprc_score: 0.8935; val_best_acc_score: 0.8094; val_best_f1_score: 0.8241; train_kl_reg_loss: 28286.8095; train_edge_recon_loss: 316201.7778; train_gene_expr_recon_loss: 446352.9375; train_masked_gp_l1_reg_loss: 6516.2061; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244735.3247; train_global_loss: 1042093.0764; train_optim_loss: 1042093.0764; val_kl_reg_loss: 27738.7773; val_edge_recon_loss: 312078.4062; val_gene_expr_recon_loss: 441057.5625; val_masked_gp_l1_reg_loss: 6559.6245; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242833.4531; val_global_loss: 1030267.8125; val_optim_loss: 1030267.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9037; val_auprc_score: 0.8896; val_best_acc_score: 0.8123; val_best_f1_score: 0.8242; train_kl_reg_loss: 27742.2747; train_edge_recon_loss: 311083.8646; train_gene_expr_recon_loss: 444369.4132; train_masked_gp_l1_reg_loss: 6591.9478; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244484.2795; train_global_loss: 1034271.7847; train_optim_loss: 1034271.7847; val_kl_reg_loss: 26922.9277; val_edge_recon_loss: 311348.2500; val_gene_expr_recon_loss: 437910.3750; val_masked_gp_l1_reg_loss: 6625.8828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242056.4375; val_global_loss: 1024863.8750; val_optim_loss: 1024863.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9188; val_auprc_score: 0.9017; val_best_acc_score: 0.8355; val_best_f1_score: 0.8427; train_kl_reg_loss: 27399.9065; train_edge_recon_loss: 307118.6632; train_gene_expr_recon_loss: 439684.2847; train_masked_gp_l1_reg_loss: 6658.4962; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243887.0451; train_global_loss: 1024748.4097; train_optim_loss: 1024748.4097; val_kl_reg_loss: 26156.9570; val_edge_recon_loss: 304237.7500; val_gene_expr_recon_loss: 436415.2500; val_masked_gp_l1_reg_loss: 6695.4629; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241631.1250; val_global_loss: 1015136.5625; val_optim_loss: 1015136.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9300; val_auprc_score: 0.9123; val_best_acc_score: 0.8537; val_best_f1_score: 0.8611; train_kl_reg_loss: 27174.2229; train_edge_recon_loss: 302241.2951; train_gene_expr_recon_loss: 437955.9965; train_masked_gp_l1_reg_loss: 6724.5083; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244642.9740; train_global_loss: 1018739.0139; train_optim_loss: 1018739.0139; val_kl_reg_loss: 25761.1523; val_edge_recon_loss: 302193.1250; val_gene_expr_recon_loss: 432967.0625; val_masked_gp_l1_reg_loss: 6751.6704; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240832.5156; val_global_loss: 1008505.5625; val_optim_loss: 1008505.5625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9454; val_auprc_score: 0.9364; val_best_acc_score: 0.8733; val_best_f1_score: 0.8770; train_kl_reg_loss: 26757.9284; train_edge_recon_loss: 299477.5660; train_gene_expr_recon_loss: 437947.0486; train_masked_gp_l1_reg_loss: 6775.5257; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243400.1562; train_global_loss: 1014358.2431; train_optim_loss: 1014358.2431; val_kl_reg_loss: 26282.2344; val_edge_recon_loss: 300776.9688; val_gene_expr_recon_loss: 431370.8125; val_masked_gp_l1_reg_loss: 6797.7812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240274.5156; val_global_loss: 1005502.2500; val_optim_loss: 1005502.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9473; val_auprc_score: 0.9344; val_best_acc_score: 0.8804; val_best_f1_score: 0.8856; train_kl_reg_loss: 26781.5482; train_edge_recon_loss: 297167.3438; train_gene_expr_recon_loss: 433430.0139; train_masked_gp_l1_reg_loss: 6821.4355; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243146.9236; train_global_loss: 1007347.2639; train_optim_loss: 1007347.2639; val_kl_reg_loss: 26594.4023; val_edge_recon_loss: 294197.5938; val_gene_expr_recon_loss: 430240.4688; val_masked_gp_l1_reg_loss: 6844.4507; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239833.7344; val_global_loss: 997710.6875; val_optim_loss: 997710.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9525; val_auprc_score: 0.9407; val_best_acc_score: 0.8890; val_best_f1_score: 0.8924; train_kl_reg_loss: 27133.6447; train_edge_recon_loss: 294040.0312; train_gene_expr_recon_loss: 431529.2396; train_masked_gp_l1_reg_loss: 6865.6535; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242060.4392; train_global_loss: 1001628.9931; train_optim_loss: 1001628.9931; val_kl_reg_loss: 27290.5156; val_edge_recon_loss: 295247.1875; val_gene_expr_recon_loss: 427744.3750; val_masked_gp_l1_reg_loss: 6886.2539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238910.9688; val_global_loss: 996079.2500; val_optim_loss: 996079.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9527; val_auprc_score: 0.9404; val_best_acc_score: 0.8879; val_best_f1_score: 0.8945; train_kl_reg_loss: 27230.3902; train_edge_recon_loss: 293001.6111; train_gene_expr_recon_loss: 431259.2257; train_masked_gp_l1_reg_loss: 6907.9019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241612.8472; train_global_loss: 1000011.9583; train_optim_loss: 1000011.9583; val_kl_reg_loss: 26615.5586; val_edge_recon_loss: 292986.4688; val_gene_expr_recon_loss: 426459.6250; val_masked_gp_l1_reg_loss: 6923.5835; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238555.2031; val_global_loss: 991540.3750; val_optim_loss: 991540.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9579; val_auprc_score: 0.9470; val_best_acc_score: 0.9015; val_best_f1_score: 0.9049; train_kl_reg_loss: 27340.4651; train_edge_recon_loss: 292183.7188; train_gene_expr_recon_loss: 428424.6979; train_masked_gp_l1_reg_loss: 6945.9807; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241373.9705; train_global_loss: 996268.8194; train_optim_loss: 996268.8194; val_kl_reg_loss: 26264.4844; val_edge_recon_loss: 292401.5938; val_gene_expr_recon_loss: 425496.0938; val_masked_gp_l1_reg_loss: 6961.7505; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238013.6406; val_global_loss: 989137.5000; val_optim_loss: 989137.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9601; val_auprc_score: 0.9471; val_best_acc_score: 0.9011; val_best_f1_score: 0.9055; train_kl_reg_loss: 26768.5725; train_edge_recon_loss: 291579.3056; train_gene_expr_recon_loss: 425724.4306; train_masked_gp_l1_reg_loss: 6983.1159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239409.7378; train_global_loss: 990465.1458; train_optim_loss: 990465.1458; val_kl_reg_loss: 26381.1719; val_edge_recon_loss: 289593.6875; val_gene_expr_recon_loss: 424686.8750; val_masked_gp_l1_reg_loss: 6999.3174; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237553.5938; val_global_loss: 985214.6250; val_optim_loss: 985214.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9586; val_auprc_score: 0.9475; val_best_acc_score: 0.9018; val_best_f1_score: 0.9056; train_kl_reg_loss: 26919.0920; train_edge_recon_loss: 290749.5729; train_gene_expr_recon_loss: 423978.5868; train_masked_gp_l1_reg_loss: 7017.1139; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239439.5139; train_global_loss: 988103.8819; train_optim_loss: 988103.8819; val_kl_reg_loss: 25511.8633; val_edge_recon_loss: 292215.9062; val_gene_expr_recon_loss: 424407.0312; val_masked_gp_l1_reg_loss: 7028.0767; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237397.5781; val_global_loss: 986560.4375; val_optim_loss: 986560.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9623; val_auprc_score: 0.9512; val_best_acc_score: 0.9041; val_best_f1_score: 0.9069; train_kl_reg_loss: 26405.1450; train_edge_recon_loss: 290545.9132; train_gene_expr_recon_loss: 421134.3958; train_masked_gp_l1_reg_loss: 7045.3344; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237722.3125; train_global_loss: 982853.0833; train_optim_loss: 982853.0833; val_kl_reg_loss: 26713.8828; val_edge_recon_loss: 290287.0625; val_gene_expr_recon_loss: 421145.8438; val_masked_gp_l1_reg_loss: 7055.0830; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236471.4844; val_global_loss: 981673.3125; val_optim_loss: 981673.3125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9611; val_auprc_score: 0.9475; val_best_acc_score: 0.9074; val_best_f1_score: 0.9109; train_kl_reg_loss: 26401.6395; train_edge_recon_loss: 289543.3993; train_gene_expr_recon_loss: 422125.9167; train_masked_gp_l1_reg_loss: 7071.6067; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239000.0694; train_global_loss: 984142.6250; train_optim_loss: 984142.6250; val_kl_reg_loss: 25680.9766; val_edge_recon_loss: 290059.0625; val_gene_expr_recon_loss: 421463.8750; val_masked_gp_l1_reg_loss: 7085.1982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236136.5938; val_global_loss: 980425.6250; val_optim_loss: 980425.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9671; val_auprc_score: 0.9561; val_best_acc_score: 0.9124; val_best_f1_score: 0.9159; train_kl_reg_loss: 26427.8644; train_edge_recon_loss: 289439.2708; train_gene_expr_recon_loss: 423661.3681; train_masked_gp_l1_reg_loss: 7102.9197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238452.3646; train_global_loss: 985083.7986; train_optim_loss: 985083.7986; val_kl_reg_loss: 25661.7168; val_edge_recon_loss: 288527.4375; val_gene_expr_recon_loss: 420720.5312; val_masked_gp_l1_reg_loss: 7114.9873; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235795.1406; val_global_loss: 977819.8125; val_optim_loss: 977819.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9711; val_auprc_score: 0.9627; val_best_acc_score: 0.9205; val_best_f1_score: 0.9231; train_kl_reg_loss: 26197.9115; train_edge_recon_loss: 288215.4896; train_gene_expr_recon_loss: 420240.7535; train_masked_gp_l1_reg_loss: 7133.0949; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237126.5260; train_global_loss: 978913.7847; train_optim_loss: 978913.7847; val_kl_reg_loss: 26251.0117; val_edge_recon_loss: 288123.9062; val_gene_expr_recon_loss: 418556.8125; val_masked_gp_l1_reg_loss: 7150.8525; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234885.3438; val_global_loss: 974968.0000; val_optim_loss: 974968.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9626; val_auprc_score: 0.9490; val_best_acc_score: 0.9108; val_best_f1_score: 0.9136; train_kl_reg_loss: 27838.6497; train_edge_recon_loss: 304405.6910; train_gene_expr_recon_loss: 436428.4896; train_masked_gp_l1_reg_loss: 7182.6737; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240056.3993; train_global_loss: 1015911.9097; train_optim_loss: 1015911.9097; val_kl_reg_loss: 13988.8057; val_edge_recon_loss: 295411.6562; val_gene_expr_recon_loss: 437897.5625; val_masked_gp_l1_reg_loss: 7188.0249; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238937.5312; val_global_loss: 993423.5000; val_optim_loss: 993423.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9713; val_auprc_score: 0.9636; val_best_acc_score: 0.9179; val_best_f1_score: 0.9193; train_kl_reg_loss: 24052.4970; train_edge_recon_loss: 293966.9028; train_gene_expr_recon_loss: 433084.0660; train_masked_gp_l1_reg_loss: 7180.5203; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240517.2986; train_global_loss: 998801.2847; train_optim_loss: 998801.2847; val_kl_reg_loss: 16215.4395; val_edge_recon_loss: 289660.6875; val_gene_expr_recon_loss: 432748.0000; val_masked_gp_l1_reg_loss: 7166.6108; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238187.7500; val_global_loss: 983978.5000; val_optim_loss: 983978.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9651; val_auprc_score: 0.9532; val_best_acc_score: 0.9123; val_best_f1_score: 0.9143; train_kl_reg_loss: 22639.4173; train_edge_recon_loss: 288662.5521; train_gene_expr_recon_loss: 430253.2083; train_masked_gp_l1_reg_loss: 7154.2198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239890.3663; train_global_loss: 988599.7708; train_optim_loss: 988599.7708; val_kl_reg_loss: 19066.4883; val_edge_recon_loss: 289658.9062; val_gene_expr_recon_loss: 429234.3750; val_masked_gp_l1_reg_loss: 7135.6250; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237529.1250; val_global_loss: 982624.5000; val_optim_loss: 982624.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9708; val_auprc_score: 0.9596; val_best_acc_score: 0.9184; val_best_f1_score: 0.9211; train_kl_reg_loss: 21931.9829; train_edge_recon_loss: 287444.2396; train_gene_expr_recon_loss: 426384.2431; train_masked_gp_l1_reg_loss: 7123.2840; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239190.9149; train_global_loss: 982074.6736; train_optim_loss: 982074.6736; val_kl_reg_loss: 19366.0664; val_edge_recon_loss: 286687.1250; val_gene_expr_recon_loss: 429149.6875; val_masked_gp_l1_reg_loss: 7106.9751; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237249.6875; val_global_loss: 979559.5625; val_optim_loss: 979559.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9669; val_auprc_score: 0.9565; val_best_acc_score: 0.9142; val_best_f1_score: 0.9179; train_kl_reg_loss: 22051.7270; train_edge_recon_loss: 285520.3160; train_gene_expr_recon_loss: 427426.0486; train_masked_gp_l1_reg_loss: 7074.9857; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239247.9809; train_global_loss: 981321.0625; train_optim_loss: 981321.0625; val_kl_reg_loss: 19597.9570; val_edge_recon_loss: 287592.2500; val_gene_expr_recon_loss: 428080.5625; val_masked_gp_l1_reg_loss: 7044.9033; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237161.4062; val_global_loss: 979477.0000; val_optim_loss: 979477.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9664; val_auprc_score: 0.9565; val_best_acc_score: 0.9151; val_best_f1_score: 0.9178; train_kl_reg_loss: 22236.0130; train_edge_recon_loss: 285176.5035; train_gene_expr_recon_loss: 426435.8785; train_masked_gp_l1_reg_loss: 7036.0421; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238698.3542; train_global_loss: 979582.7986; train_optim_loss: 979582.7986; val_kl_reg_loss: 19751.6289; val_edge_recon_loss: 287289.1875; val_gene_expr_recon_loss: 428361.9375; val_masked_gp_l1_reg_loss: 7022.6650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236990.1562; val_global_loss: 979415.6250; val_optim_loss: 979415.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9663; val_auprc_score: 0.9504; val_best_acc_score: 0.9173; val_best_f1_score: 0.9201; train_kl_reg_loss: 22261.7869; train_edge_recon_loss: 285551.8194; train_gene_expr_recon_loss: 426174.1910; train_masked_gp_l1_reg_loss: 7015.2871; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237886.9427; train_global_loss: 978890.0417; train_optim_loss: 978890.0417; val_kl_reg_loss: 19809.0273; val_edge_recon_loss: 287621.1250; val_gene_expr_recon_loss: 428159.5625; val_masked_gp_l1_reg_loss: 7006.8408; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237033.9375; val_global_loss: 979630.5000; val_optim_loss: 979630.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9662; val_auprc_score: 0.9516; val_best_acc_score: 0.9150; val_best_f1_score: 0.9187; train_kl_reg_loss: 22199.5666; train_edge_recon_loss: 285719.8819; train_gene_expr_recon_loss: 425069.6979; train_masked_gp_l1_reg_loss: 7001.9991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237504.2135; train_global_loss: 977495.3681; train_optim_loss: 977495.3681; val_kl_reg_loss: 19851.8398; val_edge_recon_loss: 285328.3750; val_gene_expr_recon_loss: 427891.0938; val_masked_gp_l1_reg_loss: 6996.7095; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236905.3281; val_global_loss: 976973.3125; val_optim_loss: 976973.3125

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 24 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9690
val AUPRC score: 0.9602
val best accuracy score: 0.9165
val best F1 score: 0.9193
val target rna MSE score: 0.5113
val source rna MSE score: 0.3144
val target atac MSE score: 0.1325
val source atac MSE score: 0.0205
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
