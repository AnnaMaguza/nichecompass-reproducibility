[True]
Run timestamp: 10102023_064207_175.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_175']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6328; val_auprc_score: 0.6256; val_best_acc_score: 0.5027; val_best_f1_score: 0.6675; train_kl_reg_loss: 76437.1990; train_edge_recon_loss: 750536.4527; train_gene_expr_recon_loss: 23455034.1212; train_masked_gp_l1_reg_loss: 58245.9102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6137492.8598; train_chrom_access_recon_loss: 2326617.1553; train_global_loss: 32804364.1515; train_optim_loss: 32804364.1515; val_kl_reg_loss: 89139.8789; val_edge_recon_loss: 813097.0391; val_gene_expr_recon_loss: 21414217.2500; val_masked_gp_l1_reg_loss: 65347.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3500931.7500; val_chrom_access_recon_loss: 2198004.0000; val_global_loss: 28080738.2500; val_optim_loss: 28080738.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6960; val_auprc_score: 0.6920; val_best_acc_score: 0.5594; val_best_f1_score: 0.6875; train_kl_reg_loss: 87608.8924; train_edge_recon_loss: 750644.9848; train_gene_expr_recon_loss: 21325917.9697; train_masked_gp_l1_reg_loss: 64759.0238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1954592.2169; train_chrom_access_recon_loss: 2208301.2159; train_global_loss: 26391824.3636; train_optim_loss: 26391824.3636; val_kl_reg_loss: 83299.3633; val_edge_recon_loss: 812365.0703; val_gene_expr_recon_loss: 20885425.7500; val_masked_gp_l1_reg_loss: 65098.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 963147.6875; val_chrom_access_recon_loss: 2153665.9844; val_global_loss: 24963002.0000; val_optim_loss: 24963002.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7547; val_auprc_score: 0.7450; val_best_acc_score: 0.6607; val_best_f1_score: 0.7084; train_kl_reg_loss: 80872.0543; train_edge_recon_loss: 737739.0758; train_gene_expr_recon_loss: 21075259.1515; train_masked_gp_l1_reg_loss: 65403.6864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 628509.4929; train_chrom_access_recon_loss: 2191361.1572; train_global_loss: 24779144.8182; train_optim_loss: 24779144.8182; val_kl_reg_loss: 75295.0459; val_edge_recon_loss: 809735.4375; val_gene_expr_recon_loss: 20921130.2500; val_masked_gp_l1_reg_loss: 65882.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 411093.6250; val_chrom_access_recon_loss: 2163480.0000; val_global_loss: 24446616.5000; val_optim_loss: 24446616.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8222; val_auprc_score: 0.8073; val_best_acc_score: 0.7055; val_best_f1_score: 0.7536; train_kl_reg_loss: 72755.7838; train_edge_recon_loss: 730908.8987; train_gene_expr_recon_loss: 20925523.3636; train_masked_gp_l1_reg_loss: 66466.0339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 318093.3111; train_chrom_access_recon_loss: 2178536.8011; train_global_loss: 24292284.3939; train_optim_loss: 24292284.3939; val_kl_reg_loss: 68907.2090; val_edge_recon_loss: 795092.8359; val_gene_expr_recon_loss: 20651814.0000; val_masked_gp_l1_reg_loss: 67288.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249199.8125; val_chrom_access_recon_loss: 2139833.6562; val_global_loss: 23972136.0000; val_optim_loss: 23972136.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8570; val_auprc_score: 0.8314; val_best_acc_score: 0.7826; val_best_f1_score: 0.7991; train_kl_reg_loss: 66825.3382; train_edge_recon_loss: 717932.4261; train_gene_expr_recon_loss: 20802686.8182; train_masked_gp_l1_reg_loss: 68173.0567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213020.8348; train_chrom_access_recon_loss: 2165309.2443; train_global_loss: 24033947.6667; train_optim_loss: 24033947.6667; val_kl_reg_loss: 64238.2788; val_edge_recon_loss: 743932.5703; val_gene_expr_recon_loss: 20840512.0000; val_masked_gp_l1_reg_loss: 69236.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185273.2344; val_chrom_access_recon_loss: 2151398.5781; val_global_loss: 24054591.7500; val_optim_loss: 24054591.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8796; val_auprc_score: 0.8527; val_best_acc_score: 0.8071; val_best_f1_score: 0.8238; train_kl_reg_loss: 67979.1726; train_edge_recon_loss: 680606.9792; train_gene_expr_recon_loss: 20663921.8182; train_masked_gp_l1_reg_loss: 70380.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173009.2699; train_chrom_access_recon_loss: 2153194.8920; train_global_loss: 23809092.5455; train_optim_loss: 23809092.5455; val_kl_reg_loss: 75714.0049; val_edge_recon_loss: 657937.4688; val_gene_expr_recon_loss: 20496864.5000; val_masked_gp_l1_reg_loss: 72213.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165174.1875; val_chrom_access_recon_loss: 2132330.6250; val_global_loss: 23600234.5000; val_optim_loss: 23600234.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8900; val_auprc_score: 0.8576; val_best_acc_score: 0.8205; val_best_f1_score: 0.8319; train_kl_reg_loss: 79557.3898; train_edge_recon_loss: 634751.3674; train_gene_expr_recon_loss: 20537082.2121; train_masked_gp_l1_reg_loss: 73230.9469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156396.3033; train_chrom_access_recon_loss: 2142081.7557; train_global_loss: 23623100.0000; train_optim_loss: 23623100.0000; val_kl_reg_loss: 77109.8838; val_edge_recon_loss: 631130.0625; val_gene_expr_recon_loss: 20343760.2500; val_masked_gp_l1_reg_loss: 74709.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149754.3906; val_chrom_access_recon_loss: 2115292.0156; val_global_loss: 23391756.7500; val_optim_loss: 23391756.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8944; val_auprc_score: 0.8637; val_best_acc_score: 0.8283; val_best_f1_score: 0.8407; train_kl_reg_loss: 80766.9751; train_edge_recon_loss: 623271.8059; train_gene_expr_recon_loss: 20422297.4242; train_masked_gp_l1_reg_loss: 75593.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145761.5852; train_chrom_access_recon_loss: 2130822.2064; train_global_loss: 23478514.0606; train_optim_loss: 23478514.0606; val_kl_reg_loss: 80438.8418; val_edge_recon_loss: 622531.5547; val_gene_expr_recon_loss: 20365034.5000; val_masked_gp_l1_reg_loss: 76348.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142462.5625; val_chrom_access_recon_loss: 2106279.6562; val_global_loss: 23393095.0000; val_optim_loss: 23393095.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9060; val_auprc_score: 0.8825; val_best_acc_score: 0.8364; val_best_f1_score: 0.8471; train_kl_reg_loss: 78954.8938; train_edge_recon_loss: 616720.7102; train_gene_expr_recon_loss: 20314556.5152; train_masked_gp_l1_reg_loss: 77127.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136284.3625; train_chrom_access_recon_loss: 2122567.2121; train_global_loss: 23346211.4545; train_optim_loss: 23346211.4545; val_kl_reg_loss: 78566.0586; val_edge_recon_loss: 620144.8281; val_gene_expr_recon_loss: 20373238.5000; val_masked_gp_l1_reg_loss: 77987.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131455.4062; val_chrom_access_recon_loss: 2116416.8906; val_global_loss: 23397810.2500; val_optim_loss: 23397810.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8948; val_auprc_score: 0.8632; val_best_acc_score: 0.8302; val_best_f1_score: 0.8436; train_kl_reg_loss: 77085.3996; train_edge_recon_loss: 613301.8040; train_gene_expr_recon_loss: 20236075.2727; train_masked_gp_l1_reg_loss: 78544.6986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127243.4639; train_chrom_access_recon_loss: 2115454.5587; train_global_loss: 23247705.1818; train_optim_loss: 23247705.1818; val_kl_reg_loss: 76583.3945; val_edge_recon_loss: 619067.9297; val_gene_expr_recon_loss: 20154581.0000; val_masked_gp_l1_reg_loss: 79211.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124838.3750; val_chrom_access_recon_loss: 2087755.3906; val_global_loss: 23142037.7500; val_optim_loss: 23142037.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9103; val_auprc_score: 0.8891; val_best_acc_score: 0.8420; val_best_f1_score: 0.8506; train_kl_reg_loss: 76217.0534; train_edge_recon_loss: 609751.7424; train_gene_expr_recon_loss: 20166630.6970; train_masked_gp_l1_reg_loss: 79718.9455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121301.9742; train_chrom_access_recon_loss: 2108480.4148; train_global_loss: 23162100.6061; train_optim_loss: 23162100.6061; val_kl_reg_loss: 75689.3848; val_edge_recon_loss: 610485.9531; val_gene_expr_recon_loss: 20126894.0000; val_masked_gp_l1_reg_loss: 80304.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119042.7578; val_chrom_access_recon_loss: 2097994.2500; val_global_loss: 23110409.7500; val_optim_loss: 23110409.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9162; val_auprc_score: 0.8918; val_best_acc_score: 0.8436; val_best_f1_score: 0.8536; train_kl_reg_loss: 74219.8877; train_edge_recon_loss: 606180.1676; train_gene_expr_recon_loss: 20094644.9394; train_masked_gp_l1_reg_loss: 80758.0865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117623.3252; train_chrom_access_recon_loss: 2102494.5739; train_global_loss: 23075920.9091; train_optim_loss: 23075920.9091; val_kl_reg_loss: 71088.3604; val_edge_recon_loss: 613541.4922; val_gene_expr_recon_loss: 19952359.7500; val_masked_gp_l1_reg_loss: 81310.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116492.9609; val_chrom_access_recon_loss: 2075099.0625; val_global_loss: 22909890.7500; val_optim_loss: 22909890.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9208; val_auprc_score: 0.9010; val_best_acc_score: 0.8549; val_best_f1_score: 0.8649; train_kl_reg_loss: 73838.8100; train_edge_recon_loss: 604154.2689; train_gene_expr_recon_loss: 20033669.5152; train_masked_gp_l1_reg_loss: 81555.3106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115562.8319; train_chrom_access_recon_loss: 2096526.1061; train_global_loss: 23005307.0303; train_optim_loss: 23005307.0303; val_kl_reg_loss: 70821.2686; val_edge_recon_loss: 605372.0078; val_gene_expr_recon_loss: 19977677.5000; val_masked_gp_l1_reg_loss: 82038.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115309.2344; val_chrom_access_recon_loss: 2088650.7500; val_global_loss: 22939869.7500; val_optim_loss: 22939869.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9217; val_auprc_score: 0.8974; val_best_acc_score: 0.8581; val_best_f1_score: 0.8642; train_kl_reg_loss: 72219.2598; train_edge_recon_loss: 600604.7784; train_gene_expr_recon_loss: 19961198.6970; train_masked_gp_l1_reg_loss: 82445.9500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113983.6132; train_chrom_access_recon_loss: 2089286.3106; train_global_loss: 22919738.5455; train_optim_loss: 22919738.5455; val_kl_reg_loss: 70285.6475; val_edge_recon_loss: 609823.8750; val_gene_expr_recon_loss: 20028911.7500; val_masked_gp_l1_reg_loss: 82723.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113061.1406; val_chrom_access_recon_loss: 2068008.3125; val_global_loss: 22972815.2500; val_optim_loss: 22972815.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9250; val_auprc_score: 0.9062; val_best_acc_score: 0.8576; val_best_f1_score: 0.8664; train_kl_reg_loss: 71119.9187; train_edge_recon_loss: 600143.2680; train_gene_expr_recon_loss: 19904288.1818; train_masked_gp_l1_reg_loss: 83290.3774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111746.6257; train_chrom_access_recon_loss: 2084530.2178; train_global_loss: 22855118.6364; train_optim_loss: 22855118.6364; val_kl_reg_loss: 70034.5576; val_edge_recon_loss: 605251.3438; val_gene_expr_recon_loss: 19832979.2500; val_masked_gp_l1_reg_loss: 83699.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110739.4375; val_chrom_access_recon_loss: 2070697.0781; val_global_loss: 22773402.7500; val_optim_loss: 22773402.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9287; val_auprc_score: 0.9106; val_best_acc_score: 0.8657; val_best_f1_score: 0.8736; train_kl_reg_loss: 70587.6064; train_edge_recon_loss: 598434.3788; train_gene_expr_recon_loss: 19845757.6667; train_masked_gp_l1_reg_loss: 83994.6323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109912.1325; train_chrom_access_recon_loss: 2077133.3466; train_global_loss: 22785819.8485; train_optim_loss: 22785819.8485; val_kl_reg_loss: 70496.1982; val_edge_recon_loss: 601539.1250; val_gene_expr_recon_loss: 19708838.2500; val_masked_gp_l1_reg_loss: 84445.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109381.7734; val_chrom_access_recon_loss: 2053239.9375; val_global_loss: 22627941.5000; val_optim_loss: 22627941.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9331; val_auprc_score: 0.9184; val_best_acc_score: 0.8675; val_best_f1_score: 0.8747; train_kl_reg_loss: 69812.8087; train_edge_recon_loss: 596635.4896; train_gene_expr_recon_loss: 19782027.2727; train_masked_gp_l1_reg_loss: 84636.3913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108188.8393; train_chrom_access_recon_loss: 2070816.1288; train_global_loss: 22712117.1212; train_optim_loss: 22712117.1212; val_kl_reg_loss: 68620.1504; val_edge_recon_loss: 606368.3359; val_gene_expr_recon_loss: 19758774.0000; val_masked_gp_l1_reg_loss: 85109.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108040.7266; val_chrom_access_recon_loss: 2035726.3906; val_global_loss: 22662638.7500; val_optim_loss: 22662638.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9288; val_auprc_score: 0.9077; val_best_acc_score: 0.8632; val_best_f1_score: 0.8700; train_kl_reg_loss: 69144.7921; train_edge_recon_loss: 594130.0568; train_gene_expr_recon_loss: 19738852.8182; train_masked_gp_l1_reg_loss: 85349.8240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106773.5354; train_chrom_access_recon_loss: 2068365.5720; train_global_loss: 22662616.6667; train_optim_loss: 22662616.6667; val_kl_reg_loss: 67919.7666; val_edge_recon_loss: 603214.2969; val_gene_expr_recon_loss: 19771610.0000; val_masked_gp_l1_reg_loss: 85599.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105858.8125; val_chrom_access_recon_loss: 2049166.8906; val_global_loss: 22683369.0000; val_optim_loss: 22683369.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9340; val_auprc_score: 0.9101; val_best_acc_score: 0.8692; val_best_f1_score: 0.8742; train_kl_reg_loss: 68036.3967; train_edge_recon_loss: 595314.2500; train_gene_expr_recon_loss: 19697191.4848; train_masked_gp_l1_reg_loss: 85797.4715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105449.1490; train_chrom_access_recon_loss: 2062830.1193; train_global_loss: 22614618.9394; train_optim_loss: 22614618.9394; val_kl_reg_loss: 67646.0508; val_edge_recon_loss: 601223.0078; val_gene_expr_recon_loss: 19887290.7500; val_masked_gp_l1_reg_loss: 86078.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105179.2109; val_chrom_access_recon_loss: 2089637.1875; val_global_loss: 22837055.0000; val_optim_loss: 22837055.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9386; val_auprc_score: 0.9195; val_best_acc_score: 0.8810; val_best_f1_score: 0.8865; train_kl_reg_loss: 68303.4857; train_edge_recon_loss: 592793.0663; train_gene_expr_recon_loss: 19625620.1212; train_masked_gp_l1_reg_loss: 86281.5180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104106.9263; train_chrom_access_recon_loss: 2052802.8409; train_global_loss: 22529908.2121; train_optim_loss: 22529908.2121; val_kl_reg_loss: 65907.7441; val_edge_recon_loss: 597300.5156; val_gene_expr_recon_loss: 19583415.0000; val_masked_gp_l1_reg_loss: 86619.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103661.5469; val_chrom_access_recon_loss: 2032598.1250; val_global_loss: 22469503.2500; val_optim_loss: 22469503.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9414; val_auprc_score: 0.9217; val_best_acc_score: 0.8847; val_best_f1_score: 0.8890; train_kl_reg_loss: 67443.6323; train_edge_recon_loss: 590865.2585; train_gene_expr_recon_loss: 19610611.0000; train_masked_gp_l1_reg_loss: 86789.8056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103473.7467; train_chrom_access_recon_loss: 2053075.2595; train_global_loss: 22512258.5758; train_optim_loss: 22512258.5758; val_kl_reg_loss: 67372.9805; val_edge_recon_loss: 592855.4609; val_gene_expr_recon_loss: 19742446.7500; val_masked_gp_l1_reg_loss: 86942.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102733.1250; val_chrom_access_recon_loss: 2063735.9844; val_global_loss: 22656087.0000; val_optim_loss: 22656087.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9442; val_auprc_score: 0.9261; val_best_acc_score: 0.8847; val_best_f1_score: 0.8891; train_kl_reg_loss: 67050.6408; train_edge_recon_loss: 590285.3807; train_gene_expr_recon_loss: 19567106.7273; train_masked_gp_l1_reg_loss: 87216.9589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103007.3520; train_chrom_access_recon_loss: 2048552.4640; train_global_loss: 22463219.5152; train_optim_loss: 22463219.5152; val_kl_reg_loss: 66560.2500; val_edge_recon_loss: 593846.5703; val_gene_expr_recon_loss: 19636750.0000; val_masked_gp_l1_reg_loss: 87489.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103138.4766; val_chrom_access_recon_loss: 2069028.3906; val_global_loss: 22556813.5000; val_optim_loss: 22556813.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9376; val_auprc_score: 0.9107; val_best_acc_score: 0.8799; val_best_f1_score: 0.8848; train_kl_reg_loss: 66852.5339; train_edge_recon_loss: 586736.9375; train_gene_expr_recon_loss: 19517063.5758; train_masked_gp_l1_reg_loss: 87676.4629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102772.5938; train_chrom_access_recon_loss: 2043550.6307; train_global_loss: 22404652.9091; train_optim_loss: 22404652.9091; val_kl_reg_loss: 66418.1650; val_edge_recon_loss: 600181.9609; val_gene_expr_recon_loss: 19381727.0000; val_masked_gp_l1_reg_loss: 87956.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103106.4844; val_chrom_access_recon_loss: 2033454.6719; val_global_loss: 22272843.7500; val_optim_loss: 22272843.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9433; val_auprc_score: 0.9284; val_best_acc_score: 0.8826; val_best_f1_score: 0.8870; train_kl_reg_loss: 66355.7449; train_edge_recon_loss: 587257.4811; train_gene_expr_recon_loss: 19475684.9394; train_masked_gp_l1_reg_loss: 88205.0792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102955.6959; train_chrom_access_recon_loss: 2036661.5208; train_global_loss: 22357120.6061; train_optim_loss: 22357120.6061; val_kl_reg_loss: 65191.8408; val_edge_recon_loss: 594197.7812; val_gene_expr_recon_loss: 19470824.7500; val_masked_gp_l1_reg_loss: 88400.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103087.6953; val_chrom_access_recon_loss: 2049124.6094; val_global_loss: 22370826.7500; val_optim_loss: 22370826.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9460; val_auprc_score: 0.9320; val_best_acc_score: 0.8839; val_best_f1_score: 0.8900; train_kl_reg_loss: 65302.7085; train_edge_recon_loss: 588725.2453; train_gene_expr_recon_loss: 19437170.7576; train_masked_gp_l1_reg_loss: 88670.9161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102930.6618; train_chrom_access_recon_loss: 2032800.0852; train_global_loss: 22315600.4848; train_optim_loss: 22315600.4848; val_kl_reg_loss: 66798.4912; val_edge_recon_loss: 589679.6172; val_gene_expr_recon_loss: 19587816.7500; val_masked_gp_l1_reg_loss: 88935.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103442.7266; val_chrom_access_recon_loss: 2017720.4844; val_global_loss: 22454393.5000; val_optim_loss: 22454393.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8914; val_auprc_score: 0.8526; val_best_acc_score: 0.8286; val_best_f1_score: 0.8440; train_kl_reg_loss: 42554.8212; train_edge_recon_loss: 716635.3816; train_gene_expr_recon_loss: 18432315.3333; train_masked_gp_l1_reg_loss: 91664.7480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113988.0511; train_chrom_access_recon_loss: 1924745.6174; train_global_loss: 21321903.9394; train_optim_loss: 21321903.9394; val_kl_reg_loss: 19418.9028; val_edge_recon_loss: 735880.7578; val_gene_expr_recon_loss: 17991065.0000; val_masked_gp_l1_reg_loss: 95900.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132857.2812; val_chrom_access_recon_loss: 1866118.2812; val_global_loss: 20841240.7500; val_optim_loss: 20841240.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8789; val_auprc_score: 0.8400; val_best_acc_score: 0.8106; val_best_f1_score: 0.8333; train_kl_reg_loss: 29855.8324; train_edge_recon_loss: 684327.4631; train_gene_expr_recon_loss: 18058863.6667; train_masked_gp_l1_reg_loss: 94024.8441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127394.0979; train_chrom_access_recon_loss: 1886263.0758; train_global_loss: 20880729.3030; train_optim_loss: 20880729.3030; val_kl_reg_loss: 20567.8076; val_edge_recon_loss: 671607.2969; val_gene_expr_recon_loss: 18016606.5000; val_masked_gp_l1_reg_loss: 91500.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122389.1875; val_chrom_access_recon_loss: 1874357.9688; val_global_loss: 20797030.0000; val_optim_loss: 20797030.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8818; val_auprc_score: 0.8478; val_best_acc_score: 0.8087; val_best_f1_score: 0.8323; train_kl_reg_loss: 33746.8277; train_edge_recon_loss: 641859.8456; train_gene_expr_recon_loss: 17981477.7879; train_masked_gp_l1_reg_loss: 89453.8788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117079.2012; train_chrom_access_recon_loss: 1879350.3977; train_global_loss: 20742967.6364; train_optim_loss: 20742967.6364; val_kl_reg_loss: 25839.7910; val_edge_recon_loss: 633813.6953; val_gene_expr_recon_loss: 17923274.5000; val_masked_gp_l1_reg_loss: 87567.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113097.9141; val_chrom_access_recon_loss: 1874825.0000; val_global_loss: 20658419.0000; val_optim_loss: 20658419.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8886; val_auprc_score: 0.8595; val_best_acc_score: 0.8090; val_best_f1_score: 0.8306; train_kl_reg_loss: 38077.4106; train_edge_recon_loss: 617133.7708; train_gene_expr_recon_loss: 17928928.1818; train_masked_gp_l1_reg_loss: 86173.2028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110303.3491; train_chrom_access_recon_loss: 1875791.4773; train_global_loss: 20656407.3939; train_optim_loss: 20656407.3939; val_kl_reg_loss: 30255.2134; val_edge_recon_loss: 620619.7578; val_gene_expr_recon_loss: 18047433.7500; val_masked_gp_l1_reg_loss: 84967.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107747.1250; val_chrom_access_recon_loss: 1866461.6562; val_global_loss: 20757486.2500; val_optim_loss: 20757486.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8901; val_auprc_score: 0.8598; val_best_acc_score: 0.8149; val_best_f1_score: 0.8339; train_kl_reg_loss: 40614.2902; train_edge_recon_loss: 607055.7036; train_gene_expr_recon_loss: 17898099.3333; train_masked_gp_l1_reg_loss: 83926.7652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106293.8712; train_chrom_access_recon_loss: 1873698.6042; train_global_loss: 20609688.6970; train_optim_loss: 20609688.6970; val_kl_reg_loss: 34545.2192; val_edge_recon_loss: 603716.8438; val_gene_expr_recon_loss: 17896325.7500; val_masked_gp_l1_reg_loss: 82904.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104777.9922; val_chrom_access_recon_loss: 1880638.7344; val_global_loss: 20602908.7500; val_optim_loss: 20602908.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8985; val_auprc_score: 0.8744; val_best_acc_score: 0.8192; val_best_f1_score: 0.8353; train_kl_reg_loss: 41760.7762; train_edge_recon_loss: 601964.7377; train_gene_expr_recon_loss: 17861433.9394; train_masked_gp_l1_reg_loss: 81905.7404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103422.4134; train_chrom_access_recon_loss: 1869492.5833; train_global_loss: 20559979.9394; train_optim_loss: 20559979.9394; val_kl_reg_loss: 38046.7832; val_edge_recon_loss: 599549.6172; val_gene_expr_recon_loss: 17639741.5000; val_masked_gp_l1_reg_loss: 80958.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101982.6953; val_chrom_access_recon_loss: 1860516.6250; val_global_loss: 20320794.5000; val_optim_loss: 20320794.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8882; val_auprc_score: 0.8563; val_best_acc_score: 0.8211; val_best_f1_score: 0.8406; train_kl_reg_loss: 43401.6998; train_edge_recon_loss: 596643.9602; train_gene_expr_recon_loss: 17839902.5758; train_masked_gp_l1_reg_loss: 80087.0121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101017.5639; train_chrom_access_recon_loss: 1867387.9640; train_global_loss: 20528440.6364; train_optim_loss: 20528440.6364; val_kl_reg_loss: 40573.6411; val_edge_recon_loss: 593853.8750; val_gene_expr_recon_loss: 17773369.0000; val_masked_gp_l1_reg_loss: 79359.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100104.1250; val_chrom_access_recon_loss: 1857079.5469; val_global_loss: 20444340.0000; val_optim_loss: 20444340.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9038; val_auprc_score: 0.8740; val_best_acc_score: 0.8318; val_best_f1_score: 0.8465; train_kl_reg_loss: 44522.7601; train_edge_recon_loss: 593196.5265; train_gene_expr_recon_loss: 17804963.6061; train_masked_gp_l1_reg_loss: 78531.6025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99232.5421; train_chrom_access_recon_loss: 1864343.4356; train_global_loss: 20484790.2424; train_optim_loss: 20484790.2424; val_kl_reg_loss: 42026.5859; val_edge_recon_loss: 589351.4531; val_gene_expr_recon_loss: 17835122.5000; val_masked_gp_l1_reg_loss: 77840.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99235.3359; val_chrom_access_recon_loss: 1842880.6250; val_global_loss: 20486457.7500; val_optim_loss: 20486457.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9027; val_auprc_score: 0.8706; val_best_acc_score: 0.8326; val_best_f1_score: 0.8433; train_kl_reg_loss: 44679.7855; train_edge_recon_loss: 592495.0502; train_gene_expr_recon_loss: 17783548.3182; train_masked_gp_l1_reg_loss: 77141.1027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98137.0795; train_chrom_access_recon_loss: 1861021.8523; train_global_loss: 20457023.0606; train_optim_loss: 20457023.0606; val_kl_reg_loss: 42479.3506; val_edge_recon_loss: 591006.3672; val_gene_expr_recon_loss: 17693250.5000; val_masked_gp_l1_reg_loss: 76591.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96964.6797; val_chrom_access_recon_loss: 1852320.2344; val_global_loss: 20352612.5000; val_optim_loss: 20352612.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9159; val_auprc_score: 0.8937; val_best_acc_score: 0.8466; val_best_f1_score: 0.8564; train_kl_reg_loss: 45111.6480; train_edge_recon_loss: 591884.6449; train_gene_expr_recon_loss: 17755420.9697; train_masked_gp_l1_reg_loss: 76047.9728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96727.5056; train_chrom_access_recon_loss: 1858928.5189; train_global_loss: 20424121.3939; train_optim_loss: 20424121.3939; val_kl_reg_loss: 42385.7441; val_edge_recon_loss: 587317.4297; val_gene_expr_recon_loss: 17745613.2500; val_masked_gp_l1_reg_loss: 75528.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96338.0078; val_chrom_access_recon_loss: 1844852.2812; val_global_loss: 20392034.7500; val_optim_loss: 20392034.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9085; val_auprc_score: 0.8821; val_best_acc_score: 0.8380; val_best_f1_score: 0.8466; train_kl_reg_loss: 45538.6461; train_edge_recon_loss: 587291.4479; train_gene_expr_recon_loss: 17747888.9091; train_masked_gp_l1_reg_loss: 74993.9421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80481.2906; train_chrom_access_recon_loss: 1857738.6458; train_global_loss: 20393932.9091; train_optim_loss: 20393932.9091; val_kl_reg_loss: 42790.2656; val_edge_recon_loss: 597014.2188; val_gene_expr_recon_loss: 17678814.5000; val_masked_gp_l1_reg_loss: 74728.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76527.5234; val_chrom_access_recon_loss: 1823410.2344; val_global_loss: 20293285.0000; val_optim_loss: 20293285.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9068; val_auprc_score: 0.8796; val_best_acc_score: 0.8356; val_best_f1_score: 0.8471; train_kl_reg_loss: 45867.5649; train_edge_recon_loss: 588980.3229; train_gene_expr_recon_loss: 17711487.0909; train_masked_gp_l1_reg_loss: 74638.0597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75851.0001; train_chrom_access_recon_loss: 1853927.0966; train_global_loss: 20350751.2121; train_optim_loss: 20350751.2121; val_kl_reg_loss: 43125.7593; val_edge_recon_loss: 592641.7422; val_gene_expr_recon_loss: 17841164.8750; val_masked_gp_l1_reg_loss: 74546.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75351.1172; val_chrom_access_recon_loss: 1845355.1875; val_global_loss: 20472185.2500; val_optim_loss: 20472185.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9112; val_auprc_score: 0.8846; val_best_acc_score: 0.8396; val_best_f1_score: 0.8511; train_kl_reg_loss: 46197.6776; train_edge_recon_loss: 588055.2093; train_gene_expr_recon_loss: 17721646.0606; train_masked_gp_l1_reg_loss: 74490.6423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75059.3356; train_chrom_access_recon_loss: 1854854.3125; train_global_loss: 20360303.1212; train_optim_loss: 20360303.1212; val_kl_reg_loss: 43534.3105; val_edge_recon_loss: 593699.3906; val_gene_expr_recon_loss: 17562892.0000; val_masked_gp_l1_reg_loss: 74427.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74671.9219; val_chrom_access_recon_loss: 1836229.1094; val_global_loss: 20185455.0000; val_optim_loss: 20185455.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9131; val_auprc_score: 0.8837; val_best_acc_score: 0.8420; val_best_f1_score: 0.8523; train_kl_reg_loss: 46395.3228; train_edge_recon_loss: 588318.2282; train_gene_expr_recon_loss: 17720587.8788; train_masked_gp_l1_reg_loss: 74374.8861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74480.5049; train_chrom_access_recon_loss: 1855322.0417; train_global_loss: 20359478.8182; train_optim_loss: 20359478.8182; val_kl_reg_loss: 43988.2300; val_edge_recon_loss: 589398.1406; val_gene_expr_recon_loss: 17772270.2500; val_masked_gp_l1_reg_loss: 74309.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74343.3984; val_chrom_access_recon_loss: 1852960.4688; val_global_loss: 20407271.5000; val_optim_loss: 20407271.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9089; val_auprc_score: 0.8819; val_best_acc_score: 0.8358; val_best_f1_score: 0.8469; train_kl_reg_loss: 46591.1948; train_edge_recon_loss: 588937.4138; train_gene_expr_recon_loss: 17722945.7879; train_masked_gp_l1_reg_loss: 74261.8240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74194.4870; train_chrom_access_recon_loss: 1854791.8333; train_global_loss: 20361722.6061; train_optim_loss: 20361722.6061; val_kl_reg_loss: 44071.6572; val_edge_recon_loss: 593870.0703; val_gene_expr_recon_loss: 17669663.5000; val_masked_gp_l1_reg_loss: 74209.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73975.7109; val_chrom_access_recon_loss: 1846626.7031; val_global_loss: 20302418.0000; val_optim_loss: 20302418.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9138; val_auprc_score: 0.8906; val_best_acc_score: 0.8415; val_best_f1_score: 0.8498; train_kl_reg_loss: 46815.4134; train_edge_recon_loss: 584474.1951; train_gene_expr_recon_loss: 17700488.3939; train_masked_gp_l1_reg_loss: 74153.3803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73811.4295; train_chrom_access_recon_loss: 1853610.3655; train_global_loss: 20333353.1515; train_optim_loss: 20333353.1515; val_kl_reg_loss: 44510.6841; val_edge_recon_loss: 593182.6797; val_gene_expr_recon_loss: 17756705.2500; val_masked_gp_l1_reg_loss: 74094.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73656.0938; val_chrom_access_recon_loss: 1841516.3750; val_global_loss: 20383665.2500; val_optim_loss: 20383665.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9204; val_auprc_score: 0.8943; val_best_acc_score: 0.8501; val_best_f1_score: 0.8567; train_kl_reg_loss: 46916.9561; train_edge_recon_loss: 585370.8542; train_gene_expr_recon_loss: 17720612.1515; train_masked_gp_l1_reg_loss: 74040.6484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73481.3107; train_chrom_access_recon_loss: 1854256.0189; train_global_loss: 20354678.0000; train_optim_loss: 20354678.0000; val_kl_reg_loss: 44696.8364; val_edge_recon_loss: 590773.4297; val_gene_expr_recon_loss: 17735681.0000; val_masked_gp_l1_reg_loss: 73993.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73335.9219; val_chrom_access_recon_loss: 1838888.1406; val_global_loss: 20357370.0000; val_optim_loss: 20357370.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9120; val_auprc_score: 0.8862; val_best_acc_score: 0.8380; val_best_f1_score: 0.8496; train_kl_reg_loss: 47139.3748; train_edge_recon_loss: 585288.6818; train_gene_expr_recon_loss: 17711305.7879; train_masked_gp_l1_reg_loss: 73939.0187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71707.6845; train_chrom_access_recon_loss: 1854715.2860; train_global_loss: 20344095.8485; train_optim_loss: 20344095.8485; val_kl_reg_loss: 44674.2061; val_edge_recon_loss: 595302.4922; val_gene_expr_recon_loss: 17682887.5000; val_masked_gp_l1_reg_loss: 73906.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71316.7891; val_chrom_access_recon_loss: 1844705.3750; val_global_loss: 20312791.2500; val_optim_loss: 20312791.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9135; val_auprc_score: 0.8857; val_best_acc_score: 0.8439; val_best_f1_score: 0.8516; train_kl_reg_loss: 47114.3232; train_edge_recon_loss: 586311.4384; train_gene_expr_recon_loss: 17711466.8485; train_masked_gp_l1_reg_loss: 73890.6141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71229.6907; train_chrom_access_recon_loss: 1852784.8220; train_global_loss: 20342797.6364; train_optim_loss: 20342797.6364; val_kl_reg_loss: 44925.8770; val_edge_recon_loss: 592764.2891; val_gene_expr_recon_loss: 17644254.0000; val_masked_gp_l1_reg_loss: 73876.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71154.4219; val_chrom_access_recon_loss: 1829700.5312; val_global_loss: 20256674.7500; val_optim_loss: 20256674.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9219; val_auprc_score: 0.9038; val_best_acc_score: 0.8463; val_best_f1_score: 0.8538; train_kl_reg_loss: 47138.5621; train_edge_recon_loss: 585966.2206; train_gene_expr_recon_loss: 17715695.9697; train_masked_gp_l1_reg_loss: 73866.9779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71093.2650; train_chrom_access_recon_loss: 1854668.2367; train_global_loss: 20348428.9091; train_optim_loss: 20348428.9091; val_kl_reg_loss: 44669.1187; val_edge_recon_loss: 590195.9062; val_gene_expr_recon_loss: 17624692.2500; val_masked_gp_l1_reg_loss: 73857.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71040.6172; val_chrom_access_recon_loss: 1850641.2812; val_global_loss: 20255096.5000; val_optim_loss: 20255096.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9186; val_auprc_score: 0.8959; val_best_acc_score: 0.8458; val_best_f1_score: 0.8532; train_kl_reg_loss: 47109.0015; train_edge_recon_loss: 586792.6146; train_gene_expr_recon_loss: 17722667.6970; train_masked_gp_l1_reg_loss: 73848.9903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70997.3246; train_chrom_access_recon_loss: 1854794.3352; train_global_loss: 20356210.0909; train_optim_loss: 20356210.0909; val_kl_reg_loss: 44640.6504; val_edge_recon_loss: 589448.0625; val_gene_expr_recon_loss: 17562858.6250; val_masked_gp_l1_reg_loss: 73839.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70952.4531; val_chrom_access_recon_loss: 1823376.5469; val_global_loss: 20165116.2500; val_optim_loss: 20165116.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9158; val_auprc_score: 0.8899; val_best_acc_score: 0.8471; val_best_f1_score: 0.8531; train_kl_reg_loss: 47058.9413; train_edge_recon_loss: 585336.2093; train_gene_expr_recon_loss: 17701845.6364; train_masked_gp_l1_reg_loss: 73833.0404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70922.9882; train_chrom_access_recon_loss: 1854424.4735; train_global_loss: 20333421.4242; train_optim_loss: 20333421.4242; val_kl_reg_loss: 44798.9370; val_edge_recon_loss: 590540.8438; val_gene_expr_recon_loss: 17654338.5000; val_masked_gp_l1_reg_loss: 73825.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70894.6406; val_chrom_access_recon_loss: 1836683.7188; val_global_loss: 20271082.2500; val_optim_loss: 20271082.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9141; val_auprc_score: 0.8891; val_best_acc_score: 0.8404; val_best_f1_score: 0.8482; train_kl_reg_loss: 47151.1175; train_edge_recon_loss: 585873.0227; train_gene_expr_recon_loss: 17692820.3939; train_masked_gp_l1_reg_loss: 73817.9517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70859.0348; train_chrom_access_recon_loss: 1851796.6269; train_global_loss: 20322317.9394; train_optim_loss: 20322317.9394; val_kl_reg_loss: 44779.9775; val_edge_recon_loss: 594911.1875; val_gene_expr_recon_loss: 17548460.7500; val_masked_gp_l1_reg_loss: 73810.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70827.2891; val_chrom_access_recon_loss: 1831827.0625; val_global_loss: 20164617.2500; val_optim_loss: 20164617.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9216; val_auprc_score: 0.9003; val_best_acc_score: 0.8509; val_best_f1_score: 0.8572; train_kl_reg_loss: 47082.7988; train_edge_recon_loss: 587909.2443; train_gene_expr_recon_loss: 17702031.0606; train_masked_gp_l1_reg_loss: 73803.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70810.4882; train_chrom_access_recon_loss: 1852498.5133; train_global_loss: 20334135.9697; train_optim_loss: 20334135.9697; val_kl_reg_loss: 44696.2148; val_edge_recon_loss: 589426.1953; val_gene_expr_recon_loss: 17700422.5000; val_masked_gp_l1_reg_loss: 73795.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70778.6641; val_chrom_access_recon_loss: 1851424.4062; val_global_loss: 20330542.7500; val_optim_loss: 20330542.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9201; val_auprc_score: 0.9064; val_best_acc_score: 0.8442; val_best_f1_score: 0.8515; train_kl_reg_loss: 47115.4778; train_edge_recon_loss: 586989.6790; train_gene_expr_recon_loss: 17714865.5152; train_masked_gp_l1_reg_loss: 73790.1464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70760.2801; train_chrom_access_recon_loss: 1853228.2235; train_global_loss: 20346749.3939; train_optim_loss: 20346749.3939; val_kl_reg_loss: 44702.9697; val_edge_recon_loss: 594340.9062; val_gene_expr_recon_loss: 17737452.2500; val_masked_gp_l1_reg_loss: 73781.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70736.9219; val_chrom_access_recon_loss: 1847921.8281; val_global_loss: 20368936.0000; val_optim_loss: 20368936.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9204; val_auprc_score: 0.8968; val_best_acc_score: 0.8458; val_best_f1_score: 0.8546; train_kl_reg_loss: 47146.5045; train_edge_recon_loss: 586946.3390; train_gene_expr_recon_loss: 17715331.2121; train_masked_gp_l1_reg_loss: 73775.2133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70721.7801; train_chrom_access_recon_loss: 1854439.4432; train_global_loss: 20348360.4545; train_optim_loss: 20348360.4545; val_kl_reg_loss: 44633.3140; val_edge_recon_loss: 591266.9375; val_gene_expr_recon_loss: 17717687.0000; val_masked_gp_l1_reg_loss: 73767.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70706.6406; val_chrom_access_recon_loss: 1851865.5938; val_global_loss: 20349926.7500; val_optim_loss: 20349926.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9196; val_auprc_score: 0.8947; val_best_acc_score: 0.8409; val_best_f1_score: 0.8513; train_kl_reg_loss: 47134.9268; train_edge_recon_loss: 589260.0871; train_gene_expr_recon_loss: 17711805.1212; train_masked_gp_l1_reg_loss: 73761.0941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70684.6973; train_chrom_access_recon_loss: 1855655.7670; train_global_loss: 20348301.8485; train_optim_loss: 20348301.8485; val_kl_reg_loss: 45191.4092; val_edge_recon_loss: 588265.0625; val_gene_expr_recon_loss: 17801036.0000; val_masked_gp_l1_reg_loss: 73753.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70658.4141; val_chrom_access_recon_loss: 1857837.2969; val_global_loss: 20436742.2500; val_optim_loss: 20436742.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9210; val_auprc_score: 0.8973; val_best_acc_score: 0.8546; val_best_f1_score: 0.8616; train_kl_reg_loss: 47112.9391; train_edge_recon_loss: 586123.8977; train_gene_expr_recon_loss: 17700356.4848; train_masked_gp_l1_reg_loss: 73748.0964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70491.5388; train_chrom_access_recon_loss: 1853516.4962; train_global_loss: 20331349.3636; train_optim_loss: 20331349.3636; val_kl_reg_loss: 44907.3779; val_edge_recon_loss: 588739.4922; val_gene_expr_recon_loss: 17920417.5000; val_masked_gp_l1_reg_loss: 73744.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70452.3516; val_chrom_access_recon_loss: 1848783.0781; val_global_loss: 20547043.2500; val_optim_loss: 20547043.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9112; val_auprc_score: 0.8894; val_best_acc_score: 0.8393; val_best_f1_score: 0.8473; train_kl_reg_loss: 47140.1258; train_edge_recon_loss: 586592.7330; train_gene_expr_recon_loss: 17716624.1212; train_masked_gp_l1_reg_loss: 73743.3530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70443.8456; train_chrom_access_recon_loss: 1854681.3902; train_global_loss: 20349225.5455; train_optim_loss: 20349225.5455; val_kl_reg_loss: 45167.6475; val_edge_recon_loss: 594387.3359; val_gene_expr_recon_loss: 17804697.2500; val_masked_gp_l1_reg_loss: 73741.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70436.5078; val_chrom_access_recon_loss: 1843072.3125; val_global_loss: 20431502.2500; val_optim_loss: 20431502.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9153; val_auprc_score: 0.8866; val_best_acc_score: 0.8442; val_best_f1_score: 0.8527; train_kl_reg_loss: 47134.1990; train_edge_recon_loss: 586743.8078; train_gene_expr_recon_loss: 17704566.4545; train_masked_gp_l1_reg_loss: 73740.9589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70430.8048; train_chrom_access_recon_loss: 1853512.6117; train_global_loss: 20336128.9394; train_optim_loss: 20336128.9394; val_kl_reg_loss: 44403.9717; val_edge_recon_loss: 595677.6875; val_gene_expr_recon_loss: 17756730.7500; val_masked_gp_l1_reg_loss: 73739.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70424.9688; val_chrom_access_recon_loss: 1841367.8438; val_global_loss: 20382344.2500; val_optim_loss: 20382344.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9232; val_auprc_score: 0.9037; val_best_acc_score: 0.8485; val_best_f1_score: 0.8593; train_kl_reg_loss: 47107.1870; train_edge_recon_loss: 585658.0294; train_gene_expr_recon_loss: 17709858.7273; train_masked_gp_l1_reg_loss: 73738.6562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70421.2602; train_chrom_access_recon_loss: 1853577.5587; train_global_loss: 20340361.4848; train_optim_loss: 20340361.4848; val_kl_reg_loss: 44746.3926; val_edge_recon_loss: 586325.1250; val_gene_expr_recon_loss: 17596956.0000; val_masked_gp_l1_reg_loss: 73737.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70416.3359; val_chrom_access_recon_loss: 1841605.4688; val_global_loss: 20213787.2500; val_optim_loss: 20213787.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 20 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9216
val AUPRC score: 0.9016
val best accuracy score: 0.8509
val best F1 score: 0.8576
val target rna MSE score: 1.7411
val source rna MSE score: 0.9666
val target atac MSE score: 0.3229
val source atac MSE score: 0.1362
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
