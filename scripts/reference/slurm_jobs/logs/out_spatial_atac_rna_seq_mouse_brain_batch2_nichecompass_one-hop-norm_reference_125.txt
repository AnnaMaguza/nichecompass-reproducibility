[True]
Run timestamp: 29072023_125810_125.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_125']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8817; val_auprc_score: 0.9001; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 44037.5773; train_edge_recon_loss: 34800957.3333; train_gene_expr_recon_loss: 822718.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 184282684.4444; train_global_loss: 219950398.2222; train_optim_loss: 219950398.2222; val_kl_reg_loss: 40812.4492; val_edge_recon_loss: 40654568.0000; val_gene_expr_recon_loss: 783100.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173720768.0000; val_global_loss: 215199248.0000; val_optim_loss: 215199248.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8767; val_auprc_score: 0.8945; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 62683.5955; train_edge_recon_loss: 34891496.4444; train_gene_expr_recon_loss: 765488.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 173987939.5556; train_global_loss: 209707605.3333; train_optim_loss: 209707605.3333; val_kl_reg_loss: 24985.1836; val_edge_recon_loss: 40655832.0000; val_gene_expr_recon_loss: 761888.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171768928.0000; val_global_loss: 213211632.0000; val_optim_loss: 213211632.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8761; val_auprc_score: 0.8917; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 63095.6289; train_edge_recon_loss: 34887353.7778; train_gene_expr_recon_loss: 750020.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 171826266.6667; train_global_loss: 207526737.7778; train_optim_loss: 207526737.7778; val_kl_reg_loss: 45804.6289; val_edge_recon_loss: 40657656.0000; val_gene_expr_recon_loss: 753263.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 170326288.0000; val_global_loss: 211783008.0000; val_optim_loss: 211783008.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8682; val_auprc_score: 0.8773; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 98915.1636; train_edge_recon_loss: 34897011.1111; train_gene_expr_recon_loss: 741056.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168752483.5556; train_global_loss: 204489464.8889; train_optim_loss: 204489464.8889; val_kl_reg_loss: 72438.0312; val_edge_recon_loss: 40657952.0000; val_gene_expr_recon_loss: 730686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168489024.0000; val_global_loss: 209950112.0000; val_optim_loss: 209950112.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8667; val_auprc_score: 0.8769; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 158185.3472; train_edge_recon_loss: 34849389.7778; train_gene_expr_recon_loss: 713292.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168246752.0000; train_global_loss: 203967617.7778; train_optim_loss: 203967617.7778; val_kl_reg_loss: 203431.7500; val_edge_recon_loss: 40658880.0000; val_gene_expr_recon_loss: 709642.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166753392.0000; val_global_loss: 208325344.0000; val_optim_loss: 208325344.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8524; val_auprc_score: 0.8654; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 226128.0868; train_edge_recon_loss: 34858022.6667; train_gene_expr_recon_loss: 697106.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166172392.8889; train_global_loss: 201953649.7778; train_optim_loss: 201953649.7778; val_kl_reg_loss: 262258.0312; val_edge_recon_loss: 40659584.0000; val_gene_expr_recon_loss: 695936.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164936256.0000; val_global_loss: 206554032.0000; val_optim_loss: 206554032.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8636; val_auprc_score: 0.8756; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 249175.8438; train_edge_recon_loss: 34890187.5556; train_gene_expr_recon_loss: 680513.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164530734.2222; train_global_loss: 200350611.5556; train_optim_loss: 200350611.5556; val_kl_reg_loss: 233897.3438; val_edge_recon_loss: 40659904.0000; val_gene_expr_recon_loss: 678036.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163427616.0000; val_global_loss: 204999456.0000; val_optim_loss: 204999456.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8643; val_auprc_score: 0.8763; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 281710.2587; train_edge_recon_loss: 34869027.1111; train_gene_expr_recon_loss: 657125.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161891987.5556; train_global_loss: 197699850.6667; train_optim_loss: 197699850.6667; val_kl_reg_loss: 257821.6406; val_edge_recon_loss: 40660116.0000; val_gene_expr_recon_loss: 659979.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162355280.0000; val_global_loss: 203933200.0000; val_optim_loss: 203933200.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8694; val_auprc_score: 0.8767; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 301550.5990; train_edge_recon_loss: 34865551.5556; train_gene_expr_recon_loss: 642363.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161143077.3333; train_global_loss: 196952544.0000; train_optim_loss: 196952544.0000; val_kl_reg_loss: 231063.2188; val_edge_recon_loss: 40659708.0000; val_gene_expr_recon_loss: 640862.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160920928.0000; val_global_loss: 202452560.0000; val_optim_loss: 202452560.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8706; val_auprc_score: 0.8786; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 282109.6406; train_edge_recon_loss: 34820106.6667; train_gene_expr_recon_loss: 621861.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160948659.5556; train_global_loss: 196672736.0000; train_optim_loss: 196672736.0000; val_kl_reg_loss: 268152.4375; val_edge_recon_loss: 40659080.0000; val_gene_expr_recon_loss: 616798.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159779360.0000; val_global_loss: 201323392.0000; val_optim_loss: 201323392.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8619; val_auprc_score: 0.8637; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 286886.2292; train_edge_recon_loss: 34845349.3333; train_gene_expr_recon_loss: 595942.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158665738.6667; train_global_loss: 194393912.8889; train_optim_loss: 194393912.8889; val_kl_reg_loss: 245844.4688; val_edge_recon_loss: 40658368.0000; val_gene_expr_recon_loss: 591552.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158559872.0000; val_global_loss: 200055632.0000; val_optim_loss: 200055632.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8594; val_auprc_score: 0.8665; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 288045.4479; train_edge_recon_loss: 34806641.3333; train_gene_expr_recon_loss: 571026.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157630316.4444; train_global_loss: 193296030.2222; train_optim_loss: 193296030.2222; val_kl_reg_loss: 245255.4062; val_edge_recon_loss: 40657164.0000; val_gene_expr_recon_loss: 565653.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157414496.0000; val_global_loss: 198882560.0000; val_optim_loss: 198882560.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8549; val_auprc_score: 0.8612; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 288040.3073; train_edge_recon_loss: 34837054.2222; train_gene_expr_recon_loss: 548620.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157455767.1111; train_global_loss: 193129480.8889; train_optim_loss: 193129480.8889; val_kl_reg_loss: 226485.5625; val_edge_recon_loss: 40655220.0000; val_gene_expr_recon_loss: 543320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156250816.0000; val_global_loss: 197675840.0000; val_optim_loss: 197675840.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8493; val_auprc_score: 0.8490; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 269456.7517; train_edge_recon_loss: 34822721.3333; train_gene_expr_recon_loss: 524679.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155715130.6667; train_global_loss: 191331985.7778; train_optim_loss: 191331985.7778; val_kl_reg_loss: 239566.3125; val_edge_recon_loss: 40654252.0000; val_gene_expr_recon_loss: 521004.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155953632.0000; val_global_loss: 197368448.0000; val_optim_loss: 197368448.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8511; val_auprc_score: 0.8533; val_best_acc_score: 0.5109; val_best_f1_score: 0.6716; train_kl_reg_loss: 264774.7361; train_edge_recon_loss: 34808105.3333; train_gene_expr_recon_loss: 506994.4653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155832167.1111; train_global_loss: 191412042.6667; train_optim_loss: 191412042.6667; val_kl_reg_loss: 214918.3438; val_edge_recon_loss: 40651144.0000; val_gene_expr_recon_loss: 504862.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154982624.0000; val_global_loss: 196353552.0000; val_optim_loss: 196353552.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8389; val_auprc_score: 0.8377; val_best_acc_score: 0.5132; val_best_f1_score: 0.6726; train_kl_reg_loss: 258966.7708; train_edge_recon_loss: 34814488.0000; train_gene_expr_recon_loss: 490179.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155329424.0000; train_global_loss: 190893061.3333; train_optim_loss: 190893061.3333; val_kl_reg_loss: 205152.4219; val_edge_recon_loss: 40649516.0000; val_gene_expr_recon_loss: 490762.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154660048.0000; val_global_loss: 196005472.0000; val_optim_loss: 196005472.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8411; val_auprc_score: 0.8395; val_best_acc_score: 0.5178; val_best_f1_score: 0.6746; train_kl_reg_loss: 252924.7743; train_edge_recon_loss: 34814850.2222; train_gene_expr_recon_loss: 475462.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154348808.8889; train_global_loss: 189892044.4444; train_optim_loss: 189892044.4444; val_kl_reg_loss: 197070.0625; val_edge_recon_loss: 40645372.0000; val_gene_expr_recon_loss: 478470.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154326240.0000; val_global_loss: 195647152.0000; val_optim_loss: 195647152.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8392; val_auprc_score: 0.8332; val_best_acc_score: 0.5259; val_best_f1_score: 0.6782; train_kl_reg_loss: 247786.8906; train_edge_recon_loss: 34803180.4444; train_gene_expr_recon_loss: 465733.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154424183.1111; train_global_loss: 189940883.5556; train_optim_loss: 189940883.5556; val_kl_reg_loss: 194680.2188; val_edge_recon_loss: 40640184.0000; val_gene_expr_recon_loss: 466116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154069312.0000; val_global_loss: 195370288.0000; val_optim_loss: 195370288.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8416; val_auprc_score: 0.8305; val_best_acc_score: 0.5334; val_best_f1_score: 0.6812; train_kl_reg_loss: 244013.5642; train_edge_recon_loss: 34790264.8889; train_gene_expr_recon_loss: 454931.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154859909.3333; train_global_loss: 190349120.0000; train_optim_loss: 190349120.0000; val_kl_reg_loss: 177796.3438; val_edge_recon_loss: 40633780.0000; val_gene_expr_recon_loss: 457606.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153417584.0000; val_global_loss: 194686768.0000; val_optim_loss: 194686768.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8370; val_auprc_score: 0.8244; val_best_acc_score: 0.5492; val_best_f1_score: 0.6881; train_kl_reg_loss: 236884.9757; train_edge_recon_loss: 34799300.0000; train_gene_expr_recon_loss: 445229.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153510696.8889; train_global_loss: 188992112.0000; train_optim_loss: 188992112.0000; val_kl_reg_loss: 189383.5156; val_edge_recon_loss: 40624100.0000; val_gene_expr_recon_loss: 449549.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153370240.0000; val_global_loss: 194633280.0000; val_optim_loss: 194633280.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8364; val_auprc_score: 0.8232; val_best_acc_score: 0.5706; val_best_f1_score: 0.6975; train_kl_reg_loss: 231567.6267; train_edge_recon_loss: 34775935.1111; train_gene_expr_recon_loss: 441255.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153632408.8889; train_global_loss: 189081166.2222; train_optim_loss: 189081166.2222; val_kl_reg_loss: 188945.8438; val_edge_recon_loss: 40612472.0000; val_gene_expr_recon_loss: 443381.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153401728.0000; val_global_loss: 194646528.0000; val_optim_loss: 194646528.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8326; val_auprc_score: 0.8201; val_best_acc_score: 0.5966; val_best_f1_score: 0.7094; train_kl_reg_loss: 231519.1285; train_edge_recon_loss: 34780368.4444; train_gene_expr_recon_loss: 433056.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153508618.6667; train_global_loss: 188953566.2222; train_optim_loss: 188953566.2222; val_kl_reg_loss: 167437.7656; val_edge_recon_loss: 40599556.0000; val_gene_expr_recon_loss: 438310.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153058464.0000; val_global_loss: 194263776.0000; val_optim_loss: 194263776.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8368; val_auprc_score: 0.8181; val_best_acc_score: 0.6319; val_best_f1_score: 0.7258; train_kl_reg_loss: 225535.1997; train_edge_recon_loss: 34772518.6667; train_gene_expr_recon_loss: 429396.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152831365.3333; train_global_loss: 188258817.7778; train_optim_loss: 188258817.7778; val_kl_reg_loss: 169247.0781; val_edge_recon_loss: 40578164.0000; val_gene_expr_recon_loss: 435604.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152852912.0000; val_global_loss: 194035936.0000; val_optim_loss: 194035936.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8269; val_auprc_score: 0.8117; val_best_acc_score: 0.6583; val_best_f1_score: 0.7380; train_kl_reg_loss: 223611.9965; train_edge_recon_loss: 34763320.4444; train_gene_expr_recon_loss: 424129.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153146215.1111; train_global_loss: 188557276.4444; train_optim_loss: 188557276.4444; val_kl_reg_loss: 161785.2500; val_edge_recon_loss: 40551488.0000; val_gene_expr_recon_loss: 431759.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152628032.0000; val_global_loss: 193773056.0000; val_optim_loss: 193773056.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8284; val_auprc_score: 0.8136; val_best_acc_score: 0.6931; val_best_f1_score: 0.7540; train_kl_reg_loss: 217985.5069; train_edge_recon_loss: 34728600.8889; train_gene_expr_recon_loss: 420160.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152537242.6667; train_global_loss: 187903991.1111; train_optim_loss: 187903991.1111; val_kl_reg_loss: 164939.4844; val_edge_recon_loss: 40511756.0000; val_gene_expr_recon_loss: 428354.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152353680.0000; val_global_loss: 193458736.0000; val_optim_loss: 193458736.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8382; val_auprc_score: 0.8195; val_best_acc_score: 0.6579; val_best_f1_score: 0.7383; train_kl_reg_loss: 130115.0885; train_edge_recon_loss: 39985392.4444; train_gene_expr_recon_loss: 444011.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154498974.2222; train_global_loss: 195058490.6667; train_optim_loss: 195058490.6667; val_kl_reg_loss: 18209.1836; val_edge_recon_loss: 40558172.0000; val_gene_expr_recon_loss: 462366.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154598976.0000; val_global_loss: 195637728.0000; val_optim_loss: 195637728.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8169; val_auprc_score: 0.8094; val_best_acc_score: 0.5232; val_best_f1_score: 0.6762; train_kl_reg_loss: 13426.6514; train_edge_recon_loss: 39458694.6667; train_gene_expr_recon_loss: 511115.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157543884.4444; train_global_loss: 197527123.5556; train_optim_loss: 197527123.5556; val_kl_reg_loss: 23581.5820; val_edge_recon_loss: 40637724.0000; val_gene_expr_recon_loss: 425062.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154375312.0000; val_global_loss: 195461680.0000; val_optim_loss: 195461680.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8269; val_auprc_score: 0.8101; val_best_acc_score: 0.5419; val_best_f1_score: 0.6827; train_kl_reg_loss: 25705.8171; train_edge_recon_loss: 36458379.5556; train_gene_expr_recon_loss: 526019.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154430426.6667; train_global_loss: 191440533.3333; train_optim_loss: 191440533.3333; val_kl_reg_loss: 26082.9180; val_edge_recon_loss: 40606456.0000; val_gene_expr_recon_loss: 452272.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154563552.0000; val_global_loss: 195648368.0000; val_optim_loss: 195648368.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8359; val_auprc_score: 0.8328; val_best_acc_score: 0.5358; val_best_f1_score: 0.6809; train_kl_reg_loss: 45495.3754; train_edge_recon_loss: 35602745.7778; train_gene_expr_recon_loss: 515884.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153928353.7778; train_global_loss: 190092478.2222; train_optim_loss: 190092478.2222; val_kl_reg_loss: 63603.7188; val_edge_recon_loss: 40619680.0000; val_gene_expr_recon_loss: 424236.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153468608.0000; val_global_loss: 194576128.0000; val_optim_loss: 194576128.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8285; val_auprc_score: 0.8195; val_best_acc_score: 0.5323; val_best_f1_score: 0.6792; train_kl_reg_loss: 69988.2865; train_edge_recon_loss: 35626680.8889; train_gene_expr_recon_loss: 486009.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154217416.8889; train_global_loss: 190400094.2222; train_optim_loss: 190400094.2222; val_kl_reg_loss: 64520.8828; val_edge_recon_loss: 40619112.0000; val_gene_expr_recon_loss: 423778.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153237568.0000; val_global_loss: 194344976.0000; val_optim_loss: 194344976.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8297; val_auprc_score: 0.8221; val_best_acc_score: 0.5338; val_best_f1_score: 0.6799; train_kl_reg_loss: 72814.5747; train_edge_recon_loss: 35585908.8889; train_gene_expr_recon_loss: 527873.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153666469.3333; train_global_loss: 189853064.8889; train_optim_loss: 189853064.8889; val_kl_reg_loss: 68413.3359; val_edge_recon_loss: 40620920.0000; val_gene_expr_recon_loss: 424959.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153173920.0000; val_global_loss: 194288208.0000; val_optim_loss: 194288208.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8253; val_auprc_score: 0.8199; val_best_acc_score: 0.5310; val_best_f1_score: 0.6786; train_kl_reg_loss: 71393.3411; train_edge_recon_loss: 35606046.6667; train_gene_expr_recon_loss: 521480.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153439093.3333; train_global_loss: 189638014.2222; train_optim_loss: 189638014.2222; val_kl_reg_loss: 65368.0156; val_edge_recon_loss: 40621652.0000; val_gene_expr_recon_loss: 426074.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153214848.0000; val_global_loss: 194327936.0000; val_optim_loss: 194327936.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8250; val_auprc_score: 0.8152; val_best_acc_score: 0.5327; val_best_f1_score: 0.6794; train_kl_reg_loss: 74124.0174; train_edge_recon_loss: 35508279.1111; train_gene_expr_recon_loss: 525326.4931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153125159.1111; train_global_loss: 189232888.8889; train_optim_loss: 189232888.8889; val_kl_reg_loss: 72175.3438; val_edge_recon_loss: 40620960.0000; val_gene_expr_recon_loss: 425370.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153332640.0000; val_global_loss: 194451152.0000; val_optim_loss: 194451152.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8393
val AUPRC score: 0.8190
val best accuracy score: 0.6020
val best F1 score: 0.7116
val target rna MSE score: 6.1181
val source rna MSE score: 6.5128
val target atac MSE score: 0.1203
val source atac MSE score: 0.0180
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
