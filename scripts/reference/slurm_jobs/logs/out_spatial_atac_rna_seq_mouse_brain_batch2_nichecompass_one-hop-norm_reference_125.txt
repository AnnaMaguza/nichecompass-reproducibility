[True]
Run timestamp: 07082023_212030_125.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_125']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8796; val_auprc_score: 0.8954; val_best_acc_score: 0.5492; val_best_f1_score: 0.6880; train_kl_reg_loss: 76628.1923; train_edge_recon_loss: 3476020.0000; train_gene_expr_recon_loss: 1370967.4306; train_masked_gp_l1_reg_loss: 16538.5000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119405.9844; train_chrom_access_recon_loss: 3124468.2361; train_global_loss: 8184028.1667; train_optim_loss: 8184028.1667; val_kl_reg_loss: 10404.7578; val_edge_recon_loss: 4061757.5000; val_gene_expr_recon_loss: 1148384.2500; val_masked_gp_l1_reg_loss: 12301.9326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117075.1875; val_chrom_access_recon_loss: 1602630.6250; val_global_loss: 6952554.0000; val_optim_loss: 6952554.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8768; val_auprc_score: 0.8904; val_best_acc_score: 0.5757; val_best_f1_score: 0.7000; train_kl_reg_loss: 8611.8223; train_edge_recon_loss: 3473423.6944; train_gene_expr_recon_loss: 1073823.8472; train_masked_gp_l1_reg_loss: 10608.7958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115706.5443; train_chrom_access_recon_loss: 1510133.5972; train_global_loss: 6192308.4444; train_optim_loss: 6192308.4444; val_kl_reg_loss: 10859.8008; val_edge_recon_loss: 4059645.2500; val_gene_expr_recon_loss: 1013167.7500; val_masked_gp_l1_reg_loss: 9296.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114096.8906; val_chrom_access_recon_loss: 1477019.2500; val_global_loss: 6684086.0000; val_optim_loss: 6684086.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8666; val_auprc_score: 0.8788; val_best_acc_score: 0.5699; val_best_f1_score: 0.6966; train_kl_reg_loss: 9186.0429; train_edge_recon_loss: 3475869.1667; train_gene_expr_recon_loss: 975125.0625; train_masked_gp_l1_reg_loss: 9237.4426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112887.6589; train_chrom_access_recon_loss: 1444385.6667; train_global_loss: 6026691.0000; train_optim_loss: 6026691.0000; val_kl_reg_loss: 8841.3809; val_edge_recon_loss: 4060059.0000; val_gene_expr_recon_loss: 928377.0000; val_masked_gp_l1_reg_loss: 9156.1826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111398.6328; val_chrom_access_recon_loss: 1435783.7500; val_global_loss: 6553616.0000; val_optim_loss: 6553616.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8496; val_auprc_score: 0.8608; val_best_acc_score: 0.5769; val_best_f1_score: 0.6995; train_kl_reg_loss: 11391.9899; train_edge_recon_loss: 3478397.8889; train_gene_expr_recon_loss: 891688.7569; train_masked_gp_l1_reg_loss: 8945.9227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110201.9123; train_chrom_access_recon_loss: 1413362.5833; train_global_loss: 5913989.0556; train_optim_loss: 5913989.0556; val_kl_reg_loss: 12850.7871; val_edge_recon_loss: 4059087.2500; val_gene_expr_recon_loss: 855661.8750; val_masked_gp_l1_reg_loss: 8751.4111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108668.4375; val_chrom_access_recon_loss: 1402123.5000; val_global_loss: 6447143.5000; val_optim_loss: 6447143.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8168; val_auprc_score: 0.8212; val_best_acc_score: 0.6064; val_best_f1_score: 0.7120; train_kl_reg_loss: 14786.0437; train_edge_recon_loss: 3479002.1389; train_gene_expr_recon_loss: 827770.5486; train_masked_gp_l1_reg_loss: 8677.9378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107335.3481; train_chrom_access_recon_loss: 1381676.1250; train_global_loss: 5819248.1667; train_optim_loss: 5819248.1667; val_kl_reg_loss: 15073.4277; val_edge_recon_loss: 4054118.5000; val_gene_expr_recon_loss: 809274.2500; val_masked_gp_l1_reg_loss: 8588.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105577.3047; val_chrom_access_recon_loss: 1373429.1250; val_global_loss: 6366061.0000; val_optim_loss: 6366061.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8055; val_auprc_score: 0.8131; val_best_acc_score: 0.6451; val_best_f1_score: 0.7272; train_kl_reg_loss: 16945.7638; train_edge_recon_loss: 3478875.3056; train_gene_expr_recon_loss: 792453.7986; train_masked_gp_l1_reg_loss: 8550.3426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104025.2188; train_chrom_access_recon_loss: 1359853.4722; train_global_loss: 5760704.1111; train_optim_loss: 5760704.1111; val_kl_reg_loss: 17825.7207; val_edge_recon_loss: 4043119.7500; val_gene_expr_recon_loss: 777998.0625; val_masked_gp_l1_reg_loss: 8506.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102000.3750; val_chrom_access_recon_loss: 1359945.0000; val_global_loss: 6309395.5000; val_optim_loss: 6309395.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7953; val_auprc_score: 0.7920; val_best_acc_score: 0.7092; val_best_f1_score: 0.7465; train_kl_reg_loss: 17933.5983; train_edge_recon_loss: 3476040.0556; train_gene_expr_recon_loss: 766970.9861; train_masked_gp_l1_reg_loss: 8487.7505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100269.1493; train_chrom_access_recon_loss: 1350240.7083; train_global_loss: 5719942.4444; train_optim_loss: 5719942.4444; val_kl_reg_loss: 16371.3604; val_edge_recon_loss: 4005470.5000; val_gene_expr_recon_loss: 759316.5000; val_masked_gp_l1_reg_loss: 8459.3857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98055.9766; val_chrom_access_recon_loss: 1351517.7500; val_global_loss: 6239191.0000; val_optim_loss: 6239191.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8046; val_auprc_score: 0.7922; val_best_acc_score: 0.7122; val_best_f1_score: 0.7522; train_kl_reg_loss: 15671.9345; train_edge_recon_loss: 3462381.5278; train_gene_expr_recon_loss: 749863.9653; train_masked_gp_l1_reg_loss: 8454.0981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96232.1458; train_chrom_access_recon_loss: 1342695.3333; train_global_loss: 5675299.0000; train_optim_loss: 5675299.0000; val_kl_reg_loss: 13482.5146; val_edge_recon_loss: 3899467.5000; val_gene_expr_recon_loss: 748705.1875; val_masked_gp_l1_reg_loss: 8441.9707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93931.2656; val_chrom_access_recon_loss: 1347698.5000; val_global_loss: 6111727.0000; val_optim_loss: 6111727.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8134; val_auprc_score: 0.7970; val_best_acc_score: 0.7273; val_best_f1_score: 0.7656; train_kl_reg_loss: 11750.0093; train_edge_recon_loss: 3420554.3889; train_gene_expr_recon_loss: 745543.8611; train_masked_gp_l1_reg_loss: 8445.9046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92074.8455; train_chrom_access_recon_loss: 1338528.5139; train_global_loss: 5616897.4444; train_optim_loss: 5616897.4444; val_kl_reg_loss: 8703.7979; val_edge_recon_loss: 3559171.0000; val_gene_expr_recon_loss: 758499.6250; val_masked_gp_l1_reg_loss: 8456.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89756.3750; val_chrom_access_recon_loss: 1349245.8750; val_global_loss: 5773833.5000; val_optim_loss: 5773833.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8263; val_auprc_score: 0.8156; val_best_acc_score: 0.7373; val_best_f1_score: 0.7651; train_kl_reg_loss: 9808.2821; train_edge_recon_loss: 3213961.9722; train_gene_expr_recon_loss: 773355.3264; train_masked_gp_l1_reg_loss: 8499.4473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87942.5694; train_chrom_access_recon_loss: 1341052.3194; train_global_loss: 5434619.8333; train_optim_loss: 5434619.8333; val_kl_reg_loss: 15962.1367; val_edge_recon_loss: 3052463.0000; val_gene_expr_recon_loss: 813719.0000; val_masked_gp_l1_reg_loss: 8555.1064; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85708.8672; val_chrom_access_recon_loss: 1363657.3750; val_global_loss: 5340065.5000; val_optim_loss: 5340065.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8490; val_auprc_score: 0.8408; val_best_acc_score: 0.7507; val_best_f1_score: 0.7730; train_kl_reg_loss: 21649.7511; train_edge_recon_loss: 2976973.5556; train_gene_expr_recon_loss: 794371.2014; train_masked_gp_l1_reg_loss: 8571.4559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83978.4097; train_chrom_access_recon_loss: 1346160.8472; train_global_loss: 5231705.1667; train_optim_loss: 5231705.1667; val_kl_reg_loss: 27211.0703; val_edge_recon_loss: 2980256.7500; val_gene_expr_recon_loss: 783360.7500; val_masked_gp_l1_reg_loss: 8553.4365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81857.4062; val_chrom_access_recon_loss: 1352970.8750; val_global_loss: 5234210.5000; val_optim_loss: 5234210.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8664; val_auprc_score: 0.8573; val_best_acc_score: 0.7722; val_best_f1_score: 0.7895; train_kl_reg_loss: 31708.2289; train_edge_recon_loss: 2917303.6111; train_gene_expr_recon_loss: 773616.8542; train_masked_gp_l1_reg_loss: 8510.9136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80222.0781; train_chrom_access_recon_loss: 1341638.4444; train_global_loss: 5153000.1667; train_optim_loss: 5153000.1667; val_kl_reg_loss: 37309.5547; val_edge_recon_loss: 2924780.7500; val_gene_expr_recon_loss: 772955.1250; val_masked_gp_l1_reg_loss: 8468.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78201.9062; val_chrom_access_recon_loss: 1345063.5000; val_global_loss: 5166779.0000; val_optim_loss: 5166779.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9084; val_auprc_score: 0.8885; val_best_acc_score: 0.8397; val_best_f1_score: 0.8500; train_kl_reg_loss: 35163.9822; train_edge_recon_loss: 2836809.9722; train_gene_expr_recon_loss: 767673.9167; train_masked_gp_l1_reg_loss: 8456.1664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76618.5165; train_chrom_access_recon_loss: 1340578.5833; train_global_loss: 5065301.2222; train_optim_loss: 5065301.2222; val_kl_reg_loss: 34265.2930; val_edge_recon_loss: 2797290.0000; val_gene_expr_recon_loss: 765388.7500; val_masked_gp_l1_reg_loss: 8418.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74659.3047; val_chrom_access_recon_loss: 1342904.0000; val_global_loss: 5022926.0000; val_optim_loss: 5022926.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9240; val_auprc_score: 0.8966; val_best_acc_score: 0.8707; val_best_f1_score: 0.8798; train_kl_reg_loss: 34091.1888; train_edge_recon_loss: 2774213.8056; train_gene_expr_recon_loss: 757124.7847; train_masked_gp_l1_reg_loss: 8387.9429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73123.7066; train_chrom_access_recon_loss: 1331815.8889; train_global_loss: 4978757.2222; train_optim_loss: 4978757.2222; val_kl_reg_loss: 33942.9180; val_edge_recon_loss: 2738571.2500; val_gene_expr_recon_loss: 756442.0000; val_masked_gp_l1_reg_loss: 8357.1309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71224.2500; val_chrom_access_recon_loss: 1338711.0000; val_global_loss: 4947249.0000; val_optim_loss: 4947249.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9331; val_auprc_score: 0.9108; val_best_acc_score: 0.8708; val_best_f1_score: 0.8785; train_kl_reg_loss: 36695.3199; train_edge_recon_loss: 2732762.4444; train_gene_expr_recon_loss: 746010.7431; train_masked_gp_l1_reg_loss: 8343.0853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69743.1337; train_chrom_access_recon_loss: 1326115.7083; train_global_loss: 4919670.2778; train_optim_loss: 4919670.2778; val_kl_reg_loss: 38756.3281; val_edge_recon_loss: 2728661.2500; val_gene_expr_recon_loss: 744867.0000; val_masked_gp_l1_reg_loss: 8327.5303; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67901.8828; val_chrom_access_recon_loss: 1333556.7500; val_global_loss: 4922071.0000; val_optim_loss: 4922071.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9297; val_auprc_score: 0.9071; val_best_acc_score: 0.8717; val_best_f1_score: 0.8805; train_kl_reg_loss: 41069.2765; train_edge_recon_loss: 2739906.2222; train_gene_expr_recon_loss: 736776.3333; train_masked_gp_l1_reg_loss: 8326.6433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66462.4510; train_chrom_access_recon_loss: 1329625.0000; train_global_loss: 4922166.0000; train_optim_loss: 4922166.0000; val_kl_reg_loss: 41905.7266; val_edge_recon_loss: 2745012.2500; val_gene_expr_recon_loss: 735932.4375; val_masked_gp_l1_reg_loss: 8323.3877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64684.2891; val_chrom_access_recon_loss: 1329082.0000; val_global_loss: 4924940.0000; val_optim_loss: 4924940.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9334; val_auprc_score: 0.9104; val_best_acc_score: 0.8777; val_best_f1_score: 0.8850; train_kl_reg_loss: 42867.0768; train_edge_recon_loss: 2732164.7778; train_gene_expr_recon_loss: 728307.8333; train_masked_gp_l1_reg_loss: 8316.0503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63322.4123; train_chrom_access_recon_loss: 1317388.0000; train_global_loss: 4892366.0556; train_optim_loss: 4892366.0556; val_kl_reg_loss: 42403.5234; val_edge_recon_loss: 2735539.7500; val_gene_expr_recon_loss: 730464.3125; val_masked_gp_l1_reg_loss: 8307.1494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61639.0430; val_chrom_access_recon_loss: 1325876.6250; val_global_loss: 4904230.5000; val_optim_loss: 4904230.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9394; val_auprc_score: 0.9186; val_best_acc_score: 0.8841; val_best_f1_score: 0.8903; train_kl_reg_loss: 42243.0842; train_edge_recon_loss: 2717539.7222; train_gene_expr_recon_loss: 724352.9097; train_masked_gp_l1_reg_loss: 8317.6722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60346.1576; train_chrom_access_recon_loss: 1321520.5278; train_global_loss: 4874320.0000; train_optim_loss: 4874320.0000; val_kl_reg_loss: 40912.7891; val_edge_recon_loss: 2723743.2500; val_gene_expr_recon_loss: 726516.0625; val_masked_gp_l1_reg_loss: 8321.0498; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58756.9766; val_chrom_access_recon_loss: 1323442.1250; val_global_loss: 4881692.0000; val_optim_loss: 4881692.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9437; val_auprc_score: 0.9246; val_best_acc_score: 0.8898; val_best_f1_score: 0.8960; train_kl_reg_loss: 41326.2613; train_edge_recon_loss: 2724937.9167; train_gene_expr_recon_loss: 721874.3056; train_masked_gp_l1_reg_loss: 8328.0405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57554.1198; train_chrom_access_recon_loss: 1318811.9583; train_global_loss: 4872832.6667; train_optim_loss: 4872832.6667; val_kl_reg_loss: 40025.0000; val_edge_recon_loss: 2702671.0000; val_gene_expr_recon_loss: 723476.6875; val_masked_gp_l1_reg_loss: 8345.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56073.0547; val_chrom_access_recon_loss: 1320956.0000; val_global_loss: 4851547.0000; val_optim_loss: 4851547.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9391; val_auprc_score: 0.9170; val_best_acc_score: 0.8844; val_best_f1_score: 0.8909; train_kl_reg_loss: 40764.9384; train_edge_recon_loss: 2724153.6389; train_gene_expr_recon_loss: 716535.3958; train_masked_gp_l1_reg_loss: 8365.6338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54959.2951; train_chrom_access_recon_loss: 1315641.8056; train_global_loss: 4860420.6667; train_optim_loss: 4860420.6667; val_kl_reg_loss: 39953.7344; val_edge_recon_loss: 2735091.2500; val_gene_expr_recon_loss: 718593.8750; val_masked_gp_l1_reg_loss: 8378.6855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53588.9805; val_chrom_access_recon_loss: 1318022.8750; val_global_loss: 4873629.5000; val_optim_loss: 4873629.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9206; val_best_acc_score: 0.8821; val_best_f1_score: 0.8906; train_kl_reg_loss: 40066.4197; train_edge_recon_loss: 2723339.8611; train_gene_expr_recon_loss: 713292.6806; train_masked_gp_l1_reg_loss: 8395.2229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52546.6376; train_chrom_access_recon_loss: 1305005.6111; train_global_loss: 4842646.5556; train_optim_loss: 4842646.5556; val_kl_reg_loss: 39185.1250; val_edge_recon_loss: 2752621.5000; val_gene_expr_recon_loss: 716130.6250; val_masked_gp_l1_reg_loss: 8405.3721; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51272.2734; val_chrom_access_recon_loss: 1315861.1250; val_global_loss: 4883475.5000; val_optim_loss: 4883475.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9441; val_auprc_score: 0.9286; val_best_acc_score: 0.8857; val_best_f1_score: 0.8930; train_kl_reg_loss: 39815.3325; train_edge_recon_loss: 2721709.3056; train_gene_expr_recon_loss: 710578.4861; train_masked_gp_l1_reg_loss: 8423.2011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50300.5829; train_chrom_access_recon_loss: 1305660.4306; train_global_loss: 4836487.3889; train_optim_loss: 4836487.3889; val_kl_reg_loss: 38611.6250; val_edge_recon_loss: 2742146.5000; val_gene_expr_recon_loss: 713722.7500; val_masked_gp_l1_reg_loss: 8449.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49107.8828; val_chrom_access_recon_loss: 1314261.0000; val_global_loss: 4866299.0000; val_optim_loss: 4866299.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9433; val_auprc_score: 0.9268; val_best_acc_score: 0.8898; val_best_f1_score: 0.8968; train_kl_reg_loss: 39297.7439; train_edge_recon_loss: 2714261.1389; train_gene_expr_recon_loss: 708540.5694; train_masked_gp_l1_reg_loss: 8468.5565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48200.9727; train_chrom_access_recon_loss: 1304954.5694; train_global_loss: 4823723.5556; train_optim_loss: 4823723.5556; val_kl_reg_loss: 38128.7812; val_edge_recon_loss: 2738526.7500; val_gene_expr_recon_loss: 710982.3125; val_masked_gp_l1_reg_loss: 8490.7725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47088.7891; val_chrom_access_recon_loss: 1311466.5000; val_global_loss: 4854684.0000; val_optim_loss: 4854684.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9429; val_auprc_score: 0.9240; val_best_acc_score: 0.8878; val_best_f1_score: 0.8945; train_kl_reg_loss: 38770.3602; train_edge_recon_loss: 2716093.9167; train_gene_expr_recon_loss: 704609.5139; train_masked_gp_l1_reg_loss: 8417.3275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46978.7995; train_chrom_access_recon_loss: 1304132.4306; train_global_loss: 4819002.4444; train_optim_loss: 4819002.4444; val_kl_reg_loss: 38040.7578; val_edge_recon_loss: 2743968.0000; val_gene_expr_recon_loss: 709705.3750; val_masked_gp_l1_reg_loss: 8330.5293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46837.0742; val_chrom_access_recon_loss: 1311891.3750; val_global_loss: 4858773.0000; val_optim_loss: 4858773.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9450; val_auprc_score: 0.9229; val_best_acc_score: 0.8918; val_best_f1_score: 0.8992; train_kl_reg_loss: 38700.1576; train_edge_recon_loss: 2711752.4167; train_gene_expr_recon_loss: 699397.7014; train_masked_gp_l1_reg_loss: 8309.3391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46728.0035; train_chrom_access_recon_loss: 1301208.1528; train_global_loss: 4806095.6667; train_optim_loss: 4806095.6667; val_kl_reg_loss: 38041.0195; val_edge_recon_loss: 2723125.0000; val_gene_expr_recon_loss: 709757.2500; val_masked_gp_l1_reg_loss: 8278.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46591.3203; val_chrom_access_recon_loss: 1312841.6250; val_global_loss: 4838634.5000; val_optim_loss: 4838634.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9411; val_auprc_score: 0.9211; val_best_acc_score: 0.8832; val_best_f1_score: 0.8916; train_kl_reg_loss: 38526.4957; train_edge_recon_loss: 2745293.1944; train_gene_expr_recon_loss: 1013287.8819; train_masked_gp_l1_reg_loss: 8261.9728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46462.3672; train_chrom_access_recon_loss: 1382777.7361; train_global_loss: 5234609.6111; train_optim_loss: 5234609.6111; val_kl_reg_loss: 17222.9961; val_edge_recon_loss: 2738261.2500; val_gene_expr_recon_loss: 1026032.2500; val_masked_gp_l1_reg_loss: 8243.3291; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46288.7188; val_chrom_access_recon_loss: 1388228.3750; val_global_loss: 5224277.0000; val_optim_loss: 5224277.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9473; val_auprc_score: 0.9293; val_best_acc_score: 0.8902; val_best_f1_score: 0.8979; train_kl_reg_loss: 37834.5907; train_edge_recon_loss: 2707186.5278; train_gene_expr_recon_loss: 1025945.9444; train_masked_gp_l1_reg_loss: 8232.9505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46139.4484; train_chrom_access_recon_loss: 1385042.5139; train_global_loss: 5210382.0556; train_optim_loss: 5210382.0556; val_kl_reg_loss: 17321.0742; val_edge_recon_loss: 2715090.0000; val_gene_expr_recon_loss: 1029130.5625; val_masked_gp_l1_reg_loss: 8223.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45950.2344; val_chrom_access_recon_loss: 1389503.7500; val_global_loss: 5205219.0000; val_optim_loss: 5205219.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9488; val_auprc_score: 0.9332; val_best_acc_score: 0.8905; val_best_f1_score: 0.8968; train_kl_reg_loss: 37130.5625; train_edge_recon_loss: 2715184.3889; train_gene_expr_recon_loss: 1022195.5764; train_masked_gp_l1_reg_loss: 8221.9896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45796.4935; train_chrom_access_recon_loss: 1375824.8333; train_global_loss: 5204353.7778; train_optim_loss: 5204353.7778; val_kl_reg_loss: 17472.1133; val_edge_recon_loss: 2717982.5000; val_gene_expr_recon_loss: 1021951.3125; val_masked_gp_l1_reg_loss: 8221.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45604.2148; val_chrom_access_recon_loss: 1386634.6250; val_global_loss: 5197866.5000; val_optim_loss: 5197866.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9508; val_auprc_score: 0.9311; val_best_acc_score: 0.8949; val_best_f1_score: 0.9021; train_kl_reg_loss: 37051.6450; train_edge_recon_loss: 2720580.2778; train_gene_expr_recon_loss: 1022332.6806; train_masked_gp_l1_reg_loss: 8224.8557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45451.2188; train_chrom_access_recon_loss: 1380449.4167; train_global_loss: 5214090.1111; train_optim_loss: 5214090.1111; val_kl_reg_loss: 17033.5742; val_edge_recon_loss: 2706083.7500; val_gene_expr_recon_loss: 1021561.0000; val_masked_gp_l1_reg_loss: 8229.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45260.6445; val_chrom_access_recon_loss: 1386637.6250; val_global_loss: 5184806.5000; val_optim_loss: 5184806.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9464; val_auprc_score: 0.9261; val_best_acc_score: 0.8870; val_best_f1_score: 0.8947; train_kl_reg_loss: 36531.5877; train_edge_recon_loss: 2706090.1111; train_gene_expr_recon_loss: 1014608.3819; train_masked_gp_l1_reg_loss: 8222.9019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45242.4340; train_chrom_access_recon_loss: 1376444.7222; train_global_loss: 5187140.2778; train_optim_loss: 5187140.2778; val_kl_reg_loss: 16977.6055; val_edge_recon_loss: 2727841.2500; val_gene_expr_recon_loss: 1021709.3750; val_masked_gp_l1_reg_loss: 8216.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45219.8477; val_chrom_access_recon_loss: 1386634.7500; val_global_loss: 5206598.5000; val_optim_loss: 5206598.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9511; val_auprc_score: 0.9381; val_best_acc_score: 0.8934; val_best_f1_score: 0.8989; train_kl_reg_loss: 36444.8043; train_edge_recon_loss: 2716042.5833; train_gene_expr_recon_loss: 1018749.1250; train_masked_gp_l1_reg_loss: 8215.1826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45203.3837; train_chrom_access_recon_loss: 1378648.2361; train_global_loss: 5203303.2778; train_optim_loss: 5203303.2778; val_kl_reg_loss: 16956.0859; val_edge_recon_loss: 2727396.7500; val_gene_expr_recon_loss: 1021898.8750; val_masked_gp_l1_reg_loss: 8213.4033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45182.7383; val_chrom_access_recon_loss: 1386599.7500; val_global_loss: 5206247.5000; val_optim_loss: 5206247.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9510; val_auprc_score: 0.9346; val_best_acc_score: 0.8948; val_best_f1_score: 0.9018; train_kl_reg_loss: 36409.1905; train_edge_recon_loss: 2719348.5556; train_gene_expr_recon_loss: 1017484.4236; train_masked_gp_l1_reg_loss: 8212.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45166.5135; train_chrom_access_recon_loss: 1379372.4861; train_global_loss: 5205993.7778; train_optim_loss: 5205993.7778; val_kl_reg_loss: 16975.4648; val_edge_recon_loss: 2705505.2500; val_gene_expr_recon_loss: 1022086.1250; val_masked_gp_l1_reg_loss: 8212.0059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45146.3594; val_chrom_access_recon_loss: 1386743.0000; val_global_loss: 5184668.0000; val_optim_loss: 5184668.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9478; val_auprc_score: 0.9298; val_best_acc_score: 0.8921; val_best_f1_score: 0.8996; train_kl_reg_loss: 36294.3967; train_edge_recon_loss: 2712844.8056; train_gene_expr_recon_loss: 1018838.6528; train_masked_gp_l1_reg_loss: 8211.8064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45130.3637; train_chrom_access_recon_loss: 1376282.1806; train_global_loss: 5197602.1667; train_optim_loss: 5197602.1667; val_kl_reg_loss: 16920.5312; val_edge_recon_loss: 2698355.2500; val_gene_expr_recon_loss: 1022188.7500; val_masked_gp_l1_reg_loss: 8211.7822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45110.5547; val_chrom_access_recon_loss: 1386785.6250; val_global_loss: 5177572.5000; val_optim_loss: 5177572.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9515
val AUPRC score: 0.9379
val best accuracy score: 0.8934
val best F1 score: 0.8998
val target rna MSE score: 4.0605
val source rna MSE score: 3.2706
val target atac MSE score: 0.1363
val source atac MSE score: 0.0215
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
