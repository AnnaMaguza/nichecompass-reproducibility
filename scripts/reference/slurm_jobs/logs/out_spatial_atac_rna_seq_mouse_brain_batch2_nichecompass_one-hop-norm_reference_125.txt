[True]
Run timestamp: 10102023_031949_125.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_125']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7660; val_auprc_score: 0.7874; val_best_acc_score: 0.5740; val_best_f1_score: 0.6947; train_kl_reg_loss: 86427.7375; train_edge_recon_loss: 3514788.1527; train_gene_expr_recon_loss: 13284720.7939; train_masked_gp_l1_reg_loss: 47536.9271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3318019.0417; train_chrom_access_recon_loss: 11112935.7786; train_global_loss: 31364428.3359; train_optim_loss: 31364428.3359; val_kl_reg_loss: 94016.3271; val_edge_recon_loss: 4061100.6333; val_gene_expr_recon_loss: 12700834.3333; val_masked_gp_l1_reg_loss: 53650.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 468845.0938; val_chrom_access_recon_loss: 10947599.2667; val_global_loss: 28326046.2667; val_optim_loss: 28326046.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8140; val_auprc_score: 0.8223; val_best_acc_score: 0.7280; val_best_f1_score: 0.7418; train_kl_reg_loss: 87343.2313; train_edge_recon_loss: 3454602.6202; train_gene_expr_recon_loss: 12584032.8702; train_masked_gp_l1_reg_loss: 57024.6266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 260779.6664; train_chrom_access_recon_loss: 10767076.5496; train_global_loss: 27210859.6336; train_optim_loss: 27210859.6336; val_kl_reg_loss: 85995.1156; val_edge_recon_loss: 3293336.7333; val_gene_expr_recon_loss: 12502745.6000; val_masked_gp_l1_reg_loss: 61419.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167183.6250; val_chrom_access_recon_loss: 10775749.9333; val_global_loss: 26886430.2667; val_optim_loss: 26886430.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9024; val_auprc_score: 0.8846; val_best_acc_score: 0.8297; val_best_f1_score: 0.8425; train_kl_reg_loss: 99812.8904; train_edge_recon_loss: 3005459.7958; train_gene_expr_recon_loss: 12425360.5802; train_masked_gp_l1_reg_loss: 66195.3096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137401.8350; train_chrom_access_recon_loss: 10615572.5267; train_global_loss: 26349803.0534; train_optim_loss: 26349803.0534; val_kl_reg_loss: 104879.0198; val_edge_recon_loss: 2901031.5500; val_gene_expr_recon_loss: 12377767.1333; val_masked_gp_l1_reg_loss: 69903.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119505.9609; val_chrom_access_recon_loss: 10647851.7333; val_global_loss: 26220938.5333; val_optim_loss: 26220938.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9263; val_auprc_score: 0.9127; val_best_acc_score: 0.8566; val_best_f1_score: 0.8643; train_kl_reg_loss: 108671.8272; train_edge_recon_loss: 2844609.4103; train_gene_expr_recon_loss: 12294642.3282; train_masked_gp_l1_reg_loss: 72263.3683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111876.1112; train_chrom_access_recon_loss: 10512427.3664; train_global_loss: 25944490.4580; train_optim_loss: 25944490.4580; val_kl_reg_loss: 105658.0943; val_edge_recon_loss: 2852167.5500; val_gene_expr_recon_loss: 12243502.5333; val_masked_gp_l1_reg_loss: 74382.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107272.3359; val_chrom_access_recon_loss: 10551010.4000; val_global_loss: 25933992.4000; val_optim_loss: 25933992.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9362; val_auprc_score: 0.9214; val_best_acc_score: 0.8674; val_best_f1_score: 0.8743; train_kl_reg_loss: 102737.4702; train_edge_recon_loss: 2816109.0172; train_gene_expr_recon_loss: 12163960.7023; train_masked_gp_l1_reg_loss: 76064.1326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105040.6276; train_chrom_access_recon_loss: 10407548.0916; train_global_loss: 25671460.0611; train_optim_loss: 25671460.0611; val_kl_reg_loss: 100368.1250; val_edge_recon_loss: 2816311.5500; val_gene_expr_recon_loss: 12101003.5333; val_masked_gp_l1_reg_loss: 77577.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103418.3906; val_chrom_access_recon_loss: 10444442.2000; val_global_loss: 25643120.2667; val_optim_loss: 25643120.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9387; val_auprc_score: 0.9260; val_best_acc_score: 0.8751; val_best_f1_score: 0.8814; train_kl_reg_loss: 99050.9190; train_edge_recon_loss: 2798351.6011; train_gene_expr_recon_loss: 12089310.3282; train_masked_gp_l1_reg_loss: 78864.1480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103436.4408; train_chrom_access_recon_loss: 10361464.7405; train_global_loss: 25530478.2137; train_optim_loss: 25530478.2137; val_kl_reg_loss: 97348.0099; val_edge_recon_loss: 2791612.6667; val_gene_expr_recon_loss: 12118022.4667; val_masked_gp_l1_reg_loss: 80235.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104391.5859; val_chrom_access_recon_loss: 10479058.1333; val_global_loss: 25670669.3333; val_optim_loss: 25670669.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9446; val_auprc_score: 0.9294; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 96200.2462; train_edge_recon_loss: 2775482.0992; train_gene_expr_recon_loss: 11987834.3359; train_masked_gp_l1_reg_loss: 81263.8884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103308.3617; train_chrom_access_recon_loss: 10283005.2290; train_global_loss: 25327094.0611; train_optim_loss: 25327094.0611; val_kl_reg_loss: 94433.9703; val_edge_recon_loss: 2767873.3167; val_gene_expr_recon_loss: 11979443.5333; val_masked_gp_l1_reg_loss: 82202.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102405.8828; val_chrom_access_recon_loss: 10363623.2000; val_global_loss: 25389983.0667; val_optim_loss: 25389983.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9484; val_auprc_score: 0.9386; val_best_acc_score: 0.8849; val_best_f1_score: 0.8902; train_kl_reg_loss: 92251.3778; train_edge_recon_loss: 2766758.8645; train_gene_expr_recon_loss: 11916220.6641; train_masked_gp_l1_reg_loss: 83240.6208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102225.4382; train_chrom_access_recon_loss: 10215968.1756; train_global_loss: 25176665.0382; train_optim_loss: 25176665.0382; val_kl_reg_loss: 95207.4490; val_edge_recon_loss: 2759894.3167; val_gene_expr_recon_loss: 11913434.5333; val_masked_gp_l1_reg_loss: 84169.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101430.0000; val_chrom_access_recon_loss: 10330975.3333; val_global_loss: 25285110.4000; val_optim_loss: 25285110.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9516; val_auprc_score: 0.9414; val_best_acc_score: 0.8909; val_best_f1_score: 0.8956; train_kl_reg_loss: 93901.0594; train_edge_recon_loss: 2747259.8683; train_gene_expr_recon_loss: 11840238.2061; train_masked_gp_l1_reg_loss: 84806.5967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100683.7942; train_chrom_access_recon_loss: 10149918.0992; train_global_loss: 25016807.6794; train_optim_loss: 25016807.6794; val_kl_reg_loss: 94730.6677; val_edge_recon_loss: 2762722.2500; val_gene_expr_recon_loss: 11860892.5333; val_masked_gp_l1_reg_loss: 85418.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100667.8594; val_chrom_access_recon_loss: 10279302.2000; val_global_loss: 25183733.7333; val_optim_loss: 25183733.7333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9502; val_auprc_score: 0.9382; val_best_acc_score: 0.8886; val_best_f1_score: 0.8927; train_kl_reg_loss: 91688.9852; train_edge_recon_loss: 2731948.4065; train_gene_expr_recon_loss: 11776559.5267; train_masked_gp_l1_reg_loss: 85888.3768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99111.5905; train_chrom_access_recon_loss: 10095384.1450; train_global_loss: 24880580.9160; train_optim_loss: 24880580.9160; val_kl_reg_loss: 89783.6604; val_edge_recon_loss: 2779586.1167; val_gene_expr_recon_loss: 11761746.5333; val_masked_gp_l1_reg_loss: 86271.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98762.1406; val_chrom_access_recon_loss: 10172984.5333; val_global_loss: 24989133.8667; val_optim_loss: 24989133.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9523; val_auprc_score: 0.9397; val_best_acc_score: 0.8919; val_best_f1_score: 0.8976; train_kl_reg_loss: 88581.1868; train_edge_recon_loss: 2737573.5534; train_gene_expr_recon_loss: 11732271.1679; train_masked_gp_l1_reg_loss: 86606.3891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97767.3316; train_chrom_access_recon_loss: 10046873.7710; train_global_loss: 24789673.2366; train_optim_loss: 24789673.2366; val_kl_reg_loss: 92285.6167; val_edge_recon_loss: 2749961.8333; val_gene_expr_recon_loss: 11753593.1333; val_masked_gp_l1_reg_loss: 87125.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97931.3906; val_chrom_access_recon_loss: 10167279.6000; val_global_loss: 24948176.1333; val_optim_loss: 24948176.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9597; val_auprc_score: 0.9502; val_best_acc_score: 0.9034; val_best_f1_score: 0.9081; train_kl_reg_loss: 87797.6950; train_edge_recon_loss: 2721781.2805; train_gene_expr_recon_loss: 11691044.0611; train_masked_gp_l1_reg_loss: 87408.0869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96694.1766; train_chrom_access_recon_loss: 10008687.7710; train_global_loss: 24693412.8702; train_optim_loss: 24693412.8702; val_kl_reg_loss: 86093.9042; val_edge_recon_loss: 2735818.7333; val_gene_expr_recon_loss: 11688152.1333; val_masked_gp_l1_reg_loss: 87522.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96537.7344; val_chrom_access_recon_loss: 10086064.4667; val_global_loss: 24780189.2000; val_optim_loss: 24780189.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9615; val_auprc_score: 0.9524; val_best_acc_score: 0.9025; val_best_f1_score: 0.9067; train_kl_reg_loss: 85760.4720; train_edge_recon_loss: 2724135.1489; train_gene_expr_recon_loss: 11643086.2214; train_masked_gp_l1_reg_loss: 87706.8869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95742.0353; train_chrom_access_recon_loss: 9952083.1069; train_global_loss: 24588513.8626; train_optim_loss: 24588513.8626; val_kl_reg_loss: 84336.1005; val_edge_recon_loss: 2721996.8333; val_gene_expr_recon_loss: 11713840.5333; val_masked_gp_l1_reg_loss: 87817.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94808.3438; val_chrom_access_recon_loss: 10093236.2000; val_global_loss: 24796035.7333; val_optim_loss: 24796035.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9616; val_auprc_score: 0.9522; val_best_acc_score: 0.9053; val_best_f1_score: 0.9089; train_kl_reg_loss: 85733.9682; train_edge_recon_loss: 2722757.8340; train_gene_expr_recon_loss: 11600213.0534; train_masked_gp_l1_reg_loss: 87934.3293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94667.9839; train_chrom_access_recon_loss: 9902553.9924; train_global_loss: 24493861.2519; train_optim_loss: 24493861.2519; val_kl_reg_loss: 84832.4917; val_edge_recon_loss: 2713438.2833; val_gene_expr_recon_loss: 11654788.0000; val_masked_gp_l1_reg_loss: 87928.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93718.7031; val_chrom_access_recon_loss: 10034496.3333; val_global_loss: 24669202.1333; val_optim_loss: 24669202.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9625; val_auprc_score: 0.9515; val_best_acc_score: 0.9077; val_best_f1_score: 0.9108; train_kl_reg_loss: 85121.5558; train_edge_recon_loss: 2718142.8130; train_gene_expr_recon_loss: 11567829.3206; train_masked_gp_l1_reg_loss: 87982.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93699.0991; train_chrom_access_recon_loss: 9861005.9695; train_global_loss: 24413781.4504; train_optim_loss: 24413781.4504; val_kl_reg_loss: 82243.4724; val_edge_recon_loss: 2729941.7833; val_gene_expr_recon_loss: 11608895.5333; val_masked_gp_l1_reg_loss: 88134.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93732.7188; val_chrom_access_recon_loss: 10016582.0667; val_global_loss: 24619530.8000; val_optim_loss: 24619530.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9643; val_auprc_score: 0.9568; val_best_acc_score: 0.9073; val_best_f1_score: 0.9118; train_kl_reg_loss: 82982.5104; train_edge_recon_loss: 2714243.4351; train_gene_expr_recon_loss: 11529997.9618; train_masked_gp_l1_reg_loss: 88045.6416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93324.2269; train_chrom_access_recon_loss: 9816664.1756; train_global_loss: 24325257.8931; train_optim_loss: 24325257.8931; val_kl_reg_loss: 84424.3880; val_edge_recon_loss: 2723639.4000; val_gene_expr_recon_loss: 11609774.1333; val_masked_gp_l1_reg_loss: 88313.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93815.5000; val_chrom_access_recon_loss: 9955371.4000; val_global_loss: 24555337.6000; val_optim_loss: 24555337.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9644; val_auprc_score: 0.9520; val_best_acc_score: 0.9117; val_best_f1_score: 0.9143; train_kl_reg_loss: 84527.7931; train_edge_recon_loss: 2702598.6584; train_gene_expr_recon_loss: 11512922.4962; train_masked_gp_l1_reg_loss: 88255.5117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93103.7965; train_chrom_access_recon_loss: 9780280.1679; train_global_loss: 24261688.3817; train_optim_loss: 24261688.3817; val_kl_reg_loss: 84465.5495; val_edge_recon_loss: 2703821.0667; val_gene_expr_recon_loss: 11532244.4000; val_masked_gp_l1_reg_loss: 88195.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93003.0078; val_chrom_access_recon_loss: 9906142.4667; val_global_loss: 24407871.3333; val_optim_loss: 24407871.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9677; val_auprc_score: 0.9581; val_best_acc_score: 0.9143; val_best_f1_score: 0.9174; train_kl_reg_loss: 82448.7747; train_edge_recon_loss: 2700243.1469; train_gene_expr_recon_loss: 11482434.9008; train_masked_gp_l1_reg_loss: 88100.4435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92875.9316; train_chrom_access_recon_loss: 9732709.3588; train_global_loss: 24178812.7176; train_optim_loss: 24178812.7176; val_kl_reg_loss: 81363.3740; val_edge_recon_loss: 2712484.6833; val_gene_expr_recon_loss: 11538659.0000; val_masked_gp_l1_reg_loss: 87963.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92714.8672; val_chrom_access_recon_loss: 9875949.5333; val_global_loss: 24389134.5333; val_optim_loss: 24389134.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9708; val_auprc_score: 0.9621; val_best_acc_score: 0.9192; val_best_f1_score: 0.9218; train_kl_reg_loss: 80577.3870; train_edge_recon_loss: 2705298.7405; train_gene_expr_recon_loss: 11455428.7939; train_masked_gp_l1_reg_loss: 88154.9694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92822.0409; train_chrom_access_recon_loss: 9695390.3740; train_global_loss: 24117672.3664; train_optim_loss: 24117672.3664; val_kl_reg_loss: 81683.8448; val_edge_recon_loss: 2702507.4667; val_gene_expr_recon_loss: 11512908.6667; val_masked_gp_l1_reg_loss: 88241.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93273.7734; val_chrom_access_recon_loss: 9845777.5333; val_global_loss: 24324392.6667; val_optim_loss: 24324392.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9696; val_auprc_score: 0.9632; val_best_acc_score: 0.9194; val_best_f1_score: 0.9217; train_kl_reg_loss: 80418.3289; train_edge_recon_loss: 2703571.3321; train_gene_expr_recon_loss: 11444130.4351; train_masked_gp_l1_reg_loss: 87920.6941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93193.8668; train_chrom_access_recon_loss: 9678453.1908; train_global_loss: 24087687.8931; train_optim_loss: 24087687.8931; val_kl_reg_loss: 80282.7172; val_edge_recon_loss: 2713531.2667; val_gene_expr_recon_loss: 11472646.1333; val_masked_gp_l1_reg_loss: 88136.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93367.9453; val_chrom_access_recon_loss: 9800025.7333; val_global_loss: 24247989.8667; val_optim_loss: 24247989.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9727; val_auprc_score: 0.9615; val_best_acc_score: 0.9272; val_best_f1_score: 0.9296; train_kl_reg_loss: 80233.6289; train_edge_recon_loss: 2701554.5095; train_gene_expr_recon_loss: 11416792.5802; train_masked_gp_l1_reg_loss: 87762.6064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93410.0918; train_chrom_access_recon_loss: 9634731.4122; train_global_loss: 24014484.9618; train_optim_loss: 24014484.9618; val_kl_reg_loss: 78953.7547; val_edge_recon_loss: 2709123.5667; val_gene_expr_recon_loss: 11478526.4667; val_masked_gp_l1_reg_loss: 87542.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93413.8984; val_chrom_access_recon_loss: 9812684.6667; val_global_loss: 24260245.6000; val_optim_loss: 24260245.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9714; val_auprc_score: 0.9606; val_best_acc_score: 0.9233; val_best_f1_score: 0.9259; train_kl_reg_loss: 80697.7381; train_edge_recon_loss: 2686995.5897; train_gene_expr_recon_loss: 11400913.7634; train_masked_gp_l1_reg_loss: 87366.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93494.4557; train_chrom_access_recon_loss: 9606887.5191; train_global_loss: 23956355.7557; train_optim_loss: 23956355.7557; val_kl_reg_loss: 78900.6651; val_edge_recon_loss: 2717881.1833; val_gene_expr_recon_loss: 11439836.8000; val_masked_gp_l1_reg_loss: 87423.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94105.0000; val_chrom_access_recon_loss: 9824711.8667; val_global_loss: 24242858.4000; val_optim_loss: 24242858.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9735; val_auprc_score: 0.9651; val_best_acc_score: 0.9235; val_best_f1_score: 0.9255; train_kl_reg_loss: 78832.5001; train_edge_recon_loss: 2687975.5095; train_gene_expr_recon_loss: 11364051.4427; train_masked_gp_l1_reg_loss: 87249.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93973.9639; train_chrom_access_recon_loss: 9557582.5420; train_global_loss: 23869665.4351; train_optim_loss: 23869665.4351; val_kl_reg_loss: 78537.0615; val_edge_recon_loss: 2715328.2667; val_gene_expr_recon_loss: 11419640.7333; val_masked_gp_l1_reg_loss: 87303.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94592.9766; val_chrom_access_recon_loss: 9748169.9333; val_global_loss: 24143573.3333; val_optim_loss: 24143573.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9747; val_auprc_score: 0.9692; val_best_acc_score: 0.9290; val_best_f1_score: 0.9309; train_kl_reg_loss: 78913.1681; train_edge_recon_loss: 2692004.5115; train_gene_expr_recon_loss: 11348022.5496; train_masked_gp_l1_reg_loss: 87163.5079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94496.0936; train_chrom_access_recon_loss: 9529107.7939; train_global_loss: 23829707.4656; train_optim_loss: 23829707.4656; val_kl_reg_loss: 77156.9474; val_edge_recon_loss: 2710664.0000; val_gene_expr_recon_loss: 11406445.5333; val_masked_gp_l1_reg_loss: 86989.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94679.9141; val_chrom_access_recon_loss: 9701571.5333; val_global_loss: 24077507.8667; val_optim_loss: 24077507.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9750; val_auprc_score: 0.9686; val_best_acc_score: 0.9285; val_best_f1_score: 0.9309; train_kl_reg_loss: 78806.0352; train_edge_recon_loss: 2686440.3225; train_gene_expr_recon_loss: 11336779.8931; train_masked_gp_l1_reg_loss: 86868.1234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94887.8138; train_chrom_access_recon_loss: 9511294.7786; train_global_loss: 23795077.0076; train_optim_loss: 23795077.0076; val_kl_reg_loss: 79364.8385; val_edge_recon_loss: 2687267.9167; val_gene_expr_recon_loss: 11360449.2667; val_masked_gp_l1_reg_loss: 86512.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95284.3594; val_chrom_access_recon_loss: 9668427.6667; val_global_loss: 23977305.3333; val_optim_loss: 23977305.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9692; val_auprc_score: 0.9618; val_best_acc_score: 0.9189; val_best_f1_score: 0.9223; train_kl_reg_loss: 90019.5775; train_edge_recon_loss: 2739755.3664; train_gene_expr_recon_loss: 10365435.4351; train_masked_gp_l1_reg_loss: 85423.7720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89545.9039; train_chrom_access_recon_loss: 8889328.8702; train_global_loss: 22259509.0076; train_optim_loss: 22259509.0076; val_kl_reg_loss: 40992.2031; val_edge_recon_loss: 2722656.1000; val_gene_expr_recon_loss: 10394941.1333; val_masked_gp_l1_reg_loss: 83488.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88786.4375; val_chrom_access_recon_loss: 8943750.4000; val_global_loss: 22274613.8667; val_optim_loss: 22274613.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9696; val_auprc_score: 0.9609; val_best_acc_score: 0.9209; val_best_f1_score: 0.9234; train_kl_reg_loss: 71330.8626; train_edge_recon_loss: 2694878.2786; train_gene_expr_recon_loss: 10326229.0382; train_masked_gp_l1_reg_loss: 81437.1449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88554.8760; train_chrom_access_recon_loss: 8823798.6374; train_global_loss: 22086228.9466; train_optim_loss: 22086228.9466; val_kl_reg_loss: 42555.8969; val_edge_recon_loss: 2714449.3000; val_gene_expr_recon_loss: 10384824.8667; val_masked_gp_l1_reg_loss: 79609.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88896.2578; val_chrom_access_recon_loss: 8963563.6000; val_global_loss: 22273898.5333; val_optim_loss: 22273898.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9685; val_auprc_score: 0.9581; val_best_acc_score: 0.9205; val_best_f1_score: 0.9236; train_kl_reg_loss: 65571.1559; train_edge_recon_loss: 2693896.2615; train_gene_expr_recon_loss: 10297306.5573; train_masked_gp_l1_reg_loss: 77986.4116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88935.8600; train_chrom_access_recon_loss: 8789323.9580; train_global_loss: 22013020.1985; train_optim_loss: 22013020.1985; val_kl_reg_loss: 46973.9607; val_edge_recon_loss: 2727784.6167; val_gene_expr_recon_loss: 10353570.8667; val_masked_gp_l1_reg_loss: 76455.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89098.9688; val_chrom_access_recon_loss: 8946134.5333; val_global_loss: 22240018.8000; val_optim_loss: 22240018.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9713; val_auprc_score: 0.9641; val_best_acc_score: 0.9244; val_best_f1_score: 0.9266; train_kl_reg_loss: 61847.1558; train_edge_recon_loss: 2688533.9313; train_gene_expr_recon_loss: 10266819.7863; train_masked_gp_l1_reg_loss: 75135.0976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88887.6699; train_chrom_access_recon_loss: 8762065.7901; train_global_loss: 21943289.4656; train_optim_loss: 21943289.4656; val_kl_reg_loss: 49060.0987; val_edge_recon_loss: 2703967.2333; val_gene_expr_recon_loss: 10310062.4000; val_masked_gp_l1_reg_loss: 73917.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88800.2422; val_chrom_access_recon_loss: 8865657.0667; val_global_loss: 22091464.8000; val_optim_loss: 22091464.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9725; val_auprc_score: 0.9657; val_best_acc_score: 0.9241; val_best_f1_score: 0.9255; train_kl_reg_loss: 60397.5526; train_edge_recon_loss: 2679812.0229; train_gene_expr_recon_loss: 10275338.9389; train_masked_gp_l1_reg_loss: 73026.1145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88472.3365; train_chrom_access_recon_loss: 8766200.7290; train_global_loss: 21943247.7710; train_optim_loss: 21943247.7710; val_kl_reg_loss: 52293.5229; val_edge_recon_loss: 2693053.5167; val_gene_expr_recon_loss: 10297580.8000; val_masked_gp_l1_reg_loss: 72261.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88125.2969; val_chrom_access_recon_loss: 8808993.7000; val_global_loss: 22012307.7333; val_optim_loss: 22012307.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9733; val_auprc_score: 0.9648; val_best_acc_score: 0.9295; val_best_f1_score: 0.9319; train_kl_reg_loss: 60956.4785; train_edge_recon_loss: 2668419.3149; train_gene_expr_recon_loss: 10257485.3359; train_masked_gp_l1_reg_loss: 71485.3534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88272.9008; train_chrom_access_recon_loss: 8742449.6412; train_global_loss: 21889068.9618; train_optim_loss: 21889068.9618; val_kl_reg_loss: 54648.2891; val_edge_recon_loss: 2687362.2167; val_gene_expr_recon_loss: 10301981.3333; val_masked_gp_l1_reg_loss: 70776.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88084.7969; val_chrom_access_recon_loss: 8837901.4000; val_global_loss: 22040754.0000; val_optim_loss: 22040754.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9714; val_auprc_score: 0.9625; val_best_acc_score: 0.9241; val_best_f1_score: 0.9262; train_kl_reg_loss: 60327.3151; train_edge_recon_loss: 2669888.0592; train_gene_expr_recon_loss: 10240224.1374; train_masked_gp_l1_reg_loss: 70202.6609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88199.9510; train_chrom_access_recon_loss: 8732322.2977; train_global_loss: 21861164.3817; train_optim_loss: 21861164.3817; val_kl_reg_loss: 52313.6479; val_edge_recon_loss: 2696226.5000; val_gene_expr_recon_loss: 10254484.6000; val_masked_gp_l1_reg_loss: 69727.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88354.8750; val_chrom_access_recon_loss: 8780116.7000; val_global_loss: 21941224.4000; val_optim_loss: 21941224.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9763; val_auprc_score: 0.9702; val_best_acc_score: 0.9310; val_best_f1_score: 0.9332; train_kl_reg_loss: 59046.3024; train_edge_recon_loss: 2681432.2405; train_gene_expr_recon_loss: 10226878.3282; train_masked_gp_l1_reg_loss: 69201.2984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88089.6406; train_chrom_access_recon_loss: 8710177.0305; train_global_loss: 21834824.8702; train_optim_loss: 21834824.8702; val_kl_reg_loss: 53009.2852; val_edge_recon_loss: 2679109.5167; val_gene_expr_recon_loss: 10270076.4667; val_masked_gp_l1_reg_loss: 68643.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88023.5547; val_chrom_access_recon_loss: 8812021.2000; val_global_loss: 21970883.7333; val_optim_loss: 21970883.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9718; val_auprc_score: 0.9602; val_best_acc_score: 0.9275; val_best_f1_score: 0.9297; train_kl_reg_loss: 58991.9420; train_edge_recon_loss: 2676940.2214; train_gene_expr_recon_loss: 10226875.4809; train_masked_gp_l1_reg_loss: 68285.4520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87976.3833; train_chrom_access_recon_loss: 8718487.5573; train_global_loss: 21837557.1298; train_optim_loss: 21837557.1298; val_kl_reg_loss: 54274.2529; val_edge_recon_loss: 2692529.8167; val_gene_expr_recon_loss: 10276174.6667; val_masked_gp_l1_reg_loss: 68022.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87842.7734; val_chrom_access_recon_loss: 8811196.4667; val_global_loss: 21990040.0000; val_optim_loss: 21990040.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9778; val_auprc_score: 0.9719; val_best_acc_score: 0.9340; val_best_f1_score: 0.9357; train_kl_reg_loss: 58601.7377; train_edge_recon_loss: 2667885.8473; train_gene_expr_recon_loss: 10206784.9237; train_masked_gp_l1_reg_loss: 67554.2835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87729.7629; train_chrom_access_recon_loss: 8702312.3969; train_global_loss: 21790868.9313; train_optim_loss: 21790868.9313; val_kl_reg_loss: 53525.1797; val_edge_recon_loss: 2671354.3667; val_gene_expr_recon_loss: 10259251.8667; val_masked_gp_l1_reg_loss: 67196.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87734.1328; val_chrom_access_recon_loss: 8810665.2667; val_global_loss: 21949726.5333; val_optim_loss: 21949726.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9797; val_auprc_score: 0.9750; val_best_acc_score: 0.9382; val_best_f1_score: 0.9402; train_kl_reg_loss: 58194.8408; train_edge_recon_loss: 2673570.6069; train_gene_expr_recon_loss: 10198870.8626; train_masked_gp_l1_reg_loss: 66825.6367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87573.5933; train_chrom_access_recon_loss: 8695419.3779; train_global_loss: 21780455.0229; train_optim_loss: 21780455.0229; val_kl_reg_loss: 52624.6883; val_edge_recon_loss: 2662044.1333; val_gene_expr_recon_loss: 10250265.2000; val_masked_gp_l1_reg_loss: 66522.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87860.8125; val_chrom_access_recon_loss: 8830741.6000; val_global_loss: 21950058.9333; val_optim_loss: 21950058.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9760; val_auprc_score: 0.9647; val_best_acc_score: 0.9353; val_best_f1_score: 0.9370; train_kl_reg_loss: 58701.9467; train_edge_recon_loss: 2667515.4771; train_gene_expr_recon_loss: 10194254.9008; train_masked_gp_l1_reg_loss: 65701.7611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70362.6545; train_chrom_access_recon_loss: 8690819.0115; train_global_loss: 21747355.6947; train_optim_loss: 21747355.6947; val_kl_reg_loss: 55014.0482; val_edge_recon_loss: 2685308.7333; val_gene_expr_recon_loss: 10224440.8000; val_masked_gp_l1_reg_loss: 65443.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68261.1016; val_chrom_access_recon_loss: 8772758.5000; val_global_loss: 21871227.4667; val_optim_loss: 21871227.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9780; val_auprc_score: 0.9692; val_best_acc_score: 0.9372; val_best_f1_score: 0.9393; train_kl_reg_loss: 59933.0120; train_edge_recon_loss: 2664189.3053; train_gene_expr_recon_loss: 10188403.7099; train_masked_gp_l1_reg_loss: 65358.8253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67849.2169; train_chrom_access_recon_loss: 8680760.6985; train_global_loss: 21726494.8702; train_optim_loss: 21726494.8702; val_kl_reg_loss: 55506.7203; val_edge_recon_loss: 2676739.5000; val_gene_expr_recon_loss: 10209171.7333; val_masked_gp_l1_reg_loss: 65306.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67597.5078; val_chrom_access_recon_loss: 8796377.7333; val_global_loss: 21870699.7333; val_optim_loss: 21870699.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9773; val_auprc_score: 0.9668; val_best_acc_score: 0.9321; val_best_f1_score: 0.9340; train_kl_reg_loss: 60271.2963; train_edge_recon_loss: 2659492.4408; train_gene_expr_recon_loss: 10194164.0992; train_masked_gp_l1_reg_loss: 65265.6097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67335.2251; train_chrom_access_recon_loss: 8687591.6641; train_global_loss: 21734120.3664; train_optim_loss: 21734120.3664; val_kl_reg_loss: 56239.0490; val_edge_recon_loss: 2696184.9667; val_gene_expr_recon_loss: 10224126.4000; val_masked_gp_l1_reg_loss: 65214.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67014.7578; val_chrom_access_recon_loss: 8774268.2333; val_global_loss: 21883047.6000; val_optim_loss: 21883047.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9770; val_auprc_score: 0.9704; val_best_acc_score: 0.9316; val_best_f1_score: 0.9334; train_kl_reg_loss: 60563.5060; train_edge_recon_loss: 2657230.7214; train_gene_expr_recon_loss: 10193636.8168; train_masked_gp_l1_reg_loss: 65174.6043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66856.8117; train_chrom_access_recon_loss: 8689662.4122; train_global_loss: 21733125.0076; train_optim_loss: 21733125.0076; val_kl_reg_loss: 56258.0237; val_edge_recon_loss: 2683601.9000; val_gene_expr_recon_loss: 10238728.6000; val_masked_gp_l1_reg_loss: 65136.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66575.7422; val_chrom_access_recon_loss: 8792951.6000; val_global_loss: 21903253.2000; val_optim_loss: 21903253.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9758; val_auprc_score: 0.9667; val_best_acc_score: 0.9314; val_best_f1_score: 0.9334; train_kl_reg_loss: 59927.0818; train_edge_recon_loss: 2663588.4408; train_gene_expr_recon_loss: 10181935.3282; train_masked_gp_l1_reg_loss: 65115.0448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66435.4927; train_chrom_access_recon_loss: 8678779.0038; train_global_loss: 21715780.4275; train_optim_loss: 21715780.4275; val_kl_reg_loss: 55451.0870; val_edge_recon_loss: 2677961.7500; val_gene_expr_recon_loss: 10258560.1333; val_masked_gp_l1_reg_loss: 65098.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66312.6719; val_chrom_access_recon_loss: 8771040.6000; val_global_loss: 21894424.8000; val_optim_loss: 21894424.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9765; val_auprc_score: 0.9694; val_best_acc_score: 0.9333; val_best_f1_score: 0.9345; train_kl_reg_loss: 60157.5119; train_edge_recon_loss: 2662548.5630; train_gene_expr_recon_loss: 10176986.2824; train_masked_gp_l1_reg_loss: 65055.8024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66152.3164; train_chrom_access_recon_loss: 8673914.3359; train_global_loss: 21704814.9771; train_optim_loss: 21704814.9771; val_kl_reg_loss: 56331.5758; val_edge_recon_loss: 2690950.5667; val_gene_expr_recon_loss: 10218937.9333; val_masked_gp_l1_reg_loss: 65009.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65962.8594; val_chrom_access_recon_loss: 8821419.3333; val_global_loss: 21918612.5333; val_optim_loss: 21918612.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9798; val_auprc_score: 0.9748; val_best_acc_score: 0.9365; val_best_f1_score: 0.9380; train_kl_reg_loss: 60361.3226; train_edge_recon_loss: 2662423.3645; train_gene_expr_recon_loss: 10183148.6870; train_masked_gp_l1_reg_loss: 64932.2658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64128.0961; train_chrom_access_recon_loss: 8683168.9008; train_global_loss: 21718162.6260; train_optim_loss: 21718162.6260; val_kl_reg_loss: 56228.2370; val_edge_recon_loss: 2682687.6167; val_gene_expr_recon_loss: 10205023.8667; val_masked_gp_l1_reg_loss: 64905.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63913.5703; val_chrom_access_recon_loss: 8754296.2667; val_global_loss: 21827055.6000; val_optim_loss: 21827055.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9793; val_auprc_score: 0.9720; val_best_acc_score: 0.9383; val_best_f1_score: 0.9402; train_kl_reg_loss: 60486.8547; train_edge_recon_loss: 2666865.2214; train_gene_expr_recon_loss: 10175399.7710; train_masked_gp_l1_reg_loss: 64893.4683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63868.6701; train_chrom_access_recon_loss: 8672604.7672; train_global_loss: 21704118.8244; train_optim_loss: 21704118.8244; val_kl_reg_loss: 56335.7286; val_edge_recon_loss: 2664753.4500; val_gene_expr_recon_loss: 10191894.6000; val_masked_gp_l1_reg_loss: 64884.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63824.7148; val_chrom_access_recon_loss: 8747095.3333; val_global_loss: 21788789.3333; val_optim_loss: 21788789.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9788; val_auprc_score: 0.9708; val_best_acc_score: 0.9369; val_best_f1_score: 0.9384; train_kl_reg_loss: 60384.2777; train_edge_recon_loss: 2666121.3798; train_gene_expr_recon_loss: 10173138.1756; train_masked_gp_l1_reg_loss: 64878.3101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63786.6821; train_chrom_access_recon_loss: 8678412.5000; train_global_loss: 21706721.2672; train_optim_loss: 21706721.2672; val_kl_reg_loss: 56593.5344; val_edge_recon_loss: 2671189.0833; val_gene_expr_recon_loss: 10219159.8000; val_masked_gp_l1_reg_loss: 64871.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63755.9258; val_chrom_access_recon_loss: 8776060.0667; val_global_loss: 21851629.4667; val_optim_loss: 21851629.4667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9792; val_auprc_score: 0.9732; val_best_acc_score: 0.9373; val_best_f1_score: 0.9395; train_kl_reg_loss: 60407.6031; train_edge_recon_loss: 2659748.9981; train_gene_expr_recon_loss: 10180647.1145; train_masked_gp_l1_reg_loss: 64866.0559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63720.8536; train_chrom_access_recon_loss: 8679497.0076; train_global_loss: 21708887.7863; train_optim_loss: 21708887.7863; val_kl_reg_loss: 56122.6807; val_edge_recon_loss: 2670417.9333; val_gene_expr_recon_loss: 10241154.8000; val_masked_gp_l1_reg_loss: 64861.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63698.4414; val_chrom_access_recon_loss: 8801312.1667; val_global_loss: 21897566.6667; val_optim_loss: 21897566.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9788; val_auprc_score: 0.9718; val_best_acc_score: 0.9372; val_best_f1_score: 0.9382; train_kl_reg_loss: 60505.5528; train_edge_recon_loss: 2660440.5992; train_gene_expr_recon_loss: 10169194.8092; train_masked_gp_l1_reg_loss: 64856.9889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63670.2674; train_chrom_access_recon_loss: 8672043.6336; train_global_loss: 21690711.9084; train_optim_loss: 21690711.9084; val_kl_reg_loss: 56516.6609; val_edge_recon_loss: 2671155.4000; val_gene_expr_recon_loss: 10245526.7333; val_masked_gp_l1_reg_loss: 64850.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63643.9141; val_chrom_access_recon_loss: 8794405.6000; val_global_loss: 21896099.4667; val_optim_loss: 21896099.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9775; val_auprc_score: 0.9695; val_best_acc_score: 0.9355; val_best_f1_score: 0.9375; train_kl_reg_loss: 60557.2559; train_edge_recon_loss: 2658391.0134; train_gene_expr_recon_loss: 10192597.5725; train_masked_gp_l1_reg_loss: 64847.1190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63613.1614; train_chrom_access_recon_loss: 8680703.1069; train_global_loss: 21720709.2366; train_optim_loss: 21720709.2366; val_kl_reg_loss: 56904.0451; val_edge_recon_loss: 2681045.3333; val_gene_expr_recon_loss: 10213390.3333; val_masked_gp_l1_reg_loss: 64843.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63592.5156; val_chrom_access_recon_loss: 8755146.5000; val_global_loss: 21834922.5333; val_optim_loss: 21834922.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9781; val_auprc_score: 0.9705; val_best_acc_score: 0.9388; val_best_f1_score: 0.9404; train_kl_reg_loss: 60573.9232; train_edge_recon_loss: 2665421.1794; train_gene_expr_recon_loss: 10184334.8931; train_masked_gp_l1_reg_loss: 64835.1369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63405.7810; train_chrom_access_recon_loss: 8689447.3855; train_global_loss: 21728018.1985; train_optim_loss: 21728018.1985; val_kl_reg_loss: 56444.6128; val_edge_recon_loss: 2672778.4167; val_gene_expr_recon_loss: 10231877.1333; val_masked_gp_l1_reg_loss: 64832.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63384.9727; val_chrom_access_recon_loss: 8789422.7333; val_global_loss: 21878739.8667; val_optim_loss: 21878739.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9785; val_auprc_score: 0.9728; val_best_acc_score: 0.9321; val_best_f1_score: 0.9348; train_kl_reg_loss: 60521.3930; train_edge_recon_loss: 2663951.8817; train_gene_expr_recon_loss: 10189194.9466; train_masked_gp_l1_reg_loss: 64831.1916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63379.8341; train_chrom_access_recon_loss: 8683868.6565; train_global_loss: 21725747.8626; train_optim_loss: 21725747.8626; val_kl_reg_loss: 56844.0529; val_edge_recon_loss: 2677958.9000; val_gene_expr_recon_loss: 10212133.7333; val_masked_gp_l1_reg_loss: 64830.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63375.9180; val_chrom_access_recon_loss: 8788895.1333; val_global_loss: 21864037.7333; val_optim_loss: 21864037.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9774; val_auprc_score: 0.9717; val_best_acc_score: 0.9360; val_best_f1_score: 0.9382; train_kl_reg_loss: 60636.2800; train_edge_recon_loss: 2664110.2882; train_gene_expr_recon_loss: 10182074.9618; train_masked_gp_l1_reg_loss: 64829.1505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63372.6930; train_chrom_access_recon_loss: 8687342.3817; train_global_loss: 21722365.7557; train_optim_loss: 21722365.7557; val_kl_reg_loss: 56410.2190; val_edge_recon_loss: 2688949.4000; val_gene_expr_recon_loss: 10222901.0667; val_masked_gp_l1_reg_loss: 64828.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63369.2031; val_chrom_access_recon_loss: 8777744.2000; val_global_loss: 21874201.7333; val_optim_loss: 21874201.7333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9771; val_auprc_score: 0.9685; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 60598.4022; train_edge_recon_loss: 2665522.5802; train_gene_expr_recon_loss: 10177729.0000; train_masked_gp_l1_reg_loss: 64827.5626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63366.0493; train_chrom_access_recon_loss: 8680577.5954; train_global_loss: 21712621.1450; train_optim_loss: 21712621.1450; val_kl_reg_loss: 56575.9724; val_edge_recon_loss: 2684876.1167; val_gene_expr_recon_loss: 10213418.8000; val_masked_gp_l1_reg_loss: 64826.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63363.0312; val_chrom_access_recon_loss: 8775979.6000; val_global_loss: 21859040.4000; val_optim_loss: 21859040.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 4 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9762
val AUPRC score: 0.9679
val best accuracy score: 0.9324
val best F1 score: 0.9341
val target rna MSE score: 1.8744
val source rna MSE score: 0.7690
val target atac MSE score: 0.3461
val source atac MSE score: 0.1034
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
