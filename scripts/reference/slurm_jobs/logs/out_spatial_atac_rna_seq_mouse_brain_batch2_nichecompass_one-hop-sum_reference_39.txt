[True]
Run timestamp: 10082023_203220_39.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_39']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7189; val_auprc_score: 0.7552; val_best_acc_score: 0.5078; val_best_f1_score: 0.6696; train_kl_reg_loss: 93798.2033; train_edge_recon_loss: 3764828.1718; train_gene_expr_recon_loss: 28599338.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28857542.9466; train_global_loss: 61315507.6947; train_optim_loss: 61315507.6947; val_kl_reg_loss: 57179.1029; val_edge_recon_loss: 4064820.6833; val_gene_expr_recon_loss: 23916621.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 26366903.3333; val_global_loss: 54405525.0667; val_optim_loss: 54405525.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7684; val_auprc_score: 0.7915; val_best_acc_score: 0.6024; val_best_f1_score: 0.7048; train_kl_reg_loss: 139514.4077; train_edge_recon_loss: 3652293.5954; train_gene_expr_recon_loss: 23344874.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25968811.9084; train_global_loss: 53105494.5954; train_optim_loss: 53105494.5954; val_kl_reg_loss: 160891.7802; val_edge_recon_loss: 4059292.6500; val_gene_expr_recon_loss: 22291642.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25711604.5333; val_global_loss: 52223431.4667; val_optim_loss: 52223431.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8191; val_auprc_score: 0.8278; val_best_acc_score: 0.7315; val_best_f1_score: 0.7218; train_kl_reg_loss: 156612.2908; train_edge_recon_loss: 3552788.4580; train_gene_expr_recon_loss: 22349272.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25587091.8626; train_global_loss: 51645764.8855; train_optim_loss: 51645764.8855; val_kl_reg_loss: 150587.6677; val_edge_recon_loss: 4016185.7333; val_gene_expr_recon_loss: 21991936.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25621047.4667; val_global_loss: 51779757.6000; val_optim_loss: 51779757.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8825; val_auprc_score: 0.8721; val_best_acc_score: 0.7975; val_best_f1_score: 0.8178; train_kl_reg_loss: 131978.3260; train_edge_recon_loss: 3494114.1489; train_gene_expr_recon_loss: 22114979.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25445108.1527; train_global_loss: 51186180.1527; train_optim_loss: 51186180.1527; val_kl_reg_loss: 116521.4026; val_edge_recon_loss: 3513124.0333; val_gene_expr_recon_loss: 21710686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25342941.7333; val_global_loss: 50683273.3333; val_optim_loss: 50683273.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8888; val_auprc_score: 0.8774; val_best_acc_score: 0.8015; val_best_f1_score: 0.8136; train_kl_reg_loss: 135446.7132; train_edge_recon_loss: 3137528.6336; train_gene_expr_recon_loss: 21935666.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25269604.8702; train_global_loss: 50478247.2977; train_optim_loss: 50478247.2977; val_kl_reg_loss: 149602.6135; val_edge_recon_loss: 3023394.8000; val_gene_expr_recon_loss: 21628017.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25284216.4000; val_global_loss: 50085231.2000; val_optim_loss: 50085231.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9025; val_auprc_score: 0.8874; val_best_acc_score: 0.8220; val_best_f1_score: 0.8374; train_kl_reg_loss: 153321.8861; train_edge_recon_loss: 2992451.2042; train_gene_expr_recon_loss: 21792165.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25150051.6031; train_global_loss: 50087989.8626; train_optim_loss: 50087989.8626; val_kl_reg_loss: 152699.9521; val_edge_recon_loss: 2956012.7667; val_gene_expr_recon_loss: 21469895.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25070613.3333; val_global_loss: 49649221.3333; val_optim_loss: 49649221.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9126; val_auprc_score: 0.8956; val_best_acc_score: 0.8367; val_best_f1_score: 0.8486; train_kl_reg_loss: 149333.6596; train_edge_recon_loss: 2950039.7576; train_gene_expr_recon_loss: 21662177.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25047640.0000; train_global_loss: 49809190.9313; train_optim_loss: 49809190.9313; val_kl_reg_loss: 146944.0323; val_edge_recon_loss: 2902025.7167; val_gene_expr_recon_loss: 21368532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25010103.8667; val_global_loss: 49427605.3333; val_optim_loss: 49427605.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9171; val_auprc_score: 0.8988; val_best_acc_score: 0.8477; val_best_f1_score: 0.8578; train_kl_reg_loss: 146089.9809; train_edge_recon_loss: 2899297.3092; train_gene_expr_recon_loss: 21551671.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24936609.8473; train_global_loss: 49533669.0076; train_optim_loss: 49533669.0076; val_kl_reg_loss: 149810.2969; val_edge_recon_loss: 2876226.8167; val_gene_expr_recon_loss: 21217528.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24863375.7333; val_global_loss: 49106941.3333; val_optim_loss: 49106941.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9231; val_auprc_score: 0.9071; val_best_acc_score: 0.8546; val_best_f1_score: 0.8638; train_kl_reg_loss: 142673.9612; train_edge_recon_loss: 2871783.8989; train_gene_expr_recon_loss: 21441701.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24808457.2977; train_global_loss: 49264616.5191; train_optim_loss: 49264616.5191; val_kl_reg_loss: 139597.9302; val_edge_recon_loss: 2890652.4000; val_gene_expr_recon_loss: 21112302.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24724780.8000; val_global_loss: 48867333.8667; val_optim_loss: 48867333.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9353; val_auprc_score: 0.9217; val_best_acc_score: 0.8678; val_best_f1_score: 0.8772; train_kl_reg_loss: 138468.4354; train_edge_recon_loss: 2852590.9599; train_gene_expr_recon_loss: 21369622.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24770287.8473; train_global_loss: 49130970.1374; train_optim_loss: 49130970.1374; val_kl_reg_loss: 137555.6406; val_edge_recon_loss: 2842707.6167; val_gene_expr_recon_loss: 21111058.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24694913.4667; val_global_loss: 48786235.2000; val_optim_loss: 48786235.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9401; val_auprc_score: 0.9265; val_best_acc_score: 0.8756; val_best_f1_score: 0.8818; train_kl_reg_loss: 134369.6083; train_edge_recon_loss: 2837285.6947; train_gene_expr_recon_loss: 21304626.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24698998.5954; train_global_loss: 48975280.6412; train_optim_loss: 48975280.6412; val_kl_reg_loss: 134287.4802; val_edge_recon_loss: 2827372.9667; val_gene_expr_recon_loss: 20979180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24593562.6667; val_global_loss: 48534402.9333; val_optim_loss: 48534402.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9466; val_auprc_score: 0.9356; val_best_acc_score: 0.8833; val_best_f1_score: 0.8890; train_kl_reg_loss: 131046.8356; train_edge_recon_loss: 2823565.0782; train_gene_expr_recon_loss: 21214119.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24603459.7099; train_global_loss: 48772190.9008; train_optim_loss: 48772190.9008; val_kl_reg_loss: 130620.1880; val_edge_recon_loss: 2805328.3833; val_gene_expr_recon_loss: 20958921.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24629673.7333; val_global_loss: 48524543.2000; val_optim_loss: 48524543.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9463; val_auprc_score: 0.9323; val_best_acc_score: 0.8805; val_best_f1_score: 0.8860; train_kl_reg_loss: 126835.5755; train_edge_recon_loss: 2804309.5000; train_gene_expr_recon_loss: 21160403.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24559674.6718; train_global_loss: 48651223.4809; train_optim_loss: 48651223.4809; val_kl_reg_loss: 125038.9089; val_edge_recon_loss: 2824979.6500; val_gene_expr_recon_loss: 20905089.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24471945.6000; val_global_loss: 48327053.6000; val_optim_loss: 48327053.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9463; val_auprc_score: 0.9316; val_best_acc_score: 0.8839; val_best_f1_score: 0.8890; train_kl_reg_loss: 122924.1087; train_edge_recon_loss: 2795590.2118; train_gene_expr_recon_loss: 21101646.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24504752.4885; train_global_loss: 48524913.8015; train_optim_loss: 48524913.8015; val_kl_reg_loss: 118797.3708; val_edge_recon_loss: 2807159.5833; val_gene_expr_recon_loss: 20910166.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24599803.6000; val_global_loss: 48435927.4667; val_optim_loss: 48435927.4667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9505; val_auprc_score: 0.9393; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 120538.4449; train_edge_recon_loss: 2786857.4103; train_gene_expr_recon_loss: 21062365.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24481057.1756; train_global_loss: 48450819.1145; train_optim_loss: 48450819.1145; val_kl_reg_loss: 120081.0312; val_edge_recon_loss: 2788689.4000; val_gene_expr_recon_loss: 20756027.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24376679.3333; val_global_loss: 48041477.0667; val_optim_loss: 48041477.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9518; val_auprc_score: 0.9409; val_best_acc_score: 0.8867; val_best_f1_score: 0.8919; train_kl_reg_loss: 117086.1512; train_edge_recon_loss: 2780683.3092; train_gene_expr_recon_loss: 21007277.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24417554.8244; train_global_loss: 48322602.1069; train_optim_loss: 48322602.1069; val_kl_reg_loss: 112381.6380; val_edge_recon_loss: 2788757.9000; val_gene_expr_recon_loss: 20795015.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24469390.9333; val_global_loss: 48165545.8667; val_optim_loss: 48165545.8667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9452; val_best_acc_score: 0.8917; val_best_f1_score: 0.8960; train_kl_reg_loss: 114598.7080; train_edge_recon_loss: 2770565.9637; train_gene_expr_recon_loss: 20957117.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24381060.6260; train_global_loss: 48223342.4427; train_optim_loss: 48223342.4427; val_kl_reg_loss: 114329.3979; val_edge_recon_loss: 2784065.7500; val_gene_expr_recon_loss: 20695035.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24328155.6000; val_global_loss: 47921585.8667; val_optim_loss: 47921585.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9575; val_auprc_score: 0.9480; val_best_acc_score: 0.8948; val_best_f1_score: 0.9001; train_kl_reg_loss: 112185.9422; train_edge_recon_loss: 2771962.9237; train_gene_expr_recon_loss: 20917898.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24359403.5420; train_global_loss: 48161450.3206; train_optim_loss: 48161450.3206; val_kl_reg_loss: 110070.6953; val_edge_recon_loss: 2761837.1833; val_gene_expr_recon_loss: 20734788.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24351583.3333; val_global_loss: 47958279.4667; val_optim_loss: 47958279.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9589; val_auprc_score: 0.9487; val_best_acc_score: 0.9008; val_best_f1_score: 0.9054; train_kl_reg_loss: 109502.8623; train_edge_recon_loss: 2752227.5305; train_gene_expr_recon_loss: 20879358.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24324533.1298; train_global_loss: 48065621.4962; train_optim_loss: 48065621.4962; val_kl_reg_loss: 107093.3042; val_edge_recon_loss: 2777171.1500; val_gene_expr_recon_loss: 20652323.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24297137.6000; val_global_loss: 47833726.4000; val_optim_loss: 47833726.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9619; val_auprc_score: 0.9520; val_best_acc_score: 0.9030; val_best_f1_score: 0.9072; train_kl_reg_loss: 107944.3939; train_edge_recon_loss: 2747390.7405; train_gene_expr_recon_loss: 20848466.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24301240.6107; train_global_loss: 48005042.3511; train_optim_loss: 48005042.3511; val_kl_reg_loss: 105389.3443; val_edge_recon_loss: 2761965.8667; val_gene_expr_recon_loss: 20633643.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24328094.9333; val_global_loss: 47829093.8667; val_optim_loss: 47829093.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9589; val_auprc_score: 0.9482; val_best_acc_score: 0.9035; val_best_f1_score: 0.9087; train_kl_reg_loss: 105667.7112; train_edge_recon_loss: 2747705.8435; train_gene_expr_recon_loss: 20788693.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24230804.9313; train_global_loss: 47872871.6336; train_optim_loss: 47872871.6336; val_kl_reg_loss: 103909.0875; val_edge_recon_loss: 2767476.7333; val_gene_expr_recon_loss: 20553280.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24209380.9333; val_global_loss: 47634047.2000; val_optim_loss: 47634047.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9627; val_auprc_score: 0.9529; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 103900.1514; train_edge_recon_loss: 2744582.0248; train_gene_expr_recon_loss: 20781429.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24233528.7176; train_global_loss: 47863440.4580; train_optim_loss: 47863440.4580; val_kl_reg_loss: 101948.6250; val_edge_recon_loss: 2739815.8167; val_gene_expr_recon_loss: 20572596.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24247592.4000; val_global_loss: 47661953.0667; val_optim_loss: 47661953.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9658; val_auprc_score: 0.9548; val_best_acc_score: 0.9122; val_best_f1_score: 0.9155; train_kl_reg_loss: 102904.6834; train_edge_recon_loss: 2738424.7500; train_gene_expr_recon_loss: 20744541.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24209610.0763; train_global_loss: 47795481.1908; train_optim_loss: 47795481.1908; val_kl_reg_loss: 100271.5443; val_edge_recon_loss: 2747267.2667; val_gene_expr_recon_loss: 20617525.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24338895.7333; val_global_loss: 47803960.2667; val_optim_loss: 47803960.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9678; val_auprc_score: 0.9597; val_best_acc_score: 0.9154; val_best_f1_score: 0.9184; train_kl_reg_loss: 99790.5841; train_edge_recon_loss: 2736081.2023; train_gene_expr_recon_loss: 20711632.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24173804.5344; train_global_loss: 47721309.2519; train_optim_loss: 47721309.2519; val_kl_reg_loss: 97258.5984; val_edge_recon_loss: 2743426.0333; val_gene_expr_recon_loss: 20456720.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24205090.1333; val_global_loss: 47502496.5333; val_optim_loss: 47502496.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9698; val_auprc_score: 0.9635; val_best_acc_score: 0.9166; val_best_f1_score: 0.9194; train_kl_reg_loss: 98353.1462; train_edge_recon_loss: 2736948.9427; train_gene_expr_recon_loss: 20694808.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24181127.3893; train_global_loss: 47711237.5878; train_optim_loss: 47711237.5878; val_kl_reg_loss: 97428.1792; val_edge_recon_loss: 2729923.7500; val_gene_expr_recon_loss: 20516440.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24141574.1333; val_global_loss: 47485366.4000; val_optim_loss: 47485366.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9690; val_auprc_score: 0.9574; val_best_acc_score: 0.9181; val_best_f1_score: 0.9211; train_kl_reg_loss: 100753.5262; train_edge_recon_loss: 2752147.0553; train_gene_expr_recon_loss: 20950127.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24274434.6260; train_global_loss: 48077462.2290; train_optim_loss: 48077462.2290; val_kl_reg_loss: 71748.8479; val_edge_recon_loss: 2737744.5333; val_gene_expr_recon_loss: 20770545.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24340565.7333; val_global_loss: 47920604.2667; val_optim_loss: 47920604.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9698; val_auprc_score: 0.9607; val_best_acc_score: 0.9202; val_best_f1_score: 0.9225; train_kl_reg_loss: 98825.9996; train_edge_recon_loss: 2741751.8302; train_gene_expr_recon_loss: 20890376.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24256999.9847; train_global_loss: 47987954.5344; train_optim_loss: 47987954.5344; val_kl_reg_loss: 72303.5745; val_edge_recon_loss: 2738221.5000; val_gene_expr_recon_loss: 20632698.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24186842.9333; val_global_loss: 47630066.1333; val_optim_loss: 47630066.1333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9713; val_auprc_score: 0.9633; val_best_acc_score: 0.9209; val_best_f1_score: 0.9232; train_kl_reg_loss: 96039.8232; train_edge_recon_loss: 2728142.2195; train_gene_expr_recon_loss: 20818602.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24171831.4656; train_global_loss: 47814615.9695; train_optim_loss: 47814615.9695; val_kl_reg_loss: 74426.7495; val_edge_recon_loss: 2746081.3333; val_gene_expr_recon_loss: 20696286.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24231363.0667; val_global_loss: 47748157.3333; val_optim_loss: 47748157.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9742; val_auprc_score: 0.9671; val_best_acc_score: 0.9231; val_best_f1_score: 0.9248; train_kl_reg_loss: 92107.5472; train_edge_recon_loss: 2729986.0821; train_gene_expr_recon_loss: 20846566.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24238516.7481; train_global_loss: 47907176.7023; train_optim_loss: 47907176.7023; val_kl_reg_loss: 74194.0865; val_edge_recon_loss: 2744777.0167; val_gene_expr_recon_loss: 20649338.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24233126.5333; val_global_loss: 47701436.2667; val_optim_loss: 47701436.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9737; val_auprc_score: 0.9667; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 89920.5948; train_edge_recon_loss: 2713306.0916; train_gene_expr_recon_loss: 20806090.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24203509.8473; train_global_loss: 47812827.0229; train_optim_loss: 47812827.0229; val_kl_reg_loss: 75262.5094; val_edge_recon_loss: 2723390.1833; val_gene_expr_recon_loss: 20622280.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24198842.2667; val_global_loss: 47619775.7333; val_optim_loss: 47619775.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9765; val_auprc_score: 0.9715; val_best_acc_score: 0.9293; val_best_f1_score: 0.9312; train_kl_reg_loss: 90328.4051; train_edge_recon_loss: 2718122.5592; train_gene_expr_recon_loss: 20783737.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24183794.8244; train_global_loss: 47775983.1450; train_optim_loss: 47775983.1450; val_kl_reg_loss: 75501.5266; val_edge_recon_loss: 2730027.7333; val_gene_expr_recon_loss: 20638142.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24255945.8667; val_global_loss: 47699617.6000; val_optim_loss: 47699617.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9737; val_auprc_score: 0.9664; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 90725.5558; train_edge_recon_loss: 2712408.7786; train_gene_expr_recon_loss: 20803355.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24205880.1985; train_global_loss: 47812370.2595; train_optim_loss: 47812370.2595; val_kl_reg_loss: 75669.2339; val_edge_recon_loss: 2706337.3000; val_gene_expr_recon_loss: 20627483.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24278338.8000; val_global_loss: 47687829.6000; val_optim_loss: 47687829.6000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9722; val_auprc_score: 0.9655; val_best_acc_score: 0.9252; val_best_f1_score: 0.9278; train_kl_reg_loss: 90166.5834; train_edge_recon_loss: 2706307.0248; train_gene_expr_recon_loss: 20804251.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24213683.4656; train_global_loss: 47814408.9771; train_optim_loss: 47814408.9771; val_kl_reg_loss: 76122.4396; val_edge_recon_loss: 2719750.4667; val_gene_expr_recon_loss: 20549894.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24164570.8000; val_global_loss: 47510337.8667; val_optim_loss: 47510337.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 51 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9701
val AUPRC score: 0.9609
val best accuracy score: 0.9210
val best F1 score: 0.9225
val target rna MSE score: 0.8668
val source rna MSE score: 24.0051
val target atac MSE score: 0.3393
val source atac MSE score: 2.4931
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
