[True]
Run timestamp: 07092023_181058_73.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_73']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7438; val_auprc_score: 0.7681; val_best_acc_score: 0.5397; val_best_f1_score: 0.6823; train_kl_reg_loss: 89542.4788; train_edge_recon_loss: 3560330.7481; train_gene_expr_recon_loss: 20962330.3664; train_masked_gp_l1_reg_loss: 128448.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3506351.2197; train_chrom_access_recon_loss: 2719575.7405; train_global_loss: 30966579.3740; train_optim_loss: 30966579.3740; val_kl_reg_loss: 137969.3240; val_edge_recon_loss: 4063073.3333; val_gene_expr_recon_loss: 19816079.3333; val_masked_gp_l1_reg_loss: 115427.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 414964.6562; val_chrom_access_recon_loss: 2582217.7167; val_global_loss: 27129731.4667; val_optim_loss: 27129731.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8717; val_auprc_score: 0.8720; val_best_acc_score: 0.7966; val_best_f1_score: 0.8051; train_kl_reg_loss: 110637.2312; train_edge_recon_loss: 3527938.4447; train_gene_expr_recon_loss: 19677107.2977; train_masked_gp_l1_reg_loss: 114365.7499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233518.9664; train_chrom_access_recon_loss: 2604733.4905; train_global_loss: 26268301.2366; train_optim_loss: 26268301.2366; val_kl_reg_loss: 96211.8495; val_edge_recon_loss: 4032023.3000; val_gene_expr_recon_loss: 19488033.2000; val_masked_gp_l1_reg_loss: 116476.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158377.8125; val_chrom_access_recon_loss: 2543849.4500; val_global_loss: 26434971.7333; val_optim_loss: 26434971.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8872; val_auprc_score: 0.8766; val_best_acc_score: 0.8026; val_best_f1_score: 0.8134; train_kl_reg_loss: 88033.5724; train_edge_recon_loss: 3411183.9065; train_gene_expr_recon_loss: 19382789.9847; train_masked_gp_l1_reg_loss: 122073.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134486.5518; train_chrom_access_recon_loss: 2573547.3874; train_global_loss: 25712115.3435; train_optim_loss: 25712115.3435; val_kl_reg_loss: 99107.9641; val_edge_recon_loss: 3058762.8167; val_gene_expr_recon_loss: 19247019.6000; val_masked_gp_l1_reg_loss: 129885.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118488.8516; val_chrom_access_recon_loss: 2510438.5000; val_global_loss: 25163702.8000; val_optim_loss: 25163702.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9106; val_auprc_score: 0.8960; val_best_acc_score: 0.8366; val_best_f1_score: 0.8486; train_kl_reg_loss: 114050.8732; train_edge_recon_loss: 2951989.6126; train_gene_expr_recon_loss: 19165798.8702; train_masked_gp_l1_reg_loss: 135925.6704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111456.5004; train_chrom_access_recon_loss: 2546547.2557; train_global_loss: 25025768.8244; train_optim_loss: 25025768.8244; val_kl_reg_loss: 124650.5031; val_edge_recon_loss: 2902061.5667; val_gene_expr_recon_loss: 18976260.0000; val_masked_gp_l1_reg_loss: 138859.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108205.0234; val_chrom_access_recon_loss: 2481664.2667; val_global_loss: 24731702.5333; val_optim_loss: 24731702.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9236; val_auprc_score: 0.9064; val_best_acc_score: 0.8544; val_best_f1_score: 0.8630; train_kl_reg_loss: 126519.3672; train_edge_recon_loss: 2859192.7462; train_gene_expr_recon_loss: 18954235.7252; train_masked_gp_l1_reg_loss: 141725.6126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103986.1145; train_chrom_access_recon_loss: 2518822.3760; train_global_loss: 24704481.8931; train_optim_loss: 24704481.8931; val_kl_reg_loss: 119429.1203; val_edge_recon_loss: 2862335.6667; val_gene_expr_recon_loss: 18798412.0000; val_masked_gp_l1_reg_loss: 144118.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101840.9141; val_chrom_access_recon_loss: 2473676.9500; val_global_loss: 24499811.8667; val_optim_loss: 24499811.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9296; val_auprc_score: 0.9143; val_best_acc_score: 0.8650; val_best_f1_score: 0.8717; train_kl_reg_loss: 120442.8324; train_edge_recon_loss: 2837247.6908; train_gene_expr_recon_loss: 18767434.7939; train_masked_gp_l1_reg_loss: 146583.6370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100568.7999; train_chrom_access_recon_loss: 2495333.7424; train_global_loss: 24467611.4962; train_optim_loss: 24467611.4962; val_kl_reg_loss: 118340.8411; val_edge_recon_loss: 2856672.4667; val_gene_expr_recon_loss: 18563160.6667; val_masked_gp_l1_reg_loss: 148675.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99986.0469; val_chrom_access_recon_loss: 2437012.3333; val_global_loss: 24223848.6667; val_optim_loss: 24223848.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9316; val_auprc_score: 0.9148; val_best_acc_score: 0.8680; val_best_f1_score: 0.8748; train_kl_reg_loss: 118695.9644; train_edge_recon_loss: 2830673.8359; train_gene_expr_recon_loss: 18610261.5267; train_masked_gp_l1_reg_loss: 150240.1942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99192.8130; train_chrom_access_recon_loss: 2476214.9275; train_global_loss: 24285279.2061; train_optim_loss: 24285279.2061; val_kl_reg_loss: 118885.9260; val_edge_recon_loss: 2838964.8500; val_gene_expr_recon_loss: 18593304.9333; val_masked_gp_l1_reg_loss: 151628.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97810.7891; val_chrom_access_recon_loss: 2428851.6500; val_global_loss: 24229445.6000; val_optim_loss: 24229445.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9376; val_auprc_score: 0.9255; val_best_acc_score: 0.8727; val_best_f1_score: 0.8776; train_kl_reg_loss: 115715.3197; train_edge_recon_loss: 2809501.3588; train_gene_expr_recon_loss: 18460385.9695; train_masked_gp_l1_reg_loss: 152843.4831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96684.4941; train_chrom_access_recon_loss: 2456200.1966; train_global_loss: 24091330.7634; train_optim_loss: 24091330.7634; val_kl_reg_loss: 113224.8708; val_edge_recon_loss: 2828137.0833; val_gene_expr_recon_loss: 18392232.5333; val_masked_gp_l1_reg_loss: 153835.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95181.2266; val_chrom_access_recon_loss: 2407275.8833; val_global_loss: 23989888.4000; val_optim_loss: 23989888.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9462; val_auprc_score: 0.9342; val_best_acc_score: 0.8841; val_best_f1_score: 0.8897; train_kl_reg_loss: 114313.6267; train_edge_recon_loss: 2804140.5573; train_gene_expr_recon_loss: 18341515.2214; train_masked_gp_l1_reg_loss: 154914.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94456.2824; train_chrom_access_recon_loss: 2439548.5401; train_global_loss: 23948888.9771; train_optim_loss: 23948888.9771; val_kl_reg_loss: 115107.9620; val_edge_recon_loss: 2797996.3000; val_gene_expr_recon_loss: 18297802.4000; val_masked_gp_l1_reg_loss: 155866.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93892.4141; val_chrom_access_recon_loss: 2406491.8500; val_global_loss: 23867156.8000; val_optim_loss: 23867156.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9439; val_auprc_score: 0.9285; val_best_acc_score: 0.8820; val_best_f1_score: 0.8867; train_kl_reg_loss: 112917.9130; train_edge_recon_loss: 2785622.8969; train_gene_expr_recon_loss: 18255775.3893; train_masked_gp_l1_reg_loss: 156631.3299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92589.9964; train_chrom_access_recon_loss: 2426427.9905; train_global_loss: 23829965.4351; train_optim_loss: 23829965.4351; val_kl_reg_loss: 110192.5130; val_edge_recon_loss: 2804018.2500; val_gene_expr_recon_loss: 18091893.2000; val_masked_gp_l1_reg_loss: 157733.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92213.1719; val_chrom_access_recon_loss: 2375522.6167; val_global_loss: 23631574.4000; val_optim_loss: 23631574.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9469; val_auprc_score: 0.9372; val_best_acc_score: 0.8826; val_best_f1_score: 0.8879; train_kl_reg_loss: 111207.5090; train_edge_recon_loss: 2773244.2996; train_gene_expr_recon_loss: 18156530.8397; train_masked_gp_l1_reg_loss: 158594.8325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91010.8706; train_chrom_access_recon_loss: 2412404.1908; train_global_loss: 23702992.6412; train_optim_loss: 23702992.6412; val_kl_reg_loss: 111517.7927; val_edge_recon_loss: 2797940.7167; val_gene_expr_recon_loss: 18152109.0667; val_masked_gp_l1_reg_loss: 159444.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90324.7422; val_chrom_access_recon_loss: 2370960.6833; val_global_loss: 23682296.0000; val_optim_loss: 23682296.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9495; val_auprc_score: 0.9353; val_best_acc_score: 0.8886; val_best_f1_score: 0.8943; train_kl_reg_loss: 110032.8484; train_edge_recon_loss: 2766859.3969; train_gene_expr_recon_loss: 18068246.7023; train_masked_gp_l1_reg_loss: 160350.4475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89720.9911; train_chrom_access_recon_loss: 2400633.0744; train_global_loss: 23595843.4504; train_optim_loss: 23595843.4504; val_kl_reg_loss: 108772.4484; val_edge_recon_loss: 2780921.5667; val_gene_expr_recon_loss: 18069624.0000; val_masked_gp_l1_reg_loss: 161062.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89145.8906; val_chrom_access_recon_loss: 2364738.0833; val_global_loss: 23574264.2667; val_optim_loss: 23574264.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9525; val_auprc_score: 0.9399; val_best_acc_score: 0.8915; val_best_f1_score: 0.8970; train_kl_reg_loss: 110031.1075; train_edge_recon_loss: 2755919.0802; train_gene_expr_recon_loss: 17976901.2977; train_masked_gp_l1_reg_loss: 161844.2397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88667.0745; train_chrom_access_recon_loss: 2388208.4370; train_global_loss: 23481571.3130; train_optim_loss: 23481571.3130; val_kl_reg_loss: 109543.9156; val_edge_recon_loss: 2753124.5833; val_gene_expr_recon_loss: 17907664.4000; val_masked_gp_l1_reg_loss: 162612.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88350.5156; val_chrom_access_recon_loss: 2347034.5833; val_global_loss: 23368329.6000; val_optim_loss: 23368329.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9607; val_auprc_score: 0.9493; val_best_acc_score: 0.9035; val_best_f1_score: 0.9076; train_kl_reg_loss: 108892.3099; train_edge_recon_loss: 2752214.4179; train_gene_expr_recon_loss: 17921985.4656; train_masked_gp_l1_reg_loss: 162916.0862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88066.2773; train_chrom_access_recon_loss: 2380110.7519; train_global_loss: 23414185.2977; train_optim_loss: 23414185.2977; val_kl_reg_loss: 107512.9646; val_edge_recon_loss: 2731784.6333; val_gene_expr_recon_loss: 17886276.9333; val_masked_gp_l1_reg_loss: 163659.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88378.2188; val_chrom_access_recon_loss: 2340731.3500; val_global_loss: 23318343.6000; val_optim_loss: 23318343.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9591; val_auprc_score: 0.9503; val_best_acc_score: 0.8991; val_best_f1_score: 0.9021; train_kl_reg_loss: 109089.0361; train_edge_recon_loss: 2747954.5248; train_gene_expr_recon_loss: 17861148.0153; train_masked_gp_l1_reg_loss: 164112.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87730.1639; train_chrom_access_recon_loss: 2372250.2939; train_global_loss: 23342284.8550; train_optim_loss: 23342284.8550; val_kl_reg_loss: 104722.3411; val_edge_recon_loss: 2771451.3000; val_gene_expr_recon_loss: 17783646.5333; val_masked_gp_l1_reg_loss: 164797.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88027.4609; val_chrom_access_recon_loss: 2323581.0167; val_global_loss: 23236226.8000; val_optim_loss: 23236226.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9630; val_auprc_score: 0.9556; val_best_acc_score: 0.9031; val_best_f1_score: 0.9071; train_kl_reg_loss: 107658.4634; train_edge_recon_loss: 2733755.5172; train_gene_expr_recon_loss: 17798265.4885; train_masked_gp_l1_reg_loss: 165070.0717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87896.9335; train_chrom_access_recon_loss: 2361547.3416; train_global_loss: 23254193.6947; train_optim_loss: 23254193.6947; val_kl_reg_loss: 107372.9510; val_edge_recon_loss: 2736471.9167; val_gene_expr_recon_loss: 17773647.8667; val_masked_gp_l1_reg_loss: 165673.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88380.6016; val_chrom_access_recon_loss: 2316929.4500; val_global_loss: 23188476.4000; val_optim_loss: 23188476.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9644; val_auprc_score: 0.9562; val_best_acc_score: 0.9038; val_best_f1_score: 0.9066; train_kl_reg_loss: 107666.1742; train_edge_recon_loss: 2734568.8263; train_gene_expr_recon_loss: 17733315.0687; train_masked_gp_l1_reg_loss: 165972.4014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88444.0217; train_chrom_access_recon_loss: 2354329.9561; train_global_loss: 23184296.4275; train_optim_loss: 23184296.4275; val_kl_reg_loss: 105270.0214; val_edge_recon_loss: 2754856.8000; val_gene_expr_recon_loss: 17768854.4000; val_masked_gp_l1_reg_loss: 166680.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89562.5000; val_chrom_access_recon_loss: 2320989.0500; val_global_loss: 23206212.4000; val_optim_loss: 23206212.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9680; val_auprc_score: 0.9607; val_best_acc_score: 0.9138; val_best_f1_score: 0.9163; train_kl_reg_loss: 107415.8243; train_edge_recon_loss: 2726312.5382; train_gene_expr_recon_loss: 17693578.3817; train_masked_gp_l1_reg_loss: 166727.6044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89745.8588; train_chrom_access_recon_loss: 2346407.5134; train_global_loss: 23130187.6336; train_optim_loss: 23130187.6336; val_kl_reg_loss: 108126.9906; val_edge_recon_loss: 2723243.6167; val_gene_expr_recon_loss: 17680644.0000; val_masked_gp_l1_reg_loss: 167373.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90827.7266; val_chrom_access_recon_loss: 2303463.7667; val_global_loss: 23073680.4000; val_optim_loss: 23073680.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9691; val_auprc_score: 0.9625; val_best_acc_score: 0.9151; val_best_f1_score: 0.9173; train_kl_reg_loss: 106598.5115; train_edge_recon_loss: 2727934.1298; train_gene_expr_recon_loss: 17648100.0534; train_masked_gp_l1_reg_loss: 167630.0403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90743.7768; train_chrom_access_recon_loss: 2340256.3282; train_global_loss: 23081262.7023; train_optim_loss: 23081262.7023; val_kl_reg_loss: 109866.8307; val_edge_recon_loss: 2733559.9000; val_gene_expr_recon_loss: 17649823.4667; val_masked_gp_l1_reg_loss: 168131.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91636.9375; val_chrom_access_recon_loss: 2319943.5833; val_global_loss: 23072961.7333; val_optim_loss: 23072961.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9702; val_auprc_score: 0.9634; val_best_acc_score: 0.9163; val_best_f1_score: 0.9193; train_kl_reg_loss: 106481.3133; train_edge_recon_loss: 2725693.1870; train_gene_expr_recon_loss: 17599154.5191; train_masked_gp_l1_reg_loss: 168127.5611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91300.6871; train_chrom_access_recon_loss: 2334148.7901; train_global_loss: 23024905.9542; train_optim_loss: 23024905.9542; val_kl_reg_loss: 103846.2250; val_edge_recon_loss: 2730278.8500; val_gene_expr_recon_loss: 17594744.8000; val_masked_gp_l1_reg_loss: 168464.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91040.3594; val_chrom_access_recon_loss: 2297508.6500; val_global_loss: 22985882.4000; val_optim_loss: 22985882.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9663; val_auprc_score: 0.9529; val_best_acc_score: 0.9113; val_best_f1_score: 0.9146; train_kl_reg_loss: 105764.6975; train_edge_recon_loss: 2720161.4427; train_gene_expr_recon_loss: 17566021.5420; train_masked_gp_l1_reg_loss: 168866.3650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91455.0192; train_chrom_access_recon_loss: 2331481.3645; train_global_loss: 22983750.4275; train_optim_loss: 22983750.4275; val_kl_reg_loss: 106217.0693; val_edge_recon_loss: 2727345.0667; val_gene_expr_recon_loss: 17565176.1333; val_masked_gp_l1_reg_loss: 169627.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91785.7578; val_chrom_access_recon_loss: 2288102.7000; val_global_loss: 22948254.8000; val_optim_loss: 22948254.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9682; val_auprc_score: 0.9584; val_best_acc_score: 0.9144; val_best_f1_score: 0.9185; train_kl_reg_loss: 105913.2492; train_edge_recon_loss: 2724101.6069; train_gene_expr_recon_loss: 17521489.7328; train_masked_gp_l1_reg_loss: 169585.1141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91415.9057; train_chrom_access_recon_loss: 2323052.0496; train_global_loss: 22935557.6336; train_optim_loss: 22935557.6336; val_kl_reg_loss: 106326.6208; val_edge_recon_loss: 2732377.5000; val_gene_expr_recon_loss: 17519013.9333; val_masked_gp_l1_reg_loss: 169673.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90847.8125; val_chrom_access_recon_loss: 2283700.2167; val_global_loss: 22901940.5333; val_optim_loss: 22901940.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9666; val_auprc_score: 0.9544; val_best_acc_score: 0.9138; val_best_f1_score: 0.9177; train_kl_reg_loss: 104948.5918; train_edge_recon_loss: 2721231.8397; train_gene_expr_recon_loss: 17480368.7939; train_masked_gp_l1_reg_loss: 169994.5887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91248.2854; train_chrom_access_recon_loss: 2318175.7710; train_global_loss: 22885967.8626; train_optim_loss: 22885967.8626; val_kl_reg_loss: 104618.7240; val_edge_recon_loss: 2748419.9000; val_gene_expr_recon_loss: 17430650.7333; val_masked_gp_l1_reg_loss: 170468.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91644.2656; val_chrom_access_recon_loss: 2270283.2167; val_global_loss: 22816084.5333; val_optim_loss: 22816084.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9723; val_auprc_score: 0.9624; val_best_acc_score: 0.9174; val_best_f1_score: 0.9203; train_kl_reg_loss: 104568.2013; train_edge_recon_loss: 2718182.6603; train_gene_expr_recon_loss: 17458988.8244; train_masked_gp_l1_reg_loss: 170641.0264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91114.4131; train_chrom_access_recon_loss: 2314045.9819; train_global_loss: 22857541.0229; train_optim_loss: 22857541.0229; val_kl_reg_loss: 107799.6703; val_edge_recon_loss: 2737389.4667; val_gene_expr_recon_loss: 17456168.2667; val_masked_gp_l1_reg_loss: 171187.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91383.1172; val_chrom_access_recon_loss: 2278806.0333; val_global_loss: 22842735.3333; val_optim_loss: 22842735.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9716; val_auprc_score: 0.9636; val_best_acc_score: 0.9209; val_best_f1_score: 0.9234; train_kl_reg_loss: 104219.2006; train_edge_recon_loss: 2719840.3702; train_gene_expr_recon_loss: 17429343.9160; train_masked_gp_l1_reg_loss: 171190.4986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90906.0910; train_chrom_access_recon_loss: 2309092.4294; train_global_loss: 22824592.4427; train_optim_loss: 22824592.4427; val_kl_reg_loss: 100160.8500; val_edge_recon_loss: 2715480.0333; val_gene_expr_recon_loss: 17407249.9333; val_masked_gp_l1_reg_loss: 171517.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91604.4453; val_chrom_access_recon_loss: 2266780.7167; val_global_loss: 22752793.6000; val_optim_loss: 22752793.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9717; val_auprc_score: 0.9654; val_best_acc_score: 0.9171; val_best_f1_score: 0.9203; train_kl_reg_loss: 110483.2752; train_edge_recon_loss: 2757858.6240; train_gene_expr_recon_loss: 17008822.6641; train_masked_gp_l1_reg_loss: 168723.6472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87964.4074; train_chrom_access_recon_loss: 2254434.2195; train_global_loss: 22388286.9313; train_optim_loss: 22388286.9313; val_kl_reg_loss: 75199.4677; val_edge_recon_loss: 2765806.4833; val_gene_expr_recon_loss: 16945116.1333; val_masked_gp_l1_reg_loss: 167999.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88330.2891; val_chrom_access_recon_loss: 2207070.1667; val_global_loss: 22249522.2667; val_optim_loss: 22249522.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9744; val_auprc_score: 0.9680; val_best_acc_score: 0.9245; val_best_f1_score: 0.9265; train_kl_reg_loss: 105434.0370; train_edge_recon_loss: 2726236.9103; train_gene_expr_recon_loss: 16948690.5344; train_masked_gp_l1_reg_loss: 167791.7635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88491.3517; train_chrom_access_recon_loss: 2244422.9427; train_global_loss: 22281067.6336; train_optim_loss: 22281067.6336; val_kl_reg_loss: 82734.8349; val_edge_recon_loss: 2721752.8167; val_gene_expr_recon_loss: 16909689.5333; val_masked_gp_l1_reg_loss: 167350.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88643.5547; val_chrom_access_recon_loss: 2200216.0250; val_global_loss: 22170386.9333; val_optim_loss: 22170386.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9747; val_auprc_score: 0.9680; val_best_acc_score: 0.9235; val_best_f1_score: 0.9259; train_kl_reg_loss: 101503.1133; train_edge_recon_loss: 2721633.3492; train_gene_expr_recon_loss: 16891425.1450; train_masked_gp_l1_reg_loss: 166871.6331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88829.1088; train_chrom_access_recon_loss: 2238032.4399; train_global_loss: 22208294.7328; train_optim_loss: 22208294.7328; val_kl_reg_loss: 86572.5109; val_edge_recon_loss: 2730666.3167; val_gene_expr_recon_loss: 16885785.0667; val_masked_gp_l1_reg_loss: 166238.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88056.0391; val_chrom_access_recon_loss: 2205934.4667; val_global_loss: 22163252.2667; val_optim_loss: 22163252.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9756; val_auprc_score: 0.9656; val_best_acc_score: 0.9251; val_best_f1_score: 0.9269; train_kl_reg_loss: 100198.5480; train_edge_recon_loss: 2715655.2882; train_gene_expr_recon_loss: 16857165.7405; train_masked_gp_l1_reg_loss: 165842.0061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88469.4680; train_chrom_access_recon_loss: 2236138.1813; train_global_loss: 22163469.1603; train_optim_loss: 22163469.1603; val_kl_reg_loss: 88045.9870; val_edge_recon_loss: 2733636.2500; val_gene_expr_recon_loss: 16838059.4000; val_masked_gp_l1_reg_loss: 165303.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88543.6172; val_chrom_access_recon_loss: 2195777.9333; val_global_loss: 22109367.4667; val_optim_loss: 22109367.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9769; val_auprc_score: 0.9703; val_best_acc_score: 0.9279; val_best_f1_score: 0.9290; train_kl_reg_loss: 98142.7801; train_edge_recon_loss: 2719336.3244; train_gene_expr_recon_loss: 16825838.6870; train_masked_gp_l1_reg_loss: 165095.4847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88287.1720; train_chrom_access_recon_loss: 2232910.2672; train_global_loss: 22129610.7786; train_optim_loss: 22129610.7786; val_kl_reg_loss: 87425.4568; val_edge_recon_loss: 2733556.7833; val_gene_expr_recon_loss: 16793581.3333; val_masked_gp_l1_reg_loss: 164726.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88102.7109; val_chrom_access_recon_loss: 2186355.6167; val_global_loss: 22053747.4667; val_optim_loss: 22053747.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9738; val_auprc_score: 0.9663; val_best_acc_score: 0.9259; val_best_f1_score: 0.9284; train_kl_reg_loss: 96104.3989; train_edge_recon_loss: 2710646.8111; train_gene_expr_recon_loss: 16808442.7405; train_masked_gp_l1_reg_loss: 164808.7433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88149.1874; train_chrom_access_recon_loss: 2232417.4342; train_global_loss: 22100569.3130; train_optim_loss: 22100569.3130; val_kl_reg_loss: 89929.9224; val_edge_recon_loss: 2712800.9833; val_gene_expr_recon_loss: 16731385.2000; val_masked_gp_l1_reg_loss: 164733.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87971.2500; val_chrom_access_recon_loss: 2185183.1750; val_global_loss: 21972005.2000; val_optim_loss: 21972005.2000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9787; val_auprc_score: 0.9723; val_best_acc_score: 0.9329; val_best_f1_score: 0.9344; train_kl_reg_loss: 97030.7173; train_edge_recon_loss: 2709457.2844; train_gene_expr_recon_loss: 16784981.9542; train_masked_gp_l1_reg_loss: 164638.9018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88110.8174; train_chrom_access_recon_loss: 2229482.0668; train_global_loss: 22073701.8779; train_optim_loss: 22073701.8779; val_kl_reg_loss: 93641.8839; val_edge_recon_loss: 2722269.7000; val_gene_expr_recon_loss: 16849603.6000; val_masked_gp_l1_reg_loss: 164370.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87862.9609; val_chrom_access_recon_loss: 2198333.2667; val_global_loss: 22116080.8000; val_optim_loss: 22116080.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9793; val_auprc_score: 0.9731; val_best_acc_score: 0.9302; val_best_f1_score: 0.9318; train_kl_reg_loss: 96876.6357; train_edge_recon_loss: 2707812.6050; train_gene_expr_recon_loss: 16756828.9618; train_masked_gp_l1_reg_loss: 164366.7042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87902.5651; train_chrom_access_recon_loss: 2227070.3378; train_global_loss: 22040857.8931; train_optim_loss: 22040857.8931; val_kl_reg_loss: 90473.8594; val_edge_recon_loss: 2723211.3333; val_gene_expr_recon_loss: 16792563.5333; val_masked_gp_l1_reg_loss: 164287.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87797.4062; val_chrom_access_recon_loss: 2189290.9500; val_global_loss: 22047625.6000; val_optim_loss: 22047625.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9775; val_auprc_score: 0.9729; val_best_acc_score: 0.9305; val_best_f1_score: 0.9321; train_kl_reg_loss: 95754.8337; train_edge_recon_loss: 2708416.8321; train_gene_expr_recon_loss: 16742798.0458; train_masked_gp_l1_reg_loss: 164283.0279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87755.3826; train_chrom_access_recon_loss: 2224439.1412; train_global_loss: 22023447.2672; train_optim_loss: 22023447.2672; val_kl_reg_loss: 91828.8604; val_edge_recon_loss: 2714608.0500; val_gene_expr_recon_loss: 16838133.3333; val_masked_gp_l1_reg_loss: 164053.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87719.8594; val_chrom_access_recon_loss: 2204738.4083; val_global_loss: 22101083.2000; val_optim_loss: 22101083.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9803; val_auprc_score: 0.9719; val_best_acc_score: 0.9364; val_best_f1_score: 0.9381; train_kl_reg_loss: 95112.9741; train_edge_recon_loss: 2715464.6851; train_gene_expr_recon_loss: 16720373.1298; train_masked_gp_l1_reg_loss: 164169.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87746.0250; train_chrom_access_recon_loss: 2223166.0973; train_global_loss: 22006032.6565; train_optim_loss: 22006032.6565; val_kl_reg_loss: 91890.8958; val_edge_recon_loss: 2716762.2167; val_gene_expr_recon_loss: 16755228.0000; val_masked_gp_l1_reg_loss: 164312.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87914.4844; val_chrom_access_recon_loss: 2185695.9500; val_global_loss: 22001802.8000; val_optim_loss: 22001802.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9785; val_auprc_score: 0.9708; val_best_acc_score: 0.9313; val_best_f1_score: 0.9329; train_kl_reg_loss: 96150.2740; train_edge_recon_loss: 2706275.3149; train_gene_expr_recon_loss: 16709984.3053; train_masked_gp_l1_reg_loss: 161751.5833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68604.0766; train_chrom_access_recon_loss: 2222277.4103; train_global_loss: 21965042.9160; train_optim_loss: 21965042.9160; val_kl_reg_loss: 94282.3172; val_edge_recon_loss: 2716981.5167; val_gene_expr_recon_loss: 16686676.2000; val_masked_gp_l1_reg_loss: 160906.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66113.5234; val_chrom_access_recon_loss: 2176940.9583; val_global_loss: 21901900.9333; val_optim_loss: 21901900.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9804; val_auprc_score: 0.9746; val_best_acc_score: 0.9314; val_best_f1_score: 0.9335; train_kl_reg_loss: 98607.1849; train_edge_recon_loss: 2691957.0592; train_gene_expr_recon_loss: 16668801.4351; train_masked_gp_l1_reg_loss: 160677.6602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65582.8035; train_chrom_access_recon_loss: 2218846.6670; train_global_loss: 21904472.7328; train_optim_loss: 21904472.7328; val_kl_reg_loss: 95884.2661; val_edge_recon_loss: 2707267.0167; val_gene_expr_recon_loss: 16663333.9333; val_masked_gp_l1_reg_loss: 160472.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65215.9258; val_chrom_access_recon_loss: 2176447.9667; val_global_loss: 21868621.3333; val_optim_loss: 21868621.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9787; val_auprc_score: 0.9699; val_best_acc_score: 0.9349; val_best_f1_score: 0.9355; train_kl_reg_loss: 99638.3327; train_edge_recon_loss: 2701675.0153; train_gene_expr_recon_loss: 16682897.7557; train_masked_gp_l1_reg_loss: 160359.8432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64895.8881; train_chrom_access_recon_loss: 2221230.7500; train_global_loss: 21930697.3893; train_optim_loss: 21930697.3893; val_kl_reg_loss: 96739.8974; val_edge_recon_loss: 2712801.4500; val_gene_expr_recon_loss: 16724824.9333; val_masked_gp_l1_reg_loss: 160250.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64649.6875; val_chrom_access_recon_loss: 2187718.5083; val_global_loss: 21946984.8000; val_optim_loss: 21946984.8000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9785; val_auprc_score: 0.9723; val_best_acc_score: 0.9298; val_best_f1_score: 0.9316; train_kl_reg_loss: 99891.0630; train_edge_recon_loss: 2705214.1527; train_gene_expr_recon_loss: 16670041.9313; train_masked_gp_l1_reg_loss: 160169.0644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64429.6549; train_chrom_access_recon_loss: 2218998.2653; train_global_loss: 21918743.9084; train_optim_loss: 21918743.9084; val_kl_reg_loss: 97075.4766; val_edge_recon_loss: 2728197.2500; val_gene_expr_recon_loss: 16710395.2667; val_masked_gp_l1_reg_loss: 160119.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64179.5977; val_chrom_access_recon_loss: 2187769.1500; val_global_loss: 21947736.9333; val_optim_loss: 21947736.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9809; val_auprc_score: 0.9769; val_best_acc_score: 0.9367; val_best_f1_score: 0.9380; train_kl_reg_loss: 100245.5082; train_edge_recon_loss: 2699418.2424; train_gene_expr_recon_loss: 16676742.6870; train_masked_gp_l1_reg_loss: 160036.8144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63958.7023; train_chrom_access_recon_loss: 2220099.7948; train_global_loss: 21920501.9389; train_optim_loss: 21920501.9389; val_kl_reg_loss: 97806.5854; val_edge_recon_loss: 2715350.8833; val_gene_expr_recon_loss: 16755363.4000; val_masked_gp_l1_reg_loss: 159974.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63640.9531; val_chrom_access_recon_loss: 2184147.5417; val_global_loss: 21976282.5333; val_optim_loss: 21976282.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9800; val_auprc_score: 0.9752; val_best_acc_score: 0.9363; val_best_f1_score: 0.9375; train_kl_reg_loss: 100346.5823; train_edge_recon_loss: 2701252.7844; train_gene_expr_recon_loss: 16680279.8779; train_masked_gp_l1_reg_loss: 159924.8702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63551.5126; train_chrom_access_recon_loss: 2220613.0658; train_global_loss: 21925968.5191; train_optim_loss: 21925968.5191; val_kl_reg_loss: 96936.9417; val_edge_recon_loss: 2707201.7333; val_gene_expr_recon_loss: 16664005.5333; val_masked_gp_l1_reg_loss: 159887.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63529.2812; val_chrom_access_recon_loss: 2183551.6833; val_global_loss: 21875114.0000; val_optim_loss: 21875114.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9809; val_auprc_score: 0.9764; val_best_acc_score: 0.9352; val_best_f1_score: 0.9358; train_kl_reg_loss: 99850.8044; train_edge_recon_loss: 2700564.1050; train_gene_expr_recon_loss: 16665686.2595; train_masked_gp_l1_reg_loss: 159631.1739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61478.6173; train_chrom_access_recon_loss: 2218887.2252; train_global_loss: 21906098.2137; train_optim_loss: 21906098.2137; val_kl_reg_loss: 97194.7188; val_edge_recon_loss: 2696841.2833; val_gene_expr_recon_loss: 16714844.9333; val_masked_gp_l1_reg_loss: 159527.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61218.7031; val_chrom_access_recon_loss: 2176855.2167; val_global_loss: 21906482.2667; val_optim_loss: 21906482.2667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9817; val_auprc_score: 0.9775; val_best_acc_score: 0.9367; val_best_f1_score: 0.9374; train_kl_reg_loss: 100007.9243; train_edge_recon_loss: 2699865.7385; train_gene_expr_recon_loss: 16668024.5878; train_masked_gp_l1_reg_loss: 159488.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61153.4857; train_chrom_access_recon_loss: 2218735.2490; train_global_loss: 21907275.2366; train_optim_loss: 21907275.2366; val_kl_reg_loss: 97524.3448; val_edge_recon_loss: 2701993.9667; val_gene_expr_recon_loss: 16658351.0667; val_masked_gp_l1_reg_loss: 159449.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61087.6992; val_chrom_access_recon_loss: 2191317.4750; val_global_loss: 21869724.6667; val_optim_loss: 21869724.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9808; val_auprc_score: 0.9758; val_best_acc_score: 0.9364; val_best_f1_score: 0.9378; train_kl_reg_loss: 99902.3640; train_edge_recon_loss: 2700925.3569; train_gene_expr_recon_loss: 16672372.5802; train_masked_gp_l1_reg_loss: 159429.7607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61042.8194; train_chrom_access_recon_loss: 2218976.4962; train_global_loss: 21912649.4809; train_optim_loss: 21912649.4809; val_kl_reg_loss: 97308.1682; val_edge_recon_loss: 2710098.9167; val_gene_expr_recon_loss: 16694056.8000; val_masked_gp_l1_reg_loss: 159415.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61002.7930; val_chrom_access_recon_loss: 2184835.8000; val_global_loss: 21906717.4667; val_optim_loss: 21906717.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9820; val_auprc_score: 0.9788; val_best_acc_score: 0.9341; val_best_f1_score: 0.9360; train_kl_reg_loss: 100071.6595; train_edge_recon_loss: 2706653.5382; train_gene_expr_recon_loss: 16667637.8092; train_masked_gp_l1_reg_loss: 159404.4818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60969.7509; train_chrom_access_recon_loss: 2218276.8950; train_global_loss: 21913013.9695; train_optim_loss: 21913013.9695; val_kl_reg_loss: 97416.0411; val_edge_recon_loss: 2704408.7333; val_gene_expr_recon_loss: 16648305.4000; val_masked_gp_l1_reg_loss: 159389.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60938.8281; val_chrom_access_recon_loss: 2168399.0583; val_global_loss: 21838857.2000; val_optim_loss: 21838857.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9794; val_auprc_score: 0.9727; val_best_acc_score: 0.9329; val_best_f1_score: 0.9351; train_kl_reg_loss: 100134.5933; train_edge_recon_loss: 2697596.7786; train_gene_expr_recon_loss: 16668456.6260; train_masked_gp_l1_reg_loss: 159383.9578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60908.1978; train_chrom_access_recon_loss: 2219492.5181; train_global_loss: 21905972.6107; train_optim_loss: 21905972.6107; val_kl_reg_loss: 97605.2104; val_edge_recon_loss: 2701090.7333; val_gene_expr_recon_loss: 16695856.4667; val_masked_gp_l1_reg_loss: 159367.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60871.1172; val_chrom_access_recon_loss: 2182070.1083; val_global_loss: 21896862.1333; val_optim_loss: 21896862.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9790; val_auprc_score: 0.9739; val_best_acc_score: 0.9325; val_best_f1_score: 0.9341; train_kl_reg_loss: 100209.0851; train_edge_recon_loss: 2695161.3989; train_gene_expr_recon_loss: 16657840.2519; train_masked_gp_l1_reg_loss: 159362.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60837.7504; train_chrom_access_recon_loss: 2217836.9513; train_global_loss: 21891247.9084; train_optim_loss: 21891247.9084; val_kl_reg_loss: 97362.0865; val_edge_recon_loss: 2725254.4833; val_gene_expr_recon_loss: 16702207.3333; val_masked_gp_l1_reg_loss: 159349.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60821.5781; val_chrom_access_recon_loss: 2178171.8167; val_global_loss: 21923167.8667; val_optim_loss: 21923167.8667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9777; val_auprc_score: 0.9714; val_best_acc_score: 0.9316; val_best_f1_score: 0.9345; train_kl_reg_loss: 100203.4323; train_edge_recon_loss: 2698095.9809; train_gene_expr_recon_loss: 16666072.1298; train_masked_gp_l1_reg_loss: 159348.5147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60787.6271; train_chrom_access_recon_loss: 2219818.4418; train_global_loss: 21904325.8626; train_optim_loss: 21904325.8626; val_kl_reg_loss: 97801.7109; val_edge_recon_loss: 2701007.1500; val_gene_expr_recon_loss: 16741548.0000; val_masked_gp_l1_reg_loss: 159341.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60750.9531; val_chrom_access_recon_loss: 2189733.9333; val_global_loss: 21950182.9333; val_optim_loss: 21950182.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9780; val_auprc_score: 0.9732; val_best_acc_score: 0.9313; val_best_f1_score: 0.9329; train_kl_reg_loss: 100277.2824; train_edge_recon_loss: 2696481.8473; train_gene_expr_recon_loss: 16658401.8473; train_masked_gp_l1_reg_loss: 159339.1083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60732.5502; train_chrom_access_recon_loss: 2219129.9513; train_global_loss: 21894362.6412; train_optim_loss: 21894362.6412; val_kl_reg_loss: 97985.4563; val_edge_recon_loss: 2718812.4000; val_gene_expr_recon_loss: 16720714.9333; val_masked_gp_l1_reg_loss: 159325.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60695.2461; val_chrom_access_recon_loss: 2189507.4167; val_global_loss: 21947042.1333; val_optim_loss: 21947042.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9813; val_auprc_score: 0.9747; val_best_acc_score: 0.9376; val_best_f1_score: 0.9388; train_kl_reg_loss: 100326.2538; train_edge_recon_loss: 2704980.2195; train_gene_expr_recon_loss: 16671851.0916; train_masked_gp_l1_reg_loss: 159299.0604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60498.6121; train_chrom_access_recon_loss: 2221087.1088; train_global_loss: 21918042.5191; train_optim_loss: 21918042.5191; val_kl_reg_loss: 97681.9396; val_edge_recon_loss: 2700887.7000; val_gene_expr_recon_loss: 16691125.8667; val_masked_gp_l1_reg_loss: 159288.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60475.0742; val_chrom_access_recon_loss: 2183996.3417; val_global_loss: 21893455.8667; val_optim_loss: 21893455.8667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9790; val_auprc_score: 0.9732; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 100354.5236; train_edge_recon_loss: 2697703.7634; train_gene_expr_recon_loss: 16651085.3359; train_masked_gp_l1_reg_loss: 159284.1555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60469.1729; train_chrom_access_recon_loss: 2218045.7414; train_global_loss: 21886942.6107; train_optim_loss: 21886942.6107; val_kl_reg_loss: 97906.6536; val_edge_recon_loss: 2720980.1833; val_gene_expr_recon_loss: 16721843.9333; val_masked_gp_l1_reg_loss: 159280.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60464.8281; val_chrom_access_recon_loss: 2187090.5500; val_global_loss: 21947565.4667; val_optim_loss: 21947565.4667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9809; val_auprc_score: 0.9761; val_best_acc_score: 0.9371; val_best_f1_score: 0.9383; train_kl_reg_loss: 100372.8432; train_edge_recon_loss: 2708015.8359; train_gene_expr_recon_loss: 16672815.4962; train_masked_gp_l1_reg_loss: 159277.6568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60460.4209; train_chrom_access_recon_loss: 2220747.9781; train_global_loss: 21921690.2137; train_optim_loss: 21921690.2137; val_kl_reg_loss: 97736.8516; val_edge_recon_loss: 2699271.5333; val_gene_expr_recon_loss: 16684301.4667; val_masked_gp_l1_reg_loss: 159275.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60456.8164; val_chrom_access_recon_loss: 2182542.1083; val_global_loss: 21883583.7333; val_optim_loss: 21883583.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9801; val_auprc_score: 0.9759; val_best_acc_score: 0.9333; val_best_f1_score: 0.9346; train_kl_reg_loss: 100264.6658; train_edge_recon_loss: 2706584.6279; train_gene_expr_recon_loss: 16660214.3511; train_masked_gp_l1_reg_loss: 159274.2127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60452.8259; train_chrom_access_recon_loss: 2218647.9590; train_global_loss: 21905438.5802; train_optim_loss: 21905438.5802; val_kl_reg_loss: 97862.2068; val_edge_recon_loss: 2710735.4500; val_gene_expr_recon_loss: 16692441.2667; val_masked_gp_l1_reg_loss: 159272.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60449.1328; val_chrom_access_recon_loss: 2188588.9500; val_global_loss: 21909349.7333; val_optim_loss: 21909349.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 61 min 4 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9800
val AUPRC score: 0.9757
val best accuracy score: 0.9306
val best F1 score: 0.9319
val target rna MSE score: 1.2211
val source rna MSE score: 0.2791
val target atac MSE score: 0.4734
val source atac MSE score: 0.0780
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
