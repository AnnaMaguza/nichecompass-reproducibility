[True]
Run timestamp: 24072023_170832_73.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_73']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9169; val_auprc_score: 0.9291; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 7231.8016; train_edge_recon_loss: 34727004.8889; train_gene_expr_recon_loss: 31711461.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1092793.7639; train_global_loss: 67538493.3333; train_optim_loss: 67538493.3333; val_kl_reg_loss: 22259.7773; val_edge_recon_loss: 40644584.0000; val_gene_expr_recon_loss: 30043310.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1055194.7500; val_global_loss: 71765344.0000; val_optim_loss: 71765344.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8866; val_auprc_score: 0.8965; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 63875.8051; train_edge_recon_loss: 34776304.0000; train_gene_expr_recon_loss: 29508163.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1080049.2917; train_global_loss: 65428392.0000; train_optim_loss: 65428392.0000; val_kl_reg_loss: 112723.5000; val_edge_recon_loss: 40651944.0000; val_gene_expr_recon_loss: 27636298.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038189.3750; val_global_loss: 69439160.0000; val_optim_loss: 69439160.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8856; val_auprc_score: 0.8967; val_best_acc_score: 0.5078; val_best_f1_score: 0.6701; train_kl_reg_loss: 237960.8203; train_edge_recon_loss: 34786363.1111; train_gene_expr_recon_loss: 27466826.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1067862.1667; train_global_loss: 63559014.2222; train_optim_loss: 63559014.2222; val_kl_reg_loss: 71790.1875; val_edge_recon_loss: 40652080.0000; val_gene_expr_recon_loss: 26048570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023146.4375; val_global_loss: 67795584.0000; val_optim_loss: 67795584.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8923; val_auprc_score: 0.9017; val_best_acc_score: 0.5034; val_best_f1_score: 0.6682; train_kl_reg_loss: 154379.4748; train_edge_recon_loss: 34863905.3333; train_gene_expr_recon_loss: 25808962.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038694.0694; train_global_loss: 61865941.7778; train_optim_loss: 61865941.7778; val_kl_reg_loss: 220731.5312; val_edge_recon_loss: 40653936.0000; val_gene_expr_recon_loss: 24574342.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007493.5000; val_global_loss: 66456500.0000; val_optim_loss: 66456500.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8851; val_auprc_score: 0.8918; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 238307.5694; train_edge_recon_loss: 34808353.3333; train_gene_expr_recon_loss: 24401146.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024422.2917; train_global_loss: 60472229.7778; train_optim_loss: 60472229.7778; val_kl_reg_loss: 230889.1719; val_edge_recon_loss: 40652104.0000; val_gene_expr_recon_loss: 23479442.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 996822.9375; val_global_loss: 65359256.0000; val_optim_loss: 65359256.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8921; val_auprc_score: 0.8951; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 309145.6597; train_edge_recon_loss: 34808720.0000; train_gene_expr_recon_loss: 23475806.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010588.7014; train_global_loss: 59604260.4444; train_optim_loss: 59604260.4444; val_kl_reg_loss: 279559.2188; val_edge_recon_loss: 40649512.0000; val_gene_expr_recon_loss: 22559366.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986483.4375; val_global_loss: 64474924.0000; val_optim_loss: 64474924.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8893; val_auprc_score: 0.8934; val_best_acc_score: 0.5178; val_best_f1_score: 0.6743; train_kl_reg_loss: 338196.6875; train_edge_recon_loss: 34820449.3333; train_gene_expr_recon_loss: 22629597.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007485.1944; train_global_loss: 58795728.0000; train_optim_loss: 58795728.0000; val_kl_reg_loss: 292361.3438; val_edge_recon_loss: 40642464.0000; val_gene_expr_recon_loss: 21975482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979960.5000; val_global_loss: 63890264.0000; val_optim_loss: 63890264.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8892; val_auprc_score: 0.8851; val_best_acc_score: 0.5220; val_best_f1_score: 0.6762; train_kl_reg_loss: 341706.1111; train_edge_recon_loss: 34828123.5556; train_gene_expr_recon_loss: 22006855.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994656.9444; train_global_loss: 58171340.8889; train_optim_loss: 58171340.8889; val_kl_reg_loss: 340724.5938; val_edge_recon_loss: 40637576.0000; val_gene_expr_recon_loss: 21633356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975610.5000; val_global_loss: 63587268.0000; val_optim_loss: 63587268.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8939; val_auprc_score: 0.8946; val_best_acc_score: 0.5311; val_best_f1_score: 0.6803; train_kl_reg_loss: 354628.8125; train_edge_recon_loss: 34822732.4444; train_gene_expr_recon_loss: 21811671.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991093.1875; train_global_loss: 57980124.8889; train_optim_loss: 57980124.8889; val_kl_reg_loss: 277675.6250; val_edge_recon_loss: 40633436.0000; val_gene_expr_recon_loss: 21408266.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972880.7500; val_global_loss: 63292256.0000; val_optim_loss: 63292256.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8955; val_auprc_score: 0.8911; val_best_acc_score: 0.5488; val_best_f1_score: 0.6886; train_kl_reg_loss: 342240.3264; train_edge_recon_loss: 34840244.4444; train_gene_expr_recon_loss: 21568141.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990471.7083; train_global_loss: 57741098.2222; train_optim_loss: 57741098.2222; val_kl_reg_loss: 238724.8750; val_edge_recon_loss: 40624044.0000; val_gene_expr_recon_loss: 21195432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969152.8125; val_global_loss: 63027352.0000; val_optim_loss: 63027352.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8999; val_auprc_score: 0.8953; val_best_acc_score: 0.5884; val_best_f1_score: 0.7071; train_kl_reg_loss: 333023.5017; train_edge_recon_loss: 34839809.3333; train_gene_expr_recon_loss: 21371507.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988206.6944; train_global_loss: 57532546.2222; train_optim_loss: 57532546.2222; val_kl_reg_loss: 307886.5625; val_edge_recon_loss: 40605288.0000; val_gene_expr_recon_loss: 21049412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967869.5625; val_global_loss: 62930456.0000; val_optim_loss: 62930456.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9007; val_auprc_score: 0.8939; val_best_acc_score: 0.6381; val_best_f1_score: 0.7323; train_kl_reg_loss: 336740.7951; train_edge_recon_loss: 34807356.4444; train_gene_expr_recon_loss: 21349503.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985142.5208; train_global_loss: 57478744.0000; train_optim_loss: 57478744.0000; val_kl_reg_loss: 246273.7656; val_edge_recon_loss: 40576072.0000; val_gene_expr_recon_loss: 20969594.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965692.0000; val_global_loss: 62757628.0000; val_optim_loss: 62757628.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8991; val_auprc_score: 0.8943; val_best_acc_score: 0.6942; val_best_f1_score: 0.7616; train_kl_reg_loss: 305214.0347; train_edge_recon_loss: 34829141.7778; train_gene_expr_recon_loss: 21265927.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982021.1806; train_global_loss: 57382304.0000; train_optim_loss: 57382304.0000; val_kl_reg_loss: 294691.0312; val_edge_recon_loss: 40529580.0000; val_gene_expr_recon_loss: 20892870.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963546.3125; val_global_loss: 62680692.0000; val_optim_loss: 62680692.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9025; val_auprc_score: 0.8955; val_best_acc_score: 0.7452; val_best_f1_score: 0.7907; train_kl_reg_loss: 311426.8438; train_edge_recon_loss: 34805814.6667; train_gene_expr_recon_loss: 21152915.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981778.3125; train_global_loss: 57251935.5556; train_optim_loss: 57251935.5556; val_kl_reg_loss: 228292.3125; val_edge_recon_loss: 40469016.0000; val_gene_expr_recon_loss: 20829420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962833.8125; val_global_loss: 62489560.0000; val_optim_loss: 62489560.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9048; val_auprc_score: 0.8959; val_best_acc_score: 0.7918; val_best_f1_score: 0.8187; train_kl_reg_loss: 288203.0243; train_edge_recon_loss: 34809749.3333; train_gene_expr_recon_loss: 21006132.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981333.9097; train_global_loss: 57085418.2222; train_optim_loss: 57085418.2222; val_kl_reg_loss: 237777.4688; val_edge_recon_loss: 40355360.0000; val_gene_expr_recon_loss: 20773560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961174.7500; val_global_loss: 62327872.0000; val_optim_loss: 62327872.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9112; val_auprc_score: 0.9007; val_best_acc_score: 0.8327; val_best_f1_score: 0.8432; train_kl_reg_loss: 282782.5885; train_edge_recon_loss: 34785005.7778; train_gene_expr_recon_loss: 20985016.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975902.6667; train_global_loss: 57028707.1111; train_optim_loss: 57028707.1111; val_kl_reg_loss: 228377.5000; val_edge_recon_loss: 40152972.0000; val_gene_expr_recon_loss: 20714158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959766.8750; val_global_loss: 62055272.0000; val_optim_loss: 62055272.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9088; val_auprc_score: 0.8978; val_best_acc_score: 0.8337; val_best_f1_score: 0.8361; train_kl_reg_loss: 269228.2969; train_edge_recon_loss: 34750390.6667; train_gene_expr_recon_loss: 20922361.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974048.2917; train_global_loss: 56916029.3333; train_optim_loss: 56916029.3333; val_kl_reg_loss: 235047.1719; val_edge_recon_loss: 39934748.0000; val_gene_expr_recon_loss: 20687840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959584.8750; val_global_loss: 61817220.0000; val_optim_loss: 61817220.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9138; val_auprc_score: 0.8997; val_best_acc_score: 0.8236; val_best_f1_score: 0.8131; train_kl_reg_loss: 260208.1632; train_edge_recon_loss: 34698131.5556; train_gene_expr_recon_loss: 20849102.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976108.8125; train_global_loss: 56783551.5556; train_optim_loss: 56783551.5556; val_kl_reg_loss: 208517.4688; val_edge_recon_loss: 39419968.0000; val_gene_expr_recon_loss: 20656052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958246.8750; val_global_loss: 61242784.0000; val_optim_loss: 61242784.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9228; val_auprc_score: 0.9111; val_best_acc_score: 0.8358; val_best_f1_score: 0.8520; train_kl_reg_loss: 240722.0035; train_edge_recon_loss: 34592612.0000; train_gene_expr_recon_loss: 20803312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972693.8958; train_global_loss: 56609340.4444; train_optim_loss: 56609340.4444; val_kl_reg_loss: 182172.8125; val_edge_recon_loss: 38225788.0000; val_gene_expr_recon_loss: 20678182.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959354.0000; val_global_loss: 60045496.0000; val_optim_loss: 60045496.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9175; val_auprc_score: 0.8988; val_best_acc_score: 0.8407; val_best_f1_score: 0.8533; train_kl_reg_loss: 191163.3802; train_edge_recon_loss: 34233729.7778; train_gene_expr_recon_loss: 20985565.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972692.3542; train_global_loss: 56383152.0000; train_optim_loss: 56383152.0000; val_kl_reg_loss: 132983.6562; val_edge_recon_loss: 35377488.0000; val_gene_expr_recon_loss: 20807958.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959687.6250; val_global_loss: 57278120.0000; val_optim_loss: 57278120.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8911; val_auprc_score: 0.8737; val_best_acc_score: 0.8083; val_best_f1_score: 0.8159; train_kl_reg_loss: 79200.2322; train_edge_recon_loss: 32346817.5556; train_gene_expr_recon_loss: 21474235.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983162.5000; train_global_loss: 54883417.3333; train_optim_loss: 54883417.3333; val_kl_reg_loss: 51583.5234; val_edge_recon_loss: 30258178.0000; val_gene_expr_recon_loss: 21869798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978761.7500; val_global_loss: 53158320.0000; val_optim_loss: 53158320.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8872; val_auprc_score: 0.8657; val_best_acc_score: 0.7914; val_best_f1_score: 0.8091; train_kl_reg_loss: 87143.0872; train_edge_recon_loss: 29805132.2222; train_gene_expr_recon_loss: 21819992.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988320.0347; train_global_loss: 52700588.8889; train_optim_loss: 52700588.8889; val_kl_reg_loss: 127965.7734; val_edge_recon_loss: 28857752.0000; val_gene_expr_recon_loss: 21299294.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968732.0000; val_global_loss: 51253744.0000; val_optim_loss: 51253744.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8860; val_auprc_score: 0.8688; val_best_acc_score: 0.7937; val_best_f1_score: 0.8075; train_kl_reg_loss: 174818.9601; train_edge_recon_loss: 29104669.3333; train_gene_expr_recon_loss: 21393863.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986583.2222; train_global_loss: 51659934.2222; train_optim_loss: 51659934.2222; val_kl_reg_loss: 211932.6875; val_edge_recon_loss: 28753120.0000; val_gene_expr_recon_loss: 20953780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964936.4375; val_global_loss: 50883768.0000; val_optim_loss: 50883768.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8878; val_auprc_score: 0.8732; val_best_acc_score: 0.7994; val_best_f1_score: 0.8031; train_kl_reg_loss: 253290.0382; train_edge_recon_loss: 28647171.3333; train_gene_expr_recon_loss: 21147040.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994905.2778; train_global_loss: 51042407.1111; train_optim_loss: 51042407.1111; val_kl_reg_loss: 270806.3125; val_edge_recon_loss: 29014116.0000; val_gene_expr_recon_loss: 20767662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960961.8125; val_global_loss: 51013544.0000; val_optim_loss: 51013544.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8828; val_auprc_score: 0.8659; val_best_acc_score: 0.7913; val_best_f1_score: 0.8043; train_kl_reg_loss: 292780.8576; train_edge_recon_loss: 28620822.2222; train_gene_expr_recon_loss: 20903829.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994163.2708; train_global_loss: 50811596.0000; train_optim_loss: 50811596.0000; val_kl_reg_loss: 282331.7500; val_edge_recon_loss: 28863588.0000; val_gene_expr_recon_loss: 20714028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959542.3750; val_global_loss: 50819492.0000; val_optim_loss: 50819492.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8922; val_auprc_score: 0.8759; val_best_acc_score: 0.7963; val_best_f1_score: 0.8141; train_kl_reg_loss: 290492.7604; train_edge_recon_loss: 28689666.2222; train_gene_expr_recon_loss: 20913041.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974365.2431; train_global_loss: 50867565.3333; train_optim_loss: 50867565.3333; val_kl_reg_loss: 278751.1875; val_edge_recon_loss: 28330300.0000; val_gene_expr_recon_loss: 20639520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956569.9375; val_global_loss: 50205140.0000; val_optim_loss: 50205140.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8900; val_auprc_score: 0.8732; val_best_acc_score: 0.8036; val_best_f1_score: 0.8182; train_kl_reg_loss: 295967.4271; train_edge_recon_loss: 28612270.6667; train_gene_expr_recon_loss: 21008058.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979858.7222; train_global_loss: 50896155.5556; train_optim_loss: 50896155.5556; val_kl_reg_loss: 286184.3125; val_edge_recon_loss: 28650230.0000; val_gene_expr_recon_loss: 20589874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955886.5625; val_global_loss: 50482176.0000; val_optim_loss: 50482176.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9056; val_auprc_score: 0.8853; val_best_acc_score: 0.8304; val_best_f1_score: 0.8363; train_kl_reg_loss: 302057.9583; train_edge_recon_loss: 28441881.1111; train_gene_expr_recon_loss: 20799438.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975054.4306; train_global_loss: 50518431.1111; train_optim_loss: 50518431.1111; val_kl_reg_loss: 288175.5000; val_edge_recon_loss: 28005970.0000; val_gene_expr_recon_loss: 20608108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955555.8125; val_global_loss: 49857812.0000; val_optim_loss: 49857812.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9098; val_auprc_score: 0.8907; val_best_acc_score: 0.8355; val_best_f1_score: 0.8463; train_kl_reg_loss: 300149.7708; train_edge_recon_loss: 28197442.0000; train_gene_expr_recon_loss: 20790897.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977951.4792; train_global_loss: 50266441.3333; train_optim_loss: 50266441.3333; val_kl_reg_loss: 282854.6875; val_edge_recon_loss: 27908662.0000; val_gene_expr_recon_loss: 20568640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956543.6875; val_global_loss: 49716700.0000; val_optim_loss: 49716700.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9196; val_auprc_score: 0.8965; val_best_acc_score: 0.8529; val_best_f1_score: 0.8608; train_kl_reg_loss: 290828.0139; train_edge_recon_loss: 27959613.7778; train_gene_expr_recon_loss: 20646318.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967479.3125; train_global_loss: 49864240.0000; train_optim_loss: 49864240.0000; val_kl_reg_loss: 271561.7500; val_edge_recon_loss: 27805120.0000; val_gene_expr_recon_loss: 20553538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954725.3125; val_global_loss: 49584944.0000; val_optim_loss: 49584944.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9178; val_auprc_score: 0.8941; val_best_acc_score: 0.8542; val_best_f1_score: 0.8634; train_kl_reg_loss: 287450.0486; train_edge_recon_loss: 27768517.1111; train_gene_expr_recon_loss: 20740324.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968174.5069; train_global_loss: 49764467.5556; train_optim_loss: 49764467.5556; val_kl_reg_loss: 270062.4375; val_edge_recon_loss: 28121028.0000; val_gene_expr_recon_loss: 20552414.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953086.8125; val_global_loss: 49896592.0000; val_optim_loss: 49896592.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9264; val_auprc_score: 0.9072; val_best_acc_score: 0.8630; val_best_f1_score: 0.8720; train_kl_reg_loss: 298641.3403; train_edge_recon_loss: 27584424.0000; train_gene_expr_recon_loss: 20787137.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974596.5278; train_global_loss: 49644800.4444; train_optim_loss: 49644800.4444; val_kl_reg_loss: 286619.0312; val_edge_recon_loss: 27653540.0000; val_gene_expr_recon_loss: 20528882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953637.5000; val_global_loss: 49422676.0000; val_optim_loss: 49422676.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9318; val_auprc_score: 0.9133; val_best_acc_score: 0.8681; val_best_f1_score: 0.8758; train_kl_reg_loss: 315658.0972; train_edge_recon_loss: 27442666.8889; train_gene_expr_recon_loss: 20604018.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966034.1667; train_global_loss: 49328377.7778; train_optim_loss: 49328377.7778; val_kl_reg_loss: 304505.1875; val_edge_recon_loss: 27656742.0000; val_gene_expr_recon_loss: 20647256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 951420.5000; val_global_loss: 49559924.0000; val_optim_loss: 49559924.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9354; val_auprc_score: 0.9123; val_best_acc_score: 0.8795; val_best_f1_score: 0.8858; train_kl_reg_loss: 314891.1910; train_edge_recon_loss: 27383882.6667; train_gene_expr_recon_loss: 20847551.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973516.6458; train_global_loss: 49519842.6667; train_optim_loss: 49519842.6667; val_kl_reg_loss: 272075.1875; val_edge_recon_loss: 27685394.0000; val_gene_expr_recon_loss: 20574044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 952263.1250; val_global_loss: 49483776.0000; val_optim_loss: 49483776.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9378; val_auprc_score: 0.9157; val_best_acc_score: 0.8822; val_best_f1_score: 0.8894; train_kl_reg_loss: 279646.9062; train_edge_recon_loss: 27771636.8889; train_gene_expr_recon_loss: 20955471.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968736.1944; train_global_loss: 49975491.5556; train_optim_loss: 49975491.5556; val_kl_reg_loss: 272409.4375; val_edge_recon_loss: 27766046.0000; val_gene_expr_recon_loss: 20724286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953459.5625; val_global_loss: 49716204.0000; val_optim_loss: 49716204.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9369; val_auprc_score: 0.9150; val_best_acc_score: 0.8808; val_best_f1_score: 0.8878; train_kl_reg_loss: 300354.3299; train_edge_recon_loss: 27515902.6667; train_gene_expr_recon_loss: 20854112.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967670.1667; train_global_loss: 49638038.6667; train_optim_loss: 49638038.6667; val_kl_reg_loss: 294578.8125; val_edge_recon_loss: 27533320.0000; val_gene_expr_recon_loss: 20601878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 950685.5000; val_global_loss: 49380460.0000; val_optim_loss: 49380460.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9359; val_auprc_score: 0.9144; val_best_acc_score: 0.8810; val_best_f1_score: 0.8878; train_kl_reg_loss: 313045.0174; train_edge_recon_loss: 27308167.5556; train_gene_expr_recon_loss: 20829805.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967079.0694; train_global_loss: 49418098.2222; train_optim_loss: 49418098.2222; val_kl_reg_loss: 296213.7812; val_edge_recon_loss: 27549342.0000; val_gene_expr_recon_loss: 20545384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949396.0000; val_global_loss: 49340336.0000; val_optim_loss: 49340336.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9435; val_auprc_score: 0.9248; val_best_acc_score: 0.8853; val_best_f1_score: 0.8929; train_kl_reg_loss: 313026.7188; train_edge_recon_loss: 27278779.7778; train_gene_expr_recon_loss: 20660301.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966500.6181; train_global_loss: 49218608.4444; train_optim_loss: 49218608.4444; val_kl_reg_loss: 295660.1875; val_edge_recon_loss: 27299348.0000; val_gene_expr_recon_loss: 20430946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 947148.6250; val_global_loss: 48973100.0000; val_optim_loss: 48973100.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9463; val_auprc_score: 0.9265; val_best_acc_score: 0.8857; val_best_f1_score: 0.8935; train_kl_reg_loss: 316490.9306; train_edge_recon_loss: 27236262.4444; train_gene_expr_recon_loss: 20644604.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970111.6736; train_global_loss: 49167469.3333; train_optim_loss: 49167469.3333; val_kl_reg_loss: 299294.2500; val_edge_recon_loss: 27113888.0000; val_gene_expr_recon_loss: 20408982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 947024.1875; val_global_loss: 48769188.0000; val_optim_loss: 48769188.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9453; val_auprc_score: 0.9255; val_best_acc_score: 0.8879; val_best_f1_score: 0.8945; train_kl_reg_loss: 318929.0139; train_edge_recon_loss: 27177674.4444; train_gene_expr_recon_loss: 20531256.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963002.8611; train_global_loss: 48990862.6667; train_optim_loss: 48990862.6667; val_kl_reg_loss: 298448.6875; val_edge_recon_loss: 27313692.0000; val_gene_expr_recon_loss: 20347798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 946105.5000; val_global_loss: 48906040.0000; val_optim_loss: 48906040.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9509; val_auprc_score: 0.9330; val_best_acc_score: 0.8946; val_best_f1_score: 0.8997; train_kl_reg_loss: 313871.2708; train_edge_recon_loss: 27073868.8889; train_gene_expr_recon_loss: 20474627.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964887.1458; train_global_loss: 48827254.6667; train_optim_loss: 48827254.6667; val_kl_reg_loss: 298488.1250; val_edge_recon_loss: 27229404.0000; val_gene_expr_recon_loss: 20315288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 945766.6250; val_global_loss: 48788948.0000; val_optim_loss: 48788948.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9567; val_auprc_score: 0.9422; val_best_acc_score: 0.8964; val_best_f1_score: 0.9021; train_kl_reg_loss: 313539.9653; train_edge_recon_loss: 27052740.2222; train_gene_expr_recon_loss: 20462381.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959583.3403; train_global_loss: 48788244.8889; train_optim_loss: 48788244.8889; val_kl_reg_loss: 300569.8125; val_edge_recon_loss: 27189202.0000; val_gene_expr_recon_loss: 20287666.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 944697.8125; val_global_loss: 48722136.0000; val_optim_loss: 48722136.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9566; val_auprc_score: 0.9395; val_best_acc_score: 0.9022; val_best_f1_score: 0.9073; train_kl_reg_loss: 312088.5868; train_edge_recon_loss: 27012357.1111; train_gene_expr_recon_loss: 20282625.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956357.3403; train_global_loss: 48563428.0000; train_optim_loss: 48563428.0000; val_kl_reg_loss: 296986.6250; val_edge_recon_loss: 26714206.0000; val_gene_expr_recon_loss: 20254324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 943559.3750; val_global_loss: 48209076.0000; val_optim_loss: 48209076.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9506; val_auprc_score: 0.9324; val_best_acc_score: 0.8967; val_best_f1_score: 0.9027; train_kl_reg_loss: 310024.1771; train_edge_recon_loss: 26884746.2222; train_gene_expr_recon_loss: 20321421.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957304.1389; train_global_loss: 48473496.4444; train_optim_loss: 48473496.4444; val_kl_reg_loss: 301526.3125; val_edge_recon_loss: 27038988.0000; val_gene_expr_recon_loss: 20261186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 944997.1250; val_global_loss: 48546696.0000; val_optim_loss: 48546696.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9573; val_auprc_score: 0.9413; val_best_acc_score: 0.9042; val_best_f1_score: 0.9092; train_kl_reg_loss: 314171.0312; train_edge_recon_loss: 26810345.1111; train_gene_expr_recon_loss: 20383200.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959291.0417; train_global_loss: 48467008.0000; train_optim_loss: 48467008.0000; val_kl_reg_loss: 299290.8750; val_edge_recon_loss: 26915574.0000; val_gene_expr_recon_loss: 20242056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 942744.0000; val_global_loss: 48399664.0000; val_optim_loss: 48399664.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9589; val_auprc_score: 0.9466; val_best_acc_score: 0.9029; val_best_f1_score: 0.9080; train_kl_reg_loss: 313544.1562; train_edge_recon_loss: 26892851.5556; train_gene_expr_recon_loss: 20430597.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963569.0903; train_global_loss: 48600562.2222; train_optim_loss: 48600562.2222; val_kl_reg_loss: 299853.8750; val_edge_recon_loss: 26922136.0000; val_gene_expr_recon_loss: 20219524.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 942636.1875; val_global_loss: 48384148.0000; val_optim_loss: 48384148.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9570; val_auprc_score: 0.9433; val_best_acc_score: 0.9020; val_best_f1_score: 0.9077; train_kl_reg_loss: 313561.8785; train_edge_recon_loss: 26977453.5556; train_gene_expr_recon_loss: 20429201.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961891.0972; train_global_loss: 48682107.1111; train_optim_loss: 48682107.1111; val_kl_reg_loss: 298188.4375; val_edge_recon_loss: 26872384.0000; val_gene_expr_recon_loss: 20218212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 942839.8125; val_global_loss: 48331624.0000; val_optim_loss: 48331624.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9568; val_auprc_score: 0.9388; val_best_acc_score: 0.9029; val_best_f1_score: 0.9082; train_kl_reg_loss: 310112.8368; train_edge_recon_loss: 26853643.1111; train_gene_expr_recon_loss: 20317026.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 952098.5694; train_global_loss: 48432880.4444; train_optim_loss: 48432880.4444; val_kl_reg_loss: 301447.0312; val_edge_recon_loss: 26893830.0000; val_gene_expr_recon_loss: 20190942.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 943497.0625; val_global_loss: 48329716.0000; val_optim_loss: 48329716.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9591; val_auprc_score: 0.9445; val_best_acc_score: 0.9065; val_best_f1_score: 0.9109; train_kl_reg_loss: 311204.1979; train_edge_recon_loss: 26849534.2222; train_gene_expr_recon_loss: 20292587.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959380.4722; train_global_loss: 48412705.7778; train_optim_loss: 48412705.7778; val_kl_reg_loss: 300704.9375; val_edge_recon_loss: 26808542.0000; val_gene_expr_recon_loss: 20163910.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941769.9375; val_global_loss: 48214924.0000; val_optim_loss: 48214924.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9568; val_auprc_score: 0.9383; val_best_acc_score: 0.9037; val_best_f1_score: 0.9084; train_kl_reg_loss: 310344.5868; train_edge_recon_loss: 26811362.2222; train_gene_expr_recon_loss: 20196424.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956350.2361; train_global_loss: 48274481.3333; train_optim_loss: 48274481.3333; val_kl_reg_loss: 300054.3750; val_edge_recon_loss: 27091718.0000; val_gene_expr_recon_loss: 20153212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941732.8750; val_global_loss: 48486716.0000; val_optim_loss: 48486716.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9604; val_auprc_score: 0.9432; val_best_acc_score: 0.9082; val_best_f1_score: 0.9118; train_kl_reg_loss: 311125.4375; train_edge_recon_loss: 26744871.1111; train_gene_expr_recon_loss: 20255831.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960860.2292; train_global_loss: 48272689.3333; train_optim_loss: 48272689.3333; val_kl_reg_loss: 300708.9062; val_edge_recon_loss: 26743630.0000; val_gene_expr_recon_loss: 20162430.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941924.3125; val_global_loss: 48148692.0000; val_optim_loss: 48148692.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9552; val_auprc_score: 0.9363; val_best_acc_score: 0.9002; val_best_f1_score: 0.9054; train_kl_reg_loss: 311586.8854; train_edge_recon_loss: 26808354.0000; train_gene_expr_recon_loss: 20235516.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955524.6944; train_global_loss: 48310981.3333; train_optim_loss: 48310981.3333; val_kl_reg_loss: 301645.3438; val_edge_recon_loss: 27000660.0000; val_gene_expr_recon_loss: 20171446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941651.0625; val_global_loss: 48415404.0000; val_optim_loss: 48415404.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9574; val_auprc_score: 0.9380; val_best_acc_score: 0.9061; val_best_f1_score: 0.9114; train_kl_reg_loss: 313539.8993; train_edge_recon_loss: 26862434.0000; train_gene_expr_recon_loss: 20315771.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958197.0208; train_global_loss: 48449941.3333; train_optim_loss: 48449941.3333; val_kl_reg_loss: 303695.7500; val_edge_recon_loss: 26843554.0000; val_gene_expr_recon_loss: 20143092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941015.2500; val_global_loss: 48231360.0000; val_optim_loss: 48231360.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9561; val_auprc_score: 0.9405; val_best_acc_score: 0.9004; val_best_f1_score: 0.9061; train_kl_reg_loss: 314224.7083; train_edge_recon_loss: 26747948.6667; train_gene_expr_recon_loss: 20220556.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957330.6389; train_global_loss: 48240060.8889; train_optim_loss: 48240060.8889; val_kl_reg_loss: 303466.8750; val_edge_recon_loss: 26976132.0000; val_gene_expr_recon_loss: 20163824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941365.8125; val_global_loss: 48384788.0000; val_optim_loss: 48384788.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9564; val_auprc_score: 0.9389; val_best_acc_score: 0.9035; val_best_f1_score: 0.9075; train_kl_reg_loss: 315015.3264; train_edge_recon_loss: 26727366.2222; train_gene_expr_recon_loss: 20360785.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962024.8403; train_global_loss: 48365191.5556; train_optim_loss: 48365191.5556; val_kl_reg_loss: 301682.9375; val_edge_recon_loss: 26844058.0000; val_gene_expr_recon_loss: 20125984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 939516.6250; val_global_loss: 48211240.0000; val_optim_loss: 48211240.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9552; val_auprc_score: 0.9368; val_best_acc_score: 0.9023; val_best_f1_score: 0.9076; train_kl_reg_loss: 314918.2431; train_edge_recon_loss: 26787997.7778; train_gene_expr_recon_loss: 20317523.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955790.5903; train_global_loss: 48376230.2222; train_optim_loss: 48376230.2222; val_kl_reg_loss: 302739.3125; val_edge_recon_loss: 26989498.0000; val_gene_expr_recon_loss: 20158894.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941818.9375; val_global_loss: 48392952.0000; val_optim_loss: 48392952.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9583; val_auprc_score: 0.9429; val_best_acc_score: 0.9050; val_best_f1_score: 0.9098; train_kl_reg_loss: 313876.2917; train_edge_recon_loss: 26771871.7778; train_gene_expr_recon_loss: 20235964.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955184.5625; train_global_loss: 48276896.0000; train_optim_loss: 48276896.0000; val_kl_reg_loss: 302855.9062; val_edge_recon_loss: 26932768.0000; val_gene_expr_recon_loss: 20149088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941957.3750; val_global_loss: 48326668.0000; val_optim_loss: 48326668.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9590; val_auprc_score: 0.9423; val_best_acc_score: 0.9057; val_best_f1_score: 0.9109; train_kl_reg_loss: 314675.0556; train_edge_recon_loss: 26749238.6667; train_gene_expr_recon_loss: 20249994.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 951054.5278; train_global_loss: 48264963.1111; train_optim_loss: 48264963.1111; val_kl_reg_loss: 303397.1875; val_edge_recon_loss: 26736932.0000; val_gene_expr_recon_loss: 20150084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941659.3750; val_global_loss: 48132076.0000; val_optim_loss: 48132076.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9563; val_auprc_score: 0.9376; val_best_acc_score: 0.9049; val_best_f1_score: 0.9103; train_kl_reg_loss: 315501.2917; train_edge_recon_loss: 26802566.8889; train_gene_expr_recon_loss: 20308617.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953255.7778; train_global_loss: 48379942.2222; train_optim_loss: 48379942.2222; val_kl_reg_loss: 304322.8125; val_edge_recon_loss: 27046936.0000; val_gene_expr_recon_loss: 20161074.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941531.5000; val_global_loss: 48453864.0000; val_optim_loss: 48453864.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9568; val_auprc_score: 0.9409; val_best_acc_score: 0.9018; val_best_f1_score: 0.9063; train_kl_reg_loss: 314085.7292; train_edge_recon_loss: 26831006.2222; train_gene_expr_recon_loss: 20264904.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957338.5417; train_global_loss: 48367336.0000; train_optim_loss: 48367336.0000; val_kl_reg_loss: 301444.9062; val_edge_recon_loss: 27102134.0000; val_gene_expr_recon_loss: 20148270.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 940879.2500; val_global_loss: 48492728.0000; val_optim_loss: 48492728.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9581; val_auprc_score: 0.9392; val_best_acc_score: 0.9056; val_best_f1_score: 0.9104; train_kl_reg_loss: 314319.6806; train_edge_recon_loss: 26763191.5556; train_gene_expr_recon_loss: 20370526.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963505.4028; train_global_loss: 48411543.1111; train_optim_loss: 48411543.1111; val_kl_reg_loss: 302960.1875; val_edge_recon_loss: 26746768.0000; val_gene_expr_recon_loss: 20165238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941507.3125; val_global_loss: 48156476.0000; val_optim_loss: 48156476.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9549; val_auprc_score: 0.9346; val_best_acc_score: 0.9014; val_best_f1_score: 0.9063; train_kl_reg_loss: 315123.5347; train_edge_recon_loss: 26811983.1111; train_gene_expr_recon_loss: 20289899.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956401.6111; train_global_loss: 48373408.0000; train_optim_loss: 48373408.0000; val_kl_reg_loss: 301461.3750; val_edge_recon_loss: 27022720.0000; val_gene_expr_recon_loss: 20147318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941140.1875; val_global_loss: 48412640.0000; val_optim_loss: 48412640.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9614; val_auprc_score: 0.9498; val_best_acc_score: 0.9047; val_best_f1_score: 0.9102; train_kl_reg_loss: 314562.4444; train_edge_recon_loss: 26800943.3333; train_gene_expr_recon_loss: 20291807.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956522.3264; train_global_loss: 48363836.0000; train_optim_loss: 48363836.0000; val_kl_reg_loss: 303118.1250; val_edge_recon_loss: 26765212.0000; val_gene_expr_recon_loss: 20153262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941719.0000; val_global_loss: 48163312.0000; val_optim_loss: 48163312.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9573; val_auprc_score: 0.9406; val_best_acc_score: 0.9051; val_best_f1_score: 0.9099; train_kl_reg_loss: 313455.9896; train_edge_recon_loss: 26767118.4444; train_gene_expr_recon_loss: 20322735.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957358.5139; train_global_loss: 48360667.1111; train_optim_loss: 48360667.1111; val_kl_reg_loss: 302593.5625; val_edge_recon_loss: 26860244.0000; val_gene_expr_recon_loss: 20169692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 942089.0000; val_global_loss: 48274616.0000; val_optim_loss: 48274616.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9598; val_auprc_score: 0.9460; val_best_acc_score: 0.9054; val_best_f1_score: 0.9115; train_kl_reg_loss: 311985.5069; train_edge_recon_loss: 26799448.4444; train_gene_expr_recon_loss: 20302566.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957919.9444; train_global_loss: 48371919.5556; train_optim_loss: 48371919.5556; val_kl_reg_loss: 301978.9375; val_edge_recon_loss: 26819980.0000; val_gene_expr_recon_loss: 20150474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 941269.1250; val_global_loss: 48213700.0000; val_optim_loss: 48213700.0000
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9529; val_auprc_score: 0.9333; val_best_acc_score: 0.9008; val_best_f1_score: 0.9059; train_kl_reg_loss: 313007.1875; train_edge_recon_loss: 26782884.0000; train_gene_expr_recon_loss: 20246903.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955807.2986; train_global_loss: 48298602.6667; train_optim_loss: 48298602.6667; val_kl_reg_loss: 301903.2188; val_edge_recon_loss: 27007278.0000; val_gene_expr_recon_loss: 20136756.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 939905.2500; val_global_loss: 48385840.0000; val_optim_loss: 48385840.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 10 sec.
Using best model state, which was in epoch 58.

--- MODEL EVALUATION ---
Val AUROC score: 0.9596
Val AUPRC score: 0.9450
Val best accuracy score: 0.9053
Val best F1 score: 0.9092
Val gene expr MSE score: 0.3719
Val chrom access MSE score: 0.0836
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
