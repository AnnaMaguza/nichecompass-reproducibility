[True]
Run timestamp: 09102023_232429_73.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_73']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7664; val_auprc_score: 0.7869; val_best_acc_score: 0.6531; val_best_f1_score: 0.7169; train_kl_reg_loss: 67861.6028; train_edge_recon_loss: 3500594.4485; train_gene_expr_recon_loss: 13379218.4427; train_masked_gp_l1_reg_loss: 45809.9658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3343887.4602; train_chrom_access_recon_loss: 2879539.6260; train_global_loss: 23216911.4656; train_optim_loss: 23216911.4656; val_kl_reg_loss: 88197.4646; val_edge_recon_loss: 4053932.8000; val_gene_expr_recon_loss: 12519727.8667; val_masked_gp_l1_reg_loss: 54133.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 469417.1250; val_chrom_access_recon_loss: 2786154.8500; val_global_loss: 19971564.1333; val_optim_loss: 19971564.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8174; val_auprc_score: 0.8313; val_best_acc_score: 0.7317; val_best_f1_score: 0.7382; train_kl_reg_loss: 73044.4212; train_edge_recon_loss: 3450370.0573; train_gene_expr_recon_loss: 12580452.3740; train_masked_gp_l1_reg_loss: 57432.8654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 261098.5267; train_chrom_access_recon_loss: 2775482.2366; train_global_loss: 19197880.4122; train_optim_loss: 19197880.4122; val_kl_reg_loss: 55353.9451; val_edge_recon_loss: 3319942.5000; val_gene_expr_recon_loss: 12306900.0667; val_masked_gp_l1_reg_loss: 61971.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173769.4062; val_chrom_access_recon_loss: 2740476.8167; val_global_loss: 18658414.2667; val_optim_loss: 18658414.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8549; val_auprc_score: 0.8560; val_best_acc_score: 0.7654; val_best_f1_score: 0.7686; train_kl_reg_loss: 81416.2981; train_edge_recon_loss: 3068029.2958; train_gene_expr_recon_loss: 12455261.9466; train_masked_gp_l1_reg_loss: 66658.5027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141419.6071; train_chrom_access_recon_loss: 2748843.4924; train_global_loss: 18561629.0382; train_optim_loss: 18561629.0382; val_kl_reg_loss: 83842.9714; val_edge_recon_loss: 3060564.1333; val_gene_expr_recon_loss: 12202985.8667; val_masked_gp_l1_reg_loss: 69972.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118594.1797; val_chrom_access_recon_loss: 2725753.8500; val_global_loss: 18261713.7333; val_optim_loss: 18261713.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9210; val_auprc_score: 0.9089; val_best_acc_score: 0.8452; val_best_f1_score: 0.8533; train_kl_reg_loss: 88205.5889; train_edge_recon_loss: 2909786.6985; train_gene_expr_recon_loss: 12308105.1603; train_masked_gp_l1_reg_loss: 72618.3757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108818.2975; train_chrom_access_recon_loss: 2714648.6202; train_global_loss: 18202182.7023; train_optim_loss: 18202182.7023; val_kl_reg_loss: 89895.1646; val_edge_recon_loss: 2828860.6167; val_gene_expr_recon_loss: 12027001.2000; val_masked_gp_l1_reg_loss: 74958.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103693.9453; val_chrom_access_recon_loss: 2688607.2500; val_global_loss: 17813017.2000; val_optim_loss: 17813017.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9362; val_auprc_score: 0.9219; val_best_acc_score: 0.8733; val_best_f1_score: 0.8782; train_kl_reg_loss: 95223.2597; train_edge_recon_loss: 2810347.0630; train_gene_expr_recon_loss: 12180023.6260; train_masked_gp_l1_reg_loss: 76971.8310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103484.3086; train_chrom_access_recon_loss: 2689830.7958; train_global_loss: 17955880.9389; train_optim_loss: 17955880.9389; val_kl_reg_loss: 93907.6443; val_edge_recon_loss: 2767990.4333; val_gene_expr_recon_loss: 11912733.0000; val_masked_gp_l1_reg_loss: 78353.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102989.1250; val_chrom_access_recon_loss: 2659913.6833; val_global_loss: 17615887.6000; val_optim_loss: 17615887.6000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9282; val_auprc_score: 0.9135; val_best_acc_score: 0.8614; val_best_f1_score: 0.8683; train_kl_reg_loss: 94812.2408; train_edge_recon_loss: 2792423.6240; train_gene_expr_recon_loss: 12080621.0992; train_masked_gp_l1_reg_loss: 79277.9704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99649.5567; train_chrom_access_recon_loss: 2671576.9103; train_global_loss: 17818361.3740; train_optim_loss: 17818361.3740; val_kl_reg_loss: 91273.9557; val_edge_recon_loss: 2817104.5333; val_gene_expr_recon_loss: 11809062.1333; val_masked_gp_l1_reg_loss: 80160.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98039.9453; val_chrom_access_recon_loss: 2633061.4000; val_global_loss: 17528701.8667; val_optim_loss: 17528701.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9357; val_auprc_score: 0.9222; val_best_acc_score: 0.8694; val_best_f1_score: 0.8765; train_kl_reg_loss: 90396.4222; train_edge_recon_loss: 2790243.6660; train_gene_expr_recon_loss: 11982948.8855; train_masked_gp_l1_reg_loss: 80886.4350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97158.8214; train_chrom_access_recon_loss: 2649797.5954; train_global_loss: 17691431.7252; train_optim_loss: 17691431.7252; val_kl_reg_loss: 87658.9677; val_edge_recon_loss: 2785075.8667; val_gene_expr_recon_loss: 11739158.8667; val_masked_gp_l1_reg_loss: 81652.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96874.5391; val_chrom_access_recon_loss: 2635123.2333; val_global_loss: 17425545.0667; val_optim_loss: 17425545.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9394; val_auprc_score: 0.9271; val_best_acc_score: 0.8767; val_best_f1_score: 0.8830; train_kl_reg_loss: 86057.2933; train_edge_recon_loss: 2776573.8607; train_gene_expr_recon_loss: 11917012.2901; train_masked_gp_l1_reg_loss: 82456.9294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96497.1794; train_chrom_access_recon_loss: 2633546.2576; train_global_loss: 17592143.9084; train_optim_loss: 17592143.9084; val_kl_reg_loss: 84932.8687; val_edge_recon_loss: 2798277.8000; val_gene_expr_recon_loss: 11687098.3333; val_masked_gp_l1_reg_loss: 83096.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96760.2031; val_chrom_access_recon_loss: 2608534.5667; val_global_loss: 17358700.6000; val_optim_loss: 17358700.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9424; val_auprc_score: 0.9298; val_best_acc_score: 0.8805; val_best_f1_score: 0.8866; train_kl_reg_loss: 84025.6876; train_edge_recon_loss: 2774555.3607; train_gene_expr_recon_loss: 11849538.2519; train_masked_gp_l1_reg_loss: 83644.6421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95156.1142; train_chrom_access_recon_loss: 2618534.3130; train_global_loss: 17505454.3435; train_optim_loss: 17505454.3435; val_kl_reg_loss: 84154.8792; val_edge_recon_loss: 2785751.7333; val_gene_expr_recon_loss: 11607222.8000; val_masked_gp_l1_reg_loss: 84354.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94535.3125; val_chrom_access_recon_loss: 2609855.9833; val_global_loss: 17265874.6667; val_optim_loss: 17265874.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9483; val_auprc_score: 0.9367; val_best_acc_score: 0.8891; val_best_f1_score: 0.8947; train_kl_reg_loss: 83124.5974; train_edge_recon_loss: 2760477.5840; train_gene_expr_recon_loss: 11781802.3435; train_masked_gp_l1_reg_loss: 84554.2276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93405.7329; train_chrom_access_recon_loss: 2601658.1431; train_global_loss: 17405022.5725; train_optim_loss: 17405022.5725; val_kl_reg_loss: 81386.4771; val_edge_recon_loss: 2761572.7167; val_gene_expr_recon_loss: 11576846.4000; val_masked_gp_l1_reg_loss: 85279.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92981.7969; val_chrom_access_recon_loss: 2582794.7833; val_global_loss: 17180862.7333; val_optim_loss: 17180862.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9429; val_auprc_score: 0.9256; val_best_acc_score: 0.8839; val_best_f1_score: 0.8903; train_kl_reg_loss: 81752.2575; train_edge_recon_loss: 2744623.3836; train_gene_expr_recon_loss: 11736830.7710; train_masked_gp_l1_reg_loss: 85505.1578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91955.1663; train_chrom_access_recon_loss: 2591233.6355; train_global_loss: 17331900.3817; train_optim_loss: 17331900.3817; val_kl_reg_loss: 82850.3214; val_edge_recon_loss: 2766498.3833; val_gene_expr_recon_loss: 11514056.9333; val_masked_gp_l1_reg_loss: 85934.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91425.7031; val_chrom_access_recon_loss: 2568301.6667; val_global_loss: 17109067.5333; val_optim_loss: 17109067.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9506; val_auprc_score: 0.9388; val_best_acc_score: 0.8907; val_best_f1_score: 0.8950; train_kl_reg_loss: 81529.4297; train_edge_recon_loss: 2734416.0229; train_gene_expr_recon_loss: 11694102.2901; train_masked_gp_l1_reg_loss: 86081.3725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90957.2065; train_chrom_access_recon_loss: 2580754.6489; train_global_loss: 17267840.9313; train_optim_loss: 17267840.9313; val_kl_reg_loss: 79119.4469; val_edge_recon_loss: 2754411.6167; val_gene_expr_recon_loss: 11532425.7333; val_masked_gp_l1_reg_loss: 86515.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91473.3828; val_chrom_access_recon_loss: 2563725.2167; val_global_loss: 17107670.8000; val_optim_loss: 17107670.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9556; val_auprc_score: 0.9458; val_best_acc_score: 0.8942; val_best_f1_score: 0.8985; train_kl_reg_loss: 80651.2763; train_edge_recon_loss: 2722538.7004; train_gene_expr_recon_loss: 11653761.7099; train_masked_gp_l1_reg_loss: 86771.2159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90199.4601; train_chrom_access_recon_loss: 2570124.5038; train_global_loss: 17204046.8855; train_optim_loss: 17204046.8855; val_kl_reg_loss: 79104.4589; val_edge_recon_loss: 2737982.0833; val_gene_expr_recon_loss: 11470121.2000; val_masked_gp_l1_reg_loss: 87107.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90734.8281; val_chrom_access_recon_loss: 2543425.7500; val_global_loss: 17008476.6000; val_optim_loss: 17008476.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9560; val_auprc_score: 0.9411; val_best_acc_score: 0.8961; val_best_f1_score: 0.9004; train_kl_reg_loss: 79438.2366; train_edge_recon_loss: 2724359.2195; train_gene_expr_recon_loss: 11620176.3817; train_masked_gp_l1_reg_loss: 87267.2285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89854.5891; train_chrom_access_recon_loss: 2559280.2595; train_global_loss: 17160375.9237; train_optim_loss: 17160375.9237; val_kl_reg_loss: 81190.5391; val_edge_recon_loss: 2747490.5500; val_gene_expr_recon_loss: 11494568.2000; val_masked_gp_l1_reg_loss: 87454.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89455.3984; val_chrom_access_recon_loss: 2560808.0500; val_global_loss: 17060967.2000; val_optim_loss: 17060967.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9595; val_auprc_score: 0.9475; val_best_acc_score: 0.9038; val_best_f1_score: 0.9073; train_kl_reg_loss: 78641.6594; train_edge_recon_loss: 2711386.7252; train_gene_expr_recon_loss: 11576676.6947; train_masked_gp_l1_reg_loss: 87539.6724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90113.8061; train_chrom_access_recon_loss: 2548496.8721; train_global_loss: 17092855.4733; train_optim_loss: 17092855.4733; val_kl_reg_loss: 78825.5464; val_edge_recon_loss: 2717519.2667; val_gene_expr_recon_loss: 11439349.0667; val_masked_gp_l1_reg_loss: 87579.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90745.8750; val_chrom_access_recon_loss: 2533401.0500; val_global_loss: 16947420.8000; val_optim_loss: 16947420.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9619; val_auprc_score: 0.9515; val_best_acc_score: 0.9015; val_best_f1_score: 0.9062; train_kl_reg_loss: 78157.6294; train_edge_recon_loss: 2706342.1622; train_gene_expr_recon_loss: 11550282.4962; train_masked_gp_l1_reg_loss: 87772.6973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91389.6781; train_chrom_access_recon_loss: 2542661.6775; train_global_loss: 17056606.4275; train_optim_loss: 17056606.4275; val_kl_reg_loss: 77919.8714; val_edge_recon_loss: 2733175.5833; val_gene_expr_recon_loss: 11323950.4667; val_masked_gp_l1_reg_loss: 87781.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91684.8438; val_chrom_access_recon_loss: 2526328.7667; val_global_loss: 16840840.6667; val_optim_loss: 16840840.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9641; val_auprc_score: 0.9546; val_best_acc_score: 0.9069; val_best_f1_score: 0.9105; train_kl_reg_loss: 77202.3583; train_edge_recon_loss: 2705771.6622; train_gene_expr_recon_loss: 11510330.9618; train_masked_gp_l1_reg_loss: 87818.6011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92405.8368; train_chrom_access_recon_loss: 2533008.0687; train_global_loss: 17006537.4275; train_optim_loss: 17006537.4275; val_kl_reg_loss: 74568.5349; val_edge_recon_loss: 2710222.7500; val_gene_expr_recon_loss: 11400953.9333; val_masked_gp_l1_reg_loss: 87819.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92628.5703; val_chrom_access_recon_loss: 2533896.1667; val_global_loss: 16900090.4000; val_optim_loss: 16900090.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9652; val_auprc_score: 0.9568; val_best_acc_score: 0.9065; val_best_f1_score: 0.9103; train_kl_reg_loss: 78888.5315; train_edge_recon_loss: 2702120.6794; train_gene_expr_recon_loss: 11501452.1145; train_masked_gp_l1_reg_loss: 87765.1031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92786.1217; train_chrom_access_recon_loss: 2530977.0744; train_global_loss: 16993989.7176; train_optim_loss: 16993989.7176; val_kl_reg_loss: 80039.3375; val_edge_recon_loss: 2727384.2667; val_gene_expr_recon_loss: 11304439.4667; val_masked_gp_l1_reg_loss: 87779.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93979.6484; val_chrom_access_recon_loss: 2514123.3667; val_global_loss: 16807746.4667; val_optim_loss: 16807746.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9686; val_auprc_score: 0.9601; val_best_acc_score: 0.9184; val_best_f1_score: 0.9210; train_kl_reg_loss: 76711.2578; train_edge_recon_loss: 2701521.4370; train_gene_expr_recon_loss: 11472230.4580; train_masked_gp_l1_reg_loss: 87706.0112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93078.6634; train_chrom_access_recon_loss: 2521018.8053; train_global_loss: 16952266.6641; train_optim_loss: 16952266.6641; val_kl_reg_loss: 77372.7672; val_edge_recon_loss: 2691957.3167; val_gene_expr_recon_loss: 11274770.8000; val_masked_gp_l1_reg_loss: 87532.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92625.2422; val_chrom_access_recon_loss: 2497315.3833; val_global_loss: 16721573.2667; val_optim_loss: 16721573.2667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9658; val_auprc_score: 0.9573; val_best_acc_score: 0.9130; val_best_f1_score: 0.9169; train_kl_reg_loss: 76391.3981; train_edge_recon_loss: 2695718.7080; train_gene_expr_recon_loss: 11436826.1298; train_masked_gp_l1_reg_loss: 87484.4682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92904.6275; train_chrom_access_recon_loss: 2512297.4866; train_global_loss: 16901622.7557; train_optim_loss: 16901622.7557; val_kl_reg_loss: 79011.3896; val_edge_recon_loss: 2706026.8833; val_gene_expr_recon_loss: 11261408.5333; val_masked_gp_l1_reg_loss: 87454.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91965.6250; val_chrom_access_recon_loss: 2499397.8333; val_global_loss: 16725265.7333; val_optim_loss: 16725265.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9694; val_auprc_score: 0.9613; val_best_acc_score: 0.9198; val_best_f1_score: 0.9220; train_kl_reg_loss: 76276.7740; train_edge_recon_loss: 2694689.7672; train_gene_expr_recon_loss: 11418362.9618; train_masked_gp_l1_reg_loss: 87267.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92368.0265; train_chrom_access_recon_loss: 2508875.3855; train_global_loss: 16877840.1985; train_optim_loss: 16877840.1985; val_kl_reg_loss: 74566.5016; val_edge_recon_loss: 2702847.4500; val_gene_expr_recon_loss: 11199279.2000; val_masked_gp_l1_reg_loss: 87357.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93122.4844; val_chrom_access_recon_loss: 2483906.0833; val_global_loss: 16641078.1333; val_optim_loss: 16641078.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9691; val_auprc_score: 0.9590; val_best_acc_score: 0.9157; val_best_f1_score: 0.9189; train_kl_reg_loss: 76214.6208; train_edge_recon_loss: 2696983.6508; train_gene_expr_recon_loss: 11398192.5496; train_masked_gp_l1_reg_loss: 87030.9021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92542.0014; train_chrom_access_recon_loss: 2502406.6069; train_global_loss: 16853370.3664; train_optim_loss: 16853370.3664; val_kl_reg_loss: 77346.7771; val_edge_recon_loss: 2707737.7833; val_gene_expr_recon_loss: 11203696.8667; val_masked_gp_l1_reg_loss: 86954.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91941.6875; val_chrom_access_recon_loss: 2481404.4500; val_global_loss: 16649081.9333; val_optim_loss: 16649081.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9725; val_auprc_score: 0.9633; val_best_acc_score: 0.9244; val_best_f1_score: 0.9266; train_kl_reg_loss: 74851.8132; train_edge_recon_loss: 2689563.0305; train_gene_expr_recon_loss: 11392024.4198; train_masked_gp_l1_reg_loss: 86814.1789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92163.0713; train_chrom_access_recon_loss: 2498938.1011; train_global_loss: 16834354.6412; train_optim_loss: 16834354.6412; val_kl_reg_loss: 73643.8120; val_edge_recon_loss: 2685164.2833; val_gene_expr_recon_loss: 11244209.0667; val_masked_gp_l1_reg_loss: 86792.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92692.9453; val_chrom_access_recon_loss: 2499729.2500; val_global_loss: 16682231.4667; val_optim_loss: 16682231.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9701; val_auprc_score: 0.9618; val_best_acc_score: 0.9179; val_best_f1_score: 0.9206; train_kl_reg_loss: 72996.6641; train_edge_recon_loss: 2691578.8321; train_gene_expr_recon_loss: 11372447.3359; train_masked_gp_l1_reg_loss: 86680.6000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92157.9935; train_chrom_access_recon_loss: 2493295.4695; train_global_loss: 16809156.9618; train_optim_loss: 16809156.9618; val_kl_reg_loss: 72388.4682; val_edge_recon_loss: 2710056.6833; val_gene_expr_recon_loss: 11177318.2000; val_masked_gp_l1_reg_loss: 86495.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92257.1094; val_chrom_access_recon_loss: 2482848.8667; val_global_loss: 16621365.4000; val_optim_loss: 16621365.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9738; val_auprc_score: 0.9651; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 73432.3440; train_edge_recon_loss: 2687281.9962; train_gene_expr_recon_loss: 11361485.5573; train_masked_gp_l1_reg_loss: 86274.1637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92114.5413; train_chrom_access_recon_loss: 2490128.2863; train_global_loss: 16790716.9084; train_optim_loss: 16790716.9084; val_kl_reg_loss: 73816.2031; val_edge_recon_loss: 2670850.9333; val_gene_expr_recon_loss: 11189810.8000; val_masked_gp_l1_reg_loss: 86156.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92405.9844; val_chrom_access_recon_loss: 2476564.7500; val_global_loss: 16589605.6000; val_optim_loss: 16589605.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9646; val_auprc_score: 0.9553; val_best_acc_score: 0.9081; val_best_f1_score: 0.9116; train_kl_reg_loss: 84386.8861; train_edge_recon_loss: 2748370.1164; train_gene_expr_recon_loss: 10293343.2519; train_masked_gp_l1_reg_loss: 85002.1691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90167.8709; train_chrom_access_recon_loss: 2268403.8893; train_global_loss: 15569674.2901; train_optim_loss: 15569674.2901; val_kl_reg_loss: 36112.9948; val_edge_recon_loss: 2741553.8667; val_gene_expr_recon_loss: 10093323.2667; val_masked_gp_l1_reg_loss: 83422.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91449.0547; val_chrom_access_recon_loss: 2236652.5667; val_global_loss: 15282513.6000; val_optim_loss: 15282513.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9663; val_auprc_score: 0.9547; val_best_acc_score: 0.9157; val_best_f1_score: 0.9192; train_kl_reg_loss: 67155.5811; train_edge_recon_loss: 2700345.2710; train_gene_expr_recon_loss: 10241772.0382; train_masked_gp_l1_reg_loss: 81496.9416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91379.0949; train_chrom_access_recon_loss: 2247360.1011; train_global_loss: 15429509.0458; train_optim_loss: 15429509.0458; val_kl_reg_loss: 38383.3146; val_edge_recon_loss: 2715754.1500; val_gene_expr_recon_loss: 10103676.6000; val_masked_gp_l1_reg_loss: 79479.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91417.7891; val_chrom_access_recon_loss: 2235670.8167; val_global_loss: 15264382.8000; val_optim_loss: 15264382.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9708; val_auprc_score: 0.9635; val_best_acc_score: 0.9206; val_best_f1_score: 0.9233; train_kl_reg_loss: 61530.2635; train_edge_recon_loss: 2692328.1469; train_gene_expr_recon_loss: 10230383.3740; train_masked_gp_l1_reg_loss: 77680.0166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91669.0021; train_chrom_access_recon_loss: 2238841.3769; train_global_loss: 15392432.1069; train_optim_loss: 15392432.1069; val_kl_reg_loss: 44670.8112; val_edge_recon_loss: 2703236.6333; val_gene_expr_recon_loss: 10111713.9333; val_masked_gp_l1_reg_loss: 75806.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91460.4453; val_chrom_access_recon_loss: 2226232.5333; val_global_loss: 15253120.1333; val_optim_loss: 15253120.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9702; val_auprc_score: 0.9584; val_best_acc_score: 0.9266; val_best_f1_score: 0.9288; train_kl_reg_loss: 59764.0406; train_edge_recon_loss: 2679264.0859; train_gene_expr_recon_loss: 10199980.4122; train_masked_gp_l1_reg_loss: 74230.6506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91316.3683; train_chrom_access_recon_loss: 2232586.1851; train_global_loss: 15337141.7176; train_optim_loss: 15337141.7176; val_kl_reg_loss: 47156.9393; val_edge_recon_loss: 2680867.1833; val_gene_expr_recon_loss: 10041053.6000; val_masked_gp_l1_reg_loss: 73007.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91171.5547; val_chrom_access_recon_loss: 2223557.2250; val_global_loss: 15156814.1333; val_optim_loss: 15156814.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9677; val_auprc_score: 0.9564; val_best_acc_score: 0.9175; val_best_f1_score: 0.9212; train_kl_reg_loss: 57136.7634; train_edge_recon_loss: 2680266.4351; train_gene_expr_recon_loss: 10205557.6031; train_masked_gp_l1_reg_loss: 71884.6073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91074.6068; train_chrom_access_recon_loss: 2235051.7452; train_global_loss: 15340971.7328; train_optim_loss: 15340971.7328; val_kl_reg_loss: 49151.2344; val_edge_recon_loss: 2699905.0667; val_gene_expr_recon_loss: 10011293.1333; val_masked_gp_l1_reg_loss: 70978.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90623.7812; val_chrom_access_recon_loss: 2200377.3833; val_global_loss: 15122329.0000; val_optim_loss: 15122329.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9711; val_auprc_score: 0.9638; val_best_acc_score: 0.9239; val_best_f1_score: 0.9257; train_kl_reg_loss: 55363.2060; train_edge_recon_loss: 2679626.7805; train_gene_expr_recon_loss: 10176864.8550; train_masked_gp_l1_reg_loss: 70255.0156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90834.0384; train_chrom_access_recon_loss: 2226976.9742; train_global_loss: 15299920.8168; train_optim_loss: 15299920.8168; val_kl_reg_loss: 50357.4654; val_edge_recon_loss: 2704882.0500; val_gene_expr_recon_loss: 10016557.3333; val_masked_gp_l1_reg_loss: 69254.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90503.7578; val_chrom_access_recon_loss: 2211225.7417; val_global_loss: 15142780.2667; val_optim_loss: 15142780.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9711; val_auprc_score: 0.9605; val_best_acc_score: 0.9223; val_best_f1_score: 0.9257; train_kl_reg_loss: 56410.1386; train_edge_recon_loss: 2674136.4294; train_gene_expr_recon_loss: 10176753.7710; train_masked_gp_l1_reg_loss: 68614.1233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90714.5208; train_chrom_access_recon_loss: 2229095.0859; train_global_loss: 15295724.1221; train_optim_loss: 15295724.1221; val_kl_reg_loss: 51538.5531; val_edge_recon_loss: 2688041.4333; val_gene_expr_recon_loss: 10008148.8000; val_masked_gp_l1_reg_loss: 68091.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90723.8125; val_chrom_access_recon_loss: 2213322.5167; val_global_loss: 15119866.2667; val_optim_loss: 15119866.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9735; val_auprc_score: 0.9632; val_best_acc_score: 0.9297; val_best_f1_score: 0.9319; train_kl_reg_loss: 55850.1571; train_edge_recon_loss: 2672696.0172; train_gene_expr_recon_loss: 10159785.0000; train_masked_gp_l1_reg_loss: 67529.4091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90669.8133; train_chrom_access_recon_loss: 2226158.2032; train_global_loss: 15272688.6183; train_optim_loss: 15272688.6183; val_kl_reg_loss: 49479.2680; val_edge_recon_loss: 2683005.9333; val_gene_expr_recon_loss: 10017085.7333; val_masked_gp_l1_reg_loss: 67014.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90306.3828; val_chrom_access_recon_loss: 2208318.8000; val_global_loss: 15115209.8000; val_optim_loss: 15115209.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9713; val_auprc_score: 0.9623; val_best_acc_score: 0.9225; val_best_f1_score: 0.9257; train_kl_reg_loss: 54882.1092; train_edge_recon_loss: 2673984.2691; train_gene_expr_recon_loss: 10132588.3282; train_masked_gp_l1_reg_loss: 66416.8191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90276.9702; train_chrom_access_recon_loss: 2218714.3645; train_global_loss: 15236862.8473; train_optim_loss: 15236862.8473; val_kl_reg_loss: 52437.0964; val_edge_recon_loss: 2688326.7167; val_gene_expr_recon_loss: 10007603.2000; val_masked_gp_l1_reg_loss: 65817.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90340.2188; val_chrom_access_recon_loss: 2203984.0417; val_global_loss: 15108508.0000; val_optim_loss: 15108508.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9755; val_auprc_score: 0.9678; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 54833.4260; train_edge_recon_loss: 2673769.1584; train_gene_expr_recon_loss: 10127006.6565; train_masked_gp_l1_reg_loss: 65385.6105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90130.6586; train_chrom_access_recon_loss: 2216299.5773; train_global_loss: 15227425.0763; train_optim_loss: 15227425.0763; val_kl_reg_loss: 50020.0125; val_edge_recon_loss: 2665554.4833; val_gene_expr_recon_loss: 9954311.6000; val_masked_gp_l1_reg_loss: 65103.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90011.1875; val_chrom_access_recon_loss: 2195750.3667; val_global_loss: 15020750.4000; val_optim_loss: 15020750.4000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9751; val_auprc_score: 0.9666; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 55036.8737; train_edge_recon_loss: 2660576.3931; train_gene_expr_recon_loss: 10110197.6336; train_masked_gp_l1_reg_loss: 64806.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90121.4646; train_chrom_access_recon_loss: 2210395.4218; train_global_loss: 15191134.4046; train_optim_loss: 15191134.4046; val_kl_reg_loss: 50229.1221; val_edge_recon_loss: 2681393.2667; val_gene_expr_recon_loss: 10000346.4667; val_masked_gp_l1_reg_loss: 64458.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90093.5703; val_chrom_access_recon_loss: 2199635.2417; val_global_loss: 15086156.0667; val_optim_loss: 15086156.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9733; val_auprc_score: 0.9611; val_best_acc_score: 0.9286; val_best_f1_score: 0.9309; train_kl_reg_loss: 55020.9411; train_edge_recon_loss: 2673011.4733; train_gene_expr_recon_loss: 10110278.5496; train_masked_gp_l1_reg_loss: 64255.6303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89980.4130; train_chrom_access_recon_loss: 2209207.7653; train_global_loss: 15201754.7252; train_optim_loss: 15201754.7252; val_kl_reg_loss: 51946.4766; val_edge_recon_loss: 2688661.2167; val_gene_expr_recon_loss: 9950890.0667; val_masked_gp_l1_reg_loss: 64051.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89743.8281; val_chrom_access_recon_loss: 2196208.2833; val_global_loss: 15041501.2000; val_optim_loss: 15041501.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9777; val_auprc_score: 0.9715; val_best_acc_score: 0.9309; val_best_f1_score: 0.9324; train_kl_reg_loss: 54643.3809; train_edge_recon_loss: 2672933.0191; train_gene_expr_recon_loss: 10104766.0229; train_masked_gp_l1_reg_loss: 63734.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89772.2558; train_chrom_access_recon_loss: 2207722.7834; train_global_loss: 15193571.5802; train_optim_loss: 15193571.5802; val_kl_reg_loss: 51342.9669; val_edge_recon_loss: 2696142.7333; val_gene_expr_recon_loss: 9964352.7333; val_masked_gp_l1_reg_loss: 63512.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89672.6328; val_chrom_access_recon_loss: 2188908.4000; val_global_loss: 15053931.6667; val_optim_loss: 15053931.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9773; val_auprc_score: 0.9675; val_best_acc_score: 0.9325; val_best_f1_score: 0.9332; train_kl_reg_loss: 54690.8459; train_edge_recon_loss: 2663126.9084; train_gene_expr_recon_loss: 10089430.8779; train_masked_gp_l1_reg_loss: 63255.6137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89844.7592; train_chrom_access_recon_loss: 2203084.7815; train_global_loss: 15163433.7481; train_optim_loss: 15163433.7481; val_kl_reg_loss: 50150.7909; val_edge_recon_loss: 2686939.8833; val_gene_expr_recon_loss: 9932797.6000; val_masked_gp_l1_reg_loss: 62935.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89780.3047; val_chrom_access_recon_loss: 2198697.1333; val_global_loss: 15021300.4000; val_optim_loss: 15021300.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9738; val_auprc_score: 0.9664; val_best_acc_score: 0.9263; val_best_f1_score: 0.9281; train_kl_reg_loss: 54032.7725; train_edge_recon_loss: 2668286.9676; train_gene_expr_recon_loss: 10074160.1069; train_masked_gp_l1_reg_loss: 62212.3932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72147.6344; train_chrom_access_recon_loss: 2201132.5735; train_global_loss: 15131972.5115; train_optim_loss: 15131972.5115; val_kl_reg_loss: 53114.1273; val_edge_recon_loss: 2681710.5000; val_gene_expr_recon_loss: 9945268.6000; val_masked_gp_l1_reg_loss: 61978.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69654.5859; val_chrom_access_recon_loss: 2190387.6750; val_global_loss: 15002113.8667; val_optim_loss: 15002113.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9771; val_auprc_score: 0.9696; val_best_acc_score: 0.9338; val_best_f1_score: 0.9358; train_kl_reg_loss: 56077.8278; train_edge_recon_loss: 2663455.4065; train_gene_expr_recon_loss: 10076960.2519; train_masked_gp_l1_reg_loss: 61902.6127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69117.9681; train_chrom_access_recon_loss: 2202593.6651; train_global_loss: 15130107.6412; train_optim_loss: 15130107.6412; val_kl_reg_loss: 54533.3820; val_edge_recon_loss: 2678635.2667; val_gene_expr_recon_loss: 9927926.5333; val_masked_gp_l1_reg_loss: 61859.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68683.2812; val_chrom_access_recon_loss: 2197687.4333; val_global_loss: 14989325.6667; val_optim_loss: 14989325.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9753; val_auprc_score: 0.9655; val_best_acc_score: 0.9324; val_best_f1_score: 0.9348; train_kl_reg_loss: 56953.0911; train_edge_recon_loss: 2658949.0134; train_gene_expr_recon_loss: 10076165.4580; train_masked_gp_l1_reg_loss: 61805.3986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68401.6499; train_chrom_access_recon_loss: 2200334.7052; train_global_loss: 15122609.3282; train_optim_loss: 15122609.3282; val_kl_reg_loss: 54263.1305; val_edge_recon_loss: 2675534.6000; val_gene_expr_recon_loss: 9899755.6667; val_masked_gp_l1_reg_loss: 61766.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68066.9062; val_chrom_access_recon_loss: 2179443.3083; val_global_loss: 14938829.8000; val_optim_loss: 14938829.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9772; val_auprc_score: 0.9663; val_best_acc_score: 0.9336; val_best_f1_score: 0.9355; train_kl_reg_loss: 56972.2665; train_edge_recon_loss: 2654210.8683; train_gene_expr_recon_loss: 10070696.5573; train_masked_gp_l1_reg_loss: 61720.9522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67873.8130; train_chrom_access_recon_loss: 2200403.5468; train_global_loss: 15111878.0229; train_optim_loss: 15111878.0229; val_kl_reg_loss: 54359.1958; val_edge_recon_loss: 2659940.5000; val_gene_expr_recon_loss: 9968039.7333; val_masked_gp_l1_reg_loss: 61671.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67577.9766; val_chrom_access_recon_loss: 2191365.3000; val_global_loss: 15002954.6000; val_optim_loss: 15002954.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9777; val_auprc_score: 0.9688; val_best_acc_score: 0.9365; val_best_f1_score: 0.9389; train_kl_reg_loss: 57263.9089; train_edge_recon_loss: 2659656.5649; train_gene_expr_recon_loss: 10074143.2672; train_masked_gp_l1_reg_loss: 61636.6209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67376.1050; train_chrom_access_recon_loss: 2200352.1784; train_global_loss: 15120428.6870; train_optim_loss: 15120428.6870; val_kl_reg_loss: 55160.5232; val_edge_recon_loss: 2658449.7000; val_gene_expr_recon_loss: 9910894.5333; val_masked_gp_l1_reg_loss: 61618.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67188.0781; val_chrom_access_recon_loss: 2186571.7583; val_global_loss: 14939883.4000; val_optim_loss: 14939883.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9758; val_auprc_score: 0.9681; val_best_acc_score: 0.9318; val_best_f1_score: 0.9340; train_kl_reg_loss: 57049.1249; train_edge_recon_loss: 2665917.2844; train_gene_expr_recon_loss: 10079192.8626; train_masked_gp_l1_reg_loss: 61577.7895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67060.7236; train_chrom_access_recon_loss: 2202005.6985; train_global_loss: 15132803.4580; train_optim_loss: 15132803.4580; val_kl_reg_loss: 55189.3359; val_edge_recon_loss: 2678841.5333; val_gene_expr_recon_loss: 9970428.8000; val_masked_gp_l1_reg_loss: 61541.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66888.8828; val_chrom_access_recon_loss: 2197997.7167; val_global_loss: 15030887.3333; val_optim_loss: 15030887.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9751; val_auprc_score: 0.9672; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 57456.4978; train_edge_recon_loss: 2661973.8378; train_gene_expr_recon_loss: 10068716.0305; train_masked_gp_l1_reg_loss: 61499.3674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66725.3831; train_chrom_access_recon_loss: 2200843.5134; train_global_loss: 15117214.6794; train_optim_loss: 15117214.6794; val_kl_reg_loss: 55172.6641; val_edge_recon_loss: 2678646.5500; val_gene_expr_recon_loss: 9914030.2667; val_masked_gp_l1_reg_loss: 61452.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66497.6172; val_chrom_access_recon_loss: 2181754.5000; val_global_loss: 14957553.8000; val_optim_loss: 14957553.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9770; val_auprc_score: 0.9675; val_best_acc_score: 0.9379; val_best_f1_score: 0.9399; train_kl_reg_loss: 57710.6188; train_edge_recon_loss: 2666709.5382; train_gene_expr_recon_loss: 10066669.0458; train_masked_gp_l1_reg_loss: 61378.0865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64656.7543; train_chrom_access_recon_loss: 2198900.0782; train_global_loss: 15116024.1527; train_optim_loss: 15116024.1527; val_kl_reg_loss: 55605.4096; val_edge_recon_loss: 2657332.3333; val_gene_expr_recon_loss: 9916014.9333; val_masked_gp_l1_reg_loss: 61350.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64416.4141; val_chrom_access_recon_loss: 2195510.2333; val_global_loss: 14950228.8667; val_optim_loss: 14950228.8667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9788; val_auprc_score: 0.9732; val_best_acc_score: 0.9363; val_best_f1_score: 0.9384; train_kl_reg_loss: 57704.3827; train_edge_recon_loss: 2663077.1069; train_gene_expr_recon_loss: 10058109.0458; train_masked_gp_l1_reg_loss: 61340.3172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64353.7618; train_chrom_access_recon_loss: 2198313.4094; train_global_loss: 15102897.9771; train_optim_loss: 15102897.9771; val_kl_reg_loss: 55558.4763; val_edge_recon_loss: 2678668.5333; val_gene_expr_recon_loss: 9920493.7333; val_masked_gp_l1_reg_loss: 61328.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64294.0820; val_chrom_access_recon_loss: 2185823.4667; val_global_loss: 14966167.4667; val_optim_loss: 14966167.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9775; val_auprc_score: 0.9694; val_best_acc_score: 0.9355; val_best_f1_score: 0.9375; train_kl_reg_loss: 57608.9868; train_edge_recon_loss: 2652854.0401; train_gene_expr_recon_loss: 10048736.7557; train_masked_gp_l1_reg_loss: 61321.0694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64247.2279; train_chrom_access_recon_loss: 2196182.3244; train_global_loss: 15080950.4580; train_optim_loss: 15080950.4580; val_kl_reg_loss: 55667.2487; val_edge_recon_loss: 2664979.0333; val_gene_expr_recon_loss: 9939366.0667; val_masked_gp_l1_reg_loss: 61314.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64206.9414; val_chrom_access_recon_loss: 2187892.3167; val_global_loss: 14973425.6667; val_optim_loss: 14973425.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9768; val_auprc_score: 0.9676; val_best_acc_score: 0.9359; val_best_f1_score: 0.9380; train_kl_reg_loss: 57637.8753; train_edge_recon_loss: 2658972.4866; train_gene_expr_recon_loss: 10072459.2366; train_masked_gp_l1_reg_loss: 61310.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64179.2527; train_chrom_access_recon_loss: 2199479.5105; train_global_loss: 15114038.3740; train_optim_loss: 15114038.3740; val_kl_reg_loss: 55460.7464; val_edge_recon_loss: 2663919.4500; val_gene_expr_recon_loss: 9937909.7333; val_masked_gp_l1_reg_loss: 61303.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64143.0664; val_chrom_access_recon_loss: 2200304.6500; val_global_loss: 14983041.5333; val_optim_loss: 14983041.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 50 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9780
val AUPRC score: 0.9719
val best accuracy score: 0.9307
val best F1 score: 0.9335
val target rna MSE score: 1.9168
val source rna MSE score: 0.5992
val target atac MSE score: 0.4996
val source atac MSE score: 0.1494
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
