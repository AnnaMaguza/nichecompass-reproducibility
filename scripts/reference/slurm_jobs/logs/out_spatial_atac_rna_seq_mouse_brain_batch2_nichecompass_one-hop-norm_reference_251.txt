[True]
Run timestamp: 07092023_033028_251.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_251']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3427 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7945, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3427
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3427

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7903; val_auprc_score: 0.7985; val_best_acc_score: 0.5424; val_best_f1_score: 0.6840; train_kl_reg_loss: 84622.5202; train_edge_recon_loss: 3562079.6202; train_gene_expr_recon_loss: 17059084.7252; train_masked_gp_l1_reg_loss: 47367.1002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5749149.3383; train_chrom_access_recon_loss: 15774901.0382; train_global_loss: 42277204.2443; train_optim_loss: 42277204.2443; val_kl_reg_loss: 115209.5870; val_edge_recon_loss: 4062620.9333; val_gene_expr_recon_loss: 15621080.4667; val_masked_gp_l1_reg_loss: 42095.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 475425.7188; val_chrom_access_recon_loss: 14930550.5333; val_global_loss: 35246982.9333; val_optim_loss: 35246982.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8604; val_auprc_score: 0.8634; val_best_acc_score: 0.7685; val_best_f1_score: 0.7884; train_kl_reg_loss: 114520.8826; train_edge_recon_loss: 3529453.1947; train_gene_expr_recon_loss: 15533723.5038; train_masked_gp_l1_reg_loss: 40806.3152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 292611.4342; train_chrom_access_recon_loss: 15087038.0992; train_global_loss: 34598153.4809; train_optim_loss: 34598153.4809; val_kl_reg_loss: 118794.1609; val_edge_recon_loss: 4035105.0833; val_gene_expr_recon_loss: 15317794.0000; val_masked_gp_l1_reg_loss: 41414.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210900.2969; val_chrom_access_recon_loss: 14692597.6667; val_global_loss: 34416604.5333; val_optim_loss: 34416604.5333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8697; val_auprc_score: 0.8645; val_best_acc_score: 0.7881; val_best_f1_score: 0.8044; train_kl_reg_loss: 90666.9885; train_edge_recon_loss: 3468809.6260; train_gene_expr_recon_loss: 15305954.1985; train_masked_gp_l1_reg_loss: 43678.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183622.8074; train_chrom_access_recon_loss: 14874143.7099; train_global_loss: 33966875.2366; train_optim_loss: 33966875.2366; val_kl_reg_loss: 74072.6021; val_edge_recon_loss: 3313972.1500; val_gene_expr_recon_loss: 15134285.5333; val_masked_gp_l1_reg_loss: 46648.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165423.9688; val_chrom_access_recon_loss: 14476932.2000; val_global_loss: 33211334.4000; val_optim_loss: 33211334.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9018; val_auprc_score: 0.8893; val_best_acc_score: 0.8277; val_best_f1_score: 0.8377; train_kl_reg_loss: 106589.2951; train_edge_recon_loss: 3014092.9008; train_gene_expr_recon_loss: 15144791.8855; train_masked_gp_l1_reg_loss: 48921.8135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157653.6503; train_chrom_access_recon_loss: 14708590.4809; train_global_loss: 33180639.9237; train_optim_loss: 33180639.9237; val_kl_reg_loss: 112230.1224; val_edge_recon_loss: 2956638.2833; val_gene_expr_recon_loss: 15019794.8000; val_masked_gp_l1_reg_loss: 50883.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150711.5469; val_chrom_access_recon_loss: 14371296.2667; val_global_loss: 32661555.2000; val_optim_loss: 32661555.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9187; val_auprc_score: 0.9058; val_best_acc_score: 0.8490; val_best_f1_score: 0.8574; train_kl_reg_loss: 116285.9564; train_edge_recon_loss: 2885100.2977; train_gene_expr_recon_loss: 14987945.6565; train_masked_gp_l1_reg_loss: 52213.6160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145767.0971; train_chrom_access_recon_loss: 14544354.0763; train_global_loss: 32731666.6870; train_optim_loss: 32731666.6870; val_kl_reg_loss: 117111.8625; val_edge_recon_loss: 2868765.3833; val_gene_expr_recon_loss: 14798135.4000; val_masked_gp_l1_reg_loss: 53926.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142073.1875; val_chrom_access_recon_loss: 14146996.3333; val_global_loss: 32127008.8000; val_optim_loss: 32127008.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9152; val_auprc_score: 0.8966; val_best_acc_score: 0.8440; val_best_f1_score: 0.8538; train_kl_reg_loss: 116728.8702; train_edge_recon_loss: 2847181.7156; train_gene_expr_recon_loss: 14872366.0458; train_masked_gp_l1_reg_loss: 55017.2992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139516.6115; train_chrom_access_recon_loss: 14430921.5878; train_global_loss: 32461732.1069; train_optim_loss: 32461732.1069; val_kl_reg_loss: 112013.0776; val_edge_recon_loss: 2879429.0500; val_gene_expr_recon_loss: 14818189.9333; val_masked_gp_l1_reg_loss: 56292.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137344.4219; val_chrom_access_recon_loss: 14122412.6000; val_global_loss: 32125680.8000; val_optim_loss: 32125680.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9286; val_auprc_score: 0.9148; val_best_acc_score: 0.8557; val_best_f1_score: 0.8649; train_kl_reg_loss: 113264.9643; train_edge_recon_loss: 2825733.8187; train_gene_expr_recon_loss: 14753611.5725; train_masked_gp_l1_reg_loss: 57371.7405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135171.2184; train_chrom_access_recon_loss: 14292805.3893; train_global_loss: 32177958.7328; train_optim_loss: 32177958.7328; val_kl_reg_loss: 109548.4146; val_edge_recon_loss: 2825003.2500; val_gene_expr_recon_loss: 14690159.7333; val_masked_gp_l1_reg_loss: 58395.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133816.0156; val_chrom_access_recon_loss: 14018869.6000; val_global_loss: 31835793.0667; val_optim_loss: 31835793.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9216; val_best_acc_score: 0.8692; val_best_f1_score: 0.8760; train_kl_reg_loss: 109806.6598; train_edge_recon_loss: 2806391.2901; train_gene_expr_recon_loss: 14655834.0687; train_masked_gp_l1_reg_loss: 59415.0686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132416.3169; train_chrom_access_recon_loss: 14190357.3435; train_global_loss: 31954220.7023; train_optim_loss: 31954220.7023; val_kl_reg_loss: 110355.7203; val_edge_recon_loss: 2806130.2333; val_gene_expr_recon_loss: 14631468.9333; val_masked_gp_l1_reg_loss: 60380.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131398.8281; val_chrom_access_recon_loss: 13920007.0000; val_global_loss: 31659739.3333; val_optim_loss: 31659739.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9475; val_auprc_score: 0.9300; val_best_acc_score: 0.8857; val_best_f1_score: 0.8896; train_kl_reg_loss: 107257.0500; train_edge_recon_loss: 2790093.0057; train_gene_expr_recon_loss: 14575956.3740; train_masked_gp_l1_reg_loss: 61289.8463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130929.7878; train_chrom_access_recon_loss: 14102332.8931; train_global_loss: 31767858.7328; train_optim_loss: 31767858.7328; val_kl_reg_loss: 102006.0396; val_edge_recon_loss: 2776321.4833; val_gene_expr_recon_loss: 14482346.0000; val_masked_gp_l1_reg_loss: 62226.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130719.8828; val_chrom_access_recon_loss: 13805064.1333; val_global_loss: 31358683.8667; val_optim_loss: 31358683.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9471; val_auprc_score: 0.9329; val_best_acc_score: 0.8870; val_best_f1_score: 0.8921; train_kl_reg_loss: 109166.3049; train_edge_recon_loss: 2767405.0973; train_gene_expr_recon_loss: 14485463.9542; train_masked_gp_l1_reg_loss: 63013.6961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130092.2823; train_chrom_access_recon_loss: 14013757.1908; train_global_loss: 31568898.4427; train_optim_loss: 31568898.4427; val_kl_reg_loss: 106879.0974; val_edge_recon_loss: 2760309.9500; val_gene_expr_recon_loss: 14377635.5333; val_masked_gp_l1_reg_loss: 63901.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129767.8984; val_chrom_access_recon_loss: 13692300.2667; val_global_loss: 31130794.4000; val_optim_loss: 31130794.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9481; val_auprc_score: 0.9348; val_best_acc_score: 0.8884; val_best_f1_score: 0.8945; train_kl_reg_loss: 106626.7159; train_edge_recon_loss: 2752770.1947; train_gene_expr_recon_loss: 14410403.1298; train_masked_gp_l1_reg_loss: 64490.5280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129432.1815; train_chrom_access_recon_loss: 13928379.7786; train_global_loss: 31392102.6107; train_optim_loss: 31392102.6107; val_kl_reg_loss: 105406.3094; val_edge_recon_loss: 2775028.0167; val_gene_expr_recon_loss: 14305334.8000; val_masked_gp_l1_reg_loss: 65077.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129594.3594; val_chrom_access_recon_loss: 13556040.2000; val_global_loss: 30936481.3333; val_optim_loss: 30936481.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9536; val_auprc_score: 0.9388; val_best_acc_score: 0.8937; val_best_f1_score: 0.8985; train_kl_reg_loss: 104185.0371; train_edge_recon_loss: 2755468.5840; train_gene_expr_recon_loss: 14354650.0382; train_masked_gp_l1_reg_loss: 65779.7125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128945.5520; train_chrom_access_recon_loss: 13853006.1145; train_global_loss: 31262034.8244; train_optim_loss: 31262034.8244; val_kl_reg_loss: 104779.5042; val_edge_recon_loss: 2756448.5000; val_gene_expr_recon_loss: 14277100.4000; val_masked_gp_l1_reg_loss: 66482.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128879.5781; val_chrom_access_recon_loss: 13559855.6667; val_global_loss: 30893546.1333; val_optim_loss: 30893546.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9590; val_auprc_score: 0.9488; val_best_acc_score: 0.8972; val_best_f1_score: 0.9025; train_kl_reg_loss: 102250.8053; train_edge_recon_loss: 2746731.8302; train_gene_expr_recon_loss: 14289647.3435; train_masked_gp_l1_reg_loss: 67120.7745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128698.2729; train_chrom_access_recon_loss: 13784069.3206; train_global_loss: 31118518.3359; train_optim_loss: 31118518.3359; val_kl_reg_loss: 99446.4307; val_edge_recon_loss: 2747132.0667; val_gene_expr_recon_loss: 14227181.6000; val_masked_gp_l1_reg_loss: 67700.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128240.4766; val_chrom_access_recon_loss: 13545329.9333; val_global_loss: 30815030.2667; val_optim_loss: 30815030.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9588; val_auprc_score: 0.9457; val_best_acc_score: 0.9019; val_best_f1_score: 0.9060; train_kl_reg_loss: 100576.6022; train_edge_recon_loss: 2739540.9656; train_gene_expr_recon_loss: 14233673.8321; train_masked_gp_l1_reg_loss: 68308.4973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128086.9688; train_chrom_access_recon_loss: 13722050.4351; train_global_loss: 30992237.2214; train_optim_loss: 30992237.2214; val_kl_reg_loss: 98484.4812; val_edge_recon_loss: 2740771.3167; val_gene_expr_recon_loss: 14235862.0667; val_masked_gp_l1_reg_loss: 68785.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128070.2500; val_chrom_access_recon_loss: 13467792.5333; val_global_loss: 30739766.4000; val_optim_loss: 30739766.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9569; val_auprc_score: 0.9478; val_best_acc_score: 0.8954; val_best_f1_score: 0.9001; train_kl_reg_loss: 100412.2688; train_edge_recon_loss: 2736639.5019; train_gene_expr_recon_loss: 14194973.4198; train_masked_gp_l1_reg_loss: 69258.2643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127958.7394; train_chrom_access_recon_loss: 13675745.2366; train_global_loss: 30904987.4962; train_optim_loss: 30904987.4962; val_kl_reg_loss: 99947.7474; val_edge_recon_loss: 2752556.3667; val_gene_expr_recon_loss: 14203928.2667; val_masked_gp_l1_reg_loss: 69684.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127953.5781; val_chrom_access_recon_loss: 13449315.2000; val_global_loss: 30703385.4667; val_optim_loss: 30703385.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9590; val_auprc_score: 0.9484; val_best_acc_score: 0.9051; val_best_f1_score: 0.9095; train_kl_reg_loss: 98126.6997; train_edge_recon_loss: 2736950.5897; train_gene_expr_recon_loss: 14138192.2901; train_masked_gp_l1_reg_loss: 70238.9042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127753.5453; train_chrom_access_recon_loss: 13604232.9771; train_global_loss: 30775494.8855; train_optim_loss: 30775494.8855; val_kl_reg_loss: 97473.0297; val_edge_recon_loss: 2736232.3167; val_gene_expr_recon_loss: 14161428.0667; val_masked_gp_l1_reg_loss: 70732.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127936.1172; val_chrom_access_recon_loss: 13374947.2000; val_global_loss: 30568748.9333; val_optim_loss: 30568748.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9508; val_best_acc_score: 0.9072; val_best_f1_score: 0.9107; train_kl_reg_loss: 96853.0252; train_edge_recon_loss: 2733035.4599; train_gene_expr_recon_loss: 14115752.0534; train_masked_gp_l1_reg_loss: 71239.1487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127915.5707; train_chrom_access_recon_loss: 13568460.3282; train_global_loss: 30713255.4656; train_optim_loss: 30713255.4656; val_kl_reg_loss: 94495.0453; val_edge_recon_loss: 2732582.6167; val_gene_expr_recon_loss: 14008775.0667; val_masked_gp_l1_reg_loss: 71552.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127613.5078; val_chrom_access_recon_loss: 13273869.0000; val_global_loss: 30308888.2667; val_optim_loss: 30308888.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9632; val_auprc_score: 0.9520; val_best_acc_score: 0.9066; val_best_f1_score: 0.9098; train_kl_reg_loss: 94895.9562; train_edge_recon_loss: 2733146.0439; train_gene_expr_recon_loss: 14061828.5191; train_masked_gp_l1_reg_loss: 72027.9246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127796.4919; train_chrom_access_recon_loss: 13512604.6794; train_global_loss: 30602299.4809; train_optim_loss: 30602299.4809; val_kl_reg_loss: 94599.3380; val_edge_recon_loss: 2729699.4333; val_gene_expr_recon_loss: 14009176.4000; val_masked_gp_l1_reg_loss: 72581.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128022.2344; val_chrom_access_recon_loss: 13196340.5333; val_global_loss: 30230419.6000; val_optim_loss: 30230419.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9650; val_auprc_score: 0.9544; val_best_acc_score: 0.9131; val_best_f1_score: 0.9154; train_kl_reg_loss: 93930.9957; train_edge_recon_loss: 2723023.0992; train_gene_expr_recon_loss: 14024022.1527; train_masked_gp_l1_reg_loss: 72901.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128029.5451; train_chrom_access_recon_loss: 13463215.2443; train_global_loss: 30505122.1832; train_optim_loss: 30505122.1832; val_kl_reg_loss: 94000.5042; val_edge_recon_loss: 2730869.1833; val_gene_expr_recon_loss: 13955401.4667; val_masked_gp_l1_reg_loss: 73410.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128363.8125; val_chrom_access_recon_loss: 13210992.6000; val_global_loss: 30193038.1333; val_optim_loss: 30193038.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9667; val_auprc_score: 0.9573; val_best_acc_score: 0.9132; val_best_f1_score: 0.9163; train_kl_reg_loss: 93902.3228; train_edge_recon_loss: 2719835.3187; train_gene_expr_recon_loss: 13996919.0076; train_masked_gp_l1_reg_loss: 73773.6902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128425.8754; train_chrom_access_recon_loss: 13432616.1603; train_global_loss: 30445472.2443; train_optim_loss: 30445472.2443; val_kl_reg_loss: 93833.7995; val_edge_recon_loss: 2739909.3333; val_gene_expr_recon_loss: 13949463.5333; val_masked_gp_l1_reg_loss: 73955.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128138.4609; val_chrom_access_recon_loss: 13175418.4000; val_global_loss: 30160718.6667; val_optim_loss: 30160718.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9653; val_auprc_score: 0.9554; val_best_acc_score: 0.9103; val_best_f1_score: 0.9145; train_kl_reg_loss: 93172.8768; train_edge_recon_loss: 2715059.4618; train_gene_expr_recon_loss: 13967714.5496; train_masked_gp_l1_reg_loss: 74367.7992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128613.2808; train_chrom_access_recon_loss: 13393299.6489; train_global_loss: 30372227.4809; train_optim_loss: 30372227.4809; val_kl_reg_loss: 90769.6219; val_edge_recon_loss: 2741069.4167; val_gene_expr_recon_loss: 13905234.8667; val_masked_gp_l1_reg_loss: 74639.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129265.1406; val_chrom_access_recon_loss: 13132518.4667; val_global_loss: 30073498.0000; val_optim_loss: 30073498.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9688; val_auprc_score: 0.9601; val_best_acc_score: 0.9151; val_best_f1_score: 0.9188; train_kl_reg_loss: 91764.1278; train_edge_recon_loss: 2708722.4695; train_gene_expr_recon_loss: 13941206.0611; train_masked_gp_l1_reg_loss: 75062.7375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129251.3246; train_chrom_access_recon_loss: 13351217.2748; train_global_loss: 30297223.8626; train_optim_loss: 30297223.8626; val_kl_reg_loss: 90755.0344; val_edge_recon_loss: 2731630.3333; val_gene_expr_recon_loss: 13913373.9333; val_masked_gp_l1_reg_loss: 75388.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129829.7109; val_chrom_access_recon_loss: 13174340.4000; val_global_loss: 30115318.0000; val_optim_loss: 30115318.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9729; val_auprc_score: 0.9673; val_best_acc_score: 0.9227; val_best_f1_score: 0.9255; train_kl_reg_loss: 91241.7917; train_edge_recon_loss: 2714846.6508; train_gene_expr_recon_loss: 13913933.0534; train_masked_gp_l1_reg_loss: 75755.5395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129699.9796; train_chrom_access_recon_loss: 13320207.1603; train_global_loss: 30245684.1679; train_optim_loss: 30245684.1679; val_kl_reg_loss: 91340.8359; val_edge_recon_loss: 2712728.6333; val_gene_expr_recon_loss: 13861724.3333; val_masked_gp_l1_reg_loss: 76077.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130240.3438; val_chrom_access_recon_loss: 13110318.3333; val_global_loss: 29982430.1333; val_optim_loss: 29982430.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9713; val_auprc_score: 0.9617; val_best_acc_score: 0.9220; val_best_f1_score: 0.9240; train_kl_reg_loss: 90822.7892; train_edge_recon_loss: 2715535.0019; train_gene_expr_recon_loss: 13887884.8397; train_masked_gp_l1_reg_loss: 76398.3527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130358.9547; train_chrom_access_recon_loss: 13279249.7328; train_global_loss: 30180249.6489; train_optim_loss: 30180249.6489; val_kl_reg_loss: 89843.0177; val_edge_recon_loss: 2732628.8500; val_gene_expr_recon_loss: 13806184.4667; val_masked_gp_l1_reg_loss: 76616.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129710.5391; val_chrom_access_recon_loss: 13021514.0000; val_global_loss: 29856496.8000; val_optim_loss: 29856496.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9754; val_auprc_score: 0.9693; val_best_acc_score: 0.9287; val_best_f1_score: 0.9304; train_kl_reg_loss: 90225.7084; train_edge_recon_loss: 2708898.1031; train_gene_expr_recon_loss: 13867724.5420; train_masked_gp_l1_reg_loss: 76968.7015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130533.1732; train_chrom_access_recon_loss: 13253948.5573; train_global_loss: 30128298.7328; train_optim_loss: 30128298.7328; val_kl_reg_loss: 87948.9005; val_edge_recon_loss: 2713697.5833; val_gene_expr_recon_loss: 13847264.1333; val_masked_gp_l1_reg_loss: 77122.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130957.9141; val_chrom_access_recon_loss: 13019961.2667; val_global_loss: 29876951.7333; val_optim_loss: 29876951.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9738; val_auprc_score: 0.9672; val_best_acc_score: 0.9256; val_best_f1_score: 0.9275; train_kl_reg_loss: 90307.7093; train_edge_recon_loss: 2694140.6603; train_gene_expr_recon_loss: 13843099.6336; train_masked_gp_l1_reg_loss: 77580.1808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131128.1367; train_chrom_access_recon_loss: 13219319.4275; train_global_loss: 30055575.7099; train_optim_loss: 30055575.7099; val_kl_reg_loss: 89089.9719; val_edge_recon_loss: 2717049.5667; val_gene_expr_recon_loss: 13758991.2000; val_masked_gp_l1_reg_loss: 77897.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131448.3594; val_chrom_access_recon_loss: 12969098.5333; val_global_loss: 29743575.3333; val_optim_loss: 29743575.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9770; val_auprc_score: 0.9698; val_best_acc_score: 0.9326; val_best_f1_score: 0.9347; train_kl_reg_loss: 90245.9202; train_edge_recon_loss: 2698542.6355; train_gene_expr_recon_loss: 13817618.2366; train_masked_gp_l1_reg_loss: 78143.8275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131317.4913; train_chrom_access_recon_loss: 13181249.5954; train_global_loss: 29997117.8321; train_optim_loss: 29997117.8321; val_kl_reg_loss: 88426.6328; val_edge_recon_loss: 2701065.5000; val_gene_expr_recon_loss: 13745784.7333; val_masked_gp_l1_reg_loss: 78344.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131416.1562; val_chrom_access_recon_loss: 12925254.4000; val_global_loss: 29670291.3333; val_optim_loss: 29670291.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9746; val_auprc_score: 0.9680; val_best_acc_score: 0.9254; val_best_f1_score: 0.9276; train_kl_reg_loss: 89739.1691; train_edge_recon_loss: 2693938.6450; train_gene_expr_recon_loss: 13806126.3282; train_masked_gp_l1_reg_loss: 78641.8579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131643.6976; train_chrom_access_recon_loss: 13166645.7863; train_global_loss: 29966735.4351; train_optim_loss: 29966735.4351; val_kl_reg_loss: 91539.2354; val_edge_recon_loss: 2730945.7167; val_gene_expr_recon_loss: 13774130.0000; val_masked_gp_l1_reg_loss: 78839.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132124.3594; val_chrom_access_recon_loss: 12924419.0000; val_global_loss: 29731997.8667; val_optim_loss: 29731997.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9775; val_auprc_score: 0.9711; val_best_acc_score: 0.9321; val_best_f1_score: 0.9336; train_kl_reg_loss: 89517.4172; train_edge_recon_loss: 2698070.2252; train_gene_expr_recon_loss: 13790663.1603; train_masked_gp_l1_reg_loss: 79116.3832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132044.0482; train_chrom_access_recon_loss: 13133689.0763; train_global_loss: 29923100.4122; train_optim_loss: 29923100.4122; val_kl_reg_loss: 88811.1167; val_edge_recon_loss: 2710764.6500; val_gene_expr_recon_loss: 13827856.0667; val_masked_gp_l1_reg_loss: 79371.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131996.9844; val_chrom_access_recon_loss: 12988435.6000; val_global_loss: 29827236.0000; val_optim_loss: 29827236.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9785; val_auprc_score: 0.9725; val_best_acc_score: 0.9329; val_best_f1_score: 0.9349; train_kl_reg_loss: 89135.1058; train_edge_recon_loss: 2696411.2023; train_gene_expr_recon_loss: 13773205.0382; train_masked_gp_l1_reg_loss: 79539.5645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132204.5744; train_chrom_access_recon_loss: 13110040.2290; train_global_loss: 29880535.6947; train_optim_loss: 29880535.6947; val_kl_reg_loss: 88817.3406; val_edge_recon_loss: 2708185.0000; val_gene_expr_recon_loss: 13755738.8000; val_masked_gp_l1_reg_loss: 79951.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132727.4844; val_chrom_access_recon_loss: 12931030.8000; val_global_loss: 29696450.5333; val_optim_loss: 29696450.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9767; val_auprc_score: 0.9709; val_best_acc_score: 0.9291; val_best_f1_score: 0.9320; train_kl_reg_loss: 88885.9739; train_edge_recon_loss: 2695488.5630; train_gene_expr_recon_loss: 13757549.0000; train_masked_gp_l1_reg_loss: 80030.1863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132462.4603; train_chrom_access_recon_loss: 13090589.9237; train_global_loss: 29845006.1985; train_optim_loss: 29845006.1985; val_kl_reg_loss: 88209.8656; val_edge_recon_loss: 2730437.9333; val_gene_expr_recon_loss: 13767248.2667; val_masked_gp_l1_reg_loss: 80213.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132329.2500; val_chrom_access_recon_loss: 12932516.6000; val_global_loss: 29730956.2667; val_optim_loss: 29730956.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9788; val_auprc_score: 0.9720; val_best_acc_score: 0.9364; val_best_f1_score: 0.9380; train_kl_reg_loss: 90138.2773; train_edge_recon_loss: 2687171.4656; train_gene_expr_recon_loss: 13737140.1145; train_masked_gp_l1_reg_loss: 78455.7334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93555.3921; train_chrom_access_recon_loss: 13055659.3740; train_global_loss: 29742120.3206; train_optim_loss: 29742120.3206; val_kl_reg_loss: 91234.3656; val_edge_recon_loss: 2705370.5667; val_gene_expr_recon_loss: 13703715.0000; val_masked_gp_l1_reg_loss: 77614.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89439.8125; val_chrom_access_recon_loss: 12905988.1333; val_global_loss: 29573362.1333; val_optim_loss: 29573362.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9802; val_auprc_score: 0.9747; val_best_acc_score: 0.9336; val_best_f1_score: 0.9360; train_kl_reg_loss: 91536.3676; train_edge_recon_loss: 2689291.0496; train_gene_expr_recon_loss: 13733546.0305; train_masked_gp_l1_reg_loss: 77422.2840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88981.2684; train_chrom_access_recon_loss: 13045944.4198; train_global_loss: 29726721.3740; train_optim_loss: 29726721.3740; val_kl_reg_loss: 92209.5172; val_edge_recon_loss: 2705536.6167; val_gene_expr_recon_loss: 13731432.6000; val_masked_gp_l1_reg_loss: 77299.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88511.6641; val_chrom_access_recon_loss: 12930420.6000; val_global_loss: 29625410.6667; val_optim_loss: 29625410.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9767; val_auprc_score: 0.9706; val_best_acc_score: 0.9326; val_best_f1_score: 0.9353; train_kl_reg_loss: 91934.8199; train_edge_recon_loss: 2689010.9008; train_gene_expr_recon_loss: 13727300.5267; train_masked_gp_l1_reg_loss: 77233.3399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88151.9392; train_chrom_access_recon_loss: 13034559.7557; train_global_loss: 29708191.0687; train_optim_loss: 29708191.0687; val_kl_reg_loss: 92158.3568; val_edge_recon_loss: 2703238.9000; val_gene_expr_recon_loss: 13715774.0667; val_masked_gp_l1_reg_loss: 77186.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88087.4922; val_chrom_access_recon_loss: 12918158.7333; val_global_loss: 29594604.1333; val_optim_loss: 29594604.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9815; val_auprc_score: 0.9766; val_best_acc_score: 0.9375; val_best_f1_score: 0.9391; train_kl_reg_loss: 91815.4151; train_edge_recon_loss: 2695106.7328; train_gene_expr_recon_loss: 13752877.6641; train_masked_gp_l1_reg_loss: 77163.8241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87698.2802; train_chrom_access_recon_loss: 13048241.0229; train_global_loss: 29752903.1603; train_optim_loss: 29752903.1603; val_kl_reg_loss: 93998.2797; val_edge_recon_loss: 2697962.4333; val_gene_expr_recon_loss: 13740507.3333; val_masked_gp_l1_reg_loss: 77157.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87655.0469; val_chrom_access_recon_loss: 12910461.2000; val_global_loss: 29607742.0000; val_optim_loss: 29607742.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9830; val_auprc_score: 0.9792; val_best_acc_score: 0.9417; val_best_f1_score: 0.9429; train_kl_reg_loss: 94950.9826; train_edge_recon_loss: 2692467.4847; train_gene_expr_recon_loss: 13721870.3130; train_masked_gp_l1_reg_loss: 77127.4609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86748.5828; train_chrom_access_recon_loss: 13028447.7557; train_global_loss: 29701612.5191; train_optim_loss: 29701612.5191; val_kl_reg_loss: 93838.8948; val_edge_recon_loss: 2694484.5333; val_gene_expr_recon_loss: 13706407.4000; val_masked_gp_l1_reg_loss: 77078.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86368.9453; val_chrom_access_recon_loss: 12886868.0000; val_global_loss: 29545045.6000; val_optim_loss: 29545045.6000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9815; val_auprc_score: 0.9756; val_best_acc_score: 0.9371; val_best_f1_score: 0.9381; train_kl_reg_loss: 93572.2220; train_edge_recon_loss: 2691475.1031; train_gene_expr_recon_loss: 13731221.1221; train_masked_gp_l1_reg_loss: 77103.7233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86332.9037; train_chrom_access_recon_loss: 13035371.9847; train_global_loss: 29715077.0534; train_optim_loss: 29715077.0534; val_kl_reg_loss: 93469.3016; val_edge_recon_loss: 2692077.5500; val_gene_expr_recon_loss: 13670065.3333; val_masked_gp_l1_reg_loss: 77081.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86167.6328; val_chrom_access_recon_loss: 12851309.6667; val_global_loss: 29470171.2000; val_optim_loss: 29470171.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9826; val_auprc_score: 0.9788; val_best_acc_score: 0.9406; val_best_f1_score: 0.9415; train_kl_reg_loss: 93255.0809; train_edge_recon_loss: 2690309.0134; train_gene_expr_recon_loss: 13723227.6718; train_masked_gp_l1_reg_loss: 77108.5296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86175.1360; train_chrom_access_recon_loss: 13032000.1145; train_global_loss: 29702075.5420; train_optim_loss: 29702075.5420; val_kl_reg_loss: 92897.6219; val_edge_recon_loss: 2698032.1167; val_gene_expr_recon_loss: 13708332.4667; val_masked_gp_l1_reg_loss: 77115.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86062.3203; val_chrom_access_recon_loss: 12855559.9333; val_global_loss: 29517999.7333; val_optim_loss: 29517999.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9812; val_auprc_score: 0.9764; val_best_acc_score: 0.9404; val_best_f1_score: 0.9414; train_kl_reg_loss: 92999.7954; train_edge_recon_loss: 2694105.1641; train_gene_expr_recon_loss: 13723729.3969; train_masked_gp_l1_reg_loss: 77130.2675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86018.5768; train_chrom_access_recon_loss: 13029729.1221; train_global_loss: 29703712.2137; train_optim_loss: 29703712.2137; val_kl_reg_loss: 93352.7083; val_edge_recon_loss: 2704593.7000; val_gene_expr_recon_loss: 13696281.4000; val_masked_gp_l1_reg_loss: 77142.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85968.1875; val_chrom_access_recon_loss: 12830710.6667; val_global_loss: 29488049.0667; val_optim_loss: 29488049.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9820; val_auprc_score: 0.9784; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 92894.5850; train_edge_recon_loss: 2693327.9160; train_gene_expr_recon_loss: 13724125.5573; train_masked_gp_l1_reg_loss: 77158.5683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85859.7806; train_chrom_access_recon_loss: 13023218.3282; train_global_loss: 29696584.6870; train_optim_loss: 29696584.6870; val_kl_reg_loss: 93629.8578; val_edge_recon_loss: 2696241.7500; val_gene_expr_recon_loss: 13693610.3333; val_masked_gp_l1_reg_loss: 77166.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85727.2891; val_chrom_access_recon_loss: 12879757.6000; val_global_loss: 29526133.7333; val_optim_loss: 29526133.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9825; val_auprc_score: 0.9765; val_best_acc_score: 0.9392; val_best_f1_score: 0.9408; train_kl_reg_loss: 93015.6001; train_edge_recon_loss: 2689901.9408; train_gene_expr_recon_loss: 13719743.2290; train_masked_gp_l1_reg_loss: 77189.4781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85705.3808; train_chrom_access_recon_loss: 13022461.1527; train_global_loss: 29688016.7481; train_optim_loss: 29688016.7481; val_kl_reg_loss: 93141.0802; val_edge_recon_loss: 2691286.1167; val_gene_expr_recon_loss: 13661068.0667; val_masked_gp_l1_reg_loss: 77179.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85589.6797; val_chrom_access_recon_loss: 12814984.6667; val_global_loss: 29423249.7333; val_optim_loss: 29423249.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9813; val_auprc_score: 0.9764; val_best_acc_score: 0.9395; val_best_f1_score: 0.9406; train_kl_reg_loss: 93224.4347; train_edge_recon_loss: 2689505.7462; train_gene_expr_recon_loss: 13710729.9618; train_masked_gp_l1_reg_loss: 77223.0976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85516.9376; train_chrom_access_recon_loss: 13014349.6947; train_global_loss: 29670549.7405; train_optim_loss: 29670549.7405; val_kl_reg_loss: 93280.4781; val_edge_recon_loss: 2696761.3000; val_gene_expr_recon_loss: 13752656.3333; val_masked_gp_l1_reg_loss: 77224.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85461.1016; val_chrom_access_recon_loss: 12912504.2000; val_global_loss: 29617888.9333; val_optim_loss: 29617888.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9802; val_auprc_score: 0.9758; val_best_acc_score: 0.9390; val_best_f1_score: 0.9407; train_kl_reg_loss: 93078.6595; train_edge_recon_loss: 2687936.8244; train_gene_expr_recon_loss: 13709879.8244; train_masked_gp_l1_reg_loss: 77252.7476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85530.9309; train_chrom_access_recon_loss: 13012075.4656; train_global_loss: 29665754.4122; train_optim_loss: 29665754.4122; val_kl_reg_loss: 93484.9255; val_edge_recon_loss: 2699516.9000; val_gene_expr_recon_loss: 13691302.2000; val_masked_gp_l1_reg_loss: 77286.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85356.1641; val_chrom_access_recon_loss: 12898881.7333; val_global_loss: 29545828.6667; val_optim_loss: 29545828.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9793; val_auprc_score: 0.9725; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 93019.9476; train_edge_recon_loss: 2692903.0191; train_gene_expr_recon_loss: 13711535.4733; train_masked_gp_l1_reg_loss: 77278.8492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85231.1553; train_chrom_access_recon_loss: 13020459.4504; train_global_loss: 29680427.7863; train_optim_loss: 29680427.7863; val_kl_reg_loss: 93247.4745; val_edge_recon_loss: 2714416.4333; val_gene_expr_recon_loss: 13654989.2667; val_masked_gp_l1_reg_loss: 77290.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85253.8828; val_chrom_access_recon_loss: 12888070.0000; val_global_loss: 29513266.8000; val_optim_loss: 29513266.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9814; val_auprc_score: 0.9763; val_best_acc_score: 0.9380; val_best_f1_score: 0.9392; train_kl_reg_loss: 92808.9693; train_edge_recon_loss: 2688509.0439; train_gene_expr_recon_loss: 13711547.7710; train_masked_gp_l1_reg_loss: 77316.9513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85226.2344; train_chrom_access_recon_loss: 13007974.4962; train_global_loss: 29663383.3282; train_optim_loss: 29663383.3282; val_kl_reg_loss: 92915.8844; val_edge_recon_loss: 2702036.8167; val_gene_expr_recon_loss: 13674821.6667; val_masked_gp_l1_reg_loss: 77329.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85153.2578; val_chrom_access_recon_loss: 12883515.8000; val_global_loss: 29515772.6667; val_optim_loss: 29515772.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9835; val_auprc_score: 0.9795; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 93008.7425; train_edge_recon_loss: 2687594.3378; train_gene_expr_recon_loss: 13710028.1145; train_masked_gp_l1_reg_loss: 77136.5906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81243.0696; train_chrom_access_recon_loss: 13005924.3893; train_global_loss: 29654935.1298; train_optim_loss: 29654935.1298; val_kl_reg_loss: 93198.2302; val_edge_recon_loss: 2692120.1667; val_gene_expr_recon_loss: 13690099.2000; val_masked_gp_l1_reg_loss: 77025.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80820.3438; val_chrom_access_recon_loss: 12854240.4000; val_global_loss: 29487502.9333; val_optim_loss: 29487502.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9829; val_auprc_score: 0.9784; val_best_acc_score: 0.9418; val_best_f1_score: 0.9432; train_kl_reg_loss: 92964.6532; train_edge_recon_loss: 2690819.4847; train_gene_expr_recon_loss: 13700374.7481; train_masked_gp_l1_reg_loss: 76988.0258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80769.1842; train_chrom_access_recon_loss: 12992443.7634; train_global_loss: 29634359.8779; train_optim_loss: 29634359.8779; val_kl_reg_loss: 93332.8047; val_edge_recon_loss: 2690926.5333; val_gene_expr_recon_loss: 13700728.8000; val_masked_gp_l1_reg_loss: 76954.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80706.2188; val_chrom_access_recon_loss: 12880232.4667; val_global_loss: 29522880.6667; val_optim_loss: 29522880.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9803; val_auprc_score: 0.9752; val_best_acc_score: 0.9404; val_best_f1_score: 0.9420; train_kl_reg_loss: 93085.2118; train_edge_recon_loss: 2693363.3149; train_gene_expr_recon_loss: 13704605.3282; train_masked_gp_l1_reg_loss: 76942.2590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80680.0185; train_chrom_access_recon_loss: 13000841.3969; train_global_loss: 29649517.4046; train_optim_loss: 29649517.4046; val_kl_reg_loss: 93267.0250; val_edge_recon_loss: 2689321.6833; val_gene_expr_recon_loss: 13683475.5333; val_masked_gp_l1_reg_loss: 76925.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80645.1094; val_chrom_access_recon_loss: 12839555.2667; val_global_loss: 29463190.6667; val_optim_loss: 29463190.6667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9828; val_auprc_score: 0.9785; val_best_acc_score: 0.9414; val_best_f1_score: 0.9422; train_kl_reg_loss: 92948.0422; train_edge_recon_loss: 2685779.0534; train_gene_expr_recon_loss: 13702840.9618; train_masked_gp_l1_reg_loss: 76920.5731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80620.6029; train_chrom_access_recon_loss: 12992268.3817; train_global_loss: 29631377.4962; train_optim_loss: 29631377.4962; val_kl_reg_loss: 93513.9599; val_edge_recon_loss: 2702238.5333; val_gene_expr_recon_loss: 13728646.4667; val_masked_gp_l1_reg_loss: 76912.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80600.2422; val_chrom_access_recon_loss: 12893241.4000; val_global_loss: 29575152.5333; val_optim_loss: 29575152.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 87 min 7 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9786
val AUPRC score: 0.9720
val best accuracy score: 0.9351
val best F1 score: 0.9371
val target rna MSE score: 0.8083
val source rna MSE score: 0.1743
val target atac MSE score: 0.3304
val source atac MSE score: 0.0514
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
