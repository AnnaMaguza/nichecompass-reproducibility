[True]
Run timestamp: 10082023_182719_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7358; val_auprc_score: 0.7674; val_best_acc_score: 0.5073; val_best_f1_score: 0.6689; train_kl_reg_loss: 90221.7061; train_edge_recon_loss: 3724230.9981; train_gene_expr_recon_loss: 27468834.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5547112.2481; train_global_loss: 36830399.9084; train_optim_loss: 36830399.9084; val_kl_reg_loss: 145630.6604; val_edge_recon_loss: 4065123.6667; val_gene_expr_recon_loss: 23450404.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5249454.3667; val_global_loss: 32910612.8000; val_optim_loss: 32910612.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7756; val_auprc_score: 0.8006; val_best_acc_score: 0.5838; val_best_f1_score: 0.6965; train_kl_reg_loss: 160856.2909; train_edge_recon_loss: 3622459.8225; train_gene_expr_recon_loss: 22778862.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5163300.4885; train_global_loss: 31725479.3588; train_optim_loss: 31725479.3588; val_kl_reg_loss: 164043.8729; val_edge_recon_loss: 4060059.1000; val_gene_expr_recon_loss: 22518030.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5185573.7000; val_global_loss: 31927707.0667; val_optim_loss: 31927707.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8683; val_auprc_score: 0.8690; val_best_acc_score: 0.7657; val_best_f1_score: 0.7435; train_kl_reg_loss: 152623.6933; train_edge_recon_loss: 3547926.9485; train_gene_expr_recon_loss: 22188109.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5102897.1527; train_global_loss: 30991557.5420; train_optim_loss: 30991557.5420; val_kl_reg_loss: 143119.6615; val_edge_recon_loss: 4012462.7833; val_gene_expr_recon_loss: 22164274.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5144730.1000; val_global_loss: 31464586.6667; val_optim_loss: 31464586.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8773; val_auprc_score: 0.8707; val_best_acc_score: 0.7870; val_best_f1_score: 0.7982; train_kl_reg_loss: 127579.4033; train_edge_recon_loss: 3381391.8492; train_gene_expr_recon_loss: 21975647.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5078639.3817; train_global_loss: 30563257.9695; train_optim_loss: 30563257.9695; val_kl_reg_loss: 160102.4729; val_edge_recon_loss: 3065177.7000; val_gene_expr_recon_loss: 21927743.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5107003.0333; val_global_loss: 30260027.0667; val_optim_loss: 30260027.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8900; val_auprc_score: 0.8768; val_best_acc_score: 0.8025; val_best_f1_score: 0.8196; train_kl_reg_loss: 159376.2162; train_edge_recon_loss: 3014768.7309; train_gene_expr_recon_loss: 21821221.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5052234.1183; train_global_loss: 30047600.3359; train_optim_loss: 30047600.3359; val_kl_reg_loss: 152992.4750; val_edge_recon_loss: 2980697.8833; val_gene_expr_recon_loss: 21873927.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5103369.9667; val_global_loss: 30110988.1333; val_optim_loss: 30110988.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9035; val_auprc_score: 0.8888; val_best_acc_score: 0.8248; val_best_f1_score: 0.8353; train_kl_reg_loss: 151175.7499; train_edge_recon_loss: 2954755.5897; train_gene_expr_recon_loss: 21676928.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5027006.7824; train_global_loss: 29809866.5649; train_optim_loss: 29809866.5649; val_kl_reg_loss: 145681.2135; val_edge_recon_loss: 2933689.9667; val_gene_expr_recon_loss: 21728924.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5053154.2667; val_global_loss: 29861450.0000; val_optim_loss: 29861450.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9192; val_auprc_score: 0.9050; val_best_acc_score: 0.8475; val_best_f1_score: 0.8565; train_kl_reg_loss: 143758.9748; train_edge_recon_loss: 2909707.6279; train_gene_expr_recon_loss: 21586214.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5013633.3053; train_global_loss: 29653314.7176; train_optim_loss: 29653314.7176; val_kl_reg_loss: 129426.0755; val_edge_recon_loss: 2889757.4667; val_gene_expr_recon_loss: 21667457.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5060036.8000; val_global_loss: 29746677.3333; val_optim_loss: 29746677.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9207; val_auprc_score: 0.9080; val_best_acc_score: 0.8487; val_best_f1_score: 0.8600; train_kl_reg_loss: 138010.4427; train_edge_recon_loss: 2874767.7653; train_gene_expr_recon_loss: 21469122.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4989995.6412; train_global_loss: 29471896.1679; train_optim_loss: 29471896.1679; val_kl_reg_loss: 128097.3932; val_edge_recon_loss: 2889753.7500; val_gene_expr_recon_loss: 21560443.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5030798.4333; val_global_loss: 29609092.6667; val_optim_loss: 29609092.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9332; val_auprc_score: 0.9209; val_best_acc_score: 0.8631; val_best_f1_score: 0.8705; train_kl_reg_loss: 134215.8000; train_edge_recon_loss: 2865985.0782; train_gene_expr_recon_loss: 21389065.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4972310.7863; train_global_loss: 29361577.7405; train_optim_loss: 29361577.7405; val_kl_reg_loss: 131939.7036; val_edge_recon_loss: 2877273.9333; val_gene_expr_recon_loss: 21382630.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4995423.8667; val_global_loss: 29387268.0000; val_optim_loss: 29387268.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9407; val_auprc_score: 0.9281; val_best_acc_score: 0.8728; val_best_f1_score: 0.8802; train_kl_reg_loss: 134345.5729; train_edge_recon_loss: 2833833.0267; train_gene_expr_recon_loss: 21265580.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4954355.7290; train_global_loss: 29188114.7328; train_optim_loss: 29188114.7328; val_kl_reg_loss: 134066.2083; val_edge_recon_loss: 2812600.4833; val_gene_expr_recon_loss: 21342473.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4994216.9333; val_global_loss: 29283357.2000; val_optim_loss: 29283357.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9373; val_auprc_score: 0.9236; val_best_acc_score: 0.8680; val_best_f1_score: 0.8762; train_kl_reg_loss: 129453.8021; train_edge_recon_loss: 2810097.8874; train_gene_expr_recon_loss: 21168598.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4935841.1718; train_global_loss: 29043991.7557; train_optim_loss: 29043991.7557; val_kl_reg_loss: 124562.0016; val_edge_recon_loss: 2853856.2833; val_gene_expr_recon_loss: 21310833.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4999350.5000; val_global_loss: 29288602.0000; val_optim_loss: 29288602.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9508; val_auprc_score: 0.9418; val_best_acc_score: 0.8852; val_best_f1_score: 0.8913; train_kl_reg_loss: 124895.5757; train_edge_recon_loss: 2797052.7920; train_gene_expr_recon_loss: 21103568.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4921998.4847; train_global_loss: 28947515.5725; train_optim_loss: 28947515.5725; val_kl_reg_loss: 120151.9505; val_edge_recon_loss: 2829411.1000; val_gene_expr_recon_loss: 21113422.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4954268.1000; val_global_loss: 29017254.1333; val_optim_loss: 29017254.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9498; val_auprc_score: 0.9328; val_best_acc_score: 0.8878; val_best_f1_score: 0.8942; train_kl_reg_loss: 120113.7968; train_edge_recon_loss: 2788455.6718; train_gene_expr_recon_loss: 21034543.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4909700.2137; train_global_loss: 28852813.3588; train_optim_loss: 28852813.3588; val_kl_reg_loss: 117106.0328; val_edge_recon_loss: 2793004.3500; val_gene_expr_recon_loss: 21139908.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4955965.1333; val_global_loss: 29005984.0000; val_optim_loss: 29005984.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9514; val_auprc_score: 0.9365; val_best_acc_score: 0.8914; val_best_f1_score: 0.8967; train_kl_reg_loss: 116849.2375; train_edge_recon_loss: 2777197.2958; train_gene_expr_recon_loss: 21011459.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4909070.4389; train_global_loss: 28814576.6870; train_optim_loss: 28814576.6870; val_kl_reg_loss: 115592.7656; val_edge_recon_loss: 2758849.9833; val_gene_expr_recon_loss: 21174806.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4976355.0000; val_global_loss: 29025604.1333; val_optim_loss: 29025604.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9536; val_auprc_score: 0.9387; val_best_acc_score: 0.8954; val_best_f1_score: 0.9008; train_kl_reg_loss: 114953.0248; train_edge_recon_loss: 2771228.0191; train_gene_expr_recon_loss: 20958008.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4897613.4733; train_global_loss: 28741802.7481; train_optim_loss: 28741802.7481; val_kl_reg_loss: 111122.6625; val_edge_recon_loss: 2781560.7667; val_gene_expr_recon_loss: 21084382.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4941745.6333; val_global_loss: 28918811.6000; val_optim_loss: 28918811.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9555; val_auprc_score: 0.9466; val_best_acc_score: 0.8950; val_best_f1_score: 0.8995; train_kl_reg_loss: 111678.5993; train_edge_recon_loss: 2757366.8244; train_gene_expr_recon_loss: 20909684.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4890388.8855; train_global_loss: 28669118.7786; train_optim_loss: 28669118.7786; val_kl_reg_loss: 108352.5667; val_edge_recon_loss: 2791099.5667; val_gene_expr_recon_loss: 21070040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4953810.7000; val_global_loss: 28923303.0667; val_optim_loss: 28923303.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9606; val_auprc_score: 0.9496; val_best_acc_score: 0.9015; val_best_f1_score: 0.9053; train_kl_reg_loss: 108557.4539; train_edge_recon_loss: 2755203.1794; train_gene_expr_recon_loss: 20892543.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4891661.4656; train_global_loss: 28647965.9847; train_optim_loss: 28647965.9847; val_kl_reg_loss: 106751.0401; val_edge_recon_loss: 2753603.6167; val_gene_expr_recon_loss: 20971933.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4919703.4333; val_global_loss: 28751991.6000; val_optim_loss: 28751991.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9630; val_auprc_score: 0.9538; val_best_acc_score: 0.9037; val_best_f1_score: 0.9072; train_kl_reg_loss: 106165.4705; train_edge_recon_loss: 2748781.0954; train_gene_expr_recon_loss: 20824394.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4878182.8969; train_global_loss: 28557523.3740; train_optim_loss: 28557523.3740; val_kl_reg_loss: 105496.7818; val_edge_recon_loss: 2731405.5500; val_gene_expr_recon_loss: 20919370.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4916949.9667; val_global_loss: 28673222.4000; val_optim_loss: 28673222.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9640; val_auprc_score: 0.9569; val_best_acc_score: 0.9047; val_best_f1_score: 0.9091; train_kl_reg_loss: 102662.0578; train_edge_recon_loss: 2751269.1469; train_gene_expr_recon_loss: 20805664.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4874305.9656; train_global_loss: 28533901.3435; train_optim_loss: 28533901.3435; val_kl_reg_loss: 101940.3047; val_edge_recon_loss: 2735376.2500; val_gene_expr_recon_loss: 20904298.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4913209.5000; val_global_loss: 28654825.0667; val_optim_loss: 28654825.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9625; val_auprc_score: 0.9524; val_best_acc_score: 0.9070; val_best_f1_score: 0.9104; train_kl_reg_loss: 102727.8788; train_edge_recon_loss: 2736109.3302; train_gene_expr_recon_loss: 20736592.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4864100.6641; train_global_loss: 28439530.4275; train_optim_loss: 28439530.4275; val_kl_reg_loss: 100327.0443; val_edge_recon_loss: 2743003.5000; val_gene_expr_recon_loss: 20936102.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4935506.7667; val_global_loss: 28714939.7333; val_optim_loss: 28714939.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9667; val_auprc_score: 0.9593; val_best_acc_score: 0.9099; val_best_f1_score: 0.9129; train_kl_reg_loss: 99445.2685; train_edge_recon_loss: 2734212.3760; train_gene_expr_recon_loss: 20729461.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4862794.4046; train_global_loss: 28425913.3893; train_optim_loss: 28425913.3893; val_kl_reg_loss: 97908.4224; val_edge_recon_loss: 2734986.9500; val_gene_expr_recon_loss: 20827182.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4897892.5667; val_global_loss: 28557970.1333; val_optim_loss: 28557970.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9657; val_auprc_score: 0.9558; val_best_acc_score: 0.9101; val_best_f1_score: 0.9140; train_kl_reg_loss: 97396.1982; train_edge_recon_loss: 2727570.3779; train_gene_expr_recon_loss: 20697974.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4857827.6679; train_global_loss: 28380768.9160; train_optim_loss: 28380768.9160; val_kl_reg_loss: 96910.9438; val_edge_recon_loss: 2740477.2000; val_gene_expr_recon_loss: 20805824.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4905403.9667; val_global_loss: 28548616.0000; val_optim_loss: 28548616.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9672; val_auprc_score: 0.9604; val_best_acc_score: 0.9111; val_best_f1_score: 0.9149; train_kl_reg_loss: 95186.4299; train_edge_recon_loss: 2725359.0935; train_gene_expr_recon_loss: 20667883.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4855865.6565; train_global_loss: 28344294.5802; train_optim_loss: 28344294.5802; val_kl_reg_loss: 99824.7120; val_edge_recon_loss: 2735020.6667; val_gene_expr_recon_loss: 20818042.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4911436.6333; val_global_loss: 28564325.0667; val_optim_loss: 28564325.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9684; val_auprc_score: 0.9599; val_best_acc_score: 0.9144; val_best_f1_score: 0.9176; train_kl_reg_loss: 93219.5691; train_edge_recon_loss: 2716961.2347; train_gene_expr_recon_loss: 20626290.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4848608.1679; train_global_loss: 28285079.4962; train_optim_loss: 28285079.4962; val_kl_reg_loss: 94657.7891; val_edge_recon_loss: 2743520.0333; val_gene_expr_recon_loss: 20760020.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4919998.6667; val_global_loss: 28518196.4000; val_optim_loss: 28518196.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9702; val_auprc_score: 0.9616; val_best_acc_score: 0.9174; val_best_f1_score: 0.9202; train_kl_reg_loss: 91907.7573; train_edge_recon_loss: 2718111.6756; train_gene_expr_recon_loss: 20607586.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4851495.4504; train_global_loss: 28269101.8931; train_optim_loss: 28269101.8931; val_kl_reg_loss: 90954.8474; val_edge_recon_loss: 2714686.6500; val_gene_expr_recon_loss: 20810217.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4911128.4667; val_global_loss: 28526987.2000; val_optim_loss: 28526987.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9696; val_auprc_score: 0.9620; val_best_acc_score: 0.9139; val_best_f1_score: 0.9156; train_kl_reg_loss: 97772.4129; train_edge_recon_loss: 2749517.0477; train_gene_expr_recon_loss: 21356901.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4922221.4771; train_global_loss: 29126412.3206; train_optim_loss: 29126412.3206; val_kl_reg_loss: 52929.7974; val_edge_recon_loss: 2756677.2667; val_gene_expr_recon_loss: 21314117.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4935613.5333; val_global_loss: 29059338.6667; val_optim_loss: 29059338.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9734; val_auprc_score: 0.9688; val_best_acc_score: 0.9202; val_best_f1_score: 0.9230; train_kl_reg_loss: 94613.5789; train_edge_recon_loss: 2727670.6298; train_gene_expr_recon_loss: 21258189.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4906621.5878; train_global_loss: 28987095.2366; train_optim_loss: 28987095.2366; val_kl_reg_loss: 56792.9411; val_edge_recon_loss: 2724860.8833; val_gene_expr_recon_loss: 21433976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4966405.0000; val_global_loss: 29182034.9333; val_optim_loss: 29182034.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9708; val_auprc_score: 0.9623; val_best_acc_score: 0.9200; val_best_f1_score: 0.9227; train_kl_reg_loss: 87432.6929; train_edge_recon_loss: 2716438.4122; train_gene_expr_recon_loss: 21240545.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4908012.5763; train_global_loss: 28952429.6183; train_optim_loss: 28952429.6183; val_kl_reg_loss: 55785.5565; val_edge_recon_loss: 2734817.7333; val_gene_expr_recon_loss: 21276154.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4931237.2333; val_global_loss: 28997995.0667; val_optim_loss: 28997995.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9722; val_auprc_score: 0.9636; val_best_acc_score: 0.9214; val_best_f1_score: 0.9239; train_kl_reg_loss: 84853.4400; train_edge_recon_loss: 2715358.0935; train_gene_expr_recon_loss: 21209582.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4907513.6450; train_global_loss: 28917308.0153; train_optim_loss: 28917308.0153; val_kl_reg_loss: 56045.6208; val_edge_recon_loss: 2732248.8333; val_gene_expr_recon_loss: 21311742.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4944547.8000; val_global_loss: 29044584.9333; val_optim_loss: 29044584.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9702; val_auprc_score: 0.9605; val_best_acc_score: 0.9223; val_best_f1_score: 0.9245; train_kl_reg_loss: 84948.2839; train_edge_recon_loss: 2714121.8989; train_gene_expr_recon_loss: 21183945.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4899025.4122; train_global_loss: 28882040.7786; train_optim_loss: 28882040.7786; val_kl_reg_loss: 56230.0172; val_edge_recon_loss: 2712925.6000; val_gene_expr_recon_loss: 21317042.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4941719.6333; val_global_loss: 29027917.4667; val_optim_loss: 29027917.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9730; val_auprc_score: 0.9658; val_best_acc_score: 0.9227; val_best_f1_score: 0.9250; train_kl_reg_loss: 84392.3445; train_edge_recon_loss: 2714057.7863; train_gene_expr_recon_loss: 21165346.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4895714.7595; train_global_loss: 28859510.9160; train_optim_loss: 28859510.9160; val_kl_reg_loss: 57450.6826; val_edge_recon_loss: 2715893.0167; val_gene_expr_recon_loss: 21284409.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4943942.4333; val_global_loss: 29001695.7333; val_optim_loss: 29001695.7333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9738; val_auprc_score: 0.9678; val_best_acc_score: 0.9216; val_best_f1_score: 0.9237; train_kl_reg_loss: 84463.9807; train_edge_recon_loss: 2708097.8282; train_gene_expr_recon_loss: 21145237.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4890783.6031; train_global_loss: 28828583.4351; train_optim_loss: 28828583.4351; val_kl_reg_loss: 57683.6370; val_edge_recon_loss: 2711119.6500; val_gene_expr_recon_loss: 21261790.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4943538.8000; val_global_loss: 28974133.0667; val_optim_loss: 28974133.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 56 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9700
val AUPRC score: 0.9630
val best accuracy score: 0.9189
val best F1 score: 0.9211
val target rna MSE score: 1.1835
val source rna MSE score: 14.9192
val target atac MSE score: 0.3570
val source atac MSE score: 3.0191
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
