[True, True]
Run timestamp: 17082023_083302_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'patient', 'batch', '--cat_covariates_no_edges', 'True', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '4', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 6, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 6, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 3524470
Number of validation edges: 391607
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9939; val_best_acc_score: 0.9459; val_best_f1_score: 0.9649; train_kl_reg_loss: 14077.4958; train_edge_recon_loss: 1269201.9369; train_gene_expr_recon_loss: 2059793.6775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343073.1092; train_optim_loss: 3343073.1092; val_kl_reg_loss: 9368.8095; val_edge_recon_loss: 1250343.4723; val_gene_expr_recon_loss: 1902087.9155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3161800.1971; val_optim_loss: 3161800.1971
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9851; val_auprc_score: 0.9949; val_best_acc_score: 0.9538; val_best_f1_score: 0.9701; train_kl_reg_loss: 9471.1974; train_edge_recon_loss: 1228100.1196; train_gene_expr_recon_loss: 1866014.6527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3103585.9648; train_optim_loss: 3103585.9648; val_kl_reg_loss: 9362.7610; val_edge_recon_loss: 1242435.6554; val_gene_expr_recon_loss: 1844190.7921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3095989.2128; val_optim_loss: 3095989.2128
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9867; val_auprc_score: 0.9955; val_best_acc_score: 0.9558; val_best_f1_score: 0.9713; train_kl_reg_loss: 9691.6036; train_edge_recon_loss: 1226586.5764; train_gene_expr_recon_loss: 1834875.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3071153.4673; train_optim_loss: 3071153.4673; val_kl_reg_loss: 9656.6576; val_edge_recon_loss: 1243654.8695; val_gene_expr_recon_loss: 1826886.2255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3080197.7493; val_optim_loss: 3080197.7493
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9873; val_auprc_score: 0.9957; val_best_acc_score: 0.9573; val_best_f1_score: 0.9723; train_kl_reg_loss: 9926.1165; train_edge_recon_loss: 1225056.8142; train_gene_expr_recon_loss: 1823462.5775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3058445.5049; train_optim_loss: 3058445.5049; val_kl_reg_loss: 9836.0059; val_edge_recon_loss: 1240840.6593; val_gene_expr_recon_loss: 1821438.0085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3072114.6730; val_optim_loss: 3072114.6730
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9875; val_auprc_score: 0.9958; val_best_acc_score: 0.9574; val_best_f1_score: 0.9724; train_kl_reg_loss: 10094.4564; train_edge_recon_loss: 1223853.5191; train_gene_expr_recon_loss: 1817844.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3051792.2909; train_optim_loss: 3051792.2909; val_kl_reg_loss: 10052.8275; val_edge_recon_loss: 1237702.3322; val_gene_expr_recon_loss: 1816692.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3064447.2435; val_optim_loss: 3064447.2435
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9957; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 10253.4462; train_edge_recon_loss: 1222628.6852; train_gene_expr_recon_loss: 1814767.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3047649.7788; train_optim_loss: 3047649.7788; val_kl_reg_loss: 10178.0648; val_edge_recon_loss: 1244198.5196; val_gene_expr_recon_loss: 1816165.6074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3070542.1880; val_optim_loss: 3070542.1880
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9887; val_auprc_score: 0.9962; val_best_acc_score: 0.9597; val_best_f1_score: 0.9739; train_kl_reg_loss: 10337.2548; train_edge_recon_loss: 1223126.7860; train_gene_expr_recon_loss: 1812824.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3046288.4042; train_optim_loss: 3046288.4042; val_kl_reg_loss: 10331.5347; val_edge_recon_loss: 1238387.3992; val_gene_expr_recon_loss: 1813950.1090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3062669.0444; val_optim_loss: 3062669.0444
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9892; val_auprc_score: 0.9963; val_best_acc_score: 0.9608; val_best_f1_score: 0.9746; train_kl_reg_loss: 10420.8814; train_edge_recon_loss: 1221050.8899; train_gene_expr_recon_loss: 1811314.9898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3042786.7646; train_optim_loss: 3042786.7646; val_kl_reg_loss: 10249.7088; val_edge_recon_loss: 1239280.2422; val_gene_expr_recon_loss: 1811857.5614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3061387.5144; val_optim_loss: 3061387.5144
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9964; val_best_acc_score: 0.9612; val_best_f1_score: 0.9749; train_kl_reg_loss: 10472.8630; train_edge_recon_loss: 1222442.6243; train_gene_expr_recon_loss: 1809890.5374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3042806.0248; train_optim_loss: 3042806.0248; val_kl_reg_loss: 10097.7214; val_edge_recon_loss: 1237278.0754; val_gene_expr_recon_loss: 1811250.2252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3058626.0189; val_optim_loss: 3058626.0189
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9890; val_auprc_score: 0.9962; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 10518.3710; train_edge_recon_loss: 1221140.1490; train_gene_expr_recon_loss: 1808879.0452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3040537.5666; train_optim_loss: 3040537.5666; val_kl_reg_loss: 10439.8220; val_edge_recon_loss: 1244582.4311; val_gene_expr_recon_loss: 1809938.9732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3064961.2285; val_optim_loss: 3064961.2285
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9898; val_auprc_score: 0.9965; val_best_acc_score: 0.9626; val_best_f1_score: 0.9757; train_kl_reg_loss: 10569.2100; train_edge_recon_loss: 1221572.4075; train_gene_expr_recon_loss: 1807904.2799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3040045.8977; train_optim_loss: 3040045.8977; val_kl_reg_loss: 10249.4769; val_edge_recon_loss: 1237437.5398; val_gene_expr_recon_loss: 1810227.0986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3057914.1142; val_optim_loss: 3057914.1142
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9894; val_auprc_score: 0.9964; val_best_acc_score: 0.9620; val_best_f1_score: 0.9754; train_kl_reg_loss: 10568.7992; train_edge_recon_loss: 1221103.0414; train_gene_expr_recon_loss: 1807053.7742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3038725.6153; train_optim_loss: 3038725.6153; val_kl_reg_loss: 10539.2116; val_edge_recon_loss: 1233363.1955; val_gene_expr_recon_loss: 1809440.1903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3053342.6070; val_optim_loss: 3053342.6070
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9892; val_auprc_score: 0.9963; val_best_acc_score: 0.9611; val_best_f1_score: 0.9748; train_kl_reg_loss: 10594.8030; train_edge_recon_loss: 1221422.6156; train_gene_expr_recon_loss: 1806856.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3038873.4900; train_optim_loss: 3038873.4900; val_kl_reg_loss: 10448.4966; val_edge_recon_loss: 1240109.6472; val_gene_expr_recon_loss: 1808710.9873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3059269.1358; val_optim_loss: 3059269.1358
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9897; val_auprc_score: 0.9965; val_best_acc_score: 0.9626; val_best_f1_score: 0.9758; train_kl_reg_loss: 10617.5144; train_edge_recon_loss: 1221607.3229; train_gene_expr_recon_loss: 1806202.2484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3038427.0838; train_optim_loss: 3038427.0838; val_kl_reg_loss: 10502.5078; val_edge_recon_loss: 1235680.5529; val_gene_expr_recon_loss: 1809144.2245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3055327.2892; val_optim_loss: 3055327.2892
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9898; val_auprc_score: 0.9966; val_best_acc_score: 0.9626; val_best_f1_score: 0.9757; train_kl_reg_loss: 10659.1293; train_edge_recon_loss: 1220621.1085; train_gene_expr_recon_loss: 1805895.0010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3037175.2430; train_optim_loss: 3037175.2430; val_kl_reg_loss: 10530.7606; val_edge_recon_loss: 1235793.8743; val_gene_expr_recon_loss: 1808435.1505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3054759.7813; val_optim_loss: 3054759.7813
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9900; val_auprc_score: 0.9966; val_best_acc_score: 0.9643; val_best_f1_score: 0.9769; train_kl_reg_loss: 10656.0138; train_edge_recon_loss: 1218969.6232; train_gene_expr_recon_loss: 1805646.2567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3035271.8948; train_optim_loss: 3035271.8948; val_kl_reg_loss: 10454.2393; val_edge_recon_loss: 1235950.0264; val_gene_expr_recon_loss: 1807097.3280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3053501.5940; val_optim_loss: 3053501.5940

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9652; val_best_f1_score: 0.9774; train_kl_reg_loss: 10471.8672; train_edge_recon_loss: 1216935.2519; train_gene_expr_recon_loss: 1796759.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024166.2264; train_optim_loss: 3024166.2264; val_kl_reg_loss: 10344.0977; val_edge_recon_loss: 1231084.6191; val_gene_expr_recon_loss: 1797254.7569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3038683.4726; val_optim_loss: 3038683.4726
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9905; val_auprc_score: 0.9967; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10422.0149; train_edge_recon_loss: 1218454.5449; train_gene_expr_recon_loss: 1795901.1664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024777.7261; train_optim_loss: 3024777.7261; val_kl_reg_loss: 10302.0713; val_edge_recon_loss: 1238547.2748; val_gene_expr_recon_loss: 1798540.7435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3047390.0979; val_optim_loss: 3047390.0979
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9653; val_best_f1_score: 0.9775; train_kl_reg_loss: 10401.1068; train_edge_recon_loss: 1217857.5479; train_gene_expr_recon_loss: 1795738.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023996.7955; train_optim_loss: 3023996.7955; val_kl_reg_loss: 10216.5442; val_edge_recon_loss: 1233761.4719; val_gene_expr_recon_loss: 1797107.4530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3041085.4654; val_optim_loss: 3041085.4654
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 10358.8573; train_edge_recon_loss: 1218277.6134; train_gene_expr_recon_loss: 1795205.0672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023841.5377; train_optim_loss: 3023841.5377; val_kl_reg_loss: 10165.2354; val_edge_recon_loss: 1236280.7745; val_gene_expr_recon_loss: 1797767.7549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3044213.7670; val_optim_loss: 3044213.7670
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9909; val_auprc_score: 0.9969; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 10319.7463; train_edge_recon_loss: 1219097.8416; train_gene_expr_recon_loss: 1795105.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024523.4609; train_optim_loss: 3024523.4609; val_kl_reg_loss: 10165.2920; val_edge_recon_loss: 1235588.1932; val_gene_expr_recon_loss: 1797851.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043604.7311; val_optim_loss: 3043604.7311

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9908; val_auprc_score: 0.9968; val_best_acc_score: 0.9651; val_best_f1_score: 0.9774; train_kl_reg_loss: 10273.8236; train_edge_recon_loss: 1218048.3797; train_gene_expr_recon_loss: 1793750.6808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022072.8857; train_optim_loss: 3022072.8857; val_kl_reg_loss: 10156.4915; val_edge_recon_loss: 1232228.6606; val_gene_expr_recon_loss: 1798173.4935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3040558.6560; val_optim_loss: 3040558.6560
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9909; val_auprc_score: 0.9969; val_best_acc_score: 0.9654; val_best_f1_score: 0.9775; train_kl_reg_loss: 10269.5487; train_edge_recon_loss: 1218360.6128; train_gene_expr_recon_loss: 1793962.2632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022592.4248; train_optim_loss: 3022592.4248; val_kl_reg_loss: 10128.7799; val_edge_recon_loss: 1233309.8802; val_gene_expr_recon_loss: 1796206.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039645.2689; val_optim_loss: 3039645.2689
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9908; val_auprc_score: 0.9968; val_best_acc_score: 0.9651; val_best_f1_score: 0.9774; train_kl_reg_loss: 10257.0333; train_edge_recon_loss: 1216051.0444; train_gene_expr_recon_loss: 1793935.5428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3020243.6209; train_optim_loss: 3020243.6209; val_kl_reg_loss: 10127.6609; val_edge_recon_loss: 1237387.2050; val_gene_expr_recon_loss: 1796453.2921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043968.1586; val_optim_loss: 3043968.1586
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9907; val_auprc_score: 0.9967; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 10246.9041; train_edge_recon_loss: 1217691.6211; train_gene_expr_recon_loss: 1793799.9538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021738.4777; train_optim_loss: 3021738.4777; val_kl_reg_loss: 10127.2266; val_edge_recon_loss: 1238489.8388; val_gene_expr_recon_loss: 1796621.8058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3045238.8668; val_optim_loss: 3045238.8668

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 511 min 1 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9908
val AUPRC score: 0.9968
val best accuracy score: 0.9650
val best F1 score: 0.9773
val target rna MSE score: 4.8181
val source rna MSE score: 0.7215
Val cat covariate0 mean sim diff: -0.0002
Val cat covariate1 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
