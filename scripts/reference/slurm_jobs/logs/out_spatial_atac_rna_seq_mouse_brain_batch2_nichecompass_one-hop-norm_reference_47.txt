[True]
Run timestamp: 26072023_015548_47.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_47']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9033; val_auprc_score: 0.9129; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7071.9126; train_edge_recon_loss: 352308.1007; train_gene_expr_recon_loss: 31678378.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10862990.5556; train_global_loss: 42900749.7778; train_optim_loss: 42900749.7778; val_kl_reg_loss: 20869.6426; val_edge_recon_loss: 406597.7500; val_gene_expr_recon_loss: 30061224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10742581.0000; val_global_loss: 41231272.0000; val_optim_loss: 41231272.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8874; val_auprc_score: 0.8918; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 33742.6938; train_edge_recon_loss: 374370.6910; train_gene_expr_recon_loss: 28265576.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10622518.3333; train_global_loss: 39296208.4444; train_optim_loss: 39296208.4444; val_kl_reg_loss: 50264.2461; val_edge_recon_loss: 406604.7500; val_gene_expr_recon_loss: 27147412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10497718.0000; val_global_loss: 38102000.0000; val_optim_loss: 38102000.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8802; val_auprc_score: 0.8807; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 64217.3047; train_edge_recon_loss: 392516.9444; train_gene_expr_recon_loss: 25778393.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10392753.1111; train_global_loss: 36627880.4444; train_optim_loss: 36627880.4444; val_kl_reg_loss: 86240.2500; val_edge_recon_loss: 406605.9688; val_gene_expr_recon_loss: 24834454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10241277.0000; val_global_loss: 35568576.0000; val_optim_loss: 35568576.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8820; val_auprc_score: 0.8804; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 110595.8446; train_edge_recon_loss: 400791.2083; train_gene_expr_recon_loss: 23940013.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10085314.7778; train_global_loss: 34536715.5556; train_optim_loss: 34536715.5556; val_kl_reg_loss: 128225.0312; val_edge_recon_loss: 406603.9375; val_gene_expr_recon_loss: 23618050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10071595.0000; val_global_loss: 34224476.0000; val_optim_loss: 34224476.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8836; val_auprc_score: 0.8789; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 136163.0851; train_edge_recon_loss: 403839.5556; train_gene_expr_recon_loss: 22842863.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9965044.1111; train_global_loss: 33347910.0000; train_optim_loss: 33347910.0000; val_kl_reg_loss: 145349.0312; val_edge_recon_loss: 406590.6250; val_gene_expr_recon_loss: 22713242.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9967227.0000; val_global_loss: 33232408.0000; val_optim_loss: 33232408.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8827; val_auprc_score: 0.8719; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 154555.9757; train_edge_recon_loss: 404973.1215; train_gene_expr_recon_loss: 22225707.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9897894.2222; train_global_loss: 32683130.4444; train_optim_loss: 32683130.4444; val_kl_reg_loss: 155175.1719; val_edge_recon_loss: 406561.7188; val_gene_expr_recon_loss: 22185526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9913725.0000; val_global_loss: 32660988.0000; val_optim_loss: 32660988.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8792; val_auprc_score: 0.8636; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 155137.3802; train_edge_recon_loss: 405251.4479; train_gene_expr_recon_loss: 21571296.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9814525.5556; train_global_loss: 31946211.7778; train_optim_loss: 31946211.7778; val_kl_reg_loss: 151492.7344; val_edge_recon_loss: 406498.0000; val_gene_expr_recon_loss: 21898708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9858423.0000; val_global_loss: 32315120.0000; val_optim_loss: 32315120.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8766; val_auprc_score: 0.8581; val_best_acc_score: 0.5159; val_best_f1_score: 0.6737; train_kl_reg_loss: 153189.0729; train_edge_recon_loss: 405178.4236; train_gene_expr_recon_loss: 21493268.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9775625.4444; train_global_loss: 31827261.3333; train_optim_loss: 31827261.3333; val_kl_reg_loss: 147297.9688; val_edge_recon_loss: 406411.0938; val_gene_expr_recon_loss: 21695300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823247.0000; val_global_loss: 32072256.0000; val_optim_loss: 32072256.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8583; val_auprc_score: 0.8397; val_best_acc_score: 0.5438; val_best_f1_score: 0.6864; train_kl_reg_loss: 146909.9740; train_edge_recon_loss: 405077.9514; train_gene_expr_recon_loss: 21333374.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9766836.6667; train_global_loss: 31652198.2222; train_optim_loss: 31652198.2222; val_kl_reg_loss: 142130.0781; val_edge_recon_loss: 406287.6562; val_gene_expr_recon_loss: 21595230.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823140.0000; val_global_loss: 31966788.0000; val_optim_loss: 31966788.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8516; val_auprc_score: 0.8319; val_best_acc_score: 0.5725; val_best_f1_score: 0.6997; train_kl_reg_loss: 143501.3698; train_edge_recon_loss: 404938.1042; train_gene_expr_recon_loss: 21200830.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9787518.3333; train_global_loss: 31536787.3333; train_optim_loss: 31536787.3333; val_kl_reg_loss: 140163.7188; val_edge_recon_loss: 406153.1562; val_gene_expr_recon_loss: 21471544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9781915.0000; val_global_loss: 31799776.0000; val_optim_loss: 31799776.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8582; val_auprc_score: 0.8431; val_best_acc_score: 0.6213; val_best_f1_score: 0.7237; train_kl_reg_loss: 140951.2899; train_edge_recon_loss: 404645.5000; train_gene_expr_recon_loss: 21112588.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737580.0000; train_global_loss: 31395765.5556; train_optim_loss: 31395765.5556; val_kl_reg_loss: 135436.1719; val_edge_recon_loss: 405923.2188; val_gene_expr_recon_loss: 21399592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9768875.0000; val_global_loss: 31709828.0000; val_optim_loss: 31709828.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8589; val_auprc_score: 0.8443; val_best_acc_score: 0.6571; val_best_f1_score: 0.7411; train_kl_reg_loss: 137167.7847; train_edge_recon_loss: 404334.5035; train_gene_expr_recon_loss: 21159179.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9723766.2222; train_global_loss: 31424448.0000; train_optim_loss: 31424448.0000; val_kl_reg_loss: 132416.8438; val_edge_recon_loss: 405661.3750; val_gene_expr_recon_loss: 21342480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9743671.0000; val_global_loss: 31624228.0000; val_optim_loss: 31624228.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8614; val_auprc_score: 0.8454; val_best_acc_score: 0.6963; val_best_f1_score: 0.7611; train_kl_reg_loss: 134778.3403; train_edge_recon_loss: 403924.7569; train_gene_expr_recon_loss: 21097181.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750242.2222; train_global_loss: 31386126.8889; train_optim_loss: 31386126.8889; val_kl_reg_loss: 126923.7031; val_edge_recon_loss: 405239.0312; val_gene_expr_recon_loss: 21289854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9735174.0000; val_global_loss: 31557190.0000; val_optim_loss: 31557190.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8659; val_auprc_score: 0.8563; val_best_acc_score: 0.7156; val_best_f1_score: 0.7703; train_kl_reg_loss: 128980.8655; train_edge_recon_loss: 403398.1736; train_gene_expr_recon_loss: 20893811.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9677004.3333; train_global_loss: 31103194.4444; train_optim_loss: 31103194.4444; val_kl_reg_loss: 127636.4062; val_edge_recon_loss: 404895.9375; val_gene_expr_recon_loss: 21237230.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9723751.0000; val_global_loss: 31493512.0000; val_optim_loss: 31493512.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8800; val_auprc_score: 0.8685; val_best_acc_score: 0.7532; val_best_f1_score: 0.7921; train_kl_reg_loss: 128318.1554; train_edge_recon_loss: 402900.2708; train_gene_expr_recon_loss: 20864222.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9670801.7778; train_global_loss: 31066242.0000; train_optim_loss: 31066242.0000; val_kl_reg_loss: 120160.7109; val_edge_recon_loss: 404317.0938; val_gene_expr_recon_loss: 21185972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9715055.0000; val_global_loss: 31425504.0000; val_optim_loss: 31425504.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8918; val_auprc_score: 0.8795; val_best_acc_score: 0.7829; val_best_f1_score: 0.8106; train_kl_reg_loss: 125060.9957; train_edge_recon_loss: 402326.1424; train_gene_expr_recon_loss: 20874253.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9680682.6667; train_global_loss: 31082322.0000; train_optim_loss: 31082322.0000; val_kl_reg_loss: 117973.5156; val_edge_recon_loss: 403714.3125; val_gene_expr_recon_loss: 21161724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714586.0000; val_global_loss: 31397998.0000; val_optim_loss: 31397998.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8936; val_auprc_score: 0.8777; val_best_acc_score: 0.8061; val_best_f1_score: 0.8252; train_kl_reg_loss: 122269.9280; train_edge_recon_loss: 401789.1319; train_gene_expr_recon_loss: 20803478.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694372.6667; train_global_loss: 31021910.6667; train_optim_loss: 31021910.6667; val_kl_reg_loss: 114100.1250; val_edge_recon_loss: 403294.7188; val_gene_expr_recon_loss: 21131852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9718140.0000; val_global_loss: 31367386.0000; val_optim_loss: 31367386.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9024; val_auprc_score: 0.8906; val_best_acc_score: 0.8274; val_best_f1_score: 0.8396; train_kl_reg_loss: 119501.4844; train_edge_recon_loss: 401040.5694; train_gene_expr_recon_loss: 20679171.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9635303.8889; train_global_loss: 30835017.7778; train_optim_loss: 30835017.7778; val_kl_reg_loss: 112771.7344; val_edge_recon_loss: 402766.9062; val_gene_expr_recon_loss: 21079818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696735.0000; val_global_loss: 31292092.0000; val_optim_loss: 31292092.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9074; val_auprc_score: 0.8955; val_best_acc_score: 0.8366; val_best_f1_score: 0.8440; train_kl_reg_loss: 117785.3003; train_edge_recon_loss: 400459.0486; train_gene_expr_recon_loss: 20697177.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9649103.4444; train_global_loss: 30864525.5556; train_optim_loss: 30864525.5556; val_kl_reg_loss: 109007.8438; val_edge_recon_loss: 401887.3438; val_gene_expr_recon_loss: 21054968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9680961.0000; val_global_loss: 31246824.0000; val_optim_loss: 31246824.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9079; val_auprc_score: 0.8918; val_best_acc_score: 0.8362; val_best_f1_score: 0.8409; train_kl_reg_loss: 115670.4236; train_edge_recon_loss: 399577.0972; train_gene_expr_recon_loss: 20787177.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9679225.1111; train_global_loss: 30981650.2222; train_optim_loss: 30981650.2222; val_kl_reg_loss: 105916.6562; val_edge_recon_loss: 401380.0000; val_gene_expr_recon_loss: 21055872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9679830.0000; val_global_loss: 31242998.0000; val_optim_loss: 31242998.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9152; val_auprc_score: 0.9060; val_best_acc_score: 0.8389; val_best_f1_score: 0.8415; train_kl_reg_loss: 113088.0234; train_edge_recon_loss: 398951.5278; train_gene_expr_recon_loss: 20694229.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9621367.5556; train_global_loss: 30827636.4444; train_optim_loss: 30827636.4444; val_kl_reg_loss: 106215.6562; val_edge_recon_loss: 400896.7188; val_gene_expr_recon_loss: 21016774.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673094.0000; val_global_loss: 31196980.0000; val_optim_loss: 31196980.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9154; val_auprc_score: 0.9029; val_best_acc_score: 0.8387; val_best_f1_score: 0.8390; train_kl_reg_loss: 111789.7474; train_edge_recon_loss: 398287.6597; train_gene_expr_recon_loss: 20793702.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9654770.2222; train_global_loss: 30958550.4444; train_optim_loss: 30958550.4444; val_kl_reg_loss: 103720.3281; val_edge_recon_loss: 400067.7812; val_gene_expr_recon_loss: 20987218.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9667299.0000; val_global_loss: 31158304.0000; val_optim_loss: 31158304.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9187; val_auprc_score: 0.9105; val_best_acc_score: 0.8366; val_best_f1_score: 0.8354; train_kl_reg_loss: 109479.9297; train_edge_recon_loss: 396982.2326; train_gene_expr_recon_loss: 20646134.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587692.7778; train_global_loss: 30740290.2222; train_optim_loss: 30740290.2222; val_kl_reg_loss: 103027.8594; val_edge_recon_loss: 399294.5938; val_gene_expr_recon_loss: 20962380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9663199.0000; val_global_loss: 31127900.0000; val_optim_loss: 31127900.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9145; val_auprc_score: 0.8979; val_best_acc_score: 0.8320; val_best_f1_score: 0.8297; train_kl_reg_loss: 108095.2856; train_edge_recon_loss: 396999.7083; train_gene_expr_recon_loss: 20647047.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9610771.8889; train_global_loss: 30762914.0000; train_optim_loss: 30762914.0000; val_kl_reg_loss: 104442.3281; val_edge_recon_loss: 399207.5625; val_gene_expr_recon_loss: 20937592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9652759.0000; val_global_loss: 31094000.0000; val_optim_loss: 31094000.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9219; val_auprc_score: 0.9088; val_best_acc_score: 0.8397; val_best_f1_score: 0.8340; train_kl_reg_loss: 106895.8377; train_edge_recon_loss: 396165.7639; train_gene_expr_recon_loss: 20514882.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9613394.3333; train_global_loss: 30631338.6667; train_optim_loss: 30631338.6667; val_kl_reg_loss: 103002.0781; val_edge_recon_loss: 398181.2188; val_gene_expr_recon_loss: 20908674.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643326.0000; val_global_loss: 31053184.0000; val_optim_loss: 31053184.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9227; val_auprc_score: 0.9156; val_best_acc_score: 0.8319; val_best_f1_score: 0.8238; train_kl_reg_loss: 107371.3620; train_edge_recon_loss: 396028.3333; train_gene_expr_recon_loss: 20990305.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9638750.4444; train_global_loss: 31132455.5556; train_optim_loss: 31132455.5556; val_kl_reg_loss: 91033.7266; val_edge_recon_loss: 397248.2500; val_gene_expr_recon_loss: 21091062.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9634778.0000; val_global_loss: 31214122.0000; val_optim_loss: 31214122.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9277; val_auprc_score: 0.9169; val_best_acc_score: 0.8350; val_best_f1_score: 0.8245; train_kl_reg_loss: 102716.4340; train_edge_recon_loss: 394706.1319; train_gene_expr_recon_loss: 20797866.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624475.2222; train_global_loss: 30919764.6667; train_optim_loss: 30919764.6667; val_kl_reg_loss: 93146.8594; val_edge_recon_loss: 396675.7812; val_gene_expr_recon_loss: 21090120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643629.0000; val_global_loss: 31223572.0000; val_optim_loss: 31223572.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9241; val_auprc_score: 0.9132; val_best_acc_score: 0.8281; val_best_f1_score: 0.8239; train_kl_reg_loss: 101731.1623; train_edge_recon_loss: 394316.0243; train_gene_expr_recon_loss: 20683410.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587778.8889; train_global_loss: 30767236.0000; train_optim_loss: 30767236.0000; val_kl_reg_loss: 94451.4062; val_edge_recon_loss: 396180.5312; val_gene_expr_recon_loss: 21168254.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646430.0000; val_global_loss: 31305316.0000; val_optim_loss: 31305316.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9259; val_auprc_score: 0.9204; val_best_acc_score: 0.8227; val_best_f1_score: 0.8264; train_kl_reg_loss: 100540.2995; train_edge_recon_loss: 392944.8021; train_gene_expr_recon_loss: 20751811.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9572158.4444; train_global_loss: 30817454.4444; train_optim_loss: 30817454.4444; val_kl_reg_loss: 93083.5000; val_edge_recon_loss: 395216.0625; val_gene_expr_recon_loss: 21105546.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9617475.0000; val_global_loss: 31211320.0000; val_optim_loss: 31211320.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9236; val_auprc_score: 0.9148; val_best_acc_score: 0.8186; val_best_f1_score: 0.8307; train_kl_reg_loss: 99675.9818; train_edge_recon_loss: 392825.5069; train_gene_expr_recon_loss: 20627512.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9548215.6667; train_global_loss: 30668230.0000; train_optim_loss: 30668230.0000; val_kl_reg_loss: 90399.0781; val_edge_recon_loss: 394873.4062; val_gene_expr_recon_loss: 21126580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9632097.0000; val_global_loss: 31243948.0000; val_optim_loss: 31243948.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9270; val_auprc_score: 0.9154; val_best_acc_score: 0.8216; val_best_f1_score: 0.8333; train_kl_reg_loss: 98337.3533; train_edge_recon_loss: 392696.4167; train_gene_expr_recon_loss: 20694073.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9563917.7778; train_global_loss: 30749025.1111; train_optim_loss: 30749025.1111; val_kl_reg_loss: 90666.6797; val_edge_recon_loss: 394486.1562; val_gene_expr_recon_loss: 21101954.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9614037.0000; val_global_loss: 31201144.0000; val_optim_loss: 31201144.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9245; val_auprc_score: 0.9147; val_best_acc_score: 0.8200; val_best_f1_score: 0.8300; train_kl_reg_loss: 99732.0321; train_edge_recon_loss: 392471.2396; train_gene_expr_recon_loss: 20856008.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9575655.0000; train_global_loss: 30923867.3333; train_optim_loss: 30923867.3333; val_kl_reg_loss: 91994.3750; val_edge_recon_loss: 394914.1250; val_gene_expr_recon_loss: 21107554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624361.0000; val_global_loss: 31218824.0000; val_optim_loss: 31218824.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9307; val_auprc_score: 0.9203; val_best_acc_score: 0.8247; val_best_f1_score: 0.8392; train_kl_reg_loss: 100023.2682; train_edge_recon_loss: 391974.4132; train_gene_expr_recon_loss: 20802826.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9557865.1111; train_global_loss: 30852689.3333; train_optim_loss: 30852689.3333; val_kl_reg_loss: 91281.7656; val_edge_recon_loss: 394190.2500; val_gene_expr_recon_loss: 21088082.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9610567.0000; val_global_loss: 31184120.0000; val_optim_loss: 31184120.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9154
Val AUPRC score: 0.8997
Val best accuracy score: 0.8328
Val best F1 score: 0.8292
Val gene expr MSE score: 0.5851
Val chrom access MSE score: 0.0874
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
