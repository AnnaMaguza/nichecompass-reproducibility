[True]
Run timestamp: 07082023_184449_47.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_47']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8888; val_auprc_score: 0.9072; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 5547.6782; train_edge_recon_loss: 35369.4466; train_gene_expr_recon_loss: 1230064.3056; train_masked_gp_l1_reg_loss: 4506.7852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119232.1128; train_chrom_access_recon_loss: 873079.0347; train_global_loss: 2267799.3194; train_optim_loss: 2267799.3194; val_kl_reg_loss: 3716.6001; val_edge_recon_loss: 40657.2891; val_gene_expr_recon_loss: 1103124.7500; val_masked_gp_l1_reg_loss: 3967.5991; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116974.8594; val_chrom_access_recon_loss: 511449.6562; val_global_loss: 1779890.7500; val_optim_loss: 1779890.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8989; val_auprc_score: 0.9121; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5774.5764; train_edge_recon_loss: 36411.8702; train_gene_expr_recon_loss: 1033601.7014; train_masked_gp_l1_reg_loss: 3849.9369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115665.1076; train_chrom_access_recon_loss: 500374.0625; train_global_loss: 1695677.2500; train_optim_loss: 1695677.2500; val_kl_reg_loss: 9253.5586; val_edge_recon_loss: 40660.7227; val_gene_expr_recon_loss: 911168.2500; val_masked_gp_l1_reg_loss: 3806.8960; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114115.7734; val_chrom_access_recon_loss: 492026.1250; val_global_loss: 1571031.2500; val_optim_loss: 1571031.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8986; val_auprc_score: 0.9117; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14077.9502; train_edge_recon_loss: 37985.1832; train_gene_expr_recon_loss: 861825.7847; train_masked_gp_l1_reg_loss: 3888.0636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112890.8793; train_chrom_access_recon_loss: 483446.7569; train_global_loss: 1514114.6250; train_optim_loss: 1514114.6250; val_kl_reg_loss: 17206.2656; val_edge_recon_loss: 40661.0977; val_gene_expr_recon_loss: 800318.3750; val_masked_gp_l1_reg_loss: 3977.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111292.7969; val_chrom_access_recon_loss: 472434.0000; val_global_loss: 1445890.2500; val_optim_loss: 1445890.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8977; val_auprc_score: 0.9078; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17773.2441; train_edge_recon_loss: 38515.0113; train_gene_expr_recon_loss: 780379.6111; train_masked_gp_l1_reg_loss: 3991.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109869.8359; train_chrom_access_recon_loss: 463567.2674; train_global_loss: 1414096.8611; train_optim_loss: 1414096.8611; val_kl_reg_loss: 17587.4961; val_edge_recon_loss: 40659.3906; val_gene_expr_recon_loss: 749660.8750; val_masked_gp_l1_reg_loss: 3990.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107994.7656; val_chrom_access_recon_loss: 455435.4375; val_global_loss: 1375328.2500; val_optim_loss: 1375328.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8853; val_auprc_score: 0.8931; val_best_acc_score: 0.5090; val_best_f1_score: 0.6707; train_kl_reg_loss: 19176.9334; train_edge_recon_loss: 38644.5243; train_gene_expr_recon_loss: 747084.5208; train_masked_gp_l1_reg_loss: 3975.5587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106336.9948; train_chrom_access_recon_loss: 452979.0556; train_global_loss: 1368197.5556; train_optim_loss: 1368197.5556; val_kl_reg_loss: 18648.2363; val_edge_recon_loss: 40655.3555; val_gene_expr_recon_loss: 719230.5000; val_masked_gp_l1_reg_loss: 3950.8044; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104175.0000; val_chrom_access_recon_loss: 449545.6562; val_global_loss: 1336205.6250; val_optim_loss: 1336205.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8805; val_auprc_score: 0.8866; val_best_acc_score: 0.5158; val_best_f1_score: 0.6734; train_kl_reg_loss: 19285.6263; train_edge_recon_loss: 38677.2114; train_gene_expr_recon_loss: 717591.6458; train_masked_gp_l1_reg_loss: 3938.0637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102338.0000; train_chrom_access_recon_loss: 446304.2743; train_global_loss: 1328134.8194; train_optim_loss: 1328134.8194; val_kl_reg_loss: 19169.1250; val_edge_recon_loss: 40646.3516; val_gene_expr_recon_loss: 700451.5000; val_masked_gp_l1_reg_loss: 3918.9370; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99993.3281; val_chrom_access_recon_loss: 446079.5000; val_global_loss: 1310258.7500; val_optim_loss: 1310258.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8602; val_auprc_score: 0.8652; val_best_acc_score: 0.5280; val_best_f1_score: 0.6775; train_kl_reg_loss: 19765.7303; train_edge_recon_loss: 38728.7769; train_gene_expr_recon_loss: 699451.8056; train_masked_gp_l1_reg_loss: 3909.2756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98065.1884; train_chrom_access_recon_loss: 443935.9618; train_global_loss: 1303856.7361; train_optim_loss: 1303856.7361; val_kl_reg_loss: 19086.2090; val_edge_recon_loss: 40630.8555; val_gene_expr_recon_loss: 687205.6250; val_masked_gp_l1_reg_loss: 3892.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95634.6172; val_chrom_access_recon_loss: 443351.7188; val_global_loss: 1289801.3750; val_optim_loss: 1289801.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8430; val_auprc_score: 0.8469; val_best_acc_score: 0.5575; val_best_f1_score: 0.6897; train_kl_reg_loss: 19740.6882; train_edge_recon_loss: 38771.6810; train_gene_expr_recon_loss: 688963.2500; train_masked_gp_l1_reg_loss: 3885.5675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93674.8368; train_chrom_access_recon_loss: 441705.6250; train_global_loss: 1286741.6806; train_optim_loss: 1286741.6806; val_kl_reg_loss: 18907.5312; val_edge_recon_loss: 40612.3242; val_gene_expr_recon_loss: 677109.8125; val_masked_gp_l1_reg_loss: 3874.9534; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91221.8594; val_chrom_access_recon_loss: 441321.0312; val_global_loss: 1273047.5000; val_optim_loss: 1273047.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8436; val_auprc_score: 0.8459; val_best_acc_score: 0.5781; val_best_f1_score: 0.6980; train_kl_reg_loss: 20048.3266; train_edge_recon_loss: 38796.6519; train_gene_expr_recon_loss: 679513.8403; train_masked_gp_l1_reg_loss: 3875.4469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89269.4349; train_chrom_access_recon_loss: 441658.9201; train_global_loss: 1273162.5972; train_optim_loss: 1273162.5972; val_kl_reg_loss: 18964.5820; val_edge_recon_loss: 40591.0938; val_gene_expr_recon_loss: 669588.5000; val_masked_gp_l1_reg_loss: 3868.0649; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86834.5156; val_chrom_access_recon_loss: 439759.2812; val_global_loss: 1259606.0000; val_optim_loss: 1259606.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8519; val_auprc_score: 0.8588; val_best_acc_score: 0.5980; val_best_f1_score: 0.7077; train_kl_reg_loss: 20147.7335; train_edge_recon_loss: 38828.5230; train_gene_expr_recon_loss: 673114.4444; train_masked_gp_l1_reg_loss: 3869.8682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84914.8837; train_chrom_access_recon_loss: 438740.8958; train_global_loss: 1259616.3472; train_optim_loss: 1259616.3472; val_kl_reg_loss: 19780.7754; val_edge_recon_loss: 40582.8789; val_gene_expr_recon_loss: 662879.6250; val_masked_gp_l1_reg_loss: 3868.8574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82531.1328; val_chrom_access_recon_loss: 438453.9688; val_global_loss: 1248097.2500; val_optim_loss: 1248097.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8551; val_auprc_score: 0.8623; val_best_acc_score: 0.6205; val_best_f1_score: 0.7181; train_kl_reg_loss: 20232.0888; train_edge_recon_loss: 38832.5490; train_gene_expr_recon_loss: 670407.9167; train_masked_gp_l1_reg_loss: 3872.3326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80659.7344; train_chrom_access_recon_loss: 439176.7604; train_global_loss: 1253181.3611; train_optim_loss: 1253181.3611; val_kl_reg_loss: 19764.8672; val_edge_recon_loss: 40563.2383; val_gene_expr_recon_loss: 658368.1250; val_masked_gp_l1_reg_loss: 3870.9097; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78337.9297; val_chrom_access_recon_loss: 437262.5625; val_global_loss: 1238167.7500; val_optim_loss: 1238167.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8564; val_auprc_score: 0.8588; val_best_acc_score: 0.6523; val_best_f1_score: 0.7341; train_kl_reg_loss: 20319.5610; train_edge_recon_loss: 38838.8542; train_gene_expr_recon_loss: 665625.7222; train_masked_gp_l1_reg_loss: 3875.3449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76524.0616; train_chrom_access_recon_loss: 439403.8681; train_global_loss: 1244587.4306; train_optim_loss: 1244587.4306; val_kl_reg_loss: 19283.7383; val_edge_recon_loss: 40539.5391; val_gene_expr_recon_loss: 654830.1875; val_masked_gp_l1_reg_loss: 3874.9033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74278.4531; val_chrom_access_recon_loss: 436138.9688; val_global_loss: 1228945.7500; val_optim_loss: 1228945.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8671; val_auprc_score: 0.8689; val_best_acc_score: 0.6776; val_best_f1_score: 0.7472; train_kl_reg_loss: 19803.1441; train_edge_recon_loss: 38804.9744; train_gene_expr_recon_loss: 658268.9375; train_masked_gp_l1_reg_loss: 3881.9487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72530.7943; train_chrom_access_recon_loss: 435341.1319; train_global_loss: 1228630.9583; train_optim_loss: 1228630.9583; val_kl_reg_loss: 18997.7461; val_edge_recon_loss: 40517.6250; val_gene_expr_recon_loss: 651621.2500; val_masked_gp_l1_reg_loss: 3885.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70372.5703; val_chrom_access_recon_loss: 435284.9688; val_global_loss: 1220679.3750; val_optim_loss: 1220679.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8785; val_auprc_score: 0.8785; val_best_acc_score: 0.7285; val_best_f1_score: 0.7755; train_kl_reg_loss: 19566.4123; train_edge_recon_loss: 38778.8433; train_gene_expr_recon_loss: 657658.0903; train_masked_gp_l1_reg_loss: 3892.1694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68697.5764; train_chrom_access_recon_loss: 434284.2049; train_global_loss: 1222877.3056; train_optim_loss: 1222877.3056; val_kl_reg_loss: 18216.8945; val_edge_recon_loss: 40479.1250; val_gene_expr_recon_loss: 649735.8750; val_masked_gp_l1_reg_loss: 3890.9287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66631.3203; val_chrom_access_recon_loss: 434237.5938; val_global_loss: 1213191.7500; val_optim_loss: 1213191.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8829; val_auprc_score: 0.8751; val_best_acc_score: 0.7530; val_best_f1_score: 0.7902; train_kl_reg_loss: 19149.3678; train_edge_recon_loss: 38739.5647; train_gene_expr_recon_loss: 653495.5972; train_masked_gp_l1_reg_loss: 3899.4305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65037.5846; train_chrom_access_recon_loss: 434060.7882; train_global_loss: 1214382.3194; train_optim_loss: 1214382.3194; val_kl_reg_loss: 18571.2539; val_edge_recon_loss: 40455.7188; val_gene_expr_recon_loss: 646618.2500; val_masked_gp_l1_reg_loss: 3902.0300; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63074.2812; val_chrom_access_recon_loss: 433524.0312; val_global_loss: 1206145.5000; val_optim_loss: 1206145.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8976; val_auprc_score: 0.8943; val_best_acc_score: 0.8019; val_best_f1_score: 0.8213; train_kl_reg_loss: 18932.8175; train_edge_recon_loss: 38706.4857; train_gene_expr_recon_loss: 653986.4028; train_masked_gp_l1_reg_loss: 3907.4542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61561.5447; train_chrom_access_recon_loss: 434755.8472; train_global_loss: 1211850.5278; train_optim_loss: 1211850.5278; val_kl_reg_loss: 17496.7266; val_edge_recon_loss: 40398.0039; val_gene_expr_recon_loss: 645843.0000; val_masked_gp_l1_reg_loss: 3907.8647; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59699.7031; val_chrom_access_recon_loss: 432748.0938; val_global_loss: 1200093.3750; val_optim_loss: 1200093.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9021; val_auprc_score: 0.8950; val_best_acc_score: 0.8248; val_best_f1_score: 0.8374; train_kl_reg_loss: 18647.7010; train_edge_recon_loss: 38672.6931; train_gene_expr_recon_loss: 652231.6667; train_masked_gp_l1_reg_loss: 3917.3353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58276.3216; train_chrom_access_recon_loss: 433272.5451; train_global_loss: 1205018.2500; train_optim_loss: 1205018.2500; val_kl_reg_loss: 17780.2812; val_edge_recon_loss: 40362.3203; val_gene_expr_recon_loss: 642998.3750; val_masked_gp_l1_reg_loss: 3920.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56526.6211; val_chrom_access_recon_loss: 432641.6875; val_global_loss: 1194229.6250; val_optim_loss: 1194229.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9115; val_auprc_score: 0.9019; val_best_acc_score: 0.8387; val_best_f1_score: 0.8452; train_kl_reg_loss: 18239.1322; train_edge_recon_loss: 38594.3142; train_gene_expr_recon_loss: 650196.1111; train_masked_gp_l1_reg_loss: 3930.2306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55186.8724; train_chrom_access_recon_loss: 432636.3403; train_global_loss: 1198783.0278; train_optim_loss: 1198783.0278; val_kl_reg_loss: 17230.0391; val_edge_recon_loss: 40284.8945; val_gene_expr_recon_loss: 641616.3750; val_masked_gp_l1_reg_loss: 3935.6577; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53539.8242; val_chrom_access_recon_loss: 431829.1562; val_global_loss: 1188436.0000; val_optim_loss: 1188436.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9132; val_auprc_score: 0.9046; val_best_acc_score: 0.8440; val_best_f1_score: 0.8462; train_kl_reg_loss: 17974.3003; train_edge_recon_loss: 38540.5820; train_gene_expr_recon_loss: 648476.8472; train_masked_gp_l1_reg_loss: 3945.9447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52283.5786; train_chrom_access_recon_loss: 432523.1910; train_global_loss: 1193744.4306; train_optim_loss: 1193744.4306; val_kl_reg_loss: 16617.7695; val_edge_recon_loss: 40210.2500; val_gene_expr_recon_loss: 640913.1250; val_masked_gp_l1_reg_loss: 3953.2361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50737.8281; val_chrom_access_recon_loss: 431282.1875; val_global_loss: 1183714.3750; val_optim_loss: 1183714.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9215; val_auprc_score: 0.9163; val_best_acc_score: 0.8499; val_best_f1_score: 0.8496; train_kl_reg_loss: 17641.3407; train_edge_recon_loss: 38468.0807; train_gene_expr_recon_loss: 651378.0000; train_masked_gp_l1_reg_loss: 3963.8425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49568.5260; train_chrom_access_recon_loss: 433971.0556; train_global_loss: 1194990.8333; train_optim_loss: 1194990.8333; val_kl_reg_loss: 17063.5645; val_edge_recon_loss: 40169.7500; val_gene_expr_recon_loss: 638323.1875; val_masked_gp_l1_reg_loss: 3970.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48132.6367; val_chrom_access_recon_loss: 430555.0625; val_global_loss: 1178214.5000; val_optim_loss: 1178214.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9255; val_auprc_score: 0.9179; val_best_acc_score: 0.8517; val_best_f1_score: 0.8466; train_kl_reg_loss: 17489.2472; train_edge_recon_loss: 38411.8325; train_gene_expr_recon_loss: 645220.0208; train_masked_gp_l1_reg_loss: 3981.9281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47041.7418; train_chrom_access_recon_loss: 430099.2847; train_global_loss: 1182244.0694; train_optim_loss: 1182244.0694; val_kl_reg_loss: 16419.0625; val_edge_recon_loss: 40080.2031; val_gene_expr_recon_loss: 637517.6875; val_masked_gp_l1_reg_loss: 3986.1045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45700.1250; val_chrom_access_recon_loss: 429965.7812; val_global_loss: 1173669.0000; val_optim_loss: 1173669.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9318; val_auprc_score: 0.9253; val_best_acc_score: 0.8513; val_best_f1_score: 0.8428; train_kl_reg_loss: 17127.4141; train_edge_recon_loss: 38329.1098; train_gene_expr_recon_loss: 641492.4097; train_masked_gp_l1_reg_loss: 3996.5691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44682.7691; train_chrom_access_recon_loss: 429082.7674; train_global_loss: 1174711.0556; train_optim_loss: 1174711.0556; val_kl_reg_loss: 16179.1191; val_edge_recon_loss: 39974.2617; val_gene_expr_recon_loss: 636280.2500; val_masked_gp_l1_reg_loss: 4000.0142; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43423.7031; val_chrom_access_recon_loss: 429447.1562; val_global_loss: 1169304.5000; val_optim_loss: 1169304.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9367; val_auprc_score: 0.9290; val_best_acc_score: 0.8468; val_best_f1_score: 0.8360; train_kl_reg_loss: 16949.8633; train_edge_recon_loss: 38256.2643; train_gene_expr_recon_loss: 639008.1667; train_masked_gp_l1_reg_loss: 4007.6102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42467.4410; train_chrom_access_recon_loss: 431166.4479; train_global_loss: 1171855.7778; train_optim_loss: 1171855.7778; val_kl_reg_loss: 16285.6289; val_edge_recon_loss: 39880.3789; val_gene_expr_recon_loss: 634714.7500; val_masked_gp_l1_reg_loss: 4012.5796; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41288.0234; val_chrom_access_recon_loss: 428794.4688; val_global_loss: 1164975.7500; val_optim_loss: 1164975.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9403; val_auprc_score: 0.9312; val_best_acc_score: 0.8444; val_best_f1_score: 0.8297; train_kl_reg_loss: 16795.4249; train_edge_recon_loss: 38190.3507; train_gene_expr_recon_loss: 638874.9444; train_masked_gp_l1_reg_loss: 4023.9777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40391.7062; train_chrom_access_recon_loss: 429144.6667; train_global_loss: 1167421.0833; train_optim_loss: 1167421.0833; val_kl_reg_loss: 15686.7734; val_edge_recon_loss: 39781.1641; val_gene_expr_recon_loss: 634312.4375; val_masked_gp_l1_reg_loss: 4029.1475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39288.7500; val_chrom_access_recon_loss: 428234.3750; val_global_loss: 1161332.6250; val_optim_loss: 1161332.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9353; val_auprc_score: 0.9239; val_best_acc_score: 0.8309; val_best_f1_score: 0.8388; train_kl_reg_loss: 16604.0038; train_edge_recon_loss: 38117.8459; train_gene_expr_recon_loss: 641772.9236; train_masked_gp_l1_reg_loss: 4038.4201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38454.8919; train_chrom_access_recon_loss: 428757.2951; train_global_loss: 1167745.3889; train_optim_loss: 1167745.3889; val_kl_reg_loss: 15778.5635; val_edge_recon_loss: 39731.5312; val_gene_expr_recon_loss: 632804.0000; val_masked_gp_l1_reg_loss: 4044.7629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37427.2734; val_chrom_access_recon_loss: 427379.5000; val_global_loss: 1157165.6250; val_optim_loss: 1157165.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9332; val_auprc_score: 0.9227; val_best_acc_score: 0.8661; val_best_f1_score: 0.8723; train_kl_reg_loss: 13749.1379; train_edge_recon_loss: 39905.8477; train_gene_expr_recon_loss: 973721.7292; train_masked_gp_l1_reg_loss: 4115.5669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36520.6259; train_chrom_access_recon_loss: 451582.0972; train_global_loss: 1519594.9861; train_optim_loss: 1519594.9861; val_kl_reg_loss: 11678.6748; val_edge_recon_loss: 40306.9258; val_gene_expr_recon_loss: 960801.0000; val_masked_gp_l1_reg_loss: 4240.9165; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35323.8242; val_chrom_access_recon_loss: 452243.4688; val_global_loss: 1504594.8750; val_optim_loss: 1504594.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9317; val_auprc_score: 0.9198; val_best_acc_score: 0.8636; val_best_f1_score: 0.8696; train_kl_reg_loss: 12694.8860; train_edge_recon_loss: 39998.1589; train_gene_expr_recon_loss: 967692.5833; train_masked_gp_l1_reg_loss: 4349.5289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34348.7708; train_chrom_access_recon_loss: 452225.7951; train_global_loss: 1511309.7639; train_optim_loss: 1511309.7639; val_kl_reg_loss: 11161.5547; val_edge_recon_loss: 40288.2383; val_gene_expr_recon_loss: 953895.1250; val_masked_gp_l1_reg_loss: 4471.4038; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33145.4297; val_chrom_access_recon_loss: 451506.4375; val_global_loss: 1494468.2500; val_optim_loss: 1494468.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9334; val_auprc_score: 0.9208; val_best_acc_score: 0.8645; val_best_f1_score: 0.8692; train_kl_reg_loss: 12300.4084; train_edge_recon_loss: 39969.3841; train_gene_expr_recon_loss: 963393.5347; train_masked_gp_l1_reg_loss: 4541.7667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32227.4334; train_chrom_access_recon_loss: 453276.3264; train_global_loss: 1505708.8611; train_optim_loss: 1505708.8611; val_kl_reg_loss: 10825.8945; val_edge_recon_loss: 40268.7812; val_gene_expr_recon_loss: 948661.2500; val_masked_gp_l1_reg_loss: 4615.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31111.6699; val_chrom_access_recon_loss: 450854.5312; val_global_loss: 1486337.3750; val_optim_loss: 1486337.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9376; val_auprc_score: 0.9279; val_best_acc_score: 0.8708; val_best_f1_score: 0.8730; train_kl_reg_loss: 12048.2424; train_edge_recon_loss: 39965.3932; train_gene_expr_recon_loss: 961133.5000; train_masked_gp_l1_reg_loss: 4659.5363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30269.7075; train_chrom_access_recon_loss: 450601.2292; train_global_loss: 1498677.6250; train_optim_loss: 1498677.6250; val_kl_reg_loss: 10889.4961; val_edge_recon_loss: 40223.5859; val_gene_expr_recon_loss: 944222.8750; val_masked_gp_l1_reg_loss: 4706.9473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29244.4844; val_chrom_access_recon_loss: 450271.2500; val_global_loss: 1479558.6250; val_optim_loss: 1479558.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9360; val_auprc_score: 0.9298; val_best_acc_score: 0.8684; val_best_f1_score: 0.8712; train_kl_reg_loss: 11981.6969; train_edge_recon_loss: 39937.1497; train_gene_expr_recon_loss: 957335.7292; train_masked_gp_l1_reg_loss: 4694.5565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29126.9219; train_chrom_access_recon_loss: 450634.5556; train_global_loss: 1493710.6111; train_optim_loss: 1493710.6111; val_kl_reg_loss: 11099.7715; val_edge_recon_loss: 40233.0664; val_gene_expr_recon_loss: 943703.5000; val_masked_gp_l1_reg_loss: 4683.8872; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28983.6504; val_chrom_access_recon_loss: 450184.9062; val_global_loss: 1478888.7500; val_optim_loss: 1478888.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9365; val_auprc_score: 0.9264; val_best_acc_score: 0.8690; val_best_f1_score: 0.8716; train_kl_reg_loss: 12262.6345; train_edge_recon_loss: 39943.9978; train_gene_expr_recon_loss: 952126.0556; train_masked_gp_l1_reg_loss: 4683.0047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28884.3605; train_chrom_access_recon_loss: 449335.9479; train_global_loss: 1487236.0000; train_optim_loss: 1487236.0000; val_kl_reg_loss: 11218.1025; val_edge_recon_loss: 40218.6367; val_gene_expr_recon_loss: 943137.2500; val_masked_gp_l1_reg_loss: 4679.8774; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28759.5801; val_chrom_access_recon_loss: 450070.9062; val_global_loss: 1478084.3750; val_optim_loss: 1478084.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9390; val_auprc_score: 0.9274; val_best_acc_score: 0.8739; val_best_f1_score: 0.8751; train_kl_reg_loss: 12184.8748; train_edge_recon_loss: 39935.2543; train_gene_expr_recon_loss: 957085.6528; train_masked_gp_l1_reg_loss: 4678.1676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28665.3924; train_chrom_access_recon_loss: 451907.2986; train_global_loss: 1494456.6528; train_optim_loss: 1494456.6528; val_kl_reg_loss: 11034.6387; val_edge_recon_loss: 40197.5117; val_gene_expr_recon_loss: 943027.7500; val_masked_gp_l1_reg_loss: 4676.4556; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28549.6953; val_chrom_access_recon_loss: 450082.1250; val_global_loss: 1477568.1250; val_optim_loss: 1477568.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9363; val_auprc_score: 0.9227; val_best_acc_score: 0.8712; val_best_f1_score: 0.8723; train_kl_reg_loss: 12052.0556; train_edge_recon_loss: 39918.9709; train_gene_expr_recon_loss: 951486.6042; train_masked_gp_l1_reg_loss: 4675.8136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28459.9297; train_chrom_access_recon_loss: 451695.1701; train_global_loss: 1488288.5417; train_optim_loss: 1488288.5417; val_kl_reg_loss: 11084.5879; val_edge_recon_loss: 40179.8711; val_gene_expr_recon_loss: 942540.6250; val_masked_gp_l1_reg_loss: 4675.6426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28351.3516; val_chrom_access_recon_loss: 449935.9375; val_global_loss: 1476768.0000; val_optim_loss: 1476768.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9370
val AUPRC score: 0.9258
val best accuracy score: 0.8701
val best F1 score: 0.8761
val target rna MSE score: 3.9654
val source rna MSE score: 3.0898
val target atac MSE score: 0.1358
val source atac MSE score: 0.0203
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
