[True]
Run timestamp: 09102023_214618_47.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_47']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7170; val_auprc_score: 0.6973; val_best_acc_score: 0.5056; val_best_f1_score: 0.6689; train_kl_reg_loss: 34450.3602; train_edge_recon_loss: 3506164.8902; train_gene_expr_recon_loss: 14263241.7121; train_masked_gp_l1_reg_loss: 44268.5928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5777933.1667; train_chrom_access_recon_loss: 2340402.1818; train_global_loss: 25966460.8182; train_optim_loss: 25966460.8182; val_kl_reg_loss: 78594.0830; val_edge_recon_loss: 4064808.7188; val_gene_expr_recon_loss: 12871559.8750; val_masked_gp_l1_reg_loss: 52121.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2886550.2500; val_chrom_access_recon_loss: 2227696.2188; val_global_loss: 22181330.7500; val_optim_loss: 22181330.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7046; val_auprc_score: 0.6871; val_best_acc_score: 0.6206; val_best_f1_score: 0.7035; train_kl_reg_loss: 81632.4455; train_edge_recon_loss: 3510643.4394; train_gene_expr_recon_loss: 12892763.4697; train_masked_gp_l1_reg_loss: 53664.9495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1418445.7765; train_chrom_access_recon_loss: 2219366.1742; train_global_loss: 20176516.3636; train_optim_loss: 20176516.3636; val_kl_reg_loss: 88007.4053; val_edge_recon_loss: 4055966.5938; val_gene_expr_recon_loss: 12633919.6250; val_masked_gp_l1_reg_loss: 55034.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 603544.3125; val_chrom_access_recon_loss: 2207666.3750; val_global_loss: 19644138.2500; val_optim_loss: 19644138.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7349; val_auprc_score: 0.7134; val_best_acc_score: 0.6744; val_best_f1_score: 0.7198; train_kl_reg_loss: 78464.9180; train_edge_recon_loss: 3503331.2917; train_gene_expr_recon_loss: 12731469.6667; train_masked_gp_l1_reg_loss: 56708.6887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 398077.7661; train_chrom_access_recon_loss: 2200209.1875; train_global_loss: 18968261.4848; train_optim_loss: 18968261.4848; val_kl_reg_loss: 68489.2324; val_edge_recon_loss: 3972474.7188; val_gene_expr_recon_loss: 12529644.0000; val_masked_gp_l1_reg_loss: 58355.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 268871.7500; val_chrom_access_recon_loss: 2183088.0000; val_global_loss: 19080923.2500; val_optim_loss: 19080923.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7638; val_auprc_score: 0.7591; val_best_acc_score: 0.6781; val_best_f1_score: 0.7336; train_kl_reg_loss: 60839.5132; train_edge_recon_loss: 3362648.3295; train_gene_expr_recon_loss: 12657391.0758; train_masked_gp_l1_reg_loss: 60719.6286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213047.2382; train_chrom_access_recon_loss: 2190184.8163; train_global_loss: 18544830.7273; train_optim_loss: 18544830.7273; val_kl_reg_loss: 59585.5596; val_edge_recon_loss: 3277599.1562; val_gene_expr_recon_loss: 12668411.7500; val_masked_gp_l1_reg_loss: 64083.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171855.9219; val_chrom_access_recon_loss: 2191177.1875; val_global_loss: 18432713.7500; val_optim_loss: 18432713.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7778; val_auprc_score: 0.7691; val_best_acc_score: 0.6902; val_best_f1_score: 0.7444; train_kl_reg_loss: 82962.2091; train_edge_recon_loss: 3144681.8977; train_gene_expr_recon_loss: 12600530.1061; train_masked_gp_l1_reg_loss: 66299.5085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152673.7616; train_chrom_access_recon_loss: 2176712.2841; train_global_loss: 18223859.7576; train_optim_loss: 18223859.7576; val_kl_reg_loss: 89530.7324; val_edge_recon_loss: 3155264.7812; val_gene_expr_recon_loss: 12488979.5000; val_masked_gp_l1_reg_loss: 67765.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134016.5938; val_chrom_access_recon_loss: 2162799.3438; val_global_loss: 18098356.7500; val_optim_loss: 18098356.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8089; val_auprc_score: 0.7911; val_best_acc_score: 0.7176; val_best_f1_score: 0.7580; train_kl_reg_loss: 89371.3890; train_edge_recon_loss: 3048495.6629; train_gene_expr_recon_loss: 12512505.3636; train_masked_gp_l1_reg_loss: 69723.4688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125113.3454; train_chrom_access_recon_loss: 2159369.3920; train_global_loss: 18004578.6667; train_optim_loss: 18004578.6667; val_kl_reg_loss: 85331.4727; val_edge_recon_loss: 3056921.7812; val_gene_expr_recon_loss: 12394525.3750; val_masked_gp_l1_reg_loss: 71410.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117953.1016; val_chrom_access_recon_loss: 2137414.0312; val_global_loss: 17863555.7500; val_optim_loss: 17863555.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8381; val_auprc_score: 0.8032; val_best_acc_score: 0.7603; val_best_f1_score: 0.7895; train_kl_reg_loss: 95277.9097; train_edge_recon_loss: 2958709.4356; train_gene_expr_recon_loss: 12433028.6970; train_masked_gp_l1_reg_loss: 72546.3482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114843.0926; train_chrom_access_recon_loss: 2148156.0909; train_global_loss: 17822561.6364; train_optim_loss: 17822561.6364; val_kl_reg_loss: 95095.0801; val_edge_recon_loss: 2984518.6562; val_gene_expr_recon_loss: 12238147.7500; val_masked_gp_l1_reg_loss: 73951.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114408.9375; val_chrom_access_recon_loss: 2132083.9688; val_global_loss: 17638206.7500; val_optim_loss: 17638206.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8988; val_auprc_score: 0.8664; val_best_acc_score: 0.8297; val_best_f1_score: 0.8431; train_kl_reg_loss: 95122.9981; train_edge_recon_loss: 2873976.2348; train_gene_expr_recon_loss: 12364308.9545; train_masked_gp_l1_reg_loss: 75584.9283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113342.5913; train_chrom_access_recon_loss: 2137961.2405; train_global_loss: 17660297.0000; train_optim_loss: 17660297.0000; val_kl_reg_loss: 97806.7773; val_edge_recon_loss: 2856038.4375; val_gene_expr_recon_loss: 12364561.3750; val_masked_gp_l1_reg_loss: 77406.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112490.0078; val_chrom_access_recon_loss: 2146123.1562; val_global_loss: 17654426.2500; val_optim_loss: 17654426.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9042; val_auprc_score: 0.8697; val_best_acc_score: 0.8461; val_best_f1_score: 0.8552; train_kl_reg_loss: 97544.7061; train_edge_recon_loss: 2812274.4394; train_gene_expr_recon_loss: 12298115.2273; train_masked_gp_l1_reg_loss: 78556.8532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111743.6760; train_chrom_access_recon_loss: 2130046.7348; train_global_loss: 17528281.5303; train_optim_loss: 17528281.5303; val_kl_reg_loss: 96699.5068; val_edge_recon_loss: 2837711.4062; val_gene_expr_recon_loss: 12094039.2500; val_masked_gp_l1_reg_loss: 79510.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110781.3906; val_chrom_access_recon_loss: 2124086.4062; val_global_loss: 17342828.7500; val_optim_loss: 17342828.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9238; val_auprc_score: 0.9000; val_best_acc_score: 0.8659; val_best_f1_score: 0.8733; train_kl_reg_loss: 95928.8691; train_edge_recon_loss: 2791237.4280; train_gene_expr_recon_loss: 12239947.6818; train_masked_gp_l1_reg_loss: 80352.5187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110178.0272; train_chrom_access_recon_loss: 2121708.3561; train_global_loss: 17439352.8333; train_optim_loss: 17439352.8333; val_kl_reg_loss: 92249.3438; val_edge_recon_loss: 2779089.1875; val_gene_expr_recon_loss: 12074432.3750; val_masked_gp_l1_reg_loss: 81299.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110172.6719; val_chrom_access_recon_loss: 2111774.0156; val_global_loss: 17249016.7500; val_optim_loss: 17249016.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9214; val_auprc_score: 0.8884; val_best_acc_score: 0.8643; val_best_f1_score: 0.8693; train_kl_reg_loss: 97296.0598; train_edge_recon_loss: 2785869.3788; train_gene_expr_recon_loss: 12186901.4394; train_masked_gp_l1_reg_loss: 81997.4052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108955.1291; train_chrom_access_recon_loss: 2112478.5227; train_global_loss: 17373497.9242; train_optim_loss: 17373497.9242; val_kl_reg_loss: 93013.0869; val_edge_recon_loss: 2795794.2500; val_gene_expr_recon_loss: 12162618.5000; val_masked_gp_l1_reg_loss: 82675.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108530.5781; val_chrom_access_recon_loss: 2116784.7344; val_global_loss: 17359417.5000; val_optim_loss: 17359417.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9209; val_auprc_score: 0.8889; val_best_acc_score: 0.8581; val_best_f1_score: 0.8672; train_kl_reg_loss: 94725.0755; train_edge_recon_loss: 2771496.4848; train_gene_expr_recon_loss: 12132678.4545; train_masked_gp_l1_reg_loss: 83256.1420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107748.9238; train_chrom_access_recon_loss: 2106242.0852; train_global_loss: 17296147.2576; train_optim_loss: 17296147.2576; val_kl_reg_loss: 94681.7734; val_edge_recon_loss: 2828720.1250; val_gene_expr_recon_loss: 11984299.1250; val_masked_gp_l1_reg_loss: 83723.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106963.4844; val_chrom_access_recon_loss: 2092045.2812; val_global_loss: 17190432.7500; val_optim_loss: 17190432.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9233; val_auprc_score: 0.8927; val_best_acc_score: 0.8692; val_best_f1_score: 0.8752; train_kl_reg_loss: 93573.7781; train_edge_recon_loss: 2762496.4280; train_gene_expr_recon_loss: 12101989.2273; train_masked_gp_l1_reg_loss: 84148.6539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105746.1991; train_chrom_access_recon_loss: 2101486.1250; train_global_loss: 17249440.3333; train_optim_loss: 17249440.3333; val_kl_reg_loss: 91969.7256; val_edge_recon_loss: 2791640.8438; val_gene_expr_recon_loss: 11957180.6250; val_masked_gp_l1_reg_loss: 84674.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105326.0469; val_chrom_access_recon_loss: 2096034.7500; val_global_loss: 17126827.0000; val_optim_loss: 17126827.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9287; val_auprc_score: 0.8943; val_best_acc_score: 0.8756; val_best_f1_score: 0.8846; train_kl_reg_loss: 92645.8903; train_edge_recon_loss: 2771445.4432; train_gene_expr_recon_loss: 12059573.7879; train_masked_gp_l1_reg_loss: 85114.8724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104629.2846; train_chrom_access_recon_loss: 2092861.8939; train_global_loss: 17206271.3636; train_optim_loss: 17206271.3636; val_kl_reg_loss: 92653.6396; val_edge_recon_loss: 2784125.3438; val_gene_expr_recon_loss: 11929420.1250; val_masked_gp_l1_reg_loss: 85617.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104476.1797; val_chrom_access_recon_loss: 2077673.1406; val_global_loss: 17073965.3750; val_optim_loss: 17073965.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9287; val_auprc_score: 0.9040; val_best_acc_score: 0.8735; val_best_f1_score: 0.8796; train_kl_reg_loss: 91543.7294; train_edge_recon_loss: 2748375.8523; train_gene_expr_recon_loss: 12018230.7424; train_masked_gp_l1_reg_loss: 85871.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103891.1632; train_chrom_access_recon_loss: 2085036.9375; train_global_loss: 17132949.5606; train_optim_loss: 17132949.5606; val_kl_reg_loss: 86554.4121; val_edge_recon_loss: 2813347.9062; val_gene_expr_recon_loss: 11850144.6250; val_masked_gp_l1_reg_loss: 86357.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104833.0078; val_chrom_access_recon_loss: 2066954.4062; val_global_loss: 17008191.0000; val_optim_loss: 17008191.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9379; val_auprc_score: 0.9123; val_best_acc_score: 0.8812; val_best_f1_score: 0.8878; train_kl_reg_loss: 89306.4751; train_edge_recon_loss: 2744006.2803; train_gene_expr_recon_loss: 11993594.5303; train_masked_gp_l1_reg_loss: 86689.3071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104017.2881; train_chrom_access_recon_loss: 2081854.2405; train_global_loss: 17099468.1061; train_optim_loss: 17099468.1061; val_kl_reg_loss: 89772.1523; val_edge_recon_loss: 2773197.6562; val_gene_expr_recon_loss: 11854520.5000; val_masked_gp_l1_reg_loss: 87124.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104050.4688; val_chrom_access_recon_loss: 2061473.3438; val_global_loss: 16970139.1250; val_optim_loss: 16970139.1250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9319; val_auprc_score: 0.9105; val_best_acc_score: 0.8772; val_best_f1_score: 0.8833; train_kl_reg_loss: 89879.4439; train_edge_recon_loss: 2741574.3409; train_gene_expr_recon_loss: 11953793.0758; train_masked_gp_l1_reg_loss: 87395.2929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103665.9508; train_chrom_access_recon_loss: 2076247.0947; train_global_loss: 17052555.2879; train_optim_loss: 17052555.2879; val_kl_reg_loss: 90302.0752; val_edge_recon_loss: 2785342.1250; val_gene_expr_recon_loss: 11889240.6250; val_masked_gp_l1_reg_loss: 87623.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103629.3672; val_chrom_access_recon_loss: 2075575.8281; val_global_loss: 17031713.8750; val_optim_loss: 17031713.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9394; val_auprc_score: 0.9172; val_best_acc_score: 0.8837; val_best_f1_score: 0.8899; train_kl_reg_loss: 89254.7301; train_edge_recon_loss: 2735995.1477; train_gene_expr_recon_loss: 11932686.5606; train_masked_gp_l1_reg_loss: 87922.6948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103043.4955; train_chrom_access_recon_loss: 2072367.2860; train_global_loss: 17021269.7879; train_optim_loss: 17021269.7879; val_kl_reg_loss: 88153.6416; val_edge_recon_loss: 2786101.6875; val_gene_expr_recon_loss: 11896262.8750; val_masked_gp_l1_reg_loss: 88132.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103161.7266; val_chrom_access_recon_loss: 2070184.6406; val_global_loss: 17031997.8750; val_optim_loss: 17031997.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9388; val_auprc_score: 0.9177; val_best_acc_score: 0.8837; val_best_f1_score: 0.8908; train_kl_reg_loss: 90094.2776; train_edge_recon_loss: 2742141.4356; train_gene_expr_recon_loss: 11901397.8939; train_masked_gp_l1_reg_loss: 88309.9343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102660.6768; train_chrom_access_recon_loss: 2064895.6856; train_global_loss: 16989499.7121; train_optim_loss: 16989499.7121; val_kl_reg_loss: 85548.2256; val_edge_recon_loss: 2782954.1250; val_gene_expr_recon_loss: 11763863.8750; val_masked_gp_l1_reg_loss: 88702.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102921.0703; val_chrom_access_recon_loss: 2050042.7656; val_global_loss: 16874033.0000; val_optim_loss: 16874033.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9440; val_auprc_score: 0.9264; val_best_acc_score: 0.8853; val_best_f1_score: 0.8893; train_kl_reg_loss: 86374.7450; train_edge_recon_loss: 2737591.1629; train_gene_expr_recon_loss: 11878159.3030; train_masked_gp_l1_reg_loss: 88686.0062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102225.0973; train_chrom_access_recon_loss: 2061442.8864; train_global_loss: 16954479.0000; train_optim_loss: 16954479.0000; val_kl_reg_loss: 84167.1797; val_edge_recon_loss: 2766226.2500; val_gene_expr_recon_loss: 11651483.8750; val_masked_gp_l1_reg_loss: 88939.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102448.5000; val_chrom_access_recon_loss: 2047517.7031; val_global_loss: 16740782.5000; val_optim_loss: 16740782.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9429; val_auprc_score: 0.9218; val_best_acc_score: 0.8907; val_best_f1_score: 0.8967; train_kl_reg_loss: 86806.4924; train_edge_recon_loss: 2731828.3068; train_gene_expr_recon_loss: 11839475.7424; train_masked_gp_l1_reg_loss: 89233.7331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102314.2350; train_chrom_access_recon_loss: 2055452.4811; train_global_loss: 16905111.0455; train_optim_loss: 16905111.0455; val_kl_reg_loss: 86289.8271; val_edge_recon_loss: 2735277.6250; val_gene_expr_recon_loss: 11729812.7500; val_masked_gp_l1_reg_loss: 89280.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101473.2109; val_chrom_access_recon_loss: 2056747.1875; val_global_loss: 16798881.7500; val_optim_loss: 16798881.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9509; val_auprc_score: 0.9331; val_best_acc_score: 0.8979; val_best_f1_score: 0.9020; train_kl_reg_loss: 85567.7934; train_edge_recon_loss: 2726962.3106; train_gene_expr_recon_loss: 11823077.0303; train_masked_gp_l1_reg_loss: 89467.1477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101680.1083; train_chrom_access_recon_loss: 2051164.7197; train_global_loss: 16877919.0909; train_optim_loss: 16877919.0909; val_kl_reg_loss: 83512.1768; val_edge_recon_loss: 2739817.7500; val_gene_expr_recon_loss: 11817740.2500; val_masked_gp_l1_reg_loss: 89693.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101543.6562; val_chrom_access_recon_loss: 2059739.0156; val_global_loss: 16892047.2500; val_optim_loss: 16892047.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9514; val_auprc_score: 0.9357; val_best_acc_score: 0.8960; val_best_f1_score: 0.9003; train_kl_reg_loss: 84407.9345; train_edge_recon_loss: 2723415.9356; train_gene_expr_recon_loss: 11791402.0303; train_masked_gp_l1_reg_loss: 89874.4972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101764.4477; train_chrom_access_recon_loss: 2044422.9981; train_global_loss: 16835287.6970; train_optim_loss: 16835287.6970; val_kl_reg_loss: 85095.4766; val_edge_recon_loss: 2731920.2500; val_gene_expr_recon_loss: 11671877.8750; val_masked_gp_l1_reg_loss: 90048.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101772.8516; val_chrom_access_recon_loss: 2034486.3594; val_global_loss: 16715202.0000; val_optim_loss: 16715202.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9480; val_auprc_score: 0.9258; val_best_acc_score: 0.8992; val_best_f1_score: 0.9044; train_kl_reg_loss: 85207.3878; train_edge_recon_loss: 2727577.9432; train_gene_expr_recon_loss: 11773554.0000; train_masked_gp_l1_reg_loss: 90101.4595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101495.5993; train_chrom_access_recon_loss: 2041829.9261; train_global_loss: 16819766.4545; train_optim_loss: 16819766.4545; val_kl_reg_loss: 82695.1768; val_edge_recon_loss: 2738185.4688; val_gene_expr_recon_loss: 11636364.1250; val_masked_gp_l1_reg_loss: 90104.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100973.0625; val_chrom_access_recon_loss: 2032714.3438; val_global_loss: 16681037.3750; val_optim_loss: 16681037.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9443; val_auprc_score: 0.9237; val_best_acc_score: 0.8960; val_best_f1_score: 0.9010; train_kl_reg_loss: 86776.6777; train_edge_recon_loss: 2706463.0492; train_gene_expr_recon_loss: 11753348.1061; train_masked_gp_l1_reg_loss: 90223.6210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100947.3376; train_chrom_access_recon_loss: 2038683.0852; train_global_loss: 16776441.9091; train_optim_loss: 16776441.9091; val_kl_reg_loss: 83530.4727; val_edge_recon_loss: 2770026.4688; val_gene_expr_recon_loss: 11610679.1250; val_masked_gp_l1_reg_loss: 90359.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100739.6484; val_chrom_access_recon_loss: 2041482.8125; val_global_loss: 16696818.6250; val_optim_loss: 16696818.6250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9519; val_auprc_score: 0.9298; val_best_acc_score: 0.9052; val_best_f1_score: 0.9093; train_kl_reg_loss: 85087.1999; train_edge_recon_loss: 2719445.4697; train_gene_expr_recon_loss: 11736578.9242; train_masked_gp_l1_reg_loss: 90350.8572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100720.5534; train_chrom_access_recon_loss: 2036240.3390; train_global_loss: 16768423.2879; train_optim_loss: 16768423.2879; val_kl_reg_loss: 83021.1895; val_edge_recon_loss: 2720158.1562; val_gene_expr_recon_loss: 11660393.3750; val_masked_gp_l1_reg_loss: 90403.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101445.4375; val_chrom_access_recon_loss: 2031340.3281; val_global_loss: 16686761.0000; val_optim_loss: 16686761.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9491; val_auprc_score: 0.9270; val_best_acc_score: 0.8982; val_best_f1_score: 0.9016; train_kl_reg_loss: 84015.1451; train_edge_recon_loss: 2718090.7652; train_gene_expr_recon_loss: 11701651.5909; train_masked_gp_l1_reg_loss: 90520.5504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101020.2237; train_chrom_access_recon_loss: 2027929.1780; train_global_loss: 16723227.3788; train_optim_loss: 16723227.3788; val_kl_reg_loss: 84282.4736; val_edge_recon_loss: 2745165.8438; val_gene_expr_recon_loss: 11635703.7500; val_masked_gp_l1_reg_loss: 90509.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100715.9297; val_chrom_access_recon_loss: 2027820.6875; val_global_loss: 16684197.7500; val_optim_loss: 16684197.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9520; val_auprc_score: 0.9332; val_best_acc_score: 0.9009; val_best_f1_score: 0.9053; train_kl_reg_loss: 84048.6065; train_edge_recon_loss: 2716598.5227; train_gene_expr_recon_loss: 11687721.9091; train_masked_gp_l1_reg_loss: 90525.8267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100484.9638; train_chrom_access_recon_loss: 2026569.6742; train_global_loss: 16705949.4091; train_optim_loss: 16705949.4091; val_kl_reg_loss: 81607.9189; val_edge_recon_loss: 2722881.9375; val_gene_expr_recon_loss: 11599123.0000; val_masked_gp_l1_reg_loss: 90673.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101057.1719; val_chrom_access_recon_loss: 2014332.0781; val_global_loss: 16609675.1250; val_optim_loss: 16609675.1250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9515; val_auprc_score: 0.9370; val_best_acc_score: 0.9033; val_best_f1_score: 0.9080; train_kl_reg_loss: 84143.7160; train_edge_recon_loss: 2706777.4129; train_gene_expr_recon_loss: 11680044.8636; train_masked_gp_l1_reg_loss: 90697.9099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100633.7654; train_chrom_access_recon_loss: 2025395.4640; train_global_loss: 16687693.0303; train_optim_loss: 16687693.0303; val_kl_reg_loss: 83525.2939; val_edge_recon_loss: 2752284.6562; val_gene_expr_recon_loss: 11549515.3750; val_masked_gp_l1_reg_loss: 90756.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100405.5938; val_chrom_access_recon_loss: 2014476.7656; val_global_loss: 16590965.1250; val_optim_loss: 16590965.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9571; val_auprc_score: 0.9419; val_best_acc_score: 0.9116; val_best_f1_score: 0.9146; train_kl_reg_loss: 82744.8129; train_edge_recon_loss: 2709544.1250; train_gene_expr_recon_loss: 11662523.0152; train_masked_gp_l1_reg_loss: 90675.1629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100184.6398; train_chrom_access_recon_loss: 2019740.9091; train_global_loss: 16665412.7879; train_optim_loss: 16665412.7879; val_kl_reg_loss: 82531.9600; val_edge_recon_loss: 2711423.2500; val_gene_expr_recon_loss: 11514746.0000; val_masked_gp_l1_reg_loss: 90894.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101183.1250; val_chrom_access_recon_loss: 2009076.5781; val_global_loss: 16509855.7500; val_optim_loss: 16509855.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9530; val_auprc_score: 0.9338; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 82459.5826; train_edge_recon_loss: 2709609.8826; train_gene_expr_recon_loss: 11646784.2879; train_masked_gp_l1_reg_loss: 90819.4633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100456.1115; train_chrom_access_recon_loss: 2017686.4659; train_global_loss: 16647815.7121; train_optim_loss: 16647815.7121; val_kl_reg_loss: 82512.5322; val_edge_recon_loss: 2736239.4062; val_gene_expr_recon_loss: 11541938.3750; val_masked_gp_l1_reg_loss: 90715.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100024.7969; val_chrom_access_recon_loss: 2025070.1562; val_global_loss: 16576500.6250; val_optim_loss: 16576500.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9591; val_auprc_score: 0.9442; val_best_acc_score: 0.9127; val_best_f1_score: 0.9158; train_kl_reg_loss: 82816.2647; train_edge_recon_loss: 2716372.2955; train_gene_expr_recon_loss: 11630368.0606; train_masked_gp_l1_reg_loss: 90752.3615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100001.9946; train_chrom_access_recon_loss: 2014181.1761; train_global_loss: 16634492.1970; train_optim_loss: 16634492.1970; val_kl_reg_loss: 83108.3516; val_edge_recon_loss: 2701240.6250; val_gene_expr_recon_loss: 11549887.3750; val_masked_gp_l1_reg_loss: 90769.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99467.6406; val_chrom_access_recon_loss: 2015851.9688; val_global_loss: 16540325.0000; val_optim_loss: 16540325.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9496; val_auprc_score: 0.9259; val_best_acc_score: 0.8974; val_best_f1_score: 0.9023; train_kl_reg_loss: 82721.0343; train_edge_recon_loss: 2708233.7652; train_gene_expr_recon_loss: 11610041.6515; train_masked_gp_l1_reg_loss: 90628.8544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99252.4545; train_chrom_access_recon_loss: 2009546.2311; train_global_loss: 16600424.0000; train_optim_loss: 16600424.0000; val_kl_reg_loss: 83957.4219; val_edge_recon_loss: 2744596.0312; val_gene_expr_recon_loss: 11477801.0000; val_masked_gp_l1_reg_loss: 90537.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99252.0781; val_chrom_access_recon_loss: 1995719.2812; val_global_loss: 16491863.7500; val_optim_loss: 16491863.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9613; val_auprc_score: 0.9447; val_best_acc_score: 0.9183; val_best_f1_score: 0.9204; train_kl_reg_loss: 82554.5836; train_edge_recon_loss: 2702843.9962; train_gene_expr_recon_loss: 11610084.5303; train_masked_gp_l1_reg_loss: 90474.2411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99138.2095; train_chrom_access_recon_loss: 2010249.7898; train_global_loss: 16595345.3485; train_optim_loss: 16595345.3485; val_kl_reg_loss: 83276.3027; val_edge_recon_loss: 2715298.3750; val_gene_expr_recon_loss: 11617080.0000; val_masked_gp_l1_reg_loss: 90444.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99153.5859; val_chrom_access_recon_loss: 2006427.6875; val_global_loss: 16611680.3750; val_optim_loss: 16611680.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9574; val_auprc_score: 0.9415; val_best_acc_score: 0.9087; val_best_f1_score: 0.9118; train_kl_reg_loss: 81368.5589; train_edge_recon_loss: 2695447.8939; train_gene_expr_recon_loss: 11586243.7576; train_masked_gp_l1_reg_loss: 90322.3936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98819.1503; train_chrom_access_recon_loss: 2005624.7443; train_global_loss: 16557826.5455; train_optim_loss: 16557826.5455; val_kl_reg_loss: 77700.2168; val_edge_recon_loss: 2701226.0000; val_gene_expr_recon_loss: 11411348.6250; val_masked_gp_l1_reg_loss: 90364.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98662.2188; val_chrom_access_recon_loss: 1986002.6719; val_global_loss: 16365303.5000; val_optim_loss: 16365303.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9564; val_auprc_score: 0.9370; val_best_acc_score: 0.9084; val_best_f1_score: 0.9115; train_kl_reg_loss: 79530.5518; train_edge_recon_loss: 2716324.0682; train_gene_expr_recon_loss: 11583943.0909; train_masked_gp_l1_reg_loss: 90299.3935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98347.0193; train_chrom_access_recon_loss: 2005002.0284; train_global_loss: 16573446.0909; train_optim_loss: 16573446.0909; val_kl_reg_loss: 80910.0654; val_edge_recon_loss: 2715962.9688; val_gene_expr_recon_loss: 11475338.3750; val_masked_gp_l1_reg_loss: 90321.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98600.3281; val_chrom_access_recon_loss: 1981577.8438; val_global_loss: 16442711.3750; val_optim_loss: 16442711.3750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9568; val_auprc_score: 0.9427; val_best_acc_score: 0.9041; val_best_f1_score: 0.9070; train_kl_reg_loss: 81327.0170; train_edge_recon_loss: 2698527.5455; train_gene_expr_recon_loss: 11567335.2121; train_masked_gp_l1_reg_loss: 90183.3277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97838.3406; train_chrom_access_recon_loss: 2000884.3580; train_global_loss: 16536095.7121; train_optim_loss: 16536095.7121; val_kl_reg_loss: 81408.1748; val_edge_recon_loss: 2743231.8750; val_gene_expr_recon_loss: 11505076.3750; val_masked_gp_l1_reg_loss: 90188.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97854.8516; val_chrom_access_recon_loss: 2004400.9219; val_global_loss: 16522161.3750; val_optim_loss: 16522161.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9592; val_auprc_score: 0.9420; val_best_acc_score: 0.9130; val_best_f1_score: 0.9140; train_kl_reg_loss: 79773.9054; train_edge_recon_loss: 2702173.8333; train_gene_expr_recon_loss: 11543576.7576; train_masked_gp_l1_reg_loss: 90130.6922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97384.9912; train_chrom_access_recon_loss: 1996261.4015; train_global_loss: 16509301.5758; train_optim_loss: 16509301.5758; val_kl_reg_loss: 80185.7529; val_edge_recon_loss: 2714544.2500; val_gene_expr_recon_loss: 11390723.2500; val_masked_gp_l1_reg_loss: 90167.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97284.0391; val_chrom_access_recon_loss: 1961618.5469; val_global_loss: 16334523.7500; val_optim_loss: 16334523.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9616; val_auprc_score: 0.9482; val_best_acc_score: 0.9140; val_best_f1_score: 0.9161; train_kl_reg_loss: 80305.6790; train_edge_recon_loss: 2693850.3977; train_gene_expr_recon_loss: 11533662.8030; train_masked_gp_l1_reg_loss: 90014.6016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96698.3862; train_chrom_access_recon_loss: 1994928.7159; train_global_loss: 16489460.6212; train_optim_loss: 16489460.6212; val_kl_reg_loss: 80331.9639; val_edge_recon_loss: 2705760.5938; val_gene_expr_recon_loss: 11581911.0000; val_masked_gp_l1_reg_loss: 90028.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96750.7109; val_chrom_access_recon_loss: 2026458.4219; val_global_loss: 16581241.0000; val_optim_loss: 16581241.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9576; val_auprc_score: 0.9395; val_best_acc_score: 0.9121; val_best_f1_score: 0.9143; train_kl_reg_loss: 79102.2863; train_edge_recon_loss: 2706814.0341; train_gene_expr_recon_loss: 11531412.5455; train_masked_gp_l1_reg_loss: 89936.4925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96309.6024; train_chrom_access_recon_loss: 1994307.4299; train_global_loss: 16497882.5909; train_optim_loss: 16497882.5909; val_kl_reg_loss: 76366.2998; val_edge_recon_loss: 2736717.0000; val_gene_expr_recon_loss: 11435444.1250; val_masked_gp_l1_reg_loss: 89998.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96395.7031; val_chrom_access_recon_loss: 1991655.4531; val_global_loss: 16426578.0000; val_optim_loss: 16426578.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9493; val_auprc_score: 0.9278; val_best_acc_score: 0.8992; val_best_f1_score: 0.9032; train_kl_reg_loss: 78908.7107; train_edge_recon_loss: 2688144.8333; train_gene_expr_recon_loss: 11518963.7879; train_masked_gp_l1_reg_loss: 89924.8340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95658.1114; train_chrom_access_recon_loss: 1991688.2652; train_global_loss: 16463288.4242; train_optim_loss: 16463288.4242; val_kl_reg_loss: 78173.2637; val_edge_recon_loss: 2762524.9375; val_gene_expr_recon_loss: 11443753.5000; val_masked_gp_l1_reg_loss: 89992.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96102.2422; val_chrom_access_recon_loss: 1992771.9531; val_global_loss: 16463318.6250; val_optim_loss: 16463318.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9579; val_auprc_score: 0.9408; val_best_acc_score: 0.9087; val_best_f1_score: 0.9109; train_kl_reg_loss: 78588.3061; train_edge_recon_loss: 2699115.0455; train_gene_expr_recon_loss: 11505331.2424; train_masked_gp_l1_reg_loss: 89849.0268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95694.7804; train_chrom_access_recon_loss: 1989886.0739; train_global_loss: 16458464.4394; train_optim_loss: 16458464.4394; val_kl_reg_loss: 77650.2109; val_edge_recon_loss: 2727501.1250; val_gene_expr_recon_loss: 11442296.6250; val_masked_gp_l1_reg_loss: 89729.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95024.4297; val_chrom_access_recon_loss: 1984405.6875; val_global_loss: 16416606.8750; val_optim_loss: 16416606.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9565; val_auprc_score: 0.9347; val_best_acc_score: 0.9092; val_best_f1_score: 0.9123; train_kl_reg_loss: 78809.5772; train_edge_recon_loss: 2692410.6932; train_gene_expr_recon_loss: 11495468.5303; train_masked_gp_l1_reg_loss: 88747.0327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75695.6919; train_chrom_access_recon_loss: 1986179.7670; train_global_loss: 16417311.3030; train_optim_loss: 16417311.3030; val_kl_reg_loss: 80314.9404; val_edge_recon_loss: 2721637.5312; val_gene_expr_recon_loss: 11501720.7500; val_masked_gp_l1_reg_loss: 88317.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71066.5469; val_chrom_access_recon_loss: 1988691.2500; val_global_loss: 16451748.3750; val_optim_loss: 16451748.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9623; val_auprc_score: 0.9452; val_best_acc_score: 0.9089; val_best_f1_score: 0.9109; train_kl_reg_loss: 80373.4323; train_edge_recon_loss: 2685189.0303; train_gene_expr_recon_loss: 11483147.2879; train_masked_gp_l1_reg_loss: 88258.8331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70504.6596; train_chrom_access_recon_loss: 1983650.4564; train_global_loss: 16391123.6212; train_optim_loss: 16391123.6212; val_kl_reg_loss: 80681.2500; val_edge_recon_loss: 2712958.9375; val_gene_expr_recon_loss: 11471759.0000; val_masked_gp_l1_reg_loss: 88210.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70069.4922; val_chrom_access_recon_loss: 1987153.6094; val_global_loss: 16410832.3750; val_optim_loss: 16410832.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9601; val_auprc_score: 0.9426; val_best_acc_score: 0.9095; val_best_f1_score: 0.9115; train_kl_reg_loss: 81456.1547; train_edge_recon_loss: 2685522.1818; train_gene_expr_recon_loss: 11490529.1667; train_masked_gp_l1_reg_loss: 88188.5688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69820.1416; train_chrom_access_recon_loss: 1985799.2292; train_global_loss: 16401315.3788; train_optim_loss: 16401315.3788; val_kl_reg_loss: 81440.0723; val_edge_recon_loss: 2734794.2188; val_gene_expr_recon_loss: 11310155.3750; val_masked_gp_l1_reg_loss: 88176.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69630.6484; val_chrom_access_recon_loss: 1972857.2188; val_global_loss: 16257053.6250; val_optim_loss: 16257053.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9606; val_auprc_score: 0.9461; val_best_acc_score: 0.9116; val_best_f1_score: 0.9143; train_kl_reg_loss: 81390.2932; train_edge_recon_loss: 2690879.7917; train_gene_expr_recon_loss: 11483670.5000; train_masked_gp_l1_reg_loss: 88159.9904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69460.7678; train_chrom_access_recon_loss: 1982897.2955; train_global_loss: 16396458.6667; train_optim_loss: 16396458.6667; val_kl_reg_loss: 81790.9746; val_edge_recon_loss: 2704432.2188; val_gene_expr_recon_loss: 11481738.2500; val_masked_gp_l1_reg_loss: 88159.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69315.8047; val_chrom_access_recon_loss: 1987582.6094; val_global_loss: 16413020.2500; val_optim_loss: 16413020.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9597; val_auprc_score: 0.9457; val_best_acc_score: 0.9135; val_best_f1_score: 0.9161; train_kl_reg_loss: 81056.1474; train_edge_recon_loss: 2689651.8750; train_gene_expr_recon_loss: 11480861.6515; train_masked_gp_l1_reg_loss: 88140.0900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69175.9077; train_chrom_access_recon_loss: 1983693.2121; train_global_loss: 16392578.7879; train_optim_loss: 16392578.7879; val_kl_reg_loss: 81200.5244; val_edge_recon_loss: 2720764.0312; val_gene_expr_recon_loss: 11426350.3750; val_masked_gp_l1_reg_loss: 88119.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68956.3750; val_chrom_access_recon_loss: 1996875.5312; val_global_loss: 16382265.5000; val_optim_loss: 16382265.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9536; val_auprc_score: 0.9327; val_best_acc_score: 0.9089; val_best_f1_score: 0.9119; train_kl_reg_loss: 81493.3198; train_edge_recon_loss: 2689405.3371; train_gene_expr_recon_loss: 11477413.9545; train_masked_gp_l1_reg_loss: 88109.6883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68841.7199; train_chrom_access_recon_loss: 1984121.2538; train_global_loss: 16389385.2879; train_optim_loss: 16389385.2879; val_kl_reg_loss: 81898.0996; val_edge_recon_loss: 2722761.4688; val_gene_expr_recon_loss: 11429945.5000; val_masked_gp_l1_reg_loss: 88120.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68685.8828; val_chrom_access_recon_loss: 2000711.8906; val_global_loss: 16392122.7500; val_optim_loss: 16392122.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9605; val_auprc_score: 0.9461; val_best_acc_score: 0.9095; val_best_f1_score: 0.9124; train_kl_reg_loss: 81574.7718; train_edge_recon_loss: 2692543.4621; train_gene_expr_recon_loss: 11477314.8030; train_masked_gp_l1_reg_loss: 88090.3153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68642.3400; train_chrom_access_recon_loss: 1981198.0947; train_global_loss: 16389363.7879; train_optim_loss: 16389363.7879; val_kl_reg_loss: 81745.9521; val_edge_recon_loss: 2689362.4688; val_gene_expr_recon_loss: 11397961.1250; val_masked_gp_l1_reg_loss: 88082.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68495.2656; val_chrom_access_recon_loss: 1978258.1719; val_global_loss: 16303904.5000; val_optim_loss: 16303904.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9558; val_auprc_score: 0.9354; val_best_acc_score: 0.9095; val_best_f1_score: 0.9121; train_kl_reg_loss: 81346.8424; train_edge_recon_loss: 2686641.5530; train_gene_expr_recon_loss: 11487427.4091; train_masked_gp_l1_reg_loss: 87965.6527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66591.6707; train_chrom_access_recon_loss: 1982119.3580; train_global_loss: 16392092.5152; train_optim_loss: 16392092.5152; val_kl_reg_loss: 81453.0820; val_edge_recon_loss: 2714731.9688; val_gene_expr_recon_loss: 11511505.1250; val_masked_gp_l1_reg_loss: 87908.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66139.1719; val_chrom_access_recon_loss: 2000894.8906; val_global_loss: 16462633.1250; val_optim_loss: 16462633.1250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9583; val_auprc_score: 0.9371; val_best_acc_score: 0.9087; val_best_f1_score: 0.9116; train_kl_reg_loss: 81261.9676; train_edge_recon_loss: 2700016.8826; train_gene_expr_recon_loss: 11476084.8636; train_masked_gp_l1_reg_loss: 87894.4825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66057.5798; train_chrom_access_recon_loss: 1981609.8542; train_global_loss: 16392925.6061; train_optim_loss: 16392925.6061; val_kl_reg_loss: 81212.8760; val_edge_recon_loss: 2730470.6250; val_gene_expr_recon_loss: 11314397.0000; val_masked_gp_l1_reg_loss: 87886.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65989.7344; val_chrom_access_recon_loss: 1970775.9062; val_global_loss: 16250732.2500; val_optim_loss: 16250732.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9610; val_auprc_score: 0.9415; val_best_acc_score: 0.9151; val_best_f1_score: 0.9174; train_kl_reg_loss: 81356.1670; train_edge_recon_loss: 2681164.9318; train_gene_expr_recon_loss: 11476227.1515; train_masked_gp_l1_reg_loss: 87880.6483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65954.4706; train_chrom_access_recon_loss: 1982212.8580; train_global_loss: 16374796.2727; train_optim_loss: 16374796.2727; val_kl_reg_loss: 81336.3555; val_edge_recon_loss: 2705296.1875; val_gene_expr_recon_loss: 11440374.8750; val_masked_gp_l1_reg_loss: 87876.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65910.5859; val_chrom_access_recon_loss: 1988074.3594; val_global_loss: 16368869.8750; val_optim_loss: 16368869.8750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9579; val_auprc_score: 0.9382; val_best_acc_score: 0.9054; val_best_f1_score: 0.9102; train_kl_reg_loss: 81221.0658; train_edge_recon_loss: 2686607.1591; train_gene_expr_recon_loss: 11483746.5909; train_masked_gp_l1_reg_loss: 87873.4505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65882.2558; train_chrom_access_recon_loss: 1982723.6326; train_global_loss: 16388054.2121; train_optim_loss: 16388054.2121; val_kl_reg_loss: 81794.8252; val_edge_recon_loss: 2728971.8125; val_gene_expr_recon_loss: 11499553.2500; val_masked_gp_l1_reg_loss: 87869.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65853.2969; val_chrom_access_recon_loss: 1989863.4531; val_global_loss: 16453905.2500; val_optim_loss: 16453905.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9605; val_auprc_score: 0.9448; val_best_acc_score: 0.9105; val_best_f1_score: 0.9131; train_kl_reg_loss: 81171.2944; train_edge_recon_loss: 2693359.5455; train_gene_expr_recon_loss: 11476196.5455; train_masked_gp_l1_reg_loss: 87865.6947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65823.3079; train_chrom_access_recon_loss: 1982413.7159; train_global_loss: 16386830.0909; train_optim_loss: 16386830.0909; val_kl_reg_loss: 81884.3906; val_edge_recon_loss: 2738071.3438; val_gene_expr_recon_loss: 11396411.2500; val_masked_gp_l1_reg_loss: 87863.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65803.6953; val_chrom_access_recon_loss: 1971734.7656; val_global_loss: 16341768.7500; val_optim_loss: 16341768.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9605; val_auprc_score: 0.9453; val_best_acc_score: 0.9111; val_best_f1_score: 0.9131; train_kl_reg_loss: 81537.6540; train_edge_recon_loss: 2677665.4735; train_gene_expr_recon_loss: 11481082.8939; train_masked_gp_l1_reg_loss: 87862.4641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65788.5009; train_chrom_access_recon_loss: 1983055.8011; train_global_loss: 16376992.8939; train_optim_loss: 16376992.8939; val_kl_reg_loss: 81476.8301; val_edge_recon_loss: 2715897.1875; val_gene_expr_recon_loss: 11434305.8750; val_masked_gp_l1_reg_loss: 87862.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65763.3594; val_chrom_access_recon_loss: 1969082.6250; val_global_loss: 16354387.7500; val_optim_loss: 16354387.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9604; val_auprc_score: 0.9498; val_best_acc_score: 0.9095; val_best_f1_score: 0.9114; train_kl_reg_loss: 81450.5221; train_edge_recon_loss: 2684276.4962; train_gene_expr_recon_loss: 11477771.3485; train_masked_gp_l1_reg_loss: 87851.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65575.7121; train_chrom_access_recon_loss: 1981885.8542; train_global_loss: 16378811.8182; train_optim_loss: 16378811.8182; val_kl_reg_loss: 81559.0449; val_edge_recon_loss: 2715079.1250; val_gene_expr_recon_loss: 11358886.8750; val_masked_gp_l1_reg_loss: 87846.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65532.3242; val_chrom_access_recon_loss: 1974619.0625; val_global_loss: 16283522.1250; val_optim_loss: 16283522.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9615; val_auprc_score: 0.9461; val_best_acc_score: 0.9092; val_best_f1_score: 0.9134; train_kl_reg_loss: 81466.8667; train_edge_recon_loss: 2686456.7348; train_gene_expr_recon_loss: 11480128.4394; train_masked_gp_l1_reg_loss: 87843.9579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65524.8102; train_chrom_access_recon_loss: 1982020.3466; train_global_loss: 16383441.3333; train_optim_loss: 16383441.3333; val_kl_reg_loss: 81055.2764; val_edge_recon_loss: 2706432.8750; val_gene_expr_recon_loss: 11375287.1250; val_masked_gp_l1_reg_loss: 87842.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65518.3398; val_chrom_access_recon_loss: 1976669.7969; val_global_loss: 16292806.2500; val_optim_loss: 16292806.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9580; val_auprc_score: 0.9341; val_best_acc_score: 0.9130; val_best_f1_score: 0.9154; train_kl_reg_loss: 81431.2266; train_edge_recon_loss: 2676553.6629; train_gene_expr_recon_loss: 11483262.5152; train_masked_gp_l1_reg_loss: 87842.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65513.8835; train_chrom_access_recon_loss: 1981332.0985; train_global_loss: 16375935.5000; train_optim_loss: 16375935.5000; val_kl_reg_loss: 81517.7881; val_edge_recon_loss: 2697917.4375; val_gene_expr_recon_loss: 11354128.1250; val_masked_gp_l1_reg_loss: 87841.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65509.4375; val_chrom_access_recon_loss: 1985171.4844; val_global_loss: 16272084.7500; val_optim_loss: 16272084.7500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9565; val_auprc_score: 0.9366; val_best_acc_score: 0.9060; val_best_f1_score: 0.9090; train_kl_reg_loss: 81389.4408; train_edge_recon_loss: 2686127.4015; train_gene_expr_recon_loss: 11468790.7727; train_masked_gp_l1_reg_loss: 87840.6346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65505.2397; train_chrom_access_recon_loss: 1981631.7614; train_global_loss: 16371285.3485; train_optim_loss: 16371285.3485; val_kl_reg_loss: 82175.7080; val_edge_recon_loss: 2716362.6250; val_gene_expr_recon_loss: 11355971.0000; val_masked_gp_l1_reg_loss: 87840.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65502.0352; val_chrom_access_recon_loss: 1992193.7500; val_global_loss: 16300045.1250; val_optim_loss: 16300045.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 49 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9547
val AUPRC score: 0.9394
val best accuracy score: 0.9041
val best F1 score: 0.9074
val target rna MSE score: 1.2151
val source rna MSE score: 0.5996
val target atac MSE score: 0.3195
val source atac MSE score: 0.1295
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
