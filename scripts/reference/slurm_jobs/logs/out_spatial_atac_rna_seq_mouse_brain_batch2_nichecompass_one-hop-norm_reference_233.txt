[True]
Run timestamp: 10102023_102714_233.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_233']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7691; val_auprc_score: 0.7944; val_best_acc_score: 0.5636; val_best_f1_score: 0.6916; train_kl_reg_loss: 82849.8941; train_edge_recon_loss: 746978.6608; train_gene_expr_recon_loss: 22005989.2824; train_masked_gp_l1_reg_loss: 58446.5518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4033609.3802; train_chrom_access_recon_loss: 2857047.1126; train_global_loss: 29784920.9618; train_optim_loss: 29784920.9618; val_kl_reg_loss: 77302.6526; val_edge_recon_loss: 812358.4083; val_gene_expr_recon_loss: 20821278.4000; val_masked_gp_l1_reg_loss: 61412.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 992581.8750; val_chrom_access_recon_loss: 2719058.3667; val_global_loss: 25483992.1333; val_optim_loss: 25483992.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8708; val_auprc_score: 0.8709; val_best_acc_score: 0.7530; val_best_f1_score: 0.7799; train_kl_reg_loss: 76202.5307; train_edge_recon_loss: 732346.5954; train_gene_expr_recon_loss: 20851135.6489; train_masked_gp_l1_reg_loss: 62995.5718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 511131.8690; train_chrom_access_recon_loss: 2763666.5382; train_global_loss: 24997478.6107; train_optim_loss: 24997478.6107; val_kl_reg_loss: 61815.3750; val_edge_recon_loss: 783066.7417; val_gene_expr_recon_loss: 20524038.9333; val_masked_gp_l1_reg_loss: 64785.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 287397.7812; val_chrom_access_recon_loss: 2687904.6000; val_global_loss: 24409009.7333; val_optim_loss: 24409009.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9200; val_auprc_score: 0.9089; val_best_acc_score: 0.8403; val_best_f1_score: 0.8494; train_kl_reg_loss: 69596.6040; train_edge_recon_loss: 689682.7385; train_gene_expr_recon_loss: 20557061.7557; train_masked_gp_l1_reg_loss: 67106.0312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231361.3168; train_chrom_access_recon_loss: 2731084.5553; train_global_loss: 24345893.0076; train_optim_loss: 24345893.0076; val_kl_reg_loss: 72476.9479; val_edge_recon_loss: 647255.2333; val_gene_expr_recon_loss: 20211860.6667; val_masked_gp_l1_reg_loss: 69732.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190209.0625; val_chrom_access_recon_loss: 2654926.5833; val_global_loss: 23846461.3333; val_optim_loss: 23846461.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9190; val_auprc_score: 0.9040; val_best_acc_score: 0.8437; val_best_f1_score: 0.8537; train_kl_reg_loss: 77540.9965; train_edge_recon_loss: 628271.4738; train_gene_expr_recon_loss: 20350451.1908; train_masked_gp_l1_reg_loss: 72205.9423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172958.8432; train_chrom_access_recon_loss: 2708926.8550; train_global_loss: 24010355.3893; train_optim_loss: 24010355.3893; val_kl_reg_loss: 75622.8932; val_edge_recon_loss: 623430.3417; val_gene_expr_recon_loss: 19994287.4667; val_masked_gp_l1_reg_loss: 74329.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160836.7500; val_chrom_access_recon_loss: 2635365.6667; val_global_loss: 23563872.5333; val_optim_loss: 23563872.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9234; val_auprc_score: 0.9087; val_best_acc_score: 0.8506; val_best_f1_score: 0.8600; train_kl_reg_loss: 75821.8301; train_edge_recon_loss: 613838.3531; train_gene_expr_recon_loss: 20139164.3969; train_masked_gp_l1_reg_loss: 75803.8352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149244.5083; train_chrom_access_recon_loss: 2681788.4313; train_global_loss: 23735661.3588; train_optim_loss: 23735661.3588; val_kl_reg_loss: 75059.8411; val_edge_recon_loss: 615402.9750; val_gene_expr_recon_loss: 19869156.5333; val_masked_gp_l1_reg_loss: 77268.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140672.3281; val_chrom_access_recon_loss: 2621017.3500; val_global_loss: 23398576.4000; val_optim_loss: 23398576.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9373; val_auprc_score: 0.9255; val_best_acc_score: 0.8611; val_best_f1_score: 0.8687; train_kl_reg_loss: 73165.8586; train_edge_recon_loss: 605077.1474; train_gene_expr_recon_loss: 19990408.8244; train_masked_gp_l1_reg_loss: 78374.8022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134031.4159; train_chrom_access_recon_loss: 2659407.3187; train_global_loss: 23540465.4656; train_optim_loss: 23540465.4656; val_kl_reg_loss: 73176.3365; val_edge_recon_loss: 606207.5000; val_gene_expr_recon_loss: 19765323.2000; val_masked_gp_l1_reg_loss: 79672.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130300.7500; val_chrom_access_recon_loss: 2598480.7500; val_global_loss: 23253159.7333; val_optim_loss: 23253159.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9380; val_auprc_score: 0.9275; val_best_acc_score: 0.8677; val_best_f1_score: 0.8745; train_kl_reg_loss: 70662.7683; train_edge_recon_loss: 602698.8802; train_gene_expr_recon_loss: 19852459.0076; train_masked_gp_l1_reg_loss: 80454.3418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126337.4840; train_chrom_access_recon_loss: 2643532.0725; train_global_loss: 23376144.5344; train_optim_loss: 23376144.5344; val_kl_reg_loss: 70895.6932; val_edge_recon_loss: 601800.2167; val_gene_expr_recon_loss: 19586581.7333; val_masked_gp_l1_reg_loss: 81057.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123440.5234; val_chrom_access_recon_loss: 2580623.2167; val_global_loss: 23044399.0667; val_optim_loss: 23044399.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9471; val_auprc_score: 0.9372; val_best_acc_score: 0.8806; val_best_f1_score: 0.8855; train_kl_reg_loss: 68753.8955; train_edge_recon_loss: 599150.0668; train_gene_expr_recon_loss: 19733494.5496; train_masked_gp_l1_reg_loss: 81803.9149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122788.6075; train_chrom_access_recon_loss: 2626919.5458; train_global_loss: 23232910.3817; train_optim_loss: 23232910.3817; val_kl_reg_loss: 66474.5630; val_edge_recon_loss: 599618.5417; val_gene_expr_recon_loss: 19382778.6667; val_masked_gp_l1_reg_loss: 82558.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122118.5312; val_chrom_access_recon_loss: 2556321.9500; val_global_loss: 22809869.6000; val_optim_loss: 22809869.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9502; val_auprc_score: 0.9385; val_best_acc_score: 0.8839; val_best_f1_score: 0.8884; train_kl_reg_loss: 67684.6365; train_edge_recon_loss: 594219.3511; train_gene_expr_recon_loss: 19635810.8397; train_masked_gp_l1_reg_loss: 83141.5880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120529.8630; train_chrom_access_recon_loss: 2612548.9447; train_global_loss: 23113935.3740; train_optim_loss: 23113935.3740; val_kl_reg_loss: 67079.2740; val_edge_recon_loss: 593829.9583; val_gene_expr_recon_loss: 19370600.9333; val_masked_gp_l1_reg_loss: 83846.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119609.2031; val_chrom_access_recon_loss: 2544534.4167; val_global_loss: 22779500.6667; val_optim_loss: 22779500.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9576; val_auprc_score: 0.9467; val_best_acc_score: 0.8910; val_best_f1_score: 0.8961; train_kl_reg_loss: 66242.4807; train_edge_recon_loss: 592270.6689; train_gene_expr_recon_loss: 19513825.3282; train_masked_gp_l1_reg_loss: 84396.8981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117368.8260; train_chrom_access_recon_loss: 2598071.2634; train_global_loss: 22972175.5115; train_optim_loss: 22972175.5115; val_kl_reg_loss: 65037.0628; val_edge_recon_loss: 595659.2500; val_gene_expr_recon_loss: 19319775.3333; val_masked_gp_l1_reg_loss: 84799.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116145.9062; val_chrom_access_recon_loss: 2548752.3167; val_global_loss: 22730170.0000; val_optim_loss: 22730170.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9598; val_auprc_score: 0.9515; val_best_acc_score: 0.9043; val_best_f1_score: 0.9087; train_kl_reg_loss: 65351.3227; train_edge_recon_loss: 589838.8764; train_gene_expr_recon_loss: 19425102.7786; train_masked_gp_l1_reg_loss: 85509.1811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114626.8817; train_chrom_access_recon_loss: 2582814.4771; train_global_loss: 22863243.3740; train_optim_loss: 22863243.3740; val_kl_reg_loss: 63659.9227; val_edge_recon_loss: 589840.4542; val_gene_expr_recon_loss: 19132209.2000; val_masked_gp_l1_reg_loss: 86139.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114777.1484; val_chrom_access_recon_loss: 2517758.4000; val_global_loss: 22504385.8667; val_optim_loss: 22504385.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9597; val_auprc_score: 0.9472; val_best_acc_score: 0.9035; val_best_f1_score: 0.9067; train_kl_reg_loss: 64229.4671; train_edge_recon_loss: 587680.1703; train_gene_expr_recon_loss: 19343086.7023; train_masked_gp_l1_reg_loss: 86684.1508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112967.5115; train_chrom_access_recon_loss: 2569689.1527; train_global_loss: 22764337.1450; train_optim_loss: 22764337.1450; val_kl_reg_loss: 62447.0169; val_edge_recon_loss: 591028.8458; val_gene_expr_recon_loss: 19082378.9333; val_masked_gp_l1_reg_loss: 87093.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111556.2734; val_chrom_access_recon_loss: 2509403.0833; val_global_loss: 22443908.0000; val_optim_loss: 22443908.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9633; val_auprc_score: 0.9545; val_best_acc_score: 0.9070; val_best_f1_score: 0.9101; train_kl_reg_loss: 63503.9392; train_edge_recon_loss: 585580.6885; train_gene_expr_recon_loss: 19253455.3740; train_masked_gp_l1_reg_loss: 87883.8254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110941.7824; train_chrom_access_recon_loss: 2557071.2366; train_global_loss: 22658436.8092; train_optim_loss: 22658436.8092; val_kl_reg_loss: 64626.0732; val_edge_recon_loss: 589333.1917; val_gene_expr_recon_loss: 19061966.6667; val_masked_gp_l1_reg_loss: 88524.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110533.7344; val_chrom_access_recon_loss: 2496973.8167; val_global_loss: 22411957.8667; val_optim_loss: 22411957.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9678; val_auprc_score: 0.9598; val_best_acc_score: 0.9155; val_best_f1_score: 0.9186; train_kl_reg_loss: 62609.4770; train_edge_recon_loss: 584319.9480; train_gene_expr_recon_loss: 19211292.0305; train_masked_gp_l1_reg_loss: 89220.4986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109710.0370; train_chrom_access_recon_loss: 2550139.2634; train_global_loss: 22607291.3740; train_optim_loss: 22607291.3740; val_kl_reg_loss: 60891.6896; val_edge_recon_loss: 581438.3500; val_gene_expr_recon_loss: 19047555.8667; val_masked_gp_l1_reg_loss: 89884.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109598.2891; val_chrom_access_recon_loss: 2510082.3667; val_global_loss: 22399450.1333; val_optim_loss: 22399450.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9676; val_auprc_score: 0.9607; val_best_acc_score: 0.9159; val_best_f1_score: 0.9185; train_kl_reg_loss: 62083.3143; train_edge_recon_loss: 581613.8387; train_gene_expr_recon_loss: 19134451.6641; train_masked_gp_l1_reg_loss: 90463.7063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108669.7734; train_chrom_access_recon_loss: 2538109.8492; train_global_loss: 22515392.0305; train_optim_loss: 22515392.0305; val_kl_reg_loss: 60785.9792; val_edge_recon_loss: 583503.4625; val_gene_expr_recon_loss: 18881683.6000; val_masked_gp_l1_reg_loss: 91138.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108367.5547; val_chrom_access_recon_loss: 2483146.1333; val_global_loss: 22208625.0667; val_optim_loss: 22208625.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9647; val_auprc_score: 0.9573; val_best_acc_score: 0.9113; val_best_f1_score: 0.9148; train_kl_reg_loss: 61137.2217; train_edge_recon_loss: 581812.7953; train_gene_expr_recon_loss: 19036582.6565; train_masked_gp_l1_reg_loss: 91872.4190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107696.3377; train_chrom_access_recon_loss: 2523618.2748; train_global_loss: 22402719.7405; train_optim_loss: 22402719.7405; val_kl_reg_loss: 60182.2948; val_edge_recon_loss: 585293.8667; val_gene_expr_recon_loss: 18801134.2667; val_masked_gp_l1_reg_loss: 92857.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107119.0078; val_chrom_access_recon_loss: 2464493.5000; val_global_loss: 22111082.0000; val_optim_loss: 22111082.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9692; val_auprc_score: 0.9634; val_best_acc_score: 0.9167; val_best_f1_score: 0.9193; train_kl_reg_loss: 60480.4021; train_edge_recon_loss: 579287.2195; train_gene_expr_recon_loss: 18982215.9389; train_masked_gp_l1_reg_loss: 93467.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106376.4598; train_chrom_access_recon_loss: 2514984.5706; train_global_loss: 22336812.1832; train_optim_loss: 22336812.1832; val_kl_reg_loss: 59893.8492; val_edge_recon_loss: 582132.0333; val_gene_expr_recon_loss: 18817734.4000; val_masked_gp_l1_reg_loss: 94229.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106430.4609; val_chrom_access_recon_loss: 2479724.2333; val_global_loss: 22140144.2667; val_optim_loss: 22140144.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9629; val_auprc_score: 0.9514; val_best_acc_score: 0.9120; val_best_f1_score: 0.9164; train_kl_reg_loss: 59904.8629; train_edge_recon_loss: 579561.2572; train_gene_expr_recon_loss: 18920721.0687; train_masked_gp_l1_reg_loss: 95162.9305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105571.7318; train_chrom_access_recon_loss: 2504659.2042; train_global_loss: 22265581.1298; train_optim_loss: 22265581.1298; val_kl_reg_loss: 60024.8034; val_edge_recon_loss: 583618.5833; val_gene_expr_recon_loss: 18712494.4000; val_masked_gp_l1_reg_loss: 95849.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105079.1484; val_chrom_access_recon_loss: 2449563.4667; val_global_loss: 22006630.8000; val_optim_loss: 22006630.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9663; val_auprc_score: 0.9574; val_best_acc_score: 0.9143; val_best_f1_score: 0.9174; train_kl_reg_loss: 59609.1024; train_edge_recon_loss: 579258.1770; train_gene_expr_recon_loss: 18856436.9160; train_masked_gp_l1_reg_loss: 96608.3542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104575.5158; train_chrom_access_recon_loss: 2493590.2538; train_global_loss: 22190078.4885; train_optim_loss: 22190078.4885; val_kl_reg_loss: 57022.2398; val_edge_recon_loss: 581677.2958; val_gene_expr_recon_loss: 18684037.7333; val_masked_gp_l1_reg_loss: 97375.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104240.4141; val_chrom_access_recon_loss: 2440351.3167; val_global_loss: 21964704.6667; val_optim_loss: 21964704.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9629; val_auprc_score: 0.9530; val_best_acc_score: 0.9097; val_best_f1_score: 0.9129; train_kl_reg_loss: 59030.1394; train_edge_recon_loss: 577555.6579; train_gene_expr_recon_loss: 18797145.2672; train_masked_gp_l1_reg_loss: 98111.4986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104016.5493; train_chrom_access_recon_loss: 2485350.8893; train_global_loss: 22121209.9695; train_optim_loss: 22121209.9695; val_kl_reg_loss: 59515.8164; val_edge_recon_loss: 583386.8750; val_gene_expr_recon_loss: 18642782.9333; val_masked_gp_l1_reg_loss: 98845.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104218.2266; val_chrom_access_recon_loss: 2447568.2333; val_global_loss: 21936317.7333; val_optim_loss: 21936317.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9672; val_auprc_score: 0.9573; val_best_acc_score: 0.9169; val_best_f1_score: 0.9199; train_kl_reg_loss: 59173.3306; train_edge_recon_loss: 578646.3874; train_gene_expr_recon_loss: 18732540.3206; train_masked_gp_l1_reg_loss: 99655.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103452.0738; train_chrom_access_recon_loss: 2475663.0439; train_global_loss: 22049130.3359; train_optim_loss: 22049130.3359; val_kl_reg_loss: 58857.3818; val_edge_recon_loss: 583056.1000; val_gene_expr_recon_loss: 18526304.8000; val_masked_gp_l1_reg_loss: 100190.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103265.9922; val_chrom_access_recon_loss: 2422264.8000; val_global_loss: 21793939.2000; val_optim_loss: 21793939.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9672; val_auprc_score: 0.9568; val_best_acc_score: 0.9157; val_best_f1_score: 0.9195; train_kl_reg_loss: 58968.9451; train_edge_recon_loss: 577559.3588; train_gene_expr_recon_loss: 18677233.5725; train_masked_gp_l1_reg_loss: 100798.5950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103146.3368; train_chrom_access_recon_loss: 2466399.2920; train_global_loss: 21984106.0611; train_optim_loss: 21984106.0611; val_kl_reg_loss: 58621.7852; val_edge_recon_loss: 580399.4042; val_gene_expr_recon_loss: 18623722.5333; val_masked_gp_l1_reg_loss: 101400.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102913.5547; val_chrom_access_recon_loss: 2425695.1500; val_global_loss: 21892752.8000; val_optim_loss: 21892752.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9653; val_auprc_score: 0.9562; val_best_acc_score: 0.9166; val_best_f1_score: 0.9195; train_kl_reg_loss: 58899.2001; train_edge_recon_loss: 577814.3192; train_gene_expr_recon_loss: 18601219.0687; train_masked_gp_l1_reg_loss: 102082.7686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102969.9785; train_chrom_access_recon_loss: 2457200.7786; train_global_loss: 21900186.1374; train_optim_loss: 21900186.1374; val_kl_reg_loss: 58453.9870; val_edge_recon_loss: 581226.0083; val_gene_expr_recon_loss: 18496140.2667; val_masked_gp_l1_reg_loss: 102485.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103268.4922; val_chrom_access_recon_loss: 2410356.7500; val_global_loss: 21751930.9333; val_optim_loss: 21751930.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9665; val_auprc_score: 0.9557; val_best_acc_score: 0.9154; val_best_f1_score: 0.9187; train_kl_reg_loss: 59023.3835; train_edge_recon_loss: 578785.3645; train_gene_expr_recon_loss: 18548195.8626; train_masked_gp_l1_reg_loss: 102994.3839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103044.0035; train_chrom_access_recon_loss: 2448416.6088; train_global_loss: 21840459.5420; train_optim_loss: 21840459.5420; val_kl_reg_loss: 57678.3565; val_edge_recon_loss: 581736.2583; val_gene_expr_recon_loss: 18457024.8000; val_masked_gp_l1_reg_loss: 103520.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103903.8828; val_chrom_access_recon_loss: 2413842.6333; val_global_loss: 21717705.8667; val_optim_loss: 21717705.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9664; val_auprc_score: 0.9587; val_best_acc_score: 0.9139; val_best_f1_score: 0.9170; train_kl_reg_loss: 59205.8304; train_edge_recon_loss: 578114.6713; train_gene_expr_recon_loss: 18507879.2214; train_masked_gp_l1_reg_loss: 103805.8936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103252.8736; train_chrom_access_recon_loss: 2442294.1698; train_global_loss: 21794552.7176; train_optim_loss: 21794552.7176; val_kl_reg_loss: 59851.2557; val_edge_recon_loss: 579883.1708; val_gene_expr_recon_loss: 18363749.2000; val_masked_gp_l1_reg_loss: 104018.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104229.6328; val_chrom_access_recon_loss: 2389016.1500; val_global_loss: 21600748.2667; val_optim_loss: 21600748.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9697; val_auprc_score: 0.9623; val_best_acc_score: 0.9169; val_best_f1_score: 0.9188; train_kl_reg_loss: 59549.3812; train_edge_recon_loss: 578176.8588; train_gene_expr_recon_loss: 18485414.8702; train_masked_gp_l1_reg_loss: 104381.8318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103457.6610; train_chrom_access_recon_loss: 2436916.2347; train_global_loss: 21767896.7786; train_optim_loss: 21767896.7786; val_kl_reg_loss: 60214.9362; val_edge_recon_loss: 580239.2833; val_gene_expr_recon_loss: 18371748.5333; val_masked_gp_l1_reg_loss: 104601.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104604.1406; val_chrom_access_recon_loss: 2406405.1833; val_global_loss: 21627814.0000; val_optim_loss: 21627814.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9666; val_auprc_score: 0.9563; val_best_acc_score: 0.9159; val_best_f1_score: 0.9189; train_kl_reg_loss: 60150.5216; train_edge_recon_loss: 577452.9451; train_gene_expr_recon_loss: 18435422.7634; train_masked_gp_l1_reg_loss: 105046.8138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103977.3437; train_chrom_access_recon_loss: 2428479.4637; train_global_loss: 21710529.7405; train_optim_loss: 21710529.7405; val_kl_reg_loss: 61097.5539; val_edge_recon_loss: 585490.6542; val_gene_expr_recon_loss: 18321382.0000; val_masked_gp_l1_reg_loss: 105438.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105788.7656; val_chrom_access_recon_loss: 2402630.3167; val_global_loss: 21581826.4000; val_optim_loss: 21581826.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9647; val_auprc_score: 0.9565; val_best_acc_score: 0.9096; val_best_f1_score: 0.9148; train_kl_reg_loss: 60098.3434; train_edge_recon_loss: 577549.0320; train_gene_expr_recon_loss: 18373091.1374; train_masked_gp_l1_reg_loss: 105781.7564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104507.1446; train_chrom_access_recon_loss: 2420590.4141; train_global_loss: 21641617.7863; train_optim_loss: 21641617.7863; val_kl_reg_loss: 58944.1359; val_edge_recon_loss: 582210.5833; val_gene_expr_recon_loss: 18414738.2667; val_masked_gp_l1_reg_loss: 106281.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105354.6875; val_chrom_access_recon_loss: 2410543.7000; val_global_loss: 21678072.4000; val_optim_loss: 21678072.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9649; val_auprc_score: 0.9518; val_best_acc_score: 0.9100; val_best_f1_score: 0.9142; train_kl_reg_loss: 60717.8756; train_edge_recon_loss: 579176.8573; train_gene_expr_recon_loss: 18355163.4351; train_masked_gp_l1_reg_loss: 106007.1774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104916.8752; train_chrom_access_recon_loss: 2418010.8225; train_global_loss: 21623993.0992; train_optim_loss: 21623993.0992; val_kl_reg_loss: 61035.9180; val_edge_recon_loss: 584826.0208; val_gene_expr_recon_loss: 18267364.0000; val_masked_gp_l1_reg_loss: 105803.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105403.8438; val_chrom_access_recon_loss: 2388528.2833; val_global_loss: 21512962.1333; val_optim_loss: 21512962.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9673; val_auprc_score: 0.9603; val_best_acc_score: 0.9108; val_best_f1_score: 0.9139; train_kl_reg_loss: 60433.1130; train_edge_recon_loss: 580721.0806; train_gene_expr_recon_loss: 18385964.5802; train_masked_gp_l1_reg_loss: 105840.7755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105241.9347; train_chrom_access_recon_loss: 2425173.4160; train_global_loss: 21663374.7939; train_optim_loss: 21663374.7939; val_kl_reg_loss: 61547.6714; val_edge_recon_loss: 585246.4417; val_gene_expr_recon_loss: 18403252.5333; val_masked_gp_l1_reg_loss: 105412.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107830.4453; val_chrom_access_recon_loss: 2415801.7167; val_global_loss: 21679090.5333; val_optim_loss: 21679090.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9140; val_auprc_score: 0.9153; val_best_acc_score: 0.8309; val_best_f1_score: 0.8357; train_kl_reg_loss: 21974975.7482; train_edge_recon_loss: 676539.3917; train_gene_expr_recon_loss: 19711227.9389; train_masked_gp_l1_reg_loss: 100242.8098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136828.4808; train_chrom_access_recon_loss: 2605108.7424; train_global_loss: 45204923.4198; train_optim_loss: 45204923.4198; val_kl_reg_loss: 90682.5089; val_edge_recon_loss: 710857.4375; val_gene_expr_recon_loss: 18868729.8667; val_masked_gp_l1_reg_loss: 89289.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133381.9531; val_chrom_access_recon_loss: 2484060.2500; val_global_loss: 22377002.0000; val_optim_loss: 22377002.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9361; val_auprc_score: 0.9309; val_best_acc_score: 0.8639; val_best_f1_score: 0.8713; train_kl_reg_loss: 549572.1596; train_edge_recon_loss: 651636.1985; train_gene_expr_recon_loss: 19021042.1069; train_masked_gp_l1_reg_loss: 85970.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126193.1734; train_chrom_access_recon_loss: 2519680.9599; train_global_loss: 22954095.2061; train_optim_loss: 22954095.2061; val_kl_reg_loss: 79451.4969; val_edge_recon_loss: 633370.8458; val_gene_expr_recon_loss: 18687009.3333; val_masked_gp_l1_reg_loss: 84860.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118560.2969; val_chrom_access_recon_loss: 2436375.8500; val_global_loss: 22039627.4667; val_optim_loss: 22039627.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9491; val_auprc_score: 0.9394; val_best_acc_score: 0.8812; val_best_f1_score: 0.8861; train_kl_reg_loss: 78303.0838; train_edge_recon_loss: 612138.1999; train_gene_expr_recon_loss: 18885786.8550; train_masked_gp_l1_reg_loss: 84461.3311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116422.3662; train_chrom_access_recon_loss: 2485841.5420; train_global_loss: 22262953.3893; train_optim_loss: 22262953.3893; val_kl_reg_loss: 80870.3573; val_edge_recon_loss: 607635.7500; val_gene_expr_recon_loss: 18597537.6000; val_masked_gp_l1_reg_loss: 83815.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113793.3984; val_chrom_access_recon_loss: 2424208.5833; val_global_loss: 21907862.0000; val_optim_loss: 21907862.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9469; val_auprc_score: 0.9353; val_best_acc_score: 0.8837; val_best_f1_score: 0.8904; train_kl_reg_loss: 81465.4287; train_edge_recon_loss: 600864.1441; train_gene_expr_recon_loss: 18776995.6947; train_masked_gp_l1_reg_loss: 82325.7913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84417.7188; train_chrom_access_recon_loss: 2470434.7901; train_global_loss: 22096503.6183; train_optim_loss: 22096503.6183; val_kl_reg_loss: 82713.9068; val_edge_recon_loss: 602455.4458; val_gene_expr_recon_loss: 18476194.9333; val_masked_gp_l1_reg_loss: 81902.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79547.2578; val_chrom_access_recon_loss: 2417045.4333; val_global_loss: 21739859.7333; val_optim_loss: 21739859.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9507; val_auprc_score: 0.9393; val_best_acc_score: 0.8843; val_best_f1_score: 0.8891; train_kl_reg_loss: 82762.9463; train_edge_recon_loss: 595834.7801; train_gene_expr_recon_loss: 18721044.5344; train_masked_gp_l1_reg_loss: 81878.0762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78473.9888; train_chrom_access_recon_loss: 2469712.3073; train_global_loss: 22029706.6718; train_optim_loss: 22029706.6718; val_kl_reg_loss: 82668.4438; val_edge_recon_loss: 597817.0917; val_gene_expr_recon_loss: 18569193.7333; val_masked_gp_l1_reg_loss: 81949.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77824.1250; val_chrom_access_recon_loss: 2425713.6333; val_global_loss: 21835165.3333; val_optim_loss: 21835165.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9461; val_auprc_score: 0.9284; val_best_acc_score: 0.8863; val_best_f1_score: 0.8929; train_kl_reg_loss: 82907.2475; train_edge_recon_loss: 594792.9509; train_gene_expr_recon_loss: 18694950.1221; train_masked_gp_l1_reg_loss: 82008.9866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77111.6275; train_chrom_access_recon_loss: 2465571.7882; train_global_loss: 21997342.6565; train_optim_loss: 21997342.6565; val_kl_reg_loss: 81785.8229; val_edge_recon_loss: 596053.6000; val_gene_expr_recon_loss: 18517877.4667; val_masked_gp_l1_reg_loss: 82086.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76700.2812; val_chrom_access_recon_loss: 2423984.0833; val_global_loss: 21778486.9333; val_optim_loss: 21778486.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9486; val_auprc_score: 0.9356; val_best_acc_score: 0.8864; val_best_f1_score: 0.8913; train_kl_reg_loss: 83133.2286; train_edge_recon_loss: 593646.6560; train_gene_expr_recon_loss: 18694681.2366; train_masked_gp_l1_reg_loss: 82138.6889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76172.8888; train_chrom_access_recon_loss: 2463111.0076; train_global_loss: 21992883.7863; train_optim_loss: 21992883.7863; val_kl_reg_loss: 83728.4339; val_edge_recon_loss: 597275.1542; val_gene_expr_recon_loss: 18519179.6000; val_masked_gp_l1_reg_loss: 82231.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75811.0625; val_chrom_access_recon_loss: 2420135.7333; val_global_loss: 21778362.8000; val_optim_loss: 21778362.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 13 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9619
val AUPRC score: 0.9508
val best accuracy score: 0.9111
val best F1 score: 0.9152
val target rna MSE score: 1.1943
val source rna MSE score: 0.4313
val target atac MSE score: 0.4778
val source atac MSE score: 0.1327
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
