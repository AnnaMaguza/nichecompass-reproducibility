[True]
Run timestamp: 07092023_025929_247.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_247']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7885; val_auprc_score: 0.8103; val_best_acc_score: 0.5356; val_best_f1_score: 0.6791; train_kl_reg_loss: 103181.2897; train_edge_recon_loss: 3598751.6450; train_gene_expr_recon_loss: 17128648.0534; train_masked_gp_l1_reg_loss: 48227.5061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5686555.9342; train_chrom_access_recon_loss: 61768101.0076; train_global_loss: 88333465.6489; train_optim_loss: 88333465.6489; val_kl_reg_loss: 165801.2156; val_edge_recon_loss: 4062670.9833; val_gene_expr_recon_loss: 15751698.4667; val_masked_gp_l1_reg_loss: 42367.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 507383.0625; val_chrom_access_recon_loss: 58704253.0667; val_global_loss: 79234174.9333; val_optim_loss: 79234174.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8684; val_auprc_score: 0.8712; val_best_acc_score: 0.7720; val_best_f1_score: 0.7717; train_kl_reg_loss: 132860.1415; train_edge_recon_loss: 3542950.6355; train_gene_expr_recon_loss: 15658473.5802; train_masked_gp_l1_reg_loss: 40463.4090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348353.3265; train_chrom_access_recon_loss: 59168206.3511; train_global_loss: 78891307.1756; train_optim_loss: 78891307.1756; val_kl_reg_loss: 127746.3750; val_edge_recon_loss: 3991932.5833; val_gene_expr_recon_loss: 15288478.0000; val_masked_gp_l1_reg_loss: 40759.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 258096.7344; val_chrom_access_recon_loss: 57495951.2000; val_global_loss: 77202964.2667; val_optim_loss: 77202964.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8604; val_auprc_score: 0.8531; val_best_acc_score: 0.7687; val_best_f1_score: 0.7860; train_kl_reg_loss: 112481.1812; train_edge_recon_loss: 3344586.3282; train_gene_expr_recon_loss: 15371220.4427; train_masked_gp_l1_reg_loss: 42577.9017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223048.4908; train_chrom_access_recon_loss: 58382149.1908; train_global_loss: 77476063.0229; train_optim_loss: 77476063.0229; val_kl_reg_loss: 139724.9125; val_edge_recon_loss: 3063204.1000; val_gene_expr_recon_loss: 15097114.8667; val_masked_gp_l1_reg_loss: 44535.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199467.8594; val_chrom_access_recon_loss: 57188470.9333; val_global_loss: 75732518.9333; val_optim_loss: 75732518.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8741; val_auprc_score: 0.8604; val_best_acc_score: 0.7926; val_best_f1_score: 0.8104; train_kl_reg_loss: 140613.4166; train_edge_recon_loss: 3003168.7538; train_gene_expr_recon_loss: 15193600.6412; train_masked_gp_l1_reg_loss: 45891.0035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186114.3078; train_chrom_access_recon_loss: 57781423.2061; train_global_loss: 76350811.2977; train_optim_loss: 76350811.2977; val_kl_reg_loss: 132210.7120; val_edge_recon_loss: 3009160.0167; val_gene_expr_recon_loss: 14995617.8000; val_masked_gp_l1_reg_loss: 47149.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176373.6562; val_chrom_access_recon_loss: 56772488.0000; val_global_loss: 75133000.0000; val_optim_loss: 75133000.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8824; val_auprc_score: 0.8659; val_best_acc_score: 0.8029; val_best_f1_score: 0.8255; train_kl_reg_loss: 133006.1599; train_edge_recon_loss: 2943571.6088; train_gene_expr_recon_loss: 15044568.9618; train_masked_gp_l1_reg_loss: 48407.2267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169657.3304; train_chrom_access_recon_loss: 57310737.3435; train_global_loss: 75649949.1298; train_optim_loss: 75649949.1298; val_kl_reg_loss: 130139.9797; val_edge_recon_loss: 2899330.1833; val_gene_expr_recon_loss: 14791535.3333; val_masked_gp_l1_reg_loss: 49563.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164325.6719; val_chrom_access_recon_loss: 56282354.6667; val_global_loss: 74317249.0667; val_optim_loss: 74317249.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8995; val_auprc_score: 0.8857; val_best_acc_score: 0.8174; val_best_f1_score: 0.8354; train_kl_reg_loss: 128617.8903; train_edge_recon_loss: 2901858.4943; train_gene_expr_recon_loss: 14919689.4962; train_masked_gp_l1_reg_loss: 50614.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159470.5967; train_chrom_access_recon_loss: 56823524.0000; train_global_loss: 74983774.6565; train_optim_loss: 74983774.6565; val_kl_reg_loss: 126917.1422; val_edge_recon_loss: 2884077.2167; val_gene_expr_recon_loss: 14655227.4667; val_masked_gp_l1_reg_loss: 51706.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155234.8281; val_chrom_access_recon_loss: 55489668.0000; val_global_loss: 73362828.8000; val_optim_loss: 73362828.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9159; val_auprc_score: 0.9018; val_best_acc_score: 0.8360; val_best_f1_score: 0.8475; train_kl_reg_loss: 128160.4021; train_edge_recon_loss: 2862216.4389; train_gene_expr_recon_loss: 14796945.4275; train_masked_gp_l1_reg_loss: 52671.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152757.8354; train_chrom_access_recon_loss: 56357390.2595; train_global_loss: 74350142.5344; train_optim_loss: 74350142.5344; val_kl_reg_loss: 123379.7630; val_edge_recon_loss: 2860214.1667; val_gene_expr_recon_loss: 14571565.5333; val_masked_gp_l1_reg_loss: 53661.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149850.5469; val_chrom_access_recon_loss: 54991572.2667; val_global_loss: 72750244.0000; val_optim_loss: 72750244.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9259; val_auprc_score: 0.9112; val_best_acc_score: 0.8568; val_best_f1_score: 0.8650; train_kl_reg_loss: 126205.9292; train_edge_recon_loss: 2843666.5802; train_gene_expr_recon_loss: 14702364.9771; train_masked_gp_l1_reg_loss: 54588.5253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148012.8646; train_chrom_access_recon_loss: 55964256.4580; train_global_loss: 73839095.4504; train_optim_loss: 73839095.4504; val_kl_reg_loss: 124844.6792; val_edge_recon_loss: 2831853.9167; val_gene_expr_recon_loss: 14496909.8667; val_masked_gp_l1_reg_loss: 55630.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145747.9219; val_chrom_access_recon_loss: 54811650.1333; val_global_loss: 72466636.2667; val_optim_loss: 72466636.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9310; val_auprc_score: 0.9173; val_best_acc_score: 0.8631; val_best_f1_score: 0.8724; train_kl_reg_loss: 124184.1407; train_edge_recon_loss: 2822321.8359; train_gene_expr_recon_loss: 14624865.1985; train_masked_gp_l1_reg_loss: 56417.2479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144149.0070; train_chrom_access_recon_loss: 55650935.0840; train_global_loss: 73422872.4885; train_optim_loss: 73422872.4885; val_kl_reg_loss: 124918.7526; val_edge_recon_loss: 2835396.9833; val_gene_expr_recon_loss: 14473781.9333; val_masked_gp_l1_reg_loss: 57153.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142727.9219; val_chrom_access_recon_loss: 54882562.4000; val_global_loss: 72516542.4000; val_optim_loss: 72516542.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9369; val_auprc_score: 0.9235; val_best_acc_score: 0.8709; val_best_f1_score: 0.8778; train_kl_reg_loss: 122284.7518; train_edge_recon_loss: 2803021.5859; train_gene_expr_recon_loss: 14533262.5954; train_masked_gp_l1_reg_loss: 58007.0891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141355.1432; train_chrom_access_recon_loss: 55264405.0992; train_global_loss: 72922336.9466; train_optim_loss: 72922336.9466; val_kl_reg_loss: 121969.2104; val_edge_recon_loss: 2816645.6333; val_gene_expr_recon_loss: 14332065.4667; val_masked_gp_l1_reg_loss: 58657.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140240.6875; val_chrom_access_recon_loss: 54421593.0667; val_global_loss: 71891171.2000; val_optim_loss: 71891171.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9427; val_auprc_score: 0.9282; val_best_acc_score: 0.8798; val_best_f1_score: 0.8878; train_kl_reg_loss: 120497.2828; train_edge_recon_loss: 2788437.7290; train_gene_expr_recon_loss: 14477702.8244; train_masked_gp_l1_reg_loss: 59454.2324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139132.7436; train_chrom_access_recon_loss: 54954071.4504; train_global_loss: 72539296.4885; train_optim_loss: 72539296.4885; val_kl_reg_loss: 118531.2979; val_edge_recon_loss: 2791374.4000; val_gene_expr_recon_loss: 14301168.8000; val_masked_gp_l1_reg_loss: 60337.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139134.9062; val_chrom_access_recon_loss: 54022587.7333; val_global_loss: 71433134.4000; val_optim_loss: 71433134.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9468; val_auprc_score: 0.9329; val_best_acc_score: 0.8821; val_best_f1_score: 0.8887; train_kl_reg_loss: 118036.2308; train_edge_recon_loss: 2784764.2023; train_gene_expr_recon_loss: 14398529.2137; train_masked_gp_l1_reg_loss: 60865.6141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137443.0490; train_chrom_access_recon_loss: 54581777.0382; train_global_loss: 72081414.8397; train_optim_loss: 72081414.8397; val_kl_reg_loss: 115370.9677; val_edge_recon_loss: 2790357.5500; val_gene_expr_recon_loss: 14193187.2000; val_masked_gp_l1_reg_loss: 61518.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137011.0156; val_chrom_access_recon_loss: 53626398.4000; val_global_loss: 70923843.2000; val_optim_loss: 70923843.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9516; val_auprc_score: 0.9405; val_best_acc_score: 0.8898; val_best_f1_score: 0.8958; train_kl_reg_loss: 116549.7818; train_edge_recon_loss: 2763148.8607; train_gene_expr_recon_loss: 14349445.1069; train_masked_gp_l1_reg_loss: 63141.4653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136519.6261; train_chrom_access_recon_loss: 54311533.5267; train_global_loss: 71740338.3511; train_optim_loss: 71740338.3511; val_kl_reg_loss: 117801.5339; val_edge_recon_loss: 2780797.8000; val_gene_expr_recon_loss: 14160044.2667; val_masked_gp_l1_reg_loss: 63832.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136247.6406; val_chrom_access_recon_loss: 53472628.2667; val_global_loss: 70731352.0000; val_optim_loss: 70731352.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9540; val_auprc_score: 0.9414; val_best_acc_score: 0.8941; val_best_f1_score: 0.8984; train_kl_reg_loss: 113567.8964; train_edge_recon_loss: 2767402.4008; train_gene_expr_recon_loss: 14370415.7099; train_masked_gp_l1_reg_loss: 64736.7480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136205.6995; train_chrom_access_recon_loss: 54287524.5496; train_global_loss: 71739852.9771; train_optim_loss: 71739852.9771; val_kl_reg_loss: 104054.3401; val_edge_recon_loss: 2771496.2333; val_gene_expr_recon_loss: 14180096.0667; val_masked_gp_l1_reg_loss: 68222.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139520.1875; val_chrom_access_recon_loss: 53619039.2000; val_global_loss: 70882428.8000; val_optim_loss: 70882428.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9486; val_auprc_score: 0.9382; val_best_acc_score: 0.8849; val_best_f1_score: 0.8907; train_kl_reg_loss: 102956.4187; train_edge_recon_loss: 2782653.7462; train_gene_expr_recon_loss: 14350241.0076; train_masked_gp_l1_reg_loss: 69062.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140000.9002; train_chrom_access_recon_loss: 54228856.6718; train_global_loss: 71673771.6947; train_optim_loss: 71673771.6947; val_kl_reg_loss: 154164.1562; val_edge_recon_loss: 2826355.5500; val_gene_expr_recon_loss: 14091818.3333; val_masked_gp_l1_reg_loss: 69988.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141897.2500; val_chrom_access_recon_loss: 53076483.2000; val_global_loss: 70360705.8667; val_optim_loss: 70360705.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9482; val_auprc_score: 0.9357; val_best_acc_score: 0.8800; val_best_f1_score: 0.8884; train_kl_reg_loss: 106281.4636; train_edge_recon_loss: 2796307.1870; train_gene_expr_recon_loss: 14324809.8168; train_masked_gp_l1_reg_loss: 70926.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144831.0938; train_chrom_access_recon_loss: 54313584.4580; train_global_loss: 71756740.4885; train_optim_loss: 71756740.4885; val_kl_reg_loss: 125526.9302; val_edge_recon_loss: 2837916.4833; val_gene_expr_recon_loss: 14182811.9333; val_masked_gp_l1_reg_loss: 70701.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139810.9844; val_chrom_access_recon_loss: 53457629.6000; val_global_loss: 70814398.1333; val_optim_loss: 70814398.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9347; val_auprc_score: 0.9166; val_best_acc_score: 0.8690; val_best_f1_score: 0.8795; train_kl_reg_loss: 1060058.0059; train_edge_recon_loss: 2882130.7710; train_gene_expr_recon_loss: 14541345.1908; train_masked_gp_l1_reg_loss: 73204.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139528.1987; train_chrom_access_recon_loss: 55049380.8550; train_global_loss: 73745647.2977; train_optim_loss: 73745647.2977; val_kl_reg_loss: 113381.8359; val_edge_recon_loss: 2869563.1833; val_gene_expr_recon_loss: 14177676.7333; val_masked_gp_l1_reg_loss: 73589.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134422.2969; val_chrom_access_recon_loss: 53172229.3333; val_global_loss: 70540861.8667; val_optim_loss: 70540861.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9304; val_auprc_score: 0.9170; val_best_acc_score: 0.8616; val_best_f1_score: 0.8692; train_kl_reg_loss: 146738735.5522; train_edge_recon_loss: 2902412.3073; train_gene_expr_recon_loss: 14373319.3588; train_masked_gp_l1_reg_loss: 75340.1259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139710.8245; train_chrom_access_recon_loss: 54439169.0076; train_global_loss: 218668680.4275; train_optim_loss: 218668680.4275; val_kl_reg_loss: 306503.7964; val_edge_recon_loss: 2930001.5500; val_gene_expr_recon_loss: 14153879.4667; val_masked_gp_l1_reg_loss: 77091.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140998.2656; val_chrom_access_recon_loss: 53207991.4667; val_global_loss: 70816466.6667; val_optim_loss: 70816466.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9331; val_auprc_score: 0.9207; val_best_acc_score: 0.8618; val_best_f1_score: 0.8701; train_kl_reg_loss: 125165.1318; train_edge_recon_loss: 2861444.9485; train_gene_expr_recon_loss: 14258610.1450; train_masked_gp_l1_reg_loss: 77386.7699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145099.4057; train_chrom_access_recon_loss: 53812814.0153; train_global_loss: 71280520.3359; train_optim_loss: 71280520.3359; val_kl_reg_loss: 137174.1396; val_edge_recon_loss: 2865626.4667; val_gene_expr_recon_loss: 14074346.6000; val_masked_gp_l1_reg_loss: 78319.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142669.8594; val_chrom_access_recon_loss: 52854670.9333; val_global_loss: 70152807.4667; val_optim_loss: 70152807.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9419; val_auprc_score: 0.9293; val_best_acc_score: 0.8764; val_best_f1_score: 0.8841; train_kl_reg_loss: 136606.9144; train_edge_recon_loss: 2801564.4599; train_gene_expr_recon_loss: 14217125.4885; train_masked_gp_l1_reg_loss: 80544.6973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138363.6351; train_chrom_access_recon_loss: 53483370.6870; train_global_loss: 70857575.7557; train_optim_loss: 70857575.7557; val_kl_reg_loss: 141646.3875; val_edge_recon_loss: 2800775.7667; val_gene_expr_recon_loss: 14084843.0000; val_masked_gp_l1_reg_loss: 83169.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136377.5938; val_chrom_access_recon_loss: 52717492.8000; val_global_loss: 69964305.8667; val_optim_loss: 69964305.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9440; val_auprc_score: 0.9320; val_best_acc_score: 0.8767; val_best_f1_score: 0.8838; train_kl_reg_loss: 153034.2424; train_edge_recon_loss: 2794936.4809; train_gene_expr_recon_loss: 14177620.0153; train_masked_gp_l1_reg_loss: 81922.3009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134107.1838; train_chrom_access_recon_loss: 53269390.8397; train_global_loss: 70611011.1145; train_optim_loss: 70611011.1145; val_kl_reg_loss: 123568.7208; val_edge_recon_loss: 2813313.8333; val_gene_expr_recon_loss: 13958366.4000; val_masked_gp_l1_reg_loss: 80878.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136636.1875; val_chrom_access_recon_loss: 52589934.4000; val_global_loss: 69702697.8667; val_optim_loss: 69702697.8667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9390; val_auprc_score: 0.9240; val_best_acc_score: 0.8759; val_best_f1_score: 0.8826; train_kl_reg_loss: 306399.4450; train_edge_recon_loss: 2815119.1088; train_gene_expr_recon_loss: 14159957.4198; train_masked_gp_l1_reg_loss: 80014.1898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135179.4745; train_chrom_access_recon_loss: 53100345.6183; train_global_loss: 70597015.3893; train_optim_loss: 70597015.3893; val_kl_reg_loss: 135832.9823; val_edge_recon_loss: 2807322.2167; val_gene_expr_recon_loss: 13939419.3333; val_masked_gp_l1_reg_loss: 79251.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134446.5938; val_chrom_access_recon_loss: 52155791.7333; val_global_loss: 69252064.0000; val_optim_loss: 69252064.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9448; val_auprc_score: 0.9312; val_best_acc_score: 0.8791; val_best_f1_score: 0.8866; train_kl_reg_loss: 133889.0926; train_edge_recon_loss: 2780098.6889; train_gene_expr_recon_loss: 14107689.5878; train_masked_gp_l1_reg_loss: 78909.8474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133687.5339; train_chrom_access_recon_loss: 52915277.8626; train_global_loss: 70149552.6718; train_optim_loss: 70149552.6718; val_kl_reg_loss: 126944.6974; val_edge_recon_loss: 2791204.9333; val_gene_expr_recon_loss: 13892156.0667; val_masked_gp_l1_reg_loss: 78905.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133132.9062; val_chrom_access_recon_loss: 51929827.7333; val_global_loss: 68952172.0000; val_optim_loss: 68952172.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9412; val_auprc_score: 0.9288; val_best_acc_score: 0.8762; val_best_f1_score: 0.8840; train_kl_reg_loss: 125471.7672; train_edge_recon_loss: 2778870.3321; train_gene_expr_recon_loss: 14083156.5344; train_masked_gp_l1_reg_loss: 79818.6178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134899.0570; train_chrom_access_recon_loss: 52561709.7405; train_global_loss: 69763926.0458; train_optim_loss: 69763926.0458; val_kl_reg_loss: 122327.0448; val_edge_recon_loss: 2809963.9000; val_gene_expr_recon_loss: 13894067.8667; val_masked_gp_l1_reg_loss: 79924.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134275.2656; val_chrom_access_recon_loss: 51984946.1333; val_global_loss: 69025505.6000; val_optim_loss: 69025505.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9430; val_auprc_score: 0.9295; val_best_acc_score: 0.8787; val_best_f1_score: 0.8866; train_kl_reg_loss: 139765.3030; train_edge_recon_loss: 2790157.0916; train_gene_expr_recon_loss: 14072927.4580; train_masked_gp_l1_reg_loss: 80702.8861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135879.8836; train_chrom_access_recon_loss: 52699744.1832; train_global_loss: 69919176.7939; train_optim_loss: 69919176.7939; val_kl_reg_loss: 133807.7135; val_edge_recon_loss: 2811608.4500; val_gene_expr_recon_loss: 13944173.6667; val_masked_gp_l1_reg_loss: 80938.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138463.8438; val_chrom_access_recon_loss: 52095904.5333; val_global_loss: 69204896.5333; val_optim_loss: 69204896.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9408; val_auprc_score: 0.9272; val_best_acc_score: 0.8777; val_best_f1_score: 0.8876; train_kl_reg_loss: 132027.3943; train_edge_recon_loss: 2776209.0802; train_gene_expr_recon_loss: 14051170.4733; train_masked_gp_l1_reg_loss: 81247.4959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136773.7456; train_chrom_access_recon_loss: 52439198.3817; train_global_loss: 69616626.6565; train_optim_loss: 69616626.6565; val_kl_reg_loss: 130077.5042; val_edge_recon_loss: 2781540.5833; val_gene_expr_recon_loss: 13851714.6000; val_masked_gp_l1_reg_loss: 81793.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136467.5781; val_chrom_access_recon_loss: 51735687.7333; val_global_loss: 68717282.1333; val_optim_loss: 68717282.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9440; val_auprc_score: 0.9316; val_best_acc_score: 0.8787; val_best_f1_score: 0.8856; train_kl_reg_loss: 130562.3596; train_edge_recon_loss: 2771035.1393; train_gene_expr_recon_loss: 13989842.0534; train_masked_gp_l1_reg_loss: 81816.2112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136500.6512; train_chrom_access_recon_loss: 52291601.6794; train_global_loss: 69401358.2595; train_optim_loss: 69401358.2595; val_kl_reg_loss: 126317.9198; val_edge_recon_loss: 2787612.8000; val_gene_expr_recon_loss: 13798531.2000; val_masked_gp_l1_reg_loss: 81623.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136363.4062; val_chrom_access_recon_loss: 51629026.6667; val_global_loss: 68559475.7333; val_optim_loss: 68559475.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9438; val_auprc_score: 0.9290; val_best_acc_score: 0.8810; val_best_f1_score: 0.8883; train_kl_reg_loss: 125930.0178; train_edge_recon_loss: 2761732.7844; train_gene_expr_recon_loss: 13945037.0458; train_masked_gp_l1_reg_loss: 81257.2842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134924.4260; train_chrom_access_recon_loss: 52023671.8168; train_global_loss: 69072553.5573; train_optim_loss: 69072553.5573; val_kl_reg_loss: 119226.2891; val_edge_recon_loss: 2778429.0167; val_gene_expr_recon_loss: 13772442.0667; val_masked_gp_l1_reg_loss: 81101.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135956.1719; val_chrom_access_recon_loss: 51375268.8000; val_global_loss: 68262423.4667; val_optim_loss: 68262423.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9452; val_auprc_score: 0.9321; val_best_acc_score: 0.8802; val_best_f1_score: 0.8855; train_kl_reg_loss: 138898.4068; train_edge_recon_loss: 2774137.4885; train_gene_expr_recon_loss: 13977685.1908; train_masked_gp_l1_reg_loss: 81115.2688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136560.9157; train_chrom_access_recon_loss: 52132080.8855; train_global_loss: 69240478.2595; train_optim_loss: 69240478.2595; val_kl_reg_loss: 113894.6984; val_edge_recon_loss: 2789900.9167; val_gene_expr_recon_loss: 13826812.9333; val_masked_gp_l1_reg_loss: 81493.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138731.5312; val_chrom_access_recon_loss: 51258832.8000; val_global_loss: 68209667.4667; val_optim_loss: 68209667.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9439; val_auprc_score: 0.9281; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 118487.4642; train_edge_recon_loss: 2763735.9637; train_gene_expr_recon_loss: 13983494.0992; train_masked_gp_l1_reg_loss: 82191.7474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138016.0911; train_chrom_access_recon_loss: 51976541.5573; train_global_loss: 69062466.8397; train_optim_loss: 69062466.8397; val_kl_reg_loss: 116736.3755; val_edge_recon_loss: 2770056.3167; val_gene_expr_recon_loss: 13828530.8667; val_masked_gp_l1_reg_loss: 81851.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137698.1719; val_chrom_access_recon_loss: 51226342.1333; val_global_loss: 68161216.0000; val_optim_loss: 68161216.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9467; val_auprc_score: 0.9279; val_best_acc_score: 0.8879; val_best_f1_score: 0.8937; train_kl_reg_loss: 121775.4805; train_edge_recon_loss: 2762076.9943; train_gene_expr_recon_loss: 13918507.8015; train_masked_gp_l1_reg_loss: 81456.8921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136097.9938; train_chrom_access_recon_loss: 51848265.3435; train_global_loss: 68868180.2748; train_optim_loss: 68868180.2748; val_kl_reg_loss: 116124.9474; val_edge_recon_loss: 2788428.1500; val_gene_expr_recon_loss: 13761648.1333; val_masked_gp_l1_reg_loss: 81473.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137007.0781; val_chrom_access_recon_loss: 51174755.7333; val_global_loss: 68059438.1333; val_optim_loss: 68059438.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9512; val_auprc_score: 0.9380; val_best_acc_score: 0.8945; val_best_f1_score: 0.8998; train_kl_reg_loss: 131952.8396; train_edge_recon_loss: 2768843.5840; train_gene_expr_recon_loss: 13959068.4351; train_masked_gp_l1_reg_loss: 81106.5152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134811.5367; train_chrom_access_recon_loss: 51869695.6641; train_global_loss: 68945478.4733; train_optim_loss: 68945478.4733; val_kl_reg_loss: 114793.4323; val_edge_recon_loss: 2765424.6000; val_gene_expr_recon_loss: 13760174.2000; val_masked_gp_l1_reg_loss: 80803.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134050.8750; val_chrom_access_recon_loss: 51094678.6667; val_global_loss: 67949924.8000; val_optim_loss: 67949924.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9485; val_auprc_score: 0.9379; val_best_acc_score: 0.8856; val_best_f1_score: 0.8929; train_kl_reg_loss: 114830.8328; train_edge_recon_loss: 2753751.6622; train_gene_expr_recon_loss: 13899264.1374; train_masked_gp_l1_reg_loss: 82310.5021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134944.0237; train_chrom_access_recon_loss: 51651240.5802; train_global_loss: 68636341.6794; train_optim_loss: 68636341.6794; val_kl_reg_loss: 112366.7870; val_edge_recon_loss: 2770794.1333; val_gene_expr_recon_loss: 13766848.6667; val_masked_gp_l1_reg_loss: 85088.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132984.8125; val_chrom_access_recon_loss: 51183330.4000; val_global_loss: 68051412.2667; val_optim_loss: 68051412.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9490; val_auprc_score: 0.9362; val_best_acc_score: 0.8909; val_best_f1_score: 0.8982; train_kl_reg_loss: 114793.1707; train_edge_recon_loss: 2754402.4847; train_gene_expr_recon_loss: 13880557.1450; train_masked_gp_l1_reg_loss: 83985.0522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131926.9351; train_chrom_access_recon_loss: 51502825.9847; train_global_loss: 68468490.6260; train_optim_loss: 68468490.6260; val_kl_reg_loss: 113616.5115; val_edge_recon_loss: 2753356.7000; val_gene_expr_recon_loss: 13755978.1333; val_masked_gp_l1_reg_loss: 83188.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132384.0469; val_chrom_access_recon_loss: 51010778.4000; val_global_loss: 67849302.4000; val_optim_loss: 67849302.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9466; val_auprc_score: 0.9327; val_best_acc_score: 0.8833; val_best_f1_score: 0.8902; train_kl_reg_loss: 115368.7449; train_edge_recon_loss: 2750928.6088; train_gene_expr_recon_loss: 13850794.1298; train_masked_gp_l1_reg_loss: 82549.3222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132264.0969; train_chrom_access_recon_loss: 51348137.3740; train_global_loss: 68280042.1374; train_optim_loss: 68280042.1374; val_kl_reg_loss: 112539.4641; val_edge_recon_loss: 2780989.8500; val_gene_expr_recon_loss: 13709967.0000; val_masked_gp_l1_reg_loss: 82081.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133413.5312; val_chrom_access_recon_loss: 50892806.6667; val_global_loss: 67711799.4667; val_optim_loss: 67711799.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9492; val_auprc_score: 0.9357; val_best_acc_score: 0.8844; val_best_f1_score: 0.8914; train_kl_reg_loss: 112644.0129; train_edge_recon_loss: 2750052.2901; train_gene_expr_recon_loss: 13820272.7481; train_masked_gp_l1_reg_loss: 81808.9082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133433.4973; train_chrom_access_recon_loss: 51189888.5802; train_global_loss: 68088100.5496; train_optim_loss: 68088100.5496; val_kl_reg_loss: 108729.5443; val_edge_recon_loss: 2776778.5333; val_gene_expr_recon_loss: 13658428.6000; val_masked_gp_l1_reg_loss: 82153.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133745.2344; val_chrom_access_recon_loss: 50643748.2667; val_global_loss: 67403583.7333; val_optim_loss: 67403583.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9467; val_auprc_score: 0.9306; val_best_acc_score: 0.8872; val_best_f1_score: 0.8942; train_kl_reg_loss: 111668.0686; train_edge_recon_loss: 2736632.4542; train_gene_expr_recon_loss: 13826681.8779; train_masked_gp_l1_reg_loss: 81958.0766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133852.9478; train_chrom_access_recon_loss: 51138645.2214; train_global_loss: 68029438.9313; train_optim_loss: 68029438.9313; val_kl_reg_loss: 108665.4688; val_edge_recon_loss: 2766048.9667; val_gene_expr_recon_loss: 13649467.1333; val_masked_gp_l1_reg_loss: 81777.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134794.2500; val_chrom_access_recon_loss: 50647662.4000; val_global_loss: 67388416.2667; val_optim_loss: 67388416.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9473; val_auprc_score: 0.9343; val_best_acc_score: 0.8851; val_best_f1_score: 0.8924; train_kl_reg_loss: 240945.6097; train_edge_recon_loss: 2746053.5744; train_gene_expr_recon_loss: 13818253.4504; train_masked_gp_l1_reg_loss: 81865.3273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138101.0419; train_chrom_access_recon_loss: 51153500.3053; train_global_loss: 68178719.1756; train_optim_loss: 68178719.1756; val_kl_reg_loss: 105652.0865; val_edge_recon_loss: 2780846.2500; val_gene_expr_recon_loss: 13740261.5333; val_masked_gp_l1_reg_loss: 81985.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137563.7188; val_chrom_access_recon_loss: 50818898.9333; val_global_loss: 67665208.8000; val_optim_loss: 67665208.8000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9555; val_auprc_score: 0.9442; val_best_acc_score: 0.8948; val_best_f1_score: 0.9019; train_kl_reg_loss: 108426.0660; train_edge_recon_loss: 2738119.7156; train_gene_expr_recon_loss: 13825838.2672; train_masked_gp_l1_reg_loss: 82580.6348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135919.6630; train_chrom_access_recon_loss: 51144929.8015; train_global_loss: 68035814.0763; train_optim_loss: 68035814.0763; val_kl_reg_loss: 102983.9438; val_edge_recon_loss: 2738656.7500; val_gene_expr_recon_loss: 13680982.0000; val_masked_gp_l1_reg_loss: 82829.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136890.3594; val_chrom_access_recon_loss: 50654323.4667; val_global_loss: 67396665.8667; val_optim_loss: 67396665.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9509; val_auprc_score: 0.9373; val_best_acc_score: 0.8926; val_best_f1_score: 0.8981; train_kl_reg_loss: 106525.7267; train_edge_recon_loss: 2738136.7634; train_gene_expr_recon_loss: 13800919.0076; train_masked_gp_l1_reg_loss: 82568.0474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134966.7192; train_chrom_access_recon_loss: 50963862.6870; train_global_loss: 67826978.9924; train_optim_loss: 67826978.9924; val_kl_reg_loss: 100835.1026; val_edge_recon_loss: 2771392.3333; val_gene_expr_recon_loss: 13670268.8667; val_masked_gp_l1_reg_loss: 82438.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134950.9844; val_chrom_access_recon_loss: 50684208.0000; val_global_loss: 67444093.0667; val_optim_loss: 67444093.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9514; val_auprc_score: 0.9372; val_best_acc_score: 0.8961; val_best_f1_score: 0.9013; train_kl_reg_loss: 103143.5292; train_edge_recon_loss: 2755650.2538; train_gene_expr_recon_loss: 13838735.7405; train_masked_gp_l1_reg_loss: 82331.3706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135428.1734; train_chrom_access_recon_loss: 51120401.0992; train_global_loss: 68035689.9847; train_optim_loss: 68035689.9847; val_kl_reg_loss: 100809.8490; val_edge_recon_loss: 2768916.8667; val_gene_expr_recon_loss: 13657560.4667; val_masked_gp_l1_reg_loss: 82210.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136054.9531; val_chrom_access_recon_loss: 50607181.8667; val_global_loss: 67352733.3333; val_optim_loss: 67352733.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9526; val_auprc_score: 0.9363; val_best_acc_score: 0.8957; val_best_f1_score: 0.8992; train_kl_reg_loss: 102718.6947; train_edge_recon_loss: 2750304.4599; train_gene_expr_recon_loss: 13785708.3435; train_masked_gp_l1_reg_loss: 82159.0759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135042.5606; train_chrom_access_recon_loss: 50844610.3206; train_global_loss: 67700543.3282; train_optim_loss: 67700543.3282; val_kl_reg_loss: 102387.7953; val_edge_recon_loss: 2749803.6833; val_gene_expr_recon_loss: 13684394.1333; val_masked_gp_l1_reg_loss: 81941.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134085.5625; val_chrom_access_recon_loss: 50431861.3333; val_global_loss: 67184474.6667; val_optim_loss: 67184474.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9577; val_auprc_score: 0.9443; val_best_acc_score: 0.9027; val_best_f1_score: 0.9080; train_kl_reg_loss: 105091.7569; train_edge_recon_loss: 2736352.9294; train_gene_expr_recon_loss: 13785377.2672; train_masked_gp_l1_reg_loss: 81804.6424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134376.5819; train_chrom_access_recon_loss: 50831210.5344; train_global_loss: 67674213.7405; train_optim_loss: 67674213.7405; val_kl_reg_loss: 104305.4729; val_edge_recon_loss: 2732354.8167; val_gene_expr_recon_loss: 13655883.4667; val_masked_gp_l1_reg_loss: 81802.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135029.5156; val_chrom_access_recon_loss: 50598328.2667; val_global_loss: 67307704.5333; val_optim_loss: 67307704.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9389; val_best_acc_score: 0.9038; val_best_f1_score: 0.9085; train_kl_reg_loss: 104862.2607; train_edge_recon_loss: 2740292.6031; train_gene_expr_recon_loss: 13755750.2519; train_masked_gp_l1_reg_loss: 81583.9234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134787.9934; train_chrom_access_recon_loss: 50797060.9771; train_global_loss: 67614338.1374; train_optim_loss: 67614338.1374; val_kl_reg_loss: 103397.7964; val_edge_recon_loss: 2720250.5500; val_gene_expr_recon_loss: 13644574.6667; val_masked_gp_l1_reg_loss: 81645.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140631.0938; val_chrom_access_recon_loss: 50387173.0667; val_global_loss: 67077673.3333; val_optim_loss: 67077673.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9584; val_auprc_score: 0.9469; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 103497.9947; train_edge_recon_loss: 2729242.5725; train_gene_expr_recon_loss: 13758938.7023; train_masked_gp_l1_reg_loss: 81393.4808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138532.7125; train_chrom_access_recon_loss: 50755634.1069; train_global_loss: 67567239.5115; train_optim_loss: 67567239.5115; val_kl_reg_loss: 101787.4193; val_edge_recon_loss: 2736458.2833; val_gene_expr_recon_loss: 13636709.6667; val_masked_gp_l1_reg_loss: 81211.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136520.7031; val_chrom_access_recon_loss: 50349759.7333; val_global_loss: 67042447.2000; val_optim_loss: 67042447.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9587; val_auprc_score: 0.9476; val_best_acc_score: 0.8989; val_best_f1_score: 0.9055; train_kl_reg_loss: 98817.0444; train_edge_recon_loss: 2733467.2634; train_gene_expr_recon_loss: 13762834.4656; train_masked_gp_l1_reg_loss: 81868.2182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138179.8661; train_chrom_access_recon_loss: 50784233.5573; train_global_loss: 67599400.3664; train_optim_loss: 67599400.3664; val_kl_reg_loss: 96272.4375; val_edge_recon_loss: 2743268.1000; val_gene_expr_recon_loss: 13564472.3333; val_masked_gp_l1_reg_loss: 81954.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138364.5156; val_chrom_access_recon_loss: 50127630.9333; val_global_loss: 66751962.6667; val_optim_loss: 66751962.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9609; val_auprc_score: 0.9503; val_best_acc_score: 0.9045; val_best_f1_score: 0.9089; train_kl_reg_loss: 100452.3419; train_edge_recon_loss: 2733438.1737; train_gene_expr_recon_loss: 13729190.8015; train_masked_gp_l1_reg_loss: 81403.8501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136996.0036; train_chrom_access_recon_loss: 50672681.8015; train_global_loss: 67454163.1145; train_optim_loss: 67454163.1145; val_kl_reg_loss: 98594.8693; val_edge_recon_loss: 2744140.8167; val_gene_expr_recon_loss: 13594361.6000; val_masked_gp_l1_reg_loss: 80877.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135846.0469; val_chrom_access_recon_loss: 50260035.7333; val_global_loss: 66913857.6000; val_optim_loss: 66913857.6000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9586; val_auprc_score: 0.9458; val_best_acc_score: 0.9033; val_best_f1_score: 0.9069; train_kl_reg_loss: 101515.4989; train_edge_recon_loss: 2733569.1508; train_gene_expr_recon_loss: 13735513.7481; train_masked_gp_l1_reg_loss: 80786.3934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136446.1480; train_chrom_access_recon_loss: 50645762.9924; train_global_loss: 67433594.1069; train_optim_loss: 67433594.1069; val_kl_reg_loss: 100399.9281; val_edge_recon_loss: 2744578.3833; val_gene_expr_recon_loss: 13598172.2667; val_masked_gp_l1_reg_loss: 80722.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136961.4844; val_chrom_access_recon_loss: 50220496.8000; val_global_loss: 66881331.4667; val_optim_loss: 66881331.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9578; val_auprc_score: 0.9442; val_best_acc_score: 0.9007; val_best_f1_score: 0.9045; train_kl_reg_loss: 100967.1848; train_edge_recon_loss: 2717008.4389; train_gene_expr_recon_loss: 13718354.8855; train_masked_gp_l1_reg_loss: 80554.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135676.6097; train_chrom_access_recon_loss: 50548999.4504; train_global_loss: 67301561.1908; train_optim_loss: 67301561.1908; val_kl_reg_loss: 99661.4880; val_edge_recon_loss: 2756179.1333; val_gene_expr_recon_loss: 13585716.0000; val_masked_gp_l1_reg_loss: 80465.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135090.6875; val_chrom_access_recon_loss: 50182384.8000; val_global_loss: 66839498.6667; val_optim_loss: 66839498.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9555; val_auprc_score: 0.9379; val_best_acc_score: 0.9019; val_best_f1_score: 0.9065; train_kl_reg_loss: 109855.0497; train_edge_recon_loss: 2747212.2042; train_gene_expr_recon_loss: 13781149.0534; train_masked_gp_l1_reg_loss: 80940.3441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143696.7734; train_chrom_access_recon_loss: 51238305.0687; train_global_loss: 68101158.9008; train_optim_loss: 68101158.9008; val_kl_reg_loss: 100764.7286; val_edge_recon_loss: 2748638.8667; val_gene_expr_recon_loss: 13559210.8667; val_masked_gp_l1_reg_loss: 80307.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138249.7031; val_chrom_access_recon_loss: 50109732.8000; val_global_loss: 66736904.8000; val_optim_loss: 66736904.8000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9601; val_auprc_score: 0.9478; val_best_acc_score: 0.9037; val_best_f1_score: 0.9073; train_kl_reg_loss: 106674.7578; train_edge_recon_loss: 2737201.7195; train_gene_expr_recon_loss: 13759166.9542; train_masked_gp_l1_reg_loss: 81096.6963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138880.0870; train_chrom_access_recon_loss: 50840076.2443; train_global_loss: 67663096.3359; train_optim_loss: 67663096.3359; val_kl_reg_loss: 99442.5224; val_edge_recon_loss: 2743719.3500; val_gene_expr_recon_loss: 13615910.9333; val_masked_gp_l1_reg_loss: 80989.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138161.7500; val_chrom_access_recon_loss: 50346801.8667; val_global_loss: 67025026.1333; val_optim_loss: 67025026.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9597; val_auprc_score: 0.9450; val_best_acc_score: 0.9074; val_best_f1_score: 0.9111; train_kl_reg_loss: 101280.8789; train_edge_recon_loss: 2731078.8817; train_gene_expr_recon_loss: 13737962.6641; train_masked_gp_l1_reg_loss: 80921.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137866.8882; train_chrom_access_recon_loss: 50669157.8931; train_global_loss: 67458268.5191; train_optim_loss: 67458268.5191; val_kl_reg_loss: 102423.8625; val_edge_recon_loss: 2728314.4333; val_gene_expr_recon_loss: 13583226.0667; val_masked_gp_l1_reg_loss: 80885.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138214.4219; val_chrom_access_recon_loss: 50283050.9333; val_global_loss: 66916115.7333; val_optim_loss: 66916115.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9605; val_auprc_score: 0.9493; val_best_acc_score: 0.9088; val_best_f1_score: 0.9128; train_kl_reg_loss: 101336.6014; train_edge_recon_loss: 2727221.1718; train_gene_expr_recon_loss: 13701409.2290; train_masked_gp_l1_reg_loss: 80477.3705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137402.4549; train_chrom_access_recon_loss: 50526407.7252; train_global_loss: 67274254.6565; train_optim_loss: 67274254.6565; val_kl_reg_loss: 97758.5693; val_edge_recon_loss: 2735348.7500; val_gene_expr_recon_loss: 13566818.8667; val_masked_gp_l1_reg_loss: 79989.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135853.1250; val_chrom_access_recon_loss: 50180163.7333; val_global_loss: 66795933.3333; val_optim_loss: 66795933.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9637; val_auprc_score: 0.9515; val_best_acc_score: 0.9143; val_best_f1_score: 0.9179; train_kl_reg_loss: 104578.0815; train_edge_recon_loss: 2721894.4065; train_gene_expr_recon_loss: 13706906.4809; train_masked_gp_l1_reg_loss: 79779.9595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134276.5797; train_chrom_access_recon_loss: 50536553.4962; train_global_loss: 67283989.1298; train_optim_loss: 67283989.1298; val_kl_reg_loss: 103054.5188; val_edge_recon_loss: 2715813.3833; val_gene_expr_recon_loss: 13507498.0000; val_masked_gp_l1_reg_loss: 79680.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135286.3438; val_chrom_access_recon_loss: 50108331.2000; val_global_loss: 66649662.9333; val_optim_loss: 66649662.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9631; val_auprc_score: 0.9535; val_best_acc_score: 0.9077; val_best_f1_score: 0.9110; train_kl_reg_loss: 100515.2611; train_edge_recon_loss: 2734277.4447; train_gene_expr_recon_loss: 13731719.4122; train_masked_gp_l1_reg_loss: 79836.4012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135226.5573; train_chrom_access_recon_loss: 50583376.5802; train_global_loss: 67364951.8168; train_optim_loss: 67364951.8168; val_kl_reg_loss: 98013.0036; val_edge_recon_loss: 2744824.1333; val_gene_expr_recon_loss: 13586348.9333; val_masked_gp_l1_reg_loss: 79797.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135640.0781; val_chrom_access_recon_loss: 50183769.3333; val_global_loss: 66828392.0000; val_optim_loss: 66828392.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9634; val_auprc_score: 0.9514; val_best_acc_score: 0.9101; val_best_f1_score: 0.9147; train_kl_reg_loss: 99945.1893; train_edge_recon_loss: 2724097.9981; train_gene_expr_recon_loss: 13703617.2672; train_masked_gp_l1_reg_loss: 79796.4544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136067.9741; train_chrom_access_recon_loss: 50499832.8244; train_global_loss: 67243357.9237; train_optim_loss: 67243357.9237; val_kl_reg_loss: 99107.2937; val_edge_recon_loss: 2727271.1333; val_gene_expr_recon_loss: 13575409.8667; val_masked_gp_l1_reg_loss: 79897.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136554.4844; val_chrom_access_recon_loss: 50339190.1333; val_global_loss: 66957430.9333; val_optim_loss: 66957430.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9626; val_auprc_score: 0.9515; val_best_acc_score: 0.9119; val_best_f1_score: 0.9148; train_kl_reg_loss: 102013.3109; train_edge_recon_loss: 2719928.2939; train_gene_expr_recon_loss: 13701472.4962; train_masked_gp_l1_reg_loss: 79635.1202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135505.2586; train_chrom_access_recon_loss: 50564023.8473; train_global_loss: 67302578.0763; train_optim_loss: 67302578.0763; val_kl_reg_loss: 106921.2036; val_edge_recon_loss: 2736427.1667; val_gene_expr_recon_loss: 13555257.8000; val_masked_gp_l1_reg_loss: 79377.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134474.7812; val_chrom_access_recon_loss: 50278037.8667; val_global_loss: 66890496.8000; val_optim_loss: 66890496.8000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9598; val_auprc_score: 0.9486; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 105433.1171; train_edge_recon_loss: 2721679.2137; train_gene_expr_recon_loss: 13699200.6183; train_masked_gp_l1_reg_loss: 79672.0515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136046.5912; train_chrom_access_recon_loss: 50608389.9237; train_global_loss: 67350421.5878; train_optim_loss: 67350421.5878; val_kl_reg_loss: 96767.9271; val_edge_recon_loss: 2750140.9333; val_gene_expr_recon_loss: 13605159.4667; val_masked_gp_l1_reg_loss: 81024.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138198.2969; val_chrom_access_recon_loss: 50467170.6667; val_global_loss: 67138461.0667; val_optim_loss: 67138461.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9578; val_auprc_score: 0.9460; val_best_acc_score: 0.9049; val_best_f1_score: 0.9093; train_kl_reg_loss: 111226.8056; train_edge_recon_loss: 2725639.7481; train_gene_expr_recon_loss: 13702605.7099; train_masked_gp_l1_reg_loss: 79432.7552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99507.7057; train_chrom_access_recon_loss: 50439062.2290; train_global_loss: 67157475.1450; train_optim_loss: 67157475.1450; val_kl_reg_loss: 98933.6078; val_edge_recon_loss: 2773242.6833; val_gene_expr_recon_loss: 13611909.3333; val_masked_gp_l1_reg_loss: 78570.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96092.2031; val_chrom_access_recon_loss: 50426160.8000; val_global_loss: 67084908.5333; val_optim_loss: 67084908.5333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9629; val_auprc_score: 0.9495; val_best_acc_score: 0.9122; val_best_f1_score: 0.9145; train_kl_reg_loss: 100488.3690; train_edge_recon_loss: 2721562.3435; train_gene_expr_recon_loss: 13696563.2748; train_masked_gp_l1_reg_loss: 78278.6984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95650.9827; train_chrom_access_recon_loss: 50345698.5954; train_global_loss: 67038242.4427; train_optim_loss: 67038242.4427; val_kl_reg_loss: 99957.0214; val_edge_recon_loss: 2740368.6500; val_gene_expr_recon_loss: 13575503.4667; val_masked_gp_l1_reg_loss: 78033.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95306.2109; val_chrom_access_recon_loss: 50181995.2000; val_global_loss: 66771164.2667; val_optim_loss: 66771164.2667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9614; val_auprc_score: 0.9493; val_best_acc_score: 0.9113; val_best_f1_score: 0.9151; train_kl_reg_loss: 100602.9332; train_edge_recon_loss: 2719680.9637; train_gene_expr_recon_loss: 13685643.4351; train_masked_gp_l1_reg_loss: 77886.2155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95028.7128; train_chrom_access_recon_loss: 50371035.4504; train_global_loss: 67049877.5878; train_optim_loss: 67049877.5878; val_kl_reg_loss: 100226.3453; val_edge_recon_loss: 2732179.3333; val_gene_expr_recon_loss: 13556167.0000; val_masked_gp_l1_reg_loss: 77763.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94689.9688; val_chrom_access_recon_loss: 50221777.6000; val_global_loss: 66782803.2000; val_optim_loss: 66782803.2000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9629; val_auprc_score: 0.9502; val_best_acc_score: 0.9109; val_best_f1_score: 0.9145; train_kl_reg_loss: 101586.6947; train_edge_recon_loss: 2727726.2443; train_gene_expr_recon_loss: 13688256.2061; train_masked_gp_l1_reg_loss: 77684.9406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94483.9341; train_chrom_access_recon_loss: 50360062.1679; train_global_loss: 67049800.2748; train_optim_loss: 67049800.2748; val_kl_reg_loss: 101205.5630; val_edge_recon_loss: 2732682.0167; val_gene_expr_recon_loss: 13553088.9333; val_masked_gp_l1_reg_loss: 77587.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94268.4688; val_chrom_access_recon_loss: 50255763.4667; val_global_loss: 66814595.4667; val_optim_loss: 66814595.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 190 min 4 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9587
val AUPRC score: 0.9465
val best accuracy score: 0.9034
val best F1 score: 0.9083
val target rna MSE score: 0.9844
val source rna MSE score: 0.3049
val target atac MSE score: 0.1455
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
