Run timestamp: 20062023_155306_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 3, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 380406
Number of validation nodes: 42267
Number of training edges: 914339
Number of validation edges: 101593
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9358; val_auprc_score: 0.9652; val_best_acc_score: 0.9240; val_best_f1_score: 0.9496; train_kl_reg_loss: 6296.5276; train_edge_recon_loss: 158985.4644; train_cond_contrastive_loss: 34043.9681; train_gene_expr_recon_loss: 122745.1112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322071.0711; train_optim_loss: 322071.0711; val_kl_reg_loss: 6990.8836; val_edge_recon_loss: 146843.1200; val_cond_contrastive_loss: 33039.0914; val_gene_expr_recon_loss: 108060.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294933.8775; val_optim_loss: 294933.8775
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9380; val_auprc_score: 0.9674; val_best_acc_score: 0.9303; val_best_f1_score: 0.9537; train_kl_reg_loss: 6782.6551; train_edge_recon_loss: 146248.0597; train_cond_contrastive_loss: 33663.3089; train_gene_expr_recon_loss: 102950.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 289644.1632; train_optim_loss: 289644.1632; val_kl_reg_loss: 6560.1813; val_edge_recon_loss: 145939.5750; val_cond_contrastive_loss: 32839.0451; val_gene_expr_recon_loss: 99530.8659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284869.6700; val_optim_loss: 284869.6700
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9389; val_auprc_score: 0.9684; val_best_acc_score: 0.9321; val_best_f1_score: 0.9549; train_kl_reg_loss: 6246.5175; train_edge_recon_loss: 144731.6738; train_cond_contrastive_loss: 33571.4184; train_gene_expr_recon_loss: 96767.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281316.7476; train_optim_loss: 281316.7476; val_kl_reg_loss: 5748.1827; val_edge_recon_loss: 144848.3231; val_cond_contrastive_loss: 32964.5508; val_gene_expr_recon_loss: 95035.4278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 278596.4825; val_optim_loss: 278596.4825
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9393; val_auprc_score: 0.9685; val_best_acc_score: 0.9322; val_best_f1_score: 0.9550; train_kl_reg_loss: 6022.8972; train_edge_recon_loss: 143858.2602; train_cond_contrastive_loss: 33500.0640; train_gene_expr_recon_loss: 93334.1177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 276715.3394; train_optim_loss: 276715.3394; val_kl_reg_loss: 5848.6953; val_edge_recon_loss: 144132.6019; val_cond_contrastive_loss: 32970.5129; val_gene_expr_recon_loss: 92274.3050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275226.1088; val_optim_loss: 275226.1088
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9391; val_auprc_score: 0.9683; val_best_acc_score: 0.9325; val_best_f1_score: 0.9551; train_kl_reg_loss: 5979.4904; train_edge_recon_loss: 143411.5869; train_cond_contrastive_loss: 33439.8725; train_gene_expr_recon_loss: 91021.0307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273851.9801; train_optim_loss: 273851.9801; val_kl_reg_loss: 5788.0025; val_edge_recon_loss: 144831.2544; val_cond_contrastive_loss: 32920.1745; val_gene_expr_recon_loss: 90359.7997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 273899.2313; val_optim_loss: 273899.2313
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9356; val_auprc_score: 0.9664; val_best_acc_score: 0.9345; val_best_f1_score: 0.9565; train_kl_reg_loss: 5996.0699; train_edge_recon_loss: 143581.8267; train_cond_contrastive_loss: 33418.5775; train_gene_expr_recon_loss: 89260.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272257.2307; train_optim_loss: 272257.2307; val_kl_reg_loss: 5892.9390; val_edge_recon_loss: 144943.0381; val_cond_contrastive_loss: 32788.1667; val_gene_expr_recon_loss: 88742.5334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272366.6713; val_optim_loss: 272366.6713
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9373; val_auprc_score: 0.9681; val_best_acc_score: 0.9320; val_best_f1_score: 0.9549; train_kl_reg_loss: 6037.5926; train_edge_recon_loss: 143094.6807; train_cond_contrastive_loss: 33423.6329; train_gene_expr_recon_loss: 87872.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 270428.8202; train_optim_loss: 270428.8202; val_kl_reg_loss: 5898.6995; val_edge_recon_loss: 144585.6281; val_cond_contrastive_loss: 32861.2805; val_gene_expr_recon_loss: 87586.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 270932.5338; val_optim_loss: 270932.5338
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9394; val_auprc_score: 0.9688; val_best_acc_score: 0.9343; val_best_f1_score: 0.9564; train_kl_reg_loss: 6076.3328; train_edge_recon_loss: 143264.0741; train_cond_contrastive_loss: 33380.3856; train_gene_expr_recon_loss: 86738.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269459.0714; train_optim_loss: 269459.0714; val_kl_reg_loss: 5843.7848; val_edge_recon_loss: 143950.9256; val_cond_contrastive_loss: 32920.1206; val_gene_expr_recon_loss: 86391.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269106.6825; val_optim_loss: 269106.6825
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9375; val_auprc_score: 0.9677; val_best_acc_score: 0.9346; val_best_f1_score: 0.9565; train_kl_reg_loss: 6104.1617; train_edge_recon_loss: 142885.2563; train_cond_contrastive_loss: 33347.8574; train_gene_expr_recon_loss: 85813.9652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268151.2401; train_optim_loss: 268151.2401; val_kl_reg_loss: 5890.5336; val_edge_recon_loss: 144952.2881; val_cond_contrastive_loss: 32891.0088; val_gene_expr_recon_loss: 85495.7516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269229.5837; val_optim_loss: 269229.5837
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9367; val_auprc_score: 0.9678; val_best_acc_score: 0.9338; val_best_f1_score: 0.9561; train_kl_reg_loss: 6147.0171; train_edge_recon_loss: 143519.0355; train_cond_contrastive_loss: 33320.1161; train_gene_expr_recon_loss: 85060.3866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 268046.5557; train_optim_loss: 268046.5557; val_kl_reg_loss: 5969.0435; val_edge_recon_loss: 143934.8644; val_cond_contrastive_loss: 32860.3245; val_gene_expr_recon_loss: 84937.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267701.3650; val_optim_loss: 267701.3650
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9354; val_auprc_score: 0.9665; val_best_acc_score: 0.9350; val_best_f1_score: 0.9568; train_kl_reg_loss: 6170.3132; train_edge_recon_loss: 143172.4337; train_cond_contrastive_loss: 33292.6755; train_gene_expr_recon_loss: 84402.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267038.1057; train_optim_loss: 267038.1057; val_kl_reg_loss: 6143.4896; val_edge_recon_loss: 144165.3844; val_cond_contrastive_loss: 32837.2639; val_gene_expr_recon_loss: 84340.7953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267486.9313; val_optim_loss: 267486.9313
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9376; val_auprc_score: 0.9682; val_best_acc_score: 0.9338; val_best_f1_score: 0.9560; train_kl_reg_loss: 6211.6839; train_edge_recon_loss: 143603.1876; train_cond_contrastive_loss: 33269.1140; train_gene_expr_recon_loss: 83864.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266948.8777; train_optim_loss: 266948.8777; val_kl_reg_loss: 6116.3254; val_edge_recon_loss: 144999.1137; val_cond_contrastive_loss: 32845.8689; val_gene_expr_recon_loss: 83832.7306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267794.0400; val_optim_loss: 267794.0400
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9360; val_auprc_score: 0.9670; val_best_acc_score: 0.9353; val_best_f1_score: 0.9570; train_kl_reg_loss: 6225.6509; train_edge_recon_loss: 143218.4248; train_cond_contrastive_loss: 33225.1004; train_gene_expr_recon_loss: 83339.9274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266009.1021; train_optim_loss: 266009.1021; val_kl_reg_loss: 6120.8526; val_edge_recon_loss: 144320.5119; val_cond_contrastive_loss: 32757.7841; val_gene_expr_recon_loss: 83451.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266651.0956; val_optim_loss: 266651.0956
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9320; val_auprc_score: 0.9651; val_best_acc_score: 0.9351; val_best_f1_score: 0.9570; train_kl_reg_loss: 6251.3678; train_edge_recon_loss: 143041.3264; train_cond_contrastive_loss: 33199.8255; train_gene_expr_recon_loss: 82913.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265406.0091; train_optim_loss: 265406.0091; val_kl_reg_loss: 6121.4626; val_edge_recon_loss: 143938.2944; val_cond_contrastive_loss: 32707.7748; val_gene_expr_recon_loss: 82976.8034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265744.3375; val_optim_loss: 265744.3375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9385; val_auprc_score: 0.9686; val_best_acc_score: 0.9361; val_best_f1_score: 0.9575; train_kl_reg_loss: 6272.6661; train_edge_recon_loss: 143083.9725; train_cond_contrastive_loss: 33172.2753; train_gene_expr_recon_loss: 82528.7468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265057.6606; train_optim_loss: 265057.6606; val_kl_reg_loss: 6111.1576; val_edge_recon_loss: 143932.9950; val_cond_contrastive_loss: 32796.7165; val_gene_expr_recon_loss: 82659.7612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265500.6300; val_optim_loss: 265500.6300
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9335; val_auprc_score: 0.9656; val_best_acc_score: 0.9367; val_best_f1_score: 0.9579; train_kl_reg_loss: 6287.3638; train_edge_recon_loss: 143059.3721; train_cond_contrastive_loss: 33149.6839; train_gene_expr_recon_loss: 82161.6731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264658.0931; train_optim_loss: 264658.0931; val_kl_reg_loss: 5992.5945; val_edge_recon_loss: 143668.8450; val_cond_contrastive_loss: 32665.6801; val_gene_expr_recon_loss: 82287.5006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264614.6206; val_optim_loss: 264614.6206
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9369; val_auprc_score: 0.9678; val_best_acc_score: 0.9373; val_best_f1_score: 0.9583; train_kl_reg_loss: 6309.6189; train_edge_recon_loss: 143036.5105; train_cond_contrastive_loss: 33117.9975; train_gene_expr_recon_loss: 81850.1408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264314.2686; train_optim_loss: 264314.2686; val_kl_reg_loss: 6204.0551; val_edge_recon_loss: 143454.9806; val_cond_contrastive_loss: 32763.7227; val_gene_expr_recon_loss: 82192.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264614.9050; val_optim_loss: 264614.9050
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9341; val_auprc_score: 0.9658; val_best_acc_score: 0.9362; val_best_f1_score: 0.9576; train_kl_reg_loss: 6327.7419; train_edge_recon_loss: 143017.1302; train_cond_contrastive_loss: 33115.0678; train_gene_expr_recon_loss: 81583.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264043.5688; train_optim_loss: 264043.5688; val_kl_reg_loss: 6165.1480; val_edge_recon_loss: 143857.2844; val_cond_contrastive_loss: 32771.7824; val_gene_expr_recon_loss: 81792.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264586.3594; val_optim_loss: 264586.3594
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9342; val_auprc_score: 0.9662; val_best_acc_score: 0.9366; val_best_f1_score: 0.9578; train_kl_reg_loss: 6339.9085; train_edge_recon_loss: 143029.8398; train_cond_contrastive_loss: 33091.5218; train_gene_expr_recon_loss: 81332.1032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263793.3735; train_optim_loss: 263793.3735; val_kl_reg_loss: 6190.0222; val_edge_recon_loss: 144135.0438; val_cond_contrastive_loss: 32684.7498; val_gene_expr_recon_loss: 81659.7550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264669.5719; val_optim_loss: 264669.5719
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9349; val_auprc_score: 0.9663; val_best_acc_score: 0.9367; val_best_f1_score: 0.9579; train_kl_reg_loss: 6361.1010; train_edge_recon_loss: 142799.6048; train_cond_contrastive_loss: 33062.9061; train_gene_expr_recon_loss: 81073.9590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263297.5715; train_optim_loss: 263297.5715; val_kl_reg_loss: 6203.3593; val_edge_recon_loss: 144395.4556; val_cond_contrastive_loss: 32660.9652; val_gene_expr_recon_loss: 81287.8331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264547.6163; val_optim_loss: 264547.6163
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9324; val_auprc_score: 0.9641; val_best_acc_score: 0.9382; val_best_f1_score: 0.9589; train_kl_reg_loss: 6369.6029; train_edge_recon_loss: 143080.3239; train_cond_contrastive_loss: 33043.3836; train_gene_expr_recon_loss: 80886.9425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263380.2534; train_optim_loss: 263380.2534; val_kl_reg_loss: 6217.2673; val_edge_recon_loss: 144290.2919; val_cond_contrastive_loss: 32615.6852; val_gene_expr_recon_loss: 81163.0484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264286.2969; val_optim_loss: 264286.2969
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9338; val_auprc_score: 0.9652; val_best_acc_score: 0.9374; val_best_f1_score: 0.9583; train_kl_reg_loss: 6377.8333; train_edge_recon_loss: 142609.1492; train_cond_contrastive_loss: 33024.0687; train_gene_expr_recon_loss: 80671.7513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262682.8022; train_optim_loss: 262682.8022; val_kl_reg_loss: 6308.1164; val_edge_recon_loss: 144967.5375; val_cond_contrastive_loss: 32664.7073; val_gene_expr_recon_loss: 81002.6947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264943.0544; val_optim_loss: 264943.0544
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9357; val_auprc_score: 0.9666; val_best_acc_score: 0.9388; val_best_f1_score: 0.9593; train_kl_reg_loss: 6390.6309; train_edge_recon_loss: 142798.6074; train_cond_contrastive_loss: 33034.8766; train_gene_expr_recon_loss: 80495.2623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262719.3779; train_optim_loss: 262719.3779; val_kl_reg_loss: 6240.1418; val_edge_recon_loss: 143947.0275; val_cond_contrastive_loss: 32613.6475; val_gene_expr_recon_loss: 80888.8741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263689.6944; val_optim_loss: 263689.6944
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9341; val_auprc_score: 0.9655; val_best_acc_score: 0.9383; val_best_f1_score: 0.9589; train_kl_reg_loss: 6404.2678; train_edge_recon_loss: 142931.8763; train_cond_contrastive_loss: 33012.9992; train_gene_expr_recon_loss: 80308.1243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262657.2670; train_optim_loss: 262657.2670; val_kl_reg_loss: 6196.6159; val_edge_recon_loss: 143852.1356; val_cond_contrastive_loss: 32700.6799; val_gene_expr_recon_loss: 80723.7612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263473.1919; val_optim_loss: 263473.1919
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9380; val_auprc_score: 0.9678; val_best_acc_score: 0.9391; val_best_f1_score: 0.9595; train_kl_reg_loss: 6420.7904; train_edge_recon_loss: 143014.5838; train_cond_contrastive_loss: 33008.3488; train_gene_expr_recon_loss: 80213.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262656.8030; train_optim_loss: 262656.8030; val_kl_reg_loss: 6189.6973; val_edge_recon_loss: 143773.8219; val_cond_contrastive_loss: 32686.8116; val_gene_expr_recon_loss: 80606.3894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263256.7194; val_optim_loss: 263256.7194
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9319; val_auprc_score: 0.9641; val_best_acc_score: 0.9382; val_best_f1_score: 0.9590; train_kl_reg_loss: 6347.8909; train_edge_recon_loss: 142684.5091; train_cond_contrastive_loss: 33038.2464; train_gene_expr_recon_loss: 80035.2415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262105.8869; train_optim_loss: 262105.8869; val_kl_reg_loss: 6071.9071; val_edge_recon_loss: 143845.6781; val_cond_contrastive_loss: 32579.8708; val_gene_expr_recon_loss: 80507.8794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263005.3344; val_optim_loss: 263005.3344
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9331; val_auprc_score: 0.9649; val_best_acc_score: 0.9383; val_best_f1_score: 0.9589; train_kl_reg_loss: 6288.3295; train_edge_recon_loss: 142538.4123; train_cond_contrastive_loss: 32956.1794; train_gene_expr_recon_loss: 79944.8657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261727.7868; train_optim_loss: 261727.7868; val_kl_reg_loss: 6115.2053; val_edge_recon_loss: 144102.2412; val_cond_contrastive_loss: 32607.1674; val_gene_expr_recon_loss: 80405.6413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263230.2581; val_optim_loss: 263230.2581
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9338; val_auprc_score: 0.9655; val_best_acc_score: 0.9388; val_best_f1_score: 0.9593; train_kl_reg_loss: 6281.1360; train_edge_recon_loss: 142767.8504; train_cond_contrastive_loss: 32935.6363; train_gene_expr_recon_loss: 79830.2149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261814.8371; train_optim_loss: 261814.8371; val_kl_reg_loss: 6152.1988; val_edge_recon_loss: 143678.1819; val_cond_contrastive_loss: 32661.4314; val_gene_expr_recon_loss: 80386.4831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262878.2919; val_optim_loss: 262878.2919
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9339; val_auprc_score: 0.9655; val_best_acc_score: 0.9388; val_best_f1_score: 0.9593; train_kl_reg_loss: 6281.2262; train_edge_recon_loss: 142592.7934; train_cond_contrastive_loss: 32907.3633; train_gene_expr_recon_loss: 79704.1502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261485.5326; train_optim_loss: 261485.5326; val_kl_reg_loss: 6142.6814; val_edge_recon_loss: 144048.5775; val_cond_contrastive_loss: 32634.4137; val_gene_expr_recon_loss: 80214.5013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263040.1775; val_optim_loss: 263040.1775
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9309; val_auprc_score: 0.9630; val_best_acc_score: 0.9386; val_best_f1_score: 0.9591; train_kl_reg_loss: 6284.1440; train_edge_recon_loss: 142518.7953; train_cond_contrastive_loss: 32894.0255; train_gene_expr_recon_loss: 79645.2619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261342.2272; train_optim_loss: 261342.2272; val_kl_reg_loss: 6171.6367; val_edge_recon_loss: 144646.4425; val_cond_contrastive_loss: 32528.0088; val_gene_expr_recon_loss: 80205.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263551.1306; val_optim_loss: 263551.1306
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9323; val_auprc_score: 0.9642; val_best_acc_score: 0.9397; val_best_f1_score: 0.9599; train_kl_reg_loss: 6293.3232; train_edge_recon_loss: 142697.7536; train_cond_contrastive_loss: 32893.0734; train_gene_expr_recon_loss: 79532.4425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261416.5929; train_optim_loss: 261416.5929; val_kl_reg_loss: 6142.8421; val_edge_recon_loss: 143847.9206; val_cond_contrastive_loss: 32510.3023; val_gene_expr_recon_loss: 80195.0450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262696.1075; val_optim_loss: 262696.1075
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9350; val_auprc_score: 0.9663; val_best_acc_score: 0.9391; val_best_f1_score: 0.9595; train_kl_reg_loss: 6298.7942; train_edge_recon_loss: 142536.4397; train_cond_contrastive_loss: 32862.7656; train_gene_expr_recon_loss: 79445.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261143.6101; train_optim_loss: 261143.6101; val_kl_reg_loss: 6155.7294; val_edge_recon_loss: 143611.9356; val_cond_contrastive_loss: 32549.3438; val_gene_expr_recon_loss: 80051.6600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262368.6713; val_optim_loss: 262368.6713
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9329; val_auprc_score: 0.9644; val_best_acc_score: 0.9389; val_best_f1_score: 0.9593; train_kl_reg_loss: 6290.7117; train_edge_recon_loss: 142816.1892; train_cond_contrastive_loss: 32856.1734; train_gene_expr_recon_loss: 79373.7522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261336.8267; train_optim_loss: 261336.8267; val_kl_reg_loss: 6141.1434; val_edge_recon_loss: 144024.9144; val_cond_contrastive_loss: 32564.2612; val_gene_expr_recon_loss: 79998.6553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262728.9713; val_optim_loss: 262728.9713
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9340; val_auprc_score: 0.9659; val_best_acc_score: 0.9391; val_best_f1_score: 0.9595; train_kl_reg_loss: 6300.8650; train_edge_recon_loss: 142643.8304; train_cond_contrastive_loss: 32856.6144; train_gene_expr_recon_loss: 79282.3063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261083.6168; train_optim_loss: 261083.6168; val_kl_reg_loss: 6100.4244; val_edge_recon_loss: 143255.0825; val_cond_contrastive_loss: 32519.5398; val_gene_expr_recon_loss: 79863.6622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261738.7081; val_optim_loss: 261738.7081
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9357; val_auprc_score: 0.9666; val_best_acc_score: 0.9387; val_best_f1_score: 0.9591; train_kl_reg_loss: 6309.6160; train_edge_recon_loss: 142607.1274; train_cond_contrastive_loss: 32841.2145; train_gene_expr_recon_loss: 79229.0308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260986.9891; train_optim_loss: 260986.9891; val_kl_reg_loss: 6145.4545; val_edge_recon_loss: 144453.1350; val_cond_contrastive_loss: 32566.8847; val_gene_expr_recon_loss: 79929.5272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263095.0025; val_optim_loss: 263095.0025
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9335; val_auprc_score: 0.9645; val_best_acc_score: 0.9415; val_best_f1_score: 0.9611; train_kl_reg_loss: 6307.3755; train_edge_recon_loss: 142638.8558; train_cond_contrastive_loss: 32833.2251; train_gene_expr_recon_loss: 79176.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260955.4814; train_optim_loss: 260955.4814; val_kl_reg_loss: 6158.6894; val_edge_recon_loss: 143073.5700; val_cond_contrastive_loss: 32461.3805; val_gene_expr_recon_loss: 79858.4837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261552.1244; val_optim_loss: 261552.1244
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9342; val_auprc_score: 0.9653; val_best_acc_score: 0.9403; val_best_f1_score: 0.9603; train_kl_reg_loss: 6304.3157; train_edge_recon_loss: 142646.8035; train_cond_contrastive_loss: 32825.6688; train_gene_expr_recon_loss: 79089.1717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260865.9588; train_optim_loss: 260865.9588; val_kl_reg_loss: 6100.0551; val_edge_recon_loss: 143514.7313; val_cond_contrastive_loss: 32515.9810; val_gene_expr_recon_loss: 79758.2709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261889.0394; val_optim_loss: 261889.0394
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9341; val_auprc_score: 0.9654; val_best_acc_score: 0.9403; val_best_f1_score: 0.9602; train_kl_reg_loss: 6303.4094; train_edge_recon_loss: 142637.3248; train_cond_contrastive_loss: 32809.6504; train_gene_expr_recon_loss: 79023.6052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260773.9914; train_optim_loss: 260773.9914; val_kl_reg_loss: 6284.0302; val_edge_recon_loss: 143224.3531; val_cond_contrastive_loss: 32470.6030; val_gene_expr_recon_loss: 79760.0734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261739.0575; val_optim_loss: 261739.0575
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9341; val_auprc_score: 0.9655; val_best_acc_score: 0.9403; val_best_f1_score: 0.9602; train_kl_reg_loss: 6300.6838; train_edge_recon_loss: 142469.1507; train_cond_contrastive_loss: 32793.4052; train_gene_expr_recon_loss: 79009.0364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260572.2762; train_optim_loss: 260572.2762; val_kl_reg_loss: 6178.2119; val_edge_recon_loss: 143694.7769; val_cond_contrastive_loss: 32467.3128; val_gene_expr_recon_loss: 79757.4475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262097.7475; val_optim_loss: 262097.7475

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9333; val_auprc_score: 0.9646; val_best_acc_score: 0.9402; val_best_f1_score: 0.9602; train_kl_reg_loss: 6272.0081; train_edge_recon_loss: 142637.1301; train_cond_contrastive_loss: 32798.7260; train_gene_expr_recon_loss: 78617.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260325.5300; train_optim_loss: 260325.5300; val_kl_reg_loss: 6140.1648; val_edge_recon_loss: 143866.0800; val_cond_contrastive_loss: 32514.0736; val_gene_expr_recon_loss: 79422.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261942.9525; val_optim_loss: 261942.9525
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9345; val_auprc_score: 0.9654; val_best_acc_score: 0.9410; val_best_f1_score: 0.9606; train_kl_reg_loss: 6266.4402; train_edge_recon_loss: 142557.4134; train_cond_contrastive_loss: 32805.4374; train_gene_expr_recon_loss: 78570.8832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260200.1752; train_optim_loss: 260200.1752; val_kl_reg_loss: 6150.8775; val_edge_recon_loss: 143805.1325; val_cond_contrastive_loss: 32485.9464; val_gene_expr_recon_loss: 79368.3938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261810.3500; val_optim_loss: 261810.3500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9301; val_auprc_score: 0.9634; val_best_acc_score: 0.9399; val_best_f1_score: 0.9601; train_kl_reg_loss: 6265.5522; train_edge_recon_loss: 142576.9482; train_cond_contrastive_loss: 32781.3980; train_gene_expr_recon_loss: 78551.6046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260175.5044; train_optim_loss: 260175.5044; val_kl_reg_loss: 6158.3086; val_edge_recon_loss: 143293.7987; val_cond_contrastive_loss: 32463.6528; val_gene_expr_recon_loss: 79373.0394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261288.7963; val_optim_loss: 261288.7963
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9334; val_auprc_score: 0.9653; val_best_acc_score: 0.9403; val_best_f1_score: 0.9603; train_kl_reg_loss: 6269.3276; train_edge_recon_loss: 142417.4069; train_cond_contrastive_loss: 32788.2598; train_gene_expr_recon_loss: 78544.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260019.0793; train_optim_loss: 260019.0793; val_kl_reg_loss: 6157.4013; val_edge_recon_loss: 143383.4594; val_cond_contrastive_loss: 32468.9299; val_gene_expr_recon_loss: 79436.6400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261446.4300; val_optim_loss: 261446.4300
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9346; val_auprc_score: 0.9657; val_best_acc_score: 0.9412; val_best_f1_score: 0.9608; train_kl_reg_loss: 6267.0425; train_edge_recon_loss: 142273.6915; train_cond_contrastive_loss: 32790.7919; train_gene_expr_recon_loss: 78527.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259859.5184; train_optim_loss: 259859.5184; val_kl_reg_loss: 6153.3408; val_edge_recon_loss: 143161.3625; val_cond_contrastive_loss: 32515.9417; val_gene_expr_recon_loss: 79357.2503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261187.8987; val_optim_loss: 261187.8987
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9329; val_auprc_score: 0.9651; val_best_acc_score: 0.9404; val_best_f1_score: 0.9604; train_kl_reg_loss: 6269.0043; train_edge_recon_loss: 142457.4289; train_cond_contrastive_loss: 32782.6855; train_gene_expr_recon_loss: 78537.6902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260046.8089; train_optim_loss: 260046.8089; val_kl_reg_loss: 6134.2712; val_edge_recon_loss: 143305.8406; val_cond_contrastive_loss: 32506.6174; val_gene_expr_recon_loss: 79275.6694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261222.3969; val_optim_loss: 261222.3969
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9336; val_auprc_score: 0.9652; val_best_acc_score: 0.9404; val_best_f1_score: 0.9604; train_kl_reg_loss: 6269.0019; train_edge_recon_loss: 142371.1004; train_cond_contrastive_loss: 32792.7439; train_gene_expr_recon_loss: 78486.3960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259919.2420; train_optim_loss: 259919.2420; val_kl_reg_loss: 6162.6646; val_edge_recon_loss: 143102.8138; val_cond_contrastive_loss: 32514.2357; val_gene_expr_recon_loss: 79374.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261153.8575; val_optim_loss: 261153.8575
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9337; val_auprc_score: 0.9652; val_best_acc_score: 0.9414; val_best_f1_score: 0.9610; train_kl_reg_loss: 6267.4006; train_edge_recon_loss: 142530.9549; train_cond_contrastive_loss: 32780.9847; train_gene_expr_recon_loss: 78513.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260093.2926; train_optim_loss: 260093.2926; val_kl_reg_loss: 6162.7537; val_edge_recon_loss: 143053.2956; val_cond_contrastive_loss: 32462.9378; val_gene_expr_recon_loss: 79413.0559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261092.0438; val_optim_loss: 261092.0438
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9323; val_auprc_score: 0.9644; val_best_acc_score: 0.9407; val_best_f1_score: 0.9605; train_kl_reg_loss: 6271.8092; train_edge_recon_loss: 142819.5165; train_cond_contrastive_loss: 32766.9768; train_gene_expr_recon_loss: 78510.2979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260368.6011; train_optim_loss: 260368.6011; val_kl_reg_loss: 6124.0775; val_edge_recon_loss: 143276.4962; val_cond_contrastive_loss: 32510.1252; val_gene_expr_recon_loss: 79368.1628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261278.8625; val_optim_loss: 261278.8625
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9329; val_auprc_score: 0.9647; val_best_acc_score: 0.9403; val_best_f1_score: 0.9602; train_kl_reg_loss: 6263.2509; train_edge_recon_loss: 142575.4398; train_cond_contrastive_loss: 32776.4162; train_gene_expr_recon_loss: 78501.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260117.0064; train_optim_loss: 260117.0064; val_kl_reg_loss: 6151.4241; val_edge_recon_loss: 143954.7538; val_cond_contrastive_loss: 32474.6813; val_gene_expr_recon_loss: 79210.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261791.4475; val_optim_loss: 261791.4475
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9318; val_auprc_score: 0.9641; val_best_acc_score: 0.9401; val_best_f1_score: 0.9601; train_kl_reg_loss: 6261.8336; train_edge_recon_loss: 142481.6629; train_cond_contrastive_loss: 32765.1963; train_gene_expr_recon_loss: 78431.2328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259939.9245; train_optim_loss: 259939.9245; val_kl_reg_loss: 6127.2975; val_edge_recon_loss: 144316.1106; val_cond_contrastive_loss: 32440.7766; val_gene_expr_recon_loss: 79310.1013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262194.2863; val_optim_loss: 262194.2863

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9335; val_auprc_score: 0.9648; val_best_acc_score: 0.9404; val_best_f1_score: 0.9603; train_kl_reg_loss: 6262.5274; train_edge_recon_loss: 142365.5764; train_cond_contrastive_loss: 32772.5626; train_gene_expr_recon_loss: 78433.2929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259833.9589; train_optim_loss: 259833.9589; val_kl_reg_loss: 6141.8984; val_edge_recon_loss: 143918.9219; val_cond_contrastive_loss: 32451.1251; val_gene_expr_recon_loss: 79224.7912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261736.7375; val_optim_loss: 261736.7375
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9332; val_auprc_score: 0.9649; val_best_acc_score: 0.9406; val_best_f1_score: 0.9604; train_kl_reg_loss: 6259.8854; train_edge_recon_loss: 142646.4818; train_cond_contrastive_loss: 32766.2685; train_gene_expr_recon_loss: 78410.2067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260082.8427; train_optim_loss: 260082.8427; val_kl_reg_loss: 6133.1253; val_edge_recon_loss: 143980.3838; val_cond_contrastive_loss: 32457.5540; val_gene_expr_recon_loss: 79298.3619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261869.4275; val_optim_loss: 261869.4275
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9325; val_auprc_score: 0.9644; val_best_acc_score: 0.9401; val_best_f1_score: 0.9601; train_kl_reg_loss: 6260.9346; train_edge_recon_loss: 142364.1629; train_cond_contrastive_loss: 32776.9114; train_gene_expr_recon_loss: 78427.6702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259829.6796; train_optim_loss: 259829.6796; val_kl_reg_loss: 6134.3351; val_edge_recon_loss: 144166.7513; val_cond_contrastive_loss: 32448.5288; val_gene_expr_recon_loss: 79275.1353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262024.7475; val_optim_loss: 262024.7475

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 221 min 24 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9323
Val AUPRC score: 0.9641
Val best accuracy score: 0.9397
Val best F1 score: 0.9598
Val gene expr MSE score: 0.5560

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
