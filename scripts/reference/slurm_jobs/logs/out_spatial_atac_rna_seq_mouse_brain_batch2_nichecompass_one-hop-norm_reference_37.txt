[True]
Run timestamp: 07092023_154026_37.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_37']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1133 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5654, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7643; val_auprc_score: 0.7819; val_best_acc_score: 0.5260; val_best_f1_score: 0.6768; train_kl_reg_loss: 94293.7484; train_edge_recon_loss: 3534906.3817; train_gene_expr_recon_loss: 16750327.9695; train_masked_gp_l1_reg_loss: 78569.5805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1131462.0367; train_chrom_access_recon_loss: 6550611.2824; train_global_loss: 28140171.1298; train_optim_loss: 28140171.1298; val_kl_reg_loss: 128979.7802; val_edge_recon_loss: 4063646.5167; val_gene_expr_recon_loss: 15485748.1333; val_masked_gp_l1_reg_loss: 71563.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 558707.8125; val_chrom_access_recon_loss: 6327715.5000; val_global_loss: 26636362.6667; val_optim_loss: 26636362.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8192; val_auprc_score: 0.8256; val_best_acc_score: 0.7394; val_best_f1_score: 0.7557; train_kl_reg_loss: 101091.5522; train_edge_recon_loss: 3525668.9237; train_gene_expr_recon_loss: 15561251.4198; train_masked_gp_l1_reg_loss: 71870.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 333635.3409; train_chrom_access_recon_loss: 6287585.7290; train_global_loss: 25881103.5267; train_optim_loss: 25881103.5267; val_kl_reg_loss: 93651.6219; val_edge_recon_loss: 4005758.9500; val_gene_expr_recon_loss: 15246384.4000; val_masked_gp_l1_reg_loss: 73652.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 198748.2188; val_chrom_access_recon_loss: 6264386.1333; val_global_loss: 25882581.0667; val_optim_loss: 25882581.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8757; val_auprc_score: 0.8668; val_best_acc_score: 0.7844; val_best_f1_score: 0.8007; train_kl_reg_loss: 84367.1737; train_edge_recon_loss: 3336229.5439; train_gene_expr_recon_loss: 15359984.3130; train_masked_gp_l1_reg_loss: 78497.3768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146531.4161; train_chrom_access_recon_loss: 6212080.8588; train_global_loss: 25217690.7176; train_optim_loss: 25217690.7176; val_kl_reg_loss: 107892.2943; val_edge_recon_loss: 3014352.9833; val_gene_expr_recon_loss: 15116168.4000; val_masked_gp_l1_reg_loss: 85229.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111141.1094; val_chrom_access_recon_loss: 6219908.7667; val_global_loss: 24654694.2667; val_optim_loss: 24654694.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8867; val_auprc_score: 0.8700; val_best_acc_score: 0.7990; val_best_f1_score: 0.8151; train_kl_reg_loss: 110111.5069; train_edge_recon_loss: 2953319.5477; train_gene_expr_recon_loss: 15171539.1679; train_masked_gp_l1_reg_loss: 86557.4424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91654.3510; train_chrom_access_recon_loss: 6137874.0229; train_global_loss: 24551056.0153; train_optim_loss: 24551056.0153; val_kl_reg_loss: 105726.7865; val_edge_recon_loss: 2931971.9667; val_gene_expr_recon_loss: 14956884.8000; val_masked_gp_l1_reg_loss: 88547.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77087.5938; val_chrom_access_recon_loss: 6138660.6000; val_global_loss: 24298880.2667; val_optim_loss: 24298880.2667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9007; val_auprc_score: 0.8813; val_best_acc_score: 0.8301; val_best_f1_score: 0.8434; train_kl_reg_loss: 103636.4902; train_edge_recon_loss: 2880241.4370; train_gene_expr_recon_loss: 15021593.6641; train_masked_gp_l1_reg_loss: 90551.4838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68584.5785; train_chrom_access_recon_loss: 6090631.0305; train_global_loss: 24255238.6107; train_optim_loss: 24255238.6107; val_kl_reg_loss: 104956.1422; val_edge_recon_loss: 2869324.5833; val_gene_expr_recon_loss: 14784547.5333; val_masked_gp_l1_reg_loss: 92538.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62194.7891; val_chrom_access_recon_loss: 6057025.0333; val_global_loss: 23970584.9333; val_optim_loss: 23970584.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9119; val_auprc_score: 0.8951; val_best_acc_score: 0.8440; val_best_f1_score: 0.8567; train_kl_reg_loss: 104280.1864; train_edge_recon_loss: 2850878.8740; train_gene_expr_recon_loss: 14880313.7481; train_masked_gp_l1_reg_loss: 94146.2310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57717.5729; train_chrom_access_recon_loss: 6037259.9733; train_global_loss: 24024596.5649; train_optim_loss: 24024596.5649; val_kl_reg_loss: 98294.9458; val_edge_recon_loss: 2851448.6500; val_gene_expr_recon_loss: 14668726.1333; val_masked_gp_l1_reg_loss: 95994.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53908.5508; val_chrom_access_recon_loss: 6019889.6000; val_global_loss: 23788261.3333; val_optim_loss: 23788261.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9218; val_auprc_score: 0.9051; val_best_acc_score: 0.8507; val_best_f1_score: 0.8616; train_kl_reg_loss: 103134.3129; train_edge_recon_loss: 2819166.8607; train_gene_expr_recon_loss: 14764010.1832; train_masked_gp_l1_reg_loss: 97186.3883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51043.0228; train_chrom_access_recon_loss: 5990261.8206; train_global_loss: 23824802.6718; train_optim_loss: 23824802.6718; val_kl_reg_loss: 98731.3214; val_edge_recon_loss: 2828758.9667; val_gene_expr_recon_loss: 14531855.5333; val_masked_gp_l1_reg_loss: 98688.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49242.9844; val_chrom_access_recon_loss: 5973561.8000; val_global_loss: 23580837.8667; val_optim_loss: 23580837.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9288; val_auprc_score: 0.9144; val_best_acc_score: 0.8597; val_best_f1_score: 0.8686; train_kl_reg_loss: 98259.2604; train_edge_recon_loss: 2805156.7958; train_gene_expr_recon_loss: 14660782.9237; train_masked_gp_l1_reg_loss: 99901.9543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47334.3310; train_chrom_access_recon_loss: 5947376.6679; train_global_loss: 23658811.9542; train_optim_loss: 23658811.9542; val_kl_reg_loss: 92102.8687; val_edge_recon_loss: 2801437.3167; val_gene_expr_recon_loss: 14451003.2667; val_masked_gp_l1_reg_loss: 101164.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45864.4180; val_chrom_access_recon_loss: 5934453.1333; val_global_loss: 23426024.4000; val_optim_loss: 23426024.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9305; val_auprc_score: 0.9146; val_best_acc_score: 0.8620; val_best_f1_score: 0.8689; train_kl_reg_loss: 96542.9980; train_edge_recon_loss: 2793106.1336; train_gene_expr_recon_loss: 14577402.1985; train_masked_gp_l1_reg_loss: 102178.9262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44585.3108; train_chrom_access_recon_loss: 5910445.2481; train_global_loss: 23524260.7939; train_optim_loss: 23524260.7939; val_kl_reg_loss: 92875.6318; val_edge_recon_loss: 2805940.2167; val_gene_expr_recon_loss: 14341535.8667; val_masked_gp_l1_reg_loss: 103356.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43962.4727; val_chrom_access_recon_loss: 5888742.8667; val_global_loss: 23276412.5333; val_optim_loss: 23276412.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9380; val_auprc_score: 0.9248; val_best_acc_score: 0.8743; val_best_f1_score: 0.8815; train_kl_reg_loss: 94248.2292; train_edge_recon_loss: 2772325.5553; train_gene_expr_recon_loss: 14496780.8702; train_masked_gp_l1_reg_loss: 104293.2466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42762.9599; train_chrom_access_recon_loss: 5871391.3511; train_global_loss: 23381802.0916; train_optim_loss: 23381802.0916; val_kl_reg_loss: 89754.2755; val_edge_recon_loss: 2778245.0333; val_gene_expr_recon_loss: 14213553.4000; val_masked_gp_l1_reg_loss: 105298.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42008.8164; val_chrom_access_recon_loss: 5838066.6667; val_global_loss: 23066925.7333; val_optim_loss: 23066925.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9388; val_auprc_score: 0.9202; val_best_acc_score: 0.8793; val_best_f1_score: 0.8858; train_kl_reg_loss: 91947.9105; train_edge_recon_loss: 2763433.9714; train_gene_expr_recon_loss: 14429362.6031; train_masked_gp_l1_reg_loss: 106340.0880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41854.0814; train_chrom_access_recon_loss: 5846722.1718; train_global_loss: 23279661.0687; train_optim_loss: 23279661.0687; val_kl_reg_loss: 90876.3818; val_edge_recon_loss: 2759969.0500; val_gene_expr_recon_loss: 14170546.2000; val_masked_gp_l1_reg_loss: 107159.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41804.9609; val_chrom_access_recon_loss: 5827413.6000; val_global_loss: 22997769.2000; val_optim_loss: 22997769.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9377; val_auprc_score: 0.9234; val_best_acc_score: 0.8758; val_best_f1_score: 0.8819; train_kl_reg_loss: 91953.0114; train_edge_recon_loss: 2745719.9771; train_gene_expr_recon_loss: 14359351.3664; train_masked_gp_l1_reg_loss: 108176.0897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41415.0222; train_chrom_access_recon_loss: 5818143.0000; train_global_loss: 23164758.4733; train_optim_loss: 23164758.4733; val_kl_reg_loss: 93978.8547; val_edge_recon_loss: 2780145.0000; val_gene_expr_recon_loss: 14171218.6667; val_masked_gp_l1_reg_loss: 109257.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41085.1758; val_chrom_access_recon_loss: 5817900.8667; val_global_loss: 23013586.5333; val_optim_loss: 23013586.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9489; val_auprc_score: 0.9365; val_best_acc_score: 0.8874; val_best_f1_score: 0.8934; train_kl_reg_loss: 91234.7601; train_edge_recon_loss: 2740826.7901; train_gene_expr_recon_loss: 14298566.5267; train_masked_gp_l1_reg_loss: 109705.1159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40848.9485; train_chrom_access_recon_loss: 5792024.2634; train_global_loss: 23073206.5344; train_optim_loss: 23073206.5344; val_kl_reg_loss: 89743.7854; val_edge_recon_loss: 2746470.0167; val_gene_expr_recon_loss: 14085706.7333; val_masked_gp_l1_reg_loss: 110736.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40990.6055; val_chrom_access_recon_loss: 5766126.5333; val_global_loss: 22839773.0667; val_optim_loss: 22839773.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9483; val_auprc_score: 0.9360; val_best_acc_score: 0.8879; val_best_f1_score: 0.8947; train_kl_reg_loss: 89758.8734; train_edge_recon_loss: 2730059.5840; train_gene_expr_recon_loss: 14245881.1069; train_masked_gp_l1_reg_loss: 111147.6844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40328.5337; train_chrom_access_recon_loss: 5771115.3855; train_global_loss: 22988291.2824; train_optim_loss: 22988291.2824; val_kl_reg_loss: 89509.8156; val_edge_recon_loss: 2761214.4167; val_gene_expr_recon_loss: 14091477.8000; val_masked_gp_l1_reg_loss: 111881.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39870.5273; val_chrom_access_recon_loss: 5767495.4333; val_global_loss: 22861449.6000; val_optim_loss: 22861449.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9545; val_auprc_score: 0.9436; val_best_acc_score: 0.8999; val_best_f1_score: 0.9035; train_kl_reg_loss: 87927.2233; train_edge_recon_loss: 2732559.5477; train_gene_expr_recon_loss: 14191856.3817; train_masked_gp_l1_reg_loss: 112481.9097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39632.9648; train_chrom_access_recon_loss: 5746374.2405; train_global_loss: 22910832.2901; train_optim_loss: 22910832.2901; val_kl_reg_loss: 87954.5302; val_edge_recon_loss: 2736763.7667; val_gene_expr_recon_loss: 14018186.5333; val_masked_gp_l1_reg_loss: 113257.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39527.4062; val_chrom_access_recon_loss: 5733538.3333; val_global_loss: 22729228.8000; val_optim_loss: 22729228.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9525; val_auprc_score: 0.9396; val_best_acc_score: 0.8949; val_best_f1_score: 0.9004; train_kl_reg_loss: 87229.5818; train_edge_recon_loss: 2725514.7156; train_gene_expr_recon_loss: 14157072.3053; train_masked_gp_l1_reg_loss: 113782.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39144.6796; train_chrom_access_recon_loss: 5731932.0916; train_global_loss: 22854675.5725; train_optim_loss: 22854675.5725; val_kl_reg_loss: 84771.2693; val_edge_recon_loss: 2736257.5167; val_gene_expr_recon_loss: 13949602.4667; val_masked_gp_l1_reg_loss: 114189.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39245.2227; val_chrom_access_recon_loss: 5725386.0000; val_global_loss: 22649452.6667; val_optim_loss: 22649452.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9597; val_auprc_score: 0.9491; val_best_acc_score: 0.9010; val_best_f1_score: 0.9053; train_kl_reg_loss: 85549.9833; train_edge_recon_loss: 2721351.7538; train_gene_expr_recon_loss: 14107402.7252; train_masked_gp_l1_reg_loss: 114757.8011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38751.3046; train_chrom_access_recon_loss: 5711215.2214; train_global_loss: 22779028.9771; train_optim_loss: 22779028.9771; val_kl_reg_loss: 85661.9510; val_edge_recon_loss: 2729134.1333; val_gene_expr_recon_loss: 13955192.8000; val_masked_gp_l1_reg_loss: 115590.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38985.3555; val_chrom_access_recon_loss: 5714602.5667; val_global_loss: 22639167.2000; val_optim_loss: 22639167.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9580; val_auprc_score: 0.9456; val_best_acc_score: 0.8976; val_best_f1_score: 0.9018; train_kl_reg_loss: 85270.9138; train_edge_recon_loss: 2718426.2176; train_gene_expr_recon_loss: 14076674.6183; train_masked_gp_l1_reg_loss: 115925.7691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38503.9522; train_chrom_access_recon_loss: 5697150.8092; train_global_loss: 22731952.3664; train_optim_loss: 22731952.3664; val_kl_reg_loss: 85276.0094; val_edge_recon_loss: 2731418.6000; val_gene_expr_recon_loss: 13932000.5333; val_masked_gp_l1_reg_loss: 116394.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38413.9297; val_chrom_access_recon_loss: 5728119.2667; val_global_loss: 22631622.9333; val_optim_loss: 22631622.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9669; val_auprc_score: 0.9600; val_best_acc_score: 0.9131; val_best_f1_score: 0.9165; train_kl_reg_loss: 85379.6350; train_edge_recon_loss: 2714266.2023; train_gene_expr_recon_loss: 14043750.2214; train_masked_gp_l1_reg_loss: 116767.7440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38138.3261; train_chrom_access_recon_loss: 5680800.3931; train_global_loss: 22679102.1832; train_optim_loss: 22679102.1832; val_kl_reg_loss: 82474.6635; val_edge_recon_loss: 2698950.2000; val_gene_expr_recon_loss: 13841319.8667; val_masked_gp_l1_reg_loss: 117224.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38386.1914; val_chrom_access_recon_loss: 5683375.1000; val_global_loss: 22461729.7333; val_optim_loss: 22461729.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9667; val_auprc_score: 0.9570; val_best_acc_score: 0.9132; val_best_f1_score: 0.9171; train_kl_reg_loss: 84397.3246; train_edge_recon_loss: 2712066.0305; train_gene_expr_recon_loss: 14000630.1985; train_masked_gp_l1_reg_loss: 117493.6199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38100.4990; train_chrom_access_recon_loss: 5662572.4656; train_global_loss: 22615260.1374; train_optim_loss: 22615260.1374; val_kl_reg_loss: 81535.5844; val_edge_recon_loss: 2722370.4500; val_gene_expr_recon_loss: 13813879.9333; val_masked_gp_l1_reg_loss: 117809.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38059.7031; val_chrom_access_recon_loss: 5650779.8667; val_global_loss: 22424436.1333; val_optim_loss: 22424436.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9717; val_auprc_score: 0.9662; val_best_acc_score: 0.9225; val_best_f1_score: 0.9247; train_kl_reg_loss: 83610.4523; train_edge_recon_loss: 2699518.4676; train_gene_expr_recon_loss: 13971137.6412; train_masked_gp_l1_reg_loss: 118202.1524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37920.3380; train_chrom_access_recon_loss: 5650104.3855; train_global_loss: 22560493.3588; train_optim_loss: 22560493.3588; val_kl_reg_loss: 82025.6104; val_edge_recon_loss: 2698558.2333; val_gene_expr_recon_loss: 13788157.8000; val_masked_gp_l1_reg_loss: 118578.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37851.1289; val_chrom_access_recon_loss: 5648568.7667; val_global_loss: 22373740.9333; val_optim_loss: 22373740.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9677; val_auprc_score: 0.9576; val_best_acc_score: 0.9179; val_best_f1_score: 0.9211; train_kl_reg_loss: 83419.1484; train_edge_recon_loss: 2704144.1908; train_gene_expr_recon_loss: 13955175.4809; train_masked_gp_l1_reg_loss: 118846.3032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37735.6672; train_chrom_access_recon_loss: 5639695.5802; train_global_loss: 22539016.1985; train_optim_loss: 22539016.1985; val_kl_reg_loss: 83164.4979; val_edge_recon_loss: 2710174.4000; val_gene_expr_recon_loss: 13723237.9333; val_masked_gp_l1_reg_loss: 119328.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37970.5859; val_chrom_access_recon_loss: 5628053.1000; val_global_loss: 22301928.6667; val_optim_loss: 22301928.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9710; val_auprc_score: 0.9627; val_best_acc_score: 0.9204; val_best_f1_score: 0.9238; train_kl_reg_loss: 82714.9362; train_edge_recon_loss: 2697063.7672; train_gene_expr_recon_loss: 13927849.1985; train_masked_gp_l1_reg_loss: 119516.1274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37686.2803; train_chrom_access_recon_loss: 5628303.6221; train_global_loss: 22493134.0000; train_optim_loss: 22493134.0000; val_kl_reg_loss: 83057.1807; val_edge_recon_loss: 2707936.3667; val_gene_expr_recon_loss: 13762157.2000; val_masked_gp_l1_reg_loss: 120048.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37760.8398; val_chrom_access_recon_loss: 5639470.1333; val_global_loss: 22350429.7333; val_optim_loss: 22350429.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9631; val_best_acc_score: 0.9201; val_best_f1_score: 0.9231; train_kl_reg_loss: 82773.7785; train_edge_recon_loss: 2690345.6527; train_gene_expr_recon_loss: 13900460.5802; train_masked_gp_l1_reg_loss: 120018.6855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37602.5798; train_chrom_access_recon_loss: 5614107.1069; train_global_loss: 22445308.4122; train_optim_loss: 22445308.4122; val_kl_reg_loss: 83355.5578; val_edge_recon_loss: 2695977.6833; val_gene_expr_recon_loss: 13724786.7333; val_masked_gp_l1_reg_loss: 120310.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37495.8594; val_chrom_access_recon_loss: 5607309.1333; val_global_loss: 22269234.8000; val_optim_loss: 22269234.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9718; val_auprc_score: 0.9631; val_best_acc_score: 0.9237; val_best_f1_score: 0.9265; train_kl_reg_loss: 82674.9802; train_edge_recon_loss: 2691198.1317; train_gene_expr_recon_loss: 13881511.4351; train_masked_gp_l1_reg_loss: 120447.1718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37517.9834; train_chrom_access_recon_loss: 5604073.3969; train_global_loss: 22417423.0229; train_optim_loss: 22417423.0229; val_kl_reg_loss: 80407.9516; val_edge_recon_loss: 2712169.2500; val_gene_expr_recon_loss: 13744488.1333; val_masked_gp_l1_reg_loss: 120697.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37641.3594; val_chrom_access_recon_loss: 5628159.3667; val_global_loss: 22323563.6000; val_optim_loss: 22323563.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9729; val_auprc_score: 0.9643; val_best_acc_score: 0.9255; val_best_f1_score: 0.9285; train_kl_reg_loss: 88319.9049; train_edge_recon_loss: 2723394.7443; train_gene_expr_recon_loss: 13395891.6260; train_masked_gp_l1_reg_loss: 118036.2295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33599.9248; train_chrom_access_recon_loss: 5431569.2176; train_global_loss: 21790811.6489; train_optim_loss: 21790811.6489; val_kl_reg_loss: 54550.1216; val_edge_recon_loss: 2722275.7167; val_gene_expr_recon_loss: 13182522.8000; val_masked_gp_l1_reg_loss: 117003.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32620.3613; val_chrom_access_recon_loss: 5397796.2667; val_global_loss: 21506768.0000; val_optim_loss: 21506768.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9759; val_auprc_score: 0.9701; val_best_acc_score: 0.9287; val_best_f1_score: 0.9307; train_kl_reg_loss: 84082.3288; train_edge_recon_loss: 2697705.9313; train_gene_expr_recon_loss: 13318809.9771; train_masked_gp_l1_reg_loss: 116495.3486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32497.9134; train_chrom_access_recon_loss: 5385389.0229; train_global_loss: 21634980.4885; train_optim_loss: 21634980.4885; val_kl_reg_loss: 58160.0042; val_edge_recon_loss: 2711655.5667; val_gene_expr_recon_loss: 13140854.8667; val_masked_gp_l1_reg_loss: 116103.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32493.6699; val_chrom_access_recon_loss: 5375649.7333; val_global_loss: 21434917.4667; val_optim_loss: 21434917.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9747; val_auprc_score: 0.9692; val_best_acc_score: 0.9279; val_best_f1_score: 0.9305; train_kl_reg_loss: 79360.4722; train_edge_recon_loss: 2693905.2672; train_gene_expr_recon_loss: 13255070.6489; train_masked_gp_l1_reg_loss: 115686.5073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32473.6950; train_chrom_access_recon_loss: 5346800.9237; train_global_loss: 21523297.5573; train_optim_loss: 21523297.5573; val_kl_reg_loss: 61424.1807; val_edge_recon_loss: 2699107.5667; val_gene_expr_recon_loss: 13017592.0667; val_masked_gp_l1_reg_loss: 115246.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32435.7734; val_chrom_access_recon_loss: 5308921.6000; val_global_loss: 21234727.6000; val_optim_loss: 21234727.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9712; val_auprc_score: 0.9623; val_best_acc_score: 0.9220; val_best_f1_score: 0.9248; train_kl_reg_loss: 76213.0339; train_edge_recon_loss: 2695727.8569; train_gene_expr_recon_loss: 13228038.5496; train_masked_gp_l1_reg_loss: 114890.0963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32491.8687; train_chrom_access_recon_loss: 5333669.2443; train_global_loss: 21481030.7176; train_optim_loss: 21481030.7176; val_kl_reg_loss: 63586.4232; val_edge_recon_loss: 2722694.0500; val_gene_expr_recon_loss: 13035609.1333; val_masked_gp_l1_reg_loss: 114442.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32351.1387; val_chrom_access_recon_loss: 5311752.5333; val_global_loss: 21280434.8000; val_optim_loss: 21280434.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9737; val_auprc_score: 0.9658; val_best_acc_score: 0.9289; val_best_f1_score: 0.9311; train_kl_reg_loss: 74522.6171; train_edge_recon_loss: 2679454.5954; train_gene_expr_recon_loss: 13203992.7023; train_masked_gp_l1_reg_loss: 114163.8847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32336.7721; train_chrom_access_recon_loss: 5323250.3321; train_global_loss: 21427721.0229; train_optim_loss: 21427721.0229; val_kl_reg_loss: 64246.2531; val_edge_recon_loss: 2709233.7500; val_gene_expr_recon_loss: 13038377.6000; val_masked_gp_l1_reg_loss: 113845.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32259.0703; val_chrom_access_recon_loss: 5323067.8333; val_global_loss: 21281030.1333; val_optim_loss: 21281030.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9775; val_auprc_score: 0.9689; val_best_acc_score: 0.9314; val_best_f1_score: 0.9331; train_kl_reg_loss: 72184.6381; train_edge_recon_loss: 2682591.6374; train_gene_expr_recon_loss: 13203771.5496; train_masked_gp_l1_reg_loss: 113565.1812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32293.4413; train_chrom_access_recon_loss: 5325368.0687; train_global_loss: 21429774.5344; train_optim_loss: 21429774.5344; val_kl_reg_loss: 65586.4174; val_edge_recon_loss: 2683744.5333; val_gene_expr_recon_loss: 13047705.5333; val_masked_gp_l1_reg_loss: 113249.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32192.9375; val_chrom_access_recon_loss: 5319535.8333; val_global_loss: 21262015.3333; val_optim_loss: 21262015.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9746; val_auprc_score: 0.9670; val_best_acc_score: 0.9274; val_best_f1_score: 0.9286; train_kl_reg_loss: 72309.8201; train_edge_recon_loss: 2682491.0534; train_gene_expr_recon_loss: 13176736.4351; train_masked_gp_l1_reg_loss: 112885.2514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32111.7947; train_chrom_access_recon_loss: 5315738.0344; train_global_loss: 21392272.3969; train_optim_loss: 21392272.3969; val_kl_reg_loss: 65350.8779; val_edge_recon_loss: 2712197.5500; val_gene_expr_recon_loss: 13028589.2000; val_masked_gp_l1_reg_loss: 112553.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32187.2031; val_chrom_access_recon_loss: 5324952.1333; val_global_loss: 21275829.7333; val_optim_loss: 21275829.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9773; val_auprc_score: 0.9716; val_best_acc_score: 0.9314; val_best_f1_score: 0.9332; train_kl_reg_loss: 72185.8488; train_edge_recon_loss: 2674499.0973; train_gene_expr_recon_loss: 13144288.5496; train_masked_gp_l1_reg_loss: 111437.3854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28739.2537; train_chrom_access_recon_loss: 5305078.6412; train_global_loss: 21336228.7939; train_optim_loss: 21336228.7939; val_kl_reg_loss: 66119.6609; val_edge_recon_loss: 2688117.3667; val_gene_expr_recon_loss: 12974436.4000; val_masked_gp_l1_reg_loss: 111048.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28166.8398; val_chrom_access_recon_loss: 5299962.0667; val_global_loss: 21167850.5333; val_optim_loss: 21167850.5333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9779; val_auprc_score: 0.9713; val_best_acc_score: 0.9342; val_best_f1_score: 0.9357; train_kl_reg_loss: 72633.0197; train_edge_recon_loss: 2685997.6145; train_gene_expr_recon_loss: 13132385.1374; train_masked_gp_l1_reg_loss: 110899.3576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27976.9385; train_chrom_access_recon_loss: 5300167.1603; train_global_loss: 21330059.2366; train_optim_loss: 21330059.2366; val_kl_reg_loss: 65779.5544; val_edge_recon_loss: 2692249.3667; val_gene_expr_recon_loss: 12938692.1333; val_masked_gp_l1_reg_loss: 110767.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27824.1543; val_chrom_access_recon_loss: 5296212.5333; val_global_loss: 21131525.6000; val_optim_loss: 21131525.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9787; val_auprc_score: 0.9725; val_best_acc_score: 0.9353; val_best_f1_score: 0.9368; train_kl_reg_loss: 72951.1415; train_edge_recon_loss: 2676818.3511; train_gene_expr_recon_loss: 13134303.9160; train_masked_gp_l1_reg_loss: 110681.7196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27721.8137; train_chrom_access_recon_loss: 5303782.9733; train_global_loss: 21326259.9237; train_optim_loss: 21326259.9237; val_kl_reg_loss: 65973.6812; val_edge_recon_loss: 2681841.1667; val_gene_expr_recon_loss: 13001177.4667; val_masked_gp_l1_reg_loss: 110611.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27621.4785; val_chrom_access_recon_loss: 5313102.4667; val_global_loss: 21200326.6667; val_optim_loss: 21200326.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9332; val_best_f1_score: 0.9348; train_kl_reg_loss: 73115.5088; train_edge_recon_loss: 2676284.1718; train_gene_expr_recon_loss: 13123710.4885; train_masked_gp_l1_reg_loss: 110545.3492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27531.6607; train_chrom_access_recon_loss: 5302677.2672; train_global_loss: 21313864.3969; train_optim_loss: 21313864.3969; val_kl_reg_loss: 66029.4698; val_edge_recon_loss: 2669457.6167; val_gene_expr_recon_loss: 12996759.7333; val_masked_gp_l1_reg_loss: 110490.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27457.5957; val_chrom_access_recon_loss: 5327988.2333; val_global_loss: 21198183.3333; val_optim_loss: 21198183.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9762; val_auprc_score: 0.9687; val_best_acc_score: 0.9301; val_best_f1_score: 0.9312; train_kl_reg_loss: 73264.3390; train_edge_recon_loss: 2672177.3053; train_gene_expr_recon_loss: 13132229.9771; train_masked_gp_l1_reg_loss: 110433.3652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27403.0564; train_chrom_access_recon_loss: 5302692.0267; train_global_loss: 21318200.1374; train_optim_loss: 21318200.1374; val_kl_reg_loss: 66568.5883; val_edge_recon_loss: 2703912.4667; val_gene_expr_recon_loss: 13032138.3333; val_masked_gp_l1_reg_loss: 110373.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27317.5039; val_chrom_access_recon_loss: 5320014.7333; val_global_loss: 21260325.0667; val_optim_loss: 21260325.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9800; val_auprc_score: 0.9751; val_best_acc_score: 0.9345; val_best_f1_score: 0.9353; train_kl_reg_loss: 73218.6060; train_edge_recon_loss: 2679875.2824; train_gene_expr_recon_loss: 13115532.5344; train_masked_gp_l1_reg_loss: 110326.1788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27268.9840; train_chrom_access_recon_loss: 5298592.7405; train_global_loss: 21304814.3206; train_optim_loss: 21304814.3206; val_kl_reg_loss: 66378.2885; val_edge_recon_loss: 2673236.3333; val_gene_expr_recon_loss: 12994140.4000; val_masked_gp_l1_reg_loss: 110271.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27197.3906; val_chrom_access_recon_loss: 5301893.2000; val_global_loss: 21173115.8667; val_optim_loss: 21173115.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9760; val_auprc_score: 0.9664; val_best_acc_score: 0.9337; val_best_f1_score: 0.9352; train_kl_reg_loss: 72650.6614; train_edge_recon_loss: 2672178.1050; train_gene_expr_recon_loss: 13122449.2595; train_masked_gp_l1_reg_loss: 110154.5513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26842.3556; train_chrom_access_recon_loss: 5298142.4008; train_global_loss: 21302417.2519; train_optim_loss: 21302417.2519; val_kl_reg_loss: 66040.2859; val_edge_recon_loss: 2694227.9333; val_gene_expr_recon_loss: 12954918.1333; val_masked_gp_l1_reg_loss: 110106.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26787.6035; val_chrom_access_recon_loss: 5306840.8000; val_global_loss: 21158921.8667; val_optim_loss: 21158921.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9792; val_auprc_score: 0.9716; val_best_acc_score: 0.9357; val_best_f1_score: 0.9373; train_kl_reg_loss: 72710.8550; train_edge_recon_loss: 2675421.0305; train_gene_expr_recon_loss: 13122845.8015; train_masked_gp_l1_reg_loss: 110087.5699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26772.9332; train_chrom_access_recon_loss: 5300041.0954; train_global_loss: 21307879.2366; train_optim_loss: 21307879.2366; val_kl_reg_loss: 66143.7570; val_edge_recon_loss: 2675289.8667; val_gene_expr_recon_loss: 12971031.0000; val_masked_gp_l1_reg_loss: 110067.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26754.7910; val_chrom_access_recon_loss: 5296185.6667; val_global_loss: 21145472.4000; val_optim_loss: 21145472.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9791; val_auprc_score: 0.9729; val_best_acc_score: 0.9359; val_best_f1_score: 0.9374; train_kl_reg_loss: 72631.5008; train_edge_recon_loss: 2681168.7939; train_gene_expr_recon_loss: 13120372.8168; train_masked_gp_l1_reg_loss: 110055.6848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26743.7678; train_chrom_access_recon_loss: 5297095.7366; train_global_loss: 21308068.2137; train_optim_loss: 21308068.2137; val_kl_reg_loss: 66148.7557; val_edge_recon_loss: 2667090.4167; val_gene_expr_recon_loss: 13008744.4667; val_masked_gp_l1_reg_loss: 110042.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26730.3613; val_chrom_access_recon_loss: 5324570.4667; val_global_loss: 21203327.3333; val_optim_loss: 21203327.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9779; val_auprc_score: 0.9699; val_best_acc_score: 0.9351; val_best_f1_score: 0.9367; train_kl_reg_loss: 72466.1038; train_edge_recon_loss: 2673951.5534; train_gene_expr_recon_loss: 13116523.4733; train_masked_gp_l1_reg_loss: 110033.5941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26720.6921; train_chrom_access_recon_loss: 5297698.8588; train_global_loss: 21297394.1221; train_optim_loss: 21297394.1221; val_kl_reg_loss: 66121.2341; val_edge_recon_loss: 2669304.0667; val_gene_expr_recon_loss: 12974987.6667; val_masked_gp_l1_reg_loss: 110021.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26709.3477; val_chrom_access_recon_loss: 5290015.2333; val_global_loss: 21137157.8667; val_optim_loss: 21137157.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 33 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9784
val AUPRC score: 0.9737
val best accuracy score: 0.9321
val best F1 score: 0.9337
val target rna MSE score: 0.9265
val source rna MSE score: 0.2179
val target atac MSE score: 0.4979
val source atac MSE score: 0.0837
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
