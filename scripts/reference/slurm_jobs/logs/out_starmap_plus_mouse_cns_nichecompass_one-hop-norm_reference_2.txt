Run timestamp: 20062023_155305_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 3, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 380406
Number of validation nodes: 42267
Number of training edges: 914339
Number of validation edges: 101593
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9104; val_auprc_score: 0.9548; val_best_acc_score: 0.8942; val_best_f1_score: 0.9308; train_kl_reg_loss: 6642.4430; train_edge_recon_loss: 166903.9911; train_cond_contrastive_loss: 82074.5248; train_gene_expr_recon_loss: 128707.9292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384328.8890; train_optim_loss: 384328.8890; val_kl_reg_loss: 7487.3766; val_edge_recon_loss: 151415.0206; val_cond_contrastive_loss: 80000.5691; val_gene_expr_recon_loss: 111037.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349940.6262; val_optim_loss: 349940.6262
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9165; val_auprc_score: 0.9561; val_best_acc_score: 0.9133; val_best_f1_score: 0.9429; train_kl_reg_loss: 7416.0962; train_edge_recon_loss: 148801.3047; train_cond_contrastive_loss: 80904.4412; train_gene_expr_recon_loss: 105028.5087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342150.3513; train_optim_loss: 342150.3513; val_kl_reg_loss: 6932.8707; val_edge_recon_loss: 148251.1256; val_cond_contrastive_loss: 80056.5750; val_gene_expr_recon_loss: 100609.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335850.1125; val_optim_loss: 335850.1125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9150; val_auprc_score: 0.9547; val_best_acc_score: 0.9152; val_best_f1_score: 0.9438; train_kl_reg_loss: 6834.6565; train_edge_recon_loss: 146778.0158; train_cond_contrastive_loss: 80825.6776; train_gene_expr_recon_loss: 98224.0985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332662.4473; train_optim_loss: 332662.4473; val_kl_reg_loss: 6574.3153; val_edge_recon_loss: 147973.0312; val_cond_contrastive_loss: 80065.1559; val_gene_expr_recon_loss: 96209.1559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330821.6588; val_optim_loss: 330821.6588
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9149; val_auprc_score: 0.9543; val_best_acc_score: 0.9184; val_best_f1_score: 0.9457; train_kl_reg_loss: 6604.9167; train_edge_recon_loss: 145823.5190; train_cond_contrastive_loss: 80732.2196; train_gene_expr_recon_loss: 94810.8421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327971.4968; train_optim_loss: 327971.4968; val_kl_reg_loss: 6343.6698; val_edge_recon_loss: 147138.1694; val_cond_contrastive_loss: 80060.1709; val_gene_expr_recon_loss: 93486.5834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327028.5975; val_optim_loss: 327028.5975
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9164; val_auprc_score: 0.9553; val_best_acc_score: 0.9213; val_best_f1_score: 0.9477; train_kl_reg_loss: 6496.2500; train_edge_recon_loss: 145497.5296; train_cond_contrastive_loss: 80615.4038; train_gene_expr_recon_loss: 92627.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325237.0028; train_optim_loss: 325237.0028; val_kl_reg_loss: 6301.1804; val_edge_recon_loss: 145898.7938; val_cond_contrastive_loss: 80069.9159; val_gene_expr_recon_loss: 91729.2888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323999.1800; val_optim_loss: 323999.1800
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9133; val_auprc_score: 0.9536; val_best_acc_score: 0.9234; val_best_f1_score: 0.9492; train_kl_reg_loss: 6488.7251; train_edge_recon_loss: 145111.8648; train_cond_contrastive_loss: 80571.5346; train_gene_expr_recon_loss: 91004.9192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323177.0434; train_optim_loss: 323177.0434; val_kl_reg_loss: 6412.2288; val_edge_recon_loss: 145552.7181; val_cond_contrastive_loss: 79843.5947; val_gene_expr_recon_loss: 90286.9203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322095.4612; val_optim_loss: 322095.4612
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9164; val_auprc_score: 0.9551; val_best_acc_score: 0.9249; val_best_f1_score: 0.9501; train_kl_reg_loss: 6523.2144; train_edge_recon_loss: 145120.2081; train_cond_contrastive_loss: 80564.2763; train_gene_expr_recon_loss: 89648.0816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321855.7818; train_optim_loss: 321855.7818; val_kl_reg_loss: 6294.8217; val_edge_recon_loss: 145349.5694; val_cond_contrastive_loss: 79976.1662; val_gene_expr_recon_loss: 89071.3403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320691.8987; val_optim_loss: 320691.8987
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9141; val_auprc_score: 0.9534; val_best_acc_score: 0.9261; val_best_f1_score: 0.9510; train_kl_reg_loss: 6566.6956; train_edge_recon_loss: 144772.0728; train_cond_contrastive_loss: 80565.7020; train_gene_expr_recon_loss: 88520.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320425.3351; train_optim_loss: 320425.3351; val_kl_reg_loss: 6603.1998; val_edge_recon_loss: 146206.0906; val_cond_contrastive_loss: 79991.2944; val_gene_expr_recon_loss: 87912.5784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320713.1650; val_optim_loss: 320713.1650
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9171; val_auprc_score: 0.9552; val_best_acc_score: 0.9272; val_best_f1_score: 0.9516; train_kl_reg_loss: 6614.8844; train_edge_recon_loss: 144586.9482; train_cond_contrastive_loss: 80588.9524; train_gene_expr_recon_loss: 87528.7898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319319.5741; train_optim_loss: 319319.5741; val_kl_reg_loss: 6466.4162; val_edge_recon_loss: 145145.8669; val_cond_contrastive_loss: 80064.4919; val_gene_expr_recon_loss: 87166.6109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318843.3837; val_optim_loss: 318843.3837
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9159; val_auprc_score: 0.9546; val_best_acc_score: 0.9277; val_best_f1_score: 0.9519; train_kl_reg_loss: 6681.9619; train_edge_recon_loss: 144426.8140; train_cond_contrastive_loss: 80583.3796; train_gene_expr_recon_loss: 86714.0067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318406.1622; train_optim_loss: 318406.1622; val_kl_reg_loss: 6409.2137; val_edge_recon_loss: 144807.4069; val_cond_contrastive_loss: 80124.5225; val_gene_expr_recon_loss: 86365.4991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317706.6437; val_optim_loss: 317706.6437
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9140; val_auprc_score: 0.9533; val_best_acc_score: 0.9295; val_best_f1_score: 0.9531; train_kl_reg_loss: 6709.1996; train_edge_recon_loss: 144132.9092; train_cond_contrastive_loss: 80550.0763; train_gene_expr_recon_loss: 85956.3638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317348.5492; train_optim_loss: 317348.5492; val_kl_reg_loss: 6492.8476; val_edge_recon_loss: 145885.9131; val_cond_contrastive_loss: 79851.7372; val_gene_expr_recon_loss: 85610.8366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317841.3375; val_optim_loss: 317841.3375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9164; val_auprc_score: 0.9541; val_best_acc_score: 0.9304; val_best_f1_score: 0.9537; train_kl_reg_loss: 6741.5407; train_edge_recon_loss: 144120.0888; train_cond_contrastive_loss: 80511.2594; train_gene_expr_recon_loss: 85322.9200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316695.8098; train_optim_loss: 316695.8098; val_kl_reg_loss: 6332.6261; val_edge_recon_loss: 145293.0925; val_cond_contrastive_loss: 80027.3459; val_gene_expr_recon_loss: 84961.6028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316614.6650; val_optim_loss: 316614.6650
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9170; val_auprc_score: 0.9546; val_best_acc_score: 0.9296; val_best_f1_score: 0.9532; train_kl_reg_loss: 6765.9374; train_edge_recon_loss: 143941.6029; train_cond_contrastive_loss: 80487.5201; train_gene_expr_recon_loss: 84805.1422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316000.2026; train_optim_loss: 316000.2026; val_kl_reg_loss: 6559.5518; val_edge_recon_loss: 144802.7313; val_cond_contrastive_loss: 79997.3509; val_gene_expr_recon_loss: 84684.6856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316044.3212; val_optim_loss: 316044.3212
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9154; val_auprc_score: 0.9533; val_best_acc_score: 0.9316; val_best_f1_score: 0.9545; train_kl_reg_loss: 6790.4414; train_edge_recon_loss: 144026.3159; train_cond_contrastive_loss: 80470.0340; train_gene_expr_recon_loss: 84337.6379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315624.4298; train_optim_loss: 315624.4298; val_kl_reg_loss: 6586.4977; val_edge_recon_loss: 145129.5569; val_cond_contrastive_loss: 79958.0869; val_gene_expr_recon_loss: 84264.5437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315938.6863; val_optim_loss: 315938.6863
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9164; val_auprc_score: 0.9539; val_best_acc_score: 0.9316; val_best_f1_score: 0.9544; train_kl_reg_loss: 6814.5605; train_edge_recon_loss: 144175.5952; train_cond_contrastive_loss: 80437.9492; train_gene_expr_recon_loss: 83951.1999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315379.3058; train_optim_loss: 315379.3058; val_kl_reg_loss: 6577.2701; val_edge_recon_loss: 145540.5456; val_cond_contrastive_loss: 79948.0872; val_gene_expr_recon_loss: 83848.3009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315914.2050; val_optim_loss: 315914.2050
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9153; val_auprc_score: 0.9532; val_best_acc_score: 0.9305; val_best_f1_score: 0.9537; train_kl_reg_loss: 6826.6303; train_edge_recon_loss: 143902.3871; train_cond_contrastive_loss: 80415.0544; train_gene_expr_recon_loss: 83558.2320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314702.3029; train_optim_loss: 314702.3029; val_kl_reg_loss: 6681.6737; val_edge_recon_loss: 145278.8344; val_cond_contrastive_loss: 79926.4581; val_gene_expr_recon_loss: 83386.4519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315273.4163; val_optim_loss: 315273.4163
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9156; val_auprc_score: 0.9532; val_best_acc_score: 0.9307; val_best_f1_score: 0.9538; train_kl_reg_loss: 6849.1526; train_edge_recon_loss: 144010.9557; train_cond_contrastive_loss: 80398.0387; train_gene_expr_recon_loss: 83224.1661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314482.3139; train_optim_loss: 314482.3139; val_kl_reg_loss: 6642.7128; val_edge_recon_loss: 145792.1769; val_cond_contrastive_loss: 80046.6906; val_gene_expr_recon_loss: 83261.8178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315743.3987; val_optim_loss: 315743.3987
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9172; val_auprc_score: 0.9547; val_best_acc_score: 0.9316; val_best_f1_score: 0.9544; train_kl_reg_loss: 6862.2077; train_edge_recon_loss: 143430.8232; train_cond_contrastive_loss: 80359.3173; train_gene_expr_recon_loss: 82923.1767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313575.5244; train_optim_loss: 313575.5244; val_kl_reg_loss: 6558.4986; val_edge_recon_loss: 144643.4119; val_cond_contrastive_loss: 80045.6500; val_gene_expr_recon_loss: 83015.0994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314262.6613; val_optim_loss: 314262.6613
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9121; val_auprc_score: 0.9510; val_best_acc_score: 0.9326; val_best_f1_score: 0.9551; train_kl_reg_loss: 6876.9455; train_edge_recon_loss: 143650.7418; train_cond_contrastive_loss: 80322.0602; train_gene_expr_recon_loss: 82642.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313491.8193; train_optim_loss: 313491.8193; val_kl_reg_loss: 6749.2849; val_edge_recon_loss: 145609.5200; val_cond_contrastive_loss: 79802.4916; val_gene_expr_recon_loss: 82660.5047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314821.7975; val_optim_loss: 314821.7975
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9160; val_auprc_score: 0.9530; val_best_acc_score: 0.9333; val_best_f1_score: 0.9554; train_kl_reg_loss: 6885.2113; train_edge_recon_loss: 143985.0582; train_cond_contrastive_loss: 80318.4638; train_gene_expr_recon_loss: 82381.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313569.7543; train_optim_loss: 313569.7543; val_kl_reg_loss: 6750.2477; val_edge_recon_loss: 145305.4431; val_cond_contrastive_loss: 79909.0031; val_gene_expr_recon_loss: 82288.2269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314252.9200; val_optim_loss: 314252.9200
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9142; val_auprc_score: 0.9520; val_best_acc_score: 0.9339; val_best_f1_score: 0.9559; train_kl_reg_loss: 6903.8395; train_edge_recon_loss: 143833.1641; train_cond_contrastive_loss: 80295.4914; train_gene_expr_recon_loss: 82171.2113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313203.7054; train_optim_loss: 313203.7054; val_kl_reg_loss: 6893.0923; val_edge_recon_loss: 144698.7956; val_cond_contrastive_loss: 79736.9022; val_gene_expr_recon_loss: 82292.9709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313621.7650; val_optim_loss: 313621.7650
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9146; val_auprc_score: 0.9523; val_best_acc_score: 0.9332; val_best_f1_score: 0.9555; train_kl_reg_loss: 6910.3233; train_edge_recon_loss: 144141.0672; train_cond_contrastive_loss: 80262.1659; train_gene_expr_recon_loss: 81941.4356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313254.9918; train_optim_loss: 313254.9918; val_kl_reg_loss: 6853.5308; val_edge_recon_loss: 145131.7244; val_cond_contrastive_loss: 79724.1447; val_gene_expr_recon_loss: 82031.4662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313740.8688; val_optim_loss: 313740.8688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9140; val_auprc_score: 0.9517; val_best_acc_score: 0.9326; val_best_f1_score: 0.9550; train_kl_reg_loss: 6922.3843; train_edge_recon_loss: 143444.6574; train_cond_contrastive_loss: 80235.0671; train_gene_expr_recon_loss: 81733.9617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312336.0707; train_optim_loss: 312336.0707; val_kl_reg_loss: 6692.8644; val_edge_recon_loss: 145934.4262; val_cond_contrastive_loss: 79756.4491; val_gene_expr_recon_loss: 81845.2009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314228.9412; val_optim_loss: 314228.9412
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9131; val_auprc_score: 0.9515; val_best_acc_score: 0.9341; val_best_f1_score: 0.9561; train_kl_reg_loss: 6929.7844; train_edge_recon_loss: 143905.7199; train_cond_contrastive_loss: 80233.8432; train_gene_expr_recon_loss: 81543.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312613.1815; train_optim_loss: 312613.1815; val_kl_reg_loss: 6834.9137; val_edge_recon_loss: 144731.9287; val_cond_contrastive_loss: 79778.5631; val_gene_expr_recon_loss: 81656.8284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313002.2350; val_optim_loss: 313002.2350
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9165; val_auprc_score: 0.9538; val_best_acc_score: 0.9344; val_best_f1_score: 0.9562; train_kl_reg_loss: 6938.9523; train_edge_recon_loss: 143857.8864; train_cond_contrastive_loss: 80219.7034; train_gene_expr_recon_loss: 81412.6083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312429.1501; train_optim_loss: 312429.1501; val_kl_reg_loss: 6828.3697; val_edge_recon_loss: 144065.2319; val_cond_contrastive_loss: 79871.4178; val_gene_expr_recon_loss: 81560.8709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312325.8912; val_optim_loss: 312325.8912
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9139; val_auprc_score: 0.9514; val_best_acc_score: 0.9352; val_best_f1_score: 0.9568; train_kl_reg_loss: 6847.6252; train_edge_recon_loss: 143336.9737; train_cond_contrastive_loss: 80247.4006; train_gene_expr_recon_loss: 81234.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311666.8203; train_optim_loss: 311666.8203; val_kl_reg_loss: 6582.5262; val_edge_recon_loss: 145423.5844; val_cond_contrastive_loss: 79695.4166; val_gene_expr_recon_loss: 81493.4400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313194.9662; val_optim_loss: 313194.9662
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9149; val_auprc_score: 0.9521; val_best_acc_score: 0.9360; val_best_f1_score: 0.9573; train_kl_reg_loss: 6745.1312; train_edge_recon_loss: 143824.6501; train_cond_contrastive_loss: 80163.7092; train_gene_expr_recon_loss: 81094.1556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311827.6476; train_optim_loss: 311827.6476; val_kl_reg_loss: 6671.6244; val_edge_recon_loss: 144725.5200; val_cond_contrastive_loss: 79683.6666; val_gene_expr_recon_loss: 81340.5281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312421.3412; val_optim_loss: 312421.3412
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9151; val_auprc_score: 0.9525; val_best_acc_score: 0.9342; val_best_f1_score: 0.9561; train_kl_reg_loss: 6730.1879; train_edge_recon_loss: 143590.8914; train_cond_contrastive_loss: 80138.9839; train_gene_expr_recon_loss: 80942.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311402.5752; train_optim_loss: 311402.5752; val_kl_reg_loss: 6506.4924; val_edge_recon_loss: 145593.2206; val_cond_contrastive_loss: 79912.9900; val_gene_expr_recon_loss: 81155.1503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313167.8538; val_optim_loss: 313167.8538

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9139; val_auprc_score: 0.9521; val_best_acc_score: 0.9356; val_best_f1_score: 0.9571; train_kl_reg_loss: 6685.5879; train_edge_recon_loss: 143480.7365; train_cond_contrastive_loss: 80133.1540; train_gene_expr_recon_loss: 80530.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310830.1575; train_optim_loss: 310830.1575; val_kl_reg_loss: 6539.7388; val_edge_recon_loss: 143884.6388; val_cond_contrastive_loss: 79711.7400; val_gene_expr_recon_loss: 80948.7413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311084.8575; val_optim_loss: 311084.8575
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9151; val_auprc_score: 0.9523; val_best_acc_score: 0.9357; val_best_f1_score: 0.9571; train_kl_reg_loss: 6697.7530; train_edge_recon_loss: 143508.4551; train_cond_contrastive_loss: 80122.4360; train_gene_expr_recon_loss: 80475.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310803.6493; train_optim_loss: 310803.6493; val_kl_reg_loss: 6519.9436; val_edge_recon_loss: 144672.6725; val_cond_contrastive_loss: 79762.9319; val_gene_expr_recon_loss: 80930.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311886.1188; val_optim_loss: 311886.1188
