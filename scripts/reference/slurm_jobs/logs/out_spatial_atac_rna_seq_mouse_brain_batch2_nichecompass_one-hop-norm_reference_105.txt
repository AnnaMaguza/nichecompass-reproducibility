[True]
Run timestamp: 07082023_204344_105.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_105']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8819; val_auprc_score: 0.8955; val_best_acc_score: 0.5115; val_best_f1_score: 0.6718; train_kl_reg_loss: 17188.4031; train_edge_recon_loss: 350521.3507; train_gene_expr_recon_loss: 1175342.3125; train_masked_gp_l1_reg_loss: 8330.2797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166775.9549; train_chrom_access_recon_loss: 787625.7674; train_global_loss: 2505784.0000; train_optim_loss: 2505784.0000; val_kl_reg_loss: 7957.2437; val_edge_recon_loss: 406495.1875; val_gene_expr_recon_loss: 966256.0625; val_masked_gp_l1_reg_loss: 6460.0479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162211.4219; val_chrom_access_recon_loss: 511462.3125; val_global_loss: 2060842.2500; val_optim_loss: 2060842.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8808; val_auprc_score: 0.8920; val_best_acc_score: 0.5067; val_best_f1_score: 0.6697; train_kl_reg_loss: 9713.3945; train_edge_recon_loss: 353970.4653; train_gene_expr_recon_loss: 901528.4583; train_masked_gp_l1_reg_loss: 5871.8902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159302.4427; train_chrom_access_recon_loss: 490020.4722; train_global_loss: 1920407.0972; train_optim_loss: 1920407.0972; val_kl_reg_loss: 13030.9805; val_edge_recon_loss: 406534.3750; val_gene_expr_recon_loss: 821287.5000; val_masked_gp_l1_reg_loss: 5511.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155647.7969; val_chrom_access_recon_loss: 466917.6875; val_global_loss: 1868929.2500; val_optim_loss: 1868929.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8788; val_auprc_score: 0.8911; val_best_acc_score: 0.5105; val_best_f1_score: 0.6714; train_kl_reg_loss: 15555.5863; train_edge_recon_loss: 357687.8472; train_gene_expr_recon_loss: 796732.6875; train_masked_gp_l1_reg_loss: 5663.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152378.0486; train_chrom_access_recon_loss: 467620.0972; train_global_loss: 1795637.9722; train_optim_loss: 1795637.9722; val_kl_reg_loss: 16235.0410; val_edge_recon_loss: 406521.2188; val_gene_expr_recon_loss: 769090.2500; val_masked_gp_l1_reg_loss: 5828.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147950.9531; val_chrom_access_recon_loss: 454777.4062; val_global_loss: 1800403.5000; val_optim_loss: 1800403.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8761; val_auprc_score: 0.8887; val_best_acc_score: 0.5191; val_best_f1_score: 0.6750; train_kl_reg_loss: 17151.2885; train_edge_recon_loss: 357670.3472; train_gene_expr_recon_loss: 761509.0903; train_masked_gp_l1_reg_loss: 5860.0610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144006.3750; train_chrom_access_recon_loss: 456275.1215; train_global_loss: 1742472.3056; train_optim_loss: 1742472.3056; val_kl_reg_loss: 18586.0918; val_edge_recon_loss: 406445.6562; val_gene_expr_recon_loss: 740211.8750; val_masked_gp_l1_reg_loss: 5913.6455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138931.0625; val_chrom_access_recon_loss: 449271.4375; val_global_loss: 1759359.7500; val_optim_loss: 1759359.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8684; val_auprc_score: 0.8758; val_best_acc_score: 0.5291; val_best_f1_score: 0.6774; train_kl_reg_loss: 18957.7650; train_edge_recon_loss: 358452.7743; train_gene_expr_recon_loss: 739849.6944; train_masked_gp_l1_reg_loss: 5972.6817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134712.8767; train_chrom_access_recon_loss: 452940.9306; train_global_loss: 1710886.7222; train_optim_loss: 1710886.7222; val_kl_reg_loss: 18016.5605; val_edge_recon_loss: 406257.6250; val_gene_expr_recon_loss: 719497.0000; val_masked_gp_l1_reg_loss: 6019.6050; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129384.5156; val_chrom_access_recon_loss: 445651.9062; val_global_loss: 1724827.2500; val_optim_loss: 1724827.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8791; val_auprc_score: 0.8832; val_best_acc_score: 0.5546; val_best_f1_score: 0.6869; train_kl_reg_loss: 18908.4418; train_edge_recon_loss: 358622.1458; train_gene_expr_recon_loss: 715261.5139; train_masked_gp_l1_reg_loss: 6062.6237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125109.2161; train_chrom_access_recon_loss: 448463.7465; train_global_loss: 1672427.6806; train_optim_loss: 1672427.6806; val_kl_reg_loss: 18116.6562; val_edge_recon_loss: 405887.1562; val_gene_expr_recon_loss: 703170.1250; val_masked_gp_l1_reg_loss: 6096.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119778.4844; val_chrom_access_recon_loss: 442867.8750; val_global_loss: 1695917.1250; val_optim_loss: 1695917.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8680; val_auprc_score: 0.8690; val_best_acc_score: 0.6067; val_best_f1_score: 0.7106; train_kl_reg_loss: 19611.4887; train_edge_recon_loss: 358104.7778; train_gene_expr_recon_loss: 700952.7778; train_masked_gp_l1_reg_loss: 6124.0141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115583.0807; train_chrom_access_recon_loss: 445135.7118; train_global_loss: 1645511.8472; train_optim_loss: 1645511.8472; val_kl_reg_loss: 19538.4355; val_edge_recon_loss: 405288.6562; val_gene_expr_recon_loss: 690643.5000; val_masked_gp_l1_reg_loss: 6142.4600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110410.0625; val_chrom_access_recon_loss: 440995.9375; val_global_loss: 1673019.2500; val_optim_loss: 1673019.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8584; val_auprc_score: 0.8627; val_best_acc_score: 0.6679; val_best_f1_score: 0.7398; train_kl_reg_loss: 19641.5258; train_edge_recon_loss: 357947.3056; train_gene_expr_recon_loss: 691843.7500; train_masked_gp_l1_reg_loss: 6166.4398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106411.9566; train_chrom_access_recon_loss: 444534.4931; train_global_loss: 1626545.4583; train_optim_loss: 1626545.4583; val_kl_reg_loss: 19218.5273; val_edge_recon_loss: 404520.5938; val_gene_expr_recon_loss: 682257.7500; val_masked_gp_l1_reg_loss: 6176.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101513.7500; val_chrom_access_recon_loss: 439433.1562; val_global_loss: 1653120.1250; val_optim_loss: 1653120.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8496; val_auprc_score: 0.8478; val_best_acc_score: 0.7436; val_best_f1_score: 0.7768; train_kl_reg_loss: 20011.9705; train_edge_recon_loss: 357634.7431; train_gene_expr_recon_loss: 684826.3194; train_masked_gp_l1_reg_loss: 6196.2767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97778.5373; train_chrom_access_recon_loss: 443494.4201; train_global_loss: 1609942.2917; train_optim_loss: 1609942.2917; val_kl_reg_loss: 18525.9336; val_edge_recon_loss: 403254.1250; val_gene_expr_recon_loss: 676287.6250; val_masked_gp_l1_reg_loss: 6212.3462; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93224.9609; val_chrom_access_recon_loss: 437918.3750; val_global_loss: 1635423.5000; val_optim_loss: 1635423.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8472; val_auprc_score: 0.8474; val_best_acc_score: 0.7707; val_best_f1_score: 0.7754; train_kl_reg_loss: 19844.6274; train_edge_recon_loss: 357052.8750; train_gene_expr_recon_loss: 680919.3819; train_masked_gp_l1_reg_loss: 6244.6770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89791.9392; train_chrom_access_recon_loss: 442820.2778; train_global_loss: 1596673.7778; train_optim_loss: 1596673.7778; val_kl_reg_loss: 18680.8242; val_edge_recon_loss: 400489.3438; val_gene_expr_recon_loss: 670830.6250; val_masked_gp_l1_reg_loss: 6259.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85618.7344; val_chrom_access_recon_loss: 436775.0000; val_global_loss: 1618653.7500; val_optim_loss: 1618653.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8622; val_auprc_score: 0.8600; val_best_acc_score: 0.7637; val_best_f1_score: 0.7699; train_kl_reg_loss: 19849.9820; train_edge_recon_loss: 356081.1424; train_gene_expr_recon_loss: 673015.8472; train_masked_gp_l1_reg_loss: 6281.3156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82501.4115; train_chrom_access_recon_loss: 441587.1632; train_global_loss: 1579316.8472; train_optim_loss: 1579316.8472; val_kl_reg_loss: 17949.7070; val_edge_recon_loss: 396116.4062; val_gene_expr_recon_loss: 667682.8750; val_masked_gp_l1_reg_loss: 6296.7939; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78728.3281; val_chrom_access_recon_loss: 435664.4375; val_global_loss: 1602438.5000; val_optim_loss: 1602438.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8649; val_auprc_score: 0.8600; val_best_acc_score: 0.7701; val_best_f1_score: 0.7947; train_kl_reg_loss: 19335.2066; train_edge_recon_loss: 354621.0868; train_gene_expr_recon_loss: 668720.1111; train_masked_gp_l1_reg_loss: 6325.2767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75941.0903; train_chrom_access_recon_loss: 439789.1979; train_global_loss: 1564731.9722; train_optim_loss: 1564731.9722; val_kl_reg_loss: 18594.1777; val_edge_recon_loss: 390065.7812; val_gene_expr_recon_loss: 663658.7500; val_masked_gp_l1_reg_loss: 6343.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72577.6172; val_chrom_access_recon_loss: 434694.8750; val_global_loss: 1585935.2500; val_optim_loss: 1585935.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8662; val_auprc_score: 0.8608; val_best_acc_score: 0.7846; val_best_f1_score: 0.7931; train_kl_reg_loss: 19144.7997; train_edge_recon_loss: 351716.9201; train_gene_expr_recon_loss: 667134.0764; train_masked_gp_l1_reg_loss: 6373.6019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70088.7778; train_chrom_access_recon_loss: 436871.0972; train_global_loss: 1551329.2778; train_optim_loss: 1551329.2778; val_kl_reg_loss: 18369.8203; val_edge_recon_loss: 378169.7812; val_gene_expr_recon_loss: 661763.5000; val_masked_gp_l1_reg_loss: 6398.1470; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67083.9219; val_chrom_access_recon_loss: 433853.4062; val_global_loss: 1565638.5000; val_optim_loss: 1565638.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8766; val_auprc_score: 0.8696; val_best_acc_score: 0.7894; val_best_f1_score: 0.8011; train_kl_reg_loss: 18550.1838; train_edge_recon_loss: 345171.5174; train_gene_expr_recon_loss: 665197.3403; train_masked_gp_l1_reg_loss: 6439.2124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64853.1107; train_chrom_access_recon_loss: 436854.9167; train_global_loss: 1537066.2500; train_optim_loss: 1537066.2500; val_kl_reg_loss: 17878.8652; val_edge_recon_loss: 355517.1250; val_gene_expr_recon_loss: 661703.7500; val_masked_gp_l1_reg_loss: 6475.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62162.8828; val_chrom_access_recon_loss: 433277.0938; val_global_loss: 1537015.0000; val_optim_loss: 1537015.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8801; val_auprc_score: 0.8753; val_best_acc_score: 0.7920; val_best_f1_score: 0.7981; train_kl_reg_loss: 20313.8774; train_edge_recon_loss: 331672.8542; train_gene_expr_recon_loss: 667362.0417; train_masked_gp_l1_reg_loss: 6517.8571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60180.0690; train_chrom_access_recon_loss: 438067.0278; train_global_loss: 1524113.7222; train_optim_loss: 1524113.7222; val_kl_reg_loss: 22110.8711; val_edge_recon_loss: 328628.9375; val_gene_expr_recon_loss: 662316.6250; val_masked_gp_l1_reg_loss: 6567.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57779.6133; val_chrom_access_recon_loss: 433041.6875; val_global_loss: 1510445.5000; val_optim_loss: 1510445.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8878; val_auprc_score: 0.8815; val_best_acc_score: 0.7980; val_best_f1_score: 0.8054; train_kl_reg_loss: 25944.5056; train_edge_recon_loss: 317120.1736; train_gene_expr_recon_loss: 668983.1389; train_masked_gp_l1_reg_loss: 6621.4501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56007.9405; train_chrom_access_recon_loss: 438205.7431; train_global_loss: 1512882.9444; train_optim_loss: 1512882.9444; val_kl_reg_loss: 27368.7070; val_edge_recon_loss: 315504.4062; val_gene_expr_recon_loss: 660171.0625; val_masked_gp_l1_reg_loss: 6675.6113; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53853.3594; val_chrom_access_recon_loss: 432130.7500; val_global_loss: 1495703.8750; val_optim_loss: 1495703.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9021; val_auprc_score: 0.8921; val_best_acc_score: 0.8170; val_best_f1_score: 0.8210; train_kl_reg_loss: 27950.7550; train_edge_recon_loss: 310800.7569; train_gene_expr_recon_loss: 661943.7153; train_masked_gp_l1_reg_loss: 6725.7143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52255.0951; train_chrom_access_recon_loss: 436235.3889; train_global_loss: 1495911.4444; train_optim_loss: 1495911.4444; val_kl_reg_loss: 26467.2715; val_edge_recon_loss: 311799.7812; val_gene_expr_recon_loss: 658652.0000; val_masked_gp_l1_reg_loss: 6778.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50315.8203; val_chrom_access_recon_loss: 431325.0000; val_global_loss: 1485338.2500; val_optim_loss: 1485338.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9130; val_auprc_score: 0.9012; val_best_acc_score: 0.8339; val_best_f1_score: 0.8388; train_kl_reg_loss: 26506.5868; train_edge_recon_loss: 308788.5208; train_gene_expr_recon_loss: 661773.8819; train_masked_gp_l1_reg_loss: 6811.3184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48865.8529; train_chrom_access_recon_loss: 434345.7014; train_global_loss: 1487091.8750; train_optim_loss: 1487091.8750; val_kl_reg_loss: 25514.2031; val_edge_recon_loss: 307221.5938; val_gene_expr_recon_loss: 657110.4375; val_masked_gp_l1_reg_loss: 6852.5342; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47099.9062; val_chrom_access_recon_loss: 430564.5000; val_global_loss: 1474363.2500; val_optim_loss: 1474363.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9325; val_auprc_score: 0.9174; val_best_acc_score: 0.8620; val_best_f1_score: 0.8665; train_kl_reg_loss: 25950.2806; train_edge_recon_loss: 304924.8160; train_gene_expr_recon_loss: 664902.6042; train_masked_gp_l1_reg_loss: 6890.4833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45785.1654; train_chrom_access_recon_loss: 433874.4931; train_global_loss: 1482327.8472; train_optim_loss: 1482327.8472; val_kl_reg_loss: 25745.7012; val_edge_recon_loss: 300123.1875; val_gene_expr_recon_loss: 655303.5000; val_masked_gp_l1_reg_loss: 6923.6958; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44182.0664; val_chrom_access_recon_loss: 429903.2812; val_global_loss: 1462181.3750; val_optim_loss: 1462181.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9407; val_auprc_score: 0.9300; val_best_acc_score: 0.8666; val_best_f1_score: 0.8731; train_kl_reg_loss: 26610.3485; train_edge_recon_loss: 300369.2674; train_gene_expr_recon_loss: 660530.4097; train_masked_gp_l1_reg_loss: 6958.1559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42987.8850; train_chrom_access_recon_loss: 434770.9653; train_global_loss: 1472227.0556; train_optim_loss: 1472227.0556; val_kl_reg_loss: 25781.2812; val_edge_recon_loss: 299342.5938; val_gene_expr_recon_loss: 654876.0000; val_masked_gp_l1_reg_loss: 6989.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41523.8281; val_chrom_access_recon_loss: 429268.6875; val_global_loss: 1457782.2500; val_optim_loss: 1457782.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9481; val_auprc_score: 0.9340; val_best_acc_score: 0.8822; val_best_f1_score: 0.8869; train_kl_reg_loss: 26796.7834; train_edge_recon_loss: 298289.8542; train_gene_expr_recon_loss: 657523.4792; train_masked_gp_l1_reg_loss: 7022.1467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40433.8854; train_chrom_access_recon_loss: 432616.1354; train_global_loss: 1462682.2917; train_optim_loss: 1462682.2917; val_kl_reg_loss: 26409.7598; val_edge_recon_loss: 294645.9375; val_gene_expr_recon_loss: 652842.3750; val_masked_gp_l1_reg_loss: 7060.0283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39090.3281; val_chrom_access_recon_loss: 428510.5938; val_global_loss: 1448559.0000; val_optim_loss: 1448559.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9438; val_auprc_score: 0.9267; val_best_acc_score: 0.8821; val_best_f1_score: 0.8871; train_kl_reg_loss: 27078.3685; train_edge_recon_loss: 296385.4965; train_gene_expr_recon_loss: 655894.6875; train_masked_gp_l1_reg_loss: 7087.4654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38082.7135; train_chrom_access_recon_loss: 431475.5799; train_global_loss: 1456004.2917; train_optim_loss: 1456004.2917; val_kl_reg_loss: 26987.9590; val_edge_recon_loss: 296765.8438; val_gene_expr_recon_loss: 650813.5000; val_masked_gp_l1_reg_loss: 7108.9575; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36843.6602; val_chrom_access_recon_loss: 427558.4375; val_global_loss: 1446078.3750; val_optim_loss: 1446078.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9495; val_auprc_score: 0.9384; val_best_acc_score: 0.8866; val_best_f1_score: 0.8912; train_kl_reg_loss: 27525.4342; train_edge_recon_loss: 295220.5347; train_gene_expr_recon_loss: 656610.7222; train_masked_gp_l1_reg_loss: 7132.8607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35917.9913; train_chrom_access_recon_loss: 433325.0035; train_global_loss: 1455732.5556; train_optim_loss: 1455732.5556; val_kl_reg_loss: 26610.7188; val_edge_recon_loss: 295754.2188; val_gene_expr_recon_loss: 649499.1250; val_masked_gp_l1_reg_loss: 7149.7783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34781.2734; val_chrom_access_recon_loss: 426806.7812; val_global_loss: 1440601.8750; val_optim_loss: 1440601.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9497; val_auprc_score: 0.9340; val_best_acc_score: 0.8894; val_best_f1_score: 0.8934; train_kl_reg_loss: 27264.1367; train_edge_recon_loss: 294852.3681; train_gene_expr_recon_loss: 653108.5278; train_masked_gp_l1_reg_loss: 7177.0418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33934.7891; train_chrom_access_recon_loss: 430991.5868; train_global_loss: 1447328.4167; train_optim_loss: 1447328.4167; val_kl_reg_loss: 26175.7422; val_edge_recon_loss: 294724.2188; val_gene_expr_recon_loss: 648428.8125; val_masked_gp_l1_reg_loss: 7193.4595; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32894.6914; val_chrom_access_recon_loss: 426113.0312; val_global_loss: 1435529.8750; val_optim_loss: 1435529.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9559; val_auprc_score: 0.9444; val_best_acc_score: 0.8948; val_best_f1_score: 0.8986; train_kl_reg_loss: 26888.1936; train_edge_recon_loss: 293404.8819; train_gene_expr_recon_loss: 650076.5278; train_masked_gp_l1_reg_loss: 7215.5592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32116.4575; train_chrom_access_recon_loss: 428109.0139; train_global_loss: 1437810.6250; train_optim_loss: 1437810.6250; val_kl_reg_loss: 26339.9336; val_edge_recon_loss: 292115.8750; val_gene_expr_recon_loss: 647898.3750; val_masked_gp_l1_reg_loss: 7237.6587; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31154.2227; val_chrom_access_recon_loss: 425469.6250; val_global_loss: 1430215.7500; val_optim_loss: 1430215.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9528; val_auprc_score: 0.9394; val_best_acc_score: 0.8874; val_best_f1_score: 0.8925; train_kl_reg_loss: 25114.6599; train_edge_recon_loss: 308607.1007; train_gene_expr_recon_loss: 947042.4931; train_masked_gp_l1_reg_loss: 7338.6736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30266.3815; train_chrom_access_recon_loss: 457867.4340; train_global_loss: 1776236.7361; train_optim_loss: 1776236.7361; val_kl_reg_loss: 10651.3555; val_edge_recon_loss: 304489.0312; val_gene_expr_recon_loss: 933054.1875; val_masked_gp_l1_reg_loss: 7499.1499; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29065.0215; val_chrom_access_recon_loss: 450264.9375; val_global_loss: 1735023.5000; val_optim_loss: 1735023.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9549; val_auprc_score: 0.9410; val_best_acc_score: 0.8936; val_best_f1_score: 0.8975; train_kl_reg_loss: 22901.4698; train_edge_recon_loss: 299045.0521; train_gene_expr_recon_loss: 934643.3264; train_masked_gp_l1_reg_loss: 7659.3575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28073.7804; train_chrom_access_recon_loss: 454177.0382; train_global_loss: 1746500.0139; train_optim_loss: 1746500.0139; val_kl_reg_loss: 11359.9668; val_edge_recon_loss: 292768.4062; val_gene_expr_recon_loss: 930259.2500; val_masked_gp_l1_reg_loss: 7860.4858; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26855.7637; val_chrom_access_recon_loss: 449949.6250; val_global_loss: 1719053.5000; val_optim_loss: 1719053.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9501; val_auprc_score: 0.9313; val_best_acc_score: 0.8891; val_best_f1_score: 0.8937; train_kl_reg_loss: 20757.5855; train_edge_recon_loss: 294301.0868; train_gene_expr_recon_loss: 932097.9792; train_masked_gp_l1_reg_loss: 7993.2909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25935.1439; train_chrom_access_recon_loss: 454627.0035; train_global_loss: 1735712.0556; train_optim_loss: 1735712.0556; val_kl_reg_loss: 13397.5371; val_edge_recon_loss: 291316.4375; val_gene_expr_recon_loss: 923745.0000; val_masked_gp_l1_reg_loss: 8137.0400; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24819.6250; val_chrom_access_recon_loss: 449114.6875; val_global_loss: 1710530.2500; val_optim_loss: 1710530.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9526; val_auprc_score: 0.9415; val_best_acc_score: 0.8879; val_best_f1_score: 0.8932; train_kl_reg_loss: 19986.1825; train_edge_recon_loss: 290321.1944; train_gene_expr_recon_loss: 925438.0486; train_masked_gp_l1_reg_loss: 8226.3888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23993.0332; train_chrom_access_recon_loss: 450881.2986; train_global_loss: 1718846.1389; train_optim_loss: 1718846.1389; val_kl_reg_loss: 14977.4033; val_edge_recon_loss: 292160.8750; val_gene_expr_recon_loss: 919221.4375; val_masked_gp_l1_reg_loss: 8327.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23000.1445; val_chrom_access_recon_loss: 448391.5625; val_global_loss: 1706078.5000; val_optim_loss: 1706078.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9536; val_auprc_score: 0.9407; val_best_acc_score: 0.8923; val_best_f1_score: 0.8956; train_kl_reg_loss: 19706.1382; train_edge_recon_loss: 289187.6181; train_gene_expr_recon_loss: 923119.0486; train_masked_gp_l1_reg_loss: 8298.9084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22831.8921; train_chrom_access_recon_loss: 454067.0035; train_global_loss: 1717210.5833; train_optim_loss: 1717210.5833; val_kl_reg_loss: 15204.3223; val_edge_recon_loss: 289740.7188; val_gene_expr_recon_loss: 918727.1250; val_masked_gp_l1_reg_loss: 8274.6182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22648.4219; val_chrom_access_recon_loss: 448304.6250; val_global_loss: 1702899.7500; val_optim_loss: 1702899.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9518; val_auprc_score: 0.9352; val_best_acc_score: 0.8892; val_best_f1_score: 0.8953; train_kl_reg_loss: 19470.1669; train_edge_recon_loss: 288670.3438; train_gene_expr_recon_loss: 921534.0625; train_masked_gp_l1_reg_loss: 8271.9019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22542.7954; train_chrom_access_recon_loss: 453561.1667; train_global_loss: 1714050.4167; train_optim_loss: 1714050.4167; val_kl_reg_loss: 15135.5859; val_edge_recon_loss: 289261.8125; val_gene_expr_recon_loss: 918504.7500; val_masked_gp_l1_reg_loss: 8265.2256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22405.2539; val_chrom_access_recon_loss: 448309.1250; val_global_loss: 1701881.7500; val_optim_loss: 1701881.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9524; val_auprc_score: 0.9379; val_best_acc_score: 0.8922; val_best_f1_score: 0.8965; train_kl_reg_loss: 19370.3885; train_edge_recon_loss: 288333.3819; train_gene_expr_recon_loss: 926760.8403; train_masked_gp_l1_reg_loss: 8263.0323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22306.6389; train_chrom_access_recon_loss: 454911.5799; train_global_loss: 1719945.8333; train_optim_loss: 1719945.8333; val_kl_reg_loss: 15181.0537; val_edge_recon_loss: 289821.5938; val_gene_expr_recon_loss: 917955.3125; val_masked_gp_l1_reg_loss: 8261.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22186.5430; val_chrom_access_recon_loss: 448229.1875; val_global_loss: 1701635.0000; val_optim_loss: 1701635.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9548; val_auprc_score: 0.9398; val_best_acc_score: 0.8929; val_best_f1_score: 0.8970; train_kl_reg_loss: 19258.6128; train_edge_recon_loss: 289247.3160; train_gene_expr_recon_loss: 922548.3333; train_masked_gp_l1_reg_loss: 8261.6997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22095.5534; train_chrom_access_recon_loss: 452396.9583; train_global_loss: 1713808.4861; train_optim_loss: 1713808.4861; val_kl_reg_loss: 15147.6260; val_edge_recon_loss: 289172.6250; val_gene_expr_recon_loss: 917739.5000; val_masked_gp_l1_reg_loss: 8263.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21987.1289; val_chrom_access_recon_loss: 448109.5625; val_global_loss: 1700419.5000; val_optim_loss: 1700419.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9546
val AUPRC score: 0.9410
val best accuracy score: 0.8901
val best F1 score: 0.8936
val target rna MSE score: 3.8494
val source rna MSE score: 3.1416
val target atac MSE score: 0.1324
val source atac MSE score: 0.0197
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
