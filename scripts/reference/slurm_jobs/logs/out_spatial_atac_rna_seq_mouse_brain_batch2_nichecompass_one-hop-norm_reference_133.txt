[True]
Run timestamp: 10102023_035057_133.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_133']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7608; val_auprc_score: 0.7853; val_best_acc_score: 0.6121; val_best_f1_score: 0.7065; train_kl_reg_loss: 77709.7530; train_edge_recon_loss: 3515653.4275; train_gene_expr_recon_loss: 13318974.6031; train_masked_gp_l1_reg_loss: 32775.3482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2348729.3263; train_chrom_access_recon_loss: 11160923.0458; train_global_loss: 30454765.4046; train_optim_loss: 30454765.4046; val_kl_reg_loss: 92698.3802; val_edge_recon_loss: 4058616.4667; val_gene_expr_recon_loss: 12544594.7333; val_masked_gp_l1_reg_loss: 38132.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 531299.4375; val_chrom_access_recon_loss: 10706228.4000; val_global_loss: 27971569.2000; val_optim_loss: 27971569.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8316; val_auprc_score: 0.8293; val_best_acc_score: 0.7431; val_best_f1_score: 0.7621; train_kl_reg_loss: 81560.3951; train_edge_recon_loss: 3417446.6298; train_gene_expr_recon_loss: 12575767.1145; train_masked_gp_l1_reg_loss: 41080.8913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 283528.2115; train_chrom_access_recon_loss: 10796938.5191; train_global_loss: 27196321.7252; train_optim_loss: 27196321.7252; val_kl_reg_loss: 94685.4974; val_edge_recon_loss: 3189074.0833; val_gene_expr_recon_loss: 12438219.7333; val_masked_gp_l1_reg_loss: 45358.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168571.8750; val_chrom_access_recon_loss: 10634044.0667; val_global_loss: 26569953.4667; val_optim_loss: 26569953.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9001; val_auprc_score: 0.8833; val_best_acc_score: 0.8243; val_best_f1_score: 0.8377; train_kl_reg_loss: 97867.1623; train_edge_recon_loss: 2950759.9580; train_gene_expr_recon_loss: 12420564.1679; train_masked_gp_l1_reg_loss: 48970.4415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136357.8253; train_chrom_access_recon_loss: 10659100.8015; train_global_loss: 26313620.4427; train_optim_loss: 26313620.4427; val_kl_reg_loss: 97335.0354; val_edge_recon_loss: 2888376.3500; val_gene_expr_recon_loss: 12222306.4000; val_masked_gp_l1_reg_loss: 52176.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116823.3047; val_chrom_access_recon_loss: 10482271.1333; val_global_loss: 25859289.0667; val_optim_loss: 25859289.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9174; val_auprc_score: 0.9017; val_best_acc_score: 0.8460; val_best_f1_score: 0.8552; train_kl_reg_loss: 100872.2162; train_edge_recon_loss: 2840997.7805; train_gene_expr_recon_loss: 12256202.9618; train_masked_gp_l1_reg_loss: 54340.0041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106369.1085; train_chrom_access_recon_loss: 10533380.5496; train_global_loss: 25892162.6870; train_optim_loss: 25892162.6870; val_kl_reg_loss: 100160.2641; val_edge_recon_loss: 2841893.0667; val_gene_expr_recon_loss: 12195826.6667; val_masked_gp_l1_reg_loss: 56322.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99480.8984; val_chrom_access_recon_loss: 10507633.2667; val_global_loss: 25801317.2000; val_optim_loss: 25801317.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9298; val_auprc_score: 0.9173; val_best_acc_score: 0.8622; val_best_f1_score: 0.8694; train_kl_reg_loss: 95394.7803; train_edge_recon_loss: 2804768.4008; train_gene_expr_recon_loss: 12150736.1756; train_masked_gp_l1_reg_loss: 58085.4772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94577.6992; train_chrom_access_recon_loss: 10459154.6031; train_global_loss: 25662717.0992; train_optim_loss: 25662717.0992; val_kl_reg_loss: 93738.5016; val_edge_recon_loss: 2797762.0333; val_gene_expr_recon_loss: 12050483.8000; val_masked_gp_l1_reg_loss: 59771.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91269.6953; val_chrom_access_recon_loss: 10326119.0000; val_global_loss: 25419145.2000; val_optim_loss: 25419145.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9341; val_auprc_score: 0.9224; val_best_acc_score: 0.8622; val_best_f1_score: 0.8707; train_kl_reg_loss: 91129.9195; train_edge_recon_loss: 2791746.1927; train_gene_expr_recon_loss: 12051099.8015; train_masked_gp_l1_reg_loss: 61239.7825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88820.5261; train_chrom_access_recon_loss: 10372589.0382; train_global_loss: 25456625.2519; train_optim_loss: 25456625.2519; val_kl_reg_loss: 88829.5078; val_edge_recon_loss: 2806619.6167; val_gene_expr_recon_loss: 11939438.2667; val_masked_gp_l1_reg_loss: 62520.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86668.6406; val_chrom_access_recon_loss: 10310484.1333; val_global_loss: 25294561.2000; val_optim_loss: 25294561.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9316; val_auprc_score: 0.9170; val_best_acc_score: 0.8666; val_best_f1_score: 0.8734; train_kl_reg_loss: 87458.0400; train_edge_recon_loss: 2776724.3588; train_gene_expr_recon_loss: 11968509.5725; train_masked_gp_l1_reg_loss: 63746.9139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84424.5465; train_chrom_access_recon_loss: 10314007.6794; train_global_loss: 25294871.1450; train_optim_loss: 25294871.1450; val_kl_reg_loss: 88942.3698; val_edge_recon_loss: 2792455.3833; val_gene_expr_recon_loss: 11840712.6667; val_masked_gp_l1_reg_loss: 64698.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81404.7031; val_chrom_access_recon_loss: 10170887.6000; val_global_loss: 25039102.1333; val_optim_loss: 25039102.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9463; val_auprc_score: 0.9367; val_best_acc_score: 0.8798; val_best_f1_score: 0.8864; train_kl_reg_loss: 84234.8378; train_edge_recon_loss: 2758922.7004; train_gene_expr_recon_loss: 11893172.7786; train_masked_gp_l1_reg_loss: 65922.2040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80486.0263; train_chrom_access_recon_loss: 10248737.4198; train_global_loss: 25131475.9542; train_optim_loss: 25131475.9542; val_kl_reg_loss: 87369.1958; val_edge_recon_loss: 2771716.5500; val_gene_expr_recon_loss: 11842365.9333; val_masked_gp_l1_reg_loss: 66928.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78929.9453; val_chrom_access_recon_loss: 10133762.7333; val_global_loss: 24981074.0000; val_optim_loss: 24981074.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9554; val_auprc_score: 0.9434; val_best_acc_score: 0.8930; val_best_f1_score: 0.8965; train_kl_reg_loss: 83527.8123; train_edge_recon_loss: 2747755.8626; train_gene_expr_recon_loss: 11831102.3664; train_masked_gp_l1_reg_loss: 67827.4311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77604.8497; train_chrom_access_recon_loss: 10180705.6107; train_global_loss: 24988523.9847; train_optim_loss: 24988523.9847; val_kl_reg_loss: 82882.6948; val_edge_recon_loss: 2744640.9667; val_gene_expr_recon_loss: 11693117.2667; val_masked_gp_l1_reg_loss: 68733.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77405.8984; val_chrom_access_recon_loss: 10061097.8667; val_global_loss: 24727877.8667; val_optim_loss: 24727877.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9525; val_auprc_score: 0.9406; val_best_acc_score: 0.8940; val_best_f1_score: 0.8982; train_kl_reg_loss: 81812.1239; train_edge_recon_loss: 2734409.2538; train_gene_expr_recon_loss: 11773950.8473; train_masked_gp_l1_reg_loss: 69417.5224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75658.4820; train_chrom_access_recon_loss: 10124693.2443; train_global_loss: 24859941.4809; train_optim_loss: 24859941.4809; val_kl_reg_loss: 78942.7917; val_edge_recon_loss: 2756416.4333; val_gene_expr_recon_loss: 11713153.8667; val_masked_gp_l1_reg_loss: 70147.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75030.3828; val_chrom_access_recon_loss: 10018554.8000; val_global_loss: 24712246.0000; val_optim_loss: 24712246.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9562; val_auprc_score: 0.9456; val_best_acc_score: 0.8985; val_best_f1_score: 0.9012; train_kl_reg_loss: 80909.0952; train_edge_recon_loss: 2720016.3435; train_gene_expr_recon_loss: 11716719.3435; train_masked_gp_l1_reg_loss: 70656.0587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73986.5066; train_chrom_access_recon_loss: 10066573.1679; train_global_loss: 24728860.4427; train_optim_loss: 24728860.4427; val_kl_reg_loss: 82654.5667; val_edge_recon_loss: 2749916.2667; val_gene_expr_recon_loss: 11608958.1333; val_masked_gp_l1_reg_loss: 71263.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73410.8203; val_chrom_access_recon_loss: 9926840.5333; val_global_loss: 24513044.5333; val_optim_loss: 24513044.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9624; val_auprc_score: 0.9542; val_best_acc_score: 0.9011; val_best_f1_score: 0.9054; train_kl_reg_loss: 81010.2300; train_edge_recon_loss: 2715098.5706; train_gene_expr_recon_loss: 11675806.1374; train_masked_gp_l1_reg_loss: 71663.6636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72935.1075; train_chrom_access_recon_loss: 10032277.4046; train_global_loss: 24648791.0534; train_optim_loss: 24648791.0534; val_kl_reg_loss: 82532.3771; val_edge_recon_loss: 2736067.2833; val_gene_expr_recon_loss: 11640024.2667; val_masked_gp_l1_reg_loss: 72114.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72495.7891; val_chrom_access_recon_loss: 9989818.7333; val_global_loss: 24593053.2000; val_optim_loss: 24593053.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9621; val_auprc_score: 0.9496; val_best_acc_score: 0.9096; val_best_f1_score: 0.9130; train_kl_reg_loss: 79000.6438; train_edge_recon_loss: 2707474.8149; train_gene_expr_recon_loss: 11624061.5954; train_masked_gp_l1_reg_loss: 72422.6246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72004.5348; train_chrom_access_recon_loss: 9982744.8321; train_global_loss: 24537709.0687; train_optim_loss: 24537709.0687; val_kl_reg_loss: 78506.4328; val_edge_recon_loss: 2736712.1000; val_gene_expr_recon_loss: 11577280.9333; val_masked_gp_l1_reg_loss: 72804.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71828.1250; val_chrom_access_recon_loss: 9916189.6000; val_global_loss: 24453320.9333; val_optim_loss: 24453320.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9654; val_auprc_score: 0.9546; val_best_acc_score: 0.9154; val_best_f1_score: 0.9183; train_kl_reg_loss: 78656.4154; train_edge_recon_loss: 2697805.4466; train_gene_expr_recon_loss: 11598565.9924; train_masked_gp_l1_reg_loss: 73145.9893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71476.3037; train_chrom_access_recon_loss: 9945685.4809; train_global_loss: 24465335.5115; train_optim_loss: 24465335.5115; val_kl_reg_loss: 77810.8542; val_edge_recon_loss: 2715797.7667; val_gene_expr_recon_loss: 11516797.0000; val_masked_gp_l1_reg_loss: 73537.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72023.9531; val_chrom_access_recon_loss: 9874606.0000; val_global_loss: 24330573.7333; val_optim_loss: 24330573.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9699; val_auprc_score: 0.9615; val_best_acc_score: 0.9209; val_best_f1_score: 0.9230; train_kl_reg_loss: 77292.2848; train_edge_recon_loss: 2696101.3664; train_gene_expr_recon_loss: 11558316.1985; train_masked_gp_l1_reg_loss: 73764.5748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71460.5145; train_chrom_access_recon_loss: 9905027.1374; train_global_loss: 24381962.1374; train_optim_loss: 24381962.1374; val_kl_reg_loss: 75930.6151; val_edge_recon_loss: 2703083.7500; val_gene_expr_recon_loss: 11418644.0000; val_masked_gp_l1_reg_loss: 73916.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71486.6719; val_chrom_access_recon_loss: 9801130.8000; val_global_loss: 24144193.2000; val_optim_loss: 24144193.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9698; val_auprc_score: 0.9619; val_best_acc_score: 0.9212; val_best_f1_score: 0.9240; train_kl_reg_loss: 76336.8818; train_edge_recon_loss: 2689894.0782; train_gene_expr_recon_loss: 11518727.1527; train_masked_gp_l1_reg_loss: 74211.6435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71608.4979; train_chrom_access_recon_loss: 9860424.5038; train_global_loss: 24291202.7786; train_optim_loss: 24291202.7786; val_kl_reg_loss: 75830.6297; val_edge_recon_loss: 2697618.4000; val_gene_expr_recon_loss: 11414349.5333; val_masked_gp_l1_reg_loss: 74437.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71770.1094; val_chrom_access_recon_loss: 9797611.3333; val_global_loss: 24131616.6667; val_optim_loss: 24131616.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9688; val_auprc_score: 0.9611; val_best_acc_score: 0.9204; val_best_f1_score: 0.9229; train_kl_reg_loss: 75693.7384; train_edge_recon_loss: 2687693.9714; train_gene_expr_recon_loss: 11492881.3130; train_masked_gp_l1_reg_loss: 74601.5578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71838.7570; train_chrom_access_recon_loss: 9812264.7099; train_global_loss: 24214974.0458; train_optim_loss: 24214974.0458; val_kl_reg_loss: 75370.7198; val_edge_recon_loss: 2719328.6667; val_gene_expr_recon_loss: 11432437.6667; val_masked_gp_l1_reg_loss: 74807.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72628.5000; val_chrom_access_recon_loss: 9730850.2667; val_global_loss: 24105423.6000; val_optim_loss: 24105423.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9723; val_auprc_score: 0.9661; val_best_acc_score: 0.9245; val_best_f1_score: 0.9262; train_kl_reg_loss: 74912.0933; train_edge_recon_loss: 2685229.9370; train_gene_expr_recon_loss: 11464317.4046; train_masked_gp_l1_reg_loss: 74908.2065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72488.0733; train_chrom_access_recon_loss: 9768616.0305; train_global_loss: 24140471.8473; train_optim_loss: 24140471.8473; val_kl_reg_loss: 73617.9703; val_edge_recon_loss: 2705614.0167; val_gene_expr_recon_loss: 11376651.3333; val_masked_gp_l1_reg_loss: 74950.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73173.7500; val_chrom_access_recon_loss: 9691560.3333; val_global_loss: 23995567.8667; val_optim_loss: 23995567.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9705; val_auprc_score: 0.9624; val_best_acc_score: 0.9196; val_best_f1_score: 0.9224; train_kl_reg_loss: 73761.1169; train_edge_recon_loss: 2684634.0649; train_gene_expr_recon_loss: 11430938.6565; train_masked_gp_l1_reg_loss: 75125.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73138.3382; train_chrom_access_recon_loss: 9734829.5954; train_global_loss: 24072426.7176; train_optim_loss: 24072426.7176; val_kl_reg_loss: 72712.8219; val_edge_recon_loss: 2712735.9500; val_gene_expr_recon_loss: 11406564.2667; val_masked_gp_l1_reg_loss: 75312.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73960.2422; val_chrom_access_recon_loss: 9726971.6000; val_global_loss: 24068257.3333; val_optim_loss: 24068257.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9733; val_auprc_score: 0.9640; val_best_acc_score: 0.9245; val_best_f1_score: 0.9269; train_kl_reg_loss: 73863.1082; train_edge_recon_loss: 2691958.8607; train_gene_expr_recon_loss: 11415367.1832; train_masked_gp_l1_reg_loss: 75356.7914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73779.1594; train_chrom_access_recon_loss: 9700739.3282; train_global_loss: 24031064.5191; train_optim_loss: 24031064.5191; val_kl_reg_loss: 74638.8828; val_edge_recon_loss: 2689492.4500; val_gene_expr_recon_loss: 11370008.8667; val_masked_gp_l1_reg_loss: 75273.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73742.1250; val_chrom_access_recon_loss: 9732689.3333; val_global_loss: 24015845.7333; val_optim_loss: 24015845.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9754; val_auprc_score: 0.9677; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 73982.2513; train_edge_recon_loss: 2684402.3282; train_gene_expr_recon_loss: 11386453.1450; train_masked_gp_l1_reg_loss: 75288.2721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73815.4339; train_chrom_access_recon_loss: 9665834.7328; train_global_loss: 23959776.2137; train_optim_loss: 23959776.2137; val_kl_reg_loss: 71939.9750; val_edge_recon_loss: 2688993.0833; val_gene_expr_recon_loss: 11392561.1333; val_masked_gp_l1_reg_loss: 75291.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73857.4531; val_chrom_access_recon_loss: 9718281.1333; val_global_loss: 24020923.3333; val_optim_loss: 24020923.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9747; val_auprc_score: 0.9650; val_best_acc_score: 0.9302; val_best_f1_score: 0.9321; train_kl_reg_loss: 72015.9717; train_edge_recon_loss: 2690827.5592; train_gene_expr_recon_loss: 11372987.6489; train_masked_gp_l1_reg_loss: 75320.2213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73960.1725; train_chrom_access_recon_loss: 9636634.8664; train_global_loss: 23921746.2748; train_optim_loss: 23921746.2748; val_kl_reg_loss: 71865.2901; val_edge_recon_loss: 2699852.0333; val_gene_expr_recon_loss: 11292819.0667; val_masked_gp_l1_reg_loss: 75367.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74361.8594; val_chrom_access_recon_loss: 9610883.9333; val_global_loss: 23825150.1333; val_optim_loss: 23825150.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9758; val_auprc_score: 0.9701; val_best_acc_score: 0.9306; val_best_f1_score: 0.9329; train_kl_reg_loss: 71569.0469; train_edge_recon_loss: 2687874.3702; train_gene_expr_recon_loss: 11348824.1679; train_masked_gp_l1_reg_loss: 75407.7340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74112.5332; train_chrom_access_recon_loss: 9608927.4046; train_global_loss: 23866715.2366; train_optim_loss: 23866715.2366; val_kl_reg_loss: 70315.8859; val_edge_recon_loss: 2700381.2167; val_gene_expr_recon_loss: 11327434.0667; val_masked_gp_l1_reg_loss: 75482.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74342.6172; val_chrom_access_recon_loss: 9588642.0000; val_global_loss: 23836598.0000; val_optim_loss: 23836598.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9794; val_auprc_score: 0.9719; val_best_acc_score: 0.9352; val_best_f1_score: 0.9364; train_kl_reg_loss: 71614.7257; train_edge_recon_loss: 2680550.6107; train_gene_expr_recon_loss: 11341232.3588; train_masked_gp_l1_reg_loss: 75436.3469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74388.9006; train_chrom_access_recon_loss: 9593502.3817; train_global_loss: 23836725.2519; train_optim_loss: 23836725.2519; val_kl_reg_loss: 68397.4391; val_edge_recon_loss: 2703665.8167; val_gene_expr_recon_loss: 11323103.2667; val_masked_gp_l1_reg_loss: 75435.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74620.7812; val_chrom_access_recon_loss: 9581738.6667; val_global_loss: 23826961.3333; val_optim_loss: 23826961.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9808; val_auprc_score: 0.9734; val_best_acc_score: 0.9391; val_best_f1_score: 0.9402; train_kl_reg_loss: 70594.2988; train_edge_recon_loss: 2675090.6737; train_gene_expr_recon_loss: 11332680.8855; train_masked_gp_l1_reg_loss: 75468.1208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74353.7131; train_chrom_access_recon_loss: 9558702.9542; train_global_loss: 23786890.5802; train_optim_loss: 23786890.5802; val_kl_reg_loss: 70853.3010; val_edge_recon_loss: 2688836.3167; val_gene_expr_recon_loss: 11269133.2000; val_masked_gp_l1_reg_loss: 75420.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74614.3203; val_chrom_access_recon_loss: 9569043.9333; val_global_loss: 23747900.8000; val_optim_loss: 23747900.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9796; val_auprc_score: 0.9746; val_best_acc_score: 0.9386; val_best_f1_score: 0.9403; train_kl_reg_loss: 69701.7354; train_edge_recon_loss: 2677887.8378; train_gene_expr_recon_loss: 11315312.2061; train_masked_gp_l1_reg_loss: 75415.0498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74468.8619; train_chrom_access_recon_loss: 9533099.8168; train_global_loss: 23745885.5878; train_optim_loss: 23745885.5878; val_kl_reg_loss: 70039.3484; val_edge_recon_loss: 2688815.6667; val_gene_expr_recon_loss: 11255828.6667; val_masked_gp_l1_reg_loss: 75363.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74942.8828; val_chrom_access_recon_loss: 9508313.1333; val_global_loss: 23673302.9333; val_optim_loss: 23673302.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9782; val_auprc_score: 0.9714; val_best_acc_score: 0.9378; val_best_f1_score: 0.9393; train_kl_reg_loss: 70380.6000; train_edge_recon_loss: 2675120.5458; train_gene_expr_recon_loss: 11300003.2137; train_masked_gp_l1_reg_loss: 75338.2807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74600.9451; train_chrom_access_recon_loss: 9509181.1985; train_global_loss: 23704624.7481; train_optim_loss: 23704624.7481; val_kl_reg_loss: 70024.1297; val_edge_recon_loss: 2689353.1000; val_gene_expr_recon_loss: 11192317.2000; val_masked_gp_l1_reg_loss: 75268.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74904.2969; val_chrom_access_recon_loss: 9487258.4667; val_global_loss: 23589125.6000; val_optim_loss: 23589125.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9802; val_auprc_score: 0.9751; val_best_acc_score: 0.9406; val_best_f1_score: 0.9418; train_kl_reg_loss: 70143.6673; train_edge_recon_loss: 2670366.9485; train_gene_expr_recon_loss: 11291795.5267; train_masked_gp_l1_reg_loss: 75039.7550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74702.3366; train_chrom_access_recon_loss: 9487001.1527; train_global_loss: 23669049.4198; train_optim_loss: 23669049.4198; val_kl_reg_loss: 69216.7453; val_edge_recon_loss: 2699341.5667; val_gene_expr_recon_loss: 11233407.8667; val_masked_gp_l1_reg_loss: 75001.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75213.5312; val_chrom_access_recon_loss: 9506345.4667; val_global_loss: 23658527.7333; val_optim_loss: 23658527.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9778; val_auprc_score: 0.9712; val_best_acc_score: 0.9338; val_best_f1_score: 0.9353; train_kl_reg_loss: 69395.5607; train_edge_recon_loss: 2669249.3034; train_gene_expr_recon_loss: 11285771.5191; train_masked_gp_l1_reg_loss: 74874.0010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74866.2589; train_chrom_access_recon_loss: 9473850.2519; train_global_loss: 23648007.0229; train_optim_loss: 23648007.0229; val_kl_reg_loss: 68115.3417; val_edge_recon_loss: 2699707.1500; val_gene_expr_recon_loss: 11155226.0667; val_masked_gp_l1_reg_loss: 74756.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75016.4297; val_chrom_access_recon_loss: 9430333.1333; val_global_loss: 23503153.7333; val_optim_loss: 23503153.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9806; val_auprc_score: 0.9745; val_best_acc_score: 0.9399; val_best_f1_score: 0.9415; train_kl_reg_loss: 69143.0974; train_edge_recon_loss: 2673135.1889; train_gene_expr_recon_loss: 11264862.7405; train_masked_gp_l1_reg_loss: 74665.5072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74951.1460; train_chrom_access_recon_loss: 9438046.8397; train_global_loss: 23594804.5344; train_optim_loss: 23594804.5344; val_kl_reg_loss: 69070.2953; val_edge_recon_loss: 2704170.6667; val_gene_expr_recon_loss: 11256689.6000; val_masked_gp_l1_reg_loss: 74416.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74840.1641; val_chrom_access_recon_loss: 9517785.3333; val_global_loss: 23696972.0000; val_optim_loss: 23696972.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9812; val_auprc_score: 0.9701; val_best_acc_score: 0.9435; val_best_f1_score: 0.9453; train_kl_reg_loss: 68662.0968; train_edge_recon_loss: 2671302.6336; train_gene_expr_recon_loss: 11259057.5573; train_masked_gp_l1_reg_loss: 74390.5792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74894.4580; train_chrom_access_recon_loss: 9426452.5115; train_global_loss: 23574759.9237; train_optim_loss: 23574759.9237; val_kl_reg_loss: 69478.6823; val_edge_recon_loss: 2677658.0833; val_gene_expr_recon_loss: 11216603.9333; val_masked_gp_l1_reg_loss: 74413.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75638.2422; val_chrom_access_recon_loss: 9491237.4667; val_global_loss: 23605030.2667; val_optim_loss: 23605030.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9815; val_auprc_score: 0.9761; val_best_acc_score: 0.9418; val_best_f1_score: 0.9431; train_kl_reg_loss: 68294.6059; train_edge_recon_loss: 2672300.9256; train_gene_expr_recon_loss: 11240826.5267; train_masked_gp_l1_reg_loss: 74209.6002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75200.7604; train_chrom_access_recon_loss: 9413166.2443; train_global_loss: 23543998.7023; train_optim_loss: 23543998.7023; val_kl_reg_loss: 66883.6076; val_edge_recon_loss: 2683816.7500; val_gene_expr_recon_loss: 11205552.4667; val_masked_gp_l1_reg_loss: 74122.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75768.1719; val_chrom_access_recon_loss: 9458060.0667; val_global_loss: 23564202.6667; val_optim_loss: 23564202.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9818; val_auprc_score: 0.9766; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 67621.8898; train_edge_recon_loss: 2671382.6393; train_gene_expr_recon_loss: 11249111.7710; train_masked_gp_l1_reg_loss: 73881.2175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75228.6342; train_chrom_access_recon_loss: 9413731.2595; train_global_loss: 23550957.4656; train_optim_loss: 23550957.4656; val_kl_reg_loss: 67915.6427; val_edge_recon_loss: 2682109.8333; val_gene_expr_recon_loss: 11196108.1333; val_masked_gp_l1_reg_loss: 73881.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75991.8750; val_chrom_access_recon_loss: 9463574.2000; val_global_loss: 23559581.8667; val_optim_loss: 23559581.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9835; val_auprc_score: 0.9790; val_best_acc_score: 0.9466; val_best_f1_score: 0.9483; train_kl_reg_loss: 69113.4116; train_edge_recon_loss: 2662033.6947; train_gene_expr_recon_loss: 11227322.4504; train_masked_gp_l1_reg_loss: 72819.2808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58712.6570; train_chrom_access_recon_loss: 9371226.2824; train_global_loss: 23461227.8015; train_optim_loss: 23461227.8015; val_kl_reg_loss: 70881.8875; val_edge_recon_loss: 2678948.2333; val_gene_expr_recon_loss: 11175604.6000; val_masked_gp_l1_reg_loss: 72469.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56239.9492; val_chrom_access_recon_loss: 9435191.4000; val_global_loss: 23489336.1333; val_optim_loss: 23489336.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9846; val_auprc_score: 0.9813; val_best_acc_score: 0.9437; val_best_f1_score: 0.9449; train_kl_reg_loss: 70483.1985; train_edge_recon_loss: 2659735.3950; train_gene_expr_recon_loss: 11223468.4122; train_masked_gp_l1_reg_loss: 72378.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55836.8691; train_chrom_access_recon_loss: 9360065.1069; train_global_loss: 23441967.7252; train_optim_loss: 23441967.7252; val_kl_reg_loss: 70920.6875; val_edge_recon_loss: 2686651.1167; val_gene_expr_recon_loss: 11165983.9333; val_masked_gp_l1_reg_loss: 72321.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55489.5586; val_chrom_access_recon_loss: 9434861.4000; val_global_loss: 23486228.1333; val_optim_loss: 23486228.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9821; val_auprc_score: 0.9742; val_best_acc_score: 0.9452; val_best_f1_score: 0.9463; train_kl_reg_loss: 71154.5212; train_edge_recon_loss: 2658150.9599; train_gene_expr_recon_loss: 11221091.5954; train_masked_gp_l1_reg_loss: 72264.8009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55191.9495; train_chrom_access_recon_loss: 9360928.9618; train_global_loss: 23438782.6565; train_optim_loss: 23438782.6565; val_kl_reg_loss: 71038.7031; val_edge_recon_loss: 2675099.5500; val_gene_expr_recon_loss: 11183388.2000; val_masked_gp_l1_reg_loss: 72220.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54997.7695; val_chrom_access_recon_loss: 9407827.4000; val_global_loss: 23464571.4667; val_optim_loss: 23464571.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9806; val_auprc_score: 0.9736; val_best_acc_score: 0.9417; val_best_f1_score: 0.9434; train_kl_reg_loss: 70977.0567; train_edge_recon_loss: 2655372.3206; train_gene_expr_recon_loss: 11218718.2748; train_masked_gp_l1_reg_loss: 72202.1189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54816.7224; train_chrom_access_recon_loss: 9360532.1374; train_global_loss: 23432618.6260; train_optim_loss: 23432618.6260; val_kl_reg_loss: 71498.3078; val_edge_recon_loss: 2682325.2167; val_gene_expr_recon_loss: 11164596.6667; val_masked_gp_l1_reg_loss: 72164.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54635.3711; val_chrom_access_recon_loss: 9433895.8667; val_global_loss: 23479114.9333; val_optim_loss: 23479114.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9829; val_auprc_score: 0.9771; val_best_acc_score: 0.9442; val_best_f1_score: 0.9457; train_kl_reg_loss: 70531.0555; train_edge_recon_loss: 2667597.0248; train_gene_expr_recon_loss: 11220768.0000; train_masked_gp_l1_reg_loss: 72153.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54430.5271; train_chrom_access_recon_loss: 9354844.8626; train_global_loss: 23440324.9618; train_optim_loss: 23440324.9618; val_kl_reg_loss: 70749.1125; val_edge_recon_loss: 2673822.0667; val_gene_expr_recon_loss: 11172987.4667; val_masked_gp_l1_reg_loss: 72121.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54317.9844; val_chrom_access_recon_loss: 9408709.6667; val_global_loss: 23452708.5333; val_optim_loss: 23452708.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9832; val_auprc_score: 0.9770; val_best_acc_score: 0.9458; val_best_f1_score: 0.9471; train_kl_reg_loss: 70465.0936; train_edge_recon_loss: 2662341.2977; train_gene_expr_recon_loss: 11216150.8626; train_masked_gp_l1_reg_loss: 72100.2468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54186.2659; train_chrom_access_recon_loss: 9355965.8626; train_global_loss: 23431209.6641; train_optim_loss: 23431209.6641; val_kl_reg_loss: 71098.3521; val_edge_recon_loss: 2704441.7500; val_gene_expr_recon_loss: 11143620.6667; val_masked_gp_l1_reg_loss: 72081.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54051.4844; val_chrom_access_recon_loss: 9400867.5333; val_global_loss: 23446161.6000; val_optim_loss: 23446161.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9823; val_auprc_score: 0.9774; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 71113.0309; train_edge_recon_loss: 2659326.4504; train_gene_expr_recon_loss: 11217668.0763; train_masked_gp_l1_reg_loss: 72059.8270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53871.4670; train_chrom_access_recon_loss: 9347513.2214; train_global_loss: 23421551.9237; train_optim_loss: 23421551.9237; val_kl_reg_loss: 70855.3594; val_edge_recon_loss: 2671434.5167; val_gene_expr_recon_loss: 11180943.6000; val_masked_gp_l1_reg_loss: 72046.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53764.0586; val_chrom_access_recon_loss: 9391896.7333; val_global_loss: 23440941.2000; val_optim_loss: 23440941.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9829; val_auprc_score: 0.9784; val_best_acc_score: 0.9448; val_best_f1_score: 0.9467; train_kl_reg_loss: 70830.2109; train_edge_recon_loss: 2661043.4523; train_gene_expr_recon_loss: 11212613.3588; train_masked_gp_l1_reg_loss: 72013.9800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53580.1673; train_chrom_access_recon_loss: 9341728.9389; train_global_loss: 23411810.0611; train_optim_loss: 23411810.0611; val_kl_reg_loss: 69930.4833; val_edge_recon_loss: 2676850.7500; val_gene_expr_recon_loss: 11189421.8667; val_masked_gp_l1_reg_loss: 71989.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53450.6641; val_chrom_access_recon_loss: 9404230.6667; val_global_loss: 23465874.5333; val_optim_loss: 23465874.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9841; val_auprc_score: 0.9792; val_best_acc_score: 0.9454; val_best_f1_score: 0.9466; train_kl_reg_loss: 70501.2151; train_edge_recon_loss: 2664602.0973; train_gene_expr_recon_loss: 11207398.3206; train_masked_gp_l1_reg_loss: 71982.0270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53308.1249; train_chrom_access_recon_loss: 9334729.5878; train_global_loss: 23402521.4351; train_optim_loss: 23402521.4351; val_kl_reg_loss: 70625.6391; val_edge_recon_loss: 2676098.2000; val_gene_expr_recon_loss: 11176751.8000; val_masked_gp_l1_reg_loss: 71973.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53243.3242; val_chrom_access_recon_loss: 9418083.3333; val_global_loss: 23466775.2000; val_optim_loss: 23466775.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9843; val_auprc_score: 0.9804; val_best_acc_score: 0.9448; val_best_f1_score: 0.9464; train_kl_reg_loss: 70464.8522; train_edge_recon_loss: 2654181.2176; train_gene_expr_recon_loss: 11216681.8473; train_masked_gp_l1_reg_loss: 71944.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53063.7264; train_chrom_access_recon_loss: 9352413.6870; train_global_loss: 23418749.4351; train_optim_loss: 23418749.4351; val_kl_reg_loss: 70354.5365; val_edge_recon_loss: 2672223.8667; val_gene_expr_recon_loss: 11161883.8667; val_masked_gp_l1_reg_loss: 71938.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53008.3320; val_chrom_access_recon_loss: 9373334.0000; val_global_loss: 23402742.4000; val_optim_loss: 23402742.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9836; val_auprc_score: 0.9762; val_best_acc_score: 0.9452; val_best_f1_score: 0.9465; train_kl_reg_loss: 70523.2437; train_edge_recon_loss: 2661665.1317; train_gene_expr_recon_loss: 11216874.3435; train_masked_gp_l1_reg_loss: 71917.4580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52869.8046; train_chrom_access_recon_loss: 9341813.0076; train_global_loss: 23415663.0687; train_optim_loss: 23415663.0687; val_kl_reg_loss: 70337.2026; val_edge_recon_loss: 2682978.1500; val_gene_expr_recon_loss: 11149354.2000; val_masked_gp_l1_reg_loss: 71899.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52754.6250; val_chrom_access_recon_loss: 9399002.0667; val_global_loss: 23426325.8667; val_optim_loss: 23426325.8667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9843; val_auprc_score: 0.9797; val_best_acc_score: 0.9479; val_best_f1_score: 0.9492; train_kl_reg_loss: 70298.2244; train_edge_recon_loss: 2661172.7347; train_gene_expr_recon_loss: 11199681.4122; train_masked_gp_l1_reg_loss: 71898.2123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52589.8180; train_chrom_access_recon_loss: 9327243.9542; train_global_loss: 23382884.3359; train_optim_loss: 23382884.3359; val_kl_reg_loss: 70671.0052; val_edge_recon_loss: 2670041.3000; val_gene_expr_recon_loss: 11196762.1333; val_masked_gp_l1_reg_loss: 71884.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52493.8477; val_chrom_access_recon_loss: 9411377.0000; val_global_loss: 23473229.7333; val_optim_loss: 23473229.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9855; val_auprc_score: 0.9817; val_best_acc_score: 0.9489; val_best_f1_score: 0.9499; train_kl_reg_loss: 70480.4136; train_edge_recon_loss: 2659576.9485; train_gene_expr_recon_loss: 11200983.9160; train_masked_gp_l1_reg_loss: 71858.9229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52379.4294; train_chrom_access_recon_loss: 9326612.9542; train_global_loss: 23381892.5649; train_optim_loss: 23381892.5649; val_kl_reg_loss: 70187.3208; val_edge_recon_loss: 2667926.6667; val_gene_expr_recon_loss: 11127752.1333; val_masked_gp_l1_reg_loss: 71860.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52238.8789; val_chrom_access_recon_loss: 9414329.4667; val_global_loss: 23404294.5333; val_optim_loss: 23404294.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9845; val_auprc_score: 0.9766; val_best_acc_score: 0.9495; val_best_f1_score: 0.9504; train_kl_reg_loss: 70596.8180; train_edge_recon_loss: 2653862.0573; train_gene_expr_recon_loss: 11197678.6641; train_masked_gp_l1_reg_loss: 71834.9662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52125.7632; train_chrom_access_recon_loss: 9325540.3206; train_global_loss: 23371638.6260; train_optim_loss: 23371638.6260; val_kl_reg_loss: 70788.1896; val_edge_recon_loss: 2672356.6167; val_gene_expr_recon_loss: 11149098.1333; val_masked_gp_l1_reg_loss: 71824.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52062.0898; val_chrom_access_recon_loss: 9442949.9333; val_global_loss: 23459078.8000; val_optim_loss: 23459078.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9850; val_auprc_score: 0.9799; val_best_acc_score: 0.9464; val_best_f1_score: 0.9481; train_kl_reg_loss: 70144.5382; train_edge_recon_loss: 2661852.8721; train_gene_expr_recon_loss: 11204030.4198; train_masked_gp_l1_reg_loss: 71698.9559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50331.7421; train_chrom_access_recon_loss: 9325252.7557; train_global_loss: 23383311.3435; train_optim_loss: 23383311.3435; val_kl_reg_loss: 70610.7589; val_edge_recon_loss: 2673047.5833; val_gene_expr_recon_loss: 11135689.4000; val_masked_gp_l1_reg_loss: 71649.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50107.9961; val_chrom_access_recon_loss: 9435269.8000; val_global_loss: 23436375.6000; val_optim_loss: 23436375.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9840; val_auprc_score: 0.9794; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 70182.8310; train_edge_recon_loss: 2655054.4179; train_gene_expr_recon_loss: 11205660.3740; train_masked_gp_l1_reg_loss: 71637.7118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50063.2141; train_chrom_access_recon_loss: 9341793.9847; train_global_loss: 23394392.5191; train_optim_loss: 23394392.5191; val_kl_reg_loss: 70667.5479; val_edge_recon_loss: 2665195.0667; val_gene_expr_recon_loss: 11177481.6667; val_masked_gp_l1_reg_loss: 71628.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50032.8398; val_chrom_access_recon_loss: 9371610.5333; val_global_loss: 23406616.9333; val_optim_loss: 23406616.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9849; val_auprc_score: 0.9790; val_best_acc_score: 0.9492; val_best_f1_score: 0.9505; train_kl_reg_loss: 70342.5453; train_edge_recon_loss: 2655149.9656; train_gene_expr_recon_loss: 11204773.0305; train_masked_gp_l1_reg_loss: 71624.0352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50000.8968; train_chrom_access_recon_loss: 9338807.8779; train_global_loss: 23390698.3511; train_optim_loss: 23390698.3511; val_kl_reg_loss: 71097.7818; val_edge_recon_loss: 2672140.3000; val_gene_expr_recon_loss: 11158990.0667; val_masked_gp_l1_reg_loss: 71620.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49978.0664; val_chrom_access_recon_loss: 9400893.2000; val_global_loss: 23424719.2000; val_optim_loss: 23424719.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9834; val_auprc_score: 0.9791; val_best_acc_score: 0.9454; val_best_f1_score: 0.9467; train_kl_reg_loss: 70294.1251; train_edge_recon_loss: 2660847.5115; train_gene_expr_recon_loss: 11198269.9542; train_masked_gp_l1_reg_loss: 71615.9085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49950.5443; train_chrom_access_recon_loss: 9323274.0382; train_global_loss: 23374252.0000; train_optim_loss: 23374252.0000; val_kl_reg_loss: 70701.5328; val_edge_recon_loss: 2679401.3000; val_gene_expr_recon_loss: 11125821.8667; val_masked_gp_l1_reg_loss: 71611.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49934.6836; val_chrom_access_recon_loss: 9372466.8667; val_global_loss: 23369938.5333; val_optim_loss: 23369938.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9842; val_auprc_score: 0.9794; val_best_acc_score: 0.9476; val_best_f1_score: 0.9486; train_kl_reg_loss: 70491.3962; train_edge_recon_loss: 2654215.8473; train_gene_expr_recon_loss: 11206551.7099; train_masked_gp_l1_reg_loss: 71611.4735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49908.8848; train_chrom_access_recon_loss: 9337345.3053; train_global_loss: 23390124.5191; train_optim_loss: 23390124.5191; val_kl_reg_loss: 70589.5521; val_edge_recon_loss: 2681144.3833; val_gene_expr_recon_loss: 11190019.6667; val_masked_gp_l1_reg_loss: 71608.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49891.8438; val_chrom_access_recon_loss: 9406249.2000; val_global_loss: 23469503.8667; val_optim_loss: 23469503.8667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9816; val_auprc_score: 0.9775; val_best_acc_score: 0.9423; val_best_f1_score: 0.9439; train_kl_reg_loss: 70340.0516; train_edge_recon_loss: 2661321.0363; train_gene_expr_recon_loss: 11202989.2901; train_masked_gp_l1_reg_loss: 71607.0012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49871.4303; train_chrom_access_recon_loss: 9326462.6412; train_global_loss: 23382591.4962; train_optim_loss: 23382591.4962; val_kl_reg_loss: 70885.1219; val_edge_recon_loss: 2690315.5500; val_gene_expr_recon_loss: 11141416.9333; val_masked_gp_l1_reg_loss: 71604.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49854.3867; val_chrom_access_recon_loss: 9391919.2000; val_global_loss: 23415994.8000; val_optim_loss: 23415994.8000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9814; val_auprc_score: 0.9752; val_best_acc_score: 0.9461; val_best_f1_score: 0.9476; train_kl_reg_loss: 70431.4625; train_edge_recon_loss: 2656868.6126; train_gene_expr_recon_loss: 11210799.0763; train_masked_gp_l1_reg_loss: 71604.4515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49836.6410; train_chrom_access_recon_loss: 9342557.0229; train_global_loss: 23402097.2214; train_optim_loss: 23402097.2214; val_kl_reg_loss: 71026.9536; val_edge_recon_loss: 2687554.6833; val_gene_expr_recon_loss: 11164976.9333; val_masked_gp_l1_reg_loss: 71603.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49821.8750; val_chrom_access_recon_loss: 9397015.8000; val_global_loss: 23441999.3333; val_optim_loss: 23441999.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9834; val_auprc_score: 0.9785; val_best_acc_score: 0.9441; val_best_f1_score: 0.9459; train_kl_reg_loss: 70241.8644; train_edge_recon_loss: 2657011.7462; train_gene_expr_recon_loss: 11198199.8168; train_masked_gp_l1_reg_loss: 71601.3070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49799.3935; train_chrom_access_recon_loss: 9320101.0458; train_global_loss: 23366955.1908; train_optim_loss: 23366955.1908; val_kl_reg_loss: 70366.1401; val_edge_recon_loss: 2670913.5167; val_gene_expr_recon_loss: 11145042.0667; val_masked_gp_l1_reg_loss: 71600.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49786.4062; val_chrom_access_recon_loss: 9378441.4000; val_global_loss: 23386150.0000; val_optim_loss: 23386150.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9848; val_auprc_score: 0.9813; val_best_acc_score: 0.9491; val_best_f1_score: 0.9501; train_kl_reg_loss: 70109.7869; train_edge_recon_loss: 2657872.2080; train_gene_expr_recon_loss: 11202134.6947; train_masked_gp_l1_reg_loss: 71589.2706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49614.5253; train_chrom_access_recon_loss: 9324266.0000; train_global_loss: 23375586.3359; train_optim_loss: 23375586.3359; val_kl_reg_loss: 70607.0740; val_edge_recon_loss: 2677320.5667; val_gene_expr_recon_loss: 11109018.8667; val_masked_gp_l1_reg_loss: 71583.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49592.7188; val_chrom_access_recon_loss: 9425496.2000; val_global_loss: 23403618.6667; val_optim_loss: 23403618.6667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9845; val_auprc_score: 0.9788; val_best_acc_score: 0.9488; val_best_f1_score: 0.9501; train_kl_reg_loss: 70157.6756; train_edge_recon_loss: 2653687.8187; train_gene_expr_recon_loss: 11205507.2061; train_masked_gp_l1_reg_loss: 71581.5737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49589.1287; train_chrom_access_recon_loss: 9334882.0916; train_global_loss: 23385405.4351; train_optim_loss: 23385405.4351; val_kl_reg_loss: 70595.1568; val_edge_recon_loss: 2660287.0500; val_gene_expr_recon_loss: 11125873.5333; val_masked_gp_l1_reg_loss: 71580.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49585.7227; val_chrom_access_recon_loss: 9402708.4667; val_global_loss: 23380630.1333; val_optim_loss: 23380630.1333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9831; val_auprc_score: 0.9790; val_best_acc_score: 0.9437; val_best_f1_score: 0.9449; train_kl_reg_loss: 70201.9298; train_edge_recon_loss: 2661424.7824; train_gene_expr_recon_loss: 11195277.4275; train_masked_gp_l1_reg_loss: 71579.1210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49582.6823; train_chrom_access_recon_loss: 9316990.5802; train_global_loss: 23365056.4885; train_optim_loss: 23365056.4885; val_kl_reg_loss: 70951.0844; val_edge_recon_loss: 2673684.9333; val_gene_expr_recon_loss: 11184492.5333; val_masked_gp_l1_reg_loss: 71578.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49580.5938; val_chrom_access_recon_loss: 9400687.4000; val_global_loss: 23450975.6000; val_optim_loss: 23450975.6000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9858; val_auprc_score: 0.9826; val_best_acc_score: 0.9476; val_best_f1_score: 0.9491; train_kl_reg_loss: 70135.2201; train_edge_recon_loss: 2656271.5286; train_gene_expr_recon_loss: 11206518.5420; train_masked_gp_l1_reg_loss: 71578.1727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49578.3382; train_chrom_access_recon_loss: 9321967.7328; train_global_loss: 23376049.7099; train_optim_loss: 23376049.7099; val_kl_reg_loss: 70606.9141; val_edge_recon_loss: 2663927.1500; val_gene_expr_recon_loss: 11138904.8667; val_masked_gp_l1_reg_loss: 71577.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49576.1641; val_chrom_access_recon_loss: 9390191.6000; val_global_loss: 23384784.5333; val_optim_loss: 23384784.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 42 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9842
val AUPRC score: 0.9801
val best accuracy score: 0.9480
val best F1 score: 0.9486
val target rna MSE score: 1.1703
val source rna MSE score: 0.4853
val target atac MSE score: 0.3319
val source atac MSE score: 0.0939
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
