[True]
Run timestamp: 26072023_034256_133.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_133']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9619; val_auprc_score: 0.9633; val_best_acc_score: 0.6029; val_best_f1_score: 0.7155; train_kl_reg_loss: 4936.0042; train_edge_recon_loss: 34675897.7778; train_gene_expr_recon_loss: 3159752.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10789445.1111; train_global_loss: 48630030.6667; train_optim_loss: 48630030.6667; val_kl_reg_loss: 11019.0586; val_edge_recon_loss: 40595056.0000; val_gene_expr_recon_loss: 3124630.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10716358.0000; val_global_loss: 54447064.0000; val_optim_loss: 54447064.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9493; val_auprc_score: 0.9490; val_best_acc_score: 0.7751; val_best_f1_score: 0.8138; train_kl_reg_loss: 4693.4759; train_edge_recon_loss: 34691427.1111; train_gene_expr_recon_loss: 3071715.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10808357.0000; train_global_loss: 48576194.2222; train_optim_loss: 48576194.2222; val_kl_reg_loss: 3360.4937; val_edge_recon_loss: 40504356.0000; val_gene_expr_recon_loss: 3041501.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10652816.0000; val_global_loss: 54202032.0000; val_optim_loss: 54202032.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9258; val_auprc_score: 0.9248; val_best_acc_score: 0.8286; val_best_f1_score: 0.8440; train_kl_reg_loss: 8695.0652; train_edge_recon_loss: 34693565.7778; train_gene_expr_recon_loss: 2984473.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10777105.7778; train_global_loss: 48463840.4444; train_optim_loss: 48463840.4444; val_kl_reg_loss: 15197.3613; val_edge_recon_loss: 40215732.0000; val_gene_expr_recon_loss: 2858456.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10509252.0000; val_global_loss: 53598636.0000; val_optim_loss: 53598636.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9073; val_auprc_score: 0.8967; val_best_acc_score: 0.7992; val_best_f1_score: 0.8250; train_kl_reg_loss: 11013.2617; train_edge_recon_loss: 34677512.4444; train_gene_expr_recon_loss: 2829801.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10589089.3333; train_global_loss: 48107416.4444; train_optim_loss: 48107416.4444; val_kl_reg_loss: 10318.2949; val_edge_recon_loss: 38938084.0000; val_gene_expr_recon_loss: 2777128.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10409933.0000; val_global_loss: 52135464.0000; val_optim_loss: 52135464.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8800; val_auprc_score: 0.8655; val_best_acc_score: 0.7935; val_best_f1_score: 0.8118; train_kl_reg_loss: 8246.3748; train_edge_recon_loss: 34250417.1111; train_gene_expr_recon_loss: 2744619.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10473810.1111; train_global_loss: 47477093.3333; train_optim_loss: 47477093.3333; val_kl_reg_loss: 4362.0879; val_edge_recon_loss: 32891702.0000; val_gene_expr_recon_loss: 2766923.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10413271.0000; val_global_loss: 46076260.0000; val_optim_loss: 46076260.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8687; val_auprc_score: 0.8616; val_best_acc_score: 0.7638; val_best_f1_score: 0.7950; train_kl_reg_loss: 7822.5291; train_edge_recon_loss: 30669300.2222; train_gene_expr_recon_loss: 2813174.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10559684.8889; train_global_loss: 44049982.2222; train_optim_loss: 44049982.2222; val_kl_reg_loss: 18409.2539; val_edge_recon_loss: 28418944.0000; val_gene_expr_recon_loss: 2837185.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10481559.0000; val_global_loss: 41756100.0000; val_optim_loss: 41756100.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8720; val_auprc_score: 0.8559; val_best_acc_score: 0.7757; val_best_f1_score: 0.7941; train_kl_reg_loss: 34617.6884; train_edge_recon_loss: 28724996.8889; train_gene_expr_recon_loss: 2743487.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10401550.4444; train_global_loss: 41904652.4444; train_optim_loss: 41904652.4444; val_kl_reg_loss: 49852.8281; val_edge_recon_loss: 28671380.0000; val_gene_expr_recon_loss: 2696078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10323065.0000; val_global_loss: 41740376.0000; val_optim_loss: 41740376.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8773; val_auprc_score: 0.8608; val_best_acc_score: 0.7879; val_best_f1_score: 0.7976; train_kl_reg_loss: 64276.4436; train_edge_recon_loss: 28414282.6667; train_gene_expr_recon_loss: 2607816.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10305589.2222; train_global_loss: 41391964.4444; train_optim_loss: 41391964.4444; val_kl_reg_loss: 72169.3281; val_edge_recon_loss: 28632470.0000; val_gene_expr_recon_loss: 2575825.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10216225.0000; val_global_loss: 41496688.0000; val_optim_loss: 41496688.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8889; val_auprc_score: 0.8641; val_best_acc_score: 0.8044; val_best_f1_score: 0.8144; train_kl_reg_loss: 82186.2674; train_edge_recon_loss: 28421978.0000; train_gene_expr_recon_loss: 2530471.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10232338.8889; train_global_loss: 41266974.2222; train_optim_loss: 41266974.2222; val_kl_reg_loss: 88293.2656; val_edge_recon_loss: 27820734.0000; val_gene_expr_recon_loss: 2538393.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10179705.0000; val_global_loss: 40627128.0000; val_optim_loss: 40627128.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8840; val_auprc_score: 0.8505; val_best_acc_score: 0.8045; val_best_f1_score: 0.8220; train_kl_reg_loss: 96713.5286; train_edge_recon_loss: 28202039.3333; train_gene_expr_recon_loss: 2497966.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10236392.4444; train_global_loss: 41033112.0000; train_optim_loss: 41033112.0000; val_kl_reg_loss: 91663.1250; val_edge_recon_loss: 27858832.0000; val_gene_expr_recon_loss: 2502285.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10132884.0000; val_global_loss: 40585664.0000; val_optim_loss: 40585664.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9014; val_auprc_score: 0.8680; val_best_acc_score: 0.8340; val_best_f1_score: 0.8464; train_kl_reg_loss: 98041.7057; train_edge_recon_loss: 27730595.3333; train_gene_expr_recon_loss: 2467206.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10131222.8889; train_global_loss: 40427066.2222; train_optim_loss: 40427066.2222; val_kl_reg_loss: 98127.4844; val_edge_recon_loss: 27798334.0000; val_gene_expr_recon_loss: 2490836.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10096232.0000; val_global_loss: 40483528.0000; val_optim_loss: 40483528.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9142; val_auprc_score: 0.8828; val_best_acc_score: 0.8552; val_best_f1_score: 0.8640; train_kl_reg_loss: 101774.0252; train_edge_recon_loss: 27637590.2222; train_gene_expr_recon_loss: 2442521.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10026783.6667; train_global_loss: 40208670.2222; train_optim_loss: 40208670.2222; val_kl_reg_loss: 101028.6094; val_edge_recon_loss: 27665022.0000; val_gene_expr_recon_loss: 2505506.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10089802.0000; val_global_loss: 40361360.0000; val_optim_loss: 40361360.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9213; val_auprc_score: 0.8894; val_best_acc_score: 0.8677; val_best_f1_score: 0.8755; train_kl_reg_loss: 106151.4036; train_edge_recon_loss: 27315347.3333; train_gene_expr_recon_loss: 2419690.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10067058.0000; train_global_loss: 39908247.5556; train_optim_loss: 39908247.5556; val_kl_reg_loss: 101938.7266; val_edge_recon_loss: 27359762.0000; val_gene_expr_recon_loss: 2439697.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10040159.0000; val_global_loss: 39941556.0000; val_optim_loss: 39941556.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9222; val_auprc_score: 0.8943; val_best_acc_score: 0.8694; val_best_f1_score: 0.8777; train_kl_reg_loss: 107323.2378; train_edge_recon_loss: 27158996.6667; train_gene_expr_recon_loss: 2399536.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9979795.6667; train_global_loss: 39645651.5556; train_optim_loss: 39645651.5556; val_kl_reg_loss: 106250.2500; val_edge_recon_loss: 27287676.0000; val_gene_expr_recon_loss: 2417034.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10061478.0000; val_global_loss: 39872440.0000; val_optim_loss: 39872440.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9316; val_auprc_score: 0.9066; val_best_acc_score: 0.8783; val_best_f1_score: 0.8847; train_kl_reg_loss: 111173.2431; train_edge_recon_loss: 27276878.2222; train_gene_expr_recon_loss: 2368556.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10005860.0000; train_global_loss: 39762468.0000; train_optim_loss: 39762468.0000; val_kl_reg_loss: 106227.6016; val_edge_recon_loss: 27239806.0000; val_gene_expr_recon_loss: 2383297.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9972987.0000; val_global_loss: 39702320.0000; val_optim_loss: 39702320.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9310; val_auprc_score: 0.9014; val_best_acc_score: 0.8786; val_best_f1_score: 0.8854; train_kl_reg_loss: 108859.1910; train_edge_recon_loss: 27260229.3333; train_gene_expr_recon_loss: 2352723.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10007603.0000; train_global_loss: 39729415.1111; train_optim_loss: 39729415.1111; val_kl_reg_loss: 103165.5391; val_edge_recon_loss: 27200836.0000; val_gene_expr_recon_loss: 2362799.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9950321.0000; val_global_loss: 39617120.0000; val_optim_loss: 39617120.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9348; val_auprc_score: 0.9113; val_best_acc_score: 0.8774; val_best_f1_score: 0.8853; train_kl_reg_loss: 110777.5556; train_edge_recon_loss: 27071210.6667; train_gene_expr_recon_loss: 2327966.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9966328.2222; train_global_loss: 39476282.6667; train_optim_loss: 39476282.6667; val_kl_reg_loss: 110471.8672; val_edge_recon_loss: 27168102.0000; val_gene_expr_recon_loss: 2357322.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9937160.0000; val_global_loss: 39573056.0000; val_optim_loss: 39573056.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9403; val_auprc_score: 0.9182; val_best_acc_score: 0.8863; val_best_f1_score: 0.8930; train_kl_reg_loss: 119073.2700; train_edge_recon_loss: 27049387.1111; train_gene_expr_recon_loss: 2307311.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9917952.3333; train_global_loss: 39393724.4444; train_optim_loss: 39393724.4444; val_kl_reg_loss: 119097.6875; val_edge_recon_loss: 27035728.0000; val_gene_expr_recon_loss: 2324584.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9907342.0000; val_global_loss: 39386752.0000; val_optim_loss: 39386752.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9382; val_auprc_score: 0.9146; val_best_acc_score: 0.8843; val_best_f1_score: 0.8911; train_kl_reg_loss: 128921.7830; train_edge_recon_loss: 27015520.6667; train_gene_expr_recon_loss: 2294460.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9883774.3333; train_global_loss: 39322678.2222; train_optim_loss: 39322678.2222; val_kl_reg_loss: 129045.2500; val_edge_recon_loss: 27053904.0000; val_gene_expr_recon_loss: 2303700.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9883118.0000; val_global_loss: 39369768.0000; val_optim_loss: 39369768.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9400; val_auprc_score: 0.9196; val_best_acc_score: 0.8864; val_best_f1_score: 0.8924; train_kl_reg_loss: 134281.8672; train_edge_recon_loss: 27040442.4444; train_gene_expr_recon_loss: 2280388.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9909633.5556; train_global_loss: 39364746.6667; train_optim_loss: 39364746.6667; val_kl_reg_loss: 130754.0781; val_edge_recon_loss: 27331888.0000; val_gene_expr_recon_loss: 2293516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9861862.0000; val_global_loss: 39618020.0000; val_optim_loss: 39618020.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9399; val_auprc_score: 0.9189; val_best_acc_score: 0.8837; val_best_f1_score: 0.8906; train_kl_reg_loss: 137433.0347; train_edge_recon_loss: 26951180.2222; train_gene_expr_recon_loss: 2270379.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9924480.5556; train_global_loss: 39283472.8889; train_optim_loss: 39283472.8889; val_kl_reg_loss: 132258.1094; val_edge_recon_loss: 27272218.0000; val_gene_expr_recon_loss: 2281707.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9855242.0000; val_global_loss: 39541424.0000; val_optim_loss: 39541424.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9471; val_auprc_score: 0.9271; val_best_acc_score: 0.8906; val_best_f1_score: 0.8967; train_kl_reg_loss: 138795.6545; train_edge_recon_loss: 27017970.0000; train_gene_expr_recon_loss: 2239613.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840297.0000; train_global_loss: 39236675.5556; train_optim_loss: 39236675.5556; val_kl_reg_loss: 131994.1875; val_edge_recon_loss: 27150310.0000; val_gene_expr_recon_loss: 2263742.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9812787.0000; val_global_loss: 39358832.0000; val_optim_loss: 39358832.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9466; val_auprc_score: 0.9290; val_best_acc_score: 0.8936; val_best_f1_score: 0.8988; train_kl_reg_loss: 140879.5347; train_edge_recon_loss: 27027956.6667; train_gene_expr_recon_loss: 2244908.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9860769.2222; train_global_loss: 39274514.2222; train_optim_loss: 39274514.2222; val_kl_reg_loss: 135773.5312; val_edge_recon_loss: 27170652.0000; val_gene_expr_recon_loss: 2257682.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9800279.0000; val_global_loss: 39364388.0000; val_optim_loss: 39364388.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9509; val_auprc_score: 0.9312; val_best_acc_score: 0.8999; val_best_f1_score: 0.9059; train_kl_reg_loss: 140417.6597; train_edge_recon_loss: 26938370.2222; train_gene_expr_recon_loss: 2227696.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9827666.3333; train_global_loss: 39134149.7778; train_optim_loss: 39134149.7778; val_kl_reg_loss: 135626.0312; val_edge_recon_loss: 26690542.0000; val_gene_expr_recon_loss: 2251424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9790890.0000; val_global_loss: 38868480.0000; val_optim_loss: 38868480.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9506; val_auprc_score: 0.9327; val_best_acc_score: 0.8960; val_best_f1_score: 0.9020; train_kl_reg_loss: 141928.9306; train_edge_recon_loss: 26948742.2222; train_gene_expr_recon_loss: 2222632.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9824156.2222; train_global_loss: 39137459.5556; train_optim_loss: 39137459.5556; val_kl_reg_loss: 133489.8594; val_edge_recon_loss: 26956206.0000; val_gene_expr_recon_loss: 2254493.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9780053.0000; val_global_loss: 39124240.0000; val_optim_loss: 39124240.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9498; val_auprc_score: 0.9297; val_best_acc_score: 0.8945; val_best_f1_score: 0.9003; train_kl_reg_loss: 140392.0469; train_edge_recon_loss: 26973631.1111; train_gene_expr_recon_loss: 2218426.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9797972.7778; train_global_loss: 39130423.5556; train_optim_loss: 39130423.5556; val_kl_reg_loss: 131824.5312; val_edge_recon_loss: 27195970.0000; val_gene_expr_recon_loss: 2230020.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9747780.0000; val_global_loss: 39305592.0000; val_optim_loss: 39305592.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9572; val_auprc_score: 0.9400; val_best_acc_score: 0.9070; val_best_f1_score: 0.9111; train_kl_reg_loss: 138022.7535; train_edge_recon_loss: 26844933.3333; train_gene_expr_recon_loss: 2211965.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9795865.7778; train_global_loss: 38990787.1111; train_optim_loss: 38990787.1111; val_kl_reg_loss: 131432.9531; val_edge_recon_loss: 26826110.0000; val_gene_expr_recon_loss: 2238190.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9765697.0000; val_global_loss: 38961428.0000; val_optim_loss: 38961428.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9546; val_auprc_score: 0.9368; val_best_acc_score: 0.9022; val_best_f1_score: 0.9061; train_kl_reg_loss: 136608.5191; train_edge_recon_loss: 26946370.6667; train_gene_expr_recon_loss: 2213122.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9791054.4444; train_global_loss: 39087154.6667; train_optim_loss: 39087154.6667; val_kl_reg_loss: 131139.8906; val_edge_recon_loss: 27127800.0000; val_gene_expr_recon_loss: 2239484.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9749079.0000; val_global_loss: 39247504.0000; val_optim_loss: 39247504.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9576; val_auprc_score: 0.9383; val_best_acc_score: 0.9066; val_best_f1_score: 0.9105; train_kl_reg_loss: 136171.3698; train_edge_recon_loss: 26659017.5556; train_gene_expr_recon_loss: 2205389.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9768292.8889; train_global_loss: 38768871.1111; train_optim_loss: 38768871.1111; val_kl_reg_loss: 130217.5625; val_edge_recon_loss: 26776412.0000; val_gene_expr_recon_loss: 2223733.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9740611.0000; val_global_loss: 38870976.0000; val_optim_loss: 38870976.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9587; val_auprc_score: 0.9445; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 134122.5903; train_edge_recon_loss: 26772541.5556; train_gene_expr_recon_loss: 2192634.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9706880.3333; train_global_loss: 38806178.6667; train_optim_loss: 38806178.6667; val_kl_reg_loss: 129796.7188; val_edge_recon_loss: 26954514.0000; val_gene_expr_recon_loss: 2230071.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9740357.0000; val_global_loss: 39054736.0000; val_optim_loss: 39054736.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9540; val_auprc_score: 0.9352; val_best_acc_score: 0.9050; val_best_f1_score: 0.9088; train_kl_reg_loss: 134019.3385; train_edge_recon_loss: 26784243.7778; train_gene_expr_recon_loss: 2195750.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9696131.2222; train_global_loss: 38810145.3333; train_optim_loss: 38810145.3333; val_kl_reg_loss: 129329.3281; val_edge_recon_loss: 27123604.0000; val_gene_expr_recon_loss: 2227565.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9739110.0000; val_global_loss: 39219608.0000; val_optim_loss: 39219608.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9621; val_auprc_score: 0.9495; val_best_acc_score: 0.9107; val_best_f1_score: 0.9154; train_kl_reg_loss: 134188.7283; train_edge_recon_loss: 26811645.1111; train_gene_expr_recon_loss: 2203342.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9808380.8889; train_global_loss: 38957558.2222; train_optim_loss: 38957558.2222; val_kl_reg_loss: 128101.4141; val_edge_recon_loss: 26765596.0000; val_gene_expr_recon_loss: 2226790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726786.0000; val_global_loss: 38847272.0000; val_optim_loss: 38847272.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9592; val_auprc_score: 0.9450; val_best_acc_score: 0.9062; val_best_f1_score: 0.9107; train_kl_reg_loss: 131771.2431; train_edge_recon_loss: 26595308.0000; train_gene_expr_recon_loss: 2195010.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9708390.6667; train_global_loss: 38630480.8889; train_optim_loss: 38630480.8889; val_kl_reg_loss: 127910.3984; val_edge_recon_loss: 26802904.0000; val_gene_expr_recon_loss: 2228676.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9727906.0000; val_global_loss: 38887396.0000; val_optim_loss: 38887396.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9601; val_auprc_score: 0.9423; val_best_acc_score: 0.9076; val_best_f1_score: 0.9119; train_kl_reg_loss: 132596.0868; train_edge_recon_loss: 26703862.8889; train_gene_expr_recon_loss: 2187786.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737002.8889; train_global_loss: 38761247.5556; train_optim_loss: 38761247.5556; val_kl_reg_loss: 127709.3594; val_edge_recon_loss: 26824760.0000; val_gene_expr_recon_loss: 2225938.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9731649.0000; val_global_loss: 38910056.0000; val_optim_loss: 38910056.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9620; val_auprc_score: 0.9471; val_best_acc_score: 0.9127; val_best_f1_score: 0.9153; train_kl_reg_loss: 131604.8125; train_edge_recon_loss: 26714894.6667; train_gene_expr_recon_loss: 2198048.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9767707.2222; train_global_loss: 38812255.5556; train_optim_loss: 38812255.5556; val_kl_reg_loss: 127242.3750; val_edge_recon_loss: 26810032.0000; val_gene_expr_recon_loss: 2225293.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9725332.0000; val_global_loss: 38887900.0000; val_optim_loss: 38887900.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9636; val_auprc_score: 0.9528; val_best_acc_score: 0.9103; val_best_f1_score: 0.9131; train_kl_reg_loss: 131764.2396; train_edge_recon_loss: 26721159.3333; train_gene_expr_recon_loss: 2198540.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9716267.3333; train_global_loss: 38767731.5556; train_optim_loss: 38767731.5556; val_kl_reg_loss: 126938.6250; val_edge_recon_loss: 26793162.0000; val_gene_expr_recon_loss: 2225589.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9727195.0000; val_global_loss: 38872884.0000; val_optim_loss: 38872884.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9594; val_auprc_score: 0.9447; val_best_acc_score: 0.9054; val_best_f1_score: 0.9103; train_kl_reg_loss: 131405.9905; train_edge_recon_loss: 26578364.6667; train_gene_expr_recon_loss: 2205422.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9773872.8889; train_global_loss: 38689066.2222; train_optim_loss: 38689066.2222; val_kl_reg_loss: 126455.8672; val_edge_recon_loss: 26884952.0000; val_gene_expr_recon_loss: 2225410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9724659.0000; val_global_loss: 38961476.0000; val_optim_loss: 38961476.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9611; val_auprc_score: 0.9469; val_best_acc_score: 0.9072; val_best_f1_score: 0.9113; train_kl_reg_loss: 132132.1233; train_edge_recon_loss: 26695860.2222; train_gene_expr_recon_loss: 2205462.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9797494.8889; train_global_loss: 38830950.2222; train_optim_loss: 38830950.2222; val_kl_reg_loss: 127285.1484; val_edge_recon_loss: 26802012.0000; val_gene_expr_recon_loss: 2226613.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733652.0000; val_global_loss: 38889564.0000; val_optim_loss: 38889564.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9589; val_auprc_score: 0.9454; val_best_acc_score: 0.9065; val_best_f1_score: 0.9104; train_kl_reg_loss: 131025.0773; train_edge_recon_loss: 26649259.7778; train_gene_expr_recon_loss: 2183616.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9713632.6667; train_global_loss: 38677533.7778; train_optim_loss: 38677533.7778; val_kl_reg_loss: 126728.7969; val_edge_recon_loss: 26915664.0000; val_gene_expr_recon_loss: 2224474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9721964.0000; val_global_loss: 38988832.0000; val_optim_loss: 38988832.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9607; val_auprc_score: 0.9454; val_best_acc_score: 0.9130; val_best_f1_score: 0.9168; train_kl_reg_loss: 131747.8516; train_edge_recon_loss: 26558298.6667; train_gene_expr_recon_loss: 2187932.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9714335.6667; train_global_loss: 38592314.6667; train_optim_loss: 38592314.6667; val_kl_reg_loss: 127001.0469; val_edge_recon_loss: 26695346.0000; val_gene_expr_recon_loss: 2224992.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9720880.0000; val_global_loss: 38768220.0000; val_optim_loss: 38768220.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9608; val_auprc_score: 0.9482; val_best_acc_score: 0.9095; val_best_f1_score: 0.9135; train_kl_reg_loss: 131416.0972; train_edge_recon_loss: 26596955.1111; train_gene_expr_recon_loss: 2194583.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9698395.7778; train_global_loss: 38621350.2222; train_optim_loss: 38621350.2222; val_kl_reg_loss: 127237.5938; val_edge_recon_loss: 26849902.0000; val_gene_expr_recon_loss: 2226833.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9741159.0000; val_global_loss: 38945132.0000; val_optim_loss: 38945132.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9601; val_auprc_score: 0.9465; val_best_acc_score: 0.9099; val_best_f1_score: 0.9137; train_kl_reg_loss: 131677.1580; train_edge_recon_loss: 26633578.8889; train_gene_expr_recon_loss: 2195301.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9756500.8889; train_global_loss: 38717058.2222; train_optim_loss: 38717058.2222; val_kl_reg_loss: 127045.0469; val_edge_recon_loss: 26663512.0000; val_gene_expr_recon_loss: 2226958.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9734435.0000; val_global_loss: 38751952.0000; val_optim_loss: 38751952.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9604; val_auprc_score: 0.9455; val_best_acc_score: 0.9065; val_best_f1_score: 0.9095; train_kl_reg_loss: 131028.7951; train_edge_recon_loss: 26645366.8889; train_gene_expr_recon_loss: 2194295.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9705996.5556; train_global_loss: 38676688.0000; train_optim_loss: 38676688.0000; val_kl_reg_loss: 127133.6250; val_edge_recon_loss: 26993432.0000; val_gene_expr_recon_loss: 2225563.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9728195.0000; val_global_loss: 39074324.0000; val_optim_loss: 39074324.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9582; val_auprc_score: 0.9434; val_best_acc_score: 0.9051; val_best_f1_score: 0.9095; train_kl_reg_loss: 131769.9219; train_edge_recon_loss: 26510426.6667; train_gene_expr_recon_loss: 2198628.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9791913.4444; train_global_loss: 38632738.6667; train_optim_loss: 38632738.6667; val_kl_reg_loss: 126713.1562; val_edge_recon_loss: 26852292.0000; val_gene_expr_recon_loss: 2226171.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726004.0000; val_global_loss: 38931184.0000; val_optim_loss: 38931184.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9597; val_auprc_score: 0.9413; val_best_acc_score: 0.9101; val_best_f1_score: 0.9137; train_kl_reg_loss: 131485.8455; train_edge_recon_loss: 26798423.1111; train_gene_expr_recon_loss: 2186277.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9720657.2222; train_global_loss: 38836843.1111; train_optim_loss: 38836843.1111; val_kl_reg_loss: 126680.0000; val_edge_recon_loss: 26667192.0000; val_gene_expr_recon_loss: 2226759.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733061.0000; val_global_loss: 38753692.0000; val_optim_loss: 38753692.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9580; val_auprc_score: 0.9421; val_best_acc_score: 0.9035; val_best_f1_score: 0.9081; train_kl_reg_loss: 131016.2135; train_edge_recon_loss: 26668460.2222; train_gene_expr_recon_loss: 2200306.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759780.4444; train_global_loss: 38759562.6667; train_optim_loss: 38759562.6667; val_kl_reg_loss: 127084.5078; val_edge_recon_loss: 26908052.0000; val_gene_expr_recon_loss: 2226476.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9740167.0000; val_global_loss: 39001780.0000; val_optim_loss: 39001780.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9641; val_auprc_score: 0.9496; val_best_acc_score: 0.9161; val_best_f1_score: 0.9193; train_kl_reg_loss: 131239.6476; train_edge_recon_loss: 26740673.7778; train_gene_expr_recon_loss: 2190728.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9734914.5556; train_global_loss: 38797557.3333; train_optim_loss: 38797557.3333; val_kl_reg_loss: 127149.4219; val_edge_recon_loss: 26406676.0000; val_gene_expr_recon_loss: 2225980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9730707.0000; val_global_loss: 38490512.0000; val_optim_loss: 38490512.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9585; val_auprc_score: 0.9430; val_best_acc_score: 0.9057; val_best_f1_score: 0.9100; train_kl_reg_loss: 131395.9922; train_edge_recon_loss: 26661796.0000; train_gene_expr_recon_loss: 2197483.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750936.8889; train_global_loss: 38741612.4444; train_optim_loss: 38741612.4444; val_kl_reg_loss: 127023.0000; val_edge_recon_loss: 26670066.0000; val_gene_expr_recon_loss: 2227229.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9741554.0000; val_global_loss: 38765872.0000; val_optim_loss: 38765872.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9613; val_auprc_score: 0.9460; val_best_acc_score: 0.9099; val_best_f1_score: 0.9125; train_kl_reg_loss: 131026.3403; train_edge_recon_loss: 26616945.5556; train_gene_expr_recon_loss: 2193890.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9721137.1111; train_global_loss: 38662999.5556; train_optim_loss: 38662999.5556; val_kl_reg_loss: 126345.9453; val_edge_recon_loss: 26704558.0000; val_gene_expr_recon_loss: 2225255.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717879.0000; val_global_loss: 38774040.0000; val_optim_loss: 38774040.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9591; val_auprc_score: 0.9440; val_best_acc_score: 0.9081; val_best_f1_score: 0.9123; train_kl_reg_loss: 130643.7300; train_edge_recon_loss: 26634153.5556; train_gene_expr_recon_loss: 2188187.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9726450.2222; train_global_loss: 38679434.2222; train_optim_loss: 38679434.2222; val_kl_reg_loss: 126891.2344; val_edge_recon_loss: 26983354.0000; val_gene_expr_recon_loss: 2226388.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9724945.0000; val_global_loss: 39061580.0000; val_optim_loss: 39061580.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9567; val_auprc_score: 0.9402; val_best_acc_score: 0.9038; val_best_f1_score: 0.9078; train_kl_reg_loss: 130945.8793; train_edge_recon_loss: 26695399.7778; train_gene_expr_recon_loss: 2194214.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9763790.5556; train_global_loss: 38784351.1111; train_optim_loss: 38784351.1111; val_kl_reg_loss: 127181.8516; val_edge_recon_loss: 26933860.0000; val_gene_expr_recon_loss: 2225360.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9731949.0000; val_global_loss: 39018352.0000; val_optim_loss: 39018352.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9595; val_auprc_score: 0.9423; val_best_acc_score: 0.9077; val_best_f1_score: 0.9112; train_kl_reg_loss: 131716.2101; train_edge_recon_loss: 26629025.5556; train_gene_expr_recon_loss: 2194407.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9751438.0000; train_global_loss: 38706586.2222; train_optim_loss: 38706586.2222; val_kl_reg_loss: 126944.9844; val_edge_recon_loss: 26720198.0000; val_gene_expr_recon_loss: 2224516.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726345.0000; val_global_loss: 38798004.0000; val_optim_loss: 38798004.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9596; val_auprc_score: 0.9425; val_best_acc_score: 0.9085; val_best_f1_score: 0.9124; train_kl_reg_loss: 132025.1198; train_edge_recon_loss: 26679431.7778; train_gene_expr_recon_loss: 2197406.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9733315.1111; train_global_loss: 38742178.2222; train_optim_loss: 38742178.2222; val_kl_reg_loss: 126928.3906; val_edge_recon_loss: 26768022.0000; val_gene_expr_recon_loss: 2225437.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733300.0000; val_global_loss: 38853688.0000; val_optim_loss: 38853688.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9589; val_auprc_score: 0.9414; val_best_acc_score: 0.9061; val_best_f1_score: 0.9103; train_kl_reg_loss: 131557.7752; train_edge_recon_loss: 26728501.1111; train_gene_expr_recon_loss: 2200191.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9779713.1111; train_global_loss: 38839963.1111; train_optim_loss: 38839963.1111; val_kl_reg_loss: 126586.3281; val_edge_recon_loss: 26808540.0000; val_gene_expr_recon_loss: 2224179.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9715612.0000; val_global_loss: 38874920.0000; val_optim_loss: 38874920.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9628; val_auprc_score: 0.9472; val_best_acc_score: 0.9140; val_best_f1_score: 0.9169; train_kl_reg_loss: 130983.3585; train_edge_recon_loss: 26671428.4444; train_gene_expr_recon_loss: 2206222.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9755363.7778; train_global_loss: 38763998.2222; train_optim_loss: 38763998.2222; val_kl_reg_loss: 126820.0156; val_edge_recon_loss: 26570708.0000; val_gene_expr_recon_loss: 2226716.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9729158.0000; val_global_loss: 38653400.0000; val_optim_loss: 38653400.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 13 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9601
Val AUPRC score: 0.9449
Val best accuracy score: 0.9092
Val best F1 score: 0.9130
Val gene expr MSE score: 0.5403
Val chrom access MSE score: 0.0885
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
