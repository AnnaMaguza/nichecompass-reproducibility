[True]
Run timestamp: 07082023_213636_133.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_133']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9275; val_auprc_score: 0.9372; val_best_acc_score: 0.6516; val_best_f1_score: 0.7391; train_kl_reg_loss: 11652.2798; train_edge_recon_loss: 3469905.5278; train_gene_expr_recon_loss: 633812.3403; train_masked_gp_l1_reg_loss: 16555.0277; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 800184.0694; train_global_loss: 4932109.2222; train_optim_loss: 4932109.2222; val_kl_reg_loss: 5484.3643; val_edge_recon_loss: 4057375.2500; val_gene_expr_recon_loss: 603209.1250; val_masked_gp_l1_reg_loss: 11911.4346; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 796619.6250; val_global_loss: 5474599.5000; val_optim_loss: 5474599.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9312; val_auprc_score: 0.9309; val_best_acc_score: 0.7925; val_best_f1_score: 0.8227; train_kl_reg_loss: 5146.9404; train_edge_recon_loss: 3469860.8333; train_gene_expr_recon_loss: 602647.6389; train_masked_gp_l1_reg_loss: 9706.8634; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 789453.0278; train_global_loss: 4876815.3333; train_optim_loss: 4876815.3333; val_kl_reg_loss: 4841.9756; val_edge_recon_loss: 4045591.0000; val_gene_expr_recon_loss: 579156.5000; val_masked_gp_l1_reg_loss: 7847.4873; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 789104.4375; val_global_loss: 5426541.5000; val_optim_loss: 5426541.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9231; val_auprc_score: 0.9161; val_best_acc_score: 0.8309; val_best_f1_score: 0.8223; train_kl_reg_loss: 7440.5578; train_edge_recon_loss: 3472902.8889; train_gene_expr_recon_loss: 569560.2569; train_masked_gp_l1_reg_loss: 7594.8521; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 779034.8750; train_global_loss: 4836533.5000; train_optim_loss: 4836533.5000; val_kl_reg_loss: 10592.4131; val_edge_recon_loss: 3976143.5000; val_gene_expr_recon_loss: 543629.1250; val_masked_gp_l1_reg_loss: 7412.0303; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 779263.6875; val_global_loss: 5317040.5000; val_optim_loss: 5317040.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8880; val_auprc_score: 0.8744; val_best_acc_score: 0.8029; val_best_f1_score: 0.8183; train_kl_reg_loss: 7815.0821; train_edge_recon_loss: 3430926.2222; train_gene_expr_recon_loss: 544929.0833; train_masked_gp_l1_reg_loss: 7199.5592; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 773757.6667; train_global_loss: 4764627.6111; train_optim_loss: 4764627.6111; val_kl_reg_loss: 3671.8032; val_edge_recon_loss: 3274463.7500; val_gene_expr_recon_loss: 546262.3125; val_masked_gp_l1_reg_loss: 7013.2549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 778098.3125; val_global_loss: 4609509.5000; val_optim_loss: 4609509.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8657; val_auprc_score: 0.8470; val_best_acc_score: 0.7765; val_best_f1_score: 0.8016; train_kl_reg_loss: 11923.0594; train_edge_recon_loss: 3031666.0833; train_gene_expr_recon_loss: 555911.5139; train_masked_gp_l1_reg_loss: 6950.3365; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 773230.4514; train_global_loss: 4379681.3333; train_optim_loss: 4379681.3333; val_kl_reg_loss: 31478.9453; val_edge_recon_loss: 2847817.7500; val_gene_expr_recon_loss: 550929.1250; val_masked_gp_l1_reg_loss: 6850.1006; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 777415.6250; val_global_loss: 4214491.5000; val_optim_loss: 4214491.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8942; val_auprc_score: 0.8773; val_best_acc_score: 0.7978; val_best_f1_score: 0.8143; train_kl_reg_loss: 48001.2921; train_edge_recon_loss: 2851896.8333; train_gene_expr_recon_loss: 539890.8889; train_masked_gp_l1_reg_loss: 6816.2534; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 769615.3264; train_global_loss: 4216220.6111; train_optim_loss: 4216220.6111; val_kl_reg_loss: 53883.8906; val_edge_recon_loss: 2823190.0000; val_gene_expr_recon_loss: 519374.5000; val_masked_gp_l1_reg_loss: 6773.5430; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 767641.5625; val_global_loss: 4170863.5000; val_optim_loss: 4170863.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9118; val_auprc_score: 0.8850; val_best_acc_score: 0.8436; val_best_f1_score: 0.8551; train_kl_reg_loss: 43634.6224; train_edge_recon_loss: 2807448.3056; train_gene_expr_recon_loss: 524011.1215; train_masked_gp_l1_reg_loss: 6762.2331; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 767769.8889; train_global_loss: 4149626.1111; train_optim_loss: 4149626.1111; val_kl_reg_loss: 29866.3633; val_edge_recon_loss: 2783311.0000; val_gene_expr_recon_loss: 520054.3438; val_masked_gp_l1_reg_loss: 6726.5234; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 765948.3125; val_global_loss: 4105906.2500; val_optim_loss: 4105906.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9305; val_auprc_score: 0.9117; val_best_acc_score: 0.8666; val_best_f1_score: 0.8715; train_kl_reg_loss: 29649.0482; train_edge_recon_loss: 2763872.0278; train_gene_expr_recon_loss: 527168.0521; train_masked_gp_l1_reg_loss: 6702.5050; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 763075.2361; train_global_loss: 4090466.8889; train_optim_loss: 4090466.8889; val_kl_reg_loss: 34659.5664; val_edge_recon_loss: 2745148.0000; val_gene_expr_recon_loss: 520813.0000; val_masked_gp_l1_reg_loss: 6692.6514; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 765090.8750; val_global_loss: 4072404.0000; val_optim_loss: 4072404.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9335; val_auprc_score: 0.9131; val_best_acc_score: 0.8674; val_best_f1_score: 0.8764; train_kl_reg_loss: 39527.2565; train_edge_recon_loss: 2733253.2500; train_gene_expr_recon_loss: 519488.7917; train_masked_gp_l1_reg_loss: 6689.9640; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 762909.3958; train_global_loss: 4061868.7222; train_optim_loss: 4061868.7222; val_kl_reg_loss: 40943.1094; val_edge_recon_loss: 2724968.5000; val_gene_expr_recon_loss: 508626.2188; val_masked_gp_l1_reg_loss: 6691.6143; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 760040.3125; val_global_loss: 4041269.5000; val_optim_loss: 4041269.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9462; val_auprc_score: 0.9260; val_best_acc_score: 0.8872; val_best_f1_score: 0.8901; train_kl_reg_loss: 40080.3785; train_edge_recon_loss: 2710637.7500; train_gene_expr_recon_loss: 509593.2917; train_masked_gp_l1_reg_loss: 6719.5984; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 754821.5347; train_global_loss: 4021852.4722; train_optim_loss: 4021852.4722; val_kl_reg_loss: 36788.0547; val_edge_recon_loss: 2712756.7500; val_gene_expr_recon_loss: 503355.0312; val_masked_gp_l1_reg_loss: 6755.2144; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 757148.0000; val_global_loss: 4016803.0000; val_optim_loss: 4016803.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9476; val_auprc_score: 0.9263; val_best_acc_score: 0.8934; val_best_f1_score: 0.8968; train_kl_reg_loss: 35232.3819; train_edge_recon_loss: 2705445.1944; train_gene_expr_recon_loss: 504263.2778; train_masked_gp_l1_reg_loss: 6784.8413; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 753035.9236; train_global_loss: 4004761.5833; train_optim_loss: 4004761.5833; val_kl_reg_loss: 33465.1914; val_edge_recon_loss: 2717729.7500; val_gene_expr_recon_loss: 499570.1875; val_masked_gp_l1_reg_loss: 6834.0352; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 755392.2500; val_global_loss: 4012991.5000; val_optim_loss: 4012991.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9520; val_auprc_score: 0.9302; val_best_acc_score: 0.8956; val_best_f1_score: 0.9017; train_kl_reg_loss: 34835.4753; train_edge_recon_loss: 2697487.6944; train_gene_expr_recon_loss: 502758.0694; train_masked_gp_l1_reg_loss: 6871.3146; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 751175.0347; train_global_loss: 3993127.5556; train_optim_loss: 3993127.5556; val_kl_reg_loss: 34745.3750; val_edge_recon_loss: 2704472.2500; val_gene_expr_recon_loss: 493659.9062; val_masked_gp_l1_reg_loss: 6931.0938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753357.8750; val_global_loss: 3993166.5000; val_optim_loss: 3993166.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9561; val_auprc_score: 0.9410; val_best_acc_score: 0.9039; val_best_f1_score: 0.9082; train_kl_reg_loss: 35267.7222; train_edge_recon_loss: 2686949.5833; train_gene_expr_recon_loss: 496042.9549; train_masked_gp_l1_reg_loss: 6995.4928; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 748762.9444; train_global_loss: 3974018.6944; train_optim_loss: 3974018.6944; val_kl_reg_loss: 34806.7031; val_edge_recon_loss: 2683391.5000; val_gene_expr_recon_loss: 490862.1562; val_masked_gp_l1_reg_loss: 7057.0205; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 750372.5625; val_global_loss: 3966490.0000; val_optim_loss: 3966490.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9560; val_auprc_score: 0.9399; val_best_acc_score: 0.9019; val_best_f1_score: 0.9073; train_kl_reg_loss: 36660.9184; train_edge_recon_loss: 2679759.7222; train_gene_expr_recon_loss: 488667.8160; train_masked_gp_l1_reg_loss: 7099.6938; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 746528.7222; train_global_loss: 3958716.9444; train_optim_loss: 3958716.9444; val_kl_reg_loss: 37380.2812; val_edge_recon_loss: 2706301.2500; val_gene_expr_recon_loss: 482047.9062; val_masked_gp_l1_reg_loss: 7151.7754; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747387.9375; val_global_loss: 3980269.2500; val_optim_loss: 3980269.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9616; val_auprc_score: 0.9467; val_best_acc_score: 0.9103; val_best_f1_score: 0.9141; train_kl_reg_loss: 38513.5629; train_edge_recon_loss: 2672151.8056; train_gene_expr_recon_loss: 485764.3438; train_masked_gp_l1_reg_loss: 7191.7593; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 743602.8889; train_global_loss: 3947224.3611; train_optim_loss: 3947224.3611; val_kl_reg_loss: 36734.1719; val_edge_recon_loss: 2679661.2500; val_gene_expr_recon_loss: 478932.5938; val_masked_gp_l1_reg_loss: 7237.8623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744527.0000; val_global_loss: 3947092.7500; val_optim_loss: 3947092.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9637; val_auprc_score: 0.9480; val_best_acc_score: 0.9127; val_best_f1_score: 0.9165; train_kl_reg_loss: 37186.8273; train_edge_recon_loss: 2674976.5833; train_gene_expr_recon_loss: 479936.4653; train_masked_gp_l1_reg_loss: 7275.0655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737686.0972; train_global_loss: 3937061.1389; train_optim_loss: 3937061.1389; val_kl_reg_loss: 36453.4375; val_edge_recon_loss: 2681357.2500; val_gene_expr_recon_loss: 476463.0625; val_masked_gp_l1_reg_loss: 7327.3169; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743167.6875; val_global_loss: 3944768.7500; val_optim_loss: 3944768.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9652; val_auprc_score: 0.9492; val_best_acc_score: 0.9139; val_best_f1_score: 0.9168; train_kl_reg_loss: 37270.4245; train_edge_recon_loss: 2661073.1111; train_gene_expr_recon_loss: 479801.2222; train_masked_gp_l1_reg_loss: 7362.7579; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 736534.0278; train_global_loss: 3922041.5000; train_optim_loss: 3922041.5000; val_kl_reg_loss: 37093.6484; val_edge_recon_loss: 2683433.5000; val_gene_expr_recon_loss: 470346.9375; val_masked_gp_l1_reg_loss: 7418.7246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740157.4375; val_global_loss: 3938450.5000; val_optim_loss: 3938450.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9683; val_auprc_score: 0.9588; val_best_acc_score: 0.9143; val_best_f1_score: 0.9175; train_kl_reg_loss: 37575.2834; train_edge_recon_loss: 2670880.2222; train_gene_expr_recon_loss: 475127.2500; train_masked_gp_l1_reg_loss: 7475.3969; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737675.0208; train_global_loss: 3928733.0833; train_optim_loss: 3928733.0833; val_kl_reg_loss: 35623.5234; val_edge_recon_loss: 2648207.7500; val_gene_expr_recon_loss: 471077.8750; val_masked_gp_l1_reg_loss: 7532.1978; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739532.9375; val_global_loss: 3901974.2500; val_optim_loss: 3901974.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9662; val_auprc_score: 0.9499; val_best_acc_score: 0.9185; val_best_f1_score: 0.9212; train_kl_reg_loss: 36071.0082; train_edge_recon_loss: 2662671.0278; train_gene_expr_recon_loss: 476390.5104; train_masked_gp_l1_reg_loss: 7578.9185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 736257.8681; train_global_loss: 3918969.2500; train_optim_loss: 3918969.2500; val_kl_reg_loss: 35774.7422; val_edge_recon_loss: 2682318.5000; val_gene_expr_recon_loss: 469119.4375; val_masked_gp_l1_reg_loss: 7628.9971; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738310.9375; val_global_loss: 3933152.7500; val_optim_loss: 3933152.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9702; val_auprc_score: 0.9614; val_best_acc_score: 0.9192; val_best_f1_score: 0.9220; train_kl_reg_loss: 36276.1610; train_edge_recon_loss: 2665746.9722; train_gene_expr_recon_loss: 470689.3403; train_masked_gp_l1_reg_loss: 7678.0518; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733423.8056; train_global_loss: 3913814.3056; train_optim_loss: 3913814.3056; val_kl_reg_loss: 34490.9141; val_edge_recon_loss: 2664302.0000; val_gene_expr_recon_loss: 466121.2812; val_masked_gp_l1_reg_loss: 7724.5303; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735911.1250; val_global_loss: 3908550.0000; val_optim_loss: 3908550.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9715; val_auprc_score: 0.9612; val_best_acc_score: 0.9205; val_best_f1_score: 0.9234; train_kl_reg_loss: 35426.7227; train_edge_recon_loss: 2662876.0000; train_gene_expr_recon_loss: 471115.1910; train_masked_gp_l1_reg_loss: 7764.5856; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737072.8611; train_global_loss: 3914255.3889; train_optim_loss: 3914255.3889; val_kl_reg_loss: 34163.6484; val_edge_recon_loss: 2689276.0000; val_gene_expr_recon_loss: 465839.0000; val_masked_gp_l1_reg_loss: 7812.4922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735488.3125; val_global_loss: 3932579.5000; val_optim_loss: 3932579.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9697; val_auprc_score: 0.9548; val_best_acc_score: 0.9237; val_best_f1_score: 0.9266; train_kl_reg_loss: 33905.2105; train_edge_recon_loss: 2667548.2222; train_gene_expr_recon_loss: 467799.7326; train_masked_gp_l1_reg_loss: 7857.0907; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728589.8750; train_global_loss: 3905700.0833; train_optim_loss: 3905700.0833; val_kl_reg_loss: 33402.1680; val_edge_recon_loss: 2675223.7500; val_gene_expr_recon_loss: 468004.8438; val_masked_gp_l1_reg_loss: 7901.6118; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735641.8125; val_global_loss: 3920174.0000; val_optim_loss: 3920174.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9698; val_auprc_score: 0.9552; val_best_acc_score: 0.9236; val_best_f1_score: 0.9269; train_kl_reg_loss: 34196.1645; train_edge_recon_loss: 2648371.3056; train_gene_expr_recon_loss: 468588.4757; train_masked_gp_l1_reg_loss: 7824.2835; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 734285.2083; train_global_loss: 3893265.3611; train_optim_loss: 3893265.3611; val_kl_reg_loss: 33540.0508; val_edge_recon_loss: 2644672.7500; val_gene_expr_recon_loss: 464563.6875; val_masked_gp_l1_reg_loss: 7734.7129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734330.9375; val_global_loss: 3884842.2500; val_optim_loss: 3884842.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9729; val_auprc_score: 0.9597; val_best_acc_score: 0.9275; val_best_f1_score: 0.9297; train_kl_reg_loss: 34394.0204; train_edge_recon_loss: 2651224.5278; train_gene_expr_recon_loss: 466845.6944; train_masked_gp_l1_reg_loss: 7714.7754; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732406.8542; train_global_loss: 3892585.7778; train_optim_loss: 3892585.7778; val_kl_reg_loss: 33829.9297; val_edge_recon_loss: 2660861.2500; val_gene_expr_recon_loss: 466447.3438; val_masked_gp_l1_reg_loss: 7684.2534; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735148.6875; val_global_loss: 3903971.5000; val_optim_loss: 3903971.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9714; val_auprc_score: 0.9573; val_best_acc_score: 0.9254; val_best_f1_score: 0.9287; train_kl_reg_loss: 34650.1398; train_edge_recon_loss: 2653128.0278; train_gene_expr_recon_loss: 463758.5729; train_masked_gp_l1_reg_loss: 7669.4602; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729281.8333; train_global_loss: 3888488.0278; train_optim_loss: 3888488.0278; val_kl_reg_loss: 34128.0234; val_edge_recon_loss: 2684632.7500; val_gene_expr_recon_loss: 464562.4375; val_masked_gp_l1_reg_loss: 7653.2622; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734294.0625; val_global_loss: 3925270.5000; val_optim_loss: 3925270.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9739; val_auprc_score: 0.9652; val_best_acc_score: 0.9281; val_best_f1_score: 0.9307; train_kl_reg_loss: 34364.0260; train_edge_recon_loss: 2695385.5556; train_gene_expr_recon_loss: 496092.0486; train_masked_gp_l1_reg_loss: 7638.1051; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740550.6528; train_global_loss: 3974030.3611; train_optim_loss: 3974030.3611; val_kl_reg_loss: 12223.2734; val_edge_recon_loss: 2657950.0000; val_gene_expr_recon_loss: 514323.1562; val_masked_gp_l1_reg_loss: 7617.0391; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 754067.3125; val_global_loss: 3946180.7500; val_optim_loss: 3946180.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9741; val_auprc_score: 0.9671; val_best_acc_score: 0.9225; val_best_f1_score: 0.9260; train_kl_reg_loss: 33102.5584; train_edge_recon_loss: 2672304.0278; train_gene_expr_recon_loss: 506372.9826; train_masked_gp_l1_reg_loss: 7602.6665; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 746291.7431; train_global_loss: 3965673.9167; train_optim_loss: 3965673.9167; val_kl_reg_loss: 12760.7217; val_edge_recon_loss: 2685892.2500; val_gene_expr_recon_loss: 497291.2500; val_masked_gp_l1_reg_loss: 7588.0962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 749030.0625; val_global_loss: 3952562.2500; val_optim_loss: 3952562.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9723; val_auprc_score: 0.9639; val_best_acc_score: 0.9255; val_best_f1_score: 0.9278; train_kl_reg_loss: 33895.8676; train_edge_recon_loss: 2663023.1667; train_gene_expr_recon_loss: 495285.4618; train_masked_gp_l1_reg_loss: 7578.6456; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 743376.2569; train_global_loss: 3943159.4444; train_optim_loss: 3943159.4444; val_kl_reg_loss: 12952.6680; val_edge_recon_loss: 2674186.7500; val_gene_expr_recon_loss: 496249.3125; val_masked_gp_l1_reg_loss: 7567.9922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748433.2500; val_global_loss: 3939390.0000; val_optim_loss: 3939390.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9757; val_auprc_score: 0.9680; val_best_acc_score: 0.9250; val_best_f1_score: 0.9282; train_kl_reg_loss: 34015.8303; train_edge_recon_loss: 2669328.1667; train_gene_expr_recon_loss: 497714.6250; train_masked_gp_l1_reg_loss: 7565.1685; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 743527.9028; train_global_loss: 3952151.6944; train_optim_loss: 3952151.6944; val_kl_reg_loss: 12921.3242; val_edge_recon_loss: 2675461.0000; val_gene_expr_recon_loss: 495613.3125; val_masked_gp_l1_reg_loss: 7561.0459; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748131.5000; val_global_loss: 3939688.0000; val_optim_loss: 3939688.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9734; val_auprc_score: 0.9613; val_best_acc_score: 0.9244; val_best_f1_score: 0.9277; train_kl_reg_loss: 33711.2656; train_edge_recon_loss: 2663241.4167; train_gene_expr_recon_loss: 494828.4514; train_masked_gp_l1_reg_loss: 7558.5405; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 741540.3542; train_global_loss: 3940880.0000; train_optim_loss: 3940880.0000; val_kl_reg_loss: 12854.2793; val_edge_recon_loss: 2669177.2500; val_gene_expr_recon_loss: 495086.5000; val_masked_gp_l1_reg_loss: 7555.9004; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747756.5000; val_global_loss: 3932430.5000; val_optim_loss: 3932430.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9741; val_auprc_score: 0.9616; val_best_acc_score: 0.9279; val_best_f1_score: 0.9300; train_kl_reg_loss: 33708.0230; train_edge_recon_loss: 2658090.7778; train_gene_expr_recon_loss: 494559.7639; train_masked_gp_l1_reg_loss: 7554.3785; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 742478.7431; train_global_loss: 3936391.6667; train_optim_loss: 3936391.6667; val_kl_reg_loss: 12840.5703; val_edge_recon_loss: 2663064.0000; val_gene_expr_recon_loss: 494902.3125; val_masked_gp_l1_reg_loss: 7552.7583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747651.5625; val_global_loss: 3926011.0000; val_optim_loss: 3926011.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 2 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9716
val AUPRC score: 0.9601
val best accuracy score: 0.9213
val best F1 score: 0.9241
val target rna MSE score: 0.4521
val source rna MSE score: 0.3291
val target atac MSE score: 0.1337
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
