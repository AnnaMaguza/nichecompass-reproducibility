[True]
Run timestamp: 10102023_103913_237.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_237']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7645; val_auprc_score: 0.7797; val_best_acc_score: 0.5022; val_best_f1_score: 0.6675; train_kl_reg_loss: 61340.1055; train_edge_recon_loss: 754985.0906; train_gene_expr_recon_loss: 22511512.6718; train_masked_gp_l1_reg_loss: 64540.9669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4133799.1956; train_chrom_access_recon_loss: 6727367.1527; train_global_loss: 34253544.9160; train_optim_loss: 34253544.9160; val_kl_reg_loss: 63875.1628; val_edge_recon_loss: 813062.4375; val_gene_expr_recon_loss: 21381461.0667; val_masked_gp_l1_reg_loss: 71923.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1094704.1250; val_chrom_access_recon_loss: 6542040.6000; val_global_loss: 29967067.6000; val_optim_loss: 29967067.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7874; val_auprc_score: 0.8076; val_best_acc_score: 0.6361; val_best_f1_score: 0.7200; train_kl_reg_loss: 69342.5150; train_edge_recon_loss: 735966.3965; train_gene_expr_recon_loss: 21088968.7634; train_masked_gp_l1_reg_loss: 71865.8181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 568964.3550; train_chrom_access_recon_loss: 6482893.3282; train_global_loss: 29018001.3588; train_optim_loss: 29018001.3588; val_kl_reg_loss: 66313.5216; val_edge_recon_loss: 811561.8375; val_gene_expr_recon_loss: 20896248.1333; val_masked_gp_l1_reg_loss: 72903.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 314794.3750; val_chrom_access_recon_loss: 6479434.5000; val_global_loss: 28641255.7333; val_optim_loss: 28641255.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8947; val_auprc_score: 0.8948; val_best_acc_score: 0.7863; val_best_f1_score: 0.7885; train_kl_reg_loss: 63004.5663; train_edge_recon_loss: 725759.9914; train_gene_expr_recon_loss: 20702768.4580; train_masked_gp_l1_reg_loss: 73879.8698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239020.2562; train_chrom_access_recon_loss: 6395436.0458; train_global_loss: 28199869.0840; train_optim_loss: 28199869.0840; val_kl_reg_loss: 61301.6130; val_edge_recon_loss: 790771.8583; val_gene_expr_recon_loss: 20566304.6667; val_masked_gp_l1_reg_loss: 75142.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191837.0000; val_chrom_access_recon_loss: 6381166.7667; val_global_loss: 28066523.8667; val_optim_loss: 28066523.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8993; val_auprc_score: 0.8963; val_best_acc_score: 0.8135; val_best_f1_score: 0.8214; train_kl_reg_loss: 60627.4426; train_edge_recon_loss: 688838.3979; train_gene_expr_recon_loss: 20442801.2824; train_masked_gp_l1_reg_loss: 76602.0457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176043.8044; train_chrom_access_recon_loss: 6321825.1221; train_global_loss: 27766738.1985; train_optim_loss: 27766738.1985; val_kl_reg_loss: 70452.9292; val_edge_recon_loss: 648460.1625; val_gene_expr_recon_loss: 20315816.1333; val_masked_gp_l1_reg_loss: 78378.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164683.8750; val_chrom_access_recon_loss: 6289660.7333; val_global_loss: 27567452.0000; val_optim_loss: 27567452.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9070; val_auprc_score: 0.8940; val_best_acc_score: 0.8239; val_best_f1_score: 0.8357; train_kl_reg_loss: 71093.8282; train_edge_recon_loss: 632794.9685; train_gene_expr_recon_loss: 20200969.3435; train_masked_gp_l1_reg_loss: 79798.8220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156223.0849; train_chrom_access_recon_loss: 6256947.2443; train_global_loss: 27397827.2672; train_optim_loss: 27397827.2672; val_kl_reg_loss: 70561.5995; val_edge_recon_loss: 626562.4833; val_gene_expr_recon_loss: 20183771.4667; val_masked_gp_l1_reg_loss: 81045.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146871.4844; val_chrom_access_recon_loss: 6281703.8000; val_global_loss: 27390517.6000; val_optim_loss: 27390517.6000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9174; val_auprc_score: 0.9039; val_best_acc_score: 0.8370; val_best_f1_score: 0.8509; train_kl_reg_loss: 69010.1076; train_edge_recon_loss: 619571.0577; train_gene_expr_recon_loss: 20056723.7405; train_masked_gp_l1_reg_loss: 81987.5547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140194.4550; train_chrom_access_recon_loss: 6222820.9618; train_global_loss: 27190307.6336; train_optim_loss: 27190307.6336; val_kl_reg_loss: 68943.6891; val_edge_recon_loss: 614873.3667; val_gene_expr_recon_loss: 19949802.8000; val_masked_gp_l1_reg_loss: 82940.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133933.4062; val_chrom_access_recon_loss: 6195545.4000; val_global_loss: 27046039.2000; val_optim_loss: 27046039.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9241; val_auprc_score: 0.9120; val_best_acc_score: 0.8463; val_best_f1_score: 0.8547; train_kl_reg_loss: 68015.8541; train_edge_recon_loss: 610865.0377; train_gene_expr_recon_loss: 19911320.1069; train_masked_gp_l1_reg_loss: 83579.2377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128034.4463; train_chrom_access_recon_loss: 6179289.6603; train_global_loss: 26981104.1679; train_optim_loss: 26981104.1679; val_kl_reg_loss: 67021.2432; val_edge_recon_loss: 617583.9083; val_gene_expr_recon_loss: 19828213.2000; val_masked_gp_l1_reg_loss: 84263.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123832.9453; val_chrom_access_recon_loss: 6138592.1667; val_global_loss: 26859506.1333; val_optim_loss: 26859506.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9263; val_auprc_score: 0.9135; val_best_acc_score: 0.8529; val_best_f1_score: 0.8623; train_kl_reg_loss: 67097.7202; train_edge_recon_loss: 604836.4055; train_gene_expr_recon_loss: 19784108.5954; train_masked_gp_l1_reg_loss: 84858.3563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119671.5607; train_chrom_access_recon_loss: 6142028.4198; train_global_loss: 26802601.1298; train_optim_loss: 26802601.1298; val_kl_reg_loss: 66352.0297; val_edge_recon_loss: 607554.2542; val_gene_expr_recon_loss: 19832704.6667; val_masked_gp_l1_reg_loss: 85453.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116939.4375; val_chrom_access_recon_loss: 6179897.7000; val_global_loss: 26888902.5333; val_optim_loss: 26888902.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9387; val_auprc_score: 0.9301; val_best_acc_score: 0.8645; val_best_f1_score: 0.8705; train_kl_reg_loss: 65537.6848; train_edge_recon_loss: 602262.4547; train_gene_expr_recon_loss: 19673889.0534; train_masked_gp_l1_reg_loss: 85851.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114067.6566; train_chrom_access_recon_loss: 6108469.1489; train_global_loss: 26650077.9542; train_optim_loss: 26650077.9542; val_kl_reg_loss: 65735.5112; val_edge_recon_loss: 598862.5417; val_gene_expr_recon_loss: 19687498.4000; val_masked_gp_l1_reg_loss: 86463.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112749.7109; val_chrom_access_recon_loss: 6121777.1000; val_global_loss: 26673087.4667; val_optim_loss: 26673087.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9397; val_auprc_score: 0.9273; val_best_acc_score: 0.8721; val_best_f1_score: 0.8777; train_kl_reg_loss: 64801.3551; train_edge_recon_loss: 596852.9170; train_gene_expr_recon_loss: 19576605.4962; train_masked_gp_l1_reg_loss: 86747.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109780.9350; train_chrom_access_recon_loss: 6072972.8550; train_global_loss: 26507760.9008; train_optim_loss: 26507760.9008; val_kl_reg_loss: 65506.8664; val_edge_recon_loss: 600494.7375; val_gene_expr_recon_loss: 19449721.2000; val_masked_gp_l1_reg_loss: 87094.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109083.9219; val_chrom_access_recon_loss: 6024006.9000; val_global_loss: 26335908.1333; val_optim_loss: 26335908.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9443; val_auprc_score: 0.9337; val_best_acc_score: 0.8742; val_best_f1_score: 0.8792; train_kl_reg_loss: 63687.2077; train_edge_recon_loss: 595216.2343; train_gene_expr_recon_loss: 19485558.7481; train_masked_gp_l1_reg_loss: 87358.7708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106645.9900; train_chrom_access_recon_loss: 6041951.1336; train_global_loss: 26380418.1832; train_optim_loss: 26380418.1832; val_kl_reg_loss: 62870.9732; val_edge_recon_loss: 596725.6917; val_gene_expr_recon_loss: 19543400.2667; val_masked_gp_l1_reg_loss: 87762.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105987.5859; val_chrom_access_recon_loss: 6066770.7333; val_global_loss: 26463517.8667; val_optim_loss: 26463517.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9481; val_auprc_score: 0.9377; val_best_acc_score: 0.8826; val_best_f1_score: 0.8879; train_kl_reg_loss: 62568.8264; train_edge_recon_loss: 593515.5344; train_gene_expr_recon_loss: 19398982.5344; train_masked_gp_l1_reg_loss: 87861.5708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104684.9754; train_chrom_access_recon_loss: 6018846.0992; train_global_loss: 26266459.5878; train_optim_loss: 26266459.5878; val_kl_reg_loss: 61310.5997; val_edge_recon_loss: 595032.2208; val_gene_expr_recon_loss: 19386674.9333; val_masked_gp_l1_reg_loss: 87968.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104614.3516; val_chrom_access_recon_loss: 6019737.5667; val_global_loss: 26255337.8667; val_optim_loss: 26255337.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9540; val_auprc_score: 0.9448; val_best_acc_score: 0.8894; val_best_f1_score: 0.8948; train_kl_reg_loss: 61710.7978; train_edge_recon_loss: 591561.8845; train_gene_expr_recon_loss: 19326277.2672; train_masked_gp_l1_reg_loss: 88377.5899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103985.3890; train_chrom_access_recon_loss: 5993831.9656; train_global_loss: 26165744.7328; train_optim_loss: 26165744.7328; val_kl_reg_loss: 62725.9255; val_edge_recon_loss: 588423.1583; val_gene_expr_recon_loss: 19320213.0667; val_masked_gp_l1_reg_loss: 88427.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103969.0391; val_chrom_access_recon_loss: 6012235.2000; val_global_loss: 26175995.2000; val_optim_loss: 26175995.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9586; val_auprc_score: 0.9497; val_best_acc_score: 0.8961; val_best_f1_score: 0.8991; train_kl_reg_loss: 61665.7674; train_edge_recon_loss: 589082.5468; train_gene_expr_recon_loss: 19274984.5954; train_masked_gp_l1_reg_loss: 88816.0010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104897.5695; train_chrom_access_recon_loss: 5975050.3931; train_global_loss: 26094496.9160; train_optim_loss: 26094496.9160; val_kl_reg_loss: 60838.2289; val_edge_recon_loss: 581231.8708; val_gene_expr_recon_loss: 19225354.2667; val_masked_gp_l1_reg_loss: 88938.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105197.2969; val_chrom_access_recon_loss: 5942218.4333; val_global_loss: 26003779.0667; val_optim_loss: 26003779.0667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9602; val_auprc_score: 0.9526; val_best_acc_score: 0.8991; val_best_f1_score: 0.9032; train_kl_reg_loss: 61365.4611; train_edge_recon_loss: 585458.9962; train_gene_expr_recon_loss: 19208235.0229; train_masked_gp_l1_reg_loss: 89105.8966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105813.3551; train_chrom_access_recon_loss: 5955671.8397; train_global_loss: 26005650.5038; train_optim_loss: 26005650.5038; val_kl_reg_loss: 61964.2378; val_edge_recon_loss: 587381.4708; val_gene_expr_recon_loss: 19243859.4667; val_masked_gp_l1_reg_loss: 89267.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107015.0000; val_chrom_access_recon_loss: 5972706.5000; val_global_loss: 26062194.1333; val_optim_loss: 26062194.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9606; val_auprc_score: 0.9531; val_best_acc_score: 0.8977; val_best_f1_score: 0.9009; train_kl_reg_loss: 61030.8518; train_edge_recon_loss: 585618.1551; train_gene_expr_recon_loss: 19134018.9618; train_masked_gp_l1_reg_loss: 89472.9035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105812.8219; train_chrom_access_recon_loss: 5929600.7290; train_global_loss: 25905554.3969; train_optim_loss: 25905554.3969; val_kl_reg_loss: 60816.8513; val_edge_recon_loss: 587793.3125; val_gene_expr_recon_loss: 19138686.4000; val_masked_gp_l1_reg_loss: 89701.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105408.0391; val_chrom_access_recon_loss: 5926962.2333; val_global_loss: 25909368.5333; val_optim_loss: 25909368.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9621; val_auprc_score: 0.9528; val_best_acc_score: 0.9015; val_best_f1_score: 0.9054; train_kl_reg_loss: 60516.1424; train_edge_recon_loss: 584523.9442; train_gene_expr_recon_loss: 19075430.9008; train_masked_gp_l1_reg_loss: 89919.6215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104689.2153; train_chrom_access_recon_loss: 5903981.9733; train_global_loss: 25819061.8168; train_optim_loss: 25819061.8168; val_kl_reg_loss: 61004.2924; val_edge_recon_loss: 584584.2792; val_gene_expr_recon_loss: 19110276.1333; val_masked_gp_l1_reg_loss: 90412.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104881.9062; val_chrom_access_recon_loss: 5924344.8667; val_global_loss: 25875503.6000; val_optim_loss: 25875503.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9656; val_auprc_score: 0.9586; val_best_acc_score: 0.9073; val_best_f1_score: 0.9115; train_kl_reg_loss: 60208.3022; train_edge_recon_loss: 582129.7963; train_gene_expr_recon_loss: 19025718.3511; train_masked_gp_l1_reg_loss: 90492.6631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103767.3050; train_chrom_access_recon_loss: 5889631.8168; train_global_loss: 25751948.2137; train_optim_loss: 25751948.2137; val_kl_reg_loss: 59871.9740; val_edge_recon_loss: 585340.6583; val_gene_expr_recon_loss: 19070522.2667; val_masked_gp_l1_reg_loss: 90719.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103815.6641; val_chrom_access_recon_loss: 5906632.7333; val_global_loss: 25816903.4667; val_optim_loss: 25816903.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9649; val_auprc_score: 0.9552; val_best_acc_score: 0.9120; val_best_f1_score: 0.9153; train_kl_reg_loss: 59698.4423; train_edge_recon_loss: 581816.5072; train_gene_expr_recon_loss: 18989982.1679; train_masked_gp_l1_reg_loss: 90772.7982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102607.2858; train_chrom_access_recon_loss: 5874076.1718; train_global_loss: 25698953.3588; train_optim_loss: 25698953.3588; val_kl_reg_loss: 60457.1820; val_edge_recon_loss: 583645.8875; val_gene_expr_recon_loss: 19044209.8667; val_masked_gp_l1_reg_loss: 91093.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102437.3281; val_chrom_access_recon_loss: 5908482.5667; val_global_loss: 25790327.3333; val_optim_loss: 25790327.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9661; val_auprc_score: 0.9600; val_best_acc_score: 0.9111; val_best_f1_score: 0.9143; train_kl_reg_loss: 59678.7921; train_edge_recon_loss: 580052.4055; train_gene_expr_recon_loss: 18951401.9542; train_masked_gp_l1_reg_loss: 91345.3770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101845.8683; train_chrom_access_recon_loss: 5858368.6069; train_global_loss: 25642692.9466; train_optim_loss: 25642692.9466; val_kl_reg_loss: 59729.2977; val_edge_recon_loss: 581050.7292; val_gene_expr_recon_loss: 18926662.2667; val_masked_gp_l1_reg_loss: 91470.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101512.1094; val_chrom_access_recon_loss: 5851558.9667; val_global_loss: 25611983.2000; val_optim_loss: 25611983.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9663; val_auprc_score: 0.9578; val_best_acc_score: 0.9115; val_best_f1_score: 0.9146; train_kl_reg_loss: 59099.9376; train_edge_recon_loss: 579234.0177; train_gene_expr_recon_loss: 18913904.9924; train_masked_gp_l1_reg_loss: 91772.3732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101273.0467; train_chrom_access_recon_loss: 5844492.4389; train_global_loss: 25589776.7939; train_optim_loss: 25589776.7939; val_kl_reg_loss: 59031.0500; val_edge_recon_loss: 582084.1667; val_gene_expr_recon_loss: 19025970.1333; val_masked_gp_l1_reg_loss: 92164.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101655.6875; val_chrom_access_recon_loss: 5898870.0333; val_global_loss: 25759775.0667; val_optim_loss: 25759775.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9670; val_auprc_score: 0.9584; val_best_acc_score: 0.9147; val_best_f1_score: 0.9175; train_kl_reg_loss: 58708.7676; train_edge_recon_loss: 579298.8917; train_gene_expr_recon_loss: 18870737.6794; train_masked_gp_l1_reg_loss: 92251.0510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101009.0366; train_chrom_access_recon_loss: 5825461.3359; train_global_loss: 25527466.8550; train_optim_loss: 25527466.8550; val_kl_reg_loss: 59191.7518; val_edge_recon_loss: 583555.7208; val_gene_expr_recon_loss: 18999166.1333; val_masked_gp_l1_reg_loss: 92342.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100400.9062; val_chrom_access_recon_loss: 5863499.7333; val_global_loss: 25698155.3333; val_optim_loss: 25698155.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9696; val_auprc_score: 0.9632; val_best_acc_score: 0.9206; val_best_f1_score: 0.9232; train_kl_reg_loss: 58452.0901; train_edge_recon_loss: 577467.4905; train_gene_expr_recon_loss: 18837845.6947; train_masked_gp_l1_reg_loss: 92633.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100364.4217; train_chrom_access_recon_loss: 5816398.3435; train_global_loss: 25483161.4198; train_optim_loss: 25483161.4198; val_kl_reg_loss: 58748.6383; val_edge_recon_loss: 581447.4083; val_gene_expr_recon_loss: 18836562.4000; val_masked_gp_l1_reg_loss: 92943.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100176.9141; val_chrom_access_recon_loss: 5844768.1000; val_global_loss: 25514646.5333; val_optim_loss: 25514646.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9693; val_auprc_score: 0.9621; val_best_acc_score: 0.9157; val_best_f1_score: 0.9185; train_kl_reg_loss: 58341.5280; train_edge_recon_loss: 577988.4122; train_gene_expr_recon_loss: 18783060.4580; train_masked_gp_l1_reg_loss: 93189.5508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100478.4541; train_chrom_access_recon_loss: 5792870.8511; train_global_loss: 25405929.2061; train_optim_loss: 25405929.2061; val_kl_reg_loss: 59026.2755; val_edge_recon_loss: 581415.4625; val_gene_expr_recon_loss: 18809383.8667; val_masked_gp_l1_reg_loss: 93259.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100679.1953; val_chrom_access_recon_loss: 5819731.5333; val_global_loss: 25463496.9333; val_optim_loss: 25463496.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9706; val_auprc_score: 0.9642; val_best_acc_score: 0.9197; val_best_f1_score: 0.9222; train_kl_reg_loss: 58238.1755; train_edge_recon_loss: 577157.8554; train_gene_expr_recon_loss: 18755507.8321; train_masked_gp_l1_reg_loss: 93494.1456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100507.6291; train_chrom_access_recon_loss: 5777463.1031; train_global_loss: 25362368.8092; train_optim_loss: 25362368.8092; val_kl_reg_loss: 58738.3104; val_edge_recon_loss: 579626.0125; val_gene_expr_recon_loss: 18861258.5333; val_masked_gp_l1_reg_loss: 93623.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100696.0859; val_chrom_access_recon_loss: 5813483.6333; val_global_loss: 25507426.8000; val_optim_loss: 25507426.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9708; val_auprc_score: 0.9651; val_best_acc_score: 0.9204; val_best_f1_score: 0.9235; train_kl_reg_loss: 57923.8814; train_edge_recon_loss: 576178.4800; train_gene_expr_recon_loss: 18741576.7176; train_masked_gp_l1_reg_loss: 93852.5078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100471.5045; train_chrom_access_recon_loss: 5778887.7099; train_global_loss: 25348890.7176; train_optim_loss: 25348890.7176; val_kl_reg_loss: 57425.0695; val_edge_recon_loss: 580331.6333; val_gene_expr_recon_loss: 18851589.4667; val_masked_gp_l1_reg_loss: 94159.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101541.5938; val_chrom_access_recon_loss: 5817743.3667; val_global_loss: 25502791.4667; val_optim_loss: 25502791.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9680; val_auprc_score: 0.9597; val_best_acc_score: 0.9185; val_best_f1_score: 0.9212; train_kl_reg_loss: 57997.3520; train_edge_recon_loss: 575911.0945; train_gene_expr_recon_loss: 18700426.5954; train_masked_gp_l1_reg_loss: 94330.6985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100971.5855; train_chrom_access_recon_loss: 5763690.7290; train_global_loss: 25293328.0611; train_optim_loss: 25293328.0611; val_kl_reg_loss: 57620.5164; val_edge_recon_loss: 581245.5792; val_gene_expr_recon_loss: 18747192.8000; val_masked_gp_l1_reg_loss: 94418.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101632.8750; val_chrom_access_recon_loss: 5794045.7000; val_global_loss: 25376154.2667; val_optim_loss: 25376154.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9744; val_auprc_score: 0.9701; val_best_acc_score: 0.9216; val_best_f1_score: 0.9233; train_kl_reg_loss: 57755.0988; train_edge_recon_loss: 576128.1193; train_gene_expr_recon_loss: 18646755.5573; train_masked_gp_l1_reg_loss: 94740.2943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101210.4820; train_chrom_access_recon_loss: 5741585.0802; train_global_loss: 25218174.5038; train_optim_loss: 25218174.5038; val_kl_reg_loss: 57972.4781; val_edge_recon_loss: 581221.1292; val_gene_expr_recon_loss: 18703326.0000; val_masked_gp_l1_reg_loss: 94996.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101325.3203; val_chrom_access_recon_loss: 5778750.4667; val_global_loss: 25317592.2667; val_optim_loss: 25317592.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9729; val_auprc_score: 0.9674; val_best_acc_score: 0.9228; val_best_f1_score: 0.9246; train_kl_reg_loss: 57656.7105; train_edge_recon_loss: 576525.8578; train_gene_expr_recon_loss: 18647691.1756; train_masked_gp_l1_reg_loss: 95071.4750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101377.8363; train_chrom_access_recon_loss: 5743271.2405; train_global_loss: 25221594.4122; train_optim_loss: 25221594.4122; val_kl_reg_loss: 57926.3068; val_edge_recon_loss: 581729.2500; val_gene_expr_recon_loss: 18714938.2667; val_masked_gp_l1_reg_loss: 95414.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102423.9766; val_chrom_access_recon_loss: 5775707.6000; val_global_loss: 25328139.6000; val_optim_loss: 25328139.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9691; val_auprc_score: 0.9592; val_best_acc_score: 0.9174; val_best_f1_score: 0.9203; train_kl_reg_loss: 57652.8329; train_edge_recon_loss: 576117.8158; train_gene_expr_recon_loss: 18594680.3053; train_masked_gp_l1_reg_loss: 95470.7399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101699.1574; train_chrom_access_recon_loss: 5722272.5916; train_global_loss: 25147893.3588; train_optim_loss: 25147893.3588; val_kl_reg_loss: 58020.9719; val_edge_recon_loss: 582236.8250; val_gene_expr_recon_loss: 18690467.6000; val_masked_gp_l1_reg_loss: 95599.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101698.1016; val_chrom_access_recon_loss: 5800841.3333; val_global_loss: 25328865.0667; val_optim_loss: 25328865.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9719; val_auprc_score: 0.9643; val_best_acc_score: 0.9220; val_best_f1_score: 0.9233; train_kl_reg_loss: 57734.8745; train_edge_recon_loss: 575945.6636; train_gene_expr_recon_loss: 18568629.3435; train_masked_gp_l1_reg_loss: 95781.4326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101831.6728; train_chrom_access_recon_loss: 5715935.8511; train_global_loss: 25115858.9160; train_optim_loss: 25115858.9160; val_kl_reg_loss: 58159.9365; val_edge_recon_loss: 580884.5417; val_gene_expr_recon_loss: 18677021.3333; val_masked_gp_l1_reg_loss: 95898.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102369.5938; val_chrom_access_recon_loss: 5760883.7000; val_global_loss: 25275217.8667; val_optim_loss: 25275217.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9709; val_auprc_score: 0.9651; val_best_acc_score: 0.9165; val_best_f1_score: 0.9193; train_kl_reg_loss: 57334.1116; train_edge_recon_loss: 576706.1159; train_gene_expr_recon_loss: 18552237.5267; train_masked_gp_l1_reg_loss: 96072.3763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102230.9846; train_chrom_access_recon_loss: 5711876.3359; train_global_loss: 25096457.4198; train_optim_loss: 25096457.4198; val_kl_reg_loss: 57658.1937; val_edge_recon_loss: 583563.0542; val_gene_expr_recon_loss: 18664423.2000; val_masked_gp_l1_reg_loss: 96211.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103166.0078; val_chrom_access_recon_loss: 5760753.6667; val_global_loss: 25265775.8667; val_optim_loss: 25265775.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9728; val_auprc_score: 0.9673; val_best_acc_score: 0.9201; val_best_f1_score: 0.9225; train_kl_reg_loss: 57644.1772; train_edge_recon_loss: 576479.1760; train_gene_expr_recon_loss: 18506995.5267; train_masked_gp_l1_reg_loss: 96315.4885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102626.3329; train_chrom_access_recon_loss: 5697959.7863; train_global_loss: 25038020.4427; train_optim_loss: 25038020.4427; val_kl_reg_loss: 58573.9089; val_edge_recon_loss: 580941.1917; val_gene_expr_recon_loss: 18618457.2000; val_masked_gp_l1_reg_loss: 96397.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102555.9219; val_chrom_access_recon_loss: 5727933.8000; val_global_loss: 25184860.2667; val_optim_loss: 25184860.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9730; val_auprc_score: 0.9636; val_best_acc_score: 0.9236; val_best_f1_score: 0.9268; train_kl_reg_loss: 57527.2006; train_edge_recon_loss: 578036.2548; train_gene_expr_recon_loss: 18488807.6489; train_masked_gp_l1_reg_loss: 96633.2105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102909.2938; train_chrom_access_recon_loss: 5698438.9885; train_global_loss: 25022352.5191; train_optim_loss: 25022352.5191; val_kl_reg_loss: 57201.2135; val_edge_recon_loss: 580910.3292; val_gene_expr_recon_loss: 18659978.0000; val_masked_gp_l1_reg_loss: 96757.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103218.7188; val_chrom_access_recon_loss: 5752613.6000; val_global_loss: 25250678.8000; val_optim_loss: 25250678.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9748; val_auprc_score: 0.9690; val_best_acc_score: 0.9247; val_best_f1_score: 0.9261; train_kl_reg_loss: 57678.0024; train_edge_recon_loss: 576833.0740; train_gene_expr_recon_loss: 18468318.6336; train_masked_gp_l1_reg_loss: 96928.5803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102989.8939; train_chrom_access_recon_loss: 5683747.5878; train_global_loss: 24986495.6947; train_optim_loss: 24986495.6947; val_kl_reg_loss: 57685.0164; val_edge_recon_loss: 578048.8208; val_gene_expr_recon_loss: 18581225.8667; val_masked_gp_l1_reg_loss: 97007.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103438.0078; val_chrom_access_recon_loss: 5738257.6000; val_global_loss: 25155663.3333; val_optim_loss: 25155663.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9717; val_auprc_score: 0.9660; val_best_acc_score: 0.9219; val_best_f1_score: 0.9237; train_kl_reg_loss: 57765.2163; train_edge_recon_loss: 575790.1574; train_gene_expr_recon_loss: 18439217.1603; train_masked_gp_l1_reg_loss: 97209.7637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103358.1493; train_chrom_access_recon_loss: 5672032.6641; train_global_loss: 24945373.1450; train_optim_loss: 24945373.1450; val_kl_reg_loss: 58231.6924; val_edge_recon_loss: 580966.4333; val_gene_expr_recon_loss: 18539616.2667; val_masked_gp_l1_reg_loss: 97256.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104208.1719; val_chrom_access_recon_loss: 5724008.3333; val_global_loss: 25104286.8000; val_optim_loss: 25104286.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9710; val_auprc_score: 0.9618; val_best_acc_score: 0.9220; val_best_f1_score: 0.9245; train_kl_reg_loss: 58075.9051; train_edge_recon_loss: 575696.8139; train_gene_expr_recon_loss: 18403095.2672; train_masked_gp_l1_reg_loss: 97488.3094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103918.2735; train_chrom_access_recon_loss: 5663378.8511; train_global_loss: 24901653.4656; train_optim_loss: 24901653.4656; val_kl_reg_loss: 58152.9078; val_edge_recon_loss: 581407.8875; val_gene_expr_recon_loss: 18541525.7333; val_masked_gp_l1_reg_loss: 97574.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104360.3516; val_chrom_access_recon_loss: 5747841.8333; val_global_loss: 25130862.5333; val_optim_loss: 25130862.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9744; val_auprc_score: 0.9688; val_best_acc_score: 0.9224; val_best_f1_score: 0.9251; train_kl_reg_loss: 58312.3012; train_edge_recon_loss: 575540.0854; train_gene_expr_recon_loss: 18405567.2519; train_masked_gp_l1_reg_loss: 97638.3408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104176.0184; train_chrom_access_recon_loss: 5669792.2176; train_global_loss: 24911026.1832; train_optim_loss: 24911026.1832; val_kl_reg_loss: 57156.6719; val_edge_recon_loss: 575934.3375; val_gene_expr_recon_loss: 18499474.8667; val_masked_gp_l1_reg_loss: 97524.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105043.8516; val_chrom_access_recon_loss: 5705808.7667; val_global_loss: 25040942.9333; val_optim_loss: 25040942.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9742; val_auprc_score: 0.9678; val_best_acc_score: 0.9232; val_best_f1_score: 0.9261; train_kl_reg_loss: 58445.8802; train_edge_recon_loss: 576073.9618; train_gene_expr_recon_loss: 18367275.9847; train_masked_gp_l1_reg_loss: 97600.4216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104634.1745; train_chrom_access_recon_loss: 5653629.8893; train_global_loss: 24857660.3511; train_optim_loss: 24857660.3511; val_kl_reg_loss: 58868.8167; val_edge_recon_loss: 581244.8792; val_gene_expr_recon_loss: 18549866.9333; val_masked_gp_l1_reg_loss: 97665.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105712.5859; val_chrom_access_recon_loss: 5754336.2333; val_global_loss: 25147694.9333; val_optim_loss: 25147694.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9732; val_auprc_score: 0.9643; val_best_acc_score: 0.9221; val_best_f1_score: 0.9245; train_kl_reg_loss: 58555.0264; train_edge_recon_loss: 576579.9986; train_gene_expr_recon_loss: 18362518.8092; train_masked_gp_l1_reg_loss: 97784.6566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105309.0605; train_chrom_access_recon_loss: 5652280.7786; train_global_loss: 24853028.2137; train_optim_loss: 24853028.2137; val_kl_reg_loss: 58863.4201; val_edge_recon_loss: 578117.1375; val_gene_expr_recon_loss: 18538731.8667; val_masked_gp_l1_reg_loss: 97745.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106250.5156; val_chrom_access_recon_loss: 5746754.4667; val_global_loss: 25126462.8000; val_optim_loss: 25126462.8000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9738; val_auprc_score: 0.9676; val_best_acc_score: 0.9223; val_best_f1_score: 0.9251; train_kl_reg_loss: 58880.8590; train_edge_recon_loss: 576354.4785; train_gene_expr_recon_loss: 18355858.8397; train_masked_gp_l1_reg_loss: 97919.7478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105760.9429; train_chrom_access_recon_loss: 5651628.1336; train_global_loss: 24846402.9008; train_optim_loss: 24846402.9008; val_kl_reg_loss: 59098.9669; val_edge_recon_loss: 578369.9750; val_gene_expr_recon_loss: 18507940.5333; val_masked_gp_l1_reg_loss: 98161.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105853.8516; val_chrom_access_recon_loss: 5724668.3000; val_global_loss: 25074093.7333; val_optim_loss: 25074093.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9757; val_auprc_score: 0.9705; val_best_acc_score: 0.9262; val_best_f1_score: 0.9278; train_kl_reg_loss: 58835.1065; train_edge_recon_loss: 576103.7700; train_gene_expr_recon_loss: 18313586.6183; train_masked_gp_l1_reg_loss: 97884.3384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106089.0068; train_chrom_access_recon_loss: 5638112.8702; train_global_loss: 24790611.6336; train_optim_loss: 24790611.6336; val_kl_reg_loss: 59171.3797; val_edge_recon_loss: 578588.1375; val_gene_expr_recon_loss: 18508555.6000; val_masked_gp_l1_reg_loss: 97841.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106849.9922; val_chrom_access_recon_loss: 5702745.2667; val_global_loss: 25053752.1333; val_optim_loss: 25053752.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9739; val_auprc_score: 0.9669; val_best_acc_score: 0.9256; val_best_f1_score: 0.9287; train_kl_reg_loss: 59697.0784; train_edge_recon_loss: 575038.8845; train_gene_expr_recon_loss: 18263798.1679; train_masked_gp_l1_reg_loss: 96310.8471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77848.6456; train_chrom_access_recon_loss: 5622072.9427; train_global_loss: 24694766.5191; train_optim_loss: 24694766.5191; val_kl_reg_loss: 60362.3107; val_edge_recon_loss: 578347.0792; val_gene_expr_recon_loss: 18541098.0000; val_masked_gp_l1_reg_loss: 95796.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73380.9531; val_chrom_access_recon_loss: 5734627.3667; val_global_loss: 25083610.6667; val_optim_loss: 25083610.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9742; val_auprc_score: 0.9690; val_best_acc_score: 0.9240; val_best_f1_score: 0.9257; train_kl_reg_loss: 60237.1677; train_edge_recon_loss: 575216.4556; train_gene_expr_recon_loss: 18241620.4427; train_masked_gp_l1_reg_loss: 95682.6656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72515.0734; train_chrom_access_recon_loss: 5613726.8015; train_global_loss: 24658998.8855; train_optim_loss: 24658998.8855; val_kl_reg_loss: 60347.6102; val_edge_recon_loss: 577150.2750; val_gene_expr_recon_loss: 18431109.7333; val_masked_gp_l1_reg_loss: 95641.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71946.5938; val_chrom_access_recon_loss: 5674055.0000; val_global_loss: 24910250.4000; val_optim_loss: 24910250.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9740; val_auprc_score: 0.9679; val_best_acc_score: 0.9243; val_best_f1_score: 0.9268; train_kl_reg_loss: 60653.9573; train_edge_recon_loss: 573490.0887; train_gene_expr_recon_loss: 18241924.3359; train_masked_gp_l1_reg_loss: 95596.9816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71495.8314; train_chrom_access_recon_loss: 5608511.1374; train_global_loss: 24651672.5038; train_optim_loss: 24651672.5038; val_kl_reg_loss: 61165.0026; val_edge_recon_loss: 577347.0500; val_gene_expr_recon_loss: 18433925.4667; val_masked_gp_l1_reg_loss: 95587.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71010.9297; val_chrom_access_recon_loss: 5684284.9000; val_global_loss: 24923320.8000; val_optim_loss: 24923320.8000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9721; val_auprc_score: 0.9662; val_best_acc_score: 0.9188; val_best_f1_score: 0.9218; train_kl_reg_loss: 60905.2090; train_edge_recon_loss: 575410.5825; train_gene_expr_recon_loss: 18258879.6947; train_masked_gp_l1_reg_loss: 95559.5609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70631.0840; train_chrom_access_recon_loss: 5621761.2672; train_global_loss: 24683147.4351; train_optim_loss: 24683147.4351; val_kl_reg_loss: 60977.9740; val_edge_recon_loss: 577724.3750; val_gene_expr_recon_loss: 18508230.5333; val_masked_gp_l1_reg_loss: 95564.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70398.5391; val_chrom_access_recon_loss: 5702501.7333; val_global_loss: 25015396.2667; val_optim_loss: 25015396.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9754; val_auprc_score: 0.9672; val_best_acc_score: 0.9285; val_best_f1_score: 0.9307; train_kl_reg_loss: 61004.9946; train_edge_recon_loss: 573587.5143; train_gene_expr_recon_loss: 18226723.0992; train_masked_gp_l1_reg_loss: 95551.1984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70073.4422; train_chrom_access_recon_loss: 5609455.4313; train_global_loss: 24636395.6947; train_optim_loss: 24636395.6947; val_kl_reg_loss: 61151.5982; val_edge_recon_loss: 576728.1458; val_gene_expr_recon_loss: 18475880.8000; val_masked_gp_l1_reg_loss: 95534.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69993.4062; val_chrom_access_recon_loss: 5710167.8000; val_global_loss: 24989456.1333; val_optim_loss: 24989456.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9748; val_auprc_score: 0.9699; val_best_acc_score: 0.9225; val_best_f1_score: 0.9254; train_kl_reg_loss: 61228.0081; train_edge_recon_loss: 574679.2657; train_gene_expr_recon_loss: 18231978.9695; train_masked_gp_l1_reg_loss: 95512.8458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69661.6053; train_chrom_access_recon_loss: 5610005.1947; train_global_loss: 24643065.9542; train_optim_loss: 24643065.9542; val_kl_reg_loss: 61243.0586; val_edge_recon_loss: 579120.1250; val_gene_expr_recon_loss: 18477251.3333; val_masked_gp_l1_reg_loss: 95507.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69313.0000; val_chrom_access_recon_loss: 5704963.5000; val_global_loss: 24987399.4667; val_optim_loss: 24987399.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9731; val_auprc_score: 0.9656; val_best_acc_score: 0.9216; val_best_f1_score: 0.9234; train_kl_reg_loss: 61274.7468; train_edge_recon_loss: 574108.1255; train_gene_expr_recon_loss: 18230003.7634; train_masked_gp_l1_reg_loss: 95345.4216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66469.4728; train_chrom_access_recon_loss: 5608009.7672; train_global_loss: 24635211.1298; train_optim_loss: 24635211.1298; val_kl_reg_loss: 61401.6586; val_edge_recon_loss: 580427.7125; val_gene_expr_recon_loss: 18381656.5333; val_masked_gp_l1_reg_loss: 95273.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66050.2812; val_chrom_access_recon_loss: 5696019.3333; val_global_loss: 24880829.2000; val_optim_loss: 24880829.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9742; val_auprc_score: 0.9669; val_best_acc_score: 0.9212; val_best_f1_score: 0.9240; train_kl_reg_loss: 61161.2791; train_edge_recon_loss: 574584.2934; train_gene_expr_recon_loss: 18223265.6489; train_masked_gp_l1_reg_loss: 95256.3906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65958.2037; train_chrom_access_recon_loss: 5607308.3321; train_global_loss: 24627534.0458; train_optim_loss: 24627534.0458; val_kl_reg_loss: 61301.2919; val_edge_recon_loss: 577567.9042; val_gene_expr_recon_loss: 18425559.7333; val_masked_gp_l1_reg_loss: 95241.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65879.7812; val_chrom_access_recon_loss: 5674480.4000; val_global_loss: 24900031.0667; val_optim_loss: 24900031.0667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9740; val_auprc_score: 0.9678; val_best_acc_score: 0.9237; val_best_f1_score: 0.9263; train_kl_reg_loss: 61347.2093; train_edge_recon_loss: 574518.8931; train_gene_expr_recon_loss: 18232397.0076; train_masked_gp_l1_reg_loss: 95234.7475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65809.8663; train_chrom_access_recon_loss: 5606385.1756; train_global_loss: 24635692.9160; train_optim_loss: 24635692.9160; val_kl_reg_loss: 61639.4229; val_edge_recon_loss: 577857.9583; val_gene_expr_recon_loss: 18389088.2667; val_masked_gp_l1_reg_loss: 95227.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65744.1562; val_chrom_access_recon_loss: 5686558.6000; val_global_loss: 24876116.2667; val_optim_loss: 24876116.2667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9748; val_auprc_score: 0.9687; val_best_acc_score: 0.9243; val_best_f1_score: 0.9268; train_kl_reg_loss: 61251.0609; train_edge_recon_loss: 573205.0487; train_gene_expr_recon_loss: 18234229.9695; train_masked_gp_l1_reg_loss: 95222.3893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65682.1560; train_chrom_access_recon_loss: 5607257.3282; train_global_loss: 24636848.0458; train_optim_loss: 24636848.0458; val_kl_reg_loss: 61546.9406; val_edge_recon_loss: 577601.7792; val_gene_expr_recon_loss: 18436567.2000; val_masked_gp_l1_reg_loss: 95217.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65642.0625; val_chrom_access_recon_loss: 5693356.2000; val_global_loss: 24929932.0000; val_optim_loss: 24929932.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9770; val_auprc_score: 0.9712; val_best_acc_score: 0.9276; val_best_f1_score: 0.9300; train_kl_reg_loss: 61270.8421; train_edge_recon_loss: 573583.1498; train_gene_expr_recon_loss: 18226292.6718; train_masked_gp_l1_reg_loss: 95215.2736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65589.6840; train_chrom_access_recon_loss: 5606590.7672; train_global_loss: 24628542.2137; train_optim_loss: 24628542.2137; val_kl_reg_loss: 61465.5307; val_edge_recon_loss: 574612.2375; val_gene_expr_recon_loss: 18446543.8667; val_masked_gp_l1_reg_loss: 95212.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65559.9141; val_chrom_access_recon_loss: 5705511.0333; val_global_loss: 24948904.6667; val_optim_loss: 24948904.6667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9747; val_auprc_score: 0.9675; val_best_acc_score: 0.9305; val_best_f1_score: 0.9318; train_kl_reg_loss: 61359.3287; train_edge_recon_loss: 573896.9905; train_gene_expr_recon_loss: 18236813.0229; train_masked_gp_l1_reg_loss: 95210.6804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65517.1090; train_chrom_access_recon_loss: 5610568.1679; train_global_loss: 24643365.2366; train_optim_loss: 24643365.2366; val_kl_reg_loss: 61497.6602; val_edge_recon_loss: 578422.0250; val_gene_expr_recon_loss: 18467821.7333; val_masked_gp_l1_reg_loss: 95208.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65474.4570; val_chrom_access_recon_loss: 5706097.6000; val_global_loss: 24974520.6667; val_optim_loss: 24974520.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9735; val_auprc_score: 0.9668; val_best_acc_score: 0.9223; val_best_f1_score: 0.9242; train_kl_reg_loss: 61413.3254; train_edge_recon_loss: 573674.0902; train_gene_expr_recon_loss: 18232575.5115; train_masked_gp_l1_reg_loss: 95205.7990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65433.1850; train_chrom_access_recon_loss: 5611625.9237; train_global_loss: 24639927.8321; train_optim_loss: 24639927.8321; val_kl_reg_loss: 61529.0117; val_edge_recon_loss: 581051.1875; val_gene_expr_recon_loss: 18460424.6667; val_masked_gp_l1_reg_loss: 95204.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65395.5391; val_chrom_access_recon_loss: 5700078.0000; val_global_loss: 24963682.9333; val_optim_loss: 24963682.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9730; val_auprc_score: 0.9660; val_best_acc_score: 0.9223; val_best_f1_score: 0.9248; train_kl_reg_loss: 61389.0093; train_edge_recon_loss: 574129.5988; train_gene_expr_recon_loss: 18232901.3511; train_masked_gp_l1_reg_loss: 95188.2329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65115.7795; train_chrom_access_recon_loss: 5613220.0000; train_global_loss: 24641943.8015; train_optim_loss: 24641943.8015; val_kl_reg_loss: 61541.2643; val_edge_recon_loss: 577668.3375; val_gene_expr_recon_loss: 18479207.7333; val_masked_gp_l1_reg_loss: 95181.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65075.1172; val_chrom_access_recon_loss: 5757153.8000; val_global_loss: 25035829.2000; val_optim_loss: 25035829.2000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9737; val_auprc_score: 0.9673; val_best_acc_score: 0.9255; val_best_f1_score: 0.9281; train_kl_reg_loss: 61320.7567; train_edge_recon_loss: 574551.0682; train_gene_expr_recon_loss: 18234275.1908; train_masked_gp_l1_reg_loss: 95178.6869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65064.6067; train_chrom_access_recon_loss: 5606424.7634; train_global_loss: 24636814.9160; train_optim_loss: 24636814.9160; val_kl_reg_loss: 61374.3833; val_edge_recon_loss: 575723.9292; val_gene_expr_recon_loss: 18413274.6667; val_masked_gp_l1_reg_loss: 95176.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65056.7539; val_chrom_access_recon_loss: 5685595.4667; val_global_loss: 24896200.2667; val_optim_loss: 24896200.2667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9752; val_auprc_score: 0.9703; val_best_acc_score: 0.9236; val_best_f1_score: 0.9255; train_kl_reg_loss: 61383.1802; train_edge_recon_loss: 574338.1126; train_gene_expr_recon_loss: 18234886.3206; train_masked_gp_l1_reg_loss: 95175.5027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65049.8026; train_chrom_access_recon_loss: 5605844.4275; train_global_loss: 24636677.2824; train_optim_loss: 24636677.2824; val_kl_reg_loss: 61413.7396; val_edge_recon_loss: 577841.4083; val_gene_expr_recon_loss: 18489959.7333; val_masked_gp_l1_reg_loss: 95174.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65043.5703; val_chrom_access_recon_loss: 5699816.6333; val_global_loss: 24989249.7333; val_optim_loss: 24989249.7333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9732; val_auprc_score: 0.9666; val_best_acc_score: 0.9204; val_best_f1_score: 0.9232; train_kl_reg_loss: 61365.4901; train_edge_recon_loss: 573124.8497; train_gene_expr_recon_loss: 18234358.5878; train_masked_gp_l1_reg_loss: 95174.1564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65037.4877; train_chrom_access_recon_loss: 5608175.9962; train_global_loss: 24637236.5344; train_optim_loss: 24637236.5344; val_kl_reg_loss: 61443.0341; val_edge_recon_loss: 579152.2375; val_gene_expr_recon_loss: 18494913.6000; val_masked_gp_l1_reg_loss: 95173.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65032.8359; val_chrom_access_recon_loss: 5717225.7667; val_global_loss: 25012940.8000; val_optim_loss: 25012940.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 45 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9766
val AUPRC score: 0.9713
val best accuracy score: 0.9305
val best F1 score: 0.9317
val target rna MSE score: 1.1443
val source rna MSE score: 0.4168
val target atac MSE score: 0.3345
val source atac MSE score: 0.0981
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
