[True]
Run timestamp: 07092023_020311_237.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_237']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 792 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3517, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7740; val_auprc_score: 0.7955; val_best_acc_score: 0.5234; val_best_f1_score: 0.6756; train_kl_reg_loss: 49958.8970; train_edge_recon_loss: 3542744.6031; train_gene_expr_recon_loss: 12850509.8168; train_masked_gp_l1_reg_loss: 32976.3775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3159500.6904; train_chrom_access_recon_loss: 4520141.9332; train_global_loss: 24155832.1985; train_optim_loss: 24155832.1985; val_kl_reg_loss: 96418.8958; val_edge_recon_loss: 4063463.6000; val_gene_expr_recon_loss: 11961492.8667; val_masked_gp_l1_reg_loss: 31138.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 284171.7500; val_chrom_access_recon_loss: 4361578.7000; val_global_loss: 20798264.8000; val_optim_loss: 20798264.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8067; val_auprc_score: 0.8171; val_best_acc_score: 0.6862; val_best_f1_score: 0.7426; train_kl_reg_loss: 79089.5970; train_edge_recon_loss: 3508967.1374; train_gene_expr_recon_loss: 11837227.4733; train_masked_gp_l1_reg_loss: 30223.8454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182275.5011; train_chrom_access_recon_loss: 4311188.6450; train_global_loss: 19948972.3053; train_optim_loss: 19948972.3053; val_kl_reg_loss: 79451.9526; val_edge_recon_loss: 4049118.8167; val_gene_expr_recon_loss: 11646988.0000; val_masked_gp_l1_reg_loss: 30033.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132846.7500; val_chrom_access_recon_loss: 4256548.6000; val_global_loss: 20194987.3333; val_optim_loss: 20194987.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8456; val_auprc_score: 0.8420; val_best_acc_score: 0.7615; val_best_f1_score: 0.7821; train_kl_reg_loss: 66778.7175; train_edge_recon_loss: 3483602.7290; train_gene_expr_recon_loss: 11624285.5954; train_masked_gp_l1_reg_loss: 31280.2774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115162.0775; train_chrom_access_recon_loss: 4252681.9580; train_global_loss: 19573791.2672; train_optim_loss: 19573791.2672; val_kl_reg_loss: 55170.9909; val_edge_recon_loss: 3614283.9167; val_gene_expr_recon_loss: 11506244.6667; val_masked_gp_l1_reg_loss: 33165.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103221.4219; val_chrom_access_recon_loss: 4211517.5000; val_global_loss: 19523604.0000; val_optim_loss: 19523604.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8790; val_auprc_score: 0.8687; val_best_acc_score: 0.8010; val_best_f1_score: 0.8111; train_kl_reg_loss: 65965.8545; train_edge_recon_loss: 3122882.1603; train_gene_expr_recon_loss: 11502395.3359; train_masked_gp_l1_reg_loss: 35280.8527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98378.6109; train_chrom_access_recon_loss: 4206508.4847; train_global_loss: 19031411.3740; train_optim_loss: 19031411.3740; val_kl_reg_loss: 77462.2214; val_edge_recon_loss: 2972307.2500; val_gene_expr_recon_loss: 11413309.7333; val_masked_gp_l1_reg_loss: 36847.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93770.4453; val_chrom_access_recon_loss: 4185419.7500; val_global_loss: 18779115.7333; val_optim_loss: 18779115.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9185; val_auprc_score: 0.9022; val_best_acc_score: 0.8529; val_best_f1_score: 0.8620; train_kl_reg_loss: 86340.1112; train_edge_recon_loss: 2867394.7805; train_gene_expr_recon_loss: 11385995.8015; train_masked_gp_l1_reg_loss: 38344.7921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91632.6444; train_chrom_access_recon_loss: 4167278.4828; train_global_loss: 18636986.5344; train_optim_loss: 18636986.5344; val_kl_reg_loss: 90616.2443; val_edge_recon_loss: 2845389.3667; val_gene_expr_recon_loss: 11266186.4667; val_masked_gp_l1_reg_loss: 39748.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89320.7344; val_chrom_access_recon_loss: 4123171.7667; val_global_loss: 18454432.6667; val_optim_loss: 18454432.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9280; val_auprc_score: 0.9100; val_best_acc_score: 0.8674; val_best_f1_score: 0.8759; train_kl_reg_loss: 90079.5095; train_edge_recon_loss: 2809202.0286; train_gene_expr_recon_loss: 11268723.8092; train_masked_gp_l1_reg_loss: 40982.0681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86542.3655; train_chrom_access_recon_loss: 4125403.3492; train_global_loss: 18420933.0382; train_optim_loss: 18420933.0382; val_kl_reg_loss: 88080.8401; val_edge_recon_loss: 2800528.4167; val_gene_expr_recon_loss: 11196640.8000; val_masked_gp_l1_reg_loss: 42205.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84615.4062; val_chrom_access_recon_loss: 4100834.8500; val_global_loss: 18312905.8667; val_optim_loss: 18312905.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9341; val_auprc_score: 0.9166; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 88726.8128; train_edge_recon_loss: 2802047.3950; train_gene_expr_recon_loss: 11180915.8779; train_masked_gp_l1_reg_loss: 43208.1993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83804.1869; train_chrom_access_recon_loss: 4095925.7176; train_global_loss: 18294628.1527; train_optim_loss: 18294628.1527; val_kl_reg_loss: 87690.6661; val_edge_recon_loss: 2803128.1833; val_gene_expr_recon_loss: 11132693.4000; val_masked_gp_l1_reg_loss: 44217.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83438.1328; val_chrom_access_recon_loss: 4074598.7333; val_global_loss: 18225767.0667; val_optim_loss: 18225767.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9345; val_auprc_score: 0.9197; val_best_acc_score: 0.8700; val_best_f1_score: 0.8780; train_kl_reg_loss: 86101.9124; train_edge_recon_loss: 2786538.2882; train_gene_expr_recon_loss: 11091640.3740; train_masked_gp_l1_reg_loss: 45099.0189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83327.6923; train_chrom_access_recon_loss: 4064015.2996; train_global_loss: 18156722.5954; train_optim_loss: 18156722.5954; val_kl_reg_loss: 82282.8521; val_edge_recon_loss: 2806729.4167; val_gene_expr_recon_loss: 11059545.1333; val_masked_gp_l1_reg_loss: 45928.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83846.6797; val_chrom_access_recon_loss: 4067147.9167; val_global_loss: 18145481.2000; val_optim_loss: 18145481.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9373; val_auprc_score: 0.9204; val_best_acc_score: 0.8798; val_best_f1_score: 0.8862; train_kl_reg_loss: 84610.5085; train_edge_recon_loss: 2775919.0649; train_gene_expr_recon_loss: 11016390.8168; train_masked_gp_l1_reg_loss: 46661.2426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84314.7451; train_chrom_access_recon_loss: 4039056.8034; train_global_loss: 18046953.1221; train_optim_loss: 18046953.1221; val_kl_reg_loss: 85680.1375; val_edge_recon_loss: 2818311.5333; val_gene_expr_recon_loss: 10930549.1333; val_masked_gp_l1_reg_loss: 47446.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85004.2578; val_chrom_access_recon_loss: 4010403.6833; val_global_loss: 17977395.6000; val_optim_loss: 17977395.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9387; val_auprc_score: 0.9254; val_best_acc_score: 0.8769; val_best_f1_score: 0.8832; train_kl_reg_loss: 83133.8415; train_edge_recon_loss: 2771797.9103; train_gene_expr_recon_loss: 10949975.0992; train_masked_gp_l1_reg_loss: 47973.8081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84549.6942; train_chrom_access_recon_loss: 4009653.2366; train_global_loss: 17947083.4656; train_optim_loss: 17947083.4656; val_kl_reg_loss: 79627.1339; val_edge_recon_loss: 2792396.3667; val_gene_expr_recon_loss: 10906504.0667; val_masked_gp_l1_reg_loss: 48578.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85056.2422; val_chrom_access_recon_loss: 3991580.1333; val_global_loss: 17903741.6000; val_optim_loss: 17903741.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9379; val_auprc_score: 0.9225; val_best_acc_score: 0.8778; val_best_f1_score: 0.8837; train_kl_reg_loss: 79671.0775; train_edge_recon_loss: 2770373.5248; train_gene_expr_recon_loss: 10898000.1450; train_masked_gp_l1_reg_loss: 49118.2303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84579.5047; train_chrom_access_recon_loss: 3994033.2519; train_global_loss: 17875775.6718; train_optim_loss: 17875775.6718; val_kl_reg_loss: 77770.8677; val_edge_recon_loss: 2795162.5167; val_gene_expr_recon_loss: 10826598.2667; val_masked_gp_l1_reg_loss: 49673.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83687.3047; val_chrom_access_recon_loss: 3973820.1000; val_global_loss: 17806712.8667; val_optim_loss: 17806712.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9380; val_auprc_score: 0.9192; val_best_acc_score: 0.8795; val_best_f1_score: 0.8878; train_kl_reg_loss: 77398.2629; train_edge_recon_loss: 2754381.0668; train_gene_expr_recon_loss: 10840855.1756; train_masked_gp_l1_reg_loss: 50238.6050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83935.3401; train_chrom_access_recon_loss: 3971091.6221; train_global_loss: 17777900.0611; train_optim_loss: 17777900.0611; val_kl_reg_loss: 78372.5047; val_edge_recon_loss: 2777311.3833; val_gene_expr_recon_loss: 10792213.2000; val_masked_gp_l1_reg_loss: 50770.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84168.2109; val_chrom_access_recon_loss: 3961992.3000; val_global_loss: 17744828.2667; val_optim_loss: 17744828.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9500; val_auprc_score: 0.9360; val_best_acc_score: 0.8979; val_best_f1_score: 0.9019; train_kl_reg_loss: 76183.9785; train_edge_recon_loss: 2759192.9809; train_gene_expr_recon_loss: 10787312.0229; train_masked_gp_l1_reg_loss: 51195.2971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83811.8331; train_chrom_access_recon_loss: 3950832.5592; train_global_loss: 17708528.8702; train_optim_loss: 17708528.8702; val_kl_reg_loss: 74907.3839; val_edge_recon_loss: 2759393.0833; val_gene_expr_recon_loss: 10741614.4000; val_masked_gp_l1_reg_loss: 51737.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83882.9766; val_chrom_access_recon_loss: 3950109.7167; val_global_loss: 17661645.8667; val_optim_loss: 17661645.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9477; val_auprc_score: 0.9314; val_best_acc_score: 0.8938; val_best_f1_score: 0.8986; train_kl_reg_loss: 75607.5293; train_edge_recon_loss: 2741217.7615; train_gene_expr_recon_loss: 10748540.5573; train_masked_gp_l1_reg_loss: 52110.8439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83485.9057; train_chrom_access_recon_loss: 3933945.7195; train_global_loss: 17634908.3130; train_optim_loss: 17634908.3130; val_kl_reg_loss: 76279.2776; val_edge_recon_loss: 2742516.3000; val_gene_expr_recon_loss: 10726976.4000; val_masked_gp_l1_reg_loss: 52616.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83366.7656; val_chrom_access_recon_loss: 3930213.4000; val_global_loss: 17611969.4667; val_optim_loss: 17611969.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9474; val_auprc_score: 0.9315; val_best_acc_score: 0.8911; val_best_f1_score: 0.8964; train_kl_reg_loss: 73686.6663; train_edge_recon_loss: 2745293.1126; train_gene_expr_recon_loss: 10709224.5115; train_masked_gp_l1_reg_loss: 53108.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83331.2791; train_chrom_access_recon_loss: 3917166.0992; train_global_loss: 17581810.0000; train_optim_loss: 17581810.0000; val_kl_reg_loss: 72844.0771; val_edge_recon_loss: 2758653.0167; val_gene_expr_recon_loss: 10656699.2667; val_masked_gp_l1_reg_loss: 53684.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83797.2500; val_chrom_access_recon_loss: 3899119.3000; val_global_loss: 17524796.8000; val_optim_loss: 17524796.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9518; val_auprc_score: 0.9383; val_best_acc_score: 0.8987; val_best_f1_score: 0.9031; train_kl_reg_loss: 73682.0416; train_edge_recon_loss: 2731219.4370; train_gene_expr_recon_loss: 10674820.7481; train_masked_gp_l1_reg_loss: 53779.0502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83398.7148; train_chrom_access_recon_loss: 3906107.0496; train_global_loss: 17523006.9618; train_optim_loss: 17523006.9618; val_kl_reg_loss: 74691.4630; val_edge_recon_loss: 2735837.8167; val_gene_expr_recon_loss: 10617532.2000; val_masked_gp_l1_reg_loss: 53866.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83231.6016; val_chrom_access_recon_loss: 3873706.1500; val_global_loss: 17438865.4000; val_optim_loss: 17438865.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9511; val_auprc_score: 0.9349; val_best_acc_score: 0.8933; val_best_f1_score: 0.8986; train_kl_reg_loss: 73367.4207; train_edge_recon_loss: 2716733.4237; train_gene_expr_recon_loss: 10638867.9389; train_masked_gp_l1_reg_loss: 54332.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83542.6158; train_chrom_access_recon_loss: 3889556.2481; train_global_loss: 17456400.1450; train_optim_loss: 17456400.1450; val_kl_reg_loss: 72522.4432; val_edge_recon_loss: 2734847.5333; val_gene_expr_recon_loss: 10605903.8000; val_masked_gp_l1_reg_loss: 54690.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83576.7344; val_chrom_access_recon_loss: 3894124.7500; val_global_loss: 17445665.4000; val_optim_loss: 17445665.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9527; val_auprc_score: 0.9380; val_best_acc_score: 0.9012; val_best_f1_score: 0.9058; train_kl_reg_loss: 73057.3503; train_edge_recon_loss: 2717344.7863; train_gene_expr_recon_loss: 10609545.8321; train_masked_gp_l1_reg_loss: 54977.3167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83583.2699; train_chrom_access_recon_loss: 3880419.1966; train_global_loss: 17418927.7252; train_optim_loss: 17418927.7252; val_kl_reg_loss: 76066.9896; val_edge_recon_loss: 2732439.8667; val_gene_expr_recon_loss: 10564160.2667; val_masked_gp_l1_reg_loss: 55343.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83517.5234; val_chrom_access_recon_loss: 3872588.8167; val_global_loss: 17384117.9333; val_optim_loss: 17384117.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9552; val_auprc_score: 0.9435; val_best_acc_score: 0.8995; val_best_f1_score: 0.9027; train_kl_reg_loss: 71873.9309; train_edge_recon_loss: 2711080.6870; train_gene_expr_recon_loss: 10576109.2443; train_masked_gp_l1_reg_loss: 55649.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84476.0130; train_chrom_access_recon_loss: 3867923.6756; train_global_loss: 17367112.7634; train_optim_loss: 17367112.7634; val_kl_reg_loss: 70767.7458; val_edge_recon_loss: 2744149.9500; val_gene_expr_recon_loss: 10566918.4000; val_masked_gp_l1_reg_loss: 56017.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85206.2188; val_chrom_access_recon_loss: 3866015.1667; val_global_loss: 17389074.2000; val_optim_loss: 17389074.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9609; val_auprc_score: 0.9470; val_best_acc_score: 0.9077; val_best_f1_score: 0.9122; train_kl_reg_loss: 71925.6215; train_edge_recon_loss: 2702039.0821; train_gene_expr_recon_loss: 10553125.3435; train_masked_gp_l1_reg_loss: 56301.8894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85990.4026; train_chrom_access_recon_loss: 3858031.1870; train_global_loss: 17327413.6031; train_optim_loss: 17327413.6031; val_kl_reg_loss: 72444.4724; val_edge_recon_loss: 2687163.3500; val_gene_expr_recon_loss: 10504018.8000; val_masked_gp_l1_reg_loss: 56542.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87033.8203; val_chrom_access_recon_loss: 3852283.9667; val_global_loss: 17259486.7333; val_optim_loss: 17259486.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9626; val_auprc_score: 0.9530; val_best_acc_score: 0.9108; val_best_f1_score: 0.9141; train_kl_reg_loss: 70875.8678; train_edge_recon_loss: 2709611.0763; train_gene_expr_recon_loss: 10526339.3664; train_masked_gp_l1_reg_loss: 56854.1245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87491.0555; train_chrom_access_recon_loss: 3848729.8969; train_global_loss: 17299901.4122; train_optim_loss: 17299901.4122; val_kl_reg_loss: 70114.0885; val_edge_recon_loss: 2712192.2500; val_gene_expr_recon_loss: 10468330.5333; val_masked_gp_l1_reg_loss: 57211.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88432.3672; val_chrom_access_recon_loss: 3833506.0500; val_global_loss: 17229786.8000; val_optim_loss: 17229786.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9650; val_auprc_score: 0.9545; val_best_acc_score: 0.9124; val_best_f1_score: 0.9162; train_kl_reg_loss: 71279.1287; train_edge_recon_loss: 2696255.2347; train_gene_expr_recon_loss: 10510256.1145; train_masked_gp_l1_reg_loss: 57478.8594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88275.7198; train_chrom_access_recon_loss: 3842950.3397; train_global_loss: 17266495.4275; train_optim_loss: 17266495.4275; val_kl_reg_loss: 70708.6151; val_edge_recon_loss: 2716576.0167; val_gene_expr_recon_loss: 10493913.4667; val_masked_gp_l1_reg_loss: 57707.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87902.5156; val_chrom_access_recon_loss: 3839198.2833; val_global_loss: 17266007.3333; val_optim_loss: 17266007.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9689; val_auprc_score: 0.9611; val_best_acc_score: 0.9155; val_best_f1_score: 0.9186; train_kl_reg_loss: 70682.1166; train_edge_recon_loss: 2691495.4676; train_gene_expr_recon_loss: 10491717.8473; train_masked_gp_l1_reg_loss: 57972.7273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88364.3757; train_chrom_access_recon_loss: 3833119.9905; train_global_loss: 17233352.5038; train_optim_loss: 17233352.5038; val_kl_reg_loss: 68954.4146; val_edge_recon_loss: 2697651.6667; val_gene_expr_recon_loss: 10465980.4000; val_masked_gp_l1_reg_loss: 58316.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89366.7109; val_chrom_access_recon_loss: 3842841.1167; val_global_loss: 17223111.8667; val_optim_loss: 17223111.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9692; val_auprc_score: 0.9591; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 70701.6435; train_edge_recon_loss: 2692423.4218; train_gene_expr_recon_loss: 10464400.0916; train_masked_gp_l1_reg_loss: 58545.5442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88673.6816; train_chrom_access_recon_loss: 3823938.6966; train_global_loss: 17198683.0840; train_optim_loss: 17198683.0840; val_kl_reg_loss: 72402.7120; val_edge_recon_loss: 2678648.6667; val_gene_expr_recon_loss: 10424319.2000; val_masked_gp_l1_reg_loss: 58809.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89176.7891; val_chrom_access_recon_loss: 3819134.4167; val_global_loss: 17142491.4000; val_optim_loss: 17142491.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9689; val_auprc_score: 0.9611; val_best_acc_score: 0.9167; val_best_f1_score: 0.9201; train_kl_reg_loss: 70368.5061; train_edge_recon_loss: 2690822.4008; train_gene_expr_recon_loss: 10452989.1527; train_masked_gp_l1_reg_loss: 59022.0239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88827.9178; train_chrom_access_recon_loss: 3817363.0210; train_global_loss: 17179393.1603; train_optim_loss: 17179393.1603; val_kl_reg_loss: 71457.9047; val_edge_recon_loss: 2707907.0500; val_gene_expr_recon_loss: 10400226.1333; val_masked_gp_l1_reg_loss: 59294.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89410.0703; val_chrom_access_recon_loss: 3817981.0333; val_global_loss: 17146276.2000; val_optim_loss: 17146276.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9718; val_auprc_score: 0.9641; val_best_acc_score: 0.9243; val_best_f1_score: 0.9278; train_kl_reg_loss: 70005.6175; train_edge_recon_loss: 2692050.0859; train_gene_expr_recon_loss: 10430494.3664; train_masked_gp_l1_reg_loss: 59492.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88936.3799; train_chrom_access_recon_loss: 3807221.5878; train_global_loss: 17148200.4427; train_optim_loss: 17148200.4427; val_kl_reg_loss: 69267.3240; val_edge_recon_loss: 2688173.9667; val_gene_expr_recon_loss: 10388607.4000; val_masked_gp_l1_reg_loss: 59761.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89023.9375; val_chrom_access_recon_loss: 3803966.8500; val_global_loss: 17098801.3333; val_optim_loss: 17098801.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9739; val_auprc_score: 0.9662; val_best_acc_score: 0.9291; val_best_f1_score: 0.9317; train_kl_reg_loss: 70006.5429; train_edge_recon_loss: 2683335.4828; train_gene_expr_recon_loss: 10407553.4427; train_masked_gp_l1_reg_loss: 59940.6255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88892.8378; train_chrom_access_recon_loss: 3799968.2424; train_global_loss: 17109697.2901; train_optim_loss: 17109697.2901; val_kl_reg_loss: 70145.1505; val_edge_recon_loss: 2685961.5833; val_gene_expr_recon_loss: 10360822.0000; val_masked_gp_l1_reg_loss: 60241.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89084.5625; val_chrom_access_recon_loss: 3812874.3833; val_global_loss: 17079130.0000; val_optim_loss: 17079130.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9717; val_auprc_score: 0.9644; val_best_acc_score: 0.9263; val_best_f1_score: 0.9287; train_kl_reg_loss: 69403.6907; train_edge_recon_loss: 2680991.4676; train_gene_expr_recon_loss: 10390155.5954; train_masked_gp_l1_reg_loss: 60421.6090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89052.5711; train_chrom_access_recon_loss: 3792043.4237; train_global_loss: 17082068.3588; train_optim_loss: 17082068.3588; val_kl_reg_loss: 68466.8802; val_edge_recon_loss: 2693974.7000; val_gene_expr_recon_loss: 10391663.8000; val_masked_gp_l1_reg_loss: 60576.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88617.0625; val_chrom_access_recon_loss: 3805615.4000; val_global_loss: 17108914.9333; val_optim_loss: 17108914.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9744; val_auprc_score: 0.9653; val_best_acc_score: 0.9274; val_best_f1_score: 0.9291; train_kl_reg_loss: 69769.1031; train_edge_recon_loss: 2678355.6298; train_gene_expr_recon_loss: 10379627.7328; train_masked_gp_l1_reg_loss: 60778.7830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88958.2850; train_chrom_access_recon_loss: 3788939.0630; train_global_loss: 17066428.6031; train_optim_loss: 17066428.6031; val_kl_reg_loss: 69402.5661; val_edge_recon_loss: 2687727.1667; val_gene_expr_recon_loss: 10399215.1333; val_masked_gp_l1_reg_loss: 60992.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89023.1875; val_chrom_access_recon_loss: 3791494.2833; val_global_loss: 17097855.2000; val_optim_loss: 17097855.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9749; val_auprc_score: 0.9667; val_best_acc_score: 0.9267; val_best_f1_score: 0.9289; train_kl_reg_loss: 68757.1252; train_edge_recon_loss: 2682692.9160; train_gene_expr_recon_loss: 10360209.3893; train_masked_gp_l1_reg_loss: 61204.9963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89105.2653; train_chrom_access_recon_loss: 3779010.1298; train_global_loss: 17040979.8397; train_optim_loss: 17040979.8397; val_kl_reg_loss: 65977.7203; val_edge_recon_loss: 2686419.1667; val_gene_expr_recon_loss: 10370262.4667; val_masked_gp_l1_reg_loss: 61406.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89776.7656; val_chrom_access_recon_loss: 3793158.7500; val_global_loss: 17067002.0000; val_optim_loss: 17067002.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9742; val_auprc_score: 0.9654; val_best_acc_score: 0.9281; val_best_f1_score: 0.9304; train_kl_reg_loss: 68600.5646; train_edge_recon_loss: 2676751.8225; train_gene_expr_recon_loss: 10354377.0763; train_masked_gp_l1_reg_loss: 61563.3386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89375.9993; train_chrom_access_recon_loss: 3773548.9141; train_global_loss: 17024217.6870; train_optim_loss: 17024217.6870; val_kl_reg_loss: 69763.7177; val_edge_recon_loss: 2693168.3667; val_gene_expr_recon_loss: 10282416.0667; val_masked_gp_l1_reg_loss: 61837.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89735.9219; val_chrom_access_recon_loss: 3772602.0333; val_global_loss: 16969524.0667; val_optim_loss: 16969524.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9733; val_auprc_score: 0.9635; val_best_acc_score: 0.9287; val_best_f1_score: 0.9314; train_kl_reg_loss: 68049.9625; train_edge_recon_loss: 2683544.4790; train_gene_expr_recon_loss: 10351980.9008; train_masked_gp_l1_reg_loss: 61989.1132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89644.4190; train_chrom_access_recon_loss: 3770902.6832; train_global_loss: 17026111.5420; train_optim_loss: 17026111.5420; val_kl_reg_loss: 68265.8938; val_edge_recon_loss: 2689616.7333; val_gene_expr_recon_loss: 10342495.5333; val_masked_gp_l1_reg_loss: 62133.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89658.7344; val_chrom_access_recon_loss: 3775789.5167; val_global_loss: 17027960.6000; val_optim_loss: 17027960.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9759; val_auprc_score: 0.9668; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 68463.4238; train_edge_recon_loss: 2675196.6317; train_gene_expr_recon_loss: 10334799.3282; train_masked_gp_l1_reg_loss: 62349.8980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89591.6256; train_chrom_access_recon_loss: 3761452.9275; train_global_loss: 16991853.8931; train_optim_loss: 16991853.8931; val_kl_reg_loss: 69267.8510; val_edge_recon_loss: 2677292.5333; val_gene_expr_recon_loss: 10306243.6000; val_masked_gp_l1_reg_loss: 62534.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89765.2422; val_chrom_access_recon_loss: 3774067.1833; val_global_loss: 16979169.9333; val_optim_loss: 16979169.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9749; val_auprc_score: 0.9637; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 67679.4164; train_edge_recon_loss: 2669924.3626; train_gene_expr_recon_loss: 10321356.0458; train_masked_gp_l1_reg_loss: 62665.8683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89746.8464; train_chrom_access_recon_loss: 3756095.6107; train_global_loss: 16967468.0611; train_optim_loss: 16967468.0611; val_kl_reg_loss: 68283.4362; val_edge_recon_loss: 2689802.0333; val_gene_expr_recon_loss: 10357024.6667; val_masked_gp_l1_reg_loss: 62832.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89229.4766; val_chrom_access_recon_loss: 3764303.8333; val_global_loss: 17031475.1333; val_optim_loss: 17031475.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9765; val_auprc_score: 0.9699; val_best_acc_score: 0.9298; val_best_f1_score: 0.9321; train_kl_reg_loss: 68363.4324; train_edge_recon_loss: 2672830.6469; train_gene_expr_recon_loss: 10313161.0534; train_masked_gp_l1_reg_loss: 63008.2203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89710.8435; train_chrom_access_recon_loss: 3750225.5973; train_global_loss: 16957299.7405; train_optim_loss: 16957299.7405; val_kl_reg_loss: 67467.3333; val_edge_recon_loss: 2697169.7833; val_gene_expr_recon_loss: 10282390.2000; val_masked_gp_l1_reg_loss: 63074.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89426.5469; val_chrom_access_recon_loss: 3764815.1333; val_global_loss: 16964344.6000; val_optim_loss: 16964344.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9792; val_auprc_score: 0.9734; val_best_acc_score: 0.9365; val_best_f1_score: 0.9389; train_kl_reg_loss: 68416.8172; train_edge_recon_loss: 2678954.3492; train_gene_expr_recon_loss: 10311918.2443; train_masked_gp_l1_reg_loss: 63331.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89679.7961; train_chrom_access_recon_loss: 3744983.2576; train_global_loss: 16957283.7176; train_optim_loss: 16957283.7176; val_kl_reg_loss: 68932.8422; val_edge_recon_loss: 2677312.8000; val_gene_expr_recon_loss: 10260267.7333; val_masked_gp_l1_reg_loss: 63407.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89267.7422; val_chrom_access_recon_loss: 3748208.9833; val_global_loss: 16907397.3333; val_optim_loss: 16907397.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9799; val_auprc_score: 0.9727; val_best_acc_score: 0.9371; val_best_f1_score: 0.9389; train_kl_reg_loss: 67875.7036; train_edge_recon_loss: 2672142.2939; train_gene_expr_recon_loss: 10291298.8092; train_masked_gp_l1_reg_loss: 63592.8902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89417.7487; train_chrom_access_recon_loss: 3735764.1908; train_global_loss: 16920091.6489; train_optim_loss: 16920091.6489; val_kl_reg_loss: 67260.4286; val_edge_recon_loss: 2678494.3333; val_gene_expr_recon_loss: 10278004.6667; val_masked_gp_l1_reg_loss: 63799.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89506.1328; val_chrom_access_recon_loss: 3747030.1167; val_global_loss: 16924094.5333; val_optim_loss: 16924094.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9799; val_auprc_score: 0.9742; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 67593.7384; train_edge_recon_loss: 2672576.1298; train_gene_expr_recon_loss: 10294511.7099; train_masked_gp_l1_reg_loss: 63923.3814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89564.3776; train_chrom_access_recon_loss: 3732503.7252; train_global_loss: 16920673.0611; train_optim_loss: 16920673.0611; val_kl_reg_loss: 67787.5630; val_edge_recon_loss: 2681441.3667; val_gene_expr_recon_loss: 10257762.2667; val_masked_gp_l1_reg_loss: 64148.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90207.6719; val_chrom_access_recon_loss: 3768213.5500; val_global_loss: 16929561.6667; val_optim_loss: 16929561.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9803; val_auprc_score: 0.9754; val_best_acc_score: 0.9375; val_best_f1_score: 0.9400; train_kl_reg_loss: 67405.5325; train_edge_recon_loss: 2666735.6756; train_gene_expr_recon_loss: 10271327.3511; train_masked_gp_l1_reg_loss: 64210.3647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89640.1300; train_chrom_access_recon_loss: 3722348.9752; train_global_loss: 16881667.9924; train_optim_loss: 16881667.9924; val_kl_reg_loss: 68524.6615; val_edge_recon_loss: 2674403.0167; val_gene_expr_recon_loss: 10274448.4000; val_masked_gp_l1_reg_loss: 64353.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89828.9141; val_chrom_access_recon_loss: 3747209.1000; val_global_loss: 16918768.2667; val_optim_loss: 16918768.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9817; val_auprc_score: 0.9770; val_best_acc_score: 0.9384; val_best_f1_score: 0.9400; train_kl_reg_loss: 67103.2746; train_edge_recon_loss: 2674635.6221; train_gene_expr_recon_loss: 10267615.2519; train_masked_gp_l1_reg_loss: 64485.8336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89756.9796; train_chrom_access_recon_loss: 3715063.3798; train_global_loss: 16878660.4198; train_optim_loss: 16878660.4198; val_kl_reg_loss: 66467.1247; val_edge_recon_loss: 2691799.9500; val_gene_expr_recon_loss: 10279361.4000; val_masked_gp_l1_reg_loss: 64593.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89902.9453; val_chrom_access_recon_loss: 3753706.9000; val_global_loss: 16945832.1333; val_optim_loss: 16945832.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9807; val_auprc_score: 0.9750; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 68371.0511; train_edge_recon_loss: 2667921.9752; train_gene_expr_recon_loss: 10252816.7481; train_masked_gp_l1_reg_loss: 63434.8866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67950.7811; train_chrom_access_recon_loss: 3703879.8168; train_global_loss: 16824375.2519; train_optim_loss: 16824375.2519; val_kl_reg_loss: 70031.8109; val_edge_recon_loss: 2686065.8167; val_gene_expr_recon_loss: 10241444.8000; val_masked_gp_l1_reg_loss: 62894.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65196.5703; val_chrom_access_recon_loss: 3726006.5000; val_global_loss: 16851640.0667; val_optim_loss: 16851640.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9824; val_auprc_score: 0.9781; val_best_acc_score: 0.9418; val_best_f1_score: 0.9438; train_kl_reg_loss: 69755.8263; train_edge_recon_loss: 2662968.2061; train_gene_expr_recon_loss: 10250299.3130; train_masked_gp_l1_reg_loss: 62773.0130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64921.8024; train_chrom_access_recon_loss: 3700369.8645; train_global_loss: 16811088.0840; train_optim_loss: 16811088.0840; val_kl_reg_loss: 70835.1198; val_edge_recon_loss: 2677408.0333; val_gene_expr_recon_loss: 10240802.2000; val_masked_gp_l1_reg_loss: 62677.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64777.8008; val_chrom_access_recon_loss: 3732926.8000; val_global_loss: 16849428.2667; val_optim_loss: 16849428.2667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9792; val_auprc_score: 0.9694; val_best_acc_score: 0.9388; val_best_f1_score: 0.9406; train_kl_reg_loss: 70573.8696; train_edge_recon_loss: 2665363.3111; train_gene_expr_recon_loss: 10241558.2366; train_masked_gp_l1_reg_loss: 62648.7738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64552.2319; train_chrom_access_recon_loss: 3696852.2977; train_global_loss: 16801548.7710; train_optim_loss: 16801548.7710; val_kl_reg_loss: 70723.4281; val_edge_recon_loss: 2683345.4333; val_gene_expr_recon_loss: 10233383.4667; val_masked_gp_l1_reg_loss: 62607.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64374.1445; val_chrom_access_recon_loss: 3718996.8833; val_global_loss: 16833430.4000; val_optim_loss: 16833430.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9817; val_auprc_score: 0.9763; val_best_acc_score: 0.9441; val_best_f1_score: 0.9462; train_kl_reg_loss: 70409.4284; train_edge_recon_loss: 2664219.5573; train_gene_expr_recon_loss: 10241684.3435; train_masked_gp_l1_reg_loss: 62603.5016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64193.2877; train_chrom_access_recon_loss: 3695027.0439; train_global_loss: 16798137.2061; train_optim_loss: 16798137.2061; val_kl_reg_loss: 71226.4500; val_edge_recon_loss: 2649542.9667; val_gene_expr_recon_loss: 10226042.6667; val_masked_gp_l1_reg_loss: 62591.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64084.5703; val_chrom_access_recon_loss: 3732367.7333; val_global_loss: 16805855.7333; val_optim_loss: 16805855.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9822; val_auprc_score: 0.9737; val_best_acc_score: 0.9418; val_best_f1_score: 0.9434; train_kl_reg_loss: 70861.8690; train_edge_recon_loss: 2662296.1775; train_gene_expr_recon_loss: 10243103.9084; train_masked_gp_l1_reg_loss: 62594.5389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63995.9694; train_chrom_access_recon_loss: 3694512.4866; train_global_loss: 16797365.0153; train_optim_loss: 16797365.0153; val_kl_reg_loss: 71673.0625; val_edge_recon_loss: 2663087.8667; val_gene_expr_recon_loss: 10263808.5333; val_masked_gp_l1_reg_loss: 62583.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63874.7969; val_chrom_access_recon_loss: 3738405.4667; val_global_loss: 16863434.0000; val_optim_loss: 16863434.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9806; val_auprc_score: 0.9740; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 70757.3680; train_edge_recon_loss: 2667088.4924; train_gene_expr_recon_loss: 10243817.6718; train_masked_gp_l1_reg_loss: 62598.3030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63842.3204; train_chrom_access_recon_loss: 3695509.3588; train_global_loss: 16803613.5115; train_optim_loss: 16803613.5115; val_kl_reg_loss: 72125.6047; val_edge_recon_loss: 2673404.9500; val_gene_expr_recon_loss: 10254303.4667; val_masked_gp_l1_reg_loss: 62590.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63620.2422; val_chrom_access_recon_loss: 3745749.8833; val_global_loss: 16871795.0000; val_optim_loss: 16871795.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9824; val_auprc_score: 0.9777; val_best_acc_score: 0.9430; val_best_f1_score: 0.9449; train_kl_reg_loss: 70746.2037; train_edge_recon_loss: 2663270.3340; train_gene_expr_recon_loss: 10241233.7328; train_masked_gp_l1_reg_loss: 62594.4381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63526.9514; train_chrom_access_recon_loss: 3695302.8664; train_global_loss: 16796674.5344; train_optim_loss: 16796674.5344; val_kl_reg_loss: 71066.7682; val_edge_recon_loss: 2655966.9000; val_gene_expr_recon_loss: 10269152.6667; val_masked_gp_l1_reg_loss: 62602.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63496.1094; val_chrom_access_recon_loss: 3752910.4833; val_global_loss: 16875194.8000; val_optim_loss: 16875194.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9822; val_auprc_score: 0.9778; val_best_acc_score: 0.9422; val_best_f1_score: 0.9441; train_kl_reg_loss: 70592.0611; train_edge_recon_loss: 2667174.9618; train_gene_expr_recon_loss: 10239807.1756; train_masked_gp_l1_reg_loss: 62619.3687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63422.4791; train_chrom_access_recon_loss: 3696325.2519; train_global_loss: 16799941.1298; train_optim_loss: 16799941.1298; val_kl_reg_loss: 71620.8990; val_edge_recon_loss: 2663295.1833; val_gene_expr_recon_loss: 10288488.6667; val_masked_gp_l1_reg_loss: 62608.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63312.8281; val_chrom_access_recon_loss: 3745074.7000; val_global_loss: 16894401.3333; val_optim_loss: 16894401.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9795; val_auprc_score: 0.9721; val_best_acc_score: 0.9402; val_best_f1_score: 0.9421; train_kl_reg_loss: 70856.8779; train_edge_recon_loss: 2671235.4256; train_gene_expr_recon_loss: 10237996.5573; train_masked_gp_l1_reg_loss: 62491.4676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61155.0921; train_chrom_access_recon_loss: 3692868.7634; train_global_loss: 16796604.2672; train_optim_loss: 16796604.2672; val_kl_reg_loss: 71236.3464; val_edge_recon_loss: 2681361.1833; val_gene_expr_recon_loss: 10238292.5333; val_masked_gp_l1_reg_loss: 62429.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60891.5195; val_chrom_access_recon_loss: 3738461.6167; val_global_loss: 16852673.7333; val_optim_loss: 16852673.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9828; val_auprc_score: 0.9773; val_best_acc_score: 0.9427; val_best_f1_score: 0.9441; train_kl_reg_loss: 70617.9573; train_edge_recon_loss: 2669773.5992; train_gene_expr_recon_loss: 10240033.9695; train_masked_gp_l1_reg_loss: 62410.8760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60839.0982; train_chrom_access_recon_loss: 3693297.5763; train_global_loss: 16796972.9924; train_optim_loss: 16796972.9924; val_kl_reg_loss: 71254.3938; val_edge_recon_loss: 2674099.1667; val_gene_expr_recon_loss: 10265987.6667; val_masked_gp_l1_reg_loss: 62395.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60798.6211; val_chrom_access_recon_loss: 3736684.3667; val_global_loss: 16871219.7333; val_optim_loss: 16871219.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9821; val_auprc_score: 0.9773; val_best_acc_score: 0.9388; val_best_f1_score: 0.9403; train_kl_reg_loss: 70576.6232; train_edge_recon_loss: 2666753.9046; train_gene_expr_recon_loss: 10232586.7023; train_masked_gp_l1_reg_loss: 62387.8176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60766.6458; train_chrom_access_recon_loss: 3689043.5935; train_global_loss: 16782115.2901; train_optim_loss: 16782115.2901; val_kl_reg_loss: 71372.0323; val_edge_recon_loss: 2684301.5500; val_gene_expr_recon_loss: 10258421.8667; val_masked_gp_l1_reg_loss: 62380.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60741.6914; val_chrom_access_recon_loss: 3729642.2833; val_global_loss: 16866859.8000; val_optim_loss: 16866859.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9800; val_auprc_score: 0.9738; val_best_acc_score: 0.9390; val_best_f1_score: 0.9405; train_kl_reg_loss: 70664.6461; train_edge_recon_loss: 2665036.6966; train_gene_expr_recon_loss: 10235705.6641; train_masked_gp_l1_reg_loss: 62377.3068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60714.8613; train_chrom_access_recon_loss: 3689769.7424; train_global_loss: 16784268.9618; train_optim_loss: 16784268.9618; val_kl_reg_loss: 71461.2896; val_edge_recon_loss: 2667813.8833; val_gene_expr_recon_loss: 10267207.8667; val_masked_gp_l1_reg_loss: 62372.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60701.2031; val_chrom_access_recon_loss: 3742447.9333; val_global_loss: 16872004.8000; val_optim_loss: 16872004.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 73 min 46 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9814
val AUPRC score: 0.9761
val best accuracy score: 0.9400
val best F1 score: 0.9415
val target rna MSE score: 1.1611
val source rna MSE score: 0.2427
val target atac MSE score: 0.4941
val source atac MSE score: 0.0713
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
