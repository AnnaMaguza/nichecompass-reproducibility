[True]
Run timestamp: 07092023_143903_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6417; val_auprc_score: 0.6331; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 55084.1002; train_edge_recon_loss: 3543916.7462; train_gene_expr_recon_loss: 16753952.9091; train_masked_gp_l1_reg_loss: 83043.9062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1476673.5530; train_chrom_access_recon_loss: 3797612.9962; train_global_loss: 25710284.2121; train_optim_loss: 25710284.2121; val_kl_reg_loss: 109799.1123; val_edge_recon_loss: 4065868.5938; val_gene_expr_recon_loss: 15639773.0000; val_masked_gp_l1_reg_loss: 81090.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1131090.0000; val_chrom_access_recon_loss: 3710571.8438; val_global_loss: 24738192.5000; val_optim_loss: 24738192.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6941; val_auprc_score: 0.6837; val_best_acc_score: 0.5244; val_best_f1_score: 0.6751; train_kl_reg_loss: 102750.8346; train_edge_recon_loss: 3531256.0000; train_gene_expr_recon_loss: 14885677.9848; train_masked_gp_l1_reg_loss: 77730.7288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 828967.1146; train_chrom_access_recon_loss: 3595427.8030; train_global_loss: 23021810.4848; train_optim_loss: 23021810.4848; val_kl_reg_loss: 106918.3398; val_edge_recon_loss: 4063882.0312; val_gene_expr_recon_loss: 15011166.1250; val_masked_gp_l1_reg_loss: 74982.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 572939.8750; val_chrom_access_recon_loss: 3656230.0312; val_global_loss: 23486118.2500; val_optim_loss: 23486118.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7377; val_auprc_score: 0.7239; val_best_acc_score: 0.6037; val_best_f1_score: 0.7056; train_kl_reg_loss: 102119.6939; train_edge_recon_loss: 3521288.5303; train_gene_expr_recon_loss: 14598492.5758; train_masked_gp_l1_reg_loss: 74649.2835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 425326.7509; train_chrom_access_recon_loss: 3555385.6212; train_global_loss: 22277262.4848; train_optim_loss: 22277262.4848; val_kl_reg_loss: 88864.8057; val_edge_recon_loss: 4058432.5312; val_gene_expr_recon_loss: 14673833.2500; val_masked_gp_l1_reg_loss: 74904.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 310229.1562; val_chrom_access_recon_loss: 3586972.8750; val_global_loss: 22793237.0000; val_optim_loss: 22793237.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7772; val_auprc_score: 0.7636; val_best_acc_score: 0.6789; val_best_f1_score: 0.7246; train_kl_reg_loss: 93950.6371; train_edge_recon_loss: 3516888.4848; train_gene_expr_recon_loss: 14485270.5455; train_masked_gp_l1_reg_loss: 75242.2036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245269.4013; train_chrom_access_recon_loss: 3534835.2879; train_global_loss: 21951456.5758; train_optim_loss: 21951456.5758; val_kl_reg_loss: 83310.6074; val_edge_recon_loss: 4039961.4375; val_gene_expr_recon_loss: 14727864.5000; val_masked_gp_l1_reg_loss: 75969.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193123.9844; val_chrom_access_recon_loss: 3512802.3750; val_global_loss: 22633032.5000; val_optim_loss: 22633032.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8140; val_auprc_score: 0.7971; val_best_acc_score: 0.7238; val_best_f1_score: 0.7311; train_kl_reg_loss: 85200.8974; train_edge_recon_loss: 3506289.6932; train_gene_expr_recon_loss: 14377616.7273; train_masked_gp_l1_reg_loss: 77136.9156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161318.0429; train_chrom_access_recon_loss: 3513820.3788; train_global_loss: 21721382.6970; train_optim_loss: 21721382.6970; val_kl_reg_loss: 80669.4502; val_edge_recon_loss: 3956239.5312; val_gene_expr_recon_loss: 14589254.7500; val_masked_gp_l1_reg_loss: 78710.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135381.8438; val_chrom_access_recon_loss: 3517194.6875; val_global_loss: 22357450.5000; val_optim_loss: 22357450.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8272; val_auprc_score: 0.8007; val_best_acc_score: 0.7501; val_best_f1_score: 0.7724; train_kl_reg_loss: 72061.6818; train_edge_recon_loss: 3434465.9356; train_gene_expr_recon_loss: 14293748.5909; train_masked_gp_l1_reg_loss: 80624.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119203.7551; train_chrom_access_recon_loss: 3495113.4015; train_global_loss: 21495218.0000; train_optim_loss: 21495218.0000; val_kl_reg_loss: 71369.0215; val_edge_recon_loss: 3449434.9688; val_gene_expr_recon_loss: 14451939.6250; val_masked_gp_l1_reg_loss: 83388.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106516.4531; val_chrom_access_recon_loss: 3479279.2500; val_global_loss: 21641927.2500; val_optim_loss: 21641927.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8479; val_auprc_score: 0.8226; val_best_acc_score: 0.7700; val_best_f1_score: 0.7964; train_kl_reg_loss: 62733.7005; train_edge_recon_loss: 3279292.5417; train_gene_expr_recon_loss: 14265718.2121; train_masked_gp_l1_reg_loss: 86928.5420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98939.7013; train_chrom_access_recon_loss: 3482627.8220; train_global_loss: 21276240.6970; train_optim_loss: 21276240.6970; val_kl_reg_loss: 68436.8130; val_edge_recon_loss: 3178398.0000; val_gene_expr_recon_loss: 14351175.8750; val_masked_gp_l1_reg_loss: 90166.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91541.6250; val_chrom_access_recon_loss: 3457786.1562; val_global_loss: 21237504.5000; val_optim_loss: 21237504.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8393; val_auprc_score: 0.8134; val_best_acc_score: 0.7526; val_best_f1_score: 0.7828; train_kl_reg_loss: 79941.6477; train_edge_recon_loss: 3049312.2879; train_gene_expr_recon_loss: 14194476.0000; train_masked_gp_l1_reg_loss: 91644.1535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84453.5308; train_chrom_access_recon_loss: 3469955.1212; train_global_loss: 20969782.7879; train_optim_loss: 20969782.7879; val_kl_reg_loss: 91650.6592; val_edge_recon_loss: 3017026.1250; val_gene_expr_recon_loss: 14359412.7500; val_masked_gp_l1_reg_loss: 92802.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78059.9297; val_chrom_access_recon_loss: 3488195.1250; val_global_loss: 21127146.5000; val_optim_loss: 21127146.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8561; val_auprc_score: 0.8222; val_best_acc_score: 0.7749; val_best_f1_score: 0.7884; train_kl_reg_loss: 97008.3860; train_edge_recon_loss: 2981810.2917; train_gene_expr_recon_loss: 14113782.4697; train_masked_gp_l1_reg_loss: 93706.7760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73113.0786; train_chrom_access_recon_loss: 3453407.8030; train_global_loss: 20812828.5758; train_optim_loss: 20812828.5758; val_kl_reg_loss: 99643.3965; val_edge_recon_loss: 2984436.3750; val_gene_expr_recon_loss: 14265432.3750; val_masked_gp_l1_reg_loss: 94944.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68755.4844; val_chrom_access_recon_loss: 3429724.8750; val_global_loss: 20942937.0000; val_optim_loss: 20942937.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8809; val_auprc_score: 0.8508; val_best_acc_score: 0.8103; val_best_f1_score: 0.8136; train_kl_reg_loss: 98251.2346; train_edge_recon_loss: 2938878.6818; train_gene_expr_recon_loss: 14037969.5758; train_masked_gp_l1_reg_loss: 95722.6983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65209.5569; train_chrom_access_recon_loss: 3434384.1667; train_global_loss: 20670416.0303; train_optim_loss: 20670416.0303; val_kl_reg_loss: 97319.7617; val_edge_recon_loss: 2912552.9688; val_gene_expr_recon_loss: 14254717.6250; val_masked_gp_l1_reg_loss: 96881.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62258.2383; val_chrom_access_recon_loss: 3455023.7812; val_global_loss: 20878753.7500; val_optim_loss: 20878753.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8955; val_auprc_score: 0.8664; val_best_acc_score: 0.8235; val_best_f1_score: 0.8331; train_kl_reg_loss: 96806.5528; train_edge_recon_loss: 2898666.9583; train_gene_expr_recon_loss: 13992864.0303; train_masked_gp_l1_reg_loss: 97787.6649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59464.0138; train_chrom_access_recon_loss: 3426832.0492; train_global_loss: 20572421.3030; train_optim_loss: 20572421.3030; val_kl_reg_loss: 93238.3828; val_edge_recon_loss: 2901262.0938; val_gene_expr_recon_loss: 14211301.1250; val_masked_gp_l1_reg_loss: 98882.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57273.7812; val_chrom_access_recon_loss: 3450052.5312; val_global_loss: 20812010.2500; val_optim_loss: 20812010.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8978; val_auprc_score: 0.8676; val_best_acc_score: 0.8318; val_best_f1_score: 0.8449; train_kl_reg_loss: 93950.7940; train_edge_recon_loss: 2849253.4773; train_gene_expr_recon_loss: 13936864.6667; train_masked_gp_l1_reg_loss: 100962.0972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55248.4754; train_chrom_access_recon_loss: 3409604.8636; train_global_loss: 20445884.2424; train_optim_loss: 20445884.2424; val_kl_reg_loss: 86800.3926; val_edge_recon_loss: 2885663.5625; val_gene_expr_recon_loss: 14233132.1250; val_masked_gp_l1_reg_loss: 102524.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53816.5664; val_chrom_access_recon_loss: 3461802.1875; val_global_loss: 20823738.5000; val_optim_loss: 20823738.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8994; val_auprc_score: 0.8665; val_best_acc_score: 0.8356; val_best_f1_score: 0.8495; train_kl_reg_loss: 96185.5540; train_edge_recon_loss: 2824153.5227; train_gene_expr_recon_loss: 13888946.5455; train_masked_gp_l1_reg_loss: 103302.2985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52435.9626; train_chrom_access_recon_loss: 3397350.1439; train_global_loss: 20362374.0909; train_optim_loss: 20362374.0909; val_kl_reg_loss: 99010.5762; val_edge_recon_loss: 2864803.1562; val_gene_expr_recon_loss: 14048932.8750; val_masked_gp_l1_reg_loss: 104147.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51041.1211; val_chrom_access_recon_loss: 3413486.6875; val_global_loss: 20581423.0000; val_optim_loss: 20581423.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9111; val_auprc_score: 0.8794; val_best_acc_score: 0.8503; val_best_f1_score: 0.8579; train_kl_reg_loss: 100379.2214; train_edge_recon_loss: 2804097.0379; train_gene_expr_recon_loss: 13849883.6061; train_masked_gp_l1_reg_loss: 104975.3062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50008.5315; train_chrom_access_recon_loss: 3387589.6591; train_global_loss: 20296933.3333; train_optim_loss: 20296933.3333; val_kl_reg_loss: 99872.5674; val_edge_recon_loss: 2815987.3438; val_gene_expr_recon_loss: 13928477.8750; val_masked_gp_l1_reg_loss: 105604.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48946.6016; val_chrom_access_recon_loss: 3379432.4375; val_global_loss: 20378320.2500; val_optim_loss: 20378320.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9138; val_auprc_score: 0.8841; val_best_acc_score: 0.8506; val_best_f1_score: 0.8596; train_kl_reg_loss: 101441.3692; train_edge_recon_loss: 2780193.8864; train_gene_expr_recon_loss: 13798556.9545; train_masked_gp_l1_reg_loss: 106289.1613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48073.6996; train_chrom_access_recon_loss: 3373745.2955; train_global_loss: 20208300.1212; train_optim_loss: 20208300.1212; val_kl_reg_loss: 100821.8857; val_edge_recon_loss: 2811118.1250; val_gene_expr_recon_loss: 14007404.7500; val_masked_gp_l1_reg_loss: 107004.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47380.9258; val_chrom_access_recon_loss: 3405034.5312; val_global_loss: 20478764.0000; val_optim_loss: 20478764.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9163; val_auprc_score: 0.8832; val_best_acc_score: 0.8533; val_best_f1_score: 0.8634; train_kl_reg_loss: 98574.2567; train_edge_recon_loss: 2782324.4924; train_gene_expr_recon_loss: 13755108.6061; train_masked_gp_l1_reg_loss: 107693.7550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46814.7181; train_chrom_access_recon_loss: 3363068.5303; train_global_loss: 20153584.3333; train_optim_loss: 20153584.3333; val_kl_reg_loss: 97373.3770; val_edge_recon_loss: 2774594.6250; val_gene_expr_recon_loss: 14060627.0000; val_masked_gp_l1_reg_loss: 108276.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46308.6133; val_chrom_access_recon_loss: 3389436.9375; val_global_loss: 20476616.0000; val_optim_loss: 20476616.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9129; val_auprc_score: 0.8821; val_best_acc_score: 0.8514; val_best_f1_score: 0.8627; train_kl_reg_loss: 97475.2811; train_edge_recon_loss: 2787948.9962; train_gene_expr_recon_loss: 13711074.0303; train_masked_gp_l1_reg_loss: 108869.3421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45612.5578; train_chrom_access_recon_loss: 3350589.1250; train_global_loss: 20101569.3333; train_optim_loss: 20101569.3333; val_kl_reg_loss: 96363.2891; val_edge_recon_loss: 2812471.0000; val_gene_expr_recon_loss: 13978745.6250; val_masked_gp_l1_reg_loss: 109591.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45033.1953; val_chrom_access_recon_loss: 3376588.8125; val_global_loss: 20418794.2500; val_optim_loss: 20418794.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9168; val_auprc_score: 0.8882; val_best_acc_score: 0.8528; val_best_f1_score: 0.8631; train_kl_reg_loss: 96887.5548; train_edge_recon_loss: 2772178.2652; train_gene_expr_recon_loss: 13704335.9697; train_masked_gp_l1_reg_loss: 110013.7002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44559.0452; train_chrom_access_recon_loss: 3346857.2197; train_global_loss: 20074831.6667; train_optim_loss: 20074831.6667; val_kl_reg_loss: 91894.8955; val_edge_recon_loss: 2825847.0312; val_gene_expr_recon_loss: 13957106.3750; val_masked_gp_l1_reg_loss: 110665.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44315.6406; val_chrom_access_recon_loss: 3351746.0000; val_global_loss: 20381575.7500; val_optim_loss: 20381575.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9204; val_auprc_score: 0.8912; val_best_acc_score: 0.8541; val_best_f1_score: 0.8641; train_kl_reg_loss: 93590.3909; train_edge_recon_loss: 2765305.0795; train_gene_expr_recon_loss: 13667375.2273; train_masked_gp_l1_reg_loss: 109057.2383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38132.5679; train_chrom_access_recon_loss: 3341162.4773; train_global_loss: 20014623.1818; train_optim_loss: 20014623.1818; val_kl_reg_loss: 94147.2520; val_edge_recon_loss: 2799451.2188; val_gene_expr_recon_loss: 13852838.5000; val_masked_gp_l1_reg_loss: 108212.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35942.3555; val_chrom_access_recon_loss: 3333961.5625; val_global_loss: 20224553.0000; val_optim_loss: 20224553.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9111; val_auprc_score: 0.8814; val_best_acc_score: 0.8477; val_best_f1_score: 0.8578; train_kl_reg_loss: 95908.0555; train_edge_recon_loss: 2769101.1212; train_gene_expr_recon_loss: 13651630.0303; train_masked_gp_l1_reg_loss: 108037.2584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35622.3275; train_chrom_access_recon_loss: 3334060.5189; train_global_loss: 19994359.2727; train_optim_loss: 19994359.2727; val_kl_reg_loss: 95573.9570; val_edge_recon_loss: 2819272.0625; val_gene_expr_recon_loss: 13834914.0000; val_masked_gp_l1_reg_loss: 107941.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35431.4531; val_chrom_access_recon_loss: 3345972.4688; val_global_loss: 20239106.5000; val_optim_loss: 20239106.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9181; val_auprc_score: 0.8843; val_best_acc_score: 0.8595; val_best_f1_score: 0.8682; train_kl_reg_loss: 97678.0692; train_edge_recon_loss: 2762424.5833; train_gene_expr_recon_loss: 13645571.6212; train_masked_gp_l1_reg_loss: 107889.2370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35291.7796; train_chrom_access_recon_loss: 3334517.2462; train_global_loss: 19983372.3030; train_optim_loss: 19983372.3030; val_kl_reg_loss: 97534.2441; val_edge_recon_loss: 2782499.5000; val_gene_expr_recon_loss: 13936783.1250; val_masked_gp_l1_reg_loss: 107874.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35186.0547; val_chrom_access_recon_loss: 3376010.9375; val_global_loss: 20335888.0000; val_optim_loss: 20335888.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9140; val_auprc_score: 0.8819; val_best_acc_score: 0.8506; val_best_f1_score: 0.8592; train_kl_reg_loss: 97560.4635; train_edge_recon_loss: 2768626.5189; train_gene_expr_recon_loss: 13640411.7727; train_masked_gp_l1_reg_loss: 107882.0739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35085.7591; train_chrom_access_recon_loss: 3333307.6591; train_global_loss: 19982874.1212; train_optim_loss: 19982874.1212; val_kl_reg_loss: 96801.5361; val_edge_recon_loss: 2812258.2500; val_gene_expr_recon_loss: 13882162.5000; val_masked_gp_l1_reg_loss: 107905.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34991.5234; val_chrom_access_recon_loss: 3362575.8750; val_global_loss: 20296695.7500; val_optim_loss: 20296695.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9098; val_auprc_score: 0.8708; val_best_acc_score: 0.8512; val_best_f1_score: 0.8598; train_kl_reg_loss: 97883.9863; train_edge_recon_loss: 2767417.7689; train_gene_expr_recon_loss: 13655440.6515; train_masked_gp_l1_reg_loss: 107898.3756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34894.9255; train_chrom_access_recon_loss: 3334492.0606; train_global_loss: 19998027.6364; train_optim_loss: 19998027.6364; val_kl_reg_loss: 96872.9590; val_edge_recon_loss: 2811624.5000; val_gene_expr_recon_loss: 13887190.2500; val_masked_gp_l1_reg_loss: 107913.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34817.0352; val_chrom_access_recon_loss: 3348459.8438; val_global_loss: 20286879.5000; val_optim_loss: 20286879.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9145; val_auprc_score: 0.8796; val_best_acc_score: 0.8565; val_best_f1_score: 0.8651; train_kl_reg_loss: 97361.1997; train_edge_recon_loss: 2762714.3826; train_gene_expr_recon_loss: 13636204.8788; train_masked_gp_l1_reg_loss: 107743.3467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34218.4925; train_chrom_access_recon_loss: 3331993.8902; train_global_loss: 19970236.1212; train_optim_loss: 19970236.1212; val_kl_reg_loss: 96729.8232; val_edge_recon_loss: 2816807.0625; val_gene_expr_recon_loss: 13902660.3750; val_masked_gp_l1_reg_loss: 107630.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33992.1602; val_chrom_access_recon_loss: 3359253.9688; val_global_loss: 20317073.5000; val_optim_loss: 20317073.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9161; val_auprc_score: 0.8839; val_best_acc_score: 0.8544; val_best_f1_score: 0.8658; train_kl_reg_loss: 97358.6887; train_edge_recon_loss: 2766991.2652; train_gene_expr_recon_loss: 13640990.0303; train_masked_gp_l1_reg_loss: 107597.0291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33950.3254; train_chrom_access_recon_loss: 3330584.7992; train_global_loss: 19977472.0000; train_optim_loss: 19977472.0000; val_kl_reg_loss: 97070.0186; val_edge_recon_loss: 2782467.6250; val_gene_expr_recon_loss: 13963156.3750; val_masked_gp_l1_reg_loss: 107576.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33921.5195; val_chrom_access_recon_loss: 3365432.4375; val_global_loss: 20349624.5000; val_optim_loss: 20349624.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9127; val_auprc_score: 0.8746; val_best_acc_score: 0.8549; val_best_f1_score: 0.8655; train_kl_reg_loss: 101891.6908; train_edge_recon_loss: 2824215.9242; train_gene_expr_recon_loss: 13874728.3030; train_masked_gp_l1_reg_loss: 107483.7056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33827.2151; train_chrom_access_recon_loss: 3422925.3030; train_global_loss: 20365072.2424; train_optim_loss: 20365072.2424; val_kl_reg_loss: 63211.6699; val_edge_recon_loss: 2849857.2188; val_gene_expr_recon_loss: 13939931.7500; val_masked_gp_l1_reg_loss: 107380.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33719.7422; val_chrom_access_recon_loss: 3443759.9375; val_global_loss: 20437860.7500; val_optim_loss: 20437860.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9144; val_auprc_score: 0.8821; val_best_acc_score: 0.8528; val_best_f1_score: 0.8624; train_kl_reg_loss: 105121.1148; train_edge_recon_loss: 2828902.5909; train_gene_expr_recon_loss: 13733258.1818; train_masked_gp_l1_reg_loss: 107312.6977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33589.4036; train_chrom_access_recon_loss: 3409065.6742; train_global_loss: 20217249.7576; train_optim_loss: 20217249.7576; val_kl_reg_loss: 64423.9922; val_edge_recon_loss: 2890544.0938; val_gene_expr_recon_loss: 13958189.0000; val_masked_gp_l1_reg_loss: 107255.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33450.5586; val_chrom_access_recon_loss: 3462226.5625; val_global_loss: 20516089.5000; val_optim_loss: 20516089.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 49 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9140
val AUPRC score: 0.8842
val best accuracy score: 0.8520
val best F1 score: 0.8628
val target rna MSE score: 4.1358
val source rna MSE score: 3.1979
val target atac MSE score: 0.5231
val source atac MSE score: 0.1517
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
