[True]
Run timestamp: 07082023_174708_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8863; val_auprc_score: 0.8916; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 6802.0422; train_edge_recon_loss: 35595.1832; train_gene_expr_recon_loss: 647804.4097; train_masked_gp_l1_reg_loss: 8404.3804; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 797957.1806; train_global_loss: 1496563.2083; train_optim_loss: 1496563.2083; val_kl_reg_loss: 12443.0342; val_edge_recon_loss: 40650.7227; val_gene_expr_recon_loss: 578561.0000; val_masked_gp_l1_reg_loss: 6565.9219; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 784088.0625; val_global_loss: 1422308.7500; val_optim_loss: 1422308.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8816; val_auprc_score: 0.8751; val_best_acc_score: 0.5156; val_best_f1_score: 0.6736; train_kl_reg_loss: 19298.5576; train_edge_recon_loss: 38512.9787; train_gene_expr_recon_loss: 554885.3472; train_masked_gp_l1_reg_loss: 5957.0892; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 781236.4792; train_global_loss: 1399890.4583; train_optim_loss: 1399890.4583; val_kl_reg_loss: 21899.4023; val_edge_recon_loss: 40644.0430; val_gene_expr_recon_loss: 514477.5625; val_masked_gp_l1_reg_loss: 5519.4600; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 766760.3125; val_global_loss: 1349300.7500; val_optim_loss: 1349300.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8883; val_auprc_score: 0.8836; val_best_acc_score: 0.5150; val_best_f1_score: 0.6733; train_kl_reg_loss: 25294.4707; train_edge_recon_loss: 39086.8459; train_gene_expr_recon_loss: 506485.3715; train_masked_gp_l1_reg_loss: 5636.6639; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 769358.6806; train_global_loss: 1345862.0139; train_optim_loss: 1345862.0139; val_kl_reg_loss: 24831.5234; val_edge_recon_loss: 40643.1094; val_gene_expr_recon_loss: 484434.6250; val_masked_gp_l1_reg_loss: 5776.2139; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753458.5000; val_global_loss: 1309144.0000; val_optim_loss: 1309144.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8877; val_auprc_score: 0.8792; val_best_acc_score: 0.5371; val_best_f1_score: 0.6827; train_kl_reg_loss: 26483.1395; train_edge_recon_loss: 39185.1580; train_gene_expr_recon_loss: 479359.0417; train_masked_gp_l1_reg_loss: 5736.8072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 758561.7778; train_global_loss: 1309325.9306; train_optim_loss: 1309325.9306; val_kl_reg_loss: 24519.0234; val_edge_recon_loss: 40628.0117; val_gene_expr_recon_loss: 466058.1562; val_masked_gp_l1_reg_loss: 5669.9277; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744518.6875; val_global_loss: 1281393.7500; val_optim_loss: 1281393.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8856; val_auprc_score: 0.8766; val_best_acc_score: 0.5536; val_best_f1_score: 0.6894; train_kl_reg_loss: 26699.7776; train_edge_recon_loss: 39214.7465; train_gene_expr_recon_loss: 464513.6111; train_masked_gp_l1_reg_loss: 5634.6136; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744326.3611; train_global_loss: 1280389.0694; train_optim_loss: 1280389.0694; val_kl_reg_loss: 25342.2070; val_edge_recon_loss: 40614.9727; val_gene_expr_recon_loss: 453338.0625; val_masked_gp_l1_reg_loss: 5572.6885; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 737033.8125; val_global_loss: 1261901.7500; val_optim_loss: 1261901.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8979; val_auprc_score: 0.8890; val_best_acc_score: 0.5993; val_best_f1_score: 0.7110; train_kl_reg_loss: 27517.4418; train_edge_recon_loss: 39261.3003; train_gene_expr_recon_loss: 453995.2396; train_masked_gp_l1_reg_loss: 5536.8743; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738303.7361; train_global_loss: 1264614.5972; train_optim_loss: 1264614.5972; val_kl_reg_loss: 26626.2676; val_edge_recon_loss: 40589.8594; val_gene_expr_recon_loss: 443820.9375; val_masked_gp_l1_reg_loss: 5487.5415; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730346.0000; val_global_loss: 1246870.6250; val_optim_loss: 1246870.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8976; val_auprc_score: 0.8884; val_best_acc_score: 0.6679; val_best_f1_score: 0.7468; train_kl_reg_loss: 28757.7307; train_edge_recon_loss: 39326.2535; train_gene_expr_recon_loss: 444289.5486; train_masked_gp_l1_reg_loss: 5461.9973; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730129.4444; train_global_loss: 1247964.9583; train_optim_loss: 1247964.9583; val_kl_reg_loss: 28664.8125; val_edge_recon_loss: 40552.2930; val_gene_expr_recon_loss: 435721.4375; val_masked_gp_l1_reg_loss: 5426.1514; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 724300.1875; val_global_loss: 1234664.8750; val_optim_loss: 1234664.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8965; val_auprc_score: 0.8873; val_best_acc_score: 0.7330; val_best_f1_score: 0.7831; train_kl_reg_loss: 29925.3691; train_edge_recon_loss: 39372.2361; train_gene_expr_recon_loss: 438936.0799; train_masked_gp_l1_reg_loss: 5409.6389; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724050.1597; train_global_loss: 1237693.4861; train_optim_loss: 1237693.4861; val_kl_reg_loss: 28872.6406; val_edge_recon_loss: 40485.5508; val_gene_expr_recon_loss: 430456.2500; val_masked_gp_l1_reg_loss: 5386.8486; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 719313.0625; val_global_loss: 1224514.3750; val_optim_loss: 1224514.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9031; val_auprc_score: 0.8958; val_best_acc_score: 0.7691; val_best_f1_score: 0.8038; train_kl_reg_loss: 30757.7248; train_edge_recon_loss: 39373.5729; train_gene_expr_recon_loss: 429645.4583; train_masked_gp_l1_reg_loss: 5380.1004; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718476.8819; train_global_loss: 1223633.7361; train_optim_loss: 1223633.7361; val_kl_reg_loss: 30572.4727; val_edge_recon_loss: 40411.8633; val_gene_expr_recon_loss: 424902.3750; val_masked_gp_l1_reg_loss: 5368.4526; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714283.7500; val_global_loss: 1215538.8750; val_optim_loss: 1215538.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9076; val_auprc_score: 0.9015; val_best_acc_score: 0.7940; val_best_f1_score: 0.8183; train_kl_reg_loss: 31569.2854; train_edge_recon_loss: 39363.7938; train_gene_expr_recon_loss: 427494.4097; train_masked_gp_l1_reg_loss: 5372.8437; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 717303.1458; train_global_loss: 1221103.4861; train_optim_loss: 1221103.4861; val_kl_reg_loss: 29407.7324; val_edge_recon_loss: 40351.5977; val_gene_expr_recon_loss: 421936.3125; val_masked_gp_l1_reg_loss: 5373.5469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710935.1875; val_global_loss: 1208004.3750; val_optim_loss: 1208004.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9139; val_auprc_score: 0.9057; val_best_acc_score: 0.8270; val_best_f1_score: 0.8406; train_kl_reg_loss: 31412.2726; train_edge_recon_loss: 39305.7843; train_gene_expr_recon_loss: 423087.6146; train_masked_gp_l1_reg_loss: 5380.1763; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711028.3472; train_global_loss: 1210214.1806; train_optim_loss: 1210214.1806; val_kl_reg_loss: 28875.9375; val_edge_recon_loss: 40289.7266; val_gene_expr_recon_loss: 418685.5625; val_masked_gp_l1_reg_loss: 5382.0112; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 708250.6875; val_global_loss: 1201483.8750; val_optim_loss: 1201483.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9204; val_auprc_score: 0.9122; val_best_acc_score: 0.8448; val_best_f1_score: 0.8534; train_kl_reg_loss: 30997.3349; train_edge_recon_loss: 39267.7895; train_gene_expr_recon_loss: 419558.6840; train_masked_gp_l1_reg_loss: 5395.4175; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710580.7431; train_global_loss: 1205799.9722; train_optim_loss: 1205799.9722; val_kl_reg_loss: 29190.9570; val_edge_recon_loss: 40230.6445; val_gene_expr_recon_loss: 415552.5000; val_masked_gp_l1_reg_loss: 5403.0234; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705232.0000; val_global_loss: 1195609.1250; val_optim_loss: 1195609.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9239; val_auprc_score: 0.9109; val_best_acc_score: 0.8592; val_best_f1_score: 0.8638; train_kl_reg_loss: 30738.7776; train_edge_recon_loss: 39208.7101; train_gene_expr_recon_loss: 418310.7674; train_masked_gp_l1_reg_loss: 5409.7262; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 709117.4653; train_global_loss: 1202785.4444; train_optim_loss: 1202785.4444; val_kl_reg_loss: 29619.6328; val_edge_recon_loss: 40172.6562; val_gene_expr_recon_loss: 412829.4375; val_masked_gp_l1_reg_loss: 5415.3398; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702562.2500; val_global_loss: 1190599.2500; val_optim_loss: 1190599.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9343; val_auprc_score: 0.9247; val_best_acc_score: 0.8654; val_best_f1_score: 0.8673; train_kl_reg_loss: 30407.0143; train_edge_recon_loss: 39160.6107; train_gene_expr_recon_loss: 414550.7465; train_masked_gp_l1_reg_loss: 5427.2733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704182.7292; train_global_loss: 1193728.3889; train_optim_loss: 1193728.3889; val_kl_reg_loss: 29006.2637; val_edge_recon_loss: 40120.5547; val_gene_expr_recon_loss: 410962.3438; val_masked_gp_l1_reg_loss: 5434.3896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700642.8125; val_global_loss: 1186166.3750; val_optim_loss: 1186166.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9372; val_auprc_score: 0.9287; val_best_acc_score: 0.8661; val_best_f1_score: 0.8656; train_kl_reg_loss: 30044.5267; train_edge_recon_loss: 39102.3160; train_gene_expr_recon_loss: 412685.4861; train_masked_gp_l1_reg_loss: 5444.3910; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699485.2083; train_global_loss: 1186761.9306; train_optim_loss: 1186761.9306; val_kl_reg_loss: 27836.8926; val_edge_recon_loss: 40060.6133; val_gene_expr_recon_loss: 409801.8125; val_masked_gp_l1_reg_loss: 5452.4829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 698538.0625; val_global_loss: 1181689.8750; val_optim_loss: 1181689.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9392; val_auprc_score: 0.9302; val_best_acc_score: 0.8658; val_best_f1_score: 0.8635; train_kl_reg_loss: 29684.3945; train_edge_recon_loss: 39047.0729; train_gene_expr_recon_loss: 414745.4583; train_masked_gp_l1_reg_loss: 5461.5911; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 701535.3681; train_global_loss: 1190473.8750; train_optim_loss: 1190473.8750; val_kl_reg_loss: 27508.6328; val_edge_recon_loss: 39976.9375; val_gene_expr_recon_loss: 408447.8125; val_masked_gp_l1_reg_loss: 5472.8184; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696463.8125; val_global_loss: 1177870.0000; val_optim_loss: 1177870.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9458; val_auprc_score: 0.9381; val_best_acc_score: 0.8700; val_best_f1_score: 0.8652; train_kl_reg_loss: 29419.3895; train_edge_recon_loss: 38990.2283; train_gene_expr_recon_loss: 413748.5208; train_masked_gp_l1_reg_loss: 5488.5912; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 701644.8264; train_global_loss: 1189291.5556; train_optim_loss: 1189291.5556; val_kl_reg_loss: 26596.7246; val_edge_recon_loss: 39910.0859; val_gene_expr_recon_loss: 407641.3125; val_masked_gp_l1_reg_loss: 5495.3027; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694789.0000; val_global_loss: 1174432.5000; val_optim_loss: 1174432.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9436; val_auprc_score: 0.9330; val_best_acc_score: 0.8654; val_best_f1_score: 0.8603; train_kl_reg_loss: 29059.9164; train_edge_recon_loss: 38939.6675; train_gene_expr_recon_loss: 409485.6389; train_masked_gp_l1_reg_loss: 5508.8028; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695360.2083; train_global_loss: 1178354.2500; train_optim_loss: 1178354.2500; val_kl_reg_loss: 26237.9375; val_edge_recon_loss: 39843.6914; val_gene_expr_recon_loss: 406305.6875; val_masked_gp_l1_reg_loss: 5513.5962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693055.3125; val_global_loss: 1170956.2500; val_optim_loss: 1170956.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9461; val_auprc_score: 0.9354; val_best_acc_score: 0.8647; val_best_f1_score: 0.8586; train_kl_reg_loss: 28716.1287; train_edge_recon_loss: 38904.5069; train_gene_expr_recon_loss: 410188.0938; train_masked_gp_l1_reg_loss: 5526.3812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698062.2569; train_global_loss: 1181397.3889; train_optim_loss: 1181397.3889; val_kl_reg_loss: 26391.8867; val_edge_recon_loss: 39818.5742; val_gene_expr_recon_loss: 404708.0938; val_masked_gp_l1_reg_loss: 5535.6597; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 690983.6875; val_global_loss: 1167437.8750; val_optim_loss: 1167437.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9481; val_auprc_score: 0.9385; val_best_acc_score: 0.8638; val_best_f1_score: 0.8558; train_kl_reg_loss: 28325.2253; train_edge_recon_loss: 38852.4219; train_gene_expr_recon_loss: 407380.6944; train_masked_gp_l1_reg_loss: 5546.7669; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694214.5139; train_global_loss: 1174319.6111; train_optim_loss: 1174319.6111; val_kl_reg_loss: 26156.2422; val_edge_recon_loss: 39778.7305; val_gene_expr_recon_loss: 403591.7188; val_masked_gp_l1_reg_loss: 5546.7158; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689221.7500; val_global_loss: 1164295.1250; val_optim_loss: 1164295.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9529; val_auprc_score: 0.9463; val_best_acc_score: 0.8645; val_best_f1_score: 0.8552; train_kl_reg_loss: 27937.9944; train_edge_recon_loss: 38811.4861; train_gene_expr_recon_loss: 408211.2986; train_masked_gp_l1_reg_loss: 5557.7226; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690871.7431; train_global_loss: 1171390.2361; train_optim_loss: 1171390.2361; val_kl_reg_loss: 26531.4375; val_edge_recon_loss: 39764.7422; val_gene_expr_recon_loss: 402025.9375; val_masked_gp_l1_reg_loss: 5565.5117; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687368.8750; val_global_loss: 1161256.5000; val_optim_loss: 1161256.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9540; val_auprc_score: 0.9443; val_best_acc_score: 0.8630; val_best_f1_score: 0.8518; train_kl_reg_loss: 27726.4501; train_edge_recon_loss: 38780.0421; train_gene_expr_recon_loss: 406696.6910; train_masked_gp_l1_reg_loss: 5577.5654; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691873.5972; train_global_loss: 1170654.3472; train_optim_loss: 1170654.3472; val_kl_reg_loss: 25410.0156; val_edge_recon_loss: 39682.5312; val_gene_expr_recon_loss: 401774.4375; val_masked_gp_l1_reg_loss: 5583.0181; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686409.0000; val_global_loss: 1158859.0000; val_optim_loss: 1158859.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9545; val_auprc_score: 0.9485; val_best_acc_score: 0.8585; val_best_f1_score: 0.8551; train_kl_reg_loss: 27191.0111; train_edge_recon_loss: 38734.5942; train_gene_expr_recon_loss: 402627.1736; train_masked_gp_l1_reg_loss: 5600.4950; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686454.2292; train_global_loss: 1160607.5139; train_optim_loss: 1160607.5139; val_kl_reg_loss: 25400.5430; val_edge_recon_loss: 39651.7891; val_gene_expr_recon_loss: 400750.3125; val_masked_gp_l1_reg_loss: 5602.7500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685094.0625; val_global_loss: 1156499.5000; val_optim_loss: 1156499.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9567; val_auprc_score: 0.9497; val_best_acc_score: 0.8560; val_best_f1_score: 0.8585; train_kl_reg_loss: 26972.5243; train_edge_recon_loss: 38704.1606; train_gene_expr_recon_loss: 403383.7882; train_masked_gp_l1_reg_loss: 5610.2752; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687020.6111; train_global_loss: 1161691.3611; train_optim_loss: 1161691.3611; val_kl_reg_loss: 25562.1562; val_edge_recon_loss: 39645.4023; val_gene_expr_recon_loss: 399661.9375; val_masked_gp_l1_reg_loss: 5619.6230; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 683250.0625; val_global_loss: 1153739.2500; val_optim_loss: 1153739.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9592; val_auprc_score: 0.9544; val_best_acc_score: 0.8525; val_best_f1_score: 0.8621; train_kl_reg_loss: 26622.5167; train_edge_recon_loss: 38671.7969; train_gene_expr_recon_loss: 402013.3576; train_masked_gp_l1_reg_loss: 5631.9527; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684282.0417; train_global_loss: 1157221.6806; train_optim_loss: 1157221.6806; val_kl_reg_loss: 24953.1406; val_edge_recon_loss: 39600.4453; val_gene_expr_recon_loss: 399039.6875; val_masked_gp_l1_reg_loss: 5635.2295; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 681957.5625; val_global_loss: 1151186.0000; val_optim_loss: 1151186.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9491; val_auprc_score: 0.9394; val_best_acc_score: 0.8596; val_best_f1_score: 0.8721; train_kl_reg_loss: 24473.1910; train_edge_recon_loss: 40222.1549; train_gene_expr_recon_loss: 417511.0868; train_masked_gp_l1_reg_loss: 5664.4114; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697354.3681; train_global_loss: 1185225.2222; train_optim_loss: 1185225.2222; val_kl_reg_loss: 20386.4160; val_edge_recon_loss: 40435.7891; val_gene_expr_recon_loss: 412197.3750; val_masked_gp_l1_reg_loss: 5681.5869; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694652.2500; val_global_loss: 1173353.3750; val_optim_loss: 1173353.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9466; val_auprc_score: 0.9410; val_best_acc_score: 0.8623; val_best_f1_score: 0.8733; train_kl_reg_loss: 21906.1079; train_edge_recon_loss: 40334.0169; train_gene_expr_recon_loss: 415424.3507; train_masked_gp_l1_reg_loss: 5676.7628; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699109.0833; train_global_loss: 1182450.3194; train_optim_loss: 1182450.3194; val_kl_reg_loss: 18833.7383; val_edge_recon_loss: 40408.1289; val_gene_expr_recon_loss: 411260.8438; val_masked_gp_l1_reg_loss: 5661.1895; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694164.0625; val_global_loss: 1170328.0000; val_optim_loss: 1170328.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9472; val_auprc_score: 0.9437; val_best_acc_score: 0.8739; val_best_f1_score: 0.8810; train_kl_reg_loss: 20628.1621; train_edge_recon_loss: 40269.3346; train_gene_expr_recon_loss: 412904.7778; train_masked_gp_l1_reg_loss: 5650.2700; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696683.8333; train_global_loss: 1176136.3750; train_optim_loss: 1176136.3750; val_kl_reg_loss: 18253.1797; val_edge_recon_loss: 40333.4688; val_gene_expr_recon_loss: 410344.3750; val_masked_gp_l1_reg_loss: 5630.9858; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693370.0625; val_global_loss: 1167932.1250; val_optim_loss: 1167932.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9517; val_auprc_score: 0.9462; val_best_acc_score: 0.8802; val_best_f1_score: 0.8853; train_kl_reg_loss: 19967.1547; train_edge_recon_loss: 40192.5122; train_gene_expr_recon_loss: 412027.2431; train_masked_gp_l1_reg_loss: 5618.9408; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695674.8333; train_global_loss: 1173480.6806; train_optim_loss: 1173480.6806; val_kl_reg_loss: 18586.0625; val_edge_recon_loss: 40275.9141; val_gene_expr_recon_loss: 408892.9375; val_masked_gp_l1_reg_loss: 5601.8413; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692251.2500; val_global_loss: 1165608.0000; val_optim_loss: 1165608.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9474; val_auprc_score: 0.9401; val_best_acc_score: 0.8724; val_best_f1_score: 0.8785; train_kl_reg_loss: 19767.7743; train_edge_recon_loss: 40170.5773; train_gene_expr_recon_loss: 411505.8924; train_masked_gp_l1_reg_loss: 5564.8942; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696879.7222; train_global_loss: 1173888.8611; train_optim_loss: 1173888.8611; val_kl_reg_loss: 18310.5781; val_edge_recon_loss: 40275.9883; val_gene_expr_recon_loss: 408964.3750; val_masked_gp_l1_reg_loss: 5532.3931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692098.3750; val_global_loss: 1165181.7500; val_optim_loss: 1165181.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9542; val_auprc_score: 0.9523; val_best_acc_score: 0.8845; val_best_f1_score: 0.8887; train_kl_reg_loss: 19660.8939; train_edge_recon_loss: 40163.6306; train_gene_expr_recon_loss: 411168.6840; train_masked_gp_l1_reg_loss: 5523.5247; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695393.8125; train_global_loss: 1171910.5417; train_optim_loss: 1171910.5417; val_kl_reg_loss: 18299.8926; val_edge_recon_loss: 40264.3594; val_gene_expr_recon_loss: 408847.0000; val_masked_gp_l1_reg_loss: 5509.3452; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692313.4375; val_global_loss: 1165234.0000; val_optim_loss: 1165234.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9536; val_auprc_score: 0.9520; val_best_acc_score: 0.8818; val_best_f1_score: 0.8865; train_kl_reg_loss: 19610.4546; train_edge_recon_loss: 40163.0078; train_gene_expr_recon_loss: 413659.1979; train_masked_gp_l1_reg_loss: 5501.7091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695509.1597; train_global_loss: 1174443.5139; train_optim_loss: 1174443.5139; val_kl_reg_loss: 18168.8711; val_edge_recon_loss: 40267.8086; val_gene_expr_recon_loss: 408822.2500; val_masked_gp_l1_reg_loss: 5493.1807; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692213.6875; val_global_loss: 1164965.7500; val_optim_loss: 1164965.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9548; val_auprc_score: 0.9513; val_best_acc_score: 0.8848; val_best_f1_score: 0.8890; train_kl_reg_loss: 19502.0892; train_edge_recon_loss: 40167.5434; train_gene_expr_recon_loss: 409569.0486; train_masked_gp_l1_reg_loss: 5488.5185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693895.9444; train_global_loss: 1168623.1389; train_optim_loss: 1168623.1389; val_kl_reg_loss: 18206.3633; val_edge_recon_loss: 40260.5312; val_gene_expr_recon_loss: 408685.0000; val_masked_gp_l1_reg_loss: 5483.1611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692149.3125; val_global_loss: 1164784.3750; val_optim_loss: 1164784.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 27 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9570
val AUPRC score: 0.9496
val best accuracy score: 0.8932
val best F1 score: 0.8962
val target rna MSE score: 0.4502
val source rna MSE score: 0.2339
val target atac MSE score: 0.1338
val source atac MSE score: 0.0174
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
