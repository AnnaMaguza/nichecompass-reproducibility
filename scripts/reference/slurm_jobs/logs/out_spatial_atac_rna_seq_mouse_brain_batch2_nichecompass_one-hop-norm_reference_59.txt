[True]
Run timestamp: 07082023_190749_59.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_59']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8885; val_auprc_score: 0.9034; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 18600.2638; train_edge_recon_loss: 349751.9861; train_gene_expr_recon_loss: 1360456.6806; train_masked_gp_l1_reg_loss: 8382.8031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119492.0938; train_chrom_access_recon_loss: 3479817.5278; train_global_loss: 5336501.3056; train_optim_loss: 5336501.3056; val_kl_reg_loss: 3826.1338; val_edge_recon_loss: 406515.1562; val_gene_expr_recon_loss: 1127067.7500; val_masked_gp_l1_reg_loss: 6603.3911; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117139.6484; val_chrom_access_recon_loss: 1577663.3750; val_global_loss: 3238815.5000; val_optim_loss: 3238815.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8924; val_auprc_score: 0.9045; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 3616.2135; train_edge_recon_loss: 349493.8819; train_gene_expr_recon_loss: 1056313.7014; train_masked_gp_l1_reg_loss: 6131.9924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115769.5634; train_chrom_access_recon_loss: 1501161.8333; train_global_loss: 3032487.1667; train_optim_loss: 3032487.1667; val_kl_reg_loss: 4848.6924; val_edge_recon_loss: 406574.9688; val_gene_expr_recon_loss: 993851.6250; val_masked_gp_l1_reg_loss: 5922.2749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114139.9062; val_chrom_access_recon_loss: 1487165.5000; val_global_loss: 3012503.0000; val_optim_loss: 3012503.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9001; val_auprc_score: 0.9162; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7062.2232; train_edge_recon_loss: 351992.8472; train_gene_expr_recon_loss: 950682.2361; train_masked_gp_l1_reg_loss: 6240.8226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112909.4479; train_chrom_access_recon_loss: 1446365.3333; train_global_loss: 2875252.9444; train_optim_loss: 2875252.9444; val_kl_reg_loss: 10060.8281; val_edge_recon_loss: 406602.5312; val_gene_expr_recon_loss: 888794.1250; val_masked_gp_l1_reg_loss: 6629.5972; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111387.8906; val_chrom_access_recon_loss: 1436881.6250; val_global_loss: 2860356.5000; val_optim_loss: 2860356.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8968; val_auprc_score: 0.9081; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12902.5289; train_edge_recon_loss: 356296.3958; train_gene_expr_recon_loss: 852292.0972; train_masked_gp_l1_reg_loss: 6797.5973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110145.7422; train_chrom_access_recon_loss: 1401565.9444; train_global_loss: 2740000.3611; train_optim_loss: 2740000.3611; val_kl_reg_loss: 15853.6797; val_edge_recon_loss: 406608.5312; val_gene_expr_recon_loss: 813068.5625; val_masked_gp_l1_reg_loss: 6960.4487; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108543.0625; val_chrom_access_recon_loss: 1399990.3750; val_global_loss: 2751024.5000; val_optim_loss: 2751024.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8922; val_auprc_score: 0.9075; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17050.3123; train_edge_recon_loss: 358722.1806; train_gene_expr_recon_loss: 794867.5208; train_masked_gp_l1_reg_loss: 7051.8220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107148.0842; train_chrom_access_recon_loss: 1376580.0278; train_global_loss: 2661419.9722; train_optim_loss: 2661419.9722; val_kl_reg_loss: 17156.3789; val_edge_recon_loss: 406605.5000; val_gene_expr_recon_loss: 768462.1250; val_masked_gp_l1_reg_loss: 7128.9136; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105318.8594; val_chrom_access_recon_loss: 1373406.6250; val_global_loss: 2678078.5000; val_optim_loss: 2678078.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8854; val_auprc_score: 0.8981; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 17949.0938; train_edge_recon_loss: 359289.1215; train_gene_expr_recon_loss: 759326.2917; train_masked_gp_l1_reg_loss: 7170.2975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103723.8116; train_chrom_access_recon_loss: 1351139.9722; train_global_loss: 2598598.5278; train_optim_loss: 2598598.5278; val_kl_reg_loss: 18720.6309; val_edge_recon_loss: 406598.3750; val_gene_expr_recon_loss: 743161.5000; val_masked_gp_l1_reg_loss: 7194.4751; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101661.0000; val_chrom_access_recon_loss: 1357373.7500; val_global_loss: 2634709.7500; val_optim_loss: 2634709.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8706; val_auprc_score: 0.8851; val_best_acc_score: 0.5028; val_best_f1_score: 0.6679; train_kl_reg_loss: 19831.2975; train_edge_recon_loss: 360011.7431; train_gene_expr_recon_loss: 733983.0486; train_masked_gp_l1_reg_loss: 7197.4253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99923.9965; train_chrom_access_recon_loss: 1337717.6250; train_global_loss: 2558665.1111; train_optim_loss: 2558665.1111; val_kl_reg_loss: 19811.1895; val_edge_recon_loss: 406586.1562; val_gene_expr_recon_loss: 725822.8750; val_masked_gp_l1_reg_loss: 7171.2627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97710.8750; val_chrom_access_recon_loss: 1348207.7500; val_global_loss: 2605310.0000; val_optim_loss: 2605310.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8775; val_auprc_score: 0.8915; val_best_acc_score: 0.5105; val_best_f1_score: 0.6712; train_kl_reg_loss: 20370.4466; train_edge_recon_loss: 360107.2847; train_gene_expr_recon_loss: 719924.3681; train_masked_gp_l1_reg_loss: 7140.9730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95896.9080; train_chrom_access_recon_loss: 1328227.2361; train_global_loss: 2531667.1944; train_optim_loss: 2531667.1944; val_kl_reg_loss: 20602.8340; val_edge_recon_loss: 406550.2812; val_gene_expr_recon_loss: 713445.6250; val_masked_gp_l1_reg_loss: 7099.1885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93615.2969; val_chrom_access_recon_loss: 1341672.1250; val_global_loss: 2582985.5000; val_optim_loss: 2582985.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8740; val_auprc_score: 0.8761; val_best_acc_score: 0.5162; val_best_f1_score: 0.6726; train_kl_reg_loss: 21024.5859; train_edge_recon_loss: 360061.9618; train_gene_expr_recon_loss: 711289.2083; train_masked_gp_l1_reg_loss: 7079.0828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91780.7960; train_chrom_access_recon_loss: 1327904.9028; train_global_loss: 2519140.5278; train_optim_loss: 2519140.5278; val_kl_reg_loss: 21008.7324; val_edge_recon_loss: 406411.1562; val_gene_expr_recon_loss: 701742.3750; val_masked_gp_l1_reg_loss: 7044.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89484.8828; val_chrom_access_recon_loss: 1335986.3750; val_global_loss: 2561677.7500; val_optim_loss: 2561677.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8544; val_auprc_score: 0.8496; val_best_acc_score: 0.5799; val_best_f1_score: 0.7007; train_kl_reg_loss: 21935.7858; train_edge_recon_loss: 359543.1076; train_gene_expr_recon_loss: 700238.2569; train_masked_gp_l1_reg_loss: 7028.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87645.6953; train_chrom_access_recon_loss: 1324585.4583; train_global_loss: 2500976.9444; train_optim_loss: 2500976.9444; val_kl_reg_loss: 19429.0938; val_edge_recon_loss: 405952.5938; val_gene_expr_recon_loss: 691902.0625; val_masked_gp_l1_reg_loss: 6990.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85344.7734; val_chrom_access_recon_loss: 1331158.0000; val_global_loss: 2540777.0000; val_optim_loss: 2540777.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8350; val_auprc_score: 0.8288; val_best_acc_score: 0.6450; val_best_f1_score: 0.7310; train_kl_reg_loss: 21877.9054; train_edge_recon_loss: 359936.2361; train_gene_expr_recon_loss: 687778.4792; train_masked_gp_l1_reg_loss: 6974.9559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83518.0964; train_chrom_access_recon_loss: 1314752.4028; train_global_loss: 2474838.0278; train_optim_loss: 2474838.0278; val_kl_reg_loss: 22461.3320; val_edge_recon_loss: 405414.5000; val_gene_expr_recon_loss: 682077.6250; val_masked_gp_l1_reg_loss: 6938.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81245.5391; val_chrom_access_recon_loss: 1327008.5000; val_global_loss: 2525146.2500; val_optim_loss: 2525146.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8142; val_auprc_score: 0.8085; val_best_acc_score: 0.6897; val_best_f1_score: 0.7490; train_kl_reg_loss: 22815.9826; train_edge_recon_loss: 359283.8819; train_gene_expr_recon_loss: 678531.2014; train_masked_gp_l1_reg_loss: 6922.3628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79458.1311; train_chrom_access_recon_loss: 1308587.6528; train_global_loss: 2455599.1389; train_optim_loss: 2455599.1389; val_kl_reg_loss: 20591.8477; val_edge_recon_loss: 404478.0625; val_gene_expr_recon_loss: 676159.5000; val_masked_gp_l1_reg_loss: 6889.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77247.6953; val_chrom_access_recon_loss: 1323373.8750; val_global_loss: 2508740.2500; val_optim_loss: 2508740.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8093; val_auprc_score: 0.7978; val_best_acc_score: 0.7229; val_best_f1_score: 0.7581; train_kl_reg_loss: 22699.7357; train_edge_recon_loss: 359129.9132; train_gene_expr_recon_loss: 672134.7292; train_masked_gp_l1_reg_loss: 6878.6600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75525.7873; train_chrom_access_recon_loss: 1308157.2778; train_global_loss: 2444526.0833; train_optim_loss: 2444526.0833; val_kl_reg_loss: 21116.4062; val_edge_recon_loss: 402837.2812; val_gene_expr_recon_loss: 671522.8125; val_masked_gp_l1_reg_loss: 6854.1123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73402.0547; val_chrom_access_recon_loss: 1319796.6250; val_global_loss: 2495529.2500; val_optim_loss: 2495529.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8070; val_auprc_score: 0.7959; val_best_acc_score: 0.7278; val_best_f1_score: 0.7425; train_kl_reg_loss: 22444.0428; train_edge_recon_loss: 358663.9132; train_gene_expr_recon_loss: 666902.0417; train_masked_gp_l1_reg_loss: 6851.3294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71760.5599; train_chrom_access_recon_loss: 1302986.5556; train_global_loss: 2429608.4167; train_optim_loss: 2429608.4167; val_kl_reg_loss: 22165.5820; val_edge_recon_loss: 401109.9375; val_gene_expr_recon_loss: 667298.9375; val_masked_gp_l1_reg_loss: 6836.3384; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69739.3125; val_chrom_access_recon_loss: 1316647.3750; val_global_loss: 2483797.5000; val_optim_loss: 2483797.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7961; val_auprc_score: 0.7809; val_best_acc_score: 0.7115; val_best_f1_score: 0.7429; train_kl_reg_loss: 22245.3598; train_edge_recon_loss: 357910.9271; train_gene_expr_recon_loss: 664778.4722; train_masked_gp_l1_reg_loss: 6839.1555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68179.9262; train_chrom_access_recon_loss: 1301320.2083; train_global_loss: 2421274.0556; train_optim_loss: 2421274.0556; val_kl_reg_loss: 21853.3906; val_edge_recon_loss: 398976.3438; val_gene_expr_recon_loss: 664435.6250; val_masked_gp_l1_reg_loss: 6823.8159; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66260.6562; val_chrom_access_recon_loss: 1313901.1250; val_global_loss: 2472251.0000; val_optim_loss: 2472251.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8073; val_auprc_score: 0.7886; val_best_acc_score: 0.7148; val_best_f1_score: 0.7615; train_kl_reg_loss: 21915.1979; train_edge_recon_loss: 356578.9062; train_gene_expr_recon_loss: 661258.7917; train_masked_gp_l1_reg_loss: 6824.7506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64784.9167; train_chrom_access_recon_loss: 1298443.0694; train_global_loss: 2409805.6111; train_optim_loss: 2409805.6111; val_kl_reg_loss: 20648.9727; val_edge_recon_loss: 394540.3438; val_gene_expr_recon_loss: 662356.4375; val_masked_gp_l1_reg_loss: 6815.9033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62969.2930; val_chrom_access_recon_loss: 1311486.6250; val_global_loss: 2458817.5000; val_optim_loss: 2458817.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8194; val_auprc_score: 0.8012; val_best_acc_score: 0.7440; val_best_f1_score: 0.7692; train_kl_reg_loss: 21435.3859; train_edge_recon_loss: 354914.0382; train_gene_expr_recon_loss: 660115.5903; train_masked_gp_l1_reg_loss: 6818.1802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61579.5122; train_chrom_access_recon_loss: 1298886.4028; train_global_loss: 2403749.0833; train_optim_loss: 2403749.0833; val_kl_reg_loss: 20563.0977; val_edge_recon_loss: 389056.2188; val_gene_expr_recon_loss: 660085.7500; val_masked_gp_l1_reg_loss: 6813.0498; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59872.7266; val_chrom_access_recon_loss: 1308706.2500; val_global_loss: 2445097.0000; val_optim_loss: 2445097.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8325; val_auprc_score: 0.8242; val_best_acc_score: 0.7515; val_best_f1_score: 0.7700; train_kl_reg_loss: 21124.0979; train_edge_recon_loss: 352721.2778; train_gene_expr_recon_loss: 659917.3750; train_masked_gp_l1_reg_loss: 6820.9900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58569.4219; train_chrom_access_recon_loss: 1297523.3194; train_global_loss: 2396676.5278; train_optim_loss: 2396676.5278; val_kl_reg_loss: 20180.7266; val_edge_recon_loss: 380400.7500; val_gene_expr_recon_loss: 658650.0000; val_masked_gp_l1_reg_loss: 6821.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56972.2070; val_chrom_access_recon_loss: 1306880.3750; val_global_loss: 2429905.5000; val_optim_loss: 2429905.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8440; val_auprc_score: 0.8371; val_best_acc_score: 0.7563; val_best_f1_score: 0.7752; train_kl_reg_loss: 20506.4145; train_edge_recon_loss: 348505.3056; train_gene_expr_recon_loss: 659771.7708; train_masked_gp_l1_reg_loss: 6837.7296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55751.8325; train_chrom_access_recon_loss: 1290073.2639; train_global_loss: 2381446.3611; train_optim_loss: 2381446.3611; val_kl_reg_loss: 19900.2266; val_edge_recon_loss: 365106.1250; val_gene_expr_recon_loss: 658067.3750; val_masked_gp_l1_reg_loss: 6841.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54253.8594; val_chrom_access_recon_loss: 1305387.6250; val_global_loss: 2409557.0000; val_optim_loss: 2409557.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8543; val_auprc_score: 0.8442; val_best_acc_score: 0.7661; val_best_f1_score: 0.7841; train_kl_reg_loss: 20971.9481; train_edge_recon_loss: 340263.1667; train_gene_expr_recon_loss: 658287.6042; train_masked_gp_l1_reg_loss: 6863.6982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53111.0608; train_chrom_access_recon_loss: 1288670.1111; train_global_loss: 2368167.6111; train_optim_loss: 2368167.6111; val_kl_reg_loss: 21474.9746; val_edge_recon_loss: 343580.1250; val_gene_expr_recon_loss: 658099.1250; val_masked_gp_l1_reg_loss: 6877.0415; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51708.7891; val_chrom_access_recon_loss: 1303993.1250; val_global_loss: 2385733.2500; val_optim_loss: 2385733.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8667; val_auprc_score: 0.8604; val_best_acc_score: 0.7759; val_best_f1_score: 0.7927; train_kl_reg_loss: 24039.9503; train_edge_recon_loss: 327566.6597; train_gene_expr_recon_loss: 660864.1250; train_masked_gp_l1_reg_loss: 6903.5677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50645.0712; train_chrom_access_recon_loss: 1290524.0139; train_global_loss: 2360543.3333; train_optim_loss: 2360543.3333; val_kl_reg_loss: 27000.1172; val_edge_recon_loss: 325167.5938; val_gene_expr_recon_loss: 656911.8750; val_masked_gp_l1_reg_loss: 6936.1353; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49343.5938; val_chrom_access_recon_loss: 1302272.0000; val_global_loss: 2367631.5000; val_optim_loss: 2367631.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8797; val_auprc_score: 0.8675; val_best_acc_score: 0.7935; val_best_f1_score: 0.8047; train_kl_reg_loss: 29460.4399; train_edge_recon_loss: 318098.9062; train_gene_expr_recon_loss: 658410.8889; train_masked_gp_l1_reg_loss: 6966.4409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48357.4236; train_chrom_access_recon_loss: 1287967.7500; train_global_loss: 2349261.8056; train_optim_loss: 2349261.8056; val_kl_reg_loss: 29545.8750; val_edge_recon_loss: 316534.3750; val_gene_expr_recon_loss: 656490.0625; val_masked_gp_l1_reg_loss: 7003.8794; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47143.4688; val_chrom_access_recon_loss: 1300410.0000; val_global_loss: 2357127.5000; val_optim_loss: 2357127.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9000; val_auprc_score: 0.8844; val_best_acc_score: 0.8170; val_best_f1_score: 0.8262; train_kl_reg_loss: 29458.3696; train_edge_recon_loss: 313668.4201; train_gene_expr_recon_loss: 655246.3333; train_masked_gp_l1_reg_loss: 7038.3962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46221.2574; train_chrom_access_recon_loss: 1289475.8056; train_global_loss: 2341108.6111; train_optim_loss: 2341108.6111; val_kl_reg_loss: 27838.0273; val_edge_recon_loss: 312523.4688; val_gene_expr_recon_loss: 655192.7500; val_masked_gp_l1_reg_loss: 7065.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45081.8945; val_chrom_access_recon_loss: 1297840.1250; val_global_loss: 2345542.0000; val_optim_loss: 2345542.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9082; val_auprc_score: 0.8917; val_best_acc_score: 0.8296; val_best_f1_score: 0.8383; train_kl_reg_loss: 27994.6226; train_edge_recon_loss: 309632.9097; train_gene_expr_recon_loss: 652303.8958; train_masked_gp_l1_reg_loss: 7090.3542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44212.4410; train_chrom_access_recon_loss: 1279947.3333; train_global_loss: 2321181.5000; train_optim_loss: 2321181.5000; val_kl_reg_loss: 27587.1094; val_edge_recon_loss: 306371.2188; val_gene_expr_recon_loss: 654612.6250; val_masked_gp_l1_reg_loss: 7109.1748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43143.4375; val_chrom_access_recon_loss: 1296774.0000; val_global_loss: 2335597.5000; val_optim_loss: 2335597.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9201; val_auprc_score: 0.9037; val_best_acc_score: 0.8475; val_best_f1_score: 0.8551; train_kl_reg_loss: 28598.9664; train_edge_recon_loss: 304766.3229; train_gene_expr_recon_loss: 654147.4722; train_masked_gp_l1_reg_loss: 7127.6627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42332.4727; train_chrom_access_recon_loss: 1284079.9722; train_global_loss: 2321052.8611; train_optim_loss: 2321052.8611; val_kl_reg_loss: 28272.0684; val_edge_recon_loss: 304764.9375; val_gene_expr_recon_loss: 654037.7500; val_masked_gp_l1_reg_loss: 7144.7520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41326.5156; val_chrom_access_recon_loss: 1294080.0000; val_global_loss: 2329626.0000; val_optim_loss: 2329626.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9267; val_auprc_score: 0.9130; val_best_acc_score: 0.8554; val_best_f1_score: 0.8612; train_kl_reg_loss: 26561.3077; train_edge_recon_loss: 306959.7465; train_gene_expr_recon_loss: 926875.4167; train_masked_gp_l1_reg_loss: 7250.4655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40441.7318; train_chrom_access_recon_loss: 1353309.7500; train_global_loss: 2661398.3889; train_optim_loss: 2661398.3889; val_kl_reg_loss: 17701.8477; val_edge_recon_loss: 306932.0000; val_gene_expr_recon_loss: 920149.5000; val_masked_gp_l1_reg_loss: 7425.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39273.3125; val_chrom_access_recon_loss: 1365742.0000; val_global_loss: 2657224.2500; val_optim_loss: 2657224.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9312; val_auprc_score: 0.9153; val_best_acc_score: 0.8581; val_best_f1_score: 0.8644; train_kl_reg_loss: 25629.5890; train_edge_recon_loss: 301732.6215; train_gene_expr_recon_loss: 917813.1458; train_masked_gp_l1_reg_loss: 7596.9027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38305.9970; train_chrom_access_recon_loss: 1346702.0000; train_global_loss: 2637780.2500; train_optim_loss: 2637780.2500; val_kl_reg_loss: 19604.6289; val_edge_recon_loss: 298631.3750; val_gene_expr_recon_loss: 916531.5625; val_masked_gp_l1_reg_loss: 7796.8354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37104.0312; val_chrom_access_recon_loss: 1363586.8750; val_global_loss: 2643255.2500; val_optim_loss: 2643255.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9355; val_auprc_score: 0.9180; val_best_acc_score: 0.8666; val_best_f1_score: 0.8718; train_kl_reg_loss: 25536.6144; train_edge_recon_loss: 298576.9965; train_gene_expr_recon_loss: 910770.0694; train_masked_gp_l1_reg_loss: 7944.3961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36174.1736; train_chrom_access_recon_loss: 1339305.4444; train_global_loss: 2618307.6667; train_optim_loss: 2618307.6667; val_kl_reg_loss: 20784.6230; val_edge_recon_loss: 296002.9688; val_gene_expr_recon_loss: 911226.9375; val_masked_gp_l1_reg_loss: 8107.6167; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35038.2148; val_chrom_access_recon_loss: 1361353.3750; val_global_loss: 2632513.7500; val_optim_loss: 2632513.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9353; val_auprc_score: 0.9175; val_best_acc_score: 0.8653; val_best_f1_score: 0.8724; train_kl_reg_loss: 25071.1667; train_edge_recon_loss: 295926.1736; train_gene_expr_recon_loss: 912785.2847; train_masked_gp_l1_reg_loss: 8219.2430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34173.6910; train_chrom_access_recon_loss: 1348172.9583; train_global_loss: 2624348.5278; train_optim_loss: 2624348.5278; val_kl_reg_loss: 21978.7715; val_edge_recon_loss: 295067.8438; val_gene_expr_recon_loss: 906655.6250; val_masked_gp_l1_reg_loss: 8348.0771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33119.8398; val_chrom_access_recon_loss: 1359365.7500; val_global_loss: 2624536.0000; val_optim_loss: 2624536.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9306; val_auprc_score: 0.9104; val_best_acc_score: 0.8616; val_best_f1_score: 0.8672; train_kl_reg_loss: 24914.0794; train_edge_recon_loss: 295402.1910; train_gene_expr_recon_loss: 907986.7222; train_masked_gp_l1_reg_loss: 8325.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33002.6411; train_chrom_access_recon_loss: 1349602.6111; train_global_loss: 2619233.6111; train_optim_loss: 2619233.6111; val_kl_reg_loss: 22104.7305; val_edge_recon_loss: 297709.4062; val_gene_expr_recon_loss: 906212.3750; val_masked_gp_l1_reg_loss: 8303.9072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32860.4062; val_chrom_access_recon_loss: 1358869.2500; val_global_loss: 2626060.0000; val_optim_loss: 2626060.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9355; val_auprc_score: 0.9205; val_best_acc_score: 0.8654; val_best_f1_score: 0.8717; train_kl_reg_loss: 24878.3411; train_edge_recon_loss: 295477.7014; train_gene_expr_recon_loss: 907799.3194; train_masked_gp_l1_reg_loss: 8301.7572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32759.8049; train_chrom_access_recon_loss: 1343224.4444; train_global_loss: 2612441.4167; train_optim_loss: 2612441.4167; val_kl_reg_loss: 21988.1836; val_edge_recon_loss: 298124.9062; val_gene_expr_recon_loss: 905673.5000; val_masked_gp_l1_reg_loss: 8296.9082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32633.1250; val_chrom_access_recon_loss: 1358589.7500; val_global_loss: 2625306.5000; val_optim_loss: 2625306.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9370; val_auprc_score: 0.9174; val_best_acc_score: 0.8703; val_best_f1_score: 0.8754; train_kl_reg_loss: 24533.3989; train_edge_recon_loss: 296226.0278; train_gene_expr_recon_loss: 909058.2847; train_masked_gp_l1_reg_loss: 8296.3050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32537.2626; train_chrom_access_recon_loss: 1343381.6528; train_global_loss: 2614032.9167; train_optim_loss: 2614032.9167; val_kl_reg_loss: 21801.4023; val_edge_recon_loss: 296469.1562; val_gene_expr_recon_loss: 905589.7500; val_masked_gp_l1_reg_loss: 8296.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32419.0723; val_chrom_access_recon_loss: 1358563.6250; val_global_loss: 2623139.7500; val_optim_loss: 2623139.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9313; val_auprc_score: 0.9154; val_best_acc_score: 0.8615; val_best_f1_score: 0.8664; train_kl_reg_loss: 24415.9366; train_edge_recon_loss: 295710.8229; train_gene_expr_recon_loss: 907248.8681; train_masked_gp_l1_reg_loss: 8299.5385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32327.1489; train_chrom_access_recon_loss: 1346021.3472; train_global_loss: 2614023.6389; train_optim_loss: 2614023.6389; val_kl_reg_loss: 21816.9395; val_edge_recon_loss: 299926.1250; val_gene_expr_recon_loss: 905193.1250; val_masked_gp_l1_reg_loss: 8303.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32215.3887; val_chrom_access_recon_loss: 1358279.1250; val_global_loss: 2625734.0000; val_optim_loss: 2625734.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9266
val AUPRC score: 0.9142
val best accuracy score: 0.8534
val best F1 score: 0.8585
val target rna MSE score: 3.8256
val source rna MSE score: 3.1624
val target atac MSE score: 0.1382
val source atac MSE score: 0.0206
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
