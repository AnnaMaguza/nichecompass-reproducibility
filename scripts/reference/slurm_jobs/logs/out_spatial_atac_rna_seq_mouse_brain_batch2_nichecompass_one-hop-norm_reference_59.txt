[True]
Run timestamp: 29072023_112600_59.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_59']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8947; val_auprc_score: 0.9086; val_best_acc_score: 0.5198; val_best_f1_score: 0.6751; train_kl_reg_loss: 3184.9797; train_edge_recon_loss: 3468741.8611; train_gene_expr_recon_loss: 815552.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1866452.3750; train_global_loss: 6153931.4444; train_optim_loss: 6153931.4444; val_kl_reg_loss: 1228.0093; val_edge_recon_loss: 4061665.5000; val_gene_expr_recon_loss: 688745.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1717378.8750; val_global_loss: 6469018.0000; val_optim_loss: 6469018.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9005; val_auprc_score: 0.9088; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2516.3788; train_edge_recon_loss: 3469360.7500; train_gene_expr_recon_loss: 672189.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1777483.3750; train_global_loss: 5921550.2778; train_optim_loss: 5921550.2778; val_kl_reg_loss: 2780.3057; val_edge_recon_loss: 4064868.0000; val_gene_expr_recon_loss: 651961.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1723104.5000; val_global_loss: 6442714.0000; val_optim_loss: 6442714.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9137; val_auprc_score: 0.9233; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 3262.2288; train_edge_recon_loss: 3470865.3333; train_gene_expr_recon_loss: 659748.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1751074.8472; train_global_loss: 5884950.7778; train_optim_loss: 5884950.7778; val_kl_reg_loss: 4408.6104; val_edge_recon_loss: 4064986.0000; val_gene_expr_recon_loss: 645589.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1693989.0000; val_global_loss: 6408973.5000; val_optim_loss: 6408973.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9105; val_auprc_score: 0.9210; val_best_acc_score: 0.5084; val_best_f1_score: 0.6703; train_kl_reg_loss: 7842.8963; train_edge_recon_loss: 3475761.5833; train_gene_expr_recon_loss: 635033.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1727265.5000; train_global_loss: 5845903.5000; train_optim_loss: 5845903.5000; val_kl_reg_loss: 9645.0850; val_edge_recon_loss: 4064719.7500; val_gene_expr_recon_loss: 609264.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1684491.0000; val_global_loss: 6368120.0000; val_optim_loss: 6368120.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9028; val_auprc_score: 0.9088; val_best_acc_score: 0.5199; val_best_f1_score: 0.6750; train_kl_reg_loss: 11605.2406; train_edge_recon_loss: 3476139.6944; train_gene_expr_recon_loss: 597292.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1704731.3750; train_global_loss: 5789768.5556; train_optim_loss: 5789768.5556; val_kl_reg_loss: 12565.4160; val_edge_recon_loss: 4063871.0000; val_gene_expr_recon_loss: 579848.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1673822.7500; val_global_loss: 6330108.0000; val_optim_loss: 6330108.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8984; val_auprc_score: 0.9049; val_best_acc_score: 0.5551; val_best_f1_score: 0.6909; train_kl_reg_loss: 13752.9166; train_edge_recon_loss: 3477359.5000; train_gene_expr_recon_loss: 577149.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1704610.5139; train_global_loss: 5772872.1667; train_optim_loss: 5772872.1667; val_kl_reg_loss: 13660.6504; val_edge_recon_loss: 4062082.7500; val_gene_expr_recon_loss: 557943.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1657569.8750; val_global_loss: 6291257.5000; val_optim_loss: 6291257.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8893; val_auprc_score: 0.8905; val_best_acc_score: 0.6078; val_best_f1_score: 0.7169; train_kl_reg_loss: 16634.8188; train_edge_recon_loss: 3478481.8056; train_gene_expr_recon_loss: 554075.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1687543.2639; train_global_loss: 5736735.1667; train_optim_loss: 5736735.1667; val_kl_reg_loss: 13591.1416; val_edge_recon_loss: 4059772.0000; val_gene_expr_recon_loss: 535566.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1641757.2500; val_global_loss: 6250687.0000; val_optim_loss: 6250687.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8754; val_auprc_score: 0.8721; val_best_acc_score: 0.6788; val_best_f1_score: 0.7539; train_kl_reg_loss: 17018.5089; train_edge_recon_loss: 3478889.8056; train_gene_expr_recon_loss: 527401.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1672071.5417; train_global_loss: 5695381.6111; train_optim_loss: 5695381.6111; val_kl_reg_loss: 14635.2422; val_edge_recon_loss: 4055167.7500; val_gene_expr_recon_loss: 514155.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1629321.2500; val_global_loss: 6213280.0000; val_optim_loss: 6213280.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8605; val_auprc_score: 0.8494; val_best_acc_score: 0.7410; val_best_f1_score: 0.7876; train_kl_reg_loss: 17949.8206; train_edge_recon_loss: 3477878.2222; train_gene_expr_recon_loss: 507531.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1647905.8194; train_global_loss: 5651265.4444; train_optim_loss: 5651265.4444; val_kl_reg_loss: 13614.0664; val_edge_recon_loss: 4045489.7500; val_gene_expr_recon_loss: 496496.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1609018.2500; val_global_loss: 6164619.0000; val_optim_loss: 6164619.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8597; val_auprc_score: 0.8455; val_best_acc_score: 0.7878; val_best_f1_score: 0.8066; train_kl_reg_loss: 18163.8218; train_edge_recon_loss: 3477089.1667; train_gene_expr_recon_loss: 490000.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1637894.6389; train_global_loss: 5623148.1111; train_optim_loss: 5623148.1111; val_kl_reg_loss: 13751.5938; val_edge_recon_loss: 4018199.2500; val_gene_expr_recon_loss: 478998.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1597249.5000; val_global_loss: 6108198.5000; val_optim_loss: 6108198.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8599; val_auprc_score: 0.8381; val_best_acc_score: 0.7692; val_best_f1_score: 0.8049; train_kl_reg_loss: 16945.8041; train_edge_recon_loss: 3472943.3333; train_gene_expr_recon_loss: 472924.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1621839.0694; train_global_loss: 5584652.4444; train_optim_loss: 5584652.4444; val_kl_reg_loss: 13248.2900; val_edge_recon_loss: 3910925.7500; val_gene_expr_recon_loss: 464490.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1585329.0000; val_global_loss: 5973994.0000; val_optim_loss: 5973994.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8622; val_auprc_score: 0.8335; val_best_acc_score: 0.7856; val_best_f1_score: 0.8085; train_kl_reg_loss: 12653.4591; train_edge_recon_loss: 3431423.1667; train_gene_expr_recon_loss: 462521.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1614898.3056; train_global_loss: 5521496.5000; train_optim_loss: 5521496.5000; val_kl_reg_loss: 7123.7959; val_edge_recon_loss: 3340700.2500; val_gene_expr_recon_loss: 462939.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1589180.2500; val_global_loss: 5399943.0000; val_optim_loss: 5399943.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8546; val_auprc_score: 0.8424; val_best_acc_score: 0.7604; val_best_f1_score: 0.7861; train_kl_reg_loss: 9058.1158; train_edge_recon_loss: 3101961.0278; train_gene_expr_recon_loss: 470826.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1629980.3194; train_global_loss: 5211826.0556; train_optim_loss: 5211826.0556; val_kl_reg_loss: 16818.3574; val_edge_recon_loss: 2913925.0000; val_gene_expr_recon_loss: 469833.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1617278.8750; val_global_loss: 5017855.5000; val_optim_loss: 5017855.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8486; val_auprc_score: 0.8281; val_best_acc_score: 0.7600; val_best_f1_score: 0.7918; train_kl_reg_loss: 24883.7168; train_edge_recon_loss: 2900451.1389; train_gene_expr_recon_loss: 465596.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1624437.3333; train_global_loss: 5015368.7778; train_optim_loss: 5015368.7778; val_kl_reg_loss: 34183.3086; val_edge_recon_loss: 2893155.2500; val_gene_expr_recon_loss: 450458.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1582660.0000; val_global_loss: 4960457.0000; val_optim_loss: 4960457.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8454; val_auprc_score: 0.8207; val_best_acc_score: 0.7584; val_best_f1_score: 0.7863; train_kl_reg_loss: 39452.5490; train_edge_recon_loss: 2869663.5278; train_gene_expr_recon_loss: 451095.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1611582.5972; train_global_loss: 4971794.6111; train_optim_loss: 4971794.6111; val_kl_reg_loss: 39295.4531; val_edge_recon_loss: 2924522.5000; val_gene_expr_recon_loss: 439304.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1568771.8750; val_global_loss: 4971894.0000; val_optim_loss: 4971894.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8643; val_auprc_score: 0.8414; val_best_acc_score: 0.7728; val_best_f1_score: 0.7959; train_kl_reg_loss: 40987.7192; train_edge_recon_loss: 2875098.7778; train_gene_expr_recon_loss: 437309.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1589828.5417; train_global_loss: 4943224.1667; train_optim_loss: 4943224.1667; val_kl_reg_loss: 39015.4297; val_edge_recon_loss: 2869123.2500; val_gene_expr_recon_loss: 432246.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1564150.2500; val_global_loss: 4904535.0000; val_optim_loss: 4904535.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8731; val_auprc_score: 0.8494; val_best_acc_score: 0.7811; val_best_f1_score: 0.8005; train_kl_reg_loss: 37061.5282; train_edge_recon_loss: 2858773.2222; train_gene_expr_recon_loss: 433748.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1599288.2361; train_global_loss: 4928871.2222; train_optim_loss: 4928871.2222; val_kl_reg_loss: 34893.0430; val_edge_recon_loss: 2872618.7500; val_gene_expr_recon_loss: 430499.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1561241.0000; val_global_loss: 4899252.0000; val_optim_loss: 4899252.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8720; val_auprc_score: 0.8475; val_best_acc_score: 0.7858; val_best_f1_score: 0.8015; train_kl_reg_loss: 33259.7346; train_edge_recon_loss: 2862153.4722; train_gene_expr_recon_loss: 429709.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1590067.3472; train_global_loss: 4915190.6111; train_optim_loss: 4915190.6111; val_kl_reg_loss: 31618.1523; val_edge_recon_loss: 2845399.5000; val_gene_expr_recon_loss: 426438.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1556408.2500; val_global_loss: 4859864.0000; val_optim_loss: 4859864.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8651; val_auprc_score: 0.8424; val_best_acc_score: 0.7786; val_best_f1_score: 0.7943; train_kl_reg_loss: 32174.1309; train_edge_recon_loss: 2870390.2500; train_gene_expr_recon_loss: 425898.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1584842.1250; train_global_loss: 4913305.0000; train_optim_loss: 4913305.0000; val_kl_reg_loss: 29974.3828; val_edge_recon_loss: 2888109.7500; val_gene_expr_recon_loss: 421525.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549969.2500; val_global_loss: 4889579.0000; val_optim_loss: 4889579.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8704; val_auprc_score: 0.8454; val_best_acc_score: 0.7856; val_best_f1_score: 0.7968; train_kl_reg_loss: 31457.7504; train_edge_recon_loss: 2868929.3056; train_gene_expr_recon_loss: 422232.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1584744.9722; train_global_loss: 4907364.1667; train_optim_loss: 4907364.1667; val_kl_reg_loss: 30663.4805; val_edge_recon_loss: 2861504.0000; val_gene_expr_recon_loss: 417870.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544967.5000; val_global_loss: 4855005.0000; val_optim_loss: 4855005.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8726; val_auprc_score: 0.8415; val_best_acc_score: 0.7918; val_best_f1_score: 0.8022; train_kl_reg_loss: 30225.8444; train_edge_recon_loss: 2855618.2500; train_gene_expr_recon_loss: 417234.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1569401.8056; train_global_loss: 4872480.7778; train_optim_loss: 4872480.7778; val_kl_reg_loss: 29601.6738; val_edge_recon_loss: 2857155.7500; val_gene_expr_recon_loss: 415988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545582.3750; val_global_loss: 4848328.0000; val_optim_loss: 4848328.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8706; val_auprc_score: 0.8412; val_best_acc_score: 0.7940; val_best_f1_score: 0.8097; train_kl_reg_loss: 29368.9661; train_edge_recon_loss: 2833804.2222; train_gene_expr_recon_loss: 414119.0451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1569330.5694; train_global_loss: 4846622.7778; train_optim_loss: 4846622.7778; val_kl_reg_loss: 26013.7949; val_edge_recon_loss: 2838655.0000; val_gene_expr_recon_loss: 414782.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543500.3750; val_global_loss: 4822951.0000; val_optim_loss: 4822951.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8914; val_auprc_score: 0.8639; val_best_acc_score: 0.8200; val_best_f1_score: 0.8340; train_kl_reg_loss: 27199.0875; train_edge_recon_loss: 2808686.4444; train_gene_expr_recon_loss: 418859.5382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1572015.6250; train_global_loss: 4826760.6667; train_optim_loss: 4826760.6667; val_kl_reg_loss: 26046.5273; val_edge_recon_loss: 2811400.5000; val_gene_expr_recon_loss: 414633.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543417.7500; val_global_loss: 4795498.0000; val_optim_loss: 4795498.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9110; val_auprc_score: 0.8833; val_best_acc_score: 0.8473; val_best_f1_score: 0.8589; train_kl_reg_loss: 26662.1411; train_edge_recon_loss: 2770615.1944; train_gene_expr_recon_loss: 418821.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1577040.5000; train_global_loss: 4793139.7222; train_optim_loss: 4793139.7222; val_kl_reg_loss: 27103.8691; val_edge_recon_loss: 2779554.7500; val_gene_expr_recon_loss: 415255.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544765.2500; val_global_loss: 4766679.0000; val_optim_loss: 4766679.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9170; val_auprc_score: 0.8900; val_best_acc_score: 0.8545; val_best_f1_score: 0.8651; train_kl_reg_loss: 30469.6747; train_edge_recon_loss: 2752944.6944; train_gene_expr_recon_loss: 414603.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1572754.6667; train_global_loss: 4770772.5000; train_optim_loss: 4770772.5000; val_kl_reg_loss: 30599.2617; val_edge_recon_loss: 2734406.2500; val_gene_expr_recon_loss: 414403.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1542792.0000; val_global_loss: 4722201.0000; val_optim_loss: 4722201.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9213; val_auprc_score: 0.9005; val_best_acc_score: 0.8569; val_best_f1_score: 0.8672; train_kl_reg_loss: 34005.9073; train_edge_recon_loss: 2748281.6111; train_gene_expr_recon_loss: 427707.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1587038.8750; train_global_loss: 4797034.2778; train_optim_loss: 4797034.2778; val_kl_reg_loss: 15038.1445; val_edge_recon_loss: 2769484.7500; val_gene_expr_recon_loss: 418443.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549670.0000; val_global_loss: 4752637.0000; val_optim_loss: 4752637.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9264; val_auprc_score: 0.9026; val_best_acc_score: 0.8674; val_best_f1_score: 0.8752; train_kl_reg_loss: 37242.0035; train_edge_recon_loss: 2746066.1944; train_gene_expr_recon_loss: 420805.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1583310.9861; train_global_loss: 4787424.4444; train_optim_loss: 4787424.4444; val_kl_reg_loss: 15282.9258; val_edge_recon_loss: 2756061.5000; val_gene_expr_recon_loss: 415117.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1546774.0000; val_global_loss: 4733236.0000; val_optim_loss: 4733236.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9249; val_auprc_score: 0.9007; val_best_acc_score: 0.8596; val_best_f1_score: 0.8697; train_kl_reg_loss: 36214.3038; train_edge_recon_loss: 2742274.3333; train_gene_expr_recon_loss: 418723.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1577823.8889; train_global_loss: 4775035.6111; train_optim_loss: 4775035.6111; val_kl_reg_loss: 14977.9844; val_edge_recon_loss: 2774708.7500; val_gene_expr_recon_loss: 416010.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544652.5000; val_global_loss: 4750350.0000; val_optim_loss: 4750350.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9347; val_auprc_score: 0.9124; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 33515.3503; train_edge_recon_loss: 2732420.9167; train_gene_expr_recon_loss: 417369.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1573314.5417; train_global_loss: 4756620.6667; train_optim_loss: 4756620.6667; val_kl_reg_loss: 14796.1748; val_edge_recon_loss: 2727886.5000; val_gene_expr_recon_loss: 415506.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1541374.5000; val_global_loss: 4699564.0000; val_optim_loss: 4699564.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9375; val_auprc_score: 0.9183; val_best_acc_score: 0.8715; val_best_f1_score: 0.8783; train_kl_reg_loss: 32225.2266; train_edge_recon_loss: 2734022.0833; train_gene_expr_recon_loss: 414971.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1570449.5417; train_global_loss: 4751668.0556; train_optim_loss: 4751668.0556; val_kl_reg_loss: 15453.1250; val_edge_recon_loss: 2734153.5000; val_gene_expr_recon_loss: 412386.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539960.2500; val_global_loss: 4701953.0000; val_optim_loss: 4701953.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9356; val_auprc_score: 0.9143; val_best_acc_score: 0.8729; val_best_f1_score: 0.8800; train_kl_reg_loss: 31357.5098; train_edge_recon_loss: 2736643.0278; train_gene_expr_recon_loss: 412284.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1561270.7639; train_global_loss: 4741556.1111; train_optim_loss: 4741556.1111; val_kl_reg_loss: 15545.0117; val_edge_recon_loss: 2741440.5000; val_gene_expr_recon_loss: 411433.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537655.1250; val_global_loss: 4706074.5000; val_optim_loss: 4706074.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9404; val_auprc_score: 0.9203; val_best_acc_score: 0.8791; val_best_f1_score: 0.8857; train_kl_reg_loss: 29015.4703; train_edge_recon_loss: 2727770.6667; train_gene_expr_recon_loss: 412357.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1560344.2778; train_global_loss: 4729487.4444; train_optim_loss: 4729487.4444; val_kl_reg_loss: 15639.2773; val_edge_recon_loss: 2702393.5000; val_gene_expr_recon_loss: 411768.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537793.7500; val_global_loss: 4667595.0000; val_optim_loss: 4667595.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9471; val_auprc_score: 0.9282; val_best_acc_score: 0.8867; val_best_f1_score: 0.8906; train_kl_reg_loss: 27715.3854; train_edge_recon_loss: 2703643.1944; train_gene_expr_recon_loss: 412076.3264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1563370.3194; train_global_loss: 4706805.1667; train_optim_loss: 4706805.1667; val_kl_reg_loss: 15744.9082; val_edge_recon_loss: 2725868.5000; val_gene_expr_recon_loss: 409325.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536160.0000; val_global_loss: 4687099.5000; val_optim_loss: 4687099.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9446; val_auprc_score: 0.9269; val_best_acc_score: 0.8809; val_best_f1_score: 0.8880; train_kl_reg_loss: 26753.2114; train_edge_recon_loss: 2708019.4167; train_gene_expr_recon_loss: 410169.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556672.4306; train_global_loss: 4701614.0556; train_optim_loss: 4701614.0556; val_kl_reg_loss: 15814.8242; val_edge_recon_loss: 2720708.7500; val_gene_expr_recon_loss: 409369.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535263.1250; val_global_loss: 4681156.0000; val_optim_loss: 4681156.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9463; val_auprc_score: 0.9251; val_best_acc_score: 0.8887; val_best_f1_score: 0.8923; train_kl_reg_loss: 25414.1929; train_edge_recon_loss: 2704070.4167; train_gene_expr_recon_loss: 409043.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555914.1111; train_global_loss: 4694441.7778; train_optim_loss: 4694441.7778; val_kl_reg_loss: 16415.1504; val_edge_recon_loss: 2722902.2500; val_gene_expr_recon_loss: 410842.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537443.2500; val_global_loss: 4687603.0000; val_optim_loss: 4687603.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9542; val_auprc_score: 0.9378; val_best_acc_score: 0.8954; val_best_f1_score: 0.8980; train_kl_reg_loss: 23910.8956; train_edge_recon_loss: 2702506.1944; train_gene_expr_recon_loss: 407893.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557627.7222; train_global_loss: 4691938.7222; train_optim_loss: 4691938.7222; val_kl_reg_loss: 15925.8066; val_edge_recon_loss: 2718595.2500; val_gene_expr_recon_loss: 407060.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530100.0000; val_global_loss: 4671682.0000; val_optim_loss: 4671682.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9504; val_auprc_score: 0.9326; val_best_acc_score: 0.8901; val_best_f1_score: 0.8951; train_kl_reg_loss: 22927.4759; train_edge_recon_loss: 2705786.0833; train_gene_expr_recon_loss: 408961.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1560840.6111; train_global_loss: 4698515.3333; train_optim_loss: 4698515.3333; val_kl_reg_loss: 16131.6797; val_edge_recon_loss: 2718790.2500; val_gene_expr_recon_loss: 405706.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533243.0000; val_global_loss: 4673871.5000; val_optim_loss: 4673871.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9532; val_auprc_score: 0.9366; val_best_acc_score: 0.8941; val_best_f1_score: 0.8996; train_kl_reg_loss: 22911.9918; train_edge_recon_loss: 2703833.0000; train_gene_expr_recon_loss: 406845.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555238.7778; train_global_loss: 4688829.6667; train_optim_loss: 4688829.6667; val_kl_reg_loss: 15988.4219; val_edge_recon_loss: 2713396.2500; val_gene_expr_recon_loss: 405392.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531280.2500; val_global_loss: 4666057.5000; val_optim_loss: 4666057.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9545; val_auprc_score: 0.9375; val_best_acc_score: 0.8971; val_best_f1_score: 0.8996; train_kl_reg_loss: 22886.6118; train_edge_recon_loss: 2700873.0278; train_gene_expr_recon_loss: 406518.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547812.7083; train_global_loss: 4678091.2222; train_optim_loss: 4678091.2222; val_kl_reg_loss: 16327.8770; val_edge_recon_loss: 2717475.2500; val_gene_expr_recon_loss: 406072.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531824.5000; val_global_loss: 4671700.5000; val_optim_loss: 4671700.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9542; val_auprc_score: 0.9362; val_best_acc_score: 0.8934; val_best_f1_score: 0.8982; train_kl_reg_loss: 23120.2836; train_edge_recon_loss: 2699219.8333; train_gene_expr_recon_loss: 408194.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558451.4028; train_global_loss: 4688986.5000; train_optim_loss: 4688986.5000; val_kl_reg_loss: 16226.1904; val_edge_recon_loss: 2713253.7500; val_gene_expr_recon_loss: 405382.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529554.7500; val_global_loss: 4664417.5000; val_optim_loss: 4664417.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9520; val_auprc_score: 0.9330; val_best_acc_score: 0.8910; val_best_f1_score: 0.8962; train_kl_reg_loss: 22969.1387; train_edge_recon_loss: 2694625.0278; train_gene_expr_recon_loss: 409020.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1562274.9861; train_global_loss: 4688889.5000; train_optim_loss: 4688889.5000; val_kl_reg_loss: 16210.7207; val_edge_recon_loss: 2712240.2500; val_gene_expr_recon_loss: 405796.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531552.5000; val_global_loss: 4665799.5000; val_optim_loss: 4665799.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9515; val_auprc_score: 0.9322; val_best_acc_score: 0.8945; val_best_f1_score: 0.8980; train_kl_reg_loss: 22825.8663; train_edge_recon_loss: 2691704.9444; train_gene_expr_recon_loss: 407491.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1559160.9306; train_global_loss: 4681183.6111; train_optim_loss: 4681183.6111; val_kl_reg_loss: 16333.6152; val_edge_recon_loss: 2702151.7500; val_gene_expr_recon_loss: 405439.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531365.7500; val_global_loss: 4655291.0000; val_optim_loss: 4655291.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9493; val_auprc_score: 0.9287; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 22662.0011; train_edge_recon_loss: 2691016.0556; train_gene_expr_recon_loss: 403996.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547221.3611; train_global_loss: 4664895.4444; train_optim_loss: 4664895.4444; val_kl_reg_loss: 16286.5801; val_edge_recon_loss: 2701860.0000; val_gene_expr_recon_loss: 405564.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530601.0000; val_global_loss: 4654311.5000; val_optim_loss: 4654311.5000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9527; val_auprc_score: 0.9332; val_best_acc_score: 0.8941; val_best_f1_score: 0.8986; train_kl_reg_loss: 22642.0777; train_edge_recon_loss: 2693807.2222; train_gene_expr_recon_loss: 407342.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558725.9583; train_global_loss: 4682517.2778; train_optim_loss: 4682517.2778; val_kl_reg_loss: 16211.5127; val_edge_recon_loss: 2720305.2500; val_gene_expr_recon_loss: 405323.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528954.5000; val_global_loss: 4670794.5000; val_optim_loss: 4670794.5000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9548; val_auprc_score: 0.9363; val_best_acc_score: 0.8983; val_best_f1_score: 0.9033; train_kl_reg_loss: 22695.8244; train_edge_recon_loss: 2689922.6389; train_gene_expr_recon_loss: 407121.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1560059.4861; train_global_loss: 4679800.0000; train_optim_loss: 4679800.0000; val_kl_reg_loss: 16335.0391; val_edge_recon_loss: 2701719.7500; val_gene_expr_recon_loss: 405182.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526937.0000; val_global_loss: 4650174.0000; val_optim_loss: 4650174.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9572; val_auprc_score: 0.9423; val_best_acc_score: 0.8975; val_best_f1_score: 0.9026; train_kl_reg_loss: 22605.0046; train_edge_recon_loss: 2698473.1667; train_gene_expr_recon_loss: 406934.6007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556445.2361; train_global_loss: 4684458.0556; train_optim_loss: 4684458.0556; val_kl_reg_loss: 16282.8457; val_edge_recon_loss: 2693516.2500; val_gene_expr_recon_loss: 404610.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527842.5000; val_global_loss: 4642252.5000; val_optim_loss: 4642252.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9562; val_auprc_score: 0.9389; val_best_acc_score: 0.8998; val_best_f1_score: 0.9030; train_kl_reg_loss: 22525.4171; train_edge_recon_loss: 2688623.3056; train_gene_expr_recon_loss: 408182.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1562575.3333; train_global_loss: 4681907.1111; train_optim_loss: 4681907.1111; val_kl_reg_loss: 16313.8848; val_edge_recon_loss: 2704834.2500; val_gene_expr_recon_loss: 404266.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527247.1250; val_global_loss: 4652662.5000; val_optim_loss: 4652662.5000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9547; val_auprc_score: 0.9362; val_best_acc_score: 0.9008; val_best_f1_score: 0.9041; train_kl_reg_loss: 22361.6478; train_edge_recon_loss: 2696035.6389; train_gene_expr_recon_loss: 406445.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557374.6528; train_global_loss: 4682217.1111; train_optim_loss: 4682217.1111; val_kl_reg_loss: 16430.6133; val_edge_recon_loss: 2699039.5000; val_gene_expr_recon_loss: 405128.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530813.8750; val_global_loss: 4651412.5000; val_optim_loss: 4651412.5000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9576; val_auprc_score: 0.9375; val_best_acc_score: 0.9006; val_best_f1_score: 0.9053; train_kl_reg_loss: 22519.8548; train_edge_recon_loss: 2696632.7222; train_gene_expr_recon_loss: 407527.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556516.3889; train_global_loss: 4683196.2222; train_optim_loss: 4683196.2222; val_kl_reg_loss: 16529.1289; val_edge_recon_loss: 2694250.2500; val_gene_expr_recon_loss: 404491.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529691.2500; val_global_loss: 4644962.0000; val_optim_loss: 4644962.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9564; val_auprc_score: 0.9421; val_best_acc_score: 0.9002; val_best_f1_score: 0.9046; train_kl_reg_loss: 22199.7296; train_edge_recon_loss: 2681062.2222; train_gene_expr_recon_loss: 406540.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1553210.4028; train_global_loss: 4663013.2222; train_optim_loss: 4663013.2222; val_kl_reg_loss: 16356.3428; val_edge_recon_loss: 2696948.2500; val_gene_expr_recon_loss: 405442.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528974.7500; val_global_loss: 4647722.0000; val_optim_loss: 4647722.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9551; val_auprc_score: 0.9401; val_best_acc_score: 0.8979; val_best_f1_score: 0.9026; train_kl_reg_loss: 21901.9195; train_edge_recon_loss: 2698170.1944; train_gene_expr_recon_loss: 405975.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1548133.0833; train_global_loss: 4674181.2778; train_optim_loss: 4674181.2778; val_kl_reg_loss: 16309.8467; val_edge_recon_loss: 2694206.7500; val_gene_expr_recon_loss: 405201.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530277.0000; val_global_loss: 4645994.5000; val_optim_loss: 4645994.5000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9545; val_auprc_score: 0.9393; val_best_acc_score: 0.8940; val_best_f1_score: 0.8983; train_kl_reg_loss: 22012.7702; train_edge_recon_loss: 2693819.5556; train_gene_expr_recon_loss: 406294.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1559151.7778; train_global_loss: 4681278.3889; train_optim_loss: 4681278.3889; val_kl_reg_loss: 16334.5068; val_edge_recon_loss: 2718636.7500; val_gene_expr_recon_loss: 404715.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530011.2500; val_global_loss: 4669698.0000; val_optim_loss: 4669698.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9556; val_auprc_score: 0.9347; val_best_acc_score: 0.8996; val_best_f1_score: 0.9024; train_kl_reg_loss: 22051.4008; train_edge_recon_loss: 2689230.2778; train_gene_expr_recon_loss: 408158.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1552961.7083; train_global_loss: 4672401.5000; train_optim_loss: 4672401.5000; val_kl_reg_loss: 16446.6055; val_edge_recon_loss: 2706112.0000; val_gene_expr_recon_loss: 404432.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528351.5000; val_global_loss: 4655342.5000; val_optim_loss: 4655342.5000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9549; val_auprc_score: 0.9376; val_best_acc_score: 0.8999; val_best_f1_score: 0.9044; train_kl_reg_loss: 22173.9855; train_edge_recon_loss: 2691411.5556; train_gene_expr_recon_loss: 408441.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557936.5000; train_global_loss: 4679963.3889; train_optim_loss: 4679963.3889; val_kl_reg_loss: 16365.4102; val_edge_recon_loss: 2699791.7500; val_gene_expr_recon_loss: 404336.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527392.1250; val_global_loss: 4647886.0000; val_optim_loss: 4647886.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 19 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9515
val AUPRC score: 0.9344
val best accuracy score: 0.8917
val best F1 score: 0.8949
val target rna MSE score: 5.3265
val source rna MSE score: 1.6750
val target atac MSE score: 0.1203
val source atac MSE score: 0.0227
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
