[True]
Run timestamp: 09102023_231627_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7653; val_auprc_score: 0.7885; val_best_acc_score: 0.5331; val_best_f1_score: 0.6797; train_kl_reg_loss: 67054.0152; train_edge_recon_loss: 3513814.7595; train_gene_expr_recon_loss: 13373273.6870; train_masked_gp_l1_reg_loss: 87566.4040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1936922.8177; train_chrom_access_recon_loss: 6731376.0382; train_global_loss: 25710007.7557; train_optim_loss: 25710007.7557; val_kl_reg_loss: 96331.0240; val_edge_recon_loss: 4063187.7500; val_gene_expr_recon_loss: 12612988.2667; val_masked_gp_l1_reg_loss: 76127.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 442263.8750; val_chrom_access_recon_loss: 6506584.1333; val_global_loss: 23797482.4000; val_optim_loss: 23797482.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8205; val_auprc_score: 0.8331; val_best_acc_score: 0.7355; val_best_f1_score: 0.7293; train_kl_reg_loss: 82832.6191; train_edge_recon_loss: 3504317.2309; train_gene_expr_recon_loss: 12581635.7710; train_masked_gp_l1_reg_loss: 75325.9448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232378.6693; train_chrom_access_recon_loss: 6477547.2939; train_global_loss: 22954037.5573; train_optim_loss: 22954037.5573; val_kl_reg_loss: 77868.2589; val_edge_recon_loss: 4002981.2333; val_gene_expr_recon_loss: 12390932.8667; val_masked_gp_l1_reg_loss: 76594.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133252.1719; val_chrom_access_recon_loss: 6409563.5333; val_global_loss: 23091191.7333; val_optim_loss: 23091191.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8778; val_auprc_score: 0.8703; val_best_acc_score: 0.7908; val_best_f1_score: 0.7984; train_kl_reg_loss: 69140.9317; train_edge_recon_loss: 3240659.1412; train_gene_expr_recon_loss: 12455204.5649; train_masked_gp_l1_reg_loss: 85217.1433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106789.5716; train_chrom_access_recon_loss: 6404265.8511; train_global_loss: 22361277.1908; train_optim_loss: 22361277.1908; val_kl_reg_loss: 86605.3307; val_edge_recon_loss: 2998895.1000; val_gene_expr_recon_loss: 12278283.9333; val_masked_gp_l1_reg_loss: 93087.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91784.2969; val_chrom_access_recon_loss: 6338379.3333; val_global_loss: 21887035.7333; val_optim_loss: 21887035.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9184; val_auprc_score: 0.9048; val_best_acc_score: 0.8487; val_best_f1_score: 0.8567; train_kl_reg_loss: 92558.0965; train_edge_recon_loss: 2888329.1832; train_gene_expr_recon_loss: 12316099.3740; train_masked_gp_l1_reg_loss: 94111.8564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83417.4882; train_chrom_access_recon_loss: 6337597.6412; train_global_loss: 21812113.6794; train_optim_loss: 21812113.6794; val_kl_reg_loss: 95722.0859; val_edge_recon_loss: 2849274.3000; val_gene_expr_recon_loss: 12131912.1333; val_masked_gp_l1_reg_loss: 96225.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76983.4375; val_chrom_access_recon_loss: 6256512.9667; val_global_loss: 21506629.6000; val_optim_loss: 21506629.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9325; val_auprc_score: 0.9196; val_best_acc_score: 0.8610; val_best_f1_score: 0.8679; train_kl_reg_loss: 94612.4563; train_edge_recon_loss: 2830385.0057; train_gene_expr_recon_loss: 12189932.4656; train_masked_gp_l1_reg_loss: 97637.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73985.5252; train_chrom_access_recon_loss: 6274663.9695; train_global_loss: 21561216.6718; train_optim_loss: 21561216.6718; val_kl_reg_loss: 87033.7776; val_edge_recon_loss: 2829103.0000; val_gene_expr_recon_loss: 12068389.7333; val_masked_gp_l1_reg_loss: 99293.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72127.6797; val_chrom_access_recon_loss: 6211986.5667; val_global_loss: 21367933.8667; val_optim_loss: 21367933.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9341; val_auprc_score: 0.9167; val_best_acc_score: 0.8739; val_best_f1_score: 0.8810; train_kl_reg_loss: 91776.7607; train_edge_recon_loss: 2801974.1317; train_gene_expr_recon_loss: 12081350.1679; train_masked_gp_l1_reg_loss: 100484.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70276.2318; train_chrom_access_recon_loss: 6224012.0267; train_global_loss: 21369873.5573; train_optim_loss: 21369873.5573; val_kl_reg_loss: 93183.0328; val_edge_recon_loss: 2792110.2000; val_gene_expr_recon_loss: 12004532.0667; val_masked_gp_l1_reg_loss: 101843.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69592.4688; val_chrom_access_recon_loss: 6193676.8667; val_global_loss: 21254938.2667; val_optim_loss: 21254938.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9427; val_auprc_score: 0.9265; val_best_acc_score: 0.8783; val_best_f1_score: 0.8843; train_kl_reg_loss: 90319.0830; train_edge_recon_loss: 2784856.4943; train_gene_expr_recon_loss: 11990784.3282; train_masked_gp_l1_reg_loss: 102356.5290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67190.1316; train_chrom_access_recon_loss: 6190210.3435; train_global_loss: 21225716.9771; train_optim_loss: 21225716.9771; val_kl_reg_loss: 91166.7328; val_edge_recon_loss: 2787470.5667; val_gene_expr_recon_loss: 11923736.1333; val_masked_gp_l1_reg_loss: 103178.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65483.8359; val_chrom_access_recon_loss: 6186709.1333; val_global_loss: 21157745.6000; val_optim_loss: 21157745.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9442; val_auprc_score: 0.9338; val_best_acc_score: 0.8821; val_best_f1_score: 0.8886; train_kl_reg_loss: 89087.5649; train_edge_recon_loss: 2774069.5134; train_gene_expr_recon_loss: 11908652.0076; train_masked_gp_l1_reg_loss: 103262.9361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64415.4034; train_chrom_access_recon_loss: 6147835.5916; train_global_loss: 21087322.9618; train_optim_loss: 21087322.9618; val_kl_reg_loss: 89602.6177; val_edge_recon_loss: 2793471.9333; val_gene_expr_recon_loss: 11817078.8000; val_masked_gp_l1_reg_loss: 103512.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63319.8203; val_chrom_access_recon_loss: 6145576.4667; val_global_loss: 21012562.8000; val_optim_loss: 21012562.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9483; val_auprc_score: 0.9351; val_best_acc_score: 0.8872; val_best_f1_score: 0.8906; train_kl_reg_loss: 86998.6542; train_edge_recon_loss: 2753260.1527; train_gene_expr_recon_loss: 11838649.2824; train_masked_gp_l1_reg_loss: 103968.2585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62095.4055; train_chrom_access_recon_loss: 6119244.9847; train_global_loss: 20964216.7176; train_optim_loss: 20964216.7176; val_kl_reg_loss: 84698.3141; val_edge_recon_loss: 2759534.3667; val_gene_expr_recon_loss: 11741836.7333; val_masked_gp_l1_reg_loss: 104731.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61844.4766; val_chrom_access_recon_loss: 6109569.9667; val_global_loss: 20862214.1333; val_optim_loss: 20862214.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9501; val_auprc_score: 0.9328; val_best_acc_score: 0.8918; val_best_f1_score: 0.8977; train_kl_reg_loss: 83740.1957; train_edge_recon_loss: 2746999.4351; train_gene_expr_recon_loss: 11771451.8550; train_masked_gp_l1_reg_loss: 105174.8062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60868.1687; train_chrom_access_recon_loss: 6078176.2443; train_global_loss: 20846410.7023; train_optim_loss: 20846410.7023; val_kl_reg_loss: 81802.8943; val_edge_recon_loss: 2736445.9167; val_gene_expr_recon_loss: 11700700.0000; val_masked_gp_l1_reg_loss: 105441.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59956.1016; val_chrom_access_recon_loss: 6073676.7000; val_global_loss: 20758023.3333; val_optim_loss: 20758023.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9518; val_auprc_score: 0.9372; val_best_acc_score: 0.8938; val_best_f1_score: 0.8981; train_kl_reg_loss: 83809.8381; train_edge_recon_loss: 2728397.5038; train_gene_expr_recon_loss: 11720975.0076; train_masked_gp_l1_reg_loss: 106056.9352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59747.9540; train_chrom_access_recon_loss: 6050558.1908; train_global_loss: 20749545.4962; train_optim_loss: 20749545.4962; val_kl_reg_loss: 80866.4214; val_edge_recon_loss: 2745235.8167; val_gene_expr_recon_loss: 11635520.7333; val_masked_gp_l1_reg_loss: 106678.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59579.8984; val_chrom_access_recon_loss: 6028858.5333; val_global_loss: 20656739.4667; val_optim_loss: 20656739.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9563; val_auprc_score: 0.9459; val_best_acc_score: 0.8968; val_best_f1_score: 0.9014; train_kl_reg_loss: 82659.8312; train_edge_recon_loss: 2734506.8340; train_gene_expr_recon_loss: 11678478.9313; train_masked_gp_l1_reg_loss: 106859.8409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59195.1892; train_chrom_access_recon_loss: 6024930.3473; train_global_loss: 20686630.9160; train_optim_loss: 20686630.9160; val_kl_reg_loss: 82680.3422; val_edge_recon_loss: 2741728.4167; val_gene_expr_recon_loss: 11633678.9333; val_masked_gp_l1_reg_loss: 107083.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58825.6055; val_chrom_access_recon_loss: 6041594.1333; val_global_loss: 20665590.9333; val_optim_loss: 20665590.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9580; val_auprc_score: 0.9479; val_best_acc_score: 0.8971; val_best_f1_score: 0.9016; train_kl_reg_loss: 81309.2617; train_edge_recon_loss: 2726701.4790; train_gene_expr_recon_loss: 11639131.8626; train_masked_gp_l1_reg_loss: 107412.4444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59288.2049; train_chrom_access_recon_loss: 6007806.2176; train_global_loss: 20621649.6031; train_optim_loss: 20621649.6031; val_kl_reg_loss: 82184.1339; val_edge_recon_loss: 2739897.9500; val_gene_expr_recon_loss: 11626799.0000; val_masked_gp_l1_reg_loss: 107770.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60057.9336; val_chrom_access_recon_loss: 6033853.2000; val_global_loss: 20650562.1333; val_optim_loss: 20650562.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9578; val_auprc_score: 0.9443; val_best_acc_score: 0.8979; val_best_f1_score: 0.9013; train_kl_reg_loss: 81994.5791; train_edge_recon_loss: 2714692.7672; train_gene_expr_recon_loss: 11602938.4733; train_masked_gp_l1_reg_loss: 107887.8183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60160.4765; train_chrom_access_recon_loss: 5980770.1069; train_global_loss: 20548444.1679; train_optim_loss: 20548444.1679; val_kl_reg_loss: 84496.5562; val_edge_recon_loss: 2711464.6333; val_gene_expr_recon_loss: 11471292.5333; val_masked_gp_l1_reg_loss: 108138.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60615.2188; val_chrom_access_recon_loss: 5949646.2667; val_global_loss: 20385654.1333; val_optim_loss: 20385654.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9583; val_auprc_score: 0.9471; val_best_acc_score: 0.9029; val_best_f1_score: 0.9058; train_kl_reg_loss: 81650.3644; train_edge_recon_loss: 2717350.9084; train_gene_expr_recon_loss: 11557098.8855; train_masked_gp_l1_reg_loss: 108117.3042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60502.7484; train_chrom_access_recon_loss: 5958336.9695; train_global_loss: 20483057.1908; train_optim_loss: 20483057.1908; val_kl_reg_loss: 81234.4281; val_edge_recon_loss: 2731735.6000; val_gene_expr_recon_loss: 11533992.9333; val_masked_gp_l1_reg_loss: 108362.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60742.7539; val_chrom_access_recon_loss: 5981328.3333; val_global_loss: 20497397.3333; val_optim_loss: 20497397.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9636; val_auprc_score: 0.9556; val_best_acc_score: 0.9060; val_best_f1_score: 0.9104; train_kl_reg_loss: 79843.9144; train_edge_recon_loss: 2710416.4676; train_gene_expr_recon_loss: 11528231.4275; train_masked_gp_l1_reg_loss: 108287.4691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60335.3669; train_chrom_access_recon_loss: 5937410.7977; train_global_loss: 20424525.5115; train_optim_loss: 20424525.5115; val_kl_reg_loss: 78251.5464; val_edge_recon_loss: 2731375.4333; val_gene_expr_recon_loss: 11389517.7333; val_masked_gp_l1_reg_loss: 108519.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60488.4062; val_chrom_access_recon_loss: 5915748.8333; val_global_loss: 20283901.6000; val_optim_loss: 20283901.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9625; val_auprc_score: 0.9528; val_best_acc_score: 0.9056; val_best_f1_score: 0.9102; train_kl_reg_loss: 79523.4402; train_edge_recon_loss: 2710493.5458; train_gene_expr_recon_loss: 11484906.5496; train_masked_gp_l1_reg_loss: 108579.2229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60057.7299; train_chrom_access_recon_loss: 5915030.1298; train_global_loss: 20358590.6260; train_optim_loss: 20358590.6260; val_kl_reg_loss: 78889.9568; val_edge_recon_loss: 2711100.4333; val_gene_expr_recon_loss: 11467159.0667; val_masked_gp_l1_reg_loss: 108665.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59701.5430; val_chrom_access_recon_loss: 5915661.6333; val_global_loss: 20341178.9333; val_optim_loss: 20341178.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9623; val_auprc_score: 0.9535; val_best_acc_score: 0.9019; val_best_f1_score: 0.9049; train_kl_reg_loss: 80055.0886; train_edge_recon_loss: 2703271.4733; train_gene_expr_recon_loss: 11466845.7328; train_masked_gp_l1_reg_loss: 108578.2086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59675.2480; train_chrom_access_recon_loss: 5905594.5687; train_global_loss: 20324020.3664; train_optim_loss: 20324020.3664; val_kl_reg_loss: 80342.3453; val_edge_recon_loss: 2709366.6500; val_gene_expr_recon_loss: 11463875.5333; val_masked_gp_l1_reg_loss: 108762.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59981.5586; val_chrom_access_recon_loss: 5926792.3000; val_global_loss: 20349122.1333; val_optim_loss: 20349122.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9611; val_auprc_score: 0.9490; val_best_acc_score: 0.9064; val_best_f1_score: 0.9100; train_kl_reg_loss: 78946.8613; train_edge_recon_loss: 2694211.6088; train_gene_expr_recon_loss: 11449204.7634; train_masked_gp_l1_reg_loss: 108818.3209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59515.1132; train_chrom_access_recon_loss: 5889040.8359; train_global_loss: 20279737.5267; train_optim_loss: 20279737.5267; val_kl_reg_loss: 78750.6276; val_edge_recon_loss: 2714338.2667; val_gene_expr_recon_loss: 11371200.6667; val_masked_gp_l1_reg_loss: 108791.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59313.0898; val_chrom_access_recon_loss: 5909823.0667; val_global_loss: 20242217.6000; val_optim_loss: 20242217.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9672; val_auprc_score: 0.9607; val_best_acc_score: 0.9073; val_best_f1_score: 0.9107; train_kl_reg_loss: 79059.7011; train_edge_recon_loss: 2699093.4866; train_gene_expr_recon_loss: 11412249.7863; train_masked_gp_l1_reg_loss: 108787.5623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58967.7304; train_chrom_access_recon_loss: 5866932.9008; train_global_loss: 20225091.1450; train_optim_loss: 20225091.1450; val_kl_reg_loss: 80688.1396; val_edge_recon_loss: 2715323.3333; val_gene_expr_recon_loss: 11408641.8667; val_masked_gp_l1_reg_loss: 108900.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59186.4805; val_chrom_access_recon_loss: 5920400.7333; val_global_loss: 20293141.0667; val_optim_loss: 20293141.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9661; val_auprc_score: 0.9536; val_best_acc_score: 0.9150; val_best_f1_score: 0.9170; train_kl_reg_loss: 77554.5218; train_edge_recon_loss: 2691624.5706; train_gene_expr_recon_loss: 11398645.4046; train_masked_gp_l1_reg_loss: 108756.8086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59073.3284; train_chrom_access_recon_loss: 5859976.5573; train_global_loss: 20195631.2519; train_optim_loss: 20195631.2519; val_kl_reg_loss: 78962.7750; val_edge_recon_loss: 2688110.1500; val_gene_expr_recon_loss: 11368400.1333; val_masked_gp_l1_reg_loss: 108769.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59066.8945; val_chrom_access_recon_loss: 5886575.1000; val_global_loss: 20189884.1333; val_optim_loss: 20189884.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9634; val_auprc_score: 0.9540; val_best_acc_score: 0.9078; val_best_f1_score: 0.9121; train_kl_reg_loss: 77986.4408; train_edge_recon_loss: 2685930.5172; train_gene_expr_recon_loss: 11378172.9771; train_masked_gp_l1_reg_loss: 108684.9488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58986.2662; train_chrom_access_recon_loss: 5844427.3168; train_global_loss: 20154188.3969; train_optim_loss: 20154188.3969; val_kl_reg_loss: 78505.3844; val_edge_recon_loss: 2720070.7167; val_gene_expr_recon_loss: 11335761.1333; val_masked_gp_l1_reg_loss: 108536.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59033.1055; val_chrom_access_recon_loss: 5879545.0000; val_global_loss: 20181452.4000; val_optim_loss: 20181452.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9725; val_auprc_score: 0.9664; val_best_acc_score: 0.9202; val_best_f1_score: 0.9239; train_kl_reg_loss: 76547.5624; train_edge_recon_loss: 2699080.8263; train_gene_expr_recon_loss: 11365891.7939; train_masked_gp_l1_reg_loss: 108594.2501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58900.7616; train_chrom_access_recon_loss: 5837587.9924; train_global_loss: 20146603.2061; train_optim_loss: 20146603.2061; val_kl_reg_loss: 76769.1906; val_edge_recon_loss: 2664649.7833; val_gene_expr_recon_loss: 11330841.4667; val_masked_gp_l1_reg_loss: 108416.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58876.9961; val_chrom_access_recon_loss: 5849663.9667; val_global_loss: 20089217.3333; val_optim_loss: 20089217.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9701; val_auprc_score: 0.9621; val_best_acc_score: 0.9194; val_best_f1_score: 0.9219; train_kl_reg_loss: 76410.4956; train_edge_recon_loss: 2690939.8969; train_gene_expr_recon_loss: 11356303.5878; train_masked_gp_l1_reg_loss: 108415.6811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58906.1369; train_chrom_access_recon_loss: 5822693.5573; train_global_loss: 20113669.2824; train_optim_loss: 20113669.2824; val_kl_reg_loss: 75484.3719; val_edge_recon_loss: 2700635.3333; val_gene_expr_recon_loss: 11317369.2000; val_masked_gp_l1_reg_loss: 108502.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59224.3984; val_chrom_access_recon_loss: 5870103.0000; val_global_loss: 20131318.1333; val_optim_loss: 20131318.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9719; val_auprc_score: 0.9646; val_best_acc_score: 0.9200; val_best_f1_score: 0.9232; train_kl_reg_loss: 75951.2072; train_edge_recon_loss: 2688898.2595; train_gene_expr_recon_loss: 11329726.1145; train_masked_gp_l1_reg_loss: 108406.1826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59120.3839; train_chrom_access_recon_loss: 5803031.4924; train_global_loss: 20065133.7099; train_optim_loss: 20065133.7099; val_kl_reg_loss: 77504.8667; val_edge_recon_loss: 2682192.5333; val_gene_expr_recon_loss: 11292099.0000; val_masked_gp_l1_reg_loss: 108492.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59231.7031; val_chrom_access_recon_loss: 5810108.7667; val_global_loss: 20029628.9333; val_optim_loss: 20029628.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9685; val_auprc_score: 0.9580; val_best_acc_score: 0.9147; val_best_f1_score: 0.9169; train_kl_reg_loss: 90880.2279; train_edge_recon_loss: 2736125.0172; train_gene_expr_recon_loss: 10838213.3435; train_masked_gp_l1_reg_loss: 107698.6301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55127.4979; train_chrom_access_recon_loss: 5656901.5954; train_global_loss: 19484946.3511; train_optim_loss: 19484946.3511; val_kl_reg_loss: 42049.7581; val_edge_recon_loss: 2731305.6833; val_gene_expr_recon_loss: 10758972.0000; val_masked_gp_l1_reg_loss: 107734.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54979.1523; val_chrom_access_recon_loss: 5680708.2333; val_global_loss: 19375748.4000; val_optim_loss: 19375748.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9670; val_auprc_score: 0.9598; val_best_acc_score: 0.9107; val_best_f1_score: 0.9146; train_kl_reg_loss: 79675.5247; train_edge_recon_loss: 2705225.8206; train_gene_expr_recon_loss: 10793895.1145; train_masked_gp_l1_reg_loss: 107174.6569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55256.6956; train_chrom_access_recon_loss: 5626893.0420; train_global_loss: 19368120.8397; train_optim_loss: 19368120.8397; val_kl_reg_loss: 49633.1242; val_edge_recon_loss: 2732451.6833; val_gene_expr_recon_loss: 10786491.9333; val_masked_gp_l1_reg_loss: 106590.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55235.4414; val_chrom_access_recon_loss: 5626394.8000; val_global_loss: 19356796.5333; val_optim_loss: 19356796.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9699; val_auprc_score: 0.9615; val_best_acc_score: 0.9167; val_best_f1_score: 0.9193; train_kl_reg_loss: 73361.7864; train_edge_recon_loss: 2692614.8702; train_gene_expr_recon_loss: 10777061.4275; train_masked_gp_l1_reg_loss: 105947.7761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55472.7602; train_chrom_access_recon_loss: 5621317.7710; train_global_loss: 19325776.5191; train_optim_loss: 19325776.5191; val_kl_reg_loss: 51825.0763; val_edge_recon_loss: 2711446.0833; val_gene_expr_recon_loss: 10690446.7333; val_masked_gp_l1_reg_loss: 105242.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55602.1641; val_chrom_access_recon_loss: 5603370.2333; val_global_loss: 19217933.0667; val_optim_loss: 19217933.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9701; val_auprc_score: 0.9609; val_best_acc_score: 0.9194; val_best_f1_score: 0.9223; train_kl_reg_loss: 69231.1513; train_edge_recon_loss: 2691200.8492; train_gene_expr_recon_loss: 10753770.5725; train_masked_gp_l1_reg_loss: 104373.8305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55602.4558; train_chrom_access_recon_loss: 5602750.5305; train_global_loss: 19276929.2214; train_optim_loss: 19276929.2214; val_kl_reg_loss: 57185.5654; val_edge_recon_loss: 2709459.9167; val_gene_expr_recon_loss: 10764529.0667; val_masked_gp_l1_reg_loss: 103589.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55723.6914; val_chrom_access_recon_loss: 5664749.2000; val_global_loss: 19355237.7333; val_optim_loss: 19355237.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9732; val_auprc_score: 0.9662; val_best_acc_score: 0.9214; val_best_f1_score: 0.9235; train_kl_reg_loss: 66290.1584; train_edge_recon_loss: 2681116.4351; train_gene_expr_recon_loss: 10731925.8779; train_masked_gp_l1_reg_loss: 102928.3271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55635.5535; train_chrom_access_recon_loss: 5596389.2023; train_global_loss: 19234285.4656; train_optim_loss: 19234285.4656; val_kl_reg_loss: 57249.6326; val_edge_recon_loss: 2687471.6000; val_gene_expr_recon_loss: 10685290.3333; val_masked_gp_l1_reg_loss: 102220.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55645.3281; val_chrom_access_recon_loss: 5587315.2667; val_global_loss: 19175192.8000; val_optim_loss: 19175192.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9701; val_auprc_score: 0.9615; val_best_acc_score: 0.9204; val_best_f1_score: 0.9226; train_kl_reg_loss: 64972.0733; train_edge_recon_loss: 2678820.6202; train_gene_expr_recon_loss: 10733489.6031; train_masked_gp_l1_reg_loss: 101436.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55492.6066; train_chrom_access_recon_loss: 5597594.3702; train_global_loss: 19231805.9084; train_optim_loss: 19231805.9084; val_kl_reg_loss: 57034.4857; val_edge_recon_loss: 2701460.1500; val_gene_expr_recon_loss: 10672088.8667; val_masked_gp_l1_reg_loss: 101007.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55593.1875; val_chrom_access_recon_loss: 5602167.0000; val_global_loss: 19189350.9333; val_optim_loss: 19189350.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9707; val_auprc_score: 0.9606; val_best_acc_score: 0.9223; val_best_f1_score: 0.9235; train_kl_reg_loss: 64994.4390; train_edge_recon_loss: 2678073.6279; train_gene_expr_recon_loss: 10705253.7099; train_masked_gp_l1_reg_loss: 100340.1685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55595.7632; train_chrom_access_recon_loss: 5581154.6527; train_global_loss: 19185412.4122; train_optim_loss: 19185412.4122; val_kl_reg_loss: 55981.2570; val_edge_recon_loss: 2698066.8333; val_gene_expr_recon_loss: 10678471.2000; val_masked_gp_l1_reg_loss: 100014.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55848.3945; val_chrom_access_recon_loss: 5599360.2667; val_global_loss: 19187742.5333; val_optim_loss: 19187742.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9718; val_auprc_score: 0.9624; val_best_acc_score: 0.9225; val_best_f1_score: 0.9259; train_kl_reg_loss: 63991.2429; train_edge_recon_loss: 2673888.7481; train_gene_expr_recon_loss: 10714434.6718; train_masked_gp_l1_reg_loss: 99254.5289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55438.6429; train_chrom_access_recon_loss: 5586180.1412; train_global_loss: 19193188.0153; train_optim_loss: 19193188.0153; val_kl_reg_loss: 58182.9643; val_edge_recon_loss: 2678087.0333; val_gene_expr_recon_loss: 10684538.4000; val_masked_gp_l1_reg_loss: 98836.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55353.3828; val_chrom_access_recon_loss: 5590056.9667; val_global_loss: 19165054.2667; val_optim_loss: 19165054.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9714; val_auprc_score: 0.9622; val_best_acc_score: 0.9239; val_best_f1_score: 0.9260; train_kl_reg_loss: 63132.9947; train_edge_recon_loss: 2675141.2653; train_gene_expr_recon_loss: 10685007.6947; train_masked_gp_l1_reg_loss: 98533.9788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55279.5941; train_chrom_access_recon_loss: 5562246.8435; train_global_loss: 19139342.3511; train_optim_loss: 19139342.3511; val_kl_reg_loss: 58356.6029; val_edge_recon_loss: 2683270.7833; val_gene_expr_recon_loss: 10652250.0667; val_masked_gp_l1_reg_loss: 98147.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55296.4844; val_chrom_access_recon_loss: 5596483.9333; val_global_loss: 19143805.3333; val_optim_loss: 19143805.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9736; val_auprc_score: 0.9645; val_best_acc_score: 0.9252; val_best_f1_score: 0.9263; train_kl_reg_loss: 62384.9548; train_edge_recon_loss: 2680759.9981; train_gene_expr_recon_loss: 10694316.1756; train_masked_gp_l1_reg_loss: 97860.7384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55406.6019; train_chrom_access_recon_loss: 5573195.3779; train_global_loss: 19163923.9389; train_optim_loss: 19163923.9389; val_kl_reg_loss: 60192.6112; val_edge_recon_loss: 2690294.7167; val_gene_expr_recon_loss: 10642147.1333; val_masked_gp_l1_reg_loss: 97679.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55553.1914; val_chrom_access_recon_loss: 5571640.3000; val_global_loss: 19117507.7333; val_optim_loss: 19117507.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9734; val_auprc_score: 0.9646; val_best_acc_score: 0.9256; val_best_f1_score: 0.9276; train_kl_reg_loss: 62118.0251; train_edge_recon_loss: 2674864.8721; train_gene_expr_recon_loss: 10678814.0611; train_masked_gp_l1_reg_loss: 97333.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55456.6776; train_chrom_access_recon_loss: 5566508.1489; train_global_loss: 19135095.3282; train_optim_loss: 19135095.3282; val_kl_reg_loss: 59559.7716; val_edge_recon_loss: 2686319.8667; val_gene_expr_recon_loss: 10621639.8000; val_masked_gp_l1_reg_loss: 96946.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55332.6953; val_chrom_access_recon_loss: 5568530.9000; val_global_loss: 19088330.0000; val_optim_loss: 19088330.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9758; val_auprc_score: 0.9668; val_best_acc_score: 0.9295; val_best_f1_score: 0.9318; train_kl_reg_loss: 61798.3131; train_edge_recon_loss: 2669770.7786; train_gene_expr_recon_loss: 10671376.1603; train_masked_gp_l1_reg_loss: 96730.3000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55515.9811; train_chrom_access_recon_loss: 5567517.9580; train_global_loss: 19122709.4504; train_optim_loss: 19122709.4504; val_kl_reg_loss: 61056.8865; val_edge_recon_loss: 2680615.9667; val_gene_expr_recon_loss: 10639309.3333; val_masked_gp_l1_reg_loss: 96397.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55670.0039; val_chrom_access_recon_loss: 5570109.8667; val_global_loss: 19103159.2000; val_optim_loss: 19103159.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9730; val_auprc_score: 0.9624; val_best_acc_score: 0.9262; val_best_f1_score: 0.9284; train_kl_reg_loss: 61999.3457; train_edge_recon_loss: 2671215.3302; train_gene_expr_recon_loss: 10662935.9542; train_masked_gp_l1_reg_loss: 96125.5996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55544.4884; train_chrom_access_recon_loss: 5560472.2557; train_global_loss: 19108293.0534; train_optim_loss: 19108293.0534; val_kl_reg_loss: 55301.8641; val_edge_recon_loss: 2703434.4500; val_gene_expr_recon_loss: 10613360.6000; val_masked_gp_l1_reg_loss: 95880.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55472.3789; val_chrom_access_recon_loss: 5550308.2667; val_global_loss: 19073758.2667; val_optim_loss: 19073758.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9741; val_auprc_score: 0.9633; val_best_acc_score: 0.9259; val_best_f1_score: 0.9285; train_kl_reg_loss: 62119.5156; train_edge_recon_loss: 2678108.1889; train_gene_expr_recon_loss: 10648060.1221; train_masked_gp_l1_reg_loss: 95551.6876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55476.1642; train_chrom_access_recon_loss: 5545205.3550; train_global_loss: 19084521.0229; train_optim_loss: 19084521.0229; val_kl_reg_loss: 58196.9198; val_edge_recon_loss: 2686903.9833; val_gene_expr_recon_loss: 10624145.5333; val_masked_gp_l1_reg_loss: 95333.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55696.1211; val_chrom_access_recon_loss: 5578929.0333; val_global_loss: 19099204.6667; val_optim_loss: 19099204.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9768; val_auprc_score: 0.9698; val_best_acc_score: 0.9332; val_best_f1_score: 0.9347; train_kl_reg_loss: 61565.6497; train_edge_recon_loss: 2672147.7958; train_gene_expr_recon_loss: 10636734.6870; train_masked_gp_l1_reg_loss: 95025.1582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55575.3906; train_chrom_access_recon_loss: 5541022.5076; train_global_loss: 19062071.1145; train_optim_loss: 19062071.1145; val_kl_reg_loss: 56832.4984; val_edge_recon_loss: 2689111.9333; val_gene_expr_recon_loss: 10601131.2667; val_masked_gp_l1_reg_loss: 94805.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55775.4922; val_chrom_access_recon_loss: 5556162.3000; val_global_loss: 19053817.8667; val_optim_loss: 19053817.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9766; val_auprc_score: 0.9709; val_best_acc_score: 0.9307; val_best_f1_score: 0.9324; train_kl_reg_loss: 61950.1234; train_edge_recon_loss: 2672754.9294; train_gene_expr_recon_loss: 10621399.8168; train_masked_gp_l1_reg_loss: 94569.9351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55673.8554; train_chrom_access_recon_loss: 5527488.2595; train_global_loss: 19033836.9008; train_optim_loss: 19033836.9008; val_kl_reg_loss: 59630.6453; val_edge_recon_loss: 2658021.7667; val_gene_expr_recon_loss: 10653156.0000; val_masked_gp_l1_reg_loss: 94320.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55664.2734; val_chrom_access_recon_loss: 5575903.9000; val_global_loss: 19096697.0667; val_optim_loss: 19096697.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9811; val_auprc_score: 0.9759; val_best_acc_score: 0.9418; val_best_f1_score: 0.9428; train_kl_reg_loss: 61526.1804; train_edge_recon_loss: 2671909.2080; train_gene_expr_recon_loss: 10622661.1832; train_masked_gp_l1_reg_loss: 94144.4983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55736.0357; train_chrom_access_recon_loss: 5533765.5344; train_global_loss: 19039742.4427; train_optim_loss: 19039742.4427; val_kl_reg_loss: 57993.0484; val_edge_recon_loss: 2639483.2000; val_gene_expr_recon_loss: 10569927.8000; val_masked_gp_l1_reg_loss: 93964.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55752.9609; val_chrom_access_recon_loss: 5520898.9333; val_global_loss: 18938021.0667; val_optim_loss: 18938021.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9779; val_auprc_score: 0.9720; val_best_acc_score: 0.9314; val_best_f1_score: 0.9335; train_kl_reg_loss: 60728.1252; train_edge_recon_loss: 2668089.5954; train_gene_expr_recon_loss: 10599113.8244; train_masked_gp_l1_reg_loss: 93813.5541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55802.8447; train_chrom_access_recon_loss: 5525548.4695; train_global_loss: 19003096.4733; train_optim_loss: 19003096.4733; val_kl_reg_loss: 55495.8891; val_edge_recon_loss: 2674000.6667; val_gene_expr_recon_loss: 10588677.8000; val_masked_gp_l1_reg_loss: 93875.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55718.5391; val_chrom_access_recon_loss: 5546277.6000; val_global_loss: 19014046.0000; val_optim_loss: 19014046.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9790; val_auprc_score: 0.9712; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 61463.0329; train_edge_recon_loss: 2665528.4847; train_gene_expr_recon_loss: 10583631.7786; train_masked_gp_l1_reg_loss: 93602.6584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55779.0942; train_chrom_access_recon_loss: 5514900.5878; train_global_loss: 18974905.6641; train_optim_loss: 18974905.6641; val_kl_reg_loss: 57345.9013; val_edge_recon_loss: 2674430.6167; val_gene_expr_recon_loss: 10611832.5333; val_masked_gp_l1_reg_loss: 93305.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55675.5156; val_chrom_access_recon_loss: 5538175.0667; val_global_loss: 19030765.3333; val_optim_loss: 19030765.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9799; val_auprc_score: 0.9747; val_best_acc_score: 0.9338; val_best_f1_score: 0.9355; train_kl_reg_loss: 61321.7949; train_edge_recon_loss: 2663696.4218; train_gene_expr_recon_loss: 10583949.4122; train_masked_gp_l1_reg_loss: 93146.4782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55900.7274; train_chrom_access_recon_loss: 5515610.6756; train_global_loss: 18973625.4962; train_optim_loss: 18973625.4962; val_kl_reg_loss: 58231.5862; val_edge_recon_loss: 2674887.7833; val_gene_expr_recon_loss: 10576365.6000; val_masked_gp_l1_reg_loss: 92953.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55609.2695; val_chrom_access_recon_loss: 5531929.9333; val_global_loss: 18989977.2000; val_optim_loss: 18989977.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9774; val_auprc_score: 0.9691; val_best_acc_score: 0.9321; val_best_f1_score: 0.9338; train_kl_reg_loss: 60496.1848; train_edge_recon_loss: 2667163.3263; train_gene_expr_recon_loss: 10572637.7176; train_masked_gp_l1_reg_loss: 92956.5267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55788.6294; train_chrom_access_recon_loss: 5513314.2023; train_global_loss: 18962356.4427; train_optim_loss: 18962356.4427; val_kl_reg_loss: 59236.2719; val_edge_recon_loss: 2674177.2167; val_gene_expr_recon_loss: 10517833.9333; val_masked_gp_l1_reg_loss: 92764.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55893.3477; val_chrom_access_recon_loss: 5501462.9667; val_global_loss: 18901367.4667; val_optim_loss: 18901367.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9805; val_auprc_score: 0.9735; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 59272.0712; train_edge_recon_loss: 2654870.5191; train_gene_expr_recon_loss: 10559252.5878; train_masked_gp_l1_reg_loss: 92822.4383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55992.7049; train_chrom_access_recon_loss: 5503302.2824; train_global_loss: 18925512.7176; train_optim_loss: 18925512.7176; val_kl_reg_loss: 57602.4193; val_edge_recon_loss: 2668243.8333; val_gene_expr_recon_loss: 10539543.0000; val_masked_gp_l1_reg_loss: 92750.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55980.9648; val_chrom_access_recon_loss: 5497764.6333; val_global_loss: 18911885.0667; val_optim_loss: 18911885.0667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9797; val_auprc_score: 0.9747; val_best_acc_score: 0.9357; val_best_f1_score: 0.9373; train_kl_reg_loss: 60323.7001; train_edge_recon_loss: 2670658.9733; train_gene_expr_recon_loss: 10568343.4046; train_masked_gp_l1_reg_loss: 92495.3469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55898.9045; train_chrom_access_recon_loss: 5518088.5000; train_global_loss: 18965808.9160; train_optim_loss: 18965808.9160; val_kl_reg_loss: 53483.2245; val_edge_recon_loss: 2685669.6833; val_gene_expr_recon_loss: 10558311.8667; val_masked_gp_l1_reg_loss: 92515.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56111.9844; val_chrom_access_recon_loss: 5534688.5333; val_global_loss: 18980781.3333; val_optim_loss: 18980781.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9783; val_auprc_score: 0.9682; val_best_acc_score: 0.9359; val_best_f1_score: 0.9376; train_kl_reg_loss: 58950.9773; train_edge_recon_loss: 2657351.7691; train_gene_expr_recon_loss: 10556612.9313; train_masked_gp_l1_reg_loss: 92291.1409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55921.5921; train_chrom_access_recon_loss: 5504268.9160; train_global_loss: 18925397.3435; train_optim_loss: 18925397.3435; val_kl_reg_loss: 56203.2865; val_edge_recon_loss: 2683703.1833; val_gene_expr_recon_loss: 10521518.6000; val_masked_gp_l1_reg_loss: 91983.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55652.6992; val_chrom_access_recon_loss: 5504752.7000; val_global_loss: 18913813.3333; val_optim_loss: 18913813.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9790; val_auprc_score: 0.9688; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 59065.5797; train_edge_recon_loss: 2666827.5286; train_gene_expr_recon_loss: 10557510.7176; train_masked_gp_l1_reg_loss: 92004.4575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55905.8681; train_chrom_access_recon_loss: 5501424.6412; train_global_loss: 18932738.7786; train_optim_loss: 18932738.7786; val_kl_reg_loss: 56495.6367; val_edge_recon_loss: 2677222.5000; val_gene_expr_recon_loss: 10505410.2667; val_masked_gp_l1_reg_loss: 91885.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55668.6484; val_chrom_access_recon_loss: 5505849.9667; val_global_loss: 18892533.2000; val_optim_loss: 18892533.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9823; val_auprc_score: 0.9777; val_best_acc_score: 0.9406; val_best_f1_score: 0.9416; train_kl_reg_loss: 59329.1965; train_edge_recon_loss: 2661412.2710; train_gene_expr_recon_loss: 10543420.6031; train_masked_gp_l1_reg_loss: 91720.8856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55933.6907; train_chrom_access_recon_loss: 5495581.8969; train_global_loss: 18907398.6260; train_optim_loss: 18907398.6260; val_kl_reg_loss: 56369.7096; val_edge_recon_loss: 2676055.3833; val_gene_expr_recon_loss: 10509734.3333; val_masked_gp_l1_reg_loss: 91497.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55964.2109; val_chrom_access_recon_loss: 5522609.2333; val_global_loss: 18912229.7333; val_optim_loss: 18912229.7333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9825; val_auprc_score: 0.9781; val_best_acc_score: 0.9441; val_best_f1_score: 0.9451; train_kl_reg_loss: 59247.5587; train_edge_recon_loss: 2663859.7385; train_gene_expr_recon_loss: 10537393.6641; train_masked_gp_l1_reg_loss: 91355.8607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55983.4639; train_chrom_access_recon_loss: 5489809.0038; train_global_loss: 18897649.3130; train_optim_loss: 18897649.3130; val_kl_reg_loss: 54710.0979; val_edge_recon_loss: 2674151.3500; val_gene_expr_recon_loss: 10515050.6000; val_masked_gp_l1_reg_loss: 91058.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56004.4766; val_chrom_access_recon_loss: 5499464.4333; val_global_loss: 18890438.6667; val_optim_loss: 18890438.6667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9801; val_auprc_score: 0.9717; val_best_acc_score: 0.9419; val_best_f1_score: 0.9431; train_kl_reg_loss: 58581.8433; train_edge_recon_loss: 2660664.8626; train_gene_expr_recon_loss: 10531045.6183; train_masked_gp_l1_reg_loss: 90894.0407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56057.7837; train_chrom_access_recon_loss: 5484930.2023; train_global_loss: 18882174.2137; train_optim_loss: 18882174.2137; val_kl_reg_loss: 55457.0503; val_edge_recon_loss: 2682316.9167; val_gene_expr_recon_loss: 10468942.4667; val_masked_gp_l1_reg_loss: 90736.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55909.5859; val_chrom_access_recon_loss: 5491963.6000; val_global_loss: 18845326.0000; val_optim_loss: 18845326.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9798; val_auprc_score: 0.9708; val_best_acc_score: 0.9390; val_best_f1_score: 0.9407; train_kl_reg_loss: 59897.6039; train_edge_recon_loss: 2661531.5038; train_gene_expr_recon_loss: 10525407.2519; train_masked_gp_l1_reg_loss: 90391.9325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56119.2080; train_chrom_access_recon_loss: 5481270.9122; train_global_loss: 18874618.5191; train_optim_loss: 18874618.5191; val_kl_reg_loss: 55755.0120; val_edge_recon_loss: 2666403.4000; val_gene_expr_recon_loss: 10516834.1333; val_masked_gp_l1_reg_loss: 90240.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56022.1523; val_chrom_access_recon_loss: 5485164.0333; val_global_loss: 18870418.6667; val_optim_loss: 18870418.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9795; val_auprc_score: 0.9723; val_best_acc_score: 0.9407; val_best_f1_score: 0.9420; train_kl_reg_loss: 58787.4650; train_edge_recon_loss: 2656178.3053; train_gene_expr_recon_loss: 10520098.9160; train_masked_gp_l1_reg_loss: 90013.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55972.9969; train_chrom_access_recon_loss: 5474728.7710; train_global_loss: 18855780.3206; train_optim_loss: 18855780.3206; val_kl_reg_loss: 53465.9961; val_edge_recon_loss: 2673975.4500; val_gene_expr_recon_loss: 10526937.1333; val_masked_gp_l1_reg_loss: 89978.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56025.4766; val_chrom_access_recon_loss: 5517896.5667; val_global_loss: 18918278.2667; val_optim_loss: 18918278.2667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9810; val_auprc_score: 0.9757; val_best_acc_score: 0.9388; val_best_f1_score: 0.9410; train_kl_reg_loss: 57746.5751; train_edge_recon_loss: 2660933.6622; train_gene_expr_recon_loss: 10520050.9771; train_masked_gp_l1_reg_loss: 89686.2956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56058.6318; train_chrom_access_recon_loss: 5474883.6985; train_global_loss: 18859359.8931; train_optim_loss: 18859359.8931; val_kl_reg_loss: 51529.0898; val_edge_recon_loss: 2675947.2167; val_gene_expr_recon_loss: 10423150.6667; val_masked_gp_l1_reg_loss: 89815.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56250.5508; val_chrom_access_recon_loss: 5467816.0667; val_global_loss: 18764509.0667; val_optim_loss: 18764509.0667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9837; val_auprc_score: 0.9790; val_best_acc_score: 0.9457; val_best_f1_score: 0.9474; train_kl_reg_loss: 58435.3267; train_edge_recon_loss: 2655404.1679; train_gene_expr_recon_loss: 10516424.6870; train_masked_gp_l1_reg_loss: 89508.8918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56088.9711; train_chrom_access_recon_loss: 5471771.8397; train_global_loss: 18847633.8473; train_optim_loss: 18847633.8473; val_kl_reg_loss: 56253.0255; val_edge_recon_loss: 2664600.5000; val_gene_expr_recon_loss: 10458027.3333; val_masked_gp_l1_reg_loss: 89302.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56102.6289; val_chrom_access_recon_loss: 5461628.6333; val_global_loss: 18785914.5333; val_optim_loss: 18785914.5333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9829; val_auprc_score: 0.9762; val_best_acc_score: 0.9449; val_best_f1_score: 0.9464; train_kl_reg_loss: 57267.4872; train_edge_recon_loss: 2658231.2443; train_gene_expr_recon_loss: 10512061.0534; train_masked_gp_l1_reg_loss: 89184.6665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56146.8158; train_chrom_access_recon_loss: 5477586.4695; train_global_loss: 18850477.6947; train_optim_loss: 18850477.6947; val_kl_reg_loss: 52643.5797; val_edge_recon_loss: 2679524.1667; val_gene_expr_recon_loss: 10491735.7333; val_masked_gp_l1_reg_loss: 89053.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56122.8047; val_chrom_access_recon_loss: 5471579.5333; val_global_loss: 18840659.8667; val_optim_loss: 18840659.8667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9822; val_auprc_score: 0.9759; val_best_acc_score: 0.9445; val_best_f1_score: 0.9456; train_kl_reg_loss: 58074.2459; train_edge_recon_loss: 2652325.0248; train_gene_expr_recon_loss: 10517896.5802; train_masked_gp_l1_reg_loss: 88842.0328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56078.4787; train_chrom_access_recon_loss: 5472672.0267; train_global_loss: 18845888.4275; train_optim_loss: 18845888.4275; val_kl_reg_loss: 53330.9862; val_edge_recon_loss: 2686875.9833; val_gene_expr_recon_loss: 10494657.6667; val_masked_gp_l1_reg_loss: 88737.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56175.9648; val_chrom_access_recon_loss: 5480265.4000; val_global_loss: 18860044.0000; val_optim_loss: 18860044.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9842; val_auprc_score: 0.9803; val_best_acc_score: 0.9481; val_best_f1_score: 0.9490; train_kl_reg_loss: 57321.1972; train_edge_recon_loss: 2648479.2615; train_gene_expr_recon_loss: 10495015.2443; train_masked_gp_l1_reg_loss: 88588.1254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56122.6125; train_chrom_access_recon_loss: 5453402.3015; train_global_loss: 18798928.7786; train_optim_loss: 18798928.7786; val_kl_reg_loss: 55716.2445; val_edge_recon_loss: 2656578.2000; val_gene_expr_recon_loss: 10532953.6667; val_masked_gp_l1_reg_loss: 88644.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56305.2969; val_chrom_access_recon_loss: 5521685.1333; val_global_loss: 18911882.1333; val_optim_loss: 18911882.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9857; val_auprc_score: 0.9828; val_best_acc_score: 0.9473; val_best_f1_score: 0.9480; train_kl_reg_loss: 58659.7828; train_edge_recon_loss: 2651794.1202; train_gene_expr_recon_loss: 10489293.1145; train_masked_gp_l1_reg_loss: 86202.8409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47615.6885; train_chrom_access_recon_loss: 5458901.9313; train_global_loss: 18792467.4351; train_optim_loss: 18792467.4351; val_kl_reg_loss: 56087.8414; val_edge_recon_loss: 2649396.0167; val_gene_expr_recon_loss: 10463324.7333; val_masked_gp_l1_reg_loss: 85565.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46379.0469; val_chrom_access_recon_loss: 5486299.6000; val_global_loss: 18787052.0000; val_optim_loss: 18787052.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9835; val_auprc_score: 0.9770; val_best_acc_score: 0.9444; val_best_f1_score: 0.9461; train_kl_reg_loss: 59721.6197; train_edge_recon_loss: 2646491.5668; train_gene_expr_recon_loss: 10481340.5954; train_masked_gp_l1_reg_loss: 85435.1619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46085.4451; train_chrom_access_recon_loss: 5450075.9771; train_global_loss: 18769150.3664; train_optim_loss: 18769150.3664; val_kl_reg_loss: 56005.7341; val_edge_recon_loss: 2650931.9167; val_gene_expr_recon_loss: 10454468.3333; val_masked_gp_l1_reg_loss: 85344.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45799.0820; val_chrom_access_recon_loss: 5484011.4333; val_global_loss: 18776560.5333; val_optim_loss: 18776560.5333
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9833; val_auprc_score: 0.9747; val_best_acc_score: 0.9493; val_best_f1_score: 0.9509; train_kl_reg_loss: 60351.1005; train_edge_recon_loss: 2654541.5248; train_gene_expr_recon_loss: 10490363.5115; train_masked_gp_l1_reg_loss: 85295.9589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45583.7690; train_chrom_access_recon_loss: 5455433.1756; train_global_loss: 18791568.9771; train_optim_loss: 18791568.9771; val_kl_reg_loss: 56602.4253; val_edge_recon_loss: 2640401.9000; val_gene_expr_recon_loss: 10476178.1333; val_masked_gp_l1_reg_loss: 85277.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45423.1953; val_chrom_access_recon_loss: 5465245.1000; val_global_loss: 18769127.4667; val_optim_loss: 18769127.4667
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9841; val_auprc_score: 0.9803; val_best_acc_score: 0.9442; val_best_f1_score: 0.9453; train_kl_reg_loss: 60528.1844; train_edge_recon_loss: 2650884.8302; train_gene_expr_recon_loss: 10490613.3435; train_masked_gp_l1_reg_loss: 85239.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45252.2801; train_chrom_access_recon_loss: 5454947.1221; train_global_loss: 18787465.6641; train_optim_loss: 18787465.6641; val_kl_reg_loss: 56848.3753; val_edge_recon_loss: 2658787.8667; val_gene_expr_recon_loss: 10533248.0000; val_masked_gp_l1_reg_loss: 85208.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45112.2148; val_chrom_access_recon_loss: 5500495.0667; val_global_loss: 18879699.3333; val_optim_loss: 18879699.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 63 min 9 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9809
val AUPRC score: 0.9713
val best accuracy score: 0.9429
val best F1 score: 0.9447
val target rna MSE score: 1.4322
val source rna MSE score: 0.5114
val target atac MSE score: 0.3416
val source atac MSE score: 0.1042
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
