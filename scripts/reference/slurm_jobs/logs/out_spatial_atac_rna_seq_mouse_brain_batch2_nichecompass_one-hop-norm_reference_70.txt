[True]
Run timestamp: 07092023_175514_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6522; val_auprc_score: 0.6413; val_best_acc_score: 0.5040; val_best_f1_score: 0.6682; train_kl_reg_loss: 74146.0374; train_edge_recon_loss: 3555603.2992; train_gene_expr_recon_loss: 27574990.7576; train_masked_gp_l1_reg_loss: 92733.3054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1562387.0038; train_chrom_access_recon_loss: 3810696.3409; train_global_loss: 36670556.4545; train_optim_loss: 36670556.4545; val_kl_reg_loss: 145385.8652; val_edge_recon_loss: 4065387.7500; val_gene_expr_recon_loss: 24818088.2500; val_masked_gp_l1_reg_loss: 87384.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1307737.5000; val_chrom_access_recon_loss: 3608566.0312; val_global_loss: 34032549.5000; val_optim_loss: 34032549.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6927; val_auprc_score: 0.6878; val_best_acc_score: 0.5500; val_best_f1_score: 0.6854; train_kl_reg_loss: 133328.2174; train_edge_recon_loss: 3544961.3674; train_gene_expr_recon_loss: 24691755.7273; train_masked_gp_l1_reg_loss: 80694.4601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1056033.2661; train_chrom_access_recon_loss: 3603433.4583; train_global_loss: 33110206.5152; train_optim_loss: 33110206.5152; val_kl_reg_loss: 151611.1953; val_edge_recon_loss: 4062798.7188; val_gene_expr_recon_loss: 24408695.5000; val_masked_gp_l1_reg_loss: 76896.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 823705.7500; val_chrom_access_recon_loss: 3552066.5938; val_global_loss: 33075774.5000; val_optim_loss: 33075774.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7487; val_auprc_score: 0.7426; val_best_acc_score: 0.6335; val_best_f1_score: 0.7150; train_kl_reg_loss: 127293.0708; train_edge_recon_loss: 3537212.7803; train_gene_expr_recon_loss: 24326808.4545; train_masked_gp_l1_reg_loss: 76566.7353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 658453.3897; train_chrom_access_recon_loss: 3566867.7424; train_global_loss: 32293202.3333; train_optim_loss: 32293202.3333; val_kl_reg_loss: 121658.4336; val_edge_recon_loss: 4056065.9688; val_gene_expr_recon_loss: 23945969.2500; val_masked_gp_l1_reg_loss: 76887.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 517108.1562; val_chrom_access_recon_loss: 3512898.4062; val_global_loss: 32230588.5000; val_optim_loss: 32230588.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8387; val_auprc_score: 0.8118; val_best_acc_score: 0.7426; val_best_f1_score: 0.7457; train_kl_reg_loss: 115318.9827; train_edge_recon_loss: 3524696.1477; train_gene_expr_recon_loss: 24129170.0303; train_masked_gp_l1_reg_loss: 78076.6262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 423836.5952; train_chrom_access_recon_loss: 3543082.6023; train_global_loss: 31814181.0303; train_optim_loss: 31814181.0303; val_kl_reg_loss: 118343.9043; val_edge_recon_loss: 3996805.4375; val_gene_expr_recon_loss: 23922727.2500; val_masked_gp_l1_reg_loss: 80291.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 345733.8438; val_chrom_access_recon_loss: 3494631.4062; val_global_loss: 31958533.7500; val_optim_loss: 31958533.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8674; val_auprc_score: 0.8337; val_best_acc_score: 0.7966; val_best_f1_score: 0.8184; train_kl_reg_loss: 96583.2867; train_edge_recon_loss: 3475222.1136; train_gene_expr_recon_loss: 23964583.9697; train_masked_gp_l1_reg_loss: 82623.5109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 294276.7533; train_chrom_access_recon_loss: 3522777.8447; train_global_loss: 31436067.4848; train_optim_loss: 31436067.4848; val_kl_reg_loss: 85593.6553; val_edge_recon_loss: 3508534.2500; val_gene_expr_recon_loss: 23740404.2500; val_masked_gp_l1_reg_loss: 84864.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249011.9844; val_chrom_access_recon_loss: 3488586.9062; val_global_loss: 31156995.2500; val_optim_loss: 31156995.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8449; val_auprc_score: 0.8071; val_best_acc_score: 0.7692; val_best_f1_score: 0.7967; train_kl_reg_loss: 89194.8325; train_edge_recon_loss: 3170444.0455; train_gene_expr_recon_loss: 23875037.0303; train_masked_gp_l1_reg_loss: 89675.4716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217720.5800; train_chrom_access_recon_loss: 3520439.6174; train_global_loss: 30962511.5152; train_optim_loss: 30962511.5152; val_kl_reg_loss: 105238.0859; val_edge_recon_loss: 3027911.5000; val_gene_expr_recon_loss: 23740996.2500; val_masked_gp_l1_reg_loss: 92704.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189541.5312; val_chrom_access_recon_loss: 3471477.4688; val_global_loss: 30627869.2500; val_optim_loss: 30627869.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8588; val_auprc_score: 0.8203; val_best_acc_score: 0.7805; val_best_f1_score: 0.7989; train_kl_reg_loss: 114362.6760; train_edge_recon_loss: 3003147.5000; train_gene_expr_recon_loss: 23737945.2727; train_masked_gp_l1_reg_loss: 92378.7042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169649.5019; train_chrom_access_recon_loss: 3498447.2159; train_global_loss: 30615931.0303; train_optim_loss: 30615931.0303; val_kl_reg_loss: 120657.5947; val_edge_recon_loss: 2961287.4375; val_gene_expr_recon_loss: 23341851.7500; val_masked_gp_l1_reg_loss: 92744.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151915.2656; val_chrom_access_recon_loss: 3433516.7500; val_global_loss: 30101974.0000; val_optim_loss: 30101974.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8679; val_auprc_score: 0.8302; val_best_acc_score: 0.7899; val_best_f1_score: 0.8087; train_kl_reg_loss: 118066.0067; train_edge_recon_loss: 2972663.0909; train_gene_expr_recon_loss: 23609142.0909; train_masked_gp_l1_reg_loss: 93452.7412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138460.4261; train_chrom_access_recon_loss: 3482098.6061; train_global_loss: 30413883.0303; train_optim_loss: 30413883.0303; val_kl_reg_loss: 120679.4346; val_edge_recon_loss: 2953188.6562; val_gene_expr_recon_loss: 23462351.5000; val_masked_gp_l1_reg_loss: 94489.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126335.8438; val_chrom_access_recon_loss: 3483140.0000; val_global_loss: 30240186.7500; val_optim_loss: 30240186.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8942; val_auprc_score: 0.8670; val_best_acc_score: 0.8205; val_best_f1_score: 0.8342; train_kl_reg_loss: 113609.1731; train_edge_recon_loss: 2933986.2803; train_gene_expr_recon_loss: 23489235.3333; train_masked_gp_l1_reg_loss: 95425.5889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116809.9996; train_chrom_access_recon_loss: 3462853.0909; train_global_loss: 30211919.6061; train_optim_loss: 30211919.6061; val_kl_reg_loss: 111087.4893; val_edge_recon_loss: 2929881.4062; val_gene_expr_recon_loss: 23223754.2500; val_masked_gp_l1_reg_loss: 96544.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108133.9453; val_chrom_access_recon_loss: 3400492.6250; val_global_loss: 29869893.5000; val_optim_loss: 29869893.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9019; val_auprc_score: 0.8661; val_best_acc_score: 0.8350; val_best_f1_score: 0.8451; train_kl_reg_loss: 114837.5737; train_edge_recon_loss: 2890063.8939; train_gene_expr_recon_loss: 23389664.5455; train_masked_gp_l1_reg_loss: 97501.4796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101073.6241; train_chrom_access_recon_loss: 3448660.5606; train_global_loss: 30041801.7576; train_optim_loss: 30041801.7576; val_kl_reg_loss: 114048.3457; val_edge_recon_loss: 2857256.4688; val_gene_expr_recon_loss: 23164296.5000; val_masked_gp_l1_reg_loss: 98838.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94615.9453; val_chrom_access_recon_loss: 3378620.9688; val_global_loss: 29707676.0000; val_optim_loss: 29707676.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8938; val_auprc_score: 0.8676; val_best_acc_score: 0.8221; val_best_f1_score: 0.8390; train_kl_reg_loss: 117579.7462; train_edge_recon_loss: 2866007.7992; train_gene_expr_recon_loss: 23311980.2121; train_masked_gp_l1_reg_loss: 99655.8461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89938.2527; train_chrom_access_recon_loss: 3436963.9091; train_global_loss: 29922125.7576; train_optim_loss: 29922125.7576; val_kl_reg_loss: 122597.6494; val_edge_recon_loss: 2902937.3438; val_gene_expr_recon_loss: 23024705.5000; val_masked_gp_l1_reg_loss: 100857.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85650.0000; val_chrom_access_recon_loss: 3395064.5625; val_global_loss: 29631813.2500; val_optim_loss: 29631813.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9009; val_auprc_score: 0.8734; val_best_acc_score: 0.8340; val_best_f1_score: 0.8491; train_kl_reg_loss: 117601.1250; train_edge_recon_loss: 2861916.4697; train_gene_expr_recon_loss: 23236787.5152; train_masked_gp_l1_reg_loss: 101794.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82165.1050; train_chrom_access_recon_loss: 3426249.5568; train_global_loss: 29826514.5152; train_optim_loss: 29826514.5152; val_kl_reg_loss: 117873.5752; val_edge_recon_loss: 2909530.2188; val_gene_expr_recon_loss: 23006112.7500; val_masked_gp_l1_reg_loss: 102542.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78487.9375; val_chrom_access_recon_loss: 3369648.7812; val_global_loss: 29584195.2500; val_optim_loss: 29584195.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9041; val_auprc_score: 0.8768; val_best_acc_score: 0.8396; val_best_f1_score: 0.8526; train_kl_reg_loss: 114903.2659; train_edge_recon_loss: 2825877.6364; train_gene_expr_recon_loss: 23142733.4242; train_masked_gp_l1_reg_loss: 103448.6436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75927.8357; train_chrom_access_recon_loss: 3413548.4924; train_global_loss: 29676439.3939; train_optim_loss: 29676439.3939; val_kl_reg_loss: 114018.6514; val_edge_recon_loss: 2904828.8750; val_gene_expr_recon_loss: 22896123.5000; val_masked_gp_l1_reg_loss: 104555.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73695.6328; val_chrom_access_recon_loss: 3351111.0938; val_global_loss: 29444334.2500; val_optim_loss: 29444334.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9125; val_auprc_score: 0.8840; val_best_acc_score: 0.8514; val_best_f1_score: 0.8644; train_kl_reg_loss: 116085.4060; train_edge_recon_loss: 2828381.4924; train_gene_expr_recon_loss: 23064928.9394; train_masked_gp_l1_reg_loss: 105289.3660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71364.2089; train_chrom_access_recon_loss: 3400166.2462; train_global_loss: 29586216.0606; train_optim_loss: 29586216.0606; val_kl_reg_loss: 114460.5703; val_edge_recon_loss: 2828164.0000; val_gene_expr_recon_loss: 23134725.5000; val_masked_gp_l1_reg_loss: 106118.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69466.4297; val_chrom_access_recon_loss: 3375046.4375; val_global_loss: 29627980.5000; val_optim_loss: 29627980.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9246; val_auprc_score: 0.9044; val_best_acc_score: 0.8643; val_best_f1_score: 0.8733; train_kl_reg_loss: 114167.7732; train_edge_recon_loss: 2798847.7311; train_gene_expr_recon_loss: 22985155.3939; train_masked_gp_l1_reg_loss: 106846.1720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67659.3442; train_chrom_access_recon_loss: 3382703.2727; train_global_loss: 29455379.8485; train_optim_loss: 29455379.8485; val_kl_reg_loss: 114749.1582; val_edge_recon_loss: 2790606.5625; val_gene_expr_recon_loss: 22733633.0000; val_masked_gp_l1_reg_loss: 107851.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66187.7969; val_chrom_access_recon_loss: 3324538.2188; val_global_loss: 29137566.5000; val_optim_loss: 29137566.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9209; val_auprc_score: 0.8923; val_best_acc_score: 0.8614; val_best_f1_score: 0.8680; train_kl_reg_loss: 111779.3671; train_edge_recon_loss: 2808487.5985; train_gene_expr_recon_loss: 22922471.9697; train_masked_gp_l1_reg_loss: 108277.4077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64607.7970; train_chrom_access_recon_loss: 3374284.3561; train_global_loss: 29389908.5152; train_optim_loss: 29389908.5152; val_kl_reg_loss: 111616.3936; val_edge_recon_loss: 2811309.4688; val_gene_expr_recon_loss: 22788682.2500; val_masked_gp_l1_reg_loss: 109168.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63370.5195; val_chrom_access_recon_loss: 3326732.6562; val_global_loss: 29210878.5000; val_optim_loss: 29210878.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9144; val_auprc_score: 0.8865; val_best_acc_score: 0.8549; val_best_f1_score: 0.8646; train_kl_reg_loss: 109923.3894; train_edge_recon_loss: 2796382.1591; train_gene_expr_recon_loss: 22895705.0000; train_masked_gp_l1_reg_loss: 109774.3815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62092.2739; train_chrom_access_recon_loss: 3369291.1856; train_global_loss: 29343168.5758; train_optim_loss: 29343168.5758; val_kl_reg_loss: 108871.3174; val_edge_recon_loss: 2843078.0312; val_gene_expr_recon_loss: 22733505.7500; val_masked_gp_l1_reg_loss: 110564.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61206.4375; val_chrom_access_recon_loss: 3306845.4062; val_global_loss: 29164070.7500; val_optim_loss: 29164070.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9253; val_auprc_score: 0.8974; val_best_acc_score: 0.8700; val_best_f1_score: 0.8767; train_kl_reg_loss: 110106.2165; train_edge_recon_loss: 2786335.9659; train_gene_expr_recon_loss: 22827858.2121; train_masked_gp_l1_reg_loss: 111192.9126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60044.8135; train_chrom_access_recon_loss: 3354510.2614; train_global_loss: 29250048.5758; train_optim_loss: 29250048.5758; val_kl_reg_loss: 109970.2812; val_edge_recon_loss: 2841889.3750; val_gene_expr_recon_loss: 22673072.5000; val_masked_gp_l1_reg_loss: 111752.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59179.8164; val_chrom_access_recon_loss: 3316142.6562; val_global_loss: 29112006.7500; val_optim_loss: 29112006.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9192; val_auprc_score: 0.8975; val_best_acc_score: 0.8587; val_best_f1_score: 0.8684; train_kl_reg_loss: 105415.3633; train_edge_recon_loss: 2787619.7879; train_gene_expr_recon_loss: 22780538.5455; train_masked_gp_l1_reg_loss: 112466.7464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58182.3472; train_chrom_access_recon_loss: 3349086.1439; train_global_loss: 29193308.9091; train_optim_loss: 29193308.9091; val_kl_reg_loss: 108127.8760; val_edge_recon_loss: 2854957.7500; val_gene_expr_recon_loss: 22576696.0000; val_masked_gp_l1_reg_loss: 113131.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57526.6602; val_chrom_access_recon_loss: 3322100.6875; val_global_loss: 29032540.2500; val_optim_loss: 29032540.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9289; val_auprc_score: 0.9065; val_best_acc_score: 0.8686; val_best_f1_score: 0.8763; train_kl_reg_loss: 104371.7805; train_edge_recon_loss: 2789322.7386; train_gene_expr_recon_loss: 22713258.3030; train_masked_gp_l1_reg_loss: 113769.5270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56734.4678; train_chrom_access_recon_loss: 3339882.0379; train_global_loss: 29117338.8788; train_optim_loss: 29117338.8788; val_kl_reg_loss: 102481.3955; val_edge_recon_loss: 2768637.1250; val_gene_expr_recon_loss: 22613180.2500; val_masked_gp_l1_reg_loss: 114431.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56108.7031; val_chrom_access_recon_loss: 3283128.1250; val_global_loss: 28937967.0000; val_optim_loss: 28937967.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9215; val_auprc_score: 0.8998; val_best_acc_score: 0.8614; val_best_f1_score: 0.8709; train_kl_reg_loss: 105547.3143; train_edge_recon_loss: 2766275.2159; train_gene_expr_recon_loss: 22673330.1818; train_masked_gp_l1_reg_loss: 115040.7937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55356.6962; train_chrom_access_recon_loss: 3331513.7652; train_global_loss: 29047064.3636; train_optim_loss: 29047064.3636; val_kl_reg_loss: 109142.7568; val_edge_recon_loss: 2827741.4375; val_gene_expr_recon_loss: 22257882.2500; val_masked_gp_l1_reg_loss: 115576.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55094.6094; val_chrom_access_recon_loss: 3243773.7812; val_global_loss: 28609210.2500; val_optim_loss: 28609210.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9306; val_auprc_score: 0.9117; val_best_acc_score: 0.8678; val_best_f1_score: 0.8756; train_kl_reg_loss: 105424.9213; train_edge_recon_loss: 2758927.1061; train_gene_expr_recon_loss: 22623318.3939; train_masked_gp_l1_reg_loss: 116086.9896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54139.5361; train_chrom_access_recon_loss: 3324188.0833; train_global_loss: 28982085.2424; train_optim_loss: 28982085.2424; val_kl_reg_loss: 105599.1826; val_edge_recon_loss: 2793511.3125; val_gene_expr_recon_loss: 22565506.0000; val_masked_gp_l1_reg_loss: 116816.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53758.7891; val_chrom_access_recon_loss: 3276797.3125; val_global_loss: 28911988.0000; val_optim_loss: 28911988.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9303; val_auprc_score: 0.9029; val_best_acc_score: 0.8732; val_best_f1_score: 0.8817; train_kl_reg_loss: 102809.7071; train_edge_recon_loss: 2767698.2576; train_gene_expr_recon_loss: 22577333.9091; train_masked_gp_l1_reg_loss: 117216.8114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53036.0767; train_chrom_access_recon_loss: 3317580.6061; train_global_loss: 28935675.3636; train_optim_loss: 28935675.3636; val_kl_reg_loss: 107937.6260; val_edge_recon_loss: 2783923.1250; val_gene_expr_recon_loss: 22251189.7500; val_masked_gp_l1_reg_loss: 117798.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52624.7305; val_chrom_access_recon_loss: 3262030.1250; val_global_loss: 28575503.0000; val_optim_loss: 28575503.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9333; val_auprc_score: 0.9091; val_best_acc_score: 0.8751; val_best_f1_score: 0.8813; train_kl_reg_loss: 104620.9175; train_edge_recon_loss: 2753511.5568; train_gene_expr_recon_loss: 22540435.3939; train_masked_gp_l1_reg_loss: 118122.3668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51799.1048; train_chrom_access_recon_loss: 3309030.8409; train_global_loss: 28877520.4848; train_optim_loss: 28877520.4848; val_kl_reg_loss: 106384.2598; val_edge_recon_loss: 2774537.2188; val_gene_expr_recon_loss: 22389831.0000; val_masked_gp_l1_reg_loss: 118622.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51182.8516; val_chrom_access_recon_loss: 3278139.3125; val_global_loss: 28718695.5000; val_optim_loss: 28718695.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9395; val_auprc_score: 0.9230; val_best_acc_score: 0.8812; val_best_f1_score: 0.8861; train_kl_reg_loss: 101647.9540; train_edge_recon_loss: 2748280.8939; train_gene_expr_recon_loss: 22504243.0000; train_masked_gp_l1_reg_loss: 119060.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50831.6316; train_chrom_access_recon_loss: 3304269.9394; train_global_loss: 28828333.6667; train_optim_loss: 28828333.6667; val_kl_reg_loss: 101849.9629; val_edge_recon_loss: 2773298.4688; val_gene_expr_recon_loss: 22584545.2500; val_masked_gp_l1_reg_loss: 119564.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50410.2773; val_chrom_access_recon_loss: 3282397.7812; val_global_loss: 28912066.2500; val_optim_loss: 28912066.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9413; val_auprc_score: 0.9225; val_best_acc_score: 0.8847; val_best_f1_score: 0.8911; train_kl_reg_loss: 107712.3029; train_edge_recon_loss: 2779943.7045; train_gene_expr_recon_loss: 22183871.0606; train_masked_gp_l1_reg_loss: 118976.6125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42412.2372; train_chrom_access_recon_loss: 3266546.1326; train_global_loss: 28499461.9697; train_optim_loss: 28499461.9697; val_kl_reg_loss: 74560.6279; val_edge_recon_loss: 2774636.0625; val_gene_expr_recon_loss: 21977038.2500; val_masked_gp_l1_reg_loss: 118669.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39543.5977; val_chrom_access_recon_loss: 3200856.4062; val_global_loss: 28185305.2500; val_optim_loss: 28185305.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9372; val_auprc_score: 0.9171; val_best_acc_score: 0.8780; val_best_f1_score: 0.8851; train_kl_reg_loss: 110602.6019; train_edge_recon_loss: 2768457.3864; train_gene_expr_recon_loss: 22127151.8182; train_masked_gp_l1_reg_loss: 118892.2238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38872.1465; train_chrom_access_recon_loss: 3250781.3371; train_global_loss: 28414757.3939; train_optim_loss: 28414757.3939; val_kl_reg_loss: 79212.5586; val_edge_recon_loss: 2801867.7812; val_gene_expr_recon_loss: 22037098.7500; val_masked_gp_l1_reg_loss: 119154.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38340.8125; val_chrom_access_recon_loss: 3196267.6562; val_global_loss: 28271940.7500; val_optim_loss: 28271940.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9364; val_auprc_score: 0.9113; val_best_acc_score: 0.8780; val_best_f1_score: 0.8856; train_kl_reg_loss: 108775.0575; train_edge_recon_loss: 2753252.5758; train_gene_expr_recon_loss: 22072064.1818; train_masked_gp_l1_reg_loss: 119498.7956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38114.5150; train_chrom_access_recon_loss: 3240202.2955; train_global_loss: 28331907.5152; train_optim_loss: 28331907.5152; val_kl_reg_loss: 81084.4531; val_edge_recon_loss: 2777439.4688; val_gene_expr_recon_loss: 21934150.2500; val_masked_gp_l1_reg_loss: 119830.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37801.1406; val_chrom_access_recon_loss: 3198576.9062; val_global_loss: 28148883.2500; val_optim_loss: 28148883.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9396; val_auprc_score: 0.9120; val_best_acc_score: 0.8861; val_best_f1_score: 0.8900; train_kl_reg_loss: 104705.5402; train_edge_recon_loss: 2755422.3977; train_gene_expr_recon_loss: 22046408.8182; train_masked_gp_l1_reg_loss: 120117.2129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37621.3496; train_chrom_access_recon_loss: 3232823.7159; train_global_loss: 28297099.1515; train_optim_loss: 28297099.1515; val_kl_reg_loss: 81660.0371; val_edge_recon_loss: 2768986.8750; val_gene_expr_recon_loss: 21997454.0000; val_masked_gp_l1_reg_loss: 120517.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37427.0664; val_chrom_access_recon_loss: 3204740.7188; val_global_loss: 28210788.0000; val_optim_loss: 28210788.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9521; val_auprc_score: 0.9334; val_best_acc_score: 0.8963; val_best_f1_score: 0.9008; train_kl_reg_loss: 102300.9137; train_edge_recon_loss: 2741055.0265; train_gene_expr_recon_loss: 22011997.5152; train_masked_gp_l1_reg_loss: 120698.2182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36802.6142; train_chrom_access_recon_loss: 3222196.2235; train_global_loss: 28235050.5455; train_optim_loss: 28235050.5455; val_kl_reg_loss: 84160.2109; val_edge_recon_loss: 2730652.1250; val_gene_expr_recon_loss: 21926440.0000; val_masked_gp_l1_reg_loss: 120947.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36511.3906; val_chrom_access_recon_loss: 3184741.5625; val_global_loss: 28083454.0000; val_optim_loss: 28083454.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9434; val_auprc_score: 0.9260; val_best_acc_score: 0.8864; val_best_f1_score: 0.8913; train_kl_reg_loss: 100143.8555; train_edge_recon_loss: 2738663.9242; train_gene_expr_recon_loss: 21966678.1515; train_masked_gp_l1_reg_loss: 121216.9401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36324.8242; train_chrom_access_recon_loss: 3213644.2121; train_global_loss: 28176671.9697; train_optim_loss: 28176671.9697; val_kl_reg_loss: 85053.3828; val_edge_recon_loss: 2781156.2188; val_gene_expr_recon_loss: 21944390.5000; val_masked_gp_l1_reg_loss: 121461.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36178.5664; val_chrom_access_recon_loss: 3190104.2500; val_global_loss: 28158344.7500; val_optim_loss: 28158344.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9424; val_auprc_score: 0.9235; val_best_acc_score: 0.8812; val_best_f1_score: 0.8895; train_kl_reg_loss: 99354.4426; train_edge_recon_loss: 2729282.3371; train_gene_expr_recon_loss: 21919705.6970; train_masked_gp_l1_reg_loss: 121758.9171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36020.6188; train_chrom_access_recon_loss: 3209784.2045; train_global_loss: 28115906.1515; train_optim_loss: 28115906.1515; val_kl_reg_loss: 86796.5000; val_edge_recon_loss: 2759352.5000; val_gene_expr_recon_loss: 21584890.5000; val_masked_gp_l1_reg_loss: 122034.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35864.6328; val_chrom_access_recon_loss: 3134727.5312; val_global_loss: 27723665.5000; val_optim_loss: 27723665.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9491; val_auprc_score: 0.9336; val_best_acc_score: 0.8944; val_best_f1_score: 0.8964; train_kl_reg_loss: 96527.5188; train_edge_recon_loss: 2729125.1629; train_gene_expr_recon_loss: 21891506.2121; train_masked_gp_l1_reg_loss: 122360.7296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35744.5752; train_chrom_access_recon_loss: 3204756.2955; train_global_loss: 28080020.6061; train_optim_loss: 28080020.6061; val_kl_reg_loss: 83983.6953; val_edge_recon_loss: 2759187.3750; val_gene_expr_recon_loss: 21564665.2500; val_masked_gp_l1_reg_loss: 122622.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35600.9180; val_chrom_access_recon_loss: 3170377.9375; val_global_loss: 27736436.7500; val_optim_loss: 27736436.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9448; val_auprc_score: 0.9174; val_best_acc_score: 0.8896; val_best_f1_score: 0.8955; train_kl_reg_loss: 95125.4273; train_edge_recon_loss: 2724078.7614; train_gene_expr_recon_loss: 21820740.0000; train_masked_gp_l1_reg_loss: 122921.8848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35462.8124; train_chrom_access_recon_loss: 3198254.4356; train_global_loss: 27996583.4848; train_optim_loss: 27996583.4848; val_kl_reg_loss: 82956.3438; val_edge_recon_loss: 2780734.9375; val_gene_expr_recon_loss: 21746829.2500; val_masked_gp_l1_reg_loss: 123175.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35393.2969; val_chrom_access_recon_loss: 3167320.8125; val_global_loss: 27936411.2500; val_optim_loss: 27936411.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9536; val_auprc_score: 0.9397; val_best_acc_score: 0.9022; val_best_f1_score: 0.9066; train_kl_reg_loss: 93626.0952; train_edge_recon_loss: 2715567.9962; train_gene_expr_recon_loss: 21806806.7273; train_masked_gp_l1_reg_loss: 123435.9608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35205.8545; train_chrom_access_recon_loss: 3196681.9924; train_global_loss: 27971324.4848; train_optim_loss: 27971324.4848; val_kl_reg_loss: 84242.8584; val_edge_recon_loss: 2731394.6875; val_gene_expr_recon_loss: 21714175.5000; val_masked_gp_l1_reg_loss: 123755.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35150.6406; val_chrom_access_recon_loss: 3160920.5000; val_global_loss: 27849639.5000; val_optim_loss: 27849639.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9529; val_auprc_score: 0.9349; val_best_acc_score: 0.9003; val_best_f1_score: 0.9036; train_kl_reg_loss: 93216.7334; train_edge_recon_loss: 2721046.9318; train_gene_expr_recon_loss: 21765775.5152; train_masked_gp_l1_reg_loss: 123970.9446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34982.9890; train_chrom_access_recon_loss: 3189582.8939; train_global_loss: 27928576.0606; train_optim_loss: 27928576.0606; val_kl_reg_loss: 85672.8242; val_edge_recon_loss: 2730121.7188; val_gene_expr_recon_loss: 21684124.0000; val_masked_gp_l1_reg_loss: 124234.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34785.9141; val_chrom_access_recon_loss: 3164249.2188; val_global_loss: 27823188.0000; val_optim_loss: 27823188.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9534; val_auprc_score: 0.9352; val_best_acc_score: 0.9009; val_best_f1_score: 0.9043; train_kl_reg_loss: 93629.6404; train_edge_recon_loss: 2714290.3636; train_gene_expr_recon_loss: 21744185.9697; train_masked_gp_l1_reg_loss: 123493.6088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32319.6726; train_chrom_access_recon_loss: 3187072.4886; train_global_loss: 27894991.9091; train_optim_loss: 27894991.9091; val_kl_reg_loss: 86822.5703; val_edge_recon_loss: 2749914.8125; val_gene_expr_recon_loss: 21580872.2500; val_masked_gp_l1_reg_loss: 123064.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31674.3828; val_chrom_access_recon_loss: 3151050.5938; val_global_loss: 27723398.5000; val_optim_loss: 27723398.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9506; val_auprc_score: 0.9335; val_best_acc_score: 0.8949; val_best_f1_score: 0.8986; train_kl_reg_loss: 94330.6953; train_edge_recon_loss: 2712330.7121; train_gene_expr_recon_loss: 21745620.7576; train_masked_gp_l1_reg_loss: 122934.1715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31525.2776; train_chrom_access_recon_loss: 3186837.2008; train_global_loss: 27893579.1212; train_optim_loss: 27893579.1212; val_kl_reg_loss: 87599.6836; val_edge_recon_loss: 2752098.4688; val_gene_expr_recon_loss: 21630866.0000; val_masked_gp_l1_reg_loss: 122840.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31409.3262; val_chrom_access_recon_loss: 3157501.0312; val_global_loss: 27782315.2500; val_optim_loss: 27782315.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9549; val_auprc_score: 0.9399; val_best_acc_score: 0.8990; val_best_f1_score: 0.9031; train_kl_reg_loss: 93863.6931; train_edge_recon_loss: 2716934.4811; train_gene_expr_recon_loss: 21727536.9394; train_masked_gp_l1_reg_loss: 122807.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31326.2544; train_chrom_access_recon_loss: 3187578.8977; train_global_loss: 27880047.7879; train_optim_loss: 27880047.7879; val_kl_reg_loss: 87581.6475; val_edge_recon_loss: 2747815.2188; val_gene_expr_recon_loss: 21873751.7500; val_masked_gp_l1_reg_loss: 122783.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31243.1816; val_chrom_access_recon_loss: 3178295.7500; val_global_loss: 28041471.5000; val_optim_loss: 28041471.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9485; val_auprc_score: 0.9245; val_best_acc_score: 0.8958; val_best_f1_score: 0.8980; train_kl_reg_loss: 93795.1966; train_edge_recon_loss: 2725406.3371; train_gene_expr_recon_loss: 21727788.8788; train_masked_gp_l1_reg_loss: 122778.0863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31189.9063; train_chrom_access_recon_loss: 3185989.9773; train_global_loss: 27886948.2727; train_optim_loss: 27886948.2727; val_kl_reg_loss: 87569.0117; val_edge_recon_loss: 2745312.9375; val_gene_expr_recon_loss: 21674782.2500; val_masked_gp_l1_reg_loss: 122769.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31129.2168; val_chrom_access_recon_loss: 3146240.9375; val_global_loss: 27807805.0000; val_optim_loss: 27807805.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9485; val_auprc_score: 0.9297; val_best_acc_score: 0.8920; val_best_f1_score: 0.8958; train_kl_reg_loss: 93878.2880; train_edge_recon_loss: 2706439.6894; train_gene_expr_recon_loss: 21725335.3030; train_masked_gp_l1_reg_loss: 122775.5526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31079.6634; train_chrom_access_recon_loss: 3184235.7614; train_global_loss: 27863744.3939; train_optim_loss: 27863744.3939; val_kl_reg_loss: 87175.9814; val_edge_recon_loss: 2739693.8125; val_gene_expr_recon_loss: 21584813.5000; val_masked_gp_l1_reg_loss: 122792.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31028.1523; val_chrom_access_recon_loss: 3136579.8438; val_global_loss: 27702083.2500; val_optim_loss: 27702083.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9507; val_auprc_score: 0.9284; val_best_acc_score: 0.8928; val_best_f1_score: 0.8982; train_kl_reg_loss: 94022.0438; train_edge_recon_loss: 2713416.8485; train_gene_expr_recon_loss: 21731483.3939; train_masked_gp_l1_reg_loss: 122807.3510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30986.9761; train_chrom_access_recon_loss: 3188461.6591; train_global_loss: 27881178.3333; train_optim_loss: 27881178.3333; val_kl_reg_loss: 88190.0596; val_edge_recon_loss: 2749608.5625; val_gene_expr_recon_loss: 21747937.7500; val_masked_gp_l1_reg_loss: 122815.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30933.0781; val_chrom_access_recon_loss: 3165571.6250; val_global_loss: 27905058.0000; val_optim_loss: 27905058.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9558; val_auprc_score: 0.9353; val_best_acc_score: 0.9041; val_best_f1_score: 0.9067; train_kl_reg_loss: 93757.1339; train_edge_recon_loss: 2719659.4735; train_gene_expr_recon_loss: 21717872.3939; train_masked_gp_l1_reg_loss: 122835.8488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30899.7243; train_chrom_access_recon_loss: 3186192.0758; train_global_loss: 27871216.8182; train_optim_loss: 27871216.8182; val_kl_reg_loss: 86629.0820; val_edge_recon_loss: 2725146.0312; val_gene_expr_recon_loss: 21576207.2500; val_masked_gp_l1_reg_loss: 122843.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30838.0703; val_chrom_access_recon_loss: 3170192.1875; val_global_loss: 27711856.5000; val_optim_loss: 27711856.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9581; val_auprc_score: 0.9401; val_best_acc_score: 0.9073; val_best_f1_score: 0.9094; train_kl_reg_loss: 93665.7150; train_edge_recon_loss: 2710620.2841; train_gene_expr_recon_loss: 21720503.5758; train_masked_gp_l1_reg_loss: 122872.7550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30794.5908; train_chrom_access_recon_loss: 3185318.3182; train_global_loss: 27863775.0606; train_optim_loss: 27863775.0606; val_kl_reg_loss: 87504.4990; val_edge_recon_loss: 2734002.0000; val_gene_expr_recon_loss: 21361326.0000; val_masked_gp_l1_reg_loss: 122889.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30748.1211; val_chrom_access_recon_loss: 3141130.3438; val_global_loss: 27477600.7500; val_optim_loss: 27477600.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9501; val_auprc_score: 0.9283; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 93547.8988; train_edge_recon_loss: 2714309.0530; train_gene_expr_recon_loss: 21730561.0606; train_masked_gp_l1_reg_loss: 122914.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30719.4335; train_chrom_access_recon_loss: 3187031.0758; train_global_loss: 27879083.3636; train_optim_loss: 27879083.3636; val_kl_reg_loss: 87629.4795; val_edge_recon_loss: 2751908.6250; val_gene_expr_recon_loss: 21466243.2500; val_masked_gp_l1_reg_loss: 122929.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30667.9023; val_chrom_access_recon_loss: 3143956.9688; val_global_loss: 27603335.0000; val_optim_loss: 27603335.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9528; val_auprc_score: 0.9305; val_best_acc_score: 0.9009; val_best_f1_score: 0.9053; train_kl_reg_loss: 93930.5047; train_edge_recon_loss: 2704369.3371; train_gene_expr_recon_loss: 21713511.3030; train_masked_gp_l1_reg_loss: 122959.2447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30618.1315; train_chrom_access_recon_loss: 3183040.9167; train_global_loss: 27848429.3636; train_optim_loss: 27848429.3636; val_kl_reg_loss: 87957.3652; val_edge_recon_loss: 2727273.3750; val_gene_expr_recon_loss: 21656878.5000; val_masked_gp_l1_reg_loss: 122976.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30564.5605; val_chrom_access_recon_loss: 3188221.9688; val_global_loss: 27813871.0000; val_optim_loss: 27813871.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9496; val_auprc_score: 0.9261; val_best_acc_score: 0.8966; val_best_f1_score: 0.9002; train_kl_reg_loss: 93572.2454; train_edge_recon_loss: 2708963.0379; train_gene_expr_recon_loss: 21710471.7879; train_masked_gp_l1_reg_loss: 122991.5878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30540.8446; train_chrom_access_recon_loss: 3185503.8258; train_global_loss: 27852043.2424; train_optim_loss: 27852043.2424; val_kl_reg_loss: 87634.0615; val_edge_recon_loss: 2752735.4062; val_gene_expr_recon_loss: 21693490.2500; val_masked_gp_l1_reg_loss: 123015.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30487.6348; val_chrom_access_recon_loss: 3185053.5000; val_global_loss: 27872417.2500; val_optim_loss: 27872417.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9576; val_auprc_score: 0.9446; val_best_acc_score: 0.9038; val_best_f1_score: 0.9063; train_kl_reg_loss: 93775.9792; train_edge_recon_loss: 2713130.9773; train_gene_expr_recon_loss: 21709593.3333; train_masked_gp_l1_reg_loss: 123039.3507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30462.4110; train_chrom_access_recon_loss: 3183532.8939; train_global_loss: 27853534.9091; train_optim_loss: 27853534.9091; val_kl_reg_loss: 88731.9736; val_edge_recon_loss: 2716313.0000; val_gene_expr_recon_loss: 21610849.5000; val_masked_gp_l1_reg_loss: 123059.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30411.2148; val_chrom_access_recon_loss: 3160960.4062; val_global_loss: 27730326.7500; val_optim_loss: 27730326.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9516; val_auprc_score: 0.9334; val_best_acc_score: 0.9003; val_best_f1_score: 0.9032; train_kl_reg_loss: 94058.7352; train_edge_recon_loss: 2708108.8485; train_gene_expr_recon_loss: 21692746.8485; train_masked_gp_l1_reg_loss: 122988.2513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30135.6286; train_chrom_access_recon_loss: 3183858.7197; train_global_loss: 27831897.0303; train_optim_loss: 27831897.0303; val_kl_reg_loss: 88293.1592; val_edge_recon_loss: 2756634.0000; val_gene_expr_recon_loss: 21805870.2500; val_masked_gp_l1_reg_loss: 122939.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30069.7148; val_chrom_access_recon_loss: 3173966.9375; val_global_loss: 27977774.5000; val_optim_loss: 27977774.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9523; val_auprc_score: 0.9352; val_best_acc_score: 0.8933; val_best_f1_score: 0.8994; train_kl_reg_loss: 93994.8331; train_edge_recon_loss: 2699706.7765; train_gene_expr_recon_loss: 21688658.6061; train_masked_gp_l1_reg_loss: 122919.5043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30054.4830; train_chrom_access_recon_loss: 3180491.6742; train_global_loss: 27815826.0303; train_optim_loss: 27815826.0303; val_kl_reg_loss: 88477.2656; val_edge_recon_loss: 2740965.6875; val_gene_expr_recon_loss: 21723616.7500; val_masked_gp_l1_reg_loss: 122902.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30040.7500; val_chrom_access_recon_loss: 3162753.6562; val_global_loss: 27868755.7500; val_optim_loss: 27868755.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9522; val_auprc_score: 0.9318; val_best_acc_score: 0.8979; val_best_f1_score: 0.9035; train_kl_reg_loss: 94194.2861; train_edge_recon_loss: 2702048.8295; train_gene_expr_recon_loss: 21716257.5758; train_masked_gp_l1_reg_loss: 122893.8481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30029.5785; train_chrom_access_recon_loss: 3186328.9545; train_global_loss: 27851752.8485; train_optim_loss: 27851752.8485; val_kl_reg_loss: 88529.6436; val_edge_recon_loss: 2742269.2500; val_gene_expr_recon_loss: 21501307.7500; val_masked_gp_l1_reg_loss: 122885.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30017.7969; val_chrom_access_recon_loss: 3145099.4375; val_global_loss: 27630110.5000; val_optim_loss: 27630110.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9547; val_auprc_score: 0.9338; val_best_acc_score: 0.9022; val_best_f1_score: 0.9067; train_kl_reg_loss: 94172.0191; train_edge_recon_loss: 2711972.5947; train_gene_expr_recon_loss: 21686954.7576; train_masked_gp_l1_reg_loss: 122881.6684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30010.8678; train_chrom_access_recon_loss: 3181351.6591; train_global_loss: 27827343.7576; train_optim_loss: 27827343.7576; val_kl_reg_loss: 88494.0410; val_edge_recon_loss: 2716956.6875; val_gene_expr_recon_loss: 21602495.0000; val_masked_gp_l1_reg_loss: 122875.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30001.7695; val_chrom_access_recon_loss: 3131669.4375; val_global_loss: 27692493.5000; val_optim_loss: 27692493.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 8 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9509
val AUPRC score: 0.9315
val best accuracy score: 0.8960
val best F1 score: 0.9006
val target rna MSE score: 0.8196
val source rna MSE score: 0.2356
val target atac MSE score: 0.4700
val source atac MSE score: 0.1069
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
