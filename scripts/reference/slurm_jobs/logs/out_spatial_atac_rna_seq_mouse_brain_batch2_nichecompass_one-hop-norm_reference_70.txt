[True]
Run timestamp: 07082023_192855_70.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_70']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8905; val_auprc_score: 0.9004; val_best_acc_score: 0.5565; val_best_f1_score: 0.6918; train_kl_reg_loss: 5012.2276; train_edge_recon_loss: 348291.7535; train_gene_expr_recon_loss: 635511.5417; train_masked_gp_l1_reg_loss: 15663.0174; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 793854.3889; train_global_loss: 1798332.9444; train_optim_loss: 1798332.9444; val_kl_reg_loss: 5902.7915; val_edge_recon_loss: 406153.8438; val_gene_expr_recon_loss: 611073.1250; val_masked_gp_l1_reg_loss: 10163.9521; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 801247.1875; val_global_loss: 1834540.8750; val_optim_loss: 1834540.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8906; val_auprc_score: 0.8940; val_best_acc_score: 0.5412; val_best_f1_score: 0.6848; train_kl_reg_loss: 11165.9195; train_edge_recon_loss: 353915.8056; train_gene_expr_recon_loss: 579858.1806; train_masked_gp_l1_reg_loss: 8260.9129; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 785193.9653; train_global_loss: 1738394.7778; train_optim_loss: 1738394.7778; val_kl_reg_loss: 15487.1035; val_edge_recon_loss: 406265.7812; val_gene_expr_recon_loss: 550408.4375; val_masked_gp_l1_reg_loss: 7126.6562; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 785280.5000; val_global_loss: 1764568.5000; val_optim_loss: 1764568.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8913; val_auprc_score: 0.8910; val_best_acc_score: 0.5624; val_best_f1_score: 0.6940; train_kl_reg_loss: 18364.7661; train_edge_recon_loss: 359283.6736; train_gene_expr_recon_loss: 525538.7188; train_masked_gp_l1_reg_loss: 7582.9370; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 769899.6111; train_global_loss: 1680669.7361; train_optim_loss: 1680669.7361; val_kl_reg_loss: 19890.3711; val_edge_recon_loss: 406103.9062; val_gene_expr_recon_loss: 512813.6875; val_masked_gp_l1_reg_loss: 7916.9019; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 771685.9375; val_global_loss: 1718410.7500; val_optim_loss: 1718410.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9032; val_auprc_score: 0.8950; val_best_acc_score: 0.6355; val_best_f1_score: 0.7291; train_kl_reg_loss: 21530.9900; train_edge_recon_loss: 360529.0660; train_gene_expr_recon_loss: 495587.0938; train_masked_gp_l1_reg_loss: 7864.5322; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 754191.1111; train_global_loss: 1639702.7778; train_optim_loss: 1639702.7778; val_kl_reg_loss: 22415.4883; val_edge_recon_loss: 405649.8750; val_gene_expr_recon_loss: 489662.3750; val_masked_gp_l1_reg_loss: 7865.5425; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 761734.3750; val_global_loss: 1687327.7500; val_optim_loss: 1687327.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9173; val_auprc_score: 0.9122; val_best_acc_score: 0.7766; val_best_f1_score: 0.8112; train_kl_reg_loss: 22920.9983; train_edge_recon_loss: 360469.1806; train_gene_expr_recon_loss: 475425.3333; train_masked_gp_l1_reg_loss: 7889.5005; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747301.1736; train_global_loss: 1614006.1944; train_optim_loss: 1614006.1944; val_kl_reg_loss: 25057.4023; val_edge_recon_loss: 404348.1250; val_gene_expr_recon_loss: 474333.4375; val_masked_gp_l1_reg_loss: 7891.3145; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753644.6250; val_global_loss: 1665275.0000; val_optim_loss: 1665275.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9143; val_auprc_score: 0.9028; val_best_acc_score: 0.8409; val_best_f1_score: 0.8412; train_kl_reg_loss: 24230.3587; train_edge_recon_loss: 359965.4062; train_gene_expr_recon_loss: 464431.7257; train_masked_gp_l1_reg_loss: 7920.4628; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740673.1875; train_global_loss: 1597221.1528; train_optim_loss: 1597221.1528; val_kl_reg_loss: 23485.9023; val_edge_recon_loss: 399872.0625; val_gene_expr_recon_loss: 465559.9375; val_masked_gp_l1_reg_loss: 7934.7358; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747943.4375; val_global_loss: 1644796.0000; val_optim_loss: 1644796.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9222; val_auprc_score: 0.9102; val_best_acc_score: 0.8359; val_best_f1_score: 0.8494; train_kl_reg_loss: 24190.3561; train_edge_recon_loss: 357644.6840; train_gene_expr_recon_loss: 454811.1840; train_masked_gp_l1_reg_loss: 7972.7089; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735640.2014; train_global_loss: 1580259.1389; train_optim_loss: 1580259.1389; val_kl_reg_loss: 24201.8320; val_edge_recon_loss: 384810.9375; val_gene_expr_recon_loss: 458971.8125; val_masked_gp_l1_reg_loss: 8004.0259; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743010.8750; val_global_loss: 1618999.5000; val_optim_loss: 1618999.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9250; val_auprc_score: 0.9123; val_best_acc_score: 0.8484; val_best_f1_score: 0.8539; train_kl_reg_loss: 24739.5599; train_edge_recon_loss: 347219.8438; train_gene_expr_recon_loss: 450050.4896; train_masked_gp_l1_reg_loss: 8045.5832; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729506.5139; train_global_loss: 1559561.9722; train_optim_loss: 1559561.9722; val_kl_reg_loss: 26586.2461; val_edge_recon_loss: 344293.1562; val_gene_expr_recon_loss: 457109.6250; val_masked_gp_l1_reg_loss: 8089.2969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739665.6250; val_global_loss: 1575744.0000; val_optim_loss: 1575744.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9252; val_auprc_score: 0.9132; val_best_acc_score: 0.8448; val_best_f1_score: 0.8531; train_kl_reg_loss: 32475.4191; train_edge_recon_loss: 323305.2222; train_gene_expr_recon_loss: 449961.3056; train_masked_gp_l1_reg_loss: 8140.4487; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730803.6458; train_global_loss: 1544686.0139; train_optim_loss: 1544686.0139; val_kl_reg_loss: 35630.3125; val_edge_recon_loss: 316475.0625; val_gene_expr_recon_loss: 454722.7500; val_masked_gp_l1_reg_loss: 8221.1582; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738508.2500; val_global_loss: 1553557.5000; val_optim_loss: 1553557.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9277; val_auprc_score: 0.9064; val_best_acc_score: 0.8549; val_best_f1_score: 0.8622; train_kl_reg_loss: 33794.1599; train_edge_recon_loss: 313183.5521; train_gene_expr_recon_loss: 444999.1250; train_masked_gp_l1_reg_loss: 8283.2202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727842.9653; train_global_loss: 1528103.0139; train_optim_loss: 1528103.0139; val_kl_reg_loss: 32921.5586; val_edge_recon_loss: 311221.1562; val_gene_expr_recon_loss: 450709.3125; val_masked_gp_l1_reg_loss: 8350.6855; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736193.1875; val_global_loss: 1539395.8750; val_optim_loss: 1539395.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9397; val_auprc_score: 0.9245; val_best_acc_score: 0.8712; val_best_f1_score: 0.8747; train_kl_reg_loss: 33887.2747; train_edge_recon_loss: 308977.1528; train_gene_expr_recon_loss: 441196.1111; train_masked_gp_l1_reg_loss: 8406.8934; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724413.0833; train_global_loss: 1516880.5000; train_optim_loss: 1516880.5000; val_kl_reg_loss: 32808.7031; val_edge_recon_loss: 308713.2812; val_gene_expr_recon_loss: 447081.9375; val_masked_gp_l1_reg_loss: 8461.1465; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732801.5625; val_global_loss: 1529866.6250; val_optim_loss: 1529866.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9427; val_auprc_score: 0.9272; val_best_acc_score: 0.8777; val_best_f1_score: 0.8830; train_kl_reg_loss: 33307.9047; train_edge_recon_loss: 305280.3854; train_gene_expr_recon_loss: 437741.9479; train_masked_gp_l1_reg_loss: 8505.3551; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721114.7639; train_global_loss: 1505950.3472; train_optim_loss: 1505950.3472; val_kl_reg_loss: 33574.9375; val_edge_recon_loss: 304618.5938; val_gene_expr_recon_loss: 444504.3750; val_masked_gp_l1_reg_loss: 8547.5488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730737.6875; val_global_loss: 1521983.1250; val_optim_loss: 1521983.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9539; val_auprc_score: 0.9426; val_best_acc_score: 0.8902; val_best_f1_score: 0.8947; train_kl_reg_loss: 33761.0573; train_edge_recon_loss: 301470.5868; train_gene_expr_recon_loss: 437038.4201; train_masked_gp_l1_reg_loss: 8584.5359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719447.3958; train_global_loss: 1500302.0000; train_optim_loss: 1500302.0000; val_kl_reg_loss: 32340.9688; val_edge_recon_loss: 302103.7812; val_gene_expr_recon_loss: 442965.1250; val_masked_gp_l1_reg_loss: 8628.4912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728017.2500; val_global_loss: 1514055.6250; val_optim_loss: 1514055.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9589; val_auprc_score: 0.9461; val_best_acc_score: 0.9010; val_best_f1_score: 0.9053; train_kl_reg_loss: 33483.3720; train_edge_recon_loss: 299998.9757; train_gene_expr_recon_loss: 433281.0000; train_masked_gp_l1_reg_loss: 8663.5101; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718843.9028; train_global_loss: 1494270.7361; train_optim_loss: 1494270.7361; val_kl_reg_loss: 32928.7266; val_edge_recon_loss: 298729.1250; val_gene_expr_recon_loss: 441335.9375; val_masked_gp_l1_reg_loss: 8690.4248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726409.0000; val_global_loss: 1508093.2500; val_optim_loss: 1508093.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9663; val_auprc_score: 0.9544; val_best_acc_score: 0.9124; val_best_f1_score: 0.9156; train_kl_reg_loss: 33572.0803; train_edge_recon_loss: 298707.4479; train_gene_expr_recon_loss: 432838.2743; train_masked_gp_l1_reg_loss: 8721.7640; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 717804.0347; train_global_loss: 1491643.5833; train_optim_loss: 1491643.5833; val_kl_reg_loss: 33311.6484; val_edge_recon_loss: 298250.9375; val_gene_expr_recon_loss: 438444.4375; val_masked_gp_l1_reg_loss: 8749.6963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723539.7500; val_global_loss: 1502296.5000; val_optim_loss: 1502296.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9638; val_auprc_score: 0.9500; val_best_acc_score: 0.9123; val_best_f1_score: 0.9165; train_kl_reg_loss: 33658.7630; train_edge_recon_loss: 298172.9375; train_gene_expr_recon_loss: 426403.6667; train_masked_gp_l1_reg_loss: 8779.2951; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711918.7986; train_global_loss: 1478933.4444; train_optim_loss: 1478933.4444; val_kl_reg_loss: 31979.3906; val_edge_recon_loss: 299214.1875; val_gene_expr_recon_loss: 438078.4375; val_masked_gp_l1_reg_loss: 8811.7305; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722775.4375; val_global_loss: 1500859.2500; val_optim_loss: 1500859.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9650; val_auprc_score: 0.9508; val_best_acc_score: 0.9138; val_best_f1_score: 0.9165; train_kl_reg_loss: 33248.5968; train_edge_recon_loss: 297168.7153; train_gene_expr_recon_loss: 429858.8750; train_masked_gp_l1_reg_loss: 8832.6328; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714133.8333; train_global_loss: 1483242.6250; train_optim_loss: 1483242.6250; val_kl_reg_loss: 33509.8711; val_edge_recon_loss: 296667.6875; val_gene_expr_recon_loss: 434695.9062; val_masked_gp_l1_reg_loss: 8856.8408; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720359.2500; val_global_loss: 1494089.5000; val_optim_loss: 1494089.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9713; val_auprc_score: 0.9633; val_best_acc_score: 0.9217; val_best_f1_score: 0.9242; train_kl_reg_loss: 33365.6597; train_edge_recon_loss: 295960.5000; train_gene_expr_recon_loss: 423334.7639; train_masked_gp_l1_reg_loss: 8886.1750; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 705907.3542; train_global_loss: 1467454.4444; train_optim_loss: 1467454.4444; val_kl_reg_loss: 32609.0312; val_edge_recon_loss: 295516.1875; val_gene_expr_recon_loss: 434174.0000; val_masked_gp_l1_reg_loss: 8903.0439; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718593.2500; val_global_loss: 1489795.5000; val_optim_loss: 1489795.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9732; val_auprc_score: 0.9639; val_best_acc_score: 0.9258; val_best_f1_score: 0.9283; train_kl_reg_loss: 33341.7526; train_edge_recon_loss: 296183.6215; train_gene_expr_recon_loss: 424185.2812; train_masked_gp_l1_reg_loss: 8926.7622; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708072.2500; train_global_loss: 1470709.7083; train_optim_loss: 1470709.7083; val_kl_reg_loss: 32192.8145; val_edge_recon_loss: 298058.8438; val_gene_expr_recon_loss: 432261.9062; val_masked_gp_l1_reg_loss: 8948.1191; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 716128.0000; val_global_loss: 1487589.7500; val_optim_loss: 1487589.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9741; val_auprc_score: 0.9658; val_best_acc_score: 0.9256; val_best_f1_score: 0.9283; train_kl_reg_loss: 33050.5569; train_edge_recon_loss: 294552.1806; train_gene_expr_recon_loss: 424635.6319; train_masked_gp_l1_reg_loss: 8971.3012; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704401.0833; train_global_loss: 1465610.7500; train_optim_loss: 1465610.7500; val_kl_reg_loss: 33124.3828; val_edge_recon_loss: 294555.0312; val_gene_expr_recon_loss: 431054.6875; val_masked_gp_l1_reg_loss: 9005.9502; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714955.8125; val_global_loss: 1482695.8750; val_optim_loss: 1482695.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9721; val_auprc_score: 0.9601; val_best_acc_score: 0.9254; val_best_f1_score: 0.9280; train_kl_reg_loss: 33144.2023; train_edge_recon_loss: 294778.1111; train_gene_expr_recon_loss: 420985.8438; train_masked_gp_l1_reg_loss: 9033.8843; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703387.0000; train_global_loss: 1461329.0278; train_optim_loss: 1461329.0278; val_kl_reg_loss: 31871.7109; val_edge_recon_loss: 295977.7188; val_gene_expr_recon_loss: 430378.5000; val_masked_gp_l1_reg_loss: 9057.6475; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713479.2500; val_global_loss: 1480764.7500; val_optim_loss: 1480764.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9749; val_auprc_score: 0.9670; val_best_acc_score: 0.9276; val_best_f1_score: 0.9300; train_kl_reg_loss: 32898.0397; train_edge_recon_loss: 293990.7535; train_gene_expr_recon_loss: 419123.7778; train_masked_gp_l1_reg_loss: 9080.1761; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700804.9375; train_global_loss: 1455897.6944; train_optim_loss: 1455897.6944; val_kl_reg_loss: 32122.4395; val_edge_recon_loss: 290668.1562; val_gene_expr_recon_loss: 430574.8750; val_masked_gp_l1_reg_loss: 9093.3750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712912.8750; val_global_loss: 1475371.7500; val_optim_loss: 1475371.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9749; val_auprc_score: 0.9672; val_best_acc_score: 0.9264; val_best_f1_score: 0.9288; train_kl_reg_loss: 32755.2491; train_edge_recon_loss: 293747.8194; train_gene_expr_recon_loss: 420330.4583; train_masked_gp_l1_reg_loss: 9115.2554; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699261.1528; train_global_loss: 1455209.9444; train_optim_loss: 1455209.9444; val_kl_reg_loss: 32034.9922; val_edge_recon_loss: 293224.2188; val_gene_expr_recon_loss: 429191.5625; val_masked_gp_l1_reg_loss: 9137.2285; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 711203.8750; val_global_loss: 1474791.8750; val_optim_loss: 1474791.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9746; val_auprc_score: 0.9638; val_best_acc_score: 0.9301; val_best_f1_score: 0.9322; train_kl_reg_loss: 32965.7192; train_edge_recon_loss: 292382.4618; train_gene_expr_recon_loss: 416636.7812; train_masked_gp_l1_reg_loss: 9158.5792; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699114.0486; train_global_loss: 1450257.5972; train_optim_loss: 1450257.5972; val_kl_reg_loss: 31704.6680; val_edge_recon_loss: 292135.4062; val_gene_expr_recon_loss: 428653.3438; val_masked_gp_l1_reg_loss: 9169.8857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709857.3750; val_global_loss: 1471520.6250; val_optim_loss: 1471520.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9791; val_auprc_score: 0.9725; val_best_acc_score: 0.9363; val_best_f1_score: 0.9377; train_kl_reg_loss: 32537.0226; train_edge_recon_loss: 292758.5903; train_gene_expr_recon_loss: 417328.4236; train_masked_gp_l1_reg_loss: 9183.5650; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697572.9653; train_global_loss: 1449380.5694; train_optim_loss: 1449380.5694; val_kl_reg_loss: 32301.9375; val_edge_recon_loss: 292248.8125; val_gene_expr_recon_loss: 426111.2812; val_masked_gp_l1_reg_loss: 9204.2783; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707449.8750; val_global_loss: 1467316.1250; val_optim_loss: 1467316.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9752; val_auprc_score: 0.9626; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 33767.8051; train_edge_recon_loss: 303508.2188; train_gene_expr_recon_loss: 427428.8264; train_masked_gp_l1_reg_loss: 9233.3963; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706093.3056; train_global_loss: 1480031.5556; train_optim_loss: 1480031.5556; val_kl_reg_loss: 22419.5371; val_edge_recon_loss: 298587.9688; val_gene_expr_recon_loss: 435367.2500; val_masked_gp_l1_reg_loss: 9234.1035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714711.5000; val_global_loss: 1480320.3750; val_optim_loss: 1480320.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9744; val_auprc_score: 0.9668; val_best_acc_score: 0.9247; val_best_f1_score: 0.9271; train_kl_reg_loss: 31037.7882; train_edge_recon_loss: 294768.2396; train_gene_expr_recon_loss: 426074.8472; train_masked_gp_l1_reg_loss: 9239.2650; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 707250.3750; train_global_loss: 1468370.5139; train_optim_loss: 1468370.5139; val_kl_reg_loss: 25771.9609; val_edge_recon_loss: 295225.5312; val_gene_expr_recon_loss: 432938.6250; val_masked_gp_l1_reg_loss: 9239.4541; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712721.8750; val_global_loss: 1475897.5000; val_optim_loss: 1475897.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9766; val_auprc_score: 0.9690; val_best_acc_score: 0.9299; val_best_f1_score: 0.9318; train_kl_reg_loss: 29978.9440; train_edge_recon_loss: 292419.9931; train_gene_expr_recon_loss: 421496.2292; train_masked_gp_l1_reg_loss: 9240.2422; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698843.3125; train_global_loss: 1451978.6944; train_optim_loss: 1451978.6944; val_kl_reg_loss: 26974.7500; val_edge_recon_loss: 292885.0625; val_gene_expr_recon_loss: 431363.1875; val_masked_gp_l1_reg_loss: 9235.4824; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 711121.1875; val_global_loss: 1471579.7500; val_optim_loss: 1471579.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9766; val_auprc_score: 0.9680; val_best_acc_score: 0.9318; val_best_f1_score: 0.9347; train_kl_reg_loss: 29577.2704; train_edge_recon_loss: 291731.0417; train_gene_expr_recon_loss: 420883.6493; train_masked_gp_l1_reg_loss: 9234.5267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700349.8264; train_global_loss: 1451776.3056; train_optim_loss: 1451776.3056; val_kl_reg_loss: 27015.1621; val_edge_recon_loss: 291533.7812; val_gene_expr_recon_loss: 430863.5625; val_masked_gp_l1_reg_loss: 9230.7637; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710121.1875; val_global_loss: 1468764.5000; val_optim_loss: 1468764.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9750; val_auprc_score: 0.9644; val_best_acc_score: 0.9318; val_best_f1_score: 0.9344; train_kl_reg_loss: 29438.6619; train_edge_recon_loss: 290582.1979; train_gene_expr_recon_loss: 419480.2431; train_masked_gp_l1_reg_loss: 9150.4000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697851.3264; train_global_loss: 1446502.8056; train_optim_loss: 1446502.8056; val_kl_reg_loss: 27652.0703; val_edge_recon_loss: 289489.9375; val_gene_expr_recon_loss: 430819.9375; val_masked_gp_l1_reg_loss: 9079.9883; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709547.1250; val_global_loss: 1466589.0000; val_optim_loss: 1466589.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9737; val_auprc_score: 0.9627; val_best_acc_score: 0.9286; val_best_f1_score: 0.9317; train_kl_reg_loss: 29803.2196; train_edge_recon_loss: 289623.5139; train_gene_expr_recon_loss: 420603.8333; train_masked_gp_l1_reg_loss: 9063.1300; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698611.3264; train_global_loss: 1447705.0278; train_optim_loss: 1447705.0278; val_kl_reg_loss: 27588.1836; val_edge_recon_loss: 291127.3125; val_gene_expr_recon_loss: 430628.8750; val_masked_gp_l1_reg_loss: 9035.7256; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709708.2500; val_global_loss: 1468088.3750; val_optim_loss: 1468088.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9669; val_best_acc_score: 0.9320; val_best_f1_score: 0.9346; train_kl_reg_loss: 29599.2684; train_edge_recon_loss: 289001.5903; train_gene_expr_recon_loss: 421518.4444; train_masked_gp_l1_reg_loss: 9022.7197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700511.6875; train_global_loss: 1449653.6806; train_optim_loss: 1449653.6806; val_kl_reg_loss: 27753.9336; val_edge_recon_loss: 290195.2188; val_gene_expr_recon_loss: 430611.5000; val_masked_gp_l1_reg_loss: 9008.2344; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709450.0000; val_global_loss: 1467018.8750; val_optim_loss: 1467018.8750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9779; val_auprc_score: 0.9686; val_best_acc_score: 0.9361; val_best_f1_score: 0.9384; train_kl_reg_loss: 29831.5573; train_edge_recon_loss: 290008.5243; train_gene_expr_recon_loss: 418545.2396; train_masked_gp_l1_reg_loss: 9000.8570; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694583.4931; train_global_loss: 1441969.6667; train_optim_loss: 1441969.6667; val_kl_reg_loss: 27663.2910; val_edge_recon_loss: 290221.7812; val_gene_expr_recon_loss: 430545.4375; val_masked_gp_l1_reg_loss: 8992.7168; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709618.1875; val_global_loss: 1467041.3750; val_optim_loss: 1467041.3750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9753; val_auprc_score: 0.9654; val_best_acc_score: 0.9324; val_best_f1_score: 0.9350; train_kl_reg_loss: 29369.6157; train_edge_recon_loss: 289663.6250; train_gene_expr_recon_loss: 419057.9861; train_masked_gp_l1_reg_loss: 8989.0676; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697498.9583; train_global_loss: 1444579.2361; train_optim_loss: 1444579.2361; val_kl_reg_loss: 27606.9961; val_edge_recon_loss: 290623.8750; val_gene_expr_recon_loss: 430227.1250; val_masked_gp_l1_reg_loss: 8983.9629; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709216.3750; val_global_loss: 1466658.2500; val_optim_loss: 1466658.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9737; val_auprc_score: 0.9654; val_best_acc_score: 0.9293; val_best_f1_score: 0.9322; train_kl_reg_loss: 29398.5532; train_edge_recon_loss: 289996.0243; train_gene_expr_recon_loss: 417574.6285; train_masked_gp_l1_reg_loss: 8974.8875; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695972.9028; train_global_loss: 1441916.9861; train_optim_loss: 1441916.9861; val_kl_reg_loss: 27523.1602; val_edge_recon_loss: 293525.7500; val_gene_expr_recon_loss: 430368.3125; val_masked_gp_l1_reg_loss: 8966.4277; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709357.1875; val_global_loss: 1469740.8750; val_optim_loss: 1469740.8750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9759; val_auprc_score: 0.9687; val_best_acc_score: 0.9328; val_best_f1_score: 0.9348; train_kl_reg_loss: 29348.1085; train_edge_recon_loss: 290076.7014; train_gene_expr_recon_loss: 417863.7500; train_masked_gp_l1_reg_loss: 8964.6883; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699168.0347; train_global_loss: 1445421.2778; train_optim_loss: 1445421.2778; val_kl_reg_loss: 27503.4492; val_edge_recon_loss: 290671.2812; val_gene_expr_recon_loss: 430545.5000; val_masked_gp_l1_reg_loss: 8961.6211; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709451.5000; val_global_loss: 1467133.3750; val_optim_loss: 1467133.3750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9744; val_auprc_score: 0.9665; val_best_acc_score: 0.9290; val_best_f1_score: 0.9320; train_kl_reg_loss: 29396.1502; train_edge_recon_loss: 290189.0521; train_gene_expr_recon_loss: 419409.8160; train_masked_gp_l1_reg_loss: 8960.0519; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699640.3889; train_global_loss: 1447595.4722; train_optim_loss: 1447595.4722; val_kl_reg_loss: 27551.8691; val_edge_recon_loss: 292309.4375; val_gene_expr_recon_loss: 430442.6250; val_masked_gp_l1_reg_loss: 8958.2969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709368.0000; val_global_loss: 1468630.2500; val_optim_loss: 1468630.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9748; val_auprc_score: 0.9657; val_best_acc_score: 0.9278; val_best_f1_score: 0.9309; train_kl_reg_loss: 29318.9601; train_edge_recon_loss: 290092.9479; train_gene_expr_recon_loss: 417105.6528; train_masked_gp_l1_reg_loss: 8957.4440; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697313.9375; train_global_loss: 1442788.9444; train_optim_loss: 1442788.9444; val_kl_reg_loss: 27547.2344; val_edge_recon_loss: 291031.0312; val_gene_expr_recon_loss: 430441.7500; val_masked_gp_l1_reg_loss: 8956.4922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709499.6875; val_global_loss: 1467476.2500; val_optim_loss: 1467476.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 27 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9764
val AUPRC score: 0.9679
val best accuracy score: 0.9312
val best F1 score: 0.9336
val target rna MSE score: 0.4107
val source rna MSE score: 0.2047
val target atac MSE score: 0.1390
val source atac MSE score: 0.0195
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
