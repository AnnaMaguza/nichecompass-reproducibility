[True, False, True]
Run timestamp: 06102023_173136_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 474107
Number of validation nodes: 52678
Number of training edges: 1120696
Number of validation edges: 124521
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8924; val_auprc_score: 0.9757; val_best_acc_score: 0.9031; val_best_f1_score: 0.9450; train_kl_reg_loss: 28721.5707; train_edge_recon_loss: 8219171.3990; train_gene_expr_recon_loss: 27403005.0845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35650898.0320; train_optim_loss: 35650898.0320; val_kl_reg_loss: 28238.0120; val_edge_recon_loss: 8311584.0963; val_gene_expr_recon_loss: 24663060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33002882.1639; val_optim_loss: 33002882.1639
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9019; val_auprc_score: 0.9778; val_best_acc_score: 0.9059; val_best_f1_score: 0.9462; train_kl_reg_loss: 32407.0307; train_edge_recon_loss: 8010357.2661; train_gene_expr_recon_loss: 23198519.0132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31241283.3038; train_optim_loss: 31241283.3038; val_kl_reg_loss: 37294.7572; val_edge_recon_loss: 8345765.7500; val_gene_expr_recon_loss: 22309750.2049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30692810.6721; val_optim_loss: 30692810.6721
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9081; val_auprc_score: 0.9794; val_best_acc_score: 0.9096; val_best_f1_score: 0.9483; train_kl_reg_loss: 40338.0665; train_edge_recon_loss: 7959412.7170; train_gene_expr_recon_loss: 21796100.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29795850.8862; train_optim_loss: 29795850.8862; val_kl_reg_loss: 43653.1246; val_edge_recon_loss: 8263366.0287; val_gene_expr_recon_loss: 21506707.3033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29813726.4754; val_optim_loss: 29813726.4754
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9121; val_auprc_score: 0.9803; val_best_acc_score: 0.9132; val_best_f1_score: 0.9503; train_kl_reg_loss: 46374.9071; train_edge_recon_loss: 7938612.0340; train_gene_expr_recon_loss: 21281644.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29266631.1329; train_optim_loss: 29266631.1329; val_kl_reg_loss: 49709.4168; val_edge_recon_loss: 8244671.4918; val_gene_expr_recon_loss: 21194043.9754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29488424.8852; val_optim_loss: 29488424.8852
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9139; val_auprc_score: 0.9809; val_best_acc_score: 0.9109; val_best_f1_score: 0.9489; train_kl_reg_loss: 96553.8708; train_edge_recon_loss: 7961473.8278; train_gene_expr_recon_loss: 21096007.0772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29154034.7876; train_optim_loss: 29154034.7876; val_kl_reg_loss: 52402.9373; val_edge_recon_loss: 8308740.7500; val_gene_expr_recon_loss: 21080925.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29442069.6311; val_optim_loss: 29442069.6311
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9151; val_auprc_score: 0.9814; val_best_acc_score: 0.9140; val_best_f1_score: 0.9508; train_kl_reg_loss: 54278.4359; train_edge_recon_loss: 7926136.8184; train_gene_expr_recon_loss: 20878024.3353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28858439.5733; train_optim_loss: 28858439.5733; val_kl_reg_loss: 56494.9394; val_edge_recon_loss: 8201622.3217; val_gene_expr_recon_loss: 20951451.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29209568.4016; val_optim_loss: 29209568.4016
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9191; val_auprc_score: 0.9818; val_best_acc_score: 0.9167; val_best_f1_score: 0.9522; train_kl_reg_loss: 58018.0333; train_edge_recon_loss: 7912004.3894; train_gene_expr_recon_loss: 20785695.9918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28755718.4221; train_optim_loss: 28755718.4221; val_kl_reg_loss: 60245.8130; val_edge_recon_loss: 8241045.4221; val_gene_expr_recon_loss: 20905976.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29207267.2705; val_optim_loss: 29207267.2705
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9208; val_auprc_score: 0.9826; val_best_acc_score: 0.9173; val_best_f1_score: 0.9525; train_kl_reg_loss: 61442.3676; train_edge_recon_loss: 7947106.1122; train_gene_expr_recon_loss: 20710168.4842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28718716.9740; train_optim_loss: 28718716.9740; val_kl_reg_loss: 61501.1622; val_edge_recon_loss: 8252787.4303; val_gene_expr_recon_loss: 20762817.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29077105.9016; val_optim_loss: 29077105.9016
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9194; val_auprc_score: 0.9820; val_best_acc_score: 0.9148; val_best_f1_score: 0.9512; train_kl_reg_loss: 64628.4988; train_edge_recon_loss: 7925325.6263; train_gene_expr_recon_loss: 20636427.8995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28626382.0183; train_optim_loss: 28626382.0183; val_kl_reg_loss: 66110.5219; val_edge_recon_loss: 8270014.6885; val_gene_expr_recon_loss: 21061613.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29397738.6557; val_optim_loss: 29397738.6557
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9230; val_auprc_score: 0.9830; val_best_acc_score: 0.9188; val_best_f1_score: 0.9533; train_kl_reg_loss: 69369.4493; train_edge_recon_loss: 7902444.2807; train_gene_expr_recon_loss: 20587638.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28559452.6825; train_optim_loss: 28559452.6825; val_kl_reg_loss: 69480.9260; val_edge_recon_loss: 8271223.7869; val_gene_expr_recon_loss: 20810746.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29151451.3607; val_optim_loss: 29151451.3607
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9249; val_auprc_score: 0.9834; val_best_acc_score: 0.9199; val_best_f1_score: 0.9541; train_kl_reg_loss: 72949.1142; train_edge_recon_loss: 7952752.8865; train_gene_expr_recon_loss: 20502338.8689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28528040.8908; train_optim_loss: 28528040.8908; val_kl_reg_loss: 75625.9146; val_edge_recon_loss: 8222634.5574; val_gene_expr_recon_loss: 20603814.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28902074.9590; val_optim_loss: 28902074.9590
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8993; val_auprc_score: 0.9767; val_best_acc_score: 0.9072; val_best_f1_score: 0.9469; train_kl_reg_loss: 75480.5791; train_edge_recon_loss: 8001651.2127; train_gene_expr_recon_loss: 23085622.7967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31162754.5966; train_optim_loss: 31162754.5966; val_kl_reg_loss: 31979.9480; val_edge_recon_loss: 8398748.7746; val_gene_expr_recon_loss: 25331451.6066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33762180.3115; val_optim_loss: 33762180.3115
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9242; val_auprc_score: 0.9832; val_best_acc_score: 0.9201; val_best_f1_score: 0.9541; train_kl_reg_loss: 50284.9728; train_edge_recon_loss: 7926632.6074; train_gene_expr_recon_loss: 22598539.5925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30575457.1859; train_optim_loss: 30575457.1859; val_kl_reg_loss: 69037.9172; val_edge_recon_loss: 8224303.1803; val_gene_expr_recon_loss: 21290739.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29584080.4836; val_optim_loss: 29584080.4836
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9239; val_auprc_score: 0.9832; val_best_acc_score: 0.9188; val_best_f1_score: 0.9533; train_kl_reg_loss: 182258998.1222; train_edge_recon_loss: 7931175.8305; train_gene_expr_recon_loss: 20913554.3600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 211103722.3033; train_optim_loss: 211103722.3033; val_kl_reg_loss: 86578.4429; val_edge_recon_loss: 8247015.7193; val_gene_expr_recon_loss: 21464883.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29798477.6885; val_optim_loss: 29798477.6885
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9247; val_auprc_score: 0.9836; val_best_acc_score: 0.9199; val_best_f1_score: 0.9540; train_kl_reg_loss: 79515.2947; train_edge_recon_loss: 8060092.0717; train_gene_expr_recon_loss: 23668351.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31807959.1969; train_optim_loss: 31807959.1969; val_kl_reg_loss: 79732.8080; val_edge_recon_loss: 8184107.1291; val_gene_expr_recon_loss: 21332339.7787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29596179.5902; val_optim_loss: 29596179.5902

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9271; val_auprc_score: 0.9841; val_best_acc_score: 0.9214; val_best_f1_score: 0.9548; train_kl_reg_loss: 81116.6662; train_edge_recon_loss: 7901175.8974; train_gene_expr_recon_loss: 21013824.8159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28996117.3842; train_optim_loss: 28996117.3842; val_kl_reg_loss: 83115.2591; val_edge_recon_loss: 8189896.7213; val_gene_expr_recon_loss: 21030073.9590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29303086.0082; val_optim_loss: 29303086.0082
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9279; val_auprc_score: 0.9841; val_best_acc_score: 0.9210; val_best_f1_score: 0.9545; train_kl_reg_loss: 84423.4032; train_edge_recon_loss: 7903146.8938; train_gene_expr_recon_loss: 20801303.8949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28788874.2056; train_optim_loss: 28788874.2056; val_kl_reg_loss: 86069.0525; val_edge_recon_loss: 8247771.8750; val_gene_expr_recon_loss: 20817306.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29151147.8934; val_optim_loss: 29151147.8934
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9295; val_auprc_score: 0.9846; val_best_acc_score: 0.9223; val_best_f1_score: 0.9553; train_kl_reg_loss: 87021.7070; train_edge_recon_loss: 7892732.5123; train_gene_expr_recon_loss: 20598820.3426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28578574.5793; train_optim_loss: 28578574.5793; val_kl_reg_loss: 88312.4363; val_edge_recon_loss: 8245984.9672; val_gene_expr_recon_loss: 20677343.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29011641.3525; val_optim_loss: 29011641.3525
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9311; val_auprc_score: 0.9848; val_best_acc_score: 0.9233; val_best_f1_score: 0.9559; train_kl_reg_loss: 88127.2715; train_edge_recon_loss: 7876178.7113; train_gene_expr_recon_loss: 20450042.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28414348.2841; train_optim_loss: 28414348.2841; val_kl_reg_loss: 89096.7872; val_edge_recon_loss: 8217627.4447; val_gene_expr_recon_loss: 20538525.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28845249.2951; val_optim_loss: 28845249.2951
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9309; val_auprc_score: 0.9848; val_best_acc_score: 0.9227; val_best_f1_score: 0.9556; train_kl_reg_loss: 89083.4731; train_edge_recon_loss: 7889680.0190; train_gene_expr_recon_loss: 20336873.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28315637.0343; train_optim_loss: 28315637.0343; val_kl_reg_loss: 88092.2467; val_edge_recon_loss: 8234142.6209; val_gene_expr_recon_loss: 20450927.3934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28773162.3279; val_optim_loss: 28773162.3279
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9305; val_auprc_score: 0.9846; val_best_acc_score: 0.9235; val_best_f1_score: 0.9559; train_kl_reg_loss: 88602.5199; train_edge_recon_loss: 7914871.1629; train_gene_expr_recon_loss: 20254877.7835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28258351.4600; train_optim_loss: 28258351.4600; val_kl_reg_loss: 87393.1051; val_edge_recon_loss: 8312167.7213; val_gene_expr_recon_loss: 20376892.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28776452.9098; val_optim_loss: 28776452.9098
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9330; val_auprc_score: 0.9853; val_best_acc_score: 0.9244; val_best_f1_score: 0.9566; train_kl_reg_loss: 87654.5907; train_edge_recon_loss: 7898024.5393; train_gene_expr_recon_loss: 20196157.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28181836.9548; train_optim_loss: 28181836.9548; val_kl_reg_loss: 88208.3640; val_edge_recon_loss: 8174015.4406; val_gene_expr_recon_loss: 20359661.6475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28621885.3770; val_optim_loss: 28621885.3770
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9330; val_auprc_score: 0.9853; val_best_acc_score: 0.9246; val_best_f1_score: 0.9566; train_kl_reg_loss: 87364.9361; train_edge_recon_loss: 7901034.7236; train_gene_expr_recon_loss: 20157034.4915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28145434.1672; train_optim_loss: 28145434.1672; val_kl_reg_loss: 86509.2000; val_edge_recon_loss: 8223195.3770; val_gene_expr_recon_loss: 20306535.8361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28616240.3689; val_optim_loss: 28616240.3689
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9329; val_auprc_score: 0.9855; val_best_acc_score: 0.9240; val_best_f1_score: 0.9562; train_kl_reg_loss: 85624.5964; train_edge_recon_loss: 7904472.5443; train_gene_expr_recon_loss: 20122749.8017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28112846.9402; train_optim_loss: 28112846.9402; val_kl_reg_loss: 85571.3653; val_edge_recon_loss: 8209064.2418; val_gene_expr_recon_loss: 20272581.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28567216.9426; val_optim_loss: 28567216.9426
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9331; val_auprc_score: 0.9853; val_best_acc_score: 0.9254; val_best_f1_score: 0.9572; train_kl_reg_loss: 84932.7659; train_edge_recon_loss: 7866086.4141; train_gene_expr_recon_loss: 20096343.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28047362.7529; train_optim_loss: 28047362.7529; val_kl_reg_loss: 85842.3810; val_edge_recon_loss: 8185462.0000; val_gene_expr_recon_loss: 20220010.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28491314.9754; val_optim_loss: 28491314.9754
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9295; val_auprc_score: 0.9844; val_best_acc_score: 0.9224; val_best_f1_score: 0.9554; train_kl_reg_loss: 83228.2799; train_edge_recon_loss: 7900929.9123; train_gene_expr_recon_loss: 19393487.7688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27377645.9479; train_optim_loss: 27377645.9479; val_kl_reg_loss: 52074.0197; val_edge_recon_loss: 8280304.5266; val_gene_expr_recon_loss: 19358954.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27691333.3934; val_optim_loss: 27691333.3934
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9319; val_auprc_score: 0.9851; val_best_acc_score: 0.9245; val_best_f1_score: 0.9566; train_kl_reg_loss: 82163.8009; train_edge_recon_loss: 7919033.3145; train_gene_expr_recon_loss: 19111788.8077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27112985.9242; train_optim_loss: 27112985.9242; val_kl_reg_loss: 51162.1092; val_edge_recon_loss: 8185965.0635; val_gene_expr_recon_loss: 19173924.7459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27411051.8443; val_optim_loss: 27411051.8443
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9324; val_auprc_score: 0.9852; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 78917.0448; train_edge_recon_loss: 7911711.3113; train_gene_expr_recon_loss: 18988900.7857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26979529.1585; train_optim_loss: 26979529.1585; val_kl_reg_loss: 51762.7625; val_edge_recon_loss: 8174200.7602; val_gene_expr_recon_loss: 19067565.7213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27293529.2787; val_optim_loss: 27293529.2787
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9329; val_auprc_score: 0.9853; val_best_acc_score: 0.9255; val_best_f1_score: 0.9572; train_kl_reg_loss: 74813.9124; train_edge_recon_loss: 7898347.9899; train_gene_expr_recon_loss: 18862771.6638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26835933.5669; train_optim_loss: 26835933.5669; val_kl_reg_loss: 52054.6022; val_edge_recon_loss: 8207943.4262; val_gene_expr_recon_loss: 18945634.9918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27205633.0000; val_optim_loss: 27205633.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9310; val_auprc_score: 0.9846; val_best_acc_score: 0.9251; val_best_f1_score: 0.9569; train_kl_reg_loss: 71978.1716; train_edge_recon_loss: 7878658.9719; train_gene_expr_recon_loss: 18779439.2216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26730076.3646; train_optim_loss: 26730076.3646; val_kl_reg_loss: 52085.2194; val_edge_recon_loss: 8228857.0799; val_gene_expr_recon_loss: 18881219.6148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27162161.8607; val_optim_loss: 27162161.8607
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9325; val_auprc_score: 0.9851; val_best_acc_score: 0.9257; val_best_f1_score: 0.9573; train_kl_reg_loss: 69960.8907; train_edge_recon_loss: 7868180.3013; train_gene_expr_recon_loss: 18722978.0128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26661119.2143; train_optim_loss: 26661119.2143; val_kl_reg_loss: 52476.7666; val_edge_recon_loss: 8163329.6414; val_gene_expr_recon_loss: 18859992.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27075799.3525; val_optim_loss: 27075799.3525
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9334; val_auprc_score: 0.9851; val_best_acc_score: 0.9249; val_best_f1_score: 0.9567; train_kl_reg_loss: 67676.6813; train_edge_recon_loss: 7899430.4370; train_gene_expr_recon_loss: 18680775.0005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26647882.1352; train_optim_loss: 26647882.1352; val_kl_reg_loss: 53110.0177; val_edge_recon_loss: 8286765.8709; val_gene_expr_recon_loss: 18798791.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27138667.6311; val_optim_loss: 27138667.6311
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9302; val_auprc_score: 0.9843; val_best_acc_score: 0.9244; val_best_f1_score: 0.9565; train_kl_reg_loss: 66462.8970; train_edge_recon_loss: 7863099.6907; train_gene_expr_recon_loss: 18619806.6030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26549369.2033; train_optim_loss: 26549369.2033; val_kl_reg_loss: 53905.8233; val_edge_recon_loss: 8271576.4836; val_gene_expr_recon_loss: 18722691.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 27048173.9836; val_optim_loss: 27048173.9836
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9330; val_auprc_score: 0.9853; val_best_acc_score: 0.9252; val_best_f1_score: 0.9570; train_kl_reg_loss: 66038.2880; train_edge_recon_loss: 7894578.8255; train_gene_expr_recon_loss: 18561150.8598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26521767.9534; train_optim_loss: 26521767.9534; val_kl_reg_loss: 53420.6380; val_edge_recon_loss: 8179301.2008; val_gene_expr_recon_loss: 18691561.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26924283.7131; val_optim_loss: 26924283.7131
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9341; val_auprc_score: 0.9855; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 65675.1936; train_edge_recon_loss: 7895508.8481; train_gene_expr_recon_loss: 18497776.1480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26458960.2019; train_optim_loss: 26458960.2019; val_kl_reg_loss: 52917.1788; val_edge_recon_loss: 8158757.8217; val_gene_expr_recon_loss: 18635922.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26847597.8361; val_optim_loss: 26847597.8361
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9335; val_auprc_score: 0.9855; val_best_acc_score: 0.9265; val_best_f1_score: 0.9578; train_kl_reg_loss: 65126.8697; train_edge_recon_loss: 7896943.7010; train_gene_expr_recon_loss: 18474417.4856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26436488.0594; train_optim_loss: 26436488.0594; val_kl_reg_loss: 54294.5333; val_edge_recon_loss: 8104247.3770; val_gene_expr_recon_loss: 18610568.0492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26769109.9016; val_optim_loss: 26769109.9016
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9344; val_auprc_score: 0.9855; val_best_acc_score: 0.9260; val_best_f1_score: 0.9575; train_kl_reg_loss: 65305.7683; train_edge_recon_loss: 7873514.6044; train_gene_expr_recon_loss: 18436206.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26375026.5263; train_optim_loss: 26375026.5263; val_kl_reg_loss: 54361.8725; val_edge_recon_loss: 8235031.1865; val_gene_expr_recon_loss: 18580759.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26870152.6803; val_optim_loss: 26870152.6803
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9352; val_auprc_score: 0.9857; val_best_acc_score: 0.9269; val_best_f1_score: 0.9579; train_kl_reg_loss: 65148.0467; train_edge_recon_loss: 7889884.3604; train_gene_expr_recon_loss: 18410015.3687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26365047.7524; train_optim_loss: 26365047.7524; val_kl_reg_loss: 54724.4656; val_edge_recon_loss: 8210081.4652; val_gene_expr_recon_loss: 18571134.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26835940.1639; val_optim_loss: 26835940.1639
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9346; val_auprc_score: 0.9857; val_best_acc_score: 0.9266; val_best_f1_score: 0.9577; train_kl_reg_loss: 64533.8856; train_edge_recon_loss: 7895140.5939; train_gene_expr_recon_loss: 18396165.4116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26355839.8620; train_optim_loss: 26355839.8620; val_kl_reg_loss: 54417.7083; val_edge_recon_loss: 8210011.6926; val_gene_expr_recon_loss: 18521552.4426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26785981.8525; val_optim_loss: 26785981.8525
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9342; val_auprc_score: 0.9856; val_best_acc_score: 0.9268; val_best_f1_score: 0.9580; train_kl_reg_loss: 63921.7893; train_edge_recon_loss: 7890072.5324; train_gene_expr_recon_loss: 18372585.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26326579.4244; train_optim_loss: 26326579.4244; val_kl_reg_loss: 54447.5041; val_edge_recon_loss: 8160175.9365; val_gene_expr_recon_loss: 18509813.2377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26724436.6885; val_optim_loss: 26724436.6885
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9340; val_auprc_score: 0.9855; val_best_acc_score: 0.9259; val_best_f1_score: 0.9575; train_kl_reg_loss: 63738.9339; train_edge_recon_loss: 7885269.0852; train_gene_expr_recon_loss: 18362827.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26311836.0192; train_optim_loss: 26311836.0192; val_kl_reg_loss: 54536.8783; val_edge_recon_loss: 8158858.9877; val_gene_expr_recon_loss: 18490824.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26704220.3361; val_optim_loss: 26704220.3361
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9365; val_auprc_score: 0.9860; val_best_acc_score: 0.9274; val_best_f1_score: 0.9582; train_kl_reg_loss: 63057.9660; train_edge_recon_loss: 7918828.3129; train_gene_expr_recon_loss: 18339689.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26321575.8913; train_optim_loss: 26321575.8913; val_kl_reg_loss: 54446.2988; val_edge_recon_loss: 8190327.9037; val_gene_expr_recon_loss: 18489088.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26733862.9180; val_optim_loss: 26733862.9180
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9339; val_auprc_score: 0.9851; val_best_acc_score: 0.9267; val_best_f1_score: 0.9577; train_kl_reg_loss: 62988.9250; train_edge_recon_loss: 7906195.0870; train_gene_expr_recon_loss: 18315752.8077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26284936.8269; train_optim_loss: 26284936.8269; val_kl_reg_loss: 55389.3328; val_edge_recon_loss: 8262749.2951; val_gene_expr_recon_loss: 18475309.0902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26793447.7623; val_optim_loss: 26793447.7623
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9351; val_auprc_score: 0.9854; val_best_acc_score: 0.9277; val_best_f1_score: 0.9584; train_kl_reg_loss: 63069.1591; train_edge_recon_loss: 7879497.6297; train_gene_expr_recon_loss: 18310421.9461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26252988.7328; train_optim_loss: 26252988.7328; val_kl_reg_loss: 54709.8843; val_edge_recon_loss: 8208547.6230; val_gene_expr_recon_loss: 18475170.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26738427.5492; val_optim_loss: 26738427.5492
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9352; val_auprc_score: 0.9858; val_best_acc_score: 0.9266; val_best_f1_score: 0.9578; train_kl_reg_loss: 62475.2592; train_edge_recon_loss: 7878794.4020; train_gene_expr_recon_loss: 18301776.3344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26243045.9973; train_optim_loss: 26243045.9973; val_kl_reg_loss: 54631.4409; val_edge_recon_loss: 8199798.0451; val_gene_expr_recon_loss: 18458086.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26712515.5738; val_optim_loss: 26712515.5738

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9348; val_auprc_score: 0.9856; val_best_acc_score: 0.9273; val_best_f1_score: 0.9582; train_kl_reg_loss: 62004.9180; train_edge_recon_loss: 7889253.3821; train_gene_expr_recon_loss: 18263010.4989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26214268.8095; train_optim_loss: 26214268.8095; val_kl_reg_loss: 54137.4215; val_edge_recon_loss: 8180062.1086; val_gene_expr_recon_loss: 18413998.3115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26648197.7787; val_optim_loss: 26648197.7787
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9358; val_auprc_score: 0.9857; val_best_acc_score: 0.9276; val_best_f1_score: 0.9583; train_kl_reg_loss: 62097.2410; train_edge_recon_loss: 7882356.5761; train_gene_expr_recon_loss: 18256630.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26201083.9561; train_optim_loss: 26201083.9561; val_kl_reg_loss: 54389.1861; val_edge_recon_loss: 8171384.6598; val_gene_expr_recon_loss: 18434991.2377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26660765.0492; val_optim_loss: 26660765.0492
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9374; val_auprc_score: 0.9864; val_best_acc_score: 0.9286; val_best_f1_score: 0.9589; train_kl_reg_loss: 62211.8066; train_edge_recon_loss: 7880386.2264; train_gene_expr_recon_loss: 18254288.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26196886.9804; train_optim_loss: 26196886.9804; val_kl_reg_loss: 54375.6016; val_edge_recon_loss: 8081280.5840; val_gene_expr_recon_loss: 18425256.4016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26560912.5902; val_optim_loss: 26560912.5902
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9357; val_auprc_score: 0.9858; val_best_acc_score: 0.9275; val_best_f1_score: 0.9583; train_kl_reg_loss: 62109.5778; train_edge_recon_loss: 7858037.5781; train_gene_expr_recon_loss: 18254192.3554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26174339.5158; train_optim_loss: 26174339.5158; val_kl_reg_loss: 54326.7254; val_edge_recon_loss: 8156547.9775; val_gene_expr_recon_loss: 18413139.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26624013.8033; val_optim_loss: 26624013.8033
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9364; val_auprc_score: 0.9858; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 61910.2130; train_edge_recon_loss: 7897954.2035; train_gene_expr_recon_loss: 18255393.4454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26215257.8538; train_optim_loss: 26215257.8538; val_kl_reg_loss: 54360.5597; val_edge_recon_loss: 8249896.4324; val_gene_expr_recon_loss: 18431652.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26735909.7049; val_optim_loss: 26735909.7049
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9378; val_auprc_score: 0.9862; val_best_acc_score: 0.9281; val_best_f1_score: 0.9586; train_kl_reg_loss: 61930.5385; train_edge_recon_loss: 7893666.2218; train_gene_expr_recon_loss: 18252775.1617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26208371.9278; train_optim_loss: 26208371.9278; val_kl_reg_loss: 54350.1003; val_edge_recon_loss: 8204789.4467; val_gene_expr_recon_loss: 18412515.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26671655.2459; val_optim_loss: 26671655.2459
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9357; val_auprc_score: 0.9859; val_best_acc_score: 0.9280; val_best_f1_score: 0.9586; train_kl_reg_loss: 61901.8697; train_edge_recon_loss: 7869029.2887; train_gene_expr_recon_loss: 18241952.9283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26172884.1069; train_optim_loss: 26172884.1069; val_kl_reg_loss: 54351.2641; val_edge_recon_loss: 8116911.9713; val_gene_expr_recon_loss: 18409592.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26580856.0492; val_optim_loss: 26580856.0492

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9358; val_auprc_score: 0.9857; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 61861.1503; train_edge_recon_loss: 7853577.1855; train_gene_expr_recon_loss: 18240913.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26156351.5861; train_optim_loss: 26156351.5861; val_kl_reg_loss: 54366.7576; val_edge_recon_loss: 8228842.6496; val_gene_expr_recon_loss: 18394529.0246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26677738.4508; val_optim_loss: 26677738.4508
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9361; val_auprc_score: 0.9859; val_best_acc_score: 0.9277; val_best_f1_score: 0.9583; train_kl_reg_loss: 61856.2398; train_edge_recon_loss: 7866242.3730; train_gene_expr_recon_loss: 18238951.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26167050.0786; train_optim_loss: 26167050.0786; val_kl_reg_loss: 54329.7785; val_edge_recon_loss: 8199217.1291; val_gene_expr_recon_loss: 18413025.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26666572.2213; val_optim_loss: 26666572.2213
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9357; val_auprc_score: 0.9860; val_best_acc_score: 0.9274; val_best_f1_score: 0.9583; train_kl_reg_loss: 61840.7225; train_edge_recon_loss: 7874386.9559; train_gene_expr_recon_loss: 18243385.2499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26179612.9328; train_optim_loss: 26179612.9328; val_kl_reg_loss: 54355.1002; val_edge_recon_loss: 8115564.0984; val_gene_expr_recon_loss: 18386883.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26556803.0902; val_optim_loss: 26556803.0902
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9358; val_auprc_score: 0.9858; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 61842.1404; train_edge_recon_loss: 7854946.9477; train_gene_expr_recon_loss: 18237753.3705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26154542.4769; train_optim_loss: 26154542.4769; val_kl_reg_loss: 54374.4009; val_edge_recon_loss: 8174599.8586; val_gene_expr_recon_loss: 18409007.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26637982.1639; val_optim_loss: 26637982.1639
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9344; val_auprc_score: 0.9854; val_best_acc_score: 0.9267; val_best_f1_score: 0.9578; train_kl_reg_loss: 61869.2376; train_edge_recon_loss: 7853295.8586; train_gene_expr_recon_loss: 18235099.1128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26150264.1919; train_optim_loss: 26150264.1919; val_kl_reg_loss: 54385.8236; val_edge_recon_loss: 8215004.9201; val_gene_expr_recon_loss: 18403349.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26672740.3361; val_optim_loss: 26672740.3361
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9346; val_auprc_score: 0.9854; val_best_acc_score: 0.9273; val_best_f1_score: 0.9581; train_kl_reg_loss: 61881.0284; train_edge_recon_loss: 7890780.7366; train_gene_expr_recon_loss: 18237720.9603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26190382.7172; train_optim_loss: 26190382.7172; val_kl_reg_loss: 54410.5866; val_edge_recon_loss: 8210271.5082; val_gene_expr_recon_loss: 18414660.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26679342.8033; val_optim_loss: 26679342.8033
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9368; val_auprc_score: 0.9861; val_best_acc_score: 0.9279; val_best_f1_score: 0.9585; train_kl_reg_loss: 61878.6030; train_edge_recon_loss: 7853379.5605; train_gene_expr_recon_loss: 18254249.1156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26169507.2581; train_optim_loss: 26169507.2581; val_kl_reg_loss: 54438.2684; val_edge_recon_loss: 8133556.1762; val_gene_expr_recon_loss: 18424717.7787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26612712.1639; val_optim_loss: 26612712.1639

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9359; val_auprc_score: 0.9861; val_best_acc_score: 0.9285; val_best_f1_score: 0.9590; train_kl_reg_loss: 61853.1375; train_edge_recon_loss: 7877336.1135; train_gene_expr_recon_loss: 18249041.6994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26188230.9493; train_optim_loss: 26188230.9493; val_kl_reg_loss: 54405.7155; val_edge_recon_loss: 8070427.2746; val_gene_expr_recon_loss: 18415680.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26540513.8689; val_optim_loss: 26540513.8689
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9363; val_auprc_score: 0.9863; val_best_acc_score: 0.9280; val_best_f1_score: 0.9587; train_kl_reg_loss: 61854.5894; train_edge_recon_loss: 7863198.4052; train_gene_expr_recon_loss: 18250878.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26175931.3157; train_optim_loss: 26175931.3157; val_kl_reg_loss: 54383.0775; val_edge_recon_loss: 8053698.0154; val_gene_expr_recon_loss: 18419939.6148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26528020.6721; val_optim_loss: 26528020.6721
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9343; val_auprc_score: 0.9854; val_best_acc_score: 0.9274; val_best_f1_score: 0.9582; train_kl_reg_loss: 61830.3028; train_edge_recon_loss: 7890298.5418; train_gene_expr_recon_loss: 18246385.1247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26198513.9424; train_optim_loss: 26198513.9424; val_kl_reg_loss: 54396.5468; val_edge_recon_loss: 8213010.0881; val_gene_expr_recon_loss: 18407323.2049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26674729.9098; val_optim_loss: 26674729.9098
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9370; val_auprc_score: 0.9864; val_best_acc_score: 0.9279; val_best_f1_score: 0.9585; train_kl_reg_loss: 61863.3544; train_edge_recon_loss: 7873231.2177; train_gene_expr_recon_loss: 18253764.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26188858.6231; train_optim_loss: 26188858.6231; val_kl_reg_loss: 54407.8302; val_edge_recon_loss: 8116260.2131; val_gene_expr_recon_loss: 18437476.8770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26608144.9262; val_optim_loss: 26608144.9262
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9355; val_auprc_score: 0.9856; val_best_acc_score: 0.9290; val_best_f1_score: 0.9591; train_kl_reg_loss: 61847.4404; train_edge_recon_loss: 7864552.8616; train_gene_expr_recon_loss: 18251228.2759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26177628.5911; train_optim_loss: 26177628.5911; val_kl_reg_loss: 54432.2676; val_edge_recon_loss: 8109984.9693; val_gene_expr_recon_loss: 18424187.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26588605.0902; val_optim_loss: 26588605.0902
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9368; val_auprc_score: 0.9862; val_best_acc_score: 0.9276; val_best_f1_score: 0.9583; train_kl_reg_loss: 61848.3063; train_edge_recon_loss: 7855504.0916; train_gene_expr_recon_loss: 18246957.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26164310.1014; train_optim_loss: 26164310.1014; val_kl_reg_loss: 54413.4325; val_edge_recon_loss: 8190699.8504; val_gene_expr_recon_loss: 18408443.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26653556.5984; val_optim_loss: 26653556.5984

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9353; val_auprc_score: 0.9855; val_best_acc_score: 0.9272; val_best_f1_score: 0.9580; train_kl_reg_loss: 61860.1131; train_edge_recon_loss: 7858075.7040; train_gene_expr_recon_loss: 18253268.8177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26173204.6176; train_optim_loss: 26173204.6176; val_kl_reg_loss: 54378.8166; val_edge_recon_loss: 8232483.5758; val_gene_expr_recon_loss: 18408023.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26694885.9262; val_optim_loss: 26694885.9262
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9353; val_auprc_score: 0.9857; val_best_acc_score: 0.9277; val_best_f1_score: 0.9584; train_kl_reg_loss: 61853.2623; train_edge_recon_loss: 7854069.0030; train_gene_expr_recon_loss: 18249570.7775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26165493.0471; train_optim_loss: 26165493.0471; val_kl_reg_loss: 54368.7541; val_edge_recon_loss: 8167485.3504; val_gene_expr_recon_loss: 18415777.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26637631.5902; val_optim_loss: 26637631.5902
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9356; val_auprc_score: 0.9859; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 61853.1356; train_edge_recon_loss: 7866243.1603; train_gene_expr_recon_loss: 18253977.7131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26182073.9854; train_optim_loss: 26182073.9854; val_kl_reg_loss: 54355.4992; val_edge_recon_loss: 8146496.7193; val_gene_expr_recon_loss: 18406620.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26607472.9590; val_optim_loss: 26607472.9590
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9361; val_auprc_score: 0.9858; val_best_acc_score: 0.9273; val_best_f1_score: 0.9581; train_kl_reg_loss: 61861.2533; train_edge_recon_loss: 7874220.0194; train_gene_expr_recon_loss: 18256122.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26192203.8785; train_optim_loss: 26192203.8785; val_kl_reg_loss: 54366.1390; val_edge_recon_loss: 8180466.0020; val_gene_expr_recon_loss: 18424967.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26659799.7295; val_optim_loss: 26659799.7295

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 697 min 52 sec.
Using best model state, which was in epoch 61.

--- MODEL EVALUATION ---
val AUROC score: 0.9356
val AUPRC score: 0.9858
val best accuracy score: 0.9282
val best F1 score: 0.9588
val target rna MSE score: 0.5498
val source rna MSE score: 0.1728
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0553
Val cat covariate2 mean sim diff: 0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
