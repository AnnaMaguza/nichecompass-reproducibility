[True]
Run timestamp: 10102023_070306_179.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_179']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7189; val_auprc_score: 0.6950; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 79853.8878; train_edge_recon_loss: 758774.4271; train_gene_expr_recon_loss: 22951580.5152; train_masked_gp_l1_reg_loss: 34523.5055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4043644.8485; train_chrom_access_recon_loss: 988578.3570; train_global_loss: 28856955.5455; train_optim_loss: 28856955.5455; val_kl_reg_loss: 92335.0684; val_edge_recon_loss: 813129.1562; val_gene_expr_recon_loss: 21280619.2500; val_masked_gp_l1_reg_loss: 37417.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2724016.5000; val_chrom_access_recon_loss: 948096.7734; val_global_loss: 25895614.7500; val_optim_loss: 25895614.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7099; val_auprc_score: 0.7076; val_best_acc_score: 0.5999; val_best_f1_score: 0.7008; train_kl_reg_loss: 94039.6301; train_edge_recon_loss: 748032.4839; train_gene_expr_recon_loss: 21198265.9394; train_masked_gp_l1_reg_loss: 38334.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1773778.0701; train_chrom_access_recon_loss: 942942.9441; train_global_loss: 24795393.8485; train_optim_loss: 24795393.8485; val_kl_reg_loss: 82604.3867; val_edge_recon_loss: 811896.2734; val_gene_expr_recon_loss: 21242540.7500; val_masked_gp_l1_reg_loss: 39455.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1056462.2500; val_chrom_access_recon_loss: 937567.4844; val_global_loss: 24170526.2500; val_optim_loss: 24170526.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7745; val_auprc_score: 0.7599; val_best_acc_score: 0.6851; val_best_f1_score: 0.7246; train_kl_reg_loss: 80185.7579; train_edge_recon_loss: 735184.6723; train_gene_expr_recon_loss: 21017582.5152; train_masked_gp_l1_reg_loss: 40508.4905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 726483.6652; train_chrom_access_recon_loss: 936764.7699; train_global_loss: 23536709.8182; train_optim_loss: 23536709.8182; val_kl_reg_loss: 73463.0098; val_edge_recon_loss: 801141.0469; val_gene_expr_recon_loss: 21026575.2500; val_masked_gp_l1_reg_loss: 41688.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 491263.7188; val_chrom_access_recon_loss: 936742.3672; val_global_loss: 23370873.5000; val_optim_loss: 23370873.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8397; val_auprc_score: 0.8204; val_best_acc_score: 0.7577; val_best_f1_score: 0.7783; train_kl_reg_loss: 70725.7296; train_edge_recon_loss: 720918.3627; train_gene_expr_recon_loss: 20866321.3030; train_masked_gp_l1_reg_loss: 42910.5625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 381035.1009; train_chrom_access_recon_loss: 930961.4669; train_global_loss: 23012872.4242; train_optim_loss: 23012872.4242; val_kl_reg_loss: 63490.6182; val_edge_recon_loss: 747513.0000; val_gene_expr_recon_loss: 20841297.7500; val_masked_gp_l1_reg_loss: 44258.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 300684.5625; val_chrom_access_recon_loss: 929796.6641; val_global_loss: 22927040.0000; val_optim_loss: 22927040.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8787; val_auprc_score: 0.8434; val_best_acc_score: 0.8119; val_best_f1_score: 0.8245; train_kl_reg_loss: 70157.8755; train_edge_recon_loss: 678102.0142; train_gene_expr_recon_loss: 20696199.7273; train_masked_gp_l1_reg_loss: 45622.2646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 257796.3494; train_chrom_access_recon_loss: 926736.8362; train_global_loss: 22674614.7273; train_optim_loss: 22674614.7273; val_kl_reg_loss: 77168.8730; val_edge_recon_loss: 651271.2578; val_gene_expr_recon_loss: 20612150.2500; val_masked_gp_l1_reg_loss: 47136.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 223414.2656; val_chrom_access_recon_loss: 921184.3516; val_global_loss: 22532325.7500; val_optim_loss: 22532325.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8938; val_auprc_score: 0.8568; val_best_acc_score: 0.8251; val_best_f1_score: 0.8427; train_kl_reg_loss: 79076.8490; train_edge_recon_loss: 631963.6600; train_gene_expr_recon_loss: 20575167.3939; train_masked_gp_l1_reg_loss: 48548.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200149.0069; train_chrom_access_recon_loss: 921017.3163; train_global_loss: 22455922.6364; train_optim_loss: 22455922.6364; val_kl_reg_loss: 77724.3066; val_edge_recon_loss: 630834.0078; val_gene_expr_recon_loss: 20607717.2500; val_masked_gp_l1_reg_loss: 49955.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179438.2500; val_chrom_access_recon_loss: 911875.9062; val_global_loss: 22457545.2500; val_optim_loss: 22457545.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9056; val_auprc_score: 0.8760; val_best_acc_score: 0.8340; val_best_f1_score: 0.8467; train_kl_reg_loss: 78287.0498; train_edge_recon_loss: 617225.0104; train_gene_expr_recon_loss: 20472391.8182; train_masked_gp_l1_reg_loss: 51082.5284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163828.8300; train_chrom_access_recon_loss: 917266.1562; train_global_loss: 22300081.4848; train_optim_loss: 22300081.4848; val_kl_reg_loss: 77447.2979; val_edge_recon_loss: 623732.9844; val_gene_expr_recon_loss: 20493822.2500; val_masked_gp_l1_reg_loss: 52274.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151216.2344; val_chrom_access_recon_loss: 918711.4062; val_global_loss: 22317203.7500; val_optim_loss: 22317203.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9161; val_auprc_score: 0.8925; val_best_acc_score: 0.8442; val_best_f1_score: 0.8562; train_kl_reg_loss: 75032.8194; train_edge_recon_loss: 610046.6780; train_gene_expr_recon_loss: 20366742.9394; train_masked_gp_l1_reg_loss: 53206.0208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140018.6757; train_chrom_access_recon_loss: 913554.6080; train_global_loss: 22158601.7273; train_optim_loss: 22158601.7273; val_kl_reg_loss: 72891.0830; val_edge_recon_loss: 611869.5703; val_gene_expr_recon_loss: 20488610.2500; val_masked_gp_l1_reg_loss: 54172.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130866.0625; val_chrom_access_recon_loss: 915981.2500; val_global_loss: 22274390.0000; val_optim_loss: 22274390.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9124; val_auprc_score: 0.8798; val_best_acc_score: 0.8466; val_best_f1_score: 0.8564; train_kl_reg_loss: 73050.7964; train_edge_recon_loss: 605625.6619; train_gene_expr_recon_loss: 20283167.1818; train_masked_gp_l1_reg_loss: 54932.3084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123913.1464; train_chrom_access_recon_loss: 910279.6364; train_global_loss: 22050968.6364; train_optim_loss: 22050968.6364; val_kl_reg_loss: 70512.3770; val_edge_recon_loss: 615357.5781; val_gene_expr_recon_loss: 20183958.7500; val_masked_gp_l1_reg_loss: 55772.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118403.8906; val_chrom_access_recon_loss: 904796.9297; val_global_loss: 21948802.0000; val_optim_loss: 21948802.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9161; val_auprc_score: 0.8873; val_best_acc_score: 0.8541; val_best_f1_score: 0.8617; train_kl_reg_loss: 70149.4283; train_edge_recon_loss: 603841.9669; train_gene_expr_recon_loss: 20221809.5758; train_masked_gp_l1_reg_loss: 56472.9234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113341.2783; train_chrom_access_recon_loss: 907809.6742; train_global_loss: 21973424.6667; train_optim_loss: 21973424.6667; val_kl_reg_loss: 68371.2910; val_edge_recon_loss: 609081.2109; val_gene_expr_recon_loss: 20203793.2500; val_masked_gp_l1_reg_loss: 57176.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109360.1797; val_chrom_access_recon_loss: 908598.1016; val_global_loss: 21956380.0000; val_optim_loss: 21956380.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9265; val_auprc_score: 0.9030; val_best_acc_score: 0.8600; val_best_f1_score: 0.8680; train_kl_reg_loss: 68899.5803; train_edge_recon_loss: 599689.3419; train_gene_expr_recon_loss: 20114992.2424; train_masked_gp_l1_reg_loss: 57762.6433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106361.4129; train_chrom_access_recon_loss: 903411.5104; train_global_loss: 21851116.6970; train_optim_loss: 21851116.6970; val_kl_reg_loss: 69631.0771; val_edge_recon_loss: 603245.2734; val_gene_expr_recon_loss: 20137860.0000; val_masked_gp_l1_reg_loss: 58380.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104623.8984; val_chrom_access_recon_loss: 903341.3047; val_global_loss: 21877081.7500; val_optim_loss: 21877081.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9342; val_auprc_score: 0.9182; val_best_acc_score: 0.8702; val_best_f1_score: 0.8762; train_kl_reg_loss: 67423.3287; train_edge_recon_loss: 595566.6979; train_gene_expr_recon_loss: 20055562.8788; train_masked_gp_l1_reg_loss: 58898.8336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102470.6185; train_chrom_access_recon_loss: 901622.8409; train_global_loss: 21781545.2727; train_optim_loss: 21781545.2727; val_kl_reg_loss: 66094.2588; val_edge_recon_loss: 598338.8984; val_gene_expr_recon_loss: 20213009.0000; val_masked_gp_l1_reg_loss: 59567.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101080.6094; val_chrom_access_recon_loss: 905462.5156; val_global_loss: 21943552.2500; val_optim_loss: 21943552.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9351; val_auprc_score: 0.9143; val_best_acc_score: 0.8737; val_best_f1_score: 0.8797; train_kl_reg_loss: 66376.7972; train_edge_recon_loss: 591821.5777; train_gene_expr_recon_loss: 19978558.2727; train_masked_gp_l1_reg_loss: 60096.1273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98904.5861; train_chrom_access_recon_loss: 898285.1780; train_global_loss: 21694042.5455; train_optim_loss: 21694042.5455; val_kl_reg_loss: 66551.8257; val_edge_recon_loss: 595132.2656; val_gene_expr_recon_loss: 20042825.5000; val_masked_gp_l1_reg_loss: 60601.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97794.1406; val_chrom_access_recon_loss: 898457.9844; val_global_loss: 21761363.7500; val_optim_loss: 21761363.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9347; val_auprc_score: 0.9169; val_best_acc_score: 0.8778; val_best_f1_score: 0.8812; train_kl_reg_loss: 65392.2302; train_edge_recon_loss: 590238.6856; train_gene_expr_recon_loss: 19916814.3636; train_masked_gp_l1_reg_loss: 61122.8493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95609.1349; train_chrom_access_recon_loss: 895691.7093; train_global_loss: 21624869.0909; train_optim_loss: 21624869.0909; val_kl_reg_loss: 65400.4175; val_edge_recon_loss: 596791.7812; val_gene_expr_recon_loss: 19883394.2500; val_masked_gp_l1_reg_loss: 61695.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94493.4844; val_chrom_access_recon_loss: 891375.2812; val_global_loss: 21593151.7500; val_optim_loss: 21593151.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9487; val_auprc_score: 0.9349; val_best_acc_score: 0.8923; val_best_f1_score: 0.8962; train_kl_reg_loss: 64122.5089; train_edge_recon_loss: 589933.0417; train_gene_expr_recon_loss: 19847097.2121; train_masked_gp_l1_reg_loss: 62090.6444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92894.1166; train_chrom_access_recon_loss: 892707.1714; train_global_loss: 21548844.7576; train_optim_loss: 21548844.7576; val_kl_reg_loss: 64338.1870; val_edge_recon_loss: 584140.9766; val_gene_expr_recon_loss: 19897405.0000; val_masked_gp_l1_reg_loss: 62658.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92900.2969; val_chrom_access_recon_loss: 891039.0781; val_global_loss: 21592481.2500; val_optim_loss: 21592481.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9436; val_auprc_score: 0.9204; val_best_acc_score: 0.8901; val_best_f1_score: 0.8939; train_kl_reg_loss: 63014.6951; train_edge_recon_loss: 587791.2642; train_gene_expr_recon_loss: 19802454.0000; train_masked_gp_l1_reg_loss: 63142.9901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91129.4361; train_chrom_access_recon_loss: 890782.2443; train_global_loss: 21498314.5455; train_optim_loss: 21498314.5455; val_kl_reg_loss: 61366.8091; val_edge_recon_loss: 590300.8281; val_gene_expr_recon_loss: 19747466.5000; val_masked_gp_l1_reg_loss: 63633.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90465.2266; val_chrom_access_recon_loss: 894081.3828; val_global_loss: 21447315.0000; val_optim_loss: 21447315.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9453; val_auprc_score: 0.9256; val_best_acc_score: 0.8941; val_best_f1_score: 0.8986; train_kl_reg_loss: 62007.9503; train_edge_recon_loss: 587410.1544; train_gene_expr_recon_loss: 19724579.9091; train_masked_gp_l1_reg_loss: 64049.6958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89099.4057; train_chrom_access_recon_loss: 887480.5256; train_global_loss: 21414627.8182; train_optim_loss: 21414627.8182; val_kl_reg_loss: 62816.5078; val_edge_recon_loss: 592215.0625; val_gene_expr_recon_loss: 19865326.7500; val_masked_gp_l1_reg_loss: 64569.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89396.7891; val_chrom_access_recon_loss: 895275.8281; val_global_loss: 21569600.5000; val_optim_loss: 21569600.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9449; val_auprc_score: 0.9283; val_best_acc_score: 0.8901; val_best_f1_score: 0.8959; train_kl_reg_loss: 61458.8263; train_edge_recon_loss: 586351.1080; train_gene_expr_recon_loss: 19691260.4545; train_masked_gp_l1_reg_loss: 65000.8501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87759.1007; train_chrom_access_recon_loss: 886728.4848; train_global_loss: 21378558.6970; train_optim_loss: 21378558.6970; val_kl_reg_loss: 61579.8457; val_edge_recon_loss: 587196.3203; val_gene_expr_recon_loss: 19724081.7500; val_masked_gp_l1_reg_loss: 65505.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86996.2812; val_chrom_access_recon_loss: 882602.5234; val_global_loss: 21407962.2500; val_optim_loss: 21407962.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9504; val_auprc_score: 0.9354; val_best_acc_score: 0.8949; val_best_f1_score: 0.9009; train_kl_reg_loss: 60563.1232; train_edge_recon_loss: 583268.3343; train_gene_expr_recon_loss: 19625816.9697; train_masked_gp_l1_reg_loss: 65919.3533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86305.1206; train_chrom_access_recon_loss: 883182.4555; train_global_loss: 21305055.4242; train_optim_loss: 21305055.4242; val_kl_reg_loss: 60191.6079; val_edge_recon_loss: 586149.9844; val_gene_expr_recon_loss: 19639210.0000; val_masked_gp_l1_reg_loss: 66589.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86159.8203; val_chrom_access_recon_loss: 887439.0547; val_global_loss: 21325741.2500; val_optim_loss: 21325741.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9461; val_auprc_score: 0.9282; val_best_acc_score: 0.8864; val_best_f1_score: 0.8924; train_kl_reg_loss: 59862.7524; train_edge_recon_loss: 582005.6392; train_gene_expr_recon_loss: 19599735.0909; train_masked_gp_l1_reg_loss: 66941.3646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85079.8600; train_chrom_access_recon_loss: 882397.0767; train_global_loss: 21276021.7879; train_optim_loss: 21276021.7879; val_kl_reg_loss: 61640.5215; val_edge_recon_loss: 593615.9766; val_gene_expr_recon_loss: 19688560.2500; val_masked_gp_l1_reg_loss: 67410.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84853.3203; val_chrom_access_recon_loss: 880939.3281; val_global_loss: 21377020.2500; val_optim_loss: 21377020.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9469; val_auprc_score: 0.9288; val_best_acc_score: 0.8917; val_best_f1_score: 0.8950; train_kl_reg_loss: 58934.4472; train_edge_recon_loss: 582978.8087; train_gene_expr_recon_loss: 19535737.1515; train_masked_gp_l1_reg_loss: 67885.0896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84194.3804; train_chrom_access_recon_loss: 879818.7737; train_global_loss: 21209548.6970; train_optim_loss: 21209548.6970; val_kl_reg_loss: 58760.2476; val_edge_recon_loss: 591392.6250; val_gene_expr_recon_loss: 19654658.7500; val_masked_gp_l1_reg_loss: 68477.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84164.7031; val_chrom_access_recon_loss: 874576.7969; val_global_loss: 21332030.2500; val_optim_loss: 21332030.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9575; val_auprc_score: 0.9396; val_best_acc_score: 0.9035; val_best_f1_score: 0.9071; train_kl_reg_loss: 58549.4413; train_edge_recon_loss: 580479.2045; train_gene_expr_recon_loss: 19480089.3636; train_masked_gp_l1_reg_loss: 69007.6938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83687.5714; train_chrom_access_recon_loss: 878505.0786; train_global_loss: 21150318.5152; train_optim_loss: 21150318.5152; val_kl_reg_loss: 59046.3315; val_edge_recon_loss: 582133.3203; val_gene_expr_recon_loss: 19569097.5000; val_masked_gp_l1_reg_loss: 69568.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84075.8750; val_chrom_access_recon_loss: 878161.4375; val_global_loss: 21242082.0000; val_optim_loss: 21242082.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9555; val_auprc_score: 0.9445; val_best_acc_score: 0.9049; val_best_f1_score: 0.9075; train_kl_reg_loss: 57967.4438; train_edge_recon_loss: 580426.7670; train_gene_expr_recon_loss: 19397742.5455; train_masked_gp_l1_reg_loss: 70082.9880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83370.0922; train_chrom_access_recon_loss: 874674.2083; train_global_loss: 21064263.9394; train_optim_loss: 21064263.9394; val_kl_reg_loss: 57254.2749; val_edge_recon_loss: 586931.4375; val_gene_expr_recon_loss: 19466730.2500; val_masked_gp_l1_reg_loss: 70598.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83161.1641; val_chrom_access_recon_loss: 874245.7656; val_global_loss: 21138921.5000; val_optim_loss: 21138921.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9506; val_auprc_score: 0.9245; val_best_acc_score: 0.9009; val_best_f1_score: 0.9058; train_kl_reg_loss: 57291.6580; train_edge_recon_loss: 577320.0511; train_gene_expr_recon_loss: 19353357.9394; train_masked_gp_l1_reg_loss: 71242.1487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82728.2315; train_chrom_access_recon_loss: 873020.4517; train_global_loss: 21014960.6970; train_optim_loss: 21014960.6970; val_kl_reg_loss: 57132.0181; val_edge_recon_loss: 583696.2188; val_gene_expr_recon_loss: 19415825.2500; val_masked_gp_l1_reg_loss: 71814.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82844.8125; val_chrom_access_recon_loss: 882259.6641; val_global_loss: 21093571.5000; val_optim_loss: 21093571.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9539; val_auprc_score: 0.9349; val_best_acc_score: 0.9041; val_best_f1_score: 0.9076; train_kl_reg_loss: 56682.1207; train_edge_recon_loss: 579389.3902; train_gene_expr_recon_loss: 19338109.7879; train_masked_gp_l1_reg_loss: 72413.9110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82328.1216; train_chrom_access_recon_loss: 872447.0114; train_global_loss: 21001370.3939; train_optim_loss: 21001370.3939; val_kl_reg_loss: 56524.5498; val_edge_recon_loss: 582776.0078; val_gene_expr_recon_loss: 19465009.5000; val_masked_gp_l1_reg_loss: 73188.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82479.2656; val_chrom_access_recon_loss: 888281.2812; val_global_loss: 21148259.7500; val_optim_loss: 21148259.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9555; val_auprc_score: 0.9438; val_best_acc_score: 0.8987; val_best_f1_score: 0.9030; train_kl_reg_loss: 56285.2997; train_edge_recon_loss: 578272.5180; train_gene_expr_recon_loss: 19276948.2424; train_masked_gp_l1_reg_loss: 73844.8675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82206.1932; train_chrom_access_recon_loss: 871231.4337; train_global_loss: 20938788.3030; train_optim_loss: 20938788.3030; val_kl_reg_loss: 56862.0723; val_edge_recon_loss: 581240.4062; val_gene_expr_recon_loss: 19317813.7500; val_masked_gp_l1_reg_loss: 74487.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81286.6797; val_chrom_access_recon_loss: 873823.0469; val_global_loss: 20985513.2500; val_optim_loss: 20985513.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9500; val_auprc_score: 0.9272; val_best_acc_score: 0.9041; val_best_f1_score: 0.9078; train_kl_reg_loss: 55895.5958; train_edge_recon_loss: 577255.5057; train_gene_expr_recon_loss: 19221639.3333; train_masked_gp_l1_reg_loss: 75224.3795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81402.6074; train_chrom_access_recon_loss: 869283.9848; train_global_loss: 20880701.2727; train_optim_loss: 20880701.2727; val_kl_reg_loss: 56547.1904; val_edge_recon_loss: 579993.7031; val_gene_expr_recon_loss: 19302641.5000; val_masked_gp_l1_reg_loss: 75893.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81573.2656; val_chrom_access_recon_loss: 867876.3203; val_global_loss: 20964526.5000; val_optim_loss: 20964526.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9571; val_auprc_score: 0.9389; val_best_acc_score: 0.9078; val_best_f1_score: 0.9119; train_kl_reg_loss: 55702.7754; train_edge_recon_loss: 577767.8040; train_gene_expr_recon_loss: 19158883.3939; train_masked_gp_l1_reg_loss: 76617.8243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81133.9478; train_chrom_access_recon_loss: 868200.2102; train_global_loss: 20818305.8788; train_optim_loss: 20818305.8788; val_kl_reg_loss: 55987.1377; val_edge_recon_loss: 580519.2188; val_gene_expr_recon_loss: 19423814.7500; val_masked_gp_l1_reg_loss: 77448.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81003.0781; val_chrom_access_recon_loss: 873599.2578; val_global_loss: 21092372.2500; val_optim_loss: 21092372.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9495; val_auprc_score: 0.9312; val_best_acc_score: 0.9003; val_best_f1_score: 0.9052; train_kl_reg_loss: 55443.4058; train_edge_recon_loss: 576889.2670; train_gene_expr_recon_loss: 19080833.1818; train_masked_gp_l1_reg_loss: 78171.2489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80770.6367; train_chrom_access_recon_loss: 865978.8021; train_global_loss: 20738086.2727; train_optim_loss: 20738086.2727; val_kl_reg_loss: 55478.0923; val_edge_recon_loss: 582059.0391; val_gene_expr_recon_loss: 19212334.5000; val_masked_gp_l1_reg_loss: 78996.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80154.2734; val_chrom_access_recon_loss: 862173.0859; val_global_loss: 20871194.7500; val_optim_loss: 20871194.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9505; val_auprc_score: 0.9261; val_best_acc_score: 0.8990; val_best_f1_score: 0.9029; train_kl_reg_loss: 55081.9530; train_edge_recon_loss: 576333.1042; train_gene_expr_recon_loss: 19041111.8182; train_masked_gp_l1_reg_loss: 79712.6817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79861.5494; train_chrom_access_recon_loss: 865798.2027; train_global_loss: 20697899.3333; train_optim_loss: 20697899.3333; val_kl_reg_loss: 55452.0693; val_edge_recon_loss: 582845.1484; val_gene_expr_recon_loss: 19061179.5000; val_masked_gp_l1_reg_loss: 80622.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80417.5938; val_chrom_access_recon_loss: 863796.0781; val_global_loss: 20724313.0000; val_optim_loss: 20724313.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9514; val_auprc_score: 0.9341; val_best_acc_score: 0.8976; val_best_f1_score: 0.9022; train_kl_reg_loss: 54806.3836; train_edge_recon_loss: 576013.3532; train_gene_expr_recon_loss: 18968620.6970; train_masked_gp_l1_reg_loss: 81343.3313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79861.1184; train_chrom_access_recon_loss: 863798.9148; train_global_loss: 20624443.7879; train_optim_loss: 20624443.7879; val_kl_reg_loss: 55659.6826; val_edge_recon_loss: 580850.6250; val_gene_expr_recon_loss: 19139856.7500; val_masked_gp_l1_reg_loss: 82193.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79944.2500; val_chrom_access_recon_loss: 859972.9922; val_global_loss: 20798478.5000; val_optim_loss: 20798478.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9557; val_auprc_score: 0.9357; val_best_acc_score: 0.9078; val_best_f1_score: 0.9120; train_kl_reg_loss: 54520.2069; train_edge_recon_loss: 577954.3362; train_gene_expr_recon_loss: 18923111.6667; train_masked_gp_l1_reg_loss: 82887.1316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79625.2973; train_chrom_access_recon_loss: 862217.8333; train_global_loss: 20580316.4242; train_optim_loss: 20580316.4242; val_kl_reg_loss: 54886.3398; val_edge_recon_loss: 579409.8750; val_gene_expr_recon_loss: 19032646.2500; val_masked_gp_l1_reg_loss: 83679.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79772.3203; val_chrom_access_recon_loss: 855326.5703; val_global_loss: 20685721.0000; val_optim_loss: 20685721.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9547; val_auprc_score: 0.9392; val_best_acc_score: 0.9009; val_best_f1_score: 0.9051; train_kl_reg_loss: 54741.3354; train_edge_recon_loss: 574595.2131; train_gene_expr_recon_loss: 18843965.6364; train_masked_gp_l1_reg_loss: 84391.8008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79158.4769; train_chrom_access_recon_loss: 860731.8125; train_global_loss: 20497584.3333; train_optim_loss: 20497584.3333; val_kl_reg_loss: 55455.3628; val_edge_recon_loss: 582544.6016; val_gene_expr_recon_loss: 19147411.7500; val_masked_gp_l1_reg_loss: 85055.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79702.6875; val_chrom_access_recon_loss: 866833.0703; val_global_loss: 20817002.5000; val_optim_loss: 20817002.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9512; val_auprc_score: 0.9328; val_best_acc_score: 0.8974; val_best_f1_score: 0.9013; train_kl_reg_loss: 54830.8825; train_edge_recon_loss: 574719.5066; train_gene_expr_recon_loss: 18797577.2424; train_masked_gp_l1_reg_loss: 85849.6832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79311.9221; train_chrom_access_recon_loss: 859296.1250; train_global_loss: 20451585.3939; train_optim_loss: 20451585.3939; val_kl_reg_loss: 55484.8896; val_edge_recon_loss: 583511.1719; val_gene_expr_recon_loss: 19188139.5000; val_masked_gp_l1_reg_loss: 86577.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79090.5547; val_chrom_access_recon_loss: 870795.2188; val_global_loss: 20863599.2500; val_optim_loss: 20863599.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9490; val_auprc_score: 0.9283; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 54780.9010; train_edge_recon_loss: 575522.3845; train_gene_expr_recon_loss: 18749137.0303; train_masked_gp_l1_reg_loss: 87223.2920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78918.2280; train_chrom_access_recon_loss: 858631.0133; train_global_loss: 20404212.9091; train_optim_loss: 20404212.9091; val_kl_reg_loss: 54585.6431; val_edge_recon_loss: 586353.2422; val_gene_expr_recon_loss: 18974107.5000; val_masked_gp_l1_reg_loss: 87886.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79054.4844; val_chrom_access_recon_loss: 862558.7969; val_global_loss: 20644545.2500; val_optim_loss: 20644545.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9471; val_auprc_score: 0.9236; val_best_acc_score: 0.8979; val_best_f1_score: 0.9027; train_kl_reg_loss: 54734.2044; train_edge_recon_loss: 576958.1364; train_gene_expr_recon_loss: 18717675.8788; train_masked_gp_l1_reg_loss: 88457.3018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78953.2475; train_chrom_access_recon_loss: 857698.4195; train_global_loss: 20374477.0303; train_optim_loss: 20374477.0303; val_kl_reg_loss: 55259.0869; val_edge_recon_loss: 583119.9922; val_gene_expr_recon_loss: 18897022.5000; val_masked_gp_l1_reg_loss: 89069.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78572.0312; val_chrom_access_recon_loss: 860900.3281; val_global_loss: 20563943.7500; val_optim_loss: 20563943.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9454; val_auprc_score: 0.9216; val_best_acc_score: 0.8915; val_best_f1_score: 0.8981; train_kl_reg_loss: 54871.2338; train_edge_recon_loss: 576725.5142; train_gene_expr_recon_loss: 18643636.4545; train_masked_gp_l1_reg_loss: 89625.6875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78715.3162; train_chrom_access_recon_loss: 856446.8163; train_global_loss: 20300021.1212; train_optim_loss: 20300021.1212; val_kl_reg_loss: 55441.0293; val_edge_recon_loss: 585920.0234; val_gene_expr_recon_loss: 18754428.7500; val_masked_gp_l1_reg_loss: 90172.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79182.6797; val_chrom_access_recon_loss: 858843.3516; val_global_loss: 20423987.5000; val_optim_loss: 20423987.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9451; val_auprc_score: 0.9220; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 54601.2210; train_edge_recon_loss: 576587.1259; train_gene_expr_recon_loss: 18594669.9091; train_masked_gp_l1_reg_loss: 90848.0681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78857.0619; train_chrom_access_recon_loss: 854768.7623; train_global_loss: 20250332.2121; train_optim_loss: 20250332.2121; val_kl_reg_loss: 55496.5098; val_edge_recon_loss: 583592.9453; val_gene_expr_recon_loss: 18763014.2500; val_masked_gp_l1_reg_loss: 91404.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78664.7891; val_chrom_access_recon_loss: 857838.4766; val_global_loss: 20430010.2500; val_optim_loss: 20430010.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9502; val_auprc_score: 0.9277; val_best_acc_score: 0.9027; val_best_f1_score: 0.9076; train_kl_reg_loss: 54837.5816; train_edge_recon_loss: 576366.1903; train_gene_expr_recon_loss: 18556962.7273; train_masked_gp_l1_reg_loss: 91931.8827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78855.6548; train_chrom_access_recon_loss: 854817.3409; train_global_loss: 20213771.3030; train_optim_loss: 20213771.3030; val_kl_reg_loss: 56105.0596; val_edge_recon_loss: 584822.8359; val_gene_expr_recon_loss: 18778737.5000; val_masked_gp_l1_reg_loss: 92547.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78847.0625; val_chrom_access_recon_loss: 856817.0156; val_global_loss: 20447878.2500; val_optim_loss: 20447878.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9565; val_auprc_score: 0.9412; val_best_acc_score: 0.9081; val_best_f1_score: 0.9121; train_kl_reg_loss: 55449.6683; train_edge_recon_loss: 574933.3362; train_gene_expr_recon_loss: 18515185.8485; train_masked_gp_l1_reg_loss: 93090.0359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79085.2522; train_chrom_access_recon_loss: 853295.5616; train_global_loss: 20171039.7576; train_optim_loss: 20171039.7576; val_kl_reg_loss: 55777.6421; val_edge_recon_loss: 578600.2891; val_gene_expr_recon_loss: 18829228.7500; val_masked_gp_l1_reg_loss: 93606.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79063.7344; val_chrom_access_recon_loss: 859314.3672; val_global_loss: 20495591.0000; val_optim_loss: 20495591.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9526; val_auprc_score: 0.9360; val_best_acc_score: 0.9052; val_best_f1_score: 0.9103; train_kl_reg_loss: 55348.1552; train_edge_recon_loss: 575262.7169; train_gene_expr_recon_loss: 18499300.1515; train_masked_gp_l1_reg_loss: 94099.3662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78999.8635; train_chrom_access_recon_loss: 854071.3494; train_global_loss: 20157081.7879; train_optim_loss: 20157081.7879; val_kl_reg_loss: 56871.5732; val_edge_recon_loss: 579751.2891; val_gene_expr_recon_loss: 18890858.5000; val_masked_gp_l1_reg_loss: 94653.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79085.1172; val_chrom_access_recon_loss: 858990.8750; val_global_loss: 20560212.0000; val_optim_loss: 20560212.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9508; val_auprc_score: 0.9289; val_best_acc_score: 0.9057; val_best_f1_score: 0.9102; train_kl_reg_loss: 55866.3251; train_edge_recon_loss: 573574.5824; train_gene_expr_recon_loss: 18423371.6061; train_masked_gp_l1_reg_loss: 94026.7277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62092.6226; train_chrom_access_recon_loss: 850623.0739; train_global_loss: 20059554.9091; train_optim_loss: 20059554.9091; val_kl_reg_loss: 56393.5957; val_edge_recon_loss: 583781.7578; val_gene_expr_recon_loss: 18721748.7500; val_masked_gp_l1_reg_loss: 93727.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56797.5586; val_chrom_access_recon_loss: 857773.7969; val_global_loss: 20370224.2500; val_optim_loss: 20370224.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9465; val_auprc_score: 0.9253; val_best_acc_score: 0.8979; val_best_f1_score: 0.9027; train_kl_reg_loss: 55617.1845; train_edge_recon_loss: 574176.3134; train_gene_expr_recon_loss: 18403812.2727; train_masked_gp_l1_reg_loss: 93744.0484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56059.8016; train_chrom_access_recon_loss: 849614.9848; train_global_loss: 20033024.5455; train_optim_loss: 20033024.5455; val_kl_reg_loss: 56421.5371; val_edge_recon_loss: 582307.6328; val_gene_expr_recon_loss: 18739873.7500; val_masked_gp_l1_reg_loss: 93770.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55560.3359; val_chrom_access_recon_loss: 854749.8984; val_global_loss: 20382683.2500; val_optim_loss: 20382683.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9479; val_auprc_score: 0.9259; val_best_acc_score: 0.8990; val_best_f1_score: 0.9025; train_kl_reg_loss: 55491.3250; train_edge_recon_loss: 573797.2746; train_gene_expr_recon_loss: 18390534.4848; train_masked_gp_l1_reg_loss: 93817.9033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55233.9596; train_chrom_access_recon_loss: 849798.5133; train_global_loss: 20018673.4545; train_optim_loss: 20018673.4545; val_kl_reg_loss: 56183.3740; val_edge_recon_loss: 582096.0234; val_gene_expr_recon_loss: 18848306.7500; val_masked_gp_l1_reg_loss: 93898.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54930.3281; val_chrom_access_recon_loss: 857415.2266; val_global_loss: 20492829.5000; val_optim_loss: 20492829.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9514; val_auprc_score: 0.9315; val_best_acc_score: 0.9009; val_best_f1_score: 0.9065; train_kl_reg_loss: 55601.5501; train_edge_recon_loss: 573932.4432; train_gene_expr_recon_loss: 18392809.3939; train_masked_gp_l1_reg_loss: 93957.9848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54745.2479; train_chrom_access_recon_loss: 849538.6098; train_global_loss: 20020585.1212; train_optim_loss: 20020585.1212; val_kl_reg_loss: 56067.7104; val_edge_recon_loss: 579889.6562; val_gene_expr_recon_loss: 18585318.2500; val_masked_gp_l1_reg_loss: 94035.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54568.0234; val_chrom_access_recon_loss: 853361.9219; val_global_loss: 20223241.2500; val_optim_loss: 20223241.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9468; val_auprc_score: 0.9261; val_best_acc_score: 0.8968; val_best_f1_score: 0.9021; train_kl_reg_loss: 55571.0043; train_edge_recon_loss: 572656.5644; train_gene_expr_recon_loss: 18382886.0606; train_masked_gp_l1_reg_loss: 94113.7215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54438.3932; train_chrom_access_recon_loss: 849188.4811; train_global_loss: 20008854.4242; train_optim_loss: 20008854.4242; val_kl_reg_loss: 56324.9048; val_edge_recon_loss: 584939.6328; val_gene_expr_recon_loss: 18725357.2500; val_masked_gp_l1_reg_loss: 94190.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54268.9180; val_chrom_access_recon_loss: 852056.8359; val_global_loss: 20367136.7500; val_optim_loss: 20367136.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9493; val_auprc_score: 0.9322; val_best_acc_score: 0.9001; val_best_f1_score: 0.9051; train_kl_reg_loss: 55745.9305; train_edge_recon_loss: 572287.2083; train_gene_expr_recon_loss: 18400707.9394; train_masked_gp_l1_reg_loss: 94263.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54128.5136; train_chrom_access_recon_loss: 849761.4290; train_global_loss: 20026895.2121; train_optim_loss: 20026895.2121; val_kl_reg_loss: 56551.0854; val_edge_recon_loss: 579650.4531; val_gene_expr_recon_loss: 18961192.0000; val_masked_gp_l1_reg_loss: 94339.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54045.4727; val_chrom_access_recon_loss: 862604.6328; val_global_loss: 20608384.2500; val_optim_loss: 20608384.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9446; val_auprc_score: 0.9247; val_best_acc_score: 0.8990; val_best_f1_score: 0.9032; train_kl_reg_loss: 55612.7169; train_edge_recon_loss: 575406.7945; train_gene_expr_recon_loss: 18391722.6667; train_masked_gp_l1_reg_loss: 94417.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53925.1728; train_chrom_access_recon_loss: 850674.1761; train_global_loss: 20021758.6667; train_optim_loss: 20021758.6667; val_kl_reg_loss: 56172.0469; val_edge_recon_loss: 586707.4062; val_gene_expr_recon_loss: 18637140.5000; val_masked_gp_l1_reg_loss: 94490.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53821.7852; val_chrom_access_recon_loss: 852922.7812; val_global_loss: 20281254.5000; val_optim_loss: 20281254.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9548; val_auprc_score: 0.9359; val_best_acc_score: 0.9135; val_best_f1_score: 0.9168; train_kl_reg_loss: 55678.3433; train_edge_recon_loss: 573983.2841; train_gene_expr_recon_loss: 18369791.7576; train_masked_gp_l1_reg_loss: 94572.0234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53732.3023; train_chrom_access_recon_loss: 848998.0578; train_global_loss: 19996755.7879; train_optim_loss: 19996755.7879; val_kl_reg_loss: 56621.9927; val_edge_recon_loss: 577721.6250; val_gene_expr_recon_loss: 18676373.2500; val_masked_gp_l1_reg_loss: 94650.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53614.9609; val_chrom_access_recon_loss: 855884.6797; val_global_loss: 20314865.5000; val_optim_loss: 20314865.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9489; val_auprc_score: 0.9264; val_best_acc_score: 0.8992; val_best_f1_score: 0.9044; train_kl_reg_loss: 55665.8056; train_edge_recon_loss: 573673.8352; train_gene_expr_recon_loss: 18373426.3333; train_masked_gp_l1_reg_loss: 94584.4228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51973.5289; train_chrom_access_recon_loss: 849787.1061; train_global_loss: 19999111.0909; train_optim_loss: 19999111.0909; val_kl_reg_loss: 56266.1045; val_edge_recon_loss: 582989.4375; val_gene_expr_recon_loss: 18753866.0000; val_masked_gp_l1_reg_loss: 94552.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51479.4258; val_chrom_access_recon_loss: 866902.9844; val_global_loss: 20406056.2500; val_optim_loss: 20406056.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9533; val_auprc_score: 0.9381; val_best_acc_score: 0.9035; val_best_f1_score: 0.9087; train_kl_reg_loss: 55624.6171; train_edge_recon_loss: 573610.6032; train_gene_expr_recon_loss: 18348685.0606; train_masked_gp_l1_reg_loss: 94547.2443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51384.4389; train_chrom_access_recon_loss: 847828.9271; train_global_loss: 19971681.2727; train_optim_loss: 19971681.2727; val_kl_reg_loss: 56330.4624; val_edge_recon_loss: 580181.5859; val_gene_expr_recon_loss: 18785378.2500; val_masked_gp_l1_reg_loss: 94547.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51318.4609; val_chrom_access_recon_loss: 863659.5625; val_global_loss: 20431415.7500; val_optim_loss: 20431415.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9475; val_auprc_score: 0.9270; val_best_acc_score: 0.8990; val_best_f1_score: 0.9042; train_kl_reg_loss: 55579.2573; train_edge_recon_loss: 573735.1922; train_gene_expr_recon_loss: 18356480.2424; train_masked_gp_l1_reg_loss: 94551.5923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51274.3735; train_chrom_access_recon_loss: 848664.6402; train_global_loss: 19980285.3636; train_optim_loss: 19980285.3636; val_kl_reg_loss: 56254.9736; val_edge_recon_loss: 583993.6953; val_gene_expr_recon_loss: 18806459.7500; val_masked_gp_l1_reg_loss: 94556.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51225.5117; val_chrom_access_recon_loss: 863784.3438; val_global_loss: 20456274.7500; val_optim_loss: 20456274.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9497; val_auprc_score: 0.9286; val_best_acc_score: 0.8992; val_best_f1_score: 0.9047; train_kl_reg_loss: 55554.4971; train_edge_recon_loss: 573641.8220; train_gene_expr_recon_loss: 18361264.6061; train_masked_gp_l1_reg_loss: 94564.2192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51195.8391; train_chrom_access_recon_loss: 848606.3883; train_global_loss: 19984827.2121; train_optim_loss: 19984827.2121; val_kl_reg_loss: 56270.4678; val_edge_recon_loss: 582420.0625; val_gene_expr_recon_loss: 18734150.5000; val_masked_gp_l1_reg_loss: 94571.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51163.3594; val_chrom_access_recon_loss: 855387.9375; val_global_loss: 20373965.5000; val_optim_loss: 20373965.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 42 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9459
val AUPRC score: 0.9220
val best accuracy score: 0.8920
val best F1 score: 0.8969
val target rna MSE score: 1.3130
val source rna MSE score: 0.5582
val target atac MSE score: 0.4894
val source atac MSE score: 0.1972
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
