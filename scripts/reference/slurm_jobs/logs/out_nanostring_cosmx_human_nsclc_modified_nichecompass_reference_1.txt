Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9706; val_auprc_score: 0.9825; val_best_acc_score: 0.9314; val_best_f1_score: 0.9505; train_kl_reg_loss: 26041.7465; train_edge_recon_loss: 1762756.5999; train_cat_covariates_contrastive_loss: 642124.6539; train_gene_expr_recon_loss: 1812224.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15308.4154; train_global_loss: 4258456.1807; train_optim_loss: 4258456.1807; val_kl_reg_loss: 22596.3939; val_edge_recon_loss: 1791416.8144; val_cat_covariates_contrastive_loss: 649323.0019; val_gene_expr_recon_loss: 1848078.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15299.7764; val_global_loss: 4326714.9432; val_optim_loss: 4326714.9432
[True, False]
Run timestamp: 02092023_143939_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '5000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 126882
Number of validation nodes: 14098
Number of training edges: 300588
Number of validation edges: 33398
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8885; val_auprc_score: 0.9422; val_best_acc_score: 0.8306; val_best_f1_score: 0.8831; train_kl_reg_loss: 22823.0577; train_edge_recon_loss: 2049540.5914; train_cat_covariates_contrastive_loss: 3173831.4277; train_gene_expr_recon_loss: 2966607.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8212803.0536; train_optim_loss: 8212803.0536; val_kl_reg_loss: 18810.1765; val_edge_recon_loss: 1905315.9773; val_cat_covariates_contrastive_loss: 3162180.8939; val_gene_expr_recon_loss: 2774503.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7860810.0152; val_optim_loss: 7860810.0152
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9673; val_auprc_score: 0.9807; val_best_acc_score: 0.9315; val_best_f1_score: 0.9509; train_kl_reg_loss: 25533.8783; train_edge_recon_loss: 1760810.6220; train_cat_covariates_contrastive_loss: 642070.6013; train_gene_expr_recon_loss: 1812228.5976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15359.5448; train_global_loss: 4256003.2300; train_optim_loss: 4256003.2300; val_kl_reg_loss: 23796.7676; val_edge_recon_loss: 1798689.1799; val_cat_covariates_contrastive_loss: 643074.4479; val_gene_expr_recon_loss: 1853287.1553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15485.6025; val_global_loss: 4334333.0341; val_optim_loss: 4334333.0341
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9067; val_auprc_score: 0.9486; val_best_acc_score: 0.8591; val_best_f1_score: 0.9023; train_kl_reg_loss: 17580.1618; train_edge_recon_loss: 1835223.8401; train_cat_covariates_contrastive_loss: 3150915.8661; train_gene_expr_recon_loss: 2719493.2304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7723213.1088; train_optim_loss: 7723213.1088; val_kl_reg_loss: 17176.8978; val_edge_recon_loss: 1867743.7765; val_cat_covariates_contrastive_loss: 3151574.5076; val_gene_expr_recon_loss: 2662779.0644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7699274.2652; val_optim_loss: 7699274.2652
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9656; val_auprc_score: 0.9797; val_best_acc_score: 0.9274; val_best_f1_score: 0.9477; train_kl_reg_loss: 25519.8473; train_edge_recon_loss: 1756195.2617; train_cat_covariates_contrastive_loss: 641978.1074; train_gene_expr_recon_loss: 1808901.7351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15355.8175; train_global_loss: 4247950.7657; train_optim_loss: 4247950.7657; val_kl_reg_loss: 25286.4971; val_edge_recon_loss: 1805457.7784; val_cat_covariates_contrastive_loss: 641419.2775; val_gene_expr_recon_loss: 1843098.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15456.3467; val_global_loss: 4330718.2348; val_optim_loss: 4330718.2348
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9190; val_auprc_score: 0.9547; val_best_acc_score: 0.8698; val_best_f1_score: 0.9087; train_kl_reg_loss: 17295.7993; train_edge_recon_loss: 1806554.2844; train_cat_covariates_contrastive_loss: 3150704.0697; train_gene_expr_recon_loss: 2625637.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7600191.8920; train_optim_loss: 7600191.8920; val_kl_reg_loss: 17810.8012; val_edge_recon_loss: 1864302.0133; val_cat_covariates_contrastive_loss: 3148319.8902; val_gene_expr_recon_loss: 2570366.6553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7600799.3788; val_optim_loss: 7600799.3788
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9256; val_auprc_score: 0.9574; val_best_acc_score: 0.8788; val_best_f1_score: 0.9144; train_kl_reg_loss: 19162.0307; train_edge_recon_loss: 1797386.9379; train_cat_covariates_contrastive_loss: 3150982.1573; train_gene_expr_recon_loss: 2534748.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7502280.0459; train_optim_loss: 7502280.0459; val_kl_reg_loss: 20283.5600; val_edge_recon_loss: 1850117.0284; val_cat_covariates_contrastive_loss: 3149166.7235; val_gene_expr_recon_loss: 2478711.8826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7498279.2424; val_optim_loss: 7498279.2424
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9650; val_auprc_score: 0.9783; val_best_acc_score: 0.9283; val_best_f1_score: 0.9486; train_kl_reg_loss: 25570.4845; train_edge_recon_loss: 1763383.4781; train_cat_covariates_contrastive_loss: 642278.2397; train_gene_expr_recon_loss: 1808300.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15366.8528; train_global_loss: 4254899.5391; train_optim_loss: 4254899.5391; val_kl_reg_loss: 25212.7504; val_edge_recon_loss: 1795522.4773; val_cat_covariates_contrastive_loss: 641537.6553; val_gene_expr_recon_loss: 1844477.6686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15168.5654; val_global_loss: 4321919.0909; val_optim_loss: 4321919.0909
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9341; val_auprc_score: 0.9635; val_best_acc_score: 0.8860; val_best_f1_score: 0.9198; train_kl_reg_loss: 22044.8750; train_edge_recon_loss: 1795650.6346; train_cat_covariates_contrastive_loss: 3153651.1497; train_gene_expr_recon_loss: 2422198.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7393544.7415; train_optim_loss: 7393544.7415; val_kl_reg_loss: 21712.4756; val_edge_recon_loss: 1827534.2045; val_cat_covariates_contrastive_loss: 3162853.1250; val_gene_expr_recon_loss: 2349722.8598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7361822.6818; val_optim_loss: 7361822.6818
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9671; val_auprc_score: 0.9804; val_best_acc_score: 0.9313; val_best_f1_score: 0.9505; train_kl_reg_loss: 25632.7607; train_edge_recon_loss: 1760297.1265; train_cat_covariates_contrastive_loss: 641801.9893; train_gene_expr_recon_loss: 1800239.7451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15345.8736; train_global_loss: 4243317.5094; train_optim_loss: 4243317.5094; val_kl_reg_loss: 25219.5635; val_edge_recon_loss: 1787606.1402; val_cat_covariates_contrastive_loss: 641013.3438; val_gene_expr_recon_loss: 1834799.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15231.6309; val_global_loss: 4303869.9242; val_optim_loss: 4303869.9242
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9332; val_auprc_score: 0.9623; val_best_acc_score: 0.8864; val_best_f1_score: 0.9200; train_kl_reg_loss: 24935.4623; train_edge_recon_loss: 1791279.6754; train_cat_covariates_contrastive_loss: 3156099.1709; train_gene_expr_recon_loss: 2300474.5421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7272788.8401; train_optim_loss: 7272788.8401; val_kl_reg_loss: 27050.2282; val_edge_recon_loss: 1836666.0322; val_cat_covariates_contrastive_loss: 3154632.4811; val_gene_expr_recon_loss: 2238414.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7256763.3258; val_optim_loss: 7256763.3258
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9649; val_auprc_score: 0.9783; val_best_acc_score: 0.9294; val_best_f1_score: 0.9493; train_kl_reg_loss: 25568.0709; train_edge_recon_loss: 1757556.6820; train_cat_covariates_contrastive_loss: 641553.3070; train_gene_expr_recon_loss: 1791978.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15335.5586; train_global_loss: 4231992.4800; train_optim_loss: 4231992.4800; val_kl_reg_loss: 24780.9366; val_edge_recon_loss: 1803046.7746; val_cat_covariates_contrastive_loss: 640885.7292; val_gene_expr_recon_loss: 1826848.2178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15301.7920; val_global_loss: 4310863.6364; val_optim_loss: 4310863.6364
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9239; val_auprc_score: 0.9567; val_best_acc_score: 0.8809; val_best_f1_score: 0.9158; train_kl_reg_loss: 26768.4830; train_edge_recon_loss: 1789294.3727; train_cat_covariates_contrastive_loss: 3157623.7491; train_gene_expr_recon_loss: 2203187.8180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7176874.4218; train_optim_loss: 7176874.4218; val_kl_reg_loss: 28261.7645; val_edge_recon_loss: 1845844.5284; val_cat_covariates_contrastive_loss: 3153136.8485; val_gene_expr_recon_loss: 2167466.9072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7194710.0455; val_optim_loss: 7194710.0455
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9306; val_auprc_score: 0.9592; val_best_acc_score: 0.8888; val_best_f1_score: 0.9214; train_kl_reg_loss: 28638.4697; train_edge_recon_loss: 1790627.3114; train_cat_covariates_contrastive_loss: 3157166.7126; train_gene_expr_recon_loss: 2137207.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7113640.3393; train_optim_loss: 7113640.3393; val_kl_reg_loss: 30678.6586; val_edge_recon_loss: 1838375.2765; val_cat_covariates_contrastive_loss: 3151648.5909; val_gene_expr_recon_loss: 2104465.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7125167.9167; val_optim_loss: 7125167.9167
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9694; val_auprc_score: 0.9816; val_best_acc_score: 0.9331; val_best_f1_score: 0.9521; train_kl_reg_loss: 25592.5684; train_edge_recon_loss: 1759445.5935; train_cat_covariates_contrastive_loss: 641476.3625; train_gene_expr_recon_loss: 1788248.8267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15328.6847; train_global_loss: 4230092.0310; train_optim_loss: 4230092.0310; val_kl_reg_loss: 23705.0236; val_edge_recon_loss: 1791906.2064; val_cat_covariates_contrastive_loss: 643692.5208; val_gene_expr_recon_loss: 1822613.3655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15048.1650; val_global_loss: 4296965.1439; val_optim_loss: 4296965.1439
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9367; val_auprc_score: 0.9643; val_best_acc_score: 0.8903; val_best_f1_score: 0.9227; train_kl_reg_loss: 29196.9198; train_edge_recon_loss: 1783903.5512; train_cat_covariates_contrastive_loss: 3157077.4175; train_gene_expr_recon_loss: 2077820.8992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7047998.7934; train_optim_loss: 7047998.7934; val_kl_reg_loss: 28650.6328; val_edge_recon_loss: 1823250.0511; val_cat_covariates_contrastive_loss: 3160532.9659; val_gene_expr_recon_loss: 2057680.2633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7070113.9470; val_optim_loss: 7070113.9470
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9663; val_auprc_score: 0.9790; val_best_acc_score: 0.9318; val_best_f1_score: 0.9511; train_kl_reg_loss: 25742.5561; train_edge_recon_loss: 1757650.9679; train_cat_covariates_contrastive_loss: 642027.6466; train_gene_expr_recon_loss: 1786282.6845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15307.7039; train_global_loss: 4227011.5587; train_optim_loss: 4227011.5587; val_kl_reg_loss: 25558.2111; val_edge_recon_loss: 1785602.3958; val_cat_covariates_contrastive_loss: 639484.8911; val_gene_expr_recon_loss: 1824600.5511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15396.6270; val_global_loss: 4290642.5682; val_optim_loss: 4290642.5682
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9418; val_auprc_score: 0.9660; val_best_acc_score: 0.8961; val_best_f1_score: 0.9260; train_kl_reg_loss: 29497.9435; train_edge_recon_loss: 1782631.4216; train_cat_covariates_contrastive_loss: 3156258.1233; train_gene_expr_recon_loss: 2036496.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7004884.1454; train_optim_loss: 7004884.1454; val_kl_reg_loss: 30055.7310; val_edge_recon_loss: 1837574.5360; val_cat_covariates_contrastive_loss: 3158000.1818; val_gene_expr_recon_loss: 2017009.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7042639.7803; val_optim_loss: 7042639.7803
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9684; val_auprc_score: 0.9809; val_best_acc_score: 0.9318; val_best_f1_score: 0.9507; train_kl_reg_loss: 25870.8378; train_edge_recon_loss: 1757034.2589; train_cat_covariates_contrastive_loss: 642684.1969; train_gene_expr_recon_loss: 1781294.3682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15300.7077; train_global_loss: 4222184.3716; train_optim_loss: 4222184.3716; val_kl_reg_loss: 25565.4452; val_edge_recon_loss: 1808527.4148; val_cat_covariates_contrastive_loss: 640669.7746; val_gene_expr_recon_loss: 1818097.3220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15252.2158; val_global_loss: 4308112.0000; val_optim_loss: 4308112.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9397; val_auprc_score: 0.9645; val_best_acc_score: 0.9003; val_best_f1_score: 0.9293; train_kl_reg_loss: 29937.6884; train_edge_recon_loss: 1779929.4177; train_cat_covariates_contrastive_loss: 3156675.3104; train_gene_expr_recon_loss: 1999990.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6966533.2474; train_optim_loss: 6966533.2474; val_kl_reg_loss: 30574.9705; val_edge_recon_loss: 1819898.4621; val_cat_covariates_contrastive_loss: 3153697.3409; val_gene_expr_recon_loss: 1994037.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6998208.5833; val_optim_loss: 6998208.5833
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9386; val_auprc_score: 0.9644; val_best_acc_score: 0.8970; val_best_f1_score: 0.9272; train_kl_reg_loss: 30079.2929; train_edge_recon_loss: 1774097.6843; train_cat_covariates_contrastive_loss: 3157511.1288; train_gene_expr_recon_loss: 1975632.8695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6937320.9753; train_optim_loss: 6937320.9753; val_kl_reg_loss: 30055.1055; val_edge_recon_loss: 1820846.7424; val_cat_covariates_contrastive_loss: 3159782.2841; val_gene_expr_recon_loss: 1973757.7045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6984441.8485; val_optim_loss: 6984441.8485
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9683; val_auprc_score: 0.9810; val_best_acc_score: 0.9312; val_best_f1_score: 0.9506; train_kl_reg_loss: 25926.9706; train_edge_recon_loss: 1756909.8099; train_cat_covariates_contrastive_loss: 642012.6962; train_gene_expr_recon_loss: 1790562.6057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15336.5890; train_global_loss: 4230748.6747; train_optim_loss: 4230748.6747; val_kl_reg_loss: 25923.2041; val_edge_recon_loss: 1802469.8920; val_cat_covariates_contrastive_loss: 641449.6042; val_gene_expr_recon_loss: 1816744.0473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15156.4678; val_global_loss: 4301743.2273; val_optim_loss: 4301743.2273
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9420; val_auprc_score: 0.9654; val_best_acc_score: 0.9011; val_best_f1_score: 0.9298; train_kl_reg_loss: 30503.6929; train_edge_recon_loss: 1777928.8639; train_cat_covariates_contrastive_loss: 3155921.4834; train_gene_expr_recon_loss: 1953870.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6918224.2500; train_optim_loss: 6918224.2500; val_kl_reg_loss: 29778.0106; val_edge_recon_loss: 1812188.9223; val_cat_covariates_contrastive_loss: 3155344.2083; val_gene_expr_recon_loss: 1949199.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6946510.6970; val_optim_loss: 6946510.6970
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9679; val_auprc_score: 0.9799; val_best_acc_score: 0.9343; val_best_f1_score: 0.9530; train_kl_reg_loss: 25968.6218; train_edge_recon_loss: 1758159.0123; train_cat_covariates_contrastive_loss: 641394.8281; train_gene_expr_recon_loss: 1778225.0665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15332.3963; train_global_loss: 4219079.9184; train_optim_loss: 4219079.9184; val_kl_reg_loss: 25428.7911; val_edge_recon_loss: 1793547.5076; val_cat_covariates_contrastive_loss: 642433.3788; val_gene_expr_recon_loss: 1816997.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15393.7617; val_global_loss: 4293800.8561; val_optim_loss: 4293800.8561
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9486; val_auprc_score: 0.9700; val_best_acc_score: 0.9094; val_best_f1_score: 0.9355; train_kl_reg_loss: 30208.3068; train_edge_recon_loss: 1775118.9524; train_cat_covariates_contrastive_loss: 3156545.7772; train_gene_expr_recon_loss: 1933722.5232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6895595.5502; train_optim_loss: 6895595.5502; val_kl_reg_loss: 30788.4677; val_edge_recon_loss: 1814049.8580; val_cat_covariates_contrastive_loss: 3155746.0682; val_gene_expr_recon_loss: 1938198.4072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6938782.7879; val_optim_loss: 6938782.7879
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9684; val_auprc_score: 0.9808; val_best_acc_score: 0.9326; val_best_f1_score: 0.9517; train_kl_reg_loss: 25693.3157; train_edge_recon_loss: 1758732.3403; train_cat_covariates_contrastive_loss: 641095.2237; train_gene_expr_recon_loss: 1773287.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15325.0743; train_global_loss: 4214133.6841; train_optim_loss: 4214133.6841; val_kl_reg_loss: 25904.2340; val_edge_recon_loss: 1794980.8314; val_cat_covariates_contrastive_loss: 643272.6212; val_gene_expr_recon_loss: 1815958.8314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15378.0811; val_global_loss: 4295494.5303; val_optim_loss: 4295494.5303
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9456; val_auprc_score: 0.9672; val_best_acc_score: 0.9079; val_best_f1_score: 0.9349; train_kl_reg_loss: 29957.3946; train_edge_recon_loss: 1775954.8418; train_cat_covariates_contrastive_loss: 3154869.8172; train_gene_expr_recon_loss: 1918722.2764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6879504.3087; train_optim_loss: 6879504.3087; val_kl_reg_loss: 29721.7491; val_edge_recon_loss: 1804495.4223; val_cat_covariates_contrastive_loss: 3157429.4242; val_gene_expr_recon_loss: 1925368.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6917014.9697; val_optim_loss: 6917014.9697
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9447; val_auprc_score: 0.9664; val_best_acc_score: 0.9081; val_best_f1_score: 0.9347; train_kl_reg_loss: 29932.9486; train_edge_recon_loss: 1772527.5852; train_cat_covariates_contrastive_loss: 3154546.5340; train_gene_expr_recon_loss: 1906501.3795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6863508.4515; train_optim_loss: 6863508.4515; val_kl_reg_loss: 29990.4570; val_edge_recon_loss: 1809653.6648; val_cat_covariates_contrastive_loss: 3155203.4735; val_gene_expr_recon_loss: 1915120.2841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6909967.8864; val_optim_loss: 6909967.8864

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9711; val_auprc_score: 0.9828; val_best_acc_score: 0.9345; val_best_f1_score: 0.9529; train_kl_reg_loss: 26181.7971; train_edge_recon_loss: 1753373.2755; train_cat_covariates_contrastive_loss: 640763.9618; train_gene_expr_recon_loss: 1745999.4770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8630.2495; train_global_loss: 4174948.7717; train_optim_loss: 4174948.7717; val_kl_reg_loss: 25476.9086; val_edge_recon_loss: 1771497.0000; val_cat_covariates_contrastive_loss: 641696.9991; val_gene_expr_recon_loss: 1802050.1686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8457.5156; val_global_loss: 4249178.5947; val_optim_loss: 4249178.5947
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9439; val_auprc_score: 0.9666; val_best_acc_score: 0.9065; val_best_f1_score: 0.9336; train_kl_reg_loss: 29795.2854; train_edge_recon_loss: 1772185.4056; train_cat_covariates_contrastive_loss: 3155204.6480; train_gene_expr_recon_loss: 1893977.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6851163.1879; train_optim_loss: 6851163.1879; val_kl_reg_loss: 29252.6767; val_edge_recon_loss: 1816248.7633; val_cat_covariates_contrastive_loss: 3155494.2121; val_gene_expr_recon_loss: 1910723.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6911719.0682; val_optim_loss: 6911719.0682
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9682; val_auprc_score: 0.9802; val_best_acc_score: 0.9326; val_best_f1_score: 0.9515; train_kl_reg_loss: 26090.2890; train_edge_recon_loss: 1752110.9736; train_cat_covariates_contrastive_loss: 640963.3149; train_gene_expr_recon_loss: 1742642.7436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8436.0460; train_global_loss: 4170243.3656; train_optim_loss: 4170243.3656; val_kl_reg_loss: 25837.3751; val_edge_recon_loss: 1799081.9905; val_cat_covariates_contrastive_loss: 641476.0057; val_gene_expr_recon_loss: 1796045.2538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8431.2959; val_global_loss: 4270872.1098; val_optim_loss: 4270872.1098
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9420; val_auprc_score: 0.9645; val_best_acc_score: 0.9079; val_best_f1_score: 0.9343; train_kl_reg_loss: 29872.4506; train_edge_recon_loss: 1766123.5236; train_cat_covariates_contrastive_loss: 3154242.8048; train_gene_expr_recon_loss: 1890162.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6840400.9609; train_optim_loss: 6840400.9609; val_kl_reg_loss: 30812.2690; val_edge_recon_loss: 1819343.5644; val_cat_covariates_contrastive_loss: 3150695.7386; val_gene_expr_recon_loss: 1895691.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6896542.7273; val_optim_loss: 6896542.7273
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9708; val_auprc_score: 0.9823; val_best_acc_score: 0.9343; val_best_f1_score: 0.9528; train_kl_reg_loss: 26104.0517; train_edge_recon_loss: 1754378.5451; train_cat_covariates_contrastive_loss: 640646.2473; train_gene_expr_recon_loss: 1739905.0602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8421.2791; train_global_loss: 4169455.1828; train_optim_loss: 4169455.1828; val_kl_reg_loss: 25641.9581; val_edge_recon_loss: 1783223.6307; val_cat_covariates_contrastive_loss: 640914.0559; val_gene_expr_recon_loss: 1795908.5265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8368.5176; val_global_loss: 4254056.6742; val_optim_loss: 4254056.6742
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9418; val_auprc_score: 0.9654; val_best_acc_score: 0.9084; val_best_f1_score: 0.9346; train_kl_reg_loss: 29855.9375; train_edge_recon_loss: 1770571.6384; train_cat_covariates_contrastive_loss: 3153649.0676; train_gene_expr_recon_loss: 1876578.4396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6830655.0876; train_optim_loss: 6830655.0876; val_kl_reg_loss: 31970.0440; val_edge_recon_loss: 1803364.2311; val_cat_covariates_contrastive_loss: 3150052.0152; val_gene_expr_recon_loss: 1891797.6913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6877184.0000; val_optim_loss: 6877184.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9458; val_auprc_score: 0.9670; val_best_acc_score: 0.9121; val_best_f1_score: 0.9374; train_kl_reg_loss: 29604.2684; train_edge_recon_loss: 1766743.0935; train_cat_covariates_contrastive_loss: 3152974.3571; train_gene_expr_recon_loss: 1869723.5634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6819045.2832; train_optim_loss: 6819045.2832; val_kl_reg_loss: 31599.6246; val_edge_recon_loss: 1785781.8409; val_cat_covariates_contrastive_loss: 3149091.6591; val_gene_expr_recon_loss: 1888646.3788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6855119.5227; val_optim_loss: 6855119.5227
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9699; val_auprc_score: 0.9816; val_best_acc_score: 0.9341; val_best_f1_score: 0.9525; train_kl_reg_loss: 26070.5523; train_edge_recon_loss: 1755871.0429; train_cat_covariates_contrastive_loss: 640738.2205; train_gene_expr_recon_loss: 1739674.2202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8420.4535; train_global_loss: 4170774.4962; train_optim_loss: 4170774.4962; val_kl_reg_loss: 25705.6945; val_edge_recon_loss: 1792415.5814; val_cat_covariates_contrastive_loss: 642948.5956; val_gene_expr_recon_loss: 1795483.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8425.4219; val_global_loss: 4264979.2652; val_optim_loss: 4264979.2652
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9538; val_auprc_score: 0.9715; val_best_acc_score: 0.9172; val_best_f1_score: 0.9410; train_kl_reg_loss: 29458.8269; train_edge_recon_loss: 1768243.3880; train_cat_covariates_contrastive_loss: 3153298.8724; train_gene_expr_recon_loss: 1870451.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6821452.4796; train_optim_loss: 6821452.4796; val_kl_reg_loss: 29822.0389; val_edge_recon_loss: 1798749.2330; val_cat_covariates_contrastive_loss: 3161689.7576; val_gene_expr_recon_loss: 1884814.9659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6875075.9621; val_optim_loss: 6875075.9621
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9693; val_auprc_score: 0.9813; val_best_acc_score: 0.9345; val_best_f1_score: 0.9530; train_kl_reg_loss: 26134.1543; train_edge_recon_loss: 1757237.0935; train_cat_covariates_contrastive_loss: 640484.5578; train_gene_expr_recon_loss: 1738757.2647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8411.4892; train_global_loss: 4171024.5480; train_optim_loss: 4171024.5480; val_kl_reg_loss: 25906.6313; val_edge_recon_loss: 1775291.7955; val_cat_covariates_contrastive_loss: 639890.6004; val_gene_expr_recon_loss: 1791984.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8441.5195; val_global_loss: 4241515.3220; val_optim_loss: 4241515.3220
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9206; val_auprc_score: 0.9514; val_best_acc_score: 0.8911; val_best_f1_score: 0.9230; train_kl_reg_loss: 29414.6289; train_edge_recon_loss: 1764703.5886; train_cat_covariates_contrastive_loss: 3153529.7479; train_gene_expr_recon_loss: 1860251.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6807899.4617; train_optim_loss: 6807899.4617; val_kl_reg_loss: 39049.8991; val_edge_recon_loss: 1864451.8542; val_cat_covariates_contrastive_loss: 3142543.9962; val_gene_expr_recon_loss: 1912670.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6958716.3106; val_optim_loss: 6958716.3106
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9662; val_auprc_score: 0.9787; val_best_acc_score: 0.9335; val_best_f1_score: 0.9523; train_kl_reg_loss: 25950.9490; train_edge_recon_loss: 1754084.0108; train_cat_covariates_contrastive_loss: 640649.0352; train_gene_expr_recon_loss: 1738557.2451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8429.6282; train_global_loss: 4167670.8571; train_optim_loss: 4167670.8571; val_kl_reg_loss: 25892.1765; val_edge_recon_loss: 1788287.5189; val_cat_covariates_contrastive_loss: 641241.2936; val_gene_expr_recon_loss: 1794917.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8438.3564; val_global_loss: 4258776.8977; val_optim_loss: 4258776.8977
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9510; val_auprc_score: 0.9694; val_best_acc_score: 0.9178; val_best_f1_score: 0.9414; train_kl_reg_loss: 29717.9216; train_edge_recon_loss: 1772730.6577; train_cat_covariates_contrastive_loss: 3154445.4235; train_gene_expr_recon_loss: 1870146.7602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6827040.7721; train_optim_loss: 6827040.7721; val_kl_reg_loss: 28581.2440; val_edge_recon_loss: 1802191.6420; val_cat_covariates_contrastive_loss: 3157230.8561; val_gene_expr_recon_loss: 1877604.3049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6865608.0455; val_optim_loss: 6865608.0455
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9705; val_auprc_score: 0.9821; val_best_acc_score: 0.9334; val_best_f1_score: 0.9519; train_kl_reg_loss: 25875.2902; train_edge_recon_loss: 1752518.4549; train_cat_covariates_contrastive_loss: 640330.3585; train_gene_expr_recon_loss: 1738336.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8440.8783; train_global_loss: 4165501.3278; train_optim_loss: 4165501.3278; val_kl_reg_loss: 25792.7573; val_edge_recon_loss: 1797351.0152; val_cat_covariates_contrastive_loss: 643142.5511; val_gene_expr_recon_loss: 1793306.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8452.6602; val_global_loss: 4268045.6023; val_optim_loss: 4268045.6023
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9518; val_auprc_score: 0.9707; val_best_acc_score: 0.9172; val_best_f1_score: 0.9410; train_kl_reg_loss: 29758.6985; train_edge_recon_loss: 1763734.0357; train_cat_covariates_contrastive_loss: 3152501.4396; train_gene_expr_recon_loss: 1854744.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6800738.9413; train_optim_loss: 6800738.9413; val_kl_reg_loss: 29392.5798; val_edge_recon_loss: 1798255.6250; val_cat_covariates_contrastive_loss: 3155370.4773; val_gene_expr_recon_loss: 1875672.6894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6858691.4015; val_optim_loss: 6858691.4015

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9503; val_auprc_score: 0.9693; val_best_acc_score: 0.9187; val_best_f1_score: 0.9418; train_kl_reg_loss: 29816.1333; train_edge_recon_loss: 1758901.0021; train_cat_covariates_contrastive_loss: 3152023.0787; train_gene_expr_recon_loss: 1824101.1813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6764841.3929; train_optim_loss: 6764841.3929; val_kl_reg_loss: 30165.4362; val_edge_recon_loss: 1795063.8712; val_cat_covariates_contrastive_loss: 3151110.2652; val_gene_expr_recon_loss: 1850110.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6826450.1212; val_optim_loss: 6826450.1212
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9681; val_auprc_score: 0.9801; val_best_acc_score: 0.9338; val_best_f1_score: 0.9524; train_kl_reg_loss: 25793.6544; train_edge_recon_loss: 1751943.4677; train_cat_covariates_contrastive_loss: 640765.4643; train_gene_expr_recon_loss: 1737221.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8434.7665; train_global_loss: 4164158.9218; train_optim_loss: 4164158.9218; val_kl_reg_loss: 25507.4472; val_edge_recon_loss: 1787976.8485; val_cat_covariates_contrastive_loss: 641965.3873; val_gene_expr_recon_loss: 1792570.8826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8443.8799; val_global_loss: 4256464.5720; val_optim_loss: 4256464.5720
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9498; val_auprc_score: 0.9682; val_best_acc_score: 0.9199; val_best_f1_score: 0.9428; train_kl_reg_loss: 36277.3947; train_edge_recon_loss: 1767432.0040; train_cat_covariates_contrastive_loss: 3165978.6926; train_gene_expr_recon_loss: 1754745.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6724434.0034; train_optim_loss: 6724434.0034; val_kl_reg_loss: 19910.1821; val_edge_recon_loss: 1804852.5170; val_cat_covariates_contrastive_loss: 3160877.1894; val_gene_expr_recon_loss: 1773222.4943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6758862.3939; val_optim_loss: 6758862.3939
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9699; val_auprc_score: 0.9817; val_best_acc_score: 0.9346; val_best_f1_score: 0.9529; train_kl_reg_loss: 25801.8255; train_edge_recon_loss: 1755224.9964; train_cat_covariates_contrastive_loss: 640751.4433; train_gene_expr_recon_loss: 1736320.4252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8426.2947; train_global_loss: 4166524.9906; train_optim_loss: 4166524.9906; val_kl_reg_loss: 25185.1553; val_edge_recon_loss: 1796496.9015; val_cat_covariates_contrastive_loss: 642105.6117; val_gene_expr_recon_loss: 1798772.5379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8452.4082; val_global_loss: 4271012.7121; val_optim_loss: 4271012.7121
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9537; val_auprc_score: 0.9707; val_best_acc_score: 0.9217; val_best_f1_score: 0.9444; train_kl_reg_loss: 35130.9517; train_edge_recon_loss: 1766222.9915; train_cat_covariates_contrastive_loss: 3160411.6866; train_gene_expr_recon_loss: 1742775.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6704541.6224; train_optim_loss: 6704541.6224; val_kl_reg_loss: 20712.5582; val_edge_recon_loss: 1790094.3371; val_cat_covariates_contrastive_loss: 3159619.1629; val_gene_expr_recon_loss: 1773070.6648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6743496.7348; val_optim_loss: 6743496.7348

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9708; val_auprc_score: 0.9823; val_best_acc_score: 0.9353; val_best_f1_score: 0.9533; train_kl_reg_loss: 25683.3449; train_edge_recon_loss: 1754604.1312; train_cat_covariates_contrastive_loss: 640880.0959; train_gene_expr_recon_loss: 1731998.3344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7679.5492; train_global_loss: 4160845.4575; train_optim_loss: 4160845.4575; val_kl_reg_loss: 25412.4914; val_edge_recon_loss: 1788578.2045; val_cat_covariates_contrastive_loss: 641805.5265; val_gene_expr_recon_loss: 1794343.5777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7650.8301; val_global_loss: 4257790.7879; val_optim_loss: 4257790.7879
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9523; val_auprc_score: 0.9697; val_best_acc_score: 0.9209; val_best_f1_score: 0.9435; train_kl_reg_loss: 33714.5550; train_edge_recon_loss: 1764070.6915; train_cat_covariates_contrastive_loss: 3158297.1276; train_gene_expr_recon_loss: 1739713.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6695796.2219; train_optim_loss: 6695796.2219; val_kl_reg_loss: 21403.3522; val_edge_recon_loss: 1795757.3068; val_cat_covariates_contrastive_loss: 3159055.4811; val_gene_expr_recon_loss: 1774181.7311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6750397.8561; val_optim_loss: 6750397.8561
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9706; val_auprc_score: 0.9823; val_best_acc_score: 0.9354; val_best_f1_score: 0.9535; train_kl_reg_loss: 25845.5905; train_edge_recon_loss: 1748002.1269; train_cat_covariates_contrastive_loss: 640423.9170; train_gene_expr_recon_loss: 1732717.1898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7649.1796; train_global_loss: 4154638.0038; train_optim_loss: 4154638.0038; val_kl_reg_loss: 25605.6770; val_edge_recon_loss: 1782052.9621; val_cat_covariates_contrastive_loss: 640627.1544; val_gene_expr_recon_loss: 1793522.1326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7652.1099; val_global_loss: 4249459.9583; val_optim_loss: 4249459.9583
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9509; val_auprc_score: 0.9691; val_best_acc_score: 0.9176; val_best_f1_score: 0.9412; train_kl_reg_loss: 32113.0995; train_edge_recon_loss: 1764589.0576; train_cat_covariates_contrastive_loss: 3157154.2338; train_gene_expr_recon_loss: 1736825.7239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6690682.1139; train_optim_loss: 6690682.1139; val_kl_reg_loss: 21832.0725; val_edge_recon_loss: 1809916.4356; val_cat_covariates_contrastive_loss: 3159293.9280; val_gene_expr_recon_loss: 1763512.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6754555.2879; val_optim_loss: 6754555.2879
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9690; val_auprc_score: 0.9810; val_best_acc_score: 0.9343; val_best_f1_score: 0.9529; train_kl_reg_loss: 25867.4326; train_edge_recon_loss: 1753996.6346; train_cat_covariates_contrastive_loss: 640435.6028; train_gene_expr_recon_loss: 1732649.6650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7648.3705; train_global_loss: 4160597.6969; train_optim_loss: 4160597.6969; val_kl_reg_loss: 25555.8110; val_edge_recon_loss: 1785605.5682; val_cat_covariates_contrastive_loss: 640390.9460; val_gene_expr_recon_loss: 1794646.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7643.4453; val_global_loss: 4253842.7083; val_optim_loss: 4253842.7083
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9519; val_auprc_score: 0.9704; val_best_acc_score: 0.9190; val_best_f1_score: 0.9423; train_kl_reg_loss: 30897.7436; train_edge_recon_loss: 1762616.6901; train_cat_covariates_contrastive_loss: 3155918.7738; train_gene_expr_recon_loss: 1725612.7810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6675045.9745; train_optim_loss: 6675045.9745; val_kl_reg_loss: 23002.0157; val_edge_recon_loss: 1805898.8655; val_cat_covariates_contrastive_loss: 3154958.4394; val_gene_expr_recon_loss: 1755530.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6739390.2197; val_optim_loss: 6739390.2197
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9680; val_auprc_score: 0.9803; val_best_acc_score: 0.9332; val_best_f1_score: 0.9521; train_kl_reg_loss: 25826.5853; train_edge_recon_loss: 1754094.0634; train_cat_covariates_contrastive_loss: 641031.6013; train_gene_expr_recon_loss: 1732666.4435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7640.7724; train_global_loss: 4161259.4643; train_optim_loss: 4161259.4643; val_kl_reg_loss: 25573.2148; val_edge_recon_loss: 1782207.8352; val_cat_covariates_contrastive_loss: 640759.2481; val_gene_expr_recon_loss: 1790882.4470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7645.2773; val_global_loss: 4247068.1932; val_optim_loss: 4247068.1932
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9513; val_auprc_score: 0.9692; val_best_acc_score: 0.9210; val_best_f1_score: 0.9436; train_kl_reg_loss: 30040.8909; train_edge_recon_loss: 1766933.9783; train_cat_covariates_contrastive_loss: 3155319.5867; train_gene_expr_recon_loss: 1721461.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6673755.6216; train_optim_loss: 6673755.6216; val_kl_reg_loss: 22981.4119; val_edge_recon_loss: 1805160.7027; val_cat_covariates_contrastive_loss: 3152576.1250; val_gene_expr_recon_loss: 1754992.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6735711.0682; val_optim_loss: 6735711.0682

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 276 min 10 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9243
val AUPRC score: 0.9328
val best accuracy score: 0.9154
val best F1 score: 0.9384
val target rna MSE score: 1.1443
val source rna MSE score: 0.1111
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.1149

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9496; val_auprc_score: 0.9683; val_best_acc_score: 0.9197; val_best_f1_score: 0.9427; train_kl_reg_loss: 29504.3416; train_edge_recon_loss: 1767474.6269; train_cat_covariates_contrastive_loss: 3154721.5565; train_gene_expr_recon_loss: 1717972.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6669672.8316; train_optim_loss: 6669672.8316; val_kl_reg_loss: 23297.0774; val_edge_recon_loss: 1790863.5928; val_cat_covariates_contrastive_loss: 3156013.8788; val_gene_expr_recon_loss: 1749945.1212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6720119.6667; val_optim_loss: 6720119.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9515; val_auprc_score: 0.9694; val_best_acc_score: 0.9206; val_best_f1_score: 0.9432; train_kl_reg_loss: 28711.9980; train_edge_recon_loss: 1769852.6050; train_cat_covariates_contrastive_loss: 3153497.4294; train_gene_expr_recon_loss: 1712231.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6664293.1675; train_optim_loss: 6664293.1675; val_kl_reg_loss: 23012.9484; val_edge_recon_loss: 1796057.3049; val_cat_covariates_contrastive_loss: 3154390.9356; val_gene_expr_recon_loss: 1744249.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6717710.1818; val_optim_loss: 6717710.1818
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9490; val_auprc_score: 0.9673; val_best_acc_score: 0.9185; val_best_f1_score: 0.9420; train_kl_reg_loss: 28282.2687; train_edge_recon_loss: 1760624.4080; train_cat_covariates_contrastive_loss: 3153564.4826; train_gene_expr_recon_loss: 1704376.9909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6646848.1412; train_optim_loss: 6646848.1412; val_kl_reg_loss: 24070.4442; val_edge_recon_loss: 1800434.1742; val_cat_covariates_contrastive_loss: 3151759.5114; val_gene_expr_recon_loss: 1738914.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6715178.7273; val_optim_loss: 6715178.7273
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9536; val_auprc_score: 0.9718; val_best_acc_score: 0.9210; val_best_f1_score: 0.9438; train_kl_reg_loss: 27932.7580; train_edge_recon_loss: 1760190.5829; train_cat_covariates_contrastive_loss: 3153405.4337; train_gene_expr_recon_loss: 1702038.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6643567.1293; train_optim_loss: 6643567.1293; val_kl_reg_loss: 24184.0781; val_edge_recon_loss: 1781807.3125; val_cat_covariates_contrastive_loss: 3152622.8409; val_gene_expr_recon_loss: 1738351.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6696965.3636; val_optim_loss: 6696965.3636
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9508; val_auprc_score: 0.9687; val_best_acc_score: 0.9205; val_best_f1_score: 0.9433; train_kl_reg_loss: 27707.4378; train_edge_recon_loss: 1767181.5825; train_cat_covariates_contrastive_loss: 3153135.3967; train_gene_expr_recon_loss: 1700423.5113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6648447.9269; train_optim_loss: 6648447.9269; val_kl_reg_loss: 24560.9219; val_edge_recon_loss: 1789384.8428; val_cat_covariates_contrastive_loss: 3150635.7765; val_gene_expr_recon_loss: 1737475.6212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6702057.1667; val_optim_loss: 6702057.1667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9517; val_auprc_score: 0.9692; val_best_acc_score: 0.9227; val_best_f1_score: 0.9446; train_kl_reg_loss: 27457.5436; train_edge_recon_loss: 1761780.8097; train_cat_covariates_contrastive_loss: 3152316.0493; train_gene_expr_recon_loss: 1697709.0510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6639263.4439; train_optim_loss: 6639263.4439; val_kl_reg_loss: 24729.2059; val_edge_recon_loss: 1792893.2064; val_cat_covariates_contrastive_loss: 3150538.3864; val_gene_expr_recon_loss: 1734876.4261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6703037.1970; val_optim_loss: 6703037.1970
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9521; val_auprc_score: 0.9696; val_best_acc_score: 0.9209; val_best_f1_score: 0.9436; train_kl_reg_loss: 27117.3815; train_edge_recon_loss: 1759116.4675; train_cat_covariates_contrastive_loss: 3152462.2151; train_gene_expr_recon_loss: 1696140.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6634836.3741; train_optim_loss: 6634836.3741; val_kl_reg_loss: 25229.9786; val_edge_recon_loss: 1792709.1515; val_cat_covariates_contrastive_loss: 3149751.8561; val_gene_expr_recon_loss: 1733497.8163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6701188.8106; val_optim_loss: 6701188.8106
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9518; val_auprc_score: 0.9695; val_best_acc_score: 0.9223; val_best_f1_score: 0.9446; train_kl_reg_loss: 27038.9582; train_edge_recon_loss: 1766109.1779; train_cat_covariates_contrastive_loss: 3151975.1871; train_gene_expr_recon_loss: 1694044.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6639168.0918; train_optim_loss: 6639168.0918; val_kl_reg_loss: 24300.7117; val_edge_recon_loss: 1788341.9924; val_cat_covariates_contrastive_loss: 3156758.9053; val_gene_expr_recon_loss: 1730512.1061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6699913.7348; val_optim_loss: 6699913.7348

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9519; val_auprc_score: 0.9696; val_best_acc_score: 0.9222; val_best_f1_score: 0.9445; train_kl_reg_loss: 26937.4011; train_edge_recon_loss: 1763351.4798; train_cat_covariates_contrastive_loss: 3152315.2840; train_gene_expr_recon_loss: 1689763.2664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6632367.4209; train_optim_loss: 6632367.4209; val_kl_reg_loss: 24687.5329; val_edge_recon_loss: 1779555.8977; val_cat_covariates_contrastive_loss: 3150844.3977; val_gene_expr_recon_loss: 1727842.6970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6682930.5530; val_optim_loss: 6682930.5530
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9526; val_auprc_score: 0.9703; val_best_acc_score: 0.9222; val_best_f1_score: 0.9444; train_kl_reg_loss: 26987.9024; train_edge_recon_loss: 1759795.4783; train_cat_covariates_contrastive_loss: 3152317.3261; train_gene_expr_recon_loss: 1689982.0102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6629082.7100; train_optim_loss: 6629082.7100; val_kl_reg_loss: 24914.5546; val_edge_recon_loss: 1783913.4470; val_cat_covariates_contrastive_loss: 3151764.5985; val_gene_expr_recon_loss: 1730065.7443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6690658.3864; val_optim_loss: 6690658.3864
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9517; val_auprc_score: 0.9690; val_best_acc_score: 0.9214; val_best_f1_score: 0.9438; train_kl_reg_loss: 27005.5422; train_edge_recon_loss: 1759222.2591; train_cat_covariates_contrastive_loss: 3151778.7521; train_gene_expr_recon_loss: 1688278.7251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6626285.2823; train_optim_loss: 6626285.2823; val_kl_reg_loss: 24723.4433; val_edge_recon_loss: 1802269.3447; val_cat_covariates_contrastive_loss: 3151012.6250; val_gene_expr_recon_loss: 1726286.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6704291.5455; val_optim_loss: 6704291.5455
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9530; val_auprc_score: 0.9706; val_best_acc_score: 0.9213; val_best_f1_score: 0.9437; train_kl_reg_loss: 26882.5472; train_edge_recon_loss: 1760373.6139; train_cat_covariates_contrastive_loss: 3151561.4252; train_gene_expr_recon_loss: 1684748.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6623565.7236; train_optim_loss: 6623565.7236; val_kl_reg_loss: 24926.4152; val_edge_recon_loss: 1804561.0890; val_cat_covariates_contrastive_loss: 3153806.0644; val_gene_expr_recon_loss: 1723389.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6706682.8939; val_optim_loss: 6706682.8939
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9528; val_auprc_score: 0.9700; val_best_acc_score: 0.9214; val_best_f1_score: 0.9440; train_kl_reg_loss: 26999.4403; train_edge_recon_loss: 1762269.0217; train_cat_covariates_contrastive_loss: 3151691.2857; train_gene_expr_recon_loss: 1683728.0089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6624687.7491; train_optim_loss: 6624687.7491; val_kl_reg_loss: 24811.8754; val_edge_recon_loss: 1791076.2538; val_cat_covariates_contrastive_loss: 3150534.6591; val_gene_expr_recon_loss: 1725561.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6691984.1591; val_optim_loss: 6691984.1591

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9526; val_auprc_score: 0.9696; val_best_acc_score: 0.9236; val_best_f1_score: 0.9454; train_kl_reg_loss: 26858.3466; train_edge_recon_loss: 1765546.5408; train_cat_covariates_contrastive_loss: 3151942.1790; train_gene_expr_recon_loss: 1684266.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6628613.7968; train_optim_loss: 6628613.7968; val_kl_reg_loss: 24889.4602; val_edge_recon_loss: 1781065.6402; val_cat_covariates_contrastive_loss: 3150778.9545; val_gene_expr_recon_loss: 1723561.1610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6680295.1818; val_optim_loss: 6680295.1818
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9519; val_auprc_score: 0.9694; val_best_acc_score: 0.9219; val_best_f1_score: 0.9442; train_kl_reg_loss: 26938.0336; train_edge_recon_loss: 1759155.5128; train_cat_covariates_contrastive_loss: 3153823.0914; train_gene_expr_recon_loss: 1682585.3584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6622502.0000; train_optim_loss: 6622502.0000; val_kl_reg_loss: 24913.6898; val_edge_recon_loss: 1798979.0038; val_cat_covariates_contrastive_loss: 3151768.1326; val_gene_expr_recon_loss: 1724534.3068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6700195.0833; val_optim_loss: 6700195.0833
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9536; val_auprc_score: 0.9711; val_best_acc_score: 0.9224; val_best_f1_score: 0.9447; train_kl_reg_loss: 26916.1226; train_edge_recon_loss: 1760654.8287; train_cat_covariates_contrastive_loss: 3151046.4902; train_gene_expr_recon_loss: 1683722.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6622339.6361; train_optim_loss: 6622339.6361; val_kl_reg_loss: 24829.4490; val_edge_recon_loss: 1790092.1250; val_cat_covariates_contrastive_loss: 3150465.3182; val_gene_expr_recon_loss: 1721311.4337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6686698.3258; val_optim_loss: 6686698.3258
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9485; val_auprc_score: 0.9672; val_best_acc_score: 0.9192; val_best_f1_score: 0.9425; train_kl_reg_loss: 26945.0315; train_edge_recon_loss: 1762528.8080; train_cat_covariates_contrastive_loss: 3152348.9498; train_gene_expr_recon_loss: 1683187.5134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6625010.3087; train_optim_loss: 6625010.3087; val_kl_reg_loss: 24957.8570; val_edge_recon_loss: 1800652.6458; val_cat_covariates_contrastive_loss: 3151184.6023; val_gene_expr_recon_loss: 1723684.9242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6700480.0303; val_optim_loss: 6700480.0303
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9522; val_auprc_score: 0.9697; val_best_acc_score: 0.9211; val_best_f1_score: 0.9438; train_kl_reg_loss: 26948.5199; train_edge_recon_loss: 1758456.1981; train_cat_covariates_contrastive_loss: 3151047.7360; train_gene_expr_recon_loss: 1683902.4109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6620354.8818; train_optim_loss: 6620354.8818; val_kl_reg_loss: 24864.4328; val_edge_recon_loss: 1789248.8466; val_cat_covariates_contrastive_loss: 3150298.9621; val_gene_expr_recon_loss: 1727302.4072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6691714.6742; val_optim_loss: 6691714.6742

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9521; val_auprc_score: 0.9696; val_best_acc_score: 0.9217; val_best_f1_score: 0.9440; train_kl_reg_loss: 26925.8062; train_edge_recon_loss: 1763209.2785; train_cat_covariates_contrastive_loss: 3151235.4128; train_gene_expr_recon_loss: 1683809.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6625180.0689; train_optim_loss: 6625180.0689; val_kl_reg_loss: 24890.8150; val_edge_recon_loss: 1801215.3485; val_cat_covariates_contrastive_loss: 3152176.6591; val_gene_expr_recon_loss: 1720024.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6698307.1667; val_optim_loss: 6698307.1667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9521; val_auprc_score: 0.9695; val_best_acc_score: 0.9216; val_best_f1_score: 0.9441; train_kl_reg_loss: 26944.6602; train_edge_recon_loss: 1761802.5476; train_cat_covariates_contrastive_loss: 3152041.3652; train_gene_expr_recon_loss: 1683441.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6624230.4745; train_optim_loss: 6624230.4745; val_kl_reg_loss: 24851.7368; val_edge_recon_loss: 1796723.2746; val_cat_covariates_contrastive_loss: 3152027.2273; val_gene_expr_recon_loss: 1720613.7121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6694215.9242; val_optim_loss: 6694215.9242
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9502; val_auprc_score: 0.9683; val_best_acc_score: 0.9204; val_best_f1_score: 0.9434; train_kl_reg_loss: 26940.9431; train_edge_recon_loss: 1763108.3189; train_cat_covariates_contrastive_loss: 3151362.3278; train_gene_expr_recon_loss: 1683908.7570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6625320.3435; train_optim_loss: 6625320.3435; val_kl_reg_loss: 24827.1650; val_edge_recon_loss: 1800369.7973; val_cat_covariates_contrastive_loss: 3151611.1705; val_gene_expr_recon_loss: 1724671.1686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6701479.3485; val_optim_loss: 6701479.3485
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9531; val_auprc_score: 0.9700; val_best_acc_score: 0.9216; val_best_f1_score: 0.9442; train_kl_reg_loss: 26937.1739; train_edge_recon_loss: 1757145.1492; train_cat_covariates_contrastive_loss: 3152240.9362; train_gene_expr_recon_loss: 1683141.3408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6619464.6097; train_optim_loss: 6619464.6097; val_kl_reg_loss: 24810.4602; val_edge_recon_loss: 1791996.1515; val_cat_covariates_contrastive_loss: 3152340.8447; val_gene_expr_recon_loss: 1721788.4754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6690935.9091; val_optim_loss: 6690935.9091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 278 min 0 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9084
val AUPRC score: 0.9187
val best accuracy score: 0.9038
val best F1 score: 0.9300
val target rna MSE score: 0.8804
val source rna MSE score: 0.0817
Val cat covariate0 mean sim diff: 0.0023
Val cat covariate1 mean sim diff: -0.1175

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
