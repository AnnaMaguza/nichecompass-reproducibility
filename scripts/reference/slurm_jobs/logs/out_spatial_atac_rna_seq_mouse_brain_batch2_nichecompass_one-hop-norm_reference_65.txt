[True]
Run timestamp: 07082023_192117_65.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_65']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8773; val_auprc_score: 0.8936; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18212.3914; train_edge_recon_loss: 350263.8368; train_gene_expr_recon_loss: 1358764.5000; train_masked_gp_l1_reg_loss: 4624.1917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119729.5165; train_chrom_access_recon_loss: 2631609.1250; train_global_loss: 4483203.5833; train_optim_loss: 4483203.5833; val_kl_reg_loss: 7463.1426; val_edge_recon_loss: 406573.6250; val_gene_expr_recon_loss: 1176025.2500; val_masked_gp_l1_reg_loss: 4202.9131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117460.8125; val_chrom_access_recon_loss: 1675530.0000; val_global_loss: 3387255.7500; val_optim_loss: 3387255.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8876; val_auprc_score: 0.9000; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 5580.9213; train_edge_recon_loss: 350979.1979; train_gene_expr_recon_loss: 1087249.0694; train_masked_gp_l1_reg_loss: 4165.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116079.3481; train_chrom_access_recon_loss: 1532650.8750; train_global_loss: 3096704.8611; train_optim_loss: 3096704.8611; val_kl_reg_loss: 4302.8145; val_edge_recon_loss: 406565.6875; val_gene_expr_recon_loss: 1009649.8750; val_masked_gp_l1_reg_loss: 4235.9268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114460.8594; val_chrom_access_recon_loss: 1455147.3750; val_global_loss: 2994362.5000; val_optim_loss: 2994362.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8888; val_auprc_score: 0.9020; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5642.8152; train_edge_recon_loss: 351530.7569; train_gene_expr_recon_loss: 989158.4306; train_masked_gp_l1_reg_loss: 4431.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113248.6736; train_chrom_access_recon_loss: 1435593.8889; train_global_loss: 2899606.3611; train_optim_loss: 2899606.3611; val_kl_reg_loss: 8770.2344; val_edge_recon_loss: 406595.5625; val_gene_expr_recon_loss: 924687.8750; val_masked_gp_l1_reg_loss: 4676.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111743.4375; val_chrom_access_recon_loss: 1428252.5000; val_global_loss: 2884726.0000; val_optim_loss: 2884726.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8804; val_auprc_score: 0.8932; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 12757.5678; train_edge_recon_loss: 355735.9965; train_gene_expr_recon_loss: 892510.7153; train_masked_gp_l1_reg_loss: 4790.0931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110531.3724; train_chrom_access_recon_loss: 1411571.1250; train_global_loss: 2787896.8333; train_optim_loss: 2787896.8333; val_kl_reg_loss: 14872.3965; val_edge_recon_loss: 406600.9062; val_gene_expr_recon_loss: 836283.3750; val_masked_gp_l1_reg_loss: 4873.1196; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108989.2109; val_chrom_access_recon_loss: 1392651.7500; val_global_loss: 2764271.0000; val_optim_loss: 2764271.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8811; val_auprc_score: 0.8967; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 17534.8647; train_edge_recon_loss: 359196.3715; train_gene_expr_recon_loss: 814282.4583; train_masked_gp_l1_reg_loss: 4893.3297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107666.9106; train_chrom_access_recon_loss: 1379096.9722; train_global_loss: 2682670.9167; train_optim_loss: 2682670.9167; val_kl_reg_loss: 18350.0156; val_edge_recon_loss: 406601.1562; val_gene_expr_recon_loss: 774438.6250; val_masked_gp_l1_reg_loss: 4904.8735; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105932.3828; val_chrom_access_recon_loss: 1369293.0000; val_global_loss: 2679520.0000; val_optim_loss: 2679520.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8859; val_auprc_score: 0.8976; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 19245.3678; train_edge_recon_loss: 360052.2743; train_gene_expr_recon_loss: 765882.9792; train_masked_gp_l1_reg_loss: 4903.4049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104396.9861; train_chrom_access_recon_loss: 1361675.3194; train_global_loss: 2616156.3611; train_optim_loss: 2616156.3611; val_kl_reg_loss: 19205.4805; val_edge_recon_loss: 406595.2188; val_gene_expr_recon_loss: 741969.1250; val_masked_gp_l1_reg_loss: 4898.1318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102390.8906; val_chrom_access_recon_loss: 1348645.0000; val_global_loss: 2623703.7500; val_optim_loss: 2623703.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8821; val_auprc_score: 0.8882; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 19834.8147; train_edge_recon_loss: 360013.6597; train_gene_expr_recon_loss: 734336.8542; train_masked_gp_l1_reg_loss: 4901.4167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100683.2682; train_chrom_access_recon_loss: 1337144.4583; train_global_loss: 2556914.4444; train_optim_loss: 2556914.4444; val_kl_reg_loss: 20802.9492; val_edge_recon_loss: 406556.5000; val_gene_expr_recon_loss: 719284.6250; val_masked_gp_l1_reg_loss: 4893.4673; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98505.7969; val_chrom_access_recon_loss: 1335936.0000; val_global_loss: 2585979.2500; val_optim_loss: 2585979.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8629; val_auprc_score: 0.8662; val_best_acc_score: 0.5181; val_best_f1_score: 0.6743; train_kl_reg_loss: 20939.3518; train_edge_recon_loss: 360129.9861; train_gene_expr_recon_loss: 721121.2986; train_masked_gp_l1_reg_loss: 4885.2956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96717.0373; train_chrom_access_recon_loss: 1331548.6528; train_global_loss: 2535341.6111; train_optim_loss: 2535341.6111; val_kl_reg_loss: 21947.3750; val_edge_recon_loss: 406435.5000; val_gene_expr_recon_loss: 703186.1250; val_masked_gp_l1_reg_loss: 4863.3999; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94461.0938; val_chrom_access_recon_loss: 1328483.3750; val_global_loss: 2559377.0000; val_optim_loss: 2559377.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8429; val_auprc_score: 0.8410; val_best_acc_score: 0.5554; val_best_f1_score: 0.6894; train_kl_reg_loss: 21284.7669; train_edge_recon_loss: 359707.1910; train_gene_expr_recon_loss: 701008.8889; train_masked_gp_l1_reg_loss: 4853.4844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92638.7873; train_chrom_access_recon_loss: 1316047.4444; train_global_loss: 2495540.6111; train_optim_loss: 2495540.6111; val_kl_reg_loss: 22520.7227; val_edge_recon_loss: 406148.1875; val_gene_expr_recon_loss: 690309.9375; val_masked_gp_l1_reg_loss: 4835.2803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90355.7188; val_chrom_access_recon_loss: 1322206.2500; val_global_loss: 2536376.0000; val_optim_loss: 2536376.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8161; val_auprc_score: 0.8098; val_best_acc_score: 0.6134; val_best_f1_score: 0.7147; train_kl_reg_loss: 21881.5575; train_edge_recon_loss: 359821.2083; train_gene_expr_recon_loss: 693872.2708; train_masked_gp_l1_reg_loss: 4826.3050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88529.9983; train_chrom_access_recon_loss: 1320828.6111; train_global_loss: 2489759.9722; train_optim_loss: 2489759.9722; val_kl_reg_loss: 21130.7539; val_edge_recon_loss: 405662.3750; val_gene_expr_recon_loss: 681330.2500; val_masked_gp_l1_reg_loss: 4806.6948; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86256.9141; val_chrom_access_recon_loss: 1317314.6250; val_global_loss: 2516501.5000; val_optim_loss: 2516501.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8126; val_auprc_score: 0.8046; val_best_acc_score: 0.6517; val_best_f1_score: 0.7321; train_kl_reg_loss: 22012.1636; train_edge_recon_loss: 359631.1250; train_gene_expr_recon_loss: 682069.4306; train_masked_gp_l1_reg_loss: 4799.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84466.0964; train_chrom_access_recon_loss: 1309234.0139; train_global_loss: 2462211.8611; train_optim_loss: 2462211.8611; val_kl_reg_loss: 23935.0781; val_edge_recon_loss: 405228.6875; val_gene_expr_recon_loss: 673218.2500; val_masked_gp_l1_reg_loss: 4780.7358; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82248.9688; val_chrom_access_recon_loss: 1312737.2500; val_global_loss: 2502149.0000; val_optim_loss: 2502149.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8084; val_auprc_score: 0.8027; val_best_acc_score: 0.6960; val_best_f1_score: 0.7505; train_kl_reg_loss: 22574.2153; train_edge_recon_loss: 359418.6424; train_gene_expr_recon_loss: 678457.0000; train_masked_gp_l1_reg_loss: 4773.2410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80511.7274; train_chrom_access_recon_loss: 1310426.3889; train_global_loss: 2456161.2500; train_optim_loss: 2456161.2500; val_kl_reg_loss: 20074.4512; val_edge_recon_loss: 404243.8750; val_gene_expr_recon_loss: 668667.4375; val_masked_gp_l1_reg_loss: 4756.4482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78368.7656; val_chrom_access_recon_loss: 1309816.2500; val_global_loss: 2485927.2500; val_optim_loss: 2485927.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8029; val_auprc_score: 0.7979; val_best_acc_score: 0.7083; val_best_f1_score: 0.7512; train_kl_reg_loss: 22414.5093; train_edge_recon_loss: 359048.4097; train_gene_expr_recon_loss: 672433.4583; train_masked_gp_l1_reg_loss: 4754.6757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76709.3915; train_chrom_access_recon_loss: 1307932.0694; train_global_loss: 2443292.4722; train_optim_loss: 2443292.4722; val_kl_reg_loss: 22089.5176; val_edge_recon_loss: 403476.5000; val_gene_expr_recon_loss: 663475.5625; val_masked_gp_l1_reg_loss: 4743.2573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74658.1562; val_chrom_access_recon_loss: 1306095.1250; val_global_loss: 2474538.0000; val_optim_loss: 2474538.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7990; val_auprc_score: 0.7899; val_best_acc_score: 0.7187; val_best_f1_score: 0.7434; train_kl_reg_loss: 22137.4907; train_edge_recon_loss: 358484.0903; train_gene_expr_recon_loss: 666838.0208; train_masked_gp_l1_reg_loss: 4745.6083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73064.6589; train_chrom_access_recon_loss: 1303955.6806; train_global_loss: 2429225.5556; train_optim_loss: 2429225.5556; val_kl_reg_loss: 20777.1992; val_edge_recon_loss: 402003.7500; val_gene_expr_recon_loss: 660420.6250; val_masked_gp_l1_reg_loss: 4735.9385; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71100.4375; val_chrom_access_recon_loss: 1302781.3750; val_global_loss: 2461819.5000; val_optim_loss: 2461819.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8052; val_auprc_score: 0.8022; val_best_acc_score: 0.7214; val_best_f1_score: 0.7342; train_kl_reg_loss: 21831.6658; train_edge_recon_loss: 357956.8333; train_gene_expr_recon_loss: 665436.1389; train_masked_gp_l1_reg_loss: 4735.2764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69582.8776; train_chrom_access_recon_loss: 1302251.4583; train_global_loss: 2421794.2222; train_optim_loss: 2421794.2222; val_kl_reg_loss: 20940.2539; val_edge_recon_loss: 400227.1250; val_gene_expr_recon_loss: 657146.0000; val_masked_gp_l1_reg_loss: 4728.4580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67712.6406; val_chrom_access_recon_loss: 1300654.0000; val_global_loss: 2451408.5000; val_optim_loss: 2451408.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8144; val_auprc_score: 0.8061; val_best_acc_score: 0.7207; val_best_f1_score: 0.7513; train_kl_reg_loss: 21585.9757; train_edge_recon_loss: 356805.7708; train_gene_expr_recon_loss: 663898.9792; train_masked_gp_l1_reg_loss: 4728.8480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66274.8559; train_chrom_access_recon_loss: 1296904.7361; train_global_loss: 2410199.1389; train_optim_loss: 2410199.1389; val_kl_reg_loss: 19812.2305; val_edge_recon_loss: 397170.4688; val_gene_expr_recon_loss: 654825.0000; val_masked_gp_l1_reg_loss: 4718.7456; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64511.5820; val_chrom_access_recon_loss: 1297804.7500; val_global_loss: 2438843.0000; val_optim_loss: 2438843.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8341; val_auprc_score: 0.8227; val_best_acc_score: 0.7365; val_best_f1_score: 0.7689; train_kl_reg_loss: 20993.3566; train_edge_recon_loss: 355863.8854; train_gene_expr_recon_loss: 661117.4722; train_masked_gp_l1_reg_loss: 4724.6147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63159.1176; train_chrom_access_recon_loss: 1298514.8750; train_global_loss: 2404373.3333; train_optim_loss: 2404373.3333; val_kl_reg_loss: 19778.8398; val_edge_recon_loss: 392484.3125; val_gene_expr_recon_loss: 652392.3750; val_masked_gp_l1_reg_loss: 4721.2739; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61495.0781; val_chrom_access_recon_loss: 1295486.8750; val_global_loss: 2426358.7500; val_optim_loss: 2426358.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8512; val_auprc_score: 0.8393; val_best_acc_score: 0.7699; val_best_f1_score: 0.7806; train_kl_reg_loss: 20435.3179; train_edge_recon_loss: 353742.8750; train_gene_expr_recon_loss: 658068.5208; train_masked_gp_l1_reg_loss: 4727.4363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60224.1068; train_chrom_access_recon_loss: 1303200.3333; train_global_loss: 2400398.6389; train_optim_loss: 2400398.6389; val_kl_reg_loss: 19253.4141; val_edge_recon_loss: 383510.9375; val_gene_expr_recon_loss: 650897.0000; val_masked_gp_l1_reg_loss: 4725.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58660.9453; val_chrom_access_recon_loss: 1293971.5000; val_global_loss: 2411019.5000; val_optim_loss: 2411019.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8641; val_auprc_score: 0.8548; val_best_acc_score: 0.7782; val_best_f1_score: 0.7972; train_kl_reg_loss: 19729.4727; train_edge_recon_loss: 349644.5903; train_gene_expr_recon_loss: 660215.9306; train_masked_gp_l1_reg_loss: 4732.3097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57467.8902; train_chrom_access_recon_loss: 1295725.6944; train_global_loss: 2387515.9444; train_optim_loss: 2387515.9444; val_kl_reg_loss: 18081.4375; val_edge_recon_loss: 366267.2812; val_gene_expr_recon_loss: 651883.8750; val_masked_gp_l1_reg_loss: 4734.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55997.4648; val_chrom_access_recon_loss: 1292583.2500; val_global_loss: 2389547.5000; val_optim_loss: 2389547.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8738; val_auprc_score: 0.8620; val_best_acc_score: 0.7856; val_best_f1_score: 0.7997; train_kl_reg_loss: 19614.0757; train_edge_recon_loss: 340865.3924; train_gene_expr_recon_loss: 657444.4653; train_masked_gp_l1_reg_loss: 4745.9558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54880.6406; train_chrom_access_recon_loss: 1295910.3750; train_global_loss: 2373460.8611; train_optim_loss: 2373460.8611; val_kl_reg_loss: 19848.6719; val_edge_recon_loss: 341971.2812; val_gene_expr_recon_loss: 650850.1250; val_masked_gp_l1_reg_loss: 4758.5142; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53507.5195; val_chrom_access_recon_loss: 1290688.0000; val_global_loss: 2361624.0000; val_optim_loss: 2361624.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8646; val_auprc_score: 0.8483; val_best_acc_score: 0.7773; val_best_f1_score: 0.7957; train_kl_reg_loss: 23016.1313; train_edge_recon_loss: 326746.2361; train_gene_expr_recon_loss: 652225.0486; train_masked_gp_l1_reg_loss: 4778.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52460.7270; train_chrom_access_recon_loss: 1287844.0833; train_global_loss: 2347070.9167; train_optim_loss: 2347070.9167; val_kl_reg_loss: 25046.5957; val_edge_recon_loss: 324231.9375; val_gene_expr_recon_loss: 651432.2500; val_masked_gp_l1_reg_loss: 4797.4443; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51169.3750; val_chrom_access_recon_loss: 1289610.3750; val_global_loss: 2346288.0000; val_optim_loss: 2346288.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8795; val_auprc_score: 0.8689; val_best_acc_score: 0.7916; val_best_f1_score: 0.8025; train_kl_reg_loss: 28767.7611; train_edge_recon_loss: 315518.5312; train_gene_expr_recon_loss: 653227.0486; train_masked_gp_l1_reg_loss: 4814.9740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50190.3763; train_chrom_access_recon_loss: 1288403.9861; train_global_loss: 2340922.6944; train_optim_loss: 2340922.6944; val_kl_reg_loss: 28641.1602; val_edge_recon_loss: 316016.7188; val_gene_expr_recon_loss: 649205.0000; val_masked_gp_l1_reg_loss: 4834.0127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48984.0703; val_chrom_access_recon_loss: 1286935.3750; val_global_loss: 2334616.2500; val_optim_loss: 2334616.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8907; val_auprc_score: 0.8733; val_best_acc_score: 0.8040; val_best_f1_score: 0.8148; train_kl_reg_loss: 29148.6016; train_edge_recon_loss: 311749.8160; train_gene_expr_recon_loss: 655520.5000; train_masked_gp_l1_reg_loss: 4851.3104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48067.6984; train_chrom_access_recon_loss: 1282918.9861; train_global_loss: 2332256.9167; train_optim_loss: 2332256.9167; val_kl_reg_loss: 26870.1289; val_edge_recon_loss: 312326.0312; val_gene_expr_recon_loss: 647666.1250; val_masked_gp_l1_reg_loss: 4870.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46945.1016; val_chrom_access_recon_loss: 1284972.1250; val_global_loss: 2323650.0000; val_optim_loss: 2323650.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9030; val_auprc_score: 0.8842; val_best_acc_score: 0.8220; val_best_f1_score: 0.8290; train_kl_reg_loss: 27973.0158; train_edge_recon_loss: 309466.6215; train_gene_expr_recon_loss: 655171.2778; train_masked_gp_l1_reg_loss: 4889.8916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46093.1016; train_chrom_access_recon_loss: 1286634.6389; train_global_loss: 2330228.5278; train_optim_loss: 2330228.5278; val_kl_reg_loss: 26797.4238; val_edge_recon_loss: 307280.2500; val_gene_expr_recon_loss: 646143.2500; val_masked_gp_l1_reg_loss: 4905.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45039.0703; val_chrom_access_recon_loss: 1283092.0000; val_global_loss: 2313257.5000; val_optim_loss: 2313257.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9173; val_auprc_score: 0.9005; val_best_acc_score: 0.8397; val_best_f1_score: 0.8462; train_kl_reg_loss: 27870.7717; train_edge_recon_loss: 305003.5312; train_gene_expr_recon_loss: 652541.6250; train_masked_gp_l1_reg_loss: 4927.2658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44237.9106; train_chrom_access_recon_loss: 1282319.9722; train_global_loss: 2316901.1111; train_optim_loss: 2316901.1111; val_kl_reg_loss: 26961.4102; val_edge_recon_loss: 302879.1875; val_gene_expr_recon_loss: 646468.6875; val_masked_gp_l1_reg_loss: 4946.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43247.4062; val_chrom_access_recon_loss: 1281437.2500; val_global_loss: 2305940.5000; val_optim_loss: 2305940.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9194; val_auprc_score: 0.9019; val_best_acc_score: 0.8409; val_best_f1_score: 0.8495; train_kl_reg_loss: 26268.2504; train_edge_recon_loss: 315275.7847; train_gene_expr_recon_loss: 938273.4236; train_masked_gp_l1_reg_loss: 5016.8251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42372.9049; train_chrom_access_recon_loss: 1350173.5139; train_global_loss: 2677380.6667; train_optim_loss: 2677380.6667; val_kl_reg_loss: 15237.1826; val_edge_recon_loss: 307263.1562; val_gene_expr_recon_loss: 927061.0625; val_masked_gp_l1_reg_loss: 5124.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41218.0898; val_chrom_access_recon_loss: 1354109.0000; val_global_loss: 2650012.7500; val_optim_loss: 2650012.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9240; val_auprc_score: 0.9066; val_best_acc_score: 0.8484; val_best_f1_score: 0.8542; train_kl_reg_loss: 26104.7131; train_edge_recon_loss: 305489.9653; train_gene_expr_recon_loss: 940530.6250; train_masked_gp_l1_reg_loss: 5220.7850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40264.2778; train_chrom_access_recon_loss: 1354461.0556; train_global_loss: 2672071.4167; train_optim_loss: 2672071.4167; val_kl_reg_loss: 16436.7012; val_edge_recon_loss: 303463.3750; val_gene_expr_recon_loss: 922469.6250; val_masked_gp_l1_reg_loss: 5331.4639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39082.7031; val_chrom_access_recon_loss: 1351414.6250; val_global_loss: 2638198.5000; val_optim_loss: 2638198.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9267; val_auprc_score: 0.9089; val_best_acc_score: 0.8500; val_best_f1_score: 0.8571; train_kl_reg_loss: 24323.6847; train_edge_recon_loss: 302553.3264; train_gene_expr_recon_loss: 926893.2431; train_masked_gp_l1_reg_loss: 5405.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38165.0556; train_chrom_access_recon_loss: 1352297.0833; train_global_loss: 2649637.5833; train_optim_loss: 2649637.5833; val_kl_reg_loss: 18022.7969; val_edge_recon_loss: 300333.9375; val_gene_expr_recon_loss: 917000.1250; val_masked_gp_l1_reg_loss: 5486.1616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37039.9062; val_chrom_access_recon_loss: 1349845.8750; val_global_loss: 2627728.7500; val_optim_loss: 2627728.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9289; val_auprc_score: 0.9130; val_best_acc_score: 0.8557; val_best_f1_score: 0.8593; train_kl_reg_loss: 23226.0595; train_edge_recon_loss: 298850.3681; train_gene_expr_recon_loss: 924320.5694; train_masked_gp_l1_reg_loss: 5539.0557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36182.0851; train_chrom_access_recon_loss: 1349855.1667; train_global_loss: 2637973.3056; train_optim_loss: 2637973.3056; val_kl_reg_loss: 19486.8359; val_edge_recon_loss: 296606.6562; val_gene_expr_recon_loss: 914084.7500; val_masked_gp_l1_reg_loss: 5598.5107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35135.1758; val_chrom_access_recon_loss: 1347755.2500; val_global_loss: 2618667.0000; val_optim_loss: 2618667.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9265; val_auprc_score: 0.9064; val_best_acc_score: 0.8541; val_best_f1_score: 0.8601; train_kl_reg_loss: 22937.2363; train_edge_recon_loss: 296881.5035; train_gene_expr_recon_loss: 921351.6667; train_masked_gp_l1_reg_loss: 5590.0635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35019.2170; train_chrom_access_recon_loss: 1343513.5972; train_global_loss: 2625293.2500; train_optim_loss: 2625293.2500; val_kl_reg_loss: 19773.7539; val_edge_recon_loss: 298819.4375; val_gene_expr_recon_loss: 913183.0000; val_masked_gp_l1_reg_loss: 5581.4185; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34878.2969; val_chrom_access_recon_loss: 1347338.6250; val_global_loss: 2619574.5000; val_optim_loss: 2619574.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9247; val_auprc_score: 0.9032; val_best_acc_score: 0.8545; val_best_f1_score: 0.8581; train_kl_reg_loss: 23095.7815; train_edge_recon_loss: 297773.2743; train_gene_expr_recon_loss: 925049.6667; train_masked_gp_l1_reg_loss: 5580.2508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34778.7253; train_chrom_access_recon_loss: 1348244.9444; train_global_loss: 2634522.6667; train_optim_loss: 2634522.6667; val_kl_reg_loss: 19773.6797; val_edge_recon_loss: 297436.0938; val_gene_expr_recon_loss: 912879.7500; val_masked_gp_l1_reg_loss: 5577.8999; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34653.4336; val_chrom_access_recon_loss: 1347175.2500; val_global_loss: 2617496.0000; val_optim_loss: 2617496.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9294; val_auprc_score: 0.9081; val_best_acc_score: 0.8560; val_best_f1_score: 0.8616; train_kl_reg_loss: 22907.8526; train_edge_recon_loss: 296516.9931; train_gene_expr_recon_loss: 920569.9097; train_masked_gp_l1_reg_loss: 5577.3659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34558.2843; train_chrom_access_recon_loss: 1341609.7639; train_global_loss: 2621740.2500; train_optim_loss: 2621740.2500; val_kl_reg_loss: 19701.4902; val_edge_recon_loss: 296111.6250; val_gene_expr_recon_loss: 912810.8750; val_masked_gp_l1_reg_loss: 5577.0791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34441.0234; val_chrom_access_recon_loss: 1347264.7500; val_global_loss: 2615907.0000; val_optim_loss: 2615907.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9242; val_auprc_score: 0.9056; val_best_acc_score: 0.8479; val_best_f1_score: 0.8561; train_kl_reg_loss: 22905.8587; train_edge_recon_loss: 297286.5069; train_gene_expr_recon_loss: 924434.7222; train_masked_gp_l1_reg_loss: 5577.8598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34349.9240; train_chrom_access_recon_loss: 1348852.2500; train_global_loss: 2633407.1389; train_optim_loss: 2633407.1389; val_kl_reg_loss: 19789.1172; val_edge_recon_loss: 300768.6875; val_gene_expr_recon_loss: 912240.1250; val_masked_gp_l1_reg_loss: 5579.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34238.9805; val_chrom_access_recon_loss: 1347081.5000; val_global_loss: 2619698.0000; val_optim_loss: 2619698.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 31 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9121
val AUPRC score: 0.8954
val best accuracy score: 0.8273
val best F1 score: 0.8409
val target rna MSE score: 3.7526
val source rna MSE score: 3.1410
val target atac MSE score: 0.1368
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
