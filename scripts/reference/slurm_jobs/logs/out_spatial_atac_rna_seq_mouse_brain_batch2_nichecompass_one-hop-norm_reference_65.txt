[True]
Run timestamp: 29072023_113735_65.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_65']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8794; val_auprc_score: 0.8968; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19109.0695; train_edge_recon_loss: 3481022.5000; train_gene_expr_recon_loss: 729316.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 18365331.5556; train_global_loss: 22594779.1111; train_optim_loss: 22594779.1111; val_kl_reg_loss: 13979.6924; val_edge_recon_loss: 4065382.5000; val_gene_expr_recon_loss: 671747.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17354640.0000; val_global_loss: 22105750.0000; val_optim_loss: 22105750.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8786; val_auprc_score: 0.8980; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14148.9482; train_edge_recon_loss: 3493610.8056; train_gene_expr_recon_loss: 707953.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17336307.5556; train_global_loss: 21552020.4444; train_optim_loss: 21552020.4444; val_kl_reg_loss: 16537.1445; val_edge_recon_loss: 4065733.5000; val_gene_expr_recon_loss: 676558.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17191678.0000; val_global_loss: 21950508.0000; val_optim_loss: 21950508.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8767; val_auprc_score: 0.8931; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17972.0213; train_edge_recon_loss: 3498667.7778; train_gene_expr_recon_loss: 651435.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17051750.0000; train_global_loss: 21219824.6667; train_optim_loss: 21219824.6667; val_kl_reg_loss: 17012.2031; val_edge_recon_loss: 4065941.7500; val_gene_expr_recon_loss: 628553.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17020980.0000; val_global_loss: 21732488.0000; val_optim_loss: 21732488.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8759; val_auprc_score: 0.8895; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 25927.7240; train_edge_recon_loss: 3507663.0556; train_gene_expr_recon_loss: 628591.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16821709.5556; train_global_loss: 20983891.5556; train_optim_loss: 20983891.5556; val_kl_reg_loss: 35279.4141; val_edge_recon_loss: 4066000.0000; val_gene_expr_recon_loss: 626541.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16840054.0000; val_global_loss: 21567876.0000; val_optim_loss: 21567876.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8659; val_auprc_score: 0.8806; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 43289.2209; train_edge_recon_loss: 3510312.3611; train_gene_expr_recon_loss: 626751.4653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16772342.0000; train_global_loss: 20952695.5556; train_optim_loss: 20952695.5556; val_kl_reg_loss: 42195.8828; val_edge_recon_loss: 4065976.5000; val_gene_expr_recon_loss: 606434.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16657454.0000; val_global_loss: 21372060.0000; val_optim_loss: 21372060.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8680; val_auprc_score: 0.8872; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 51571.0365; train_edge_recon_loss: 3514986.8889; train_gene_expr_recon_loss: 598400.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16487515.8889; train_global_loss: 20652474.2222; train_optim_loss: 20652474.2222; val_kl_reg_loss: 57001.4375; val_edge_recon_loss: 4066012.5000; val_gene_expr_recon_loss: 582863.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16504835.0000; val_global_loss: 21210712.0000; val_optim_loss: 21210712.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8689; val_auprc_score: 0.8865; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 62805.0295; train_edge_recon_loss: 3518798.1111; train_gene_expr_recon_loss: 577715.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16415888.6667; train_global_loss: 20575207.3333; train_optim_loss: 20575207.3333; val_kl_reg_loss: 59127.6406; val_edge_recon_loss: 4066012.5000; val_gene_expr_recon_loss: 569835.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16409909.0000; val_global_loss: 21104884.0000; val_optim_loss: 21104884.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8733; val_auprc_score: 0.8908; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 67162.8819; train_edge_recon_loss: 3516959.8333; train_gene_expr_recon_loss: 565957.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16324758.7778; train_global_loss: 20474838.6667; train_optim_loss: 20474838.6667; val_kl_reg_loss: 58043.3984; val_edge_recon_loss: 4065948.7500; val_gene_expr_recon_loss: 551306.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16267440.0000; val_global_loss: 20942738.0000; val_optim_loss: 20942738.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8654; val_auprc_score: 0.8788; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 69385.1927; train_edge_recon_loss: 3517820.5278; train_gene_expr_recon_loss: 545337.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16188818.5556; train_global_loss: 20321362.0000; train_optim_loss: 20321362.0000; val_kl_reg_loss: 56154.0977; val_edge_recon_loss: 4065803.0000; val_gene_expr_recon_loss: 532477.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16173746.0000; val_global_loss: 20828180.0000; val_optim_loss: 20828180.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8496; val_auprc_score: 0.8605; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 69013.8789; train_edge_recon_loss: 3516284.0833; train_gene_expr_recon_loss: 526691.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16071036.2222; train_global_loss: 20183025.3333; train_optim_loss: 20183025.3333; val_kl_reg_loss: 62354.7578; val_edge_recon_loss: 4065654.0000; val_gene_expr_recon_loss: 511926.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16040252.0000; val_global_loss: 20680188.0000; val_optim_loss: 20680188.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8350; val_auprc_score: 0.8508; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 72071.2309; train_edge_recon_loss: 3514979.0000; train_gene_expr_recon_loss: 505815.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15998386.0000; train_global_loss: 20091251.5556; train_optim_loss: 20091251.5556; val_kl_reg_loss: 62640.7656; val_edge_recon_loss: 4065242.7500; val_gene_expr_recon_loss: 492191.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15945043.0000; val_global_loss: 20565118.0000; val_optim_loss: 20565118.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8125; val_auprc_score: 0.8311; val_best_acc_score: 0.5222; val_best_f1_score: 0.6766; train_kl_reg_loss: 70018.3090; train_edge_recon_loss: 3514498.8889; train_gene_expr_recon_loss: 483638.0451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15732126.1111; train_global_loss: 19800281.1111; train_optim_loss: 19800281.1111; val_kl_reg_loss: 61638.6055; val_edge_recon_loss: 4064583.7500; val_gene_expr_recon_loss: 474018.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15828962.0000; val_global_loss: 20429204.0000; val_optim_loss: 20429204.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7922; val_auprc_score: 0.8042; val_best_acc_score: 0.5350; val_best_f1_score: 0.6816; train_kl_reg_loss: 69331.1684; train_edge_recon_loss: 3512854.0556; train_gene_expr_recon_loss: 468098.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15684477.1111; train_global_loss: 19734761.7778; train_optim_loss: 19734761.7778; val_kl_reg_loss: 63407.1484; val_edge_recon_loss: 4063583.2500; val_gene_expr_recon_loss: 458090.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15744054.0000; val_global_loss: 20329136.0000; val_optim_loss: 20329136.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7995; val_auprc_score: 0.8078; val_best_acc_score: 0.5546; val_best_f1_score: 0.6895; train_kl_reg_loss: 69028.5534; train_edge_recon_loss: 3511411.2500; train_gene_expr_recon_loss: 453730.7396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15647208.8889; train_global_loss: 19681379.5556; train_optim_loss: 19681379.5556; val_kl_reg_loss: 64809.4766; val_edge_recon_loss: 4062323.7500; val_gene_expr_recon_loss: 443627.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15643255.0000; val_global_loss: 20214016.0000; val_optim_loss: 20214016.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7849; val_auprc_score: 0.7892; val_best_acc_score: 0.5792; val_best_f1_score: 0.6997; train_kl_reg_loss: 68110.1354; train_edge_recon_loss: 3509667.3056; train_gene_expr_recon_loss: 444162.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15650437.2222; train_global_loss: 19672376.8889; train_optim_loss: 19672376.8889; val_kl_reg_loss: 53584.3906; val_edge_recon_loss: 4060243.0000; val_gene_expr_recon_loss: 437100.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15552363.0000; val_global_loss: 20103290.0000; val_optim_loss: 20103290.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7812; val_auprc_score: 0.7861; val_best_acc_score: 0.5934; val_best_f1_score: 0.7053; train_kl_reg_loss: 64748.7509; train_edge_recon_loss: 3510443.6944; train_gene_expr_recon_loss: 435835.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15580236.2222; train_global_loss: 19591264.2222; train_optim_loss: 19591264.2222; val_kl_reg_loss: 57489.1016; val_edge_recon_loss: 4058976.5000; val_gene_expr_recon_loss: 426565.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15504856.0000; val_global_loss: 20047888.0000; val_optim_loss: 20047888.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7738; val_auprc_score: 0.7771; val_best_acc_score: 0.6122; val_best_f1_score: 0.7128; train_kl_reg_loss: 64738.9913; train_edge_recon_loss: 3506767.1111; train_gene_expr_recon_loss: 425125.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15388064.8889; train_global_loss: 19384696.0000; train_optim_loss: 19384696.0000; val_kl_reg_loss: 56622.4375; val_edge_recon_loss: 4057283.5000; val_gene_expr_recon_loss: 418990.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15464460.0000; val_global_loss: 19997356.0000; val_optim_loss: 19997356.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7815; val_auprc_score: 0.7806; val_best_acc_score: 0.6424; val_best_f1_score: 0.7257; train_kl_reg_loss: 62433.7726; train_edge_recon_loss: 3505639.3889; train_gene_expr_recon_loss: 418804.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15409946.4444; train_global_loss: 19396824.0000; train_optim_loss: 19396824.0000; val_kl_reg_loss: 53136.4766; val_edge_recon_loss: 4054308.2500; val_gene_expr_recon_loss: 413947.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15429695.0000; val_global_loss: 19951088.0000; val_optim_loss: 19951088.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7792; val_auprc_score: 0.7753; val_best_acc_score: 0.6571; val_best_f1_score: 0.7306; train_kl_reg_loss: 61465.5417; train_edge_recon_loss: 3503226.5000; train_gene_expr_recon_loss: 413812.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15356963.4444; train_global_loss: 19335467.7778; train_optim_loss: 19335467.7778; val_kl_reg_loss: 57357.2500; val_edge_recon_loss: 4051262.7500; val_gene_expr_recon_loss: 408095.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15408947.0000; val_global_loss: 19925662.0000; val_optim_loss: 19925662.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7746; val_auprc_score: 0.7672; val_best_acc_score: 0.6791; val_best_f1_score: 0.7335; train_kl_reg_loss: 61050.5056; train_edge_recon_loss: 3501483.2222; train_gene_expr_recon_loss: 410739.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15391361.2222; train_global_loss: 19364634.4444; train_optim_loss: 19364634.4444; val_kl_reg_loss: 45254.5391; val_edge_recon_loss: 4044509.2500; val_gene_expr_recon_loss: 409025.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15372582.0000; val_global_loss: 19871372.0000; val_optim_loss: 19871372.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7836; val_auprc_score: 0.7795; val_best_acc_score: 0.6897; val_best_f1_score: 0.7366; train_kl_reg_loss: 56761.2743; train_edge_recon_loss: 3501506.7778; train_gene_expr_recon_loss: 405552.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15321800.0000; train_global_loss: 19285620.0000; train_optim_loss: 19285620.0000; val_kl_reg_loss: 57135.4453; val_edge_recon_loss: 4042264.5000; val_gene_expr_recon_loss: 402391.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15367584.0000; val_global_loss: 19869376.0000; val_optim_loss: 19869376.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7928; val_auprc_score: 0.7845; val_best_acc_score: 0.7133; val_best_f1_score: 0.7358; train_kl_reg_loss: 59679.5386; train_edge_recon_loss: 3497580.8611; train_gene_expr_recon_loss: 402420.6215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15298182.4444; train_global_loss: 19257863.7778; train_optim_loss: 19257863.7778; val_kl_reg_loss: 45597.2188; val_edge_recon_loss: 4027385.7500; val_gene_expr_recon_loss: 402728.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15368286.0000; val_global_loss: 19843998.0000; val_optim_loss: 19843998.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7929; val_auprc_score: 0.7870; val_best_acc_score: 0.7150; val_best_f1_score: 0.7260; train_kl_reg_loss: 54574.1476; train_edge_recon_loss: 3496990.5278; train_gene_expr_recon_loss: 402696.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15318272.6667; train_global_loss: 19272534.2222; train_optim_loss: 19272534.2222; val_kl_reg_loss: 53709.5312; val_edge_recon_loss: 4020617.5000; val_gene_expr_recon_loss: 397852.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15292638.0000; val_global_loss: 19764818.0000; val_optim_loss: 19764818.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7976; val_auprc_score: 0.7843; val_best_acc_score: 0.7214; val_best_f1_score: 0.7307; train_kl_reg_loss: 55517.9128; train_edge_recon_loss: 3493419.3889; train_gene_expr_recon_loss: 398548.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15288460.4444; train_global_loss: 19235945.5556; train_optim_loss: 19235945.5556; val_kl_reg_loss: 45824.6250; val_edge_recon_loss: 4000377.2500; val_gene_expr_recon_loss: 397266.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15323004.0000; val_global_loss: 19766472.0000; val_optim_loss: 19766472.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8186; val_auprc_score: 0.8033; val_best_acc_score: 0.7218; val_best_f1_score: 0.7516; train_kl_reg_loss: 53598.4857; train_edge_recon_loss: 3486731.1389; train_gene_expr_recon_loss: 398879.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15305663.8889; train_global_loss: 19244872.8889; train_optim_loss: 19244872.8889; val_kl_reg_loss: 45548.4297; val_edge_recon_loss: 3975904.0000; val_gene_expr_recon_loss: 395309.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15279475.0000; val_global_loss: 19696236.0000; val_optim_loss: 19696236.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8503; val_auprc_score: 0.8279; val_best_acc_score: 0.7700; val_best_f1_score: 0.7952; train_kl_reg_loss: 42429.5662; train_edge_recon_loss: 3843663.7500; train_gene_expr_recon_loss: 410163.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15360623.4444; train_global_loss: 19656880.2222; train_optim_loss: 19656880.2222; val_kl_reg_loss: 6862.1597; val_edge_recon_loss: 3937687.5000; val_gene_expr_recon_loss: 459691.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15752204.0000; val_global_loss: 20156446.0000; val_optim_loss: 20156446.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8879; val_auprc_score: 0.8588; val_best_acc_score: 0.8170; val_best_f1_score: 0.8337; train_kl_reg_loss: 16726.3147; train_edge_recon_loss: 3543010.1944; train_gene_expr_recon_loss: 518116.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16207720.8889; train_global_loss: 20285573.3333; train_optim_loss: 20285573.3333; val_kl_reg_loss: 910.1633; val_edge_recon_loss: 3864476.0000; val_gene_expr_recon_loss: 536406.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16376408.0000; val_global_loss: 20778200.0000; val_optim_loss: 20778200.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8778; val_auprc_score: 0.8449; val_best_acc_score: 0.7957; val_best_f1_score: 0.8230; train_kl_reg_loss: 7457.4979; train_edge_recon_loss: 3545675.0556; train_gene_expr_recon_loss: 463051.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15832425.5556; train_global_loss: 19848609.5556; train_optim_loss: 19848609.5556; val_kl_reg_loss: 9378.0293; val_edge_recon_loss: 4025540.7500; val_gene_expr_recon_loss: 414822.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15494116.0000; val_global_loss: 19943858.0000; val_optim_loss: 19943858.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8789; val_auprc_score: 0.8488; val_best_acc_score: 0.7968; val_best_f1_score: 0.8238; train_kl_reg_loss: 13858.9117; train_edge_recon_loss: 3565352.3889; train_gene_expr_recon_loss: 424657.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15538359.7778; train_global_loss: 19542228.4444; train_optim_loss: 19542228.4444; val_kl_reg_loss: 17137.1113; val_edge_recon_loss: 4029713.5000; val_gene_expr_recon_loss: 413961.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15437808.0000; val_global_loss: 19898620.0000; val_optim_loss: 19898620.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8758; val_auprc_score: 0.8440; val_best_acc_score: 0.7840; val_best_f1_score: 0.8154; train_kl_reg_loss: 20531.2635; train_edge_recon_loss: 3552465.8333; train_gene_expr_recon_loss: 422367.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15415510.8889; train_global_loss: 19410876.0000; train_optim_loss: 19410876.0000; val_kl_reg_loss: 22915.1484; val_edge_recon_loss: 4033109.0000; val_gene_expr_recon_loss: 409666.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15402540.0000; val_global_loss: 19868230.0000; val_optim_loss: 19868230.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8869; val_auprc_score: 0.8604; val_best_acc_score: 0.7990; val_best_f1_score: 0.8261; train_kl_reg_loss: 24951.0241; train_edge_recon_loss: 3542828.5833; train_gene_expr_recon_loss: 416825.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15382950.1111; train_global_loss: 19367555.1111; train_optim_loss: 19367555.1111; val_kl_reg_loss: 22572.8984; val_edge_recon_loss: 4031807.0000; val_gene_expr_recon_loss: 407581.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15399671.0000; val_global_loss: 19861632.0000; val_optim_loss: 19861632.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8811; val_auprc_score: 0.8534; val_best_acc_score: 0.7898; val_best_f1_score: 0.8198; train_kl_reg_loss: 24752.6194; train_edge_recon_loss: 3558138.6944; train_gene_expr_recon_loss: 415278.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15434319.2222; train_global_loss: 19432488.8889; train_optim_loss: 19432488.8889; val_kl_reg_loss: 23891.2109; val_edge_recon_loss: 4032758.2500; val_gene_expr_recon_loss: 406237.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15399182.0000; val_global_loss: 19862068.0000; val_optim_loss: 19862068.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8863; val_auprc_score: 0.8578; val_best_acc_score: 0.7926; val_best_f1_score: 0.8217; train_kl_reg_loss: 26453.1000; train_edge_recon_loss: 3556648.7222; train_gene_expr_recon_loss: 413907.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15357440.3333; train_global_loss: 19354449.3333; train_optim_loss: 19354449.3333; val_kl_reg_loss: 25393.3086; val_edge_recon_loss: 4032189.7500; val_gene_expr_recon_loss: 404738.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15379520.0000; val_global_loss: 19841840.0000; val_optim_loss: 19841840.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8204
val AUPRC score: 0.8083
val best accuracy score: 0.7474
val best F1 score: 0.7627
val target rna MSE score: 6.1063
val source rna MSE score: 9.7346
val target atac MSE score: 0.1200
val source atac MSE score: 0.0176
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
