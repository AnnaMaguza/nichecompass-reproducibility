[True]
Run timestamp: 10082023_162714_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7437; val_auprc_score: 0.7645; val_best_acc_score: 0.5512; val_best_f1_score: 0.6866; train_kl_reg_loss: 144141.7568; train_edge_recon_loss: 3595357.4256; train_gene_expr_recon_loss: 26343964.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1363446.0639; train_global_loss: 31446909.8015; train_optim_loss: 31446909.8015; val_kl_reg_loss: 220763.2167; val_edge_recon_loss: 4062592.2000; val_gene_expr_recon_loss: 22975236.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1276838.4333; val_global_loss: 28535430.4000; val_optim_loss: 28535430.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8083; val_auprc_score: 0.8116; val_best_acc_score: 0.7061; val_best_f1_score: 0.7481; train_kl_reg_loss: 179570.7858; train_edge_recon_loss: 3570404.0916; train_gene_expr_recon_loss: 22489788.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1277822.0849; train_global_loss: 27517585.2519; train_optim_loss: 27517585.2519; val_kl_reg_loss: 169662.7885; val_edge_recon_loss: 4045979.3667; val_gene_expr_recon_loss: 22458944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1264569.2417; val_global_loss: 27939155.3333; val_optim_loss: 27939155.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8622; val_auprc_score: 0.8624; val_best_acc_score: 0.7602; val_best_f1_score: 0.7875; train_kl_reg_loss: 145798.3414; train_edge_recon_loss: 3537858.0782; train_gene_expr_recon_loss: 22157361.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1266568.8454; train_global_loss: 27107587.2214; train_optim_loss: 27107587.2214; val_kl_reg_loss: 131311.8281; val_edge_recon_loss: 3919922.6333; val_gene_expr_recon_loss: 22223643.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1256238.2083; val_global_loss: 27531116.4000; val_optim_loss: 27531116.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9016; val_auprc_score: 0.8887; val_best_acc_score: 0.8267; val_best_f1_score: 0.8379; train_kl_reg_loss: 113953.1626; train_edge_recon_loss: 3361360.8550; train_gene_expr_recon_loss: 21991754.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1260986.5639; train_global_loss: 26728055.0687; train_optim_loss: 26728055.0687; val_kl_reg_loss: 122416.3714; val_edge_recon_loss: 3078726.5000; val_gene_expr_recon_loss: 22086453.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1250594.4000; val_global_loss: 26538190.5333; val_optim_loss: 26538190.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9075; val_auprc_score: 0.8928; val_best_acc_score: 0.8316; val_best_f1_score: 0.8450; train_kl_reg_loss: 147930.2860; train_edge_recon_loss: 2955677.0744; train_gene_expr_recon_loss: 21844840.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1254514.4189; train_global_loss: 26202962.5649; train_optim_loss: 26202962.5649; val_kl_reg_loss: 156414.5500; val_edge_recon_loss: 2944792.8000; val_gene_expr_recon_loss: 22099211.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1255564.1750; val_global_loss: 26455982.8000; val_optim_loss: 26455982.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9250; val_auprc_score: 0.9091; val_best_acc_score: 0.8575; val_best_f1_score: 0.8657; train_kl_reg_loss: 150821.9344; train_edge_recon_loss: 2886747.9733; train_gene_expr_recon_loss: 21713666.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1249301.3044; train_global_loss: 26000537.8779; train_optim_loss: 26000537.8779; val_kl_reg_loss: 149986.6417; val_edge_recon_loss: 2873401.3833; val_gene_expr_recon_loss: 21792323.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1240394.4500; val_global_loss: 26056105.8667; val_optim_loss: 26056105.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9322; val_auprc_score: 0.9196; val_best_acc_score: 0.8678; val_best_f1_score: 0.8759; train_kl_reg_loss: 145106.3401; train_edge_recon_loss: 2862886.9752; train_gene_expr_recon_loss: 21571237.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1243281.8073; train_global_loss: 25822512.4275; train_optim_loss: 25822512.4275; val_kl_reg_loss: 143810.4083; val_edge_recon_loss: 2837872.5500; val_gene_expr_recon_loss: 21734386.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1240599.6417; val_global_loss: 25956668.8000; val_optim_loss: 25956668.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9359; val_auprc_score: 0.9237; val_best_acc_score: 0.8716; val_best_f1_score: 0.8779; train_kl_reg_loss: 136824.5331; train_edge_recon_loss: 2855540.6775; train_gene_expr_recon_loss: 21453087.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1238916.4609; train_global_loss: 25684369.2519; train_optim_loss: 25684369.2519; val_kl_reg_loss: 133889.0729; val_edge_recon_loss: 2845108.4667; val_gene_expr_recon_loss: 21553869.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1232439.1500; val_global_loss: 25765306.5333; val_optim_loss: 25765306.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9337; val_auprc_score: 0.9204; val_best_acc_score: 0.8676; val_best_f1_score: 0.8746; train_kl_reg_loss: 131482.5699; train_edge_recon_loss: 2838500.3168; train_gene_expr_recon_loss: 21355771.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1235233.4265; train_global_loss: 25560987.8473; train_optim_loss: 25560987.8473; val_kl_reg_loss: 124709.4250; val_edge_recon_loss: 2841251.0667; val_gene_expr_recon_loss: 21480161.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1225557.5083; val_global_loss: 25671679.4667; val_optim_loss: 25671679.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9411; val_auprc_score: 0.9283; val_best_acc_score: 0.8790; val_best_f1_score: 0.8832; train_kl_reg_loss: 126579.4967; train_edge_recon_loss: 2824355.7958; train_gene_expr_recon_loss: 21254340.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1230531.6040; train_global_loss: 25435807.6031; train_optim_loss: 25435807.6031; val_kl_reg_loss: 123130.7974; val_edge_recon_loss: 2837687.7500; val_gene_expr_recon_loss: 21384074.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221006.1167; val_global_loss: 25565899.0667; val_optim_loss: 25565899.0667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9380; val_auprc_score: 0.9208; val_best_acc_score: 0.8785; val_best_f1_score: 0.8853; train_kl_reg_loss: 123395.4055; train_edge_recon_loss: 2806497.6393; train_gene_expr_recon_loss: 21185961.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227309.9389; train_global_loss: 25343164.9160; train_optim_loss: 25343164.9160; val_kl_reg_loss: 119999.8953; val_edge_recon_loss: 2816859.4167; val_gene_expr_recon_loss: 21328772.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1220298.5250; val_global_loss: 25485930.6667; val_optim_loss: 25485930.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9430; val_auprc_score: 0.9309; val_best_acc_score: 0.8831; val_best_f1_score: 0.8891; train_kl_reg_loss: 117910.7883; train_edge_recon_loss: 2804652.9275; train_gene_expr_recon_loss: 21090594.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222743.3053; train_global_loss: 25235901.3893; train_optim_loss: 25235901.3893; val_kl_reg_loss: 120495.5578; val_edge_recon_loss: 2809908.7000; val_gene_expr_recon_loss: 21235312.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1216872.9083; val_global_loss: 25382590.0000; val_optim_loss: 25382590.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9484; val_auprc_score: 0.9390; val_best_acc_score: 0.8861; val_best_f1_score: 0.8918; train_kl_reg_loss: 113259.5859; train_edge_recon_loss: 2793378.3073; train_gene_expr_recon_loss: 21063734.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222787.7805; train_global_loss: 25193160.1985; train_optim_loss: 25193160.1985; val_kl_reg_loss: 113107.6672; val_edge_recon_loss: 2815173.1000; val_gene_expr_recon_loss: 21265817.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1223799.4833; val_global_loss: 25417897.6000; val_optim_loss: 25417897.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9440; val_auprc_score: 0.9315; val_best_acc_score: 0.8847; val_best_f1_score: 0.8904; train_kl_reg_loss: 109268.9352; train_edge_recon_loss: 2782745.3760; train_gene_expr_recon_loss: 20985657.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218927.0143; train_global_loss: 25096598.3817; train_optim_loss: 25096598.3817; val_kl_reg_loss: 107815.5391; val_edge_recon_loss: 2795417.8167; val_gene_expr_recon_loss: 21160504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1213012.8333; val_global_loss: 25276750.1333; val_optim_loss: 25276750.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9488; val_auprc_score: 0.9382; val_best_acc_score: 0.8892; val_best_f1_score: 0.8943; train_kl_reg_loss: 106686.5007; train_edge_recon_loss: 2778954.8569; train_gene_expr_recon_loss: 20933827.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1217024.9494; train_global_loss: 25036494.1374; train_optim_loss: 25036494.1374; val_kl_reg_loss: 105762.2104; val_edge_recon_loss: 2781916.9333; val_gene_expr_recon_loss: 21122590.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1208449.1917; val_global_loss: 25218718.8000; val_optim_loss: 25218718.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9499; val_auprc_score: 0.9390; val_best_acc_score: 0.8941; val_best_f1_score: 0.8986; train_kl_reg_loss: 103772.8556; train_edge_recon_loss: 2771063.0935; train_gene_expr_recon_loss: 20871650.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1215081.4828; train_global_loss: 24961567.6641; train_optim_loss: 24961567.6641; val_kl_reg_loss: 102494.8453; val_edge_recon_loss: 2790283.5667; val_gene_expr_recon_loss: 20962923.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1208639.1250; val_global_loss: 25064341.0667; val_optim_loss: 25064341.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9573; val_auprc_score: 0.9472; val_best_acc_score: 0.9008; val_best_f1_score: 0.9045; train_kl_reg_loss: 102045.3427; train_edge_recon_loss: 2756374.9752; train_gene_expr_recon_loss: 20834795.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214614.4408; train_global_loss: 24907830.1069; train_optim_loss: 24907830.1069; val_kl_reg_loss: 101265.1260; val_edge_recon_loss: 2751151.3833; val_gene_expr_recon_loss: 21004365.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1205876.4500; val_global_loss: 25062657.6000; val_optim_loss: 25062657.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9625; val_auprc_score: 0.9547; val_best_acc_score: 0.9039; val_best_f1_score: 0.9071; train_kl_reg_loss: 99394.4293; train_edge_recon_loss: 2748204.1050; train_gene_expr_recon_loss: 20804951.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1213810.1059; train_global_loss: 24866359.6641; train_optim_loss: 24866359.6641; val_kl_reg_loss: 96399.2281; val_edge_recon_loss: 2743087.2000; val_gene_expr_recon_loss: 20963282.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1210193.5750; val_global_loss: 25012962.0000; val_optim_loss: 25012962.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9626; val_auprc_score: 0.9525; val_best_acc_score: 0.9084; val_best_f1_score: 0.9116; train_kl_reg_loss: 97856.5468; train_edge_recon_loss: 2742684.6240; train_gene_expr_recon_loss: 20750298.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212247.2338; train_global_loss: 24803086.9008; train_optim_loss: 24803086.9008; val_kl_reg_loss: 96006.3641; val_edge_recon_loss: 2748451.4333; val_gene_expr_recon_loss: 21002449.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1210523.9500; val_global_loss: 25057431.4667; val_optim_loss: 25057431.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9623; val_auprc_score: 0.9517; val_best_acc_score: 0.9077; val_best_f1_score: 0.9112; train_kl_reg_loss: 96033.9816; train_edge_recon_loss: 2729279.7882; train_gene_expr_recon_loss: 20716301.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1210528.8635; train_global_loss: 24752144.0153; train_optim_loss: 24752144.0153; val_kl_reg_loss: 96790.3880; val_edge_recon_loss: 2729627.3333; val_gene_expr_recon_loss: 20985962.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1211099.8500; val_global_loss: 25023480.1333; val_optim_loss: 25023480.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9624; val_auprc_score: 0.9559; val_best_acc_score: 0.9011; val_best_f1_score: 0.9056; train_kl_reg_loss: 95647.6588; train_edge_recon_loss: 2722621.6088; train_gene_expr_recon_loss: 20669555.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1209349.8082; train_global_loss: 24697174.6565; train_optim_loss: 24697174.6565; val_kl_reg_loss: 91049.2979; val_edge_recon_loss: 2763656.0667; val_gene_expr_recon_loss: 20796381.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1203642.9500; val_global_loss: 24854729.7333; val_optim_loss: 24854729.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9648; val_auprc_score: 0.9566; val_best_acc_score: 0.9113; val_best_f1_score: 0.9139; train_kl_reg_loss: 93158.5616; train_edge_recon_loss: 2717927.2519; train_gene_expr_recon_loss: 20600490.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1206828.5324; train_global_loss: 24618404.5038; train_optim_loss: 24618404.5038; val_kl_reg_loss: 90585.7026; val_edge_recon_loss: 2739828.9167; val_gene_expr_recon_loss: 20815208.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1207947.3417; val_global_loss: 24853570.4000; val_optim_loss: 24853570.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9641; val_auprc_score: 0.9552; val_best_acc_score: 0.9051; val_best_f1_score: 0.9090; train_kl_reg_loss: 91605.7896; train_edge_recon_loss: 2725967.3282; train_gene_expr_recon_loss: 20594441.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208026.1307; train_global_loss: 24620040.9313; train_optim_loss: 24620040.9313; val_kl_reg_loss: 88520.3906; val_edge_recon_loss: 2752037.9500; val_gene_expr_recon_loss: 20723321.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1201981.6250; val_global_loss: 24765861.2000; val_optim_loss: 24765861.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9718; val_auprc_score: 0.9667; val_best_acc_score: 0.9206; val_best_f1_score: 0.9227; train_kl_reg_loss: 90750.7600; train_edge_recon_loss: 2710448.6069; train_gene_expr_recon_loss: 20561572.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207433.9351; train_global_loss: 24570206.1069; train_optim_loss: 24570206.1069; val_kl_reg_loss: 87988.1417; val_edge_recon_loss: 2725696.5333; val_gene_expr_recon_loss: 20777776.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1203851.6250; val_global_loss: 24795313.4667; val_optim_loss: 24795313.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9733; val_auprc_score: 0.9668; val_best_acc_score: 0.9214; val_best_f1_score: 0.9243; train_kl_reg_loss: 88892.9054; train_edge_recon_loss: 2714353.8244; train_gene_expr_recon_loss: 20511579.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1206705.0496; train_global_loss: 24521531.7252; train_optim_loss: 24521531.7252; val_kl_reg_loss: 87886.9635; val_edge_recon_loss: 2705564.6500; val_gene_expr_recon_loss: 20732784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1207719.7333; val_global_loss: 24733955.4667; val_optim_loss: 24733955.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9711; val_auprc_score: 0.9622; val_best_acc_score: 0.9219; val_best_f1_score: 0.9248; train_kl_reg_loss: 91499.2943; train_edge_recon_loss: 2743781.7481; train_gene_expr_recon_loss: 21340288.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1239096.7347; train_global_loss: 25414665.7863; train_optim_loss: 25414665.7863; val_kl_reg_loss: 50029.0042; val_edge_recon_loss: 2724092.0333; val_gene_expr_recon_loss: 21461007.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1230958.6667; val_global_loss: 25466087.0667; val_optim_loss: 25466087.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9725; val_auprc_score: 0.9656; val_best_acc_score: 0.9227; val_best_f1_score: 0.9251; train_kl_reg_loss: 87980.5723; train_edge_recon_loss: 2720525.4847; train_gene_expr_recon_loss: 21234628.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1230750.0076; train_global_loss: 25273884.7481; train_optim_loss: 25273884.7481; val_kl_reg_loss: 51432.6995; val_edge_recon_loss: 2715970.0833; val_gene_expr_recon_loss: 21350065.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1223446.0417; val_global_loss: 25340913.6000; val_optim_loss: 25340913.6000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9714; val_auprc_score: 0.9647; val_best_acc_score: 0.9202; val_best_f1_score: 0.9218; train_kl_reg_loss: 83537.3000; train_edge_recon_loss: 2716133.1679; train_gene_expr_recon_loss: 21170551.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1225017.4447; train_global_loss: 25195238.9313; train_optim_loss: 25195238.9313; val_kl_reg_loss: 53985.9799; val_edge_recon_loss: 2722459.9167; val_gene_expr_recon_loss: 21330732.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218491.8167; val_global_loss: 25325670.6667; val_optim_loss: 25325670.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9715; val_auprc_score: 0.9637; val_best_acc_score: 0.9189; val_best_f1_score: 0.9222; train_kl_reg_loss: 77996.0911; train_edge_recon_loss: 2719676.1183; train_gene_expr_recon_loss: 21182923.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1223213.8950; train_global_loss: 25203809.5267; train_optim_loss: 25203809.5267; val_kl_reg_loss: 50874.1000; val_edge_recon_loss: 2730872.6333; val_gene_expr_recon_loss: 21353649.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217378.9750; val_global_loss: 25352776.0000; val_optim_loss: 25352776.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9723; val_auprc_score: 0.9658; val_best_acc_score: 0.9197; val_best_f1_score: 0.9223; train_kl_reg_loss: 80141.5307; train_edge_recon_loss: 2706654.1794; train_gene_expr_recon_loss: 21245793.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1224794.8187; train_global_loss: 25257384.4580; train_optim_loss: 25257384.4580; val_kl_reg_loss: 52268.9518; val_edge_recon_loss: 2713936.0333; val_gene_expr_recon_loss: 21454892.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218088.1667; val_global_loss: 25439185.4667; val_optim_loss: 25439185.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9738; val_auprc_score: 0.9655; val_best_acc_score: 0.9220; val_best_f1_score: 0.9240; train_kl_reg_loss: 80836.2445; train_edge_recon_loss: 2709606.7939; train_gene_expr_recon_loss: 21300440.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1226259.3798; train_global_loss: 25317143.2214; train_optim_loss: 25317143.2214; val_kl_reg_loss: 51403.8151; val_edge_recon_loss: 2718989.1000; val_gene_expr_recon_loss: 21516629.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1224456.6500; val_global_loss: 25511478.5333; val_optim_loss: 25511478.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9724; val_auprc_score: 0.9645; val_best_acc_score: 0.9181; val_best_f1_score: 0.9217; train_kl_reg_loss: 80702.0058; train_edge_recon_loss: 2700572.2939; train_gene_expr_recon_loss: 21310011.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227437.5802; train_global_loss: 25318723.7252; train_optim_loss: 25318723.7252; val_kl_reg_loss: 51387.1997; val_edge_recon_loss: 2704210.9000; val_gene_expr_recon_loss: 21371333.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1216551.0250; val_global_loss: 25343483.0667; val_optim_loss: 25343483.0667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9725; val_auprc_score: 0.9649; val_best_acc_score: 0.9241; val_best_f1_score: 0.9265; train_kl_reg_loss: 80511.9900; train_edge_recon_loss: 2706704.7290; train_gene_expr_recon_loss: 21309140.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1228944.6727; train_global_loss: 25325301.9695; train_optim_loss: 25325301.9695; val_kl_reg_loss: 50817.7643; val_edge_recon_loss: 2691863.3833; val_gene_expr_recon_loss: 21530276.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1227851.8417; val_global_loss: 25500809.3333; val_optim_loss: 25500809.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 47 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9747
val AUPRC score: 0.9691
val best accuracy score: 0.9245
val best F1 score: 0.9271
val target rna MSE score: 1.0549
val source rna MSE score: 22.2367
val target atac MSE score: 0.5797
val source atac MSE score: 6.2499
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
