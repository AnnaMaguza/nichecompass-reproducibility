[True]
Run timestamp: 07092023_172859_62.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_62']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.5927; val_auprc_score: 0.5901; val_best_acc_score: 0.5013; val_best_f1_score: 0.6670; train_kl_reg_loss: 59739.3785; train_edge_recon_loss: 3584728.5000; train_gene_expr_recon_loss: 28135839.0909; train_masked_gp_l1_reg_loss: 216539.1262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10552798.8636; train_chrom_access_recon_loss: 1275969.9545; train_global_loss: 43825614.6667; train_optim_loss: 43825614.6667; val_kl_reg_loss: 84360.7930; val_edge_recon_loss: 4065231.0312; val_gene_expr_recon_loss: 25276506.2500; val_masked_gp_l1_reg_loss: 202120.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4320222.5000; val_chrom_access_recon_loss: 1209807.2031; val_global_loss: 35158248.5000; val_optim_loss: 35158248.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6634; val_auprc_score: 0.6492; val_best_acc_score: 0.5395; val_best_f1_score: 0.6784; train_kl_reg_loss: 130959.7306; train_edge_recon_loss: 3564777.9205; train_gene_expr_recon_loss: 24979693.7273; train_masked_gp_l1_reg_loss: 186255.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1801259.7519; train_chrom_access_recon_loss: 1206303.1837; train_global_loss: 31869249.3636; train_optim_loss: 31869249.3636; val_kl_reg_loss: 131083.7832; val_edge_recon_loss: 4062816.5938; val_gene_expr_recon_loss: 24291863.7500; val_masked_gp_l1_reg_loss: 177027.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 663908.9375; val_chrom_access_recon_loss: 1176156.1562; val_global_loss: 30502856.2500; val_optim_loss: 30502856.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6705; val_auprc_score: 0.6476; val_best_acc_score: 0.5639; val_best_f1_score: 0.6870; train_kl_reg_loss: 132511.9371; train_edge_recon_loss: 3545659.9962; train_gene_expr_recon_loss: 24506383.7576; train_masked_gp_l1_reg_loss: 175075.9335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 467930.5114; train_chrom_access_recon_loss: 1190683.5777; train_global_loss: 30018245.6970; train_optim_loss: 30018245.6970; val_kl_reg_loss: 145688.9883; val_edge_recon_loss: 4061566.7500; val_gene_expr_recon_loss: 24045911.5000; val_masked_gp_l1_reg_loss: 178157.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 373168.6250; val_chrom_access_recon_loss: 1144574.5781; val_global_loss: 29949067.7500; val_optim_loss: 29949067.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.6847; val_auprc_score: 0.6663; val_best_acc_score: 0.6206; val_best_f1_score: 0.6871; train_kl_reg_loss: 124947.3640; train_edge_recon_loss: 3536277.8144; train_gene_expr_recon_loss: 24270779.8485; train_masked_gp_l1_reg_loss: 175901.0220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 308536.4735; train_chrom_access_recon_loss: 1182498.3731; train_global_loss: 29598941.0000; train_optim_loss: 29598941.0000; val_kl_reg_loss: 120961.7686; val_edge_recon_loss: 4055741.6562; val_gene_expr_recon_loss: 23858126.0000; val_masked_gp_l1_reg_loss: 174355.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 262734.2500; val_chrom_access_recon_loss: 1168919.4062; val_global_loss: 29640839.7500; val_optim_loss: 29640839.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7362; val_auprc_score: 0.7147; val_best_acc_score: 0.6564; val_best_f1_score: 0.7100; train_kl_reg_loss: 120004.7455; train_edge_recon_loss: 3529963.4242; train_gene_expr_recon_loss: 24103935.6061; train_masked_gp_l1_reg_loss: 174222.2678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240031.9680; train_chrom_access_recon_loss: 1175604.7064; train_global_loss: 29343762.6667; train_optim_loss: 29343762.6667; val_kl_reg_loss: 119383.4238; val_edge_recon_loss: 4028649.6562; val_gene_expr_recon_loss: 23860757.7500; val_masked_gp_l1_reg_loss: 174850.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 220649.2812; val_chrom_access_recon_loss: 1157364.0312; val_global_loss: 29561654.7500; val_optim_loss: 29561654.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7836; val_auprc_score: 0.7628; val_best_acc_score: 0.7184; val_best_f1_score: 0.7413; train_kl_reg_loss: 111519.4187; train_edge_recon_loss: 3515204.3712; train_gene_expr_recon_loss: 23967903.3939; train_masked_gp_l1_reg_loss: 176677.4508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207742.6655; train_chrom_access_recon_loss: 1170607.9129; train_global_loss: 29149655.1818; train_optim_loss: 29149655.1818; val_kl_reg_loss: 109991.7568; val_edge_recon_loss: 3876564.1562; val_gene_expr_recon_loss: 23615291.0000; val_masked_gp_l1_reg_loss: 179421.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196683.4688; val_chrom_access_recon_loss: 1147823.4688; val_global_loss: 29125776.2500; val_optim_loss: 29125776.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7551; val_auprc_score: 0.7212; val_best_acc_score: 0.6967; val_best_f1_score: 0.7368; train_kl_reg_loss: 101318.7382; train_edge_recon_loss: 3441871.4356; train_gene_expr_recon_loss: 23929564.7576; train_masked_gp_l1_reg_loss: 185758.0715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190423.1167; train_chrom_access_recon_loss: 1166324.5436; train_global_loss: 29015260.6364; train_optim_loss: 29015260.6364; val_kl_reg_loss: 108472.8789; val_edge_recon_loss: 3794768.2500; val_gene_expr_recon_loss: 23656607.7500; val_masked_gp_l1_reg_loss: 197428.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194940.7500; val_chrom_access_recon_loss: 1157065.1562; val_global_loss: 29109282.0000; val_optim_loss: 29109282.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8215; val_auprc_score: 0.8011; val_best_acc_score: 0.7469; val_best_f1_score: 0.7639; train_kl_reg_loss: 105049.3512; train_edge_recon_loss: 3385385.7424; train_gene_expr_recon_loss: 23797775.6667; train_masked_gp_l1_reg_loss: 196559.8570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184154.0907; train_chrom_access_recon_loss: 1165200.4943; train_global_loss: 28834125.5152; train_optim_loss: 28834125.5152; val_kl_reg_loss: 110153.5244; val_edge_recon_loss: 3351634.4688; val_gene_expr_recon_loss: 23576488.2500; val_masked_gp_l1_reg_loss: 197173.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176090.3750; val_chrom_access_recon_loss: 1142832.7344; val_global_loss: 28554372.5000; val_optim_loss: 28554372.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8325; val_auprc_score: 0.8053; val_best_acc_score: 0.7507; val_best_f1_score: 0.7773; train_kl_reg_loss: 113509.5247; train_edge_recon_loss: 3186052.1212; train_gene_expr_recon_loss: 23685622.4848; train_masked_gp_l1_reg_loss: 197246.4441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167888.1619; train_chrom_access_recon_loss: 1157394.7595; train_global_loss: 28507713.5152; train_optim_loss: 28507713.5152; val_kl_reg_loss: 116585.4287; val_edge_recon_loss: 3164235.9062; val_gene_expr_recon_loss: 23349365.7500; val_masked_gp_l1_reg_loss: 198852.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162958.7969; val_chrom_access_recon_loss: 1132192.5156; val_global_loss: 28124189.2500; val_optim_loss: 28124189.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8435; val_auprc_score: 0.8030; val_best_acc_score: 0.7751; val_best_f1_score: 0.7961; train_kl_reg_loss: 126943.3121; train_edge_recon_loss: 3065491.4053; train_gene_expr_recon_loss: 23591734.3636; train_masked_gp_l1_reg_loss: 200006.8454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160034.6641; train_chrom_access_recon_loss: 1152480.4962; train_global_loss: 28296691.2424; train_optim_loss: 28296691.2424; val_kl_reg_loss: 125422.9131; val_edge_recon_loss: 3065740.7812; val_gene_expr_recon_loss: 23258702.0000; val_masked_gp_l1_reg_loss: 201746.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158309.7812; val_chrom_access_recon_loss: 1131825.1094; val_global_loss: 27941747.0000; val_optim_loss: 27941747.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8704; val_auprc_score: 0.8323; val_best_acc_score: 0.7982; val_best_f1_score: 0.8158; train_kl_reg_loss: 136872.5202; train_edge_recon_loss: 3001385.5909; train_gene_expr_recon_loss: 23480750.1515; train_masked_gp_l1_reg_loss: 202688.1889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156108.0059; train_chrom_access_recon_loss: 1146746.0114; train_global_loss: 28124550.2727; train_optim_loss: 28124550.2727; val_kl_reg_loss: 135694.3301; val_edge_recon_loss: 2973647.1875; val_gene_expr_recon_loss: 23182252.2500; val_masked_gp_l1_reg_loss: 204356.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155427.2500; val_chrom_access_recon_loss: 1117438.5781; val_global_loss: 27768816.2500; val_optim_loss: 27768816.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8732; val_auprc_score: 0.8303; val_best_acc_score: 0.8031; val_best_f1_score: 0.8179; train_kl_reg_loss: 137312.8748; train_edge_recon_loss: 2948937.7652; train_gene_expr_recon_loss: 23393388.0000; train_masked_gp_l1_reg_loss: 205648.3866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155409.5571; train_chrom_access_recon_loss: 1141733.4110; train_global_loss: 27982429.9697; train_optim_loss: 27982429.9697; val_kl_reg_loss: 143384.0918; val_edge_recon_loss: 2961963.8125; val_gene_expr_recon_loss: 23272642.2500; val_masked_gp_l1_reg_loss: 207754.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155684.1562; val_chrom_access_recon_loss: 1121684.8906; val_global_loss: 27863112.7500; val_optim_loss: 27863112.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8872; val_auprc_score: 0.8495; val_best_acc_score: 0.8246; val_best_f1_score: 0.8315; train_kl_reg_loss: 141843.0462; train_edge_recon_loss: 2907623.0644; train_gene_expr_recon_loss: 23309003.5152; train_masked_gp_l1_reg_loss: 208344.9020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155281.7036; train_chrom_access_recon_loss: 1138448.6799; train_global_loss: 27860545.0606; train_optim_loss: 27860545.0606; val_kl_reg_loss: 144851.0254; val_edge_recon_loss: 2944508.3750; val_gene_expr_recon_loss: 23277730.7500; val_masked_gp_l1_reg_loss: 209620.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155581.5625; val_chrom_access_recon_loss: 1126702.9844; val_global_loss: 27858994.7500; val_optim_loss: 27858994.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8836; val_auprc_score: 0.8459; val_best_acc_score: 0.8197; val_best_f1_score: 0.8309; train_kl_reg_loss: 141954.3023; train_edge_recon_loss: 2891636.6553; train_gene_expr_recon_loss: 23253768.5758; train_masked_gp_l1_reg_loss: 209778.7209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155798.4827; train_chrom_access_recon_loss: 1134980.5511; train_global_loss: 27787917.3636; train_optim_loss: 27787917.3636; val_kl_reg_loss: 142600.6875; val_edge_recon_loss: 2962689.0312; val_gene_expr_recon_loss: 22861330.0000; val_masked_gp_l1_reg_loss: 210736.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155895.2656; val_chrom_access_recon_loss: 1111151.2500; val_global_loss: 27444403.2500; val_optim_loss: 27444403.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8971; val_auprc_score: 0.8624; val_best_acc_score: 0.8280; val_best_f1_score: 0.8379; train_kl_reg_loss: 144570.1278; train_edge_recon_loss: 2866110.1477; train_gene_expr_recon_loss: 23158376.4242; train_masked_gp_l1_reg_loss: 211426.0043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155304.7940; train_chrom_access_recon_loss: 1130779.6155; train_global_loss: 27666567.3030; train_optim_loss: 27666567.3030; val_kl_reg_loss: 138879.8867; val_edge_recon_loss: 2917969.5312; val_gene_expr_recon_loss: 22686956.0000; val_masked_gp_l1_reg_loss: 212310.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155154.8125; val_chrom_access_recon_loss: 1114234.9062; val_global_loss: 27225504.7500; val_optim_loss: 27225504.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9021; val_auprc_score: 0.8614; val_best_acc_score: 0.8428; val_best_f1_score: 0.8545; train_kl_reg_loss: 143377.7637; train_edge_recon_loss: 2865108.3826; train_gene_expr_recon_loss: 23090493.5758; train_masked_gp_l1_reg_loss: 213457.9583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154716.6425; train_chrom_access_recon_loss: 1128526.0682; train_global_loss: 27595680.0606; train_optim_loss: 27595680.0606; val_kl_reg_loss: 143644.0625; val_edge_recon_loss: 2874045.1875; val_gene_expr_recon_loss: 22855025.2500; val_masked_gp_l1_reg_loss: 214460.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154104.6875; val_chrom_access_recon_loss: 1111915.7344; val_global_loss: 27353194.5000; val_optim_loss: 27353194.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9123; val_auprc_score: 0.8833; val_best_acc_score: 0.8560; val_best_f1_score: 0.8626; train_kl_reg_loss: 142329.3809; train_edge_recon_loss: 2843503.8977; train_gene_expr_recon_loss: 23000999.2121; train_masked_gp_l1_reg_loss: 215114.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153846.3151; train_chrom_access_recon_loss: 1123390.7169; train_global_loss: 27479184.0606; train_optim_loss: 27479184.0606; val_kl_reg_loss: 137952.5156; val_edge_recon_loss: 2843556.0312; val_gene_expr_recon_loss: 22758455.0000; val_masked_gp_l1_reg_loss: 216053.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152718.9062; val_chrom_access_recon_loss: 1101480.1875; val_global_loss: 27210215.7500; val_optim_loss: 27210215.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9098; val_auprc_score: 0.8751; val_best_acc_score: 0.8487; val_best_f1_score: 0.8576; train_kl_reg_loss: 144241.5308; train_edge_recon_loss: 2844217.4318; train_gene_expr_recon_loss: 22944485.6364; train_masked_gp_l1_reg_loss: 216627.0088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152284.3438; train_chrom_access_recon_loss: 1120374.7254; train_global_loss: 27422230.8182; train_optim_loss: 27422230.8182; val_kl_reg_loss: 142186.8965; val_edge_recon_loss: 2889059.8750; val_gene_expr_recon_loss: 22739686.5000; val_masked_gp_l1_reg_loss: 217005.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151512.1094; val_chrom_access_recon_loss: 1097190.0469; val_global_loss: 27236641.2500; val_optim_loss: 27236641.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9180; val_auprc_score: 0.8863; val_best_acc_score: 0.8581; val_best_f1_score: 0.8672; train_kl_reg_loss: 142729.2945; train_edge_recon_loss: 2835798.0265; train_gene_expr_recon_loss: 22887822.8485; train_masked_gp_l1_reg_loss: 217447.7746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151153.0092; train_chrom_access_recon_loss: 1117755.2216; train_global_loss: 27352706.1515; train_optim_loss: 27352706.1515; val_kl_reg_loss: 144396.3691; val_edge_recon_loss: 2850429.1250; val_gene_expr_recon_loss: 22559310.5000; val_masked_gp_l1_reg_loss: 218062.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150033.2656; val_chrom_access_recon_loss: 1090594.8750; val_global_loss: 27012827.2500; val_optim_loss: 27012827.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9295; val_auprc_score: 0.9051; val_best_acc_score: 0.8721; val_best_f1_score: 0.8788; train_kl_reg_loss: 142658.6077; train_edge_recon_loss: 2826476.9697; train_gene_expr_recon_loss: 22841529.6364; train_masked_gp_l1_reg_loss: 218276.7268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149977.3729; train_chrom_access_recon_loss: 1115080.7727; train_global_loss: 27294000.1212; train_optim_loss: 27294000.1212; val_kl_reg_loss: 139872.9902; val_edge_recon_loss: 2834799.7812; val_gene_expr_recon_loss: 22622389.7500; val_masked_gp_l1_reg_loss: 219300.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150354.3750; val_chrom_access_recon_loss: 1104132.2344; val_global_loss: 27070849.0000; val_optim_loss: 27070849.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9242; val_auprc_score: 0.8946; val_best_acc_score: 0.8697; val_best_f1_score: 0.8758; train_kl_reg_loss: 141520.5192; train_edge_recon_loss: 2821016.8523; train_gene_expr_recon_loss: 22781624.9394; train_masked_gp_l1_reg_loss: 219291.0161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149873.1636; train_chrom_access_recon_loss: 1112631.7159; train_global_loss: 27225958.1515; train_optim_loss: 27225958.1515; val_kl_reg_loss: 146721.6934; val_edge_recon_loss: 2847539.5938; val_gene_expr_recon_loss: 22656019.2500; val_masked_gp_l1_reg_loss: 219724.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149071.0156; val_chrom_access_recon_loss: 1094311.4375; val_global_loss: 27113387.7500; val_optim_loss: 27113387.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9252; val_auprc_score: 0.8958; val_best_acc_score: 0.8665; val_best_f1_score: 0.8750; train_kl_reg_loss: 142717.2611; train_edge_recon_loss: 2816494.4811; train_gene_expr_recon_loss: 22733458.7576; train_masked_gp_l1_reg_loss: 219875.6899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149155.1319; train_chrom_access_recon_loss: 1110375.1089; train_global_loss: 27172076.2121; train_optim_loss: 27172076.2121; val_kl_reg_loss: 142504.3809; val_edge_recon_loss: 2861870.2188; val_gene_expr_recon_loss: 22380389.5000; val_masked_gp_l1_reg_loss: 220222.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148982.0156; val_chrom_access_recon_loss: 1089607.0156; val_global_loss: 26843575.0000; val_optim_loss: 26843575.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9234; val_auprc_score: 0.8960; val_best_acc_score: 0.8675; val_best_f1_score: 0.8755; train_kl_reg_loss: 142719.8194; train_edge_recon_loss: 2810764.8598; train_gene_expr_recon_loss: 22690810.6061; train_masked_gp_l1_reg_loss: 220392.0592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148608.8222; train_chrom_access_recon_loss: 1107930.0492; train_global_loss: 27121226.2727; train_optim_loss: 27121226.2727; val_kl_reg_loss: 143184.0527; val_edge_recon_loss: 2815410.6562; val_gene_expr_recon_loss: 22497603.7500; val_masked_gp_l1_reg_loss: 220800.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147912.2656; val_chrom_access_recon_loss: 1085178.8438; val_global_loss: 26910089.5000; val_optim_loss: 26910089.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9345; val_auprc_score: 0.9126; val_best_acc_score: 0.8745; val_best_f1_score: 0.8799; train_kl_reg_loss: 142953.4695; train_edge_recon_loss: 2805366.5682; train_gene_expr_recon_loss: 22647895.8182; train_masked_gp_l1_reg_loss: 220516.0095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147819.4517; train_chrom_access_recon_loss: 1105941.5663; train_global_loss: 27070492.9697; train_optim_loss: 27070492.9697; val_kl_reg_loss: 141073.8613; val_edge_recon_loss: 2811982.3438; val_gene_expr_recon_loss: 22480953.2500; val_masked_gp_l1_reg_loss: 220980.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149604.0625; val_chrom_access_recon_loss: 1078916.4375; val_global_loss: 26883509.7500; val_optim_loss: 26883509.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9311; val_auprc_score: 0.9006; val_best_acc_score: 0.8767; val_best_f1_score: 0.8833; train_kl_reg_loss: 141653.9354; train_edge_recon_loss: 2803263.3939; train_gene_expr_recon_loss: 22603592.0909; train_masked_gp_l1_reg_loss: 220951.4285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148644.3348; train_chrom_access_recon_loss: 1102889.9830; train_global_loss: 27020995.0000; train_optim_loss: 27020995.0000; val_kl_reg_loss: 141271.8809; val_edge_recon_loss: 2822754.0000; val_gene_expr_recon_loss: 22243831.2500; val_masked_gp_l1_reg_loss: 220935.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148376.0781; val_chrom_access_recon_loss: 1078142.7656; val_global_loss: 26655311.7500; val_optim_loss: 26655311.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9275; val_auprc_score: 0.8985; val_best_acc_score: 0.8686; val_best_f1_score: 0.8758; train_kl_reg_loss: 151461.6657; train_edge_recon_loss: 2861894.7424; train_gene_expr_recon_loss: 22160976.6667; train_masked_gp_l1_reg_loss: 218060.8037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137298.8627; train_chrom_access_recon_loss: 1098225.9972; train_global_loss: 26627918.6061; train_optim_loss: 26627918.6061; val_kl_reg_loss: 98676.0547; val_edge_recon_loss: 2852203.2500; val_gene_expr_recon_loss: 21891375.7500; val_masked_gp_l1_reg_loss: 217738.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135824.9531; val_chrom_access_recon_loss: 1062497.9062; val_global_loss: 26258315.2500; val_optim_loss: 26258315.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9405; val_auprc_score: 0.9229; val_best_acc_score: 0.8823; val_best_f1_score: 0.8879; train_kl_reg_loss: 153754.9581; train_edge_recon_loss: 2823109.8826; train_gene_expr_recon_loss: 22033030.4242; train_masked_gp_l1_reg_loss: 218143.0111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136064.0500; train_chrom_access_recon_loss: 1076408.6903; train_global_loss: 26440510.8182; train_optim_loss: 26440510.8182; val_kl_reg_loss: 106366.0312; val_edge_recon_loss: 2839681.4688; val_gene_expr_recon_loss: 21767545.0000; val_masked_gp_l1_reg_loss: 218474.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136299.7031; val_chrom_access_recon_loss: 1051831.0547; val_global_loss: 26120197.2500; val_optim_loss: 26120197.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9334; val_auprc_score: 0.9096; val_best_acc_score: 0.8716; val_best_f1_score: 0.8798; train_kl_reg_loss: 150010.0450; train_edge_recon_loss: 2814522.8977; train_gene_expr_recon_loss: 21981611.0303; train_masked_gp_l1_reg_loss: 218279.7509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136126.3402; train_chrom_access_recon_loss: 1073231.9905; train_global_loss: 26373782.1818; train_optim_loss: 26373782.1818; val_kl_reg_loss: 107707.4551; val_edge_recon_loss: 2826036.7812; val_gene_expr_recon_loss: 21551772.7500; val_masked_gp_l1_reg_loss: 218484.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136645.4688; val_chrom_access_recon_loss: 1055411.5391; val_global_loss: 25896059.0000; val_optim_loss: 25896059.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9281; val_auprc_score: 0.9014; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 144324.1051; train_edge_recon_loss: 2809165.0038; train_gene_expr_recon_loss: 21909368.9697; train_masked_gp_l1_reg_loss: 218020.0907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136476.9974; train_chrom_access_recon_loss: 1069144.6515; train_global_loss: 26286499.6667; train_optim_loss: 26286499.6667; val_kl_reg_loss: 110020.5605; val_edge_recon_loss: 2857226.0312; val_gene_expr_recon_loss: 21543853.5000; val_masked_gp_l1_reg_loss: 217861.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136213.5625; val_chrom_access_recon_loss: 1045642.9141; val_global_loss: 25910819.2500; val_optim_loss: 25910819.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9347; val_auprc_score: 0.9143; val_best_acc_score: 0.8745; val_best_f1_score: 0.8819; train_kl_reg_loss: 141102.8819; train_edge_recon_loss: 2790510.5000; train_gene_expr_recon_loss: 21849191.3939; train_masked_gp_l1_reg_loss: 217468.3920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136301.9922; train_chrom_access_recon_loss: 1068335.3210; train_global_loss: 26202910.3333; train_optim_loss: 26202910.3333; val_kl_reg_loss: 113366.0342; val_edge_recon_loss: 2812416.6250; val_gene_expr_recon_loss: 21493859.7500; val_masked_gp_l1_reg_loss: 217316.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135875.5000; val_chrom_access_recon_loss: 1048563.8125; val_global_loss: 25821397.5000; val_optim_loss: 25821397.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9341; val_auprc_score: 0.9068; val_best_acc_score: 0.8772; val_best_f1_score: 0.8829; train_kl_reg_loss: 139218.7488; train_edge_recon_loss: 2782943.3182; train_gene_expr_recon_loss: 21773897.9091; train_masked_gp_l1_reg_loss: 216720.5663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135926.6768; train_chrom_access_recon_loss: 1066294.8153; train_global_loss: 26115001.9697; train_optim_loss: 26115001.9697; val_kl_reg_loss: 113423.7178; val_edge_recon_loss: 2829037.8438; val_gene_expr_recon_loss: 21656989.7500; val_masked_gp_l1_reg_loss: 216668.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136296.7500; val_chrom_access_recon_loss: 1057242.6250; val_global_loss: 26009658.0000; val_optim_loss: 26009658.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9442; val_auprc_score: 0.9297; val_best_acc_score: 0.8872; val_best_f1_score: 0.8917; train_kl_reg_loss: 135568.1049; train_edge_recon_loss: 2781275.7121; train_gene_expr_recon_loss: 21699082.7273; train_masked_gp_l1_reg_loss: 215847.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136052.6224; train_chrom_access_recon_loss: 1060331.5407; train_global_loss: 26028157.7576; train_optim_loss: 26028157.7576; val_kl_reg_loss: 112364.2842; val_edge_recon_loss: 2778914.6875; val_gene_expr_recon_loss: 21544041.0000; val_masked_gp_l1_reg_loss: 215311.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135765.0000; val_chrom_access_recon_loss: 1039050.0547; val_global_loss: 25825446.2500; val_optim_loss: 25825446.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9374; val_auprc_score: 0.9127; val_best_acc_score: 0.8810; val_best_f1_score: 0.8859; train_kl_reg_loss: 135634.4222; train_edge_recon_loss: 2791637.9773; train_gene_expr_recon_loss: 21650617.9394; train_masked_gp_l1_reg_loss: 214645.4735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135092.6496; train_chrom_access_recon_loss: 1056669.2320; train_global_loss: 25984297.6667; train_optim_loss: 25984297.6667; val_kl_reg_loss: 114921.6719; val_edge_recon_loss: 2817832.7188; val_gene_expr_recon_loss: 21404669.0000; val_masked_gp_l1_reg_loss: 213937.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134834.0000; val_chrom_access_recon_loss: 1037168.3984; val_global_loss: 25723363.7500; val_optim_loss: 25723363.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9422; val_auprc_score: 0.9257; val_best_acc_score: 0.8786; val_best_f1_score: 0.8851; train_kl_reg_loss: 133496.2957; train_edge_recon_loss: 2787851.4470; train_gene_expr_recon_loss: 21583253.4545; train_masked_gp_l1_reg_loss: 213300.9924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134770.8009; train_chrom_access_recon_loss: 1053536.4564; train_global_loss: 25906209.4242; train_optim_loss: 25906209.4242; val_kl_reg_loss: 114078.0107; val_edge_recon_loss: 2824949.5000; val_gene_expr_recon_loss: 21301234.0000; val_masked_gp_l1_reg_loss: 212679.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134287.1406; val_chrom_access_recon_loss: 1035894.0312; val_global_loss: 25623123.5000; val_optim_loss: 25623123.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9436; val_auprc_score: 0.9232; val_best_acc_score: 0.8810; val_best_f1_score: 0.8883; train_kl_reg_loss: 132497.0625; train_edge_recon_loss: 2768090.9091; train_gene_expr_recon_loss: 21554527.6364; train_masked_gp_l1_reg_loss: 212028.4489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134248.4884; train_chrom_access_recon_loss: 1051806.7727; train_global_loss: 25853199.2727; train_optim_loss: 25853199.2727; val_kl_reg_loss: 117930.7197; val_edge_recon_loss: 2810742.6875; val_gene_expr_recon_loss: 21452929.2500; val_masked_gp_l1_reg_loss: 211524.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134559.5938; val_chrom_access_recon_loss: 1038741.9766; val_global_loss: 25766429.0000; val_optim_loss: 25766429.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9422; val_auprc_score: 0.9154; val_best_acc_score: 0.8839; val_best_f1_score: 0.8905; train_kl_reg_loss: 131676.1558; train_edge_recon_loss: 2772947.1136; train_gene_expr_recon_loss: 21505500.9394; train_masked_gp_l1_reg_loss: 210903.6520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133971.2573; train_chrom_access_recon_loss: 1049537.6023; train_global_loss: 25804536.7879; train_optim_loss: 25804536.7879; val_kl_reg_loss: 113949.2500; val_edge_recon_loss: 2800516.7188; val_gene_expr_recon_loss: 21023892.0000; val_masked_gp_l1_reg_loss: 210377.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133817.9844; val_chrom_access_recon_loss: 1017205.3281; val_global_loss: 25299759.2500; val_optim_loss: 25299759.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9452; val_auprc_score: 0.9268; val_best_acc_score: 0.8847; val_best_f1_score: 0.8898; train_kl_reg_loss: 131342.0772; train_edge_recon_loss: 2770048.7386; train_gene_expr_recon_loss: 21489242.0000; train_masked_gp_l1_reg_loss: 209749.6735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133486.2353; train_chrom_access_recon_loss: 1049368.8949; train_global_loss: 25783237.7576; train_optim_loss: 25783237.7576; val_kl_reg_loss: 117838.7676; val_edge_recon_loss: 2787620.4688; val_gene_expr_recon_loss: 21182361.7500; val_masked_gp_l1_reg_loss: 209387.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134056.7656; val_chrom_access_recon_loss: 1024458.8359; val_global_loss: 25455724.0000; val_optim_loss: 25455724.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9459; val_auprc_score: 0.9308; val_best_acc_score: 0.8850; val_best_f1_score: 0.8887; train_kl_reg_loss: 131096.3063; train_edge_recon_loss: 2761879.4583; train_gene_expr_recon_loss: 21443784.9091; train_masked_gp_l1_reg_loss: 208821.5791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133227.2997; train_chrom_access_recon_loss: 1046535.7244; train_global_loss: 25725345.3030; train_optim_loss: 25725345.3030; val_kl_reg_loss: 118418.6621; val_edge_recon_loss: 2801234.7500; val_gene_expr_recon_loss: 20971576.5000; val_masked_gp_l1_reg_loss: 208392.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132913.7344; val_chrom_access_recon_loss: 1015642.8516; val_global_loss: 25248178.5000; val_optim_loss: 25248178.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9504; val_auprc_score: 0.9359; val_best_acc_score: 0.8909; val_best_f1_score: 0.8966; train_kl_reg_loss: 130320.7095; train_edge_recon_loss: 2764866.2159; train_gene_expr_recon_loss: 21426783.8182; train_masked_gp_l1_reg_loss: 207844.9406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132671.6006; train_chrom_access_recon_loss: 1045168.8153; train_global_loss: 25707656.0909; train_optim_loss: 25707656.0909; val_kl_reg_loss: 118717.1230; val_edge_recon_loss: 2772475.9688; val_gene_expr_recon_loss: 20965571.7500; val_masked_gp_l1_reg_loss: 207597.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132961.3750; val_chrom_access_recon_loss: 1020360.5234; val_global_loss: 25217685.5000; val_optim_loss: 25217685.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9438; val_auprc_score: 0.9236; val_best_acc_score: 0.8858; val_best_f1_score: 0.8910; train_kl_reg_loss: 128473.1965; train_edge_recon_loss: 2756696.7311; train_gene_expr_recon_loss: 21389985.9394; train_masked_gp_l1_reg_loss: 207295.1989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132483.6406; train_chrom_access_recon_loss: 1043586.6960; train_global_loss: 25658521.4848; train_optim_loss: 25658521.4848; val_kl_reg_loss: 117585.1621; val_edge_recon_loss: 2813797.5938; val_gene_expr_recon_loss: 21303632.5000; val_masked_gp_l1_reg_loss: 206903.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132107.8281; val_chrom_access_recon_loss: 1030593.2578; val_global_loss: 25604621.0000; val_optim_loss: 25604621.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9503; val_auprc_score: 0.9312; val_best_acc_score: 0.8880; val_best_f1_score: 0.8948; train_kl_reg_loss: 129324.4497; train_edge_recon_loss: 2759664.5644; train_gene_expr_recon_loss: 21366547.0303; train_masked_gp_l1_reg_loss: 206408.3554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131906.7327; train_chrom_access_recon_loss: 1042845.0312; train_global_loss: 25636696.0606; train_optim_loss: 25636696.0606; val_kl_reg_loss: 119190.7568; val_edge_recon_loss: 2788932.4062; val_gene_expr_recon_loss: 20955495.0000; val_masked_gp_l1_reg_loss: 206244.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131601.8594; val_chrom_access_recon_loss: 1018410.4688; val_global_loss: 25219874.5000; val_optim_loss: 25219874.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9474; val_auprc_score: 0.9296; val_best_acc_score: 0.8904; val_best_f1_score: 0.8956; train_kl_reg_loss: 128979.4190; train_edge_recon_loss: 2762483.1705; train_gene_expr_recon_loss: 21342393.8485; train_masked_gp_l1_reg_loss: 205708.9941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131465.1354; train_chrom_access_recon_loss: 1041840.6544; train_global_loss: 25612871.3939; train_optim_loss: 25612871.3939; val_kl_reg_loss: 121241.1680; val_edge_recon_loss: 2791246.8438; val_gene_expr_recon_loss: 21147683.7500; val_masked_gp_l1_reg_loss: 205536.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131318.3125; val_chrom_access_recon_loss: 1017710.6094; val_global_loss: 25414736.0000; val_optim_loss: 25414736.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9394; val_auprc_score: 0.9117; val_best_acc_score: 0.8837; val_best_f1_score: 0.8903; train_kl_reg_loss: 129212.2971; train_edge_recon_loss: 2760255.0909; train_gene_expr_recon_loss: 21298130.3939; train_masked_gp_l1_reg_loss: 204949.9545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131119.8045; train_chrom_access_recon_loss: 1039737.8116; train_global_loss: 25563405.3333; train_optim_loss: 25563405.3333; val_kl_reg_loss: 118092.8506; val_edge_recon_loss: 2810382.0938; val_gene_expr_recon_loss: 21364836.5000; val_masked_gp_l1_reg_loss: 204526.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131266.5312; val_chrom_access_recon_loss: 1028621.5000; val_global_loss: 25657724.5000; val_optim_loss: 25657724.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9435; val_auprc_score: 0.9244; val_best_acc_score: 0.8842; val_best_f1_score: 0.8908; train_kl_reg_loss: 127411.8696; train_edge_recon_loss: 2748233.5947; train_gene_expr_recon_loss: 21265420.0000; train_masked_gp_l1_reg_loss: 201752.5523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99726.5253; train_chrom_access_recon_loss: 1038113.1080; train_global_loss: 25480657.6970; train_optim_loss: 25480657.6970; val_kl_reg_loss: 121157.9258; val_edge_recon_loss: 2809258.8125; val_gene_expr_recon_loss: 20974573.0000; val_masked_gp_l1_reg_loss: 200605.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93541.3359; val_chrom_access_recon_loss: 1020879.1016; val_global_loss: 25220016.7500; val_optim_loss: 25220016.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9447; val_auprc_score: 0.9196; val_best_acc_score: 0.8896; val_best_f1_score: 0.8953; train_kl_reg_loss: 129082.6907; train_edge_recon_loss: 2768763.7576; train_gene_expr_recon_loss: 21235972.6667; train_masked_gp_l1_reg_loss: 200261.7116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93028.8263; train_chrom_access_recon_loss: 1035869.4697; train_global_loss: 25462978.9394; train_optim_loss: 25462978.9394; val_kl_reg_loss: 121764.3320; val_edge_recon_loss: 2801444.8750; val_gene_expr_recon_loss: 21109689.5000; val_masked_gp_l1_reg_loss: 200043.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92571.3750; val_chrom_access_recon_loss: 1010300.3359; val_global_loss: 25335814.7500; val_optim_loss: 25335814.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9467; val_auprc_score: 0.9199; val_best_acc_score: 0.8992; val_best_f1_score: 0.9029; train_kl_reg_loss: 129917.8723; train_edge_recon_loss: 2760564.8182; train_gene_expr_recon_loss: 21236919.8485; train_masked_gp_l1_reg_loss: 199894.4115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92367.5244; train_chrom_access_recon_loss: 1036477.3570; train_global_loss: 25456141.7879; train_optim_loss: 25456141.7879; val_kl_reg_loss: 121273.9062; val_edge_recon_loss: 2762719.1875; val_gene_expr_recon_loss: 21026579.7500; val_masked_gp_l1_reg_loss: 199727.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92058.4844; val_chrom_access_recon_loss: 1021984.0625; val_global_loss: 25224343.0000; val_optim_loss: 25224343.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9487; val_auprc_score: 0.9255; val_best_acc_score: 0.8947; val_best_f1_score: 0.8990; train_kl_reg_loss: 130079.9361; train_edge_recon_loss: 2754160.2083; train_gene_expr_recon_loss: 21259848.2727; train_masked_gp_l1_reg_loss: 199645.6913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91936.7588; train_chrom_access_recon_loss: 1037863.4820; train_global_loss: 25473534.5152; train_optim_loss: 25473534.5152; val_kl_reg_loss: 122447.7666; val_edge_recon_loss: 2797653.4062; val_gene_expr_recon_loss: 21099667.7500; val_masked_gp_l1_reg_loss: 199555.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91833.5078; val_chrom_access_recon_loss: 1022820.5234; val_global_loss: 25333979.5000; val_optim_loss: 25333979.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 44 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9494
val AUPRC score: 0.9304
val best accuracy score: 0.8909
val best F1 score: 0.8961
val target rna MSE score: 0.9589
val source rna MSE score: 0.3364
val target atac MSE score: 0.4682
val source atac MSE score: 0.1055
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
