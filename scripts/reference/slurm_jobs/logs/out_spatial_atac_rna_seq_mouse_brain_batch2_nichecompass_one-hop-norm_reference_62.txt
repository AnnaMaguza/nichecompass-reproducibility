[True]
Run timestamp: 07082023_191021_62.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_62']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8959; val_auprc_score: 0.9033; val_best_acc_score: 0.5128; val_best_f1_score: 0.6724; train_kl_reg_loss: 23839.2328; train_edge_recon_loss: 349617.7639; train_gene_expr_recon_loss: 1321382.8472; train_masked_gp_l1_reg_loss: 16382.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119558.6293; train_chrom_access_recon_loss: 2765993.4306; train_global_loss: 4596774.5000; train_optim_loss: 4596774.5000; val_kl_reg_loss: 5332.3682; val_edge_recon_loss: 406477.9062; val_gene_expr_recon_loss: 1125213.2500; val_masked_gp_l1_reg_loss: 12023.9053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117378.0469; val_chrom_access_recon_loss: 1554620.7500; val_global_loss: 3221046.0000; val_optim_loss: 3221046.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9077; val_auprc_score: 0.9154; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 5894.4189; train_edge_recon_loss: 351143.3403; train_gene_expr_recon_loss: 1073276.5278; train_masked_gp_l1_reg_loss: 10452.4956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115999.2839; train_chrom_access_recon_loss: 1513062.1528; train_global_loss: 3069828.1944; train_optim_loss: 3069828.1944; val_kl_reg_loss: 6877.7041; val_edge_recon_loss: 406557.5938; val_gene_expr_recon_loss: 985878.8125; val_masked_gp_l1_reg_loss: 9456.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114329.1484; val_chrom_access_recon_loss: 1451723.0000; val_global_loss: 2974822.5000; val_optim_loss: 2974822.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9153; val_auprc_score: 0.9200; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 9353.9572; train_edge_recon_loss: 354106.8160; train_gene_expr_recon_loss: 950996.3542; train_masked_gp_l1_reg_loss: 9796.3735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113046.1727; train_chrom_access_recon_loss: 1443962.4722; train_global_loss: 2881262.1944; train_optim_loss: 2881262.1944; val_kl_reg_loss: 12162.9512; val_edge_recon_loss: 406583.6250; val_gene_expr_recon_loss: 884053.6875; val_masked_gp_l1_reg_loss: 10119.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111462.7031; val_chrom_access_recon_loss: 1411898.6250; val_global_loss: 2836281.0000; val_optim_loss: 2836281.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9017; val_auprc_score: 0.9088; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 15301.8579; train_edge_recon_loss: 357822.7847; train_gene_expr_recon_loss: 851891.1111; train_masked_gp_l1_reg_loss: 10127.1151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110199.7205; train_chrom_access_recon_loss: 1405706.0139; train_global_loss: 2751048.6667; train_optim_loss: 2751048.6667; val_kl_reg_loss: 17368.7031; val_edge_recon_loss: 406581.5000; val_gene_expr_recon_loss: 804166.1250; val_masked_gp_l1_reg_loss: 10136.2979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108591.4844; val_chrom_access_recon_loss: 1376128.8750; val_global_loss: 2722973.0000; val_optim_loss: 2722973.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8820; val_auprc_score: 0.8910; val_best_acc_score: 0.5085; val_best_f1_score: 0.6705; train_kl_reg_loss: 18913.1081; train_edge_recon_loss: 359713.6111; train_gene_expr_recon_loss: 791020.8958; train_masked_gp_l1_reg_loss: 10122.6525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107209.4488; train_chrom_access_recon_loss: 1367936.8750; train_global_loss: 2654916.5278; train_optim_loss: 2654916.5278; val_kl_reg_loss: 19801.1719; val_edge_recon_loss: 406551.0312; val_gene_expr_recon_loss: 758117.7500; val_masked_gp_l1_reg_loss: 10071.6699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105400.2656; val_chrom_access_recon_loss: 1350484.6250; val_global_loss: 2650426.5000; val_optim_loss: 2650426.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8659; val_auprc_score: 0.8744; val_best_acc_score: 0.5164; val_best_f1_score: 0.6737; train_kl_reg_loss: 20533.0506; train_edge_recon_loss: 360214.3715; train_gene_expr_recon_loss: 756092.2639; train_masked_gp_l1_reg_loss: 10033.7447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103822.7023; train_chrom_access_recon_loss: 1347588.3889; train_global_loss: 2598284.5278; train_optim_loss: 2598284.5278; val_kl_reg_loss: 21136.5781; val_edge_recon_loss: 406487.0938; val_gene_expr_recon_loss: 731848.8125; val_masked_gp_l1_reg_loss: 9965.2061; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101781.2656; val_chrom_access_recon_loss: 1335659.3750; val_global_loss: 2606878.5000; val_optim_loss: 2606878.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8506; val_auprc_score: 0.8552; val_best_acc_score: 0.5259; val_best_f1_score: 0.6761; train_kl_reg_loss: 21565.7635; train_edge_recon_loss: 360314.7951; train_gene_expr_recon_loss: 731682.7569; train_masked_gp_l1_reg_loss: 9917.5092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100063.8811; train_chrom_access_recon_loss: 1346085.7083; train_global_loss: 2569630.4722; train_optim_loss: 2569630.4722; val_kl_reg_loss: 21023.5820; val_edge_recon_loss: 406289.1875; val_gene_expr_recon_loss: 714390.2500; val_masked_gp_l1_reg_loss: 9836.6426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97878.2969; val_chrom_access_recon_loss: 1327454.6250; val_global_loss: 2576872.5000; val_optim_loss: 2576872.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8470; val_auprc_score: 0.8456; val_best_acc_score: 0.5596; val_best_f1_score: 0.6906; train_kl_reg_loss: 22254.1732; train_edge_recon_loss: 360155.0104; train_gene_expr_recon_loss: 718542.4792; train_masked_gp_l1_reg_loss: 9780.3014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96090.7274; train_chrom_access_recon_loss: 1334975.8056; train_global_loss: 2541798.4722; train_optim_loss: 2541798.4722; val_kl_reg_loss: 20930.9023; val_edge_recon_loss: 405872.5625; val_gene_expr_recon_loss: 700131.6250; val_masked_gp_l1_reg_loss: 9698.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93839.1797; val_chrom_access_recon_loss: 1320596.5000; val_global_loss: 2551069.0000; val_optim_loss: 2551069.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8338; val_auprc_score: 0.8230; val_best_acc_score: 0.6299; val_best_f1_score: 0.7243; train_kl_reg_loss: 22912.9486; train_edge_recon_loss: 360381.5486; train_gene_expr_recon_loss: 700987.8681; train_masked_gp_l1_reg_loss: 9642.1312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92026.0347; train_chrom_access_recon_loss: 1327905.4722; train_global_loss: 2513855.9444; train_optim_loss: 2513855.9444; val_kl_reg_loss: 22145.2090; val_edge_recon_loss: 405241.7500; val_gene_expr_recon_loss: 688950.4375; val_masked_gp_l1_reg_loss: 9567.3154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89755.6406; val_chrom_access_recon_loss: 1315556.7500; val_global_loss: 2531217.0000; val_optim_loss: 2531217.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8191; val_auprc_score: 0.8096; val_best_acc_score: 0.6944; val_best_f1_score: 0.7545; train_kl_reg_loss: 23598.4223; train_edge_recon_loss: 359896.3368; train_gene_expr_recon_loss: 695721.0833; train_masked_gp_l1_reg_loss: 9520.2758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87943.0521; train_chrom_access_recon_loss: 1328010.7361; train_global_loss: 2504689.9444; train_optim_loss: 2504689.9444; val_kl_reg_loss: 21214.1836; val_edge_recon_loss: 404016.5312; val_gene_expr_recon_loss: 681261.8750; val_masked_gp_l1_reg_loss: 9464.1035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85688.1250; val_chrom_access_recon_loss: 1310986.8750; val_global_loss: 2512631.7500; val_optim_loss: 2512631.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8036; val_auprc_score: 0.7941; val_best_acc_score: 0.7122; val_best_f1_score: 0.7541; train_kl_reg_loss: 23509.7923; train_edge_recon_loss: 359697.3611; train_gene_expr_recon_loss: 682769.3958; train_masked_gp_l1_reg_loss: 9440.6007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83914.0182; train_chrom_access_recon_loss: 1319464.3472; train_global_loss: 2478795.4722; train_optim_loss: 2478795.4722; val_kl_reg_loss: 22677.8594; val_edge_recon_loss: 402621.3438; val_gene_expr_recon_loss: 674032.0000; val_masked_gp_l1_reg_loss: 9399.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81712.7188; val_chrom_access_recon_loss: 1307621.6250; val_global_loss: 2498065.0000; val_optim_loss: 2498065.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8001; val_auprc_score: 0.7924; val_best_acc_score: 0.7181; val_best_f1_score: 0.7375; train_kl_reg_loss: 23619.0291; train_edge_recon_loss: 358759.5347; train_gene_expr_recon_loss: 676874.2847; train_masked_gp_l1_reg_loss: 9380.0109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79991.8290; train_chrom_access_recon_loss: 1313719.0278; train_global_loss: 2462343.6667; train_optim_loss: 2462343.6667; val_kl_reg_loss: 21995.4961; val_edge_recon_loss: 400286.6875; val_gene_expr_recon_loss: 669660.1250; val_masked_gp_l1_reg_loss: 9336.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77860.2266; val_chrom_access_recon_loss: 1304399.2500; val_global_loss: 2483538.7500; val_optim_loss: 2483538.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7897; val_auprc_score: 0.7724; val_best_acc_score: 0.7068; val_best_f1_score: 0.7414; train_kl_reg_loss: 23238.0354; train_edge_recon_loss: 357940.7118; train_gene_expr_recon_loss: 674165.9097; train_masked_gp_l1_reg_loss: 9325.3095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76198.6562; train_chrom_access_recon_loss: 1307546.0278; train_global_loss: 2448414.6667; train_optim_loss: 2448414.6667; val_kl_reg_loss: 22358.1465; val_edge_recon_loss: 397562.5938; val_gene_expr_recon_loss: 665462.6250; val_masked_gp_l1_reg_loss: 9300.6924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74141.9922; val_chrom_access_recon_loss: 1301320.6250; val_global_loss: 2470146.7500; val_optim_loss: 2470146.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7929; val_auprc_score: 0.7789; val_best_acc_score: 0.6948; val_best_f1_score: 0.7503; train_kl_reg_loss: 23134.5966; train_edge_recon_loss: 356730.3333; train_gene_expr_recon_loss: 670383.9861; train_masked_gp_l1_reg_loss: 9298.2947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72543.1354; train_chrom_access_recon_loss: 1309217.5417; train_global_loss: 2441307.8611; train_optim_loss: 2441307.8611; val_kl_reg_loss: 22566.0312; val_edge_recon_loss: 394687.0938; val_gene_expr_recon_loss: 662394.3750; val_masked_gp_l1_reg_loss: 9278.2959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70572.9453; val_chrom_access_recon_loss: 1298759.7500; val_global_loss: 2458258.5000; val_optim_loss: 2458258.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7961; val_auprc_score: 0.7784; val_best_acc_score: 0.7250; val_best_f1_score: 0.7586; train_kl_reg_loss: 22650.5894; train_edge_recon_loss: 355250.9583; train_gene_expr_recon_loss: 671013.0625; train_masked_gp_l1_reg_loss: 9270.3447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69049.0747; train_chrom_access_recon_loss: 1306893.7361; train_global_loss: 2434127.7222; train_optim_loss: 2434127.7222; val_kl_reg_loss: 21834.2559; val_edge_recon_loss: 389930.6562; val_gene_expr_recon_loss: 659796.0625; val_masked_gp_l1_reg_loss: 9261.4209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67177.6719; val_chrom_access_recon_loss: 1296249.0000; val_global_loss: 2444249.0000; val_optim_loss: 2444249.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8093; val_auprc_score: 0.7944; val_best_acc_score: 0.7321; val_best_f1_score: 0.7600; train_kl_reg_loss: 22239.6391; train_edge_recon_loss: 353339.7812; train_gene_expr_recon_loss: 665549.0972; train_masked_gp_l1_reg_loss: 9272.1420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65735.7886; train_chrom_access_recon_loss: 1304080.0556; train_global_loss: 2420216.4444; train_optim_loss: 2420216.4444; val_kl_reg_loss: 21339.9961; val_edge_recon_loss: 382201.4062; val_gene_expr_recon_loss: 657862.3750; val_masked_gp_l1_reg_loss: 9269.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63962.5859; val_chrom_access_recon_loss: 1294086.1250; val_global_loss: 2428722.0000; val_optim_loss: 2428722.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8111; val_auprc_score: 0.7997; val_best_acc_score: 0.7289; val_best_f1_score: 0.7624; train_kl_reg_loss: 21862.2630; train_edge_recon_loss: 350083.2396; train_gene_expr_recon_loss: 663874.8611; train_masked_gp_l1_reg_loss: 9274.9538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62600.0998; train_chrom_access_recon_loss: 1297485.5278; train_global_loss: 2405181.0000; train_optim_loss: 2405181.0000; val_kl_reg_loss: 20499.0625; val_edge_recon_loss: 372584.6875; val_gene_expr_recon_loss: 657136.6250; val_masked_gp_l1_reg_loss: 9279.5439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60926.5820; val_chrom_access_recon_loss: 1291943.1250; val_global_loss: 2412369.5000; val_optim_loss: 2412369.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8286; val_auprc_score: 0.8163; val_best_acc_score: 0.7444; val_best_f1_score: 0.7686; train_kl_reg_loss: 21976.5341; train_edge_recon_loss: 344853.4132; train_gene_expr_recon_loss: 663049.2222; train_masked_gp_l1_reg_loss: 9305.7547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59649.7582; train_chrom_access_recon_loss: 1298873.1944; train_global_loss: 2397707.8333; train_optim_loss: 2397707.8333; val_kl_reg_loss: 21213.8984; val_edge_recon_loss: 357356.4688; val_gene_expr_recon_loss: 655865.6250; val_masked_gp_l1_reg_loss: 9323.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58085.4375; val_chrom_access_recon_loss: 1290252.2500; val_global_loss: 2392097.5000; val_optim_loss: 2392097.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8390; val_auprc_score: 0.8264; val_best_acc_score: 0.7491; val_best_f1_score: 0.7743; train_kl_reg_loss: 23359.2220; train_edge_recon_loss: 337806.7951; train_gene_expr_recon_loss: 660699.4375; train_masked_gp_l1_reg_loss: 9348.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56890.3828; train_chrom_access_recon_loss: 1295743.0417; train_global_loss: 2383846.9444; train_optim_loss: 2383846.9444; val_kl_reg_loss: 23754.6133; val_edge_recon_loss: 342098.5938; val_gene_expr_recon_loss: 654734.5625; val_masked_gp_l1_reg_loss: 9372.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55422.4609; val_chrom_access_recon_loss: 1288763.0000; val_global_loss: 2374145.5000; val_optim_loss: 2374145.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8488; val_auprc_score: 0.8363; val_best_acc_score: 0.7584; val_best_f1_score: 0.7822; train_kl_reg_loss: 26366.0909; train_edge_recon_loss: 329243.9236; train_gene_expr_recon_loss: 662511.3889; train_masked_gp_l1_reg_loss: 9400.1540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54300.9844; train_chrom_access_recon_loss: 1299829.5556; train_global_loss: 2381652.1111; train_optim_loss: 2381652.1111; val_kl_reg_loss: 27405.5078; val_edge_recon_loss: 329896.7500; val_gene_expr_recon_loss: 653827.3750; val_masked_gp_l1_reg_loss: 9423.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52924.8359; val_chrom_access_recon_loss: 1286601.3750; val_global_loss: 2360079.5000; val_optim_loss: 2360079.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8505; val_auprc_score: 0.8394; val_best_acc_score: 0.7614; val_best_f1_score: 0.7850; train_kl_reg_loss: 29696.8238; train_edge_recon_loss: 321919.7951; train_gene_expr_recon_loss: 658992.3611; train_masked_gp_l1_reg_loss: 9449.3838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51880.7422; train_chrom_access_recon_loss: 1296896.6389; train_global_loss: 2368835.7500; train_optim_loss: 2368835.7500; val_kl_reg_loss: 29985.3984; val_edge_recon_loss: 324595.5625; val_gene_expr_recon_loss: 652318.2500; val_masked_gp_l1_reg_loss: 9473.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50598.3789; val_chrom_access_recon_loss: 1284249.8750; val_global_loss: 2351221.2500; val_optim_loss: 2351221.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8593; val_auprc_score: 0.8434; val_best_acc_score: 0.7656; val_best_f1_score: 0.7928; train_kl_reg_loss: 30471.3615; train_edge_recon_loss: 316993.0069; train_gene_expr_recon_loss: 660325.4653; train_masked_gp_l1_reg_loss: 9510.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49624.7496; train_chrom_access_recon_loss: 1292458.7222; train_global_loss: 2359383.5278; train_optim_loss: 2359383.5278; val_kl_reg_loss: 29227.6934; val_edge_recon_loss: 319967.9062; val_gene_expr_recon_loss: 651652.9375; val_masked_gp_l1_reg_loss: 9540.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48426.4141; val_chrom_access_recon_loss: 1282678.7500; val_global_loss: 2341494.0000; val_optim_loss: 2341494.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8764; val_auprc_score: 0.8614; val_best_acc_score: 0.7829; val_best_f1_score: 0.8074; train_kl_reg_loss: 29478.0681; train_edge_recon_loss: 314486.5764; train_gene_expr_recon_loss: 655424.3750; train_masked_gp_l1_reg_loss: 9570.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47517.1016; train_chrom_access_recon_loss: 1289850.1806; train_global_loss: 2346326.7778; train_optim_loss: 2346326.7778; val_kl_reg_loss: 29044.7617; val_edge_recon_loss: 314303.5000; val_gene_expr_recon_loss: 650514.0000; val_masked_gp_l1_reg_loss: 9597.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46392.3477; val_chrom_access_recon_loss: 1280642.8750; val_global_loss: 2330495.0000; val_optim_loss: 2330495.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8904; val_auprc_score: 0.8737; val_best_acc_score: 0.8013; val_best_f1_score: 0.8126; train_kl_reg_loss: 28942.3201; train_edge_recon_loss: 310866.5972; train_gene_expr_recon_loss: 657331.9514; train_masked_gp_l1_reg_loss: 9619.3107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45532.3090; train_chrom_access_recon_loss: 1286438.0417; train_global_loss: 2338730.5556; train_optim_loss: 2338730.5556; val_kl_reg_loss: 28037.0508; val_edge_recon_loss: 313738.0000; val_gene_expr_recon_loss: 648598.2500; val_masked_gp_l1_reg_loss: 9644.5518; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44478.9297; val_chrom_access_recon_loss: 1278725.6250; val_global_loss: 2323222.5000; val_optim_loss: 2323222.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9035; val_auprc_score: 0.8875; val_best_acc_score: 0.8215; val_best_f1_score: 0.8295; train_kl_reg_loss: 28771.0547; train_edge_recon_loss: 308026.4028; train_gene_expr_recon_loss: 656670.9931; train_masked_gp_l1_reg_loss: 9673.3773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43676.9701; train_chrom_access_recon_loss: 1283537.7917; train_global_loss: 2330356.5556; train_optim_loss: 2330356.5556; val_kl_reg_loss: 28125.2266; val_edge_recon_loss: 308454.9062; val_gene_expr_recon_loss: 647691.7500; val_masked_gp_l1_reg_loss: 9703.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42688.7305; val_chrom_access_recon_loss: 1276507.6250; val_global_loss: 2313171.7500; val_optim_loss: 2313171.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9109; val_auprc_score: 0.8965; val_best_acc_score: 0.8293; val_best_f1_score: 0.8364; train_kl_reg_loss: 27034.7669; train_edge_recon_loss: 311649.1667; train_gene_expr_recon_loss: 961292.8056; train_masked_gp_l1_reg_loss: 9856.8430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41803.1176; train_chrom_access_recon_loss: 1357439.0139; train_global_loss: 2709075.6944; train_optim_loss: 2709075.6944; val_kl_reg_loss: 18062.1875; val_edge_recon_loss: 310221.7188; val_gene_expr_recon_loss: 945492.3750; val_masked_gp_l1_reg_loss: 10126.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40631.1328; val_chrom_access_recon_loss: 1344090.5000; val_global_loss: 2668624.2500; val_optim_loss: 2668624.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9125; val_auprc_score: 0.8958; val_best_acc_score: 0.8297; val_best_f1_score: 0.8386; train_kl_reg_loss: 26343.2563; train_edge_recon_loss: 306374.1701; train_gene_expr_recon_loss: 952094.9861; train_masked_gp_l1_reg_loss: 10371.3821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39664.8746; train_chrom_access_recon_loss: 1352705.1944; train_global_loss: 2687553.8611; train_optim_loss: 2687553.8611; val_kl_reg_loss: 19878.9023; val_edge_recon_loss: 304388.5938; val_gene_expr_recon_loss: 941342.0000; val_masked_gp_l1_reg_loss: 10658.2236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38470.4375; val_chrom_access_recon_loss: 1342611.8750; val_global_loss: 2657350.0000; val_optim_loss: 2657350.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9200; val_auprc_score: 0.9038; val_best_acc_score: 0.8425; val_best_f1_score: 0.8502; train_kl_reg_loss: 25154.2148; train_edge_recon_loss: 302739.3750; train_gene_expr_recon_loss: 951324.9167; train_masked_gp_l1_reg_loss: 10862.5725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37550.4826; train_chrom_access_recon_loss: 1351641.5972; train_global_loss: 2679273.1111; train_optim_loss: 2679273.1111; val_kl_reg_loss: 20543.3848; val_edge_recon_loss: 299583.5625; val_gene_expr_recon_loss: 936829.8125; val_masked_gp_l1_reg_loss: 11096.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36426.2852; val_chrom_access_recon_loss: 1340762.7500; val_global_loss: 2645242.0000; val_optim_loss: 2645242.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9220; val_auprc_score: 0.9056; val_best_acc_score: 0.8452; val_best_f1_score: 0.8519; train_kl_reg_loss: 24623.4870; train_edge_recon_loss: 299317.5104; train_gene_expr_recon_loss: 943832.4028; train_masked_gp_l1_reg_loss: 11265.6479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35570.1189; train_chrom_access_recon_loss: 1347566.5000; train_global_loss: 2662175.6667; train_optim_loss: 2662175.6667; val_kl_reg_loss: 21782.0957; val_edge_recon_loss: 299006.6562; val_gene_expr_recon_loss: 932853.8750; val_masked_gp_l1_reg_loss: 11460.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34528.6094; val_chrom_access_recon_loss: 1338830.6250; val_global_loss: 2638462.5000; val_optim_loss: 2638462.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9173; val_auprc_score: 0.9000; val_best_acc_score: 0.8407; val_best_f1_score: 0.8514; train_kl_reg_loss: 24723.8019; train_edge_recon_loss: 298000.5938; train_gene_expr_recon_loss: 940394.8681; train_masked_gp_l1_reg_loss: 11400.5333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34412.8451; train_chrom_access_recon_loss: 1343404.9583; train_global_loss: 2652337.6111; train_optim_loss: 2652337.6111; val_kl_reg_loss: 21992.5078; val_edge_recon_loss: 300236.0000; val_gene_expr_recon_loss: 932189.5000; val_masked_gp_l1_reg_loss: 11348.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34271.4414; val_chrom_access_recon_loss: 1338273.3750; val_global_loss: 2638311.5000; val_optim_loss: 2638311.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9207; val_auprc_score: 0.9021; val_best_acc_score: 0.8448; val_best_f1_score: 0.8548; train_kl_reg_loss: 24767.0519; train_edge_recon_loss: 297408.4306; train_gene_expr_recon_loss: 942989.0694; train_masked_gp_l1_reg_loss: 11341.5276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34171.4132; train_chrom_access_recon_loss: 1348788.9167; train_global_loss: 2659466.4444; train_optim_loss: 2659466.4444; val_kl_reg_loss: 21840.5898; val_edge_recon_loss: 300397.2812; val_gene_expr_recon_loss: 932130.9375; val_masked_gp_l1_reg_loss: 11327.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34046.1133; val_chrom_access_recon_loss: 1338712.6250; val_global_loss: 2638455.0000; val_optim_loss: 2638455.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9231; val_auprc_score: 0.9041; val_best_acc_score: 0.8488; val_best_f1_score: 0.8571; train_kl_reg_loss: 24482.1009; train_edge_recon_loss: 298392.7535; train_gene_expr_recon_loss: 941127.9931; train_masked_gp_l1_reg_loss: 11324.5988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33951.2622; train_chrom_access_recon_loss: 1344837.6944; train_global_loss: 2654116.3889; train_optim_loss: 2654116.3889; val_kl_reg_loss: 21823.0879; val_edge_recon_loss: 298536.3438; val_gene_expr_recon_loss: 931785.3750; val_masked_gp_l1_reg_loss: 11322.6572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33834.3438; val_chrom_access_recon_loss: 1338364.1250; val_global_loss: 2635666.0000; val_optim_loss: 2635666.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9249; val_auprc_score: 0.9072; val_best_acc_score: 0.8506; val_best_f1_score: 0.8593; train_kl_reg_loss: 24515.3125; train_edge_recon_loss: 298799.0243; train_gene_expr_recon_loss: 944019.8750; train_masked_gp_l1_reg_loss: 11325.3536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33743.4501; train_chrom_access_recon_loss: 1353697.9444; train_global_loss: 2666100.9722; train_optim_loss: 2666100.9722; val_kl_reg_loss: 21694.6914; val_edge_recon_loss: 297987.4688; val_gene_expr_recon_loss: 931288.4375; val_masked_gp_l1_reg_loss: 11330.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33633.1250; val_chrom_access_recon_loss: 1338173.5000; val_global_loss: 2634107.5000; val_optim_loss: 2634107.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 26 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9013
val AUPRC score: 0.8838
val best accuracy score: 0.8138
val best F1 score: 0.8249
val target rna MSE score: 3.7761
val source rna MSE score: 3.1357
val target atac MSE score: 0.1324
val source atac MSE score: 0.0190
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
