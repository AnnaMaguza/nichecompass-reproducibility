[True]
Run timestamp: 07092023_014839_234.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_234']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3385 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7888, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6235; val_auprc_score: 0.6202; val_best_acc_score: 0.5086; val_best_f1_score: 0.6694; train_kl_reg_loss: 70624.9760; train_edge_recon_loss: 3587867.7538; train_gene_expr_recon_loss: 16582225.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1471281.9830; train_chrom_access_recon_loss: 14891385.4091; train_global_loss: 36603385.6061; train_optim_loss: 36603385.6061; val_kl_reg_loss: 123943.2100; val_edge_recon_loss: 4064980.7500; val_gene_expr_recon_loss: 15060619.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1120102.3750; val_chrom_access_recon_loss: 14197729.5000; val_global_loss: 34567373.5000; val_optim_loss: 34567373.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6659; val_auprc_score: 0.6451; val_best_acc_score: 0.5193; val_best_f1_score: 0.6722; train_kl_reg_loss: 123427.1958; train_edge_recon_loss: 3544659.3144; train_gene_expr_recon_loss: 14801168.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 820319.8532; train_chrom_access_recon_loss: 14151978.0606; train_global_loss: 33441552.7576; train_optim_loss: 33441552.7576; val_kl_reg_loss: 116567.9814; val_edge_recon_loss: 4063491.6562; val_gene_expr_recon_loss: 14777092.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 569109.8750; val_chrom_access_recon_loss: 14175750.3750; val_global_loss: 33702012.2500; val_optim_loss: 33702012.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7331; val_auprc_score: 0.7216; val_best_acc_score: 0.6647; val_best_f1_score: 0.7021; train_kl_reg_loss: 116376.7267; train_edge_recon_loss: 3528973.3598; train_gene_expr_recon_loss: 14581113.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 426329.0715; train_chrom_access_recon_loss: 14018215.3333; train_global_loss: 32671007.4848; train_optim_loss: 32671007.4848; val_kl_reg_loss: 108929.1562; val_edge_recon_loss: 4038146.7500; val_gene_expr_recon_loss: 14493250.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 314979.7812; val_chrom_access_recon_loss: 13984337.2500; val_global_loss: 32939643.5000; val_optim_loss: 32939643.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7980; val_auprc_score: 0.7708; val_best_acc_score: 0.7217; val_best_f1_score: 0.7476; train_kl_reg_loss: 101144.8601; train_edge_recon_loss: 3512156.8030; train_gene_expr_recon_loss: 14461655.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 252293.3220; train_chrom_access_recon_loss: 13930286.1061; train_global_loss: 32257536.7879; train_optim_loss: 32257536.7879; val_kl_reg_loss: 84739.6621; val_edge_recon_loss: 3875078.5312; val_gene_expr_recon_loss: 14205922.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202286.2031; val_chrom_access_recon_loss: 13746604.5000; val_global_loss: 32114631.5000; val_optim_loss: 32114631.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8129; val_auprc_score: 0.7800; val_best_acc_score: 0.7383; val_best_f1_score: 0.7832; train_kl_reg_loss: 82408.7049; train_edge_recon_loss: 3342376.7311; train_gene_expr_recon_loss: 14374383.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172071.7467; train_chrom_access_recon_loss: 13844396.0303; train_global_loss: 31815636.7273; train_optim_loss: 31815636.7273; val_kl_reg_loss: 88643.5020; val_edge_recon_loss: 3161615.3438; val_gene_expr_recon_loss: 14416728.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146690.4062; val_chrom_access_recon_loss: 13841931.5000; val_global_loss: 31655609.2500; val_optim_loss: 31655609.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8319; val_auprc_score: 0.7853; val_best_acc_score: 0.7520; val_best_f1_score: 0.7949; train_kl_reg_loss: 112839.8598; train_edge_recon_loss: 3013819.2348; train_gene_expr_recon_loss: 14294828.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128650.9276; train_chrom_access_recon_loss: 13763955.5000; train_global_loss: 31314093.7273; train_optim_loss: 31314093.7273; val_kl_reg_loss: 114653.7217; val_edge_recon_loss: 2962641.3438; val_gene_expr_recon_loss: 14253714.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113094.5078; val_chrom_access_recon_loss: 13761196.3750; val_global_loss: 31205300.0000; val_optim_loss: 31205300.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8583; val_auprc_score: 0.8305; val_best_acc_score: 0.7743; val_best_f1_score: 0.7986; train_kl_reg_loss: 116867.7446; train_edge_recon_loss: 2962859.5909; train_gene_expr_recon_loss: 14209518.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101827.0265; train_chrom_access_recon_loss: 13685110.9242; train_global_loss: 31076183.5152; train_optim_loss: 31076183.5152; val_kl_reg_loss: 115039.1338; val_edge_recon_loss: 2943051.3125; val_gene_expr_recon_loss: 14172613.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92061.9375; val_chrom_access_recon_loss: 13671070.2500; val_global_loss: 30993836.7500; val_optim_loss: 30993836.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8523; val_auprc_score: 0.8053; val_best_acc_score: 0.7813; val_best_f1_score: 0.8064; train_kl_reg_loss: 113429.2842; train_edge_recon_loss: 2941168.1250; train_gene_expr_recon_loss: 14125922.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84363.3481; train_chrom_access_recon_loss: 13624877.5455; train_global_loss: 30889761.1212; train_optim_loss: 30889761.1212; val_kl_reg_loss: 105372.0195; val_edge_recon_loss: 2976999.5000; val_gene_expr_recon_loss: 14119781.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77813.6641; val_chrom_access_recon_loss: 13772175.5000; val_global_loss: 31052142.2500; val_optim_loss: 31052142.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8791; val_auprc_score: 0.8443; val_best_acc_score: 0.8068; val_best_f1_score: 0.8224; train_kl_reg_loss: 104491.6220; train_edge_recon_loss: 2915166.2500; train_gene_expr_recon_loss: 14077225.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72563.2428; train_chrom_access_recon_loss: 13574588.1970; train_global_loss: 30744035.1818; train_optim_loss: 30744035.1818; val_kl_reg_loss: 103712.1572; val_edge_recon_loss: 2929848.0625; val_gene_expr_recon_loss: 13961177.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67782.9688; val_chrom_access_recon_loss: 13428665.7500; val_global_loss: 30491185.2500; val_optim_loss: 30491185.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8951; val_auprc_score: 0.8603; val_best_acc_score: 0.8305; val_best_f1_score: 0.8432; train_kl_reg_loss: 103649.0309; train_edge_recon_loss: 2850634.8258; train_gene_expr_recon_loss: 14012711.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64256.4315; train_chrom_access_recon_loss: 13507828.2879; train_global_loss: 30539080.1818; train_optim_loss: 30539080.1818; val_kl_reg_loss: 101957.4316; val_edge_recon_loss: 2853296.2500; val_gene_expr_recon_loss: 13713202.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61250.3672; val_chrom_access_recon_loss: 13366750.0000; val_global_loss: 30096455.7500; val_optim_loss: 30096455.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8977; val_auprc_score: 0.8575; val_best_acc_score: 0.8372; val_best_f1_score: 0.8476; train_kl_reg_loss: 105664.9761; train_edge_recon_loss: 2837130.2273; train_gene_expr_recon_loss: 13963192.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58871.7173; train_chrom_access_recon_loss: 13453912.4091; train_global_loss: 30418772.1212; train_optim_loss: 30418772.1212; val_kl_reg_loss: 102696.8945; val_edge_recon_loss: 2836967.0938; val_gene_expr_recon_loss: 13989132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56673.3281; val_chrom_access_recon_loss: 13473308.1250; val_global_loss: 30458777.2500; val_optim_loss: 30458777.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9151; val_auprc_score: 0.8855; val_best_acc_score: 0.8509; val_best_f1_score: 0.8615; train_kl_reg_loss: 104821.8184; train_edge_recon_loss: 2809998.5947; train_gene_expr_recon_loss: 13904521.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54886.8346; train_chrom_access_recon_loss: 13403893.3485; train_global_loss: 30278122.2424; train_optim_loss: 30278122.2424; val_kl_reg_loss: 101762.3438; val_edge_recon_loss: 2801663.9688; val_gene_expr_recon_loss: 13770294.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53396.1016; val_chrom_access_recon_loss: 13191715.6250; val_global_loss: 29918832.7500; val_optim_loss: 29918832.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9167; val_auprc_score: 0.8850; val_best_acc_score: 0.8525; val_best_f1_score: 0.8577; train_kl_reg_loss: 101170.4092; train_edge_recon_loss: 2810177.5417; train_gene_expr_recon_loss: 13867672.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52027.0723; train_chrom_access_recon_loss: 13370374.8788; train_global_loss: 30201422.2121; train_optim_loss: 30201422.2121; val_kl_reg_loss: 99466.2803; val_edge_recon_loss: 2825210.4375; val_gene_expr_recon_loss: 13823948.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50812.9648; val_chrom_access_recon_loss: 13334647.8750; val_global_loss: 30134086.0000; val_optim_loss: 30134086.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9144; val_auprc_score: 0.8827; val_best_acc_score: 0.8530; val_best_f1_score: 0.8637; train_kl_reg_loss: 98028.3735; train_edge_recon_loss: 2795067.4545; train_gene_expr_recon_loss: 13817866.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49791.5933; train_chrom_access_recon_loss: 13306660.3788; train_global_loss: 30067414.2121; train_optim_loss: 30067414.2121; val_kl_reg_loss: 99953.7188; val_edge_recon_loss: 2838565.6562; val_gene_expr_recon_loss: 13669846.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48962.2812; val_chrom_access_recon_loss: 13189618.1250; val_global_loss: 29846946.0000; val_optim_loss: 29846946.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9188; val_auprc_score: 0.8882; val_best_acc_score: 0.8622; val_best_f1_score: 0.8721; train_kl_reg_loss: 97646.1027; train_edge_recon_loss: 2778877.8371; train_gene_expr_recon_loss: 13773230.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48249.5216; train_chrom_access_recon_loss: 13255891.3485; train_global_loss: 29953895.1818; train_optim_loss: 29953895.1818; val_kl_reg_loss: 97374.9551; val_edge_recon_loss: 2795941.2500; val_gene_expr_recon_loss: 13717965.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47253.5156; val_chrom_access_recon_loss: 13266813.7500; val_global_loss: 29925349.7500; val_optim_loss: 29925349.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9256; val_auprc_score: 0.9014; val_best_acc_score: 0.8686; val_best_f1_score: 0.8770; train_kl_reg_loss: 96080.4792; train_edge_recon_loss: 2775967.0455; train_gene_expr_recon_loss: 13742886.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46523.3015; train_chrom_access_recon_loss: 13230497.4091; train_global_loss: 29891954.3030; train_optim_loss: 29891954.3030; val_kl_reg_loss: 95832.4102; val_edge_recon_loss: 2779723.8438; val_gene_expr_recon_loss: 13640064.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46264.2930; val_chrom_access_recon_loss: 13194994.0000; val_global_loss: 29756878.7500; val_optim_loss: 29756878.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9218; val_auprc_score: 0.8869; val_best_acc_score: 0.8681; val_best_f1_score: 0.8773; train_kl_reg_loss: 95341.7338; train_edge_recon_loss: 2764457.7386; train_gene_expr_recon_loss: 13688725.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45456.7280; train_chrom_access_recon_loss: 13174991.4545; train_global_loss: 29768972.7576; train_optim_loss: 29768972.7576; val_kl_reg_loss: 93494.5869; val_edge_recon_loss: 2777664.4062; val_gene_expr_recon_loss: 13683830.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45167.2852; val_chrom_access_recon_loss: 13179459.0000; val_global_loss: 29779615.7500; val_optim_loss: 29779615.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9235; val_auprc_score: 0.8902; val_best_acc_score: 0.8651; val_best_f1_score: 0.8729; train_kl_reg_loss: 91907.2706; train_edge_recon_loss: 2765430.1856; train_gene_expr_recon_loss: 13668822.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44568.4863; train_chrom_access_recon_loss: 13145967.1364; train_global_loss: 29716695.3636; train_optim_loss: 29716695.3636; val_kl_reg_loss: 92104.4307; val_edge_recon_loss: 2807190.4375; val_gene_expr_recon_loss: 13518133.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44362.5469; val_chrom_access_recon_loss: 13086705.8750; val_global_loss: 29548496.5000; val_optim_loss: 29548496.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9264; val_auprc_score: 0.8881; val_best_acc_score: 0.8743; val_best_f1_score: 0.8799; train_kl_reg_loss: 91101.2421; train_edge_recon_loss: 2757908.6515; train_gene_expr_recon_loss: 13628180.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43821.6949; train_chrom_access_recon_loss: 13104142.6970; train_global_loss: 29625155.0606; train_optim_loss: 29625155.0606; val_kl_reg_loss: 90819.6963; val_edge_recon_loss: 2763436.2500; val_gene_expr_recon_loss: 13556600.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43545.8594; val_chrom_access_recon_loss: 13124311.1250; val_global_loss: 29578713.5000; val_optim_loss: 29578713.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9323; val_auprc_score: 0.9047; val_best_acc_score: 0.8726; val_best_f1_score: 0.8801; train_kl_reg_loss: 91545.9375; train_edge_recon_loss: 2745699.9545; train_gene_expr_recon_loss: 13614420.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42980.1819; train_chrom_access_recon_loss: 13090128.4091; train_global_loss: 29584774.7273; train_optim_loss: 29584774.7273; val_kl_reg_loss: 89555.3672; val_edge_recon_loss: 2799328.6250; val_gene_expr_recon_loss: 13296880.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42829.9180; val_chrom_access_recon_loss: 12853828.2500; val_global_loss: 29082423.0000; val_optim_loss: 29082423.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9368; val_auprc_score: 0.9176; val_best_acc_score: 0.8794; val_best_f1_score: 0.8858; train_kl_reg_loss: 89386.4744; train_edge_recon_loss: 2741516.3106; train_gene_expr_recon_loss: 13574053.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42489.8610; train_chrom_access_recon_loss: 13045223.1364; train_global_loss: 29492669.0909; train_optim_loss: 29492669.0909; val_kl_reg_loss: 89033.1406; val_edge_recon_loss: 2788173.9062; val_gene_expr_recon_loss: 13610557.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42348.8398; val_chrom_access_recon_loss: 13075882.5000; val_global_loss: 29605995.5000; val_optim_loss: 29605995.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9322; val_auprc_score: 0.9045; val_best_acc_score: 0.8775; val_best_f1_score: 0.8845; train_kl_reg_loss: 88067.0674; train_edge_recon_loss: 2739243.5720; train_gene_expr_recon_loss: 13543600.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41867.3852; train_chrom_access_recon_loss: 13012978.2273; train_global_loss: 29425756.6364; train_optim_loss: 29425756.6364; val_kl_reg_loss: 86471.6865; val_edge_recon_loss: 2785707.8750; val_gene_expr_recon_loss: 13485573.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41642.4062; val_chrom_access_recon_loss: 12971908.8750; val_global_loss: 29371305.0000; val_optim_loss: 29371305.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9346; val_auprc_score: 0.9100; val_best_acc_score: 0.8780; val_best_f1_score: 0.8864; train_kl_reg_loss: 86318.8285; train_edge_recon_loss: 2736170.9356; train_gene_expr_recon_loss: 13518072.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41255.7440; train_chrom_access_recon_loss: 12977042.0303; train_global_loss: 29358859.9091; train_optim_loss: 29358859.9091; val_kl_reg_loss: 86715.9648; val_edge_recon_loss: 2779975.6875; val_gene_expr_recon_loss: 13573420.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41164.1250; val_chrom_access_recon_loss: 13104699.5000; val_global_loss: 29585975.7500; val_optim_loss: 29585975.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9404; val_auprc_score: 0.9239; val_best_acc_score: 0.8812; val_best_f1_score: 0.8864; train_kl_reg_loss: 85484.1797; train_edge_recon_loss: 2727159.9659; train_gene_expr_recon_loss: 13495921.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40736.0795; train_chrom_access_recon_loss: 12944063.1667; train_global_loss: 29293364.3636; train_optim_loss: 29293364.3636; val_kl_reg_loss: 83966.5918; val_edge_recon_loss: 2752518.4062; val_gene_expr_recon_loss: 13424123.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40684.3047; val_chrom_access_recon_loss: 12859979.5000; val_global_loss: 29161272.0000; val_optim_loss: 29161272.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9405; val_auprc_score: 0.9213; val_best_acc_score: 0.8853; val_best_f1_score: 0.8905; train_kl_reg_loss: 84779.4775; train_edge_recon_loss: 2727750.2727; train_gene_expr_recon_loss: 13461673.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35541.8795; train_chrom_access_recon_loss: 12910563.3485; train_global_loss: 29220308.7273; train_optim_loss: 29220308.7273; val_kl_reg_loss: 86890.1338; val_edge_recon_loss: 2752339.8750; val_gene_expr_recon_loss: 13408121.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33918.6875; val_chrom_access_recon_loss: 12873828.2500; val_global_loss: 29155098.2500; val_optim_loss: 29155098.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9327; val_auprc_score: 0.9070; val_best_acc_score: 0.8759; val_best_f1_score: 0.8817; train_kl_reg_loss: 86176.2807; train_edge_recon_loss: 2718499.1818; train_gene_expr_recon_loss: 13463260.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33682.4926; train_chrom_access_recon_loss: 12906923.6364; train_global_loss: 29208542.1818; train_optim_loss: 29208542.1818; val_kl_reg_loss: 87369.9961; val_edge_recon_loss: 2768274.7188; val_gene_expr_recon_loss: 13417295.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33515.9805; val_chrom_access_recon_loss: 12988572.3750; val_global_loss: 29295028.2500; val_optim_loss: 29295028.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9405; val_auprc_score: 0.9194; val_best_acc_score: 0.8831; val_best_f1_score: 0.8898; train_kl_reg_loss: 86877.1016; train_edge_recon_loss: 2727705.3447; train_gene_expr_recon_loss: 13469889.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33405.9441; train_chrom_access_recon_loss: 12915857.5152; train_global_loss: 29233735.6061; train_optim_loss: 29233735.6061; val_kl_reg_loss: 87425.4180; val_edge_recon_loss: 2750239.5000; val_gene_expr_recon_loss: 13454361.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33328.8242; val_chrom_access_recon_loss: 12908919.5000; val_global_loss: 29234275.2500; val_optim_loss: 29234275.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9386; val_auprc_score: 0.9148; val_best_acc_score: 0.8861; val_best_f1_score: 0.8905; train_kl_reg_loss: 86774.7519; train_edge_recon_loss: 2714656.7159; train_gene_expr_recon_loss: 13455168.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33239.0641; train_chrom_access_recon_loss: 12901186.0909; train_global_loss: 29191024.6970; train_optim_loss: 29191024.6970; val_kl_reg_loss: 86432.4121; val_edge_recon_loss: 2765477.7812; val_gene_expr_recon_loss: 13419455.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33167.0586; val_chrom_access_recon_loss: 12911335.2500; val_global_loss: 29215868.2500; val_optim_loss: 29215868.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 47 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9368
val AUPRC score: 0.9160
val best accuracy score: 0.8764
val best F1 score: 0.8817
val target rna MSE score: 0.8644
val source rna MSE score: 0.3262
val target atac MSE score: 0.3302
val source atac MSE score: 0.0735
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
