[True]
Run timestamp: 26072023_222137_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8795; val_auprc_score: 0.9772; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 224785.3071; train_edge_recon_loss: 1150227.7529; train_gene_expr_recon_loss: 3374691.0512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4749704.1116; train_optim_loss: 4749704.1116; val_kl_reg_loss: 145687.6921; val_edge_recon_loss: 1164885.4844; val_gene_expr_recon_loss: 2562688.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3873261.6250; val_optim_loss: 3873261.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8661; val_auprc_score: 0.9738; val_best_acc_score: 0.8601; val_best_f1_score: 0.9242; train_kl_reg_loss: 102189.6774; train_edge_recon_loss: 1122454.6721; train_gene_expr_recon_loss: 2528456.8506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3753101.2023; train_optim_loss: 3753101.2023; val_kl_reg_loss: 51926.2959; val_edge_recon_loss: 1186644.9115; val_gene_expr_recon_loss: 1174590.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2413161.2188; val_optim_loss: 2413161.2188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8486; val_auprc_score: 0.9702; val_best_acc_score: 0.8609; val_best_f1_score: 0.9237; train_kl_reg_loss: 60458.1740; train_edge_recon_loss: 1073580.6706; train_gene_expr_recon_loss: 1072993.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2207032.1663; train_optim_loss: 2207032.1663; val_kl_reg_loss: 53693.0353; val_edge_recon_loss: 1193210.8151; val_gene_expr_recon_loss: 1031017.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2277921.4271; val_optim_loss: 2277921.4271
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8421; val_auprc_score: 0.9687; val_best_acc_score: 0.8621; val_best_f1_score: 0.9252; train_kl_reg_loss: 53697.1506; train_edge_recon_loss: 1061315.8471; train_gene_expr_recon_loss: 1024159.6369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2139172.6250; train_optim_loss: 2139172.6250; val_kl_reg_loss: 48460.8599; val_edge_recon_loss: 1165939.5990; val_gene_expr_recon_loss: 995784.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2210184.4948; val_optim_loss: 2210184.4948
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8426; val_auprc_score: 0.9640; val_best_acc_score: 0.8779; val_best_f1_score: 0.9321; train_kl_reg_loss: 48750.2826; train_edge_recon_loss: 1050427.1561; train_gene_expr_recon_loss: 982773.0811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2081950.5122; train_optim_loss: 2081950.5122; val_kl_reg_loss: 42952.9730; val_edge_recon_loss: 1149874.9583; val_gene_expr_recon_loss: 963966.0599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2156793.9792; val_optim_loss: 2156793.9792
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8421; val_auprc_score: 0.9622; val_best_acc_score: 0.8861; val_best_f1_score: 0.9364; train_kl_reg_loss: 45980.6228; train_edge_recon_loss: 1003796.6974; train_gene_expr_recon_loss: 955948.3433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2005725.6669; train_optim_loss: 2005725.6669; val_kl_reg_loss: 48022.6613; val_edge_recon_loss: 965931.2161; val_gene_expr_recon_loss: 942235.5755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1956189.4531; val_optim_loss: 1956189.4531
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8443; val_auprc_score: 0.9626; val_best_acc_score: 0.8865; val_best_f1_score: 0.9364; train_kl_reg_loss: 52025.9717; train_edge_recon_loss: 929591.4331; train_gene_expr_recon_loss: 932482.3384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1914099.7477; train_optim_loss: 1914099.7477; val_kl_reg_loss: 48654.4159; val_edge_recon_loss: 947572.8828; val_gene_expr_recon_loss: 918993.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1915220.6719; val_optim_loss: 1915220.6719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8469; val_auprc_score: 0.9647; val_best_acc_score: 0.8919; val_best_f1_score: 0.9393; train_kl_reg_loss: 47805.9236; train_edge_recon_loss: 910758.0587; train_gene_expr_recon_loss: 910154.5209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1868718.5047; train_optim_loss: 1868718.5047; val_kl_reg_loss: 42816.5326; val_edge_recon_loss: 926539.2474; val_gene_expr_recon_loss: 896711.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1866067.6562; val_optim_loss: 1866067.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8428; val_auprc_score: 0.9642; val_best_acc_score: 0.8945; val_best_f1_score: 0.9409; train_kl_reg_loss: 40498.7353; train_edge_recon_loss: 884138.1206; train_gene_expr_recon_loss: 888557.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1813194.2907; train_optim_loss: 1813194.2907; val_kl_reg_loss: 34449.8568; val_edge_recon_loss: 905170.7031; val_gene_expr_recon_loss: 875315.0599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1814935.6302; val_optim_loss: 1814935.6302
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8551; val_auprc_score: 0.9672; val_best_acc_score: 0.9009; val_best_f1_score: 0.9446; train_kl_reg_loss: 33660.6826; train_edge_recon_loss: 868921.3503; train_gene_expr_recon_loss: 869193.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1771775.7535; train_optim_loss: 1771775.7535; val_kl_reg_loss: 30594.5437; val_edge_recon_loss: 882847.5599; val_gene_expr_recon_loss: 858034.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1771476.4375; val_optim_loss: 1771476.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8679; val_auprc_score: 0.9705; val_best_acc_score: 0.9035; val_best_f1_score: 0.9455; train_kl_reg_loss: 28663.7327; train_edge_recon_loss: 857409.7180; train_gene_expr_recon_loss: 853947.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1740020.5116; train_optim_loss: 1740020.5116; val_kl_reg_loss: 25163.6021; val_edge_recon_loss: 870837.3646; val_gene_expr_recon_loss: 844015.0365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1740016.0052; val_optim_loss: 1740016.0052
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8834; val_auprc_score: 0.9733; val_best_acc_score: 0.8978; val_best_f1_score: 0.9417; train_kl_reg_loss: 24276.0595; train_edge_recon_loss: 831727.4343; train_gene_expr_recon_loss: 839935.9907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1695939.4843; train_optim_loss: 1695939.4843; val_kl_reg_loss: 20872.8598; val_edge_recon_loss: 856095.3984; val_gene_expr_recon_loss: 830882.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1707851.2396; val_optim_loss: 1707851.2396
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8907; val_auprc_score: 0.9749; val_best_acc_score: 0.9087; val_best_f1_score: 0.9472; train_kl_reg_loss: 19920.7653; train_edge_recon_loss: 820062.8355; train_gene_expr_recon_loss: 827324.7924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1667308.3884; train_optim_loss: 1667308.3884; val_kl_reg_loss: 18308.8178; val_edge_recon_loss: 837206.3281; val_gene_expr_recon_loss: 818916.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1674432.0156; val_optim_loss: 1674432.0156
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9122; val_auprc_score: 0.9808; val_best_acc_score: 0.9201; val_best_f1_score: 0.9544; train_kl_reg_loss: 17103.5133; train_edge_recon_loss: 810411.6384; train_gene_expr_recon_loss: 814854.4933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1642369.6494; train_optim_loss: 1642369.6494; val_kl_reg_loss: 15309.9243; val_edge_recon_loss: 816411.6484; val_gene_expr_recon_loss: 806792.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1638514.5156; val_optim_loss: 1638514.5156
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9289; val_auprc_score: 0.9834; val_best_acc_score: 0.9246; val_best_f1_score: 0.9565; train_kl_reg_loss: 15501.3976; train_edge_recon_loss: 793056.2436; train_gene_expr_recon_loss: 803363.2619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1611920.9017; train_optim_loss: 1611920.9017; val_kl_reg_loss: 14661.8483; val_edge_recon_loss: 823117.2031; val_gene_expr_recon_loss: 794991.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1632770.1510; val_optim_loss: 1632770.1510
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9294; val_auprc_score: 0.9845; val_best_acc_score: 0.9242; val_best_f1_score: 0.9565; train_kl_reg_loss: 14136.0345; train_edge_recon_loss: 794773.2279; train_gene_expr_recon_loss: 792922.3166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1601831.5779; train_optim_loss: 1601831.5779; val_kl_reg_loss: 12887.1412; val_edge_recon_loss: 798539.7109; val_gene_expr_recon_loss: 785568.1068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1596994.9479; val_optim_loss: 1596994.9479
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9322; val_auprc_score: 0.9851; val_best_acc_score: 0.9205; val_best_f1_score: 0.9540; train_kl_reg_loss: 12879.0916; train_edge_recon_loss: 791003.8965; train_gene_expr_recon_loss: 783801.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1587684.3703; train_optim_loss: 1587684.3703; val_kl_reg_loss: 11607.2720; val_edge_recon_loss: 826112.2057; val_gene_expr_recon_loss: 778457.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1616177.4115; val_optim_loss: 1616177.4115
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9372; val_auprc_score: 0.9863; val_best_acc_score: 0.9263; val_best_f1_score: 0.9574; train_kl_reg_loss: 11955.9841; train_edge_recon_loss: 784528.5276; train_gene_expr_recon_loss: 775157.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1571642.4622; train_optim_loss: 1571642.4622; val_kl_reg_loss: 11326.7450; val_edge_recon_loss: 799426.3906; val_gene_expr_recon_loss: 769053.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1579806.3750; val_optim_loss: 1579806.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9421; val_auprc_score: 0.9874; val_best_acc_score: 0.9276; val_best_f1_score: 0.9583; train_kl_reg_loss: 11681.7120; train_edge_recon_loss: 786276.3727; train_gene_expr_recon_loss: 767790.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1565748.7953; train_optim_loss: 1565748.7953; val_kl_reg_loss: 10738.3071; val_edge_recon_loss: 803178.1094; val_gene_expr_recon_loss: 762739.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1576656.1771; val_optim_loss: 1576656.1771
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9475; val_auprc_score: 0.9885; val_best_acc_score: 0.9347; val_best_f1_score: 0.9624; train_kl_reg_loss: 11882.3703; train_edge_recon_loss: 780779.0131; train_gene_expr_recon_loss: 760642.9610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1553304.3465; train_optim_loss: 1553304.3465; val_kl_reg_loss: 11065.3385; val_edge_recon_loss: 778305.3438; val_gene_expr_recon_loss: 755290.1068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1544660.7812; val_optim_loss: 1544660.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9535; val_auprc_score: 0.9896; val_best_acc_score: 0.9388; val_best_f1_score: 0.9646; train_kl_reg_loss: 11352.9631; train_edge_recon_loss: 769448.9209; train_gene_expr_recon_loss: 754185.7358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1534987.6221; train_optim_loss: 1534987.6221; val_kl_reg_loss: 10986.0878; val_edge_recon_loss: 788304.9818; val_gene_expr_recon_loss: 749307.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1548598.8073; val_optim_loss: 1548598.8073
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9511; val_auprc_score: 0.9897; val_best_acc_score: 0.9369; val_best_f1_score: 0.9637; train_kl_reg_loss: 11210.4396; train_edge_recon_loss: 782330.0712; train_gene_expr_recon_loss: 747977.3619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1541517.8680; train_optim_loss: 1541517.8680; val_kl_reg_loss: 11171.6373; val_edge_recon_loss: 765027.5599; val_gene_expr_recon_loss: 744890.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1521089.2396; val_optim_loss: 1521089.2396
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9465; val_auprc_score: 0.9881; val_best_acc_score: 0.9366; val_best_f1_score: 0.9636; train_kl_reg_loss: 11551.3254; train_edge_recon_loss: 784289.6683; train_gene_expr_recon_loss: 742699.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1538540.4233; train_optim_loss: 1538540.4233; val_kl_reg_loss: 10921.7758; val_edge_recon_loss: 789087.5312; val_gene_expr_recon_loss: 739987.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1539996.6510; val_optim_loss: 1539996.6510
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9516; val_auprc_score: 0.9893; val_best_acc_score: 0.9407; val_best_f1_score: 0.9657; train_kl_reg_loss: 11338.9155; train_edge_recon_loss: 774973.9672; train_gene_expr_recon_loss: 737664.6765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1523977.5645; train_optim_loss: 1523977.5645; val_kl_reg_loss: 10832.7099; val_edge_recon_loss: 789439.9427; val_gene_expr_recon_loss: 734511.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1534783.8438; val_optim_loss: 1534783.8438
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9556; val_auprc_score: 0.9894; val_best_acc_score: 0.9424; val_best_f1_score: 0.9665; train_kl_reg_loss: 11390.1861; train_edge_recon_loss: 772245.6087; train_gene_expr_recon_loss: 733328.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1516963.8512; train_optim_loss: 1516963.8512; val_kl_reg_loss: 10735.1383; val_edge_recon_loss: 808035.5026; val_gene_expr_recon_loss: 729862.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1548632.7552; val_optim_loss: 1548632.7552
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9574; val_auprc_score: 0.9905; val_best_acc_score: 0.9429; val_best_f1_score: 0.9668; train_kl_reg_loss: 11068.8785; train_edge_recon_loss: 783213.5047; train_gene_expr_recon_loss: 729085.8430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1523368.2256; train_optim_loss: 1523368.2256; val_kl_reg_loss: 10411.5538; val_edge_recon_loss: 789820.5703; val_gene_expr_recon_loss: 725895.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1526127.4010; val_optim_loss: 1526127.4010

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9612; val_auprc_score: 0.9912; val_best_acc_score: 0.9452; val_best_f1_score: 0.9681; train_kl_reg_loss: 10766.2784; train_edge_recon_loss: 772293.7349; train_gene_expr_recon_loss: 725870.4218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1508930.4331; train_optim_loss: 1508930.4331; val_kl_reg_loss: 10429.6713; val_edge_recon_loss: 774895.5417; val_gene_expr_recon_loss: 723849.5964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509174.8281; val_optim_loss: 1509174.8281
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9581; val_auprc_score: 0.9912; val_best_acc_score: 0.9442; val_best_f1_score: 0.9677; train_kl_reg_loss: 10759.9625; train_edge_recon_loss: 769065.9913; train_gene_expr_recon_loss: 725380.3049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505206.2622; train_optim_loss: 1505206.2622; val_kl_reg_loss: 10502.2176; val_edge_recon_loss: 767103.5755; val_gene_expr_recon_loss: 723172.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1500778.1927; val_optim_loss: 1500778.1927
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9569; val_auprc_score: 0.9895; val_best_acc_score: 0.9432; val_best_f1_score: 0.9669; train_kl_reg_loss: 10713.1483; train_edge_recon_loss: 771699.4203; train_gene_expr_recon_loss: 724856.6634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507269.2331; train_optim_loss: 1507269.2331; val_kl_reg_loss: 10338.5710; val_edge_recon_loss: 804260.3490; val_gene_expr_recon_loss: 722946.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537545.6667; val_optim_loss: 1537545.6667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9555; val_auprc_score: 0.9902; val_best_acc_score: 0.9436; val_best_f1_score: 0.9672; train_kl_reg_loss: 10609.5995; train_edge_recon_loss: 774827.8314; train_gene_expr_recon_loss: 724400.9451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509838.3744; train_optim_loss: 1509838.3744; val_kl_reg_loss: 10310.7151; val_edge_recon_loss: 795314.7839; val_gene_expr_recon_loss: 722204.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1527829.6302; val_optim_loss: 1527829.6302
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9607; val_auprc_score: 0.9914; val_best_acc_score: 0.9446; val_best_f1_score: 0.9681; train_kl_reg_loss: 10509.9011; train_edge_recon_loss: 775174.3480; train_gene_expr_recon_loss: 724092.5198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509776.7686; train_optim_loss: 1509776.7686; val_kl_reg_loss: 10020.0101; val_edge_recon_loss: 772941.0234; val_gene_expr_recon_loss: 722211.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1505172.8125; val_optim_loss: 1505172.8125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9587; val_auprc_score: 0.9912; val_best_acc_score: 0.9442; val_best_f1_score: 0.9677; train_kl_reg_loss: 10504.3747; train_edge_recon_loss: 771271.2765; train_gene_expr_recon_loss: 723437.0520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505212.6988; train_optim_loss: 1505212.6988; val_kl_reg_loss: 10209.1765; val_edge_recon_loss: 779457.1615; val_gene_expr_recon_loss: 721614.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511281.1615; val_optim_loss: 1511281.1615

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9588; val_auprc_score: 0.9911; val_best_acc_score: 0.9439; val_best_f1_score: 0.9676; train_kl_reg_loss: 10444.9647; train_edge_recon_loss: 770564.1192; train_gene_expr_recon_loss: 723086.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504095.6953; train_optim_loss: 1504095.6953; val_kl_reg_loss: 10096.3888; val_edge_recon_loss: 777634.9688; val_gene_expr_recon_loss: 721310.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509042.3490; val_optim_loss: 1509042.3490
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9610; val_auprc_score: 0.9912; val_best_acc_score: 0.9477; val_best_f1_score: 0.9695; train_kl_reg_loss: 10400.4517; train_edge_recon_loss: 764236.8698; train_gene_expr_recon_loss: 722985.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497623.1041; train_optim_loss: 1497623.1041; val_kl_reg_loss: 10097.1918; val_edge_recon_loss: 777520.3359; val_gene_expr_recon_loss: 720814.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1508432.3073; val_optim_loss: 1508432.3073
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9611; val_auprc_score: 0.9915; val_best_acc_score: 0.9460; val_best_f1_score: 0.9686; train_kl_reg_loss: 10403.5611; train_edge_recon_loss: 771514.4901; train_gene_expr_recon_loss: 723037.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504955.8337; train_optim_loss: 1504955.8337; val_kl_reg_loss: 10070.7905; val_edge_recon_loss: 778683.1562; val_gene_expr_recon_loss: 721420.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1510174.5000; val_optim_loss: 1510174.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9590; val_auprc_score: 0.9903; val_best_acc_score: 0.9454; val_best_f1_score: 0.9683; train_kl_reg_loss: 10371.3051; train_edge_recon_loss: 765853.7353; train_gene_expr_recon_loss: 722575.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1498800.6494; train_optim_loss: 1498800.6494; val_kl_reg_loss: 10112.7172; val_edge_recon_loss: 777999.1745; val_gene_expr_recon_loss: 721121.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509233.7083; val_optim_loss: 1509233.7083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 36 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9549
Val AUPRC score: 0.9897
Val best accuracy score: 0.9425
Val best F1 score: 0.9665
Val gene expr MSE score: 142188.3617
Val cat covariate0 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
