[True]
Run timestamp: 08082023_011647_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8987; val_auprc_score: 0.9791; val_best_acc_score: 0.8573; val_best_f1_score: 0.9229; train_kl_reg_loss: 132676.9212; train_edge_recon_loss: 117590.5300; train_gene_expr_recon_loss: 3770485.9928; train_masked_gp_l1_reg_loss: 18096.4839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176783.6848; train_global_loss: 4215633.6394; train_optim_loss: 4215633.6394; val_kl_reg_loss: 120082.1289; val_edge_recon_loss: 118786.8711; val_gene_expr_recon_loss: 2886656.4167; val_masked_gp_l1_reg_loss: 15167.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168059.1562; val_global_loss: 3308752.4167; val_optim_loss: 3308752.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8837; val_auprc_score: 0.9747; val_best_acc_score: 0.8939; val_best_f1_score: 0.9407; train_kl_reg_loss: 100406.9847; train_edge_recon_loss: 118417.4684; train_gene_expr_recon_loss: 2774688.3365; train_masked_gp_l1_reg_loss: 13760.7930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155920.8517; train_global_loss: 3163194.4207; train_optim_loss: 3163194.4207; val_kl_reg_loss: 73776.9805; val_edge_recon_loss: 119278.3737; val_gene_expr_recon_loss: 2403348.7708; val_masked_gp_l1_reg_loss: 13216.1348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143193.5625; val_global_loss: 2752813.8750; val_optim_loss: 2752813.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8977; val_auprc_score: 0.9770; val_best_acc_score: 0.8932; val_best_f1_score: 0.9410; train_kl_reg_loss: 74254.7960; train_edge_recon_loss: 117787.3371; train_gene_expr_recon_loss: 2291384.7572; train_masked_gp_l1_reg_loss: 12891.3465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130960.9380; train_global_loss: 2627279.1635; train_optim_loss: 2627279.1635; val_kl_reg_loss: 69094.9297; val_edge_recon_loss: 117307.0885; val_gene_expr_recon_loss: 2240619.4583; val_masked_gp_l1_reg_loss: 12640.6592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118660.5859; val_global_loss: 2558322.7083; val_optim_loss: 2558322.7083
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9109; val_auprc_score: 0.9796; val_best_acc_score: 0.9102; val_best_f1_score: 0.9493; train_kl_reg_loss: 65256.8163; train_edge_recon_loss: 116599.9520; train_gene_expr_recon_loss: 2208230.4231; train_masked_gp_l1_reg_loss: 12635.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107613.0332; train_global_loss: 2510336.0745; train_optim_loss: 2510336.0745; val_kl_reg_loss: 60557.2103; val_edge_recon_loss: 118438.2096; val_gene_expr_recon_loss: 2182644.5000; val_masked_gp_l1_reg_loss: 12680.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97031.3438; val_global_loss: 2471351.6875; val_optim_loss: 2471351.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9209; val_auprc_score: 0.9821; val_best_acc_score: 0.9231; val_best_f1_score: 0.9559; train_kl_reg_loss: 57961.6427; train_edge_recon_loss: 115608.3952; train_gene_expr_recon_loss: 2156088.4351; train_masked_gp_l1_reg_loss: 12775.6360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88070.9516; train_global_loss: 2430505.0745; train_optim_loss: 2430505.0745; val_kl_reg_loss: 54199.4857; val_edge_recon_loss: 116257.3490; val_gene_expr_recon_loss: 2137184.2708; val_masked_gp_l1_reg_loss: 12895.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79655.8281; val_global_loss: 2400192.6250; val_optim_loss: 2400192.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9282; val_auprc_score: 0.9835; val_best_acc_score: 0.9251; val_best_f1_score: 0.9565; train_kl_reg_loss: 52812.3523; train_edge_recon_loss: 114940.8065; train_gene_expr_recon_loss: 2114796.1755; train_masked_gp_l1_reg_loss: 13026.6431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72637.2589; train_global_loss: 2368213.2332; train_optim_loss: 2368213.2332; val_kl_reg_loss: 50586.7754; val_edge_recon_loss: 115653.5195; val_gene_expr_recon_loss: 2099497.3438; val_masked_gp_l1_reg_loss: 13170.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66102.0391; val_global_loss: 2345010.3958; val_optim_loss: 2345010.3958
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9371; val_auprc_score: 0.9857; val_best_acc_score: 0.9310; val_best_f1_score: 0.9605; train_kl_reg_loss: 48894.7056; train_edge_recon_loss: 113844.7122; train_gene_expr_recon_loss: 2079450.9495; train_masked_gp_l1_reg_loss: 13316.1878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60705.6119; train_global_loss: 2316212.1514; train_optim_loss: 2316212.1514; val_kl_reg_loss: 46612.4964; val_edge_recon_loss: 115257.2910; val_gene_expr_recon_loss: 2065797.4167; val_masked_gp_l1_reg_loss: 13467.8701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55685.8281; val_global_loss: 2296820.7083; val_optim_loss: 2296820.7083
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9415; val_auprc_score: 0.9874; val_best_acc_score: 0.9365; val_best_f1_score: 0.9634; train_kl_reg_loss: 45841.0334; train_edge_recon_loss: 112714.1357; train_gene_expr_recon_loss: 2047412.4868; train_masked_gp_l1_reg_loss: 13611.0508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51566.4370; train_global_loss: 2271145.1611; train_optim_loss: 2271145.1611; val_kl_reg_loss: 43862.4297; val_edge_recon_loss: 112928.0599; val_gene_expr_recon_loss: 2035234.6979; val_masked_gp_l1_reg_loss: 13757.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47711.1641; val_global_loss: 2253494.4167; val_optim_loss: 2253494.4167
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9467; val_auprc_score: 0.9882; val_best_acc_score: 0.9391; val_best_f1_score: 0.9653; train_kl_reg_loss: 43291.0345; train_edge_recon_loss: 112165.6604; train_gene_expr_recon_loss: 2018585.0276; train_masked_gp_l1_reg_loss: 13892.2321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44527.1371; train_global_loss: 2232461.0841; train_optim_loss: 2232461.0841; val_kl_reg_loss: 41532.8473; val_edge_recon_loss: 110717.0775; val_gene_expr_recon_loss: 2008884.7396; val_masked_gp_l1_reg_loss: 14024.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41533.3164; val_global_loss: 2216692.6667; val_optim_loss: 2216692.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9493; val_auprc_score: 0.9885; val_best_acc_score: 0.9428; val_best_f1_score: 0.9671; train_kl_reg_loss: 41121.0212; train_edge_recon_loss: 111165.9799; train_gene_expr_recon_loss: 1992204.1647; train_masked_gp_l1_reg_loss: 14143.4577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39062.8445; train_global_loss: 2197697.4712; train_optim_loss: 2197697.4712; val_kl_reg_loss: 40208.5449; val_edge_recon_loss: 110985.0931; val_gene_expr_recon_loss: 1982136.6458; val_masked_gp_l1_reg_loss: 14263.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36729.1445; val_global_loss: 2184322.7708; val_optim_loss: 2184322.7708
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9535; val_auprc_score: 0.9896; val_best_acc_score: 0.9460; val_best_f1_score: 0.9690; train_kl_reg_loss: 39251.8672; train_edge_recon_loss: 110487.4553; train_gene_expr_recon_loss: 1968665.9627; train_masked_gp_l1_reg_loss: 14371.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34761.0311; train_global_loss: 2167537.3558; train_optim_loss: 2167537.3558; val_kl_reg_loss: 38002.6214; val_edge_recon_loss: 110096.7923; val_gene_expr_recon_loss: 1960248.5104; val_masked_gp_l1_reg_loss: 14479.7021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32919.3594; val_global_loss: 2155746.8958; val_optim_loss: 2155746.8958
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9590; val_auprc_score: 0.9908; val_best_acc_score: 0.9510; val_best_f1_score: 0.9717; train_kl_reg_loss: 37576.0933; train_edge_recon_loss: 108986.1963; train_gene_expr_recon_loss: 1945962.9700; train_masked_gp_l1_reg_loss: 14581.9302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31340.2014; train_global_loss: 2138447.3894; train_optim_loss: 2138447.3894; val_kl_reg_loss: 36958.0179; val_edge_recon_loss: 108500.1178; val_gene_expr_recon_loss: 1937677.0521; val_masked_gp_l1_reg_loss: 14684.4482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29842.3457; val_global_loss: 2127661.9167; val_optim_loss: 2127661.9167
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9612; val_auprc_score: 0.9910; val_best_acc_score: 0.9530; val_best_f1_score: 0.9729; train_kl_reg_loss: 36046.6514; train_edge_recon_loss: 108068.9579; train_gene_expr_recon_loss: 1924849.3762; train_masked_gp_l1_reg_loss: 14772.7386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28551.7156; train_global_loss: 2112289.4507; train_optim_loss: 2112289.4507; val_kl_reg_loss: 34805.6569; val_edge_recon_loss: 108963.7656; val_gene_expr_recon_loss: 1917503.4062; val_masked_gp_l1_reg_loss: 14873.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27324.2168; val_global_loss: 2103471.0833; val_optim_loss: 2103471.0833
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9644; val_auprc_score: 0.9917; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 34647.6914; train_edge_recon_loss: 106925.7763; train_gene_expr_recon_loss: 1904476.4844; train_masked_gp_l1_reg_loss: 14957.1867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26230.4637; train_global_loss: 2087237.6010; train_optim_loss: 2087237.6010; val_kl_reg_loss: 33176.2708; val_edge_recon_loss: 109520.0417; val_gene_expr_recon_loss: 1898349.4167; val_masked_gp_l1_reg_loss: 15040.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25184.7617; val_global_loss: 2081270.8229; val_optim_loss: 2081270.8229
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9646; val_auprc_score: 0.9919; val_best_acc_score: 0.9556; val_best_f1_score: 0.9744; train_kl_reg_loss: 33235.4850; train_edge_recon_loss: 105445.4500; train_gene_expr_recon_loss: 1886197.1526; train_masked_gp_l1_reg_loss: 15119.5056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24240.1835; train_global_loss: 2064237.7812; train_optim_loss: 2064237.7812; val_kl_reg_loss: 31846.0156; val_edge_recon_loss: 105577.7637; val_gene_expr_recon_loss: 1879898.7188; val_masked_gp_l1_reg_loss: 15192.2998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23333.7539; val_global_loss: 2055848.4896; val_optim_loss: 2055848.4896
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9696; val_auprc_score: 0.9931; val_best_acc_score: 0.9595; val_best_f1_score: 0.9766; train_kl_reg_loss: 31826.2899; train_edge_recon_loss: 104504.0103; train_gene_expr_recon_loss: 1868512.6142; train_masked_gp_l1_reg_loss: 15254.4637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22530.6239; train_global_loss: 2042628.0024; train_optim_loss: 2042628.0024; val_kl_reg_loss: 30426.5065; val_edge_recon_loss: 104231.2344; val_gene_expr_recon_loss: 1862068.8854; val_masked_gp_l1_reg_loss: 15312.6416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21750.9922; val_global_loss: 2033790.2396; val_optim_loss: 2033790.2396
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9685; val_auprc_score: 0.9926; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 30448.6997; train_edge_recon_loss: 102997.7212; train_gene_expr_recon_loss: 1852188.4700; train_masked_gp_l1_reg_loss: 15362.0883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21065.3294; train_global_loss: 2022062.3029; train_optim_loss: 2022062.3029; val_kl_reg_loss: 29145.7715; val_edge_recon_loss: 104280.8040; val_gene_expr_recon_loss: 1846130.7708; val_masked_gp_l1_reg_loss: 15406.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20389.9258; val_global_loss: 2015353.8438; val_optim_loss: 2015353.8438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9694; val_auprc_score: 0.9931; val_best_acc_score: 0.9606; val_best_f1_score: 0.9773; train_kl_reg_loss: 29078.6783; train_edge_recon_loss: 101476.2833; train_gene_expr_recon_loss: 1835352.4279; train_masked_gp_l1_reg_loss: 15443.5416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19790.7981; train_global_loss: 2001141.7356; train_optim_loss: 2001141.7356; val_kl_reg_loss: 27854.7183; val_edge_recon_loss: 101222.6100; val_gene_expr_recon_loss: 1829889.7500; val_masked_gp_l1_reg_loss: 15479.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19217.7754; val_global_loss: 1993664.5625; val_optim_loss: 1993664.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9710; val_auprc_score: 0.9930; val_best_acc_score: 0.9619; val_best_f1_score: 0.9779; train_kl_reg_loss: 27715.5308; train_edge_recon_loss: 99916.4680; train_gene_expr_recon_loss: 1819941.8221; train_masked_gp_l1_reg_loss: 15495.4310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18709.4051; train_global_loss: 1981778.6575; train_optim_loss: 1981778.6575; val_kl_reg_loss: 26862.0425; val_edge_recon_loss: 100927.9824; val_gene_expr_recon_loss: 1813077.0312; val_masked_gp_l1_reg_loss: 15508.5654; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18215.6836; val_global_loss: 1974591.3125; val_optim_loss: 1974591.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9727; val_auprc_score: 0.9935; val_best_acc_score: 0.9644; val_best_f1_score: 0.9793; train_kl_reg_loss: 26305.4793; train_edge_recon_loss: 99055.3770; train_gene_expr_recon_loss: 1805800.1190; train_masked_gp_l1_reg_loss: 15499.6466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17791.0953; train_global_loss: 1964451.7212; train_optim_loss: 1964451.7212; val_kl_reg_loss: 24945.9302; val_edge_recon_loss: 98154.2943; val_gene_expr_recon_loss: 1803243.0417; val_masked_gp_l1_reg_loss: 15481.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17399.0332; val_global_loss: 1959223.3854; val_optim_loss: 1959223.3854
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9739; val_auprc_score: 0.9936; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 24955.5507; train_edge_recon_loss: 98110.9552; train_gene_expr_recon_loss: 1791356.7464; train_masked_gp_l1_reg_loss: 15452.7530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17033.1729; train_global_loss: 1946909.1839; train_optim_loss: 1946909.1839; val_kl_reg_loss: 24194.4528; val_edge_recon_loss: 99426.0111; val_gene_expr_recon_loss: 1786006.0000; val_masked_gp_l1_reg_loss: 15419.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16687.3359; val_global_loss: 1941733.5729; val_optim_loss: 1941733.5729
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9727; val_auprc_score: 0.9933; val_best_acc_score: 0.9645; val_best_f1_score: 0.9794; train_kl_reg_loss: 23580.8338; train_edge_recon_loss: 96741.1005; train_gene_expr_recon_loss: 1778191.0433; train_masked_gp_l1_reg_loss: 15358.5380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16377.7299; train_global_loss: 1930249.2428; train_optim_loss: 1930249.2428; val_kl_reg_loss: 22621.0272; val_edge_recon_loss: 96434.1250; val_gene_expr_recon_loss: 1773614.9062; val_masked_gp_l1_reg_loss: 15298.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16091.9316; val_global_loss: 1924060.7812; val_optim_loss: 1924060.7812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9751; val_auprc_score: 0.9940; val_best_acc_score: 0.9654; val_best_f1_score: 0.9800; train_kl_reg_loss: 22330.3917; train_edge_recon_loss: 95698.4981; train_gene_expr_recon_loss: 1764922.2873; train_masked_gp_l1_reg_loss: 15205.9920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15823.8084; train_global_loss: 1913980.9760; train_optim_loss: 1913980.9760; val_kl_reg_loss: 21273.1369; val_edge_recon_loss: 94393.9753; val_gene_expr_recon_loss: 1760143.0938; val_masked_gp_l1_reg_loss: 15113.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15593.6836; val_global_loss: 1906516.9583; val_optim_loss: 1906516.9583
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9747; val_auprc_score: 0.9943; val_best_acc_score: 0.9654; val_best_f1_score: 0.9799; train_kl_reg_loss: 21065.4807; train_edge_recon_loss: 94259.8987; train_gene_expr_recon_loss: 1752456.0829; train_masked_gp_l1_reg_loss: 14994.5639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15356.1324; train_global_loss: 1898132.1659; train_optim_loss: 1898132.1659; val_kl_reg_loss: 20170.9626; val_edge_recon_loss: 94105.2454; val_gene_expr_recon_loss: 1747915.6042; val_masked_gp_l1_reg_loss: 14872.2412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15127.4219; val_global_loss: 1892191.4167; val_optim_loss: 1892191.4167
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9777; val_auprc_score: 0.9947; val_best_acc_score: 0.9683; val_best_f1_score: 0.9816; train_kl_reg_loss: 19840.1413; train_edge_recon_loss: 92836.0545; train_gene_expr_recon_loss: 1740364.7356; train_masked_gp_l1_reg_loss: 14715.3663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14920.5062; train_global_loss: 1882676.8089; train_optim_loss: 1882676.8089; val_kl_reg_loss: 19004.2694; val_edge_recon_loss: 92135.6055; val_gene_expr_recon_loss: 1736336.1875; val_masked_gp_l1_reg_loss: 14549.8545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14727.3965; val_global_loss: 1876753.3125; val_optim_loss: 1876753.3125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.7030; val_auprc_score: 0.9186; val_best_acc_score: 0.8597; val_best_f1_score: 0.9239; train_kl_reg_loss: 6560.6472; train_edge_recon_loss: 108261.1160; train_gene_expr_recon_loss: 3140677.9062; train_masked_gp_l1_reg_loss: 17199.4843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11698.3750; train_global_loss: 3284397.5457; train_optim_loss: 3284397.5457; val_kl_reg_loss: 3192.0310; val_edge_recon_loss: 117334.7559; val_gene_expr_recon_loss: 2341747.2917; val_masked_gp_l1_reg_loss: 17334.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9280.0723; val_global_loss: 2488888.5625; val_optim_loss: 2488888.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.6961; val_auprc_score: 0.9127; val_best_acc_score: 0.8632; val_best_f1_score: 0.9249; train_kl_reg_loss: 4352.2343; train_edge_recon_loss: 107482.6388; train_gene_expr_recon_loss: 2149610.9147; train_masked_gp_l1_reg_loss: 16147.4500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7990.5477; train_global_loss: 2285583.7740; train_optim_loss: 2285583.7740; val_kl_reg_loss: 3620.4160; val_edge_recon_loss: 119466.7064; val_gene_expr_recon_loss: 2038072.5625; val_masked_gp_l1_reg_loss: 15091.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6956.2886; val_global_loss: 2183207.3958; val_optim_loss: 2183207.3958
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.7097; val_auprc_score: 0.9162; val_best_acc_score: 0.8650; val_best_f1_score: 0.9265; train_kl_reg_loss: 3679.1899; train_edge_recon_loss: 107680.9173; train_gene_expr_recon_loss: 1988952.9171; train_masked_gp_l1_reg_loss: 14238.8502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6274.1369; train_global_loss: 2120826.0096; train_optim_loss: 2120826.0096; val_kl_reg_loss: 3551.3507; val_edge_recon_loss: 118743.1263; val_gene_expr_recon_loss: 1952870.3750; val_masked_gp_l1_reg_loss: 13432.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5681.8071; val_global_loss: 2094279.2396; val_optim_loss: 2094279.2396
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7144; val_auprc_score: 0.9148; val_best_acc_score: 0.8668; val_best_f1_score: 0.9267; train_kl_reg_loss: 3268.9003; train_edge_recon_loss: 107646.8723; train_gene_expr_recon_loss: 1932180.2320; train_masked_gp_l1_reg_loss: 12773.7594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5239.8623; train_global_loss: 2061109.6202; train_optim_loss: 2061109.6202; val_kl_reg_loss: 3053.0605; val_edge_recon_loss: 120503.1855; val_gene_expr_recon_loss: 1915214.9583; val_masked_gp_l1_reg_loss: 12158.8232; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4836.9194; val_global_loss: 2055766.9583; val_optim_loss: 2055766.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.7236; val_auprc_score: 0.9187; val_best_acc_score: 0.8676; val_best_f1_score: 0.9270; train_kl_reg_loss: 3141.9158; train_edge_recon_loss: 107376.0792; train_gene_expr_recon_loss: 1914451.8534; train_masked_gp_l1_reg_loss: 12001.2941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4674.6702; train_global_loss: 2041645.8125; train_optim_loss: 2041645.8125; val_kl_reg_loss: 2983.3996; val_edge_recon_loss: 119404.8750; val_gene_expr_recon_loss: 1916360.3438; val_masked_gp_l1_reg_loss: 11928.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4625.2432; val_global_loss: 2055302.6146; val_optim_loss: 2055302.6146
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.7209; val_auprc_score: 0.9168; val_best_acc_score: 0.8702; val_best_f1_score: 0.9283; train_kl_reg_loss: 3047.7724; train_edge_recon_loss: 106490.1048; train_gene_expr_recon_loss: 1913350.1082; train_masked_gp_l1_reg_loss: 11867.1949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4589.4010; train_global_loss: 2039344.5781; train_optim_loss: 2039344.5781; val_kl_reg_loss: 2983.6033; val_edge_recon_loss: 119318.0501; val_gene_expr_recon_loss: 1913027.2396; val_masked_gp_l1_reg_loss: 11818.6709; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4552.2495; val_global_loss: 2051699.7604; val_optim_loss: 2051699.7604
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.7332; val_auprc_score: 0.9230; val_best_acc_score: 0.8727; val_best_f1_score: 0.9297; train_kl_reg_loss: 3127.9779; train_edge_recon_loss: 106875.1326; train_gene_expr_recon_loss: 1908454.0649; train_masked_gp_l1_reg_loss: 11751.1946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4516.1306; train_global_loss: 2034724.4988; train_optim_loss: 2034724.4988; val_kl_reg_loss: 3021.4787; val_edge_recon_loss: 118803.1901; val_gene_expr_recon_loss: 1906403.5000; val_masked_gp_l1_reg_loss: 11683.6426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4478.9609; val_global_loss: 2044390.7708; val_optim_loss: 2044390.7708
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.7373; val_auprc_score: 0.9246; val_best_acc_score: 0.8717; val_best_f1_score: 0.9291; train_kl_reg_loss: 3175.8704; train_edge_recon_loss: 106658.7246; train_gene_expr_recon_loss: 1905686.2656; train_masked_gp_l1_reg_loss: 11618.3571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4441.4532; train_global_loss: 2031580.6719; train_optim_loss: 2031580.6719; val_kl_reg_loss: 3065.1031; val_edge_recon_loss: 118016.8457; val_gene_expr_recon_loss: 1906404.5521; val_masked_gp_l1_reg_loss: 11552.2441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4403.1387; val_global_loss: 2043441.8958; val_optim_loss: 2043441.8958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 6 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9794
val AUPRC score: 0.9949
val best accuracy score: 0.9709
val best F1 score: 0.9831
val target rna MSE score: 24.6862
val source rna MSE score: 192.1559
Val cat covariate0 mean sim diff: -0.0017

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
