[True]
Run timestamp: 01082023_083807_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9184; val_auprc_score: 0.9838; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 77884.1047; train_edge_recon_loss: 116805.9009; train_gene_expr_recon_loss: 5148903.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117855.6965; train_global_loss: 5461448.9074; train_optim_loss: 5461448.9074; val_kl_reg_loss: 95087.6927; val_edge_recon_loss: 121482.8359; val_gene_expr_recon_loss: 4348564.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109009.9219; val_global_loss: 4674144.6667; val_optim_loss: 4674144.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8942; val_auprc_score: 0.9798; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 87570.6418; train_edge_recon_loss: 120151.5446; train_gene_expr_recon_loss: 4085516.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101947.3150; train_global_loss: 4395185.6944; train_optim_loss: 4395185.6944; val_kl_reg_loss: 75698.8125; val_edge_recon_loss: 119528.1237; val_gene_expr_recon_loss: 3714814.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95240.7422; val_global_loss: 4005282.4583; val_optim_loss: 4005282.4583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8666; val_auprc_score: 0.9732; val_best_acc_score: 0.8612; val_best_f1_score: 0.9247; train_kl_reg_loss: 70953.3724; train_edge_recon_loss: 118812.5234; train_gene_expr_recon_loss: 3281593.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89755.7308; train_global_loss: 3561114.9213; train_optim_loss: 3561114.9213; val_kl_reg_loss: 49803.1777; val_edge_recon_loss: 119186.8802; val_gene_expr_recon_loss: 2581937.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84505.9219; val_global_loss: 2835433.4583; val_optim_loss: 2835433.4583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8415; val_auprc_score: 0.9681; val_best_acc_score: 0.8751; val_best_f1_score: 0.9303; train_kl_reg_loss: 55073.8589; train_edge_recon_loss: 118797.6063; train_gene_expr_recon_loss: 2415119.1065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80310.5884; train_global_loss: 2669301.1435; train_optim_loss: 2669301.1435; val_kl_reg_loss: 52619.9355; val_edge_recon_loss: 117131.9883; val_gene_expr_recon_loss: 2297682.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76395.3594; val_global_loss: 2543829.6250; val_optim_loss: 2543829.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8471; val_auprc_score: 0.9665; val_best_acc_score: 0.8720; val_best_f1_score: 0.9288; train_kl_reg_loss: 51342.8820; train_edge_recon_loss: 119097.0739; train_gene_expr_recon_loss: 2254121.0602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73531.4738; train_global_loss: 2498092.4861; train_optim_loss: 2498092.4861; val_kl_reg_loss: 46834.0365; val_edge_recon_loss: 124196.2943; val_gene_expr_recon_loss: 2223652.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71050.6875; val_global_loss: 2465733.2917; val_optim_loss: 2465733.2917
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8477; val_auprc_score: 0.9671; val_best_acc_score: 0.8764; val_best_f1_score: 0.9316; train_kl_reg_loss: 46382.1552; train_edge_recon_loss: 116173.9497; train_gene_expr_recon_loss: 2200274.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69624.4722; train_global_loss: 2432455.5046; train_optim_loss: 2432455.5046; val_kl_reg_loss: 42820.7806; val_edge_recon_loss: 117561.0365; val_gene_expr_recon_loss: 2181375.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68605.4531; val_global_loss: 2410362.7500; val_optim_loss: 2410362.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8609; val_auprc_score: 0.9705; val_best_acc_score: 0.8792; val_best_f1_score: 0.9330; train_kl_reg_loss: 42596.2063; train_edge_recon_loss: 115826.9938; train_gene_expr_recon_loss: 2167846.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67903.8329; train_global_loss: 2394173.6435; train_optim_loss: 2394173.6435; val_kl_reg_loss: 39498.3639; val_edge_recon_loss: 116030.7656; val_gene_expr_recon_loss: 2156971.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67173.4531; val_global_loss: 2379673.8333; val_optim_loss: 2379673.8333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8666; val_auprc_score: 0.9722; val_best_acc_score: 0.8813; val_best_f1_score: 0.9338; train_kl_reg_loss: 39606.2581; train_edge_recon_loss: 115295.3760; train_gene_expr_recon_loss: 2142000.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66450.0198; train_global_loss: 2363351.8565; train_optim_loss: 2363351.8565; val_kl_reg_loss: 37059.1243; val_edge_recon_loss: 112485.4336; val_gene_expr_recon_loss: 2128545.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65686.4375; val_global_loss: 2343776.1667; val_optim_loss: 2343776.1667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8843; val_auprc_score: 0.9753; val_best_acc_score: 0.8840; val_best_f1_score: 0.9350; train_kl_reg_loss: 37147.9998; train_edge_recon_loss: 113292.1249; train_gene_expr_recon_loss: 2120589.5741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64929.2813; train_global_loss: 2335958.9815; train_optim_loss: 2335958.9815; val_kl_reg_loss: 34840.6152; val_edge_recon_loss: 115656.2083; val_gene_expr_recon_loss: 2113944.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64134.6055; val_global_loss: 2328575.5000; val_optim_loss: 2328575.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8829; val_auprc_score: 0.9750; val_best_acc_score: 0.8885; val_best_f1_score: 0.9377; train_kl_reg_loss: 35110.7268; train_edge_recon_loss: 113722.0252; train_gene_expr_recon_loss: 2102601.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63353.1335; train_global_loss: 2314786.9491; train_optim_loss: 2314786.9491; val_kl_reg_loss: 33011.5098; val_edge_recon_loss: 113333.2266; val_gene_expr_recon_loss: 2095789.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62536.3203; val_global_loss: 2304670.7500; val_optim_loss: 2304670.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8934; val_auprc_score: 0.9773; val_best_acc_score: 0.8935; val_best_f1_score: 0.9399; train_kl_reg_loss: 33591.8253; train_edge_recon_loss: 112071.7996; train_gene_expr_recon_loss: 2084711.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61739.0428; train_global_loss: 2292114.5139; train_optim_loss: 2292114.5139; val_kl_reg_loss: 31801.7728; val_edge_recon_loss: 111736.1133; val_gene_expr_recon_loss: 2078148.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60906.6406; val_global_loss: 2282593.2083; val_optim_loss: 2282593.2083
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9000; val_auprc_score: 0.9777; val_best_acc_score: 0.9007; val_best_f1_score: 0.9438; train_kl_reg_loss: 32348.1524; train_edge_recon_loss: 110205.6829; train_gene_expr_recon_loss: 2068452.7315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60096.5851; train_global_loss: 2271103.1528; train_optim_loss: 2271103.1528; val_kl_reg_loss: 30516.8008; val_edge_recon_loss: 110881.1914; val_gene_expr_recon_loss: 2060595.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59252.4688; val_global_loss: 2261245.7917; val_optim_loss: 2261245.7917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9009; val_auprc_score: 0.9793; val_best_acc_score: 0.9034; val_best_f1_score: 0.9455; train_kl_reg_loss: 31269.2407; train_edge_recon_loss: 109534.0279; train_gene_expr_recon_loss: 2052725.3171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58437.6950; train_global_loss: 2251966.2778; train_optim_loss: 2251966.2778; val_kl_reg_loss: 29737.8815; val_edge_recon_loss: 107046.4583; val_gene_expr_recon_loss: 2046778.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57592.1836; val_global_loss: 2241154.7083; val_optim_loss: 2241154.7083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9109; val_auprc_score: 0.9801; val_best_acc_score: 0.9097; val_best_f1_score: 0.9482; train_kl_reg_loss: 30329.2528; train_edge_recon_loss: 107353.2267; train_gene_expr_recon_loss: 2037799.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56783.3505; train_global_loss: 2232265.5972; train_optim_loss: 2232265.5972; val_kl_reg_loss: 28838.8903; val_edge_recon_loss: 110601.8724; val_gene_expr_recon_loss: 2031916.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55947.7109; val_global_loss: 2227304.6667; val_optim_loss: 2227304.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9128; val_auprc_score: 0.9815; val_best_acc_score: 0.9107; val_best_f1_score: 0.9489; train_kl_reg_loss: 29544.7636; train_edge_recon_loss: 108104.5780; train_gene_expr_recon_loss: 2023075.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55152.6616; train_global_loss: 2215877.6944; train_optim_loss: 2215877.6944; val_kl_reg_loss: 28166.1566; val_edge_recon_loss: 107384.3529; val_gene_expr_recon_loss: 2012226.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54334.3750; val_global_loss: 2202111.0833; val_optim_loss: 2202111.0833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9155; val_auprc_score: 0.9823; val_best_acc_score: 0.9131; val_best_f1_score: 0.9502; train_kl_reg_loss: 28859.3213; train_edge_recon_loss: 105638.1729; train_gene_expr_recon_loss: 2009164.7731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53555.4939; train_global_loss: 2197217.7685; train_optim_loss: 2197217.7685; val_kl_reg_loss: 27522.4993; val_edge_recon_loss: 106899.2852; val_gene_expr_recon_loss: 2004596.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52752.9492; val_global_loss: 2191770.9167; val_optim_loss: 2191770.9167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9185; val_auprc_score: 0.9813; val_best_acc_score: 0.9161; val_best_f1_score: 0.9518; train_kl_reg_loss: 28052.6150; train_edge_recon_loss: 104243.9353; train_gene_expr_recon_loss: 1994817.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51996.5981; train_global_loss: 2179110.8843; train_optim_loss: 2179110.8843; val_kl_reg_loss: 26937.3714; val_edge_recon_loss: 107644.7122; val_gene_expr_recon_loss: 1987806.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51221.4219; val_global_loss: 2173610.3750; val_optim_loss: 2173610.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9165; val_auprc_score: 0.9822; val_best_acc_score: 0.9179; val_best_f1_score: 0.9531; train_kl_reg_loss: 27410.2889; train_edge_recon_loss: 103124.5382; train_gene_expr_recon_loss: 1980742.0880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50485.6542; train_global_loss: 2161762.5509; train_optim_loss: 2161762.5509; val_kl_reg_loss: 25976.8014; val_edge_recon_loss: 103257.1641; val_gene_expr_recon_loss: 1973379.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49729.7852; val_global_loss: 2152342.7917; val_optim_loss: 2152342.7917
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9220; val_auprc_score: 0.9838; val_best_acc_score: 0.9192; val_best_f1_score: 0.9535; train_kl_reg_loss: 26761.0813; train_edge_recon_loss: 103284.0571; train_gene_expr_recon_loss: 1967192.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49015.4778; train_global_loss: 2146252.9074; train_optim_loss: 2146252.9074; val_kl_reg_loss: 25615.4626; val_edge_recon_loss: 103247.8073; val_gene_expr_recon_loss: 1961048.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48283.9141; val_global_loss: 2138196.1667; val_optim_loss: 2138196.1667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9278; val_auprc_score: 0.9835; val_best_acc_score: 0.9220; val_best_f1_score: 0.9549; train_kl_reg_loss: 26121.1716; train_edge_recon_loss: 101436.5951; train_gene_expr_recon_loss: 1954342.2801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47584.8784; train_global_loss: 2129484.9259; train_optim_loss: 2129484.9259; val_kl_reg_loss: 24946.2760; val_edge_recon_loss: 103934.0664; val_gene_expr_recon_loss: 1949595.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46868.8320; val_global_loss: 2125344.4583; val_optim_loss: 2125344.4583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9292; val_auprc_score: 0.9852; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 25466.9811; train_edge_recon_loss: 100873.2718; train_gene_expr_recon_loss: 1941753.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46194.2891; train_global_loss: 2114288.2407; train_optim_loss: 2114288.2407; val_kl_reg_loss: 24193.1592; val_edge_recon_loss: 99696.3841; val_gene_expr_recon_loss: 1936081.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45499.8984; val_global_loss: 2105470.9167; val_optim_loss: 2105470.9167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9298; val_auprc_score: 0.9852; val_best_acc_score: 0.9283; val_best_f1_score: 0.9588; train_kl_reg_loss: 24883.0342; train_edge_recon_loss: 101369.7318; train_gene_expr_recon_loss: 1929028.8032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44845.2658; train_global_loss: 2100126.8426; train_optim_loss: 2100126.8426; val_kl_reg_loss: 23673.2663; val_edge_recon_loss: 98385.9974; val_gene_expr_recon_loss: 1923410.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44173.1250; val_global_loss: 2089642.6042; val_optim_loss: 2089642.6042
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9349; val_auprc_score: 0.9861; val_best_acc_score: 0.9284; val_best_f1_score: 0.9586; train_kl_reg_loss: 24255.2547; train_edge_recon_loss: 98786.0587; train_gene_expr_recon_loss: 1916856.2546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43536.1024; train_global_loss: 2083433.6690; train_optim_loss: 2083433.6690; val_kl_reg_loss: 23189.7194; val_edge_recon_loss: 99718.4622; val_gene_expr_recon_loss: 1909917.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42883.1055; val_global_loss: 2075708.5417; val_optim_loss: 2075708.5417
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9331; val_auprc_score: 0.9847; val_best_acc_score: 0.9279; val_best_f1_score: 0.9582; train_kl_reg_loss: 23748.2112; train_edge_recon_loss: 99744.2166; train_gene_expr_recon_loss: 1905434.6898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42268.4470; train_global_loss: 2071195.5625; train_optim_loss: 2071195.5625; val_kl_reg_loss: 22791.4115; val_edge_recon_loss: 99942.9805; val_gene_expr_recon_loss: 1902523.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41638.4141; val_global_loss: 2066895.9167; val_optim_loss: 2066895.9167
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9364; val_auprc_score: 0.9863; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 23187.6844; train_edge_recon_loss: 98704.1331; train_gene_expr_recon_loss: 1893513.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41045.3377; train_global_loss: 2056450.5208; train_optim_loss: 2056450.5208; val_kl_reg_loss: 22213.1768; val_edge_recon_loss: 98584.7734; val_gene_expr_recon_loss: 1885820.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40438.6250; val_global_loss: 2047057.2708; val_optim_loss: 2047057.2708
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9214; val_auprc_score: 0.9833; val_best_acc_score: 0.9074; val_best_f1_score: 0.9466; train_kl_reg_loss: 17119.7171; train_edge_recon_loss: 109344.5738; train_gene_expr_recon_loss: 3462908.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39477.7895; train_global_loss: 3628850.5648; train_optim_loss: 3628850.5648; val_kl_reg_loss: 17634.5674; val_edge_recon_loss: 114874.2708; val_gene_expr_recon_loss: 3039499.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38382.5195; val_global_loss: 3210390.4167; val_optim_loss: 3210390.4167
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9251; val_auprc_score: 0.9846; val_best_acc_score: 0.9216; val_best_f1_score: 0.9553; train_kl_reg_loss: 18440.6352; train_edge_recon_loss: 106152.4510; train_gene_expr_recon_loss: 2783832.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37338.4176; train_global_loss: 2945764.0833; train_optim_loss: 2945764.0833; val_kl_reg_loss: 17039.0381; val_edge_recon_loss: 100740.2943; val_gene_expr_recon_loss: 2554828.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36275.0547; val_global_loss: 2708883.0833; val_optim_loss: 2708883.0833
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9216; val_auprc_score: 0.9820; val_best_acc_score: 0.9213; val_best_f1_score: 0.9546; train_kl_reg_loss: 17745.5150; train_edge_recon_loss: 101417.4563; train_gene_expr_recon_loss: 2411676.9352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35286.5549; train_global_loss: 2566126.4815; train_optim_loss: 2566126.4815; val_kl_reg_loss: 16530.3258; val_edge_recon_loss: 100333.3099; val_gene_expr_recon_loss: 2287476.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34280.2031; val_global_loss: 2438620.7500; val_optim_loss: 2438620.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9266; val_auprc_score: 0.9843; val_best_acc_score: 0.9243; val_best_f1_score: 0.9567; train_kl_reg_loss: 17065.1233; train_edge_recon_loss: 96511.5203; train_gene_expr_recon_loss: 2206699.5741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33344.0149; train_global_loss: 2353620.2407; train_optim_loss: 2353620.2407; val_kl_reg_loss: 15809.0059; val_edge_recon_loss: 93271.2904; val_gene_expr_recon_loss: 2140976.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32389.5879; val_global_loss: 2282445.9167; val_optim_loss: 2282445.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9262; val_auprc_score: 0.9841; val_best_acc_score: 0.9239; val_best_f1_score: 0.9563; train_kl_reg_loss: 16457.6193; train_edge_recon_loss: 94262.7231; train_gene_expr_recon_loss: 2132998.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32261.1718; train_global_loss: 2275980.3056; train_optim_loss: 2275980.3056; val_kl_reg_loss: 15563.6455; val_edge_recon_loss: 94645.3320; val_gene_expr_recon_loss: 2125319.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32157.6953; val_global_loss: 2267686.5417; val_optim_loss: 2267686.5417
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9252; val_auprc_score: 0.9839; val_best_acc_score: 0.9233; val_best_f1_score: 0.9558; train_kl_reg_loss: 16334.4158; train_edge_recon_loss: 94927.5561; train_gene_expr_recon_loss: 2123611.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32064.1837; train_global_loss: 2266937.2083; train_optim_loss: 2266937.2083; val_kl_reg_loss: 15471.0513; val_edge_recon_loss: 95290.4714; val_gene_expr_recon_loss: 2119227.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31966.6523; val_global_loss: 2261956.0833; val_optim_loss: 2261956.0833
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9344; val_auprc_score: 0.9862; val_best_acc_score: 0.9259; val_best_f1_score: 0.9574; train_kl_reg_loss: 16204.6781; train_edge_recon_loss: 93408.7729; train_gene_expr_recon_loss: 2114241.1065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31871.3563; train_global_loss: 2255725.9306; train_optim_loss: 2255725.9306; val_kl_reg_loss: 15346.0277; val_edge_recon_loss: 93923.0859; val_gene_expr_recon_loss: 2110892.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31771.8516; val_global_loss: 2251933.7083; val_optim_loss: 2251933.7083
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9205; val_auprc_score: 0.9814; val_best_acc_score: 0.9182; val_best_f1_score: 0.9530; train_kl_reg_loss: 16076.8555; train_edge_recon_loss: 93892.1881; train_gene_expr_recon_loss: 2105615.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31674.4831; train_global_loss: 2247258.5880; train_optim_loss: 2247258.5880; val_kl_reg_loss: 15069.9222; val_edge_recon_loss: 97968.5768; val_gene_expr_recon_loss: 2100601.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31572.7949; val_global_loss: 2245213.0000; val_optim_loss: 2245213.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9379
val AUPRC score: 0.9865
val best accuracy score: 0.9292
val best F1 score: 0.9591
val target rna MSE score: 23.7569
val source rna MSE score: 128.4878
Val cat covariate0 mean sim diff: -0.0025

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
