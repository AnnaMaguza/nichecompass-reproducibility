[True]
Run timestamp: 07082023_175706_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8787; val_auprc_score: 0.8979; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17769.4072; train_edge_recon_loss: 36315.4770; train_gene_expr_recon_loss: 1278411.7222; train_masked_gp_l1_reg_loss: 15978.5515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167189.9392; train_chrom_access_recon_loss: 2835465.8194; train_global_loss: 4351130.8611; train_optim_loss: 4351130.8611; val_kl_reg_loss: 13150.2539; val_edge_recon_loss: 40661.3906; val_gene_expr_recon_loss: 1067576.2500; val_masked_gp_l1_reg_loss: 11244.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162784.0000; val_chrom_access_recon_loss: 1732652.7500; val_global_loss: 3028068.7500; val_optim_loss: 3028068.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8983; val_auprc_score: 0.9161; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11745.9965; train_edge_recon_loss: 37757.8963; train_gene_expr_recon_loss: 946665.0694; train_masked_gp_l1_reg_loss: 9818.3778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160037.1007; train_chrom_access_recon_loss: 1534936.8472; train_global_loss: 2700961.3056; train_optim_loss: 2700961.3056; val_kl_reg_loss: 10393.8633; val_edge_recon_loss: 40661.1680; val_gene_expr_recon_loss: 877090.2500; val_masked_gp_l1_reg_loss: 9182.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156761.5000; val_chrom_access_recon_loss: 1428345.5000; val_global_loss: 2522434.5000; val_optim_loss: 2522434.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8940; val_auprc_score: 0.9108; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12677.2300; train_edge_recon_loss: 37929.9692; train_gene_expr_recon_loss: 836585.6528; train_masked_gp_l1_reg_loss: 9818.4018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154174.8351; train_chrom_access_recon_loss: 1404835.3611; train_global_loss: 2456021.4167; train_optim_loss: 2456021.4167; val_kl_reg_loss: 16015.8184; val_edge_recon_loss: 40661.7188; val_gene_expr_recon_loss: 799229.6875; val_masked_gp_l1_reg_loss: 10355.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150813.7812; val_chrom_access_recon_loss: 1387816.0000; val_global_loss: 2404892.5000; val_optim_loss: 2404892.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8937; val_auprc_score: 0.9127; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19046.8461; train_edge_recon_loss: 38660.6875; train_gene_expr_recon_loss: 767151.6806; train_masked_gp_l1_reg_loss: 10365.0627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147793.1875; train_chrom_access_recon_loss: 1372627.7222; train_global_loss: 2355645.1667; train_optim_loss: 2355645.1667; val_kl_reg_loss: 20747.3750; val_edge_recon_loss: 40661.5273; val_gene_expr_recon_loss: 759648.6250; val_masked_gp_l1_reg_loss: 10367.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143781.8906; val_chrom_access_recon_loss: 1367255.2500; val_global_loss: 2342462.0000; val_optim_loss: 2342462.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8854; val_auprc_score: 0.9034; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21121.6480; train_edge_recon_loss: 38883.8602; train_gene_expr_recon_loss: 742494.7639; train_masked_gp_l1_reg_loss: 10336.6121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140271.0278; train_chrom_access_recon_loss: 1348410.3056; train_global_loss: 2301518.1944; train_optim_loss: 2301518.1944; val_kl_reg_loss: 20819.1445; val_edge_recon_loss: 40660.6953; val_gene_expr_recon_loss: 738876.6875; val_masked_gp_l1_reg_loss: 10291.7373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135771.8906; val_chrom_access_recon_loss: 1351615.8750; val_global_loss: 2298036.0000; val_optim_loss: 2298036.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8795; val_auprc_score: 0.8950; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 22352.5543; train_edge_recon_loss: 38946.6619; train_gene_expr_recon_loss: 726238.9028; train_masked_gp_l1_reg_loss: 10259.6605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132101.4436; train_chrom_access_recon_loss: 1343349.5417; train_global_loss: 2273248.8056; train_optim_loss: 2273248.8056; val_kl_reg_loss: 22925.6641; val_edge_recon_loss: 40659.6172; val_gene_expr_recon_loss: 723101.9375; val_masked_gp_l1_reg_loss: 10189.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127504.8125; val_chrom_access_recon_loss: 1342148.7500; val_global_loss: 2266530.0000; val_optim_loss: 2266530.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8725; val_auprc_score: 0.8848; val_best_acc_score: 0.5034; val_best_f1_score: 0.6682; train_kl_reg_loss: 23543.7055; train_edge_recon_loss: 39065.7656; train_gene_expr_recon_loss: 709675.2361; train_masked_gp_l1_reg_loss: 10114.8260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123848.3932; train_chrom_access_recon_loss: 1329832.6667; train_global_loss: 2236080.5556; train_optim_loss: 2236080.5556; val_kl_reg_loss: 23822.1836; val_edge_recon_loss: 40657.2852; val_gene_expr_recon_loss: 711582.1250; val_masked_gp_l1_reg_loss: 10028.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119317.0938; val_chrom_access_recon_loss: 1335018.8750; val_global_loss: 2240426.0000; val_optim_loss: 2240426.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8637; val_auprc_score: 0.8641; val_best_acc_score: 0.5090; val_best_f1_score: 0.6706; train_kl_reg_loss: 24633.3880; train_edge_recon_loss: 39123.6693; train_gene_expr_recon_loss: 701925.7083; train_masked_gp_l1_reg_loss: 9955.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115778.3247; train_chrom_access_recon_loss: 1331231.2639; train_global_loss: 2222648.0000; train_optim_loss: 2222648.0000; val_kl_reg_loss: 24728.1562; val_edge_recon_loss: 40652.5391; val_gene_expr_recon_loss: 701554.5625; val_masked_gp_l1_reg_loss: 9874.1660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111418.9844; val_chrom_access_recon_loss: 1328747.7500; val_global_loss: 2216976.2500; val_optim_loss: 2216976.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8611; val_auprc_score: 0.8617; val_best_acc_score: 0.5202; val_best_f1_score: 0.6755; train_kl_reg_loss: 25236.8273; train_edge_recon_loss: 39158.4271; train_gene_expr_recon_loss: 691228.0417; train_masked_gp_l1_reg_loss: 9809.3177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108052.9375; train_chrom_access_recon_loss: 1326578.0417; train_global_loss: 2200063.6111; train_optim_loss: 2200063.6111; val_kl_reg_loss: 25034.6797; val_edge_recon_loss: 40642.7734; val_gene_expr_recon_loss: 692753.1250; val_masked_gp_l1_reg_loss: 9721.3027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103932.8125; val_chrom_access_recon_loss: 1323561.6250; val_global_loss: 2195646.2500; val_optim_loss: 2195646.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8571; val_auprc_score: 0.8522; val_best_acc_score: 0.5387; val_best_f1_score: 0.6835; train_kl_reg_loss: 25523.5783; train_edge_recon_loss: 39182.4080; train_gene_expr_recon_loss: 682973.3889; train_masked_gp_l1_reg_loss: 9662.3482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100789.1684; train_chrom_access_recon_loss: 1318968.7500; train_global_loss: 2177099.6667; train_optim_loss: 2177099.6667; val_kl_reg_loss: 25701.3516; val_edge_recon_loss: 40629.0156; val_gene_expr_recon_loss: 685356.0000; val_masked_gp_l1_reg_loss: 9595.4785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96960.3594; val_chrom_access_recon_loss: 1319283.2500; val_global_loss: 2177525.5000; val_optim_loss: 2177525.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8461; val_auprc_score: 0.8468; val_best_acc_score: 0.5616; val_best_f1_score: 0.6930; train_kl_reg_loss: 25788.6931; train_edge_recon_loss: 39198.8194; train_gene_expr_recon_loss: 675881.4375; train_masked_gp_l1_reg_loss: 9542.8496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94066.0799; train_chrom_access_recon_loss: 1320887.6667; train_global_loss: 2165365.5278; train_optim_loss: 2165365.5278; val_kl_reg_loss: 24937.6387; val_edge_recon_loss: 40617.1172; val_gene_expr_recon_loss: 679681.5000; val_masked_gp_l1_reg_loss: 9482.5771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90546.9141; val_chrom_access_recon_loss: 1315808.8750; val_global_loss: 2161074.5000; val_optim_loss: 2161074.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8555; val_auprc_score: 0.8547; val_best_acc_score: 0.5891; val_best_f1_score: 0.7054; train_kl_reg_loss: 25396.2988; train_edge_recon_loss: 39187.9518; train_gene_expr_recon_loss: 672949.9861; train_masked_gp_l1_reg_loss: 9444.1613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87913.0790; train_chrom_access_recon_loss: 1310903.7778; train_global_loss: 2145795.2500; train_optim_loss: 2145795.2500; val_kl_reg_loss: 24600.9590; val_edge_recon_loss: 40599.3477; val_gene_expr_recon_loss: 674853.7500; val_masked_gp_l1_reg_loss: 9393.9678; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84723.4062; val_chrom_access_recon_loss: 1312224.0000; val_global_loss: 2146395.5000; val_optim_loss: 2146395.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8594; val_auprc_score: 0.8566; val_best_acc_score: 0.6221; val_best_f1_score: 0.7211; train_kl_reg_loss: 25128.4188; train_edge_recon_loss: 39170.9401; train_gene_expr_recon_loss: 662437.8125; train_masked_gp_l1_reg_loss: 9362.9079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82333.1554; train_chrom_access_recon_loss: 1298921.3333; train_global_loss: 2117354.5000; train_optim_loss: 2117354.5000; val_kl_reg_loss: 24456.0469; val_edge_recon_loss: 40576.8828; val_gene_expr_recon_loss: 670679.0000; val_masked_gp_l1_reg_loss: 9319.5908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79427.1719; val_chrom_access_recon_loss: 1309454.1250; val_global_loss: 2133912.7500; val_optim_loss: 2133912.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8640; val_auprc_score: 0.8596; val_best_acc_score: 0.6669; val_best_f1_score: 0.7432; train_kl_reg_loss: 24972.7361; train_edge_recon_loss: 39176.1220; train_gene_expr_recon_loss: 665195.1458; train_masked_gp_l1_reg_loss: 9291.4437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77247.3602; train_chrom_access_recon_loss: 1303146.8056; train_global_loss: 2119029.6111; train_optim_loss: 2119029.6111; val_kl_reg_loss: 23503.7266; val_edge_recon_loss: 40544.9492; val_gene_expr_recon_loss: 667912.7500; val_masked_gp_l1_reg_loss: 9251.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74593.6016; val_chrom_access_recon_loss: 1306296.6250; val_global_loss: 2122103.0000; val_optim_loss: 2122103.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8715; val_auprc_score: 0.8677; val_best_acc_score: 0.7072; val_best_f1_score: 0.7653; train_kl_reg_loss: 24543.0990; train_edge_recon_loss: 39157.4327; train_gene_expr_recon_loss: 658745.2014; train_masked_gp_l1_reg_loss: 9232.8904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72610.8003; train_chrom_access_recon_loss: 1300015.3194; train_global_loss: 2104304.7917; train_optim_loss: 2104304.7917; val_kl_reg_loss: 23481.0508; val_edge_recon_loss: 40520.8242; val_gene_expr_recon_loss: 664809.2500; val_masked_gp_l1_reg_loss: 9199.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70194.9688; val_chrom_access_recon_loss: 1303795.5000; val_global_loss: 2112001.5000; val_optim_loss: 2112001.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8822; val_auprc_score: 0.8790; val_best_acc_score: 0.7429; val_best_f1_score: 0.7856; train_kl_reg_loss: 24085.6747; train_edge_recon_loss: 39130.2049; train_gene_expr_recon_loss: 655268.5278; train_masked_gp_l1_reg_loss: 9177.2196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68382.0955; train_chrom_access_recon_loss: 1292641.1389; train_global_loss: 2088684.8889; train_optim_loss: 2088684.8889; val_kl_reg_loss: 23262.3516; val_edge_recon_loss: 40494.1055; val_gene_expr_recon_loss: 662241.0000; val_masked_gp_l1_reg_loss: 9151.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66178.5469; val_chrom_access_recon_loss: 1301365.6250; val_global_loss: 2102693.5000; val_optim_loss: 2102693.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8878; val_auprc_score: 0.8847; val_best_acc_score: 0.7741; val_best_f1_score: 0.8038; train_kl_reg_loss: 23876.8924; train_edge_recon_loss: 39106.4644; train_gene_expr_recon_loss: 650141.2569; train_masked_gp_l1_reg_loss: 9135.2436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64521.9653; train_chrom_access_recon_loss: 1290683.2917; train_global_loss: 2077465.1389; train_optim_loss: 2077465.1389; val_kl_reg_loss: 22819.6934; val_edge_recon_loss: 40456.8477; val_gene_expr_recon_loss: 660220.7500; val_masked_gp_l1_reg_loss: 9106.9814; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62498.6133; val_chrom_access_recon_loss: 1298903.3750; val_global_loss: 2094006.2500; val_optim_loss: 2094006.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8949; val_auprc_score: 0.8879; val_best_acc_score: 0.8005; val_best_f1_score: 0.8188; train_kl_reg_loss: 23431.0675; train_edge_recon_loss: 39062.1102; train_gene_expr_recon_loss: 653429.6944; train_masked_gp_l1_reg_loss: 9091.0615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60972.8255; train_chrom_access_recon_loss: 1291501.1111; train_global_loss: 2077487.8750; train_optim_loss: 2077487.8750; val_kl_reg_loss: 22257.3594; val_edge_recon_loss: 40391.5391; val_gene_expr_recon_loss: 658545.1875; val_masked_gp_l1_reg_loss: 9075.4111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59112.7500; val_chrom_access_recon_loss: 1296657.2500; val_global_loss: 2086039.5000; val_optim_loss: 2086039.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9041; val_auprc_score: 0.8967; val_best_acc_score: 0.8266; val_best_f1_score: 0.8348; train_kl_reg_loss: 23072.0391; train_edge_recon_loss: 39010.9714; train_gene_expr_recon_loss: 649141.4097; train_masked_gp_l1_reg_loss: 9065.1715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57714.7253; train_chrom_access_recon_loss: 1293625.9306; train_global_loss: 2071630.2778; train_optim_loss: 2071630.2778; val_kl_reg_loss: 21542.0586; val_edge_recon_loss: 40332.4375; val_gene_expr_recon_loss: 657563.8750; val_masked_gp_l1_reg_loss: 9045.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55998.7812; val_chrom_access_recon_loss: 1298362.5000; val_global_loss: 2082845.1250; val_optim_loss: 2082845.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9124; val_auprc_score: 0.9013; val_best_acc_score: 0.8418; val_best_f1_score: 0.8461; train_kl_reg_loss: 22607.7398; train_edge_recon_loss: 38952.5191; train_gene_expr_recon_loss: 648802.1250; train_masked_gp_l1_reg_loss: 9040.7582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54709.0456; train_chrom_access_recon_loss: 1290096.3472; train_global_loss: 2064208.5278; train_optim_loss: 2064208.5278; val_kl_reg_loss: 22388.3359; val_edge_recon_loss: 40289.7852; val_gene_expr_recon_loss: 654711.8125; val_masked_gp_l1_reg_loss: 9033.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53125.8516; val_chrom_access_recon_loss: 1295684.8750; val_global_loss: 2075234.0000; val_optim_loss: 2075234.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9178; val_auprc_score: 0.9071; val_best_acc_score: 0.8425; val_best_f1_score: 0.8399; train_kl_reg_loss: 22478.2144; train_edge_recon_loss: 38883.4271; train_gene_expr_recon_loss: 648884.0694; train_masked_gp_l1_reg_loss: 9026.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51927.4705; train_chrom_access_recon_loss: 1291493.2222; train_global_loss: 2062692.9583; train_optim_loss: 2062692.9583; val_kl_reg_loss: 20940.6016; val_edge_recon_loss: 40201.6289; val_gene_expr_recon_loss: 654374.1250; val_masked_gp_l1_reg_loss: 9017.8623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50468.7461; val_chrom_access_recon_loss: 1293539.2500; val_global_loss: 2068542.2500; val_optim_loss: 2068542.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9211; val_auprc_score: 0.9071; val_best_acc_score: 0.8441; val_best_f1_score: 0.8396; train_kl_reg_loss: 22024.2882; train_edge_recon_loss: 38821.5009; train_gene_expr_recon_loss: 647924.7222; train_masked_gp_l1_reg_loss: 9016.6705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49368.3555; train_chrom_access_recon_loss: 1288125.2361; train_global_loss: 2055280.7917; train_optim_loss: 2055280.7917; val_kl_reg_loss: 21403.1953; val_edge_recon_loss: 40139.7031; val_gene_expr_recon_loss: 652076.1250; val_masked_gp_l1_reg_loss: 9010.0166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48011.1797; val_chrom_access_recon_loss: 1290983.2500; val_global_loss: 2061623.5000; val_optim_loss: 2061623.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9251; val_auprc_score: 0.9135; val_best_acc_score: 0.8375; val_best_f1_score: 0.8287; train_kl_reg_loss: 21931.4191; train_edge_recon_loss: 38750.8043; train_gene_expr_recon_loss: 645694.0972; train_masked_gp_l1_reg_loss: 9001.0878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46986.8776; train_chrom_access_recon_loss: 1286467.5694; train_global_loss: 2048831.8333; train_optim_loss: 2048831.8333; val_kl_reg_loss: 20772.7578; val_edge_recon_loss: 40055.3008; val_gene_expr_recon_loss: 651330.8750; val_masked_gp_l1_reg_loss: 8991.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45723.7344; val_chrom_access_recon_loss: 1288769.1250; val_global_loss: 2055643.5000; val_optim_loss: 2055643.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9244; val_auprc_score: 0.9113; val_best_acc_score: 0.8325; val_best_f1_score: 0.8213; train_kl_reg_loss: 21625.0443; train_edge_recon_loss: 38659.1806; train_gene_expr_recon_loss: 645143.3125; train_masked_gp_l1_reg_loss: 8984.2540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44777.1606; train_chrom_access_recon_loss: 1283579.5972; train_global_loss: 2042768.5556; train_optim_loss: 2042768.5556; val_kl_reg_loss: 21310.4375; val_edge_recon_loss: 39966.6367; val_gene_expr_recon_loss: 649665.1250; val_masked_gp_l1_reg_loss: 8970.7607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43603.9141; val_chrom_access_recon_loss: 1286618.7500; val_global_loss: 2050135.6250; val_optim_loss: 2050135.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9267; val_auprc_score: 0.9159; val_best_acc_score: 0.8185; val_best_f1_score: 0.8254; train_kl_reg_loss: 21575.5404; train_edge_recon_loss: 38606.2669; train_gene_expr_recon_loss: 643498.0069; train_masked_gp_l1_reg_loss: 8967.0330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42719.3255; train_chrom_access_recon_loss: 1280001.6806; train_global_loss: 2035367.8333; train_optim_loss: 2035367.8333; val_kl_reg_loss: 20192.8359; val_edge_recon_loss: 39850.3945; val_gene_expr_recon_loss: 649667.2500; val_masked_gp_l1_reg_loss: 8958.0381; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41631.8359; val_chrom_access_recon_loss: 1284764.2500; val_global_loss: 2045064.6250; val_optim_loss: 2045064.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9255; val_auprc_score: 0.9156; val_best_acc_score: 0.8413; val_best_f1_score: 0.8555; train_kl_reg_loss: 18478.0115; train_edge_recon_loss: 40237.9527; train_gene_expr_recon_loss: 941139.4653; train_masked_gp_l1_reg_loss: 9111.4119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40654.0898; train_chrom_access_recon_loss: 1360337.6944; train_global_loss: 2409958.6667; train_optim_loss: 2409958.6667; val_kl_reg_loss: 13473.7812; val_edge_recon_loss: 40430.2852; val_gene_expr_recon_loss: 939259.1250; val_masked_gp_l1_reg_loss: 9425.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39349.2812; val_chrom_access_recon_loss: 1359891.3750; val_global_loss: 2401829.0000; val_optim_loss: 2401829.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9267; val_auprc_score: 0.9170; val_best_acc_score: 0.8451; val_best_f1_score: 0.8589; train_kl_reg_loss: 15953.4742; train_edge_recon_loss: 40255.6701; train_gene_expr_recon_loss: 927295.1667; train_masked_gp_l1_reg_loss: 9707.2891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38289.1471; train_chrom_access_recon_loss: 1354668.9028; train_global_loss: 2386169.6944; train_optim_loss: 2386169.6944; val_kl_reg_loss: 13573.7344; val_edge_recon_loss: 40429.8711; val_gene_expr_recon_loss: 931432.3750; val_masked_gp_l1_reg_loss: 10026.2363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36991.6484; val_chrom_access_recon_loss: 1357026.1250; val_global_loss: 2389480.0000; val_optim_loss: 2389480.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9294; val_auprc_score: 0.9230; val_best_acc_score: 0.8436; val_best_f1_score: 0.8574; train_kl_reg_loss: 15477.5383; train_edge_recon_loss: 40267.2274; train_gene_expr_recon_loss: 921671.8889; train_masked_gp_l1_reg_loss: 10218.0409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36013.5898; train_chrom_access_recon_loss: 1356349.4028; train_global_loss: 2379997.6944; train_optim_loss: 2379997.6944; val_kl_reg_loss: 13763.7578; val_edge_recon_loss: 40422.9102; val_gene_expr_recon_loss: 925473.7500; val_masked_gp_l1_reg_loss: 10412.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34829.3438; val_chrom_access_recon_loss: 1354588.1250; val_global_loss: 2379490.0000; val_optim_loss: 2379490.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9321; val_auprc_score: 0.9242; val_best_acc_score: 0.8601; val_best_f1_score: 0.8699; train_kl_reg_loss: 15019.0535; train_edge_recon_loss: 40260.6302; train_gene_expr_recon_loss: 920345.3542; train_masked_gp_l1_reg_loss: 10517.5898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33942.9440; train_chrom_access_recon_loss: 1352386.6250; train_global_loss: 2372472.2222; train_optim_loss: 2372472.2222; val_kl_reg_loss: 13484.2793; val_edge_recon_loss: 40410.1055; val_gene_expr_recon_loss: 921227.3750; val_masked_gp_l1_reg_loss: 10623.9600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32870.9492; val_chrom_access_recon_loss: 1352710.8750; val_global_loss: 2371327.5000; val_optim_loss: 2371327.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9288; val_auprc_score: 0.9190; val_best_acc_score: 0.8496; val_best_f1_score: 0.8617; train_kl_reg_loss: 14867.3313; train_edge_recon_loss: 40262.1016; train_gene_expr_recon_loss: 912776.6944; train_masked_gp_l1_reg_loss: 10554.1107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32707.4674; train_chrom_access_recon_loss: 1350549.4861; train_global_loss: 2361717.1667; train_optim_loss: 2361717.1667; val_kl_reg_loss: 13755.7031; val_edge_recon_loss: 40414.6680; val_gene_expr_recon_loss: 920688.9375; val_masked_gp_l1_reg_loss: 10498.6309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32524.6133; val_chrom_access_recon_loss: 1352828.7500; val_global_loss: 2370711.2500; val_optim_loss: 2370711.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9319; val_auprc_score: 0.9237; val_best_acc_score: 0.8572; val_best_f1_score: 0.8675; train_kl_reg_loss: 14936.0511; train_edge_recon_loss: 40257.9653; train_gene_expr_recon_loss: 910775.8125; train_masked_gp_l1_reg_loss: 10485.8261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32414.0705; train_chrom_access_recon_loss: 1345388.2639; train_global_loss: 2354257.9722; train_optim_loss: 2354257.9722; val_kl_reg_loss: 13609.2891; val_edge_recon_loss: 40402.3828; val_gene_expr_recon_loss: 920417.3125; val_masked_gp_l1_reg_loss: 10462.5723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32271.8086; val_chrom_access_recon_loss: 1352542.5000; val_global_loss: 2369706.0000; val_optim_loss: 2369706.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9308; val_auprc_score: 0.9215; val_best_acc_score: 0.8557; val_best_f1_score: 0.8663; train_kl_reg_loss: 14819.6220; train_edge_recon_loss: 40253.3273; train_gene_expr_recon_loss: 909345.3819; train_masked_gp_l1_reg_loss: 10451.9291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32168.5714; train_chrom_access_recon_loss: 1345880.6667; train_global_loss: 2352919.5278; train_optim_loss: 2352919.5278; val_kl_reg_loss: 13640.7148; val_edge_recon_loss: 40403.0312; val_gene_expr_recon_loss: 920046.0000; val_masked_gp_l1_reg_loss: 10440.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32042.1133; val_chrom_access_recon_loss: 1352449.2500; val_global_loss: 2369021.2500; val_optim_loss: 2369021.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9296; val_auprc_score: 0.9212; val_best_acc_score: 0.8544; val_best_f1_score: 0.8649; train_kl_reg_loss: 14875.2651; train_edge_recon_loss: 40250.2943; train_gene_expr_recon_loss: 908927.8264; train_masked_gp_l1_reg_loss: 10433.4485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31945.8433; train_chrom_access_recon_loss: 1348696.6389; train_global_loss: 2355129.3611; train_optim_loss: 2355129.3611; val_kl_reg_loss: 13618.0371; val_edge_recon_loss: 40396.9570; val_gene_expr_recon_loss: 919661.7500; val_masked_gp_l1_reg_loss: 10426.1826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31830.2344; val_chrom_access_recon_loss: 1352324.8750; val_global_loss: 2368258.0000; val_optim_loss: 2368258.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9225
val AUPRC score: 0.9089
val best accuracy score: 0.8366
val best F1 score: 0.8526
val target rna MSE score: 3.9768
val source rna MSE score: 3.2838
val target atac MSE score: 0.1360
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
