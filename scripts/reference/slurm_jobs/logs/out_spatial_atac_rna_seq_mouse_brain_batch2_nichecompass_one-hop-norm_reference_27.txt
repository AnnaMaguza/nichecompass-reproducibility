[True]
Run timestamp: 24072023_162846_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9016; val_auprc_score: 0.9101; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12262.4974; train_edge_recon_loss: 356857.3021; train_gene_expr_recon_loss: 31445549.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 109871646.2222; train_global_loss: 141686316.4444; train_optim_loss: 141686316.4444; val_kl_reg_loss: 21224.5215; val_edge_recon_loss: 406604.3438; val_gene_expr_recon_loss: 30243268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107095920.0000; val_global_loss: 137767008.0000; val_optim_loss: 137767008.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8960; val_auprc_score: 0.9016; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 29811.1873; train_edge_recon_loss: 382559.1910; train_gene_expr_recon_loss: 28676730.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106504213.3333; train_global_loss: 135593313.7778; train_optim_loss: 135593313.7778; val_kl_reg_loss: 40768.3320; val_edge_recon_loss: 406615.7500; val_gene_expr_recon_loss: 27867900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104894624.0000; val_global_loss: 133209904.0000; val_optim_loss: 133209904.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8871; val_auprc_score: 0.8921; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 58619.1385; train_edge_recon_loss: 397488.5764; train_gene_expr_recon_loss: 26235015.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103626378.6667; train_global_loss: 130317500.4444; train_optim_loss: 130317500.4444; val_kl_reg_loss: 80924.8594; val_edge_recon_loss: 406616.3750; val_gene_expr_recon_loss: 25454976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102616792.0000; val_global_loss: 128559312.0000; val_optim_loss: 128559312.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8791; val_auprc_score: 0.8822; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 100807.1458; train_edge_recon_loss: 403218.2917; train_gene_expr_recon_loss: 24312183.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101657953.7778; train_global_loss: 126474162.6667; train_optim_loss: 126474162.6667; val_kl_reg_loss: 113521.4688; val_edge_recon_loss: 406614.5000; val_gene_expr_recon_loss: 24101634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100635640.0000; val_global_loss: 125257408.0000; val_optim_loss: 125257408.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8760; val_auprc_score: 0.8761; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 126826.4453; train_edge_recon_loss: 405121.9931; train_gene_expr_recon_loss: 23273665.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100531710.2222; train_global_loss: 124337324.4444; train_optim_loss: 124337324.4444; val_kl_reg_loss: 138817.3281; val_edge_recon_loss: 406609.5938; val_gene_expr_recon_loss: 23219626.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99826248.0000; val_global_loss: 123591296.0000; val_optim_loss: 123591296.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8749; val_auprc_score: 0.8680; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 147169.2257; train_edge_recon_loss: 405689.6910; train_gene_expr_recon_loss: 22341836.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98528435.5556; train_global_loss: 121423130.6667; train_optim_loss: 121423130.6667; val_kl_reg_loss: 154342.0938; val_edge_recon_loss: 406598.5938; val_gene_expr_recon_loss: 22604592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99091400.0000; val_global_loss: 122256928.0000; val_optim_loss: 122256928.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8838; val_auprc_score: 0.8786; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 159733.5052; train_edge_recon_loss: 405807.7049; train_gene_expr_recon_loss: 21840680.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98319640.0000; train_global_loss: 120725862.2222; train_optim_loss: 120725862.2222; val_kl_reg_loss: 160951.1562; val_edge_recon_loss: 406571.8750; val_gene_expr_recon_loss: 22212202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98640640.0000; val_global_loss: 121420368.0000; val_optim_loss: 121420368.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8712; val_auprc_score: 0.8560; val_best_acc_score: 0.5026; val_best_f1_score: 0.6678; train_kl_reg_loss: 168296.4097; train_edge_recon_loss: 405801.9097; train_gene_expr_recon_loss: 21563448.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98246112.0000; train_global_loss: 120383660.4444; train_optim_loss: 120383660.4444; val_kl_reg_loss: 165713.8594; val_edge_recon_loss: 406527.7812; val_gene_expr_recon_loss: 21980340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98435856.0000; val_global_loss: 120988440.0000; val_optim_loss: 120988440.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8691; val_auprc_score: 0.8554; val_best_acc_score: 0.5092; val_best_f1_score: 0.6707; train_kl_reg_loss: 169513.0156; train_edge_recon_loss: 405900.8819; train_gene_expr_recon_loss: 21338660.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97491425.7778; train_global_loss: 119405499.5556; train_optim_loss: 119405499.5556; val_kl_reg_loss: 170489.5000; val_edge_recon_loss: 406466.4688; val_gene_expr_recon_loss: 21790968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98097480.0000; val_global_loss: 120465408.0000; val_optim_loss: 120465408.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8606; val_auprc_score: 0.8458; val_best_acc_score: 0.5191; val_best_f1_score: 0.6752; train_kl_reg_loss: 172409.6059; train_edge_recon_loss: 405867.0764; train_gene_expr_recon_loss: 21151936.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97418616.8889; train_global_loss: 119148829.3333; train_optim_loss: 119148829.3333; val_kl_reg_loss: 168593.6094; val_edge_recon_loss: 406404.2500; val_gene_expr_recon_loss: 21688618.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97766552.0000; val_global_loss: 120030168.0000; val_optim_loss: 120030168.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8556; val_auprc_score: 0.8412; val_best_acc_score: 0.5368; val_best_f1_score: 0.6831; train_kl_reg_loss: 172031.3490; train_edge_recon_loss: 405768.9722; train_gene_expr_recon_loss: 21105557.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97513540.4444; train_global_loss: 119196897.7778; train_optim_loss: 119196897.7778; val_kl_reg_loss: 167462.3750; val_edge_recon_loss: 406325.4375; val_gene_expr_recon_loss: 21592982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97592048.0000; val_global_loss: 119758816.0000; val_optim_loss: 119758816.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8561; val_auprc_score: 0.8465; val_best_acc_score: 0.5649; val_best_f1_score: 0.6960; train_kl_reg_loss: 171494.3507; train_edge_recon_loss: 405664.0347; train_gene_expr_recon_loss: 21094886.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97491189.3333; train_global_loss: 119163235.5556; train_optim_loss: 119163235.5556; val_kl_reg_loss: 161463.8750; val_edge_recon_loss: 406200.3750; val_gene_expr_recon_loss: 21516394.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97492512.0000; val_global_loss: 119576568.0000; val_optim_loss: 119576568.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8661; val_auprc_score: 0.8622; val_best_acc_score: 0.5905; val_best_f1_score: 0.7080; train_kl_reg_loss: 167795.2240; train_edge_recon_loss: 405526.9514; train_gene_expr_recon_loss: 20928548.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97218304.0000; train_global_loss: 118720176.0000; train_optim_loss: 118720176.0000; val_kl_reg_loss: 163280.5625; val_edge_recon_loss: 406091.7188; val_gene_expr_recon_loss: 21475930.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97427864.0000; val_global_loss: 119473168.0000; val_optim_loss: 119473168.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8772; val_auprc_score: 0.8660; val_best_acc_score: 0.6252; val_best_f1_score: 0.7251; train_kl_reg_loss: 165625.1510; train_edge_recon_loss: 405378.3194; train_gene_expr_recon_loss: 20863936.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96860074.6667; train_global_loss: 118295014.2222; train_optim_loss: 118295014.2222; val_kl_reg_loss: 163783.9062; val_edge_recon_loss: 405897.2812; val_gene_expr_recon_loss: 21419318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97276744.0000; val_global_loss: 119265744.0000; val_optim_loss: 119265744.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8901; val_auprc_score: 0.8791; val_best_acc_score: 0.6846; val_best_f1_score: 0.7568; train_kl_reg_loss: 164527.2812; train_edge_recon_loss: 405129.9028; train_gene_expr_recon_loss: 20914480.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97254127.1111; train_global_loss: 118738266.6667; train_optim_loss: 118738266.6667; val_kl_reg_loss: 157612.9219; val_edge_recon_loss: 405558.5625; val_gene_expr_recon_loss: 21390070.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97271680.0000; val_global_loss: 119224920.0000; val_optim_loss: 119224920.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8905; val_auprc_score: 0.8770; val_best_acc_score: 0.7193; val_best_f1_score: 0.7759; train_kl_reg_loss: 160675.4878; train_edge_recon_loss: 404723.4479; train_gene_expr_recon_loss: 20800515.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96712848.8889; train_global_loss: 118078763.5556; train_optim_loss: 118078763.5556; val_kl_reg_loss: 155306.7500; val_edge_recon_loss: 405233.2188; val_gene_expr_recon_loss: 21306614.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96865072.0000; val_global_loss: 118732224.0000; val_optim_loss: 118732224.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8945; val_auprc_score: 0.8859; val_best_acc_score: 0.7518; val_best_f1_score: 0.7948; train_kl_reg_loss: 159102.8698; train_edge_recon_loss: 404413.3299; train_gene_expr_recon_loss: 20881212.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96543396.4444; train_global_loss: 117988127.1111; train_optim_loss: 117988127.1111; val_kl_reg_loss: 154333.7500; val_edge_recon_loss: 404840.3438; val_gene_expr_recon_loss: 21300900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97058560.0000; val_global_loss: 118918632.0000; val_optim_loss: 118918632.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9043; val_auprc_score: 0.8936; val_best_acc_score: 0.7824; val_best_f1_score: 0.8131; train_kl_reg_loss: 157436.0104; train_edge_recon_loss: 404044.2292; train_gene_expr_recon_loss: 20704931.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96603909.3333; train_global_loss: 117870322.6667; train_optim_loss: 117870322.6667; val_kl_reg_loss: 147887.5312; val_edge_recon_loss: 404337.0000; val_gene_expr_recon_loss: 21240426.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96785384.0000; val_global_loss: 118578032.0000; val_optim_loss: 118578032.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9069; val_auprc_score: 0.8993; val_best_acc_score: 0.7991; val_best_f1_score: 0.8229; train_kl_reg_loss: 155069.1042; train_edge_recon_loss: 403568.4826; train_gene_expr_recon_loss: 20676969.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96468066.6667; train_global_loss: 117703673.7778; train_optim_loss: 117703673.7778; val_kl_reg_loss: 145936.3125; val_edge_recon_loss: 403883.1562; val_gene_expr_recon_loss: 21219086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96774176.0000; val_global_loss: 118543080.0000; val_optim_loss: 118543080.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9118; val_auprc_score: 0.9024; val_best_acc_score: 0.8143; val_best_f1_score: 0.8324; train_kl_reg_loss: 153114.1024; train_edge_recon_loss: 403101.9375; train_gene_expr_recon_loss: 20581412.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96663446.2222; train_global_loss: 117801075.5556; train_optim_loss: 117801075.5556; val_kl_reg_loss: 143408.6875; val_edge_recon_loss: 403442.1562; val_gene_expr_recon_loss: 21172846.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96590664.0000; val_global_loss: 118310360.0000; val_optim_loss: 118310360.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9139; val_auprc_score: 0.9003; val_best_acc_score: 0.8282; val_best_f1_score: 0.8418; train_kl_reg_loss: 151237.9462; train_edge_recon_loss: 402606.2361; train_gene_expr_recon_loss: 20712647.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96560227.5556; train_global_loss: 117826718.2222; train_optim_loss: 117826718.2222; val_kl_reg_loss: 141075.1406; val_edge_recon_loss: 402847.1250; val_gene_expr_recon_loss: 21174778.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96751960.0000; val_global_loss: 118470656.0000; val_optim_loss: 118470656.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9161; val_auprc_score: 0.9027; val_best_acc_score: 0.8366; val_best_f1_score: 0.8471; train_kl_reg_loss: 149528.7552; train_edge_recon_loss: 402084.4167; train_gene_expr_recon_loss: 20564034.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96299371.5556; train_global_loss: 117415021.3333; train_optim_loss: 117415021.3333; val_kl_reg_loss: 138492.7812; val_edge_recon_loss: 402346.5625; val_gene_expr_recon_loss: 21144612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96507152.0000; val_global_loss: 118192608.0000; val_optim_loss: 118192608.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9189; val_auprc_score: 0.9048; val_best_acc_score: 0.8398; val_best_f1_score: 0.8485; train_kl_reg_loss: 147685.5417; train_edge_recon_loss: 401616.0451; train_gene_expr_recon_loss: 20514961.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95944576.8889; train_global_loss: 117008839.1111; train_optim_loss: 117008839.1111; val_kl_reg_loss: 139207.8281; val_edge_recon_loss: 401903.5625; val_gene_expr_recon_loss: 21109606.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96459160.0000; val_global_loss: 118109880.0000; val_optim_loss: 118109880.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9197; val_auprc_score: 0.9058; val_best_acc_score: 0.8425; val_best_f1_score: 0.8495; train_kl_reg_loss: 145742.6719; train_edge_recon_loss: 400998.3160; train_gene_expr_recon_loss: 20555686.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95721911.1111; train_global_loss: 116824338.6667; train_optim_loss: 116824338.6667; val_kl_reg_loss: 139539.0312; val_edge_recon_loss: 401291.1562; val_gene_expr_recon_loss: 21075024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96232096.0000; val_global_loss: 117847952.0000; val_optim_loss: 117847952.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9180; val_auprc_score: 0.9028; val_best_acc_score: 0.8399; val_best_f1_score: 0.8449; train_kl_reg_loss: 144214.7917; train_edge_recon_loss: 400460.3438; train_gene_expr_recon_loss: 20657318.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96224289.7778; train_global_loss: 117426282.6667; train_optim_loss: 117426282.6667; val_kl_reg_loss: 134717.8594; val_edge_recon_loss: 400476.9375; val_gene_expr_recon_loss: 21045452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96147040.0000; val_global_loss: 117727688.0000; val_optim_loss: 117727688.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9219; val_auprc_score: 0.9027; val_best_acc_score: 0.8463; val_best_f1_score: 0.8509; train_kl_reg_loss: 144951.5191; train_edge_recon_loss: 400504.6111; train_gene_expr_recon_loss: 20977767.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97008973.3333; train_global_loss: 118532196.4444; train_optim_loss: 118532196.4444; val_kl_reg_loss: 127824.1719; val_edge_recon_loss: 400443.3125; val_gene_expr_recon_loss: 21318250.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96658912.0000; val_global_loss: 118505432.0000; val_optim_loss: 118505432.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9222; val_auprc_score: 0.9093; val_best_acc_score: 0.8433; val_best_f1_score: 0.8475; train_kl_reg_loss: 142864.1545; train_edge_recon_loss: 399878.0139; train_gene_expr_recon_loss: 20760866.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95903589.3333; train_global_loss: 117207198.2222; train_optim_loss: 117207198.2222; val_kl_reg_loss: 126297.3594; val_edge_recon_loss: 400201.7500; val_gene_expr_recon_loss: 21294554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96540400.0000; val_global_loss: 118361456.0000; val_optim_loss: 118361456.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9216; val_auprc_score: 0.9068; val_best_acc_score: 0.8432; val_best_f1_score: 0.8464; train_kl_reg_loss: 139175.5651; train_edge_recon_loss: 399512.6250; train_gene_expr_recon_loss: 20758356.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96375262.2222; train_global_loss: 117672306.6667; train_optim_loss: 117672306.6667; val_kl_reg_loss: 125763.0547; val_edge_recon_loss: 399806.3438; val_gene_expr_recon_loss: 21274908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96583144.0000; val_global_loss: 118383624.0000; val_optim_loss: 118383624.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9246; val_auprc_score: 0.9071; val_best_acc_score: 0.8476; val_best_f1_score: 0.8484; train_kl_reg_loss: 136519.8160; train_edge_recon_loss: 398856.5312; train_gene_expr_recon_loss: 20901174.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96300967.1111; train_global_loss: 117737517.3333; train_optim_loss: 117737517.3333; val_kl_reg_loss: 120340.6875; val_edge_recon_loss: 399014.9375; val_gene_expr_recon_loss: 21384688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96604912.0000; val_global_loss: 118508960.0000; val_optim_loss: 118508960.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9277; val_auprc_score: 0.9117; val_best_acc_score: 0.8508; val_best_f1_score: 0.8507; train_kl_reg_loss: 134429.4080; train_edge_recon_loss: 398490.1528; train_gene_expr_recon_loss: 20819503.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95911813.3333; train_global_loss: 117264235.5556; train_optim_loss: 117264235.5556; val_kl_reg_loss: 117980.0625; val_edge_recon_loss: 398660.0312; val_gene_expr_recon_loss: 21372752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96487440.0000; val_global_loss: 118376832.0000; val_optim_loss: 118376832.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9268; val_auprc_score: 0.9107; val_best_acc_score: 0.8499; val_best_f1_score: 0.8501; train_kl_reg_loss: 134573.9462; train_edge_recon_loss: 398445.3681; train_gene_expr_recon_loss: 20901288.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96015027.5556; train_global_loss: 117449334.2222; train_optim_loss: 117449334.2222; val_kl_reg_loss: 120194.6406; val_edge_recon_loss: 398963.4062; val_gene_expr_recon_loss: 21367640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96543168.0000; val_global_loss: 118429968.0000; val_optim_loss: 118429968.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9270; val_auprc_score: 0.9148; val_best_acc_score: 0.8469; val_best_f1_score: 0.8475; train_kl_reg_loss: 135924.7882; train_edge_recon_loss: 398457.9375; train_gene_expr_recon_loss: 20844186.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95828017.7778; train_global_loss: 117206585.7778; train_optim_loss: 117206585.7778; val_kl_reg_loss: 120392.4375; val_edge_recon_loss: 398867.6562; val_gene_expr_recon_loss: 21349762.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96478368.0000; val_global_loss: 118347392.0000; val_optim_loss: 118347392.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9189; val_auprc_score: 0.9042; val_best_acc_score: 0.8378; val_best_f1_score: 0.8394; train_kl_reg_loss: 135626.1510; train_edge_recon_loss: 398479.0312; train_gene_expr_recon_loss: 20825855.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95914631.1111; train_global_loss: 117274593.7778; train_optim_loss: 117274593.7778; val_kl_reg_loss: 119353.5312; val_edge_recon_loss: 398961.8438; val_gene_expr_recon_loss: 21339202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96406888.0000; val_global_loss: 118264408.0000; val_optim_loss: 118264408.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 48 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9162
Val AUPRC score: 0.9030
Val best accuracy score: 0.8383
Val best F1 score: 0.8454
Val gene expr MSE score: 0.4819
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
