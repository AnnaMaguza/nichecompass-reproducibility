[True]
Run timestamp: 09102023_202712_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7193; val_auprc_score: 0.6889; val_best_acc_score: 0.5024; val_best_f1_score: 0.6676; train_kl_reg_loss: 49923.0432; train_edge_recon_loss: 3505371.3220; train_gene_expr_recon_loss: 13973248.9242; train_masked_gp_l1_reg_loss: 44744.7882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5555197.3106; train_chrom_access_recon_loss: 1005795.2803; train_global_loss: 24134280.6667; train_optim_loss: 24134280.6667; val_kl_reg_loss: 70707.6133; val_edge_recon_loss: 4064767.1562; val_gene_expr_recon_loss: 13110285.7500; val_masked_gp_l1_reg_loss: 51294.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2565907.7500; val_chrom_access_recon_loss: 956954.4141; val_global_loss: 20819916.7500; val_optim_loss: 20819916.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7313; val_auprc_score: 0.7066; val_best_acc_score: 0.6620; val_best_f1_score: 0.7156; train_kl_reg_loss: 88004.9164; train_edge_recon_loss: 3511940.5947; train_gene_expr_recon_loss: 12849050.7121; train_masked_gp_l1_reg_loss: 52787.4657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1184313.0762; train_chrom_access_recon_loss: 954314.0227; train_global_loss: 18640410.8788; train_optim_loss: 18640410.8788; val_kl_reg_loss: 87749.7939; val_edge_recon_loss: 4052257.6875; val_gene_expr_recon_loss: 12789596.8750; val_masked_gp_l1_reg_loss: 54692.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 469537.4688; val_chrom_access_recon_loss: 937368.0078; val_global_loss: 18391202.5000; val_optim_loss: 18391202.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7642; val_auprc_score: 0.7339; val_best_acc_score: 0.6988; val_best_f1_score: 0.7351; train_kl_reg_loss: 79394.7662; train_edge_recon_loss: 3500938.3788; train_gene_expr_recon_loss: 12694478.6818; train_masked_gp_l1_reg_loss: 56240.2348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 310715.9183; train_chrom_access_recon_loss: 947770.8513; train_global_loss: 17589538.7879; train_optim_loss: 17589538.7879; val_kl_reg_loss: 78899.9023; val_edge_recon_loss: 3842958.2188; val_gene_expr_recon_loss: 12781614.2500; val_masked_gp_l1_reg_loss: 58213.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215254.5625; val_chrom_access_recon_loss: 931712.9297; val_global_loss: 17908653.7500; val_optim_loss: 17908653.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7938; val_auprc_score: 0.7722; val_best_acc_score: 0.7238; val_best_f1_score: 0.7450; train_kl_reg_loss: 62632.8239; train_edge_recon_loss: 3255298.7348; train_gene_expr_recon_loss: 12645126.9394; train_masked_gp_l1_reg_loss: 61322.1759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176899.1998; train_chrom_access_recon_loss: 944447.9195; train_global_loss: 17145727.7576; train_optim_loss: 17145727.7576; val_kl_reg_loss: 86734.1924; val_edge_recon_loss: 3162316.9062; val_gene_expr_recon_loss: 12757929.6250; val_masked_gp_l1_reg_loss: 64865.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151419.4688; val_chrom_access_recon_loss: 928103.2734; val_global_loss: 17151369.0000; val_optim_loss: 17151369.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8769; val_auprc_score: 0.8482; val_best_acc_score: 0.8036; val_best_f1_score: 0.8174; train_kl_reg_loss: 88859.2365; train_edge_recon_loss: 2938367.2159; train_gene_expr_recon_loss: 12561119.4545; train_masked_gp_l1_reg_loss: 67601.7731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133038.5021; train_chrom_access_recon_loss: 937873.1127; train_global_loss: 16726859.3030; train_optim_loss: 16726859.3030; val_kl_reg_loss: 95568.4746; val_edge_recon_loss: 2910290.9062; val_gene_expr_recon_loss: 12601143.5000; val_masked_gp_l1_reg_loss: 70114.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122935.2500; val_chrom_access_recon_loss: 921930.5156; val_global_loss: 16721982.5000; val_optim_loss: 16721982.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8906; val_auprc_score: 0.8537; val_best_acc_score: 0.8278; val_best_f1_score: 0.8411; train_kl_reg_loss: 105274.6999; train_edge_recon_loss: 2841080.0720; train_gene_expr_recon_loss: 12467355.9091; train_masked_gp_l1_reg_loss: 71495.5727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118976.7866; train_chrom_access_recon_loss: 931553.3134; train_global_loss: 16535736.2727; train_optim_loss: 16535736.2727; val_kl_reg_loss: 100613.4492; val_edge_recon_loss: 2832106.5938; val_gene_expr_recon_loss: 12434500.5000; val_masked_gp_l1_reg_loss: 72742.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113779.1328; val_chrom_access_recon_loss: 915928.1953; val_global_loss: 16469670.8750; val_optim_loss: 16469670.8750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8979; val_auprc_score: 0.8656; val_best_acc_score: 0.8345; val_best_f1_score: 0.8470; train_kl_reg_loss: 103166.2817; train_edge_recon_loss: 2829598.6061; train_gene_expr_recon_loss: 12380713.1515; train_masked_gp_l1_reg_loss: 74089.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108051.5574; train_chrom_access_recon_loss: 926118.2377; train_global_loss: 16421736.8939; train_optim_loss: 16421736.8939; val_kl_reg_loss: 102073.4082; val_edge_recon_loss: 2844895.6875; val_gene_expr_recon_loss: 12509868.2500; val_masked_gp_l1_reg_loss: 74995.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103553.5469; val_chrom_access_recon_loss: 915202.7422; val_global_loss: 16550590.0000; val_optim_loss: 16550590.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8983; val_auprc_score: 0.8666; val_best_acc_score: 0.8364; val_best_f1_score: 0.8507; train_kl_reg_loss: 99501.5123; train_edge_recon_loss: 2832233.8220; train_gene_expr_recon_loss: 12317934.1970; train_masked_gp_l1_reg_loss: 75897.4737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101922.0598; train_chrom_access_recon_loss: 921588.1553; train_global_loss: 16349077.3333; train_optim_loss: 16349077.3333; val_kl_reg_loss: 97336.2422; val_edge_recon_loss: 2819161.4688; val_gene_expr_recon_loss: 12335028.3750; val_masked_gp_l1_reg_loss: 76828.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100390.3906; val_chrom_access_recon_loss: 902778.3594; val_global_loss: 16331523.2500; val_optim_loss: 16331523.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8954; val_auprc_score: 0.8625; val_best_acc_score: 0.8375; val_best_f1_score: 0.8507; train_kl_reg_loss: 98700.8220; train_edge_recon_loss: 2801271.0189; train_gene_expr_recon_loss: 12284244.6515; train_masked_gp_l1_reg_loss: 77661.3023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99537.2293; train_chrom_access_recon_loss: 919843.2727; train_global_loss: 16281258.3636; train_optim_loss: 16281258.3636; val_kl_reg_loss: 96624.4082; val_edge_recon_loss: 2837016.8438; val_gene_expr_recon_loss: 12315465.1250; val_masked_gp_l1_reg_loss: 78492.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100079.1484; val_chrom_access_recon_loss: 900650.6875; val_global_loss: 16328328.1250; val_optim_loss: 16328328.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9013; val_auprc_score: 0.8693; val_best_acc_score: 0.8412; val_best_f1_score: 0.8534; train_kl_reg_loss: 97302.2106; train_edge_recon_loss: 2806430.8598; train_gene_expr_recon_loss: 12221359.6970; train_masked_gp_l1_reg_loss: 79118.9731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99293.4347; train_chrom_access_recon_loss: 916055.2955; train_global_loss: 16219560.4697; train_optim_loss: 16219560.4697; val_kl_reg_loss: 96554.4639; val_edge_recon_loss: 2829355.9375; val_gene_expr_recon_loss: 12270504.1250; val_masked_gp_l1_reg_loss: 79875.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99636.9062; val_chrom_access_recon_loss: 911739.2891; val_global_loss: 16287666.7500; val_optim_loss: 16287666.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9105; val_auprc_score: 0.8816; val_best_acc_score: 0.8509; val_best_f1_score: 0.8627; train_kl_reg_loss: 93295.1934; train_edge_recon_loss: 2806051.8561; train_gene_expr_recon_loss: 12167221.1515; train_masked_gp_l1_reg_loss: 80420.8410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98447.6838; train_chrom_access_recon_loss: 912085.1345; train_global_loss: 16157521.8636; train_optim_loss: 16157521.8636; val_kl_reg_loss: 91530.8682; val_edge_recon_loss: 2812315.3750; val_gene_expr_recon_loss: 12193761.1250; val_masked_gp_l1_reg_loss: 80977.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97782.5938; val_chrom_access_recon_loss: 898765.5312; val_global_loss: 16175134.1250; val_optim_loss: 16175134.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9026; val_auprc_score: 0.8714; val_best_acc_score: 0.8444; val_best_f1_score: 0.8550; train_kl_reg_loss: 90789.5497; train_edge_recon_loss: 2801254.0720; train_gene_expr_recon_loss: 12128696.4848; train_masked_gp_l1_reg_loss: 81570.6609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95789.5546; train_chrom_access_recon_loss: 909706.2348; train_global_loss: 16107806.5455; train_optim_loss: 16107806.5455; val_kl_reg_loss: 89080.7900; val_edge_recon_loss: 2844328.6875; val_gene_expr_recon_loss: 12044701.8750; val_masked_gp_l1_reg_loss: 82354.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95016.4375; val_chrom_access_recon_loss: 884666.5938; val_global_loss: 16040149.0000; val_optim_loss: 16040149.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9030; val_auprc_score: 0.8696; val_best_acc_score: 0.8436; val_best_f1_score: 0.8557; train_kl_reg_loss: 90296.5144; train_edge_recon_loss: 2798164.4129; train_gene_expr_recon_loss: 12077258.6364; train_masked_gp_l1_reg_loss: 82963.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94204.7756; train_chrom_access_recon_loss: 905492.2424; train_global_loss: 16048379.9848; train_optim_loss: 16048379.9848; val_kl_reg_loss: 91846.1514; val_edge_recon_loss: 2839016.3438; val_gene_expr_recon_loss: 12184017.7500; val_masked_gp_l1_reg_loss: 83422.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93224.6562; val_chrom_access_recon_loss: 896039.2734; val_global_loss: 16187566.7500; val_optim_loss: 16187566.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9063; val_auprc_score: 0.8746; val_best_acc_score: 0.8426; val_best_f1_score: 0.8567; train_kl_reg_loss: 88415.4892; train_edge_recon_loss: 2774604.2311; train_gene_expr_recon_loss: 12046956.9394; train_masked_gp_l1_reg_loss: 83906.8086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92225.3294; train_chrom_access_recon_loss: 903551.2566; train_global_loss: 15989660.0000; train_optim_loss: 15989660.0000; val_kl_reg_loss: 90673.3008; val_edge_recon_loss: 2833729.3438; val_gene_expr_recon_loss: 12024783.2500; val_masked_gp_l1_reg_loss: 84292.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91784.0547; val_chrom_access_recon_loss: 892203.4844; val_global_loss: 16017465.3750; val_optim_loss: 16017465.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9154; val_auprc_score: 0.8835; val_best_acc_score: 0.8589; val_best_f1_score: 0.8684; train_kl_reg_loss: 87329.2370; train_edge_recon_loss: 2777514.5038; train_gene_expr_recon_loss: 12013495.7424; train_masked_gp_l1_reg_loss: 84864.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91756.3031; train_chrom_access_recon_loss: 901232.3750; train_global_loss: 15956192.0909; train_optim_loss: 15956192.0909; val_kl_reg_loss: 92206.6768; val_edge_recon_loss: 2803390.5312; val_gene_expr_recon_loss: 12080315.5000; val_masked_gp_l1_reg_loss: 85237.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91235.4609; val_chrom_access_recon_loss: 892855.3125; val_global_loss: 16045240.0000; val_optim_loss: 16045240.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9221; val_auprc_score: 0.8927; val_best_acc_score: 0.8673; val_best_f1_score: 0.8755; train_kl_reg_loss: 87811.3068; train_edge_recon_loss: 2773460.9015; train_gene_expr_recon_loss: 11975240.7576; train_masked_gp_l1_reg_loss: 85555.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90487.1841; train_chrom_access_recon_loss: 898534.1572; train_global_loss: 15911089.9091; train_optim_loss: 15911089.9091; val_kl_reg_loss: 88646.1934; val_edge_recon_loss: 2776480.4062; val_gene_expr_recon_loss: 12061647.1250; val_masked_gp_l1_reg_loss: 85962.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90821.3359; val_chrom_access_recon_loss: 886654.9844; val_global_loss: 15990212.7500; val_optim_loss: 15990212.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9305; val_auprc_score: 0.9129; val_best_acc_score: 0.8726; val_best_f1_score: 0.8814; train_kl_reg_loss: 86715.8243; train_edge_recon_loss: 2765268.2917; train_gene_expr_recon_loss: 11957642.5000; train_masked_gp_l1_reg_loss: 86241.3327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90010.5036; train_chrom_access_recon_loss: 896812.4261; train_global_loss: 15882690.8182; train_optim_loss: 15882690.8182; val_kl_reg_loss: 83506.4971; val_edge_recon_loss: 2787712.8438; val_gene_expr_recon_loss: 12039538.2500; val_masked_gp_l1_reg_loss: 86653.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90523.0859; val_chrom_access_recon_loss: 886881.7188; val_global_loss: 15974815.3750; val_optim_loss: 15974815.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9294; val_auprc_score: 0.9026; val_best_acc_score: 0.8745; val_best_f1_score: 0.8813; train_kl_reg_loss: 86789.1690; train_edge_recon_loss: 2757011.0114; train_gene_expr_recon_loss: 11924603.3030; train_masked_gp_l1_reg_loss: 86898.4093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90194.3229; train_chrom_access_recon_loss: 893204.7633; train_global_loss: 15838701.0152; train_optim_loss: 15838701.0152; val_kl_reg_loss: 85999.9043; val_edge_recon_loss: 2782834.1875; val_gene_expr_recon_loss: 12025514.1250; val_masked_gp_l1_reg_loss: 87101.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90427.9922; val_chrom_access_recon_loss: 871202.3125; val_global_loss: 15943079.2500; val_optim_loss: 15943079.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9310; val_auprc_score: 0.9061; val_best_acc_score: 0.8769; val_best_f1_score: 0.8848; train_kl_reg_loss: 86010.9227; train_edge_recon_loss: 2738013.3182; train_gene_expr_recon_loss: 11881445.1818; train_masked_gp_l1_reg_loss: 87271.1116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90614.7668; train_chrom_access_recon_loss: 890601.8390; train_global_loss: 15773957.0606; train_optim_loss: 15773957.0606; val_kl_reg_loss: 84361.1035; val_edge_recon_loss: 2741971.1250; val_gene_expr_recon_loss: 12043689.6250; val_masked_gp_l1_reg_loss: 87388.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90989.8594; val_chrom_access_recon_loss: 883602.1797; val_global_loss: 15932003.1250; val_optim_loss: 15932003.1250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9324; val_auprc_score: 0.9101; val_best_acc_score: 0.8780; val_best_f1_score: 0.8862; train_kl_reg_loss: 84928.8338; train_edge_recon_loss: 2742474.0795; train_gene_expr_recon_loss: 11859222.7424; train_masked_gp_l1_reg_loss: 87585.8368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91182.0228; train_chrom_access_recon_loss: 889627.7888; train_global_loss: 15755021.1970; train_optim_loss: 15755021.1970; val_kl_reg_loss: 80947.0420; val_edge_recon_loss: 2747657.8438; val_gene_expr_recon_loss: 11938188.5000; val_masked_gp_l1_reg_loss: 87912.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92100.4297; val_chrom_access_recon_loss: 881469.0391; val_global_loss: 15828274.3750; val_optim_loss: 15828274.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9233; val_auprc_score: 0.8982; val_best_acc_score: 0.8659; val_best_f1_score: 0.8737; train_kl_reg_loss: 85383.8871; train_edge_recon_loss: 2738783.7803; train_gene_expr_recon_loss: 11825219.7727; train_masked_gp_l1_reg_loss: 87957.5862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91721.4478; train_chrom_access_recon_loss: 887443.1562; train_global_loss: 15716509.6515; train_optim_loss: 15716509.6515; val_kl_reg_loss: 84746.3994; val_edge_recon_loss: 2814120.9688; val_gene_expr_recon_loss: 11972277.7500; val_masked_gp_l1_reg_loss: 88079.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91354.8359; val_chrom_access_recon_loss: 877034.0312; val_global_loss: 15927613.0000; val_optim_loss: 15927613.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9263; val_auprc_score: 0.9003; val_best_acc_score: 0.8684; val_best_f1_score: 0.8766; train_kl_reg_loss: 83668.4744; train_edge_recon_loss: 2739949.3182; train_gene_expr_recon_loss: 11800417.0152; train_masked_gp_l1_reg_loss: 88252.4663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91814.1419; train_chrom_access_recon_loss: 885239.0786; train_global_loss: 15689340.5303; train_optim_loss: 15689340.5303; val_kl_reg_loss: 82792.7959; val_edge_recon_loss: 2828976.7188; val_gene_expr_recon_loss: 11808156.5000; val_masked_gp_l1_reg_loss: 88377.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91680.4062; val_chrom_access_recon_loss: 862299.7031; val_global_loss: 15762283.8750; val_optim_loss: 15762283.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9389; val_auprc_score: 0.9157; val_best_acc_score: 0.8890; val_best_f1_score: 0.8930; train_kl_reg_loss: 83589.0501; train_edge_recon_loss: 2744616.8485; train_gene_expr_recon_loss: 11780623.5303; train_masked_gp_l1_reg_loss: 88420.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91872.6806; train_chrom_access_recon_loss: 883941.7850; train_global_loss: 15673064.1515; train_optim_loss: 15673064.1515; val_kl_reg_loss: 81102.1709; val_edge_recon_loss: 2768533.0938; val_gene_expr_recon_loss: 11940578.1250; val_masked_gp_l1_reg_loss: 88465.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91790.1250; val_chrom_access_recon_loss: 880981.9844; val_global_loss: 15851451.2500; val_optim_loss: 15851451.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9368; val_auprc_score: 0.9094; val_best_acc_score: 0.8780; val_best_f1_score: 0.8859; train_kl_reg_loss: 81520.4484; train_edge_recon_loss: 2734429.3750; train_gene_expr_recon_loss: 11755345.8788; train_masked_gp_l1_reg_loss: 88783.6188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91594.6117; train_chrom_access_recon_loss: 881618.9858; train_global_loss: 15633292.9394; train_optim_loss: 15633292.9394; val_kl_reg_loss: 81331.1982; val_edge_recon_loss: 2766336.4375; val_gene_expr_recon_loss: 11753203.3750; val_masked_gp_l1_reg_loss: 88980.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92127.0938; val_chrom_access_recon_loss: 865809.7344; val_global_loss: 15647787.5000; val_optim_loss: 15647787.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9395; val_auprc_score: 0.9188; val_best_acc_score: 0.8858; val_best_f1_score: 0.8913; train_kl_reg_loss: 82370.9251; train_edge_recon_loss: 2722389.5530; train_gene_expr_recon_loss: 11726240.0606; train_masked_gp_l1_reg_loss: 89124.0125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91507.8050; train_chrom_access_recon_loss: 878709.4328; train_global_loss: 15590341.8485; train_optim_loss: 15590341.8485; val_kl_reg_loss: 78611.9141; val_edge_recon_loss: 2762100.0625; val_gene_expr_recon_loss: 11795061.8750; val_masked_gp_l1_reg_loss: 89377.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91731.9922; val_chrom_access_recon_loss: 868867.6641; val_global_loss: 15685751.2500; val_optim_loss: 15685751.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9387; val_auprc_score: 0.9098; val_best_acc_score: 0.8831; val_best_f1_score: 0.8880; train_kl_reg_loss: 100636.5352; train_edge_recon_loss: 2793395.0795; train_gene_expr_recon_loss: 10776527.6818; train_masked_gp_l1_reg_loss: 89224.6450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87337.2805; train_chrom_access_recon_loss: 815938.8987; train_global_loss: 14663060.0606; train_optim_loss: 14663060.0606; val_kl_reg_loss: 37380.4219; val_edge_recon_loss: 2811327.4375; val_gene_expr_recon_loss: 10776154.8750; val_masked_gp_l1_reg_loss: 89018.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87999.4062; val_chrom_access_recon_loss: 788642.9844; val_global_loss: 14590523.7500; val_optim_loss: 14590523.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9439; val_auprc_score: 0.9281; val_best_acc_score: 0.8815; val_best_f1_score: 0.8886; train_kl_reg_loss: 83675.2411; train_edge_recon_loss: 2739157.9811; train_gene_expr_recon_loss: 10738060.6061; train_masked_gp_l1_reg_loss: 88531.2751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88585.8262; train_chrom_access_recon_loss: 802162.6051; train_global_loss: 14540173.4697; train_optim_loss: 14540173.4697; val_kl_reg_loss: 43293.0342; val_edge_recon_loss: 2763066.4062; val_gene_expr_recon_loss: 10713221.3750; val_masked_gp_l1_reg_loss: 88008.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89569.5391; val_chrom_access_recon_loss: 783557.5000; val_global_loss: 14480716.3750; val_optim_loss: 14480716.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9468; val_auprc_score: 0.9265; val_best_acc_score: 0.8947; val_best_f1_score: 0.8988; train_kl_reg_loss: 74193.5120; train_edge_recon_loss: 2722732.6250; train_gene_expr_recon_loss: 10707030.4091; train_masked_gp_l1_reg_loss: 87281.8768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89087.0057; train_chrom_access_recon_loss: 799494.4650; train_global_loss: 14479819.8333; train_optim_loss: 14479819.8333; val_kl_reg_loss: 48519.2324; val_edge_recon_loss: 2752151.7500; val_gene_expr_recon_loss: 10839246.6250; val_masked_gp_l1_reg_loss: 86554.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88792.9844; val_chrom_access_recon_loss: 794591.5703; val_global_loss: 14609856.0000; val_optim_loss: 14609856.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9462; val_auprc_score: 0.9265; val_best_acc_score: 0.8880; val_best_f1_score: 0.8938; train_kl_reg_loss: 70509.9484; train_edge_recon_loss: 2710867.8106; train_gene_expr_recon_loss: 10681899.6364; train_masked_gp_l1_reg_loss: 85659.8782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88867.2830; train_chrom_access_recon_loss: 798164.9413; train_global_loss: 14435969.5758; train_optim_loss: 14435969.5758; val_kl_reg_loss: 53647.4917; val_edge_recon_loss: 2751641.1875; val_gene_expr_recon_loss: 10806104.3750; val_masked_gp_l1_reg_loss: 84763.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88688.2891; val_chrom_access_recon_loss: 788725.2031; val_global_loss: 14573569.1250; val_optim_loss: 14573569.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9359; val_auprc_score: 0.9150; val_best_acc_score: 0.8799; val_best_f1_score: 0.8846; train_kl_reg_loss: 68609.9392; train_edge_recon_loss: 2708555.9356; train_gene_expr_recon_loss: 10663026.5000; train_masked_gp_l1_reg_loss: 83922.9527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88454.5820; train_chrom_access_recon_loss: 796586.6866; train_global_loss: 14409156.4697; train_optim_loss: 14409156.4697; val_kl_reg_loss: 56534.5640; val_edge_recon_loss: 2775125.7188; val_gene_expr_recon_loss: 10769304.6250; val_masked_gp_l1_reg_loss: 82979.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88075.6094; val_chrom_access_recon_loss: 793128.8594; val_global_loss: 14565148.6250; val_optim_loss: 14565148.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9440; val_auprc_score: 0.9236; val_best_acc_score: 0.8850; val_best_f1_score: 0.8910; train_kl_reg_loss: 66600.3233; train_edge_recon_loss: 2703865.1705; train_gene_expr_recon_loss: 10637090.7576; train_masked_gp_l1_reg_loss: 82163.2640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88128.8311; train_chrom_access_recon_loss: 796291.8239; train_global_loss: 14374140.2576; train_optim_loss: 14374140.2576; val_kl_reg_loss: 55579.2202; val_edge_recon_loss: 2747354.2188; val_gene_expr_recon_loss: 10612885.3750; val_masked_gp_l1_reg_loss: 81420.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87819.4922; val_chrom_access_recon_loss: 777540.0547; val_global_loss: 14362597.7500; val_optim_loss: 14362597.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9157; val_best_acc_score: 0.8888; val_best_f1_score: 0.8942; train_kl_reg_loss: 65484.2669; train_edge_recon_loss: 2699066.3068; train_gene_expr_recon_loss: 10622175.5152; train_masked_gp_l1_reg_loss: 80728.6128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87727.2817; train_chrom_access_recon_loss: 794638.6316; train_global_loss: 14349820.5152; train_optim_loss: 14349820.5152; val_kl_reg_loss: 56568.6904; val_edge_recon_loss: 2729924.1875; val_gene_expr_recon_loss: 10662676.3750; val_masked_gp_l1_reg_loss: 80124.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88017.8516; val_chrom_access_recon_loss: 782385.1406; val_global_loss: 14399697.2500; val_optim_loss: 14399697.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9502; val_auprc_score: 0.9320; val_best_acc_score: 0.9003; val_best_f1_score: 0.9038; train_kl_reg_loss: 62988.3596; train_edge_recon_loss: 2695755.0265; train_gene_expr_recon_loss: 10605504.3030; train_masked_gp_l1_reg_loss: 79590.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87528.5195; train_chrom_access_recon_loss: 793243.5729; train_global_loss: 14324609.9394; train_optim_loss: 14324609.9394; val_kl_reg_loss: 56793.6030; val_edge_recon_loss: 2700624.5000; val_gene_expr_recon_loss: 10593201.8750; val_masked_gp_l1_reg_loss: 79130.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87191.8594; val_chrom_access_recon_loss: 787918.0547; val_global_loss: 14304861.1250; val_optim_loss: 14304861.1250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9470; val_auprc_score: 0.9278; val_best_acc_score: 0.8920; val_best_f1_score: 0.8970; train_kl_reg_loss: 63326.7956; train_edge_recon_loss: 2697252.7348; train_gene_expr_recon_loss: 10595918.7121; train_masked_gp_l1_reg_loss: 78663.8031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86976.2204; train_chrom_access_recon_loss: 792318.7718; train_global_loss: 14314457.0455; train_optim_loss: 14314457.0455; val_kl_reg_loss: 59807.8560; val_edge_recon_loss: 2729190.5000; val_gene_expr_recon_loss: 10697780.7500; val_masked_gp_l1_reg_loss: 78069.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86627.7656; val_chrom_access_recon_loss: 781110.5625; val_global_loss: 14432586.7500; val_optim_loss: 14432586.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9459; val_auprc_score: 0.9248; val_best_acc_score: 0.8936; val_best_f1_score: 0.8990; train_kl_reg_loss: 64229.2005; train_edge_recon_loss: 2691107.9621; train_gene_expr_recon_loss: 10580638.7727; train_masked_gp_l1_reg_loss: 77713.6270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86874.2244; train_chrom_access_recon_loss: 791352.0625; train_global_loss: 14291915.8030; train_optim_loss: 14291915.8030; val_kl_reg_loss: 58107.4897; val_edge_recon_loss: 2758199.4062; val_gene_expr_recon_loss: 10591906.8750; val_masked_gp_l1_reg_loss: 77379.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86841.1094; val_chrom_access_recon_loss: 777884.4844; val_global_loss: 14350318.5000; val_optim_loss: 14350318.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9494; val_auprc_score: 0.9254; val_best_acc_score: 0.8941; val_best_f1_score: 0.8998; train_kl_reg_loss: 63752.7289; train_edge_recon_loss: 2704635.1970; train_gene_expr_recon_loss: 10566180.9848; train_masked_gp_l1_reg_loss: 76890.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86750.4809; train_chrom_access_recon_loss: 790143.9062; train_global_loss: 14288353.6970; train_optim_loss: 14288353.6970; val_kl_reg_loss: 57095.2852; val_edge_recon_loss: 2735499.5938; val_gene_expr_recon_loss: 10639563.8750; val_masked_gp_l1_reg_loss: 76512.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86785.0703; val_chrom_access_recon_loss: 782509.4375; val_global_loss: 14377965.1250; val_optim_loss: 14377965.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9557; val_auprc_score: 0.9379; val_best_acc_score: 0.9065; val_best_f1_score: 0.9096; train_kl_reg_loss: 63029.8993; train_edge_recon_loss: 2696140.3485; train_gene_expr_recon_loss: 10562414.6364; train_masked_gp_l1_reg_loss: 76176.6744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86628.0005; train_chrom_access_recon_loss: 789735.8116; train_global_loss: 14274125.5303; train_optim_loss: 14274125.5303; val_kl_reg_loss: 56400.9165; val_edge_recon_loss: 2700532.2812; val_gene_expr_recon_loss: 10453269.0000; val_masked_gp_l1_reg_loss: 75802.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86840.3516; val_chrom_access_recon_loss: 773915.9531; val_global_loss: 14146760.2500; val_optim_loss: 14146760.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9426; val_auprc_score: 0.9147; val_best_acc_score: 0.8941; val_best_f1_score: 0.8994; train_kl_reg_loss: 62325.4901; train_edge_recon_loss: 2689674.1477; train_gene_expr_recon_loss: 10541998.9091; train_masked_gp_l1_reg_loss: 75433.3994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86386.6387; train_chrom_access_recon_loss: 789515.9062; train_global_loss: 14245334.6212; train_optim_loss: 14245334.6212; val_kl_reg_loss: 57602.8413; val_edge_recon_loss: 2751171.5000; val_gene_expr_recon_loss: 10651125.6250; val_masked_gp_l1_reg_loss: 75163.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86373.1719; val_chrom_access_recon_loss: 782674.5000; val_global_loss: 14404110.5000; val_optim_loss: 14404110.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9519; val_auprc_score: 0.9324; val_best_acc_score: 0.9054; val_best_f1_score: 0.9105; train_kl_reg_loss: 62305.1817; train_edge_recon_loss: 2694813.0114; train_gene_expr_recon_loss: 10525787.9091; train_masked_gp_l1_reg_loss: 74886.5608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86376.7126; train_chrom_access_recon_loss: 788782.7879; train_global_loss: 14232952.0758; train_optim_loss: 14232952.0758; val_kl_reg_loss: 60176.5103; val_edge_recon_loss: 2696914.5312; val_gene_expr_recon_loss: 10650298.5000; val_masked_gp_l1_reg_loss: 74609.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86172.5156; val_chrom_access_recon_loss: 785056.3750; val_global_loss: 14353229.2500; val_optim_loss: 14353229.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9504; val_auprc_score: 0.9287; val_best_acc_score: 0.9009; val_best_f1_score: 0.9066; train_kl_reg_loss: 63858.8287; train_edge_recon_loss: 2691115.7992; train_gene_expr_recon_loss: 10514753.5152; train_masked_gp_l1_reg_loss: 74314.4719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86312.2228; train_chrom_access_recon_loss: 787308.0540; train_global_loss: 14217662.8788; train_optim_loss: 14217662.8788; val_kl_reg_loss: 58506.6714; val_edge_recon_loss: 2718102.4375; val_gene_expr_recon_loss: 10567914.5000; val_masked_gp_l1_reg_loss: 74035.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86845.8672; val_chrom_access_recon_loss: 779991.1797; val_global_loss: 14285395.8750; val_optim_loss: 14285395.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9547; val_auprc_score: 0.9338; val_best_acc_score: 0.9105; val_best_f1_score: 0.9142; train_kl_reg_loss: 61896.3897; train_edge_recon_loss: 2693918.6250; train_gene_expr_recon_loss: 10503576.6212; train_masked_gp_l1_reg_loss: 73850.6686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86549.5625; train_chrom_access_recon_loss: 786410.0161; train_global_loss: 14206201.8333; train_optim_loss: 14206201.8333; val_kl_reg_loss: 59232.2559; val_edge_recon_loss: 2716851.6250; val_gene_expr_recon_loss: 10607330.5000; val_masked_gp_l1_reg_loss: 73644.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86505.7031; val_chrom_access_recon_loss: 782154.1484; val_global_loss: 14325719.7500; val_optim_loss: 14325719.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9556; val_auprc_score: 0.9382; val_best_acc_score: 0.9060; val_best_f1_score: 0.9103; train_kl_reg_loss: 62937.3201; train_edge_recon_loss: 2689374.4394; train_gene_expr_recon_loss: 10473174.0909; train_masked_gp_l1_reg_loss: 73115.1709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70943.6924; train_chrom_access_recon_loss: 783872.9915; train_global_loss: 14153417.7879; train_optim_loss: 14153417.7879; val_kl_reg_loss: 59462.2217; val_edge_recon_loss: 2719701.9688; val_gene_expr_recon_loss: 10538079.0000; val_masked_gp_l1_reg_loss: 72906.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67629.2344; val_chrom_access_recon_loss: 778534.3047; val_global_loss: 14236313.1250; val_optim_loss: 14236313.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9578; val_auprc_score: 0.9437; val_best_acc_score: 0.9081; val_best_f1_score: 0.9128; train_kl_reg_loss: 64219.0835; train_edge_recon_loss: 2669458.1742; train_gene_expr_recon_loss: 10485427.3333; train_masked_gp_l1_reg_loss: 72849.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67229.2771; train_chrom_access_recon_loss: 784843.0161; train_global_loss: 14144026.4242; train_optim_loss: 14144026.4242; val_kl_reg_loss: 60435.3042; val_edge_recon_loss: 2705842.9688; val_gene_expr_recon_loss: 10508977.2500; val_masked_gp_l1_reg_loss: 72800.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66873.0547; val_chrom_access_recon_loss: 775119.8047; val_global_loss: 14190048.5000; val_optim_loss: 14190048.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9544; val_auprc_score: 0.9359; val_best_acc_score: 0.9054; val_best_f1_score: 0.9093; train_kl_reg_loss: 64752.7824; train_edge_recon_loss: 2686705.9545; train_gene_expr_recon_loss: 10480077.5606; train_masked_gp_l1_reg_loss: 72765.5308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66640.5213; train_chrom_access_recon_loss: 784576.1127; train_global_loss: 14155518.2727; train_optim_loss: 14155518.2727; val_kl_reg_loss: 60297.3296; val_edge_recon_loss: 2707469.1875; val_gene_expr_recon_loss: 10468816.6250; val_masked_gp_l1_reg_loss: 72728.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66411.5469; val_chrom_access_recon_loss: 766240.5234; val_global_loss: 14141964.1250; val_optim_loss: 14141964.1250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9543; val_auprc_score: 0.9341; val_best_acc_score: 0.9087; val_best_f1_score: 0.9127; train_kl_reg_loss: 64750.0546; train_edge_recon_loss: 2683842.2727; train_gene_expr_recon_loss: 10480007.8939; train_masked_gp_l1_reg_loss: 72715.0954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66298.9085; train_chrom_access_recon_loss: 784541.5701; train_global_loss: 14152155.6515; train_optim_loss: 14152155.6515; val_kl_reg_loss: 60739.1221; val_edge_recon_loss: 2700037.5000; val_gene_expr_recon_loss: 10565745.0000; val_masked_gp_l1_reg_loss: 72695.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66174.4062; val_chrom_access_recon_loss: 784167.4531; val_global_loss: 14249557.7500; val_optim_loss: 14249557.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9602; val_auprc_score: 0.9411; val_best_acc_score: 0.9156; val_best_f1_score: 0.9191; train_kl_reg_loss: 64821.1496; train_edge_recon_loss: 2676980.2083; train_gene_expr_recon_loss: 10461757.7576; train_masked_gp_l1_reg_loss: 72665.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66058.8496; train_chrom_access_recon_loss: 783647.4157; train_global_loss: 14125931.1667; train_optim_loss: 14125931.1667; val_kl_reg_loss: 61028.6748; val_edge_recon_loss: 2685961.6562; val_gene_expr_recon_loss: 10597866.6250; val_masked_gp_l1_reg_loss: 72634.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66017.8672; val_chrom_access_recon_loss: 785054.0000; val_global_loss: 14268564.1250; val_optim_loss: 14268564.1250
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9581; val_auprc_score: 0.9350; val_best_acc_score: 0.9135; val_best_f1_score: 0.9165; train_kl_reg_loss: 65322.9477; train_edge_recon_loss: 2675801.8674; train_gene_expr_recon_loss: 10478288.0758; train_masked_gp_l1_reg_loss: 72604.0264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65843.3545; train_chrom_access_recon_loss: 784445.1231; train_global_loss: 14142305.3939; train_optim_loss: 14142305.3939; val_kl_reg_loss: 61730.2578; val_edge_recon_loss: 2685746.9375; val_gene_expr_recon_loss: 10526641.2500; val_masked_gp_l1_reg_loss: 72583.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65689.0859; val_chrom_access_recon_loss: 773483.6797; val_global_loss: 14185875.1250; val_optim_loss: 14185875.1250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9584; val_auprc_score: 0.9415; val_best_acc_score: 0.9130; val_best_f1_score: 0.9160; train_kl_reg_loss: 64975.4029; train_edge_recon_loss: 2680426.7992; train_gene_expr_recon_loss: 10466826.6364; train_masked_gp_l1_reg_loss: 72552.4693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65615.6655; train_chrom_access_recon_loss: 783998.8608; train_global_loss: 14134395.8333; train_optim_loss: 14134395.8333; val_kl_reg_loss: 60770.6538; val_edge_recon_loss: 2671114.2188; val_gene_expr_recon_loss: 10541180.2500; val_masked_gp_l1_reg_loss: 72530.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65528.6719; val_chrom_access_recon_loss: 775836.0547; val_global_loss: 14186960.2500; val_optim_loss: 14186960.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9517; val_auprc_score: 0.9296; val_best_acc_score: 0.9019; val_best_f1_score: 0.9073; train_kl_reg_loss: 64939.7480; train_edge_recon_loss: 2680133.0189; train_gene_expr_recon_loss: 10462203.3636; train_masked_gp_l1_reg_loss: 72477.6009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63902.3078; train_chrom_access_recon_loss: 783620.8968; train_global_loss: 14127276.8030; train_optim_loss: 14127276.8030; val_kl_reg_loss: 61531.3110; val_edge_recon_loss: 2740033.7500; val_gene_expr_recon_loss: 10560074.1250; val_masked_gp_l1_reg_loss: 72455.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63575.0039; val_chrom_access_recon_loss: 783808.3984; val_global_loss: 14281478.5000; val_optim_loss: 14281478.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9495; val_auprc_score: 0.9313; val_best_acc_score: 0.9017; val_best_f1_score: 0.9067; train_kl_reg_loss: 65023.4982; train_edge_recon_loss: 2686124.6061; train_gene_expr_recon_loss: 10467796.6212; train_masked_gp_l1_reg_loss: 72446.8185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63533.5821; train_chrom_access_recon_loss: 783077.9811; train_global_loss: 14138003.1364; train_optim_loss: 14138003.1364; val_kl_reg_loss: 61102.0273; val_edge_recon_loss: 2723052.7188; val_gene_expr_recon_loss: 10556244.0000; val_masked_gp_l1_reg_loss: 72439.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63500.5039; val_chrom_access_recon_loss: 773861.3828; val_global_loss: 14250201.2500; val_optim_loss: 14250201.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9509; val_auprc_score: 0.9266; val_best_acc_score: 0.9097; val_best_f1_score: 0.9140; train_kl_reg_loss: 65287.8242; train_edge_recon_loss: 2678792.9848; train_gene_expr_recon_loss: 10466570.3182; train_masked_gp_l1_reg_loss: 72434.5447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63471.4841; train_chrom_access_recon_loss: 783649.0322; train_global_loss: 14130206.2121; train_optim_loss: 14130206.2121; val_kl_reg_loss: 61969.7349; val_edge_recon_loss: 2677608.2812; val_gene_expr_recon_loss: 10574576.5000; val_masked_gp_l1_reg_loss: 72429.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63442.8867; val_chrom_access_recon_loss: 780685.1953; val_global_loss: 14230712.6250; val_optim_loss: 14230712.6250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9531; val_auprc_score: 0.9358; val_best_acc_score: 0.9054; val_best_f1_score: 0.9111; train_kl_reg_loss: 65211.4257; train_edge_recon_loss: 2683732.1515; train_gene_expr_recon_loss: 10467444.3182; train_masked_gp_l1_reg_loss: 72426.5043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63430.0612; train_chrom_access_recon_loss: 783652.8627; train_global_loss: 14135897.3030; train_optim_loss: 14135897.3030; val_kl_reg_loss: 61347.8774; val_edge_recon_loss: 2706105.5000; val_gene_expr_recon_loss: 10530304.7500; val_masked_gp_l1_reg_loss: 72422.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63407.6641; val_chrom_access_recon_loss: 772364.0547; val_global_loss: 14205953.0000; val_optim_loss: 14205953.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 19 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9594
val AUPRC score: 0.9430
val best accuracy score: 0.9113
val best F1 score: 0.9160
val target rna MSE score: 2.0966
val source rna MSE score: 0.8811
val target atac MSE score: 0.4793
val source atac MSE score: 0.2012
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
