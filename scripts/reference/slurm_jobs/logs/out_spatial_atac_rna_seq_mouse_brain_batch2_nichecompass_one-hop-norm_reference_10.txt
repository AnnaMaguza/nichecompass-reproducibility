[True]
Run timestamp: 07082023_171806_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9046; val_auprc_score: 0.9105; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 9432.7498; train_edge_recon_loss: 35666.3021; train_gene_expr_recon_loss: 632394.7639; train_masked_gp_l1_reg_loss: 4673.6165; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 790422.5486; train_global_loss: 1472589.9861; train_optim_loss: 1472589.9861; val_kl_reg_loss: 11418.5527; val_edge_recon_loss: 40656.5039; val_gene_expr_recon_loss: 574529.5625; val_masked_gp_l1_reg_loss: 4288.2427; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 792751.6875; val_global_loss: 1423644.5000; val_optim_loss: 1423644.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8851; val_auprc_score: 0.8896; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 18859.2118; train_edge_recon_loss: 38527.4874; train_gene_expr_recon_loss: 563441.3125; train_masked_gp_l1_reg_loss: 4153.5740; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 781183.4306; train_global_loss: 1406165.0000; train_optim_loss: 1406165.0000; val_kl_reg_loss: 21699.3887; val_edge_recon_loss: 40653.7852; val_gene_expr_recon_loss: 516271.5938; val_masked_gp_l1_reg_loss: 4029.4507; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 776050.1875; val_global_loss: 1358704.3750; val_optim_loss: 1358704.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8795; val_auprc_score: 0.8776; val_best_acc_score: 0.5121; val_best_f1_score: 0.6720; train_kl_reg_loss: 25129.4223; train_edge_recon_loss: 39049.3108; train_gene_expr_recon_loss: 512744.6840; train_masked_gp_l1_reg_loss: 4012.5619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 764404.9931; train_global_loss: 1345340.9722; train_optim_loss: 1345340.9722; val_kl_reg_loss: 26691.0586; val_edge_recon_loss: 40648.1641; val_gene_expr_recon_loss: 483607.2812; val_masked_gp_l1_reg_loss: 4012.0852; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 762721.5000; val_global_loss: 1317680.0000; val_optim_loss: 1317680.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8881; val_auprc_score: 0.8868; val_best_acc_score: 0.5245; val_best_f1_score: 0.6776; train_kl_reg_loss: 26719.5128; train_edge_recon_loss: 39264.5651; train_gene_expr_recon_loss: 484437.1667; train_masked_gp_l1_reg_loss: 3992.3885; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 749197.0903; train_global_loss: 1303610.7083; train_optim_loss: 1303610.7083; val_kl_reg_loss: 27844.0605; val_edge_recon_loss: 40638.3672; val_gene_expr_recon_loss: 464254.0000; val_masked_gp_l1_reg_loss: 3944.9329; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753327.3125; val_global_loss: 1290008.7500; val_optim_loss: 1290008.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8804; val_auprc_score: 0.8720; val_best_acc_score: 0.5527; val_best_f1_score: 0.6901; train_kl_reg_loss: 27976.6719; train_edge_recon_loss: 39241.3103; train_gene_expr_recon_loss: 471797.6910; train_masked_gp_l1_reg_loss: 3891.0018; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744269.2500; train_global_loss: 1287175.9306; train_optim_loss: 1287175.9306; val_kl_reg_loss: 27562.0547; val_edge_recon_loss: 40617.2383; val_gene_expr_recon_loss: 451452.7500; val_masked_gp_l1_reg_loss: 3829.4023; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745725.5625; val_global_loss: 1269187.0000; val_optim_loss: 1269187.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8848; val_auprc_score: 0.8774; val_best_acc_score: 0.5934; val_best_f1_score: 0.7084; train_kl_reg_loss: 27715.0610; train_edge_recon_loss: 39246.2292; train_gene_expr_recon_loss: 456456.3681; train_masked_gp_l1_reg_loss: 3786.4027; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737002.4861; train_global_loss: 1264206.5278; train_optim_loss: 1264206.5278; val_kl_reg_loss: 27858.8379; val_edge_recon_loss: 40583.1523; val_gene_expr_recon_loss: 441668.6875; val_masked_gp_l1_reg_loss: 3732.5820; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739041.1875; val_global_loss: 1252884.5000; val_optim_loss: 1252884.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8951; val_auprc_score: 0.8861; val_best_acc_score: 0.6615; val_best_f1_score: 0.7434; train_kl_reg_loss: 28598.5080; train_edge_recon_loss: 39271.3251; train_gene_expr_recon_loss: 449724.8889; train_masked_gp_l1_reg_loss: 3695.5159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730412.2292; train_global_loss: 1251702.4583; train_optim_loss: 1251702.4583; val_kl_reg_loss: 27012.2734; val_edge_recon_loss: 40536.1914; val_gene_expr_recon_loss: 434705.6250; val_masked_gp_l1_reg_loss: 3650.4326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 733756.5000; val_global_loss: 1239661.0000; val_optim_loss: 1239661.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9044; val_auprc_score: 0.8992; val_best_acc_score: 0.7220; val_best_f1_score: 0.7770; train_kl_reg_loss: 29480.7422; train_edge_recon_loss: 39301.4701; train_gene_expr_recon_loss: 441283.0000; train_masked_gp_l1_reg_loss: 3625.2975; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724210.3958; train_global_loss: 1237900.9028; train_optim_loss: 1237900.9028; val_kl_reg_loss: 28970.6328; val_edge_recon_loss: 40482.4570; val_gene_expr_recon_loss: 427434.3750; val_masked_gp_l1_reg_loss: 3594.2673; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 727890.9375; val_global_loss: 1228372.7500; val_optim_loss: 1228372.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9090; val_auprc_score: 0.9022; val_best_acc_score: 0.7816; val_best_f1_score: 0.8130; train_kl_reg_loss: 30198.6178; train_edge_recon_loss: 39306.4983; train_gene_expr_recon_loss: 434115.4028; train_masked_gp_l1_reg_loss: 3581.2248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718798.7917; train_global_loss: 1226000.5417; train_optim_loss: 1226000.5417; val_kl_reg_loss: 30079.9668; val_edge_recon_loss: 40409.7266; val_gene_expr_recon_loss: 422037.0625; val_masked_gp_l1_reg_loss: 3561.1699; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722711.1250; val_global_loss: 1218799.0000; val_optim_loss: 1218799.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9145; val_auprc_score: 0.9061; val_best_acc_score: 0.8208; val_best_f1_score: 0.8376; train_kl_reg_loss: 31041.6723; train_edge_recon_loss: 39287.9293; train_gene_expr_recon_loss: 428686.8854; train_masked_gp_l1_reg_loss: 3553.8297; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714429.4097; train_global_loss: 1216999.7083; train_optim_loss: 1216999.7083; val_kl_reg_loss: 29613.7402; val_edge_recon_loss: 40317.4648; val_gene_expr_recon_loss: 418606.4688; val_masked_gp_l1_reg_loss: 3540.1323; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718998.6250; val_global_loss: 1211076.5000; val_optim_loss: 1211076.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9175; val_auprc_score: 0.9093; val_best_acc_score: 0.8376; val_best_f1_score: 0.8476; train_kl_reg_loss: 30963.4868; train_edge_recon_loss: 39260.1172; train_gene_expr_recon_loss: 426310.0868; train_masked_gp_l1_reg_loss: 3533.9308; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713169.4583; train_global_loss: 1213237.0833; train_optim_loss: 1213237.0833; val_kl_reg_loss: 28914.3066; val_edge_recon_loss: 40266.9727; val_gene_expr_recon_loss: 415590.1250; val_masked_gp_l1_reg_loss: 3523.4087; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715689.3750; val_global_loss: 1203984.2500; val_optim_loss: 1203984.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9209; val_auprc_score: 0.9072; val_best_acc_score: 0.8484; val_best_f1_score: 0.8542; train_kl_reg_loss: 30642.6150; train_edge_recon_loss: 39209.3173; train_gene_expr_recon_loss: 424379.4722; train_masked_gp_l1_reg_loss: 3523.8560; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708823.3542; train_global_loss: 1206578.6111; train_optim_loss: 1206578.6111; val_kl_reg_loss: 29121.4434; val_edge_recon_loss: 40220.5664; val_gene_expr_recon_loss: 412596.4062; val_masked_gp_l1_reg_loss: 3520.8884; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712642.3750; val_global_loss: 1198101.6250; val_optim_loss: 1198101.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9283; val_auprc_score: 0.9165; val_best_acc_score: 0.8610; val_best_f1_score: 0.8618; train_kl_reg_loss: 30363.6888; train_edge_recon_loss: 39175.2018; train_gene_expr_recon_loss: 419980.6944; train_masked_gp_l1_reg_loss: 3524.1730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 707125.1806; train_global_loss: 1200168.9583; train_optim_loss: 1200168.9583; val_kl_reg_loss: 28511.7207; val_edge_recon_loss: 40143.5195; val_gene_expr_recon_loss: 410605.5000; val_masked_gp_l1_reg_loss: 3520.8167; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710066.0000; val_global_loss: 1192847.5000; val_optim_loss: 1192847.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9298; val_auprc_score: 0.9191; val_best_acc_score: 0.8599; val_best_f1_score: 0.8597; train_kl_reg_loss: 29921.5816; train_edge_recon_loss: 39140.2083; train_gene_expr_recon_loss: 416605.2535; train_masked_gp_l1_reg_loss: 3525.1738; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697561.7778; train_global_loss: 1186754.0000; train_optim_loss: 1186754.0000; val_kl_reg_loss: 28580.0352; val_edge_recon_loss: 40108.1953; val_gene_expr_recon_loss: 408366.8125; val_masked_gp_l1_reg_loss: 3523.9382; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707536.5000; val_global_loss: 1188115.5000; val_optim_loss: 1188115.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9312; val_auprc_score: 0.9206; val_best_acc_score: 0.8548; val_best_f1_score: 0.8518; train_kl_reg_loss: 29729.3129; train_edge_recon_loss: 39095.5304; train_gene_expr_recon_loss: 415576.5521; train_masked_gp_l1_reg_loss: 3528.7260; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703214.2431; train_global_loss: 1191144.3611; train_optim_loss: 1191144.3611; val_kl_reg_loss: 27447.3438; val_edge_recon_loss: 40042.6016; val_gene_expr_recon_loss: 407204.6250; val_masked_gp_l1_reg_loss: 3529.7007; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 706027.8750; val_global_loss: 1184252.1250; val_optim_loss: 1184252.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9406; val_auprc_score: 0.9341; val_best_acc_score: 0.8631; val_best_f1_score: 0.8591; train_kl_reg_loss: 29127.3898; train_edge_recon_loss: 39042.5256; train_gene_expr_recon_loss: 413030.0000; train_masked_gp_l1_reg_loss: 3538.8328; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696672.4583; train_global_loss: 1181411.2083; train_optim_loss: 1181411.2083; val_kl_reg_loss: 28085.1367; val_edge_recon_loss: 40012.3438; val_gene_expr_recon_loss: 404963.6250; val_masked_gp_l1_reg_loss: 3540.8496; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 703457.1250; val_global_loss: 1180059.1250; val_optim_loss: 1180059.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9439; val_auprc_score: 0.9307; val_best_acc_score: 0.8623; val_best_f1_score: 0.8559; train_kl_reg_loss: 28918.0445; train_edge_recon_loss: 39005.4232; train_gene_expr_recon_loss: 410963.1493; train_masked_gp_l1_reg_loss: 3548.1608; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695374.3819; train_global_loss: 1177809.1389; train_optim_loss: 1177809.1389; val_kl_reg_loss: 26979.1797; val_edge_recon_loss: 39928.5430; val_gene_expr_recon_loss: 404289.6562; val_masked_gp_l1_reg_loss: 3550.4050; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 701793.8750; val_global_loss: 1176541.6250; val_optim_loss: 1176541.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9406; val_auprc_score: 0.9253; val_best_acc_score: 0.8539; val_best_f1_score: 0.8462; train_kl_reg_loss: 28551.1606; train_edge_recon_loss: 38957.8125; train_gene_expr_recon_loss: 411182.2153; train_masked_gp_l1_reg_loss: 3557.5775; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696076.5139; train_global_loss: 1178325.3056; train_optim_loss: 1178325.3056; val_kl_reg_loss: 26262.9766; val_edge_recon_loss: 39879.8359; val_gene_expr_recon_loss: 403406.4062; val_masked_gp_l1_reg_loss: 3557.9807; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699839.9375; val_global_loss: 1172947.1250; val_optim_loss: 1172947.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9444; val_auprc_score: 0.9330; val_best_acc_score: 0.8583; val_best_f1_score: 0.8504; train_kl_reg_loss: 28065.5386; train_edge_recon_loss: 38909.8958; train_gene_expr_recon_loss: 409406.5278; train_masked_gp_l1_reg_loss: 3565.3747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693173.4375; train_global_loss: 1173120.8056; train_optim_loss: 1173120.8056; val_kl_reg_loss: 26985.5273; val_edge_recon_loss: 39857.8008; val_gene_expr_recon_loss: 401368.1250; val_masked_gp_l1_reg_loss: 3568.3167; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697627.0000; val_global_loss: 1169406.7500; val_optim_loss: 1169406.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9481; val_auprc_score: 0.9378; val_best_acc_score: 0.8588; val_best_f1_score: 0.8492; train_kl_reg_loss: 27833.4785; train_edge_recon_loss: 38870.0942; train_gene_expr_recon_loss: 408646.4965; train_masked_gp_l1_reg_loss: 3577.2472; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688228.5069; train_global_loss: 1167155.8333; train_optim_loss: 1167155.8333; val_kl_reg_loss: 26282.3887; val_edge_recon_loss: 39801.2891; val_gene_expr_recon_loss: 400668.6250; val_masked_gp_l1_reg_loss: 3580.2551; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696080.3750; val_global_loss: 1166413.0000; val_optim_loss: 1166413.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9502; val_auprc_score: 0.9403; val_best_acc_score: 0.8549; val_best_f1_score: 0.8429; train_kl_reg_loss: 27385.6753; train_edge_recon_loss: 38838.5508; train_gene_expr_recon_loss: 408888.0868; train_masked_gp_l1_reg_loss: 3586.8150; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687123.5903; train_global_loss: 1165822.7083; train_optim_loss: 1165822.7083; val_kl_reg_loss: 25810.0801; val_edge_recon_loss: 39786.3750; val_gene_expr_recon_loss: 399821.2500; val_masked_gp_l1_reg_loss: 3590.2363; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694913.1875; val_global_loss: 1163921.1250; val_optim_loss: 1163921.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9483; val_auprc_score: 0.9356; val_best_acc_score: 0.8473; val_best_f1_score: 0.8522; train_kl_reg_loss: 27085.6497; train_edge_recon_loss: 38799.9792; train_gene_expr_recon_loss: 405090.5139; train_masked_gp_l1_reg_loss: 3597.1354; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 685328.0972; train_global_loss: 1159901.3611; train_optim_loss: 1159901.3611; val_kl_reg_loss: 25041.1211; val_edge_recon_loss: 39729.0664; val_gene_expr_recon_loss: 399258.1250; val_masked_gp_l1_reg_loss: 3600.5664; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693587.3750; val_global_loss: 1161216.2500; val_optim_loss: 1161216.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9526; val_auprc_score: 0.9446; val_best_acc_score: 0.8488; val_best_f1_score: 0.8481; train_kl_reg_loss: 26678.1886; train_edge_recon_loss: 38746.4036; train_gene_expr_recon_loss: 406901.0069; train_masked_gp_l1_reg_loss: 3609.6517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686766.2431; train_global_loss: 1162701.5139; train_optim_loss: 1162701.5139; val_kl_reg_loss: 25315.1680; val_edge_recon_loss: 39704.0234; val_gene_expr_recon_loss: 398041.0000; val_masked_gp_l1_reg_loss: 3612.0083; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 691722.4375; val_global_loss: 1158394.6250; val_optim_loss: 1158394.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9550; val_auprc_score: 0.9464; val_best_acc_score: 0.8468; val_best_f1_score: 0.8591; train_kl_reg_loss: 26363.6576; train_edge_recon_loss: 38727.2760; train_gene_expr_recon_loss: 404579.1146; train_masked_gp_l1_reg_loss: 3620.3902; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 683942.4861; train_global_loss: 1157232.9306; train_optim_loss: 1157232.9306; val_kl_reg_loss: 24725.8809; val_edge_recon_loss: 39649.0586; val_gene_expr_recon_loss: 397464.5938; val_masked_gp_l1_reg_loss: 3622.2178; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 690646.0625; val_global_loss: 1156107.7500; val_optim_loss: 1156107.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9543; val_auprc_score: 0.9457; val_best_acc_score: 0.8372; val_best_f1_score: 0.8582; train_kl_reg_loss: 26084.2869; train_edge_recon_loss: 38685.1484; train_gene_expr_recon_loss: 403981.1389; train_masked_gp_l1_reg_loss: 3631.8973; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 683276.7986; train_global_loss: 1155659.2778; train_optim_loss: 1155659.2778; val_kl_reg_loss: 23564.8438; val_edge_recon_loss: 39621.3516; val_gene_expr_recon_loss: 397436.9688; val_masked_gp_l1_reg_loss: 3635.0615; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689792.6250; val_global_loss: 1154050.8750; val_optim_loss: 1154050.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9555; val_auprc_score: 0.9503; val_best_acc_score: 0.8897; val_best_f1_score: 0.8931; train_kl_reg_loss: 25052.0985; train_edge_recon_loss: 40048.5148; train_gene_expr_recon_loss: 411392.6806; train_masked_gp_l1_reg_loss: 3647.3364; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691079.4167; train_global_loss: 1171220.0417; train_optim_loss: 1171220.0417; val_kl_reg_loss: 21855.0918; val_edge_recon_loss: 40241.2305; val_gene_expr_recon_loss: 402016.2812; val_masked_gp_l1_reg_loss: 3646.9519; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 695851.6250; val_global_loss: 1163611.1250; val_optim_loss: 1163611.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9526; val_auprc_score: 0.9435; val_best_acc_score: 0.8867; val_best_f1_score: 0.8895; train_kl_reg_loss: 23256.1443; train_edge_recon_loss: 40092.6727; train_gene_expr_recon_loss: 409177.7292; train_masked_gp_l1_reg_loss: 3641.4909; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 689859.8958; train_global_loss: 1166027.9167; train_optim_loss: 1166027.9167; val_kl_reg_loss: 20820.2383; val_edge_recon_loss: 40214.3164; val_gene_expr_recon_loss: 401401.2812; val_masked_gp_l1_reg_loss: 3633.5737; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694895.1875; val_global_loss: 1160964.6250; val_optim_loss: 1160964.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9506; val_auprc_score: 0.9407; val_best_acc_score: 0.8841; val_best_f1_score: 0.8855; train_kl_reg_loss: 22511.8220; train_edge_recon_loss: 40051.1016; train_gene_expr_recon_loss: 407014.4861; train_masked_gp_l1_reg_loss: 3630.9053; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688194.4028; train_global_loss: 1161402.7083; train_optim_loss: 1161402.7083; val_kl_reg_loss: 20119.1152; val_edge_recon_loss: 40164.7188; val_gene_expr_recon_loss: 400792.4062; val_masked_gp_l1_reg_loss: 3626.1270; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694050.1250; val_global_loss: 1158752.5000; val_optim_loss: 1158752.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9528; val_auprc_score: 0.9472; val_best_acc_score: 0.8832; val_best_f1_score: 0.8832; train_kl_reg_loss: 21955.6882; train_edge_recon_loss: 39987.6714; train_gene_expr_recon_loss: 407406.0035; train_masked_gp_l1_reg_loss: 3623.7510; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686322.4028; train_global_loss: 1159295.5278; train_optim_loss: 1159295.5278; val_kl_reg_loss: 20220.9844; val_edge_recon_loss: 40097.5273; val_gene_expr_recon_loss: 399646.8125; val_masked_gp_l1_reg_loss: 3618.9580; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693018.0625; val_global_loss: 1156602.3750; val_optim_loss: 1156602.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9543; val_auprc_score: 0.9477; val_best_acc_score: 0.8855; val_best_f1_score: 0.8851; train_kl_reg_loss: 21786.5955; train_edge_recon_loss: 39952.4158; train_gene_expr_recon_loss: 407136.4479; train_masked_gp_l1_reg_loss: 3605.0094; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 685237.1250; train_global_loss: 1157717.5833; train_optim_loss: 1157717.5833; val_kl_reg_loss: 20315.2266; val_edge_recon_loss: 40085.7734; val_gene_expr_recon_loss: 399427.1875; val_masked_gp_l1_reg_loss: 3591.5317; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692761.2500; val_global_loss: 1156181.0000; val_optim_loss: 1156181.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9504; val_auprc_score: 0.9427; val_best_acc_score: 0.8781; val_best_f1_score: 0.8782; train_kl_reg_loss: 21657.2602; train_edge_recon_loss: 39947.8025; train_gene_expr_recon_loss: 405836.6146; train_masked_gp_l1_reg_loss: 3587.5563; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684734.4236; train_global_loss: 1155763.6528; train_optim_loss: 1155763.6528; val_kl_reg_loss: 20412.4727; val_edge_recon_loss: 40114.2305; val_gene_expr_recon_loss: 399235.0000; val_masked_gp_l1_reg_loss: 3581.6255; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692631.8125; val_global_loss: 1155975.1250; val_optim_loss: 1155975.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9507; val_auprc_score: 0.9408; val_best_acc_score: 0.8795; val_best_f1_score: 0.8794; train_kl_reg_loss: 21606.2233; train_edge_recon_loss: 39949.8025; train_gene_expr_recon_loss: 404460.7465; train_masked_gp_l1_reg_loss: 3578.4251; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686335.9653; train_global_loss: 1155931.1528; train_optim_loss: 1155931.1528; val_kl_reg_loss: 20294.0684; val_edge_recon_loss: 40106.2812; val_gene_expr_recon_loss: 399214.7500; val_masked_gp_l1_reg_loss: 3574.8660; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692550.8125; val_global_loss: 1155740.7500; val_optim_loss: 1155740.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9566; val_auprc_score: 0.9533; val_best_acc_score: 0.8852; val_best_f1_score: 0.8841; train_kl_reg_loss: 21626.3872; train_edge_recon_loss: 39940.3550; train_gene_expr_recon_loss: 405833.2049; train_masked_gp_l1_reg_loss: 3572.7579; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686177.1458; train_global_loss: 1157149.8611; train_optim_loss: 1157149.8611; val_kl_reg_loss: 20179.9355; val_edge_recon_loss: 40075.9922; val_gene_expr_recon_loss: 399231.2500; val_masked_gp_l1_reg_loss: 3570.4956; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692768.3125; val_global_loss: 1155826.0000; val_optim_loss: 1155826.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9523
val AUPRC score: 0.9441
val best accuracy score: 0.8851
val best F1 score: 0.8863
val target rna MSE score: 0.4153
val source rna MSE score: 0.1393
val target atac MSE score: 0.1364
val source atac MSE score: 0.0181
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
