[True]
Run timestamp: 10082023_145555_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7548; val_auprc_score: 0.7718; val_best_acc_score: 0.5350; val_best_f1_score: 0.6780; train_kl_reg_loss: 182177.2596; train_edge_recon_loss: 3567581.0592; train_gene_expr_recon_loss: 15083250.5038; train_masked_gp_l1_reg_loss: 83288.2000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238940.6428; train_chrom_access_recon_loss: 33255720.2443; train_global_loss: 52410957.8626; train_optim_loss: 52410957.8626; val_kl_reg_loss: 149669.2062; val_edge_recon_loss: 4062734.5500; val_gene_expr_recon_loss: 12886164.0667; val_masked_gp_l1_reg_loss: 76423.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226243.8438; val_chrom_access_recon_loss: 30932394.2667; val_global_loss: 48333629.8667; val_optim_loss: 48333629.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8189; val_auprc_score: 0.8260; val_best_acc_score: 0.6818; val_best_f1_score: 0.7448; train_kl_reg_loss: 137919.1030; train_edge_recon_loss: 3546107.1183; train_gene_expr_recon_loss: 12654557.4580; train_masked_gp_l1_reg_loss: 72360.7687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 210331.8620; train_chrom_access_recon_loss: 30984021.2977; train_global_loss: 47605297.6489; train_optim_loss: 47605297.6489; val_kl_reg_loss: 128418.1036; val_edge_recon_loss: 4055457.2000; val_gene_expr_recon_loss: 12536948.1333; val_masked_gp_l1_reg_loss: 70843.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193883.9062; val_chrom_access_recon_loss: 30619961.3333; val_global_loss: 47605512.5333; val_optim_loss: 47605512.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8718; val_auprc_score: 0.8614; val_best_acc_score: 0.7788; val_best_f1_score: 0.8037; train_kl_reg_loss: 116003.4995; train_edge_recon_loss: 3520272.2061; train_gene_expr_recon_loss: 12426680.9313; train_masked_gp_l1_reg_loss: 71756.0094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178102.5501; train_chrom_access_recon_loss: 30639324.3053; train_global_loss: 46952139.3893; train_optim_loss: 46952139.3893; val_kl_reg_loss: 94369.2167; val_edge_recon_loss: 3684836.8000; val_gene_expr_recon_loss: 12363676.8000; val_masked_gp_l1_reg_loss: 73798.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162643.0625; val_chrom_access_recon_loss: 30343804.6667; val_global_loss: 46723129.0667; val_optim_loss: 46723129.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8723; val_auprc_score: 0.8566; val_best_acc_score: 0.7838; val_best_f1_score: 0.8042; train_kl_reg_loss: 123646.8533; train_edge_recon_loss: 3098368.1832; train_gene_expr_recon_loss: 12264025.8168; train_masked_gp_l1_reg_loss: 76350.2426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148870.7993; train_chrom_access_recon_loss: 30320566.4122; train_global_loss: 46031828.3053; train_optim_loss: 46031828.3053; val_kl_reg_loss: 139617.0969; val_edge_recon_loss: 2958501.8500; val_gene_expr_recon_loss: 12271585.5333; val_masked_gp_l1_reg_loss: 77935.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135843.9688; val_chrom_access_recon_loss: 30170691.0667; val_global_loss: 45754175.4667; val_optim_loss: 45754175.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8823; val_auprc_score: 0.8639; val_best_acc_score: 0.7998; val_best_f1_score: 0.8190; train_kl_reg_loss: 137698.2425; train_edge_recon_loss: 2958651.9523; train_gene_expr_recon_loss: 12135435.2290; train_masked_gp_l1_reg_loss: 79539.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124944.5614; train_chrom_access_recon_loss: 30064111.0687; train_global_loss: 45500381.1298; train_optim_loss: 45500381.1298; val_kl_reg_loss: 126301.4839; val_edge_recon_loss: 2939506.4167; val_gene_expr_recon_loss: 12132185.6667; val_masked_gp_l1_reg_loss: 80977.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114913.6562; val_chrom_access_recon_loss: 29822547.3333; val_global_loss: 45216431.2000; val_optim_loss: 45216431.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9015; val_auprc_score: 0.8820; val_best_acc_score: 0.8257; val_best_f1_score: 0.8402; train_kl_reg_loss: 130790.8214; train_edge_recon_loss: 2919230.4637; train_gene_expr_recon_loss: 12025540.0611; train_masked_gp_l1_reg_loss: 82163.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106683.5095; train_chrom_access_recon_loss: 29797765.2977; train_global_loss: 45062173.5573; train_optim_loss: 45062173.5573; val_kl_reg_loss: 126487.2219; val_edge_recon_loss: 2900117.6333; val_gene_expr_recon_loss: 12033723.6667; val_masked_gp_l1_reg_loss: 83493.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98905.4844; val_chrom_access_recon_loss: 29627264.8000; val_global_loss: 44869990.9333; val_optim_loss: 44869990.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9288; val_auprc_score: 0.9151; val_best_acc_score: 0.8549; val_best_f1_score: 0.8645; train_kl_reg_loss: 127929.6611; train_edge_recon_loss: 2873770.8340; train_gene_expr_recon_loss: 11920892.3130; train_masked_gp_l1_reg_loss: 84510.4599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92517.1815; train_chrom_access_recon_loss: 29603358.1679; train_global_loss: 44702978.5954; train_optim_loss: 44702978.5954; val_kl_reg_loss: 130178.8500; val_edge_recon_loss: 2845362.5500; val_gene_expr_recon_loss: 11903196.7333; val_masked_gp_l1_reg_loss: 85854.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86581.5469; val_chrom_access_recon_loss: 29260486.1333; val_global_loss: 44311660.5333; val_optim_loss: 44311660.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9403; val_auprc_score: 0.9235; val_best_acc_score: 0.8798; val_best_f1_score: 0.8854; train_kl_reg_loss: 128983.1520; train_edge_recon_loss: 2829394.6183; train_gene_expr_recon_loss: 11838757.4733; train_masked_gp_l1_reg_loss: 86559.8705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81843.8340; train_chrom_access_recon_loss: 29403076.3817; train_global_loss: 44368615.2672; train_optim_loss: 44368615.2672; val_kl_reg_loss: 128196.2073; val_edge_recon_loss: 2828877.8667; val_gene_expr_recon_loss: 11824418.2000; val_masked_gp_l1_reg_loss: 87529.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77624.7656; val_chrom_access_recon_loss: 29282240.2667; val_global_loss: 44228887.2000; val_optim_loss: 44228887.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9463; val_auprc_score: 0.9320; val_best_acc_score: 0.8880; val_best_f1_score: 0.8948; train_kl_reg_loss: 128070.5113; train_edge_recon_loss: 2795369.6126; train_gene_expr_recon_loss: 11762137.8015; train_masked_gp_l1_reg_loss: 88406.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73926.2416; train_chrom_access_recon_loss: 29228195.0992; train_global_loss: 44076105.4046; train_optim_loss: 44076105.4046; val_kl_reg_loss: 125803.1219; val_edge_recon_loss: 2794143.7500; val_gene_expr_recon_loss: 11771292.6667; val_masked_gp_l1_reg_loss: 89446.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70460.1172; val_chrom_access_recon_loss: 29094074.8000; val_global_loss: 43945220.8000; val_optim_loss: 43945220.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9513; val_auprc_score: 0.9366; val_best_acc_score: 0.8930; val_best_f1_score: 0.8988; train_kl_reg_loss: 125786.1447; train_edge_recon_loss: 2780884.7328; train_gene_expr_recon_loss: 11693577.1985; train_masked_gp_l1_reg_loss: 90393.8401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67301.6405; train_chrom_access_recon_loss: 29032357.6336; train_global_loss: 43790301.1603; train_optim_loss: 43790301.1603; val_kl_reg_loss: 121582.2672; val_edge_recon_loss: 2790769.0833; val_gene_expr_recon_loss: 11723621.0667; val_masked_gp_l1_reg_loss: 91355.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64302.0938; val_chrom_access_recon_loss: 28839480.1333; val_global_loss: 43631109.8667; val_optim_loss: 43631109.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9503; val_auprc_score: 0.9366; val_best_acc_score: 0.8926; val_best_f1_score: 0.8978; train_kl_reg_loss: 123036.5807; train_edge_recon_loss: 2766084.2233; train_gene_expr_recon_loss: 11630177.1832; train_masked_gp_l1_reg_loss: 92210.2784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61707.8324; train_chrom_access_recon_loss: 28881776.2290; train_global_loss: 43554992.4580; train_optim_loss: 43554992.4580; val_kl_reg_loss: 121558.4385; val_edge_recon_loss: 2786745.6667; val_gene_expr_recon_loss: 11626766.2667; val_masked_gp_l1_reg_loss: 93115.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59180.4805; val_chrom_access_recon_loss: 28557751.0667; val_global_loss: 43245117.6000; val_optim_loss: 43245117.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9561; val_auprc_score: 0.9436; val_best_acc_score: 0.8971; val_best_f1_score: 0.9019; train_kl_reg_loss: 121352.0861; train_edge_recon_loss: 2759510.1813; train_gene_expr_recon_loss: 11567770.0458; train_masked_gp_l1_reg_loss: 93910.8826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56988.5246; train_chrom_access_recon_loss: 28731102.5649; train_global_loss: 43330634.3511; train_optim_loss: 43330634.3511; val_kl_reg_loss: 117523.5849; val_edge_recon_loss: 2784500.8833; val_gene_expr_recon_loss: 11605619.0000; val_masked_gp_l1_reg_loss: 94651.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54852.2148; val_chrom_access_recon_loss: 28517061.7333; val_global_loss: 43174209.6000; val_optim_loss: 43174209.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9530; val_auprc_score: 0.9372; val_best_acc_score: 0.8991; val_best_f1_score: 0.9036; train_kl_reg_loss: 118721.1367; train_edge_recon_loss: 2748635.6908; train_gene_expr_recon_loss: 11506689.6489; train_masked_gp_l1_reg_loss: 95519.7988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53079.6811; train_chrom_access_recon_loss: 28559694.3817; train_global_loss: 43082340.5191; train_optim_loss: 43082340.5191; val_kl_reg_loss: 117364.9448; val_edge_recon_loss: 2764259.9333; val_gene_expr_recon_loss: 11549300.8000; val_masked_gp_l1_reg_loss: 96302.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51422.7539; val_chrom_access_recon_loss: 28437648.1333; val_global_loss: 43016298.9333; val_optim_loss: 43016298.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9588; val_auprc_score: 0.9449; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 116074.4401; train_edge_recon_loss: 2742209.6660; train_gene_expr_recon_loss: 11463791.2443; train_masked_gp_l1_reg_loss: 97038.4604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49965.6109; train_chrom_access_recon_loss: 28420653.8626; train_global_loss: 42889733.2824; train_optim_loss: 42889733.2824; val_kl_reg_loss: 112578.3875; val_edge_recon_loss: 2740535.8500; val_gene_expr_recon_loss: 11487840.4667; val_masked_gp_l1_reg_loss: 97806.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48531.1406; val_chrom_access_recon_loss: 28287062.0000; val_global_loss: 42774353.8667; val_optim_loss: 42774353.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9634; val_auprc_score: 0.9521; val_best_acc_score: 0.9123; val_best_f1_score: 0.9151; train_kl_reg_loss: 112373.0955; train_edge_recon_loss: 2745013.2424; train_gene_expr_recon_loss: 11421474.5649; train_masked_gp_l1_reg_loss: 98570.9613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47121.4291; train_chrom_access_recon_loss: 28315396.1221; train_global_loss: 42739949.5267; train_optim_loss: 42739949.5267; val_kl_reg_loss: 113333.9771; val_edge_recon_loss: 2734594.8333; val_gene_expr_recon_loss: 11476984.4000; val_masked_gp_l1_reg_loss: 99445.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45997.2461; val_chrom_access_recon_loss: 28252603.4667; val_global_loss: 42722958.9333; val_optim_loss: 42722958.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9651; val_auprc_score: 0.9549; val_best_acc_score: 0.9134; val_best_f1_score: 0.9172; train_kl_reg_loss: 111821.0601; train_edge_recon_loss: 2732500.3340; train_gene_expr_recon_loss: 11386051.8397; train_masked_gp_l1_reg_loss: 100042.4411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44804.5182; train_chrom_access_recon_loss: 28220157.1298; train_global_loss: 42595377.3130; train_optim_loss: 42595377.3130; val_kl_reg_loss: 110083.9531; val_edge_recon_loss: 2752645.9833; val_gene_expr_recon_loss: 11384521.9333; val_masked_gp_l1_reg_loss: 100737.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43708.1289; val_chrom_access_recon_loss: 28013583.2000; val_global_loss: 42405281.0667; val_optim_loss: 42405281.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9656; val_auprc_score: 0.9539; val_best_acc_score: 0.9175; val_best_f1_score: 0.9201; train_kl_reg_loss: 109175.2239; train_edge_recon_loss: 2734755.7595; train_gene_expr_recon_loss: 11352549.0763; train_masked_gp_l1_reg_loss: 101430.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42562.1850; train_chrom_access_recon_loss: 28129462.8397; train_global_loss: 42469935.6641; train_optim_loss: 42469935.6641; val_kl_reg_loss: 107825.9797; val_edge_recon_loss: 2720003.1667; val_gene_expr_recon_loss: 11435200.5333; val_masked_gp_l1_reg_loss: 102337.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41535.9844; val_chrom_access_recon_loss: 27954667.0667; val_global_loss: 42361570.6667; val_optim_loss: 42361570.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9707; val_auprc_score: 0.9617; val_best_acc_score: 0.9212; val_best_f1_score: 0.9243; train_kl_reg_loss: 108583.9303; train_edge_recon_loss: 2719101.4008; train_gene_expr_recon_loss: 11311956.7481; train_masked_gp_l1_reg_loss: 102825.7019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40704.0799; train_chrom_access_recon_loss: 27967918.9618; train_global_loss: 42251091.0229; train_optim_loss: 42251091.0229; val_kl_reg_loss: 109242.8005; val_edge_recon_loss: 2728619.8833; val_gene_expr_recon_loss: 11383174.4000; val_masked_gp_l1_reg_loss: 103430.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39808.0508; val_chrom_access_recon_loss: 27990315.7333; val_global_loss: 42354590.6667; val_optim_loss: 42354590.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9719; val_auprc_score: 0.9648; val_best_acc_score: 0.9240; val_best_f1_score: 0.9269; train_kl_reg_loss: 107883.7523; train_edge_recon_loss: 2725929.1202; train_gene_expr_recon_loss: 11280885.7786; train_masked_gp_l1_reg_loss: 104007.1797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39150.1924; train_chrom_access_recon_loss: 27891789.4809; train_global_loss: 42149645.3740; train_optim_loss: 42149645.3740; val_kl_reg_loss: 108550.7292; val_edge_recon_loss: 2718629.9167; val_gene_expr_recon_loss: 11331738.8000; val_masked_gp_l1_reg_loss: 104450.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38509.2969; val_chrom_access_recon_loss: 27763621.2000; val_global_loss: 42065499.4667; val_optim_loss: 42065499.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9701; val_auprc_score: 0.9603; val_best_acc_score: 0.9220; val_best_f1_score: 0.9251; train_kl_reg_loss: 107088.7542; train_edge_recon_loss: 2714195.8836; train_gene_expr_recon_loss: 11248861.2519; train_masked_gp_l1_reg_loss: 105161.0076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37939.9255; train_chrom_access_recon_loss: 27798263.0687; train_global_loss: 42011509.8626; train_optim_loss: 42011509.8626; val_kl_reg_loss: 103788.5510; val_edge_recon_loss: 2739446.7000; val_gene_expr_recon_loss: 11302391.1333; val_masked_gp_l1_reg_loss: 105788.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37357.0508; val_chrom_access_recon_loss: 27662830.2667; val_global_loss: 41951600.8000; val_optim_loss: 41951600.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9697; val_auprc_score: 0.9610; val_best_acc_score: 0.9196; val_best_f1_score: 0.9232; train_kl_reg_loss: 105097.0002; train_edge_recon_loss: 2719596.3397; train_gene_expr_recon_loss: 11224141.4962; train_masked_gp_l1_reg_loss: 106376.9111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36805.6356; train_chrom_access_recon_loss: 27708562.8397; train_global_loss: 41900580.1221; train_optim_loss: 41900580.1221; val_kl_reg_loss: 102144.6615; val_edge_recon_loss: 2736534.0000; val_gene_expr_recon_loss: 11268287.6000; val_masked_gp_l1_reg_loss: 107142.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36345.2500; val_chrom_access_recon_loss: 27611757.6000; val_global_loss: 41862212.0000; val_optim_loss: 41862212.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9733; val_auprc_score: 0.9652; val_best_acc_score: 0.9255; val_best_f1_score: 0.9285; train_kl_reg_loss: 103975.4092; train_edge_recon_loss: 2711216.3034; train_gene_expr_recon_loss: 11197980.7023; train_masked_gp_l1_reg_loss: 107573.1444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35900.1961; train_chrom_access_recon_loss: 27621505.0687; train_global_loss: 41778150.9618; train_optim_loss: 41778150.9618; val_kl_reg_loss: 102243.3396; val_edge_recon_loss: 2727996.2000; val_gene_expr_recon_loss: 11266106.7333; val_masked_gp_l1_reg_loss: 108160.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35403.9141; val_chrom_access_recon_loss: 27549359.6000; val_global_loss: 41789270.9333; val_optim_loss: 41789270.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9746; val_auprc_score: 0.9675; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 103348.8546; train_edge_recon_loss: 2709633.0210; train_gene_expr_recon_loss: 11182755.0458; train_masked_gp_l1_reg_loss: 108658.4544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34907.1994; train_chrom_access_recon_loss: 27557733.2824; train_global_loss: 41697036.0305; train_optim_loss: 41697036.0305; val_kl_reg_loss: 103549.9115; val_edge_recon_loss: 2723970.2667; val_gene_expr_recon_loss: 11234992.0667; val_masked_gp_l1_reg_loss: 109351.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34497.8633; val_chrom_access_recon_loss: 27423774.1333; val_global_loss: 41630135.2000; val_optim_loss: 41630135.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9738; val_auprc_score: 0.9678; val_best_acc_score: 0.9259; val_best_f1_score: 0.9290; train_kl_reg_loss: 102115.1939; train_edge_recon_loss: 2705300.9924; train_gene_expr_recon_loss: 11159055.9389; train_masked_gp_l1_reg_loss: 109860.4200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34127.2908; train_chrom_access_recon_loss: 27493468.0916; train_global_loss: 41603928.1527; train_optim_loss: 41603928.1527; val_kl_reg_loss: 103049.6724; val_edge_recon_loss: 2744208.0833; val_gene_expr_recon_loss: 11224903.6000; val_masked_gp_l1_reg_loss: 110381.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33726.5469; val_chrom_access_recon_loss: 27418694.2667; val_global_loss: 41634965.0667; val_optim_loss: 41634965.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9793; val_auprc_score: 0.9737; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 102560.2929; train_edge_recon_loss: 2704052.8931; train_gene_expr_recon_loss: 11145071.1298; train_masked_gp_l1_reg_loss: 110859.5038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33411.1118; train_chrom_access_recon_loss: 27423223.2519; train_global_loss: 41519178.1985; train_optim_loss: 41519178.1985; val_kl_reg_loss: 99770.2792; val_edge_recon_loss: 2702585.5333; val_gene_expr_recon_loss: 11215845.3333; val_masked_gp_l1_reg_loss: 111402.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33082.2227; val_chrom_access_recon_loss: 27400884.4000; val_global_loss: 41563569.3333; val_optim_loss: 41563569.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9775; val_auprc_score: 0.9724; val_best_acc_score: 0.9287; val_best_f1_score: 0.9309; train_kl_reg_loss: 114540.9803; train_edge_recon_loss: 2791369.0134; train_gene_expr_recon_loss: 11720170.0534; train_masked_gp_l1_reg_loss: 110155.3615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31734.1820; train_chrom_access_recon_loss: 27929351.0534; train_global_loss: 42697320.5191; train_optim_loss: 42697320.5191; val_kl_reg_loss: 44864.2555; val_edge_recon_loss: 2739760.0000; val_gene_expr_recon_loss: 11659372.6000; val_masked_gp_l1_reg_loss: 109294.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29855.7949; val_chrom_access_recon_loss: 27548403.2000; val_global_loss: 42131550.6667; val_optim_loss: 42131550.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9716; val_auprc_score: 0.9627; val_best_acc_score: 0.9256; val_best_f1_score: 0.9280; train_kl_reg_loss: 98530.6020; train_edge_recon_loss: 2730084.9809; train_gene_expr_recon_loss: 11631120.5038; train_masked_gp_l1_reg_loss: 108575.0463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28907.8083; train_chrom_access_recon_loss: 27813078.3053; train_global_loss: 42410297.3130; train_optim_loss: 42410297.3130; val_kl_reg_loss: 52845.7198; val_edge_recon_loss: 2731390.0500; val_gene_expr_recon_loss: 11629997.4000; val_masked_gp_l1_reg_loss: 107833.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28112.6523; val_chrom_access_recon_loss: 27512258.2667; val_global_loss: 42062438.6667; val_optim_loss: 42062438.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9728; val_auprc_score: 0.9660; val_best_acc_score: 0.9279; val_best_f1_score: 0.9303; train_kl_reg_loss: 88363.5796; train_edge_recon_loss: 2711560.9828; train_gene_expr_recon_loss: 11580662.1603; train_masked_gp_l1_reg_loss: 106981.9195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27383.4120; train_chrom_access_recon_loss: 27715377.6031; train_global_loss: 42230329.6183; train_optim_loss: 42230329.6183; val_kl_reg_loss: 53343.1396; val_edge_recon_loss: 2723076.6333; val_gene_expr_recon_loss: 11632945.8667; val_masked_gp_l1_reg_loss: 106205.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26748.5566; val_chrom_access_recon_loss: 27534495.8667; val_global_loss: 42076816.8000; val_optim_loss: 42076816.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9793; val_auprc_score: 0.9741; val_best_acc_score: 0.9302; val_best_f1_score: 0.9326; train_kl_reg_loss: 84326.3569; train_edge_recon_loss: 2705933.1069; train_gene_expr_recon_loss: 11552869.7481; train_masked_gp_l1_reg_loss: 105455.5840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26138.1444; train_chrom_access_recon_loss: 27646213.0382; train_global_loss: 42120935.9084; train_optim_loss: 42120935.9084; val_kl_reg_loss: 59067.7312; val_edge_recon_loss: 2694301.4000; val_gene_expr_recon_loss: 11585910.0000; val_masked_gp_l1_reg_loss: 104802.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25611.7129; val_chrom_access_recon_loss: 27343535.7333; val_global_loss: 41813228.8000; val_optim_loss: 41813228.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9770; val_auprc_score: 0.9710; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 81671.9048; train_edge_recon_loss: 2693392.5439; train_gene_expr_recon_loss: 11554694.0534; train_masked_gp_l1_reg_loss: 104231.2549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25402.1124; train_chrom_access_recon_loss: 27624366.9313; train_global_loss: 42083758.5954; train_optim_loss: 42083758.5954; val_kl_reg_loss: 60922.7258; val_edge_recon_loss: 2689173.9333; val_gene_expr_recon_loss: 11627268.8000; val_masked_gp_l1_reg_loss: 104019.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25264.0781; val_chrom_access_recon_loss: 27527350.8000; val_global_loss: 42034000.0000; val_optim_loss: 42034000.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9777; val_auprc_score: 0.9723; val_best_acc_score: 0.9321; val_best_f1_score: 0.9352; train_kl_reg_loss: 81627.6987; train_edge_recon_loss: 2691007.0916; train_gene_expr_recon_loss: 11553838.3511; train_masked_gp_l1_reg_loss: 103887.3796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25156.6202; train_chrom_access_recon_loss: 27638129.3740; train_global_loss: 42093646.3817; train_optim_loss: 42093646.3817; val_kl_reg_loss: 61112.2391; val_edge_recon_loss: 2703483.3000; val_gene_expr_recon_loss: 11563603.8000; val_masked_gp_l1_reg_loss: 103771.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25060.3750; val_chrom_access_recon_loss: 27358115.0667; val_global_loss: 41815145.8667; val_optim_loss: 41815145.8667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9768; val_auprc_score: 0.9688; val_best_acc_score: 0.9329; val_best_f1_score: 0.9354; train_kl_reg_loss: 81083.6892; train_edge_recon_loss: 2686678.9218; train_gene_expr_recon_loss: 11552330.3664; train_masked_gp_l1_reg_loss: 103662.6119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24964.0381; train_chrom_access_recon_loss: 27602527.3435; train_global_loss: 42051246.9924; train_optim_loss: 42051246.9924; val_kl_reg_loss: 61957.1451; val_edge_recon_loss: 2697176.4500; val_gene_expr_recon_loss: 11580575.8000; val_masked_gp_l1_reg_loss: 103541.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24866.5391; val_chrom_access_recon_loss: 27405633.6000; val_global_loss: 41873752.0000; val_optim_loss: 41873752.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9746; val_auprc_score: 0.9628; val_best_acc_score: 0.9314; val_best_f1_score: 0.9338; train_kl_reg_loss: 80999.0461; train_edge_recon_loss: 2678804.7595; train_gene_expr_recon_loss: 11549489.1298; train_masked_gp_l1_reg_loss: 103426.0075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24778.1836; train_chrom_access_recon_loss: 27605677.0687; train_global_loss: 42043174.4122; train_optim_loss: 42043174.4122; val_kl_reg_loss: 62766.3492; val_edge_recon_loss: 2707613.0667; val_gene_expr_recon_loss: 11722116.8000; val_masked_gp_l1_reg_loss: 103305.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24688.2500; val_chrom_access_recon_loss: 27725847.2000; val_global_loss: 42346337.8667; val_optim_loss: 42346337.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 54 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9771
val AUPRC score: 0.9713
val best accuracy score: 0.9332
val best F1 score: 0.9351
val target rna MSE score: 3.9331
val source rna MSE score: 16.4030
val target atac MSE score: 0.1241
val source atac MSE score: 5.4725
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
