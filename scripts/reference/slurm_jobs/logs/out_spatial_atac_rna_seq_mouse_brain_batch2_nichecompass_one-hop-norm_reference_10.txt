[True]
Run timestamp: 07092023_135041_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6515; val_auprc_score: 0.6293; val_best_acc_score: 0.5094; val_best_f1_score: 0.6709; train_kl_reg_loss: 53611.9850; train_edge_recon_loss: 3524971.4280; train_gene_expr_recon_loss: 12576006.3939; train_masked_gp_l1_reg_loss: 121083.6012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5520947.8428; train_chrom_access_recon_loss: 884825.1515; train_global_loss: 22681446.3939; train_optim_loss: 22681446.3939; val_kl_reg_loss: 50100.4668; val_edge_recon_loss: 4064661.3438; val_gene_expr_recon_loss: 11626965.2500; val_masked_gp_l1_reg_loss: 112618.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1943975.6250; val_chrom_access_recon_loss: 834584.7031; val_global_loss: 18632905.2500; val_optim_loss: 18632905.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6817; val_auprc_score: 0.6719; val_best_acc_score: 0.5938; val_best_f1_score: 0.6971; train_kl_reg_loss: 97962.0224; train_edge_recon_loss: 3523107.5758; train_gene_expr_recon_loss: 11393250.3788; train_masked_gp_l1_reg_loss: 107881.3208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 704916.4650; train_chrom_access_recon_loss: 843191.0388; train_global_loss: 16670308.9545; train_optim_loss: 16670308.9545; val_kl_reg_loss: 101141.7930; val_edge_recon_loss: 4059524.5000; val_gene_expr_recon_loss: 11076570.0000; val_masked_gp_l1_reg_loss: 104436.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228185.5781; val_chrom_access_recon_loss: 810696.7656; val_global_loss: 16380556.2500; val_optim_loss: 16380556.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7563; val_auprc_score: 0.7349; val_best_acc_score: 0.6846; val_best_f1_score: 0.7083; train_kl_reg_loss: 95825.0485; train_edge_recon_loss: 3517985.3030; train_gene_expr_recon_loss: 11182875.2576; train_masked_gp_l1_reg_loss: 104609.7717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170984.6288; train_chrom_access_recon_loss: 832072.1790; train_global_loss: 15904352.1364; train_optim_loss: 15904352.1364; val_kl_reg_loss: 94032.5254; val_edge_recon_loss: 4037168.5312; val_gene_expr_recon_loss: 11047912.1250; val_masked_gp_l1_reg_loss: 105886.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138264.7656; val_chrom_access_recon_loss: 811839.5391; val_global_loss: 16235104.3750; val_optim_loss: 16235104.3750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8105; val_auprc_score: 0.7869; val_best_acc_score: 0.7324; val_best_f1_score: 0.7522; train_kl_reg_loss: 84341.5898; train_edge_recon_loss: 3499260.8902; train_gene_expr_recon_loss: 11091570.0303; train_masked_gp_l1_reg_loss: 107078.4264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123720.3451; train_chrom_access_recon_loss: 826458.9972; train_global_loss: 15732430.1970; train_optim_loss: 15732430.1970; val_kl_reg_loss: 80338.7031; val_edge_recon_loss: 3862235.0000; val_gene_expr_recon_loss: 10901306.0000; val_masked_gp_l1_reg_loss: 108702.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111617.1719; val_chrom_access_recon_loss: 803483.0312; val_global_loss: 15867682.7500; val_optim_loss: 15867682.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8478; val_auprc_score: 0.8272; val_best_acc_score: 0.7697; val_best_f1_score: 0.7854; train_kl_reg_loss: 69017.3901; train_edge_recon_loss: 3286103.2159; train_gene_expr_recon_loss: 11042799.7424; train_masked_gp_l1_reg_loss: 112037.9136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103704.2573; train_chrom_access_recon_loss: 823586.0843; train_global_loss: 15437248.6515; train_optim_loss: 15437248.6515; val_kl_reg_loss: 87203.3281; val_edge_recon_loss: 3051470.8438; val_gene_expr_recon_loss: 10951608.0000; val_masked_gp_l1_reg_loss: 116967.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97005.7188; val_chrom_access_recon_loss: 806144.5938; val_global_loss: 15110400.8750; val_optim_loss: 15110400.8750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8585; val_auprc_score: 0.8259; val_best_acc_score: 0.7816; val_best_f1_score: 0.8075; train_kl_reg_loss: 97209.0333; train_edge_recon_loss: 2970975.1515; train_gene_expr_recon_loss: 10975895.6970; train_masked_gp_l1_reg_loss: 120837.5830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93214.3069; train_chrom_access_recon_loss: 817930.8371; train_global_loss: 15076062.5606; train_optim_loss: 15076062.5606; val_kl_reg_loss: 107861.8652; val_edge_recon_loss: 2956997.8750; val_gene_expr_recon_loss: 10790134.1250; val_masked_gp_l1_reg_loss: 124211.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89318.9688; val_chrom_access_recon_loss: 795295.8047; val_global_loss: 14863820.6250; val_optim_loss: 14863820.6250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8721; val_auprc_score: 0.8374; val_best_acc_score: 0.7982; val_best_f1_score: 0.8240; train_kl_reg_loss: 105443.5904; train_edge_recon_loss: 2898652.5076; train_gene_expr_recon_loss: 10915327.1212; train_masked_gp_l1_reg_loss: 125696.6516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87754.2255; train_chrom_access_recon_loss: 813395.3390; train_global_loss: 14946269.3788; train_optim_loss: 14946269.3788; val_kl_reg_loss: 109030.6406; val_edge_recon_loss: 2909160.6875; val_gene_expr_recon_loss: 10735908.2500; val_masked_gp_l1_reg_loss: 127172.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86485.5391; val_chrom_access_recon_loss: 785676.1250; val_global_loss: 14753433.7500; val_optim_loss: 14753433.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8807; val_auprc_score: 0.8502; val_best_acc_score: 0.8146; val_best_f1_score: 0.8300; train_kl_reg_loss: 107605.8274; train_edge_recon_loss: 2866804.7083; train_gene_expr_recon_loss: 10863877.1818; train_masked_gp_l1_reg_loss: 128282.1023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86177.6663; train_chrom_access_recon_loss: 810847.8580; train_global_loss: 14863595.5000; train_optim_loss: 14863595.5000; val_kl_reg_loss: 106816.2451; val_edge_recon_loss: 2898494.9062; val_gene_expr_recon_loss: 10797877.2500; val_masked_gp_l1_reg_loss: 129802.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87063.1094; val_chrom_access_recon_loss: 793052.6797; val_global_loss: 14813106.0000; val_optim_loss: 14813106.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8994; val_auprc_score: 0.8658; val_best_acc_score: 0.8321; val_best_f1_score: 0.8462; train_kl_reg_loss: 109156.5778; train_edge_recon_loss: 2854097.8977; train_gene_expr_recon_loss: 10795474.4091; train_masked_gp_l1_reg_loss: 130847.0521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86358.9403; train_chrom_access_recon_loss: 805549.4934; train_global_loss: 14781484.3485; train_optim_loss: 14781484.3485; val_kl_reg_loss: 111934.5137; val_edge_recon_loss: 2819898.8438; val_gene_expr_recon_loss: 10646150.8750; val_masked_gp_l1_reg_loss: 131635.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85536.5234; val_chrom_access_recon_loss: 795531.3750; val_global_loss: 14590687.5000; val_optim_loss: 14590687.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8958; val_auprc_score: 0.8651; val_best_acc_score: 0.8275; val_best_f1_score: 0.8429; train_kl_reg_loss: 111448.2830; train_edge_recon_loss: 2834406.6856; train_gene_expr_recon_loss: 10757085.2576; train_masked_gp_l1_reg_loss: 132262.4690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85213.9433; train_chrom_access_recon_loss: 802613.9631; train_global_loss: 14723030.5758; train_optim_loss: 14723030.5758; val_kl_reg_loss: 111835.8818; val_edge_recon_loss: 2843167.7188; val_gene_expr_recon_loss: 10589160.3750; val_masked_gp_l1_reg_loss: 133174.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85250.9141; val_chrom_access_recon_loss: 779421.5938; val_global_loss: 14542010.6250; val_optim_loss: 14542010.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9096; val_auprc_score: 0.8756; val_best_acc_score: 0.8407; val_best_f1_score: 0.8524; train_kl_reg_loss: 110583.6171; train_edge_recon_loss: 2831542.8371; train_gene_expr_recon_loss: 10710855.2879; train_masked_gp_l1_reg_loss: 133591.9621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84303.8542; train_chrom_access_recon_loss: 800294.8362; train_global_loss: 14671172.2727; train_optim_loss: 14671172.2727; val_kl_reg_loss: 105397.7461; val_edge_recon_loss: 2852074.3125; val_gene_expr_recon_loss: 10579637.6250; val_masked_gp_l1_reg_loss: 134625.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84023.2812; val_chrom_access_recon_loss: 787759.6016; val_global_loss: 14543518.1250; val_optim_loss: 14543518.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8955; val_auprc_score: 0.8650; val_best_acc_score: 0.8321; val_best_f1_score: 0.8453; train_kl_reg_loss: 106582.9555; train_edge_recon_loss: 2828583.4015; train_gene_expr_recon_loss: 10665370.5152; train_masked_gp_l1_reg_loss: 135177.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84072.7856; train_chrom_access_recon_loss: 797025.0720; train_global_loss: 14616811.9242; train_optim_loss: 14616811.9242; val_kl_reg_loss: 104041.0898; val_edge_recon_loss: 2863741.6875; val_gene_expr_recon_loss: 10533724.5000; val_masked_gp_l1_reg_loss: 136122.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84363.3828; val_chrom_access_recon_loss: 778789.2344; val_global_loss: 14500781.7500; val_optim_loss: 14500781.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9076; val_auprc_score: 0.8770; val_best_acc_score: 0.8439; val_best_f1_score: 0.8569; train_kl_reg_loss: 104789.7527; train_edge_recon_loss: 2816418.9886; train_gene_expr_recon_loss: 10634491.7879; train_masked_gp_l1_reg_loss: 136772.4332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84183.1715; train_chrom_access_recon_loss: 793756.6544; train_global_loss: 14570412.7273; train_optim_loss: 14570412.7273; val_kl_reg_loss: 104779.7773; val_edge_recon_loss: 2856221.2500; val_gene_expr_recon_loss: 10456282.5000; val_masked_gp_l1_reg_loss: 137209.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84106.8594; val_chrom_access_recon_loss: 777949.3984; val_global_loss: 14416549.8750; val_optim_loss: 14416549.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9130; val_auprc_score: 0.8844; val_best_acc_score: 0.8461; val_best_f1_score: 0.8547; train_kl_reg_loss: 104179.4616; train_edge_recon_loss: 2804732.3447; train_gene_expr_recon_loss: 10597546.3636; train_masked_gp_l1_reg_loss: 137773.5253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84302.8666; train_chrom_access_recon_loss: 791389.0199; train_global_loss: 14519923.5000; train_optim_loss: 14519923.5000; val_kl_reg_loss: 95878.0010; val_edge_recon_loss: 2858794.0000; val_gene_expr_recon_loss: 10409877.6250; val_masked_gp_l1_reg_loss: 138776.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85231.2656; val_chrom_access_recon_loss: 767947.3984; val_global_loss: 14356504.7500; val_optim_loss: 14356504.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9093; val_auprc_score: 0.8749; val_best_acc_score: 0.8501; val_best_f1_score: 0.8592; train_kl_reg_loss: 100562.9319; train_edge_recon_loss: 2799882.3561; train_gene_expr_recon_loss: 10562314.4545; train_masked_gp_l1_reg_loss: 139671.3305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85305.8517; train_chrom_access_recon_loss: 789213.4280; train_global_loss: 14476950.4242; train_optim_loss: 14476950.4242; val_kl_reg_loss: 105801.3555; val_edge_recon_loss: 2821278.9062; val_gene_expr_recon_loss: 10375268.3750; val_masked_gp_l1_reg_loss: 140348.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84903.1094; val_chrom_access_recon_loss: 770642.8281; val_global_loss: 14298243.5000; val_optim_loss: 14298243.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9122; val_auprc_score: 0.8852; val_best_acc_score: 0.8509; val_best_f1_score: 0.8595; train_kl_reg_loss: 102037.5443; train_edge_recon_loss: 2809336.5492; train_gene_expr_recon_loss: 10527226.1818; train_masked_gp_l1_reg_loss: 140771.2282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84939.8436; train_chrom_access_recon_loss: 786497.6136; train_global_loss: 14450808.9545; train_optim_loss: 14450808.9545; val_kl_reg_loss: 101052.1924; val_edge_recon_loss: 2852691.3750; val_gene_expr_recon_loss: 10347698.7500; val_masked_gp_l1_reg_loss: 141388.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84504.2266; val_chrom_access_recon_loss: 766167.4062; val_global_loss: 14293502.5000; val_optim_loss: 14293502.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9168; val_auprc_score: 0.8914; val_best_acc_score: 0.8565; val_best_f1_score: 0.8645; train_kl_reg_loss: 101901.0951; train_edge_recon_loss: 2801439.9167; train_gene_expr_recon_loss: 10499255.9091; train_masked_gp_l1_reg_loss: 141742.6027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84728.3406; train_chrom_access_recon_loss: 784948.7093; train_global_loss: 14414016.5606; train_optim_loss: 14414016.5606; val_kl_reg_loss: 100468.8008; val_edge_recon_loss: 2792703.8438; val_gene_expr_recon_loss: 10324280.5000; val_masked_gp_l1_reg_loss: 142250.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85368.1406; val_chrom_access_recon_loss: 765741.5625; val_global_loss: 14210813.8750; val_optim_loss: 14210813.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9187; val_auprc_score: 0.8910; val_best_acc_score: 0.8576; val_best_f1_score: 0.8647; train_kl_reg_loss: 101170.3924; train_edge_recon_loss: 2800210.9280; train_gene_expr_recon_loss: 10465396.4697; train_masked_gp_l1_reg_loss: 142595.1953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84805.9329; train_chrom_access_recon_loss: 782008.0417; train_global_loss: 14376187.0303; train_optim_loss: 14376187.0303; val_kl_reg_loss: 100115.8359; val_edge_recon_loss: 2820827.4062; val_gene_expr_recon_loss: 10303055.0000; val_masked_gp_l1_reg_loss: 143073.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84996.2031; val_chrom_access_recon_loss: 760026.4062; val_global_loss: 14212094.6250; val_optim_loss: 14212094.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9231; val_auprc_score: 0.8982; val_best_acc_score: 0.8544; val_best_f1_score: 0.8634; train_kl_reg_loss: 101459.2618; train_edge_recon_loss: 2776507.8674; train_gene_expr_recon_loss: 10446409.8030; train_masked_gp_l1_reg_loss: 143273.5019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84302.3723; train_chrom_access_recon_loss: 781587.5786; train_global_loss: 14333540.3182; train_optim_loss: 14333540.3182; val_kl_reg_loss: 105394.7520; val_edge_recon_loss: 2833834.8125; val_gene_expr_recon_loss: 10349998.6250; val_masked_gp_l1_reg_loss: 143786.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84546.2266; val_chrom_access_recon_loss: 760401.6172; val_global_loss: 14277962.7500; val_optim_loss: 14277962.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9283; val_auprc_score: 0.9040; val_best_acc_score: 0.8651; val_best_f1_score: 0.8740; train_kl_reg_loss: 101226.6134; train_edge_recon_loss: 2776019.2235; train_gene_expr_recon_loss: 10418663.5000; train_masked_gp_l1_reg_loss: 144048.6214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84079.4646; train_chrom_access_recon_loss: 778605.1989; train_global_loss: 14302642.6970; train_optim_loss: 14302642.6970; val_kl_reg_loss: 101980.8496; val_edge_recon_loss: 2780243.0625; val_gene_expr_recon_loss: 10303120.1250; val_masked_gp_l1_reg_loss: 144517.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83919.4688; val_chrom_access_recon_loss: 756022.0625; val_global_loss: 14169803.1250; val_optim_loss: 14169803.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9252; val_auprc_score: 0.8997; val_best_acc_score: 0.8641; val_best_f1_score: 0.8723; train_kl_reg_loss: 100119.0727; train_edge_recon_loss: 2776742.0871; train_gene_expr_recon_loss: 10397062.3333; train_masked_gp_l1_reg_loss: 144875.5942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84151.8478; train_chrom_access_recon_loss: 776938.6686; train_global_loss: 14279889.6364; train_optim_loss: 14279889.6364; val_kl_reg_loss: 102035.1348; val_edge_recon_loss: 2802078.1875; val_gene_expr_recon_loss: 10209691.5000; val_masked_gp_l1_reg_loss: 145314.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84508.2266; val_chrom_access_recon_loss: 758493.8828; val_global_loss: 14102120.6250; val_optim_loss: 14102120.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9248; val_auprc_score: 0.8990; val_best_acc_score: 0.8598; val_best_f1_score: 0.8689; train_kl_reg_loss: 101519.7947; train_edge_recon_loss: 2772425.7689; train_gene_expr_recon_loss: 10373847.8636; train_masked_gp_l1_reg_loss: 145363.5078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83763.4753; train_chrom_access_recon_loss: 774899.9214; train_global_loss: 14251820.3030; train_optim_loss: 14251820.3030; val_kl_reg_loss: 104068.7148; val_edge_recon_loss: 2802370.8125; val_gene_expr_recon_loss: 10243878.6250; val_masked_gp_l1_reg_loss: 145578.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83373.5938; val_chrom_access_recon_loss: 754355.0234; val_global_loss: 14133625.3750; val_optim_loss: 14133625.3750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9254; val_auprc_score: 0.8969; val_best_acc_score: 0.8606; val_best_f1_score: 0.8692; train_kl_reg_loss: 102223.3982; train_edge_recon_loss: 2764878.4924; train_gene_expr_recon_loss: 10348474.5000; train_masked_gp_l1_reg_loss: 145468.0542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83199.2522; train_chrom_access_recon_loss: 773222.2443; train_global_loss: 14217465.8939; train_optim_loss: 14217465.8939; val_kl_reg_loss: 99959.5410; val_edge_recon_loss: 2806800.3125; val_gene_expr_recon_loss: 10181267.5000; val_masked_gp_l1_reg_loss: 145804.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83977.8438; val_chrom_access_recon_loss: 755565.0312; val_global_loss: 14073375.2500; val_optim_loss: 14073375.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9288; val_auprc_score: 0.9062; val_best_acc_score: 0.8684; val_best_f1_score: 0.8743; train_kl_reg_loss: 100785.7385; train_edge_recon_loss: 2766275.2803; train_gene_expr_recon_loss: 10330639.2727; train_masked_gp_l1_reg_loss: 145965.8587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83423.6165; train_chrom_access_recon_loss: 771549.7064; train_global_loss: 14198639.4848; train_optim_loss: 14198639.4848; val_kl_reg_loss: 97224.9736; val_edge_recon_loss: 2812887.2188; val_gene_expr_recon_loss: 10199927.2500; val_masked_gp_l1_reg_loss: 146438.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83459.3828; val_chrom_access_recon_loss: 756701.6328; val_global_loss: 14096639.2500; val_optim_loss: 14096639.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9300; val_auprc_score: 0.9108; val_best_acc_score: 0.8686; val_best_f1_score: 0.8751; train_kl_reg_loss: 100164.0178; train_edge_recon_loss: 2755163.2083; train_gene_expr_recon_loss: 10317496.0606; train_masked_gp_l1_reg_loss: 146610.1184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83395.1509; train_chrom_access_recon_loss: 771198.3826; train_global_loss: 14174026.8636; train_optim_loss: 14174026.8636; val_kl_reg_loss: 97188.1494; val_edge_recon_loss: 2794443.0938; val_gene_expr_recon_loss: 10240680.8750; val_masked_gp_l1_reg_loss: 146588.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82746.7031; val_chrom_access_recon_loss: 760355.0938; val_global_loss: 14122002.3750; val_optim_loss: 14122002.3750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9301; val_auprc_score: 0.9049; val_best_acc_score: 0.8692; val_best_f1_score: 0.8769; train_kl_reg_loss: 110672.0692; train_edge_recon_loss: 2803658.2386; train_gene_expr_recon_loss: 10031287.8636; train_masked_gp_l1_reg_loss: 146196.0133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81463.7519; train_chrom_access_recon_loss: 754590.0152; train_global_loss: 13927868.0303; train_optim_loss: 13927868.0303; val_kl_reg_loss: 68697.6348; val_edge_recon_loss: 2783740.7500; val_gene_expr_recon_loss: 9866942.5000; val_masked_gp_l1_reg_loss: 146531.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81743.0781; val_chrom_access_recon_loss: 729584.3984; val_global_loss: 13677239.2500; val_optim_loss: 13677239.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9350; val_auprc_score: 0.9156; val_best_acc_score: 0.8743; val_best_f1_score: 0.8829; train_kl_reg_loss: 107842.0701; train_edge_recon_loss: 2770548.6970; train_gene_expr_recon_loss: 9993479.1667; train_masked_gp_l1_reg_loss: 146981.4084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82307.2320; train_chrom_access_recon_loss: 747545.3229; train_global_loss: 13848703.8030; train_optim_loss: 13848703.8030; val_kl_reg_loss: 74061.5166; val_edge_recon_loss: 2797006.4688; val_gene_expr_recon_loss: 9854716.6250; val_masked_gp_l1_reg_loss: 147201.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82225.6953; val_chrom_access_recon_loss: 726154.8125; val_global_loss: 13681366.3750; val_optim_loss: 13681366.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9315; val_auprc_score: 0.9058; val_best_acc_score: 0.8759; val_best_f1_score: 0.8832; train_kl_reg_loss: 99859.4197; train_edge_recon_loss: 2758740.8144; train_gene_expr_recon_loss: 9975427.8030; train_masked_gp_l1_reg_loss: 147407.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82413.0933; train_chrom_access_recon_loss: 745882.1733; train_global_loss: 13809731.1364; train_optim_loss: 13809731.1364; val_kl_reg_loss: 76889.4883; val_edge_recon_loss: 2781149.6875; val_gene_expr_recon_loss: 9822011.6250; val_masked_gp_l1_reg_loss: 147697.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82303.8906; val_chrom_access_recon_loss: 725939.6328; val_global_loss: 13635992.3750; val_optim_loss: 13635992.3750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9394; val_auprc_score: 0.9164; val_best_acc_score: 0.8845; val_best_f1_score: 0.8910; train_kl_reg_loss: 98061.0806; train_edge_recon_loss: 2753815.8939; train_gene_expr_recon_loss: 9940651.9545; train_masked_gp_l1_reg_loss: 147510.9167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82254.7934; train_chrom_access_recon_loss: 741892.8731; train_global_loss: 13764187.3182; train_optim_loss: 13764187.3182; val_kl_reg_loss: 82500.5830; val_edge_recon_loss: 2780492.6250; val_gene_expr_recon_loss: 9882087.8750; val_masked_gp_l1_reg_loss: 147514.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82215.3281; val_chrom_access_recon_loss: 721155.1328; val_global_loss: 13695965.3750; val_optim_loss: 13695965.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9380; val_auprc_score: 0.9164; val_best_acc_score: 0.8818; val_best_f1_score: 0.8892; train_kl_reg_loss: 95910.5116; train_edge_recon_loss: 2752554.4735; train_gene_expr_recon_loss: 9915774.1212; train_masked_gp_l1_reg_loss: 147296.9491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81840.4879; train_chrom_access_recon_loss: 739831.7055; train_global_loss: 13733208.1818; train_optim_loss: 13733208.1818; val_kl_reg_loss: 80043.0088; val_edge_recon_loss: 2783938.8125; val_gene_expr_recon_loss: 9796423.7500; val_masked_gp_l1_reg_loss: 147131.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81689.0000; val_chrom_access_recon_loss: 716628.4922; val_global_loss: 13605855.0000; val_optim_loss: 13605855.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9401; val_auprc_score: 0.9233; val_best_acc_score: 0.8826; val_best_f1_score: 0.8888; train_kl_reg_loss: 92962.2227; train_edge_recon_loss: 2750886.9470; train_gene_expr_recon_loss: 9911013.4697; train_masked_gp_l1_reg_loss: 146981.6544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81538.3185; train_chrom_access_recon_loss: 736736.6383; train_global_loss: 13720119.2121; train_optim_loss: 13720119.2121; val_kl_reg_loss: 83196.5420; val_edge_recon_loss: 2759906.3750; val_gene_expr_recon_loss: 9770702.2500; val_masked_gp_l1_reg_loss: 146962.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81605.3516; val_chrom_access_recon_loss: 713722.0547; val_global_loss: 13556095.2500; val_optim_loss: 13556095.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9365; val_auprc_score: 0.9137; val_best_acc_score: 0.8818; val_best_f1_score: 0.8880; train_kl_reg_loss: 93520.4089; train_edge_recon_loss: 2744755.5568; train_gene_expr_recon_loss: 9887554.0758; train_masked_gp_l1_reg_loss: 146752.9555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81284.8475; train_chrom_access_recon_loss: 733337.2188; train_global_loss: 13687205.0909; train_optim_loss: 13687205.0909; val_kl_reg_loss: 87950.1689; val_edge_recon_loss: 2770682.1875; val_gene_expr_recon_loss: 9781312.3750; val_masked_gp_l1_reg_loss: 146453.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81437.1641; val_chrom_access_recon_loss: 715680.2891; val_global_loss: 13583516.5000; val_optim_loss: 13583516.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9415; val_auprc_score: 0.9206; val_best_acc_score: 0.8842; val_best_f1_score: 0.8901; train_kl_reg_loss: 93956.9918; train_edge_recon_loss: 2729348.2311; train_gene_expr_recon_loss: 9864568.9242; train_masked_gp_l1_reg_loss: 146183.8828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80722.4271; train_chrom_access_recon_loss: 732299.5843; train_global_loss: 13647080.0000; train_optim_loss: 13647080.0000; val_kl_reg_loss: 86920.3906; val_edge_recon_loss: 2767029.5625; val_gene_expr_recon_loss: 9774754.3750; val_masked_gp_l1_reg_loss: 145970.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80393.6484; val_chrom_access_recon_loss: 712478.3984; val_global_loss: 13567547.7500; val_optim_loss: 13567547.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9412; val_auprc_score: 0.9221; val_best_acc_score: 0.8807; val_best_f1_score: 0.8860; train_kl_reg_loss: 91858.7131; train_edge_recon_loss: 2736379.2538; train_gene_expr_recon_loss: 9854445.3182; train_masked_gp_l1_reg_loss: 146120.4323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80729.5217; train_chrom_access_recon_loss: 731168.9545; train_global_loss: 13640702.2879; train_optim_loss: 13640702.2879; val_kl_reg_loss: 84996.8691; val_edge_recon_loss: 2802727.1250; val_gene_expr_recon_loss: 9817853.3750; val_masked_gp_l1_reg_loss: 146269.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80738.2188; val_chrom_access_recon_loss: 724080.5000; val_global_loss: 13656664.7500; val_optim_loss: 13656664.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9455; val_auprc_score: 0.9242; val_best_acc_score: 0.8907; val_best_f1_score: 0.8962; train_kl_reg_loss: 92069.8374; train_edge_recon_loss: 2735477.0341; train_gene_expr_recon_loss: 9846847.4091; train_masked_gp_l1_reg_loss: 146137.3087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80546.7545; train_chrom_access_recon_loss: 730532.4384; train_global_loss: 13631610.6970; train_optim_loss: 13631610.6970; val_kl_reg_loss: 92502.9805; val_edge_recon_loss: 2744030.9688; val_gene_expr_recon_loss: 9742882.6250; val_masked_gp_l1_reg_loss: 145860.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80354.1875; val_chrom_access_recon_loss: 712695.6562; val_global_loss: 13518327.1250; val_optim_loss: 13518327.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9445; val_auprc_score: 0.9255; val_best_acc_score: 0.8933; val_best_f1_score: 0.8981; train_kl_reg_loss: 95520.4447; train_edge_recon_loss: 2726494.0795; train_gene_expr_recon_loss: 9831801.4545; train_masked_gp_l1_reg_loss: 145541.5192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80110.3623; train_chrom_access_recon_loss: 729054.4422; train_global_loss: 13608522.3182; train_optim_loss: 13608522.3182; val_kl_reg_loss: 88647.8604; val_edge_recon_loss: 2759997.4062; val_gene_expr_recon_loss: 9622319.3750; val_masked_gp_l1_reg_loss: 145611.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80351.1641; val_chrom_access_recon_loss: 702385.0703; val_global_loss: 13399312.5000; val_optim_loss: 13399312.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9437; val_auprc_score: 0.9184; val_best_acc_score: 0.8915; val_best_f1_score: 0.8966; train_kl_reg_loss: 93096.8733; train_edge_recon_loss: 2723162.2424; train_gene_expr_recon_loss: 9825935.8939; train_masked_gp_l1_reg_loss: 145352.5500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79946.6752; train_chrom_access_recon_loss: 728681.1979; train_global_loss: 13596175.4091; train_optim_loss: 13596175.4091; val_kl_reg_loss: 86167.0449; val_edge_recon_loss: 2768683.4688; val_gene_expr_recon_loss: 9690058.6250; val_masked_gp_l1_reg_loss: 145220.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80020.2500; val_chrom_access_recon_loss: 708522.5547; val_global_loss: 13478672.5000; val_optim_loss: 13478672.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9450; val_auprc_score: 0.9232; val_best_acc_score: 0.8923; val_best_f1_score: 0.8977; train_kl_reg_loss: 90938.3952; train_edge_recon_loss: 2733183.6174; train_gene_expr_recon_loss: 9821099.6061; train_masked_gp_l1_reg_loss: 145371.0230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80095.2509; train_chrom_access_recon_loss: 728693.9100; train_global_loss: 13599381.8333; train_optim_loss: 13599381.8333; val_kl_reg_loss: 87596.6592; val_edge_recon_loss: 2750066.0938; val_gene_expr_recon_loss: 9746517.6250; val_masked_gp_l1_reg_loss: 145365.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79809.0156; val_chrom_access_recon_loss: 711591.2578; val_global_loss: 13520946.6250; val_optim_loss: 13520946.6250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9461; val_auprc_score: 0.9219; val_best_acc_score: 0.8904; val_best_f1_score: 0.8953; train_kl_reg_loss: 93150.2212; train_edge_recon_loss: 2722236.3598; train_gene_expr_recon_loss: 9798546.2576; train_masked_gp_l1_reg_loss: 145191.5109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79691.5170; train_chrom_access_recon_loss: 727334.2509; train_global_loss: 13566150.0909; train_optim_loss: 13566150.0909; val_kl_reg_loss: 89440.2793; val_edge_recon_loss: 2752717.5625; val_gene_expr_recon_loss: 9714035.0000; val_masked_gp_l1_reg_loss: 144928.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79100.4219; val_chrom_access_recon_loss: 705052.7109; val_global_loss: 13485274.5000; val_optim_loss: 13485274.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9497; val_auprc_score: 0.9325; val_best_acc_score: 0.8958; val_best_f1_score: 0.9000; train_kl_reg_loss: 93628.6328; train_edge_recon_loss: 2730575.6553; train_gene_expr_recon_loss: 9783423.6818; train_masked_gp_l1_reg_loss: 144869.7652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79583.0366; train_chrom_access_recon_loss: 726185.4451; train_global_loss: 13558266.1667; train_optim_loss: 13558266.1667; val_kl_reg_loss: 90770.1934; val_edge_recon_loss: 2762651.5625; val_gene_expr_recon_loss: 9662556.3750; val_masked_gp_l1_reg_loss: 144924.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80149.0625; val_chrom_access_recon_loss: 704855.3906; val_global_loss: 13445907.7500; val_optim_loss: 13445907.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9475; val_auprc_score: 0.9242; val_best_acc_score: 0.8898; val_best_f1_score: 0.8978; train_kl_reg_loss: 93302.9253; train_edge_recon_loss: 2719458.9924; train_gene_expr_recon_loss: 9778799.5000; train_masked_gp_l1_reg_loss: 142993.1906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62748.7457; train_chrom_access_recon_loss: 726020.8911; train_global_loss: 13523324.1818; train_optim_loss: 13523324.1818; val_kl_reg_loss: 90871.3760; val_edge_recon_loss: 2758782.2500; val_gene_expr_recon_loss: 9670602.3750; val_masked_gp_l1_reg_loss: 142266.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59405.4844; val_chrom_access_recon_loss: 710342.9062; val_global_loss: 13432269.8750; val_optim_loss: 13432269.8750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9550; val_auprc_score: 0.9324; val_best_acc_score: 0.9062; val_best_f1_score: 0.9097; train_kl_reg_loss: 94165.4173; train_edge_recon_loss: 2717449.8598; train_gene_expr_recon_loss: 9781071.1667; train_masked_gp_l1_reg_loss: 142102.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59178.6396; train_chrom_access_recon_loss: 725834.3551; train_global_loss: 13519802.4697; train_optim_loss: 13519802.4697; val_kl_reg_loss: 91247.7393; val_edge_recon_loss: 2723047.6250; val_gene_expr_recon_loss: 9720465.2500; val_masked_gp_l1_reg_loss: 141989.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58981.6953; val_chrom_access_recon_loss: 711885.8750; val_global_loss: 13447618.5000; val_optim_loss: 13447618.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9475; val_auprc_score: 0.9238; val_best_acc_score: 0.8947; val_best_f1_score: 0.8977; train_kl_reg_loss: 95325.0833; train_edge_recon_loss: 2719773.3371; train_gene_expr_recon_loss: 9774520.0606; train_masked_gp_l1_reg_loss: 141917.5095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58828.8467; train_chrom_access_recon_loss: 725483.1297; train_global_loss: 13515848.0303; train_optim_loss: 13515848.0303; val_kl_reg_loss: 91240.7715; val_edge_recon_loss: 2754460.8125; val_gene_expr_recon_loss: 9746599.3750; val_masked_gp_l1_reg_loss: 141866.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58684.4023; val_chrom_access_recon_loss: 709814.2656; val_global_loss: 13502665.0000; val_optim_loss: 13502665.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9497; val_auprc_score: 0.9263; val_best_acc_score: 0.9049; val_best_f1_score: 0.9082; train_kl_reg_loss: 95892.8844; train_edge_recon_loss: 2725454.2727; train_gene_expr_recon_loss: 9775546.4697; train_masked_gp_l1_reg_loss: 141833.1986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58580.3344; train_chrom_access_recon_loss: 725640.3655; train_global_loss: 13522947.5606; train_optim_loss: 13522947.5606; val_kl_reg_loss: 91621.5117; val_edge_recon_loss: 2709484.2500; val_gene_expr_recon_loss: 9627926.7500; val_masked_gp_l1_reg_loss: 141814.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58564.8750; val_chrom_access_recon_loss: 706464.1875; val_global_loss: 13335876.8750; val_optim_loss: 13335876.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9465; val_auprc_score: 0.9260; val_best_acc_score: 0.8939; val_best_f1_score: 0.8989; train_kl_reg_loss: 95138.4834; train_edge_recon_loss: 2719776.6629; train_gene_expr_recon_loss: 9768717.4394; train_masked_gp_l1_reg_loss: 141806.8816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58509.8110; train_chrom_access_recon_loss: 725416.9413; train_global_loss: 13509366.4091; train_optim_loss: 13509366.4091; val_kl_reg_loss: 92048.0156; val_edge_recon_loss: 2745973.1250; val_gene_expr_recon_loss: 9766667.1250; val_masked_gp_l1_reg_loss: 141782.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58450.4922; val_chrom_access_recon_loss: 710082.8984; val_global_loss: 13515004.1250; val_optim_loss: 13515004.1250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9490; val_auprc_score: 0.9302; val_best_acc_score: 0.8955; val_best_f1_score: 0.8996; train_kl_reg_loss: 95704.8152; train_edge_recon_loss: 2718793.7500; train_gene_expr_recon_loss: 9771533.2273; train_masked_gp_l1_reg_loss: 141760.6162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58336.8815; train_chrom_access_recon_loss: 724747.5322; train_global_loss: 13510876.8485; train_optim_loss: 13510876.8485; val_kl_reg_loss: 92352.4316; val_edge_recon_loss: 2753695.8125; val_gene_expr_recon_loss: 9659529.7500; val_masked_gp_l1_reg_loss: 141753.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58282.8906; val_chrom_access_recon_loss: 713027.9922; val_global_loss: 13418642.7500; val_optim_loss: 13418642.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9421; val_auprc_score: 0.9132; val_best_acc_score: 0.8896; val_best_f1_score: 0.8961; train_kl_reg_loss: 96490.2227; train_edge_recon_loss: 2711209.9583; train_gene_expr_recon_loss: 9760231.9848; train_masked_gp_l1_reg_loss: 141725.8942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58193.9759; train_chrom_access_recon_loss: 724695.3030; train_global_loss: 13492547.4242; train_optim_loss: 13492547.4242; val_kl_reg_loss: 92746.2285; val_edge_recon_loss: 2771527.1562; val_gene_expr_recon_loss: 9695268.7500; val_masked_gp_l1_reg_loss: 141701.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58121.7812; val_chrom_access_recon_loss: 718113.0781; val_global_loss: 13477479.0000; val_optim_loss: 13477479.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9470; val_auprc_score: 0.9234; val_best_acc_score: 0.8912; val_best_f1_score: 0.8952; train_kl_reg_loss: 96150.7470; train_edge_recon_loss: 2717358.3409; train_gene_expr_recon_loss: 9767196.1818; train_masked_gp_l1_reg_loss: 141670.0272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58020.0991; train_chrom_access_recon_loss: 725233.9754; train_global_loss: 13505629.3636; train_optim_loss: 13505629.3636; val_kl_reg_loss: 92431.1582; val_edge_recon_loss: 2775868.1562; val_gene_expr_recon_loss: 9694951.5000; val_masked_gp_l1_reg_loss: 141672.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58015.0352; val_chrom_access_recon_loss: 714377.7188; val_global_loss: 13477315.7500; val_optim_loss: 13477315.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9456; val_auprc_score: 0.9242; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 95722.5050; train_edge_recon_loss: 2715795.4053; train_gene_expr_recon_loss: 9768992.7576; train_masked_gp_l1_reg_loss: 141479.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56161.0292; train_chrom_access_recon_loss: 724971.9006; train_global_loss: 13503123.4697; train_optim_loss: 13503123.4697; val_kl_reg_loss: 91865.6104; val_edge_recon_loss: 2775101.3750; val_gene_expr_recon_loss: 9577384.0000; val_masked_gp_l1_reg_loss: 141402.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55802.8867; val_chrom_access_recon_loss: 700753.3203; val_global_loss: 13342309.0000; val_optim_loss: 13342309.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9522; val_auprc_score: 0.9314; val_best_acc_score: 0.9001; val_best_f1_score: 0.9033; train_kl_reg_loss: 95848.4690; train_edge_recon_loss: 2711310.1250; train_gene_expr_recon_loss: 9761135.6515; train_masked_gp_l1_reg_loss: 141375.0057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55766.3555; train_chrom_access_recon_loss: 724861.5871; train_global_loss: 13490297.1667; train_optim_loss: 13490297.1667; val_kl_reg_loss: 92299.2715; val_edge_recon_loss: 2741838.5312; val_gene_expr_recon_loss: 9647843.0000; val_masked_gp_l1_reg_loss: 141354.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55742.4570; val_chrom_access_recon_loss: 715662.9375; val_global_loss: 13394740.7500; val_optim_loss: 13394740.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9528; val_auprc_score: 0.9345; val_best_acc_score: 0.9003; val_best_f1_score: 0.9030; train_kl_reg_loss: 96087.8997; train_edge_recon_loss: 2719728.9205; train_gene_expr_recon_loss: 9759147.8788; train_masked_gp_l1_reg_loss: 141340.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55728.6434; train_chrom_access_recon_loss: 724872.1600; train_global_loss: 13496906.5000; train_optim_loss: 13496906.5000; val_kl_reg_loss: 91573.9141; val_edge_recon_loss: 2730931.0312; val_gene_expr_recon_loss: 9650016.3750; val_masked_gp_l1_reg_loss: 141329.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55704.0938; val_chrom_access_recon_loss: 709470.9531; val_global_loss: 13379025.2500; val_optim_loss: 13379025.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9501; val_auprc_score: 0.9307; val_best_acc_score: 0.8952; val_best_f1_score: 0.9016; train_kl_reg_loss: 95844.1033; train_edge_recon_loss: 2724903.0644; train_gene_expr_recon_loss: 9758115.7273; train_masked_gp_l1_reg_loss: 141321.1858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55693.5758; train_chrom_access_recon_loss: 724587.2481; train_global_loss: 13500464.8788; train_optim_loss: 13500464.8788; val_kl_reg_loss: 91471.2422; val_edge_recon_loss: 2745343.4688; val_gene_expr_recon_loss: 9658480.2500; val_masked_gp_l1_reg_loss: 141315.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55682.2188; val_chrom_access_recon_loss: 705238.3828; val_global_loss: 13397530.0000; val_optim_loss: 13397530.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 20 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9496
val AUPRC score: 0.9297
val best accuracy score: 0.8952
val best F1 score: 0.8995
val target rna MSE score: 1.3954
val source rna MSE score: 0.5169
val target atac MSE score: 0.4557
val source atac MSE score: 0.0997
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
