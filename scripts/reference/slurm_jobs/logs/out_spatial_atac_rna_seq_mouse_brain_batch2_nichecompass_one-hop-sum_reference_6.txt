[True]
Run timestamp: 10082023_182714_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7614; val_auprc_score: 0.7871; val_best_acc_score: 0.5288; val_best_f1_score: 0.6777; train_kl_reg_loss: 115758.1679; train_edge_recon_loss: 3715143.1832; train_gene_expr_recon_loss: 27042377.4504; train_masked_gp_l1_reg_loss: 76234.7453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242427.9055; train_chrom_access_recon_loss: 5543913.7023; train_global_loss: 36735855.2824; train_optim_loss: 36735855.2824; val_kl_reg_loss: 308011.2896; val_edge_recon_loss: 4063451.2167; val_gene_expr_recon_loss: 23058893.3333; val_masked_gp_l1_reg_loss: 72907.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234604.2969; val_chrom_access_recon_loss: 5202695.7000; val_global_loss: 32940563.6000; val_optim_loss: 32940563.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7936; val_auprc_score: 0.8085; val_best_acc_score: 0.6610; val_best_f1_score: 0.7286; train_kl_reg_loss: 188033.2364; train_edge_recon_loss: 3584630.4485; train_gene_expr_recon_loss: 22541827.2824; train_masked_gp_l1_reg_loss: 70136.2245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224889.5928; train_chrom_access_recon_loss: 5152478.3855; train_global_loss: 31761995.0687; train_optim_loss: 31761995.0687; val_kl_reg_loss: 200174.4667; val_edge_recon_loss: 4054262.3500; val_gene_expr_recon_loss: 22370263.0667; val_masked_gp_l1_reg_loss: 68874.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214911.4688; val_chrom_access_recon_loss: 5164121.0000; val_global_loss: 32072606.9333; val_optim_loss: 32072606.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8640; val_auprc_score: 0.8620; val_best_acc_score: 0.7456; val_best_f1_score: 0.7831; train_kl_reg_loss: 161682.6066; train_edge_recon_loss: 3550193.9122; train_gene_expr_recon_loss: 22146760.0916; train_masked_gp_l1_reg_loss: 69291.3845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205278.1285; train_chrom_access_recon_loss: 5114801.6374; train_global_loss: 31248007.6031; train_optim_loss: 31248007.6031; val_kl_reg_loss: 150736.5104; val_edge_recon_loss: 3949479.9000; val_gene_expr_recon_loss: 22031787.7333; val_masked_gp_l1_reg_loss: 70513.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195732.0781; val_chrom_access_recon_loss: 5093096.3333; val_global_loss: 31491346.6667; val_optim_loss: 31491346.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8815; val_auprc_score: 0.8718; val_best_acc_score: 0.7920; val_best_f1_score: 0.8117; train_kl_reg_loss: 138753.4268; train_edge_recon_loss: 3304806.1718; train_gene_expr_recon_loss: 21943425.6336; train_masked_gp_l1_reg_loss: 73099.4993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186982.0691; train_chrom_access_recon_loss: 5077360.7252; train_global_loss: 30724427.5878; train_optim_loss: 30724427.5878; val_kl_reg_loss: 170061.9927; val_edge_recon_loss: 3063344.0667; val_gene_expr_recon_loss: 21841932.9333; val_masked_gp_l1_reg_loss: 76093.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178464.1875; val_chrom_access_recon_loss: 5073409.0000; val_global_loss: 30403306.1333; val_optim_loss: 30403306.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8944; val_auprc_score: 0.8797; val_best_acc_score: 0.8060; val_best_f1_score: 0.8182; train_kl_reg_loss: 172352.7981; train_edge_recon_loss: 2992841.2538; train_gene_expr_recon_loss: 21792777.5115; train_masked_gp_l1_reg_loss: 77273.3006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170937.3432; train_chrom_access_recon_loss: 5052626.9847; train_global_loss: 30258809.1603; train_optim_loss: 30258809.1603; val_kl_reg_loss: 168821.8781; val_edge_recon_loss: 2979947.8333; val_gene_expr_recon_loss: 21745559.6000; val_masked_gp_l1_reg_loss: 78642.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163779.5469; val_chrom_access_recon_loss: 5060938.3667; val_global_loss: 30197689.3333; val_optim_loss: 30197689.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9054; val_auprc_score: 0.8931; val_best_acc_score: 0.8212; val_best_f1_score: 0.8337; train_kl_reg_loss: 166901.6713; train_edge_recon_loss: 2949883.4065; train_gene_expr_recon_loss: 21627361.0534; train_masked_gp_l1_reg_loss: 80243.9180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157270.2914; train_chrom_access_recon_loss: 5026091.2710; train_global_loss: 30007751.5420; train_optim_loss: 30007751.5420; val_kl_reg_loss: 161568.0906; val_edge_recon_loss: 2946367.7000; val_gene_expr_recon_loss: 21681267.6000; val_masked_gp_l1_reg_loss: 81882.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150840.7656; val_chrom_access_recon_loss: 5038941.5333; val_global_loss: 30060866.5333; val_optim_loss: 30060866.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9178; val_auprc_score: 0.9029; val_best_acc_score: 0.8417; val_best_f1_score: 0.8529; train_kl_reg_loss: 160065.3050; train_edge_recon_loss: 2907608.0134; train_gene_expr_recon_loss: 21522217.5115; train_masked_gp_l1_reg_loss: 83329.8658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144852.9015; train_chrom_access_recon_loss: 5008782.7519; train_global_loss: 29826856.1679; train_optim_loss: 29826856.1679; val_kl_reg_loss: 158073.0438; val_edge_recon_loss: 2872485.3667; val_gene_expr_recon_loss: 21470218.0000; val_masked_gp_l1_reg_loss: 84761.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139086.3594; val_chrom_access_recon_loss: 4999749.5667; val_global_loss: 29724373.7333; val_optim_loss: 29724373.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9254; val_auprc_score: 0.9109; val_best_acc_score: 0.8538; val_best_f1_score: 0.8634; train_kl_reg_loss: 152798.3371; train_edge_recon_loss: 2872950.6031; train_gene_expr_recon_loss: 21389922.8397; train_masked_gp_l1_reg_loss: 86236.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133824.5016; train_chrom_access_recon_loss: 4978432.8969; train_global_loss: 29614165.2366; train_optim_loss: 29614165.2366; val_kl_reg_loss: 156349.2229; val_edge_recon_loss: 2871766.8167; val_gene_expr_recon_loss: 21410619.2000; val_masked_gp_l1_reg_loss: 87849.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128822.6953; val_chrom_access_recon_loss: 4999564.8333; val_global_loss: 29654972.0000; val_optim_loss: 29654972.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9362; val_auprc_score: 0.9212; val_best_acc_score: 0.8689; val_best_f1_score: 0.8755; train_kl_reg_loss: 149039.4912; train_edge_recon_loss: 2850697.3836; train_gene_expr_recon_loss: 21333812.8855; train_masked_gp_l1_reg_loss: 88963.4184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124354.0877; train_chrom_access_recon_loss: 4974750.3053; train_global_loss: 29521617.4504; train_optim_loss: 29521617.4504; val_kl_reg_loss: 149633.7531; val_edge_recon_loss: 2859975.8000; val_gene_expr_recon_loss: 21336931.0667; val_masked_gp_l1_reg_loss: 90313.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119999.1250; val_chrom_access_recon_loss: 4977324.7000; val_global_loss: 29534179.6000; val_optim_loss: 29534179.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9460; val_auprc_score: 0.9350; val_best_acc_score: 0.8773; val_best_f1_score: 0.8861; train_kl_reg_loss: 144660.3136; train_edge_recon_loss: 2834326.5782; train_gene_expr_recon_loss: 21243727.8015; train_masked_gp_l1_reg_loss: 91342.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116048.2985; train_chrom_access_recon_loss: 4956676.0420; train_global_loss: 29386781.8626; train_optim_loss: 29386781.8626; val_kl_reg_loss: 137433.0396; val_edge_recon_loss: 2824678.0000; val_gene_expr_recon_loss: 21226380.5333; val_masked_gp_l1_reg_loss: 92319.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112137.8203; val_chrom_access_recon_loss: 4959044.0333; val_global_loss: 29351993.4667; val_optim_loss: 29351993.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9516; val_auprc_score: 0.9382; val_best_acc_score: 0.8867; val_best_f1_score: 0.8937; train_kl_reg_loss: 138060.2989; train_edge_recon_loss: 2816876.0916; train_gene_expr_recon_loss: 21166080.6870; train_masked_gp_l1_reg_loss: 93779.3516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108540.0211; train_chrom_access_recon_loss: 4943014.9427; train_global_loss: 29266351.5115; train_optim_loss: 29266351.5115; val_kl_reg_loss: 136012.0667; val_edge_recon_loss: 2818488.8667; val_gene_expr_recon_loss: 21184740.0000; val_masked_gp_l1_reg_loss: 95515.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105015.5859; val_chrom_access_recon_loss: 4956934.8000; val_global_loss: 29296706.6667; val_optim_loss: 29296706.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9545; val_auprc_score: 0.9457; val_best_acc_score: 0.8897; val_best_f1_score: 0.8939; train_kl_reg_loss: 136451.6066; train_edge_recon_loss: 2789940.1584; train_gene_expr_recon_loss: 21083179.0840; train_masked_gp_l1_reg_loss: 96161.0426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101796.3708; train_chrom_access_recon_loss: 4925937.3931; train_global_loss: 29133465.4962; train_optim_loss: 29133465.4962; val_kl_reg_loss: 133998.3188; val_edge_recon_loss: 2805277.3333; val_gene_expr_recon_loss: 21108742.6667; val_masked_gp_l1_reg_loss: 97213.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98769.7891; val_chrom_access_recon_loss: 4934005.0000; val_global_loss: 29178007.3333; val_optim_loss: 29178007.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9582; val_auprc_score: 0.9460; val_best_acc_score: 0.8985; val_best_f1_score: 0.9035; train_kl_reg_loss: 132928.7848; train_edge_recon_loss: 2781280.0859; train_gene_expr_recon_loss: 21041933.6641; train_masked_gp_l1_reg_loss: 97973.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95963.6379; train_chrom_access_recon_loss: 4921044.7977; train_global_loss: 29071124.4885; train_optim_loss: 29071124.4885; val_kl_reg_loss: 132833.7365; val_edge_recon_loss: 2785088.8333; val_gene_expr_recon_loss: 21121104.0000; val_masked_gp_l1_reg_loss: 98944.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93193.4219; val_chrom_access_recon_loss: 4937389.4333; val_global_loss: 29168553.6000; val_optim_loss: 29168553.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9647; val_auprc_score: 0.9569; val_best_acc_score: 0.9085; val_best_f1_score: 0.9118; train_kl_reg_loss: 131236.0061; train_edge_recon_loss: 2775471.9790; train_gene_expr_recon_loss: 20969332.6718; train_masked_gp_l1_reg_loss: 99889.1039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90664.9812; train_chrom_access_recon_loss: 4904471.2252; train_global_loss: 28971065.8931; train_optim_loss: 28971065.8931; val_kl_reg_loss: 133200.4344; val_edge_recon_loss: 2776599.6500; val_gene_expr_recon_loss: 20985113.4667; val_masked_gp_l1_reg_loss: 100748.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88194.5078; val_chrom_access_recon_loss: 4909383.6000; val_global_loss: 28993238.8000; val_optim_loss: 28993238.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9666; val_auprc_score: 0.9580; val_best_acc_score: 0.9115; val_best_f1_score: 0.9147; train_kl_reg_loss: 128353.3163; train_edge_recon_loss: 2768916.6279; train_gene_expr_recon_loss: 20920972.4275; train_masked_gp_l1_reg_loss: 101758.7315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85788.8064; train_chrom_access_recon_loss: 4900145.0115; train_global_loss: 28905934.8550; train_optim_loss: 28905934.8550; val_kl_reg_loss: 125535.7229; val_edge_recon_loss: 2753734.8167; val_gene_expr_recon_loss: 21010268.4000; val_masked_gp_l1_reg_loss: 102641.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83441.2656; val_chrom_access_recon_loss: 4935241.9000; val_global_loss: 29010864.9333; val_optim_loss: 29010864.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9616; val_auprc_score: 0.9495; val_best_acc_score: 0.9073; val_best_f1_score: 0.9109; train_kl_reg_loss: 124857.6007; train_edge_recon_loss: 2763905.0553; train_gene_expr_recon_loss: 20897558.4885; train_masked_gp_l1_reg_loss: 103625.9301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81263.4479; train_chrom_access_recon_loss: 4898309.8855; train_global_loss: 28869520.4885; train_optim_loss: 28869520.4885; val_kl_reg_loss: 123805.7839; val_edge_recon_loss: 2779311.3167; val_gene_expr_recon_loss: 20945036.1333; val_masked_gp_l1_reg_loss: 104538.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79058.2422; val_chrom_access_recon_loss: 4884108.7667; val_global_loss: 28915858.0000; val_optim_loss: 28915858.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9688; val_auprc_score: 0.9622; val_best_acc_score: 0.9142; val_best_f1_score: 0.9185; train_kl_reg_loss: 122354.4815; train_edge_recon_loss: 2759402.0248; train_gene_expr_recon_loss: 20851795.4351; train_masked_gp_l1_reg_loss: 105383.9470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77094.2954; train_chrom_access_recon_loss: 4888037.8969; train_global_loss: 28804067.9695; train_optim_loss: 28804067.9695; val_kl_reg_loss: 122949.4120; val_edge_recon_loss: 2751937.0667; val_gene_expr_recon_loss: 20791885.8667; val_masked_gp_l1_reg_loss: 106554.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75205.2344; val_chrom_access_recon_loss: 4875993.6667; val_global_loss: 28724526.1333; val_optim_loss: 28724526.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9688; val_auprc_score: 0.9600; val_best_acc_score: 0.9171; val_best_f1_score: 0.9207; train_kl_reg_loss: 121845.9448; train_edge_recon_loss: 2745011.7137; train_gene_expr_recon_loss: 20816928.8702; train_masked_gp_l1_reg_loss: 107244.1059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73538.9006; train_chrom_access_recon_loss: 4885758.1908; train_global_loss: 28750327.7252; train_optim_loss: 28750327.7252; val_kl_reg_loss: 122609.3328; val_edge_recon_loss: 2739133.7000; val_gene_expr_recon_loss: 20794877.7333; val_masked_gp_l1_reg_loss: 107864.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71841.9219; val_chrom_access_recon_loss: 4893498.2667; val_global_loss: 28729825.0667; val_optim_loss: 28729825.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9664; val_auprc_score: 0.9545; val_best_acc_score: 0.9154; val_best_f1_score: 0.9190; train_kl_reg_loss: 119566.9212; train_edge_recon_loss: 2746109.6240; train_gene_expr_recon_loss: 20770740.7786; train_masked_gp_l1_reg_loss: 108766.7628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70204.9531; train_chrom_access_recon_loss: 4875729.0763; train_global_loss: 28691118.0611; train_optim_loss: 28691118.0611; val_kl_reg_loss: 116150.3411; val_edge_recon_loss: 2775337.6667; val_gene_expr_recon_loss: 20800444.9333; val_masked_gp_l1_reg_loss: 109612.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68630.7109; val_chrom_access_recon_loss: 4907885.4667; val_global_loss: 28778060.6667; val_optim_loss: 28778060.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9680; val_auprc_score: 0.9559; val_best_acc_score: 0.9182; val_best_f1_score: 0.9211; train_kl_reg_loss: 118114.3706; train_edge_recon_loss: 2734833.0286; train_gene_expr_recon_loss: 20735498.8244; train_masked_gp_l1_reg_loss: 110458.0018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67154.7396; train_chrom_access_recon_loss: 4870985.7328; train_global_loss: 28637044.7023; train_optim_loss: 28637044.7023; val_kl_reg_loss: 117633.0833; val_edge_recon_loss: 2762294.4167; val_gene_expr_recon_loss: 20793483.4667; val_masked_gp_l1_reg_loss: 111344.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65710.9531; val_chrom_access_recon_loss: 4890699.4333; val_global_loss: 28741164.8000; val_optim_loss: 28741164.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9714; val_auprc_score: 0.9632; val_best_acc_score: 0.9214; val_best_f1_score: 0.9240; train_kl_reg_loss: 115772.4526; train_edge_recon_loss: 2734005.8874; train_gene_expr_recon_loss: 20710748.9313; train_masked_gp_l1_reg_loss: 112022.4287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64433.2889; train_chrom_access_recon_loss: 4868480.6450; train_global_loss: 28605463.7252; train_optim_loss: 28605463.7252; val_kl_reg_loss: 114009.7615; val_edge_recon_loss: 2737736.1667; val_gene_expr_recon_loss: 20792628.1333; val_masked_gp_l1_reg_loss: 112970.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63078.8008; val_chrom_access_recon_loss: 4899060.7667; val_global_loss: 28719483.0667; val_optim_loss: 28719483.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9714; val_auprc_score: 0.9647; val_best_acc_score: 0.9223; val_best_f1_score: 0.9259; train_kl_reg_loss: 114493.6248; train_edge_recon_loss: 2732937.1565; train_gene_expr_recon_loss: 20693916.7176; train_masked_gp_l1_reg_loss: 113651.7323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61834.2688; train_chrom_access_recon_loss: 4872332.3435; train_global_loss: 28589165.8168; train_optim_loss: 28589165.8168; val_kl_reg_loss: 113392.9281; val_edge_recon_loss: 2734622.8333; val_gene_expr_recon_loss: 20665849.8667; val_masked_gp_l1_reg_loss: 114582.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60592.5312; val_chrom_access_recon_loss: 4862268.3667; val_global_loss: 28551307.7333; val_optim_loss: 28551307.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9736; val_auprc_score: 0.9664; val_best_acc_score: 0.9237; val_best_f1_score: 0.9275; train_kl_reg_loss: 113465.7050; train_edge_recon_loss: 2726378.9084; train_gene_expr_recon_loss: 20644169.7405; train_masked_gp_l1_reg_loss: 115277.2311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59440.0567; train_chrom_access_recon_loss: 4856525.3473; train_global_loss: 28515256.9313; train_optim_loss: 28515256.9313; val_kl_reg_loss: 113220.1271; val_edge_recon_loss: 2714363.4000; val_gene_expr_recon_loss: 20743765.8667; val_masked_gp_l1_reg_loss: 116155.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58351.2070; val_chrom_access_recon_loss: 4882290.7000; val_global_loss: 28628147.7333; val_optim_loss: 28628147.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9771; val_auprc_score: 0.9728; val_best_acc_score: 0.9254; val_best_f1_score: 0.9277; train_kl_reg_loss: 111865.1182; train_edge_recon_loss: 2722850.7252; train_gene_expr_recon_loss: 20624829.5115; train_masked_gp_l1_reg_loss: 116930.2936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57333.5982; train_chrom_access_recon_loss: 4858139.2481; train_global_loss: 28491948.5649; train_optim_loss: 28491948.5649; val_kl_reg_loss: 112334.4708; val_edge_recon_loss: 2728308.8833; val_gene_expr_recon_loss: 20695408.2667; val_masked_gp_l1_reg_loss: 117796.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56305.5117; val_chrom_access_recon_loss: 4869369.7000; val_global_loss: 28579523.2000; val_optim_loss: 28579523.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9775; val_auprc_score: 0.9729; val_best_acc_score: 0.9299; val_best_f1_score: 0.9316; train_kl_reg_loss: 110037.0700; train_edge_recon_loss: 2723625.5649; train_gene_expr_recon_loss: 20572853.7863; train_masked_gp_l1_reg_loss: 118473.0627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55386.8166; train_chrom_access_recon_loss: 4851548.6679; train_global_loss: 28431924.9160; train_optim_loss: 28431924.9160; val_kl_reg_loss: 106704.4391; val_edge_recon_loss: 2725860.7667; val_gene_expr_recon_loss: 20645557.8667; val_masked_gp_l1_reg_loss: 119303.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.4219; val_chrom_access_recon_loss: 4863946.5667; val_global_loss: 28515835.6000; val_optim_loss: 28515835.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9745; val_auprc_score: 0.9672; val_best_acc_score: 0.9252; val_best_f1_score: 0.9272; train_kl_reg_loss: 119003.8124; train_edge_recon_loss: 2774630.8874; train_gene_expr_recon_loss: 21472125.2519; train_masked_gp_l1_reg_loss: 119593.3036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55169.5489; train_chrom_access_recon_loss: 4911946.5916; train_global_loss: 29452469.4504; train_optim_loss: 29452469.4504; val_kl_reg_loss: 55168.1284; val_edge_recon_loss: 2752528.3500; val_gene_expr_recon_loss: 21431294.6667; val_masked_gp_l1_reg_loss: 120387.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54910.6953; val_chrom_access_recon_loss: 4905727.1000; val_global_loss: 29320015.8667; val_optim_loss: 29320015.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9730; val_auprc_score: 0.9648; val_best_acc_score: 0.9237; val_best_f1_score: 0.9271; train_kl_reg_loss: 108729.3138; train_edge_recon_loss: 2736123.5458; train_gene_expr_recon_loss: 21385324.5344; train_masked_gp_l1_reg_loss: 121000.8183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54394.3092; train_chrom_access_recon_loss: 4917649.8664; train_global_loss: 29323222.3053; train_optim_loss: 29323222.3053; val_kl_reg_loss: 65094.2135; val_edge_recon_loss: 2720466.3333; val_gene_expr_recon_loss: 21526988.6667; val_masked_gp_l1_reg_loss: 121340.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53794.1094; val_chrom_access_recon_loss: 4989786.1000; val_global_loss: 29477469.3333; val_optim_loss: 29477469.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9763; val_auprc_score: 0.9657; val_best_acc_score: 0.9316; val_best_f1_score: 0.9344; train_kl_reg_loss: 99334.5855; train_edge_recon_loss: 2718101.2729; train_gene_expr_recon_loss: 21320407.6183; train_masked_gp_l1_reg_loss: 121394.8518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53074.1071; train_chrom_access_recon_loss: 4923978.4809; train_global_loss: 29236290.9771; train_optim_loss: 29236290.9771; val_kl_reg_loss: 68901.6745; val_edge_recon_loss: 2715342.0667; val_gene_expr_recon_loss: 21355023.4667; val_masked_gp_l1_reg_loss: 121337.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52340.4922; val_chrom_access_recon_loss: 4916264.1333; val_global_loss: 29229209.3333; val_optim_loss: 29229209.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9777; val_auprc_score: 0.9730; val_best_acc_score: 0.9283; val_best_f1_score: 0.9313; train_kl_reg_loss: 94357.0480; train_edge_recon_loss: 2714320.9752; train_gene_expr_recon_loss: 21260657.1298; train_masked_gp_l1_reg_loss: 121145.7098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51443.8041; train_chrom_access_recon_loss: 4919050.6298; train_global_loss: 29160975.3130; train_optim_loss: 29160975.3130; val_kl_reg_loss: 72592.5990; val_edge_recon_loss: 2717556.2333; val_gene_expr_recon_loss: 21226865.8667; val_masked_gp_l1_reg_loss: 120908.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50442.9766; val_chrom_access_recon_loss: 4909536.6333; val_global_loss: 29097901.4667; val_optim_loss: 29097901.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9753; val_auprc_score: 0.9674; val_best_acc_score: 0.9243; val_best_f1_score: 0.9273; train_kl_reg_loss: 94011.4072; train_edge_recon_loss: 2706616.0496; train_gene_expr_recon_loss: 21218191.3282; train_masked_gp_l1_reg_loss: 120414.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50081.1422; train_chrom_access_recon_loss: 4913986.8664; train_global_loss: 29103301.2519; train_optim_loss: 29103301.2519; val_kl_reg_loss: 74782.7536; val_edge_recon_loss: 2719800.1500; val_gene_expr_recon_loss: 21308261.0667; val_masked_gp_l1_reg_loss: 120246.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49784.4141; val_chrom_access_recon_loss: 4952262.1000; val_global_loss: 29225136.1333; val_optim_loss: 29225136.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9731; val_auprc_score: 0.9669; val_best_acc_score: 0.9260; val_best_f1_score: 0.9286; train_kl_reg_loss: 93858.4843; train_edge_recon_loss: 2711505.4332; train_gene_expr_recon_loss: 21194679.2672; train_masked_gp_l1_reg_loss: 120171.0596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49574.2801; train_chrom_access_recon_loss: 4912464.4924; train_global_loss: 29082253.0076; train_optim_loss: 29082253.0076; val_kl_reg_loss: 74914.4318; val_edge_recon_loss: 2725658.2833; val_gene_expr_recon_loss: 21379926.5333; val_masked_gp_l1_reg_loss: 120104.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49379.2188; val_chrom_access_recon_loss: 4959628.6667; val_global_loss: 29309611.8667; val_optim_loss: 29309611.8667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9757; val_auprc_score: 0.9702; val_best_acc_score: 0.9248; val_best_f1_score: 0.9276; train_kl_reg_loss: 93422.3930; train_edge_recon_loss: 2706643.4046; train_gene_expr_recon_loss: 21174512.3053; train_masked_gp_l1_reg_loss: 120046.4769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49203.3131; train_chrom_access_recon_loss: 4907170.9466; train_global_loss: 29050998.8550; train_optim_loss: 29050998.8550; val_kl_reg_loss: 75885.3219; val_edge_recon_loss: 2721440.0167; val_gene_expr_recon_loss: 21239788.0000; val_masked_gp_l1_reg_loss: 119985.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49025.2422; val_chrom_access_recon_loss: 4917490.6333; val_global_loss: 29123615.8667; val_optim_loss: 29123615.8667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9752; val_auprc_score: 0.9680; val_best_acc_score: 0.9255; val_best_f1_score: 0.9282; train_kl_reg_loss: 93243.0284; train_edge_recon_loss: 2711332.3187; train_gene_expr_recon_loss: 21166853.0992; train_masked_gp_l1_reg_loss: 119924.4522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48864.1287; train_chrom_access_recon_loss: 4907203.0153; train_global_loss: 29047420.0153; train_optim_loss: 29047420.0153; val_kl_reg_loss: 75602.7443; val_edge_recon_loss: 2732976.9000; val_gene_expr_recon_loss: 21211690.9333; val_masked_gp_l1_reg_loss: 119866.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48692.8008; val_chrom_access_recon_loss: 4916189.6333; val_global_loss: 29105017.7333; val_optim_loss: 29105017.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 55 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9749
val AUPRC score: 0.9670
val best accuracy score: 0.9297
val best F1 score: 0.9315
val target rna MSE score: 2.1153
val source rna MSE score: 61.0798
val target atac MSE score: 0.3523
val source atac MSE score: 8.6657
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
