[True]
Run timestamp: 07082023_212124_126.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_126']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8924; val_auprc_score: 0.9097; val_best_acc_score: 0.5115; val_best_f1_score: 0.6718; train_kl_reg_loss: 44566.9597; train_edge_recon_loss: 3477261.0278; train_gene_expr_recon_loss: 1170850.0972; train_masked_gp_l1_reg_loss: 16682.6210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167207.8854; train_chrom_access_recon_loss: 2215481.7917; train_global_loss: 7092050.5000; train_optim_loss: 7092050.5000; val_kl_reg_loss: 14616.0898; val_edge_recon_loss: 4064597.2500; val_gene_expr_recon_loss: 992513.7500; val_masked_gp_l1_reg_loss: 12610.3105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162661.6406; val_chrom_access_recon_loss: 1583800.0000; val_global_loss: 6830799.0000; val_optim_loss: 6830799.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8805; val_auprc_score: 0.8919; val_best_acc_score: 0.5278; val_best_f1_score: 0.6781; train_kl_reg_loss: 12150.6991; train_edge_recon_loss: 3476689.9167; train_gene_expr_recon_loss: 930746.3681; train_masked_gp_l1_reg_loss: 10836.9155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159791.6128; train_chrom_access_recon_loss: 1472212.0694; train_global_loss: 6062427.7778; train_optim_loss: 6062427.7778; val_kl_reg_loss: 10532.2949; val_edge_recon_loss: 4063388.0000; val_gene_expr_recon_loss: 871420.8750; val_masked_gp_l1_reg_loss: 9348.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156268.2812; val_chrom_access_recon_loss: 1416956.2500; val_global_loss: 6527914.0000; val_optim_loss: 6527914.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8757; val_auprc_score: 0.8891; val_best_acc_score: 0.5187; val_best_f1_score: 0.6744; train_kl_reg_loss: 13732.7043; train_edge_recon_loss: 3477760.6944; train_gene_expr_recon_loss: 853442.7431; train_masked_gp_l1_reg_loss: 9152.6342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153326.2361; train_chrom_access_recon_loss: 1395255.0278; train_global_loss: 5902669.9444; train_optim_loss: 5902669.9444; val_kl_reg_loss: 17360.1426; val_edge_recon_loss: 4064092.0000; val_gene_expr_recon_loss: 812512.2500; val_masked_gp_l1_reg_loss: 8992.3691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149454.9688; val_chrom_access_recon_loss: 1390294.7500; val_global_loss: 6442707.0000; val_optim_loss: 6442707.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8754; val_auprc_score: 0.8905; val_best_acc_score: 0.5244; val_best_f1_score: 0.6766; train_kl_reg_loss: 17968.9524; train_edge_recon_loss: 3479175.3056; train_gene_expr_recon_loss: 804024.6597; train_masked_gp_l1_reg_loss: 8783.2299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145981.3958; train_chrom_access_recon_loss: 1379553.1250; train_global_loss: 5835486.6667; train_optim_loss: 5835486.6667; val_kl_reg_loss: 17638.9375; val_edge_recon_loss: 4063800.5000; val_gene_expr_recon_loss: 785339.1250; val_masked_gp_l1_reg_loss: 8573.4287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141416.2344; val_chrom_access_recon_loss: 1373302.7500; val_global_loss: 6390071.0000; val_optim_loss: 6390071.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8786; val_auprc_score: 0.8912; val_best_acc_score: 0.5276; val_best_f1_score: 0.6775; train_kl_reg_loss: 18470.1890; train_edge_recon_loss: 3480008.2222; train_gene_expr_recon_loss: 784227.8333; train_masked_gp_l1_reg_loss: 8502.1947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137522.0156; train_chrom_access_recon_loss: 1361265.8333; train_global_loss: 5789996.3889; train_optim_loss: 5789996.3889; val_kl_reg_loss: 19133.9863; val_edge_recon_loss: 4063453.5000; val_gene_expr_recon_loss: 765198.8750; val_masked_gp_l1_reg_loss: 8425.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132583.4844; val_chrom_access_recon_loss: 1361638.0000; val_global_loss: 6350433.0000; val_optim_loss: 6350433.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8877; val_auprc_score: 0.8954; val_best_acc_score: 0.5345; val_best_f1_score: 0.6799; train_kl_reg_loss: 20516.0851; train_edge_recon_loss: 3480992.0000; train_gene_expr_recon_loss: 759400.0625; train_masked_gp_l1_reg_loss: 8409.7658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128584.3194; train_chrom_access_recon_loss: 1347311.9722; train_global_loss: 5745214.1667; train_optim_loss: 5745214.1667; val_kl_reg_loss: 19619.4219; val_edge_recon_loss: 4062233.2500; val_gene_expr_recon_loss: 748919.3750; val_masked_gp_l1_reg_loss: 8381.2744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123584.4922; val_chrom_access_recon_loss: 1353694.0000; val_global_loss: 6316432.0000; val_optim_loss: 6316432.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8930; val_auprc_score: 0.8953; val_best_acc_score: 0.5590; val_best_f1_score: 0.6908; train_kl_reg_loss: 21248.6350; train_edge_recon_loss: 3480792.3611; train_gene_expr_recon_loss: 746639.2639; train_masked_gp_l1_reg_loss: 8374.6929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119631.6406; train_chrom_access_recon_loss: 1350278.3889; train_global_loss: 5726964.9444; train_optim_loss: 5726964.9444; val_kl_reg_loss: 20474.7637; val_edge_recon_loss: 4059805.7500; val_gene_expr_recon_loss: 735158.5000; val_masked_gp_l1_reg_loss: 8366.2842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114737.4062; val_chrom_access_recon_loss: 1347423.7500; val_global_loss: 6285967.0000; val_optim_loss: 6285967.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8864; val_auprc_score: 0.8838; val_best_acc_score: 0.6338; val_best_f1_score: 0.7277; train_kl_reg_loss: 20857.0410; train_edge_recon_loss: 3481059.4722; train_gene_expr_recon_loss: 732148.0972; train_masked_gp_l1_reg_loss: 8373.0825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110923.4748; train_chrom_access_recon_loss: 1337208.6806; train_global_loss: 5690569.7778; train_optim_loss: 5690569.7778; val_kl_reg_loss: 21708.0586; val_edge_recon_loss: 4056550.5000; val_gene_expr_recon_loss: 724700.8750; val_masked_gp_l1_reg_loss: 8380.3682; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106236.5938; val_chrom_access_recon_loss: 1342396.8750; val_global_loss: 6259973.5000; val_optim_loss: 6259973.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8861; val_auprc_score: 0.8805; val_best_acc_score: 0.7303; val_best_f1_score: 0.7796; train_kl_reg_loss: 22118.4442; train_edge_recon_loss: 3479969.0833; train_gene_expr_recon_loss: 727232.6181; train_masked_gp_l1_reg_loss: 8399.2265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102645.4861; train_chrom_access_recon_loss: 1336273.6806; train_global_loss: 5676638.6667; train_optim_loss: 5676638.6667; val_kl_reg_loss: 18289.8906; val_edge_recon_loss: 4048895.5000; val_gene_expr_recon_loss: 716947.1250; val_masked_gp_l1_reg_loss: 8419.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98256.6875; val_chrom_access_recon_loss: 1337884.3750; val_global_loss: 6228693.0000; val_optim_loss: 6228693.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8861; val_auprc_score: 0.8788; val_best_acc_score: 0.8023; val_best_f1_score: 0.8197; train_kl_reg_loss: 20614.3934; train_edge_recon_loss: 3479926.5833; train_gene_expr_recon_loss: 718807.8056; train_masked_gp_l1_reg_loss: 8455.9030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94934.2049; train_chrom_access_recon_loss: 1335094.0972; train_global_loss: 5657832.8889; train_optim_loss: 5657832.8889; val_kl_reg_loss: 20138.4121; val_edge_recon_loss: 4028773.2500; val_gene_expr_recon_loss: 708408.6875; val_masked_gp_l1_reg_loss: 8488.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90900.0938; val_chrom_access_recon_loss: 1333784.6250; val_global_loss: 6190493.5000; val_optim_loss: 6190493.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9040; val_auprc_score: 0.8904; val_best_acc_score: 0.7943; val_best_f1_score: 0.8214; train_kl_reg_loss: 20239.8390; train_edge_recon_loss: 3474760.8056; train_gene_expr_recon_loss: 709900.4861; train_masked_gp_l1_reg_loss: 8521.5753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87878.2144; train_chrom_access_recon_loss: 1329316.2917; train_global_loss: 5630617.1667; train_optim_loss: 5630617.1667; val_kl_reg_loss: 17679.9785; val_edge_recon_loss: 3919201.2500; val_gene_expr_recon_loss: 704094.7500; val_masked_gp_l1_reg_loss: 8551.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84236.3672; val_chrom_access_recon_loss: 1330442.3750; val_global_loss: 6064206.5000; val_optim_loss: 6064206.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9175; val_auprc_score: 0.9018; val_best_acc_score: 0.8406; val_best_f1_score: 0.8492; train_kl_reg_loss: 14104.1289; train_edge_recon_loss: 3426900.0833; train_gene_expr_recon_loss: 714013.6042; train_masked_gp_l1_reg_loss: 8594.5863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81549.8915; train_chrom_access_recon_loss: 1327396.6944; train_global_loss: 5572559.0556; train_optim_loss: 5572559.0556; val_kl_reg_loss: 8607.2383; val_edge_recon_loss: 3345824.0000; val_gene_expr_recon_loss: 720804.6875; val_masked_gp_l1_reg_loss: 8653.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78335.8828; val_chrom_access_recon_loss: 1333718.8750; val_global_loss: 5495945.0000; val_optim_loss: 5495945.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9092; val_auprc_score: 0.8871; val_best_acc_score: 0.8391; val_best_f1_score: 0.8482; train_kl_reg_loss: 10824.9774; train_edge_recon_loss: 3076592.3889; train_gene_expr_recon_loss: 750425.6944; train_masked_gp_l1_reg_loss: 8737.2994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76052.1328; train_chrom_access_recon_loss: 1338185.9444; train_global_loss: 5260818.4444; train_optim_loss: 5260818.4444; val_kl_reg_loss: 21058.9609; val_edge_recon_loss: 2820388.5000; val_gene_expr_recon_loss: 766971.1250; val_masked_gp_l1_reg_loss: 8833.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73358.7812; val_chrom_access_recon_loss: 1348604.7500; val_global_loss: 5039215.0000; val_optim_loss: 5039215.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9182; val_auprc_score: 0.8950; val_best_acc_score: 0.8486; val_best_f1_score: 0.8612; train_kl_reg_loss: 33076.9158; train_edge_recon_loss: 2790590.8889; train_gene_expr_recon_loss: 767520.6111; train_masked_gp_l1_reg_loss: 8875.8670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71377.1233; train_chrom_access_recon_loss: 1347689.5972; train_global_loss: 5019131.1111; train_optim_loss: 5019131.1111; val_kl_reg_loss: 44636.7695; val_edge_recon_loss: 2764508.2500; val_gene_expr_recon_loss: 742797.2500; val_masked_gp_l1_reg_loss: 8927.9697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68992.4375; val_chrom_access_recon_loss: 1337664.7500; val_global_loss: 4967527.5000; val_optim_loss: 4967527.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9243; val_auprc_score: 0.8986; val_best_acc_score: 0.8635; val_best_f1_score: 0.8721; train_kl_reg_loss: 49004.2765; train_edge_recon_loss: 2746392.3056; train_gene_expr_recon_loss: 739401.9236; train_masked_gp_l1_reg_loss: 8956.0184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67210.9193; train_chrom_access_recon_loss: 1327900.0556; train_global_loss: 4938865.5000; train_optim_loss: 4938865.5000; val_kl_reg_loss: 51168.3672; val_edge_recon_loss: 2774526.7500; val_gene_expr_recon_loss: 730501.9375; val_masked_gp_l1_reg_loss: 8971.4619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65024.1797; val_chrom_access_recon_loss: 1332121.2500; val_global_loss: 4962314.0000; val_optim_loss: 4962314.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9278; val_auprc_score: 0.9016; val_best_acc_score: 0.8703; val_best_f1_score: 0.8795; train_kl_reg_loss: 50592.8802; train_edge_recon_loss: 2741346.8889; train_gene_expr_recon_loss: 731547.6458; train_masked_gp_l1_reg_loss: 8953.3982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63355.0148; train_chrom_access_recon_loss: 1321162.9444; train_global_loss: 4916958.8333; train_optim_loss: 4916958.8333; val_kl_reg_loss: 48627.0078; val_edge_recon_loss: 2738296.7500; val_gene_expr_recon_loss: 723002.3750; val_masked_gp_l1_reg_loss: 8929.9580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61313.0391; val_chrom_access_recon_loss: 1327238.2500; val_global_loss: 4907407.0000; val_optim_loss: 4907407.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9245; val_auprc_score: 0.8950; val_best_acc_score: 0.8646; val_best_f1_score: 0.8763; train_kl_reg_loss: 46809.6936; train_edge_recon_loss: 2730451.7500; train_gene_expr_recon_loss: 727007.2778; train_masked_gp_l1_reg_loss: 8918.3917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59762.1593; train_chrom_access_recon_loss: 1324115.1389; train_global_loss: 4897064.5000; train_optim_loss: 4897064.5000; val_kl_reg_loss: 44692.2734; val_edge_recon_loss: 2766261.0000; val_gene_expr_recon_loss: 718525.3750; val_masked_gp_l1_reg_loss: 8913.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57875.0391; val_chrom_access_recon_loss: 1323643.7500; val_global_loss: 4919911.0000; val_optim_loss: 4919911.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9380; val_auprc_score: 0.9178; val_best_acc_score: 0.8809; val_best_f1_score: 0.8899; train_kl_reg_loss: 44577.6367; train_edge_recon_loss: 2732710.3056; train_gene_expr_recon_loss: 718507.6458; train_masked_gp_l1_reg_loss: 8904.2110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56446.6749; train_chrom_access_recon_loss: 1317110.8472; train_global_loss: 4878257.3889; train_optim_loss: 4878257.3889; val_kl_reg_loss: 42913.5000; val_edge_recon_loss: 2713858.0000; val_gene_expr_recon_loss: 712853.5000; val_masked_gp_l1_reg_loss: 8906.3467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54708.5898; val_chrom_access_recon_loss: 1320760.2500; val_global_loss: 4854000.0000; val_optim_loss: 4854000.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9370; val_auprc_score: 0.9165; val_best_acc_score: 0.8800; val_best_f1_score: 0.8900; train_kl_reg_loss: 43720.1871; train_edge_recon_loss: 2717214.4722; train_gene_expr_recon_loss: 710987.0764; train_masked_gp_l1_reg_loss: 8905.0616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53404.9588; train_chrom_access_recon_loss: 1313370.0278; train_global_loss: 4847601.7778; train_optim_loss: 4847601.7778; val_kl_reg_loss: 42533.3203; val_edge_recon_loss: 2731117.0000; val_gene_expr_recon_loss: 710028.1875; val_masked_gp_l1_reg_loss: 8882.1152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51798.3281; val_chrom_access_recon_loss: 1317628.7500; val_global_loss: 4861987.5000; val_optim_loss: 4861987.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9429; val_auprc_score: 0.9194; val_best_acc_score: 0.8910; val_best_f1_score: 0.8983; train_kl_reg_loss: 43478.2565; train_edge_recon_loss: 2721179.4167; train_gene_expr_recon_loss: 709897.4722; train_masked_gp_l1_reg_loss: 8885.2331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50594.5625; train_chrom_access_recon_loss: 1309106.6111; train_global_loss: 4843141.5556; train_optim_loss: 4843141.5556; val_kl_reg_loss: 42024.6406; val_edge_recon_loss: 2740281.5000; val_gene_expr_recon_loss: 704593.0000; val_masked_gp_l1_reg_loss: 8889.2549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49127.5312; val_chrom_access_recon_loss: 1314970.8750; val_global_loss: 4859887.0000; val_optim_loss: 4859887.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9438; val_auprc_score: 0.9242; val_best_acc_score: 0.8914; val_best_f1_score: 0.8990; train_kl_reg_loss: 42191.9158; train_edge_recon_loss: 2718865.5000; train_gene_expr_recon_loss: 707498.3958; train_masked_gp_l1_reg_loss: 8891.7475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48018.1389; train_chrom_access_recon_loss: 1309082.8889; train_global_loss: 4834548.5556; train_optim_loss: 4834548.5556; val_kl_reg_loss: 41047.8672; val_edge_recon_loss: 2723676.2500; val_gene_expr_recon_loss: 702119.5000; val_masked_gp_l1_reg_loss: 8900.6855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46670.0859; val_chrom_access_recon_loss: 1312662.5000; val_global_loss: 4835077.0000; val_optim_loss: 4835077.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9521; val_auprc_score: 0.9366; val_best_acc_score: 0.8991; val_best_f1_score: 0.9048; train_kl_reg_loss: 41612.8016; train_edge_recon_loss: 2723528.9444; train_gene_expr_recon_loss: 707509.3056; train_masked_gp_l1_reg_loss: 8910.1350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45647.4588; train_chrom_access_recon_loss: 1312940.1111; train_global_loss: 4840148.7778; train_optim_loss: 4840148.7778; val_kl_reg_loss: 39851.3164; val_edge_recon_loss: 2716741.5000; val_gene_expr_recon_loss: 699947.1250; val_masked_gp_l1_reg_loss: 8927.2061; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44402.2266; val_chrom_access_recon_loss: 1310296.7500; val_global_loss: 4820166.0000; val_optim_loss: 4820166.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9556; val_auprc_score: 0.9367; val_best_acc_score: 0.9041; val_best_f1_score: 0.9096; train_kl_reg_loss: 41177.7504; train_edge_recon_loss: 2720154.4444; train_gene_expr_recon_loss: 702603.1736; train_masked_gp_l1_reg_loss: 8945.3889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43460.2943; train_chrom_access_recon_loss: 1309870.6944; train_global_loss: 4826211.8333; train_optim_loss: 4826211.8333; val_kl_reg_loss: 40204.9062; val_edge_recon_loss: 2721096.7500; val_gene_expr_recon_loss: 696096.8125; val_masked_gp_l1_reg_loss: 8966.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42301.7422; val_chrom_access_recon_loss: 1307624.5000; val_global_loss: 4816292.0000; val_optim_loss: 4816292.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9602; val_auprc_score: 0.9439; val_best_acc_score: 0.9132; val_best_f1_score: 0.9174; train_kl_reg_loss: 40679.2196; train_edge_recon_loss: 2705149.4444; train_gene_expr_recon_loss: 700854.7917; train_masked_gp_l1_reg_loss: 8983.3230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41417.2044; train_chrom_access_recon_loss: 1302938.5972; train_global_loss: 4800022.5556; train_optim_loss: 4800022.5556; val_kl_reg_loss: 38820.5859; val_edge_recon_loss: 2682968.7500; val_gene_expr_recon_loss: 695557.4375; val_masked_gp_l1_reg_loss: 9005.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40339.0469; val_chrom_access_recon_loss: 1305960.5000; val_global_loss: 4772652.0000; val_optim_loss: 4772652.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9646; val_auprc_score: 0.9496; val_best_acc_score: 0.9165; val_best_f1_score: 0.9205; train_kl_reg_loss: 39698.2023; train_edge_recon_loss: 2706657.9444; train_gene_expr_recon_loss: 695280.5000; train_masked_gp_l1_reg_loss: 9028.9240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39526.5477; train_chrom_access_recon_loss: 1300191.0139; train_global_loss: 4790383.1667; train_optim_loss: 4790383.1667; val_kl_reg_loss: 38187.3906; val_edge_recon_loss: 2706584.2500; val_gene_expr_recon_loss: 694610.2500; val_masked_gp_l1_reg_loss: 9037.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38524.4219; val_chrom_access_recon_loss: 1304843.5000; val_global_loss: 4791788.0000; val_optim_loss: 4791788.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9676; val_auprc_score: 0.9542; val_best_acc_score: 0.9235; val_best_f1_score: 0.9250; train_kl_reg_loss: 36361.4727; train_edge_recon_loss: 2704537.3333; train_gene_expr_recon_loss: 937610.0000; train_masked_gp_l1_reg_loss: 9042.3888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37517.1532; train_chrom_access_recon_loss: 1375740.5694; train_global_loss: 5100808.8333; train_optim_loss: 5100808.8333; val_kl_reg_loss: 14557.8320; val_edge_recon_loss: 2722107.5000; val_gene_expr_recon_loss: 928018.5000; val_masked_gp_l1_reg_loss: 9048.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36129.8281; val_chrom_access_recon_loss: 1381671.3750; val_global_loss: 5091533.0000; val_optim_loss: 5091533.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9705; val_auprc_score: 0.9596; val_best_acc_score: 0.9248; val_best_f1_score: 0.9274; train_kl_reg_loss: 32272.3312; train_edge_recon_loss: 2695901.8056; train_gene_expr_recon_loss: 932806.9028; train_masked_gp_l1_reg_loss: 9078.3094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34942.3806; train_chrom_access_recon_loss: 1377927.0833; train_global_loss: 5082928.8333; train_optim_loss: 5082928.8333; val_kl_reg_loss: 14292.9824; val_edge_recon_loss: 2684408.7500; val_gene_expr_recon_loss: 932805.5625; val_masked_gp_l1_reg_loss: 9115.9502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33464.6133; val_chrom_access_recon_loss: 1381878.3750; val_global_loss: 5055966.0000; val_optim_loss: 5055966.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9702; val_auprc_score: 0.9562; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 30462.4850; train_edge_recon_loss: 2679380.3889; train_gene_expr_recon_loss: 938049.7500; train_masked_gp_l1_reg_loss: 9151.7763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32329.6161; train_chrom_access_recon_loss: 1380054.6250; train_global_loss: 5069428.6667; train_optim_loss: 5069428.6667; val_kl_reg_loss: 14432.4785; val_edge_recon_loss: 2678388.0000; val_gene_expr_recon_loss: 929087.7500; val_masked_gp_l1_reg_loss: 9202.9346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30951.1094; val_chrom_access_recon_loss: 1380982.3750; val_global_loss: 5043044.5000; val_optim_loss: 5043044.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9720; val_auprc_score: 0.9596; val_best_acc_score: 0.9301; val_best_f1_score: 0.9331; train_kl_reg_loss: 28935.7046; train_edge_recon_loss: 2667239.0000; train_gene_expr_recon_loss: 934598.0486; train_masked_gp_l1_reg_loss: 9137.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30756.2285; train_chrom_access_recon_loss: 1374549.4722; train_global_loss: 5045216.1667; train_optim_loss: 5045216.1667; val_kl_reg_loss: 14483.9824; val_edge_recon_loss: 2677624.2500; val_gene_expr_recon_loss: 928665.2500; val_masked_gp_l1_reg_loss: 9081.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30537.0020; val_chrom_access_recon_loss: 1380302.7500; val_global_loss: 5040695.0000; val_optim_loss: 5040695.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9679; val_auprc_score: 0.9538; val_best_acc_score: 0.9268; val_best_f1_score: 0.9296; train_kl_reg_loss: 28721.3077; train_edge_recon_loss: 2665863.3333; train_gene_expr_recon_loss: 933399.3889; train_masked_gp_l1_reg_loss: 9070.8739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30396.0775; train_chrom_access_recon_loss: 1377083.3611; train_global_loss: 5044534.2778; train_optim_loss: 5044534.2778; val_kl_reg_loss: 14439.3896; val_edge_recon_loss: 2687162.5000; val_gene_expr_recon_loss: 927526.1250; val_masked_gp_l1_reg_loss: 9052.0283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30215.8008; val_chrom_access_recon_loss: 1380306.7500; val_global_loss: 5048702.5000; val_optim_loss: 5048702.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9721; val_auprc_score: 0.9576; val_best_acc_score: 0.9317; val_best_f1_score: 0.9338; train_kl_reg_loss: 28380.3112; train_edge_recon_loss: 2664231.1389; train_gene_expr_recon_loss: 931575.5764; train_masked_gp_l1_reg_loss: 9044.8076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30083.5419; train_chrom_access_recon_loss: 1375508.5833; train_global_loss: 5038824.0000; train_optim_loss: 5038824.0000; val_kl_reg_loss: 14489.5234; val_edge_recon_loss: 2689861.2500; val_gene_expr_recon_loss: 926704.8750; val_masked_gp_l1_reg_loss: 9037.4717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29921.5234; val_chrom_access_recon_loss: 1379575.3750; val_global_loss: 5049590.0000; val_optim_loss: 5049590.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9702; val_auprc_score: 0.9581; val_best_acc_score: 0.9285; val_best_f1_score: 0.9311; train_kl_reg_loss: 28416.5705; train_edge_recon_loss: 2662061.3056; train_gene_expr_recon_loss: 927732.5000; train_masked_gp_l1_reg_loss: 9035.6629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29799.3839; train_chrom_access_recon_loss: 1369380.7083; train_global_loss: 5026426.1111; train_optim_loss: 5026426.1111; val_kl_reg_loss: 14603.8984; val_edge_recon_loss: 2672258.2500; val_gene_expr_recon_loss: 927856.7500; val_masked_gp_l1_reg_loss: 9034.6973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29653.6875; val_chrom_access_recon_loss: 1380268.7500; val_global_loss: 5033676.0000; val_optim_loss: 5033676.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 22 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9600
val AUPRC score: 0.9426
val best accuracy score: 0.9105
val best F1 score: 0.9151
val target rna MSE score: 4.0312
val source rna MSE score: 3.2935
val target atac MSE score: 0.1343
val source atac MSE score: 0.0212
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
