[True]
Run timestamp: 07082023_205951_114.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_114']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8720; val_auprc_score: 0.8907; val_best_acc_score: 0.5182; val_best_f1_score: 0.6747; train_kl_reg_loss: 58820.1197; train_edge_recon_loss: 3479858.9444; train_gene_expr_recon_loss: 1257136.3056; train_masked_gp_l1_reg_loss: 8901.6370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167343.8160; train_chrom_access_recon_loss: 2237862.8750; train_global_loss: 7209923.7778; train_optim_loss: 7209923.7778; val_kl_reg_loss: 20933.5977; val_edge_recon_loss: 4064312.2500; val_gene_expr_recon_loss: 1045086.7500; val_masked_gp_l1_reg_loss: 7630.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162725.0156; val_chrom_access_recon_loss: 1610789.7500; val_global_loss: 6911477.0000; val_optim_loss: 6911477.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8722; val_auprc_score: 0.8889; val_best_acc_score: 0.5218; val_best_f1_score: 0.6760; train_kl_reg_loss: 15778.2778; train_edge_recon_loss: 3479417.2500; train_gene_expr_recon_loss: 963328.3542; train_masked_gp_l1_reg_loss: 7178.5857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159792.5208; train_chrom_access_recon_loss: 1500887.2361; train_global_loss: 6126382.2222; train_optim_loss: 6126382.2222; val_kl_reg_loss: 11956.8887; val_edge_recon_loss: 4063926.2500; val_gene_expr_recon_loss: 881176.5000; val_masked_gp_l1_reg_loss: 6808.5176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156214.7969; val_chrom_access_recon_loss: 1405338.0000; val_global_loss: 6525421.5000; val_optim_loss: 6525421.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8685; val_auprc_score: 0.8853; val_best_acc_score: 0.5238; val_best_f1_score: 0.6771; train_kl_reg_loss: 15031.8991; train_edge_recon_loss: 3479057.0000; train_gene_expr_recon_loss: 854575.0764; train_masked_gp_l1_reg_loss: 6769.7893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153258.0903; train_chrom_access_recon_loss: 1393702.8056; train_global_loss: 5902394.7222; train_optim_loss: 5902394.7222; val_kl_reg_loss: 14854.5518; val_edge_recon_loss: 4064051.2500; val_gene_expr_recon_loss: 818828.8125; val_masked_gp_l1_reg_loss: 6765.3994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149386.3438; val_chrom_access_recon_loss: 1376408.5000; val_global_loss: 6430295.0000; val_optim_loss: 6430295.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8551; val_auprc_score: 0.8745; val_best_acc_score: 0.5295; val_best_f1_score: 0.6791; train_kl_reg_loss: 17780.6124; train_edge_recon_loss: 3480360.6389; train_gene_expr_recon_loss: 816701.3333; train_masked_gp_l1_reg_loss: 6727.1020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145949.7587; train_chrom_access_recon_loss: 1383527.8611; train_global_loss: 5851047.1667; train_optim_loss: 5851047.1667; val_kl_reg_loss: 14539.4375; val_edge_recon_loss: 4063448.5000; val_gene_expr_recon_loss: 790932.8750; val_masked_gp_l1_reg_loss: 6657.2505; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141456.8750; val_chrom_access_recon_loss: 1360082.1250; val_global_loss: 6377117.5000; val_optim_loss: 6377117.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8476; val_auprc_score: 0.8640; val_best_acc_score: 0.5447; val_best_f1_score: 0.6857; train_kl_reg_loss: 17523.0431; train_edge_recon_loss: 3480114.4444; train_gene_expr_recon_loss: 788678.0764; train_masked_gp_l1_reg_loss: 6626.2858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137649.1858; train_chrom_access_recon_loss: 1366823.4028; train_global_loss: 5797414.3889; train_optim_loss: 5797414.3889; val_kl_reg_loss: 16728.5625; val_edge_recon_loss: 4062413.2500; val_gene_expr_recon_loss: 770098.5000; val_masked_gp_l1_reg_loss: 6591.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132823.2969; val_chrom_access_recon_loss: 1349252.5000; val_global_loss: 6337907.5000; val_optim_loss: 6337907.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8578; val_auprc_score: 0.8708; val_best_acc_score: 0.5527; val_best_f1_score: 0.6876; train_kl_reg_loss: 20533.6029; train_edge_recon_loss: 3482344.6111; train_gene_expr_recon_loss: 767367.9167; train_masked_gp_l1_reg_loss: 6572.2159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128915.3681; train_chrom_access_recon_loss: 1349956.9583; train_global_loss: 5755690.5556; train_optim_loss: 5755690.5556; val_kl_reg_loss: 19958.6758; val_edge_recon_loss: 4060528.7500; val_gene_expr_recon_loss: 751521.1875; val_masked_gp_l1_reg_loss: 6545.9419; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124032.1484; val_chrom_access_recon_loss: 1341387.7500; val_global_loss: 6303974.0000; val_optim_loss: 6303974.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8655; val_auprc_score: 0.8691; val_best_acc_score: 0.5790; val_best_f1_score: 0.6986; train_kl_reg_loss: 21793.1296; train_edge_recon_loss: 3481973.8056; train_gene_expr_recon_loss: 750571.8056; train_masked_gp_l1_reg_loss: 6542.2572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120171.2274; train_chrom_access_recon_loss: 1351604.5833; train_global_loss: 5732656.8889; train_optim_loss: 5732656.8889; val_kl_reg_loss: 19676.0938; val_edge_recon_loss: 4056818.5000; val_gene_expr_recon_loss: 736677.3750; val_masked_gp_l1_reg_loss: 6535.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115392.5938; val_chrom_access_recon_loss: 1335232.7500; val_global_loss: 6270333.0000; val_optim_loss: 6270333.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8703; val_auprc_score: 0.8622; val_best_acc_score: 0.6766; val_best_f1_score: 0.7486; train_kl_reg_loss: 21905.1026; train_edge_recon_loss: 3481711.3056; train_gene_expr_recon_loss: 737340.8056; train_masked_gp_l1_reg_loss: 6542.3893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111677.3845; train_chrom_access_recon_loss: 1342666.2778; train_global_loss: 5701843.0556; train_optim_loss: 5701843.0556; val_kl_reg_loss: 19258.6016; val_edge_recon_loss: 4047347.5000; val_gene_expr_recon_loss: 724641.5625; val_masked_gp_l1_reg_loss: 6547.4395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107113.4453; val_chrom_access_recon_loss: 1330402.5000; val_global_loss: 6235311.0000; val_optim_loss: 6235311.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8724; val_auprc_score: 0.8648; val_best_acc_score: 0.7755; val_best_f1_score: 0.8030; train_kl_reg_loss: 21717.1515; train_edge_recon_loss: 3479539.5278; train_gene_expr_recon_loss: 727232.0972; train_masked_gp_l1_reg_loss: 6568.8321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103617.8142; train_chrom_access_recon_loss: 1337498.8889; train_global_loss: 5676174.3333; train_optim_loss: 5676174.3333; val_kl_reg_loss: 18742.9609; val_edge_recon_loss: 4030962.2500; val_gene_expr_recon_loss: 714544.0625; val_masked_gp_l1_reg_loss: 6581.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99350.1875; val_chrom_access_recon_loss: 1326141.7500; val_global_loss: 6196323.0000; val_optim_loss: 6196323.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8814; val_auprc_score: 0.8740; val_best_acc_score: 0.8087; val_best_f1_score: 0.8081; train_kl_reg_loss: 20532.3145; train_edge_recon_loss: 3476009.0278; train_gene_expr_recon_loss: 717816.2917; train_masked_gp_l1_reg_loss: 6602.0314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96120.9913; train_chrom_access_recon_loss: 1333910.5972; train_global_loss: 5650991.2222; train_optim_loss: 5650991.2222; val_kl_reg_loss: 19487.9570; val_edge_recon_loss: 3991485.5000; val_gene_expr_recon_loss: 705400.7500; val_masked_gp_l1_reg_loss: 6619.8018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92197.0312; val_chrom_access_recon_loss: 1322009.8750; val_global_loss: 6137201.0000; val_optim_loss: 6137201.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8914; val_auprc_score: 0.8777; val_best_acc_score: 0.8091; val_best_f1_score: 0.8238; train_kl_reg_loss: 18535.1374; train_edge_recon_loss: 3465279.1667; train_gene_expr_recon_loss: 711673.1389; train_masked_gp_l1_reg_loss: 6645.8619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89255.5547; train_chrom_access_recon_loss: 1325546.0139; train_global_loss: 5616934.9444; train_optim_loss: 5616934.9444; val_kl_reg_loss: 14322.3828; val_edge_recon_loss: 3844829.7500; val_gene_expr_recon_loss: 705089.3125; val_masked_gp_l1_reg_loss: 6667.7744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85700.9766; val_chrom_access_recon_loss: 1319940.8750; val_global_loss: 5976551.5000; val_optim_loss: 5976551.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8892; val_auprc_score: 0.8675; val_best_acc_score: 0.8123; val_best_f1_score: 0.8258; train_kl_reg_loss: 12208.5333; train_edge_recon_loss: 3379051.3889; train_gene_expr_recon_loss: 718148.9861; train_masked_gp_l1_reg_loss: 6708.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83082.1589; train_chrom_access_recon_loss: 1330994.3750; train_global_loss: 5530193.9444; train_optim_loss: 5530193.9444; val_kl_reg_loss: 8306.1172; val_edge_recon_loss: 3165300.7500; val_gene_expr_recon_loss: 733091.8750; val_masked_gp_l1_reg_loss: 6759.0474; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79959.8281; val_chrom_access_recon_loss: 1327496.7500; val_global_loss: 5320914.0000; val_optim_loss: 5320914.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8908; val_auprc_score: 0.8713; val_best_acc_score: 0.8073; val_best_f1_score: 0.8246; train_kl_reg_loss: 15657.3700; train_edge_recon_loss: 2970079.8611; train_gene_expr_recon_loss: 764425.4792; train_masked_gp_l1_reg_loss: 6845.9901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77755.9349; train_chrom_access_recon_loss: 1345918.1528; train_global_loss: 5180682.7778; train_optim_loss: 5180682.7778; val_kl_reg_loss: 28737.1602; val_edge_recon_loss: 2842419.7500; val_gene_expr_recon_loss: 759384.8750; val_masked_gp_l1_reg_loss: 6965.8252; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75152.2656; val_chrom_access_recon_loss: 1334005.3750; val_global_loss: 5046665.5000; val_optim_loss: 5046665.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9111; val_auprc_score: 0.8881; val_best_acc_score: 0.8379; val_best_f1_score: 0.8507; train_kl_reg_loss: 39757.1291; train_edge_recon_loss: 2806410.4444; train_gene_expr_recon_loss: 748551.2569; train_masked_gp_l1_reg_loss: 7042.1104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73228.1589; train_chrom_access_recon_loss: 1330088.4861; train_global_loss: 5005077.6111; train_optim_loss: 5005077.6111; val_kl_reg_loss: 48854.7109; val_edge_recon_loss: 2786489.7500; val_gene_expr_recon_loss: 735822.9375; val_masked_gp_l1_reg_loss: 7105.0688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70873.4141; val_chrom_access_recon_loss: 1323769.3750; val_global_loss: 4972915.5000; val_optim_loss: 4972915.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9155; val_auprc_score: 0.8930; val_best_acc_score: 0.8465; val_best_f1_score: 0.8586; train_kl_reg_loss: 50840.8003; train_edge_recon_loss: 2767366.1944; train_gene_expr_recon_loss: 732071.1736; train_masked_gp_l1_reg_loss: 7121.6158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69064.0547; train_chrom_access_recon_loss: 1326448.4028; train_global_loss: 4952912.1667; train_optim_loss: 4952912.1667; val_kl_reg_loss: 48656.9180; val_edge_recon_loss: 2769648.2500; val_gene_expr_recon_loss: 723065.0625; val_masked_gp_l1_reg_loss: 7136.6084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66841.4219; val_chrom_access_recon_loss: 1318490.7500; val_global_loss: 4933839.0000; val_optim_loss: 4933839.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9312; val_auprc_score: 0.9128; val_best_acc_score: 0.8663; val_best_f1_score: 0.8739; train_kl_reg_loss: 47933.8299; train_edge_recon_loss: 2763837.6944; train_gene_expr_recon_loss: 723680.7431; train_masked_gp_l1_reg_loss: 7143.7417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65161.6788; train_chrom_access_recon_loss: 1322686.0972; train_global_loss: 4930443.8333; train_optim_loss: 4930443.8333; val_kl_reg_loss: 43722.6562; val_edge_recon_loss: 2731290.7500; val_gene_expr_recon_loss: 716711.0000; val_masked_gp_l1_reg_loss: 7142.6084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63113.3789; val_chrom_access_recon_loss: 1315228.7500; val_global_loss: 4877209.0000; val_optim_loss: 4877209.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9333; val_auprc_score: 0.9125; val_best_acc_score: 0.8717; val_best_f1_score: 0.8810; train_kl_reg_loss: 45777.4553; train_edge_recon_loss: 2748987.9444; train_gene_expr_recon_loss: 723726.6181; train_masked_gp_l1_reg_loss: 7142.8309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61557.2960; train_chrom_access_recon_loss: 1330413.2639; train_global_loss: 4917605.4444; train_optim_loss: 4917605.4444; val_kl_reg_loss: 44197.4141; val_edge_recon_loss: 2742598.0000; val_gene_expr_recon_loss: 711014.2500; val_masked_gp_l1_reg_loss: 7135.8193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59662.0664; val_chrom_access_recon_loss: 1312119.6250; val_global_loss: 4876727.0000; val_optim_loss: 4876727.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9343; val_auprc_score: 0.9126; val_best_acc_score: 0.8736; val_best_f1_score: 0.8816; train_kl_reg_loss: 47791.5625; train_edge_recon_loss: 2740082.9167; train_gene_expr_recon_loss: 711264.5764; train_masked_gp_l1_reg_loss: 7138.1055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58242.7986; train_chrom_access_recon_loss: 1310330.5556; train_global_loss: 4874850.6111; train_optim_loss: 4874850.6111; val_kl_reg_loss: 46751.0352; val_edge_recon_loss: 2760598.7500; val_gene_expr_recon_loss: 704676.8125; val_masked_gp_l1_reg_loss: 7132.4028; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56508.3672; val_chrom_access_recon_loss: 1309364.5000; val_global_loss: 4885032.0000; val_optim_loss: 4885032.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9354; val_auprc_score: 0.9126; val_best_acc_score: 0.8742; val_best_f1_score: 0.8839; train_kl_reg_loss: 47930.7214; train_edge_recon_loss: 2725420.0556; train_gene_expr_recon_loss: 703636.1250; train_masked_gp_l1_reg_loss: 7136.1755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55196.6372; train_chrom_access_recon_loss: 1313603.6111; train_global_loss: 4852923.3333; train_optim_loss: 4852923.3333; val_kl_reg_loss: 44590.4531; val_edge_recon_loss: 2746235.5000; val_gene_expr_recon_loss: 700539.1250; val_masked_gp_l1_reg_loss: 7134.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53593.8594; val_chrom_access_recon_loss: 1305825.0000; val_global_loss: 4857918.0000; val_optim_loss: 4857918.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9381; val_auprc_score: 0.9204; val_best_acc_score: 0.8774; val_best_f1_score: 0.8863; train_kl_reg_loss: 45304.1970; train_edge_recon_loss: 2734591.3889; train_gene_expr_recon_loss: 705292.5000; train_masked_gp_l1_reg_loss: 7134.5218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52382.4766; train_chrom_access_recon_loss: 1314711.7917; train_global_loss: 4859416.8889; train_optim_loss: 4859416.8889; val_kl_reg_loss: 42310.0430; val_edge_recon_loss: 2742768.7500; val_gene_expr_recon_loss: 700231.7500; val_masked_gp_l1_reg_loss: 7124.8003; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50912.7539; val_chrom_access_recon_loss: 1303476.2500; val_global_loss: 4846824.0000; val_optim_loss: 4846824.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9458; val_auprc_score: 0.9276; val_best_acc_score: 0.8855; val_best_f1_score: 0.8925; train_kl_reg_loss: 43797.9232; train_edge_recon_loss: 2724716.6111; train_gene_expr_recon_loss: 703216.1389; train_masked_gp_l1_reg_loss: 7128.6294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49808.4918; train_chrom_access_recon_loss: 1311304.3611; train_global_loss: 4839972.1111; train_optim_loss: 4839972.1111; val_kl_reg_loss: 42931.8047; val_edge_recon_loss: 2739530.2500; val_gene_expr_recon_loss: 698774.0000; val_masked_gp_l1_reg_loss: 7136.0283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48464.3281; val_chrom_access_recon_loss: 1302780.3750; val_global_loss: 4839616.5000; val_optim_loss: 4839616.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9525; val_auprc_score: 0.9382; val_best_acc_score: 0.8905; val_best_f1_score: 0.8967; train_kl_reg_loss: 43845.8529; train_edge_recon_loss: 2710316.6111; train_gene_expr_recon_loss: 699652.6458; train_masked_gp_l1_reg_loss: 7146.0769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47446.3125; train_chrom_access_recon_loss: 1308530.1806; train_global_loss: 4816937.7222; train_optim_loss: 4816937.7222; val_kl_reg_loss: 42084.8047; val_edge_recon_loss: 2721965.0000; val_gene_expr_recon_loss: 698759.6250; val_masked_gp_l1_reg_loss: 7152.1650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46196.8047; val_chrom_access_recon_loss: 1300487.2500; val_global_loss: 4816646.0000; val_optim_loss: 4816646.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9531; val_auprc_score: 0.9375; val_best_acc_score: 0.8996; val_best_f1_score: 0.9048; train_kl_reg_loss: 42446.6536; train_edge_recon_loss: 2712029.4167; train_gene_expr_recon_loss: 697731.0000; train_masked_gp_l1_reg_loss: 7162.4450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45265.4540; train_chrom_access_recon_loss: 1307715.0417; train_global_loss: 4812350.0556; train_optim_loss: 4812350.0556; val_kl_reg_loss: 40147.7266; val_edge_recon_loss: 2726290.5000; val_gene_expr_recon_loss: 694629.9375; val_masked_gp_l1_reg_loss: 7171.7217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44117.4023; val_chrom_access_recon_loss: 1298181.1250; val_global_loss: 4810538.5000; val_optim_loss: 4810538.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9568; val_auprc_score: 0.9397; val_best_acc_score: 0.9014; val_best_f1_score: 0.9056; train_kl_reg_loss: 40288.2639; train_edge_recon_loss: 2708764.2222; train_gene_expr_recon_loss: 695575.9931; train_masked_gp_l1_reg_loss: 7186.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43246.5330; train_chrom_access_recon_loss: 1304025.2917; train_global_loss: 4799087.0556; train_optim_loss: 4799087.0556; val_kl_reg_loss: 38981.6445; val_edge_recon_loss: 2724075.5000; val_gene_expr_recon_loss: 695163.0000; val_masked_gp_l1_reg_loss: 7189.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42173.3672; val_chrom_access_recon_loss: 1297161.3750; val_global_loss: 4804744.0000; val_optim_loss: 4804744.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9614; val_auprc_score: 0.9493; val_best_acc_score: 0.9092; val_best_f1_score: 0.9144; train_kl_reg_loss: 39929.8216; train_edge_recon_loss: 2689166.6111; train_gene_expr_recon_loss: 692951.7917; train_masked_gp_l1_reg_loss: 7201.5613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41363.7986; train_chrom_access_recon_loss: 1300072.6389; train_global_loss: 4770686.2222; train_optim_loss: 4770686.2222; val_kl_reg_loss: 37774.2578; val_edge_recon_loss: 2698138.0000; val_gene_expr_recon_loss: 693492.6875; val_masked_gp_l1_reg_loss: 7203.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40367.9531; val_chrom_access_recon_loss: 1294942.8750; val_global_loss: 4771919.0000; val_optim_loss: 4771919.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9649; val_auprc_score: 0.9476; val_best_acc_score: 0.9170; val_best_f1_score: 0.9201; train_kl_reg_loss: 36986.6975; train_edge_recon_loss: 2681546.2778; train_gene_expr_recon_loss: 998363.5694; train_masked_gp_l1_reg_loss: 7253.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39412.6589; train_chrom_access_recon_loss: 1373552.2917; train_global_loss: 5137114.8333; train_optim_loss: 5137114.8333; val_kl_reg_loss: 23600.1152; val_edge_recon_loss: 2684914.7500; val_gene_expr_recon_loss: 993620.7500; val_masked_gp_l1_reg_loss: 7324.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38119.3086; val_chrom_access_recon_loss: 1364261.8750; val_global_loss: 5111841.5000; val_optim_loss: 5111841.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9668; val_auprc_score: 0.9529; val_best_acc_score: 0.9201; val_best_f1_score: 0.9240; train_kl_reg_loss: 33479.1892; train_edge_recon_loss: 2679535.7222; train_gene_expr_recon_loss: 994899.4375; train_masked_gp_l1_reg_loss: 7392.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37024.9280; train_chrom_access_recon_loss: 1379705.0556; train_global_loss: 5132037.2222; train_optim_loss: 5132037.2222; val_kl_reg_loss: 22807.7500; val_edge_recon_loss: 2681667.2500; val_gene_expr_recon_loss: 991124.2500; val_masked_gp_l1_reg_loss: 7478.6377; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35664.1836; val_chrom_access_recon_loss: 1363645.5000; val_global_loss: 5102388.0000; val_optim_loss: 5102388.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9678; val_auprc_score: 0.9540; val_best_acc_score: 0.9236; val_best_f1_score: 0.9264; train_kl_reg_loss: 32629.6599; train_edge_recon_loss: 2670113.3611; train_gene_expr_recon_loss: 988469.3056; train_masked_gp_l1_reg_loss: 7554.4790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34615.9748; train_chrom_access_recon_loss: 1372685.2500; train_global_loss: 5106068.1111; train_optim_loss: 5106068.1111; val_kl_reg_loss: 23753.0859; val_edge_recon_loss: 2660812.2500; val_gene_expr_recon_loss: 987648.8750; val_masked_gp_l1_reg_loss: 7645.2661; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33340.9805; val_chrom_access_recon_loss: 1361807.3750; val_global_loss: 5075007.5000; val_optim_loss: 5075007.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9691; val_auprc_score: 0.9570; val_best_acc_score: 0.9239; val_best_f1_score: 0.9272; train_kl_reg_loss: 33687.4592; train_edge_recon_loss: 2659838.0833; train_gene_expr_recon_loss: 989716.0486; train_masked_gp_l1_reg_loss: 7716.4980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32388.5686; train_chrom_access_recon_loss: 1366570.1528; train_global_loss: 5089916.8333; train_optim_loss: 5089916.8333; val_kl_reg_loss: 24126.7422; val_edge_recon_loss: 2651389.0000; val_gene_expr_recon_loss: 984614.6250; val_masked_gp_l1_reg_loss: 7809.6489; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31238.4570; val_chrom_access_recon_loss: 1359556.0000; val_global_loss: 5058735.0000; val_optim_loss: 5058735.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9730; val_auprc_score: 0.9645; val_best_acc_score: 0.9289; val_best_f1_score: 0.9316; train_kl_reg_loss: 33377.2834; train_edge_recon_loss: 2661687.8611; train_gene_expr_recon_loss: 988934.3611; train_masked_gp_l1_reg_loss: 7792.1033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31064.2118; train_chrom_access_recon_loss: 1362517.4306; train_global_loss: 5085373.2778; train_optim_loss: 5085373.2778; val_kl_reg_loss: 24064.5430; val_edge_recon_loss: 2659031.5000; val_gene_expr_recon_loss: 982683.8750; val_masked_gp_l1_reg_loss: 7773.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30871.6113; val_chrom_access_recon_loss: 1359021.5000; val_global_loss: 5063446.5000; val_optim_loss: 5063446.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9704; val_auprc_score: 0.9567; val_best_acc_score: 0.9244; val_best_f1_score: 0.9269; train_kl_reg_loss: 33232.1081; train_edge_recon_loss: 2667296.0833; train_gene_expr_recon_loss: 984094.8958; train_masked_gp_l1_reg_loss: 7771.3483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30753.3722; train_chrom_access_recon_loss: 1368715.9861; train_global_loss: 5091863.8333; train_optim_loss: 5091863.8333; val_kl_reg_loss: 24034.9648; val_edge_recon_loss: 2663637.0000; val_gene_expr_recon_loss: 982769.5000; val_masked_gp_l1_reg_loss: 7767.8882; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30600.5762; val_chrom_access_recon_loss: 1359074.0000; val_global_loss: 5067884.0000; val_optim_loss: 5067884.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9692; val_auprc_score: 0.9551; val_best_acc_score: 0.9243; val_best_f1_score: 0.9274; train_kl_reg_loss: 33144.0905; train_edge_recon_loss: 2649285.0000; train_gene_expr_recon_loss: 989154.3611; train_masked_gp_l1_reg_loss: 7768.3590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30489.5447; train_chrom_access_recon_loss: 1366252.9861; train_global_loss: 5076094.1667; train_optim_loss: 5076094.1667; val_kl_reg_loss: 24027.4219; val_edge_recon_loss: 2666558.5000; val_gene_expr_recon_loss: 982342.3750; val_masked_gp_l1_reg_loss: 7769.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30353.6562; val_chrom_access_recon_loss: 1358883.8750; val_global_loss: 5069935.5000; val_optim_loss: 5069935.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9695; val_auprc_score: 0.9548; val_best_acc_score: 0.9270; val_best_f1_score: 0.9300; train_kl_reg_loss: 32880.2756; train_edge_recon_loss: 2658561.2500; train_gene_expr_recon_loss: 985623.9028; train_masked_gp_l1_reg_loss: 7772.6441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30250.2033; train_chrom_access_recon_loss: 1366856.7083; train_global_loss: 5081945.1111; train_optim_loss: 5081945.1111; val_kl_reg_loss: 23858.8047; val_edge_recon_loss: 2660461.0000; val_gene_expr_recon_loss: 982886.1250; val_masked_gp_l1_reg_loss: 7776.7378; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30126.2617; val_chrom_access_recon_loss: 1358824.1250; val_global_loss: 5063933.0000; val_optim_loss: 5063933.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9648
val AUPRC score: 0.9480
val best accuracy score: 0.9116
val best F1 score: 0.9165
val target rna MSE score: 3.8938
val source rna MSE score: 3.1738
val target atac MSE score: 0.1337
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
