[True]
Run timestamp: 26072023_032206_114.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_114']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9662; val_auprc_score: 0.9687; val_best_acc_score: 0.8891; val_best_f1_score: 0.8938; train_kl_reg_loss: 4976.8446; train_edge_recon_loss: 34664728.0000; train_gene_expr_recon_loss: 315374.7986; train_masked_gp_l1_reg_loss: 1551.1473; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1084798.6250; train_global_loss: 36071430.6667; train_optim_loss: 36071430.6667; val_kl_reg_loss: 8672.4375; val_edge_recon_loss: 40462020.0000; val_gene_expr_recon_loss: 313321.0000; val_masked_gp_l1_reg_loss: 1256.0730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1087634.7500; val_global_loss: 41872904.0000; val_optim_loss: 41872904.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9515; val_auprc_score: 0.9518; val_best_acc_score: 0.8255; val_best_f1_score: 0.8480; train_kl_reg_loss: 4034.4117; train_edge_recon_loss: 34659524.4444; train_gene_expr_recon_loss: 314026.7118; train_masked_gp_l1_reg_loss: 1123.8023; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077111.1944; train_global_loss: 36055820.8889; train_optim_loss: 36055820.8889; val_kl_reg_loss: 880.8127; val_edge_recon_loss: 39217184.0000; val_gene_expr_recon_loss: 312128.3125; val_masked_gp_l1_reg_loss: 995.6713; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1086058.6250; val_global_loss: 40617248.0000; val_optim_loss: 40617248.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8755; val_auprc_score: 0.8630; val_best_acc_score: 0.7808; val_best_f1_score: 0.8089; train_kl_reg_loss: 795.7481; train_edge_recon_loss: 34261712.6667; train_gene_expr_recon_loss: 312339.2639; train_masked_gp_l1_reg_loss: 950.0431; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1082508.9583; train_global_loss: 35658306.2222; train_optim_loss: 35658306.2222; val_kl_reg_loss: 1370.1729; val_edge_recon_loss: 31191238.0000; val_gene_expr_recon_loss: 310419.4062; val_masked_gp_l1_reg_loss: 924.5812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1084898.2500; val_global_loss: 32588850.0000; val_optim_loss: 32588850.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8614; val_auprc_score: 0.8526; val_best_acc_score: 0.7668; val_best_f1_score: 0.7937; train_kl_reg_loss: 6180.0613; train_edge_recon_loss: 30466816.6667; train_gene_expr_recon_loss: 311914.3993; train_masked_gp_l1_reg_loss: 942.7400; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078665.1667; train_global_loss: 31864518.6667; train_optim_loss: 31864518.6667; val_kl_reg_loss: 18801.2188; val_edge_recon_loss: 28420490.0000; val_gene_expr_recon_loss: 312845.4375; val_masked_gp_l1_reg_loss: 955.0859; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083273.0000; val_global_loss: 29836368.0000; val_optim_loss: 29836368.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8855; val_auprc_score: 0.8756; val_best_acc_score: 0.7754; val_best_f1_score: 0.7969; train_kl_reg_loss: 29029.0527; train_edge_recon_loss: 28456316.6667; train_gene_expr_recon_loss: 310783.0104; train_masked_gp_l1_reg_loss: 889.3126; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073118.0139; train_global_loss: 29870135.7778; train_optim_loss: 29870135.7778; val_kl_reg_loss: 40422.5469; val_edge_recon_loss: 28683398.0000; val_gene_expr_recon_loss: 305793.0312; val_masked_gp_l1_reg_loss: 814.4311; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1081210.6250; val_global_loss: 30111638.0000; val_optim_loss: 30111638.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8886; val_auprc_score: 0.8686; val_best_acc_score: 0.8010; val_best_f1_score: 0.8130; train_kl_reg_loss: 45881.9588; train_edge_recon_loss: 28231663.3333; train_gene_expr_recon_loss: 306280.8403; train_masked_gp_l1_reg_loss: 789.8747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1072912.7500; train_global_loss: 29657528.6667; train_optim_loss: 29657528.6667; val_kl_reg_loss: 49834.9570; val_edge_recon_loss: 28223618.0000; val_gene_expr_recon_loss: 300911.7500; val_masked_gp_l1_reg_loss: 772.6269; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075046.0000; val_global_loss: 29650182.0000; val_optim_loss: 29650182.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8980; val_auprc_score: 0.8665; val_best_acc_score: 0.8297; val_best_f1_score: 0.8414; train_kl_reg_loss: 52516.1406; train_edge_recon_loss: 27906966.6667; train_gene_expr_recon_loss: 302323.5660; train_masked_gp_l1_reg_loss: 766.0447; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1067256.3403; train_global_loss: 29329827.7778; train_optim_loss: 29329827.7778; val_kl_reg_loss: 52926.3438; val_edge_recon_loss: 27645526.0000; val_gene_expr_recon_loss: 299642.6875; val_masked_gp_l1_reg_loss: 753.4099; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1072709.5000; val_global_loss: 29071558.0000; val_optim_loss: 29071558.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9180; val_auprc_score: 0.8890; val_best_acc_score: 0.8579; val_best_f1_score: 0.8673; train_kl_reg_loss: 53327.6202; train_edge_recon_loss: 27383312.4444; train_gene_expr_recon_loss: 299761.9931; train_masked_gp_l1_reg_loss: 753.9194; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058573.2500; train_global_loss: 28795729.7778; train_optim_loss: 28795729.7778; val_kl_reg_loss: 53648.9922; val_edge_recon_loss: 27067996.0000; val_gene_expr_recon_loss: 300158.6562; val_masked_gp_l1_reg_loss: 754.7521; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1073137.7500; val_global_loss: 28495694.0000; val_optim_loss: 28495694.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9250; val_auprc_score: 0.9042; val_best_acc_score: 0.8580; val_best_f1_score: 0.8666; train_kl_reg_loss: 54993.2617; train_edge_recon_loss: 27110050.0000; train_gene_expr_recon_loss: 298998.6458; train_masked_gp_l1_reg_loss: 758.6692; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060314.7361; train_global_loss: 28525115.5556; train_optim_loss: 28525115.5556; val_kl_reg_loss: 53512.1680; val_edge_recon_loss: 27264542.0000; val_gene_expr_recon_loss: 297715.3438; val_masked_gp_l1_reg_loss: 770.1348; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067361.1250; val_global_loss: 28683902.0000; val_optim_loss: 28683902.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9260; val_auprc_score: 0.9041; val_best_acc_score: 0.8619; val_best_f1_score: 0.8711; train_kl_reg_loss: 52550.9779; train_edge_recon_loss: 27066004.6667; train_gene_expr_recon_loss: 297108.8611; train_masked_gp_l1_reg_loss: 783.7011; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059825.1111; train_global_loss: 28476273.1111; train_optim_loss: 28476273.1111; val_kl_reg_loss: 47983.2227; val_edge_recon_loss: 27272940.0000; val_gene_expr_recon_loss: 292607.0312; val_masked_gp_l1_reg_loss: 797.4913; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1069575.1250; val_global_loss: 28683906.0000; val_optim_loss: 28683906.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9410; val_auprc_score: 0.9228; val_best_acc_score: 0.8836; val_best_f1_score: 0.8899; train_kl_reg_loss: 48819.4870; train_edge_recon_loss: 27011148.4444; train_gene_expr_recon_loss: 293493.8056; train_masked_gp_l1_reg_loss: 823.4569; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057108.8264; train_global_loss: 28411394.4444; train_optim_loss: 28411394.4444; val_kl_reg_loss: 47147.8594; val_edge_recon_loss: 26753216.0000; val_gene_expr_recon_loss: 297583.3125; val_masked_gp_l1_reg_loss: 842.4611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061258.3750; val_global_loss: 28160048.0000; val_optim_loss: 28160048.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9402; val_auprc_score: 0.9162; val_best_acc_score: 0.8856; val_best_f1_score: 0.8916; train_kl_reg_loss: 47286.5161; train_edge_recon_loss: 26813342.2222; train_gene_expr_recon_loss: 292815.4306; train_masked_gp_l1_reg_loss: 858.2311; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058034.8542; train_global_loss: 28212337.7778; train_optim_loss: 28212337.7778; val_kl_reg_loss: 43782.8125; val_edge_recon_loss: 26920662.0000; val_gene_expr_recon_loss: 289557.1875; val_masked_gp_l1_reg_loss: 873.8939; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065118.3750; val_global_loss: 28319994.0000; val_optim_loss: 28319994.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9482; val_auprc_score: 0.9301; val_best_acc_score: 0.8938; val_best_f1_score: 0.8995; train_kl_reg_loss: 44739.9488; train_edge_recon_loss: 26712388.4444; train_gene_expr_recon_loss: 291710.3958; train_masked_gp_l1_reg_loss: 885.0152; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060860.7153; train_global_loss: 28110584.0000; train_optim_loss: 28110584.0000; val_kl_reg_loss: 43271.0273; val_edge_recon_loss: 26536912.0000; val_gene_expr_recon_loss: 289625.4688; val_masked_gp_l1_reg_loss: 890.3065; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058659.8750; val_global_loss: 27929360.0000; val_optim_loss: 27929360.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9470; val_auprc_score: 0.9258; val_best_acc_score: 0.8950; val_best_f1_score: 0.9003; train_kl_reg_loss: 43623.4384; train_edge_recon_loss: 26623138.8889; train_gene_expr_recon_loss: 291826.6632; train_masked_gp_l1_reg_loss: 898.6234; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059412.9028; train_global_loss: 28018899.7778; train_optim_loss: 28018899.7778; val_kl_reg_loss: 42986.0703; val_edge_recon_loss: 26701054.0000; val_gene_expr_recon_loss: 288853.8750; val_masked_gp_l1_reg_loss: 908.5941; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057407.0000; val_global_loss: 28091208.0000; val_optim_loss: 28091208.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9501; val_auprc_score: 0.9310; val_best_acc_score: 0.8944; val_best_f1_score: 0.8993; train_kl_reg_loss: 43199.2734; train_edge_recon_loss: 26479488.6667; train_gene_expr_recon_loss: 288012.6701; train_masked_gp_l1_reg_loss: 916.9579; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048631.1389; train_global_loss: 27860248.2222; train_optim_loss: 27860248.2222; val_kl_reg_loss: 41829.2539; val_edge_recon_loss: 26845098.0000; val_gene_expr_recon_loss: 285053.2188; val_masked_gp_l1_reg_loss: 942.6611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058247.6250; val_global_loss: 28231172.0000; val_optim_loss: 28231172.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9485; val_auprc_score: 0.9265; val_best_acc_score: 0.9014; val_best_f1_score: 0.9058; train_kl_reg_loss: 42913.1549; train_edge_recon_loss: 26503916.4444; train_gene_expr_recon_loss: 285176.8090; train_masked_gp_l1_reg_loss: 970.9494; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051459.3333; train_global_loss: 27884436.4444; train_optim_loss: 27884436.4444; val_kl_reg_loss: 42859.9141; val_edge_recon_loss: 26497542.0000; val_gene_expr_recon_loss: 286111.7500; val_masked_gp_l1_reg_loss: 992.5736; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056937.6250; val_global_loss: 27884444.0000; val_optim_loss: 27884444.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9531; val_auprc_score: 0.9302; val_best_acc_score: 0.9046; val_best_f1_score: 0.9098; train_kl_reg_loss: 43094.4236; train_edge_recon_loss: 26482980.2222; train_gene_expr_recon_loss: 284756.6979; train_masked_gp_l1_reg_loss: 1002.6960; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051064.7639; train_global_loss: 27862898.2222; train_optim_loss: 27862898.2222; val_kl_reg_loss: 43161.5000; val_edge_recon_loss: 26379478.0000; val_gene_expr_recon_loss: 285046.7188; val_masked_gp_l1_reg_loss: 1017.0130; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056555.2500; val_global_loss: 27765260.0000; val_optim_loss: 27765260.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9549; val_auprc_score: 0.9357; val_best_acc_score: 0.9035; val_best_f1_score: 0.9087; train_kl_reg_loss: 42822.5399; train_edge_recon_loss: 26456369.3333; train_gene_expr_recon_loss: 284681.4618; train_masked_gp_l1_reg_loss: 1029.6586; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054194.7083; train_global_loss: 27839097.7778; train_optim_loss: 27839097.7778; val_kl_reg_loss: 41744.5000; val_edge_recon_loss: 26588118.0000; val_gene_expr_recon_loss: 283196.5312; val_masked_gp_l1_reg_loss: 1042.6604; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052672.1250; val_global_loss: 27966772.0000; val_optim_loss: 27966772.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9557; val_auprc_score: 0.9359; val_best_acc_score: 0.9057; val_best_f1_score: 0.9103; train_kl_reg_loss: 41757.6784; train_edge_recon_loss: 26421558.6667; train_gene_expr_recon_loss: 283010.1354; train_masked_gp_l1_reg_loss: 1069.7679; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046460.6667; train_global_loss: 27793857.3333; train_optim_loss: 27793857.3333; val_kl_reg_loss: 40291.3281; val_edge_recon_loss: 26595720.0000; val_gene_expr_recon_loss: 280437.4062; val_masked_gp_l1_reg_loss: 1091.6899; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051479.3750; val_global_loss: 27969022.0000; val_optim_loss: 27969022.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9609; val_auprc_score: 0.9423; val_best_acc_score: 0.9134; val_best_f1_score: 0.9186; train_kl_reg_loss: 40368.8915; train_edge_recon_loss: 26430151.3333; train_gene_expr_recon_loss: 278920.8472; train_masked_gp_l1_reg_loss: 1101.5632; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044042.1736; train_global_loss: 27794585.1111; train_optim_loss: 27794585.1111; val_kl_reg_loss: 40317.9844; val_edge_recon_loss: 26363828.0000; val_gene_expr_recon_loss: 278932.4062; val_masked_gp_l1_reg_loss: 1111.4005; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048255.4375; val_global_loss: 27732446.0000; val_optim_loss: 27732446.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9602; val_auprc_score: 0.9384; val_best_acc_score: 0.9115; val_best_f1_score: 0.9161; train_kl_reg_loss: 40256.0968; train_edge_recon_loss: 26363481.5556; train_gene_expr_recon_loss: 280058.5069; train_masked_gp_l1_reg_loss: 1119.8742; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047683.0556; train_global_loss: 27732598.8889; train_optim_loss: 27732598.8889; val_kl_reg_loss: 39595.8945; val_edge_recon_loss: 26437908.0000; val_gene_expr_recon_loss: 276452.1250; val_masked_gp_l1_reg_loss: 1127.8226; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046802.3125; val_global_loss: 27801886.0000; val_optim_loss: 27801886.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9647; val_auprc_score: 0.9518; val_best_acc_score: 0.9134; val_best_f1_score: 0.9185; train_kl_reg_loss: 38861.3416; train_edge_recon_loss: 26414388.2222; train_gene_expr_recon_loss: 276707.7743; train_masked_gp_l1_reg_loss: 1142.8762; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042333.3611; train_global_loss: 27773433.7778; train_optim_loss: 27773433.7778; val_kl_reg_loss: 38228.1875; val_edge_recon_loss: 26461438.0000; val_gene_expr_recon_loss: 279764.2500; val_masked_gp_l1_reg_loss: 1155.7988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048043.0625; val_global_loss: 27828630.0000; val_optim_loss: 27828630.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9615; val_auprc_score: 0.9421; val_best_acc_score: 0.9154; val_best_f1_score: 0.9201; train_kl_reg_loss: 38248.3199; train_edge_recon_loss: 26256237.7778; train_gene_expr_recon_loss: 278085.5868; train_masked_gp_l1_reg_loss: 1162.2411; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037616.1250; train_global_loss: 27611350.0000; train_optim_loss: 27611350.0000; val_kl_reg_loss: 37276.1133; val_edge_recon_loss: 26695040.0000; val_gene_expr_recon_loss: 276433.7500; val_masked_gp_l1_reg_loss: 1170.1899; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045949.7500; val_global_loss: 28055870.0000; val_optim_loss: 28055870.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9668; val_auprc_score: 0.9552; val_best_acc_score: 0.9155; val_best_f1_score: 0.9188; train_kl_reg_loss: 37459.7283; train_edge_recon_loss: 26313456.2222; train_gene_expr_recon_loss: 275970.8681; train_masked_gp_l1_reg_loss: 1182.0301; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038163.9236; train_global_loss: 27666233.1111; train_optim_loss: 27666233.1111; val_kl_reg_loss: 37651.9219; val_edge_recon_loss: 26580068.0000; val_gene_expr_recon_loss: 276660.0312; val_masked_gp_l1_reg_loss: 1194.1968; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043479.1250; val_global_loss: 27939054.0000; val_optim_loss: 27939054.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9645; val_auprc_score: 0.9465; val_best_acc_score: 0.9166; val_best_f1_score: 0.9206; train_kl_reg_loss: 37088.3338; train_edge_recon_loss: 26268696.4444; train_gene_expr_recon_loss: 275712.7674; train_masked_gp_l1_reg_loss: 1192.3776; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1034255.0486; train_global_loss: 27616945.1111; train_optim_loss: 27616945.1111; val_kl_reg_loss: 36694.3984; val_edge_recon_loss: 26476258.0000; val_gene_expr_recon_loss: 277397.5938; val_masked_gp_l1_reg_loss: 1188.2557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045745.7500; val_global_loss: 27837284.0000; val_optim_loss: 27837284.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9657; val_auprc_score: 0.9524; val_best_acc_score: 0.9205; val_best_f1_score: 0.9241; train_kl_reg_loss: 37989.7769; train_edge_recon_loss: 26341281.3333; train_gene_expr_recon_loss: 287566.5104; train_masked_gp_l1_reg_loss: 1184.5838; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052318.5139; train_global_loss: 27720340.6667; train_optim_loss: 27720340.6667; val_kl_reg_loss: 16958.7227; val_edge_recon_loss: 26362494.0000; val_gene_expr_recon_loss: 292912.6250; val_masked_gp_l1_reg_loss: 1179.5989; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061271.0000; val_global_loss: 27734816.0000; val_optim_loss: 27734816.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9684; val_auprc_score: 0.9547; val_best_acc_score: 0.9214; val_best_f1_score: 0.9250; train_kl_reg_loss: 37225.0955; train_edge_recon_loss: 26358086.4444; train_gene_expr_recon_loss: 293960.2431; train_masked_gp_l1_reg_loss: 1175.2872; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058681.4861; train_global_loss: 27749128.6667; train_optim_loss: 27749128.6667; val_kl_reg_loss: 16579.5000; val_edge_recon_loss: 26483014.0000; val_gene_expr_recon_loss: 292136.6562; val_masked_gp_l1_reg_loss: 1169.9022; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1062238.3750; val_global_loss: 27855138.0000; val_optim_loss: 27855138.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9691; val_auprc_score: 0.9542; val_best_acc_score: 0.9272; val_best_f1_score: 0.9301; train_kl_reg_loss: 36465.7526; train_edge_recon_loss: 26290473.5556; train_gene_expr_recon_loss: 291363.0625; train_masked_gp_l1_reg_loss: 1166.0398; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050691.9444; train_global_loss: 27670159.7778; train_optim_loss: 27670159.7778; val_kl_reg_loss: 16393.7539; val_edge_recon_loss: 26185096.0000; val_gene_expr_recon_loss: 292999.5000; val_masked_gp_l1_reg_loss: 1161.5583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064047.5000; val_global_loss: 27559700.0000; val_optim_loss: 27559700.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9714; val_auprc_score: 0.9601; val_best_acc_score: 0.9241; val_best_f1_score: 0.9274; train_kl_reg_loss: 36250.2161; train_edge_recon_loss: 26296437.1111; train_gene_expr_recon_loss: 292491.7118; train_masked_gp_l1_reg_loss: 1158.1900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056291.4444; train_global_loss: 27682629.1111; train_optim_loss: 27682629.1111; val_kl_reg_loss: 16005.0234; val_edge_recon_loss: 26403498.0000; val_gene_expr_recon_loss: 291745.8750; val_masked_gp_l1_reg_loss: 1154.1536; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1062332.2500; val_global_loss: 27774736.0000; val_optim_loss: 27774736.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9687; val_auprc_score: 0.9557; val_best_acc_score: 0.9240; val_best_f1_score: 0.9269; train_kl_reg_loss: 35659.1510; train_edge_recon_loss: 26288547.1111; train_gene_expr_recon_loss: 291825.6215; train_masked_gp_l1_reg_loss: 1151.1569; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052957.3681; train_global_loss: 27670140.2222; train_optim_loss: 27670140.2222; val_kl_reg_loss: 15503.4629; val_edge_recon_loss: 26410248.0000; val_gene_expr_recon_loss: 290869.4375; val_masked_gp_l1_reg_loss: 1147.5222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061350.2500; val_global_loss: 27779120.0000; val_optim_loss: 27779120.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9681; val_auprc_score: 0.9563; val_best_acc_score: 0.9182; val_best_f1_score: 0.9216; train_kl_reg_loss: 35395.5017; train_edge_recon_loss: 26318948.2222; train_gene_expr_recon_loss: 291044.1111; train_masked_gp_l1_reg_loss: 1144.7907; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053550.4097; train_global_loss: 27700083.3333; train_optim_loss: 27700083.3333; val_kl_reg_loss: 15103.4473; val_edge_recon_loss: 26355628.0000; val_gene_expr_recon_loss: 291740.3438; val_masked_gp_l1_reg_loss: 1141.5242; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061939.5000; val_global_loss: 27725554.0000; val_optim_loss: 27725554.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9683; val_auprc_score: 0.9544; val_best_acc_score: 0.9224; val_best_f1_score: 0.9251; train_kl_reg_loss: 34554.0221; train_edge_recon_loss: 26247852.8889; train_gene_expr_recon_loss: 289965.9931; train_masked_gp_l1_reg_loss: 1139.0412; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052528.5556; train_global_loss: 27626040.4444; train_optim_loss: 27626040.4444; val_kl_reg_loss: 14669.5312; val_edge_recon_loss: 26397434.0000; val_gene_expr_recon_loss: 291254.6875; val_masked_gp_l1_reg_loss: 1136.0447; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060978.3750; val_global_loss: 27765472.0000; val_optim_loss: 27765472.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9672; val_auprc_score: 0.9530; val_best_acc_score: 0.9232; val_best_f1_score: 0.9262; train_kl_reg_loss: 34322.3971; train_edge_recon_loss: 26273943.1111; train_gene_expr_recon_loss: 290260.1944; train_masked_gp_l1_reg_loss: 1135.5769; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049030.6319; train_global_loss: 27648692.0000; train_optim_loss: 27648692.0000; val_kl_reg_loss: 14585.6328; val_edge_recon_loss: 26382040.0000; val_gene_expr_recon_loss: 291227.2188; val_masked_gp_l1_reg_loss: 1135.0258; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059730.0000; val_global_loss: 27748720.0000; val_optim_loss: 27748720.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9639; val_auprc_score: 0.9487; val_best_acc_score: 0.9197; val_best_f1_score: 0.9231; train_kl_reg_loss: 34504.1888; train_edge_recon_loss: 26261098.4444; train_gene_expr_recon_loss: 290791.8090; train_masked_gp_l1_reg_loss: 1134.7061; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052107.4514; train_global_loss: 27639635.7778; train_optim_loss: 27639635.7778; val_kl_reg_loss: 14556.8691; val_edge_recon_loss: 26440722.0000; val_gene_expr_recon_loss: 291220.2812; val_masked_gp_l1_reg_loss: 1134.2942; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060684.2500; val_global_loss: 27808316.0000; val_optim_loss: 27808316.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9668; val_auprc_score: 0.9508; val_best_acc_score: 0.9224; val_best_f1_score: 0.9259; train_kl_reg_loss: 33969.0117; train_edge_recon_loss: 26273110.6667; train_gene_expr_recon_loss: 291205.9861; train_masked_gp_l1_reg_loss: 1133.9797; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049962.9653; train_global_loss: 27649382.2222; train_optim_loss: 27649382.2222; val_kl_reg_loss: 14547.7598; val_edge_recon_loss: 26501786.0000; val_gene_expr_recon_loss: 291346.0938; val_masked_gp_l1_reg_loss: 1133.6057; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060859.8750; val_global_loss: 27869674.0000; val_optim_loss: 27869674.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9668; val_auprc_score: 0.9546; val_best_acc_score: 0.9216; val_best_f1_score: 0.9243; train_kl_reg_loss: 34160.6532; train_edge_recon_loss: 26274345.3333; train_gene_expr_recon_loss: 289761.2222; train_masked_gp_l1_reg_loss: 1133.3186; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049677.0417; train_global_loss: 27649078.2222; train_optim_loss: 27649078.2222; val_kl_reg_loss: 14462.4150; val_edge_recon_loss: 26552552.0000; val_gene_expr_recon_loss: 290945.9375; val_masked_gp_l1_reg_loss: 1132.9746; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059633.6250; val_global_loss: 27918726.0000; val_optim_loss: 27918726.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 9 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9711
Val AUPRC score: 0.9582
Val best accuracy score: 0.9286
Val best F1 score: 0.9307
Val gene expr MSE score: 0.7963
Val chrom access MSE score: 0.0928
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
