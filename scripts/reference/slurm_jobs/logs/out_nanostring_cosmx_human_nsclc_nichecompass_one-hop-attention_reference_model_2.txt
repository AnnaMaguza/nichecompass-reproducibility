Run timestamp: 13062023_181913.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', '3', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 3, n_addon_input: 0, n_output: 1920
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 960, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 254337
Number of validation nodes: 28260
Number of training edges: 1722321
Number of validation edges: 191368
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9841; val_auprc_score: 0.9935; val_best_acc_score: 0.9588; val_best_f1_score: 0.9729; train_kl_reg_loss: 5273.4394; train_edge_recon_loss: 136222.0692; train_gene_expr_recon_loss: 162440.6166; train_masked_gp_l1_reg_loss: 1285.6968; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305221.8218; train_optim_loss: 305221.8218; val_kl_reg_loss: 4007.0554; val_edge_recon_loss: 131460.3565; val_gene_expr_recon_loss: 154491.4496; val_masked_gp_l1_reg_loss: 1186.8201; val_group_lasso_reg_loss: 0.0000; val_global_loss: 291145.6736; val_optim_loss: 291145.6736
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9882; val_auprc_score: 0.9952; val_best_acc_score: 0.9664; val_best_f1_score: 0.9778; train_kl_reg_loss: 3949.1759; train_edge_recon_loss: 131168.5675; train_gene_expr_recon_loss: 153458.5763; train_masked_gp_l1_reg_loss: 1010.8026; train_group_lasso_reg_loss: 0.0000; train_global_loss: 289587.1228; train_optim_loss: 289587.1228; val_kl_reg_loss: 3803.0844; val_edge_recon_loss: 130356.2543; val_gene_expr_recon_loss: 152582.9418; val_masked_gp_l1_reg_loss: 895.1862; val_group_lasso_reg_loss: 0.0000; val_global_loss: 287637.4686; val_optim_loss: 287637.4686
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9904; val_auprc_score: 0.9962; val_best_acc_score: 0.9692; val_best_f1_score: 0.9796; train_kl_reg_loss: 3935.8508; train_edge_recon_loss: 130720.4512; train_gene_expr_recon_loss: 152310.1531; train_masked_gp_l1_reg_loss: 829.6094; train_group_lasso_reg_loss: 0.0000; train_global_loss: 287796.0645; train_optim_loss: 287796.0645; val_kl_reg_loss: 3900.8385; val_edge_recon_loss: 130631.6678; val_gene_expr_recon_loss: 151794.3557; val_masked_gp_l1_reg_loss: 778.7893; val_group_lasso_reg_loss: 0.0000; val_global_loss: 287105.6429; val_optim_loss: 287105.6429
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9918; val_auprc_score: 0.9968; val_best_acc_score: 0.9724; val_best_f1_score: 0.9818; train_kl_reg_loss: 3960.5676; train_edge_recon_loss: 130402.9653; train_gene_expr_recon_loss: 151407.4420; train_masked_gp_l1_reg_loss: 755.7858; train_group_lasso_reg_loss: 0.0000; train_global_loss: 286526.7604; train_optim_loss: 286526.7604; val_kl_reg_loss: 3905.4402; val_edge_recon_loss: 129843.7157; val_gene_expr_recon_loss: 150801.4423; val_masked_gp_l1_reg_loss: 739.0870; val_group_lasso_reg_loss: 0.0000; val_global_loss: 285289.6925; val_optim_loss: 285289.6925
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9963; val_best_acc_score: 0.9736; val_best_f1_score: 0.9825; train_kl_reg_loss: 4009.8989; train_edge_recon_loss: 130261.2607; train_gene_expr_recon_loss: 150439.6906; train_masked_gp_l1_reg_loss: 729.3127; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285440.1626; train_optim_loss: 285440.1626; val_kl_reg_loss: 4013.3165; val_edge_recon_loss: 130000.5595; val_gene_expr_recon_loss: 149963.1091; val_masked_gp_l1_reg_loss: 723.5170; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284700.5165; val_optim_loss: 284700.5165
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9932; val_auprc_score: 0.9974; val_best_acc_score: 0.9749; val_best_f1_score: 0.9834; train_kl_reg_loss: 4070.5774; train_edge_recon_loss: 130607.7243; train_gene_expr_recon_loss: 149398.0582; train_masked_gp_l1_reg_loss: 719.6201; train_group_lasso_reg_loss: 0.0000; train_global_loss: 284795.9795; train_optim_loss: 284795.9795; val_kl_reg_loss: 4003.6368; val_edge_recon_loss: 130508.6398; val_gene_expr_recon_loss: 149296.4737; val_masked_gp_l1_reg_loss: 718.6260; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284527.3735; val_optim_loss: 284527.3735
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9933; val_auprc_score: 0.9974; val_best_acc_score: 0.9765; val_best_f1_score: 0.9844; train_kl_reg_loss: 4127.2110; train_edge_recon_loss: 130325.7070; train_gene_expr_recon_loss: 148569.7623; train_masked_gp_l1_reg_loss: 717.1476; train_group_lasso_reg_loss: 0.0000; train_global_loss: 283739.8280; train_optim_loss: 283739.8280; val_kl_reg_loss: 4102.5022; val_edge_recon_loss: 130151.1524; val_gene_expr_recon_loss: 148226.4810; val_masked_gp_l1_reg_loss: 717.8978; val_group_lasso_reg_loss: 0.0000; val_global_loss: 283198.0421; val_optim_loss: 283198.0421
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9973; val_best_acc_score: 0.9770; val_best_f1_score: 0.9848; train_kl_reg_loss: 4171.9805; train_edge_recon_loss: 130188.2057; train_gene_expr_recon_loss: 147820.7800; train_masked_gp_l1_reg_loss: 717.6445; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282898.6110; train_optim_loss: 282898.6110; val_kl_reg_loss: 4121.4308; val_edge_recon_loss: 130303.4924; val_gene_expr_recon_loss: 147685.8248; val_masked_gp_l1_reg_loss: 716.4197; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282827.1548; val_optim_loss: 282827.1548
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9936; val_auprc_score: 0.9975; val_best_acc_score: 0.9775; val_best_f1_score: 0.9851; train_kl_reg_loss: 4211.9998; train_edge_recon_loss: 130384.6565; train_gene_expr_recon_loss: 147175.5767; train_masked_gp_l1_reg_loss: 717.3539; train_group_lasso_reg_loss: 0.0000; train_global_loss: 282489.5863; train_optim_loss: 282489.5863; val_kl_reg_loss: 4257.7175; val_edge_recon_loss: 130285.2106; val_gene_expr_recon_loss: 147635.9662; val_masked_gp_l1_reg_loss: 717.6926; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282896.5814; val_optim_loss: 282896.5814
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9939; val_auprc_score: 0.9976; val_best_acc_score: 0.9784; val_best_f1_score: 0.9857; train_kl_reg_loss: 4244.1212; train_edge_recon_loss: 130135.6071; train_gene_expr_recon_loss: 146654.9879; train_masked_gp_l1_reg_loss: 716.8500; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281751.5665; train_optim_loss: 281751.5665; val_kl_reg_loss: 4167.7439; val_edge_recon_loss: 129854.3247; val_gene_expr_recon_loss: 147240.9836; val_masked_gp_l1_reg_loss: 714.9114; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281977.9587; val_optim_loss: 281977.9587
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9977; val_best_acc_score: 0.9786; val_best_f1_score: 0.9858; train_kl_reg_loss: 4275.2904; train_edge_recon_loss: 130258.1488; train_gene_expr_recon_loss: 146212.9660; train_masked_gp_l1_reg_loss: 716.3234; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281462.7281; train_optim_loss: 281462.7281; val_kl_reg_loss: 4125.6457; val_edge_recon_loss: 130238.6779; val_gene_expr_recon_loss: 146861.6639; val_masked_gp_l1_reg_loss: 720.1014; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281946.0812; val_optim_loss: 281946.0812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9944; val_auprc_score: 0.9976; val_best_acc_score: 0.9789; val_best_f1_score: 0.9860; train_kl_reg_loss: 4301.2832; train_edge_recon_loss: 130411.9364; train_gene_expr_recon_loss: 145874.3177; train_masked_gp_l1_reg_loss: 716.8942; train_group_lasso_reg_loss: 0.0000; train_global_loss: 281304.4313; train_optim_loss: 281304.4313; val_kl_reg_loss: 4341.9330; val_edge_recon_loss: 130149.1642; val_gene_expr_recon_loss: 146563.8213; val_masked_gp_l1_reg_loss: 716.4911; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281771.4183; val_optim_loss: 281771.4183
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9945; val_auprc_score: 0.9977; val_best_acc_score: 0.9791; val_best_f1_score: 0.9861; train_kl_reg_loss: 4325.1450; train_edge_recon_loss: 130311.1960; train_gene_expr_recon_loss: 145477.1556; train_masked_gp_l1_reg_loss: 718.1874; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280831.6837; train_optim_loss: 280831.6837; val_kl_reg_loss: 4291.0499; val_edge_recon_loss: 130569.2939; val_gene_expr_recon_loss: 146206.8956; val_masked_gp_l1_reg_loss: 720.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281787.8010; val_optim_loss: 281787.8010
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9941; val_auprc_score: 0.9976; val_best_acc_score: 0.9793; val_best_f1_score: 0.9863; train_kl_reg_loss: 4346.1878; train_edge_recon_loss: 130368.9989; train_gene_expr_recon_loss: 145223.7357; train_masked_gp_l1_reg_loss: 719.8629; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280658.7851; train_optim_loss: 280658.7851; val_kl_reg_loss: 4316.5494; val_edge_recon_loss: 130334.4812; val_gene_expr_recon_loss: 146198.4929; val_masked_gp_l1_reg_loss: 721.5535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281571.0862; val_optim_loss: 281571.0862
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9946; val_auprc_score: 0.9978; val_best_acc_score: 0.9806; val_best_f1_score: 0.9872; train_kl_reg_loss: 4355.0717; train_edge_recon_loss: 129983.4451; train_gene_expr_recon_loss: 144995.5861; train_masked_gp_l1_reg_loss: 720.5158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280054.6192; train_optim_loss: 280054.6192; val_kl_reg_loss: 4212.5050; val_edge_recon_loss: 130371.9186; val_gene_expr_recon_loss: 146063.8651; val_masked_gp_l1_reg_loss: 715.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281363.5079; val_optim_loss: 281363.5079
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9806; val_best_f1_score: 0.9872; train_kl_reg_loss: 4378.2742; train_edge_recon_loss: 130164.1861; train_gene_expr_recon_loss: 144812.1782; train_masked_gp_l1_reg_loss: 719.9693; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280074.6079; train_optim_loss: 280074.6079; val_kl_reg_loss: 4346.8724; val_edge_recon_loss: 130089.2743; val_gene_expr_recon_loss: 145899.6424; val_masked_gp_l1_reg_loss: 720.1956; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281055.9773; val_optim_loss: 281055.9773
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9978; val_best_acc_score: 0.9802; val_best_f1_score: 0.9869; train_kl_reg_loss: 4385.4657; train_edge_recon_loss: 130178.3212; train_gene_expr_recon_loss: 144602.0433; train_masked_gp_l1_reg_loss: 718.0238; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279883.8535; train_optim_loss: 279883.8535; val_kl_reg_loss: 4343.6310; val_edge_recon_loss: 130073.7274; val_gene_expr_recon_loss: 145790.8867; val_masked_gp_l1_reg_loss: 718.3522; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280926.5887; val_optim_loss: 280926.5887
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9981; val_best_acc_score: 0.9808; val_best_f1_score: 0.9872; train_kl_reg_loss: 4401.1771; train_edge_recon_loss: 130088.7846; train_gene_expr_recon_loss: 144428.7398; train_masked_gp_l1_reg_loss: 721.3495; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279640.0512; train_optim_loss: 279640.0512; val_kl_reg_loss: 4341.9195; val_edge_recon_loss: 130635.2808; val_gene_expr_recon_loss: 145487.2146; val_masked_gp_l1_reg_loss: 720.7002; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281185.1013; val_optim_loss: 281185.1013
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9983; val_best_acc_score: 0.9817; val_best_f1_score: 0.9879; train_kl_reg_loss: 4412.9820; train_edge_recon_loss: 130239.7538; train_gene_expr_recon_loss: 144269.5455; train_masked_gp_l1_reg_loss: 722.4111; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279644.6922; train_optim_loss: 279644.6922; val_kl_reg_loss: 4532.1407; val_edge_recon_loss: 130715.0008; val_gene_expr_recon_loss: 145583.8851; val_masked_gp_l1_reg_loss: 725.6778; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281556.7151; val_optim_loss: 281556.7151
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9949; val_auprc_score: 0.9980; val_best_acc_score: 0.9814; val_best_f1_score: 0.9877; train_kl_reg_loss: 4421.0334; train_edge_recon_loss: 130320.1866; train_gene_expr_recon_loss: 144147.2584; train_masked_gp_l1_reg_loss: 725.9069; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279614.3853; train_optim_loss: 279614.3853; val_kl_reg_loss: 4405.7889; val_edge_recon_loss: 130075.2063; val_gene_expr_recon_loss: 145357.9079; val_masked_gp_l1_reg_loss: 724.8341; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280563.7465; val_optim_loss: 280563.7465
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9983; val_best_acc_score: 0.9820; val_best_f1_score: 0.9881; train_kl_reg_loss: 4432.8620; train_edge_recon_loss: 130225.4779; train_gene_expr_recon_loss: 144044.3026; train_masked_gp_l1_reg_loss: 726.6586; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279429.3014; train_optim_loss: 279429.3014; val_kl_reg_loss: 4392.5425; val_edge_recon_loss: 130707.4084; val_gene_expr_recon_loss: 145455.6633; val_masked_gp_l1_reg_loss: 722.5005; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281278.1148; val_optim_loss: 281278.1148
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9817; val_best_f1_score: 0.9879; train_kl_reg_loss: 4436.3839; train_edge_recon_loss: 130384.9306; train_gene_expr_recon_loss: 143922.0655; train_masked_gp_l1_reg_loss: 725.2217; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279468.6011; train_optim_loss: 279468.6011; val_kl_reg_loss: 4487.8202; val_edge_recon_loss: 130421.3438; val_gene_expr_recon_loss: 145143.3319; val_masked_gp_l1_reg_loss: 723.9312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280776.4337; val_optim_loss: 280776.4337
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9984; val_best_acc_score: 0.9823; val_best_f1_score: 0.9883; train_kl_reg_loss: 4447.1539; train_edge_recon_loss: 130005.0115; train_gene_expr_recon_loss: 143775.1461; train_masked_gp_l1_reg_loss: 725.5204; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278952.8316; train_optim_loss: 278952.8316; val_kl_reg_loss: 4509.5305; val_edge_recon_loss: 130254.9482; val_gene_expr_recon_loss: 145330.9407; val_masked_gp_l1_reg_loss: 727.9498; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280823.3571; val_optim_loss: 280823.3571

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9983; val_best_acc_score: 0.9822; val_best_f1_score: 0.9882; train_kl_reg_loss: 4464.1569; train_edge_recon_loss: 129884.2818; train_gene_expr_recon_loss: 143141.1081; train_masked_gp_l1_reg_loss: 650.8395; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278140.3862; train_optim_loss: 278140.3862; val_kl_reg_loss: 4417.0395; val_edge_recon_loss: 130155.7475; val_gene_expr_recon_loss: 144959.7803; val_masked_gp_l1_reg_loss: 645.7563; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280178.3163; val_optim_loss: 280178.3163
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9984; val_best_acc_score: 0.9832; val_best_f1_score: 0.9889; train_kl_reg_loss: 4461.5032; train_edge_recon_loss: 129945.3872; train_gene_expr_recon_loss: 142969.4652; train_masked_gp_l1_reg_loss: 645.0015; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278021.3573; train_optim_loss: 278021.3573; val_kl_reg_loss: 4412.9514; val_edge_recon_loss: 129524.2980; val_gene_expr_recon_loss: 145177.3514; val_masked_gp_l1_reg_loss: 645.4178; val_group_lasso_reg_loss: 0.0000; val_global_loss: 279760.0067; val_optim_loss: 279760.0067
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9922; val_auprc_score: 0.9968; val_best_acc_score: 0.9739; val_best_f1_score: 0.9828; train_kl_reg_loss: 3769.6211; train_edge_recon_loss: 131079.5089; train_gene_expr_recon_loss: 145366.8438; train_masked_gp_l1_reg_loss: 662.1871; train_group_lasso_reg_loss: 0.0000; train_global_loss: 280878.1616; train_optim_loss: 280878.1616; val_kl_reg_loss: 2509.5663; val_edge_recon_loss: 132197.2606; val_gene_expr_recon_loss: 146852.0786; val_masked_gp_l1_reg_loss: 644.1367; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282203.0292; val_optim_loss: 282203.0292
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9968; val_best_acc_score: 0.9750; val_best_f1_score: 0.9834; train_kl_reg_loss: 3348.6246; train_edge_recon_loss: 130546.0605; train_gene_expr_recon_loss: 144918.9286; train_masked_gp_l1_reg_loss: 607.8974; train_group_lasso_reg_loss: 0.0000; train_global_loss: 279421.5110; train_optim_loss: 279421.5110; val_kl_reg_loss: 2551.2802; val_edge_recon_loss: 132028.0956; val_gene_expr_recon_loss: 146597.4606; val_masked_gp_l1_reg_loss: 569.2000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 281746.0242; val_optim_loss: 281746.0242
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9927; val_auprc_score: 0.9970; val_best_acc_score: 0.9761; val_best_f1_score: 0.9842; train_kl_reg_loss: 3060.7710; train_edge_recon_loss: 130408.8479; train_gene_expr_recon_loss: 144786.2796; train_masked_gp_l1_reg_loss: 535.1044; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278791.0031; train_optim_loss: 278791.0031; val_kl_reg_loss: 2613.5115; val_edge_recon_loss: 131028.2585; val_gene_expr_recon_loss: 146487.8416; val_masked_gp_l1_reg_loss: 503.2156; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280632.8292; val_optim_loss: 280632.8292

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9927; val_auprc_score: 0.9970; val_best_acc_score: 0.9760; val_best_f1_score: 0.9842; train_kl_reg_loss: 2938.4353; train_edge_recon_loss: 130329.6369; train_gene_expr_recon_loss: 144649.5655; train_masked_gp_l1_reg_loss: 496.8548; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278414.4921; train_optim_loss: 278414.4921; val_kl_reg_loss: 2614.0797; val_edge_recon_loss: 130897.9383; val_gene_expr_recon_loss: 146496.5541; val_masked_gp_l1_reg_loss: 493.5345; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280502.1046; val_optim_loss: 280502.1046
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9928; val_auprc_score: 0.9971; val_best_acc_score: 0.9762; val_best_f1_score: 0.9843; train_kl_reg_loss: 2910.0597; train_edge_recon_loss: 129892.0866; train_gene_expr_recon_loss: 144606.1076; train_masked_gp_l1_reg_loss: 490.7653; train_group_lasso_reg_loss: 0.0000; train_global_loss: 277899.0190; train_optim_loss: 277899.0190; val_kl_reg_loss: 2614.5102; val_edge_recon_loss: 131165.2077; val_gene_expr_recon_loss: 146516.3859; val_masked_gp_l1_reg_loss: 487.9467; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280784.0404; val_optim_loss: 280784.0404
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9932; val_auprc_score: 0.9973; val_best_acc_score: 0.9769; val_best_f1_score: 0.9847; train_kl_reg_loss: 2878.4008; train_edge_recon_loss: 130205.5458; train_gene_expr_recon_loss: 144625.0326; train_masked_gp_l1_reg_loss: 485.3126; train_group_lasso_reg_loss: 0.0000; train_global_loss: 278194.2913; train_optim_loss: 278194.2913; val_kl_reg_loss: 2622.2860; val_edge_recon_loss: 130543.1731; val_gene_expr_recon_loss: 146589.4997; val_masked_gp_l1_reg_loss: 482.7902; val_group_lasso_reg_loss: 0.0000; val_global_loss: 280237.7405; val_optim_loss: 280237.7405

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 507 min 9 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9958
Val best accuracy score: 0.9710
Val best F1 score: 0.9808
Val gene expr MSE score: 1.0711

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
