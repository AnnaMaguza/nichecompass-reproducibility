[True]
Run timestamp: 07082023_235353_50.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_50']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8918; val_auprc_score: 0.9781; val_best_acc_score: 0.8557; val_best_f1_score: 0.9219; train_kl_reg_loss: 117613.8547; train_edge_recon_loss: 117727.4083; train_gene_expr_recon_loss: 3625408.5649; train_masked_gp_l1_reg_loss: 9994.3622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177142.5500; train_global_loss: 4047886.7452; train_optim_loss: 4047886.7452; val_kl_reg_loss: 109596.6699; val_edge_recon_loss: 120227.1491; val_gene_expr_recon_loss: 2460426.3125; val_masked_gp_l1_reg_loss: 9117.2598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169828.0469; val_global_loss: 2869195.4375; val_optim_loss: 2869195.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8778; val_auprc_score: 0.9737; val_best_acc_score: 0.8893; val_best_f1_score: 0.9375; train_kl_reg_loss: 96276.1726; train_edge_recon_loss: 118704.3677; train_gene_expr_recon_loss: 2378178.4543; train_masked_gp_l1_reg_loss: 8257.9128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159335.9877; train_global_loss: 2760752.8774; train_optim_loss: 2760752.8774; val_kl_reg_loss: 82800.0495; val_edge_recon_loss: 119851.6530; val_gene_expr_recon_loss: 2319993.6875; val_masked_gp_l1_reg_loss: 7671.5581; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148066.4375; val_global_loss: 2678383.3958; val_optim_loss: 2678383.3958
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9028; val_auprc_score: 0.9782; val_best_acc_score: 0.8930; val_best_f1_score: 0.9406; train_kl_reg_loss: 76223.0340; train_edge_recon_loss: 117876.6327; train_gene_expr_recon_loss: 2274986.7115; train_masked_gp_l1_reg_loss: 7439.4246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136700.5244; train_global_loss: 2613226.3341; train_optim_loss: 2613226.3341; val_kl_reg_loss: 68092.9453; val_edge_recon_loss: 119217.9447; val_gene_expr_recon_loss: 2237031.8542; val_masked_gp_l1_reg_loss: 7294.5991; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125249.3594; val_global_loss: 2556886.4792; val_optim_loss: 2556886.4792
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9138; val_auprc_score: 0.9810; val_best_acc_score: 0.9128; val_best_f1_score: 0.9508; train_kl_reg_loss: 64750.2442; train_edge_recon_loss: 116978.1163; train_gene_expr_recon_loss: 2206708.5649; train_masked_gp_l1_reg_loss: 7271.0368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114737.3764; train_global_loss: 2510445.3341; train_optim_loss: 2510445.3341; val_kl_reg_loss: 59799.8021; val_edge_recon_loss: 116121.8496; val_gene_expr_recon_loss: 2179849.6875; val_masked_gp_l1_reg_loss: 7282.2681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104567.7031; val_global_loss: 2467621.3125; val_optim_loss: 2467621.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9228; val_auprc_score: 0.9828; val_best_acc_score: 0.9218; val_best_f1_score: 0.9551; train_kl_reg_loss: 57243.3362; train_edge_recon_loss: 115434.9663; train_gene_expr_recon_loss: 2154710.3341; train_masked_gp_l1_reg_loss: 7347.7736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95751.3042; train_global_loss: 2430487.7043; train_optim_loss: 2430487.7043; val_kl_reg_loss: 53344.5511; val_edge_recon_loss: 115682.3424; val_gene_expr_recon_loss: 2133722.1042; val_masked_gp_l1_reg_loss: 7430.0396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87339.4375; val_global_loss: 2397518.5000; val_optim_loss: 2397518.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9280; val_auprc_score: 0.9834; val_best_acc_score: 0.9235; val_best_f1_score: 0.9566; train_kl_reg_loss: 51855.7625; train_edge_recon_loss: 114485.9430; train_gene_expr_recon_loss: 2111344.6406; train_masked_gp_l1_reg_loss: 7524.7375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80164.6097; train_global_loss: 2365375.6923; train_optim_loss: 2365375.6923; val_kl_reg_loss: 48783.6354; val_edge_recon_loss: 115954.6621; val_gene_expr_recon_loss: 2091952.5000; val_masked_gp_l1_reg_loss: 7628.6157; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73383.1562; val_global_loss: 2337702.5833; val_optim_loss: 2337702.5833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9378; val_auprc_score: 0.9864; val_best_acc_score: 0.9301; val_best_f1_score: 0.9599; train_kl_reg_loss: 47826.3854; train_edge_recon_loss: 113965.7133; train_gene_expr_recon_loss: 2075175.7188; train_masked_gp_l1_reg_loss: 7731.2746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67674.1919; train_global_loss: 2312373.2861; train_optim_loss: 2312373.2861; val_kl_reg_loss: 45721.4255; val_edge_recon_loss: 115336.4720; val_gene_expr_recon_loss: 2059716.0104; val_masked_gp_l1_reg_loss: 7837.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62303.3398; val_global_loss: 2290914.9583; val_optim_loss: 2290914.9583
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9447; val_auprc_score: 0.9879; val_best_acc_score: 0.9351; val_best_f1_score: 0.9624; train_kl_reg_loss: 44570.2732; train_edge_recon_loss: 113282.1801; train_gene_expr_recon_loss: 2043662.8486; train_masked_gp_l1_reg_loss: 7944.0246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57805.4133; train_global_loss: 2267264.7428; train_optim_loss: 2267264.7428; val_kl_reg_loss: 42569.3984; val_edge_recon_loss: 113942.4980; val_gene_expr_recon_loss: 2030357.7292; val_masked_gp_l1_reg_loss: 8051.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53583.0234; val_global_loss: 2248504.1250; val_optim_loss: 2248504.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9494; val_auprc_score: 0.9886; val_best_acc_score: 0.9377; val_best_f1_score: 0.9643; train_kl_reg_loss: 41989.3310; train_edge_recon_loss: 111522.4576; train_gene_expr_recon_loss: 2014675.6142; train_masked_gp_l1_reg_loss: 8151.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50037.0469; train_global_loss: 2226375.6562; train_optim_loss: 2226375.6562; val_kl_reg_loss: 40220.3981; val_edge_recon_loss: 113653.9375; val_gene_expr_recon_loss: 2002662.1042; val_masked_gp_l1_reg_loss: 8255.7471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46694.7461; val_global_loss: 2211486.9167; val_optim_loss: 2211486.9167
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9528; val_auprc_score: 0.9895; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 39784.6164; train_edge_recon_loss: 110939.7845; train_gene_expr_recon_loss: 1988927.7091; train_masked_gp_l1_reg_loss: 8352.3945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43867.7950; train_global_loss: 2191872.2740; train_optim_loss: 2191872.2740; val_kl_reg_loss: 38218.0277; val_edge_recon_loss: 112379.7025; val_gene_expr_recon_loss: 1978258.0417; val_masked_gp_l1_reg_loss: 8448.5752; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41187.7930; val_global_loss: 2178491.9792; val_optim_loss: 2178491.9792
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9576; val_auprc_score: 0.9905; val_best_acc_score: 0.9441; val_best_f1_score: 0.9679; train_kl_reg_loss: 37958.4725; train_edge_recon_loss: 109728.8854; train_gene_expr_recon_loss: 1964539.5072; train_masked_gp_l1_reg_loss: 8538.6347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38901.7428; train_global_loss: 2159667.2428; train_optim_loss: 2159667.2428; val_kl_reg_loss: 36298.0127; val_edge_recon_loss: 111753.8685; val_gene_expr_recon_loss: 1954331.9062; val_masked_gp_l1_reg_loss: 8631.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36735.6172; val_global_loss: 2147750.3125; val_optim_loss: 2147750.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9636; val_auprc_score: 0.9921; val_best_acc_score: 0.9519; val_best_f1_score: 0.9721; train_kl_reg_loss: 36313.3670; train_edge_recon_loss: 108185.4373; train_gene_expr_recon_loss: 1942522.1899; train_masked_gp_l1_reg_loss: 8719.3182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34869.8130; train_global_loss: 2130610.1298; train_optim_loss: 2130610.1298; val_kl_reg_loss: 35069.6953; val_edge_recon_loss: 108944.1315; val_gene_expr_recon_loss: 1932647.3646; val_masked_gp_l1_reg_loss: 8809.9746; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33097.7578; val_global_loss: 2118568.9792; val_optim_loss: 2118568.9792
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9650; val_auprc_score: 0.9920; val_best_acc_score: 0.9531; val_best_f1_score: 0.9729; train_kl_reg_loss: 34871.0412; train_edge_recon_loss: 107063.8060; train_gene_expr_recon_loss: 1921670.2885; train_masked_gp_l1_reg_loss: 8894.3407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31542.7521; train_global_loss: 2104042.2260; train_optim_loss: 2104042.2260; val_kl_reg_loss: 33712.2826; val_edge_recon_loss: 108029.8249; val_gene_expr_recon_loss: 1912747.8021; val_masked_gp_l1_reg_loss: 8986.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30067.2773; val_global_loss: 2093543.9062; val_optim_loss: 2093543.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9682; val_auprc_score: 0.9931; val_best_acc_score: 0.9558; val_best_f1_score: 0.9745; train_kl_reg_loss: 33483.7136; train_edge_recon_loss: 105623.6198; train_gene_expr_recon_loss: 1901839.9916; train_masked_gp_l1_reg_loss: 9065.3320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28775.6020; train_global_loss: 2078788.2644; train_optim_loss: 2078788.2644; val_kl_reg_loss: 32554.6536; val_edge_recon_loss: 106376.4635; val_gene_expr_recon_loss: 1894024.2396; val_masked_gp_l1_reg_loss: 9148.1182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27537.7832; val_global_loss: 2069641.2188; val_optim_loss: 2069641.2188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9694; val_auprc_score: 0.9930; val_best_acc_score: 0.9579; val_best_f1_score: 0.9756; train_kl_reg_loss: 32184.2682; train_edge_recon_loss: 104968.4681; train_gene_expr_recon_loss: 1883089.7524; train_masked_gp_l1_reg_loss: 9227.7845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26443.7752; train_global_loss: 2055914.0553; train_optim_loss: 2055914.0553; val_kl_reg_loss: 30446.7542; val_edge_recon_loss: 105236.4479; val_gene_expr_recon_loss: 1877477.8438; val_masked_gp_l1_reg_loss: 9308.9238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25399.9824; val_global_loss: 2047869.9271; val_optim_loss: 2047869.9271
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9705; val_auprc_score: 0.9931; val_best_acc_score: 0.9598; val_best_f1_score: 0.9768; train_kl_reg_loss: 30790.7747; train_edge_recon_loss: 103532.7342; train_gene_expr_recon_loss: 1865790.1010; train_masked_gp_l1_reg_loss: 9386.0797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24471.2396; train_global_loss: 2033970.9267; train_optim_loss: 2033970.9267; val_kl_reg_loss: 30117.6584; val_edge_recon_loss: 104194.0378; val_gene_expr_recon_loss: 1857454.3854; val_masked_gp_l1_reg_loss: 9466.5615; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23578.9355; val_global_loss: 2024811.4688; val_optim_loss: 2024811.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9730; val_auprc_score: 0.9935; val_best_acc_score: 0.9613; val_best_f1_score: 0.9775; train_kl_reg_loss: 29386.0939; train_edge_recon_loss: 102410.0237; train_gene_expr_recon_loss: 1849175.2596; train_masked_gp_l1_reg_loss: 9535.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22786.6242; train_global_loss: 2013293.8474; train_optim_loss: 2013293.8474; val_kl_reg_loss: 28023.8706; val_edge_recon_loss: 103221.3392; val_gene_expr_recon_loss: 1843586.6042; val_masked_gp_l1_reg_loss: 9607.0967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22036.1895; val_global_loss: 2006475.1771; val_optim_loss: 2006475.1771
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9747; val_auprc_score: 0.9946; val_best_acc_score: 0.9629; val_best_f1_score: 0.9785; train_kl_reg_loss: 28026.8288; train_edge_recon_loss: 101213.4530; train_gene_expr_recon_loss: 1833160.2969; train_masked_gp_l1_reg_loss: 9673.4504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21363.7776; train_global_loss: 1993437.8089; train_optim_loss: 1993437.8089; val_kl_reg_loss: 26942.2943; val_edge_recon_loss: 100366.2070; val_gene_expr_recon_loss: 1826226.1771; val_masked_gp_l1_reg_loss: 9746.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20733.4277; val_global_loss: 1984014.0521; val_optim_loss: 1984014.0521
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9727; val_auprc_score: 0.9932; val_best_acc_score: 0.9628; val_best_f1_score: 0.9784; train_kl_reg_loss: 26625.4972; train_edge_recon_loss: 99610.4810; train_gene_expr_recon_loss: 1818224.9123; train_masked_gp_l1_reg_loss: 9803.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20145.2274; train_global_loss: 1974409.3257; train_optim_loss: 1974409.3257; val_kl_reg_loss: 25687.0664; val_edge_recon_loss: 99998.2923; val_gene_expr_recon_loss: 1812069.0104; val_masked_gp_l1_reg_loss: 9867.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19594.7988; val_global_loss: 1967216.7396; val_optim_loss: 1967216.7396
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9753; val_auprc_score: 0.9943; val_best_acc_score: 0.9655; val_best_f1_score: 0.9800; train_kl_reg_loss: 25154.6886; train_edge_recon_loss: 98145.1443; train_gene_expr_recon_loss: 1803482.3257; train_masked_gp_l1_reg_loss: 9915.8913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19099.0251; train_global_loss: 1955797.0661; train_optim_loss: 1955797.0661; val_kl_reg_loss: 24275.7611; val_edge_recon_loss: 98347.3574; val_gene_expr_recon_loss: 1797651.4167; val_masked_gp_l1_reg_loss: 9966.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18614.1133; val_global_loss: 1948855.5417; val_optim_loss: 1948855.5417
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9751; val_auprc_score: 0.9939; val_best_acc_score: 0.9649; val_best_f1_score: 0.9796; train_kl_reg_loss: 23794.1245; train_edge_recon_loss: 97086.9127; train_gene_expr_recon_loss: 1789631.4075; train_masked_gp_l1_reg_loss: 10009.5437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18184.9986; train_global_loss: 1938706.9856; train_optim_loss: 1938706.9856; val_kl_reg_loss: 23075.1895; val_edge_recon_loss: 98411.2969; val_gene_expr_recon_loss: 1785377.3542; val_masked_gp_l1_reg_loss: 10055.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17772.4531; val_global_loss: 1934691.7188; val_optim_loss: 1934691.7188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9757; val_auprc_score: 0.9943; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 22455.9053; train_edge_recon_loss: 95756.7791; train_gene_expr_recon_loss: 1775991.3353; train_masked_gp_l1_reg_loss: 10083.5829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17408.2194; train_global_loss: 1921695.8173; train_optim_loss: 1921695.8173; val_kl_reg_loss: 21556.9259; val_edge_recon_loss: 96264.7428; val_gene_expr_recon_loss: 1770218.7292; val_masked_gp_l1_reg_loss: 10111.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17059.0684; val_global_loss: 1915211.5312; val_optim_loss: 1915211.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9775; val_auprc_score: 0.9948; val_best_acc_score: 0.9671; val_best_f1_score: 0.9810; train_kl_reg_loss: 21161.9270; train_edge_recon_loss: 94269.3371; train_gene_expr_recon_loss: 1762850.0745; train_masked_gp_l1_reg_loss: 10130.9517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16734.2015; train_global_loss: 1905146.4820; train_optim_loss: 1905146.4820; val_kl_reg_loss: 20205.8708; val_edge_recon_loss: 93473.8451; val_gene_expr_recon_loss: 1758193.9896; val_masked_gp_l1_reg_loss: 10149.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16422.0859; val_global_loss: 1898445.2083; val_optim_loss: 1898445.2083
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9782; val_auprc_score: 0.9953; val_best_acc_score: 0.9671; val_best_f1_score: 0.9809; train_kl_reg_loss: 19927.7500; train_edge_recon_loss: 93405.6303; train_gene_expr_recon_loss: 1750816.6130; train_masked_gp_l1_reg_loss: 10149.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16144.3544; train_global_loss: 1890443.8257; train_optim_loss: 1890443.8257; val_kl_reg_loss: 18878.5715; val_edge_recon_loss: 93725.9577; val_gene_expr_recon_loss: 1746041.8958; val_masked_gp_l1_reg_loss: 10153.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15890.2852; val_global_loss: 1884690.5521; val_optim_loss: 1884690.5521
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9773; val_auprc_score: 0.9947; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 18692.3555; train_edge_recon_loss: 91617.4010; train_gene_expr_recon_loss: 1738854.9748; train_masked_gp_l1_reg_loss: 10134.5792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15635.6863; train_global_loss: 1874935.0120; train_optim_loss: 1874935.0120; val_kl_reg_loss: 17935.6374; val_edge_recon_loss: 91076.3066; val_gene_expr_recon_loss: 1734421.6771; val_masked_gp_l1_reg_loss: 10112.5225; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15387.6680; val_global_loss: 1868933.7604; val_optim_loss: 1868933.7604
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9659; val_auprc_score: 0.9929; val_best_acc_score: 0.8909; val_best_f1_score: 0.9399; train_kl_reg_loss: 1437502.0670; train_edge_recon_loss: 116915.8382; train_gene_expr_recon_loss: 49705090.0673; train_masked_gp_l1_reg_loss: 10871.6697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12580.4557; train_global_loss: 51282960.2260; train_optim_loss: 51282960.2260; val_kl_reg_loss: 168703.0612; val_edge_recon_loss: 119402.1784; val_gene_expr_recon_loss: 7582473.1250; val_masked_gp_l1_reg_loss: 10938.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10296.9336; val_global_loss: 7891813.8333; val_optim_loss: 7891813.8333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9652; val_auprc_score: 0.9926; val_best_acc_score: 0.9396; val_best_f1_score: 0.9644; train_kl_reg_loss: 101957.3622; train_edge_recon_loss: 119093.1666; train_gene_expr_recon_loss: 2897607.1274; train_masked_gp_l1_reg_loss: 11381.7162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9011.1155; train_global_loss: 3139050.4712; train_optim_loss: 3139050.4712; val_kl_reg_loss: 77563.5625; val_edge_recon_loss: 119802.9915; val_gene_expr_recon_loss: 2297547.1458; val_masked_gp_l1_reg_loss: 11327.1885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7949.6279; val_global_loss: 2514190.7083; val_optim_loss: 2514190.7083
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9602; val_auprc_score: 0.9913; val_best_acc_score: 0.9326; val_best_f1_score: 0.9601; train_kl_reg_loss: 76311.4370; train_edge_recon_loss: 119238.2708; train_gene_expr_recon_loss: 2388593.9038; train_masked_gp_l1_reg_loss: 11129.3616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7228.8620; train_global_loss: 2602501.8678; train_optim_loss: 2602501.8678; val_kl_reg_loss: 65251.2002; val_edge_recon_loss: 118145.1263; val_gene_expr_recon_loss: 2136308.0417; val_masked_gp_l1_reg_loss: 10916.5879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6596.3535; val_global_loss: 2337217.1250; val_optim_loss: 2337217.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9609; val_auprc_score: 0.9916; val_best_acc_score: 0.9169; val_best_f1_score: 0.9501; train_kl_reg_loss: 61761.4224; train_edge_recon_loss: 118526.9759; train_gene_expr_recon_loss: 2095652.4615; train_masked_gp_l1_reg_loss: 10706.9032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6115.1768; train_global_loss: 2292762.9303; train_optim_loss: 2292762.9303; val_kl_reg_loss: 55023.2314; val_edge_recon_loss: 118070.7467; val_gene_expr_recon_loss: 2068834.8333; val_masked_gp_l1_reg_loss: 10499.6934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5674.4277; val_global_loss: 2258103.0833; val_optim_loss: 2258103.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9613; val_auprc_score: 0.9917; val_best_acc_score: 0.9149; val_best_f1_score: 0.9488; train_kl_reg_loss: 56437.8901; train_edge_recon_loss: 118888.6701; train_gene_expr_recon_loss: 2063380.9327; train_masked_gp_l1_reg_loss: 10441.0979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5515.1767; train_global_loss: 2254663.7788; train_optim_loss: 2254663.7788; val_kl_reg_loss: 54138.3975; val_edge_recon_loss: 116744.2389; val_gene_expr_recon_loss: 2065253.6042; val_masked_gp_l1_reg_loss: 10415.7793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5462.6714; val_global_loss: 2252014.7500; val_optim_loss: 2252014.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9602; val_auprc_score: 0.9914; val_best_acc_score: 0.9133; val_best_f1_score: 0.9476; train_kl_reg_loss: 55557.2771; train_edge_recon_loss: 119213.2874; train_gene_expr_recon_loss: 2058848.4988; train_masked_gp_l1_reg_loss: 10394.7482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5422.8755; train_global_loss: 2249436.6827; train_optim_loss: 2249436.6827; val_kl_reg_loss: 53360.5492; val_edge_recon_loss: 118878.9160; val_gene_expr_recon_loss: 2058901.3229; val_masked_gp_l1_reg_loss: 10372.9971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5381.5137; val_global_loss: 2246895.2917; val_optim_loss: 2246895.2917
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9621; val_auprc_score: 0.9918; val_best_acc_score: 0.9116; val_best_f1_score: 0.9466; train_kl_reg_loss: 54718.9827; train_edge_recon_loss: 118014.4216; train_gene_expr_recon_loss: 2055689.5541; train_masked_gp_l1_reg_loss: 10351.4903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5341.1805; train_global_loss: 2244115.6370; train_optim_loss: 2244115.6370; val_kl_reg_loss: 52474.1868; val_edge_recon_loss: 116989.7721; val_gene_expr_recon_loss: 2056215.8854; val_masked_gp_l1_reg_loss: 10329.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5299.8335; val_global_loss: 2241308.8542; val_optim_loss: 2241308.8542
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9619; val_auprc_score: 0.9920; val_best_acc_score: 0.9097; val_best_f1_score: 0.9453; train_kl_reg_loss: 53870.1755; train_edge_recon_loss: 118280.1080; train_gene_expr_recon_loss: 2052574.5228; train_masked_gp_l1_reg_loss: 10307.0847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5258.3097; train_global_loss: 2240290.1683; train_optim_loss: 2240290.1683; val_kl_reg_loss: 51699.1911; val_edge_recon_loss: 117752.9512; val_gene_expr_recon_loss: 2053648.2708; val_masked_gp_l1_reg_loss: 10284.1201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5215.8438; val_global_loss: 2238600.1458; val_optim_loss: 2238600.1458

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 71 min 22 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9800
val AUPRC score: 0.9955
val best accuracy score: 0.9709
val best F1 score: 0.9831
val target rna MSE score: 21.4110
val source rna MSE score: 192.4582
Val cat covariate0 mean sim diff: -0.0020

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
