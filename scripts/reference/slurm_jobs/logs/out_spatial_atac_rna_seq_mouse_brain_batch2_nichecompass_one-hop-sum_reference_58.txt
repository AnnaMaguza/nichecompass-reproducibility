[True]
Run timestamp: 10082023_212546_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8093; val_auprc_score: 0.8183; val_best_acc_score: 0.5773; val_best_f1_score: 0.7003; train_kl_reg_loss: 160252.7523; train_edge_recon_loss: 3748077.9790; train_gene_expr_recon_loss: 47480550.7176; train_masked_gp_l1_reg_loss: 90356.7042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 247279.6597; train_chrom_access_recon_loss: 25871814.9008; train_global_loss: 77598332.8244; train_optim_loss: 77598332.8244; val_kl_reg_loss: 176408.8062; val_edge_recon_loss: 4061287.6500; val_gene_expr_recon_loss: 38968279.4667; val_masked_gp_l1_reg_loss: 85315.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243780.4375; val_chrom_access_recon_loss: 23116700.5333; val_global_loss: 66651772.2667; val_optim_loss: 66651772.2667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8180; val_auprc_score: 0.8298; val_best_acc_score: 0.6087; val_best_f1_score: 0.7122; train_kl_reg_loss: 221406.0149; train_edge_recon_loss: 3648776.0134; train_gene_expr_recon_loss: 38013051.7252; train_masked_gp_l1_reg_loss: 81524.8534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239400.6341; train_chrom_access_recon_loss: 23198120.9771; train_global_loss: 65402279.9695; train_optim_loss: 65402279.9695; val_kl_reg_loss: 236634.4823; val_edge_recon_loss: 4059140.4667; val_gene_expr_recon_loss: 37980712.0000; val_masked_gp_l1_reg_loss: 78550.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234606.4375; val_chrom_access_recon_loss: 23155408.9333; val_global_loss: 65745055.7333; val_optim_loss: 65745055.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8796; val_auprc_score: 0.8780; val_best_acc_score: 0.7599; val_best_f1_score: 0.7806; train_kl_reg_loss: 200663.1456; train_edge_recon_loss: 3583442.4943; train_gene_expr_recon_loss: 37104523.7252; train_masked_gp_l1_reg_loss: 77605.5731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229226.8058; train_chrom_access_recon_loss: 23041191.6489; train_global_loss: 64236653.3740; train_optim_loss: 64236653.3740; val_kl_reg_loss: 178154.3344; val_edge_recon_loss: 3983841.5167; val_gene_expr_recon_loss: 37373720.8000; val_masked_gp_l1_reg_loss: 78008.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 223748.0156; val_chrom_access_recon_loss: 22847574.1333; val_global_loss: 64685046.9333; val_optim_loss: 64685046.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8882; val_auprc_score: 0.8838; val_best_acc_score: 0.7912; val_best_f1_score: 0.8060; train_kl_reg_loss: 166073.8115; train_edge_recon_loss: 3438600.9599; train_gene_expr_recon_loss: 36665255.5725; train_masked_gp_l1_reg_loss: 79381.2606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218329.6505; train_chrom_access_recon_loss: 22844721.2672; train_global_loss: 63412362.9924; train_optim_loss: 63412362.9924; val_kl_reg_loss: 168754.7302; val_edge_recon_loss: 3214662.9833; val_gene_expr_recon_loss: 36932018.4000; val_masked_gp_l1_reg_loss: 81750.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212837.6875; val_chrom_access_recon_loss: 22592023.7333; val_global_loss: 63202048.5333; val_optim_loss: 63202048.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8960; val_auprc_score: 0.8876; val_best_acc_score: 0.8050; val_best_f1_score: 0.8173; train_kl_reg_loss: 205718.8025; train_edge_recon_loss: 3054917.7099; train_gene_expr_recon_loss: 36389028.8550; train_masked_gp_l1_reg_loss: 82809.8938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207466.7768; train_chrom_access_recon_loss: 22685522.4122; train_global_loss: 62625464.4580; train_optim_loss: 62625464.4580; val_kl_reg_loss: 206278.4885; val_edge_recon_loss: 3015637.4833; val_gene_expr_recon_loss: 36810862.4000; val_masked_gp_l1_reg_loss: 84146.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202109.8438; val_chrom_access_recon_loss: 22631702.9333; val_global_loss: 62950737.6000; val_optim_loss: 62950737.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9098; val_auprc_score: 0.8982; val_best_acc_score: 0.8310; val_best_f1_score: 0.8452; train_kl_reg_loss: 200104.7099; train_edge_recon_loss: 2996420.8721; train_gene_expr_recon_loss: 36152483.5725; train_masked_gp_l1_reg_loss: 84964.3825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197080.5710; train_chrom_access_recon_loss: 22564877.4351; train_global_loss: 62195931.3893; train_optim_loss: 62195931.3893; val_kl_reg_loss: 192572.7792; val_edge_recon_loss: 2976291.8833; val_gene_expr_recon_loss: 36437976.0000; val_masked_gp_l1_reg_loss: 86125.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192168.7812; val_chrom_access_recon_loss: 22394897.7333; val_global_loss: 62280030.4000; val_optim_loss: 62280030.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9318; val_auprc_score: 0.9189; val_best_acc_score: 0.8614; val_best_f1_score: 0.8689; train_kl_reg_loss: 191134.6511; train_edge_recon_loss: 2943049.2844; train_gene_expr_recon_loss: 35924975.6336; train_masked_gp_l1_reg_loss: 87491.1756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187615.2089; train_chrom_access_recon_loss: 22439246.6107; train_global_loss: 61773512.5496; train_optim_loss: 61773512.5496; val_kl_reg_loss: 179765.9708; val_edge_recon_loss: 2917419.8500; val_gene_expr_recon_loss: 36311810.9333; val_masked_gp_l1_reg_loss: 88684.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183090.5469; val_chrom_access_recon_loss: 22248404.8000; val_global_loss: 61929177.6000; val_optim_loss: 61929177.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9408; val_auprc_score: 0.9274; val_best_acc_score: 0.8739; val_best_f1_score: 0.8821; train_kl_reg_loss: 186415.3336; train_edge_recon_loss: 2896282.8702; train_gene_expr_recon_loss: 35709607.6183; train_masked_gp_l1_reg_loss: 90095.6880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178875.3545; train_chrom_access_recon_loss: 22305028.8702; train_global_loss: 61366305.3130; train_optim_loss: 61366305.3130; val_kl_reg_loss: 185207.7729; val_edge_recon_loss: 2878044.5833; val_gene_expr_recon_loss: 36263747.7333; val_masked_gp_l1_reg_loss: 91503.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174678.5000; val_chrom_access_recon_loss: 22260734.9333; val_global_loss: 61853919.4667; val_optim_loss: 61853919.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9335; val_best_acc_score: 0.8840; val_best_f1_score: 0.8886; train_kl_reg_loss: 182451.4171; train_edge_recon_loss: 2864420.9580; train_gene_expr_recon_loss: 35533609.5573; train_masked_gp_l1_reg_loss: 92722.2216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170700.2215; train_chrom_access_recon_loss: 22210517.0076; train_global_loss: 61054421.1908; train_optim_loss: 61054421.1908; val_kl_reg_loss: 174993.1187; val_edge_recon_loss: 2861998.1500; val_gene_expr_recon_loss: 35890125.6000; val_masked_gp_l1_reg_loss: 93977.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166716.6562; val_chrom_access_recon_loss: 22011775.3333; val_global_loss: 61199584.2667; val_optim_loss: 61199584.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9511; val_auprc_score: 0.9390; val_best_acc_score: 0.8914; val_best_f1_score: 0.8979; train_kl_reg_loss: 179693.4741; train_edge_recon_loss: 2843093.7977; train_gene_expr_recon_loss: 35376556.1985; train_masked_gp_l1_reg_loss: 95152.3612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162952.7069; train_chrom_access_recon_loss: 22117562.0916; train_global_loss: 60775010.5038; train_optim_loss: 60775010.5038; val_kl_reg_loss: 176514.5302; val_edge_recon_loss: 2844929.1333; val_gene_expr_recon_loss: 35788722.6667; val_masked_gp_l1_reg_loss: 96516.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159247.4062; val_chrom_access_recon_loss: 21868437.2000; val_global_loss: 60934367.4667; val_optim_loss: 60934367.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9535; val_auprc_score: 0.9417; val_best_acc_score: 0.8941; val_best_f1_score: 0.8992; train_kl_reg_loss: 175152.0107; train_edge_recon_loss: 2824217.3836; train_gene_expr_recon_loss: 35298292.1221; train_masked_gp_l1_reg_loss: 97706.6922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155729.9169; train_chrom_access_recon_loss: 22105633.3588; train_global_loss: 60656731.6947; train_optim_loss: 60656731.6947; val_kl_reg_loss: 173551.5167; val_edge_recon_loss: 2832754.5000; val_gene_expr_recon_loss: 35668319.3333; val_masked_gp_l1_reg_loss: 98758.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152244.2656; val_chrom_access_recon_loss: 21962968.4000; val_global_loss: 60888597.3333; val_optim_loss: 60888597.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9546; val_auprc_score: 0.9416; val_best_acc_score: 0.8961; val_best_f1_score: 0.9014; train_kl_reg_loss: 170592.7059; train_edge_recon_loss: 2815203.2195; train_gene_expr_recon_loss: 35112391.1145; train_masked_gp_l1_reg_loss: 100053.7186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149059.4796; train_chrom_access_recon_loss: 21973674.2443; train_global_loss: 60320974.2595; train_optim_loss: 60320974.2595; val_kl_reg_loss: 168440.3656; val_edge_recon_loss: 2834953.3667; val_gene_expr_recon_loss: 35620927.4667; val_masked_gp_l1_reg_loss: 101187.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145919.4375; val_chrom_access_recon_loss: 21892084.6667; val_global_loss: 60763513.3333; val_optim_loss: 60763513.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9562; val_auprc_score: 0.9438; val_best_acc_score: 0.9025; val_best_f1_score: 0.9070; train_kl_reg_loss: 166299.6614; train_edge_recon_loss: 2803314.5172; train_gene_expr_recon_loss: 35009157.2366; train_masked_gp_l1_reg_loss: 102291.3397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143050.5253; train_chrom_access_recon_loss: 21907617.1450; train_global_loss: 60131730.1374; train_optim_loss: 60131730.1374; val_kl_reg_loss: 166083.3385; val_edge_recon_loss: 2799536.3500; val_gene_expr_recon_loss: 35470121.8667; val_masked_gp_l1_reg_loss: 103477.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140312.2344; val_chrom_access_recon_loss: 21783650.9333; val_global_loss: 60463181.0667; val_optim_loss: 60463181.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9651; val_auprc_score: 0.9569; val_best_acc_score: 0.9078; val_best_f1_score: 0.9117; train_kl_reg_loss: 161819.1714; train_edge_recon_loss: 2798129.9370; train_gene_expr_recon_loss: 34907374.7176; train_masked_gp_l1_reg_loss: 104666.9473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137671.4940; train_chrom_access_recon_loss: 21868631.9695; train_global_loss: 59978294.1069; train_optim_loss: 59978294.1069; val_kl_reg_loss: 162974.3104; val_edge_recon_loss: 2785052.6833; val_gene_expr_recon_loss: 35445424.2667; val_masked_gp_l1_reg_loss: 105956.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135229.6406; val_chrom_access_recon_loss: 21816054.6667; val_global_loss: 60450689.8667; val_optim_loss: 60450689.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9598; val_auprc_score: 0.9511; val_best_acc_score: 0.9015; val_best_f1_score: 0.9063; train_kl_reg_loss: 157834.3907; train_edge_recon_loss: 2789462.0515; train_gene_expr_recon_loss: 34783917.7099; train_masked_gp_l1_reg_loss: 107102.8319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132723.7453; train_chrom_access_recon_loss: 21789155.0534; train_global_loss: 59760196.1832; train_optim_loss: 59760196.1832; val_kl_reg_loss: 157618.0917; val_edge_recon_loss: 2822247.4500; val_gene_expr_recon_loss: 35359314.0000; val_masked_gp_l1_reg_loss: 108227.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130255.7969; val_chrom_access_recon_loss: 21646445.2000; val_global_loss: 60224108.8000; val_optim_loss: 60224108.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9642; val_auprc_score: 0.9556; val_best_acc_score: 0.9113; val_best_f1_score: 0.9157; train_kl_reg_loss: 155502.8313; train_edge_recon_loss: 2783945.4790; train_gene_expr_recon_loss: 34674787.0992; train_masked_gp_l1_reg_loss: 109281.6902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127909.1007; train_chrom_access_recon_loss: 21740122.0153; train_global_loss: 59591548.0611; train_optim_loss: 59591548.0611; val_kl_reg_loss: 153388.3438; val_edge_recon_loss: 2790988.0333; val_gene_expr_recon_loss: 35247808.0000; val_masked_gp_l1_reg_loss: 110357.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125610.3672; val_chrom_access_recon_loss: 21660974.2667; val_global_loss: 60089126.1333; val_optim_loss: 60089126.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9640; val_auprc_score: 0.9545; val_best_acc_score: 0.9105; val_best_f1_score: 0.9138; train_kl_reg_loss: 151961.5252; train_edge_recon_loss: 2776222.1565; train_gene_expr_recon_loss: 34584563.2214; train_masked_gp_l1_reg_loss: 111360.2026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123382.6895; train_chrom_access_recon_loss: 21684702.3511; train_global_loss: 59432192.5191; train_optim_loss: 59432192.5191; val_kl_reg_loss: 151798.7667; val_edge_recon_loss: 2797605.7167; val_gene_expr_recon_loss: 35067043.4667; val_masked_gp_l1_reg_loss: 112628.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121149.4141; val_chrom_access_recon_loss: 21586016.5333; val_global_loss: 59836240.2667; val_optim_loss: 59836240.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9670; val_auprc_score: 0.9594; val_best_acc_score: 0.9119; val_best_f1_score: 0.9163; train_kl_reg_loss: 149496.2029; train_edge_recon_loss: 2770196.3607; train_gene_expr_recon_loss: 34505266.0916; train_masked_gp_l1_reg_loss: 113586.5312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119074.0488; train_chrom_access_recon_loss: 21654038.4733; train_global_loss: 59311657.7405; train_optim_loss: 59311657.7405; val_kl_reg_loss: 150284.4625; val_edge_recon_loss: 2785262.7000; val_gene_expr_recon_loss: 35019942.4000; val_masked_gp_l1_reg_loss: 114597.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117061.7031; val_chrom_access_recon_loss: 21588100.1333; val_global_loss: 59775245.6000; val_optim_loss: 59775245.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9699; val_auprc_score: 0.9622; val_best_acc_score: 0.9210; val_best_f1_score: 0.9243; train_kl_reg_loss: 148326.7180; train_edge_recon_loss: 2772239.0305; train_gene_expr_recon_loss: 34443878.1832; train_masked_gp_l1_reg_loss: 115718.6555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115031.5952; train_chrom_access_recon_loss: 21621394.5038; train_global_loss: 59216589.0076; train_optim_loss: 59216589.0076; val_kl_reg_loss: 148312.5521; val_edge_recon_loss: 2755589.4167; val_gene_expr_recon_loss: 34982745.4667; val_masked_gp_l1_reg_loss: 116618.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113093.1406; val_chrom_access_recon_loss: 21447365.4667; val_global_loss: 59563725.6000; val_optim_loss: 59563725.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9688; val_auprc_score: 0.9615; val_best_acc_score: 0.9128; val_best_f1_score: 0.9165; train_kl_reg_loss: 145375.9778; train_edge_recon_loss: 2762289.3817; train_gene_expr_recon_loss: 34378174.7939; train_masked_gp_l1_reg_loss: 117786.7473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111214.9334; train_chrom_access_recon_loss: 21583884.4580; train_global_loss: 59098726.1069; train_optim_loss: 59098726.1069; val_kl_reg_loss: 147201.5771; val_edge_recon_loss: 2778887.2500; val_gene_expr_recon_loss: 34960040.8000; val_masked_gp_l1_reg_loss: 118890.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109412.5625; val_chrom_access_recon_loss: 21537723.7333; val_global_loss: 59652156.2667; val_optim_loss: 59652156.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9707; val_auprc_score: 0.9644; val_best_acc_score: 0.9196; val_best_f1_score: 0.9224; train_kl_reg_loss: 144926.6741; train_edge_recon_loss: 2763365.7557; train_gene_expr_recon_loss: 34295007.1298; train_masked_gp_l1_reg_loss: 120578.1941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107663.2273; train_chrom_access_recon_loss: 21546528.9313; train_global_loss: 58978070.0153; train_optim_loss: 58978070.0153; val_kl_reg_loss: 145685.4875; val_edge_recon_loss: 2782002.6000; val_gene_expr_recon_loss: 34868832.5333; val_masked_gp_l1_reg_loss: 121860.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105930.2266; val_chrom_access_recon_loss: 21503869.6000; val_global_loss: 59528181.6000; val_optim_loss: 59528181.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9723; val_auprc_score: 0.9645; val_best_acc_score: 0.9220; val_best_f1_score: 0.9248; train_kl_reg_loss: 143765.6621; train_edge_recon_loss: 2750635.5706; train_gene_expr_recon_loss: 34238252.8244; train_masked_gp_l1_reg_loss: 122671.2537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104296.7057; train_chrom_access_recon_loss: 21524245.1145; train_global_loss: 58883867.4198; train_optim_loss: 58883867.4198; val_kl_reg_loss: 141156.0823; val_edge_recon_loss: 2773064.5167; val_gene_expr_recon_loss: 34744392.0000; val_masked_gp_l1_reg_loss: 123491.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102720.6797; val_chrom_access_recon_loss: 21421630.5333; val_global_loss: 59306455.7333; val_optim_loss: 59306455.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9735; val_auprc_score: 0.9669; val_best_acc_score: 0.9252; val_best_f1_score: 0.9284; train_kl_reg_loss: 140782.6901; train_edge_recon_loss: 2760862.2786; train_gene_expr_recon_loss: 34154978.7328; train_masked_gp_l1_reg_loss: 124540.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101254.6038; train_chrom_access_recon_loss: 21485437.1450; train_global_loss: 58767855.5115; train_optim_loss: 58767855.5115; val_kl_reg_loss: 140188.7271; val_edge_recon_loss: 2774254.3167; val_gene_expr_recon_loss: 34685682.4000; val_masked_gp_l1_reg_loss: 125256.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99828.1797; val_chrom_access_recon_loss: 21309243.0667; val_global_loss: 59134452.2667; val_optim_loss: 59134452.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9745; val_auprc_score: 0.9688; val_best_acc_score: 0.9258; val_best_f1_score: 0.9270; train_kl_reg_loss: 139568.5583; train_edge_recon_loss: 2757990.1794; train_gene_expr_recon_loss: 34112417.5420; train_masked_gp_l1_reg_loss: 126315.0870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98392.3520; train_chrom_access_recon_loss: 21463081.4046; train_global_loss: 58697764.9466; train_optim_loss: 58697764.9466; val_kl_reg_loss: 137944.3698; val_edge_recon_loss: 2759812.3833; val_gene_expr_recon_loss: 34667811.2000; val_masked_gp_l1_reg_loss: 127134.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96889.2734; val_chrom_access_recon_loss: 21323919.0667; val_global_loss: 59113510.9333; val_optim_loss: 59113510.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9744; val_auprc_score: 0.9701; val_best_acc_score: 0.9227; val_best_f1_score: 0.9253; train_kl_reg_loss: 137567.8943; train_edge_recon_loss: 2752306.5229; train_gene_expr_recon_loss: 34060205.0992; train_masked_gp_l1_reg_loss: 128032.6267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95478.7885; train_chrom_access_recon_loss: 21426094.1221; train_global_loss: 58599684.9771; train_optim_loss: 58599684.9771; val_kl_reg_loss: 139557.1656; val_edge_recon_loss: 2767149.7500; val_gene_expr_recon_loss: 34611457.3333; val_masked_gp_l1_reg_loss: 128835.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94120.2734; val_chrom_access_recon_loss: 21345493.6000; val_global_loss: 59086614.1333; val_optim_loss: 59086614.1333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9758; val_auprc_score: 0.9712; val_best_acc_score: 0.9276; val_best_f1_score: 0.9295; train_kl_reg_loss: 143485.1492; train_edge_recon_loss: 2805813.4905; train_gene_expr_recon_loss: 35992475.4809; train_masked_gp_l1_reg_loss: 128225.1545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95894.0379; train_chrom_access_recon_loss: 21700851.6489; train_global_loss: 60866744.7939; train_optim_loss: 60866744.7939; val_kl_reg_loss: 69742.7333; val_edge_recon_loss: 2798733.3167; val_gene_expr_recon_loss: 36652509.6000; val_masked_gp_l1_reg_loss: 128972.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96952.2578; val_chrom_access_recon_loss: 21767751.0667; val_global_loss: 61514660.5333; val_optim_loss: 61514660.5333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9720; val_auprc_score: 0.9667; val_best_acc_score: 0.9200; val_best_f1_score: 0.9230; train_kl_reg_loss: 142740.1981; train_edge_recon_loss: 2799911.1660; train_gene_expr_recon_loss: 36497503.9695; train_masked_gp_l1_reg_loss: 129246.8397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96801.4919; train_chrom_access_recon_loss: 21824897.7710; train_global_loss: 61491101.5878; train_optim_loss: 61491101.5878; val_kl_reg_loss: 72863.3630; val_edge_recon_loss: 2793365.1000; val_gene_expr_recon_loss: 36686832.2667; val_masked_gp_l1_reg_loss: 128876.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95901.2812; val_chrom_access_recon_loss: 21723182.2667; val_global_loss: 61501018.4000; val_optim_loss: 61501018.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9741; val_auprc_score: 0.9674; val_best_acc_score: 0.9221; val_best_f1_score: 0.9249; train_kl_reg_loss: 136808.7726; train_edge_recon_loss: 2780320.8626; train_gene_expr_recon_loss: 36056696.9466; train_masked_gp_l1_reg_loss: 128866.1307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94570.3516; train_chrom_access_recon_loss: 21754920.6412; train_global_loss: 60952183.6336; train_optim_loss: 60952183.6336; val_kl_reg_loss: 72853.5307; val_edge_recon_loss: 2773438.3833; val_gene_expr_recon_loss: 36413214.1333; val_masked_gp_l1_reg_loss: 128690.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93656.3828; val_chrom_access_recon_loss: 21487908.4000; val_global_loss: 60969762.6667; val_optim_loss: 60969762.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9718; val_auprc_score: 0.9649; val_best_acc_score: 0.9237; val_best_f1_score: 0.9253; train_kl_reg_loss: 130100.3374; train_edge_recon_loss: 2755385.4447; train_gene_expr_recon_loss: 35951425.3130; train_masked_gp_l1_reg_loss: 128052.5611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92486.3443; train_chrom_access_recon_loss: 21706926.5496; train_global_loss: 60764376.6107; train_optim_loss: 60764376.6107; val_kl_reg_loss: 73321.2693; val_edge_recon_loss: 2778159.4667; val_gene_expr_recon_loss: 36519218.4000; val_masked_gp_l1_reg_loss: 127412.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91358.7656; val_chrom_access_recon_loss: 21628961.0667; val_global_loss: 61218431.7333; val_optim_loss: 61218431.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9722; val_auprc_score: 0.9621; val_best_acc_score: 0.9225; val_best_f1_score: 0.9256; train_kl_reg_loss: 129139.9202; train_edge_recon_loss: 2755422.4065; train_gene_expr_recon_loss: 35971364.0611; train_masked_gp_l1_reg_loss: 127070.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91073.3027; train_chrom_access_recon_loss: 21703873.4656; train_global_loss: 60777943.7863; train_optim_loss: 60777943.7863; val_kl_reg_loss: 75082.0667; val_edge_recon_loss: 2744257.0667; val_gene_expr_recon_loss: 36342515.7333; val_masked_gp_l1_reg_loss: 126926.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90805.2578; val_chrom_access_recon_loss: 21467163.4667; val_global_loss: 60846750.1333; val_optim_loss: 60846750.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9750; val_auprc_score: 0.9679; val_best_acc_score: 0.9271; val_best_f1_score: 0.9294; train_kl_reg_loss: 128931.2083; train_edge_recon_loss: 2749508.8874; train_gene_expr_recon_loss: 35983167.4198; train_masked_gp_l1_reg_loss: 126815.3536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90593.9531; train_chrom_access_recon_loss: 21710813.8168; train_global_loss: 60789830.5954; train_optim_loss: 60789830.5954; val_kl_reg_loss: 76458.8651; val_edge_recon_loss: 2743416.4833; val_gene_expr_recon_loss: 36457236.0000; val_masked_gp_l1_reg_loss: 126697.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90383.0312; val_chrom_access_recon_loss: 21604438.0000; val_global_loss: 61098629.3333; val_optim_loss: 61098629.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9752; val_auprc_score: 0.9681; val_best_acc_score: 0.9267; val_best_f1_score: 0.9291; train_kl_reg_loss: 181836.0899; train_edge_recon_loss: 2750019.2977; train_gene_expr_recon_loss: 35927976.6718; train_masked_gp_l1_reg_loss: 126495.4439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90190.9868; train_chrom_access_recon_loss: 21641618.4580; train_global_loss: 60718137.0687; train_optim_loss: 60718137.0687; val_kl_reg_loss: 72352.7724; val_edge_recon_loss: 2760883.6333; val_gene_expr_recon_loss: 36443541.8667; val_masked_gp_l1_reg_loss: 126367.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89981.3281; val_chrom_access_recon_loss: 21589984.5333; val_global_loss: 61083111.4667; val_optim_loss: 61083111.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9734; val_auprc_score: 0.9631; val_best_acc_score: 0.9240; val_best_f1_score: 0.9260; train_kl_reg_loss: 129497.8927; train_edge_recon_loss: 2755062.8855; train_gene_expr_recon_loss: 36007912.1832; train_masked_gp_l1_reg_loss: 126253.8614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89807.3971; train_chrom_access_recon_loss: 21699935.8473; train_global_loss: 60808470.1679; train_optim_loss: 60808470.1679; val_kl_reg_loss: 75096.0047; val_edge_recon_loss: 2758415.8000; val_gene_expr_recon_loss: 36491703.4667; val_masked_gp_l1_reg_loss: 126133.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89609.4688; val_chrom_access_recon_loss: 21579483.2000; val_global_loss: 61120437.8667; val_optim_loss: 61120437.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9729
val AUPRC score: 0.9669
val best accuracy score: 0.9259
val best F1 score: 0.9290
val target rna MSE score: 1.7201
val source rna MSE score: 55.2680
val target atac MSE score: 0.1265
val source atac MSE score: 0.9972
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
