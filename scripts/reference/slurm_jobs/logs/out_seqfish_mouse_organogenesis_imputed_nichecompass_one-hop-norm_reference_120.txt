[True]
Run timestamp: 27072023_020736_120.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_120']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8724; val_auprc_score: 0.9755; val_best_acc_score: 0.8638; val_best_f1_score: 0.9262; train_kl_reg_loss: 194129.2596; train_edge_recon_loss: 10393707.6907; train_gene_expr_recon_loss: 2346374.1064; train_masked_gp_l1_reg_loss: 15609.3744; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12949820.5116; train_optim_loss: 12949820.5116; val_kl_reg_loss: 26840.6775; val_edge_recon_loss: 11794724.1667; val_gene_expr_recon_loss: 1365453.4271; val_masked_gp_l1_reg_loss: 18172.5820; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13205191.4167; val_optim_loss: 13205191.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8622; val_auprc_score: 0.9723; val_best_acc_score: 0.8754; val_best_f1_score: 0.9320; train_kl_reg_loss: 56198.0405; train_edge_recon_loss: 10298505.9651; train_gene_expr_recon_loss: 1224638.3924; train_masked_gp_l1_reg_loss: 18613.9429; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11597956.3256; train_optim_loss: 11597956.3256; val_kl_reg_loss: 52348.1794; val_edge_recon_loss: 11702212.2500; val_gene_expr_recon_loss: 1121121.2656; val_masked_gp_l1_reg_loss: 18724.2852; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12894405.7083; val_optim_loss: 12894405.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8259; val_auprc_score: 0.9606; val_best_acc_score: 0.8825; val_best_f1_score: 0.9353; train_kl_reg_loss: 47200.7029; train_edge_recon_loss: 10192406.8977; train_gene_expr_recon_loss: 1099698.4314; train_masked_gp_l1_reg_loss: 18778.9828; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11358084.9907; train_optim_loss: 11358084.9907; val_kl_reg_loss: 13277.3050; val_edge_recon_loss: 9479105.5000; val_gene_expr_recon_loss: 1205573.2344; val_masked_gp_l1_reg_loss: 19863.2031; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10717819.0833; val_optim_loss: 10717819.0833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8413; val_auprc_score: 0.9632; val_best_acc_score: 0.9043; val_best_f1_score: 0.9463; train_kl_reg_loss: 43248.1642; train_edge_recon_loss: 8809939.3628; train_gene_expr_recon_loss: 1081238.8122; train_masked_gp_l1_reg_loss: 21174.7607; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9955601.0953; train_optim_loss: 9955601.0953; val_kl_reg_loss: 58420.2816; val_edge_recon_loss: 8721184.2500; val_gene_expr_recon_loss: 1004430.7370; val_masked_gp_l1_reg_loss: 21386.6992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9805422.2917; val_optim_loss: 9805422.2917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8487; val_auprc_score: 0.9668; val_best_acc_score: 0.9068; val_best_f1_score: 0.9480; train_kl_reg_loss: 58163.1799; train_edge_recon_loss: 8626207.2698; train_gene_expr_recon_loss: 986066.8544; train_masked_gp_l1_reg_loss: 21318.8721; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9691756.2047; train_optim_loss: 9691756.2047; val_kl_reg_loss: 51444.2531; val_edge_recon_loss: 8464787.3125; val_gene_expr_recon_loss: 956469.1562; val_masked_gp_l1_reg_loss: 21224.8027; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9493925.6042; val_optim_loss: 9493925.6042
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8817; val_auprc_score: 0.9723; val_best_acc_score: 0.9059; val_best_f1_score: 0.9463; train_kl_reg_loss: 41353.8036; train_edge_recon_loss: 8252623.3465; train_gene_expr_recon_loss: 954524.8456; train_masked_gp_l1_reg_loss: 21260.2893; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9269762.3023; train_optim_loss: 9269762.3023; val_kl_reg_loss: 45301.9434; val_edge_recon_loss: 8260585.6458; val_gene_expr_recon_loss: 928878.1797; val_masked_gp_l1_reg_loss: 21120.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9255886.7708; val_optim_loss: 9255886.7708
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9023; val_auprc_score: 0.9773; val_best_acc_score: 0.9119; val_best_f1_score: 0.9492; train_kl_reg_loss: 39176.6909; train_edge_recon_loss: 8072306.4767; train_gene_expr_recon_loss: 915347.1567; train_masked_gp_l1_reg_loss: 20724.9239; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9047555.2395; train_optim_loss: 9047555.2395; val_kl_reg_loss: 34027.0441; val_edge_recon_loss: 8268990.8958; val_gene_expr_recon_loss: 895912.8620; val_masked_gp_l1_reg_loss: 20259.6172; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9219190.7083; val_optim_loss: 9219190.7083
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9179; val_auprc_score: 0.9817; val_best_acc_score: 0.9201; val_best_f1_score: 0.9540; train_kl_reg_loss: 32120.8776; train_edge_recon_loss: 8003783.3744; train_gene_expr_recon_loss: 890190.9506; train_masked_gp_l1_reg_loss: 19747.7314; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8945842.9186; train_optim_loss: 8945842.9186; val_kl_reg_loss: 30145.3651; val_edge_recon_loss: 8120036.0625; val_gene_expr_recon_loss: 880574.4635; val_masked_gp_l1_reg_loss: 19219.0645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9049974.9583; val_optim_loss: 9049974.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9338; val_auprc_score: 0.9859; val_best_acc_score: 0.9245; val_best_f1_score: 0.9566; train_kl_reg_loss: 30083.6036; train_edge_recon_loss: 7826826.2326; train_gene_expr_recon_loss: 869293.3500; train_masked_gp_l1_reg_loss: 18619.6190; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8744822.8186; train_optim_loss: 8744822.8186; val_kl_reg_loss: 28090.4116; val_edge_recon_loss: 7819174.7083; val_gene_expr_recon_loss: 859798.9323; val_masked_gp_l1_reg_loss: 18007.6660; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8725071.8958; val_optim_loss: 8725071.8958
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9255; val_auprc_score: 0.9839; val_best_acc_score: 0.9195; val_best_f1_score: 0.9536; train_kl_reg_loss: 28380.7338; train_edge_recon_loss: 7901218.7814; train_gene_expr_recon_loss: 852155.4576; train_masked_gp_l1_reg_loss: 17413.4701; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8799168.4744; train_optim_loss: 8799168.4744; val_kl_reg_loss: 26829.1799; val_edge_recon_loss: 8123288.8542; val_gene_expr_recon_loss: 845231.9583; val_masked_gp_l1_reg_loss: 16801.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9012151.8958; val_optim_loss: 9012151.8958
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9414; val_auprc_score: 0.9865; val_best_acc_score: 0.9272; val_best_f1_score: 0.9580; train_kl_reg_loss: 27144.6206; train_edge_recon_loss: 7863694.2326; train_gene_expr_recon_loss: 837618.8520; train_masked_gp_l1_reg_loss: 16213.4337; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8744671.1674; train_optim_loss: 8744671.1674; val_kl_reg_loss: 24621.8517; val_edge_recon_loss: 7837426.3750; val_gene_expr_recon_loss: 831263.3411; val_masked_gp_l1_reg_loss: 15690.2832; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8709001.7917; val_optim_loss: 8709001.7917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9413; val_auprc_score: 0.9860; val_best_acc_score: 0.9306; val_best_f1_score: 0.9598; train_kl_reg_loss: 24327.8030; train_edge_recon_loss: 7838035.7907; train_gene_expr_recon_loss: 826209.0948; train_masked_gp_l1_reg_loss: 15082.8540; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8703655.5651; train_optim_loss: 8703655.5651; val_kl_reg_loss: 23484.4898; val_edge_recon_loss: 7914643.0208; val_gene_expr_recon_loss: 820337.9740; val_masked_gp_l1_reg_loss: 14465.5762; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8772931.2917; val_optim_loss: 8772931.2917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9388; val_auprc_score: 0.9859; val_best_acc_score: 0.9312; val_best_f1_score: 0.9598; train_kl_reg_loss: 24194.7389; train_edge_recon_loss: 7747114.4209; train_gene_expr_recon_loss: 815151.6294; train_masked_gp_l1_reg_loss: 13921.8823; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8600382.6930; train_optim_loss: 8600382.6930; val_kl_reg_loss: 24696.1204; val_edge_recon_loss: 8176375.2708; val_gene_expr_recon_loss: 811125.1406; val_masked_gp_l1_reg_loss: 13388.7520; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9025585.6042; val_optim_loss: 9025585.6042
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9484; val_auprc_score: 0.9885; val_best_acc_score: 0.9387; val_best_f1_score: 0.9647; train_kl_reg_loss: 23270.1489; train_edge_recon_loss: 7667241.4977; train_gene_expr_recon_loss: 805241.8128; train_masked_gp_l1_reg_loss: 12970.9588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8508724.4279; train_optim_loss: 8508724.4279; val_kl_reg_loss: 22877.9111; val_edge_recon_loss: 7858350.5625; val_gene_expr_recon_loss: 800907.2526; val_masked_gp_l1_reg_loss: 12647.3770; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8694782.7917; val_optim_loss: 8694782.7917
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9517; val_auprc_score: 0.9890; val_best_acc_score: 0.9410; val_best_f1_score: 0.9661; train_kl_reg_loss: 23637.2208; train_edge_recon_loss: 7751641.5628; train_gene_expr_recon_loss: 796310.1189; train_masked_gp_l1_reg_loss: 12144.3326; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8583733.2302; train_optim_loss: 8583733.2302; val_kl_reg_loss: 20400.8360; val_edge_recon_loss: 7868656.6667; val_gene_expr_recon_loss: 793794.3177; val_masked_gp_l1_reg_loss: 11822.7939; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8694674.8333; val_optim_loss: 8694674.8333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9496; val_auprc_score: 0.9873; val_best_acc_score: 0.9379; val_best_f1_score: 0.9641; train_kl_reg_loss: 22190.3170; train_edge_recon_loss: 7835411.7767; train_gene_expr_recon_loss: 787679.7971; train_masked_gp_l1_reg_loss: 11441.1418; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8656723.1186; train_optim_loss: 8656723.1186; val_kl_reg_loss: 20925.4067; val_edge_recon_loss: 7967544.6042; val_gene_expr_recon_loss: 783697.2526; val_masked_gp_l1_reg_loss: 11170.5518; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8783338.1667; val_optim_loss: 8783338.1667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9530; val_auprc_score: 0.9894; val_best_acc_score: 0.9426; val_best_f1_score: 0.9667; train_kl_reg_loss: 23595.7803; train_edge_recon_loss: 7694517.0465; train_gene_expr_recon_loss: 779705.8709; train_masked_gp_l1_reg_loss: 10794.0268; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8508612.7302; train_optim_loss: 8508612.7302; val_kl_reg_loss: 22480.7178; val_edge_recon_loss: 7825302.1875; val_gene_expr_recon_loss: 776516.8047; val_masked_gp_l1_reg_loss: 10504.5166; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8634804.5208; val_optim_loss: 8634804.5208
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9543; val_auprc_score: 0.9896; val_best_acc_score: 0.9416; val_best_f1_score: 0.9663; train_kl_reg_loss: 24162.9574; train_edge_recon_loss: 7710848.4395; train_gene_expr_recon_loss: 773557.8776; train_masked_gp_l1_reg_loss: 10159.2504; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8518728.4488; train_optim_loss: 8518728.4488; val_kl_reg_loss: 22670.0093; val_edge_recon_loss: 7905284.0417; val_gene_expr_recon_loss: 770679.1224; val_masked_gp_l1_reg_loss: 9917.6973; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8708551.0000; val_optim_loss: 8708551.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9546; val_auprc_score: 0.9903; val_best_acc_score: 0.9406; val_best_f1_score: 0.9658; train_kl_reg_loss: 22891.5265; train_edge_recon_loss: 7770853.3744; train_gene_expr_recon_loss: 768595.8523; train_masked_gp_l1_reg_loss: 9614.2605; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8571954.9767; train_optim_loss: 8571954.9767; val_kl_reg_loss: 23441.1886; val_edge_recon_loss: 7731343.3542; val_gene_expr_recon_loss: 765312.8854; val_masked_gp_l1_reg_loss: 9305.5703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8529403.2500; val_optim_loss: 8529403.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9534; val_auprc_score: 0.9890; val_best_acc_score: 0.9455; val_best_f1_score: 0.9686; train_kl_reg_loss: 23261.7101; train_edge_recon_loss: 7753988.7698; train_gene_expr_recon_loss: 763718.4099; train_masked_gp_l1_reg_loss: 9129.4419; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8550098.3535; train_optim_loss: 8550098.3535; val_kl_reg_loss: 25111.2607; val_edge_recon_loss: 7866523.7292; val_gene_expr_recon_loss: 761374.4609; val_masked_gp_l1_reg_loss: 8805.8389; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8661815.3750; val_optim_loss: 8661815.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9561; val_auprc_score: 0.9896; val_best_acc_score: 0.9422; val_best_f1_score: 0.9662; train_kl_reg_loss: 22841.0728; train_edge_recon_loss: 7696712.6837; train_gene_expr_recon_loss: 759153.0189; train_masked_gp_l1_reg_loss: 8731.7808; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8487438.5744; train_optim_loss: 8487438.5744; val_kl_reg_loss: 23486.8542; val_edge_recon_loss: 8108786.8958; val_gene_expr_recon_loss: 756537.6875; val_masked_gp_l1_reg_loss: 8513.2822; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8897324.6042; val_optim_loss: 8897324.6042
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9524; val_auprc_score: 0.9887; val_best_acc_score: 0.9452; val_best_f1_score: 0.9682; train_kl_reg_loss: 22744.3701; train_edge_recon_loss: 7653126.6116; train_gene_expr_recon_loss: 754384.1573; train_masked_gp_l1_reg_loss: 8351.5052; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8438606.6535; train_optim_loss: 8438606.6535; val_kl_reg_loss: 21601.8147; val_edge_recon_loss: 7863011.1250; val_gene_expr_recon_loss: 752176.5990; val_masked_gp_l1_reg_loss: 8199.8027; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8644989.4792; val_optim_loss: 8644989.4792
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9546; val_auprc_score: 0.9896; val_best_acc_score: 0.9422; val_best_f1_score: 0.9664; train_kl_reg_loss: 22932.1528; train_edge_recon_loss: 7646364.3860; train_gene_expr_recon_loss: 750669.9038; train_masked_gp_l1_reg_loss: 8032.5528; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8427998.9814; train_optim_loss: 8427998.9814; val_kl_reg_loss: 23894.9355; val_edge_recon_loss: 7853363.5625; val_gene_expr_recon_loss: 749204.3464; val_masked_gp_l1_reg_loss: 7822.4990; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8634285.0417; val_optim_loss: 8634285.0417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9602; val_auprc_score: 0.9901; val_best_acc_score: 0.9455; val_best_f1_score: 0.9683; train_kl_reg_loss: 23299.3534; train_edge_recon_loss: 7706139.4000; train_gene_expr_recon_loss: 746403.3564; train_masked_gp_l1_reg_loss: 7719.6148; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8483561.7023; train_optim_loss: 8483561.7023; val_kl_reg_loss: 21838.9591; val_edge_recon_loss: 7949100.8333; val_gene_expr_recon_loss: 746238.0599; val_masked_gp_l1_reg_loss: 7688.6499; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8724866.5833; val_optim_loss: 8724866.5833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9482; val_auprc_score: 0.9862; val_best_acc_score: 0.9438; val_best_f1_score: 0.9676; train_kl_reg_loss: 22017.9046; train_edge_recon_loss: 7725864.1488; train_gene_expr_recon_loss: 746216.1860; train_masked_gp_l1_reg_loss: 7700.2644; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8501798.5442; train_optim_loss: 8501798.5442; val_kl_reg_loss: 21531.4617; val_edge_recon_loss: 7744248.0000; val_gene_expr_recon_loss: 745753.5417; val_masked_gp_l1_reg_loss: 7714.1997; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8519247.0000; val_optim_loss: 8519247.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9582; val_auprc_score: 0.9901; val_best_acc_score: 0.9477; val_best_f1_score: 0.9697; train_kl_reg_loss: 21417.1201; train_edge_recon_loss: 7710378.7930; train_gene_expr_recon_loss: 749258.5227; train_masked_gp_l1_reg_loss: 7763.2847; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8488817.7279; train_optim_loss: 8488817.7279; val_kl_reg_loss: 14383.2801; val_edge_recon_loss: 7718094.7917; val_gene_expr_recon_loss: 748536.3724; val_masked_gp_l1_reg_loss: 7788.1221; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8488802.5417; val_optim_loss: 8488802.5417
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9618; val_auprc_score: 0.9913; val_best_acc_score: 0.9480; val_best_f1_score: 0.9698; train_kl_reg_loss: 20236.4676; train_edge_recon_loss: 7660556.5279; train_gene_expr_recon_loss: 748540.2346; train_masked_gp_l1_reg_loss: 7809.8424; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8437143.0767; train_optim_loss: 8437143.0767; val_kl_reg_loss: 13536.7913; val_edge_recon_loss: 7859825.5208; val_gene_expr_recon_loss: 748907.6146; val_masked_gp_l1_reg_loss: 7820.1611; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8630089.8750; val_optim_loss: 8630089.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9584; val_auprc_score: 0.9902; val_best_acc_score: 0.9463; val_best_f1_score: 0.9687; train_kl_reg_loss: 19393.5181; train_edge_recon_loss: 7738226.7256; train_gene_expr_recon_loss: 748225.9483; train_masked_gp_l1_reg_loss: 7841.1610; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8513687.3209; train_optim_loss: 8513687.3209; val_kl_reg_loss: 13430.0485; val_edge_recon_loss: 7961166.5833; val_gene_expr_recon_loss: 748478.1406; val_masked_gp_l1_reg_loss: 7829.7305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8730904.7292; val_optim_loss: 8730904.7292
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9608; val_auprc_score: 0.9915; val_best_acc_score: 0.9479; val_best_f1_score: 0.9698; train_kl_reg_loss: 19753.1288; train_edge_recon_loss: 7595977.1209; train_gene_expr_recon_loss: 747071.6177; train_masked_gp_l1_reg_loss: 7798.8465; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8370600.7000; train_optim_loss: 8370600.7000; val_kl_reg_loss: 13312.3400; val_edge_recon_loss: 7730653.7708; val_gene_expr_recon_loss: 746626.5130; val_masked_gp_l1_reg_loss: 7784.3916; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8498376.8750; val_optim_loss: 8498376.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9604; val_auprc_score: 0.9905; val_best_acc_score: 0.9480; val_best_f1_score: 0.9698; train_kl_reg_loss: 19048.1344; train_edge_recon_loss: 7709171.5047; train_gene_expr_recon_loss: 747180.2924; train_masked_gp_l1_reg_loss: 7788.0223; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8483187.9535; train_optim_loss: 8483187.9535; val_kl_reg_loss: 12800.3472; val_edge_recon_loss: 7872744.9375; val_gene_expr_recon_loss: 746900.8542; val_masked_gp_l1_reg_loss: 7795.3667; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8640241.3958; val_optim_loss: 8640241.3958

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9571; val_auprc_score: 0.9904; val_best_acc_score: 0.9471; val_best_f1_score: 0.9693; train_kl_reg_loss: 18692.8691; train_edge_recon_loss: 7669037.3674; train_gene_expr_recon_loss: 746989.3480; train_masked_gp_l1_reg_loss: 7790.3990; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8442509.9419; train_optim_loss: 8442509.9419; val_kl_reg_loss: 12779.1852; val_edge_recon_loss: 7748642.8750; val_gene_expr_recon_loss: 746484.4870; val_masked_gp_l1_reg_loss: 7789.2686; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8515695.7708; val_optim_loss: 8515695.7708
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9521; val_auprc_score: 0.9885; val_best_acc_score: 0.9467; val_best_f1_score: 0.9690; train_kl_reg_loss: 18663.3400; train_edge_recon_loss: 7590645.8814; train_gene_expr_recon_loss: 746450.5192; train_masked_gp_l1_reg_loss: 7788.5428; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8363548.2535; train_optim_loss: 8363548.2535; val_kl_reg_loss: 12719.3858; val_edge_recon_loss: 7909912.5208; val_gene_expr_recon_loss: 746843.3359; val_masked_gp_l1_reg_loss: 7787.7954; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8677263.3333; val_optim_loss: 8677263.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9616; val_auprc_score: 0.9904; val_best_acc_score: 0.9478; val_best_f1_score: 0.9696; train_kl_reg_loss: 18601.4439; train_edge_recon_loss: 7662144.9512; train_gene_expr_recon_loss: 746424.9953; train_masked_gp_l1_reg_loss: 7787.4185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8434958.8279; train_optim_loss: 8434958.8279; val_kl_reg_loss: 12652.0146; val_edge_recon_loss: 7874575.1250; val_gene_expr_recon_loss: 746705.0964; val_masked_gp_l1_reg_loss: 7787.1328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8641719.1875; val_optim_loss: 8641719.1875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9601; val_auprc_score: 0.9909; val_best_acc_score: 0.9496; val_best_f1_score: 0.9708; train_kl_reg_loss: 18513.4769; train_edge_recon_loss: 7635699.3000; train_gene_expr_recon_loss: 746363.2608; train_masked_gp_l1_reg_loss: 7786.8373; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8408362.8186; train_optim_loss: 8408362.8186; val_kl_reg_loss: 12544.3409; val_edge_recon_loss: 7612410.7500; val_gene_expr_recon_loss: 746580.7865; val_masked_gp_l1_reg_loss: 7786.2720; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8379322.1667; val_optim_loss: 8379322.1667
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9559; val_auprc_score: 0.9893; val_best_acc_score: 0.9459; val_best_f1_score: 0.9687; train_kl_reg_loss: 18313.6459; train_edge_recon_loss: 7763338.6512; train_gene_expr_recon_loss: 746444.4558; train_masked_gp_l1_reg_loss: 7787.2156; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8535884.0535; train_optim_loss: 8535884.0535; val_kl_reg_loss: 12408.4690; val_edge_recon_loss: 7880652.0000; val_gene_expr_recon_loss: 746206.3750; val_masked_gp_l1_reg_loss: 7788.2275; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8647054.8333; val_optim_loss: 8647054.8333
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9584; val_auprc_score: 0.9911; val_best_acc_score: 0.9467; val_best_f1_score: 0.9692; train_kl_reg_loss: 18160.4708; train_edge_recon_loss: 7583384.4651; train_gene_expr_recon_loss: 746326.1922; train_masked_gp_l1_reg_loss: 7788.2738; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8355659.3791; train_optim_loss: 8355659.3791; val_kl_reg_loss: 12392.6683; val_edge_recon_loss: 7694268.7083; val_gene_expr_recon_loss: 746337.0807; val_masked_gp_l1_reg_loss: 7787.8506; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8460786.5417; val_optim_loss: 8460786.5417
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9599; val_auprc_score: 0.9908; val_best_acc_score: 0.9473; val_best_f1_score: 0.9693; train_kl_reg_loss: 18142.1907; train_edge_recon_loss: 7602004.7535; train_gene_expr_recon_loss: 746320.4387; train_masked_gp_l1_reg_loss: 7786.5187; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8374253.9512; train_optim_loss: 8374253.9512; val_kl_reg_loss: 12374.9149; val_edge_recon_loss: 7914606.4792; val_gene_expr_recon_loss: 745905.2891; val_masked_gp_l1_reg_loss: 7784.2920; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8680670.8542; val_optim_loss: 8680670.8542
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9601; val_auprc_score: 0.9909; val_best_acc_score: 0.9500; val_best_f1_score: 0.9711; train_kl_reg_loss: 18070.7248; train_edge_recon_loss: 7654415.2791; train_gene_expr_recon_loss: 746128.9974; train_masked_gp_l1_reg_loss: 7780.6336; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8426395.6349; train_optim_loss: 8426395.6349; val_kl_reg_loss: 12275.1405; val_edge_recon_loss: 7632558.9167; val_gene_expr_recon_loss: 745717.1302; val_masked_gp_l1_reg_loss: 7777.2383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8398328.2083; val_optim_loss: 8398328.2083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9586; val_auprc_score: 0.9905; val_best_acc_score: 0.9469; val_best_f1_score: 0.9691; train_kl_reg_loss: 17978.5781; train_edge_recon_loss: 7689712.4512; train_gene_expr_recon_loss: 746100.1093; train_masked_gp_l1_reg_loss: 7776.2586; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8461567.4140; train_optim_loss: 8461567.4140; val_kl_reg_loss: 12252.3376; val_edge_recon_loss: 7866050.8333; val_gene_expr_recon_loss: 745515.8490; val_masked_gp_l1_reg_loss: 7775.8276; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8631595.0000; val_optim_loss: 8631595.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9550; val_auprc_score: 0.9892; val_best_acc_score: 0.9465; val_best_f1_score: 0.9689; train_kl_reg_loss: 17978.5542; train_edge_recon_loss: 7655022.4907; train_gene_expr_recon_loss: 745882.3483; train_masked_gp_l1_reg_loss: 7775.5150; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8426658.9163; train_optim_loss: 8426658.9163; val_kl_reg_loss: 12266.9716; val_edge_recon_loss: 7760423.2083; val_gene_expr_recon_loss: 745586.7370; val_masked_gp_l1_reg_loss: 7775.1465; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8526051.8958; val_optim_loss: 8526051.8958
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9553; val_auprc_score: 0.9900; val_best_acc_score: 0.9476; val_best_f1_score: 0.9699; train_kl_reg_loss: 17983.4736; train_edge_recon_loss: 7652891.7721; train_gene_expr_recon_loss: 745721.8073; train_masked_gp_l1_reg_loss: 7774.7930; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8424371.8953; train_optim_loss: 8424371.8953; val_kl_reg_loss: 12273.7239; val_edge_recon_loss: 7657065.0208; val_gene_expr_recon_loss: 745875.2214; val_masked_gp_l1_reg_loss: 7774.4102; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8422988.2292; val_optim_loss: 8422988.2292
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9545; val_auprc_score: 0.9891; val_best_acc_score: 0.9476; val_best_f1_score: 0.9697; train_kl_reg_loss: 17975.9109; train_edge_recon_loss: 7647574.7023; train_gene_expr_recon_loss: 745977.9718; train_masked_gp_l1_reg_loss: 7774.0042; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8419302.6163; train_optim_loss: 8419302.6163; val_kl_reg_loss: 12280.1958; val_edge_recon_loss: 7705038.4167; val_gene_expr_recon_loss: 746407.2292; val_masked_gp_l1_reg_loss: 7773.5996; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8471499.6250; val_optim_loss: 8471499.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 35 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9584
Val AUPRC score: 0.9903
Val best accuracy score: 0.9491
Val best F1 score: 0.9705
Val gene expr MSE score: 34126.8403
Val cat covariate0 mean sim diff: 0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
