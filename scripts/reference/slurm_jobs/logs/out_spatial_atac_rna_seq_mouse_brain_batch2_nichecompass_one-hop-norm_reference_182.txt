[True]
Run timestamp: 10102023_071606_182.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_182']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7784; val_auprc_score: 0.8037; val_best_acc_score: 0.5253; val_best_f1_score: 0.6757; train_kl_reg_loss: 70512.5591; train_edge_recon_loss: 752449.4571; train_gene_expr_recon_loss: 22431188.7939; train_masked_gp_l1_reg_loss: 110730.1665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2354411.9136; train_chrom_access_recon_loss: 2272093.2090; train_global_loss: 27991386.0611; train_optim_loss: 27991386.0611; val_kl_reg_loss: 69696.5922; val_edge_recon_loss: 812669.8917; val_gene_expr_recon_loss: 21186432.8000; val_masked_gp_l1_reg_loss: 93646.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 858230.1250; val_chrom_access_recon_loss: 2188969.9167; val_global_loss: 25209645.3333; val_optim_loss: 25209645.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8758; val_auprc_score: 0.8747; val_best_acc_score: 0.7952; val_best_f1_score: 0.7852; train_kl_reg_loss: 68835.5797; train_edge_recon_loss: 732023.4728; train_gene_expr_recon_loss: 20910844.7481; train_masked_gp_l1_reg_loss: 89320.6504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 460706.6069; train_chrom_access_recon_loss: 2161959.6050; train_global_loss: 24423690.5496; train_optim_loss: 24423690.5496; val_kl_reg_loss: 64479.5161; val_edge_recon_loss: 796294.5292; val_gene_expr_recon_loss: 20761139.6000; val_masked_gp_l1_reg_loss: 87692.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 259627.7031; val_chrom_access_recon_loss: 2149750.4500; val_global_loss: 24118983.8667; val_optim_loss: 24118983.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9047; val_auprc_score: 0.8930; val_best_acc_score: 0.8219; val_best_f1_score: 0.8340; train_kl_reg_loss: 61829.2758; train_edge_recon_loss: 708993.2223; train_gene_expr_recon_loss: 20588282.5954; train_masked_gp_l1_reg_loss: 88289.0194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201647.4715; train_chrom_access_recon_loss: 2134775.3960; train_global_loss: 23783816.8702; train_optim_loss: 23783816.8702; val_kl_reg_loss: 60848.7487; val_edge_recon_loss: 698682.0917; val_gene_expr_recon_loss: 20455298.5333; val_masked_gp_l1_reg_loss: 88957.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163449.0938; val_chrom_access_recon_loss: 2118515.7000; val_global_loss: 23585753.3333; val_optim_loss: 23585753.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9164; val_auprc_score: 0.9070; val_best_acc_score: 0.8358; val_best_f1_score: 0.8454; train_kl_reg_loss: 69149.5748; train_edge_recon_loss: 643375.6927; train_gene_expr_recon_loss: 20352588.9771; train_masked_gp_l1_reg_loss: 90030.1507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141210.7185; train_chrom_access_recon_loss: 2114066.3406; train_global_loss: 23410421.5878; train_optim_loss: 23410421.5878; val_kl_reg_loss: 67712.3779; val_edge_recon_loss: 630328.1000; val_gene_expr_recon_loss: 20259355.2000; val_masked_gp_l1_reg_loss: 91242.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125539.8750; val_chrom_access_recon_loss: 2100646.0417; val_global_loss: 23274823.3333; val_optim_loss: 23274823.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9196; val_auprc_score: 0.9107; val_best_acc_score: 0.8391; val_best_f1_score: 0.8474; train_kl_reg_loss: 69448.9581; train_edge_recon_loss: 623959.7987; train_gene_expr_recon_loss: 20174677.5573; train_masked_gp_l1_reg_loss: 91557.3349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114235.4048; train_chrom_access_recon_loss: 2095419.7366; train_global_loss: 23169298.8244; train_optim_loss: 23169298.8244; val_kl_reg_loss: 67394.4833; val_edge_recon_loss: 622054.7250; val_gene_expr_recon_loss: 19995853.4667; val_masked_gp_l1_reg_loss: 92138.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106441.2500; val_chrom_access_recon_loss: 2077591.5417; val_global_loss: 22961474.0000; val_optim_loss: 22961474.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9277; val_auprc_score: 0.9135; val_best_acc_score: 0.8558; val_best_f1_score: 0.8623; train_kl_reg_loss: 67770.3887; train_edge_recon_loss: 612924.4971; train_gene_expr_recon_loss: 20020175.0840; train_masked_gp_l1_reg_loss: 92525.0924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99543.1591; train_chrom_access_recon_loss: 2082584.4723; train_global_loss: 22975522.6565; train_optim_loss: 22975522.6565; val_kl_reg_loss: 65892.7398; val_edge_recon_loss: 611379.3333; val_gene_expr_recon_loss: 19956848.2667; val_masked_gp_l1_reg_loss: 92926.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93803.5703; val_chrom_access_recon_loss: 2080479.1500; val_global_loss: 22901329.6000; val_optim_loss: 22901329.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9347; val_auprc_score: 0.9236; val_best_acc_score: 0.8620; val_best_f1_score: 0.8685; train_kl_reg_loss: 66712.0716; train_edge_recon_loss: 606755.2152; train_gene_expr_recon_loss: 19882728.3969; train_masked_gp_l1_reg_loss: 93087.7421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90161.9627; train_chrom_access_recon_loss: 2068691.8884; train_global_loss: 22808137.3435; train_optim_loss: 22808137.3435; val_kl_reg_loss: 64576.2393; val_edge_recon_loss: 606983.5708; val_gene_expr_recon_loss: 19805918.9333; val_masked_gp_l1_reg_loss: 93550.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86789.8750; val_chrom_access_recon_loss: 2062533.9333; val_global_loss: 22720352.6667; val_optim_loss: 22720352.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9380; val_auprc_score: 0.9228; val_best_acc_score: 0.8698; val_best_f1_score: 0.8761; train_kl_reg_loss: 65638.2489; train_edge_recon_loss: 601409.7385; train_gene_expr_recon_loss: 19737188.1679; train_masked_gp_l1_reg_loss: 93733.7972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84113.9841; train_chrom_access_recon_loss: 2052418.3483; train_global_loss: 22634502.3969; train_optim_loss: 22634502.3969; val_kl_reg_loss: 63531.4164; val_edge_recon_loss: 603254.2708; val_gene_expr_recon_loss: 19690522.6667; val_masked_gp_l1_reg_loss: 93943.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81940.7969; val_chrom_access_recon_loss: 2049708.6667; val_global_loss: 22582901.2000; val_optim_loss: 22582901.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9473; val_auprc_score: 0.9381; val_best_acc_score: 0.8790; val_best_f1_score: 0.8844; train_kl_reg_loss: 64695.0198; train_edge_recon_loss: 596267.1360; train_gene_expr_recon_loss: 19633897.5115; train_masked_gp_l1_reg_loss: 94292.4566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80195.2634; train_chrom_access_recon_loss: 2044005.7853; train_global_loss: 22513353.2214; train_optim_loss: 22513353.2214; val_kl_reg_loss: 62567.7427; val_edge_recon_loss: 597049.6375; val_gene_expr_recon_loss: 19572233.2000; val_masked_gp_l1_reg_loss: 94790.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78455.8125; val_chrom_access_recon_loss: 2037227.0750; val_global_loss: 22442323.7333; val_optim_loss: 22442323.7333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9497; val_auprc_score: 0.9405; val_best_acc_score: 0.8839; val_best_f1_score: 0.8883; train_kl_reg_loss: 63529.0919; train_edge_recon_loss: 594319.5129; train_gene_expr_recon_loss: 19528055.6031; train_masked_gp_l1_reg_loss: 94776.3501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77152.9336; train_chrom_access_recon_loss: 2031217.5496; train_global_loss: 22389051.0840; train_optim_loss: 22389051.0840; val_kl_reg_loss: 63602.8305; val_edge_recon_loss: 593441.8542; val_gene_expr_recon_loss: 19556494.4000; val_masked_gp_l1_reg_loss: 95106.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76122.6250; val_chrom_access_recon_loss: 2035982.0167; val_global_loss: 22420749.2000; val_optim_loss: 22420749.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9534; val_auprc_score: 0.9426; val_best_acc_score: 0.8886; val_best_f1_score: 0.8929; train_kl_reg_loss: 63052.1546; train_edge_recon_loss: 590095.7037; train_gene_expr_recon_loss: 19447602.0763; train_masked_gp_l1_reg_loss: 95273.6864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74460.9098; train_chrom_access_recon_loss: 2023576.8550; train_global_loss: 22294061.4351; train_optim_loss: 22294061.4351; val_kl_reg_loss: 63689.3906; val_edge_recon_loss: 590400.3750; val_gene_expr_recon_loss: 19363118.2667; val_masked_gp_l1_reg_loss: 95551.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74454.5938; val_chrom_access_recon_loss: 2011520.3500; val_global_loss: 22198734.1333; val_optim_loss: 22198734.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9553; val_auprc_score: 0.9471; val_best_acc_score: 0.8909; val_best_f1_score: 0.8941; train_kl_reg_loss: 61810.9446; train_edge_recon_loss: 589255.6713; train_gene_expr_recon_loss: 19346899.2366; train_masked_gp_l1_reg_loss: 95756.2516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72581.4443; train_chrom_access_recon_loss: 2011437.8063; train_global_loss: 22177741.4046; train_optim_loss: 22177741.4046; val_kl_reg_loss: 60943.6307; val_edge_recon_loss: 590247.0958; val_gene_expr_recon_loss: 19297840.8000; val_masked_gp_l1_reg_loss: 96586.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73319.3047; val_chrom_access_recon_loss: 1999374.0083; val_global_loss: 22118311.6000; val_optim_loss: 22118311.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9606; val_auprc_score: 0.9531; val_best_acc_score: 0.9011; val_best_f1_score: 0.9031; train_kl_reg_loss: 61059.0463; train_edge_recon_loss: 588369.9828; train_gene_expr_recon_loss: 19288516.7634; train_masked_gp_l1_reg_loss: 96462.3893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71515.4504; train_chrom_access_recon_loss: 2004474.9771; train_global_loss: 22110398.5496; train_optim_loss: 22110398.5496; val_kl_reg_loss: 61049.2763; val_edge_recon_loss: 587302.6917; val_gene_expr_recon_loss: 19208098.2667; val_masked_gp_l1_reg_loss: 96537.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70656.6250; val_chrom_access_recon_loss: 1999684.8500; val_global_loss: 22023329.2000; val_optim_loss: 22023329.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9625; val_auprc_score: 0.9541; val_best_acc_score: 0.9042; val_best_f1_score: 0.9081; train_kl_reg_loss: 60843.3529; train_edge_recon_loss: 585590.7242; train_gene_expr_recon_loss: 19209802.0916; train_masked_gp_l1_reg_loss: 96740.9315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70388.8178; train_chrom_access_recon_loss: 1996128.4074; train_global_loss: 22019494.3969; train_optim_loss: 22019494.3969; val_kl_reg_loss: 60818.4331; val_edge_recon_loss: 584989.6250; val_gene_expr_recon_loss: 19136945.8667; val_masked_gp_l1_reg_loss: 96920.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70400.5859; val_chrom_access_recon_loss: 1991493.2917; val_global_loss: 21941567.2000; val_optim_loss: 21941567.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9634; val_auprc_score: 0.9536; val_best_acc_score: 0.9077; val_best_f1_score: 0.9098; train_kl_reg_loss: 60092.3786; train_edge_recon_loss: 584004.8774; train_gene_expr_recon_loss: 19151361.2061; train_masked_gp_l1_reg_loss: 97220.2324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70119.6969; train_chrom_access_recon_loss: 1990526.3302; train_global_loss: 21953324.7176; train_optim_loss: 21953324.7176; val_kl_reg_loss: 59940.0656; val_edge_recon_loss: 584071.5792; val_gene_expr_recon_loss: 19082947.7333; val_masked_gp_l1_reg_loss: 97376.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70057.7109; val_chrom_access_recon_loss: 1985312.8250; val_global_loss: 21879706.0000; val_optim_loss: 21879706.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9629; val_auprc_score: 0.9540; val_best_acc_score: 0.9058; val_best_f1_score: 0.9093; train_kl_reg_loss: 59851.8483; train_edge_recon_loss: 582300.9656; train_gene_expr_recon_loss: 19102381.5878; train_masked_gp_l1_reg_loss: 97497.6854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69474.9257; train_chrom_access_recon_loss: 1984537.5076; train_global_loss: 21896044.5802; train_optim_loss: 21896044.5802; val_kl_reg_loss: 58122.2672; val_edge_recon_loss: 581880.1042; val_gene_expr_recon_loss: 19123407.2000; val_masked_gp_l1_reg_loss: 98081.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69730.5938; val_chrom_access_recon_loss: 1974660.4083; val_global_loss: 21905882.4000; val_optim_loss: 21905882.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9622; val_auprc_score: 0.9536; val_best_acc_score: 0.9076; val_best_f1_score: 0.9102; train_kl_reg_loss: 59056.0995; train_edge_recon_loss: 581681.8927; train_gene_expr_recon_loss: 19053277.1298; train_masked_gp_l1_reg_loss: 98109.5802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69251.8235; train_chrom_access_recon_loss: 1979883.5353; train_global_loss: 21841260.1221; train_optim_loss: 21841260.1221; val_kl_reg_loss: 58279.3193; val_edge_recon_loss: 584207.8750; val_gene_expr_recon_loss: 18982661.8667; val_masked_gp_l1_reg_loss: 98693.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69942.9375; val_chrom_access_recon_loss: 1968994.4833; val_global_loss: 21762779.3333; val_optim_loss: 21762779.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9652; val_auprc_score: 0.9558; val_best_acc_score: 0.9116; val_best_f1_score: 0.9147; train_kl_reg_loss: 58576.8439; train_edge_recon_loss: 580798.0358; train_gene_expr_recon_loss: 18982204.8550; train_masked_gp_l1_reg_loss: 98703.6566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68874.6728; train_chrom_access_recon_loss: 1972267.4275; train_global_loss: 21761425.5115; train_optim_loss: 21761425.5115; val_kl_reg_loss: 57831.0185; val_edge_recon_loss: 581258.0333; val_gene_expr_recon_loss: 18984134.2667; val_masked_gp_l1_reg_loss: 99304.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69427.0781; val_chrom_access_recon_loss: 1974493.3167; val_global_loss: 21766448.4000; val_optim_loss: 21766448.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9657; val_auprc_score: 0.9556; val_best_acc_score: 0.9115; val_best_f1_score: 0.9152; train_kl_reg_loss: 57912.5519; train_edge_recon_loss: 581391.3674; train_gene_expr_recon_loss: 18951358.2443; train_masked_gp_l1_reg_loss: 99444.8141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68621.8455; train_chrom_access_recon_loss: 1967532.4981; train_global_loss: 21726261.4351; train_optim_loss: 21726261.4351; val_kl_reg_loss: 56660.6977; val_edge_recon_loss: 580462.6792; val_gene_expr_recon_loss: 18916342.0000; val_masked_gp_l1_reg_loss: 100304.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69353.3906; val_chrom_access_recon_loss: 1955630.9333; val_global_loss: 21678754.5333; val_optim_loss: 21678754.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9652; val_auprc_score: 0.9570; val_best_acc_score: 0.9100; val_best_f1_score: 0.9130; train_kl_reg_loss: 57362.9283; train_edge_recon_loss: 581615.3025; train_gene_expr_recon_loss: 18888193.0229; train_masked_gp_l1_reg_loss: 100399.4611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68487.0137; train_chrom_access_recon_loss: 1962154.6870; train_global_loss: 21658212.4733; train_optim_loss: 21658212.4733; val_kl_reg_loss: 57333.5727; val_edge_recon_loss: 583219.3708; val_gene_expr_recon_loss: 18891230.4000; val_masked_gp_l1_reg_loss: 100938.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68672.4062; val_chrom_access_recon_loss: 1956042.3833; val_global_loss: 21657435.8667; val_optim_loss: 21657435.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9612; val_auprc_score: 0.9504; val_best_acc_score: 0.9115; val_best_f1_score: 0.9157; train_kl_reg_loss: 56684.6250; train_edge_recon_loss: 581964.8869; train_gene_expr_recon_loss: 18833278.9771; train_masked_gp_l1_reg_loss: 101302.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68707.4582; train_chrom_access_recon_loss: 1957709.2242; train_global_loss: 21599647.3282; train_optim_loss: 21599647.3282; val_kl_reg_loss: 56636.6948; val_edge_recon_loss: 583804.9208; val_gene_expr_recon_loss: 18968332.6667; val_masked_gp_l1_reg_loss: 101776.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68268.0781; val_chrom_access_recon_loss: 1979777.0667; val_global_loss: 21758595.2000; val_optim_loss: 21758595.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9637; val_auprc_score: 0.9531; val_best_acc_score: 0.9100; val_best_f1_score: 0.9124; train_kl_reg_loss: 56426.8897; train_edge_recon_loss: 579340.7223; train_gene_expr_recon_loss: 18791990.3664; train_masked_gp_l1_reg_loss: 102324.8344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68382.3465; train_chrom_access_recon_loss: 1954533.0973; train_global_loss: 21552998.0305; train_optim_loss: 21552998.0305; val_kl_reg_loss: 57101.7727; val_edge_recon_loss: 581082.9292; val_gene_expr_recon_loss: 18842975.7333; val_masked_gp_l1_reg_loss: 103077.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68781.2969; val_chrom_access_recon_loss: 1947933.3333; val_global_loss: 21600952.8000; val_optim_loss: 21600952.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9650; val_auprc_score: 0.9537; val_best_acc_score: 0.9166; val_best_f1_score: 0.9192; train_kl_reg_loss: 56250.0636; train_edge_recon_loss: 578783.5124; train_gene_expr_recon_loss: 18749023.2977; train_masked_gp_l1_reg_loss: 103562.1714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68735.0858; train_chrom_access_recon_loss: 1949360.3817; train_global_loss: 21505714.5038; train_optim_loss: 21505714.5038; val_kl_reg_loss: 56105.3130; val_edge_recon_loss: 580971.4500; val_gene_expr_recon_loss: 18756804.9333; val_masked_gp_l1_reg_loss: 104041.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68404.6797; val_chrom_access_recon_loss: 1950971.4250; val_global_loss: 21517299.4667; val_optim_loss: 21517299.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9671; val_auprc_score: 0.9553; val_best_acc_score: 0.9198; val_best_f1_score: 0.9228; train_kl_reg_loss: 55709.8994; train_edge_recon_loss: 578284.0811; train_gene_expr_recon_loss: 18685021.7405; train_masked_gp_l1_reg_loss: 104891.8572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68563.4050; train_chrom_access_recon_loss: 1947735.8006; train_global_loss: 21440206.8397; train_optim_loss: 21440206.8397; val_kl_reg_loss: 55381.9146; val_edge_recon_loss: 577758.9000; val_gene_expr_recon_loss: 18723738.0000; val_masked_gp_l1_reg_loss: 105713.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69555.2266; val_chrom_access_recon_loss: 1946301.8083; val_global_loss: 21478450.9333; val_optim_loss: 21478450.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9657; val_auprc_score: 0.9552; val_best_acc_score: 0.9166; val_best_f1_score: 0.9186; train_kl_reg_loss: 55363.9007; train_edge_recon_loss: 577314.9690; train_gene_expr_recon_loss: 18636684.4733; train_masked_gp_l1_reg_loss: 106209.2451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68881.8771; train_chrom_access_recon_loss: 1944907.4284; train_global_loss: 21389361.8626; train_optim_loss: 21389361.8626; val_kl_reg_loss: 55460.6815; val_edge_recon_loss: 579770.0708; val_gene_expr_recon_loss: 18710437.3333; val_masked_gp_l1_reg_loss: 107161.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69526.9453; val_chrom_access_recon_loss: 1949671.1917; val_global_loss: 21472027.6000; val_optim_loss: 21472027.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9694; val_auprc_score: 0.9613; val_best_acc_score: 0.9196; val_best_f1_score: 0.9218; train_kl_reg_loss: 54815.5942; train_edge_recon_loss: 576844.8449; train_gene_expr_recon_loss: 18588110.0763; train_masked_gp_l1_reg_loss: 107672.9870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69245.3262; train_chrom_access_recon_loss: 1941193.3130; train_global_loss: 21337882.0916; train_optim_loss: 21337882.0916; val_kl_reg_loss: 55638.8612; val_edge_recon_loss: 578375.2250; val_gene_expr_recon_loss: 18772254.1333; val_masked_gp_l1_reg_loss: 108425.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69989.5156; val_chrom_access_recon_loss: 1958821.2833; val_global_loss: 21543505.6000; val_optim_loss: 21543505.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9572; val_best_acc_score: 0.9135; val_best_f1_score: 0.9164; train_kl_reg_loss: 54957.2211; train_edge_recon_loss: 575725.3187; train_gene_expr_recon_loss: 18531498.5038; train_masked_gp_l1_reg_loss: 108933.2428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69481.3710; train_chrom_access_recon_loss: 1938830.3531; train_global_loss: 21279426.0763; train_optim_loss: 21279426.0763; val_kl_reg_loss: 54328.5857; val_edge_recon_loss: 577370.8583; val_gene_expr_recon_loss: 18607183.7333; val_masked_gp_l1_reg_loss: 109689.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69933.2188; val_chrom_access_recon_loss: 1936074.9667; val_global_loss: 21354582.0000; val_optim_loss: 21354582.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9651; val_auprc_score: 0.9539; val_best_acc_score: 0.9154; val_best_f1_score: 0.9171; train_kl_reg_loss: 54749.2184; train_edge_recon_loss: 575567.6789; train_gene_expr_recon_loss: 18496371.2977; train_masked_gp_l1_reg_loss: 110205.0074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69985.6581; train_chrom_access_recon_loss: 1938045.8578; train_global_loss: 21244924.6870; train_optim_loss: 21244924.6870; val_kl_reg_loss: 53670.4826; val_edge_recon_loss: 579282.3042; val_gene_expr_recon_loss: 18536450.4000; val_masked_gp_l1_reg_loss: 110676.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70241.2500; val_chrom_access_recon_loss: 1935863.0667; val_global_loss: 21286184.4000; val_optim_loss: 21286184.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9695; val_auprc_score: 0.9603; val_best_acc_score: 0.9236; val_best_f1_score: 0.9260; train_kl_reg_loss: 54484.4125; train_edge_recon_loss: 574917.6150; train_gene_expr_recon_loss: 18429442.3817; train_masked_gp_l1_reg_loss: 111431.3207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70212.8417; train_chrom_access_recon_loss: 1934572.3874; train_global_loss: 21175061.0382; train_optim_loss: 21175061.0382; val_kl_reg_loss: 53959.7919; val_edge_recon_loss: 577593.6000; val_gene_expr_recon_loss: 18512952.2667; val_masked_gp_l1_reg_loss: 111939.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70223.1094; val_chrom_access_recon_loss: 1935036.9833; val_global_loss: 21261706.8000; val_optim_loss: 21261706.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9673; val_auprc_score: 0.9581; val_best_acc_score: 0.9177; val_best_f1_score: 0.9207; train_kl_reg_loss: 54830.3780; train_edge_recon_loss: 574243.1541; train_gene_expr_recon_loss: 18370839.1756; train_masked_gp_l1_reg_loss: 112617.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70422.6205; train_chrom_access_recon_loss: 1930340.8626; train_global_loss: 21113294.0611; train_optim_loss: 21113294.0611; val_kl_reg_loss: 53025.0487; val_edge_recon_loss: 578310.3250; val_gene_expr_recon_loss: 18462908.6667; val_masked_gp_l1_reg_loss: 113053.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70524.2500; val_chrom_access_recon_loss: 1918839.7917; val_global_loss: 21196662.0000; val_optim_loss: 21196662.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9666; val_auprc_score: 0.9504; val_best_acc_score: 0.9188; val_best_f1_score: 0.9221; train_kl_reg_loss: 54621.8013; train_edge_recon_loss: 575070.9575; train_gene_expr_recon_loss: 18352353.1908; train_masked_gp_l1_reg_loss: 113507.3162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71020.0372; train_chrom_access_recon_loss: 1930095.0219; train_global_loss: 21096668.3817; train_optim_loss: 21096668.3817; val_kl_reg_loss: 53702.2555; val_edge_recon_loss: 575111.0458; val_gene_expr_recon_loss: 18529080.5333; val_masked_gp_l1_reg_loss: 113987.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70956.4219; val_chrom_access_recon_loss: 1937053.9000; val_global_loss: 21279891.7333; val_optim_loss: 21279891.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9682; val_auprc_score: 0.9563; val_best_acc_score: 0.9190; val_best_f1_score: 0.9213; train_kl_reg_loss: 54753.7442; train_edge_recon_loss: 575200.6193; train_gene_expr_recon_loss: 18283785.7557; train_masked_gp_l1_reg_loss: 114369.3989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71227.6050; train_chrom_access_recon_loss: 1925952.0000; train_global_loss: 21025289.2061; train_optim_loss: 21025289.2061; val_kl_reg_loss: 55346.5115; val_edge_recon_loss: 582449.2708; val_gene_expr_recon_loss: 18475532.8000; val_masked_gp_l1_reg_loss: 114573.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71768.6250; val_chrom_access_recon_loss: 1928717.5583; val_global_loss: 21228388.2667; val_optim_loss: 21228388.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9655; val_auprc_score: 0.9519; val_best_acc_score: 0.9146; val_best_f1_score: 0.9165; train_kl_reg_loss: 54886.4450; train_edge_recon_loss: 575377.4637; train_gene_expr_recon_loss: 18263041.0076; train_masked_gp_l1_reg_loss: 114837.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71631.5740; train_chrom_access_recon_loss: 1926918.7595; train_global_loss: 21006692.9618; train_optim_loss: 21006692.9618; val_kl_reg_loss: 54762.9138; val_edge_recon_loss: 580150.1875; val_gene_expr_recon_loss: 18469278.9333; val_masked_gp_l1_reg_loss: 115382.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72321.3125; val_chrom_access_recon_loss: 1924374.6250; val_global_loss: 21216271.0667; val_optim_loss: 21216271.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9684; val_auprc_score: 0.9585; val_best_acc_score: 0.9217; val_best_f1_score: 0.9241; train_kl_reg_loss: 55117.8331; train_edge_recon_loss: 575005.2920; train_gene_expr_recon_loss: 18213873.9389; train_masked_gp_l1_reg_loss: 115397.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71991.3702; train_chrom_access_recon_loss: 1925332.4370; train_global_loss: 20956717.9542; train_optim_loss: 20956717.9542; val_kl_reg_loss: 54391.7081; val_edge_recon_loss: 575724.5000; val_gene_expr_recon_loss: 18361717.0667; val_masked_gp_l1_reg_loss: 115493.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72733.8125; val_chrom_access_recon_loss: 1925027.1417; val_global_loss: 21105088.1333; val_optim_loss: 21105088.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9667; val_auprc_score: 0.9549; val_best_acc_score: 0.9161; val_best_f1_score: 0.9196; train_kl_reg_loss: 55435.0588; train_edge_recon_loss: 574708.7481; train_gene_expr_recon_loss: 18175393.3130; train_masked_gp_l1_reg_loss: 115868.4497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72221.0817; train_chrom_access_recon_loss: 1920900.1718; train_global_loss: 20914526.8397; train_optim_loss: 20914526.8397; val_kl_reg_loss: 55149.6289; val_edge_recon_loss: 580820.5125; val_gene_expr_recon_loss: 18395125.7333; val_masked_gp_l1_reg_loss: 116055.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72773.5859; val_chrom_access_recon_loss: 1922107.4167; val_global_loss: 21142033.4667; val_optim_loss: 21142033.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9684; val_auprc_score: 0.9591; val_best_acc_score: 0.9194; val_best_f1_score: 0.9223; train_kl_reg_loss: 55548.0780; train_edge_recon_loss: 576412.7929; train_gene_expr_recon_loss: 18144906.7481; train_masked_gp_l1_reg_loss: 116173.1319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73030.1902; train_chrom_access_recon_loss: 1921766.7901; train_global_loss: 20887837.6794; train_optim_loss: 20887837.6794; val_kl_reg_loss: 55857.8094; val_edge_recon_loss: 577788.2875; val_gene_expr_recon_loss: 18326546.4000; val_masked_gp_l1_reg_loss: 116393.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72347.7344; val_chrom_access_recon_loss: 1929941.0333; val_global_loss: 21078875.7333; val_optim_loss: 21078875.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9699; val_auprc_score: 0.9619; val_best_acc_score: 0.9228; val_best_f1_score: 0.9246; train_kl_reg_loss: 56081.0678; train_edge_recon_loss: 574666.3311; train_gene_expr_recon_loss: 18104718.3053; train_masked_gp_l1_reg_loss: 116451.7869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73149.3951; train_chrom_access_recon_loss: 1919050.4542; train_global_loss: 20844117.3435; train_optim_loss: 20844117.3435; val_kl_reg_loss: 55192.3958; val_edge_recon_loss: 582118.0375; val_gene_expr_recon_loss: 18347391.0000; val_masked_gp_l1_reg_loss: 116603.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73722.6172; val_chrom_access_recon_loss: 1932261.4667; val_global_loss: 21107288.8000; val_optim_loss: 21107288.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9668; val_auprc_score: 0.9587; val_best_acc_score: 0.9105; val_best_f1_score: 0.9140; train_kl_reg_loss: 56199.9646; train_edge_recon_loss: 574498.7882; train_gene_expr_recon_loss: 18074050.7481; train_masked_gp_l1_reg_loss: 117016.6562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73656.5775; train_chrom_access_recon_loss: 1919554.3969; train_global_loss: 20814977.1450; train_optim_loss: 20814977.1450; val_kl_reg_loss: 56593.5570; val_edge_recon_loss: 583342.9292; val_gene_expr_recon_loss: 18339820.2667; val_masked_gp_l1_reg_loss: 117297.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74137.5859; val_chrom_access_recon_loss: 1926946.5917; val_global_loss: 21098139.3333; val_optim_loss: 21098139.3333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9683; val_auprc_score: 0.9561; val_best_acc_score: 0.9212; val_best_f1_score: 0.9238; train_kl_reg_loss: 56957.2221; train_edge_recon_loss: 575235.2552; train_gene_expr_recon_loss: 18057315.8473; train_masked_gp_l1_reg_loss: 116975.9565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74169.4167; train_chrom_access_recon_loss: 1916859.1899; train_global_loss: 20797512.9313; train_optim_loss: 20797512.9313; val_kl_reg_loss: 56832.6404; val_edge_recon_loss: 576573.7417; val_gene_expr_recon_loss: 18285544.5333; val_masked_gp_l1_reg_loss: 116840.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74303.5859; val_chrom_access_recon_loss: 1925969.0583; val_global_loss: 21036063.8667; val_optim_loss: 21036063.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9701; val_auprc_score: 0.9602; val_best_acc_score: 0.9221; val_best_f1_score: 0.9254; train_kl_reg_loss: 57386.3635; train_edge_recon_loss: 576457.7085; train_gene_expr_recon_loss: 18024207.7939; train_masked_gp_l1_reg_loss: 116896.8178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74383.9331; train_chrom_access_recon_loss: 1915824.0086; train_global_loss: 20765156.5191; train_optim_loss: 20765156.5191; val_kl_reg_loss: 57454.3758; val_edge_recon_loss: 578165.7750; val_gene_expr_recon_loss: 18202815.6000; val_masked_gp_l1_reg_loss: 116897.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75987.8594; val_chrom_access_recon_loss: 1918372.4167; val_global_loss: 20949694.2667; val_optim_loss: 20949694.2667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9699; val_auprc_score: 0.9629; val_best_acc_score: 0.9177; val_best_f1_score: 0.9202; train_kl_reg_loss: 57311.3977; train_edge_recon_loss: 578503.3344; train_gene_expr_recon_loss: 18007494.0840; train_masked_gp_l1_reg_loss: 116881.6873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75424.5596; train_chrom_access_recon_loss: 1912143.3139; train_global_loss: 20747758.5038; train_optim_loss: 20747758.5038; val_kl_reg_loss: 57660.0016; val_edge_recon_loss: 581720.6875; val_gene_expr_recon_loss: 18337478.2667; val_masked_gp_l1_reg_loss: 116519.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74740.8203; val_chrom_access_recon_loss: 1923379.0167; val_global_loss: 21091497.7333; val_optim_loss: 21091497.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9665; val_auprc_score: 0.9552; val_best_acc_score: 0.9186; val_best_f1_score: 0.9212; train_kl_reg_loss: 57783.2043; train_edge_recon_loss: 578686.1326; train_gene_expr_recon_loss: 18064390.8397; train_masked_gp_l1_reg_loss: 116846.7244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76744.7925; train_chrom_access_recon_loss: 1919644.2252; train_global_loss: 20814095.9237; train_optim_loss: 20814095.9237; val_kl_reg_loss: 58119.2898; val_edge_recon_loss: 582325.4500; val_gene_expr_recon_loss: 18216576.8000; val_masked_gp_l1_reg_loss: 115632.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76399.1797; val_chrom_access_recon_loss: 1910125.5667; val_global_loss: 20959178.9333; val_optim_loss: 20959178.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9659; val_auprc_score: 0.9553; val_best_acc_score: 0.9155; val_best_f1_score: 0.9185; train_kl_reg_loss: 58698.6239; train_edge_recon_loss: 577332.8368; train_gene_expr_recon_loss: 18020305.8626; train_masked_gp_l1_reg_loss: 117071.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77162.6194; train_chrom_access_recon_loss: 1914521.9466; train_global_loss: 20765093.4809; train_optim_loss: 20765093.4809; val_kl_reg_loss: 58701.2044; val_edge_recon_loss: 583442.4375; val_gene_expr_recon_loss: 18266015.7333; val_masked_gp_l1_reg_loss: 115832.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76210.3516; val_chrom_access_recon_loss: 1920381.2917; val_global_loss: 21020582.5333; val_optim_loss: 21020582.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9159; val_auprc_score: 0.9115; val_best_acc_score: 0.8320; val_best_f1_score: 0.8470; train_kl_reg_loss: 135247842.3944; train_edge_recon_loss: 610536.3554; train_gene_expr_recon_loss: 19176250.9160; train_masked_gp_l1_reg_loss: 122655.7472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97394.0361; train_chrom_access_recon_loss: 2022721.4838; train_global_loss: 157277395.8473; train_optim_loss: 157277395.8473; val_kl_reg_loss: 176248758.1344; val_edge_recon_loss: 766757.6500; val_gene_expr_recon_loss: 27851574.1333; val_masked_gp_l1_reg_loss: 152928.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180891.4375; val_chrom_access_recon_loss: 2306244.7083; val_global_loss: 207507155.7333; val_optim_loss: 207507155.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9224; val_auprc_score: 0.9196; val_best_acc_score: 0.8371; val_best_f1_score: 0.8473; train_kl_reg_loss: 3187917.4200; train_edge_recon_loss: 753964.6135; train_gene_expr_recon_loss: 19912921.0840; train_masked_gp_l1_reg_loss: 145648.8226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122460.6848; train_chrom_access_recon_loss: 2034913.9017; train_global_loss: 26157826.4122; train_optim_loss: 26157826.4122; val_kl_reg_loss: 130070.8870; val_edge_recon_loss: 745611.0750; val_gene_expr_recon_loss: 19266733.0667; val_masked_gp_l1_reg_loss: 135963.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86233.9609; val_chrom_access_recon_loss: 1966063.6667; val_global_loss: 22330676.9333; val_optim_loss: 22330676.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9342; val_auprc_score: 0.9272; val_best_acc_score: 0.8588; val_best_f1_score: 0.8637; train_kl_reg_loss: 144782.3312; train_edge_recon_loss: 737612.4122; train_gene_expr_recon_loss: 19229712.1069; train_masked_gp_l1_reg_loss: 129913.7057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79258.4973; train_chrom_access_recon_loss: 1961325.2281; train_global_loss: 22282604.1374; train_optim_loss: 22282604.1374; val_kl_reg_loss: 128198.1823; val_edge_recon_loss: 735468.5958; val_gene_expr_recon_loss: 19263265.6000; val_masked_gp_l1_reg_loss: 124892.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74658.7266; val_chrom_access_recon_loss: 1950858.3417; val_global_loss: 22277340.1333; val_optim_loss: 22277340.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9335; val_auprc_score: 0.9253; val_best_acc_score: 0.8604; val_best_f1_score: 0.8668; train_kl_reg_loss: 121071.7853; train_edge_recon_loss: 722459.3383; train_gene_expr_recon_loss: 19052897.6183; train_masked_gp_l1_reg_loss: 121479.7959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71459.3675; train_chrom_access_recon_loss: 1951659.9761; train_global_loss: 22041027.8321; train_optim_loss: 22041027.8321; val_kl_reg_loss: 114298.7375; val_edge_recon_loss: 720709.0167; val_gene_expr_recon_loss: 19004208.0000; val_masked_gp_l1_reg_loss: 118500.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69124.3047; val_chrom_access_recon_loss: 1942914.8250; val_global_loss: 21969754.8000; val_optim_loss: 21969754.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9350; val_auprc_score: 0.9233; val_best_acc_score: 0.8579; val_best_f1_score: 0.8655; train_kl_reg_loss: 108410.5639; train_edge_recon_loss: 705311.4280; train_gene_expr_recon_loss: 18980116.0916; train_masked_gp_l1_reg_loss: 116038.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67111.4255; train_chrom_access_recon_loss: 1943226.6574; train_global_loss: 21920215.1298; train_optim_loss: 21920215.1298; val_kl_reg_loss: 102446.0547; val_edge_recon_loss: 702785.3833; val_gene_expr_recon_loss: 18926484.8000; val_masked_gp_l1_reg_loss: 113698.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65354.8750; val_chrom_access_recon_loss: 1938122.3333; val_global_loss: 21848890.6667; val_optim_loss: 21848890.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 50 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9692
val AUPRC score: 0.9598
val best accuracy score: 0.9209
val best F1 score: 0.9242
val target rna MSE score: 1.2133
val source rna MSE score: 0.4098
val target atac MSE score: 0.3374
val source atac MSE score: 0.1030
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
