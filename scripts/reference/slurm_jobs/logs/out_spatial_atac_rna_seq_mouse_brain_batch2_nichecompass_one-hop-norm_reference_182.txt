[True]
Run timestamp: 08082023_073154_182.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_182']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6778; val_auprc_score: 0.7121; val_best_acc_score: 0.5294; val_best_f1_score: 0.6749; train_kl_reg_loss: 15051.0907; train_edge_recon_loss: 37673.2974; train_gene_expr_recon_loss: 841452.3248; train_masked_gp_l1_reg_loss: 6517.6292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105103.5043; train_chrom_access_recon_loss: 484501.9015; train_global_loss: 1490299.7443; train_optim_loss: 1490299.7443; val_kl_reg_loss: 20219.5540; val_edge_recon_loss: 40631.0532; val_gene_expr_recon_loss: 699377.4062; val_masked_gp_l1_reg_loss: 6412.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85867.9531; val_chrom_access_recon_loss: 455300.8203; val_global_loss: 1307809.6562; val_optim_loss: 1307809.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7483; val_auprc_score: 0.7723; val_best_acc_score: 0.6027; val_best_f1_score: 0.6987; train_kl_reg_loss: 20562.6621; train_edge_recon_loss: 38907.1573; train_gene_expr_recon_loss: 679038.5814; train_masked_gp_l1_reg_loss: 6426.9741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67613.2460; train_chrom_access_recon_loss: 449313.6364; train_global_loss: 1261862.2519; train_optim_loss: 1261862.2519; val_kl_reg_loss: 20038.2502; val_edge_recon_loss: 40582.2397; val_gene_expr_recon_loss: 663163.8750; val_masked_gp_l1_reg_loss: 6446.1060; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51147.0117; val_chrom_access_recon_loss: 445101.8789; val_global_loss: 1226479.3594; val_optim_loss: 1226479.3594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8455; val_auprc_score: 0.8483; val_best_acc_score: 0.7591; val_best_f1_score: 0.7633; train_kl_reg_loss: 19022.4295; train_edge_recon_loss: 38850.1519; train_gene_expr_recon_loss: 660502.2538; train_masked_gp_l1_reg_loss: 6463.7829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40129.9738; train_chrom_access_recon_loss: 442974.0743; train_global_loss: 1207942.6572; train_optim_loss: 1207942.6572; val_kl_reg_loss: 18128.0308; val_edge_recon_loss: 40342.0195; val_gene_expr_recon_loss: 647142.4375; val_masked_gp_l1_reg_loss: 6503.2129; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31017.7695; val_chrom_access_recon_loss: 441403.3242; val_global_loss: 1184536.7656; val_optim_loss: 1184536.7656
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8952; val_auprc_score: 0.8924; val_best_acc_score: 0.7920; val_best_f1_score: 0.7646; train_kl_reg_loss: 17242.6387; train_edge_recon_loss: 38523.9545; train_gene_expr_recon_loss: 652311.5019; train_masked_gp_l1_reg_loss: 6545.0172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25347.1987; train_chrom_access_recon_loss: 439697.6241; train_global_loss: 1179667.9318; train_optim_loss: 1179667.9318; val_kl_reg_loss: 16256.9590; val_edge_recon_loss: 40098.2148; val_gene_expr_recon_loss: 639405.3906; val_masked_gp_l1_reg_loss: 6569.5112; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20569.6289; val_chrom_access_recon_loss: 435620.9492; val_global_loss: 1158520.6406; val_optim_loss: 1158520.6406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9182; val_auprc_score: 0.9118; val_best_acc_score: 0.7979; val_best_f1_score: 0.8266; train_kl_reg_loss: 15920.7408; train_edge_recon_loss: 38175.0052; train_gene_expr_recon_loss: 645708.1051; train_masked_gp_l1_reg_loss: 6611.2481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17450.8935; train_chrom_access_recon_loss: 435979.1378; train_global_loss: 1159845.1193; train_optim_loss: 1159845.1193; val_kl_reg_loss: 15127.6616; val_edge_recon_loss: 39718.2559; val_gene_expr_recon_loss: 637803.2422; val_masked_gp_l1_reg_loss: 6652.4321; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14763.2637; val_chrom_access_recon_loss: 436028.4648; val_global_loss: 1150093.3125; val_optim_loss: 1150093.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9258; val_auprc_score: 0.9189; val_best_acc_score: 0.8358; val_best_f1_score: 0.8513; train_kl_reg_loss: 15050.6873; train_edge_recon_loss: 37840.9579; train_gene_expr_recon_loss: 640062.6951; train_masked_gp_l1_reg_loss: 6694.1330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12879.7627; train_chrom_access_recon_loss: 432443.8082; train_global_loss: 1144972.0379; train_optim_loss: 1144972.0379; val_kl_reg_loss: 14682.1978; val_edge_recon_loss: 39360.6841; val_gene_expr_recon_loss: 624663.2031; val_masked_gp_l1_reg_loss: 6730.4668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11236.7432; val_chrom_access_recon_loss: 427523.6133; val_global_loss: 1124196.8750; val_optim_loss: 1124196.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9347; val_auprc_score: 0.9278; val_best_acc_score: 0.8544; val_best_f1_score: 0.8631; train_kl_reg_loss: 14426.4645; train_edge_recon_loss: 37506.8781; train_gene_expr_recon_loss: 635816.4195; train_masked_gp_l1_reg_loss: 6775.9785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10060.6340; train_chrom_access_recon_loss: 429083.8314; train_global_loss: 1133670.2064; train_optim_loss: 1133670.2064; val_kl_reg_loss: 13979.7344; val_edge_recon_loss: 38915.2891; val_gene_expr_recon_loss: 633259.5781; val_masked_gp_l1_reg_loss: 6826.6821; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9013.0996; val_chrom_access_recon_loss: 425673.2734; val_global_loss: 1127667.7031; val_optim_loss: 1127667.7031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9360; val_auprc_score: 0.9305; val_best_acc_score: 0.8584; val_best_f1_score: 0.8632; train_kl_reg_loss: 13878.9314; train_edge_recon_loss: 37229.9350; train_gene_expr_recon_loss: 631876.1581; train_masked_gp_l1_reg_loss: 6857.5204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8248.7698; train_chrom_access_recon_loss: 426137.1851; train_global_loss: 1124228.5000; train_optim_loss: 1124228.5000; val_kl_reg_loss: 13359.7949; val_edge_recon_loss: 38583.6353; val_gene_expr_recon_loss: 621359.8281; val_masked_gp_l1_reg_loss: 6905.1318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7583.4609; val_chrom_access_recon_loss: 424532.5742; val_global_loss: 1112324.3906; val_optim_loss: 1112324.3906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9316; val_auprc_score: 0.9264; val_best_acc_score: 0.8519; val_best_f1_score: 0.8547; train_kl_reg_loss: 13468.4888; train_edge_recon_loss: 36938.5667; train_gene_expr_recon_loss: 628819.0511; train_masked_gp_l1_reg_loss: 6932.0570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7051.8439; train_chrom_access_recon_loss: 424181.1591; train_global_loss: 1117391.1629; train_optim_loss: 1117391.1629; val_kl_reg_loss: 13112.4712; val_edge_recon_loss: 38299.8433; val_gene_expr_recon_loss: 621887.0156; val_masked_gp_l1_reg_loss: 6966.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6574.1973; val_chrom_access_recon_loss: 418961.6758; val_global_loss: 1105801.9531; val_optim_loss: 1105801.9531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9401; val_auprc_score: 0.9354; val_best_acc_score: 0.8558; val_best_f1_score: 0.8627; train_kl_reg_loss: 13095.8431; train_edge_recon_loss: 36702.7835; train_gene_expr_recon_loss: 624579.9744; train_masked_gp_l1_reg_loss: 6993.2225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6217.7100; train_chrom_access_recon_loss: 420784.5052; train_global_loss: 1108374.0341; train_optim_loss: 1108374.0341; val_kl_reg_loss: 12941.6487; val_edge_recon_loss: 38051.9458; val_gene_expr_recon_loss: 619281.2500; val_masked_gp_l1_reg_loss: 7026.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5903.5146; val_chrom_access_recon_loss: 422901.1797; val_global_loss: 1106105.6562; val_optim_loss: 1106105.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9363; val_auprc_score: 0.9299; val_best_acc_score: 0.8592; val_best_f1_score: 0.8668; train_kl_reg_loss: 12774.0107; train_edge_recon_loss: 36497.8295; train_gene_expr_recon_loss: 621858.1098; train_masked_gp_l1_reg_loss: 7043.2646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5662.7229; train_chrom_access_recon_loss: 419364.7467; train_global_loss: 1103200.6903; train_optim_loss: 1103200.6903; val_kl_reg_loss: 12696.1444; val_edge_recon_loss: 37900.4087; val_gene_expr_recon_loss: 616445.1953; val_masked_gp_l1_reg_loss: 7068.5601; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5440.0684; val_chrom_access_recon_loss: 419512.8047; val_global_loss: 1099063.1562; val_optim_loss: 1099063.1562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9389; val_auprc_score: 0.9367; val_best_acc_score: 0.8581; val_best_f1_score: 0.8623; train_kl_reg_loss: 12519.4378; train_edge_recon_loss: 36315.7612; train_gene_expr_recon_loss: 618817.3191; train_masked_gp_l1_reg_loss: 7088.4431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5251.6040; train_chrom_access_recon_loss: 416869.8201; train_global_loss: 1096862.3788; train_optim_loss: 1096862.3788; val_kl_reg_loss: 12169.1976; val_edge_recon_loss: 37575.3501; val_gene_expr_recon_loss: 614523.6953; val_masked_gp_l1_reg_loss: 7106.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5095.3364; val_chrom_access_recon_loss: 416398.6055; val_global_loss: 1092868.5938; val_optim_loss: 1092868.5938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9420; val_auprc_score: 0.9378; val_best_acc_score: 0.8570; val_best_f1_score: 0.8643; train_kl_reg_loss: 12289.3251; train_edge_recon_loss: 36119.1043; train_gene_expr_recon_loss: 615845.1723; train_masked_gp_l1_reg_loss: 7128.3644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4951.4045; train_chrom_access_recon_loss: 415579.9522; train_global_loss: 1091913.3277; train_optim_loss: 1091913.3277; val_kl_reg_loss: 11900.2847; val_edge_recon_loss: 37298.5786; val_gene_expr_recon_loss: 604028.7422; val_masked_gp_l1_reg_loss: 7154.3462; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4816.4897; val_chrom_access_recon_loss: 413566.3867; val_global_loss: 1078764.8594; val_optim_loss: 1078764.8594
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9422; val_auprc_score: 0.9368; val_best_acc_score: 0.8597; val_best_f1_score: 0.8645; train_kl_reg_loss: 12107.2156; train_edge_recon_loss: 35958.8505; train_gene_expr_recon_loss: 613021.5616; train_masked_gp_l1_reg_loss: 7170.8525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4710.7674; train_chrom_access_recon_loss: 413343.8390; train_global_loss: 1086313.0890; train_optim_loss: 1086313.0890; val_kl_reg_loss: 11571.8240; val_edge_recon_loss: 37074.4272; val_gene_expr_recon_loss: 610018.9141; val_masked_gp_l1_reg_loss: 7191.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4609.6562; val_chrom_access_recon_loss: 411369.8477; val_global_loss: 1081835.7188; val_optim_loss: 1081835.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9462; val_auprc_score: 0.9434; val_best_acc_score: 0.8667; val_best_f1_score: 0.8715; train_kl_reg_loss: 11933.9996; train_edge_recon_loss: 35814.2170; train_gene_expr_recon_loss: 610466.5814; train_masked_gp_l1_reg_loss: 7203.0469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4517.4628; train_chrom_access_recon_loss: 412049.1425; train_global_loss: 1081984.4555; train_optim_loss: 1081984.4555; val_kl_reg_loss: 11817.6550; val_edge_recon_loss: 36934.0723; val_gene_expr_recon_loss: 605342.5859; val_masked_gp_l1_reg_loss: 7230.1519; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4446.2480; val_chrom_access_recon_loss: 411427.6133; val_global_loss: 1077198.3125; val_optim_loss: 1077198.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9482; val_auprc_score: 0.9477; val_best_acc_score: 0.8685; val_best_f1_score: 0.8696; train_kl_reg_loss: 11809.0619; train_edge_recon_loss: 35641.2930; train_gene_expr_recon_loss: 607382.5464; train_masked_gp_l1_reg_loss: 7252.1506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4363.9234; train_chrom_access_recon_loss: 410272.3324; train_global_loss: 1076721.3059; train_optim_loss: 1076721.3059; val_kl_reg_loss: 11526.8732; val_edge_recon_loss: 36753.1943; val_gene_expr_recon_loss: 600755.9922; val_masked_gp_l1_reg_loss: 7266.5166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4289.6045; val_chrom_access_recon_loss: 408376.8516; val_global_loss: 1068969.0469; val_optim_loss: 1068969.0469
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9482; val_auprc_score: 0.9455; val_best_acc_score: 0.8663; val_best_f1_score: 0.8690; train_kl_reg_loss: 11697.1329; train_edge_recon_loss: 35494.9696; train_gene_expr_recon_loss: 604747.8191; train_masked_gp_l1_reg_loss: 7290.5132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4241.6869; train_chrom_access_recon_loss: 408950.2869; train_global_loss: 1072422.4157; train_optim_loss: 1072422.4157; val_kl_reg_loss: 11273.7526; val_edge_recon_loss: 36548.1963; val_gene_expr_recon_loss: 594748.1016; val_masked_gp_l1_reg_loss: 7314.2329; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4203.7861; val_chrom_access_recon_loss: 402892.6328; val_global_loss: 1056980.7656; val_optim_loss: 1056980.7656
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9501; val_auprc_score: 0.9489; val_best_acc_score: 0.8685; val_best_f1_score: 0.8733; train_kl_reg_loss: 11584.3785; train_edge_recon_loss: 35370.3103; train_gene_expr_recon_loss: 601570.5047; train_masked_gp_l1_reg_loss: 7329.6620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4142.1999; train_chrom_access_recon_loss: 407750.0260; train_global_loss: 1067747.0786; train_optim_loss: 1067747.0786; val_kl_reg_loss: 11326.3516; val_edge_recon_loss: 36349.7783; val_gene_expr_recon_loss: 597450.9844; val_masked_gp_l1_reg_loss: 7354.0376; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4102.2744; val_chrom_access_recon_loss: 407888.0078; val_global_loss: 1064471.4219; val_optim_loss: 1064471.4219
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9521; val_auprc_score: 0.9513; val_best_acc_score: 0.8731; val_best_f1_score: 0.8760; train_kl_reg_loss: 11515.7998; train_edge_recon_loss: 35252.1848; train_gene_expr_recon_loss: 599679.9953; train_masked_gp_l1_reg_loss: 7372.7568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4057.7925; train_chrom_access_recon_loss: 406777.8627; train_global_loss: 1064656.3920; train_optim_loss: 1064656.3920; val_kl_reg_loss: 11316.1085; val_edge_recon_loss: 36236.9312; val_gene_expr_recon_loss: 594220.6016; val_masked_gp_l1_reg_loss: 7393.3735; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4026.3696; val_chrom_access_recon_loss: 404855.1484; val_global_loss: 1058048.5391; val_optim_loss: 1058048.5391
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9560; val_auprc_score: 0.9558; val_best_acc_score: 0.8769; val_best_f1_score: 0.8816; train_kl_reg_loss: 11433.2906; train_edge_recon_loss: 35126.5701; train_gene_expr_recon_loss: 596811.2623; train_masked_gp_l1_reg_loss: 7414.1155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3988.2703; train_chrom_access_recon_loss: 405529.3722; train_global_loss: 1060302.8741; train_optim_loss: 1060302.8741; val_kl_reg_loss: 11137.4180; val_edge_recon_loss: 36015.3530; val_gene_expr_recon_loss: 601829.3906; val_masked_gp_l1_reg_loss: 7429.5488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3949.9336; val_chrom_access_recon_loss: 409315.7031; val_global_loss: 1069677.3438; val_optim_loss: 1069677.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9231; val_auprc_score: 0.9242; val_best_acc_score: 0.8403; val_best_f1_score: 0.8458; train_kl_reg_loss: 48885.0546; train_edge_recon_loss: 35186.2625; train_gene_expr_recon_loss: 598895.3475; train_masked_gp_l1_reg_loss: 7448.7457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3930.2042; train_chrom_access_recon_loss: 405049.6695; train_global_loss: 1099395.2822; train_optim_loss: 1099395.2822; val_kl_reg_loss: 13650.7415; val_edge_recon_loss: 36976.9448; val_gene_expr_recon_loss: 606167.1094; val_masked_gp_l1_reg_loss: 7488.7183; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3981.8159; val_chrom_access_recon_loss: 403946.1719; val_global_loss: 1072211.4609; val_optim_loss: 1072211.4609

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9407; val_auprc_score: 0.9408; val_best_acc_score: 0.8610; val_best_f1_score: 0.8618; train_kl_reg_loss: 12684.0317; train_edge_recon_loss: 35608.2231; train_gene_expr_recon_loss: 606067.4081; train_masked_gp_l1_reg_loss: 7290.4543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3649.2795; train_chrom_access_recon_loss: 406357.1259; train_global_loss: 1071656.5303; train_optim_loss: 1071656.5303; val_kl_reg_loss: 12005.1753; val_edge_recon_loss: 36519.1704; val_gene_expr_recon_loss: 599055.0234; val_masked_gp_l1_reg_loss: 7212.8389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3495.9094; val_chrom_access_recon_loss: 406675.8633; val_global_loss: 1064963.9844; val_optim_loss: 1064963.9844
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9415; val_auprc_score: 0.9401; val_best_acc_score: 0.8600; val_best_f1_score: 0.8623; train_kl_reg_loss: 11807.3760; train_edge_recon_loss: 35357.4628; train_gene_expr_recon_loss: 597345.3428; train_masked_gp_l1_reg_loss: 7198.6245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3480.7951; train_chrom_access_recon_loss: 405003.8267; train_global_loss: 1060193.4261; train_optim_loss: 1060193.4261; val_kl_reg_loss: 11481.7119; val_edge_recon_loss: 36309.7627; val_gene_expr_recon_loss: 589909.9453; val_masked_gp_l1_reg_loss: 7192.1270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3453.8232; val_chrom_access_recon_loss: 401872.7266; val_global_loss: 1050220.1016; val_optim_loss: 1050220.1016
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9427; val_auprc_score: 0.9430; val_best_acc_score: 0.8597; val_best_f1_score: 0.8648; train_kl_reg_loss: 11569.5227; train_edge_recon_loss: 35260.0331; train_gene_expr_recon_loss: 595692.4403; train_masked_gp_l1_reg_loss: 7187.6064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3435.6932; train_chrom_access_recon_loss: 403969.4295; train_global_loss: 1057114.7273; train_optim_loss: 1057114.7273; val_kl_reg_loss: 11377.1497; val_edge_recon_loss: 36330.2207; val_gene_expr_recon_loss: 590798.6797; val_masked_gp_l1_reg_loss: 7186.0645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3426.5645; val_chrom_access_recon_loss: 402042.2969; val_global_loss: 1051160.9766; val_optim_loss: 1051160.9766
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9488; val_auprc_score: 0.9499; val_best_acc_score: 0.8676; val_best_f1_score: 0.8698; train_kl_reg_loss: 11476.7401; train_edge_recon_loss: 35192.7082; train_gene_expr_recon_loss: 594630.9062; train_masked_gp_l1_reg_loss: 7184.4531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3411.9319; train_chrom_access_recon_loss: 403508.1316; train_global_loss: 1055404.8788; train_optim_loss: 1055404.8788; val_kl_reg_loss: 11284.2002; val_edge_recon_loss: 36216.2603; val_gene_expr_recon_loss: 600058.0859; val_masked_gp_l1_reg_loss: 7186.1284; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3401.2012; val_chrom_access_recon_loss: 403203.5703; val_global_loss: 1061349.4141; val_optim_loss: 1061349.4141
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9310; val_auprc_score: 0.9372; val_best_acc_score: 0.8527; val_best_f1_score: 0.8524; train_kl_reg_loss: 9062.6971; train_edge_recon_loss: 37123.3169; train_gene_expr_recon_loss: 981464.0947; train_masked_gp_l1_reg_loss: 7406.0763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3285.8909; train_chrom_access_recon_loss: 437688.9015; train_global_loss: 1476030.9848; train_optim_loss: 1476030.9848; val_kl_reg_loss: 5915.9684; val_edge_recon_loss: 38048.8135; val_gene_expr_recon_loss: 969767.1250; val_masked_gp_l1_reg_loss: 7678.2153; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3179.2632; val_chrom_access_recon_loss: 435861.1016; val_global_loss: 1460450.4688; val_optim_loss: 1460450.4688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9329; val_auprc_score: 0.9384; val_best_acc_score: 0.8546; val_best_f1_score: 0.8518; train_kl_reg_loss: 8392.7606; train_edge_recon_loss: 37155.8352; train_gene_expr_recon_loss: 968845.0161; train_masked_gp_l1_reg_loss: 7878.5783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3091.9388; train_chrom_access_recon_loss: 436167.1278; train_global_loss: 1461531.2633; train_optim_loss: 1461531.2633; val_kl_reg_loss: 5900.9023; val_edge_recon_loss: 38099.9966; val_gene_expr_recon_loss: 962920.4766; val_masked_gp_l1_reg_loss: 8057.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3005.6646; val_chrom_access_recon_loss: 440734.6445; val_global_loss: 1458718.8750; val_optim_loss: 1458718.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9366; val_auprc_score: 0.9410; val_best_acc_score: 0.8595; val_best_f1_score: 0.8568; train_kl_reg_loss: 8190.5721; train_edge_recon_loss: 37157.2068; train_gene_expr_recon_loss: 966588.3466; train_masked_gp_l1_reg_loss: 8064.1775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2986.4355; train_chrom_access_recon_loss: 436491.5587; train_global_loss: 1459478.2936; train_optim_loss: 1459478.2936; val_kl_reg_loss: 5906.6082; val_edge_recon_loss: 38037.0205; val_gene_expr_recon_loss: 957281.6641; val_masked_gp_l1_reg_loss: 8077.3682; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2976.1626; val_chrom_access_recon_loss: 434663.5234; val_global_loss: 1446942.3594; val_optim_loss: 1446942.3594
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9340; val_auprc_score: 0.9381; val_best_acc_score: 0.8544; val_best_f1_score: 0.8517; train_kl_reg_loss: 8162.4192; train_edge_recon_loss: 37156.5558; train_gene_expr_recon_loss: 965835.0966; train_masked_gp_l1_reg_loss: 8090.8898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2967.9563; train_chrom_access_recon_loss: 436543.3812; train_global_loss: 1458756.2879; train_optim_loss: 1458756.2879; val_kl_reg_loss: 5898.1729; val_edge_recon_loss: 38078.5493; val_gene_expr_recon_loss: 953814.5625; val_masked_gp_l1_reg_loss: 8104.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2959.5024; val_chrom_access_recon_loss: 431513.5195; val_global_loss: 1440368.8125; val_optim_loss: 1440368.8125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9314; val_auprc_score: 0.9352; val_best_acc_score: 0.8521; val_best_f1_score: 0.8499; train_kl_reg_loss: 8141.1288; train_edge_recon_loss: 37151.9367; train_gene_expr_recon_loss: 965228.3731; train_masked_gp_l1_reg_loss: 8117.1110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2951.2165; train_chrom_access_recon_loss: 435600.6728; train_global_loss: 1457190.4356; train_optim_loss: 1457190.4356; val_kl_reg_loss: 5907.0640; val_edge_recon_loss: 38082.8579; val_gene_expr_recon_loss: 965184.9609; val_masked_gp_l1_reg_loss: 8130.0972; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2942.6487; val_chrom_access_recon_loss: 441735.4258; val_global_loss: 1461983.0781; val_optim_loss: 1461983.0781
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9346; val_auprc_score: 0.9402; val_best_acc_score: 0.8533; val_best_f1_score: 0.8516; train_kl_reg_loss: 8124.3368; train_edge_recon_loss: 37153.8844; train_gene_expr_recon_loss: 964418.3655; train_masked_gp_l1_reg_loss: 8142.3895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2934.3040; train_chrom_access_recon_loss: 436331.5521; train_global_loss: 1457104.8182; train_optim_loss: 1457104.8182; val_kl_reg_loss: 5896.0186; val_edge_recon_loss: 38094.8867; val_gene_expr_recon_loss: 957147.0391; val_masked_gp_l1_reg_loss: 8154.7842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2925.6558; val_chrom_access_recon_loss: 439098.0391; val_global_loss: 1451316.4219; val_optim_loss: 1451316.4219

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 32 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9227
val AUPRC score: 0.9305
val best accuracy score: 0.8445
val best F1 score: 0.8456
val target rna MSE score: 3.7879
val source rna MSE score: 3.5454
val target atac MSE score: 0.1334
val source atac MSE score: 0.0259
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
