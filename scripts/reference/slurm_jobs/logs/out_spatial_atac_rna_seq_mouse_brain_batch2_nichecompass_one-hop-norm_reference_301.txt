[True]
Run timestamp: 07092023_075304_301.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_301']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7744; val_auprc_score: 0.7985; val_best_acc_score: 0.5558; val_best_f1_score: 0.6873; train_kl_reg_loss: 96117.3907; train_edge_recon_loss: 3684319.5477; train_gene_expr_recon_loss: 17190427.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1231145.9447; train_chrom_access_recon_loss: 61889876.3664; train_global_loss: 84091887.0229; train_optim_loss: 84091887.0229; val_kl_reg_loss: 92830.7068; val_edge_recon_loss: 4061304.0167; val_gene_expr_recon_loss: 16149601.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 696081.5625; val_chrom_access_recon_loss: 60806013.8667; val_global_loss: 81805833.0667; val_optim_loss: 81805833.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8461; val_auprc_score: 0.8484; val_best_acc_score: 0.7497; val_best_f1_score: 0.7344; train_kl_reg_loss: 132743.0937; train_edge_recon_loss: 3562176.1336; train_gene_expr_recon_loss: 15583783.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 433254.3373; train_chrom_access_recon_loss: 59060159.4809; train_global_loss: 78772116.0916; train_optim_loss: 78772116.0916; val_kl_reg_loss: 124947.3208; val_edge_recon_loss: 4019908.1000; val_gene_expr_recon_loss: 15711897.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 266394.4688; val_chrom_access_recon_loss: 59609195.7333; val_global_loss: 79732342.9333; val_optim_loss: 79732342.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8915; val_auprc_score: 0.8842; val_best_acc_score: 0.8084; val_best_f1_score: 0.8188; train_kl_reg_loss: 111853.4068; train_edge_recon_loss: 3503123.6641; train_gene_expr_recon_loss: 15334635.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201329.1843; train_chrom_access_recon_loss: 58313352.3664; train_global_loss: 77464294.5344; train_optim_loss: 77464294.5344; val_kl_reg_loss: 89908.9630; val_edge_recon_loss: 3545237.5667; val_gene_expr_recon_loss: 15503177.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155208.1562; val_chrom_access_recon_loss: 59093615.2000; val_global_loss: 78387146.6667; val_optim_loss: 78387146.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8780; val_auprc_score: 0.8682; val_best_acc_score: 0.7885; val_best_f1_score: 0.8068; train_kl_reg_loss: 118548.9862; train_edge_recon_loss: 3096917.6679; train_gene_expr_recon_loss: 15121701.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131135.4255; train_chrom_access_recon_loss: 57621828.8244; train_global_loss: 76090132.7023; train_optim_loss: 76090132.7023; val_kl_reg_loss: 140109.4427; val_edge_recon_loss: 3014643.1167; val_gene_expr_recon_loss: 15386892.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112366.1641; val_chrom_access_recon_loss: 58352234.4000; val_global_loss: 77006245.8667; val_optim_loss: 77006245.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8962; val_auprc_score: 0.8865; val_best_acc_score: 0.8061; val_best_f1_score: 0.8209; train_kl_reg_loss: 134831.9441; train_edge_recon_loss: 2966708.6565; train_gene_expr_recon_loss: 14968777.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101346.2903; train_chrom_access_recon_loss: 57121817.2824; train_global_loss: 75293482.6565; train_optim_loss: 75293482.6565; val_kl_reg_loss: 130503.0115; val_edge_recon_loss: 2943890.5167; val_gene_expr_recon_loss: 15151391.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92611.9062; val_chrom_access_recon_loss: 57619818.1333; val_global_loss: 75938214.9333; val_optim_loss: 75938214.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9106; val_auprc_score: 0.8911; val_best_acc_score: 0.8395; val_best_f1_score: 0.8494; train_kl_reg_loss: 123809.5390; train_edge_recon_loss: 2917659.4275; train_gene_expr_recon_loss: 14842417.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86689.7290; train_chrom_access_recon_loss: 56706563.1450; train_global_loss: 74677139.1145; train_optim_loss: 74677139.1145; val_kl_reg_loss: 121366.8443; val_edge_recon_loss: 2892795.7667; val_gene_expr_recon_loss: 15098478.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82081.8984; val_chrom_access_recon_loss: 57749043.7333; val_global_loss: 75943767.4667; val_optim_loss: 75943767.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9300; val_auprc_score: 0.9163; val_best_acc_score: 0.8596; val_best_f1_score: 0.8674; train_kl_reg_loss: 120178.6045; train_edge_recon_loss: 2856546.2195; train_gene_expr_recon_loss: 14720404.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78598.5572; train_chrom_access_recon_loss: 56252437.1603; train_global_loss: 74028164.8855; train_optim_loss: 74028164.8855; val_kl_reg_loss: 118558.4323; val_edge_recon_loss: 2844407.7500; val_gene_expr_recon_loss: 14976660.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75214.0000; val_chrom_access_recon_loss: 57136005.8667; val_global_loss: 75150845.3333; val_optim_loss: 75150845.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9346; val_auprc_score: 0.9190; val_best_acc_score: 0.8682; val_best_f1_score: 0.8764; train_kl_reg_loss: 122076.1830; train_edge_recon_loss: 2822159.9408; train_gene_expr_recon_loss: 14617183.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73122.9676; train_chrom_access_recon_loss: 55882013.1603; train_global_loss: 73516555.7252; train_optim_loss: 73516555.7252; val_kl_reg_loss: 126646.7172; val_edge_recon_loss: 2796044.3333; val_gene_expr_recon_loss: 14839024.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71134.1172; val_chrom_access_recon_loss: 56776864.0000; val_global_loss: 74609713.6000; val_optim_loss: 74609713.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9437; val_auprc_score: 0.9292; val_best_acc_score: 0.8804; val_best_f1_score: 0.8871; train_kl_reg_loss: 120137.4841; train_edge_recon_loss: 2794085.8092; train_gene_expr_recon_loss: 14531934.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69792.4224; train_chrom_access_recon_loss: 55521103.8779; train_global_loss: 73037053.7099; train_optim_loss: 73037053.7099; val_kl_reg_loss: 117376.6792; val_edge_recon_loss: 2790215.9833; val_gene_expr_recon_loss: 14732233.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69018.2969; val_chrom_access_recon_loss: 56192486.1333; val_global_loss: 73901330.1333; val_optim_loss: 73901330.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9413; val_auprc_score: 0.9264; val_best_acc_score: 0.8763; val_best_f1_score: 0.8838; train_kl_reg_loss: 118364.1428; train_edge_recon_loss: 2779698.2099; train_gene_expr_recon_loss: 14432516.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66964.7784; train_chrom_access_recon_loss: 55110483.2061; train_global_loss: 72508027.2061; train_optim_loss: 72508027.2061; val_kl_reg_loss: 119051.9375; val_edge_recon_loss: 2777568.5500; val_gene_expr_recon_loss: 14661593.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65625.5000; val_chrom_access_recon_loss: 55838666.9333; val_global_loss: 73462505.6000; val_optim_loss: 73462505.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9477; val_auprc_score: 0.9336; val_best_acc_score: 0.8863; val_best_f1_score: 0.8926; train_kl_reg_loss: 115716.1243; train_edge_recon_loss: 2765478.0000; train_gene_expr_recon_loss: 14372129.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64371.7985; train_chrom_access_recon_loss: 54834260.3664; train_global_loss: 72151955.9695; train_optim_loss: 72151955.9695; val_kl_reg_loss: 111895.4260; val_edge_recon_loss: 2770304.3333; val_gene_expr_recon_loss: 14648841.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63447.2734; val_chrom_access_recon_loss: 55882687.2000; val_global_loss: 73477175.4667; val_optim_loss: 73477175.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9541; val_auprc_score: 0.9451; val_best_acc_score: 0.8898; val_best_f1_score: 0.8953; train_kl_reg_loss: 112428.2846; train_edge_recon_loss: 2752039.0115; train_gene_expr_recon_loss: 14302749.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62329.8019; train_chrom_access_recon_loss: 54471669.4351; train_global_loss: 71701215.7252; train_optim_loss: 71701215.7252; val_kl_reg_loss: 111092.7078; val_edge_recon_loss: 2763031.8333; val_gene_expr_recon_loss: 14563092.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61789.0938; val_chrom_access_recon_loss: 55362229.8667; val_global_loss: 72861236.2667; val_optim_loss: 72861236.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9546; val_auprc_score: 0.9436; val_best_acc_score: 0.8926; val_best_f1_score: 0.8976; train_kl_reg_loss: 109626.0234; train_edge_recon_loss: 2750620.4485; train_gene_expr_recon_loss: 14247838.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60856.6348; train_chrom_access_recon_loss: 54283547.2672; train_global_loss: 71452488.6412; train_optim_loss: 71452488.6412; val_kl_reg_loss: 109530.8344; val_edge_recon_loss: 2762349.1000; val_gene_expr_recon_loss: 14444715.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60222.7539; val_chrom_access_recon_loss: 54873415.7333; val_global_loss: 72250233.6000; val_optim_loss: 72250233.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9585; val_auprc_score: 0.9499; val_best_acc_score: 0.8975; val_best_f1_score: 0.9049; train_kl_reg_loss: 106322.8972; train_edge_recon_loss: 2745142.8626; train_gene_expr_recon_loss: 14186577.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59431.0932; train_chrom_access_recon_loss: 53910228.2443; train_global_loss: 71007701.9847; train_optim_loss: 71007701.9847; val_kl_reg_loss: 107033.6031; val_edge_recon_loss: 2767389.1500; val_gene_expr_recon_loss: 14423132.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58834.3008; val_chrom_access_recon_loss: 54833230.6667; val_global_loss: 72189619.2000; val_optim_loss: 72189619.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9615; val_auprc_score: 0.9507; val_best_acc_score: 0.9076; val_best_f1_score: 0.9107; train_kl_reg_loss: 103463.6849; train_edge_recon_loss: 2732101.0763; train_gene_expr_recon_loss: 14137010.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58323.7183; train_chrom_access_recon_loss: 53651274.9008; train_global_loss: 70682173.9847; train_optim_loss: 70682173.9847; val_kl_reg_loss: 102448.3115; val_edge_recon_loss: 2729032.0167; val_gene_expr_recon_loss: 14430634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57665.5078; val_chrom_access_recon_loss: 54742975.2000; val_global_loss: 72062755.7333; val_optim_loss: 72062755.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9622; val_auprc_score: 0.9524; val_best_acc_score: 0.9056; val_best_f1_score: 0.9091; train_kl_reg_loss: 100919.5262; train_edge_recon_loss: 2732386.8034; train_gene_expr_recon_loss: 14079490.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57428.6540; train_chrom_access_recon_loss: 53361531.6336; train_global_loss: 70331757.6794; train_optim_loss: 70331757.6794; val_kl_reg_loss: 99489.2635; val_edge_recon_loss: 2750970.7500; val_gene_expr_recon_loss: 14300722.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57124.5781; val_chrom_access_recon_loss: 54227988.5333; val_global_loss: 71436296.0000; val_optim_loss: 71436296.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9622; val_auprc_score: 0.9542; val_best_acc_score: 0.9039; val_best_f1_score: 0.9081; train_kl_reg_loss: 98607.1334; train_edge_recon_loss: 2737980.0592; train_gene_expr_recon_loss: 14050697.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56935.9260; train_chrom_access_recon_loss: 53160449.5267; train_global_loss: 70104669.4962; train_optim_loss: 70104669.4962; val_kl_reg_loss: 96844.7328; val_edge_recon_loss: 2745120.9833; val_gene_expr_recon_loss: 14247369.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56398.0938; val_chrom_access_recon_loss: 53883780.5333; val_global_loss: 71029512.0000; val_optim_loss: 71029512.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9661; val_auprc_score: 0.9573; val_best_acc_score: 0.9127; val_best_f1_score: 0.9146; train_kl_reg_loss: 96466.5296; train_edge_recon_loss: 2724677.5229; train_gene_expr_recon_loss: 14010419.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56272.4403; train_chrom_access_recon_loss: 52868582.1069; train_global_loss: 69756418.4733; train_optim_loss: 69756418.4733; val_kl_reg_loss: 96984.4568; val_edge_recon_loss: 2750401.4833; val_gene_expr_recon_loss: 14220142.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56094.0781; val_chrom_access_recon_loss: 53921364.0000; val_global_loss: 71044987.4667; val_optim_loss: 71044987.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9703; val_auprc_score: 0.9647; val_best_acc_score: 0.9154; val_best_f1_score: 0.9169; train_kl_reg_loss: 94509.7469; train_edge_recon_loss: 2725165.7271; train_gene_expr_recon_loss: 13973657.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56168.4362; train_chrom_access_recon_loss: 52654262.7481; train_global_loss: 69503763.8473; train_optim_loss: 69503763.8473; val_kl_reg_loss: 95424.5547; val_edge_recon_loss: 2739430.8500; val_gene_expr_recon_loss: 14299064.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55585.6992; val_chrom_access_recon_loss: 53868357.3333; val_global_loss: 71057862.9333; val_optim_loss: 71057862.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9697; val_auprc_score: 0.9589; val_best_acc_score: 0.9166; val_best_f1_score: 0.9197; train_kl_reg_loss: 93019.6567; train_edge_recon_loss: 2722064.0458; train_gene_expr_recon_loss: 13949140.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55956.1057; train_chrom_access_recon_loss: 52457347.6031; train_global_loss: 69277527.6947; train_optim_loss: 69277527.6947; val_kl_reg_loss: 92414.3964; val_edge_recon_loss: 2715164.5167; val_gene_expr_recon_loss: 14190424.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55481.4102; val_chrom_access_recon_loss: 53483496.8000; val_global_loss: 70536981.8667; val_optim_loss: 70536981.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9743; val_auprc_score: 0.9695; val_best_acc_score: 0.9204; val_best_f1_score: 0.9216; train_kl_reg_loss: 92225.5743; train_edge_recon_loss: 2714326.0095; train_gene_expr_recon_loss: 13913304.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55710.8113; train_chrom_access_recon_loss: 52229169.4656; train_global_loss: 69004736.7634; train_optim_loss: 69004736.7634; val_kl_reg_loss: 91435.5380; val_edge_recon_loss: 2718638.5333; val_gene_expr_recon_loss: 14106468.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55547.8047; val_chrom_access_recon_loss: 53241527.4667; val_global_loss: 70213618.1333; val_optim_loss: 70213618.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9722; val_auprc_score: 0.9630; val_best_acc_score: 0.9268; val_best_f1_score: 0.9287; train_kl_reg_loss: 90322.4894; train_edge_recon_loss: 2717673.9981; train_gene_expr_recon_loss: 13881434.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55823.5549; train_chrom_access_recon_loss: 52020787.3588; train_global_loss: 68766042.1679; train_optim_loss: 68766042.1679; val_kl_reg_loss: 91405.8375; val_edge_recon_loss: 2714428.1167; val_gene_expr_recon_loss: 14166046.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55596.0586; val_chrom_access_recon_loss: 53226689.0667; val_global_loss: 70254164.5333; val_optim_loss: 70254164.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9704; val_auprc_score: 0.9638; val_best_acc_score: 0.9146; val_best_f1_score: 0.9167; train_kl_reg_loss: 84219.8857; train_edge_recon_loss: 2731500.8340; train_gene_expr_recon_loss: 14071556.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57659.8526; train_chrom_access_recon_loss: 52338639.6031; train_global_loss: 69283577.0687; train_optim_loss: 69283577.0687; val_kl_reg_loss: 79834.5115; val_edge_recon_loss: 2756919.9500; val_gene_expr_recon_loss: 14243864.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62908.9727; val_chrom_access_recon_loss: 53271374.6667; val_global_loss: 70414901.8667; val_optim_loss: 70414901.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9668; val_auprc_score: 0.9593; val_best_acc_score: 0.9096; val_best_f1_score: 0.9128; train_kl_reg_loss: 85415.1444; train_edge_recon_loss: 2749168.1985; train_gene_expr_recon_loss: 14116890.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59127.6738; train_chrom_access_recon_loss: 52498342.9313; train_global_loss: 69508944.5802; train_optim_loss: 69508944.5802; val_kl_reg_loss: 79583.3901; val_edge_recon_loss: 2762150.2000; val_gene_expr_recon_loss: 14163983.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59797.3125; val_chrom_access_recon_loss: 53157349.8667; val_global_loss: 70222864.8000; val_optim_loss: 70222864.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9634; val_auprc_score: 0.9570; val_best_acc_score: 0.9022; val_best_f1_score: 0.9058; train_kl_reg_loss: 109809.7671; train_edge_recon_loss: 2786342.0973; train_gene_expr_recon_loss: 14150591.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57124.6237; train_chrom_access_recon_loss: 52682096.1832; train_global_loss: 69785964.7023; train_optim_loss: 69785964.7023; val_kl_reg_loss: 71625.0406; val_edge_recon_loss: 2765305.4500; val_gene_expr_recon_loss: 14190890.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55475.2070; val_chrom_access_recon_loss: 53578583.4667; val_global_loss: 70661880.8000; val_optim_loss: 70661880.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9599; val_auprc_score: 0.9508; val_best_acc_score: 0.8952; val_best_f1_score: 0.9002; train_kl_reg_loss: 78967.5655; train_edge_recon_loss: 2793924.6107; train_gene_expr_recon_loss: 13739223.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43239.9804; train_chrom_access_recon_loss: 52152730.6565; train_global_loss: 68808086.5954; train_optim_loss: 68808086.5954; val_kl_reg_loss: 56996.6096; val_edge_recon_loss: 2806769.4333; val_gene_expr_recon_loss: 13905945.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39138.3945; val_chrom_access_recon_loss: 52643741.8667; val_global_loss: 69452590.9333; val_optim_loss: 69452590.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9606; val_auprc_score: 0.9519; val_best_acc_score: 0.8999; val_best_f1_score: 0.9035; train_kl_reg_loss: 85533.5640; train_edge_recon_loss: 2773058.3511; train_gene_expr_recon_loss: 13662310.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37630.8202; train_chrom_access_recon_loss: 51770917.7710; train_global_loss: 68329451.0840; train_optim_loss: 68329451.0840; val_kl_reg_loss: 59079.3667; val_edge_recon_loss: 2798699.6833; val_gene_expr_recon_loss: 13905154.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36362.8477; val_chrom_access_recon_loss: 52508649.6000; val_global_loss: 69307945.0667; val_optim_loss: 69307945.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9634; val_auprc_score: 0.9542; val_best_acc_score: 0.9050; val_best_f1_score: 0.9083; train_kl_reg_loss: 89761.8000; train_edge_recon_loss: 2763479.4924; train_gene_expr_recon_loss: 13653766.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35416.6771; train_chrom_access_recon_loss: 51772530.1985; train_global_loss: 68314954.7786; train_optim_loss: 68314954.7786; val_kl_reg_loss: 60394.4729; val_edge_recon_loss: 2775484.7333; val_gene_expr_recon_loss: 13912753.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34557.5703; val_chrom_access_recon_loss: 52597157.6000; val_global_loss: 69380348.8000; val_optim_loss: 69380348.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9647; val_auprc_score: 0.9562; val_best_acc_score: 0.9050; val_best_f1_score: 0.9084; train_kl_reg_loss: 93415.8057; train_edge_recon_loss: 2765879.1431; train_gene_expr_recon_loss: 13636512.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33859.9782; train_chrom_access_recon_loss: 51667459.9389; train_global_loss: 68197126.7176; train_optim_loss: 68197126.7176; val_kl_reg_loss: 61893.4917; val_edge_recon_loss: 2772261.4167; val_gene_expr_recon_loss: 13922254.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33199.0430; val_chrom_access_recon_loss: 52723961.6000; val_global_loss: 69513570.4000; val_optim_loss: 69513570.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9636; val_auprc_score: 0.9543; val_best_acc_score: 0.9046; val_best_f1_score: 0.9081; train_kl_reg_loss: 96276.4584; train_edge_recon_loss: 2751774.4618; train_gene_expr_recon_loss: 13627053.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32639.1395; train_chrom_access_recon_loss: 51658834.5954; train_global_loss: 68166577.9237; train_optim_loss: 68166577.9237; val_kl_reg_loss: 63784.7180; val_edge_recon_loss: 2762109.1500; val_gene_expr_recon_loss: 13842612.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32128.8145; val_chrom_access_recon_loss: 52620252.8000; val_global_loss: 69320889.6000; val_optim_loss: 69320889.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9658; val_auprc_score: 0.9575; val_best_acc_score: 0.9084; val_best_f1_score: 0.9120; train_kl_reg_loss: 97712.3552; train_edge_recon_loss: 2759369.3702; train_gene_expr_recon_loss: 13611992.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31689.4215; train_chrom_access_recon_loss: 51576254.5038; train_global_loss: 68077018.3511; train_optim_loss: 68077018.3511; val_kl_reg_loss: 65719.3615; val_edge_recon_loss: 2774525.0167; val_gene_expr_recon_loss: 13838276.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31277.8926; val_chrom_access_recon_loss: 52310728.0000; val_global_loss: 69020528.2667; val_optim_loss: 69020528.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9652; val_auprc_score: 0.9558; val_best_acc_score: 0.9073; val_best_f1_score: 0.9100; train_kl_reg_loss: 99162.1652; train_edge_recon_loss: 2747595.0992; train_gene_expr_recon_loss: 13601959.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30928.4735; train_chrom_access_recon_loss: 51535853.2824; train_global_loss: 68015498.3206; train_optim_loss: 68015498.3206; val_kl_reg_loss: 65307.4805; val_edge_recon_loss: 2751022.9333; val_gene_expr_recon_loss: 13832208.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30592.8945; val_chrom_access_recon_loss: 52351241.3333; val_global_loss: 69030372.0000; val_optim_loss: 69030372.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9690; val_auprc_score: 0.9622; val_best_acc_score: 0.9138; val_best_f1_score: 0.9174; train_kl_reg_loss: 100055.3613; train_edge_recon_loss: 2744528.1393; train_gene_expr_recon_loss: 13593840.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30312.4124; train_chrom_access_recon_loss: 51527483.1450; train_global_loss: 67996220.1221; train_optim_loss: 67996220.1221; val_kl_reg_loss: 66640.6802; val_edge_recon_loss: 2735026.4167; val_gene_expr_recon_loss: 13876780.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30040.8027; val_chrom_access_recon_loss: 52484375.4667; val_global_loss: 69192862.9333; val_optim_loss: 69192862.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9650; val_auprc_score: 0.9570; val_best_acc_score: 0.9057; val_best_f1_score: 0.9095; train_kl_reg_loss: 100918.4536; train_edge_recon_loss: 2741940.0916; train_gene_expr_recon_loss: 13583130.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29806.4586; train_chrom_access_recon_loss: 51486181.7405; train_global_loss: 67941977.1603; train_optim_loss: 67941977.1603; val_kl_reg_loss: 67839.4901; val_edge_recon_loss: 2755139.3667; val_gene_expr_recon_loss: 13844517.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29583.1016; val_chrom_access_recon_loss: 52455195.7333; val_global_loss: 69152275.7333; val_optim_loss: 69152275.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9709; val_auprc_score: 0.9645; val_best_acc_score: 0.9179; val_best_f1_score: 0.9198; train_kl_reg_loss: 102526.3715; train_edge_recon_loss: 2734973.5763; train_gene_expr_recon_loss: 13596194.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29352.6209; train_chrom_access_recon_loss: 51457638.0763; train_global_loss: 67920684.9160; train_optim_loss: 67920684.9160; val_kl_reg_loss: 68614.9729; val_edge_recon_loss: 2746043.6667; val_gene_expr_recon_loss: 13848170.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29152.8145; val_chrom_access_recon_loss: 52528936.0000; val_global_loss: 69220919.2000; val_optim_loss: 69220919.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9648; val_auprc_score: 0.9571; val_best_acc_score: 0.9058; val_best_f1_score: 0.9105; train_kl_reg_loss: 102212.9738; train_edge_recon_loss: 2734838.7748; train_gene_expr_recon_loss: 13581085.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28801.0381; train_chrom_access_recon_loss: 51479839.0840; train_global_loss: 67926777.2214; train_optim_loss: 67926777.2214; val_kl_reg_loss: 68548.8198; val_edge_recon_loss: 2761689.2833; val_gene_expr_recon_loss: 13864587.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28748.9082; val_chrom_access_recon_loss: 52086791.2000; val_global_loss: 68810365.8667; val_optim_loss: 68810365.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9648; val_auprc_score: 0.9554; val_best_acc_score: 0.9077; val_best_f1_score: 0.9113; train_kl_reg_loss: 102297.8313; train_edge_recon_loss: 2734155.2595; train_gene_expr_recon_loss: 13581935.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28727.6932; train_chrom_access_recon_loss: 51470620.7023; train_global_loss: 67917736.6412; train_optim_loss: 67917736.6412; val_kl_reg_loss: 68090.8948; val_edge_recon_loss: 2771516.1500; val_gene_expr_recon_loss: 13796893.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28706.2285; val_chrom_access_recon_loss: 52344799.2000; val_global_loss: 69010005.0667; val_optim_loss: 69010005.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9686; val_auprc_score: 0.9620; val_best_acc_score: 0.9120; val_best_f1_score: 0.9146; train_kl_reg_loss: 102092.2455; train_edge_recon_loss: 2738102.7595; train_gene_expr_recon_loss: 13576017.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28685.4038; train_chrom_access_recon_loss: 51452057.8321; train_global_loss: 67896955.8168; train_optim_loss: 67896955.8168; val_kl_reg_loss: 68345.5854; val_edge_recon_loss: 2740553.2000; val_gene_expr_recon_loss: 13824405.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28664.3555; val_chrom_access_recon_loss: 52356130.9333; val_global_loss: 69018099.2000; val_optim_loss: 69018099.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9666; val_auprc_score: 0.9574; val_best_acc_score: 0.9096; val_best_f1_score: 0.9116; train_kl_reg_loss: 102090.8621; train_edge_recon_loss: 2735010.7939; train_gene_expr_recon_loss: 13578182.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28643.2782; train_chrom_access_recon_loss: 51438135.8168; train_global_loss: 67882063.3588; train_optim_loss: 67882063.3588; val_kl_reg_loss: 68357.4990; val_edge_recon_loss: 2744565.5167; val_gene_expr_recon_loss: 13835641.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28622.8203; val_chrom_access_recon_loss: 52389385.3333; val_global_loss: 69066573.0667; val_optim_loss: 69066573.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9675; val_auprc_score: 0.9588; val_best_acc_score: 0.9095; val_best_f1_score: 0.9133; train_kl_reg_loss: 101993.7879; train_edge_recon_loss: 2732838.7443; train_gene_expr_recon_loss: 13571729.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28602.3237; train_chrom_access_recon_loss: 51433626.2290; train_global_loss: 67868790.5954; train_optim_loss: 67868790.5954; val_kl_reg_loss: 68110.9891; val_edge_recon_loss: 2751996.5667; val_gene_expr_recon_loss: 13818741.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28580.5898; val_chrom_access_recon_loss: 52304352.5333; val_global_loss: 68971782.4000; val_optim_loss: 68971782.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9651; val_auprc_score: 0.9565; val_best_acc_score: 0.9092; val_best_f1_score: 0.9120; train_kl_reg_loss: 101948.2419; train_edge_recon_loss: 2735812.2195; train_gene_expr_recon_loss: 13581119.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28544.6861; train_chrom_access_recon_loss: 51439273.2214; train_global_loss: 67886697.4962; train_optim_loss: 67886697.4962; val_kl_reg_loss: 68428.2516; val_edge_recon_loss: 2748962.6000; val_gene_expr_recon_loss: 13901330.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28539.1816; val_chrom_access_recon_loss: 52714426.1333; val_global_loss: 69461687.7333; val_optim_loss: 69461687.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9687; val_auprc_score: 0.9622; val_best_acc_score: 0.9112; val_best_f1_score: 0.9137; train_kl_reg_loss: 101793.2511; train_edge_recon_loss: 2738402.3798; train_gene_expr_recon_loss: 13565312.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28536.6330; train_chrom_access_recon_loss: 51386097.6183; train_global_loss: 67820142.3817; train_optim_loss: 67820142.3817; val_kl_reg_loss: 68209.0685; val_edge_recon_loss: 2750406.2500; val_gene_expr_recon_loss: 13856376.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28534.1250; val_chrom_access_recon_loss: 52393142.4000; val_global_loss: 69096667.2000; val_optim_loss: 69096667.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9652; val_auprc_score: 0.9556; val_best_acc_score: 0.9078; val_best_f1_score: 0.9112; train_kl_reg_loss: 102150.8430; train_edge_recon_loss: 2737530.8912; train_gene_expr_recon_loss: 13582870.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28531.6458; train_chrom_access_recon_loss: 51447823.6336; train_global_loss: 67898907.1145; train_optim_loss: 67898907.1145; val_kl_reg_loss: 68721.5484; val_edge_recon_loss: 2753630.0500; val_gene_expr_recon_loss: 13810120.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28529.1230; val_chrom_access_recon_loss: 52373966.1333; val_global_loss: 69034967.2000; val_optim_loss: 69034967.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9652; val_auprc_score: 0.9568; val_best_acc_score: 0.9097; val_best_f1_score: 0.9130; train_kl_reg_loss: 102166.0723; train_edge_recon_loss: 2737468.9427; train_gene_expr_recon_loss: 13573420.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28526.6045; train_chrom_access_recon_loss: 51418417.9237; train_global_loss: 67859999.9084; train_optim_loss: 67859999.9084; val_kl_reg_loss: 68128.5656; val_edge_recon_loss: 2756310.5167; val_gene_expr_recon_loss: 13824270.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28524.0566; val_chrom_access_recon_loss: 52289441.8667; val_global_loss: 68966676.0000; val_optim_loss: 68966676.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 4 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9666
val AUPRC score: 0.9566
val best accuracy score: 0.9084
val best F1 score: 0.9127
val target rna MSE score: 1.2385
val source rna MSE score: 0.5708
val target atac MSE score: 0.1274
val source atac MSE score: 0.0215
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
