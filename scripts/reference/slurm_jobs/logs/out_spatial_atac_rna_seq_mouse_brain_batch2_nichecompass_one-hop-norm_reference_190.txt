[True]
Run timestamp: 10102023_073709_190.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_190']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7748; val_auprc_score: 0.7975; val_best_acc_score: 0.5474; val_best_f1_score: 0.6845; train_kl_reg_loss: 53439.9396; train_edge_recon_loss: 741068.9089; train_gene_expr_recon_loss: 22193015.2977; train_masked_gp_l1_reg_loss: 141840.8044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3277396.0744; train_chrom_access_recon_loss: 2255392.6746; train_global_loss: 28662153.8626; train_optim_loss: 28662153.8626; val_kl_reg_loss: 65607.2198; val_edge_recon_loss: 812434.7042; val_gene_expr_recon_loss: 20950665.4667; val_masked_gp_l1_reg_loss: 115935.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 789021.1250; val_chrom_access_recon_loss: 2174991.5917; val_global_loss: 24908656.8000; val_optim_loss: 24908656.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8762; val_auprc_score: 0.8738; val_best_acc_score: 0.7960; val_best_f1_score: 0.8062; train_kl_reg_loss: 71210.6185; train_edge_recon_loss: 731987.1708; train_gene_expr_recon_loss: 20817617.0382; train_masked_gp_l1_reg_loss: 111037.4408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 407619.7603; train_chrom_access_recon_loss: 2157498.3015; train_global_loss: 24296970.4427; train_optim_loss: 24296970.4427; val_kl_reg_loss: 63525.7661; val_edge_recon_loss: 805036.5292; val_gene_expr_recon_loss: 20668599.2000; val_masked_gp_l1_reg_loss: 110342.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230151.4531; val_chrom_access_recon_loss: 2146032.4000; val_global_loss: 24023687.8667; val_optim_loss: 24023687.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9035; val_auprc_score: 0.8958; val_best_acc_score: 0.8141; val_best_f1_score: 0.8279; train_kl_reg_loss: 62991.1365; train_edge_recon_loss: 714418.2600; train_gene_expr_recon_loss: 20546636.0916; train_masked_gp_l1_reg_loss: 111668.8895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186979.9233; train_chrom_access_recon_loss: 2132220.2433; train_global_loss: 23754914.5191; train_optim_loss: 23754914.5191; val_kl_reg_loss: 60160.1164; val_edge_recon_loss: 697476.8125; val_gene_expr_recon_loss: 20388215.4667; val_masked_gp_l1_reg_loss: 113792.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159554.5625; val_chrom_access_recon_loss: 2116557.1250; val_global_loss: 23535755.6000; val_optim_loss: 23535755.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9091; val_auprc_score: 0.8977; val_best_acc_score: 0.8252; val_best_f1_score: 0.8357; train_kl_reg_loss: 72238.3978; train_edge_recon_loss: 646704.1441; train_gene_expr_recon_loss: 20336536.8244; train_masked_gp_l1_reg_loss: 115008.2603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143879.8238; train_chrom_access_recon_loss: 2114643.7557; train_global_loss: 23429011.2061; train_optim_loss: 23429011.2061; val_kl_reg_loss: 71495.8182; val_edge_recon_loss: 634335.4708; val_gene_expr_recon_loss: 20205800.9333; val_masked_gp_l1_reg_loss: 115991.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131099.0469; val_chrom_access_recon_loss: 2111633.6083; val_global_loss: 23270357.6000; val_optim_loss: 23270357.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9309; val_auprc_score: 0.9184; val_best_acc_score: 0.8530; val_best_f1_score: 0.8623; train_kl_reg_loss: 74087.1377; train_edge_recon_loss: 625266.8769; train_gene_expr_recon_loss: 20111578.3053; train_masked_gp_l1_reg_loss: 116974.0244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122214.1343; train_chrom_access_recon_loss: 2092852.1746; train_global_loss: 23142972.7786; train_optim_loss: 23142972.7786; val_kl_reg_loss: 71085.8995; val_edge_recon_loss: 619253.2708; val_gene_expr_recon_loss: 20051026.1333; val_masked_gp_l1_reg_loss: 118353.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116378.7109; val_chrom_access_recon_loss: 2099584.9333; val_global_loss: 23075682.1333; val_optim_loss: 23075682.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9337; val_auprc_score: 0.9252; val_best_acc_score: 0.8587; val_best_f1_score: 0.8635; train_kl_reg_loss: 73202.9525; train_edge_recon_loss: 615219.5396; train_gene_expr_recon_loss: 19975183.5420; train_masked_gp_l1_reg_loss: 118867.8763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111405.2079; train_chrom_access_recon_loss: 2079607.8779; train_global_loss: 22973487.0840; train_optim_loss: 22973487.0840; val_kl_reg_loss: 71174.2516; val_edge_recon_loss: 613901.3792; val_gene_expr_recon_loss: 19857133.2000; val_masked_gp_l1_reg_loss: 119940.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108707.6797; val_chrom_access_recon_loss: 2070625.7083; val_global_loss: 22841482.9333; val_optim_loss: 22841482.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9427; val_auprc_score: 0.9357; val_best_acc_score: 0.8685; val_best_f1_score: 0.8736; train_kl_reg_loss: 71853.3325; train_edge_recon_loss: 607920.5911; train_gene_expr_recon_loss: 19803854.0000; train_masked_gp_l1_reg_loss: 120051.1913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104641.1229; train_chrom_access_recon_loss: 2060326.2433; train_global_loss: 22768646.4733; train_optim_loss: 22768646.4733; val_kl_reg_loss: 72498.5865; val_edge_recon_loss: 607306.2458; val_gene_expr_recon_loss: 19662847.0667; val_masked_gp_l1_reg_loss: 120795.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102563.1328; val_chrom_access_recon_loss: 2050058.7167; val_global_loss: 22616070.1333; val_optim_loss: 22616070.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9438; val_auprc_score: 0.9311; val_best_acc_score: 0.8751; val_best_f1_score: 0.8811; train_kl_reg_loss: 71134.3557; train_edge_recon_loss: 604854.2471; train_gene_expr_recon_loss: 19701759.8168; train_masked_gp_l1_reg_loss: 121003.0674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99037.3549; train_chrom_access_recon_loss: 2051657.5897; train_global_loss: 22649446.5496; train_optim_loss: 22649446.5496; val_kl_reg_loss: 70306.1396; val_edge_recon_loss: 608273.3125; val_gene_expr_recon_loss: 19660845.6000; val_masked_gp_l1_reg_loss: 121869.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97878.4219; val_chrom_access_recon_loss: 2048695.9583; val_global_loss: 22607868.9333; val_optim_loss: 22607868.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9490; val_auprc_score: 0.9420; val_best_acc_score: 0.8767; val_best_f1_score: 0.8831; train_kl_reg_loss: 70293.4679; train_edge_recon_loss: 601296.9871; train_gene_expr_recon_loss: 19606081.3588; train_masked_gp_l1_reg_loss: 121827.9761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94892.5352; train_chrom_access_recon_loss: 2040578.0906; train_global_loss: 22534970.2901; train_optim_loss: 22534970.2901; val_kl_reg_loss: 71825.0984; val_edge_recon_loss: 602359.5875; val_gene_expr_recon_loss: 19504771.0667; val_masked_gp_l1_reg_loss: 122260.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92967.5156; val_chrom_access_recon_loss: 2039506.0333; val_global_loss: 22433689.8667; val_optim_loss: 22433689.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9537; val_auprc_score: 0.9434; val_best_acc_score: 0.8861; val_best_f1_score: 0.8900; train_kl_reg_loss: 69590.2056; train_edge_recon_loss: 598594.3492; train_gene_expr_recon_loss: 19498460.9008; train_masked_gp_l1_reg_loss: 122390.2173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91867.5896; train_chrom_access_recon_loss: 2028663.6107; train_global_loss: 22409566.9160; train_optim_loss: 22409566.9160; val_kl_reg_loss: 69847.7781; val_edge_recon_loss: 601348.1500; val_gene_expr_recon_loss: 19363725.2000; val_masked_gp_l1_reg_loss: 122349.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90613.2188; val_chrom_access_recon_loss: 2022589.2083; val_global_loss: 22270474.6667; val_optim_loss: 22270474.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9538; val_auprc_score: 0.9451; val_best_acc_score: 0.8875; val_best_f1_score: 0.8912; train_kl_reg_loss: 69133.1274; train_edge_recon_loss: 594219.3206; train_gene_expr_recon_loss: 19415999.9847; train_masked_gp_l1_reg_loss: 122887.0902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89526.4655; train_chrom_access_recon_loss: 2020521.1947; train_global_loss: 22312287.3435; train_optim_loss: 22312287.3435; val_kl_reg_loss: 69842.4854; val_edge_recon_loss: 602252.2667; val_gene_expr_recon_loss: 19388741.4667; val_masked_gp_l1_reg_loss: 123271.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89284.4766; val_chrom_access_recon_loss: 2024476.8750; val_global_loss: 22297869.0667; val_optim_loss: 22297869.0667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9617; val_auprc_score: 0.9547; val_best_acc_score: 0.8998; val_best_f1_score: 0.9027; train_kl_reg_loss: 68779.5011; train_edge_recon_loss: 592505.2605; train_gene_expr_recon_loss: 19336599.5420; train_masked_gp_l1_reg_loss: 123319.9809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88406.0594; train_chrom_access_recon_loss: 2010326.5668; train_global_loss: 22219937.0687; train_optim_loss: 22219937.0687; val_kl_reg_loss: 68124.8391; val_edge_recon_loss: 594195.0167; val_gene_expr_recon_loss: 19262565.4667; val_masked_gp_l1_reg_loss: 123528.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88555.4375; val_chrom_access_recon_loss: 2006458.7167; val_global_loss: 22143427.8667; val_optim_loss: 22143427.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9627; val_auprc_score: 0.9533; val_best_acc_score: 0.9058; val_best_f1_score: 0.9085; train_kl_reg_loss: 68301.3604; train_edge_recon_loss: 590731.7762; train_gene_expr_recon_loss: 19254108.2595; train_masked_gp_l1_reg_loss: 123810.4339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87581.7001; train_chrom_access_recon_loss: 2003400.4819; train_global_loss: 22127933.9237; train_optim_loss: 22127933.9237; val_kl_reg_loss: 68279.5401; val_edge_recon_loss: 592312.2625; val_gene_expr_recon_loss: 19213613.8667; val_masked_gp_l1_reg_loss: 124228.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87635.1641; val_chrom_access_recon_loss: 2005790.6583; val_global_loss: 22091860.4000; val_optim_loss: 22091860.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9624; val_auprc_score: 0.9524; val_best_acc_score: 0.9074; val_best_f1_score: 0.9098; train_kl_reg_loss: 67846.3846; train_edge_recon_loss: 589605.3802; train_gene_expr_recon_loss: 19201738.6260; train_masked_gp_l1_reg_loss: 124149.9073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87289.0426; train_chrom_access_recon_loss: 1997142.7758; train_global_loss: 22067772.1069; train_optim_loss: 22067772.1069; val_kl_reg_loss: 67452.7250; val_edge_recon_loss: 592371.1417; val_gene_expr_recon_loss: 19114166.4000; val_masked_gp_l1_reg_loss: 124319.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87336.4375; val_chrom_access_recon_loss: 1997205.9833; val_global_loss: 21982852.4000; val_optim_loss: 21982852.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9646; val_auprc_score: 0.9574; val_best_acc_score: 0.9057; val_best_f1_score: 0.9091; train_kl_reg_loss: 67466.0606; train_edge_recon_loss: 588833.8297; train_gene_expr_recon_loss: 19145777.8626; train_masked_gp_l1_reg_loss: 124458.1123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87032.5771; train_chrom_access_recon_loss: 1988358.8702; train_global_loss: 22001927.2672; train_optim_loss: 22001927.2672; val_kl_reg_loss: 66970.7255; val_edge_recon_loss: 591121.0417; val_gene_expr_recon_loss: 19132598.6667; val_masked_gp_l1_reg_loss: 125132.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87212.9609; val_chrom_access_recon_loss: 1986699.3583; val_global_loss: 21989734.0000; val_optim_loss: 21989734.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9675; val_auprc_score: 0.9609; val_best_acc_score: 0.9111; val_best_f1_score: 0.9140; train_kl_reg_loss: 67102.5465; train_edge_recon_loss: 587614.9323; train_gene_expr_recon_loss: 19095158.3817; train_masked_gp_l1_reg_loss: 124877.2981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86811.4197; train_chrom_access_recon_loss: 1983416.6307; train_global_loss: 21944981.0229; train_optim_loss: 21944981.0229; val_kl_reg_loss: 68118.4531; val_edge_recon_loss: 588514.1083; val_gene_expr_recon_loss: 19061801.3333; val_masked_gp_l1_reg_loss: 125112.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86395.7031; val_chrom_access_recon_loss: 1988666.6417; val_global_loss: 21918608.8000; val_optim_loss: 21918608.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9654; val_auprc_score: 0.9555; val_best_acc_score: 0.9120; val_best_f1_score: 0.9149; train_kl_reg_loss: 66665.7976; train_edge_recon_loss: 586023.5830; train_gene_expr_recon_loss: 19034341.7099; train_masked_gp_l1_reg_loss: 125300.2303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85877.4034; train_chrom_access_recon_loss: 1978662.3817; train_global_loss: 21876871.0840; train_optim_loss: 21876871.0840; val_kl_reg_loss: 66787.3432; val_edge_recon_loss: 587836.7792; val_gene_expr_recon_loss: 19017321.8667; val_masked_gp_l1_reg_loss: 125455.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87084.7500; val_chrom_access_recon_loss: 1980214.5500; val_global_loss: 21864700.5333; val_optim_loss: 21864700.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9697; val_auprc_score: 0.9635; val_best_acc_score: 0.9189; val_best_f1_score: 0.9201; train_kl_reg_loss: 66277.6459; train_edge_recon_loss: 585820.6107; train_gene_expr_recon_loss: 18978660.8702; train_masked_gp_l1_reg_loss: 125922.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85478.2965; train_chrom_access_recon_loss: 1970001.6431; train_global_loss: 21812161.7099; train_optim_loss: 21812161.7099; val_kl_reg_loss: 66812.9169; val_edge_recon_loss: 589299.4500; val_gene_expr_recon_loss: 18880557.8667; val_masked_gp_l1_reg_loss: 126033.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85780.7422; val_chrom_access_recon_loss: 1964257.7000; val_global_loss: 21712741.8667; val_optim_loss: 21712741.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9716; val_auprc_score: 0.9620; val_best_acc_score: 0.9212; val_best_f1_score: 0.9232; train_kl_reg_loss: 65940.4983; train_edge_recon_loss: 585401.9723; train_gene_expr_recon_loss: 18941069.2061; train_masked_gp_l1_reg_loss: 126420.1330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84971.4933; train_chrom_access_recon_loss: 1967070.1756; train_global_loss: 21770873.4962; train_optim_loss: 21770873.4962; val_kl_reg_loss: 66373.1143; val_edge_recon_loss: 583737.9042; val_gene_expr_recon_loss: 18961148.9333; val_masked_gp_l1_reg_loss: 126969.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84693.6641; val_chrom_access_recon_loss: 1973621.0000; val_global_loss: 21796544.8000; val_optim_loss: 21796544.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9707; val_auprc_score: 0.9640; val_best_acc_score: 0.9216; val_best_f1_score: 0.9238; train_kl_reg_loss: 65697.9512; train_edge_recon_loss: 584337.0630; train_gene_expr_recon_loss: 18877798.0153; train_masked_gp_l1_reg_loss: 127321.8621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84597.4170; train_chrom_access_recon_loss: 1959700.2576; train_global_loss: 21699452.4733; train_optim_loss: 21699452.4733; val_kl_reg_loss: 65441.2568; val_edge_recon_loss: 583540.7417; val_gene_expr_recon_loss: 18763984.2667; val_masked_gp_l1_reg_loss: 127252.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84122.4531; val_chrom_access_recon_loss: 1952733.6750; val_global_loss: 21577073.7333; val_optim_loss: 21577073.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9697; val_auprc_score: 0.9624; val_best_acc_score: 0.9158; val_best_f1_score: 0.9199; train_kl_reg_loss: 64853.6109; train_edge_recon_loss: 584641.7266; train_gene_expr_recon_loss: 18861302.6565; train_masked_gp_l1_reg_loss: 127970.5265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84255.1262; train_chrom_access_recon_loss: 1959462.6975; train_global_loss: 21682486.3206; train_optim_loss: 21682486.3206; val_kl_reg_loss: 64560.4690; val_edge_recon_loss: 584921.6667; val_gene_expr_recon_loss: 18823712.1333; val_masked_gp_l1_reg_loss: 128259.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83726.4062; val_chrom_access_recon_loss: 1957336.7500; val_global_loss: 21642516.8000; val_optim_loss: 21642516.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9695; val_auprc_score: 0.9643; val_best_acc_score: 0.9173; val_best_f1_score: 0.9201; train_kl_reg_loss: 64719.5116; train_edge_recon_loss: 583110.8101; train_gene_expr_recon_loss: 18785304.2137; train_masked_gp_l1_reg_loss: 128794.4365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84149.4023; train_chrom_access_recon_loss: 1950627.9218; train_global_loss: 21596706.2443; train_optim_loss: 21596706.2443; val_kl_reg_loss: 65297.1216; val_edge_recon_loss: 588852.2042; val_gene_expr_recon_loss: 18713168.8000; val_masked_gp_l1_reg_loss: 129792.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84518.5703; val_chrom_access_recon_loss: 1949332.3333; val_global_loss: 21530960.5333; val_optim_loss: 21530960.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9678; val_auprc_score: 0.9598; val_best_acc_score: 0.9154; val_best_f1_score: 0.9187; train_kl_reg_loss: 64177.4716; train_edge_recon_loss: 584260.2686; train_gene_expr_recon_loss: 18758045.5420; train_masked_gp_l1_reg_loss: 129743.9605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84074.8885; train_chrom_access_recon_loss: 1948460.9866; train_global_loss: 21568763.1450; train_optim_loss: 21568763.1450; val_kl_reg_loss: 64698.2745; val_edge_recon_loss: 585980.3000; val_gene_expr_recon_loss: 18782949.8667; val_masked_gp_l1_reg_loss: 130551.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84304.3359; val_chrom_access_recon_loss: 1958109.7833; val_global_loss: 21606594.0000; val_optim_loss: 21606594.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9644; val_best_acc_score: 0.9189; val_best_f1_score: 0.9213; train_kl_reg_loss: 64034.6006; train_edge_recon_loss: 582073.0587; train_gene_expr_recon_loss: 18718639.1145; train_masked_gp_l1_reg_loss: 130674.8938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84017.8096; train_chrom_access_recon_loss: 1945667.1527; train_global_loss: 21525106.7634; train_optim_loss: 21525106.7634; val_kl_reg_loss: 63983.7060; val_edge_recon_loss: 585051.2083; val_gene_expr_recon_loss: 18691152.2667; val_masked_gp_l1_reg_loss: 131255.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84542.4844; val_chrom_access_recon_loss: 1950222.4167; val_global_loss: 21506207.6000; val_optim_loss: 21506207.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9707; val_auprc_score: 0.9635; val_best_acc_score: 0.9204; val_best_f1_score: 0.9231; train_kl_reg_loss: 63558.7061; train_edge_recon_loss: 583657.3387; train_gene_expr_recon_loss: 18673940.7786; train_masked_gp_l1_reg_loss: 131585.5067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84449.3882; train_chrom_access_recon_loss: 1942991.7052; train_global_loss: 21480183.4198; train_optim_loss: 21480183.4198; val_kl_reg_loss: 63848.7232; val_edge_recon_loss: 586919.9667; val_gene_expr_recon_loss: 18712753.8667; val_masked_gp_l1_reg_loss: 132177.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85168.8828; val_chrom_access_recon_loss: 1950288.2417; val_global_loss: 21531156.6667; val_optim_loss: 21531156.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9637; val_auprc_score: 0.9529; val_best_acc_score: 0.9103; val_best_f1_score: 0.9138; train_kl_reg_loss: 63031.2764; train_edge_recon_loss: 584658.4375; train_gene_expr_recon_loss: 18611659.3130; train_masked_gp_l1_reg_loss: 132379.9164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84644.0812; train_chrom_access_recon_loss: 1938696.2004; train_global_loss: 21415069.2977; train_optim_loss: 21415069.2977; val_kl_reg_loss: 64016.0927; val_edge_recon_loss: 588666.5583; val_gene_expr_recon_loss: 18651340.0000; val_masked_gp_l1_reg_loss: 133237.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85217.1172; val_chrom_access_recon_loss: 1942343.2667; val_global_loss: 21464821.8667; val_optim_loss: 21464821.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9698; val_auprc_score: 0.9615; val_best_acc_score: 0.9206; val_best_f1_score: 0.9233; train_kl_reg_loss: 63369.3887; train_edge_recon_loss: 583120.7958; train_gene_expr_recon_loss: 18578715.9389; train_masked_gp_l1_reg_loss: 133252.1506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85312.0671; train_chrom_access_recon_loss: 1936274.4571; train_global_loss: 21380044.8244; train_optim_loss: 21380044.8244; val_kl_reg_loss: 64648.6932; val_edge_recon_loss: 584993.3750; val_gene_expr_recon_loss: 18637301.7333; val_masked_gp_l1_reg_loss: 133426.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85070.4297; val_chrom_access_recon_loss: 1942952.9083; val_global_loss: 21448392.5333; val_optim_loss: 21448392.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9665; val_auprc_score: 0.9553; val_best_acc_score: 0.9202; val_best_f1_score: 0.9235; train_kl_reg_loss: 63360.1804; train_edge_recon_loss: 582581.8745; train_gene_expr_recon_loss: 18554739.3588; train_masked_gp_l1_reg_loss: 133856.5965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85448.5449; train_chrom_access_recon_loss: 1934773.4609; train_global_loss: 21354760.0916; train_optim_loss: 21354760.0916; val_kl_reg_loss: 62102.1117; val_edge_recon_loss: 585207.6833; val_gene_expr_recon_loss: 18634546.2667; val_masked_gp_l1_reg_loss: 134448.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86301.8672; val_chrom_access_recon_loss: 1948233.9667; val_global_loss: 21450839.8667; val_optim_loss: 21450839.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9659; val_auprc_score: 0.9542; val_best_acc_score: 0.9135; val_best_f1_score: 0.9174; train_kl_reg_loss: 63286.1757; train_edge_recon_loss: 583526.6446; train_gene_expr_recon_loss: 18504771.1450; train_masked_gp_l1_reg_loss: 134550.3156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86097.0981; train_chrom_access_recon_loss: 1932895.6126; train_global_loss: 21305127.0229; train_optim_loss: 21305127.0229; val_kl_reg_loss: 63549.5706; val_edge_recon_loss: 585220.9708; val_gene_expr_recon_loss: 18578720.5333; val_masked_gp_l1_reg_loss: 134686.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86193.0156; val_chrom_access_recon_loss: 1937199.1583; val_global_loss: 21385570.4000; val_optim_loss: 21385570.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9720; val_auprc_score: 0.9650; val_best_acc_score: 0.9232; val_best_f1_score: 0.9261; train_kl_reg_loss: 63682.4704; train_edge_recon_loss: 582966.4852; train_gene_expr_recon_loss: 18458079.3588; train_masked_gp_l1_reg_loss: 135053.0340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86448.7821; train_chrom_access_recon_loss: 1929271.4065; train_global_loss: 21255501.5878; train_optim_loss: 21255501.5878; val_kl_reg_loss: 63005.3313; val_edge_recon_loss: 582382.9292; val_gene_expr_recon_loss: 18572302.4000; val_masked_gp_l1_reg_loss: 135141.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88013.6875; val_chrom_access_recon_loss: 1944693.4000; val_global_loss: 21385540.2667; val_optim_loss: 21385540.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9645; val_auprc_score: 0.9502; val_best_acc_score: 0.9128; val_best_f1_score: 0.9166; train_kl_reg_loss: 63632.5765; train_edge_recon_loss: 584106.1384; train_gene_expr_recon_loss: 18423400.2901; train_masked_gp_l1_reg_loss: 135440.7733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87348.6908; train_chrom_access_recon_loss: 1926162.2853; train_global_loss: 21220090.7939; train_optim_loss: 21220090.7939; val_kl_reg_loss: 63525.0924; val_edge_recon_loss: 587108.6292; val_gene_expr_recon_loss: 18494038.4000; val_masked_gp_l1_reg_loss: 135950.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88888.6719; val_chrom_access_recon_loss: 1934033.2583; val_global_loss: 21303543.6000; val_optim_loss: 21303543.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9684; val_auprc_score: 0.9571; val_best_acc_score: 0.9181; val_best_f1_score: 0.9219; train_kl_reg_loss: 63950.2683; train_edge_recon_loss: 583542.4633; train_gene_expr_recon_loss: 18361131.8779; train_masked_gp_l1_reg_loss: 135623.1636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87670.0844; train_chrom_access_recon_loss: 1921774.3445; train_global_loss: 21153692.0916; train_optim_loss: 21153692.0916; val_kl_reg_loss: 62682.3505; val_edge_recon_loss: 586039.2292; val_gene_expr_recon_loss: 18472903.4667; val_masked_gp_l1_reg_loss: 135961.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88646.6172; val_chrom_access_recon_loss: 1934166.5917; val_global_loss: 21280399.7333; val_optim_loss: 21280399.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9659; val_auprc_score: 0.9522; val_best_acc_score: 0.9151; val_best_f1_score: 0.9183; train_kl_reg_loss: 63772.8556; train_edge_recon_loss: 583740.2013; train_gene_expr_recon_loss: 18348675.7863; train_masked_gp_l1_reg_loss: 136143.6796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88443.9795; train_chrom_access_recon_loss: 1922704.6469; train_global_loss: 21143481.1908; train_optim_loss: 21143481.1908; val_kl_reg_loss: 63359.4198; val_edge_recon_loss: 587330.1583; val_gene_expr_recon_loss: 18469763.8667; val_masked_gp_l1_reg_loss: 136077.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89086.0859; val_chrom_access_recon_loss: 1934859.6917; val_global_loss: 21280477.2000; val_optim_loss: 21280477.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9689; val_auprc_score: 0.9613; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 64392.3221; train_edge_recon_loss: 583934.1007; train_gene_expr_recon_loss: 18314127.8168; train_masked_gp_l1_reg_loss: 136379.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89315.6714; train_chrom_access_recon_loss: 1921285.3884; train_global_loss: 21109434.8702; train_optim_loss: 21109434.8702; val_kl_reg_loss: 65301.2240; val_edge_recon_loss: 587473.4208; val_gene_expr_recon_loss: 18457282.0000; val_masked_gp_l1_reg_loss: 136475.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89295.5859; val_chrom_access_recon_loss: 1930553.9917; val_global_loss: 21266382.8000; val_optim_loss: 21266382.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9696; val_auprc_score: 0.9619; val_best_acc_score: 0.9192; val_best_f1_score: 0.9220; train_kl_reg_loss: 64804.1732; train_edge_recon_loss: 584322.4041; train_gene_expr_recon_loss: 18291821.4351; train_masked_gp_l1_reg_loss: 136598.0419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89312.8155; train_chrom_access_recon_loss: 1921010.2958; train_global_loss: 21087869.1145; train_optim_loss: 21087869.1145; val_kl_reg_loss: 65954.5339; val_edge_recon_loss: 584188.6667; val_gene_expr_recon_loss: 18436899.0667; val_masked_gp_l1_reg_loss: 136809.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90509.5000; val_chrom_access_recon_loss: 1930810.2833; val_global_loss: 21245172.5333; val_optim_loss: 21245172.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9624; val_best_acc_score: 0.9184; val_best_f1_score: 0.9206; train_kl_reg_loss: 65082.9345; train_edge_recon_loss: 583014.8058; train_gene_expr_recon_loss: 18248151.0763; train_masked_gp_l1_reg_loss: 136803.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90118.9062; train_chrom_access_recon_loss: 1919446.2901; train_global_loss: 21042617.1298; train_optim_loss: 21042617.1298; val_kl_reg_loss: 65131.6326; val_edge_recon_loss: 587741.3375; val_gene_expr_recon_loss: 18478906.1333; val_masked_gp_l1_reg_loss: 137124.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90661.5078; val_chrom_access_recon_loss: 1935200.3500; val_global_loss: 21294765.2000; val_optim_loss: 21294765.2000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9682; val_auprc_score: 0.9606; val_best_acc_score: 0.9166; val_best_f1_score: 0.9203; train_kl_reg_loss: 65288.3622; train_edge_recon_loss: 584895.5067; train_gene_expr_recon_loss: 18265064.6947; train_masked_gp_l1_reg_loss: 137150.0821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92393.6657; train_chrom_access_recon_loss: 1920047.2471; train_global_loss: 21064839.5115; train_optim_loss: 21064839.5115; val_kl_reg_loss: 67017.7010; val_edge_recon_loss: 588913.6292; val_gene_expr_recon_loss: 18370131.0667; val_masked_gp_l1_reg_loss: 137341.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96225.1562; val_chrom_access_recon_loss: 1929892.1250; val_global_loss: 21189522.6667; val_optim_loss: 21189522.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9315; val_auprc_score: 0.9255; val_best_acc_score: 0.8545; val_best_f1_score: 0.8626; train_kl_reg_loss: 454927.3663; train_edge_recon_loss: 622084.8812; train_gene_expr_recon_loss: 18911764.6107; train_masked_gp_l1_reg_loss: 143750.4617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122140.9952; train_chrom_access_recon_loss: 1996050.0420; train_global_loss: 22250718.1985; train_optim_loss: 22250718.1985; val_kl_reg_loss: 68348.5094; val_edge_recon_loss: 689908.6208; val_gene_expr_recon_loss: 18989522.8000; val_masked_gp_l1_reg_loss: 146972.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123750.8203; val_chrom_access_recon_loss: 1986160.2667; val_global_loss: 22004662.2667; val_optim_loss: 22004662.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9334; val_auprc_score: 0.9257; val_best_acc_score: 0.8542; val_best_f1_score: 0.8647; train_kl_reg_loss: 259464.7716; train_edge_recon_loss: 662208.9485; train_gene_expr_recon_loss: 19185026.3664; train_masked_gp_l1_reg_loss: 165088.7334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124611.3167; train_chrom_access_recon_loss: 2042308.7739; train_global_loss: 22438708.7176; train_optim_loss: 22438708.7176; val_kl_reg_loss: 94606.9818; val_edge_recon_loss: 694421.2292; val_gene_expr_recon_loss: 19460637.2000; val_masked_gp_l1_reg_loss: 259005.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114529.6953; val_chrom_access_recon_loss: 2006065.1250; val_global_loss: 22629266.5333; val_optim_loss: 22629266.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9402; val_auprc_score: 0.9307; val_best_acc_score: 0.8673; val_best_f1_score: 0.8753; train_kl_reg_loss: 93017.6824; train_edge_recon_loss: 642842.2448; train_gene_expr_recon_loss: 19326417.7863; train_masked_gp_l1_reg_loss: 252255.4556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105495.4994; train_chrom_access_recon_loss: 1993796.4656; train_global_loss: 22413825.2672; train_optim_loss: 22413825.2672; val_kl_reg_loss: 111695.7786; val_edge_recon_loss: 652996.4333; val_gene_expr_recon_loss: 19255675.0667; val_masked_gp_l1_reg_loss: 233502.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101850.7344; val_chrom_access_recon_loss: 1975681.9500; val_global_loss: 22331401.2000; val_optim_loss: 22331401.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9425; val_auprc_score: 0.9285; val_best_acc_score: 0.8747; val_best_f1_score: 0.8798; train_kl_reg_loss: 101739.3914; train_edge_recon_loss: 620987.8550; train_gene_expr_recon_loss: 19191706.8550; train_masked_gp_l1_reg_loss: 218093.5948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97339.0932; train_chrom_access_recon_loss: 1969431.0849; train_global_loss: 22199297.7710; train_optim_loss: 22199297.7710; val_kl_reg_loss: 85006.3693; val_edge_recon_loss: 607916.8250; val_gene_expr_recon_loss: 19142107.8667; val_masked_gp_l1_reg_loss: 205834.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95829.1016; val_chrom_access_recon_loss: 1974157.0417; val_global_loss: 22110852.1333; val_optim_loss: 22110852.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9504; val_auprc_score: 0.9403; val_best_acc_score: 0.8864; val_best_f1_score: 0.8900; train_kl_reg_loss: 84621.6028; train_edge_recon_loss: 599872.7686; train_gene_expr_recon_loss: 19043340.4733; train_masked_gp_l1_reg_loss: 199309.7146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71492.1716; train_chrom_access_recon_loss: 1960182.1937; train_global_loss: 21958819.0382; train_optim_loss: 21958819.0382; val_kl_reg_loss: 84881.3521; val_edge_recon_loss: 598800.1042; val_gene_expr_recon_loss: 18999441.2000; val_masked_gp_l1_reg_loss: 196496.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67408.7969; val_chrom_access_recon_loss: 1965749.6333; val_global_loss: 21912776.2667; val_optim_loss: 21912776.2667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9473; val_auprc_score: 0.9374; val_best_acc_score: 0.8835; val_best_f1_score: 0.8880; train_kl_reg_loss: 84722.4110; train_edge_recon_loss: 596787.4136; train_gene_expr_recon_loss: 18989789.0076; train_masked_gp_l1_reg_loss: 195088.1449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66609.4636; train_chrom_access_recon_loss: 1945107.9256; train_global_loss: 21878104.3817; train_optim_loss: 21878104.3817; val_kl_reg_loss: 85647.8823; val_edge_recon_loss: 602193.2333; val_gene_expr_recon_loss: 19078697.6000; val_masked_gp_l1_reg_loss: 193730.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66080.2656; val_chrom_access_recon_loss: 1956797.5167; val_global_loss: 21983146.0000; val_optim_loss: 21983146.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9451; val_auprc_score: 0.9303; val_best_acc_score: 0.8808; val_best_f1_score: 0.8851; train_kl_reg_loss: 84591.4937; train_edge_recon_loss: 595548.9170; train_gene_expr_recon_loss: 18993809.5573; train_masked_gp_l1_reg_loss: 192439.2166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65635.9996; train_chrom_access_recon_loss: 1944555.5706; train_global_loss: 21876580.6870; train_optim_loss: 21876580.6870; val_kl_reg_loss: 84699.5974; val_edge_recon_loss: 600652.4792; val_gene_expr_recon_loss: 18929489.3333; val_masked_gp_l1_reg_loss: 191276.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65254.3945; val_chrom_access_recon_loss: 1935505.0917; val_global_loss: 21806876.5333; val_optim_loss: 21806876.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9483; val_auprc_score: 0.9360; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 84315.5030; train_edge_recon_loss: 593545.8392; train_gene_expr_recon_loss: 18882800.9771; train_masked_gp_l1_reg_loss: 190369.4368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64988.6266; train_chrom_access_recon_loss: 1940979.8788; train_global_loss: 21757000.2290; train_optim_loss: 21757000.2290; val_kl_reg_loss: 84350.1438; val_edge_recon_loss: 597931.7417; val_gene_expr_recon_loss: 18873368.4000; val_masked_gp_l1_reg_loss: 189218.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64736.7266; val_chrom_access_recon_loss: 1946994.3000; val_global_loss: 21756598.9333; val_optim_loss: 21756598.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 4 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9688
val AUPRC score: 0.9605
val best accuracy score: 0.9163
val best F1 score: 0.9192
val target rna MSE score: 1.2050
val source rna MSE score: 0.4975
val target atac MSE score: 0.3502
val source atac MSE score: 0.1067
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
