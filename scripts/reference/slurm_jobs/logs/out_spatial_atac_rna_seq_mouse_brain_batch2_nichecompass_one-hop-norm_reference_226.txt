[True]
Run timestamp: 07092023_010339_226.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_226']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 946 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4542, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6736; val_auprc_score: 0.6431; val_best_acc_score: 0.5140; val_best_f1_score: 0.6728; train_kl_reg_loss: 54312.1938; train_edge_recon_loss: 3525197.9773; train_gene_expr_recon_loss: 14590037.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1104673.5597; train_chrom_access_recon_loss: 5252951.6061; train_global_loss: 24527172.3030; train_optim_loss: 24527172.3030; val_kl_reg_loss: 120665.0518; val_edge_recon_loss: 4064592.7812; val_gene_expr_recon_loss: 13369997.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 819771.3125; val_chrom_access_recon_loss: 5039309.5625; val_global_loss: 23414336.2500; val_optim_loss: 23414336.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7184; val_auprc_score: 0.6942; val_best_acc_score: 0.6139; val_best_f1_score: 0.7092; train_kl_reg_loss: 100942.0773; train_edge_recon_loss: 3528239.1023; train_gene_expr_recon_loss: 13140593.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 585618.6373; train_chrom_access_recon_loss: 4975134.1439; train_global_loss: 22330527.7576; train_optim_loss: 22330527.7576; val_kl_reg_loss: 97042.8809; val_edge_recon_loss: 4056408.9375; val_gene_expr_recon_loss: 13029943.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 394506.4375; val_chrom_access_recon_loss: 5007474.1875; val_global_loss: 22585375.0000; val_optim_loss: 22585375.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7344; val_auprc_score: 0.7091; val_best_acc_score: 0.6776; val_best_f1_score: 0.7132; train_kl_reg_loss: 91144.8616; train_edge_recon_loss: 3517453.4659; train_gene_expr_recon_loss: 12947033.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 292258.9164; train_chrom_access_recon_loss: 4930458.5606; train_global_loss: 21778348.9394; train_optim_loss: 21778348.9394; val_kl_reg_loss: 80283.5068; val_edge_recon_loss: 4027752.5000; val_gene_expr_recon_loss: 12968983.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213984.4688; val_chrom_access_recon_loss: 4976464.3750; val_global_loss: 22267468.7500; val_optim_loss: 22267468.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7642; val_auprc_score: 0.7438; val_best_acc_score: 0.6846; val_best_f1_score: 0.7262; train_kl_reg_loss: 79614.6173; train_edge_recon_loss: 3492508.7311; train_gene_expr_recon_loss: 12858579.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170046.7401; train_chrom_access_recon_loss: 4903851.8864; train_global_loss: 21504601.6364; train_optim_loss: 21504601.6364; val_kl_reg_loss: 74639.4453; val_edge_recon_loss: 3859791.2500; val_gene_expr_recon_loss: 12810853.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135410.4375; val_chrom_access_recon_loss: 4935731.6250; val_global_loss: 21816425.2500; val_optim_loss: 21816425.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8168; val_auprc_score: 0.7796; val_best_acc_score: 0.7496; val_best_f1_score: 0.7822; train_kl_reg_loss: 63819.4613; train_edge_recon_loss: 3327542.0947; train_gene_expr_recon_loss: 12789385.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113826.9450; train_chrom_access_recon_loss: 4885936.7197; train_global_loss: 21180510.7576; train_optim_loss: 21180510.7576; val_kl_reg_loss: 66433.5723; val_edge_recon_loss: 3147694.0625; val_gene_expr_recon_loss: 12811080.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95873.3516; val_chrom_access_recon_loss: 4871558.8125; val_global_loss: 20992639.5000; val_optim_loss: 20992639.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8437; val_auprc_score: 0.8154; val_best_acc_score: 0.7552; val_best_f1_score: 0.7912; train_kl_reg_loss: 85851.5873; train_edge_recon_loss: 2996122.0227; train_gene_expr_recon_loss: 12728177.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83727.1508; train_chrom_access_recon_loss: 4863781.2045; train_global_loss: 20757659.6364; train_optim_loss: 20757659.6364; val_kl_reg_loss: 96309.0654; val_edge_recon_loss: 2974377.4062; val_gene_expr_recon_loss: 12596560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73095.9062; val_chrom_access_recon_loss: 4824920.4375; val_global_loss: 20565263.2500; val_optim_loss: 20565263.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8510; val_auprc_score: 0.8219; val_best_acc_score: 0.7560; val_best_f1_score: 0.7924; train_kl_reg_loss: 92103.7293; train_edge_recon_loss: 2947691.0303; train_gene_expr_recon_loss: 12632181.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65880.1636; train_chrom_access_recon_loss: 4831139.6364; train_global_loss: 20568995.8182; train_optim_loss: 20568995.8182; val_kl_reg_loss: 93762.2969; val_edge_recon_loss: 2956561.1875; val_gene_expr_recon_loss: 12793395.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59837.4883; val_chrom_access_recon_loss: 4904953.1875; val_global_loss: 20808508.5000; val_optim_loss: 20808508.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8682; val_auprc_score: 0.8306; val_best_acc_score: 0.7877; val_best_f1_score: 0.8039; train_kl_reg_loss: 90284.4028; train_edge_recon_loss: 2922704.3712; train_gene_expr_recon_loss: 12558396.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55734.9677; train_chrom_access_recon_loss: 4804471.1970; train_global_loss: 20431591.3636; train_optim_loss: 20431591.3636; val_kl_reg_loss: 85675.7881; val_edge_recon_loss: 2861465.8125; val_gene_expr_recon_loss: 12581154.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52015.8672; val_chrom_access_recon_loss: 4832151.8125; val_global_loss: 20412463.0000; val_optim_loss: 20412463.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8805; val_auprc_score: 0.8455; val_best_acc_score: 0.8074; val_best_f1_score: 0.8257; train_kl_reg_loss: 86695.0036; train_edge_recon_loss: 2904931.6364; train_gene_expr_recon_loss: 12507680.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49195.2776; train_chrom_access_recon_loss: 4790284.6136; train_global_loss: 20338787.3939; train_optim_loss: 20338787.3939; val_kl_reg_loss: 84429.3877; val_edge_recon_loss: 2871640.4375; val_gene_expr_recon_loss: 12545151.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46772.3398; val_chrom_access_recon_loss: 4783139.3750; val_global_loss: 20331133.0000; val_optim_loss: 20331133.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8840; val_auprc_score: 0.8482; val_best_acc_score: 0.8149; val_best_f1_score: 0.8307; train_kl_reg_loss: 81187.2319; train_edge_recon_loss: 2875695.9015; train_gene_expr_recon_loss: 12447882.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44580.4914; train_chrom_access_recon_loss: 4769479.7955; train_global_loss: 20218825.8182; train_optim_loss: 20218825.8182; val_kl_reg_loss: 78291.3271; val_edge_recon_loss: 2863004.9062; val_gene_expr_recon_loss: 12554529.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42921.2148; val_chrom_access_recon_loss: 4811429.7500; val_global_loss: 20350176.7500; val_optim_loss: 20350176.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8912; val_auprc_score: 0.8590; val_best_acc_score: 0.8200; val_best_f1_score: 0.8363; train_kl_reg_loss: 80825.0206; train_edge_recon_loss: 2823491.4129; train_gene_expr_recon_loss: 12404548.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41480.3411; train_chrom_access_recon_loss: 4752912.5682; train_global_loss: 20103258.0909; train_optim_loss: 20103258.0909; val_kl_reg_loss: 79123.1006; val_edge_recon_loss: 2827510.7500; val_gene_expr_recon_loss: 12529939.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40502.6250; val_chrom_access_recon_loss: 4792883.5000; val_global_loss: 20269960.0000; val_optim_loss: 20269960.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8994; val_auprc_score: 0.8674; val_best_acc_score: 0.8340; val_best_f1_score: 0.8460; train_kl_reg_loss: 81975.1162; train_edge_recon_loss: 2800872.0227; train_gene_expr_recon_loss: 12359949.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39594.9891; train_chrom_access_recon_loss: 4738097.8939; train_global_loss: 20020489.6667; train_optim_loss: 20020489.6667; val_kl_reg_loss: 84238.2070; val_edge_recon_loss: 2837562.1875; val_gene_expr_recon_loss: 12399495.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38567.8086; val_chrom_access_recon_loss: 4796566.0000; val_global_loss: 20156429.7500; val_optim_loss: 20156429.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9127; val_auprc_score: 0.8852; val_best_acc_score: 0.8447; val_best_f1_score: 0.8578; train_kl_reg_loss: 83857.6661; train_edge_recon_loss: 2793724.0114; train_gene_expr_recon_loss: 12315001.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37906.8825; train_chrom_access_recon_loss: 4720422.0152; train_global_loss: 19950912.4848; train_optim_loss: 19950912.4848; val_kl_reg_loss: 78204.6660; val_edge_recon_loss: 2777705.8438; val_gene_expr_recon_loss: 12433202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37546.2031; val_chrom_access_recon_loss: 4785321.7500; val_global_loss: 20111980.0000; val_optim_loss: 20111980.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9083; val_auprc_score: 0.8778; val_best_acc_score: 0.8431; val_best_f1_score: 0.8530; train_kl_reg_loss: 81590.6567; train_edge_recon_loss: 2781445.4508; train_gene_expr_recon_loss: 12279417.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36888.8920; train_chrom_access_recon_loss: 4708339.6742; train_global_loss: 19887682.5152; train_optim_loss: 19887682.5152; val_kl_reg_loss: 80708.8926; val_edge_recon_loss: 2781240.7188; val_gene_expr_recon_loss: 12361447.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36634.9258; val_chrom_access_recon_loss: 4748845.6250; val_global_loss: 20008876.7500; val_optim_loss: 20008876.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9077; val_auprc_score: 0.8763; val_best_acc_score: 0.8482; val_best_f1_score: 0.8569; train_kl_reg_loss: 79206.6903; train_edge_recon_loss: 2771290.6742; train_gene_expr_recon_loss: 12228626.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36138.1763; train_chrom_access_recon_loss: 4689942.8939; train_global_loss: 19805204.6667; train_optim_loss: 19805204.6667; val_kl_reg_loss: 80155.3408; val_edge_recon_loss: 2812517.7500; val_gene_expr_recon_loss: 12337926.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35839.2578; val_chrom_access_recon_loss: 4712596.6875; val_global_loss: 19979035.2500; val_optim_loss: 19979035.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9142; val_auprc_score: 0.8885; val_best_acc_score: 0.8541; val_best_f1_score: 0.8636; train_kl_reg_loss: 79590.0722; train_edge_recon_loss: 2761161.3864; train_gene_expr_recon_loss: 12206783.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35400.5902; train_chrom_access_recon_loss: 4675145.3939; train_global_loss: 19758080.6364; train_optim_loss: 19758080.6364; val_kl_reg_loss: 81642.1445; val_edge_recon_loss: 2813348.0000; val_gene_expr_recon_loss: 12122128.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35012.3945; val_chrom_access_recon_loss: 4648507.8750; val_global_loss: 19700638.5000; val_optim_loss: 19700638.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9199; val_auprc_score: 0.8950; val_best_acc_score: 0.8536; val_best_f1_score: 0.8636; train_kl_reg_loss: 79535.5348; train_edge_recon_loss: 2758785.8068; train_gene_expr_recon_loss: 12159387.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34754.2008; train_chrom_access_recon_loss: 4663643.3409; train_global_loss: 19696106.7879; train_optim_loss: 19696106.7879; val_kl_reg_loss: 75607.6143; val_edge_recon_loss: 2784593.5625; val_gene_expr_recon_loss: 12248476.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34443.3125; val_chrom_access_recon_loss: 4672806.5000; val_global_loss: 19815927.2500; val_optim_loss: 19815927.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9288; val_auprc_score: 0.9099; val_best_acc_score: 0.8657; val_best_f1_score: 0.8735; train_kl_reg_loss: 77431.3061; train_edge_recon_loss: 2745715.7197; train_gene_expr_recon_loss: 12123219.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34092.4592; train_chrom_access_recon_loss: 4650253.6591; train_global_loss: 19630712.4545; train_optim_loss: 19630712.4545; val_kl_reg_loss: 73623.4844; val_edge_recon_loss: 2763242.7812; val_gene_expr_recon_loss: 12219211.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33967.3711; val_chrom_access_recon_loss: 4705920.0000; val_global_loss: 19795964.2500; val_optim_loss: 19795964.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9215; val_auprc_score: 0.8997; val_best_acc_score: 0.8587; val_best_f1_score: 0.8664; train_kl_reg_loss: 74771.0523; train_edge_recon_loss: 2746655.3182; train_gene_expr_recon_loss: 12097685.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33645.4947; train_chrom_access_recon_loss: 4637084.3788; train_global_loss: 19589842.2727; train_optim_loss: 19589842.2727; val_kl_reg_loss: 75759.0361; val_edge_recon_loss: 2778390.4375; val_gene_expr_recon_loss: 12200661.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33567.7109; val_chrom_access_recon_loss: 4697403.1875; val_global_loss: 19785782.0000; val_optim_loss: 19785782.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9157; val_auprc_score: 0.8876; val_best_acc_score: 0.8549; val_best_f1_score: 0.8685; train_kl_reg_loss: 75580.2029; train_edge_recon_loss: 2738104.2500; train_gene_expr_recon_loss: 12055857.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33420.0230; train_chrom_access_recon_loss: 4622110.0985; train_global_loss: 19525072.7273; train_optim_loss: 19525072.7273; val_kl_reg_loss: 73689.4512; val_edge_recon_loss: 2794565.2188; val_gene_expr_recon_loss: 12091245.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33241.4531; val_chrom_access_recon_loss: 4660072.3125; val_global_loss: 19652813.5000; val_optim_loss: 19652813.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9254; val_auprc_score: 0.9029; val_best_acc_score: 0.8635; val_best_f1_score: 0.8737; train_kl_reg_loss: 74133.5357; train_edge_recon_loss: 2736890.4773; train_gene_expr_recon_loss: 12044708.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33047.5568; train_chrom_access_recon_loss: 4613905.6061; train_global_loss: 19502686.0000; train_optim_loss: 19502686.0000; val_kl_reg_loss: 73844.8564; val_edge_recon_loss: 2749476.5312; val_gene_expr_recon_loss: 12163648.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32740.8027; val_chrom_access_recon_loss: 4661060.0000; val_global_loss: 19680771.0000; val_optim_loss: 19680771.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9319; val_auprc_score: 0.9117; val_best_acc_score: 0.8611; val_best_f1_score: 0.8701; train_kl_reg_loss: 73256.2808; train_edge_recon_loss: 2725002.7311; train_gene_expr_recon_loss: 12021045.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32725.2516; train_chrom_access_recon_loss: 4605001.9773; train_global_loss: 19457031.8485; train_optim_loss: 19457031.8485; val_kl_reg_loss: 70987.6250; val_edge_recon_loss: 2743192.4688; val_gene_expr_recon_loss: 12136552.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32625.5312; val_chrom_access_recon_loss: 4649856.6875; val_global_loss: 19633215.2500; val_optim_loss: 19633215.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9250; val_auprc_score: 0.9004; val_best_acc_score: 0.8616; val_best_f1_score: 0.8694; train_kl_reg_loss: 71832.9485; train_edge_recon_loss: 2726696.9242; train_gene_expr_recon_loss: 11989248.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32477.5924; train_chrom_access_recon_loss: 4595530.0909; train_global_loss: 19415785.7576; train_optim_loss: 19415785.7576; val_kl_reg_loss: 70796.3574; val_edge_recon_loss: 2767510.9375; val_gene_expr_recon_loss: 12089231.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32488.5977; val_chrom_access_recon_loss: 4645433.4375; val_global_loss: 19605461.2500; val_optim_loss: 19605461.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9324; val_auprc_score: 0.9098; val_best_acc_score: 0.8662; val_best_f1_score: 0.8757; train_kl_reg_loss: 71001.3123; train_edge_recon_loss: 2720351.2727; train_gene_expr_recon_loss: 11969954.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32277.5501; train_chrom_access_recon_loss: 4588093.8561; train_global_loss: 19381677.9697; train_optim_loss: 19381677.9697; val_kl_reg_loss: 72083.3311; val_edge_recon_loss: 2725861.2812; val_gene_expr_recon_loss: 11962549.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32294.7168; val_chrom_access_recon_loss: 4600919.9375; val_global_loss: 19393709.0000; val_optim_loss: 19393709.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9276; val_auprc_score: 0.9034; val_best_acc_score: 0.8665; val_best_f1_score: 0.8745; train_kl_reg_loss: 69677.8203; train_edge_recon_loss: 2724111.7121; train_gene_expr_recon_loss: 11955161.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32083.8023; train_chrom_access_recon_loss: 4581092.5303; train_global_loss: 19362127.7273; train_optim_loss: 19362127.7273; val_kl_reg_loss: 66274.1011; val_edge_recon_loss: 2754112.3125; val_gene_expr_recon_loss: 11927809.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32090.4121; val_chrom_access_recon_loss: 4616960.3750; val_global_loss: 19397246.2500; val_optim_loss: 19397246.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9322; val_auprc_score: 0.9081; val_best_acc_score: 0.8681; val_best_f1_score: 0.8765; train_kl_reg_loss: 68088.9891; train_edge_recon_loss: 2716438.6705; train_gene_expr_recon_loss: 11920352.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31965.9523; train_chrom_access_recon_loss: 4568253.4848; train_global_loss: 19305099.0909; train_optim_loss: 19305099.0909; val_kl_reg_loss: 68321.4941; val_edge_recon_loss: 2745484.2812; val_gene_expr_recon_loss: 12031485.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32047.1367; val_chrom_access_recon_loss: 4590562.6875; val_global_loss: 19467901.0000; val_optim_loss: 19467901.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9274; val_auprc_score: 0.9059; val_best_acc_score: 0.8675; val_best_f1_score: 0.8758; train_kl_reg_loss: 67818.5762; train_edge_recon_loss: 2711634.5682; train_gene_expr_recon_loss: 11893534.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31964.1390; train_chrom_access_recon_loss: 4559203.2803; train_global_loss: 19264155.2727; train_optim_loss: 19264155.2727; val_kl_reg_loss: 68383.3379; val_edge_recon_loss: 2742902.9062; val_gene_expr_recon_loss: 11891617.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31961.9141; val_chrom_access_recon_loss: 4566998.3125; val_global_loss: 19301864.5000; val_optim_loss: 19301864.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9353; val_auprc_score: 0.9115; val_best_acc_score: 0.8778; val_best_f1_score: 0.8840; train_kl_reg_loss: 66572.6374; train_edge_recon_loss: 2708559.0455; train_gene_expr_recon_loss: 11878597.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31831.3226; train_chrom_access_recon_loss: 4546854.0076; train_global_loss: 19232414.8485; train_optim_loss: 19232414.8485; val_kl_reg_loss: 65790.0522; val_edge_recon_loss: 2733981.8750; val_gene_expr_recon_loss: 11959245.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31678.4336; val_chrom_access_recon_loss: 4582259.4375; val_global_loss: 19372955.2500; val_optim_loss: 19372955.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9418; val_auprc_score: 0.9209; val_best_acc_score: 0.8861; val_best_f1_score: 0.8913; train_kl_reg_loss: 65702.5765; train_edge_recon_loss: 2707307.8106; train_gene_expr_recon_loss: 11857648.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31649.0534; train_chrom_access_recon_loss: 4538773.4015; train_global_loss: 19201081.6061; train_optim_loss: 19201081.6061; val_kl_reg_loss: 65788.3057; val_edge_recon_loss: 2716425.1250; val_gene_expr_recon_loss: 11923694.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31745.2383; val_chrom_access_recon_loss: 4545446.1250; val_global_loss: 19283098.7500; val_optim_loss: 19283098.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9465; val_auprc_score: 0.9260; val_best_acc_score: 0.8933; val_best_f1_score: 0.8982; train_kl_reg_loss: 65335.6964; train_edge_recon_loss: 2699689.1705; train_gene_expr_recon_loss: 11846899.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31564.3254; train_chrom_access_recon_loss: 4533717.9470; train_global_loss: 19177206.6364; train_optim_loss: 19177206.6364; val_kl_reg_loss: 65519.9072; val_edge_recon_loss: 2712144.9062; val_gene_expr_recon_loss: 11910773.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31436.6875; val_chrom_access_recon_loss: 4581440.2500; val_global_loss: 19301315.5000; val_optim_loss: 19301315.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9425; val_auprc_score: 0.9182; val_best_acc_score: 0.8880; val_best_f1_score: 0.8932; train_kl_reg_loss: 64918.6168; train_edge_recon_loss: 2685913.1705; train_gene_expr_recon_loss: 11811065.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31461.6097; train_chrom_access_recon_loss: 4519634.4924; train_global_loss: 19112993.5758; train_optim_loss: 19112993.5758; val_kl_reg_loss: 64166.9761; val_edge_recon_loss: 2718305.8750; val_gene_expr_recon_loss: 11886207.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31557.4648; val_chrom_access_recon_loss: 4559902.1875; val_global_loss: 19260139.0000; val_optim_loss: 19260139.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9384; val_auprc_score: 0.9131; val_best_acc_score: 0.8823; val_best_f1_score: 0.8908; train_kl_reg_loss: 64017.8496; train_edge_recon_loss: 2688964.7273; train_gene_expr_recon_loss: 11802785.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31540.1464; train_chrom_access_recon_loss: 4520344.7652; train_global_loss: 19107653.3030; train_optim_loss: 19107653.3030; val_kl_reg_loss: 64267.4829; val_edge_recon_loss: 2749571.3438; val_gene_expr_recon_loss: 11855789.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31516.2969; val_chrom_access_recon_loss: 4542475.5625; val_global_loss: 19243619.7500; val_optim_loss: 19243619.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9400; val_auprc_score: 0.9121; val_best_acc_score: 0.8923; val_best_f1_score: 0.8974; train_kl_reg_loss: 63298.4144; train_edge_recon_loss: 2695579.0341; train_gene_expr_recon_loss: 11782147.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31519.7597; train_chrom_access_recon_loss: 4509507.9015; train_global_loss: 19082053.0606; train_optim_loss: 19082053.0606; val_kl_reg_loss: 62535.0518; val_edge_recon_loss: 2706819.9688; val_gene_expr_recon_loss: 11861513.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31738.0547; val_chrom_access_recon_loss: 4541672.8125; val_global_loss: 19204279.7500; val_optim_loss: 19204279.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9467; val_auprc_score: 0.9222; val_best_acc_score: 0.8912; val_best_f1_score: 0.8985; train_kl_reg_loss: 63550.0216; train_edge_recon_loss: 2678213.9242; train_gene_expr_recon_loss: 11768902.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31550.1628; train_chrom_access_recon_loss: 4501279.7803; train_global_loss: 19043496.6667; train_optim_loss: 19043496.6667; val_kl_reg_loss: 63451.8789; val_edge_recon_loss: 2696941.2812; val_gene_expr_recon_loss: 11737850.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31524.8965; val_chrom_access_recon_loss: 4488636.1875; val_global_loss: 19018405.0000; val_optim_loss: 19018405.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9483; val_auprc_score: 0.9271; val_best_acc_score: 0.8992; val_best_f1_score: 0.9031; train_kl_reg_loss: 62158.1832; train_edge_recon_loss: 2683825.4583; train_gene_expr_recon_loss: 11748846.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31483.9264; train_chrom_access_recon_loss: 4493041.1439; train_global_loss: 19019355.6667; train_optim_loss: 19019355.6667; val_kl_reg_loss: 63160.0132; val_edge_recon_loss: 2684124.2188; val_gene_expr_recon_loss: 11733009.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31548.4688; val_chrom_access_recon_loss: 4498087.3750; val_global_loss: 19009929.2500; val_optim_loss: 19009929.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9417; val_auprc_score: 0.9173; val_best_acc_score: 0.8912; val_best_f1_score: 0.8971; train_kl_reg_loss: 62439.9889; train_edge_recon_loss: 2681063.8712; train_gene_expr_recon_loss: 11728639.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31431.5461; train_chrom_access_recon_loss: 4480518.4091; train_global_loss: 18984092.7879; train_optim_loss: 18984092.7879; val_kl_reg_loss: 62540.9028; val_edge_recon_loss: 2706917.0938; val_gene_expr_recon_loss: 11835580.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31555.8281; val_chrom_access_recon_loss: 4520010.4375; val_global_loss: 19156604.7500; val_optim_loss: 19156604.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9482; val_auprc_score: 0.9320; val_best_acc_score: 0.8893; val_best_f1_score: 0.8945; train_kl_reg_loss: 61165.2036; train_edge_recon_loss: 2683811.1591; train_gene_expr_recon_loss: 11717787.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31572.6429; train_chrom_access_recon_loss: 4471410.2879; train_global_loss: 18965746.4545; train_optim_loss: 18965746.4545; val_kl_reg_loss: 63257.8159; val_edge_recon_loss: 2741437.3438; val_gene_expr_recon_loss: 11870138.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31546.8105; val_chrom_access_recon_loss: 4554960.3125; val_global_loss: 19261341.0000; val_optim_loss: 19261341.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9509; val_auprc_score: 0.9350; val_best_acc_score: 0.8941; val_best_f1_score: 0.8976; train_kl_reg_loss: 61719.2498; train_edge_recon_loss: 2683725.0758; train_gene_expr_recon_loss: 11706709.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31532.2704; train_chrom_access_recon_loss: 4468371.2386; train_global_loss: 18952057.3030; train_optim_loss: 18952057.3030; val_kl_reg_loss: 58963.9629; val_edge_recon_loss: 2719891.0000; val_gene_expr_recon_loss: 11755587.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31534.2441; val_chrom_access_recon_loss: 4557594.3125; val_global_loss: 19123570.7500; val_optim_loss: 19123570.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9485; val_auprc_score: 0.9290; val_best_acc_score: 0.8952; val_best_f1_score: 0.8986; train_kl_reg_loss: 60260.0729; train_edge_recon_loss: 2675697.7273; train_gene_expr_recon_loss: 11688681.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31567.6412; train_chrom_access_recon_loss: 4458751.8523; train_global_loss: 18914958.4242; train_optim_loss: 18914958.4242; val_kl_reg_loss: 61474.3223; val_edge_recon_loss: 2708205.0312; val_gene_expr_recon_loss: 11781123.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31676.2090; val_chrom_access_recon_loss: 4482311.8125; val_global_loss: 19064790.2500; val_optim_loss: 19064790.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9474; val_auprc_score: 0.9261; val_best_acc_score: 0.8963; val_best_f1_score: 0.9002; train_kl_reg_loss: 61196.8662; train_edge_recon_loss: 2666988.4735; train_gene_expr_recon_loss: 11666745.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27599.9649; train_chrom_access_recon_loss: 4451865.1364; train_global_loss: 18874395.6970; train_optim_loss: 18874395.6970; val_kl_reg_loss: 61885.3472; val_edge_recon_loss: 2698546.6250; val_gene_expr_recon_loss: 11698888.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26360.9258; val_chrom_access_recon_loss: 4479988.9062; val_global_loss: 18965670.0000; val_optim_loss: 18965670.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9477; val_auprc_score: 0.9297; val_best_acc_score: 0.8917; val_best_f1_score: 0.8963; train_kl_reg_loss: 61581.0458; train_edge_recon_loss: 2674792.2992; train_gene_expr_recon_loss: 11657207.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26199.6610; train_chrom_access_recon_loss: 4445719.0909; train_global_loss: 18865499.9394; train_optim_loss: 18865499.9394; val_kl_reg_loss: 62504.9922; val_edge_recon_loss: 2707932.1562; val_gene_expr_recon_loss: 11748544.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26072.5156; val_chrom_access_recon_loss: 4518625.0000; val_global_loss: 19063679.2500; val_optim_loss: 19063679.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9470; val_auprc_score: 0.9205; val_best_acc_score: 0.8982; val_best_f1_score: 0.9019; train_kl_reg_loss: 62375.0997; train_edge_recon_loss: 2671208.9508; train_gene_expr_recon_loss: 11663333.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26000.5829; train_chrom_access_recon_loss: 4449671.1629; train_global_loss: 18872589.6970; train_optim_loss: 18872589.6970; val_kl_reg_loss: 63076.6250; val_edge_recon_loss: 2718193.7812; val_gene_expr_recon_loss: 11661335.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25939.0312; val_chrom_access_recon_loss: 4471051.5625; val_global_loss: 18939596.5000; val_optim_loss: 18939596.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9492; val_auprc_score: 0.9329; val_best_acc_score: 0.8982; val_best_f1_score: 0.9019; train_kl_reg_loss: 62656.2802; train_edge_recon_loss: 2672514.7462; train_gene_expr_recon_loss: 11656311.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25899.0985; train_chrom_access_recon_loss: 4443857.0947; train_global_loss: 18861238.3333; train_optim_loss: 18861238.3333; val_kl_reg_loss: 62675.2686; val_edge_recon_loss: 2698556.6562; val_gene_expr_recon_loss: 11822667.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25860.7812; val_chrom_access_recon_loss: 4486294.8125; val_global_loss: 19096055.7500; val_optim_loss: 19096055.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9477; val_auprc_score: 0.9207; val_best_acc_score: 0.8982; val_best_f1_score: 0.9026; train_kl_reg_loss: 62305.4912; train_edge_recon_loss: 2671382.0682; train_gene_expr_recon_loss: 11647394.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25828.0348; train_chrom_access_recon_loss: 4441798.0303; train_global_loss: 18848708.3030; train_optim_loss: 18848708.3030; val_kl_reg_loss: 62973.2056; val_edge_recon_loss: 2707222.2500; val_gene_expr_recon_loss: 11732417.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25803.2539; val_chrom_access_recon_loss: 4490012.5000; val_global_loss: 19018428.2500; val_optim_loss: 19018428.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9602; val_auprc_score: 0.9456; val_best_acc_score: 0.9084; val_best_f1_score: 0.9097; train_kl_reg_loss: 62112.0682; train_edge_recon_loss: 2688190.4621; train_gene_expr_recon_loss: 11651042.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25776.8705; train_chrom_access_recon_loss: 4437724.8598; train_global_loss: 18864846.7879; train_optim_loss: 18864846.7879; val_kl_reg_loss: 61944.6763; val_edge_recon_loss: 2710374.0625; val_gene_expr_recon_loss: 11747426.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25747.5820; val_chrom_access_recon_loss: 4508981.6250; val_global_loss: 19054475.5000; val_optim_loss: 19054475.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9495; val_auprc_score: 0.9305; val_best_acc_score: 0.9014; val_best_f1_score: 0.9048; train_kl_reg_loss: 61986.6780; train_edge_recon_loss: 2665649.3030; train_gene_expr_recon_loss: 11658849.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25718.7631; train_chrom_access_recon_loss: 4443412.6364; train_global_loss: 18855616.5758; train_optim_loss: 18855616.5758; val_kl_reg_loss: 62493.4155; val_edge_recon_loss: 2693965.8438; val_gene_expr_recon_loss: 11746489.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25710.5410; val_chrom_access_recon_loss: 4490911.3125; val_global_loss: 19019571.7500; val_optim_loss: 19019571.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9479; val_auprc_score: 0.9270; val_best_acc_score: 0.8963; val_best_f1_score: 0.9004; train_kl_reg_loss: 62457.6557; train_edge_recon_loss: 2680240.5417; train_gene_expr_recon_loss: 11643004.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25310.9543; train_chrom_access_recon_loss: 4437873.4280; train_global_loss: 18848887.5152; train_optim_loss: 18848887.5152; val_kl_reg_loss: 62948.7173; val_edge_recon_loss: 2707264.0312; val_gene_expr_recon_loss: 11826249.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25193.7129; val_chrom_access_recon_loss: 4515574.9375; val_global_loss: 19137231.5000; val_optim_loss: 19137231.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9525; val_auprc_score: 0.9329; val_best_acc_score: 0.9030; val_best_f1_score: 0.9056; train_kl_reg_loss: 62445.4126; train_edge_recon_loss: 2672099.8030; train_gene_expr_recon_loss: 11654939.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25175.6329; train_chrom_access_recon_loss: 4446962.8750; train_global_loss: 18861623.0303; train_optim_loss: 18861623.0303; val_kl_reg_loss: 62844.3833; val_edge_recon_loss: 2692647.4688; val_gene_expr_recon_loss: 11854890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25163.0684; val_chrom_access_recon_loss: 4467712.9375; val_global_loss: 19103258.0000; val_optim_loss: 19103258.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9509; val_auprc_score: 0.9304; val_best_acc_score: 0.8976; val_best_f1_score: 0.9018; train_kl_reg_loss: 62377.2757; train_edge_recon_loss: 2666227.1136; train_gene_expr_recon_loss: 11642048.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25154.1698; train_chrom_access_recon_loss: 4438466.9697; train_global_loss: 18834273.5758; train_optim_loss: 18834273.5758; val_kl_reg_loss: 62358.4946; val_edge_recon_loss: 2706980.4375; val_gene_expr_recon_loss: 11783265.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25147.0879; val_chrom_access_recon_loss: 4502679.8750; val_global_loss: 19080431.5000; val_optim_loss: 19080431.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9546; val_auprc_score: 0.9383; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 62337.1887; train_edge_recon_loss: 2675784.2652; train_gene_expr_recon_loss: 11651035.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25140.7093; train_chrom_access_recon_loss: 4441554.6477; train_global_loss: 18855852.6667; train_optim_loss: 18855852.6667; val_kl_reg_loss: 62422.0684; val_edge_recon_loss: 2699046.7812; val_gene_expr_recon_loss: 11742215.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25136.1484; val_chrom_access_recon_loss: 4510760.4375; val_global_loss: 19039580.5000; val_optim_loss: 19039580.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 24 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9507
val AUPRC score: 0.9365
val best accuracy score: 0.8949
val best F1 score: 0.8993
val target rna MSE score: 0.9436
val source rna MSE score: 0.2622
val target atac MSE score: 0.4848
val source atac MSE score: 0.1030
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
