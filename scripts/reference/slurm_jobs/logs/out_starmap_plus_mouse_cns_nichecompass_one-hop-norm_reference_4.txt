Run timestamp: 20062023_155323_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '20', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 20, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 20, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8962; val_auprc_score: 0.9859; val_best_acc_score: 0.9598; val_best_f1_score: 0.9784; train_kl_reg_loss: 4921.9618; train_edge_recon_loss: 45239.4818; train_cond_contrastive_loss: 80234.0540; train_gene_expr_recon_loss: 118103.2027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248498.7003; train_optim_loss: 248498.7003; val_kl_reg_loss: 4570.5249; val_edge_recon_loss: 41684.7712; val_cond_contrastive_loss: 79134.1851; val_gene_expr_recon_loss: 106462.6222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231852.1035; val_optim_loss: 231852.1035
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9091; val_auprc_score: 0.9868; val_best_acc_score: 0.9691; val_best_f1_score: 0.9834; train_kl_reg_loss: 4781.7142; train_edge_recon_loss: 41349.3860; train_cond_contrastive_loss: 79582.1821; train_gene_expr_recon_loss: 103647.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229360.7612; train_optim_loss: 229360.7612; val_kl_reg_loss: 4785.8298; val_edge_recon_loss: 40992.2851; val_cond_contrastive_loss: 79150.8811; val_gene_expr_recon_loss: 101097.7438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226026.7397; val_optim_loss: 226026.7397
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9128; val_auprc_score: 0.9874; val_best_acc_score: 0.9689; val_best_f1_score: 0.9833; train_kl_reg_loss: 4973.0354; train_edge_recon_loss: 40933.8738; train_cond_contrastive_loss: 79686.9487; train_gene_expr_recon_loss: 99389.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224983.4026; train_optim_loss: 224983.4026; val_kl_reg_loss: 4982.7909; val_edge_recon_loss: 40751.5243; val_cond_contrastive_loss: 79308.5527; val_gene_expr_recon_loss: 97708.9738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222751.8403; val_optim_loss: 222751.8403
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9101; val_auprc_score: 0.9870; val_best_acc_score: 0.9698; val_best_f1_score: 0.9838; train_kl_reg_loss: 5196.3948; train_edge_recon_loss: 40721.2774; train_cond_contrastive_loss: 79797.0667; train_gene_expr_recon_loss: 96602.9109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222317.6497; train_optim_loss: 222317.6497; val_kl_reg_loss: 5294.3499; val_edge_recon_loss: 40769.2131; val_cond_contrastive_loss: 79445.5381; val_gene_expr_recon_loss: 95436.6162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220945.7190; val_optim_loss: 220945.7190
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9091; val_auprc_score: 0.9865; val_best_acc_score: 0.9690; val_best_f1_score: 0.9834; train_kl_reg_loss: 5367.7763; train_edge_recon_loss: 40634.8341; train_cond_contrastive_loss: 79853.7957; train_gene_expr_recon_loss: 94869.3970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220725.8030; train_optim_loss: 220725.8030; val_kl_reg_loss: 5266.9166; val_edge_recon_loss: 41251.1019; val_cond_contrastive_loss: 79493.3214; val_gene_expr_recon_loss: 93977.0858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219988.4243; val_optim_loss: 219988.4243
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9079; val_auprc_score: 0.9865; val_best_acc_score: 0.9700; val_best_f1_score: 0.9839; train_kl_reg_loss: 5469.8069; train_edge_recon_loss: 40539.7744; train_cond_contrastive_loss: 79860.5499; train_gene_expr_recon_loss: 93650.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219520.6067; train_optim_loss: 219520.6067; val_kl_reg_loss: 5334.2575; val_edge_recon_loss: 40972.0592; val_cond_contrastive_loss: 79548.3989; val_gene_expr_recon_loss: 93109.6628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218964.3794; val_optim_loss: 218964.3794
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9142; val_auprc_score: 0.9875; val_best_acc_score: 0.9690; val_best_f1_score: 0.9833; train_kl_reg_loss: 5556.3554; train_edge_recon_loss: 40576.7553; train_cond_contrastive_loss: 79857.7622; train_gene_expr_recon_loss: 92817.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218808.3480; train_optim_loss: 218808.3480; val_kl_reg_loss: 5409.2603; val_edge_recon_loss: 40855.4522; val_cond_contrastive_loss: 79551.0531; val_gene_expr_recon_loss: 92241.8969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218057.6619; val_optim_loss: 218057.6619
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9174; val_auprc_score: 0.9879; val_best_acc_score: 0.9687; val_best_f1_score: 0.9832; train_kl_reg_loss: 5625.1135; train_edge_recon_loss: 40524.6945; train_cond_contrastive_loss: 79843.3586; train_gene_expr_recon_loss: 92139.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218132.5370; train_optim_loss: 218132.5370; val_kl_reg_loss: 5504.6229; val_edge_recon_loss: 41064.5774; val_cond_contrastive_loss: 79559.0684; val_gene_expr_recon_loss: 91699.9337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217828.2019; val_optim_loss: 217828.2019
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9136; val_auprc_score: 0.9873; val_best_acc_score: 0.9704; val_best_f1_score: 0.9841; train_kl_reg_loss: 5679.5455; train_edge_recon_loss: 40421.1979; train_cond_contrastive_loss: 79825.9702; train_gene_expr_recon_loss: 91619.6177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217546.3315; train_optim_loss: 217546.3315; val_kl_reg_loss: 5593.9481; val_edge_recon_loss: 40651.3354; val_cond_contrastive_loss: 79481.6233; val_gene_expr_recon_loss: 91265.3877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216992.2959; val_optim_loss: 216992.2959
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9158; val_auprc_score: 0.9877; val_best_acc_score: 0.9709; val_best_f1_score: 0.9844; train_kl_reg_loss: 5724.7897; train_edge_recon_loss: 40524.9588; train_cond_contrastive_loss: 79807.0824; train_gene_expr_recon_loss: 91156.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217213.6179; train_optim_loss: 217213.6179; val_kl_reg_loss: 5570.9546; val_edge_recon_loss: 40614.2045; val_cond_contrastive_loss: 79522.2394; val_gene_expr_recon_loss: 90854.2277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216561.6252; val_optim_loss: 216561.6252
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9172; val_auprc_score: 0.9879; val_best_acc_score: 0.9694; val_best_f1_score: 0.9835; train_kl_reg_loss: 5761.9630; train_edge_recon_loss: 40588.9367; train_cond_contrastive_loss: 79786.2947; train_gene_expr_recon_loss: 90840.2972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216977.4919; train_optim_loss: 216977.4919; val_kl_reg_loss: 5616.0496; val_edge_recon_loss: 40707.3423; val_cond_contrastive_loss: 79511.8672; val_gene_expr_recon_loss: 90474.9518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216310.2117; val_optim_loss: 216310.2117
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9150; val_auprc_score: 0.9876; val_best_acc_score: 0.9704; val_best_f1_score: 0.9841; train_kl_reg_loss: 5789.2638; train_edge_recon_loss: 40528.6415; train_cond_contrastive_loss: 79759.6333; train_gene_expr_recon_loss: 90570.8240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216648.3624; train_optim_loss: 216648.3624; val_kl_reg_loss: 5633.3716; val_edge_recon_loss: 40475.1035; val_cond_contrastive_loss: 79442.5557; val_gene_expr_recon_loss: 90288.2660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215839.2974; val_optim_loss: 215839.2974
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9148; val_auprc_score: 0.9875; val_best_acc_score: 0.9708; val_best_f1_score: 0.9843; train_kl_reg_loss: 5812.1158; train_edge_recon_loss: 40436.4359; train_cond_contrastive_loss: 79737.6491; train_gene_expr_recon_loss: 90316.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216303.0101; train_optim_loss: 216303.0101; val_kl_reg_loss: 5850.9522; val_edge_recon_loss: 40690.0927; val_cond_contrastive_loss: 79368.9719; val_gene_expr_recon_loss: 90040.4452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215950.4619; val_optim_loss: 215950.4619
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9150; val_auprc_score: 0.9875; val_best_acc_score: 0.9709; val_best_f1_score: 0.9843; train_kl_reg_loss: 5831.0461; train_edge_recon_loss: 40323.1707; train_cond_contrastive_loss: 79719.6049; train_gene_expr_recon_loss: 90097.0105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215970.8320; train_optim_loss: 215970.8320; val_kl_reg_loss: 5651.0053; val_edge_recon_loss: 40815.8626; val_cond_contrastive_loss: 79466.2787; val_gene_expr_recon_loss: 89819.8496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215752.9961; val_optim_loss: 215752.9961
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9130; val_auprc_score: 0.9871; val_best_acc_score: 0.9709; val_best_f1_score: 0.9844; train_kl_reg_loss: 5847.7899; train_edge_recon_loss: 40485.5719; train_cond_contrastive_loss: 79703.5689; train_gene_expr_recon_loss: 89942.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215979.7974; train_optim_loss: 215979.7974; val_kl_reg_loss: 5743.2157; val_edge_recon_loss: 40654.8699; val_cond_contrastive_loss: 79408.9761; val_gene_expr_recon_loss: 89783.5006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215590.5605; val_optim_loss: 215590.5605
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9177; val_auprc_score: 0.9879; val_best_acc_score: 0.9718; val_best_f1_score: 0.9848; train_kl_reg_loss: 5866.0487; train_edge_recon_loss: 40344.5249; train_cond_contrastive_loss: 79682.2741; train_gene_expr_recon_loss: 89803.6883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215696.5365; train_optim_loss: 215696.5365; val_kl_reg_loss: 5774.4393; val_edge_recon_loss: 40658.9242; val_cond_contrastive_loss: 79383.3654; val_gene_expr_recon_loss: 89626.3335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215443.0618; val_optim_loss: 215443.0618
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9144; val_auprc_score: 0.9874; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 5879.7937; train_edge_recon_loss: 40340.9666; train_cond_contrastive_loss: 79668.8036; train_gene_expr_recon_loss: 89692.1351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215581.6985; train_optim_loss: 215581.6985; val_kl_reg_loss: 5863.3711; val_edge_recon_loss: 40496.6285; val_cond_contrastive_loss: 79351.8484; val_gene_expr_recon_loss: 89458.3577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215170.2051; val_optim_loss: 215170.2051
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9169; val_auprc_score: 0.9877; val_best_acc_score: 0.9701; val_best_f1_score: 0.9839; train_kl_reg_loss: 5889.1022; train_edge_recon_loss: 40246.8448; train_cond_contrastive_loss: 79650.5874; train_gene_expr_recon_loss: 89567.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215354.0271; train_optim_loss: 215354.0271; val_kl_reg_loss: 5816.2620; val_edge_recon_loss: 40802.2949; val_cond_contrastive_loss: 79345.8950; val_gene_expr_recon_loss: 89408.4962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215372.9480; val_optim_loss: 215372.9480
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9171; val_auprc_score: 0.9876; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 5900.8414; train_edge_recon_loss: 40281.4469; train_cond_contrastive_loss: 79641.4840; train_gene_expr_recon_loss: 89449.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215272.8391; train_optim_loss: 215272.8391; val_kl_reg_loss: 5838.5262; val_edge_recon_loss: 40840.8292; val_cond_contrastive_loss: 79323.9578; val_gene_expr_recon_loss: 89326.3613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215329.6733; val_optim_loss: 215329.6733
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9161; val_auprc_score: 0.9875; val_best_acc_score: 0.9720; val_best_f1_score: 0.9849; train_kl_reg_loss: 5907.6727; train_edge_recon_loss: 40093.1722; train_cond_contrastive_loss: 79626.6979; train_gene_expr_recon_loss: 89355.3745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214982.9174; train_optim_loss: 214982.9174; val_kl_reg_loss: 5774.5902; val_edge_recon_loss: 40468.3632; val_cond_contrastive_loss: 79361.1847; val_gene_expr_recon_loss: 89320.8175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214924.9561; val_optim_loss: 214924.9561
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9177; val_auprc_score: 0.9877; val_best_acc_score: 0.9719; val_best_f1_score: 0.9849; train_kl_reg_loss: 5919.7057; train_edge_recon_loss: 40265.5265; train_cond_contrastive_loss: 79615.7799; train_gene_expr_recon_loss: 89295.1856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215096.1979; train_optim_loss: 215096.1979; val_kl_reg_loss: 5818.8453; val_edge_recon_loss: 40656.6046; val_cond_contrastive_loss: 79306.9370; val_gene_expr_recon_loss: 89246.9441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215029.3296; val_optim_loss: 215029.3296
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9191; val_auprc_score: 0.9881; val_best_acc_score: 0.9715; val_best_f1_score: 0.9847; train_kl_reg_loss: 5926.7832; train_edge_recon_loss: 40155.6334; train_cond_contrastive_loss: 79603.7221; train_gene_expr_recon_loss: 89211.1292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214897.2677; train_optim_loss: 214897.2677; val_kl_reg_loss: 5731.0296; val_edge_recon_loss: 40332.9475; val_cond_contrastive_loss: 79369.1495; val_gene_expr_recon_loss: 89100.2600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214533.3870; val_optim_loss: 214533.3870
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9172; val_auprc_score: 0.9879; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 5932.1922; train_edge_recon_loss: 40374.4347; train_cond_contrastive_loss: 79596.3894; train_gene_expr_recon_loss: 89107.3252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215010.3416; train_optim_loss: 215010.3416; val_kl_reg_loss: 5965.7196; val_edge_recon_loss: 39829.7620; val_cond_contrastive_loss: 79252.2343; val_gene_expr_recon_loss: 89026.2780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214073.9934; val_optim_loss: 214073.9934
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9156; val_auprc_score: 0.9876; val_best_acc_score: 0.9710; val_best_f1_score: 0.9844; train_kl_reg_loss: 5943.7366; train_edge_recon_loss: 40254.1450; train_cond_contrastive_loss: 79582.7822; train_gene_expr_recon_loss: 89086.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214866.6762; train_optim_loss: 214866.6762; val_kl_reg_loss: 5812.9563; val_edge_recon_loss: 40504.1601; val_cond_contrastive_loss: 79346.5935; val_gene_expr_recon_loss: 88967.8207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214631.5305; val_optim_loss: 214631.5305
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9196; val_auprc_score: 0.9883; val_best_acc_score: 0.9718; val_best_f1_score: 0.9849; train_kl_reg_loss: 5947.6590; train_edge_recon_loss: 40236.4761; train_cond_contrastive_loss: 79575.9459; train_gene_expr_recon_loss: 89017.7440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214777.8248; train_optim_loss: 214777.8248; val_kl_reg_loss: 5870.0570; val_edge_recon_loss: 39906.7778; val_cond_contrastive_loss: 79282.2936; val_gene_expr_recon_loss: 88955.6147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214014.7422; val_optim_loss: 214014.7422
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9158; val_auprc_score: 0.9875; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 5416.1691; train_edge_recon_loss: 40133.0866; train_cond_contrastive_loss: 79560.9402; train_gene_expr_recon_loss: 88955.7362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214065.9324; train_optim_loss: 214065.9324; val_kl_reg_loss: 5082.7666; val_edge_recon_loss: 40311.8651; val_cond_contrastive_loss: 79369.4528; val_gene_expr_recon_loss: 88981.5332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213745.6174; val_optim_loss: 213745.6174
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9174; val_auprc_score: 0.9877; val_best_acc_score: 0.9716; val_best_f1_score: 0.9847; train_kl_reg_loss: 5324.4991; train_edge_recon_loss: 40037.8491; train_cond_contrastive_loss: 79514.9874; train_gene_expr_recon_loss: 88905.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213782.8031; train_optim_loss: 213782.8031; val_kl_reg_loss: 5114.8794; val_edge_recon_loss: 40676.7107; val_cond_contrastive_loss: 79369.2269; val_gene_expr_recon_loss: 88888.5481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214049.3660; val_optim_loss: 214049.3660
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9175; val_auprc_score: 0.9878; val_best_acc_score: 0.9708; val_best_f1_score: 0.9843; train_kl_reg_loss: 5300.6254; train_edge_recon_loss: 40112.1767; train_cond_contrastive_loss: 79496.4221; train_gene_expr_recon_loss: 88850.4772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213759.7017; train_optim_loss: 213759.7017; val_kl_reg_loss: 5114.1467; val_edge_recon_loss: 40391.7680; val_cond_contrastive_loss: 79347.4595; val_gene_expr_recon_loss: 88876.3705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213729.7441; val_optim_loss: 213729.7441
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9184; val_auprc_score: 0.9878; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 5290.8132; train_edge_recon_loss: 39988.8000; train_cond_contrastive_loss: 79481.9654; train_gene_expr_recon_loss: 88814.7351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213576.3138; train_optim_loss: 213576.3138; val_kl_reg_loss: 5229.6387; val_edge_recon_loss: 40658.4823; val_cond_contrastive_loss: 79313.7260; val_gene_expr_recon_loss: 88760.2238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213962.0710; val_optim_loss: 213962.0710
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9167; val_auprc_score: 0.9875; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 5283.2874; train_edge_recon_loss: 39981.4166; train_cond_contrastive_loss: 79476.9130; train_gene_expr_recon_loss: 88785.5657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213527.1828; train_optim_loss: 213527.1828; val_kl_reg_loss: 5207.9474; val_edge_recon_loss: 40734.8237; val_cond_contrastive_loss: 79225.6882; val_gene_expr_recon_loss: 88754.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213923.0815; val_optim_loss: 213923.0815
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9172; val_auprc_score: 0.9878; val_best_acc_score: 0.9721; val_best_f1_score: 0.9850; train_kl_reg_loss: 5267.0153; train_edge_recon_loss: 39906.3352; train_cond_contrastive_loss: 79463.5440; train_gene_expr_recon_loss: 88770.2205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213407.1148; train_optim_loss: 213407.1148; val_kl_reg_loss: 5240.3990; val_edge_recon_loss: 40189.3468; val_cond_contrastive_loss: 79219.0792; val_gene_expr_recon_loss: 88780.4656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213429.2896; val_optim_loss: 213429.2896
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9166; val_auprc_score: 0.9876; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 5261.1805; train_edge_recon_loss: 40094.7080; train_cond_contrastive_loss: 79456.4081; train_gene_expr_recon_loss: 88722.2929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213534.5896; train_optim_loss: 213534.5896; val_kl_reg_loss: 5138.4104; val_edge_recon_loss: 40464.1382; val_cond_contrastive_loss: 79226.9592; val_gene_expr_recon_loss: 88807.7531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213637.2610; val_optim_loss: 213637.2610
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9181; val_auprc_score: 0.9878; val_best_acc_score: 0.9713; val_best_f1_score: 0.9846; train_kl_reg_loss: 5241.4213; train_edge_recon_loss: 40071.5659; train_cond_contrastive_loss: 79444.2699; train_gene_expr_recon_loss: 88707.2400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213464.4972; train_optim_loss: 213464.4972; val_kl_reg_loss: 5060.6374; val_edge_recon_loss: 40572.8851; val_cond_contrastive_loss: 79333.2610; val_gene_expr_recon_loss: 88676.4092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213643.1924; val_optim_loss: 213643.1924
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9179; val_auprc_score: 0.9878; val_best_acc_score: 0.9725; val_best_f1_score: 0.9852; train_kl_reg_loss: 5239.1560; train_edge_recon_loss: 40007.3678; train_cond_contrastive_loss: 79436.6766; train_gene_expr_recon_loss: 88677.0028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213360.2035; train_optim_loss: 213360.2035; val_kl_reg_loss: 5127.8738; val_edge_recon_loss: 40431.0611; val_cond_contrastive_loss: 79219.3843; val_gene_expr_recon_loss: 88732.9183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213511.2371; val_optim_loss: 213511.2371

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9176; val_auprc_score: 0.9877; val_best_acc_score: 0.9729; val_best_f1_score: 0.9854; train_kl_reg_loss: 5217.4609; train_edge_recon_loss: 39994.3422; train_cond_contrastive_loss: 79448.0210; train_gene_expr_recon_loss: 88199.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212858.8422; train_optim_loss: 212858.8422; val_kl_reg_loss: 5088.8449; val_edge_recon_loss: 40536.9514; val_cond_contrastive_loss: 79272.1229; val_gene_expr_recon_loss: 88272.0055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213169.9253; val_optim_loss: 213169.9253
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9198; val_auprc_score: 0.9881; val_best_acc_score: 0.9720; val_best_f1_score: 0.9849; train_kl_reg_loss: 5206.2647; train_edge_recon_loss: 40020.5329; train_cond_contrastive_loss: 79444.5607; train_gene_expr_recon_loss: 88141.9894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212813.3482; train_optim_loss: 212813.3482; val_kl_reg_loss: 5102.4273; val_edge_recon_loss: 40501.2227; val_cond_contrastive_loss: 79257.2990; val_gene_expr_recon_loss: 88253.1416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213114.0903; val_optim_loss: 213114.0903
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9195; val_auprc_score: 0.9879; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 5205.4206; train_edge_recon_loss: 39873.1220; train_cond_contrastive_loss: 79433.4097; train_gene_expr_recon_loss: 88110.8826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212622.8348; train_optim_loss: 212622.8348; val_kl_reg_loss: 5114.3791; val_edge_recon_loss: 40488.1221; val_cond_contrastive_loss: 79242.3204; val_gene_expr_recon_loss: 88257.6788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213102.5010; val_optim_loss: 213102.5010
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9176; val_auprc_score: 0.9877; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 5200.5857; train_edge_recon_loss: 39728.0409; train_cond_contrastive_loss: 79429.6428; train_gene_expr_recon_loss: 88129.1915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212487.4610; train_optim_loss: 212487.4610; val_kl_reg_loss: 5096.1443; val_edge_recon_loss: 40302.5196; val_cond_contrastive_loss: 79255.5968; val_gene_expr_recon_loss: 88328.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212982.5559; val_optim_loss: 212982.5559
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9168; val_auprc_score: 0.9875; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 5200.0623; train_edge_recon_loss: 39938.5830; train_cond_contrastive_loss: 79427.3211; train_gene_expr_recon_loss: 88097.3498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212663.3159; train_optim_loss: 212663.3159; val_kl_reg_loss: 5096.5160; val_edge_recon_loss: 40534.2755; val_cond_contrastive_loss: 79256.0157; val_gene_expr_recon_loss: 88271.7417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213158.5491; val_optim_loss: 213158.5491
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9155; val_auprc_score: 0.9872; val_best_acc_score: 0.9726; val_best_f1_score: 0.9852; train_kl_reg_loss: 5200.4148; train_edge_recon_loss: 40018.7280; train_cond_contrastive_loss: 79421.2432; train_gene_expr_recon_loss: 88087.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212728.2583; train_optim_loss: 212728.2583; val_kl_reg_loss: 5099.3271; val_edge_recon_loss: 40707.0021; val_cond_contrastive_loss: 79249.0187; val_gene_expr_recon_loss: 88265.6948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213321.0435; val_optim_loss: 213321.0435
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9180; val_auprc_score: 0.9876; val_best_acc_score: 0.9727; val_best_f1_score: 0.9853; train_kl_reg_loss: 5195.4669; train_edge_recon_loss: 39881.7080; train_cond_contrastive_loss: 79418.5947; train_gene_expr_recon_loss: 88074.4411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212570.2106; train_optim_loss: 212570.2106; val_kl_reg_loss: 5128.9100; val_edge_recon_loss: 40713.3312; val_cond_contrastive_loss: 79212.7776; val_gene_expr_recon_loss: 88308.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213363.7981; val_optim_loss: 213363.7981

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9197; val_auprc_score: 0.9881; val_best_acc_score: 0.9729; val_best_f1_score: 0.9854; train_kl_reg_loss: 5198.7250; train_edge_recon_loss: 40103.7595; train_cond_contrastive_loss: 79417.5901; train_gene_expr_recon_loss: 88005.6540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212725.7284; train_optim_loss: 212725.7284; val_kl_reg_loss: 5089.6537; val_edge_recon_loss: 40085.8234; val_cond_contrastive_loss: 79250.7050; val_gene_expr_recon_loss: 88128.2429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212554.4246; val_optim_loss: 212554.4246
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9166; val_auprc_score: 0.9874; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 5195.7051; train_edge_recon_loss: 40018.1241; train_cond_contrastive_loss: 79418.8686; train_gene_expr_recon_loss: 87996.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212629.4723; train_optim_loss: 212629.4723; val_kl_reg_loss: 5096.8722; val_edge_recon_loss: 40859.9837; val_cond_contrastive_loss: 79240.9576; val_gene_expr_recon_loss: 88099.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213297.2568; val_optim_loss: 213297.2568
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9176; val_auprc_score: 0.9876; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 5200.7610; train_edge_recon_loss: 39989.8899; train_cond_contrastive_loss: 79418.8786; train_gene_expr_recon_loss: 88011.3044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212620.8335; train_optim_loss: 212620.8335; val_kl_reg_loss: 5103.7421; val_edge_recon_loss: 40619.8376; val_cond_contrastive_loss: 79239.0880; val_gene_expr_recon_loss: 88209.4679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213172.1365; val_optim_loss: 213172.1365
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9164; val_auprc_score: 0.9873; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 5195.0513; train_edge_recon_loss: 39972.5436; train_cond_contrastive_loss: 79419.8698; train_gene_expr_recon_loss: 87966.7997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212554.2640; train_optim_loss: 212554.2640; val_kl_reg_loss: 5108.4157; val_edge_recon_loss: 40798.7710; val_cond_contrastive_loss: 79239.6512; val_gene_expr_recon_loss: 88183.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213330.4597; val_optim_loss: 213330.4597

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9156; val_auprc_score: 0.9873; val_best_acc_score: 0.9725; val_best_f1_score: 0.9852; train_kl_reg_loss: 5199.2016; train_edge_recon_loss: 39937.6018; train_cond_contrastive_loss: 79417.7129; train_gene_expr_recon_loss: 87980.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212534.8160; train_optim_loss: 212534.8160; val_kl_reg_loss: 5098.2950; val_edge_recon_loss: 40612.6309; val_cond_contrastive_loss: 79244.4335; val_gene_expr_recon_loss: 88214.8098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213170.1707; val_optim_loss: 213170.1707
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9184; val_auprc_score: 0.9880; val_best_acc_score: 0.9731; val_best_f1_score: 0.9855; train_kl_reg_loss: 5197.3483; train_edge_recon_loss: 39961.3487; train_cond_contrastive_loss: 79418.8473; train_gene_expr_recon_loss: 87984.5192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212562.0637; train_optim_loss: 212562.0637; val_kl_reg_loss: 5101.0200; val_edge_recon_loss: 40082.9104; val_cond_contrastive_loss: 79240.3947; val_gene_expr_recon_loss: 88167.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212592.2224; val_optim_loss: 212592.2224
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9179; val_auprc_score: 0.9877; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 5197.0249; train_edge_recon_loss: 39992.2288; train_cond_contrastive_loss: 79419.3069; train_gene_expr_recon_loss: 87988.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212597.2183; train_optim_loss: 212597.2183; val_kl_reg_loss: 5097.1361; val_edge_recon_loss: 40620.1597; val_cond_contrastive_loss: 79241.1582; val_gene_expr_recon_loss: 88159.8613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213118.3152; val_optim_loss: 213118.3152
