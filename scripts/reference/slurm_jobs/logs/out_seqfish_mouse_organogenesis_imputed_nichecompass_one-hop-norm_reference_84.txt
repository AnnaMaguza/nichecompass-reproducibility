[True]
Run timestamp: 01082023_094002_84.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_84']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9021; val_auprc_score: 0.9814; val_best_acc_score: 0.8560; val_best_f1_score: 0.9222; train_kl_reg_loss: 56410.3823; train_edge_recon_loss: 1056129.5509; train_gene_expr_recon_loss: 516900.4300; train_masked_gp_l1_reg_loss: 11475.2973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113883.6956; train_global_loss: 1754799.3403; train_optim_loss: 1754799.3403; val_kl_reg_loss: 81549.9375; val_edge_recon_loss: 1192821.6667; val_gene_expr_recon_loss: 438565.6667; val_masked_gp_l1_reg_loss: 11206.2354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100967.6406; val_global_loss: 1825111.1667; val_optim_loss: 1825111.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8985; val_auprc_score: 0.9807; val_best_acc_score: 0.8673; val_best_f1_score: 0.9279; train_kl_reg_loss: 32615.5097; train_edge_recon_loss: 1030778.4456; train_gene_expr_recon_loss: 373408.3061; train_masked_gp_l1_reg_loss: 10789.2441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91112.9999; train_global_loss: 1538704.4977; train_optim_loss: 1538704.4977; val_kl_reg_loss: 19957.9154; val_edge_recon_loss: 1169770.1458; val_gene_expr_recon_loss: 307128.7760; val_masked_gp_l1_reg_loss: 10280.9482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81570.0859; val_global_loss: 1588707.8958; val_optim_loss: 1588707.8958
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8925; val_auprc_score: 0.9789; val_best_acc_score: 0.8686; val_best_f1_score: 0.9282; train_kl_reg_loss: 18380.1272; train_edge_recon_loss: 1037438.3333; train_gene_expr_recon_loss: 284342.6227; train_masked_gp_l1_reg_loss: 9900.9339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72529.9643; train_global_loss: 1422591.9884; train_optim_loss: 1422591.9884; val_kl_reg_loss: 13405.9544; val_edge_recon_loss: 1196142.2917; val_gene_expr_recon_loss: 269419.9010; val_masked_gp_l1_reg_loss: 9572.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63311.0469; val_global_loss: 1551851.9375; val_optim_loss: 1551851.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8896; val_auprc_score: 0.9785; val_best_acc_score: 0.8820; val_best_f1_score: 0.9345; train_kl_reg_loss: 13526.5681; train_edge_recon_loss: 1025889.7905; train_gene_expr_recon_loss: 264185.9797; train_masked_gp_l1_reg_loss: 9325.9922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55341.0624; train_global_loss: 1368269.3958; train_optim_loss: 1368269.3958; val_kl_reg_loss: 11461.5814; val_edge_recon_loss: 1198677.4583; val_gene_expr_recon_loss: 258047.4297; val_masked_gp_l1_reg_loss: 9090.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47689.2930; val_global_loss: 1524966.2083; val_optim_loss: 1524966.2083
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8602; val_auprc_score: 0.9698; val_best_acc_score: 0.8815; val_best_f1_score: 0.9339; train_kl_reg_loss: 12129.0306; train_edge_recon_loss: 1027108.1620; train_gene_expr_recon_loss: 254965.4227; train_masked_gp_l1_reg_loss: 8897.9642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41664.3067; train_global_loss: 1344764.8727; train_optim_loss: 1344764.8727; val_kl_reg_loss: 10224.7419; val_edge_recon_loss: 1196119.1458; val_gene_expr_recon_loss: 251300.6927; val_masked_gp_l1_reg_loss: 8721.3174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36154.1484; val_global_loss: 1502520.0833; val_optim_loss: 1502520.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8336; val_auprc_score: 0.9616; val_best_acc_score: 0.8858; val_best_f1_score: 0.9365; train_kl_reg_loss: 8802.0949; train_edge_recon_loss: 967605.4965; train_gene_expr_recon_loss: 258700.9531; train_masked_gp_l1_reg_loss: 8633.9542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32496.5601; train_global_loss: 1276239.0671; train_optim_loss: 1276239.0671; val_kl_reg_loss: 12343.9744; val_edge_recon_loss: 917290.2917; val_gene_expr_recon_loss: 264045.5625; val_masked_gp_l1_reg_loss: 8648.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29708.4375; val_global_loss: 1232036.3333; val_optim_loss: 1232036.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8398; val_auprc_score: 0.9620; val_best_acc_score: 0.8933; val_best_f1_score: 0.9403; train_kl_reg_loss: 16732.7439; train_edge_recon_loss: 885386.3310; train_gene_expr_recon_loss: 255028.1597; train_masked_gp_l1_reg_loss: 8605.4607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27520.6418; train_global_loss: 1193273.3333; train_optim_loss: 1193273.3333; val_kl_reg_loss: 16637.3880; val_edge_recon_loss: 889492.1458; val_gene_expr_recon_loss: 249153.9974; val_masked_gp_l1_reg_loss: 8505.8857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25291.4570; val_global_loss: 1189080.8958; val_optim_loss: 1189080.8958
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8456; val_auprc_score: 0.9632; val_best_acc_score: 0.9013; val_best_f1_score: 0.9448; train_kl_reg_loss: 16571.4258; train_edge_recon_loss: 873923.9861; train_gene_expr_recon_loss: 247712.6296; train_masked_gp_l1_reg_loss: 8374.5059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23462.6064; train_global_loss: 1170045.1620; train_optim_loss: 1170045.1620; val_kl_reg_loss: 15779.8247; val_edge_recon_loss: 879572.2708; val_gene_expr_recon_loss: 243338.2656; val_masked_gp_l1_reg_loss: 8222.7451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21727.4316; val_global_loss: 1168640.5000; val_optim_loss: 1168640.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8475; val_auprc_score: 0.9664; val_best_acc_score: 0.9030; val_best_f1_score: 0.9457; train_kl_reg_loss: 15729.0373; train_edge_recon_loss: 859876.3426; train_gene_expr_recon_loss: 242828.9844; train_masked_gp_l1_reg_loss: 8057.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20359.3013; train_global_loss: 1146851.0231; train_optim_loss: 1146851.0231; val_kl_reg_loss: 15135.8315; val_edge_recon_loss: 880152.1042; val_gene_expr_recon_loss: 240559.2240; val_masked_gp_l1_reg_loss: 7872.6616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19046.5332; val_global_loss: 1162766.2708; val_optim_loss: 1162766.2708
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8705; val_auprc_score: 0.9714; val_best_acc_score: 0.9066; val_best_f1_score: 0.9475; train_kl_reg_loss: 15146.9565; train_edge_recon_loss: 853411.5058; train_gene_expr_recon_loss: 239188.5095; train_masked_gp_l1_reg_loss: 7683.8331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17972.1367; train_global_loss: 1133402.9444; train_optim_loss: 1133402.9444; val_kl_reg_loss: 13882.6566; val_edge_recon_loss: 835215.7188; val_gene_expr_recon_loss: 238656.5964; val_masked_gp_l1_reg_loss: 7479.5239; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16961.0820; val_global_loss: 1112195.5833; val_optim_loss: 1112195.5833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8847; val_auprc_score: 0.9741; val_best_acc_score: 0.9059; val_best_f1_score: 0.9470; train_kl_reg_loss: 14624.1706; train_edge_recon_loss: 830610.4271; train_gene_expr_recon_loss: 236097.2271; train_masked_gp_l1_reg_loss: 7270.4724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16200.8376; train_global_loss: 1104803.1273; train_optim_loss: 1104803.1273; val_kl_reg_loss: 15030.3993; val_edge_recon_loss: 831069.8333; val_gene_expr_recon_loss: 233123.8073; val_masked_gp_l1_reg_loss: 7050.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15448.0781; val_global_loss: 1101722.7708; val_optim_loss: 1101722.7708
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8944; val_auprc_score: 0.9750; val_best_acc_score: 0.9050; val_best_f1_score: 0.9457; train_kl_reg_loss: 15339.4438; train_edge_recon_loss: 822121.5428; train_gene_expr_recon_loss: 231497.7488; train_masked_gp_l1_reg_loss: 6840.0050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14748.5561; train_global_loss: 1090547.3056; train_optim_loss: 1090547.3056; val_kl_reg_loss: 13846.3934; val_edge_recon_loss: 856862.8021; val_gene_expr_recon_loss: 229408.5938; val_masked_gp_l1_reg_loss: 6623.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14072.6416; val_global_loss: 1120813.5625; val_optim_loss: 1120813.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8955; val_auprc_score: 0.9764; val_best_acc_score: 0.9167; val_best_f1_score: 0.9528; train_kl_reg_loss: 14214.6050; train_edge_recon_loss: 825922.9329; train_gene_expr_recon_loss: 228137.8712; train_masked_gp_l1_reg_loss: 6407.6093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13487.7557; train_global_loss: 1088170.7778; train_optim_loss: 1088170.7778; val_kl_reg_loss: 13246.0959; val_edge_recon_loss: 802986.6458; val_gene_expr_recon_loss: 226987.5130; val_masked_gp_l1_reg_loss: 6179.6309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12914.5176; val_global_loss: 1062314.4062; val_optim_loss: 1062314.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9087; val_auprc_score: 0.9784; val_best_acc_score: 0.9223; val_best_f1_score: 0.9556; train_kl_reg_loss: 13497.9672; train_edge_recon_loss: 801605.8183; train_gene_expr_recon_loss: 225065.6878; train_masked_gp_l1_reg_loss: 5958.0303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12411.2648; train_global_loss: 1058538.7743; train_optim_loss: 1058538.7743; val_kl_reg_loss: 13047.2402; val_edge_recon_loss: 828729.9479; val_gene_expr_recon_loss: 222851.9297; val_masked_gp_l1_reg_loss: 5724.8882; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11882.6123; val_global_loss: 1082236.6042; val_optim_loss: 1082236.6042
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9155; val_auprc_score: 0.9809; val_best_acc_score: 0.9281; val_best_f1_score: 0.9590; train_kl_reg_loss: 13357.7093; train_edge_recon_loss: 806934.4896; train_gene_expr_recon_loss: 221838.5747; train_masked_gp_l1_reg_loss: 5503.8862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11398.5735; train_global_loss: 1059033.2245; train_optim_loss: 1059033.2245; val_kl_reg_loss: 12976.3507; val_edge_recon_loss: 795739.8646; val_gene_expr_recon_loss: 219367.3464; val_masked_gp_l1_reg_loss: 5275.3486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10924.5664; val_global_loss: 1044283.5208; val_optim_loss: 1044283.5208
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9203; val_auprc_score: 0.9794; val_best_acc_score: 0.9269; val_best_f1_score: 0.9580; train_kl_reg_loss: 12808.4092; train_edge_recon_loss: 788610.7442; train_gene_expr_recon_loss: 218706.0888; train_masked_gp_l1_reg_loss: 5062.8984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10458.5586; train_global_loss: 1035646.7118; train_optim_loss: 1035646.7118; val_kl_reg_loss: 12056.0029; val_edge_recon_loss: 833753.9062; val_gene_expr_recon_loss: 216865.2760; val_masked_gp_l1_reg_loss: 4848.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10002.8242; val_global_loss: 1077526.8021; val_optim_loss: 1077526.8021
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9245; val_auprc_score: 0.9836; val_best_acc_score: 0.9300; val_best_f1_score: 0.9600; train_kl_reg_loss: 12269.5627; train_edge_recon_loss: 798015.5278; train_gene_expr_recon_loss: 215997.5686; train_masked_gp_l1_reg_loss: 4652.1307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9614.2191; train_global_loss: 1040549.0023; train_optim_loss: 1040549.0023; val_kl_reg_loss: 11463.9202; val_edge_recon_loss: 784678.3229; val_gene_expr_recon_loss: 214358.9479; val_masked_gp_l1_reg_loss: 4452.9858; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9211.4580; val_global_loss: 1024165.6354; val_optim_loss: 1024165.6354
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9336; val_auprc_score: 0.9861; val_best_acc_score: 0.9304; val_best_f1_score: 0.9602; train_kl_reg_loss: 11769.8651; train_edge_recon_loss: 795596.2222; train_gene_expr_recon_loss: 213433.1111; train_masked_gp_l1_reg_loss: 4269.2966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8866.7699; train_global_loss: 1033935.2674; train_optim_loss: 1033935.2674; val_kl_reg_loss: 11509.9458; val_edge_recon_loss: 782272.7188; val_gene_expr_recon_loss: 211445.4062; val_masked_gp_l1_reg_loss: 4084.6382; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8528.9092; val_global_loss: 1017841.6458; val_optim_loss: 1017841.6458
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9362; val_auprc_score: 0.9853; val_best_acc_score: 0.9318; val_best_f1_score: 0.9608; train_kl_reg_loss: 11126.6802; train_edge_recon_loss: 792682.4074; train_gene_expr_recon_loss: 210947.0587; train_masked_gp_l1_reg_loss: 3917.6395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8189.3702; train_global_loss: 1026863.1539; train_optim_loss: 1026863.1539; val_kl_reg_loss: 10627.8507; val_edge_recon_loss: 791235.3333; val_gene_expr_recon_loss: 209838.4271; val_masked_gp_l1_reg_loss: 3752.7568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7852.3149; val_global_loss: 1023306.6771; val_optim_loss: 1023306.6771
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9474; val_auprc_score: 0.9885; val_best_acc_score: 0.9371; val_best_f1_score: 0.9638; train_kl_reg_loss: 10591.0106; train_edge_recon_loss: 788406.9537; train_gene_expr_recon_loss: 208855.5712; train_masked_gp_l1_reg_loss: 3602.0026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7539.2320; train_global_loss: 1018994.7743; train_optim_loss: 1018994.7743; val_kl_reg_loss: 9902.7015; val_edge_recon_loss: 768341.1667; val_gene_expr_recon_loss: 207582.1016; val_masked_gp_l1_reg_loss: 3449.6375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7218.8125; val_global_loss: 996494.4167; val_optim_loss: 996494.4167
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9498; val_auprc_score: 0.9893; val_best_acc_score: 0.9374; val_best_f1_score: 0.9638; train_kl_reg_loss: 10392.2918; train_edge_recon_loss: 780320.9167; train_gene_expr_recon_loss: 206812.2595; train_masked_gp_l1_reg_loss: 3314.0533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6907.4737; train_global_loss: 1007746.9977; train_optim_loss: 1007746.9977; val_kl_reg_loss: 10123.2528; val_edge_recon_loss: 773652.8438; val_gene_expr_recon_loss: 205310.4219; val_masked_gp_l1_reg_loss: 3182.5037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6595.5493; val_global_loss: 998864.5833; val_optim_loss: 998864.5833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9487; val_auprc_score: 0.9881; val_best_acc_score: 0.9363; val_best_f1_score: 0.9630; train_kl_reg_loss: 10084.7274; train_edge_recon_loss: 778493.6111; train_gene_expr_recon_loss: 204843.0434; train_masked_gp_l1_reg_loss: 3061.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6294.5295; train_global_loss: 1002777.6192; train_optim_loss: 1002777.6192; val_kl_reg_loss: 9071.8271; val_edge_recon_loss: 812030.4792; val_gene_expr_recon_loss: 203735.3490; val_masked_gp_l1_reg_loss: 2939.8044; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5986.1289; val_global_loss: 1033763.5729; val_optim_loss: 1033763.5729
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9451; val_auprc_score: 0.9870; val_best_acc_score: 0.9354; val_best_f1_score: 0.9630; train_kl_reg_loss: 10068.6242; train_edge_recon_loss: 777592.2141; train_gene_expr_recon_loss: 202960.4844; train_masked_gp_l1_reg_loss: 2835.4444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5710.0526; train_global_loss: 999166.8113; train_optim_loss: 999166.8113; val_kl_reg_loss: 9177.6353; val_edge_recon_loss: 778648.7917; val_gene_expr_recon_loss: 202171.9661; val_masked_gp_l1_reg_loss: 2735.2153; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5431.5029; val_global_loss: 998165.0729; val_optim_loss: 998165.0729
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9455; val_auprc_score: 0.9877; val_best_acc_score: 0.9373; val_best_f1_score: 0.9636; train_kl_reg_loss: 9630.0549; train_edge_recon_loss: 780773.7199; train_gene_expr_recon_loss: 201185.0165; train_masked_gp_l1_reg_loss: 2647.6889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5182.6196; train_global_loss: 999419.0961; train_optim_loss: 999419.0961; val_kl_reg_loss: 9167.6571; val_edge_recon_loss: 800311.5625; val_gene_expr_recon_loss: 200436.4922; val_masked_gp_l1_reg_loss: 2559.1895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4930.0635; val_global_loss: 1017404.9479; val_optim_loss: 1017404.9479

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9485; val_auprc_score: 0.9876; val_best_acc_score: 0.9380; val_best_f1_score: 0.9642; train_kl_reg_loss: 9487.3150; train_edge_recon_loss: 782455.0868; train_gene_expr_recon_loss: 200219.7943; train_masked_gp_l1_reg_loss: 2506.4058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4834.1297; train_global_loss: 999502.7257; train_optim_loss: 999502.7257; val_kl_reg_loss: 9216.2974; val_edge_recon_loss: 786403.2292; val_gene_expr_recon_loss: 199637.3568; val_masked_gp_l1_reg_loss: 2488.0496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4793.6655; val_global_loss: 1002538.6458; val_optim_loss: 1002538.6458
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9477; val_auprc_score: 0.9875; val_best_acc_score: 0.9382; val_best_f1_score: 0.9644; train_kl_reg_loss: 8732.4044; train_edge_recon_loss: 779009.1181; train_gene_expr_recon_loss: 242761.6759; train_masked_gp_l1_reg_loss: 2470.5306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4710.1112; train_global_loss: 1037683.8333; train_optim_loss: 1037683.8333; val_kl_reg_loss: 4900.0639; val_edge_recon_loss: 790680.3958; val_gene_expr_recon_loss: 240073.7214; val_masked_gp_l1_reg_loss: 2451.2817; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4609.1445; val_global_loss: 1042714.5938; val_optim_loss: 1042714.5938
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9514; val_auprc_score: 0.9894; val_best_acc_score: 0.9378; val_best_f1_score: 0.9641; train_kl_reg_loss: 7603.3049; train_edge_recon_loss: 777416.9757; train_gene_expr_recon_loss: 238494.8466; train_masked_gp_l1_reg_loss: 2434.3704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4514.5710; train_global_loss: 1030464.0671; train_optim_loss: 1030464.0671; val_kl_reg_loss: 4476.6191; val_edge_recon_loss: 791101.3333; val_gene_expr_recon_loss: 236367.2786; val_masked_gp_l1_reg_loss: 2417.6099; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4420.1670; val_global_loss: 1038783.0000; val_optim_loss: 1038783.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9537; val_auprc_score: 0.9899; val_best_acc_score: 0.9414; val_best_f1_score: 0.9663; train_kl_reg_loss: 6951.4792; train_edge_recon_loss: 771171.9907; train_gene_expr_recon_loss: 235546.4841; train_masked_gp_l1_reg_loss: 2402.4600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4335.1709; train_global_loss: 1020407.5856; train_optim_loss: 1020407.5856; val_kl_reg_loss: 4267.5071; val_edge_recon_loss: 760487.8438; val_gene_expr_recon_loss: 233812.9766; val_masked_gp_l1_reg_loss: 2387.0967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4249.6279; val_global_loss: 1005205.0625; val_optim_loss: 1005205.0625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 11 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9436
val AUPRC score: 0.9882
val best accuracy score: 0.9336
val best F1 score: 0.9618
val target rna MSE score: 22.3758
val source rna MSE score: 37.9932
Val cat covariate0 mean sim diff: -0.0049

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
