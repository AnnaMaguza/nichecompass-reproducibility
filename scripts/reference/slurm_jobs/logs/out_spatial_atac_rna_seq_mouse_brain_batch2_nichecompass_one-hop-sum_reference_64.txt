[True]
Run timestamp: 10082023_214632_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7754; val_auprc_score: 0.7951; val_best_acc_score: 0.5600; val_best_f1_score: 0.6925; train_kl_reg_loss: 123224.9885; train_edge_recon_loss: 3718779.2538; train_gene_expr_recon_loss: 49464180.1221; train_masked_gp_l1_reg_loss: 96247.6945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 247021.5323; train_chrom_access_recon_loss: 25850359.4809; train_global_loss: 79499813.4962; train_optim_loss: 79499813.4962; val_kl_reg_loss: 150150.9667; val_edge_recon_loss: 4062200.5333; val_gene_expr_recon_loss: 38530859.4667; val_masked_gp_l1_reg_loss: 93833.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243725.8750; val_chrom_access_recon_loss: 23516858.5333; val_global_loss: 66597625.8667; val_optim_loss: 66597625.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7867; val_auprc_score: 0.8075; val_best_acc_score: 0.6172; val_best_f1_score: 0.7107; train_kl_reg_loss: 185074.0815; train_edge_recon_loss: 3692214.7462; train_gene_expr_recon_loss: 38459577.0076; train_masked_gp_l1_reg_loss: 88234.7347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238685.9344; train_chrom_access_recon_loss: 23167836.1221; train_global_loss: 65831622.4733; train_optim_loss: 65831622.4733; val_kl_reg_loss: 201183.2188; val_edge_recon_loss: 4058177.9500; val_gene_expr_recon_loss: 36892466.6667; val_masked_gp_l1_reg_loss: 83778.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233194.9531; val_chrom_access_recon_loss: 23164429.2000; val_global_loss: 64633233.3333; val_optim_loss: 64633233.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8659; val_auprc_score: 0.8628; val_best_acc_score: 0.7711; val_best_f1_score: 0.7897; train_kl_reg_loss: 188098.1387; train_edge_recon_loss: 3574147.4847; train_gene_expr_recon_loss: 37228180.6412; train_masked_gp_l1_reg_loss: 82430.1979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227569.6068; train_chrom_access_recon_loss: 22943037.3588; train_global_loss: 64243463.2061; train_optim_loss: 64243463.2061; val_kl_reg_loss: 168783.0333; val_edge_recon_loss: 3769610.6333; val_gene_expr_recon_loss: 36491645.3333; val_masked_gp_l1_reg_loss: 82343.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221847.8438; val_chrom_access_recon_loss: 23006883.4667; val_global_loss: 63741114.1333; val_optim_loss: 63741114.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8739; val_auprc_score: 0.8636; val_best_acc_score: 0.7792; val_best_f1_score: 0.7979; train_kl_reg_loss: 185019.2721; train_edge_recon_loss: 3234667.3626; train_gene_expr_recon_loss: 36869980.1832; train_masked_gp_l1_reg_loss: 83424.9243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216239.3316; train_chrom_access_recon_loss: 22792227.6336; train_global_loss: 63381558.5954; train_optim_loss: 63381558.5954; val_kl_reg_loss: 205298.5302; val_edge_recon_loss: 3092911.3667; val_gene_expr_recon_loss: 36046769.0667; val_masked_gp_l1_reg_loss: 84379.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210581.6875; val_chrom_access_recon_loss: 22694600.6667; val_global_loss: 62334539.4667; val_optim_loss: 62334539.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8860; val_auprc_score: 0.8756; val_best_acc_score: 0.7926; val_best_f1_score: 0.8097; train_kl_reg_loss: 207428.6097; train_edge_recon_loss: 3041913.7805; train_gene_expr_recon_loss: 36584351.2977; train_masked_gp_l1_reg_loss: 85188.5165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205273.7390; train_chrom_access_recon_loss: 22672886.8702; train_global_loss: 62797042.5649; train_optim_loss: 62797042.5649; val_kl_reg_loss: 194816.9490; val_edge_recon_loss: 3039983.3833; val_gene_expr_recon_loss: 36053932.5333; val_masked_gp_l1_reg_loss: 86191.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200028.9375; val_chrom_access_recon_loss: 22862613.0667; val_global_loss: 62437565.6000; val_optim_loss: 62437565.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8993; val_auprc_score: 0.8892; val_best_acc_score: 0.8084; val_best_f1_score: 0.8225; train_kl_reg_loss: 194731.0924; train_edge_recon_loss: 3013715.1011; train_gene_expr_recon_loss: 36359850.7786; train_masked_gp_l1_reg_loss: 87360.8094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 195288.4736; train_chrom_access_recon_loss: 22576829.7405; train_global_loss: 62427776.0611; train_optim_loss: 62427776.0611; val_kl_reg_loss: 182881.2635; val_edge_recon_loss: 3011310.2833; val_gene_expr_recon_loss: 35664437.8667; val_masked_gp_l1_reg_loss: 88484.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190662.1094; val_chrom_access_recon_loss: 22637823.3333; val_global_loss: 61775600.2667; val_optim_loss: 61775600.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9115; val_auprc_score: 0.9027; val_best_acc_score: 0.8216; val_best_f1_score: 0.8345; train_kl_reg_loss: 180830.1393; train_edge_recon_loss: 2980743.5553; train_gene_expr_recon_loss: 36081964.7023; train_masked_gp_l1_reg_loss: 89469.1469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186228.2808; train_chrom_access_recon_loss: 22398197.2977; train_global_loss: 61917433.3740; train_optim_loss: 61917433.3740; val_kl_reg_loss: 181308.6073; val_edge_recon_loss: 2957382.3833; val_gene_expr_recon_loss: 35573500.5333; val_masked_gp_l1_reg_loss: 90660.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181786.9844; val_chrom_access_recon_loss: 22504329.3333; val_global_loss: 61488969.3333; val_optim_loss: 61488969.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9250; val_auprc_score: 0.9139; val_best_acc_score: 0.8461; val_best_f1_score: 0.8552; train_kl_reg_loss: 174116.7371; train_edge_recon_loss: 2936676.4389; train_gene_expr_recon_loss: 35913378.5954; train_masked_gp_l1_reg_loss: 91558.7087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177548.8386; train_chrom_access_recon_loss: 22297203.2824; train_global_loss: 61590482.6260; train_optim_loss: 61590482.6260; val_kl_reg_loss: 176133.8552; val_edge_recon_loss: 2909266.0167; val_gene_expr_recon_loss: 35357031.2000; val_masked_gp_l1_reg_loss: 92740.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173296.5781; val_chrom_access_recon_loss: 22381702.1333; val_global_loss: 61090168.5333; val_optim_loss: 61090168.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9341; val_auprc_score: 0.9240; val_best_acc_score: 0.8588; val_best_f1_score: 0.8684; train_kl_reg_loss: 171421.5276; train_edge_recon_loss: 2895368.3321; train_gene_expr_recon_loss: 35757081.5878; train_masked_gp_l1_reg_loss: 93646.8498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169474.8470; train_chrom_access_recon_loss: 22219075.8626; train_global_loss: 61306068.7939; train_optim_loss: 61306068.7939; val_kl_reg_loss: 172590.8823; val_edge_recon_loss: 2893815.1000; val_gene_expr_recon_loss: 35312275.4667; val_masked_gp_l1_reg_loss: 94444.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165659.8125; val_chrom_access_recon_loss: 22410608.5333; val_global_loss: 61049393.8667; val_optim_loss: 61049393.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9408; val_auprc_score: 0.9274; val_best_acc_score: 0.8756; val_best_f1_score: 0.8823; train_kl_reg_loss: 167684.3000; train_edge_recon_loss: 2872853.6164; train_gene_expr_recon_loss: 35595792.5191; train_masked_gp_l1_reg_loss: 95572.9819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162270.5920; train_chrom_access_recon_loss: 22107947.0229; train_global_loss: 61002120.9466; train_optim_loss: 61002120.9466; val_kl_reg_loss: 164791.5938; val_edge_recon_loss: 2877217.2667; val_gene_expr_recon_loss: 35064248.8000; val_masked_gp_l1_reg_loss: 96737.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159060.1094; val_chrom_access_recon_loss: 22164249.2000; val_global_loss: 60526303.2000; val_optim_loss: 60526303.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9346; val_auprc_score: 0.9226; val_best_acc_score: 0.8653; val_best_f1_score: 0.8735; train_kl_reg_loss: 164652.6868; train_edge_recon_loss: 2866221.9485; train_gene_expr_recon_loss: 36149789.4198; train_masked_gp_l1_reg_loss: 97554.4181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156077.2913; train_chrom_access_recon_loss: 22063846.2595; train_global_loss: 61498141.9542; train_optim_loss: 61498141.9542; val_kl_reg_loss: 162923.8646; val_edge_recon_loss: 2943180.0333; val_gene_expr_recon_loss: 35504393.0667; val_masked_gp_l1_reg_loss: 98699.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154051.8281; val_chrom_access_recon_loss: 22201325.0667; val_global_loss: 61064573.8667; val_optim_loss: 61064573.8667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9410; val_auprc_score: 0.9290; val_best_acc_score: 0.8746; val_best_f1_score: 0.8805; train_kl_reg_loss: 175443.7087; train_edge_recon_loss: 2892536.6546; train_gene_expr_recon_loss: 36010811.9695; train_masked_gp_l1_reg_loss: 98218.7059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150288.0792; train_chrom_access_recon_loss: 22092627.4198; train_global_loss: 61419926.1679; train_optim_loss: 61419926.1679; val_kl_reg_loss: 172261.0542; val_edge_recon_loss: 2892462.3500; val_gene_expr_recon_loss: 34930651.4667; val_masked_gp_l1_reg_loss: 99745.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146026.5625; val_chrom_access_recon_loss: 21994148.1333; val_global_loss: 60235294.4000; val_optim_loss: 60235294.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9412; val_auprc_score: 0.9295; val_best_acc_score: 0.8767; val_best_f1_score: 0.8843; train_kl_reg_loss: 174130.2493; train_edge_recon_loss: 2868710.1260; train_gene_expr_recon_loss: 35781718.9313; train_masked_gp_l1_reg_loss: 100750.2211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141985.2340; train_chrom_access_recon_loss: 21965985.6183; train_global_loss: 61033280.3664; train_optim_loss: 61033280.3664; val_kl_reg_loss: 174562.5573; val_edge_recon_loss: 2855273.5000; val_gene_expr_recon_loss: 34847361.3333; val_masked_gp_l1_reg_loss: 101573.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138466.1875; val_chrom_access_recon_loss: 22104074.1333; val_global_loss: 60221312.2667; val_optim_loss: 60221312.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9436; val_auprc_score: 0.9309; val_best_acc_score: 0.8773; val_best_f1_score: 0.8844; train_kl_reg_loss: 172997.8453; train_edge_recon_loss: 2843473.4847; train_gene_expr_recon_loss: 35454799.0382; train_masked_gp_l1_reg_loss: 101682.2989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135814.5109; train_chrom_access_recon_loss: 21892249.0229; train_global_loss: 60601015.9084; train_optim_loss: 60601015.9084; val_kl_reg_loss: 172260.6469; val_edge_recon_loss: 2850293.1167; val_gene_expr_recon_loss: 34550193.0667; val_masked_gp_l1_reg_loss: 102096.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133166.9688; val_chrom_access_recon_loss: 21837610.2667; val_global_loss: 59645621.8667; val_optim_loss: 59645621.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9460; val_auprc_score: 0.9352; val_best_acc_score: 0.8797; val_best_f1_score: 0.8840; train_kl_reg_loss: 168362.7010; train_edge_recon_loss: 2827641.9275; train_gene_expr_recon_loss: 35095524.9618; train_masked_gp_l1_reg_loss: 102694.8417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130778.4701; train_chrom_access_recon_loss: 21780311.5115; train_global_loss: 60105314.3817; train_optim_loss: 60105314.3817; val_kl_reg_loss: 164513.4281; val_edge_recon_loss: 2834679.2500; val_gene_expr_recon_loss: 34570318.4000; val_masked_gp_l1_reg_loss: 103388.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128479.2734; val_chrom_access_recon_loss: 21879298.9333; val_global_loss: 59680677.6000; val_optim_loss: 59680677.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9500; val_auprc_score: 0.9408; val_best_acc_score: 0.8853; val_best_f1_score: 0.8916; train_kl_reg_loss: 163773.4067; train_edge_recon_loss: 2821192.4809; train_gene_expr_recon_loss: 35068810.8702; train_masked_gp_l1_reg_loss: 104143.5802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126312.0428; train_chrom_access_recon_loss: 21756246.2137; train_global_loss: 60040478.4733; train_optim_loss: 60040478.4733; val_kl_reg_loss: 159363.0698; val_edge_recon_loss: 2835540.0167; val_gene_expr_recon_loss: 34567392.0000; val_masked_gp_l1_reg_loss: 104820.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124167.2812; val_chrom_access_recon_loss: 21902698.4000; val_global_loss: 59693982.1333; val_optim_loss: 59693982.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9545; val_auprc_score: 0.9446; val_best_acc_score: 0.8910; val_best_f1_score: 0.8963; train_kl_reg_loss: 157037.8273; train_edge_recon_loss: 2805424.8149; train_gene_expr_recon_loss: 34959350.7176; train_masked_gp_l1_reg_loss: 105639.7968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122088.0584; train_chrom_access_recon_loss: 21701316.8702; train_global_loss: 59850857.8626; train_optim_loss: 59850857.8626; val_kl_reg_loss: 154365.2760; val_edge_recon_loss: 2805716.0833; val_gene_expr_recon_loss: 34417823.7333; val_masked_gp_l1_reg_loss: 106367.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120084.3047; val_chrom_access_recon_loss: 21792399.7333; val_global_loss: 59396757.3333; val_optim_loss: 59396757.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9515; val_auprc_score: 0.9400; val_best_acc_score: 0.8911; val_best_f1_score: 0.8960; train_kl_reg_loss: 153329.8779; train_edge_recon_loss: 2794996.9618; train_gene_expr_recon_loss: 34852572.3053; train_masked_gp_l1_reg_loss: 107230.3714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118132.8487; train_chrom_access_recon_loss: 21641817.1603; train_global_loss: 59668079.7557; train_optim_loss: 59668079.7557; val_kl_reg_loss: 152056.7969; val_edge_recon_loss: 2817685.3667; val_gene_expr_recon_loss: 34458598.6667; val_masked_gp_l1_reg_loss: 107955.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116163.8203; val_chrom_access_recon_loss: 21785550.5333; val_global_loss: 59438010.9333; val_optim_loss: 59438010.9333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9531; val_auprc_score: 0.9412; val_best_acc_score: 0.8903; val_best_f1_score: 0.8962; train_kl_reg_loss: 148397.5755; train_edge_recon_loss: 2815192.2214; train_gene_expr_recon_loss: 34851732.5344; train_masked_gp_l1_reg_loss: 108834.6394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114287.0018; train_chrom_access_recon_loss: 21610475.2824; train_global_loss: 59648919.0229; train_optim_loss: 59648919.0229; val_kl_reg_loss: 139091.3719; val_edge_recon_loss: 2841537.0500; val_gene_expr_recon_loss: 34700763.0667; val_masked_gp_l1_reg_loss: 109924.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112888.3516; val_chrom_access_recon_loss: 21772372.9333; val_global_loss: 59676576.8000; val_optim_loss: 59676576.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9545; val_auprc_score: 0.9439; val_best_acc_score: 0.8946; val_best_f1_score: 0.8985; train_kl_reg_loss: 178747.9532; train_edge_recon_loss: 2806879.3664; train_gene_expr_recon_loss: 35067382.1069; train_masked_gp_l1_reg_loss: 109735.1375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111009.8723; train_chrom_access_recon_loss: 21638853.9084; train_global_loss: 59912608.4580; train_optim_loss: 59912608.4580; val_kl_reg_loss: 153057.1646; val_edge_recon_loss: 2824116.7833; val_gene_expr_recon_loss: 34772012.6667; val_masked_gp_l1_reg_loss: 109807.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109765.2344; val_chrom_access_recon_loss: 21781872.5333; val_global_loss: 59750631.4667; val_optim_loss: 59750631.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9543; val_auprc_score: 0.9449; val_best_acc_score: 0.8946; val_best_f1_score: 0.9002; train_kl_reg_loss: 149352.7838; train_edge_recon_loss: 2799028.9485; train_gene_expr_recon_loss: 34849746.1679; train_masked_gp_l1_reg_loss: 109931.5679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107242.2146; train_chrom_access_recon_loss: 21543500.8855; train_global_loss: 59558802.6870; train_optim_loss: 59558802.6870; val_kl_reg_loss: 148719.0562; val_edge_recon_loss: 2824700.9833; val_gene_expr_recon_loss: 34353981.6000; val_masked_gp_l1_reg_loss: 110337.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104618.3984; val_chrom_access_recon_loss: 21695002.6667; val_global_loss: 59237361.0667; val_optim_loss: 59237361.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9554; val_auprc_score: 0.9448; val_best_acc_score: 0.8944; val_best_f1_score: 0.9003; train_kl_reg_loss: 148061.7131; train_edge_recon_loss: 2789179.0038; train_gene_expr_recon_loss: 34673406.6412; train_masked_gp_l1_reg_loss: 110981.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102447.7111; train_chrom_access_recon_loss: 21488852.9466; train_global_loss: 59312929.7710; train_optim_loss: 59312929.7710; val_kl_reg_loss: 148258.1458; val_edge_recon_loss: 2800535.2167; val_gene_expr_recon_loss: 34248000.2667; val_masked_gp_l1_reg_loss: 111548.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100390.9297; val_chrom_access_recon_loss: 21630586.5333; val_global_loss: 59039320.0000; val_optim_loss: 59039320.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9603; val_auprc_score: 0.9506; val_best_acc_score: 0.9039; val_best_f1_score: 0.9072; train_kl_reg_loss: 153717.8756; train_edge_recon_loss: 2784013.5859; train_gene_expr_recon_loss: 34803090.0153; train_masked_gp_l1_reg_loss: 112199.4958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98757.3742; train_chrom_access_recon_loss: 21543802.8397; train_global_loss: 59495581.4351; train_optim_loss: 59495581.4351; val_kl_reg_loss: 143962.5917; val_edge_recon_loss: 2806996.2833; val_gene_expr_recon_loss: 34208068.0000; val_masked_gp_l1_reg_loss: 113022.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97099.9688; val_chrom_access_recon_loss: 21609622.1333; val_global_loss: 58978774.1333; val_optim_loss: 58978774.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9554; val_auprc_score: 0.9472; val_best_acc_score: 0.8938; val_best_f1_score: 0.8986; train_kl_reg_loss: 808364.9488; train_edge_recon_loss: 2821152.7615; train_gene_expr_recon_loss: 36628777.0229; train_masked_gp_l1_reg_loss: 113119.9925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96499.0348; train_chrom_access_recon_loss: 21946057.7863; train_global_loss: 62413971.2672; train_optim_loss: 62413971.2672; val_kl_reg_loss: 162320.8375; val_edge_recon_loss: 2831237.9333; val_gene_expr_recon_loss: 35170667.2000; val_masked_gp_l1_reg_loss: 113503.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94822.0938; val_chrom_access_recon_loss: 21764283.2000; val_global_loss: 60136837.8667; val_optim_loss: 60136837.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9495; val_auprc_score: 0.9392; val_best_acc_score: 0.8880; val_best_f1_score: 0.8929; train_kl_reg_loss: 4875917.0830; train_edge_recon_loss: 2824511.2996; train_gene_expr_recon_loss: 35750460.1374; train_masked_gp_l1_reg_loss: 113876.7304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93081.3294; train_chrom_access_recon_loss: 21613926.7481; train_global_loss: 65271773.8321; train_optim_loss: 65271773.8321; val_kl_reg_loss: 161463.4146; val_edge_recon_loss: 2812760.1000; val_gene_expr_recon_loss: 34438618.6667; val_masked_gp_l1_reg_loss: 113826.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91869.7500; val_chrom_access_recon_loss: 21611516.8000; val_global_loss: 59230054.6667; val_optim_loss: 59230054.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9504; val_auprc_score: 0.9382; val_best_acc_score: 0.8878; val_best_f1_score: 0.8933; train_kl_reg_loss: 172485.7755; train_edge_recon_loss: 2916832.7672; train_gene_expr_recon_loss: 37004652.4275; train_masked_gp_l1_reg_loss: 113646.7653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94059.2886; train_chrom_access_recon_loss: 21846906.3817; train_global_loss: 62148583.8473; train_optim_loss: 62148583.8473; val_kl_reg_loss: 64569.9721; val_edge_recon_loss: 2865163.2333; val_gene_expr_recon_loss: 36189414.4000; val_masked_gp_l1_reg_loss: 113750.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94560.1719; val_chrom_access_recon_loss: 21962091.0667; val_global_loss: 61289551.2000; val_optim_loss: 61289551.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9447; val_auprc_score: 0.9307; val_best_acc_score: 0.8844; val_best_f1_score: 0.8901; train_kl_reg_loss: 169273.9218; train_edge_recon_loss: 2881117.8855; train_gene_expr_recon_loss: 36914764.7328; train_masked_gp_l1_reg_loss: 113464.4161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93660.2802; train_chrom_access_recon_loss: 21796088.7634; train_global_loss: 61968369.8321; train_optim_loss: 61968369.8321; val_kl_reg_loss: 55173.8763; val_edge_recon_loss: 2886776.7333; val_gene_expr_recon_loss: 36970482.6667; val_masked_gp_l1_reg_loss: 113818.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93373.2266; val_chrom_access_recon_loss: 22159371.4667; val_global_loss: 62278997.0667; val_optim_loss: 62278997.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9438; val_auprc_score: 0.9320; val_best_acc_score: 0.8789; val_best_f1_score: 0.8861; train_kl_reg_loss: 156839.8272; train_edge_recon_loss: 2871489.6737; train_gene_expr_recon_loss: 37404294.1374; train_masked_gp_l1_reg_loss: 113625.0664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93537.9697; train_chrom_access_recon_loss: 21862733.2214; train_global_loss: 62502519.5115; train_optim_loss: 62502519.5115; val_kl_reg_loss: 56692.9698; val_edge_recon_loss: 2878361.3167; val_gene_expr_recon_loss: 36965199.2000; val_masked_gp_l1_reg_loss: 113599.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93657.4375; val_chrom_access_recon_loss: 22027767.8667; val_global_loss: 62135277.3333; val_optim_loss: 62135277.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9466; val_auprc_score: 0.9336; val_best_acc_score: 0.8821; val_best_f1_score: 0.8890; train_kl_reg_loss: 156679.9027; train_edge_recon_loss: 2864995.1240; train_gene_expr_recon_loss: 37463811.3588; train_masked_gp_l1_reg_loss: 113567.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93718.3828; train_chrom_access_recon_loss: 21908633.4809; train_global_loss: 62601405.9847; train_optim_loss: 62601405.9847; val_kl_reg_loss: 58202.0198; val_edge_recon_loss: 2858243.8667; val_gene_expr_recon_loss: 37240245.6000; val_masked_gp_l1_reg_loss: 113536.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93727.6484; val_chrom_access_recon_loss: 22135125.2000; val_global_loss: 62499080.8000; val_optim_loss: 62499080.8000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9452; val_auprc_score: 0.9339; val_best_acc_score: 0.8806; val_best_f1_score: 0.8880; train_kl_reg_loss: 157902.8451; train_edge_recon_loss: 2854616.4122; train_gene_expr_recon_loss: 37634041.8015; train_masked_gp_l1_reg_loss: 113472.3421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93787.8817; train_chrom_access_recon_loss: 21927803.8931; train_global_loss: 62781625.2519; train_optim_loss: 62781625.2519; val_kl_reg_loss: 60550.0893; val_edge_recon_loss: 2862148.8167; val_gene_expr_recon_loss: 37166700.0000; val_masked_gp_l1_reg_loss: 113369.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93831.7812; val_chrom_access_recon_loss: 22046210.5333; val_global_loss: 62342810.1333; val_optim_loss: 62342810.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9435; val_auprc_score: 0.9318; val_best_acc_score: 0.8812; val_best_f1_score: 0.8870; train_kl_reg_loss: 158267.9580; train_edge_recon_loss: 2858272.0172; train_gene_expr_recon_loss: 37617581.4962; train_masked_gp_l1_reg_loss: 113239.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93792.6387; train_chrom_access_recon_loss: 21925886.6107; train_global_loss: 62767040.3053; train_optim_loss: 62767040.3053; val_kl_reg_loss: 62027.6177; val_edge_recon_loss: 2854739.8167; val_gene_expr_recon_loss: 36966898.6667; val_masked_gp_l1_reg_loss: 113083.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93744.4453; val_chrom_access_recon_loss: 22002619.4667; val_global_loss: 62093113.6000; val_optim_loss: 62093113.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 51 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9634
val AUPRC score: 0.9537
val best accuracy score: 0.9041
val best F1 score: 0.9070
val target rna MSE score: 1.7052
val source rna MSE score: 41.0493
val target atac MSE score: 0.1455
val source atac MSE score: 0.9679
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
