[True]
Run timestamp: 07092023_165155_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3433 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7954, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7597; val_auprc_score: 0.7744; val_best_acc_score: 0.5220; val_best_f1_score: 0.6757; train_kl_reg_loss: 81203.5971; train_edge_recon_loss: 3544844.8798; train_gene_expr_recon_loss: 28167225.4198; train_masked_gp_l1_reg_loss: 94835.4739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1363837.0272; train_chrom_access_recon_loss: 3149081.4771; train_global_loss: 36401027.8779; train_optim_loss: 36401027.8779; val_kl_reg_loss: 106028.2073; val_edge_recon_loss: 4063698.0667; val_gene_expr_recon_loss: 26247281.7333; val_masked_gp_l1_reg_loss: 86204.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 921447.1875; val_chrom_access_recon_loss: 3035692.0000; val_global_loss: 34460351.7333; val_optim_loss: 34460351.7333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8854; val_auprc_score: 0.8860; val_best_acc_score: 0.7599; val_best_f1_score: 0.7951; train_kl_reg_loss: 108755.6378; train_edge_recon_loss: 3527747.2595; train_gene_expr_recon_loss: 25849339.8626; train_masked_gp_l1_reg_loss: 83497.9636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 636081.2285; train_chrom_access_recon_loss: 3016058.1145; train_global_loss: 33221480.3817; train_optim_loss: 33221480.3817; val_kl_reg_loss: 103853.6536; val_edge_recon_loss: 4036655.2833; val_gene_expr_recon_loss: 25715363.4667; val_masked_gp_l1_reg_loss: 83550.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 427239.0000; val_chrom_access_recon_loss: 2984548.7667; val_global_loss: 33351210.0000; val_optim_loss: 33351210.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8791; val_auprc_score: 0.8632; val_best_acc_score: 0.8065; val_best_f1_score: 0.8272; train_kl_reg_loss: 84243.7983; train_edge_recon_loss: 3465860.5630; train_gene_expr_recon_loss: 25446129.2672; train_masked_gp_l1_reg_loss: 87280.2335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 326574.8305; train_chrom_access_recon_loss: 2974516.3855; train_global_loss: 32384605.0687; train_optim_loss: 32384605.0687; val_kl_reg_loss: 61368.5581; val_edge_recon_loss: 3243808.8833; val_gene_expr_recon_loss: 25356802.5333; val_masked_gp_l1_reg_loss: 92409.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 248361.5469; val_chrom_access_recon_loss: 2951477.9667; val_global_loss: 31954229.6000; val_optim_loss: 31954229.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8673; val_auprc_score: 0.8489; val_best_acc_score: 0.7933; val_best_f1_score: 0.8174; train_kl_reg_loss: 93669.8955; train_edge_recon_loss: 3017113.5363; train_gene_expr_recon_loss: 25187275.9084; train_masked_gp_l1_reg_loss: 94947.6573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199674.1293; train_chrom_access_recon_loss: 2946696.3416; train_global_loss: 31539377.3435; train_optim_loss: 31539377.3435; val_kl_reg_loss: 101761.0198; val_edge_recon_loss: 2954068.9167; val_gene_expr_recon_loss: 25164830.4000; val_masked_gp_l1_reg_loss: 96370.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161554.8750; val_chrom_access_recon_loss: 2925140.8333; val_global_loss: 31403725.3333; val_optim_loss: 31403725.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8816; val_auprc_score: 0.8678; val_best_acc_score: 0.7948; val_best_f1_score: 0.8202; train_kl_reg_loss: 104697.2132; train_edge_recon_loss: 2930596.9198; train_gene_expr_recon_loss: 24937296.3817; train_masked_gp_l1_reg_loss: 98444.1446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137699.5527; train_chrom_access_recon_loss: 2916512.6908; train_global_loss: 31125246.9008; train_optim_loss: 31125246.9008; val_kl_reg_loss: 106218.5802; val_edge_recon_loss: 2937987.9833; val_gene_expr_recon_loss: 24836086.4000; val_masked_gp_l1_reg_loss: 100354.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118595.6094; val_chrom_access_recon_loss: 2888103.7833; val_global_loss: 30987346.9333; val_optim_loss: 30987346.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8959; val_auprc_score: 0.8840; val_best_acc_score: 0.8084; val_best_f1_score: 0.8301; train_kl_reg_loss: 102838.2130; train_edge_recon_loss: 2897984.2385; train_gene_expr_recon_loss: 24706382.3053; train_masked_gp_l1_reg_loss: 102106.7746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106302.2911; train_chrom_access_recon_loss: 2890752.9809; train_global_loss: 30806366.7328; train_optim_loss: 30806366.7328; val_kl_reg_loss: 98684.6198; val_edge_recon_loss: 2910751.0333; val_gene_expr_recon_loss: 24578660.1333; val_masked_gp_l1_reg_loss: 104152.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96734.5938; val_chrom_access_recon_loss: 2854479.6667; val_global_loss: 30643461.7333; val_optim_loss: 30643461.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9049; val_auprc_score: 0.8921; val_best_acc_score: 0.8181; val_best_f1_score: 0.8371; train_kl_reg_loss: 100743.3683; train_edge_recon_loss: 2865011.4275; train_gene_expr_recon_loss: 24496236.0611; train_masked_gp_l1_reg_loss: 105444.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89206.1742; train_chrom_access_recon_loss: 2863516.9275; train_global_loss: 30520159.0229; train_optim_loss: 30520159.0229; val_kl_reg_loss: 96843.1250; val_edge_recon_loss: 2878279.5667; val_gene_expr_recon_loss: 24479275.6000; val_masked_gp_l1_reg_loss: 106996.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83143.8438; val_chrom_access_recon_loss: 2855022.3333; val_global_loss: 30499560.5333; val_optim_loss: 30499560.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9165; val_auprc_score: 0.9060; val_best_acc_score: 0.8323; val_best_f1_score: 0.8444; train_kl_reg_loss: 98029.0010; train_edge_recon_loss: 2848925.6450; train_gene_expr_recon_loss: 24363790.6565; train_masked_gp_l1_reg_loss: 108623.7001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78267.7176; train_chrom_access_recon_loss: 2845177.4924; train_global_loss: 30342814.2901; train_optim_loss: 30342814.2901; val_kl_reg_loss: 88728.8161; val_edge_recon_loss: 2859546.6833; val_gene_expr_recon_loss: 24259341.3333; val_masked_gp_l1_reg_loss: 111512.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74591.6484; val_chrom_access_recon_loss: 2833094.2667; val_global_loss: 30226815.2000; val_optim_loss: 30226815.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9297; val_auprc_score: 0.9180; val_best_acc_score: 0.8486; val_best_f1_score: 0.8578; train_kl_reg_loss: 96571.1768; train_edge_recon_loss: 2822644.6069; train_gene_expr_recon_loss: 24224380.7939; train_masked_gp_l1_reg_loss: 112615.5231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71165.3794; train_chrom_access_recon_loss: 2826241.8187; train_global_loss: 30153619.1298; train_optim_loss: 30153619.1298; val_kl_reg_loss: 94978.6505; val_edge_recon_loss: 2847351.2500; val_gene_expr_recon_loss: 24140124.1333; val_masked_gp_l1_reg_loss: 113650.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68693.1875; val_chrom_access_recon_loss: 2816922.4000; val_global_loss: 30081720.5333; val_optim_loss: 30081720.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9456; val_auprc_score: 0.9356; val_best_acc_score: 0.8747; val_best_f1_score: 0.8781; train_kl_reg_loss: 97448.5160; train_edge_recon_loss: 2793274.8645; train_gene_expr_recon_loss: 24076779.0382; train_masked_gp_l1_reg_loss: 114895.5710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66339.8265; train_chrom_access_recon_loss: 2809889.1947; train_global_loss: 29958627.0229; train_optim_loss: 29958627.0229; val_kl_reg_loss: 96974.0099; val_edge_recon_loss: 2826436.3000; val_gene_expr_recon_loss: 24040735.0667; val_masked_gp_l1_reg_loss: 115914.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64500.4766; val_chrom_access_recon_loss: 2785254.0333; val_global_loss: 29929813.2000; val_optim_loss: 29929813.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9469; val_auprc_score: 0.9348; val_best_acc_score: 0.8828; val_best_f1_score: 0.8879; train_kl_reg_loss: 99358.6314; train_edge_recon_loss: 2768825.4714; train_gene_expr_recon_loss: 23963006.7634; train_masked_gp_l1_reg_loss: 116892.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62477.6295; train_chrom_access_recon_loss: 2795074.5267; train_global_loss: 29805635.5267; train_optim_loss: 29805635.5267; val_kl_reg_loss: 97969.4130; val_edge_recon_loss: 2770849.0833; val_gene_expr_recon_loss: 23933639.2000; val_masked_gp_l1_reg_loss: 117820.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60938.7031; val_chrom_access_recon_loss: 2774568.5833; val_global_loss: 29755784.1333; val_optim_loss: 29755784.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9563; val_auprc_score: 0.9477; val_best_acc_score: 0.8953; val_best_f1_score: 0.8991; train_kl_reg_loss: 95634.3523; train_edge_recon_loss: 2757867.0763; train_gene_expr_recon_loss: 23836844.0458; train_masked_gp_l1_reg_loss: 118917.0454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59370.1041; train_chrom_access_recon_loss: 2778335.4924; train_global_loss: 29646968.0305; train_optim_loss: 29646968.0305; val_kl_reg_loss: 96622.5677; val_edge_recon_loss: 2766389.1500; val_gene_expr_recon_loss: 23885798.9333; val_masked_gp_l1_reg_loss: 119936.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58285.2227; val_chrom_access_recon_loss: 2764726.6000; val_global_loss: 29691759.2000; val_optim_loss: 29691759.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9588; val_auprc_score: 0.9478; val_best_acc_score: 0.9008; val_best_f1_score: 0.9046; train_kl_reg_loss: 95523.4547; train_edge_recon_loss: 2745007.1832; train_gene_expr_recon_loss: 23756845.6947; train_masked_gp_l1_reg_loss: 120783.1862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57056.4354; train_chrom_access_recon_loss: 2767491.2118; train_global_loss: 29542707.1145; train_optim_loss: 29542707.1145; val_kl_reg_loss: 95324.7031; val_edge_recon_loss: 2739191.8167; val_gene_expr_recon_loss: 23759305.6000; val_masked_gp_l1_reg_loss: 121664.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56143.4062; val_chrom_access_recon_loss: 2754131.1500; val_global_loss: 29525761.6000; val_optim_loss: 29525761.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9549; val_auprc_score: 0.9411; val_best_acc_score: 0.8967; val_best_f1_score: 0.9015; train_kl_reg_loss: 94162.9171; train_edge_recon_loss: 2739256.5802; train_gene_expr_recon_loss: 23668043.5573; train_masked_gp_l1_reg_loss: 122450.0197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55157.4450; train_chrom_access_recon_loss: 2753446.9179; train_global_loss: 29432517.4809; train_optim_loss: 29432517.4809; val_kl_reg_loss: 94166.3182; val_edge_recon_loss: 2749458.6833; val_gene_expr_recon_loss: 23748231.6000; val_masked_gp_l1_reg_loss: 123135.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54356.1953; val_chrom_access_recon_loss: 2744057.3500; val_global_loss: 29513406.2667; val_optim_loss: 29513406.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9630; val_auprc_score: 0.9546; val_best_acc_score: 0.9047; val_best_f1_score: 0.9081; train_kl_reg_loss: 93063.7417; train_edge_recon_loss: 2730460.6966; train_gene_expr_recon_loss: 23577297.2366; train_masked_gp_l1_reg_loss: 123844.4392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53474.8972; train_chrom_access_recon_loss: 2742410.0649; train_global_loss: 29320551.0534; train_optim_loss: 29320551.0534; val_kl_reg_loss: 92458.3958; val_edge_recon_loss: 2728877.0167; val_gene_expr_recon_loss: 23595140.2667; val_masked_gp_l1_reg_loss: 124542.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53511.8906; val_chrom_access_recon_loss: 2741609.2500; val_global_loss: 29336139.0667; val_optim_loss: 29336139.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9642; val_auprc_score: 0.9536; val_best_acc_score: 0.9091; val_best_f1_score: 0.9126; train_kl_reg_loss: 91269.2095; train_edge_recon_loss: 2728473.2004; train_gene_expr_recon_loss: 23487206.6107; train_masked_gp_l1_reg_loss: 125168.5516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52560.6851; train_chrom_access_recon_loss: 2730847.3263; train_global_loss: 29215525.5115; train_optim_loss: 29215525.5115; val_kl_reg_loss: 93137.0698; val_edge_recon_loss: 2724162.6833; val_gene_expr_recon_loss: 23471148.2667; val_masked_gp_l1_reg_loss: 125750.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51853.7773; val_chrom_access_recon_loss: 2714342.2833; val_global_loss: 29180394.0000; val_optim_loss: 29180394.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9678; val_auprc_score: 0.9595; val_best_acc_score: 0.9132; val_best_f1_score: 0.9160; train_kl_reg_loss: 90899.3474; train_edge_recon_loss: 2717075.2061; train_gene_expr_recon_loss: 23426158.0153; train_masked_gp_l1_reg_loss: 126420.6288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51374.2246; train_chrom_access_recon_loss: 2722274.8531; train_global_loss: 29134202.3206; train_optim_loss: 29134202.3206; val_kl_reg_loss: 89260.6990; val_edge_recon_loss: 2735875.2500; val_gene_expr_recon_loss: 23401963.3333; val_masked_gp_l1_reg_loss: 126858.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50839.6484; val_chrom_access_recon_loss: 2708506.4667; val_global_loss: 29113303.8667; val_optim_loss: 29113303.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9667; val_auprc_score: 0.9557; val_best_acc_score: 0.9161; val_best_f1_score: 0.9183; train_kl_reg_loss: 90844.6068; train_edge_recon_loss: 2717983.7557; train_gene_expr_recon_loss: 23358467.5420; train_masked_gp_l1_reg_loss: 127541.7063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50524.2384; train_chrom_access_recon_loss: 2713577.1031; train_global_loss: 29058938.9771; train_optim_loss: 29058938.9771; val_kl_reg_loss: 91961.0557; val_edge_recon_loss: 2724185.9500; val_gene_expr_recon_loss: 23361470.6667; val_masked_gp_l1_reg_loss: 128013.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50501.9062; val_chrom_access_recon_loss: 2707407.7167; val_global_loss: 29063541.6000; val_optim_loss: 29063541.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9707; val_auprc_score: 0.9626; val_best_acc_score: 0.9192; val_best_f1_score: 0.9223; train_kl_reg_loss: 89644.8022; train_edge_recon_loss: 2712458.1927; train_gene_expr_recon_loss: 23317625.2672; train_masked_gp_l1_reg_loss: 128684.3179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49871.0273; train_chrom_access_recon_loss: 2707614.1794; train_global_loss: 29005897.7405; train_optim_loss: 29005897.7405; val_kl_reg_loss: 89649.1318; val_edge_recon_loss: 2725555.7167; val_gene_expr_recon_loss: 23354036.1333; val_masked_gp_l1_reg_loss: 129276.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49624.1406; val_chrom_access_recon_loss: 2693722.8500; val_global_loss: 29041863.7333; val_optim_loss: 29041863.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9733; val_auprc_score: 0.9656; val_best_acc_score: 0.9225; val_best_f1_score: 0.9245; train_kl_reg_loss: 89437.5774; train_edge_recon_loss: 2703246.8206; train_gene_expr_recon_loss: 23246466.9771; train_masked_gp_l1_reg_loss: 129794.3646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49171.4480; train_chrom_access_recon_loss: 2698650.0095; train_global_loss: 28916767.1298; train_optim_loss: 28916767.1298; val_kl_reg_loss: 90127.5656; val_edge_recon_loss: 2709084.3667; val_gene_expr_recon_loss: 23322946.1333; val_masked_gp_l1_reg_loss: 130488.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49392.0547; val_chrom_access_recon_loss: 2698060.4167; val_global_loss: 29000098.1333; val_optim_loss: 29000098.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9724; val_auprc_score: 0.9644; val_best_acc_score: 0.9223; val_best_f1_score: 0.9254; train_kl_reg_loss: 88542.4963; train_edge_recon_loss: 2699732.3989; train_gene_expr_recon_loss: 23197618.7328; train_masked_gp_l1_reg_loss: 131083.0033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48931.0554; train_chrom_access_recon_loss: 2690896.2863; train_global_loss: 28856803.7557; train_optim_loss: 28856803.7557; val_kl_reg_loss: 88773.9214; val_edge_recon_loss: 2700079.8333; val_gene_expr_recon_loss: 23235203.8667; val_masked_gp_l1_reg_loss: 131475.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48372.4805; val_chrom_access_recon_loss: 2680891.8333; val_global_loss: 28884797.3333; val_optim_loss: 28884797.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9736; val_auprc_score: 0.9647; val_best_acc_score: 0.9258; val_best_f1_score: 0.9278; train_kl_reg_loss: 87769.0018; train_edge_recon_loss: 2703461.4466; train_gene_expr_recon_loss: 23133364.7481; train_masked_gp_l1_reg_loss: 131928.9350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48315.0340; train_chrom_access_recon_loss: 2685399.7195; train_global_loss: 28790238.7176; train_optim_loss: 28790238.7176; val_kl_reg_loss: 88366.7833; val_edge_recon_loss: 2708072.0000; val_gene_expr_recon_loss: 23265768.6667; val_masked_gp_l1_reg_loss: 132569.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48460.5820; val_chrom_access_recon_loss: 2687189.9833; val_global_loss: 28930427.4667; val_optim_loss: 28930427.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9755; val_auprc_score: 0.9690; val_best_acc_score: 0.9282; val_best_f1_score: 0.9300; train_kl_reg_loss: 86558.6000; train_edge_recon_loss: 2696461.0019; train_gene_expr_recon_loss: 23103018.0000; train_masked_gp_l1_reg_loss: 133010.3488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48433.9301; train_chrom_access_recon_loss: 2680917.9103; train_global_loss: 28748399.8931; train_optim_loss: 28748399.8931; val_kl_reg_loss: 87063.1927; val_edge_recon_loss: 2708511.1167; val_gene_expr_recon_loss: 23167673.6000; val_masked_gp_l1_reg_loss: 133496.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48035.6641; val_chrom_access_recon_loss: 2666254.9667; val_global_loss: 28811034.8000; val_optim_loss: 28811034.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9310; val_best_f1_score: 0.9332; train_kl_reg_loss: 86060.8151; train_edge_recon_loss: 2696429.4370; train_gene_expr_recon_loss: 23040494.8244; train_masked_gp_l1_reg_loss: 133936.5505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48254.0842; train_chrom_access_recon_loss: 2675745.0134; train_global_loss: 28680920.6718; train_optim_loss: 28680920.6718; val_kl_reg_loss: 86004.6198; val_edge_recon_loss: 2701196.5167; val_gene_expr_recon_loss: 23092545.4667; val_masked_gp_l1_reg_loss: 134502.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48479.4336; val_chrom_access_recon_loss: 2671679.5000; val_global_loss: 28734408.2667; val_optim_loss: 28734408.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9744; val_auprc_score: 0.9650; val_best_acc_score: 0.9287; val_best_f1_score: 0.9305; train_kl_reg_loss: 85816.1399; train_edge_recon_loss: 2688746.9141; train_gene_expr_recon_loss: 23012559.7557; train_masked_gp_l1_reg_loss: 134926.5261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48482.2547; train_chrom_access_recon_loss: 2670577.8817; train_global_loss: 28641109.4046; train_optim_loss: 28641109.4046; val_kl_reg_loss: 84403.3531; val_edge_recon_loss: 2699281.6667; val_gene_expr_recon_loss: 23011372.4000; val_masked_gp_l1_reg_loss: 135425.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48679.6133; val_chrom_access_recon_loss: 2657535.2833; val_global_loss: 28636698.4000; val_optim_loss: 28636698.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9763; val_auprc_score: 0.9703; val_best_acc_score: 0.9289; val_best_f1_score: 0.9309; train_kl_reg_loss: 88728.2295; train_edge_recon_loss: 2720005.9714; train_gene_expr_recon_loss: 22625175.7099; train_masked_gp_l1_reg_loss: 133217.7946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39549.9142; train_chrom_access_recon_loss: 2632187.9485; train_global_loss: 28238865.5878; train_optim_loss: 28238865.5878; val_kl_reg_loss: 67542.5656; val_edge_recon_loss: 2722140.0333; val_gene_expr_recon_loss: 22678346.2667; val_masked_gp_l1_reg_loss: 132800.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37732.2266; val_chrom_access_recon_loss: 2617779.0500; val_global_loss: 28256339.8667; val_optim_loss: 28256339.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9746; val_auprc_score: 0.9642; val_best_acc_score: 0.9295; val_best_f1_score: 0.9321; train_kl_reg_loss: 88513.5771; train_edge_recon_loss: 2702814.9313; train_gene_expr_recon_loss: 22556402.1221; train_masked_gp_l1_reg_loss: 132774.2238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37519.7252; train_chrom_access_recon_loss: 2621761.7710; train_global_loss: 28139786.3969; train_optim_loss: 28139786.3969; val_kl_reg_loss: 72713.4042; val_edge_recon_loss: 2716530.4500; val_gene_expr_recon_loss: 22606742.1333; val_masked_gp_l1_reg_loss: 132714.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37302.1953; val_chrom_access_recon_loss: 2612690.6333; val_global_loss: 28178692.5333; val_optim_loss: 28178692.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9780; val_auprc_score: 0.9729; val_best_acc_score: 0.9318; val_best_f1_score: 0.9341; train_kl_reg_loss: 85593.1317; train_edge_recon_loss: 2696758.4389; train_gene_expr_recon_loss: 22509269.9695; train_masked_gp_l1_reg_loss: 132707.1288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37326.2229; train_chrom_access_recon_loss: 2615830.5840; train_global_loss: 28077485.4046; train_optim_loss: 28077485.4046; val_kl_reg_loss: 74655.2406; val_edge_recon_loss: 2683117.3000; val_gene_expr_recon_loss: 22569634.6667; val_masked_gp_l1_reg_loss: 132834.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37264.0273; val_chrom_access_recon_loss: 2600638.8167; val_global_loss: 28098144.4000; val_optim_loss: 28098144.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9783; val_auprc_score: 0.9692; val_best_acc_score: 0.9357; val_best_f1_score: 0.9371; train_kl_reg_loss: 83018.0986; train_edge_recon_loss: 2693945.3569; train_gene_expr_recon_loss: 22495892.7176; train_masked_gp_l1_reg_loss: 132852.5686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37170.1703; train_chrom_access_recon_loss: 2616127.7729; train_global_loss: 28059006.6718; train_optim_loss: 28059006.6718; val_kl_reg_loss: 74447.6859; val_edge_recon_loss: 2693889.4167; val_gene_expr_recon_loss: 22605995.8667; val_masked_gp_l1_reg_loss: 133038.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37258.9062; val_chrom_access_recon_loss: 2606352.4000; val_global_loss: 28150981.0667; val_optim_loss: 28150981.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9795; val_auprc_score: 0.9740; val_best_acc_score: 0.9369; val_best_f1_score: 0.9382; train_kl_reg_loss: 82131.1369; train_edge_recon_loss: 2693672.9027; train_gene_expr_recon_loss: 22447605.0229; train_masked_gp_l1_reg_loss: 132999.4263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37179.0357; train_chrom_access_recon_loss: 2609554.0134; train_global_loss: 28003141.6794; train_optim_loss: 28003141.6794; val_kl_reg_loss: 74726.4422; val_edge_recon_loss: 2694012.8667; val_gene_expr_recon_loss: 22444217.3333; val_masked_gp_l1_reg_loss: 133102.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36999.7617; val_chrom_access_recon_loss: 2600239.9833; val_global_loss: 27983298.5333; val_optim_loss: 27983298.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9796; val_auprc_score: 0.9735; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 80997.1924; train_edge_recon_loss: 2685310.1412; train_gene_expr_recon_loss: 22436023.2519; train_masked_gp_l1_reg_loss: 133198.2523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37017.1383; train_chrom_access_recon_loss: 2610190.4790; train_global_loss: 27982736.4733; train_optim_loss: 27982736.4733; val_kl_reg_loss: 75114.8193; val_edge_recon_loss: 2690092.4333; val_gene_expr_recon_loss: 22487788.5333; val_masked_gp_l1_reg_loss: 133310.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36966.1797; val_chrom_access_recon_loss: 2610208.2833; val_global_loss: 28033479.8667; val_optim_loss: 28033479.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9808; val_auprc_score: 0.9753; val_best_acc_score: 0.9380; val_best_f1_score: 0.9395; train_kl_reg_loss: 79980.5515; train_edge_recon_loss: 2682692.6927; train_gene_expr_recon_loss: 22398973.7099; train_masked_gp_l1_reg_loss: 133449.6727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36930.4707; train_chrom_access_recon_loss: 2606650.6011; train_global_loss: 27938677.5267; train_optim_loss: 27938677.5267; val_kl_reg_loss: 75597.9984; val_edge_recon_loss: 2692815.8667; val_gene_expr_recon_loss: 22456812.0000; val_masked_gp_l1_reg_loss: 133611.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36873.5469; val_chrom_access_recon_loss: 2593755.2833; val_global_loss: 27989467.3333; val_optim_loss: 27989467.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9836; val_auprc_score: 0.9791; val_best_acc_score: 0.9430; val_best_f1_score: 0.9442; train_kl_reg_loss: 78625.5804; train_edge_recon_loss: 2687053.7233; train_gene_expr_recon_loss: 22371948.3664; train_masked_gp_l1_reg_loss: 133683.4809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36852.0489; train_chrom_access_recon_loss: 2604117.7729; train_global_loss: 27912280.9771; train_optim_loss: 27912280.9771; val_kl_reg_loss: 76011.8458; val_edge_recon_loss: 2659858.9167; val_gene_expr_recon_loss: 22485356.5333; val_masked_gp_l1_reg_loss: 133756.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36676.6602; val_chrom_access_recon_loss: 2603545.9500; val_global_loss: 27995204.9333; val_optim_loss: 27995204.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9797; val_auprc_score: 0.9747; val_best_acc_score: 0.9330; val_best_f1_score: 0.9341; train_kl_reg_loss: 78691.6915; train_edge_recon_loss: 2684931.8531; train_gene_expr_recon_loss: 22363402.9160; train_masked_gp_l1_reg_loss: 133904.8730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36818.2371; train_chrom_access_recon_loss: 2602646.6508; train_global_loss: 27900396.3511; train_optim_loss: 27900396.3511; val_kl_reg_loss: 76545.0391; val_edge_recon_loss: 2695757.7000; val_gene_expr_recon_loss: 22402887.8667; val_masked_gp_l1_reg_loss: 134026.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36762.5234; val_chrom_access_recon_loss: 2587975.0333; val_global_loss: 27933953.7333; val_optim_loss: 27933953.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9823; val_auprc_score: 0.9785; val_best_acc_score: 0.9365; val_best_f1_score: 0.9380; train_kl_reg_loss: 78545.7646; train_edge_recon_loss: 2680264.5763; train_gene_expr_recon_loss: 22354125.5573; train_masked_gp_l1_reg_loss: 134075.2539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36056.5933; train_chrom_access_recon_loss: 2604051.3893; train_global_loss: 27887119.0534; train_optim_loss: 27887119.0534; val_kl_reg_loss: 75462.2526; val_edge_recon_loss: 2705999.0333; val_gene_expr_recon_loss: 22364611.6000; val_masked_gp_l1_reg_loss: 134285.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35804.4727; val_chrom_access_recon_loss: 2592054.9333; val_global_loss: 27908217.7333; val_optim_loss: 27908217.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9791; val_auprc_score: 0.9742; val_best_acc_score: 0.9340; val_best_f1_score: 0.9360; train_kl_reg_loss: 78241.8781; train_edge_recon_loss: 2679815.9466; train_gene_expr_recon_loss: 22305548.3664; train_masked_gp_l1_reg_loss: 134366.9272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35835.8987; train_chrom_access_recon_loss: 2598681.6393; train_global_loss: 27832490.6260; train_optim_loss: 27832490.6260; val_kl_reg_loss: 75325.5214; val_edge_recon_loss: 2688747.7333; val_gene_expr_recon_loss: 22488030.2667; val_masked_gp_l1_reg_loss: 134367.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35786.5000; val_chrom_access_recon_loss: 2598859.2833; val_global_loss: 28021116.9333; val_optim_loss: 28021116.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9833; val_auprc_score: 0.9786; val_best_acc_score: 0.9400; val_best_f1_score: 0.9408; train_kl_reg_loss: 77223.9622; train_edge_recon_loss: 2682290.7653; train_gene_expr_recon_loss: 22299453.3435; train_masked_gp_l1_reg_loss: 134561.5624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35920.0443; train_chrom_access_recon_loss: 2598112.0344; train_global_loss: 27827561.7863; train_optim_loss: 27827561.7863; val_kl_reg_loss: 76471.5469; val_edge_recon_loss: 2705461.8667; val_gene_expr_recon_loss: 22456869.2000; val_masked_gp_l1_reg_loss: 134717.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35804.4492; val_chrom_access_recon_loss: 2590712.3167; val_global_loss: 28000037.0667; val_optim_loss: 28000037.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9832; val_auprc_score: 0.9775; val_best_acc_score: 0.9426; val_best_f1_score: 0.9432; train_kl_reg_loss: 77179.8256; train_edge_recon_loss: 2677972.3931; train_gene_expr_recon_loss: 22275576.5649; train_masked_gp_l1_reg_loss: 134829.5030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35900.7915; train_chrom_access_recon_loss: 2596138.6832; train_global_loss: 27797597.6794; train_optim_loss: 27797597.6794; val_kl_reg_loss: 73816.7943; val_edge_recon_loss: 2685664.2000; val_gene_expr_recon_loss: 22360121.7333; val_masked_gp_l1_reg_loss: 134813.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35805.3633; val_chrom_access_recon_loss: 2585443.0000; val_global_loss: 27875665.7333; val_optim_loss: 27875665.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9835; val_auprc_score: 0.9793; val_best_acc_score: 0.9433; val_best_f1_score: 0.9450; train_kl_reg_loss: 76582.7295; train_edge_recon_loss: 2681219.3912; train_gene_expr_recon_loss: 22251654.2901; train_masked_gp_l1_reg_loss: 135066.9152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35904.5779; train_chrom_access_recon_loss: 2594267.0191; train_global_loss: 27774694.9618; train_optim_loss: 27774694.9618; val_kl_reg_loss: 76677.4865; val_edge_recon_loss: 2678060.1833; val_gene_expr_recon_loss: 22380881.6000; val_masked_gp_l1_reg_loss: 135205.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35935.4141; val_chrom_access_recon_loss: 2585533.5167; val_global_loss: 27892294.9333; val_optim_loss: 27892294.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9851; val_auprc_score: 0.9816; val_best_acc_score: 0.9460; val_best_f1_score: 0.9468; train_kl_reg_loss: 76747.3277; train_edge_recon_loss: 2674999.6374; train_gene_expr_recon_loss: 22240433.3435; train_masked_gp_l1_reg_loss: 135348.7972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36011.2583; train_chrom_access_recon_loss: 2593536.7080; train_global_loss: 27757077.2519; train_optim_loss: 27757077.2519; val_kl_reg_loss: 75432.3870; val_edge_recon_loss: 2678000.8167; val_gene_expr_recon_loss: 22390446.2667; val_masked_gp_l1_reg_loss: 135348.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35936.8398; val_chrom_access_recon_loss: 2602978.4333; val_global_loss: 27918141.7333; val_optim_loss: 27918141.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9840; val_auprc_score: 0.9782; val_best_acc_score: 0.9437; val_best_f1_score: 0.9452; train_kl_reg_loss: 76350.5883; train_edge_recon_loss: 2684268.4676; train_gene_expr_recon_loss: 22235703.2519; train_masked_gp_l1_reg_loss: 135633.0284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36067.3421; train_chrom_access_recon_loss: 2593857.9485; train_global_loss: 27761880.5344; train_optim_loss: 27761880.5344; val_kl_reg_loss: 75001.6490; val_edge_recon_loss: 2672519.6167; val_gene_expr_recon_loss: 22274504.5333; val_masked_gp_l1_reg_loss: 135736.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36040.1133; val_chrom_access_recon_loss: 2588460.6167; val_global_loss: 27782262.0000; val_optim_loss: 27782262.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9837; val_auprc_score: 0.9796; val_best_acc_score: 0.9425; val_best_f1_score: 0.9435; train_kl_reg_loss: 76436.5287; train_edge_recon_loss: 2675202.7863; train_gene_expr_recon_loss: 22189261.4351; train_masked_gp_l1_reg_loss: 135958.6301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36106.3389; train_chrom_access_recon_loss: 2587157.6756; train_global_loss: 27700123.3740; train_optim_loss: 27700123.3740; val_kl_reg_loss: 74535.6891; val_edge_recon_loss: 2692946.8167; val_gene_expr_recon_loss: 22344725.4667; val_masked_gp_l1_reg_loss: 136094.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36048.3633; val_chrom_access_recon_loss: 2582309.8167; val_global_loss: 27866659.4667; val_optim_loss: 27866659.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9835; val_auprc_score: 0.9779; val_best_acc_score: 0.9434; val_best_f1_score: 0.9450; train_kl_reg_loss: 76036.3016; train_edge_recon_loss: 2677315.6183; train_gene_expr_recon_loss: 22193321.0840; train_masked_gp_l1_reg_loss: 136302.0939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36135.5670; train_chrom_access_recon_loss: 2589240.0763; train_global_loss: 27708350.7634; train_optim_loss: 27708350.7634; val_kl_reg_loss: 74948.8469; val_edge_recon_loss: 2697504.8667; val_gene_expr_recon_loss: 22269322.6667; val_masked_gp_l1_reg_loss: 136429.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36015.2227; val_chrom_access_recon_loss: 2570870.3167; val_global_loss: 27785092.6667; val_optim_loss: 27785092.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9874; val_auprc_score: 0.9848; val_best_acc_score: 0.9501; val_best_f1_score: 0.9512; train_kl_reg_loss: 76621.2753; train_edge_recon_loss: 2675617.9313; train_gene_expr_recon_loss: 22156377.6183; train_masked_gp_l1_reg_loss: 136611.5116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36130.3435; train_chrom_access_recon_loss: 2586330.9351; train_global_loss: 27667689.4504; train_optim_loss: 27667689.4504; val_kl_reg_loss: 74098.2828; val_edge_recon_loss: 2681679.4167; val_gene_expr_recon_loss: 22321348.9333; val_masked_gp_l1_reg_loss: 136684.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36089.8359; val_chrom_access_recon_loss: 2575202.9833; val_global_loss: 27825103.4667; val_optim_loss: 27825103.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9839; val_auprc_score: 0.9774; val_best_acc_score: 0.9458; val_best_f1_score: 0.9473; train_kl_reg_loss: 76339.1678; train_edge_recon_loss: 2679337.3130; train_gene_expr_recon_loss: 22146362.3359; train_masked_gp_l1_reg_loss: 136911.4336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36203.1619; train_chrom_access_recon_loss: 2587675.4618; train_global_loss: 27662828.8244; train_optim_loss: 27662828.8244; val_kl_reg_loss: 73630.5172; val_edge_recon_loss: 2692391.6833; val_gene_expr_recon_loss: 22322529.3333; val_masked_gp_l1_reg_loss: 137004.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36412.7422; val_chrom_access_recon_loss: 2586679.7833; val_global_loss: 27848647.6000; val_optim_loss: 27848647.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9868; val_auprc_score: 0.9834; val_best_acc_score: 0.9523; val_best_f1_score: 0.9533; train_kl_reg_loss: 76149.4370; train_edge_recon_loss: 2677118.8282; train_gene_expr_recon_loss: 22104780.0763; train_masked_gp_l1_reg_loss: 135662.9290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32887.5459; train_chrom_access_recon_loss: 2584402.7958; train_global_loss: 27611001.6183; train_optim_loss: 27611001.6183; val_kl_reg_loss: 75134.2922; val_edge_recon_loss: 2670643.7333; val_gene_expr_recon_loss: 22253745.3333; val_masked_gp_l1_reg_loss: 135081.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32229.7676; val_chrom_access_recon_loss: 2572540.8667; val_global_loss: 27739376.4000; val_optim_loss: 27739376.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9863; val_auprc_score: 0.9832; val_best_acc_score: 0.9485; val_best_f1_score: 0.9494; train_kl_reg_loss: 77113.3297; train_edge_recon_loss: 2674237.2615; train_gene_expr_recon_loss: 22099433.9542; train_masked_gp_l1_reg_loss: 134897.7337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31991.3356; train_chrom_access_recon_loss: 2584907.4943; train_global_loss: 27602581.1908; train_optim_loss: 27602581.1908; val_kl_reg_loss: 75668.9151; val_edge_recon_loss: 2694946.5333; val_gene_expr_recon_loss: 22291679.7333; val_masked_gp_l1_reg_loss: 134797.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31787.0000; val_chrom_access_recon_loss: 2595824.7833; val_global_loss: 27824704.6667; val_optim_loss: 27824704.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9854; val_auprc_score: 0.9810; val_best_acc_score: 0.9499; val_best_f1_score: 0.9511; train_kl_reg_loss: 77464.7418; train_edge_recon_loss: 2672861.0267; train_gene_expr_recon_loss: 22093865.6489; train_masked_gp_l1_reg_loss: 134740.0155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31654.7946; train_chrom_access_recon_loss: 2583210.4599; train_global_loss: 27593796.7786; train_optim_loss: 27593796.7786; val_kl_reg_loss: 75989.0672; val_edge_recon_loss: 2691312.8333; val_gene_expr_recon_loss: 22236991.7333; val_masked_gp_l1_reg_loss: 134681.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31491.5410; val_chrom_access_recon_loss: 2568145.6000; val_global_loss: 27738613.3333; val_optim_loss: 27738613.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9868; val_auprc_score: 0.9816; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 77620.7047; train_edge_recon_loss: 2670991.4656; train_gene_expr_recon_loss: 22091467.3740; train_masked_gp_l1_reg_loss: 134653.8819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31396.0021; train_chrom_access_recon_loss: 2582559.0439; train_global_loss: 27588688.5344; train_optim_loss: 27588688.5344; val_kl_reg_loss: 76004.1880; val_edge_recon_loss: 2691605.8833; val_gene_expr_recon_loss: 22363125.8667; val_masked_gp_l1_reg_loss: 134636.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31250.5547; val_chrom_access_recon_loss: 2573503.6167; val_global_loss: 27870125.4667; val_optim_loss: 27870125.4667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9864; val_auprc_score: 0.9815; val_best_acc_score: 0.9487; val_best_f1_score: 0.9497; train_kl_reg_loss: 77797.3600; train_edge_recon_loss: 2670983.3836; train_gene_expr_recon_loss: 22095264.5496; train_masked_gp_l1_reg_loss: 134625.5415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31159.0981; train_chrom_access_recon_loss: 2586215.6469; train_global_loss: 27596045.4809; train_optim_loss: 27596045.4809; val_kl_reg_loss: 76308.8661; val_edge_recon_loss: 2693792.4500; val_gene_expr_recon_loss: 22352272.9333; val_masked_gp_l1_reg_loss: 134624.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31049.0176; val_chrom_access_recon_loss: 2589749.9000; val_global_loss: 27877798.2667; val_optim_loss: 27877798.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9866; val_auprc_score: 0.9838; val_best_acc_score: 0.9492; val_best_f1_score: 0.9501; train_kl_reg_loss: 77869.6838; train_edge_recon_loss: 2676273.8053; train_gene_expr_recon_loss: 22096247.3435; train_masked_gp_l1_reg_loss: 134637.4099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30983.0768; train_chrom_access_recon_loss: 2584297.4408; train_global_loss: 27600308.7023; train_optim_loss: 27600308.7023; val_kl_reg_loss: 75670.7552; val_edge_recon_loss: 2682701.6833; val_gene_expr_recon_loss: 22268584.8000; val_masked_gp_l1_reg_loss: 134632.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30871.7949; val_chrom_access_recon_loss: 2580067.1333; val_global_loss: 27772528.5333; val_optim_loss: 27772528.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9866; val_auprc_score: 0.9837; val_best_acc_score: 0.9480; val_best_f1_score: 0.9489; train_kl_reg_loss: 77677.4432; train_edge_recon_loss: 2673098.2214; train_gene_expr_recon_loss: 22076715.6031; train_masked_gp_l1_reg_loss: 134652.5406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30801.5155; train_chrom_access_recon_loss: 2583203.9198; train_global_loss: 27576149.1298; train_optim_loss: 27576149.1298; val_kl_reg_loss: 76183.2151; val_edge_recon_loss: 2695099.6333; val_gene_expr_recon_loss: 22294400.5333; val_masked_gp_l1_reg_loss: 134651.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30705.9902; val_chrom_access_recon_loss: 2584305.3167; val_global_loss: 27815346.4000; val_optim_loss: 27815346.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9874; val_auprc_score: 0.9833; val_best_acc_score: 0.9512; val_best_f1_score: 0.9520; train_kl_reg_loss: 77653.0247; train_edge_recon_loss: 2673245.0439; train_gene_expr_recon_loss: 22068986.5649; train_masked_gp_l1_reg_loss: 134515.5967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30356.8747; train_chrom_access_recon_loss: 2580906.6889; train_global_loss: 27565663.8168; train_optim_loss: 27565663.8168; val_kl_reg_loss: 76010.8568; val_edge_recon_loss: 2680414.4167; val_gene_expr_recon_loss: 22251210.1333; val_masked_gp_l1_reg_loss: 134441.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30304.5469; val_chrom_access_recon_loss: 2585794.5500; val_global_loss: 27758175.7333; val_optim_loss: 27758175.7333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9857; val_auprc_score: 0.9802; val_best_acc_score: 0.9485; val_best_f1_score: 0.9497; train_kl_reg_loss: 77763.3488; train_edge_recon_loss: 2675719.0153; train_gene_expr_recon_loss: 22076553.7863; train_masked_gp_l1_reg_loss: 134413.0516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30285.7313; train_chrom_access_recon_loss: 2586543.0324; train_global_loss: 27581277.9695; train_optim_loss: 27581277.9695; val_kl_reg_loss: 75984.4719; val_edge_recon_loss: 2685450.7167; val_gene_expr_recon_loss: 22166000.4000; val_masked_gp_l1_reg_loss: 134388.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30268.0488; val_chrom_access_recon_loss: 2575014.6333; val_global_loss: 27667106.5333; val_optim_loss: 27667106.5333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9855; val_auprc_score: 0.9825; val_best_acc_score: 0.9449; val_best_f1_score: 0.9461; train_kl_reg_loss: 77838.4076; train_edge_recon_loss: 2670832.0248; train_gene_expr_recon_loss: 22074478.4885; train_masked_gp_l1_reg_loss: 134375.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30254.3401; train_chrom_access_recon_loss: 2583775.7557; train_global_loss: 27571554.1832; train_optim_loss: 27571554.1832; val_kl_reg_loss: 76188.9880; val_edge_recon_loss: 2688427.3000; val_gene_expr_recon_loss: 22176938.9333; val_masked_gp_l1_reg_loss: 134362.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30237.5762; val_chrom_access_recon_loss: 2569271.9833; val_global_loss: 27675427.0667; val_optim_loss: 27675427.0667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9868; val_auprc_score: 0.9844; val_best_acc_score: 0.9501; val_best_f1_score: 0.9510; train_kl_reg_loss: 77868.7867; train_edge_recon_loss: 2666944.5954; train_gene_expr_recon_loss: 22061908.9771; train_masked_gp_l1_reg_loss: 134357.2438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30223.8770; train_chrom_access_recon_loss: 2583332.8645; train_global_loss: 27554636.2901; train_optim_loss: 27554636.2901; val_kl_reg_loss: 76316.7052; val_edge_recon_loss: 2679380.5167; val_gene_expr_recon_loss: 22226049.7333; val_masked_gp_l1_reg_loss: 134345.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30211.1699; val_chrom_access_recon_loss: 2578503.9833; val_global_loss: 27724809.0667; val_optim_loss: 27724809.0667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9885; val_auprc_score: 0.9863; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 77911.9826; train_edge_recon_loss: 2672479.9332; train_gene_expr_recon_loss: 22067247.2061; train_masked_gp_l1_reg_loss: 134342.8668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30199.9374; train_chrom_access_recon_loss: 2584117.3931; train_global_loss: 27566299.4198; train_optim_loss: 27566299.4198; val_kl_reg_loss: 76153.0698; val_edge_recon_loss: 2674915.8500; val_gene_expr_recon_loss: 22234394.4000; val_masked_gp_l1_reg_loss: 134339.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30186.6152; val_chrom_access_recon_loss: 2582350.1167; val_global_loss: 27732339.4667; val_optim_loss: 27732339.4667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9858; val_auprc_score: 0.9824; val_best_acc_score: 0.9477; val_best_f1_score: 0.9488; train_kl_reg_loss: 77950.2180; train_edge_recon_loss: 2670289.7844; train_gene_expr_recon_loss: 22071289.9237; train_masked_gp_l1_reg_loss: 134336.1605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30177.3572; train_chrom_access_recon_loss: 2582365.3168; train_global_loss: 27566408.6718; train_optim_loss: 27566408.6718; val_kl_reg_loss: 76327.3839; val_edge_recon_loss: 2691769.6000; val_gene_expr_recon_loss: 22405850.2667; val_masked_gp_l1_reg_loss: 134331.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30165.2832; val_chrom_access_recon_loss: 2597627.5333; val_global_loss: 27936072.9333; val_optim_loss: 27936072.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9881; val_auprc_score: 0.9852; val_best_acc_score: 0.9518; val_best_f1_score: 0.9529; train_kl_reg_loss: 77968.2449; train_edge_recon_loss: 2674629.8416; train_gene_expr_recon_loss: 22072010.7481; train_masked_gp_l1_reg_loss: 134318.3977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30129.3760; train_chrom_access_recon_loss: 2583755.8244; train_global_loss: 27572812.5344; train_optim_loss: 27572812.5344; val_kl_reg_loss: 76314.0922; val_edge_recon_loss: 2682933.3500; val_gene_expr_recon_loss: 22301094.0000; val_masked_gp_l1_reg_loss: 134311.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30124.2715; val_chrom_access_recon_loss: 2595038.2000; val_global_loss: 27819815.6000; val_optim_loss: 27819815.6000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9865; val_auprc_score: 0.9822; val_best_acc_score: 0.9510; val_best_f1_score: 0.9524; train_kl_reg_loss: 77973.7541; train_edge_recon_loss: 2669100.6050; train_gene_expr_recon_loss: 22073507.7557; train_masked_gp_l1_reg_loss: 134308.1362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30122.5499; train_chrom_access_recon_loss: 2583789.9237; train_global_loss: 27568802.8397; train_optim_loss: 27568802.8397; val_kl_reg_loss: 76185.1724; val_edge_recon_loss: 2676228.7000; val_gene_expr_recon_loss: 22263135.2000; val_masked_gp_l1_reg_loss: 134305.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30120.7070; val_chrom_access_recon_loss: 2576760.2667; val_global_loss: 27756735.3333; val_optim_loss: 27756735.3333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9858; val_auprc_score: 0.9834; val_best_acc_score: 0.9468; val_best_f1_score: 0.9478; train_kl_reg_loss: 78017.3039; train_edge_recon_loss: 2675750.8263; train_gene_expr_recon_loss: 22057382.6412; train_masked_gp_l1_reg_loss: 134303.3002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30119.2919; train_chrom_access_recon_loss: 2584059.3798; train_global_loss: 27559632.5496; train_optim_loss: 27559632.5496; val_kl_reg_loss: 76144.1812; val_edge_recon_loss: 2682116.1333; val_gene_expr_recon_loss: 22253338.8000; val_masked_gp_l1_reg_loss: 134301.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30117.6992; val_chrom_access_recon_loss: 2583002.9000; val_global_loss: 27759022.1333; val_optim_loss: 27759022.1333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9876; val_auprc_score: 0.9836; val_best_acc_score: 0.9531; val_best_f1_score: 0.9538; train_kl_reg_loss: 77985.2305; train_edge_recon_loss: 2667176.7634; train_gene_expr_recon_loss: 22070887.3893; train_masked_gp_l1_reg_loss: 134300.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30116.2950; train_chrom_access_recon_loss: 2585383.1317; train_global_loss: 27565849.4809; train_optim_loss: 27565849.4809; val_kl_reg_loss: 76252.2740; val_edge_recon_loss: 2677358.3500; val_gene_expr_recon_loss: 22324959.2000; val_masked_gp_l1_reg_loss: 134299.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30114.8320; val_chrom_access_recon_loss: 2580308.8833; val_global_loss: 27823293.2000; val_optim_loss: 27823293.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 81 min 31 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9862
val AUPRC score: 0.9824
val best accuracy score: 0.9493
val best F1 score: 0.9504
val target rna MSE score: 0.7795
val source rna MSE score: 0.1446
val target atac MSE score: 0.3400
val source atac MSE score: 0.0570
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
