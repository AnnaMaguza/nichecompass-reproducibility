[True]
Run timestamp: 24072023_165554_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9589; val_auprc_score: 0.9593; val_best_acc_score: 0.6820; val_best_f1_score: 0.7553; train_kl_reg_loss: 1202.6981; train_edge_recon_loss: 34649104.0000; train_gene_expr_recon_loss: 316069.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078340.5972; train_global_loss: 36044716.4444; train_optim_loss: 36044716.4444; val_kl_reg_loss: 507.3740; val_edge_recon_loss: 40087880.0000; val_gene_expr_recon_loss: 316818.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080509.2500; val_global_loss: 41485716.0000; val_optim_loss: 41485716.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9068; val_auprc_score: 0.8953; val_best_acc_score: 0.8275; val_best_f1_score: 0.8327; train_kl_reg_loss: 519.2687; train_edge_recon_loss: 34498641.7778; train_gene_expr_recon_loss: 315704.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073879.1042; train_global_loss: 35888745.3333; train_optim_loss: 35888745.3333; val_kl_reg_loss: 940.1350; val_edge_recon_loss: 34802372.0000; val_gene_expr_recon_loss: 314361.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079769.6250; val_global_loss: 36197440.0000; val_optim_loss: 36197440.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8714; val_auprc_score: 0.8643; val_best_acc_score: 0.7650; val_best_f1_score: 0.7912; train_kl_reg_loss: 4148.5589; train_edge_recon_loss: 31469098.6667; train_gene_expr_recon_loss: 310590.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1074085.5694; train_global_loss: 32857923.3333; train_optim_loss: 32857923.3333; val_kl_reg_loss: 13677.1855; val_edge_recon_loss: 28604754.0000; val_gene_expr_recon_loss: 316318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080889.8750; val_global_loss: 30015640.0000; val_optim_loss: 30015640.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8867; val_auprc_score: 0.8670; val_best_acc_score: 0.7971; val_best_f1_score: 0.8152; train_kl_reg_loss: 25640.1426; train_edge_recon_loss: 28148231.3333; train_gene_expr_recon_loss: 312247.6215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070887.9028; train_global_loss: 29557006.8889; train_optim_loss: 29557006.8889; val_kl_reg_loss: 35781.4766; val_edge_recon_loss: 28000506.0000; val_gene_expr_recon_loss: 313298.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076869.0000; val_global_loss: 29426456.0000; val_optim_loss: 29426456.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8990; val_auprc_score: 0.8721; val_best_acc_score: 0.8259; val_best_f1_score: 0.8404; train_kl_reg_loss: 40888.7374; train_edge_recon_loss: 27609419.5556; train_gene_expr_recon_loss: 309809.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066651.0903; train_global_loss: 29026769.1111; train_optim_loss: 29026769.1111; val_kl_reg_loss: 43702.0586; val_edge_recon_loss: 27761480.0000; val_gene_expr_recon_loss: 310643.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074793.2500; val_global_loss: 29190620.0000; val_optim_loss: 29190620.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9255; val_auprc_score: 0.9000; val_best_acc_score: 0.8661; val_best_f1_score: 0.8729; train_kl_reg_loss: 45902.4770; train_edge_recon_loss: 27254589.3333; train_gene_expr_recon_loss: 309858.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075650.0000; train_global_loss: 28686000.6667; train_optim_loss: 28686000.6667; val_kl_reg_loss: 45903.4219; val_edge_recon_loss: 27025660.0000; val_gene_expr_recon_loss: 308684.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067906.2500; val_global_loss: 28448154.0000; val_optim_loss: 28448154.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9273; val_auprc_score: 0.9057; val_best_acc_score: 0.8631; val_best_f1_score: 0.8714; train_kl_reg_loss: 47030.8290; train_edge_recon_loss: 27061943.3333; train_gene_expr_recon_loss: 307999.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1068159.2778; train_global_loss: 28485132.8889; train_optim_loss: 28485132.8889; val_kl_reg_loss: 46409.0508; val_edge_recon_loss: 27121562.0000; val_gene_expr_recon_loss: 307507.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067735.2500; val_global_loss: 28543216.0000; val_optim_loss: 28543216.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9354; val_auprc_score: 0.9135; val_best_acc_score: 0.8729; val_best_f1_score: 0.8795; train_kl_reg_loss: 46066.5091; train_edge_recon_loss: 26829081.5556; train_gene_expr_recon_loss: 304756.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069430.3056; train_global_loss: 28249334.6667; train_optim_loss: 28249334.6667; val_kl_reg_loss: 43268.8320; val_edge_recon_loss: 27062016.0000; val_gene_expr_recon_loss: 304696.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067368.7500; val_global_loss: 28477348.0000; val_optim_loss: 28477348.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9525; val_auprc_score: 0.9374; val_best_acc_score: 0.8946; val_best_f1_score: 0.8990; train_kl_reg_loss: 42093.9601; train_edge_recon_loss: 26735254.2222; train_gene_expr_recon_loss: 302841.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061242.8472; train_global_loss: 28141432.8889; train_optim_loss: 28141432.8889; val_kl_reg_loss: 39057.1250; val_edge_recon_loss: 26677292.0000; val_gene_expr_recon_loss: 302328.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064333.1250; val_global_loss: 28083012.0000; val_optim_loss: 28083012.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9540; val_auprc_score: 0.9406; val_best_acc_score: 0.8948; val_best_f1_score: 0.8989; train_kl_reg_loss: 37642.3763; train_edge_recon_loss: 26673928.2222; train_gene_expr_recon_loss: 301038.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065275.1250; train_global_loss: 28077884.6667; train_optim_loss: 28077884.6667; val_kl_reg_loss: 35378.8203; val_edge_recon_loss: 26938582.0000; val_gene_expr_recon_loss: 301038.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1066034.3750; val_global_loss: 28341032.0000; val_optim_loss: 28341032.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9589; val_auprc_score: 0.9436; val_best_acc_score: 0.9003; val_best_f1_score: 0.9052; train_kl_reg_loss: 34905.4158; train_edge_recon_loss: 26538720.0000; train_gene_expr_recon_loss: 298962.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063076.2639; train_global_loss: 27935663.7778; train_optim_loss: 27935663.7778; val_kl_reg_loss: 33731.6641; val_edge_recon_loss: 26586918.0000; val_gene_expr_recon_loss: 301381.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1066838.1250; val_global_loss: 27988870.0000; val_optim_loss: 27988870.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9582; val_auprc_score: 0.9367; val_best_acc_score: 0.9089; val_best_f1_score: 0.9126; train_kl_reg_loss: 34694.8681; train_edge_recon_loss: 26419525.3333; train_gene_expr_recon_loss: 296872.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065742.5972; train_global_loss: 27816835.1111; train_optim_loss: 27816835.1111; val_kl_reg_loss: 34844.6484; val_edge_recon_loss: 26406810.0000; val_gene_expr_recon_loss: 296826.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067977.7500; val_global_loss: 27806458.0000; val_optim_loss: 27806458.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9623; val_auprc_score: 0.9467; val_best_acc_score: 0.9120; val_best_f1_score: 0.9159; train_kl_reg_loss: 35509.6571; train_edge_recon_loss: 26375820.8889; train_gene_expr_recon_loss: 295273.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062175.2917; train_global_loss: 27768778.6667; train_optim_loss: 27768778.6667; val_kl_reg_loss: 34179.4141; val_edge_recon_loss: 26473168.0000; val_gene_expr_recon_loss: 297810.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064784.5000; val_global_loss: 27869942.0000; val_optim_loss: 27869942.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9662; val_auprc_score: 0.9506; val_best_acc_score: 0.9190; val_best_f1_score: 0.9227; train_kl_reg_loss: 34276.5052; train_edge_recon_loss: 26380101.7778; train_gene_expr_recon_loss: 292787.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053286.6458; train_global_loss: 27760452.6667; train_optim_loss: 27760452.6667; val_kl_reg_loss: 32856.8828; val_edge_recon_loss: 26355994.0000; val_gene_expr_recon_loss: 294642.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059455.6250; val_global_loss: 27742948.0000; val_optim_loss: 27742948.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9643; val_auprc_score: 0.9470; val_best_acc_score: 0.9159; val_best_f1_score: 0.9205; train_kl_reg_loss: 33140.2205; train_edge_recon_loss: 26323080.4444; train_gene_expr_recon_loss: 291796.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057688.5764; train_global_loss: 27705706.0000; train_optim_loss: 27705706.0000; val_kl_reg_loss: 32388.6836; val_edge_recon_loss: 26383766.0000; val_gene_expr_recon_loss: 292200.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058500.6250; val_global_loss: 27766854.0000; val_optim_loss: 27766854.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9675; val_auprc_score: 0.9519; val_best_acc_score: 0.9206; val_best_f1_score: 0.9247; train_kl_reg_loss: 32674.6513; train_edge_recon_loss: 26308455.5556; train_gene_expr_recon_loss: 291271.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059578.2639; train_global_loss: 27691980.4444; train_optim_loss: 27691980.4444; val_kl_reg_loss: 32214.5742; val_edge_recon_loss: 26300380.0000; val_gene_expr_recon_loss: 290269.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1055230.2500; val_global_loss: 27678094.0000; val_optim_loss: 27678094.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9684; val_auprc_score: 0.9530; val_best_acc_score: 0.9260; val_best_f1_score: 0.9292; train_kl_reg_loss: 32239.2166; train_edge_recon_loss: 26396375.5556; train_gene_expr_recon_loss: 287921.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048499.3681; train_global_loss: 27765036.0000; train_optim_loss: 27765036.0000; val_kl_reg_loss: 32033.6250; val_edge_recon_loss: 26455734.0000; val_gene_expr_recon_loss: 286429.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1054039.6250; val_global_loss: 27828238.0000; val_optim_loss: 27828238.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9723; val_auprc_score: 0.9598; val_best_acc_score: 0.9340; val_best_f1_score: 0.9361; train_kl_reg_loss: 32010.7305; train_edge_recon_loss: 26243424.0000; train_gene_expr_recon_loss: 286697.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052417.8958; train_global_loss: 27614549.5556; train_optim_loss: 27614549.5556; val_kl_reg_loss: 31703.0488; val_edge_recon_loss: 26160756.0000; val_gene_expr_recon_loss: 288924.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1054723.8750; val_global_loss: 27536108.0000; val_optim_loss: 27536108.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9733; val_auprc_score: 0.9597; val_best_acc_score: 0.9378; val_best_f1_score: 0.9399; train_kl_reg_loss: 32344.7431; train_edge_recon_loss: 26322337.5556; train_gene_expr_recon_loss: 286340.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052577.9861; train_global_loss: 27693600.4444; train_optim_loss: 27693600.4444; val_kl_reg_loss: 32022.4180; val_edge_recon_loss: 26251364.0000; val_gene_expr_recon_loss: 286010.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051731.5000; val_global_loss: 27621128.0000; val_optim_loss: 27621128.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9711; val_auprc_score: 0.9578; val_best_acc_score: 0.9287; val_best_f1_score: 0.9317; train_kl_reg_loss: 31886.3427; train_edge_recon_loss: 26372323.3333; train_gene_expr_recon_loss: 285129.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049169.4306; train_global_loss: 27738509.1111; train_optim_loss: 27738509.1111; val_kl_reg_loss: 30631.5801; val_edge_recon_loss: 26368616.0000; val_gene_expr_recon_loss: 285213.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051408.5000; val_global_loss: 27735870.0000; val_optim_loss: 27735870.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9691; val_auprc_score: 0.9530; val_best_acc_score: 0.9286; val_best_f1_score: 0.9317; train_kl_reg_loss: 31239.5321; train_edge_recon_loss: 26293554.4444; train_gene_expr_recon_loss: 283826.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047934.5069; train_global_loss: 27656555.3333; train_optim_loss: 27656555.3333; val_kl_reg_loss: 30124.0176; val_edge_recon_loss: 26609104.0000; val_gene_expr_recon_loss: 286746.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051291.0000; val_global_loss: 27977264.0000; val_optim_loss: 27977264.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9726; val_auprc_score: 0.9592; val_best_acc_score: 0.9342; val_best_f1_score: 0.9370; train_kl_reg_loss: 30389.7270; train_edge_recon_loss: 26294794.2222; train_gene_expr_recon_loss: 282951.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044942.3542; train_global_loss: 27653077.1111; train_optim_loss: 27653077.1111; val_kl_reg_loss: 29809.0605; val_edge_recon_loss: 26347896.0000; val_gene_expr_recon_loss: 282360.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1047751.3125; val_global_loss: 27707818.0000; val_optim_loss: 27707818.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9693; val_auprc_score: 0.9539; val_best_acc_score: 0.9302; val_best_f1_score: 0.9333; train_kl_reg_loss: 30400.7780; train_edge_recon_loss: 26298719.1111; train_gene_expr_recon_loss: 282090.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046007.7986; train_global_loss: 27657218.0000; train_optim_loss: 27657218.0000; val_kl_reg_loss: 29997.2383; val_edge_recon_loss: 26409664.0000; val_gene_expr_recon_loss: 282574.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046676.8750; val_global_loss: 27768912.0000; val_optim_loss: 27768912.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9712; val_auprc_score: 0.9571; val_best_acc_score: 0.9328; val_best_f1_score: 0.9359; train_kl_reg_loss: 30401.8158; train_edge_recon_loss: 26298301.7778; train_gene_expr_recon_loss: 281549.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040194.5069; train_global_loss: 27650447.5556; train_optim_loss: 27650447.5556; val_kl_reg_loss: 29806.4277; val_edge_recon_loss: 26428712.0000; val_gene_expr_recon_loss: 282297.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048271.1250; val_global_loss: 27789088.0000; val_optim_loss: 27789088.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9741; val_auprc_score: 0.9619; val_best_acc_score: 0.9349; val_best_f1_score: 0.9377; train_kl_reg_loss: 30116.5111; train_edge_recon_loss: 26336614.4444; train_gene_expr_recon_loss: 279927.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1039120.3681; train_global_loss: 27685778.8889; train_optim_loss: 27685778.8889; val_kl_reg_loss: 29936.5117; val_edge_recon_loss: 26276064.0000; val_gene_expr_recon_loss: 282740.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1047536.6250; val_global_loss: 27636276.0000; val_optim_loss: 27636276.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9711; val_auprc_score: 0.9584; val_best_acc_score: 0.9303; val_best_f1_score: 0.9336; train_kl_reg_loss: 30007.0738; train_edge_recon_loss: 26299103.1111; train_gene_expr_recon_loss: 279536.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038367.8819; train_global_loss: 27647013.5556; train_optim_loss: 27647013.5556; val_kl_reg_loss: 29768.4883; val_edge_recon_loss: 26567996.0000; val_gene_expr_recon_loss: 281908.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1047248.4375; val_global_loss: 27926920.0000; val_optim_loss: 27926920.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 28 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9666
Val AUPRC score: 0.9469
Val best accuracy score: 0.9263
Val best F1 score: 0.9292
Val gene expr MSE score: 0.6944
Val chrom access MSE score: 0.0911
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
