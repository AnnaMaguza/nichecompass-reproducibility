[True]
Run timestamp: 26072023_021049_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9598; val_auprc_score: 0.9616; val_best_acc_score: 0.7771; val_best_f1_score: 0.7779; train_kl_reg_loss: 681.8088; train_edge_recon_loss: 3464055.2500; train_gene_expr_recon_loss: 311657.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1083941.3611; train_global_loss: 4860336.3889; train_optim_loss: 4860336.3889; val_kl_reg_loss: 628.5430; val_edge_recon_loss: 3996793.7500; val_gene_expr_recon_loss: 307848.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071369.2500; val_global_loss: 5376640.0000; val_optim_loss: 5376640.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8786; val_auprc_score: 0.8697; val_best_acc_score: 0.7886; val_best_f1_score: 0.8065; train_kl_reg_loss: 934.1694; train_edge_recon_loss: 3402912.3889; train_gene_expr_recon_loss: 306321.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1083502.9583; train_global_loss: 4793671.5000; train_optim_loss: 4793671.5000; val_kl_reg_loss: 2750.8755; val_edge_recon_loss: 3196493.5000; val_gene_expr_recon_loss: 296245.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064018.0000; val_global_loss: 4559508.0000; val_optim_loss: 4559508.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8827; val_auprc_score: 0.8768; val_best_acc_score: 0.7905; val_best_f1_score: 0.7960; train_kl_reg_loss: 10515.2409; train_edge_recon_loss: 2973037.3889; train_gene_expr_recon_loss: 299500.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075898.4167; train_global_loss: 4358951.7778; train_optim_loss: 4358951.7778; val_kl_reg_loss: 23783.1973; val_edge_recon_loss: 2832976.0000; val_gene_expr_recon_loss: 300459.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065355.6250; val_global_loss: 4222574.5000; val_optim_loss: 4222574.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8997; val_auprc_score: 0.8832; val_best_acc_score: 0.8177; val_best_f1_score: 0.8257; train_kl_reg_loss: 31784.8247; train_edge_recon_loss: 2810347.8333; train_gene_expr_recon_loss: 297360.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069948.1250; train_global_loss: 4209441.4167; train_optim_loss: 4209441.4167; val_kl_reg_loss: 34918.0703; val_edge_recon_loss: 2800680.0000; val_gene_expr_recon_loss: 287015.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051199.5000; val_global_loss: 4173813.0000; val_optim_loss: 4173813.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9293; val_auprc_score: 0.9115; val_best_acc_score: 0.8596; val_best_f1_score: 0.8674; train_kl_reg_loss: 31511.2743; train_edge_recon_loss: 2763497.5833; train_gene_expr_recon_loss: 287908.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061513.7361; train_global_loss: 4144431.1111; train_optim_loss: 4144431.1111; val_kl_reg_loss: 22507.2715; val_edge_recon_loss: 2733563.2500; val_gene_expr_recon_loss: 287086.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052670.7500; val_global_loss: 4095828.0000; val_optim_loss: 4095828.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9353; val_auprc_score: 0.9156; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 21488.0454; train_edge_recon_loss: 2722553.0556; train_gene_expr_recon_loss: 285851.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054476.1667; train_global_loss: 4084368.8056; train_optim_loss: 4084368.8056; val_kl_reg_loss: 22012.0137; val_edge_recon_loss: 2733570.7500; val_gene_expr_recon_loss: 284744.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1049294.8750; val_global_loss: 4089622.0000; val_optim_loss: 4089622.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9482; val_auprc_score: 0.9302; val_best_acc_score: 0.8901; val_best_f1_score: 0.8941; train_kl_reg_loss: 24985.0503; train_edge_recon_loss: 2697190.1111; train_gene_expr_recon_loss: 283572.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057983.0069; train_global_loss: 4063730.5000; train_optim_loss: 4063730.5000; val_kl_reg_loss: 24225.2754; val_edge_recon_loss: 2710694.7500; val_gene_expr_recon_loss: 277772.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043642.9375; val_global_loss: 4056335.2500; val_optim_loss: 4056335.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9551; val_auprc_score: 0.9345; val_best_acc_score: 0.9043; val_best_f1_score: 0.9081; train_kl_reg_loss: 23217.7871; train_edge_recon_loss: 2670875.7778; train_gene_expr_recon_loss: 280139.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051329.0486; train_global_loss: 4025562.1111; train_optim_loss: 4025562.1111; val_kl_reg_loss: 21018.5547; val_edge_recon_loss: 2686734.0000; val_gene_expr_recon_loss: 277004.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1044155.6875; val_global_loss: 4028912.7500; val_optim_loss: 4028912.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9576; val_auprc_score: 0.9398; val_best_acc_score: 0.9081; val_best_f1_score: 0.9125; train_kl_reg_loss: 21684.3329; train_edge_recon_loss: 2665271.9444; train_gene_expr_recon_loss: 276138.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048544.8264; train_global_loss: 4011639.5833; train_optim_loss: 4011639.5833; val_kl_reg_loss: 20692.8750; val_edge_recon_loss: 2675862.2500; val_gene_expr_recon_loss: 273734.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040775.0625; val_global_loss: 4011064.5000; val_optim_loss: 4011064.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9598; val_auprc_score: 0.9430; val_best_acc_score: 0.9126; val_best_f1_score: 0.9166; train_kl_reg_loss: 21996.4286; train_edge_recon_loss: 2656982.4167; train_gene_expr_recon_loss: 272168.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044523.8681; train_global_loss: 3995670.7500; train_optim_loss: 3995670.7500; val_kl_reg_loss: 21273.8887; val_edge_recon_loss: 2681858.0000; val_gene_expr_recon_loss: 273982.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037614.8125; val_global_loss: 4014729.0000; val_optim_loss: 4014729.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9655; val_auprc_score: 0.9510; val_best_acc_score: 0.9169; val_best_f1_score: 0.9211; train_kl_reg_loss: 22016.0553; train_edge_recon_loss: 2649615.8333; train_gene_expr_recon_loss: 269591.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1039772.5000; train_global_loss: 3980996.0000; train_optim_loss: 3980996.0000; val_kl_reg_loss: 21625.8145; val_edge_recon_loss: 2679945.0000; val_gene_expr_recon_loss: 265166.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031117.5625; val_global_loss: 3997854.7500; val_optim_loss: 3997854.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9675; val_auprc_score: 0.9565; val_best_acc_score: 0.9214; val_best_f1_score: 0.9246; train_kl_reg_loss: 22424.2476; train_edge_recon_loss: 2640629.2222; train_gene_expr_recon_loss: 264738.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1039394.9167; train_global_loss: 3967186.9167; train_optim_loss: 3967186.9167; val_kl_reg_loss: 20992.1934; val_edge_recon_loss: 2674450.2500; val_gene_expr_recon_loss: 264151.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028986.6875; val_global_loss: 3988580.7500; val_optim_loss: 3988580.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9701; val_auprc_score: 0.9593; val_best_acc_score: 0.9245; val_best_f1_score: 0.9275; train_kl_reg_loss: 21620.5124; train_edge_recon_loss: 2649224.7778; train_gene_expr_recon_loss: 263141.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037764.7500; train_global_loss: 3971751.2500; train_optim_loss: 3971751.2500; val_kl_reg_loss: 20492.0195; val_edge_recon_loss: 2666112.2500; val_gene_expr_recon_loss: 261322.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025457.0000; val_global_loss: 3973383.2500; val_optim_loss: 3973383.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9690; val_auprc_score: 0.9576; val_best_acc_score: 0.9266; val_best_f1_score: 0.9300; train_kl_reg_loss: 21585.6927; train_edge_recon_loss: 2649339.2222; train_gene_expr_recon_loss: 260868.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032679.7569; train_global_loss: 3964473.6389; train_optim_loss: 3964473.6389; val_kl_reg_loss: 20602.8242; val_edge_recon_loss: 2638427.5000; val_gene_expr_recon_loss: 264606.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026635.6875; val_global_loss: 3950272.7500; val_optim_loss: 3950272.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9722; val_auprc_score: 0.9613; val_best_acc_score: 0.9303; val_best_f1_score: 0.9329; train_kl_reg_loss: 21574.9742; train_edge_recon_loss: 2660033.1944; train_gene_expr_recon_loss: 258225.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028236.3819; train_global_loss: 3968070.1944; train_optim_loss: 3968070.1944; val_kl_reg_loss: 21362.9219; val_edge_recon_loss: 2637024.5000; val_gene_expr_recon_loss: 257868.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022348.5625; val_global_loss: 3938604.5000; val_optim_loss: 3938604.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9731; val_auprc_score: 0.9616; val_best_acc_score: 0.9303; val_best_f1_score: 0.9323; train_kl_reg_loss: 22799.8746; train_edge_recon_loss: 2651544.5833; train_gene_expr_recon_loss: 255078.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024066.9167; train_global_loss: 3953490.1389; train_optim_loss: 3953490.1389; val_kl_reg_loss: 22302.8633; val_edge_recon_loss: 2660877.5000; val_gene_expr_recon_loss: 253717.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016588.0625; val_global_loss: 3953485.7500; val_optim_loss: 3953485.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9727; val_auprc_score: 0.9609; val_best_acc_score: 0.9349; val_best_f1_score: 0.9374; train_kl_reg_loss: 22493.5916; train_edge_recon_loss: 2650539.9444; train_gene_expr_recon_loss: 255283.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027826.4444; train_global_loss: 3956143.1944; train_optim_loss: 3956143.1944; val_kl_reg_loss: 21585.1523; val_edge_recon_loss: 2649288.0000; val_gene_expr_recon_loss: 253299.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015079.4375; val_global_loss: 3939252.2500; val_optim_loss: 3939252.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9723; val_auprc_score: 0.9617; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 22908.5410; train_edge_recon_loss: 2644192.2222; train_gene_expr_recon_loss: 252047.0295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024782.5000; train_global_loss: 3943930.2778; train_optim_loss: 3943930.2778; val_kl_reg_loss: 21555.0605; val_edge_recon_loss: 2638958.7500; val_gene_expr_recon_loss: 254390.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014635.3125; val_global_loss: 3929539.2500; val_optim_loss: 3929539.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9730; val_auprc_score: 0.9623; val_best_acc_score: 0.9364; val_best_f1_score: 0.9385; train_kl_reg_loss: 22461.1710; train_edge_recon_loss: 2636653.6667; train_gene_expr_recon_loss: 250430.7465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017120.1875; train_global_loss: 3926665.7222; train_optim_loss: 3926665.7222; val_kl_reg_loss: 22616.1016; val_edge_recon_loss: 2628021.7500; val_gene_expr_recon_loss: 253873.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014527.6250; val_global_loss: 3919038.5000; val_optim_loss: 3919038.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9758; val_auprc_score: 0.9630; val_best_acc_score: 0.9402; val_best_f1_score: 0.9421; train_kl_reg_loss: 23661.6918; train_edge_recon_loss: 2631966.2778; train_gene_expr_recon_loss: 248148.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018213.6597; train_global_loss: 3921990.5556; train_optim_loss: 3921990.5556; val_kl_reg_loss: 22325.6211; val_edge_recon_loss: 2612359.2500; val_gene_expr_recon_loss: 250405.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011644.8750; val_global_loss: 3896735.0000; val_optim_loss: 3896735.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9764; val_auprc_score: 0.9675; val_best_acc_score: 0.9376; val_best_f1_score: 0.9392; train_kl_reg_loss: 22460.8238; train_edge_recon_loss: 2639937.4444; train_gene_expr_recon_loss: 247229.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015608.5208; train_global_loss: 3925236.2500; train_optim_loss: 3925236.2500; val_kl_reg_loss: 21627.7188; val_edge_recon_loss: 2631913.7500; val_gene_expr_recon_loss: 248357.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007739.7500; val_global_loss: 3909638.7500; val_optim_loss: 3909638.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9736; val_auprc_score: 0.9627; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 23520.5484; train_edge_recon_loss: 2635892.3056; train_gene_expr_recon_loss: 246460.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010680.5625; train_global_loss: 3916554.0556; train_optim_loss: 3916554.0556; val_kl_reg_loss: 22751.0039; val_edge_recon_loss: 2660017.2500; val_gene_expr_recon_loss: 246778.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004849.0625; val_global_loss: 3934395.5000; val_optim_loss: 3934395.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9774; val_auprc_score: 0.9667; val_best_acc_score: 0.9417; val_best_f1_score: 0.9435; train_kl_reg_loss: 23064.8859; train_edge_recon_loss: 2637148.4444; train_gene_expr_recon_loss: 242864.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007402.4444; train_global_loss: 3910479.8056; train_optim_loss: 3910479.8056; val_kl_reg_loss: 22012.6211; val_edge_recon_loss: 2643539.0000; val_gene_expr_recon_loss: 245662.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004113.8125; val_global_loss: 3915328.0000; val_optim_loss: 3915328.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9803; val_auprc_score: 0.9707; val_best_acc_score: 0.9419; val_best_f1_score: 0.9434; train_kl_reg_loss: 23520.4371; train_edge_recon_loss: 2632751.1389; train_gene_expr_recon_loss: 242866.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011060.3125; train_global_loss: 3910198.5000; train_optim_loss: 3910198.5000; val_kl_reg_loss: 23295.8984; val_edge_recon_loss: 2631695.0000; val_gene_expr_recon_loss: 244178.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1000583.6250; val_global_loss: 3899753.5000; val_optim_loss: 3899753.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9768; val_auprc_score: 0.9677; val_best_acc_score: 0.9360; val_best_f1_score: 0.9385; train_kl_reg_loss: 23979.5521; train_edge_recon_loss: 2632040.8611; train_gene_expr_recon_loss: 240741.8003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005551.0625; train_global_loss: 3902313.2500; train_optim_loss: 3902313.2500; val_kl_reg_loss: 23162.5469; val_edge_recon_loss: 2634833.5000; val_gene_expr_recon_loss: 243519.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003036.9375; val_global_loss: 3904552.5000; val_optim_loss: 3904552.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9791; val_auprc_score: 0.9698; val_best_acc_score: 0.9411; val_best_f1_score: 0.9431; train_kl_reg_loss: 24067.0458; train_edge_recon_loss: 2635018.9167; train_gene_expr_recon_loss: 241433.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009646.5347; train_global_loss: 3910165.8889; train_optim_loss: 3910165.8889; val_kl_reg_loss: 22943.6113; val_edge_recon_loss: 2648745.5000; val_gene_expr_recon_loss: 244170.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003010.9375; val_global_loss: 3918870.2500; val_optim_loss: 3918870.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9766; val_auprc_score: 0.9685; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 23696.8481; train_edge_recon_loss: 2626589.7222; train_gene_expr_recon_loss: 242042.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012612.9722; train_global_loss: 3904941.6111; train_optim_loss: 3904941.6111; val_kl_reg_loss: 22627.9512; val_edge_recon_loss: 2657338.7500; val_gene_expr_recon_loss: 243547.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001718.2500; val_global_loss: 3925232.5000; val_optim_loss: 3925232.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9774; val_auprc_score: 0.9672; val_best_acc_score: 0.9380; val_best_f1_score: 0.9397; train_kl_reg_loss: 23311.2528; train_edge_recon_loss: 2637560.6944; train_gene_expr_recon_loss: 240726.8524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002781.3056; train_global_loss: 3904380.0556; train_optim_loss: 3904380.0556; val_kl_reg_loss: 22562.6348; val_edge_recon_loss: 2635574.0000; val_gene_expr_recon_loss: 243540.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001681.6875; val_global_loss: 3903359.2500; val_optim_loss: 3903359.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 46 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9727
Val AUPRC score: 0.9628
Val best accuracy score: 0.9328
Val best F1 score: 0.9347
Val gene expr MSE score: 0.6289
Val chrom access MSE score: 0.0868
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
