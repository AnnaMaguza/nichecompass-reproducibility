Run timestamp: 13062023_143657.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '2000', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', '3', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1583.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4340 highly variable or gene program relevant genes.
Keeping 3872 genes after filtering genes not in gp dict.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 3872, n_cond_embed_input: 0, n_layers: 1, n_hidden: 1555, n_latent: 1555, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1555, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1555, n_cond_embed_input: 3, n_addon_input: 0, n_output: 7744
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 3872, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9086; val_auprc_score: 0.9801; val_best_acc_score: 0.8921; val_best_f1_score: 0.9399; train_kl_reg_loss: 133870.4024; train_edge_recon_loss: 118922.0968; train_gene_expr_recon_loss: 1466480.7560; train_masked_gp_l1_reg_loss: 3110.6146; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1722383.8726; train_optim_loss: 1722383.8726; val_kl_reg_loss: 87019.5000; val_edge_recon_loss: 118306.7060; val_gene_expr_recon_loss: 1160709.9786; val_masked_gp_l1_reg_loss: 3414.3877; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1369450.5536; val_optim_loss: 1369450.5536
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9389; val_auprc_score: 0.9866; val_best_acc_score: 0.9347; val_best_f1_score: 0.9623; train_kl_reg_loss: 71435.2185; train_edge_recon_loss: 116797.0902; train_gene_expr_recon_loss: 1119130.0377; train_masked_gp_l1_reg_loss: 3697.5106; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1311059.8554; train_optim_loss: 1311059.8554; val_kl_reg_loss: 57233.0007; val_edge_recon_loss: 114098.6848; val_gene_expr_recon_loss: 1085981.0643; val_masked_gp_l1_reg_loss: 3975.1533; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1261287.8786; val_optim_loss: 1261287.8786
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9529; val_auprc_score: 0.9897; val_best_acc_score: 0.9422; val_best_f1_score: 0.9667; train_kl_reg_loss: 52392.5355; train_edge_recon_loss: 114659.4514; train_gene_expr_recon_loss: 1062159.6897; train_masked_gp_l1_reg_loss: 4218.4394; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1233430.1190; train_optim_loss: 1233430.1190; val_kl_reg_loss: 45732.9837; val_edge_recon_loss: 113566.4324; val_gene_expr_recon_loss: 1040644.5286; val_masked_gp_l1_reg_loss: 4445.7886; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1204389.6964; val_optim_loss: 1204389.6964
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9605; val_auprc_score: 0.9910; val_best_acc_score: 0.9487; val_best_f1_score: 0.9703; train_kl_reg_loss: 42768.8438; train_edge_recon_loss: 112357.3427; train_gene_expr_recon_loss: 1025945.4445; train_masked_gp_l1_reg_loss: 4630.3712; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1185702.0080; train_optim_loss: 1185702.0080; val_kl_reg_loss: 37857.7903; val_edge_recon_loss: 112637.7982; val_gene_expr_recon_loss: 1010056.2304; val_masked_gp_l1_reg_loss: 4802.0386; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1165353.8143; val_optim_loss: 1165353.8143
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9648; val_auprc_score: 0.9926; val_best_acc_score: 0.9544; val_best_f1_score: 0.9738; train_kl_reg_loss: 36999.5248; train_edge_recon_loss: 109736.1067; train_gene_expr_recon_loss: 997716.0142; train_masked_gp_l1_reg_loss: 4956.3459; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1149407.9892; train_optim_loss: 1149407.9892; val_kl_reg_loss: 34348.2233; val_edge_recon_loss: 106920.4333; val_gene_expr_recon_loss: 982927.8125; val_masked_gp_l1_reg_loss: 5108.6802; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1129305.0964; val_optim_loss: 1129305.0964
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9712; val_auprc_score: 0.9936; val_best_acc_score: 0.9591; val_best_f1_score: 0.9764; train_kl_reg_loss: 32878.4103; train_edge_recon_loss: 105794.6222; train_gene_expr_recon_loss: 975322.3147; train_masked_gp_l1_reg_loss: 5254.9887; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1119250.3369; train_optim_loss: 1119250.3369; val_kl_reg_loss: 30290.9273; val_edge_recon_loss: 105397.1933; val_gene_expr_recon_loss: 964678.5911; val_masked_gp_l1_reg_loss: 5401.7432; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1105768.4679; val_optim_loss: 1105768.4679
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9734; val_auprc_score: 0.9937; val_best_acc_score: 0.9644; val_best_f1_score: 0.9794; train_kl_reg_loss: 29182.6630; train_edge_recon_loss: 102658.7343; train_gene_expr_recon_loss: 957209.6404; train_masked_gp_l1_reg_loss: 5544.9325; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1094595.9692; train_optim_loss: 1094595.9692; val_kl_reg_loss: 27448.6421; val_edge_recon_loss: 101955.0636; val_gene_expr_recon_loss: 946375.0804; val_masked_gp_l1_reg_loss: 5687.2803; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1081466.0357; val_optim_loss: 1081466.0357
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9763; val_auprc_score: 0.9946; val_best_acc_score: 0.9668; val_best_f1_score: 0.9808; train_kl_reg_loss: 25700.9213; train_edge_recon_loss: 99290.1903; train_gene_expr_recon_loss: 940717.9902; train_masked_gp_l1_reg_loss: 5833.7323; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1071542.8337; train_optim_loss: 1071542.8337; val_kl_reg_loss: 24500.6265; val_edge_recon_loss: 98151.8844; val_gene_expr_recon_loss: 930377.9179; val_masked_gp_l1_reg_loss: 5980.5234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1059010.9268; val_optim_loss: 1059010.9268
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9794; val_auprc_score: 0.9952; val_best_acc_score: 0.9711; val_best_f1_score: 0.9832; train_kl_reg_loss: 22207.0443; train_edge_recon_loss: 96425.8955; train_gene_expr_recon_loss: 925932.5381; train_masked_gp_l1_reg_loss: 6130.1575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1050695.6320; train_optim_loss: 1050695.6320; val_kl_reg_loss: 20335.3346; val_edge_recon_loss: 94791.6147; val_gene_expr_recon_loss: 916723.9321; val_masked_gp_l1_reg_loss: 6279.2651; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1038130.1286; val_optim_loss: 1038130.1286
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9789; val_auprc_score: 0.9951; val_best_acc_score: 0.9717; val_best_f1_score: 0.9835; train_kl_reg_loss: 18842.8665; train_edge_recon_loss: 92978.6469; train_gene_expr_recon_loss: 913686.4491; train_masked_gp_l1_reg_loss: 6424.2685; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1031932.2312; train_optim_loss: 1031932.2312; val_kl_reg_loss: 16918.8515; val_edge_recon_loss: 91925.9458; val_gene_expr_recon_loss: 906197.1696; val_masked_gp_l1_reg_loss: 6557.1069; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1021599.0929; val_optim_loss: 1021599.0929
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9820; val_auprc_score: 0.9960; val_best_acc_score: 0.9721; val_best_f1_score: 0.9837; train_kl_reg_loss: 15795.2604; train_edge_recon_loss: 89460.4366; train_gene_expr_recon_loss: 901519.7129; train_masked_gp_l1_reg_loss: 6655.3149; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1013430.7258; train_optim_loss: 1013430.7258; val_kl_reg_loss: 14118.0106; val_edge_recon_loss: 90813.5266; val_gene_expr_recon_loss: 895331.6446; val_masked_gp_l1_reg_loss: 6728.9434; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1006992.1179; val_optim_loss: 1006992.1179
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9817; val_auprc_score: 0.9956; val_best_acc_score: 0.9730; val_best_f1_score: 0.9843; train_kl_reg_loss: 13352.8740; train_edge_recon_loss: 87674.3493; train_gene_expr_recon_loss: 891017.0250; train_masked_gp_l1_reg_loss: 6760.2662; train_group_lasso_reg_loss: 0.0000; train_global_loss: 998804.5132; train_optim_loss: 998804.5132; val_kl_reg_loss: 12037.4777; val_edge_recon_loss: 86998.1888; val_gene_expr_recon_loss: 884788.7018; val_masked_gp_l1_reg_loss: 6766.1025; val_group_lasso_reg_loss: 0.0000; val_global_loss: 990590.4893; val_optim_loss: 990590.4893
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9809; val_auprc_score: 0.9955; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 11401.9942; train_edge_recon_loss: 85178.4112; train_gene_expr_recon_loss: 881807.2147; train_masked_gp_l1_reg_loss: 6714.4705; train_group_lasso_reg_loss: 0.0000; train_global_loss: 985102.0917; train_optim_loss: 985102.0917; val_kl_reg_loss: 10257.9723; val_edge_recon_loss: 83623.0763; val_gene_expr_recon_loss: 876274.0554; val_masked_gp_l1_reg_loss: 6643.5166; val_group_lasso_reg_loss: 0.0000; val_global_loss: 976798.6018; val_optim_loss: 976798.6018
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9812; val_auprc_score: 0.9956; val_best_acc_score: 0.9750; val_best_f1_score: 0.9855; train_kl_reg_loss: 9865.6073; train_edge_recon_loss: 83943.4660; train_gene_expr_recon_loss: 873390.0098; train_masked_gp_l1_reg_loss: 6516.1882; train_group_lasso_reg_loss: 0.0000; train_global_loss: 973715.2720; train_optim_loss: 973715.2720; val_kl_reg_loss: 8964.8371; val_edge_recon_loss: 81237.5301; val_gene_expr_recon_loss: 869758.1018; val_masked_gp_l1_reg_loss: 6368.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 966328.5286; val_optim_loss: 966328.5286
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9820; val_auprc_score: 0.9960; val_best_acc_score: 0.9748; val_best_f1_score: 0.9854; train_kl_reg_loss: 8700.4809; train_edge_recon_loss: 82066.1531; train_gene_expr_recon_loss: 865634.2861; train_masked_gp_l1_reg_loss: 6195.7231; train_group_lasso_reg_loss: 0.0000; train_global_loss: 962596.6444; train_optim_loss: 962596.6444; val_kl_reg_loss: 7945.5592; val_edge_recon_loss: 80550.4089; val_gene_expr_recon_loss: 861367.8804; val_masked_gp_l1_reg_loss: 6016.5620; val_group_lasso_reg_loss: 0.0000; val_global_loss: 955880.4143; val_optim_loss: 955880.4143
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9834; val_auprc_score: 0.9962; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 7798.4477; train_edge_recon_loss: 80265.7210; train_gene_expr_recon_loss: 859501.2999; train_masked_gp_l1_reg_loss: 5831.1158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 953396.5827; train_optim_loss: 953396.5827; val_kl_reg_loss: 7481.6783; val_edge_recon_loss: 80340.0607; val_gene_expr_recon_loss: 855649.7839; val_masked_gp_l1_reg_loss: 5647.2388; val_group_lasso_reg_loss: 0.0000; val_global_loss: 949118.7696; val_optim_loss: 949118.7696
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9842; val_auprc_score: 0.9961; val_best_acc_score: 0.9766; val_best_f1_score: 0.9863; train_kl_reg_loss: 7175.9489; train_edge_recon_loss: 80127.1235; train_gene_expr_recon_loss: 853712.1484; train_masked_gp_l1_reg_loss: 5467.3436; train_group_lasso_reg_loss: 0.0000; train_global_loss: 946482.5647; train_optim_loss: 946482.5647; val_kl_reg_loss: 6927.3109; val_edge_recon_loss: 80076.8112; val_gene_expr_recon_loss: 850215.5750; val_masked_gp_l1_reg_loss: 5292.2959; val_group_lasso_reg_loss: 0.0000; val_global_loss: 942512.0125; val_optim_loss: 942512.0125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9832; val_auprc_score: 0.9957; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 6747.6029; train_edge_recon_loss: 79301.2515; train_gene_expr_recon_loss: 849124.4423; train_masked_gp_l1_reg_loss: 5148.4627; train_group_lasso_reg_loss: 0.0000; train_global_loss: 940321.7598; train_optim_loss: 940321.7598; val_kl_reg_loss: 6456.7666; val_edge_recon_loss: 78478.5143; val_gene_expr_recon_loss: 847224.7268; val_masked_gp_l1_reg_loss: 5006.0190; val_group_lasso_reg_loss: 0.0000; val_global_loss: 937166.0054; val_optim_loss: 937166.0054
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9830; val_auprc_score: 0.9957; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 6477.5609; train_edge_recon_loss: 79089.8412; train_gene_expr_recon_loss: 844632.7208; train_masked_gp_l1_reg_loss: 4889.1928; train_group_lasso_reg_loss: 0.0000; train_global_loss: 935089.3161; train_optim_loss: 935089.3161; val_kl_reg_loss: 6144.0471; val_edge_recon_loss: 78639.5484; val_gene_expr_recon_loss: 843221.8429; val_masked_gp_l1_reg_loss: 4773.2407; val_group_lasso_reg_loss: 0.0000; val_global_loss: 932778.6857; val_optim_loss: 932778.6857
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9833; val_auprc_score: 0.9961; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 6258.1666; train_edge_recon_loss: 78374.0202; train_gene_expr_recon_loss: 841894.6675; train_masked_gp_l1_reg_loss: 4682.9347; train_group_lasso_reg_loss: 0.0000; train_global_loss: 931209.7893; train_optim_loss: 931209.7893; val_kl_reg_loss: 6268.5136; val_edge_recon_loss: 77336.4051; val_gene_expr_recon_loss: 839952.2250; val_masked_gp_l1_reg_loss: 4591.7163; val_group_lasso_reg_loss: 0.0000; val_global_loss: 928148.8268; val_optim_loss: 928148.8268
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9837; val_auprc_score: 0.9959; val_best_acc_score: 0.9762; val_best_f1_score: 0.9861; train_kl_reg_loss: 6118.4571; train_edge_recon_loss: 78944.4411; train_gene_expr_recon_loss: 838935.1144; train_masked_gp_l1_reg_loss: 4520.7082; train_group_lasso_reg_loss: 0.0000; train_global_loss: 928518.7212; train_optim_loss: 928518.7212; val_kl_reg_loss: 5611.5274; val_edge_recon_loss: 78072.2228; val_gene_expr_recon_loss: 837100.4821; val_masked_gp_l1_reg_loss: 4454.1377; val_group_lasso_reg_loss: 0.0000; val_global_loss: 925238.3589; val_optim_loss: 925238.3589
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9839; val_auprc_score: 0.9958; val_best_acc_score: 0.9767; val_best_f1_score: 0.9865; train_kl_reg_loss: 6007.9674; train_edge_recon_loss: 78410.1743; train_gene_expr_recon_loss: 835724.8397; train_masked_gp_l1_reg_loss: 4392.8020; train_group_lasso_reg_loss: 0.0000; train_global_loss: 924535.7825; train_optim_loss: 924535.7825; val_kl_reg_loss: 6006.4541; val_edge_recon_loss: 76126.9240; val_gene_expr_recon_loss: 833928.9357; val_masked_gp_l1_reg_loss: 4332.1797; val_group_lasso_reg_loss: 0.0000; val_global_loss: 920394.5054; val_optim_loss: 920394.5054
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9839; val_auprc_score: 0.9962; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 5931.8636; train_edge_recon_loss: 78001.5776; train_gene_expr_recon_loss: 832964.2029; train_masked_gp_l1_reg_loss: 4287.4675; train_group_lasso_reg_loss: 0.0000; train_global_loss: 921185.1108; train_optim_loss: 921185.1108; val_kl_reg_loss: 5989.4726; val_edge_recon_loss: 78372.8717; val_gene_expr_recon_loss: 830682.9286; val_masked_gp_l1_reg_loss: 4242.6226; val_group_lasso_reg_loss: 0.0000; val_global_loss: 919287.8982; val_optim_loss: 919287.8982
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9824; val_auprc_score: 0.9958; val_best_acc_score: 0.9754; val_best_f1_score: 0.9856; train_kl_reg_loss: 5920.2726; train_edge_recon_loss: 78261.2942; train_gene_expr_recon_loss: 831915.3133; train_masked_gp_l1_reg_loss: 4201.9189; train_group_lasso_reg_loss: 0.0000; train_global_loss: 920298.7997; train_optim_loss: 920298.7997; val_kl_reg_loss: 5743.9645; val_edge_recon_loss: 78079.2665; val_gene_expr_recon_loss: 830539.7589; val_masked_gp_l1_reg_loss: 4163.7163; val_group_lasso_reg_loss: 0.0000; val_global_loss: 918526.6804; val_optim_loss: 918526.6804
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9830; val_auprc_score: 0.9956; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 5863.7736; train_edge_recon_loss: 77603.6355; train_gene_expr_recon_loss: 830053.6076; train_masked_gp_l1_reg_loss: 4128.0973; train_group_lasso_reg_loss: 0.0000; train_global_loss: 917649.1154; train_optim_loss: 917649.1154; val_kl_reg_loss: 5864.9717; val_edge_recon_loss: 76579.3049; val_gene_expr_recon_loss: 827128.0375; val_masked_gp_l1_reg_loss: 4094.8191; val_group_lasso_reg_loss: 0.0000; val_global_loss: 913667.1214; val_optim_loss: 913667.1214
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9832; val_auprc_score: 0.9962; val_best_acc_score: 0.9758; val_best_f1_score: 0.9860; train_kl_reg_loss: 5005.1347; train_edge_recon_loss: 77913.0380; train_gene_expr_recon_loss: 850896.7113; train_masked_gp_l1_reg_loss: 4198.1102; train_group_lasso_reg_loss: 0.0000; train_global_loss: 938012.9946; train_optim_loss: 938012.9946; val_kl_reg_loss: 4234.0308; val_edge_recon_loss: 76694.1254; val_gene_expr_recon_loss: 842309.2714; val_masked_gp_l1_reg_loss: 4079.3555; val_group_lasso_reg_loss: 0.0000; val_global_loss: 927316.8071; val_optim_loss: 927316.8071
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9829; val_auprc_score: 0.9957; val_best_acc_score: 0.9747; val_best_f1_score: 0.9853; train_kl_reg_loss: 4782.9338; train_edge_recon_loss: 77439.4935; train_gene_expr_recon_loss: 840595.4710; train_masked_gp_l1_reg_loss: 3953.3158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 926771.2139; train_optim_loss: 926771.2139; val_kl_reg_loss: 4328.2505; val_edge_recon_loss: 78262.5435; val_gene_expr_recon_loss: 838816.5125; val_masked_gp_l1_reg_loss: 3833.3628; val_group_lasso_reg_loss: 0.0000; val_global_loss: 925240.6821; val_optim_loss: 925240.6821
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9828; val_auprc_score: 0.9959; val_best_acc_score: 0.9751; val_best_f1_score: 0.9855; train_kl_reg_loss: 4687.1178; train_edge_recon_loss: 77263.0076; train_gene_expr_recon_loss: 838675.2196; train_masked_gp_l1_reg_loss: 3730.6752; train_group_lasso_reg_loss: 0.0000; train_global_loss: 924356.0188; train_optim_loss: 924356.0188; val_kl_reg_loss: 4460.7990; val_edge_recon_loss: 77483.3862; val_gene_expr_recon_loss: 837153.9839; val_masked_gp_l1_reg_loss: 3632.4917; val_group_lasso_reg_loss: 0.0000; val_global_loss: 922730.6750; val_optim_loss: 922730.6750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9848; val_auprc_score: 0.9965; val_best_acc_score: 0.9772; val_best_f1_score: 0.9867; train_kl_reg_loss: 4649.7872; train_edge_recon_loss: 76839.4572; train_gene_expr_recon_loss: 836207.5811; train_masked_gp_l1_reg_loss: 3606.8435; train_group_lasso_reg_loss: 0.0000; train_global_loss: 921303.6671; train_optim_loss: 921303.6671; val_kl_reg_loss: 4371.0107; val_edge_recon_loss: 76745.7353; val_gene_expr_recon_loss: 835179.2518; val_masked_gp_l1_reg_loss: 3592.4214; val_group_lasso_reg_loss: 0.0000; val_global_loss: 919888.4357; val_optim_loss: 919888.4357
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9847; val_auprc_score: 0.9965; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 4627.6877; train_edge_recon_loss: 77385.9569; train_gene_expr_recon_loss: 835552.7568; train_masked_gp_l1_reg_loss: 3581.0773; train_group_lasso_reg_loss: 0.0000; train_global_loss: 921147.4784; train_optim_loss: 921147.4784; val_kl_reg_loss: 4370.9446; val_edge_recon_loss: 75242.4906; val_gene_expr_recon_loss: 835280.1518; val_masked_gp_l1_reg_loss: 3568.7268; val_group_lasso_reg_loss: 0.0000; val_global_loss: 918462.3339; val_optim_loss: 918462.3339
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9829; val_auprc_score: 0.9960; val_best_acc_score: 0.9757; val_best_f1_score: 0.9859; train_kl_reg_loss: 4617.6288; train_edge_recon_loss: 76704.5881; train_gene_expr_recon_loss: 835174.8626; train_masked_gp_l1_reg_loss: 3556.9433; train_group_lasso_reg_loss: 0.0000; train_global_loss: 920054.0256; train_optim_loss: 920054.0256; val_kl_reg_loss: 4347.5719; val_edge_recon_loss: 76980.4051; val_gene_expr_recon_loss: 834053.0661; val_masked_gp_l1_reg_loss: 3543.9016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 918924.9179; val_optim_loss: 918924.9179

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 126 min 51 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9828
Val AUPRC score: 0.9961
Val best accuracy score: 0.9744
Val best F1 score: 0.9851
Val gene expr MSE score: 849.9819

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
