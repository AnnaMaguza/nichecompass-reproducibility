[True]
Run timestamp: 10082023_134002_1007.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1007']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7068; val_auprc_score: 0.7491; val_best_acc_score: 0.5013; val_best_f1_score: 0.6671; train_kl_reg_loss: 88192.7250; train_edge_recon_loss: 3590433.7557; train_gene_expr_recon_loss: 14579439.1985; train_masked_gp_l1_reg_loss: 78019.7091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234834.6517; train_chrom_access_recon_loss: 2181730.3483; train_global_loss: 20752650.2901; train_optim_loss: 20752650.2901; val_kl_reg_loss: 133168.6094; val_edge_recon_loss: 4065197.8167; val_gene_expr_recon_loss: 12817965.8000; val_masked_gp_l1_reg_loss: 75796.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217611.1250; val_chrom_access_recon_loss: 2025882.0083; val_global_loss: 19335622.1333; val_optim_loss: 19335622.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8273; val_auprc_score: 0.8350; val_best_acc_score: 0.7449; val_best_f1_score: 0.7490; train_kl_reg_loss: 117319.7849; train_edge_recon_loss: 3533222.8282; train_gene_expr_recon_loss: 12656329.0992; train_masked_gp_l1_reg_loss: 72655.1581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198297.7932; train_chrom_access_recon_loss: 2048815.2013; train_global_loss: 18626639.8321; train_optim_loss: 18626639.8321; val_kl_reg_loss: 104750.9542; val_edge_recon_loss: 4022120.3333; val_gene_expr_recon_loss: 12380127.5333; val_masked_gp_l1_reg_loss: 71875.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179094.0781; val_chrom_access_recon_loss: 1984835.7250; val_global_loss: 18742804.5333; val_optim_loss: 18742804.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8706; val_auprc_score: 0.8624; val_best_acc_score: 0.7754; val_best_f1_score: 0.7972; train_kl_reg_loss: 100057.2674; train_edge_recon_loss: 3390977.7519; train_gene_expr_recon_loss: 12429410.8473; train_masked_gp_l1_reg_loss: 73569.8683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162200.4169; train_chrom_access_recon_loss: 2024598.0935; train_global_loss: 18180814.2061; train_optim_loss: 18180814.2061; val_kl_reg_loss: 120127.6354; val_edge_recon_loss: 3042776.5167; val_gene_expr_recon_loss: 12294569.2667; val_masked_gp_l1_reg_loss: 77064.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146313.2812; val_chrom_access_recon_loss: 1971439.1750; val_global_loss: 17652290.8000; val_optim_loss: 17652290.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8863; val_auprc_score: 0.8710; val_best_acc_score: 0.7913; val_best_f1_score: 0.8108; train_kl_reg_loss: 127860.0834; train_edge_recon_loss: 2988916.9160; train_gene_expr_recon_loss: 12281468.9542; train_masked_gp_l1_reg_loss: 78809.6735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132946.7611; train_chrom_access_recon_loss: 2005263.2185; train_global_loss: 17615265.5267; train_optim_loss: 17615265.5267; val_kl_reg_loss: 121324.6839; val_edge_recon_loss: 2935985.2500; val_gene_expr_recon_loss: 12146051.9333; val_masked_gp_l1_reg_loss: 80509.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120489.5625; val_chrom_access_recon_loss: 1957710.5917; val_global_loss: 17362072.3333; val_optim_loss: 17362072.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8997; val_auprc_score: 0.8846; val_best_acc_score: 0.8137; val_best_f1_score: 0.8273; train_kl_reg_loss: 120421.6212; train_edge_recon_loss: 2949761.1718; train_gene_expr_recon_loss: 12137587.4046; train_masked_gp_l1_reg_loss: 82097.3006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110433.0870; train_chrom_access_recon_loss: 1985459.8034; train_global_loss: 17385760.5344; train_optim_loss: 17385760.5344; val_kl_reg_loss: 115106.0443; val_edge_recon_loss: 2915379.0000; val_gene_expr_recon_loss: 12077579.4667; val_masked_gp_l1_reg_loss: 83674.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101272.7188; val_chrom_access_recon_loss: 1945384.5750; val_global_loss: 17238396.0000; val_optim_loss: 17238396.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9124; val_auprc_score: 0.8933; val_best_acc_score: 0.8375; val_best_f1_score: 0.8497; train_kl_reg_loss: 110796.8919; train_edge_recon_loss: 2893773.1317; train_gene_expr_recon_loss: 12020154.9542; train_masked_gp_l1_reg_loss: 85215.5542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93974.7186; train_chrom_access_recon_loss: 1969092.7977; train_global_loss: 17173008.0153; train_optim_loss: 17173008.0153; val_kl_reg_loss: 109617.8495; val_edge_recon_loss: 2873021.1833; val_gene_expr_recon_loss: 11892669.4000; val_masked_gp_l1_reg_loss: 86579.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87304.7891; val_chrom_access_recon_loss: 1920088.5167; val_global_loss: 16969281.9333; val_optim_loss: 16969281.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9229; val_auprc_score: 0.9088; val_best_acc_score: 0.8525; val_best_f1_score: 0.8641; train_kl_reg_loss: 111765.2229; train_edge_recon_loss: 2838299.3836; train_gene_expr_recon_loss: 11915674.5573; train_masked_gp_l1_reg_loss: 88079.8653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81746.4266; train_chrom_access_recon_loss: 1955962.6002; train_global_loss: 16991528.0382; train_optim_loss: 16991528.0382; val_kl_reg_loss: 117308.1620; val_edge_recon_loss: 2851541.9667; val_gene_expr_recon_loss: 11780862.0000; val_masked_gp_l1_reg_loss: 89330.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76518.2266; val_chrom_access_recon_loss: 1911674.9417; val_global_loss: 16827235.0667; val_optim_loss: 16827235.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9362; val_auprc_score: 0.9203; val_best_acc_score: 0.8724; val_best_f1_score: 0.8782; train_kl_reg_loss: 111459.8804; train_edge_recon_loss: 2815653.1450; train_gene_expr_recon_loss: 11823777.5344; train_masked_gp_l1_reg_loss: 90614.1766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71866.0075; train_chrom_access_recon_loss: 1942125.9046; train_global_loss: 16855496.5496; train_optim_loss: 16855496.5496; val_kl_reg_loss: 106415.8000; val_edge_recon_loss: 2826835.3333; val_gene_expr_recon_loss: 11727373.6000; val_masked_gp_l1_reg_loss: 92186.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67531.6406; val_chrom_access_recon_loss: 1891950.8167; val_global_loss: 16712293.4000; val_optim_loss: 16712293.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9398; val_auprc_score: 0.9258; val_best_acc_score: 0.8759; val_best_f1_score: 0.8826; train_kl_reg_loss: 109232.3261; train_edge_recon_loss: 2795333.3531; train_gene_expr_recon_loss: 11749193.5267; train_masked_gp_l1_reg_loss: 93190.3268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63594.9770; train_chrom_access_recon_loss: 1930161.4113; train_global_loss: 16740705.9084; train_optim_loss: 16740705.9084; val_kl_reg_loss: 104519.4266; val_edge_recon_loss: 2796253.4333; val_gene_expr_recon_loss: 11688188.6667; val_masked_gp_l1_reg_loss: 94231.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59871.7461; val_chrom_access_recon_loss: 1882937.6583; val_global_loss: 16626003.1333; val_optim_loss: 16626003.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9437; val_auprc_score: 0.9286; val_best_acc_score: 0.8836; val_best_f1_score: 0.8894; train_kl_reg_loss: 105312.7410; train_edge_recon_loss: 2783312.6622; train_gene_expr_recon_loss: 11678689.6107; train_masked_gp_l1_reg_loss: 95489.8866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56755.1849; train_chrom_access_recon_loss: 1918564.0611; train_global_loss: 16638124.1908; train_optim_loss: 16638124.1908; val_kl_reg_loss: 105663.3542; val_edge_recon_loss: 2767569.4000; val_gene_expr_recon_loss: 11639086.7333; val_masked_gp_l1_reg_loss: 96611.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53832.9336; val_chrom_access_recon_loss: 1873091.3917; val_global_loss: 16535855.8667; val_optim_loss: 16535855.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9455; val_auprc_score: 0.9305; val_best_acc_score: 0.8806; val_best_f1_score: 0.8852; train_kl_reg_loss: 105977.1344; train_edge_recon_loss: 2772114.6966; train_gene_expr_recon_loss: 11618822.7176; train_masked_gp_l1_reg_loss: 97580.6771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51373.4058; train_chrom_access_recon_loss: 1908722.0372; train_global_loss: 16554590.6412; train_optim_loss: 16554590.6412; val_kl_reg_loss: 106375.8875; val_edge_recon_loss: 2794535.5167; val_gene_expr_recon_loss: 11523638.6667; val_masked_gp_l1_reg_loss: 98301.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49016.4414; val_chrom_access_recon_loss: 1860718.1167; val_global_loss: 16432585.0000; val_optim_loss: 16432585.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9485; val_auprc_score: 0.9369; val_best_acc_score: 0.8909; val_best_f1_score: 0.8945; train_kl_reg_loss: 102893.4284; train_edge_recon_loss: 2765052.8531; train_gene_expr_recon_loss: 11567723.9924; train_masked_gp_l1_reg_loss: 99444.1986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47208.5298; train_chrom_access_recon_loss: 1900792.6069; train_global_loss: 16483115.5420; train_optim_loss: 16483115.5420; val_kl_reg_loss: 99273.8531; val_edge_recon_loss: 2789042.6500; val_gene_expr_recon_loss: 11431066.5333; val_masked_gp_l1_reg_loss: 100554.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45363.1211; val_chrom_access_recon_loss: 1854825.4083; val_global_loss: 16320126.2667; val_optim_loss: 16320126.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9504; val_auprc_score: 0.9364; val_best_acc_score: 0.8914; val_best_f1_score: 0.8957; train_kl_reg_loss: 100554.0713; train_edge_recon_loss: 2760333.9447; train_gene_expr_recon_loss: 11523858.6412; train_masked_gp_l1_reg_loss: 101332.4499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43683.5417; train_chrom_access_recon_loss: 1893240.0782; train_global_loss: 16423002.7710; train_optim_loss: 16423002.7710; val_kl_reg_loss: 98103.7505; val_edge_recon_loss: 2776869.5667; val_gene_expr_recon_loss: 11423619.7333; val_masked_gp_l1_reg_loss: 102200.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42069.2656; val_chrom_access_recon_loss: 1848622.1333; val_global_loss: 16291484.0667; val_optim_loss: 16291484.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9571; val_auprc_score: 0.9464; val_best_acc_score: 0.8992; val_best_f1_score: 0.9031; train_kl_reg_loss: 99076.2538; train_edge_recon_loss: 2753660.1260; train_gene_expr_recon_loss: 11465401.0305; train_masked_gp_l1_reg_loss: 103024.6518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40433.3039; train_chrom_access_recon_loss: 1883864.9008; train_global_loss: 16345460.2901; train_optim_loss: 16345460.2901; val_kl_reg_loss: 94081.9406; val_edge_recon_loss: 2758291.0500; val_gene_expr_recon_loss: 11421826.7333; val_masked_gp_l1_reg_loss: 103933.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39049.3438; val_chrom_access_recon_loss: 1844499.0333; val_global_loss: 16261680.5333; val_optim_loss: 16261680.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9565; val_auprc_score: 0.9451; val_best_acc_score: 0.8987; val_best_f1_score: 0.9024; train_kl_reg_loss: 96039.3406; train_edge_recon_loss: 2745773.8225; train_gene_expr_recon_loss: 11426231.6336; train_masked_gp_l1_reg_loss: 104776.7072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37730.6727; train_chrom_access_recon_loss: 1879128.8177; train_global_loss: 16289680.9237; train_optim_loss: 16289680.9237; val_kl_reg_loss: 96983.3094; val_edge_recon_loss: 2768285.4000; val_gene_expr_recon_loss: 11343004.4667; val_masked_gp_l1_reg_loss: 105502.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36498.6562; val_chrom_access_recon_loss: 1838201.3250; val_global_loss: 16188476.3333; val_optim_loss: 16188476.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9574; val_auprc_score: 0.9428; val_best_acc_score: 0.9016; val_best_f1_score: 0.9060; train_kl_reg_loss: 94648.9912; train_edge_recon_loss: 2738373.5573; train_gene_expr_recon_loss: 11393382.3435; train_masked_gp_l1_reg_loss: 106283.5794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35320.2045; train_chrom_access_recon_loss: 1873447.7290; train_global_loss: 16241456.4198; train_optim_loss: 16241456.4198; val_kl_reg_loss: 93971.7547; val_edge_recon_loss: 2748340.4000; val_gene_expr_recon_loss: 11360583.9333; val_masked_gp_l1_reg_loss: 107075.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34228.8281; val_chrom_access_recon_loss: 1834652.1333; val_global_loss: 16178853.4000; val_optim_loss: 16178853.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9588; val_auprc_score: 0.9458; val_best_acc_score: 0.9020; val_best_f1_score: 0.9052; train_kl_reg_loss: 95138.0690; train_edge_recon_loss: 2727785.9656; train_gene_expr_recon_loss: 11355804.4733; train_masked_gp_l1_reg_loss: 107682.7828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33232.8079; train_chrom_access_recon_loss: 1866319.9866; train_global_loss: 16185964.0534; train_optim_loss: 16185964.0534; val_kl_reg_loss: 95994.6771; val_edge_recon_loss: 2749285.4333; val_gene_expr_recon_loss: 11291775.3333; val_masked_gp_l1_reg_loss: 108585.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32360.2930; val_chrom_access_recon_loss: 1821752.8333; val_global_loss: 16099754.2667; val_optim_loss: 16099754.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9613; val_auprc_score: 0.9496; val_best_acc_score: 0.9041; val_best_f1_score: 0.9075; train_kl_reg_loss: 94148.8422; train_edge_recon_loss: 2722861.5744; train_gene_expr_recon_loss: 11327749.8550; train_masked_gp_l1_reg_loss: 109061.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31526.6677; train_chrom_access_recon_loss: 1862080.3626; train_global_loss: 16147428.7405; train_optim_loss: 16147428.7405; val_kl_reg_loss: 90816.0802; val_edge_recon_loss: 2752452.2000; val_gene_expr_recon_loss: 11289237.4000; val_masked_gp_l1_reg_loss: 109885.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30766.7422; val_chrom_access_recon_loss: 1823667.0917; val_global_loss: 16096825.7333; val_optim_loss: 16096825.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9636; val_auprc_score: 0.9507; val_best_acc_score: 0.9077; val_best_f1_score: 0.9116; train_kl_reg_loss: 94354.3560; train_edge_recon_loss: 2716165.3798; train_gene_expr_recon_loss: 11295933.9847; train_masked_gp_l1_reg_loss: 110309.1818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30035.5173; train_chrom_access_recon_loss: 1858596.0525; train_global_loss: 16105394.5573; train_optim_loss: 16105394.5573; val_kl_reg_loss: 92820.6625; val_edge_recon_loss: 2727133.1000; val_gene_expr_recon_loss: 11225191.6000; val_masked_gp_l1_reg_loss: 110787.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29290.8867; val_chrom_access_recon_loss: 1813182.6417; val_global_loss: 15998406.8667; val_optim_loss: 15998406.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9661; val_auprc_score: 0.9565; val_best_acc_score: 0.9135; val_best_f1_score: 0.9158; train_kl_reg_loss: 92031.7745; train_edge_recon_loss: 2723613.7252; train_gene_expr_recon_loss: 11273494.3969; train_masked_gp_l1_reg_loss: 111422.4181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28758.2600; train_chrom_access_recon_loss: 1854444.2338; train_global_loss: 16083764.8550; train_optim_loss: 16083764.8550; val_kl_reg_loss: 92870.5083; val_edge_recon_loss: 2708441.7833; val_gene_expr_recon_loss: 11199475.7333; val_masked_gp_l1_reg_loss: 112118.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28192.0742; val_chrom_access_recon_loss: 1813143.8083; val_global_loss: 15954242.9333; val_optim_loss: 15954242.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9652; val_auprc_score: 0.9541; val_best_acc_score: 0.9077; val_best_f1_score: 0.9121; train_kl_reg_loss: 89444.9909; train_edge_recon_loss: 2721910.2271; train_gene_expr_recon_loss: 11242761.0611; train_masked_gp_l1_reg_loss: 112625.3018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27660.9134; train_chrom_access_recon_loss: 1850359.8454; train_global_loss: 16044762.2366; train_optim_loss: 16044762.2366; val_kl_reg_loss: 88504.8406; val_edge_recon_loss: 2746294.8667; val_gene_expr_recon_loss: 11191039.6667; val_masked_gp_l1_reg_loss: 113290.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27270.6719; val_chrom_access_recon_loss: 1808238.6167; val_global_loss: 15974639.8667; val_optim_loss: 15974639.8667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9638; val_auprc_score: 0.9501; val_best_acc_score: 0.9074; val_best_f1_score: 0.9111; train_kl_reg_loss: 89812.0298; train_edge_recon_loss: 2713645.1412; train_gene_expr_recon_loss: 11223870.7481; train_masked_gp_l1_reg_loss: 113744.4378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26708.2948; train_chrom_access_recon_loss: 1848559.7452; train_global_loss: 16016340.3588; train_optim_loss: 16016340.3588; val_kl_reg_loss: 85488.2047; val_edge_recon_loss: 2731702.3000; val_gene_expr_recon_loss: 11159000.7333; val_masked_gp_l1_reg_loss: 114247.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26326.1816; val_chrom_access_recon_loss: 1803176.2333; val_global_loss: 15919941.4667; val_optim_loss: 15919941.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9633; val_auprc_score: 0.9537; val_best_acc_score: 0.9066; val_best_f1_score: 0.9095; train_kl_reg_loss: 89289.2740; train_edge_recon_loss: 2709976.1679; train_gene_expr_recon_loss: 11198582.2595; train_masked_gp_l1_reg_loss: 114697.4646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25897.9349; train_chrom_access_recon_loss: 1843193.0859; train_global_loss: 15981636.2443; train_optim_loss: 15981636.2443; val_kl_reg_loss: 90290.1318; val_edge_recon_loss: 2746159.2333; val_gene_expr_recon_loss: 11126249.7333; val_masked_gp_l1_reg_loss: 115099.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25363.6992; val_chrom_access_recon_loss: 1802320.5750; val_global_loss: 15905482.6000; val_optim_loss: 15905482.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9674; val_auprc_score: 0.9558; val_best_acc_score: 0.9175; val_best_f1_score: 0.9209; train_kl_reg_loss: 88972.2951; train_edge_recon_loss: 2704616.6336; train_gene_expr_recon_loss: 11175424.1908; train_masked_gp_l1_reg_loss: 115563.9269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25076.0228; train_chrom_access_recon_loss: 1839155.5219; train_global_loss: 15948808.6031; train_optim_loss: 15948808.6031; val_kl_reg_loss: 87682.7776; val_edge_recon_loss: 2702347.1000; val_gene_expr_recon_loss: 11104976.2000; val_masked_gp_l1_reg_loss: 115981.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24637.3066; val_chrom_access_recon_loss: 1801961.7833; val_global_loss: 15837586.9333; val_optim_loss: 15837586.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9701; val_auprc_score: 0.9626; val_best_acc_score: 0.9190; val_best_f1_score: 0.9224; train_kl_reg_loss: 87801.5261; train_edge_recon_loss: 2712138.6756; train_gene_expr_recon_loss: 11159386.9466; train_masked_gp_l1_reg_loss: 116406.5867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24314.8950; train_chrom_access_recon_loss: 1837568.8912; train_global_loss: 15937617.4809; train_optim_loss: 15937617.4809; val_kl_reg_loss: 84706.9661; val_edge_recon_loss: 2722519.3833; val_gene_expr_recon_loss: 11134726.7333; val_masked_gp_l1_reg_loss: 116853.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24053.3867; val_chrom_access_recon_loss: 1800972.6917; val_global_loss: 15883832.7333; val_optim_loss: 15883832.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9731; val_auprc_score: 0.9675; val_best_acc_score: 0.9223; val_best_f1_score: 0.9246; train_kl_reg_loss: 102672.7916; train_edge_recon_loss: 2752075.2099; train_gene_expr_recon_loss: 11432469.9695; train_masked_gp_l1_reg_loss: 116013.8957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22579.6095; train_chrom_access_recon_loss: 1867684.4380; train_global_loss: 16293495.9847; train_optim_loss: 16293495.9847; val_kl_reg_loss: 45058.9302; val_edge_recon_loss: 2713151.1500; val_gene_expr_recon_loss: 11386392.6667; val_masked_gp_l1_reg_loss: 116135.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22020.4902; val_chrom_access_recon_loss: 1831871.1833; val_global_loss: 16114629.8667; val_optim_loss: 16114629.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9705; val_auprc_score: 0.9609; val_best_acc_score: 0.9179; val_best_f1_score: 0.9203; train_kl_reg_loss: 90675.9447; train_edge_recon_loss: 2719334.1183; train_gene_expr_recon_loss: 11394044.8168; train_masked_gp_l1_reg_loss: 116107.2294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21747.8917; train_chrom_access_recon_loss: 1864793.4237; train_global_loss: 16206703.3740; train_optim_loss: 16206703.3740; val_kl_reg_loss: 46752.7141; val_edge_recon_loss: 2748152.2000; val_gene_expr_recon_loss: 11335994.4667; val_masked_gp_l1_reg_loss: 115986.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21535.2480; val_chrom_access_recon_loss: 1825664.7167; val_global_loss: 16094085.2667; val_optim_loss: 16094085.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9698; val_auprc_score: 0.9620; val_best_acc_score: 0.9193; val_best_f1_score: 0.9223; train_kl_reg_loss: 80068.3186; train_edge_recon_loss: 2705684.6317; train_gene_expr_recon_loss: 11373431.5420; train_masked_gp_l1_reg_loss: 115698.7273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21228.0058; train_chrom_access_recon_loss: 1861122.0935; train_global_loss: 16157233.2595; train_optim_loss: 16157233.2595; val_kl_reg_loss: 52453.9005; val_edge_recon_loss: 2705068.4167; val_gene_expr_recon_loss: 11385013.0000; val_masked_gp_l1_reg_loss: 115398.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20875.9375; val_chrom_access_recon_loss: 1825609.0500; val_global_loss: 16104418.3333; val_optim_loss: 16104418.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9680; val_auprc_score: 0.9596; val_best_acc_score: 0.9155; val_best_f1_score: 0.9187; train_kl_reg_loss: 78234.6724; train_edge_recon_loss: 2700785.6851; train_gene_expr_recon_loss: 11367506.0687; train_masked_gp_l1_reg_loss: 114821.9280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20620.5675; train_chrom_access_recon_loss: 1860978.3406; train_global_loss: 16142947.3359; train_optim_loss: 16142947.3359; val_kl_reg_loss: 53485.4326; val_edge_recon_loss: 2719325.6167; val_gene_expr_recon_loss: 11274737.6000; val_masked_gp_l1_reg_loss: 114621.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20470.6289; val_chrom_access_recon_loss: 1811904.8083; val_global_loss: 15994545.4667; val_optim_loss: 15994545.4667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9707; val_auprc_score: 0.9596; val_best_acc_score: 0.9241; val_best_f1_score: 0.9264; train_kl_reg_loss: 77926.0906; train_edge_recon_loss: 2694816.0515; train_gene_expr_recon_loss: 11362978.0840; train_masked_gp_l1_reg_loss: 114513.1479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20397.2430; train_chrom_access_recon_loss: 1861849.9370; train_global_loss: 16132480.5420; train_optim_loss: 16132480.5420; val_kl_reg_loss: 53923.3083; val_edge_recon_loss: 2702846.3000; val_gene_expr_recon_loss: 11291694.5333; val_masked_gp_l1_reg_loss: 114415.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20322.3867; val_chrom_access_recon_loss: 1824394.4667; val_global_loss: 16007596.4000; val_optim_loss: 16007596.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9730; val_auprc_score: 0.9659; val_best_acc_score: 0.9227; val_best_f1_score: 0.9247; train_kl_reg_loss: 77090.9415; train_edge_recon_loss: 2694892.4046; train_gene_expr_recon_loss: 11363238.9389; train_masked_gp_l1_reg_loss: 114338.9555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20262.5165; train_chrom_access_recon_loss: 1861874.8750; train_global_loss: 16131698.5725; train_optim_loss: 16131698.5725; val_kl_reg_loss: 54151.0013; val_edge_recon_loss: 2703912.8667; val_gene_expr_recon_loss: 11285573.7333; val_masked_gp_l1_reg_loss: 114257.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20203.7676; val_chrom_access_recon_loss: 1816024.3083; val_global_loss: 15994123.6000; val_optim_loss: 15994123.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9757; val_auprc_score: 0.9684; val_best_acc_score: 0.9279; val_best_f1_score: 0.9294; train_kl_reg_loss: 76197.4488; train_edge_recon_loss: 2701322.2767; train_gene_expr_recon_loss: 11361784.9008; train_masked_gp_l1_reg_loss: 114180.2756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20144.6838; train_chrom_access_recon_loss: 1860852.9847; train_global_loss: 16134482.5267; train_optim_loss: 16134482.5267; val_kl_reg_loss: 54311.6516; val_edge_recon_loss: 2672798.4500; val_gene_expr_recon_loss: 11322451.9333; val_masked_gp_l1_reg_loss: 114106.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20090.4492; val_chrom_access_recon_loss: 1822200.2917; val_global_loss: 16005958.4000; val_optim_loss: 16005958.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 34 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9674
val AUPRC score: 0.9590
val best accuracy score: 0.9138
val best F1 score: 0.9168
val target rna MSE score: 3.3448
val source rna MSE score: 1.7123
val target atac MSE score: 0.5352
val source atac MSE score: 0.1155
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
