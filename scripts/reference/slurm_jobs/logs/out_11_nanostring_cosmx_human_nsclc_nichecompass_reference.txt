[True, False, True]
Run timestamp: 05102023_213300_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '500000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9002; val_auprc_score: 0.9831; val_best_acc_score: 0.9235; val_best_f1_score: 0.9578; train_kl_reg_loss: 16561.7570; train_edge_recon_loss: 643791.0236; train_cat_covariates_contrastive_loss: 478786.1978; train_gene_expr_recon_loss: 2731927.0438; train_masked_gp_l1_reg_loss: 14485.5254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30846.3115; train_global_loss: 3916397.8609; train_optim_loss: 3916397.8609; val_kl_reg_loss: 18723.9106; val_edge_recon_loss: 649155.8344; val_cat_covariates_contrastive_loss: 478557.8758; val_gene_expr_recon_loss: 2458676.9776; val_masked_gp_l1_reg_loss: 15571.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18983.9961; val_global_loss: 3639669.8457; val_optim_loss: 3639669.8457
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9136; val_auprc_score: 0.9850; val_best_acc_score: 0.9282; val_best_f1_score: 0.9603; train_kl_reg_loss: 20203.2921; train_edge_recon_loss: 620951.0134; train_cat_covariates_contrastive_loss: 480048.5407; train_gene_expr_recon_loss: 2355605.2788; train_masked_gp_l1_reg_loss: 17888.4228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19532.7033; train_global_loss: 3514229.2455; train_optim_loss: 3514229.2455; val_kl_reg_loss: 21101.0640; val_edge_recon_loss: 646707.2513; val_cat_covariates_contrastive_loss: 479692.8768; val_gene_expr_recon_loss: 2281185.0579; val_masked_gp_l1_reg_loss: 19397.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19604.1680; val_global_loss: 3467687.7485; val_optim_loss: 3467687.7485
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9204; val_auprc_score: 0.9858; val_best_acc_score: 0.9327; val_best_f1_score: 0.9627; train_kl_reg_loss: 23392.6986; train_edge_recon_loss: 617215.4734; train_cat_covariates_contrastive_loss: 480608.7049; train_gene_expr_recon_loss: 2257165.7853; train_masked_gp_l1_reg_loss: 19962.9269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19529.5062; train_global_loss: 3417875.0953; train_optim_loss: 3417875.0953; val_kl_reg_loss: 23418.2314; val_edge_recon_loss: 645469.2002; val_cat_covariates_contrastive_loss: 480163.3683; val_gene_expr_recon_loss: 2223493.6011; val_masked_gp_l1_reg_loss: 20601.5762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19624.1055; val_global_loss: 3412769.9035; val_optim_loss: 3412769.9035
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9204; val_auprc_score: 0.9859; val_best_acc_score: 0.9341; val_best_f1_score: 0.9635; train_kl_reg_loss: 24386.3276; train_edge_recon_loss: 616907.1431; train_cat_covariates_contrastive_loss: 481348.3183; train_gene_expr_recon_loss: 2210166.4149; train_masked_gp_l1_reg_loss: 20992.3502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19641.0899; train_global_loss: 3373441.6452; train_optim_loss: 3373441.6452; val_kl_reg_loss: 24466.7591; val_edge_recon_loss: 642993.0195; val_cat_covariates_contrastive_loss: 482566.2692; val_gene_expr_recon_loss: 2186861.8032; val_masked_gp_l1_reg_loss: 21394.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19707.1445; val_global_loss: 3377989.1080; val_optim_loss: 3377989.1080
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9115; val_auprc_score: 0.9835; val_best_acc_score: 0.9338; val_best_f1_score: 0.9634; train_kl_reg_loss: 25812.7652; train_edge_recon_loss: 617119.9203; train_cat_covariates_contrastive_loss: 481393.3770; train_gene_expr_recon_loss: 2180644.1068; train_masked_gp_l1_reg_loss: 21537.9885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19753.9691; train_global_loss: 3346262.1286; train_optim_loss: 3346262.1286; val_kl_reg_loss: 28561.8118; val_edge_recon_loss: 641030.3845; val_cat_covariates_contrastive_loss: 479930.3073; val_gene_expr_recon_loss: 2168745.8935; val_masked_gp_l1_reg_loss: 21606.2871; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19782.6270; val_global_loss: 3359657.3989; val_optim_loss: 3359657.3989
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9253; val_auprc_score: 0.9869; val_best_acc_score: 0.9348; val_best_f1_score: 0.9638; train_kl_reg_loss: 26835.1912; train_edge_recon_loss: 618032.8692; train_cat_covariates_contrastive_loss: 481956.2278; train_gene_expr_recon_loss: 2160586.8415; train_masked_gp_l1_reg_loss: 21872.6844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19789.1866; train_global_loss: 3329073.0013; train_optim_loss: 3329073.0013; val_kl_reg_loss: 27920.2885; val_edge_recon_loss: 641217.0212; val_cat_covariates_contrastive_loss: 481605.8278; val_gene_expr_recon_loss: 2148811.3248; val_masked_gp_l1_reg_loss: 21854.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19773.0234; val_global_loss: 3341181.4606; val_optim_loss: 3341181.4606
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9237; val_auprc_score: 0.9864; val_best_acc_score: 0.9372; val_best_f1_score: 0.9652; train_kl_reg_loss: 27021.5732; train_edge_recon_loss: 621240.8479; train_cat_covariates_contrastive_loss: 482040.3260; train_gene_expr_recon_loss: 2245569.6268; train_masked_gp_l1_reg_loss: 36290.5154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20428.7960; train_global_loss: 3432591.6889; train_optim_loss: 3432591.6889; val_kl_reg_loss: 29449.3524; val_edge_recon_loss: 642689.4806; val_cat_covariates_contrastive_loss: 481488.0826; val_gene_expr_recon_loss: 2158156.8002; val_masked_gp_l1_reg_loss: 26428.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19526.7363; val_global_loss: 3357739.2114; val_optim_loss: 3357739.2114
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9293; val_auprc_score: 0.9878; val_best_acc_score: 0.9360; val_best_f1_score: 0.9645; train_kl_reg_loss: 28998.6241; train_edge_recon_loss: 617033.9610; train_cat_covariates_contrastive_loss: 482692.6608; train_gene_expr_recon_loss: 2145413.0169; train_masked_gp_l1_reg_loss: 23328.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19473.9921; train_global_loss: 3316940.8437; train_optim_loss: 3316940.8437; val_kl_reg_loss: 29162.7216; val_edge_recon_loss: 637113.3129; val_cat_covariates_contrastive_loss: 483421.8951; val_gene_expr_recon_loss: 2130120.7635; val_masked_gp_l1_reg_loss: 21740.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19375.3711; val_global_loss: 3320934.6890; val_optim_loss: 3320934.6890
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9297; val_auprc_score: 0.9877; val_best_acc_score: 0.9354; val_best_f1_score: 0.9642; train_kl_reg_loss: 29940.0896; train_edge_recon_loss: 617494.5840; train_cat_covariates_contrastive_loss: 482983.5839; train_gene_expr_recon_loss: 2129857.4253; train_masked_gp_l1_reg_loss: 21951.1691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19620.7419; train_global_loss: 3301847.5929; train_optim_loss: 3301847.5929; val_kl_reg_loss: 29660.3700; val_edge_recon_loss: 639892.9111; val_cat_covariates_contrastive_loss: 485184.2044; val_gene_expr_recon_loss: 2119992.3268; val_masked_gp_l1_reg_loss: 21991.3027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19588.7168; val_global_loss: 3316309.8110; val_optim_loss: 3316309.8110
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9213; val_auprc_score: 0.9865; val_best_acc_score: 0.9329; val_best_f1_score: 0.9628; train_kl_reg_loss: 32249666515.0623; train_edge_recon_loss: 625897.2870; train_cat_covariates_contrastive_loss: 483158.4778; train_gene_expr_recon_loss: 2250337.3050; train_masked_gp_l1_reg_loss: 47351.6924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23235.9856; train_global_loss: 32253095259.1831; train_optim_loss: 32253095259.1831; val_kl_reg_loss: 34572.6954; val_edge_recon_loss: 637260.0048; val_cat_covariates_contrastive_loss: 483716.0416; val_gene_expr_recon_loss: 2226170.3519; val_masked_gp_l1_reg_loss: 66602.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20542.8770; val_global_loss: 3468864.5949; val_optim_loss: 3468864.5949
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9257; val_auprc_score: 0.9866; val_best_acc_score: 0.9352; val_best_f1_score: 0.9640; train_kl_reg_loss: 33932.4979; train_edge_recon_loss: 616361.3181; train_cat_covariates_contrastive_loss: 483994.4939; train_gene_expr_recon_loss: 2153259.8010; train_masked_gp_l1_reg_loss: 37427.1813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19378.8040; train_global_loss: 3344354.0979; train_optim_loss: 3344354.0979; val_kl_reg_loss: 33707.6023; val_edge_recon_loss: 643986.4893; val_cat_covariates_contrastive_loss: 484297.4443; val_gene_expr_recon_loss: 2119660.8789; val_masked_gp_l1_reg_loss: 24433.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19340.9043; val_global_loss: 3325426.9190; val_optim_loss: 3325426.9190
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9221; val_auprc_score: 0.9857; val_best_acc_score: 0.9377; val_best_f1_score: 0.9654; train_kl_reg_loss: 918330.9351; train_edge_recon_loss: 617952.7885; train_cat_covariates_contrastive_loss: 484274.6187; train_gene_expr_recon_loss: 2118630.1157; train_masked_gp_l1_reg_loss: 22166.9093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19451.8133; train_global_loss: 4180807.1473; train_optim_loss: 4180807.1473; val_kl_reg_loss: 35224.3426; val_edge_recon_loss: 636009.7573; val_cat_covariates_contrastive_loss: 482129.1305; val_gene_expr_recon_loss: 2109270.3951; val_masked_gp_l1_reg_loss: 21444.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19615.7773; val_global_loss: 3303693.6242; val_optim_loss: 3303693.6242
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9273; val_auprc_score: 0.9870; val_best_acc_score: 0.9346; val_best_f1_score: 0.9636; train_kl_reg_loss: 33436.3994; train_edge_recon_loss: 616037.6922; train_cat_covariates_contrastive_loss: 484202.3324; train_gene_expr_recon_loss: 2109872.5092; train_masked_gp_l1_reg_loss: 21879.7968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19680.3689; train_global_loss: 3285109.1003; train_optim_loss: 3285109.1003; val_kl_reg_loss: 33639.1313; val_edge_recon_loss: 642714.6019; val_cat_covariates_contrastive_loss: 483965.7795; val_gene_expr_recon_loss: 2103087.9267; val_masked_gp_l1_reg_loss: 22276.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19823.6445; val_global_loss: 3305507.9475; val_optim_loss: 3305507.9475
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9298; val_auprc_score: 0.9876; val_best_acc_score: 0.9407; val_best_f1_score: 0.9671; train_kl_reg_loss: 14667596073.4486; train_edge_recon_loss: 617232.8224; train_cat_covariates_contrastive_loss: 484137.5882; train_gene_expr_recon_loss: 2103927.5949; train_masked_gp_l1_reg_loss: 22396.7365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19820.5885; train_global_loss: 14670843907.2601; train_optim_loss: 14670843907.2601; val_kl_reg_loss: 33525.9743; val_edge_recon_loss: 629610.4848; val_cat_covariates_contrastive_loss: 484546.7215; val_gene_expr_recon_loss: 2099462.4043; val_masked_gp_l1_reg_loss: 22390.3496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19842.0156; val_global_loss: 3289377.8356; val_optim_loss: 3289377.8356
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9287; val_auprc_score: 0.9874; val_best_acc_score: 0.9357; val_best_f1_score: 0.9643; train_kl_reg_loss: 34005.1488; train_edge_recon_loss: 617663.2864; train_cat_covariates_contrastive_loss: 484224.4743; train_gene_expr_recon_loss: 2100541.7628; train_masked_gp_l1_reg_loss: 22630.4491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19899.7641; train_global_loss: 3278964.8855; train_optim_loss: 3278964.8855; val_kl_reg_loss: 33815.6914; val_edge_recon_loss: 635362.7756; val_cat_covariates_contrastive_loss: 485839.4173; val_gene_expr_recon_loss: 2094507.1146; val_masked_gp_l1_reg_loss: 22568.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19998.2031; val_global_loss: 3292091.2485; val_optim_loss: 3292091.2485
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9305; val_auprc_score: 0.9880; val_best_acc_score: 0.9363; val_best_f1_score: 0.9647; train_kl_reg_loss: 29446700239.2976; train_edge_recon_loss: 652529.8474; train_cat_covariates_contrastive_loss: 483576.9906; train_gene_expr_recon_loss: 3480510.9987; train_masked_gp_l1_reg_loss: 73202.6403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28086.3634; train_global_loss: 29451417258.7890; train_optim_loss: 29451417258.7890; val_kl_reg_loss: 37429.3724; val_edge_recon_loss: 637389.9592; val_cat_covariates_contrastive_loss: 487697.9875; val_gene_expr_recon_loss: 2132915.3248; val_masked_gp_l1_reg_loss: 50639.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19257.6914; val_global_loss: 3365329.6458; val_optim_loss: 3365329.6458
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9288; val_auprc_score: 0.9870; val_best_acc_score: 0.9380; val_best_f1_score: 0.9656; train_kl_reg_loss: 38179.7027; train_edge_recon_loss: 618107.4717; train_cat_covariates_contrastive_loss: 485079.8938; train_gene_expr_recon_loss: 2109721.8284; train_masked_gp_l1_reg_loss: 32535.8086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19351.0936; train_global_loss: 3302975.7994; train_optim_loss: 3302975.7994; val_kl_reg_loss: 37712.4662; val_edge_recon_loss: 641537.4295; val_cat_covariates_contrastive_loss: 485753.5649; val_gene_expr_recon_loss: 2099061.3650; val_masked_gp_l1_reg_loss: 23126.5020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19559.5703; val_global_loss: 3306750.8287; val_optim_loss: 3306750.8287
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9255; val_auprc_score: 0.9862; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 89600.9716; train_edge_recon_loss: 618999.9794; train_cat_covariates_contrastive_loss: 485010.8999; train_gene_expr_recon_loss: 2100353.8170; train_masked_gp_l1_reg_loss: 21907.0443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19773.7942; train_global_loss: 3335646.5025; train_optim_loss: 3335646.5025; val_kl_reg_loss: 39259.7127; val_edge_recon_loss: 639921.6095; val_cat_covariates_contrastive_loss: 483692.8077; val_gene_expr_recon_loss: 2095579.1875; val_masked_gp_l1_reg_loss: 21959.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19953.2949; val_global_loss: 3300366.0671; val_optim_loss: 3300366.0671

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9309; val_auprc_score: 0.9876; val_best_acc_score: 0.9394; val_best_f1_score: 0.9664; train_kl_reg_loss: 37812.6637; train_edge_recon_loss: 616349.3200; train_cat_covariates_contrastive_loss: 484726.8846; train_gene_expr_recon_loss: 2082125.0714; train_masked_gp_l1_reg_loss: 19726.0367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14420.8190; train_global_loss: 3255160.7988; train_optim_loss: 3255160.7988; val_kl_reg_loss: 37453.6364; val_edge_recon_loss: 635751.0801; val_cat_covariates_contrastive_loss: 485196.0397; val_gene_expr_recon_loss: 2078996.2708; val_masked_gp_l1_reg_loss: 19817.4941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14287.4248; val_global_loss: 3271502.0247; val_optim_loss: 3271502.0247
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9307; val_auprc_score: 0.9872; val_best_acc_score: 0.9400; val_best_f1_score: 0.9667; train_kl_reg_loss: 37322.0542; train_edge_recon_loss: 614179.7701; train_cat_covariates_contrastive_loss: 484635.8606; train_gene_expr_recon_loss: 2079304.2863; train_masked_gp_l1_reg_loss: 19895.4533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14265.4823; train_global_loss: 3249602.9057; train_optim_loss: 3249602.9057; val_kl_reg_loss: 37269.1870; val_edge_recon_loss: 639676.0236; val_cat_covariates_contrastive_loss: 484332.5283; val_gene_expr_recon_loss: 2077511.3715; val_masked_gp_l1_reg_loss: 19963.7598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14267.3398; val_global_loss: 3273020.1134; val_optim_loss: 3273020.1134
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9337; val_auprc_score: 0.9879; val_best_acc_score: 0.9414; val_best_f1_score: 0.9674; train_kl_reg_loss: 36717.9036; train_edge_recon_loss: 615423.5041; train_cat_covariates_contrastive_loss: 484474.3705; train_gene_expr_recon_loss: 2077380.1532; train_masked_gp_l1_reg_loss: 20037.1636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14253.9075; train_global_loss: 3248287.0005; train_optim_loss: 3248287.0005; val_kl_reg_loss: 36599.3796; val_edge_recon_loss: 638431.1749; val_cat_covariates_contrastive_loss: 483996.2596; val_gene_expr_recon_loss: 2076636.4599; val_masked_gp_l1_reg_loss: 20091.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14240.1914; val_global_loss: 3269995.2708; val_optim_loss: 3269995.2708
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9368; val_auprc_score: 0.9888; val_best_acc_score: 0.9419; val_best_f1_score: 0.9677; train_kl_reg_loss: 36311.5755; train_edge_recon_loss: 615449.7630; train_cat_covariates_contrastive_loss: 484436.5018; train_gene_expr_recon_loss: 2075805.6610; train_masked_gp_l1_reg_loss: 20150.4760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14259.7198; train_global_loss: 3246413.6981; train_optim_loss: 3246413.6981; val_kl_reg_loss: 36069.5917; val_edge_recon_loss: 631967.5036; val_cat_covariates_contrastive_loss: 484461.9688; val_gene_expr_recon_loss: 2073304.1547; val_masked_gp_l1_reg_loss: 20190.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14233.7217; val_global_loss: 3260227.2176; val_optim_loss: 3260227.2176
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9349; val_auprc_score: 0.9883; val_best_acc_score: 0.9407; val_best_f1_score: 0.9669; train_kl_reg_loss: 35818.7980; train_edge_recon_loss: 614180.9808; train_cat_covariates_contrastive_loss: 484298.2943; train_gene_expr_recon_loss: 2074600.2942; train_masked_gp_l1_reg_loss: 20262.4400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14273.6230; train_global_loss: 3243434.4270; train_optim_loss: 3243434.4270; val_kl_reg_loss: 35792.0977; val_edge_recon_loss: 641467.9432; val_cat_covariates_contrastive_loss: 484224.4968; val_gene_expr_recon_loss: 2071958.5467; val_masked_gp_l1_reg_loss: 20321.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14270.4238; val_global_loss: 3268035.3333; val_optim_loss: 3268035.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9343; val_auprc_score: 0.9882; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 35389.9039; train_edge_recon_loss: 614397.4045; train_cat_covariates_contrastive_loss: 484273.7105; train_gene_expr_recon_loss: 2072665.6144; train_masked_gp_l1_reg_loss: 20378.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14294.6775; train_global_loss: 3241399.9413; train_optim_loss: 3241399.9413; val_kl_reg_loss: 35157.1301; val_edge_recon_loss: 634107.8199; val_cat_covariates_contrastive_loss: 484113.5038; val_gene_expr_recon_loss: 2068128.3025; val_masked_gp_l1_reg_loss: 20434.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14318.1719; val_global_loss: 3256259.0069; val_optim_loss: 3256259.0069
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9338; val_auprc_score: 0.9882; val_best_acc_score: 0.9408; val_best_f1_score: 0.9670; train_kl_reg_loss: 34966.2319; train_edge_recon_loss: 617291.5411; train_cat_covariates_contrastive_loss: 484137.2092; train_gene_expr_recon_loss: 2070289.6638; train_masked_gp_l1_reg_loss: 20500.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14322.9337; train_global_loss: 3241508.1110; train_optim_loss: 3241508.1110; val_kl_reg_loss: 34762.0278; val_edge_recon_loss: 636430.9080; val_cat_covariates_contrastive_loss: 483776.0775; val_gene_expr_recon_loss: 2066772.6609; val_masked_gp_l1_reg_loss: 20573.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14351.1914; val_global_loss: 3256666.9290; val_optim_loss: 3256666.9290
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9237; val_auprc_score: 0.9863; val_best_acc_score: 0.9370; val_best_f1_score: 0.9651; train_kl_reg_loss: 26899.8141; train_edge_recon_loss: 621694.0407; train_cat_covariates_contrastive_loss: 481313.4064; train_gene_expr_recon_loss: 1987258.9978; train_masked_gp_l1_reg_loss: 22115.1456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17069.3134; train_global_loss: 3156350.7212; train_optim_loss: 3156350.7212; val_kl_reg_loss: 15877.3428; val_edge_recon_loss: 637659.3444; val_cat_covariates_contrastive_loss: 480369.2807; val_gene_expr_recon_loss: 1950747.9487; val_masked_gp_l1_reg_loss: 20052.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15083.3447; val_global_loss: 3119789.9105; val_optim_loss: 3119789.9105
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9231; val_auprc_score: 0.9858; val_best_acc_score: 0.9363; val_best_f1_score: 0.9647; train_kl_reg_loss: 21831.4242; train_edge_recon_loss: 616056.5373; train_cat_covariates_contrastive_loss: 480130.3746; train_gene_expr_recon_loss: 1945984.9749; train_masked_gp_l1_reg_loss: 17284.8132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14358.1233; train_global_loss: 3095646.2472; train_optim_loss: 3095646.2472; val_kl_reg_loss: 14558.1318; val_edge_recon_loss: 641766.5425; val_cat_covariates_contrastive_loss: 479976.1785; val_gene_expr_recon_loss: 1934287.2531; val_masked_gp_l1_reg_loss: 14676.2920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13819.0098; val_global_loss: 3099083.3596; val_optim_loss: 3099083.3596
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9260; val_auprc_score: 0.9868; val_best_acc_score: 0.9362; val_best_f1_score: 0.9647; train_kl_reg_loss: 19620.0749; train_edge_recon_loss: 612990.7996; train_cat_covariates_contrastive_loss: 479693.7845; train_gene_expr_recon_loss: 1923848.8215; train_masked_gp_l1_reg_loss: 13099.1361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13479.1664; train_global_loss: 3062731.7792; train_optim_loss: 3062731.7792; val_kl_reg_loss: 14994.9256; val_edge_recon_loss: 637855.4239; val_cat_covariates_contrastive_loss: 479930.7002; val_gene_expr_recon_loss: 1915105.4572; val_masked_gp_l1_reg_loss: 12054.8584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13302.7500; val_global_loss: 3073244.0062; val_optim_loss: 3073244.0062
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9274; val_auprc_score: 0.9869; val_best_acc_score: 0.9380; val_best_f1_score: 0.9657; train_kl_reg_loss: 18450.6986; train_edge_recon_loss: 613635.0886; train_cat_covariates_contrastive_loss: 479581.6764; train_gene_expr_recon_loss: 1912173.1194; train_masked_gp_l1_reg_loss: 11784.1588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13268.2900; train_global_loss: 3048893.0275; train_optim_loss: 3048893.0275; val_kl_reg_loss: 14924.2309; val_edge_recon_loss: 638207.6613; val_cat_covariates_contrastive_loss: 479263.7066; val_gene_expr_recon_loss: 1904459.4352; val_masked_gp_l1_reg_loss: 11750.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13294.8613; val_global_loss: 3061900.0255; val_optim_loss: 3061900.0255
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9285; val_auprc_score: 0.9872; val_best_acc_score: 0.9388; val_best_f1_score: 0.9660; train_kl_reg_loss: 17828.1321; train_edge_recon_loss: 612788.3887; train_cat_covariates_contrastive_loss: 479488.1787; train_gene_expr_recon_loss: 1903570.9589; train_masked_gp_l1_reg_loss: 11895.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13370.0124; train_global_loss: 3038940.9249; train_optim_loss: 3038940.9249; val_kl_reg_loss: 14656.1335; val_edge_recon_loss: 633878.9031; val_cat_covariates_contrastive_loss: 479591.5015; val_gene_expr_recon_loss: 1898271.5471; val_masked_gp_l1_reg_loss: 12040.0830; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13442.2637; val_global_loss: 3051880.3418; val_optim_loss: 3051880.3418
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9318; val_auprc_score: 0.9879; val_best_acc_score: 0.9401; val_best_f1_score: 0.9668; train_kl_reg_loss: 17418.3091; train_edge_recon_loss: 612984.1959; train_cat_covariates_contrastive_loss: 479417.7286; train_gene_expr_recon_loss: 1901283.8207; train_masked_gp_l1_reg_loss: 12144.4345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13562.5833; train_global_loss: 3036811.0723; train_optim_loss: 3036811.0723; val_kl_reg_loss: 13946.7250; val_edge_recon_loss: 632436.1998; val_cat_covariates_contrastive_loss: 480726.1934; val_gene_expr_recon_loss: 1894823.9637; val_masked_gp_l1_reg_loss: 12233.3174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13614.8105; val_global_loss: 3047781.0826; val_optim_loss: 3047781.0826
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9330; val_auprc_score: 0.9881; val_best_acc_score: 0.9411; val_best_f1_score: 0.9673; train_kl_reg_loss: 17175.0570; train_edge_recon_loss: 610950.6466; train_cat_covariates_contrastive_loss: 479506.6754; train_gene_expr_recon_loss: 1894067.9578; train_masked_gp_l1_reg_loss: 12314.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13654.1466; train_global_loss: 3027668.7732; train_optim_loss: 3027668.7732; val_kl_reg_loss: 15167.6291; val_edge_recon_loss: 627782.8919; val_cat_covariates_contrastive_loss: 479451.0738; val_gene_expr_recon_loss: 1888506.4641; val_masked_gp_l1_reg_loss: 12382.7754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13659.4512; val_global_loss: 3036950.3110; val_optim_loss: 3036950.3110
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9314; val_auprc_score: 0.9877; val_best_acc_score: 0.9393; val_best_f1_score: 0.9664; train_kl_reg_loss: 16795.0319; train_edge_recon_loss: 610103.0155; train_cat_covariates_contrastive_loss: 479158.5799; train_gene_expr_recon_loss: 1889871.0461; train_masked_gp_l1_reg_loss: 12438.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13695.1180; train_global_loss: 3022061.7599; train_optim_loss: 3022061.7599; val_kl_reg_loss: 14941.9462; val_edge_recon_loss: 635527.6638; val_cat_covariates_contrastive_loss: 479798.8057; val_gene_expr_recon_loss: 1885760.8665; val_masked_gp_l1_reg_loss: 12481.9307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13709.2725; val_global_loss: 3042220.5324; val_optim_loss: 3042220.5324
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9307; val_auprc_score: 0.9879; val_best_acc_score: 0.9409; val_best_f1_score: 0.9673; train_kl_reg_loss: 16803.3123; train_edge_recon_loss: 609824.2295; train_cat_covariates_contrastive_loss: 479232.0662; train_gene_expr_recon_loss: 1883788.0877; train_masked_gp_l1_reg_loss: 12507.6071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13710.2982; train_global_loss: 3015865.6037; train_optim_loss: 3015865.6037; val_kl_reg_loss: 14425.4496; val_edge_recon_loss: 626842.3276; val_cat_covariates_contrastive_loss: 479820.5923; val_gene_expr_recon_loss: 1878918.5089; val_masked_gp_l1_reg_loss: 12539.3145; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13733.9512; val_global_loss: 3026280.1319; val_optim_loss: 3026280.1319
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9305; val_auprc_score: 0.9875; val_best_acc_score: 0.9390; val_best_f1_score: 0.9662; train_kl_reg_loss: 16607.1632; train_edge_recon_loss: 611756.3357; train_cat_covariates_contrastive_loss: 479196.1314; train_gene_expr_recon_loss: 1878976.9024; train_masked_gp_l1_reg_loss: 12581.7117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13734.2011; train_global_loss: 3012852.4500; train_optim_loss: 3012852.4500; val_kl_reg_loss: 14790.2252; val_edge_recon_loss: 635920.3855; val_cat_covariates_contrastive_loss: 479120.7661; val_gene_expr_recon_loss: 1874757.2404; val_masked_gp_l1_reg_loss: 12613.5762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13739.8838; val_global_loss: 3030942.1242; val_optim_loss: 3030942.1242
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9310; val_auprc_score: 0.9876; val_best_acc_score: 0.9395; val_best_f1_score: 0.9665; train_kl_reg_loss: 18233.3762; train_edge_recon_loss: 611360.2672; train_cat_covariates_contrastive_loss: 479509.3879; train_gene_expr_recon_loss: 1872991.5686; train_masked_gp_l1_reg_loss: 12652.9596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13758.8985; train_global_loss: 3008506.4564; train_optim_loss: 3008506.4564; val_kl_reg_loss: 13016.1560; val_edge_recon_loss: 638260.7502; val_cat_covariates_contrastive_loss: 480394.3982; val_gene_expr_recon_loss: 1867108.9495; val_masked_gp_l1_reg_loss: 12698.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13763.1943; val_global_loss: 3025242.0170; val_optim_loss: 3025242.0170
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9284; val_auprc_score: 0.9873; val_best_acc_score: 0.9376; val_best_f1_score: 0.9654; train_kl_reg_loss: 16929.6100; train_edge_recon_loss: 612177.5595; train_cat_covariates_contrastive_loss: 479860.0421; train_gene_expr_recon_loss: 1868079.4241; train_masked_gp_l1_reg_loss: 12727.5797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13762.4664; train_global_loss: 3003536.6840; train_optim_loss: 3003536.6840; val_kl_reg_loss: 13239.7884; val_edge_recon_loss: 635969.2976; val_cat_covariates_contrastive_loss: 479542.0089; val_gene_expr_recon_loss: 1860974.7188; val_masked_gp_l1_reg_loss: 12757.0713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13742.7627; val_global_loss: 3016225.5679; val_optim_loss: 3016225.5679
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9267; val_auprc_score: 0.9870; val_best_acc_score: 0.9372; val_best_f1_score: 0.9652; train_kl_reg_loss: 469686.0194; train_edge_recon_loss: 613204.5249; train_cat_covariates_contrastive_loss: 479714.8664; train_gene_expr_recon_loss: 1856616.7235; train_masked_gp_l1_reg_loss: 12761.7373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13743.6114; train_global_loss: 3445727.5022; train_optim_loss: 3445727.5022; val_kl_reg_loss: 12634.3537; val_edge_recon_loss: 635230.3410; val_cat_covariates_contrastive_loss: 479581.7535; val_gene_expr_recon_loss: 1845346.9653; val_masked_gp_l1_reg_loss: 12766.3330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13724.9883; val_global_loss: 2999284.6620; val_optim_loss: 2999284.6620
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9276; val_auprc_score: 0.9870; val_best_acc_score: 0.9371; val_best_f1_score: 0.9652; train_kl_reg_loss: 16219.8317; train_edge_recon_loss: 614881.3865; train_cat_covariates_contrastive_loss: 479489.5983; train_gene_expr_recon_loss: 1848534.7076; train_masked_gp_l1_reg_loss: 12757.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13711.6295; train_global_loss: 2985594.8196; train_optim_loss: 2985594.8196; val_kl_reg_loss: 13469.8886; val_edge_recon_loss: 641110.6482; val_cat_covariates_contrastive_loss: 479126.3625; val_gene_expr_recon_loss: 1845426.6242; val_masked_gp_l1_reg_loss: 12739.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13681.4590; val_global_loss: 3005554.5162; val_optim_loss: 3005554.5162
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9252; val_auprc_score: 0.9865; val_best_acc_score: 0.9358; val_best_f1_score: 0.9644; train_kl_reg_loss: 15805.2633; train_edge_recon_loss: 615382.2197; train_cat_covariates_contrastive_loss: 479401.7356; train_gene_expr_recon_loss: 1847541.1022; train_masked_gp_l1_reg_loss: 12754.1007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13697.5004; train_global_loss: 2984581.9186; train_optim_loss: 2984581.9186; val_kl_reg_loss: 13522.0208; val_edge_recon_loss: 641707.7687; val_cat_covariates_contrastive_loss: 478909.0762; val_gene_expr_recon_loss: 1849822.2145; val_masked_gp_l1_reg_loss: 12771.9473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13719.9551; val_global_loss: 3010453.0802; val_optim_loss: 3010453.0802
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9261; val_auprc_score: 0.9869; val_best_acc_score: 0.9368; val_best_f1_score: 0.9649; train_kl_reg_loss: 15592.4495; train_edge_recon_loss: 611445.4295; train_cat_covariates_contrastive_loss: 479060.9048; train_gene_expr_recon_loss: 1850192.4070; train_masked_gp_l1_reg_loss: 12792.7474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13668.7009; train_global_loss: 2982752.6388; train_optim_loss: 2982752.6388; val_kl_reg_loss: 13702.3085; val_edge_recon_loss: 637247.5314; val_cat_covariates_contrastive_loss: 479152.4268; val_gene_expr_recon_loss: 1844857.8067; val_masked_gp_l1_reg_loss: 12815.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13575.0732; val_global_loss: 3001350.5718; val_optim_loss: 3001350.5718
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9266; val_auprc_score: 0.9866; val_best_acc_score: 0.9368; val_best_f1_score: 0.9650; train_kl_reg_loss: 15479.5787; train_edge_recon_loss: 612729.3056; train_cat_covariates_contrastive_loss: 478928.9106; train_gene_expr_recon_loss: 1845809.5087; train_masked_gp_l1_reg_loss: 12824.6991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13557.5676; train_global_loss: 2979329.5722; train_optim_loss: 2979329.5722; val_kl_reg_loss: 13873.8470; val_edge_recon_loss: 640882.6276; val_cat_covariates_contrastive_loss: 478818.2076; val_gene_expr_recon_loss: 1841352.6562; val_masked_gp_l1_reg_loss: 12839.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13539.9355; val_global_loss: 3001306.8441; val_optim_loss: 3001306.8441

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9279; val_auprc_score: 0.9873; val_best_acc_score: 0.9372; val_best_f1_score: 0.9652; train_kl_reg_loss: 15338.5933; train_edge_recon_loss: 612781.1610; train_cat_covariates_contrastive_loss: 478866.4032; train_gene_expr_recon_loss: 1843257.3265; train_masked_gp_l1_reg_loss: 12728.4728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13096.4788; train_global_loss: 2976068.4339; train_optim_loss: 2976068.4339; val_kl_reg_loss: 13927.4783; val_edge_recon_loss: 634799.9239; val_cat_covariates_contrastive_loss: 478917.1012; val_gene_expr_recon_loss: 1841377.5224; val_masked_gp_l1_reg_loss: 12730.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13061.2217; val_global_loss: 2994813.5301; val_optim_loss: 2994813.5301
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9275; val_auprc_score: 0.9870; val_best_acc_score: 0.9374; val_best_f1_score: 0.9652; train_kl_reg_loss: 15249.5055; train_edge_recon_loss: 611726.1670; train_cat_covariates_contrastive_loss: 478854.9579; train_gene_expr_recon_loss: 1843073.0663; train_masked_gp_l1_reg_loss: 12733.0412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13052.5896; train_global_loss: 2974689.3243; train_optim_loss: 2974689.3243; val_kl_reg_loss: 13948.0330; val_edge_recon_loss: 638993.9144; val_cat_covariates_contrastive_loss: 479111.9216; val_gene_expr_recon_loss: 1840738.5559; val_masked_gp_l1_reg_loss: 12735.4229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13045.2061; val_global_loss: 2998573.1829; val_optim_loss: 2998573.1829
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9280; val_auprc_score: 0.9873; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 15243.3968; train_edge_recon_loss: 611229.9857; train_cat_covariates_contrastive_loss: 478903.9815; train_gene_expr_recon_loss: 1842583.6356; train_masked_gp_l1_reg_loss: 12737.8127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13044.0530; train_global_loss: 2973742.8695; train_optim_loss: 2973742.8695; val_kl_reg_loss: 14011.7175; val_edge_recon_loss: 632783.0029; val_cat_covariates_contrastive_loss: 479098.5689; val_gene_expr_recon_loss: 1840969.9043; val_masked_gp_l1_reg_loss: 12741.4111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13042.6846; val_global_loss: 2992647.4437; val_optim_loss: 2992647.4437
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9304; val_auprc_score: 0.9877; val_best_acc_score: 0.9380; val_best_f1_score: 0.9655; train_kl_reg_loss: 15214.8278; train_edge_recon_loss: 611864.9062; train_cat_covariates_contrastive_loss: 478788.8471; train_gene_expr_recon_loss: 1841993.1206; train_masked_gp_l1_reg_loss: 12743.0977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13038.1625; train_global_loss: 2973642.9597; train_optim_loss: 2973642.9597; val_kl_reg_loss: 14022.3777; val_edge_recon_loss: 636978.7198; val_cat_covariates_contrastive_loss: 478978.4309; val_gene_expr_recon_loss: 1839668.3056; val_masked_gp_l1_reg_loss: 12745.1006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13033.7188; val_global_loss: 2995426.5748; val_optim_loss: 2995426.5748
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9266; val_auprc_score: 0.9869; val_best_acc_score: 0.9377; val_best_f1_score: 0.9654; train_kl_reg_loss: 15211.7793; train_edge_recon_loss: 611576.4348; train_cat_covariates_contrastive_loss: 478828.7782; train_gene_expr_recon_loss: 1842264.2830; train_masked_gp_l1_reg_loss: 12747.0676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13030.9445; train_global_loss: 2973659.2829; train_optim_loss: 2973659.2829; val_kl_reg_loss: 14022.0913; val_edge_recon_loss: 637785.7199; val_cat_covariates_contrastive_loss: 478830.7250; val_gene_expr_recon_loss: 1838261.6138; val_masked_gp_l1_reg_loss: 12750.8418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13031.4697; val_global_loss: 2994682.4043; val_optim_loss: 2994682.4043
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9284; val_auprc_score: 0.9875; val_best_acc_score: 0.9382; val_best_f1_score: 0.9657; train_kl_reg_loss: 15174.9837; train_edge_recon_loss: 613545.8489; train_cat_covariates_contrastive_loss: 478769.6327; train_gene_expr_recon_loss: 1842152.6721; train_masked_gp_l1_reg_loss: 12753.0277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13029.8596; train_global_loss: 2975426.0220; train_optim_loss: 2975426.0220; val_kl_reg_loss: 14109.5427; val_edge_recon_loss: 631706.2187; val_cat_covariates_contrastive_loss: 478776.9629; val_gene_expr_recon_loss: 1840289.0320; val_masked_gp_l1_reg_loss: 12755.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13027.4717; val_global_loss: 2990664.2523; val_optim_loss: 2990664.2523
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9301; val_auprc_score: 0.9877; val_best_acc_score: 0.9386; val_best_f1_score: 0.9660; train_kl_reg_loss: 15203.2875; train_edge_recon_loss: 612434.9791; train_cat_covariates_contrastive_loss: 478725.4468; train_gene_expr_recon_loss: 1844505.7003; train_masked_gp_l1_reg_loss: 12759.6389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13024.6395; train_global_loss: 2976653.6901; train_optim_loss: 2976653.6901; val_kl_reg_loss: 13937.5442; val_edge_recon_loss: 631324.3531; val_cat_covariates_contrastive_loss: 479007.8872; val_gene_expr_recon_loss: 1840051.7029; val_masked_gp_l1_reg_loss: 12762.2881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13023.8857; val_global_loss: 2990107.7323; val_optim_loss: 2990107.7323
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9277; val_auprc_score: 0.9872; val_best_acc_score: 0.9377; val_best_f1_score: 0.9654; train_kl_reg_loss: 15075.7695; train_edge_recon_loss: 611798.4609; train_cat_covariates_contrastive_loss: 478850.9830; train_gene_expr_recon_loss: 1842726.7585; train_masked_gp_l1_reg_loss: 12758.0016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13023.0319; train_global_loss: 2974233.0063; train_optim_loss: 2974233.0063; val_kl_reg_loss: 14015.2434; val_edge_recon_loss: 634171.3238; val_cat_covariates_contrastive_loss: 478641.3383; val_gene_expr_recon_loss: 1839928.0764; val_masked_gp_l1_reg_loss: 12751.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13020.7334; val_global_loss: 2992528.2269; val_optim_loss: 2992528.2269
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9291; val_auprc_score: 0.9876; val_best_acc_score: 0.9376; val_best_f1_score: 0.9655; train_kl_reg_loss: 39569.8954; train_edge_recon_loss: 611702.4102; train_cat_covariates_contrastive_loss: 478698.7580; train_gene_expr_recon_loss: 1842170.2229; train_masked_gp_l1_reg_loss: 12743.4253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13023.4379; train_global_loss: 2997908.1545; train_optim_loss: 2997908.1545; val_kl_reg_loss: 13962.9316; val_edge_recon_loss: 632874.1372; val_cat_covariates_contrastive_loss: 478951.5831; val_gene_expr_recon_loss: 1839645.0802; val_masked_gp_l1_reg_loss: 12734.9326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13024.3740; val_global_loss: 2991192.9830; val_optim_loss: 2991192.9830
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9285; val_auprc_score: 0.9874; val_best_acc_score: 0.9389; val_best_f1_score: 0.9661; train_kl_reg_loss: 15068.0067; train_edge_recon_loss: 611259.3924; train_cat_covariates_contrastive_loss: 478725.9391; train_gene_expr_recon_loss: 1842077.2801; train_masked_gp_l1_reg_loss: 12728.3467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13024.9655; train_global_loss: 2972883.9340; train_optim_loss: 2972883.9340; val_kl_reg_loss: 14056.2225; val_edge_recon_loss: 631168.3284; val_cat_covariates_contrastive_loss: 478705.5049; val_gene_expr_recon_loss: 1839177.1933; val_masked_gp_l1_reg_loss: 12722.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13023.6787; val_global_loss: 2988853.2415; val_optim_loss: 2988853.2415
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9282; val_auprc_score: 0.9873; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 15026.6770; train_edge_recon_loss: 613093.7836; train_cat_covariates_contrastive_loss: 478727.0781; train_gene_expr_recon_loss: 1841825.8443; train_masked_gp_l1_reg_loss: 12717.8492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13024.8613; train_global_loss: 2974416.0942; train_optim_loss: 2974416.0942; val_kl_reg_loss: 14096.3028; val_edge_recon_loss: 636874.9389; val_cat_covariates_contrastive_loss: 478563.2872; val_gene_expr_recon_loss: 1838372.0266; val_masked_gp_l1_reg_loss: 12714.0186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13028.1514; val_global_loss: 2993648.8056; val_optim_loss: 2993648.8056
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9311; val_auprc_score: 0.9878; val_best_acc_score: 0.9390; val_best_f1_score: 0.9661; train_kl_reg_loss: 15027.9746; train_edge_recon_loss: 611998.5502; train_cat_covariates_contrastive_loss: 478734.0882; train_gene_expr_recon_loss: 1841707.1776; train_masked_gp_l1_reg_loss: 12709.4525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13023.3094; train_global_loss: 2973200.5569; train_optim_loss: 2973200.5569; val_kl_reg_loss: 14054.1885; val_edge_recon_loss: 635662.0583; val_cat_covariates_contrastive_loss: 478756.2377; val_gene_expr_recon_loss: 1839296.4066; val_masked_gp_l1_reg_loss: 12704.1240; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13017.4453; val_global_loss: 2993490.3835; val_optim_loss: 2993490.3835
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9279; val_auprc_score: 0.9871; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 15058.7459; train_edge_recon_loss: 609753.3948; train_cat_covariates_contrastive_loss: 478718.2989; train_gene_expr_recon_loss: 1841306.4296; train_masked_gp_l1_reg_loss: 12699.4925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13020.0730; train_global_loss: 2970556.4345; train_optim_loss: 2970556.4345; val_kl_reg_loss: 14108.5209; val_edge_recon_loss: 635817.2088; val_cat_covariates_contrastive_loss: 478674.3786; val_gene_expr_recon_loss: 1839829.5386; val_masked_gp_l1_reg_loss: 12695.3096; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13020.1230; val_global_loss: 2994144.8951; val_optim_loss: 2994144.8951
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9291; val_auprc_score: 0.9876; val_best_acc_score: 0.9388; val_best_f1_score: 0.9661; train_kl_reg_loss: 15005.5673; train_edge_recon_loss: 612648.2476; train_cat_covariates_contrastive_loss: 478689.2428; train_gene_expr_recon_loss: 1840720.3534; train_masked_gp_l1_reg_loss: 12690.1045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13016.6555; train_global_loss: 2972770.1726; train_optim_loss: 2972770.1726; val_kl_reg_loss: 14061.7033; val_edge_recon_loss: 630686.3838; val_cat_covariates_contrastive_loss: 478992.6399; val_gene_expr_recon_loss: 1839193.9360; val_masked_gp_l1_reg_loss: 12685.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13014.6191; val_global_loss: 2988634.4128; val_optim_loss: 2988634.4128
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9284; val_auprc_score: 0.9873; val_best_acc_score: 0.9379; val_best_f1_score: 0.9657; train_kl_reg_loss: 14991.2150; train_edge_recon_loss: 609432.5889; train_cat_covariates_contrastive_loss: 478662.3213; train_gene_expr_recon_loss: 1840653.7397; train_masked_gp_l1_reg_loss: 12682.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13019.5705; train_global_loss: 2969442.1640; train_optim_loss: 2969442.1640; val_kl_reg_loss: 14119.5154; val_edge_recon_loss: 636606.0138; val_cat_covariates_contrastive_loss: 478829.2460; val_gene_expr_recon_loss: 1838465.7180; val_masked_gp_l1_reg_loss: 12679.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13018.2285; val_global_loss: 2993718.4900; val_optim_loss: 2993718.4900
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9285; val_auprc_score: 0.9873; val_best_acc_score: 0.9388; val_best_f1_score: 0.9661; train_kl_reg_loss: 15007.7600; train_edge_recon_loss: 609601.1885; train_cat_covariates_contrastive_loss: 478721.2697; train_gene_expr_recon_loss: 1840516.1346; train_masked_gp_l1_reg_loss: 12676.8770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13020.7887; train_global_loss: 2969544.0212; train_optim_loss: 2969544.0212; val_kl_reg_loss: 14158.6890; val_edge_recon_loss: 633225.7707; val_cat_covariates_contrastive_loss: 478596.0792; val_gene_expr_recon_loss: 1837950.0660; val_masked_gp_l1_reg_loss: 12672.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13018.6982; val_global_loss: 2989621.6181; val_optim_loss: 2989621.6181
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9300; val_auprc_score: 0.9875; val_best_acc_score: 0.9393; val_best_f1_score: 0.9662; train_kl_reg_loss: 15027.0541; train_edge_recon_loss: 613739.0908; train_cat_covariates_contrastive_loss: 478630.9202; train_gene_expr_recon_loss: 1840144.7746; train_masked_gp_l1_reg_loss: 12669.0908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13022.4256; train_global_loss: 2973233.3535; train_optim_loss: 2973233.3535; val_kl_reg_loss: 14165.6637; val_edge_recon_loss: 635576.2286; val_cat_covariates_contrastive_loss: 478654.5647; val_gene_expr_recon_loss: 1837948.3218; val_masked_gp_l1_reg_loss: 12665.2881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13025.4346; val_global_loss: 2992035.5247; val_optim_loss: 2992035.5247
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9299; val_auprc_score: 0.9876; val_best_acc_score: 0.9383; val_best_f1_score: 0.9658; train_kl_reg_loss: 15022.3748; train_edge_recon_loss: 612695.7397; train_cat_covariates_contrastive_loss: 478636.5240; train_gene_expr_recon_loss: 1840013.5138; train_masked_gp_l1_reg_loss: 12661.5288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13023.5010; train_global_loss: 2972053.1804; train_optim_loss: 2972053.1804; val_kl_reg_loss: 14001.5605; val_edge_recon_loss: 634669.9589; val_cat_covariates_contrastive_loss: 478771.2913; val_gene_expr_recon_loss: 1837258.3376; val_masked_gp_l1_reg_loss: 12658.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13022.9922; val_global_loss: 2990382.3989; val_optim_loss: 2990382.3989

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9299; val_auprc_score: 0.9876; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 14962.3140; train_edge_recon_loss: 610292.7919; train_cat_covariates_contrastive_loss: 478705.3737; train_gene_expr_recon_loss: 1839916.8770; train_masked_gp_l1_reg_loss: 12645.9152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12973.9760; train_global_loss: 2969497.2404; train_optim_loss: 2969497.2404; val_kl_reg_loss: 14104.3425; val_edge_recon_loss: 638617.1120; val_cat_covariates_contrastive_loss: 479067.6356; val_gene_expr_recon_loss: 1837241.4688; val_masked_gp_l1_reg_loss: 12645.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12966.7852; val_global_loss: 2994642.5586; val_optim_loss: 2994642.5586
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9291; val_auprc_score: 0.9872; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 15003.8208; train_edge_recon_loss: 609140.4643; train_cat_covariates_contrastive_loss: 478694.9764; train_gene_expr_recon_loss: 1839930.9985; train_masked_gp_l1_reg_loss: 12644.7632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12965.4250; train_global_loss: 2968380.4556; train_optim_loss: 2968380.4556; val_kl_reg_loss: 14181.0137; val_edge_recon_loss: 639462.8437; val_cat_covariates_contrastive_loss: 478881.4763; val_gene_expr_recon_loss: 1838265.9136; val_masked_gp_l1_reg_loss: 12644.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12964.5537; val_global_loss: 2996400.2423; val_optim_loss: 2996400.2423
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9295; val_auprc_score: 0.9875; val_best_acc_score: 0.9376; val_best_f1_score: 0.9654; train_kl_reg_loss: 15028.0615; train_edge_recon_loss: 609353.9124; train_cat_covariates_contrastive_loss: 478654.6878; train_gene_expr_recon_loss: 1839915.4424; train_masked_gp_l1_reg_loss: 12644.0323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12964.4548; train_global_loss: 2968560.5875; train_optim_loss: 2968560.5875; val_kl_reg_loss: 14140.7049; val_edge_recon_loss: 641833.8426; val_cat_covariates_contrastive_loss: 478831.9308; val_gene_expr_recon_loss: 1838349.5127; val_masked_gp_l1_reg_loss: 12643.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12964.5078; val_global_loss: 2998764.2500; val_optim_loss: 2998764.2500
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9294; val_auprc_score: 0.9875; val_best_acc_score: 0.9383; val_best_f1_score: 0.9658; train_kl_reg_loss: 15005.5368; train_edge_recon_loss: 613827.5610; train_cat_covariates_contrastive_loss: 478660.9590; train_gene_expr_recon_loss: 1840204.4408; train_masked_gp_l1_reg_loss: 12643.2651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12964.0755; train_global_loss: 2973305.8381; train_optim_loss: 2973305.8381; val_kl_reg_loss: 14134.9608; val_edge_recon_loss: 636294.2736; val_cat_covariates_contrastive_loss: 478812.9972; val_gene_expr_recon_loss: 1837363.5154; val_masked_gp_l1_reg_loss: 12642.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12963.8301; val_global_loss: 2992212.4977; val_optim_loss: 2992212.4977

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 860 min 45 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9152
val AUPRC score: 0.9821
val best accuracy score: 0.9370
val best F1 score: 0.9650
val target rna MSE score: 0.3736
val source rna MSE score: 0.1804
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0508
Val cat covariate2 mean sim diff: -0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
