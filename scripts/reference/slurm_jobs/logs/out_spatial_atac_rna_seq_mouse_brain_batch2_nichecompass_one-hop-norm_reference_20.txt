[True]
Run timestamp: 07092023_143159_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6817; val_auprc_score: 0.6522; val_best_acc_score: 0.5097; val_best_f1_score: 0.6706; train_kl_reg_loss: 53109.7863; train_edge_recon_loss: 3536673.9886; train_gene_expr_recon_loss: 12390152.3485; train_masked_gp_l1_reg_loss: 55588.4077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 815466.5938; train_chrom_access_recon_loss: 6158719.2273; train_global_loss: 23009710.2727; train_optim_loss: 23009710.2727; val_kl_reg_loss: 84105.7373; val_edge_recon_loss: 4064335.1562; val_gene_expr_recon_loss: 11507127.5000; val_masked_gp_l1_reg_loss: 51875.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 622244.3125; val_chrom_access_recon_loss: 6047056.3750; val_global_loss: 22376744.0000; val_optim_loss: 22376744.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7186; val_auprc_score: 0.6974; val_best_acc_score: 0.5583; val_best_f1_score: 0.6879; train_kl_reg_loss: 98767.9820; train_edge_recon_loss: 3524270.1780; train_gene_expr_recon_loss: 11303829.4697; train_masked_gp_l1_reg_loss: 49095.4985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 458101.4389; train_chrom_access_recon_loss: 5852593.7273; train_global_loss: 21286658.3636; train_optim_loss: 21286658.3636; val_kl_reg_loss: 105321.0967; val_edge_recon_loss: 4061621.2500; val_gene_expr_recon_loss: 11178853.1250; val_masked_gp_l1_reg_loss: 47974.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 319456.4062; val_chrom_access_recon_loss: 5920715.8125; val_global_loss: 21633941.0000; val_optim_loss: 21633941.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7805; val_auprc_score: 0.7643; val_best_acc_score: 0.7163; val_best_f1_score: 0.7212; train_kl_reg_loss: 90677.7609; train_edge_recon_loss: 3516578.8030; train_gene_expr_recon_loss: 11146744.9091; train_masked_gp_l1_reg_loss: 48208.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239473.1397; train_chrom_access_recon_loss: 5794650.6970; train_global_loss: 20836333.9091; train_optim_loss: 20836333.9091; val_kl_reg_loss: 85024.2734; val_edge_recon_loss: 4036865.0625; val_gene_expr_recon_loss: 11038530.7500; val_masked_gp_l1_reg_loss: 49107.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176900.9844; val_chrom_access_recon_loss: 5884482.6250; val_global_loss: 21270912.0000; val_optim_loss: 21270912.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8541; val_auprc_score: 0.8204; val_best_acc_score: 0.7818; val_best_f1_score: 0.8055; train_kl_reg_loss: 75916.1749; train_edge_recon_loss: 3483929.5758; train_gene_expr_recon_loss: 11050349.4545; train_masked_gp_l1_reg_loss: 50963.7978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142343.5182; train_chrom_access_recon_loss: 5751151.4167; train_global_loss: 20554653.9394; train_optim_loss: 20554653.9394; val_kl_reg_loss: 52042.2339; val_edge_recon_loss: 3531467.8125; val_gene_expr_recon_loss: 10998825.7500; val_masked_gp_l1_reg_loss: 53569.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115441.7031; val_chrom_access_recon_loss: 5798727.3750; val_global_loss: 20550074.2500; val_optim_loss: 20550074.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8422; val_auprc_score: 0.7996; val_best_acc_score: 0.7582; val_best_f1_score: 0.7970; train_kl_reg_loss: 69382.1795; train_edge_recon_loss: 3122736.3220; train_gene_expr_recon_loss: 11049233.3030; train_masked_gp_l1_reg_loss: 57505.3895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100183.5404; train_chrom_access_recon_loss: 5736445.4091; train_global_loss: 20135486.1212; train_optim_loss: 20135486.1212; val_kl_reg_loss: 90235.6758; val_edge_recon_loss: 2956702.0312; val_gene_expr_recon_loss: 10998533.7500; val_masked_gp_l1_reg_loss: 60030.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85489.0078; val_chrom_access_recon_loss: 5856709.5000; val_global_loss: 20047699.5000; val_optim_loss: 20047699.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8428; val_auprc_score: 0.8086; val_best_acc_score: 0.7595; val_best_f1_score: 0.7870; train_kl_reg_loss: 95441.2616; train_edge_recon_loss: 2961679.8485; train_gene_expr_recon_loss: 10937220.4394; train_masked_gp_l1_reg_loss: 60717.8352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74705.6635; train_chrom_access_recon_loss: 5691778.1818; train_global_loss: 19821543.2727; train_optim_loss: 19821543.2727; val_kl_reg_loss: 96326.0186; val_edge_recon_loss: 2993009.1875; val_gene_expr_recon_loss: 10959352.7500; val_masked_gp_l1_reg_loss: 61612.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65664.3828; val_chrom_access_recon_loss: 5789849.4375; val_global_loss: 19965814.5000; val_optim_loss: 19965814.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8582; val_auprc_score: 0.8349; val_best_acc_score: 0.7681; val_best_f1_score: 0.8018; train_kl_reg_loss: 93682.6042; train_edge_recon_loss: 2913466.5265; train_gene_expr_recon_loss: 10863798.5758; train_masked_gp_l1_reg_loss: 62638.0112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59136.1014; train_chrom_access_recon_loss: 5659652.3030; train_global_loss: 19652374.0606; train_optim_loss: 19652374.0606; val_kl_reg_loss: 93123.0713; val_edge_recon_loss: 2942673.5938; val_gene_expr_recon_loss: 10817851.8750; val_masked_gp_l1_reg_loss: 63636.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53241.7422; val_chrom_access_recon_loss: 5704565.1250; val_global_loss: 19675092.2500; val_optim_loss: 19675092.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8766; val_auprc_score: 0.8459; val_best_acc_score: 0.7953; val_best_f1_score: 0.8181; train_kl_reg_loss: 90677.9377; train_edge_recon_loss: 2882896.2538; train_gene_expr_recon_loss: 10818748.3333; train_masked_gp_l1_reg_loss: 64674.4099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49042.3022; train_chrom_access_recon_loss: 5634174.2273; train_global_loss: 19540213.3939; train_optim_loss: 19540213.3939; val_kl_reg_loss: 86353.8281; val_edge_recon_loss: 2896137.8438; val_gene_expr_recon_loss: 10841161.1250; val_masked_gp_l1_reg_loss: 65732.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45159.0547; val_chrom_access_recon_loss: 5810801.2500; val_global_loss: 19745345.2500; val_optim_loss: 19745345.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8901; val_auprc_score: 0.8579; val_best_acc_score: 0.8221; val_best_f1_score: 0.8398; train_kl_reg_loss: 88027.3758; train_edge_recon_loss: 2856291.7538; train_gene_expr_recon_loss: 10765516.8788; train_masked_gp_l1_reg_loss: 66635.5353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42296.6484; train_chrom_access_recon_loss: 5618592.5530; train_global_loss: 19437360.8182; train_optim_loss: 19437360.8182; val_kl_reg_loss: 93514.2539; val_edge_recon_loss: 2841607.3125; val_gene_expr_recon_loss: 10799315.5000; val_masked_gp_l1_reg_loss: 67643.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39821.1836; val_chrom_access_recon_loss: 5699401.5625; val_global_loss: 19541302.7500; val_optim_loss: 19541302.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9043; val_auprc_score: 0.8738; val_best_acc_score: 0.8332; val_best_f1_score: 0.8485; train_kl_reg_loss: 90320.4380; train_edge_recon_loss: 2816201.9621; train_gene_expr_recon_loss: 10717642.1667; train_masked_gp_l1_reg_loss: 68516.0632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38132.4134; train_chrom_access_recon_loss: 5587752.6439; train_global_loss: 19318565.6970; train_optim_loss: 19318565.6970; val_kl_reg_loss: 89498.1309; val_edge_recon_loss: 2827228.0312; val_gene_expr_recon_loss: 10687638.1250; val_masked_gp_l1_reg_loss: 69416.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36546.9414; val_chrom_access_recon_loss: 5695248.9375; val_global_loss: 19405576.2500; val_optim_loss: 19405576.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9062; val_auprc_score: 0.8735; val_best_acc_score: 0.8442; val_best_f1_score: 0.8563; train_kl_reg_loss: 90138.5098; train_edge_recon_loss: 2786514.8826; train_gene_expr_recon_loss: 10667983.6515; train_masked_gp_l1_reg_loss: 70310.3401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35290.6126; train_chrom_access_recon_loss: 5561870.1439; train_global_loss: 19212108.1818; train_optim_loss: 19212108.1818; val_kl_reg_loss: 87596.3535; val_edge_recon_loss: 2825703.8750; val_gene_expr_recon_loss: 10733656.0000; val_masked_gp_l1_reg_loss: 71231.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34130.0781; val_chrom_access_recon_loss: 5629478.6250; val_global_loss: 19381796.0000; val_optim_loss: 19381796.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9083; val_auprc_score: 0.8665; val_best_acc_score: 0.8512; val_best_f1_score: 0.8593; train_kl_reg_loss: 90337.8239; train_edge_recon_loss: 2781764.8068; train_gene_expr_recon_loss: 10635618.3939; train_masked_gp_l1_reg_loss: 71840.1636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33198.8523; train_chrom_access_recon_loss: 5547822.0530; train_global_loss: 19160581.8788; train_optim_loss: 19160581.8788; val_kl_reg_loss: 87928.8545; val_edge_recon_loss: 2831912.6562; val_gene_expr_recon_loss: 10651876.6250; val_masked_gp_l1_reg_loss: 72530.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32569.8340; val_chrom_access_recon_loss: 5673977.0625; val_global_loss: 19350795.0000; val_optim_loss: 19350795.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9193; val_auprc_score: 0.8884; val_best_acc_score: 0.8611; val_best_f1_score: 0.8707; train_kl_reg_loss: 90121.6340; train_edge_recon_loss: 2764962.8068; train_gene_expr_recon_loss: 10581733.9242; train_masked_gp_l1_reg_loss: 73253.2326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31953.7954; train_chrom_access_recon_loss: 5528989.0833; train_global_loss: 19071014.6061; train_optim_loss: 19071014.6061; val_kl_reg_loss: 90051.3936; val_edge_recon_loss: 2780010.5625; val_gene_expr_recon_loss: 10700976.8750; val_masked_gp_l1_reg_loss: 73985.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31675.3320; val_chrom_access_recon_loss: 5642613.0000; val_global_loss: 19319311.7500; val_optim_loss: 19319311.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9197; val_auprc_score: 0.8923; val_best_acc_score: 0.8600; val_best_f1_score: 0.8693; train_kl_reg_loss: 88460.6539; train_edge_recon_loss: 2764453.1742; train_gene_expr_recon_loss: 10528001.6061; train_masked_gp_l1_reg_loss: 74645.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30959.8990; train_chrom_access_recon_loss: 5504258.3712; train_global_loss: 18990779.3333; train_optim_loss: 18990779.3333; val_kl_reg_loss: 87961.1377; val_edge_recon_loss: 2807816.0938; val_gene_expr_recon_loss: 10583887.6250; val_masked_gp_l1_reg_loss: 75260.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30523.6758; val_chrom_access_recon_loss: 5615855.2500; val_global_loss: 19201305.0000; val_optim_loss: 19201305.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9273; val_auprc_score: 0.9007; val_best_acc_score: 0.8705; val_best_f1_score: 0.8783; train_kl_reg_loss: 86823.3477; train_edge_recon_loss: 2750687.5720; train_gene_expr_recon_loss: 10501886.8030; train_masked_gp_l1_reg_loss: 75818.9308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30258.9976; train_chrom_access_recon_loss: 5487455.8864; train_global_loss: 18932931.7273; train_optim_loss: 18932931.7273; val_kl_reg_loss: 86682.5068; val_edge_recon_loss: 2768130.4688; val_gene_expr_recon_loss: 10507941.1250; val_masked_gp_l1_reg_loss: 76523.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30027.2988; val_chrom_access_recon_loss: 5562433.1875; val_global_loss: 19031737.0000; val_optim_loss: 19031737.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9231; val_auprc_score: 0.8890; val_best_acc_score: 0.8673; val_best_f1_score: 0.8758; train_kl_reg_loss: 85112.0756; train_edge_recon_loss: 2751386.4545; train_gene_expr_recon_loss: 10466951.4697; train_masked_gp_l1_reg_loss: 76947.9678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29717.8997; train_chrom_access_recon_loss: 5469994.3258; train_global_loss: 18880110.2424; train_optim_loss: 18880110.2424; val_kl_reg_loss: 84587.8467; val_edge_recon_loss: 2772035.8750; val_gene_expr_recon_loss: 10433903.3750; val_masked_gp_l1_reg_loss: 77554.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29583.5508; val_chrom_access_recon_loss: 5527171.1875; val_global_loss: 18924837.2500; val_optim_loss: 18924837.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9344; val_auprc_score: 0.9102; val_best_acc_score: 0.8802; val_best_f1_score: 0.8860; train_kl_reg_loss: 84305.0069; train_edge_recon_loss: 2736123.5265; train_gene_expr_recon_loss: 10442214.4242; train_masked_gp_l1_reg_loss: 78047.7764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29241.2737; train_chrom_access_recon_loss: 5456317.3182; train_global_loss: 18826249.3333; train_optim_loss: 18826249.3333; val_kl_reg_loss: 84129.0850; val_edge_recon_loss: 2734104.6875; val_gene_expr_recon_loss: 10465820.1250; val_masked_gp_l1_reg_loss: 78576.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28926.7539; val_chrom_access_recon_loss: 5590297.2500; val_global_loss: 18981854.5000; val_optim_loss: 18981854.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9226; val_auprc_score: 0.8954; val_best_acc_score: 0.8678; val_best_f1_score: 0.8757; train_kl_reg_loss: 84738.3500; train_edge_recon_loss: 2724263.1402; train_gene_expr_recon_loss: 10407122.9545; train_masked_gp_l1_reg_loss: 78981.7805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28599.6094; train_chrom_access_recon_loss: 5439796.0530; train_global_loss: 18763501.8182; train_optim_loss: 18763501.8182; val_kl_reg_loss: 82969.0371; val_edge_recon_loss: 2795469.0000; val_gene_expr_recon_loss: 10589072.0000; val_masked_gp_l1_reg_loss: 79536.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28578.7109; val_chrom_access_recon_loss: 5600090.8125; val_global_loss: 19175716.0000; val_optim_loss: 19175716.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9308; val_auprc_score: 0.9092; val_best_acc_score: 0.8708; val_best_f1_score: 0.8796; train_kl_reg_loss: 82528.7643; train_edge_recon_loss: 2723208.2538; train_gene_expr_recon_loss: 10387689.5303; train_masked_gp_l1_reg_loss: 79989.2778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28287.9636; train_chrom_access_recon_loss: 5427660.5455; train_global_loss: 18729364.3030; train_optim_loss: 18729364.3030; val_kl_reg_loss: 82230.1748; val_edge_recon_loss: 2776701.0938; val_gene_expr_recon_loss: 10443638.5000; val_masked_gp_l1_reg_loss: 80519.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28181.3359; val_chrom_access_recon_loss: 5514769.1250; val_global_loss: 18926039.0000; val_optim_loss: 18926039.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9303; val_auprc_score: 0.9072; val_best_acc_score: 0.8721; val_best_f1_score: 0.8798; train_kl_reg_loss: 82873.8507; train_edge_recon_loss: 2722344.5568; train_gene_expr_recon_loss: 10358182.9091; train_masked_gp_l1_reg_loss: 80907.9638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27931.6406; train_chrom_access_recon_loss: 5404742.8788; train_global_loss: 18676983.8182; train_optim_loss: 18676983.8182; val_kl_reg_loss: 82325.6631; val_edge_recon_loss: 2754490.5938; val_gene_expr_recon_loss: 10328710.1250; val_masked_gp_l1_reg_loss: 81335.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27962.4766; val_chrom_access_recon_loss: 5495798.6250; val_global_loss: 18770623.0000; val_optim_loss: 18770623.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9338; val_auprc_score: 0.9055; val_best_acc_score: 0.8796; val_best_f1_score: 0.8841; train_kl_reg_loss: 80548.8063; train_edge_recon_loss: 2712107.7841; train_gene_expr_recon_loss: 10329486.1515; train_masked_gp_l1_reg_loss: 81697.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27700.3540; train_chrom_access_recon_loss: 5394441.7424; train_global_loss: 18625981.9697; train_optim_loss: 18625981.9697; val_kl_reg_loss: 81464.6934; val_edge_recon_loss: 2751415.0000; val_gene_expr_recon_loss: 10436105.2500; val_masked_gp_l1_reg_loss: 82096.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27724.8867; val_chrom_access_recon_loss: 5562263.1250; val_global_loss: 18941069.7500; val_optim_loss: 18941069.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9336; val_auprc_score: 0.9057; val_best_acc_score: 0.8831; val_best_f1_score: 0.8900; train_kl_reg_loss: 79190.0268; train_edge_recon_loss: 2716194.7083; train_gene_expr_recon_loss: 10307644.0000; train_masked_gp_l1_reg_loss: 82540.8935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27458.8095; train_chrom_access_recon_loss: 5380231.4545; train_global_loss: 18593259.8485; train_optim_loss: 18593259.8485; val_kl_reg_loss: 79520.6475; val_edge_recon_loss: 2750397.9062; val_gene_expr_recon_loss: 10400876.5000; val_masked_gp_l1_reg_loss: 83042.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27401.5293; val_chrom_access_recon_loss: 5513972.5000; val_global_loss: 18855212.5000; val_optim_loss: 18855212.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9390; val_auprc_score: 0.9121; val_best_acc_score: 0.8917; val_best_f1_score: 0.8976; train_kl_reg_loss: 78652.6544; train_edge_recon_loss: 2721295.4280; train_gene_expr_recon_loss: 10289568.8182; train_masked_gp_l1_reg_loss: 83338.2195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27268.9055; train_chrom_access_recon_loss: 5370009.9394; train_global_loss: 18570134.0303; train_optim_loss: 18570134.0303; val_kl_reg_loss: 76010.4092; val_edge_recon_loss: 2724289.2188; val_gene_expr_recon_loss: 10303702.5000; val_masked_gp_l1_reg_loss: 83755.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27053.9453; val_chrom_access_recon_loss: 5470453.5000; val_global_loss: 18685265.5000; val_optim_loss: 18685265.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9433; val_auprc_score: 0.9219; val_best_acc_score: 0.8909; val_best_f1_score: 0.8964; train_kl_reg_loss: 78136.7569; train_edge_recon_loss: 2711598.0000; train_gene_expr_recon_loss: 10260521.0909; train_masked_gp_l1_reg_loss: 84026.2640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26992.2384; train_chrom_access_recon_loss: 5351611.3864; train_global_loss: 18512885.7576; train_optim_loss: 18512885.7576; val_kl_reg_loss: 78467.3096; val_edge_recon_loss: 2741998.4688; val_gene_expr_recon_loss: 10303803.3750; val_masked_gp_l1_reg_loss: 84460.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26929.0898; val_chrom_access_recon_loss: 5477675.0625; val_global_loss: 18713333.7500; val_optim_loss: 18713333.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9530; val_auprc_score: 0.9399; val_best_acc_score: 0.8963; val_best_f1_score: 0.9020; train_kl_reg_loss: 77429.0688; train_edge_recon_loss: 2710109.1705; train_gene_expr_recon_loss: 10239436.3788; train_masked_gp_l1_reg_loss: 84709.8654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26802.9713; train_chrom_access_recon_loss: 5341842.1970; train_global_loss: 18480329.5758; train_optim_loss: 18480329.5758; val_kl_reg_loss: 77393.7236; val_edge_recon_loss: 2706910.5938; val_gene_expr_recon_loss: 10291861.0000; val_masked_gp_l1_reg_loss: 85078.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26724.6035; val_chrom_access_recon_loss: 5497155.3125; val_global_loss: 18685125.2500; val_optim_loss: 18685125.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9456; val_auprc_score: 0.9210; val_best_acc_score: 0.8952; val_best_f1_score: 0.8995; train_kl_reg_loss: 81800.8802; train_edge_recon_loss: 2732132.4621; train_gene_expr_recon_loss: 10086862.0303; train_masked_gp_l1_reg_loss: 84624.5891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23873.4175; train_chrom_access_recon_loss: 5286526.4318; train_global_loss: 18295819.6667; train_optim_loss: 18295819.6667; val_kl_reg_loss: 58534.1064; val_edge_recon_loss: 2746644.7188; val_gene_expr_recon_loss: 10157464.5000; val_masked_gp_l1_reg_loss: 84555.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23180.5000; val_chrom_access_recon_loss: 5363723.5000; val_global_loss: 18434103.7500; val_optim_loss: 18434103.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9467; val_auprc_score: 0.9243; val_best_acc_score: 0.8958; val_best_f1_score: 0.8997; train_kl_reg_loss: 82170.5911; train_edge_recon_loss: 2716324.2992; train_gene_expr_recon_loss: 10047137.2879; train_masked_gp_l1_reg_loss: 84775.2048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23062.7627; train_chrom_access_recon_loss: 5237417.3258; train_global_loss: 18190887.4848; train_optim_loss: 18190887.4848; val_kl_reg_loss: 60482.3750; val_edge_recon_loss: 2753661.3750; val_gene_expr_recon_loss: 10022383.6250; val_masked_gp_l1_reg_loss: 84967.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23024.2402; val_chrom_access_recon_loss: 5335144.4375; val_global_loss: 18279663.7500; val_optim_loss: 18279663.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9448; val_auprc_score: 0.9242; val_best_acc_score: 0.8907; val_best_f1_score: 0.8969; train_kl_reg_loss: 78758.3507; train_edge_recon_loss: 2710793.5871; train_gene_expr_recon_loss: 10020561.5455; train_masked_gp_l1_reg_loss: 85154.4853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23001.2247; train_chrom_access_recon_loss: 5226481.7348; train_global_loss: 18144750.7879; train_optim_loss: 18144750.7879; val_kl_reg_loss: 61485.1392; val_edge_recon_loss: 2756389.7812; val_gene_expr_recon_loss: 10138544.5000; val_masked_gp_l1_reg_loss: 85389.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22922.3594; val_chrom_access_recon_loss: 5328485.7500; val_global_loss: 18393215.7500; val_optim_loss: 18393215.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9549; val_auprc_score: 0.9377; val_best_acc_score: 0.9041; val_best_f1_score: 0.9077; train_kl_reg_loss: 75808.0902; train_edge_recon_loss: 2704633.4659; train_gene_expr_recon_loss: 10007285.4848; train_masked_gp_l1_reg_loss: 85541.2723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22871.2690; train_chrom_access_recon_loss: 5218357.8636; train_global_loss: 18114497.3939; train_optim_loss: 18114497.3939; val_kl_reg_loss: 60435.2061; val_edge_recon_loss: 2726243.8125; val_gene_expr_recon_loss: 10050662.5000; val_masked_gp_l1_reg_loss: 85882.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22866.9062; val_chrom_access_recon_loss: 5312577.8750; val_global_loss: 18258669.2500; val_optim_loss: 18258669.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9451; val_auprc_score: 0.9247; val_best_acc_score: 0.8898; val_best_f1_score: 0.8948; train_kl_reg_loss: 75167.0453; train_edge_recon_loss: 2692253.8409; train_gene_expr_recon_loss: 9983203.0606; train_masked_gp_l1_reg_loss: 85910.3628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22792.8300; train_chrom_access_recon_loss: 5202536.1591; train_global_loss: 18061863.0606; train_optim_loss: 18061863.0606; val_kl_reg_loss: 63126.9443; val_edge_recon_loss: 2740347.0000; val_gene_expr_recon_loss: 10146361.8750; val_masked_gp_l1_reg_loss: 86052.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22737.5586; val_chrom_access_recon_loss: 5359195.5000; val_global_loss: 18417822.5000; val_optim_loss: 18417822.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9481; val_auprc_score: 0.9283; val_best_acc_score: 0.8931; val_best_f1_score: 0.8976; train_kl_reg_loss: 72557.3305; train_edge_recon_loss: 2694134.8939; train_gene_expr_recon_loss: 9968518.7424; train_masked_gp_l1_reg_loss: 86277.3440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22678.1553; train_chrom_access_recon_loss: 5194156.0833; train_global_loss: 18038322.7879; train_optim_loss: 18038322.7879; val_kl_reg_loss: 64993.8232; val_edge_recon_loss: 2756199.9375; val_gene_expr_recon_loss: 9991559.3750; val_masked_gp_l1_reg_loss: 86476.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22671.0469; val_chrom_access_recon_loss: 5290914.6875; val_global_loss: 18212816.2500; val_optim_loss: 18212816.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9527; val_auprc_score: 0.9363; val_best_acc_score: 0.8979; val_best_f1_score: 0.9021; train_kl_reg_loss: 71603.2991; train_edge_recon_loss: 2698594.7917; train_gene_expr_recon_loss: 9958025.1515; train_masked_gp_l1_reg_loss: 86617.5681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22589.9781; train_chrom_access_recon_loss: 5186205.9848; train_global_loss: 18023636.6667; train_optim_loss: 18023636.6667; val_kl_reg_loss: 65940.8936; val_edge_recon_loss: 2719150.2500; val_gene_expr_recon_loss: 9928253.1250; val_masked_gp_l1_reg_loss: 86730.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22542.5840; val_chrom_access_recon_loss: 5262302.7500; val_global_loss: 18084921.0000; val_optim_loss: 18084921.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9483; val_auprc_score: 0.9244; val_best_acc_score: 0.8971; val_best_f1_score: 0.9006; train_kl_reg_loss: 69800.0524; train_edge_recon_loss: 2690769.1894; train_gene_expr_recon_loss: 9934002.1818; train_masked_gp_l1_reg_loss: 87021.0687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22539.6433; train_chrom_access_recon_loss: 5179266.2652; train_global_loss: 17983398.3030; train_optim_loss: 17983398.3030; val_kl_reg_loss: 66267.9341; val_edge_recon_loss: 2726857.3438; val_gene_expr_recon_loss: 10055014.3750; val_masked_gp_l1_reg_loss: 87205.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22436.5195; val_chrom_access_recon_loss: 5334608.1875; val_global_loss: 18292390.7500; val_optim_loss: 18292390.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9565; val_auprc_score: 0.9348; val_best_acc_score: 0.9060; val_best_f1_score: 0.9106; train_kl_reg_loss: 69608.6437; train_edge_recon_loss: 2680498.6667; train_gene_expr_recon_loss: 9923590.4697; train_masked_gp_l1_reg_loss: 87363.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22432.8995; train_chrom_access_recon_loss: 5173416.1364; train_global_loss: 17956910.2424; train_optim_loss: 17956910.2424; val_kl_reg_loss: 65311.3164; val_edge_recon_loss: 2693781.3750; val_gene_expr_recon_loss: 9921353.0000; val_masked_gp_l1_reg_loss: 87671.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22416.8008; val_chrom_access_recon_loss: 5267056.0000; val_global_loss: 18057590.7500; val_optim_loss: 18057590.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9535; val_auprc_score: 0.9370; val_best_acc_score: 0.8966; val_best_f1_score: 0.9015; train_kl_reg_loss: 68579.2248; train_edge_recon_loss: 2686495.8902; train_gene_expr_recon_loss: 9912462.8485; train_masked_gp_l1_reg_loss: 87798.7573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22391.1543; train_chrom_access_recon_loss: 5165931.6591; train_global_loss: 17943659.4848; train_optim_loss: 17943659.4848; val_kl_reg_loss: 64892.5771; val_edge_recon_loss: 2744835.8125; val_gene_expr_recon_loss: 9921123.2500; val_masked_gp_l1_reg_loss: 87959.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22326.7520; val_chrom_access_recon_loss: 5286797.7500; val_global_loss: 18127935.7500; val_optim_loss: 18127935.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9539; val_auprc_score: 0.9312; val_best_acc_score: 0.9057; val_best_f1_score: 0.9097; train_kl_reg_loss: 68053.5392; train_edge_recon_loss: 2679083.3447; train_gene_expr_recon_loss: 9899392.8636; train_masked_gp_l1_reg_loss: 88140.4223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22290.2159; train_chrom_access_recon_loss: 5154646.6212; train_global_loss: 17911607.0000; train_optim_loss: 17911607.0000; val_kl_reg_loss: 63819.0933; val_edge_recon_loss: 2676314.1875; val_gene_expr_recon_loss: 9829339.7500; val_masked_gp_l1_reg_loss: 88277.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22348.9785; val_chrom_access_recon_loss: 5206269.7500; val_global_loss: 17886369.3750; val_optim_loss: 17886369.3750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9567; val_auprc_score: 0.9340; val_best_acc_score: 0.9095; val_best_f1_score: 0.9119; train_kl_reg_loss: 67409.7886; train_edge_recon_loss: 2684225.7917; train_gene_expr_recon_loss: 9884029.5152; train_masked_gp_l1_reg_loss: 88526.9798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22282.9367; train_chrom_access_recon_loss: 5154487.9621; train_global_loss: 17900963.0303; train_optim_loss: 17900963.0303; val_kl_reg_loss: 62518.1768; val_edge_recon_loss: 2703308.7812; val_gene_expr_recon_loss: 9880410.2500; val_masked_gp_l1_reg_loss: 88769.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22280.5918; val_chrom_access_recon_loss: 5254184.0000; val_global_loss: 18011471.0000; val_optim_loss: 18011471.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9611; val_auprc_score: 0.9464; val_best_acc_score: 0.9089; val_best_f1_score: 0.9108; train_kl_reg_loss: 66352.3697; train_edge_recon_loss: 2684696.9508; train_gene_expr_recon_loss: 9877699.3333; train_masked_gp_l1_reg_loss: 88949.7638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22249.8006; train_chrom_access_recon_loss: 5143678.0758; train_global_loss: 17883626.4697; train_optim_loss: 17883626.4697; val_kl_reg_loss: 64339.6597; val_edge_recon_loss: 2677819.5625; val_gene_expr_recon_loss: 9889996.6250; val_masked_gp_l1_reg_loss: 89119.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22177.8594; val_chrom_access_recon_loss: 5212709.5000; val_global_loss: 17956163.0000; val_optim_loss: 17956163.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9566; val_auprc_score: 0.9402; val_best_acc_score: 0.9057; val_best_f1_score: 0.9091; train_kl_reg_loss: 66218.9545; train_edge_recon_loss: 2688388.8902; train_gene_expr_recon_loss: 9858372.3788; train_masked_gp_l1_reg_loss: 89343.0603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22195.0202; train_chrom_access_recon_loss: 5139528.9545; train_global_loss: 17864047.2424; train_optim_loss: 17864047.2424; val_kl_reg_loss: 62535.5171; val_edge_recon_loss: 2717592.5000; val_gene_expr_recon_loss: 9885810.5000; val_masked_gp_l1_reg_loss: 89552.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22212.6484; val_chrom_access_recon_loss: 5258922.9375; val_global_loss: 18036627.2500; val_optim_loss: 18036627.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9576; val_auprc_score: 0.9375; val_best_acc_score: 0.9100; val_best_f1_score: 0.9129; train_kl_reg_loss: 64853.8563; train_edge_recon_loss: 2679913.5720; train_gene_expr_recon_loss: 9850458.0455; train_masked_gp_l1_reg_loss: 89742.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22200.9692; train_chrom_access_recon_loss: 5125443.7348; train_global_loss: 17832613.1515; train_optim_loss: 17832613.1515; val_kl_reg_loss: 64850.5181; val_edge_recon_loss: 2703481.7188; val_gene_expr_recon_loss: 9922083.1250; val_masked_gp_l1_reg_loss: 89952.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22183.6797; val_chrom_access_recon_loss: 5270316.3125; val_global_loss: 18072869.0000; val_optim_loss: 18072869.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9557; val_auprc_score: 0.9364; val_best_acc_score: 0.9033; val_best_f1_score: 0.9079; train_kl_reg_loss: 65931.6567; train_edge_recon_loss: 2683990.3144; train_gene_expr_recon_loss: 9817226.9394; train_masked_gp_l1_reg_loss: 89363.6941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20547.7913; train_chrom_access_recon_loss: 5108672.5076; train_global_loss: 17785732.8485; train_optim_loss: 17785732.8485; val_kl_reg_loss: 65959.9746; val_edge_recon_loss: 2727066.8125; val_gene_expr_recon_loss: 9981509.1250; val_masked_gp_l1_reg_loss: 89073.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20123.2168; val_chrom_access_recon_loss: 5264428.1875; val_global_loss: 18148160.2500; val_optim_loss: 18148160.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9590; val_auprc_score: 0.9424; val_best_acc_score: 0.9087; val_best_f1_score: 0.9124; train_kl_reg_loss: 67146.1587; train_edge_recon_loss: 2676999.2235; train_gene_expr_recon_loss: 9820670.4697; train_masked_gp_l1_reg_loss: 88993.4181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20018.6741; train_chrom_access_recon_loss: 5109076.8030; train_global_loss: 17782904.7273; train_optim_loss: 17782904.7273; val_kl_reg_loss: 66092.9785; val_edge_recon_loss: 2709630.4375; val_gene_expr_recon_loss: 9851242.1250; val_masked_gp_l1_reg_loss: 88945.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19939.4688; val_chrom_access_recon_loss: 5194420.9375; val_global_loss: 17930271.5000; val_optim_loss: 17930271.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9593; val_auprc_score: 0.9426; val_best_acc_score: 0.9087; val_best_f1_score: 0.9121; train_kl_reg_loss: 66969.9036; train_edge_recon_loss: 2683245.0985; train_gene_expr_recon_loss: 9815374.3788; train_masked_gp_l1_reg_loss: 88929.0759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19892.2224; train_chrom_access_recon_loss: 5107124.4242; train_global_loss: 17781535.0606; train_optim_loss: 17781535.0606; val_kl_reg_loss: 66031.1143; val_edge_recon_loss: 2687567.7812; val_gene_expr_recon_loss: 9962314.1250; val_masked_gp_l1_reg_loss: 88911.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19837.8828; val_chrom_access_recon_loss: 5264140.8750; val_global_loss: 18088802.5000; val_optim_loss: 18088802.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9624; val_auprc_score: 0.9495; val_best_acc_score: 0.9113; val_best_f1_score: 0.9145; train_kl_reg_loss: 66897.6892; train_edge_recon_loss: 2675217.7197; train_gene_expr_recon_loss: 9811612.4242; train_masked_gp_l1_reg_loss: 88916.9701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19806.6555; train_chrom_access_recon_loss: 5106505.4318; train_global_loss: 17768956.9091; train_optim_loss: 17768956.9091; val_kl_reg_loss: 65295.9341; val_edge_recon_loss: 2687984.5000; val_gene_expr_recon_loss: 9964733.3750; val_masked_gp_l1_reg_loss: 88924.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19770.3926; val_chrom_access_recon_loss: 5240102.3750; val_global_loss: 18066810.5000; val_optim_loss: 18066810.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 39 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9568
val AUPRC score: 0.9380
val best accuracy score: 0.9006
val best F1 score: 0.9058
val target rna MSE score: 1.3101
val source rna MSE score: 0.4128
val target atac MSE score: 0.3332
val source atac MSE score: 0.0734
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
