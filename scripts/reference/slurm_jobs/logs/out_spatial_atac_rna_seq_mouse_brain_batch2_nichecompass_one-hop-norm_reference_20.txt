[True]
Run timestamp: 09102023_195819_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6854; val_auprc_score: 0.6682; val_best_acc_score: 0.5723; val_best_f1_score: 0.6910; train_kl_reg_loss: 55765.9211; train_edge_recon_loss: 3513155.9167; train_gene_expr_recon_loss: 13838643.4091; train_masked_gp_l1_reg_loss: 97811.5230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2894449.7008; train_chrom_access_recon_loss: 992446.5956; train_global_loss: 21392272.9394; train_optim_loss: 21392272.9394; val_kl_reg_loss: 108361.9961; val_edge_recon_loss: 4061207.5938; val_gene_expr_recon_loss: 12919069.3750; val_masked_gp_l1_reg_loss: 80457.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1529519.8750; val_chrom_access_recon_loss: 954048.2734; val_global_loss: 19652665.5000; val_optim_loss: 19652665.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7116; val_auprc_score: 0.6904; val_best_acc_score: 0.6542; val_best_f1_score: 0.7024; train_kl_reg_loss: 93521.7736; train_edge_recon_loss: 3520490.9508; train_gene_expr_recon_loss: 12783687.7879; train_masked_gp_l1_reg_loss: 76627.6667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 798745.0587; train_chrom_access_recon_loss: 945037.6487; train_global_loss: 18218111.0303; train_optim_loss: 18218111.0303; val_kl_reg_loss: 95985.4492; val_edge_recon_loss: 4050496.0312; val_gene_expr_recon_loss: 12860059.2500; val_masked_gp_l1_reg_loss: 75604.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 367598.6562; val_chrom_access_recon_loss: 952870.8906; val_global_loss: 18402614.0000; val_optim_loss: 18402614.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7723; val_auprc_score: 0.7551; val_best_acc_score: 0.6945; val_best_f1_score: 0.7359; train_kl_reg_loss: 81679.8284; train_edge_recon_loss: 3504584.5606; train_gene_expr_recon_loss: 12652172.0455; train_masked_gp_l1_reg_loss: 76152.5726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244981.2434; train_chrom_access_recon_loss: 937385.7708; train_global_loss: 17496956.0000; train_optim_loss: 17496956.0000; val_kl_reg_loss: 77980.9453; val_edge_recon_loss: 3863691.4375; val_gene_expr_recon_loss: 12715823.7500; val_masked_gp_l1_reg_loss: 77994.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167266.6875; val_chrom_access_recon_loss: 940315.4453; val_global_loss: 17843072.0000; val_optim_loss: 17843072.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7648; val_auprc_score: 0.7688; val_best_acc_score: 0.6883; val_best_f1_score: 0.7247; train_kl_reg_loss: 66511.6692; train_edge_recon_loss: 3267485.3068; train_gene_expr_recon_loss: 12589291.1818; train_masked_gp_l1_reg_loss: 80564.7647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134119.6003; train_chrom_access_recon_loss: 933097.1894; train_global_loss: 17071069.8182; train_optim_loss: 17071069.8182; val_kl_reg_loss: 103746.7451; val_edge_recon_loss: 3365659.8125; val_gene_expr_recon_loss: 12850453.3750; val_masked_gp_l1_reg_loss: 83235.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111317.9141; val_chrom_access_recon_loss: 938099.3672; val_global_loss: 17452512.7500; val_optim_loss: 17452512.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8174; val_auprc_score: 0.8107; val_best_acc_score: 0.7343; val_best_f1_score: 0.7502; train_kl_reg_loss: 86327.7725; train_edge_recon_loss: 3068255.7348; train_gene_expr_recon_loss: 12551694.9545; train_masked_gp_l1_reg_loss: 84516.2237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101910.6548; train_chrom_access_recon_loss: 928919.0076; train_global_loss: 16821624.3333; train_optim_loss: 16821624.3333; val_kl_reg_loss: 80143.2793; val_edge_recon_loss: 3084810.5938; val_gene_expr_recon_loss: 12664129.7500; val_masked_gp_l1_reg_loss: 85776.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93406.1641; val_chrom_access_recon_loss: 938338.1484; val_global_loss: 16946603.8750; val_optim_loss: 16946603.8750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8743; val_auprc_score: 0.8528; val_best_acc_score: 0.8015; val_best_f1_score: 0.8182; train_kl_reg_loss: 87683.5814; train_edge_recon_loss: 2970846.6818; train_gene_expr_recon_loss: 12437937.2273; train_masked_gp_l1_reg_loss: 87603.8110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90161.2165; train_chrom_access_recon_loss: 924577.1335; train_global_loss: 16598809.6364; train_optim_loss: 16598809.6364; val_kl_reg_loss: 88310.1406; val_edge_recon_loss: 2936673.2500; val_gene_expr_recon_loss: 12476819.5000; val_masked_gp_l1_reg_loss: 89645.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85380.6797; val_chrom_access_recon_loss: 924507.5938; val_global_loss: 16601337.3750; val_optim_loss: 16601337.3750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8989; val_auprc_score: 0.8709; val_best_acc_score: 0.8375; val_best_f1_score: 0.8462; train_kl_reg_loss: 94847.8758; train_edge_recon_loss: 2841148.4508; train_gene_expr_recon_loss: 12357675.7273; train_masked_gp_l1_reg_loss: 91313.9411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82461.9828; train_chrom_access_recon_loss: 919446.3532; train_global_loss: 16386894.1364; train_optim_loss: 16386894.1364; val_kl_reg_loss: 96807.7832; val_edge_recon_loss: 2868523.9375; val_gene_expr_recon_loss: 12434820.6250; val_masked_gp_l1_reg_loss: 92606.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80433.8125; val_chrom_access_recon_loss: 933805.2031; val_global_loss: 16506997.3750; val_optim_loss: 16506997.3750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9046; val_auprc_score: 0.8802; val_best_acc_score: 0.8426; val_best_f1_score: 0.8531; train_kl_reg_loss: 96577.4653; train_edge_recon_loss: 2826094.0152; train_gene_expr_recon_loss: 12288083.8485; train_masked_gp_l1_reg_loss: 93384.9110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77680.3200; train_chrom_access_recon_loss: 914269.3892; train_global_loss: 16296089.8636; train_optim_loss: 16296089.8636; val_kl_reg_loss: 93466.7285; val_edge_recon_loss: 2859167.6875; val_gene_expr_recon_loss: 12292078.0000; val_masked_gp_l1_reg_loss: 94591.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75863.6641; val_chrom_access_recon_loss: 914386.5078; val_global_loss: 16329553.8750; val_optim_loss: 16329553.8750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9043; val_auprc_score: 0.8773; val_best_acc_score: 0.8461; val_best_f1_score: 0.8537; train_kl_reg_loss: 93888.6003; train_edge_recon_loss: 2815900.0985; train_gene_expr_recon_loss: 12234455.7273; train_masked_gp_l1_reg_loss: 95328.9361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73493.5116; train_chrom_access_recon_loss: 910947.8854; train_global_loss: 16224014.8333; train_optim_loss: 16224014.8333; val_kl_reg_loss: 92898.7051; val_edge_recon_loss: 2858080.4688; val_gene_expr_recon_loss: 12336489.7500; val_masked_gp_l1_reg_loss: 96054.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71753.0781; val_chrom_access_recon_loss: 917940.2344; val_global_loss: 16373216.2500; val_optim_loss: 16373216.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9112; val_auprc_score: 0.8872; val_best_acc_score: 0.8514; val_best_f1_score: 0.8601; train_kl_reg_loss: 94482.8376; train_edge_recon_loss: 2805078.3371; train_gene_expr_recon_loss: 12179346.9394; train_masked_gp_l1_reg_loss: 96674.1826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70397.0874; train_chrom_access_recon_loss: 907248.6998; train_global_loss: 16153228.0455; train_optim_loss: 16153228.0455; val_kl_reg_loss: 97386.4922; val_edge_recon_loss: 2799390.2500; val_gene_expr_recon_loss: 12161373.2500; val_masked_gp_l1_reg_loss: 97166.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69301.9141; val_chrom_access_recon_loss: 903653.6016; val_global_loss: 16128271.6250; val_optim_loss: 16128271.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9090; val_auprc_score: 0.8766; val_best_acc_score: 0.8528; val_best_f1_score: 0.8615; train_kl_reg_loss: 92983.6903; train_edge_recon_loss: 2798525.6212; train_gene_expr_recon_loss: 12142958.6515; train_masked_gp_l1_reg_loss: 97751.5766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68298.5988; train_chrom_access_recon_loss: 904421.6288; train_global_loss: 16104939.7273; train_optim_loss: 16104939.7273; val_kl_reg_loss: 90926.2266; val_edge_recon_loss: 2825754.2812; val_gene_expr_recon_loss: 12099847.7500; val_masked_gp_l1_reg_loss: 98391.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67548.4297; val_chrom_access_recon_loss: 907479.3281; val_global_loss: 16089947.5000; val_optim_loss: 16089947.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9108; val_auprc_score: 0.8825; val_best_acc_score: 0.8490; val_best_f1_score: 0.8603; train_kl_reg_loss: 92067.2455; train_edge_recon_loss: 2784149.0303; train_gene_expr_recon_loss: 12098748.0000; train_masked_gp_l1_reg_loss: 98992.0348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66866.1777; train_chrom_access_recon_loss: 902157.3655; train_global_loss: 16042979.8182; train_optim_loss: 16042979.8182; val_kl_reg_loss: 91133.5986; val_edge_recon_loss: 2818284.4062; val_gene_expr_recon_loss: 12116811.7500; val_masked_gp_l1_reg_loss: 99578.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66583.8516; val_chrom_access_recon_loss: 910492.2891; val_global_loss: 16102884.1250; val_optim_loss: 16102884.1250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9129; val_auprc_score: 0.8917; val_best_acc_score: 0.8538; val_best_f1_score: 0.8635; train_kl_reg_loss: 90719.5236; train_edge_recon_loss: 2783528.1780; train_gene_expr_recon_loss: 12051977.9394; train_masked_gp_l1_reg_loss: 100146.6237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65791.8568; train_chrom_access_recon_loss: 898384.3712; train_global_loss: 15990548.3939; train_optim_loss: 15990548.3939; val_kl_reg_loss: 88790.5479; val_edge_recon_loss: 2827075.0000; val_gene_expr_recon_loss: 12127389.7500; val_masked_gp_l1_reg_loss: 100654.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65299.6406; val_chrom_access_recon_loss: 910764.6406; val_global_loss: 16119974.8750; val_optim_loss: 16119974.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9212; val_auprc_score: 0.8928; val_best_acc_score: 0.8697; val_best_f1_score: 0.8780; train_kl_reg_loss: 86613.9038; train_edge_recon_loss: 2776265.5152; train_gene_expr_recon_loss: 12004952.5152; train_masked_gp_l1_reg_loss: 101108.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64687.7747; train_chrom_access_recon_loss: 895196.6004; train_global_loss: 15928824.9848; train_optim_loss: 15928824.9848; val_kl_reg_loss: 87623.0830; val_edge_recon_loss: 2785907.0312; val_gene_expr_recon_loss: 12126857.8750; val_masked_gp_l1_reg_loss: 101874.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63769.3438; val_chrom_access_recon_loss: 905760.3125; val_global_loss: 16071792.1250; val_optim_loss: 16071792.1250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9216; val_auprc_score: 0.8970; val_best_acc_score: 0.8627; val_best_f1_score: 0.8724; train_kl_reg_loss: 84318.5329; train_edge_recon_loss: 2773557.2462; train_gene_expr_recon_loss: 11966686.0909; train_masked_gp_l1_reg_loss: 102214.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63424.1964; train_chrom_access_recon_loss: 892882.9186; train_global_loss: 15883084.1061; train_optim_loss: 15883084.1061; val_kl_reg_loss: 85952.4814; val_edge_recon_loss: 2793833.4375; val_gene_expr_recon_loss: 12150343.3750; val_masked_gp_l1_reg_loss: 103113.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63073.8711; val_chrom_access_recon_loss: 905091.8828; val_global_loss: 16101407.7500; val_optim_loss: 16101407.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9242; val_auprc_score: 0.9037; val_best_acc_score: 0.8641; val_best_f1_score: 0.8723; train_kl_reg_loss: 85239.5639; train_edge_recon_loss: 2772071.6288; train_gene_expr_recon_loss: 11949664.7576; train_masked_gp_l1_reg_loss: 103198.4438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62664.1975; train_chrom_access_recon_loss: 891672.4091; train_global_loss: 15864511.0152; train_optim_loss: 15864511.0152; val_kl_reg_loss: 86221.5654; val_edge_recon_loss: 2775049.8750; val_gene_expr_recon_loss: 11997115.8750; val_masked_gp_l1_reg_loss: 103597.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62493.7070; val_chrom_access_recon_loss: 890046.2188; val_global_loss: 15914525.5000; val_optim_loss: 15914525.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9200; val_auprc_score: 0.8977; val_best_acc_score: 0.8595; val_best_f1_score: 0.8678; train_kl_reg_loss: 85432.3486; train_edge_recon_loss: 2751459.5606; train_gene_expr_recon_loss: 11911400.2576; train_masked_gp_l1_reg_loss: 103954.1967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62403.0060; train_chrom_access_recon_loss: 888022.0322; train_global_loss: 15802671.4242; train_optim_loss: 15802671.4242; val_kl_reg_loss: 83026.0186; val_edge_recon_loss: 2822241.9688; val_gene_expr_recon_loss: 11943764.6250; val_masked_gp_l1_reg_loss: 104362.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62038.7695; val_chrom_access_recon_loss: 890113.0391; val_global_loss: 15905546.5000; val_optim_loss: 15905546.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9239; val_auprc_score: 0.9001; val_best_acc_score: 0.8692; val_best_f1_score: 0.8776; train_kl_reg_loss: 83572.0928; train_edge_recon_loss: 2756648.6364; train_gene_expr_recon_loss: 11876847.2576; train_masked_gp_l1_reg_loss: 104725.5516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61855.5936; train_chrom_access_recon_loss: 886195.2784; train_global_loss: 15769844.4394; train_optim_loss: 15769844.4394; val_kl_reg_loss: 82839.8750; val_edge_recon_loss: 2772351.4688; val_gene_expr_recon_loss: 11992618.8750; val_masked_gp_l1_reg_loss: 105211.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61570.9492; val_chrom_access_recon_loss: 895107.2969; val_global_loss: 15909699.5000; val_optim_loss: 15909699.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9276; val_auprc_score: 0.9003; val_best_acc_score: 0.8721; val_best_f1_score: 0.8801; train_kl_reg_loss: 84134.7264; train_edge_recon_loss: 2745230.9432; train_gene_expr_recon_loss: 11854829.2121; train_masked_gp_l1_reg_loss: 105402.8487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61458.4055; train_chrom_access_recon_loss: 884740.8163; train_global_loss: 15735797.0152; train_optim_loss: 15735797.0152; val_kl_reg_loss: 82050.2646; val_edge_recon_loss: 2756556.2500; val_gene_expr_recon_loss: 11816090.7500; val_masked_gp_l1_reg_loss: 106030.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61584.9180; val_chrom_access_recon_loss: 886530.6016; val_global_loss: 15708844.1250; val_optim_loss: 15708844.1250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9296; val_auprc_score: 0.9061; val_best_acc_score: 0.8737; val_best_f1_score: 0.8822; train_kl_reg_loss: 82495.7411; train_edge_recon_loss: 2741295.9545; train_gene_expr_recon_loss: 11826731.0909; train_masked_gp_l1_reg_loss: 106111.3459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60939.1491; train_chrom_access_recon_loss: 882427.0606; train_global_loss: 15700000.3636; train_optim_loss: 15700000.3636; val_kl_reg_loss: 80390.7705; val_edge_recon_loss: 2768930.2188; val_gene_expr_recon_loss: 11963772.7500; val_masked_gp_l1_reg_loss: 106539.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60800.5195; val_chrom_access_recon_loss: 888347.8047; val_global_loss: 15868781.5000; val_optim_loss: 15868781.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9346; val_auprc_score: 0.9151; val_best_acc_score: 0.8837; val_best_f1_score: 0.8908; train_kl_reg_loss: 82716.2192; train_edge_recon_loss: 2741003.8144; train_gene_expr_recon_loss: 11796386.1970; train_masked_gp_l1_reg_loss: 106702.1452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60596.1415; train_chrom_access_recon_loss: 879652.2718; train_global_loss: 15667056.8030; train_optim_loss: 15667056.8030; val_kl_reg_loss: 79474.5146; val_edge_recon_loss: 2760510.9375; val_gene_expr_recon_loss: 11835348.5000; val_masked_gp_l1_reg_loss: 107063.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60403.1797; val_chrom_access_recon_loss: 882946.8203; val_global_loss: 15725746.6250; val_optim_loss: 15725746.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9276; val_auprc_score: 0.9035; val_best_acc_score: 0.8705; val_best_f1_score: 0.8799; train_kl_reg_loss: 83054.2140; train_edge_recon_loss: 2732960.0871; train_gene_expr_recon_loss: 11772670.8333; train_masked_gp_l1_reg_loss: 107273.1396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60226.9742; train_chrom_access_recon_loss: 877370.3078; train_global_loss: 15633555.4091; train_optim_loss: 15633555.4091; val_kl_reg_loss: 81583.4287; val_edge_recon_loss: 2781726.5000; val_gene_expr_recon_loss: 11767095.8750; val_masked_gp_l1_reg_loss: 107582.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59923.3047; val_chrom_access_recon_loss: 879757.0625; val_global_loss: 15677668.8750; val_optim_loss: 15677668.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9401; val_auprc_score: 0.9162; val_best_acc_score: 0.8877; val_best_f1_score: 0.8938; train_kl_reg_loss: 81586.5220; train_edge_recon_loss: 2725275.7614; train_gene_expr_recon_loss: 11753911.1212; train_masked_gp_l1_reg_loss: 107682.9619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59633.5009; train_chrom_access_recon_loss: 876864.6297; train_global_loss: 15604954.4848; train_optim_loss: 15604954.4848; val_kl_reg_loss: 84149.7373; val_edge_recon_loss: 2739591.2188; val_gene_expr_recon_loss: 11809977.1250; val_masked_gp_l1_reg_loss: 107913.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59618.2539; val_chrom_access_recon_loss: 872703.3516; val_global_loss: 15673953.3750; val_optim_loss: 15673953.3750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9391; val_auprc_score: 0.9142; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 82135.1476; train_edge_recon_loss: 2719152.7992; train_gene_expr_recon_loss: 11737994.2727; train_masked_gp_l1_reg_loss: 108020.7154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59253.5333; train_chrom_access_recon_loss: 875465.8873; train_global_loss: 15582022.3182; train_optim_loss: 15582022.3182; val_kl_reg_loss: 80797.7246; val_edge_recon_loss: 2775490.8438; val_gene_expr_recon_loss: 11747725.3750; val_masked_gp_l1_reg_loss: 108260.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59532.2734; val_chrom_access_recon_loss: 875971.2109; val_global_loss: 15647778.1250; val_optim_loss: 15647778.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9446; val_auprc_score: 0.9273; val_best_acc_score: 0.8949; val_best_f1_score: 0.8986; train_kl_reg_loss: 82126.4805; train_edge_recon_loss: 2721364.1667; train_gene_expr_recon_loss: 11717271.8182; train_masked_gp_l1_reg_loss: 108319.8325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58867.5421; train_chrom_access_recon_loss: 873825.6619; train_global_loss: 15561775.4394; train_optim_loss: 15561775.4394; val_kl_reg_loss: 81310.8447; val_edge_recon_loss: 2737607.4688; val_gene_expr_recon_loss: 11773676.1250; val_masked_gp_l1_reg_loss: 108436.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58567.5000; val_chrom_access_recon_loss: 876634.3359; val_global_loss: 15636233.0000; val_optim_loss: 15636233.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9376; val_auprc_score: 0.9117; val_best_acc_score: 0.8864; val_best_f1_score: 0.8929; train_kl_reg_loss: 99878.7086; train_edge_recon_loss: 2786186.1212; train_gene_expr_recon_loss: 11081767.2424; train_masked_gp_l1_reg_loss: 108448.0611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53284.2982; train_chrom_access_recon_loss: 843944.0795; train_global_loss: 14973508.7273; train_optim_loss: 14973508.7273; val_kl_reg_loss: 42772.6143; val_edge_recon_loss: 2776028.5625; val_gene_expr_recon_loss: 11152492.1250; val_masked_gp_l1_reg_loss: 108460.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53022.5977; val_chrom_access_recon_loss: 835596.1953; val_global_loss: 14968372.2500; val_optim_loss: 14968372.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9449; val_auprc_score: 0.9281; val_best_acc_score: 0.8864; val_best_f1_score: 0.8924; train_kl_reg_loss: 90364.3815; train_edge_recon_loss: 2731798.2462; train_gene_expr_recon_loss: 11038866.0000; train_masked_gp_l1_reg_loss: 108247.5196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53383.7278; train_chrom_access_recon_loss: 830396.0114; train_global_loss: 14853055.9394; train_optim_loss: 14853055.9394; val_kl_reg_loss: 49376.4565; val_edge_recon_loss: 2754727.0000; val_gene_expr_recon_loss: 11134419.8750; val_masked_gp_l1_reg_loss: 107983.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54150.3008; val_chrom_access_recon_loss: 838731.9219; val_global_loss: 14939389.3750; val_optim_loss: 14939389.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9440; val_auprc_score: 0.9274; val_best_acc_score: 0.8898; val_best_f1_score: 0.8963; train_kl_reg_loss: 79116.6329; train_edge_recon_loss: 2725207.8485; train_gene_expr_recon_loss: 11016354.8333; train_masked_gp_l1_reg_loss: 107826.8900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54071.3063; train_chrom_access_recon_loss: 828957.7585; train_global_loss: 14811535.3788; train_optim_loss: 14811535.3788; val_kl_reg_loss: 52991.7061; val_edge_recon_loss: 2754706.3125; val_gene_expr_recon_loss: 11267800.7500; val_masked_gp_l1_reg_loss: 107475.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54034.0312; val_chrom_access_recon_loss: 850491.8438; val_global_loss: 15087499.6250; val_optim_loss: 15087499.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9434; val_auprc_score: 0.9181; val_best_acc_score: 0.8928; val_best_f1_score: 0.8997; train_kl_reg_loss: 73131.2405; train_edge_recon_loss: 2712569.3561; train_gene_expr_recon_loss: 10988033.0606; train_masked_gp_l1_reg_loss: 107114.8704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54231.5705; train_chrom_access_recon_loss: 826653.1297; train_global_loss: 14761733.2121; train_optim_loss: 14761733.2121; val_kl_reg_loss: 55058.1450; val_edge_recon_loss: 2724120.6562; val_gene_expr_recon_loss: 11042468.5000; val_masked_gp_l1_reg_loss: 106752.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54479.0586; val_chrom_access_recon_loss: 833960.5391; val_global_loss: 14816840.1250; val_optim_loss: 14816840.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9501; val_auprc_score: 0.9334; val_best_acc_score: 0.8968; val_best_f1_score: 0.9022; train_kl_reg_loss: 70353.3064; train_edge_recon_loss: 2716830.9015; train_gene_expr_recon_loss: 10968916.3939; train_masked_gp_l1_reg_loss: 106376.2871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54389.4757; train_chrom_access_recon_loss: 824886.7765; train_global_loss: 14741753.0758; train_optim_loss: 14741753.0758; val_kl_reg_loss: 56227.9355; val_edge_recon_loss: 2741529.3438; val_gene_expr_recon_loss: 11040178.7500; val_masked_gp_l1_reg_loss: 105890.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54386.9219; val_chrom_access_recon_loss: 833683.6094; val_global_loss: 14831897.6250; val_optim_loss: 14831897.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9352; val_auprc_score: 0.9012; val_best_acc_score: 0.8877; val_best_f1_score: 0.8937; train_kl_reg_loss: 69323.4242; train_edge_recon_loss: 2704182.1629; train_gene_expr_recon_loss: 10963071.1970; train_masked_gp_l1_reg_loss: 105575.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54402.9320; train_chrom_access_recon_loss: 824845.2074; train_global_loss: 14721400.2879; train_optim_loss: 14721400.2879; val_kl_reg_loss: 60163.8521; val_edge_recon_loss: 2775698.1250; val_gene_expr_recon_loss: 11089663.5000; val_masked_gp_l1_reg_loss: 105369.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54327.9961; val_chrom_access_recon_loss: 834755.4922; val_global_loss: 14919979.1250; val_optim_loss: 14919979.1250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9476; val_auprc_score: 0.9287; val_best_acc_score: 0.9038; val_best_f1_score: 0.9090; train_kl_reg_loss: 67480.2202; train_edge_recon_loss: 2703981.7083; train_gene_expr_recon_loss: 10945418.5758; train_masked_gp_l1_reg_loss: 104941.5259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54348.7666; train_chrom_access_recon_loss: 823385.5881; train_global_loss: 14699556.3939; train_optim_loss: 14699556.3939; val_kl_reg_loss: 60468.5376; val_edge_recon_loss: 2731945.7500; val_gene_expr_recon_loss: 11036792.1250; val_masked_gp_l1_reg_loss: 104517.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54491.3008; val_chrom_access_recon_loss: 834780.2500; val_global_loss: 14822995.8750; val_optim_loss: 14822995.8750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9520; val_auprc_score: 0.9354; val_best_acc_score: 0.9060; val_best_f1_score: 0.9097; train_kl_reg_loss: 66877.9726; train_edge_recon_loss: 2697641.8220; train_gene_expr_recon_loss: 10932959.0758; train_masked_gp_l1_reg_loss: 104264.5304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54303.2620; train_chrom_access_recon_loss: 822409.8049; train_global_loss: 14678456.3182; train_optim_loss: 14678456.3182; val_kl_reg_loss: 57228.0854; val_edge_recon_loss: 2715650.0938; val_gene_expr_recon_loss: 11040426.0000; val_masked_gp_l1_reg_loss: 103941.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54461.5586; val_chrom_access_recon_loss: 824536.3984; val_global_loss: 14796243.5000; val_optim_loss: 14796243.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9434; val_auprc_score: 0.9240; val_best_acc_score: 0.8920; val_best_f1_score: 0.8965; train_kl_reg_loss: 65915.9581; train_edge_recon_loss: 2698744.2235; train_gene_expr_recon_loss: 10897873.6364; train_masked_gp_l1_reg_loss: 103800.6719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54257.4980; train_chrom_access_recon_loss: 820527.4479; train_global_loss: 14641119.5000; train_optim_loss: 14641119.5000; val_kl_reg_loss: 60663.2632; val_edge_recon_loss: 2772807.6562; val_gene_expr_recon_loss: 10991374.5000; val_masked_gp_l1_reg_loss: 103709.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54075.0703; val_chrom_access_recon_loss: 826490.3359; val_global_loss: 14809119.8750; val_optim_loss: 14809119.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9553; val_auprc_score: 0.9378; val_best_acc_score: 0.9062; val_best_f1_score: 0.9114; train_kl_reg_loss: 66929.0968; train_edge_recon_loss: 2698699.5758; train_gene_expr_recon_loss: 10889808.5000; train_masked_gp_l1_reg_loss: 103447.9006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54169.8725; train_chrom_access_recon_loss: 820240.4403; train_global_loss: 14633295.3788; train_optim_loss: 14633295.3788; val_kl_reg_loss: 59352.5112; val_edge_recon_loss: 2695188.6875; val_gene_expr_recon_loss: 11004599.6250; val_masked_gp_l1_reg_loss: 103187.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54124.3203; val_chrom_access_recon_loss: 828403.5312; val_global_loss: 14744856.2500; val_optim_loss: 14744856.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9497; val_auprc_score: 0.9295; val_best_acc_score: 0.9014; val_best_f1_score: 0.9059; train_kl_reg_loss: 66283.1614; train_edge_recon_loss: 2695780.9015; train_gene_expr_recon_loss: 10877670.7576; train_masked_gp_l1_reg_loss: 103025.4775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54112.6932; train_chrom_access_recon_loss: 819268.6193; train_global_loss: 14616141.6667; train_optim_loss: 14616141.6667; val_kl_reg_loss: 61921.5811; val_edge_recon_loss: 2732828.2500; val_gene_expr_recon_loss: 10903224.6250; val_masked_gp_l1_reg_loss: 102788.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53909.1875; val_chrom_access_recon_loss: 823791.7578; val_global_loss: 14678464.2500; val_optim_loss: 14678464.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9537; val_auprc_score: 0.9383; val_best_acc_score: 0.9025; val_best_f1_score: 0.9077; train_kl_reg_loss: 66047.2356; train_edge_recon_loss: 2689171.4015; train_gene_expr_recon_loss: 10867499.2424; train_masked_gp_l1_reg_loss: 102437.2341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54012.1254; train_chrom_access_recon_loss: 818729.5152; train_global_loss: 14597896.6970; train_optim_loss: 14597896.6970; val_kl_reg_loss: 58968.1260; val_edge_recon_loss: 2749445.8750; val_gene_expr_recon_loss: 11016024.6250; val_masked_gp_l1_reg_loss: 102225.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54047.2109; val_chrom_access_recon_loss: 832777.8047; val_global_loss: 14813488.5000; val_optim_loss: 14813488.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9539; val_auprc_score: 0.9339; val_best_acc_score: 0.9073; val_best_f1_score: 0.9109; train_kl_reg_loss: 65358.4802; train_edge_recon_loss: 2690396.3220; train_gene_expr_recon_loss: 10851362.8788; train_masked_gp_l1_reg_loss: 102080.7166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54067.7090; train_chrom_access_recon_loss: 817379.4574; train_global_loss: 14580645.6818; train_optim_loss: 14580645.6818; val_kl_reg_loss: 61360.2002; val_edge_recon_loss: 2707001.3750; val_gene_expr_recon_loss: 10878474.6250; val_masked_gp_l1_reg_loss: 101766.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53825.5273; val_chrom_access_recon_loss: 827862.4141; val_global_loss: 14630291.5000; val_optim_loss: 14630291.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9511; val_auprc_score: 0.9299; val_best_acc_score: 0.9060; val_best_f1_score: 0.9102; train_kl_reg_loss: 65148.8019; train_edge_recon_loss: 2698351.6591; train_gene_expr_recon_loss: 10846043.2121; train_masked_gp_l1_reg_loss: 101667.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53791.2847; train_chrom_access_recon_loss: 817638.8939; train_global_loss: 14582641.9697; train_optim_loss: 14582641.9697; val_kl_reg_loss: 60031.1411; val_edge_recon_loss: 2730606.8125; val_gene_expr_recon_loss: 10913567.3750; val_masked_gp_l1_reg_loss: 101631.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54251.3945; val_chrom_access_recon_loss: 824936.5234; val_global_loss: 14685024.0000; val_optim_loss: 14685024.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9552; val_auprc_score: 0.9440; val_best_acc_score: 0.9030; val_best_f1_score: 0.9070; train_kl_reg_loss: 64427.1196; train_edge_recon_loss: 2686597.9697; train_gene_expr_recon_loss: 10828572.9545; train_masked_gp_l1_reg_loss: 101408.7019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54046.0225; train_chrom_access_recon_loss: 816517.0521; train_global_loss: 14551569.7879; train_optim_loss: 14551569.7879; val_kl_reg_loss: 61052.2158; val_edge_recon_loss: 2730278.4688; val_gene_expr_recon_loss: 10939277.7500; val_masked_gp_l1_reg_loss: 101312.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53769.8555; val_chrom_access_recon_loss: 815420.3594; val_global_loss: 14701110.8750; val_optim_loss: 14701110.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9503; val_auprc_score: 0.9271; val_best_acc_score: 0.9030; val_best_f1_score: 0.9068; train_kl_reg_loss: 64276.1291; train_edge_recon_loss: 2694360.3902; train_gene_expr_recon_loss: 10826428.7576; train_masked_gp_l1_reg_loss: 101095.4702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53845.2831; train_chrom_access_recon_loss: 814996.6629; train_global_loss: 14555002.6970; train_optim_loss: 14555002.6970; val_kl_reg_loss: 61208.8726; val_edge_recon_loss: 2738166.5312; val_gene_expr_recon_loss: 10875316.3750; val_masked_gp_l1_reg_loss: 101047.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53903.1562; val_chrom_access_recon_loss: 824418.4375; val_global_loss: 14654060.3750; val_optim_loss: 14654060.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9542; val_auprc_score: 0.9309; val_best_acc_score: 0.9116; val_best_f1_score: 0.9169; train_kl_reg_loss: 66386.7196; train_edge_recon_loss: 2684634.9962; train_gene_expr_recon_loss: 10804375.0152; train_masked_gp_l1_reg_loss: 100805.9994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53829.8131; train_chrom_access_recon_loss: 815191.1212; train_global_loss: 14525223.6212; train_optim_loss: 14525223.6212; val_kl_reg_loss: 64744.6265; val_edge_recon_loss: 2721212.8750; val_gene_expr_recon_loss: 10956654.2500; val_masked_gp_l1_reg_loss: 100651.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53996.7930; val_chrom_access_recon_loss: 824684.4531; val_global_loss: 14721944.3750; val_optim_loss: 14721944.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9579; val_auprc_score: 0.9387; val_best_acc_score: 0.9111; val_best_f1_score: 0.9152; train_kl_reg_loss: 66951.5951; train_edge_recon_loss: 2675799.4962; train_gene_expr_recon_loss: 10803327.4394; train_masked_gp_l1_reg_loss: 98944.2272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46342.7509; train_chrom_access_recon_loss: 814868.4583; train_global_loss: 14506234.0606; train_optim_loss: 14506234.0606; val_kl_reg_loss: 63390.5073; val_edge_recon_loss: 2708364.4062; val_gene_expr_recon_loss: 10833101.2500; val_masked_gp_l1_reg_loss: 98317.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44561.0078; val_chrom_access_recon_loss: 816674.6797; val_global_loss: 14564408.7500; val_optim_loss: 14564408.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9582; val_auprc_score: 0.9418; val_best_acc_score: 0.9151; val_best_f1_score: 0.9174; train_kl_reg_loss: 67180.7308; train_edge_recon_loss: 2682159.9848; train_gene_expr_recon_loss: 10792301.1818; train_masked_gp_l1_reg_loss: 98186.9080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44260.5068; train_chrom_access_recon_loss: 813680.5843; train_global_loss: 14497770.0606; train_optim_loss: 14497770.0606; val_kl_reg_loss: 63900.6982; val_edge_recon_loss: 2698845.0000; val_gene_expr_recon_loss: 10866406.6250; val_masked_gp_l1_reg_loss: 98089.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44030.5312; val_chrom_access_recon_loss: 822322.2891; val_global_loss: 14593594.6250; val_optim_loss: 14593594.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9495; val_auprc_score: 0.9267; val_best_acc_score: 0.9062; val_best_f1_score: 0.9111; train_kl_reg_loss: 67356.8137; train_edge_recon_loss: 2683934.1970; train_gene_expr_recon_loss: 10792332.4545; train_masked_gp_l1_reg_loss: 98027.3202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43883.5987; train_chrom_access_recon_loss: 813792.2746; train_global_loss: 14499326.6515; train_optim_loss: 14499326.6515; val_kl_reg_loss: 64274.0781; val_edge_recon_loss: 2732801.0312; val_gene_expr_recon_loss: 10897685.7500; val_masked_gp_l1_reg_loss: 97997.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43725.7734; val_chrom_access_recon_loss: 813985.2891; val_global_loss: 14650470.0000; val_optim_loss: 14650470.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9543; val_auprc_score: 0.9356; val_best_acc_score: 0.9084; val_best_f1_score: 0.9117; train_kl_reg_loss: 67265.0408; train_edge_recon_loss: 2680617.5682; train_gene_expr_recon_loss: 10786032.8485; train_masked_gp_l1_reg_loss: 97961.5606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43652.8673; train_chrom_access_recon_loss: 813336.2102; train_global_loss: 14488866.1212; train_optim_loss: 14488866.1212; val_kl_reg_loss: 64801.9282; val_edge_recon_loss: 2698750.8438; val_gene_expr_recon_loss: 10881439.0000; val_masked_gp_l1_reg_loss: 97943.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43544.1797; val_chrom_access_recon_loss: 822484.6094; val_global_loss: 14608963.2500; val_optim_loss: 14608963.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9577; val_auprc_score: 0.9378; val_best_acc_score: 0.9108; val_best_f1_score: 0.9133; train_kl_reg_loss: 67873.1961; train_edge_recon_loss: 2681625.2500; train_gene_expr_recon_loss: 10785014.7424; train_masked_gp_l1_reg_loss: 97911.2824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43459.9411; train_chrom_access_recon_loss: 813073.3314; train_global_loss: 14488957.7121; train_optim_loss: 14488957.7121; val_kl_reg_loss: 65154.1499; val_edge_recon_loss: 2707158.9375; val_gene_expr_recon_loss: 10883659.2500; val_masked_gp_l1_reg_loss: 97877.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43407.1211; val_chrom_access_recon_loss: 819365.6719; val_global_loss: 14616622.1250; val_optim_loss: 14616622.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9589; val_auprc_score: 0.9432; val_best_acc_score: 0.9132; val_best_f1_score: 0.9159; train_kl_reg_loss: 67987.5405; train_edge_recon_loss: 2680030.7879; train_gene_expr_recon_loss: 10787262.5606; train_masked_gp_l1_reg_loss: 97706.1488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42602.0350; train_chrom_access_recon_loss: 813179.7330; train_global_loss: 14488768.8939; train_optim_loss: 14488768.8939; val_kl_reg_loss: 64906.9380; val_edge_recon_loss: 2708723.7500; val_gene_expr_recon_loss: 10905124.1250; val_masked_gp_l1_reg_loss: 97632.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42428.7383; val_chrom_access_recon_loss: 818121.6016; val_global_loss: 14636937.5000; val_optim_loss: 14636937.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9534; val_auprc_score: 0.9343; val_best_acc_score: 0.9030; val_best_f1_score: 0.9088; train_kl_reg_loss: 67848.9533; train_edge_recon_loss: 2683020.9545; train_gene_expr_recon_loss: 10790209.2273; train_masked_gp_l1_reg_loss: 97610.5488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42402.1898; train_chrom_access_recon_loss: 813140.2576; train_global_loss: 14494232.2879; train_optim_loss: 14494232.2879; val_kl_reg_loss: 64562.3604; val_edge_recon_loss: 2713497.0000; val_gene_expr_recon_loss: 10949467.3750; val_masked_gp_l1_reg_loss: 97590.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42376.9180; val_chrom_access_recon_loss: 816289.7109; val_global_loss: 14683784.5000; val_optim_loss: 14683784.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9573; val_auprc_score: 0.9413; val_best_acc_score: 0.9097; val_best_f1_score: 0.9127; train_kl_reg_loss: 67861.6404; train_edge_recon_loss: 2679589.3333; train_gene_expr_recon_loss: 10785830.7273; train_masked_gp_l1_reg_loss: 97579.0528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42357.4411; train_chrom_access_recon_loss: 813422.4991; train_global_loss: 14486640.6061; train_optim_loss: 14486640.6061; val_kl_reg_loss: 65201.4502; val_edge_recon_loss: 2724133.9062; val_gene_expr_recon_loss: 10946313.1250; val_masked_gp_l1_reg_loss: 97569.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42337.9727; val_chrom_access_recon_loss: 827502.8672; val_global_loss: 14703059.3750; val_optim_loss: 14703059.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9584; val_auprc_score: 0.9422; val_best_acc_score: 0.9113; val_best_f1_score: 0.9159; train_kl_reg_loss: 67738.2422; train_edge_recon_loss: 2689126.9053; train_gene_expr_recon_loss: 10779490.4848; train_masked_gp_l1_reg_loss: 97562.2369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42322.7705; train_chrom_access_recon_loss: 813169.8106; train_global_loss: 14489410.4091; train_optim_loss: 14489410.4091; val_kl_reg_loss: 64745.4980; val_edge_recon_loss: 2727838.8750; val_gene_expr_recon_loss: 10896369.5000; val_masked_gp_l1_reg_loss: 97556.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42309.3555; val_chrom_access_recon_loss: 818901.8906; val_global_loss: 14647720.6250; val_optim_loss: 14647720.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 37 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9542
val AUPRC score: 0.9358
val best accuracy score: 0.9073
val best F1 score: 0.9124
val target rna MSE score: 1.7120
val source rna MSE score: 0.9530
val target atac MSE score: 0.4871
val source atac MSE score: 0.2057
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
