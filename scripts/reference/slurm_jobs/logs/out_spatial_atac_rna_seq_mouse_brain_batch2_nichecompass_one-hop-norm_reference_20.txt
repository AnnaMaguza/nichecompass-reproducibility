[True]
Run timestamp: 07082023_174129_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8682; val_auprc_score: 0.8888; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12536.6001; train_edge_recon_loss: 36177.0022; train_gene_expr_recon_loss: 1535070.8194; train_masked_gp_l1_reg_loss: 4466.7614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119416.3142; train_chrom_access_recon_loss: 3097191.2639; train_global_loss: 4804858.7778; train_optim_loss: 4804858.7778; val_kl_reg_loss: 9256.8457; val_edge_recon_loss: 40660.8867; val_gene_expr_recon_loss: 1271663.1250; val_masked_gp_l1_reg_loss: 3809.7268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117212.2188; val_chrom_access_recon_loss: 1772170.8750; val_global_loss: 3214773.7500; val_optim_loss: 3214773.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8806; val_auprc_score: 0.9035; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6693.8610; train_edge_recon_loss: 36770.0061; train_gene_expr_recon_loss: 1093327.6389; train_masked_gp_l1_reg_loss: 3652.7883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115972.4245; train_chrom_access_recon_loss: 1567662.7917; train_global_loss: 2824079.5556; train_optim_loss: 2824079.5556; val_kl_reg_loss: 4224.9805; val_edge_recon_loss: 40658.9023; val_gene_expr_recon_loss: 1001661.1250; val_masked_gp_l1_reg_loss: 3642.0618; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114532.1953; val_chrom_access_recon_loss: 1457438.6250; val_global_loss: 2622158.0000; val_optim_loss: 2622158.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8808; val_auprc_score: 0.8994; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4948.3691; train_edge_recon_loss: 36323.7600; train_gene_expr_recon_loss: 971080.9653; train_masked_gp_l1_reg_loss: 3856.7133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113466.7812; train_chrom_access_recon_loss: 1445735.2639; train_global_loss: 2575411.8889; train_optim_loss: 2575411.8889; val_kl_reg_loss: 7651.0439; val_edge_recon_loss: 40660.1992; val_gene_expr_recon_loss: 907080.0000; val_masked_gp_l1_reg_loss: 4132.9990; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112148.6797; val_chrom_access_recon_loss: 1428556.7500; val_global_loss: 2500229.5000; val_optim_loss: 2500229.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8843; val_auprc_score: 0.9009; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13058.0767; train_edge_recon_loss: 37849.9523; train_gene_expr_recon_loss: 867038.3403; train_masked_gp_l1_reg_loss: 4233.1535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111074.3681; train_chrom_access_recon_loss: 1422036.2639; train_global_loss: 2455290.0833; train_optim_loss: 2455290.0833; val_kl_reg_loss: 17927.9453; val_edge_recon_loss: 40661.3867; val_gene_expr_recon_loss: 815768.1875; val_masked_gp_l1_reg_loss: 4276.2065; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109681.8047; val_chrom_access_recon_loss: 1402245.5000; val_global_loss: 2390561.0000; val_optim_loss: 2390561.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8965; val_auprc_score: 0.9066; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19467.4922; train_edge_recon_loss: 38765.0234; train_gene_expr_recon_loss: 797246.0417; train_masked_gp_l1_reg_loss: 4263.6303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108454.8681; train_chrom_access_recon_loss: 1394088.9167; train_global_loss: 2362285.9722; train_optim_loss: 2362285.9722; val_kl_reg_loss: 19324.7344; val_edge_recon_loss: 40660.3789; val_gene_expr_recon_loss: 768722.6250; val_masked_gp_l1_reg_loss: 4241.7847; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106842.1484; val_chrom_access_recon_loss: 1370415.8750; val_global_loss: 2310207.5000; val_optim_loss: 2310207.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8907; val_auprc_score: 0.8954; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 20300.2600; train_edge_recon_loss: 38805.0864; train_gene_expr_recon_loss: 754944.5833; train_masked_gp_l1_reg_loss: 4228.6744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105429.8116; train_chrom_access_recon_loss: 1360588.2361; train_global_loss: 2284296.6389; train_optim_loss: 2284296.6389; val_kl_reg_loss: 21155.9609; val_edge_recon_loss: 40658.9609; val_gene_expr_recon_loss: 738505.6875; val_masked_gp_l1_reg_loss: 4210.0811; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103596.8438; val_chrom_access_recon_loss: 1351788.6250; val_global_loss: 2259916.0000; val_optim_loss: 2259916.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8816; val_auprc_score: 0.8823; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 21653.7960; train_edge_recon_loss: 38912.3563; train_gene_expr_recon_loss: 731348.2778; train_masked_gp_l1_reg_loss: 4195.3994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102033.2604; train_chrom_access_recon_loss: 1344942.9167; train_global_loss: 2243086.0556; train_optim_loss: 2243086.0556; val_kl_reg_loss: 21412.9062; val_edge_recon_loss: 40654.8047; val_gene_expr_recon_loss: 718704.8750; val_masked_gp_l1_reg_loss: 4177.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100038.1328; val_chrom_access_recon_loss: 1339414.8750; val_global_loss: 2224402.5000; val_optim_loss: 2224402.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8689; val_auprc_score: 0.8641; val_best_acc_score: 0.5106; val_best_f1_score: 0.6714; train_kl_reg_loss: 21918.2934; train_edge_recon_loss: 38932.8945; train_gene_expr_recon_loss: 710737.9514; train_masked_gp_l1_reg_loss: 4168.1219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98395.7092; train_chrom_access_recon_loss: 1333858.4306; train_global_loss: 2208011.3889; train_optim_loss: 2208011.3889; val_kl_reg_loss: 21416.1953; val_edge_recon_loss: 40648.6484; val_gene_expr_recon_loss: 704072.8750; val_masked_gp_l1_reg_loss: 4156.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96324.8281; val_chrom_access_recon_loss: 1331282.1250; val_global_loss: 2197901.0000; val_optim_loss: 2197901.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8579; val_auprc_score: 0.8501; val_best_acc_score: 0.5216; val_best_f1_score: 0.6760; train_kl_reg_loss: 22291.8010; train_edge_recon_loss: 38979.7270; train_gene_expr_recon_loss: 695308.0347; train_masked_gp_l1_reg_loss: 4154.4829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94655.0443; train_chrom_access_recon_loss: 1321045.4583; train_global_loss: 2176434.6111; train_optim_loss: 2176434.6111; val_kl_reg_loss: 22302.6406; val_edge_recon_loss: 40639.7773; val_gene_expr_recon_loss: 691492.5000; val_masked_gp_l1_reg_loss: 4146.5991; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92565.6641; val_chrom_access_recon_loss: 1324756.8750; val_global_loss: 2175904.0000; val_optim_loss: 2175904.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8451; val_auprc_score: 0.8424; val_best_acc_score: 0.5426; val_best_f1_score: 0.6846; train_kl_reg_loss: 22855.4757; train_edge_recon_loss: 39028.1172; train_gene_expr_recon_loss: 688760.9722; train_masked_gp_l1_reg_loss: 4138.4053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90898.2474; train_chrom_access_recon_loss: 1324039.6111; train_global_loss: 2169720.8333; train_optim_loss: 2169720.8333; val_kl_reg_loss: 22251.4922; val_edge_recon_loss: 40626.7500; val_gene_expr_recon_loss: 681384.5625; val_masked_gp_l1_reg_loss: 4123.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88818.5547; val_chrom_access_recon_loss: 1318897.2500; val_global_loss: 2156102.5000; val_optim_loss: 2156102.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8392; val_auprc_score: 0.8440; val_best_acc_score: 0.5651; val_best_f1_score: 0.6936; train_kl_reg_loss: 23097.4308; train_edge_recon_loss: 39094.9549; train_gene_expr_recon_loss: 679703.0278; train_masked_gp_l1_reg_loss: 4120.8452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87178.6736; train_chrom_access_recon_loss: 1316825.7083; train_global_loss: 2150020.6667; train_optim_loss: 2150020.6667; val_kl_reg_loss: 22706.1211; val_edge_recon_loss: 40613.5781; val_gene_expr_recon_loss: 673831.2500; val_masked_gp_l1_reg_loss: 4110.3511; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85141.1875; val_chrom_access_recon_loss: 1314163.1250; val_global_loss: 2140565.5000; val_optim_loss: 2140565.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8200; val_auprc_score: 0.8144; val_best_acc_score: 0.6054; val_best_f1_score: 0.7117; train_kl_reg_loss: 23405.6363; train_edge_recon_loss: 39105.7500; train_gene_expr_recon_loss: 670728.3542; train_masked_gp_l1_reg_loss: 4105.9085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83542.7648; train_chrom_access_recon_loss: 1311238.8889; train_global_loss: 2132127.2778; train_optim_loss: 2132127.2778; val_kl_reg_loss: 21822.7656; val_edge_recon_loss: 40581.9219; val_gene_expr_recon_loss: 669093.7500; val_masked_gp_l1_reg_loss: 4094.4824; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81562.5156; val_chrom_access_recon_loss: 1310625.6250; val_global_loss: 2127781.0000; val_optim_loss: 2127781.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8242; val_auprc_score: 0.8243; val_best_acc_score: 0.6205; val_best_f1_score: 0.7184; train_kl_reg_loss: 23142.9520; train_edge_recon_loss: 39086.1076; train_gene_expr_recon_loss: 671311.6875; train_masked_gp_l1_reg_loss: 4094.8072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80023.0773; train_chrom_access_recon_loss: 1318176.1806; train_global_loss: 2135834.8333; train_optim_loss: 2135834.8333; val_kl_reg_loss: 22127.1055; val_edge_recon_loss: 40568.0586; val_gene_expr_recon_loss: 663905.1250; val_masked_gp_l1_reg_loss: 4087.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78117.3281; val_chrom_access_recon_loss: 1307639.2500; val_global_loss: 2116444.7500; val_optim_loss: 2116444.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8237; val_auprc_score: 0.8236; val_best_acc_score: 0.6341; val_best_f1_score: 0.7256; train_kl_reg_loss: 22893.2667; train_edge_recon_loss: 39087.7205; train_gene_expr_recon_loss: 665252.7917; train_masked_gp_l1_reg_loss: 4092.0475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76639.7240; train_chrom_access_recon_loss: 1310202.5556; train_global_loss: 2118168.1389; train_optim_loss: 2118168.1389; val_kl_reg_loss: 22575.9844; val_edge_recon_loss: 40565.0078; val_gene_expr_recon_loss: 659652.5000; val_masked_gp_l1_reg_loss: 4086.9263; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74812.8828; val_chrom_access_recon_loss: 1304632.8750; val_global_loss: 2106326.2500; val_optim_loss: 2106326.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8154; val_auprc_score: 0.8089; val_best_acc_score: 0.6548; val_best_f1_score: 0.7347; train_kl_reg_loss: 22585.8097; train_edge_recon_loss: 39067.0291; train_gene_expr_recon_loss: 660342.6736; train_masked_gp_l1_reg_loss: 4084.2118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73393.1458; train_chrom_access_recon_loss: 1304505.6667; train_global_loss: 2103978.5556; train_optim_loss: 2103978.5556; val_kl_reg_loss: 21048.2402; val_edge_recon_loss: 40535.2852; val_gene_expr_recon_loss: 658131.6250; val_masked_gp_l1_reg_loss: 4079.3289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71644.2578; val_chrom_access_recon_loss: 1302002.5000; val_global_loss: 2097441.2500; val_optim_loss: 2097441.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8201; val_auprc_score: 0.8172; val_best_acc_score: 0.6575; val_best_f1_score: 0.7360; train_kl_reg_loss: 22155.5870; train_edge_recon_loss: 39063.0686; train_gene_expr_recon_loss: 658595.2014; train_masked_gp_l1_reg_loss: 4083.6051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70299.3872; train_chrom_access_recon_loss: 1300106.5556; train_global_loss: 2094303.4028; train_optim_loss: 2094303.4028; val_kl_reg_loss: 21590.0312; val_edge_recon_loss: 40535.8008; val_gene_expr_recon_loss: 654116.3750; val_masked_gp_l1_reg_loss: 4082.3794; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68641.6641; val_chrom_access_recon_loss: 1299789.1250; val_global_loss: 2088755.3750; val_optim_loss: 2088755.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8247; val_auprc_score: 0.8234; val_best_acc_score: 0.6835; val_best_f1_score: 0.7489; train_kl_reg_loss: 21870.1725; train_edge_recon_loss: 39047.0247; train_gene_expr_recon_loss: 652723.2014; train_masked_gp_l1_reg_loss: 4083.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67366.1788; train_chrom_access_recon_loss: 1300750.6528; train_global_loss: 2085840.9583; train_optim_loss: 2085840.9583; val_kl_reg_loss: 20274.7598; val_edge_recon_loss: 40510.2461; val_gene_expr_recon_loss: 653280.7500; val_masked_gp_l1_reg_loss: 4080.1011; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65793.8594; val_chrom_access_recon_loss: 1300530.6250; val_global_loss: 2084470.3750; val_optim_loss: 2084470.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8294; val_auprc_score: 0.8268; val_best_acc_score: 0.6789; val_best_f1_score: 0.7465; train_kl_reg_loss: 21282.5922; train_edge_recon_loss: 39019.0556; train_gene_expr_recon_loss: 652515.1250; train_masked_gp_l1_reg_loss: 4084.6973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64587.2378; train_chrom_access_recon_loss: 1298183.3194; train_global_loss: 2079672.0417; train_optim_loss: 2079672.0417; val_kl_reg_loss: 20813.0469; val_edge_recon_loss: 40512.8164; val_gene_expr_recon_loss: 650319.0000; val_masked_gp_l1_reg_loss: 4081.0193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63100.8555; val_chrom_access_recon_loss: 1297944.8750; val_global_loss: 2076771.6250; val_optim_loss: 2076771.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8332; val_auprc_score: 0.8336; val_best_acc_score: 0.6982; val_best_f1_score: 0.7557; train_kl_reg_loss: 20955.4811; train_edge_recon_loss: 38982.0668; train_gene_expr_recon_loss: 651490.1111; train_masked_gp_l1_reg_loss: 4085.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61957.7795; train_chrom_access_recon_loss: 1298480.9444; train_global_loss: 2075951.4306; train_optim_loss: 2075951.4306; val_kl_reg_loss: 19708.9004; val_edge_recon_loss: 40492.2227; val_gene_expr_recon_loss: 649400.3750; val_masked_gp_l1_reg_loss: 4087.5869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60552.1094; val_chrom_access_recon_loss: 1295764.0000; val_global_loss: 2070005.2500; val_optim_loss: 2070005.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8381; val_auprc_score: 0.8363; val_best_acc_score: 0.7049; val_best_f1_score: 0.7596; train_kl_reg_loss: 20509.4705; train_edge_recon_loss: 38966.7344; train_gene_expr_recon_loss: 650332.0972; train_masked_gp_l1_reg_loss: 4089.9180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59477.2721; train_chrom_access_recon_loss: 1298066.8333; train_global_loss: 2071442.2917; train_optim_loss: 2071442.2917; val_kl_reg_loss: 19819.4004; val_edge_recon_loss: 40486.8945; val_gene_expr_recon_loss: 647399.5000; val_masked_gp_l1_reg_loss: 4087.4990; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58150.3906; val_chrom_access_recon_loss: 1293436.5000; val_global_loss: 2063380.2500; val_optim_loss: 2063380.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8485; val_auprc_score: 0.8487; val_best_acc_score: 0.7254; val_best_f1_score: 0.7699; train_kl_reg_loss: 20186.7463; train_edge_recon_loss: 38932.4644; train_gene_expr_recon_loss: 650035.8125; train_masked_gp_l1_reg_loss: 4092.6016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57129.9175; train_chrom_access_recon_loss: 1296980.2361; train_global_loss: 2067357.7639; train_optim_loss: 2067357.7639; val_kl_reg_loss: 19141.0703; val_edge_recon_loss: 40455.7578; val_gene_expr_recon_loss: 646451.4375; val_masked_gp_l1_reg_loss: 4089.0515; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55877.7148; val_chrom_access_recon_loss: 1291389.0000; val_global_loss: 2057404.0000; val_optim_loss: 2057404.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8655; val_auprc_score: 0.8585; val_best_acc_score: 0.7611; val_best_f1_score: 0.7911; train_kl_reg_loss: 19760.4928; train_edge_recon_loss: 38873.2834; train_gene_expr_recon_loss: 646073.3403; train_masked_gp_l1_reg_loss: 4092.2737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54917.4449; train_chrom_access_recon_loss: 1288993.8750; train_global_loss: 2052710.7222; train_optim_loss: 2052710.7222; val_kl_reg_loss: 18911.5820; val_edge_recon_loss: 40422.1484; val_gene_expr_recon_loss: 645037.0000; val_masked_gp_l1_reg_loss: 4090.7312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53732.0391; val_chrom_access_recon_loss: 1288922.8750; val_global_loss: 2051116.5000; val_optim_loss: 2051116.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8877; val_auprc_score: 0.8805; val_best_acc_score: 0.8095; val_best_f1_score: 0.8224; train_kl_reg_loss: 19618.6521; train_edge_recon_loss: 38834.1029; train_gene_expr_recon_loss: 645991.1181; train_masked_gp_l1_reg_loss: 4096.8399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52822.0794; train_chrom_access_recon_loss: 1287940.5000; train_global_loss: 2049303.2917; train_optim_loss: 2049303.2917; val_kl_reg_loss: 18449.1016; val_edge_recon_loss: 40335.8633; val_gene_expr_recon_loss: 644084.8125; val_masked_gp_l1_reg_loss: 4096.1777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51701.3867; val_chrom_access_recon_loss: 1286801.1250; val_global_loss: 2045468.5000; val_optim_loss: 2045468.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9061; val_auprc_score: 0.8991; val_best_acc_score: 0.8367; val_best_f1_score: 0.8406; train_kl_reg_loss: 19349.9151; train_edge_recon_loss: 38745.0056; train_gene_expr_recon_loss: 643079.2292; train_masked_gp_l1_reg_loss: 4104.0022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50844.8507; train_chrom_access_recon_loss: 1286623.8056; train_global_loss: 2042746.8194; train_optim_loss: 2042746.8194; val_kl_reg_loss: 18621.5059; val_edge_recon_loss: 40244.4844; val_gene_expr_recon_loss: 642197.2500; val_masked_gp_l1_reg_loss: 4104.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49780.8242; val_chrom_access_recon_loss: 1284760.0000; val_global_loss: 2039708.2500; val_optim_loss: 2039708.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9108; val_auprc_score: 0.9029; val_best_acc_score: 0.8391; val_best_f1_score: 0.8383; train_kl_reg_loss: 19166.6107; train_edge_recon_loss: 38675.1997; train_gene_expr_recon_loss: 642632.4514; train_masked_gp_l1_reg_loss: 4107.9942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48967.4405; train_chrom_access_recon_loss: 1277326.7222; train_global_loss: 2030876.4028; train_optim_loss: 2030876.4028; val_kl_reg_loss: 18694.0430; val_edge_recon_loss: 40166.3828; val_gene_expr_recon_loss: 640679.5625; val_masked_gp_l1_reg_loss: 4110.8604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47963.1641; val_chrom_access_recon_loss: 1282323.6250; val_global_loss: 2033937.7500; val_optim_loss: 2033937.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9120; val_auprc_score: 0.9048; val_best_acc_score: 0.8075; val_best_f1_score: 0.8295; train_kl_reg_loss: 17284.8989; train_edge_recon_loss: 40192.4757; train_gene_expr_recon_loss: 940258.3542; train_masked_gp_l1_reg_loss: 4164.6683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47064.9266; train_chrom_access_recon_loss: 1359389.3889; train_global_loss: 2408354.7222; train_optim_loss: 2408354.7222; val_kl_reg_loss: 14183.0068; val_edge_recon_loss: 40423.1953; val_gene_expr_recon_loss: 930108.2500; val_masked_gp_l1_reg_loss: 4255.9585; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45875.0547; val_chrom_access_recon_loss: 1353853.8750; val_global_loss: 2388699.2500; val_optim_loss: 2388699.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9143; val_auprc_score: 0.9043; val_best_acc_score: 0.8040; val_best_f1_score: 0.8277; train_kl_reg_loss: 15686.5618; train_edge_recon_loss: 40211.9609; train_gene_expr_recon_loss: 928826.6528; train_masked_gp_l1_reg_loss: 4333.1358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44890.4887; train_chrom_access_recon_loss: 1353979.5556; train_global_loss: 2387928.3056; train_optim_loss: 2387928.3056; val_kl_reg_loss: 13707.1523; val_edge_recon_loss: 40427.8633; val_gene_expr_recon_loss: 923871.5625; val_masked_gp_l1_reg_loss: 4420.0869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43670.3984; val_chrom_access_recon_loss: 1351599.6250; val_global_loss: 2377696.5000; val_optim_loss: 2377696.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9139; val_auprc_score: 0.9071; val_best_acc_score: 0.8079; val_best_f1_score: 0.8299; train_kl_reg_loss: 14997.8252; train_edge_recon_loss: 40214.0846; train_gene_expr_recon_loss: 924324.2986; train_masked_gp_l1_reg_loss: 4476.2502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42726.5386; train_chrom_access_recon_loss: 1346594.2917; train_global_loss: 2373333.3611; train_optim_loss: 2373333.3611; val_kl_reg_loss: 13399.9492; val_edge_recon_loss: 40431.3164; val_gene_expr_recon_loss: 919370.4375; val_masked_gp_l1_reg_loss: 4536.4165; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41570.1367; val_chrom_access_recon_loss: 1349630.3750; val_global_loss: 2368938.5000; val_optim_loss: 2368938.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9155; val_auprc_score: 0.9037; val_best_acc_score: 0.8235; val_best_f1_score: 0.8405; train_kl_reg_loss: 14714.1141; train_edge_recon_loss: 40215.0530; train_gene_expr_recon_loss: 922354.9653; train_masked_gp_l1_reg_loss: 4573.8128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40690.0651; train_chrom_access_recon_loss: 1353244.9306; train_global_loss: 2375792.8889; train_optim_loss: 2375792.8889; val_kl_reg_loss: 13317.7676; val_edge_recon_loss: 40405.5742; val_gene_expr_recon_loss: 915814.1250; val_masked_gp_l1_reg_loss: 4611.1489; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39618.5781; val_chrom_access_recon_loss: 1348170.0000; val_global_loss: 2361937.2500; val_optim_loss: 2361937.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9184; val_auprc_score: 0.9118; val_best_acc_score: 0.8192; val_best_f1_score: 0.8378; train_kl_reg_loss: 14444.3187; train_edge_recon_loss: 40200.4905; train_gene_expr_recon_loss: 918254.3472; train_masked_gp_l1_reg_loss: 4598.4439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39503.6497; train_chrom_access_recon_loss: 1351999.6944; train_global_loss: 2369000.9722; train_optim_loss: 2369000.9722; val_kl_reg_loss: 13554.7061; val_edge_recon_loss: 40411.7852; val_gene_expr_recon_loss: 915229.5000; val_masked_gp_l1_reg_loss: 4587.4326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39362.5703; val_chrom_access_recon_loss: 1347677.2500; val_global_loss: 2360823.2500; val_optim_loss: 2360823.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9174; val_auprc_score: 0.9127; val_best_acc_score: 0.8196; val_best_f1_score: 0.8379; train_kl_reg_loss: 14723.2448; train_edge_recon_loss: 40208.7600; train_gene_expr_recon_loss: 912717.0833; train_masked_gp_l1_reg_loss: 4585.7922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39261.0838; train_chrom_access_recon_loss: 1344795.8889; train_global_loss: 2356291.8611; train_optim_loss: 2356291.8611; val_kl_reg_loss: 13622.9688; val_edge_recon_loss: 40416.3242; val_gene_expr_recon_loss: 914831.6250; val_masked_gp_l1_reg_loss: 4581.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39133.8633; val_chrom_access_recon_loss: 1347470.6250; val_global_loss: 2360057.2500; val_optim_loss: 2360057.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9176; val_auprc_score: 0.9094; val_best_acc_score: 0.8250; val_best_f1_score: 0.8416; train_kl_reg_loss: 14587.5446; train_edge_recon_loss: 40205.1280; train_gene_expr_recon_loss: 914608.3194; train_masked_gp_l1_reg_loss: 4579.6155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39036.9184; train_chrom_access_recon_loss: 1344193.5556; train_global_loss: 2357211.0556; train_optim_loss: 2357211.0556; val_kl_reg_loss: 13442.7949; val_edge_recon_loss: 40410.4844; val_gene_expr_recon_loss: 914695.0625; val_masked_gp_l1_reg_loss: 4577.4722; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38917.3008; val_chrom_access_recon_loss: 1347588.2500; val_global_loss: 2359631.5000; val_optim_loss: 2359631.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9174; val_auprc_score: 0.9092; val_best_acc_score: 0.8226; val_best_f1_score: 0.8399; train_kl_reg_loss: 14525.9745; train_edge_recon_loss: 40199.6879; train_gene_expr_recon_loss: 917354.7708; train_masked_gp_l1_reg_loss: 4576.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38824.4136; train_chrom_access_recon_loss: 1343100.5417; train_global_loss: 2358582.1667; train_optim_loss: 2358582.1667; val_kl_reg_loss: 13524.9688; val_edge_recon_loss: 40409.5742; val_gene_expr_recon_loss: 914279.7500; val_masked_gp_l1_reg_loss: 4576.2935; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38711.3203; val_chrom_access_recon_loss: 1347573.0000; val_global_loss: 2359075.0000; val_optim_loss: 2359075.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 31 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9103
val AUPRC score: 0.9019
val best accuracy score: 0.7804
val best F1 score: 0.8126
val target rna MSE score: 3.9960
val source rna MSE score: 3.2154
val target atac MSE score: 0.1355
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
