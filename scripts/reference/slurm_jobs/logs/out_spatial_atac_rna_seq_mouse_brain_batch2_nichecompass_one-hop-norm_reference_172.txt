[True]
Run timestamp: 10102023_062750_172.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_172']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7078; val_auprc_score: 0.6820; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 68839.8096; train_edge_recon_loss: 750670.4422; train_gene_expr_recon_loss: 23178816.9697; train_masked_gp_l1_reg_loss: 140524.7874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5094055.4924; train_chrom_access_recon_loss: 990195.2907; train_global_loss: 30223102.8182; train_optim_loss: 30223102.8182; val_kl_reg_loss: 111172.0078; val_edge_recon_loss: 813103.8828; val_gene_expr_recon_loss: 21695731.7500; val_masked_gp_l1_reg_loss: 103458.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2987080.5000; val_chrom_access_recon_loss: 957690.8203; val_global_loss: 26668236.5000; val_optim_loss: 26668236.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6910; val_auprc_score: 0.6747; val_best_acc_score: 0.5828; val_best_f1_score: 0.6972; train_kl_reg_loss: 95749.5955; train_edge_recon_loss: 750545.2358; train_gene_expr_recon_loss: 21186481.1212; train_masked_gp_l1_reg_loss: 95948.3741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1713004.5597; train_chrom_access_recon_loss: 944477.2405; train_global_loss: 24786206.1818; train_optim_loss: 24786206.1818; val_kl_reg_loss: 93525.6514; val_edge_recon_loss: 812046.6172; val_gene_expr_recon_loss: 21370654.7500; val_masked_gp_l1_reg_loss: 94043.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 877276.7500; val_chrom_access_recon_loss: 962417.7812; val_global_loss: 24209964.7500; val_optim_loss: 24209964.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7738; val_auprc_score: 0.7625; val_best_acc_score: 0.6991; val_best_f1_score: 0.7147; train_kl_reg_loss: 86326.7771; train_edge_recon_loss: 739792.3504; train_gene_expr_recon_loss: 20985668.4545; train_masked_gp_l1_reg_loss: 95385.5890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 578687.8400; train_chrom_access_recon_loss: 939636.7765; train_global_loss: 23425497.7273; train_optim_loss: 23425497.7273; val_kl_reg_loss: 86662.2549; val_edge_recon_loss: 795666.4844; val_gene_expr_recon_loss: 21191472.0000; val_masked_gp_l1_reg_loss: 97010.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 381819.3438; val_chrom_access_recon_loss: 946504.3359; val_global_loss: 23499135.5000; val_optim_loss: 23499135.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8265; val_auprc_score: 0.7973; val_best_acc_score: 0.7622; val_best_f1_score: 0.7722; train_kl_reg_loss: 80033.6778; train_edge_recon_loss: 725267.6572; train_gene_expr_recon_loss: 20826417.0606; train_masked_gp_l1_reg_loss: 98657.6070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 297431.3501; train_chrom_access_recon_loss: 934025.9735; train_global_loss: 22961833.4242; train_optim_loss: 22961833.4242; val_kl_reg_loss: 76162.8164; val_edge_recon_loss: 757729.9766; val_gene_expr_recon_loss: 21151490.2500; val_masked_gp_l1_reg_loss: 100609.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235078.5625; val_chrom_access_recon_loss: 941521.3594; val_global_loss: 23262592.2500; val_optim_loss: 23262592.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8728; val_auprc_score: 0.8369; val_best_acc_score: 0.8025; val_best_f1_score: 0.8220; train_kl_reg_loss: 77968.1536; train_edge_recon_loss: 699427.7652; train_gene_expr_recon_loss: 20712741.5758; train_masked_gp_l1_reg_loss: 101805.9995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200434.9640; train_chrom_access_recon_loss: 930506.6515; train_global_loss: 22722884.9697; train_optim_loss: 22722884.9697; val_kl_reg_loss: 77726.9854; val_edge_recon_loss: 693156.9453; val_gene_expr_recon_loss: 20924996.7500; val_masked_gp_l1_reg_loss: 102989.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173667.1719; val_chrom_access_recon_loss: 935109.0078; val_global_loss: 22907648.2500; val_optim_loss: 22907648.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8807; val_auprc_score: 0.8469; val_best_acc_score: 0.8125; val_best_f1_score: 0.8238; train_kl_reg_loss: 83783.9759; train_edge_recon_loss: 653886.0227; train_gene_expr_recon_loss: 20568059.2121; train_masked_gp_l1_reg_loss: 103744.1508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158140.3923; train_chrom_access_recon_loss: 924160.4223; train_global_loss: 22491774.0909; train_optim_loss: 22491774.0909; val_kl_reg_loss: 85506.7715; val_edge_recon_loss: 646561.9766; val_gene_expr_recon_loss: 20778969.0000; val_masked_gp_l1_reg_loss: 104953.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144651.5625; val_chrom_access_recon_loss: 929223.6406; val_global_loss: 22689867.0000; val_optim_loss: 22689867.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8942; val_auprc_score: 0.8588; val_best_acc_score: 0.8267; val_best_f1_score: 0.8374; train_kl_reg_loss: 86315.6630; train_edge_recon_loss: 634783.8191; train_gene_expr_recon_loss: 20449473.6970; train_masked_gp_l1_reg_loss: 106407.2286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134643.6722; train_chrom_access_recon_loss: 919304.7064; train_global_loss: 22330928.8788; train_optim_loss: 22330928.8788; val_kl_reg_loss: 88707.1260; val_edge_recon_loss: 635458.0156; val_gene_expr_recon_loss: 20534904.0000; val_masked_gp_l1_reg_loss: 108016.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125861.5156; val_chrom_access_recon_loss: 930872.3750; val_global_loss: 22423819.5000; val_optim_loss: 22423819.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9001; val_auprc_score: 0.8696; val_best_acc_score: 0.8302; val_best_f1_score: 0.8468; train_kl_reg_loss: 86505.1216; train_edge_recon_loss: 624435.2983; train_gene_expr_recon_loss: 20379920.1818; train_masked_gp_l1_reg_loss: 109101.0096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119266.1437; train_chrom_access_recon_loss: 916704.2737; train_global_loss: 22235932.1818; train_optim_loss: 22235932.1818; val_kl_reg_loss: 83430.8535; val_edge_recon_loss: 626282.8203; val_gene_expr_recon_loss: 20349755.0000; val_masked_gp_l1_reg_loss: 110343.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113860.3828; val_chrom_access_recon_loss: 913751.3359; val_global_loss: 22197424.2500; val_optim_loss: 22197424.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8981; val_auprc_score: 0.8624; val_best_acc_score: 0.8345; val_best_f1_score: 0.8463; train_kl_reg_loss: 84697.5323; train_edge_recon_loss: 620249.8883; train_gene_expr_recon_loss: 20281889.9091; train_masked_gp_l1_reg_loss: 111054.4473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109532.4227; train_chrom_access_recon_loss: 913171.4905; train_global_loss: 22120595.6364; train_optim_loss: 22120595.6364; val_kl_reg_loss: 81597.3467; val_edge_recon_loss: 627613.0000; val_gene_expr_recon_loss: 20487586.2500; val_masked_gp_l1_reg_loss: 112005.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106079.7031; val_chrom_access_recon_loss: 922439.3594; val_global_loss: 22337322.0000; val_optim_loss: 22337322.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9013; val_auprc_score: 0.8689; val_best_acc_score: 0.8313; val_best_f1_score: 0.8443; train_kl_reg_loss: 82588.2944; train_edge_recon_loss: 617591.0492; train_gene_expr_recon_loss: 20193160.6061; train_masked_gp_l1_reg_loss: 112579.0384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102601.8879; train_chrom_access_recon_loss: 908856.7945; train_global_loss: 22017377.7273; train_optim_loss: 22017377.7273; val_kl_reg_loss: 81805.0449; val_edge_recon_loss: 625247.1172; val_gene_expr_recon_loss: 20424089.7500; val_masked_gp_l1_reg_loss: 113158.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100182.2578; val_chrom_access_recon_loss: 917130.3594; val_global_loss: 22261612.5000; val_optim_loss: 22261612.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9055; val_auprc_score: 0.8711; val_best_acc_score: 0.8431; val_best_f1_score: 0.8519; train_kl_reg_loss: 82429.7995; train_edge_recon_loss: 613595.9489; train_gene_expr_recon_loss: 20128341.9091; train_masked_gp_l1_reg_loss: 113834.9497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98016.1149; train_chrom_access_recon_loss: 906011.3684; train_global_loss: 21942229.9394; train_optim_loss: 21942229.9394; val_kl_reg_loss: 82180.0400; val_edge_recon_loss: 616103.7500; val_gene_expr_recon_loss: 20345593.2500; val_masked_gp_l1_reg_loss: 114352.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96040.3672; val_chrom_access_recon_loss: 923720.2500; val_global_loss: 22177990.0000; val_optim_loss: 22177990.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9070; val_auprc_score: 0.8813; val_best_acc_score: 0.8412; val_best_f1_score: 0.8546; train_kl_reg_loss: 80527.9906; train_edge_recon_loss: 611790.5625; train_gene_expr_recon_loss: 20046490.3333; train_masked_gp_l1_reg_loss: 115091.1063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95008.2205; train_chrom_access_recon_loss: 902882.0682; train_global_loss: 21851790.3636; train_optim_loss: 21851790.3636; val_kl_reg_loss: 78181.8037; val_edge_recon_loss: 616230.1484; val_gene_expr_recon_loss: 20288072.2500; val_masked_gp_l1_reg_loss: 115606.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94813.1953; val_chrom_access_recon_loss: 910822.6172; val_global_loss: 22103726.5000; val_optim_loss: 22103726.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9165; val_auprc_score: 0.8867; val_best_acc_score: 0.8533; val_best_f1_score: 0.8620; train_kl_reg_loss: 79426.3865; train_edge_recon_loss: 609796.6837; train_gene_expr_recon_loss: 19973469.3030; train_masked_gp_l1_reg_loss: 116015.3807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93925.8352; train_chrom_access_recon_loss: 899524.6373; train_global_loss: 21772158.3333; train_optim_loss: 21772158.3333; val_kl_reg_loss: 80734.8379; val_edge_recon_loss: 609314.5469; val_gene_expr_recon_loss: 20079835.7500; val_masked_gp_l1_reg_loss: 116841.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94355.6719; val_chrom_access_recon_loss: 906013.4453; val_global_loss: 21887097.0000; val_optim_loss: 21887097.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9123; val_auprc_score: 0.8814; val_best_acc_score: 0.8495; val_best_f1_score: 0.8595; train_kl_reg_loss: 78608.7044; train_edge_recon_loss: 607148.9555; train_gene_expr_recon_loss: 19892601.5152; train_masked_gp_l1_reg_loss: 116911.6944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94026.3407; train_chrom_access_recon_loss: 896566.0142; train_global_loss: 21685863.3939; train_optim_loss: 21685863.3939; val_kl_reg_loss: 78334.4629; val_edge_recon_loss: 614343.4375; val_gene_expr_recon_loss: 19919657.0000; val_masked_gp_l1_reg_loss: 117511.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93461.2969; val_chrom_access_recon_loss: 896593.4219; val_global_loss: 21719902.0000; val_optim_loss: 21719902.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9212; val_auprc_score: 0.8975; val_best_acc_score: 0.8509; val_best_f1_score: 0.8632; train_kl_reg_loss: 77911.1692; train_edge_recon_loss: 605798.3153; train_gene_expr_recon_loss: 19851303.6970; train_masked_gp_l1_reg_loss: 117756.4345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93258.4261; train_chrom_access_recon_loss: 894655.4820; train_global_loss: 21640683.2121; train_optim_loss: 21640683.2121; val_kl_reg_loss: 77006.4336; val_edge_recon_loss: 609353.5234; val_gene_expr_recon_loss: 20115917.0000; val_masked_gp_l1_reg_loss: 118483.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93039.7188; val_chrom_access_recon_loss: 906294.9531; val_global_loss: 21920095.7500; val_optim_loss: 21920095.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9264; val_auprc_score: 0.9064; val_best_acc_score: 0.8584; val_best_f1_score: 0.8672; train_kl_reg_loss: 76849.1564; train_edge_recon_loss: 605677.9697; train_gene_expr_recon_loss: 19780606.0000; train_masked_gp_l1_reg_loss: 118512.5263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92291.9884; train_chrom_access_recon_loss: 891886.7197; train_global_loss: 21565824.4848; train_optim_loss: 21565824.4848; val_kl_reg_loss: 78018.4053; val_edge_recon_loss: 603329.6094; val_gene_expr_recon_loss: 19951229.7500; val_masked_gp_l1_reg_loss: 118797.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91800.4297; val_chrom_access_recon_loss: 904056.2969; val_global_loss: 21747232.7500; val_optim_loss: 21747232.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9280; val_auprc_score: 0.9055; val_best_acc_score: 0.8667; val_best_f1_score: 0.8744; train_kl_reg_loss: 76233.9794; train_edge_recon_loss: 603046.6837; train_gene_expr_recon_loss: 19734258.5152; train_masked_gp_l1_reg_loss: 119335.6732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91285.7111; train_chrom_access_recon_loss: 889782.9148; train_global_loss: 21513943.2121; train_optim_loss: 21513943.2121; val_kl_reg_loss: 77154.2520; val_edge_recon_loss: 603563.4844; val_gene_expr_recon_loss: 20004131.5000; val_masked_gp_l1_reg_loss: 119778.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91176.3047; val_chrom_access_recon_loss: 890311.9297; val_global_loss: 21786115.2500; val_optim_loss: 21786115.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9311; val_auprc_score: 0.9122; val_best_acc_score: 0.8667; val_best_f1_score: 0.8744; train_kl_reg_loss: 75563.8187; train_edge_recon_loss: 601986.2083; train_gene_expr_recon_loss: 19690006.6061; train_masked_gp_l1_reg_loss: 120139.2370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90365.0565; train_chrom_access_recon_loss: 887705.4394; train_global_loss: 21465766.5152; train_optim_loss: 21465766.5152; val_kl_reg_loss: 74903.2568; val_edge_recon_loss: 605132.3594; val_gene_expr_recon_loss: 20013096.2500; val_masked_gp_l1_reg_loss: 120614.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89750.4609; val_chrom_access_recon_loss: 893170.6641; val_global_loss: 21796666.5000; val_optim_loss: 21796666.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9324; val_auprc_score: 0.9131; val_best_acc_score: 0.8694; val_best_f1_score: 0.8767; train_kl_reg_loss: 75993.0318; train_edge_recon_loss: 600616.3646; train_gene_expr_recon_loss: 19647918.9091; train_masked_gp_l1_reg_loss: 115783.6340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67613.2298; train_chrom_access_recon_loss: 885327.2017; train_global_loss: 21393252.1515; train_optim_loss: 21393252.1515; val_kl_reg_loss: 77260.8105; val_edge_recon_loss: 604796.3750; val_gene_expr_recon_loss: 19868603.7500; val_masked_gp_l1_reg_loss: 113938.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61503.3281; val_chrom_access_recon_loss: 885988.1328; val_global_loss: 21612090.7500; val_optim_loss: 21612090.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9330; val_auprc_score: 0.9119; val_best_acc_score: 0.8686; val_best_f1_score: 0.8770; train_kl_reg_loss: 76826.7170; train_edge_recon_loss: 600377.4962; train_gene_expr_recon_loss: 19639549.1818; train_masked_gp_l1_reg_loss: 113673.3440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60809.4344; train_chrom_access_recon_loss: 884919.5483; train_global_loss: 21376155.8788; train_optim_loss: 21376155.8788; val_kl_reg_loss: 78194.1553; val_edge_recon_loss: 601343.8672; val_gene_expr_recon_loss: 19858454.0000; val_masked_gp_l1_reg_loss: 113550.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60317.1172; val_chrom_access_recon_loss: 899008.1328; val_global_loss: 21610868.2500; val_optim_loss: 21610868.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9379; val_auprc_score: 0.9223; val_best_acc_score: 0.8726; val_best_f1_score: 0.8793; train_kl_reg_loss: 76977.0246; train_edge_recon_loss: 599331.3845; train_gene_expr_recon_loss: 19610423.6061; train_masked_gp_l1_reg_loss: 113475.4458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59946.3803; train_chrom_access_recon_loss: 883676.6714; train_global_loss: 21343830.3636; train_optim_loss: 21343830.3636; val_kl_reg_loss: 77916.2832; val_edge_recon_loss: 601653.4453; val_gene_expr_recon_loss: 19706636.5000; val_masked_gp_l1_reg_loss: 113453.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59685.3750; val_chrom_access_recon_loss: 886011.7188; val_global_loss: 21445357.7500; val_optim_loss: 21445357.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9280; val_auprc_score: 0.9029; val_best_acc_score: 0.8643; val_best_f1_score: 0.8733; train_kl_reg_loss: 77118.3112; train_edge_recon_loss: 598799.0322; train_gene_expr_recon_loss: 19613801.1212; train_masked_gp_l1_reg_loss: 113459.0488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59402.0581; train_chrom_access_recon_loss: 883524.6212; train_global_loss: 21346104.1818; train_optim_loss: 21346104.1818; val_kl_reg_loss: 78455.8105; val_edge_recon_loss: 604420.1250; val_gene_expr_recon_loss: 19991305.0000; val_masked_gp_l1_reg_loss: 113489.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59275.4453; val_chrom_access_recon_loss: 891485.3672; val_global_loss: 21738432.0000; val_optim_loss: 21738432.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9313; val_auprc_score: 0.9102; val_best_acc_score: 0.8657; val_best_f1_score: 0.8726; train_kl_reg_loss: 77531.0713; train_edge_recon_loss: 598132.1307; train_gene_expr_recon_loss: 19595758.2424; train_masked_gp_l1_reg_loss: 113492.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59043.5121; train_chrom_access_recon_loss: 883377.4375; train_global_loss: 21327334.3030; train_optim_loss: 21327334.3030; val_kl_reg_loss: 78028.4229; val_edge_recon_loss: 602282.8125; val_gene_expr_recon_loss: 19772571.5000; val_masked_gp_l1_reg_loss: 113540.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58754.6133; val_chrom_access_recon_loss: 899779.0234; val_global_loss: 21524955.5000; val_optim_loss: 21524955.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9330; val_auprc_score: 0.9090; val_best_acc_score: 0.8710; val_best_f1_score: 0.8780; train_kl_reg_loss: 77482.8968; train_edge_recon_loss: 598661.2604; train_gene_expr_recon_loss: 19607231.9394; train_masked_gp_l1_reg_loss: 113543.3964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58529.4202; train_chrom_access_recon_loss: 883512.7188; train_global_loss: 21338961.5758; train_optim_loss: 21338961.5758; val_kl_reg_loss: 77937.5029; val_edge_recon_loss: 606107.0625; val_gene_expr_recon_loss: 19803385.2500; val_masked_gp_l1_reg_loss: 113604.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58463.6523; val_chrom_access_recon_loss: 886766.8125; val_global_loss: 21546264.5000; val_optim_loss: 21546264.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9421; val_auprc_score: 0.9252; val_best_acc_score: 0.8775; val_best_f1_score: 0.8845; train_kl_reg_loss: 77564.9560; train_edge_recon_loss: 598331.7415; train_gene_expr_recon_loss: 19576512.8182; train_masked_gp_l1_reg_loss: 113618.5679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58286.8923; train_chrom_access_recon_loss: 882068.2907; train_global_loss: 21306383.2727; train_optim_loss: 21306383.2727; val_kl_reg_loss: 78321.8633; val_edge_recon_loss: 600678.2031; val_gene_expr_recon_loss: 19716258.2500; val_masked_gp_l1_reg_loss: 113659.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58076.7930; val_chrom_access_recon_loss: 885455.0234; val_global_loss: 21452449.5000; val_optim_loss: 21452449.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9304; val_auprc_score: 0.9016; val_best_acc_score: 0.8697; val_best_f1_score: 0.8761; train_kl_reg_loss: 80461.9875; train_edge_recon_loss: 701743.1903; train_gene_expr_recon_loss: 18828717.8485; train_masked_gp_l1_reg_loss: 113056.7546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55750.7901; train_chrom_access_recon_loss: 966278.0985; train_global_loss: 20746008.8485; train_optim_loss: 20746008.8485; val_kl_reg_loss: 33021.9731; val_edge_recon_loss: 703417.9141; val_gene_expr_recon_loss: 19070946.0000; val_masked_gp_l1_reg_loss: 112768.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54957.2539; val_chrom_access_recon_loss: 971712.5703; val_global_loss: 20946824.5000; val_optim_loss: 20946824.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9367; val_auprc_score: 0.9176; val_best_acc_score: 0.8743; val_best_f1_score: 0.8797; train_kl_reg_loss: 79446.9109; train_edge_recon_loss: 701708.7547; train_gene_expr_recon_loss: 18743926.2424; train_masked_gp_l1_reg_loss: 112713.9240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54727.2598; train_chrom_access_recon_loss: 938158.8513; train_global_loss: 20630681.6667; train_optim_loss: 20630681.6667; val_kl_reg_loss: 32586.3481; val_edge_recon_loss: 701043.3594; val_gene_expr_recon_loss: 18932289.7500; val_masked_gp_l1_reg_loss: 112676.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54528.3008; val_chrom_access_recon_loss: 940801.5781; val_global_loss: 20773925.0000; val_optim_loss: 20773925.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9355; val_auprc_score: 0.9126; val_best_acc_score: 0.8726; val_best_f1_score: 0.8796; train_kl_reg_loss: 78383.2403; train_edge_recon_loss: 700739.7775; train_gene_expr_recon_loss: 18728560.5758; train_masked_gp_l1_reg_loss: 112661.3516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54385.3667; train_chrom_access_recon_loss: 922323.0350; train_global_loss: 20597053.4242; train_optim_loss: 20597053.4242; val_kl_reg_loss: 32554.5056; val_edge_recon_loss: 702912.1172; val_gene_expr_recon_loss: 18977016.2500; val_masked_gp_l1_reg_loss: 112649.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54244.6562; val_chrom_access_recon_loss: 921011.1016; val_global_loss: 20800388.0000; val_optim_loss: 20800388.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9318; val_auprc_score: 0.9135; val_best_acc_score: 0.8616; val_best_f1_score: 0.8689; train_kl_reg_loss: 77531.7286; train_edge_recon_loss: 700304.3390; train_gene_expr_recon_loss: 18694547.6970; train_masked_gp_l1_reg_loss: 112642.9766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54144.6980; train_chrom_access_recon_loss: 909426.5663; train_global_loss: 20548598.0606; train_optim_loss: 20548598.0606; val_kl_reg_loss: 32547.3740; val_edge_recon_loss: 704702.3906; val_gene_expr_recon_loss: 18901955.2500; val_masked_gp_l1_reg_loss: 112630.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54046.2109; val_chrom_access_recon_loss: 912256.8125; val_global_loss: 20718137.7500; val_optim_loss: 20718137.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9376; val_auprc_score: 0.9158; val_best_acc_score: 0.8759; val_best_f1_score: 0.8806; train_kl_reg_loss: 77194.8923; train_edge_recon_loss: 698112.3845; train_gene_expr_recon_loss: 18717452.2424; train_masked_gp_l1_reg_loss: 112620.8885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53965.1475; train_chrom_access_recon_loss: 903220.6231; train_global_loss: 20562566.2424; train_optim_loss: 20562566.2424; val_kl_reg_loss: 33289.5859; val_edge_recon_loss: 701456.7812; val_gene_expr_recon_loss: 18977846.2500; val_masked_gp_l1_reg_loss: 112611.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53889.3672; val_chrom_access_recon_loss: 918295.6016; val_global_loss: 20797390.5000; val_optim_loss: 20797390.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9391; val_auprc_score: 0.9193; val_best_acc_score: 0.8748; val_best_f1_score: 0.8802; train_kl_reg_loss: 77710.5791; train_edge_recon_loss: 695559.4489; train_gene_expr_recon_loss: 18681513.1212; train_masked_gp_l1_reg_loss: 112602.8511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53833.0355; train_chrom_access_recon_loss: 895974.3873; train_global_loss: 20517193.6364; train_optim_loss: 20517193.6364; val_kl_reg_loss: 35716.6035; val_edge_recon_loss: 700152.6016; val_gene_expr_recon_loss: 19022374.5000; val_masked_gp_l1_reg_loss: 112588.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53772.2617; val_chrom_access_recon_loss: 906661.6094; val_global_loss: 20831265.2500; val_optim_loss: 20831265.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9385; val_auprc_score: 0.9161; val_best_acc_score: 0.8761; val_best_f1_score: 0.8808; train_kl_reg_loss: 78871.8073; train_edge_recon_loss: 692792.3759; train_gene_expr_recon_loss: 18680538.9091; train_masked_gp_l1_reg_loss: 112577.0059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53727.3938; train_chrom_access_recon_loss: 891641.3570; train_global_loss: 20510148.6061; train_optim_loss: 20510148.6061; val_kl_reg_loss: 36867.8672; val_edge_recon_loss: 699345.2969; val_gene_expr_recon_loss: 19046458.2500; val_masked_gp_l1_reg_loss: 112562.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53687.3945; val_chrom_access_recon_loss: 907494.6797; val_global_loss: 20856415.5000; val_optim_loss: 20856415.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9331; val_auprc_score: 0.9154; val_best_acc_score: 0.8662; val_best_f1_score: 0.8753; train_kl_reg_loss: 78985.0410; train_edge_recon_loss: 690788.8494; train_gene_expr_recon_loss: 18669691.8182; train_masked_gp_l1_reg_loss: 112545.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53645.4295; train_chrom_access_recon_loss: 886480.6117; train_global_loss: 20492136.8788; train_optim_loss: 20492136.8788; val_kl_reg_loss: 37603.5820; val_edge_recon_loss: 703831.0781; val_gene_expr_recon_loss: 18859965.2500; val_masked_gp_l1_reg_loss: 112523.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53612.3867; val_chrom_access_recon_loss: 896602.5547; val_global_loss: 20664138.5000; val_optim_loss: 20664138.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9333; val_auprc_score: 0.9164; val_best_acc_score: 0.8667; val_best_f1_score: 0.8732; train_kl_reg_loss: 78983.2157; train_edge_recon_loss: 688212.7907; train_gene_expr_recon_loss: 18683138.7879; train_masked_gp_l1_reg_loss: 112502.7124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53584.5788; train_chrom_access_recon_loss: 884598.5909; train_global_loss: 20501020.7273; train_optim_loss: 20501020.7273; val_kl_reg_loss: 38532.2383; val_edge_recon_loss: 702639.9688; val_gene_expr_recon_loss: 18791035.2500; val_masked_gp_l1_reg_loss: 112483.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53566.0469; val_chrom_access_recon_loss: 893820.7109; val_global_loss: 20592078.0000; val_optim_loss: 20592078.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9396; val_auprc_score: 0.9201; val_best_acc_score: 0.8775; val_best_f1_score: 0.8822; train_kl_reg_loss: 78469.3023; train_edge_recon_loss: 688804.1117; train_gene_expr_recon_loss: 18679731.9697; train_masked_gp_l1_reg_loss: 112458.7898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53542.4940; train_chrom_access_recon_loss: 881466.5909; train_global_loss: 20494473.1818; train_optim_loss: 20494473.1818; val_kl_reg_loss: 38323.2227; val_edge_recon_loss: 702067.2578; val_gene_expr_recon_loss: 18983155.7500; val_masked_gp_l1_reg_loss: 112431.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53519.8477; val_chrom_access_recon_loss: 895441.7344; val_global_loss: 20784939.7500; val_optim_loss: 20784939.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9329; val_auprc_score: 0.9187; val_best_acc_score: 0.8665; val_best_f1_score: 0.8728; train_kl_reg_loss: 77858.5399; train_edge_recon_loss: 688260.2623; train_gene_expr_recon_loss: 18670644.0303; train_masked_gp_l1_reg_loss: 112411.0324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53508.7538; train_chrom_access_recon_loss: 880471.5805; train_global_loss: 20483154.4545; train_optim_loss: 20483154.4545; val_kl_reg_loss: 38653.7334; val_edge_recon_loss: 704649.9844; val_gene_expr_recon_loss: 18846973.0000; val_masked_gp_l1_reg_loss: 112382.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53494.1797; val_chrom_access_recon_loss: 884695.8203; val_global_loss: 20640848.2500; val_optim_loss: 20640848.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9390; val_auprc_score: 0.9242; val_best_acc_score: 0.8718; val_best_f1_score: 0.8773; train_kl_reg_loss: 77506.0858; train_edge_recon_loss: 687822.8845; train_gene_expr_recon_loss: 18659380.0909; train_masked_gp_l1_reg_loss: 112357.8361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53480.2103; train_chrom_access_recon_loss: 876630.2311; train_global_loss: 20467177.4242; train_optim_loss: 20467177.4242; val_kl_reg_loss: 38664.9438; val_edge_recon_loss: 702013.4062; val_gene_expr_recon_loss: 18895153.0000; val_masked_gp_l1_reg_loss: 112330.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53467.2969; val_chrom_access_recon_loss: 877212.3438; val_global_loss: 20678842.0000; val_optim_loss: 20678842.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9309; val_auprc_score: 0.9092; val_best_acc_score: 0.8657; val_best_f1_score: 0.8738; train_kl_reg_loss: 77069.2833; train_edge_recon_loss: 688673.7292; train_gene_expr_recon_loss: 18662397.3030; train_masked_gp_l1_reg_loss: 112302.0527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53458.4841; train_chrom_access_recon_loss: 875325.1222; train_global_loss: 20469225.9091; train_optim_loss: 20469225.9091; val_kl_reg_loss: 39247.8315; val_edge_recon_loss: 702008.1406; val_gene_expr_recon_loss: 19067759.0000; val_masked_gp_l1_reg_loss: 112273.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53443.3438; val_chrom_access_recon_loss: 885080.4609; val_global_loss: 20859813.7500; val_optim_loss: 20859813.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9325; val_auprc_score: 0.9118; val_best_acc_score: 0.8670; val_best_f1_score: 0.8751; train_kl_reg_loss: 76804.9076; train_edge_recon_loss: 687276.8191; train_gene_expr_recon_loss: 18663672.0303; train_masked_gp_l1_reg_loss: 112241.5220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53313.4072; train_chrom_access_recon_loss: 874209.4053; train_global_loss: 20467518.1515; train_optim_loss: 20467518.1515; val_kl_reg_loss: 38983.9883; val_edge_recon_loss: 699895.6797; val_gene_expr_recon_loss: 18866964.7500; val_masked_gp_l1_reg_loss: 112225.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53283.8594; val_chrom_access_recon_loss: 878907.7031; val_global_loss: 20650261.5000; val_optim_loss: 20650261.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9297; val_auprc_score: 0.9091; val_best_acc_score: 0.8654; val_best_f1_score: 0.8736; train_kl_reg_loss: 76743.4396; train_edge_recon_loss: 687299.0739; train_gene_expr_recon_loss: 18665278.9091; train_masked_gp_l1_reg_loss: 112218.7412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53277.9072; train_chrom_access_recon_loss: 874283.0881; train_global_loss: 20469101.2727; train_optim_loss: 20469101.2727; val_kl_reg_loss: 39062.0879; val_edge_recon_loss: 701833.1172; val_gene_expr_recon_loss: 19027754.2500; val_masked_gp_l1_reg_loss: 112212.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53273.3867; val_chrom_access_recon_loss: 885318.5703; val_global_loss: 20819454.0000; val_optim_loss: 20819454.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9351; val_auprc_score: 0.9125; val_best_acc_score: 0.8710; val_best_f1_score: 0.8767; train_kl_reg_loss: 76643.5640; train_edge_recon_loss: 687652.6875; train_gene_expr_recon_loss: 18675701.1515; train_masked_gp_l1_reg_loss: 112207.3652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53269.9775; train_chrom_access_recon_loss: 874462.4366; train_global_loss: 20479937.3939; train_optim_loss: 20479937.3939; val_kl_reg_loss: 38936.5938; val_edge_recon_loss: 701220.0312; val_gene_expr_recon_loss: 18794044.7500; val_masked_gp_l1_reg_loss: 112202.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53266.7070; val_chrom_access_recon_loss: 886743.5391; val_global_loss: 20586412.7500; val_optim_loss: 20586412.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9334; val_auprc_score: 0.9113; val_best_acc_score: 0.8708; val_best_f1_score: 0.8764; train_kl_reg_loss: 76549.7469; train_edge_recon_loss: 688189.2263; train_gene_expr_recon_loss: 18663464.4848; train_masked_gp_l1_reg_loss: 112198.1149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53264.0994; train_chrom_access_recon_loss: 873721.9669; train_global_loss: 20467387.4242; train_optim_loss: 20467387.4242; val_kl_reg_loss: 38832.3862; val_edge_recon_loss: 700477.8594; val_gene_expr_recon_loss: 18949817.7500; val_masked_gp_l1_reg_loss: 112193.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53261.7109; val_chrom_access_recon_loss: 890591.8750; val_global_loss: 20745175.7500; val_optim_loss: 20745175.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9360; val_auprc_score: 0.9210; val_best_acc_score: 0.8689; val_best_f1_score: 0.8749; train_kl_reg_loss: 76429.6397; train_edge_recon_loss: 687951.5066; train_gene_expr_recon_loss: 18680685.0303; train_masked_gp_l1_reg_loss: 112190.5105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53260.3505; train_chrom_access_recon_loss: 874624.3258; train_global_loss: 20485141.2121; train_optim_loss: 20485141.2121; val_kl_reg_loss: 38934.7349; val_edge_recon_loss: 702474.4453; val_gene_expr_recon_loss: 18972741.5000; val_masked_gp_l1_reg_loss: 112186.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53258.5938; val_chrom_access_recon_loss: 889578.0312; val_global_loss: 20769172.7500; val_optim_loss: 20769172.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9353; val_auprc_score: 0.9193; val_best_acc_score: 0.8689; val_best_f1_score: 0.8749; train_kl_reg_loss: 76522.9998; train_edge_recon_loss: 687227.8958; train_gene_expr_recon_loss: 18656894.5152; train_masked_gp_l1_reg_loss: 112182.9356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53256.3404; train_chrom_access_recon_loss: 873288.1809; train_global_loss: 20459372.8788; train_optim_loss: 20459372.8788; val_kl_reg_loss: 38916.6768; val_edge_recon_loss: 705983.9688; val_gene_expr_recon_loss: 18776502.2500; val_masked_gp_l1_reg_loss: 112178.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53254.3164; val_chrom_access_recon_loss: 882571.0234; val_global_loss: 20569405.7500; val_optim_loss: 20569405.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9310; val_auprc_score: 0.9112; val_best_acc_score: 0.8635; val_best_f1_score: 0.8708; train_kl_reg_loss: 76451.9239; train_edge_recon_loss: 687532.9669; train_gene_expr_recon_loss: 18669468.1515; train_masked_gp_l1_reg_loss: 112174.6433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53252.7070; train_chrom_access_recon_loss: 872835.7405; train_global_loss: 20471715.9394; train_optim_loss: 20471715.9394; val_kl_reg_loss: 39007.6201; val_edge_recon_loss: 701278.3906; val_gene_expr_recon_loss: 18877498.7500; val_masked_gp_l1_reg_loss: 112170.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53250.6562; val_chrom_access_recon_loss: 880237.2188; val_global_loss: 20663442.2500; val_optim_loss: 20663442.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9370; val_auprc_score: 0.9211; val_best_acc_score: 0.8716; val_best_f1_score: 0.8793; train_kl_reg_loss: 76424.6606; train_edge_recon_loss: 687212.0947; train_gene_expr_recon_loss: 18658584.3030; train_masked_gp_l1_reg_loss: 112166.3172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53249.1018; train_chrom_access_recon_loss: 872734.6458; train_global_loss: 20460371.1212; train_optim_loss: 20460371.1212; val_kl_reg_loss: 39049.8906; val_edge_recon_loss: 702900.4531; val_gene_expr_recon_loss: 19034821.7500; val_masked_gp_l1_reg_loss: 112161.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53246.9219; val_chrom_access_recon_loss: 889951.4766; val_global_loss: 20832132.0000; val_optim_loss: 20832132.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9327; val_auprc_score: 0.9136; val_best_acc_score: 0.8686; val_best_f1_score: 0.8746; train_kl_reg_loss: 76385.1231; train_edge_recon_loss: 687652.9328; train_gene_expr_recon_loss: 18662159.7879; train_masked_gp_l1_reg_loss: 112157.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53245.7234; train_chrom_access_recon_loss: 872911.1411; train_global_loss: 20464512.6667; train_optim_loss: 20464512.6667; val_kl_reg_loss: 38979.9590; val_edge_recon_loss: 703766.2422; val_gene_expr_recon_loss: 18948034.7500; val_masked_gp_l1_reg_loss: 112153.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53244.1172; val_chrom_access_recon_loss: 886783.8750; val_global_loss: 20742962.2500; val_optim_loss: 20742962.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9340; val_auprc_score: 0.9128; val_best_acc_score: 0.8662; val_best_f1_score: 0.8726; train_kl_reg_loss: 76274.1838; train_edge_recon_loss: 688031.4981; train_gene_expr_recon_loss: 18663564.9091; train_masked_gp_l1_reg_loss: 112148.8821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53241.8125; train_chrom_access_recon_loss: 872384.8627; train_global_loss: 20465646.0303; train_optim_loss: 20465646.0303; val_kl_reg_loss: 38985.4688; val_edge_recon_loss: 704238.5938; val_gene_expr_recon_loss: 18927611.5000; val_masked_gp_l1_reg_loss: 112144.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53240.5312; val_chrom_access_recon_loss: 878349.3359; val_global_loss: 20714569.2500; val_optim_loss: 20714569.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9400; val_auprc_score: 0.9270; val_best_acc_score: 0.8726; val_best_f1_score: 0.8780; train_kl_reg_loss: 76298.0662; train_edge_recon_loss: 687529.6723; train_gene_expr_recon_loss: 18669853.5152; train_masked_gp_l1_reg_loss: 112140.9167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53227.4201; train_chrom_access_recon_loss: 873031.6960; train_global_loss: 20472081.3939; train_optim_loss: 20472081.3939; val_kl_reg_loss: 38939.8691; val_edge_recon_loss: 704058.6250; val_gene_expr_recon_loss: 18911208.2500; val_masked_gp_l1_reg_loss: 112139.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53224.5195; val_chrom_access_recon_loss: 886861.0391; val_global_loss: 20706431.7500; val_optim_loss: 20706431.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9383; val_auprc_score: 0.9232; val_best_acc_score: 0.8740; val_best_f1_score: 0.8793; train_kl_reg_loss: 76223.1886; train_edge_recon_loss: 687321.9403; train_gene_expr_recon_loss: 18668942.9091; train_masked_gp_l1_reg_loss: 112138.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53224.0239; train_chrom_access_recon_loss: 874028.7869; train_global_loss: 20471878.9394; train_optim_loss: 20471878.9394; val_kl_reg_loss: 38920.4565; val_edge_recon_loss: 700976.8438; val_gene_expr_recon_loss: 18951212.5000; val_masked_gp_l1_reg_loss: 112137.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53223.5781; val_chrom_access_recon_loss: 880240.7109; val_global_loss: 20736713.0000; val_optim_loss: 20736713.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9409; val_auprc_score: 0.9294; val_best_acc_score: 0.8686; val_best_f1_score: 0.8745; train_kl_reg_loss: 76306.9455; train_edge_recon_loss: 686942.0521; train_gene_expr_recon_loss: 18659431.4545; train_masked_gp_l1_reg_loss: 112136.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53223.1883; train_chrom_access_recon_loss: 871986.1989; train_global_loss: 20460027.0606; train_optim_loss: 20460027.0606; val_kl_reg_loss: 38991.7080; val_edge_recon_loss: 700828.3281; val_gene_expr_recon_loss: 18913286.7500; val_masked_gp_l1_reg_loss: 112136.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53222.8633; val_chrom_access_recon_loss: 884232.4766; val_global_loss: 20702697.2500; val_optim_loss: 20702697.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9305; val_auprc_score: 0.9035; val_best_acc_score: 0.8651; val_best_f1_score: 0.8716; train_kl_reg_loss: 76264.1587; train_edge_recon_loss: 686751.0085; train_gene_expr_recon_loss: 18671475.5455; train_masked_gp_l1_reg_loss: 112135.7240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53222.6869; train_chrom_access_recon_loss: 873272.3996; train_global_loss: 20473121.1515; train_optim_loss: 20473121.1515; val_kl_reg_loss: 39059.0547; val_edge_recon_loss: 701705.0703; val_gene_expr_recon_loss: 18959433.7500; val_masked_gp_l1_reg_loss: 112135.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53222.3672; val_chrom_access_recon_loss: 893240.5000; val_global_loss: 20758796.2500; val_optim_loss: 20758796.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 59 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9382
val AUPRC score: 0.9179
val best accuracy score: 0.8751
val best F1 score: 0.8825
val target rna MSE score: 2.1084
val source rna MSE score: 2.0836
val target atac MSE score: 0.5268
val source atac MSE score: 0.3145
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
