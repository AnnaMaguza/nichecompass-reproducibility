Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9671; val_auprc_score: 0.9806; val_best_acc_score: 0.9298; val_best_f1_score: 0.9494; train_kl_reg_loss: 28582.5348; train_edge_recon_loss: 1762684.1424; train_cat_covariates_contrastive_loss: 645266.7011; train_gene_expr_recon_loss: 1804567.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8754.2383; train_global_loss: 4249855.0157; train_optim_loss: 4249855.0157; val_kl_reg_loss: 21691.9175; val_edge_recon_loss: 1793873.7121; val_cat_covariates_contrastive_loss: 644065.2907; val_gene_expr_recon_loss: 1838606.9867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8588.8438; val_global_loss: 4306826.9129; val_optim_loss: 4306826.9129
[True, False]
Run timestamp: 02092023_144142_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '5000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 126882
Number of validation nodes: 14098
Number of training edges: 300588
Number of validation edges: 33398
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8707; val_auprc_score: 0.9338; val_best_acc_score: 0.8141; val_best_f1_score: 0.8721; train_kl_reg_loss: 21282.5512; train_edge_recon_loss: 2095092.3410; train_cat_covariates_contrastive_loss: 3176331.7993; train_gene_expr_recon_loss: 3032750.2236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 191473.6078; train_global_loss: 8516930.5255; train_optim_loss: 8516930.5255; val_kl_reg_loss: 17710.0567; val_edge_recon_loss: 1929200.2879; val_cat_covariates_contrastive_loss: 3151854.5644; val_gene_expr_recon_loss: 2811049.5644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10126.3652; val_global_loss: 7919941.0303; val_optim_loss: 7919941.0303
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9653; val_auprc_score: 0.9788; val_best_acc_score: 0.9298; val_best_f1_score: 0.9497; train_kl_reg_loss: 26367.9857; train_edge_recon_loss: 1761451.0965; train_cat_covariates_contrastive_loss: 642230.4172; train_gene_expr_recon_loss: 1797354.1486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8501.8871; train_global_loss: 4235905.5438; train_optim_loss: 4235905.5438; val_kl_reg_loss: 23858.4486; val_edge_recon_loss: 1793594.5985; val_cat_covariates_contrastive_loss: 639739.5038; val_gene_expr_recon_loss: 1838826.5379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8432.8604; val_global_loss: 4304452.1061; val_optim_loss: 4304452.1061
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9068; val_auprc_score: 0.9492; val_best_acc_score: 0.8558; val_best_f1_score: 0.8992; train_kl_reg_loss: 16100.0823; train_edge_recon_loss: 1827612.6699; train_cat_covariates_contrastive_loss: 3153006.5077; train_gene_expr_recon_loss: 2752926.1437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8758.7304; train_global_loss: 7758404.1276; train_optim_loss: 7758404.1276; val_kl_reg_loss: 15925.8020; val_edge_recon_loss: 1873196.8182; val_cat_covariates_contrastive_loss: 3150581.1402; val_gene_expr_recon_loss: 2705497.2841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8088.1035; val_global_loss: 7753289.0076; val_optim_loss: 7753289.0076
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9645; val_auprc_score: 0.9789; val_best_acc_score: 0.9265; val_best_f1_score: 0.9472; train_kl_reg_loss: 25346.6291; train_edge_recon_loss: 1762753.7940; train_cat_covariates_contrastive_loss: 641543.7233; train_gene_expr_recon_loss: 1790588.7313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8392.5043; train_global_loss: 4228625.3814; train_optim_loss: 4228625.3814; val_kl_reg_loss: 23650.7276; val_edge_recon_loss: 1806472.7178; val_cat_covariates_contrastive_loss: 640460.6259; val_gene_expr_recon_loss: 1825274.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8339.7275; val_global_loss: 4304197.9242; val_optim_loss: 4304197.9242
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9169; val_auprc_score: 0.9538; val_best_acc_score: 0.8697; val_best_f1_score: 0.9085; train_kl_reg_loss: 15785.9808; train_edge_recon_loss: 1808355.1949; train_cat_covariates_contrastive_loss: 3150629.6969; train_gene_expr_recon_loss: 2659465.9851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8081.3696; train_global_loss: 7642318.2296; train_optim_loss: 7642318.2296; val_kl_reg_loss: 16890.2532; val_edge_recon_loss: 1862794.5871; val_cat_covariates_contrastive_loss: 3149862.5303; val_gene_expr_recon_loss: 2618293.3674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8008.4409; val_global_loss: 7655849.2121; val_optim_loss: 7655849.2121
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9299; val_auprc_score: 0.9605; val_best_acc_score: 0.8806; val_best_f1_score: 0.9156; train_kl_reg_loss: 18067.9106; train_edge_recon_loss: 1791051.0546; train_cat_covariates_contrastive_loss: 3150460.5077; train_gene_expr_recon_loss: 2575653.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7944.3595; train_global_loss: 7543177.3435; train_optim_loss: 7543177.3435; val_kl_reg_loss: 19186.8406; val_edge_recon_loss: 1854109.5284; val_cat_covariates_contrastive_loss: 3151631.0530; val_gene_expr_recon_loss: 2532546.5114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7885.1562; val_global_loss: 7565358.8939; val_optim_loss: 7565358.8939
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9652; val_auprc_score: 0.9791; val_best_acc_score: 0.9275; val_best_f1_score: 0.9478; train_kl_reg_loss: 25059.8224; train_edge_recon_loss: 1758668.8506; train_cat_covariates_contrastive_loss: 641276.7451; train_gene_expr_recon_loss: 1787584.9726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8365.3608; train_global_loss: 4220955.7504; train_optim_loss: 4220955.7504; val_kl_reg_loss: 23412.4325; val_edge_recon_loss: 1799849.9186; val_cat_covariates_contrastive_loss: 641371.6667; val_gene_expr_recon_loss: 1835352.9962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8345.7832; val_global_loss: 4308333.0000; val_optim_loss: 4308333.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9262; val_auprc_score: 0.9572; val_best_acc_score: 0.8800; val_best_f1_score: 0.9142; train_kl_reg_loss: 20832.1773; train_edge_recon_loss: 1793339.9466; train_cat_covariates_contrastive_loss: 3154335.2364; train_gene_expr_recon_loss: 2472262.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7889.0930; train_global_loss: 7448659.2066; train_optim_loss: 7448659.2066; val_kl_reg_loss: 23293.5205; val_edge_recon_loss: 1869121.5076; val_cat_covariates_contrastive_loss: 3150079.4432; val_gene_expr_recon_loss: 2415317.3902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7806.4883; val_global_loss: 7465618.3030; val_optim_loss: 7465618.3030
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9716; val_auprc_score: 0.9833; val_best_acc_score: 0.9321; val_best_f1_score: 0.9510; train_kl_reg_loss: 25643.8978; train_edge_recon_loss: 1760511.9188; train_cat_covariates_contrastive_loss: 641525.5152; train_gene_expr_recon_loss: 1786716.7268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8349.6977; train_global_loss: 4222747.7577; train_optim_loss: 4222747.7577; val_kl_reg_loss: 23205.8848; val_edge_recon_loss: 1795761.9848; val_cat_covariates_contrastive_loss: 647906.8087; val_gene_expr_recon_loss: 1825981.6553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8307.2637; val_global_loss: 4301163.8409; val_optim_loss: 4301163.8409
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9317; val_auprc_score: 0.9610; val_best_acc_score: 0.8862; val_best_f1_score: 0.9194; train_kl_reg_loss: 23433.6693; train_edge_recon_loss: 1782491.0304; train_cat_covariates_contrastive_loss: 3154824.4524; train_gene_expr_recon_loss: 2356562.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8078.5036; train_global_loss: 7325390.5944; train_optim_loss: 7325390.5944; val_kl_reg_loss: 23774.1248; val_edge_recon_loss: 1832109.9375; val_cat_covariates_contrastive_loss: 3155398.5568; val_gene_expr_recon_loss: 2300243.9811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8260.1035; val_global_loss: 7319786.6364; val_optim_loss: 7319786.6364
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9394; val_auprc_score: 0.9647; val_best_acc_score: 0.8951; val_best_f1_score: 0.9254; train_kl_reg_loss: 25215.8021; train_edge_recon_loss: 1786808.6847; train_cat_covariates_contrastive_loss: 3155796.4264; train_gene_expr_recon_loss: 2260407.8087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8291.7584; train_global_loss: 7236520.4779; train_optim_loss: 7236520.4779; val_kl_reg_loss: 25595.5110; val_edge_recon_loss: 1836732.6780; val_cat_covariates_contrastive_loss: 3155808.8485; val_gene_expr_recon_loss: 2225623.1970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8329.8340; val_global_loss: 7252090.2424; val_optim_loss: 7252090.2424
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9667; val_auprc_score: 0.9803; val_best_acc_score: 0.9279; val_best_f1_score: 0.9483; train_kl_reg_loss: 25715.6484; train_edge_recon_loss: 1760910.1303; train_cat_covariates_contrastive_loss: 640933.8270; train_gene_expr_recon_loss: 1778459.5468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8348.4222; train_global_loss: 4214367.5808; train_optim_loss: 4214367.5808; val_kl_reg_loss: 24581.5209; val_edge_recon_loss: 1786657.6667; val_cat_covariates_contrastive_loss: 641267.0795; val_gene_expr_recon_loss: 1819450.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8320.8643; val_global_loss: 4280277.8144; val_optim_loss: 4280277.8144
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9421; val_auprc_score: 0.9659; val_best_acc_score: 0.8997; val_best_f1_score: 0.9286; train_kl_reg_loss: 26645.9493; train_edge_recon_loss: 1779462.4260; train_cat_covariates_contrastive_loss: 3156007.9435; train_gene_expr_recon_loss: 2189561.5334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8441.9061; train_global_loss: 7160119.7789; train_optim_loss: 7160119.7789; val_kl_reg_loss: 27022.6405; val_edge_recon_loss: 1827643.1458; val_cat_covariates_contrastive_loss: 3158056.9432; val_gene_expr_recon_loss: 2168215.0530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8433.2900; val_global_loss: 7189371.2652; val_optim_loss: 7189371.2652
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9673; val_auprc_score: 0.9809; val_best_acc_score: 0.9298; val_best_f1_score: 0.9495; train_kl_reg_loss: 25363.9981; train_edge_recon_loss: 1762096.7842; train_cat_covariates_contrastive_loss: 641570.6642; train_gene_expr_recon_loss: 1779637.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8348.0001; train_global_loss: 4217017.0761; train_optim_loss: 4217017.0761; val_kl_reg_loss: 24249.9940; val_edge_recon_loss: 1793715.3617; val_cat_covariates_contrastive_loss: 642672.5483; val_gene_expr_recon_loss: 1823980.0152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8286.4961; val_global_loss: 4292904.4356; val_optim_loss: 4292904.4356
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9385; val_auprc_score: 0.9634; val_best_acc_score: 0.8989; val_best_f1_score: 0.9282; train_kl_reg_loss: 27201.9360; train_edge_recon_loss: 1782895.4528; train_cat_covariates_contrastive_loss: 3155412.8941; train_gene_expr_recon_loss: 2134009.3197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8518.8254; train_global_loss: 7108038.4422; train_optim_loss: 7108038.4422; val_kl_reg_loss: 28363.3755; val_edge_recon_loss: 1821916.3409; val_cat_covariates_contrastive_loss: 3152959.8258; val_gene_expr_recon_loss: 2126562.2652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8606.5361; val_global_loss: 7138408.2879; val_optim_loss: 7138408.2879
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9673; val_auprc_score: 0.9803; val_best_acc_score: 0.9292; val_best_f1_score: 0.9489; train_kl_reg_loss: 25310.6966; train_edge_recon_loss: 1759071.2953; train_cat_covariates_contrastive_loss: 641107.9759; train_gene_expr_recon_loss: 1767378.3499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8313.0166; train_global_loss: 4201181.3316; train_optim_loss: 4201181.3316; val_kl_reg_loss: 23652.7252; val_edge_recon_loss: 1795157.6326; val_cat_covariates_contrastive_loss: 644371.0975; val_gene_expr_recon_loss: 1809436.9280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8313.2002; val_global_loss: 4280931.4167; val_optim_loss: 4280931.4167
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9450; val_auprc_score: 0.9667; val_best_acc_score: 0.9062; val_best_f1_score: 0.9330; train_kl_reg_loss: 27954.1975; train_edge_recon_loss: 1779995.9734; train_cat_covariates_contrastive_loss: 3155426.5404; train_gene_expr_recon_loss: 2090339.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8585.8767; train_global_loss: 7062302.0952; train_optim_loss: 7062302.0952; val_kl_reg_loss: 27238.4135; val_edge_recon_loss: 1814606.7348; val_cat_covariates_contrastive_loss: 3156934.5000; val_gene_expr_recon_loss: 2093763.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8736.4170; val_global_loss: 7101279.9470; val_optim_loss: 7101279.9470
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9386; val_auprc_score: 0.9636; val_best_acc_score: 0.8976; val_best_f1_score: 0.9265; train_kl_reg_loss: 28381.0743; train_edge_recon_loss: 1778622.6031; train_cat_covariates_contrastive_loss: 3155265.4337; train_gene_expr_recon_loss: 2060883.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8623.0541; train_global_loss: 7031775.2347; train_optim_loss: 7031775.2347; val_kl_reg_loss: 29723.8736; val_edge_recon_loss: 1829141.4924; val_cat_covariates_contrastive_loss: 3152849.7803; val_gene_expr_recon_loss: 2068077.4830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8590.6719; val_global_loss: 7088383.0758; val_optim_loss: 7088383.0758
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9698; val_auprc_score: 0.9821; val_best_acc_score: 0.9306; val_best_f1_score: 0.9499; train_kl_reg_loss: 25423.2483; train_edge_recon_loss: 1760522.4088; train_cat_covariates_contrastive_loss: 640984.0092; train_gene_expr_recon_loss: 1767794.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8312.0347; train_global_loss: 4203036.3219; train_optim_loss: 4203036.3219; val_kl_reg_loss: 24175.1036; val_edge_recon_loss: 1793624.3087; val_cat_covariates_contrastive_loss: 645307.6705; val_gene_expr_recon_loss: 1813995.4337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8284.9336; val_global_loss: 4285387.5114; val_optim_loss: 4285387.5114
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9469; val_auprc_score: 0.9677; val_best_acc_score: 0.9108; val_best_f1_score: 0.9365; train_kl_reg_loss: 28933.1769; train_edge_recon_loss: 1772755.1518; train_cat_covariates_contrastive_loss: 3155011.6909; train_gene_expr_recon_loss: 2034031.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8656.6375; train_global_loss: 6999388.2577; train_optim_loss: 6999388.2577; val_kl_reg_loss: 29443.9944; val_edge_recon_loss: 1802407.2424; val_cat_covariates_contrastive_loss: 3153431.6061; val_gene_expr_recon_loss: 2043668.9148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8589.6172; val_global_loss: 7037541.2652; val_optim_loss: 7037541.2652
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9681; val_auprc_score: 0.9808; val_best_acc_score: 0.9303; val_best_f1_score: 0.9499; train_kl_reg_loss: 25771.8968; train_edge_recon_loss: 1760606.8652; train_cat_covariates_contrastive_loss: 640366.4070; train_gene_expr_recon_loss: 1764864.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8271.5251; train_global_loss: 4199880.8954; train_optim_loss: 4199880.8954; val_kl_reg_loss: 24063.6220; val_edge_recon_loss: 1790981.2424; val_cat_covariates_contrastive_loss: 645328.6771; val_gene_expr_recon_loss: 1809878.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8232.5000; val_global_loss: 4278484.9394; val_optim_loss: 4278484.9394
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9450; val_auprc_score: 0.9670; val_best_acc_score: 0.9049; val_best_f1_score: 0.9308; train_kl_reg_loss: 29411.1369; train_edge_recon_loss: 1774336.1590; train_cat_covariates_contrastive_loss: 3155242.1841; train_gene_expr_recon_loss: 2013609.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8713.7297; train_global_loss: 6981312.5408; train_optim_loss: 6981312.5408; val_kl_reg_loss: 29141.3429; val_edge_recon_loss: 1831907.1023; val_cat_covariates_contrastive_loss: 3154924.6288; val_gene_expr_recon_loss: 2027376.1894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8812.0107; val_global_loss: 7052161.2727; val_optim_loss: 7052161.2727
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9528; val_auprc_score: 0.9709; val_best_acc_score: 0.9160; val_best_f1_score: 0.9399; train_kl_reg_loss: 29736.8102; train_edge_recon_loss: 1773940.7207; train_cat_covariates_contrastive_loss: 3154951.2011; train_gene_expr_recon_loss: 1999753.0608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8777.6582; train_global_loss: 6967159.4643; train_optim_loss: 6967159.4643; val_kl_reg_loss: 27864.2251; val_edge_recon_loss: 1815515.0398; val_cat_covariates_contrastive_loss: 3162069.3977; val_gene_expr_recon_loss: 2012453.9053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8949.4463; val_global_loss: 7026852.0758; val_optim_loss: 7026852.0758
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9691; val_auprc_score: 0.9811; val_best_acc_score: 0.9324; val_best_f1_score: 0.9513; train_kl_reg_loss: 25400.8724; train_edge_recon_loss: 1760397.9360; train_cat_covariates_contrastive_loss: 641040.7402; train_gene_expr_recon_loss: 1755378.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8218.5698; train_global_loss: 4190436.7878; train_optim_loss: 4190436.7878; val_kl_reg_loss: 24716.1360; val_edge_recon_loss: 1797124.0152; val_cat_covariates_contrastive_loss: 642281.8229; val_gene_expr_recon_loss: 1810116.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8203.9326; val_global_loss: 4282442.0000; val_optim_loss: 4282442.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9494; val_auprc_score: 0.9690; val_best_acc_score: 0.9130; val_best_f1_score: 0.9379; train_kl_reg_loss: 29692.3518; train_edge_recon_loss: 1771057.4384; train_cat_covariates_contrastive_loss: 3154911.2321; train_gene_expr_recon_loss: 1986211.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8804.4042; train_global_loss: 6950676.6939; train_optim_loss: 6950676.6939; val_kl_reg_loss: 30393.0275; val_edge_recon_loss: 1800846.0170; val_cat_covariates_contrastive_loss: 3155871.2538; val_gene_expr_recon_loss: 2001659.8712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8937.2422; val_global_loss: 6997707.1288; val_optim_loss: 6997707.1288
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9665; val_auprc_score: 0.9792; val_best_acc_score: 0.9305; val_best_f1_score: 0.9499; train_kl_reg_loss: 25408.7140; train_edge_recon_loss: 1762960.5774; train_cat_covariates_contrastive_loss: 640556.6137; train_gene_expr_recon_loss: 1754314.3491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8192.2930; train_global_loss: 4191432.5485; train_optim_loss: 4191432.5485; val_kl_reg_loss: 25964.2816; val_edge_recon_loss: 1792648.3106; val_cat_covariates_contrastive_loss: 639421.6383; val_gene_expr_recon_loss: 1809766.2765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8180.6670; val_global_loss: 4275981.0795; val_optim_loss: 4275981.0795
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9506; val_auprc_score: 0.9690; val_best_acc_score: 0.9136; val_best_f1_score: 0.9379; train_kl_reg_loss: 29804.4149; train_edge_recon_loss: 1772041.0427; train_cat_covariates_contrastive_loss: 3153901.0051; train_gene_expr_recon_loss: 1974819.9577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8832.1451; train_global_loss: 6939398.5638; train_optim_loss: 6939398.5638; val_kl_reg_loss: 28870.2704; val_edge_recon_loss: 1811470.9034; val_cat_covariates_contrastive_loss: 3155032.1667; val_gene_expr_recon_loss: 1994792.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8759.1123; val_global_loss: 6998924.9773; val_optim_loss: 6998924.9773
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9631; val_auprc_score: 0.9773; val_best_acc_score: 0.9292; val_best_f1_score: 0.9491; train_kl_reg_loss: 25518.7606; train_edge_recon_loss: 1759216.8376; train_cat_covariates_contrastive_loss: 640414.4149; train_gene_expr_recon_loss: 1750147.1926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8169.6702; train_global_loss: 4183466.8827; train_optim_loss: 4183466.8827; val_kl_reg_loss: 25852.4377; val_edge_recon_loss: 1807970.7273; val_cat_covariates_contrastive_loss: 639989.4744; val_gene_expr_recon_loss: 1791407.2462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8171.5400; val_global_loss: 4273391.3902; val_optim_loss: 4273391.3902
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9516; val_auprc_score: 0.9703; val_best_acc_score: 0.9158; val_best_f1_score: 0.9395; train_kl_reg_loss: 29747.2449; train_edge_recon_loss: 1772934.7477; train_cat_covariates_contrastive_loss: 3154129.9099; train_gene_expr_recon_loss: 1965620.9296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8826.4943; train_global_loss: 6931259.3265; train_optim_loss: 6931259.3265; val_kl_reg_loss: 30283.1850; val_edge_recon_loss: 1818927.3845; val_cat_covariates_contrastive_loss: 3156212.8977; val_gene_expr_recon_loss: 1988090.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8866.2500; val_global_loss: 7002380.1970; val_optim_loss: 7002380.1970
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9535; val_auprc_score: 0.9744; val_best_acc_score: 0.9125; val_best_f1_score: 0.9365; train_kl_reg_loss: 29991.3828; train_edge_recon_loss: 1771294.4705; train_cat_covariates_contrastive_loss: 3155703.6820; train_gene_expr_recon_loss: 1957194.4928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8855.2393; train_global_loss: 6923039.2466; train_optim_loss: 6923039.2466; val_kl_reg_loss: 27084.9774; val_edge_recon_loss: 1833084.5701; val_cat_covariates_contrastive_loss: 3171333.1856; val_gene_expr_recon_loss: 1987092.5549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8779.5166; val_global_loss: 7027374.7500; val_optim_loss: 7027374.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9657; val_auprc_score: 0.9793; val_best_acc_score: 0.9291; val_best_f1_score: 0.9490; train_kl_reg_loss: 25324.9194; train_edge_recon_loss: 1755138.4222; train_cat_covariates_contrastive_loss: 640246.9813; train_gene_expr_recon_loss: 1744494.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8171.7242; train_global_loss: 4173376.5247; train_optim_loss: 4173376.5247; val_kl_reg_loss: 25399.0999; val_edge_recon_loss: 1798255.8939; val_cat_covariates_contrastive_loss: 640939.3996; val_gene_expr_recon_loss: 1792581.8769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8145.1294; val_global_loss: 4265321.2992; val_optim_loss: 4265321.2992
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9505; val_auprc_score: 0.9689; val_best_acc_score: 0.9172; val_best_f1_score: 0.9405; train_kl_reg_loss: 30436.8992; train_edge_recon_loss: 1770544.7949; train_cat_covariates_contrastive_loss: 3154611.0009; train_gene_expr_recon_loss: 1952735.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8878.3371; train_global_loss: 6917206.9830; train_optim_loss: 6917206.9830; val_kl_reg_loss: 30246.4498; val_edge_recon_loss: 1819029.9621; val_cat_covariates_contrastive_loss: 3155294.8068; val_gene_expr_recon_loss: 1970266.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8916.2109; val_global_loss: 6983753.5606; val_optim_loss: 6983753.5606
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9641; val_auprc_score: 0.9774; val_best_acc_score: 0.9308; val_best_f1_score: 0.9502; train_kl_reg_loss: 25406.4097; train_edge_recon_loss: 1755916.3650; train_cat_covariates_contrastive_loss: 640280.8373; train_gene_expr_recon_loss: 1738510.6907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8155.6528; train_global_loss: 4168269.9605; train_optim_loss: 4168269.9605; val_kl_reg_loss: 26598.6006; val_edge_recon_loss: 1800819.2500; val_cat_covariates_contrastive_loss: 638204.1515; val_gene_expr_recon_loss: 1787862.2462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8164.4448; val_global_loss: 4261648.7083; val_optim_loss: 4261648.7083
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9545; val_auprc_score: 0.9718; val_best_acc_score: 0.9181; val_best_f1_score: 0.9409; train_kl_reg_loss: 30211.9998; train_edge_recon_loss: 1764976.4469; train_cat_covariates_contrastive_loss: 3153812.9847; train_gene_expr_recon_loss: 1940610.7192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8952.2667; train_global_loss: 6898564.3980; train_optim_loss: 6898564.3980; val_kl_reg_loss: 29158.7165; val_edge_recon_loss: 1806750.3996; val_cat_covariates_contrastive_loss: 3157068.6288; val_gene_expr_recon_loss: 1967999.1780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9024.4473; val_global_loss: 6970001.4015; val_optim_loss: 6970001.4015
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9578; val_auprc_score: 0.9735; val_best_acc_score: 0.9216; val_best_f1_score: 0.9437; train_kl_reg_loss: 30145.7340; train_edge_recon_loss: 1766676.8259; train_cat_covariates_contrastive_loss: 3153587.1114; train_gene_expr_recon_loss: 1938946.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8989.1967; train_global_loss: 6898345.7645; train_optim_loss: 6898345.7645; val_kl_reg_loss: 30401.1553; val_edge_recon_loss: 1813817.9735; val_cat_covariates_contrastive_loss: 3155226.2008; val_gene_expr_recon_loss: 1965941.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8989.2861; val_global_loss: 6974375.9242; val_optim_loss: 6974375.9242
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9666; val_auprc_score: 0.9796; val_best_acc_score: 0.9319; val_best_f1_score: 0.9509; train_kl_reg_loss: 25191.9700; train_edge_recon_loss: 1755257.8793; train_cat_covariates_contrastive_loss: 640223.4218; train_gene_expr_recon_loss: 1737243.8187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8197.0289; train_global_loss: 4166114.1237; train_optim_loss: 4166114.1237; val_kl_reg_loss: 24909.4904; val_edge_recon_loss: 1806351.4356; val_cat_covariates_contrastive_loss: 641798.2784; val_gene_expr_recon_loss: 1802951.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8223.2354; val_global_loss: 4284233.3750; val_optim_loss: 4284233.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9494; val_auprc_score: 0.9681; val_best_acc_score: 0.9166; val_best_f1_score: 0.9398; train_kl_reg_loss: 30357.5692; train_edge_recon_loss: 1770348.6983; train_cat_covariates_contrastive_loss: 3153209.7972; train_gene_expr_recon_loss: 1931443.8489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9008.9239; train_global_loss: 6894368.8418; train_optim_loss: 6894368.8418; val_kl_reg_loss: 30786.5278; val_edge_recon_loss: 1813855.1402; val_cat_covariates_contrastive_loss: 3152824.8939; val_gene_expr_recon_loss: 1962405.1572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8918.0635; val_global_loss: 6968789.7500; val_optim_loss: 6968789.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9678; val_auprc_score: 0.9803; val_best_acc_score: 0.9343; val_best_f1_score: 0.9527; train_kl_reg_loss: 25514.6243; train_edge_recon_loss: 1759300.2162; train_cat_covariates_contrastive_loss: 640125.3091; train_gene_expr_recon_loss: 1737938.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8152.7494; train_global_loss: 4171031.3627; train_optim_loss: 4171031.3627; val_kl_reg_loss: 25458.9218; val_edge_recon_loss: 1783467.6496; val_cat_covariates_contrastive_loss: 640921.4678; val_gene_expr_recon_loss: 1778605.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8116.9375; val_global_loss: 4236570.6098; val_optim_loss: 4236570.6098
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9553; val_auprc_score: 0.9738; val_best_acc_score: 0.9147; val_best_f1_score: 0.9382; train_kl_reg_loss: 30279.3625; train_edge_recon_loss: 1758592.5869; train_cat_covariates_contrastive_loss: 3154274.7895; train_gene_expr_recon_loss: 1927628.6945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9011.3221; train_global_loss: 6879786.7670; train_optim_loss: 6879786.7670; val_kl_reg_loss: 26508.9532; val_edge_recon_loss: 1811688.2273; val_cat_covariates_contrastive_loss: 3172122.6136; val_gene_expr_recon_loss: 1960652.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9050.9775; val_global_loss: 6980023.5758; val_optim_loss: 6980023.5758
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9667; val_auprc_score: 0.9800; val_best_acc_score: 0.9313; val_best_f1_score: 0.9506; train_kl_reg_loss: 25448.1254; train_edge_recon_loss: 1763007.1573; train_cat_covariates_contrastive_loss: 640063.3084; train_gene_expr_recon_loss: 1730455.3527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8146.2930; train_global_loss: 4167120.2300; train_optim_loss: 4167120.2300; val_kl_reg_loss: 25903.5264; val_edge_recon_loss: 1790415.0909; val_cat_covariates_contrastive_loss: 640505.5814; val_gene_expr_recon_loss: 1786940.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8106.3818; val_global_loss: 4251870.7765; val_optim_loss: 4251870.7765
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9442; val_auprc_score: 0.9644; val_best_acc_score: 0.9128; val_best_f1_score: 0.9374; train_kl_reg_loss: 30372.0908; train_edge_recon_loss: 1768876.5100; train_cat_covariates_contrastive_loss: 3154574.0519; train_gene_expr_recon_loss: 1926644.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9180.4192; train_global_loss: 6889647.8257; train_optim_loss: 6889647.8257; val_kl_reg_loss: 34368.6474; val_edge_recon_loss: 1820380.4640; val_cat_covariates_contrastive_loss: 3149241.7727; val_gene_expr_recon_loss: 1954215.0511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9264.4746; val_global_loss: 6967470.4167; val_optim_loss: 6967470.4167
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9544; val_auprc_score: 0.9715; val_best_acc_score: 0.9213; val_best_f1_score: 0.9436; train_kl_reg_loss: 30474.8138; train_edge_recon_loss: 1766729.9641; train_cat_covariates_contrastive_loss: 3153005.0540; train_gene_expr_recon_loss: 1917004.9424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9384.4280; train_global_loss: 6876599.1939; train_optim_loss: 6876599.1939; val_kl_reg_loss: 31925.6973; val_edge_recon_loss: 1792995.3864; val_cat_covariates_contrastive_loss: 3157493.0682; val_gene_expr_recon_loss: 1947136.7462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9371.3076; val_global_loss: 6938922.4091; val_optim_loss: 6938922.4091
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9622; val_auprc_score: 0.9778; val_best_acc_score: 0.9245; val_best_f1_score: 0.9458; train_kl_reg_loss: 38410.7565; train_edge_recon_loss: 1758258.1409; train_cat_covariates_contrastive_loss: 640760.7359; train_gene_expr_recon_loss: 1756565.3739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8164.8164; train_global_loss: 4202159.8299; train_optim_loss: 4202159.8299; val_kl_reg_loss: 40293.4612; val_edge_recon_loss: 1813089.8068; val_cat_covariates_contrastive_loss: 642143.3087; val_gene_expr_recon_loss: 1827886.9905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8676.3223; val_global_loss: 4332090.0114; val_optim_loss: 4332090.0114
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9553; val_auprc_score: 0.9714; val_best_acc_score: 0.9218; val_best_f1_score: 0.9434; train_kl_reg_loss: 32562.0999; train_edge_recon_loss: 1767887.5240; train_cat_covariates_contrastive_loss: 3156756.7207; train_gene_expr_recon_loss: 1878158.9828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8790.1160; train_global_loss: 6844155.4379; train_optim_loss: 6844155.4379; val_kl_reg_loss: 26145.9105; val_edge_recon_loss: 1813446.6383; val_cat_covariates_contrastive_loss: 3156316.4621; val_gene_expr_recon_loss: 1902886.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8578.5840; val_global_loss: 6907373.8485; val_optim_loss: 6907373.8485
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9676; val_auprc_score: 0.9803; val_best_acc_score: 0.9313; val_best_f1_score: 0.9504; train_kl_reg_loss: 27079.1384; train_edge_recon_loss: 1759641.9683; train_cat_covariates_contrastive_loss: 641034.4104; train_gene_expr_recon_loss: 1614085.3168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8152.5188; train_global_loss: 4049993.3457; train_optim_loss: 4049993.3457; val_kl_reg_loss: 23974.6658; val_edge_recon_loss: 1808053.8201; val_cat_covariates_contrastive_loss: 641782.5862; val_gene_expr_recon_loss: 1619910.1420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8009.7261; val_global_loss: 4101730.9053; val_optim_loss: 4101730.9053
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9549; val_auprc_score: 0.9709; val_best_acc_score: 0.9227; val_best_f1_score: 0.9444; train_kl_reg_loss: 30193.1756; train_edge_recon_loss: 1764060.9324; train_cat_covariates_contrastive_loss: 3153779.0850; train_gene_expr_recon_loss: 1863514.0453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8487.9376; train_global_loss: 6820035.1692; train_optim_loss: 6820035.1692; val_kl_reg_loss: 26920.6364; val_edge_recon_loss: 1800848.9205; val_cat_covariates_contrastive_loss: 3152415.6667; val_gene_expr_recon_loss: 1897424.0928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8387.4160; val_global_loss: 6885996.8409; val_optim_loss: 6885996.8409
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9690; val_auprc_score: 0.9817; val_best_acc_score: 0.9335; val_best_f1_score: 0.9519; train_kl_reg_loss: 30101.1367; train_edge_recon_loss: 1757218.6452; train_cat_covariates_contrastive_loss: 640216.0973; train_gene_expr_recon_loss: 1574437.9858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7938.1828; train_global_loss: 4009912.0502; train_optim_loss: 4009912.0502; val_kl_reg_loss: 23949.8325; val_edge_recon_loss: 1787629.8447; val_cat_covariates_contrastive_loss: 643546.9441; val_gene_expr_recon_loss: 1597542.2992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7828.4600; val_global_loss: 4060497.4015; val_optim_loss: 4060497.4015
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9494; val_auprc_score: 0.9675; val_best_acc_score: 0.9191; val_best_f1_score: 0.9421; train_kl_reg_loss: 29615.6875; train_edge_recon_loss: 1762215.4101; train_cat_covariates_contrastive_loss: 3153512.1246; train_gene_expr_recon_loss: 1861041.3988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8512.1892; train_global_loss: 6814896.8180; train_optim_loss: 6814896.8180; val_kl_reg_loss: 28972.9192; val_edge_recon_loss: 1816507.8958; val_cat_covariates_contrastive_loss: 3152629.4129; val_gene_expr_recon_loss: 1898360.2803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8509.1543; val_global_loss: 6904979.5227; val_optim_loss: 6904979.5227
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9666; val_auprc_score: 0.9793; val_best_acc_score: 0.9339; val_best_f1_score: 0.9526; train_kl_reg_loss: 25758.3352; train_edge_recon_loss: 1752967.9630; train_cat_covariates_contrastive_loss: 639990.7609; train_gene_expr_recon_loss: 1550087.7560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7800.7144; train_global_loss: 3976605.5289; train_optim_loss: 3976605.5289; val_kl_reg_loss: 25972.3661; val_edge_recon_loss: 1786975.5947; val_cat_covariates_contrastive_loss: 638050.7206; val_gene_expr_recon_loss: 1585797.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7752.7793; val_global_loss: 4044549.0227; val_optim_loss: 4044549.0227
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9538; val_auprc_score: 0.9711; val_best_acc_score: 0.9211; val_best_f1_score: 0.9432; train_kl_reg_loss: 29608.8431; train_edge_recon_loss: 1760809.3136; train_cat_covariates_contrastive_loss: 3153034.5791; train_gene_expr_recon_loss: 1854541.4981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8520.8451; train_global_loss: 6806515.0612; train_optim_loss: 6806515.0612; val_kl_reg_loss: 27198.1907; val_edge_recon_loss: 1802611.0303; val_cat_covariates_contrastive_loss: 3154264.1780; val_gene_expr_recon_loss: 1891374.0587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8666.7178; val_global_loss: 6884113.9621; val_optim_loss: 6884113.9621
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9677; val_auprc_score: 0.9799; val_best_acc_score: 0.9355; val_best_f1_score: 0.9535; train_kl_reg_loss: 25254.8135; train_edge_recon_loss: 1753143.9175; train_cat_covariates_contrastive_loss: 639645.4955; train_gene_expr_recon_loss: 1538777.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7776.2534; train_global_loss: 3964598.0889; train_optim_loss: 3964598.0889; val_kl_reg_loss: 24956.9646; val_edge_recon_loss: 1790040.0379; val_cat_covariates_contrastive_loss: 638692.8703; val_gene_expr_recon_loss: 1586444.2178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7718.3096; val_global_loss: 4047852.3258; val_optim_loss: 4047852.3258
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9532; val_auprc_score: 0.9704; val_best_acc_score: 0.9209; val_best_f1_score: 0.9431; train_kl_reg_loss: 29274.7870; train_edge_recon_loss: 1761940.5317; train_cat_covariates_contrastive_loss: 3153731.0795; train_gene_expr_recon_loss: 1855763.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8559.9926; train_global_loss: 6809269.7109; train_optim_loss: 6809269.7109; val_kl_reg_loss: 27706.3842; val_edge_recon_loss: 1810100.8049; val_cat_covariates_contrastive_loss: 3155904.6894; val_gene_expr_recon_loss: 1894913.6989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8591.3760; val_global_loss: 6897217.1061; val_optim_loss: 6897217.1061
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9645; val_auprc_score: 0.9779; val_best_acc_score: 0.9316; val_best_f1_score: 0.9508; train_kl_reg_loss: 24853.3019; train_edge_recon_loss: 1759646.2268; train_cat_covariates_contrastive_loss: 639950.0628; train_gene_expr_recon_loss: 1537710.9509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7738.6698; train_global_loss: 3969899.2143; train_optim_loss: 3969899.2143; val_kl_reg_loss: 25318.8652; val_edge_recon_loss: 1800345.9129; val_cat_covariates_contrastive_loss: 638331.6316; val_gene_expr_recon_loss: 1573638.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7702.8086; val_global_loss: 4045337.4470; val_optim_loss: 4045337.4470
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9568; val_auprc_score: 0.9730; val_best_acc_score: 0.9222; val_best_f1_score: 0.9440; train_kl_reg_loss: 28984.7008; train_edge_recon_loss: 1766776.2509; train_cat_covariates_contrastive_loss: 3151661.1063; train_gene_expr_recon_loss: 1849336.1054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8556.9465; train_global_loss: 6805315.1080; train_optim_loss: 6805315.1080; val_kl_reg_loss: 29826.2386; val_edge_recon_loss: 1807042.2557; val_cat_covariates_contrastive_loss: 3150864.2462; val_gene_expr_recon_loss: 1893940.2841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8722.5635; val_global_loss: 6890395.5303; val_optim_loss: 6890395.5303
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9664; val_auprc_score: 0.9794; val_best_acc_score: 0.9339; val_best_f1_score: 0.9523; train_kl_reg_loss: 24795.7120; train_edge_recon_loss: 1755377.3733; train_cat_covariates_contrastive_loss: 639550.6886; train_gene_expr_recon_loss: 1529841.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7706.7893; train_global_loss: 3957271.6662; train_optim_loss: 3957271.6662; val_kl_reg_loss: 24928.0959; val_edge_recon_loss: 1786489.2803; val_cat_covariates_contrastive_loss: 638253.5786; val_gene_expr_recon_loss: 1570609.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7687.4854; val_global_loss: 4027968.2538; val_optim_loss: 4027968.2538
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9579; val_auprc_score: 0.9729; val_best_acc_score: 0.9264; val_best_f1_score: 0.9470; train_kl_reg_loss: 29082.8167; train_edge_recon_loss: 1766832.7190; train_cat_covariates_contrastive_loss: 3152248.4753; train_gene_expr_recon_loss: 1846809.0070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8525.1247; train_global_loss: 6803498.1522; train_optim_loss: 6803498.1522; val_kl_reg_loss: 27991.6758; val_edge_recon_loss: 1812502.8011; val_cat_covariates_contrastive_loss: 3154954.3371; val_gene_expr_recon_loss: 1883669.9072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8639.3486; val_global_loss: 6887758.2424; val_optim_loss: 6887758.2424
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9675; val_auprc_score: 0.9802; val_best_acc_score: 0.9340; val_best_f1_score: 0.9525; train_kl_reg_loss: 24650.5263; train_edge_recon_loss: 1751387.6971; train_cat_covariates_contrastive_loss: 639726.6997; train_gene_expr_recon_loss: 1523980.0325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7668.2814; train_global_loss: 3947413.2343; train_optim_loss: 3947413.2343; val_kl_reg_loss: 25023.4969; val_edge_recon_loss: 1782587.7235; val_cat_covariates_contrastive_loss: 638772.8674; val_gene_expr_recon_loss: 1566315.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7707.8071; val_global_loss: 4020406.9886; val_optim_loss: 4020406.9886
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9447; val_auprc_score: 0.9650; val_best_acc_score: 0.9158; val_best_f1_score: 0.9395; train_kl_reg_loss: 29065.6189; train_edge_recon_loss: 1764225.3452; train_cat_covariates_contrastive_loss: 3152416.0315; train_gene_expr_recon_loss: 1839794.0181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8524.8680; train_global_loss: 6794025.8912; train_optim_loss: 6794025.8912; val_kl_reg_loss: 32052.2625; val_edge_recon_loss: 1811096.2841; val_cat_covariates_contrastive_loss: 3147166.9242; val_gene_expr_recon_loss: 1880947.0777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8485.6934; val_global_loss: 6879748.0455; val_optim_loss: 6879748.0455
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9685; val_auprc_score: 0.9810; val_best_acc_score: 0.9345; val_best_f1_score: 0.9529; train_kl_reg_loss: 24488.9778; train_edge_recon_loss: 1749845.8276; train_cat_covariates_contrastive_loss: 639355.3892; train_gene_expr_recon_loss: 1520596.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7659.8684; train_global_loss: 3941947.0123; train_optim_loss: 3941947.0123; val_kl_reg_loss: 24309.1479; val_edge_recon_loss: 1786919.6667; val_cat_covariates_contrastive_loss: 640289.6108; val_gene_expr_recon_loss: 1561371.9924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7611.6484; val_global_loss: 4020502.1667; val_optim_loss: 4020502.1667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9574; val_auprc_score: 0.9732; val_best_acc_score: 0.9244; val_best_f1_score: 0.9452; train_kl_reg_loss: 29208.3255; train_edge_recon_loss: 1768702.9084; train_cat_covariates_contrastive_loss: 3152351.9583; train_gene_expr_recon_loss: 1845405.9660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8496.3426; train_global_loss: 6804165.4796; train_optim_loss: 6804165.4796; val_kl_reg_loss: 27766.1735; val_edge_recon_loss: 1806314.9015; val_cat_covariates_contrastive_loss: 3152954.9697; val_gene_expr_recon_loss: 1883707.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8483.4736; val_global_loss: 6879227.1970; val_optim_loss: 6879227.1970
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9679; val_auprc_score: 0.9803; val_best_acc_score: 0.9351; val_best_f1_score: 0.9534; train_kl_reg_loss: 24543.6673; train_edge_recon_loss: 1754759.0200; train_cat_covariates_contrastive_loss: 639491.1046; train_gene_expr_recon_loss: 1513439.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7644.2581; train_global_loss: 3939877.5251; train_optim_loss: 3939877.5251; val_kl_reg_loss: 24971.2723; val_edge_recon_loss: 1774074.7481; val_cat_covariates_contrastive_loss: 638453.0852; val_gene_expr_recon_loss: 1556664.5152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7578.0098; val_global_loss: 4001741.6439; val_optim_loss: 4001741.6439
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9425; val_auprc_score: 0.9630; val_best_acc_score: 0.9103; val_best_f1_score: 0.9361; train_kl_reg_loss: 29168.6088; train_edge_recon_loss: 1760760.3172; train_cat_covariates_contrastive_loss: 3153213.5582; train_gene_expr_recon_loss: 1835558.4092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8490.7536; train_global_loss: 6787191.6650; train_optim_loss: 6787191.6650; val_kl_reg_loss: 33915.1832; val_edge_recon_loss: 1827164.9848; val_cat_covariates_contrastive_loss: 3145278.4697; val_gene_expr_recon_loss: 1911929.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8483.5537; val_global_loss: 6926771.9394; val_optim_loss: 6926771.9394
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9669; val_auprc_score: 0.9802; val_best_acc_score: 0.9326; val_best_f1_score: 0.9515; train_kl_reg_loss: 24423.4991; train_edge_recon_loss: 1760356.8912; train_cat_covariates_contrastive_loss: 639146.1370; train_gene_expr_recon_loss: 1510634.5540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7636.7848; train_global_loss: 3942197.8622; train_optim_loss: 3942197.8622; val_kl_reg_loss: 25102.4292; val_edge_recon_loss: 1787557.4034; val_cat_covariates_contrastive_loss: 639981.3295; val_gene_expr_recon_loss: 1549974.3655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7631.0762; val_global_loss: 4010246.5114; val_optim_loss: 4010246.5114
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9570; val_auprc_score: 0.9726; val_best_acc_score: 0.9262; val_best_f1_score: 0.9470; train_kl_reg_loss: 29402.6994; train_edge_recon_loss: 1767877.1752; train_cat_covariates_contrastive_loss: 3153942.8882; train_gene_expr_recon_loss: 1843260.1866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8512.1575; train_global_loss: 6802995.0765; train_optim_loss: 6802995.0765; val_kl_reg_loss: 26767.6729; val_edge_recon_loss: 1791220.1212; val_cat_covariates_contrastive_loss: 3154430.4545; val_gene_expr_recon_loss: 1878203.0379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8476.2285; val_global_loss: 6859097.2955; val_optim_loss: 6859097.2955
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9685; val_auprc_score: 0.9800; val_best_acc_score: 0.9363; val_best_f1_score: 0.9542; train_kl_reg_loss: 24549.1274; train_edge_recon_loss: 1755763.2857; train_cat_covariates_contrastive_loss: 639540.1996; train_gene_expr_recon_loss: 1512096.2923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7656.2223; train_global_loss: 3939605.1365; train_optim_loss: 3939605.1365; val_kl_reg_loss: 25172.2608; val_edge_recon_loss: 1787673.0587; val_cat_covariates_contrastive_loss: 638675.6705; val_gene_expr_recon_loss: 1564274.6496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7684.1104; val_global_loss: 4023479.6326; val_optim_loss: 4023479.6326
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9533; val_auprc_score: 0.9699; val_best_acc_score: 0.9262; val_best_f1_score: 0.9470; train_kl_reg_loss: 29721.2729; train_edge_recon_loss: 1760066.2795; train_cat_covariates_contrastive_loss: 3152368.6658; train_gene_expr_recon_loss: 1834822.9322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8487.8288; train_global_loss: 6785466.9974; train_optim_loss: 6785466.9974; val_kl_reg_loss: 27343.4721; val_edge_recon_loss: 1790513.5871; val_cat_covariates_contrastive_loss: 3153210.4318; val_gene_expr_recon_loss: 1872958.6951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8381.5693; val_global_loss: 6852407.6667; val_optim_loss: 6852407.6667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8397; val_auprc_score: 0.9208; val_best_acc_score: 0.7891; val_best_f1_score: 0.8601; train_kl_reg_loss: 1325814.1677; train_edge_recon_loss: 2344087.4031; train_cat_covariates_contrastive_loss: 632145.9210; train_gene_expr_recon_loss: 7512357.0889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10907.1475; train_global_loss: 11825311.6743; train_optim_loss: 11825311.6743; val_kl_reg_loss: 25743.4754; val_edge_recon_loss: 1977896.1610; val_cat_covariates_contrastive_loss: 638701.4015; val_gene_expr_recon_loss: 2193060.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10628.6992; val_global_loss: 4846030.0076; val_optim_loss: 4846030.0076
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9570; val_auprc_score: 0.9721; val_best_acc_score: 0.9252; val_best_f1_score: 0.9460; train_kl_reg_loss: 29245.8603; train_edge_recon_loss: 1765121.3093; train_cat_covariates_contrastive_loss: 3153581.4443; train_gene_expr_recon_loss: 1824153.3335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8494.1652; train_global_loss: 6780596.0978; train_optim_loss: 6780596.0978; val_kl_reg_loss: 28244.5713; val_edge_recon_loss: 1803573.9924; val_cat_covariates_contrastive_loss: 3152607.6288; val_gene_expr_recon_loss: 1879350.1894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8599.1533; val_global_loss: 6872375.3939; val_optim_loss: 6872375.3939
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9228; val_auprc_score: 0.9594; val_best_acc_score: 0.8636; val_best_f1_score: 0.9034; train_kl_reg_loss: 22799.4340; train_edge_recon_loss: 1840618.8382; train_cat_covariates_contrastive_loss: 643762.6871; train_gene_expr_recon_loss: 2010395.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8464.6391; train_global_loss: 4526041.3223; train_optim_loss: 4526041.3223; val_kl_reg_loss: 14985.8576; val_edge_recon_loss: 1870153.4527; val_cat_covariates_contrastive_loss: 647250.4896; val_gene_expr_recon_loss: 1949174.9129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7349.6201; val_global_loss: 4488914.2500; val_optim_loss: 4488914.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9563; val_auprc_score: 0.9725; val_best_acc_score: 0.9256; val_best_f1_score: 0.9465; train_kl_reg_loss: 29298.8203; train_edge_recon_loss: 1763311.1922; train_cat_covariates_contrastive_loss: 3153955.5659; train_gene_expr_recon_loss: 1822101.9787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8492.3422; train_global_loss: 6777159.9141; train_optim_loss: 6777159.9141; val_kl_reg_loss: 27405.7316; val_edge_recon_loss: 1796664.5038; val_cat_covariates_contrastive_loss: 3156276.7879; val_gene_expr_recon_loss: 1884647.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8466.8740; val_global_loss: 6873461.5379; val_optim_loss: 6873461.5379

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9253; val_auprc_score: 0.9604; val_best_acc_score: 0.8681; val_best_f1_score: 0.9075; train_kl_reg_loss: 21154.2121; train_edge_recon_loss: 1796757.1369; train_cat_covariates_contrastive_loss: 643545.1115; train_gene_expr_recon_loss: 1933387.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6660.1137; train_global_loss: 4401504.5251; train_optim_loss: 4401504.5251; val_kl_reg_loss: 15360.0963; val_edge_recon_loss: 1855426.7140; val_cat_covariates_contrastive_loss: 643044.4394; val_gene_expr_recon_loss: 1935967.7424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6583.4839; val_global_loss: 4456382.4318; val_optim_loss: 4456382.4318
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9476; val_auprc_score: 0.9648; val_best_acc_score: 0.9222; val_best_f1_score: 0.9440; train_kl_reg_loss: 29356.4828; train_edge_recon_loss: 1762018.2664; train_cat_covariates_contrastive_loss: 3152043.0825; train_gene_expr_recon_loss: 1812153.1335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8515.5954; train_global_loss: 6764086.5570; train_optim_loss: 6764086.5570; val_kl_reg_loss: 30321.4180; val_edge_recon_loss: 1798997.4508; val_cat_covariates_contrastive_loss: 3148923.7386; val_gene_expr_recon_loss: 1846448.1723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8488.5859; val_global_loss: 6833179.2576; val_optim_loss: 6833179.2576
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9264; val_auprc_score: 0.9606; val_best_acc_score: 0.8733; val_best_f1_score: 0.9109; train_kl_reg_loss: 20695.3032; train_edge_recon_loss: 1799122.8748; train_cat_covariates_contrastive_loss: 642740.9449; train_gene_expr_recon_loss: 1925138.4919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6536.9859; train_global_loss: 4394234.5978; train_optim_loss: 4394234.5978; val_kl_reg_loss: 15341.1071; val_edge_recon_loss: 1850107.0076; val_cat_covariates_contrastive_loss: 642228.6600; val_gene_expr_recon_loss: 1928831.9640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6486.8394; val_global_loss: 4442995.7424; val_optim_loss: 4442995.7424
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9517; val_auprc_score: 0.9685; val_best_acc_score: 0.9255; val_best_f1_score: 0.9467; train_kl_reg_loss: 28931.4321; train_edge_recon_loss: 1758768.3716; train_cat_covariates_contrastive_loss: 3151880.5013; train_gene_expr_recon_loss: 1799686.4101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8504.1489; train_global_loss: 6747770.8793; train_optim_loss: 6747770.8793; val_kl_reg_loss: 29962.0901; val_edge_recon_loss: 1796445.8011; val_cat_covariates_contrastive_loss: 3148122.3561; val_gene_expr_recon_loss: 1843748.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8418.5244; val_global_loss: 6826696.9167; val_optim_loss: 6826696.9167
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9292; val_auprc_score: 0.9623; val_best_acc_score: 0.8756; val_best_f1_score: 0.9124; train_kl_reg_loss: 20473.3161; train_edge_recon_loss: 1793409.4339; train_cat_covariates_contrastive_loss: 642437.4126; train_gene_expr_recon_loss: 1916837.0670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6425.8530; train_global_loss: 4379583.1127; train_optim_loss: 4379583.1127; val_kl_reg_loss: 15125.8903; val_edge_recon_loss: 1847226.7311; val_cat_covariates_contrastive_loss: 642511.4886; val_gene_expr_recon_loss: 1921579.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6369.1519; val_global_loss: 4432812.5909; val_optim_loss: 4432812.5909
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9515; val_auprc_score: 0.9692; val_best_acc_score: 0.9222; val_best_f1_score: 0.9443; train_kl_reg_loss: 28700.1003; train_edge_recon_loss: 1763787.9994; train_cat_covariates_contrastive_loss: 3152758.9660; train_gene_expr_recon_loss: 1795838.1941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8531.6102; train_global_loss: 6749616.8665; train_optim_loss: 6749616.8665; val_kl_reg_loss: 28690.3393; val_edge_recon_loss: 1807151.1458; val_cat_covariates_contrastive_loss: 3154300.0682; val_gene_expr_recon_loss: 1848308.5398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8517.8311; val_global_loss: 6846968.1288; val_optim_loss: 6846968.1288
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9326; val_auprc_score: 0.9642; val_best_acc_score: 0.8785; val_best_f1_score: 0.9145; train_kl_reg_loss: 20199.4806; train_edge_recon_loss: 1790849.8457; train_cat_covariates_contrastive_loss: 642219.2374; train_gene_expr_recon_loss: 1907700.6635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6307.1876; train_global_loss: 4367276.4150; train_optim_loss: 4367276.4150; val_kl_reg_loss: 14822.1670; val_edge_recon_loss: 1843113.0076; val_cat_covariates_contrastive_loss: 641775.6591; val_gene_expr_recon_loss: 1905577.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6256.2124; val_global_loss: 4411544.1250; val_optim_loss: 4411544.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9577; val_auprc_score: 0.9736; val_best_acc_score: 0.9263; val_best_f1_score: 0.9468; train_kl_reg_loss: 28675.5443; train_edge_recon_loss: 1761988.3950; train_cat_covariates_contrastive_loss: 3151615.2547; train_gene_expr_recon_loss: 1803465.4892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8484.8346; train_global_loss: 6754229.5264; train_optim_loss: 6754229.5264; val_kl_reg_loss: 27284.5088; val_edge_recon_loss: 1793032.7102; val_cat_covariates_contrastive_loss: 3157324.0758; val_gene_expr_recon_loss: 1849335.2330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8455.3018; val_global_loss: 6835432.0455; val_optim_loss: 6835432.0455
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9522; val_auprc_score: 0.9692; val_best_acc_score: 0.9263; val_best_f1_score: 0.9471; train_kl_reg_loss: 28918.4714; train_edge_recon_loss: 1759637.2551; train_cat_covariates_contrastive_loss: 3151634.3563; train_gene_expr_recon_loss: 1792730.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8459.5389; train_global_loss: 6741380.1709; train_optim_loss: 6741380.1709; val_kl_reg_loss: 31861.3434; val_edge_recon_loss: 1792385.3485; val_cat_covariates_contrastive_loss: 3147315.3030; val_gene_expr_recon_loss: 1845176.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8392.8975; val_global_loss: 6825131.5530; val_optim_loss: 6825131.5530

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 324 min 8 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9246
val AUPRC score: 0.9325
val best accuracy score: 0.9175
val best F1 score: 0.9398
val target rna MSE score: 0.9050
val source rna MSE score: 0.1301
Val cat covariate0 mean sim diff: 0.0023
Val cat covariate1 mean sim diff: -0.1193

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9578; val_auprc_score: 0.9724; val_best_acc_score: 0.9275; val_best_f1_score: 0.9477; train_kl_reg_loss: 28890.1721; train_edge_recon_loss: 1759809.6699; train_cat_covariates_contrastive_loss: 3151989.1688; train_gene_expr_recon_loss: 1785336.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8470.3832; train_global_loss: 6734496.2585; train_optim_loss: 6734496.2585; val_kl_reg_loss: 27706.4137; val_edge_recon_loss: 1804200.9205; val_cat_covariates_contrastive_loss: 3152628.9015; val_gene_expr_recon_loss: 1830100.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8609.3213; val_global_loss: 6823246.0379; val_optim_loss: 6823246.0379
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9542; val_auprc_score: 0.9702; val_best_acc_score: 0.9263; val_best_f1_score: 0.9473; train_kl_reg_loss: 28730.3119; train_edge_recon_loss: 1758766.6688; train_cat_covariates_contrastive_loss: 3151708.9052; train_gene_expr_recon_loss: 1780772.3635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8448.0695; train_global_loss: 6728426.3138; train_optim_loss: 6728426.3138; val_kl_reg_loss: 29821.6679; val_edge_recon_loss: 1792738.1288; val_cat_covariates_contrastive_loss: 3147860.4659; val_gene_expr_recon_loss: 1846907.9186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8354.9775; val_global_loss: 6825683.1591; val_optim_loss: 6825683.1591
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9527; val_auprc_score: 0.9686; val_best_acc_score: 0.9258; val_best_f1_score: 0.9467; train_kl_reg_loss: 28952.2825; train_edge_recon_loss: 1760974.1726; train_cat_covariates_contrastive_loss: 3151613.4328; train_gene_expr_recon_loss: 1790758.5043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8447.6003; train_global_loss: 6740745.9855; train_optim_loss: 6740745.9855; val_kl_reg_loss: 29932.3223; val_edge_recon_loss: 1803545.3712; val_cat_covariates_contrastive_loss: 3151819.9924; val_gene_expr_recon_loss: 1829831.9905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8466.2256; val_global_loss: 6823595.6818; val_optim_loss: 6823595.6818
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9547; val_auprc_score: 0.9698; val_best_acc_score: 0.9287; val_best_f1_score: 0.9486; train_kl_reg_loss: 28709.9580; train_edge_recon_loss: 1759771.8980; train_cat_covariates_contrastive_loss: 3150724.9141; train_gene_expr_recon_loss: 1777009.4373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8461.7998; train_global_loss: 6724678.0111; train_optim_loss: 6724678.0111; val_kl_reg_loss: 28655.5326; val_edge_recon_loss: 1796114.8731; val_cat_covariates_contrastive_loss: 3151240.0947; val_gene_expr_recon_loss: 1830389.5265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8530.3369; val_global_loss: 6814930.5682; val_optim_loss: 6814930.5682
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9551; val_auprc_score: 0.9712; val_best_acc_score: 0.9263; val_best_f1_score: 0.9472; train_kl_reg_loss: 28938.5321; train_edge_recon_loss: 1761026.7961; train_cat_covariates_contrastive_loss: 3151462.9009; train_gene_expr_recon_loss: 1780219.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8497.2355; train_global_loss: 6730144.6029; train_optim_loss: 6730144.6029; val_kl_reg_loss: 29051.9200; val_edge_recon_loss: 1795127.6155; val_cat_covariates_contrastive_loss: 3152762.3977; val_gene_expr_recon_loss: 1852684.5947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8512.5166; val_global_loss: 6838139.0076; val_optim_loss: 6838139.0076
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9559; val_auprc_score: 0.9707; val_best_acc_score: 0.9274; val_best_f1_score: 0.9477; train_kl_reg_loss: 28901.7753; train_edge_recon_loss: 1760852.8578; train_cat_covariates_contrastive_loss: 3151499.0999; train_gene_expr_recon_loss: 1776113.2211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8472.2033; train_global_loss: 6725839.1369; train_optim_loss: 6725839.1369; val_kl_reg_loss: 28365.0660; val_edge_recon_loss: 1808048.2765; val_cat_covariates_contrastive_loss: 3149469.6515; val_gene_expr_recon_loss: 1820575.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8471.4082; val_global_loss: 6814930.0379; val_optim_loss: 6814930.0379
