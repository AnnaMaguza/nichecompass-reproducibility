[True, False, True]
Run timestamp: 31082023_085909_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '50', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 528143
Number of validation nodes: 58683
Number of training edges: 1246262
Number of validation edges: 138473
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/50 |--------------------| 2.0% val_auroc_score: 0.8776; val_auprc_score: 0.9780; val_best_acc_score: 0.9088; val_best_f1_score: 0.9497; train_kl_reg_loss: 16395.8314; train_edge_recon_loss: 741835.8907; train_cat_covariates_contrastive_loss: 951331.7461; train_gene_expr_recon_loss: 2663299.8392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4372863.3085; train_optim_loss: 4372863.3085; val_kl_reg_loss: 18938.1230; val_edge_recon_loss: 741106.8536; val_cat_covariates_contrastive_loss: 949703.8976; val_gene_expr_recon_loss: 2349209.3985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4058958.2648; val_optim_loss: 4058958.2648
Epoch 2/50 |--------------------| 4.0% val_auroc_score: 0.8940; val_auprc_score: 0.9811; val_best_acc_score: 0.9157; val_best_f1_score: 0.9532; train_kl_reg_loss: 20621.5502; train_edge_recon_loss: 711942.0224; train_cat_covariates_contrastive_loss: 952975.8109; train_gene_expr_recon_loss: 2193157.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3878696.6430; train_optim_loss: 3878696.6430; val_kl_reg_loss: 21497.0971; val_edge_recon_loss: 737364.8782; val_cat_covariates_contrastive_loss: 952724.1328; val_gene_expr_recon_loss: 2101868.7528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3813454.8552; val_optim_loss: 3813454.8552
Epoch 3/50 |█-------------------| 6.0% val_auroc_score: 0.8886; val_auprc_score: 0.9796; val_best_acc_score: 0.9135; val_best_f1_score: 0.9521; train_kl_reg_loss: 22742.5630; train_edge_recon_loss: 703352.0270; train_cat_covariates_contrastive_loss: 953272.3594; train_gene_expr_recon_loss: 2045834.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3725201.1612; train_optim_loss: 3725201.1612; val_kl_reg_loss: 24043.8202; val_edge_recon_loss: 726446.0780; val_cat_covariates_contrastive_loss: 951132.7145; val_gene_expr_recon_loss: 2014961.1379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3716583.7528; val_optim_loss: 3716583.7528
Epoch 4/50 |█-------------------| 8.0% val_auroc_score: 0.9060; val_auprc_score: 0.9845; val_best_acc_score: 0.9129; val_best_f1_score: 0.9519; train_kl_reg_loss: 23645.1746; train_edge_recon_loss: 702755.6099; train_cat_covariates_contrastive_loss: 953592.4324; train_gene_expr_recon_loss: 1991369.7677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3671362.9872; train_optim_loss: 3671362.9872; val_kl_reg_loss: 22431.5968; val_edge_recon_loss: 726234.7839; val_cat_covariates_contrastive_loss: 961797.5009; val_gene_expr_recon_loss: 1983458.9405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3693922.8275; val_optim_loss: 3693922.8275
Epoch 5/50 |██------------------| 10.0% val_auroc_score: 0.9113; val_auprc_score: 0.9845; val_best_acc_score: 0.9203; val_best_f1_score: 0.9557; train_kl_reg_loss: 24104.1696; train_edge_recon_loss: 705829.3254; train_cat_covariates_contrastive_loss: 953555.9932; train_gene_expr_recon_loss: 1962955.9210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3646445.4083; train_optim_loss: 3646445.4083; val_kl_reg_loss: 23659.0054; val_edge_recon_loss: 720004.6685; val_cat_covariates_contrastive_loss: 955577.0249; val_gene_expr_recon_loss: 1957186.2306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656426.9363; val_optim_loss: 3656426.9363
Epoch 6/50 |██------------------| 12.0% val_auroc_score: 0.9077; val_auprc_score: 0.9837; val_best_acc_score: 0.9195; val_best_f1_score: 0.9553; train_kl_reg_loss: 24588.3502; train_edge_recon_loss: 703472.7677; train_cat_covariates_contrastive_loss: 953249.8034; train_gene_expr_recon_loss: 1946663.3899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3627974.3140; train_optim_loss: 3627974.3140; val_kl_reg_loss: 24618.2047; val_edge_recon_loss: 719736.8067; val_cat_covariates_contrastive_loss: 952922.2691; val_gene_expr_recon_loss: 1949334.6725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3646611.9594; val_optim_loss: 3646611.9594
Epoch 7/50 |██------------------| 14.0% val_auroc_score: 0.9020; val_auprc_score: 0.9817; val_best_acc_score: 0.9235; val_best_f1_score: 0.9574; train_kl_reg_loss: 24753.6768; train_edge_recon_loss: 702711.1590; train_cat_covariates_contrastive_loss: 953554.0988; train_gene_expr_recon_loss: 1932536.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3613555.0410; train_optim_loss: 3613555.0410; val_kl_reg_loss: 27056.5621; val_edge_recon_loss: 717351.1844; val_cat_covariates_contrastive_loss: 949362.1121; val_gene_expr_recon_loss: 1933260.8565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3627030.7113; val_optim_loss: 3627030.7113
Epoch 8/50 |███-----------------| 16.0% val_auroc_score: 0.9125; val_auprc_score: 0.9848; val_best_acc_score: 0.9199; val_best_f1_score: 0.9554; train_kl_reg_loss: 24919.9582; train_edge_recon_loss: 704540.0355; train_cat_covariates_contrastive_loss: 953778.1341; train_gene_expr_recon_loss: 1920378.6723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3603616.8027; train_optim_loss: 3603616.8027; val_kl_reg_loss: 24702.8565; val_edge_recon_loss: 720535.3691; val_cat_covariates_contrastive_loss: 956243.3024; val_gene_expr_recon_loss: 1920802.9571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3622284.4852; val_optim_loss: 3622284.4852
Epoch 9/50 |███-----------------| 18.0% val_auroc_score: 0.9091; val_auprc_score: 0.9831; val_best_acc_score: 0.9268; val_best_f1_score: 0.9592; train_kl_reg_loss: 25151.7563; train_edge_recon_loss: 701242.0426; train_cat_covariates_contrastive_loss: 953687.1391; train_gene_expr_recon_loss: 1912990.3195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3593071.2589; train_optim_loss: 3593071.2589; val_kl_reg_loss: 27364.6169; val_edge_recon_loss: 725736.0609; val_cat_covariates_contrastive_loss: 949490.3642; val_gene_expr_recon_loss: 1916204.0581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3618795.1024; val_optim_loss: 3618795.1024
Epoch 10/50 |████----------------| 20.0% val_auroc_score: 0.9182; val_auprc_score: 0.9859; val_best_acc_score: 0.9204; val_best_f1_score: 0.9557; train_kl_reg_loss: 25491.5089; train_edge_recon_loss: 697532.6646; train_cat_covariates_contrastive_loss: 953682.1527; train_gene_expr_recon_loss: 1903337.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3580043.8405; train_optim_loss: 3580043.8405; val_kl_reg_loss: 23889.4040; val_edge_recon_loss: 721015.0392; val_cat_covariates_contrastive_loss: 959998.4304; val_gene_expr_recon_loss: 1903961.1139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3608863.9788; val_optim_loss: 3608863.9788
Epoch 11/50 |████----------------| 22.0% val_auroc_score: 0.9204; val_auprc_score: 0.9860; val_best_acc_score: 0.9283; val_best_f1_score: 0.9600; train_kl_reg_loss: 25887.1353; train_edge_recon_loss: 700717.8455; train_cat_covariates_contrastive_loss: 954040.0073; train_gene_expr_recon_loss: 1898204.1185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578849.1070; train_optim_loss: 3578849.1070; val_kl_reg_loss: 25274.1547; val_edge_recon_loss: 718177.0266; val_cat_covariates_contrastive_loss: 956644.5600; val_gene_expr_recon_loss: 1900097.9834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600193.7325; val_optim_loss: 3600193.7325
Epoch 12/50 |████----------------| 24.0% val_auroc_score: 0.9166; val_auprc_score: 0.9850; val_best_acc_score: 0.9241; val_best_f1_score: 0.9576; train_kl_reg_loss: 26368.1416; train_edge_recon_loss: 700706.5469; train_cat_covariates_contrastive_loss: 954027.9104; train_gene_expr_recon_loss: 1889525.7315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3570628.3316; train_optim_loss: 3570628.3316; val_kl_reg_loss: 25909.1205; val_edge_recon_loss: 722528.0828; val_cat_covariates_contrastive_loss: 954649.7927; val_gene_expr_recon_loss: 1891305.8815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594392.8810; val_optim_loss: 3594392.8810
Epoch 13/50 |█████---------------| 26.0% val_auroc_score: 0.9027; val_auprc_score: 0.9822; val_best_acc_score: 0.9145; val_best_f1_score: 0.9525; train_kl_reg_loss: 26639.2325; train_edge_recon_loss: 700351.3136; train_cat_covariates_contrastive_loss: 954356.9105; train_gene_expr_recon_loss: 1922384.2251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3603731.6862; train_optim_loss: 3603731.6862; val_kl_reg_loss: 28832.0979; val_edge_recon_loss: 726407.6914; val_cat_covariates_contrastive_loss: 952036.1220; val_gene_expr_recon_loss: 1891437.5291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598713.4410; val_optim_loss: 3598713.4410
Epoch 14/50 |█████---------------| 28.0% val_auroc_score: 0.9091; val_auprc_score: 0.9836; val_best_acc_score: 0.9143; val_best_f1_score: 0.9524; train_kl_reg_loss: 27256.7110; train_edge_recon_loss: 702023.3152; train_cat_covariates_contrastive_loss: 954122.4523; train_gene_expr_recon_loss: 1879977.1774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563379.6604; train_optim_loss: 3563379.6604; val_kl_reg_loss: 26779.0286; val_edge_recon_loss: 726156.1795; val_cat_covariates_contrastive_loss: 954656.0821; val_gene_expr_recon_loss: 1893396.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600987.5185; val_optim_loss: 3600987.5185
Epoch 15/50 |██████--------------| 30.0% val_auroc_score: 0.9110; val_auprc_score: 0.9834; val_best_acc_score: 0.9257; val_best_f1_score: 0.9586; train_kl_reg_loss: 27067.7494; train_edge_recon_loss: 701165.8931; train_cat_covariates_contrastive_loss: 954362.2904; train_gene_expr_recon_loss: 1874503.8210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557099.7526; train_optim_loss: 3557099.7526; val_kl_reg_loss: 28366.1210; val_edge_recon_loss: 723312.4163; val_cat_covariates_contrastive_loss: 951700.5830; val_gene_expr_recon_loss: 1883016.4119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3586395.5286; val_optim_loss: 3586395.5286
Epoch 16/50 |██████--------------| 32.0% val_auroc_score: 0.9186; val_auprc_score: 0.9855; val_best_acc_score: 0.9233; val_best_f1_score: 0.9574; train_kl_reg_loss: 27176.6998; train_edge_recon_loss: 701621.7097; train_cat_covariates_contrastive_loss: 954404.1058; train_gene_expr_recon_loss: 1871416.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3554619.4959; train_optim_loss: 3554619.4959; val_kl_reg_loss: 26288.4193; val_edge_recon_loss: 720103.5214; val_cat_covariates_contrastive_loss: 955980.2463; val_gene_expr_recon_loss: 1878151.5401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3580523.7288; val_optim_loss: 3580523.7288
Epoch 17/50 |██████--------------| 34.0% val_auroc_score: 0.9220; val_auprc_score: 0.9861; val_best_acc_score: 0.9278; val_best_f1_score: 0.9598; train_kl_reg_loss: 27075.6060; train_edge_recon_loss: 700046.7448; train_cat_covariates_contrastive_loss: 954418.0362; train_gene_expr_recon_loss: 1865930.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3547471.1815; train_optim_loss: 3547471.1815; val_kl_reg_loss: 26590.9236; val_edge_recon_loss: 721198.1319; val_cat_covariates_contrastive_loss: 956848.4753; val_gene_expr_recon_loss: 1872741.9834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3577379.5157; val_optim_loss: 3577379.5157
Epoch 18/50 |███████-------------| 36.0% val_auroc_score: 0.9160; val_auprc_score: 0.9851; val_best_acc_score: 0.9238; val_best_f1_score: 0.9575; train_kl_reg_loss: 27693.8230; train_edge_recon_loss: 699474.9128; train_cat_covariates_contrastive_loss: 954674.2551; train_gene_expr_recon_loss: 1868300.7744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3550143.7688; train_optim_loss: 3550143.7688; val_kl_reg_loss: 28600.0041; val_edge_recon_loss: 722425.5655; val_cat_covariates_contrastive_loss: 955372.0447; val_gene_expr_recon_loss: 1889799.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596197.3044; val_optim_loss: 3596197.3044
Epoch 19/50 |███████-------------| 38.0% val_auroc_score: 0.9164; val_auprc_score: 0.9846; val_best_acc_score: 0.9264; val_best_f1_score: 0.9589; train_kl_reg_loss: 28193.2776; train_edge_recon_loss: 698668.9024; train_cat_covariates_contrastive_loss: 954575.7015; train_gene_expr_recon_loss: 1861731.6080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3543169.4893; train_optim_loss: 3543169.4893; val_kl_reg_loss: 27789.7765; val_edge_recon_loss: 714791.8487; val_cat_covariates_contrastive_loss: 953751.8720; val_gene_expr_recon_loss: 1864898.0217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3561231.5194; val_optim_loss: 3561231.5194
Epoch 20/50 |████████------------| 40.0% val_auroc_score: 0.9156; val_auprc_score: 0.9849; val_best_acc_score: 0.9243; val_best_f1_score: 0.9579; train_kl_reg_loss: 23890.1806; train_edge_recon_loss: 703345.6453; train_cat_covariates_contrastive_loss: 953400.0037; train_gene_expr_recon_loss: 2154825.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835460.8985; train_optim_loss: 3835460.8985; val_kl_reg_loss: 26221.1719; val_edge_recon_loss: 716208.6635; val_cat_covariates_contrastive_loss: 953004.7179; val_gene_expr_recon_loss: 2105474.6319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3800909.1836; val_optim_loss: 3800909.1836
Epoch 21/50 |████████------------| 42.0% val_auroc_score: 0.9172; val_auprc_score: 0.9848; val_best_acc_score: 0.9295; val_best_f1_score: 0.9606; train_kl_reg_loss: 27151.8020; train_edge_recon_loss: 699924.8391; train_cat_covariates_contrastive_loss: 954105.1601; train_gene_expr_recon_loss: 2002323.4391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3683505.2418; train_optim_loss: 3683505.2418; val_kl_reg_loss: 28485.0920; val_edge_recon_loss: 728020.3658; val_cat_covariates_contrastive_loss: 952378.4124; val_gene_expr_recon_loss: 1953035.0374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661918.9077; val_optim_loss: 3661918.9077
Epoch 22/50 |████████------------| 44.0% val_auroc_score: 0.9175; val_auprc_score: 0.9850; val_best_acc_score: 0.9279; val_best_f1_score: 0.9598; train_kl_reg_loss: 27791.0560; train_edge_recon_loss: 701825.5734; train_cat_covariates_contrastive_loss: 954714.1284; train_gene_expr_recon_loss: 1921352.1441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3605682.9016; train_optim_loss: 3605682.9016; val_kl_reg_loss: 28684.6868; val_edge_recon_loss: 715674.9366; val_cat_covariates_contrastive_loss: 952550.3220; val_gene_expr_recon_loss: 1905655.3275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602565.2758; val_optim_loss: 3602565.2758
Epoch 23/50 |█████████-----------| 46.0% val_auroc_score: 0.9130; val_auprc_score: 0.9840; val_best_acc_score: 0.9237; val_best_f1_score: 0.9574; train_kl_reg_loss: 28248.2804; train_edge_recon_loss: 700463.4977; train_cat_covariates_contrastive_loss: 954898.3815; train_gene_expr_recon_loss: 1882279.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3565889.6435; train_optim_loss: 3565889.6435; val_kl_reg_loss: 28650.5804; val_edge_recon_loss: 719043.6024; val_cat_covariates_contrastive_loss: 953370.9649; val_gene_expr_recon_loss: 1873322.9848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3574388.1338; val_optim_loss: 3574388.1338

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/50 |█████████-----------| 48.0% val_auroc_score: 0.9178; val_auprc_score: 0.9849; val_best_acc_score: 0.9251; val_best_f1_score: 0.9581; train_kl_reg_loss: 28383.5782; train_edge_recon_loss: 696358.3077; train_cat_covariates_contrastive_loss: 954532.8050; train_gene_expr_recon_loss: 1840052.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3519326.9560; train_optim_loss: 3519326.9560; val_kl_reg_loss: 28498.2656; val_edge_recon_loss: 719432.4783; val_cat_covariates_contrastive_loss: 954140.8508; val_gene_expr_recon_loss: 1843068.3095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3545139.9133; val_optim_loss: 3545139.9133
Epoch 25/50 |██████████----------| 50.0% val_auroc_score: 0.9148; val_auprc_score: 0.9843; val_best_acc_score: 0.9265; val_best_f1_score: 0.9590; train_kl_reg_loss: 28129.4267; train_edge_recon_loss: 696059.7347; train_cat_covariates_contrastive_loss: 954402.6578; train_gene_expr_recon_loss: 1829355.2492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3507947.0710; train_optim_loss: 3507947.0710; val_kl_reg_loss: 28369.5043; val_edge_recon_loss: 716366.5544; val_cat_covariates_contrastive_loss: 952958.6940; val_gene_expr_recon_loss: 1837267.3501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3534962.0996; val_optim_loss: 3534962.0996
Epoch 26/50 |██████████----------| 52.0% val_auroc_score: 0.9184; val_auprc_score: 0.9853; val_best_acc_score: 0.9251; val_best_f1_score: 0.9581; train_kl_reg_loss: 27664.6853; train_edge_recon_loss: 694031.8717; train_cat_covariates_contrastive_loss: 954202.4333; train_gene_expr_recon_loss: 1823821.8684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3499720.8587; train_optim_loss: 3499720.8587; val_kl_reg_loss: 27533.2350; val_edge_recon_loss: 721557.0306; val_cat_covariates_contrastive_loss: 953730.6822; val_gene_expr_recon_loss: 1833428.0397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3536248.9843; val_optim_loss: 3536248.9843
Epoch 27/50 |██████████----------| 54.0% val_auroc_score: 0.9206; val_auprc_score: 0.9855; val_best_acc_score: 0.9293; val_best_f1_score: 0.9605; train_kl_reg_loss: 27379.2480; train_edge_recon_loss: 698159.2798; train_cat_covariates_contrastive_loss: 954065.8745; train_gene_expr_recon_loss: 1819708.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3499312.4337; train_optim_loss: 3499312.4337; val_kl_reg_loss: 27664.6939; val_edge_recon_loss: 714955.2861; val_cat_covariates_contrastive_loss: 953132.6771; val_gene_expr_recon_loss: 1830617.4073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3526370.0720; val_optim_loss: 3526370.0720
Epoch 28/50 |███████████---------| 56.0% val_auroc_score: 0.9215; val_auprc_score: 0.9855; val_best_acc_score: 0.9272; val_best_f1_score: 0.9594; train_kl_reg_loss: 27169.2954; train_edge_recon_loss: 696121.5047; train_cat_covariates_contrastive_loss: 954187.0410; train_gene_expr_recon_loss: 1816178.5421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3493656.3846; train_optim_loss: 3493656.3846; val_kl_reg_loss: 27311.2700; val_edge_recon_loss: 721430.4623; val_cat_covariates_contrastive_loss: 952851.8220; val_gene_expr_recon_loss: 1826314.2643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3527907.8210; val_optim_loss: 3527907.8210
Epoch 29/50 |███████████---------| 58.0% val_auroc_score: 0.9182; val_auprc_score: 0.9850; val_best_acc_score: 0.9235; val_best_f1_score: 0.9573; train_kl_reg_loss: 27022.8311; train_edge_recon_loss: 695983.5031; train_cat_covariates_contrastive_loss: 953769.6947; train_gene_expr_recon_loss: 1813694.0337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3490470.0630; train_optim_loss: 3490470.0630; val_kl_reg_loss: 27063.7384; val_edge_recon_loss: 715790.1198; val_cat_covariates_contrastive_loss: 953200.3985; val_gene_expr_recon_loss: 1824200.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3520254.9862; val_optim_loss: 3520254.9862
Epoch 30/50 |████████████--------| 60.0% val_auroc_score: 0.9193; val_auprc_score: 0.9851; val_best_acc_score: 0.9257; val_best_f1_score: 0.9585; train_kl_reg_loss: 26729.7878; train_edge_recon_loss: 693700.3510; train_cat_covariates_contrastive_loss: 953571.6217; train_gene_expr_recon_loss: 1811152.7483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3485154.5064; train_optim_loss: 3485154.5064; val_kl_reg_loss: 27123.1760; val_edge_recon_loss: 720450.3444; val_cat_covariates_contrastive_loss: 952928.5925; val_gene_expr_recon_loss: 1821877.8344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3522379.9511; val_optim_loss: 3522379.9511
Epoch 31/50 |████████████--------| 62.0% val_auroc_score: 0.9187; val_auprc_score: 0.9851; val_best_acc_score: 0.9257; val_best_f1_score: 0.9584; train_kl_reg_loss: 26622.1618; train_edge_recon_loss: 692312.0610; train_cat_covariates_contrastive_loss: 953567.6010; train_gene_expr_recon_loss: 1809448.9639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3481950.7861; train_optim_loss: 3481950.7861; val_kl_reg_loss: 26624.9528; val_edge_recon_loss: 714248.1343; val_cat_covariates_contrastive_loss: 952891.7597; val_gene_expr_recon_loss: 1819551.7528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3513316.6033; val_optim_loss: 3513316.6033
Epoch 32/50 |████████████--------| 64.0% val_auroc_score: 0.9172; val_auprc_score: 0.9845; val_best_acc_score: 0.9243; val_best_f1_score: 0.9577; train_kl_reg_loss: 26405.5960; train_edge_recon_loss: 693681.5450; train_cat_covariates_contrastive_loss: 953376.1776; train_gene_expr_recon_loss: 1808320.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3481783.9123; train_optim_loss: 3481783.9123; val_kl_reg_loss: 26735.7484; val_edge_recon_loss: 719960.4242; val_cat_covariates_contrastive_loss: 952343.3201; val_gene_expr_recon_loss: 1820177.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3519216.5452; val_optim_loss: 3519216.5452
