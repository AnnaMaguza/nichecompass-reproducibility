[True]
Run timestamp: 07092023_053212_272.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_272']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 18606 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21320, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6367; val_auprc_score: 0.6210; val_best_acc_score: 0.5188; val_best_f1_score: 0.6723; train_kl_reg_loss: 65738.5559; train_edge_recon_loss: 3619733.5455; train_gene_expr_recon_loss: 13035831.9242; train_masked_gp_l1_reg_loss: 34840.4487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5653600.7273; train_chrom_access_recon_loss: 41298884.6061; train_global_loss: 63708630.1212; train_optim_loss: 63708630.1212; val_kl_reg_loss: 170436.9434; val_edge_recon_loss: 4064124.9062; val_gene_expr_recon_loss: 11865275.0000; val_masked_gp_l1_reg_loss: 32880.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2125897.0000; val_chrom_access_recon_loss: 40027873.0000; val_global_loss: 58286487.5000; val_optim_loss: 58286487.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7410; val_auprc_score: 0.7203; val_best_acc_score: 0.6601; val_best_f1_score: 0.7115; train_kl_reg_loss: 123783.0407; train_edge_recon_loss: 3560593.8371; train_gene_expr_recon_loss: 11488791.7424; train_masked_gp_l1_reg_loss: 29497.8412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 840572.5109; train_chrom_access_recon_loss: 39234450.6667; train_global_loss: 55277689.5152; train_optim_loss: 55277689.5152; val_kl_reg_loss: 124463.2900; val_edge_recon_loss: 4052401.3750; val_gene_expr_recon_loss: 11357027.6250; val_masked_gp_l1_reg_loss: 27316.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 328309.9688; val_chrom_access_recon_loss: 39438637.5000; val_global_loss: 55328157.0000; val_optim_loss: 55328157.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8106; val_auprc_score: 0.7831; val_best_acc_score: 0.7351; val_best_f1_score: 0.7645; train_kl_reg_loss: 121148.7724; train_edge_recon_loss: 3533880.0455; train_gene_expr_recon_loss: 11187078.9545; train_masked_gp_l1_reg_loss: 27044.2507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244145.8213; train_chrom_access_recon_loss: 38771772.2424; train_global_loss: 53885069.8788; train_optim_loss: 53885069.8788; val_kl_reg_loss: 124483.3945; val_edge_recon_loss: 3935281.1562; val_gene_expr_recon_loss: 11077348.7500; val_masked_gp_l1_reg_loss: 27288.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 187880.5000; val_chrom_access_recon_loss: 38878102.0000; val_global_loss: 54230385.0000; val_optim_loss: 54230385.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8436; val_auprc_score: 0.8074; val_best_acc_score: 0.7625; val_best_f1_score: 0.7905; train_kl_reg_loss: 97750.4457; train_edge_recon_loss: 3366869.2917; train_gene_expr_recon_loss: 11087673.2273; train_masked_gp_l1_reg_loss: 27922.6568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163472.6650; train_chrom_access_recon_loss: 38576726.4242; train_global_loss: 53320414.2424; train_optim_loss: 53320414.2424; val_kl_reg_loss: 111200.2607; val_edge_recon_loss: 3097925.0625; val_gene_expr_recon_loss: 11081077.5000; val_masked_gp_l1_reg_loss: 28698.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145233.9688; val_chrom_access_recon_loss: 38621300.0000; val_global_loss: 53085435.0000; val_optim_loss: 53085435.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8546; val_auprc_score: 0.8186; val_best_acc_score: 0.7813; val_best_f1_score: 0.8011; train_kl_reg_loss: 132064.1183; train_edge_recon_loss: 3017923.6439; train_gene_expr_recon_loss: 11011070.2121; train_masked_gp_l1_reg_loss: 29560.9376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134334.5723; train_chrom_access_recon_loss: 38358055.9394; train_global_loss: 52683009.4545; train_optim_loss: 52683009.4545; val_kl_reg_loss: 126261.8652; val_edge_recon_loss: 3026041.1562; val_gene_expr_recon_loss: 10945941.3750; val_masked_gp_l1_reg_loss: 30247.7012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125776.9688; val_chrom_access_recon_loss: 38517091.5000; val_global_loss: 52771361.0000; val_optim_loss: 52771361.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8569; val_auprc_score: 0.8158; val_best_acc_score: 0.7918; val_best_f1_score: 0.8139; train_kl_reg_loss: 128401.2770; train_edge_recon_loss: 2953020.8068; train_gene_expr_recon_loss: 10922522.5606; train_masked_gp_l1_reg_loss: 30798.4975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119884.7138; train_chrom_access_recon_loss: 38129057.3939; train_global_loss: 52283685.2727; train_optim_loss: 52283685.2727; val_kl_reg_loss: 126073.3701; val_edge_recon_loss: 2943455.5938; val_gene_expr_recon_loss: 10812834.7500; val_masked_gp_l1_reg_loss: 31473.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115845.9531; val_chrom_access_recon_loss: 38441967.5000; val_global_loss: 52471651.0000; val_optim_loss: 52471651.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8562; val_auprc_score: 0.8156; val_best_acc_score: 0.7923; val_best_f1_score: 0.8182; train_kl_reg_loss: 126996.4980; train_edge_recon_loss: 2910436.6818; train_gene_expr_recon_loss: 10877758.6061; train_masked_gp_l1_reg_loss: 32019.8349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112591.4231; train_chrom_access_recon_loss: 37994747.6364; train_global_loss: 52054550.2424; train_optim_loss: 52054550.2424; val_kl_reg_loss: 120816.4287; val_edge_recon_loss: 2933276.1875; val_gene_expr_recon_loss: 10793535.7500; val_masked_gp_l1_reg_loss: 32661.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109861.8750; val_chrom_access_recon_loss: 38387886.5000; val_global_loss: 52378038.0000; val_optim_loss: 52378038.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8798; val_auprc_score: 0.8419; val_best_acc_score: 0.8141; val_best_f1_score: 0.8351; train_kl_reg_loss: 124175.1424; train_edge_recon_loss: 2888284.0985; train_gene_expr_recon_loss: 10821335.3636; train_masked_gp_l1_reg_loss: 33192.8986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107562.2596; train_chrom_access_recon_loss: 37828607.3939; train_global_loss: 51803157.2121; train_optim_loss: 51803157.2121; val_kl_reg_loss: 117778.8535; val_edge_recon_loss: 2857590.7500; val_gene_expr_recon_loss: 10842877.8750; val_masked_gp_l1_reg_loss: 33858.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105665.3438; val_chrom_access_recon_loss: 38378805.0000; val_global_loss: 52336577.0000; val_optim_loss: 52336577.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8816; val_auprc_score: 0.8444; val_best_acc_score: 0.8090; val_best_f1_score: 0.8277; train_kl_reg_loss: 123796.3486; train_edge_recon_loss: 2859768.2083; train_gene_expr_recon_loss: 10770462.0909; train_masked_gp_l1_reg_loss: 34328.6873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104112.3408; train_chrom_access_recon_loss: 37659970.1212; train_global_loss: 51552437.7576; train_optim_loss: 51552437.7576; val_kl_reg_loss: 120972.4697; val_edge_recon_loss: 2882494.7812; val_gene_expr_recon_loss: 10762593.8750; val_masked_gp_l1_reg_loss: 34825.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102855.3906; val_chrom_access_recon_loss: 37828327.0000; val_global_loss: 51732068.0000; val_optim_loss: 51732068.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8867; val_auprc_score: 0.8503; val_best_acc_score: 0.8162; val_best_f1_score: 0.8329; train_kl_reg_loss: 121609.7306; train_edge_recon_loss: 2843331.1402; train_gene_expr_recon_loss: 10727372.4242; train_masked_gp_l1_reg_loss: 35330.9730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101534.0062; train_chrom_access_recon_loss: 37512726.4242; train_global_loss: 51341904.5455; train_optim_loss: 51341904.5455; val_kl_reg_loss: 119842.1514; val_edge_recon_loss: 2846146.4062; val_gene_expr_recon_loss: 10728178.3750; val_masked_gp_l1_reg_loss: 35858.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100203.1484; val_chrom_access_recon_loss: 37452597.5000; val_global_loss: 51282826.0000; val_optim_loss: 51282826.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8917; val_auprc_score: 0.8560; val_best_acc_score: 0.8262; val_best_f1_score: 0.8382; train_kl_reg_loss: 118489.7434; train_edge_recon_loss: 2837793.9242; train_gene_expr_recon_loss: 10668715.3636; train_masked_gp_l1_reg_loss: 36312.3116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98880.6374; train_chrom_access_recon_loss: 37370317.7576; train_global_loss: 51130509.8788; train_optim_loss: 51130509.8788; val_kl_reg_loss: 114296.8252; val_edge_recon_loss: 2880449.3125; val_gene_expr_recon_loss: 10646462.7500; val_masked_gp_l1_reg_loss: 36863.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98287.5078; val_chrom_access_recon_loss: 37851250.0000; val_global_loss: 51627610.5000; val_optim_loss: 51627610.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8943; val_auprc_score: 0.8540; val_best_acc_score: 0.8297; val_best_f1_score: 0.8405; train_kl_reg_loss: 113450.8761; train_edge_recon_loss: 2837307.2235; train_gene_expr_recon_loss: 10638075.1515; train_masked_gp_l1_reg_loss: 37309.7664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97066.3952; train_chrom_access_recon_loss: 37266841.2727; train_global_loss: 50990050.6667; train_optim_loss: 50990050.6667; val_kl_reg_loss: 112287.8799; val_edge_recon_loss: 2846998.3125; val_gene_expr_recon_loss: 10586188.7500; val_masked_gp_l1_reg_loss: 37860.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96514.7891; val_chrom_access_recon_loss: 37648093.5000; val_global_loss: 51327944.5000; val_optim_loss: 51327944.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8971; val_auprc_score: 0.8683; val_best_acc_score: 0.8329; val_best_f1_score: 0.8447; train_kl_reg_loss: 112453.0408; train_edge_recon_loss: 2812733.6970; train_gene_expr_recon_loss: 10604736.5455; train_masked_gp_l1_reg_loss: 38209.5583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95799.7320; train_chrom_access_recon_loss: 37104764.1818; train_global_loss: 50768696.7273; train_optim_loss: 50768696.7273; val_kl_reg_loss: 113244.0869; val_edge_recon_loss: 2865021.9062; val_gene_expr_recon_loss: 10562418.2500; val_masked_gp_l1_reg_loss: 38627.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94970.0078; val_chrom_access_recon_loss: 37434715.0000; val_global_loss: 51108995.5000; val_optim_loss: 51108995.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9058; val_auprc_score: 0.8732; val_best_acc_score: 0.8409; val_best_f1_score: 0.8511; train_kl_reg_loss: 114493.8852; train_edge_recon_loss: 2777955.2159; train_gene_expr_recon_loss: 10562979.2879; train_masked_gp_l1_reg_loss: 39099.2195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94172.7031; train_chrom_access_recon_loss: 36949584.0000; train_global_loss: 50538284.1212; train_optim_loss: 50538284.1212; val_kl_reg_loss: 113328.8867; val_edge_recon_loss: 2857957.1562; val_gene_expr_recon_loss: 10586184.3750; val_masked_gp_l1_reg_loss: 39517.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93669.1875; val_chrom_access_recon_loss: 37327602.0000; val_global_loss: 51018259.0000; val_optim_loss: 51018259.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9015; val_auprc_score: 0.8590; val_best_acc_score: 0.8407; val_best_f1_score: 0.8519; train_kl_reg_loss: 113638.3819; train_edge_recon_loss: 2780749.2917; train_gene_expr_recon_loss: 10533648.1667; train_masked_gp_l1_reg_loss: 39855.5670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92988.5281; train_chrom_access_recon_loss: 36858751.8182; train_global_loss: 50419631.9394; train_optim_loss: 50419631.9394; val_kl_reg_loss: 115581.1045; val_edge_recon_loss: 2834481.5625; val_gene_expr_recon_loss: 10645879.3750; val_masked_gp_l1_reg_loss: 40329.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92289.0000; val_chrom_access_recon_loss: 37522484.5000; val_global_loss: 51251044.5000; val_optim_loss: 51251044.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9069; val_auprc_score: 0.8763; val_best_acc_score: 0.8439; val_best_f1_score: 0.8587; train_kl_reg_loss: 112097.7753; train_edge_recon_loss: 2773068.7083; train_gene_expr_recon_loss: 10505106.0758; train_masked_gp_l1_reg_loss: 40630.2498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92061.8266; train_chrom_access_recon_loss: 36758864.0000; train_global_loss: 50281828.4848; train_optim_loss: 50281828.4848; val_kl_reg_loss: 112481.3408; val_edge_recon_loss: 2853303.9375; val_gene_expr_recon_loss: 10504975.8750; val_masked_gp_l1_reg_loss: 40996.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91659.0859; val_chrom_access_recon_loss: 37299630.0000; val_global_loss: 50903046.0000; val_optim_loss: 50903046.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9165; val_auprc_score: 0.8822; val_best_acc_score: 0.8606; val_best_f1_score: 0.8711; train_kl_reg_loss: 111946.4369; train_edge_recon_loss: 2753516.3712; train_gene_expr_recon_loss: 10478225.3788; train_masked_gp_l1_reg_loss: 41338.1243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91119.4787; train_chrom_access_recon_loss: 36654257.8182; train_global_loss: 50130403.5758; train_optim_loss: 50130403.5758; val_kl_reg_loss: 109525.0000; val_edge_recon_loss: 2783822.7812; val_gene_expr_recon_loss: 10583832.2500; val_masked_gp_l1_reg_loss: 41646.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90604.8750; val_chrom_access_recon_loss: 37261234.5000; val_global_loss: 50870666.5000; val_optim_loss: 50870666.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9154; val_auprc_score: 0.8789; val_best_acc_score: 0.8579; val_best_f1_score: 0.8693; train_kl_reg_loss: 111114.1011; train_edge_recon_loss: 2762669.5530; train_gene_expr_recon_loss: 10447249.0303; train_masked_gp_l1_reg_loss: 42011.5234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90144.9487; train_chrom_access_recon_loss: 36475954.2424; train_global_loss: 49929143.6364; train_optim_loss: 49929143.6364; val_kl_reg_loss: 111076.6377; val_edge_recon_loss: 2789351.7812; val_gene_expr_recon_loss: 10440943.7500; val_masked_gp_l1_reg_loss: 42304.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89981.4297; val_chrom_access_recon_loss: 37010804.5000; val_global_loss: 50484461.5000; val_optim_loss: 50484461.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9224; val_auprc_score: 0.8939; val_best_acc_score: 0.8608; val_best_f1_score: 0.8726; train_kl_reg_loss: 109122.5829; train_edge_recon_loss: 2758281.6439; train_gene_expr_recon_loss: 10416952.9394; train_masked_gp_l1_reg_loss: 42656.7126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89345.9517; train_chrom_access_recon_loss: 36392592.6667; train_global_loss: 49808952.5455; train_optim_loss: 49808952.5455; val_kl_reg_loss: 109009.2266; val_edge_recon_loss: 2796457.6250; val_gene_expr_recon_loss: 10539317.8750; val_masked_gp_l1_reg_loss: 42962.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88736.8516; val_chrom_access_recon_loss: 36918699.5000; val_global_loss: 50495185.0000; val_optim_loss: 50495185.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9317; val_auprc_score: 0.9085; val_best_acc_score: 0.8740; val_best_f1_score: 0.8843; train_kl_reg_loss: 106961.4303; train_edge_recon_loss: 2748646.8902; train_gene_expr_recon_loss: 10395322.9545; train_masked_gp_l1_reg_loss: 43295.3761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88600.2647; train_chrom_access_recon_loss: 36237014.7273; train_global_loss: 49619841.6364; train_optim_loss: 49619841.6364; val_kl_reg_loss: 108198.4736; val_edge_recon_loss: 2771306.3750; val_gene_expr_recon_loss: 10480137.1250; val_masked_gp_l1_reg_loss: 43614.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88440.1094; val_chrom_access_recon_loss: 36700066.5000; val_global_loss: 50191761.5000; val_optim_loss: 50191761.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9285; val_auprc_score: 0.9025; val_best_acc_score: 0.8697; val_best_f1_score: 0.8781; train_kl_reg_loss: 106806.6404; train_edge_recon_loss: 2756076.0833; train_gene_expr_recon_loss: 10361542.6515; train_masked_gp_l1_reg_loss: 43860.7102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88275.5484; train_chrom_access_recon_loss: 36117395.5152; train_global_loss: 49473957.3333; train_optim_loss: 49473957.3333; val_kl_reg_loss: 106479.8057; val_edge_recon_loss: 2791270.7812; val_gene_expr_recon_loss: 10530372.0000; val_masked_gp_l1_reg_loss: 44143.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88102.3203; val_chrom_access_recon_loss: 37175526.0000; val_global_loss: 50735893.5000; val_optim_loss: 50735893.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9243; val_auprc_score: 0.8957; val_best_acc_score: 0.8619; val_best_f1_score: 0.8717; train_kl_reg_loss: 104933.0301; train_edge_recon_loss: 2745685.4167; train_gene_expr_recon_loss: 10347229.0303; train_masked_gp_l1_reg_loss: 44443.8748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87791.2836; train_chrom_access_recon_loss: 36010802.6667; train_global_loss: 49340885.2121; train_optim_loss: 49340885.2121; val_kl_reg_loss: 107023.1162; val_edge_recon_loss: 2811439.8750; val_gene_expr_recon_loss: 10372389.3750; val_masked_gp_l1_reg_loss: 44688.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87699.7109; val_chrom_access_recon_loss: 36508122.5000; val_global_loss: 49931364.0000; val_optim_loss: 49931364.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9299; val_auprc_score: 0.9022; val_best_acc_score: 0.8724; val_best_f1_score: 0.8809; train_kl_reg_loss: 103829.9988; train_edge_recon_loss: 2749405.7197; train_gene_expr_recon_loss: 10327683.8485; train_masked_gp_l1_reg_loss: 44992.1472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87505.9871; train_chrom_access_recon_loss: 35909884.7273; train_global_loss: 49223302.3030; train_optim_loss: 49223302.3030; val_kl_reg_loss: 102662.2227; val_edge_recon_loss: 2764032.8125; val_gene_expr_recon_loss: 10300455.6250; val_masked_gp_l1_reg_loss: 45211.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87501.3906; val_chrom_access_recon_loss: 36324371.5000; val_global_loss: 49624235.5000; val_optim_loss: 49624235.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9376; val_auprc_score: 0.9161; val_best_acc_score: 0.8831; val_best_f1_score: 0.8892; train_kl_reg_loss: 103116.0906; train_edge_recon_loss: 2737051.1061; train_gene_expr_recon_loss: 10294623.2121; train_masked_gp_l1_reg_loss: 45481.0711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87189.1831; train_chrom_access_recon_loss: 35765188.2424; train_global_loss: 49032648.9091; train_optim_loss: 49032648.9091; val_kl_reg_loss: 101884.6289; val_edge_recon_loss: 2760396.8750; val_gene_expr_recon_loss: 10374363.7500; val_masked_gp_l1_reg_loss: 45752.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87070.1797; val_chrom_access_recon_loss: 36681414.0000; val_global_loss: 50050882.0000; val_optim_loss: 50050882.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9375; val_auprc_score: 0.9147; val_best_acc_score: 0.8788; val_best_f1_score: 0.8855; train_kl_reg_loss: 102259.1667; train_edge_recon_loss: 2736268.1970; train_gene_expr_recon_loss: 10284669.7424; train_masked_gp_l1_reg_loss: 46006.5681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86754.7617; train_chrom_access_recon_loss: 35675159.6667; train_global_loss: 48931118.0606; train_optim_loss: 48931118.0606; val_kl_reg_loss: 101506.9746; val_edge_recon_loss: 2776627.6250; val_gene_expr_recon_loss: 10299961.1250; val_masked_gp_l1_reg_loss: 46278.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86781.7109; val_chrom_access_recon_loss: 36437516.0000; val_global_loss: 49748672.5000; val_optim_loss: 49748672.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9449; val_auprc_score: 0.9246; val_best_acc_score: 0.8893; val_best_f1_score: 0.8932; train_kl_reg_loss: 102374.7460; train_edge_recon_loss: 2749692.3106; train_gene_expr_recon_loss: 10186349.6515; train_masked_gp_l1_reg_loss: 45538.4113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89824.0951; train_chrom_access_recon_loss: 35911056.4848; train_global_loss: 49084835.6970; train_optim_loss: 49084835.6970; val_kl_reg_loss: 76002.1113; val_edge_recon_loss: 2753965.5625; val_gene_expr_recon_loss: 10151581.5000; val_masked_gp_l1_reg_loss: 45187.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91407.8203; val_chrom_access_recon_loss: 36047756.0000; val_global_loss: 49165900.0000; val_optim_loss: 49165900.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9378; val_auprc_score: 0.9181; val_best_acc_score: 0.8753; val_best_f1_score: 0.8828; train_kl_reg_loss: 103306.4426; train_edge_recon_loss: 2754839.3447; train_gene_expr_recon_loss: 10136159.7727; train_masked_gp_l1_reg_loss: 45210.8369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90172.7332; train_chrom_access_recon_loss: 35547183.3030; train_global_loss: 48676872.1818; train_optim_loss: 48676872.1818; val_kl_reg_loss: 77094.6279; val_edge_recon_loss: 2804089.9688; val_gene_expr_recon_loss: 10188916.3750; val_masked_gp_l1_reg_loss: 45217.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89102.9453; val_chrom_access_recon_loss: 35914287.5000; val_global_loss: 49118709.5000; val_optim_loss: 49118709.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9414; val_auprc_score: 0.9197; val_best_acc_score: 0.8837; val_best_f1_score: 0.8874; train_kl_reg_loss: 100624.4820; train_edge_recon_loss: 2736617.0417; train_gene_expr_recon_loss: 10109189.5303; train_masked_gp_l1_reg_loss: 45291.8354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87953.7712; train_chrom_access_recon_loss: 35417723.0606; train_global_loss: 48497399.5758; train_optim_loss: 48497399.5758; val_kl_reg_loss: 78403.6123; val_edge_recon_loss: 2793614.5312; val_gene_expr_recon_loss: 10164941.0000; val_masked_gp_l1_reg_loss: 45350.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86950.0234; val_chrom_access_recon_loss: 36144903.5000; val_global_loss: 49314163.0000; val_optim_loss: 49314163.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9463; val_auprc_score: 0.9234; val_best_acc_score: 0.8923; val_best_f1_score: 0.8976; train_kl_reg_loss: 97650.0614; train_edge_recon_loss: 2733920.7576; train_gene_expr_recon_loss: 10097742.3939; train_masked_gp_l1_reg_loss: 45471.3079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86415.9316; train_chrom_access_recon_loss: 35371938.7879; train_global_loss: 48433139.0909; train_optim_loss: 48433139.0909; val_kl_reg_loss: 78405.3389; val_edge_recon_loss: 2742604.5312; val_gene_expr_recon_loss: 10138135.8750; val_masked_gp_l1_reg_loss: 45584.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86203.1875; val_chrom_access_recon_loss: 35655555.5000; val_global_loss: 48746487.0000; val_optim_loss: 48746487.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9455; val_auprc_score: 0.9257; val_best_acc_score: 0.8904; val_best_f1_score: 0.8939; train_kl_reg_loss: 95323.8145; train_edge_recon_loss: 2730314.6553; train_gene_expr_recon_loss: 10066030.8485; train_masked_gp_l1_reg_loss: 45686.5426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85204.9259; train_chrom_access_recon_loss: 35257247.3636; train_global_loss: 48279808.0606; train_optim_loss: 48279808.0606; val_kl_reg_loss: 78726.0781; val_edge_recon_loss: 2758826.5000; val_gene_expr_recon_loss: 10131367.8750; val_masked_gp_l1_reg_loss: 45804.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84134.3828; val_chrom_access_recon_loss: 35772181.5000; val_global_loss: 48871041.0000; val_optim_loss: 48871041.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9484; val_auprc_score: 0.9239; val_best_acc_score: 0.8974; val_best_f1_score: 0.9021; train_kl_reg_loss: 94347.6294; train_edge_recon_loss: 2720356.2955; train_gene_expr_recon_loss: 10051061.4242; train_masked_gp_l1_reg_loss: 45927.2310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84108.8548; train_chrom_access_recon_loss: 35166427.5758; train_global_loss: 48162228.8485; train_optim_loss: 48162228.8485; val_kl_reg_loss: 84096.8613; val_edge_recon_loss: 2732688.0000; val_gene_expr_recon_loss: 10095535.6250; val_masked_gp_l1_reg_loss: 46031.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83458.1719; val_chrom_access_recon_loss: 35717625.0000; val_global_loss: 48759435.0000; val_optim_loss: 48759435.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9456; val_auprc_score: 0.9211; val_best_acc_score: 0.8955; val_best_f1_score: 0.9011; train_kl_reg_loss: 93998.3080; train_edge_recon_loss: 2717017.7424; train_gene_expr_recon_loss: 10034438.1515; train_masked_gp_l1_reg_loss: 46119.2272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83160.2173; train_chrom_access_recon_loss: 35084213.3333; train_global_loss: 48058947.0909; train_optim_loss: 48058947.0909; val_kl_reg_loss: 82335.0215; val_edge_recon_loss: 2756317.7500; val_gene_expr_recon_loss: 9999569.0000; val_masked_gp_l1_reg_loss: 46265.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83095.3047; val_chrom_access_recon_loss: 35257466.5000; val_global_loss: 48225048.0000; val_optim_loss: 48225048.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9513; val_auprc_score: 0.9338; val_best_acc_score: 0.8958; val_best_f1_score: 0.8993; train_kl_reg_loss: 91873.9357; train_edge_recon_loss: 2708569.1553; train_gene_expr_recon_loss: 10022424.3485; train_masked_gp_l1_reg_loss: 46376.2557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82428.8654; train_chrom_access_recon_loss: 35029362.2727; train_global_loss: 47981034.9697; train_optim_loss: 47981034.9697; val_kl_reg_loss: 82989.9854; val_edge_recon_loss: 2760236.4688; val_gene_expr_recon_loss: 9995224.5000; val_masked_gp_l1_reg_loss: 46488.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82158.9453; val_chrom_access_recon_loss: 35277397.5000; val_global_loss: 48244495.0000; val_optim_loss: 48244495.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9509; val_auprc_score: 0.9323; val_best_acc_score: 0.8990; val_best_f1_score: 0.9046; train_kl_reg_loss: 91664.1957; train_edge_recon_loss: 2715849.8977; train_gene_expr_recon_loss: 10003223.9394; train_masked_gp_l1_reg_loss: 46599.2939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81833.8268; train_chrom_access_recon_loss: 34961599.6061; train_global_loss: 47900770.8485; train_optim_loss: 47900770.8485; val_kl_reg_loss: 85047.8984; val_edge_recon_loss: 2734165.7500; val_gene_expr_recon_loss: 10131703.6250; val_masked_gp_l1_reg_loss: 46737.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81168.4531; val_chrom_access_recon_loss: 35457123.5000; val_global_loss: 48535946.0000; val_optim_loss: 48535946.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9452; val_auprc_score: 0.9201; val_best_acc_score: 0.8982; val_best_f1_score: 0.9040; train_kl_reg_loss: 91102.1555; train_edge_recon_loss: 2707535.7462; train_gene_expr_recon_loss: 9990275.7121; train_masked_gp_l1_reg_loss: 46840.1445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81173.9776; train_chrom_access_recon_loss: 34877418.6667; train_global_loss: 47794346.3636; train_optim_loss: 47794346.3636; val_kl_reg_loss: 82201.7559; val_edge_recon_loss: 2764416.6250; val_gene_expr_recon_loss: 10019764.1250; val_masked_gp_l1_reg_loss: 46984.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81268.5703; val_chrom_access_recon_loss: 35287837.0000; val_global_loss: 48282472.5000; val_optim_loss: 48282472.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9487; val_auprc_score: 0.9236; val_best_acc_score: 0.9046; val_best_f1_score: 0.9090; train_kl_reg_loss: 90508.5768; train_edge_recon_loss: 2714755.1174; train_gene_expr_recon_loss: 9971870.0909; train_masked_gp_l1_reg_loss: 47082.0248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80820.5578; train_chrom_access_recon_loss: 34781390.0606; train_global_loss: 47686426.4242; train_optim_loss: 47686426.4242; val_kl_reg_loss: 84060.1367; val_edge_recon_loss: 2753951.5000; val_gene_expr_recon_loss: 10059242.3750; val_masked_gp_l1_reg_loss: 47217.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80909.5547; val_chrom_access_recon_loss: 35401518.0000; val_global_loss: 48426898.5000; val_optim_loss: 48426898.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9568; val_auprc_score: 0.9375; val_best_acc_score: 0.9035; val_best_f1_score: 0.9082; train_kl_reg_loss: 90179.3855; train_edge_recon_loss: 2697269.0455; train_gene_expr_recon_loss: 9959857.1667; train_masked_gp_l1_reg_loss: 47003.7616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64131.6391; train_chrom_access_recon_loss: 34755892.1818; train_global_loss: 47614333.2727; train_optim_loss: 47614333.2727; val_kl_reg_loss: 84670.8330; val_edge_recon_loss: 2741453.3125; val_gene_expr_recon_loss: 9999703.5000; val_masked_gp_l1_reg_loss: 46883.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61196.1484; val_chrom_access_recon_loss: 35486868.0000; val_global_loss: 48420775.0000; val_optim_loss: 48420775.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9563; val_auprc_score: 0.9398; val_best_acc_score: 0.9041; val_best_f1_score: 0.9079; train_kl_reg_loss: 91134.3780; train_edge_recon_loss: 2697105.7121; train_gene_expr_recon_loss: 9955045.7576; train_masked_gp_l1_reg_loss: 46843.9747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61037.6786; train_chrom_access_recon_loss: 34729851.8788; train_global_loss: 47581019.4545; train_optim_loss: 47581019.4545; val_kl_reg_loss: 86236.4863; val_edge_recon_loss: 2722013.4062; val_gene_expr_recon_loss: 9981830.6250; val_masked_gp_l1_reg_loss: 46818.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60935.8008; val_chrom_access_recon_loss: 35320730.0000; val_global_loss: 48218564.5000; val_optim_loss: 48218564.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9523; val_auprc_score: 0.9311; val_best_acc_score: 0.9011; val_best_f1_score: 0.9054; train_kl_reg_loss: 90753.7666; train_edge_recon_loss: 2709983.1894; train_gene_expr_recon_loss: 9950495.5606; train_masked_gp_l1_reg_loss: 46807.5611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60771.4902; train_chrom_access_recon_loss: 34678742.0606; train_global_loss: 47537553.4545; train_optim_loss: 47537553.4545; val_kl_reg_loss: 85592.8018; val_edge_recon_loss: 2729712.4062; val_gene_expr_recon_loss: 10065500.6250; val_masked_gp_l1_reg_loss: 46794.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60678.2695; val_chrom_access_recon_loss: 35314892.0000; val_global_loss: 48303169.5000; val_optim_loss: 48303169.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9563; val_auprc_score: 0.9412; val_best_acc_score: 0.8998; val_best_f1_score: 0.9055; train_kl_reg_loss: 91289.2375; train_edge_recon_loss: 2706228.6477; train_gene_expr_recon_loss: 9950285.9848; train_masked_gp_l1_reg_loss: 46786.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60606.7132; train_chrom_access_recon_loss: 34692720.1515; train_global_loss: 47547916.8485; train_optim_loss: 47547916.8485; val_kl_reg_loss: 85519.6133; val_edge_recon_loss: 2748562.6875; val_gene_expr_recon_loss: 10081354.1250; val_masked_gp_l1_reg_loss: 46789.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60509.2188; val_chrom_access_recon_loss: 35430728.5000; val_global_loss: 48453463.5000; val_optim_loss: 48453463.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9489; val_auprc_score: 0.9306; val_best_acc_score: 0.8984; val_best_f1_score: 0.9037; train_kl_reg_loss: 91278.3505; train_edge_recon_loss: 2701659.0682; train_gene_expr_recon_loss: 9945886.6667; train_masked_gp_l1_reg_loss: 46792.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60415.1912; train_chrom_access_recon_loss: 34643592.7576; train_global_loss: 47489624.5455; train_optim_loss: 47489624.5455; val_kl_reg_loss: 85551.9053; val_edge_recon_loss: 2759562.6875; val_gene_expr_recon_loss: 9939397.0000; val_masked_gp_l1_reg_loss: 46787.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60361.0117; val_chrom_access_recon_loss: 35148332.5000; val_global_loss: 48039993.0000; val_optim_loss: 48039993.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9564; val_auprc_score: 0.9384; val_best_acc_score: 0.9078; val_best_f1_score: 0.9120; train_kl_reg_loss: 91035.4815; train_edge_recon_loss: 2691769.6894; train_gene_expr_recon_loss: 9936533.2273; train_masked_gp_l1_reg_loss: 46794.6539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60224.2952; train_chrom_access_recon_loss: 34611802.3939; train_global_loss: 47438159.4545; train_optim_loss: 47438159.4545; val_kl_reg_loss: 86707.8975; val_edge_recon_loss: 2701103.5000; val_gene_expr_recon_loss: 10030345.7500; val_masked_gp_l1_reg_loss: 46798.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60135.0469; val_chrom_access_recon_loss: 35303081.5000; val_global_loss: 48228171.5000; val_optim_loss: 48228171.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9597; val_auprc_score: 0.9451; val_best_acc_score: 0.9095; val_best_f1_score: 0.9136; train_kl_reg_loss: 91814.0418; train_edge_recon_loss: 2699000.8561; train_gene_expr_recon_loss: 9929084.4545; train_masked_gp_l1_reg_loss: 46810.9036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60062.0588; train_chrom_access_recon_loss: 34583904.2121; train_global_loss: 47410676.4848; train_optim_loss: 47410676.4848; val_kl_reg_loss: 86817.5029; val_edge_recon_loss: 2717094.7812; val_gene_expr_recon_loss: 10018995.0000; val_masked_gp_l1_reg_loss: 46812.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59963.6211; val_chrom_access_recon_loss: 35095780.5000; val_global_loss: 48025463.5000; val_optim_loss: 48025463.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9605; val_auprc_score: 0.9481; val_best_acc_score: 0.9081; val_best_f1_score: 0.9108; train_kl_reg_loss: 91259.0534; train_edge_recon_loss: 2703385.8561; train_gene_expr_recon_loss: 9935140.2121; train_masked_gp_l1_reg_loss: 46817.3645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59867.7633; train_chrom_access_recon_loss: 34600458.3030; train_global_loss: 47436928.6667; train_optim_loss: 47436928.6667; val_kl_reg_loss: 86507.4160; val_edge_recon_loss: 2718610.7500; val_gene_expr_recon_loss: 10107384.6250; val_masked_gp_l1_reg_loss: 46821.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59763.4102; val_chrom_access_recon_loss: 35781896.5000; val_global_loss: 48800983.5000; val_optim_loss: 48800983.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9531; val_auprc_score: 0.9294; val_best_acc_score: 0.8976; val_best_f1_score: 0.9033; train_kl_reg_loss: 90497.4972; train_edge_recon_loss: 2700504.1591; train_gene_expr_recon_loss: 9941026.9848; train_masked_gp_l1_reg_loss: 46830.8576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59707.3781; train_chrom_access_recon_loss: 34644865.7576; train_global_loss: 47483432.7879; train_optim_loss: 47483432.7879; val_kl_reg_loss: 86132.0547; val_edge_recon_loss: 2763599.1562; val_gene_expr_recon_loss: 9970475.0000; val_masked_gp_l1_reg_loss: 46839.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59715.3203; val_chrom_access_recon_loss: 35019786.0000; val_global_loss: 47946548.0000; val_optim_loss: 47946548.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9597; val_auprc_score: 0.9455; val_best_acc_score: 0.9130; val_best_f1_score: 0.9167; train_kl_reg_loss: 90653.8813; train_edge_recon_loss: 2695505.5038; train_gene_expr_recon_loss: 9942465.1061; train_masked_gp_l1_reg_loss: 46857.3455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59567.5981; train_chrom_access_recon_loss: 34641303.8182; train_global_loss: 47476353.2121; train_optim_loss: 47476353.2121; val_kl_reg_loss: 86396.1553; val_edge_recon_loss: 2700807.5312; val_gene_expr_recon_loss: 9946904.5000; val_masked_gp_l1_reg_loss: 46860.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59497.8047; val_chrom_access_recon_loss: 35230991.5000; val_global_loss: 48071458.0000; val_optim_loss: 48071458.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9635; val_auprc_score: 0.9511; val_best_acc_score: 0.9113; val_best_f1_score: 0.9136; train_kl_reg_loss: 90663.1454; train_edge_recon_loss: 2699785.8447; train_gene_expr_recon_loss: 9932756.2121; train_masked_gp_l1_reg_loss: 46870.7593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59401.3612; train_chrom_access_recon_loss: 34600279.7879; train_global_loss: 47429756.7879; train_optim_loss: 47429756.7879; val_kl_reg_loss: 85691.4424; val_edge_recon_loss: 2746668.1250; val_gene_expr_recon_loss: 9932851.5000; val_masked_gp_l1_reg_loss: 46878.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59260.2734; val_chrom_access_recon_loss: 34699278.5000; val_global_loss: 47570629.0000; val_optim_loss: 47570629.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9550; val_auprc_score: 0.9348; val_best_acc_score: 0.9076; val_best_f1_score: 0.9120; train_kl_reg_loss: 89990.7260; train_edge_recon_loss: 2695381.4053; train_gene_expr_recon_loss: 9922757.4545; train_masked_gp_l1_reg_loss: 46894.1826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59221.2104; train_chrom_access_recon_loss: 34553470.0606; train_global_loss: 47367715.2121; train_optim_loss: 47367715.2121; val_kl_reg_loss: 86060.5371; val_edge_recon_loss: 2742832.7812; val_gene_expr_recon_loss: 9948306.7500; val_masked_gp_l1_reg_loss: 46902.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59172.2734; val_chrom_access_recon_loss: 34666969.0000; val_global_loss: 47550244.5000; val_optim_loss: 47550244.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9612; val_auprc_score: 0.9481; val_best_acc_score: 0.9089; val_best_f1_score: 0.9132; train_kl_reg_loss: 90075.4201; train_edge_recon_loss: 2696672.3977; train_gene_expr_recon_loss: 9927578.7424; train_masked_gp_l1_reg_loss: 46916.5892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59070.4192; train_chrom_access_recon_loss: 34556659.4848; train_global_loss: 47376972.9697; train_optim_loss: 47376972.9697; val_kl_reg_loss: 86765.3604; val_edge_recon_loss: 2730840.8125; val_gene_expr_recon_loss: 10106136.2500; val_masked_gp_l1_reg_loss: 46924.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58973.0703; val_chrom_access_recon_loss: 35501335.0000; val_global_loss: 48530976.0000; val_optim_loss: 48530976.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9653; val_auprc_score: 0.9562; val_best_acc_score: 0.9124; val_best_f1_score: 0.9167; train_kl_reg_loss: 90371.1243; train_edge_recon_loss: 2694499.2197; train_gene_expr_recon_loss: 9921744.4242; train_masked_gp_l1_reg_loss: 46938.0709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58983.9292; train_chrom_access_recon_loss: 34526738.6364; train_global_loss: 47339275.3333; train_optim_loss: 47339275.3333; val_kl_reg_loss: 86419.3516; val_edge_recon_loss: 2730683.1250; val_gene_expr_recon_loss: 10000497.3750; val_masked_gp_l1_reg_loss: 46946.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58956.2461; val_chrom_access_recon_loss: 35020850.5000; val_global_loss: 47944353.5000; val_optim_loss: 47944353.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9505; val_auprc_score: 0.9288; val_best_acc_score: 0.9038; val_best_f1_score: 0.9087; train_kl_reg_loss: 89807.8738; train_edge_recon_loss: 2710794.0492; train_gene_expr_recon_loss: 9926149.0909; train_masked_gp_l1_reg_loss: 46961.7319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58787.4954; train_chrom_access_recon_loss: 34538302.4848; train_global_loss: 47370802.7273; train_optim_loss: 47370802.7273; val_kl_reg_loss: 86102.3916; val_edge_recon_loss: 2726734.8438; val_gene_expr_recon_loss: 10091980.5000; val_masked_gp_l1_reg_loss: 46969.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58697.7383; val_chrom_access_recon_loss: 35694803.0000; val_global_loss: 48705288.0000; val_optim_loss: 48705288.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9512; val_auprc_score: 0.9323; val_best_acc_score: 0.8984; val_best_f1_score: 0.9048; train_kl_reg_loss: 89704.9706; train_edge_recon_loss: 2695940.1970; train_gene_expr_recon_loss: 9921010.1515; train_masked_gp_l1_reg_loss: 46983.6822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58670.3418; train_chrom_access_recon_loss: 34552969.4242; train_global_loss: 47365278.7879; train_optim_loss: 47365278.7879; val_kl_reg_loss: 86093.1729; val_edge_recon_loss: 2759225.6250; val_gene_expr_recon_loss: 9992497.6250; val_masked_gp_l1_reg_loss: 46993.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58512.5820; val_chrom_access_recon_loss: 35325545.5000; val_global_loss: 48268867.5000; val_optim_loss: 48268867.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9558; val_auprc_score: 0.9372; val_best_acc_score: 0.9076; val_best_f1_score: 0.9126; train_kl_reg_loss: 89719.0859; train_edge_recon_loss: 2696476.5871; train_gene_expr_recon_loss: 9923688.1364; train_masked_gp_l1_reg_loss: 46970.8962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56722.7361; train_chrom_access_recon_loss: 34511882.9697; train_global_loss: 47325460.6667; train_optim_loss: 47325460.6667; val_kl_reg_loss: 85622.9609; val_edge_recon_loss: 2726762.1875; val_gene_expr_recon_loss: 9895586.0000; val_masked_gp_l1_reg_loss: 46957.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56412.8203; val_chrom_access_recon_loss: 34935138.5000; val_global_loss: 47746481.0000; val_optim_loss: 47746481.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9521; val_auprc_score: 0.9331; val_best_acc_score: 0.9006; val_best_f1_score: 0.9048; train_kl_reg_loss: 89663.6064; train_edge_recon_loss: 2695914.0076; train_gene_expr_recon_loss: 9920762.6818; train_masked_gp_l1_reg_loss: 46952.3674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56398.9995; train_chrom_access_recon_loss: 34541991.5152; train_global_loss: 47351683.1515; train_optim_loss: 47351683.1515; val_kl_reg_loss: 86735.7539; val_edge_recon_loss: 2754509.8438; val_gene_expr_recon_loss: 9981925.3750; val_masked_gp_l1_reg_loss: 46948.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56393.1328; val_chrom_access_recon_loss: 35210337.5000; val_global_loss: 48136849.0000; val_optim_loss: 48136849.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9576; val_auprc_score: 0.9397; val_best_acc_score: 0.9044; val_best_f1_score: 0.9096; train_kl_reg_loss: 89879.9051; train_edge_recon_loss: 2698117.0189; train_gene_expr_recon_loss: 9923468.3182; train_masked_gp_l1_reg_loss: 46946.0949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56388.8527; train_chrom_access_recon_loss: 34542768.9091; train_global_loss: 47357568.9697; train_optim_loss: 47357568.9697; val_kl_reg_loss: 86384.9600; val_edge_recon_loss: 2735532.0938; val_gene_expr_recon_loss: 9996683.2500; val_masked_gp_l1_reg_loss: 46943.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56375.7383; val_chrom_access_recon_loss: 35188072.5000; val_global_loss: 48109991.5000; val_optim_loss: 48109991.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9570; val_auprc_score: 0.9395; val_best_acc_score: 0.9073; val_best_f1_score: 0.9119; train_kl_reg_loss: 89736.3192; train_edge_recon_loss: 2696298.7500; train_gene_expr_recon_loss: 9920132.1818; train_masked_gp_l1_reg_loss: 46942.7350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56366.7548; train_chrom_access_recon_loss: 34498270.6364; train_global_loss: 47307747.3333; train_optim_loss: 47307747.3333; val_kl_reg_loss: 85904.8115; val_edge_recon_loss: 2712951.0000; val_gene_expr_recon_loss: 9975204.2500; val_masked_gp_l1_reg_loss: 46941.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56358.7266; val_chrom_access_recon_loss: 35146399.0000; val_global_loss: 48023759.5000; val_optim_loss: 48023759.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 62 min 36 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9533
val AUPRC score: 0.9321
val best accuracy score: 0.9089
val best F1 score: 0.9132
val target rna MSE score: 1.5236
val source rna MSE score: 0.6105
val target atac MSE score: 0.1240
val source atac MSE score: 0.0276
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
