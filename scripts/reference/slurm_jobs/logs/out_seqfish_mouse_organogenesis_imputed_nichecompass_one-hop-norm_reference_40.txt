[True]
Run timestamp: 07082023_225912_40.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_40']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8861; val_auprc_score: 0.9769; val_best_acc_score: 0.8608; val_best_f1_score: 0.9246; train_kl_reg_loss: 119868.2633; train_edge_recon_loss: 11770.2350; train_gene_expr_recon_loss: 3503738.6538; train_masked_gp_l1_reg_loss: 17075.6229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177074.1672; train_global_loss: 3829526.9495; train_optim_loss: 3829526.9495; val_kl_reg_loss: 113154.5872; val_edge_recon_loss: 11947.6928; val_gene_expr_recon_loss: 2544815.1250; val_masked_gp_l1_reg_loss: 13584.7373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169703.9062; val_global_loss: 2853206.1667; val_optim_loss: 2853206.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8824; val_auprc_score: 0.9751; val_best_acc_score: 0.8927; val_best_f1_score: 0.9397; train_kl_reg_loss: 97728.6048; train_edge_recon_loss: 11827.9547; train_gene_expr_recon_loss: 2477346.6923; train_masked_gp_l1_reg_loss: 12365.7633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159182.0938; train_global_loss: 2758451.1226; train_optim_loss: 2758451.1226; val_kl_reg_loss: 82484.5384; val_edge_recon_loss: 11776.6396; val_gene_expr_recon_loss: 2417959.8542; val_masked_gp_l1_reg_loss: 11768.3691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147850.7188; val_global_loss: 2671840.0625; val_optim_loss: 2671840.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9014; val_auprc_score: 0.9782; val_best_acc_score: 0.8898; val_best_f1_score: 0.9364; train_kl_reg_loss: 73848.9609; train_edge_recon_loss: 11836.7081; train_gene_expr_recon_loss: 2325420.3317; train_masked_gp_l1_reg_loss: 11789.0359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136501.8041; train_global_loss: 2559396.8486; train_optim_loss: 2559396.8486; val_kl_reg_loss: 66934.4004; val_edge_recon_loss: 11958.0821; val_gene_expr_recon_loss: 2243991.9583; val_masked_gp_l1_reg_loss: 11876.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125155.5859; val_global_loss: 2459916.4375; val_optim_loss: 2459916.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9111; val_auprc_score: 0.9809; val_best_acc_score: 0.9001; val_best_f1_score: 0.9444; train_kl_reg_loss: 62440.4841; train_edge_recon_loss: 11741.5183; train_gene_expr_recon_loss: 2216210.0865; train_masked_gp_l1_reg_loss: 12004.9031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114739.9564; train_global_loss: 2417136.9399; train_optim_loss: 2417136.9399; val_kl_reg_loss: 57177.4564; val_edge_recon_loss: 11497.1484; val_gene_expr_recon_loss: 2184809.5833; val_masked_gp_l1_reg_loss: 12174.2012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104612.6250; val_global_loss: 2370271.0833; val_optim_loss: 2370271.0833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9236; val_auprc_score: 0.9835; val_best_acc_score: 0.9131; val_best_f1_score: 0.9508; train_kl_reg_loss: 54933.5587; train_edge_recon_loss: 11715.8995; train_gene_expr_recon_loss: 2163677.7933; train_masked_gp_l1_reg_loss: 12360.9674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95695.0270; train_global_loss: 2338383.2524; train_optim_loss: 2338383.2524; val_kl_reg_loss: 51678.8184; val_edge_recon_loss: 11758.5491; val_gene_expr_recon_loss: 2138694.9167; val_masked_gp_l1_reg_loss: 12556.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87131.4453; val_global_loss: 2301820.5000; val_optim_loss: 2301820.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9301; val_auprc_score: 0.9851; val_best_acc_score: 0.9218; val_best_f1_score: 0.9553; train_kl_reg_loss: 49653.5108; train_edge_recon_loss: 11595.4795; train_gene_expr_recon_loss: 2121355.7740; train_masked_gp_l1_reg_loss: 12759.1322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79765.5663; train_global_loss: 2275129.4712; train_optim_loss: 2275129.4712; val_kl_reg_loss: 46830.6055; val_edge_recon_loss: 11617.6500; val_gene_expr_recon_loss: 2100204.8854; val_masked_gp_l1_reg_loss: 12969.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72768.2969; val_global_loss: 2244390.6458; val_optim_loss: 2244390.6458
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9364; val_auprc_score: 0.9860; val_best_acc_score: 0.9256; val_best_f1_score: 0.9571; train_kl_reg_loss: 45630.4739; train_edge_recon_loss: 11558.7571; train_gene_expr_recon_loss: 2085401.3570; train_masked_gp_l1_reg_loss: 13156.3386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66838.0985; train_global_loss: 2222585.0096; train_optim_loss: 2222585.0096; val_kl_reg_loss: 43367.3161; val_edge_recon_loss: 11661.6314; val_gene_expr_recon_loss: 2068323.7292; val_masked_gp_l1_reg_loss: 13351.1436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61251.5586; val_global_loss: 2197955.4167; val_optim_loss: 2197955.4167
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9398; val_auprc_score: 0.9875; val_best_acc_score: 0.9283; val_best_f1_score: 0.9586; train_kl_reg_loss: 42474.8192; train_edge_recon_loss: 11566.9583; train_gene_expr_recon_loss: 2053756.4471; train_masked_gp_l1_reg_loss: 13515.4510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56598.9261; train_global_loss: 2177912.6298; train_optim_loss: 2177912.6298; val_kl_reg_loss: 40514.0378; val_edge_recon_loss: 11296.8374; val_gene_expr_recon_loss: 2036365.5521; val_masked_gp_l1_reg_loss: 13679.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52233.4414; val_global_loss: 2154089.1042; val_optim_loss: 2154089.1042
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9456; val_auprc_score: 0.9880; val_best_acc_score: 0.9302; val_best_f1_score: 0.9593; train_kl_reg_loss: 39938.8170; train_edge_recon_loss: 11504.9536; train_gene_expr_recon_loss: 2024891.6322; train_masked_gp_l1_reg_loss: 13837.3885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48567.5747; train_global_loss: 2138740.3558; train_optim_loss: 2138740.3558; val_kl_reg_loss: 38129.8848; val_edge_recon_loss: 11481.6785; val_gene_expr_recon_loss: 2009927.7083; val_masked_gp_l1_reg_loss: 13994.1387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45123.2461; val_global_loss: 2118656.5833; val_optim_loss: 2118656.5833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9490; val_auprc_score: 0.9887; val_best_acc_score: 0.9299; val_best_f1_score: 0.9595; train_kl_reg_loss: 37827.7605; train_edge_recon_loss: 11469.8291; train_gene_expr_recon_loss: 1998796.5793; train_masked_gp_l1_reg_loss: 14125.5807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42252.8853; train_global_loss: 2104472.6394; train_optim_loss: 2104472.6394; val_kl_reg_loss: 36576.5941; val_edge_recon_loss: 11604.4642; val_gene_expr_recon_loss: 1984708.7604; val_masked_gp_l1_reg_loss: 14265.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39543.7852; val_global_loss: 2086699.1979; val_optim_loss: 2086699.1979
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9530; val_auprc_score: 0.9897; val_best_acc_score: 0.9341; val_best_f1_score: 0.9623; train_kl_reg_loss: 36024.8912; train_edge_recon_loss: 11460.7519; train_gene_expr_recon_loss: 1973836.4231; train_masked_gp_l1_reg_loss: 14385.4706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37227.3229; train_global_loss: 2072934.8558; train_optim_loss: 2072934.8558; val_kl_reg_loss: 34918.0742; val_edge_recon_loss: 11389.8861; val_gene_expr_recon_loss: 1959793.9167; val_masked_gp_l1_reg_loss: 14504.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35012.3984; val_global_loss: 2055619.1250; val_optim_loss: 2055619.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9541; val_auprc_score: 0.9902; val_best_acc_score: 0.9356; val_best_f1_score: 0.9630; train_kl_reg_loss: 34398.6046; train_edge_recon_loss: 11376.9201; train_gene_expr_recon_loss: 1950624.9856; train_masked_gp_l1_reg_loss: 14614.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33124.6888; train_global_loss: 2044139.4507; train_optim_loss: 2044139.4507; val_kl_reg_loss: 33284.8219; val_edge_recon_loss: 11541.3477; val_gene_expr_recon_loss: 1937403.0833; val_masked_gp_l1_reg_loss: 14718.9902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31314.2617; val_global_loss: 2028262.5000; val_optim_loss: 2028262.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9553; val_auprc_score: 0.9908; val_best_acc_score: 0.9377; val_best_f1_score: 0.9641; train_kl_reg_loss: 32893.5304; train_edge_recon_loss: 11320.5789; train_gene_expr_recon_loss: 1929343.3906; train_masked_gp_l1_reg_loss: 14812.0674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29751.8113; train_global_loss: 2018121.3858; train_optim_loss: 2018121.3858; val_kl_reg_loss: 32276.7064; val_edge_recon_loss: 11325.4069; val_gene_expr_recon_loss: 1915603.5833; val_masked_gp_l1_reg_loss: 14905.3799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28262.5039; val_global_loss: 2002373.5625; val_optim_loss: 2002373.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9591; val_auprc_score: 0.9911; val_best_acc_score: 0.9403; val_best_f1_score: 0.9655; train_kl_reg_loss: 31508.0282; train_edge_recon_loss: 11311.0844; train_gene_expr_recon_loss: 1909679.3606; train_masked_gp_l1_reg_loss: 14981.1891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26966.1496; train_global_loss: 1994445.8077; train_optim_loss: 1994445.8077; val_kl_reg_loss: 29899.1995; val_edge_recon_loss: 11287.3738; val_gene_expr_recon_loss: 1898329.1875; val_masked_gp_l1_reg_loss: 15054.9170; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25734.0586; val_global_loss: 1980304.6458; val_optim_loss: 1980304.6458
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9583; val_auprc_score: 0.9908; val_best_acc_score: 0.9401; val_best_f1_score: 0.9651; train_kl_reg_loss: 30178.4404; train_edge_recon_loss: 11280.7850; train_gene_expr_recon_loss: 1891155.0913; train_masked_gp_l1_reg_loss: 15121.6841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24656.9403; train_global_loss: 1972392.9339; train_optim_loss: 1972392.9339; val_kl_reg_loss: 29082.5339; val_edge_recon_loss: 11481.5841; val_gene_expr_recon_loss: 1880580.8646; val_masked_gp_l1_reg_loss: 15183.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23640.1680; val_global_loss: 1959968.4792; val_optim_loss: 1959968.4792
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9601; val_auprc_score: 0.9911; val_best_acc_score: 0.9398; val_best_f1_score: 0.9648; train_kl_reg_loss: 28978.8896; train_edge_recon_loss: 11251.5641; train_gene_expr_recon_loss: 1873168.3197; train_masked_gp_l1_reg_loss: 15231.8525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22727.1050; train_global_loss: 1951357.7272; train_optim_loss: 1951357.7272; val_kl_reg_loss: 27977.7433; val_edge_recon_loss: 11615.7858; val_gene_expr_recon_loss: 1862984.8750; val_masked_gp_l1_reg_loss: 15278.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21850.1680; val_global_loss: 1939706.8958; val_optim_loss: 1939706.8958
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9613; val_auprc_score: 0.9919; val_best_acc_score: 0.9409; val_best_f1_score: 0.9660; train_kl_reg_loss: 27808.9926; train_edge_recon_loss: 11196.5444; train_gene_expr_recon_loss: 1856874.7476; train_masked_gp_l1_reg_loss: 15313.6344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21102.2131; train_global_loss: 1932296.1322; train_optim_loss: 1932296.1322; val_kl_reg_loss: 26492.5091; val_edge_recon_loss: 11413.6160; val_gene_expr_recon_loss: 1846935.5312; val_masked_gp_l1_reg_loss: 15347.0166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20378.4707; val_global_loss: 1920567.1667; val_optim_loss: 1920567.1667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9595; val_auprc_score: 0.9907; val_best_acc_score: 0.9421; val_best_f1_score: 0.9666; train_kl_reg_loss: 26725.6931; train_edge_recon_loss: 11187.7305; train_gene_expr_recon_loss: 1841169.5745; train_masked_gp_l1_reg_loss: 15367.5300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19725.3369; train_global_loss: 1914175.8618; train_optim_loss: 1914175.8618; val_kl_reg_loss: 25547.8724; val_edge_recon_loss: 11402.4801; val_gene_expr_recon_loss: 1831267.4062; val_masked_gp_l1_reg_loss: 15382.2607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19112.4883; val_global_loss: 1902712.5000; val_optim_loss: 1902712.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9621; val_auprc_score: 0.9913; val_best_acc_score: 0.9439; val_best_f1_score: 0.9676; train_kl_reg_loss: 25691.5132; train_edge_recon_loss: 11083.3301; train_gene_expr_recon_loss: 1825443.9243; train_masked_gp_l1_reg_loss: 15393.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18558.9609; train_global_loss: 1896170.8738; train_optim_loss: 1896170.8738; val_kl_reg_loss: 24320.8037; val_edge_recon_loss: 11207.9740; val_gene_expr_recon_loss: 1817129.0000; val_masked_gp_l1_reg_loss: 15392.8467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18046.7812; val_global_loss: 1886097.4062; val_optim_loss: 1886097.4062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9636; val_auprc_score: 0.9920; val_best_acc_score: 0.9464; val_best_f1_score: 0.9690; train_kl_reg_loss: 24675.7247; train_edge_recon_loss: 11077.9597; train_gene_expr_recon_loss: 1810632.6514; train_masked_gp_l1_reg_loss: 15391.7545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17558.6113; train_global_loss: 1879336.7115; train_optim_loss: 1879336.7115; val_kl_reg_loss: 23753.4583; val_edge_recon_loss: 11168.4516; val_gene_expr_recon_loss: 1801623.8125; val_masked_gp_l1_reg_loss: 15374.6699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17088.6250; val_global_loss: 1869008.9583; val_optim_loss: 1869008.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9643; val_auprc_score: 0.9923; val_best_acc_score: 0.9442; val_best_f1_score: 0.9676; train_kl_reg_loss: 23685.4031; train_edge_recon_loss: 11060.8630; train_gene_expr_recon_loss: 1796958.0673; train_masked_gp_l1_reg_loss: 15360.3922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16688.5771; train_global_loss: 1863753.3065; train_optim_loss: 1863753.3065; val_kl_reg_loss: 23049.9040; val_edge_recon_loss: 11243.8518; val_gene_expr_recon_loss: 1789879.3646; val_masked_gp_l1_reg_loss: 15335.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16286.3340; val_global_loss: 1855795.1146; val_optim_loss: 1855795.1146
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9642; val_auprc_score: 0.9921; val_best_acc_score: 0.9469; val_best_f1_score: 0.9694; train_kl_reg_loss: 22720.0684; train_edge_recon_loss: 11004.7015; train_gene_expr_recon_loss: 1784230.3450; train_masked_gp_l1_reg_loss: 15299.0579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15943.5606; train_global_loss: 1849197.7284; train_optim_loss: 1849197.7284; val_kl_reg_loss: 21337.9281; val_edge_recon_loss: 11017.0272; val_gene_expr_recon_loss: 1777680.7917; val_masked_gp_l1_reg_loss: 15262.6475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15621.3730; val_global_loss: 1840919.7292; val_optim_loss: 1840919.7292
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9637; val_auprc_score: 0.9922; val_best_acc_score: 0.9459; val_best_f1_score: 0.9688; train_kl_reg_loss: 21776.1993; train_edge_recon_loss: 10920.2931; train_gene_expr_recon_loss: 1771042.1262; train_masked_gp_l1_reg_loss: 15203.2170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15285.8742; train_global_loss: 1834227.6971; train_optim_loss: 1834227.6971; val_kl_reg_loss: 21392.2311; val_edge_recon_loss: 11013.8396; val_gene_expr_recon_loss: 1762174.8125; val_masked_gp_l1_reg_loss: 15143.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14987.2852; val_global_loss: 1824711.5000; val_optim_loss: 1824711.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9663; val_auprc_score: 0.9926; val_best_acc_score: 0.9480; val_best_f1_score: 0.9700; train_kl_reg_loss: 20831.7152; train_edge_recon_loss: 10918.8447; train_gene_expr_recon_loss: 1758905.7656; train_masked_gp_l1_reg_loss: 15071.6464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14704.1516; train_global_loss: 1820432.1226; train_optim_loss: 1820432.1226; val_kl_reg_loss: 20317.8618; val_edge_recon_loss: 10905.8175; val_gene_expr_recon_loss: 1750126.4792; val_masked_gp_l1_reg_loss: 14997.1631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14434.1055; val_global_loss: 1810781.4062; val_optim_loss: 1810781.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9668; val_auprc_score: 0.9923; val_best_acc_score: 0.9491; val_best_f1_score: 0.9703; train_kl_reg_loss: 19917.7584; train_edge_recon_loss: 10798.9209; train_gene_expr_recon_loss: 1746569.8041; train_masked_gp_l1_reg_loss: 14912.7105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14181.2714; train_global_loss: 1806380.4700; train_optim_loss: 1806380.4700; val_kl_reg_loss: 18987.1704; val_edge_recon_loss: 11114.2784; val_gene_expr_recon_loss: 1740510.5417; val_masked_gp_l1_reg_loss: 14818.2510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13940.2617; val_global_loss: 1799370.4896; val_optim_loss: 1799370.4896
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9473; val_auprc_score: 0.9896; val_best_acc_score: 0.9242; val_best_f1_score: 0.9569; train_kl_reg_loss: 26485.6956; train_edge_recon_loss: 11639.0618; train_gene_expr_recon_loss: 3152131.3726; train_masked_gp_l1_reg_loss: 18637.6516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11138.7794; train_global_loss: 3220032.5769; train_optim_loss: 3220032.5769; val_kl_reg_loss: 12579.0788; val_edge_recon_loss: 11478.1820; val_gene_expr_recon_loss: 2254780.0417; val_masked_gp_l1_reg_loss: 18474.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8909.5088; val_global_loss: 2306221.0833; val_optim_loss: 2306221.0833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9405; val_auprc_score: 0.9873; val_best_acc_score: 0.9225; val_best_f1_score: 0.9559; train_kl_reg_loss: 11654.7950; train_edge_recon_loss: 11563.8022; train_gene_expr_recon_loss: 2096419.9519; train_masked_gp_l1_reg_loss: 17659.1004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7756.9074; train_global_loss: 2145054.5709; train_optim_loss: 2145054.5709; val_kl_reg_loss: 9954.6006; val_edge_recon_loss: 11490.0414; val_gene_expr_recon_loss: 1992633.8229; val_masked_gp_l1_reg_loss: 16915.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6846.0864; val_global_loss: 2037840.4583; val_optim_loss: 2037840.4583
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9395; val_auprc_score: 0.9873; val_best_acc_score: 0.9256; val_best_f1_score: 0.9571; train_kl_reg_loss: 9640.8942; train_edge_recon_loss: 11404.2679; train_gene_expr_recon_loss: 1949750.5252; train_masked_gp_l1_reg_loss: 16300.6152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6250.5306; train_global_loss: 1993346.8353; train_optim_loss: 1993346.8353; val_kl_reg_loss: 8485.9889; val_edge_recon_loss: 11352.4950; val_gene_expr_recon_loss: 1914574.5312; val_masked_gp_l1_reg_loss: 15719.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5733.4189; val_global_loss: 1955865.8958; val_optim_loss: 1955865.8958
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9394; val_auprc_score: 0.9865; val_best_acc_score: 0.9267; val_best_f1_score: 0.9580; train_kl_reg_loss: 8469.6008; train_edge_recon_loss: 11278.9457; train_gene_expr_recon_loss: 1898486.0877; train_masked_gp_l1_reg_loss: 15213.0434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5344.0785; train_global_loss: 1938791.7644; train_optim_loss: 1938791.7644; val_kl_reg_loss: 7705.4206; val_edge_recon_loss: 11291.5554; val_gene_expr_recon_loss: 1879182.1146; val_masked_gp_l1_reg_loss: 14724.2324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4986.9717; val_global_loss: 1917890.3229; val_optim_loss: 1917890.3229

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9383; val_auprc_score: 0.9864; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 7997.9533; train_edge_recon_loss: 11176.5493; train_gene_expr_recon_loss: 1881960.4459; train_masked_gp_l1_reg_loss: 14574.2223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4838.7476; train_global_loss: 1920547.9159; train_optim_loss: 1920547.9159; val_kl_reg_loss: 7560.8527; val_edge_recon_loss: 11333.6423; val_gene_expr_recon_loss: 1877223.8021; val_masked_gp_l1_reg_loss: 14514.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4794.0977; val_global_loss: 1915426.8125; val_optim_loss: 1915426.8125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9396; val_auprc_score: 0.9868; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 7889.4827; train_edge_recon_loss: 11106.3803; train_gene_expr_recon_loss: 1879152.1719; train_masked_gp_l1_reg_loss: 14466.2725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4761.8162; train_global_loss: 1917376.1310; train_optim_loss: 1917376.1310; val_kl_reg_loss: 7491.5961; val_edge_recon_loss: 11329.6205; val_gene_expr_recon_loss: 1874641.0729; val_masked_gp_l1_reg_loss: 14416.7725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4728.1855; val_global_loss: 1912607.1771; val_optim_loss: 1912607.1771
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9399; val_auprc_score: 0.9872; val_best_acc_score: 0.9269; val_best_f1_score: 0.9579; train_kl_reg_loss: 7806.0544; train_edge_recon_loss: 11146.1168; train_gene_expr_recon_loss: 1876672.7680; train_masked_gp_l1_reg_loss: 14367.6227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4695.5942; train_global_loss: 1914688.1526; train_optim_loss: 1914688.1526; val_kl_reg_loss: 7367.8904; val_edge_recon_loss: 11246.6699; val_gene_expr_recon_loss: 1870586.1562; val_masked_gp_l1_reg_loss: 14317.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4662.0732; val_global_loss: 1908180.2188; val_optim_loss: 1908180.2188
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9366; val_auprc_score: 0.9860; val_best_acc_score: 0.9275; val_best_f1_score: 0.9582; train_kl_reg_loss: 7717.8864; train_edge_recon_loss: 11122.6031; train_gene_expr_recon_loss: 1874426.4808; train_masked_gp_l1_reg_loss: 14266.6135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4628.3560; train_global_loss: 1912161.9423; train_optim_loss: 1912161.9423; val_kl_reg_loss: 7302.6921; val_edge_recon_loss: 11287.9277; val_gene_expr_recon_loss: 1868508.9167; val_masked_gp_l1_reg_loss: 14214.4229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4593.9424; val_global_loss: 1905907.8958; val_optim_loss: 1905907.8958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 93 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9663
val AUPRC score: 0.9927
val best accuracy score: 0.9454
val best F1 score: 0.9685
val target rna MSE score: 20.7564
val source rna MSE score: 201.6408
Val cat covariate0 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
