[True]
Run timestamp: 10082023_225334_85.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_85']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7691; val_auprc_score: 0.7945; val_best_acc_score: 0.5551; val_best_f1_score: 0.6849; train_kl_reg_loss: 320242.7896; train_edge_recon_loss: 3957286.6088; train_gene_expr_recon_loss: 49479470.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 77102001.8931; train_global_loss: 130859001.6489; train_optim_loss: 130859001.6489; val_kl_reg_loss: 132437.0036; val_edge_recon_loss: 4061770.1667; val_gene_expr_recon_loss: 40085793.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 70805536.0000; val_global_loss: 115085536.5333; val_optim_loss: 115085536.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7949; val_auprc_score: 0.8133; val_best_acc_score: 0.7040; val_best_f1_score: 0.7299; train_kl_reg_loss: 172574.6246; train_edge_recon_loss: 3924374.4046; train_gene_expr_recon_loss: 39596239.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69900298.6565; train_global_loss: 113593487.2672; train_optim_loss: 113593487.2672; val_kl_reg_loss: 147619.1958; val_edge_recon_loss: 4047291.3333; val_gene_expr_recon_loss: 38493897.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69834802.9333; val_global_loss: 112523611.7333; val_optim_loss: 112523611.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7875; val_auprc_score: 0.8054; val_best_acc_score: 0.6927; val_best_f1_score: 0.7288; train_kl_reg_loss: 166819.0024; train_edge_recon_loss: 3778968.5840; train_gene_expr_recon_loss: 37909785.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68978008.2443; train_global_loss: 110833581.8626; train_optim_loss: 110833581.8626; val_kl_reg_loss: 183211.9344; val_edge_recon_loss: 3898973.0500; val_gene_expr_recon_loss: 37354548.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68948207.4667; val_global_loss: 110384941.3333; val_optim_loss: 110384941.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8407; val_auprc_score: 0.8426; val_best_acc_score: 0.7451; val_best_f1_score: 0.7679; train_kl_reg_loss: 192242.4290; train_edge_recon_loss: 3494963.4599; train_gene_expr_recon_loss: 36997746.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68379134.0763; train_global_loss: 109064086.4733; train_optim_loss: 109064086.4733; val_kl_reg_loss: 187291.2687; val_edge_recon_loss: 3437277.7000; val_gene_expr_recon_loss: 36892610.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68514601.3333; val_global_loss: 109031780.2667; val_optim_loss: 109031780.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8675; val_auprc_score: 0.8654; val_best_acc_score: 0.7741; val_best_f1_score: 0.7889; train_kl_reg_loss: 211741.3327; train_edge_recon_loss: 3222756.3492; train_gene_expr_recon_loss: 36654731.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67983126.9008; train_global_loss: 108072356.3969; train_optim_loss: 108072356.3969; val_kl_reg_loss: 224584.2437; val_edge_recon_loss: 3142748.4500; val_gene_expr_recon_loss: 36505609.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68073440.0000; val_global_loss: 107946381.3333; val_optim_loss: 107946381.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8828; val_auprc_score: 0.8718; val_best_acc_score: 0.7963; val_best_f1_score: 0.8101; train_kl_reg_loss: 225640.4153; train_edge_recon_loss: 3074051.5821; train_gene_expr_recon_loss: 36420705.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67695245.3130; train_global_loss: 107415642.2595; train_optim_loss: 107415642.2595; val_kl_reg_loss: 226115.8885; val_edge_recon_loss: 3069255.3167; val_gene_expr_recon_loss: 36490722.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68189857.8667; val_global_loss: 107975953.0667; val_optim_loss: 107975953.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8970; val_auprc_score: 0.8858; val_best_acc_score: 0.8122; val_best_f1_score: 0.8276; train_kl_reg_loss: 215656.5841; train_edge_recon_loss: 3037445.9237; train_gene_expr_recon_loss: 36166055.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67280425.9847; train_global_loss: 106699583.8779; train_optim_loss: 106699583.8779; val_kl_reg_loss: 207015.9979; val_edge_recon_loss: 3033802.3000; val_gene_expr_recon_loss: 36090040.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67351987.7333; val_global_loss: 106682848.0000; val_optim_loss: 106682848.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9087; val_auprc_score: 0.8942; val_best_acc_score: 0.8340; val_best_f1_score: 0.8459; train_kl_reg_loss: 203088.2158; train_edge_recon_loss: 2977715.0057; train_gene_expr_recon_loss: 35950010.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66899506.8397; train_global_loss: 106030320.4885; train_optim_loss: 106030320.4885; val_kl_reg_loss: 203064.5906; val_edge_recon_loss: 2970343.9833; val_gene_expr_recon_loss: 35905369.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66925455.2000; val_global_loss: 106004233.0667; val_optim_loss: 106004233.0667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9187; val_auprc_score: 0.9058; val_best_acc_score: 0.8459; val_best_f1_score: 0.8565; train_kl_reg_loss: 198333.4660; train_edge_recon_loss: 2945783.8454; train_gene_expr_recon_loss: 35801054.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66712858.9008; train_global_loss: 105658030.4122; train_optim_loss: 105658030.4122; val_kl_reg_loss: 197156.2229; val_edge_recon_loss: 2936834.8500; val_gene_expr_recon_loss: 35797843.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66908532.5333; val_global_loss: 105840365.8667; val_optim_loss: 105840365.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9298; val_auprc_score: 0.9174; val_best_acc_score: 0.8604; val_best_f1_score: 0.8697; train_kl_reg_loss: 193091.0920; train_edge_recon_loss: 2913089.8817; train_gene_expr_recon_loss: 35640312.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66382944.3053; train_global_loss: 105129437.6794; train_optim_loss: 105129437.6794; val_kl_reg_loss: 189709.6792; val_edge_recon_loss: 2903782.4000; val_gene_expr_recon_loss: 35592089.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66555250.9333; val_global_loss: 105240832.0000; val_optim_loss: 105240832.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9337; val_auprc_score: 0.9215; val_best_acc_score: 0.8651; val_best_f1_score: 0.8732; train_kl_reg_loss: 188976.6076; train_edge_recon_loss: 2884337.8168; train_gene_expr_recon_loss: 35489712.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66096683.1450; train_global_loss: 104659709.4351; train_optim_loss: 104659709.4351; val_kl_reg_loss: 188691.4708; val_edge_recon_loss: 2877332.3500; val_gene_expr_recon_loss: 35508567.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66211662.4000; val_global_loss: 104786252.2667; val_optim_loss: 104786252.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9415; val_auprc_score: 0.9316; val_best_acc_score: 0.8712; val_best_f1_score: 0.8785; train_kl_reg_loss: 183955.2227; train_edge_recon_loss: 2872632.3817; train_gene_expr_recon_loss: 35377765.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65931888.7328; train_global_loss: 104366241.9542; train_optim_loss: 104366241.9542; val_kl_reg_loss: 180789.0500; val_edge_recon_loss: 2848546.5333; val_gene_expr_recon_loss: 35482702.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66300287.7333; val_global_loss: 104812325.3333; val_optim_loss: 104812325.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9446; val_auprc_score: 0.9313; val_best_acc_score: 0.8818; val_best_f1_score: 0.8879; train_kl_reg_loss: 179780.7729; train_edge_recon_loss: 2855047.5229; train_gene_expr_recon_loss: 35227154.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65581294.1069; train_global_loss: 103843277.0076; train_optim_loss: 103843277.0076; val_kl_reg_loss: 176288.9979; val_edge_recon_loss: 2853935.9667; val_gene_expr_recon_loss: 35327705.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65789383.7333; val_global_loss: 104147314.1333; val_optim_loss: 104147314.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9446; val_auprc_score: 0.9354; val_best_acc_score: 0.8767; val_best_f1_score: 0.8844; train_kl_reg_loss: 173483.4113; train_edge_recon_loss: 2844132.2214; train_gene_expr_recon_loss: 35115225.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65405680.3053; train_global_loss: 103538521.8931; train_optim_loss: 103538521.8931; val_kl_reg_loss: 170752.3052; val_edge_recon_loss: 2846067.6000; val_gene_expr_recon_loss: 35218558.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65704429.6000; val_global_loss: 103939806.9333; val_optim_loss: 103939806.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9444; val_auprc_score: 0.9346; val_best_acc_score: 0.8752; val_best_f1_score: 0.8823; train_kl_reg_loss: 168814.2567; train_edge_recon_loss: 2835587.7137; train_gene_expr_recon_loss: 35006601.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65144304.7328; train_global_loss: 103155307.9695; train_optim_loss: 103155307.9695; val_kl_reg_loss: 166592.7031; val_edge_recon_loss: 2854190.7333; val_gene_expr_recon_loss: 35252700.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65752732.8000; val_global_loss: 104026216.0000; val_optim_loss: 104026216.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9496; val_auprc_score: 0.9395; val_best_acc_score: 0.8810; val_best_f1_score: 0.8870; train_kl_reg_loss: 165601.1269; train_edge_recon_loss: 2818197.7462; train_gene_expr_recon_loss: 34956510.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65084447.6336; train_global_loss: 103024756.8855; train_optim_loss: 103024756.8855; val_kl_reg_loss: 162915.1844; val_edge_recon_loss: 2830417.4333; val_gene_expr_recon_loss: 35171516.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65860772.0000; val_global_loss: 104025621.8667; val_optim_loss: 104025621.8667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9482; val_auprc_score: 0.9384; val_best_acc_score: 0.8826; val_best_f1_score: 0.8879; train_kl_reg_loss: 160881.0299; train_edge_recon_loss: 2815037.5687; train_gene_expr_recon_loss: 34874799.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64954009.2519; train_global_loss: 102804727.8779; train_optim_loss: 102804727.8779; val_kl_reg_loss: 158329.8229; val_edge_recon_loss: 2829397.2167; val_gene_expr_recon_loss: 34886410.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64758396.2667; val_global_loss: 102632533.8667; val_optim_loss: 102632533.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9483; val_auprc_score: 0.9386; val_best_acc_score: 0.8816; val_best_f1_score: 0.8882; train_kl_reg_loss: 158021.9114; train_edge_recon_loss: 2803601.9332; train_gene_expr_recon_loss: 34815567.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64829041.0382; train_global_loss: 102606232.3664; train_optim_loss: 102606232.3664; val_kl_reg_loss: 157730.0281; val_edge_recon_loss: 2833700.7000; val_gene_expr_recon_loss: 34849276.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65217645.3333; val_global_loss: 103058353.6000; val_optim_loss: 103058353.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9542; val_auprc_score: 0.9462; val_best_acc_score: 0.8888; val_best_f1_score: 0.8917; train_kl_reg_loss: 154405.1650; train_edge_recon_loss: 2793893.6240; train_gene_expr_recon_loss: 34738357.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64693614.7176; train_global_loss: 102380271.2061; train_optim_loss: 102380271.2061; val_kl_reg_loss: 152548.6271; val_edge_recon_loss: 2808596.1833; val_gene_expr_recon_loss: 34900278.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65234409.6000; val_global_loss: 103095833.6000; val_optim_loss: 103095833.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9541; val_auprc_score: 0.9468; val_best_acc_score: 0.8876; val_best_f1_score: 0.8921; train_kl_reg_loss: 149675.5713; train_edge_recon_loss: 2798004.2176; train_gene_expr_recon_loss: 34721221.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64688635.1145; train_global_loss: 102357536.4275; train_optim_loss: 102357536.4275; val_kl_reg_loss: 149980.3500; val_edge_recon_loss: 2806312.9833; val_gene_expr_recon_loss: 34725912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64851375.4667; val_global_loss: 102533581.3333; val_optim_loss: 102533581.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9543; val_auprc_score: 0.9438; val_best_acc_score: 0.8897; val_best_f1_score: 0.8951; train_kl_reg_loss: 147942.3754; train_edge_recon_loss: 2782069.8111; train_gene_expr_recon_loss: 34600683.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64403502.3511; train_global_loss: 101934198.5954; train_optim_loss: 101934198.5954; val_kl_reg_loss: 149758.2146; val_edge_recon_loss: 2797114.9000; val_gene_expr_recon_loss: 34780182.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64997756.8000; val_global_loss: 102724811.7333; val_optim_loss: 102724811.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9633; val_auprc_score: 0.9559; val_best_acc_score: 0.9006; val_best_f1_score: 0.9049; train_kl_reg_loss: 145167.6537; train_edge_recon_loss: 2779514.7405; train_gene_expr_recon_loss: 34551475.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64270303.9084; train_global_loss: 101746461.0687; train_optim_loss: 101746461.0687; val_kl_reg_loss: 145851.5208; val_edge_recon_loss: 2766869.8000; val_gene_expr_recon_loss: 34690272.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64902293.0667; val_global_loss: 102505285.8667; val_optim_loss: 102505285.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9609; val_auprc_score: 0.9538; val_best_acc_score: 0.8991; val_best_f1_score: 0.9030; train_kl_reg_loss: 141779.9968; train_edge_recon_loss: 2771687.1279; train_gene_expr_recon_loss: 34507567.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64285938.2595; train_global_loss: 101706972.8855; train_optim_loss: 101706972.8855; val_kl_reg_loss: 142608.3156; val_edge_recon_loss: 2778656.7500; val_gene_expr_recon_loss: 34583640.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64422844.5333; val_global_loss: 101927749.8667; val_optim_loss: 101927749.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9641; val_auprc_score: 0.9574; val_best_acc_score: 0.9012; val_best_f1_score: 0.9044; train_kl_reg_loss: 139499.4760; train_edge_recon_loss: 2775505.5553; train_gene_expr_recon_loss: 34431955.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64218582.5649; train_global_loss: 101565543.3893; train_optim_loss: 101565543.3893; val_kl_reg_loss: 137357.1719; val_edge_recon_loss: 2783958.9333; val_gene_expr_recon_loss: 34674306.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64676426.1333; val_global_loss: 102272047.4667; val_optim_loss: 102272047.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9639; val_auprc_score: 0.9585; val_best_acc_score: 0.9047; val_best_f1_score: 0.9083; train_kl_reg_loss: 137471.2836; train_edge_recon_loss: 2765969.6431; train_gene_expr_recon_loss: 34383640.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64148188.3664; train_global_loss: 101435270.2290; train_optim_loss: 101435270.2290; val_kl_reg_loss: 136467.5521; val_edge_recon_loss: 2781248.7833; val_gene_expr_recon_loss: 34603750.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64786340.2667; val_global_loss: 102307807.4667; val_optim_loss: 102307807.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9592; val_auprc_score: 0.9486; val_best_acc_score: 0.9019; val_best_f1_score: 0.9058; train_kl_reg_loss: 160774.9019; train_edge_recon_loss: 2870009.7519; train_gene_expr_recon_loss: 37150124.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65467674.0458; train_global_loss: 105648583.0229; train_optim_loss: 105648583.0229; val_kl_reg_loss: 56867.7555; val_edge_recon_loss: 2826778.2333; val_gene_expr_recon_loss: 36862833.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65534556.8000; val_global_loss: 105281034.6667; val_optim_loss: 105281034.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9589; val_auprc_score: 0.9499; val_best_acc_score: 0.8976; val_best_f1_score: 0.9034; train_kl_reg_loss: 147258.1571; train_edge_recon_loss: 2799774.9332; train_gene_expr_recon_loss: 36635485.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65450503.3588; train_global_loss: 105033021.7405; train_optim_loss: 105033021.7405; val_kl_reg_loss: 68757.5740; val_edge_recon_loss: 2801242.4000; val_gene_expr_recon_loss: 36496447.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65322371.4667; val_global_loss: 104688816.5333; val_optim_loss: 104688816.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9607; val_auprc_score: 0.9531; val_best_acc_score: 0.8980; val_best_f1_score: 0.9043; train_kl_reg_loss: 135714.7280; train_edge_recon_loss: 2779736.8912; train_gene_expr_recon_loss: 36458699.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65248628.4580; train_global_loss: 104622779.6031; train_optim_loss: 104622779.6031; val_kl_reg_loss: 69959.8026; val_edge_recon_loss: 2772228.1667; val_gene_expr_recon_loss: 36492726.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65300973.8667; val_global_loss: 104635889.0667; val_optim_loss: 104635889.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9572; val_auprc_score: 0.9493; val_best_acc_score: 0.8953; val_best_f1_score: 0.9002; train_kl_reg_loss: 132794.2758; train_edge_recon_loss: 2775247.6679; train_gene_expr_recon_loss: 36418268.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65272316.0305; train_global_loss: 104598626.3206; train_optim_loss: 104598626.3206; val_kl_reg_loss: 71549.6823; val_edge_recon_loss: 2785099.4000; val_gene_expr_recon_loss: 36580824.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65545564.5333; val_global_loss: 104983036.8000; val_optim_loss: 104983036.8000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9574; val_auprc_score: 0.9467; val_best_acc_score: 0.8985; val_best_f1_score: 0.9048; train_kl_reg_loss: 130752.1453; train_edge_recon_loss: 2773765.8683; train_gene_expr_recon_loss: 36425624.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65249375.8473; train_global_loss: 104579518.0458; train_optim_loss: 104579518.0458; val_kl_reg_loss: 72139.3661; val_edge_recon_loss: 2782443.6000; val_gene_expr_recon_loss: 36590402.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65570217.8667; val_global_loss: 105015203.7333; val_optim_loss: 105015203.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9534; val_auprc_score: 0.9413; val_best_acc_score: 0.8937; val_best_f1_score: 0.8996; train_kl_reg_loss: 128468.6633; train_edge_recon_loss: 2776707.3969; train_gene_expr_recon_loss: 36391592.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65255503.1145; train_global_loss: 104552271.2061; train_optim_loss: 104552271.2061; val_kl_reg_loss: 73639.6771; val_edge_recon_loss: 2780684.1833; val_gene_expr_recon_loss: 36453298.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65423482.1333; val_global_loss: 104731104.5333; val_optim_loss: 104731104.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 40 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9600
val AUPRC score: 0.9501
val best accuracy score: 0.8963
val best F1 score: 0.9002
val target rna MSE score: 1.7728
val source rna MSE score: 27.0576
val target atac MSE score: 0.1292
val source atac MSE score: 1.0158
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
