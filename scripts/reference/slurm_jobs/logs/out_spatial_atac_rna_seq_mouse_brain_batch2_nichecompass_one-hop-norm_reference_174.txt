[True]
Run timestamp: 10102023_063709_174.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_174']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7863; val_auprc_score: 0.8030; val_best_acc_score: 0.5340; val_best_f1_score: 0.6797; train_kl_reg_loss: 65412.0583; train_edge_recon_loss: 746847.3917; train_gene_expr_recon_loss: 22016473.4198; train_masked_gp_l1_reg_loss: 140102.1569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3314783.9165; train_chrom_access_recon_loss: 2240561.4561; train_global_loss: 28524180.3664; train_optim_loss: 28524180.3664; val_kl_reg_loss: 80398.8104; val_edge_recon_loss: 812612.8750; val_gene_expr_recon_loss: 21232479.8667; val_masked_gp_l1_reg_loss: 111421.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 804061.8750; val_chrom_access_recon_loss: 2208726.6667; val_global_loss: 25249702.2667; val_optim_loss: 25249702.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8812; val_auprc_score: 0.8836; val_best_acc_score: 0.8073; val_best_f1_score: 0.8088; train_kl_reg_loss: 75203.3010; train_edge_recon_loss: 735496.3263; train_gene_expr_recon_loss: 20807155.4656; train_masked_gp_l1_reg_loss: 108043.4542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 407079.7888; train_chrom_access_recon_loss: 2153777.7548; train_global_loss: 24286756.1069; train_optim_loss: 24286756.1069; val_kl_reg_loss: 68051.4870; val_edge_recon_loss: 800910.6542; val_gene_expr_recon_loss: 20975035.6000; val_masked_gp_l1_reg_loss: 107325.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224557.7656; val_chrom_access_recon_loss: 2177628.1917; val_global_loss: 24353510.0000; val_optim_loss: 24353510.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8951; val_auprc_score: 0.8870; val_best_acc_score: 0.8072; val_best_f1_score: 0.8234; train_kl_reg_loss: 67387.9502; train_edge_recon_loss: 704370.6861; train_gene_expr_recon_loss: 20546069.8015; train_masked_gp_l1_reg_loss: 108576.3229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181065.1399; train_chrom_access_recon_loss: 2130785.8435; train_global_loss: 23738255.8321; train_optim_loss: 23738255.8321; val_kl_reg_loss: 77408.6323; val_edge_recon_loss: 663905.9917; val_gene_expr_recon_loss: 20652877.0667; val_masked_gp_l1_reg_loss: 110441.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154972.5938; val_chrom_access_recon_loss: 2151222.0167; val_global_loss: 23810827.6000; val_optim_loss: 23810827.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9185; val_auprc_score: 0.9056; val_best_acc_score: 0.8370; val_best_f1_score: 0.8472; train_kl_reg_loss: 77946.2987; train_edge_recon_loss: 638510.6670; train_gene_expr_recon_loss: 20288644.1985; train_masked_gp_l1_reg_loss: 112172.5651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136688.3426; train_chrom_access_recon_loss: 2108260.6937; train_global_loss: 23362222.9466; train_optim_loss: 23362222.9466; val_kl_reg_loss: 75142.2740; val_edge_recon_loss: 629664.3625; val_gene_expr_recon_loss: 20394210.9333; val_masked_gp_l1_reg_loss: 113615.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121438.0938; val_chrom_access_recon_loss: 2134182.5417; val_global_loss: 23468254.1333; val_optim_loss: 23468254.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9227; val_auprc_score: 0.9114; val_best_acc_score: 0.8473; val_best_f1_score: 0.8563; train_kl_reg_loss: 76742.8244; train_edge_recon_loss: 622516.3364; train_gene_expr_recon_loss: 20096057.0992; train_masked_gp_l1_reg_loss: 114861.9758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112695.8037; train_chrom_access_recon_loss: 2089219.0992; train_global_loss: 23112093.1145; train_optim_loss: 23112093.1145; val_kl_reg_loss: 72718.3349; val_edge_recon_loss: 621244.8750; val_gene_expr_recon_loss: 20294217.2000; val_masked_gp_l1_reg_loss: 115846.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105989.3203; val_chrom_access_recon_loss: 2121152.7250; val_global_loss: 23331168.9333; val_optim_loss: 23331168.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9342; val_auprc_score: 0.9244; val_best_acc_score: 0.8604; val_best_f1_score: 0.8673; train_kl_reg_loss: 75560.9630; train_edge_recon_loss: 612677.7128; train_gene_expr_recon_loss: 19952371.5878; train_masked_gp_l1_reg_loss: 116537.8429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100585.9814; train_chrom_access_recon_loss: 2076340.0429; train_global_loss: 22934073.9389; train_optim_loss: 22934073.9389; val_kl_reg_loss: 72938.5276; val_edge_recon_loss: 613697.6333; val_gene_expr_recon_loss: 20146078.8000; val_masked_gp_l1_reg_loss: 117902.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97528.4141; val_chrom_access_recon_loss: 2098993.6833; val_global_loss: 23147138.2667; val_optim_loss: 23147138.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9378; val_auprc_score: 0.9276; val_best_acc_score: 0.8638; val_best_f1_score: 0.8688; train_kl_reg_loss: 73896.5137; train_edge_recon_loss: 607515.0310; train_gene_expr_recon_loss: 19826735.7710; train_masked_gp_l1_reg_loss: 117878.6370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93695.8981; train_chrom_access_recon_loss: 2060456.2662; train_global_loss: 22780178.1374; train_optim_loss: 22780178.1374; val_kl_reg_loss: 72511.7026; val_edge_recon_loss: 606573.6875; val_gene_expr_recon_loss: 20103514.0000; val_masked_gp_l1_reg_loss: 118532.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91683.6641; val_chrom_access_recon_loss: 2097983.3917; val_global_loss: 23090798.6667; val_optim_loss: 23090798.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9451; val_auprc_score: 0.9310; val_best_acc_score: 0.8810; val_best_f1_score: 0.8844; train_kl_reg_loss: 72412.9786; train_edge_recon_loss: 603694.7882; train_gene_expr_recon_loss: 19704562.1374; train_masked_gp_l1_reg_loss: 118857.4847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91025.0146; train_chrom_access_recon_loss: 2049133.2176; train_global_loss: 22639685.5725; train_optim_loss: 22639685.5725; val_kl_reg_loss: 71705.9932; val_edge_recon_loss: 603800.9833; val_gene_expr_recon_loss: 19938490.9333; val_masked_gp_l1_reg_loss: 119759.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91930.9688; val_chrom_access_recon_loss: 2085953.1417; val_global_loss: 22911640.8000; val_optim_loss: 22911640.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9472; val_auprc_score: 0.9370; val_best_acc_score: 0.8835; val_best_f1_score: 0.8881; train_kl_reg_loss: 71446.5172; train_edge_recon_loss: 602066.5992; train_gene_expr_recon_loss: 19597012.3969; train_masked_gp_l1_reg_loss: 119762.8433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91540.6103; train_chrom_access_recon_loss: 2039195.9275; train_global_loss: 22521024.8855; train_optim_loss: 22521024.8855; val_kl_reg_loss: 70626.3594; val_edge_recon_loss: 603384.7375; val_gene_expr_recon_loss: 19751582.5333; val_masked_gp_l1_reg_loss: 120415.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91086.2266; val_chrom_access_recon_loss: 2059402.3500; val_global_loss: 22696497.8667; val_optim_loss: 22696497.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9532; val_auprc_score: 0.9447; val_best_acc_score: 0.8872; val_best_f1_score: 0.8914; train_kl_reg_loss: 71221.9422; train_edge_recon_loss: 597402.5759; train_gene_expr_recon_loss: 19495340.1069; train_masked_gp_l1_reg_loss: 120466.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90037.0024; train_chrom_access_recon_loss: 2027402.4170; train_global_loss: 22401870.5344; train_optim_loss: 22401870.5344; val_kl_reg_loss: 71710.5323; val_edge_recon_loss: 599313.6333; val_gene_expr_recon_loss: 19721434.5333; val_masked_gp_l1_reg_loss: 121215.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90172.6250; val_chrom_access_recon_loss: 2057578.9833; val_global_loss: 22661425.6000; val_optim_loss: 22661425.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9539; val_auprc_score: 0.9450; val_best_acc_score: 0.8910; val_best_f1_score: 0.8966; train_kl_reg_loss: 70242.4070; train_edge_recon_loss: 594777.1231; train_gene_expr_recon_loss: 19400181.2519; train_masked_gp_l1_reg_loss: 121270.0757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88206.3866; train_chrom_access_recon_loss: 2017660.2853; train_global_loss: 22292337.4809; train_optim_loss: 22292337.4809; val_kl_reg_loss: 68263.7146; val_edge_recon_loss: 593139.6333; val_gene_expr_recon_loss: 19619291.8667; val_masked_gp_l1_reg_loss: 121805.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87009.2891; val_chrom_access_recon_loss: 2048031.1750; val_global_loss: 22537542.4000; val_optim_loss: 22537542.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9581; val_auprc_score: 0.9510; val_best_acc_score: 0.8972; val_best_f1_score: 0.9017; train_kl_reg_loss: 69652.5355; train_edge_recon_loss: 593911.8297; train_gene_expr_recon_loss: 19318260.6412; train_masked_gp_l1_reg_loss: 121956.5762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85941.3234; train_chrom_access_recon_loss: 2008135.8416; train_global_loss: 22197858.7176; train_optim_loss: 22197858.7176; val_kl_reg_loss: 68358.2573; val_edge_recon_loss: 591714.1292; val_gene_expr_recon_loss: 19569130.0000; val_masked_gp_l1_reg_loss: 122569.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85533.2812; val_chrom_access_recon_loss: 2045754.5583; val_global_loss: 22483060.9333; val_optim_loss: 22483060.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9579; val_auprc_score: 0.9491; val_best_acc_score: 0.9010; val_best_f1_score: 0.9033; train_kl_reg_loss: 68830.7380; train_edge_recon_loss: 592389.5024; train_gene_expr_recon_loss: 19241868.3511; train_masked_gp_l1_reg_loss: 122698.7195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84537.9001; train_chrom_access_recon_loss: 1999296.2615; train_global_loss: 22109621.4351; train_optim_loss: 22109621.4351; val_kl_reg_loss: 68640.5755; val_edge_recon_loss: 595329.4958; val_gene_expr_recon_loss: 19421498.4000; val_masked_gp_l1_reg_loss: 123129.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84600.2734; val_chrom_access_recon_loss: 2029814.0417; val_global_loss: 22323012.4000; val_optim_loss: 22323012.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9610; val_auprc_score: 0.9518; val_best_acc_score: 0.9016; val_best_f1_score: 0.9053; train_kl_reg_loss: 68411.3492; train_edge_recon_loss: 590958.8545; train_gene_expr_recon_loss: 19180944.6412; train_masked_gp_l1_reg_loss: 123266.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83851.2784; train_chrom_access_recon_loss: 1993741.8063; train_global_loss: 22041174.2595; train_optim_loss: 22041174.2595; val_kl_reg_loss: 68040.1505; val_edge_recon_loss: 593596.9625; val_gene_expr_recon_loss: 19382117.0667; val_masked_gp_l1_reg_loss: 123559.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83624.8281; val_chrom_access_recon_loss: 2018912.6083; val_global_loss: 22269850.9333; val_optim_loss: 22269850.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9623; val_auprc_score: 0.9527; val_best_acc_score: 0.9039; val_best_f1_score: 0.9070; train_kl_reg_loss: 68174.5262; train_edge_recon_loss: 588769.7953; train_gene_expr_recon_loss: 19108511.3740; train_masked_gp_l1_reg_loss: 123744.1669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83589.5563; train_chrom_access_recon_loss: 1985388.0067; train_global_loss: 21958177.2977; train_optim_loss: 21958177.2977; val_kl_reg_loss: 68524.3719; val_edge_recon_loss: 594278.9917; val_gene_expr_recon_loss: 19352396.8000; val_masked_gp_l1_reg_loss: 124416.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84165.5391; val_chrom_access_recon_loss: 2011990.7833; val_global_loss: 22235773.0667; val_optim_loss: 22235773.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9694; val_auprc_score: 0.9640; val_best_acc_score: 0.9148; val_best_f1_score: 0.9171; train_kl_reg_loss: 67629.6190; train_edge_recon_loss: 587183.3416; train_gene_expr_recon_loss: 19033564.2443; train_masked_gp_l1_reg_loss: 124436.6248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83417.2834; train_chrom_access_recon_loss: 1977227.5420; train_global_loss: 21873458.5649; train_optim_loss: 21873458.5649; val_kl_reg_loss: 67310.1857; val_edge_recon_loss: 584093.8708; val_gene_expr_recon_loss: 19250865.7333; val_masked_gp_l1_reg_loss: 125082.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84938.8281; val_chrom_access_recon_loss: 1999946.3333; val_global_loss: 22112236.1333; val_optim_loss: 22112236.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9652; val_auprc_score: 0.9582; val_best_acc_score: 0.9115; val_best_f1_score: 0.9141; train_kl_reg_loss: 67311.8897; train_edge_recon_loss: 586189.8511; train_gene_expr_recon_loss: 19000719.7863; train_masked_gp_l1_reg_loss: 125262.9582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84265.6146; train_chrom_access_recon_loss: 1974576.2548; train_global_loss: 21838326.3206; train_optim_loss: 21838326.3206; val_kl_reg_loss: 64825.9234; val_edge_recon_loss: 589507.5250; val_gene_expr_recon_loss: 19224822.2667; val_masked_gp_l1_reg_loss: 125619.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84505.6172; val_chrom_access_recon_loss: 2008671.5417; val_global_loss: 22097953.0667; val_optim_loss: 22097953.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9657; val_auprc_score: 0.9576; val_best_acc_score: 0.9148; val_best_f1_score: 0.9171; train_kl_reg_loss: 66784.1440; train_edge_recon_loss: 584153.5100; train_gene_expr_recon_loss: 18936530.7939; train_masked_gp_l1_reg_loss: 126305.5013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84663.8064; train_chrom_access_recon_loss: 1967321.9494; train_global_loss: 21765759.7252; train_optim_loss: 21765759.7252; val_kl_reg_loss: 67842.3797; val_edge_recon_loss: 588014.4292; val_gene_expr_recon_loss: 19175818.9333; val_masked_gp_l1_reg_loss: 126356.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84082.4453; val_chrom_access_recon_loss: 1994418.5250; val_global_loss: 22036532.2667; val_optim_loss: 22036532.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9686; val_auprc_score: 0.9610; val_best_acc_score: 0.9189; val_best_f1_score: 0.9206; train_kl_reg_loss: 66266.8574; train_edge_recon_loss: 584536.9089; train_gene_expr_recon_loss: 18898561.8779; train_masked_gp_l1_reg_loss: 127261.9185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85237.7629; train_chrom_access_recon_loss: 1966081.4017; train_global_loss: 21727946.7328; train_optim_loss: 21727946.7328; val_kl_reg_loss: 64889.1440; val_edge_recon_loss: 584592.2917; val_gene_expr_recon_loss: 19044372.1333; val_masked_gp_l1_reg_loss: 128173.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87559.6016; val_chrom_access_recon_loss: 1988739.6583; val_global_loss: 21898327.4667; val_optim_loss: 21898327.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9664; val_auprc_score: 0.9568; val_best_acc_score: 0.9148; val_best_f1_score: 0.9179; train_kl_reg_loss: 65839.0673; train_edge_recon_loss: 583618.9408; train_gene_expr_recon_loss: 18821302.1374; train_masked_gp_l1_reg_loss: 128624.0534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86036.8081; train_chrom_access_recon_loss: 1957611.5076; train_global_loss: 21643032.5344; train_optim_loss: 21643032.5344; val_kl_reg_loss: 64804.0208; val_edge_recon_loss: 589154.2333; val_gene_expr_recon_loss: 19126039.2000; val_masked_gp_l1_reg_loss: 129181.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86831.2422; val_chrom_access_recon_loss: 2004588.0250; val_global_loss: 22000599.0667; val_optim_loss: 22000599.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9676; val_auprc_score: 0.9581; val_best_acc_score: 0.9155; val_best_f1_score: 0.9182; train_kl_reg_loss: 65300.7422; train_edge_recon_loss: 584424.6269; train_gene_expr_recon_loss: 18767592.1679; train_masked_gp_l1_reg_loss: 129812.2229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86447.8669; train_chrom_access_recon_loss: 1950804.0038; train_global_loss: 21584381.5420; train_optim_loss: 21584381.5420; val_kl_reg_loss: 65634.0029; val_edge_recon_loss: 586234.5333; val_gene_expr_recon_loss: 19065752.1333; val_masked_gp_l1_reg_loss: 130427.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86984.7812; val_chrom_access_recon_loss: 2001014.1167; val_global_loss: 21936046.6667; val_optim_loss: 21936046.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9641; val_auprc_score: 0.9564; val_best_acc_score: 0.9062; val_best_f1_score: 0.9083; train_kl_reg_loss: 195284.1080; train_edge_recon_loss: 595563.7094; train_gene_expr_recon_loss: 18864065.8626; train_masked_gp_l1_reg_loss: 128893.4990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88753.1792; train_chrom_access_recon_loss: 1965131.8578; train_global_loss: 21837692.1374; train_optim_loss: 21837692.1374; val_kl_reg_loss: 77229.0995; val_edge_recon_loss: 593223.7583; val_gene_expr_recon_loss: 19070741.4667; val_masked_gp_l1_reg_loss: 124760.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92652.0078; val_chrom_access_recon_loss: 2007130.1917; val_global_loss: 21965736.5333; val_optim_loss: 21965736.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9617; val_auprc_score: 0.9535; val_best_acc_score: 0.9016; val_best_f1_score: 0.9070; train_kl_reg_loss: 71499.7658; train_edge_recon_loss: 594568.5310; train_gene_expr_recon_loss: 18842433.4962; train_masked_gp_l1_reg_loss: 124720.9716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89724.4535; train_chrom_access_recon_loss: 1955730.5573; train_global_loss: 21678677.7252; train_optim_loss: 21678677.7252; val_kl_reg_loss: 70780.5042; val_edge_recon_loss: 598329.4917; val_gene_expr_recon_loss: 19225895.3333; val_masked_gp_l1_reg_loss: 124373.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89237.9688; val_chrom_access_recon_loss: 1996587.0000; val_global_loss: 22105204.5333; val_optim_loss: 22105204.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9597; val_auprc_score: 0.9490; val_best_acc_score: 0.9027; val_best_f1_score: 0.9058; train_kl_reg_loss: 70545.3699; train_edge_recon_loss: 592877.9447; train_gene_expr_recon_loss: 18835102.0916; train_masked_gp_l1_reg_loss: 116264.7953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63591.7771; train_chrom_access_recon_loss: 1948930.3426; train_global_loss: 21627311.9695; train_optim_loss: 21627311.9695; val_kl_reg_loss: 72240.0089; val_edge_recon_loss: 591713.2667; val_gene_expr_recon_loss: 19062907.6000; val_masked_gp_l1_reg_loss: 113993.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59243.2773; val_chrom_access_recon_loss: 1989713.1333; val_global_loss: 21889811.8667; val_optim_loss: 21889811.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9597; val_auprc_score: 0.9513; val_best_acc_score: 0.9016; val_best_f1_score: 0.9059; train_kl_reg_loss: 71957.0082; train_edge_recon_loss: 590199.1546; train_gene_expr_recon_loss: 18745279.6336; train_masked_gp_l1_reg_loss: 113544.5884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58354.7509; train_chrom_access_recon_loss: 1942095.3693; train_global_loss: 21521430.5954; train_optim_loss: 21521430.5954; val_kl_reg_loss: 72026.8755; val_edge_recon_loss: 591303.5083; val_gene_expr_recon_loss: 19025529.6000; val_masked_gp_l1_reg_loss: 113283.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58201.2539; val_chrom_access_recon_loss: 1975745.6917; val_global_loss: 21836091.3333; val_optim_loss: 21836091.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9567; val_auprc_score: 0.9485; val_best_acc_score: 0.8932; val_best_f1_score: 0.8986; train_kl_reg_loss: 72372.3620; train_edge_recon_loss: 669629.3483; train_gene_expr_recon_loss: 17934675.0687; train_masked_gp_l1_reg_loss: 113270.2873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55883.3797; train_chrom_access_recon_loss: 1897638.5458; train_global_loss: 20743468.8702; train_optim_loss: 20743468.8702; val_kl_reg_loss: 32769.8956; val_edge_recon_loss: 669831.6708; val_gene_expr_recon_loss: 18075176.5333; val_masked_gp_l1_reg_loss: 113308.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55021.7227; val_chrom_access_recon_loss: 1910504.5750; val_global_loss: 20856612.9333; val_optim_loss: 20856612.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9572; val_auprc_score: 0.9479; val_best_acc_score: 0.8969; val_best_f1_score: 0.9009; train_kl_reg_loss: 70600.4704; train_edge_recon_loss: 660744.3674; train_gene_expr_recon_loss: 17912879.6641; train_masked_gp_l1_reg_loss: 113195.9041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54402.8731; train_chrom_access_recon_loss: 1883650.0105; train_global_loss: 20695473.2366; train_optim_loss: 20695473.2366; val_kl_reg_loss: 33023.6781; val_edge_recon_loss: 658373.5333; val_gene_expr_recon_loss: 18079360.8000; val_masked_gp_l1_reg_loss: 113004.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53787.9336; val_chrom_access_recon_loss: 1910552.4583; val_global_loss: 20848102.2667; val_optim_loss: 20848102.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9555; val_auprc_score: 0.9479; val_best_acc_score: 0.8895; val_best_f1_score: 0.8941; train_kl_reg_loss: 70075.2310; train_edge_recon_loss: 652779.9652; train_gene_expr_recon_loss: 17875272.8321; train_masked_gp_l1_reg_loss: 112790.8375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53221.5857; train_chrom_access_recon_loss: 1878395.7910; train_global_loss: 20642536.2137; train_optim_loss: 20642536.2137; val_kl_reg_loss: 34591.1508; val_edge_recon_loss: 652683.6042; val_gene_expr_recon_loss: 18111234.2667; val_masked_gp_l1_reg_loss: 112617.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52758.0391; val_chrom_access_recon_loss: 1912097.2417; val_global_loss: 20875982.0000; val_optim_loss: 20875982.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9551; val_auprc_score: 0.9463; val_best_acc_score: 0.8897; val_best_f1_score: 0.8946; train_kl_reg_loss: 69240.6442; train_edge_recon_loss: 645230.8779; train_gene_expr_recon_loss: 17882518.9542; train_masked_gp_l1_reg_loss: 112399.8972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52350.5082; train_chrom_access_recon_loss: 1877440.1336; train_global_loss: 20639181.0229; train_optim_loss: 20639181.0229; val_kl_reg_loss: 35325.3292; val_edge_recon_loss: 644298.0500; val_gene_expr_recon_loss: 18087640.1333; val_masked_gp_l1_reg_loss: 112199.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52000.0273; val_chrom_access_recon_loss: 1907656.4667; val_global_loss: 20839120.1333; val_optim_loss: 20839120.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9552; val_auprc_score: 0.9443; val_best_acc_score: 0.8910; val_best_f1_score: 0.8943; train_kl_reg_loss: 68749.2875; train_edge_recon_loss: 638172.4346; train_gene_expr_recon_loss: 17857526.4427; train_masked_gp_l1_reg_loss: 112010.5521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51627.8783; train_chrom_access_recon_loss: 1873592.4074; train_global_loss: 20601679.0992; train_optim_loss: 20601679.0992; val_kl_reg_loss: 36733.8708; val_edge_recon_loss: 637226.7917; val_gene_expr_recon_loss: 18134503.3333; val_masked_gp_l1_reg_loss: 111807.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51244.3320; val_chrom_access_recon_loss: 1917083.6250; val_global_loss: 20888599.3333; val_optim_loss: 20888599.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9554; val_auprc_score: 0.9452; val_best_acc_score: 0.8922; val_best_f1_score: 0.8959; train_kl_reg_loss: 68447.8747; train_edge_recon_loss: 631264.2171; train_gene_expr_recon_loss: 17864497.4198; train_masked_gp_l1_reg_loss: 111592.4628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50936.5648; train_chrom_access_recon_loss: 1875703.7347; train_global_loss: 20602442.2443; train_optim_loss: 20602442.2443; val_kl_reg_loss: 38417.6117; val_edge_recon_loss: 626724.2333; val_gene_expr_recon_loss: 18139169.2000; val_masked_gp_l1_reg_loss: 111422.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50580.2422; val_chrom_access_recon_loss: 1911171.7000; val_global_loss: 20877484.8000; val_optim_loss: 20877484.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9548; val_auprc_score: 0.9458; val_best_acc_score: 0.8917; val_best_f1_score: 0.8953; train_kl_reg_loss: 67858.7193; train_edge_recon_loss: 624720.1360; train_gene_expr_recon_loss: 17868239.9771; train_masked_gp_l1_reg_loss: 111217.6891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50293.1250; train_chrom_access_recon_loss: 1874351.7185; train_global_loss: 20596681.5573; train_optim_loss: 20596681.5573; val_kl_reg_loss: 39983.1365; val_edge_recon_loss: 624470.1125; val_gene_expr_recon_loss: 18145220.2667; val_masked_gp_l1_reg_loss: 111058.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50121.1016; val_chrom_access_recon_loss: 1897195.7000; val_global_loss: 20868049.0667; val_optim_loss: 20868049.0667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9545; val_auprc_score: 0.9482; val_best_acc_score: 0.8868; val_best_f1_score: 0.8909; train_kl_reg_loss: 67301.5576; train_edge_recon_loss: 621305.9509; train_gene_expr_recon_loss: 17840543.3588; train_masked_gp_l1_reg_loss: 110841.9073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49818.4553; train_chrom_access_recon_loss: 1873372.9408; train_global_loss: 20563184.1527; train_optim_loss: 20563184.1527; val_kl_reg_loss: 41506.0464; val_edge_recon_loss: 622173.4750; val_gene_expr_recon_loss: 18037652.4000; val_masked_gp_l1_reg_loss: 110642.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49560.9336; val_chrom_access_recon_loss: 1894097.3333; val_global_loss: 20755631.3333; val_optim_loss: 20755631.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9534; val_auprc_score: 0.9438; val_best_acc_score: 0.8879; val_best_f1_score: 0.8924; train_kl_reg_loss: 66640.9710; train_edge_recon_loss: 616114.2094; train_gene_expr_recon_loss: 17855703.9008; train_masked_gp_l1_reg_loss: 110455.8915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49383.0942; train_chrom_access_recon_loss: 1873507.2147; train_global_loss: 20571805.1450; train_optim_loss: 20571805.1450; val_kl_reg_loss: 43367.2771; val_edge_recon_loss: 618110.1500; val_gene_expr_recon_loss: 18151946.4000; val_masked_gp_l1_reg_loss: 110252.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49150.8320; val_chrom_access_recon_loss: 1917323.3500; val_global_loss: 20890149.2000; val_optim_loss: 20890149.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9552; val_auprc_score: 0.9464; val_best_acc_score: 0.8887; val_best_f1_score: 0.8927; train_kl_reg_loss: 66090.0937; train_edge_recon_loss: 613012.6202; train_gene_expr_recon_loss: 17834206.6489; train_masked_gp_l1_reg_loss: 110060.2919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48990.0167; train_chrom_access_recon_loss: 1870560.7462; train_global_loss: 20542920.4885; train_optim_loss: 20542920.4885; val_kl_reg_loss: 45254.3107; val_edge_recon_loss: 614497.7208; val_gene_expr_recon_loss: 18072703.2000; val_masked_gp_l1_reg_loss: 109856.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48784.3828; val_chrom_access_recon_loss: 1911680.8417; val_global_loss: 20802776.0000; val_optim_loss: 20802776.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9503; val_auprc_score: 0.9392; val_best_acc_score: 0.8828; val_best_f1_score: 0.8874; train_kl_reg_loss: 65391.7015; train_edge_recon_loss: 610105.6551; train_gene_expr_recon_loss: 17846242.1221; train_masked_gp_l1_reg_loss: 109647.7360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48613.6001; train_chrom_access_recon_loss: 1872691.4027; train_global_loss: 20552692.2443; train_optim_loss: 20552692.2443; val_kl_reg_loss: 46468.8615; val_edge_recon_loss: 612628.7042; val_gene_expr_recon_loss: 18054088.2667; val_masked_gp_l1_reg_loss: 109488.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48457.8320; val_chrom_access_recon_loss: 1897483.0167; val_global_loss: 20768614.6667; val_optim_loss: 20768614.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9519; val_auprc_score: 0.9447; val_best_acc_score: 0.8879; val_best_f1_score: 0.8917; train_kl_reg_loss: 64961.5944; train_edge_recon_loss: 607878.2982; train_gene_expr_recon_loss: 17824283.3817; train_masked_gp_l1_reg_loss: 109309.5042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48238.6879; train_chrom_access_recon_loss: 1871350.5277; train_global_loss: 20526021.9237; train_optim_loss: 20526021.9237; val_kl_reg_loss: 47965.1896; val_edge_recon_loss: 608168.0417; val_gene_expr_recon_loss: 18094692.0667; val_masked_gp_l1_reg_loss: 109073.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48039.7578; val_chrom_access_recon_loss: 1907714.7500; val_global_loss: 20815653.6000; val_optim_loss: 20815653.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9533; val_auprc_score: 0.9455; val_best_acc_score: 0.8880; val_best_f1_score: 0.8919; train_kl_reg_loss: 64607.9623; train_edge_recon_loss: 606717.2362; train_gene_expr_recon_loss: 17834025.1756; train_masked_gp_l1_reg_loss: 108626.3683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46607.0263; train_chrom_access_recon_loss: 1872023.2156; train_global_loss: 20532606.9160; train_optim_loss: 20532606.9160; val_kl_reg_loss: 47742.3659; val_edge_recon_loss: 609083.2708; val_gene_expr_recon_loss: 18039512.8000; val_masked_gp_l1_reg_loss: 108465.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46399.8203; val_chrom_access_recon_loss: 1903821.1000; val_global_loss: 20755025.2000; val_optim_loss: 20755025.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9565; val_auprc_score: 0.9506; val_best_acc_score: 0.8903; val_best_f1_score: 0.8937; train_kl_reg_loss: 64695.9670; train_edge_recon_loss: 606133.5200; train_gene_expr_recon_loss: 17823896.9847; train_masked_gp_l1_reg_loss: 108402.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46331.5173; train_chrom_access_recon_loss: 1871525.4265; train_global_loss: 20520985.6794; train_optim_loss: 20520985.6794; val_kl_reg_loss: 48116.5943; val_edge_recon_loss: 606136.8208; val_gene_expr_recon_loss: 18155909.7333; val_masked_gp_l1_reg_loss: 108344.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46278.9648; val_chrom_access_recon_loss: 1915710.4083; val_global_loss: 20880495.4667; val_optim_loss: 20880495.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9509; val_auprc_score: 0.9429; val_best_acc_score: 0.8839; val_best_f1_score: 0.8894; train_kl_reg_loss: 64581.6305; train_edge_recon_loss: 606119.2519; train_gene_expr_recon_loss: 17830970.3511; train_masked_gp_l1_reg_loss: 108311.7894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46233.3659; train_chrom_access_recon_loss: 1871853.6489; train_global_loss: 20528070.0153; train_optim_loss: 20528070.0153; val_kl_reg_loss: 48131.3271; val_edge_recon_loss: 607972.7750; val_gene_expr_recon_loss: 18031589.3333; val_masked_gp_l1_reg_loss: 108273.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46185.2969; val_chrom_access_recon_loss: 1895752.1417; val_global_loss: 20737905.3333; val_optim_loss: 20737905.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9550; val_auprc_score: 0.9468; val_best_acc_score: 0.8940; val_best_f1_score: 0.8974; train_kl_reg_loss: 64489.2971; train_edge_recon_loss: 604182.8993; train_gene_expr_recon_loss: 17829762.5649; train_masked_gp_l1_reg_loss: 108242.0207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46153.3801; train_chrom_access_recon_loss: 1873202.0477; train_global_loss: 20526032.2290; train_optim_loss: 20526032.2290; val_kl_reg_loss: 48171.8401; val_edge_recon_loss: 605344.1083; val_gene_expr_recon_loss: 18137521.0000; val_masked_gp_l1_reg_loss: 108212.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46112.6055; val_chrom_access_recon_loss: 1906032.8500; val_global_loss: 20851393.4667; val_optim_loss: 20851393.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9554; val_auprc_score: 0.9469; val_best_acc_score: 0.8913; val_best_f1_score: 0.8947; train_kl_reg_loss: 64532.3865; train_edge_recon_loss: 603518.7023; train_gene_expr_recon_loss: 17829153.9466; train_masked_gp_l1_reg_loss: 108187.3557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46083.0330; train_chrom_access_recon_loss: 1872066.8826; train_global_loss: 20523542.2901; train_optim_loss: 20523542.2901; val_kl_reg_loss: 60023.8771; val_edge_recon_loss: 607144.6083; val_gene_expr_recon_loss: 17965133.3333; val_masked_gp_l1_reg_loss: 108153.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46053.0625; val_chrom_access_recon_loss: 1891812.5333; val_global_loss: 20678322.6667; val_optim_loss: 20678322.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9531; val_auprc_score: 0.9448; val_best_acc_score: 0.8892; val_best_f1_score: 0.8929; train_kl_reg_loss: 64512.3460; train_edge_recon_loss: 605476.9466; train_gene_expr_recon_loss: 17828723.5267; train_masked_gp_l1_reg_loss: 108127.7629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46025.6901; train_chrom_access_recon_loss: 1871232.7223; train_global_loss: 20524099.0687; train_optim_loss: 20524099.0687; val_kl_reg_loss: 48762.0609; val_edge_recon_loss: 607208.5000; val_gene_expr_recon_loss: 18080644.5333; val_masked_gp_l1_reg_loss: 108100.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45989.3047; val_chrom_access_recon_loss: 1911109.6750; val_global_loss: 20801814.6667; val_optim_loss: 20801814.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9543; val_auprc_score: 0.9434; val_best_acc_score: 0.8901; val_best_f1_score: 0.8933; train_kl_reg_loss: 64568.9553; train_edge_recon_loss: 605470.6064; train_gene_expr_recon_loss: 17832289.9389; train_masked_gp_l1_reg_loss: 108071.2554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45956.8529; train_chrom_access_recon_loss: 1871917.0315; train_global_loss: 20528274.6870; train_optim_loss: 20528274.6870; val_kl_reg_loss: 48985.2792; val_edge_recon_loss: 604827.1250; val_gene_expr_recon_loss: 18044524.9333; val_masked_gp_l1_reg_loss: 108045.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45924.8945; val_chrom_access_recon_loss: 1903723.3083; val_global_loss: 20756030.8000; val_optim_loss: 20756030.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9533; val_auprc_score: 0.9440; val_best_acc_score: 0.8892; val_best_f1_score: 0.8926; train_kl_reg_loss: 64447.9056; train_edge_recon_loss: 604908.4948; train_gene_expr_recon_loss: 17820266.8550; train_masked_gp_l1_reg_loss: 108017.5393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45906.2740; train_chrom_access_recon_loss: 1871713.2834; train_global_loss: 20515260.4122; train_optim_loss: 20515260.4122; val_kl_reg_loss: 48938.7956; val_edge_recon_loss: 605831.5125; val_gene_expr_recon_loss: 18026398.2667; val_masked_gp_l1_reg_loss: 107987.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45875.7773; val_chrom_access_recon_loss: 1909259.7667; val_global_loss: 20744292.4000; val_optim_loss: 20744292.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9523; val_auprc_score: 0.9430; val_best_acc_score: 0.8883; val_best_f1_score: 0.8923; train_kl_reg_loss: 64415.8505; train_edge_recon_loss: 603825.7572; train_gene_expr_recon_loss: 17805646.2137; train_masked_gp_l1_reg_loss: 107962.7978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45850.8987; train_chrom_access_recon_loss: 1869340.6069; train_global_loss: 20497041.9542; train_optim_loss: 20497041.9542; val_kl_reg_loss: 49192.2297; val_edge_recon_loss: 604916.9375; val_gene_expr_recon_loss: 18082501.2000; val_masked_gp_l1_reg_loss: 107934.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45816.7969; val_chrom_access_recon_loss: 1907942.1417; val_global_loss: 20798302.8000; val_optim_loss: 20798302.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9504; val_auprc_score: 0.9403; val_best_acc_score: 0.8882; val_best_f1_score: 0.8919; train_kl_reg_loss: 64359.4352; train_edge_recon_loss: 602992.0930; train_gene_expr_recon_loss: 17810805.6183; train_masked_gp_l1_reg_loss: 107888.6915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45669.2453; train_chrom_access_recon_loss: 1870063.9723; train_global_loss: 20501778.9466; train_optim_loss: 20501778.9466; val_kl_reg_loss: 49273.8914; val_edge_recon_loss: 606042.9375; val_gene_expr_recon_loss: 18088860.2667; val_masked_gp_l1_reg_loss: 107870.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45648.9961; val_chrom_access_recon_loss: 1909104.7917; val_global_loss: 20806799.7333; val_optim_loss: 20806799.7333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9502; val_auprc_score: 0.9409; val_best_acc_score: 0.8871; val_best_f1_score: 0.8907; train_kl_reg_loss: 64354.8275; train_edge_recon_loss: 603716.4184; train_gene_expr_recon_loss: 17817421.6412; train_masked_gp_l1_reg_loss: 107862.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45642.8504; train_chrom_access_recon_loss: 1871071.9094; train_global_loss: 20510069.8168; train_optim_loss: 20510069.8168; val_kl_reg_loss: 49251.8510; val_edge_recon_loss: 606535.9792; val_gene_expr_recon_loss: 18105673.4667; val_masked_gp_l1_reg_loss: 107854.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45637.7695; val_chrom_access_recon_loss: 1906540.5917; val_global_loss: 20821493.6000; val_optim_loss: 20821493.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9488; val_auprc_score: 0.9377; val_best_acc_score: 0.8853; val_best_f1_score: 0.8895; train_kl_reg_loss: 64328.4313; train_edge_recon_loss: 604337.9790; train_gene_expr_recon_loss: 17813925.4885; train_masked_gp_l1_reg_loss: 107848.4620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45632.7370; train_chrom_access_recon_loss: 1869780.7634; train_global_loss: 20505853.7405; train_optim_loss: 20505853.7405; val_kl_reg_loss: 49132.6375; val_edge_recon_loss: 606677.8875; val_gene_expr_recon_loss: 18053604.2667; val_masked_gp_l1_reg_loss: 107843.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45628.5938; val_chrom_access_recon_loss: 1898503.1333; val_global_loss: 20761390.0000; val_optim_loss: 20761390.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9497; val_auprc_score: 0.9386; val_best_acc_score: 0.8863; val_best_f1_score: 0.8902; train_kl_reg_loss: 64319.0576; train_edge_recon_loss: 602833.5520; train_gene_expr_recon_loss: 17800726.8779; train_masked_gp_l1_reg_loss: 107839.3969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45624.6130; train_chrom_access_recon_loss: 1867066.9532; train_global_loss: 20488410.2901; train_optim_loss: 20488410.2901; val_kl_reg_loss: 49255.4232; val_edge_recon_loss: 606096.0500; val_gene_expr_recon_loss: 18047820.6667; val_masked_gp_l1_reg_loss: 107834.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45620.2734; val_chrom_access_recon_loss: 1899182.7917; val_global_loss: 20755808.8000; val_optim_loss: 20755808.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 22 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9504
val AUPRC score: 0.9411
val best accuracy score: 0.8825
val best F1 score: 0.8885
val target rna MSE score: 1.4792
val source rna MSE score: 0.6540
val target atac MSE score: 0.3502
val source atac MSE score: 0.1073
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
