[True]
Run timestamp: 10082023_211501_53.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_53']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6917; val_auprc_score: 0.7350; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 110419.0940; train_edge_recon_loss: 3755269.2252; train_gene_expr_recon_loss: 27092934.3053; train_masked_gp_l1_reg_loss: 76005.5771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240573.0617; train_chrom_access_recon_loss: 6788528.4389; train_global_loss: 38063729.6641; train_optim_loss: 38063729.6641; val_kl_reg_loss: 74699.6583; val_edge_recon_loss: 4065749.1167; val_gene_expr_recon_loss: 23454802.9333; val_masked_gp_l1_reg_loss: 77375.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231423.3906; val_chrom_access_recon_loss: 6484541.7000; val_global_loss: 34388593.6000; val_optim_loss: 34388593.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7676; val_auprc_score: 0.7851; val_best_acc_score: 0.5610; val_best_f1_score: 0.6921; train_kl_reg_loss: 148548.1619; train_edge_recon_loss: 3648283.6221; train_gene_expr_recon_loss: 23208242.4122; train_masked_gp_l1_reg_loss: 76178.7745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221471.0076; train_chrom_access_recon_loss: 6414194.4466; train_global_loss: 33716918.4733; train_optim_loss: 33716918.4733; val_kl_reg_loss: 155834.8573; val_edge_recon_loss: 4062027.4167; val_gene_expr_recon_loss: 22536244.0000; val_masked_gp_l1_reg_loss: 75015.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210724.4688; val_chrom_access_recon_loss: 6377422.6667; val_global_loss: 33417268.8000; val_optim_loss: 33417268.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7596; val_auprc_score: 0.7848; val_best_acc_score: 0.6211; val_best_f1_score: 0.7057; train_kl_reg_loss: 153770.0745; train_edge_recon_loss: 3570242.7118; train_gene_expr_recon_loss: 22550745.4046; train_masked_gp_l1_reg_loss: 75051.6226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200440.9454; train_chrom_access_recon_loss: 6333559.5305; train_global_loss: 32883810.3969; train_optim_loss: 32883810.3969; val_kl_reg_loss: 154240.2427; val_edge_recon_loss: 4057722.5500; val_gene_expr_recon_loss: 22217839.8667; val_masked_gp_l1_reg_loss: 74431.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190028.7188; val_chrom_access_recon_loss: 6296187.3667; val_global_loss: 32990449.8667; val_optim_loss: 32990449.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8179; val_auprc_score: 0.8284; val_best_acc_score: 0.7281; val_best_f1_score: 0.7512; train_kl_reg_loss: 143668.7087; train_edge_recon_loss: 3546156.9847; train_gene_expr_recon_loss: 22184509.2366; train_masked_gp_l1_reg_loss: 75430.1884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180433.0807; train_chrom_access_recon_loss: 6286321.6985; train_global_loss: 32416519.7710; train_optim_loss: 32416519.7710; val_kl_reg_loss: 136039.7172; val_edge_recon_loss: 4037578.3167; val_gene_expr_recon_loss: 21934840.9333; val_masked_gp_l1_reg_loss: 76779.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171200.9219; val_chrom_access_recon_loss: 6263863.9333; val_global_loss: 32620303.0667; val_optim_loss: 32620303.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8758; val_auprc_score: 0.8763; val_best_acc_score: 0.7515; val_best_f1_score: 0.7895; train_kl_reg_loss: 129762.0952; train_edge_recon_loss: 3525325.6908; train_gene_expr_recon_loss: 21887842.6412; train_masked_gp_l1_reg_loss: 76962.6478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162990.5129; train_chrom_access_recon_loss: 6246603.0878; train_global_loss: 32029486.5038; train_optim_loss: 32029486.5038; val_kl_reg_loss: 128300.1042; val_edge_recon_loss: 3947469.9500; val_gene_expr_recon_loss: 21813391.8667; val_masked_gp_l1_reg_loss: 77635.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154988.1406; val_chrom_access_recon_loss: 6273478.0333; val_global_loss: 32395264.1333; val_optim_loss: 32395264.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9106; val_auprc_score: 0.9007; val_best_acc_score: 0.8335; val_best_f1_score: 0.8466; train_kl_reg_loss: 111543.1158; train_edge_recon_loss: 3451534.3397; train_gene_expr_recon_loss: 21732768.0763; train_masked_gp_l1_reg_loss: 78674.9310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148091.4170; train_chrom_access_recon_loss: 6223297.1221; train_global_loss: 31745909.0992; train_optim_loss: 31745909.0992; val_kl_reg_loss: 97541.9453; val_edge_recon_loss: 3395035.1167; val_gene_expr_recon_loss: 21679965.4667; val_masked_gp_l1_reg_loss: 80160.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141567.7812; val_chrom_access_recon_loss: 6236137.5000; val_global_loss: 31630408.0000; val_optim_loss: 31630408.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9114; val_auprc_score: 0.8972; val_best_acc_score: 0.8359; val_best_f1_score: 0.8477; train_kl_reg_loss: 131389.9248; train_edge_recon_loss: 3067263.7767; train_gene_expr_recon_loss: 21640006.8855; train_masked_gp_l1_reg_loss: 82278.1503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136145.2885; train_chrom_access_recon_loss: 6210035.2176; train_global_loss: 31267119.2519; train_optim_loss: 31267119.2519; val_kl_reg_loss: 154819.0427; val_edge_recon_loss: 2957320.4500; val_gene_expr_recon_loss: 21584893.7333; val_masked_gp_l1_reg_loss: 83933.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130938.9766; val_chrom_access_recon_loss: 6222569.0000; val_global_loss: 31134473.8667; val_optim_loss: 31134473.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9212; val_auprc_score: 0.9058; val_best_acc_score: 0.8514; val_best_f1_score: 0.8596; train_kl_reg_loss: 154111.7947; train_edge_recon_loss: 2926743.3664; train_gene_expr_recon_loss: 21493871.7710; train_masked_gp_l1_reg_loss: 85244.4742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126192.7903; train_chrom_access_recon_loss: 6179854.6718; train_global_loss: 30966018.9008; train_optim_loss: 30966018.9008; val_kl_reg_loss: 152768.9021; val_edge_recon_loss: 2934909.8667; val_gene_expr_recon_loss: 21291639.3333; val_masked_gp_l1_reg_loss: 86563.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121581.2109; val_chrom_access_recon_loss: 6154234.8000; val_global_loss: 30741699.3333; val_optim_loss: 30741699.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9274; val_auprc_score: 0.9123; val_best_acc_score: 0.8667; val_best_f1_score: 0.8722; train_kl_reg_loss: 155677.8156; train_edge_recon_loss: 2887800.6622; train_gene_expr_recon_loss: 21346106.4733; train_masked_gp_l1_reg_loss: 87689.6063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117462.9287; train_chrom_access_recon_loss: 6151105.6145; train_global_loss: 30745843.2061; train_optim_loss: 30745843.2061; val_kl_reg_loss: 156556.3323; val_edge_recon_loss: 2889183.6000; val_gene_expr_recon_loss: 21192116.2667; val_masked_gp_l1_reg_loss: 88982.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113418.8984; val_chrom_access_recon_loss: 6118910.6333; val_global_loss: 30559166.8000; val_optim_loss: 30559166.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9299; val_auprc_score: 0.9149; val_best_acc_score: 0.8686; val_best_f1_score: 0.8762; train_kl_reg_loss: 151252.3253; train_edge_recon_loss: 2877567.6221; train_gene_expr_recon_loss: 21245066.5954; train_masked_gp_l1_reg_loss: 90070.6056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109727.3541; train_chrom_access_recon_loss: 6123898.0038; train_global_loss: 30597582.5649; train_optim_loss: 30597582.5649; val_kl_reg_loss: 143479.4792; val_edge_recon_loss: 2892588.3167; val_gene_expr_recon_loss: 21307985.7333; val_masked_gp_l1_reg_loss: 91144.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106109.5078; val_chrom_access_recon_loss: 6184585.9000; val_global_loss: 30725893.7333; val_optim_loss: 30725893.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9337; val_auprc_score: 0.9212; val_best_acc_score: 0.8709; val_best_f1_score: 0.8773; train_kl_reg_loss: 144600.1729; train_edge_recon_loss: 2854270.4141; train_gene_expr_recon_loss: 21214856.4427; train_masked_gp_l1_reg_loss: 92283.0264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102631.9875; train_chrom_access_recon_loss: 6127122.6947; train_global_loss: 30535764.5954; train_optim_loss: 30535764.5954; val_kl_reg_loss: 146080.6323; val_edge_recon_loss: 2865875.4333; val_gene_expr_recon_loss: 21063870.5333; val_masked_gp_l1_reg_loss: 93402.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99221.4453; val_chrom_access_recon_loss: 6107318.8333; val_global_loss: 30375769.4667; val_optim_loss: 30375769.4667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9366; val_auprc_score: 0.9227; val_best_acc_score: 0.8764; val_best_f1_score: 0.8832; train_kl_reg_loss: 143408.4741; train_edge_recon_loss: 2848002.3244; train_gene_expr_recon_loss: 21148943.6641; train_masked_gp_l1_reg_loss: 94368.3898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96208.0107; train_chrom_access_recon_loss: 6108787.0000; train_global_loss: 30439717.8015; train_optim_loss: 30439717.8015; val_kl_reg_loss: 140124.6641; val_edge_recon_loss: 2850606.7500; val_gene_expr_recon_loss: 21062054.9333; val_masked_gp_l1_reg_loss: 95340.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93245.8594; val_chrom_access_recon_loss: 6115611.2333; val_global_loss: 30356983.7333; val_optim_loss: 30356983.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9367; val_auprc_score: 0.9214; val_best_acc_score: 0.8789; val_best_f1_score: 0.8853; train_kl_reg_loss: 137801.1443; train_edge_recon_loss: 2843188.4943; train_gene_expr_recon_loss: 21081195.3435; train_masked_gp_l1_reg_loss: 96299.6459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90596.6104; train_chrom_access_recon_loss: 6093490.6603; train_global_loss: 30342571.9847; train_optim_loss: 30342571.9847; val_kl_reg_loss: 133512.5135; val_edge_recon_loss: 2838126.0500; val_gene_expr_recon_loss: 21044631.7333; val_masked_gp_l1_reg_loss: 97131.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88022.1094; val_chrom_access_recon_loss: 6109408.9667; val_global_loss: 30310833.2000; val_optim_loss: 30310833.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9390; val_auprc_score: 0.9246; val_best_acc_score: 0.8814; val_best_f1_score: 0.8866; train_kl_reg_loss: 133768.7569; train_edge_recon_loss: 2825506.4275; train_gene_expr_recon_loss: 21029523.7099; train_masked_gp_l1_reg_loss: 98103.9909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85679.1960; train_chrom_access_recon_loss: 6087531.0954; train_global_loss: 30260113.2366; train_optim_loss: 30260113.2366; val_kl_reg_loss: 132548.8849; val_edge_recon_loss: 2829329.2667; val_gene_expr_recon_loss: 20958786.5333; val_masked_gp_l1_reg_loss: 99159.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83459.7109; val_chrom_access_recon_loss: 6090317.6333; val_global_loss: 30193602.8000; val_optim_loss: 30193602.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9454; val_auprc_score: 0.9352; val_best_acc_score: 0.8856; val_best_f1_score: 0.8894; train_kl_reg_loss: 130441.8155; train_edge_recon_loss: 2821605.3626; train_gene_expr_recon_loss: 20957639.9237; train_masked_gp_l1_reg_loss: 99910.2356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81317.2175; train_chrom_access_recon_loss: 6072597.5611; train_global_loss: 30163512.1374; train_optim_loss: 30163512.1374; val_kl_reg_loss: 127425.5396; val_edge_recon_loss: 2816747.5000; val_gene_expr_recon_loss: 20941941.2000; val_masked_gp_l1_reg_loss: 100902.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79290.7969; val_chrom_access_recon_loss: 6084840.7333; val_global_loss: 30151146.6667; val_optim_loss: 30151146.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9397; val_auprc_score: 0.9267; val_best_acc_score: 0.8766; val_best_f1_score: 0.8836; train_kl_reg_loss: 128129.4823; train_edge_recon_loss: 2806959.9618; train_gene_expr_recon_loss: 20916288.1679; train_masked_gp_l1_reg_loss: 101664.5521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77341.6565; train_chrom_access_recon_loss: 6060907.2405; train_global_loss: 30091290.9618; train_optim_loss: 30091290.9618; val_kl_reg_loss: 124985.8859; val_edge_recon_loss: 2826209.5500; val_gene_expr_recon_loss: 20884969.3333; val_masked_gp_l1_reg_loss: 102383.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75462.4297; val_chrom_access_recon_loss: 6077549.1000; val_global_loss: 30091559.6000; val_optim_loss: 30091559.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9419; val_auprc_score: 0.9274; val_best_acc_score: 0.8793; val_best_f1_score: 0.8857; train_kl_reg_loss: 124816.7642; train_edge_recon_loss: 2799491.0286; train_gene_expr_recon_loss: 20899448.4122; train_masked_gp_l1_reg_loss: 103277.0543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73702.4798; train_chrom_access_recon_loss: 6055791.0649; train_global_loss: 30056526.9313; train_optim_loss: 30056526.9313; val_kl_reg_loss: 125370.1896; val_edge_recon_loss: 2827942.4833; val_gene_expr_recon_loss: 20830947.6000; val_masked_gp_l1_reg_loss: 104149.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72011.4688; val_chrom_access_recon_loss: 6065013.7000; val_global_loss: 30025436.0000; val_optim_loss: 30025436.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9533; val_auprc_score: 0.9420; val_best_acc_score: 0.8907; val_best_f1_score: 0.8962; train_kl_reg_loss: 120699.5948; train_edge_recon_loss: 2801033.2366; train_gene_expr_recon_loss: 20858874.8855; train_masked_gp_l1_reg_loss: 104850.3566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70237.2182; train_chrom_access_recon_loss: 6051748.2061; train_global_loss: 30007443.4656; train_optim_loss: 30007443.4656; val_kl_reg_loss: 118622.5656; val_edge_recon_loss: 2785646.3833; val_gene_expr_recon_loss: 20792443.2000; val_masked_gp_l1_reg_loss: 105498.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68480.4531; val_chrom_access_recon_loss: 6065378.6667; val_global_loss: 29936069.0667; val_optim_loss: 29936069.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9505; val_auprc_score: 0.9394; val_best_acc_score: 0.8902; val_best_f1_score: 0.8951; train_kl_reg_loss: 121065.6978; train_edge_recon_loss: 2782814.8950; train_gene_expr_recon_loss: 20821294.2290; train_masked_gp_l1_reg_loss: 106415.4846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66784.8678; train_chrom_access_recon_loss: 6040479.8053; train_global_loss: 29938855.1908; train_optim_loss: 29938855.1908; val_kl_reg_loss: 118847.7714; val_edge_recon_loss: 2797082.8333; val_gene_expr_recon_loss: 20766953.8667; val_masked_gp_l1_reg_loss: 107342.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65157.1797; val_chrom_access_recon_loss: 6056187.0667; val_global_loss: 29911571.6000; val_optim_loss: 29911571.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9510; val_auprc_score: 0.9366; val_best_acc_score: 0.8926; val_best_f1_score: 0.8977; train_kl_reg_loss: 119556.5980; train_edge_recon_loss: 2781819.4523; train_gene_expr_recon_loss: 20780804.0305; train_masked_gp_l1_reg_loss: 107915.5339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63564.2927; train_chrom_access_recon_loss: 6038136.0267; train_global_loss: 29891795.9084; train_optim_loss: 29891795.9084; val_kl_reg_loss: 120207.8870; val_edge_recon_loss: 2778427.7500; val_gene_expr_recon_loss: 20794109.2000; val_masked_gp_l1_reg_loss: 108551.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61995.7500; val_chrom_access_recon_loss: 6056909.3333; val_global_loss: 29920202.0000; val_optim_loss: 29920202.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9531; val_auprc_score: 0.9424; val_best_acc_score: 0.8906; val_best_f1_score: 0.8953; train_kl_reg_loss: 116506.2244; train_edge_recon_loss: 2776470.5286; train_gene_expr_recon_loss: 20759804.4733; train_masked_gp_l1_reg_loss: 109448.5107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60611.8032; train_chrom_access_recon_loss: 6028285.0420; train_global_loss: 29851126.7481; train_optim_loss: 29851126.7481; val_kl_reg_loss: 116322.2542; val_edge_recon_loss: 2787805.4000; val_gene_expr_recon_loss: 20756630.8000; val_masked_gp_l1_reg_loss: 110258.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59186.0000; val_chrom_access_recon_loss: 6088421.1000; val_global_loss: 29918623.4667; val_optim_loss: 29918623.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9526; val_auprc_score: 0.9387; val_best_acc_score: 0.8937; val_best_f1_score: 0.8990; train_kl_reg_loss: 114914.4909; train_edge_recon_loss: 2769861.5210; train_gene_expr_recon_loss: 20738511.9237; train_masked_gp_l1_reg_loss: 110854.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57869.3884; train_chrom_access_recon_loss: 6031107.4695; train_global_loss: 29823118.9771; train_optim_loss: 29823118.9771; val_kl_reg_loss: 110372.5005; val_edge_recon_loss: 2775118.3667; val_gene_expr_recon_loss: 20715220.8000; val_masked_gp_l1_reg_loss: 111697.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56700.0742; val_chrom_access_recon_loss: 6063253.5000; val_global_loss: 29832362.9333; val_optim_loss: 29832362.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9576; val_auprc_score: 0.9483; val_best_acc_score: 0.8975; val_best_f1_score: 0.9026; train_kl_reg_loss: 113438.7781; train_edge_recon_loss: 2763509.3168; train_gene_expr_recon_loss: 20712569.0992; train_masked_gp_l1_reg_loss: 112427.9840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55495.1574; train_chrom_access_recon_loss: 6023782.4847; train_global_loss: 29781222.9160; train_optim_loss: 29781222.9160; val_kl_reg_loss: 113065.7604; val_edge_recon_loss: 2780901.6667; val_gene_expr_recon_loss: 20704433.4667; val_masked_gp_l1_reg_loss: 113119.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54368.6641; val_chrom_access_recon_loss: 6045933.2667; val_global_loss: 29811822.0000; val_optim_loss: 29811822.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9578; val_auprc_score: 0.9486; val_best_acc_score: 0.8988; val_best_f1_score: 0.9016; train_kl_reg_loss: 111840.8469; train_edge_recon_loss: 2753339.9160; train_gene_expr_recon_loss: 20672918.4275; train_masked_gp_l1_reg_loss: 113879.0342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53322.8523; train_chrom_access_recon_loss: 6017949.8817; train_global_loss: 29723250.9771; train_optim_loss: 29723250.9771; val_kl_reg_loss: 111501.4906; val_edge_recon_loss: 2781535.0667; val_gene_expr_recon_loss: 20705775.8667; val_masked_gp_l1_reg_loss: 114600.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52351.0234; val_chrom_access_recon_loss: 6055050.8333; val_global_loss: 29820815.6000; val_optim_loss: 29820815.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9591; val_auprc_score: 0.9508; val_best_acc_score: 0.9019; val_best_f1_score: 0.9043; train_kl_reg_loss: 110554.6382; train_edge_recon_loss: 2752814.3492; train_gene_expr_recon_loss: 20669554.3817; train_masked_gp_l1_reg_loss: 115298.1884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51445.1538; train_chrom_access_recon_loss: 6021394.7519; train_global_loss: 29721061.6489; train_optim_loss: 29721061.6489; val_kl_reg_loss: 112971.1297; val_edge_recon_loss: 2773065.8333; val_gene_expr_recon_loss: 20708378.2667; val_masked_gp_l1_reg_loss: 116089.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50558.4414; val_chrom_access_recon_loss: 6054666.4000; val_global_loss: 29815729.8667; val_optim_loss: 29815729.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9360; val_auprc_score: 0.9231; val_best_acc_score: 0.8665; val_best_f1_score: 0.8734; train_kl_reg_loss: 154881.3405; train_edge_recon_loss: 3003641.5496; train_gene_expr_recon_loss: 23791839.7863; train_masked_gp_l1_reg_loss: 118643.9026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53470.3423; train_chrom_access_recon_loss: 6358423.5191; train_global_loss: 33480900.3053; train_optim_loss: 33480900.3053; val_kl_reg_loss: 8329.6827; val_edge_recon_loss: 3028361.8167; val_gene_expr_recon_loss: 24872674.6667; val_masked_gp_l1_reg_loss: 120589.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55179.6445; val_chrom_access_recon_loss: 6482787.4333; val_global_loss: 34567923.7333; val_optim_loss: 34567923.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9311; val_auprc_score: 0.9153; val_best_acc_score: 0.8653; val_best_f1_score: 0.8737; train_kl_reg_loss: 90530.7691; train_edge_recon_loss: 2850994.2672; train_gene_expr_recon_loss: 24817801.8321; train_masked_gp_l1_reg_loss: 118408.0490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53966.5813; train_chrom_access_recon_loss: 6403377.8435; train_global_loss: 34335079.5267; train_optim_loss: 34335079.5267; val_kl_reg_loss: 16575.3438; val_edge_recon_loss: 2824949.5167; val_gene_expr_recon_loss: 24537311.8667; val_masked_gp_l1_reg_loss: 115480.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52428.7773; val_chrom_access_recon_loss: 6399206.1333; val_global_loss: 33945951.2000; val_optim_loss: 33945951.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9355; val_auprc_score: 0.9194; val_best_acc_score: 0.8767; val_best_f1_score: 0.8836; train_kl_reg_loss: 57297.3861; train_edge_recon_loss: 2788477.7252; train_gene_expr_recon_loss: 24558305.5878; train_masked_gp_l1_reg_loss: 114842.6474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52206.7159; train_chrom_access_recon_loss: 6384735.0000; train_global_loss: 33955865.0840; train_optim_loss: 33955865.0840; val_kl_reg_loss: 17122.0445; val_edge_recon_loss: 2787305.0667; val_gene_expr_recon_loss: 24357407.6000; val_masked_gp_l1_reg_loss: 114481.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51999.4570; val_chrom_access_recon_loss: 6392105.8333; val_global_loss: 33720422.8000; val_optim_loss: 33720422.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9325; val_auprc_score: 0.9139; val_best_acc_score: 0.8724; val_best_f1_score: 0.8801; train_kl_reg_loss: 55723.9620; train_edge_recon_loss: 2775951.9103; train_gene_expr_recon_loss: 24502737.8168; train_masked_gp_l1_reg_loss: 114132.7426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51796.2959; train_chrom_access_recon_loss: 6375865.5344; train_global_loss: 33876208.1985; train_optim_loss: 33876208.1985; val_kl_reg_loss: 18064.1197; val_edge_recon_loss: 2808434.1333; val_gene_expr_recon_loss: 24479564.1333; val_masked_gp_l1_reg_loss: 113776.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51582.7578; val_chrom_access_recon_loss: 6405134.4333; val_global_loss: 33876554.8000; val_optim_loss: 33876554.8000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9339; val_auprc_score: 0.9190; val_best_acc_score: 0.8716; val_best_f1_score: 0.8775; train_kl_reg_loss: 54595.8161; train_edge_recon_loss: 2779945.7385; train_gene_expr_recon_loss: 24502962.7328; train_masked_gp_l1_reg_loss: 113412.9564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51371.0375; train_chrom_access_recon_loss: 6385188.4122; train_global_loss: 33887476.5191; train_optim_loss: 33887476.5191; val_kl_reg_loss: 18635.5060; val_edge_recon_loss: 2811920.7167; val_gene_expr_recon_loss: 24478202.6667; val_masked_gp_l1_reg_loss: 113028.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51153.5391; val_chrom_access_recon_loss: 6416103.4667; val_global_loss: 33889044.2667; val_optim_loss: 33889044.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9385; val_auprc_score: 0.9221; val_best_acc_score: 0.8779; val_best_f1_score: 0.8841; train_kl_reg_loss: 53101.7449; train_edge_recon_loss: 2776463.1260; train_gene_expr_recon_loss: 24450232.9618; train_masked_gp_l1_reg_loss: 112640.6282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50935.0454; train_chrom_access_recon_loss: 6375626.2977; train_global_loss: 33818999.6641; train_optim_loss: 33818999.6641; val_kl_reg_loss: 19314.3849; val_edge_recon_loss: 2770388.7667; val_gene_expr_recon_loss: 24488136.2667; val_masked_gp_l1_reg_loss: 112244.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50714.1406; val_chrom_access_recon_loss: 6419140.9333; val_global_loss: 33859938.6667; val_optim_loss: 33859938.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 55 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9606
val AUPRC score: 0.9521
val best accuracy score: 0.9018
val best F1 score: 0.9055
val target rna MSE score: 2.3920
val source rna MSE score: 133.0987
val target atac MSE score: 0.6085
val source atac MSE score: 5.6506
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
