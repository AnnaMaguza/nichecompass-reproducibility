[True]
Run timestamp: 01082023_065911_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8986; val_auprc_score: 0.9807; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 90438.6078; train_edge_recon_loss: 11734.2046; train_gene_expr_recon_loss: 5218271.5648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117706.5505; train_global_loss: 5438150.9537; train_optim_loss: 5438150.9537; val_kl_reg_loss: 104721.6211; val_edge_recon_loss: 11875.4040; val_gene_expr_recon_loss: 4404422.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108881.9531; val_global_loss: 4629901.4167; val_optim_loss: 4629901.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8780; val_auprc_score: 0.9771; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 94770.4886; train_edge_recon_loss: 11742.6953; train_gene_expr_recon_loss: 3929390.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101737.2031; train_global_loss: 4137640.4398; train_optim_loss: 4137640.4398; val_kl_reg_loss: 80151.5000; val_edge_recon_loss: 11768.0223; val_gene_expr_recon_loss: 3375423.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94858.7344; val_global_loss: 3562202.0833; val_optim_loss: 3562202.0833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8509; val_auprc_score: 0.9706; val_best_acc_score: 0.8644; val_best_f1_score: 0.9263; train_kl_reg_loss: 75678.0286; train_edge_recon_loss: 11775.4773; train_gene_expr_recon_loss: 3015972.3519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89029.9975; train_global_loss: 3192455.8380; train_optim_loss: 3192455.8380; val_kl_reg_loss: 66662.8607; val_edge_recon_loss: 11877.2752; val_gene_expr_recon_loss: 2798181.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83382.3828; val_global_loss: 2960104.2083; val_optim_loss: 2960104.2083
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8488; val_auprc_score: 0.9687; val_best_acc_score: 0.8790; val_best_f1_score: 0.9320; train_kl_reg_loss: 63118.1099; train_edge_recon_loss: 11830.0181; train_gene_expr_recon_loss: 2747808.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78798.9997; train_global_loss: 2901555.3935; train_optim_loss: 2901555.3935; val_kl_reg_loss: 55356.5664; val_edge_recon_loss: 11904.5096; val_gene_expr_recon_loss: 2710530.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74514.9219; val_global_loss: 2852306.0417; val_optim_loss: 2852306.0417
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8351; val_auprc_score: 0.9663; val_best_acc_score: 0.8678; val_best_f1_score: 0.9273; train_kl_reg_loss: 48037.1264; train_edge_recon_loss: 11652.7025; train_gene_expr_recon_loss: 2533762.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71327.5320; train_global_loss: 2664779.5417; train_optim_loss: 2664779.5417; val_kl_reg_loss: 36930.0208; val_edge_recon_loss: 11744.5540; val_gene_expr_recon_loss: 2255631.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68548.1562; val_global_loss: 2372854.2917; val_optim_loss: 2372854.2917
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8456; val_auprc_score: 0.9678; val_best_acc_score: 0.8789; val_best_f1_score: 0.9333; train_kl_reg_loss: 40922.7888; train_edge_recon_loss: 11700.5091; train_gene_expr_recon_loss: 2217117.3935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66829.1649; train_global_loss: 2336569.8519; train_optim_loss: 2336569.8519; val_kl_reg_loss: 38974.9564; val_edge_recon_loss: 11445.2573; val_gene_expr_recon_loss: 2186008.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65482.7695; val_global_loss: 2301911.1667; val_optim_loss: 2301911.1667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8589; val_auprc_score: 0.9718; val_best_acc_score: 0.8812; val_best_f1_score: 0.9350; train_kl_reg_loss: 39035.3908; train_edge_recon_loss: 11682.7301; train_gene_expr_recon_loss: 2180474.9769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64439.9220; train_global_loss: 2295633.0093; train_optim_loss: 2295633.0093; val_kl_reg_loss: 36151.7207; val_edge_recon_loss: 11298.6813; val_gene_expr_recon_loss: 2167543.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63355.3711; val_global_loss: 2278348.9167; val_optim_loss: 2278348.9167
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8667; val_auprc_score: 0.9713; val_best_acc_score: 0.8780; val_best_f1_score: 0.9325; train_kl_reg_loss: 36383.0532; train_edge_recon_loss: 11660.2844; train_gene_expr_recon_loss: 2155776.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62285.5337; train_global_loss: 2266105.2824; train_optim_loss: 2266105.2824; val_kl_reg_loss: 33985.6797; val_edge_recon_loss: 11680.2160; val_gene_expr_recon_loss: 2140277.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61165.7656; val_global_loss: 2247109.5417; val_optim_loss: 2247109.5417
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8715; val_auprc_score: 0.9724; val_best_acc_score: 0.8775; val_best_f1_score: 0.9319; train_kl_reg_loss: 34135.0106; train_edge_recon_loss: 11569.3789; train_gene_expr_recon_loss: 2132664.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60078.2600; train_global_loss: 2238447.3380; train_optim_loss: 2238447.3380; val_kl_reg_loss: 31996.9414; val_edge_recon_loss: 11819.6427; val_gene_expr_recon_loss: 2116234.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58944.2969; val_global_loss: 2218995.8333; val_optim_loss: 2218995.8333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8708; val_auprc_score: 0.9718; val_best_acc_score: 0.8824; val_best_f1_score: 0.9342; train_kl_reg_loss: 32205.5936; train_edge_recon_loss: 11758.4869; train_gene_expr_recon_loss: 2111659.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57850.6551; train_global_loss: 2213473.8935; train_optim_loss: 2213473.8935; val_kl_reg_loss: 30278.8864; val_edge_recon_loss: 11594.4362; val_gene_expr_recon_loss: 2098377.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56720.6562; val_global_loss: 2196971.8333; val_optim_loss: 2196971.8333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8796; val_auprc_score: 0.9740; val_best_acc_score: 0.8824; val_best_f1_score: 0.9338; train_kl_reg_loss: 30560.8839; train_edge_recon_loss: 11495.5502; train_gene_expr_recon_loss: 2092010.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55642.3214; train_global_loss: 2189709.0278; train_optim_loss: 2189709.0278; val_kl_reg_loss: 28799.0179; val_edge_recon_loss: 11696.9943; val_gene_expr_recon_loss: 2077177.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54534.0391; val_global_loss: 2172208.0000; val_optim_loss: 2172208.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8848; val_auprc_score: 0.9754; val_best_acc_score: 0.8842; val_best_f1_score: 0.9345; train_kl_reg_loss: 29157.6585; train_edge_recon_loss: 11617.9429; train_gene_expr_recon_loss: 2073117.7338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53489.4194; train_global_loss: 2167382.7361; train_optim_loss: 2167382.7361; val_kl_reg_loss: 27432.7347; val_edge_recon_loss: 11566.7192; val_gene_expr_recon_loss: 2062081.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52419.5938; val_global_loss: 2153500.7083; val_optim_loss: 2153500.7083
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8933; val_auprc_score: 0.9769; val_best_acc_score: 0.8873; val_best_f1_score: 0.9355; train_kl_reg_loss: 27891.0699; train_edge_recon_loss: 11489.9240; train_gene_expr_recon_loss: 2054557.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51417.8734; train_global_loss: 2145355.8750; train_optim_loss: 2145355.8750; val_kl_reg_loss: 26471.3216; val_edge_recon_loss: 11850.0046; val_gene_expr_recon_loss: 2043776.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50393.4180; val_global_loss: 2132491.1250; val_optim_loss: 2132491.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8980; val_auprc_score: 0.9777; val_best_acc_score: 0.8887; val_best_f1_score: 0.9362; train_kl_reg_loss: 26788.1907; train_edge_recon_loss: 11424.8137; train_gene_expr_recon_loss: 2036670.1620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49433.3560; train_global_loss: 2124316.5417; train_optim_loss: 2124316.5417; val_kl_reg_loss: 25326.3135; val_edge_recon_loss: 11706.9302; val_gene_expr_recon_loss: 2024490.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48451.8828; val_global_loss: 2109975.8333; val_optim_loss: 2109975.8333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9030; val_auprc_score: 0.9793; val_best_acc_score: 0.8948; val_best_f1_score: 0.9393; train_kl_reg_loss: 25746.6732; train_edge_recon_loss: 11354.4247; train_gene_expr_recon_loss: 2019825.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47532.8640; train_global_loss: 2104459.0972; train_optim_loss: 2104459.0972; val_kl_reg_loss: 24470.6576; val_edge_recon_loss: 11534.7563; val_gene_expr_recon_loss: 2006783.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46598.5625; val_global_loss: 2089387.3750; val_optim_loss: 2089387.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9093; val_auprc_score: 0.9808; val_best_acc_score: 0.8950; val_best_f1_score: 0.9397; train_kl_reg_loss: 24821.9154; train_edge_recon_loss: 11305.2772; train_gene_expr_recon_loss: 2003697.2986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45722.8710; train_global_loss: 2085547.3634; train_optim_loss: 2085547.3634; val_kl_reg_loss: 23719.0088; val_edge_recon_loss: 11636.4212; val_gene_expr_recon_loss: 1990960.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44826.9062; val_global_loss: 2071142.9583; val_optim_loss: 2071142.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9067; val_auprc_score: 0.9801; val_best_acc_score: 0.8958; val_best_f1_score: 0.9396; train_kl_reg_loss: 23986.8653; train_edge_recon_loss: 11378.9136; train_gene_expr_recon_loss: 1988130.1991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43991.9647; train_global_loss: 2067487.9329; train_optim_loss: 2067487.9329; val_kl_reg_loss: 22774.7311; val_edge_recon_loss: 11475.6219; val_gene_expr_recon_loss: 1977210.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43137.2461; val_global_loss: 2054597.7292; val_optim_loss: 2054597.7292
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9084; val_auprc_score: 0.9815; val_best_acc_score: 0.8983; val_best_f1_score: 0.9423; train_kl_reg_loss: 23203.2776; train_edge_recon_loss: 11432.2641; train_gene_expr_recon_loss: 1973223.8171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42342.2794; train_global_loss: 2050201.6343; train_optim_loss: 2050201.6343; val_kl_reg_loss: 22028.4668; val_edge_recon_loss: 11260.5304; val_gene_expr_recon_loss: 1960237.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41527.8750; val_global_loss: 2035054.7083; val_optim_loss: 2035054.7083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9139; val_auprc_score: 0.9816; val_best_acc_score: 0.8972; val_best_f1_score: 0.9414; train_kl_reg_loss: 22488.7439; train_edge_recon_loss: 11305.7842; train_gene_expr_recon_loss: 1959078.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40768.5611; train_global_loss: 2033642.0625; train_optim_loss: 2033642.0625; val_kl_reg_loss: 21315.9922; val_edge_recon_loss: 11497.7202; val_gene_expr_recon_loss: 1949478.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39996.7188; val_global_loss: 2022289.2083; val_optim_loss: 2022289.2083
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9146; val_auprc_score: 0.9826; val_best_acc_score: 0.9004; val_best_f1_score: 0.9433; train_kl_reg_loss: 21830.9142; train_edge_recon_loss: 11297.1624; train_gene_expr_recon_loss: 1945476.7731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39275.8001; train_global_loss: 2017880.6458; train_optim_loss: 2017880.6458; val_kl_reg_loss: 20873.7725; val_edge_recon_loss: 11158.0664; val_gene_expr_recon_loss: 1935719.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38538.4141; val_global_loss: 2006289.7083; val_optim_loss: 2006289.7083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9164; val_auprc_score: 0.9823; val_best_acc_score: 0.8989; val_best_f1_score: 0.9418; train_kl_reg_loss: 21235.7441; train_edge_recon_loss: 11202.6936; train_gene_expr_recon_loss: 1932022.5394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37850.7141; train_global_loss: 2002311.6921; train_optim_loss: 2002311.6921; val_kl_reg_loss: 20218.5420; val_edge_recon_loss: 11772.6147; val_gene_expr_recon_loss: 1920668.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37148.2305; val_global_loss: 1989807.5208; val_optim_loss: 1989807.5208
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9182; val_auprc_score: 0.9827; val_best_acc_score: 0.9013; val_best_f1_score: 0.9432; train_kl_reg_loss: 20677.1827; train_edge_recon_loss: 11397.3005; train_gene_expr_recon_loss: 1919179.1644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36491.7148; train_global_loss: 1987745.3542; train_optim_loss: 1987745.3542; val_kl_reg_loss: 19686.2992; val_edge_recon_loss: 11494.8389; val_gene_expr_recon_loss: 1907841.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35823.0781; val_global_loss: 1974846.2083; val_optim_loss: 1974846.2083
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9236; val_auprc_score: 0.9848; val_best_acc_score: 0.9077; val_best_f1_score: 0.9466; train_kl_reg_loss: 20164.9616; train_edge_recon_loss: 11264.3088; train_gene_expr_recon_loss: 1906616.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35194.1738; train_global_loss: 1973239.8287; train_optim_loss: 1973239.8287; val_kl_reg_loss: 19135.9801; val_edge_recon_loss: 11327.4199; val_gene_expr_recon_loss: 1899657.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34552.8633; val_global_loss: 1964673.9792; val_optim_loss: 1964673.9792
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9214; val_auprc_score: 0.9846; val_best_acc_score: 0.9045; val_best_f1_score: 0.9447; train_kl_reg_loss: 19681.6576; train_edge_recon_loss: 11254.6131; train_gene_expr_recon_loss: 1895081.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33947.9488; train_global_loss: 1959965.9815; train_optim_loss: 1959965.9815; val_kl_reg_loss: 18780.9570; val_edge_recon_loss: 11316.9318; val_gene_expr_recon_loss: 1885859.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33329.4961; val_global_loss: 1949286.4792; val_optim_loss: 1949286.4792
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9242; val_auprc_score: 0.9853; val_best_acc_score: 0.9052; val_best_f1_score: 0.9457; train_kl_reg_loss: 19230.9015; train_edge_recon_loss: 11329.8126; train_gene_expr_recon_loss: 1883684.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32753.4377; train_global_loss: 1946999.1204; train_optim_loss: 1946999.1204; val_kl_reg_loss: 18378.5824; val_edge_recon_loss: 10948.7653; val_gene_expr_recon_loss: 1874389.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32158.7793; val_global_loss: 1935875.8958; val_optim_loss: 1935875.8958
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8954; val_auprc_score: 0.9781; val_best_acc_score: 0.8877; val_best_f1_score: 0.9361; train_kl_reg_loss: 16326.1656; train_edge_recon_loss: 11358.7750; train_gene_expr_recon_loss: 3417296.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31064.8104; train_global_loss: 3476046.6065; train_optim_loss: 3476046.6065; val_kl_reg_loss: 17517.2301; val_edge_recon_loss: 11609.4712; val_gene_expr_recon_loss: 2909357.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29805.3281; val_global_loss: 2968289.2917; val_optim_loss: 2968289.2917
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9023; val_auprc_score: 0.9803; val_best_acc_score: 0.8937; val_best_f1_score: 0.9399; train_kl_reg_loss: 18059.5234; train_edge_recon_loss: 11562.3452; train_gene_expr_recon_loss: 2670457.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28639.3057; train_global_loss: 2728718.3102; train_optim_loss: 2728718.3102; val_kl_reg_loss: 16711.1852; val_edge_recon_loss: 11394.3053; val_gene_expr_recon_loss: 2469944.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27469.3906; val_global_loss: 2525519.1250; val_optim_loss: 2525519.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9104; val_auprc_score: 0.9814; val_best_acc_score: 0.8966; val_best_f1_score: 0.9408; train_kl_reg_loss: 16956.1725; train_edge_recon_loss: 11421.3556; train_gene_expr_recon_loss: 2352713.4120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26414.2708; train_global_loss: 2407505.2500; train_optim_loss: 2407505.2500; val_kl_reg_loss: 15433.0005; val_edge_recon_loss: 11517.7842; val_gene_expr_recon_loss: 2245367.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25355.3105; val_global_loss: 2297674.0000; val_optim_loss: 2297674.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9109; val_auprc_score: 0.9816; val_best_acc_score: 0.8967; val_best_f1_score: 0.9411; train_kl_reg_loss: 15679.7969; train_edge_recon_loss: 11218.2185; train_gene_expr_recon_loss: 2185738.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24398.3022; train_global_loss: 2237035.0278; train_optim_loss: 2237035.0278; val_kl_reg_loss: 14300.6367; val_edge_recon_loss: 11572.1706; val_gene_expr_recon_loss: 2123856.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23435.9141; val_global_loss: 2173165.3333; val_optim_loss: 2173165.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9130; val_auprc_score: 0.9825; val_best_acc_score: 0.8974; val_best_f1_score: 0.9415; train_kl_reg_loss: 15023.0144; train_edge_recon_loss: 11160.1295; train_gene_expr_recon_loss: 2123671.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23304.1735; train_global_loss: 2173158.6296; train_optim_loss: 2173158.6296; val_kl_reg_loss: 14243.4587; val_edge_recon_loss: 11392.2337; val_gene_expr_recon_loss: 2116409.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23200.2324; val_global_loss: 2165245.3333; val_optim_loss: 2165245.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9116; val_auprc_score: 0.9819; val_best_acc_score: 0.8972; val_best_f1_score: 0.9415; train_kl_reg_loss: 14896.4060; train_edge_recon_loss: 11113.6531; train_gene_expr_recon_loss: 2114058.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23107.5350; train_global_loss: 2163176.0370; train_optim_loss: 2163176.0370; val_kl_reg_loss: 14048.9712; val_edge_recon_loss: 11536.9569; val_gene_expr_recon_loss: 2106161.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23011.0352; val_global_loss: 2154758.0833; val_optim_loss: 2154758.0833
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9156; val_auprc_score: 0.9826; val_best_acc_score: 0.8984; val_best_f1_score: 0.9422; train_kl_reg_loss: 14781.1657; train_edge_recon_loss: 11145.8150; train_gene_expr_recon_loss: 2105997.7986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22916.9152; train_global_loss: 2154841.6806; train_optim_loss: 2154841.6806; val_kl_reg_loss: 13980.8363; val_edge_recon_loss: 11372.9826; val_gene_expr_recon_loss: 2095943.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22818.7578; val_global_loss: 2144116.0833; val_optim_loss: 2144116.0833
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9137; val_auprc_score: 0.9820; val_best_acc_score: 0.8998; val_best_f1_score: 0.9429; train_kl_reg_loss: 14669.3203; train_edge_recon_loss: 11313.8112; train_gene_expr_recon_loss: 2098112.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22722.8921; train_global_loss: 2146818.9583; train_optim_loss: 2146818.9583; val_kl_reg_loss: 13848.0924; val_edge_recon_loss: 11408.3604; val_gene_expr_recon_loss: 2090696.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22622.8008; val_global_loss: 2138575.6250; val_optim_loss: 2138575.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9170
val AUPRC score: 0.9824
val best accuracy score: 0.9018
val best F1 score: 0.9442
val target rna MSE score: 22.4258
val source rna MSE score: 144.2989
Val cat covariate0 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
