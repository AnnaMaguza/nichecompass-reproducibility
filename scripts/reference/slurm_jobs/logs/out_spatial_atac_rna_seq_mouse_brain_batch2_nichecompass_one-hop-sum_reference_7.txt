[True]
Run timestamp: 10082023_162714_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7776; val_auprc_score: 0.8003; val_best_acc_score: 0.5655; val_best_f1_score: 0.6908; train_kl_reg_loss: 161015.4020; train_edge_recon_loss: 3680520.9580; train_gene_expr_recon_loss: 28432785.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 26012407.2061; train_global_loss: 58286728.7939; train_optim_loss: 58286728.7939; val_kl_reg_loss: 265196.0594; val_edge_recon_loss: 4061196.4667; val_gene_expr_recon_loss: 23060660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23195729.2000; val_global_loss: 50582781.8667; val_optim_loss: 50582781.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8714; val_auprc_score: 0.8732; val_best_acc_score: 0.7590; val_best_f1_score: 0.7924; train_kl_reg_loss: 217409.3172; train_edge_recon_loss: 3589301.3282; train_gene_expr_recon_loss: 22605291.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23087413.5725; train_global_loss: 49499416.3359; train_optim_loss: 49499416.3359; val_kl_reg_loss: 182560.2677; val_edge_recon_loss: 3946304.0167; val_gene_expr_recon_loss: 22280913.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22954411.0667; val_global_loss: 49364188.2667; val_optim_loss: 49364188.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8837; val_auprc_score: 0.8761; val_best_acc_score: 0.7944; val_best_f1_score: 0.8070; train_kl_reg_loss: 182008.2370; train_edge_recon_loss: 3289888.6813; train_gene_expr_recon_loss: 22200778.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22893904.1679; train_global_loss: 48566580.0611; train_optim_loss: 48566580.0611; val_kl_reg_loss: 206676.0771; val_edge_recon_loss: 3067937.7833; val_gene_expr_recon_loss: 22106222.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22749190.4000; val_global_loss: 48130026.6667; val_optim_loss: 48130026.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8925; val_auprc_score: 0.8794; val_best_acc_score: 0.8026; val_best_f1_score: 0.8226; train_kl_reg_loss: 199503.2037; train_edge_recon_loss: 3012289.7767; train_gene_expr_recon_loss: 21988043.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22741305.5573; train_global_loss: 47941141.8931; train_optim_loss: 47941141.8931; val_kl_reg_loss: 190961.1427; val_edge_recon_loss: 2986268.2833; val_gene_expr_recon_loss: 21907806.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22731663.6000; val_global_loss: 47816699.2000; val_optim_loss: 47816699.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9092; val_auprc_score: 0.8967; val_best_acc_score: 0.8235; val_best_f1_score: 0.8400; train_kl_reg_loss: 183745.2250; train_edge_recon_loss: 2944419.8702; train_gene_expr_recon_loss: 21888298.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22691970.2137; train_global_loss: 47708433.8321; train_optim_loss: 47708433.8321; val_kl_reg_loss: 172770.0125; val_edge_recon_loss: 2948353.2833; val_gene_expr_recon_loss: 21787073.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22677804.1333; val_global_loss: 47586000.2667; val_optim_loss: 47586000.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9316; val_auprc_score: 0.9204; val_best_acc_score: 0.8587; val_best_f1_score: 0.8658; train_kl_reg_loss: 174177.7872; train_edge_recon_loss: 2904080.7366; train_gene_expr_recon_loss: 21705084.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22524713.3435; train_global_loss: 47308056.3359; train_optim_loss: 47308056.3359; val_kl_reg_loss: 172056.2896; val_edge_recon_loss: 2888182.7667; val_gene_expr_recon_loss: 21677655.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22571833.6000; val_global_loss: 47309728.2667; val_optim_loss: 47309728.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9438; val_auprc_score: 0.9323; val_best_acc_score: 0.8791; val_best_f1_score: 0.8853; train_kl_reg_loss: 166710.5143; train_edge_recon_loss: 2860736.9294; train_gene_expr_recon_loss: 21624594.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22463951.3282; train_global_loss: 47115993.1603; train_optim_loss: 47115993.1603; val_kl_reg_loss: 161038.3458; val_edge_recon_loss: 2862910.9667; val_gene_expr_recon_loss: 21512279.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22345894.0000; val_global_loss: 46882122.6667; val_optim_loss: 46882122.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9434; val_auprc_score: 0.9301; val_best_acc_score: 0.8789; val_best_f1_score: 0.8865; train_kl_reg_loss: 163942.2563; train_edge_recon_loss: 2822788.4008; train_gene_expr_recon_loss: 21474188.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22311624.6870; train_global_loss: 46772544.3664; train_optim_loss: 46772544.3664; val_kl_reg_loss: 155858.1073; val_edge_recon_loss: 2842113.1333; val_gene_expr_recon_loss: 21435247.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22271730.2667; val_global_loss: 46704948.2667; val_optim_loss: 46704948.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9459; val_auprc_score: 0.9329; val_best_acc_score: 0.8841; val_best_f1_score: 0.8899; train_kl_reg_loss: 156112.4894; train_edge_recon_loss: 2811523.7977; train_gene_expr_recon_loss: 21386744.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22231844.1527; train_global_loss: 46586225.1603; train_optim_loss: 46586225.1603; val_kl_reg_loss: 158331.6396; val_edge_recon_loss: 2820966.6000; val_gene_expr_recon_loss: 21338863.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22088185.3333; val_global_loss: 46406346.9333; val_optim_loss: 46406346.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9513; val_auprc_score: 0.9381; val_best_acc_score: 0.8894; val_best_f1_score: 0.8968; train_kl_reg_loss: 152022.0466; train_edge_recon_loss: 2799262.8053; train_gene_expr_recon_loss: 21297996.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22153571.8168; train_global_loss: 46402853.6183; train_optim_loss: 46402853.6183; val_kl_reg_loss: 147378.1583; val_edge_recon_loss: 2802660.2333; val_gene_expr_recon_loss: 21175085.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22024610.6667; val_global_loss: 46149734.9333; val_optim_loss: 46149734.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9465; val_best_acc_score: 0.8941; val_best_f1_score: 0.8998; train_kl_reg_loss: 145987.9466; train_edge_recon_loss: 2785574.6813; train_gene_expr_recon_loss: 21197777.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22033078.1221; train_global_loss: 46162418.3817; train_optim_loss: 46162418.3817; val_kl_reg_loss: 145174.4958; val_edge_recon_loss: 2811056.1667; val_gene_expr_recon_loss: 21143619.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22030469.0667; val_global_loss: 46130319.2000; val_optim_loss: 46130319.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9625; val_auprc_score: 0.9555; val_best_acc_score: 0.9053; val_best_f1_score: 0.9086; train_kl_reg_loss: 141017.9897; train_edge_recon_loss: 2775973.7691; train_gene_expr_recon_loss: 21138492.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21990036.4427; train_global_loss: 46045520.7634; train_optim_loss: 46045520.7634; val_kl_reg_loss: 138847.4760; val_edge_recon_loss: 2770549.3333; val_gene_expr_recon_loss: 21177089.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22054466.4000; val_global_loss: 46140952.5333; val_optim_loss: 46140952.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9633; val_auprc_score: 0.9555; val_best_acc_score: 0.9049; val_best_f1_score: 0.9100; train_kl_reg_loss: 136435.1560; train_edge_recon_loss: 2767250.1908; train_gene_expr_recon_loss: 21043819.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21884578.1679; train_global_loss: 45832082.9924; train_optim_loss: 45832082.9924; val_kl_reg_loss: 135096.4698; val_edge_recon_loss: 2765243.1000; val_gene_expr_recon_loss: 21116503.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22052700.2667; val_global_loss: 46069542.9333; val_optim_loss: 46069542.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9631; val_auprc_score: 0.9526; val_best_acc_score: 0.9074; val_best_f1_score: 0.9112; train_kl_reg_loss: 132674.0262; train_edge_recon_loss: 2760261.0229; train_gene_expr_recon_loss: 20977629.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21803428.4885; train_global_loss: 45673992.7939; train_optim_loss: 45673992.7939; val_kl_reg_loss: 131588.8130; val_edge_recon_loss: 2776923.2667; val_gene_expr_recon_loss: 20916002.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21773648.4000; val_global_loss: 45598162.9333; val_optim_loss: 45598162.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9693; val_auprc_score: 0.9610; val_best_acc_score: 0.9167; val_best_f1_score: 0.9207; train_kl_reg_loss: 128578.7287; train_edge_recon_loss: 2755831.0649; train_gene_expr_recon_loss: 20929051.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21772560.5802; train_global_loss: 45586021.8015; train_optim_loss: 45586021.8015; val_kl_reg_loss: 125528.2516; val_edge_recon_loss: 2742015.4833; val_gene_expr_recon_loss: 20920317.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21749451.7333; val_global_loss: 45537313.0667; val_optim_loss: 45537313.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9670; val_auprc_score: 0.9586; val_best_acc_score: 0.9142; val_best_f1_score: 0.9182; train_kl_reg_loss: 125315.8309; train_edge_recon_loss: 2747150.7538; train_gene_expr_recon_loss: 20875438.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21731425.8779; train_global_loss: 45479330.5954; train_optim_loss: 45479330.5954; val_kl_reg_loss: 126313.7224; val_edge_recon_loss: 2752253.8167; val_gene_expr_recon_loss: 20906978.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21774379.3333; val_global_loss: 45559924.8000; val_optim_loss: 45559924.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9705; val_auprc_score: 0.9637; val_best_acc_score: 0.9188; val_best_f1_score: 0.9213; train_kl_reg_loss: 121584.4146; train_edge_recon_loss: 2751238.9198; train_gene_expr_recon_loss: 20815556.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21667296.7634; train_global_loss: 45355676.0916; train_optim_loss: 45355676.0916; val_kl_reg_loss: 120468.2141; val_edge_recon_loss: 2755686.0833; val_gene_expr_recon_loss: 20861055.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21695539.8667; val_global_loss: 45432749.0667; val_optim_loss: 45432749.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9730; val_auprc_score: 0.9661; val_best_acc_score: 0.9217; val_best_f1_score: 0.9248; train_kl_reg_loss: 119800.1603; train_edge_recon_loss: 2742116.3989; train_gene_expr_recon_loss: 20782143.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21636973.4046; train_global_loss: 45281033.4046; train_optim_loss: 45281033.4046; val_kl_reg_loss: 119142.3578; val_edge_recon_loss: 2752440.3667; val_gene_expr_recon_loss: 20792820.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21672534.0000; val_global_loss: 45336937.0667; val_optim_loss: 45336937.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9764; val_auprc_score: 0.9709; val_best_acc_score: 0.9283; val_best_f1_score: 0.9314; train_kl_reg_loss: 117070.6950; train_edge_recon_loss: 2730838.1202; train_gene_expr_recon_loss: 20712393.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21569895.5573; train_global_loss: 45130197.5573; train_optim_loss: 45130197.5573; val_kl_reg_loss: 114295.2365; val_edge_recon_loss: 2732613.5833; val_gene_expr_recon_loss: 20742464.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21615024.6667; val_global_loss: 45204398.1333; val_optim_loss: 45204398.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9758; val_auprc_score: 0.9703; val_best_acc_score: 0.9287; val_best_f1_score: 0.9313; train_kl_reg_loss: 116245.8730; train_edge_recon_loss: 2723073.6469; train_gene_expr_recon_loss: 20653732.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21513577.9542; train_global_loss: 45006629.8015; train_optim_loss: 45006629.8015; val_kl_reg_loss: 113761.2505; val_edge_recon_loss: 2743685.9333; val_gene_expr_recon_loss: 20764253.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21657758.1333; val_global_loss: 45279458.9333; val_optim_loss: 45279458.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9786; val_auprc_score: 0.9746; val_best_acc_score: 0.9326; val_best_f1_score: 0.9340; train_kl_reg_loss: 113595.8399; train_edge_recon_loss: 2722775.2805; train_gene_expr_recon_loss: 20640634.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21527372.8397; train_global_loss: 45004378.1374; train_optim_loss: 45004378.1374; val_kl_reg_loss: 114279.8703; val_edge_recon_loss: 2737371.9667; val_gene_expr_recon_loss: 20707291.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21539299.7333; val_global_loss: 45098242.9333; val_optim_loss: 45098242.9333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9799; val_auprc_score: 0.9758; val_best_acc_score: 0.9365; val_best_f1_score: 0.9380; train_kl_reg_loss: 111724.5886; train_edge_recon_loss: 2721822.4885; train_gene_expr_recon_loss: 20616852.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21486216.3359; train_global_loss: 44936615.7863; train_optim_loss: 44936615.7863; val_kl_reg_loss: 109771.7130; val_edge_recon_loss: 2725374.0333; val_gene_expr_recon_loss: 20643991.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21554601.0667; val_global_loss: 45033738.1333; val_optim_loss: 45033738.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9782; val_auprc_score: 0.9725; val_best_acc_score: 0.9324; val_best_f1_score: 0.9351; train_kl_reg_loss: 111668.2700; train_edge_recon_loss: 2716282.2634; train_gene_expr_recon_loss: 20555716.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21430159.9847; train_global_loss: 44813827.3588; train_optim_loss: 44813827.3588; val_kl_reg_loss: 107109.6068; val_edge_recon_loss: 2720003.8833; val_gene_expr_recon_loss: 20601264.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21422753.8667; val_global_loss: 44851131.4667; val_optim_loss: 44851131.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9794; val_auprc_score: 0.9745; val_best_acc_score: 0.9376; val_best_f1_score: 0.9398; train_kl_reg_loss: 109443.9680; train_edge_recon_loss: 2713164.9752; train_gene_expr_recon_loss: 20523130.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21427648.5344; train_global_loss: 44773388.5191; train_optim_loss: 44773388.5191; val_kl_reg_loss: 107737.0984; val_edge_recon_loss: 2719101.3667; val_gene_expr_recon_loss: 20603336.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21531594.5333; val_global_loss: 44961770.1333; val_optim_loss: 44961770.1333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9803; val_auprc_score: 0.9769; val_best_acc_score: 0.9357; val_best_f1_score: 0.9376; train_kl_reg_loss: 107924.1879; train_edge_recon_loss: 2708649.2328; train_gene_expr_recon_loss: 20475239.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21385490.7328; train_global_loss: 44677303.9389; train_optim_loss: 44677303.9389; val_kl_reg_loss: 104404.7635; val_edge_recon_loss: 2711418.0167; val_gene_expr_recon_loss: 20479419.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21321230.4000; val_global_loss: 44616472.2667; val_optim_loss: 44616472.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9761; val_auprc_score: 0.9721; val_best_acc_score: 0.9256; val_best_f1_score: 0.9287; train_kl_reg_loss: 119573.0414; train_edge_recon_loss: 2787130.0630; train_gene_expr_recon_loss: 22254131.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21839532.4275; train_global_loss: 47000366.6565; train_optim_loss: 47000366.6565; val_kl_reg_loss: 25790.7801; val_edge_recon_loss: 2812456.7500; val_gene_expr_recon_loss: 22724095.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21883810.8000; val_global_loss: 47446153.0667; val_optim_loss: 47446153.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9633; val_auprc_score: 0.9513; val_best_acc_score: 0.9095; val_best_f1_score: 0.9135; train_kl_reg_loss: 131891.5250; train_edge_recon_loss: 2797185.4179; train_gene_expr_recon_loss: 22990036.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21972725.0229; train_global_loss: 47891838.1679; train_optim_loss: 47891838.1679; val_kl_reg_loss: 27387.3764; val_edge_recon_loss: 2741308.2667; val_gene_expr_recon_loss: 22967319.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22005777.6000; val_global_loss: 47741792.2667; val_optim_loss: 47741792.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9611; val_auprc_score: 0.9485; val_best_acc_score: 0.9091; val_best_f1_score: 0.9125; train_kl_reg_loss: 91862.1431; train_edge_recon_loss: 2737897.2805; train_gene_expr_recon_loss: 22739667.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21893584.7786; train_global_loss: 47463011.9695; train_optim_loss: 47463011.9695; val_kl_reg_loss: 39451.7633; val_edge_recon_loss: 2716194.5333; val_gene_expr_recon_loss: 22603049.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21915327.6000; val_global_loss: 47274023.2000; val_optim_loss: 47274023.2000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9616; val_auprc_score: 0.9493; val_best_acc_score: 0.9072; val_best_f1_score: 0.9105; train_kl_reg_loss: 71191.1639; train_edge_recon_loss: 2712673.8492; train_gene_expr_recon_loss: 22512198.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21868980.6260; train_global_loss: 47165044.4275; train_optim_loss: 47165044.4275; val_kl_reg_loss: 44852.1849; val_edge_recon_loss: 2714957.6667; val_gene_expr_recon_loss: 22471993.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21848630.1333; val_global_loss: 47080434.1333; val_optim_loss: 47080434.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9621; val_auprc_score: 0.9496; val_best_acc_score: 0.9085; val_best_f1_score: 0.9132; train_kl_reg_loss: 67011.2360; train_edge_recon_loss: 2701783.7004; train_gene_expr_recon_loss: 22421077.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21850932.1985; train_global_loss: 47040804.9466; train_optim_loss: 47040804.9466; val_kl_reg_loss: 45466.5414; val_edge_recon_loss: 2710627.0167; val_gene_expr_recon_loss: 22374966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21894186.6667; val_global_loss: 47025245.3333; val_optim_loss: 47025245.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9627; val_auprc_score: 0.9494; val_best_acc_score: 0.9115; val_best_f1_score: 0.9152; train_kl_reg_loss: 66370.0253; train_edge_recon_loss: 2698474.3263; train_gene_expr_recon_loss: 22400127.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21843682.4122; train_global_loss: 47008654.2901; train_optim_loss: 47008654.2901; val_kl_reg_loss: 46289.4005; val_edge_recon_loss: 2702894.4333; val_gene_expr_recon_loss: 22500823.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22011592.0000; val_global_loss: 47261598.6667; val_optim_loss: 47261598.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9639; val_auprc_score: 0.9531; val_best_acc_score: 0.9108; val_best_f1_score: 0.9142; train_kl_reg_loss: 65639.3626; train_edge_recon_loss: 2698993.6584; train_gene_expr_recon_loss: 22385706.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21831917.1145; train_global_loss: 46982256.4275; train_optim_loss: 46982256.4275; val_kl_reg_loss: 46261.7234; val_edge_recon_loss: 2705012.7667; val_gene_expr_recon_loss: 22410646.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21922963.8667; val_global_loss: 47084884.8000; val_optim_loss: 47084884.8000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9652; val_auprc_score: 0.9506; val_best_acc_score: 0.9181; val_best_f1_score: 0.9204; train_kl_reg_loss: 65036.2589; train_edge_recon_loss: 2697388.0668; train_gene_expr_recon_loss: 22361053.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21818410.9771; train_global_loss: 46941888.9160; train_optim_loss: 46941888.9160; val_kl_reg_loss: 47124.4885; val_edge_recon_loss: 2687679.7833; val_gene_expr_recon_loss: 22424748.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21958638.1333; val_global_loss: 47118191.4667; val_optim_loss: 47118191.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 26 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9791
val AUPRC score: 0.9754
val best accuracy score: 0.9312
val best F1 score: 0.9328
val target rna MSE score: 1.2778
val source rna MSE score: 67.7434
val target atac MSE score: 0.1272
val source atac MSE score: 0.9694
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
