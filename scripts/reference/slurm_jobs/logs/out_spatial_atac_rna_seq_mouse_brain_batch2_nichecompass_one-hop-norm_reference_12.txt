[True]
Run timestamp: 26072023_010914_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8889; val_auprc_score: 0.9042; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8131.9697; train_edge_recon_loss: 350276.6875; train_gene_expr_recon_loss: 314081.7951; train_masked_gp_l1_reg_loss: 1654.8185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 11013680.3333; train_global_loss: 11687825.6667; train_optim_loss: 11687825.6667; val_kl_reg_loss: 14148.7109; val_edge_recon_loss: 406576.3125; val_gene_expr_recon_loss: 300372.0312; val_masked_gp_l1_reg_loss: 1532.9919; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10759849.0000; val_global_loss: 11482479.0000; val_optim_loss: 11482479.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8887; val_auprc_score: 0.8989; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13183.8228; train_edge_recon_loss: 357733.7847; train_gene_expr_recon_loss: 297387.0833; train_masked_gp_l1_reg_loss: 1562.1223; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10629038.2222; train_global_loss: 11298904.8889; train_optim_loss: 11298904.8889; val_kl_reg_loss: 18738.0234; val_edge_recon_loss: 406582.3125; val_gene_expr_recon_loss: 281798.7500; val_masked_gp_l1_reg_loss: 1631.0947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10584582.0000; val_global_loss: 11293332.0000; val_optim_loss: 11293332.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8743; val_auprc_score: 0.8786; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 23313.5495; train_edge_recon_loss: 364575.7743; train_gene_expr_recon_loss: 279285.7292; train_masked_gp_l1_reg_loss: 1718.8914; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10411122.5556; train_global_loss: 11080016.4444; train_optim_loss: 11080016.4444; val_kl_reg_loss: 27796.8047; val_edge_recon_loss: 406582.9062; val_gene_expr_recon_loss: 262921.0000; val_masked_gp_l1_reg_loss: 1825.4943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10382260.0000; val_global_loss: 11081386.0000; val_optim_loss: 11081386.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8652; val_auprc_score: 0.8655; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 30329.9603; train_edge_recon_loss: 371621.3993; train_gene_expr_recon_loss: 260562.4931; train_masked_gp_l1_reg_loss: 1880.3197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10267390.0000; train_global_loss: 10931784.3333; train_optim_loss: 10931784.3333; val_kl_reg_loss: 32677.2305; val_edge_recon_loss: 406572.5000; val_gene_expr_recon_loss: 249748.8281; val_masked_gp_l1_reg_loss: 1931.7881; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10244096.0000; val_global_loss: 10935026.0000; val_optim_loss: 10935026.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8561; val_auprc_score: 0.8613; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 37359.0842; train_edge_recon_loss: 375875.3264; train_gene_expr_recon_loss: 247009.6510; train_masked_gp_l1_reg_loss: 1954.9935; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10068402.3333; train_global_loss: 10730601.4444; train_optim_loss: 10730601.4444; val_kl_reg_loss: 40853.8086; val_edge_recon_loss: 406564.9688; val_gene_expr_recon_loss: 238809.8438; val_masked_gp_l1_reg_loss: 1967.2638; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10099742.0000; val_global_loss: 10787938.0000; val_optim_loss: 10787938.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8654; val_auprc_score: 0.8644; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 44009.9935; train_edge_recon_loss: 380477.6285; train_gene_expr_recon_loss: 237861.4149; train_masked_gp_l1_reg_loss: 1956.2216; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9891107.1111; train_global_loss: 10555412.3333; train_optim_loss: 10555412.3333; val_kl_reg_loss: 49756.7969; val_edge_recon_loss: 406543.9375; val_gene_expr_recon_loss: 233064.8281; val_masked_gp_l1_reg_loss: 1931.4508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10012559.0000; val_global_loss: 10703856.0000; val_optim_loss: 10703856.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8754; val_auprc_score: 0.8690; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 51042.2691; train_edge_recon_loss: 382113.2882; train_gene_expr_recon_loss: 233695.6372; train_masked_gp_l1_reg_loss: 1906.8653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890959.7778; train_global_loss: 10559717.7778; train_optim_loss: 10559717.7778; val_kl_reg_loss: 48736.4062; val_edge_recon_loss: 406483.8438; val_gene_expr_recon_loss: 227248.7344; val_masked_gp_l1_reg_loss: 1871.8120; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9955178.0000; val_global_loss: 10639519.0000; val_optim_loss: 10639519.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8679; val_auprc_score: 0.8582; val_best_acc_score: 0.5288; val_best_f1_score: 0.6794; train_kl_reg_loss: 51574.1515; train_edge_recon_loss: 381176.0660; train_gene_expr_recon_loss: 225627.8385; train_masked_gp_l1_reg_loss: 1845.4630; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9784543.7778; train_global_loss: 10444767.2222; train_optim_loss: 10444767.2222; val_kl_reg_loss: 48603.8750; val_edge_recon_loss: 406343.7500; val_gene_expr_recon_loss: 222927.7344; val_masked_gp_l1_reg_loss: 1810.0051; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9896635.0000; val_global_loss: 10576320.0000; val_optim_loss: 10576320.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8547; val_auprc_score: 0.8470; val_best_acc_score: 0.5746; val_best_f1_score: 0.7000; train_kl_reg_loss: 52963.6198; train_edge_recon_loss: 380273.5799; train_gene_expr_recon_loss: 222112.3924; train_masked_gp_l1_reg_loss: 1786.0997; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9772921.3333; train_global_loss: 10430057.1111; train_optim_loss: 10430057.1111; val_kl_reg_loss: 50829.7656; val_edge_recon_loss: 406150.1250; val_gene_expr_recon_loss: 219736.1250; val_masked_gp_l1_reg_loss: 1756.5941; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9863498.0000; val_global_loss: 10541971.0000; val_optim_loss: 10541971.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8518; val_auprc_score: 0.8468; val_best_acc_score: 0.6428; val_best_f1_score: 0.7331; train_kl_reg_loss: 54233.3407; train_edge_recon_loss: 378619.1146; train_gene_expr_recon_loss: 220397.7222; train_masked_gp_l1_reg_loss: 1739.1880; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9761826.4444; train_global_loss: 10416815.8889; train_optim_loss: 10416815.8889; val_kl_reg_loss: 46873.4609; val_edge_recon_loss: 405743.8125; val_gene_expr_recon_loss: 218082.8438; val_masked_gp_l1_reg_loss: 1717.4812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9852605.0000; val_global_loss: 10525023.0000; val_optim_loss: 10525023.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8535; val_auprc_score: 0.8510; val_best_acc_score: 0.6947; val_best_f1_score: 0.7577; train_kl_reg_loss: 52395.3229; train_edge_recon_loss: 379168.0000; train_gene_expr_recon_loss: 219373.3750; train_masked_gp_l1_reg_loss: 1708.4267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748336.5556; train_global_loss: 10400981.7778; train_optim_loss: 10400981.7778; val_kl_reg_loss: 46010.8320; val_edge_recon_loss: 405264.0000; val_gene_expr_recon_loss: 216142.6094; val_masked_gp_l1_reg_loss: 1695.4597; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9826945.0000; val_global_loss: 10496058.0000; val_optim_loss: 10496058.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8491; val_auprc_score: 0.8440; val_best_acc_score: 0.7355; val_best_f1_score: 0.7761; train_kl_reg_loss: 52342.6806; train_edge_recon_loss: 377543.7674; train_gene_expr_recon_loss: 217144.0312; train_masked_gp_l1_reg_loss: 1689.8092; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9732090.7778; train_global_loss: 10380811.1111; train_optim_loss: 10380811.1111; val_kl_reg_loss: 49404.5234; val_edge_recon_loss: 404637.1875; val_gene_expr_recon_loss: 215017.6406; val_masked_gp_l1_reg_loss: 1679.5913; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9818127.0000; val_global_loss: 10488866.0000; val_optim_loss: 10488866.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8416; val_auprc_score: 0.8314; val_best_acc_score: 0.7561; val_best_f1_score: 0.7733; train_kl_reg_loss: 51841.9145; train_edge_recon_loss: 375733.3576; train_gene_expr_recon_loss: 217165.8715; train_masked_gp_l1_reg_loss: 1674.6620; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9707801.0000; train_global_loss: 10354216.7778; train_optim_loss: 10354216.7778; val_kl_reg_loss: 46032.9727; val_edge_recon_loss: 403365.3438; val_gene_expr_recon_loss: 214417.2031; val_masked_gp_l1_reg_loss: 1667.9775; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9793609.0000; val_global_loss: 10459092.0000; val_optim_loss: 10459092.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8507; val_auprc_score: 0.8427; val_best_acc_score: 0.7611; val_best_f1_score: 0.7521; train_kl_reg_loss: 50182.0187; train_edge_recon_loss: 374844.2847; train_gene_expr_recon_loss: 216443.4219; train_masked_gp_l1_reg_loss: 1667.8873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9683521.0000; train_global_loss: 10326658.5556; train_optim_loss: 10326658.5556; val_kl_reg_loss: 44505.7266; val_edge_recon_loss: 401130.7812; val_gene_expr_recon_loss: 213855.7031; val_masked_gp_l1_reg_loss: 1664.8284; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9795861.0000; val_global_loss: 10457018.0000; val_optim_loss: 10457018.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8574; val_auprc_score: 0.8499; val_best_acc_score: 0.7521; val_best_f1_score: 0.7686; train_kl_reg_loss: 49034.4245; train_edge_recon_loss: 373315.6771; train_gene_expr_recon_loss: 214654.6562; train_masked_gp_l1_reg_loss: 1664.8261; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9667332.2222; train_global_loss: 10306001.8889; train_optim_loss: 10306001.8889; val_kl_reg_loss: 44983.2734; val_edge_recon_loss: 398115.5312; val_gene_expr_recon_loss: 212709.0156; val_masked_gp_l1_reg_loss: 1660.6655; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9772264.0000; val_global_loss: 10429732.0000; val_optim_loss: 10429732.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8525; val_auprc_score: 0.8424; val_best_acc_score: 0.7615; val_best_f1_score: 0.7893; train_kl_reg_loss: 48934.6523; train_edge_recon_loss: 370762.6562; train_gene_expr_recon_loss: 213513.3628; train_masked_gp_l1_reg_loss: 1659.1087; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9677584.0000; train_global_loss: 10312453.7778; train_optim_loss: 10312453.7778; val_kl_reg_loss: 43544.8984; val_edge_recon_loss: 392778.2188; val_gene_expr_recon_loss: 212247.1562; val_masked_gp_l1_reg_loss: 1656.5294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9766477.0000; val_global_loss: 10416704.0000; val_optim_loss: 10416704.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8666; val_auprc_score: 0.8573; val_best_acc_score: 0.7820; val_best_f1_score: 0.7967; train_kl_reg_loss: 47587.0343; train_edge_recon_loss: 367569.1875; train_gene_expr_recon_loss: 212171.6319; train_masked_gp_l1_reg_loss: 1659.1723; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9620671.1111; train_global_loss: 10249658.3333; train_optim_loss: 10249658.3333; val_kl_reg_loss: 44667.8828; val_edge_recon_loss: 383178.0000; val_gene_expr_recon_loss: 212043.8438; val_masked_gp_l1_reg_loss: 1660.7306; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9760660.0000; val_global_loss: 10402210.0000; val_optim_loss: 10402210.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8678; val_auprc_score: 0.8542; val_best_acc_score: 0.7877; val_best_f1_score: 0.8049; train_kl_reg_loss: 47434.6576; train_edge_recon_loss: 362005.3090; train_gene_expr_recon_loss: 212979.2882; train_masked_gp_l1_reg_loss: 1665.1222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9660968.8889; train_global_loss: 10285053.3333; train_optim_loss: 10285053.3333; val_kl_reg_loss: 46204.8516; val_edge_recon_loss: 371914.1562; val_gene_expr_recon_loss: 211314.4219; val_masked_gp_l1_reg_loss: 1667.5299; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9745195.0000; val_global_loss: 10376296.0000; val_optim_loss: 10376296.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8819; val_auprc_score: 0.8697; val_best_acc_score: 0.7959; val_best_f1_score: 0.8118; train_kl_reg_loss: 49387.4961; train_edge_recon_loss: 354255.7917; train_gene_expr_recon_loss: 212587.3038; train_masked_gp_l1_reg_loss: 1674.8884; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9642097.0000; train_global_loss: 10260002.4444; train_optim_loss: 10260002.4444; val_kl_reg_loss: 48243.0469; val_edge_recon_loss: 356250.1562; val_gene_expr_recon_loss: 211441.9062; val_masked_gp_l1_reg_loss: 1677.9564; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9758724.0000; val_global_loss: 10376337.0000; val_optim_loss: 10376337.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8847; val_auprc_score: 0.8703; val_best_acc_score: 0.8013; val_best_f1_score: 0.8121; train_kl_reg_loss: 52562.5126; train_edge_recon_loss: 345844.4861; train_gene_expr_recon_loss: 213306.5556; train_masked_gp_l1_reg_loss: 1681.6764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9673654.3333; train_global_loss: 10287049.5556; train_optim_loss: 10287049.5556; val_kl_reg_loss: 51031.3320; val_edge_recon_loss: 345143.5312; val_gene_expr_recon_loss: 211440.6719; val_masked_gp_l1_reg_loss: 1683.4045; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9749763.0000; val_global_loss: 10359062.0000; val_optim_loss: 10359062.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8828; val_auprc_score: 0.8657; val_best_acc_score: 0.7987; val_best_f1_score: 0.8093; train_kl_reg_loss: 54738.3329; train_edge_recon_loss: 339123.4757; train_gene_expr_recon_loss: 213263.0990; train_masked_gp_l1_reg_loss: 1691.0365; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630827.0000; train_global_loss: 10239642.8889; train_optim_loss: 10239642.8889; val_kl_reg_loss: 54407.9766; val_edge_recon_loss: 339785.0312; val_gene_expr_recon_loss: 210697.2031; val_masked_gp_l1_reg_loss: 1695.9646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733251.0000; val_global_loss: 10339837.0000; val_optim_loss: 10339837.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8867; val_auprc_score: 0.8671; val_best_acc_score: 0.8017; val_best_f1_score: 0.8153; train_kl_reg_loss: 55803.5959; train_edge_recon_loss: 335651.9410; train_gene_expr_recon_loss: 211498.8976; train_masked_gp_l1_reg_loss: 1701.4736; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9583669.6667; train_global_loss: 10188325.5556; train_optim_loss: 10188325.5556; val_kl_reg_loss: 52808.9297; val_edge_recon_loss: 336173.8750; val_gene_expr_recon_loss: 210751.3906; val_masked_gp_l1_reg_loss: 1705.6565; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9722837.0000; val_global_loss: 10324277.0000; val_optim_loss: 10324277.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8920; val_auprc_score: 0.8738; val_best_acc_score: 0.8108; val_best_f1_score: 0.8231; train_kl_reg_loss: 54653.0482; train_edge_recon_loss: 332630.6215; train_gene_expr_recon_loss: 210694.9688; train_masked_gp_l1_reg_loss: 1711.5131; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9605570.6667; train_global_loss: 10205261.0000; train_optim_loss: 10205261.0000; val_kl_reg_loss: 52135.2656; val_edge_recon_loss: 331893.5312; val_gene_expr_recon_loss: 210455.2500; val_masked_gp_l1_reg_loss: 1714.7866; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714659.0000; val_global_loss: 10310858.0000; val_optim_loss: 10310858.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8947; val_auprc_score: 0.8750; val_best_acc_score: 0.8153; val_best_f1_score: 0.8271; train_kl_reg_loss: 54502.2166; train_edge_recon_loss: 329394.9757; train_gene_expr_recon_loss: 211066.8715; train_masked_gp_l1_reg_loss: 1718.2511; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9581023.4444; train_global_loss: 10177705.8889; train_optim_loss: 10177705.8889; val_kl_reg_loss: 52699.4297; val_edge_recon_loss: 330419.9688; val_gene_expr_recon_loss: 210224.5625; val_masked_gp_l1_reg_loss: 1722.3157; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9710618.0000; val_global_loss: 10305684.0000; val_optim_loss: 10305684.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8970; val_auprc_score: 0.8736; val_best_acc_score: 0.8228; val_best_f1_score: 0.8362; train_kl_reg_loss: 54306.7318; train_edge_recon_loss: 328131.4549; train_gene_expr_recon_loss: 210701.6389; train_masked_gp_l1_reg_loss: 1729.7089; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9592421.2222; train_global_loss: 10187290.7778; train_optim_loss: 10187290.7778; val_kl_reg_loss: 51027.8164; val_edge_recon_loss: 327850.0938; val_gene_expr_recon_loss: 209836.4062; val_masked_gp_l1_reg_loss: 1733.0447; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9690008.0000; val_global_loss: 10280455.0000; val_optim_loss: 10280455.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9058; val_auprc_score: 0.8833; val_best_acc_score: 0.8339; val_best_f1_score: 0.8440; train_kl_reg_loss: 52684.3268; train_edge_recon_loss: 376324.5764; train_gene_expr_recon_loss: 214741.0521; train_masked_gp_l1_reg_loss: 1736.0337; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9604697.2222; train_global_loss: 10250183.1111; train_optim_loss: 10250183.1111; val_kl_reg_loss: 38413.3242; val_edge_recon_loss: 378327.4375; val_gene_expr_recon_loss: 212449.7500; val_masked_gp_l1_reg_loss: 1733.6522; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9728249.0000; val_global_loss: 10359173.0000; val_optim_loss: 10359173.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9031; val_auprc_score: 0.8730; val_best_acc_score: 0.8293; val_best_f1_score: 0.8459; train_kl_reg_loss: 54191.1658; train_edge_recon_loss: 364426.8438; train_gene_expr_recon_loss: 213135.5382; train_masked_gp_l1_reg_loss: 1727.9142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9613826.0000; train_global_loss: 10247307.3333; train_optim_loss: 10247307.3333; val_kl_reg_loss: 31896.6426; val_edge_recon_loss: 384728.1562; val_gene_expr_recon_loss: 212145.9531; val_masked_gp_l1_reg_loss: 1718.7424; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717330.0000; val_global_loss: 10347820.0000; val_optim_loss: 10347820.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9171; val_auprc_score: 0.8988; val_best_acc_score: 0.8283; val_best_f1_score: 0.8497; train_kl_reg_loss: 47489.0486; train_edge_recon_loss: 371513.3472; train_gene_expr_recon_loss: 213136.1493; train_masked_gp_l1_reg_loss: 1715.7265; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9567780.5556; train_global_loss: 10201634.7778; train_optim_loss: 10201634.7778; val_kl_reg_loss: 33540.1680; val_edge_recon_loss: 390697.6250; val_gene_expr_recon_loss: 211726.5781; val_masked_gp_l1_reg_loss: 1711.3845; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9722050.0000; val_global_loss: 10359726.0000; val_optim_loss: 10359726.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9172; val_auprc_score: 0.8920; val_best_acc_score: 0.8420; val_best_f1_score: 0.8595; train_kl_reg_loss: 42763.0560; train_edge_recon_loss: 377060.0938; train_gene_expr_recon_loss: 212267.6424; train_masked_gp_l1_reg_loss: 1708.3846; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9595373.7778; train_global_loss: 10229173.0000; train_optim_loss: 10229173.0000; val_kl_reg_loss: 27479.9062; val_edge_recon_loss: 386685.2812; val_gene_expr_recon_loss: 211931.2656; val_masked_gp_l1_reg_loss: 1704.5787; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9713932.0000; val_global_loss: 10341733.0000; val_optim_loss: 10341733.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9153; val_auprc_score: 0.8939; val_best_acc_score: 0.8273; val_best_f1_score: 0.8488; train_kl_reg_loss: 39057.0247; train_edge_recon_loss: 374255.5278; train_gene_expr_recon_loss: 212658.3733; train_masked_gp_l1_reg_loss: 1701.8477; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9593776.6667; train_global_loss: 10221449.3333; train_optim_loss: 10221449.3333; val_kl_reg_loss: 31954.2148; val_edge_recon_loss: 387759.3125; val_gene_expr_recon_loss: 210929.0781; val_masked_gp_l1_reg_loss: 1698.9674; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696275.0000; val_global_loss: 10328617.0000; val_optim_loss: 10328617.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9106; val_auprc_score: 0.8882; val_best_acc_score: 0.8304; val_best_f1_score: 0.8509; train_kl_reg_loss: 40165.9592; train_edge_recon_loss: 374776.4306; train_gene_expr_recon_loss: 213400.3646; train_masked_gp_l1_reg_loss: 1697.7088; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9566840.3333; train_global_loss: 10196880.7778; train_optim_loss: 10196880.7778; val_kl_reg_loss: 30016.5742; val_edge_recon_loss: 387243.3438; val_gene_expr_recon_loss: 211043.3750; val_masked_gp_l1_reg_loss: 1695.8206; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9701810.0000; val_global_loss: 10331809.0000; val_optim_loss: 10331809.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9107; val_auprc_score: 0.8883; val_best_acc_score: 0.8293; val_best_f1_score: 0.8497; train_kl_reg_loss: 39071.4961; train_edge_recon_loss: 374807.1979; train_gene_expr_recon_loss: 212444.7743; train_masked_gp_l1_reg_loss: 1694.4438; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9603888.8889; train_global_loss: 10231906.6667; train_optim_loss: 10231906.6667; val_kl_reg_loss: 29537.1914; val_edge_recon_loss: 386044.7812; val_gene_expr_recon_loss: 211320.4531; val_masked_gp_l1_reg_loss: 1692.8741; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9698322.0000; val_global_loss: 10326917.0000; val_optim_loss: 10326917.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9100; val_auprc_score: 0.8842; val_best_acc_score: 0.8327; val_best_f1_score: 0.8520; train_kl_reg_loss: 38466.6168; train_edge_recon_loss: 374337.6806; train_gene_expr_recon_loss: 211820.3385; train_masked_gp_l1_reg_loss: 1692.0228; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645025.4444; train_global_loss: 10271342.2222; train_optim_loss: 10271342.2222; val_kl_reg_loss: 30649.4727; val_edge_recon_loss: 385762.6250; val_gene_expr_recon_loss: 211156.4062; val_masked_gp_l1_reg_loss: 1691.1448; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9700842.0000; val_global_loss: 10330102.0000; val_optim_loss: 10330102.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9035
Val AUPRC score: 0.8818
Val best accuracy score: 0.8243
Val best F1 score: 0.8383
Val gene expr MSE score: 0.5840
Val chrom access MSE score: 0.0884
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
