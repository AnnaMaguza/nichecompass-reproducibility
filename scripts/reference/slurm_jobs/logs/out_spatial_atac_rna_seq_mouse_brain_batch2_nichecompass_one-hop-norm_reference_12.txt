[True]
Run timestamp: 07082023_172259_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8968; val_auprc_score: 0.9105; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17527.2908; train_edge_recon_loss: 36157.1198; train_gene_expr_recon_loss: 1216301.7222; train_masked_gp_l1_reg_loss: 4585.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167214.7031; train_chrom_access_recon_loss: 2802040.7083; train_global_loss: 4243826.6111; train_optim_loss: 4243826.6111; val_kl_reg_loss: 12394.9277; val_edge_recon_loss: 40660.8438; val_gene_expr_recon_loss: 984537.5000; val_masked_gp_l1_reg_loss: 4115.9546; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163097.5938; val_chrom_access_recon_loss: 1706939.5000; val_global_loss: 2911746.2500; val_optim_loss: 2911746.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9092; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11494.4416; train_edge_recon_loss: 37719.8924; train_gene_expr_recon_loss: 909652.1042; train_masked_gp_l1_reg_loss: 4024.5030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160461.7431; train_chrom_access_recon_loss: 1518470.7222; train_global_loss: 2641823.4167; train_optim_loss: 2641823.4167; val_kl_reg_loss: 10922.4873; val_edge_recon_loss: 40660.7031; val_gene_expr_recon_loss: 851571.3750; val_masked_gp_l1_reg_loss: 4024.5669; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157256.5156; val_chrom_access_recon_loss: 1419550.8750; val_global_loss: 2483986.5000; val_optim_loss: 2483986.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9070; val_auprc_score: 0.9161; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14113.7990; train_edge_recon_loss: 38137.0291; train_gene_expr_recon_loss: 822832.8681; train_masked_gp_l1_reg_loss: 4164.3627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154670.7622; train_chrom_access_recon_loss: 1405882.1250; train_global_loss: 2439800.9722; train_optim_loss: 2439800.9722; val_kl_reg_loss: 17349.6406; val_edge_recon_loss: 40661.4453; val_gene_expr_recon_loss: 779580.0625; val_masked_gp_l1_reg_loss: 4321.9521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151286.7344; val_chrom_access_recon_loss: 1381669.8750; val_global_loss: 2374869.7500; val_optim_loss: 2374869.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8997; val_auprc_score: 0.9112; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19594.7415; train_edge_recon_loss: 38798.8685; train_gene_expr_recon_loss: 762616.0139; train_masked_gp_l1_reg_loss: 4361.4676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148222.5538; train_chrom_access_recon_loss: 1371959.1528; train_global_loss: 2345552.7778; train_optim_loss: 2345552.7778; val_kl_reg_loss: 19949.9727; val_edge_recon_loss: 40660.7109; val_gene_expr_recon_loss: 744664.7500; val_masked_gp_l1_reg_loss: 4375.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144168.5625; val_chrom_access_recon_loss: 1358995.1250; val_global_loss: 2312814.2500; val_optim_loss: 2312814.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8850; val_auprc_score: 0.8955; val_best_acc_score: 0.5026; val_best_f1_score: 0.6678; train_kl_reg_loss: 21205.0000; train_edge_recon_loss: 38896.4197; train_gene_expr_recon_loss: 737942.7292; train_masked_gp_l1_reg_loss: 4367.4248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140659.5208; train_chrom_access_recon_loss: 1355216.7917; train_global_loss: 2298287.9722; train_optim_loss: 2298287.9722; val_kl_reg_loss: 21541.9375; val_edge_recon_loss: 40657.8945; val_gene_expr_recon_loss: 722714.2500; val_masked_gp_l1_reg_loss: 4346.5073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136176.6562; val_chrom_access_recon_loss: 1344936.3750; val_global_loss: 2270373.5000; val_optim_loss: 2270373.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8739; val_auprc_score: 0.8794; val_best_acc_score: 0.5112; val_best_f1_score: 0.6717; train_kl_reg_loss: 22577.7231; train_edge_recon_loss: 39007.5582; train_gene_expr_recon_loss: 716636.3750; train_masked_gp_l1_reg_loss: 4317.3631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132501.8863; train_chrom_access_recon_loss: 1340975.4167; train_global_loss: 2256016.2778; train_optim_loss: 2256016.2778; val_kl_reg_loss: 22542.3848; val_edge_recon_loss: 40651.6758; val_gene_expr_recon_loss: 706001.5000; val_masked_gp_l1_reg_loss: 4278.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127888.7891; val_chrom_access_recon_loss: 1335523.0000; val_global_loss: 2236885.7500; val_optim_loss: 2236885.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8726; val_auprc_score: 0.8731; val_best_acc_score: 0.5193; val_best_f1_score: 0.6749; train_kl_reg_loss: 23167.8414; train_edge_recon_loss: 39040.0434; train_gene_expr_recon_loss: 702560.8056; train_masked_gp_l1_reg_loss: 4247.7097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124203.2917; train_chrom_access_recon_loss: 1329348.6806; train_global_loss: 2222568.3889; train_optim_loss: 2222568.3889; val_kl_reg_loss: 23439.4375; val_edge_recon_loss: 40640.1406; val_gene_expr_recon_loss: 693037.1250; val_masked_gp_l1_reg_loss: 4213.0366; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119629.1094; val_chrom_access_recon_loss: 1328501.1250; val_global_loss: 2209460.0000; val_optim_loss: 2209460.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8522; val_auprc_score: 0.8525; val_best_acc_score: 0.5385; val_best_f1_score: 0.6823; train_kl_reg_loss: 24025.2602; train_edge_recon_loss: 39065.3694; train_gene_expr_recon_loss: 693424.8333; train_masked_gp_l1_reg_loss: 4190.4993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116042.9028; train_chrom_access_recon_loss: 1331993.8194; train_global_loss: 2208742.6944; train_optim_loss: 2208742.6944; val_kl_reg_loss: 23257.4238; val_edge_recon_loss: 40625.1523; val_gene_expr_recon_loss: 683711.6250; val_masked_gp_l1_reg_loss: 4162.3770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111621.6875; val_chrom_access_recon_loss: 1322599.3750; val_global_loss: 2185977.5000; val_optim_loss: 2185977.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8315; val_auprc_score: 0.8278; val_best_acc_score: 0.5679; val_best_f1_score: 0.6946; train_kl_reg_loss: 24045.4399; train_edge_recon_loss: 39068.9206; train_gene_expr_recon_loss: 685068.0903; train_masked_gp_l1_reg_loss: 4146.8469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108207.6597; train_chrom_access_recon_loss: 1324445.7500; train_global_loss: 2184982.7500; train_optim_loss: 2184982.7500; val_kl_reg_loss: 23020.7168; val_edge_recon_loss: 40605.3672; val_gene_expr_recon_loss: 677655.9375; val_masked_gp_l1_reg_loss: 4121.7822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104026.2969; val_chrom_access_recon_loss: 1318198.1250; val_global_loss: 2167628.2500; val_optim_loss: 2167628.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8196; val_auprc_score: 0.8182; val_best_acc_score: 0.5771; val_best_f1_score: 0.6984; train_kl_reg_loss: 24272.9125; train_edge_recon_loss: 39113.0673; train_gene_expr_recon_loss: 675169.5833; train_masked_gp_l1_reg_loss: 4107.8082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100854.1345; train_chrom_access_recon_loss: 1315875.6944; train_global_loss: 2159393.1944; train_optim_loss: 2159393.1944; val_kl_reg_loss: 23538.9258; val_edge_recon_loss: 40596.6367; val_gene_expr_recon_loss: 671426.0625; val_masked_gp_l1_reg_loss: 4084.7021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96984.2031; val_chrom_access_recon_loss: 1313910.7500; val_global_loss: 2150541.2500; val_optim_loss: 2150541.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8204; val_auprc_score: 0.8241; val_best_acc_score: 0.5957; val_best_f1_score: 0.7072; train_kl_reg_loss: 24416.3787; train_edge_recon_loss: 39134.6311; train_gene_expr_recon_loss: 672075.5347; train_masked_gp_l1_reg_loss: 4076.3694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94064.1484; train_chrom_access_recon_loss: 1311119.0972; train_global_loss: 2144886.1944; train_optim_loss: 2144886.1944; val_kl_reg_loss: 23922.0000; val_edge_recon_loss: 40580.9805; val_gene_expr_recon_loss: 667013.0000; val_masked_gp_l1_reg_loss: 4063.0493; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90525.0703; val_chrom_access_recon_loss: 1310718.7500; val_global_loss: 2136823.0000; val_optim_loss: 2136823.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8156; val_auprc_score: 0.8158; val_best_acc_score: 0.6098; val_best_f1_score: 0.7130; train_kl_reg_loss: 24180.3737; train_edge_recon_loss: 39123.2977; train_gene_expr_recon_loss: 665695.6111; train_masked_gp_l1_reg_loss: 4057.8600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87864.1181; train_chrom_access_recon_loss: 1307689.3611; train_global_loss: 2128610.5972; train_optim_loss: 2128610.5972; val_kl_reg_loss: 23394.2266; val_edge_recon_loss: 40571.5664; val_gene_expr_recon_loss: 663730.6250; val_masked_gp_l1_reg_loss: 4046.3401; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84640.3828; val_chrom_access_recon_loss: 1307472.6250; val_global_loss: 2123855.7500; val_optim_loss: 2123855.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8030; val_auprc_score: 0.8017; val_best_acc_score: 0.6241; val_best_f1_score: 0.7186; train_kl_reg_loss: 23814.5679; train_edge_recon_loss: 39123.0495; train_gene_expr_recon_loss: 663960.5972; train_masked_gp_l1_reg_loss: 4041.9751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82226.9141; train_chrom_access_recon_loss: 1305676.9583; train_global_loss: 2118844.0278; train_optim_loss: 2118844.0278; val_kl_reg_loss: 22672.3633; val_edge_recon_loss: 40550.8867; val_gene_expr_recon_loss: 661243.3750; val_masked_gp_l1_reg_loss: 4030.1877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79297.2109; val_chrom_access_recon_loss: 1304665.0000; val_global_loss: 2112459.0000; val_optim_loss: 2112459.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8119; val_auprc_score: 0.8118; val_best_acc_score: 0.6359; val_best_f1_score: 0.7245; train_kl_reg_loss: 23410.2339; train_edge_recon_loss: 39094.7231; train_gene_expr_recon_loss: 661171.2917; train_masked_gp_l1_reg_loss: 4028.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77103.0113; train_chrom_access_recon_loss: 1306166.7083; train_global_loss: 2110974.6944; train_optim_loss: 2110974.6944; val_kl_reg_loss: 22662.4297; val_edge_recon_loss: 40540.1094; val_gene_expr_recon_loss: 658499.6250; val_masked_gp_l1_reg_loss: 4021.6965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74436.1641; val_chrom_access_recon_loss: 1301955.5000; val_global_loss: 2102115.5000; val_optim_loss: 2102115.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8044; val_auprc_score: 0.7997; val_best_acc_score: 0.6416; val_best_f1_score: 0.7267; train_kl_reg_loss: 23050.7641; train_edge_recon_loss: 39092.9002; train_gene_expr_recon_loss: 659871.5000; train_masked_gp_l1_reg_loss: 4017.8468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72429.1458; train_chrom_access_recon_loss: 1303424.1250; train_global_loss: 2101886.2917; train_optim_loss: 2101886.2917; val_kl_reg_loss: 22208.3711; val_edge_recon_loss: 40535.3125; val_gene_expr_recon_loss: 656411.3750; val_masked_gp_l1_reg_loss: 4009.5999; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69991.4062; val_chrom_access_recon_loss: 1299516.1250; val_global_loss: 2092672.2500; val_optim_loss: 2092672.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8075; val_auprc_score: 0.8046; val_best_acc_score: 0.6640; val_best_f1_score: 0.7371; train_kl_reg_loss: 22589.4796; train_edge_recon_loss: 39054.7027; train_gene_expr_recon_loss: 656364.0625; train_masked_gp_l1_reg_loss: 4008.9532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68164.4957; train_chrom_access_recon_loss: 1301380.5278; train_global_loss: 2091562.2639; train_optim_loss: 2091562.2639; val_kl_reg_loss: 21517.8047; val_edge_recon_loss: 40519.7695; val_gene_expr_recon_loss: 654730.3750; val_masked_gp_l1_reg_loss: 4003.4995; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65937.7188; val_chrom_access_recon_loss: 1299611.3750; val_global_loss: 2086320.5000; val_optim_loss: 2086320.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8085; val_auprc_score: 0.8046; val_best_acc_score: 0.6603; val_best_f1_score: 0.7341; train_kl_reg_loss: 22131.1595; train_edge_recon_loss: 39049.6115; train_gene_expr_recon_loss: 652908.7847; train_masked_gp_l1_reg_loss: 4006.1642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64264.8954; train_chrom_access_recon_loss: 1299883.1667; train_global_loss: 2082243.8056; train_optim_loss: 2082243.8056; val_kl_reg_loss: 21367.0977; val_edge_recon_loss: 40509.9336; val_gene_expr_recon_loss: 652769.6250; val_masked_gp_l1_reg_loss: 4002.8208; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62221.9180; val_chrom_access_recon_loss: 1297596.6250; val_global_loss: 2078468.0000; val_optim_loss: 2078468.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8182; val_auprc_score: 0.8178; val_best_acc_score: 0.6760; val_best_f1_score: 0.7418; train_kl_reg_loss: 21734.6773; train_edge_recon_loss: 39010.6437; train_gene_expr_recon_loss: 651673.9306; train_masked_gp_l1_reg_loss: 4002.8238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60685.2083; train_chrom_access_recon_loss: 1298807.0278; train_global_loss: 2075914.3194; train_optim_loss: 2075914.3194; val_kl_reg_loss: 20778.8594; val_edge_recon_loss: 40497.3828; val_gene_expr_recon_loss: 651181.8750; val_masked_gp_l1_reg_loss: 3998.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58806.3867; val_chrom_access_recon_loss: 1295033.2500; val_global_loss: 2070296.7500; val_optim_loss: 2070296.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8235; val_auprc_score: 0.8254; val_best_acc_score: 0.6958; val_best_f1_score: 0.7512; train_kl_reg_loss: 21327.1678; train_edge_recon_loss: 38992.7856; train_gene_expr_recon_loss: 652692.3472; train_masked_gp_l1_reg_loss: 4001.6529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57386.4640; train_chrom_access_recon_loss: 1299795.4444; train_global_loss: 2074195.8611; train_optim_loss: 2074195.8611; val_kl_reg_loss: 19934.7227; val_edge_recon_loss: 40471.0664; val_gene_expr_recon_loss: 650270.0000; val_masked_gp_l1_reg_loss: 3999.3210; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55654.8398; val_chrom_access_recon_loss: 1293192.3750; val_global_loss: 2063522.2500; val_optim_loss: 2063522.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8435; val_auprc_score: 0.8430; val_best_acc_score: 0.7099; val_best_f1_score: 0.7594; train_kl_reg_loss: 20875.2799; train_edge_recon_loss: 38957.9071; train_gene_expr_recon_loss: 648117.2292; train_masked_gp_l1_reg_loss: 4003.8011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54355.0482; train_chrom_access_recon_loss: 1286817.1528; train_global_loss: 2053126.4028; train_optim_loss: 2053126.4028; val_kl_reg_loss: 20603.8047; val_edge_recon_loss: 40466.8945; val_gene_expr_recon_loss: 648071.0000; val_masked_gp_l1_reg_loss: 4004.2554; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52758.4570; val_chrom_access_recon_loss: 1290493.7500; val_global_loss: 2056398.1250; val_optim_loss: 2056398.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8652; val_auprc_score: 0.8617; val_best_acc_score: 0.7541; val_best_f1_score: 0.7853; train_kl_reg_loss: 20664.0291; train_edge_recon_loss: 38909.4961; train_gene_expr_recon_loss: 647246.3472; train_masked_gp_l1_reg_loss: 4006.9304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51544.8650; train_chrom_access_recon_loss: 1289459.5417; train_global_loss: 2051831.2361; train_optim_loss: 2051831.2361; val_kl_reg_loss: 20370.3223; val_edge_recon_loss: 40412.9219; val_gene_expr_recon_loss: 646693.8750; val_masked_gp_l1_reg_loss: 4004.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50061.4141; val_chrom_access_recon_loss: 1288774.2500; val_global_loss: 2050317.2500; val_optim_loss: 2050317.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8763; val_auprc_score: 0.8711; val_best_acc_score: 0.7890; val_best_f1_score: 0.8064; train_kl_reg_loss: 20462.2170; train_edge_recon_loss: 38865.8264; train_gene_expr_recon_loss: 651760.0972; train_masked_gp_l1_reg_loss: 4008.6144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48944.4622; train_chrom_access_recon_loss: 1291226.9444; train_global_loss: 2055268.1806; train_optim_loss: 2055268.1806; val_kl_reg_loss: 19828.4453; val_edge_recon_loss: 40341.7461; val_gene_expr_recon_loss: 645395.3750; val_masked_gp_l1_reg_loss: 4010.9192; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47576.5547; val_chrom_access_recon_loss: 1286816.0000; val_global_loss: 2043969.0000; val_optim_loss: 2043969.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8869; val_auprc_score: 0.8807; val_best_acc_score: 0.8081; val_best_f1_score: 0.8170; train_kl_reg_loss: 20255.0998; train_edge_recon_loss: 38812.6020; train_gene_expr_recon_loss: 650112.7569; train_masked_gp_l1_reg_loss: 4018.3528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46539.3872; train_chrom_access_recon_loss: 1288953.8750; train_global_loss: 2048692.0694; train_optim_loss: 2048692.0694; val_kl_reg_loss: 19118.3398; val_edge_recon_loss: 40262.5234; val_gene_expr_recon_loss: 644402.2500; val_masked_gp_l1_reg_loss: 4018.2896; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45263.2812; val_chrom_access_recon_loss: 1284917.1250; val_global_loss: 2037981.8750; val_optim_loss: 2037981.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9049; val_auprc_score: 0.9004; val_best_acc_score: 0.8316; val_best_f1_score: 0.8331; train_kl_reg_loss: 20060.2852; train_edge_recon_loss: 38758.9206; train_gene_expr_recon_loss: 644630.3542; train_masked_gp_l1_reg_loss: 4026.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44303.5951; train_chrom_access_recon_loss: 1289870.6944; train_global_loss: 2041650.1528; train_optim_loss: 2041650.1528; val_kl_reg_loss: 18881.4785; val_edge_recon_loss: 40179.5273; val_gene_expr_recon_loss: 643172.2500; val_masked_gp_l1_reg_loss: 4024.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43114.3438; val_chrom_access_recon_loss: 1282557.6250; val_global_loss: 2031929.7500; val_optim_loss: 2031929.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9094; val_auprc_score: 0.9050; val_best_acc_score: 0.8351; val_best_f1_score: 0.8343; train_kl_reg_loss: 19744.3066; train_edge_recon_loss: 38687.9523; train_gene_expr_recon_loss: 645628.2014; train_masked_gp_l1_reg_loss: 4028.3395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42212.4058; train_chrom_access_recon_loss: 1284894.3056; train_global_loss: 2035195.5139; train_optim_loss: 2035195.5139; val_kl_reg_loss: 18918.4492; val_edge_recon_loss: 40132.8594; val_gene_expr_recon_loss: 641703.6250; val_masked_gp_l1_reg_loss: 4026.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41112.0742; val_chrom_access_recon_loss: 1280272.1250; val_global_loss: 2026165.7500; val_optim_loss: 2026165.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9055; val_auprc_score: 0.8963; val_best_acc_score: 0.8073; val_best_f1_score: 0.8274; train_kl_reg_loss: 17318.6771; train_edge_recon_loss: 40130.7578; train_gene_expr_recon_loss: 931377.2569; train_masked_gp_l1_reg_loss: 4088.6872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40126.5499; train_chrom_access_recon_loss: 1357417.2778; train_global_loss: 2390459.2222; train_optim_loss: 2390459.2222; val_kl_reg_loss: 14380.2383; val_edge_recon_loss: 40414.3008; val_gene_expr_recon_loss: 918865.3750; val_masked_gp_l1_reg_loss: 4201.7271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38812.6641; val_chrom_access_recon_loss: 1352018.1250; val_global_loss: 2368692.5000; val_optim_loss: 2368692.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9181; val_auprc_score: 0.9137; val_best_acc_score: 0.8238; val_best_f1_score: 0.8403; train_kl_reg_loss: 15975.5333; train_edge_recon_loss: 40159.9219; train_gene_expr_recon_loss: 917179.0208; train_masked_gp_l1_reg_loss: 4305.1932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37735.2921; train_chrom_access_recon_loss: 1351523.7639; train_global_loss: 2366878.7778; train_optim_loss: 2366878.7778; val_kl_reg_loss: 13949.6523; val_edge_recon_loss: 40404.3750; val_gene_expr_recon_loss: 911738.0000; val_masked_gp_l1_reg_loss: 4424.2163; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36407.8711; val_chrom_access_recon_loss: 1350021.2500; val_global_loss: 2356945.2500; val_optim_loss: 2356945.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9210; val_auprc_score: 0.9138; val_best_acc_score: 0.8376; val_best_f1_score: 0.8500; train_kl_reg_loss: 15477.1233; train_edge_recon_loss: 40135.5859; train_gene_expr_recon_loss: 911122.1597; train_masked_gp_l1_reg_loss: 4502.4219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35396.6480; train_chrom_access_recon_loss: 1352892.6667; train_global_loss: 2359526.6389; train_optim_loss: 2359526.6389; val_kl_reg_loss: 13886.2051; val_edge_recon_loss: 40371.3750; val_gene_expr_recon_loss: 906099.6250; val_masked_gp_l1_reg_loss: 4585.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34165.2344; val_chrom_access_recon_loss: 1347808.0000; val_global_loss: 2346916.0000; val_optim_loss: 2346916.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9226; val_auprc_score: 0.9128; val_best_acc_score: 0.8487; val_best_f1_score: 0.8577; train_kl_reg_loss: 15230.2755; train_edge_recon_loss: 40120.8911; train_gene_expr_recon_loss: 903310.4167; train_masked_gp_l1_reg_loss: 4635.5141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33242.8442; train_chrom_access_recon_loss: 1345949.1111; train_global_loss: 2342489.0833; train_optim_loss: 2342489.0833; val_kl_reg_loss: 14036.7109; val_edge_recon_loss: 40339.1367; val_gene_expr_recon_loss: 901659.6250; val_masked_gp_l1_reg_loss: 4687.8994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32126.7031; val_chrom_access_recon_loss: 1346042.7500; val_global_loss: 2338892.7500; val_optim_loss: 2338892.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9292; val_auprc_score: 0.9198; val_best_acc_score: 0.8527; val_best_f1_score: 0.8611; train_kl_reg_loss: 15187.0643; train_edge_recon_loss: 40098.2760; train_gene_expr_recon_loss: 905423.3403; train_masked_gp_l1_reg_loss: 4677.5229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31959.3166; train_chrom_access_recon_loss: 1349534.5694; train_global_loss: 2346880.0278; train_optim_loss: 2346880.0278; val_kl_reg_loss: 14252.9941; val_edge_recon_loss: 40342.0586; val_gene_expr_recon_loss: 901056.9375; val_masked_gp_l1_reg_loss: 4668.7900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31772.3828; val_chrom_access_recon_loss: 1345986.1250; val_global_loss: 2338079.2500; val_optim_loss: 2338079.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9284; val_auprc_score: 0.9205; val_best_acc_score: 0.8527; val_best_f1_score: 0.8609; train_kl_reg_loss: 15290.2003; train_edge_recon_loss: 40109.3785; train_gene_expr_recon_loss: 900364.5278; train_masked_gp_l1_reg_loss: 4668.2150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31658.4121; train_chrom_access_recon_loss: 1345370.5417; train_global_loss: 2337461.2500; train_optim_loss: 2337461.2500; val_kl_reg_loss: 14162.3809; val_edge_recon_loss: 40341.1523; val_gene_expr_recon_loss: 900825.6250; val_masked_gp_l1_reg_loss: 4666.1187; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31511.6367; val_chrom_access_recon_loss: 1346248.5000; val_global_loss: 2337755.5000; val_optim_loss: 2337755.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9243; val_auprc_score: 0.9146; val_best_acc_score: 0.8490; val_best_f1_score: 0.8577; train_kl_reg_loss: 15243.1912; train_edge_recon_loss: 40099.5790; train_gene_expr_recon_loss: 902671.9028; train_masked_gp_l1_reg_loss: 4665.4784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31404.4887; train_chrom_access_recon_loss: 1344749.7361; train_global_loss: 2338834.3889; train_optim_loss: 2338834.3889; val_kl_reg_loss: 14153.2793; val_edge_recon_loss: 40335.4062; val_gene_expr_recon_loss: 900691.5000; val_masked_gp_l1_reg_loss: 4665.0278; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31273.3398; val_chrom_access_recon_loss: 1345891.2500; val_global_loss: 2337009.7500; val_optim_loss: 2337009.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9291; val_auprc_score: 0.9183; val_best_acc_score: 0.8565; val_best_f1_score: 0.8638; train_kl_reg_loss: 15246.5505; train_edge_recon_loss: 40095.6476; train_gene_expr_recon_loss: 900842.9375; train_masked_gp_l1_reg_loss: 4665.3358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31173.1923; train_chrom_access_recon_loss: 1352067.7917; train_global_loss: 2344091.4722; train_optim_loss: 2344091.4722; val_kl_reg_loss: 14150.6348; val_edge_recon_loss: 40324.8984; val_gene_expr_recon_loss: 900230.5000; val_masked_gp_l1_reg_loss: 4665.9780; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31052.8867; val_chrom_access_recon_loss: 1345533.1250; val_global_loss: 2335958.0000; val_optim_loss: 2335958.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9096
val AUPRC score: 0.9000
val best accuracy score: 0.7998
val best F1 score: 0.8252
val target rna MSE score: 3.9037
val source rna MSE score: 3.2057
val target atac MSE score: 0.1352
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
