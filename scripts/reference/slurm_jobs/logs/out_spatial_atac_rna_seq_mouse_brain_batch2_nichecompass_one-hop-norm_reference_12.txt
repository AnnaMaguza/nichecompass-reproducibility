[True]
Run timestamp: 24072023_161013_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8975; val_auprc_score: 0.9077; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5629.3291; train_edge_recon_loss: 349956.9688; train_gene_expr_recon_loss: 3199391.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1081763.4722; train_global_loss: 4636741.6667; train_optim_loss: 4636741.6667; val_kl_reg_loss: 12046.3984; val_edge_recon_loss: 406582.5312; val_gene_expr_recon_loss: 3057185.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076378.5000; val_global_loss: 4552193.0000; val_optim_loss: 4552193.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8806; val_auprc_score: 0.8928; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 22676.6300; train_edge_recon_loss: 363272.0625; train_gene_expr_recon_loss: 2850058.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058350.6319; train_global_loss: 4294357.8889; train_optim_loss: 4294357.8889; val_kl_reg_loss: 27775.4961; val_edge_recon_loss: 406582.8438; val_gene_expr_recon_loss: 2752893.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1054281.5000; val_global_loss: 4241533.5000; val_optim_loss: 4241533.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8471; val_auprc_score: 0.8562; val_best_acc_score: 0.5051; val_best_f1_score: 0.6689; train_kl_reg_loss: 35299.3069; train_edge_recon_loss: 373351.2500; train_gene_expr_recon_loss: 2591445.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038445.4653; train_global_loss: 4038541.3333; train_optim_loss: 4038541.3333; val_kl_reg_loss: 43326.8281; val_edge_recon_loss: 406551.7812; val_gene_expr_recon_loss: 2495359.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032061.3750; val_global_loss: 3977299.0000; val_optim_loss: 3977299.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8751; val_auprc_score: 0.8794; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 48866.7461; train_edge_recon_loss: 383017.7500; train_gene_expr_recon_loss: 2407843.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014382.4931; train_global_loss: 3854110.5000; train_optim_loss: 3854110.5000; val_kl_reg_loss: 47058.5312; val_edge_recon_loss: 406536.8438; val_gene_expr_recon_loss: 2393866.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014783.8125; val_global_loss: 3862245.2500; val_optim_loss: 3862245.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8733; val_auprc_score: 0.8721; val_best_acc_score: 0.5086; val_best_f1_score: 0.6704; train_kl_reg_loss: 53543.0977; train_edge_recon_loss: 382887.2292; train_gene_expr_recon_loss: 2302276.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003804.3819; train_global_loss: 3742510.8611; train_optim_loss: 3742510.8611; val_kl_reg_loss: 53909.7031; val_edge_recon_loss: 406506.8438; val_gene_expr_recon_loss: 2296537.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003695.6875; val_global_loss: 3760649.5000; val_optim_loss: 3760649.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8744; val_auprc_score: 0.8711; val_best_acc_score: 0.5115; val_best_f1_score: 0.6716; train_kl_reg_loss: 56352.7973; train_edge_recon_loss: 384314.8090; train_gene_expr_recon_loss: 2232139.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997457.3125; train_global_loss: 3670264.6389; train_optim_loss: 3670264.6389; val_kl_reg_loss: 54620.6953; val_edge_recon_loss: 406471.2188; val_gene_expr_recon_loss: 2248134.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997087.8125; val_global_loss: 3706314.5000; val_optim_loss: 3706314.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8770; val_auprc_score: 0.8720; val_best_acc_score: 0.5259; val_best_f1_score: 0.6781; train_kl_reg_loss: 58447.0026; train_edge_recon_loss: 383367.9340; train_gene_expr_recon_loss: 2198279.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989490.4375; train_global_loss: 3629584.8333; train_optim_loss: 3629584.8333; val_kl_reg_loss: 55005.4375; val_edge_recon_loss: 406380.4062; val_gene_expr_recon_loss: 2212214.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991419.0000; val_global_loss: 3665019.2500; val_optim_loss: 3665019.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8772; val_auprc_score: 0.8706; val_best_acc_score: 0.5455; val_best_f1_score: 0.6863; train_kl_reg_loss: 57128.0890; train_edge_recon_loss: 382971.3576; train_gene_expr_recon_loss: 2149539.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976775.1181; train_global_loss: 3566414.1944; train_optim_loss: 3566414.1944; val_kl_reg_loss: 57809.6172; val_edge_recon_loss: 406224.4688; val_gene_expr_recon_loss: 2187229.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987716.0625; val_global_loss: 3638979.5000; val_optim_loss: 3638979.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8804; val_auprc_score: 0.8701; val_best_acc_score: 0.6168; val_best_f1_score: 0.7202; train_kl_reg_loss: 57943.1905; train_edge_recon_loss: 381526.7396; train_gene_expr_recon_loss: 2137693.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979034.3056; train_global_loss: 3556197.3889; train_optim_loss: 3556197.3889; val_kl_reg_loss: 57331.3828; val_edge_recon_loss: 405786.0312; val_gene_expr_recon_loss: 2171996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986701.0000; val_global_loss: 3621814.5000; val_optim_loss: 3621814.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8859; val_auprc_score: 0.8790; val_best_acc_score: 0.6987; val_best_f1_score: 0.7627; train_kl_reg_loss: 57324.4518; train_edge_recon_loss: 380489.2500; train_gene_expr_recon_loss: 2116880.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978616.4792; train_global_loss: 3533310.8333; train_optim_loss: 3533310.8333; val_kl_reg_loss: 51162.5312; val_edge_recon_loss: 404957.2500; val_gene_expr_recon_loss: 2159029.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985134.9375; val_global_loss: 3600284.5000; val_optim_loss: 3600284.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8779; val_auprc_score: 0.8670; val_best_acc_score: 0.7536; val_best_f1_score: 0.7920; train_kl_reg_loss: 54731.8398; train_edge_recon_loss: 379451.7535; train_gene_expr_recon_loss: 2093811.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973936.9306; train_global_loss: 3501931.7222; train_optim_loss: 3501931.7222; val_kl_reg_loss: 50676.0234; val_edge_recon_loss: 403768.7812; val_gene_expr_recon_loss: 2149734.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983559.3125; val_global_loss: 3587738.7500; val_optim_loss: 3587738.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8785; val_auprc_score: 0.8663; val_best_acc_score: 0.7901; val_best_f1_score: 0.8093; train_kl_reg_loss: 53766.8147; train_edge_recon_loss: 377023.0729; train_gene_expr_recon_loss: 2110168.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979767.6111; train_global_loss: 3520725.4444; train_optim_loss: 3520725.4444; val_kl_reg_loss: 48972.9180; val_edge_recon_loss: 401987.1562; val_gene_expr_recon_loss: 2144688.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982606.8125; val_global_loss: 3578255.2500; val_optim_loss: 3578255.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8818; val_auprc_score: 0.8686; val_best_acc_score: 0.8072; val_best_f1_score: 0.8109; train_kl_reg_loss: 51919.7001; train_edge_recon_loss: 375263.0521; train_gene_expr_recon_loss: 2093521.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970241.6389; train_global_loss: 3490945.6944; train_optim_loss: 3490945.6944; val_kl_reg_loss: 46669.3047; val_edge_recon_loss: 399144.4688; val_gene_expr_recon_loss: 2138122.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980646.1875; val_global_loss: 3564582.2500; val_optim_loss: 3564582.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8843; val_auprc_score: 0.8738; val_best_acc_score: 0.7908; val_best_f1_score: 0.7830; train_kl_reg_loss: 50827.9062; train_edge_recon_loss: 373109.9306; train_gene_expr_recon_loss: 2089351.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972742.0625; train_global_loss: 3486031.5556; train_optim_loss: 3486031.5556; val_kl_reg_loss: 45176.0625; val_edge_recon_loss: 395523.7812; val_gene_expr_recon_loss: 2132297.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979305.6250; val_global_loss: 3552302.5000; val_optim_loss: 3552302.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8896; val_auprc_score: 0.8766; val_best_acc_score: 0.7726; val_best_f1_score: 0.8056; train_kl_reg_loss: 49505.8867; train_edge_recon_loss: 370351.3403; train_gene_expr_recon_loss: 2092580.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969174.0139; train_global_loss: 3481611.4444; train_optim_loss: 3481611.4444; val_kl_reg_loss: 43988.2031; val_edge_recon_loss: 390136.7188; val_gene_expr_recon_loss: 2126943.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977320.0000; val_global_loss: 3538388.7500; val_optim_loss: 3538388.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9033; val_auprc_score: 0.8882; val_best_acc_score: 0.8099; val_best_f1_score: 0.8269; train_kl_reg_loss: 48674.7010; train_edge_recon_loss: 367458.0972; train_gene_expr_recon_loss: 2090140.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970776.8958; train_global_loss: 3477050.6111; train_optim_loss: 3477050.6111; val_kl_reg_loss: 44448.8281; val_edge_recon_loss: 383584.1562; val_gene_expr_recon_loss: 2123492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977414.7500; val_global_loss: 3528939.7500; val_optim_loss: 3528939.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9023; val_auprc_score: 0.8825; val_best_acc_score: 0.8222; val_best_f1_score: 0.8306; train_kl_reg_loss: 48226.3819; train_edge_recon_loss: 363267.3403; train_gene_expr_recon_loss: 2082241.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963569.9931; train_global_loss: 3457304.6944; train_optim_loss: 3457304.6944; val_kl_reg_loss: 44783.5078; val_edge_recon_loss: 376183.6250; val_gene_expr_recon_loss: 2120913.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976954.2500; val_global_loss: 3518835.2500; val_optim_loss: 3518835.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9057; val_auprc_score: 0.8894; val_best_acc_score: 0.8302; val_best_f1_score: 0.8357; train_kl_reg_loss: 48477.1302; train_edge_recon_loss: 358496.3472; train_gene_expr_recon_loss: 2073394.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971388.8472; train_global_loss: 3451756.3056; train_optim_loss: 3451756.3056; val_kl_reg_loss: 45109.1055; val_edge_recon_loss: 367742.3750; val_gene_expr_recon_loss: 2117456.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976067.4375; val_global_loss: 3506375.7500; val_optim_loss: 3506375.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9159; val_auprc_score: 0.9007; val_best_acc_score: 0.8363; val_best_f1_score: 0.8460; train_kl_reg_loss: 48733.0829; train_edge_recon_loss: 353081.4931; train_gene_expr_recon_loss: 2082174.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970971.4931; train_global_loss: 3454960.5833; train_optim_loss: 3454960.5833; val_kl_reg_loss: 46521.2422; val_edge_recon_loss: 356833.2812; val_gene_expr_recon_loss: 2116891.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976236.1875; val_global_loss: 3496481.7500; val_optim_loss: 3496481.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9092; val_auprc_score: 0.8891; val_best_acc_score: 0.8309; val_best_f1_score: 0.8376; train_kl_reg_loss: 49797.5924; train_edge_recon_loss: 345890.4826; train_gene_expr_recon_loss: 2075046.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962213.6875; train_global_loss: 3432948.1944; train_optim_loss: 3432948.1944; val_kl_reg_loss: 48820.0352; val_edge_recon_loss: 347961.8125; val_gene_expr_recon_loss: 2111470.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973299.0000; val_global_loss: 3481551.5000; val_optim_loss: 3481551.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9100; val_auprc_score: 0.8914; val_best_acc_score: 0.8293; val_best_f1_score: 0.8389; train_kl_reg_loss: 51717.7487; train_edge_recon_loss: 339061.9097; train_gene_expr_recon_loss: 2062467.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963448.1875; train_global_loss: 3416695.5556; train_optim_loss: 3416695.5556; val_kl_reg_loss: 50417.1250; val_edge_recon_loss: 337866.1250; val_gene_expr_recon_loss: 2108067.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971706.3750; val_global_loss: 3468057.5000; val_optim_loss: 3468057.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9042; val_auprc_score: 0.8821; val_best_acc_score: 0.8247; val_best_f1_score: 0.8315; train_kl_reg_loss: 52448.9219; train_edge_recon_loss: 334405.8194; train_gene_expr_recon_loss: 2065390.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960454.4861; train_global_loss: 3412699.4722; train_optim_loss: 3412699.4722; val_kl_reg_loss: 50607.8398; val_edge_recon_loss: 335269.9375; val_gene_expr_recon_loss: 2108987.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972867.2500; val_global_loss: 3467732.0000; val_optim_loss: 3467732.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9046; val_auprc_score: 0.8843; val_best_acc_score: 0.8248; val_best_f1_score: 0.8366; train_kl_reg_loss: 52744.9709; train_edge_recon_loss: 330458.5903; train_gene_expr_recon_loss: 2071475.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964936.0625; train_global_loss: 3419614.8889; train_optim_loss: 3419614.8889; val_kl_reg_loss: 48855.6758; val_edge_recon_loss: 333861.5938; val_gene_expr_recon_loss: 2107865.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970646.9375; val_global_loss: 3461230.0000; val_optim_loss: 3461230.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9115; val_auprc_score: 0.8931; val_best_acc_score: 0.8324; val_best_f1_score: 0.8426; train_kl_reg_loss: 51560.1437; train_edge_recon_loss: 328336.9861; train_gene_expr_recon_loss: 2052518.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958171.2847; train_global_loss: 3390587.0833; train_optim_loss: 3390587.0833; val_kl_reg_loss: 49180.3281; val_edge_recon_loss: 329265.0938; val_gene_expr_recon_loss: 2101761.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969335.8125; val_global_loss: 3449542.7500; val_optim_loss: 3449542.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9134; val_auprc_score: 0.8972; val_best_acc_score: 0.8337; val_best_f1_score: 0.8453; train_kl_reg_loss: 50666.6345; train_edge_recon_loss: 327180.2083; train_gene_expr_recon_loss: 2054707.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963331.3264; train_global_loss: 3395885.8333; train_optim_loss: 3395885.8333; val_kl_reg_loss: 48304.0391; val_edge_recon_loss: 329080.1875; val_gene_expr_recon_loss: 2098880.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968252.2500; val_global_loss: 3444516.7500; val_optim_loss: 3444516.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9224; val_auprc_score: 0.9032; val_best_acc_score: 0.8463; val_best_f1_score: 0.8547; train_kl_reg_loss: 54089.0282; train_edge_recon_loss: 355768.4653; train_gene_expr_recon_loss: 2120022.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967588.8889; train_global_loss: 3497469.1667; train_optim_loss: 3497469.1667; val_kl_reg_loss: 30460.8242; val_edge_recon_loss: 355280.6562; val_gene_expr_recon_loss: 2157296.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974507.8750; val_global_loss: 3517546.0000; val_optim_loss: 3517546.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9289; val_auprc_score: 0.9137; val_best_acc_score: 0.8544; val_best_f1_score: 0.8594; train_kl_reg_loss: 48253.5642; train_edge_recon_loss: 348582.9479; train_gene_expr_recon_loss: 2105150.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965737.1528; train_global_loss: 3467724.0000; train_optim_loss: 3467724.0000; val_kl_reg_loss: 31815.5020; val_edge_recon_loss: 352825.5625; val_gene_expr_recon_loss: 2147667.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972098.1875; val_global_loss: 3504406.2500; val_optim_loss: 3504406.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9241; val_auprc_score: 0.9046; val_best_acc_score: 0.8472; val_best_f1_score: 0.8562; train_kl_reg_loss: 45899.0312; train_edge_recon_loss: 344741.2500; train_gene_expr_recon_loss: 2095101.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965015.5972; train_global_loss: 3450757.5000; train_optim_loss: 3450757.5000; val_kl_reg_loss: 31546.2930; val_edge_recon_loss: 342797.3438; val_gene_expr_recon_loss: 2145491.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969286.1875; val_global_loss: 3489121.2500; val_optim_loss: 3489121.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9258; val_auprc_score: 0.9120; val_best_acc_score: 0.8483; val_best_f1_score: 0.8550; train_kl_reg_loss: 45238.0829; train_edge_recon_loss: 337984.8299; train_gene_expr_recon_loss: 2083537.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959829.0000; train_global_loss: 3426589.0833; train_optim_loss: 3426589.0833; val_kl_reg_loss: 33550.9570; val_edge_recon_loss: 333580.3438; val_gene_expr_recon_loss: 2142393.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968887.6250; val_global_loss: 3478412.5000; val_optim_loss: 3478412.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9257; val_auprc_score: 0.9122; val_best_acc_score: 0.8469; val_best_f1_score: 0.8546; train_kl_reg_loss: 45514.8984; train_edge_recon_loss: 332273.8993; train_gene_expr_recon_loss: 2104109.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963332.6042; train_global_loss: 3445230.8889; train_optim_loss: 3445230.8889; val_kl_reg_loss: 35384.5977; val_edge_recon_loss: 334841.7812; val_gene_expr_recon_loss: 2139155.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969122.8750; val_global_loss: 3478505.0000; val_optim_loss: 3478505.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9222; val_auprc_score: 0.9029; val_best_acc_score: 0.8463; val_best_f1_score: 0.8538; train_kl_reg_loss: 46283.9839; train_edge_recon_loss: 332270.2847; train_gene_expr_recon_loss: 2090054.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959126.1736; train_global_loss: 3427735.3889; train_optim_loss: 3427735.3889; val_kl_reg_loss: 34707.8750; val_edge_recon_loss: 333711.4062; val_gene_expr_recon_loss: 2140510.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969982.6875; val_global_loss: 3478912.2500; val_optim_loss: 3478912.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9228; val_auprc_score: 0.9022; val_best_acc_score: 0.8469; val_best_f1_score: 0.8582; train_kl_reg_loss: 45328.0330; train_edge_recon_loss: 331906.5729; train_gene_expr_recon_loss: 2095871.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962847.0347; train_global_loss: 3435953.5833; train_optim_loss: 3435953.5833; val_kl_reg_loss: 34190.7852; val_edge_recon_loss: 331381.2812; val_gene_expr_recon_loss: 2138564.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967575.0625; val_global_loss: 3471711.5000; val_optim_loss: 3471711.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9236; val_auprc_score: 0.9049; val_best_acc_score: 0.8504; val_best_f1_score: 0.8596; train_kl_reg_loss: 45523.3194; train_edge_recon_loss: 332656.0347; train_gene_expr_recon_loss: 2090639.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959976.5833; train_global_loss: 3428795.7778; train_optim_loss: 3428795.7778; val_kl_reg_loss: 34816.3516; val_edge_recon_loss: 332873.2500; val_gene_expr_recon_loss: 2138812.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968758.0625; val_global_loss: 3475260.2500; val_optim_loss: 3475260.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 55 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9300
Val AUPRC score: 0.9156
Val best accuracy score: 0.8525
Val best F1 score: 0.8585
Val gene expr MSE score: 0.6359
Val chrom access MSE score: 0.0882
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
