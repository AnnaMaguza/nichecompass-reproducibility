[True]
Run timestamp: 10082023_145555_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7781; val_auprc_score: 0.8005; val_best_acc_score: 0.5667; val_best_f1_score: 0.6915; train_kl_reg_loss: 123177.7350; train_edge_recon_loss: 3590548.1527; train_gene_expr_recon_loss: 15442586.9008; train_masked_gp_l1_reg_loss: 82086.3182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240593.7233; train_chrom_access_recon_loss: 33542578.7023; train_global_loss: 53021571.6641; train_optim_loss: 53021571.6641; val_kl_reg_loss: 134986.9854; val_edge_recon_loss: 4061193.0500; val_gene_expr_recon_loss: 13207724.6000; val_masked_gp_l1_reg_loss: 76524.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231276.4688; val_chrom_access_recon_loss: 31776349.2000; val_global_loss: 49488053.8667; val_optim_loss: 49488053.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8596; val_auprc_score: 0.8543; val_best_acc_score: 0.7652; val_best_f1_score: 0.7865; train_kl_reg_loss: 145610.4521; train_edge_recon_loss: 3544298.3664; train_gene_expr_recon_loss: 12725390.6336; train_masked_gp_l1_reg_loss: 72939.8291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218890.1223; train_chrom_access_recon_loss: 30947199.6641; train_global_loss: 47654329.2519; train_optim_loss: 47654329.2519; val_kl_reg_loss: 131117.8135; val_edge_recon_loss: 3833421.1167; val_gene_expr_recon_loss: 12542575.0000; val_masked_gp_l1_reg_loss: 72109.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205562.0625; val_chrom_access_recon_loss: 31006618.6667; val_global_loss: 47791404.0000; val_optim_loss: 47791404.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8555; val_auprc_score: 0.8444; val_best_acc_score: 0.7540; val_best_f1_score: 0.7903; train_kl_reg_loss: 150402.7062; train_edge_recon_loss: 3145952.3187; train_gene_expr_recon_loss: 12452564.1069; train_masked_gp_l1_reg_loss: 73879.5147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 192188.0922; train_chrom_access_recon_loss: 30562740.0305; train_global_loss: 46577726.7481; train_optim_loss: 46577726.7481; val_kl_reg_loss: 162468.1958; val_edge_recon_loss: 3033441.1667; val_gene_expr_recon_loss: 12478564.2667; val_masked_gp_l1_reg_loss: 75070.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178807.8906; val_chrom_access_recon_loss: 30851271.4667; val_global_loss: 46779624.0000; val_optim_loss: 46779624.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8693; val_auprc_score: 0.8524; val_best_acc_score: 0.7809; val_best_f1_score: 0.8033; train_kl_reg_loss: 156248.1385; train_edge_recon_loss: 2999614.6412; train_gene_expr_recon_loss: 12272396.5573; train_masked_gp_l1_reg_loss: 76514.6681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166401.5887; train_chrom_access_recon_loss: 30210968.5496; train_global_loss: 45882144.3359; train_optim_loss: 45882144.3359; val_kl_reg_loss: 153365.0281; val_edge_recon_loss: 2964927.7333; val_gene_expr_recon_loss: 12275232.3333; val_masked_gp_l1_reg_loss: 78072.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154391.8750; val_chrom_access_recon_loss: 30405353.3333; val_global_loss: 46031343.2000; val_optim_loss: 46031343.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8806; val_auprc_score: 0.8636; val_best_acc_score: 0.8007; val_best_f1_score: 0.8232; train_kl_reg_loss: 144482.2891; train_edge_recon_loss: 2951605.2042; train_gene_expr_recon_loss: 12159427.3664; train_masked_gp_l1_reg_loss: 79379.5852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143898.1219; train_chrom_access_recon_loss: 29993840.6870; train_global_loss: 45472633.3740; train_optim_loss: 45472633.3740; val_kl_reg_loss: 137531.7875; val_edge_recon_loss: 2942929.9667; val_gene_expr_recon_loss: 12128597.7333; val_masked_gp_l1_reg_loss: 80683.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134120.3438; val_chrom_access_recon_loss: 30102642.6667; val_global_loss: 45526505.6000; val_optim_loss: 45526505.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9126; val_auprc_score: 0.8969; val_best_acc_score: 0.8356; val_best_f1_score: 0.8467; train_kl_reg_loss: 137655.2224; train_edge_recon_loss: 2905078.9294; train_gene_expr_recon_loss: 12035763.4809; train_masked_gp_l1_reg_loss: 81786.8364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125906.8242; train_chrom_access_recon_loss: 29734998.2443; train_global_loss: 45021189.6489; train_optim_loss: 45021189.6489; val_kl_reg_loss: 140634.5604; val_edge_recon_loss: 2868657.4000; val_gene_expr_recon_loss: 12066414.2667; val_masked_gp_l1_reg_loss: 82762.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118030.1016; val_chrom_access_recon_loss: 30003114.6667; val_global_loss: 45279614.1333; val_optim_loss: 45279614.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9302; val_auprc_score: 0.9136; val_best_acc_score: 0.8616; val_best_f1_score: 0.8713; train_kl_reg_loss: 135897.5006; train_edge_recon_loss: 2863164.8550; train_gene_expr_recon_loss: 11935807.0076; train_masked_gp_l1_reg_loss: 83910.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111162.6293; train_chrom_access_recon_loss: 29515848.5802; train_global_loss: 44645791.5115; train_optim_loss: 44645791.5115; val_kl_reg_loss: 136477.4026; val_edge_recon_loss: 2844140.7500; val_gene_expr_recon_loss: 11918638.6667; val_masked_gp_l1_reg_loss: 85113.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104645.0156; val_chrom_access_recon_loss: 29728889.2000; val_global_loss: 44817904.8000; val_optim_loss: 44817904.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9323; val_auprc_score: 0.9154; val_best_acc_score: 0.8672; val_best_f1_score: 0.8767; train_kl_reg_loss: 137395.6483; train_edge_recon_loss: 2825350.2615; train_gene_expr_recon_loss: 11848312.6718; train_masked_gp_l1_reg_loss: 85944.9018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99048.5844; train_chrom_access_recon_loss: 29342893.5573; train_global_loss: 44338945.6489; train_optim_loss: 44338945.6489; val_kl_reg_loss: 139328.0240; val_edge_recon_loss: 2835566.2667; val_gene_expr_recon_loss: 11887657.8667; val_masked_gp_l1_reg_loss: 86894.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93780.2734; val_chrom_access_recon_loss: 29744490.0000; val_global_loss: 44787717.3333; val_optim_loss: 44787717.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9409; val_auprc_score: 0.9259; val_best_acc_score: 0.8790; val_best_f1_score: 0.8875; train_kl_reg_loss: 134668.2582; train_edge_recon_loss: 2791413.9218; train_gene_expr_recon_loss: 11768510.3435; train_masked_gp_l1_reg_loss: 87769.6970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89055.1370; train_chrom_access_recon_loss: 29128170.0916; train_global_loss: 43999587.7252; train_optim_loss: 43999587.7252; val_kl_reg_loss: 134896.9385; val_edge_recon_loss: 2798357.6667; val_gene_expr_recon_loss: 11807862.8000; val_masked_gp_l1_reg_loss: 88627.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84473.4688; val_chrom_access_recon_loss: 29436195.4667; val_global_loss: 44350413.3333; val_optim_loss: 44350413.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9450; val_auprc_score: 0.9300; val_best_acc_score: 0.8828; val_best_f1_score: 0.8899; train_kl_reg_loss: 130622.4020; train_edge_recon_loss: 2786993.9141; train_gene_expr_recon_loss: 11704894.9084; train_masked_gp_l1_reg_loss: 89540.6649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80525.3031; train_chrom_access_recon_loss: 28996865.5115; train_global_loss: 43789442.8702; train_optim_loss: 43789442.8702; val_kl_reg_loss: 129907.0094; val_edge_recon_loss: 2778430.1833; val_gene_expr_recon_loss: 11729213.2000; val_masked_gp_l1_reg_loss: 90474.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76718.5156; val_chrom_access_recon_loss: 29289381.0667; val_global_loss: 44094125.8667; val_optim_loss: 44094125.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9331; val_best_acc_score: 0.8845; val_best_f1_score: 0.8893; train_kl_reg_loss: 127879.8841; train_edge_recon_loss: 2767560.4599; train_gene_expr_recon_loss: 11633255.1985; train_masked_gp_l1_reg_loss: 91164.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73319.0608; train_chrom_access_recon_loss: 28789138.9008; train_global_loss: 43482318.4427; train_optim_loss: 43482318.4427; val_kl_reg_loss: 126174.5047; val_edge_recon_loss: 2789215.7833; val_gene_expr_recon_loss: 11722687.7333; val_masked_gp_l1_reg_loss: 91979.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70098.1172; val_chrom_access_recon_loss: 29195052.6667; val_global_loss: 43995208.0000; val_optim_loss: 43995208.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9508; val_auprc_score: 0.9352; val_best_acc_score: 0.8914; val_best_f1_score: 0.8975; train_kl_reg_loss: 123681.6650; train_edge_recon_loss: 2770332.2061; train_gene_expr_recon_loss: 11580877.0076; train_masked_gp_l1_reg_loss: 92701.8016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67141.9688; train_chrom_access_recon_loss: 28681937.0687; train_global_loss: 43316671.6336; train_optim_loss: 43316671.6336; val_kl_reg_loss: 124241.0609; val_edge_recon_loss: 2771141.7000; val_gene_expr_recon_loss: 11593496.5333; val_masked_gp_l1_reg_loss: 93741.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64447.5469; val_chrom_access_recon_loss: 28915296.9333; val_global_loss: 43562366.6667; val_optim_loss: 43562366.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9537; val_auprc_score: 0.9421; val_best_acc_score: 0.8959; val_best_f1_score: 0.9007; train_kl_reg_loss: 121241.8154; train_edge_recon_loss: 2754919.4752; train_gene_expr_recon_loss: 11534623.7099; train_masked_gp_l1_reg_loss: 94293.6503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61853.1830; train_chrom_access_recon_loss: 28554846.4122; train_global_loss: 43121778.2595; train_optim_loss: 43121778.2595; val_kl_reg_loss: 121692.4583; val_edge_recon_loss: 2769270.1667; val_gene_expr_recon_loss: 11549782.0667; val_masked_gp_l1_reg_loss: 95037.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59491.0508; val_chrom_access_recon_loss: 28919216.1333; val_global_loss: 43514489.0667; val_optim_loss: 43514489.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9580; val_auprc_score: 0.9441; val_best_acc_score: 0.9049; val_best_f1_score: 0.9089; train_kl_reg_loss: 118422.2241; train_edge_recon_loss: 2747796.1145; train_gene_expr_recon_loss: 11475848.1069; train_masked_gp_l1_reg_loss: 95717.4406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57456.8768; train_chrom_access_recon_loss: 28392529.7252; train_global_loss: 42887770.4733; train_optim_loss: 42887770.4733; val_kl_reg_loss: 114583.0167; val_edge_recon_loss: 2752498.0167; val_gene_expr_recon_loss: 11523964.6667; val_masked_gp_l1_reg_loss: 96451.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55485.7422; val_chrom_access_recon_loss: 28621809.3333; val_global_loss: 43164792.8000; val_optim_loss: 43164792.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9621; val_auprc_score: 0.9539; val_best_acc_score: 0.9056; val_best_f1_score: 0.9098; train_kl_reg_loss: 115989.6125; train_edge_recon_loss: 2740361.4122; train_gene_expr_recon_loss: 11437898.9542; train_masked_gp_l1_reg_loss: 97136.6858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53755.3400; train_chrom_access_recon_loss: 28286108.4275; train_global_loss: 42731250.3511; train_optim_loss: 42731250.3511; val_kl_reg_loss: 113692.9849; val_edge_recon_loss: 2746922.0167; val_gene_expr_recon_loss: 11446330.9333; val_masked_gp_l1_reg_loss: 98032.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52108.2656; val_chrom_access_recon_loss: 28502819.0667; val_global_loss: 42959906.4000; val_optim_loss: 42959906.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9623; val_auprc_score: 0.9529; val_best_acc_score: 0.9054; val_best_f1_score: 0.9103; train_kl_reg_loss: 114354.9848; train_edge_recon_loss: 2736388.0153; train_gene_expr_recon_loss: 11394425.7634; train_masked_gp_l1_reg_loss: 98630.1443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50625.5392; train_chrom_access_recon_loss: 28171302.6565; train_global_loss: 42565726.8397; train_optim_loss: 42565726.8397; val_kl_reg_loss: 116145.4974; val_edge_recon_loss: 2759267.8333; val_gene_expr_recon_loss: 11393026.6000; val_masked_gp_l1_reg_loss: 99437.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49232.0391; val_chrom_access_recon_loss: 28285763.8667; val_global_loss: 42702872.8000; val_optim_loss: 42702872.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9615; val_auprc_score: 0.9512; val_best_acc_score: 0.9064; val_best_f1_score: 0.9110; train_kl_reg_loss: 112661.5861; train_edge_recon_loss: 2729245.9542; train_gene_expr_recon_loss: 11357873.4656; train_masked_gp_l1_reg_loss: 100001.1949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47890.8055; train_chrom_access_recon_loss: 28057913.4046; train_global_loss: 42405586.3817; train_optim_loss: 42405586.3817; val_kl_reg_loss: 115116.1661; val_edge_recon_loss: 2748792.0667; val_gene_expr_recon_loss: 11391451.7333; val_masked_gp_l1_reg_loss: 100536.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46557.6367; val_chrom_access_recon_loss: 28349649.7333; val_global_loss: 42752103.4667; val_optim_loss: 42752103.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9662; val_auprc_score: 0.9569; val_best_acc_score: 0.9166; val_best_f1_score: 0.9201; train_kl_reg_loss: 110716.2101; train_edge_recon_loss: 2728725.9676; train_gene_expr_recon_loss: 11323720.5573; train_masked_gp_l1_reg_loss: 101201.6840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45414.9131; train_chrom_access_recon_loss: 27941082.9618; train_global_loss: 42250862.1985; train_optim_loss: 42250862.1985; val_kl_reg_loss: 109330.2865; val_edge_recon_loss: 2737731.6667; val_gene_expr_recon_loss: 11398671.4000; val_masked_gp_l1_reg_loss: 102122.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44310.1445; val_chrom_access_recon_loss: 28463238.1333; val_global_loss: 42855404.5333; val_optim_loss: 42855404.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9719; val_auprc_score: 0.9624; val_best_acc_score: 0.9275; val_best_f1_score: 0.9302; train_kl_reg_loss: 109209.8145; train_edge_recon_loss: 2720198.2500; train_gene_expr_recon_loss: 11293683.3511; train_masked_gp_l1_reg_loss: 102664.1487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43386.8845; train_chrom_access_recon_loss: 27850468.4885; train_global_loss: 42119610.9008; train_optim_loss: 42119610.9008; val_kl_reg_loss: 108156.9031; val_edge_recon_loss: 2709101.5667; val_gene_expr_recon_loss: 11337340.0000; val_masked_gp_l1_reg_loss: 103225.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42407.3320; val_chrom_access_recon_loss: 28246094.9333; val_global_loss: 42546325.6000; val_optim_loss: 42546325.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9711; val_auprc_score: 0.9639; val_best_acc_score: 0.9224; val_best_f1_score: 0.9254; train_kl_reg_loss: 107279.6517; train_edge_recon_loss: 2721194.4656; train_gene_expr_recon_loss: 11272241.6183; train_masked_gp_l1_reg_loss: 103921.3693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41687.3333; train_chrom_access_recon_loss: 27772342.0153; train_global_loss: 42018666.4733; train_optim_loss: 42018666.4733; val_kl_reg_loss: 105936.8135; val_edge_recon_loss: 2717815.5167; val_gene_expr_recon_loss: 11316229.7333; val_masked_gp_l1_reg_loss: 104611.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40954.2344; val_chrom_access_recon_loss: 28070817.3333; val_global_loss: 42356363.4667; val_optim_loss: 42356363.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9740; val_auprc_score: 0.9673; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 106931.8200; train_edge_recon_loss: 2713647.7023; train_gene_expr_recon_loss: 11235877.4198; train_masked_gp_l1_reg_loss: 105127.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40218.6735; train_chrom_access_recon_loss: 27665797.6336; train_global_loss: 41867600.4885; train_optim_loss: 41867600.4885; val_kl_reg_loss: 108625.2453; val_edge_recon_loss: 2725877.9000; val_gene_expr_recon_loss: 11296910.2667; val_masked_gp_l1_reg_loss: 105740.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39605.3281; val_chrom_access_recon_loss: 27937589.8667; val_global_loss: 42214349.0667; val_optim_loss: 42214349.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9743; val_auprc_score: 0.9672; val_best_acc_score: 0.9298; val_best_f1_score: 0.9326; train_kl_reg_loss: 106693.3081; train_edge_recon_loss: 2713361.9294; train_gene_expr_recon_loss: 11213021.2824; train_masked_gp_l1_reg_loss: 106328.8551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39016.1040; train_chrom_access_recon_loss: 27587649.1145; train_global_loss: 41766070.3206; train_optim_loss: 41766070.3206; val_kl_reg_loss: 106143.0333; val_edge_recon_loss: 2727434.9167; val_gene_expr_recon_loss: 11256294.6000; val_masked_gp_l1_reg_loss: 106568.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38279.8164; val_chrom_access_recon_loss: 27866993.8667; val_global_loss: 42101714.6667; val_optim_loss: 42101714.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9757; val_auprc_score: 0.9683; val_best_acc_score: 0.9307; val_best_f1_score: 0.9335; train_kl_reg_loss: 104909.3158; train_edge_recon_loss: 2704835.2824; train_gene_expr_recon_loss: 11190032.6641; train_masked_gp_l1_reg_loss: 107255.3906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37755.0075; train_chrom_access_recon_loss: 27515958.6718; train_global_loss: 41660746.3511; train_optim_loss: 41660746.3511; val_kl_reg_loss: 106717.7365; val_edge_recon_loss: 2717415.1000; val_gene_expr_recon_loss: 11272520.6667; val_masked_gp_l1_reg_loss: 107752.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37167.8398; val_chrom_access_recon_loss: 27972569.3333; val_global_loss: 42214144.5333; val_optim_loss: 42214144.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9762; val_auprc_score: 0.9684; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 103575.0865; train_edge_recon_loss: 2700943.8130; train_gene_expr_recon_loss: 11166077.7176; train_masked_gp_l1_reg_loss: 108368.6050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36656.2192; train_chrom_access_recon_loss: 27431846.1221; train_global_loss: 41547467.7557; train_optim_loss: 41547467.7557; val_kl_reg_loss: 101557.9536; val_edge_recon_loss: 2723830.4167; val_gene_expr_recon_loss: 11212548.0667; val_masked_gp_l1_reg_loss: 109035.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36163.2344; val_chrom_access_recon_loss: 27799647.2000; val_global_loss: 41982782.6667; val_optim_loss: 41982782.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9787; val_auprc_score: 0.9713; val_best_acc_score: 0.9372; val_best_f1_score: 0.9396; train_kl_reg_loss: 102925.6968; train_edge_recon_loss: 2698470.2500; train_gene_expr_recon_loss: 11146290.2672; train_masked_gp_l1_reg_loss: 109509.6633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35604.1955; train_chrom_access_recon_loss: 27366980.4580; train_global_loss: 41459780.3359; train_optim_loss: 41459780.3359; val_kl_reg_loss: 103753.6906; val_edge_recon_loss: 2713041.4333; val_gene_expr_recon_loss: 11233482.2667; val_masked_gp_l1_reg_loss: 110171.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35202.7578; val_chrom_access_recon_loss: 27827223.4667; val_global_loss: 42022875.4667; val_optim_loss: 42022875.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9248; val_auprc_score: 0.9134; val_best_acc_score: 0.8503; val_best_f1_score: 0.8594; train_kl_reg_loss: 138742.8548; train_edge_recon_loss: 2873748.2615; train_gene_expr_recon_loss: 12145277.2443; train_masked_gp_l1_reg_loss: 109476.5666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30778.7162; train_chrom_access_recon_loss: 28140775.2061; train_global_loss: 43438798.7786; train_optim_loss: 43438798.7786; val_kl_reg_loss: 13983.6271; val_edge_recon_loss: 3055275.2667; val_gene_expr_recon_loss: 12364565.4000; val_masked_gp_l1_reg_loss: 109819.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28117.3340; val_chrom_access_recon_loss: 28697499.8667; val_global_loss: 44269261.3333; val_optim_loss: 44269261.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9334; val_auprc_score: 0.9118; val_best_acc_score: 0.8746; val_best_f1_score: 0.8818; train_kl_reg_loss: 100448.2247; train_edge_recon_loss: 2820851.5649; train_gene_expr_recon_loss: 12635945.3206; train_masked_gp_l1_reg_loss: 109382.2811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26992.4816; train_chrom_access_recon_loss: 28457573.3130; train_global_loss: 44151193.0687; train_optim_loss: 44151193.0687; val_kl_reg_loss: 32015.2301; val_edge_recon_loss: 2768957.7667; val_gene_expr_recon_loss: 12951109.4667; val_masked_gp_l1_reg_loss: 107425.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26009.2344; val_chrom_access_recon_loss: 28894634.4000; val_global_loss: 44780150.9333; val_optim_loss: 44780150.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8786; val_auprc_score: 0.8605; val_best_acc_score: 0.7974; val_best_f1_score: 0.8058; train_kl_reg_loss: 65406.9461; train_edge_recon_loss: 2929276.6546; train_gene_expr_recon_loss: 13056147.1679; train_masked_gp_l1_reg_loss: 104543.6590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25406.7427; train_chrom_access_recon_loss: 28646427.5267; train_global_loss: 44827208.5191; train_optim_loss: 44827208.5191; val_kl_reg_loss: 31480.8760; val_edge_recon_loss: 2910913.4333; val_gene_expr_recon_loss: 13308977.6667; val_masked_gp_l1_reg_loss: 101169.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24728.8105; val_chrom_access_recon_loss: 29131119.6000; val_global_loss: 45508390.1333; val_optim_loss: 45508390.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8849; val_auprc_score: 0.8724; val_best_acc_score: 0.8013; val_best_f1_score: 0.8060; train_kl_reg_loss: 59472.7823; train_edge_recon_loss: 2877840.2290; train_gene_expr_recon_loss: 13186716.6489; train_masked_gp_l1_reg_loss: 100409.1492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24583.1975; train_chrom_access_recon_loss: 28697846.6107; train_global_loss: 44946868.6107; train_optim_loss: 44946868.6107; val_kl_reg_loss: 30465.5572; val_edge_recon_loss: 2926710.5500; val_gene_expr_recon_loss: 13307313.5333; val_masked_gp_l1_reg_loss: 99944.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24489.7695; val_chrom_access_recon_loss: 29187670.1333; val_global_loss: 45576594.4000; val_optim_loss: 45576594.4000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8878; val_auprc_score: 0.8698; val_best_acc_score: 0.8044; val_best_f1_score: 0.8122; train_kl_reg_loss: 56010.7306; train_edge_recon_loss: 2873863.3931; train_gene_expr_recon_loss: 13188449.7939; train_masked_gp_l1_reg_loss: 99508.8076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24403.6162; train_chrom_access_recon_loss: 28683902.1527; train_global_loss: 44926138.5954; train_optim_loss: 44926138.5954; val_kl_reg_loss: 30400.0931; val_edge_recon_loss: 2884153.6500; val_gene_expr_recon_loss: 13287575.9333; val_masked_gp_l1_reg_loss: 99059.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24310.3320; val_chrom_access_recon_loss: 29123418.6667; val_global_loss: 45448917.6000; val_optim_loss: 45448917.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8922; val_auprc_score: 0.8742; val_best_acc_score: 0.8085; val_best_f1_score: 0.8168; train_kl_reg_loss: 53869.5734; train_edge_recon_loss: 2864684.8473; train_gene_expr_recon_loss: 13173701.6947; train_masked_gp_l1_reg_loss: 98614.2067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24218.1033; train_chrom_access_recon_loss: 28660340.2595; train_global_loss: 44875428.7023; train_optim_loss: 44875428.7023; val_kl_reg_loss: 29691.8016; val_edge_recon_loss: 2873096.1167; val_gene_expr_recon_loss: 13256218.3333; val_masked_gp_l1_reg_loss: 98157.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24123.9316; val_chrom_access_recon_loss: 28999542.8000; val_global_loss: 45280830.4000; val_optim_loss: 45280830.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8966; val_auprc_score: 0.8807; val_best_acc_score: 0.8149; val_best_f1_score: 0.8227; train_kl_reg_loss: 52075.4271; train_edge_recon_loss: 2864631.0992; train_gene_expr_recon_loss: 13168505.1756; train_masked_gp_l1_reg_loss: 97696.7730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24028.5754; train_chrom_access_recon_loss: 28679866.3664; train_global_loss: 44886803.4198; train_optim_loss: 44886803.4198; val_kl_reg_loss: 30096.1664; val_edge_recon_loss: 2865228.7000; val_gene_expr_recon_loss: 13281685.1333; val_masked_gp_l1_reg_loss: 97229.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23928.9062; val_chrom_access_recon_loss: 29113339.2000; val_global_loss: 45411507.2000; val_optim_loss: 45411507.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 40 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9779
val AUPRC score: 0.9717
val best accuracy score: 0.9313
val best F1 score: 0.9339
val target rna MSE score: 4.3095
val source rna MSE score: 4.3971
val target atac MSE score: 0.1518
val source atac MSE score: 0.0327
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
