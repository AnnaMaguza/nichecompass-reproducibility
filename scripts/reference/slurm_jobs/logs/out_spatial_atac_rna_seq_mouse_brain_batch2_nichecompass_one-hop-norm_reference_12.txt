[True]
Run timestamp: 07092023_135041_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6855; val_auprc_score: 0.6704; val_best_acc_score: 0.5113; val_best_f1_score: 0.6712; train_kl_reg_loss: 58638.7282; train_edge_recon_loss: 3521096.1591; train_gene_expr_recon_loss: 12606817.4697; train_masked_gp_l1_reg_loss: 127209.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5613534.6818; train_chrom_access_recon_loss: 2066601.1932; train_global_loss: 23993897.7879; train_optim_loss: 23993897.7879; val_kl_reg_loss: 81752.8691; val_edge_recon_loss: 4064872.8438; val_gene_expr_recon_loss: 11698268.8750; val_masked_gp_l1_reg_loss: 116431.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2060644.2500; val_chrom_access_recon_loss: 1987037.3594; val_global_loss: 20009008.2500; val_optim_loss: 20009008.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6917; val_auprc_score: 0.6629; val_best_acc_score: 0.5728; val_best_f1_score: 0.6947; train_kl_reg_loss: 97389.3925; train_edge_recon_loss: 3526218.1402; train_gene_expr_recon_loss: 11403474.7727; train_masked_gp_l1_reg_loss: 113078.8169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 779072.6705; train_chrom_access_recon_loss: 1965361.0625; train_global_loss: 17884594.9091; train_optim_loss: 17884594.9091; val_kl_reg_loss: 105244.0010; val_edge_recon_loss: 4061377.8125; val_gene_expr_recon_loss: 11424678.7500; val_masked_gp_l1_reg_loss: 108715.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 259699.9844; val_chrom_access_recon_loss: 1981922.6250; val_global_loss: 17941638.0000; val_optim_loss: 17941638.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7462; val_auprc_score: 0.7205; val_best_acc_score: 0.6582; val_best_f1_score: 0.7204; train_kl_reg_loss: 95484.6542; train_edge_recon_loss: 3519282.6742; train_gene_expr_recon_loss: 11199006.4091; train_masked_gp_l1_reg_loss: 108258.2997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 189589.4628; train_chrom_access_recon_loss: 1944566.3977; train_global_loss: 17056187.6818; train_optim_loss: 17056187.6818; val_kl_reg_loss: 99118.8613; val_edge_recon_loss: 4048583.2812; val_gene_expr_recon_loss: 11185054.3750; val_masked_gp_l1_reg_loss: 109000.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150265.6875; val_chrom_access_recon_loss: 1926906.5156; val_global_loss: 17518928.2500; val_optim_loss: 17518928.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7870; val_auprc_score: 0.7604; val_best_acc_score: 0.6722; val_best_f1_score: 0.7397; train_kl_reg_loss: 85845.4038; train_edge_recon_loss: 3506677.4735; train_gene_expr_recon_loss: 11096696.9242; train_masked_gp_l1_reg_loss: 109812.1558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132312.9197; train_chrom_access_recon_loss: 1929863.7670; train_global_loss: 16861208.7121; train_optim_loss: 16861208.7121; val_kl_reg_loss: 87138.7578; val_edge_recon_loss: 3948287.6875; val_gene_expr_recon_loss: 11194626.0000; val_masked_gp_l1_reg_loss: 110884.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119420.1484; val_chrom_access_recon_loss: 1935173.9375; val_global_loss: 17395531.7500; val_optim_loss: 17395531.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8083; val_auprc_score: 0.7845; val_best_acc_score: 0.7405; val_best_f1_score: 0.7708; train_kl_reg_loss: 69988.5475; train_edge_recon_loss: 3400007.2500; train_gene_expr_recon_loss: 11046235.5606; train_masked_gp_l1_reg_loss: 113574.2378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112060.6183; train_chrom_access_recon_loss: 1921998.4811; train_global_loss: 16663864.7121; train_optim_loss: 16663864.7121; val_kl_reg_loss: 67342.2051; val_edge_recon_loss: 3299608.9062; val_gene_expr_recon_loss: 11172604.2500; val_masked_gp_l1_reg_loss: 118135.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106905.2578; val_chrom_access_recon_loss: 1943272.6406; val_global_loss: 16707867.8750; val_optim_loss: 16707867.8750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8267; val_auprc_score: 0.8025; val_best_acc_score: 0.7380; val_best_f1_score: 0.7882; train_kl_reg_loss: 80219.9781; train_edge_recon_loss: 3101953.2386; train_gene_expr_recon_loss: 11013945.8030; train_masked_gp_l1_reg_loss: 126662.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104956.4741; train_chrom_access_recon_loss: 1910124.3428; train_global_loss: 16337862.0455; train_optim_loss: 16337862.0455; val_kl_reg_loss: 97690.1494; val_edge_recon_loss: 2992014.9375; val_gene_expr_recon_loss: 11041052.6250; val_masked_gp_l1_reg_loss: 128708.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100598.6328; val_chrom_access_recon_loss: 1904301.9844; val_global_loss: 16264366.7500; val_optim_loss: 16264366.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8449; val_auprc_score: 0.8161; val_best_acc_score: 0.7509; val_best_f1_score: 0.7917; train_kl_reg_loss: 102840.7796; train_edge_recon_loss: 2965951.4470; train_gene_expr_recon_loss: 10927363.1212; train_masked_gp_l1_reg_loss: 128978.0600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96470.5729; train_chrom_access_recon_loss: 1897587.9261; train_global_loss: 16119191.9394; train_optim_loss: 16119191.9394; val_kl_reg_loss: 102595.8926; val_edge_recon_loss: 2957178.8125; val_gene_expr_recon_loss: 11072469.0000; val_masked_gp_l1_reg_loss: 129514.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93034.2578; val_chrom_access_recon_loss: 1911521.6719; val_global_loss: 16266314.3750; val_optim_loss: 16266314.3750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8533; val_auprc_score: 0.8250; val_best_acc_score: 0.7706; val_best_f1_score: 0.7993; train_kl_reg_loss: 104757.7926; train_edge_recon_loss: 2920487.9659; train_gene_expr_recon_loss: 10870430.7121; train_masked_gp_l1_reg_loss: 130357.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91143.7186; train_chrom_access_recon_loss: 1889664.5682; train_global_loss: 16006841.7121; train_optim_loss: 16006841.7121; val_kl_reg_loss: 98013.3369; val_edge_recon_loss: 2923981.5000; val_gene_expr_recon_loss: 10995689.2500; val_masked_gp_l1_reg_loss: 130989.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88878.8516; val_chrom_access_recon_loss: 1896535.1094; val_global_loss: 16134087.1250; val_optim_loss: 16134087.1250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8697; val_auprc_score: 0.8390; val_best_acc_score: 0.7945; val_best_f1_score: 0.8161; train_kl_reg_loss: 102935.0283; train_edge_recon_loss: 2898857.9621; train_gene_expr_recon_loss: 10816005.5909; train_masked_gp_l1_reg_loss: 132110.1076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87714.5565; train_chrom_access_recon_loss: 1880532.0758; train_global_loss: 15918155.1818; train_optim_loss: 15918155.1818; val_kl_reg_loss: 99871.2979; val_edge_recon_loss: 2894845.7500; val_gene_expr_recon_loss: 10919175.1250; val_masked_gp_l1_reg_loss: 133322.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87119.6953; val_chrom_access_recon_loss: 1873645.7031; val_global_loss: 16007981.1250; val_optim_loss: 16007981.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8806; val_auprc_score: 0.8511; val_best_acc_score: 0.8047; val_best_f1_score: 0.8200; train_kl_reg_loss: 101934.9246; train_edge_recon_loss: 2880475.9318; train_gene_expr_recon_loss: 10766758.9242; train_masked_gp_l1_reg_loss: 134267.9477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86608.8633; train_chrom_access_recon_loss: 1873092.2481; train_global_loss: 15843138.7576; train_optim_loss: 15843138.7576; val_kl_reg_loss: 105548.1816; val_edge_recon_loss: 2911604.2812; val_gene_expr_recon_loss: 10969349.2500; val_masked_gp_l1_reg_loss: 135357.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86672.8984; val_chrom_access_recon_loss: 1895884.0312; val_global_loss: 16104416.7500; val_optim_loss: 16104416.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8752; val_auprc_score: 0.8369; val_best_acc_score: 0.8084; val_best_f1_score: 0.8287; train_kl_reg_loss: 104695.2267; train_edge_recon_loss: 2843659.1174; train_gene_expr_recon_loss: 10720805.4242; train_masked_gp_l1_reg_loss: 136599.4991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86854.5534; train_chrom_access_recon_loss: 1865746.8864; train_global_loss: 15758360.8333; train_optim_loss: 15758360.8333; val_kl_reg_loss: 111079.7832; val_edge_recon_loss: 2898582.1250; val_gene_expr_recon_loss: 10811216.8750; val_masked_gp_l1_reg_loss: 137399.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86648.3359; val_chrom_access_recon_loss: 1869078.3438; val_global_loss: 15914004.1250; val_optim_loss: 15914004.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8953; val_auprc_score: 0.8646; val_best_acc_score: 0.8232; val_best_f1_score: 0.8427; train_kl_reg_loss: 105345.2302; train_edge_recon_loss: 2822418.1439; train_gene_expr_recon_loss: 10668927.7121; train_masked_gp_l1_reg_loss: 138438.4238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86729.3333; train_chrom_access_recon_loss: 1857841.2311; train_global_loss: 15679700.1061; train_optim_loss: 15679700.1061; val_kl_reg_loss: 97718.7061; val_edge_recon_loss: 2827848.4375; val_gene_expr_recon_loss: 10771631.5000; val_masked_gp_l1_reg_loss: 139663.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86944.2109; val_chrom_access_recon_loss: 1834298.7344; val_global_loss: 15758104.5000; val_optim_loss: 15758104.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8922; val_auprc_score: 0.8591; val_best_acc_score: 0.8248; val_best_f1_score: 0.8413; train_kl_reg_loss: 104019.0445; train_edge_recon_loss: 2819356.8674; train_gene_expr_recon_loss: 10631282.1061; train_masked_gp_l1_reg_loss: 140408.4505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86718.3865; train_chrom_access_recon_loss: 1849033.4299; train_global_loss: 15630818.2879; train_optim_loss: 15630818.2879; val_kl_reg_loss: 108650.9365; val_edge_recon_loss: 2836255.7812; val_gene_expr_recon_loss: 10785348.2500; val_masked_gp_l1_reg_loss: 141193.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86283.0781; val_chrom_access_recon_loss: 1855284.5312; val_global_loss: 15813016.5000; val_optim_loss: 15813016.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8860; val_auprc_score: 0.8471; val_best_acc_score: 0.8240; val_best_f1_score: 0.8405; train_kl_reg_loss: 105375.2141; train_edge_recon_loss: 2803647.5038; train_gene_expr_recon_loss: 10602912.9091; train_masked_gp_l1_reg_loss: 141743.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86095.0479; train_chrom_access_recon_loss: 1845682.5511; train_global_loss: 15585457.0606; train_optim_loss: 15585457.0606; val_kl_reg_loss: 106134.3555; val_edge_recon_loss: 2871470.5625; val_gene_expr_recon_loss: 10684752.1250; val_masked_gp_l1_reg_loss: 142584.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86705.1484; val_chrom_access_recon_loss: 1847242.5156; val_global_loss: 15738888.8750; val_optim_loss: 15738888.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8958; val_auprc_score: 0.8564; val_best_acc_score: 0.8345; val_best_f1_score: 0.8497; train_kl_reg_loss: 106695.6139; train_edge_recon_loss: 2799038.1856; train_gene_expr_recon_loss: 10568428.1212; train_masked_gp_l1_reg_loss: 143066.5938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86621.6976; train_chrom_access_recon_loss: 1840515.7822; train_global_loss: 15544365.9545; train_optim_loss: 15544365.9545; val_kl_reg_loss: 104745.3584; val_edge_recon_loss: 2843236.5000; val_gene_expr_recon_loss: 10600944.1250; val_masked_gp_l1_reg_loss: 143593.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86525.1953; val_chrom_access_recon_loss: 1834037.6719; val_global_loss: 15613082.5000; val_optim_loss: 15613082.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9153; val_auprc_score: 0.8884; val_best_acc_score: 0.8517; val_best_f1_score: 0.8601; train_kl_reg_loss: 102811.6568; train_edge_recon_loss: 2792369.2538; train_gene_expr_recon_loss: 10525090.2727; train_masked_gp_l1_reg_loss: 144121.0829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86858.3509; train_chrom_access_recon_loss: 1834173.7102; train_global_loss: 15485424.3030; train_optim_loss: 15485424.3030; val_kl_reg_loss: 106337.6250; val_edge_recon_loss: 2823957.2812; val_gene_expr_recon_loss: 10558610.2500; val_masked_gp_l1_reg_loss: 144789.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87459.5547; val_chrom_access_recon_loss: 1823750.6875; val_global_loss: 15544905.7500; val_optim_loss: 15544905.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9126; val_auprc_score: 0.8863; val_best_acc_score: 0.8461; val_best_f1_score: 0.8597; train_kl_reg_loss: 103408.9154; train_edge_recon_loss: 2781220.6932; train_gene_expr_recon_loss: 10495198.9394; train_masked_gp_l1_reg_loss: 145231.1470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87763.7273; train_chrom_access_recon_loss: 1828982.7424; train_global_loss: 15441806.1515; train_optim_loss: 15441806.1515; val_kl_reg_loss: 107821.1016; val_edge_recon_loss: 2826432.6562; val_gene_expr_recon_loss: 10585818.3750; val_masked_gp_l1_reg_loss: 145798.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88300.2969; val_chrom_access_recon_loss: 1845418.2656; val_global_loss: 15599589.2500; val_optim_loss: 15599589.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9117; val_auprc_score: 0.8810; val_best_acc_score: 0.8479; val_best_f1_score: 0.8595; train_kl_reg_loss: 104804.6342; train_edge_recon_loss: 2764525.7462; train_gene_expr_recon_loss: 10467440.2576; train_masked_gp_l1_reg_loss: 146120.7810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87900.8772; train_chrom_access_recon_loss: 1823165.6250; train_global_loss: 15393957.8636; train_optim_loss: 15393957.8636; val_kl_reg_loss: 107404.5596; val_edge_recon_loss: 2814499.4688; val_gene_expr_recon_loss: 10639505.5000; val_masked_gp_l1_reg_loss: 146578.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87395.9297; val_chrom_access_recon_loss: 1835110.8906; val_global_loss: 15630494.3750; val_optim_loss: 15630494.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9172; val_auprc_score: 0.8877; val_best_acc_score: 0.8598; val_best_f1_score: 0.8684; train_kl_reg_loss: 105710.6889; train_edge_recon_loss: 2768301.8864; train_gene_expr_recon_loss: 10445122.9697; train_masked_gp_l1_reg_loss: 146679.0417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87260.8756; train_chrom_access_recon_loss: 1818408.6042; train_global_loss: 15371484.1212; train_optim_loss: 15371484.1212; val_kl_reg_loss: 103476.3184; val_edge_recon_loss: 2778310.9688; val_gene_expr_recon_loss: 10541525.6250; val_masked_gp_l1_reg_loss: 147187.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87547.3594; val_chrom_access_recon_loss: 1821986.0781; val_global_loss: 15480033.0000; val_optim_loss: 15480033.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9159; val_auprc_score: 0.8864; val_best_acc_score: 0.8549; val_best_f1_score: 0.8645; train_kl_reg_loss: 102328.1387; train_edge_recon_loss: 2773748.7197; train_gene_expr_recon_loss: 10411570.2121; train_masked_gp_l1_reg_loss: 147832.9756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87231.0527; train_chrom_access_recon_loss: 1812595.4678; train_global_loss: 15335306.5758; train_optim_loss: 15335306.5758; val_kl_reg_loss: 102390.6572; val_edge_recon_loss: 2830786.1875; val_gene_expr_recon_loss: 10562028.5000; val_masked_gp_l1_reg_loss: 151981.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86727.4297; val_chrom_access_recon_loss: 1813155.5000; val_global_loss: 15547068.7500; val_optim_loss: 15547068.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9156; val_auprc_score: 0.8886; val_best_acc_score: 0.8557; val_best_f1_score: 0.8684; train_kl_reg_loss: 103236.7805; train_edge_recon_loss: 2757928.5568; train_gene_expr_recon_loss: 10392154.1970; train_masked_gp_l1_reg_loss: 152961.8250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86493.9697; train_chrom_access_recon_loss: 1809340.3371; train_global_loss: 15302115.8182; train_optim_loss: 15302115.8182; val_kl_reg_loss: 105316.1211; val_edge_recon_loss: 2812558.8438; val_gene_expr_recon_loss: 10469553.1250; val_masked_gp_l1_reg_loss: 152756.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86666.2109; val_chrom_access_recon_loss: 1811749.5156; val_global_loss: 15438600.6250; val_optim_loss: 15438600.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9174; val_auprc_score: 0.8885; val_best_acc_score: 0.8568; val_best_f1_score: 0.8677; train_kl_reg_loss: 102963.5799; train_edge_recon_loss: 2760401.9280; train_gene_expr_recon_loss: 10370764.3636; train_masked_gp_l1_reg_loss: 152124.7237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85823.0845; train_chrom_access_recon_loss: 1804982.9091; train_global_loss: 15277060.4697; train_optim_loss: 15277060.4697; val_kl_reg_loss: 101092.3193; val_edge_recon_loss: 2804364.4375; val_gene_expr_recon_loss: 10454068.0000; val_masked_gp_l1_reg_loss: 151860.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85866.4844; val_chrom_access_recon_loss: 1802527.8594; val_global_loss: 15399778.5000; val_optim_loss: 15399778.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9262; val_auprc_score: 0.9021; val_best_acc_score: 0.8684; val_best_f1_score: 0.8755; train_kl_reg_loss: 103147.5142; train_edge_recon_loss: 2747013.4735; train_gene_expr_recon_loss: 10345746.6364; train_masked_gp_l1_reg_loss: 151464.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85124.7823; train_chrom_access_recon_loss: 1800570.6780; train_global_loss: 15233067.8485; train_optim_loss: 15233067.8485; val_kl_reg_loss: 103782.6992; val_edge_recon_loss: 2770985.8125; val_gene_expr_recon_loss: 10496194.5000; val_masked_gp_l1_reg_loss: 151206.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85023.6484; val_chrom_access_recon_loss: 1815038.9219; val_global_loss: 15422233.1250; val_optim_loss: 15422233.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9267; val_auprc_score: 0.9012; val_best_acc_score: 0.8689; val_best_f1_score: 0.8765; train_kl_reg_loss: 101861.3960; train_edge_recon_loss: 2754504.1250; train_gene_expr_recon_loss: 10325821.2121; train_masked_gp_l1_reg_loss: 150971.2836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84524.0142; train_chrom_access_recon_loss: 1796529.3295; train_global_loss: 15214211.2424; train_optim_loss: 15214211.2424; val_kl_reg_loss: 100632.8828; val_edge_recon_loss: 2782401.5312; val_gene_expr_recon_loss: 10517150.1250; val_masked_gp_l1_reg_loss: 151060.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84768.3750; val_chrom_access_recon_loss: 1824702.1094; val_global_loss: 15460715.5000; val_optim_loss: 15460715.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9219; val_auprc_score: 0.8919; val_best_acc_score: 0.8681; val_best_f1_score: 0.8754; train_kl_reg_loss: 101637.3891; train_edge_recon_loss: 2759425.4394; train_gene_expr_recon_loss: 10306608.2121; train_masked_gp_l1_reg_loss: 150687.7088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83836.3926; train_chrom_access_recon_loss: 1792292.8030; train_global_loss: 15194488.0000; train_optim_loss: 15194488.0000; val_kl_reg_loss: 101194.5908; val_edge_recon_loss: 2795337.5000; val_gene_expr_recon_loss: 10412555.1250; val_masked_gp_l1_reg_loss: 150634.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83692.1641; val_chrom_access_recon_loss: 1802612.4844; val_global_loss: 15346025.7500; val_optim_loss: 15346025.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9338; val_auprc_score: 0.9053; val_best_acc_score: 0.8780; val_best_f1_score: 0.8847; train_kl_reg_loss: 110617.7083; train_edge_recon_loss: 2786767.2727; train_gene_expr_recon_loss: 10009463.9242; train_masked_gp_l1_reg_loss: 149527.4337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82907.7504; train_chrom_access_recon_loss: 1747887.7235; train_global_loss: 14887171.9394; train_optim_loss: 14887171.9394; val_kl_reg_loss: 69349.3271; val_edge_recon_loss: 2749857.8125; val_gene_expr_recon_loss: 10154846.8750; val_masked_gp_l1_reg_loss: 149682.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83568.5703; val_chrom_access_recon_loss: 1760306.4688; val_global_loss: 14967612.6250; val_optim_loss: 14967612.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9277; val_auprc_score: 0.9015; val_best_acc_score: 0.8732; val_best_f1_score: 0.8806; train_kl_reg_loss: 107676.1697; train_edge_recon_loss: 2759934.1212; train_gene_expr_recon_loss: 9994584.4394; train_masked_gp_l1_reg_loss: 149783.9931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83806.2493; train_chrom_access_recon_loss: 1737586.4697; train_global_loss: 14833371.4697; train_optim_loss: 14833371.4697; val_kl_reg_loss: 75304.4346; val_edge_recon_loss: 2796349.6562; val_gene_expr_recon_loss: 10058823.1250; val_masked_gp_l1_reg_loss: 149958.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83843.8125; val_chrom_access_recon_loss: 1730517.5938; val_global_loss: 14894797.5000; val_optim_loss: 14894797.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9350; val_auprc_score: 0.9142; val_best_acc_score: 0.8748; val_best_f1_score: 0.8820; train_kl_reg_loss: 102448.0400; train_edge_recon_loss: 2755629.8409; train_gene_expr_recon_loss: 9960720.1818; train_masked_gp_l1_reg_loss: 149827.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83717.4851; train_chrom_access_recon_loss: 1729755.8617; train_global_loss: 14782099.3788; train_optim_loss: 14782099.3788; val_kl_reg_loss: 77982.9014; val_edge_recon_loss: 2783137.6875; val_gene_expr_recon_loss: 10102782.0000; val_masked_gp_l1_reg_loss: 149857.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83401.5312; val_chrom_access_recon_loss: 1748133.0781; val_global_loss: 14945295.7500; val_optim_loss: 14945295.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9253; val_auprc_score: 0.8982; val_best_acc_score: 0.8700; val_best_f1_score: 0.8784; train_kl_reg_loss: 99796.7319; train_edge_recon_loss: 2747629.1212; train_gene_expr_recon_loss: 9948883.9242; train_masked_gp_l1_reg_loss: 149535.2569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83306.1706; train_chrom_access_recon_loss: 1725704.3958; train_global_loss: 14754855.5606; train_optim_loss: 14754855.5606; val_kl_reg_loss: 82390.4658; val_edge_recon_loss: 2795261.8438; val_gene_expr_recon_loss: 10092268.1250; val_masked_gp_l1_reg_loss: 149408.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83262.2500; val_chrom_access_recon_loss: 1742772.6406; val_global_loss: 14945363.0000; val_optim_loss: 14945363.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9272; val_auprc_score: 0.8995; val_best_acc_score: 0.8740; val_best_f1_score: 0.8827; train_kl_reg_loss: 96721.5768; train_edge_recon_loss: 2739475.0947; train_gene_expr_recon_loss: 9921544.0303; train_masked_gp_l1_reg_loss: 149116.0665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82982.8670; train_chrom_access_recon_loss: 1718053.9545; train_global_loss: 14707893.6061; train_optim_loss: 14707893.6061; val_kl_reg_loss: 80834.0010; val_edge_recon_loss: 2811139.7812; val_gene_expr_recon_loss: 10034808.2500; val_masked_gp_l1_reg_loss: 148894.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82557.1719; val_chrom_access_recon_loss: 1719956.6719; val_global_loss: 14878190.1250; val_optim_loss: 14878190.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9338; val_auprc_score: 0.9045; val_best_acc_score: 0.8767; val_best_f1_score: 0.8854; train_kl_reg_loss: 96118.2929; train_edge_recon_loss: 2730778.7576; train_gene_expr_recon_loss: 9905791.0606; train_masked_gp_l1_reg_loss: 148708.2562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82480.9125; train_chrom_access_recon_loss: 1714256.2652; train_global_loss: 14678133.6212; train_optim_loss: 14678133.6212; val_kl_reg_loss: 89192.4980; val_edge_recon_loss: 2774225.0312; val_gene_expr_recon_loss: 10022008.8750; val_masked_gp_l1_reg_loss: 148224.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82070.0859; val_chrom_access_recon_loss: 1728905.4531; val_global_loss: 14844627.0000; val_optim_loss: 14844627.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9372; val_auprc_score: 0.9080; val_best_acc_score: 0.8847; val_best_f1_score: 0.8904; train_kl_reg_loss: 94843.3300; train_edge_recon_loss: 2734502.6061; train_gene_expr_recon_loss: 9897205.3485; train_masked_gp_l1_reg_loss: 148090.0092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81919.4001; train_chrom_access_recon_loss: 1713751.4659; train_global_loss: 14670312.3030; train_optim_loss: 14670312.3030; val_kl_reg_loss: 86146.3047; val_edge_recon_loss: 2771719.5625; val_gene_expr_recon_loss: 10039336.8750; val_masked_gp_l1_reg_loss: 148075.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82243.5781; val_chrom_access_recon_loss: 1713149.9375; val_global_loss: 14840671.7500; val_optim_loss: 14840671.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9416; val_auprc_score: 0.9208; val_best_acc_score: 0.8847; val_best_f1_score: 0.8925; train_kl_reg_loss: 94879.7195; train_edge_recon_loss: 2724644.5871; train_gene_expr_recon_loss: 9874377.9394; train_masked_gp_l1_reg_loss: 147813.9815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81485.0663; train_chrom_access_recon_loss: 1709415.8068; train_global_loss: 14632617.0758; train_optim_loss: 14632617.0758; val_kl_reg_loss: 89250.8223; val_edge_recon_loss: 2761596.8750; val_gene_expr_recon_loss: 9875348.1250; val_masked_gp_l1_reg_loss: 147525.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81456.0312; val_chrom_access_recon_loss: 1707650.9219; val_global_loss: 14662827.5000; val_optim_loss: 14662827.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9371; val_auprc_score: 0.9095; val_best_acc_score: 0.8847; val_best_f1_score: 0.8913; train_kl_reg_loss: 95747.5829; train_edge_recon_loss: 2731433.5303; train_gene_expr_recon_loss: 9868751.8939; train_masked_gp_l1_reg_loss: 147346.1669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81169.4411; train_chrom_access_recon_loss: 1709824.3030; train_global_loss: 14634272.8636; train_optim_loss: 14634272.8636; val_kl_reg_loss: 89291.5527; val_edge_recon_loss: 2749324.0625; val_gene_expr_recon_loss: 10045222.6250; val_masked_gp_l1_reg_loss: 147091.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81026.4531; val_chrom_access_recon_loss: 1728809.7500; val_global_loss: 14840764.7500; val_optim_loss: 14840764.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9472; val_auprc_score: 0.9328; val_best_acc_score: 0.8882; val_best_f1_score: 0.8923; train_kl_reg_loss: 93977.7867; train_edge_recon_loss: 2729375.7197; train_gene_expr_recon_loss: 9845674.2879; train_masked_gp_l1_reg_loss: 146882.3535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80816.5594; train_chrom_access_recon_loss: 1704542.6212; train_global_loss: 14601269.4242; train_optim_loss: 14601269.4242; val_kl_reg_loss: 90069.7246; val_edge_recon_loss: 2747471.5312; val_gene_expr_recon_loss: 10000012.5000; val_masked_gp_l1_reg_loss: 146619.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80513.2734; val_chrom_access_recon_loss: 1709275.3438; val_global_loss: 14773962.0000; val_optim_loss: 14773962.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9507; val_auprc_score: 0.9364; val_best_acc_score: 0.8947; val_best_f1_score: 0.8997; train_kl_reg_loss: 93113.6396; train_edge_recon_loss: 2725882.0720; train_gene_expr_recon_loss: 9834990.7576; train_masked_gp_l1_reg_loss: 146527.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80453.7171; train_chrom_access_recon_loss: 1701354.0511; train_global_loss: 14582321.3788; train_optim_loss: 14582321.3788; val_kl_reg_loss: 91849.5820; val_edge_recon_loss: 2720415.1875; val_gene_expr_recon_loss: 9899619.2500; val_masked_gp_l1_reg_loss: 146648.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80578.8438; val_chrom_access_recon_loss: 1692837.5625; val_global_loss: 14631949.7500; val_optim_loss: 14631949.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9441; val_auprc_score: 0.9243; val_best_acc_score: 0.8874; val_best_f1_score: 0.8935; train_kl_reg_loss: 94350.3066; train_edge_recon_loss: 2716362.1629; train_gene_expr_recon_loss: 9816786.2727; train_masked_gp_l1_reg_loss: 146488.0320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80404.8761; train_chrom_access_recon_loss: 1698190.9413; train_global_loss: 14552582.6212; train_optim_loss: 14552582.6212; val_kl_reg_loss: 91214.6992; val_edge_recon_loss: 2760810.1875; val_gene_expr_recon_loss: 9972943.3750; val_masked_gp_l1_reg_loss: 146289.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80636.2031; val_chrom_access_recon_loss: 1717316.7969; val_global_loss: 14769211.1250; val_optim_loss: 14769211.1250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9472; val_auprc_score: 0.9280; val_best_acc_score: 0.8912; val_best_f1_score: 0.8975; train_kl_reg_loss: 93472.3615; train_edge_recon_loss: 2727080.7311; train_gene_expr_recon_loss: 9806934.4848; train_masked_gp_l1_reg_loss: 146223.4969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80180.7908; train_chrom_access_recon_loss: 1696930.0739; train_global_loss: 14550822.0606; train_optim_loss: 14550822.0606; val_kl_reg_loss: 91374.0420; val_edge_recon_loss: 2761055.3125; val_gene_expr_recon_loss: 9978611.2500; val_masked_gp_l1_reg_loss: 146125.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79881.2266; val_chrom_access_recon_loss: 1714799.6719; val_global_loss: 14771847.2500; val_optim_loss: 14771847.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9446; val_auprc_score: 0.9254; val_best_acc_score: 0.8885; val_best_f1_score: 0.8951; train_kl_reg_loss: 93325.4123; train_edge_recon_loss: 2716254.6856; train_gene_expr_recon_loss: 9796911.8788; train_masked_gp_l1_reg_loss: 145975.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80032.6133; train_chrom_access_recon_loss: 1695353.3068; train_global_loss: 14527853.2727; train_optim_loss: 14527853.2727; val_kl_reg_loss: 91187.8154; val_edge_recon_loss: 2762563.5938; val_gene_expr_recon_loss: 9970438.2500; val_masked_gp_l1_reg_loss: 145963.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79834.6875; val_chrom_access_recon_loss: 1689433.3750; val_global_loss: 14739421.0000; val_optim_loss: 14739421.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9490; val_auprc_score: 0.9292; val_best_acc_score: 0.8944; val_best_f1_score: 0.9007; train_kl_reg_loss: 93667.3430; train_edge_recon_loss: 2724185.8561; train_gene_expr_recon_loss: 9783219.5455; train_masked_gp_l1_reg_loss: 145846.2801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79947.7625; train_chrom_access_recon_loss: 1691969.0000; train_global_loss: 14518835.7424; train_optim_loss: 14518835.7424; val_kl_reg_loss: 94221.3682; val_edge_recon_loss: 2750260.2500; val_gene_expr_recon_loss: 10005243.3750; val_masked_gp_l1_reg_loss: 145545.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79798.5625; val_chrom_access_recon_loss: 1721903.8750; val_global_loss: 14796972.7500; val_optim_loss: 14796972.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9422; val_auprc_score: 0.9181; val_best_acc_score: 0.8890; val_best_f1_score: 0.8953; train_kl_reg_loss: 95221.1766; train_edge_recon_loss: 2715389.8598; train_gene_expr_recon_loss: 9774923.1818; train_masked_gp_l1_reg_loss: 143611.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62613.8715; train_chrom_access_recon_loss: 1690742.3087; train_global_loss: 14482501.4242; train_optim_loss: 14482501.4242; val_kl_reg_loss: 93012.1016; val_edge_recon_loss: 2756868.5312; val_gene_expr_recon_loss: 9880087.6250; val_masked_gp_l1_reg_loss: 142918.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59397.3320; val_chrom_access_recon_loss: 1694947.9062; val_global_loss: 14627231.1250; val_optim_loss: 14627231.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9473; val_auprc_score: 0.9256; val_best_acc_score: 0.8907; val_best_f1_score: 0.8961; train_kl_reg_loss: 95655.1446; train_edge_recon_loss: 2706274.5947; train_gene_expr_recon_loss: 9767630.1818; train_masked_gp_l1_reg_loss: 142756.4543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59210.2098; train_chrom_access_recon_loss: 1688506.1420; train_global_loss: 14460032.7576; train_optim_loss: 14460032.7576; val_kl_reg_loss: 94635.7432; val_edge_recon_loss: 2772510.8125; val_gene_expr_recon_loss: 9931112.7500; val_masked_gp_l1_reg_loss: 142647.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59095.0078; val_chrom_access_recon_loss: 1700282.5312; val_global_loss: 14700284.7500; val_optim_loss: 14700284.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9516; val_auprc_score: 0.9373; val_best_acc_score: 0.8982; val_best_f1_score: 0.9017; train_kl_reg_loss: 96066.4280; train_edge_recon_loss: 2707049.6364; train_gene_expr_recon_loss: 9762058.2424; train_masked_gp_l1_reg_loss: 142610.4631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59033.3387; train_chrom_access_recon_loss: 1687720.8030; train_global_loss: 14454538.7727; train_optim_loss: 14454538.7727; val_kl_reg_loss: 94111.2480; val_edge_recon_loss: 2746640.9375; val_gene_expr_recon_loss: 9948630.2500; val_masked_gp_l1_reg_loss: 142546.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58885.8125; val_chrom_access_recon_loss: 1710966.7188; val_global_loss: 14701781.2500; val_optim_loss: 14701781.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9488; val_auprc_score: 0.9301; val_best_acc_score: 0.8920; val_best_f1_score: 0.8970; train_kl_reg_loss: 95801.8430; train_edge_recon_loss: 2707913.0000; train_gene_expr_recon_loss: 9762562.7424; train_masked_gp_l1_reg_loss: 142516.0400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58831.1300; train_chrom_access_recon_loss: 1688596.2595; train_global_loss: 14456220.9394; train_optim_loss: 14456220.9394; val_kl_reg_loss: 93233.0674; val_edge_recon_loss: 2760724.4375; val_gene_expr_recon_loss: 9875557.3750; val_masked_gp_l1_reg_loss: 142493.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58766.5195; val_chrom_access_recon_loss: 1689727.0469; val_global_loss: 14620502.0000; val_optim_loss: 14620502.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9491; val_auprc_score: 0.9272; val_best_acc_score: 0.8984; val_best_f1_score: 0.9020; train_kl_reg_loss: 95477.7334; train_edge_recon_loss: 2714965.3485; train_gene_expr_recon_loss: 9764619.4848; train_masked_gp_l1_reg_loss: 142485.6508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58719.6373; train_chrom_access_recon_loss: 1689406.2348; train_global_loss: 14465674.1061; train_optim_loss: 14465674.1061; val_kl_reg_loss: 94118.8232; val_edge_recon_loss: 2748204.5312; val_gene_expr_recon_loss: 9894408.7500; val_masked_gp_l1_reg_loss: 142450.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58641.2266; val_chrom_access_recon_loss: 1691499.5000; val_global_loss: 14629323.7500; val_optim_loss: 14629323.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9488; val_auprc_score: 0.9279; val_best_acc_score: 0.8990; val_best_f1_score: 0.9045; train_kl_reg_loss: 95694.7382; train_edge_recon_loss: 2708537.2462; train_gene_expr_recon_loss: 9769730.4091; train_masked_gp_l1_reg_loss: 142434.4150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58533.8632; train_chrom_access_recon_loss: 1688788.3769; train_global_loss: 14463719.1515; train_optim_loss: 14463719.1515; val_kl_reg_loss: 94057.8018; val_edge_recon_loss: 2732142.6562; val_gene_expr_recon_loss: 9886814.5000; val_masked_gp_l1_reg_loss: 142426.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58458.5898; val_chrom_access_recon_loss: 1695954.9375; val_global_loss: 14609854.7500; val_optim_loss: 14609854.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9402; val_auprc_score: 0.9149; val_best_acc_score: 0.8896; val_best_f1_score: 0.8963; train_kl_reg_loss: 96220.7285; train_edge_recon_loss: 2713062.1364; train_gene_expr_recon_loss: 9763012.1667; train_masked_gp_l1_reg_loss: 142418.1688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58416.6516; train_chrom_access_recon_loss: 1687158.4318; train_global_loss: 14460288.1970; train_optim_loss: 14460288.1970; val_kl_reg_loss: 94677.4062; val_edge_recon_loss: 2753528.1875; val_gene_expr_recon_loss: 9841751.2500; val_masked_gp_l1_reg_loss: 142380.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58349.1992; val_chrom_access_recon_loss: 1696196.6250; val_global_loss: 14586882.5000; val_optim_loss: 14586882.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9516; val_auprc_score: 0.9335; val_best_acc_score: 0.8990; val_best_f1_score: 0.9025; train_kl_reg_loss: 96600.6377; train_edge_recon_loss: 2706855.1174; train_gene_expr_recon_loss: 9758031.1515; train_masked_gp_l1_reg_loss: 142365.2176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58279.1460; train_chrom_access_recon_loss: 1687380.4053; train_global_loss: 14449511.6667; train_optim_loss: 14449511.6667; val_kl_reg_loss: 95020.9434; val_edge_recon_loss: 2729740.6562; val_gene_expr_recon_loss: 9881845.2500; val_masked_gp_l1_reg_loss: 142359.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58290.5586; val_chrom_access_recon_loss: 1700587.5781; val_global_loss: 14607844.5000; val_optim_loss: 14607844.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9447; val_auprc_score: 0.9225; val_best_acc_score: 0.8866; val_best_f1_score: 0.8937; train_kl_reg_loss: 97040.4280; train_edge_recon_loss: 2710187.8485; train_gene_expr_recon_loss: 9762869.6970; train_masked_gp_l1_reg_loss: 142340.1631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58248.3664; train_chrom_access_recon_loss: 1687557.6023; train_global_loss: 14458244.0152; train_optim_loss: 14458244.0152; val_kl_reg_loss: 95348.4971; val_edge_recon_loss: 2767228.9062; val_gene_expr_recon_loss: 9922882.3750; val_masked_gp_l1_reg_loss: 142317.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58238.7930; val_chrom_access_recon_loss: 1690691.5312; val_global_loss: 14676708.1250; val_optim_loss: 14676708.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9521; val_auprc_score: 0.9309; val_best_acc_score: 0.8971; val_best_f1_score: 0.9009; train_kl_reg_loss: 96836.4783; train_edge_recon_loss: 2711057.9129; train_gene_expr_recon_loss: 9760414.7121; train_masked_gp_l1_reg_loss: 142306.0606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58138.0185; train_chrom_access_recon_loss: 1687038.6212; train_global_loss: 14455791.7576; train_optim_loss: 14455791.7576; val_kl_reg_loss: 93797.4873; val_edge_recon_loss: 2749301.8125; val_gene_expr_recon_loss: 9945165.1250; val_masked_gp_l1_reg_loss: 142266.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58040.9180; val_chrom_access_recon_loss: 1709892.7031; val_global_loss: 14698465.1250; val_optim_loss: 14698465.1250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9512; val_auprc_score: 0.9302; val_best_acc_score: 0.8963; val_best_f1_score: 0.9011; train_kl_reg_loss: 96605.9695; train_edge_recon_loss: 2700292.0947; train_gene_expr_recon_loss: 9765134.6212; train_masked_gp_l1_reg_loss: 142260.9901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58038.4422; train_chrom_access_recon_loss: 1688355.1780; train_global_loss: 14450687.3636; train_optim_loss: 14450687.3636; val_kl_reg_loss: 94919.4229; val_edge_recon_loss: 2736031.0938; val_gene_expr_recon_loss: 9882354.8750; val_masked_gp_l1_reg_loss: 142225.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57889.0898; val_chrom_access_recon_loss: 1705151.7656; val_global_loss: 14618572.3750; val_optim_loss: 14618572.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9513; val_auprc_score: 0.9354; val_best_acc_score: 0.9009; val_best_f1_score: 0.9041; train_kl_reg_loss: 96604.6809; train_edge_recon_loss: 2714285.9053; train_gene_expr_recon_loss: 9744550.4545; train_masked_gp_l1_reg_loss: 142021.7334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56064.6892; train_chrom_access_recon_loss: 1684737.0114; train_global_loss: 14438264.4242; train_optim_loss: 14438264.4242; val_kl_reg_loss: 94496.1445; val_edge_recon_loss: 2745234.1250; val_gene_expr_recon_loss: 9879876.5000; val_masked_gp_l1_reg_loss: 141940.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55721.2383; val_chrom_access_recon_loss: 1692182.4844; val_global_loss: 14609451.3750; val_optim_loss: 14609451.3750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9504; val_auprc_score: 0.9312; val_best_acc_score: 0.8958; val_best_f1_score: 0.9009; train_kl_reg_loss: 96817.0837; train_edge_recon_loss: 2711682.2045; train_gene_expr_recon_loss: 9751883.8939; train_masked_gp_l1_reg_loss: 141918.7109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55704.9942; train_chrom_access_recon_loss: 1685336.6572; train_global_loss: 14443343.5606; train_optim_loss: 14443343.5606; val_kl_reg_loss: 94793.7637; val_edge_recon_loss: 2742229.4375; val_gene_expr_recon_loss: 9951529.3750; val_masked_gp_l1_reg_loss: 141898.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55680.8320; val_chrom_access_recon_loss: 1701809.7031; val_global_loss: 14687941.1250; val_optim_loss: 14687941.1250
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9598; val_auprc_score: 0.9446; val_best_acc_score: 0.9097; val_best_f1_score: 0.9127; train_kl_reg_loss: 96597.0616; train_edge_recon_loss: 2701776.5720; train_gene_expr_recon_loss: 9751335.5606; train_masked_gp_l1_reg_loss: 141886.0850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55657.0085; train_chrom_access_recon_loss: 1684833.6515; train_global_loss: 14432085.8333; train_optim_loss: 14432085.8333; val_kl_reg_loss: 94031.8594; val_edge_recon_loss: 2709535.4688; val_gene_expr_recon_loss: 9807906.7500; val_masked_gp_l1_reg_loss: 141878.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55644.8203; val_chrom_access_recon_loss: 1681355.9844; val_global_loss: 14490353.1250; val_optim_loss: 14490353.1250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9467; val_auprc_score: 0.9242; val_best_acc_score: 0.8909; val_best_f1_score: 0.8956; train_kl_reg_loss: 96531.0159; train_edge_recon_loss: 2715667.4924; train_gene_expr_recon_loss: 9750082.7424; train_masked_gp_l1_reg_loss: 141876.2763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55641.3284; train_chrom_access_recon_loss: 1685842.2955; train_global_loss: 14445641.1667; train_optim_loss: 14445641.1667; val_kl_reg_loss: 95224.5879; val_edge_recon_loss: 2758693.0625; val_gene_expr_recon_loss: 9838648.7500; val_masked_gp_l1_reg_loss: 141868.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55637.3750; val_chrom_access_recon_loss: 1696625.6562; val_global_loss: 14586697.2500; val_optim_loss: 14586697.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9494; val_auprc_score: 0.9265; val_best_acc_score: 0.8941; val_best_f1_score: 0.8983; train_kl_reg_loss: 96578.9257; train_edge_recon_loss: 2715518.0909; train_gene_expr_recon_loss: 9754918.1818; train_masked_gp_l1_reg_loss: 141860.5246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55622.6491; train_chrom_access_recon_loss: 1685894.8201; train_global_loss: 14450393.2273; train_optim_loss: 14450393.2273; val_kl_reg_loss: 94889.2715; val_edge_recon_loss: 2741759.9688; val_gene_expr_recon_loss: 9986002.1250; val_masked_gp_l1_reg_loss: 141854.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55619.5938; val_chrom_access_recon_loss: 1710484.7500; val_global_loss: 14730610.1250; val_optim_loss: 14730610.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9491; val_auprc_score: 0.9274; val_best_acc_score: 0.9014; val_best_f1_score: 0.9056; train_kl_reg_loss: 96583.1332; train_edge_recon_loss: 2711272.4621; train_gene_expr_recon_loss: 9752169.3485; train_masked_gp_l1_reg_loss: 141852.9924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55615.3104; train_chrom_access_recon_loss: 1687036.1420; train_global_loss: 14444529.3939; train_optim_loss: 14444529.3939; val_kl_reg_loss: 94158.9863; val_edge_recon_loss: 2726246.4062; val_gene_expr_recon_loss: 9921959.0000; val_masked_gp_l1_reg_loss: 141847.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55603.9297; val_chrom_access_recon_loss: 1696170.3750; val_global_loss: 14635986.8750; val_optim_loss: 14635986.8750
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9520; val_auprc_score: 0.9316; val_best_acc_score: 0.9011; val_best_f1_score: 0.9052; train_kl_reg_loss: 96348.2519; train_edge_recon_loss: 2709397.1326; train_gene_expr_recon_loss: 9748835.0758; train_masked_gp_l1_reg_loss: 141844.2422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55593.7286; train_chrom_access_recon_loss: 1684277.1553; train_global_loss: 14436295.5758; train_optim_loss: 14436295.5758; val_kl_reg_loss: 94569.2061; val_edge_recon_loss: 2760067.7500; val_gene_expr_recon_loss: 9917918.3750; val_masked_gp_l1_reg_loss: 141842.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55587.5039; val_chrom_access_recon_loss: 1703991.4688; val_global_loss: 14673977.8750; val_optim_loss: 14673977.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9546; val_auprc_score: 0.9357; val_best_acc_score: 0.9044; val_best_f1_score: 0.9080; train_kl_reg_loss: 96431.2584; train_edge_recon_loss: 2711648.4659; train_gene_expr_recon_loss: 9751531.9848; train_masked_gp_l1_reg_loss: 141822.4922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55402.1571; train_chrom_access_recon_loss: 1685407.1117; train_global_loss: 14442243.5758; train_optim_loss: 14442243.5758; val_kl_reg_loss: 94162.3604; val_edge_recon_loss: 2719008.7500; val_gene_expr_recon_loss: 9820252.3750; val_masked_gp_l1_reg_loss: 141814.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55367.7109; val_chrom_access_recon_loss: 1690998.0000; val_global_loss: 14521604.6250; val_optim_loss: 14521604.6250
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9515; val_auprc_score: 0.9294; val_best_acc_score: 0.8963; val_best_f1_score: 0.9010; train_kl_reg_loss: 96307.6323; train_edge_recon_loss: 2713172.2879; train_gene_expr_recon_loss: 9748594.2273; train_masked_gp_l1_reg_loss: 141812.4053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55365.1154; train_chrom_access_recon_loss: 1685094.6856; train_global_loss: 14440346.3485; train_optim_loss: 14440346.3485; val_kl_reg_loss: 94855.6113; val_edge_recon_loss: 2739112.2500; val_gene_expr_recon_loss: 9950589.8750; val_masked_gp_l1_reg_loss: 141810.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55363.1719; val_chrom_access_recon_loss: 1706923.9844; val_global_loss: 14688654.5000; val_optim_loss: 14688654.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9463; val_auprc_score: 0.9283; val_best_acc_score: 0.8990; val_best_f1_score: 0.9033; train_kl_reg_loss: 96256.4006; train_edge_recon_loss: 2712049.4053; train_gene_expr_recon_loss: 9749860.2121; train_masked_gp_l1_reg_loss: 141809.0036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55361.4299; train_chrom_access_recon_loss: 1685285.2140; train_global_loss: 14440621.6515; train_optim_loss: 14440621.6515; val_kl_reg_loss: 94398.9004; val_edge_recon_loss: 2756526.1250; val_gene_expr_recon_loss: 9888459.7500; val_masked_gp_l1_reg_loss: 141807.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55359.9609; val_chrom_access_recon_loss: 1698483.6875; val_global_loss: 14635036.3750; val_optim_loss: 14635036.3750
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9519; val_auprc_score: 0.9297; val_best_acc_score: 0.8952; val_best_f1_score: 0.8992; train_kl_reg_loss: 96419.6590; train_edge_recon_loss: 2708142.4924; train_gene_expr_recon_loss: 9749307.5758; train_masked_gp_l1_reg_loss: 141806.5722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55358.0655; train_chrom_access_recon_loss: 1684203.7992; train_global_loss: 14435238.1212; train_optim_loss: 14435238.1212; val_kl_reg_loss: 93390.3545; val_edge_recon_loss: 2755386.0000; val_gene_expr_recon_loss: 9837411.2500; val_masked_gp_l1_reg_loss: 141805.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55356.5273; val_chrom_access_recon_loss: 1692506.3750; val_global_loss: 14575857.0000; val_optim_loss: 14575857.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 22 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9517
val AUPRC score: 0.9341
val best accuracy score: 0.8984
val best F1 score: 0.9024
val target rna MSE score: 1.5373
val source rna MSE score: 0.5296
val target atac MSE score: 0.3201
val source atac MSE score: 0.0716
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
