[True]
Run timestamp: 01082023_092137_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9124; val_auprc_score: 0.9831; val_best_acc_score: 0.8581; val_best_f1_score: 0.9232; train_kl_reg_loss: 44397.8266; train_edge_recon_loss: 1039253.2685; train_gene_expr_recon_loss: 512086.4485; train_masked_gp_l1_reg_loss: 6245.9032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57693.5428; train_global_loss: 1659676.9931; train_optim_loss: 1659676.9931; val_kl_reg_loss: 48175.3665; val_edge_recon_loss: 1194596.2500; val_gene_expr_recon_loss: 426586.6719; val_masked_gp_l1_reg_loss: 6478.6426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52315.7383; val_global_loss: 1728152.6458; val_optim_loss: 1728152.6458
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9038; val_auprc_score: 0.9816; val_best_acc_score: 0.8566; val_best_f1_score: 0.9224; train_kl_reg_loss: 26861.5650; train_edge_recon_loss: 1026289.4873; train_gene_expr_recon_loss: 360935.7714; train_masked_gp_l1_reg_loss: 6493.6600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48333.7622; train_global_loss: 1468914.2500; train_optim_loss: 1468914.2500; val_kl_reg_loss: 20928.6650; val_edge_recon_loss: 1200770.7292; val_gene_expr_recon_loss: 296661.2812; val_masked_gp_l1_reg_loss: 6495.2349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44296.7773; val_global_loss: 1569152.6667; val_optim_loss: 1569152.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8999; val_auprc_score: 0.9806; val_best_acc_score: 0.8636; val_best_f1_score: 0.9257; train_kl_reg_loss: 16790.1181; train_edge_recon_loss: 1031455.5150; train_gene_expr_recon_loss: 277116.2529; train_masked_gp_l1_reg_loss: 6498.5253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40360.2761; train_global_loss: 1372220.6806; train_optim_loss: 1372220.6806; val_kl_reg_loss: 13113.0687; val_edge_recon_loss: 1206504.5625; val_gene_expr_recon_loss: 262564.6641; val_masked_gp_l1_reg_loss: 6510.8408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36393.2852; val_global_loss: 1525086.4375; val_optim_loss: 1525086.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8839; val_auprc_score: 0.9774; val_best_acc_score: 0.8793; val_best_f1_score: 0.9336; train_kl_reg_loss: 13578.7266; train_edge_recon_loss: 1040379.9248; train_gene_expr_recon_loss: 258149.9601; train_masked_gp_l1_reg_loss: 6494.2022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32980.5950; train_global_loss: 1351583.4167; train_optim_loss: 1351583.4167; val_kl_reg_loss: 11512.4401; val_edge_recon_loss: 1172132.5833; val_gene_expr_recon_loss: 252936.2344; val_masked_gp_l1_reg_loss: 6470.0884; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29710.5176; val_global_loss: 1472761.8750; val_optim_loss: 1472761.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8670; val_auprc_score: 0.9723; val_best_acc_score: 0.8766; val_best_f1_score: 0.9297; train_kl_reg_loss: 12155.1588; train_edge_recon_loss: 1035417.5509; train_gene_expr_recon_loss: 249383.9456; train_masked_gp_l1_reg_loss: 6435.8827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27098.3666; train_global_loss: 1330490.8981; train_optim_loss: 1330490.8981; val_kl_reg_loss: 12148.8914; val_edge_recon_loss: 1185478.1667; val_gene_expr_recon_loss: 244817.1094; val_masked_gp_l1_reg_loss: 6400.8667; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24677.5938; val_global_loss: 1473522.6667; val_optim_loss: 1473522.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8423; val_auprc_score: 0.9645; val_best_acc_score: 0.8827; val_best_f1_score: 0.9349; train_kl_reg_loss: 10582.1093; train_edge_recon_loss: 1024569.8553; train_gene_expr_recon_loss: 244187.5385; train_masked_gp_l1_reg_loss: 6377.1650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22958.8406; train_global_loss: 1308675.4977; train_optim_loss: 1308675.4977; val_kl_reg_loss: 7300.3563; val_edge_recon_loss: 1084215.3125; val_gene_expr_recon_loss: 246021.2500; val_masked_gp_l1_reg_loss: 6379.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21505.1797; val_global_loss: 1365421.7917; val_optim_loss: 1365421.7917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8402; val_auprc_score: 0.9651; val_best_acc_score: 0.8922; val_best_f1_score: 0.9402; train_kl_reg_loss: 11969.5776; train_edge_recon_loss: 914364.9271; train_gene_expr_recon_loss: 253203.0012; train_masked_gp_l1_reg_loss: 6522.2810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20676.9057; train_global_loss: 1206736.6852; train_optim_loss: 1206736.6852; val_kl_reg_loss: 18092.8975; val_edge_recon_loss: 869380.2708; val_gene_expr_recon_loss: 246355.1849; val_masked_gp_l1_reg_loss: 6661.0889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19741.5352; val_global_loss: 1160231.0000; val_optim_loss: 1160231.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8414; val_auprc_score: 0.9638; val_best_acc_score: 0.8946; val_best_f1_score: 0.9408; train_kl_reg_loss: 17496.1430; train_edge_recon_loss: 876746.6238; train_gene_expr_recon_loss: 243593.3079; train_masked_gp_l1_reg_loss: 6689.0427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18788.1766; train_global_loss: 1163313.2917; train_optim_loss: 1163313.2917; val_kl_reg_loss: 15990.4077; val_edge_recon_loss: 899573.3438; val_gene_expr_recon_loss: 240957.5859; val_masked_gp_l1_reg_loss: 6706.1909; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17844.7109; val_global_loss: 1181072.3333; val_optim_loss: 1181072.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8518; val_auprc_score: 0.9668; val_best_acc_score: 0.9042; val_best_f1_score: 0.9467; train_kl_reg_loss: 16825.6320; train_edge_recon_loss: 864574.2164; train_gene_expr_recon_loss: 238424.4598; train_masked_gp_l1_reg_loss: 6698.4241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17036.6407; train_global_loss: 1143559.3634; train_optim_loss: 1143559.3634; val_kl_reg_loss: 15060.4787; val_edge_recon_loss: 859013.2396; val_gene_expr_recon_loss: 237138.5703; val_masked_gp_l1_reg_loss: 6679.2568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16243.9854; val_global_loss: 1134135.5417; val_optim_loss: 1134135.5417
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8579; val_auprc_score: 0.9677; val_best_acc_score: 0.9058; val_best_f1_score: 0.9469; train_kl_reg_loss: 15861.2872; train_edge_recon_loss: 856773.0521; train_gene_expr_recon_loss: 234565.4855; train_masked_gp_l1_reg_loss: 6645.2053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15556.4239; train_global_loss: 1129401.4537; train_optim_loss: 1129401.4537; val_kl_reg_loss: 14051.9808; val_edge_recon_loss: 857256.7396; val_gene_expr_recon_loss: 234367.8438; val_masked_gp_l1_reg_loss: 6603.5283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14902.2949; val_global_loss: 1127182.3125; val_optim_loss: 1127182.3125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8669; val_auprc_score: 0.9682; val_best_acc_score: 0.9091; val_best_f1_score: 0.9482; train_kl_reg_loss: 15231.7962; train_edge_recon_loss: 843525.4757; train_gene_expr_recon_loss: 232199.2271; train_masked_gp_l1_reg_loss: 6542.6535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14366.4965; train_global_loss: 1111865.6470; train_optim_loss: 1111865.6470; val_kl_reg_loss: 14314.8994; val_edge_recon_loss: 842496.0000; val_gene_expr_recon_loss: 231889.8438; val_masked_gp_l1_reg_loss: 6468.3501; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13862.1074; val_global_loss: 1109031.2292; val_optim_loss: 1109031.2292
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8798; val_auprc_score: 0.9721; val_best_acc_score: 0.9084; val_best_f1_score: 0.9479; train_kl_reg_loss: 15168.5754; train_edge_recon_loss: 830165.0301; train_gene_expr_recon_loss: 227415.8666; train_masked_gp_l1_reg_loss: 6382.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13418.8803; train_global_loss: 1092550.8796; train_optim_loss: 1092550.8796; val_kl_reg_loss: 13888.0535; val_edge_recon_loss: 831277.1146; val_gene_expr_recon_loss: 225436.3646; val_masked_gp_l1_reg_loss: 6284.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12983.5156; val_global_loss: 1089869.2500; val_optim_loss: 1089869.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9051; val_auprc_score: 0.9771; val_best_acc_score: 0.9175; val_best_f1_score: 0.9528; train_kl_reg_loss: 13450.2905; train_edge_recon_loss: 817593.4873; train_gene_expr_recon_loss: 224156.1933; train_masked_gp_l1_reg_loss: 6185.9211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12639.4583; train_global_loss: 1074025.3322; train_optim_loss: 1074025.3322; val_kl_reg_loss: 13094.0910; val_edge_recon_loss: 828741.6458; val_gene_expr_recon_loss: 223527.9349; val_masked_gp_l1_reg_loss: 6074.1846; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12293.6250; val_global_loss: 1083731.4583; val_optim_loss: 1083731.4583
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9102; val_auprc_score: 0.9792; val_best_acc_score: 0.9232; val_best_f1_score: 0.9563; train_kl_reg_loss: 14087.1986; train_edge_recon_loss: 808235.5058; train_gene_expr_recon_loss: 220051.6565; train_masked_gp_l1_reg_loss: 5944.8907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11957.4566; train_global_loss: 1060276.7141; train_optim_loss: 1060276.7141; val_kl_reg_loss: 13264.3262; val_edge_recon_loss: 815404.6354; val_gene_expr_recon_loss: 218411.1667; val_masked_gp_l1_reg_loss: 5802.4194; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11603.3438; val_global_loss: 1064485.8750; val_optim_loss: 1064485.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9131; val_auprc_score: 0.9801; val_best_acc_score: 0.9221; val_best_f1_score: 0.9554; train_kl_reg_loss: 13821.3989; train_edge_recon_loss: 810714.6933; train_gene_expr_recon_loss: 216514.3932; train_masked_gp_l1_reg_loss: 5659.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11279.4226; train_global_loss: 1057988.9722; train_optim_loss: 1057988.9722; val_kl_reg_loss: 13015.8210; val_edge_recon_loss: 826282.3229; val_gene_expr_recon_loss: 214683.3802; val_masked_gp_l1_reg_loss: 5505.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10951.6094; val_global_loss: 1070438.7812; val_optim_loss: 1070438.7812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9215; val_auprc_score: 0.9828; val_best_acc_score: 0.9288; val_best_f1_score: 0.9593; train_kl_reg_loss: 13240.6138; train_edge_recon_loss: 799612.1736; train_gene_expr_recon_loss: 213350.7627; train_masked_gp_l1_reg_loss: 5352.8713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10630.5811; train_global_loss: 1042187.0046; train_optim_loss: 1042187.0046; val_kl_reg_loss: 11902.7432; val_edge_recon_loss: 798505.5729; val_gene_expr_recon_loss: 211624.9714; val_masked_gp_l1_reg_loss: 5191.3579; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10307.2842; val_global_loss: 1037531.9688; val_optim_loss: 1037531.9688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9233; val_auprc_score: 0.9835; val_best_acc_score: 0.9253; val_best_f1_score: 0.9573; train_kl_reg_loss: 12166.9146; train_edge_recon_loss: 801235.7951; train_gene_expr_recon_loss: 210887.1186; train_masked_gp_l1_reg_loss: 5038.6939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10012.8519; train_global_loss: 1039341.3773; train_optim_loss: 1039341.3773; val_kl_reg_loss: 11325.6439; val_edge_recon_loss: 816228.1771; val_gene_expr_recon_loss: 209535.1120; val_masked_gp_l1_reg_loss: 4876.3237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9714.0215; val_global_loss: 1051679.2500; val_optim_loss: 1051679.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9337; val_auprc_score: 0.9848; val_best_acc_score: 0.9260; val_best_f1_score: 0.9572; train_kl_reg_loss: 11541.9526; train_edge_recon_loss: 790610.6065; train_gene_expr_recon_loss: 208489.5237; train_masked_gp_l1_reg_loss: 4723.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9438.6069; train_global_loss: 1024804.1748; train_optim_loss: 1024804.1748; val_kl_reg_loss: 10603.7363; val_edge_recon_loss: 818621.1667; val_gene_expr_recon_loss: 207463.9948; val_masked_gp_l1_reg_loss: 4568.8530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9166.2979; val_global_loss: 1050424.0729; val_optim_loss: 1050424.0729
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9320; val_auprc_score: 0.9845; val_best_acc_score: 0.9296; val_best_f1_score: 0.9596; train_kl_reg_loss: 10880.8970; train_edge_recon_loss: 793934.5475; train_gene_expr_recon_loss: 206163.0796; train_masked_gp_l1_reg_loss: 4421.0976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8903.8081; train_global_loss: 1024303.4294; train_optim_loss: 1024303.4294; val_kl_reg_loss: 9986.7896; val_edge_recon_loss: 784792.0521; val_gene_expr_recon_loss: 204962.6562; val_masked_gp_l1_reg_loss: 4270.5269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8630.3115; val_global_loss: 1012642.2917; val_optim_loss: 1012642.2917
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9359; val_auprc_score: 0.9849; val_best_acc_score: 0.9311; val_best_f1_score: 0.9604; train_kl_reg_loss: 10490.6021; train_edge_recon_loss: 783860.6725; train_gene_expr_recon_loss: 204124.6739; train_masked_gp_l1_reg_loss: 4130.9291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8369.0592; train_global_loss: 1010975.9363; train_optim_loss: 1010975.9363; val_kl_reg_loss: 10653.7987; val_edge_recon_loss: 795183.6562; val_gene_expr_recon_loss: 203519.9505; val_masked_gp_l1_reg_loss: 3990.4092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8095.1992; val_global_loss: 1021443.0208; val_optim_loss: 1021443.0208
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9440; val_auprc_score: 0.9872; val_best_acc_score: 0.9276; val_best_f1_score: 0.9578; train_kl_reg_loss: 10136.8168; train_edge_recon_loss: 780631.8125; train_gene_expr_recon_loss: 202164.6247; train_masked_gp_l1_reg_loss: 3855.3170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7843.5086; train_global_loss: 1004632.0764; train_optim_loss: 1004632.0764; val_kl_reg_loss: 9699.3649; val_edge_recon_loss: 846244.7812; val_gene_expr_recon_loss: 202103.1693; val_masked_gp_l1_reg_loss: 3722.3965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7583.7754; val_global_loss: 1069353.4167; val_optim_loss: 1069353.4167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9438; val_auprc_score: 0.9870; val_best_acc_score: 0.9316; val_best_f1_score: 0.9607; train_kl_reg_loss: 10171.0515; train_edge_recon_loss: 798843.7546; train_gene_expr_recon_loss: 200433.7977; train_masked_gp_l1_reg_loss: 3598.8987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7315.0509; train_global_loss: 1020362.5486; train_optim_loss: 1020362.5486; val_kl_reg_loss: 10440.0023; val_edge_recon_loss: 796861.9792; val_gene_expr_recon_loss: 199324.0599; val_masked_gp_l1_reg_loss: 3475.6592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7044.7144; val_global_loss: 1017146.3958; val_optim_loss: 1017146.3958
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9453; val_auprc_score: 0.9878; val_best_acc_score: 0.9324; val_best_f1_score: 0.9608; train_kl_reg_loss: 9986.2518; train_edge_recon_loss: 792745.2245; train_gene_expr_recon_loss: 198889.2841; train_masked_gp_l1_reg_loss: 3366.2364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6793.7473; train_global_loss: 1011780.7384; train_optim_loss: 1011780.7384; val_kl_reg_loss: 10465.7959; val_edge_recon_loss: 811503.2292; val_gene_expr_recon_loss: 197454.0990; val_masked_gp_l1_reg_loss: 3259.7480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6533.8955; val_global_loss: 1029216.7604; val_optim_loss: 1029216.7604

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9494; val_auprc_score: 0.9890; val_best_acc_score: 0.9360; val_best_f1_score: 0.9631; train_kl_reg_loss: 10318.1743; train_edge_recon_loss: 782890.3356; train_gene_expr_recon_loss: 197677.7222; train_masked_gp_l1_reg_loss: 3228.6339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6472.7583; train_global_loss: 1000587.6343; train_optim_loss: 1000587.6343; val_kl_reg_loss: 9667.1629; val_edge_recon_loss: 779071.0625; val_gene_expr_recon_loss: 197677.4401; val_masked_gp_l1_reg_loss: 3210.7229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6434.4092; val_global_loss: 996060.8229; val_optim_loss: 996060.8229
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9469; val_auprc_score: 0.9878; val_best_acc_score: 0.9387; val_best_f1_score: 0.9646; train_kl_reg_loss: 9982.0289; train_edge_recon_loss: 774273.2176; train_gene_expr_recon_loss: 197459.3649; train_masked_gp_l1_reg_loss: 3199.2389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6406.6579; train_global_loss: 991320.5127; train_optim_loss: 991320.5127; val_kl_reg_loss: 9678.7233; val_edge_recon_loss: 779357.2604; val_gene_expr_recon_loss: 197654.0026; val_masked_gp_l1_reg_loss: 3187.9285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6378.5591; val_global_loss: 996256.4792; val_optim_loss: 996256.4792
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9441; val_auprc_score: 0.9867; val_best_acc_score: 0.9370; val_best_f1_score: 0.9637; train_kl_reg_loss: 9840.7865; train_edge_recon_loss: 778630.5532; train_gene_expr_recon_loss: 197332.2769; train_masked_gp_l1_reg_loss: 3177.5845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6351.4929; train_global_loss: 995332.6910; train_optim_loss: 995332.6910; val_kl_reg_loss: 9640.3709; val_edge_recon_loss: 793066.9479; val_gene_expr_recon_loss: 197008.3047; val_masked_gp_l1_reg_loss: 3166.9382; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6323.4209; val_global_loss: 1009206.0000; val_optim_loss: 1009206.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9504; val_auprc_score: 0.9887; val_best_acc_score: 0.9384; val_best_f1_score: 0.9642; train_kl_reg_loss: 9874.6717; train_edge_recon_loss: 778151.7269; train_gene_expr_recon_loss: 197216.3843; train_masked_gp_l1_reg_loss: 3156.4721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6296.6790; train_global_loss: 994695.9363; train_optim_loss: 994695.9363; val_kl_reg_loss: 9466.4512; val_edge_recon_loss: 780801.4688; val_gene_expr_recon_loss: 197452.4531; val_masked_gp_l1_reg_loss: 3145.6921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6268.9185; val_global_loss: 997135.0104; val_optim_loss: 997135.0104
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9477; val_auprc_score: 0.9883; val_best_acc_score: 0.9378; val_best_f1_score: 0.9638; train_kl_reg_loss: 9697.4345; train_edge_recon_loss: 778253.2859; train_gene_expr_recon_loss: 197069.8536; train_masked_gp_l1_reg_loss: 3135.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6242.5815; train_global_loss: 994398.7951; train_optim_loss: 994398.7951; val_kl_reg_loss: 9359.3613; val_edge_recon_loss: 797891.0417; val_gene_expr_recon_loss: 197225.3099; val_masked_gp_l1_reg_loss: 3125.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6215.4453; val_global_loss: 1013816.4688; val_optim_loss: 1013816.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9485; val_auprc_score: 0.9885; val_best_acc_score: 0.9368; val_best_f1_score: 0.9635; train_kl_reg_loss: 9585.3603; train_edge_recon_loss: 783028.2639; train_gene_expr_recon_loss: 196975.3261; train_masked_gp_l1_reg_loss: 3122.3800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6209.7552; train_global_loss: 998921.0868; train_optim_loss: 998921.0868; val_kl_reg_loss: 9335.1304; val_edge_recon_loss: 804084.1354; val_gene_expr_recon_loss: 197373.5833; val_masked_gp_l1_reg_loss: 3120.8511; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6206.2881; val_global_loss: 1020120.0208; val_optim_loss: 1020120.0208
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9489; val_auprc_score: 0.9881; val_best_acc_score: 0.9383; val_best_f1_score: 0.9643; train_kl_reg_loss: 9567.1711; train_edge_recon_loss: 782455.6632; train_gene_expr_recon_loss: 196971.7532; train_masked_gp_l1_reg_loss: 3119.7925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6203.5677; train_global_loss: 998317.9456; train_optim_loss: 998317.9456; val_kl_reg_loss: 9315.4259; val_edge_recon_loss: 790547.0000; val_gene_expr_recon_loss: 197011.0599; val_masked_gp_l1_reg_loss: 3118.6697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6200.7412; val_global_loss: 1006192.9167; val_optim_loss: 1006192.9167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9474; val_auprc_score: 0.9874; val_best_acc_score: 0.9356; val_best_f1_score: 0.9626; train_kl_reg_loss: 9577.2089; train_edge_recon_loss: 781366.1574; train_gene_expr_recon_loss: 196926.0949; train_masked_gp_l1_reg_loss: 3117.5739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6197.9624; train_global_loss: 997185.0035; train_optim_loss: 997185.0035; val_kl_reg_loss: 9324.4019; val_edge_recon_loss: 809855.8750; val_gene_expr_recon_loss: 197076.0781; val_masked_gp_l1_reg_loss: 3116.4321; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6195.0830; val_global_loss: 1025567.8438; val_optim_loss: 1025567.8438
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9513; val_auprc_score: 0.9892; val_best_acc_score: 0.9382; val_best_f1_score: 0.9642; train_kl_reg_loss: 9541.5223; train_edge_recon_loss: 780557.1979; train_gene_expr_recon_loss: 196907.9450; train_masked_gp_l1_reg_loss: 3115.3031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6192.2633; train_global_loss: 996314.2280; train_optim_loss: 996314.2280; val_kl_reg_loss: 9245.4474; val_edge_recon_loss: 778582.1562; val_gene_expr_recon_loss: 196755.9714; val_masked_gp_l1_reg_loss: 3114.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6189.3530; val_global_loss: 993887.0833; val_optim_loss: 993887.0833
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9514; val_auprc_score: 0.9896; val_best_acc_score: 0.9393; val_best_f1_score: 0.9650; train_kl_reg_loss: 9522.3106; train_edge_recon_loss: 780498.5069; train_gene_expr_recon_loss: 196918.5804; train_masked_gp_l1_reg_loss: 3112.9935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6186.5047; train_global_loss: 996238.8958; train_optim_loss: 996238.8958; val_kl_reg_loss: 9320.2878; val_edge_recon_loss: 780252.9688; val_gene_expr_recon_loss: 197047.7057; val_masked_gp_l1_reg_loss: 3111.7974; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6183.4873; val_global_loss: 995916.2917; val_optim_loss: 995916.2917
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9494; val_auprc_score: 0.9879; val_best_acc_score: 0.9370; val_best_f1_score: 0.9635; train_kl_reg_loss: 9532.1170; train_edge_recon_loss: 782510.4005; train_gene_expr_recon_loss: 196944.8079; train_masked_gp_l1_reg_loss: 3110.6187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6180.5596; train_global_loss: 998278.5081; train_optim_loss: 998278.5081; val_kl_reg_loss: 9243.8840; val_edge_recon_loss: 803870.0938; val_gene_expr_recon_loss: 196895.2500; val_masked_gp_l1_reg_loss: 3109.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6177.4829; val_global_loss: 1019296.0938; val_optim_loss: 1019296.0938
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9461; val_auprc_score: 0.9881; val_best_acc_score: 0.9361; val_best_f1_score: 0.9631; train_kl_reg_loss: 9541.9648; train_edge_recon_loss: 783077.2766; train_gene_expr_recon_loss: 196852.6583; train_masked_gp_l1_reg_loss: 3108.2288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6174.4854; train_global_loss: 998754.6169; train_optim_loss: 998754.6169; val_kl_reg_loss: 9306.0425; val_edge_recon_loss: 792178.3021; val_gene_expr_recon_loss: 196741.4245; val_masked_gp_l1_reg_loss: 3106.9753; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6171.3418; val_global_loss: 1007504.0833; val_optim_loss: 1007504.0833
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9477; val_auprc_score: 0.9868; val_best_acc_score: 0.9364; val_best_f1_score: 0.9633; train_kl_reg_loss: 9536.4962; train_edge_recon_loss: 778594.8171; train_gene_expr_recon_loss: 196905.8044; train_masked_gp_l1_reg_loss: 3105.7365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6168.2521; train_global_loss: 994311.0995; train_optim_loss: 994311.0995; val_kl_reg_loss: 9276.2559; val_edge_recon_loss: 797825.0729; val_gene_expr_recon_loss: 197371.9062; val_masked_gp_l1_reg_loss: 3104.4861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.0703; val_global_loss: 1013742.7917; val_optim_loss: 1013742.7917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9503; val_auprc_score: 0.9886; val_best_acc_score: 0.9381; val_best_f1_score: 0.9642; train_kl_reg_loss: 9521.1668; train_edge_recon_loss: 776113.2234; train_gene_expr_recon_loss: 196863.6956; train_masked_gp_l1_reg_loss: 3104.1511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6164.4458; train_global_loss: 991766.6863; train_optim_loss: 991766.6863; val_kl_reg_loss: 9285.8210; val_edge_recon_loss: 805858.6771; val_gene_expr_recon_loss: 197071.3490; val_masked_gp_l1_reg_loss: 3103.9675; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6164.0498; val_global_loss: 1021483.8438; val_optim_loss: 1021483.8438
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9517; val_auprc_score: 0.9891; val_best_acc_score: 0.9381; val_best_f1_score: 0.9643; train_kl_reg_loss: 9516.4556; train_edge_recon_loss: 774712.7384; train_gene_expr_recon_loss: 196847.5694; train_masked_gp_l1_reg_loss: 3103.8372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6163.7307; train_global_loss: 990344.3380; train_optim_loss: 990344.3380; val_kl_reg_loss: 9272.6712; val_edge_recon_loss: 784721.1146; val_gene_expr_recon_loss: 197032.7760; val_masked_gp_l1_reg_loss: 3103.7000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6163.3994; val_global_loss: 1000293.6250; val_optim_loss: 1000293.6250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9506; val_auprc_score: 0.9892; val_best_acc_score: 0.9391; val_best_f1_score: 0.9647; train_kl_reg_loss: 9518.1473; train_edge_recon_loss: 774107.1713; train_gene_expr_recon_loss: 196876.8692; train_masked_gp_l1_reg_loss: 3103.5667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6163.0769; train_global_loss: 989768.8275; train_optim_loss: 989768.8275; val_kl_reg_loss: 9256.3880; val_edge_recon_loss: 780255.7083; val_gene_expr_recon_loss: 197019.7292; val_masked_gp_l1_reg_loss: 3103.4302; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6162.7417; val_global_loss: 995798.0208; val_optim_loss: 995798.0208
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9498; val_auprc_score: 0.9890; val_best_acc_score: 0.9378; val_best_f1_score: 0.9641; train_kl_reg_loss: 9513.7550; train_edge_recon_loss: 782288.7836; train_gene_expr_recon_loss: 196851.8481; train_masked_gp_l1_reg_loss: 3103.2981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6162.4137; train_global_loss: 997920.0995; train_optim_loss: 997920.0995; val_kl_reg_loss: 9267.4272; val_edge_recon_loss: 784524.5000; val_gene_expr_recon_loss: 196801.0234; val_masked_gp_l1_reg_loss: 3103.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6162.0747; val_global_loss: 999858.1771; val_optim_loss: 999858.1771

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 30 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9532
val AUPRC score: 0.9889
val best accuracy score: 0.9398
val best F1 score: 0.9651
val target rna MSE score: 14.5606
val source rna MSE score: 7.5263
Val cat covariate0 mean sim diff: 0.0043

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
