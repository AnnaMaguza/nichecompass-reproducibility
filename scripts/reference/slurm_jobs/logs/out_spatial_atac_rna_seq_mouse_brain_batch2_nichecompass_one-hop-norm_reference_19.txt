[True]
Run timestamp: 07092023_143159_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2376 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5103, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7699; val_auprc_score: 0.7913; val_best_acc_score: 0.5267; val_best_f1_score: 0.6770; train_kl_reg_loss: 58358.2522; train_edge_recon_loss: 3527814.4046; train_gene_expr_recon_loss: 12746148.3435; train_masked_gp_l1_reg_loss: 56400.3149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 640350.4771; train_chrom_access_recon_loss: 6444355.7061; train_global_loss: 23473427.6641; train_optim_loss: 23473427.6641; val_kl_reg_loss: 89583.5010; val_edge_recon_loss: 4063702.3000; val_gene_expr_recon_loss: 11944148.5333; val_masked_gp_l1_reg_loss: 52675.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 335875.3750; val_chrom_access_recon_loss: 6212587.6667; val_global_loss: 22698572.2667; val_optim_loss: 22698572.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8777; val_auprc_score: 0.8853; val_best_acc_score: 0.7935; val_best_f1_score: 0.8056; train_kl_reg_loss: 77316.2597; train_edge_recon_loss: 3507509.1851; train_gene_expr_recon_loss: 11844529.5725; train_masked_gp_l1_reg_loss: 52086.1923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204239.3545; train_chrom_access_recon_loss: 6158925.3244; train_global_loss: 21844605.8626; train_optim_loss: 21844605.8626; val_kl_reg_loss: 68116.2482; val_edge_recon_loss: 4010780.1167; val_gene_expr_recon_loss: 11685478.6667; val_masked_gp_l1_reg_loss: 53032.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123831.6406; val_chrom_access_recon_loss: 6124478.4333; val_global_loss: 22065717.6000; val_optim_loss: 22065717.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8797; val_auprc_score: 0.8698; val_best_acc_score: 0.7771; val_best_f1_score: 0.8041; train_kl_reg_loss: 64008.2185; train_edge_recon_loss: 3255820.5515; train_gene_expr_recon_loss: 11663157.9771; train_masked_gp_l1_reg_loss: 56955.2997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94917.4298; train_chrom_access_recon_loss: 6078019.9427; train_global_loss: 21212879.4046; train_optim_loss: 21212879.4046; val_kl_reg_loss: 84474.0146; val_edge_recon_loss: 2949577.5167; val_gene_expr_recon_loss: 11542627.5333; val_masked_gp_l1_reg_loss: 60886.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75012.0234; val_chrom_access_recon_loss: 6034813.9333; val_global_loss: 20747391.2000; val_optim_loss: 20747391.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8927; val_auprc_score: 0.8775; val_best_acc_score: 0.8041; val_best_f1_score: 0.8171; train_kl_reg_loss: 83897.8568; train_edge_recon_loss: 2944297.1908; train_gene_expr_recon_loss: 11498735.2672; train_masked_gp_l1_reg_loss: 62695.2723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63296.6930; train_chrom_access_recon_loss: 6001138.4580; train_global_loss: 20654060.8550; train_optim_loss: 20654060.8550; val_kl_reg_loss: 78427.3062; val_edge_recon_loss: 2934407.8000; val_gene_expr_recon_loss: 11412528.3333; val_masked_gp_l1_reg_loss: 64632.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54252.0586; val_chrom_access_recon_loss: 6002874.1667; val_global_loss: 20547121.4667; val_optim_loss: 20547121.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9242; val_auprc_score: 0.9112; val_best_acc_score: 0.8538; val_best_f1_score: 0.8623; train_kl_reg_loss: 81865.7214; train_edge_recon_loss: 2867114.8664; train_gene_expr_recon_loss: 11378476.7252; train_masked_gp_l1_reg_loss: 66625.9385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48601.7556; train_chrom_access_recon_loss: 5941585.5878; train_global_loss: 20384270.6260; train_optim_loss: 20384270.6260; val_kl_reg_loss: 80981.4297; val_edge_recon_loss: 2856471.0000; val_gene_expr_recon_loss: 11245458.6000; val_masked_gp_l1_reg_loss: 68673.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44241.6445; val_chrom_access_recon_loss: 5901581.1667; val_global_loss: 20197408.1333; val_optim_loss: 20197408.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9319; val_auprc_score: 0.9166; val_best_acc_score: 0.8693; val_best_f1_score: 0.8759; train_kl_reg_loss: 83821.8946; train_edge_recon_loss: 2803531.7366; train_gene_expr_recon_loss: 11277681.8397; train_masked_gp_l1_reg_loss: 70333.2487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41105.5699; train_chrom_access_recon_loss: 5890784.2748; train_global_loss: 20167258.5191; train_optim_loss: 20167258.5191; val_kl_reg_loss: 84863.9453; val_edge_recon_loss: 2792173.4667; val_gene_expr_recon_loss: 11118146.9333; val_masked_gp_l1_reg_loss: 71940.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38083.7695; val_chrom_access_recon_loss: 5834479.5667; val_global_loss: 19939689.0667; val_optim_loss: 19939689.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9382; val_auprc_score: 0.9222; val_best_acc_score: 0.8744; val_best_f1_score: 0.8808; train_kl_reg_loss: 82801.6778; train_edge_recon_loss: 2777988.5859; train_gene_expr_recon_loss: 11176618.1985; train_masked_gp_l1_reg_loss: 73231.1600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36267.2484; train_chrom_access_recon_loss: 5835783.5725; train_global_loss: 19982690.5191; train_optim_loss: 19982690.5191; val_kl_reg_loss: 81720.8198; val_edge_recon_loss: 2799274.1500; val_gene_expr_recon_loss: 11093036.9333; val_masked_gp_l1_reg_loss: 74790.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34545.8125; val_chrom_access_recon_loss: 5830146.8000; val_global_loss: 19913515.8667; val_optim_loss: 19913515.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9420; val_auprc_score: 0.9254; val_best_acc_score: 0.8774; val_best_f1_score: 0.8853; train_kl_reg_loss: 81030.1116; train_edge_recon_loss: 2770546.0897; train_gene_expr_recon_loss: 11106374.6718; train_masked_gp_l1_reg_loss: 75777.3672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33404.2652; train_chrom_access_recon_loss: 5801803.4084; train_global_loss: 19868935.9695; train_optim_loss: 19868935.9695; val_kl_reg_loss: 79481.3302; val_edge_recon_loss: 2777933.5500; val_gene_expr_recon_loss: 11035287.2667; val_masked_gp_l1_reg_loss: 76983.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32395.6230; val_chrom_access_recon_loss: 5796138.5333; val_global_loss: 19798220.6667; val_optim_loss: 19798220.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9509; val_auprc_score: 0.9397; val_best_acc_score: 0.8880; val_best_f1_score: 0.8936; train_kl_reg_loss: 78211.8194; train_edge_recon_loss: 2750402.6393; train_gene_expr_recon_loss: 11030695.5267; train_masked_gp_l1_reg_loss: 78613.9182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31716.9344; train_chrom_access_recon_loss: 5761483.9847; train_global_loss: 19731124.7481; train_optim_loss: 19731124.7481; val_kl_reg_loss: 78296.4911; val_edge_recon_loss: 2744732.5667; val_gene_expr_recon_loss: 10958635.8667; val_masked_gp_l1_reg_loss: 79731.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31019.0117; val_chrom_access_recon_loss: 5751169.9000; val_global_loss: 19643585.0667; val_optim_loss: 19643585.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9527; val_auprc_score: 0.9404; val_best_acc_score: 0.8928; val_best_f1_score: 0.8985; train_kl_reg_loss: 77315.1966; train_edge_recon_loss: 2737351.9523; train_gene_expr_recon_loss: 10959851.8550; train_masked_gp_l1_reg_loss: 80162.2790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30284.7890; train_chrom_access_recon_loss: 5727726.6565; train_global_loss: 19612692.7176; train_optim_loss: 19612692.7176; val_kl_reg_loss: 77257.9865; val_edge_recon_loss: 2741111.8833; val_gene_expr_recon_loss: 10887309.7333; val_masked_gp_l1_reg_loss: 80793.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29986.7305; val_chrom_access_recon_loss: 5697499.4667; val_global_loss: 19513959.7333; val_optim_loss: 19513959.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9536; val_auprc_score: 0.9424; val_best_acc_score: 0.8922; val_best_f1_score: 0.8971; train_kl_reg_loss: 76822.3718; train_edge_recon_loss: 2716163.6698; train_gene_expr_recon_loss: 10893918.6183; train_masked_gp_l1_reg_loss: 81510.4835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29348.2475; train_chrom_access_recon_loss: 5687857.0115; train_global_loss: 19485620.3817; train_optim_loss: 19485620.3817; val_kl_reg_loss: 74384.5141; val_edge_recon_loss: 2742704.8500; val_gene_expr_recon_loss: 10829851.6667; val_masked_gp_l1_reg_loss: 82199.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29061.5996; val_chrom_access_recon_loss: 5689487.8667; val_global_loss: 19447690.6667; val_optim_loss: 19447690.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9595; val_auprc_score: 0.9492; val_best_acc_score: 0.9007; val_best_f1_score: 0.9047; train_kl_reg_loss: 73768.9461; train_edge_recon_loss: 2720787.1355; train_gene_expr_recon_loss: 10843089.6947; train_masked_gp_l1_reg_loss: 83005.1563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28625.6345; train_chrom_access_recon_loss: 5659908.6794; train_global_loss: 19409185.2519; train_optim_loss: 19409185.2519; val_kl_reg_loss: 72596.7266; val_edge_recon_loss: 2722116.7667; val_gene_expr_recon_loss: 10774304.2000; val_masked_gp_l1_reg_loss: 83672.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28231.9570; val_chrom_access_recon_loss: 5660911.2333; val_global_loss: 19341832.8000; val_optim_loss: 19341832.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9615; val_auprc_score: 0.9481; val_best_acc_score: 0.9080; val_best_f1_score: 0.9106; train_kl_reg_loss: 72702.9608; train_edge_recon_loss: 2705569.9771; train_gene_expr_recon_loss: 10799491.7252; train_masked_gp_l1_reg_loss: 84355.0455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27991.6700; train_chrom_access_recon_loss: 5635211.6565; train_global_loss: 19325322.9924; train_optim_loss: 19325322.9924; val_kl_reg_loss: 70529.4031; val_edge_recon_loss: 2711626.3167; val_gene_expr_recon_loss: 10730785.7333; val_masked_gp_l1_reg_loss: 85028.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27933.2090; val_chrom_access_recon_loss: 5628373.2000; val_global_loss: 19254275.2000; val_optim_loss: 19254275.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9662; val_auprc_score: 0.9578; val_best_acc_score: 0.9113; val_best_f1_score: 0.9139; train_kl_reg_loss: 71664.8529; train_edge_recon_loss: 2696108.5191; train_gene_expr_recon_loss: 10749937.1985; train_masked_gp_l1_reg_loss: 85640.8361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27641.2196; train_chrom_access_recon_loss: 5604411.8817; train_global_loss: 19235404.5191; train_optim_loss: 19235404.5191; val_kl_reg_loss: 68398.2651; val_edge_recon_loss: 2713702.9167; val_gene_expr_recon_loss: 10713803.0667; val_masked_gp_l1_reg_loss: 86275.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27328.7852; val_chrom_access_recon_loss: 5615057.9333; val_global_loss: 19224567.3333; val_optim_loss: 19224567.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9658; val_auprc_score: 0.9547; val_best_acc_score: 0.9130; val_best_f1_score: 0.9165; train_kl_reg_loss: 71151.7498; train_edge_recon_loss: 2695662.3721; train_gene_expr_recon_loss: 10711459.6718; train_masked_gp_l1_reg_loss: 86651.2342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27198.8664; train_chrom_access_recon_loss: 5584218.8931; train_global_loss: 19176342.7481; train_optim_loss: 19176342.7481; val_kl_reg_loss: 71772.4870; val_edge_recon_loss: 2701009.7333; val_gene_expr_recon_loss: 10653041.9333; val_masked_gp_l1_reg_loss: 87219.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27195.5566; val_chrom_access_recon_loss: 5586444.7333; val_global_loss: 19126684.8000; val_optim_loss: 19126684.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9686; val_auprc_score: 0.9577; val_best_acc_score: 0.9171; val_best_f1_score: 0.9197; train_kl_reg_loss: 70734.0026; train_edge_recon_loss: 2701571.4485; train_gene_expr_recon_loss: 10683798.9618; train_masked_gp_l1_reg_loss: 87605.1061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26996.3344; train_chrom_access_recon_loss: 5565130.9809; train_global_loss: 19135836.8092; train_optim_loss: 19135836.8092; val_kl_reg_loss: 67705.7753; val_edge_recon_loss: 2699323.6833; val_gene_expr_recon_loss: 10597848.8667; val_masked_gp_l1_reg_loss: 88184.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27060.8086; val_chrom_access_recon_loss: 5558640.0333; val_global_loss: 19038763.2000; val_optim_loss: 19038763.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9661; val_auprc_score: 0.9570; val_best_acc_score: 0.9151; val_best_f1_score: 0.9180; train_kl_reg_loss: 69164.9637; train_edge_recon_loss: 2691429.0095; train_gene_expr_recon_loss: 10642006.6489; train_masked_gp_l1_reg_loss: 88589.6659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26903.0163; train_chrom_access_recon_loss: 5544659.6832; train_global_loss: 19062752.9313; train_optim_loss: 19062752.9313; val_kl_reg_loss: 68804.3849; val_edge_recon_loss: 2710666.1333; val_gene_expr_recon_loss: 10584431.7333; val_masked_gp_l1_reg_loss: 89152.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26913.1035; val_chrom_access_recon_loss: 5536308.1667; val_global_loss: 19016275.8667; val_optim_loss: 19016275.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9723; val_auprc_score: 0.9627; val_best_acc_score: 0.9221; val_best_f1_score: 0.9245; train_kl_reg_loss: 69508.8779; train_edge_recon_loss: 2686797.9141; train_gene_expr_recon_loss: 10611320.7405; train_masked_gp_l1_reg_loss: 89419.8248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26772.8299; train_chrom_access_recon_loss: 5525289.1603; train_global_loss: 19009109.3282; train_optim_loss: 19009109.3282; val_kl_reg_loss: 68804.4630; val_edge_recon_loss: 2687662.7833; val_gene_expr_recon_loss: 10533189.8667; val_masked_gp_l1_reg_loss: 89580.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26820.7266; val_chrom_access_recon_loss: 5507187.3000; val_global_loss: 18913246.4000; val_optim_loss: 18913246.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9669; val_auprc_score: 0.9574; val_best_acc_score: 0.9182; val_best_f1_score: 0.9218; train_kl_reg_loss: 68475.4998; train_edge_recon_loss: 2682750.9332; train_gene_expr_recon_loss: 10580396.4427; train_masked_gp_l1_reg_loss: 90171.0469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26621.5664; train_chrom_access_recon_loss: 5511814.0611; train_global_loss: 18960229.5267; train_optim_loss: 18960229.5267; val_kl_reg_loss: 67150.1641; val_edge_recon_loss: 2703113.9500; val_gene_expr_recon_loss: 10563753.7333; val_masked_gp_l1_reg_loss: 90414.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26475.7539; val_chrom_access_recon_loss: 5522574.2000; val_global_loss: 18973482.2667; val_optim_loss: 18973482.2667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9705; val_auprc_score: 0.9617; val_best_acc_score: 0.9194; val_best_f1_score: 0.9231; train_kl_reg_loss: 68022.6096; train_edge_recon_loss: 2688367.0992; train_gene_expr_recon_loss: 10561552.4656; train_masked_gp_l1_reg_loss: 90813.4842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26567.1439; train_chrom_access_recon_loss: 5496781.5267; train_global_loss: 18932104.2901; train_optim_loss: 18932104.2901; val_kl_reg_loss: 69143.3844; val_edge_recon_loss: 2697309.4333; val_gene_expr_recon_loss: 10495625.6667; val_masked_gp_l1_reg_loss: 91232.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26542.1875; val_chrom_access_recon_loss: 5494899.6333; val_global_loss: 18874753.0667; val_optim_loss: 18874753.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9734; val_auprc_score: 0.9655; val_best_acc_score: 0.9250; val_best_f1_score: 0.9276; train_kl_reg_loss: 67365.9843; train_edge_recon_loss: 2677824.9218; train_gene_expr_recon_loss: 10528761.0000; train_masked_gp_l1_reg_loss: 91535.8950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26478.4694; train_chrom_access_recon_loss: 5476327.9847; train_global_loss: 18868294.3969; train_optim_loss: 18868294.3969; val_kl_reg_loss: 66555.7820; val_edge_recon_loss: 2688986.9500; val_gene_expr_recon_loss: 10460911.2000; val_masked_gp_l1_reg_loss: 91883.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26525.1582; val_chrom_access_recon_loss: 5470474.2000; val_global_loss: 18805336.1333; val_optim_loss: 18805336.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9718; val_auprc_score: 0.9633; val_best_acc_score: 0.9205; val_best_f1_score: 0.9249; train_kl_reg_loss: 67569.1674; train_edge_recon_loss: 2681620.9065; train_gene_expr_recon_loss: 10513351.0076; train_masked_gp_l1_reg_loss: 92149.0494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26425.8580; train_chrom_access_recon_loss: 5464150.5458; train_global_loss: 18845266.5344; train_optim_loss: 18845266.5344; val_kl_reg_loss: 66842.3490; val_edge_recon_loss: 2684569.1333; val_gene_expr_recon_loss: 10458288.8000; val_masked_gp_l1_reg_loss: 92671.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26612.4121; val_chrom_access_recon_loss: 5477897.0667; val_global_loss: 18806881.4667; val_optim_loss: 18806881.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9754; val_auprc_score: 0.9679; val_best_acc_score: 0.9283; val_best_f1_score: 0.9308; train_kl_reg_loss: 66422.9234; train_edge_recon_loss: 2677763.9218; train_gene_expr_recon_loss: 10491101.5420; train_masked_gp_l1_reg_loss: 92824.2040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26479.3742; train_chrom_access_recon_loss: 5453429.7290; train_global_loss: 18808021.6336; train_optim_loss: 18808021.6336; val_kl_reg_loss: 65020.8323; val_edge_recon_loss: 2683692.1667; val_gene_expr_recon_loss: 10453173.0667; val_masked_gp_l1_reg_loss: 93076.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26494.1094; val_chrom_access_recon_loss: 5470365.9000; val_global_loss: 18791821.6000; val_optim_loss: 18791821.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9760; val_auprc_score: 0.9669; val_best_acc_score: 0.9321; val_best_f1_score: 0.9346; train_kl_reg_loss: 65960.1696; train_edge_recon_loss: 2678685.2748; train_gene_expr_recon_loss: 10471672.5267; train_masked_gp_l1_reg_loss: 93373.1778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26560.6044; train_chrom_access_recon_loss: 5438525.1947; train_global_loss: 18774776.9008; train_optim_loss: 18774776.9008; val_kl_reg_loss: 65758.8333; val_edge_recon_loss: 2675265.1500; val_gene_expr_recon_loss: 10412516.4000; val_masked_gp_l1_reg_loss: 93627.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26401.9043; val_chrom_access_recon_loss: 5440742.1000; val_global_loss: 18714311.3333; val_optim_loss: 18714311.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9753; val_auprc_score: 0.9675; val_best_acc_score: 0.9295; val_best_f1_score: 0.9316; train_kl_reg_loss: 65403.0687; train_edge_recon_loss: 2675711.2824; train_gene_expr_recon_loss: 10452329.5878; train_masked_gp_l1_reg_loss: 93913.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26584.3339; train_chrom_access_recon_loss: 5425725.3473; train_global_loss: 18739666.9313; train_optim_loss: 18739666.9313; val_kl_reg_loss: 66823.9500; val_edge_recon_loss: 2702839.1333; val_gene_expr_recon_loss: 10439203.8000; val_masked_gp_l1_reg_loss: 94181.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26661.1777; val_chrom_access_recon_loss: 5463198.0000; val_global_loss: 18792908.0000; val_optim_loss: 18792908.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9761; val_auprc_score: 0.9679; val_best_acc_score: 0.9320; val_best_f1_score: 0.9341; train_kl_reg_loss: 70586.9736; train_edge_recon_loss: 2694901.1355; train_gene_expr_recon_loss: 10218204.2519; train_masked_gp_l1_reg_loss: 92738.2863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23068.4849; train_chrom_access_recon_loss: 5331104.0038; train_global_loss: 18430603.1145; train_optim_loss: 18430603.1145; val_kl_reg_loss: 46922.0779; val_edge_recon_loss: 2689502.4333; val_gene_expr_recon_loss: 10172922.8000; val_masked_gp_l1_reg_loss: 92343.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22435.1465; val_chrom_access_recon_loss: 5311413.7333; val_global_loss: 18335540.0000; val_optim_loss: 18335540.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9784; val_auprc_score: 0.9702; val_best_acc_score: 0.9334; val_best_f1_score: 0.9351; train_kl_reg_loss: 67951.6939; train_edge_recon_loss: 2683248.2366; train_gene_expr_recon_loss: 10182916.2977; train_masked_gp_l1_reg_loss: 92259.5281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22342.0485; train_chrom_access_recon_loss: 5301315.6221; train_global_loss: 18350033.5115; train_optim_loss: 18350033.5115; val_kl_reg_loss: 49989.8016; val_edge_recon_loss: 2689714.5000; val_gene_expr_recon_loss: 10159105.6000; val_masked_gp_l1_reg_loss: 92183.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22267.9043; val_chrom_access_recon_loss: 5299488.0667; val_global_loss: 18312749.0667; val_optim_loss: 18312749.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9779; val_auprc_score: 0.9688; val_best_acc_score: 0.9353; val_best_f1_score: 0.9378; train_kl_reg_loss: 64661.5518; train_edge_recon_loss: 2673166.6260; train_gene_expr_recon_loss: 10157170.0916; train_masked_gp_l1_reg_loss: 92257.2666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22353.2178; train_chrom_access_recon_loss: 5290557.2405; train_global_loss: 18300165.8931; train_optim_loss: 18300165.8931; val_kl_reg_loss: 51632.9185; val_edge_recon_loss: 2665304.8167; val_gene_expr_recon_loss: 10121249.8000; val_masked_gp_l1_reg_loss: 92138.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22214.2051; val_chrom_access_recon_loss: 5302629.8000; val_global_loss: 18255169.4667; val_optim_loss: 18255169.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9787; val_auprc_score: 0.9730; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 62831.5745; train_edge_recon_loss: 2671619.4771; train_gene_expr_recon_loss: 10154958.8473; train_masked_gp_l1_reg_loss: 92222.0022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22321.4266; train_chrom_access_recon_loss: 5290550.0687; train_global_loss: 18294503.2519; train_optim_loss: 18294503.2519; val_kl_reg_loss: 50308.2828; val_edge_recon_loss: 2675507.3500; val_gene_expr_recon_loss: 10132514.3333; val_masked_gp_l1_reg_loss: 92265.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22336.5352; val_chrom_access_recon_loss: 5303018.6000; val_global_loss: 18275951.6000; val_optim_loss: 18275951.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9787; val_auprc_score: 0.9740; val_best_acc_score: 0.9334; val_best_f1_score: 0.9357; train_kl_reg_loss: 61182.5896; train_edge_recon_loss: 2671841.4332; train_gene_expr_recon_loss: 10139185.4427; train_masked_gp_l1_reg_loss: 92265.0066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22383.4436; train_chrom_access_recon_loss: 5282187.3588; train_global_loss: 18269045.2748; train_optim_loss: 18269045.2748; val_kl_reg_loss: 54977.0307; val_edge_recon_loss: 2674931.4333; val_gene_expr_recon_loss: 10077578.3333; val_masked_gp_l1_reg_loss: 92203.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22362.5156; val_chrom_access_recon_loss: 5296808.8667; val_global_loss: 18218862.6667; val_optim_loss: 18218862.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9801; val_auprc_score: 0.9752; val_best_acc_score: 0.9372; val_best_f1_score: 0.9387; train_kl_reg_loss: 59975.6794; train_edge_recon_loss: 2662905.9179; train_gene_expr_recon_loss: 10120385.8244; train_masked_gp_l1_reg_loss: 92195.6195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22363.5509; train_chrom_access_recon_loss: 5273501.8244; train_global_loss: 18231328.3664; train_optim_loss: 18231328.3664; val_kl_reg_loss: 54166.2190; val_edge_recon_loss: 2678984.7167; val_gene_expr_recon_loss: 10092572.0000; val_masked_gp_l1_reg_loss: 92245.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22296.5293; val_chrom_access_recon_loss: 5293618.8333; val_global_loss: 18233884.8000; val_optim_loss: 18233884.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9784; val_auprc_score: 0.9721; val_best_acc_score: 0.9342; val_best_f1_score: 0.9370; train_kl_reg_loss: 58815.2359; train_edge_recon_loss: 2664331.9313; train_gene_expr_recon_loss: 10115017.4198; train_masked_gp_l1_reg_loss: 92292.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22354.9525; train_chrom_access_recon_loss: 5270378.7328; train_global_loss: 18223190.9160; train_optim_loss: 18223190.9160; val_kl_reg_loss: 53193.8180; val_edge_recon_loss: 2676764.0667; val_gene_expr_recon_loss: 10080800.4667; val_masked_gp_l1_reg_loss: 92418.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22354.7188; val_chrom_access_recon_loss: 5256842.7667; val_global_loss: 18182374.2667; val_optim_loss: 18182374.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9796; val_auprc_score: 0.9743; val_best_acc_score: 0.9364; val_best_f1_score: 0.9387; train_kl_reg_loss: 58394.1390; train_edge_recon_loss: 2660209.3588; train_gene_expr_recon_loss: 10092592.0153; train_masked_gp_l1_reg_loss: 92310.4296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22327.6732; train_chrom_access_recon_loss: 5255073.7748; train_global_loss: 18180907.3282; train_optim_loss: 18180907.3282; val_kl_reg_loss: 53218.1818; val_edge_recon_loss: 2672126.0000; val_gene_expr_recon_loss: 10010594.8000; val_masked_gp_l1_reg_loss: 92357.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22386.7227; val_chrom_access_recon_loss: 5244816.1000; val_global_loss: 18095499.7333; val_optim_loss: 18095499.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9838; val_auprc_score: 0.9807; val_best_acc_score: 0.9386; val_best_f1_score: 0.9406; train_kl_reg_loss: 57912.0873; train_edge_recon_loss: 2666524.9637; train_gene_expr_recon_loss: 10083630.9008; train_masked_gp_l1_reg_loss: 92342.0311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22357.0202; train_chrom_access_recon_loss: 5254705.8969; train_global_loss: 18177472.8550; train_optim_loss: 18177472.8550; val_kl_reg_loss: 53404.4102; val_edge_recon_loss: 2666058.7000; val_gene_expr_recon_loss: 10067284.4667; val_masked_gp_l1_reg_loss: 92312.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22361.6797; val_chrom_access_recon_loss: 5257884.7000; val_global_loss: 18159306.0000; val_optim_loss: 18159306.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9804; val_auprc_score: 0.9730; val_best_acc_score: 0.9388; val_best_f1_score: 0.9406; train_kl_reg_loss: 57079.0749; train_edge_recon_loss: 2658429.6374; train_gene_expr_recon_loss: 10069360.5115; train_masked_gp_l1_reg_loss: 92363.6519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22381.5458; train_chrom_access_recon_loss: 5244479.8359; train_global_loss: 18144094.4122; train_optim_loss: 18144094.4122; val_kl_reg_loss: 54647.5383; val_edge_recon_loss: 2677355.2500; val_gene_expr_recon_loss: 10054615.9333; val_masked_gp_l1_reg_loss: 92451.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22405.7168; val_chrom_access_recon_loss: 5272401.0333; val_global_loss: 18173876.9333; val_optim_loss: 18173876.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9826; val_auprc_score: 0.9772; val_best_acc_score: 0.9421; val_best_f1_score: 0.9435; train_kl_reg_loss: 57171.6766; train_edge_recon_loss: 2658715.5038; train_gene_expr_recon_loss: 10068115.0382; train_masked_gp_l1_reg_loss: 92475.5608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22393.2252; train_chrom_access_recon_loss: 5248406.2786; train_global_loss: 18147277.2824; train_optim_loss: 18147277.2824; val_kl_reg_loss: 52616.4633; val_edge_recon_loss: 2670687.3333; val_gene_expr_recon_loss: 10034362.0667; val_masked_gp_l1_reg_loss: 92466.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22400.1895; val_chrom_access_recon_loss: 5256363.1667; val_global_loss: 18128896.2667; val_optim_loss: 18128896.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9826; val_auprc_score: 0.9747; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 56542.6291; train_edge_recon_loss: 2659708.4237; train_gene_expr_recon_loss: 10059958.6641; train_masked_gp_l1_reg_loss: 92519.6382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22389.9695; train_chrom_access_recon_loss: 5240053.8931; train_global_loss: 18131173.3053; train_optim_loss: 18131173.3053; val_kl_reg_loss: 53389.0841; val_edge_recon_loss: 2676399.4333; val_gene_expr_recon_loss: 10055987.2000; val_masked_gp_l1_reg_loss: 92534.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22408.9551; val_chrom_access_recon_loss: 5262750.0000; val_global_loss: 18163468.8000; val_optim_loss: 18163468.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9814; val_auprc_score: 0.9739; val_best_acc_score: 0.9422; val_best_f1_score: 0.9435; train_kl_reg_loss: 56880.0818; train_edge_recon_loss: 2660181.5687; train_gene_expr_recon_loss: 10031663.3282; train_masked_gp_l1_reg_loss: 91751.4064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20448.4897; train_chrom_access_recon_loss: 5224998.1908; train_global_loss: 18085922.9008; train_optim_loss: 18085922.9008; val_kl_reg_loss: 55115.9083; val_edge_recon_loss: 2663142.2000; val_gene_expr_recon_loss: 10003903.2667; val_masked_gp_l1_reg_loss: 91448.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20109.4766; val_chrom_access_recon_loss: 5228163.6667; val_global_loss: 18061881.7333; val_optim_loss: 18061881.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9829; val_auprc_score: 0.9783; val_best_acc_score: 0.9434; val_best_f1_score: 0.9451; train_kl_reg_loss: 57925.8140; train_edge_recon_loss: 2655804.0420; train_gene_expr_recon_loss: 10039291.5649; train_masked_gp_l1_reg_loss: 91363.8620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20014.9473; train_chrom_access_recon_loss: 5230498.9466; train_global_loss: 18094899.1298; train_optim_loss: 18094899.1298; val_kl_reg_loss: 55148.8810; val_edge_recon_loss: 2682406.3833; val_gene_expr_recon_loss: 9993787.2000; val_masked_gp_l1_reg_loss: 91295.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19914.3262; val_chrom_access_recon_loss: 5220584.7000; val_global_loss: 18063136.2667; val_optim_loss: 18063136.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9831; val_auprc_score: 0.9784; val_best_acc_score: 0.9449; val_best_f1_score: 0.9464; train_kl_reg_loss: 57986.2711; train_edge_recon_loss: 2653330.6870; train_gene_expr_recon_loss: 10035285.0534; train_masked_gp_l1_reg_loss: 91267.5586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19867.4042; train_chrom_access_recon_loss: 5229804.9237; train_global_loss: 18087542.0458; train_optim_loss: 18087542.0458; val_kl_reg_loss: 55841.4695; val_edge_recon_loss: 2656370.6667; val_gene_expr_recon_loss: 10072681.0667; val_masked_gp_l1_reg_loss: 91226.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19795.9785; val_chrom_access_recon_loss: 5249473.1667; val_global_loss: 18145389.4667; val_optim_loss: 18145389.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9829; val_auprc_score: 0.9771; val_best_acc_score: 0.9437; val_best_f1_score: 0.9449; train_kl_reg_loss: 57924.6554; train_edge_recon_loss: 2655567.9656; train_gene_expr_recon_loss: 10027385.2290; train_masked_gp_l1_reg_loss: 91222.6137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19758.4852; train_chrom_access_recon_loss: 5222690.7634; train_global_loss: 18074549.6947; train_optim_loss: 18074549.6947; val_kl_reg_loss: 55851.3359; val_edge_recon_loss: 2676303.9333; val_gene_expr_recon_loss: 10022476.4000; val_masked_gp_l1_reg_loss: 91207.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19708.7715; val_chrom_access_recon_loss: 5235828.6333; val_global_loss: 18101377.2000; val_optim_loss: 18101377.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9814; val_auprc_score: 0.9748; val_best_acc_score: 0.9403; val_best_f1_score: 0.9418; train_kl_reg_loss: 57921.9190; train_edge_recon_loss: 2650851.7538; train_gene_expr_recon_loss: 10037016.4962; train_masked_gp_l1_reg_loss: 91211.2469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19671.9566; train_chrom_access_recon_loss: 5226688.4427; train_global_loss: 18083361.8397; train_optim_loss: 18083361.8397; val_kl_reg_loss: 55349.8984; val_edge_recon_loss: 2673132.1667; val_gene_expr_recon_loss: 10014411.0000; val_masked_gp_l1_reg_loss: 91199.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19617.9727; val_chrom_access_recon_loss: 5251656.6000; val_global_loss: 18105367.4667; val_optim_loss: 18105367.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9833; val_auprc_score: 0.9778; val_best_acc_score: 0.9473; val_best_f1_score: 0.9483; train_kl_reg_loss: 57474.5382; train_edge_recon_loss: 2658917.5095; train_gene_expr_recon_loss: 10025118.6718; train_masked_gp_l1_reg_loss: 91120.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19422.8001; train_chrom_access_recon_loss: 5225092.3817; train_global_loss: 18077146.6031; train_optim_loss: 18077146.6031; val_kl_reg_loss: 55416.6516; val_edge_recon_loss: 2665424.7333; val_gene_expr_recon_loss: 10007081.2000; val_masked_gp_l1_reg_loss: 91082.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19392.3203; val_chrom_access_recon_loss: 5240591.2333; val_global_loss: 18078987.7333; val_optim_loss: 18078987.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9850; val_auprc_score: 0.9819; val_best_acc_score: 0.9452; val_best_f1_score: 0.9463; train_kl_reg_loss: 57743.6984; train_edge_recon_loss: 2652260.3511; train_gene_expr_recon_loss: 10025015.6107; train_masked_gp_l1_reg_loss: 91068.6800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19381.0818; train_chrom_access_recon_loss: 5222855.7863; train_global_loss: 18068325.2824; train_optim_loss: 18068325.2824; val_kl_reg_loss: 55688.8057; val_edge_recon_loss: 2664078.3167; val_gene_expr_recon_loss: 10044443.1333; val_masked_gp_l1_reg_loss: 91056.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19372.8066; val_chrom_access_recon_loss: 5269577.6333; val_global_loss: 18144217.7333; val_optim_loss: 18144217.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9828; val_auprc_score: 0.9783; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 57803.5303; train_edge_recon_loss: 2654760.3740; train_gene_expr_recon_loss: 10026781.7557; train_masked_gp_l1_reg_loss: 91050.5219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19364.7738; train_chrom_access_recon_loss: 5223592.3435; train_global_loss: 18073353.4275; train_optim_loss: 18073353.4275; val_kl_reg_loss: 55494.1836; val_edge_recon_loss: 2666502.9000; val_gene_expr_recon_loss: 9991374.5333; val_masked_gp_l1_reg_loss: 91044.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19356.8457; val_chrom_access_recon_loss: 5233193.3000; val_global_loss: 18056966.4000; val_optim_loss: 18056966.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9832; val_auprc_score: 0.9781; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 57725.5811; train_edge_recon_loss: 2650976.5477; train_gene_expr_recon_loss: 10032670.4351; train_masked_gp_l1_reg_loss: 91040.1465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19350.1964; train_chrom_access_recon_loss: 5229487.8893; train_global_loss: 18081250.9389; train_optim_loss: 18081250.9389; val_kl_reg_loss: 55343.6766; val_edge_recon_loss: 2667602.6833; val_gene_expr_recon_loss: 9982006.0000; val_masked_gp_l1_reg_loss: 91035.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19343.3047; val_chrom_access_recon_loss: 5216201.0333; val_global_loss: 18031532.4000; val_optim_loss: 18031532.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9833; val_auprc_score: 0.9755; val_best_acc_score: 0.9446; val_best_f1_score: 0.9461; train_kl_reg_loss: 57759.6394; train_edge_recon_loss: 2650154.2748; train_gene_expr_recon_loss: 10022255.6641; train_masked_gp_l1_reg_loss: 91033.8306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19338.4628; train_chrom_access_recon_loss: 5220300.4046; train_global_loss: 18060842.4275; train_optim_loss: 18060842.4275; val_kl_reg_loss: 55713.6042; val_edge_recon_loss: 2663038.3167; val_gene_expr_recon_loss: 10006981.8000; val_masked_gp_l1_reg_loss: 91031.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19331.1055; val_chrom_access_recon_loss: 5232984.3667; val_global_loss: 18069080.0000; val_optim_loss: 18069080.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9838; val_auprc_score: 0.9772; val_best_acc_score: 0.9456; val_best_f1_score: 0.9467; train_kl_reg_loss: 57894.4407; train_edge_recon_loss: 2656110.6450; train_gene_expr_recon_loss: 10032348.1221; train_masked_gp_l1_reg_loss: 91030.6375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19326.4716; train_chrom_access_recon_loss: 5226646.7824; train_global_loss: 18083357.1298; train_optim_loss: 18083357.1298; val_kl_reg_loss: 55650.9536; val_edge_recon_loss: 2666290.2667; val_gene_expr_recon_loss: 9989406.2000; val_masked_gp_l1_reg_loss: 91026.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19320.4082; val_chrom_access_recon_loss: 5240991.9000; val_global_loss: 18062686.5333; val_optim_loss: 18062686.5333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9848; val_auprc_score: 0.9807; val_best_acc_score: 0.9481; val_best_f1_score: 0.9490; train_kl_reg_loss: 57922.9146; train_edge_recon_loss: 2653566.7958; train_gene_expr_recon_loss: 10028856.8550; train_masked_gp_l1_reg_loss: 91025.7654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19315.3401; train_chrom_access_recon_loss: 5227238.7824; train_global_loss: 18077926.4275; train_optim_loss: 18077926.4275; val_kl_reg_loss: 55831.1914; val_edge_recon_loss: 2641678.0667; val_gene_expr_recon_loss: 10028948.6667; val_masked_gp_l1_reg_loss: 91024.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19310.0566; val_chrom_access_recon_loss: 5242442.2667; val_global_loss: 18079235.0667; val_optim_loss: 18079235.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9824; val_auprc_score: 0.9742; val_best_acc_score: 0.9444; val_best_f1_score: 0.9456; train_kl_reg_loss: 57843.3295; train_edge_recon_loss: 2648064.4542; train_gene_expr_recon_loss: 10024621.4580; train_masked_gp_l1_reg_loss: 91022.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19304.7516; train_chrom_access_recon_loss: 5220810.4389; train_global_loss: 18061667.2977; train_optim_loss: 18061667.2977; val_kl_reg_loss: 55669.8799; val_edge_recon_loss: 2679560.9333; val_gene_expr_recon_loss: 9989751.1333; val_masked_gp_l1_reg_loss: 91020.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19299.0332; val_chrom_access_recon_loss: 5236292.7000; val_global_loss: 18071593.8667; val_optim_loss: 18071593.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9840; val_auprc_score: 0.9798; val_best_acc_score: 0.9433; val_best_f1_score: 0.9446; train_kl_reg_loss: 57847.4145; train_edge_recon_loss: 2652205.6355; train_gene_expr_recon_loss: 10026616.9160; train_masked_gp_l1_reg_loss: 91011.7047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19279.0671; train_chrom_access_recon_loss: 5223307.6031; train_global_loss: 18070268.4122; train_optim_loss: 18070268.4122; val_kl_reg_loss: 55861.2719; val_edge_recon_loss: 2657543.1167; val_gene_expr_recon_loss: 10027042.4667; val_masked_gp_l1_reg_loss: 91008.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19276.0664; val_chrom_access_recon_loss: 5248674.9000; val_global_loss: 18099406.0000; val_optim_loss: 18099406.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9840; val_auprc_score: 0.9802; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 57920.4540; train_edge_recon_loss: 2649207.4561; train_gene_expr_recon_loss: 10024880.4427; train_masked_gp_l1_reg_loss: 91006.6331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19274.9582; train_chrom_access_recon_loss: 5224277.9733; train_global_loss: 18066568.0611; train_optim_loss: 18066568.0611; val_kl_reg_loss: 55866.8104; val_edge_recon_loss: 2667386.5667; val_gene_expr_recon_loss: 10038207.6000; val_masked_gp_l1_reg_loss: 91005.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19273.8594; val_chrom_access_recon_loss: 5253303.5333; val_global_loss: 18125043.6000; val_optim_loss: 18125043.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9849; val_auprc_score: 0.9808; val_best_acc_score: 0.9456; val_best_f1_score: 0.9468; train_kl_reg_loss: 57841.2555; train_edge_recon_loss: 2656971.0076; train_gene_expr_recon_loss: 10019864.1985; train_masked_gp_l1_reg_loss: 91004.5196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19272.8633; train_chrom_access_recon_loss: 5221525.1870; train_global_loss: 18066478.9924; train_optim_loss: 18066478.9924; val_kl_reg_loss: 55838.5312; val_edge_recon_loss: 2652889.9833; val_gene_expr_recon_loss: 10036964.0667; val_masked_gp_l1_reg_loss: 91003.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19271.9551; val_chrom_access_recon_loss: 5252629.7000; val_global_loss: 18108598.4000; val_optim_loss: 18108598.4000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9828; val_auprc_score: 0.9762; val_best_acc_score: 0.9448; val_best_f1_score: 0.9461; train_kl_reg_loss: 57876.2028; train_edge_recon_loss: 2648776.2557; train_gene_expr_recon_loss: 10024610.8244; train_masked_gp_l1_reg_loss: 91003.2953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19271.2719; train_chrom_access_recon_loss: 5224345.9046; train_global_loss: 18065883.9847; train_optim_loss: 18065883.9847; val_kl_reg_loss: 55797.9516; val_edge_recon_loss: 2666285.9000; val_gene_expr_recon_loss: 10011600.6000; val_masked_gp_l1_reg_loss: 91002.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19270.5195; val_chrom_access_recon_loss: 5262999.7000; val_global_loss: 18106958.2667; val_optim_loss: 18106958.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 65 min 0 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9851
val AUPRC score: 0.9811
val best accuracy score: 0.9449
val best F1 score: 0.9455
val target rna MSE score: 1.1826
val source rna MSE score: 0.2593
val target atac MSE score: 0.3379
val source atac MSE score: 0.0542
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
