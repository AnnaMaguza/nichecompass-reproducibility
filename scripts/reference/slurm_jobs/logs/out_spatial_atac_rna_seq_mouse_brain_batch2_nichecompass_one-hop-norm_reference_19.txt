[True]
Run timestamp: 07082023_174057_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9007; val_auprc_score: 0.9085; val_best_acc_score: 0.5020; val_best_f1_score: 0.6676; train_kl_reg_loss: 4008.3471; train_edge_recon_loss: 35197.1740; train_gene_expr_recon_loss: 650714.5347; train_masked_gp_l1_reg_loss: 4448.2155; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 791191.8542; train_global_loss: 1485560.1389; train_optim_loss: 1485560.1389; val_kl_reg_loss: 8308.0547; val_edge_recon_loss: 40654.3242; val_gene_expr_recon_loss: 592338.6875; val_masked_gp_l1_reg_loss: 3814.7595; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 789402.1875; val_global_loss: 1434518.0000; val_optim_loss: 1434518.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9046; val_auprc_score: 0.9084; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 15758.1148; train_edge_recon_loss: 38053.2522; train_gene_expr_recon_loss: 559263.8889; train_masked_gp_l1_reg_loss: 3626.3411; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 782515.3403; train_global_loss: 1399216.9306; train_optim_loss: 1399216.9306; val_kl_reg_loss: 19167.4961; val_edge_recon_loss: 40656.1289; val_gene_expr_recon_loss: 525038.0000; val_masked_gp_l1_reg_loss: 3477.8716; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 771799.4375; val_global_loss: 1360139.0000; val_optim_loss: 1360139.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8917; val_auprc_score: 0.8906; val_best_acc_score: 0.5039; val_best_f1_score: 0.6684; train_kl_reg_loss: 20886.5360; train_edge_recon_loss: 38800.4805; train_gene_expr_recon_loss: 510555.3750; train_masked_gp_l1_reg_loss: 3521.1141; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 764721.7222; train_global_loss: 1338485.2083; train_optim_loss: 1338485.2083; val_kl_reg_loss: 23124.4102; val_edge_recon_loss: 40651.3555; val_gene_expr_recon_loss: 490784.5000; val_masked_gp_l1_reg_loss: 3607.7002; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 757446.5625; val_global_loss: 1315614.5000; val_optim_loss: 1315614.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8892; val_auprc_score: 0.8852; val_best_acc_score: 0.5272; val_best_f1_score: 0.6787; train_kl_reg_loss: 24694.3841; train_edge_recon_loss: 39118.3190; train_gene_expr_recon_loss: 480759.3090; train_masked_gp_l1_reg_loss: 3616.4486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 751745.0764; train_global_loss: 1299933.5278; train_optim_loss: 1299933.5278; val_kl_reg_loss: 24082.9492; val_edge_recon_loss: 40636.2734; val_gene_expr_recon_loss: 470965.0312; val_masked_gp_l1_reg_loss: 3586.4792; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747281.6250; val_global_loss: 1286552.3750; val_optim_loss: 1286552.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8858; val_auprc_score: 0.8816; val_best_acc_score: 0.5705; val_best_f1_score: 0.6986; train_kl_reg_loss: 25425.9779; train_edge_recon_loss: 39191.6953; train_gene_expr_recon_loss: 464698.9688; train_masked_gp_l1_reg_loss: 3559.5143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744052.8125; train_global_loss: 1276928.9722; train_optim_loss: 1276928.9722; val_kl_reg_loss: 24584.5391; val_edge_recon_loss: 40612.7109; val_gene_expr_recon_loss: 458087.6250; val_masked_gp_l1_reg_loss: 3522.8542; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739443.3750; val_global_loss: 1266251.1250; val_optim_loss: 1266251.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8802; val_auprc_score: 0.8741; val_best_acc_score: 0.6047; val_best_f1_score: 0.7147; train_kl_reg_loss: 26520.7862; train_edge_recon_loss: 39235.6007; train_gene_expr_recon_loss: 453760.8507; train_masked_gp_l1_reg_loss: 3498.7384; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 734858.9306; train_global_loss: 1257874.9028; train_optim_loss: 1257874.9028; val_kl_reg_loss: 26257.5977; val_edge_recon_loss: 40594.8672; val_gene_expr_recon_loss: 447933.5625; val_masked_gp_l1_reg_loss: 3465.7007; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732176.6875; val_global_loss: 1250428.3750; val_optim_loss: 1250428.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8856; val_auprc_score: 0.8757; val_best_acc_score: 0.6611; val_best_f1_score: 0.7434; train_kl_reg_loss: 27858.8982; train_edge_recon_loss: 39324.1840; train_gene_expr_recon_loss: 445367.0903; train_masked_gp_l1_reg_loss: 3444.4235; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732437.2847; train_global_loss: 1248431.8750; train_optim_loss: 1248431.8750; val_kl_reg_loss: 28361.7129; val_edge_recon_loss: 40562.0078; val_gene_expr_recon_loss: 439533.9688; val_masked_gp_l1_reg_loss: 3418.0945; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725815.8750; val_global_loss: 1237691.6250; val_optim_loss: 1237691.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8908; val_auprc_score: 0.8840; val_best_acc_score: 0.7288; val_best_f1_score: 0.7793; train_kl_reg_loss: 29084.5516; train_edge_recon_loss: 39348.6111; train_gene_expr_recon_loss: 436460.7083; train_masked_gp_l1_reg_loss: 3404.4431; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721696.8403; train_global_loss: 1229995.1528; train_optim_loss: 1229995.1528; val_kl_reg_loss: 28979.4414; val_edge_recon_loss: 40481.6641; val_gene_expr_recon_loss: 433605.4688; val_masked_gp_l1_reg_loss: 3386.2227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720880.9375; val_global_loss: 1227333.7500; val_optim_loss: 1227333.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8991; val_auprc_score: 0.8913; val_best_acc_score: 0.7835; val_best_f1_score: 0.8118; train_kl_reg_loss: 29868.3309; train_edge_recon_loss: 39326.7105; train_gene_expr_recon_loss: 432291.7188; train_masked_gp_l1_reg_loss: 3383.4418; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718200.4167; train_global_loss: 1223070.6250; train_optim_loss: 1223070.6250; val_kl_reg_loss: 29121.4648; val_edge_recon_loss: 40382.0820; val_gene_expr_recon_loss: 429010.0000; val_masked_gp_l1_reg_loss: 3376.6660; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 716937.5000; val_global_loss: 1218827.7500; val_optim_loss: 1218827.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9125; val_auprc_score: 0.9047; val_best_acc_score: 0.8184; val_best_f1_score: 0.8344; train_kl_reg_loss: 30168.9470; train_edge_recon_loss: 39274.1094; train_gene_expr_recon_loss: 429848.9792; train_masked_gp_l1_reg_loss: 3378.2230; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715171.7014; train_global_loss: 1217841.9583; train_optim_loss: 1217841.9583; val_kl_reg_loss: 29228.6094; val_edge_recon_loss: 40299.1914; val_gene_expr_recon_loss: 425170.0312; val_masked_gp_l1_reg_loss: 3375.5896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713262.6875; val_global_loss: 1211336.1250; val_optim_loss: 1211336.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9205; val_auprc_score: 0.9127; val_best_acc_score: 0.8448; val_best_f1_score: 0.8531; train_kl_reg_loss: 30135.3722; train_edge_recon_loss: 39229.5004; train_gene_expr_recon_loss: 423275.2257; train_masked_gp_l1_reg_loss: 3378.3703; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 709197.6250; train_global_loss: 1205216.0972; train_optim_loss: 1205216.0972; val_kl_reg_loss: 29131.2305; val_edge_recon_loss: 40237.9688; val_gene_expr_recon_loss: 421955.3125; val_masked_gp_l1_reg_loss: 3377.3889; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710329.9375; val_global_loss: 1205031.7500; val_optim_loss: 1205031.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9277; val_auprc_score: 0.9187; val_best_acc_score: 0.8592; val_best_f1_score: 0.8623; train_kl_reg_loss: 30013.1411; train_edge_recon_loss: 39185.4240; train_gene_expr_recon_loss: 418766.8403; train_masked_gp_l1_reg_loss: 3385.0489; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706136.8472; train_global_loss: 1197487.2917; train_optim_loss: 1197487.2917; val_kl_reg_loss: 28878.8281; val_edge_recon_loss: 40167.0352; val_gene_expr_recon_loss: 419436.9062; val_masked_gp_l1_reg_loss: 3387.2070; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707714.0625; val_global_loss: 1199584.0000; val_optim_loss: 1199584.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9316; val_auprc_score: 0.9174; val_best_acc_score: 0.8650; val_best_f1_score: 0.8650; train_kl_reg_loss: 29729.1039; train_edge_recon_loss: 39128.2669; train_gene_expr_recon_loss: 416772.4444; train_masked_gp_l1_reg_loss: 3392.2047; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704243.2569; train_global_loss: 1193265.2917; train_optim_loss: 1193265.2917; val_kl_reg_loss: 29607.3359; val_edge_recon_loss: 40109.3945; val_gene_expr_recon_loss: 416608.7500; val_masked_gp_l1_reg_loss: 3394.9758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 704595.9375; val_global_loss: 1194316.3750; val_optim_loss: 1194316.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9337; val_auprc_score: 0.9229; val_best_acc_score: 0.8583; val_best_f1_score: 0.8557; train_kl_reg_loss: 29821.3542; train_edge_recon_loss: 39086.9948; train_gene_expr_recon_loss: 416570.7396; train_masked_gp_l1_reg_loss: 3404.2539; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703189.1389; train_global_loss: 1192072.4861; train_optim_loss: 1192072.4861; val_kl_reg_loss: 27430.1426; val_edge_recon_loss: 40026.3203; val_gene_expr_recon_loss: 415949.0625; val_masked_gp_l1_reg_loss: 3409.0994; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702793.4375; val_global_loss: 1189608.0000; val_optim_loss: 1189608.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9350; val_auprc_score: 0.9242; val_best_acc_score: 0.8564; val_best_f1_score: 0.8532; train_kl_reg_loss: 29243.9013; train_edge_recon_loss: 39035.5078; train_gene_expr_recon_loss: 413134.9896; train_masked_gp_l1_reg_loss: 3420.1768; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699899.9583; train_global_loss: 1184734.5278; train_optim_loss: 1184734.5278; val_kl_reg_loss: 28018.0566; val_edge_recon_loss: 39999.3516; val_gene_expr_recon_loss: 413676.3750; val_masked_gp_l1_reg_loss: 3425.8396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700252.8750; val_global_loss: 1185372.5000; val_optim_loss: 1185372.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9386; val_auprc_score: 0.9265; val_best_acc_score: 0.8584; val_best_f1_score: 0.8525; train_kl_reg_loss: 29062.7711; train_edge_recon_loss: 38989.3685; train_gene_expr_recon_loss: 412455.8681; train_masked_gp_l1_reg_loss: 3432.2913; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696932.3958; train_global_loss: 1180872.6944; train_optim_loss: 1180872.6944; val_kl_reg_loss: 27347.5898; val_edge_recon_loss: 39935.0273; val_gene_expr_recon_loss: 412459.2812; val_masked_gp_l1_reg_loss: 3435.1885; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 698270.3750; val_global_loss: 1181447.5000; val_optim_loss: 1181447.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9440; val_auprc_score: 0.9366; val_best_acc_score: 0.8546; val_best_f1_score: 0.8468; train_kl_reg_loss: 28654.3598; train_edge_recon_loss: 38933.2925; train_gene_expr_recon_loss: 411619.7292; train_masked_gp_l1_reg_loss: 3447.7277; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693741.7431; train_global_loss: 1176396.8750; train_optim_loss: 1176396.8750; val_kl_reg_loss: 27164.7773; val_edge_recon_loss: 39867.1641; val_gene_expr_recon_loss: 410959.7812; val_masked_gp_l1_reg_loss: 3453.5024; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696366.0625; val_global_loss: 1177811.2500; val_optim_loss: 1177811.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9448; val_auprc_score: 0.9366; val_best_acc_score: 0.8535; val_best_f1_score: 0.8438; train_kl_reg_loss: 28368.4403; train_edge_recon_loss: 38881.7031; train_gene_expr_recon_loss: 409667.2986; train_masked_gp_l1_reg_loss: 3463.9038; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696468.5764; train_global_loss: 1176849.9167; train_optim_loss: 1176849.9167; val_kl_reg_loss: 26931.7383; val_edge_recon_loss: 39805.1055; val_gene_expr_recon_loss: 409626.0000; val_masked_gp_l1_reg_loss: 3471.6719; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694571.4375; val_global_loss: 1174406.0000; val_optim_loss: 1174406.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9434; val_auprc_score: 0.9325; val_best_acc_score: 0.8490; val_best_f1_score: 0.8410; train_kl_reg_loss: 28065.8848; train_edge_recon_loss: 38830.2504; train_gene_expr_recon_loss: 407501.1215; train_masked_gp_l1_reg_loss: 3482.1007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691410.6597; train_global_loss: 1169290.0139; train_optim_loss: 1169290.0139; val_kl_reg_loss: 26138.5352; val_edge_recon_loss: 39764.0273; val_gene_expr_recon_loss: 408916.2812; val_masked_gp_l1_reg_loss: 3485.8557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692930.0625; val_global_loss: 1171234.7500; val_optim_loss: 1171234.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9510; val_auprc_score: 0.9442; val_best_acc_score: 0.8513; val_best_f1_score: 0.8520; train_kl_reg_loss: 27619.9909; train_edge_recon_loss: 38787.3030; train_gene_expr_recon_loss: 407153.1319; train_masked_gp_l1_reg_loss: 3496.9197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688004.9583; train_global_loss: 1165062.3056; train_optim_loss: 1165062.3056; val_kl_reg_loss: 25938.2715; val_edge_recon_loss: 39698.6523; val_gene_expr_recon_loss: 407777.9375; val_masked_gp_l1_reg_loss: 3501.4512; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 691336.0000; val_global_loss: 1168252.2500; val_optim_loss: 1168252.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9504; val_auprc_score: 0.9436; val_best_acc_score: 0.8453; val_best_f1_score: 0.8514; train_kl_reg_loss: 27274.6250; train_edge_recon_loss: 38744.6024; train_gene_expr_recon_loss: 406758.1806; train_masked_gp_l1_reg_loss: 3516.1387; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690017.0486; train_global_loss: 1166310.5694; train_optim_loss: 1166310.5694; val_kl_reg_loss: 26048.8477; val_edge_recon_loss: 39662.4609; val_gene_expr_recon_loss: 406562.9375; val_masked_gp_l1_reg_loss: 3521.8364; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689545.3750; val_global_loss: 1165341.5000; val_optim_loss: 1165341.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9521; val_auprc_score: 0.9445; val_best_acc_score: 0.8452; val_best_f1_score: 0.8508; train_kl_reg_loss: 26987.9414; train_edge_recon_loss: 38696.4540; train_gene_expr_recon_loss: 406464.5903; train_masked_gp_l1_reg_loss: 3532.6420; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690598.8611; train_global_loss: 1166280.4861; train_optim_loss: 1166280.4861; val_kl_reg_loss: 25526.8184; val_edge_recon_loss: 39647.1484; val_gene_expr_recon_loss: 405808.6875; val_masked_gp_l1_reg_loss: 3538.9136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 688098.4375; val_global_loss: 1162620.0000; val_optim_loss: 1162620.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9525; val_auprc_score: 0.9431; val_best_acc_score: 0.8380; val_best_f1_score: 0.8585; train_kl_reg_loss: 26566.9629; train_edge_recon_loss: 38662.1111; train_gene_expr_recon_loss: 404202.1632; train_masked_gp_l1_reg_loss: 3548.4370; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687863.2708; train_global_loss: 1160842.9306; train_optim_loss: 1160842.9306; val_kl_reg_loss: 24802.1465; val_edge_recon_loss: 39602.1992; val_gene_expr_recon_loss: 405308.5625; val_masked_gp_l1_reg_loss: 3552.2900; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687134.3125; val_global_loss: 1160399.5000; val_optim_loss: 1160399.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9561; val_auprc_score: 0.9509; val_best_acc_score: 0.8448; val_best_f1_score: 0.8630; train_kl_reg_loss: 26249.4447; train_edge_recon_loss: 38644.6489; train_gene_expr_recon_loss: 401469.3611; train_masked_gp_l1_reg_loss: 3561.6743; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 683014.7222; train_global_loss: 1152939.8611; train_optim_loss: 1152939.8611; val_kl_reg_loss: 23792.0742; val_edge_recon_loss: 39528.8242; val_gene_expr_recon_loss: 405203.8125; val_masked_gp_l1_reg_loss: 3564.6799; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686204.7500; val_global_loss: 1158294.1250; val_optim_loss: 1158294.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9545; val_auprc_score: 0.9488; val_best_acc_score: 0.8433; val_best_f1_score: 0.8619; train_kl_reg_loss: 25978.1968; train_edge_recon_loss: 38597.4414; train_gene_expr_recon_loss: 403948.5903; train_masked_gp_l1_reg_loss: 3573.3143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 683493.5208; train_global_loss: 1155591.0417; train_optim_loss: 1155591.0417; val_kl_reg_loss: 23759.6602; val_edge_recon_loss: 39526.7148; val_gene_expr_recon_loss: 404071.4688; val_masked_gp_l1_reg_loss: 3576.9216; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 684738.8125; val_global_loss: 1155673.5000; val_optim_loss: 1155673.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9520; val_auprc_score: 0.9499; val_best_acc_score: 0.8579; val_best_f1_score: 0.8704; train_kl_reg_loss: 24271.4792; train_edge_recon_loss: 40222.7938; train_gene_expr_recon_loss: 419967.3333; train_masked_gp_l1_reg_loss: 3594.6903; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695589.5417; train_global_loss: 1183645.8472; train_optim_loss: 1183645.8472; val_kl_reg_loss: 18566.7109; val_edge_recon_loss: 40416.9453; val_gene_expr_recon_loss: 418981.3125; val_masked_gp_l1_reg_loss: 3602.2817; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697091.8750; val_global_loss: 1178659.1250; val_optim_loss: 1178659.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9487; val_auprc_score: 0.9445; val_best_acc_score: 0.8502; val_best_f1_score: 0.8649; train_kl_reg_loss: 21121.7374; train_edge_recon_loss: 40323.3043; train_gene_expr_recon_loss: 415613.3438; train_masked_gp_l1_reg_loss: 3600.4019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694379.3542; train_global_loss: 1175038.1250; train_optim_loss: 1175038.1250; val_kl_reg_loss: 18975.0898; val_edge_recon_loss: 40416.6836; val_gene_expr_recon_loss: 415748.7812; val_masked_gp_l1_reg_loss: 3592.4263; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 695728.1250; val_global_loss: 1174461.1250; val_optim_loss: 1174461.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9535; val_auprc_score: 0.9507; val_best_acc_score: 0.8674; val_best_f1_score: 0.8770; train_kl_reg_loss: 20247.7116; train_edge_recon_loss: 40279.4870; train_gene_expr_recon_loss: 411813.4132; train_masked_gp_l1_reg_loss: 3585.3430; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 692499.9444; train_global_loss: 1168425.9167; train_optim_loss: 1168425.9167; val_kl_reg_loss: 18662.6250; val_edge_recon_loss: 40354.0547; val_gene_expr_recon_loss: 414614.1250; val_masked_gp_l1_reg_loss: 3576.1692; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694581.3125; val_global_loss: 1171788.2500; val_optim_loss: 1171788.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9522; val_auprc_score: 0.9488; val_best_acc_score: 0.8694; val_best_f1_score: 0.8767; train_kl_reg_loss: 19599.8186; train_edge_recon_loss: 40213.2921; train_gene_expr_recon_loss: 411804.9757; train_masked_gp_l1_reg_loss: 3569.6430; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690782.5903; train_global_loss: 1165970.3194; train_optim_loss: 1165970.3194; val_kl_reg_loss: 17608.6680; val_edge_recon_loss: 40283.4258; val_gene_expr_recon_loss: 414272.5938; val_masked_gp_l1_reg_loss: 3560.0059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693909.7500; val_global_loss: 1169634.5000; val_optim_loss: 1169634.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9557; val_auprc_score: 0.9542; val_best_acc_score: 0.8777; val_best_f1_score: 0.8838; train_kl_reg_loss: 19364.8118; train_edge_recon_loss: 40174.7348; train_gene_expr_recon_loss: 412005.3854; train_masked_gp_l1_reg_loss: 3543.8816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691189.2431; train_global_loss: 1166278.0556; train_optim_loss: 1166278.0556; val_kl_reg_loss: 18222.9297; val_edge_recon_loss: 40278.5938; val_gene_expr_recon_loss: 413643.1562; val_masked_gp_l1_reg_loss: 3528.7756; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693445.0625; val_global_loss: 1169118.5000; val_optim_loss: 1169118.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9532; val_auprc_score: 0.9504; val_best_acc_score: 0.8744; val_best_f1_score: 0.8810; train_kl_reg_loss: 19106.2760; train_edge_recon_loss: 40168.9089; train_gene_expr_recon_loss: 409949.6389; train_masked_gp_l1_reg_loss: 3524.6441; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690465.1944; train_global_loss: 1163214.6667; train_optim_loss: 1163214.6667; val_kl_reg_loss: 18142.4844; val_edge_recon_loss: 40279.3320; val_gene_expr_recon_loss: 413570.7188; val_masked_gp_l1_reg_loss: 3518.4644; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693391.7500; val_global_loss: 1168902.7500; val_optim_loss: 1168902.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9511; val_auprc_score: 0.9472; val_best_acc_score: 0.8733; val_best_f1_score: 0.8797; train_kl_reg_loss: 19269.2372; train_edge_recon_loss: 40173.7144; train_gene_expr_recon_loss: 412120.6042; train_masked_gp_l1_reg_loss: 3514.8653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691447.0903; train_global_loss: 1166525.5139; train_optim_loss: 1166525.5139; val_kl_reg_loss: 17803.4941; val_edge_recon_loss: 40276.1289; val_gene_expr_recon_loss: 413729.5000; val_masked_gp_l1_reg_loss: 3510.7939; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693336.6250; val_global_loss: 1168656.5000; val_optim_loss: 1168656.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9534; val_auprc_score: 0.9473; val_best_acc_score: 0.8764; val_best_f1_score: 0.8823; train_kl_reg_loss: 19194.5299; train_edge_recon_loss: 40170.6411; train_gene_expr_recon_loss: 412538.3438; train_masked_gp_l1_reg_loss: 3508.3226; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691563.2014; train_global_loss: 1166975.0000; train_optim_loss: 1166975.0000; val_kl_reg_loss: 17920.6523; val_edge_recon_loss: 40273.7422; val_gene_expr_recon_loss: 413549.8125; val_masked_gp_l1_reg_loss: 3505.5693; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693189.0625; val_global_loss: 1168438.8750; val_optim_loss: 1168438.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 26 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9552
val AUPRC score: 0.9500
val best accuracy score: 0.8831
val best F1 score: 0.8869
val target rna MSE score: 0.4836
val source rna MSE score: 0.3020
val target atac MSE score: 0.1338
val source atac MSE score: 0.0181
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
