[True]
Run timestamp: 10082023_182726_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7000; val_auprc_score: 0.7373; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 89586.3307; train_edge_recon_loss: 3681733.0592; train_gene_expr_recon_loss: 27377427.9847; train_masked_gp_l1_reg_loss: 79991.6815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242754.1392; train_chrom_access_recon_loss: 1381340.1059; train_global_loss: 32852833.3282; train_optim_loss: 32852833.3282; val_kl_reg_loss: 113440.1016; val_edge_recon_loss: 4065641.8833; val_gene_expr_recon_loss: 23342491.7333; val_masked_gp_l1_reg_loss: 83651.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233887.7969; val_chrom_access_recon_loss: 1279727.0167; val_global_loss: 29118841.0667; val_optim_loss: 29118841.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7560; val_auprc_score: 0.7745; val_best_acc_score: 0.5260; val_best_f1_score: 0.6772; train_kl_reg_loss: 136999.4528; train_edge_recon_loss: 3582985.9714; train_gene_expr_recon_loss: 23036294.2748; train_masked_gp_l1_reg_loss: 81435.1612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224767.7436; train_chrom_access_recon_loss: 1291774.0639; train_global_loss: 28354256.7481; train_optim_loss: 28354256.7481; val_kl_reg_loss: 159019.5844; val_edge_recon_loss: 4063733.9000; val_gene_expr_recon_loss: 22332729.6000; val_masked_gp_l1_reg_loss: 78433.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214867.6250; val_chrom_access_recon_loss: 1259433.8417; val_global_loss: 28108218.9333; val_optim_loss: 28108218.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7786; val_auprc_score: 0.7946; val_best_acc_score: 0.6696; val_best_f1_score: 0.7249; train_kl_reg_loss: 145103.9076; train_edge_recon_loss: 3548726.4885; train_gene_expr_recon_loss: 22343914.3817; train_masked_gp_l1_reg_loss: 77674.2849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205272.2625; train_chrom_access_recon_loss: 1273719.2462; train_global_loss: 27594410.5191; train_optim_loss: 27594410.5191; val_kl_reg_loss: 124262.7161; val_edge_recon_loss: 4051041.7833; val_gene_expr_recon_loss: 21961433.3333; val_masked_gp_l1_reg_loss: 77674.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195771.4531; val_chrom_access_recon_loss: 1244892.3250; val_global_loss: 27655076.0000; val_optim_loss: 27655076.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8862; val_auprc_score: 0.8752; val_best_acc_score: 0.8050; val_best_f1_score: 0.8262; train_kl_reg_loss: 129179.1237; train_edge_recon_loss: 3529348.5248; train_gene_expr_recon_loss: 22084101.2519; train_masked_gp_l1_reg_loss: 78442.6922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186949.9665; train_chrom_access_recon_loss: 1264142.5344; train_global_loss: 27272164.0916; train_optim_loss: 27272164.0916; val_kl_reg_loss: 132315.0042; val_edge_recon_loss: 3924127.0000; val_gene_expr_recon_loss: 21776882.9333; val_masked_gp_l1_reg_loss: 80045.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178401.1406; val_chrom_access_recon_loss: 1242733.6167; val_global_loss: 27334506.4000; val_optim_loss: 27334506.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8814; val_auprc_score: 0.8690; val_best_acc_score: 0.8014; val_best_f1_score: 0.8113; train_kl_reg_loss: 112332.8914; train_edge_recon_loss: 3257851.4351; train_gene_expr_recon_loss: 21922441.1298; train_masked_gp_l1_reg_loss: 83599.5312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170765.5886; train_chrom_access_recon_loss: 1257926.0134; train_global_loss: 26804916.6870; train_optim_loss: 26804916.6870; val_kl_reg_loss: 134524.9146; val_edge_recon_loss: 3071378.2500; val_gene_expr_recon_loss: 21663072.4000; val_masked_gp_l1_reg_loss: 88455.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163661.5469; val_chrom_access_recon_loss: 1236538.7500; val_global_loss: 26357632.2667; val_optim_loss: 26357632.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8963; val_auprc_score: 0.8817; val_best_acc_score: 0.8207; val_best_f1_score: 0.8306; train_kl_reg_loss: 143183.5493; train_edge_recon_loss: 2993723.0954; train_gene_expr_recon_loss: 21759482.5496; train_masked_gp_l1_reg_loss: 88414.2767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157928.1635; train_chrom_access_recon_loss: 1251532.1460; train_global_loss: 26394263.7710; train_optim_loss: 26394263.7710; val_kl_reg_loss: 143631.8906; val_edge_recon_loss: 2970571.2500; val_gene_expr_recon_loss: 21527573.0667; val_masked_gp_l1_reg_loss: 89272.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152246.5156; val_chrom_access_recon_loss: 1233245.2417; val_global_loss: 26116539.6000; val_optim_loss: 26116539.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9067; val_auprc_score: 0.8897; val_best_acc_score: 0.8323; val_best_f1_score: 0.8445; train_kl_reg_loss: 141324.9852; train_edge_recon_loss: 2931346.5363; train_gene_expr_recon_loss: 21590251.0076; train_masked_gp_l1_reg_loss: 90395.8002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146560.1299; train_chrom_access_recon_loss: 1243876.8406; train_global_loss: 26143755.2366; train_optim_loss: 26143755.2366; val_kl_reg_loss: 137873.6250; val_edge_recon_loss: 2903834.8833; val_gene_expr_recon_loss: 21348550.5333; val_masked_gp_l1_reg_loss: 91614.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140904.9688; val_chrom_access_recon_loss: 1223937.9917; val_global_loss: 25846714.9333; val_optim_loss: 25846714.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9159; val_auprc_score: 0.9022; val_best_acc_score: 0.8447; val_best_f1_score: 0.8530; train_kl_reg_loss: 142549.2786; train_edge_recon_loss: 2880608.6336; train_gene_expr_recon_loss: 21516088.7176; train_masked_gp_l1_reg_loss: 92727.2773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135800.4008; train_chrom_access_recon_loss: 1242383.5658; train_global_loss: 26010157.7710; train_optim_loss: 26010157.7710; val_kl_reg_loss: 135633.2563; val_edge_recon_loss: 2894290.1167; val_gene_expr_recon_loss: 21266071.8667; val_masked_gp_l1_reg_loss: 93953.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130868.2109; val_chrom_access_recon_loss: 1219485.3083; val_global_loss: 25740302.5333; val_optim_loss: 25740302.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9246; val_auprc_score: 0.9111; val_best_acc_score: 0.8544; val_best_f1_score: 0.8630; train_kl_reg_loss: 138397.1514; train_edge_recon_loss: 2866046.4256; train_gene_expr_recon_loss: 21418524.9160; train_masked_gp_l1_reg_loss: 94928.2796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126373.8418; train_chrom_access_recon_loss: 1238456.9714; train_global_loss: 25882727.6031; train_optim_loss: 25882727.6031; val_kl_reg_loss: 138089.6979; val_edge_recon_loss: 2864912.8500; val_gene_expr_recon_loss: 21173130.6667; val_masked_gp_l1_reg_loss: 96020.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122021.6562; val_chrom_access_recon_loss: 1214801.9917; val_global_loss: 25608977.0667; val_optim_loss: 25608977.0667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9270; val_auprc_score: 0.9160; val_best_acc_score: 0.8529; val_best_f1_score: 0.8627; train_kl_reg_loss: 134800.5499; train_edge_recon_loss: 2853512.5038; train_gene_expr_recon_loss: 21301771.4656; train_masked_gp_l1_reg_loss: 96945.3740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118119.1715; train_chrom_access_recon_loss: 1232377.1937; train_global_loss: 25737526.3359; train_optim_loss: 25737526.3359; val_kl_reg_loss: 129555.5130; val_edge_recon_loss: 2862463.6667; val_gene_expr_recon_loss: 21060389.3333; val_masked_gp_l1_reg_loss: 97794.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114249.8750; val_chrom_access_recon_loss: 1210839.0333; val_global_loss: 25475291.8667; val_optim_loss: 25475291.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9300; val_auprc_score: 0.9190; val_best_acc_score: 0.8565; val_best_f1_score: 0.8650; train_kl_reg_loss: 132107.0278; train_edge_recon_loss: 2847956.9885; train_gene_expr_recon_loss: 21238107.1756; train_masked_gp_l1_reg_loss: 98728.2875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110617.2587; train_chrom_access_recon_loss: 1230100.6784; train_global_loss: 25657617.6336; train_optim_loss: 25657617.6336; val_kl_reg_loss: 132684.4276; val_edge_recon_loss: 2845181.9833; val_gene_expr_recon_loss: 21065412.0000; val_masked_gp_l1_reg_loss: 99584.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107136.5859; val_chrom_access_recon_loss: 1217287.9417; val_global_loss: 25467286.5333; val_optim_loss: 25467286.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9275; val_auprc_score: 0.9114; val_best_acc_score: 0.8568; val_best_f1_score: 0.8670; train_kl_reg_loss: 128378.7526; train_edge_recon_loss: 2831531.7920; train_gene_expr_recon_loss: 21161689.4046; train_masked_gp_l1_reg_loss: 100435.2675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103916.8172; train_chrom_access_recon_loss: 1227730.5076; train_global_loss: 25553682.5191; train_optim_loss: 25553682.5191; val_kl_reg_loss: 124540.0979; val_edge_recon_loss: 2848307.1333; val_gene_expr_recon_loss: 21084752.5333; val_masked_gp_l1_reg_loss: 101352.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100760.5234; val_chrom_access_recon_loss: 1215147.1250; val_global_loss: 25474858.9333; val_optim_loss: 25474858.9333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9368; val_auprc_score: 0.9257; val_best_acc_score: 0.8651; val_best_f1_score: 0.8749; train_kl_reg_loss: 125697.8770; train_edge_recon_loss: 2828616.5592; train_gene_expr_recon_loss: 21096572.7634; train_masked_gp_l1_reg_loss: 101983.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97866.2797; train_chrom_access_recon_loss: 1224092.0763; train_global_loss: 25474829.0840; train_optim_loss: 25474829.0840; val_kl_reg_loss: 119437.0453; val_edge_recon_loss: 2825814.7500; val_gene_expr_recon_loss: 20923337.7333; val_masked_gp_l1_reg_loss: 102760.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95053.4062; val_chrom_access_recon_loss: 1207035.4833; val_global_loss: 25273438.9333; val_optim_loss: 25273438.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9459; val_auprc_score: 0.9359; val_best_acc_score: 0.8810; val_best_f1_score: 0.8848; train_kl_reg_loss: 120875.6242; train_edge_recon_loss: 2803512.3569; train_gene_expr_recon_loss: 21038393.4656; train_masked_gp_l1_reg_loss: 103506.0027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92374.8211; train_chrom_access_recon_loss: 1221957.4447; train_global_loss: 25380619.8168; train_optim_loss: 25380619.8168; val_kl_reg_loss: 119934.2500; val_edge_recon_loss: 2782641.0167; val_gene_expr_recon_loss: 20856955.2000; val_masked_gp_l1_reg_loss: 104270.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89777.3203; val_chrom_access_recon_loss: 1207676.8667; val_global_loss: 25161255.2000; val_optim_loss: 25161255.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9436; val_auprc_score: 0.9299; val_best_acc_score: 0.8785; val_best_f1_score: 0.8850; train_kl_reg_loss: 120242.9415; train_edge_recon_loss: 2801262.4218; train_gene_expr_recon_loss: 20995966.1221; train_masked_gp_l1_reg_loss: 104968.7993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87277.2765; train_chrom_access_recon_loss: 1220335.6966; train_global_loss: 25330053.4504; train_optim_loss: 25330053.4504; val_kl_reg_loss: 120822.2521; val_edge_recon_loss: 2800429.8333; val_gene_expr_recon_loss: 20831043.3333; val_masked_gp_l1_reg_loss: 105806.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84888.2109; val_chrom_access_recon_loss: 1206723.5583; val_global_loss: 25149713.2000; val_optim_loss: 25149713.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9450; val_auprc_score: 0.9323; val_best_acc_score: 0.8800; val_best_f1_score: 0.8849; train_kl_reg_loss: 117096.6127; train_edge_recon_loss: 2799534.4656; train_gene_expr_recon_loss: 20973294.5496; train_masked_gp_l1_reg_loss: 106451.1525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82502.7604; train_chrom_access_recon_loss: 1219268.8330; train_global_loss: 25298148.3969; train_optim_loss: 25298148.3969; val_kl_reg_loss: 112521.7302; val_edge_recon_loss: 2819516.6833; val_gene_expr_recon_loss: 20719935.7333; val_masked_gp_l1_reg_loss: 107115.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80250.9375; val_chrom_access_recon_loss: 1196771.0000; val_global_loss: 25036110.8000; val_optim_loss: 25036110.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9481; val_auprc_score: 0.9376; val_best_acc_score: 0.8839; val_best_f1_score: 0.8896; train_kl_reg_loss: 115567.0453; train_edge_recon_loss: 2776083.8034; train_gene_expr_recon_loss: 20920690.4427; train_masked_gp_l1_reg_loss: 107813.2418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78034.1545; train_chrom_access_recon_loss: 1217164.7920; train_global_loss: 25215353.5725; train_optim_loss: 25215353.5725; val_kl_reg_loss: 113118.4568; val_edge_recon_loss: 2792718.5167; val_gene_expr_recon_loss: 20829993.2000; val_masked_gp_l1_reg_loss: 108869.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75913.9375; val_chrom_access_recon_loss: 1206047.6167; val_global_loss: 25126661.8667; val_optim_loss: 25126661.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9542; val_auprc_score: 0.9439; val_best_acc_score: 0.8932; val_best_f1_score: 0.8993; train_kl_reg_loss: 113171.2384; train_edge_recon_loss: 2770744.1889; train_gene_expr_recon_loss: 20906293.0229; train_masked_gp_l1_reg_loss: 109366.4273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73936.2087; train_chrom_access_recon_loss: 1216848.3578; train_global_loss: 25190359.3893; train_optim_loss: 25190359.3893; val_kl_reg_loss: 109655.5068; val_edge_recon_loss: 2762293.3333; val_gene_expr_recon_loss: 20781484.1333; val_masked_gp_l1_reg_loss: 110081.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71940.2031; val_chrom_access_recon_loss: 1200618.2500; val_global_loss: 25036073.3333; val_optim_loss: 25036073.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9522; val_auprc_score: 0.9410; val_best_acc_score: 0.8918; val_best_f1_score: 0.8965; train_kl_reg_loss: 111564.2322; train_edge_recon_loss: 2770862.2939; train_gene_expr_recon_loss: 20849945.7863; train_masked_gp_l1_reg_loss: 110679.1786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70102.4755; train_chrom_access_recon_loss: 1215245.7653; train_global_loss: 25128399.6336; train_optim_loss: 25128399.6336; val_kl_reg_loss: 109389.3708; val_edge_recon_loss: 2784416.0833; val_gene_expr_recon_loss: 20744662.1333; val_masked_gp_l1_reg_loss: 111318.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68410.5547; val_chrom_access_recon_loss: 1200969.0000; val_global_loss: 25019164.2667; val_optim_loss: 25019164.2667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9559; val_auprc_score: 0.9457; val_best_acc_score: 0.8944; val_best_f1_score: 0.8973; train_kl_reg_loss: 110930.0905; train_edge_recon_loss: 2750563.8740; train_gene_expr_recon_loss: 20835469.7405; train_masked_gp_l1_reg_loss: 112068.3791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66789.1259; train_chrom_access_recon_loss: 1214100.4122; train_global_loss: 25089921.4809; train_optim_loss: 25089921.4809; val_kl_reg_loss: 110857.4719; val_edge_recon_loss: 2759336.3833; val_gene_expr_recon_loss: 20744443.8667; val_masked_gp_l1_reg_loss: 112609.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65130.2539; val_chrom_access_recon_loss: 1202121.0083; val_global_loss: 24994498.4000; val_optim_loss: 24994498.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9570; val_auprc_score: 0.9466; val_best_acc_score: 0.8975; val_best_f1_score: 0.9002; train_kl_reg_loss: 109694.1942; train_edge_recon_loss: 2756403.9103; train_gene_expr_recon_loss: 20795268.7481; train_masked_gp_l1_reg_loss: 113230.3609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63651.8368; train_chrom_access_recon_loss: 1213169.4771; train_global_loss: 25051418.5496; train_optim_loss: 25051418.5496; val_kl_reg_loss: 107971.3115; val_edge_recon_loss: 2775561.9333; val_gene_expr_recon_loss: 20646599.7333; val_masked_gp_l1_reg_loss: 113972.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62206.0078; val_chrom_access_recon_loss: 1195328.0667; val_global_loss: 24901638.8000; val_optim_loss: 24901638.8000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9595; val_auprc_score: 0.9512; val_best_acc_score: 0.8988; val_best_f1_score: 0.9020; train_kl_reg_loss: 107455.9040; train_edge_recon_loss: 2742956.6431; train_gene_expr_recon_loss: 20778338.9924; train_masked_gp_l1_reg_loss: 114642.9224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60813.7256; train_chrom_access_recon_loss: 1212985.8464; train_global_loss: 25017193.9695; train_optim_loss: 25017193.9695; val_kl_reg_loss: 108152.9484; val_edge_recon_loss: 2763317.8667; val_gene_expr_recon_loss: 20588815.3333; val_masked_gp_l1_reg_loss: 115542.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59519.6641; val_chrom_access_recon_loss: 1193393.0083; val_global_loss: 24828741.2000; val_optim_loss: 24828741.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9584; val_auprc_score: 0.9486; val_best_acc_score: 0.9012; val_best_f1_score: 0.9044; train_kl_reg_loss: 107075.9375; train_edge_recon_loss: 2746171.7824; train_gene_expr_recon_loss: 20755230.5954; train_masked_gp_l1_reg_loss: 116025.0936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58233.1084; train_chrom_access_recon_loss: 1212320.9113; train_global_loss: 24995057.4046; train_optim_loss: 24995057.4046; val_kl_reg_loss: 105727.3453; val_edge_recon_loss: 2760356.1333; val_gene_expr_recon_loss: 20586514.2667; val_masked_gp_l1_reg_loss: 116684.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56947.5703; val_chrom_access_recon_loss: 1193478.6250; val_global_loss: 24819708.4000; val_optim_loss: 24819708.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9606; val_auprc_score: 0.9520; val_best_acc_score: 0.9022; val_best_f1_score: 0.9045; train_kl_reg_loss: 104984.8548; train_edge_recon_loss: 2741568.8321; train_gene_expr_recon_loss: 20706711.1908; train_masked_gp_l1_reg_loss: 117195.1919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55849.1353; train_chrom_access_recon_loss: 1210632.7595; train_global_loss: 24936942.0153; train_optim_loss: 24936942.0153; val_kl_reg_loss: 103024.5885; val_edge_recon_loss: 2770149.1333; val_gene_expr_recon_loss: 20512749.4667; val_masked_gp_l1_reg_loss: 117848.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54742.7188; val_chrom_access_recon_loss: 1190940.3667; val_global_loss: 24749453.6000; val_optim_loss: 24749453.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9659; val_auprc_score: 0.9562; val_best_acc_score: 0.9092; val_best_f1_score: 0.9117; train_kl_reg_loss: 103690.7010; train_edge_recon_loss: 2738836.8950; train_gene_expr_recon_loss: 20700816.2901; train_masked_gp_l1_reg_loss: 118388.1099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53752.8602; train_chrom_access_recon_loss: 1211128.4284; train_global_loss: 24926613.2824; train_optim_loss: 24926613.2824; val_kl_reg_loss: 102246.0708; val_edge_recon_loss: 2742015.4500; val_gene_expr_recon_loss: 20465434.0000; val_masked_gp_l1_reg_loss: 119102.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52723.0703; val_chrom_access_recon_loss: 1189186.8333; val_global_loss: 24670708.1333; val_optim_loss: 24670708.1333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9570; val_auprc_score: 0.9456; val_best_acc_score: 0.8956; val_best_f1_score: 0.8983; train_kl_reg_loss: 126884.0957; train_edge_recon_loss: 2951116.4866; train_gene_expr_recon_loss: 22927279.2519; train_masked_gp_l1_reg_loss: 122542.8054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59146.1324; train_chrom_access_recon_loss: 1258940.2605; train_global_loss: 27445909.1603; train_optim_loss: 27445909.1603; val_kl_reg_loss: 19392.1932; val_edge_recon_loss: 2853176.2833; val_gene_expr_recon_loss: 22436601.4667; val_masked_gp_l1_reg_loss: 124379.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59823.3281; val_chrom_access_recon_loss: 1234663.9333; val_global_loss: 26728037.8667; val_optim_loss: 26728037.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9452; val_auprc_score: 0.9311; val_best_acc_score: 0.8868; val_best_f1_score: 0.8902; train_kl_reg_loss: 105451.6428; train_edge_recon_loss: 2850592.9924; train_gene_expr_recon_loss: 22693769.0992; train_masked_gp_l1_reg_loss: 124068.5594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58801.3981; train_chrom_access_recon_loss: 1252626.7004; train_global_loss: 27085310.3817; train_optim_loss: 27085310.3817; val_kl_reg_loss: 22774.5076; val_edge_recon_loss: 2862036.7833; val_gene_expr_recon_loss: 23021911.8667; val_masked_gp_l1_reg_loss: 123460.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57609.8125; val_chrom_access_recon_loss: 1243059.0583; val_global_loss: 27330852.0000; val_optim_loss: 27330852.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9283; val_auprc_score: 0.9137; val_best_acc_score: 0.8619; val_best_f1_score: 0.8696; train_kl_reg_loss: 87833.5655; train_edge_recon_loss: 2850743.4828; train_gene_expr_recon_loss: 23392080.6870; train_masked_gp_l1_reg_loss: 122810.0711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56290.1785; train_chrom_access_recon_loss: 1263815.2252; train_global_loss: 27773573.2061; train_optim_loss: 27773573.2061; val_kl_reg_loss: 12191.0290; val_edge_recon_loss: 2930095.2000; val_gene_expr_recon_loss: 23447417.8667; val_masked_gp_l1_reg_loss: 121665.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54471.8750; val_chrom_access_recon_loss: 1243780.9750; val_global_loss: 27809623.0667; val_optim_loss: 27809623.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9246; val_auprc_score: 0.9056; val_best_acc_score: 0.8608; val_best_f1_score: 0.8688; train_kl_reg_loss: 78962.0232; train_edge_recon_loss: 2833383.0573; train_gene_expr_recon_loss: 23706734.7176; train_masked_gp_l1_reg_loss: 119678.0153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52759.5981; train_chrom_access_recon_loss: 1257907.8426; train_global_loss: 28049425.1298; train_optim_loss: 28049425.1298; val_kl_reg_loss: 20708.3207; val_edge_recon_loss: 2831945.9000; val_gene_expr_recon_loss: 23382848.0000; val_masked_gp_l1_reg_loss: 117482.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51214.6602; val_chrom_access_recon_loss: 1237059.2167; val_global_loss: 27641257.4667; val_optim_loss: 27641257.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9257; val_auprc_score: 0.9030; val_best_acc_score: 0.8662; val_best_f1_score: 0.8743; train_kl_reg_loss: 67947.4419; train_edge_recon_loss: 2796663.4962; train_gene_expr_recon_loss: 23624981.4351; train_masked_gp_l1_reg_loss: 116971.4112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50921.4932; train_chrom_access_recon_loss: 1256118.3616; train_global_loss: 27913603.7557; train_optim_loss: 27913603.7557; val_kl_reg_loss: 20851.3398; val_edge_recon_loss: 2799324.9000; val_gene_expr_recon_loss: 23417652.8000; val_masked_gp_l1_reg_loss: 116692.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50670.5820; val_chrom_access_recon_loss: 1237229.5750; val_global_loss: 27642420.8000; val_optim_loss: 27642420.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9319; val_auprc_score: 0.9116; val_best_acc_score: 0.8728; val_best_f1_score: 0.8782; train_kl_reg_loss: 65473.7095; train_edge_recon_loss: 2790479.7366; train_gene_expr_recon_loss: 23590918.8550; train_masked_gp_l1_reg_loss: 116432.2084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50456.8395; train_chrom_access_recon_loss: 1256567.8731; train_global_loss: 27870329.1145; train_optim_loss: 27870329.1145; val_kl_reg_loss: 20957.4065; val_edge_recon_loss: 2779613.7500; val_gene_expr_recon_loss: 23410808.0000; val_masked_gp_l1_reg_loss: 116165.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50236.0000; val_chrom_access_recon_loss: 1236825.2667; val_global_loss: 27614606.6667; val_optim_loss: 27614606.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9280; val_auprc_score: 0.9061; val_best_acc_score: 0.8682; val_best_f1_score: 0.8752; train_kl_reg_loss: 64668.9554; train_edge_recon_loss: 2790557.3779; train_gene_expr_recon_loss: 23567391.5115; train_masked_gp_l1_reg_loss: 115894.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50034.5964; train_chrom_access_recon_loss: 1255566.5315; train_global_loss: 27844113.2061; train_optim_loss: 27844113.2061; val_kl_reg_loss: 21777.2652; val_edge_recon_loss: 2795220.1667; val_gene_expr_recon_loss: 23412753.3333; val_masked_gp_l1_reg_loss: 115607.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49817.1445; val_chrom_access_recon_loss: 1240652.9833; val_global_loss: 27635829.7333; val_optim_loss: 27635829.7333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9280; val_auprc_score: 0.9054; val_best_acc_score: 0.8682; val_best_f1_score: 0.8765; train_kl_reg_loss: 63502.3885; train_edge_recon_loss: 2781967.0496; train_gene_expr_recon_loss: 23540706.6870; train_masked_gp_l1_reg_loss: 115318.9941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49619.3302; train_chrom_access_recon_loss: 1254828.4380; train_global_loss: 27805942.8550; train_optim_loss: 27805942.8550; val_kl_reg_loss: 22045.6038; val_edge_recon_loss: 2786695.3333; val_gene_expr_recon_loss: 23499609.8667; val_masked_gp_l1_reg_loss: 115014.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49411.2109; val_chrom_access_recon_loss: 1244525.6500; val_global_loss: 27717302.8000; val_optim_loss: 27717302.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9690
val AUPRC score: 0.9588
val best accuracy score: 0.9157
val best F1 score: 0.9197
val target rna MSE score: 13.0313
val source rna MSE score: 187.5243
val target atac MSE score: 0.5898
val source atac MSE score: 6.3042
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
