[True]
Run timestamp: 09102023_230022_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6962; val_auprc_score: 0.6674; val_best_acc_score: 0.5064; val_best_f1_score: 0.6691; train_kl_reg_loss: 45163.3846; train_edge_recon_loss: 3502238.0682; train_gene_expr_recon_loss: 13918713.0758; train_masked_gp_l1_reg_loss: 30326.1185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3620934.1307; train_chrom_access_recon_loss: 2973043.9697; train_global_loss: 24090418.7879; train_optim_loss: 24090418.7879; val_kl_reg_loss: 113508.0342; val_edge_recon_loss: 4064699.2500; val_gene_expr_recon_loss: 12953462.8750; val_masked_gp_l1_reg_loss: 36273.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1998912.0000; val_chrom_access_recon_loss: 2859170.2812; val_global_loss: 22026026.7500; val_optim_loss: 22026026.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6878; val_auprc_score: 0.6722; val_best_acc_score: 0.6064; val_best_f1_score: 0.6943; train_kl_reg_loss: 83414.5152; train_edge_recon_loss: 3511774.9773; train_gene_expr_recon_loss: 12813487.7273; train_masked_gp_l1_reg_loss: 38157.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1086856.8248; train_chrom_access_recon_loss: 2836572.1098; train_global_loss: 20370264.0303; train_optim_loss: 20370264.0303; val_kl_reg_loss: 83444.4912; val_edge_recon_loss: 4057277.5625; val_gene_expr_recon_loss: 12803413.2500; val_masked_gp_l1_reg_loss: 39841.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 522825.7188; val_chrom_access_recon_loss: 2862737.8750; val_global_loss: 20369540.7500; val_optim_loss: 20369540.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7557; val_auprc_score: 0.7399; val_best_acc_score: 0.6658; val_best_f1_score: 0.7226; train_kl_reg_loss: 78272.9253; train_edge_recon_loss: 3504328.5606; train_gene_expr_recon_loss: 12686119.6818; train_masked_gp_l1_reg_loss: 41197.9415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 349742.5843; train_chrom_access_recon_loss: 2812339.9394; train_global_loss: 19472001.5758; train_optim_loss: 19472001.5758; val_kl_reg_loss: 73352.8145; val_edge_recon_loss: 3981988.7500; val_gene_expr_recon_loss: 12892598.6250; val_masked_gp_l1_reg_loss: 42788.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237121.5781; val_chrom_access_recon_loss: 2843691.1875; val_global_loss: 20071541.0000; val_optim_loss: 20071541.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7563; val_auprc_score: 0.7481; val_best_acc_score: 0.6706; val_best_f1_score: 0.7267; train_kl_reg_loss: 60462.6716; train_edge_recon_loss: 3349965.1136; train_gene_expr_recon_loss: 12608853.1515; train_masked_gp_l1_reg_loss: 44924.4992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188775.6984; train_chrom_access_recon_loss: 2800654.9508; train_global_loss: 19053636.1515; train_optim_loss: 19053636.1515; val_kl_reg_loss: 72765.2607; val_edge_recon_loss: 3287247.5000; val_gene_expr_recon_loss: 12668247.2500; val_masked_gp_l1_reg_loss: 47644.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151891.8125; val_chrom_access_recon_loss: 2777182.4062; val_global_loss: 19004979.5000; val_optim_loss: 19004979.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7946; val_auprc_score: 0.7963; val_best_acc_score: 0.6967; val_best_f1_score: 0.7437; train_kl_reg_loss: 85387.7415; train_edge_recon_loss: 3109486.8485; train_gene_expr_recon_loss: 12559585.3485; train_masked_gp_l1_reg_loss: 49280.8103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133245.2912; train_chrom_access_recon_loss: 2784360.4167; train_global_loss: 18721346.4242; train_optim_loss: 18721346.4242; val_kl_reg_loss: 93430.9756; val_edge_recon_loss: 3156206.1562; val_gene_expr_recon_loss: 12645802.8750; val_masked_gp_l1_reg_loss: 50940.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119398.8359; val_chrom_access_recon_loss: 2773768.7500; val_global_loss: 18839547.7500; val_optim_loss: 18839547.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8421; val_auprc_score: 0.8291; val_best_acc_score: 0.7563; val_best_f1_score: 0.7655; train_kl_reg_loss: 90009.2607; train_edge_recon_loss: 3025592.4924; train_gene_expr_recon_loss: 12474844.2273; train_masked_gp_l1_reg_loss: 52388.7046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111166.9964; train_chrom_access_recon_loss: 2771262.6364; train_global_loss: 18525264.4242; train_optim_loss: 18525264.4242; val_kl_reg_loss: 83920.0771; val_edge_recon_loss: 2997385.4375; val_gene_expr_recon_loss: 12469656.6250; val_masked_gp_l1_reg_loss: 53754.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105551.0547; val_chrom_access_recon_loss: 2760250.5000; val_global_loss: 18470518.5000; val_optim_loss: 18470518.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8882; val_auprc_score: 0.8622; val_best_acc_score: 0.8213; val_best_f1_score: 0.8309; train_kl_reg_loss: 83764.1251; train_edge_recon_loss: 2893019.4659; train_gene_expr_recon_loss: 12378876.7121; train_masked_gp_l1_reg_loss: 55547.6136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102262.4622; train_chrom_access_recon_loss: 2753318.1174; train_global_loss: 18266788.4545; train_optim_loss: 18266788.4545; val_kl_reg_loss: 92012.3799; val_edge_recon_loss: 2905436.3125; val_gene_expr_recon_loss: 12518546.1250; val_masked_gp_l1_reg_loss: 57399.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98487.7109; val_chrom_access_recon_loss: 2772572.6250; val_global_loss: 18444455.2500; val_optim_loss: 18444455.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8994; val_auprc_score: 0.8709; val_best_acc_score: 0.8353; val_best_f1_score: 0.8487; train_kl_reg_loss: 95490.9760; train_edge_recon_loss: 2809317.1288; train_gene_expr_recon_loss: 12303214.1667; train_masked_gp_l1_reg_loss: 58525.4106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95521.9351; train_chrom_access_recon_loss: 2743822.5682; train_global_loss: 18105892.3636; train_optim_loss: 18105892.3636; val_kl_reg_loss: 99983.7900; val_edge_recon_loss: 2853408.6875; val_gene_expr_recon_loss: 12427995.6250; val_masked_gp_l1_reg_loss: 59594.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92405.4922; val_chrom_access_recon_loss: 2719258.4688; val_global_loss: 18252645.0000; val_optim_loss: 18252645.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8961; val_auprc_score: 0.8679; val_best_acc_score: 0.8342; val_best_f1_score: 0.8459; train_kl_reg_loss: 95650.4418; train_edge_recon_loss: 2814478.0606; train_gene_expr_recon_loss: 12236672.4697; train_masked_gp_l1_reg_loss: 60473.6723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90606.5210; train_chrom_access_recon_loss: 2730011.3712; train_global_loss: 18027892.6970; train_optim_loss: 18027892.6970; val_kl_reg_loss: 93451.0752; val_edge_recon_loss: 2846785.8438; val_gene_expr_recon_loss: 12331990.1250; val_masked_gp_l1_reg_loss: 61393.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88242.8125; val_chrom_access_recon_loss: 2710401.1562; val_global_loss: 18132264.2500; val_optim_loss: 18132264.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9088; val_auprc_score: 0.8783; val_best_acc_score: 0.8455; val_best_f1_score: 0.8567; train_kl_reg_loss: 90736.9019; train_edge_recon_loss: 2811739.2424; train_gene_expr_recon_loss: 12183233.0758; train_masked_gp_l1_reg_loss: 62229.1964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86426.4878; train_chrom_access_recon_loss: 2717242.1742; train_global_loss: 17951607.0606; train_optim_loss: 17951607.0606; val_kl_reg_loss: 89272.3008; val_edge_recon_loss: 2817301.3750; val_gene_expr_recon_loss: 12285931.8750; val_masked_gp_l1_reg_loss: 63136.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84291.9531; val_chrom_access_recon_loss: 2725041.5312; val_global_loss: 18064975.0000; val_optim_loss: 18064975.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9055; val_auprc_score: 0.8743; val_best_acc_score: 0.8458; val_best_f1_score: 0.8584; train_kl_reg_loss: 89228.9055; train_edge_recon_loss: 2789059.2386; train_gene_expr_recon_loss: 12141127.5455; train_masked_gp_l1_reg_loss: 63892.9217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82228.0456; train_chrom_access_recon_loss: 2709172.3598; train_global_loss: 17874708.8485; train_optim_loss: 17874708.8485; val_kl_reg_loss: 87927.9082; val_edge_recon_loss: 2824189.3125; val_gene_expr_recon_loss: 12251803.7500; val_masked_gp_l1_reg_loss: 64559.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80794.7188; val_chrom_access_recon_loss: 2740240.2500; val_global_loss: 18049516.0000; val_optim_loss: 18049516.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9039; val_auprc_score: 0.8703; val_best_acc_score: 0.8412; val_best_f1_score: 0.8509; train_kl_reg_loss: 86182.5502; train_edge_recon_loss: 2785844.5947; train_gene_expr_recon_loss: 12098242.0303; train_masked_gp_l1_reg_loss: 65267.0118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79496.1503; train_chrom_access_recon_loss: 2701704.1023; train_global_loss: 17816736.5152; train_optim_loss: 17816736.5152; val_kl_reg_loss: 87454.2275; val_edge_recon_loss: 2816879.7500; val_gene_expr_recon_loss: 12152575.5000; val_masked_gp_l1_reg_loss: 66156.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78350.5547; val_chrom_access_recon_loss: 2698899.7188; val_global_loss: 17900316.5000; val_optim_loss: 17900316.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9032; val_auprc_score: 0.8688; val_best_acc_score: 0.8455; val_best_f1_score: 0.8560; train_kl_reg_loss: 84427.1108; train_edge_recon_loss: 2782757.2765; train_gene_expr_recon_loss: 12058935.0303; train_masked_gp_l1_reg_loss: 66661.0895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77058.5625; train_chrom_access_recon_loss: 2692208.7159; train_global_loss: 17762047.7879; train_optim_loss: 17762047.7879; val_kl_reg_loss: 85859.3594; val_edge_recon_loss: 2825356.0312; val_gene_expr_recon_loss: 12097589.6250; val_masked_gp_l1_reg_loss: 67268.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76356.6953; val_chrom_access_recon_loss: 2704740.2188; val_global_loss: 17857170.7500; val_optim_loss: 17857170.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9051; val_auprc_score: 0.8697; val_best_acc_score: 0.8450; val_best_f1_score: 0.8547; train_kl_reg_loss: 84600.1803; train_edge_recon_loss: 2767402.0644; train_gene_expr_recon_loss: 12018187.8182; train_masked_gp_l1_reg_loss: 67804.7491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75827.1751; train_chrom_access_recon_loss: 2684725.1705; train_global_loss: 17698547.2121; train_optim_loss: 17698547.2121; val_kl_reg_loss: 84633.1689; val_edge_recon_loss: 2848507.1250; val_gene_expr_recon_loss: 12049772.6250; val_masked_gp_l1_reg_loss: 68383.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75246.4609; val_chrom_access_recon_loss: 2657137.0625; val_global_loss: 17783678.7500; val_optim_loss: 17783678.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9169; val_auprc_score: 0.8920; val_best_acc_score: 0.8536; val_best_f1_score: 0.8618; train_kl_reg_loss: 81404.1536; train_edge_recon_loss: 2757310.1402; train_gene_expr_recon_loss: 11976923.5455; train_masked_gp_l1_reg_loss: 68865.5651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74885.2470; train_chrom_access_recon_loss: 2674313.5644; train_global_loss: 17633702.2879; train_optim_loss: 17633702.2879; val_kl_reg_loss: 83178.9277; val_edge_recon_loss: 2811809.6875; val_gene_expr_recon_loss: 12041056.5000; val_masked_gp_l1_reg_loss: 69460.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74876.3750; val_chrom_access_recon_loss: 2674936.0938; val_global_loss: 17755318.2500; val_optim_loss: 17755318.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9201; val_auprc_score: 0.8953; val_best_acc_score: 0.8603; val_best_f1_score: 0.8679; train_kl_reg_loss: 80667.8987; train_edge_recon_loss: 2759515.3977; train_gene_expr_recon_loss: 11945789.1667; train_masked_gp_l1_reg_loss: 69867.4631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74376.8314; train_chrom_access_recon_loss: 2668579.1515; train_global_loss: 17598795.7879; train_optim_loss: 17598795.7879; val_kl_reg_loss: 75632.6826; val_edge_recon_loss: 2807500.1875; val_gene_expr_recon_loss: 12060337.5000; val_masked_gp_l1_reg_loss: 70332.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74414.8047; val_chrom_access_recon_loss: 2671609.6875; val_global_loss: 17759827.7500; val_optim_loss: 17759827.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9157; val_auprc_score: 0.8860; val_best_acc_score: 0.8571; val_best_f1_score: 0.8655; train_kl_reg_loss: 81980.4113; train_edge_recon_loss: 2741198.0341; train_gene_expr_recon_loss: 11910557.7273; train_masked_gp_l1_reg_loss: 70652.5798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73810.2312; train_chrom_access_recon_loss: 2662119.4356; train_global_loss: 17540318.3030; train_optim_loss: 17540318.3030; val_kl_reg_loss: 79904.2754; val_edge_recon_loss: 2805932.1250; val_gene_expr_recon_loss: 11987476.2500; val_masked_gp_l1_reg_loss: 70956.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73549.9297; val_chrom_access_recon_loss: 2677908.9375; val_global_loss: 17695727.5000; val_optim_loss: 17695727.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9225; val_auprc_score: 0.8946; val_best_acc_score: 0.8678; val_best_f1_score: 0.8765; train_kl_reg_loss: 80129.6626; train_edge_recon_loss: 2735225.0417; train_gene_expr_recon_loss: 11883890.6667; train_masked_gp_l1_reg_loss: 71341.5449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73529.3523; train_chrom_access_recon_loss: 2657874.5341; train_global_loss: 17501990.9091; train_optim_loss: 17501990.9091; val_kl_reg_loss: 79643.4854; val_edge_recon_loss: 2765575.3438; val_gene_expr_recon_loss: 11973231.5000; val_masked_gp_l1_reg_loss: 71785.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72973.1172; val_chrom_access_recon_loss: 2659707.4688; val_global_loss: 17622917.0000; val_optim_loss: 17622917.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9212; val_auprc_score: 0.8888; val_best_acc_score: 0.8708; val_best_f1_score: 0.8769; train_kl_reg_loss: 79817.4536; train_edge_recon_loss: 2735944.3220; train_gene_expr_recon_loss: 11850696.8182; train_masked_gp_l1_reg_loss: 72096.5514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73068.3875; train_chrom_access_recon_loss: 2649731.8485; train_global_loss: 17461355.3939; train_optim_loss: 17461355.3939; val_kl_reg_loss: 78345.2656; val_edge_recon_loss: 2754594.4062; val_gene_expr_recon_loss: 12017734.2500; val_masked_gp_l1_reg_loss: 72505.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72933.0000; val_chrom_access_recon_loss: 2675098.8750; val_global_loss: 17671210.7500; val_optim_loss: 17671210.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9273; val_auprc_score: 0.9054; val_best_acc_score: 0.8692; val_best_f1_score: 0.8743; train_kl_reg_loss: 78048.1971; train_edge_recon_loss: 2746367.9545; train_gene_expr_recon_loss: 11819787.1364; train_masked_gp_l1_reg_loss: 72764.4335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72637.4139; train_chrom_access_recon_loss: 2641107.5417; train_global_loss: 17430712.6061; train_optim_loss: 17430712.6061; val_kl_reg_loss: 77380.2969; val_edge_recon_loss: 2801830.8125; val_gene_expr_recon_loss: 11801972.1250; val_masked_gp_l1_reg_loss: 73126.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72053.5547; val_chrom_access_recon_loss: 2637281.4375; val_global_loss: 17463644.2500; val_optim_loss: 17463644.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9267; val_auprc_score: 0.8985; val_best_acc_score: 0.8694; val_best_f1_score: 0.8763; train_kl_reg_loss: 78427.1367; train_edge_recon_loss: 2739174.5947; train_gene_expr_recon_loss: 11805366.6818; train_masked_gp_l1_reg_loss: 73358.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71847.9962; train_chrom_access_recon_loss: 2637109.5909; train_global_loss: 17405284.3333; train_optim_loss: 17405284.3333; val_kl_reg_loss: 76819.3340; val_edge_recon_loss: 2765104.3438; val_gene_expr_recon_loss: 11820424.1250; val_masked_gp_l1_reg_loss: 73591.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72133.3438; val_chrom_access_recon_loss: 2640372.8750; val_global_loss: 17448444.7500; val_optim_loss: 17448444.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9313; val_auprc_score: 0.9084; val_best_acc_score: 0.8737; val_best_f1_score: 0.8797; train_kl_reg_loss: 75358.4034; train_edge_recon_loss: 2723526.9318; train_gene_expr_recon_loss: 11766067.4697; train_masked_gp_l1_reg_loss: 73876.6069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71651.4622; train_chrom_access_recon_loss: 2629888.9621; train_global_loss: 17340369.8182; train_optim_loss: 17340369.8182; val_kl_reg_loss: 76807.1836; val_edge_recon_loss: 2748427.1250; val_gene_expr_recon_loss: 11797224.1250; val_masked_gp_l1_reg_loss: 74195.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71194.7500; val_chrom_access_recon_loss: 2638128.4062; val_global_loss: 17405976.8750; val_optim_loss: 17405976.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9272; val_auprc_score: 0.9013; val_best_acc_score: 0.8702; val_best_f1_score: 0.8780; train_kl_reg_loss: 75987.0381; train_edge_recon_loss: 2726027.8977; train_gene_expr_recon_loss: 11750176.6515; train_masked_gp_l1_reg_loss: 74476.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71276.6541; train_chrom_access_recon_loss: 2623169.0833; train_global_loss: 17321113.7121; train_optim_loss: 17321113.7121; val_kl_reg_loss: 77173.9639; val_edge_recon_loss: 2753148.1875; val_gene_expr_recon_loss: 11815196.1250; val_masked_gp_l1_reg_loss: 74793.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71020.7344; val_chrom_access_recon_loss: 2622306.7188; val_global_loss: 17413640.2500; val_optim_loss: 17413640.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9397; val_auprc_score: 0.9103; val_best_acc_score: 0.8837; val_best_f1_score: 0.8902; train_kl_reg_loss: 75626.4722; train_edge_recon_loss: 2722030.7689; train_gene_expr_recon_loss: 11721560.0455; train_masked_gp_l1_reg_loss: 74981.7816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70969.6063; train_chrom_access_recon_loss: 2617158.7235; train_global_loss: 17282327.4091; train_optim_loss: 17282327.4091; val_kl_reg_loss: 75723.1816; val_edge_recon_loss: 2738057.1250; val_gene_expr_recon_loss: 11912156.5000; val_masked_gp_l1_reg_loss: 75259.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71013.2109; val_chrom_access_recon_loss: 2630620.7500; val_global_loss: 17502829.6250; val_optim_loss: 17502829.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9437; val_auprc_score: 0.9224; val_best_acc_score: 0.8880; val_best_f1_score: 0.8948; train_kl_reg_loss: 75113.2659; train_edge_recon_loss: 2706154.7008; train_gene_expr_recon_loss: 11695054.8939; train_masked_gp_l1_reg_loss: 75452.4612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70751.7951; train_chrom_access_recon_loss: 2612139.3561; train_global_loss: 17234666.4545; train_optim_loss: 17234666.4545; val_kl_reg_loss: 74644.6992; val_edge_recon_loss: 2739265.4375; val_gene_expr_recon_loss: 11689790.8750; val_masked_gp_l1_reg_loss: 75714.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70857.7188; val_chrom_access_recon_loss: 2610821.1562; val_global_loss: 17261094.2500; val_optim_loss: 17261094.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9317; val_auprc_score: 0.9039; val_best_acc_score: 0.8761; val_best_f1_score: 0.8845; train_kl_reg_loss: 95590.0520; train_edge_recon_loss: 2800274.2765; train_gene_expr_recon_loss: 10828591.0303; train_masked_gp_l1_reg_loss: 75678.4536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66938.3055; train_chrom_access_recon_loss: 2468764.0492; train_global_loss: 16335836.1515; train_optim_loss: 16335836.1515; val_kl_reg_loss: 31864.6375; val_edge_recon_loss: 2784125.7188; val_gene_expr_recon_loss: 10884532.0000; val_masked_gp_l1_reg_loss: 75535.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66994.9219; val_chrom_access_recon_loss: 2444572.4688; val_global_loss: 16287625.7500; val_optim_loss: 16287625.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9354; val_auprc_score: 0.9068; val_best_acc_score: 0.8837; val_best_f1_score: 0.8878; train_kl_reg_loss: 82076.0740; train_edge_recon_loss: 2746398.7652; train_gene_expr_recon_loss: 10768032.8333; train_masked_gp_l1_reg_loss: 75198.1855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67378.2276; train_chrom_access_recon_loss: 2428971.4053; train_global_loss: 16168055.4242; train_optim_loss: 16168055.4242; val_kl_reg_loss: 37400.7549; val_edge_recon_loss: 2753335.6562; val_gene_expr_recon_loss: 10881911.0000; val_masked_gp_l1_reg_loss: 74858.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67642.2578; val_chrom_access_recon_loss: 2438936.3438; val_global_loss: 16254083.6250; val_optim_loss: 16254083.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9375; val_auprc_score: 0.9130; val_best_acc_score: 0.8837; val_best_f1_score: 0.8888; train_kl_reg_loss: 71624.9325; train_edge_recon_loss: 2723869.4659; train_gene_expr_recon_loss: 10742196.9545; train_masked_gp_l1_reg_loss: 74460.1313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67454.6246; train_chrom_access_recon_loss: 2423965.5568; train_global_loss: 16103571.6364; train_optim_loss: 16103571.6364; val_kl_reg_loss: 39764.7583; val_edge_recon_loss: 2773220.9688; val_gene_expr_recon_loss: 10796407.6250; val_masked_gp_l1_reg_loss: 74124.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67410.3047; val_chrom_access_recon_loss: 2409407.2500; val_global_loss: 16160335.7500; val_optim_loss: 16160335.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9463; val_auprc_score: 0.9254; val_best_acc_score: 0.8949; val_best_f1_score: 0.8999; train_kl_reg_loss: 65208.2656; train_edge_recon_loss: 2710549.3030; train_gene_expr_recon_loss: 10723379.0909; train_masked_gp_l1_reg_loss: 73724.4959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67452.6259; train_chrom_access_recon_loss: 2417060.3939; train_global_loss: 16057374.1818; train_optim_loss: 16057374.1818; val_kl_reg_loss: 43532.0562; val_edge_recon_loss: 2717805.8125; val_gene_expr_recon_loss: 10743407.7500; val_masked_gp_l1_reg_loss: 73378.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67712.7266; val_chrom_access_recon_loss: 2412995.9688; val_global_loss: 16058832.6250; val_optim_loss: 16058832.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9443; val_auprc_score: 0.9202; val_best_acc_score: 0.8877; val_best_f1_score: 0.8936; train_kl_reg_loss: 61639.6480; train_edge_recon_loss: 2702369.6250; train_gene_expr_recon_loss: 10708832.7273; train_masked_gp_l1_reg_loss: 72963.6512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67561.7143; train_chrom_access_recon_loss: 2411553.2765; train_global_loss: 16024920.5909; train_optim_loss: 16024920.5909; val_kl_reg_loss: 46229.5981; val_edge_recon_loss: 2744629.6250; val_gene_expr_recon_loss: 10779028.6250; val_masked_gp_l1_reg_loss: 72540.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67306.6484; val_chrom_access_recon_loss: 2396752.3125; val_global_loss: 16106488.1250; val_optim_loss: 16106488.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9440; val_auprc_score: 0.9224; val_best_acc_score: 0.8877; val_best_f1_score: 0.8942; train_kl_reg_loss: 59120.5959; train_edge_recon_loss: 2702702.9432; train_gene_expr_recon_loss: 10689857.2879; train_masked_gp_l1_reg_loss: 72203.6239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67183.8915; train_chrom_access_recon_loss: 2408543.6932; train_global_loss: 15999612.0758; train_optim_loss: 15999612.0758; val_kl_reg_loss: 47498.2778; val_edge_recon_loss: 2742084.3438; val_gene_expr_recon_loss: 10678047.2500; val_masked_gp_l1_reg_loss: 71907.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67462.8906; val_chrom_access_recon_loss: 2400792.9688; val_global_loss: 16007793.6250; val_optim_loss: 16007793.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9495; val_auprc_score: 0.9265; val_best_acc_score: 0.8990; val_best_f1_score: 0.9042; train_kl_reg_loss: 59378.0057; train_edge_recon_loss: 2700390.4394; train_gene_expr_recon_loss: 10668846.0152; train_masked_gp_l1_reg_loss: 71554.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67067.7076; train_chrom_access_recon_loss: 2405734.3598; train_global_loss: 15972971.0303; train_optim_loss: 15972971.0303; val_kl_reg_loss: 49735.6294; val_edge_recon_loss: 2675876.7812; val_gene_expr_recon_loss: 10673017.8750; val_masked_gp_l1_reg_loss: 71209.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67167.7109; val_chrom_access_recon_loss: 2400236.7500; val_global_loss: 15937244.0000; val_optim_loss: 15937244.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9515; val_auprc_score: 0.9335; val_best_acc_score: 0.8995; val_best_f1_score: 0.9031; train_kl_reg_loss: 58700.8105; train_edge_recon_loss: 2697723.4242; train_gene_expr_recon_loss: 10655753.8939; train_masked_gp_l1_reg_loss: 70837.1776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66776.4980; train_chrom_access_recon_loss: 2402156.4091; train_global_loss: 15951948.1212; train_optim_loss: 15951948.1212; val_kl_reg_loss: 47508.0801; val_edge_recon_loss: 2715291.5000; val_gene_expr_recon_loss: 10727542.6250; val_masked_gp_l1_reg_loss: 70483.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67055.5234; val_chrom_access_recon_loss: 2401773.9375; val_global_loss: 16029656.0000; val_optim_loss: 16029656.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9498; val_auprc_score: 0.9282; val_best_acc_score: 0.8955; val_best_f1_score: 0.9010; train_kl_reg_loss: 56818.5179; train_edge_recon_loss: 2698487.2765; train_gene_expr_recon_loss: 10640079.3182; train_masked_gp_l1_reg_loss: 70161.1676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66813.8202; train_chrom_access_recon_loss: 2401419.5833; train_global_loss: 15933779.8485; train_optim_loss: 15933779.8485; val_kl_reg_loss: 48958.3589; val_edge_recon_loss: 2717957.4375; val_gene_expr_recon_loss: 10605958.6250; val_masked_gp_l1_reg_loss: 69901.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66504.0000; val_chrom_access_recon_loss: 2397820.5000; val_global_loss: 15907100.8750; val_optim_loss: 15907100.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9516; val_auprc_score: 0.9314; val_best_acc_score: 0.8987; val_best_f1_score: 0.9022; train_kl_reg_loss: 55592.0875; train_edge_recon_loss: 2695509.0720; train_gene_expr_recon_loss: 10616674.2879; train_masked_gp_l1_reg_loss: 69596.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66171.5341; train_chrom_access_recon_loss: 2395572.5682; train_global_loss: 15899116.1515; train_optim_loss: 15899116.1515; val_kl_reg_loss: 51838.8970; val_edge_recon_loss: 2705809.0312; val_gene_expr_recon_loss: 10681243.3750; val_masked_gp_l1_reg_loss: 69350.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65884.1797; val_chrom_access_recon_loss: 2413237.7500; val_global_loss: 15987363.8750; val_optim_loss: 15987363.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9549; val_auprc_score: 0.9343; val_best_acc_score: 0.9038; val_best_f1_score: 0.9060; train_kl_reg_loss: 56349.1050; train_edge_recon_loss: 2687140.7992; train_gene_expr_recon_loss: 10588114.3030; train_masked_gp_l1_reg_loss: 69062.5411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65874.9955; train_chrom_access_recon_loss: 2390972.2652; train_global_loss: 15857513.9242; train_optim_loss: 15857513.9242; val_kl_reg_loss: 51452.0640; val_edge_recon_loss: 2689618.1250; val_gene_expr_recon_loss: 10668323.5000; val_masked_gp_l1_reg_loss: 68812.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65657.6406; val_chrom_access_recon_loss: 2385930.8438; val_global_loss: 15929794.3750; val_optim_loss: 15929794.3750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9548; val_auprc_score: 0.9311; val_best_acc_score: 0.9078; val_best_f1_score: 0.9107; train_kl_reg_loss: 55994.7905; train_edge_recon_loss: 2686480.2235; train_gene_expr_recon_loss: 10577923.0455; train_masked_gp_l1_reg_loss: 68551.6932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65511.9405; train_chrom_access_recon_loss: 2390693.2348; train_global_loss: 15845155.0152; train_optim_loss: 15845155.0152; val_kl_reg_loss: 52137.1099; val_edge_recon_loss: 2689015.4375; val_gene_expr_recon_loss: 10652995.6250; val_masked_gp_l1_reg_loss: 68358.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65865.3281; val_chrom_access_recon_loss: 2387939.9062; val_global_loss: 15916312.2500; val_optim_loss: 15916312.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9545; val_auprc_score: 0.9340; val_best_acc_score: 0.8995; val_best_f1_score: 0.9032; train_kl_reg_loss: 54897.8938; train_edge_recon_loss: 2681089.8409; train_gene_expr_recon_loss: 10575941.9697; train_masked_gp_l1_reg_loss: 68161.5341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65516.4563; train_chrom_access_recon_loss: 2388705.4394; train_global_loss: 15834313.0455; train_optim_loss: 15834313.0455; val_kl_reg_loss: 51051.4697; val_edge_recon_loss: 2709294.7500; val_gene_expr_recon_loss: 10588925.3750; val_masked_gp_l1_reg_loss: 67993.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65272.9258; val_chrom_access_recon_loss: 2388107.6875; val_global_loss: 15870646.2500; val_optim_loss: 15870646.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9488; val_auprc_score: 0.9286; val_best_acc_score: 0.8976; val_best_f1_score: 0.9017; train_kl_reg_loss: 55842.8347; train_edge_recon_loss: 2676381.1098; train_gene_expr_recon_loss: 10557196.6818; train_masked_gp_l1_reg_loss: 67772.6585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65189.6916; train_chrom_access_recon_loss: 2385166.2879; train_global_loss: 15807549.2576; train_optim_loss: 15807549.2576; val_kl_reg_loss: 51321.6709; val_edge_recon_loss: 2723361.2188; val_gene_expr_recon_loss: 10657759.2500; val_masked_gp_l1_reg_loss: 67605.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65270.1016; val_chrom_access_recon_loss: 2396268.3438; val_global_loss: 15961585.3750; val_optim_loss: 15961585.3750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9484; val_auprc_score: 0.9276; val_best_acc_score: 0.8958; val_best_f1_score: 0.9007; train_kl_reg_loss: 54557.0814; train_edge_recon_loss: 2669938.9545; train_gene_expr_recon_loss: 10541259.4697; train_masked_gp_l1_reg_loss: 67384.2805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65330.2056; train_chrom_access_recon_loss: 2382512.8902; train_global_loss: 15780982.8182; train_optim_loss: 15780982.8182; val_kl_reg_loss: 52473.1025; val_edge_recon_loss: 2721590.0312; val_gene_expr_recon_loss: 10555818.0000; val_masked_gp_l1_reg_loss: 67200.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65167.0820; val_chrom_access_recon_loss: 2374335.0938; val_global_loss: 15836584.1250; val_optim_loss: 15836584.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9565; val_auprc_score: 0.9409; val_best_acc_score: 0.9065; val_best_f1_score: 0.9100; train_kl_reg_loss: 55913.6529; train_edge_recon_loss: 2673884.9848; train_gene_expr_recon_loss: 10536679.2273; train_masked_gp_l1_reg_loss: 66991.1384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64954.5835; train_chrom_access_recon_loss: 2380144.8182; train_global_loss: 15778568.4697; train_optim_loss: 15778568.4697; val_kl_reg_loss: 51194.2129; val_edge_recon_loss: 2709049.0625; val_gene_expr_recon_loss: 10580502.2500; val_masked_gp_l1_reg_loss: 66897.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64929.6680; val_chrom_access_recon_loss: 2373263.1875; val_global_loss: 15845836.0000; val_optim_loss: 15845836.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9504; val_auprc_score: 0.9247; val_best_acc_score: 0.8968; val_best_f1_score: 0.9025; train_kl_reg_loss: 56242.4012; train_edge_recon_loss: 2677358.4167; train_gene_expr_recon_loss: 10523416.0606; train_masked_gp_l1_reg_loss: 66714.9671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64982.8053; train_chrom_access_recon_loss: 2376568.9470; train_global_loss: 15765283.6212; train_optim_loss: 15765283.6212; val_kl_reg_loss: 49203.5503; val_edge_recon_loss: 2753618.2812; val_gene_expr_recon_loss: 10667179.7500; val_masked_gp_l1_reg_loss: 66538.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65163.0039; val_chrom_access_recon_loss: 2400455.7812; val_global_loss: 16002158.5000; val_optim_loss: 16002158.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9521; val_auprc_score: 0.9347; val_best_acc_score: 0.8992; val_best_f1_score: 0.9040; train_kl_reg_loss: 55088.3911; train_edge_recon_loss: 2686986.6970; train_gene_expr_recon_loss: 10523340.4242; train_masked_gp_l1_reg_loss: 66433.9399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65020.3801; train_chrom_access_recon_loss: 2376226.4205; train_global_loss: 15773096.3030; train_optim_loss: 15773096.3030; val_kl_reg_loss: 52701.3916; val_edge_recon_loss: 2719686.7500; val_gene_expr_recon_loss: 10546515.0000; val_masked_gp_l1_reg_loss: 66250.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64901.6602; val_chrom_access_recon_loss: 2368172.8125; val_global_loss: 15818229.1250; val_optim_loss: 15818229.1250
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9578; val_auprc_score: 0.9382; val_best_acc_score: 0.9065; val_best_f1_score: 0.9097; train_kl_reg_loss: 55429.7345; train_edge_recon_loss: 2679078.5038; train_gene_expr_recon_loss: 10504515.8636; train_masked_gp_l1_reg_loss: 66201.8511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64863.3096; train_chrom_access_recon_loss: 2370213.7159; train_global_loss: 15740303.0152; train_optim_loss: 15740303.0152; val_kl_reg_loss: 50412.7769; val_edge_recon_loss: 2696352.0312; val_gene_expr_recon_loss: 10669787.5000; val_masked_gp_l1_reg_loss: 66052.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64680.1680; val_chrom_access_recon_loss: 2384388.2812; val_global_loss: 15931672.5000; val_optim_loss: 15931672.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9558; val_auprc_score: 0.9384; val_best_acc_score: 0.9089; val_best_f1_score: 0.9124; train_kl_reg_loss: 53682.9854; train_edge_recon_loss: 2675099.0871; train_gene_expr_recon_loss: 10496516.5909; train_masked_gp_l1_reg_loss: 65989.7493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64923.1248; train_chrom_access_recon_loss: 2369164.5644; train_global_loss: 15725376.0455; train_optim_loss: 15725376.0455; val_kl_reg_loss: 49968.6143; val_edge_recon_loss: 2715445.8438; val_gene_expr_recon_loss: 10580914.3750; val_masked_gp_l1_reg_loss: 65896.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64855.0312; val_chrom_access_recon_loss: 2371167.6250; val_global_loss: 15848248.6250; val_optim_loss: 15848248.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9621; val_auprc_score: 0.9494; val_best_acc_score: 0.9148; val_best_f1_score: 0.9177; train_kl_reg_loss: 54190.7996; train_edge_recon_loss: 2668730.2803; train_gene_expr_recon_loss: 10478166.6061; train_masked_gp_l1_reg_loss: 65769.8848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64861.8094; train_chrom_access_recon_loss: 2362078.1174; train_global_loss: 15693797.5606; train_optim_loss: 15693797.5606; val_kl_reg_loss: 50056.9717; val_edge_recon_loss: 2686127.4375; val_gene_expr_recon_loss: 10577721.5000; val_masked_gp_l1_reg_loss: 65612.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64795.6016; val_chrom_access_recon_loss: 2378450.4688; val_global_loss: 15822765.5000; val_optim_loss: 15822765.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9593; val_auprc_score: 0.9395; val_best_acc_score: 0.9167; val_best_f1_score: 0.9203; train_kl_reg_loss: 53065.9783; train_edge_recon_loss: 2676653.5152; train_gene_expr_recon_loss: 10469973.3939; train_masked_gp_l1_reg_loss: 65517.3924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64713.3007; train_chrom_access_recon_loss: 2362956.0417; train_global_loss: 15692879.6364; train_optim_loss: 15692879.6364; val_kl_reg_loss: 51637.1865; val_edge_recon_loss: 2664530.8125; val_gene_expr_recon_loss: 10535342.8750; val_masked_gp_l1_reg_loss: 65406.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65005.6562; val_chrom_access_recon_loss: 2360942.4062; val_global_loss: 15742865.0000; val_optim_loss: 15742865.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9579; val_auprc_score: 0.9380; val_best_acc_score: 0.9113; val_best_f1_score: 0.9139; train_kl_reg_loss: 53961.6463; train_edge_recon_loss: 2666876.2311; train_gene_expr_recon_loss: 10471534.7121; train_masked_gp_l1_reg_loss: 65310.5434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64840.3810; train_chrom_access_recon_loss: 2361328.6061; train_global_loss: 15683852.0455; train_optim_loss: 15683852.0455; val_kl_reg_loss: 50486.7202; val_edge_recon_loss: 2693037.7812; val_gene_expr_recon_loss: 10558145.0000; val_masked_gp_l1_reg_loss: 65183.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64823.5664; val_chrom_access_recon_loss: 2373939.0625; val_global_loss: 15805616.5000; val_optim_loss: 15805616.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9567; val_auprc_score: 0.9383; val_best_acc_score: 0.9113; val_best_f1_score: 0.9151; train_kl_reg_loss: 53105.3404; train_edge_recon_loss: 2674827.5758; train_gene_expr_recon_loss: 10455861.5758; train_masked_gp_l1_reg_loss: 65038.4305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64826.7876; train_chrom_access_recon_loss: 2357531.9053; train_global_loss: 15671191.6061; train_optim_loss: 15671191.6061; val_kl_reg_loss: 51702.1182; val_edge_recon_loss: 2689135.2500; val_gene_expr_recon_loss: 10604850.7500; val_masked_gp_l1_reg_loss: 64852.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64604.0078; val_chrom_access_recon_loss: 2374834.1875; val_global_loss: 15849979.1250; val_optim_loss: 15849979.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9535; val_auprc_score: 0.9345; val_best_acc_score: 0.9041; val_best_f1_score: 0.9086; train_kl_reg_loss: 53140.2247; train_edge_recon_loss: 2669174.2121; train_gene_expr_recon_loss: 10441364.5758; train_masked_gp_l1_reg_loss: 64732.7801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64795.0468; train_chrom_access_recon_loss: 2355509.3258; train_global_loss: 15648716.1818; train_optim_loss: 15648716.1818; val_kl_reg_loss: 49925.5542; val_edge_recon_loss: 2740905.3438; val_gene_expr_recon_loss: 10486409.0000; val_masked_gp_l1_reg_loss: 64643.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64862.4844; val_chrom_access_recon_loss: 2347979.7500; val_global_loss: 15754724.7500; val_optim_loss: 15754724.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9623; val_auprc_score: 0.9482; val_best_acc_score: 0.9138; val_best_f1_score: 0.9162; train_kl_reg_loss: 53490.7792; train_edge_recon_loss: 2677304.3333; train_gene_expr_recon_loss: 10448939.8788; train_masked_gp_l1_reg_loss: 64473.5762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64747.1262; train_chrom_access_recon_loss: 2358017.0379; train_global_loss: 15666972.6970; train_optim_loss: 15666972.6970; val_kl_reg_loss: 50894.5581; val_edge_recon_loss: 2680650.3438; val_gene_expr_recon_loss: 10588000.8750; val_masked_gp_l1_reg_loss: 64377.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64964.8320; val_chrom_access_recon_loss: 2346105.8438; val_global_loss: 15794994.0000; val_optim_loss: 15794994.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9563; val_auprc_score: 0.9349; val_best_acc_score: 0.9060; val_best_f1_score: 0.9101; train_kl_reg_loss: 52971.5662; train_edge_recon_loss: 2667073.4280; train_gene_expr_recon_loss: 10436236.0152; train_masked_gp_l1_reg_loss: 64020.2073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55636.4573; train_chrom_access_recon_loss: 2352879.6970; train_global_loss: 15628817.3485; train_optim_loss: 15628817.3485; val_kl_reg_loss: 51936.2349; val_edge_recon_loss: 2702468.0625; val_gene_expr_recon_loss: 10531814.3750; val_masked_gp_l1_reg_loss: 63862.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53660.6406; val_chrom_access_recon_loss: 2372588.9688; val_global_loss: 15776331.7500; val_optim_loss: 15776331.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9584; val_auprc_score: 0.9405; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 53759.2644; train_edge_recon_loss: 2666612.8977; train_gene_expr_recon_loss: 10433563.9091; train_masked_gp_l1_reg_loss: 63823.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53384.6819; train_chrom_access_recon_loss: 2352967.2803; train_global_loss: 15624111.7121; train_optim_loss: 15624111.7121; val_kl_reg_loss: 51698.3765; val_edge_recon_loss: 2693232.3125; val_gene_expr_recon_loss: 10544348.5000; val_masked_gp_l1_reg_loss: 63784.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53151.8789; val_chrom_access_recon_loss: 2366267.9688; val_global_loss: 15772483.0000; val_optim_loss: 15772483.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9585; val_auprc_score: 0.9391; val_best_acc_score: 0.9073; val_best_f1_score: 0.9117; train_kl_reg_loss: 54097.2842; train_edge_recon_loss: 2679740.6818; train_gene_expr_recon_loss: 10414423.7879; train_masked_gp_l1_reg_loss: 63757.5708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52964.2470; train_chrom_access_recon_loss: 2349160.9470; train_global_loss: 15614144.4697; train_optim_loss: 15614144.4697; val_kl_reg_loss: 52803.5747; val_edge_recon_loss: 2690701.5938; val_gene_expr_recon_loss: 10552833.5000; val_masked_gp_l1_reg_loss: 63735.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52801.2461; val_chrom_access_recon_loss: 2349076.1250; val_global_loss: 15761950.5000; val_optim_loss: 15761950.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9534; val_auprc_score: 0.9302; val_best_acc_score: 0.9111; val_best_f1_score: 0.9147; train_kl_reg_loss: 54500.3365; train_edge_recon_loss: 2665695.6705; train_gene_expr_recon_loss: 10405716.5152; train_masked_gp_l1_reg_loss: 63709.4646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52698.8514; train_chrom_access_recon_loss: 2342949.3977; train_global_loss: 15585270.1061; train_optim_loss: 15585270.1061; val_kl_reg_loss: 53137.0601; val_edge_recon_loss: 2689361.4375; val_gene_expr_recon_loss: 10604953.2500; val_masked_gp_l1_reg_loss: 63679.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52557.5391; val_chrom_access_recon_loss: 2365029.0000; val_global_loss: 15828718.8750; val_optim_loss: 15828718.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 32 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9571
val AUPRC score: 0.9428
val best accuracy score: 0.9054
val best F1 score: 0.9104
val target rna MSE score: 1.9295
val source rna MSE score: 0.9883
val target atac MSE score: 0.4798
val source atac MSE score: 0.1998
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
