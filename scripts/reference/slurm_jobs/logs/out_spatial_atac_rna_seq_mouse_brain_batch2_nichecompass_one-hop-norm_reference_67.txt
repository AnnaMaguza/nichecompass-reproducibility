[True]
Run timestamp: 24072023_170557_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9518; val_auprc_score: 0.9569; val_best_acc_score: 0.5441; val_best_f1_score: 0.6867; train_kl_reg_loss: 4334.4413; train_edge_recon_loss: 34670743.5556; train_gene_expr_recon_loss: 3217627.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10828342.4444; train_global_loss: 48721048.0000; train_optim_loss: 48721048.0000; val_kl_reg_loss: 8399.6260; val_edge_recon_loss: 40612468.0000; val_gene_expr_recon_loss: 3137919.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10811807.0000; val_global_loss: 54570596.0000; val_optim_loss: 54570596.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9415; val_auprc_score: 0.9448; val_best_acc_score: 0.6792; val_best_f1_score: 0.7551; train_kl_reg_loss: 4957.1114; train_edge_recon_loss: 34690370.6667; train_gene_expr_recon_loss: 3101175.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10791212.1111; train_global_loss: 48587715.1111; train_optim_loss: 48587715.1111; val_kl_reg_loss: 4058.0117; val_edge_recon_loss: 40556188.0000; val_gene_expr_recon_loss: 3031180.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10731944.0000; val_global_loss: 54323372.0000; val_optim_loss: 54323372.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9204; val_auprc_score: 0.9165; val_best_acc_score: 0.7168; val_best_f1_score: 0.7769; train_kl_reg_loss: 11733.3521; train_edge_recon_loss: 34719205.3333; train_gene_expr_recon_loss: 2915861.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10612698.8889; train_global_loss: 48259499.5556; train_optim_loss: 48259499.5556; val_kl_reg_loss: 25119.0117; val_edge_recon_loss: 40506160.0000; val_gene_expr_recon_loss: 2814709.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10590278.0000; val_global_loss: 53936264.0000; val_optim_loss: 53936264.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9084; val_auprc_score: 0.9061; val_best_acc_score: 0.7684; val_best_f1_score: 0.8057; train_kl_reg_loss: 27470.7458; train_edge_recon_loss: 34726939.5556; train_gene_expr_recon_loss: 2771586.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10643355.5556; train_global_loss: 48169352.4444; train_optim_loss: 48169352.4444; val_kl_reg_loss: 57283.5312; val_edge_recon_loss: 40403800.0000; val_gene_expr_recon_loss: 2678417.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10430757.0000; val_global_loss: 53570256.0000; val_optim_loss: 53570256.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8958; val_auprc_score: 0.8865; val_best_acc_score: 0.8063; val_best_f1_score: 0.8245; train_kl_reg_loss: 45569.3186; train_edge_recon_loss: 34714880.8889; train_gene_expr_recon_loss: 2631111.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10361716.1111; train_global_loss: 47753278.2222; train_optim_loss: 47753278.2222; val_kl_reg_loss: 69001.0078; val_edge_recon_loss: 40123044.0000; val_gene_expr_recon_loss: 2558304.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10291712.0000; val_global_loss: 53042060.0000; val_optim_loss: 53042060.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8908; val_auprc_score: 0.8706; val_best_acc_score: 0.7959; val_best_f1_score: 0.8092; train_kl_reg_loss: 71238.2548; train_edge_recon_loss: 34656567.1111; train_gene_expr_recon_loss: 2506792.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10215070.8889; train_global_loss: 47449668.4444; train_optim_loss: 47449668.4444; val_kl_reg_loss: 84535.9062; val_edge_recon_loss: 39156400.0000; val_gene_expr_recon_loss: 2467884.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10177090.0000; val_global_loss: 51885912.0000; val_optim_loss: 51885912.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8726; val_auprc_score: 0.8593; val_best_acc_score: 0.7882; val_best_f1_score: 0.8065; train_kl_reg_loss: 46259.5111; train_edge_recon_loss: 34229761.7778; train_gene_expr_recon_loss: 2469145.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10165776.8889; train_global_loss: 46910943.1111; train_optim_loss: 46910943.1111; val_kl_reg_loss: 8020.9365; val_edge_recon_loss: 32421026.0000; val_gene_expr_recon_loss: 2620860.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10332861.0000; val_global_loss: 45382768.0000; val_optim_loss: 45382768.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8487; val_auprc_score: 0.8383; val_best_acc_score: 0.7483; val_best_f1_score: 0.7878; train_kl_reg_loss: 11366.8875; train_edge_recon_loss: 30438713.7778; train_gene_expr_recon_loss: 2689873.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10403618.3333; train_global_loss: 43543573.3333; train_optim_loss: 43543573.3333; val_kl_reg_loss: 26905.6953; val_edge_recon_loss: 29120108.0000; val_gene_expr_recon_loss: 2697740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10396440.0000; val_global_loss: 42241192.0000; val_optim_loss: 42241192.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8659; val_auprc_score: 0.8496; val_best_acc_score: 0.7736; val_best_f1_score: 0.7990; train_kl_reg_loss: 44584.9416; train_edge_recon_loss: 28905266.6667; train_gene_expr_recon_loss: 2610999.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10330804.4444; train_global_loss: 41891655.5556; train_optim_loss: 41891655.5556; val_kl_reg_loss: 64569.0625; val_edge_recon_loss: 28273326.0000; val_gene_expr_recon_loss: 2557747.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10236204.0000; val_global_loss: 41131848.0000; val_optim_loss: 41131848.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8735; val_auprc_score: 0.8627; val_best_acc_score: 0.7727; val_best_f1_score: 0.7976; train_kl_reg_loss: 79413.2674; train_edge_recon_loss: 28605639.1111; train_gene_expr_recon_loss: 2485681.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10118033.6667; train_global_loss: 41288767.1111; train_optim_loss: 41288767.1111; val_kl_reg_loss: 94976.0625; val_edge_recon_loss: 28431776.0000; val_gene_expr_recon_loss: 2469684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10144122.0000; val_global_loss: 41140560.0000; val_optim_loss: 41140560.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8682; val_auprc_score: 0.8518; val_best_acc_score: 0.7708; val_best_f1_score: 0.7944; train_kl_reg_loss: 105820.3125; train_edge_recon_loss: 28457819.5556; train_gene_expr_recon_loss: 2421754.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10051899.1111; train_global_loss: 41037292.4444; train_optim_loss: 41037292.4444; val_kl_reg_loss: 116152.3750; val_edge_recon_loss: 28618590.0000; val_gene_expr_recon_loss: 2415809.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10077864.0000; val_global_loss: 41228416.0000; val_optim_loss: 41228416.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8738; val_auprc_score: 0.8567; val_best_acc_score: 0.7723; val_best_f1_score: 0.7936; train_kl_reg_loss: 124566.4800; train_edge_recon_loss: 28463330.4444; train_gene_expr_recon_loss: 2390446.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10089678.7778; train_global_loss: 41068023.1111; train_optim_loss: 41068023.1111; val_kl_reg_loss: 127188.1016; val_edge_recon_loss: 28770554.0000; val_gene_expr_recon_loss: 2384296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10060676.0000; val_global_loss: 41342712.0000; val_optim_loss: 41342712.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8883; val_auprc_score: 0.8707; val_best_acc_score: 0.8021; val_best_f1_score: 0.8127; train_kl_reg_loss: 132508.5122; train_edge_recon_loss: 28487127.7778; train_gene_expr_recon_loss: 2344773.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9954124.4444; train_global_loss: 40918534.2222; train_optim_loss: 40918534.2222; val_kl_reg_loss: 135275.2344; val_edge_recon_loss: 28332192.0000; val_gene_expr_recon_loss: 2370447.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10028351.0000; val_global_loss: 40866268.0000; val_optim_loss: 40866268.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8911; val_auprc_score: 0.8656; val_best_acc_score: 0.8063; val_best_f1_score: 0.8151; train_kl_reg_loss: 136056.9601; train_edge_recon_loss: 28278646.4444; train_gene_expr_recon_loss: 2319311.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9941948.2222; train_global_loss: 40675963.1111; train_optim_loss: 40675963.1111; val_kl_reg_loss: 133398.7969; val_edge_recon_loss: 28052008.0000; val_gene_expr_recon_loss: 2346719.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10015226.0000; val_global_loss: 40547352.0000; val_optim_loss: 40547352.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8958; val_auprc_score: 0.8668; val_best_acc_score: 0.8154; val_best_f1_score: 0.8318; train_kl_reg_loss: 134618.0304; train_edge_recon_loss: 28119482.4444; train_gene_expr_recon_loss: 2319944.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9981702.4444; train_global_loss: 40555748.0000; train_optim_loss: 40555748.0000; val_kl_reg_loss: 129483.0625; val_edge_recon_loss: 27884362.0000; val_gene_expr_recon_loss: 2322881.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9985652.0000; val_global_loss: 40322380.0000; val_optim_loss: 40322380.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9153; val_auprc_score: 0.8850; val_best_acc_score: 0.8514; val_best_f1_score: 0.8599; train_kl_reg_loss: 133594.1016; train_edge_recon_loss: 27659450.0000; train_gene_expr_recon_loss: 2286763.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9912628.1111; train_global_loss: 39992436.0000; train_optim_loss: 39992436.0000; val_kl_reg_loss: 134425.5781; val_edge_recon_loss: 27504014.0000; val_gene_expr_recon_loss: 2321008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9956325.0000; val_global_loss: 39915772.0000; val_optim_loss: 39915772.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9234; val_auprc_score: 0.8955; val_best_acc_score: 0.8651; val_best_f1_score: 0.8756; train_kl_reg_loss: 146345.4549; train_edge_recon_loss: 27457192.2222; train_gene_expr_recon_loss: 2291837.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9913872.0000; train_global_loss: 39809247.1111; train_optim_loss: 39809247.1111; val_kl_reg_loss: 149874.3594; val_edge_recon_loss: 27272608.0000; val_gene_expr_recon_loss: 2318714.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10028588.0000; val_global_loss: 39769784.0000; val_optim_loss: 39769784.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9200; val_auprc_score: 0.8959; val_best_acc_score: 0.8560; val_best_f1_score: 0.8675; train_kl_reg_loss: 155748.3698; train_edge_recon_loss: 27320158.6667; train_gene_expr_recon_loss: 2305683.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9932098.2222; train_global_loss: 39713687.5556; train_optim_loss: 39713687.5556; val_kl_reg_loss: 153961.0781; val_edge_recon_loss: 27863974.0000; val_gene_expr_recon_loss: 2360306.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 12094945.0000; val_global_loss: 42473188.0000; val_optim_loss: 42473188.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9221; val_auprc_score: 0.8947; val_best_acc_score: 0.8600; val_best_f1_score: 0.8707; train_kl_reg_loss: 155549.9149; train_edge_recon_loss: 27988444.2222; train_gene_expr_recon_loss: 2329742.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10297787.8889; train_global_loss: 40771524.8889; train_optim_loss: 40771524.8889; val_kl_reg_loss: 138215.6875; val_edge_recon_loss: 28076754.0000; val_gene_expr_recon_loss: 2363758.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10001165.0000; val_global_loss: 40579892.0000; val_optim_loss: 40579892.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9198; val_auprc_score: 0.8900; val_best_acc_score: 0.8544; val_best_f1_score: 0.8658; train_kl_reg_loss: 127473.4375; train_edge_recon_loss: 27722876.8889; train_gene_expr_recon_loss: 2308227.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9908829.8889; train_global_loss: 40067407.5556; train_optim_loss: 40067407.5556; val_kl_reg_loss: 108215.4609; val_edge_recon_loss: 27443466.0000; val_gene_expr_recon_loss: 2326361.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9954368.0000; val_global_loss: 39832412.0000; val_optim_loss: 39832412.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9199; val_auprc_score: 0.8914; val_best_acc_score: 0.8610; val_best_f1_score: 0.8723; train_kl_reg_loss: 102923.4253; train_edge_recon_loss: 27384156.0000; train_gene_expr_recon_loss: 2275438.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9861959.6667; train_global_loss: 39624477.7778; train_optim_loss: 39624477.7778; val_kl_reg_loss: 97029.5781; val_edge_recon_loss: 27537302.0000; val_gene_expr_recon_loss: 2284641.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9913461.0000; val_global_loss: 39832436.0000; val_optim_loss: 39832436.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9223; val_auprc_score: 0.8943; val_best_acc_score: 0.8639; val_best_f1_score: 0.8743; train_kl_reg_loss: 99663.6319; train_edge_recon_loss: 27304031.3333; train_gene_expr_recon_loss: 2271372.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9859616.5556; train_global_loss: 39534684.4444; train_optim_loss: 39534684.4444; val_kl_reg_loss: 97505.6719; val_edge_recon_loss: 27443400.0000; val_gene_expr_recon_loss: 2289754.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9913130.0000; val_global_loss: 39743792.0000; val_optim_loss: 39743792.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9221; val_auprc_score: 0.8868; val_best_acc_score: 0.8643; val_best_f1_score: 0.8742; train_kl_reg_loss: 100762.4184; train_edge_recon_loss: 27272282.2222; train_gene_expr_recon_loss: 2268665.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9845041.8889; train_global_loss: 39486751.5556; train_optim_loss: 39486751.5556; val_kl_reg_loss: 99905.4688; val_edge_recon_loss: 27380868.0000; val_gene_expr_recon_loss: 2286208.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9904991.0000; val_global_loss: 39671972.0000; val_optim_loss: 39671972.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9207; val_auprc_score: 0.8894; val_best_acc_score: 0.8639; val_best_f1_score: 0.8722; train_kl_reg_loss: 102466.8733; train_edge_recon_loss: 27348124.8889; train_gene_expr_recon_loss: 2257092.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9858952.6667; train_global_loss: 39566636.0000; train_optim_loss: 39566636.0000; val_kl_reg_loss: 101019.9531; val_edge_recon_loss: 27642590.0000; val_gene_expr_recon_loss: 2283290.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9904471.0000; val_global_loss: 39931372.0000; val_optim_loss: 39931372.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9289; val_auprc_score: 0.9026; val_best_acc_score: 0.8701; val_best_f1_score: 0.8796; train_kl_reg_loss: 104303.4002; train_edge_recon_loss: 27224496.2222; train_gene_expr_recon_loss: 2246389.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9834817.8889; train_global_loss: 39410008.0000; train_optim_loss: 39410008.0000; val_kl_reg_loss: 103691.9688; val_edge_recon_loss: 27209058.0000; val_gene_expr_recon_loss: 2282521.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9912924.0000; val_global_loss: 39508196.0000; val_optim_loss: 39508196.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9306; val_auprc_score: 0.9048; val_best_acc_score: 0.8709; val_best_f1_score: 0.8790; train_kl_reg_loss: 105867.0399; train_edge_recon_loss: 27266184.0000; train_gene_expr_recon_loss: 2260987.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9843583.4444; train_global_loss: 39476622.6667; train_optim_loss: 39476622.6667; val_kl_reg_loss: 105608.5234; val_edge_recon_loss: 27129740.0000; val_gene_expr_recon_loss: 2280988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9897636.0000; val_global_loss: 39413972.0000; val_optim_loss: 39413972.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9295; val_auprc_score: 0.9025; val_best_acc_score: 0.8732; val_best_f1_score: 0.8816; train_kl_reg_loss: 108805.6059; train_edge_recon_loss: 27231181.3333; train_gene_expr_recon_loss: 2259286.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9874512.8889; train_global_loss: 39473787.1111; train_optim_loss: 39473787.1111; val_kl_reg_loss: 107095.8594; val_edge_recon_loss: 27021500.0000; val_gene_expr_recon_loss: 2276597.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9893733.0000; val_global_loss: 39298924.0000; val_optim_loss: 39298924.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9255; val_auprc_score: 0.8986; val_best_acc_score: 0.8667; val_best_f1_score: 0.8762; train_kl_reg_loss: 109400.8255; train_edge_recon_loss: 27263289.7778; train_gene_expr_recon_loss: 2253878.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9831119.5556; train_global_loss: 39457688.8889; train_optim_loss: 39457688.8889; val_kl_reg_loss: 108234.2031; val_edge_recon_loss: 27318204.0000; val_gene_expr_recon_loss: 2277936.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9895443.0000; val_global_loss: 39599816.0000; val_optim_loss: 39599816.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9258; val_auprc_score: 0.8965; val_best_acc_score: 0.8653; val_best_f1_score: 0.8743; train_kl_reg_loss: 111487.4106; train_edge_recon_loss: 27279214.0000; train_gene_expr_recon_loss: 2263027.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9870962.7778; train_global_loss: 39524690.6667; train_optim_loss: 39524690.6667; val_kl_reg_loss: 109788.4062; val_edge_recon_loss: 27254688.0000; val_gene_expr_recon_loss: 2272083.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9886067.0000; val_global_loss: 39522628.0000; val_optim_loss: 39522628.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9316; val_auprc_score: 0.9075; val_best_acc_score: 0.8769; val_best_f1_score: 0.8843; train_kl_reg_loss: 112953.6866; train_edge_recon_loss: 27289760.2222; train_gene_expr_recon_loss: 2240279.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9785663.1111; train_global_loss: 39428656.4444; train_optim_loss: 39428656.4444; val_kl_reg_loss: 110464.5156; val_edge_recon_loss: 26951542.0000; val_gene_expr_recon_loss: 2271527.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9881380.0000; val_global_loss: 39214912.0000; val_optim_loss: 39214912.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9278; val_auprc_score: 0.9014; val_best_acc_score: 0.8707; val_best_f1_score: 0.8795; train_kl_reg_loss: 114385.9566; train_edge_recon_loss: 27208464.4444; train_gene_expr_recon_loss: 2247338.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9857944.0000; train_global_loss: 39428133.3333; train_optim_loss: 39428133.3333; val_kl_reg_loss: 111862.3047; val_edge_recon_loss: 27233232.0000; val_gene_expr_recon_loss: 2269416.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9881715.0000; val_global_loss: 39496224.0000; val_optim_loss: 39496224.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9283; val_auprc_score: 0.8993; val_best_acc_score: 0.8732; val_best_f1_score: 0.8814; train_kl_reg_loss: 115984.5165; train_edge_recon_loss: 27134137.5556; train_gene_expr_recon_loss: 2240367.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9787109.0000; train_global_loss: 39277597.7778; train_optim_loss: 39277597.7778; val_kl_reg_loss: 114897.3203; val_edge_recon_loss: 27371934.0000; val_gene_expr_recon_loss: 2270665.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9887153.0000; val_global_loss: 39644648.0000; val_optim_loss: 39644648.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9292; val_auprc_score: 0.9035; val_best_acc_score: 0.8704; val_best_f1_score: 0.8791; train_kl_reg_loss: 117906.1215; train_edge_recon_loss: 27090616.2222; train_gene_expr_recon_loss: 2237176.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9847372.6667; train_global_loss: 39293071.1111; train_optim_loss: 39293071.1111; val_kl_reg_loss: 116780.3594; val_edge_recon_loss: 27219728.0000; val_gene_expr_recon_loss: 2265385.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9872424.0000; val_global_loss: 39474320.0000; val_optim_loss: 39474320.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9278; val_auprc_score: 0.9014; val_best_acc_score: 0.8709; val_best_f1_score: 0.8790; train_kl_reg_loss: 119641.5503; train_edge_recon_loss: 27215966.6667; train_gene_expr_recon_loss: 2237974.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776342.0000; train_global_loss: 39349924.4444; train_optim_loss: 39349924.4444; val_kl_reg_loss: 118290.6562; val_edge_recon_loss: 27294368.0000; val_gene_expr_recon_loss: 2266080.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9877634.0000; val_global_loss: 39556372.0000; val_optim_loss: 39556372.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9296; val_auprc_score: 0.9009; val_best_acc_score: 0.8740; val_best_f1_score: 0.8821; train_kl_reg_loss: 120561.9262; train_edge_recon_loss: 27161185.5556; train_gene_expr_recon_loss: 2233181.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9811043.6667; train_global_loss: 39325972.0000; train_optim_loss: 39325972.0000; val_kl_reg_loss: 119175.2188; val_edge_recon_loss: 27327240.0000; val_gene_expr_recon_loss: 2266046.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9888552.0000; val_global_loss: 39601016.0000; val_optim_loss: 39601016.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9283; val_auprc_score: 0.9004; val_best_acc_score: 0.8721; val_best_f1_score: 0.8805; train_kl_reg_loss: 120114.2127; train_edge_recon_loss: 27256860.4444; train_gene_expr_recon_loss: 2236603.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9837675.0000; train_global_loss: 39451252.8889; train_optim_loss: 39451252.8889; val_kl_reg_loss: 118664.5938; val_edge_recon_loss: 27217558.0000; val_gene_expr_recon_loss: 2264429.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9872572.0000; val_global_loss: 39473224.0000; val_optim_loss: 39473224.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9328; val_auprc_score: 0.9107; val_best_acc_score: 0.8760; val_best_f1_score: 0.8838; train_kl_reg_loss: 120758.6797; train_edge_recon_loss: 27155775.7778; train_gene_expr_recon_loss: 2238241.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9819948.1111; train_global_loss: 39334724.0000; train_optim_loss: 39334724.0000; val_kl_reg_loss: 119686.2031; val_edge_recon_loss: 27255020.0000; val_gene_expr_recon_loss: 2264955.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9885697.0000; val_global_loss: 39525360.0000; val_optim_loss: 39525360.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9257; val_auprc_score: 0.8969; val_best_acc_score: 0.8709; val_best_f1_score: 0.8795; train_kl_reg_loss: 120951.8168; train_edge_recon_loss: 27133252.6667; train_gene_expr_recon_loss: 2234038.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9820238.3333; train_global_loss: 39308481.3333; train_optim_loss: 39308481.3333; val_kl_reg_loss: 118080.5625; val_edge_recon_loss: 27358994.0000; val_gene_expr_recon_loss: 2264337.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9873461.0000; val_global_loss: 39614872.0000; val_optim_loss: 39614872.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 54 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9308
Val AUPRC score: 0.9076
Val best accuracy score: 0.8721
Val best F1 score: 0.8803
Val gene expr MSE score: 0.5195
Val chrom access MSE score: 0.0888
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
