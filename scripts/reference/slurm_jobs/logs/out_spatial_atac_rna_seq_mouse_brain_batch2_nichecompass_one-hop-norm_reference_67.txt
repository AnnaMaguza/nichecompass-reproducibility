[True]
Run timestamp: 07092023_174100_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2376 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5103, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7342; val_auprc_score: 0.7692; val_best_acc_score: 0.5078; val_best_f1_score: 0.6693; train_kl_reg_loss: 73569.8088; train_edge_recon_loss: 3579180.6088; train_gene_expr_recon_loss: 21487841.8779; train_masked_gp_l1_reg_loss: 66208.0572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 762090.7882; train_chrom_access_recon_loss: 6489500.3092; train_global_loss: 32458391.3893; train_optim_loss: 32458391.3893; val_kl_reg_loss: 104487.2802; val_edge_recon_loss: 4064633.8667; val_gene_expr_recon_loss: 19587256.5333; val_masked_gp_l1_reg_loss: 61579.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 535613.0625; val_chrom_access_recon_loss: 6017633.3667; val_global_loss: 30371205.0667; val_optim_loss: 30371205.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8639; val_auprc_score: 0.8625; val_best_acc_score: 0.7819; val_best_f1_score: 0.7932; train_kl_reg_loss: 93248.4242; train_edge_recon_loss: 3517830.8760; train_gene_expr_recon_loss: 19694442.1221; train_masked_gp_l1_reg_loss: 58808.3298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 379849.4556; train_chrom_access_recon_loss: 6167097.2481; train_global_loss: 29911276.5038; train_optim_loss: 29911276.5038; val_kl_reg_loss: 82826.5005; val_edge_recon_loss: 4020638.7500; val_gene_expr_recon_loss: 19213885.3333; val_masked_gp_l1_reg_loss: 58648.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 262738.6875; val_chrom_access_recon_loss: 5942174.7667; val_global_loss: 29580910.9333; val_optim_loss: 29580910.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8758; val_auprc_score: 0.8655; val_best_acc_score: 0.7868; val_best_f1_score: 0.8091; train_kl_reg_loss: 72771.9232; train_edge_recon_loss: 3328120.9618; train_gene_expr_recon_loss: 19366476.4885; train_masked_gp_l1_reg_loss: 61856.4920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204928.8577; train_chrom_access_recon_loss: 6076374.0725; train_global_loss: 29110528.7634; train_optim_loss: 29110528.7634; val_kl_reg_loss: 88777.4818; val_edge_recon_loss: 2993211.1833; val_gene_expr_recon_loss: 18994780.6667; val_masked_gp_l1_reg_loss: 66160.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158933.9062; val_chrom_access_recon_loss: 5840413.7667; val_global_loss: 28142276.9333; val_optim_loss: 28142276.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8540; val_auprc_score: 0.8300; val_best_acc_score: 0.7850; val_best_f1_score: 0.8064; train_kl_reg_loss: 90126.5688; train_edge_recon_loss: 2994058.5477; train_gene_expr_recon_loss: 19182599.1450; train_masked_gp_l1_reg_loss: 68378.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131020.8074; train_chrom_access_recon_loss: 6016508.9809; train_global_loss: 28482693.1603; train_optim_loss: 28482693.1603; val_kl_reg_loss: 97224.8927; val_edge_recon_loss: 3008365.0500; val_gene_expr_recon_loss: 18824178.2667; val_masked_gp_l1_reg_loss: 69276.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107606.9062; val_chrom_access_recon_loss: 5800540.4667; val_global_loss: 27907190.8000; val_optim_loss: 27907190.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8905; val_auprc_score: 0.8790; val_best_acc_score: 0.8045; val_best_f1_score: 0.8222; train_kl_reg_loss: 96901.3247; train_edge_recon_loss: 2940692.6202; train_gene_expr_recon_loss: 18967273.9237; train_masked_gp_l1_reg_loss: 70667.6763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93424.3303; train_chrom_access_recon_loss: 5962565.3588; train_global_loss: 28131525.3130; train_optim_loss: 28131525.3130; val_kl_reg_loss: 98564.6130; val_edge_recon_loss: 2961124.8500; val_gene_expr_recon_loss: 18615961.4667; val_masked_gp_l1_reg_loss: 72240.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83133.1875; val_chrom_access_recon_loss: 5768934.2333; val_global_loss: 27599959.2000; val_optim_loss: 27599959.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9040; val_auprc_score: 0.8910; val_best_acc_score: 0.8278; val_best_f1_score: 0.8343; train_kl_reg_loss: 91825.4070; train_edge_recon_loss: 2920049.5553; train_gene_expr_recon_loss: 18748828.7176; train_masked_gp_l1_reg_loss: 73719.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74403.1506; train_chrom_access_recon_loss: 5894859.4237; train_global_loss: 27803685.7252; train_optim_loss: 27803685.7252; val_kl_reg_loss: 86085.5021; val_edge_recon_loss: 2894527.2333; val_gene_expr_recon_loss: 18487467.4667; val_masked_gp_l1_reg_loss: 75144.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67997.3047; val_chrom_access_recon_loss: 5704720.5667; val_global_loss: 27315942.5333; val_optim_loss: 27315942.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9142; val_auprc_score: 0.8995; val_best_acc_score: 0.8366; val_best_f1_score: 0.8465; train_kl_reg_loss: 89624.5125; train_edge_recon_loss: 2867376.6298; train_gene_expr_recon_loss: 18613670.6260; train_masked_gp_l1_reg_loss: 76502.8424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62885.4642; train_chrom_access_recon_loss: 5853489.1985; train_global_loss: 27563549.3740; train_optim_loss: 27563549.3740; val_kl_reg_loss: 88445.9974; val_edge_recon_loss: 2870554.2000; val_gene_expr_recon_loss: 18364875.4667; val_masked_gp_l1_reg_loss: 77904.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59319.6211; val_chrom_access_recon_loss: 5692029.4000; val_global_loss: 27153128.5333; val_optim_loss: 27153128.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9273; val_auprc_score: 0.9120; val_best_acc_score: 0.8575; val_best_f1_score: 0.8672; train_kl_reg_loss: 89438.6724; train_edge_recon_loss: 2824400.8760; train_gene_expr_recon_loss: 18472357.3740; train_masked_gp_l1_reg_loss: 79015.6535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55686.1427; train_chrom_access_recon_loss: 5810493.4466; train_global_loss: 27331391.9847; train_optim_loss: 27331391.9847; val_kl_reg_loss: 87300.4312; val_edge_recon_loss: 2823128.2500; val_gene_expr_recon_loss: 18208615.3333; val_masked_gp_l1_reg_loss: 80467.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53178.0625; val_chrom_access_recon_loss: 5632653.1667; val_global_loss: 26885343.0667; val_optim_loss: 26885343.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9403; val_auprc_score: 0.9246; val_best_acc_score: 0.8715; val_best_f1_score: 0.8785; train_kl_reg_loss: 88275.6510; train_edge_recon_loss: 2798418.0382; train_gene_expr_recon_loss: 18345852.6718; train_masked_gp_l1_reg_loss: 81614.0391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50319.1376; train_chrom_access_recon_loss: 5772416.5000; train_global_loss: 27136896.1069; train_optim_loss: 27136896.1069; val_kl_reg_loss: 83510.1771; val_edge_recon_loss: 2798789.4500; val_gene_expr_recon_loss: 18061709.8667; val_masked_gp_l1_reg_loss: 82660.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48243.5078; val_chrom_access_recon_loss: 5590605.6000; val_global_loss: 26665519.0667; val_optim_loss: 26665519.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9433; val_auprc_score: 0.9253; val_best_acc_score: 0.8798; val_best_f1_score: 0.8876; train_kl_reg_loss: 88197.5559; train_edge_recon_loss: 2772462.8435; train_gene_expr_recon_loss: 18231866.3511; train_masked_gp_l1_reg_loss: 83538.6684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46168.5267; train_chrom_access_recon_loss: 5735332.1794; train_global_loss: 26957566.0763; train_optim_loss: 26957566.0763; val_kl_reg_loss: 85841.8875; val_edge_recon_loss: 2775417.1167; val_gene_expr_recon_loss: 17917411.2000; val_masked_gp_l1_reg_loss: 84519.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44533.9648; val_chrom_access_recon_loss: 5541255.9667; val_global_loss: 26448980.5333; val_optim_loss: 26448980.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9490; val_auprc_score: 0.9384; val_best_acc_score: 0.8871; val_best_f1_score: 0.8911; train_kl_reg_loss: 86431.2690; train_edge_recon_loss: 2762877.6641; train_gene_expr_recon_loss: 18139350.3664; train_masked_gp_l1_reg_loss: 85404.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43099.0760; train_chrom_access_recon_loss: 5703209.4313; train_global_loss: 26820371.7557; train_optim_loss: 26820371.7557; val_kl_reg_loss: 86260.8677; val_edge_recon_loss: 2783892.4500; val_gene_expr_recon_loss: 17823067.2000; val_masked_gp_l1_reg_loss: 86350.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41935.3320; val_chrom_access_recon_loss: 5512904.1333; val_global_loss: 26334410.5333; val_optim_loss: 26334410.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9482; val_auprc_score: 0.9317; val_best_acc_score: 0.8871; val_best_f1_score: 0.8930; train_kl_reg_loss: 86463.5190; train_edge_recon_loss: 2744151.1908; train_gene_expr_recon_loss: 18054403.3435; train_masked_gp_l1_reg_loss: 87087.9796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40668.7640; train_chrom_access_recon_loss: 5678012.1794; train_global_loss: 26690787.0687; train_optim_loss: 26690787.0687; val_kl_reg_loss: 83655.2057; val_edge_recon_loss: 2773952.0667; val_gene_expr_recon_loss: 17810344.2667; val_masked_gp_l1_reg_loss: 87859.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39847.1562; val_chrom_access_recon_loss: 5499286.7667; val_global_loss: 26294946.0000; val_optim_loss: 26294946.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9589; val_auprc_score: 0.9495; val_best_acc_score: 0.9022; val_best_f1_score: 0.9058; train_kl_reg_loss: 83624.2469; train_edge_recon_loss: 2741230.0611; train_gene_expr_recon_loss: 17976055.0992; train_masked_gp_l1_reg_loss: 88679.8344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39000.5364; train_chrom_access_recon_loss: 5651407.9046; train_global_loss: 26579997.7557; train_optim_loss: 26579997.7557; val_kl_reg_loss: 83615.4010; val_edge_recon_loss: 2736008.8167; val_gene_expr_recon_loss: 17703478.0000; val_masked_gp_l1_reg_loss: 89519.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38409.6719; val_chrom_access_recon_loss: 5464091.4667; val_global_loss: 26115123.3333; val_optim_loss: 26115123.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9613; val_auprc_score: 0.9509; val_best_acc_score: 0.9016; val_best_f1_score: 0.9061; train_kl_reg_loss: 82426.9251; train_edge_recon_loss: 2730851.9790; train_gene_expr_recon_loss: 17895745.2901; train_masked_gp_l1_reg_loss: 90166.7050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37675.2052; train_chrom_access_recon_loss: 5622513.1794; train_global_loss: 26459379.2672; train_optim_loss: 26459379.2672; val_kl_reg_loss: 80183.1818; val_edge_recon_loss: 2723719.6500; val_gene_expr_recon_loss: 17616443.2000; val_masked_gp_l1_reg_loss: 90892.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37321.4961; val_chrom_access_recon_loss: 5460532.0000; val_global_loss: 26009091.7333; val_optim_loss: 26009091.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9603; val_auprc_score: 0.9476; val_best_acc_score: 0.9091; val_best_f1_score: 0.9130; train_kl_reg_loss: 80272.8451; train_edge_recon_loss: 2730539.7958; train_gene_expr_recon_loss: 17827980.3969; train_masked_gp_l1_reg_loss: 91544.9584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36714.4581; train_chrom_access_recon_loss: 5600818.3092; train_global_loss: 26367870.6870; train_optim_loss: 26367870.6870; val_kl_reg_loss: 77680.3604; val_edge_recon_loss: 2723795.2333; val_gene_expr_recon_loss: 17546245.6667; val_masked_gp_l1_reg_loss: 92450.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36727.1992; val_chrom_access_recon_loss: 5425768.5667; val_global_loss: 25902667.8667; val_optim_loss: 25902667.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9612; val_auprc_score: 0.9480; val_best_acc_score: 0.9091; val_best_f1_score: 0.9126; train_kl_reg_loss: 78526.4413; train_edge_recon_loss: 2721569.8874; train_gene_expr_recon_loss: 17767098.6031; train_masked_gp_l1_reg_loss: 93016.3507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36021.1628; train_chrom_access_recon_loss: 5584481.0038; train_global_loss: 26280713.5267; train_optim_loss: 26280713.5267; val_kl_reg_loss: 77874.1974; val_edge_recon_loss: 2729929.6833; val_gene_expr_recon_loss: 17568534.5333; val_masked_gp_l1_reg_loss: 93695.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35795.5391; val_chrom_access_recon_loss: 5422773.7667; val_global_loss: 25928604.0000; val_optim_loss: 25928604.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9656; val_auprc_score: 0.9566; val_best_acc_score: 0.9115; val_best_f1_score: 0.9156; train_kl_reg_loss: 79308.8048; train_edge_recon_loss: 2711323.1947; train_gene_expr_recon_loss: 17706350.2901; train_masked_gp_l1_reg_loss: 93951.3451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35440.7408; train_chrom_access_recon_loss: 5563086.3855; train_global_loss: 26189460.7786; train_optim_loss: 26189460.7786; val_kl_reg_loss: 77863.1177; val_edge_recon_loss: 2731451.4667; val_gene_expr_recon_loss: 17489041.4667; val_masked_gp_l1_reg_loss: 94242.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35477.2695; val_chrom_access_recon_loss: 5395683.9000; val_global_loss: 25823759.8667; val_optim_loss: 25823759.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9654; val_auprc_score: 0.9530; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 77786.7521; train_edge_recon_loss: 2713338.9676; train_gene_expr_recon_loss: 17669013.2748; train_masked_gp_l1_reg_loss: 94871.8820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35226.7068; train_chrom_access_recon_loss: 5549073.5267; train_global_loss: 26139311.2366; train_optim_loss: 26139311.2366; val_kl_reg_loss: 75522.1042; val_edge_recon_loss: 2710594.9167; val_gene_expr_recon_loss: 17439797.3333; val_masked_gp_l1_reg_loss: 95408.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34988.5859; val_chrom_access_recon_loss: 5383712.2000; val_global_loss: 25740022.6667; val_optim_loss: 25740022.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9674; val_auprc_score: 0.9572; val_best_acc_score: 0.9184; val_best_f1_score: 0.9211; train_kl_reg_loss: 76075.9150; train_edge_recon_loss: 2706584.9676; train_gene_expr_recon_loss: 17616000.3664; train_masked_gp_l1_reg_loss: 95970.0311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34879.6947; train_chrom_access_recon_loss: 5529137.7519; train_global_loss: 26058648.5802; train_optim_loss: 26058648.5802; val_kl_reg_loss: 74706.7026; val_edge_recon_loss: 2715266.0000; val_gene_expr_recon_loss: 17349516.0000; val_masked_gp_l1_reg_loss: 96413.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34647.4180; val_chrom_access_recon_loss: 5357187.1667; val_global_loss: 25627737.3333; val_optim_loss: 25627737.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9705; val_auprc_score: 0.9619; val_best_acc_score: 0.9220; val_best_f1_score: 0.9255; train_kl_reg_loss: 75210.8019; train_edge_recon_loss: 2702089.3683; train_gene_expr_recon_loss: 17561973.8092; train_masked_gp_l1_reg_loss: 96936.7309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34763.0775; train_chrom_access_recon_loss: 5508649.0153; train_global_loss: 25979622.9313; train_optim_loss: 25979622.9313; val_kl_reg_loss: 74656.4646; val_edge_recon_loss: 2706846.0500; val_gene_expr_recon_loss: 17307682.8000; val_masked_gp_l1_reg_loss: 97200.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34210.1406; val_chrom_access_recon_loss: 5350878.2667; val_global_loss: 25571473.3333; val_optim_loss: 25571473.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9658; val_auprc_score: 0.9553; val_best_acc_score: 0.9174; val_best_f1_score: 0.9212; train_kl_reg_loss: 74949.9150; train_edge_recon_loss: 2696352.4523; train_gene_expr_recon_loss: 17521616.9008; train_masked_gp_l1_reg_loss: 97638.8048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34594.4965; train_chrom_access_recon_loss: 5499433.4733; train_global_loss: 25924586.0153; train_optim_loss: 25924586.0153; val_kl_reg_loss: 73709.6120; val_edge_recon_loss: 2706766.1000; val_gene_expr_recon_loss: 17399137.5333; val_masked_gp_l1_reg_loss: 98096.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34186.4844; val_chrom_access_recon_loss: 5361923.6333; val_global_loss: 25673819.2000; val_optim_loss: 25673819.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9723; val_auprc_score: 0.9626; val_best_acc_score: 0.9213; val_best_f1_score: 0.9244; train_kl_reg_loss: 73846.4246; train_edge_recon_loss: 2700009.3454; train_gene_expr_recon_loss: 17488680.8931; train_masked_gp_l1_reg_loss: 98392.0204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34593.8135; train_chrom_access_recon_loss: 5487451.9084; train_global_loss: 25882974.3511; train_optim_loss: 25882974.3511; val_kl_reg_loss: 71385.9969; val_edge_recon_loss: 2697856.4333; val_gene_expr_recon_loss: 17233396.2000; val_masked_gp_l1_reg_loss: 98777.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34325.6562; val_chrom_access_recon_loss: 5342683.2000; val_global_loss: 25478426.1333; val_optim_loss: 25478426.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9667; val_auprc_score: 0.9531; val_best_acc_score: 0.9193; val_best_f1_score: 0.9233; train_kl_reg_loss: 73777.6155; train_edge_recon_loss: 2691859.6107; train_gene_expr_recon_loss: 17448051.7863; train_masked_gp_l1_reg_loss: 99133.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34394.2195; train_chrom_access_recon_loss: 5478858.5076; train_global_loss: 25826075.8168; train_optim_loss: 25826075.8168; val_kl_reg_loss: 71599.0172; val_edge_recon_loss: 2710606.2667; val_gene_expr_recon_loss: 17146933.4000; val_masked_gp_l1_reg_loss: 99573.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34441.2812; val_chrom_access_recon_loss: 5306215.3000; val_global_loss: 25369370.2667; val_optim_loss: 25369370.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9720; val_auprc_score: 0.9615; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 72452.7943; train_edge_recon_loss: 2691784.1336; train_gene_expr_recon_loss: 17416965.2595; train_masked_gp_l1_reg_loss: 99907.9210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34481.6421; train_chrom_access_recon_loss: 5462686.3817; train_global_loss: 25778277.9389; train_optim_loss: 25778277.9389; val_kl_reg_loss: 71844.1760; val_edge_recon_loss: 2687698.1333; val_gene_expr_recon_loss: 17113172.6667; val_masked_gp_l1_reg_loss: 100440.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34546.5430; val_chrom_access_recon_loss: 5287534.9667; val_global_loss: 25295235.6000; val_optim_loss: 25295235.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9735; val_auprc_score: 0.9657; val_best_acc_score: 0.9289; val_best_f1_score: 0.9317; train_kl_reg_loss: 72834.5822; train_edge_recon_loss: 2689749.5401; train_gene_expr_recon_loss: 17394994.7252; train_masked_gp_l1_reg_loss: 100804.5312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34685.4967; train_chrom_access_recon_loss: 5453446.3092; train_global_loss: 25746515.0992; train_optim_loss: 25746515.0992; val_kl_reg_loss: 72287.8568; val_edge_recon_loss: 2683509.1167; val_gene_expr_recon_loss: 17194654.0667; val_masked_gp_l1_reg_loss: 101059.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34746.5039; val_chrom_access_recon_loss: 5292674.8000; val_global_loss: 25378931.7333; val_optim_loss: 25378931.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9768; val_auprc_score: 0.9717; val_best_acc_score: 0.9279; val_best_f1_score: 0.9304; train_kl_reg_loss: 78841.7068; train_edge_recon_loss: 2709637.3053; train_gene_expr_recon_loss: 17060511.0229; train_masked_gp_l1_reg_loss: 99501.4652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27301.7882; train_chrom_access_recon_loss: 5386448.0344; train_global_loss: 25362241.1756; train_optim_loss: 25362241.1756; val_kl_reg_loss: 52399.8690; val_edge_recon_loss: 2716753.2667; val_gene_expr_recon_loss: 16791933.3333; val_masked_gp_l1_reg_loss: 99257.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25470.5664; val_chrom_access_recon_loss: 5179041.6000; val_global_loss: 24864856.1333; val_optim_loss: 24864856.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9748; val_auprc_score: 0.9685; val_best_acc_score: 0.9316; val_best_f1_score: 0.9334; train_kl_reg_loss: 78106.9005; train_edge_recon_loss: 2701198.6011; train_gene_expr_recon_loss: 16994416.0611; train_masked_gp_l1_reg_loss: 99438.3439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25291.7523; train_chrom_access_recon_loss: 5357791.0763; train_global_loss: 25256242.6565; train_optim_loss: 25256242.6565; val_kl_reg_loss: 52602.8651; val_edge_recon_loss: 2692942.1500; val_gene_expr_recon_loss: 16787779.2667; val_masked_gp_l1_reg_loss: 99628.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25144.9941; val_chrom_access_recon_loss: 5180022.5667; val_global_loss: 24838118.8000; val_optim_loss: 24838118.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9778; val_auprc_score: 0.9719; val_best_acc_score: 0.9338; val_best_f1_score: 0.9359; train_kl_reg_loss: 74668.9480; train_edge_recon_loss: 2697863.9065; train_gene_expr_recon_loss: 16963735.1527; train_masked_gp_l1_reg_loss: 99603.9653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25127.4065; train_chrom_access_recon_loss: 5346019.6031; train_global_loss: 25207019.0076; train_optim_loss: 25207019.0076; val_kl_reg_loss: 55224.4633; val_edge_recon_loss: 2712129.0500; val_gene_expr_recon_loss: 16793679.6000; val_masked_gp_l1_reg_loss: 99728.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25090.1562; val_chrom_access_recon_loss: 5217372.4333; val_global_loss: 24903223.7333; val_optim_loss: 24903223.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9773; val_auprc_score: 0.9703; val_best_acc_score: 0.9325; val_best_f1_score: 0.9349; train_kl_reg_loss: 73053.0878; train_edge_recon_loss: 2685478.3702; train_gene_expr_recon_loss: 16924597.4046; train_masked_gp_l1_reg_loss: 99673.2242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25105.1553; train_chrom_access_recon_loss: 5332205.0954; train_global_loss: 25140112.4275; train_optim_loss: 25140112.4275; val_kl_reg_loss: 56617.4964; val_edge_recon_loss: 2697913.9000; val_gene_expr_recon_loss: 16743599.5333; val_masked_gp_l1_reg_loss: 99658.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25154.1758; val_chrom_access_recon_loss: 5161982.3333; val_global_loss: 24784925.3333; val_optim_loss: 24784925.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9774; val_auprc_score: 0.9712; val_best_acc_score: 0.9321; val_best_f1_score: 0.9341; train_kl_reg_loss: 71253.5892; train_edge_recon_loss: 2691165.3263; train_gene_expr_recon_loss: 16906610.1069; train_masked_gp_l1_reg_loss: 99694.2863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25141.1247; train_chrom_access_recon_loss: 5323665.1794; train_global_loss: 25117529.7557; train_optim_loss: 25117529.7557; val_kl_reg_loss: 57003.0326; val_edge_recon_loss: 2714059.6333; val_gene_expr_recon_loss: 16771547.6667; val_masked_gp_l1_reg_loss: 99777.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25134.8008; val_chrom_access_recon_loss: 5171538.9000; val_global_loss: 24839061.0667; val_optim_loss: 24839061.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9807; val_auprc_score: 0.9750; val_best_acc_score: 0.9396; val_best_f1_score: 0.9411; train_kl_reg_loss: 68616.7102; train_edge_recon_loss: 2682402.5534; train_gene_expr_recon_loss: 16867496.4046; train_masked_gp_l1_reg_loss: 99884.7101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25164.8311; train_chrom_access_recon_loss: 5311920.7634; train_global_loss: 25055485.9389; train_optim_loss: 25055485.9389; val_kl_reg_loss: 58855.6779; val_edge_recon_loss: 2666718.6167; val_gene_expr_recon_loss: 16737780.2667; val_masked_gp_l1_reg_loss: 100048.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25199.4316; val_chrom_access_recon_loss: 5189518.7333; val_global_loss: 24778121.3333; val_optim_loss: 24778121.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9784; val_auprc_score: 0.9715; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 67824.1444; train_edge_recon_loss: 2680495.9447; train_gene_expr_recon_loss: 16845217.9084; train_masked_gp_l1_reg_loss: 100090.9343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25212.6595; train_chrom_access_recon_loss: 5306538.1450; train_global_loss: 25025379.7099; train_optim_loss: 25025379.7099; val_kl_reg_loss: 58364.6214; val_edge_recon_loss: 2684749.8000; val_gene_expr_recon_loss: 16684232.4667; val_masked_gp_l1_reg_loss: 100169.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25216.8633; val_chrom_access_recon_loss: 5156266.2000; val_global_loss: 24708999.3333; val_optim_loss: 24708999.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9777; val_auprc_score: 0.9700; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 66108.4018; train_edge_recon_loss: 2681040.6126; train_gene_expr_recon_loss: 16826163.4046; train_masked_gp_l1_reg_loss: 100288.0291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25259.1851; train_chrom_access_recon_loss: 5300761.7290; train_global_loss: 24999621.3130; train_optim_loss: 24999621.3130; val_kl_reg_loss: 58600.3302; val_edge_recon_loss: 2680803.7167; val_gene_expr_recon_loss: 16682267.9333; val_masked_gp_l1_reg_loss: 100357.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25295.8184; val_chrom_access_recon_loss: 5167051.5000; val_global_loss: 24714377.6000; val_optim_loss: 24714377.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9766; val_auprc_score: 0.9666; val_best_acc_score: 0.9369; val_best_f1_score: 0.9394; train_kl_reg_loss: 66283.3930; train_edge_recon_loss: 2677464.3015; train_gene_expr_recon_loss: 16801248.4962; train_masked_gp_l1_reg_loss: 100455.6271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25334.3152; train_chrom_access_recon_loss: 5294310.1679; train_global_loss: 24965096.3359; train_optim_loss: 24965096.3359; val_kl_reg_loss: 59823.5151; val_edge_recon_loss: 2670571.8167; val_gene_expr_recon_loss: 16634077.4667; val_masked_gp_l1_reg_loss: 100586.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25269.7852; val_chrom_access_recon_loss: 5149358.1000; val_global_loss: 24639686.8000; val_optim_loss: 24639686.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9776; val_auprc_score: 0.9721; val_best_acc_score: 0.9349; val_best_f1_score: 0.9363; train_kl_reg_loss: 64828.0975; train_edge_recon_loss: 2680612.6756; train_gene_expr_recon_loss: 16783697.5191; train_masked_gp_l1_reg_loss: 100701.2473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25372.2770; train_chrom_access_recon_loss: 5286878.6603; train_global_loss: 24942090.4427; train_optim_loss: 24942090.4427; val_kl_reg_loss: 58892.7667; val_edge_recon_loss: 2697140.3667; val_gene_expr_recon_loss: 16610748.8667; val_masked_gp_l1_reg_loss: 100909.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25390.1758; val_chrom_access_recon_loss: 5141906.7000; val_global_loss: 24634988.9333; val_optim_loss: 24634988.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9800; val_auprc_score: 0.9717; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 64159.1112; train_edge_recon_loss: 2674646.7443; train_gene_expr_recon_loss: 16770520.0840; train_masked_gp_l1_reg_loss: 100994.4433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25453.2101; train_chrom_access_recon_loss: 5284997.7366; train_global_loss: 24920771.3588; train_optim_loss: 24920771.3588; val_kl_reg_loss: 59245.4211; val_edge_recon_loss: 2674403.5333; val_gene_expr_recon_loss: 16613951.0000; val_masked_gp_l1_reg_loss: 101058.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25388.5215; val_chrom_access_recon_loss: 5127210.4667; val_global_loss: 24601256.4000; val_optim_loss: 24601256.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9805; val_auprc_score: 0.9748; val_best_acc_score: 0.9395; val_best_f1_score: 0.9411; train_kl_reg_loss: 63877.7240; train_edge_recon_loss: 2673174.5344; train_gene_expr_recon_loss: 16747701.0687; train_masked_gp_l1_reg_loss: 101149.0612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25555.2056; train_chrom_access_recon_loss: 5278172.6107; train_global_loss: 24889630.1985; train_optim_loss: 24889630.1985; val_kl_reg_loss: 58858.0107; val_edge_recon_loss: 2682322.6000; val_gene_expr_recon_loss: 16547687.1333; val_masked_gp_l1_reg_loss: 101197.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25559.8184; val_chrom_access_recon_loss: 5115388.1333; val_global_loss: 24531014.0000; val_optim_loss: 24531014.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9819; val_auprc_score: 0.9777; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 63598.4964; train_edge_recon_loss: 2671936.5305; train_gene_expr_recon_loss: 16721767.0382; train_masked_gp_l1_reg_loss: 101318.2021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25636.9404; train_chrom_access_recon_loss: 5267894.7061; train_global_loss: 24852151.9084; train_optim_loss: 24852151.9084; val_kl_reg_loss: 58839.7068; val_edge_recon_loss: 2677935.6333; val_gene_expr_recon_loss: 16573376.7333; val_masked_gp_l1_reg_loss: 101448.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25668.7461; val_chrom_access_recon_loss: 5135401.5000; val_global_loss: 24572669.4667; val_optim_loss: 24572669.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9814; val_auprc_score: 0.9757; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 63464.2205; train_edge_recon_loss: 2666570.3950; train_gene_expr_recon_loss: 16704697.0153; train_masked_gp_l1_reg_loss: 101488.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25730.5821; train_chrom_access_recon_loss: 5263303.2939; train_global_loss: 24825254.2443; train_optim_loss: 24825254.2443; val_kl_reg_loss: 59350.7826; val_edge_recon_loss: 2690905.3500; val_gene_expr_recon_loss: 16559719.4667; val_masked_gp_l1_reg_loss: 101600.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25842.7637; val_chrom_access_recon_loss: 5124016.0000; val_global_loss: 24561433.3333; val_optim_loss: 24561433.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9806; val_auprc_score: 0.9733; val_best_acc_score: 0.9427; val_best_f1_score: 0.9444; train_kl_reg_loss: 62591.4649; train_edge_recon_loss: 2670862.5534; train_gene_expr_recon_loss: 16694439.1832; train_masked_gp_l1_reg_loss: 101690.5658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25833.8906; train_chrom_access_recon_loss: 5264897.2901; train_global_loss: 24820314.7481; train_optim_loss: 24820314.7481; val_kl_reg_loss: 61156.7461; val_edge_recon_loss: 2680552.2500; val_gene_expr_recon_loss: 16513015.3333; val_masked_gp_l1_reg_loss: 101782.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25834.9980; val_chrom_access_recon_loss: 5086876.6667; val_global_loss: 24469217.0667; val_optim_loss: 24469217.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9826; val_auprc_score: 0.9787; val_best_acc_score: 0.9435; val_best_f1_score: 0.9453; train_kl_reg_loss: 62033.1643; train_edge_recon_loss: 2677148.0229; train_gene_expr_recon_loss: 16677035.3282; train_masked_gp_l1_reg_loss: 101910.0182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25885.0488; train_chrom_access_recon_loss: 5261195.5115; train_global_loss: 24805206.8702; train_optim_loss: 24805206.8702; val_kl_reg_loss: 60172.9641; val_edge_recon_loss: 2679724.6167; val_gene_expr_recon_loss: 16560531.6667; val_masked_gp_l1_reg_loss: 101958.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25878.4668; val_chrom_access_recon_loss: 5114382.2667; val_global_loss: 24542647.6000; val_optim_loss: 24542647.6000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9814; val_auprc_score: 0.9763; val_best_acc_score: 0.9446; val_best_f1_score: 0.9461; train_kl_reg_loss: 62117.4825; train_edge_recon_loss: 2668074.6584; train_gene_expr_recon_loss: 16665074.1679; train_masked_gp_l1_reg_loss: 102037.9444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25922.5702; train_chrom_access_recon_loss: 5253078.9275; train_global_loss: 24776305.6794; train_optim_loss: 24776305.6794; val_kl_reg_loss: 59215.6919; val_edge_recon_loss: 2679141.8000; val_gene_expr_recon_loss: 16579784.2667; val_masked_gp_l1_reg_loss: 102140.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25969.1289; val_chrom_access_recon_loss: 5129871.8000; val_global_loss: 24576123.6000; val_optim_loss: 24576123.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9839; val_auprc_score: 0.9783; val_best_acc_score: 0.9479; val_best_f1_score: 0.9491; train_kl_reg_loss: 61578.4398; train_edge_recon_loss: 2663994.7977; train_gene_expr_recon_loss: 16646093.3511; train_masked_gp_l1_reg_loss: 102219.5698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26053.1973; train_chrom_access_recon_loss: 5250630.1336; train_global_loss: 24750569.5267; train_optim_loss: 24750569.5267; val_kl_reg_loss: 59053.5193; val_edge_recon_loss: 2689689.7667; val_gene_expr_recon_loss: 16531891.1333; val_masked_gp_l1_reg_loss: 102309.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25998.2637; val_chrom_access_recon_loss: 5106364.4333; val_global_loss: 24515306.9333; val_optim_loss: 24515306.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9840; val_auprc_score: 0.9796; val_best_acc_score: 0.9483; val_best_f1_score: 0.9496; train_kl_reg_loss: 61732.0682; train_edge_recon_loss: 2667226.9695; train_gene_expr_recon_loss: 16648779.3893; train_masked_gp_l1_reg_loss: 102380.8254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26143.3349; train_chrom_access_recon_loss: 5254215.1947; train_global_loss: 24760477.6336; train_optim_loss: 24760477.6336; val_kl_reg_loss: 61594.8531; val_edge_recon_loss: 2688534.7833; val_gene_expr_recon_loss: 16512126.2000; val_masked_gp_l1_reg_loss: 102400.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26127.3613; val_chrom_access_recon_loss: 5140301.8667; val_global_loss: 24531086.0000; val_optim_loss: 24531086.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9829; val_auprc_score: 0.9768; val_best_acc_score: 0.9489; val_best_f1_score: 0.9506; train_kl_reg_loss: 63129.2468; train_edge_recon_loss: 2663526.0134; train_gene_expr_recon_loss: 16606767.8473; train_masked_gp_l1_reg_loss: 101675.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24266.9955; train_chrom_access_recon_loss: 5248322.5840; train_global_loss: 24707688.2748; train_optim_loss: 24707688.2748; val_kl_reg_loss: 61322.7961; val_edge_recon_loss: 2671284.6167; val_gene_expr_recon_loss: 16485424.2667; val_masked_gp_l1_reg_loss: 101377.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23922.4805; val_chrom_access_recon_loss: 5097105.3000; val_global_loss: 24440436.9333; val_optim_loss: 24440436.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9841; val_auprc_score: 0.9771; val_best_acc_score: 0.9479; val_best_f1_score: 0.9490; train_kl_reg_loss: 63088.0299; train_edge_recon_loss: 2667470.6908; train_gene_expr_recon_loss: 16601870.3817; train_masked_gp_l1_reg_loss: 101280.4899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23800.0519; train_chrom_access_recon_loss: 5240838.9084; train_global_loss: 24698348.5038; train_optim_loss: 24698348.5038; val_kl_reg_loss: 61215.7010; val_edge_recon_loss: 2668294.5000; val_gene_expr_recon_loss: 16523304.0667; val_masked_gp_l1_reg_loss: 101213.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23681.3887; val_chrom_access_recon_loss: 5096728.4333; val_global_loss: 24474438.5333; val_optim_loss: 24474438.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9843; val_auprc_score: 0.9797; val_best_acc_score: 0.9493; val_best_f1_score: 0.9506; train_kl_reg_loss: 63302.0153; train_edge_recon_loss: 2663610.7271; train_gene_expr_recon_loss: 16599049.0076; train_masked_gp_l1_reg_loss: 101183.8186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23606.8796; train_chrom_access_recon_loss: 5243803.7634; train_global_loss: 24694556.3206; train_optim_loss: 24694556.3206; val_kl_reg_loss: 61737.2760; val_edge_recon_loss: 2672620.7167; val_gene_expr_recon_loss: 16508460.8667; val_masked_gp_l1_reg_loss: 101155.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23528.0547; val_chrom_access_recon_loss: 5108774.4333; val_global_loss: 24476277.4667; val_optim_loss: 24476277.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9846; val_auprc_score: 0.9789; val_best_acc_score: 0.9473; val_best_f1_score: 0.9490; train_kl_reg_loss: 63482.2059; train_edge_recon_loss: 2663751.9828; train_gene_expr_recon_loss: 16594746.1069; train_masked_gp_l1_reg_loss: 101138.4503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23465.1862; train_chrom_access_recon_loss: 5247925.5267; train_global_loss: 24694509.6183; train_optim_loss: 24694509.6183; val_kl_reg_loss: 61428.8133; val_edge_recon_loss: 2670232.0000; val_gene_expr_recon_loss: 16413219.2667; val_masked_gp_l1_reg_loss: 101128.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23399.0508; val_chrom_access_recon_loss: 5069319.4333; val_global_loss: 24338727.2000; val_optim_loss: 24338727.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9847; val_auprc_score: 0.9812; val_best_acc_score: 0.9479; val_best_f1_score: 0.9487; train_kl_reg_loss: 63162.7622; train_edge_recon_loss: 2663624.0706; train_gene_expr_recon_loss: 16590291.7786; train_masked_gp_l1_reg_loss: 101138.2937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23367.1462; train_chrom_access_recon_loss: 5241625.1260; train_global_loss: 24683209.1603; train_optim_loss: 24683209.1603; val_kl_reg_loss: 61681.6875; val_edge_recon_loss: 2661590.6833; val_gene_expr_recon_loss: 16464113.4667; val_masked_gp_l1_reg_loss: 101134.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23306.0918; val_chrom_access_recon_loss: 5093206.8667; val_global_loss: 24405032.8000; val_optim_loss: 24405032.8000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9865; val_auprc_score: 0.9829; val_best_acc_score: 0.9527; val_best_f1_score: 0.9538; train_kl_reg_loss: 63398.3028; train_edge_recon_loss: 2660362.0553; train_gene_expr_recon_loss: 16596955.9924; train_masked_gp_l1_reg_loss: 101143.4448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23272.8915; train_chrom_access_recon_loss: 5244728.9351; train_global_loss: 24689861.6947; train_optim_loss: 24689861.6947; val_kl_reg_loss: 61935.5417; val_edge_recon_loss: 2670415.7167; val_gene_expr_recon_loss: 16494234.4667; val_masked_gp_l1_reg_loss: 101143.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23220.6328; val_chrom_access_recon_loss: 5111838.1000; val_global_loss: 24462787.7333; val_optim_loss: 24462787.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9857; val_auprc_score: 0.9826; val_best_acc_score: 0.9493; val_best_f1_score: 0.9506; train_kl_reg_loss: 63366.2111; train_edge_recon_loss: 2657541.2767; train_gene_expr_recon_loss: 16588537.5267; train_masked_gp_l1_reg_loss: 101156.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23187.8852; train_chrom_access_recon_loss: 5243631.8359; train_global_loss: 24677421.4504; train_optim_loss: 24677421.4504; val_kl_reg_loss: 61238.7867; val_edge_recon_loss: 2676037.2667; val_gene_expr_recon_loss: 16453134.4667; val_masked_gp_l1_reg_loss: 101165.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23133.6113; val_chrom_access_recon_loss: 5086097.9333; val_global_loss: 24400808.5333; val_optim_loss: 24400808.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9838; val_auprc_score: 0.9775; val_best_acc_score: 0.9472; val_best_f1_score: 0.9486; train_kl_reg_loss: 63326.8260; train_edge_recon_loss: 2664103.0344; train_gene_expr_recon_loss: 16589306.6336; train_masked_gp_l1_reg_loss: 101171.3628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23111.8217; train_chrom_access_recon_loss: 5241063.2901; train_global_loss: 24682082.9313; train_optim_loss: 24682082.9313; val_kl_reg_loss: 61658.5328; val_edge_recon_loss: 2671926.0833; val_gene_expr_recon_loss: 16441814.8000; val_masked_gp_l1_reg_loss: 101174.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23064.3301; val_chrom_access_recon_loss: 5087306.9333; val_global_loss: 24386944.6667; val_optim_loss: 24386944.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9848; val_auprc_score: 0.9805; val_best_acc_score: 0.9488; val_best_f1_score: 0.9498; train_kl_reg_loss: 63409.6137; train_edge_recon_loss: 2660593.5954; train_gene_expr_recon_loss: 16578569.4809; train_masked_gp_l1_reg_loss: 101101.4088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22876.7985; train_chrom_access_recon_loss: 5241571.7481; train_global_loss: 24668122.5496; train_optim_loss: 24668122.5496; val_kl_reg_loss: 61889.6365; val_edge_recon_loss: 2670995.0167; val_gene_expr_recon_loss: 16505973.0667; val_masked_gp_l1_reg_loss: 101062.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22845.9082; val_chrom_access_recon_loss: 5117591.7667; val_global_loss: 24480357.7333; val_optim_loss: 24480357.7333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9863; val_auprc_score: 0.9829; val_best_acc_score: 0.9508; val_best_f1_score: 0.9520; train_kl_reg_loss: 63259.5236; train_edge_recon_loss: 2665259.5668; train_gene_expr_recon_loss: 16581299.0153; train_masked_gp_l1_reg_loss: 101048.7473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22835.6867; train_chrom_access_recon_loss: 5241259.6031; train_global_loss: 24674962.1527; train_optim_loss: 24674962.1527; val_kl_reg_loss: 61336.7130; val_edge_recon_loss: 2663913.7333; val_gene_expr_recon_loss: 16452373.9333; val_masked_gp_l1_reg_loss: 101035.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22824.7871; val_chrom_access_recon_loss: 5080140.5000; val_global_loss: 24381624.9333; val_optim_loss: 24381624.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9865; val_auprc_score: 0.9833; val_best_acc_score: 0.9514; val_best_f1_score: 0.9521; train_kl_reg_loss: 63352.4896; train_edge_recon_loss: 2660444.9561; train_gene_expr_recon_loss: 16578119.4809; train_masked_gp_l1_reg_loss: 101029.1671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22815.3200; train_chrom_access_recon_loss: 5237612.5649; train_global_loss: 24663373.8931; train_optim_loss: 24663373.8931; val_kl_reg_loss: 61652.3766; val_edge_recon_loss: 2662985.4333; val_gene_expr_recon_loss: 16483190.0000; val_masked_gp_l1_reg_loss: 101023.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22806.4082; val_chrom_access_recon_loss: 5101698.1667; val_global_loss: 24433355.8667; val_optim_loss: 24433355.8667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9857; val_auprc_score: 0.9806; val_best_acc_score: 0.9503; val_best_f1_score: 0.9515; train_kl_reg_loss: 63390.4439; train_edge_recon_loss: 2660204.7309; train_gene_expr_recon_loss: 16587095.2595; train_masked_gp_l1_reg_loss: 101019.9214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22799.5716; train_chrom_access_recon_loss: 5241585.7137; train_global_loss: 24676095.5420; train_optim_loss: 24676095.5420; val_kl_reg_loss: 61778.9677; val_edge_recon_loss: 2655746.8333; val_gene_expr_recon_loss: 16474179.3333; val_masked_gp_l1_reg_loss: 101017.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22791.5352; val_chrom_access_recon_loss: 5116586.2667; val_global_loss: 24432101.3333; val_optim_loss: 24432101.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 85 min 18 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9871
val AUPRC score: 0.9849
val best accuracy score: 0.9496
val best F1 score: 0.9507
val target rna MSE score: 1.1143
val source rna MSE score: 0.2173
val target atac MSE score: 0.3202
val source atac MSE score: 0.0537
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
