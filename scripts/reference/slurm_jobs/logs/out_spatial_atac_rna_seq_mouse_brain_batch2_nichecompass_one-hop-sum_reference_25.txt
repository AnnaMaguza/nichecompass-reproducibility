[True]
Run timestamp: 10082023_173220_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8030; val_auprc_score: 0.8147; val_best_acc_score: 0.5454; val_best_f1_score: 0.6848; train_kl_reg_loss: 128765.9192; train_edge_recon_loss: 3793021.1107; train_gene_expr_recon_loss: 28874861.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 75239392.7634; train_global_loss: 108036041.5267; train_optim_loss: 108036041.5267; val_kl_reg_loss: 133525.5224; val_edge_recon_loss: 4062372.2500; val_gene_expr_recon_loss: 23649592.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69916391.2000; val_global_loss: 97761881.0667; val_optim_loss: 97761881.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8253; val_auprc_score: 0.8369; val_best_acc_score: 0.7401; val_best_f1_score: 0.7595; train_kl_reg_loss: 188621.0572; train_edge_recon_loss: 3715960.6412; train_gene_expr_recon_loss: 22901051.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69498035.1145; train_global_loss: 96303668.4580; train_optim_loss: 96303668.4580; val_kl_reg_loss: 167079.1594; val_edge_recon_loss: 4046784.6000; val_gene_expr_recon_loss: 22577371.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69081431.2000; val_global_loss: 95872666.6667; val_optim_loss: 95872666.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8899; val_auprc_score: 0.8820; val_best_acc_score: 0.8065; val_best_f1_score: 0.8168; train_kl_reg_loss: 181104.2458; train_edge_recon_loss: 3573191.2691; train_gene_expr_recon_loss: 22421384.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68790222.0458; train_global_loss: 94965901.3740; train_optim_loss: 94965901.3740; val_kl_reg_loss: 149489.5781; val_edge_recon_loss: 3820631.3167; val_gene_expr_recon_loss: 22251117.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68277141.8667; val_global_loss: 94498381.8667; val_optim_loss: 94498381.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8838; val_auprc_score: 0.8715; val_best_acc_score: 0.8010; val_best_f1_score: 0.8209; train_kl_reg_loss: 163012.5378; train_edge_recon_loss: 3263871.9733; train_gene_expr_recon_loss: 22066319.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68315494.6565; train_global_loss: 93808698.9924; train_optim_loss: 93808698.9924; val_kl_reg_loss: 177030.1604; val_edge_recon_loss: 3092950.4833; val_gene_expr_recon_loss: 22244771.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68646393.6000; val_global_loss: 94161146.6667; val_optim_loss: 94161146.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8899; val_auprc_score: 0.8808; val_best_acc_score: 0.8010; val_best_f1_score: 0.8198; train_kl_reg_loss: 194760.7594; train_edge_recon_loss: 3027415.4637; train_gene_expr_recon_loss: 21881358.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67875944.5802; train_global_loss: 92979479.6947; train_optim_loss: 92979479.6947; val_kl_reg_loss: 189628.5708; val_edge_recon_loss: 3018492.6167; val_gene_expr_recon_loss: 21904704.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67661390.9333; val_global_loss: 92774216.5333; val_optim_loss: 92774216.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8991; val_auprc_score: 0.8884; val_best_acc_score: 0.8127; val_best_f1_score: 0.8271; train_kl_reg_loss: 179987.1770; train_edge_recon_loss: 2983826.4905; train_gene_expr_recon_loss: 21829555.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67580552.2443; train_global_loss: 92573921.1603; train_optim_loss: 92573921.1603; val_kl_reg_loss: 175406.6385; val_edge_recon_loss: 2985627.1833; val_gene_expr_recon_loss: 21974208.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67547356.5333; val_global_loss: 92682599.4667; val_optim_loss: 92682599.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9134; val_auprc_score: 0.8991; val_best_acc_score: 0.8356; val_best_f1_score: 0.8470; train_kl_reg_loss: 176604.4030; train_edge_recon_loss: 2940461.8282; train_gene_expr_recon_loss: 21636858.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67188425.4962; train_global_loss: 91942350.6565; train_optim_loss: 91942350.6565; val_kl_reg_loss: 172606.6917; val_edge_recon_loss: 2934028.3333; val_gene_expr_recon_loss: 21661051.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66924691.4667; val_global_loss: 91692379.2000; val_optim_loss: 91692379.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9298; val_auprc_score: 0.9182; val_best_acc_score: 0.8575; val_best_f1_score: 0.8664; train_kl_reg_loss: 173104.5508; train_edge_recon_loss: 2901083.2672; train_gene_expr_recon_loss: 21493501.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66735278.3817; train_global_loss: 91302967.9389; train_optim_loss: 91302967.9389; val_kl_reg_loss: 167875.5500; val_edge_recon_loss: 2887837.6500; val_gene_expr_recon_loss: 21621720.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66518931.4667; val_global_loss: 91196365.3333; val_optim_loss: 91196365.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9341; val_auprc_score: 0.9237; val_best_acc_score: 0.8649; val_best_f1_score: 0.8718; train_kl_reg_loss: 170118.3521; train_edge_recon_loss: 2865944.6202; train_gene_expr_recon_loss: 21391853.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66464380.4580; train_global_loss: 90892296.7939; train_optim_loss: 90892296.7939; val_kl_reg_loss: 165107.6802; val_edge_recon_loss: 2872071.1500; val_gene_expr_recon_loss: 21470635.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66365738.4000; val_global_loss: 90873552.5333; val_optim_loss: 90873552.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9365; val_auprc_score: 0.9240; val_best_acc_score: 0.8663; val_best_f1_score: 0.8746; train_kl_reg_loss: 166188.0527; train_edge_recon_loss: 2840393.7977; train_gene_expr_recon_loss: 21312398.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66285574.0458; train_global_loss: 90604554.5649; train_optim_loss: 90604554.5649; val_kl_reg_loss: 162393.1729; val_edge_recon_loss: 2849601.0500; val_gene_expr_recon_loss: 21369618.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66145528.2667; val_global_loss: 90527141.3333; val_optim_loss: 90527141.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9429; val_auprc_score: 0.9334; val_best_acc_score: 0.8735; val_best_f1_score: 0.8816; train_kl_reg_loss: 161549.0701; train_edge_recon_loss: 2825081.5000; train_gene_expr_recon_loss: 21219921.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65953848.1221; train_global_loss: 90160399.8779; train_optim_loss: 90160399.8779; val_kl_reg_loss: 156666.6073; val_edge_recon_loss: 2834270.9333; val_gene_expr_recon_loss: 21402656.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66223727.2000; val_global_loss: 90617322.6667; val_optim_loss: 90617322.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9440; val_auprc_score: 0.9330; val_best_acc_score: 0.8767; val_best_f1_score: 0.8830; train_kl_reg_loss: 155593.0630; train_edge_recon_loss: 2814189.3034; train_gene_expr_recon_loss: 21166657.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65877688.6107; train_global_loss: 90014128.9771; train_optim_loss: 90014128.9771; val_kl_reg_loss: 152218.3594; val_edge_recon_loss: 2831304.2667; val_gene_expr_recon_loss: 21288258.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65777569.8667; val_global_loss: 90049351.4667; val_optim_loss: 90049351.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9513; val_auprc_score: 0.9427; val_best_acc_score: 0.8816; val_best_f1_score: 0.8879; train_kl_reg_loss: 152166.8507; train_edge_recon_loss: 2796558.1183; train_gene_expr_recon_loss: 21094224.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65579912.4580; train_global_loss: 89622861.9237; train_optim_loss: 89622861.9237; val_kl_reg_loss: 150643.5719; val_edge_recon_loss: 2806996.9167; val_gene_expr_recon_loss: 21247173.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65624755.4667; val_global_loss: 89829570.1333; val_optim_loss: 89829570.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9547; val_auprc_score: 0.9460; val_best_acc_score: 0.8926; val_best_f1_score: 0.8980; train_kl_reg_loss: 146838.5447; train_edge_recon_loss: 2796799.7996; train_gene_expr_recon_loss: 21047968.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65416055.5115; train_global_loss: 89407662.6565; train_optim_loss: 89407662.6565; val_kl_reg_loss: 142695.4990; val_edge_recon_loss: 2793305.5333; val_gene_expr_recon_loss: 21195075.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65466177.8667; val_global_loss: 89597253.8667; val_optim_loss: 89597253.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9583; val_auprc_score: 0.9505; val_best_acc_score: 0.8977; val_best_f1_score: 0.9010; train_kl_reg_loss: 142370.0631; train_edge_recon_loss: 2786517.4695; train_gene_expr_recon_loss: 20967424.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65137021.7710; train_global_loss: 89033333.9847; train_optim_loss: 89033333.9847; val_kl_reg_loss: 139494.1562; val_edge_recon_loss: 2779441.1500; val_gene_expr_recon_loss: 21114151.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65336791.7333; val_global_loss: 89369877.8667; val_optim_loss: 89369877.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9453; val_auprc_score: 0.9351; val_best_acc_score: 0.8789; val_best_f1_score: 0.8847; train_kl_reg_loss: 136642.2537; train_edge_recon_loss: 2789058.5973; train_gene_expr_recon_loss: 21151532.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65197761.0992; train_global_loss: 89274994.5649; train_optim_loss: 89274994.5649; val_kl_reg_loss: 141795.4781; val_edge_recon_loss: 2825219.7333; val_gene_expr_recon_loss: 21982705.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65743647.2000; val_global_loss: 90693366.4000; val_optim_loss: 90693366.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9433; val_auprc_score: 0.9313; val_best_acc_score: 0.8782; val_best_f1_score: 0.8857; train_kl_reg_loss: 140755.7410; train_edge_recon_loss: 2854172.4466; train_gene_expr_recon_loss: 21545402.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65699376.1527; train_global_loss: 90239706.9924; train_optim_loss: 90239706.9924; val_kl_reg_loss: 140269.7552; val_edge_recon_loss: 2818378.0167; val_gene_expr_recon_loss: 21391187.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65397449.0667; val_global_loss: 89747284.2667; val_optim_loss: 89747284.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9444; val_auprc_score: 0.9338; val_best_acc_score: 0.8771; val_best_f1_score: 0.8853; train_kl_reg_loss: 145169.3280; train_edge_recon_loss: 2835727.0592; train_gene_expr_recon_loss: 21449099.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65608742.2901; train_global_loss: 90038738.1374; train_optim_loss: 90038738.1374; val_kl_reg_loss: 185331.8188; val_edge_recon_loss: 3006320.7500; val_gene_expr_recon_loss: 21545292.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65036877.8667; val_global_loss: 89773823.4667; val_optim_loss: 89773823.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9444; val_auprc_score: 0.9323; val_best_acc_score: 0.8863; val_best_f1_score: 0.8928; train_kl_reg_loss: 775959.5904; train_edge_recon_loss: 2912079.3397; train_gene_expr_recon_loss: 21688318.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65960152.2443; train_global_loss: 91336509.5573; train_optim_loss: 91336509.5573; val_kl_reg_loss: 145252.3563; val_edge_recon_loss: 2864376.0500; val_gene_expr_recon_loss: 21377509.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65391073.8667; val_global_loss: 89778211.2000; val_optim_loss: 89778211.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9451; val_auprc_score: 0.9349; val_best_acc_score: 0.8808; val_best_f1_score: 0.8883; train_kl_reg_loss: 145445.6171; train_edge_recon_loss: 2862783.4943; train_gene_expr_recon_loss: 21372011.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65244731.1450; train_global_loss: 89624971.4809; train_optim_loss: 89624971.4809; val_kl_reg_loss: 146061.7198; val_edge_recon_loss: 2854173.3833; val_gene_expr_recon_loss: 21283709.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65240607.7333; val_global_loss: 89524552.5333; val_optim_loss: 89524552.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9388; val_auprc_score: 0.9257; val_best_acc_score: 0.8779; val_best_f1_score: 0.8862; train_kl_reg_loss: 147007.2321; train_edge_recon_loss: 2843054.2557; train_gene_expr_recon_loss: 21049153.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64834869.7405; train_global_loss: 88874084.4580; train_optim_loss: 88874084.4580; val_kl_reg_loss: 148303.2156; val_edge_recon_loss: 2849190.3833; val_gene_expr_recon_loss: 21279374.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65225338.6667; val_global_loss: 89502207.4667; val_optim_loss: 89502207.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9440; val_auprc_score: 0.9324; val_best_acc_score: 0.8790; val_best_f1_score: 0.8870; train_kl_reg_loss: 147255.1242; train_edge_recon_loss: 2834060.0286; train_gene_expr_recon_loss: 21066665.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64945684.3359; train_global_loss: 88993665.0992; train_optim_loss: 88993665.0992; val_kl_reg_loss: 148440.8719; val_edge_recon_loss: 2825661.1833; val_gene_expr_recon_loss: 21114022.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64566744.2667; val_global_loss: 88654868.8000; val_optim_loss: 88654868.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9409; val_auprc_score: 0.9289; val_best_acc_score: 0.8787; val_best_f1_score: 0.8865; train_kl_reg_loss: 148380.8874; train_edge_recon_loss: 2813573.3664; train_gene_expr_recon_loss: 21033207.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64840582.1679; train_global_loss: 88835744.1832; train_optim_loss: 88835744.1832; val_kl_reg_loss: 148476.9083; val_edge_recon_loss: 2829318.7000; val_gene_expr_recon_loss: 21239050.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65222821.0667; val_global_loss: 89439666.6667; val_optim_loss: 89439666.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9390; val_auprc_score: 0.9276; val_best_acc_score: 0.8771; val_best_f1_score: 0.8855; train_kl_reg_loss: 148447.1678; train_edge_recon_loss: 2808435.8263; train_gene_expr_recon_loss: 21015240.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64781115.7557; train_global_loss: 88753238.9618; train_optim_loss: 88753238.9618; val_kl_reg_loss: 147618.6167; val_edge_recon_loss: 2817011.5667; val_gene_expr_recon_loss: 21187797.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64962363.4667; val_global_loss: 89114790.9333; val_optim_loss: 89114790.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9457; val_auprc_score: 0.9367; val_best_acc_score: 0.8816; val_best_f1_score: 0.8880; train_kl_reg_loss: 148279.6701; train_edge_recon_loss: 2805168.8492; train_gene_expr_recon_loss: 20983814.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64774739.6641; train_global_loss: 88712001.9542; train_optim_loss: 88712001.9542; val_kl_reg_loss: 146620.6156; val_edge_recon_loss: 2826448.7667; val_gene_expr_recon_loss: 21129148.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64928872.0000; val_global_loss: 89031089.0667; val_optim_loss: 89031089.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9408; val_auprc_score: 0.9276; val_best_acc_score: 0.8738; val_best_f1_score: 0.8823; train_kl_reg_loss: 148440.9729; train_edge_recon_loss: 2839069.7958; train_gene_expr_recon_loss: 21570861.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65349706.7481; train_global_loss: 89908079.3893; train_optim_loss: 89908079.3893; val_kl_reg_loss: 84177.4557; val_edge_recon_loss: 2865619.0833; val_gene_expr_recon_loss: 21696398.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65526883.4667; val_global_loss: 90173078.4000; val_optim_loss: 90173078.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9448; val_auprc_score: 0.9284; val_best_acc_score: 0.8809; val_best_f1_score: 0.8884; train_kl_reg_loss: 148957.6657; train_edge_recon_loss: 2845612.1603; train_gene_expr_recon_loss: 21492584.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65244500.1527; train_global_loss: 89731653.4351; train_optim_loss: 89731653.4351; val_kl_reg_loss: 83955.6510; val_edge_recon_loss: 2848033.0833; val_gene_expr_recon_loss: 21705714.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65690729.0667; val_global_loss: 90328432.0000; val_optim_loss: 90328432.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9463; val_auprc_score: 0.9349; val_best_acc_score: 0.8818; val_best_f1_score: 0.8897; train_kl_reg_loss: 149389.8894; train_edge_recon_loss: 2850955.8950; train_gene_expr_recon_loss: 21499701.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65272225.0382; train_global_loss: 89772272.3053; train_optim_loss: 89772272.3053; val_kl_reg_loss: 84714.7661; val_edge_recon_loss: 2832408.6833; val_gene_expr_recon_loss: 21685845.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65425974.1333; val_global_loss: 90028943.4667; val_optim_loss: 90028943.4667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9418; val_auprc_score: 0.9296; val_best_acc_score: 0.8781; val_best_f1_score: 0.8864; train_kl_reg_loss: 149497.1462; train_edge_recon_loss: 2847227.2328; train_gene_expr_recon_loss: 21495544.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65321268.3359; train_global_loss: 89813537.1603; train_optim_loss: 89813537.1603; val_kl_reg_loss: 85911.2328; val_edge_recon_loss: 2865012.2167; val_gene_expr_recon_loss: 21699895.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65644480.5333; val_global_loss: 90295300.2667; val_optim_loss: 90295300.2667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9411; val_auprc_score: 0.9309; val_best_acc_score: 0.8735; val_best_f1_score: 0.8816; train_kl_reg_loss: 150550.2102; train_edge_recon_loss: 2844852.9237; train_gene_expr_recon_loss: 21491945.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65276138.0458; train_global_loss: 89763486.5954; train_optim_loss: 89763486.5954; val_kl_reg_loss: 84530.6542; val_edge_recon_loss: 2869842.4333; val_gene_expr_recon_loss: 21648319.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65192777.0667; val_global_loss: 89795469.8667; val_optim_loss: 89795469.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 54 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9387
val AUPRC score: 0.9251
val best accuracy score: 0.8764
val best F1 score: 0.8849
val target rna MSE score: 1.3488
val source rna MSE score: 82.1404
val target atac MSE score: 0.2569
val source atac MSE score: 0.9845
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
