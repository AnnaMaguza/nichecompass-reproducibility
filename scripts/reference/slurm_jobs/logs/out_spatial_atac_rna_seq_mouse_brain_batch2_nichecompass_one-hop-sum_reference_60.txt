[True]
Run timestamp: 10082023_213629_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7303; val_auprc_score: 0.7519; val_best_acc_score: 0.5187; val_best_f1_score: 0.6734; train_kl_reg_loss: 128427.8423; train_edge_recon_loss: 3800760.1393; train_gene_expr_recon_loss: 46424476.2748; train_masked_gp_l1_reg_loss: 84195.4977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245531.3551; train_chrom_access_recon_loss: 5544040.1031; train_global_loss: 56227430.8702; train_optim_loss: 56227430.8702; val_kl_reg_loss: 121161.4573; val_edge_recon_loss: 4064143.9333; val_gene_expr_recon_loss: 38750183.7333; val_masked_gp_l1_reg_loss: 85485.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240999.8125; val_chrom_access_recon_loss: 5174039.4000; val_global_loss: 48436012.5333; val_optim_loss: 48436012.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7852; val_auprc_score: 0.8005; val_best_acc_score: 0.6566; val_best_f1_score: 0.7272; train_kl_reg_loss: 165106.8222; train_edge_recon_loss: 3679680.5706; train_gene_expr_recon_loss: 38489982.9313; train_masked_gp_l1_reg_loss: 84428.3586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235508.0571; train_chrom_access_recon_loss: 5182633.1489; train_global_loss: 47837339.9389; train_optim_loss: 47837339.9389; val_kl_reg_loss: 202359.5146; val_edge_recon_loss: 4054166.3833; val_gene_expr_recon_loss: 37153221.0667; val_masked_gp_l1_reg_loss: 82509.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229562.9375; val_chrom_access_recon_loss: 5127132.7000; val_global_loss: 46848952.2667; val_optim_loss: 46848952.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8183; val_auprc_score: 0.8327; val_best_acc_score: 0.7111; val_best_f1_score: 0.7461; train_kl_reg_loss: 178838.3016; train_edge_recon_loss: 3570161.7996; train_gene_expr_recon_loss: 37307586.1374; train_masked_gp_l1_reg_loss: 81406.5557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223548.2718; train_chrom_access_recon_loss: 5114973.6450; train_global_loss: 46476515.0840; train_optim_loss: 46476515.0840; val_kl_reg_loss: 164850.0979; val_edge_recon_loss: 3979986.7667; val_gene_expr_recon_loss: 36481609.3333; val_masked_gp_l1_reg_loss: 81064.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217536.2812; val_chrom_access_recon_loss: 5068698.2667; val_global_loss: 45993744.2667; val_optim_loss: 45993744.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8636; val_auprc_score: 0.8605; val_best_acc_score: 0.7828; val_best_f1_score: 0.7894; train_kl_reg_loss: 156227.2875; train_edge_recon_loss: 3479757.6870; train_gene_expr_recon_loss: 36846711.7557; train_masked_gp_l1_reg_loss: 81606.1186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211745.3986; train_chrom_access_recon_loss: 5081419.6985; train_global_loss: 45857468.3053; train_optim_loss: 45857468.3053; val_kl_reg_loss: 145447.4406; val_edge_recon_loss: 3493791.5333; val_gene_expr_recon_loss: 36155987.4667; val_masked_gp_l1_reg_loss: 82727.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206042.5312; val_chrom_access_recon_loss: 5050215.9667; val_global_loss: 45134214.4000; val_optim_loss: 45134214.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8965; val_auprc_score: 0.8863; val_best_acc_score: 0.8220; val_best_f1_score: 0.8300; train_kl_reg_loss: 163166.5271; train_edge_recon_loss: 3224744.7099; train_gene_expr_recon_loss: 36600556.7328; train_masked_gp_l1_reg_loss: 84424.1619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200787.1052; train_chrom_access_recon_loss: 5062410.0496; train_global_loss: 45336089.0382; train_optim_loss: 45336089.0382; val_kl_reg_loss: 159856.8844; val_edge_recon_loss: 3145078.4833; val_gene_expr_recon_loss: 35978345.0667; val_masked_gp_l1_reg_loss: 85777.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195779.0312; val_chrom_access_recon_loss: 5021036.2000; val_global_loss: 44585872.2667; val_optim_loss: 44585872.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9173; val_auprc_score: 0.9002; val_best_acc_score: 0.8440; val_best_f1_score: 0.8524; train_kl_reg_loss: 184435.7745; train_edge_recon_loss: 3022004.2118; train_gene_expr_recon_loss: 36308243.4809; train_masked_gp_l1_reg_loss: 86995.8157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 191314.1656; train_chrom_access_recon_loss: 5032891.8702; train_global_loss: 44825885.1298; train_optim_loss: 44825885.1298; val_kl_reg_loss: 182968.1333; val_edge_recon_loss: 2962954.3667; val_gene_expr_recon_loss: 35705198.9333; val_masked_gp_l1_reg_loss: 88103.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186824.1406; val_chrom_access_recon_loss: 5000342.7333; val_global_loss: 44126392.0000; val_optim_loss: 44126392.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9274; val_auprc_score: 0.9130; val_best_acc_score: 0.8550; val_best_f1_score: 0.8650; train_kl_reg_loss: 182614.6295; train_edge_recon_loss: 2946828.7786; train_gene_expr_recon_loss: 36052288.0305; train_masked_gp_l1_reg_loss: 89362.0920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182437.7323; train_chrom_access_recon_loss: 5005771.7824; train_global_loss: 44459303.1145; train_optim_loss: 44459303.1145; val_kl_reg_loss: 179460.1667; val_edge_recon_loss: 2913356.3000; val_gene_expr_recon_loss: 35474268.8000; val_masked_gp_l1_reg_loss: 90586.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178048.7500; val_chrom_access_recon_loss: 4971062.5333; val_global_loss: 43806784.2667; val_optim_loss: 43806784.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9353; val_auprc_score: 0.9223; val_best_acc_score: 0.8709; val_best_f1_score: 0.8782; train_kl_reg_loss: 180841.2068; train_edge_recon_loss: 2901472.5267; train_gene_expr_recon_loss: 35870346.1069; train_masked_gp_l1_reg_loss: 91783.4618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173816.4105; train_chrom_access_recon_loss: 4990677.0954; train_global_loss: 44208936.6107; train_optim_loss: 44208936.6107; val_kl_reg_loss: 173951.0708; val_edge_recon_loss: 2881328.0333; val_gene_expr_recon_loss: 35358437.0667; val_masked_gp_l1_reg_loss: 93067.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169632.6094; val_chrom_access_recon_loss: 4970760.7333; val_global_loss: 43647176.2667; val_optim_loss: 43647176.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9405; val_auprc_score: 0.9283; val_best_acc_score: 0.8748; val_best_f1_score: 0.8828; train_kl_reg_loss: 169963.0105; train_edge_recon_loss: 2896746.0172; train_gene_expr_recon_loss: 35687790.8397; train_masked_gp_l1_reg_loss: 94380.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165673.6545; train_chrom_access_recon_loss: 4970452.8626; train_global_loss: 43985006.7176; train_optim_loss: 43985006.7176; val_kl_reg_loss: 170484.6625; val_edge_recon_loss: 2892047.2667; val_gene_expr_recon_loss: 35339917.0667; val_masked_gp_l1_reg_loss: 95342.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161677.2031; val_chrom_access_recon_loss: 4967227.9667; val_global_loss: 43626696.8000; val_optim_loss: 43626696.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9455; val_auprc_score: 0.9314; val_best_acc_score: 0.8818; val_best_f1_score: 0.8886; train_kl_reg_loss: 170930.3511; train_edge_recon_loss: 2862464.7710; train_gene_expr_recon_loss: 35545210.3206; train_masked_gp_l1_reg_loss: 96410.4203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158060.1684; train_chrom_access_recon_loss: 4958972.5840; train_global_loss: 43792048.4580; train_optim_loss: 43792048.4580; val_kl_reg_loss: 164132.2708; val_edge_recon_loss: 2859511.4167; val_gene_expr_recon_loss: 34978324.2667; val_masked_gp_l1_reg_loss: 97599.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154493.6406; val_chrom_access_recon_loss: 4917823.8667; val_global_loss: 43171883.7333; val_optim_loss: 43171883.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9479; val_auprc_score: 0.9366; val_best_acc_score: 0.8831; val_best_f1_score: 0.8889; train_kl_reg_loss: 164069.1944; train_edge_recon_loss: 2853544.7347; train_gene_expr_recon_loss: 35401288.4580; train_masked_gp_l1_reg_loss: 98578.8671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151185.9224; train_chrom_access_recon_loss: 4942789.8779; train_global_loss: 43611456.9771; train_optim_loss: 43611456.9771; val_kl_reg_loss: 161147.4969; val_edge_recon_loss: 2856895.2000; val_gene_expr_recon_loss: 34818323.7333; val_masked_gp_l1_reg_loss: 99452.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147977.2188; val_chrom_access_recon_loss: 4915746.5333; val_global_loss: 42999540.5333; val_optim_loss: 42999540.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9509; val_auprc_score: 0.9413; val_best_acc_score: 0.8840; val_best_f1_score: 0.8907; train_kl_reg_loss: 157678.0043; train_edge_recon_loss: 2838735.9618; train_gene_expr_recon_loss: 35290803.8626; train_masked_gp_l1_reg_loss: 100556.6896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144859.8754; train_chrom_access_recon_loss: 4939432.3015; train_global_loss: 43472066.5344; train_optim_loss: 43472066.5344; val_kl_reg_loss: 156812.7448; val_edge_recon_loss: 2835419.5667; val_gene_expr_recon_loss: 34918225.6000; val_masked_gp_l1_reg_loss: 101525.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141859.1250; val_chrom_access_recon_loss: 4923792.0000; val_global_loss: 43077633.6000; val_optim_loss: 43077633.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9580; val_auprc_score: 0.9490; val_best_acc_score: 0.8961; val_best_f1_score: 0.9016; train_kl_reg_loss: 153678.3938; train_edge_recon_loss: 2824526.9370; train_gene_expr_recon_loss: 35150189.5878; train_masked_gp_l1_reg_loss: 102569.8698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138958.2000; train_chrom_access_recon_loss: 4924000.7176; train_global_loss: 43293923.4809; train_optim_loss: 43293923.4809; val_kl_reg_loss: 150823.4344; val_edge_recon_loss: 2798737.3167; val_gene_expr_recon_loss: 34523865.8667; val_masked_gp_l1_reg_loss: 103631.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136077.8281; val_chrom_access_recon_loss: 4870847.2333; val_global_loss: 42583982.4000; val_optim_loss: 42583982.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9565; val_auprc_score: 0.9447; val_best_acc_score: 0.9007; val_best_f1_score: 0.9054; train_kl_reg_loss: 150152.8321; train_edge_recon_loss: 2821198.0973; train_gene_expr_recon_loss: 35058536.1069; train_masked_gp_l1_reg_loss: 104508.9725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133389.2487; train_chrom_access_recon_loss: 4914460.0496; train_global_loss: 43182245.4962; train_optim_loss: 43182245.4962; val_kl_reg_loss: 146836.2542; val_edge_recon_loss: 2807259.1167; val_gene_expr_recon_loss: 34679085.7333; val_masked_gp_l1_reg_loss: 105309.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130713.7812; val_chrom_access_recon_loss: 4901243.6667; val_global_loss: 42770445.3333; val_optim_loss: 42770445.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9638; val_auprc_score: 0.9575; val_best_acc_score: 0.9019; val_best_f1_score: 0.9064; train_kl_reg_loss: 146570.6716; train_edge_recon_loss: 2809514.6221; train_gene_expr_recon_loss: 34978697.8168; train_masked_gp_l1_reg_loss: 106326.3332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128145.1048; train_chrom_access_recon_loss: 4907311.1031; train_global_loss: 43076565.5878; train_optim_loss: 43076565.5878; val_kl_reg_loss: 144764.2188; val_edge_recon_loss: 2823255.1167; val_gene_expr_recon_loss: 34467674.9333; val_masked_gp_l1_reg_loss: 107222.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125579.3438; val_chrom_access_recon_loss: 4877395.8667; val_global_loss: 42545893.8667; val_optim_loss: 42545893.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9643; val_auprc_score: 0.9545; val_best_acc_score: 0.9107; val_best_f1_score: 0.9146; train_kl_reg_loss: 144281.5029; train_edge_recon_loss: 2794648.6450; train_gene_expr_recon_loss: 34910842.9924; train_masked_gp_l1_reg_loss: 108164.2683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123227.2874; train_chrom_access_recon_loss: 4908404.1908; train_global_loss: 42989568.7634; train_optim_loss: 42989568.7634; val_kl_reg_loss: 142486.2531; val_edge_recon_loss: 2796529.4167; val_gene_expr_recon_loss: 34346982.6667; val_masked_gp_l1_reg_loss: 109090.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120830.5938; val_chrom_access_recon_loss: 4868382.0000; val_global_loss: 42384303.7333; val_optim_loss: 42384303.7333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9614; val_auprc_score: 0.9508; val_best_acc_score: 0.9027; val_best_f1_score: 0.9065; train_kl_reg_loss: 140233.7395; train_edge_recon_loss: 2798400.2996; train_gene_expr_recon_loss: 34774833.6489; train_masked_gp_l1_reg_loss: 109967.7854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118526.8193; train_chrom_access_recon_loss: 4884586.5420; train_global_loss: 42826549.0992; train_optim_loss: 42826549.0992; val_kl_reg_loss: 141398.2021; val_edge_recon_loss: 2799710.3833; val_gene_expr_recon_loss: 34457460.2667; val_masked_gp_l1_reg_loss: 110967.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116279.9531; val_chrom_access_recon_loss: 4887597.1000; val_global_loss: 42513413.8667; val_optim_loss: 42513413.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9688; val_auprc_score: 0.9619; val_best_acc_score: 0.9169; val_best_f1_score: 0.9194; train_kl_reg_loss: 136778.1418; train_edge_recon_loss: 2793777.2290; train_gene_expr_recon_loss: 34746678.5954; train_masked_gp_l1_reg_loss: 111879.3831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114157.7882; train_chrom_access_recon_loss: 4890992.7672; train_global_loss: 42794263.9084; train_optim_loss: 42794263.9084; val_kl_reg_loss: 135310.1927; val_edge_recon_loss: 2780360.8500; val_gene_expr_recon_loss: 34328280.1333; val_masked_gp_l1_reg_loss: 112810.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112078.2109; val_chrom_access_recon_loss: 4886896.5000; val_global_loss: 42355739.4667; val_optim_loss: 42355739.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9707; val_auprc_score: 0.9632; val_best_acc_score: 0.9185; val_best_f1_score: 0.9211; train_kl_reg_loss: 136213.7338; train_edge_recon_loss: 2780511.6431; train_gene_expr_recon_loss: 34641448.7023; train_masked_gp_l1_reg_loss: 113763.9083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110041.7069; train_chrom_access_recon_loss: 4879277.2824; train_global_loss: 42661256.8244; train_optim_loss: 42661256.8244; val_kl_reg_loss: 135632.9760; val_edge_recon_loss: 2758652.0500; val_gene_expr_recon_loss: 34320165.8667; val_masked_gp_l1_reg_loss: 114519.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108054.2969; val_chrom_access_recon_loss: 4880384.1667; val_global_loss: 42317410.9333; val_optim_loss: 42317410.9333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9716; val_auprc_score: 0.9652; val_best_acc_score: 0.9208; val_best_f1_score: 0.9232; train_kl_reg_loss: 133850.9951; train_edge_recon_loss: 2769507.6985; train_gene_expr_recon_loss: 34556589.1450; train_masked_gp_l1_reg_loss: 115555.6616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106189.3977; train_chrom_access_recon_loss: 4873517.7137; train_global_loss: 42555210.6260; train_optim_loss: 42555210.6260; val_kl_reg_loss: 131946.8141; val_edge_recon_loss: 2795288.2000; val_gene_expr_recon_loss: 34177795.3333; val_masked_gp_l1_reg_loss: 116710.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104340.8203; val_chrom_access_recon_loss: 4872718.8667; val_global_loss: 42198801.0667; val_optim_loss: 42198801.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9712; val_auprc_score: 0.9652; val_best_acc_score: 0.9174; val_best_f1_score: 0.9209; train_kl_reg_loss: 131806.6970; train_edge_recon_loss: 2763222.3874; train_gene_expr_recon_loss: 34528123.6794; train_masked_gp_l1_reg_loss: 117520.4951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102565.8089; train_chrom_access_recon_loss: 4873840.1183; train_global_loss: 42517079.2977; train_optim_loss: 42517079.2977; val_kl_reg_loss: 130509.5823; val_edge_recon_loss: 2774985.0000; val_gene_expr_recon_loss: 34210093.2000; val_masked_gp_l1_reg_loss: 118573.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100874.8438; val_chrom_access_recon_loss: 4865201.8000; val_global_loss: 42200237.3333; val_optim_loss: 42200237.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9730; val_auprc_score: 0.9668; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 129330.2303; train_edge_recon_loss: 2773313.0515; train_gene_expr_recon_loss: 34464312.1069; train_masked_gp_l1_reg_loss: 119402.5399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99202.1699; train_chrom_access_recon_loss: 4865778.9504; train_global_loss: 42451338.8092; train_optim_loss: 42451338.8092; val_kl_reg_loss: 128433.8042; val_edge_recon_loss: 2773213.3667; val_gene_expr_recon_loss: 34136737.6000; val_masked_gp_l1_reg_loss: 120245.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97414.7969; val_chrom_access_recon_loss: 4845098.1000; val_global_loss: 42101142.9333; val_optim_loss: 42101142.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9717; val_auprc_score: 0.9635; val_best_acc_score: 0.9240; val_best_f1_score: 0.9270; train_kl_reg_loss: 127881.3721; train_edge_recon_loss: 2753361.8492; train_gene_expr_recon_loss: 34372393.7710; train_masked_gp_l1_reg_loss: 121221.2807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95914.1109; train_chrom_access_recon_loss: 4860406.4771; train_global_loss: 42331178.7786; train_optim_loss: 42331178.7786; val_kl_reg_loss: 126150.8240; val_edge_recon_loss: 2765266.8000; val_gene_expr_recon_loss: 33876812.4000; val_masked_gp_l1_reg_loss: 122133.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94396.5547; val_chrom_access_recon_loss: 4824689.6667; val_global_loss: 41809447.7333; val_optim_loss: 41809447.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9749; val_auprc_score: 0.9668; val_best_acc_score: 0.9281; val_best_f1_score: 0.9306; train_kl_reg_loss: 127345.2724; train_edge_recon_loss: 2756986.0592; train_gene_expr_recon_loss: 34324295.2214; train_masked_gp_l1_reg_loss: 123086.9097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92993.6561; train_chrom_access_recon_loss: 4859291.4924; train_global_loss: 42283998.6870; train_optim_loss: 42283998.6870; val_kl_reg_loss: 125108.1771; val_edge_recon_loss: 2760807.7500; val_gene_expr_recon_loss: 34036686.4000; val_masked_gp_l1_reg_loss: 123958.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91597.9219; val_chrom_access_recon_loss: 4846944.9333; val_global_loss: 41985102.9333; val_optim_loss: 41985102.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9742; val_auprc_score: 0.9671; val_best_acc_score: 0.9262; val_best_f1_score: 0.9286; train_kl_reg_loss: 124753.8260; train_edge_recon_loss: 2748515.4656; train_gene_expr_recon_loss: 34275658.3817; train_masked_gp_l1_reg_loss: 125006.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90259.3445; train_chrom_access_recon_loss: 4859184.4084; train_global_loss: 42223377.8626; train_optim_loss: 42223377.8626; val_kl_reg_loss: 122402.5328; val_edge_recon_loss: 2769411.2333; val_gene_expr_recon_loss: 33816515.0667; val_masked_gp_l1_reg_loss: 126169.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88984.3984; val_chrom_access_recon_loss: 4844365.5000; val_global_loss: 41767846.6667; val_optim_loss: 41767846.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9761; val_auprc_score: 0.9689; val_best_acc_score: 0.9307; val_best_f1_score: 0.9327; train_kl_reg_loss: 135405.7893; train_edge_recon_loss: 2797832.3263; train_gene_expr_recon_loss: 35382285.2824; train_masked_gp_l1_reg_loss: 125958.7742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89558.8294; train_chrom_access_recon_loss: 4914827.6527; train_global_loss: 43445868.6107; train_optim_loss: 43445868.6107; val_kl_reg_loss: 71125.3531; val_edge_recon_loss: 2763319.5333; val_gene_expr_recon_loss: 34992266.6667; val_masked_gp_l1_reg_loss: 126477.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89286.7422; val_chrom_access_recon_loss: 4901136.2667; val_global_loss: 42943612.0000; val_optim_loss: 42943612.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9759; val_auprc_score: 0.9705; val_best_acc_score: 0.9278; val_best_f1_score: 0.9300; train_kl_reg_loss: 130362.4602; train_edge_recon_loss: 2775555.4866; train_gene_expr_recon_loss: 35467919.2061; train_masked_gp_l1_reg_loss: 127371.3085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88869.1493; train_chrom_access_recon_loss: 4922842.5076; train_global_loss: 43512920.2748; train_optim_loss: 43512920.2748; val_kl_reg_loss: 72692.1151; val_edge_recon_loss: 2756638.1833; val_gene_expr_recon_loss: 35200819.2000; val_masked_gp_l1_reg_loss: 128387.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89041.5312; val_chrom_access_recon_loss: 4909487.6333; val_global_loss: 43157065.8667; val_optim_loss: 43157065.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9735; val_auprc_score: 0.9660; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 124639.9770; train_edge_recon_loss: 2770619.5267; train_gene_expr_recon_loss: 35564078.5496; train_masked_gp_l1_reg_loss: 129264.9363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89073.7372; train_chrom_access_recon_loss: 4911984.9618; train_global_loss: 43589661.6183; train_optim_loss: 43589661.6183; val_kl_reg_loss: 70553.9563; val_edge_recon_loss: 2772228.9667; val_gene_expr_recon_loss: 35181916.0000; val_masked_gp_l1_reg_loss: 129925.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88772.3438; val_chrom_access_recon_loss: 4884545.9000; val_global_loss: 43127941.0667; val_optim_loss: 43127941.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9719; val_auprc_score: 0.9618; val_best_acc_score: 0.9231; val_best_f1_score: 0.9264; train_kl_reg_loss: 123798.0100; train_edge_recon_loss: 2770452.1698; train_gene_expr_recon_loss: 35668461.7099; train_masked_gp_l1_reg_loss: 130627.4922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88431.9614; train_chrom_access_recon_loss: 4910200.5382; train_global_loss: 43691971.8473; train_optim_loss: 43691971.8473; val_kl_reg_loss: 70775.7578; val_edge_recon_loss: 2776723.3833; val_gene_expr_recon_loss: 35241541.8667; val_masked_gp_l1_reg_loss: 130998.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87936.0000; val_chrom_access_recon_loss: 4907798.1667; val_global_loss: 43215775.2000; val_optim_loss: 43215775.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9707; val_auprc_score: 0.9631; val_best_acc_score: 0.9217; val_best_f1_score: 0.9258; train_kl_reg_loss: 123843.6184; train_edge_recon_loss: 2769945.1431; train_gene_expr_recon_loss: 35712209.4046; train_masked_gp_l1_reg_loss: 130657.2009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87699.3632; train_chrom_access_recon_loss: 4916796.4618; train_global_loss: 43741151.0534; train_optim_loss: 43741151.0534; val_kl_reg_loss: 70720.5083; val_edge_recon_loss: 2768545.6667; val_gene_expr_recon_loss: 35275444.6667; val_masked_gp_l1_reg_loss: 130529.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87500.6406; val_chrom_access_recon_loss: 4888945.8000; val_global_loss: 43221685.3333; val_optim_loss: 43221685.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9730; val_auprc_score: 0.9674; val_best_acc_score: 0.9266; val_best_f1_score: 0.9289; train_kl_reg_loss: 125272.8219; train_edge_recon_loss: 2774306.6927; train_gene_expr_recon_loss: 35753247.7863; train_masked_gp_l1_reg_loss: 130412.4511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87369.4766; train_chrom_access_recon_loss: 4919290.7099; train_global_loss: 43789900.0305; train_optim_loss: 43789900.0305; val_kl_reg_loss: 70886.9927; val_edge_recon_loss: 2774215.9167; val_gene_expr_recon_loss: 35502019.4667; val_masked_gp_l1_reg_loss: 130333.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87202.3047; val_chrom_access_recon_loss: 4940207.3000; val_global_loss: 43504865.3333; val_optim_loss: 43504865.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9729; val_auprc_score: 0.9650; val_best_acc_score: 0.9262; val_best_f1_score: 0.9285; train_kl_reg_loss: 125781.8479; train_edge_recon_loss: 2765961.0076; train_gene_expr_recon_loss: 35806644.9771; train_masked_gp_l1_reg_loss: 130295.2232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87069.1620; train_chrom_access_recon_loss: 4917309.4122; train_global_loss: 43833061.3130; train_optim_loss: 43833061.3130; val_kl_reg_loss: 69975.6698; val_edge_recon_loss: 2781774.3833; val_gene_expr_recon_loss: 35275566.9333; val_masked_gp_l1_reg_loss: 130247.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86925.4609; val_chrom_access_recon_loss: 4868654.6333; val_global_loss: 43213143.7333; val_optim_loss: 43213143.7333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9731; val_auprc_score: 0.9642; val_best_acc_score: 0.9241; val_best_f1_score: 0.9274; train_kl_reg_loss: 125946.3289; train_edge_recon_loss: 2765702.8263; train_gene_expr_recon_loss: 35793274.4122; train_masked_gp_l1_reg_loss: 130207.9057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86732.4758; train_chrom_access_recon_loss: 4915122.4656; train_global_loss: 43816986.8092; train_optim_loss: 43816986.8092; val_kl_reg_loss: 69573.3344; val_edge_recon_loss: 2768690.5500; val_gene_expr_recon_loss: 35367580.8000; val_masked_gp_l1_reg_loss: 130153.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86499.7891; val_chrom_access_recon_loss: 4896032.8667; val_global_loss: 43318529.6000; val_optim_loss: 43318529.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9761
val AUPRC score: 0.9690
val best accuracy score: 0.9337
val best F1 score: 0.9360
val target rna MSE score: 1.0867
val source rna MSE score: 205.3255
val target atac MSE score: 0.3398
val source atac MSE score: 3.0700
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
