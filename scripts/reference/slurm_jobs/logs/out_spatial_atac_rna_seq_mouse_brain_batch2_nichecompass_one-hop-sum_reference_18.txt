[True]
Run timestamp: 10082023_191851_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7345; val_auprc_score: 0.7588; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 130878.5897; train_edge_recon_loss: 3651194.7767; train_gene_expr_recon_loss: 27173121.3588; train_masked_gp_l1_reg_loss: 77817.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243830.7384; train_chrom_access_recon_loss: 5529639.7672; train_global_loss: 36806483.0534; train_optim_loss: 36806483.0534; val_kl_reg_loss: 189031.4052; val_edge_recon_loss: 4065215.6167; val_gene_expr_recon_loss: 22922383.6000; val_masked_gp_l1_reg_loss: 72940.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236269.2344; val_chrom_access_recon_loss: 5217709.9667; val_global_loss: 32703550.9333; val_optim_loss: 32703550.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8071; val_auprc_score: 0.8146; val_best_acc_score: 0.6743; val_best_f1_score: 0.7422; train_kl_reg_loss: 185509.6464; train_edge_recon_loss: 3585443.2595; train_gene_expr_recon_loss: 22664856.9160; train_masked_gp_l1_reg_loss: 70708.0394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227060.4802; train_chrom_access_recon_loss: 5173902.0229; train_global_loss: 31907480.3359; train_optim_loss: 31907480.3359; val_kl_reg_loss: 160761.0958; val_edge_recon_loss: 4054701.1000; val_gene_expr_recon_loss: 22085904.8000; val_masked_gp_l1_reg_loss: 69780.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217511.3750; val_chrom_access_recon_loss: 5104304.9000; val_global_loss: 31692964.0000; val_optim_loss: 31692964.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8778; val_auprc_score: 0.8733; val_best_acc_score: 0.7553; val_best_f1_score: 0.7787; train_kl_reg_loss: 158377.0608; train_edge_recon_loss: 3545961.1431; train_gene_expr_recon_loss: 22211825.1908; train_masked_gp_l1_reg_loss: 70688.6954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208199.0125; train_chrom_access_recon_loss: 5115063.1183; train_global_loss: 31310114.1985; train_optim_loss: 31310114.1985; val_kl_reg_loss: 137673.3177; val_edge_recon_loss: 3932635.5500; val_gene_expr_recon_loss: 21824720.5333; val_masked_gp_l1_reg_loss: 71879.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 198949.0156; val_chrom_access_recon_loss: 5070496.3667; val_global_loss: 31236355.8667; val_optim_loss: 31236355.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8896; val_auprc_score: 0.8790; val_best_acc_score: 0.8060; val_best_f1_score: 0.8138; train_kl_reg_loss: 133501.5951; train_edge_recon_loss: 3332396.6145; train_gene_expr_recon_loss: 22054653.7557; train_masked_gp_l1_reg_loss: 75753.5596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190329.0784; train_chrom_access_recon_loss: 5089131.8740; train_global_loss: 30875766.3511; train_optim_loss: 30875766.3511; val_kl_reg_loss: 153708.8417; val_edge_recon_loss: 3062773.7167; val_gene_expr_recon_loss: 21884313.7333; val_masked_gp_l1_reg_loss: 82029.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181880.5312; val_chrom_access_recon_loss: 5072956.4333; val_global_loss: 30437662.5333; val_optim_loss: 30437662.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9047; val_auprc_score: 0.8932; val_best_acc_score: 0.8208; val_best_f1_score: 0.8309; train_kl_reg_loss: 162550.7276; train_edge_recon_loss: 3012902.8378; train_gene_expr_recon_loss: 21896014.4885; train_masked_gp_l1_reg_loss: 82331.2520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174179.3488; train_chrom_access_recon_loss: 5060477.3053; train_global_loss: 30388455.8931; train_optim_loss: 30388455.8931; val_kl_reg_loss: 165156.7365; val_edge_recon_loss: 2971329.0833; val_gene_expr_recon_loss: 21601457.4667; val_masked_gp_l1_reg_loss: 83265.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166772.1406; val_chrom_access_recon_loss: 5036540.8333; val_global_loss: 30024522.8000; val_optim_loss: 30024522.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9177; val_auprc_score: 0.9030; val_best_acc_score: 0.8422; val_best_f1_score: 0.8537; train_kl_reg_loss: 163151.0848; train_edge_recon_loss: 2945971.2023; train_gene_expr_recon_loss: 21743992.1985; train_masked_gp_l1_reg_loss: 84591.0079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160265.1312; train_chrom_access_recon_loss: 5036788.2672; train_global_loss: 30134758.9618; train_optim_loss: 30134758.9618; val_kl_reg_loss: 157218.5281; val_edge_recon_loss: 2915385.5167; val_gene_expr_recon_loss: 21483609.6000; val_masked_gp_l1_reg_loss: 85721.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154025.9062; val_chrom_access_recon_loss: 5020156.2000; val_global_loss: 29816117.6000; val_optim_loss: 29816117.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9212; val_auprc_score: 0.9058; val_best_acc_score: 0.8511; val_best_f1_score: 0.8616; train_kl_reg_loss: 156765.7709; train_edge_recon_loss: 2900245.1718; train_gene_expr_recon_loss: 21613381.7099; train_masked_gp_l1_reg_loss: 86837.6801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148385.4637; train_chrom_access_recon_loss: 5016966.4924; train_global_loss: 29922582.1527; train_optim_loss: 29922582.1527; val_kl_reg_loss: 154596.6365; val_edge_recon_loss: 2905699.0333; val_gene_expr_recon_loss: 21382536.0000; val_masked_gp_l1_reg_loss: 88136.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142945.9531; val_chrom_access_recon_loss: 4988365.0667; val_global_loss: 29662278.8000; val_optim_loss: 29662278.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9283; val_auprc_score: 0.9111; val_best_acc_score: 0.8626; val_best_f1_score: 0.8701; train_kl_reg_loss: 151084.2329; train_edge_recon_loss: 2861321.5248; train_gene_expr_recon_loss: 21499819.5420; train_masked_gp_l1_reg_loss: 89243.6814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137979.1218; train_chrom_access_recon_loss: 4994271.7099; train_global_loss: 29733719.7405; train_optim_loss: 29733719.7405; val_kl_reg_loss: 154435.4781; val_edge_recon_loss: 2866861.4833; val_gene_expr_recon_loss: 21287630.8000; val_masked_gp_l1_reg_loss: 90484.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133107.8594; val_chrom_access_recon_loss: 4969314.6333; val_global_loss: 29501834.4000; val_optim_loss: 29501834.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9293; val_best_acc_score: 0.8735; val_best_f1_score: 0.8819; train_kl_reg_loss: 147551.7857; train_edge_recon_loss: 2846493.4084; train_gene_expr_recon_loss: 21397770.3664; train_masked_gp_l1_reg_loss: 91506.0064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128555.9062; train_chrom_access_recon_loss: 4974665.0763; train_global_loss: 29586542.4122; train_optim_loss: 29586542.4122; val_kl_reg_loss: 144817.6375; val_edge_recon_loss: 2841145.3000; val_gene_expr_recon_loss: 21196921.0667; val_masked_gp_l1_reg_loss: 92562.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124086.8906; val_chrom_access_recon_loss: 4974390.1333; val_global_loss: 29373922.2667; val_optim_loss: 29373922.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9440; val_auprc_score: 0.9316; val_best_acc_score: 0.8795; val_best_f1_score: 0.8865; train_kl_reg_loss: 143322.7612; train_edge_recon_loss: 2827409.4065; train_gene_expr_recon_loss: 21308405.5420; train_masked_gp_l1_reg_loss: 93449.4047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119936.5166; train_chrom_access_recon_loss: 4960252.5496; train_global_loss: 29452776.1374; train_optim_loss: 29452776.1374; val_kl_reg_loss: 142208.7000; val_edge_recon_loss: 2819665.8167; val_gene_expr_recon_loss: 21126130.4000; val_masked_gp_l1_reg_loss: 94467.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115883.0078; val_chrom_access_recon_loss: 4958698.0667; val_global_loss: 29257054.6667; val_optim_loss: 29257054.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9450; val_auprc_score: 0.9310; val_best_acc_score: 0.8844; val_best_f1_score: 0.8906; train_kl_reg_loss: 137951.0819; train_edge_recon_loss: 2810593.5477; train_gene_expr_recon_loss: 21249582.6870; train_masked_gp_l1_reg_loss: 95374.7154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112154.7426; train_chrom_access_recon_loss: 4950263.9427; train_global_loss: 29355920.5954; train_optim_loss: 29355920.5954; val_kl_reg_loss: 137631.9667; val_edge_recon_loss: 2814402.7500; val_gene_expr_recon_loss: 21016842.5333; val_masked_gp_l1_reg_loss: 96638.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108541.6719; val_chrom_access_recon_loss: 4912137.4333; val_global_loss: 29086194.9333; val_optim_loss: 29086194.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9440; val_auprc_score: 0.9293; val_best_acc_score: 0.8794; val_best_f1_score: 0.8857; train_kl_reg_loss: 134713.2262; train_edge_recon_loss: 2807316.2538; train_gene_expr_recon_loss: 21176424.6870; train_masked_gp_l1_reg_loss: 97424.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105390.5745; train_chrom_access_recon_loss: 4940525.7557; train_global_loss: 29261795.2366; train_optim_loss: 29261795.2366; val_kl_reg_loss: 136022.6833; val_edge_recon_loss: 2831864.8333; val_gene_expr_recon_loss: 20868161.4667; val_masked_gp_l1_reg_loss: 98237.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102298.0234; val_chrom_access_recon_loss: 4892180.8000; val_global_loss: 28928766.0000; val_optim_loss: 28928766.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9492; val_auprc_score: 0.9371; val_best_acc_score: 0.8841; val_best_f1_score: 0.8897; train_kl_reg_loss: 131776.7679; train_edge_recon_loss: 2792235.6889; train_gene_expr_recon_loss: 21119294.1985; train_masked_gp_l1_reg_loss: 99230.8500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99470.0985; train_chrom_access_recon_loss: 4927890.0229; train_global_loss: 29169897.5267; train_optim_loss: 29169897.5267; val_kl_reg_loss: 130593.8458; val_edge_recon_loss: 2825012.0167; val_gene_expr_recon_loss: 20920906.5333; val_masked_gp_l1_reg_loss: 100069.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96682.8672; val_chrom_access_recon_loss: 4900338.6000; val_global_loss: 28973602.8000; val_optim_loss: 28973602.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9558; val_auprc_score: 0.9438; val_best_acc_score: 0.8963; val_best_f1_score: 0.9008; train_kl_reg_loss: 128205.4740; train_edge_recon_loss: 2783142.9714; train_gene_expr_recon_loss: 21052269.5420; train_masked_gp_l1_reg_loss: 101066.7974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94046.2042; train_chrom_access_recon_loss: 4917253.0802; train_global_loss: 29075983.8473; train_optim_loss: 29075983.8473; val_kl_reg_loss: 132037.9292; val_edge_recon_loss: 2781765.1667; val_gene_expr_recon_loss: 20962200.0000; val_masked_gp_l1_reg_loss: 102031.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91471.1875; val_chrom_access_recon_loss: 4930004.8000; val_global_loss: 28999511.8667; val_optim_loss: 28999511.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9564; val_auprc_score: 0.9459; val_best_acc_score: 0.8946; val_best_f1_score: 0.8992; train_kl_reg_loss: 125689.2112; train_edge_recon_loss: 2771863.8225; train_gene_expr_recon_loss: 21002784.0916; train_masked_gp_l1_reg_loss: 102952.6684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88985.9150; train_chrom_access_recon_loss: 4909630.6412; train_global_loss: 29001906.3969; train_optim_loss: 29001906.3969; val_kl_reg_loss: 125415.8448; val_edge_recon_loss: 2775495.0667; val_gene_expr_recon_loss: 20854904.9333; val_masked_gp_l1_reg_loss: 104090.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86587.8906; val_chrom_access_recon_loss: 4902879.8667; val_global_loss: 28849374.1333; val_optim_loss: 28849374.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9622; val_auprc_score: 0.9534; val_best_acc_score: 0.9043; val_best_f1_score: 0.9082; train_kl_reg_loss: 122935.0731; train_edge_recon_loss: 2770081.3760; train_gene_expr_recon_loss: 20932585.6947; train_masked_gp_l1_reg_loss: 104737.9906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84243.6502; train_chrom_access_recon_loss: 4893325.1069; train_global_loss: 28907908.9771; train_optim_loss: 28907908.9771; val_kl_reg_loss: 122501.1016; val_edge_recon_loss: 2779852.8167; val_gene_expr_recon_loss: 20808976.9333; val_masked_gp_l1_reg_loss: 105620.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81893.2109; val_chrom_access_recon_loss: 4895601.5000; val_global_loss: 28794446.2667; val_optim_loss: 28794446.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9622; val_auprc_score: 0.9526; val_best_acc_score: 0.9060; val_best_f1_score: 0.9094; train_kl_reg_loss: 121307.3067; train_edge_recon_loss: 2759885.0267; train_gene_expr_recon_loss: 20923637.6489; train_masked_gp_l1_reg_loss: 106406.1885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79786.9967; train_chrom_access_recon_loss: 4895341.0573; train_global_loss: 28886364.0611; train_optim_loss: 28886364.0611; val_kl_reg_loss: 119333.1104; val_edge_recon_loss: 2772621.2833; val_gene_expr_recon_loss: 20771267.7333; val_masked_gp_l1_reg_loss: 107251.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77734.0000; val_chrom_access_recon_loss: 4877510.4667; val_global_loss: 28725718.5333; val_optim_loss: 28725718.5333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9647; val_auprc_score: 0.9561; val_best_acc_score: 0.9099; val_best_f1_score: 0.9130; train_kl_reg_loss: 118523.2170; train_edge_recon_loss: 2745120.5153; train_gene_expr_recon_loss: 20870238.1832; train_masked_gp_l1_reg_loss: 108029.9652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75789.4036; train_chrom_access_recon_loss: 4887021.5458; train_global_loss: 28804722.7634; train_optim_loss: 28804722.7634; val_kl_reg_loss: 119240.8109; val_edge_recon_loss: 2761847.2667; val_gene_expr_recon_loss: 20595456.9333; val_masked_gp_l1_reg_loss: 109088.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73866.1328; val_chrom_access_recon_loss: 4836341.8667; val_global_loss: 28495840.8000; val_optim_loss: 28495840.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9698; val_auprc_score: 0.9627; val_best_acc_score: 0.9194; val_best_f1_score: 0.9222; train_kl_reg_loss: 117655.0581; train_edge_recon_loss: 2752553.7805; train_gene_expr_recon_loss: 20839258.8702; train_masked_gp_l1_reg_loss: 109716.4682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72151.0171; train_chrom_access_recon_loss: 4881012.7328; train_global_loss: 28772347.8321; train_optim_loss: 28772347.8321; val_kl_reg_loss: 117253.0562; val_edge_recon_loss: 2731559.1833; val_gene_expr_recon_loss: 20699461.7333; val_masked_gp_l1_reg_loss: 110489.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70489.8359; val_chrom_access_recon_loss: 4873895.8333; val_global_loss: 28603149.3333; val_optim_loss: 28603149.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9683; val_auprc_score: 0.9604; val_best_acc_score: 0.9170; val_best_f1_score: 0.9195; train_kl_reg_loss: 114938.8622; train_edge_recon_loss: 2742040.2500; train_gene_expr_recon_loss: 20816868.2748; train_masked_gp_l1_reg_loss: 111308.8509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68937.6010; train_chrom_access_recon_loss: 4879951.4962; train_global_loss: 28734045.3893; train_optim_loss: 28734045.3893; val_kl_reg_loss: 113506.2823; val_edge_recon_loss: 2765823.7833; val_gene_expr_recon_loss: 20707943.3333; val_masked_gp_l1_reg_loss: 112199.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67374.5234; val_chrom_access_recon_loss: 4865704.9000; val_global_loss: 28632552.2667; val_optim_loss: 28632552.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9724; val_auprc_score: 0.9649; val_best_acc_score: 0.9241; val_best_f1_score: 0.9259; train_kl_reg_loss: 113231.8257; train_edge_recon_loss: 2744801.6927; train_gene_expr_recon_loss: 20773982.7328; train_masked_gp_l1_reg_loss: 112806.9729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65958.7718; train_chrom_access_recon_loss: 4872223.6832; train_global_loss: 28683005.4962; train_optim_loss: 28683005.4962; val_kl_reg_loss: 116814.3656; val_edge_recon_loss: 2734633.2833; val_gene_expr_recon_loss: 20616107.3333; val_masked_gp_l1_reg_loss: 113675.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64563.3359; val_chrom_access_recon_loss: 4865714.7333; val_global_loss: 28511509.4667; val_optim_loss: 28511509.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9693; val_auprc_score: 0.9604; val_best_acc_score: 0.9197; val_best_f1_score: 0.9228; train_kl_reg_loss: 112058.4363; train_edge_recon_loss: 2738240.8760; train_gene_expr_recon_loss: 20751192.3969; train_masked_gp_l1_reg_loss: 114410.0285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63221.9300; train_chrom_access_recon_loss: 4870744.9046; train_global_loss: 28649868.6412; train_optim_loss: 28649868.6412; val_kl_reg_loss: 112377.3234; val_edge_recon_loss: 2746749.3667; val_gene_expr_recon_loss: 20549007.0667; val_masked_gp_l1_reg_loss: 115182.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61989.7461; val_chrom_access_recon_loss: 4840868.3333; val_global_loss: 28426174.1333; val_optim_loss: 28426174.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9733; val_auprc_score: 0.9663; val_best_acc_score: 0.9293; val_best_f1_score: 0.9312; train_kl_reg_loss: 111014.5933; train_edge_recon_loss: 2736630.5172; train_gene_expr_recon_loss: 20691602.0916; train_masked_gp_l1_reg_loss: 115780.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60690.5921; train_chrom_access_recon_loss: 4861779.9809; train_global_loss: 28577498.1679; train_optim_loss: 28577498.1679; val_kl_reg_loss: 111176.3432; val_edge_recon_loss: 2727920.8833; val_gene_expr_recon_loss: 20568921.4667; val_masked_gp_l1_reg_loss: 116701.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59518.4922; val_chrom_access_recon_loss: 4863929.2333; val_global_loss: 28448168.1333; val_optim_loss: 28448168.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9745; val_auprc_score: 0.9677; val_best_acc_score: 0.9282; val_best_f1_score: 0.9303; train_kl_reg_loss: 109261.4005; train_edge_recon_loss: 2725000.0916; train_gene_expr_recon_loss: 20701065.6641; train_masked_gp_l1_reg_loss: 117271.7622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58387.0071; train_chrom_access_recon_loss: 4864369.0954; train_global_loss: 28575355.2519; train_optim_loss: 28575355.2519; val_kl_reg_loss: 109285.9688; val_edge_recon_loss: 2725885.9667; val_gene_expr_recon_loss: 20562556.1333; val_masked_gp_l1_reg_loss: 117869.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57276.5547; val_chrom_access_recon_loss: 4855439.1667; val_global_loss: 28428312.9333; val_optim_loss: 28428312.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9757; val_auprc_score: 0.9698; val_best_acc_score: 0.9276; val_best_f1_score: 0.9297; train_kl_reg_loss: 107864.2928; train_edge_recon_loss: 2724305.7748; train_gene_expr_recon_loss: 20671203.8473; train_masked_gp_l1_reg_loss: 118688.0044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56233.6863; train_chrom_access_recon_loss: 4861568.9809; train_global_loss: 28539864.5649; train_optim_loss: 28539864.5649; val_kl_reg_loss: 106037.4859; val_edge_recon_loss: 2737534.6167; val_gene_expr_recon_loss: 20539097.2000; val_masked_gp_l1_reg_loss: 119506.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55259.0156; val_chrom_access_recon_loss: 4852023.8333; val_global_loss: 28409459.3333; val_optim_loss: 28409459.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9375; val_auprc_score: 0.9262; val_best_acc_score: 0.8716; val_best_f1_score: 0.8768; train_kl_reg_loss: 122676.4025; train_edge_recon_loss: 2933996.7481; train_gene_expr_recon_loss: 24510634.0458; train_masked_gp_l1_reg_loss: 121818.6537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60560.6602; train_chrom_access_recon_loss: 5080109.0191; train_global_loss: 32829795.4198; train_optim_loss: 32829795.4198; val_kl_reg_loss: 16384.5549; val_edge_recon_loss: 2820036.7167; val_gene_expr_recon_loss: 24784250.2667; val_masked_gp_l1_reg_loss: 121422.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62582.3164; val_chrom_access_recon_loss: 5064945.6667; val_global_loss: 32869621.2000; val_optim_loss: 32869621.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9404; val_auprc_score: 0.9266; val_best_acc_score: 0.8801; val_best_f1_score: 0.8862; train_kl_reg_loss: 60703.0735; train_edge_recon_loss: 2785785.4656; train_gene_expr_recon_loss: 24691655.3740; train_masked_gp_l1_reg_loss: 117827.9049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60754.5315; train_chrom_access_recon_loss: 5073368.6298; train_global_loss: 32790094.9008; train_optim_loss: 32790094.9008; val_kl_reg_loss: 26422.7292; val_edge_recon_loss: 2767054.5833; val_gene_expr_recon_loss: 24166762.6667; val_masked_gp_l1_reg_loss: 114140.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58654.8828; val_chrom_access_recon_loss: 5051257.5667; val_global_loss: 32184291.8667; val_optim_loss: 32184291.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9403; val_auprc_score: 0.9242; val_best_acc_score: 0.8844; val_best_f1_score: 0.8905; train_kl_reg_loss: 48850.4264; train_edge_recon_loss: 2749079.2882; train_gene_expr_recon_loss: 24207817.6641; train_masked_gp_l1_reg_loss: 110614.0446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56863.5769; train_chrom_access_recon_loss: 5050473.2252; train_global_loss: 32223698.0916; train_optim_loss: 32223698.0916; val_kl_reg_loss: 29935.1464; val_edge_recon_loss: 2749268.0167; val_gene_expr_recon_loss: 23794403.7333; val_masked_gp_l1_reg_loss: 107156.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55183.5156; val_chrom_access_recon_loss: 5018642.3667; val_global_loss: 31754589.4667; val_optim_loss: 31754589.4667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9447; val_auprc_score: 0.9276; val_best_acc_score: 0.8870; val_best_f1_score: 0.8918; train_kl_reg_loss: 44206.6911; train_edge_recon_loss: 2733079.8244; train_gene_expr_recon_loss: 23922409.9695; train_masked_gp_l1_reg_loss: 104017.4263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53709.8581; train_chrom_access_recon_loss: 5046749.8244; train_global_loss: 31904173.8015; train_optim_loss: 31904173.8015; val_kl_reg_loss: 30224.8319; val_edge_recon_loss: 2742605.1500; val_gene_expr_recon_loss: 23493105.2000; val_masked_gp_l1_reg_loss: 100911.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52249.1289; val_chrom_access_recon_loss: 5023825.8000; val_global_loss: 31442922.8000; val_optim_loss: 31442922.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9421; val_auprc_score: 0.9228; val_best_acc_score: 0.8859; val_best_f1_score: 0.8922; train_kl_reg_loss: 41706.6125; train_edge_recon_loss: 2727938.1679; train_gene_expr_recon_loss: 23750677.3893; train_masked_gp_l1_reg_loss: 100329.1208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52031.8780; train_chrom_access_recon_loss: 5033123.4504; train_global_loss: 31705806.5191; train_optim_loss: 31705806.5191; val_kl_reg_loss: 30844.0460; val_edge_recon_loss: 2727200.5167; val_gene_expr_recon_loss: 23435682.5333; val_masked_gp_l1_reg_loss: 99997.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51841.9570; val_chrom_access_recon_loss: 5011066.3667; val_global_loss: 31356633.7333; val_optim_loss: 31356633.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9448; val_auprc_score: 0.9309; val_best_acc_score: 0.8887; val_best_f1_score: 0.8939; train_kl_reg_loss: 41800.1811; train_edge_recon_loss: 2729135.4466; train_gene_expr_recon_loss: 23749373.1756; train_masked_gp_l1_reg_loss: 99680.7965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51662.3775; train_chrom_access_recon_loss: 5040571.5458; train_global_loss: 31712223.5573; train_optim_loss: 31712223.5573; val_kl_reg_loss: 31071.2180; val_edge_recon_loss: 2755527.8500; val_gene_expr_recon_loss: 23508768.1333; val_masked_gp_l1_reg_loss: 99355.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51484.1602; val_chrom_access_recon_loss: 5025631.9000; val_global_loss: 31471838.8000; val_optim_loss: 31471838.8000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9485; val_auprc_score: 0.9337; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 41527.4000; train_edge_recon_loss: 2729218.5496; train_gene_expr_recon_loss: 23697332.6260; train_masked_gp_l1_reg_loss: 99020.9398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51307.0370; train_chrom_access_recon_loss: 5030897.4924; train_global_loss: 31649303.9237; train_optim_loss: 31649303.9237; val_kl_reg_loss: 30927.0639; val_edge_recon_loss: 2714078.7333; val_gene_expr_recon_loss: 23406327.6000; val_masked_gp_l1_reg_loss: 98682.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51112.1875; val_chrom_access_recon_loss: 5013815.1333; val_global_loss: 31314942.6667; val_optim_loss: 31314942.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9476; val_auprc_score: 0.9339; val_best_acc_score: 0.8915; val_best_f1_score: 0.8974; train_kl_reg_loss: 41396.5120; train_edge_recon_loss: 2727830.3683; train_gene_expr_recon_loss: 23656844.1069; train_masked_gp_l1_reg_loss: 98335.1323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50923.4028; train_chrom_access_recon_loss: 5026188.7176; train_global_loss: 31601518.1832; train_optim_loss: 31601518.1832; val_kl_reg_loss: 31215.8022; val_edge_recon_loss: 2743175.7833; val_gene_expr_recon_loss: 23497266.1333; val_masked_gp_l1_reg_loss: 97978.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50734.6172; val_chrom_access_recon_loss: 5023529.5667; val_global_loss: 31443899.2000; val_optim_loss: 31443899.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9750
val AUPRC score: 0.9698
val best accuracy score: 0.9282
val best F1 score: 0.9305
val target rna MSE score: 3.7900
val source rna MSE score: 70.2972
val target atac MSE score: 0.3609
val source atac MSE score: 3.4891
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
