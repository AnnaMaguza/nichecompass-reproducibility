[True]
Run timestamp: 27072023_023849_131.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_131']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8829; val_auprc_score: 0.9764; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 446017.1561; train_edge_recon_loss: 11152439.3930; train_gene_expr_recon_loss: 30621408.5395; train_masked_gp_l1_reg_loss: 16006.1215; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42235871.5628; train_optim_loss: 42235871.5628; val_kl_reg_loss: 244986.2871; val_edge_recon_loss: 12023292.8750; val_gene_expr_recon_loss: 23278487.7500; val_masked_gp_l1_reg_loss: 16915.1152; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35563683.0000; val_optim_loss: 35563683.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8688; val_auprc_score: 0.9738; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 276528.4732; train_edge_recon_loss: 10804604.6209; train_gene_expr_recon_loss: 19975457.0837; train_masked_gp_l1_reg_loss: 17656.7082; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31074246.9302; train_optim_loss: 31074246.9302; val_kl_reg_loss: 221300.1660; val_edge_recon_loss: 12018709.5417; val_gene_expr_recon_loss: 10541625.0000; val_masked_gp_l1_reg_loss: 18725.8184; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22800360.5000; val_optim_loss: 22800360.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8588; val_auprc_score: 0.9720; val_best_acc_score: 0.8603; val_best_f1_score: 0.9243; train_kl_reg_loss: 236373.9238; train_edge_recon_loss: 10751317.0837; train_gene_expr_recon_loss: 10175616.9023; train_masked_gp_l1_reg_loss: 18905.1759; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21182213.0698; train_optim_loss: 21182213.0698; val_kl_reg_loss: 195284.0905; val_edge_recon_loss: 11897986.7083; val_gene_expr_recon_loss: 9979626.6667; val_masked_gp_l1_reg_loss: 19108.8223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22092005.9167; val_optim_loss: 22092005.9167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8427; val_auprc_score: 0.9686; val_best_acc_score: 0.8617; val_best_f1_score: 0.9251; train_kl_reg_loss: 221655.9978; train_edge_recon_loss: 10462689.5884; train_gene_expr_recon_loss: 9827698.0047; train_masked_gp_l1_reg_loss: 19410.6698; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20531454.3907; train_optim_loss: 20531454.3907; val_kl_reg_loss: 159152.5065; val_edge_recon_loss: 11798379.9167; val_gene_expr_recon_loss: 9695856.9167; val_masked_gp_l1_reg_loss: 19772.8887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21673161.5833; val_optim_loss: 21673161.5833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8462; val_auprc_score: 0.9678; val_best_acc_score: 0.8621; val_best_f1_score: 0.9243; train_kl_reg_loss: 186393.1357; train_edge_recon_loss: 10516400.8233; train_gene_expr_recon_loss: 9599292.9349; train_masked_gp_l1_reg_loss: 20355.9834; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20322442.8372; train_optim_loss: 20322442.8372; val_kl_reg_loss: 167187.5775; val_edge_recon_loss: 11975537.1250; val_gene_expr_recon_loss: 9451031.3333; val_masked_gp_l1_reg_loss: 20954.4141; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21614710.0833; val_optim_loss: 21614710.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8422; val_auprc_score: 0.9623; val_best_acc_score: 0.8875; val_best_f1_score: 0.9370; train_kl_reg_loss: 153584.9001; train_edge_recon_loss: 10378824.5302; train_gene_expr_recon_loss: 9312315.3349; train_masked_gp_l1_reg_loss: 21486.8074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19866211.5256; train_optim_loss: 19866211.5256; val_kl_reg_loss: 111397.4587; val_edge_recon_loss: 11057837.6667; val_gene_expr_recon_loss: 9194541.9583; val_masked_gp_l1_reg_loss: 22084.1523; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20385861.2500; val_optim_loss: 20385861.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8494; val_auprc_score: 0.9643; val_best_acc_score: 0.8878; val_best_f1_score: 0.9371; train_kl_reg_loss: 104265.5660; train_edge_recon_loss: 9809802.1163; train_gene_expr_recon_loss: 9094138.0140; train_masked_gp_l1_reg_loss: 22866.6843; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19031072.3860; train_optim_loss: 19031072.3860; val_kl_reg_loss: 113897.5430; val_edge_recon_loss: 9343121.7292; val_gene_expr_recon_loss: 8994286.1250; val_masked_gp_l1_reg_loss: 23742.0703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18475047.3333; val_optim_loss: 18475047.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8497; val_auprc_score: 0.9647; val_best_acc_score: 0.8931; val_best_f1_score: 0.9403; train_kl_reg_loss: 147852.4368; train_edge_recon_loss: 9040534.3698; train_gene_expr_recon_loss: 8855368.6884; train_masked_gp_l1_reg_loss: 24444.2301; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18068199.7442; train_optim_loss: 18068199.7442; val_kl_reg_loss: 158525.9889; val_edge_recon_loss: 8891632.1458; val_gene_expr_recon_loss: 8771931.2917; val_masked_gp_l1_reg_loss: 25061.7812; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17847151.3750; val_optim_loss: 17847151.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8438; val_auprc_score: 0.9645; val_best_acc_score: 0.8885; val_best_f1_score: 0.9375; train_kl_reg_loss: 170290.2825; train_edge_recon_loss: 8782731.6791; train_gene_expr_recon_loss: 8660532.3535; train_masked_gp_l1_reg_loss: 25599.7699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17639153.9535; train_optim_loss: 17639153.9535; val_kl_reg_loss: 165058.4336; val_edge_recon_loss: 8916224.5000; val_gene_expr_recon_loss: 8592506.5000; val_masked_gp_l1_reg_loss: 26109.1426; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17699899.5833; val_optim_loss: 17699899.5833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8587; val_auprc_score: 0.9683; val_best_acc_score: 0.8966; val_best_f1_score: 0.9416; train_kl_reg_loss: 163086.0841; train_edge_recon_loss: 8558950.2814; train_gene_expr_recon_loss: 8500525.2698; train_masked_gp_l1_reg_loss: 26587.0355; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17249148.6465; train_optim_loss: 17249148.6465; val_kl_reg_loss: 149629.1263; val_edge_recon_loss: 8729103.5000; val_gene_expr_recon_loss: 8436944.1042; val_masked_gp_l1_reg_loss: 27068.2109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17342744.8750; val_optim_loss: 17342744.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8675; val_auprc_score: 0.9687; val_best_acc_score: 0.8992; val_best_f1_score: 0.9433; train_kl_reg_loss: 150066.0475; train_edge_recon_loss: 8501902.4744; train_gene_expr_recon_loss: 8357637.6930; train_masked_gp_l1_reg_loss: 27558.4229; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17037164.6698; train_optim_loss: 17037164.6698; val_kl_reg_loss: 136850.1260; val_edge_recon_loss: 8752300.6042; val_gene_expr_recon_loss: 8310592.3958; val_masked_gp_l1_reg_loss: 28069.4102; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17227812.8333; val_optim_loss: 17227812.8333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8742; val_auprc_score: 0.9717; val_best_acc_score: 0.9011; val_best_f1_score: 0.9438; train_kl_reg_loss: 138217.5708; train_edge_recon_loss: 8387687.4256; train_gene_expr_recon_loss: 8232676.8535; train_masked_gp_l1_reg_loss: 28558.0283; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16787139.9116; train_optim_loss: 16787139.9116; val_kl_reg_loss: 132146.7015; val_edge_recon_loss: 8464085.1042; val_gene_expr_recon_loss: 8183799.9167; val_masked_gp_l1_reg_loss: 29019.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16809051.6667; val_optim_loss: 16809051.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8819; val_auprc_score: 0.9734; val_best_acc_score: 0.8993; val_best_f1_score: 0.9434; train_kl_reg_loss: 130342.8332; train_edge_recon_loss: 8293399.8279; train_gene_expr_recon_loss: 8111783.3047; train_masked_gp_l1_reg_loss: 29429.8448; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16564955.8186; train_optim_loss: 16564955.8186; val_kl_reg_loss: 116191.0869; val_edge_recon_loss: 8528926.9792; val_gene_expr_recon_loss: 8077461.9583; val_masked_gp_l1_reg_loss: 29825.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16752405.8750; val_optim_loss: 16752405.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9012; val_auprc_score: 0.9784; val_best_acc_score: 0.9120; val_best_f1_score: 0.9495; train_kl_reg_loss: 113554.7564; train_edge_recon_loss: 8261902.0977; train_gene_expr_recon_loss: 8002482.9093; train_masked_gp_l1_reg_loss: 30205.8301; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16408145.5953; train_optim_loss: 16408145.5953; val_kl_reg_loss: 101773.8978; val_edge_recon_loss: 8044321.7708; val_gene_expr_recon_loss: 7967878.4167; val_masked_gp_l1_reg_loss: 30572.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16144545.8750; val_optim_loss: 16144545.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9045; val_auprc_score: 0.9772; val_best_acc_score: 0.9208; val_best_f1_score: 0.9544; train_kl_reg_loss: 104524.0802; train_edge_recon_loss: 8048297.5372; train_gene_expr_recon_loss: 7905474.3093; train_masked_gp_l1_reg_loss: 30865.7308; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16089161.6279; train_optim_loss: 16089161.6279; val_kl_reg_loss: 98158.6185; val_edge_recon_loss: 8262525.0417; val_gene_expr_recon_loss: 7877184.6667; val_masked_gp_l1_reg_loss: 31134.5801; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16269002.9583; val_optim_loss: 16269002.9583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9086; val_auprc_score: 0.9787; val_best_acc_score: 0.9193; val_best_f1_score: 0.9539; train_kl_reg_loss: 96811.9790; train_edge_recon_loss: 7999839.6953; train_gene_expr_recon_loss: 7812005.3419; train_masked_gp_l1_reg_loss: 31382.5656; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15940039.5581; train_optim_loss: 15940039.5581; val_kl_reg_loss: 93934.3438; val_edge_recon_loss: 8279860.1250; val_gene_expr_recon_loss: 7791378.8333; val_masked_gp_l1_reg_loss: 31594.0918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16196767.2083; val_optim_loss: 16196767.2083
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9133; val_auprc_score: 0.9807; val_best_acc_score: 0.9202; val_best_f1_score: 0.9542; train_kl_reg_loss: 87218.3027; train_edge_recon_loss: 8123425.8140; train_gene_expr_recon_loss: 7728690.6814; train_masked_gp_l1_reg_loss: 31800.1356; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15971134.8977; train_optim_loss: 15971134.8977; val_kl_reg_loss: 80056.9489; val_edge_recon_loss: 8292323.2917; val_gene_expr_recon_loss: 7703596.7292; val_masked_gp_l1_reg_loss: 31982.9785; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16107959.7917; val_optim_loss: 16107959.7917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9182; val_auprc_score: 0.9827; val_best_acc_score: 0.9210; val_best_f1_score: 0.9548; train_kl_reg_loss: 78742.6493; train_edge_recon_loss: 7999706.6442; train_gene_expr_recon_loss: 7651633.4140; train_masked_gp_l1_reg_loss: 32100.3118; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15762182.9953; train_optim_loss: 15762182.9953; val_kl_reg_loss: 70329.9411; val_edge_recon_loss: 8092005.4167; val_gene_expr_recon_loss: 7635898.5208; val_masked_gp_l1_reg_loss: 32212.3262; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15830445.7083; val_optim_loss: 15830445.7083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9287; val_auprc_score: 0.9848; val_best_acc_score: 0.9233; val_best_f1_score: 0.9560; train_kl_reg_loss: 69547.3529; train_edge_recon_loss: 8004966.3140; train_gene_expr_recon_loss: 7581279.4674; train_masked_gp_l1_reg_loss: 32278.0861; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15688071.1814; train_optim_loss: 15688071.1814; val_kl_reg_loss: 64515.7539; val_edge_recon_loss: 7976763.2083; val_gene_expr_recon_loss: 7572343.3750; val_masked_gp_l1_reg_loss: 32329.2793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15645951.4167; val_optim_loss: 15645951.4167
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9298; val_auprc_score: 0.9848; val_best_acc_score: 0.9230; val_best_f1_score: 0.9557; train_kl_reg_loss: 60707.1748; train_edge_recon_loss: 7866348.4977; train_gene_expr_recon_loss: 7516522.0907; train_masked_gp_l1_reg_loss: 32315.2115; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15475892.9442; train_optim_loss: 15475892.9442; val_kl_reg_loss: 56182.2974; val_edge_recon_loss: 7947850.4167; val_gene_expr_recon_loss: 7509646.7292; val_masked_gp_l1_reg_loss: 32226.9961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15545906.4583; val_optim_loss: 15545906.4583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9358; val_auprc_score: 0.9864; val_best_acc_score: 0.9258; val_best_f1_score: 0.9569; train_kl_reg_loss: 52347.3266; train_edge_recon_loss: 7873549.8977; train_gene_expr_recon_loss: 7459793.9674; train_masked_gp_l1_reg_loss: 32136.2263; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15417827.4326; train_optim_loss: 15417827.4326; val_kl_reg_loss: 45454.3662; val_edge_recon_loss: 8160208.4792; val_gene_expr_recon_loss: 7459015.8750; val_masked_gp_l1_reg_loss: 32019.8008; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15696698.6667; val_optim_loss: 15696698.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9360; val_auprc_score: 0.9863; val_best_acc_score: 0.9289; val_best_f1_score: 0.9593; train_kl_reg_loss: 45072.5565; train_edge_recon_loss: 7917454.1163; train_gene_expr_recon_loss: 7406430.7791; train_masked_gp_l1_reg_loss: 31845.1065; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15400802.5488; train_optim_loss: 15400802.5488; val_kl_reg_loss: 41674.9020; val_edge_recon_loss: 7951414.8333; val_gene_expr_recon_loss: 7408880.7292; val_masked_gp_l1_reg_loss: 31599.1406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15433569.5417; val_optim_loss: 15433569.5417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9475; val_auprc_score: 0.9888; val_best_acc_score: 0.9344; val_best_f1_score: 0.9620; train_kl_reg_loss: 41213.2785; train_edge_recon_loss: 7772534.3279; train_gene_expr_recon_loss: 7357675.2488; train_masked_gp_l1_reg_loss: 31312.0056; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15202734.8419; train_optim_loss: 15202734.8419; val_kl_reg_loss: 37323.3516; val_edge_recon_loss: 7868491.6458; val_gene_expr_recon_loss: 7356384.2917; val_masked_gp_l1_reg_loss: 31016.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15293215.4167; val_optim_loss: 15293215.4167
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9453; val_auprc_score: 0.9874; val_best_acc_score: 0.9307; val_best_f1_score: 0.9600; train_kl_reg_loss: 39355.6624; train_edge_recon_loss: 7782947.4628; train_gene_expr_recon_loss: 7313162.0512; train_masked_gp_l1_reg_loss: 30644.3859; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15166109.5442; train_optim_loss: 15166109.5442; val_kl_reg_loss: 36675.9331; val_edge_recon_loss: 8168619.3542; val_gene_expr_recon_loss: 7319126.3542; val_masked_gp_l1_reg_loss: 30271.1113; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15554692.6250; val_optim_loss: 15554692.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9505; val_auprc_score: 0.9897; val_best_acc_score: 0.9355; val_best_f1_score: 0.9627; train_kl_reg_loss: 36916.2492; train_edge_recon_loss: 7791756.3233; train_gene_expr_recon_loss: 7277736.8419; train_masked_gp_l1_reg_loss: 29919.8235; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15136329.2093; train_optim_loss: 15136329.2093; val_kl_reg_loss: 33348.5066; val_edge_recon_loss: 7722472.9375; val_gene_expr_recon_loss: 7293669.8333; val_masked_gp_l1_reg_loss: 29542.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15079033.2083; val_optim_loss: 15079033.2083
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9454; val_auprc_score: 0.9879; val_best_acc_score: 0.9384; val_best_f1_score: 0.9643; train_kl_reg_loss: 36320.4606; train_edge_recon_loss: 7737005.5767; train_gene_expr_recon_loss: 7237418.1907; train_masked_gp_l1_reg_loss: 29073.2485; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15039817.4372; train_optim_loss: 15039817.4372; val_kl_reg_loss: 39036.5464; val_edge_recon_loss: 7856526.0625; val_gene_expr_recon_loss: 7250333.2500; val_masked_gp_l1_reg_loss: 28566.9180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174462.7917; val_optim_loss: 15174462.7917
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9505; val_auprc_score: 0.9881; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 35552.5214; train_edge_recon_loss: 7720091.5953; train_gene_expr_recon_loss: 7204070.7372; train_masked_gp_l1_reg_loss: 28154.4837; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14987869.4047; train_optim_loss: 14987869.4047; val_kl_reg_loss: 34591.6437; val_edge_recon_loss: 7751458.1250; val_gene_expr_recon_loss: 7204517.0000; val_masked_gp_l1_reg_loss: 27696.3594; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15018262.9167; val_optim_loss: 15018262.9167
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9522; val_auprc_score: 0.9887; val_best_acc_score: 0.9390; val_best_f1_score: 0.9646; train_kl_reg_loss: 35589.7362; train_edge_recon_loss: 7821038.1302; train_gene_expr_recon_loss: 7172498.8279; train_masked_gp_l1_reg_loss: 27228.8635; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15056355.5535; train_optim_loss: 15056355.5535; val_kl_reg_loss: 34647.2324; val_edge_recon_loss: 7927435.6250; val_gene_expr_recon_loss: 7180607.9375; val_masked_gp_l1_reg_loss: 26787.1211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15169477.7917; val_optim_loss: 15169477.7917
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9529; val_auprc_score: 0.9881; val_best_acc_score: 0.9401; val_best_f1_score: 0.9650; train_kl_reg_loss: 34714.3145; train_edge_recon_loss: 7720624.0721; train_gene_expr_recon_loss: 7145332.4116; train_masked_gp_l1_reg_loss: 26388.2533; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14927059.0744; train_optim_loss: 14927059.0744; val_kl_reg_loss: 32968.5509; val_edge_recon_loss: 8220788.4375; val_gene_expr_recon_loss: 7163244.6250; val_masked_gp_l1_reg_loss: 25956.3301; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15442957.5833; val_optim_loss: 15442957.5833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9573; val_auprc_score: 0.9897; val_best_acc_score: 0.9455; val_best_f1_score: 0.9682; train_kl_reg_loss: 35522.4522; train_edge_recon_loss: 7667695.2023; train_gene_expr_recon_loss: 7121880.6837; train_masked_gp_l1_reg_loss: 25473.4909; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14850571.7907; train_optim_loss: 14850571.7907; val_kl_reg_loss: 33357.3990; val_edge_recon_loss: 8016093.4375; val_gene_expr_recon_loss: 7154214.6667; val_masked_gp_l1_reg_loss: 24962.7520; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15228628.5000; val_optim_loss: 15228628.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9592; val_auprc_score: 0.9909; val_best_acc_score: 0.9460; val_best_f1_score: 0.9687; train_kl_reg_loss: 35325.2888; train_edge_recon_loss: 7691633.5860; train_gene_expr_recon_loss: 7100245.8372; train_masked_gp_l1_reg_loss: 24525.2435; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14851730.0093; train_optim_loss: 14851730.0093; val_kl_reg_loss: 33140.8326; val_edge_recon_loss: 7832392.5208; val_gene_expr_recon_loss: 7116353.3958; val_masked_gp_l1_reg_loss: 24138.0273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15006024.7500; val_optim_loss: 15006024.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9549; val_auprc_score: 0.9896; val_best_acc_score: 0.9443; val_best_f1_score: 0.9676; train_kl_reg_loss: 34149.9958; train_edge_recon_loss: 7712922.3395; train_gene_expr_recon_loss: 7072085.1093; train_masked_gp_l1_reg_loss: 23731.7839; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14842889.1907; train_optim_loss: 14842889.1907; val_kl_reg_loss: 32415.0060; val_edge_recon_loss: 7964371.9583; val_gene_expr_recon_loss: 7093163.4167; val_masked_gp_l1_reg_loss: 23343.0859; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15113293.2917; val_optim_loss: 15113293.2917
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9569; val_auprc_score: 0.9903; val_best_acc_score: 0.9443; val_best_f1_score: 0.9676; train_kl_reg_loss: 33968.4787; train_edge_recon_loss: 7738093.3465; train_gene_expr_recon_loss: 7060136.4093; train_masked_gp_l1_reg_loss: 22951.8763; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14855150.2047; train_optim_loss: 14855150.2047; val_kl_reg_loss: 31141.7411; val_edge_recon_loss: 7844563.6458; val_gene_expr_recon_loss: 7080724.5000; val_masked_gp_l1_reg_loss: 22556.4160; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14978985.8333; val_optim_loss: 14978985.8333
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9574; val_auprc_score: 0.9900; val_best_acc_score: 0.9466; val_best_f1_score: 0.9689; train_kl_reg_loss: 33605.2808; train_edge_recon_loss: 7731812.1953; train_gene_expr_recon_loss: 7040218.6767; train_masked_gp_l1_reg_loss: 22179.6769; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14827815.8140; train_optim_loss: 14827815.8140; val_kl_reg_loss: 32920.6559; val_edge_recon_loss: 7950112.7083; val_gene_expr_recon_loss: 7078423.6042; val_masked_gp_l1_reg_loss: 21811.8516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15083269.0833; val_optim_loss: 15083269.0833
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9598; val_auprc_score: 0.9902; val_best_acc_score: 0.9502; val_best_f1_score: 0.9710; train_kl_reg_loss: 33873.7013; train_edge_recon_loss: 7733432.5535; train_gene_expr_recon_loss: 7028714.2488; train_masked_gp_l1_reg_loss: 21413.9194; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14817434.4558; train_optim_loss: 14817434.4558; val_kl_reg_loss: 31503.9808; val_edge_recon_loss: 7878803.4375; val_gene_expr_recon_loss: 7068183.2708; val_masked_gp_l1_reg_loss: 21054.3535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14999544.7500; val_optim_loss: 14999544.7500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9614; val_auprc_score: 0.9910; val_best_acc_score: 0.9495; val_best_f1_score: 0.9707; train_kl_reg_loss: 34454.9583; train_edge_recon_loss: 7722034.5116; train_gene_expr_recon_loss: 7009052.5581; train_masked_gp_l1_reg_loss: 20719.1677; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14786261.2279; train_optim_loss: 14786261.2279; val_kl_reg_loss: 32958.0700; val_edge_recon_loss: 7706412.0833; val_gene_expr_recon_loss: 7027982.1667; val_masked_gp_l1_reg_loss: 20460.9590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14787813.2500; val_optim_loss: 14787813.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9560; val_auprc_score: 0.9889; val_best_acc_score: 0.9459; val_best_f1_score: 0.9687; train_kl_reg_loss: 34086.8011; train_edge_recon_loss: 7702753.6186; train_gene_expr_recon_loss: 6994463.6535; train_masked_gp_l1_reg_loss: 20182.9615; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14751487.0791; train_optim_loss: 14751487.0791; val_kl_reg_loss: 32840.4498; val_edge_recon_loss: 7748987.6875; val_gene_expr_recon_loss: 7029109.5833; val_masked_gp_l1_reg_loss: 19903.8516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14830841.7083; val_optim_loss: 14830841.7083
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9621; val_auprc_score: 0.9911; val_best_acc_score: 0.9474; val_best_f1_score: 0.9694; train_kl_reg_loss: 33739.9229; train_edge_recon_loss: 7767294.4047; train_gene_expr_recon_loss: 6980270.6116; train_masked_gp_l1_reg_loss: 19593.4007; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14800898.3674; train_optim_loss: 14800898.3674; val_kl_reg_loss: 34323.8577; val_edge_recon_loss: 7886484.7917; val_gene_expr_recon_loss: 7004973.4375; val_masked_gp_l1_reg_loss: 19267.7617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14945049.9583; val_optim_loss: 14945049.9583
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9592; val_auprc_score: 0.9905; val_best_acc_score: 0.9478; val_best_f1_score: 0.9696; train_kl_reg_loss: 34341.1471; train_edge_recon_loss: 7661522.8209; train_gene_expr_recon_loss: 6967006.4326; train_masked_gp_l1_reg_loss: 19043.8794; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14681914.2605; train_optim_loss: 14681914.2605; val_kl_reg_loss: 32885.8778; val_edge_recon_loss: 7973605.4375; val_gene_expr_recon_loss: 7018872.1250; val_masked_gp_l1_reg_loss: 18825.3633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15044188.5000; val_optim_loss: 15044188.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9608; val_auprc_score: 0.9906; val_best_acc_score: 0.9534; val_best_f1_score: 0.9732; train_kl_reg_loss: 33653.6127; train_edge_recon_loss: 7645930.0837; train_gene_expr_recon_loss: 6955491.2233; train_masked_gp_l1_reg_loss: 18615.5082; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14653690.4047; train_optim_loss: 14653690.4047; val_kl_reg_loss: 32946.5420; val_edge_recon_loss: 7434969.5208; val_gene_expr_recon_loss: 7003263.8958; val_masked_gp_l1_reg_loss: 18393.0762; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14489572.9583; val_optim_loss: 14489572.9583
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9635; val_auprc_score: 0.9920; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 33885.9680; train_edge_recon_loss: 7607535.1023; train_gene_expr_recon_loss: 6950461.6674; train_masked_gp_l1_reg_loss: 18158.9771; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14610041.7302; train_optim_loss: 14610041.7302; val_kl_reg_loss: 33919.2493; val_edge_recon_loss: 7750562.0833; val_gene_expr_recon_loss: 6975585.0417; val_masked_gp_l1_reg_loss: 17879.7441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14777946.4167; val_optim_loss: 14777946.4167
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9638; val_auprc_score: 0.9917; val_best_acc_score: 0.9510; val_best_f1_score: 0.9717; train_kl_reg_loss: 33534.4150; train_edge_recon_loss: 7704081.2767; train_gene_expr_recon_loss: 6935535.4930; train_masked_gp_l1_reg_loss: 17691.5732; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14690842.7535; train_optim_loss: 14690842.7535; val_kl_reg_loss: 31687.0033; val_edge_recon_loss: 7802510.9167; val_gene_expr_recon_loss: 6979118.6875; val_masked_gp_l1_reg_loss: 17522.0352; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14830838.5000; val_optim_loss: 14830838.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9666; val_auprc_score: 0.9923; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 33293.8845; train_edge_recon_loss: 7577488.0326; train_gene_expr_recon_loss: 6932383.7605; train_masked_gp_l1_reg_loss: 17309.8799; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14560475.5581; train_optim_loss: 14560475.5581; val_kl_reg_loss: 33174.0501; val_edge_recon_loss: 7600904.7500; val_gene_expr_recon_loss: 6962508.5833; val_masked_gp_l1_reg_loss: 17089.5918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14613677.4167; val_optim_loss: 14613677.4167
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9661; val_auprc_score: 0.9925; val_best_acc_score: 0.9542; val_best_f1_score: 0.9734; train_kl_reg_loss: 33147.9064; train_edge_recon_loss: 7670138.7953; train_gene_expr_recon_loss: 6923043.9674; train_masked_gp_l1_reg_loss: 17035.1588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14643365.8233; train_optim_loss: 14643365.8233; val_kl_reg_loss: 32238.2080; val_edge_recon_loss: 7670416.5417; val_gene_expr_recon_loss: 6969165.6458; val_masked_gp_l1_reg_loss: 16877.4043; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14688697.4167; val_optim_loss: 14688697.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9653; val_auprc_score: 0.9914; val_best_acc_score: 0.9548; val_best_f1_score: 0.9736; train_kl_reg_loss: 32513.8570; train_edge_recon_loss: 7637664.4512; train_gene_expr_recon_loss: 6885989.5628; train_masked_gp_l1_reg_loss: 16694.1989; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14572862.0651; train_optim_loss: 14572862.0651; val_kl_reg_loss: 31644.6605; val_edge_recon_loss: 7837894.3958; val_gene_expr_recon_loss: 6918581.3958; val_masked_gp_l1_reg_loss: 16616.8438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14804737.5417; val_optim_loss: 14804737.5417
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9680; val_auprc_score: 0.9918; val_best_acc_score: 0.9556; val_best_f1_score: 0.9741; train_kl_reg_loss: 33105.7841; train_edge_recon_loss: 7666291.3116; train_gene_expr_recon_loss: 6885939.2349; train_masked_gp_l1_reg_loss: 16583.8853; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14601920.1953; train_optim_loss: 14601920.1953; val_kl_reg_loss: 32387.0763; val_edge_recon_loss: 7905071.5625; val_gene_expr_recon_loss: 6921662.7083; val_masked_gp_l1_reg_loss: 16551.0273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14875672.4583; val_optim_loss: 14875672.4583
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9657; val_auprc_score: 0.9919; val_best_acc_score: 0.9545; val_best_f1_score: 0.9734; train_kl_reg_loss: 32858.9616; train_edge_recon_loss: 7579277.6581; train_gene_expr_recon_loss: 6885677.0163; train_masked_gp_l1_reg_loss: 16538.8963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14514352.5070; train_optim_loss: 14514352.5070; val_kl_reg_loss: 32115.2664; val_edge_recon_loss: 7815886.5208; val_gene_expr_recon_loss: 6918121.0833; val_masked_gp_l1_reg_loss: 16524.1582; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14782646.8333; val_optim_loss: 14782646.8333
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9711; val_auprc_score: 0.9933; val_best_acc_score: 0.9581; val_best_f1_score: 0.9756; train_kl_reg_loss: 32908.7679; train_edge_recon_loss: 7636477.6674; train_gene_expr_recon_loss: 6880058.8000; train_masked_gp_l1_reg_loss: 16507.4480; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14565952.6837; train_optim_loss: 14565952.6837; val_kl_reg_loss: 32121.4288; val_edge_recon_loss: 7670975.0833; val_gene_expr_recon_loss: 6912125.4792; val_masked_gp_l1_reg_loss: 16488.3438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14631709.8750; val_optim_loss: 14631709.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 36 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9616
Val AUPRC score: 0.9905
Val best accuracy score: 0.9517
Val best F1 score: 0.9719
Val gene expr MSE score: 135991.8748
Val cat covariate0 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
