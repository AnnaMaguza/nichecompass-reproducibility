[True]
Run timestamp: 27072023_023843_130.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_130']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8736; val_auprc_score: 0.9749; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 447421.6925; train_edge_recon_loss: 10811551.0186; train_gene_expr_recon_loss: 27551535.1302; train_masked_gp_l1_reg_loss: 7407.4398; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38817915.4047; train_optim_loss: 38817915.4047; val_kl_reg_loss: 340916.7956; val_edge_recon_loss: 11818078.6250; val_gene_expr_recon_loss: 12458719.0833; val_masked_gp_l1_reg_loss: 7933.3457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24625648.5833; val_optim_loss: 24625648.5833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8686; val_auprc_score: 0.9743; val_best_acc_score: 0.8593; val_best_f1_score: 0.9238; train_kl_reg_loss: 303758.5086; train_edge_recon_loss: 10738716.3674; train_gene_expr_recon_loss: 11483004.7070; train_masked_gp_l1_reg_loss: 8327.9621; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22533807.5814; train_optim_loss: 22533807.5814; val_kl_reg_loss: 259791.0924; val_edge_recon_loss: 11874829.5417; val_gene_expr_recon_loss: 10761489.3333; val_masked_gp_l1_reg_loss: 8653.3574; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22904764.0000; val_optim_loss: 22904764.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8517; val_auprc_score: 0.9692; val_best_acc_score: 0.8627; val_best_f1_score: 0.9245; train_kl_reg_loss: 251963.6123; train_edge_recon_loss: 10720235.9023; train_gene_expr_recon_loss: 10389775.2279; train_masked_gp_l1_reg_loss: 8935.5705; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21370910.3163; train_optim_loss: 21370910.3163; val_kl_reg_loss: 202282.4746; val_edge_recon_loss: 12213919.9167; val_gene_expr_recon_loss: 10107141.8750; val_masked_gp_l1_reg_loss: 9247.2891; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22532592.2500; val_optim_loss: 22532592.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8416; val_auprc_score: 0.9664; val_best_acc_score: 0.8674; val_best_f1_score: 0.9273; train_kl_reg_loss: 219223.9350; train_edge_recon_loss: 10535524.7465; train_gene_expr_recon_loss: 9953872.7070; train_masked_gp_l1_reg_loss: 9544.8252; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20718166.2977; train_optim_loss: 20718166.2977; val_kl_reg_loss: 143966.0299; val_edge_recon_loss: 11885336.5000; val_gene_expr_recon_loss: 9786668.2500; val_masked_gp_l1_reg_loss: 9875.8242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21825847.0833; val_optim_loss: 21825847.0833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8456; val_auprc_score: 0.9646; val_best_acc_score: 0.8874; val_best_f1_score: 0.9371; train_kl_reg_loss: 177798.0457; train_edge_recon_loss: 10412381.9093; train_gene_expr_recon_loss: 9661039.4512; train_masked_gp_l1_reg_loss: 10261.7897; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20261481.0884; train_optim_loss: 20261481.0884; val_kl_reg_loss: 143910.6745; val_edge_recon_loss: 11099923.0000; val_gene_expr_recon_loss: 9511663.1667; val_masked_gp_l1_reg_loss: 10670.2168; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20766167.0833; val_optim_loss: 20766167.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8490; val_auprc_score: 0.9648; val_best_acc_score: 0.8834; val_best_f1_score: 0.9352; train_kl_reg_loss: 127760.1090; train_edge_recon_loss: 9726048.1465; train_gene_expr_recon_loss: 9424885.5628; train_masked_gp_l1_reg_loss: 11107.1795; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19289801.0605; train_optim_loss: 19289801.0605; val_kl_reg_loss: 149307.8496; val_edge_recon_loss: 9442785.1042; val_gene_expr_recon_loss: 9278545.0833; val_masked_gp_l1_reg_loss: 11580.9678; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18882218.0833; val_optim_loss: 18882218.0833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8505; val_auprc_score: 0.9653; val_best_acc_score: 0.8917; val_best_f1_score: 0.9397; train_kl_reg_loss: 192520.8320; train_edge_recon_loss: 8995264.0000; train_gene_expr_recon_loss: 9067311.7814; train_masked_gp_l1_reg_loss: 12036.0225; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18267132.6977; train_optim_loss: 18267132.6977; val_kl_reg_loss: 206411.4017; val_edge_recon_loss: 8915282.0833; val_gene_expr_recon_loss: 8869600.0833; val_masked_gp_l1_reg_loss: 12460.7617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18003753.5000; val_optim_loss: 18003753.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8450; val_auprc_score: 0.9635; val_best_acc_score: 0.8959; val_best_f1_score: 0.9418; train_kl_reg_loss: 211598.6808; train_edge_recon_loss: 8827236.5674; train_gene_expr_recon_loss: 8773325.6512; train_masked_gp_l1_reg_loss: 12846.0571; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17825006.9116; train_optim_loss: 17825006.9116; val_kl_reg_loss: 193362.3255; val_edge_recon_loss: 8931687.8542; val_gene_expr_recon_loss: 8655785.0833; val_masked_gp_l1_reg_loss: 13225.2480; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17794061.4583; val_optim_loss: 17794061.4583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8527; val_auprc_score: 0.9670; val_best_acc_score: 0.9054; val_best_f1_score: 0.9472; train_kl_reg_loss: 190811.4795; train_edge_recon_loss: 8688206.9930; train_gene_expr_recon_loss: 8578918.2977; train_masked_gp_l1_reg_loss: 13571.1429; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17471507.7860; train_optim_loss: 17471507.7860; val_kl_reg_loss: 182043.9772; val_edge_recon_loss: 8424558.4583; val_gene_expr_recon_loss: 8474593.1250; val_masked_gp_l1_reg_loss: 13911.6582; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17095107.2917; val_optim_loss: 17095107.2917
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8661; val_auprc_score: 0.9701; val_best_acc_score: 0.9022; val_best_f1_score: 0.9451; train_kl_reg_loss: 169910.7667; train_edge_recon_loss: 8694657.7395; train_gene_expr_recon_loss: 8414851.3767; train_masked_gp_l1_reg_loss: 14226.4253; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17293646.2930; train_optim_loss: 17293646.2930; val_kl_reg_loss: 154007.2292; val_edge_recon_loss: 8729095.1875; val_gene_expr_recon_loss: 8323316.4792; val_masked_gp_l1_reg_loss: 14531.1738; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17220950.6250; val_optim_loss: 17220950.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8722; val_auprc_score: 0.9723; val_best_acc_score: 0.9124; val_best_f1_score: 0.9507; train_kl_reg_loss: 148307.7471; train_edge_recon_loss: 8425083.1302; train_gene_expr_recon_loss: 8274541.2581; train_masked_gp_l1_reg_loss: 14837.5118; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16862769.6233; train_optim_loss: 16862769.6233; val_kl_reg_loss: 133174.2747; val_edge_recon_loss: 8285719.5000; val_gene_expr_recon_loss: 8190260.1250; val_masked_gp_l1_reg_loss: 15140.4932; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16624294.0833; val_optim_loss: 16624294.0833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8927; val_auprc_score: 0.9762; val_best_acc_score: 0.9128; val_best_f1_score: 0.9507; train_kl_reg_loss: 129506.9784; train_edge_recon_loss: 8298354.9767; train_gene_expr_recon_loss: 8144360.3674; train_masked_gp_l1_reg_loss: 15439.5652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16587661.8605; train_optim_loss: 16587661.8605; val_kl_reg_loss: 115130.4349; val_edge_recon_loss: 8378305.7708; val_gene_expr_recon_loss: 8067220.4792; val_masked_gp_l1_reg_loss: 15732.9727; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16576389.3750; val_optim_loss: 16576389.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9043; val_auprc_score: 0.9774; val_best_acc_score: 0.9172; val_best_f1_score: 0.9526; train_kl_reg_loss: 119773.6656; train_edge_recon_loss: 8088651.1651; train_gene_expr_recon_loss: 8024143.6651; train_masked_gp_l1_reg_loss: 16030.6975; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16248599.1814; train_optim_loss: 16248599.1814; val_kl_reg_loss: 110163.5615; val_edge_recon_loss: 8574406.7500; val_gene_expr_recon_loss: 7951245.6875; val_masked_gp_l1_reg_loss: 16318.0195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16652134.0417; val_optim_loss: 16652134.0417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9107; val_auprc_score: 0.9796; val_best_acc_score: 0.9237; val_best_f1_score: 0.9564; train_kl_reg_loss: 119831.9613; train_edge_recon_loss: 8031488.4372; train_gene_expr_recon_loss: 7916249.6209; train_masked_gp_l1_reg_loss: 16587.7714; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16084157.7535; train_optim_loss: 16084157.7535; val_kl_reg_loss: 114704.9593; val_edge_recon_loss: 8079799.3333; val_gene_expr_recon_loss: 7851660.2083; val_masked_gp_l1_reg_loss: 16841.0176; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16063005.5417; val_optim_loss: 16063005.5417
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9166; val_auprc_score: 0.9820; val_best_acc_score: 0.9218; val_best_f1_score: 0.9553; train_kl_reg_loss: 113463.8700; train_edge_recon_loss: 8091883.0581; train_gene_expr_recon_loss: 7819332.0465; train_masked_gp_l1_reg_loss: 17086.8269; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16041765.8558; train_optim_loss: 16041765.8558; val_kl_reg_loss: 103895.6816; val_edge_recon_loss: 8233584.6458; val_gene_expr_recon_loss: 7755046.0833; val_masked_gp_l1_reg_loss: 17321.2617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16109847.5833; val_optim_loss: 16109847.5833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9158; val_auprc_score: 0.9806; val_best_acc_score: 0.9205; val_best_f1_score: 0.9548; train_kl_reg_loss: 103046.6357; train_edge_recon_loss: 7928799.4581; train_gene_expr_recon_loss: 7735914.1628; train_masked_gp_l1_reg_loss: 17542.2809; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15785302.5488; train_optim_loss: 15785302.5488; val_kl_reg_loss: 93522.8171; val_edge_recon_loss: 8138635.9792; val_gene_expr_recon_loss: 7679653.2083; val_masked_gp_l1_reg_loss: 17754.4551; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15929565.9583; val_optim_loss: 15929565.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9233; val_auprc_score: 0.9833; val_best_acc_score: 0.9184; val_best_f1_score: 0.9533; train_kl_reg_loss: 89664.8532; train_edge_recon_loss: 7981289.6884; train_gene_expr_recon_loss: 7657547.6395; train_masked_gp_l1_reg_loss: 17954.7691; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15746456.9721; train_optim_loss: 15746456.9721; val_kl_reg_loss: 83676.6813; val_edge_recon_loss: 8194030.9167; val_gene_expr_recon_loss: 7600007.2292; val_masked_gp_l1_reg_loss: 18141.5645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15895856.7500; val_optim_loss: 15895856.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9257; val_auprc_score: 0.9843; val_best_acc_score: 0.9203; val_best_f1_score: 0.9540; train_kl_reg_loss: 80074.4966; train_edge_recon_loss: 7918168.8023; train_gene_expr_recon_loss: 7583805.4535; train_masked_gp_l1_reg_loss: 18310.9102; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15600359.6698; train_optim_loss: 15600359.6698; val_kl_reg_loss: 72080.9118; val_edge_recon_loss: 7961268.6458; val_gene_expr_recon_loss: 7531317.1042; val_masked_gp_l1_reg_loss: 18464.4941; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15583130.7500; val_optim_loss: 15583130.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9323; val_auprc_score: 0.9857; val_best_acc_score: 0.9230; val_best_f1_score: 0.9559; train_kl_reg_loss: 68715.6153; train_edge_recon_loss: 7924385.3953; train_gene_expr_recon_loss: 7517699.2233; train_masked_gp_l1_reg_loss: 18601.2265; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15529401.4837; train_optim_loss: 15529401.4837; val_kl_reg_loss: 62025.4023; val_edge_recon_loss: 7897975.3750; val_gene_expr_recon_loss: 7467270.3333; val_masked_gp_l1_reg_loss: 18728.2637; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15445999.0833; val_optim_loss: 15445999.0833
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9276; val_auprc_score: 0.9836; val_best_acc_score: 0.9262; val_best_f1_score: 0.9574; train_kl_reg_loss: 60458.9178; train_edge_recon_loss: 7908199.6767; train_gene_expr_recon_loss: 7459766.9186; train_masked_gp_l1_reg_loss: 18822.4381; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15447247.9163; train_optim_loss: 15447247.9163; val_kl_reg_loss: 51265.2459; val_edge_recon_loss: 7877398.7917; val_gene_expr_recon_loss: 7417038.7292; val_masked_gp_l1_reg_loss: 18912.1055; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15364614.7917; val_optim_loss: 15364614.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9424; val_auprc_score: 0.9881; val_best_acc_score: 0.9323; val_best_f1_score: 0.9611; train_kl_reg_loss: 51522.4718; train_edge_recon_loss: 7798877.1767; train_gene_expr_recon_loss: 7403729.0163; train_masked_gp_l1_reg_loss: 18952.6395; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15273081.3256; train_optim_loss: 15273081.3256; val_kl_reg_loss: 45448.6354; val_edge_recon_loss: 7696775.8958; val_gene_expr_recon_loss: 7363201.2917; val_masked_gp_l1_reg_loss: 18980.5469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15124406.8750; val_optim_loss: 15124406.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9368; val_auprc_score: 0.9853; val_best_acc_score: 0.9290; val_best_f1_score: 0.9590; train_kl_reg_loss: 48055.7462; train_edge_recon_loss: 7803151.8349; train_gene_expr_recon_loss: 7354661.8651; train_masked_gp_l1_reg_loss: 18980.4800; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15224849.8651; train_optim_loss: 15224849.8651; val_kl_reg_loss: 43021.4648; val_edge_recon_loss: 8134837.3333; val_gene_expr_recon_loss: 7311735.7708; val_masked_gp_l1_reg_loss: 18973.3457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15508567.6667; val_optim_loss: 15508567.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9424; val_auprc_score: 0.9863; val_best_acc_score: 0.9337; val_best_f1_score: 0.9616; train_kl_reg_loss: 44446.1910; train_edge_recon_loss: 7770769.6721; train_gene_expr_recon_loss: 7305630.9651; train_masked_gp_l1_reg_loss: 18940.9411; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15139787.7767; train_optim_loss: 15139787.7767; val_kl_reg_loss: 41693.3885; val_edge_recon_loss: 8127014.6250; val_gene_expr_recon_loss: 7275960.2500; val_masked_gp_l1_reg_loss: 18917.5625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15463586.2083; val_optim_loss: 15463586.2083
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9504; val_auprc_score: 0.9892; val_best_acc_score: 0.9383; val_best_f1_score: 0.9643; train_kl_reg_loss: 40910.0761; train_edge_recon_loss: 7723375.1860; train_gene_expr_recon_loss: 7264841.6256; train_masked_gp_l1_reg_loss: 18846.4396; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15047973.3581; train_optim_loss: 15047973.3581; val_kl_reg_loss: 39733.2666; val_edge_recon_loss: 7886416.2708; val_gene_expr_recon_loss: 7226252.0208; val_masked_gp_l1_reg_loss: 18746.0098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15171147.5000; val_optim_loss: 15171147.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9452; val_auprc_score: 0.9883; val_best_acc_score: 0.9346; val_best_f1_score: 0.9622; train_kl_reg_loss: 40391.5629; train_edge_recon_loss: 7765484.8395; train_gene_expr_recon_loss: 7224578.5093; train_masked_gp_l1_reg_loss: 18645.6763; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15049100.6233; train_optim_loss: 15049100.6233; val_kl_reg_loss: 39517.9609; val_edge_recon_loss: 7892769.1875; val_gene_expr_recon_loss: 7191003.7708; val_masked_gp_l1_reg_loss: 18520.4961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15141810.8750; val_optim_loss: 15141810.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9507; val_auprc_score: 0.9893; val_best_acc_score: 0.9378; val_best_f1_score: 0.9639; train_kl_reg_loss: 38277.5205; train_edge_recon_loss: 7708070.8628; train_gene_expr_recon_loss: 7184726.5605; train_masked_gp_l1_reg_loss: 18502.9884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14949577.9628; train_optim_loss: 14949577.9628; val_kl_reg_loss: 37157.3018; val_edge_recon_loss: 7932975.4583; val_gene_expr_recon_loss: 7162734.5625; val_masked_gp_l1_reg_loss: 18490.1699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15151357.2500; val_optim_loss: 15151357.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9508; val_auprc_score: 0.9890; val_best_acc_score: 0.9382; val_best_f1_score: 0.9642; train_kl_reg_loss: 37869.8106; train_edge_recon_loss: 7708468.3047; train_gene_expr_recon_loss: 7180249.4419; train_masked_gp_l1_reg_loss: 18480.4848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14945068.0837; train_optim_loss: 14945068.0837; val_kl_reg_loss: 36532.9443; val_edge_recon_loss: 7895882.2292; val_gene_expr_recon_loss: 7170977.3542; val_masked_gp_l1_reg_loss: 18473.5078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15121866.3750; val_optim_loss: 15121866.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9549; val_auprc_score: 0.9898; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 37207.5430; train_edge_recon_loss: 7730801.6326; train_gene_expr_recon_loss: 7175884.2256; train_masked_gp_l1_reg_loss: 18463.1838; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14962356.5442; train_optim_loss: 14962356.5442; val_kl_reg_loss: 35993.1346; val_edge_recon_loss: 7793098.0208; val_gene_expr_recon_loss: 7168011.7083; val_masked_gp_l1_reg_loss: 18454.3223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15015556.9583; val_optim_loss: 15015556.9583
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9500; val_auprc_score: 0.9889; val_best_acc_score: 0.9426; val_best_f1_score: 0.9670; train_kl_reg_loss: 37044.6037; train_edge_recon_loss: 7769534.3070; train_gene_expr_recon_loss: 7170674.9488; train_masked_gp_l1_reg_loss: 18442.2778; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14995696.1907; train_optim_loss: 14995696.1907; val_kl_reg_loss: 35533.3960; val_edge_recon_loss: 7716998.2292; val_gene_expr_recon_loss: 7156768.4792; val_masked_gp_l1_reg_loss: 18430.3633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14927730.0833; val_optim_loss: 14927730.0833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9479; val_auprc_score: 0.9885; val_best_acc_score: 0.9403; val_best_f1_score: 0.9655; train_kl_reg_loss: 36488.0027; train_edge_recon_loss: 7697320.8372; train_gene_expr_recon_loss: 7166611.1209; train_masked_gp_l1_reg_loss: 18416.4651; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14918836.3674; train_optim_loss: 14918836.3674; val_kl_reg_loss: 33696.0158; val_edge_recon_loss: 7807782.8542; val_gene_expr_recon_loss: 7144629.5625; val_masked_gp_l1_reg_loss: 18402.8164; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15004511.4167; val_optim_loss: 15004511.4167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9525; val_auprc_score: 0.9883; val_best_acc_score: 0.9419; val_best_f1_score: 0.9661; train_kl_reg_loss: 35361.2924; train_edge_recon_loss: 7715446.8140; train_gene_expr_recon_loss: 7163363.1651; train_masked_gp_l1_reg_loss: 18393.1609; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14932564.4791; train_optim_loss: 14932564.4791; val_kl_reg_loss: 33318.8232; val_edge_recon_loss: 8067801.3333; val_gene_expr_recon_loss: 7154293.5833; val_masked_gp_l1_reg_loss: 18380.5039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15273794.8750; val_optim_loss: 15273794.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9506; val_auprc_score: 0.9887; val_best_acc_score: 0.9401; val_best_f1_score: 0.9653; train_kl_reg_loss: 34713.7155; train_edge_recon_loss: 7817731.1256; train_gene_expr_recon_loss: 7156424.0256; train_masked_gp_l1_reg_loss: 18368.0866; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15027237.0140; train_optim_loss: 15027237.0140; val_kl_reg_loss: 33606.4712; val_edge_recon_loss: 8037914.7083; val_gene_expr_recon_loss: 7142837.9583; val_masked_gp_l1_reg_loss: 18352.3750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15232711.0417; val_optim_loss: 15232711.0417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9493; val_auprc_score: 0.9886; val_best_acc_score: 0.9400; val_best_f1_score: 0.9651; train_kl_reg_loss: 34399.7731; train_edge_recon_loss: 7717980.0558; train_gene_expr_recon_loss: 7154440.6163; train_masked_gp_l1_reg_loss: 18335.4130; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14925155.8605; train_optim_loss: 14925155.8605; val_kl_reg_loss: 33088.6288; val_edge_recon_loss: 7977795.8542; val_gene_expr_recon_loss: 7147061.1250; val_masked_gp_l1_reg_loss: 18321.4805; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15176266.5000; val_optim_loss: 15176266.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9538; val_auprc_score: 0.9902; val_best_acc_score: 0.9413; val_best_f1_score: 0.9660; train_kl_reg_loss: 33957.0010; train_edge_recon_loss: 7707570.0581; train_gene_expr_recon_loss: 7146355.2116; train_masked_gp_l1_reg_loss: 18317.0172; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14906199.2930; train_optim_loss: 14906199.2930; val_kl_reg_loss: 33080.7780; val_edge_recon_loss: 7873531.6042; val_gene_expr_recon_loss: 7132812.8333; val_masked_gp_l1_reg_loss: 18313.1797; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15057738.3333; val_optim_loss: 15057738.3333
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9533; val_auprc_score: 0.9889; val_best_acc_score: 0.9442; val_best_f1_score: 0.9678; train_kl_reg_loss: 34219.2854; train_edge_recon_loss: 7743743.6512; train_gene_expr_recon_loss: 7145224.8953; train_masked_gp_l1_reg_loss: 18309.8862; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14941497.6744; train_optim_loss: 14941497.6744; val_kl_reg_loss: 33146.6602; val_edge_recon_loss: 7619246.7292; val_gene_expr_recon_loss: 7127421.7500; val_masked_gp_l1_reg_loss: 18307.1465; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14798122.1667; val_optim_loss: 14798122.1667
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9533; val_auprc_score: 0.9891; val_best_acc_score: 0.9422; val_best_f1_score: 0.9663; train_kl_reg_loss: 34039.1819; train_edge_recon_loss: 7716887.0023; train_gene_expr_recon_loss: 7145595.8605; train_masked_gp_l1_reg_loss: 18304.6565; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14914826.6837; train_optim_loss: 14914826.6837; val_kl_reg_loss: 33281.1676; val_edge_recon_loss: 8066366.6458; val_gene_expr_recon_loss: 7128943.9583; val_masked_gp_l1_reg_loss: 18302.0137; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15246893.7917; val_optim_loss: 15246893.7917
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9519; val_auprc_score: 0.9885; val_best_acc_score: 0.9434; val_best_f1_score: 0.9670; train_kl_reg_loss: 34165.7951; train_edge_recon_loss: 7764569.5907; train_gene_expr_recon_loss: 7144409.5558; train_masked_gp_l1_reg_loss: 18299.1295; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14961444.0791; train_optim_loss: 14961444.0791; val_kl_reg_loss: 33074.8250; val_edge_recon_loss: 8018442.0417; val_gene_expr_recon_loss: 7135796.7708; val_masked_gp_l1_reg_loss: 18296.3516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15205609.6250; val_optim_loss: 15205609.6250
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9513; val_auprc_score: 0.9889; val_best_acc_score: 0.9446; val_best_f1_score: 0.9678; train_kl_reg_loss: 34214.0126; train_edge_recon_loss: 7736449.9860; train_gene_expr_recon_loss: 7143992.4721; train_masked_gp_l1_reg_loss: 18293.3224; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14932949.7953; train_optim_loss: 14932949.7953; val_kl_reg_loss: 32933.9716; val_edge_recon_loss: 7878785.5208; val_gene_expr_recon_loss: 7134671.3750; val_masked_gp_l1_reg_loss: 18289.7695; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15064680.8750; val_optim_loss: 15064680.8750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9496; val_auprc_score: 0.9879; val_best_acc_score: 0.9437; val_best_f1_score: 0.9674; train_kl_reg_loss: 34050.1889; train_edge_recon_loss: 7703721.0419; train_gene_expr_recon_loss: 7140795.1442; train_masked_gp_l1_reg_loss: 18286.2576; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14896852.6233; train_optim_loss: 14896852.6233; val_kl_reg_loss: 32810.1535; val_edge_recon_loss: 7714066.5417; val_gene_expr_recon_loss: 7135336.6875; val_masked_gp_l1_reg_loss: 18282.7051; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14900496.4583; val_optim_loss: 14900496.4583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9574; val_auprc_score: 0.9905; val_best_acc_score: 0.9451; val_best_f1_score: 0.9681; train_kl_reg_loss: 33802.0084; train_edge_recon_loss: 7703988.7791; train_gene_expr_recon_loss: 7140861.7512; train_masked_gp_l1_reg_loss: 18282.0187; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14896934.6186; train_optim_loss: 14896934.6186; val_kl_reg_loss: 32728.4989; val_edge_recon_loss: 7801592.9583; val_gene_expr_recon_loss: 7133422.0417; val_masked_gp_l1_reg_loss: 18281.4785; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14986024.4583; val_optim_loss: 14986024.4583
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9525; val_auprc_score: 0.9900; val_best_acc_score: 0.9425; val_best_f1_score: 0.9668; train_kl_reg_loss: 33826.5852; train_edge_recon_loss: 7683356.3186; train_gene_expr_recon_loss: 7141997.0488; train_masked_gp_l1_reg_loss: 18281.0140; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14877460.9674; train_optim_loss: 14877460.9674; val_kl_reg_loss: 32759.4414; val_edge_recon_loss: 7728041.4375; val_gene_expr_recon_loss: 7131186.4167; val_masked_gp_l1_reg_loss: 18280.5391; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14910268.3750; val_optim_loss: 14910268.3750
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9548; val_auprc_score: 0.9899; val_best_acc_score: 0.9418; val_best_f1_score: 0.9662; train_kl_reg_loss: 33766.9676; train_edge_recon_loss: 7646935.0000; train_gene_expr_recon_loss: 7139614.2884; train_masked_gp_l1_reg_loss: 18280.0728; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14838596.2837; train_optim_loss: 14838596.2837; val_kl_reg_loss: 32760.1111; val_edge_recon_loss: 7974606.7292; val_gene_expr_recon_loss: 7132716.8125; val_masked_gp_l1_reg_loss: 18279.6055; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15158363.7500; val_optim_loss: 15158363.7500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9511; val_auprc_score: 0.9891; val_best_acc_score: 0.9388; val_best_f1_score: 0.9645; train_kl_reg_loss: 33727.5843; train_edge_recon_loss: 7765902.1674; train_gene_expr_recon_loss: 7140364.3767; train_masked_gp_l1_reg_loss: 18279.1500; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14958273.2651; train_optim_loss: 14958273.2651; val_kl_reg_loss: 32722.2078; val_edge_recon_loss: 7994834.2917; val_gene_expr_recon_loss: 7128925.4375; val_masked_gp_l1_reg_loss: 18278.6953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174760.9167; val_optim_loss: 15174760.9167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 14 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9520
Val AUPRC score: 0.9893
Val best accuracy score: 0.9421
Val best F1 score: 0.9667
Val gene expr MSE score: 86704.2280
Val cat covariate0 mean sim diff: -0.0052

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
