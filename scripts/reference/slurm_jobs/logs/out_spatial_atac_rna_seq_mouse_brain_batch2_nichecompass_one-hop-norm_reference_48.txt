[True]
Run timestamp: 26072023_015908_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8956; val_auprc_score: 0.9104; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5910.1913; train_edge_recon_loss: 352341.2743; train_gene_expr_recon_loss: 31067870.4444; train_masked_gp_l1_reg_loss: 1923.4569; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10790991.2222; train_global_loss: 42219036.8889; train_optim_loss: 42219036.8889; val_kl_reg_loss: 20118.0371; val_edge_recon_loss: 406600.0938; val_gene_expr_recon_loss: 29550140.0000; val_masked_gp_l1_reg_loss: 1998.1860; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10698732.0000; val_global_loss: 40677588.0000; val_optim_loss: 40677588.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8800; val_auprc_score: 0.8913; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 36868.8620; train_edge_recon_loss: 376357.1354; train_gene_expr_recon_loss: 28021893.1111; train_masked_gp_l1_reg_loss: 2109.3461; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10570145.6667; train_global_loss: 39007374.2222; train_optim_loss: 39007374.2222; val_kl_reg_loss: 52588.5469; val_edge_recon_loss: 406608.7500; val_gene_expr_recon_loss: 26750972.0000; val_masked_gp_l1_reg_loss: 2258.8682; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10456752.0000; val_global_loss: 37669180.0000; val_optim_loss: 37669180.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8616; val_auprc_score: 0.8728; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 66000.0061; train_edge_recon_loss: 392707.8611; train_gene_expr_recon_loss: 25790908.0000; train_masked_gp_l1_reg_loss: 2374.7159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10387678.8889; train_global_loss: 36639667.5556; train_optim_loss: 36639667.5556; val_kl_reg_loss: 81806.2578; val_edge_recon_loss: 406605.0312; val_gene_expr_recon_loss: 24709714.0000; val_masked_gp_l1_reg_loss: 2504.4436; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10229681.0000; val_global_loss: 35430312.0000; val_optim_loss: 35430312.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8672; val_auprc_score: 0.8776; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 103442.1398; train_edge_recon_loss: 399210.3646; train_gene_expr_recon_loss: 24001756.4444; train_masked_gp_l1_reg_loss: 2568.8736; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10104732.2222; train_global_loss: 34611710.4444; train_optim_loss: 34611710.4444; val_kl_reg_loss: 112050.9141; val_edge_recon_loss: 406609.1250; val_gene_expr_recon_loss: 23773108.0000; val_masked_gp_l1_reg_loss: 2624.7996; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10079964.0000; val_global_loss: 34374356.0000; val_optim_loss: 34374356.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8616; val_auprc_score: 0.8650; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 123707.5512; train_edge_recon_loss: 402973.7326; train_gene_expr_recon_loss: 23231226.8889; train_masked_gp_l1_reg_loss: 2644.4356; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10022117.6667; train_global_loss: 33782670.6667; train_optim_loss: 33782670.6667; val_kl_reg_loss: 132481.4531; val_edge_recon_loss: 406599.5312; val_gene_expr_recon_loss: 22808116.0000; val_masked_gp_l1_reg_loss: 2658.7002; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9981015.0000; val_global_loss: 33330868.0000; val_optim_loss: 33330868.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8670; val_auprc_score: 0.8682; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 144030.8316; train_edge_recon_loss: 404533.9757; train_gene_expr_recon_loss: 22383400.2222; train_masked_gp_l1_reg_loss: 2660.9408; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9938524.2222; train_global_loss: 32873150.0000; train_optim_loss: 32873150.0000; val_kl_reg_loss: 147823.5938; val_edge_recon_loss: 406585.5938; val_gene_expr_recon_loss: 22220726.0000; val_masked_gp_l1_reg_loss: 2659.8921; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9914298.0000; val_global_loss: 32692094.0000; val_optim_loss: 32692094.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8679; val_auprc_score: 0.8674; val_best_acc_score: 0.5036; val_best_f1_score: 0.6683; train_kl_reg_loss: 153779.2309; train_edge_recon_loss: 405215.4931; train_gene_expr_recon_loss: 21853452.0000; train_masked_gp_l1_reg_loss: 2653.3541; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9832222.7778; train_global_loss: 32247322.8889; train_optim_loss: 32247322.8889; val_kl_reg_loss: 153134.6875; val_edge_recon_loss: 406563.4688; val_gene_expr_recon_loss: 21828790.0000; val_masked_gp_l1_reg_loss: 2643.9102; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9867968.0000; val_global_loss: 32259100.0000; val_optim_loss: 32259100.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8686; val_auprc_score: 0.8631; val_best_acc_score: 0.5101; val_best_f1_score: 0.6712; train_kl_reg_loss: 155788.0000; train_edge_recon_loss: 405363.8438; train_gene_expr_recon_loss: 21460395.3333; train_masked_gp_l1_reg_loss: 2637.0682; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9812172.1111; train_global_loss: 31836356.0000; train_optim_loss: 31836356.0000; val_kl_reg_loss: 145374.1562; val_edge_recon_loss: 406513.3438; val_gene_expr_recon_loss: 21579908.0000; val_masked_gp_l1_reg_loss: 2628.5474; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9814278.0000; val_global_loss: 31948702.0000; val_optim_loss: 31948702.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8732; val_auprc_score: 0.8625; val_best_acc_score: 0.5162; val_best_f1_score: 0.6739; train_kl_reg_loss: 146160.0122; train_edge_recon_loss: 405222.3611; train_gene_expr_recon_loss: 21247510.2222; train_masked_gp_l1_reg_loss: 2625.1711; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9788259.3333; train_global_loss: 31589777.1111; train_optim_loss: 31589777.1111; val_kl_reg_loss: 142204.2656; val_edge_recon_loss: 406445.1250; val_gene_expr_recon_loss: 21460380.0000; val_masked_gp_l1_reg_loss: 2621.8389; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9806575.0000; val_global_loss: 31818228.0000; val_optim_loss: 31818228.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8739; val_auprc_score: 0.8625; val_best_acc_score: 0.5288; val_best_f1_score: 0.6790; train_kl_reg_loss: 144642.5017; train_edge_recon_loss: 405013.6875; train_gene_expr_recon_loss: 21329148.8889; train_masked_gp_l1_reg_loss: 2620.0180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9811135.8889; train_global_loss: 31692561.1111; train_optim_loss: 31692561.1111; val_kl_reg_loss: 136046.4844; val_edge_recon_loss: 406327.4375; val_gene_expr_recon_loss: 21349178.0000; val_masked_gp_l1_reg_loss: 2617.6753; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9772011.0000; val_global_loss: 31666180.0000; val_optim_loss: 31666180.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8721; val_auprc_score: 0.8600; val_best_acc_score: 0.5647; val_best_f1_score: 0.6950; train_kl_reg_loss: 138751.0104; train_edge_recon_loss: 404788.2604; train_gene_expr_recon_loss: 21031676.0000; train_masked_gp_l1_reg_loss: 2618.9917; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9706132.1111; train_global_loss: 31283966.2222; train_optim_loss: 31283966.2222; val_kl_reg_loss: 134549.6719; val_edge_recon_loss: 406132.0625; val_gene_expr_recon_loss: 21273290.0000; val_masked_gp_l1_reg_loss: 2621.3721; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9774210.0000; val_global_loss: 31590804.0000; val_optim_loss: 31590804.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8733; val_auprc_score: 0.8614; val_best_acc_score: 0.6156; val_best_f1_score: 0.7196; train_kl_reg_loss: 137315.7656; train_edge_recon_loss: 404606.7639; train_gene_expr_recon_loss: 21206733.5556; train_masked_gp_l1_reg_loss: 2623.1324; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9746564.1111; train_global_loss: 31497843.7778; train_optim_loss: 31497843.7778; val_kl_reg_loss: 129335.0000; val_edge_recon_loss: 405875.0000; val_gene_expr_recon_loss: 21211858.0000; val_masked_gp_l1_reg_loss: 2625.4536; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9761602.0000; val_global_loss: 31511296.0000; val_optim_loss: 31511296.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8762; val_auprc_score: 0.8631; val_best_acc_score: 0.6652; val_best_f1_score: 0.7451; train_kl_reg_loss: 132588.1788; train_edge_recon_loss: 404099.8299; train_gene_expr_recon_loss: 20993147.1111; train_masked_gp_l1_reg_loss: 2630.1491; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9711656.4444; train_global_loss: 31244121.7778; train_optim_loss: 31244121.7778; val_kl_reg_loss: 126687.7812; val_edge_recon_loss: 405536.4375; val_gene_expr_recon_loss: 21152094.0000; val_masked_gp_l1_reg_loss: 2636.1011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9741086.0000; val_global_loss: 31428040.0000; val_optim_loss: 31428040.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8817; val_auprc_score: 0.8678; val_best_acc_score: 0.7080; val_best_f1_score: 0.7685; train_kl_reg_loss: 128973.3941; train_edge_recon_loss: 403844.2569; train_gene_expr_recon_loss: 20854670.2222; train_masked_gp_l1_reg_loss: 2642.5696; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9665923.3333; train_global_loss: 31056053.7778; train_optim_loss: 31056053.7778; val_kl_reg_loss: 125469.6250; val_edge_recon_loss: 405130.7188; val_gene_expr_recon_loss: 21104236.0000; val_masked_gp_l1_reg_loss: 2649.4976; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9729587.0000; val_global_loss: 31367072.0000; val_optim_loss: 31367072.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8893; val_auprc_score: 0.8768; val_best_acc_score: 0.7370; val_best_f1_score: 0.7842; train_kl_reg_loss: 127795.5087; train_edge_recon_loss: 403274.4062; train_gene_expr_recon_loss: 20922088.6667; train_masked_gp_l1_reg_loss: 2653.8384; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9678367.1111; train_global_loss: 31134179.3333; train_optim_loss: 31134179.3333; val_kl_reg_loss: 122050.8125; val_edge_recon_loss: 404604.9688; val_gene_expr_recon_loss: 21039244.0000; val_masked_gp_l1_reg_loss: 2658.5046; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9708947.0000; val_global_loss: 31277504.0000; val_optim_loss: 31277504.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8937; val_auprc_score: 0.8822; val_best_acc_score: 0.7607; val_best_f1_score: 0.7974; train_kl_reg_loss: 124306.8368; train_edge_recon_loss: 402486.6354; train_gene_expr_recon_loss: 20865981.3333; train_masked_gp_l1_reg_loss: 2663.3093; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690408.1111; train_global_loss: 31085846.6667; train_optim_loss: 31085846.6667; val_kl_reg_loss: 119409.4375; val_edge_recon_loss: 404125.7500; val_gene_expr_recon_loss: 21019496.0000; val_masked_gp_l1_reg_loss: 2669.1807; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9719580.0000; val_global_loss: 31265282.0000; val_optim_loss: 31265282.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9037; val_auprc_score: 0.8917; val_best_acc_score: 0.8003; val_best_f1_score: 0.8230; train_kl_reg_loss: 121542.7891; train_edge_recon_loss: 401881.5764; train_gene_expr_recon_loss: 20843047.5556; train_masked_gp_l1_reg_loss: 2673.7394; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9696929.1111; train_global_loss: 31066074.8889; train_optim_loss: 31066074.8889; val_kl_reg_loss: 116187.1094; val_edge_recon_loss: 403527.3125; val_gene_expr_recon_loss: 20982464.0000; val_masked_gp_l1_reg_loss: 2678.9995; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9702828.0000; val_global_loss: 31207684.0000; val_optim_loss: 31207684.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9141; val_auprc_score: 0.9011; val_best_acc_score: 0.8371; val_best_f1_score: 0.8492; train_kl_reg_loss: 119509.5052; train_edge_recon_loss: 401182.2222; train_gene_expr_recon_loss: 20791740.0000; train_masked_gp_l1_reg_loss: 2684.1781; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9671908.8889; train_global_loss: 30987024.8889; train_optim_loss: 30987024.8889; val_kl_reg_loss: 113400.2031; val_edge_recon_loss: 402978.3750; val_gene_expr_recon_loss: 20942270.0000; val_masked_gp_l1_reg_loss: 2690.2527; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9697727.0000; val_global_loss: 31159064.0000; val_optim_loss: 31159064.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9196; val_auprc_score: 0.9019; val_best_acc_score: 0.8504; val_best_f1_score: 0.8584; train_kl_reg_loss: 116461.1519; train_edge_recon_loss: 400535.3576; train_gene_expr_recon_loss: 20652449.3333; train_masked_gp_l1_reg_loss: 2695.9131; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9607346.3333; train_global_loss: 30779488.4444; train_optim_loss: 30779488.4444; val_kl_reg_loss: 114352.0781; val_edge_recon_loss: 402208.0000; val_gene_expr_recon_loss: 20927012.0000; val_masked_gp_l1_reg_loss: 2701.9226; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9693643.0000; val_global_loss: 31139916.0000; val_optim_loss: 31139916.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9195; val_auprc_score: 0.9008; val_best_acc_score: 0.8506; val_best_f1_score: 0.8559; train_kl_reg_loss: 115084.3872; train_edge_recon_loss: 399774.2535; train_gene_expr_recon_loss: 20784525.3333; train_masked_gp_l1_reg_loss: 2705.5429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9701358.2222; train_global_loss: 31003447.5556; train_optim_loss: 31003447.5556; val_kl_reg_loss: 109891.8750; val_edge_recon_loss: 401287.1562; val_gene_expr_recon_loss: 20870776.0000; val_masked_gp_l1_reg_loss: 2710.5642; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9676347.0000; val_global_loss: 31061012.0000; val_optim_loss: 31061012.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9187; val_auprc_score: 0.9042; val_best_acc_score: 0.8508; val_best_f1_score: 0.8544; train_kl_reg_loss: 112709.9123; train_edge_recon_loss: 398685.5590; train_gene_expr_recon_loss: 20609800.8889; train_masked_gp_l1_reg_loss: 2714.7401; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625275.2222; train_global_loss: 30749185.5556; train_optim_loss: 30749185.5556; val_kl_reg_loss: 108447.1719; val_edge_recon_loss: 400875.9375; val_gene_expr_recon_loss: 20860060.0000; val_masked_gp_l1_reg_loss: 2719.3218; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9674720.0000; val_global_loss: 31046824.0000; val_optim_loss: 31046824.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9273; val_auprc_score: 0.9123; val_best_acc_score: 0.8534; val_best_f1_score: 0.8534; train_kl_reg_loss: 111572.3906; train_edge_recon_loss: 397880.9340; train_gene_expr_recon_loss: 20623138.4444; train_masked_gp_l1_reg_loss: 2723.7323; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587034.2222; train_global_loss: 30722350.0000; train_optim_loss: 30722350.0000; val_kl_reg_loss: 105053.1875; val_edge_recon_loss: 399628.1875; val_gene_expr_recon_loss: 20836424.0000; val_masked_gp_l1_reg_loss: 2729.0930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9660222.0000; val_global_loss: 31004058.0000; val_optim_loss: 31004058.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9232; val_auprc_score: 0.9087; val_best_acc_score: 0.8444; val_best_f1_score: 0.8429; train_kl_reg_loss: 110135.7674; train_edge_recon_loss: 396956.3889; train_gene_expr_recon_loss: 20705797.3333; train_masked_gp_l1_reg_loss: 2734.5130; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9678716.0000; train_global_loss: 30894340.0000; train_optim_loss: 30894340.0000; val_kl_reg_loss: 100719.8281; val_edge_recon_loss: 398863.3438; val_gene_expr_recon_loss: 20785318.0000; val_masked_gp_l1_reg_loss: 2740.6482; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9630308.0000; val_global_loss: 30917950.0000; val_optim_loss: 30917950.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9303; val_auprc_score: 0.9166; val_best_acc_score: 0.8500; val_best_f1_score: 0.8457; train_kl_reg_loss: 107768.8438; train_edge_recon_loss: 396011.8333; train_gene_expr_recon_loss: 20635762.6667; train_masked_gp_l1_reg_loss: 2747.3658; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9629853.8889; train_global_loss: 30772144.8889; train_optim_loss: 30772144.8889; val_kl_reg_loss: 102010.0703; val_edge_recon_loss: 398215.2500; val_gene_expr_recon_loss: 20799610.0000; val_masked_gp_l1_reg_loss: 2755.0012; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9657803.0000; val_global_loss: 30960396.0000; val_optim_loss: 30960396.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9273; val_auprc_score: 0.9131; val_best_acc_score: 0.8382; val_best_f1_score: 0.8322; train_kl_reg_loss: 105935.6970; train_edge_recon_loss: 395188.6111; train_gene_expr_recon_loss: 20510259.3333; train_masked_gp_l1_reg_loss: 2762.2174; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9549558.4444; train_global_loss: 30563704.4444; train_optim_loss: 30563704.4444; val_kl_reg_loss: 98705.7031; val_edge_recon_loss: 397294.9375; val_gene_expr_recon_loss: 20770282.0000; val_masked_gp_l1_reg_loss: 2769.8953; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9632670.0000; val_global_loss: 30901722.0000; val_optim_loss: 30901722.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9290; val_auprc_score: 0.9168; val_best_acc_score: 0.8398; val_best_f1_score: 0.8323; train_kl_reg_loss: 106497.9236; train_edge_recon_loss: 395665.3542; train_gene_expr_recon_loss: 21038136.6667; train_masked_gp_l1_reg_loss: 2778.2630; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650329.0000; train_global_loss: 31193407.1111; train_optim_loss: 31193407.1111; val_kl_reg_loss: 90991.9609; val_edge_recon_loss: 396829.4375; val_gene_expr_recon_loss: 21067802.0000; val_masked_gp_l1_reg_loss: 2788.2280; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9659210.0000; val_global_loss: 31217622.0000; val_optim_loss: 31217622.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9288; val_auprc_score: 0.9098; val_best_acc_score: 0.8380; val_best_f1_score: 0.8326; train_kl_reg_loss: 104330.0564; train_edge_recon_loss: 393887.3889; train_gene_expr_recon_loss: 20903817.7778; train_masked_gp_l1_reg_loss: 2796.6485; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591042.3333; train_global_loss: 30995874.2222; train_optim_loss: 30995874.2222; val_kl_reg_loss: 88832.7266; val_edge_recon_loss: 395997.9062; val_gene_expr_recon_loss: 21102412.0000; val_masked_gp_l1_reg_loss: 2806.8689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9641816.0000; val_global_loss: 31231864.0000; val_optim_loss: 31231864.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9312; val_auprc_score: 0.9210; val_best_acc_score: 0.8266; val_best_f1_score: 0.8393; train_kl_reg_loss: 101992.6198; train_edge_recon_loss: 392891.7743; train_gene_expr_recon_loss: 20947744.8889; train_masked_gp_l1_reg_loss: 2815.9594; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9637066.5556; train_global_loss: 31082511.7778; train_optim_loss: 31082511.7778; val_kl_reg_loss: 85316.6406; val_edge_recon_loss: 394931.5312; val_gene_expr_recon_loss: 21059634.0000; val_masked_gp_l1_reg_loss: 2825.9761; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9629590.0000; val_global_loss: 31172298.0000; val_optim_loss: 31172298.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9347; val_auprc_score: 0.9224; val_best_acc_score: 0.8259; val_best_f1_score: 0.8487; train_kl_reg_loss: 99529.2127; train_edge_recon_loss: 391817.0625; train_gene_expr_recon_loss: 20882620.6667; train_masked_gp_l1_reg_loss: 2833.9493; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9643658.7778; train_global_loss: 31020459.5556; train_optim_loss: 31020459.5556; val_kl_reg_loss: 85147.9531; val_edge_recon_loss: 393591.6562; val_gene_expr_recon_loss: 21048710.0000; val_masked_gp_l1_reg_loss: 2842.3970; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9633119.0000; val_global_loss: 31163412.0000; val_optim_loss: 31163412.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9318; val_auprc_score: 0.9194; val_best_acc_score: 0.8242; val_best_f1_score: 0.8476; train_kl_reg_loss: 95686.1233; train_edge_recon_loss: 391483.2188; train_gene_expr_recon_loss: 20818930.2222; train_masked_gp_l1_reg_loss: 2843.0797; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9559713.4444; train_global_loss: 30868657.1111; train_optim_loss: 30868657.1111; val_kl_reg_loss: 88658.4062; val_edge_recon_loss: 393898.3438; val_gene_expr_recon_loss: 21023198.0000; val_masked_gp_l1_reg_loss: 2843.9116; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9629807.0000; val_global_loss: 31138404.0000; val_optim_loss: 31138404.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9293; val_auprc_score: 0.9157; val_best_acc_score: 0.8223; val_best_f1_score: 0.8434; train_kl_reg_loss: 100007.7231; train_edge_recon_loss: 391311.3194; train_gene_expr_recon_loss: 20791067.5556; train_masked_gp_l1_reg_loss: 2844.3412; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9593428.0000; train_global_loss: 30878658.6667; train_optim_loss: 30878658.6667; val_kl_reg_loss: 90382.7500; val_edge_recon_loss: 394207.0312; val_gene_expr_recon_loss: 21030446.0000; val_masked_gp_l1_reg_loss: 2844.7227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9631611.0000; val_global_loss: 31149492.0000; val_optim_loss: 31149492.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9317; val_auprc_score: 0.9210; val_best_acc_score: 0.8215; val_best_f1_score: 0.8398; train_kl_reg_loss: 99190.1285; train_edge_recon_loss: 391214.7326; train_gene_expr_recon_loss: 20945614.6667; train_masked_gp_l1_reg_loss: 2844.8635; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628305.0000; train_global_loss: 31067168.8889; train_optim_loss: 31067168.8889; val_kl_reg_loss: 87910.9531; val_edge_recon_loss: 394063.4688; val_gene_expr_recon_loss: 21002088.0000; val_masked_gp_l1_reg_loss: 2845.1016; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9617247.0000; val_global_loss: 31104156.0000; val_optim_loss: 31104156.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9346; val_auprc_score: 0.9222; val_best_acc_score: 0.8238; val_best_f1_score: 0.8450; train_kl_reg_loss: 97630.1589; train_edge_recon_loss: 390816.2708; train_gene_expr_recon_loss: 20975342.0000; train_masked_gp_l1_reg_loss: 2845.4067; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9610373.3333; train_global_loss: 31077007.7778; train_optim_loss: 31077007.7778; val_kl_reg_loss: 88481.3281; val_edge_recon_loss: 393607.2188; val_gene_expr_recon_loss: 21013816.0000; val_masked_gp_l1_reg_loss: 2845.8857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9625219.0000; val_global_loss: 31123968.0000; val_optim_loss: 31123968.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9266
Val AUPRC score: 0.9093
Val best accuracy score: 0.8448
Val best F1 score: 0.8400
Val gene expr MSE score: 0.5116
Val chrom access MSE score: 0.0874
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
