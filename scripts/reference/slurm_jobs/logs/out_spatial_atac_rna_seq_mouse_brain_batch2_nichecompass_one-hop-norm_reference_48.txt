[True]
Run timestamp: 07082023_184836_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9027; val_auprc_score: 0.9149; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14018.3914; train_edge_recon_loss: 35821.8138; train_gene_expr_recon_loss: 1171941.4653; train_masked_gp_l1_reg_loss: 4640.7186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166811.2969; train_chrom_access_recon_loss: 720570.5868; train_global_loss: 2113804.2500; train_optim_loss: 2113804.2500; val_kl_reg_loss: 7075.0371; val_edge_recon_loss: 40657.7539; val_gene_expr_recon_loss: 963261.3750; val_masked_gp_l1_reg_loss: 4273.3701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161922.1562; val_chrom_access_recon_loss: 502928.9688; val_global_loss: 1680118.7500; val_optim_loss: 1680118.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9012; val_auprc_score: 0.9112; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8813.8499; train_edge_recon_loss: 37100.0109; train_gene_expr_recon_loss: 898397.3472; train_masked_gp_l1_reg_loss: 4246.6919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158914.1042; train_chrom_access_recon_loss: 487909.1146; train_global_loss: 1595381.1389; train_optim_loss: 1595381.1389; val_kl_reg_loss: 12788.1152; val_edge_recon_loss: 40659.7305; val_gene_expr_recon_loss: 824759.5000; val_masked_gp_l1_reg_loss: 4281.9458; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155144.4688; val_chrom_access_recon_loss: 467952.7812; val_global_loss: 1505586.5000; val_optim_loss: 1505586.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8906; val_auprc_score: 0.9029; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 16133.4988; train_edge_recon_loss: 38333.4288; train_gene_expr_recon_loss: 795927.0764; train_masked_gp_l1_reg_loss: 4364.3337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151752.5295; train_chrom_access_recon_loss: 467328.0451; train_global_loss: 1473838.9167; train_optim_loss: 1473838.9167; val_kl_reg_loss: 15973.6680; val_edge_recon_loss: 40658.7383; val_gene_expr_recon_loss: 768366.3750; val_masked_gp_l1_reg_loss: 4452.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147188.6562; val_chrom_access_recon_loss: 454127.2500; val_global_loss: 1430766.8750; val_optim_loss: 1430766.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8864; val_auprc_score: 0.9010; val_best_acc_score: 0.5047; val_best_f1_score: 0.6688; train_kl_reg_loss: 18037.5195; train_edge_recon_loss: 38615.5833; train_gene_expr_recon_loss: 755769.2292; train_masked_gp_l1_reg_loss: 4483.7383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143181.1632; train_chrom_access_recon_loss: 456338.6632; train_global_loss: 1416425.8750; train_optim_loss: 1416425.8750; val_kl_reg_loss: 20329.1484; val_edge_recon_loss: 40656.9062; val_gene_expr_recon_loss: 734952.2500; val_masked_gp_l1_reg_loss: 4495.5762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138027.6406; val_chrom_access_recon_loss: 448789.2500; val_global_loss: 1387250.7500; val_optim_loss: 1387250.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8768; val_auprc_score: 0.8946; val_best_acc_score: 0.5177; val_best_f1_score: 0.6744; train_kl_reg_loss: 20391.2446; train_edge_recon_loss: 38832.5694; train_gene_expr_recon_loss: 726468.1389; train_masked_gp_l1_reg_loss: 4464.2560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133720.3681; train_chrom_access_recon_loss: 452677.0069; train_global_loss: 1376553.5833; train_optim_loss: 1376553.5833; val_kl_reg_loss: 18536.5508; val_edge_recon_loss: 40650.4727; val_gene_expr_recon_loss: 718177.1250; val_masked_gp_l1_reg_loss: 4416.3286; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128289.7031; val_chrom_access_recon_loss: 445096.5000; val_global_loss: 1355166.6250; val_optim_loss: 1355166.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8689; val_auprc_score: 0.8805; val_best_acc_score: 0.5159; val_best_f1_score: 0.6732; train_kl_reg_loss: 20074.1539; train_edge_recon_loss: 38784.2956; train_gene_expr_recon_loss: 713936.0833; train_masked_gp_l1_reg_loss: 4392.3345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123960.8333; train_chrom_access_recon_loss: 449496.0938; train_global_loss: 1350643.7639; train_optim_loss: 1350643.7639; val_kl_reg_loss: 20229.3359; val_edge_recon_loss: 40648.7812; val_gene_expr_recon_loss: 703162.4375; val_masked_gp_l1_reg_loss: 4354.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118576.1328; val_chrom_access_recon_loss: 442603.6562; val_global_loss: 1329575.0000; val_optim_loss: 1329575.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8731; val_auprc_score: 0.8825; val_best_acc_score: 0.5187; val_best_f1_score: 0.6738; train_kl_reg_loss: 20025.0961; train_edge_recon_loss: 38825.1363; train_gene_expr_recon_loss: 696538.6111; train_masked_gp_l1_reg_loss: 4323.0095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114347.2240; train_chrom_access_recon_loss: 445746.9722; train_global_loss: 1319806.0833; train_optim_loss: 1319806.0833; val_kl_reg_loss: 19588.6992; val_edge_recon_loss: 40640.6289; val_gene_expr_recon_loss: 693366.5000; val_masked_gp_l1_reg_loss: 4287.7388; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109145.5312; val_chrom_access_recon_loss: 440700.5938; val_global_loss: 1307729.7500; val_optim_loss: 1307729.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8805; val_auprc_score: 0.8908; val_best_acc_score: 0.5276; val_best_f1_score: 0.6766; train_kl_reg_loss: 20247.6115; train_edge_recon_loss: 38814.8364; train_gene_expr_recon_loss: 689323.8125; train_masked_gp_l1_reg_loss: 4264.8962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105136.7005; train_chrom_access_recon_loss: 446329.9444; train_global_loss: 1304117.8194; train_optim_loss: 1304117.8194; val_kl_reg_loss: 19186.6680; val_edge_recon_loss: 40627.0820; val_gene_expr_recon_loss: 685049.6250; val_masked_gp_l1_reg_loss: 4232.3921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100219.2656; val_chrom_access_recon_loss: 439129.1875; val_global_loss: 1288444.2500; val_optim_loss: 1288444.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8774; val_auprc_score: 0.8883; val_best_acc_score: 0.5341; val_best_f1_score: 0.6790; train_kl_reg_loss: 19961.8759; train_edge_recon_loss: 38811.7387; train_gene_expr_recon_loss: 680806.3681; train_masked_gp_l1_reg_loss: 4217.4769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96476.3099; train_chrom_access_recon_loss: 444264.9757; train_global_loss: 1284538.7361; train_optim_loss: 1284538.7361; val_kl_reg_loss: 19672.0000; val_edge_recon_loss: 40616.1758; val_gene_expr_recon_loss: 677438.0000; val_masked_gp_l1_reg_loss: 4195.9580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91916.5312; val_chrom_access_recon_loss: 437690.4688; val_global_loss: 1271529.1250; val_optim_loss: 1271529.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8799; val_auprc_score: 0.8830; val_best_acc_score: 0.5593; val_best_f1_score: 0.6903; train_kl_reg_loss: 20158.6395; train_edge_recon_loss: 38864.8251; train_gene_expr_recon_loss: 672384.1667; train_masked_gp_l1_reg_loss: 4183.6364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88482.5460; train_chrom_access_recon_loss: 443309.0938; train_global_loss: 1267382.8889; train_optim_loss: 1267382.8889; val_kl_reg_loss: 20046.4961; val_edge_recon_loss: 40600.2344; val_gene_expr_recon_loss: 671949.6250; val_masked_gp_l1_reg_loss: 4165.2612; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84323.3672; val_chrom_access_recon_loss: 436333.8438; val_global_loss: 1257418.8750; val_optim_loss: 1257418.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8831; val_auprc_score: 0.8833; val_best_acc_score: 0.5908; val_best_f1_score: 0.7048; train_kl_reg_loss: 20086.2504; train_edge_recon_loss: 38867.7309; train_gene_expr_recon_loss: 665242.1528; train_masked_gp_l1_reg_loss: 4154.2467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81221.8594; train_chrom_access_recon_loss: 439686.3507; train_global_loss: 1249258.5833; train_optim_loss: 1249258.5833; val_kl_reg_loss: 19134.5254; val_edge_recon_loss: 40582.5508; val_gene_expr_recon_loss: 668383.7500; val_masked_gp_l1_reg_loss: 4137.6494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77479.6953; val_chrom_access_recon_loss: 435097.9375; val_global_loss: 1244816.0000; val_optim_loss: 1244816.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8929; val_auprc_score: 0.8909; val_best_acc_score: 0.6378; val_best_f1_score: 0.7288; train_kl_reg_loss: 19938.1352; train_edge_recon_loss: 38849.0312; train_gene_expr_recon_loss: 665095.3056; train_masked_gp_l1_reg_loss: 4127.7744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74723.3889; train_chrom_access_recon_loss: 440921.3090; train_global_loss: 1243654.9583; train_optim_loss: 1243654.9583; val_kl_reg_loss: 18569.0527; val_edge_recon_loss: 40558.1367; val_gene_expr_recon_loss: 665634.1875; val_masked_gp_l1_reg_loss: 4113.3862; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71392.5859; val_chrom_access_recon_loss: 434180.4062; val_global_loss: 1234447.7500; val_optim_loss: 1234447.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8984; val_auprc_score: 0.8911; val_best_acc_score: 0.6897; val_best_f1_score: 0.7569; train_kl_reg_loss: 19746.7363; train_edge_recon_loss: 38836.5547; train_gene_expr_recon_loss: 661275.7569; train_masked_gp_l1_reg_loss: 4111.5025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68941.4384; train_chrom_access_recon_loss: 438382.6840; train_global_loss: 1231294.6806; train_optim_loss: 1231294.6806; val_kl_reg_loss: 18220.9062; val_edge_recon_loss: 40531.3281; val_gene_expr_recon_loss: 663112.6250; val_masked_gp_l1_reg_loss: 4103.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65983.7500; val_chrom_access_recon_loss: 433237.7500; val_global_loss: 1225189.8750; val_optim_loss: 1225189.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9136; val_auprc_score: 0.9084; val_best_acc_score: 0.7501; val_best_f1_score: 0.7935; train_kl_reg_loss: 19571.7921; train_edge_recon_loss: 38812.9488; train_gene_expr_recon_loss: 656527.7153; train_masked_gp_l1_reg_loss: 4102.2803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63803.7817; train_chrom_access_recon_loss: 435322.3160; train_global_loss: 1218140.8472; train_optim_loss: 1218140.8472; val_kl_reg_loss: 18666.1523; val_edge_recon_loss: 40500.9102; val_gene_expr_recon_loss: 659242.5000; val_masked_gp_l1_reg_loss: 4092.7085; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61158.4375; val_chrom_access_recon_loss: 432164.2500; val_global_loss: 1215825.0000; val_optim_loss: 1215825.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9181; val_auprc_score: 0.9139; val_best_acc_score: 0.7870; val_best_f1_score: 0.8173; train_kl_reg_loss: 19339.2207; train_edge_recon_loss: 38778.9718; train_gene_expr_recon_loss: 657080.8611; train_masked_gp_l1_reg_loss: 4089.3701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59194.2591; train_chrom_access_recon_loss: 436400.3542; train_global_loss: 1214883.0278; train_optim_loss: 1214883.0278; val_kl_reg_loss: 18625.0078; val_edge_recon_loss: 40446.2930; val_gene_expr_recon_loss: 656722.3750; val_masked_gp_l1_reg_loss: 4083.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56815.8281; val_chrom_access_recon_loss: 431154.1875; val_global_loss: 1207846.8750; val_optim_loss: 1207846.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9170; val_auprc_score: 0.9041; val_best_acc_score: 0.8182; val_best_f1_score: 0.8385; train_kl_reg_loss: 19187.3021; train_edge_recon_loss: 38752.4401; train_gene_expr_recon_loss: 649605.8403; train_masked_gp_l1_reg_loss: 4086.4096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55051.1102; train_chrom_access_recon_loss: 434821.7083; train_global_loss: 1201504.8056; train_optim_loss: 1201504.8056; val_kl_reg_loss: 18912.5664; val_edge_recon_loss: 40416.7070; val_gene_expr_recon_loss: 654477.0000; val_masked_gp_l1_reg_loss: 4083.3306; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52911.0938; val_chrom_access_recon_loss: 430269.6250; val_global_loss: 1201070.2500; val_optim_loss: 1201070.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9189; val_auprc_score: 0.9087; val_best_acc_score: 0.8317; val_best_f1_score: 0.8467; train_kl_reg_loss: 18989.3791; train_edge_recon_loss: 38703.3733; train_gene_expr_recon_loss: 652021.4861; train_masked_gp_l1_reg_loss: 4085.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51313.9948; train_chrom_access_recon_loss: 435118.1007; train_global_loss: 1200231.6944; train_optim_loss: 1200231.6944; val_kl_reg_loss: 18276.1055; val_edge_recon_loss: 40354.1367; val_gene_expr_recon_loss: 652895.3125; val_masked_gp_l1_reg_loss: 4082.9001; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49379.8633; val_chrom_access_recon_loss: 429422.8125; val_global_loss: 1194411.1250; val_optim_loss: 1194411.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9241; val_auprc_score: 0.9146; val_best_acc_score: 0.8504; val_best_f1_score: 0.8592; train_kl_reg_loss: 18733.4293; train_edge_recon_loss: 38656.3008; train_gene_expr_recon_loss: 647474.8542; train_masked_gp_l1_reg_loss: 4088.7466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47939.2318; train_chrom_access_recon_loss: 432857.3819; train_global_loss: 1189749.9306; train_optim_loss: 1189749.9306; val_kl_reg_loss: 17711.7422; val_edge_recon_loss: 40289.7148; val_gene_expr_recon_loss: 651639.1250; val_masked_gp_l1_reg_loss: 4086.3447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46183.2891; val_chrom_access_recon_loss: 428677.2500; val_global_loss: 1188587.5000; val_optim_loss: 1188587.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9255; val_auprc_score: 0.9190; val_best_acc_score: 0.8486; val_best_f1_score: 0.8551; train_kl_reg_loss: 18454.4091; train_edge_recon_loss: 38589.7617; train_gene_expr_recon_loss: 647860.5486; train_masked_gp_l1_reg_loss: 4090.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44875.8963; train_chrom_access_recon_loss: 432027.3958; train_global_loss: 1185898.5694; train_optim_loss: 1185898.5694; val_kl_reg_loss: 17575.8164; val_edge_recon_loss: 40236.1445; val_gene_expr_recon_loss: 649929.8750; val_masked_gp_l1_reg_loss: 4088.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43277.9883; val_chrom_access_recon_loss: 427829.3125; val_global_loss: 1182937.7500; val_optim_loss: 1182937.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9254; val_auprc_score: 0.9158; val_best_acc_score: 0.8546; val_best_f1_score: 0.8580; train_kl_reg_loss: 18296.4462; train_edge_recon_loss: 38542.1576; train_gene_expr_recon_loss: 646722.1181; train_masked_gp_l1_reg_loss: 4092.2202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42093.3464; train_chrom_access_recon_loss: 433694.9549; train_global_loss: 1183441.2361; train_optim_loss: 1183441.2361; val_kl_reg_loss: 17054.4375; val_edge_recon_loss: 40150.2812; val_gene_expr_recon_loss: 648921.3750; val_masked_gp_l1_reg_loss: 4090.8682; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40639.4141; val_chrom_access_recon_loss: 427245.8438; val_global_loss: 1178102.2500; val_optim_loss: 1178102.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9304; val_auprc_score: 0.9186; val_best_acc_score: 0.8616; val_best_f1_score: 0.8625; train_kl_reg_loss: 17991.6571; train_edge_recon_loss: 38457.7483; train_gene_expr_recon_loss: 646845.8889; train_masked_gp_l1_reg_loss: 4096.3006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39557.8229; train_chrom_access_recon_loss: 431481.1250; train_global_loss: 1178430.5139; train_optim_loss: 1178430.5139; val_kl_reg_loss: 17613.8301; val_edge_recon_loss: 40083.8984; val_gene_expr_recon_loss: 646587.1250; val_masked_gp_l1_reg_loss: 4097.1201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38225.5820; val_chrom_access_recon_loss: 426481.7812; val_global_loss: 1173089.3750; val_optim_loss: 1173089.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9327; val_auprc_score: 0.9233; val_best_acc_score: 0.8579; val_best_f1_score: 0.8557; train_kl_reg_loss: 17917.7148; train_edge_recon_loss: 38412.6714; train_gene_expr_recon_loss: 647442.7222; train_masked_gp_l1_reg_loss: 4101.0360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37229.8559; train_chrom_access_recon_loss: 432269.6528; train_global_loss: 1177373.6389; train_optim_loss: 1177373.6389; val_kl_reg_loss: 16487.7227; val_edge_recon_loss: 40008.6328; val_gene_expr_recon_loss: 646487.7500; val_masked_gp_l1_reg_loss: 4101.0576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36010.5859; val_chrom_access_recon_loss: 425823.4375; val_global_loss: 1168919.2500; val_optim_loss: 1168919.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9367; val_auprc_score: 0.9317; val_best_acc_score: 0.8575; val_best_f1_score: 0.8540; train_kl_reg_loss: 17563.9939; train_edge_recon_loss: 38330.2873; train_gene_expr_recon_loss: 642663.4514; train_masked_gp_l1_reg_loss: 4111.0957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35100.8273; train_chrom_access_recon_loss: 430359.6979; train_global_loss: 1168129.3472; train_optim_loss: 1168129.3472; val_kl_reg_loss: 16681.2969; val_edge_recon_loss: 39939.8125; val_gene_expr_recon_loss: 644665.1250; val_masked_gp_l1_reg_loss: 4113.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33985.2344; val_chrom_access_recon_loss: 424903.2188; val_global_loss: 1164288.6250; val_optim_loss: 1164288.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9423; val_auprc_score: 0.9352; val_best_acc_score: 0.8636; val_best_f1_score: 0.8575; train_kl_reg_loss: 17400.6497; train_edge_recon_loss: 38269.3108; train_gene_expr_recon_loss: 642308.0903; train_masked_gp_l1_reg_loss: 4120.6878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33149.1159; train_chrom_access_recon_loss: 429370.7604; train_global_loss: 1164618.6250; train_optim_loss: 1164618.6250; val_kl_reg_loss: 16463.6914; val_edge_recon_loss: 39855.3008; val_gene_expr_recon_loss: 643323.1250; val_masked_gp_l1_reg_loss: 4122.5698; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32120.3535; val_chrom_access_recon_loss: 424239.1250; val_global_loss: 1160124.2500; val_optim_loss: 1160124.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9411; val_auprc_score: 0.9295; val_best_acc_score: 0.8561; val_best_f1_score: 0.8481; train_kl_reg_loss: 17197.9740; train_edge_recon_loss: 38188.6076; train_gene_expr_recon_loss: 642643.3681; train_masked_gp_l1_reg_loss: 4131.4010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31349.2776; train_chrom_access_recon_loss: 429789.7535; train_global_loss: 1163300.3611; train_optim_loss: 1163300.3611; val_kl_reg_loss: 16510.0742; val_edge_recon_loss: 39778.7500; val_gene_expr_recon_loss: 641891.0000; val_masked_gp_l1_reg_loss: 4135.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30400.8496; val_chrom_access_recon_loss: 423553.6562; val_global_loss: 1156269.8750; val_optim_loss: 1156269.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9410; val_auprc_score: 0.9321; val_best_acc_score: 0.8631; val_best_f1_score: 0.8727; train_kl_reg_loss: 14646.7070; train_edge_recon_loss: 39929.6593; train_gene_expr_recon_loss: 940745.1458; train_masked_gp_l1_reg_loss: 4198.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29557.0866; train_chrom_access_recon_loss: 454733.1007; train_global_loss: 1483810.0833; train_optim_loss: 1483810.0833; val_kl_reg_loss: 12168.3809; val_edge_recon_loss: 40331.3516; val_gene_expr_recon_loss: 935097.6250; val_masked_gp_l1_reg_loss: 4310.9722; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28403.4727; val_chrom_access_recon_loss: 448552.7812; val_global_loss: 1468864.6250; val_optim_loss: 1468864.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9381; val_auprc_score: 0.9252; val_best_acc_score: 0.8647; val_best_f1_score: 0.8738; train_kl_reg_loss: 13183.0489; train_edge_recon_loss: 40040.4466; train_gene_expr_recon_loss: 932839.5417; train_masked_gp_l1_reg_loss: 4403.4252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27455.7281; train_chrom_access_recon_loss: 453597.7292; train_global_loss: 1471519.9167; train_optim_loss: 1471519.9167; val_kl_reg_loss: 11200.5801; val_edge_recon_loss: 40340.6992; val_gene_expr_recon_loss: 928716.1250; val_masked_gp_l1_reg_loss: 4510.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26292.2090; val_chrom_access_recon_loss: 447765.8125; val_global_loss: 1458826.0000; val_optim_loss: 1458826.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9431; val_auprc_score: 0.9349; val_best_acc_score: 0.8673; val_best_f1_score: 0.8756; train_kl_reg_loss: 12729.8720; train_edge_recon_loss: 40065.6037; train_gene_expr_recon_loss: 924713.2014; train_masked_gp_l1_reg_loss: 4575.6752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25412.0399; train_chrom_access_recon_loss: 452506.4722; train_global_loss: 1460002.8611; train_optim_loss: 1460002.8611; val_kl_reg_loss: 10919.7383; val_edge_recon_loss: 40331.6719; val_gene_expr_recon_loss: 923615.3750; val_masked_gp_l1_reg_loss: 4641.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24343.0742; val_chrom_access_recon_loss: 447178.2812; val_global_loss: 1451029.7500; val_optim_loss: 1451029.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9416; val_auprc_score: 0.9318; val_best_acc_score: 0.8720; val_best_f1_score: 0.8784; train_kl_reg_loss: 12318.2562; train_edge_recon_loss: 40052.8064; train_gene_expr_recon_loss: 916784.2847; train_masked_gp_l1_reg_loss: 4681.0991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23547.2409; train_chrom_access_recon_loss: 450336.9861; train_global_loss: 1447720.6667; train_optim_loss: 1447720.6667; val_kl_reg_loss: 10913.6016; val_edge_recon_loss: 40291.3008; val_gene_expr_recon_loss: 919219.0000; val_masked_gp_l1_reg_loss: 4720.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22590.1758; val_chrom_access_recon_loss: 446568.2500; val_global_loss: 1444303.2500; val_optim_loss: 1444303.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9474; val_auprc_score: 0.9356; val_best_acc_score: 0.8826; val_best_f1_score: 0.8875; train_kl_reg_loss: 12158.4903; train_edge_recon_loss: 40021.0339; train_gene_expr_recon_loss: 920839.8958; train_masked_gp_l1_reg_loss: 4709.9156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22423.8177; train_chrom_access_recon_loss: 452961.4757; train_global_loss: 1453114.6111; train_optim_loss: 1453114.6111; val_kl_reg_loss: 11326.1670; val_edge_recon_loss: 40284.6094; val_gene_expr_recon_loss: 918292.8750; val_masked_gp_l1_reg_loss: 4700.4331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22244.0449; val_chrom_access_recon_loss: 446426.9062; val_global_loss: 1443275.0000; val_optim_loss: 1443275.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9474; val_auprc_score: 0.9385; val_best_acc_score: 0.8778; val_best_f1_score: 0.8833; train_kl_reg_loss: 12486.4375; train_edge_recon_loss: 40027.1931; train_gene_expr_recon_loss: 917041.0764; train_masked_gp_l1_reg_loss: 4699.0223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22143.0660; train_chrom_access_recon_loss: 449562.9965; train_global_loss: 1445959.7917; train_optim_loss: 1445959.7917; val_kl_reg_loss: 11380.8545; val_edge_recon_loss: 40279.9297; val_gene_expr_recon_loss: 917872.1250; val_masked_gp_l1_reg_loss: 4695.7842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22010.4531; val_chrom_access_recon_loss: 446364.4375; val_global_loss: 1442603.6250; val_optim_loss: 1442603.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9493; val_auprc_score: 0.9398; val_best_acc_score: 0.8814; val_best_f1_score: 0.8861; train_kl_reg_loss: 12346.4621; train_edge_recon_loss: 40015.0911; train_gene_expr_recon_loss: 916295.1667; train_masked_gp_l1_reg_loss: 4694.1214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21915.7750; train_chrom_access_recon_loss: 450913.9062; train_global_loss: 1446180.5417; train_optim_loss: 1446180.5417; val_kl_reg_loss: 11219.6455; val_edge_recon_loss: 40269.3398; val_gene_expr_recon_loss: 917698.3125; val_masked_gp_l1_reg_loss: 4692.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21800.4980; val_chrom_access_recon_loss: 446364.0625; val_global_loss: 1442044.2500; val_optim_loss: 1442044.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9463; val_auprc_score: 0.9360; val_best_acc_score: 0.8748; val_best_f1_score: 0.8803; train_kl_reg_loss: 12295.4061; train_edge_recon_loss: 40011.7500; train_gene_expr_recon_loss: 914005.2708; train_masked_gp_l1_reg_loss: 4691.6156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21713.3255; train_chrom_access_recon_loss: 450506.7292; train_global_loss: 1443224.0833; train_optim_loss: 1443224.0833; val_kl_reg_loss: 11279.3438; val_edge_recon_loss: 40263.6992; val_gene_expr_recon_loss: 917281.8750; val_masked_gp_l1_reg_loss: 4691.1909; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21609.2500; val_chrom_access_recon_loss: 446267.8750; val_global_loss: 1441393.2500; val_optim_loss: 1441393.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9468
val AUPRC score: 0.9403
val best accuracy score: 0.8777
val best F1 score: 0.8833
val target rna MSE score: 4.0276
val source rna MSE score: 3.1852
val target atac MSE score: 0.1348
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
