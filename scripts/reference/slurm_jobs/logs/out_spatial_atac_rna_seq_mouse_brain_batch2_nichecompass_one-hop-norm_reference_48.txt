[True]
Run timestamp: 07092023_162649_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6387; val_auprc_score: 0.6450; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 62896.7916; train_edge_recon_loss: 3575992.6553; train_gene_expr_recon_loss: 17007039.9242; train_masked_gp_l1_reg_loss: 178350.3435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10105225.0909; train_chrom_access_recon_loss: 14978254.8788; train_global_loss: 45907759.8182; train_optim_loss: 45907759.8182; val_kl_reg_loss: 154856.2227; val_edge_recon_loss: 4065552.0625; val_gene_expr_recon_loss: 15552077.8750; val_masked_gp_l1_reg_loss: 161372.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3757592.7500; val_chrom_access_recon_loss: 14606417.7500; val_global_loss: 38297868.5000; val_optim_loss: 38297868.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6892; val_auprc_score: 0.6796; val_best_acc_score: 0.5443; val_best_f1_score: 0.6812; train_kl_reg_loss: 125823.9348; train_edge_recon_loss: 3557728.3144; train_gene_expr_recon_loss: 15047261.3485; train_masked_gp_l1_reg_loss: 151461.1203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1456667.9896; train_chrom_access_recon_loss: 14207678.7424; train_global_loss: 34546621.5455; train_optim_loss: 34546621.5455; val_kl_reg_loss: 134310.8438; val_edge_recon_loss: 4062397.1875; val_gene_expr_recon_loss: 14767062.5000; val_masked_gp_l1_reg_loss: 144350.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 530012.3750; val_chrom_access_recon_loss: 14119588.6250; val_global_loss: 33757721.5000; val_optim_loss: 33757721.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7635; val_auprc_score: 0.7539; val_best_acc_score: 0.6513; val_best_f1_score: 0.7232; train_kl_reg_loss: 132238.3582; train_edge_recon_loss: 3541028.9356; train_gene_expr_recon_loss: 14689679.7121; train_masked_gp_l1_reg_loss: 142936.3736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 370683.6378; train_chrom_access_recon_loss: 14054554.1970; train_global_loss: 32931121.0606; train_optim_loss: 32931121.0606; val_kl_reg_loss: 125367.2354; val_edge_recon_loss: 4055456.5312; val_gene_expr_recon_loss: 14713951.1250; val_masked_gp_l1_reg_loss: 142781.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 273393.9375; val_chrom_access_recon_loss: 14357060.1250; val_global_loss: 33668011.5000; val_optim_loss: 33668011.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7951; val_auprc_score: 0.7730; val_best_acc_score: 0.7166; val_best_f1_score: 0.7121; train_kl_reg_loss: 122282.9279; train_edge_recon_loss: 3531249.3977; train_gene_expr_recon_loss: 14544636.8333; train_masked_gp_l1_reg_loss: 144172.5036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235347.4789; train_chrom_access_recon_loss: 13946747.1818; train_global_loss: 32524436.3636; train_optim_loss: 32524436.3636; val_kl_reg_loss: 124322.9824; val_edge_recon_loss: 4021390.2500; val_gene_expr_recon_loss: 14459440.1250; val_masked_gp_l1_reg_loss: 145848.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 207318.1562; val_chrom_access_recon_loss: 14046630.8750; val_global_loss: 33004950.2500; val_optim_loss: 33004950.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8329; val_auprc_score: 0.8104; val_best_acc_score: 0.7550; val_best_f1_score: 0.7770; train_kl_reg_loss: 107807.5384; train_edge_recon_loss: 3499173.0682; train_gene_expr_recon_loss: 14450530.9848; train_masked_gp_l1_reg_loss: 148334.1974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 192633.7412; train_chrom_access_recon_loss: 13853627.7879; train_global_loss: 32252107.2424; train_optim_loss: 32252107.2424; val_kl_reg_loss: 106095.4688; val_edge_recon_loss: 3677037.6250; val_gene_expr_recon_loss: 14403310.0000; val_masked_gp_l1_reg_loss: 152301.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180153.5000; val_chrom_access_recon_loss: 13994964.1250; val_global_loss: 32513863.7500; val_optim_loss: 32513863.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8387; val_auprc_score: 0.8038; val_best_acc_score: 0.7590; val_best_f1_score: 0.7940; train_kl_reg_loss: 102822.7777; train_edge_recon_loss: 3241621.7992; train_gene_expr_recon_loss: 14414089.9697; train_masked_gp_l1_reg_loss: 159332.7902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171837.2917; train_chrom_access_recon_loss: 13783097.0000; train_global_loss: 31872801.6061; train_optim_loss: 31872801.6061; val_kl_reg_loss: 126094.6289; val_edge_recon_loss: 3050131.6250; val_gene_expr_recon_loss: 14430023.2500; val_masked_gp_l1_reg_loss: 166165.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164536.3750; val_chrom_access_recon_loss: 13997302.0000; val_global_loss: 31934253.7500; val_optim_loss: 31934253.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8533; val_auprc_score: 0.8179; val_best_acc_score: 0.7716; val_best_f1_score: 0.7983; train_kl_reg_loss: 134523.4401; train_edge_recon_loss: 3017262.2159; train_gene_expr_recon_loss: 14351707.7727; train_masked_gp_l1_reg_loss: 167952.1300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157877.6548; train_chrom_access_recon_loss: 13709985.8030; train_global_loss: 31539308.8485; train_optim_loss: 31539308.8485; val_kl_reg_loss: 136902.6484; val_edge_recon_loss: 3012583.1250; val_gene_expr_recon_loss: 14149640.6250; val_masked_gp_l1_reg_loss: 169719.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152679.2656; val_chrom_access_recon_loss: 13739838.2500; val_global_loss: 31361364.7500; val_optim_loss: 31361364.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8738; val_auprc_score: 0.8410; val_best_acc_score: 0.7988; val_best_f1_score: 0.8122; train_kl_reg_loss: 136824.2027; train_edge_recon_loss: 2962636.1174; train_gene_expr_recon_loss: 14266892.2879; train_masked_gp_l1_reg_loss: 170553.7578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149068.1790; train_chrom_access_recon_loss: 13637909.9545; train_global_loss: 31323884.4242; train_optim_loss: 31323884.4242; val_kl_reg_loss: 136428.1016; val_edge_recon_loss: 2941647.5000; val_gene_expr_recon_loss: 14424498.3750; val_masked_gp_l1_reg_loss: 172240.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145852.6250; val_chrom_access_recon_loss: 14012087.5000; val_global_loss: 31832753.7500; val_optim_loss: 31832753.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8800; val_auprc_score: 0.8471; val_best_acc_score: 0.8109; val_best_f1_score: 0.8279; train_kl_reg_loss: 133503.4116; train_edge_recon_loss: 2936593.0947; train_gene_expr_recon_loss: 14214465.8939; train_masked_gp_l1_reg_loss: 172898.4811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143095.6681; train_chrom_access_recon_loss: 13575412.3030; train_global_loss: 31175968.9091; train_optim_loss: 31175968.9091; val_kl_reg_loss: 133631.7012; val_edge_recon_loss: 2936965.4375; val_gene_expr_recon_loss: 14128676.0000; val_masked_gp_l1_reg_loss: 174171.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140770.8281; val_chrom_access_recon_loss: 13762357.6250; val_global_loss: 31276572.7500; val_optim_loss: 31276572.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8999; val_auprc_score: 0.8703; val_best_acc_score: 0.8310; val_best_f1_score: 0.8445; train_kl_reg_loss: 136970.6019; train_edge_recon_loss: 2907991.8750; train_gene_expr_recon_loss: 14144045.4242; train_masked_gp_l1_reg_loss: 175032.3561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138413.1596; train_chrom_access_recon_loss: 13510657.4545; train_global_loss: 31013110.8182; train_optim_loss: 31013110.8182; val_kl_reg_loss: 133485.6270; val_edge_recon_loss: 2872507.8438; val_gene_expr_recon_loss: 13970128.8750; val_masked_gp_l1_reg_loss: 176360.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137022.9531; val_chrom_access_recon_loss: 13600089.2500; val_global_loss: 30889594.0000; val_optim_loss: 30889594.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8986; val_auprc_score: 0.8660; val_best_acc_score: 0.8329; val_best_f1_score: 0.8468; train_kl_reg_loss: 134579.3989; train_edge_recon_loss: 2887054.5000; train_gene_expr_recon_loss: 14086813.6515; train_masked_gp_l1_reg_loss: 177143.2192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135595.0260; train_chrom_access_recon_loss: 13471109.0758; train_global_loss: 30892294.9091; train_optim_loss: 30892294.9091; val_kl_reg_loss: 134615.3184; val_edge_recon_loss: 2888842.1875; val_gene_expr_recon_loss: 13974526.5000; val_masked_gp_l1_reg_loss: 178304.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134391.9375; val_chrom_access_recon_loss: 13689911.6250; val_global_loss: 31000591.5000; val_optim_loss: 31000591.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9097; val_auprc_score: 0.8697; val_best_acc_score: 0.8517; val_best_f1_score: 0.8590; train_kl_reg_loss: 136769.5662; train_edge_recon_loss: 2841424.8523; train_gene_expr_recon_loss: 14022579.8182; train_masked_gp_l1_reg_loss: 178993.3532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133601.5286; train_chrom_access_recon_loss: 13404200.9697; train_global_loss: 30717570.0303; train_optim_loss: 30717570.0303; val_kl_reg_loss: 136887.3164; val_edge_recon_loss: 2858964.4062; val_gene_expr_recon_loss: 13912261.2500; val_masked_gp_l1_reg_loss: 180230.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133341.4062; val_chrom_access_recon_loss: 13554179.8750; val_global_loss: 30775864.7500; val_optim_loss: 30775864.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9018; val_auprc_score: 0.8731; val_best_acc_score: 0.8407; val_best_f1_score: 0.8498; train_kl_reg_loss: 139607.9189; train_edge_recon_loss: 2850078.9659; train_gene_expr_recon_loss: 13988118.3636; train_masked_gp_l1_reg_loss: 180497.6671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132312.1989; train_chrom_access_recon_loss: 13369395.5909; train_global_loss: 30660010.6970; train_optim_loss: 30660010.6970; val_kl_reg_loss: 137003.3945; val_edge_recon_loss: 2907538.9688; val_gene_expr_recon_loss: 14026499.2500; val_masked_gp_l1_reg_loss: 180811.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131740.5469; val_chrom_access_recon_loss: 13512423.2500; val_global_loss: 30896017.0000; val_optim_loss: 30896017.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9039; val_auprc_score: 0.8681; val_best_acc_score: 0.8485; val_best_f1_score: 0.8591; train_kl_reg_loss: 137551.3804; train_edge_recon_loss: 2833252.9924; train_gene_expr_recon_loss: 13924558.0758; train_masked_gp_l1_reg_loss: 181566.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130992.4951; train_chrom_access_recon_loss: 13313267.0606; train_global_loss: 30521189.0000; train_optim_loss: 30521189.0000; val_kl_reg_loss: 137496.8145; val_edge_recon_loss: 2899628.7812; val_gene_expr_recon_loss: 14051602.7500; val_masked_gp_l1_reg_loss: 182331.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130272.3984; val_chrom_access_recon_loss: 13632650.5000; val_global_loss: 31033982.2500; val_optim_loss: 31033982.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9242; val_auprc_score: 0.8964; val_best_acc_score: 0.8624; val_best_f1_score: 0.8683; train_kl_reg_loss: 136219.6178; train_edge_recon_loss: 2845307.4356; train_gene_expr_recon_loss: 13905955.7424; train_masked_gp_l1_reg_loss: 182905.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129730.9189; train_chrom_access_recon_loss: 13282074.4091; train_global_loss: 30482193.2424; train_optim_loss: 30482193.2424; val_kl_reg_loss: 139051.7812; val_edge_recon_loss: 2833605.8750; val_gene_expr_recon_loss: 13893639.1250; val_masked_gp_l1_reg_loss: 183688.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128769.1641; val_chrom_access_recon_loss: 13395155.1250; val_global_loss: 30573909.7500; val_optim_loss: 30573909.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9123; val_auprc_score: 0.8786; val_best_acc_score: 0.8568; val_best_f1_score: 0.8645; train_kl_reg_loss: 134880.7289; train_edge_recon_loss: 2827582.1174; train_gene_expr_recon_loss: 13859681.8030; train_masked_gp_l1_reg_loss: 184171.0021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128944.9349; train_chrom_access_recon_loss: 13236702.6212; train_global_loss: 30371963.2727; train_optim_loss: 30371963.2727; val_kl_reg_loss: 142302.8301; val_edge_recon_loss: 2843637.9688; val_gene_expr_recon_loss: 13813116.1250; val_masked_gp_l1_reg_loss: 184759.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128582.6719; val_chrom_access_recon_loss: 13439651.6250; val_global_loss: 30552050.7500; val_optim_loss: 30552050.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9180; val_auprc_score: 0.8917; val_best_acc_score: 0.8549; val_best_f1_score: 0.8646; train_kl_reg_loss: 135246.9497; train_edge_recon_loss: 2823901.0455; train_gene_expr_recon_loss: 13831236.0152; train_masked_gp_l1_reg_loss: 185235.2050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128390.3442; train_chrom_access_recon_loss: 13207324.0909; train_global_loss: 30311333.7273; train_optim_loss: 30311333.7273; val_kl_reg_loss: 140642.0566; val_edge_recon_loss: 2873108.5000; val_gene_expr_recon_loss: 13743877.6250; val_masked_gp_l1_reg_loss: 185767.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127964.7578; val_chrom_access_recon_loss: 13384221.7500; val_global_loss: 30455581.7500; val_optim_loss: 30455581.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9188; val_auprc_score: 0.8889; val_best_acc_score: 0.8622; val_best_f1_score: 0.8700; train_kl_reg_loss: 136529.8247; train_edge_recon_loss: 2812160.9053; train_gene_expr_recon_loss: 13792951.8182; train_masked_gp_l1_reg_loss: 185967.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127682.5447; train_chrom_access_recon_loss: 13155462.0909; train_global_loss: 30210754.7273; train_optim_loss: 30210754.7273; val_kl_reg_loss: 133078.5293; val_edge_recon_loss: 2841216.3125; val_gene_expr_recon_loss: 13636840.1250; val_masked_gp_l1_reg_loss: 186441.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127768.1562; val_chrom_access_recon_loss: 13247470.2500; val_global_loss: 30172814.5000; val_optim_loss: 30172814.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9184; val_auprc_score: 0.8912; val_best_acc_score: 0.8568; val_best_f1_score: 0.8673; train_kl_reg_loss: 134260.0262; train_edge_recon_loss: 2797472.1515; train_gene_expr_recon_loss: 13762390.6364; train_masked_gp_l1_reg_loss: 187047.3679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127454.0115; train_chrom_access_recon_loss: 13123115.1515; train_global_loss: 30131739.3939; train_optim_loss: 30131739.3939; val_kl_reg_loss: 132783.2910; val_edge_recon_loss: 2834411.0000; val_gene_expr_recon_loss: 13779728.5000; val_masked_gp_l1_reg_loss: 187354.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127341.5781; val_chrom_access_recon_loss: 13316374.1250; val_global_loss: 30377993.2500; val_optim_loss: 30377993.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9123; val_auprc_score: 0.8741; val_best_acc_score: 0.8549; val_best_f1_score: 0.8641; train_kl_reg_loss: 132208.1204; train_edge_recon_loss: 2802803.8030; train_gene_expr_recon_loss: 13729487.1667; train_masked_gp_l1_reg_loss: 187879.4875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127069.7665; train_chrom_access_recon_loss: 13090078.7727; train_global_loss: 30069527.0909; train_optim_loss: 30069527.0909; val_kl_reg_loss: 131978.6309; val_edge_recon_loss: 2844360.6562; val_gene_expr_recon_loss: 13503023.3750; val_masked_gp_l1_reg_loss: 188603.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127178.7969; val_chrom_access_recon_loss: 13146120.2500; val_global_loss: 29941265.5000; val_optim_loss: 29941265.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9199; val_auprc_score: 0.8948; val_best_acc_score: 0.8641; val_best_f1_score: 0.8738; train_kl_reg_loss: 133356.9163; train_edge_recon_loss: 2800093.1061; train_gene_expr_recon_loss: 13699287.1212; train_masked_gp_l1_reg_loss: 188566.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126651.2551; train_chrom_access_recon_loss: 13056213.2727; train_global_loss: 30004168.6364; train_optim_loss: 30004168.6364; val_kl_reg_loss: 134582.8604; val_edge_recon_loss: 2824878.2812; val_gene_expr_recon_loss: 13531170.7500; val_masked_gp_l1_reg_loss: 189295.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127017.5625; val_chrom_access_recon_loss: 13248357.0000; val_global_loss: 30055302.5000; val_optim_loss: 30055302.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9213; val_auprc_score: 0.8950; val_best_acc_score: 0.8606; val_best_f1_score: 0.8705; train_kl_reg_loss: 133748.6102; train_edge_recon_loss: 2785195.2955; train_gene_expr_recon_loss: 13673037.9242; train_masked_gp_l1_reg_loss: 189251.4107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126220.5662; train_chrom_access_recon_loss: 13025303.7576; train_global_loss: 29932757.4242; train_optim_loss: 29932757.4242; val_kl_reg_loss: 135954.0742; val_edge_recon_loss: 2825506.9062; val_gene_expr_recon_loss: 13674728.8750; val_masked_gp_l1_reg_loss: 189371.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126344.6641; val_chrom_access_recon_loss: 13291255.7500; val_global_loss: 30243161.2500; val_optim_loss: 30243161.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9326; val_auprc_score: 0.9119; val_best_acc_score: 0.8764; val_best_f1_score: 0.8822; train_kl_reg_loss: 133044.6463; train_edge_recon_loss: 2791166.7917; train_gene_expr_recon_loss: 13644937.1212; train_masked_gp_l1_reg_loss: 189941.7143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126175.6102; train_chrom_access_recon_loss: 12996809.2879; train_global_loss: 29882074.9697; train_optim_loss: 29882074.9697; val_kl_reg_loss: 131231.5098; val_edge_recon_loss: 2804224.4375; val_gene_expr_recon_loss: 13566021.7500; val_masked_gp_l1_reg_loss: 189859.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126103.5625; val_chrom_access_recon_loss: 13139036.7500; val_global_loss: 29956478.5000; val_optim_loss: 29956478.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9215; val_auprc_score: 0.8995; val_best_acc_score: 0.8600; val_best_f1_score: 0.8691; train_kl_reg_loss: 131369.5333; train_edge_recon_loss: 2796873.9318; train_gene_expr_recon_loss: 13621154.0000; train_masked_gp_l1_reg_loss: 190146.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125968.6830; train_chrom_access_recon_loss: 12964268.2273; train_global_loss: 29829780.7273; train_optim_loss: 29829780.7273; val_kl_reg_loss: 128027.4668; val_edge_recon_loss: 2828211.2188; val_gene_expr_recon_loss: 13757130.5000; val_masked_gp_l1_reg_loss: 190689.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125798.5391; val_chrom_access_recon_loss: 13172081.7500; val_global_loss: 30201939.7500; val_optim_loss: 30201939.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9275; val_auprc_score: 0.9044; val_best_acc_score: 0.8665; val_best_f1_score: 0.8766; train_kl_reg_loss: 130448.8587; train_edge_recon_loss: 2789612.4545; train_gene_expr_recon_loss: 13588105.7727; train_masked_gp_l1_reg_loss: 185746.1679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90764.5174; train_chrom_access_recon_loss: 12919591.3030; train_global_loss: 29704268.7879; train_optim_loss: 29704268.7879; val_kl_reg_loss: 134194.4395; val_edge_recon_loss: 2831318.1562; val_gene_expr_recon_loss: 13621657.6250; val_masked_gp_l1_reg_loss: 183787.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84403.0938; val_chrom_access_recon_loss: 13176264.0000; val_global_loss: 30031625.2500; val_optim_loss: 30031625.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9267; val_auprc_score: 0.8947; val_best_acc_score: 0.8718; val_best_f1_score: 0.8799; train_kl_reg_loss: 125860.5397; train_edge_recon_loss: 2888597.0379; train_gene_expr_recon_loss: 13294668.9394; train_masked_gp_l1_reg_loss: 183691.2936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87189.1043; train_chrom_access_recon_loss: 13058136.4545; train_global_loss: 29638143.2424; train_optim_loss: 29638143.2424; val_kl_reg_loss: 70317.5166; val_edge_recon_loss: 2875231.1562; val_gene_expr_recon_loss: 13117418.8750; val_masked_gp_l1_reg_loss: 183355.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90111.1250; val_chrom_access_recon_loss: 12788254.0000; val_global_loss: 29124688.2500; val_optim_loss: 29124688.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9242; val_auprc_score: 0.8925; val_best_acc_score: 0.8705; val_best_f1_score: 0.8770; train_kl_reg_loss: 141056.3075; train_edge_recon_loss: 2867379.7311; train_gene_expr_recon_loss: 13213818.6970; train_masked_gp_l1_reg_loss: 183144.1551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90063.8161; train_chrom_access_recon_loss: 12676703.0606; train_global_loss: 29172165.6667; train_optim_loss: 29172165.6667; val_kl_reg_loss: 77013.0811; val_edge_recon_loss: 2908680.1875; val_gene_expr_recon_loss: 13300950.2500; val_masked_gp_l1_reg_loss: 182968.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89665.7891; val_chrom_access_recon_loss: 12873533.5000; val_global_loss: 29432811.0000; val_optim_loss: 29432811.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9232; val_auprc_score: 0.8939; val_best_acc_score: 0.8684; val_best_f1_score: 0.8782; train_kl_reg_loss: 145972.4983; train_edge_recon_loss: 2851419.3144; train_gene_expr_recon_loss: 13204987.3788; train_masked_gp_l1_reg_loss: 182868.5201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89176.2421; train_chrom_access_recon_loss: 12641692.4848; train_global_loss: 29116116.5152; train_optim_loss: 29116116.5152; val_kl_reg_loss: 79302.8389; val_edge_recon_loss: 2888027.5938; val_gene_expr_recon_loss: 13296865.1250; val_masked_gp_l1_reg_loss: 182794.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88775.1641; val_chrom_access_recon_loss: 12817465.0000; val_global_loss: 29353229.5000; val_optim_loss: 29353229.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9157; val_auprc_score: 0.8820; val_best_acc_score: 0.8581; val_best_f1_score: 0.8675; train_kl_reg_loss: 147598.2211; train_edge_recon_loss: 2839272.0568; train_gene_expr_recon_loss: 13196140.4394; train_masked_gp_l1_reg_loss: 182770.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88422.1278; train_chrom_access_recon_loss: 12621893.1364; train_global_loss: 29076096.3636; train_optim_loss: 29076096.3636; val_kl_reg_loss: 81817.0088; val_edge_recon_loss: 2910824.4375; val_gene_expr_recon_loss: 13112777.8750; val_masked_gp_l1_reg_loss: 182752.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88107.6953; val_chrom_access_recon_loss: 12796966.7500; val_global_loss: 29173246.2500; val_optim_loss: 29173246.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9339; val_auprc_score: 0.9076; val_best_acc_score: 0.8807; val_best_f1_score: 0.8857; train_kl_reg_loss: 149869.0362; train_edge_recon_loss: 2832332.9167; train_gene_expr_recon_loss: 13184881.8939; train_masked_gp_l1_reg_loss: 182676.2247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87837.2013; train_chrom_access_recon_loss: 12603311.7424; train_global_loss: 29040909.0000; train_optim_loss: 29040909.0000; val_kl_reg_loss: 84744.1338; val_edge_recon_loss: 2835635.6562; val_gene_expr_recon_loss: 13197928.3750; val_masked_gp_l1_reg_loss: 182655.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87513.0000; val_chrom_access_recon_loss: 12939270.6250; val_global_loss: 29327747.0000; val_optim_loss: 29327747.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9338; val_auprc_score: 0.9077; val_best_acc_score: 0.8802; val_best_f1_score: 0.8860; train_kl_reg_loss: 149950.3717; train_edge_recon_loss: 2830675.5644; train_gene_expr_recon_loss: 13190116.1515; train_masked_gp_l1_reg_loss: 182347.1870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84505.1996; train_chrom_access_recon_loss: 12609162.6667; train_global_loss: 29046757.3333; train_optim_loss: 29046757.3333; val_kl_reg_loss: 85237.9766; val_edge_recon_loss: 2840835.5625; val_gene_expr_recon_loss: 13200750.8750; val_masked_gp_l1_reg_loss: 182220.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83965.6016; val_chrom_access_recon_loss: 12743741.5000; val_global_loss: 29136751.7500; val_optim_loss: 29136751.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9346; val_auprc_score: 0.9091; val_best_acc_score: 0.8732; val_best_f1_score: 0.8801; train_kl_reg_loss: 149944.5684; train_edge_recon_loss: 2825705.5076; train_gene_expr_recon_loss: 13189582.5000; train_masked_gp_l1_reg_loss: 182179.3139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83926.7850; train_chrom_access_recon_loss: 12610996.9545; train_global_loss: 29042335.5455; train_optim_loss: 29042335.5455; val_kl_reg_loss: 85401.6523; val_edge_recon_loss: 2846213.0000; val_gene_expr_recon_loss: 13179558.1250; val_masked_gp_l1_reg_loss: 182151.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83903.0312; val_chrom_access_recon_loss: 12727732.6250; val_global_loss: 29104960.2500; val_optim_loss: 29104960.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9249; val_auprc_score: 0.8956; val_best_acc_score: 0.8686; val_best_f1_score: 0.8758; train_kl_reg_loss: 150042.2036; train_edge_recon_loss: 2825092.9242; train_gene_expr_recon_loss: 13193403.1212; train_masked_gp_l1_reg_loss: 182138.1792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83875.3744; train_chrom_access_recon_loss: 12605281.8788; train_global_loss: 29039833.7576; train_optim_loss: 29039833.7576; val_kl_reg_loss: 85084.1201; val_edge_recon_loss: 2880749.9375; val_gene_expr_recon_loss: 13106777.5000; val_masked_gp_l1_reg_loss: 182119.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83848.4062; val_chrom_access_recon_loss: 12774523.8750; val_global_loss: 29113103.5000; val_optim_loss: 29113103.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9259; val_auprc_score: 0.9000; val_best_acc_score: 0.8667; val_best_f1_score: 0.8747; train_kl_reg_loss: 149809.6941; train_edge_recon_loss: 2828769.0038; train_gene_expr_recon_loss: 13171497.6818; train_masked_gp_l1_reg_loss: 182109.6839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83840.4407; train_chrom_access_recon_loss: 12594824.3788; train_global_loss: 29010850.8788; train_optim_loss: 29010850.8788; val_kl_reg_loss: 84944.2666; val_edge_recon_loss: 2891816.3750; val_gene_expr_recon_loss: 13079985.0000; val_masked_gp_l1_reg_loss: 182098.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83820.2500; val_chrom_access_recon_loss: 12713779.2500; val_global_loss: 29036443.5000; val_optim_loss: 29036443.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9215; val_auprc_score: 0.8907; val_best_acc_score: 0.8659; val_best_f1_score: 0.8728; train_kl_reg_loss: 149674.0765; train_edge_recon_loss: 2837499.2689; train_gene_expr_recon_loss: 13188961.9091; train_masked_gp_l1_reg_loss: 182091.7630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83797.9534; train_chrom_access_recon_loss: 12605430.3939; train_global_loss: 29047455.5152; train_optim_loss: 29047455.5152; val_kl_reg_loss: 85295.3955; val_edge_recon_loss: 2869219.0000; val_gene_expr_recon_loss: 13080979.7500; val_masked_gp_l1_reg_loss: 182086.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83786.6641; val_chrom_access_recon_loss: 12821440.8750; val_global_loss: 29122808.7500; val_optim_loss: 29122808.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9333; val_auprc_score: 0.9066; val_best_acc_score: 0.8743; val_best_f1_score: 0.8822; train_kl_reg_loss: 149535.9152; train_edge_recon_loss: 2837393.1894; train_gene_expr_recon_loss: 13189339.0303; train_masked_gp_l1_reg_loss: 182080.2869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83754.0346; train_chrom_access_recon_loss: 12612411.5606; train_global_loss: 29054514.0000; train_optim_loss: 29054514.0000; val_kl_reg_loss: 85729.0977; val_edge_recon_loss: 2857119.2188; val_gene_expr_recon_loss: 13340030.0000; val_masked_gp_l1_reg_loss: 182073.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83737.7031; val_chrom_access_recon_loss: 12784867.7500; val_global_loss: 29333558.0000; val_optim_loss: 29333558.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9320; val_auprc_score: 0.9087; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 149318.7088; train_edge_recon_loss: 2831467.9318; train_gene_expr_recon_loss: 13190350.5455; train_masked_gp_l1_reg_loss: 182072.2841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83716.7032; train_chrom_access_recon_loss: 12604935.6212; train_global_loss: 29041861.7273; train_optim_loss: 29041861.7273; val_kl_reg_loss: 85123.8838; val_edge_recon_loss: 2851320.0938; val_gene_expr_recon_loss: 13105244.8750; val_masked_gp_l1_reg_loss: 182067.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83703.9922; val_chrom_access_recon_loss: 12643420.2500; val_global_loss: 28950881.2500; val_optim_loss: 28950881.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9267; val_auprc_score: 0.9000; val_best_acc_score: 0.8686; val_best_f1_score: 0.8753; train_kl_reg_loss: 149591.0492; train_edge_recon_loss: 2818363.5720; train_gene_expr_recon_loss: 13174168.2424; train_masked_gp_l1_reg_loss: 182064.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83687.7351; train_chrom_access_recon_loss: 12594504.4545; train_global_loss: 29002380.0000; train_optim_loss: 29002380.0000; val_kl_reg_loss: 86577.9766; val_edge_recon_loss: 2857526.0938; val_gene_expr_recon_loss: 13176556.1250; val_masked_gp_l1_reg_loss: 182060.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83665.3594; val_chrom_access_recon_loss: 12771974.1250; val_global_loss: 29158359.7500; val_optim_loss: 29158359.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9249; val_auprc_score: 0.8964; val_best_acc_score: 0.8724; val_best_f1_score: 0.8806; train_kl_reg_loss: 149251.4830; train_edge_recon_loss: 2836143.5455; train_gene_expr_recon_loss: 13186982.0758; train_masked_gp_l1_reg_loss: 182058.2687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83650.4177; train_chrom_access_recon_loss: 12599328.7273; train_global_loss: 29037414.5455; train_optim_loss: 29037414.5455; val_kl_reg_loss: 87040.8857; val_edge_recon_loss: 2856160.4375; val_gene_expr_recon_loss: 13284130.1250; val_masked_gp_l1_reg_loss: 182052.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83641.9688; val_chrom_access_recon_loss: 12883961.3750; val_global_loss: 29376987.5000; val_optim_loss: 29376987.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9306; val_auprc_score: 0.9082; val_best_acc_score: 0.8692; val_best_f1_score: 0.8761; train_kl_reg_loss: 149426.6984; train_edge_recon_loss: 2827864.4205; train_gene_expr_recon_loss: 13175330.0758; train_masked_gp_l1_reg_loss: 182050.2552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83615.8366; train_chrom_access_recon_loss: 12590670.6818; train_global_loss: 29008958.1818; train_optim_loss: 29008958.1818; val_kl_reg_loss: 86553.9961; val_edge_recon_loss: 2842071.2500; val_gene_expr_recon_loss: 13254370.0000; val_masked_gp_l1_reg_loss: 182044.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83603.9141; val_chrom_access_recon_loss: 12872763.6250; val_global_loss: 29321407.2500; val_optim_loss: 29321407.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9315; val_auprc_score: 0.9096; val_best_acc_score: 0.8729; val_best_f1_score: 0.8793; train_kl_reg_loss: 149120.5919; train_edge_recon_loss: 2833065.4735; train_gene_expr_recon_loss: 13187252.7121; train_masked_gp_l1_reg_loss: 182040.4922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83579.4479; train_chrom_access_recon_loss: 12603039.7879; train_global_loss: 29038098.6061; train_optim_loss: 29038098.6061; val_kl_reg_loss: 86035.5527; val_edge_recon_loss: 2844849.0625; val_gene_expr_recon_loss: 13013961.2500; val_masked_gp_l1_reg_loss: 182036.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83559.2031; val_chrom_access_recon_loss: 12686778.7500; val_global_loss: 28897221.0000; val_optim_loss: 28897221.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9310; val_auprc_score: 0.9052; val_best_acc_score: 0.8729; val_best_f1_score: 0.8795; train_kl_reg_loss: 149110.0897; train_edge_recon_loss: 2826358.4773; train_gene_expr_recon_loss: 13174020.7121; train_masked_gp_l1_reg_loss: 182034.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83553.4038; train_chrom_access_recon_loss: 12593198.6667; train_global_loss: 29008276.1515; train_optim_loss: 29008276.1515; val_kl_reg_loss: 86668.1514; val_edge_recon_loss: 2871480.0625; val_gene_expr_recon_loss: 13014400.1250; val_masked_gp_l1_reg_loss: 182033.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83537.7188; val_chrom_access_recon_loss: 12718895.3750; val_global_loss: 28957014.5000; val_optim_loss: 28957014.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9294; val_auprc_score: 0.8988; val_best_acc_score: 0.8737; val_best_f1_score: 0.8803; train_kl_reg_loss: 149166.2699; train_edge_recon_loss: 2828296.0227; train_gene_expr_recon_loss: 13175807.3939; train_masked_gp_l1_reg_loss: 182029.3222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83514.8366; train_chrom_access_recon_loss: 12586094.2879; train_global_loss: 29004908.2424; train_optim_loss: 29004908.2424; val_kl_reg_loss: 86784.1738; val_edge_recon_loss: 2833479.8125; val_gene_expr_recon_loss: 13149854.3750; val_masked_gp_l1_reg_loss: 182027.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83493.3203; val_chrom_access_recon_loss: 12863419.0000; val_global_loss: 29199058.2500; val_optim_loss: 29199058.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9334; val_auprc_score: 0.9052; val_best_acc_score: 0.8783; val_best_f1_score: 0.8837; train_kl_reg_loss: 149240.6392; train_edge_recon_loss: 2820949.3144; train_gene_expr_recon_loss: 13191798.2424; train_masked_gp_l1_reg_loss: 182028.2055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83482.4759; train_chrom_access_recon_loss: 12595453.2879; train_global_loss: 29022952.0303; train_optim_loss: 29022952.0303; val_kl_reg_loss: 87361.1025; val_edge_recon_loss: 2799135.5000; val_gene_expr_recon_loss: 13219845.6250; val_masked_gp_l1_reg_loss: 182026.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83476.9844; val_chrom_access_recon_loss: 12658305.5000; val_global_loss: 29030151.2500; val_optim_loss: 29030151.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9319; val_auprc_score: 0.9095; val_best_acc_score: 0.8748; val_best_f1_score: 0.8805; train_kl_reg_loss: 149325.1039; train_edge_recon_loss: 2821396.1023; train_gene_expr_recon_loss: 13180285.4848; train_masked_gp_l1_reg_loss: 182024.3028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83455.1212; train_chrom_access_recon_loss: 12589065.0606; train_global_loss: 29005550.9394; train_optim_loss: 29005550.9394; val_kl_reg_loss: 87647.1875; val_edge_recon_loss: 2859049.4062; val_gene_expr_recon_loss: 13142102.8750; val_masked_gp_l1_reg_loss: 182019.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83433.4375; val_chrom_access_recon_loss: 12727773.8750; val_global_loss: 29082026.5000; val_optim_loss: 29082026.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9269; val_auprc_score: 0.9026; val_best_acc_score: 0.8710; val_best_f1_score: 0.8772; train_kl_reg_loss: 149219.8516; train_edge_recon_loss: 2825572.7386; train_gene_expr_recon_loss: 13179092.6364; train_masked_gp_l1_reg_loss: 181987.5130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83097.6327; train_chrom_access_recon_loss: 12583206.3788; train_global_loss: 29002176.5758; train_optim_loss: 29002176.5758; val_kl_reg_loss: 87444.7598; val_edge_recon_loss: 2875896.6562; val_gene_expr_recon_loss: 13231952.0000; val_masked_gp_l1_reg_loss: 181974.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83036.3438; val_chrom_access_recon_loss: 12823605.5000; val_global_loss: 29283909.5000; val_optim_loss: 29283909.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9299; val_auprc_score: 0.9073; val_best_acc_score: 0.8732; val_best_f1_score: 0.8790; train_kl_reg_loss: 149072.1683; train_edge_recon_loss: 2831454.5530; train_gene_expr_recon_loss: 13174397.4242; train_masked_gp_l1_reg_loss: 181970.8108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83033.0672; train_chrom_access_recon_loss: 12589786.8030; train_global_loss: 29009715.0000; train_optim_loss: 29009715.0000; val_kl_reg_loss: 87106.5352; val_edge_recon_loss: 2850930.7500; val_gene_expr_recon_loss: 13197411.3750; val_masked_gp_l1_reg_loss: 181967.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83030.8516; val_chrom_access_recon_loss: 12788670.3750; val_global_loss: 29189118.5000; val_optim_loss: 29189118.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9210; val_auprc_score: 0.8929; val_best_acc_score: 0.8646; val_best_f1_score: 0.8730; train_kl_reg_loss: 149046.4119; train_edge_recon_loss: 2825572.1932; train_gene_expr_recon_loss: 13176482.9545; train_masked_gp_l1_reg_loss: 181965.7159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83028.0726; train_chrom_access_recon_loss: 12579102.1970; train_global_loss: 28995197.4848; train_optim_loss: 28995197.4848; val_kl_reg_loss: 87608.0342; val_edge_recon_loss: 2875464.4688; val_gene_expr_recon_loss: 13117154.6250; val_masked_gp_l1_reg_loss: 181963.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83025.2812; val_chrom_access_recon_loss: 12657332.5000; val_global_loss: 29002549.2500; val_optim_loss: 29002549.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9241; val_auprc_score: 0.8939; val_best_acc_score: 0.8686; val_best_f1_score: 0.8778; train_kl_reg_loss: 148988.8149; train_edge_recon_loss: 2828051.0720; train_gene_expr_recon_loss: 13172215.5455; train_masked_gp_l1_reg_loss: 181962.9479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83024.1236; train_chrom_access_recon_loss: 12579267.8939; train_global_loss: 28993510.5455; train_optim_loss: 28993510.5455; val_kl_reg_loss: 86440.8242; val_edge_recon_loss: 2873041.3438; val_gene_expr_recon_loss: 13258036.2500; val_masked_gp_l1_reg_loss: 181961.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83021.9453; val_chrom_access_recon_loss: 12760009.3750; val_global_loss: 29242511.0000; val_optim_loss: 29242511.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 9 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9216
val AUPRC score: 0.8935
val best accuracy score: 0.8673
val best F1 score: 0.8753
val target rna MSE score: 1.0618
val source rna MSE score: 0.4392
val target atac MSE score: 0.3372
val source atac MSE score: 0.0749
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
