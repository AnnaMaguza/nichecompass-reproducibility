[True]
Run timestamp: 24072023_164654_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9036; val_auprc_score: 0.9143; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 11590.8952; train_edge_recon_loss: 3488609.7500; train_gene_expr_recon_loss: 32081389.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1086348.1528; train_global_loss: 36667937.7778; train_optim_loss: 36667937.7778; val_kl_reg_loss: 30078.1328; val_edge_recon_loss: 4065767.0000; val_gene_expr_recon_loss: 29897462.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1070828.7500; val_global_loss: 35064136.0000; val_optim_loss: 35064136.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8908; val_auprc_score: 0.8978; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 61256.3596; train_edge_recon_loss: 3549549.3056; train_gene_expr_recon_loss: 29219904.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1079053.3333; train_global_loss: 33909764.4444; train_optim_loss: 33909764.4444; val_kl_reg_loss: 63479.9609; val_edge_recon_loss: 4065924.5000; val_gene_expr_recon_loss: 27117032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048212.8750; val_global_loss: 32294648.0000; val_optim_loss: 32294648.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8919; val_auprc_score: 0.9002; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 100869.8351; train_edge_recon_loss: 3601935.6111; train_gene_expr_recon_loss: 26518979.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038818.1181; train_global_loss: 31260602.6667; train_optim_loss: 31260602.6667; val_kl_reg_loss: 104780.0312; val_edge_recon_loss: 4065893.2500; val_gene_expr_recon_loss: 24867152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027736.6250; val_global_loss: 30065562.0000; val_optim_loss: 30065562.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8926; val_auprc_score: 0.8989; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 147953.7795; train_edge_recon_loss: 3635831.2778; train_gene_expr_recon_loss: 24433224.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018615.5694; train_global_loss: 29235625.1111; train_optim_loss: 29235625.1111; val_kl_reg_loss: 175967.8750; val_edge_recon_loss: 4065861.0000; val_gene_expr_recon_loss: 23392252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011653.8125; val_global_loss: 28645734.0000; val_optim_loss: 28645734.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8872; val_auprc_score: 0.8884; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 178384.9149; train_edge_recon_loss: 3635744.8889; train_gene_expr_recon_loss: 23333550.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011262.7778; train_global_loss: 28158943.5556; train_optim_loss: 28158943.5556; val_kl_reg_loss: 147249.2500; val_edge_recon_loss: 4065634.0000; val_gene_expr_recon_loss: 22507944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001258.1250; val_global_loss: 27722086.0000; val_optim_loss: 27722086.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8879; val_auprc_score: 0.8846; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 181175.7378; train_edge_recon_loss: 3651636.2222; train_gene_expr_recon_loss: 22460219.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002800.7153; train_global_loss: 27295832.8889; train_optim_loss: 27295832.8889; val_kl_reg_loss: 183116.1250; val_edge_recon_loss: 4065332.5000; val_gene_expr_recon_loss: 21900942.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 993572.1250; val_global_loss: 27142962.0000; val_optim_loss: 27142962.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8848; val_auprc_score: 0.8738; val_best_acc_score: 0.5079; val_best_f1_score: 0.6702; train_kl_reg_loss: 209958.2118; train_edge_recon_loss: 3632311.3889; train_gene_expr_recon_loss: 21862707.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985270.4028; train_global_loss: 26690247.5556; train_optim_loss: 26690247.5556; val_kl_reg_loss: 168794.6250; val_edge_recon_loss: 4064925.0000; val_gene_expr_recon_loss: 21484702.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987663.8125; val_global_loss: 26706086.0000; val_optim_loss: 26706086.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8840; val_auprc_score: 0.8752; val_best_acc_score: 0.5233; val_best_f1_score: 0.6768; train_kl_reg_loss: 204984.4635; train_edge_recon_loss: 3642529.7778; train_gene_expr_recon_loss: 21450350.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985043.4653; train_global_loss: 26282908.4444; train_optim_loss: 26282908.4444; val_kl_reg_loss: 197573.4375; val_edge_recon_loss: 4063868.7500; val_gene_expr_recon_loss: 21227758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984961.7500; val_global_loss: 26474162.0000; val_optim_loss: 26474162.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8860; val_auprc_score: 0.8780; val_best_acc_score: 0.5535; val_best_f1_score: 0.6905; train_kl_reg_loss: 213539.5764; train_edge_recon_loss: 3626009.3889; train_gene_expr_recon_loss: 21332005.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981395.1111; train_global_loss: 26152949.7778; train_optim_loss: 26152949.7778; val_kl_reg_loss: 172374.4375; val_edge_recon_loss: 4062039.7500; val_gene_expr_recon_loss: 21068010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981925.1875; val_global_loss: 26284350.0000; val_optim_loss: 26284350.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8873; val_auprc_score: 0.8773; val_best_acc_score: 0.6009; val_best_f1_score: 0.7132; train_kl_reg_loss: 208575.7622; train_edge_recon_loss: 3620535.5556; train_gene_expr_recon_loss: 21213794.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980316.2500; train_global_loss: 26023222.2222; train_optim_loss: 26023222.2222; val_kl_reg_loss: 171514.6250; val_edge_recon_loss: 4059750.2500; val_gene_expr_recon_loss: 20961066.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979174.4375; val_global_loss: 26171506.0000; val_optim_loss: 26171506.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8919; val_auprc_score: 0.8789; val_best_acc_score: 0.6564; val_best_f1_score: 0.7417; train_kl_reg_loss: 204435.6319; train_edge_recon_loss: 3608731.0833; train_gene_expr_recon_loss: 21128629.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979950.0139; train_global_loss: 25921745.7778; train_optim_loss: 25921745.7778; val_kl_reg_loss: 163267.3594; val_edge_recon_loss: 4056002.5000; val_gene_expr_recon_loss: 20895562.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978420.5625; val_global_loss: 26093252.0000; val_optim_loss: 26093252.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8962; val_auprc_score: 0.8839; val_best_acc_score: 0.6933; val_best_f1_score: 0.7616; train_kl_reg_loss: 194279.7882; train_edge_recon_loss: 3606209.6389; train_gene_expr_recon_loss: 21012869.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974932.2917; train_global_loss: 25788291.1111; train_optim_loss: 25788291.1111; val_kl_reg_loss: 180116.1562; val_edge_recon_loss: 4052979.7500; val_gene_expr_recon_loss: 20811996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976147.1250; val_global_loss: 26021240.0000; val_optim_loss: 26021240.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9007; val_auprc_score: 0.8889; val_best_acc_score: 0.7518; val_best_f1_score: 0.7956; train_kl_reg_loss: 201682.8594; train_edge_recon_loss: 3591076.1944; train_gene_expr_recon_loss: 21065674.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981119.0486; train_global_loss: 25839553.1111; train_optim_loss: 25839553.1111; val_kl_reg_loss: 142570.1562; val_edge_recon_loss: 4045054.5000; val_gene_expr_recon_loss: 20774236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975822.8125; val_global_loss: 25937682.0000; val_optim_loss: 25937682.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9036; val_auprc_score: 0.8927; val_best_acc_score: 0.7840; val_best_f1_score: 0.8142; train_kl_reg_loss: 182937.4427; train_edge_recon_loss: 3604784.3889; train_gene_expr_recon_loss: 20900433.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972116.8403; train_global_loss: 25660272.4444; train_optim_loss: 25660272.4444; val_kl_reg_loss: 157562.3750; val_edge_recon_loss: 4037460.7500; val_gene_expr_recon_loss: 20700464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973409.9375; val_global_loss: 25868898.0000; val_optim_loss: 25868898.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9070; val_auprc_score: 0.8947; val_best_acc_score: 0.8137; val_best_f1_score: 0.8321; train_kl_reg_loss: 186189.3351; train_edge_recon_loss: 3581290.0000; train_gene_expr_recon_loss: 20818559.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971990.9514; train_global_loss: 25558030.4444; train_optim_loss: 25558030.4444; val_kl_reg_loss: 181517.3906; val_edge_recon_loss: 4026299.0000; val_gene_expr_recon_loss: 20677026.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973844.2500; val_global_loss: 25858686.0000; val_optim_loss: 25858686.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9000; val_auprc_score: 0.8858; val_best_acc_score: 0.8207; val_best_f1_score: 0.8319; train_kl_reg_loss: 183853.5295; train_edge_recon_loss: 3575484.8333; train_gene_expr_recon_loss: 20712199.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972209.7292; train_global_loss: 25443747.5556; train_optim_loss: 25443747.5556; val_kl_reg_loss: 143993.5312; val_edge_recon_loss: 4013816.5000; val_gene_expr_recon_loss: 20619054.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971667.5000; val_global_loss: 25748532.0000; val_optim_loss: 25748532.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9058; val_auprc_score: 0.8915; val_best_acc_score: 0.8300; val_best_f1_score: 0.8328; train_kl_reg_loss: 172576.9826; train_edge_recon_loss: 3576445.5556; train_gene_expr_recon_loss: 20768620.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967925.4167; train_global_loss: 25485568.6667; train_optim_loss: 25485568.6667; val_kl_reg_loss: 152920.0000; val_edge_recon_loss: 3997971.5000; val_gene_expr_recon_loss: 20589654.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970426.2500; val_global_loss: 25710972.0000; val_optim_loss: 25710972.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9046; val_auprc_score: 0.8875; val_best_acc_score: 0.8215; val_best_f1_score: 0.8150; train_kl_reg_loss: 172960.6441; train_edge_recon_loss: 3563529.9444; train_gene_expr_recon_loss: 20621920.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965810.0069; train_global_loss: 25324221.7778; train_optim_loss: 25324221.7778; val_kl_reg_loss: 141336.8438; val_edge_recon_loss: 3975348.5000; val_gene_expr_recon_loss: 20563466.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970227.0000; val_global_loss: 25650380.0000; val_optim_loss: 25650380.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9027; val_auprc_score: 0.8872; val_best_acc_score: 0.8015; val_best_f1_score: 0.8042; train_kl_reg_loss: 167568.4392; train_edge_recon_loss: 3556770.3889; train_gene_expr_recon_loss: 20735346.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970061.7639; train_global_loss: 25429747.3333; train_optim_loss: 25429747.3333; val_kl_reg_loss: 135602.1562; val_edge_recon_loss: 3946108.0000; val_gene_expr_recon_loss: 20533178.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968241.8750; val_global_loss: 25583130.0000; val_optim_loss: 25583130.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9089; val_auprc_score: 0.8913; val_best_acc_score: 0.8025; val_best_f1_score: 0.8283; train_kl_reg_loss: 158895.2622; train_edge_recon_loss: 3543945.4444; train_gene_expr_recon_loss: 20723296.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969195.9514; train_global_loss: 25395332.8889; train_optim_loss: 25395332.8889; val_kl_reg_loss: 138233.4688; val_edge_recon_loss: 3899831.5000; val_gene_expr_recon_loss: 20525618.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968385.8750; val_global_loss: 25532070.0000; val_optim_loss: 25532070.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9072; val_auprc_score: 0.8945; val_best_acc_score: 0.8099; val_best_f1_score: 0.8297; train_kl_reg_loss: 157786.3507; train_edge_recon_loss: 3523658.7222; train_gene_expr_recon_loss: 20595118.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961186.4167; train_global_loss: 25237749.7778; train_optim_loss: 25237749.7778; val_kl_reg_loss: 134341.0625; val_edge_recon_loss: 3847464.0000; val_gene_expr_recon_loss: 20482866.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966359.3125; val_global_loss: 25431032.0000; val_optim_loss: 25431032.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9051; val_auprc_score: 0.8901; val_best_acc_score: 0.8239; val_best_f1_score: 0.8345; train_kl_reg_loss: 148257.6146; train_edge_recon_loss: 3504449.6111; train_gene_expr_recon_loss: 20572246.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964938.0903; train_global_loss: 25189891.5556; train_optim_loss: 25189891.5556; val_kl_reg_loss: 126258.3281; val_edge_recon_loss: 3766056.2500; val_gene_expr_recon_loss: 20484526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967787.5625; val_global_loss: 25344628.0000; val_optim_loss: 25344628.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9033; val_auprc_score: 0.8865; val_best_acc_score: 0.8224; val_best_f1_score: 0.8344; train_kl_reg_loss: 141101.6953; train_edge_recon_loss: 3472918.8056; train_gene_expr_recon_loss: 20617681.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967182.3264; train_global_loss: 25198884.4444; train_optim_loss: 25198884.4444; val_kl_reg_loss: 124727.1094; val_edge_recon_loss: 3662707.7500; val_gene_expr_recon_loss: 20455102.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965880.1250; val_global_loss: 25208416.0000; val_optim_loss: 25208416.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9014; val_auprc_score: 0.8825; val_best_acc_score: 0.8205; val_best_f1_score: 0.8317; train_kl_reg_loss: 137364.4523; train_edge_recon_loss: 3424581.9444; train_gene_expr_recon_loss: 20655517.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967754.6528; train_global_loss: 25185218.6667; train_optim_loss: 25185218.6667; val_kl_reg_loss: 117760.5938; val_edge_recon_loss: 3534967.2500; val_gene_expr_recon_loss: 20429484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964747.7500; val_global_loss: 25046960.0000; val_optim_loss: 25046960.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9009; val_auprc_score: 0.8828; val_best_acc_score: 0.8150; val_best_f1_score: 0.8256; train_kl_reg_loss: 133623.6727; train_edge_recon_loss: 3361421.1667; train_gene_expr_recon_loss: 20565141.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964909.0972; train_global_loss: 25025096.2222; train_optim_loss: 25025096.2222; val_kl_reg_loss: 118099.1094; val_edge_recon_loss: 3391225.7500; val_gene_expr_recon_loss: 20410220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963590.1250; val_global_loss: 24883134.0000; val_optim_loss: 24883134.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9273; val_auprc_score: 0.9161; val_best_acc_score: 0.8456; val_best_f1_score: 0.8558; train_kl_reg_loss: 139145.0590; train_edge_recon_loss: 3646158.1111; train_gene_expr_recon_loss: 21222645.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967284.9792; train_global_loss: 25975233.1111; train_optim_loss: 25975233.1111; val_kl_reg_loss: 52410.8516; val_edge_recon_loss: 3682147.7500; val_gene_expr_recon_loss: 21224902.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972105.0000; val_global_loss: 25931564.0000; val_optim_loss: 25931564.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9247; val_auprc_score: 0.9133; val_best_acc_score: 0.8230; val_best_f1_score: 0.8446; train_kl_reg_loss: 82445.8776; train_edge_recon_loss: 3654026.5000; train_gene_expr_recon_loss: 21650271.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977576.1042; train_global_loss: 26364320.0000; train_optim_loss: 26364320.0000; val_kl_reg_loss: 52522.9062; val_edge_recon_loss: 3838664.2500; val_gene_expr_recon_loss: 21013012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968197.2500; val_global_loss: 25872398.0000; val_optim_loss: 25872398.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9235; val_auprc_score: 0.9102; val_best_acc_score: 0.8418; val_best_f1_score: 0.8392; train_kl_reg_loss: 52884.4431; train_edge_recon_loss: 3747268.8611; train_gene_expr_recon_loss: 21742471.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979287.0556; train_global_loss: 26521912.4444; train_optim_loss: 26521912.4444; val_kl_reg_loss: 44363.1719; val_edge_recon_loss: 3931332.0000; val_gene_expr_recon_loss: 21239380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971685.3750; val_global_loss: 26186762.0000; val_optim_loss: 26186762.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9182; val_auprc_score: 0.9016; val_best_acc_score: 0.8437; val_best_f1_score: 0.8517; train_kl_reg_loss: 48911.8060; train_edge_recon_loss: 3753956.5278; train_gene_expr_recon_loss: 21562650.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975092.3472; train_global_loss: 26340611.5556; train_optim_loss: 26340611.5556; val_kl_reg_loss: 32118.5371; val_edge_recon_loss: 3985890.2500; val_gene_expr_recon_loss: 21245022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969909.0000; val_global_loss: 26232940.0000; val_optim_loss: 26232940.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9222; val_auprc_score: 0.9099; val_best_acc_score: 0.8475; val_best_f1_score: 0.8561; train_kl_reg_loss: 39380.9384; train_edge_recon_loss: 3783544.5833; train_gene_expr_recon_loss: 21416338.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972304.3125; train_global_loss: 26211568.2222; train_optim_loss: 26211568.2222; val_kl_reg_loss: 35440.1836; val_edge_recon_loss: 3985769.2500; val_gene_expr_recon_loss: 21161120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968486.9375; val_global_loss: 26150816.0000; val_optim_loss: 26150816.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9216; val_auprc_score: 0.9108; val_best_acc_score: 0.8417; val_best_f1_score: 0.8525; train_kl_reg_loss: 48055.4965; train_edge_recon_loss: 3743619.6111; train_gene_expr_recon_loss: 21355656.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967679.6181; train_global_loss: 26115010.8889; train_optim_loss: 26115010.8889; val_kl_reg_loss: 43540.2266; val_edge_recon_loss: 3993342.5000; val_gene_expr_recon_loss: 21046048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967725.3750; val_global_loss: 26050656.0000; val_optim_loss: 26050656.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9230; val_auprc_score: 0.9129; val_best_acc_score: 0.8440; val_best_f1_score: 0.8541; train_kl_reg_loss: 49538.8598; train_edge_recon_loss: 3740053.9167; train_gene_expr_recon_loss: 21253649.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967685.6597; train_global_loss: 26010928.2222; train_optim_loss: 26010928.2222; val_kl_reg_loss: 42825.9531; val_edge_recon_loss: 3988436.7500; val_gene_expr_recon_loss: 21044220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967779.1250; val_global_loss: 26043262.0000; val_optim_loss: 26043262.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9199; val_auprc_score: 0.9049; val_best_acc_score: 0.8437; val_best_f1_score: 0.8536; train_kl_reg_loss: 52420.0009; train_edge_recon_loss: 3738349.6389; train_gene_expr_recon_loss: 21241230.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969728.9375; train_global_loss: 26001728.8889; train_optim_loss: 26001728.8889; val_kl_reg_loss: 47794.6133; val_edge_recon_loss: 3992691.0000; val_gene_expr_recon_loss: 20975972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966136.9375; val_global_loss: 25982594.0000; val_optim_loss: 25982594.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 56 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9229
Val AUPRC score: 0.9075
Val best accuracy score: 0.8411
Val best F1 score: 0.8538
Val gene expr MSE score: 0.5163
Val chrom access MSE score: 0.0866
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
