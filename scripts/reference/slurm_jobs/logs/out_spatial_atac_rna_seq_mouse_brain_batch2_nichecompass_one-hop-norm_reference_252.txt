[True]
Run timestamp: 10102023_113725_252.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_252']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6745; val_auprc_score: 0.6483; val_best_acc_score: 0.5081; val_best_f1_score: 0.6699; train_kl_reg_loss: 64882.2996; train_edge_recon_loss: 749052.8655; train_gene_expr_recon_loss: 23156035.8182; train_masked_gp_l1_reg_loss: 143940.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5039182.0947; train_chrom_access_recon_loss: 4979689.5455; train_global_loss: 34132782.9091; train_optim_loss: 34132782.9091; val_kl_reg_loss: 93622.4736; val_edge_recon_loss: 812991.7656; val_gene_expr_recon_loss: 21528333.0000; val_masked_gp_l1_reg_loss: 104338.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2887099.5000; val_chrom_access_recon_loss: 4789519.8125; val_global_loss: 30215905.2500; val_optim_loss: 30215905.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6926; val_auprc_score: 0.6764; val_best_acc_score: 0.5860; val_best_f1_score: 0.6972; train_kl_reg_loss: 99088.2778; train_edge_recon_loss: 752179.3807; train_gene_expr_recon_loss: 21223507.7879; train_masked_gp_l1_reg_loss: 96789.8536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1614650.7008; train_chrom_access_recon_loss: 4734707.4545; train_global_loss: 28520923.6061; train_optim_loss: 28520923.6061; val_kl_reg_loss: 91242.5195; val_edge_recon_loss: 812021.9453; val_gene_expr_recon_loss: 21190660.2500; val_masked_gp_l1_reg_loss: 93671.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 797490.4375; val_chrom_access_recon_loss: 4750729.0000; val_global_loss: 27735815.7500; val_optim_loss: 27735815.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7643; val_auprc_score: 0.7539; val_best_acc_score: 0.6862; val_best_f1_score: 0.7023; train_kl_reg_loss: 88321.2939; train_edge_recon_loss: 742482.0966; train_gene_expr_recon_loss: 21028932.6364; train_masked_gp_l1_reg_loss: 93817.4529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 525657.3651; train_chrom_access_recon_loss: 4702707.8409; train_global_loss: 27181918.4242; train_optim_loss: 27181918.4242; val_kl_reg_loss: 87537.4189; val_edge_recon_loss: 804017.6406; val_gene_expr_recon_loss: 21163275.5000; val_masked_gp_l1_reg_loss: 94534.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 347600.7500; val_chrom_access_recon_loss: 4747021.5000; val_global_loss: 27243985.7500; val_optim_loss: 27243985.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8186; val_auprc_score: 0.7951; val_best_acc_score: 0.7208; val_best_f1_score: 0.7579; train_kl_reg_loss: 80614.2197; train_edge_recon_loss: 732860.2150; train_gene_expr_recon_loss: 20878484.6364; train_masked_gp_l1_reg_loss: 95653.1123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 272386.9605; train_chrom_access_recon_loss: 4675285.8030; train_global_loss: 26735285.1212; train_optim_loss: 26735285.1212; val_kl_reg_loss: 93385.1875; val_edge_recon_loss: 784511.6797; val_gene_expr_recon_loss: 21199713.7500; val_masked_gp_l1_reg_loss: 97457.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218247.1250; val_chrom_access_recon_loss: 4778183.8125; val_global_loss: 27171500.0000; val_optim_loss: 27171500.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8632; val_auprc_score: 0.8342; val_best_acc_score: 0.7953; val_best_f1_score: 0.7996; train_kl_reg_loss: 75725.1239; train_edge_recon_loss: 718840.9034; train_gene_expr_recon_loss: 20743323.7576; train_masked_gp_l1_reg_loss: 98843.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 191330.3184; train_chrom_access_recon_loss: 4648668.8939; train_global_loss: 26476732.2424; train_optim_loss: 26476732.2424; val_kl_reg_loss: 76748.6572; val_edge_recon_loss: 743042.5859; val_gene_expr_recon_loss: 20961354.2500; val_masked_gp_l1_reg_loss: 100567.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171255.9688; val_chrom_access_recon_loss: 4720576.1875; val_global_loss: 26773545.5000; val_optim_loss: 26773545.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8816; val_auprc_score: 0.8548; val_best_acc_score: 0.8031; val_best_f1_score: 0.8169; train_kl_reg_loss: 74977.3068; train_edge_recon_loss: 688031.3059; train_gene_expr_recon_loss: 20614109.1818; train_masked_gp_l1_reg_loss: 102112.8335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158053.5703; train_chrom_access_recon_loss: 4625271.7348; train_global_loss: 26262556.0606; train_optim_loss: 26262556.0606; val_kl_reg_loss: 76882.5879; val_edge_recon_loss: 678638.8672; val_gene_expr_recon_loss: 20904313.0000; val_masked_gp_l1_reg_loss: 103700.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147091.5781; val_chrom_access_recon_loss: 4669564.5625; val_global_loss: 26580190.7500; val_optim_loss: 26580190.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8916; val_auprc_score: 0.8633; val_best_acc_score: 0.8157; val_best_f1_score: 0.8279; train_kl_reg_loss: 82833.5595; train_edge_recon_loss: 649593.4025; train_gene_expr_recon_loss: 20500423.3333; train_masked_gp_l1_reg_loss: 104937.1541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139389.3821; train_chrom_access_recon_loss: 4603947.1894; train_global_loss: 26081124.0303; train_optim_loss: 26081124.0303; val_kl_reg_loss: 85210.2607; val_edge_recon_loss: 645450.5781; val_gene_expr_recon_loss: 20668581.7500; val_masked_gp_l1_reg_loss: 106269.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132500.2812; val_chrom_access_recon_loss: 4640517.3750; val_global_loss: 26278529.2500; val_optim_loss: 26278529.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8962; val_auprc_score: 0.8686; val_best_acc_score: 0.8264; val_best_f1_score: 0.8382; train_kl_reg_loss: 85545.4605; train_edge_recon_loss: 631357.0956; train_gene_expr_recon_loss: 20397524.8788; train_masked_gp_l1_reg_loss: 107540.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126607.5088; train_chrom_access_recon_loss: 4584607.6667; train_global_loss: 25933182.8788; train_optim_loss: 25933182.8788; val_kl_reg_loss: 84834.2051; val_edge_recon_loss: 636978.0625; val_gene_expr_recon_loss: 20502078.7500; val_masked_gp_l1_reg_loss: 108426.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120149.6797; val_chrom_access_recon_loss: 4618743.3750; val_global_loss: 26071210.2500; val_optim_loss: 26071210.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9038; val_auprc_score: 0.8845; val_best_acc_score: 0.8302; val_best_f1_score: 0.8406; train_kl_reg_loss: 84760.5223; train_edge_recon_loss: 623837.5303; train_gene_expr_recon_loss: 20309696.0303; train_masked_gp_l1_reg_loss: 109673.1635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115821.7923; train_chrom_access_recon_loss: 4564633.0909; train_global_loss: 25808422.0000; train_optim_loss: 25808422.0000; val_kl_reg_loss: 86787.7695; val_edge_recon_loss: 630526.4141; val_gene_expr_recon_loss: 20418265.7500; val_masked_gp_l1_reg_loss: 110725.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111816.3516; val_chrom_access_recon_loss: 4611458.5000; val_global_loss: 25969580.7500; val_optim_loss: 25969580.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8998; val_auprc_score: 0.8733; val_best_acc_score: 0.8294; val_best_f1_score: 0.8382; train_kl_reg_loss: 83687.4144; train_edge_recon_loss: 618989.4318; train_gene_expr_recon_loss: 20214558.1212; train_masked_gp_l1_reg_loss: 111600.5727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108283.6123; train_chrom_access_recon_loss: 4540509.8939; train_global_loss: 25677629.0000; train_optim_loss: 25677629.0000; val_kl_reg_loss: 85537.6357; val_edge_recon_loss: 621380.2812; val_gene_expr_recon_loss: 20352485.7500; val_masked_gp_l1_reg_loss: 112380.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104998.6953; val_chrom_access_recon_loss: 4593715.3750; val_global_loss: 25870497.5000; val_optim_loss: 25870497.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9031; val_auprc_score: 0.8672; val_best_acc_score: 0.8434; val_best_f1_score: 0.8529; train_kl_reg_loss: 82612.0876; train_edge_recon_loss: 613765.0568; train_gene_expr_recon_loss: 20155246.0000; train_masked_gp_l1_reg_loss: 113216.7978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102861.4941; train_chrom_access_recon_loss: 4527672.0227; train_global_loss: 25595373.2727; train_optim_loss: 25595373.2727; val_kl_reg_loss: 83988.5176; val_edge_recon_loss: 618754.8203; val_gene_expr_recon_loss: 20242247.0000; val_masked_gp_l1_reg_loss: 113886.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100268.9531; val_chrom_access_recon_loss: 4539703.4375; val_global_loss: 25698848.0000; val_optim_loss: 25698848.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9134; val_auprc_score: 0.8909; val_best_acc_score: 0.8447; val_best_f1_score: 0.8533; train_kl_reg_loss: 80831.7762; train_edge_recon_loss: 613123.5909; train_gene_expr_recon_loss: 20089514.7879; train_masked_gp_l1_reg_loss: 114349.7834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98611.3337; train_chrom_access_recon_loss: 4508474.4848; train_global_loss: 25504905.7879; train_optim_loss: 25504905.7879; val_kl_reg_loss: 80516.7549; val_edge_recon_loss: 613922.7500; val_gene_expr_recon_loss: 20147376.2500; val_masked_gp_l1_reg_loss: 114962.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96803.7422; val_chrom_access_recon_loss: 4553119.7500; val_global_loss: 25606701.5000; val_optim_loss: 25606701.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9073; val_auprc_score: 0.8731; val_best_acc_score: 0.8455; val_best_f1_score: 0.8567; train_kl_reg_loss: 79711.7772; train_edge_recon_loss: 611191.0464; train_gene_expr_recon_loss: 20023978.3636; train_masked_gp_l1_reg_loss: 115318.1773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95588.4508; train_chrom_access_recon_loss: 4495819.0152; train_global_loss: 25421606.7576; train_optim_loss: 25421606.7576; val_kl_reg_loss: 79064.6240; val_edge_recon_loss: 616252.8672; val_gene_expr_recon_loss: 20095932.7500; val_masked_gp_l1_reg_loss: 116110.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94576.8125; val_chrom_access_recon_loss: 4545736.7500; val_global_loss: 25547673.0000; val_optim_loss: 25547673.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9134; val_auprc_score: 0.8890; val_best_acc_score: 0.8474; val_best_f1_score: 0.8586; train_kl_reg_loss: 78656.0878; train_edge_recon_loss: 608608.5445; train_gene_expr_recon_loss: 19953782.9091; train_masked_gp_l1_reg_loss: 116240.7936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93433.2521; train_chrom_access_recon_loss: 4473824.4545; train_global_loss: 25324545.8788; train_optim_loss: 25324545.8788; val_kl_reg_loss: 78484.3779; val_edge_recon_loss: 614614.0000; val_gene_expr_recon_loss: 20129194.7500; val_masked_gp_l1_reg_loss: 117158.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93204.8516; val_chrom_access_recon_loss: 4551725.2500; val_global_loss: 25584380.0000; val_optim_loss: 25584380.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9242; val_auprc_score: 0.9049; val_best_acc_score: 0.8544; val_best_f1_score: 0.8633; train_kl_reg_loss: 77538.1512; train_edge_recon_loss: 607531.0312; train_gene_expr_recon_loss: 19876263.2424; train_masked_gp_l1_reg_loss: 117373.1735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92467.3902; train_chrom_access_recon_loss: 4456918.1667; train_global_loss: 25228091.1818; train_optim_loss: 25228091.1818; val_kl_reg_loss: 78516.7598; val_edge_recon_loss: 611069.4375; val_gene_expr_recon_loss: 20122721.2500; val_masked_gp_l1_reg_loss: 117695.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92134.7500; val_chrom_access_recon_loss: 4503701.5625; val_global_loss: 25525838.2500; val_optim_loss: 25525838.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9225; val_auprc_score: 0.9054; val_best_acc_score: 0.8498; val_best_f1_score: 0.8578; train_kl_reg_loss: 77007.1022; train_edge_recon_loss: 605272.8229; train_gene_expr_recon_loss: 19818335.2121; train_masked_gp_l1_reg_loss: 118002.1040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91675.1360; train_chrom_access_recon_loss: 4442918.1477; train_global_loss: 25153210.4848; train_optim_loss: 25153210.4848; val_kl_reg_loss: 77683.8945; val_edge_recon_loss: 613127.4219; val_gene_expr_recon_loss: 20014184.7500; val_masked_gp_l1_reg_loss: 118634.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91240.4922; val_chrom_access_recon_loss: 4476274.5625; val_global_loss: 25391144.5000; val_optim_loss: 25391144.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9298; val_auprc_score: 0.9134; val_best_acc_score: 0.8630; val_best_f1_score: 0.8704; train_kl_reg_loss: 76185.9738; train_edge_recon_loss: 604690.1544; train_gene_expr_recon_loss: 19776082.1818; train_masked_gp_l1_reg_loss: 118925.4663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90850.9742; train_chrom_access_recon_loss: 4428815.6515; train_global_loss: 25095550.6061; train_optim_loss: 25095550.6061; val_kl_reg_loss: 74967.6406; val_edge_recon_loss: 604585.4609; val_gene_expr_recon_loss: 19936303.5000; val_masked_gp_l1_reg_loss: 119080.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90786.2031; val_chrom_access_recon_loss: 4486159.0625; val_global_loss: 25311882.2500; val_optim_loss: 25311882.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9303; val_auprc_score: 0.9095; val_best_acc_score: 0.8619; val_best_f1_score: 0.8706; train_kl_reg_loss: 75391.2675; train_edge_recon_loss: 603218.4650; train_gene_expr_recon_loss: 19707773.0606; train_masked_gp_l1_reg_loss: 119692.5663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90060.7173; train_chrom_access_recon_loss: 4412663.9924; train_global_loss: 25008800.0606; train_optim_loss: 25008800.0606; val_kl_reg_loss: 75804.6084; val_edge_recon_loss: 604475.2031; val_gene_expr_recon_loss: 19796169.2500; val_masked_gp_l1_reg_loss: 120178.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89523.0234; val_chrom_access_recon_loss: 4452897.0625; val_global_loss: 25139048.2500; val_optim_loss: 25139048.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9315; val_auprc_score: 0.9142; val_best_acc_score: 0.8632; val_best_f1_score: 0.8706; train_kl_reg_loss: 75089.5877; train_edge_recon_loss: 602294.8826; train_gene_expr_recon_loss: 19655609.3939; train_masked_gp_l1_reg_loss: 120526.9422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89364.7380; train_chrom_access_recon_loss: 4392393.2765; train_global_loss: 24935278.6061; train_optim_loss: 24935278.6061; val_kl_reg_loss: 76639.6221; val_edge_recon_loss: 613303.7891; val_gene_expr_recon_loss: 19996870.2500; val_masked_gp_l1_reg_loss: 121192.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89207.8984; val_chrom_access_recon_loss: 4458414.4375; val_global_loss: 25355627.7500; val_optim_loss: 25355627.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9113; val_best_acc_score: 0.8689; val_best_f1_score: 0.8755; train_kl_reg_loss: 74516.4812; train_edge_recon_loss: 600410.1534; train_gene_expr_recon_loss: 19626832.7273; train_masked_gp_l1_reg_loss: 121527.2015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88504.0634; train_chrom_access_recon_loss: 4377729.4508; train_global_loss: 24889520.1818; train_optim_loss: 24889520.1818; val_kl_reg_loss: 72431.7607; val_edge_recon_loss: 605135.0156; val_gene_expr_recon_loss: 19774256.2500; val_masked_gp_l1_reg_loss: 122032.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88168.7344; val_chrom_access_recon_loss: 4483478.2500; val_global_loss: 25145501.5000; val_optim_loss: 25145501.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9350; val_auprc_score: 0.9192; val_best_acc_score: 0.8673; val_best_f1_score: 0.8719; train_kl_reg_loss: 73849.3075; train_edge_recon_loss: 597334.7206; train_gene_expr_recon_loss: 19547416.5758; train_masked_gp_l1_reg_loss: 122694.5724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87485.8446; train_chrom_access_recon_loss: 4355040.1667; train_global_loss: 24783821.5455; train_optim_loss: 24783821.5455; val_kl_reg_loss: 73322.9219; val_edge_recon_loss: 611251.2109; val_gene_expr_recon_loss: 19851783.2500; val_masked_gp_l1_reg_loss: 123296.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86935.9609; val_chrom_access_recon_loss: 4457404.0000; val_global_loss: 25203993.5000; val_optim_loss: 25203993.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9362; val_auprc_score: 0.9179; val_best_acc_score: 0.8767; val_best_f1_score: 0.8839; train_kl_reg_loss: 73343.7152; train_edge_recon_loss: 596809.8835; train_gene_expr_recon_loss: 19502001.4545; train_masked_gp_l1_reg_loss: 123766.3564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86279.9890; train_chrom_access_recon_loss: 4338441.5000; train_global_loss: 24720643.2121; train_optim_loss: 24720643.2121; val_kl_reg_loss: 73121.3701; val_edge_recon_loss: 602714.9297; val_gene_expr_recon_loss: 19662693.5000; val_masked_gp_l1_reg_loss: 124377.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86644.0547; val_chrom_access_recon_loss: 4414659.7500; val_global_loss: 24964211.7500; val_optim_loss: 24964211.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9435; val_auprc_score: 0.9298; val_best_acc_score: 0.8791; val_best_f1_score: 0.8823; train_kl_reg_loss: 72613.8832; train_edge_recon_loss: 596732.7538; train_gene_expr_recon_loss: 19445534.5758; train_masked_gp_l1_reg_loss: 124960.9555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85736.3245; train_chrom_access_recon_loss: 4321361.3409; train_global_loss: 24646939.8788; train_optim_loss: 24646939.8788; val_kl_reg_loss: 71610.5352; val_edge_recon_loss: 600539.2969; val_gene_expr_recon_loss: 19652020.0000; val_masked_gp_l1_reg_loss: 125720.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85067.9609; val_chrom_access_recon_loss: 4401573.8125; val_global_loss: 24936531.7500; val_optim_loss: 24936531.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9379; val_auprc_score: 0.9195; val_best_acc_score: 0.8783; val_best_f1_score: 0.8844; train_kl_reg_loss: 72235.5473; train_edge_recon_loss: 594557.5246; train_gene_expr_recon_loss: 19412717.6667; train_masked_gp_l1_reg_loss: 126289.3232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84741.7802; train_chrom_access_recon_loss: 4298593.4583; train_global_loss: 24589135.3636; train_optim_loss: 24589135.3636; val_kl_reg_loss: 72451.8545; val_edge_recon_loss: 599204.6719; val_gene_expr_recon_loss: 19442877.5000; val_masked_gp_l1_reg_loss: 126922.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84370.0156; val_chrom_access_recon_loss: 4330732.9375; val_global_loss: 24656558.7500; val_optim_loss: 24656558.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9391; val_auprc_score: 0.9094; val_best_acc_score: 0.8804; val_best_f1_score: 0.8864; train_kl_reg_loss: 72055.4259; train_edge_recon_loss: 595118.3731; train_gene_expr_recon_loss: 19366059.1515; train_masked_gp_l1_reg_loss: 127514.3861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83822.3377; train_chrom_access_recon_loss: 4281505.2614; train_global_loss: 24526074.6970; train_optim_loss: 24526074.6970; val_kl_reg_loss: 73055.5107; val_edge_recon_loss: 600231.9531; val_gene_expr_recon_loss: 19559209.5000; val_masked_gp_l1_reg_loss: 128279.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83945.2969; val_chrom_access_recon_loss: 4379710.8125; val_global_loss: 24824434.5000; val_optim_loss: 24824434.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8114; val_auprc_score: 0.8108; val_best_acc_score: 0.7053; val_best_f1_score: 0.7196; train_kl_reg_loss: 37127.2585; train_edge_recon_loss: 775485.7206; train_gene_expr_recon_loss: 18628383.6970; train_masked_gp_l1_reg_loss: 129114.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88670.3197; train_chrom_access_recon_loss: 4177151.2992; train_global_loss: 23835932.6061; train_optim_loss: 23835932.6061; val_kl_reg_loss: 10970.2322; val_edge_recon_loss: 801774.2422; val_gene_expr_recon_loss: 18274726.5000; val_masked_gp_l1_reg_loss: 134267.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97582.4453; val_chrom_access_recon_loss: 4137596.3125; val_global_loss: 23456917.5000; val_optim_loss: 23456917.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8139; val_auprc_score: 0.7961; val_best_acc_score: 0.7329; val_best_f1_score: 0.7224; train_kl_reg_loss: 17002.3984; train_edge_recon_loss: 786547.8362; train_gene_expr_recon_loss: 18094908.6364; train_masked_gp_l1_reg_loss: 132736.1886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96140.9210; train_chrom_access_recon_loss: 4091022.0379; train_global_loss: 23218357.7576; train_optim_loss: 23218357.7576; val_kl_reg_loss: 12934.1411; val_edge_recon_loss: 801228.2031; val_gene_expr_recon_loss: 18181554.0000; val_masked_gp_l1_reg_loss: 129719.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96968.9766; val_chrom_access_recon_loss: 4131472.6250; val_global_loss: 23353877.0000; val_optim_loss: 23353877.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8252; val_auprc_score: 0.8024; val_best_acc_score: 0.7440; val_best_f1_score: 0.7318; train_kl_reg_loss: 17345.1849; train_edge_recon_loss: 793038.9877; train_gene_expr_recon_loss: 17964091.6970; train_masked_gp_l1_reg_loss: 126228.8137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95482.9466; train_chrom_access_recon_loss: 4073966.1439; train_global_loss: 23070154.1212; train_optim_loss: 23070154.1212; val_kl_reg_loss: 15287.8870; val_edge_recon_loss: 798291.7266; val_gene_expr_recon_loss: 18167081.5000; val_masked_gp_l1_reg_loss: 121969.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94358.5547; val_chrom_access_recon_loss: 4109360.3438; val_global_loss: 23306349.5000; val_optim_loss: 23306349.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8287; val_auprc_score: 0.8110; val_best_acc_score: 0.7391; val_best_f1_score: 0.7311; train_kl_reg_loss: 17909.5189; train_edge_recon_loss: 787862.9678; train_gene_expr_recon_loss: 17930141.0303; train_masked_gp_l1_reg_loss: 119441.7958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93640.5734; train_chrom_access_recon_loss: 4081583.9015; train_global_loss: 23030579.9394; train_optim_loss: 23030579.9394; val_kl_reg_loss: 15558.2754; val_edge_recon_loss: 796197.9141; val_gene_expr_recon_loss: 18045316.0000; val_masked_gp_l1_reg_loss: 116741.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93459.0625; val_chrom_access_recon_loss: 4139647.9062; val_global_loss: 23206921.5000; val_optim_loss: 23206921.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8315; val_auprc_score: 0.8061; val_best_acc_score: 0.7257; val_best_f1_score: 0.7640; train_kl_reg_loss: 18522.5689; train_edge_recon_loss: 781422.8447; train_gene_expr_recon_loss: 17850916.6970; train_masked_gp_l1_reg_loss: 114106.8435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92567.8445; train_chrom_access_recon_loss: 4058027.2121; train_global_loss: 22915563.9091; train_optim_loss: 22915563.9091; val_kl_reg_loss: 15791.8986; val_edge_recon_loss: 789832.7188; val_gene_expr_recon_loss: 18061559.2500; val_masked_gp_l1_reg_loss: 112353.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93255.4141; val_chrom_access_recon_loss: 4116071.0000; val_global_loss: 23188865.0000; val_optim_loss: 23188865.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8281; val_auprc_score: 0.8058; val_best_acc_score: 0.7233; val_best_f1_score: 0.7686; train_kl_reg_loss: 17947.1951; train_edge_recon_loss: 784699.5777; train_gene_expr_recon_loss: 17821792.4242; train_masked_gp_l1_reg_loss: 110826.2006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93651.5604; train_chrom_access_recon_loss: 4048660.6439; train_global_loss: 22877577.6667; train_optim_loss: 22877577.6667; val_kl_reg_loss: 16948.1536; val_edge_recon_loss: 790738.4453; val_gene_expr_recon_loss: 18060864.7500; val_masked_gp_l1_reg_loss: 108672.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92957.0859; val_chrom_access_recon_loss: 4092647.7812; val_global_loss: 23162829.2500; val_optim_loss: 23162829.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8346; val_auprc_score: 0.8131; val_best_acc_score: 0.7491; val_best_f1_score: 0.7832; train_kl_reg_loss: 19725.6806; train_edge_recon_loss: 774112.9328; train_gene_expr_recon_loss: 17798834.8485; train_masked_gp_l1_reg_loss: 107054.0671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92826.4659; train_chrom_access_recon_loss: 4043675.2273; train_global_loss: 22836229.5152; train_optim_loss: 22836229.5152; val_kl_reg_loss: 18067.0688; val_edge_recon_loss: 783990.5078; val_gene_expr_recon_loss: 17865280.5000; val_masked_gp_l1_reg_loss: 105978.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94992.4609; val_chrom_access_recon_loss: 4077277.6250; val_global_loss: 22945586.2500; val_optim_loss: 22945586.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8452; val_auprc_score: 0.8102; val_best_acc_score: 0.7641; val_best_f1_score: 0.7965; train_kl_reg_loss: 22736.6251; train_edge_recon_loss: 760793.5928; train_gene_expr_recon_loss: 17791310.0606; train_masked_gp_l1_reg_loss: 104469.6940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93536.6527; train_chrom_access_recon_loss: 4036782.0000; train_global_loss: 22809628.6364; train_optim_loss: 22809628.6364; val_kl_reg_loss: 18600.8521; val_edge_recon_loss: 782879.8984; val_gene_expr_recon_loss: 17987118.2500; val_masked_gp_l1_reg_loss: 103823.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93349.1328; val_chrom_access_recon_loss: 4091333.2812; val_global_loss: 23077106.2500; val_optim_loss: 23077106.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8490; val_auprc_score: 0.8150; val_best_acc_score: 0.7792; val_best_f1_score: 0.8022; train_kl_reg_loss: 26599.4512; train_edge_recon_loss: 745344.9328; train_gene_expr_recon_loss: 17739448.5455; train_masked_gp_l1_reg_loss: 102908.2469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92057.8136; train_chrom_access_recon_loss: 4027918.9735; train_global_loss: 22734278.0000; train_optim_loss: 22734278.0000; val_kl_reg_loss: 29312.4563; val_edge_recon_loss: 776186.4609; val_gene_expr_recon_loss: 17971633.5000; val_masked_gp_l1_reg_loss: 101475.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90391.9609; val_chrom_access_recon_loss: 4102724.2812; val_global_loss: 23071724.7500; val_optim_loss: 23071724.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8461; val_auprc_score: 0.8090; val_best_acc_score: 0.7792; val_best_f1_score: 0.8042; train_kl_reg_loss: 23281.1172; train_edge_recon_loss: 764422.5426; train_gene_expr_recon_loss: 17718207.4242; train_masked_gp_l1_reg_loss: 100844.4750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89918.0593; train_chrom_access_recon_loss: 4031402.1818; train_global_loss: 22728075.8182; train_optim_loss: 22728075.8182; val_kl_reg_loss: 17641.5479; val_edge_recon_loss: 777944.0703; val_gene_expr_recon_loss: 18100662.5000; val_masked_gp_l1_reg_loss: 100873.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90869.7812; val_chrom_access_recon_loss: 4108268.4375; val_global_loss: 23196260.2500; val_optim_loss: 23196260.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8498; val_auprc_score: 0.8101; val_best_acc_score: 0.7797; val_best_f1_score: 0.8016; train_kl_reg_loss: 20575.3198; train_edge_recon_loss: 769020.9223; train_gene_expr_recon_loss: 17724859.8182; train_masked_gp_l1_reg_loss: 99543.6397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89706.2874; train_chrom_access_recon_loss: 4026026.8258; train_global_loss: 22729732.6970; train_optim_loss: 22729732.6970; val_kl_reg_loss: 19201.3906; val_edge_recon_loss: 769405.6406; val_gene_expr_recon_loss: 17910009.2500; val_masked_gp_l1_reg_loss: 98263.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88917.2344; val_chrom_access_recon_loss: 4059870.7500; val_global_loss: 22945669.2500; val_optim_loss: 22945669.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8587; val_auprc_score: 0.8259; val_best_acc_score: 0.7907; val_best_f1_score: 0.8078; train_kl_reg_loss: 21549.5683; train_edge_recon_loss: 765441.6184; train_gene_expr_recon_loss: 17665721.2727; train_masked_gp_l1_reg_loss: 95556.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76580.3236; train_chrom_access_recon_loss: 4015813.1326; train_global_loss: 22640662.7879; train_optim_loss: 22640662.7879; val_kl_reg_loss: 19385.2251; val_edge_recon_loss: 766767.3438; val_gene_expr_recon_loss: 17915583.2500; val_masked_gp_l1_reg_loss: 94615.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73907.8594; val_chrom_access_recon_loss: 4058327.2188; val_global_loss: 22928587.0000; val_optim_loss: 22928587.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8586; val_auprc_score: 0.8215; val_best_acc_score: 0.7966; val_best_f1_score: 0.8130; train_kl_reg_loss: 21678.6825; train_edge_recon_loss: 764034.1638; train_gene_expr_recon_loss: 17658500.2879; train_masked_gp_l1_reg_loss: 94347.7257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73558.6096; train_chrom_access_recon_loss: 4016826.1932; train_global_loss: 22628945.7576; train_optim_loss: 22628945.7576; val_kl_reg_loss: 19575.4270; val_edge_recon_loss: 765749.9375; val_gene_expr_recon_loss: 17833392.5000; val_masked_gp_l1_reg_loss: 94162.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73249.8359; val_chrom_access_recon_loss: 4061665.1250; val_global_loss: 22847795.2500; val_optim_loss: 22847795.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8631; val_auprc_score: 0.8329; val_best_acc_score: 0.7929; val_best_f1_score: 0.8115; train_kl_reg_loss: 21816.7549; train_edge_recon_loss: 761542.0047; train_gene_expr_recon_loss: 17659065.6061; train_masked_gp_l1_reg_loss: 93974.3923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73041.3836; train_chrom_access_recon_loss: 4015904.4091; train_global_loss: 22625344.6364; train_optim_loss: 22625344.6364; val_kl_reg_loss: 19601.8162; val_edge_recon_loss: 763813.2500; val_gene_expr_recon_loss: 17741416.5000; val_masked_gp_l1_reg_loss: 93766.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72842.8125; val_chrom_access_recon_loss: 4037494.2812; val_global_loss: 22728933.7500; val_optim_loss: 22728933.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8622; val_auprc_score: 0.8230; val_best_acc_score: 0.7896; val_best_f1_score: 0.8105; train_kl_reg_loss: 21798.6287; train_edge_recon_loss: 757266.7178; train_gene_expr_recon_loss: 17664664.3939; train_masked_gp_l1_reg_loss: 93665.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72773.6482; train_chrom_access_recon_loss: 4018973.3561; train_global_loss: 22629141.9091; train_optim_loss: 22629141.9091; val_kl_reg_loss: 19261.3418; val_edge_recon_loss: 767407.5156; val_gene_expr_recon_loss: 17698225.5000; val_masked_gp_l1_reg_loss: 93647.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72821.7656; val_chrom_access_recon_loss: 4038484.5000; val_global_loss: 22689849.0000; val_optim_loss: 22689849.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8654; val_auprc_score: 0.8377; val_best_acc_score: 0.7947; val_best_f1_score: 0.8108; train_kl_reg_loss: 21877.8747; train_edge_recon_loss: 756804.2860; train_gene_expr_recon_loss: 17656057.3333; train_masked_gp_l1_reg_loss: 93503.8207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72679.1799; train_chrom_access_recon_loss: 4014562.6061; train_global_loss: 22615485.0909; train_optim_loss: 22615485.0909; val_kl_reg_loss: 19098.5620; val_edge_recon_loss: 767867.3828; val_gene_expr_recon_loss: 17897102.0000; val_masked_gp_l1_reg_loss: 93468.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72733.2188; val_chrom_access_recon_loss: 4062248.9062; val_global_loss: 22912518.5000; val_optim_loss: 22912518.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8557; val_auprc_score: 0.8108; val_best_acc_score: 0.7886; val_best_f1_score: 0.8062; train_kl_reg_loss: 22064.4486; train_edge_recon_loss: 759200.6241; train_gene_expr_recon_loss: 17656240.2121; train_masked_gp_l1_reg_loss: 93383.3649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72701.5775; train_chrom_access_recon_loss: 4021315.2689; train_global_loss: 22624905.3333; train_optim_loss: 22624905.3333; val_kl_reg_loss: 20072.3770; val_edge_recon_loss: 765473.6953; val_gene_expr_recon_loss: 17923786.7500; val_masked_gp_l1_reg_loss: 93248.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72584.1797; val_chrom_access_recon_loss: 4051750.4688; val_global_loss: 22926915.2500; val_optim_loss: 22926915.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8481; val_auprc_score: 0.8097; val_best_acc_score: 0.7800; val_best_f1_score: 0.8002; train_kl_reg_loss: 21551.1348; train_edge_recon_loss: 760810.3769; train_gene_expr_recon_loss: 17665791.0606; train_masked_gp_l1_reg_loss: 93235.1190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72599.1652; train_chrom_access_recon_loss: 4018470.7386; train_global_loss: 22632457.4848; train_optim_loss: 22632457.4848; val_kl_reg_loss: 19072.3777; val_edge_recon_loss: 769605.8672; val_gene_expr_recon_loss: 17840414.2500; val_masked_gp_l1_reg_loss: 93214.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72550.1328; val_chrom_access_recon_loss: 4081540.1250; val_global_loss: 22876396.7500; val_optim_loss: 22876396.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8668; val_auprc_score: 0.8373; val_best_acc_score: 0.7963; val_best_f1_score: 0.8117; train_kl_reg_loss: 21932.3235; train_edge_recon_loss: 758245.8030; train_gene_expr_recon_loss: 17647252.1818; train_masked_gp_l1_reg_loss: 93076.6210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72456.1953; train_chrom_access_recon_loss: 4015442.5833; train_global_loss: 22608405.9091; train_optim_loss: 22608405.9091; val_kl_reg_loss: 19037.2512; val_edge_recon_loss: 766766.2891; val_gene_expr_recon_loss: 17818882.5000; val_masked_gp_l1_reg_loss: 92992.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72386.5234; val_chrom_access_recon_loss: 4073251.5625; val_global_loss: 22843316.0000; val_optim_loss: 22843316.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8491; val_auprc_score: 0.8128; val_best_acc_score: 0.7775; val_best_f1_score: 0.8016; train_kl_reg_loss: 21520.4040; train_edge_recon_loss: 758442.9328; train_gene_expr_recon_loss: 17634514.3788; train_masked_gp_l1_reg_loss: 92709.5619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71106.1020; train_chrom_access_recon_loss: 4011820.4962; train_global_loss: 22590113.6970; train_optim_loss: 22590113.6970; val_kl_reg_loss: 19153.6943; val_edge_recon_loss: 768370.2812; val_gene_expr_recon_loss: 17768343.0000; val_masked_gp_l1_reg_loss: 92600.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70838.3672; val_chrom_access_recon_loss: 4072119.6562; val_global_loss: 22791424.7500; val_optim_loss: 22791424.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8601; val_auprc_score: 0.8216; val_best_acc_score: 0.7934; val_best_f1_score: 0.8096; train_kl_reg_loss: 21643.1784; train_edge_recon_loss: 758792.0417; train_gene_expr_recon_loss: 17631829.7879; train_masked_gp_l1_reg_loss: 92561.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70794.1109; train_chrom_access_recon_loss: 4017090.0189; train_global_loss: 22592710.3030; train_optim_loss: 22592710.3030; val_kl_reg_loss: 19359.3333; val_edge_recon_loss: 765305.5625; val_gene_expr_recon_loss: 17951999.0000; val_masked_gp_l1_reg_loss: 92532.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70757.9531; val_chrom_access_recon_loss: 4071388.9375; val_global_loss: 22971342.7500; val_optim_loss: 22971342.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8572; val_auprc_score: 0.8169; val_best_acc_score: 0.7912; val_best_f1_score: 0.8077; train_kl_reg_loss: 21694.7285; train_edge_recon_loss: 757978.8447; train_gene_expr_recon_loss: 17634883.8182; train_masked_gp_l1_reg_loss: 92513.0436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70731.1914; train_chrom_access_recon_loss: 4016179.6212; train_global_loss: 22593981.0909; train_optim_loss: 22593981.0909; val_kl_reg_loss: 19252.4590; val_edge_recon_loss: 767347.5312; val_gene_expr_recon_loss: 17723763.7500; val_masked_gp_l1_reg_loss: 92496.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70705.3828; val_chrom_access_recon_loss: 4044924.4375; val_global_loss: 22718490.0000; val_optim_loss: 22718490.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8591; val_auprc_score: 0.8206; val_best_acc_score: 0.7966; val_best_f1_score: 0.8118; train_kl_reg_loss: 21739.7043; train_edge_recon_loss: 757993.6184; train_gene_expr_recon_loss: 17633851.3939; train_masked_gp_l1_reg_loss: 92481.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70687.0646; train_chrom_access_recon_loss: 4012291.3902; train_global_loss: 22589044.6061; train_optim_loss: 22589044.6061; val_kl_reg_loss: 19360.5735; val_edge_recon_loss: 764077.9062; val_gene_expr_recon_loss: 17839826.7500; val_masked_gp_l1_reg_loss: 92463.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70665.5703; val_chrom_access_recon_loss: 4085351.8750; val_global_loss: 22871746.7500; val_optim_loss: 22871746.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 27 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.8624
val AUPRC score: 0.8267
val best accuracy score: 0.7945
val best F1 score: 0.8163
val target rna MSE score: 1.7480
val source rna MSE score: 1.2913
val target atac MSE score: 0.4914
val source atac MSE score: 0.2099
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
