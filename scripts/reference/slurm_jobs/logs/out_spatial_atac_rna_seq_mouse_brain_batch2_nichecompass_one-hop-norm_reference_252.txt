[True]
Run timestamp: 07092023_033455_252.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_252']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3385 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7888, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6302; val_auprc_score: 0.6307; val_best_acc_score: 0.5043; val_best_f1_score: 0.6682; train_kl_reg_loss: 67144.2845; train_edge_recon_loss: 3568165.8295; train_gene_expr_recon_loss: 16895925.9091; train_masked_gp_l1_reg_loss: 48065.8062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9855958.6894; train_chrom_access_recon_loss: 14853910.9545; train_global_loss: 45289171.5152; train_optim_loss: 45289171.5152; val_kl_reg_loss: 95633.3467; val_edge_recon_loss: 4065190.4062; val_gene_expr_recon_loss: 15300970.3750; val_masked_gp_l1_reg_loss: 44989.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3436361.7500; val_chrom_access_recon_loss: 14430357.3750; val_global_loss: 37373503.0000; val_optim_loss: 37373503.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6374; val_auprc_score: 0.6271; val_best_acc_score: 0.5373; val_best_f1_score: 0.6784; train_kl_reg_loss: 136258.2019; train_edge_recon_loss: 3550575.2803; train_gene_expr_recon_loss: 14910989.4394; train_masked_gp_l1_reg_loss: 41164.3882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1237667.8149; train_chrom_access_recon_loss: 14101174.7424; train_global_loss: 33977829.6364; train_optim_loss: 33977829.6364; val_kl_reg_loss: 127738.2451; val_edge_recon_loss: 4063198.0000; val_gene_expr_recon_loss: 14579570.1250; val_masked_gp_l1_reg_loss: 38810.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 402392.9062; val_chrom_access_recon_loss: 14052766.2500; val_global_loss: 33264474.5000; val_optim_loss: 33264474.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7051; val_auprc_score: 0.6951; val_best_acc_score: 0.5930; val_best_f1_score: 0.6896; train_kl_reg_loss: 128684.0024; train_edge_recon_loss: 3539093.8598; train_gene_expr_recon_loss: 14644012.8788; train_masked_gp_l1_reg_loss: 38358.3803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 297494.9493; train_chrom_access_recon_loss: 13996727.9545; train_global_loss: 32644372.0606; train_optim_loss: 32644372.0606; val_kl_reg_loss: 115920.8154; val_edge_recon_loss: 4056116.2500; val_gene_expr_recon_loss: 14379047.2500; val_masked_gp_l1_reg_loss: 38408.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238418.0938; val_chrom_access_recon_loss: 13935937.5000; val_global_loss: 32763847.7500; val_optim_loss: 32763847.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7944; val_auprc_score: 0.7793; val_best_acc_score: 0.7195; val_best_f1_score: 0.7106; train_kl_reg_loss: 117140.1946; train_edge_recon_loss: 3525899.2614; train_gene_expr_recon_loss: 14519049.1061; train_masked_gp_l1_reg_loss: 39223.1167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216334.5104; train_chrom_access_recon_loss: 13899632.8030; train_global_loss: 32317278.8788; train_optim_loss: 32317278.8788; val_kl_reg_loss: 111785.5312; val_edge_recon_loss: 4009314.8438; val_gene_expr_recon_loss: 14303536.6250; val_masked_gp_l1_reg_loss: 40400.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 198733.6562; val_chrom_access_recon_loss: 13960138.6250; val_global_loss: 32623909.2500; val_optim_loss: 32623909.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8495; val_auprc_score: 0.8245; val_best_acc_score: 0.7732; val_best_f1_score: 0.7884; train_kl_reg_loss: 102003.7095; train_edge_recon_loss: 3499863.3447; train_gene_expr_recon_loss: 14417617.6515; train_masked_gp_l1_reg_loss: 41635.2890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188479.7334; train_chrom_access_recon_loss: 13803209.0000; train_global_loss: 32052808.6667; train_optim_loss: 32052808.6667; val_kl_reg_loss: 91974.4629; val_edge_recon_loss: 3750945.3438; val_gene_expr_recon_loss: 14288907.0000; val_masked_gp_l1_reg_loss: 42947.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179912.5312; val_chrom_access_recon_loss: 13939355.6250; val_global_loss: 32294042.2500; val_optim_loss: 32294042.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8383; val_auprc_score: 0.8061; val_best_acc_score: 0.7579; val_best_f1_score: 0.7868; train_kl_reg_loss: 87195.3112; train_edge_recon_loss: 3254652.2386; train_gene_expr_recon_loss: 14372822.3485; train_masked_gp_l1_reg_loss: 44503.0460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174591.0734; train_chrom_access_recon_loss: 13738695.1364; train_global_loss: 31672459.2121; train_optim_loss: 31672459.2121; val_kl_reg_loss: 96877.0625; val_edge_recon_loss: 3135748.4062; val_gene_expr_recon_loss: 14368949.0000; val_masked_gp_l1_reg_loss: 46712.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171890.7500; val_chrom_access_recon_loss: 13789679.2500; val_global_loss: 31609855.7500; val_optim_loss: 31609855.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8436; val_auprc_score: 0.8059; val_best_acc_score: 0.7598; val_best_f1_score: 0.7886; train_kl_reg_loss: 110326.5922; train_edge_recon_loss: 3039511.2841; train_gene_expr_recon_loss: 14351488.0152; train_masked_gp_l1_reg_loss: 48907.3825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172327.8033; train_chrom_access_recon_loss: 13716935.1061; train_global_loss: 31439496.1818; train_optim_loss: 31439496.1818; val_kl_reg_loss: 120651.9316; val_edge_recon_loss: 3007681.9688; val_gene_expr_recon_loss: 14119970.6250; val_masked_gp_l1_reg_loss: 50161.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163506.1875; val_chrom_access_recon_loss: 13603110.6250; val_global_loss: 31065082.7500; val_optim_loss: 31065082.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8406; val_auprc_score: 0.8014; val_best_acc_score: 0.7620; val_best_f1_score: 0.7898; train_kl_reg_loss: 129599.9940; train_edge_recon_loss: 2990680.9621; train_gene_expr_recon_loss: 14236631.4697; train_masked_gp_l1_reg_loss: 50469.6940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156144.8075; train_chrom_access_recon_loss: 13605353.1364; train_global_loss: 31168880.0606; train_optim_loss: 31168880.0606; val_kl_reg_loss: 129318.8691; val_edge_recon_loss: 2986391.6250; val_gene_expr_recon_loss: 14177024.7500; val_masked_gp_l1_reg_loss: 51106.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150350.8750; val_chrom_access_recon_loss: 13715379.2500; val_global_loss: 31209570.7500; val_optim_loss: 31209570.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8507; val_auprc_score: 0.8235; val_best_acc_score: 0.7649; val_best_f1_score: 0.7874; train_kl_reg_loss: 126846.1900; train_edge_recon_loss: 2957245.6061; train_gene_expr_recon_loss: 14165734.6970; train_masked_gp_l1_reg_loss: 51743.5916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148152.6854; train_chrom_access_recon_loss: 13553007.4242; train_global_loss: 31002730.0303; train_optim_loss: 31002730.0303; val_kl_reg_loss: 127236.1416; val_edge_recon_loss: 3020413.8125; val_gene_expr_recon_loss: 13966938.5000; val_masked_gp_l1_reg_loss: 52517.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146311.2812; val_chrom_access_recon_loss: 13420637.2500; val_global_loss: 30734055.5000; val_optim_loss: 30734055.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8672; val_auprc_score: 0.8381; val_best_acc_score: 0.7859; val_best_f1_score: 0.8027; train_kl_reg_loss: 122431.9943; train_edge_recon_loss: 2958955.8523; train_gene_expr_recon_loss: 14083864.8636; train_masked_gp_l1_reg_loss: 53126.4794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144220.0384; train_chrom_access_recon_loss: 13469820.4091; train_global_loss: 30832419.5152; train_optim_loss: 30832419.5152; val_kl_reg_loss: 120223.6572; val_edge_recon_loss: 2913643.2812; val_gene_expr_recon_loss: 13884258.7500; val_masked_gp_l1_reg_loss: 53784.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142083.8281; val_chrom_access_recon_loss: 13387620.5000; val_global_loss: 30501614.5000; val_optim_loss: 30501614.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8742; val_auprc_score: 0.8412; val_best_acc_score: 0.7980; val_best_f1_score: 0.8131; train_kl_reg_loss: 118350.8068; train_edge_recon_loss: 2938882.2008; train_gene_expr_recon_loss: 14032262.1667; train_masked_gp_l1_reg_loss: 54354.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140928.2109; train_chrom_access_recon_loss: 13432515.0303; train_global_loss: 30717292.6364; train_optim_loss: 30717292.6364; val_kl_reg_loss: 112305.4346; val_edge_recon_loss: 2982022.7500; val_gene_expr_recon_loss: 13895165.6250; val_masked_gp_l1_reg_loss: 55080.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140037.3750; val_chrom_access_recon_loss: 13353301.5000; val_global_loss: 30537913.2500; val_optim_loss: 30537913.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8852; val_auprc_score: 0.8583; val_best_acc_score: 0.8092; val_best_f1_score: 0.8229; train_kl_reg_loss: 113116.0143; train_edge_recon_loss: 2919683.5871; train_gene_expr_recon_loss: 13986243.6667; train_masked_gp_l1_reg_loss: 55579.2247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138508.6141; train_chrom_access_recon_loss: 13384439.8485; train_global_loss: 30597570.9091; train_optim_loss: 30597570.9091; val_kl_reg_loss: 112363.2100; val_edge_recon_loss: 2941451.4688; val_gene_expr_recon_loss: 13879526.5000; val_masked_gp_l1_reg_loss: 56195.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137595.6719; val_chrom_access_recon_loss: 13545571.2500; val_global_loss: 30672704.5000; val_optim_loss: 30672704.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8866; val_auprc_score: 0.8495; val_best_acc_score: 0.8184; val_best_f1_score: 0.8323; train_kl_reg_loss: 110951.7406; train_edge_recon_loss: 2891281.8295; train_gene_expr_recon_loss: 13940284.1515; train_masked_gp_l1_reg_loss: 56797.5040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136680.2540; train_chrom_access_recon_loss: 13347866.6818; train_global_loss: 30483861.8182; train_optim_loss: 30483861.8182; val_kl_reg_loss: 110315.9492; val_edge_recon_loss: 2886910.6875; val_gene_expr_recon_loss: 13965251.5000; val_masked_gp_l1_reg_loss: 57414.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135936.6719; val_chrom_access_recon_loss: 13445389.2500; val_global_loss: 30601217.5000; val_optim_loss: 30601217.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8950; val_auprc_score: 0.8618; val_best_acc_score: 0.8235; val_best_f1_score: 0.8390; train_kl_reg_loss: 112673.6676; train_edge_recon_loss: 2856404.0492; train_gene_expr_recon_loss: 13904344.6818; train_masked_gp_l1_reg_loss: 57967.1810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135302.8885; train_chrom_access_recon_loss: 13301273.5758; train_global_loss: 30367966.0909; train_optim_loss: 30367966.0909; val_kl_reg_loss: 114941.7598; val_edge_recon_loss: 2859652.9062; val_gene_expr_recon_loss: 13755756.3750; val_masked_gp_l1_reg_loss: 58593.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134792.5938; val_chrom_access_recon_loss: 13370488.6250; val_global_loss: 30294225.7500; val_optim_loss: 30294225.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8973; val_auprc_score: 0.8635; val_best_acc_score: 0.8318; val_best_f1_score: 0.8439; train_kl_reg_loss: 112112.4415; train_edge_recon_loss: 2837098.2235; train_gene_expr_recon_loss: 13853578.4697; train_masked_gp_l1_reg_loss: 59140.3370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134407.5578; train_chrom_access_recon_loss: 13240907.7727; train_global_loss: 30237244.7273; train_optim_loss: 30237244.7273; val_kl_reg_loss: 112721.7080; val_edge_recon_loss: 2854716.1250; val_gene_expr_recon_loss: 13800121.8750; val_masked_gp_l1_reg_loss: 59710.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134401.1250; val_chrom_access_recon_loss: 13294255.3750; val_global_loss: 30255927.2500; val_optim_loss: 30255927.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9066; val_auprc_score: 0.8761; val_best_acc_score: 0.8404; val_best_f1_score: 0.8535; train_kl_reg_loss: 112404.8552; train_edge_recon_loss: 2832102.3523; train_gene_expr_recon_loss: 13815194.1061; train_masked_gp_l1_reg_loss: 60170.6403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133985.2673; train_chrom_access_recon_loss: 13204471.8636; train_global_loss: 30158329.2121; train_optim_loss: 30158329.2121; val_kl_reg_loss: 108113.5938; val_edge_recon_loss: 2843087.8438; val_gene_expr_recon_loss: 13614899.0000; val_masked_gp_l1_reg_loss: 60544.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133977.8438; val_chrom_access_recon_loss: 13200366.8750; val_global_loss: 29960989.5000; val_optim_loss: 29960989.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9081; val_auprc_score: 0.8733; val_best_acc_score: 0.8428; val_best_f1_score: 0.8560; train_kl_reg_loss: 111832.5624; train_edge_recon_loss: 2816317.0189; train_gene_expr_recon_loss: 13770457.1970; train_masked_gp_l1_reg_loss: 61158.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133424.6607; train_chrom_access_recon_loss: 13166513.6061; train_global_loss: 30059703.2121; train_optim_loss: 30059703.2121; val_kl_reg_loss: 114463.4561; val_edge_recon_loss: 2841131.8438; val_gene_expr_recon_loss: 13671547.6250; val_masked_gp_l1_reg_loss: 61647.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133422.3906; val_chrom_access_recon_loss: 13221167.6250; val_global_loss: 30043380.5000; val_optim_loss: 30043380.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9178; val_auprc_score: 0.8895; val_best_acc_score: 0.8536; val_best_f1_score: 0.8639; train_kl_reg_loss: 111506.0372; train_edge_recon_loss: 2799377.9356; train_gene_expr_recon_loss: 13747952.0758; train_masked_gp_l1_reg_loss: 62075.6655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133082.3928; train_chrom_access_recon_loss: 13139354.8939; train_global_loss: 29993348.6667; train_optim_loss: 29993348.6667; val_kl_reg_loss: 109299.3584; val_edge_recon_loss: 2818134.7500; val_gene_expr_recon_loss: 13703352.7500; val_masked_gp_l1_reg_loss: 62491.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133095.7812; val_chrom_access_recon_loss: 13224830.8750; val_global_loss: 30051205.5000; val_optim_loss: 30051205.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9162; val_auprc_score: 0.8880; val_best_acc_score: 0.8560; val_best_f1_score: 0.8659; train_kl_reg_loss: 111114.4220; train_edge_recon_loss: 2800203.2121; train_gene_expr_recon_loss: 13703081.9242; train_masked_gp_l1_reg_loss: 62913.3654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132363.3047; train_chrom_access_recon_loss: 13085718.1061; train_global_loss: 29895394.3333; train_optim_loss: 29895394.3333; val_kl_reg_loss: 115083.9404; val_edge_recon_loss: 2806551.3438; val_gene_expr_recon_loss: 13636560.5000; val_masked_gp_l1_reg_loss: 63270.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132279.4844; val_chrom_access_recon_loss: 13126581.2500; val_global_loss: 29880326.5000; val_optim_loss: 29880326.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8832; val_best_acc_score: 0.8600; val_best_f1_score: 0.8695; train_kl_reg_loss: 110384.5799; train_edge_recon_loss: 2788715.7955; train_gene_expr_recon_loss: 13677173.5000; train_masked_gp_l1_reg_loss: 63724.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132331.5140; train_chrom_access_recon_loss: 13063406.1818; train_global_loss: 29835736.0000; train_optim_loss: 29835736.0000; val_kl_reg_loss: 110808.4053; val_edge_recon_loss: 2806668.5000; val_gene_expr_recon_loss: 13449135.2500; val_masked_gp_l1_reg_loss: 64096.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132167.2031; val_chrom_access_recon_loss: 12989339.7500; val_global_loss: 29552216.0000; val_optim_loss: 29552216.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9201; val_auprc_score: 0.8917; val_best_acc_score: 0.8565; val_best_f1_score: 0.8690; train_kl_reg_loss: 109614.9753; train_edge_recon_loss: 2777800.6515; train_gene_expr_recon_loss: 13653219.1364; train_masked_gp_l1_reg_loss: 64502.4376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132024.3688; train_chrom_access_recon_loss: 13029472.1364; train_global_loss: 29766633.6970; train_optim_loss: 29766633.6970; val_kl_reg_loss: 113242.1816; val_edge_recon_loss: 2763821.7812; val_gene_expr_recon_loss: 13560383.5000; val_masked_gp_l1_reg_loss: 64933.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131658.7969; val_chrom_access_recon_loss: 13228000.2500; val_global_loss: 29862040.2500; val_optim_loss: 29862040.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9200; val_auprc_score: 0.8934; val_best_acc_score: 0.8576; val_best_f1_score: 0.8676; train_kl_reg_loss: 109654.4441; train_edge_recon_loss: 2766672.7008; train_gene_expr_recon_loss: 13608258.2121; train_masked_gp_l1_reg_loss: 65303.2914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131714.3823; train_chrom_access_recon_loss: 12998007.0152; train_global_loss: 29679610.2121; train_optim_loss: 29679610.2121; val_kl_reg_loss: 109151.0361; val_edge_recon_loss: 2847141.3438; val_gene_expr_recon_loss: 13523984.2500; val_masked_gp_l1_reg_loss: 65655.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131316.4375; val_chrom_access_recon_loss: 12962735.5000; val_global_loss: 29639983.7500; val_optim_loss: 29639983.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9281; val_auprc_score: 0.9046; val_best_acc_score: 0.8638; val_best_f1_score: 0.8732; train_kl_reg_loss: 108803.0198; train_edge_recon_loss: 2766213.9053; train_gene_expr_recon_loss: 13588132.1818; train_masked_gp_l1_reg_loss: 65979.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131426.6224; train_chrom_access_recon_loss: 12962562.2424; train_global_loss: 29623117.8485; train_optim_loss: 29623117.8485; val_kl_reg_loss: 110223.9365; val_edge_recon_loss: 2778998.4375; val_gene_expr_recon_loss: 13544046.5000; val_masked_gp_l1_reg_loss: 66328.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131595.8906; val_chrom_access_recon_loss: 13110555.6250; val_global_loss: 29741749.0000; val_optim_loss: 29741749.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9229; val_auprc_score: 0.9002; val_best_acc_score: 0.8649; val_best_f1_score: 0.8716; train_kl_reg_loss: 108807.6535; train_edge_recon_loss: 2770860.2386; train_gene_expr_recon_loss: 13556247.7576; train_masked_gp_l1_reg_loss: 66652.0878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131245.6121; train_chrom_access_recon_loss: 12933067.4545; train_global_loss: 29566880.9697; train_optim_loss: 29566880.9697; val_kl_reg_loss: 106337.9463; val_edge_recon_loss: 2810430.5938; val_gene_expr_recon_loss: 13523753.7500; val_masked_gp_l1_reg_loss: 67059.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130983.8594; val_chrom_access_recon_loss: 13028342.3750; val_global_loss: 29666908.5000; val_optim_loss: 29666908.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9303; val_auprc_score: 0.9081; val_best_acc_score: 0.8651; val_best_f1_score: 0.8745; train_kl_reg_loss: 109206.6146; train_edge_recon_loss: 2753070.4508; train_gene_expr_recon_loss: 13530329.5455; train_masked_gp_l1_reg_loss: 66171.3962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96202.6900; train_chrom_access_recon_loss: 12896212.4545; train_global_loss: 29451192.9697; train_optim_loss: 29451192.9697; val_kl_reg_loss: 109498.9375; val_edge_recon_loss: 2786868.5000; val_gene_expr_recon_loss: 13604303.5000; val_masked_gp_l1_reg_loss: 65649.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89838.0859; val_chrom_access_recon_loss: 13081984.7500; val_global_loss: 29738143.5000; val_optim_loss: 29738143.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9290; val_auprc_score: 0.9044; val_best_acc_score: 0.8643; val_best_f1_score: 0.8738; train_kl_reg_loss: 110146.6906; train_edge_recon_loss: 2756576.6818; train_gene_expr_recon_loss: 13537936.6818; train_masked_gp_l1_reg_loss: 65534.8233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89522.8024; train_chrom_access_recon_loss: 12898753.6515; train_global_loss: 29458471.1212; train_optim_loss: 29458471.1212; val_kl_reg_loss: 109601.2188; val_edge_recon_loss: 2796214.1562; val_gene_expr_recon_loss: 13443389.6250; val_masked_gp_l1_reg_loss: 65466.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89257.2266; val_chrom_access_recon_loss: 12856411.7500; val_global_loss: 29360340.5000; val_optim_loss: 29360340.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9358; val_auprc_score: 0.9132; val_best_acc_score: 0.8708; val_best_f1_score: 0.8784; train_kl_reg_loss: 110705.3902; train_edge_recon_loss: 2752890.5758; train_gene_expr_recon_loss: 13550503.7576; train_masked_gp_l1_reg_loss: 65441.3436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89005.4022; train_chrom_access_recon_loss: 12903508.3182; train_global_loss: 29472054.9091; train_optim_loss: 29472054.9091; val_kl_reg_loss: 110876.0986; val_edge_recon_loss: 2770162.2188; val_gene_expr_recon_loss: 13449912.7500; val_masked_gp_l1_reg_loss: 65416.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88842.5859; val_chrom_access_recon_loss: 12952868.3750; val_global_loss: 29438079.0000; val_optim_loss: 29438079.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9361; val_auprc_score: 0.9164; val_best_acc_score: 0.8745; val_best_f1_score: 0.8822; train_kl_reg_loss: 111046.8488; train_edge_recon_loss: 2757011.3068; train_gene_expr_recon_loss: 13540998.0000; train_masked_gp_l1_reg_loss: 65418.0690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88651.3744; train_chrom_access_recon_loss: 12905748.7121; train_global_loss: 29468874.4545; train_optim_loss: 29468874.4545; val_kl_reg_loss: 110230.7139; val_edge_recon_loss: 2755606.0938; val_gene_expr_recon_loss: 13371486.1250; val_masked_gp_l1_reg_loss: 65422.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88459.2266; val_chrom_access_recon_loss: 12976816.6250; val_global_loss: 29368020.7500; val_optim_loss: 29368020.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9280; val_auprc_score: 0.9029; val_best_acc_score: 0.8635; val_best_f1_score: 0.8740; train_kl_reg_loss: 110031.5598; train_edge_recon_loss: 2745735.9394; train_gene_expr_recon_loss: 13517360.8636; train_masked_gp_l1_reg_loss: 65435.6249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88287.0414; train_chrom_access_recon_loss: 12885459.5303; train_global_loss: 29412310.8182; train_optim_loss: 29412310.8182; val_kl_reg_loss: 109219.5430; val_edge_recon_loss: 2786713.7812; val_gene_expr_recon_loss: 13305306.6250; val_masked_gp_l1_reg_loss: 65450.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88193.2422; val_chrom_access_recon_loss: 12762872.0000; val_global_loss: 29117755.5000; val_optim_loss: 29117755.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9313; val_auprc_score: 0.9054; val_best_acc_score: 0.8673; val_best_f1_score: 0.8765; train_kl_reg_loss: 110262.0540; train_edge_recon_loss: 2757470.6591; train_gene_expr_recon_loss: 13534279.7121; train_masked_gp_l1_reg_loss: 65476.4331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88056.3137; train_chrom_access_recon_loss: 12896798.7576; train_global_loss: 29452343.8485; train_optim_loss: 29452343.8485; val_kl_reg_loss: 110055.6758; val_edge_recon_loss: 2808315.3750; val_gene_expr_recon_loss: 13411699.8750; val_masked_gp_l1_reg_loss: 65488.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87930.0781; val_chrom_access_recon_loss: 12856908.2500; val_global_loss: 29340397.7500; val_optim_loss: 29340397.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9221; val_auprc_score: 0.8933; val_best_acc_score: 0.8606; val_best_f1_score: 0.8702; train_kl_reg_loss: 110789.2173; train_edge_recon_loss: 2757793.3220; train_gene_expr_recon_loss: 13518556.6515; train_masked_gp_l1_reg_loss: 65523.2802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87804.9916; train_chrom_access_recon_loss: 12881260.1515; train_global_loss: 29421727.5152; train_optim_loss: 29421727.5152; val_kl_reg_loss: 111331.1982; val_edge_recon_loss: 2780206.4062; val_gene_expr_recon_loss: 13604995.6250; val_masked_gp_l1_reg_loss: 65550.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87692.1094; val_chrom_access_recon_loss: 12993702.8750; val_global_loss: 29643478.0000; val_optim_loss: 29643478.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9363; val_auprc_score: 0.9177; val_best_acc_score: 0.8713; val_best_f1_score: 0.8804; train_kl_reg_loss: 111254.9876; train_edge_recon_loss: 2751263.1098; train_gene_expr_recon_loss: 13521787.0758; train_masked_gp_l1_reg_loss: 65573.6508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87562.0844; train_chrom_access_recon_loss: 12883870.8182; train_global_loss: 29421311.7879; train_optim_loss: 29421311.7879; val_kl_reg_loss: 109957.1572; val_edge_recon_loss: 2773515.3125; val_gene_expr_recon_loss: 13294100.2500; val_masked_gp_l1_reg_loss: 65582.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87531.6016; val_chrom_access_recon_loss: 12796470.7500; val_global_loss: 29127158.2500; val_optim_loss: 29127158.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9322; val_auprc_score: 0.9052; val_best_acc_score: 0.8769; val_best_f1_score: 0.8847; train_kl_reg_loss: 110232.2283; train_edge_recon_loss: 2746470.0682; train_gene_expr_recon_loss: 13519769.1970; train_masked_gp_l1_reg_loss: 65622.2991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87454.7476; train_chrom_access_recon_loss: 12877210.7424; train_global_loss: 29406759.1212; train_optim_loss: 29406759.1212; val_kl_reg_loss: 110513.9805; val_edge_recon_loss: 2749726.1562; val_gene_expr_recon_loss: 13482727.1250; val_masked_gp_l1_reg_loss: 65653.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87359.5391; val_chrom_access_recon_loss: 12843859.8750; val_global_loss: 29339839.7500; val_optim_loss: 29339839.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9321; val_auprc_score: 0.9074; val_best_acc_score: 0.8697; val_best_f1_score: 0.8784; train_kl_reg_loss: 110472.4033; train_edge_recon_loss: 2743084.1553; train_gene_expr_recon_loss: 13516184.5758; train_masked_gp_l1_reg_loss: 65560.2034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83863.0050; train_chrom_access_recon_loss: 12885114.1212; train_global_loss: 29404278.5455; train_optim_loss: 29404278.5455; val_kl_reg_loss: 111044.7393; val_edge_recon_loss: 2775986.3125; val_gene_expr_recon_loss: 13635740.1250; val_masked_gp_l1_reg_loss: 65492.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83225.4766; val_chrom_access_recon_loss: 13046293.5000; val_global_loss: 29717782.5000; val_optim_loss: 29717782.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9300; val_auprc_score: 0.9007; val_best_acc_score: 0.8718; val_best_f1_score: 0.8818; train_kl_reg_loss: 110704.5012; train_edge_recon_loss: 2736783.5644; train_gene_expr_recon_loss: 13517226.0303; train_masked_gp_l1_reg_loss: 65471.1039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83188.0868; train_chrom_access_recon_loss: 12872464.4242; train_global_loss: 29385837.6364; train_optim_loss: 29385837.6364; val_kl_reg_loss: 110572.9980; val_edge_recon_loss: 2774686.1562; val_gene_expr_recon_loss: 13402962.2500; val_masked_gp_l1_reg_loss: 65452.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83157.9922; val_chrom_access_recon_loss: 12847220.5000; val_global_loss: 29284051.7500; val_optim_loss: 29284051.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9315; val_auprc_score: 0.9041; val_best_acc_score: 0.8726; val_best_f1_score: 0.8819; train_kl_reg_loss: 110861.8884; train_edge_recon_loss: 2756453.2689; train_gene_expr_recon_loss: 13522862.3939; train_masked_gp_l1_reg_loss: 65444.5849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83144.8438; train_chrom_access_recon_loss: 12877547.1667; train_global_loss: 29416314.2424; train_optim_loss: 29416314.2424; val_kl_reg_loss: 110784.5488; val_edge_recon_loss: 2745005.6250; val_gene_expr_recon_loss: 13350148.7500; val_masked_gp_l1_reg_loss: 65436.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83124.0703; val_chrom_access_recon_loss: 12969060.2500; val_global_loss: 29323560.0000; val_optim_loss: 29323560.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9318; val_auprc_score: 0.9124; val_best_acc_score: 0.8638; val_best_f1_score: 0.8735; train_kl_reg_loss: 110951.1802; train_edge_recon_loss: 2750327.6553; train_gene_expr_recon_loss: 13520116.2727; train_masked_gp_l1_reg_loss: 65434.1969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83104.6283; train_chrom_access_recon_loss: 12879936.3030; train_global_loss: 29409870.1515; train_optim_loss: 29409870.1515; val_kl_reg_loss: 110732.3135; val_edge_recon_loss: 2799556.3438; val_gene_expr_recon_loss: 13502488.0000; val_masked_gp_l1_reg_loss: 65429.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83084.4688; val_chrom_access_recon_loss: 12899061.0000; val_global_loss: 29460351.0000; val_optim_loss: 29460351.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 9 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9210
val AUPRC score: 0.8937
val best accuracy score: 0.8600
val best F1 score: 0.8695
val target rna MSE score: 0.9505
val source rna MSE score: 0.2896
val target atac MSE score: 0.3366
val source atac MSE score: 0.0724
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
