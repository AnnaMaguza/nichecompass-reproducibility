[True]
Run timestamp: 10082023_191749_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7091; val_auprc_score: 0.7494; val_best_acc_score: 0.5054; val_best_f1_score: 0.6685; train_kl_reg_loss: 122727.5005; train_edge_recon_loss: 3725070.7557; train_gene_expr_recon_loss: 27257881.1450; train_masked_gp_l1_reg_loss: 75441.8198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243230.1100; train_chrom_access_recon_loss: 1393751.6183; train_global_loss: 32818102.9160; train_optim_loss: 32818102.9160; val_kl_reg_loss: 149277.9828; val_edge_recon_loss: 4065151.8000; val_gene_expr_recon_loss: 23114316.8000; val_masked_gp_l1_reg_loss: 73777.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235018.4062; val_chrom_access_recon_loss: 1290720.0500; val_global_loss: 28928262.4000; val_optim_loss: 28928262.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7902; val_auprc_score: 0.8053; val_best_acc_score: 0.6306; val_best_f1_score: 0.7207; train_kl_reg_loss: 184860.0318; train_edge_recon_loss: 3579527.7023; train_gene_expr_recon_loss: 22627162.7786; train_masked_gp_l1_reg_loss: 71051.0422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225847.4179; train_chrom_access_recon_loss: 1282011.8053; train_global_loss: 27970460.8855; train_optim_loss: 27970460.8855; val_kl_reg_loss: 205239.4562; val_edge_recon_loss: 4058795.1667; val_gene_expr_recon_loss: 22306601.7333; val_masked_gp_l1_reg_loss: 68948.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216581.7344; val_chrom_access_recon_loss: 1274068.0000; val_global_loss: 28130234.4000; val_optim_loss: 28130234.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8524; val_auprc_score: 0.8611; val_best_acc_score: 0.7708; val_best_f1_score: 0.7576; train_kl_reg_loss: 163915.3439; train_edge_recon_loss: 3554073.5057; train_gene_expr_recon_loss: 22194819.8321; train_masked_gp_l1_reg_loss: 68989.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207865.1789; train_chrom_access_recon_loss: 1267017.3340; train_global_loss: 27456680.7939; train_optim_loss: 27456680.7939; val_kl_reg_loss: 146936.8729; val_edge_recon_loss: 4022054.8833; val_gene_expr_recon_loss: 21971854.6667; val_masked_gp_l1_reg_loss: 69856.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199294.0469; val_chrom_access_recon_loss: 1253862.2500; val_global_loss: 27663858.8000; val_optim_loss: 27663858.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8798; val_auprc_score: 0.8812; val_best_acc_score: 0.7936; val_best_f1_score: 0.8009; train_kl_reg_loss: 136564.0282; train_edge_recon_loss: 3512549.4294; train_gene_expr_recon_loss: 21974146.7481; train_masked_gp_l1_reg_loss: 71659.7057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 191347.4820; train_chrom_access_recon_loss: 1258583.6355; train_global_loss: 27144851.0229; train_optim_loss: 27144851.0229; val_kl_reg_loss: 112000.1464; val_edge_recon_loss: 3634119.8167; val_gene_expr_recon_loss: 21850837.7333; val_masked_gp_l1_reg_loss: 73852.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183567.9844; val_chrom_access_recon_loss: 1256079.8000; val_global_loss: 27110457.4667; val_optim_loss: 27110457.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8899; val_auprc_score: 0.8810; val_best_acc_score: 0.8026; val_best_f1_score: 0.8100; train_kl_reg_loss: 136846.2991; train_edge_recon_loss: 3171378.7710; train_gene_expr_recon_loss: 21860812.9313; train_masked_gp_l1_reg_loss: 76947.5394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176485.1652; train_chrom_access_recon_loss: 1254054.8569; train_global_loss: 26676525.6489; train_optim_loss: 26676525.6489; val_kl_reg_loss: 158454.4688; val_edge_recon_loss: 3021934.4000; val_gene_expr_recon_loss: 21814620.1333; val_masked_gp_l1_reg_loss: 78983.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169783.7969; val_chrom_access_recon_loss: 1249346.5583; val_global_loss: 26493123.4667; val_optim_loss: 26493123.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8943; val_auprc_score: 0.8850; val_best_acc_score: 0.8085; val_best_f1_score: 0.8187; train_kl_reg_loss: 160874.1291; train_edge_recon_loss: 2995812.5496; train_gene_expr_recon_loss: 21688825.4962; train_masked_gp_l1_reg_loss: 79874.3532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163854.8579; train_chrom_access_recon_loss: 1247549.9265; train_global_loss: 26336791.1298; train_optim_loss: 26336791.1298; val_kl_reg_loss: 157274.4125; val_edge_recon_loss: 2994272.2500; val_gene_expr_recon_loss: 21563061.8667; val_masked_gp_l1_reg_loss: 81282.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158137.9531; val_chrom_access_recon_loss: 1243253.3833; val_global_loss: 26197281.8667; val_optim_loss: 26197281.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9017; val_auprc_score: 0.8898; val_best_acc_score: 0.8196; val_best_f1_score: 0.8344; train_kl_reg_loss: 151441.5840; train_edge_recon_loss: 2965905.6603; train_gene_expr_recon_loss: 21565393.5267; train_masked_gp_l1_reg_loss: 82524.3281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152760.1752; train_chrom_access_recon_loss: 1242666.4103; train_global_loss: 26160691.6794; train_optim_loss: 26160691.6794; val_kl_reg_loss: 148024.3948; val_edge_recon_loss: 2958007.0167; val_gene_expr_recon_loss: 21449798.9333; val_masked_gp_l1_reg_loss: 83837.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147470.0781; val_chrom_access_recon_loss: 1236205.4833; val_global_loss: 26023343.8667; val_optim_loss: 26023343.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9029; val_auprc_score: 0.8882; val_best_acc_score: 0.8250; val_best_f1_score: 0.8374; train_kl_reg_loss: 144866.3098; train_edge_recon_loss: 2940590.6355; train_gene_expr_recon_loss: 21488015.3740; train_masked_gp_l1_reg_loss: 85309.9344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142570.4753; train_chrom_access_recon_loss: 1239119.7891; train_global_loss: 26040472.4122; train_optim_loss: 26040472.4122; val_kl_reg_loss: 147873.3094; val_edge_recon_loss: 2941726.2833; val_gene_expr_recon_loss: 21535255.3333; val_masked_gp_l1_reg_loss: 87875.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138181.7812; val_chrom_access_recon_loss: 1242656.5917; val_global_loss: 26093569.4667; val_optim_loss: 26093569.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9219; val_auprc_score: 0.9082; val_best_acc_score: 0.8445; val_best_f1_score: 0.8562; train_kl_reg_loss: 143633.9028; train_edge_recon_loss: 2896067.7958; train_gene_expr_recon_loss: 21345232.4122; train_masked_gp_l1_reg_loss: 88167.3613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133300.5132; train_chrom_access_recon_loss: 1232846.9952; train_global_loss: 25839248.8092; train_optim_loss: 25839248.8092; val_kl_reg_loss: 148310.2469; val_edge_recon_loss: 2878199.6500; val_gene_expr_recon_loss: 21329084.8000; val_masked_gp_l1_reg_loss: 89154.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128867.7969; val_chrom_access_recon_loss: 1231523.1000; val_global_loss: 25805139.7333; val_optim_loss: 25805139.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9257; val_auprc_score: 0.9138; val_best_acc_score: 0.8522; val_best_f1_score: 0.8614; train_kl_reg_loss: 143240.4395; train_edge_recon_loss: 2850422.9275; train_gene_expr_recon_loss: 21267714.8092; train_masked_gp_l1_reg_loss: 90280.7523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124811.4631; train_chrom_access_recon_loss: 1230437.5506; train_global_loss: 25706907.8626; train_optim_loss: 25706907.8626; val_kl_reg_loss: 145678.1823; val_edge_recon_loss: 2866669.1667; val_gene_expr_recon_loss: 21169857.8667; val_masked_gp_l1_reg_loss: 91323.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120866.6484; val_chrom_access_recon_loss: 1226599.5167; val_global_loss: 25620994.6667; val_optim_loss: 25620994.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9320; val_auprc_score: 0.9169; val_best_acc_score: 0.8642; val_best_f1_score: 0.8725; train_kl_reg_loss: 138464.3448; train_edge_recon_loss: 2837627.4427; train_gene_expr_recon_loss: 21208363.0076; train_masked_gp_l1_reg_loss: 92502.0486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117218.3504; train_chrom_access_recon_loss: 1228312.2739; train_global_loss: 25622487.3435; train_optim_loss: 25622487.3435; val_kl_reg_loss: 144065.6250; val_edge_recon_loss: 2831256.8833; val_gene_expr_recon_loss: 21094543.6000; val_masked_gp_l1_reg_loss: 93650.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113650.6562; val_chrom_access_recon_loss: 1224226.8667; val_global_loss: 25501392.8000; val_optim_loss: 25501392.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9389; val_auprc_score: 0.9262; val_best_acc_score: 0.8746; val_best_f1_score: 0.8795; train_kl_reg_loss: 135437.8599; train_edge_recon_loss: 2827290.4714; train_gene_expr_recon_loss: 21134463.3740; train_masked_gp_l1_reg_loss: 94717.6775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110261.5797; train_chrom_access_recon_loss: 1224689.0248; train_global_loss: 25526859.9542; train_optim_loss: 25526859.9542; val_kl_reg_loss: 135360.9094; val_edge_recon_loss: 2841214.5500; val_gene_expr_recon_loss: 21094070.4000; val_masked_gp_l1_reg_loss: 95782.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106950.2656; val_chrom_access_recon_loss: 1220311.1750; val_global_loss: 25493689.0667; val_optim_loss: 25493689.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9447; val_auprc_score: 0.9312; val_best_acc_score: 0.8826; val_best_f1_score: 0.8881; train_kl_reg_loss: 133814.4345; train_edge_recon_loss: 2802574.9008; train_gene_expr_recon_loss: 21064484.4885; train_masked_gp_l1_reg_loss: 96777.0958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103891.9767; train_chrom_access_recon_loss: 1221212.7939; train_global_loss: 25422755.5573; train_optim_loss: 25422755.5573; val_kl_reg_loss: 132948.5240; val_edge_recon_loss: 2817808.7000; val_gene_expr_recon_loss: 21061627.2000; val_masked_gp_l1_reg_loss: 97793.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100980.8516; val_chrom_access_recon_loss: 1219284.9833; val_global_loss: 25430443.4667; val_optim_loss: 25430443.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9462; val_auprc_score: 0.9328; val_best_acc_score: 0.8926; val_best_f1_score: 0.8968; train_kl_reg_loss: 130421.6950; train_edge_recon_loss: 2800120.5592; train_gene_expr_recon_loss: 21021031.5573; train_masked_gp_l1_reg_loss: 98787.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98227.1545; train_chrom_access_recon_loss: 1220012.6584; train_global_loss: 25368600.9771; train_optim_loss: 25368600.9771; val_kl_reg_loss: 128008.7937; val_edge_recon_loss: 2796937.9667; val_gene_expr_recon_loss: 21017569.6000; val_masked_gp_l1_reg_loss: 99886.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95666.3750; val_chrom_access_recon_loss: 1216846.8500; val_global_loss: 25354915.0667; val_optim_loss: 25354915.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9459; val_auprc_score: 0.9323; val_best_acc_score: 0.8849; val_best_f1_score: 0.8913; train_kl_reg_loss: 129248.2868; train_edge_recon_loss: 2788811.4523; train_gene_expr_recon_loss: 20983934.5649; train_masked_gp_l1_reg_loss: 100687.4501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93118.1099; train_chrom_access_recon_loss: 1218429.4962; train_global_loss: 25314229.2824; train_optim_loss: 25314229.2824; val_kl_reg_loss: 129870.4995; val_edge_recon_loss: 2805873.7000; val_gene_expr_recon_loss: 20937499.7333; val_masked_gp_l1_reg_loss: 101698.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90847.0625; val_chrom_access_recon_loss: 1217247.4750; val_global_loss: 25283037.7333; val_optim_loss: 25283037.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9568; val_auprc_score: 0.9487; val_best_acc_score: 0.8959; val_best_f1_score: 0.8992; train_kl_reg_loss: 126965.5175; train_edge_recon_loss: 2771624.1718; train_gene_expr_recon_loss: 20908055.1450; train_masked_gp_l1_reg_loss: 102556.1923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88775.2915; train_chrom_access_recon_loss: 1214607.7567; train_global_loss: 25212584.0305; train_optim_loss: 25212584.0305; val_kl_reg_loss: 122656.0901; val_edge_recon_loss: 2786071.9000; val_gene_expr_recon_loss: 20869100.0000; val_masked_gp_l1_reg_loss: 103313.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86786.2422; val_chrom_access_recon_loss: 1213650.2333; val_global_loss: 25181578.5333; val_optim_loss: 25181578.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9540; val_auprc_score: 0.9419; val_best_acc_score: 0.8956; val_best_f1_score: 0.8995; train_kl_reg_loss: 122603.0461; train_edge_recon_loss: 2771880.4122; train_gene_expr_recon_loss: 20887001.5878; train_masked_gp_l1_reg_loss: 104316.4953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84895.8256; train_chrom_access_recon_loss: 1215128.4122; train_global_loss: 25185825.8931; train_optim_loss: 25185825.8931; val_kl_reg_loss: 125510.9302; val_edge_recon_loss: 2776682.9167; val_gene_expr_recon_loss: 20778760.0000; val_masked_gp_l1_reg_loss: 105272.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83103.6406; val_chrom_access_recon_loss: 1210989.7667; val_global_loss: 25080319.6000; val_optim_loss: 25080319.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9603; val_auprc_score: 0.9493; val_best_acc_score: 0.9047; val_best_f1_score: 0.9092; train_kl_reg_loss: 121088.0580; train_edge_recon_loss: 2769995.5172; train_gene_expr_recon_loss: 20848888.1985; train_masked_gp_l1_reg_loss: 106109.1637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81383.9130; train_chrom_access_recon_loss: 1213619.1317; train_global_loss: 25141084.1221; train_optim_loss: 25141084.1221; val_kl_reg_loss: 121697.9385; val_edge_recon_loss: 2760987.7167; val_gene_expr_recon_loss: 20803073.8667; val_masked_gp_l1_reg_loss: 107040.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79641.3672; val_chrom_access_recon_loss: 1208110.0000; val_global_loss: 25080551.2000; val_optim_loss: 25080551.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9623; val_auprc_score: 0.9524; val_best_acc_score: 0.9073; val_best_f1_score: 0.9122; train_kl_reg_loss: 119823.5188; train_edge_recon_loss: 2751115.2595; train_gene_expr_recon_loss: 20804522.4885; train_masked_gp_l1_reg_loss: 107814.0471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78001.7329; train_chrom_access_recon_loss: 1212097.0315; train_global_loss: 25073374.0611; train_optim_loss: 25073374.0611; val_kl_reg_loss: 119613.2016; val_edge_recon_loss: 2757455.2833; val_gene_expr_recon_loss: 20773752.5333; val_masked_gp_l1_reg_loss: 108627.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76294.2500; val_chrom_access_recon_loss: 1207667.7750; val_global_loss: 25043410.4000; val_optim_loss: 25043410.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9683; val_auprc_score: 0.9618; val_best_acc_score: 0.9175; val_best_f1_score: 0.9206; train_kl_reg_loss: 117514.0237; train_edge_recon_loss: 2751807.1355; train_gene_expr_recon_loss: 20768760.8550; train_masked_gp_l1_reg_loss: 109420.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74721.8951; train_chrom_access_recon_loss: 1210680.9609; train_global_loss: 25032904.9618; train_optim_loss: 25032904.9618; val_kl_reg_loss: 112509.3464; val_edge_recon_loss: 2741931.0167; val_gene_expr_recon_loss: 20721397.4667; val_masked_gp_l1_reg_loss: 110175.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73094.2266; val_chrom_access_recon_loss: 1207808.6583; val_global_loss: 24966916.6667; val_optim_loss: 24966916.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9624; val_auprc_score: 0.9541; val_best_acc_score: 0.9053; val_best_f1_score: 0.9093; train_kl_reg_loss: 114825.1139; train_edge_recon_loss: 2743649.3588; train_gene_expr_recon_loss: 20736204.3817; train_masked_gp_l1_reg_loss: 110953.4560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71446.4760; train_chrom_access_recon_loss: 1210012.4065; train_global_loss: 24987090.9313; train_optim_loss: 24987090.9313; val_kl_reg_loss: 115809.8995; val_edge_recon_loss: 2771452.3833; val_gene_expr_recon_loss: 20669295.6000; val_masked_gp_l1_reg_loss: 111858.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69960.6406; val_chrom_access_recon_loss: 1209234.0833; val_global_loss: 24947610.0000; val_optim_loss: 24947610.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9669; val_auprc_score: 0.9578; val_best_acc_score: 0.9159; val_best_f1_score: 0.9199; train_kl_reg_loss: 113794.1867; train_edge_recon_loss: 2734384.1469; train_gene_expr_recon_loss: 20699490.1832; train_masked_gp_l1_reg_loss: 112654.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68482.0658; train_chrom_access_recon_loss: 1208482.9313; train_global_loss: 24937288.2748; train_optim_loss: 24937288.2748; val_kl_reg_loss: 112667.8453; val_edge_recon_loss: 2745910.7500; val_gene_expr_recon_loss: 20676917.3333; val_masked_gp_l1_reg_loss: 113535.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67030.0391; val_chrom_access_recon_loss: 1206171.3917; val_global_loss: 24922233.3333; val_optim_loss: 24922233.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9700; val_auprc_score: 0.9601; val_best_acc_score: 0.9205; val_best_f1_score: 0.9227; train_kl_reg_loss: 113027.8867; train_edge_recon_loss: 2733837.7576; train_gene_expr_recon_loss: 20661844.0305; train_masked_gp_l1_reg_loss: 114177.5818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65648.4280; train_chrom_access_recon_loss: 1207915.0086; train_global_loss: 24896450.7786; train_optim_loss: 24896450.7786; val_kl_reg_loss: 113706.1516; val_edge_recon_loss: 2727683.9833; val_gene_expr_recon_loss: 20669121.0667; val_masked_gp_l1_reg_loss: 114859.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64228.2461; val_chrom_access_recon_loss: 1210097.6000; val_global_loss: 24899696.8000; val_optim_loss: 24899696.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9715; val_auprc_score: 0.9647; val_best_acc_score: 0.9198; val_best_f1_score: 0.9241; train_kl_reg_loss: 110601.8020; train_edge_recon_loss: 2735338.0019; train_gene_expr_recon_loss: 20644837.5878; train_masked_gp_l1_reg_loss: 115647.6056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62998.2227; train_chrom_access_recon_loss: 1207395.0506; train_global_loss: 24876818.4122; train_optim_loss: 24876818.4122; val_kl_reg_loss: 109114.4250; val_edge_recon_loss: 2734964.5667; val_gene_expr_recon_loss: 20586928.9333; val_masked_gp_l1_reg_loss: 116535.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61788.8906; val_chrom_access_recon_loss: 1205826.6667; val_global_loss: 24815158.4000; val_optim_loss: 24815158.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9712; val_auprc_score: 0.9626; val_best_acc_score: 0.9252; val_best_f1_score: 0.9267; train_kl_reg_loss: 109490.5271; train_edge_recon_loss: 2730600.6985; train_gene_expr_recon_loss: 20637683.4046; train_masked_gp_l1_reg_loss: 117243.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60669.8508; train_chrom_access_recon_loss: 1209005.4408; train_global_loss: 24864693.8168; train_optim_loss: 24864693.8168; val_kl_reg_loss: 110563.6687; val_edge_recon_loss: 2732353.2833; val_gene_expr_recon_loss: 20554803.4667; val_masked_gp_l1_reg_loss: 118123.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59588.1211; val_chrom_access_recon_loss: 1202700.8833; val_global_loss: 24778133.4667; val_optim_loss: 24778133.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9500; val_auprc_score: 0.9419; val_best_acc_score: 0.8882; val_best_f1_score: 0.8915; train_kl_reg_loss: 128394.4742; train_edge_recon_loss: 2935559.0515; train_gene_expr_recon_loss: 24327593.6031; train_masked_gp_l1_reg_loss: 120772.7588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67023.3827; train_chrom_access_recon_loss: 1279772.1574; train_global_loss: 28859115.3740; train_optim_loss: 28859115.3740; val_kl_reg_loss: 12514.6014; val_edge_recon_loss: 2826490.1667; val_gene_expr_recon_loss: 24922238.6667; val_masked_gp_l1_reg_loss: 121033.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70183.3359; val_chrom_access_recon_loss: 1287216.2750; val_global_loss: 29239678.0000; val_optim_loss: 29239678.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9496; val_auprc_score: 0.9372; val_best_acc_score: 0.8899; val_best_f1_score: 0.8950; train_kl_reg_loss: 71385.5451; train_edge_recon_loss: 2770287.9752; train_gene_expr_recon_loss: 24754435.0534; train_masked_gp_l1_reg_loss: 118002.5511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67978.8136; train_chrom_access_recon_loss: 1277542.0677; train_global_loss: 29059632.0305; train_optim_loss: 29059632.0305; val_kl_reg_loss: 19736.8263; val_edge_recon_loss: 2734647.0000; val_gene_expr_recon_loss: 24525162.1333; val_masked_gp_l1_reg_loss: 114763.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65801.2344; val_chrom_access_recon_loss: 1274920.1583; val_global_loss: 28735031.7333; val_optim_loss: 28735031.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9549; val_auprc_score: 0.9395; val_best_acc_score: 0.8977; val_best_f1_score: 0.9021; train_kl_reg_loss: 49131.8749; train_edge_recon_loss: 2719918.7824; train_gene_expr_recon_loss: 24329643.5267; train_masked_gp_l1_reg_loss: 111592.9847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63680.7365; train_chrom_access_recon_loss: 1269956.4237; train_global_loss: 28543924.5649; train_optim_loss: 28543924.5649; val_kl_reg_loss: 22984.4096; val_edge_recon_loss: 2733952.5667; val_gene_expr_recon_loss: 24104096.4000; val_masked_gp_l1_reg_loss: 108443.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61708.9180; val_chrom_access_recon_loss: 1267805.8250; val_global_loss: 28298991.3333; val_optim_loss: 28298991.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9572; val_auprc_score: 0.9464; val_best_acc_score: 0.9025; val_best_f1_score: 0.9066; train_kl_reg_loss: 42748.8591; train_edge_recon_loss: 2707518.9561; train_gene_expr_recon_loss: 23920725.8015; train_masked_gp_l1_reg_loss: 105532.5432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59977.0909; train_chrom_access_recon_loss: 1261592.6746; train_global_loss: 28098095.7099; train_optim_loss: 28098095.7099; val_kl_reg_loss: 27451.9616; val_edge_recon_loss: 2705211.3500; val_gene_expr_recon_loss: 23830893.2000; val_masked_gp_l1_reg_loss: 102694.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58305.8359; val_chrom_access_recon_loss: 1265380.0333; val_global_loss: 27989936.8000; val_optim_loss: 27989936.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9558; val_auprc_score: 0.9419; val_best_acc_score: 0.9029; val_best_f1_score: 0.9068; train_kl_reg_loss: 43598.5516; train_edge_recon_loss: 2694197.0229; train_gene_expr_recon_loss: 23795858.0458; train_masked_gp_l1_reg_loss: 102101.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58060.9219; train_chrom_access_recon_loss: 1262769.1918; train_global_loss: 27956584.7176; train_optim_loss: 27956584.7176; val_kl_reg_loss: 27785.4263; val_edge_recon_loss: 2705815.4833; val_gene_expr_recon_loss: 23690294.6667; val_masked_gp_l1_reg_loss: 101760.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57851.5195; val_chrom_access_recon_loss: 1261294.3833; val_global_loss: 27844802.0000; val_optim_loss: 27844802.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9606; val_auprc_score: 0.9482; val_best_acc_score: 0.9076; val_best_f1_score: 0.9112; train_kl_reg_loss: 42812.2519; train_edge_recon_loss: 2692731.9256; train_gene_expr_recon_loss: 23785918.8397; train_masked_gp_l1_reg_loss: 101450.6476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57632.8687; train_chrom_access_recon_loss: 1262278.7719; train_global_loss: 27942825.2366; train_optim_loss: 27942825.2366; val_kl_reg_loss: 28003.1583; val_edge_recon_loss: 2688468.3500; val_gene_expr_recon_loss: 23740272.9333; val_masked_gp_l1_reg_loss: 101134.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57412.5352; val_chrom_access_recon_loss: 1263713.8750; val_global_loss: 27879004.1333; val_optim_loss: 27879004.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9619; val_auprc_score: 0.9524; val_best_acc_score: 0.9061; val_best_f1_score: 0.9103; train_kl_reg_loss: 42831.2760; train_edge_recon_loss: 2688147.4351; train_gene_expr_recon_loss: 23776714.8244; train_masked_gp_l1_reg_loss: 100811.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57179.7423; train_chrom_access_recon_loss: 1260840.0248; train_global_loss: 27926525.2061; train_optim_loss: 27926525.2061; val_kl_reg_loss: 28669.7109; val_edge_recon_loss: 2689722.4333; val_gene_expr_recon_loss: 23712433.7333; val_masked_gp_l1_reg_loss: 100486.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56927.1367; val_chrom_access_recon_loss: 1259319.2167; val_global_loss: 27847559.0667; val_optim_loss: 27847559.0667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9561; val_auprc_score: 0.9443; val_best_acc_score: 0.9006; val_best_f1_score: 0.9048; train_kl_reg_loss: 42473.3064; train_edge_recon_loss: 2699689.3626; train_gene_expr_recon_loss: 23768843.5878; train_masked_gp_l1_reg_loss: 100152.4588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56676.5567; train_chrom_access_recon_loss: 1260740.5620; train_global_loss: 27928575.5725; train_optim_loss: 27928575.5725; val_kl_reg_loss: 28813.1034; val_edge_recon_loss: 2719305.3000; val_gene_expr_recon_loss: 23748375.8667; val_masked_gp_l1_reg_loss: 99808.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56430.2266; val_chrom_access_recon_loss: 1261590.5333; val_global_loss: 27914322.9333; val_optim_loss: 27914322.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 53 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9701
val AUPRC score: 0.9635
val best accuracy score: 0.9177
val best F1 score: 0.9211
val target rna MSE score: 3.0610
val source rna MSE score: 380.7264
val target atac MSE score: 0.6073
val source atac MSE score: 7.4158
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
