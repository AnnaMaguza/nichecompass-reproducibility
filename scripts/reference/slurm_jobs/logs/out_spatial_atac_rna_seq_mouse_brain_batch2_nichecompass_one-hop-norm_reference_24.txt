[True]
Run timestamp: 26072023_012539_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9083; val_auprc_score: 0.9170; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4021.9613; train_edge_recon_loss: 349518.8056; train_gene_expr_recon_loss: 3148059.1667; train_masked_gp_l1_reg_loss: 1875.9816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1084639.3056; train_global_loss: 4588115.2778; train_optim_loss: 4588115.2778; val_kl_reg_loss: 15793.7031; val_edge_recon_loss: 406574.9375; val_gene_expr_recon_loss: 2936616.0000; val_masked_gp_l1_reg_loss: 1914.8303; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067372.1250; val_global_loss: 4428271.5000; val_optim_loss: 4428271.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8865; val_auprc_score: 0.8940; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 24529.7957; train_edge_recon_loss: 363725.1319; train_gene_expr_recon_loss: 2827326.7222; train_masked_gp_l1_reg_loss: 2004.7332; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062019.1111; train_global_loss: 4279605.5556; train_optim_loss: 4279605.5556; val_kl_reg_loss: 29040.8750; val_edge_recon_loss: 406577.2812; val_gene_expr_recon_loss: 2656599.5000; val_masked_gp_l1_reg_loss: 2131.7224; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1042976.5000; val_global_loss: 4137326.0000; val_optim_loss: 4137326.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8831; val_auprc_score: 0.8883; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 36141.4234; train_edge_recon_loss: 374081.9514; train_gene_expr_recon_loss: 2575546.8611; train_masked_gp_l1_reg_loss: 2236.3228; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1035675.0486; train_global_loss: 4023681.6944; train_optim_loss: 4023681.6944; val_kl_reg_loss: 44626.5547; val_edge_recon_loss: 406567.7500; val_gene_expr_recon_loss: 2445467.7500; val_masked_gp_l1_reg_loss: 2354.0442; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018641.9375; val_global_loss: 3917658.0000; val_optim_loss: 3917658.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8953; val_auprc_score: 0.8903; val_best_acc_score: 0.5047; val_best_f1_score: 0.6687; train_kl_reg_loss: 53134.7609; train_edge_recon_loss: 383421.1389; train_gene_expr_recon_loss: 2397665.7778; train_masked_gp_l1_reg_loss: 2409.8527; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020915.8819; train_global_loss: 3857547.4444; train_optim_loss: 3857547.4444; val_kl_reg_loss: 55279.2031; val_edge_recon_loss: 406536.1562; val_gene_expr_recon_loss: 2307149.7500; val_masked_gp_l1_reg_loss: 2455.9829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006654.3125; val_global_loss: 3778075.2500; val_optim_loss: 3778075.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8833; val_auprc_score: 0.8748; val_best_acc_score: 0.5104; val_best_f1_score: 0.6713; train_kl_reg_loss: 57574.4397; train_edge_recon_loss: 385923.7500; train_gene_expr_recon_loss: 2293024.8056; train_masked_gp_l1_reg_loss: 2470.5937; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002260.7431; train_global_loss: 3741254.3333; train_optim_loss: 3741254.3333; val_kl_reg_loss: 51922.0547; val_edge_recon_loss: 406455.5625; val_gene_expr_recon_loss: 2245248.5000; val_masked_gp_l1_reg_loss: 2482.4778; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997253.6875; val_global_loss: 3703362.2500; val_optim_loss: 3703362.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8806; val_auprc_score: 0.8712; val_best_acc_score: 0.5265; val_best_f1_score: 0.6784; train_kl_reg_loss: 57228.5751; train_edge_recon_loss: 384035.0764; train_gene_expr_recon_loss: 2234909.2778; train_masked_gp_l1_reg_loss: 2487.5849; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 995995.9722; train_global_loss: 3674656.5000; train_optim_loss: 3674656.5000; val_kl_reg_loss: 57191.6211; val_edge_recon_loss: 406360.8438; val_gene_expr_recon_loss: 2192237.2500; val_masked_gp_l1_reg_loss: 2490.5112; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 989437.6250; val_global_loss: 3647718.0000; val_optim_loss: 3647718.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8731; val_auprc_score: 0.8622; val_best_acc_score: 0.5690; val_best_f1_score: 0.6982; train_kl_reg_loss: 60022.4366; train_edge_recon_loss: 383732.8056; train_gene_expr_recon_loss: 2205401.4444; train_masked_gp_l1_reg_loss: 2485.4132; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 995542.5347; train_global_loss: 3647184.6111; train_optim_loss: 3647184.6111; val_kl_reg_loss: 57142.2773; val_edge_recon_loss: 406164.0938; val_gene_expr_recon_loss: 2154916.0000; val_masked_gp_l1_reg_loss: 2477.0664; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984651.8750; val_global_loss: 3605351.5000; val_optim_loss: 3605351.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8724; val_auprc_score: 0.8602; val_best_acc_score: 0.6513; val_best_f1_score: 0.7387; train_kl_reg_loss: 60359.3364; train_edge_recon_loss: 383165.3160; train_gene_expr_recon_loss: 2165227.9722; train_masked_gp_l1_reg_loss: 2473.3456; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984005.4236; train_global_loss: 3595231.3611; train_optim_loss: 3595231.3611; val_kl_reg_loss: 56245.1758; val_edge_recon_loss: 405655.3125; val_gene_expr_recon_loss: 2133457.0000; val_masked_gp_l1_reg_loss: 2467.5801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981824.6875; val_global_loss: 3579649.7500; val_optim_loss: 3579649.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8712; val_auprc_score: 0.8607; val_best_acc_score: 0.7224; val_best_f1_score: 0.7756; train_kl_reg_loss: 59573.8811; train_edge_recon_loss: 381217.3542; train_gene_expr_recon_loss: 2147379.8056; train_masked_gp_l1_reg_loss: 2465.8890; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986541.1181; train_global_loss: 3577178.0278; train_optim_loss: 3577178.0278; val_kl_reg_loss: 52676.6133; val_edge_recon_loss: 404737.4375; val_gene_expr_recon_loss: 2120277.0000; val_masked_gp_l1_reg_loss: 2464.0200; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981365.5000; val_global_loss: 3561520.5000; val_optim_loss: 3561520.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8651; val_auprc_score: 0.8495; val_best_acc_score: 0.7653; val_best_f1_score: 0.7952; train_kl_reg_loss: 57119.1315; train_edge_recon_loss: 379953.9826; train_gene_expr_recon_loss: 2138910.8611; train_masked_gp_l1_reg_loss: 2466.5150; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984684.4792; train_global_loss: 3563134.9444; train_optim_loss: 3563134.9444; val_kl_reg_loss: 51254.1484; val_edge_recon_loss: 403123.9688; val_gene_expr_recon_loss: 2109413.0000; val_masked_gp_l1_reg_loss: 2468.5825; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977358.3750; val_global_loss: 3543618.0000; val_optim_loss: 3543618.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8741; val_auprc_score: 0.8570; val_best_acc_score: 0.7961; val_best_f1_score: 0.8034; train_kl_reg_loss: 55474.0208; train_edge_recon_loss: 377933.1667; train_gene_expr_recon_loss: 2110919.1806; train_masked_gp_l1_reg_loss: 2471.0905; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974818.1250; train_global_loss: 3521615.5556; train_optim_loss: 3521615.5556; val_kl_reg_loss: 48497.8906; val_edge_recon_loss: 400095.3750; val_gene_expr_recon_loss: 2102483.5000; val_masked_gp_l1_reg_loss: 2472.8311; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977657.2500; val_global_loss: 3531206.7500; val_optim_loss: 3531206.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8786; val_auprc_score: 0.8625; val_best_acc_score: 0.7874; val_best_f1_score: 0.7841; train_kl_reg_loss: 53657.3016; train_edge_recon_loss: 375101.4479; train_gene_expr_recon_loss: 2130204.3056; train_masked_gp_l1_reg_loss: 2474.9616; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988876.4236; train_global_loss: 3550314.4444; train_optim_loss: 3550314.4444; val_kl_reg_loss: 47417.8594; val_edge_recon_loss: 396148.1875; val_gene_expr_recon_loss: 2093223.8750; val_masked_gp_l1_reg_loss: 2476.9229; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975045.4375; val_global_loss: 3514312.5000; val_optim_loss: 3514312.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8832; val_auprc_score: 0.8656; val_best_acc_score: 0.7870; val_best_f1_score: 0.8145; train_kl_reg_loss: 52742.7023; train_edge_recon_loss: 372160.8021; train_gene_expr_recon_loss: 2103642.0139; train_masked_gp_l1_reg_loss: 2480.5089; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973913.9861; train_global_loss: 3504940.0278; train_optim_loss: 3504940.0278; val_kl_reg_loss: 46583.1406; val_edge_recon_loss: 389511.3125; val_gene_expr_recon_loss: 2087783.2500; val_masked_gp_l1_reg_loss: 2485.8740; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973643.0000; val_global_loss: 3500006.5000; val_optim_loss: 3500006.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8896; val_auprc_score: 0.8715; val_best_acc_score: 0.8073; val_best_f1_score: 0.8228; train_kl_reg_loss: 51498.1241; train_edge_recon_loss: 367701.9826; train_gene_expr_recon_loss: 2098441.2500; train_masked_gp_l1_reg_loss: 2493.3921; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972642.8403; train_global_loss: 3492777.5556; train_optim_loss: 3492777.5556; val_kl_reg_loss: 47134.7109; val_edge_recon_loss: 381068.1875; val_gene_expr_recon_loss: 2084658.3750; val_masked_gp_l1_reg_loss: 2500.1575; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973699.4375; val_global_loss: 3489061.0000; val_optim_loss: 3489061.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8961; val_auprc_score: 0.8776; val_best_acc_score: 0.8170; val_best_f1_score: 0.8253; train_kl_reg_loss: 51696.1450; train_edge_recon_loss: 361767.2153; train_gene_expr_recon_loss: 2092945.0417; train_masked_gp_l1_reg_loss: 2505.1084; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974985.9792; train_global_loss: 3483899.5556; train_optim_loss: 3483899.5556; val_kl_reg_loss: 48611.8281; val_edge_recon_loss: 369374.8438; val_gene_expr_recon_loss: 2082673.6250; val_masked_gp_l1_reg_loss: 2509.9985; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973666.5000; val_global_loss: 3476836.7500; val_optim_loss: 3476836.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8977; val_auprc_score: 0.8839; val_best_acc_score: 0.8160; val_best_f1_score: 0.8277; train_kl_reg_loss: 52646.8134; train_edge_recon_loss: 354664.3854; train_gene_expr_recon_loss: 2084720.8472; train_masked_gp_l1_reg_loss: 2517.6732; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970132.4722; train_global_loss: 3464682.1944; train_optim_loss: 3464682.1944; val_kl_reg_loss: 50647.9219; val_edge_recon_loss: 357047.1250; val_gene_expr_recon_loss: 2076507.6250; val_masked_gp_l1_reg_loss: 2526.1812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969430.5000; val_global_loss: 3456159.5000; val_optim_loss: 3456159.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8936; val_auprc_score: 0.8789; val_best_acc_score: 0.8013; val_best_f1_score: 0.8177; train_kl_reg_loss: 55078.9605; train_edge_recon_loss: 345411.5556; train_gene_expr_recon_loss: 2095339.3889; train_masked_gp_l1_reg_loss: 2537.2659; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974466.8472; train_global_loss: 3472834.0278; train_optim_loss: 3472834.0278; val_kl_reg_loss: 52316.3164; val_edge_recon_loss: 346411.4688; val_gene_expr_recon_loss: 2074880.6250; val_masked_gp_l1_reg_loss: 2548.9666; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969152.8125; val_global_loss: 3445310.2500; val_optim_loss: 3445310.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8974; val_auprc_score: 0.8798; val_best_acc_score: 0.8126; val_best_f1_score: 0.8228; train_kl_reg_loss: 56086.8750; train_edge_recon_loss: 339244.5486; train_gene_expr_recon_loss: 2088571.1250; train_masked_gp_l1_reg_loss: 2559.1530; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970500.5903; train_global_loss: 3456962.3333; train_optim_loss: 3456962.3333; val_kl_reg_loss: 53073.5000; val_edge_recon_loss: 338772.6250; val_gene_expr_recon_loss: 2071622.1250; val_masked_gp_l1_reg_loss: 2569.1443; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968106.5000; val_global_loss: 3434144.0000; val_optim_loss: 3434144.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8979; val_auprc_score: 0.8762; val_best_acc_score: 0.8165; val_best_f1_score: 0.8269; train_kl_reg_loss: 55823.2691; train_edge_recon_loss: 335134.6424; train_gene_expr_recon_loss: 2077817.0556; train_masked_gp_l1_reg_loss: 2577.2740; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966176.9653; train_global_loss: 3437529.1944; train_optim_loss: 3437529.1944; val_kl_reg_loss: 52612.0156; val_edge_recon_loss: 336852.8438; val_gene_expr_recon_loss: 2068990.5000; val_masked_gp_l1_reg_loss: 2586.1062; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968406.3750; val_global_loss: 3429448.0000; val_optim_loss: 3429448.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9056; val_auprc_score: 0.8889; val_best_acc_score: 0.8232; val_best_f1_score: 0.8342; train_kl_reg_loss: 54452.3967; train_edge_recon_loss: 331700.6354; train_gene_expr_recon_loss: 2069551.4861; train_masked_gp_l1_reg_loss: 2596.1586; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967947.5625; train_global_loss: 3426248.2222; train_optim_loss: 3426248.2222; val_kl_reg_loss: 51773.7969; val_edge_recon_loss: 332694.4688; val_gene_expr_recon_loss: 2065420.3750; val_masked_gp_l1_reg_loss: 2606.1313; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967545.2500; val_global_loss: 3420040.0000; val_optim_loss: 3420040.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9098; val_auprc_score: 0.8930; val_best_acc_score: 0.8282; val_best_f1_score: 0.8410; train_kl_reg_loss: 53868.4284; train_edge_recon_loss: 330551.6944; train_gene_expr_recon_loss: 2084367.3611; train_masked_gp_l1_reg_loss: 2616.4154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970811.4028; train_global_loss: 3442215.3333; train_optim_loss: 3442215.3333; val_kl_reg_loss: 50145.1758; val_edge_recon_loss: 329216.7188; val_gene_expr_recon_loss: 2059892.6250; val_masked_gp_l1_reg_loss: 2626.2310; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965975.6875; val_global_loss: 3407856.5000; val_optim_loss: 3407856.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9099; val_auprc_score: 0.8931; val_best_acc_score: 0.8269; val_best_f1_score: 0.8396; train_kl_reg_loss: 52717.2439; train_edge_recon_loss: 327994.4132; train_gene_expr_recon_loss: 2072704.9861; train_masked_gp_l1_reg_loss: 2635.5565; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970304.1528; train_global_loss: 3426356.3889; train_optim_loss: 3426356.3889; val_kl_reg_loss: 51165.8438; val_edge_recon_loss: 328542.7500; val_gene_expr_recon_loss: 2057733.3750; val_masked_gp_l1_reg_loss: 2645.4111; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965277.3750; val_global_loss: 3405365.0000; val_optim_loss: 3405365.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9120; val_auprc_score: 0.8986; val_best_acc_score: 0.8259; val_best_f1_score: 0.8389; train_kl_reg_loss: 52520.0777; train_edge_recon_loss: 326202.2222; train_gene_expr_recon_loss: 2068558.0833; train_masked_gp_l1_reg_loss: 2656.4119; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965305.5139; train_global_loss: 3415242.3056; train_optim_loss: 3415242.3056; val_kl_reg_loss: 49329.7305; val_edge_recon_loss: 326957.5938; val_gene_expr_recon_loss: 2056646.8750; val_masked_gp_l1_reg_loss: 2667.4727; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963919.5625; val_global_loss: 3399521.2500; val_optim_loss: 3399521.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9134; val_auprc_score: 0.8992; val_best_acc_score: 0.8300; val_best_f1_score: 0.8417; train_kl_reg_loss: 51536.0490; train_edge_recon_loss: 323816.3160; train_gene_expr_recon_loss: 2075053.8472; train_masked_gp_l1_reg_loss: 2679.6201; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970807.9722; train_global_loss: 3423893.8056; train_optim_loss: 3423893.8056; val_kl_reg_loss: 49873.0273; val_edge_recon_loss: 326666.5312; val_gene_expr_recon_loss: 2052972.5000; val_masked_gp_l1_reg_loss: 2692.0073; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963439.7500; val_global_loss: 3395643.7500; val_optim_loss: 3395643.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9158; val_auprc_score: 0.8984; val_best_acc_score: 0.8376; val_best_f1_score: 0.8473; train_kl_reg_loss: 50799.4588; train_edge_recon_loss: 323757.9618; train_gene_expr_recon_loss: 2062943.5694; train_masked_gp_l1_reg_loss: 2702.7561; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963388.3264; train_global_loss: 3403592.0556; train_optim_loss: 3403592.0556; val_kl_reg_loss: 47706.9219; val_edge_recon_loss: 323442.0938; val_gene_expr_recon_loss: 2053100.2500; val_masked_gp_l1_reg_loss: 2714.0557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962528.5625; val_global_loss: 3389491.7500; val_optim_loss: 3389491.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9294; val_auprc_score: 0.9133; val_best_acc_score: 0.8589; val_best_f1_score: 0.8634; train_kl_reg_loss: 51795.2096; train_edge_recon_loss: 356334.5069; train_gene_expr_recon_loss: 2120198.0417; train_masked_gp_l1_reg_loss: 2725.5736; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970597.7500; train_global_loss: 3501651.1389; train_optim_loss: 3501651.1389; val_kl_reg_loss: 30278.8047; val_edge_recon_loss: 358579.3438; val_gene_expr_recon_loss: 2086695.8750; val_masked_gp_l1_reg_loss: 2739.8257; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966000.7500; val_global_loss: 3444294.5000; val_optim_loss: 3444294.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9321; val_auprc_score: 0.9187; val_best_acc_score: 0.8583; val_best_f1_score: 0.8622; train_kl_reg_loss: 47841.0087; train_edge_recon_loss: 350460.9062; train_gene_expr_recon_loss: 2094120.3333; train_masked_gp_l1_reg_loss: 2750.9278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967853.8681; train_global_loss: 3463027.0278; train_optim_loss: 3463027.0278; val_kl_reg_loss: 31145.3926; val_edge_recon_loss: 352711.5625; val_gene_expr_recon_loss: 2078693.2500; val_masked_gp_l1_reg_loss: 2761.3904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964339.8125; val_global_loss: 3429651.5000; val_optim_loss: 3429651.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9346; val_auprc_score: 0.9223; val_best_acc_score: 0.8636; val_best_f1_score: 0.8650; train_kl_reg_loss: 45505.3941; train_edge_recon_loss: 343763.4444; train_gene_expr_recon_loss: 2092350.0000; train_masked_gp_l1_reg_loss: 2766.4103; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968007.3056; train_global_loss: 3452392.5000; train_optim_loss: 3452392.5000; val_kl_reg_loss: 32757.8867; val_edge_recon_loss: 338885.8750; val_gene_expr_recon_loss: 2078270.7500; val_masked_gp_l1_reg_loss: 2771.1177; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964521.1875; val_global_loss: 3417206.7500; val_optim_loss: 3417206.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9370; val_auprc_score: 0.9256; val_best_acc_score: 0.8635; val_best_f1_score: 0.8639; train_kl_reg_loss: 46683.7144; train_edge_recon_loss: 334064.8472; train_gene_expr_recon_loss: 2104690.0139; train_masked_gp_l1_reg_loss: 2775.4256; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968987.0625; train_global_loss: 3457200.9722; train_optim_loss: 3457200.9722; val_kl_reg_loss: 36871.5742; val_edge_recon_loss: 329886.8438; val_gene_expr_recon_loss: 2072936.1250; val_masked_gp_l1_reg_loss: 2779.8931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962848.1875; val_global_loss: 3405322.7500; val_optim_loss: 3405322.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9307; val_auprc_score: 0.9189; val_best_acc_score: 0.8537; val_best_f1_score: 0.8570; train_kl_reg_loss: 46445.4740; train_edge_recon_loss: 328806.3090; train_gene_expr_recon_loss: 2085076.2222; train_masked_gp_l1_reg_loss: 2779.5784; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964154.0208; train_global_loss: 3427261.6111; train_optim_loss: 3427261.6111; val_kl_reg_loss: 37635.6016; val_edge_recon_loss: 330319.0938; val_gene_expr_recon_loss: 2071197.0000; val_masked_gp_l1_reg_loss: 2778.9307; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962508.5000; val_global_loss: 3404439.2500; val_optim_loss: 3404439.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9354; val_auprc_score: 0.9238; val_best_acc_score: 0.8593; val_best_f1_score: 0.8606; train_kl_reg_loss: 46500.3963; train_edge_recon_loss: 328970.0278; train_gene_expr_recon_loss: 2083746.2639; train_masked_gp_l1_reg_loss: 2778.5060; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962862.0694; train_global_loss: 3424857.2222; train_optim_loss: 3424857.2222; val_kl_reg_loss: 37436.7656; val_edge_recon_loss: 327636.4062; val_gene_expr_recon_loss: 2073337.2500; val_masked_gp_l1_reg_loss: 2778.0039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963588.5625; val_global_loss: 3404777.0000; val_optim_loss: 3404777.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9330; val_auprc_score: 0.9237; val_best_acc_score: 0.8584; val_best_f1_score: 0.8592; train_kl_reg_loss: 46231.4410; train_edge_recon_loss: 327729.3090; train_gene_expr_recon_loss: 2080274.6111; train_masked_gp_l1_reg_loss: 2777.7370; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966860.4861; train_global_loss: 3423873.5278; train_optim_loss: 3423873.5278; val_kl_reg_loss: 37843.8164; val_edge_recon_loss: 329179.2812; val_gene_expr_recon_loss: 2072509.2500; val_masked_gp_l1_reg_loss: 2777.4766; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963324.2500; val_global_loss: 3405634.0000; val_optim_loss: 3405634.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9321; val_auprc_score: 0.9208; val_best_acc_score: 0.8568; val_best_f1_score: 0.8602; train_kl_reg_loss: 46220.5330; train_edge_recon_loss: 327953.3819; train_gene_expr_recon_loss: 2086116.5556; train_masked_gp_l1_reg_loss: 2777.3427; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966247.1806; train_global_loss: 3429314.9444; train_optim_loss: 3429314.9444; val_kl_reg_loss: 37844.7109; val_edge_recon_loss: 328067.6250; val_gene_expr_recon_loss: 2071703.3750; val_masked_gp_l1_reg_loss: 2777.3140; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963397.6875; val_global_loss: 3403790.7500; val_optim_loss: 3403790.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 1 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9351
Val AUPRC score: 0.9246
Val best accuracy score: 0.8591
Val best F1 score: 0.8638
Val gene expr MSE score: 0.5867
Val chrom access MSE score: 0.0870
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
