[True]
Run timestamp: 07092023_144451_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.5917; val_auprc_score: 0.5845; val_best_acc_score: 0.5038; val_best_f1_score: 0.6679; train_kl_reg_loss: 50062.3028; train_edge_recon_loss: 3544180.2765; train_gene_expr_recon_loss: 17010614.2273; train_masked_gp_l1_reg_loss: 88850.5264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1495565.5246; train_chrom_access_recon_loss: 9066365.1970; train_global_loss: 31255638.2424; train_optim_loss: 31255638.2424; val_kl_reg_loss: 77369.7793; val_edge_recon_loss: 4065269.3438; val_gene_expr_recon_loss: 15395995.7500; val_masked_gp_l1_reg_loss: 86102.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1163818.1250; val_chrom_access_recon_loss: 8668586.5000; val_global_loss: 29457140.7500; val_optim_loss: 29457140.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6970; val_auprc_score: 0.6723; val_best_acc_score: 0.5091; val_best_f1_score: 0.6706; train_kl_reg_loss: 107442.9959; train_edge_recon_loss: 3540059.8333; train_gene_expr_recon_loss: 14934456.7121; train_masked_gp_l1_reg_loss: 80305.0462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 866350.9678; train_chrom_access_recon_loss: 8514221.6591; train_global_loss: 28042837.2121; train_optim_loss: 28042837.2121; val_kl_reg_loss: 108924.2666; val_edge_recon_loss: 4064508.0000; val_gene_expr_recon_loss: 14634509.1250; val_masked_gp_l1_reg_loss: 76676.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 612349.8125; val_chrom_access_recon_loss: 8414209.8125; val_global_loss: 27911177.0000; val_optim_loss: 27911177.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8097; val_auprc_score: 0.7797; val_best_acc_score: 0.5833; val_best_f1_score: 0.7037; train_kl_reg_loss: 108563.5320; train_edge_recon_loss: 3525515.1402; train_gene_expr_recon_loss: 14667737.7727; train_masked_gp_l1_reg_loss: 75502.3215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 460280.8101; train_chrom_access_recon_loss: 8434794.5758; train_global_loss: 27272394.2727; train_optim_loss: 27272394.2727; val_kl_reg_loss: 105326.0039; val_edge_recon_loss: 4060714.0938; val_gene_expr_recon_loss: 14623576.8750; val_masked_gp_l1_reg_loss: 74963.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 339362.7812; val_chrom_access_recon_loss: 8472916.1250; val_global_loss: 27676859.5000; val_optim_loss: 27676859.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8256; val_auprc_score: 0.7961; val_best_acc_score: 0.7300; val_best_f1_score: 0.7627; train_kl_reg_loss: 99698.9897; train_edge_recon_loss: 3517884.2348; train_gene_expr_recon_loss: 14523616.6818; train_masked_gp_l1_reg_loss: 75378.6054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 268646.6797; train_chrom_access_recon_loss: 8374326.8258; train_global_loss: 26859552.0303; train_optim_loss: 26859552.0303; val_kl_reg_loss: 93696.7354; val_edge_recon_loss: 3996714.2188; val_gene_expr_recon_loss: 14372619.8750; val_masked_gp_l1_reg_loss: 76417.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211455.6562; val_chrom_access_recon_loss: 8409318.1250; val_global_loss: 27160222.7500; val_optim_loss: 27160222.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8293; val_auprc_score: 0.7845; val_best_acc_score: 0.7598; val_best_f1_score: 0.7971; train_kl_reg_loss: 79468.5730; train_edge_recon_loss: 3401712.3144; train_gene_expr_recon_loss: 14425699.3636; train_masked_gp_l1_reg_loss: 78813.5866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175819.3149; train_chrom_access_recon_loss: 8327016.6818; train_global_loss: 26488529.7273; train_optim_loss: 26488529.7273; val_kl_reg_loss: 77688.0439; val_edge_recon_loss: 3103795.8125; val_gene_expr_recon_loss: 14357884.0000; val_masked_gp_l1_reg_loss: 82609.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146488.3281; val_chrom_access_recon_loss: 8265029.7500; val_global_loss: 26033495.2500; val_optim_loss: 26033495.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8325; val_auprc_score: 0.7909; val_best_acc_score: 0.7622; val_best_f1_score: 0.8007; train_kl_reg_loss: 99761.0336; train_edge_recon_loss: 3023198.5000; train_gene_expr_recon_loss: 14374364.8636; train_masked_gp_l1_reg_loss: 84885.6365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127851.8615; train_chrom_access_recon_loss: 8304843.4091; train_global_loss: 26014905.4545; train_optim_loss: 26014905.4545; val_kl_reg_loss: 107164.8223; val_edge_recon_loss: 2960076.2812; val_gene_expr_recon_loss: 14274592.0000; val_masked_gp_l1_reg_loss: 86391.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110131.9062; val_chrom_access_recon_loss: 8368891.9375; val_global_loss: 25907248.7500; val_optim_loss: 25907248.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8273; val_auprc_score: 0.7845; val_best_acc_score: 0.7582; val_best_f1_score: 0.7930; train_kl_reg_loss: 111067.6391; train_edge_recon_loss: 2968839.7159; train_gene_expr_recon_loss: 14250927.9091; train_masked_gp_l1_reg_loss: 87481.7737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98015.6194; train_chrom_access_recon_loss: 8235963.1515; train_global_loss: 25752295.7576; train_optim_loss: 25752295.7576; val_kl_reg_loss: 104457.5898; val_edge_recon_loss: 2967067.0000; val_gene_expr_recon_loss: 14315073.1250; val_masked_gp_l1_reg_loss: 88331.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87488.5000; val_chrom_access_recon_loss: 8245137.0625; val_global_loss: 25807554.5000; val_optim_loss: 25807554.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8363; val_auprc_score: 0.7902; val_best_acc_score: 0.7716; val_best_f1_score: 0.7995; train_kl_reg_loss: 109004.0513; train_edge_recon_loss: 2953073.8788; train_gene_expr_recon_loss: 14187591.7424; train_masked_gp_l1_reg_loss: 89462.7160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79450.6262; train_chrom_access_recon_loss: 8197001.3258; train_global_loss: 25615584.3333; train_optim_loss: 25615584.3333; val_kl_reg_loss: 108277.3350; val_edge_recon_loss: 2929695.4062; val_gene_expr_recon_loss: 14045325.2500; val_masked_gp_l1_reg_loss: 90619.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72202.1484; val_chrom_access_recon_loss: 8134523.0625; val_global_loss: 25380643.0000; val_optim_loss: 25380643.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8483; val_auprc_score: 0.8122; val_best_acc_score: 0.7732; val_best_f1_score: 0.8001; train_kl_reg_loss: 107194.4162; train_edge_recon_loss: 2944080.6402; train_gene_expr_recon_loss: 14126718.4394; train_masked_gp_l1_reg_loss: 91564.7878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66996.6745; train_chrom_access_recon_loss: 8164994.6894; train_global_loss: 25501549.5758; train_optim_loss: 25501549.5758; val_kl_reg_loss: 103191.4844; val_edge_recon_loss: 2956286.8750; val_gene_expr_recon_loss: 14091505.3750; val_masked_gp_l1_reg_loss: 92477.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62242.4453; val_chrom_access_recon_loss: 8147912.6875; val_global_loss: 25453616.2500; val_optim_loss: 25453616.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8446; val_auprc_score: 0.8138; val_best_acc_score: 0.7663; val_best_f1_score: 0.7993; train_kl_reg_loss: 103399.1883; train_edge_recon_loss: 2937032.3902; train_gene_expr_recon_loss: 14082713.0909; train_masked_gp_l1_reg_loss: 93248.3991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58650.0764; train_chrom_access_recon_loss: 8136458.3561; train_global_loss: 25411501.8485; train_optim_loss: 25411501.8485; val_kl_reg_loss: 104072.0908; val_edge_recon_loss: 2962561.6562; val_gene_expr_recon_loss: 13988449.8750; val_masked_gp_l1_reg_loss: 94165.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55609.4102; val_chrom_access_recon_loss: 8059886.3750; val_global_loss: 25264745.7500; val_optim_loss: 25264745.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8557; val_auprc_score: 0.8085; val_best_acc_score: 0.7845; val_best_f1_score: 0.8151; train_kl_reg_loss: 100614.0608; train_edge_recon_loss: 2919029.3485; train_gene_expr_recon_loss: 14016071.3333; train_masked_gp_l1_reg_loss: 95041.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53103.2334; train_chrom_access_recon_loss: 8101031.0000; train_global_loss: 25284890.0606; train_optim_loss: 25284890.0606; val_kl_reg_loss: 96434.4863; val_edge_recon_loss: 2900466.2500; val_gene_expr_recon_loss: 13903778.6250; val_masked_gp_l1_reg_loss: 95996.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51194.5781; val_chrom_access_recon_loss: 8000695.9375; val_global_loss: 25048566.5000; val_optim_loss: 25048566.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8570; val_auprc_score: 0.8108; val_best_acc_score: 0.7872; val_best_f1_score: 0.8141; train_kl_reg_loss: 100173.2418; train_edge_recon_loss: 2874669.9583; train_gene_expr_recon_loss: 13973533.3788; train_masked_gp_l1_reg_loss: 96729.8973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49258.7373; train_chrom_access_recon_loss: 8074162.0530; train_global_loss: 25168527.3030; train_optim_loss: 25168527.3030; val_kl_reg_loss: 97549.0537; val_edge_recon_loss: 2931585.7500; val_gene_expr_recon_loss: 13831543.0000; val_masked_gp_l1_reg_loss: 97732.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47898.0820; val_chrom_access_recon_loss: 7983061.2500; val_global_loss: 24989369.5000; val_optim_loss: 24989369.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8756; val_auprc_score: 0.8432; val_best_acc_score: 0.8057; val_best_f1_score: 0.8281; train_kl_reg_loss: 99243.7010; train_edge_recon_loss: 2856405.1477; train_gene_expr_recon_loss: 13921063.7576; train_masked_gp_l1_reg_loss: 98641.3355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46679.3902; train_chrom_access_recon_loss: 8042633.5833; train_global_loss: 25064666.8182; train_optim_loss: 25064666.8182; val_kl_reg_loss: 97748.5010; val_edge_recon_loss: 2845386.4688; val_gene_expr_recon_loss: 13872470.7500; val_masked_gp_l1_reg_loss: 99419.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45561.6406; val_chrom_access_recon_loss: 8000776.8750; val_global_loss: 24961364.0000; val_optim_loss: 24961364.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8652; val_auprc_score: 0.8181; val_best_acc_score: 0.8004; val_best_f1_score: 0.8218; train_kl_reg_loss: 101050.9276; train_edge_recon_loss: 2853124.3371; train_gene_expr_recon_loss: 13888083.4697; train_masked_gp_l1_reg_loss: 100098.6748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44668.7929; train_chrom_access_recon_loss: 8022809.7424; train_global_loss: 25009836.1212; train_optim_loss: 25009836.1212; val_kl_reg_loss: 97785.0967; val_edge_recon_loss: 2881572.9688; val_gene_expr_recon_loss: 13867253.1250; val_masked_gp_l1_reg_loss: 100752.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43890.1641; val_chrom_access_recon_loss: 7964383.7500; val_global_loss: 24955637.5000; val_optim_loss: 24955637.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8940; val_auprc_score: 0.8633; val_best_acc_score: 0.8229; val_best_f1_score: 0.8375; train_kl_reg_loss: 100177.4941; train_edge_recon_loss: 2830150.0000; train_gene_expr_recon_loss: 13843743.6818; train_masked_gp_l1_reg_loss: 101498.6132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43223.3133; train_chrom_access_recon_loss: 7987391.5303; train_global_loss: 24906184.7576; train_optim_loss: 24906184.7576; val_kl_reg_loss: 97795.4873; val_edge_recon_loss: 2837900.2812; val_gene_expr_recon_loss: 13903796.2500; val_masked_gp_l1_reg_loss: 102130.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42650.6445; val_chrom_access_recon_loss: 8038595.8125; val_global_loss: 25022868.5000; val_optim_loss: 25022868.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8852; val_auprc_score: 0.8482; val_best_acc_score: 0.8197; val_best_f1_score: 0.8345; train_kl_reg_loss: 98211.0012; train_edge_recon_loss: 2824121.6364; train_gene_expr_recon_loss: 13810194.8182; train_masked_gp_l1_reg_loss: 102720.5056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42000.8058; train_chrom_access_recon_loss: 7969358.2576; train_global_loss: 24846606.7576; train_optim_loss: 24846606.7576; val_kl_reg_loss: 91682.5215; val_edge_recon_loss: 2855093.9062; val_gene_expr_recon_loss: 13668949.6250; val_masked_gp_l1_reg_loss: 103471.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41623.6875; val_chrom_access_recon_loss: 7842053.4375; val_global_loss: 24602875.2500; val_optim_loss: 24602875.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8993; val_auprc_score: 0.8671; val_best_acc_score: 0.8342; val_best_f1_score: 0.8470; train_kl_reg_loss: 96016.2261; train_edge_recon_loss: 2808099.2689; train_gene_expr_recon_loss: 13760051.9697; train_masked_gp_l1_reg_loss: 104051.5698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41091.6830; train_chrom_access_recon_loss: 7946705.6742; train_global_loss: 24756016.2727; train_optim_loss: 24756016.2727; val_kl_reg_loss: 97085.2471; val_edge_recon_loss: 2827683.1562; val_gene_expr_recon_loss: 13741545.5000; val_masked_gp_l1_reg_loss: 104701.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40831.5625; val_chrom_access_recon_loss: 7962366.2500; val_global_loss: 24774213.7500; val_optim_loss: 24774213.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9000; val_auprc_score: 0.8659; val_best_acc_score: 0.8326; val_best_f1_score: 0.8465; train_kl_reg_loss: 95478.6313; train_edge_recon_loss: 2796115.7879; train_gene_expr_recon_loss: 13727626.7424; train_masked_gp_l1_reg_loss: 105271.9948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40287.5124; train_chrom_access_recon_loss: 7920720.7045; train_global_loss: 24685501.3939; train_optim_loss: 24685501.3939; val_kl_reg_loss: 94564.8154; val_edge_recon_loss: 2853919.2812; val_gene_expr_recon_loss: 13906909.8750; val_masked_gp_l1_reg_loss: 105820.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39722.7266; val_chrom_access_recon_loss: 7916183.7500; val_global_loss: 24917120.5000; val_optim_loss: 24917120.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9007; val_auprc_score: 0.8717; val_best_acc_score: 0.8369; val_best_f1_score: 0.8500; train_kl_reg_loss: 94314.6165; train_edge_recon_loss: 2792271.7045; train_gene_expr_recon_loss: 13690016.3182; train_masked_gp_l1_reg_loss: 106492.2324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39713.8741; train_chrom_access_recon_loss: 7896009.9697; train_global_loss: 24618818.6364; train_optim_loss: 24618818.6364; val_kl_reg_loss: 99284.9297; val_edge_recon_loss: 2815331.6562; val_gene_expr_recon_loss: 13571383.3750; val_masked_gp_l1_reg_loss: 107051.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39449.4062; val_chrom_access_recon_loss: 7909211.5000; val_global_loss: 24541712.0000; val_optim_loss: 24541712.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9084; val_auprc_score: 0.8756; val_best_acc_score: 0.8439; val_best_f1_score: 0.8554; train_kl_reg_loss: 94674.2028; train_edge_recon_loss: 2775301.5568; train_gene_expr_recon_loss: 13674087.7576; train_masked_gp_l1_reg_loss: 107571.7794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39306.5816; train_chrom_access_recon_loss: 7882876.2879; train_global_loss: 24573818.3939; train_optim_loss: 24573818.3939; val_kl_reg_loss: 94533.8916; val_edge_recon_loss: 2823691.9688; val_gene_expr_recon_loss: 13581529.0000; val_masked_gp_l1_reg_loss: 108289.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39214.8828; val_chrom_access_recon_loss: 7843783.8750; val_global_loss: 24491042.7500; val_optim_loss: 24491042.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9094; val_auprc_score: 0.8772; val_best_acc_score: 0.8442; val_best_f1_score: 0.8570; train_kl_reg_loss: 94135.3707; train_edge_recon_loss: 2777113.5644; train_gene_expr_recon_loss: 13623701.4242; train_masked_gp_l1_reg_loss: 108784.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39039.4183; train_chrom_access_recon_loss: 7850806.6212; train_global_loss: 24493580.6364; train_optim_loss: 24493580.6364; val_kl_reg_loss: 92487.4375; val_edge_recon_loss: 2800188.4375; val_gene_expr_recon_loss: 13581470.0000; val_masked_gp_l1_reg_loss: 109372.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39018.2266; val_chrom_access_recon_loss: 7840737.1875; val_global_loss: 24463273.7500; val_optim_loss: 24463273.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9104; val_auprc_score: 0.8801; val_best_acc_score: 0.8426; val_best_f1_score: 0.8553; train_kl_reg_loss: 93571.1469; train_edge_recon_loss: 2768935.7879; train_gene_expr_recon_loss: 13607786.1818; train_masked_gp_l1_reg_loss: 109863.5170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38701.7908; train_chrom_access_recon_loss: 7840174.9091; train_global_loss: 24459033.3636; train_optim_loss: 24459033.3636; val_kl_reg_loss: 90400.4209; val_edge_recon_loss: 2826226.8438; val_gene_expr_recon_loss: 13618836.3750; val_masked_gp_l1_reg_loss: 110564.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38778.3984; val_chrom_access_recon_loss: 7881843.8750; val_global_loss: 24566649.5000; val_optim_loss: 24566649.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9102; val_auprc_score: 0.8735; val_best_acc_score: 0.8455; val_best_f1_score: 0.8551; train_kl_reg_loss: 93425.0225; train_edge_recon_loss: 2764084.3447; train_gene_expr_recon_loss: 13576222.1667; train_masked_gp_l1_reg_loss: 111005.2553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38572.3010; train_chrom_access_recon_loss: 7817177.7197; train_global_loss: 24400487.0606; train_optim_loss: 24400487.0606; val_kl_reg_loss: 94776.1338; val_edge_recon_loss: 2795883.0625; val_gene_expr_recon_loss: 13524792.7500; val_masked_gp_l1_reg_loss: 111514.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38309.7148; val_chrom_access_recon_loss: 7810390.8125; val_global_loss: 24375667.2500; val_optim_loss: 24375667.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9194; val_auprc_score: 0.8975; val_best_acc_score: 0.8533; val_best_f1_score: 0.8612; train_kl_reg_loss: 94237.2682; train_edge_recon_loss: 2758048.9621; train_gene_expr_recon_loss: 13550158.4394; train_masked_gp_l1_reg_loss: 111824.9106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38135.4158; train_chrom_access_recon_loss: 7802488.3182; train_global_loss: 24354893.3333; train_optim_loss: 24354893.3333; val_kl_reg_loss: 95000.9678; val_edge_recon_loss: 2795683.2812; val_gene_expr_recon_loss: 13634810.7500; val_masked_gp_l1_reg_loss: 112307.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38235.2734; val_chrom_access_recon_loss: 7810693.1875; val_global_loss: 24486730.0000; val_optim_loss: 24486730.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9187; val_auprc_score: 0.8930; val_best_acc_score: 0.8552; val_best_f1_score: 0.8623; train_kl_reg_loss: 94317.3398; train_edge_recon_loss: 2757959.9129; train_gene_expr_recon_loss: 13524780.3939; train_masked_gp_l1_reg_loss: 112693.7638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37953.7048; train_chrom_access_recon_loss: 7788267.5758; train_global_loss: 24315972.6667; train_optim_loss: 24315972.6667; val_kl_reg_loss: 91015.0488; val_edge_recon_loss: 2808635.1250; val_gene_expr_recon_loss: 13593297.5000; val_masked_gp_l1_reg_loss: 113204.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37999.4883; val_chrom_access_recon_loss: 7802764.0625; val_global_loss: 24446915.7500; val_optim_loss: 24446915.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9207; val_auprc_score: 0.8933; val_best_acc_score: 0.8560; val_best_f1_score: 0.8674; train_kl_reg_loss: 108350.9169; train_edge_recon_loss: 2810869.2121; train_gene_expr_recon_loss: 13066805.8485; train_masked_gp_l1_reg_loss: 111935.7773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33022.0417; train_chrom_access_recon_loss: 7560598.6667; train_global_loss: 23691582.2121; train_optim_loss: 23691582.2121; val_kl_reg_loss: 51188.9194; val_edge_recon_loss: 2846385.1562; val_gene_expr_recon_loss: 12917120.7500; val_masked_gp_l1_reg_loss: 111401.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31755.0039; val_chrom_access_recon_loss: 7551193.0000; val_global_loss: 23509045.0000; val_optim_loss: 23509045.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9216; val_auprc_score: 0.8886; val_best_acc_score: 0.8616; val_best_f1_score: 0.8704; train_kl_reg_loss: 110476.7691; train_edge_recon_loss: 2776324.1250; train_gene_expr_recon_loss: 12891266.3485; train_masked_gp_l1_reg_loss: 111258.2897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31655.0101; train_chrom_access_recon_loss: 7420188.4773; train_global_loss: 23341168.9697; train_optim_loss: 23341168.9697; val_kl_reg_loss: 55358.9629; val_edge_recon_loss: 2835023.3750; val_gene_expr_recon_loss: 12910121.5000; val_masked_gp_l1_reg_loss: 111187.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31621.8145; val_chrom_access_recon_loss: 7472410.4375; val_global_loss: 23415723.2500; val_optim_loss: 23415723.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9209; val_auprc_score: 0.8944; val_best_acc_score: 0.8557; val_best_f1_score: 0.8675; train_kl_reg_loss: 104550.5903; train_edge_recon_loss: 2772135.3409; train_gene_expr_recon_loss: 12815052.7576; train_masked_gp_l1_reg_loss: 111045.2109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31738.8134; train_chrom_access_recon_loss: 7377602.8258; train_global_loss: 23212125.5455; train_optim_loss: 23212125.5455; val_kl_reg_loss: 55733.1064; val_edge_recon_loss: 2816308.8438; val_gene_expr_recon_loss: 12668903.5000; val_masked_gp_l1_reg_loss: 110937.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31776.4648; val_chrom_access_recon_loss: 7305043.1875; val_global_loss: 22988701.7500; val_optim_loss: 22988701.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9259; val_auprc_score: 0.8930; val_best_acc_score: 0.8689; val_best_f1_score: 0.8782; train_kl_reg_loss: 99525.8587; train_edge_recon_loss: 2752710.7765; train_gene_expr_recon_loss: 12751789.1515; train_masked_gp_l1_reg_loss: 110925.5096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32005.5053; train_chrom_access_recon_loss: 7333804.4773; train_global_loss: 23080761.3333; train_optim_loss: 23080761.3333; val_kl_reg_loss: 57340.5635; val_edge_recon_loss: 2775012.2188; val_gene_expr_recon_loss: 12719621.1250; val_masked_gp_l1_reg_loss: 110847.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32088.3027; val_chrom_access_recon_loss: 7277540.6875; val_global_loss: 22972450.7500; val_optim_loss: 22972450.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9332; val_auprc_score: 0.9162; val_best_acc_score: 0.8670; val_best_f1_score: 0.8761; train_kl_reg_loss: 94436.1809; train_edge_recon_loss: 2737553.6061; train_gene_expr_recon_loss: 12696050.1364; train_masked_gp_l1_reg_loss: 110729.1448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32240.7994; train_chrom_access_recon_loss: 7280028.3864; train_global_loss: 22951038.3333; train_optim_loss: 22951038.3333; val_kl_reg_loss: 59867.9551; val_edge_recon_loss: 2762551.0312; val_gene_expr_recon_loss: 12597268.8750; val_masked_gp_l1_reg_loss: 110602.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32295.9219; val_chrom_access_recon_loss: 7318996.4375; val_global_loss: 22881583.2500; val_optim_loss: 22881583.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9277; val_auprc_score: 0.8983; val_best_acc_score: 0.8735; val_best_f1_score: 0.8782; train_kl_reg_loss: 89750.4271; train_edge_recon_loss: 2722297.7652; train_gene_expr_recon_loss: 12659787.5606; train_masked_gp_l1_reg_loss: 110447.6183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32340.5256; train_chrom_access_recon_loss: 7248305.3258; train_global_loss: 22862929.1515; train_optim_loss: 22862929.1515; val_kl_reg_loss: 64781.3936; val_edge_recon_loss: 2759115.2188; val_gene_expr_recon_loss: 12584346.6250; val_masked_gp_l1_reg_loss: 110339.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32470.4473; val_chrom_access_recon_loss: 7248468.4375; val_global_loss: 22799521.5000; val_optim_loss: 22799521.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9228; val_auprc_score: 0.8981; val_best_acc_score: 0.8573; val_best_f1_score: 0.8687; train_kl_reg_loss: 87835.9264; train_edge_recon_loss: 2721654.3447; train_gene_expr_recon_loss: 12626962.5000; train_masked_gp_l1_reg_loss: 110051.2461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32399.9614; train_chrom_access_recon_loss: 7231549.1742; train_global_loss: 22810453.1515; train_optim_loss: 22810453.1515; val_kl_reg_loss: 65048.1338; val_edge_recon_loss: 2810837.7188; val_gene_expr_recon_loss: 12537322.8750; val_masked_gp_l1_reg_loss: 109810.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32366.5098; val_chrom_access_recon_loss: 7176550.2500; val_global_loss: 22731937.0000; val_optim_loss: 22731937.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9359; val_auprc_score: 0.9130; val_best_acc_score: 0.8718; val_best_f1_score: 0.8782; train_kl_reg_loss: 84896.6924; train_edge_recon_loss: 2726035.0568; train_gene_expr_recon_loss: 12586155.1212; train_masked_gp_l1_reg_loss: 109484.1716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32359.7375; train_chrom_access_recon_loss: 7203105.8030; train_global_loss: 22742036.4848; train_optim_loss: 22742036.4848; val_kl_reg_loss: 63910.8413; val_edge_recon_loss: 2761060.7500; val_gene_expr_recon_loss: 12649048.8750; val_masked_gp_l1_reg_loss: 109242.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32411.6035; val_chrom_access_recon_loss: 7180040.3125; val_global_loss: 22795714.7500; val_optim_loss: 22795714.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9324; val_auprc_score: 0.9103; val_best_acc_score: 0.8694; val_best_f1_score: 0.8769; train_kl_reg_loss: 82424.0510; train_edge_recon_loss: 2731749.2614; train_gene_expr_recon_loss: 12542809.3485; train_masked_gp_l1_reg_loss: 109054.8119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32283.8770; train_chrom_access_recon_loss: 7177073.2045; train_global_loss: 22675394.5758; train_optim_loss: 22675394.5758; val_kl_reg_loss: 63951.7437; val_edge_recon_loss: 2781223.4375; val_gene_expr_recon_loss: 12504841.1250; val_masked_gp_l1_reg_loss: 108863.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32234.7773; val_chrom_access_recon_loss: 7208055.8125; val_global_loss: 22699170.0000; val_optim_loss: 22699170.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9339; val_auprc_score: 0.9019; val_best_acc_score: 0.8745; val_best_f1_score: 0.8811; train_kl_reg_loss: 80608.2459; train_edge_recon_loss: 2726378.9659; train_gene_expr_recon_loss: 12527990.6818; train_masked_gp_l1_reg_loss: 108712.9098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32216.8143; train_chrom_access_recon_loss: 7161969.3712; train_global_loss: 22637877.0000; train_optim_loss: 22637877.0000; val_kl_reg_loss: 64209.0967; val_edge_recon_loss: 2767406.5625; val_gene_expr_recon_loss: 12489734.7500; val_masked_gp_l1_reg_loss: 108507.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32105.9082; val_chrom_access_recon_loss: 7179541.3125; val_global_loss: 22641504.5000; val_optim_loss: 22641504.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9396; val_auprc_score: 0.9193; val_best_acc_score: 0.8764; val_best_f1_score: 0.8830; train_kl_reg_loss: 79561.8838; train_edge_recon_loss: 2713960.9886; train_gene_expr_recon_loss: 12515192.2727; train_masked_gp_l1_reg_loss: 108325.0829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32054.2829; train_chrom_access_recon_loss: 7156063.3712; train_global_loss: 22605157.7576; train_optim_loss: 22605157.7576; val_kl_reg_loss: 66857.7305; val_edge_recon_loss: 2761828.4688; val_gene_expr_recon_loss: 12489373.5000; val_masked_gp_l1_reg_loss: 108172.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31875.2383; val_chrom_access_recon_loss: 7094943.5625; val_global_loss: 22553051.5000; val_optim_loss: 22553051.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9324; val_auprc_score: 0.9109; val_best_acc_score: 0.8708; val_best_f1_score: 0.8792; train_kl_reg_loss: 77715.3286; train_edge_recon_loss: 2711125.4773; train_gene_expr_recon_loss: 12496633.8636; train_masked_gp_l1_reg_loss: 108013.5114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31887.2578; train_chrom_access_recon_loss: 7142109.4242; train_global_loss: 22567485.0000; train_optim_loss: 22567485.0000; val_kl_reg_loss: 66436.9287; val_edge_recon_loss: 2783153.7500; val_gene_expr_recon_loss: 12653458.2500; val_masked_gp_l1_reg_loss: 107856.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31854.2441; val_chrom_access_recon_loss: 7176381.6875; val_global_loss: 22819140.0000; val_optim_loss: 22819140.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9453; val_auprc_score: 0.9275; val_best_acc_score: 0.8861; val_best_f1_score: 0.8912; train_kl_reg_loss: 77305.5337; train_edge_recon_loss: 2708478.2462; train_gene_expr_recon_loss: 12479608.2879; train_masked_gp_l1_reg_loss: 107719.6460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31787.5321; train_chrom_access_recon_loss: 7131608.7273; train_global_loss: 22536507.8485; train_optim_loss: 22536507.8485; val_kl_reg_loss: 66012.2017; val_edge_recon_loss: 2740191.5625; val_gene_expr_recon_loss: 12499960.6250; val_masked_gp_l1_reg_loss: 107649.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31754.6758; val_chrom_access_recon_loss: 7125624.8125; val_global_loss: 22571193.2500; val_optim_loss: 22571193.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9375; val_auprc_score: 0.9147; val_best_acc_score: 0.8756; val_best_f1_score: 0.8817; train_kl_reg_loss: 76109.0807; train_edge_recon_loss: 2710319.8371; train_gene_expr_recon_loss: 12475803.6515; train_masked_gp_l1_reg_loss: 107544.9854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31728.7852; train_chrom_access_recon_loss: 7128119.3864; train_global_loss: 22529625.6667; train_optim_loss: 22529625.6667; val_kl_reg_loss: 66973.0264; val_edge_recon_loss: 2741692.4375; val_gene_expr_recon_loss: 12381015.6250; val_masked_gp_l1_reg_loss: 107400.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31635.9043; val_chrom_access_recon_loss: 7084562.0000; val_global_loss: 22413279.2500; val_optim_loss: 22413279.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9447; val_auprc_score: 0.9231; val_best_acc_score: 0.8880; val_best_f1_score: 0.8933; train_kl_reg_loss: 75605.5353; train_edge_recon_loss: 2708511.7500; train_gene_expr_recon_loss: 12448744.6212; train_masked_gp_l1_reg_loss: 107230.2537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31643.4764; train_chrom_access_recon_loss: 7107434.8939; train_global_loss: 22479170.6667; train_optim_loss: 22479170.6667; val_kl_reg_loss: 66489.9424; val_edge_recon_loss: 2727546.3125; val_gene_expr_recon_loss: 12323013.6250; val_masked_gp_l1_reg_loss: 107072.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31627.2285; val_chrom_access_recon_loss: 7020173.3125; val_global_loss: 22275921.7500; val_optim_loss: 22275921.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9422; val_auprc_score: 0.9218; val_best_acc_score: 0.8877; val_best_f1_score: 0.8944; train_kl_reg_loss: 75556.9755; train_edge_recon_loss: 2704486.9545; train_gene_expr_recon_loss: 12407598.4697; train_masked_gp_l1_reg_loss: 106925.5723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31540.5584; train_chrom_access_recon_loss: 7093556.1894; train_global_loss: 22419664.6667; train_optim_loss: 22419664.6667; val_kl_reg_loss: 67570.4268; val_edge_recon_loss: 2733020.5000; val_gene_expr_recon_loss: 12472256.1250; val_masked_gp_l1_reg_loss: 106814.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31515.4629; val_chrom_access_recon_loss: 7084369.5625; val_global_loss: 22495547.2500; val_optim_loss: 22495547.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9456; val_auprc_score: 0.9292; val_best_acc_score: 0.8821; val_best_f1_score: 0.8888; train_kl_reg_loss: 74481.7454; train_edge_recon_loss: 2702460.6326; train_gene_expr_recon_loss: 12396818.7121; train_masked_gp_l1_reg_loss: 106629.2463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31420.9856; train_chrom_access_recon_loss: 7092196.4924; train_global_loss: 22404007.8788; train_optim_loss: 22404007.8788; val_kl_reg_loss: 67048.5586; val_edge_recon_loss: 2757389.5000; val_gene_expr_recon_loss: 12415753.7500; val_masked_gp_l1_reg_loss: 106592.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31548.5352; val_chrom_access_recon_loss: 7145219.7500; val_global_loss: 22523552.5000; val_optim_loss: 22523552.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9456; val_auprc_score: 0.9214; val_best_acc_score: 0.8893; val_best_f1_score: 0.8953; train_kl_reg_loss: 75090.6536; train_edge_recon_loss: 2702524.2235; train_gene_expr_recon_loss: 12385417.1364; train_masked_gp_l1_reg_loss: 106357.3385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31464.4536; train_chrom_access_recon_loss: 7073422.7955; train_global_loss: 22374276.5455; train_optim_loss: 22374276.5455; val_kl_reg_loss: 66538.8301; val_edge_recon_loss: 2710608.7188; val_gene_expr_recon_loss: 12433826.5000; val_masked_gp_l1_reg_loss: 106250.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31480.8203; val_chrom_access_recon_loss: 7061524.0000; val_global_loss: 22410229.7500; val_optim_loss: 22410229.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9437; val_auprc_score: 0.9181; val_best_acc_score: 0.8855; val_best_f1_score: 0.8924; train_kl_reg_loss: 73336.3529; train_edge_recon_loss: 2697941.1629; train_gene_expr_recon_loss: 12365373.3636; train_masked_gp_l1_reg_loss: 106151.5676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31464.6495; train_chrom_access_recon_loss: 7065180.8712; train_global_loss: 22339447.9697; train_optim_loss: 22339447.9697; val_kl_reg_loss: 66234.8105; val_edge_recon_loss: 2726781.3750; val_gene_expr_recon_loss: 12395525.1250; val_masked_gp_l1_reg_loss: 106081.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31372.2012; val_chrom_access_recon_loss: 7051545.3750; val_global_loss: 22377539.5000; val_optim_loss: 22377539.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9408; val_auprc_score: 0.9120; val_best_acc_score: 0.8839; val_best_f1_score: 0.8895; train_kl_reg_loss: 72299.0514; train_edge_recon_loss: 2697614.5530; train_gene_expr_recon_loss: 12342352.4545; train_masked_gp_l1_reg_loss: 105440.6134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28553.4453; train_chrom_access_recon_loss: 7058593.2652; train_global_loss: 22304853.3636; train_optim_loss: 22304853.3636; val_kl_reg_loss: 67889.3447; val_edge_recon_loss: 2735158.8125; val_gene_expr_recon_loss: 12269276.3750; val_masked_gp_l1_reg_loss: 105171.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27948.3633; val_chrom_access_recon_loss: 6979865.4375; val_global_loss: 22185308.5000; val_optim_loss: 22185308.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9410; val_auprc_score: 0.9143; val_best_acc_score: 0.8837; val_best_f1_score: 0.8908; train_kl_reg_loss: 73134.0573; train_edge_recon_loss: 2697948.3674; train_gene_expr_recon_loss: 12349119.6818; train_masked_gp_l1_reg_loss: 105086.4102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27858.5066; train_chrom_access_recon_loss: 7057816.7879; train_global_loss: 22310963.8788; train_optim_loss: 22310963.8788; val_kl_reg_loss: 67860.9775; val_edge_recon_loss: 2733066.8438; val_gene_expr_recon_loss: 12320051.6250; val_masked_gp_l1_reg_loss: 105028.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27783.8496; val_chrom_access_recon_loss: 7081062.8750; val_global_loss: 22334854.0000; val_optim_loss: 22334854.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9450; val_auprc_score: 0.9231; val_best_acc_score: 0.8845; val_best_f1_score: 0.8896; train_kl_reg_loss: 73354.3201; train_edge_recon_loss: 2697676.4962; train_gene_expr_recon_loss: 12345973.5606; train_masked_gp_l1_reg_loss: 104996.7990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27731.4094; train_chrom_access_recon_loss: 7061890.9545; train_global_loss: 22311623.5455; train_optim_loss: 22311623.5455; val_kl_reg_loss: 67569.5107; val_edge_recon_loss: 2737902.7812; val_gene_expr_recon_loss: 12281349.5000; val_masked_gp_l1_reg_loss: 104966.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27674.9082; val_chrom_access_recon_loss: 7022445.3125; val_global_loss: 22241909.2500; val_optim_loss: 22241909.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9488; val_auprc_score: 0.9283; val_best_acc_score: 0.8874; val_best_f1_score: 0.8930; train_kl_reg_loss: 73605.7995; train_edge_recon_loss: 2696525.8447; train_gene_expr_recon_loss: 12339539.6364; train_masked_gp_l1_reg_loss: 104947.2595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27634.8732; train_chrom_access_recon_loss: 7050918.1212; train_global_loss: 22293171.6061; train_optim_loss: 22293171.6061; val_kl_reg_loss: 68290.8164; val_edge_recon_loss: 2731426.0312; val_gene_expr_recon_loss: 12289633.7500; val_masked_gp_l1_reg_loss: 104922.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27591.2051; val_chrom_access_recon_loss: 7041009.0000; val_global_loss: 22262872.5000; val_optim_loss: 22262872.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9450; val_auprc_score: 0.9207; val_best_acc_score: 0.8890; val_best_f1_score: 0.8941; train_kl_reg_loss: 73873.2583; train_edge_recon_loss: 2691962.0417; train_gene_expr_recon_loss: 12340855.5758; train_masked_gp_l1_reg_loss: 104900.7997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27562.6562; train_chrom_access_recon_loss: 7060280.0758; train_global_loss: 22299434.3333; train_optim_loss: 22299434.3333; val_kl_reg_loss: 68765.7393; val_edge_recon_loss: 2733285.8438; val_gene_expr_recon_loss: 12312131.2500; val_masked_gp_l1_reg_loss: 104880.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27526.2734; val_chrom_access_recon_loss: 7055729.6250; val_global_loss: 22302319.7500; val_optim_loss: 22302319.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9515; val_auprc_score: 0.9299; val_best_acc_score: 0.8931; val_best_f1_score: 0.8987; train_kl_reg_loss: 74110.7932; train_edge_recon_loss: 2688837.9129; train_gene_expr_recon_loss: 12348200.0909; train_masked_gp_l1_reg_loss: 104817.0888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27219.4912; train_chrom_access_recon_loss: 7061079.5227; train_global_loss: 22304264.7576; train_optim_loss: 22304264.7576; val_kl_reg_loss: 69088.3584; val_edge_recon_loss: 2719511.1875; val_gene_expr_recon_loss: 12330472.1250; val_masked_gp_l1_reg_loss: 104789.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27157.0684; val_chrom_access_recon_loss: 7075560.3125; val_global_loss: 22326577.7500; val_optim_loss: 22326577.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9482; val_auprc_score: 0.9279; val_best_acc_score: 0.8955; val_best_f1_score: 0.8996; train_kl_reg_loss: 74133.0824; train_edge_recon_loss: 2703902.1439; train_gene_expr_recon_loss: 12341252.0909; train_masked_gp_l1_reg_loss: 104778.9753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27149.5577; train_chrom_access_recon_loss: 7057402.9545; train_global_loss: 22308618.9091; train_optim_loss: 22308618.9091; val_kl_reg_loss: 68607.9590; val_edge_recon_loss: 2713299.7500; val_gene_expr_recon_loss: 12401136.0000; val_masked_gp_l1_reg_loss: 104770.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27141.9219; val_chrom_access_recon_loss: 7045085.1250; val_global_loss: 22360040.5000; val_optim_loss: 22360040.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9485; val_auprc_score: 0.9344; val_best_acc_score: 0.8858; val_best_f1_score: 0.8920; train_kl_reg_loss: 74036.9013; train_edge_recon_loss: 2692866.5795; train_gene_expr_recon_loss: 12333175.3182; train_masked_gp_l1_reg_loss: 104763.2376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27136.7687; train_chrom_access_recon_loss: 7053329.7045; train_global_loss: 22285308.6970; train_optim_loss: 22285308.6970; val_kl_reg_loss: 68647.8232; val_edge_recon_loss: 2752058.9062; val_gene_expr_recon_loss: 12440394.0000; val_masked_gp_l1_reg_loss: 104756.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27130.4629; val_chrom_access_recon_loss: 7077190.3750; val_global_loss: 22470178.0000; val_optim_loss: 22470178.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9461; val_auprc_score: 0.9310; val_best_acc_score: 0.8837; val_best_f1_score: 0.8919; train_kl_reg_loss: 74050.8701; train_edge_recon_loss: 2698037.5341; train_gene_expr_recon_loss: 12341492.2727; train_masked_gp_l1_reg_loss: 104754.0853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27125.5332; train_chrom_access_recon_loss: 7060679.4924; train_global_loss: 22306139.9697; train_optim_loss: 22306139.9697; val_kl_reg_loss: 68201.5684; val_edge_recon_loss: 2726613.2500; val_gene_expr_recon_loss: 12245197.0000; val_masked_gp_l1_reg_loss: 104749.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27120.5176; val_chrom_access_recon_loss: 7007381.7500; val_global_loss: 22179264.5000; val_optim_loss: 22179264.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9473; val_auprc_score: 0.9305; val_best_acc_score: 0.8882; val_best_f1_score: 0.8936; train_kl_reg_loss: 74047.7491; train_edge_recon_loss: 2698090.8409; train_gene_expr_recon_loss: 12343981.7576; train_masked_gp_l1_reg_loss: 104746.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27116.5339; train_chrom_access_recon_loss: 7057062.1212; train_global_loss: 22305045.0303; train_optim_loss: 22305045.0303; val_kl_reg_loss: 68112.7900; val_edge_recon_loss: 2730897.0625; val_gene_expr_recon_loss: 12199320.2500; val_masked_gp_l1_reg_loss: 104742.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27112.4961; val_chrom_access_recon_loss: 6999813.0625; val_global_loss: 22129998.2500; val_optim_loss: 22129998.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9468; val_auprc_score: 0.9278; val_best_acc_score: 0.8866; val_best_f1_score: 0.8920; train_kl_reg_loss: 74057.1336; train_edge_recon_loss: 2684133.5985; train_gene_expr_recon_loss: 12328923.8333; train_masked_gp_l1_reg_loss: 104740.5941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27108.1161; train_chrom_access_recon_loss: 7051511.7424; train_global_loss: 22270475.0606; train_optim_loss: 22270475.0606; val_kl_reg_loss: 68744.7998; val_edge_recon_loss: 2741576.1250; val_gene_expr_recon_loss: 12269160.2500; val_masked_gp_l1_reg_loss: 104736.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27103.7422; val_chrom_access_recon_loss: 7019409.8750; val_global_loss: 22230732.2500; val_optim_loss: 22230732.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9489; val_auprc_score: 0.9361; val_best_acc_score: 0.8885; val_best_f1_score: 0.8939; train_kl_reg_loss: 74167.7772; train_edge_recon_loss: 2693509.8144; train_gene_expr_recon_loss: 12329235.7576; train_masked_gp_l1_reg_loss: 104732.9483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27099.5788; train_chrom_access_recon_loss: 7058159.6061; train_global_loss: 22286905.6364; train_optim_loss: 22286905.6364; val_kl_reg_loss: 68660.4570; val_edge_recon_loss: 2750804.4688; val_gene_expr_recon_loss: 12323399.2500; val_masked_gp_l1_reg_loss: 104729.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27095.2383; val_chrom_access_recon_loss: 7078111.0000; val_global_loss: 22352799.0000; val_optim_loss: 22352799.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9507; val_auprc_score: 0.9327; val_best_acc_score: 0.8925; val_best_f1_score: 0.8985; train_kl_reg_loss: 74131.3139; train_edge_recon_loss: 2693243.2803; train_gene_expr_recon_loss: 12328009.3636; train_masked_gp_l1_reg_loss: 104727.2056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27092.0013; train_chrom_access_recon_loss: 7051050.9924; train_global_loss: 22278254.0303; train_optim_loss: 22278254.0303; val_kl_reg_loss: 68359.5586; val_edge_recon_loss: 2710334.8125; val_gene_expr_recon_loss: 12366792.7500; val_masked_gp_l1_reg_loss: 104724.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27087.4258; val_chrom_access_recon_loss: 7036870.4375; val_global_loss: 22314168.2500; val_optim_loss: 22314168.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9441; val_auprc_score: 0.9240; val_best_acc_score: 0.8888; val_best_f1_score: 0.8946; train_kl_reg_loss: 74166.3685; train_edge_recon_loss: 2686875.6894; train_gene_expr_recon_loss: 12339041.3788; train_masked_gp_l1_reg_loss: 104721.8350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27083.1732; train_chrom_access_recon_loss: 7059825.4697; train_global_loss: 22291713.9394; train_optim_loss: 22291713.9394; val_kl_reg_loss: 68379.5010; val_edge_recon_loss: 2742240.9375; val_gene_expr_recon_loss: 12316009.2500; val_masked_gp_l1_reg_loss: 104718.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27080.2422; val_chrom_access_recon_loss: 7148743.0625; val_global_loss: 22407170.7500; val_optim_loss: 22407170.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9475; val_auprc_score: 0.9256; val_best_acc_score: 0.8896; val_best_f1_score: 0.8946; train_kl_reg_loss: 74162.4311; train_edge_recon_loss: 2693876.0909; train_gene_expr_recon_loss: 12333508.8636; train_masked_gp_l1_reg_loss: 104711.1978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27048.2893; train_chrom_access_recon_loss: 7056296.2121; train_global_loss: 22289603.0000; train_optim_loss: 22289603.0000; val_kl_reg_loss: 68268.6816; val_edge_recon_loss: 2752620.0938; val_gene_expr_recon_loss: 12376595.0000; val_masked_gp_l1_reg_loss: 104708.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27041.8301; val_chrom_access_recon_loss: 7055758.6875; val_global_loss: 22384992.5000; val_optim_loss: 22384992.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9465; val_auprc_score: 0.9277; val_best_acc_score: 0.8882; val_best_f1_score: 0.8938; train_kl_reg_loss: 74137.4550; train_edge_recon_loss: 2691574.7614; train_gene_expr_recon_loss: 12329554.6970; train_masked_gp_l1_reg_loss: 104707.0985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27040.9676; train_chrom_access_recon_loss: 7054501.9167; train_global_loss: 22281516.9394; train_optim_loss: 22281516.9394; val_kl_reg_loss: 68173.5044; val_edge_recon_loss: 2742448.8438; val_gene_expr_recon_loss: 12290599.1250; val_masked_gp_l1_reg_loss: 104706.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27040.1973; val_chrom_access_recon_loss: 6998877.3750; val_global_loss: 22231845.0000; val_optim_loss: 22231845.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9412; val_auprc_score: 0.9119; val_best_acc_score: 0.8834; val_best_f1_score: 0.8908; train_kl_reg_loss: 74197.9083; train_edge_recon_loss: 2692979.1098; train_gene_expr_recon_loss: 12328515.2273; train_masked_gp_l1_reg_loss: 104705.5075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27039.5843; train_chrom_access_recon_loss: 7053706.7500; train_global_loss: 22281144.0909; train_optim_loss: 22281144.0909; val_kl_reg_loss: 68160.0234; val_edge_recon_loss: 2749446.5625; val_gene_expr_recon_loss: 12275425.7500; val_masked_gp_l1_reg_loss: 104704.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27038.9648; val_chrom_access_recon_loss: 7016238.2500; val_global_loss: 22241013.7500; val_optim_loss: 22241013.7500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9478; val_auprc_score: 0.9247; val_best_acc_score: 0.8963; val_best_f1_score: 0.9018; train_kl_reg_loss: 74135.4815; train_edge_recon_loss: 2695996.2652; train_gene_expr_recon_loss: 12324126.3485; train_masked_gp_l1_reg_loss: 104704.2235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27038.4913; train_chrom_access_recon_loss: 7049945.6970; train_global_loss: 22275946.6061; train_optim_loss: 22275946.6061; val_kl_reg_loss: 68363.4131; val_edge_recon_loss: 2701459.5938; val_gene_expr_recon_loss: 12345159.3750; val_masked_gp_l1_reg_loss: 104703.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27037.9395; val_chrom_access_recon_loss: 7027718.7500; val_global_loss: 22274443.2500; val_optim_loss: 22274443.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 53 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9374
val AUPRC score: 0.9146
val best accuracy score: 0.8761
val best F1 score: 0.8832
val target rna MSE score: 1.1003
val source rna MSE score: 0.4643
val target atac MSE score: 0.3290
val source atac MSE score: 0.0738
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
