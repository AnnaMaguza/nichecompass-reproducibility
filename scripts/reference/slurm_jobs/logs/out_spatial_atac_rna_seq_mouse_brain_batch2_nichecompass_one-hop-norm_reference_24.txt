[True]
Run timestamp: 07082023_175058_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8680; val_auprc_score: 0.8891; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16811.5001; train_edge_recon_loss: 36032.2227; train_gene_expr_recon_loss: 1242477.8611; train_masked_gp_l1_reg_loss: 8666.5623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167488.0017; train_chrom_access_recon_loss: 2455085.6528; train_global_loss: 3926561.8333; train_optim_loss: 3926561.8333; val_kl_reg_loss: 11398.4160; val_edge_recon_loss: 40660.8750; val_gene_expr_recon_loss: 1010628.0000; val_masked_gp_l1_reg_loss: 7190.5908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163328.8125; val_chrom_access_recon_loss: 1613020.7500; val_global_loss: 2846227.5000; val_optim_loss: 2846227.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8790; val_auprc_score: 0.8981; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12098.1761; train_edge_recon_loss: 37786.5161; train_gene_expr_recon_loss: 921983.7708; train_masked_gp_l1_reg_loss: 6738.0668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160732.7118; train_chrom_access_recon_loss: 1530873.7361; train_global_loss: 2670212.9444; train_optim_loss: 2670212.9444; val_kl_reg_loss: 11662.1797; val_edge_recon_loss: 40661.0352; val_gene_expr_recon_loss: 836485.4375; val_masked_gp_l1_reg_loss: 6481.8042; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157509.6250; val_chrom_access_recon_loss: 1395642.6250; val_global_loss: 2448442.5000; val_optim_loss: 2448442.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8781; val_auprc_score: 0.8973; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14363.9531; train_edge_recon_loss: 38119.9679; train_gene_expr_recon_loss: 811026.4236; train_masked_gp_l1_reg_loss: 6688.2594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154797.8403; train_chrom_access_recon_loss: 1413121.4722; train_global_loss: 2438117.9167; train_optim_loss: 2438117.9167; val_kl_reg_loss: 16392.8125; val_edge_recon_loss: 40661.4258; val_gene_expr_recon_loss: 773898.6250; val_masked_gp_l1_reg_loss: 6928.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151239.0000; val_chrom_access_recon_loss: 1354530.5000; val_global_loss: 2343650.7500; val_optim_loss: 2343650.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8736; val_auprc_score: 0.8879; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19070.6923; train_edge_recon_loss: 38650.2331; train_gene_expr_recon_loss: 766632.4861; train_masked_gp_l1_reg_loss: 6948.1458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148065.7847; train_chrom_access_recon_loss: 1380186.5000; train_global_loss: 2359553.8056; train_optim_loss: 2359553.8056; val_kl_reg_loss: 19172.0703; val_edge_recon_loss: 40660.7344; val_gene_expr_recon_loss: 741678.2500; val_masked_gp_l1_reg_loss: 6931.3433; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143900.9531; val_chrom_access_recon_loss: 1335706.0000; val_global_loss: 2288049.2500; val_optim_loss: 2288049.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8737; val_auprc_score: 0.8875; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 20362.9957; train_edge_recon_loss: 38830.7101; train_gene_expr_recon_loss: 737352.7083; train_masked_gp_l1_reg_loss: 6909.8483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140330.0816; train_chrom_access_recon_loss: 1356762.8750; train_global_loss: 2300549.1944; train_optim_loss: 2300549.1944; val_kl_reg_loss: 20614.2070; val_edge_recon_loss: 40659.1016; val_gene_expr_recon_loss: 721976.3125; val_masked_gp_l1_reg_loss: 6878.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135780.7500; val_chrom_access_recon_loss: 1322721.5000; val_global_loss: 2248630.2500; val_optim_loss: 2248630.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8745; val_auprc_score: 0.8824; val_best_acc_score: 0.5085; val_best_f1_score: 0.6705; train_kl_reg_loss: 22277.9093; train_edge_recon_loss: 38950.3655; train_gene_expr_recon_loss: 716703.0764; train_masked_gp_l1_reg_loss: 6838.1575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132061.5434; train_chrom_access_recon_loss: 1339175.4722; train_global_loss: 2256006.5000; train_optim_loss: 2256006.5000; val_kl_reg_loss: 21490.8984; val_edge_recon_loss: 40654.1172; val_gene_expr_recon_loss: 707364.3125; val_masked_gp_l1_reg_loss: 6775.8667; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127394.5312; val_chrom_access_recon_loss: 1313918.7500; val_global_loss: 2217598.5000; val_optim_loss: 2217598.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8614; val_auprc_score: 0.8624; val_best_acc_score: 0.5162; val_best_f1_score: 0.6738; train_kl_reg_loss: 22829.6749; train_edge_recon_loss: 38963.2461; train_gene_expr_recon_loss: 702971.8125; train_masked_gp_l1_reg_loss: 6728.4047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123684.7205; train_chrom_access_recon_loss: 1335080.5833; train_global_loss: 2230258.4167; train_optim_loss: 2230258.4167; val_kl_reg_loss: 22755.1367; val_edge_recon_loss: 40645.9062; val_gene_expr_recon_loss: 694914.5625; val_masked_gp_l1_reg_loss: 6663.3857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119072.4922; val_chrom_access_recon_loss: 1307219.1250; val_global_loss: 2191270.5000; val_optim_loss: 2191270.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8493; val_auprc_score: 0.8452; val_best_acc_score: 0.5411; val_best_f1_score: 0.6845; train_kl_reg_loss: 23902.6426; train_edge_recon_loss: 39019.4688; train_gene_expr_recon_loss: 693233.0486; train_masked_gp_l1_reg_loss: 6621.3748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115454.1137; train_chrom_access_recon_loss: 1337855.3472; train_global_loss: 2216085.9722; train_optim_loss: 2216085.9722; val_kl_reg_loss: 23275.5195; val_edge_recon_loss: 40625.8984; val_gene_expr_recon_loss: 685139.3750; val_masked_gp_l1_reg_loss: 6564.5356; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110994.7656; val_chrom_access_recon_loss: 1301494.2500; val_global_loss: 2168094.5000; val_optim_loss: 2168094.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8397; val_auprc_score: 0.8380; val_best_acc_score: 0.5897; val_best_f1_score: 0.7059; train_kl_reg_loss: 24216.2081; train_edge_recon_loss: 39027.3750; train_gene_expr_recon_loss: 679367.2153; train_masked_gp_l1_reg_loss: 6528.8530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107554.5503; train_chrom_access_recon_loss: 1320405.1667; train_global_loss: 2177099.3750; train_optim_loss: 2177099.3750; val_kl_reg_loss: 23371.6875; val_edge_recon_loss: 40596.7148; val_gene_expr_recon_loss: 677155.0000; val_masked_gp_l1_reg_loss: 6482.8730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103339.8438; val_chrom_access_recon_loss: 1296432.6250; val_global_loss: 2147378.7500; val_optim_loss: 2147378.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8198; val_auprc_score: 0.8187; val_best_acc_score: 0.6143; val_best_f1_score: 0.7154; train_kl_reg_loss: 24991.1497; train_edge_recon_loss: 39085.8138; train_gene_expr_recon_loss: 677069.0347; train_masked_gp_l1_reg_loss: 6460.3436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100127.1137; train_chrom_access_recon_loss: 1320014.1667; train_global_loss: 2167747.6389; train_optim_loss: 2167747.6389; val_kl_reg_loss: 23752.3008; val_edge_recon_loss: 40567.8555; val_gene_expr_recon_loss: 670651.6250; val_masked_gp_l1_reg_loss: 6427.4395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96209.7734; val_chrom_access_recon_loss: 1291648.1250; val_global_loss: 2129257.0000; val_optim_loss: 2129257.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8171; val_auprc_score: 0.8167; val_best_acc_score: 0.6324; val_best_f1_score: 0.7236; train_kl_reg_loss: 25099.7129; train_edge_recon_loss: 39111.7704; train_gene_expr_recon_loss: 672017.5972; train_masked_gp_l1_reg_loss: 6410.2340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93262.8168; train_chrom_access_recon_loss: 1313553.2361; train_global_loss: 2149455.3611; train_optim_loss: 2149455.3611; val_kl_reg_loss: 24734.6211; val_edge_recon_loss: 40546.7422; val_gene_expr_recon_loss: 665090.5625; val_masked_gp_l1_reg_loss: 6386.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89689.5703; val_chrom_access_recon_loss: 1287980.1250; val_global_loss: 2114428.0000; val_optim_loss: 2114428.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8154; val_auprc_score: 0.8111; val_best_acc_score: 0.6558; val_best_f1_score: 0.7337; train_kl_reg_loss: 25387.9672; train_edge_recon_loss: 39138.9774; train_gene_expr_recon_loss: 666714.9861; train_masked_gp_l1_reg_loss: 6372.1402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87016.3134; train_chrom_access_recon_loss: 1314411.7778; train_global_loss: 2139042.1667; train_optim_loss: 2139042.1667; val_kl_reg_loss: 23909.0898; val_edge_recon_loss: 40519.0547; val_gene_expr_recon_loss: 661868.5000; val_masked_gp_l1_reg_loss: 6350.7178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83777.1719; val_chrom_access_recon_loss: 1284402.5000; val_global_loss: 2100827.0000; val_optim_loss: 2100827.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8157; val_auprc_score: 0.8144; val_best_acc_score: 0.6742; val_best_f1_score: 0.7430; train_kl_reg_loss: 25034.6625; train_edge_recon_loss: 39124.2352; train_gene_expr_recon_loss: 666446.7986; train_masked_gp_l1_reg_loss: 6341.4032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81358.8342; train_chrom_access_recon_loss: 1309119.6806; train_global_loss: 2127425.6389; train_optim_loss: 2127425.6389; val_kl_reg_loss: 23903.1641; val_edge_recon_loss: 40507.6992; val_gene_expr_recon_loss: 658222.0625; val_masked_gp_l1_reg_loss: 6333.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78420.9453; val_chrom_access_recon_loss: 1281633.3750; val_global_loss: 2089021.0000; val_optim_loss: 2089021.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8164; val_auprc_score: 0.8129; val_best_acc_score: 0.6850; val_best_f1_score: 0.7458; train_kl_reg_loss: 24663.6302; train_edge_recon_loss: 39118.2500; train_gene_expr_recon_loss: 658755.9306; train_masked_gp_l1_reg_loss: 6329.5699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76229.0616; train_chrom_access_recon_loss: 1308579.7222; train_global_loss: 2113676.1806; train_optim_loss: 2113676.1806; val_kl_reg_loss: 23082.6562; val_edge_recon_loss: 40480.1250; val_gene_expr_recon_loss: 656064.7500; val_masked_gp_l1_reg_loss: 6314.2192; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73564.6875; val_chrom_access_recon_loss: 1279169.3750; val_global_loss: 2078675.7500; val_optim_loss: 2078675.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8349; val_auprc_score: 0.8322; val_best_acc_score: 0.7052; val_best_f1_score: 0.7579; train_kl_reg_loss: 24213.4056; train_edge_recon_loss: 39088.6836; train_gene_expr_recon_loss: 657016.9028; train_masked_gp_l1_reg_loss: 6309.0747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71559.0773; train_chrom_access_recon_loss: 1299184.9444; train_global_loss: 2097372.1250; train_optim_loss: 2097372.1250; val_kl_reg_loss: 23832.3691; val_edge_recon_loss: 40476.2227; val_gene_expr_recon_loss: 652919.1250; val_masked_gp_l1_reg_loss: 6298.9512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69128.7109; val_chrom_access_recon_loss: 1276586.2500; val_global_loss: 2069241.6250; val_optim_loss: 2069241.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8398; val_auprc_score: 0.8365; val_best_acc_score: 0.7347; val_best_f1_score: 0.7706; train_kl_reg_loss: 23916.3121; train_edge_recon_loss: 39088.3511; train_gene_expr_recon_loss: 657685.5417; train_masked_gp_l1_reg_loss: 6296.5679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67304.9852; train_chrom_access_recon_loss: 1298400.9444; train_global_loss: 2092692.7222; train_optim_loss: 2092692.7222; val_kl_reg_loss: 21839.6797; val_edge_recon_loss: 40410.1602; val_gene_expr_recon_loss: 652578.2500; val_masked_gp_l1_reg_loss: 6286.5425; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65080.4375; val_chrom_access_recon_loss: 1274870.3750; val_global_loss: 2061065.5000; val_optim_loss: 2061065.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8517; val_auprc_score: 0.8529; val_best_acc_score: 0.7482; val_best_f1_score: 0.7785; train_kl_reg_loss: 23442.7372; train_edge_recon_loss: 39060.4926; train_gene_expr_recon_loss: 649534.5347; train_masked_gp_l1_reg_loss: 6291.8527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63416.9831; train_chrom_access_recon_loss: 1298637.0000; train_global_loss: 2080383.5972; train_optim_loss: 2080383.5972; val_kl_reg_loss: 21607.6484; val_edge_recon_loss: 40403.5938; val_gene_expr_recon_loss: 650455.7500; val_masked_gp_l1_reg_loss: 6282.4468; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61379.8359; val_chrom_access_recon_loss: 1272523.8750; val_global_loss: 2052653.1250; val_optim_loss: 2052653.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8626; val_auprc_score: 0.8525; val_best_acc_score: 0.7774; val_best_f1_score: 0.7967; train_kl_reg_loss: 23037.6693; train_edge_recon_loss: 39020.0061; train_gene_expr_recon_loss: 654461.1736; train_masked_gp_l1_reg_loss: 6280.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59845.8034; train_chrom_access_recon_loss: 1302857.1111; train_global_loss: 2085502.3472; train_optim_loss: 2085502.3472; val_kl_reg_loss: 21235.2637; val_edge_recon_loss: 40359.1992; val_gene_expr_recon_loss: 648662.5625; val_masked_gp_l1_reg_loss: 6275.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57968.0078; val_chrom_access_recon_loss: 1270097.1250; val_global_loss: 2044597.7500; val_optim_loss: 2044597.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8698; val_auprc_score: 0.8552; val_best_acc_score: 0.7891; val_best_f1_score: 0.8039; train_kl_reg_loss: 22569.8887; train_edge_recon_loss: 38970.8381; train_gene_expr_recon_loss: 650227.1736; train_masked_gp_l1_reg_loss: 6281.0463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56558.4510; train_chrom_access_recon_loss: 1299257.8056; train_global_loss: 2073865.1944; train_optim_loss: 2073865.1944; val_kl_reg_loss: 21056.1641; val_edge_recon_loss: 40335.2930; val_gene_expr_recon_loss: 646812.3750; val_masked_gp_l1_reg_loss: 6278.7705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54829.5391; val_chrom_access_recon_loss: 1268594.0000; val_global_loss: 2037906.1250; val_optim_loss: 2037906.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8743; val_auprc_score: 0.8630; val_best_acc_score: 0.7978; val_best_f1_score: 0.8054; train_kl_reg_loss: 22215.2745; train_edge_recon_loss: 38934.6172; train_gene_expr_recon_loss: 648989.5972; train_masked_gp_l1_reg_loss: 6281.7775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53530.8503; train_chrom_access_recon_loss: 1290001.5139; train_global_loss: 2059953.5972; train_optim_loss: 2059953.5972; val_kl_reg_loss: 20212.5234; val_edge_recon_loss: 40277.5820; val_gene_expr_recon_loss: 646858.6250; val_masked_gp_l1_reg_loss: 6274.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51938.1211; val_chrom_access_recon_loss: 1266726.3750; val_global_loss: 2032287.6250; val_optim_loss: 2032287.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8888; val_auprc_score: 0.8851; val_best_acc_score: 0.8129; val_best_f1_score: 0.8155; train_kl_reg_loss: 22018.0681; train_edge_recon_loss: 38902.6658; train_gene_expr_recon_loss: 645347.3889; train_masked_gp_l1_reg_loss: 6276.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50745.2778; train_chrom_access_recon_loss: 1293580.0556; train_global_loss: 2056869.6389; train_optim_loss: 2056869.6389; val_kl_reg_loss: 20276.7461; val_edge_recon_loss: 40242.1367; val_gene_expr_recon_loss: 644444.7500; val_masked_gp_l1_reg_loss: 6270.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49268.2578; val_chrom_access_recon_loss: 1264637.8750; val_global_loss: 2025139.7500; val_optim_loss: 2025139.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8949; val_auprc_score: 0.8829; val_best_acc_score: 0.8203; val_best_f1_score: 0.8197; train_kl_reg_loss: 21498.2036; train_edge_recon_loss: 38827.0668; train_gene_expr_recon_loss: 646138.0833; train_masked_gp_l1_reg_loss: 6271.1927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48159.2062; train_chrom_access_recon_loss: 1285066.1250; train_global_loss: 2045959.8750; train_optim_loss: 2045959.8750; val_kl_reg_loss: 20536.5625; val_edge_recon_loss: 40197.0586; val_gene_expr_recon_loss: 642566.9375; val_masked_gp_l1_reg_loss: 6268.9751; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46803.9805; val_chrom_access_recon_loss: 1263024.5000; val_global_loss: 2019398.0000; val_optim_loss: 2019398.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9030; val_auprc_score: 0.8914; val_best_acc_score: 0.8250; val_best_f1_score: 0.8193; train_kl_reg_loss: 21213.9427; train_edge_recon_loss: 38779.6632; train_gene_expr_recon_loss: 643230.2847; train_masked_gp_l1_reg_loss: 6274.7926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45780.4644; train_chrom_access_recon_loss: 1283883.8889; train_global_loss: 2039163.0417; train_optim_loss: 2039163.0417; val_kl_reg_loss: 20078.6875; val_edge_recon_loss: 40118.8867; val_gene_expr_recon_loss: 641443.0000; val_masked_gp_l1_reg_loss: 6274.9272; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44523.9219; val_chrom_access_recon_loss: 1261222.0000; val_global_loss: 2013661.5000; val_optim_loss: 2013661.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9046; val_auprc_score: 0.8884; val_best_acc_score: 0.8191; val_best_f1_score: 0.8094; train_kl_reg_loss: 20979.1682; train_edge_recon_loss: 38698.5247; train_gene_expr_recon_loss: 641902.2917; train_masked_gp_l1_reg_loss: 6280.1120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43574.3641; train_chrom_access_recon_loss: 1285076.2500; train_global_loss: 2036510.6944; train_optim_loss: 2036510.6944; val_kl_reg_loss: 19628.6992; val_edge_recon_loss: 40028.1719; val_gene_expr_recon_loss: 640524.0000; val_masked_gp_l1_reg_loss: 6280.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42399.5703; val_chrom_access_recon_loss: 1258928.6250; val_global_loss: 2007790.0000; val_optim_loss: 2007790.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9183; val_auprc_score: 0.9070; val_best_acc_score: 0.8266; val_best_f1_score: 0.8113; train_kl_reg_loss: 20747.1549; train_edge_recon_loss: 38627.3767; train_gene_expr_recon_loss: 643556.1806; train_masked_gp_l1_reg_loss: 6288.2717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41510.2830; train_chrom_access_recon_loss: 1286320.9444; train_global_loss: 2037050.2083; train_optim_loss: 2037050.2083; val_kl_reg_loss: 19266.0684; val_edge_recon_loss: 39917.8125; val_gene_expr_recon_loss: 639445.1250; val_masked_gp_l1_reg_loss: 6290.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40423.0352; val_chrom_access_recon_loss: 1257585.6250; val_global_loss: 2002928.5000; val_optim_loss: 2002928.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9179; val_auprc_score: 0.9078; val_best_acc_score: 0.8391; val_best_f1_score: 0.8509; train_kl_reg_loss: 18401.2628; train_edge_recon_loss: 40174.4323; train_gene_expr_recon_loss: 860503.7708; train_masked_gp_l1_reg_loss: 6380.9396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39434.7561; train_chrom_access_recon_loss: 1350256.7361; train_global_loss: 2315151.8889; train_optim_loss: 2315151.8889; val_kl_reg_loss: 14176.7988; val_edge_recon_loss: 40373.1094; val_gene_expr_recon_loss: 855540.3750; val_masked_gp_l1_reg_loss: 6542.9443; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38105.7656; val_chrom_access_recon_loss: 1328820.7500; val_global_loss: 2283559.7500; val_optim_loss: 2283559.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9156; val_auprc_score: 0.9079; val_best_acc_score: 0.8301; val_best_f1_score: 0.8447; train_kl_reg_loss: 16391.2921; train_edge_recon_loss: 40201.2643; train_gene_expr_recon_loss: 857190.3194; train_masked_gp_l1_reg_loss: 6681.3253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37021.0720; train_chrom_access_recon_loss: 1363144.0556; train_global_loss: 2320629.3333; train_optim_loss: 2320629.3333; val_kl_reg_loss: 13864.7510; val_edge_recon_loss: 40403.7227; val_gene_expr_recon_loss: 849745.0000; val_masked_gp_l1_reg_loss: 6832.9111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35691.6680; val_chrom_access_recon_loss: 1326579.0000; val_global_loss: 2273117.0000; val_optim_loss: 2273117.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9132; val_auprc_score: 0.9024; val_best_acc_score: 0.8359; val_best_f1_score: 0.8493; train_kl_reg_loss: 15539.6268; train_edge_recon_loss: 40205.4931; train_gene_expr_recon_loss: 848995.3889; train_masked_gp_l1_reg_loss: 6923.6439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34687.2214; train_chrom_access_recon_loss: 1352372.2500; train_global_loss: 2298723.6111; train_optim_loss: 2298723.6111; val_kl_reg_loss: 13537.2148; val_edge_recon_loss: 40394.4883; val_gene_expr_recon_loss: 845497.7500; val_masked_gp_l1_reg_loss: 7019.1123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33471.0352; val_chrom_access_recon_loss: 1324752.2500; val_global_loss: 2264672.0000; val_optim_loss: 2264672.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9256; val_auprc_score: 0.9154; val_best_acc_score: 0.8573; val_best_f1_score: 0.8646; train_kl_reg_loss: 15041.9062; train_edge_recon_loss: 40187.5920; train_gene_expr_recon_loss: 848456.9375; train_masked_gp_l1_reg_loss: 7074.7684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32566.3158; train_chrom_access_recon_loss: 1351635.4167; train_global_loss: 2294962.9722; train_optim_loss: 2294962.9722; val_kl_reg_loss: 13484.7109; val_edge_recon_loss: 40346.2695; val_gene_expr_recon_loss: 841958.7500; val_masked_gp_l1_reg_loss: 7133.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31472.6270; val_chrom_access_recon_loss: 1323125.0000; val_global_loss: 2257521.2500; val_optim_loss: 2257521.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9271; val_auprc_score: 0.9190; val_best_acc_score: 0.8576; val_best_f1_score: 0.8649; train_kl_reg_loss: 14915.8801; train_edge_recon_loss: 40165.1801; train_gene_expr_recon_loss: 844693.0764; train_masked_gp_l1_reg_loss: 7104.4794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31306.4236; train_chrom_access_recon_loss: 1347265.3611; train_global_loss: 2285450.3889; train_optim_loss: 2285450.3889; val_kl_reg_loss: 13574.7920; val_edge_recon_loss: 40346.8242; val_gene_expr_recon_loss: 841602.5625; val_masked_gp_l1_reg_loss: 7080.1802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31119.8086; val_chrom_access_recon_loss: 1323201.5000; val_global_loss: 2256925.7500; val_optim_loss: 2256925.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9267; val_auprc_score: 0.9210; val_best_acc_score: 0.8538; val_best_f1_score: 0.8615; train_kl_reg_loss: 14905.8878; train_edge_recon_loss: 40162.6944; train_gene_expr_recon_loss: 842371.7708; train_masked_gp_l1_reg_loss: 7075.4557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31007.4755; train_chrom_access_recon_loss: 1346936.7500; train_global_loss: 2282460.0278; train_optim_loss: 2282460.0278; val_kl_reg_loss: 13509.8652; val_edge_recon_loss: 40344.2188; val_gene_expr_recon_loss: 841351.0000; val_masked_gp_l1_reg_loss: 7066.2432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30862.4141; val_chrom_access_recon_loss: 1322998.1250; val_global_loss: 2256132.0000; val_optim_loss: 2256132.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9294; val_auprc_score: 0.9185; val_best_acc_score: 0.8580; val_best_f1_score: 0.8648; train_kl_reg_loss: 14888.7295; train_edge_recon_loss: 40159.2986; train_gene_expr_recon_loss: 844683.6597; train_masked_gp_l1_reg_loss: 7061.7511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30757.0276; train_chrom_access_recon_loss: 1354976.6667; train_global_loss: 2292527.1111; train_optim_loss: 2292527.1111; val_kl_reg_loss: 13513.6094; val_edge_recon_loss: 40332.8750; val_gene_expr_recon_loss: 840991.0000; val_masked_gp_l1_reg_loss: 7056.7646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30628.2656; val_chrom_access_recon_loss: 1322678.8750; val_global_loss: 2255201.5000; val_optim_loss: 2255201.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9271; val_auprc_score: 0.9185; val_best_acc_score: 0.8591; val_best_f1_score: 0.8655; train_kl_reg_loss: 14831.4275; train_edge_recon_loss: 40153.6476; train_gene_expr_recon_loss: 843077.6597; train_masked_gp_l1_reg_loss: 7053.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30530.1497; train_chrom_access_recon_loss: 1353458.9028; train_global_loss: 2289105.7500; train_optim_loss: 2289105.7500; val_kl_reg_loss: 13537.4395; val_edge_recon_loss: 40330.2070; val_gene_expr_recon_loss: 840821.2500; val_masked_gp_l1_reg_loss: 7051.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30412.5586; val_chrom_access_recon_loss: 1322952.1250; val_global_loss: 2255104.7500; val_optim_loss: 2255104.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9216
val AUPRC score: 0.9141
val best accuracy score: 0.8314
val best F1 score: 0.8469
val target rna MSE score: 3.8103
val source rna MSE score: 3.1555
val target atac MSE score: 0.1308
val source atac MSE score: 0.0189
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
