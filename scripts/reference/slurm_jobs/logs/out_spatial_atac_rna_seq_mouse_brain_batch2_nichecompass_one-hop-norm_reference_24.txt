[True]
Run timestamp: 24072023_162813_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8920; val_auprc_score: 0.8986; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6938.8051; train_edge_recon_loss: 352805.4375; train_gene_expr_recon_loss: 31702429.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10867666.6667; train_global_loss: 42929841.3333; train_optim_loss: 42929841.3333; val_kl_reg_loss: 20480.0078; val_edge_recon_loss: 406592.0000; val_gene_expr_recon_loss: 30013734.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10662664.0000; val_global_loss: 41103472.0000; val_optim_loss: 41103472.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8808; val_auprc_score: 0.8851; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 34388.9872; train_edge_recon_loss: 376158.1910; train_gene_expr_recon_loss: 28509101.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10655335.1111; train_global_loss: 39574984.0000; train_optim_loss: 39574984.0000; val_kl_reg_loss: 44929.6523; val_edge_recon_loss: 406602.6875; val_gene_expr_recon_loss: 27303464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10414258.0000; val_global_loss: 38169256.0000; val_optim_loss: 38169256.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8653; val_auprc_score: 0.8694; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 59995.3568; train_edge_recon_loss: 392380.5278; train_gene_expr_recon_loss: 26061197.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10393994.7778; train_global_loss: 36907569.3333; train_optim_loss: 36907569.3333; val_kl_reg_loss: 79959.5625; val_edge_recon_loss: 406598.8125; val_gene_expr_recon_loss: 25049214.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10208016.0000; val_global_loss: 35743788.0000; val_optim_loss: 35743788.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8721; val_auprc_score: 0.8749; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 110911.0095; train_edge_recon_loss: 401081.0590; train_gene_expr_recon_loss: 24233384.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10172778.3333; train_global_loss: 34918155.5556; train_optim_loss: 34918155.5556; val_kl_reg_loss: 131152.9062; val_edge_recon_loss: 406603.2500; val_gene_expr_recon_loss: 23727938.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10023711.0000; val_global_loss: 34289404.0000; val_optim_loss: 34289404.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8852; val_auprc_score: 0.8804; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 136006.7500; train_edge_recon_loss: 404606.2326; train_gene_expr_recon_loss: 23127309.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10015671.6667; train_global_loss: 33683593.7778; train_optim_loss: 33683593.7778; val_kl_reg_loss: 137864.9375; val_edge_recon_loss: 406581.3750; val_gene_expr_recon_loss: 22907936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9916967.0000; val_global_loss: 33369348.0000; val_optim_loss: 33369348.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8809; val_auprc_score: 0.8681; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 143313.8837; train_edge_recon_loss: 405168.3819; train_gene_expr_recon_loss: 22363699.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9897501.4444; train_global_loss: 32809683.3333; train_optim_loss: 32809683.3333; val_kl_reg_loss: 149543.5625; val_edge_recon_loss: 406550.1250; val_gene_expr_recon_loss: 22282098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9856310.0000; val_global_loss: 32694502.0000; val_optim_loss: 32694502.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8794; val_auprc_score: 0.8631; val_best_acc_score: 0.5065; val_best_f1_score: 0.6696; train_kl_reg_loss: 156442.0712; train_edge_recon_loss: 405162.6701; train_gene_expr_recon_loss: 21920715.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9858755.6667; train_global_loss: 32341076.2222; train_optim_loss: 32341076.2222; val_kl_reg_loss: 151169.2188; val_edge_recon_loss: 406492.6250; val_gene_expr_recon_loss: 21837218.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9799567.0000; val_global_loss: 32194448.0000; val_optim_loss: 32194448.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8818; val_auprc_score: 0.8638; val_best_acc_score: 0.5115; val_best_f1_score: 0.6718; train_kl_reg_loss: 155588.3229; train_edge_recon_loss: 405252.4306; train_gene_expr_recon_loss: 21499883.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9815406.6667; train_global_loss: 31876130.6667; train_optim_loss: 31876130.6667; val_kl_reg_loss: 157032.5625; val_edge_recon_loss: 406446.5938; val_gene_expr_recon_loss: 21584486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9780292.0000; val_global_loss: 31928258.0000; val_optim_loss: 31928258.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8753; val_auprc_score: 0.8593; val_best_acc_score: 0.5309; val_best_f1_score: 0.6805; train_kl_reg_loss: 155460.8681; train_edge_recon_loss: 405233.6458; train_gene_expr_recon_loss: 21410837.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9870672.4444; train_global_loss: 31842204.4444; train_optim_loss: 31842204.4444; val_kl_reg_loss: 144941.8906; val_edge_recon_loss: 406345.7188; val_gene_expr_recon_loss: 21424406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9741552.0000; val_global_loss: 31717246.0000; val_optim_loss: 31717246.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8673; val_auprc_score: 0.8505; val_best_acc_score: 0.5593; val_best_f1_score: 0.6936; train_kl_reg_loss: 146393.6910; train_edge_recon_loss: 405141.0312; train_gene_expr_recon_loss: 21280677.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9804590.5556; train_global_loss: 31636802.2222; train_optim_loss: 31636802.2222; val_kl_reg_loss: 141769.5312; val_edge_recon_loss: 406225.8125; val_gene_expr_recon_loss: 21328446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9728104.0000; val_global_loss: 31604546.0000; val_optim_loss: 31604546.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8705; val_auprc_score: 0.8559; val_best_acc_score: 0.5989; val_best_f1_score: 0.7123; train_kl_reg_loss: 142403.3455; train_edge_recon_loss: 404948.8160; train_gene_expr_recon_loss: 21164781.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9811345.6667; train_global_loss: 31523478.8889; train_optim_loss: 31523478.8889; val_kl_reg_loss: 139035.5000; val_edge_recon_loss: 406045.5938; val_gene_expr_recon_loss: 21271126.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9723072.0000; val_global_loss: 31539280.0000; val_optim_loss: 31539280.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8740; val_auprc_score: 0.8613; val_best_acc_score: 0.6409; val_best_f1_score: 0.7336; train_kl_reg_loss: 140396.1597; train_edge_recon_loss: 404602.5069; train_gene_expr_recon_loss: 21116680.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9773563.1111; train_global_loss: 31435242.0000; train_optim_loss: 31435242.0000; val_kl_reg_loss: 135060.9688; val_edge_recon_loss: 405821.7812; val_gene_expr_recon_loss: 21200844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9699714.0000; val_global_loss: 31441440.0000; val_optim_loss: 31441440.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8792; val_auprc_score: 0.8682; val_best_acc_score: 0.6847; val_best_f1_score: 0.7569; train_kl_reg_loss: 135819.7951; train_edge_recon_loss: 404220.8819; train_gene_expr_recon_loss: 21091262.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9808675.3333; train_global_loss: 31439979.3333; train_optim_loss: 31439979.3333; val_kl_reg_loss: 132438.3750; val_edge_recon_loss: 405496.9062; val_gene_expr_recon_loss: 21116234.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9671655.0000; val_global_loss: 31325824.0000; val_optim_loss: 31325824.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8849; val_auprc_score: 0.8747; val_best_acc_score: 0.7183; val_best_f1_score: 0.7757; train_kl_reg_loss: 133467.4479; train_edge_recon_loss: 403785.7986; train_gene_expr_recon_loss: 20904188.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9731808.0000; train_global_loss: 31173249.7778; train_optim_loss: 31173249.7778; val_kl_reg_loss: 127473.4531; val_edge_recon_loss: 405116.7812; val_gene_expr_recon_loss: 21045010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9650321.0000; val_global_loss: 31227920.0000; val_optim_loss: 31227920.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8913; val_auprc_score: 0.8781; val_best_acc_score: 0.7497; val_best_f1_score: 0.7937; train_kl_reg_loss: 129891.0556; train_edge_recon_loss: 403323.2882; train_gene_expr_recon_loss: 20787167.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9696369.7778; train_global_loss: 31016752.2222; train_optim_loss: 31016752.2222; val_kl_reg_loss: 123767.4062; val_edge_recon_loss: 404695.8438; val_gene_expr_recon_loss: 21033514.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9651196.0000; val_global_loss: 31213174.0000; val_optim_loss: 31213174.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8955; val_auprc_score: 0.8825; val_best_acc_score: 0.7695; val_best_f1_score: 0.8045; train_kl_reg_loss: 127037.8776; train_edge_recon_loss: 402763.2083; train_gene_expr_recon_loss: 20837279.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9703332.8889; train_global_loss: 31070413.1111; train_optim_loss: 31070413.1111; val_kl_reg_loss: 123674.1250; val_edge_recon_loss: 404215.3438; val_gene_expr_recon_loss: 21000396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9656697.0000; val_global_loss: 31184984.0000; val_optim_loss: 31184984.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9016; val_auprc_score: 0.8899; val_best_acc_score: 0.7930; val_best_f1_score: 0.8188; train_kl_reg_loss: 124241.2726; train_edge_recon_loss: 402307.9826; train_gene_expr_recon_loss: 20867926.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9736736.2222; train_global_loss: 31131211.5556; train_optim_loss: 31131211.5556; val_kl_reg_loss: 120527.2266; val_edge_recon_loss: 403684.8438; val_gene_expr_recon_loss: 20946634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9631521.0000; val_global_loss: 31102368.0000; val_optim_loss: 31102368.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9034; val_auprc_score: 0.8885; val_best_acc_score: 0.8164; val_best_f1_score: 0.8340; train_kl_reg_loss: 121688.6528; train_edge_recon_loss: 401824.3333; train_gene_expr_recon_loss: 20816965.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9695923.3333; train_global_loss: 31036401.7778; train_optim_loss: 31036401.7778; val_kl_reg_loss: 117543.0938; val_edge_recon_loss: 403117.0000; val_gene_expr_recon_loss: 20941908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640970.0000; val_global_loss: 31103538.0000; val_optim_loss: 31103538.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9101; val_auprc_score: 0.8978; val_best_acc_score: 0.8305; val_best_f1_score: 0.8422; train_kl_reg_loss: 119702.9566; train_edge_recon_loss: 401092.3090; train_gene_expr_recon_loss: 20775060.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9700695.5556; train_global_loss: 30996551.5556; train_optim_loss: 30996551.5556; val_kl_reg_loss: 115713.7656; val_edge_recon_loss: 402641.3750; val_gene_expr_recon_loss: 20876600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9612505.0000; val_global_loss: 31007460.0000; val_optim_loss: 31007460.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9108; val_auprc_score: 0.8975; val_best_acc_score: 0.8363; val_best_f1_score: 0.8442; train_kl_reg_loss: 116883.6146; train_edge_recon_loss: 400404.0174; train_gene_expr_recon_loss: 20671935.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647280.6667; train_global_loss: 30836504.0000; train_optim_loss: 30836504.0000; val_kl_reg_loss: 111243.4688; val_edge_recon_loss: 402042.3438; val_gene_expr_recon_loss: 20884312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628533.0000; val_global_loss: 31026132.0000; val_optim_loss: 31026132.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9172; val_auprc_score: 0.9058; val_best_acc_score: 0.8429; val_best_f1_score: 0.8472; train_kl_reg_loss: 115516.8099; train_edge_recon_loss: 399652.5799; train_gene_expr_recon_loss: 20764185.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9695153.8889; train_global_loss: 30974508.4444; train_optim_loss: 30974508.4444; val_kl_reg_loss: 107958.1797; val_edge_recon_loss: 400993.5000; val_gene_expr_recon_loss: 20834690.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9601250.0000; val_global_loss: 30944892.0000; val_optim_loss: 30944892.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9188; val_auprc_score: 0.9082; val_best_acc_score: 0.8401; val_best_f1_score: 0.8429; train_kl_reg_loss: 113000.2361; train_edge_recon_loss: 398726.3125; train_gene_expr_recon_loss: 20619314.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9643724.6667; train_global_loss: 30774765.5556; train_optim_loss: 30774765.5556; val_kl_reg_loss: 106578.5156; val_edge_recon_loss: 400373.3750; val_gene_expr_recon_loss: 20808436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9588956.0000; val_global_loss: 30904344.0000; val_optim_loss: 30904344.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9189; val_auprc_score: 0.9109; val_best_acc_score: 0.8416; val_best_f1_score: 0.8415; train_kl_reg_loss: 111545.6224; train_edge_recon_loss: 398084.8090; train_gene_expr_recon_loss: 20703168.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9691331.7778; train_global_loss: 30904130.8889; train_optim_loss: 30904130.8889; val_kl_reg_loss: 106040.7266; val_edge_recon_loss: 400102.8750; val_gene_expr_recon_loss: 20786866.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9596153.0000; val_global_loss: 30889164.0000; val_optim_loss: 30889164.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9262; val_auprc_score: 0.9167; val_best_acc_score: 0.8457; val_best_f1_score: 0.8424; train_kl_reg_loss: 109301.7865; train_edge_recon_loss: 397694.0035; train_gene_expr_recon_loss: 20572224.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9607839.5556; train_global_loss: 30687060.0000; train_optim_loss: 30687060.0000; val_kl_reg_loss: 103402.9844; val_edge_recon_loss: 398995.3750; val_gene_expr_recon_loss: 20773292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9584685.0000; val_global_loss: 30860376.0000; val_optim_loss: 30860376.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9303; val_auprc_score: 0.9191; val_best_acc_score: 0.8464; val_best_f1_score: 0.8405; train_kl_reg_loss: 108494.6745; train_edge_recon_loss: 396445.2326; train_gene_expr_recon_loss: 20550323.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602209.1111; train_global_loss: 30657472.8889; train_optim_loss: 30657472.8889; val_kl_reg_loss: 101596.4531; val_edge_recon_loss: 398375.9062; val_gene_expr_recon_loss: 20725996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570368.0000; val_global_loss: 30796336.0000; val_optim_loss: 30796336.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9241; val_auprc_score: 0.9151; val_best_acc_score: 0.8371; val_best_f1_score: 0.8308; train_kl_reg_loss: 106831.1181; train_edge_recon_loss: 396822.2535; train_gene_expr_recon_loss: 20900462.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693301.1111; train_global_loss: 31097416.4444; train_optim_loss: 31097416.4444; val_kl_reg_loss: 94826.9844; val_edge_recon_loss: 398085.3125; val_gene_expr_recon_loss: 20860830.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9566335.0000; val_global_loss: 30920076.0000; val_optim_loss: 30920076.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9275; val_auprc_score: 0.9173; val_best_acc_score: 0.8368; val_best_f1_score: 0.8283; train_kl_reg_loss: 104615.7543; train_edge_recon_loss: 395474.7222; train_gene_expr_recon_loss: 20832190.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686022.8889; train_global_loss: 31018303.5556; train_optim_loss: 31018303.5556; val_kl_reg_loss: 95015.6875; val_edge_recon_loss: 397099.8125; val_gene_expr_recon_loss: 20839282.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570423.0000; val_global_loss: 30901820.0000; val_optim_loss: 30901820.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9268; val_auprc_score: 0.9145; val_best_acc_score: 0.8332; val_best_f1_score: 0.8224; train_kl_reg_loss: 102582.9931; train_edge_recon_loss: 395172.3125; train_gene_expr_recon_loss: 20734628.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9626861.3333; train_global_loss: 30859244.6667; train_optim_loss: 30859244.6667; val_kl_reg_loss: 92961.3672; val_edge_recon_loss: 396714.9375; val_gene_expr_recon_loss: 20803552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9552480.0000; val_global_loss: 30845708.0000; val_optim_loss: 30845708.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9284; val_auprc_score: 0.9168; val_best_acc_score: 0.8310; val_best_f1_score: 0.8257; train_kl_reg_loss: 100673.7109; train_edge_recon_loss: 394656.8438; train_gene_expr_recon_loss: 20556796.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9569682.2222; train_global_loss: 30621809.1111; train_optim_loss: 30621809.1111; val_kl_reg_loss: 93757.2812; val_edge_recon_loss: 396424.9688; val_gene_expr_recon_loss: 20810310.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9567184.0000; val_global_loss: 30867676.0000; val_optim_loss: 30867676.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9280; val_auprc_score: 0.9172; val_best_acc_score: 0.8266; val_best_f1_score: 0.8305; train_kl_reg_loss: 98406.0365; train_edge_recon_loss: 394770.8924; train_gene_expr_recon_loss: 20572673.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9574815.7778; train_global_loss: 30640666.6667; train_optim_loss: 30640666.6667; val_kl_reg_loss: 91122.1250; val_edge_recon_loss: 396117.0000; val_gene_expr_recon_loss: 20770142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9543343.0000; val_global_loss: 30800724.0000; val_optim_loss: 30800724.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9281; val_auprc_score: 0.9184; val_best_acc_score: 0.8283; val_best_f1_score: 0.8276; train_kl_reg_loss: 98496.6111; train_edge_recon_loss: 394453.7986; train_gene_expr_recon_loss: 20650948.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9572030.2222; train_global_loss: 30715929.1111; train_optim_loss: 30715929.1111; val_kl_reg_loss: 92966.3594; val_edge_recon_loss: 396314.1875; val_gene_expr_recon_loss: 20793184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9556883.0000; val_global_loss: 30839348.0000; val_optim_loss: 30839348.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9317; val_auprc_score: 0.9218; val_best_acc_score: 0.8341; val_best_f1_score: 0.8303; train_kl_reg_loss: 99733.2674; train_edge_recon_loss: 394224.2812; train_gene_expr_recon_loss: 20664092.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628143.1111; train_global_loss: 30786192.6667; train_optim_loss: 30786192.6667; val_kl_reg_loss: 93019.8125; val_edge_recon_loss: 395880.9375; val_gene_expr_recon_loss: 20781760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548211.0000; val_global_loss: 30818872.0000; val_optim_loss: 30818872.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9300; val_auprc_score: 0.9204; val_best_acc_score: 0.8298; val_best_f1_score: 0.8305; train_kl_reg_loss: 99299.1345; train_edge_recon_loss: 393606.8125; train_gene_expr_recon_loss: 20668632.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587828.4444; train_global_loss: 30749366.6667; train_optim_loss: 30749366.6667; val_kl_reg_loss: 92852.8125; val_edge_recon_loss: 395788.2188; val_gene_expr_recon_loss: 20793810.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9564147.0000; val_global_loss: 30846600.0000; val_optim_loss: 30846600.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 55 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9240
Val AUPRC score: 0.9125
Val best accuracy score: 0.8425
Val best F1 score: 0.8385
Val gene expr MSE score: 0.4559
Val chrom access MSE score: 0.0856
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
