[True]
Run timestamp: 09102023_220026_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6421; val_auprc_score: 0.6308; val_best_acc_score: 0.5191; val_best_f1_score: 0.6748; train_kl_reg_loss: 49976.8704; train_edge_recon_loss: 3513547.3182; train_gene_expr_recon_loss: 13928608.2273; train_masked_gp_l1_reg_loss: 92237.0684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2962391.8542; train_chrom_access_recon_loss: 2991152.5265; train_global_loss: 23537914.0000; train_optim_loss: 23537914.0000; val_kl_reg_loss: 76289.3721; val_edge_recon_loss: 4064296.2188; val_gene_expr_recon_loss: 12695266.6250; val_masked_gp_l1_reg_loss: 77879.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1628266.0000; val_chrom_access_recon_loss: 2812939.2812; val_global_loss: 21354937.0000; val_optim_loss: 21354937.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6772; val_auprc_score: 0.6593; val_best_acc_score: 0.6145; val_best_f1_score: 0.6994; train_kl_reg_loss: 90708.0265; train_edge_recon_loss: 3517945.7424; train_gene_expr_recon_loss: 12813708.3182; train_masked_gp_l1_reg_loss: 74338.3235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 874803.7694; train_chrom_access_recon_loss: 2846585.9545; train_global_loss: 20218090.0909; train_optim_loss: 20218090.0909; val_kl_reg_loss: 83821.6992; val_edge_recon_loss: 4057834.3125; val_gene_expr_recon_loss: 12465488.2500; val_masked_gp_l1_reg_loss: 72983.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 413500.7500; val_chrom_access_recon_loss: 2749683.3125; val_global_loss: 19843312.0000; val_optim_loss: 19843312.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7362; val_auprc_score: 0.7107; val_best_acc_score: 0.6572; val_best_f1_score: 0.7176; train_kl_reg_loss: 84118.5021; train_edge_recon_loss: 3509237.9432; train_gene_expr_recon_loss: 12684603.3485; train_masked_gp_l1_reg_loss: 73876.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 276925.5561; train_chrom_access_recon_loss: 2827506.9318; train_global_loss: 19456269.0303; train_optim_loss: 19456269.0303; val_kl_reg_loss: 72491.9043; val_edge_recon_loss: 3997440.2188; val_gene_expr_recon_loss: 12371318.2500; val_masked_gp_l1_reg_loss: 75244.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192820.8594; val_chrom_access_recon_loss: 2719145.3125; val_global_loss: 19428460.2500; val_optim_loss: 19428460.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7796; val_auprc_score: 0.7690; val_best_acc_score: 0.7002; val_best_f1_score: 0.7329; train_kl_reg_loss: 68102.4830; train_edge_recon_loss: 3414209.2879; train_gene_expr_recon_loss: 12593101.9394; train_masked_gp_l1_reg_loss: 77240.4554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156659.9714; train_chrom_access_recon_loss: 2808798.8144; train_global_loss: 19118112.9394; train_optim_loss: 19118112.9394; val_kl_reg_loss: 68975.5112; val_edge_recon_loss: 3343549.6250; val_gene_expr_recon_loss: 12374704.3750; val_masked_gp_l1_reg_loss: 80528.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130095.9609; val_chrom_access_recon_loss: 2702297.5000; val_global_loss: 18700151.7500; val_optim_loss: 18700151.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8099; val_auprc_score: 0.7936; val_best_acc_score: 0.7249; val_best_f1_score: 0.7535; train_kl_reg_loss: 82903.1506; train_edge_recon_loss: 3122537.9167; train_gene_expr_recon_loss: 12550234.7273; train_masked_gp_l1_reg_loss: 83162.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114103.2354; train_chrom_access_recon_loss: 2798769.6136; train_global_loss: 18751711.2121; train_optim_loss: 18751711.2121; val_kl_reg_loss: 90160.7969; val_edge_recon_loss: 3119320.4375; val_gene_expr_recon_loss: 12337904.3750; val_masked_gp_l1_reg_loss: 85543.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101406.8906; val_chrom_access_recon_loss: 2704680.6875; val_global_loss: 18439017.5000; val_optim_loss: 18439017.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8494; val_auprc_score: 0.8279; val_best_acc_score: 0.7727; val_best_f1_score: 0.7923; train_kl_reg_loss: 92258.8794; train_edge_recon_loss: 3002875.1629; train_gene_expr_recon_loss: 12492389.7273; train_masked_gp_l1_reg_loss: 88246.7641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94799.7350; train_chrom_access_recon_loss: 2784057.7159; train_global_loss: 18554628.0000; train_optim_loss: 18554628.0000; val_kl_reg_loss: 92110.0195; val_edge_recon_loss: 2986787.7500; val_gene_expr_recon_loss: 12207203.0000; val_masked_gp_l1_reg_loss: 91026.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88910.0625; val_chrom_access_recon_loss: 2693616.0000; val_global_loss: 18159652.5000; val_optim_loss: 18159652.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8854; val_auprc_score: 0.8558; val_best_acc_score: 0.8235; val_best_f1_score: 0.8381; train_kl_reg_loss: 86480.1308; train_edge_recon_loss: 2957096.6250; train_gene_expr_recon_loss: 12433503.9242; train_masked_gp_l1_reg_loss: 95108.2156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86308.9873; train_chrom_access_recon_loss: 2768899.0189; train_global_loss: 18427396.7879; train_optim_loss: 18427396.7879; val_kl_reg_loss: 81174.1846; val_edge_recon_loss: 2902392.1875; val_gene_expr_recon_loss: 12136694.0000; val_masked_gp_l1_reg_loss: 97473.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83177.3984; val_chrom_access_recon_loss: 2654779.9375; val_global_loss: 17955691.7500; val_optim_loss: 17955691.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8887; val_auprc_score: 0.8547; val_best_acc_score: 0.8267; val_best_f1_score: 0.8409; train_kl_reg_loss: 89844.3898; train_edge_recon_loss: 2848377.4053; train_gene_expr_recon_loss: 12361918.8636; train_masked_gp_l1_reg_loss: 98367.4570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81764.9419; train_chrom_access_recon_loss: 2756575.2576; train_global_loss: 18236848.1818; train_optim_loss: 18236848.1818; val_kl_reg_loss: 96231.0820; val_edge_recon_loss: 2864554.5000; val_gene_expr_recon_loss: 12183010.8750; val_masked_gp_l1_reg_loss: 99297.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80251.6172; val_chrom_access_recon_loss: 2655927.4375; val_global_loss: 17979273.0000; val_optim_loss: 17979273.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8918; val_auprc_score: 0.8561; val_best_acc_score: 0.8323; val_best_f1_score: 0.8442; train_kl_reg_loss: 96942.0223; train_edge_recon_loss: 2804429.3523; train_gene_expr_recon_loss: 12299074.3030; train_masked_gp_l1_reg_loss: 100039.7605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78528.8967; train_chrom_access_recon_loss: 2745080.4659; train_global_loss: 18124094.7576; train_optim_loss: 18124094.7576; val_kl_reg_loss: 93133.8545; val_edge_recon_loss: 2866140.4688; val_gene_expr_recon_loss: 11937720.2500; val_masked_gp_l1_reg_loss: 101062.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77518.3984; val_chrom_access_recon_loss: 2632790.2500; val_global_loss: 17708365.5000; val_optim_loss: 17708365.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9031; val_auprc_score: 0.8700; val_best_acc_score: 0.8418; val_best_f1_score: 0.8523; train_kl_reg_loss: 96573.1526; train_edge_recon_loss: 2793072.9167; train_gene_expr_recon_loss: 12233468.2424; train_masked_gp_l1_reg_loss: 101695.0194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75753.9856; train_chrom_access_recon_loss: 2733624.1515; train_global_loss: 18034187.2727; train_optim_loss: 18034187.2727; val_kl_reg_loss: 94855.9883; val_edge_recon_loss: 2809585.2188; val_gene_expr_recon_loss: 11962032.6250; val_masked_gp_l1_reg_loss: 102446.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74283.2500; val_chrom_access_recon_loss: 2644554.9688; val_global_loss: 17687757.7500; val_optim_loss: 17687757.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8980; val_auprc_score: 0.8626; val_best_acc_score: 0.8415; val_best_f1_score: 0.8530; train_kl_reg_loss: 95288.9060; train_edge_recon_loss: 2801668.2045; train_gene_expr_recon_loss: 12184772.4394; train_masked_gp_l1_reg_loss: 102707.7190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72636.6506; train_chrom_access_recon_loss: 2722169.6439; train_global_loss: 17979243.6061; train_optim_loss: 17979243.6061; val_kl_reg_loss: 94213.8887; val_edge_recon_loss: 2867809.2500; val_gene_expr_recon_loss: 11924540.0000; val_masked_gp_l1_reg_loss: 103275.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71419.2891; val_chrom_access_recon_loss: 2629211.6875; val_global_loss: 17690469.7500; val_optim_loss: 17690469.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9096; val_auprc_score: 0.8805; val_best_acc_score: 0.8426; val_best_f1_score: 0.8547; train_kl_reg_loss: 90594.0254; train_edge_recon_loss: 2789788.3220; train_gene_expr_recon_loss: 12137699.3636; train_masked_gp_l1_reg_loss: 103740.5797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69964.6461; train_chrom_access_recon_loss: 2714239.4015; train_global_loss: 17906026.4242; train_optim_loss: 17906026.4242; val_kl_reg_loss: 85287.9961; val_edge_recon_loss: 2837847.9062; val_gene_expr_recon_loss: 11809181.1250; val_masked_gp_l1_reg_loss: 104597.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69084.2578; val_chrom_access_recon_loss: 2587896.7188; val_global_loss: 17493895.5000; val_optim_loss: 17493895.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9098; val_auprc_score: 0.8704; val_best_acc_score: 0.8501; val_best_f1_score: 0.8592; train_kl_reg_loss: 88882.9103; train_edge_recon_loss: 2804849.5644; train_gene_expr_recon_loss: 12094891.3636; train_masked_gp_l1_reg_loss: 104962.0630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68353.1504; train_chrom_access_recon_loss: 2704203.3030; train_global_loss: 17866142.3636; train_optim_loss: 17866142.3636; val_kl_reg_loss: 85326.3018; val_edge_recon_loss: 2835141.0625; val_gene_expr_recon_loss: 11975899.2500; val_masked_gp_l1_reg_loss: 105449.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67648.0469; val_chrom_access_recon_loss: 2634751.4375; val_global_loss: 17704215.2500; val_optim_loss: 17704215.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9158; val_auprc_score: 0.8900; val_best_acc_score: 0.8541; val_best_f1_score: 0.8628; train_kl_reg_loss: 88702.8581; train_edge_recon_loss: 2778388.9318; train_gene_expr_recon_loss: 12046495.5152; train_masked_gp_l1_reg_loss: 105974.6452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67247.3561; train_chrom_access_recon_loss: 2693427.9356; train_global_loss: 17780237.3333; train_optim_loss: 17780237.3333; val_kl_reg_loss: 89065.4072; val_edge_recon_loss: 2834802.6875; val_gene_expr_recon_loss: 11803544.2500; val_masked_gp_l1_reg_loss: 106605.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66498.5391; val_chrom_access_recon_loss: 2589785.0625; val_global_loss: 17490302.5000; val_optim_loss: 17490302.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9132; val_auprc_score: 0.8813; val_best_acc_score: 0.8522; val_best_f1_score: 0.8648; train_kl_reg_loss: 85043.4775; train_edge_recon_loss: 2791276.2765; train_gene_expr_recon_loss: 12019243.3788; train_masked_gp_l1_reg_loss: 106941.8321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66564.8163; train_chrom_access_recon_loss: 2690296.9470; train_global_loss: 17759366.8182; train_optim_loss: 17759366.8182; val_kl_reg_loss: 85171.0830; val_edge_recon_loss: 2809714.5625; val_gene_expr_recon_loss: 11829748.6250; val_masked_gp_l1_reg_loss: 107570.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66061.4297; val_chrom_access_recon_loss: 2602005.2812; val_global_loss: 17500271.5000; val_optim_loss: 17500271.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9187; val_auprc_score: 0.8864; val_best_acc_score: 0.8598; val_best_f1_score: 0.8678; train_kl_reg_loss: 84581.8464; train_edge_recon_loss: 2769521.8295; train_gene_expr_recon_loss: 11982549.9242; train_masked_gp_l1_reg_loss: 107983.9527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65854.1593; train_chrom_access_recon_loss: 2679941.9167; train_global_loss: 17690433.6364; train_optim_loss: 17690433.6364; val_kl_reg_loss: 82048.9502; val_edge_recon_loss: 2829783.7188; val_gene_expr_recon_loss: 11732178.5000; val_masked_gp_l1_reg_loss: 108630.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65840.8984; val_chrom_access_recon_loss: 2588188.6875; val_global_loss: 17406672.0000; val_optim_loss: 17406672.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9228; val_auprc_score: 0.8930; val_best_acc_score: 0.8702; val_best_f1_score: 0.8788; train_kl_reg_loss: 83782.2225; train_edge_recon_loss: 2771065.3182; train_gene_expr_recon_loss: 11948627.6061; train_masked_gp_l1_reg_loss: 108877.1019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65378.8858; train_chrom_access_recon_loss: 2672330.9697; train_global_loss: 17650062.1212; train_optim_loss: 17650062.1212; val_kl_reg_loss: 82163.1768; val_edge_recon_loss: 2783170.0000; val_gene_expr_recon_loss: 11808755.8750; val_masked_gp_l1_reg_loss: 109212.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65583.3047; val_chrom_access_recon_loss: 2618151.2188; val_global_loss: 17467035.2500; val_optim_loss: 17467035.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9285; val_auprc_score: 0.9052; val_best_acc_score: 0.8718; val_best_f1_score: 0.8817; train_kl_reg_loss: 84303.5760; train_edge_recon_loss: 2763281.7917; train_gene_expr_recon_loss: 11895534.5000; train_masked_gp_l1_reg_loss: 109517.3145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64916.3069; train_chrom_access_recon_loss: 2667281.5076; train_global_loss: 17584835.0000; train_optim_loss: 17584835.0000; val_kl_reg_loss: 84506.7871; val_edge_recon_loss: 2780333.5000; val_gene_expr_recon_loss: 11738116.5000; val_masked_gp_l1_reg_loss: 109454.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63852.3164; val_chrom_access_recon_loss: 2582305.4375; val_global_loss: 17358569.2500; val_optim_loss: 17358569.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9198; val_auprc_score: 0.8927; val_best_acc_score: 0.8619; val_best_f1_score: 0.8729; train_kl_reg_loss: 84282.6628; train_edge_recon_loss: 2752070.0644; train_gene_expr_recon_loss: 11871332.4394; train_masked_gp_l1_reg_loss: 109725.9331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63771.3985; train_chrom_access_recon_loss: 2661393.5833; train_global_loss: 17542576.0606; train_optim_loss: 17542576.0606; val_kl_reg_loss: 84696.0225; val_edge_recon_loss: 2813952.9688; val_gene_expr_recon_loss: 11688576.5000; val_masked_gp_l1_reg_loss: 109950.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63706.9766; val_chrom_access_recon_loss: 2570724.2812; val_global_loss: 17331607.5000; val_optim_loss: 17331607.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9310; val_auprc_score: 0.9036; val_best_acc_score: 0.8769; val_best_f1_score: 0.8848; train_kl_reg_loss: 83569.9450; train_edge_recon_loss: 2742672.6288; train_gene_expr_recon_loss: 11842435.8030; train_masked_gp_l1_reg_loss: 110126.4336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63262.5136; train_chrom_access_recon_loss: 2654734.8561; train_global_loss: 17496802.1818; train_optim_loss: 17496802.1818; val_kl_reg_loss: 82274.7988; val_edge_recon_loss: 2770535.4688; val_gene_expr_recon_loss: 11644653.2500; val_masked_gp_l1_reg_loss: 110101.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63007.0039; val_chrom_access_recon_loss: 2571514.2500; val_global_loss: 17242086.5000; val_optim_loss: 17242086.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9369; val_auprc_score: 0.9167; val_best_acc_score: 0.8796; val_best_f1_score: 0.8838; train_kl_reg_loss: 84599.6135; train_edge_recon_loss: 2724406.0455; train_gene_expr_recon_loss: 11804775.0758; train_masked_gp_l1_reg_loss: 110400.3237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62610.6395; train_chrom_access_recon_loss: 2644061.5871; train_global_loss: 17430853.3636; train_optim_loss: 17430853.3636; val_kl_reg_loss: 84282.2754; val_edge_recon_loss: 2743739.8125; val_gene_expr_recon_loss: 11633388.6250; val_masked_gp_l1_reg_loss: 110667.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62465.5625; val_chrom_access_recon_loss: 2535589.9688; val_global_loss: 17170134.5000; val_optim_loss: 17170134.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9368; val_auprc_score: 0.9100; val_best_acc_score: 0.8772; val_best_f1_score: 0.8823; train_kl_reg_loss: 83064.8504; train_edge_recon_loss: 2735985.5114; train_gene_expr_recon_loss: 11798857.7576; train_masked_gp_l1_reg_loss: 110740.9201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62027.7614; train_chrom_access_recon_loss: 2644084.2614; train_global_loss: 17434761.0606; train_optim_loss: 17434761.0606; val_kl_reg_loss: 82212.7207; val_edge_recon_loss: 2763482.6562; val_gene_expr_recon_loss: 11626705.8750; val_masked_gp_l1_reg_loss: 110783.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61502.1641; val_chrom_access_recon_loss: 2554230.9688; val_global_loss: 17198918.2500; val_optim_loss: 17198918.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9372; val_auprc_score: 0.9096; val_best_acc_score: 0.8874; val_best_f1_score: 0.8934; train_kl_reg_loss: 82253.0676; train_edge_recon_loss: 2736444.6515; train_gene_expr_recon_loss: 11768673.7576; train_masked_gp_l1_reg_loss: 110941.9192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61429.7164; train_chrom_access_recon_loss: 2637971.6591; train_global_loss: 17397714.8182; train_optim_loss: 17397714.8182; val_kl_reg_loss: 83773.5283; val_edge_recon_loss: 2768995.6562; val_gene_expr_recon_loss: 11514151.0000; val_masked_gp_l1_reg_loss: 110885.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61303.3086; val_chrom_access_recon_loss: 2544126.4688; val_global_loss: 17083234.7500; val_optim_loss: 17083234.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9401; val_auprc_score: 0.9142; val_best_acc_score: 0.8853; val_best_f1_score: 0.8921; train_kl_reg_loss: 82713.1986; train_edge_recon_loss: 2732392.7652; train_gene_expr_recon_loss: 11744327.2121; train_masked_gp_l1_reg_loss: 111038.9242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61274.9547; train_chrom_access_recon_loss: 2629707.7386; train_global_loss: 17361454.7576; train_optim_loss: 17361454.7576; val_kl_reg_loss: 82466.3311; val_edge_recon_loss: 2768514.5938; val_gene_expr_recon_loss: 11500848.1250; val_masked_gp_l1_reg_loss: 111378.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61246.3984; val_chrom_access_recon_loss: 2552906.2500; val_global_loss: 17077359.5000; val_optim_loss: 17077359.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9376; val_auprc_score: 0.9145; val_best_acc_score: 0.8812; val_best_f1_score: 0.8876; train_kl_reg_loss: 82378.7880; train_edge_recon_loss: 2707855.6553; train_gene_expr_recon_loss: 11729904.1364; train_masked_gp_l1_reg_loss: 111348.8610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60947.5444; train_chrom_access_recon_loss: 2625980.2083; train_global_loss: 17318415.1818; train_optim_loss: 17318415.1818; val_kl_reg_loss: 80927.9102; val_edge_recon_loss: 2754889.2812; val_gene_expr_recon_loss: 11502088.6250; val_masked_gp_l1_reg_loss: 111278.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60965.1133; val_chrom_access_recon_loss: 2544439.8438; val_global_loss: 17054588.6250; val_optim_loss: 17054588.6250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9293; val_auprc_score: 0.8970; val_best_acc_score: 0.8740; val_best_f1_score: 0.8815; train_kl_reg_loss: 106742.7398; train_edge_recon_loss: 2830309.7727; train_gene_expr_recon_loss: 10746170.5303; train_masked_gp_l1_reg_loss: 110751.2612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56055.9570; train_chrom_access_recon_loss: 2474054.4318; train_global_loss: 16324084.6667; train_optim_loss: 16324084.6667; val_kl_reg_loss: 35894.0664; val_edge_recon_loss: 2823677.9688; val_gene_expr_recon_loss: 10504564.2500; val_masked_gp_l1_reg_loss: 109997.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56125.7812; val_chrom_access_recon_loss: 2351539.3438; val_global_loss: 15881798.8750; val_optim_loss: 15881798.8750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9354; val_auprc_score: 0.9086; val_best_acc_score: 0.8877; val_best_f1_score: 0.8928; train_kl_reg_loss: 88485.4311; train_edge_recon_loss: 2753665.1439; train_gene_expr_recon_loss: 10676319.3485; train_masked_gp_l1_reg_loss: 109047.2472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56060.4420; train_chrom_access_recon_loss: 2433457.1780; train_global_loss: 16117034.7576; train_optim_loss: 16117034.7576; val_kl_reg_loss: 41607.3823; val_edge_recon_loss: 2735220.7812; val_gene_expr_recon_loss: 10540052.3750; val_masked_gp_l1_reg_loss: 108047.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56256.1328; val_chrom_access_recon_loss: 2355504.1875; val_global_loss: 15836687.8750; val_optim_loss: 15836687.8750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9408; val_auprc_score: 0.9120; val_best_acc_score: 0.8912; val_best_f1_score: 0.8956; train_kl_reg_loss: 74453.3326; train_edge_recon_loss: 2731282.0947; train_gene_expr_recon_loss: 10648179.9242; train_masked_gp_l1_reg_loss: 107165.1637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56126.2655; train_chrom_access_recon_loss: 2425423.0682; train_global_loss: 16042629.8030; train_optim_loss: 16042629.8030; val_kl_reg_loss: 46011.8423; val_edge_recon_loss: 2748473.2812; val_gene_expr_recon_loss: 10477419.2500; val_masked_gp_l1_reg_loss: 106284.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55880.0352; val_chrom_access_recon_loss: 2353037.6875; val_global_loss: 15787106.8750; val_optim_loss: 15787106.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9413; val_auprc_score: 0.9206; val_best_acc_score: 0.8831; val_best_f1_score: 0.8896; train_kl_reg_loss: 69166.7556; train_edge_recon_loss: 2729664.3333; train_gene_expr_recon_loss: 10640613.4091; train_masked_gp_l1_reg_loss: 105404.4021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55668.6895; train_chrom_access_recon_loss: 2420023.6780; train_global_loss: 16020541.1515; train_optim_loss: 16020541.1515; val_kl_reg_loss: 50626.9526; val_edge_recon_loss: 2759487.2188; val_gene_expr_recon_loss: 10391294.5000; val_masked_gp_l1_reg_loss: 104530.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55610.2930; val_chrom_access_recon_loss: 2343383.4062; val_global_loss: 15704933.1250; val_optim_loss: 15704933.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9391; val_auprc_score: 0.9113; val_best_acc_score: 0.8888; val_best_f1_score: 0.8941; train_kl_reg_loss: 67530.5543; train_edge_recon_loss: 2712248.2235; train_gene_expr_recon_loss: 10616848.5606; train_masked_gp_l1_reg_loss: 103719.8531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55405.1538; train_chrom_access_recon_loss: 2415658.4848; train_global_loss: 15971410.7424; train_optim_loss: 15971410.7424; val_kl_reg_loss: 51208.3584; val_edge_recon_loss: 2724935.7812; val_gene_expr_recon_loss: 10406620.5000; val_masked_gp_l1_reg_loss: 102896.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55145.1875; val_chrom_access_recon_loss: 2337041.9375; val_global_loss: 15677847.3750; val_optim_loss: 15677847.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9422; val_auprc_score: 0.9213; val_best_acc_score: 0.8869; val_best_f1_score: 0.8918; train_kl_reg_loss: 64569.9167; train_edge_recon_loss: 2718942.7652; train_gene_expr_recon_loss: 10599600.3030; train_masked_gp_l1_reg_loss: 102222.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55153.4332; train_chrom_access_recon_loss: 2409769.1288; train_global_loss: 15950258.3788; train_optim_loss: 15950258.3788; val_kl_reg_loss: 54806.2896; val_edge_recon_loss: 2729678.8438; val_gene_expr_recon_loss: 10420632.3750; val_masked_gp_l1_reg_loss: 101516.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54944.1016; val_chrom_access_recon_loss: 2344738.1875; val_global_loss: 15706316.6250; val_optim_loss: 15706316.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9442; val_auprc_score: 0.9183; val_best_acc_score: 0.8912; val_best_f1_score: 0.8974; train_kl_reg_loss: 64435.9810; train_edge_recon_loss: 2706759.4621; train_gene_expr_recon_loss: 10572907.5909; train_masked_gp_l1_reg_loss: 100784.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54806.6935; train_chrom_access_recon_loss: 2405828.2500; train_global_loss: 15905522.9394; train_optim_loss: 15905522.9394; val_kl_reg_loss: 53003.8979; val_edge_recon_loss: 2715352.2500; val_gene_expr_recon_loss: 10397782.5000; val_masked_gp_l1_reg_loss: 100135.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54966.2070; val_chrom_access_recon_loss: 2330180.5000; val_global_loss: 15651420.2500; val_optim_loss: 15651420.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9482; val_auprc_score: 0.9284; val_best_acc_score: 0.8947; val_best_f1_score: 0.8992; train_kl_reg_loss: 62696.0056; train_edge_recon_loss: 2714370.6364; train_gene_expr_recon_loss: 10563267.2576; train_masked_gp_l1_reg_loss: 99485.7733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54794.2375; train_chrom_access_recon_loss: 2403710.8598; train_global_loss: 15898324.7879; train_optim_loss: 15898324.7879; val_kl_reg_loss: 52853.9736; val_edge_recon_loss: 2715127.2812; val_gene_expr_recon_loss: 10412725.0000; val_masked_gp_l1_reg_loss: 98965.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54633.1953; val_chrom_access_recon_loss: 2319370.6562; val_global_loss: 15653676.0000; val_optim_loss: 15653676.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9411; val_auprc_score: 0.9173; val_best_acc_score: 0.8837; val_best_f1_score: 0.8916; train_kl_reg_loss: 62283.1385; train_edge_recon_loss: 2707864.7992; train_gene_expr_recon_loss: 10546583.1667; train_masked_gp_l1_reg_loss: 98483.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54693.7263; train_chrom_access_recon_loss: 2399858.7045; train_global_loss: 15869767.1667; train_optim_loss: 15869767.1667; val_kl_reg_loss: 54539.9727; val_edge_recon_loss: 2764231.8438; val_gene_expr_recon_loss: 10303632.2500; val_masked_gp_l1_reg_loss: 98084.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54591.3945; val_chrom_access_recon_loss: 2316620.7500; val_global_loss: 15591701.0000; val_optim_loss: 15591701.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9449; val_auprc_score: 0.9268; val_best_acc_score: 0.8853; val_best_f1_score: 0.8904; train_kl_reg_loss: 60330.6557; train_edge_recon_loss: 2721174.8902; train_gene_expr_recon_loss: 10538688.0909; train_masked_gp_l1_reg_loss: 97678.8387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54628.9187; train_chrom_access_recon_loss: 2397348.6098; train_global_loss: 15869850.1364; train_optim_loss: 15869850.1364; val_kl_reg_loss: 52428.9404; val_edge_recon_loss: 2740889.7500; val_gene_expr_recon_loss: 10341351.3750; val_masked_gp_l1_reg_loss: 97391.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54667.5117; val_chrom_access_recon_loss: 2333076.4375; val_global_loss: 15619805.5000; val_optim_loss: 15619805.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9531; val_auprc_score: 0.9327; val_best_acc_score: 0.9009; val_best_f1_score: 0.9055; train_kl_reg_loss: 63534.6681; train_edge_recon_loss: 2697592.0152; train_gene_expr_recon_loss: 10515812.2727; train_masked_gp_l1_reg_loss: 97001.4711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54441.3147; train_chrom_access_recon_loss: 2393752.2917; train_global_loss: 15822134.0303; train_optim_loss: 15822134.0303; val_kl_reg_loss: 54991.2007; val_edge_recon_loss: 2714255.0938; val_gene_expr_recon_loss: 10240636.5000; val_masked_gp_l1_reg_loss: 96766.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54481.4531; val_chrom_access_recon_loss: 2303116.7188; val_global_loss: 15464247.6250; val_optim_loss: 15464247.6250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9493; val_auprc_score: 0.9333; val_best_acc_score: 0.9006; val_best_f1_score: 0.9044; train_kl_reg_loss: 63194.8976; train_edge_recon_loss: 2701951.2992; train_gene_expr_recon_loss: 10508032.9242; train_masked_gp_l1_reg_loss: 96268.4988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54355.0785; train_chrom_access_recon_loss: 2390710.4659; train_global_loss: 15814513.3030; train_optim_loss: 15814513.3030; val_kl_reg_loss: 56364.3906; val_edge_recon_loss: 2741849.4375; val_gene_expr_recon_loss: 10329217.6250; val_masked_gp_l1_reg_loss: 96041.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54533.7617; val_chrom_access_recon_loss: 2327877.5625; val_global_loss: 15605884.8750; val_optim_loss: 15605884.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9513; val_auprc_score: 0.9340; val_best_acc_score: 0.8912; val_best_f1_score: 0.8962; train_kl_reg_loss: 62306.3089; train_edge_recon_loss: 2697675.7652; train_gene_expr_recon_loss: 10498516.1667; train_masked_gp_l1_reg_loss: 95701.3242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54448.6594; train_chrom_access_recon_loss: 2388136.4015; train_global_loss: 15796784.5758; train_optim_loss: 15796784.5758; val_kl_reg_loss: 56446.2778; val_edge_recon_loss: 2737597.3125; val_gene_expr_recon_loss: 10361033.0000; val_masked_gp_l1_reg_loss: 95491.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54534.1797; val_chrom_access_recon_loss: 2324932.0938; val_global_loss: 15630033.8750; val_optim_loss: 15630033.8750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9475; val_auprc_score: 0.9281; val_best_acc_score: 0.8944; val_best_f1_score: 0.8999; train_kl_reg_loss: 61948.1831; train_edge_recon_loss: 2686576.9848; train_gene_expr_recon_loss: 10480573.1061; train_masked_gp_l1_reg_loss: 95188.2556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54398.8060; train_chrom_access_recon_loss: 2383863.5492; train_global_loss: 15762548.9091; train_optim_loss: 15762548.9091; val_kl_reg_loss: 55696.8813; val_edge_recon_loss: 2728197.0312; val_gene_expr_recon_loss: 10239143.8750; val_masked_gp_l1_reg_loss: 94949.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54615.3945; val_chrom_access_recon_loss: 2312746.5312; val_global_loss: 15485348.1250; val_optim_loss: 15485348.1250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9484; val_auprc_score: 0.9293; val_best_acc_score: 0.8971; val_best_f1_score: 0.9007; train_kl_reg_loss: 61116.4795; train_edge_recon_loss: 2701252.0152; train_gene_expr_recon_loss: 10473614.3182; train_masked_gp_l1_reg_loss: 94691.6772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54446.6672; train_chrom_access_recon_loss: 2385230.4015; train_global_loss: 15770351.6212; train_optim_loss: 15770351.6212; val_kl_reg_loss: 58927.0283; val_edge_recon_loss: 2692729.5625; val_gene_expr_recon_loss: 10297579.3750; val_masked_gp_l1_reg_loss: 94595.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54321.2695; val_chrom_access_recon_loss: 2312259.7812; val_global_loss: 15510412.7500; val_optim_loss: 15510412.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9504; val_auprc_score: 0.9253; val_best_acc_score: 0.8976; val_best_f1_score: 0.9019; train_kl_reg_loss: 62989.8172; train_edge_recon_loss: 2688531.9924; train_gene_expr_recon_loss: 10456608.3333; train_masked_gp_l1_reg_loss: 93103.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46874.7297; train_chrom_access_recon_loss: 2374225.4773; train_global_loss: 15722334.0000; train_optim_loss: 15722334.0000; val_kl_reg_loss: 58820.6504; val_edge_recon_loss: 2714684.4062; val_gene_expr_recon_loss: 10317848.1250; val_masked_gp_l1_reg_loss: 92616.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45323.2344; val_chrom_access_recon_loss: 2292084.5000; val_global_loss: 15521377.6250; val_optim_loss: 15521377.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9525; val_auprc_score: 0.9313; val_best_acc_score: 0.9001; val_best_f1_score: 0.9021; train_kl_reg_loss: 63041.0845; train_edge_recon_loss: 2688507.8106; train_gene_expr_recon_loss: 10457492.8788; train_masked_gp_l1_reg_loss: 92519.7507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45113.0310; train_chrom_access_recon_loss: 2375960.3295; train_global_loss: 15722634.8788; train_optim_loss: 15722634.8788; val_kl_reg_loss: 57925.9336; val_edge_recon_loss: 2694279.6875; val_gene_expr_recon_loss: 10241482.8750; val_masked_gp_l1_reg_loss: 92443.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44948.8125; val_chrom_access_recon_loss: 2291725.1875; val_global_loss: 15422805.7500; val_optim_loss: 15422805.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9529; val_auprc_score: 0.9353; val_best_acc_score: 0.9022; val_best_f1_score: 0.9052; train_kl_reg_loss: 62873.4001; train_edge_recon_loss: 2680413.4356; train_gene_expr_recon_loss: 10447323.6818; train_masked_gp_l1_reg_loss: 92398.3844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44840.0920; train_chrom_access_recon_loss: 2371992.2424; train_global_loss: 15699841.2727; train_optim_loss: 15699841.2727; val_kl_reg_loss: 58925.0859; val_edge_recon_loss: 2721885.0000; val_gene_expr_recon_loss: 10298399.2500; val_masked_gp_l1_reg_loss: 92365.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44699.2500; val_chrom_access_recon_loss: 2307636.4375; val_global_loss: 15523909.7500; val_optim_loss: 15523909.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9531; val_auprc_score: 0.9341; val_best_acc_score: 0.9087; val_best_f1_score: 0.9116; train_kl_reg_loss: 62931.4621; train_edge_recon_loss: 2677279.5189; train_gene_expr_recon_loss: 10444331.1667; train_masked_gp_l1_reg_loss: 92329.5545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44621.1873; train_chrom_access_recon_loss: 2372349.1250; train_global_loss: 15693841.9394; train_optim_loss: 15693841.9394; val_kl_reg_loss: 58503.7290; val_edge_recon_loss: 2693949.6250; val_gene_expr_recon_loss: 10314567.0000; val_masked_gp_l1_reg_loss: 92300.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44544.5781; val_chrom_access_recon_loss: 2288549.1250; val_global_loss: 15492414.3750; val_optim_loss: 15492414.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9477; val_auprc_score: 0.9257; val_best_acc_score: 0.8984; val_best_f1_score: 0.9041; train_kl_reg_loss: 63175.9337; train_edge_recon_loss: 2680563.7235; train_gene_expr_recon_loss: 10451119.8788; train_masked_gp_l1_reg_loss: 92282.7377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44465.8266; train_chrom_access_recon_loss: 2373504.1477; train_global_loss: 15705112.2273; train_optim_loss: 15705112.2273; val_kl_reg_loss: 59202.8945; val_edge_recon_loss: 2704537.7188; val_gene_expr_recon_loss: 10210732.8750; val_masked_gp_l1_reg_loss: 92260.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44442.4805; val_chrom_access_recon_loss: 2284561.3125; val_global_loss: 15395737.6250; val_optim_loss: 15395737.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9572; val_auprc_score: 0.9421; val_best_acc_score: 0.9017; val_best_f1_score: 0.9061; train_kl_reg_loss: 63552.3762; train_edge_recon_loss: 2694628.8712; train_gene_expr_recon_loss: 10446843.8333; train_masked_gp_l1_reg_loss: 92231.8790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44338.6874; train_chrom_access_recon_loss: 2372216.3144; train_global_loss: 15713811.9545; train_optim_loss: 15713811.9545; val_kl_reg_loss: 59593.8086; val_edge_recon_loss: 2703738.4688; val_gene_expr_recon_loss: 10257347.6250; val_masked_gp_l1_reg_loss: 92196.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44252.7188; val_chrom_access_recon_loss: 2285432.0312; val_global_loss: 15442562.0000; val_optim_loss: 15442562.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9482; val_auprc_score: 0.9258; val_best_acc_score: 0.8979; val_best_f1_score: 0.9016; train_kl_reg_loss: 63760.8057; train_edge_recon_loss: 2682337.8939; train_gene_expr_recon_loss: 10443114.5758; train_masked_gp_l1_reg_loss: 92172.8950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44217.5955; train_chrom_access_recon_loss: 2371424.5947; train_global_loss: 15697028.3030; train_optim_loss: 15697028.3030; val_kl_reg_loss: 58708.8213; val_edge_recon_loss: 2730269.3125; val_gene_expr_recon_loss: 10337752.2500; val_masked_gp_l1_reg_loss: 92148.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44135.9922; val_chrom_access_recon_loss: 2311694.2188; val_global_loss: 15574708.3750; val_optim_loss: 15574708.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9514; val_auprc_score: 0.9327; val_best_acc_score: 0.9017; val_best_f1_score: 0.9068; train_kl_reg_loss: 63286.4728; train_edge_recon_loss: 2678430.9848; train_gene_expr_recon_loss: 10439567.5152; train_masked_gp_l1_reg_loss: 92117.4848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44088.0048; train_chrom_access_recon_loss: 2370776.0682; train_global_loss: 15688266.5303; train_optim_loss: 15688266.5303; val_kl_reg_loss: 59090.2061; val_edge_recon_loss: 2682014.0000; val_gene_expr_recon_loss: 10258095.6250; val_masked_gp_l1_reg_loss: 92096.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43996.1016; val_chrom_access_recon_loss: 2297178.8438; val_global_loss: 15432471.6250; val_optim_loss: 15432471.6250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9489; val_auprc_score: 0.9283; val_best_acc_score: 0.8949; val_best_f1_score: 0.8998; train_kl_reg_loss: 63776.0620; train_edge_recon_loss: 2686698.2462; train_gene_expr_recon_loss: 10435814.4697; train_masked_gp_l1_reg_loss: 92069.9773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43944.0955; train_chrom_access_recon_loss: 2369146.7879; train_global_loss: 15691449.6364; train_optim_loss: 15691449.6364; val_kl_reg_loss: 59606.7515; val_edge_recon_loss: 2712359.3438; val_gene_expr_recon_loss: 10310275.2500; val_masked_gp_l1_reg_loss: 92046.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43892.0820; val_chrom_access_recon_loss: 2311179.5625; val_global_loss: 15529359.0000; val_optim_loss: 15529359.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9443; val_auprc_score: 0.9204; val_best_acc_score: 0.8955; val_best_f1_score: 0.9016; train_kl_reg_loss: 63343.6016; train_edge_recon_loss: 2679186.0189; train_gene_expr_recon_loss: 10441114.2424; train_masked_gp_l1_reg_loss: 91887.5097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43089.6001; train_chrom_access_recon_loss: 2372067.9470; train_global_loss: 15690688.9697; train_optim_loss: 15690688.9697; val_kl_reg_loss: 59068.5352; val_edge_recon_loss: 2706776.5625; val_gene_expr_recon_loss: 10214252.6250; val_masked_gp_l1_reg_loss: 91833.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42931.2969; val_chrom_access_recon_loss: 2285517.5938; val_global_loss: 15400380.3750; val_optim_loss: 15400380.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9568; val_auprc_score: 0.9428; val_best_acc_score: 0.9054; val_best_f1_score: 0.9088; train_kl_reg_loss: 63449.9774; train_edge_recon_loss: 2696677.4962; train_gene_expr_recon_loss: 10443580.3030; train_masked_gp_l1_reg_loss: 91817.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42912.8568; train_chrom_access_recon_loss: 2371395.6364; train_global_loss: 15709833.9697; train_optim_loss: 15709833.9697; val_kl_reg_loss: 59574.4141; val_edge_recon_loss: 2701226.6562; val_gene_expr_recon_loss: 10249940.7500; val_masked_gp_l1_reg_loss: 91805.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42897.5977; val_chrom_access_recon_loss: 2276140.5625; val_global_loss: 15421586.5000; val_optim_loss: 15421586.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9440; val_auprc_score: 0.9179; val_best_acc_score: 0.8968; val_best_f1_score: 0.9018; train_kl_reg_loss: 63335.6622; train_edge_recon_loss: 2685732.1288; train_gene_expr_recon_loss: 10433024.6212; train_masked_gp_l1_reg_loss: 91798.0033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42887.2299; train_chrom_access_recon_loss: 2370523.0341; train_global_loss: 15687300.6515; train_optim_loss: 15687300.6515; val_kl_reg_loss: 59306.2397; val_edge_recon_loss: 2721089.2188; val_gene_expr_recon_loss: 10241907.5000; val_masked_gp_l1_reg_loss: 91789.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42871.9492; val_chrom_access_recon_loss: 2293747.7812; val_global_loss: 15450712.6250; val_optim_loss: 15450712.6250
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9499; val_auprc_score: 0.9308; val_best_acc_score: 0.8990; val_best_f1_score: 0.9038; train_kl_reg_loss: 63376.4858; train_edge_recon_loss: 2690573.3220; train_gene_expr_recon_loss: 10442899.2273; train_masked_gp_l1_reg_loss: 91783.5395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42861.5656; train_chrom_access_recon_loss: 2371987.8144; train_global_loss: 15703481.8333; train_optim_loss: 15703481.8333; val_kl_reg_loss: 59613.1636; val_edge_recon_loss: 2721135.5000; val_gene_expr_recon_loss: 10352768.6250; val_masked_gp_l1_reg_loss: 91777.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42850.8906; val_chrom_access_recon_loss: 2291883.6875; val_global_loss: 15560029.8750; val_optim_loss: 15560029.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 1 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9528
val AUPRC score: 0.9331
val best accuracy score: 0.8990
val best F1 score: 0.9045
val target rna MSE score: 1.9348
val source rna MSE score: 0.9081
val target atac MSE score: 0.4473
val source atac MSE score: 0.1826
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
