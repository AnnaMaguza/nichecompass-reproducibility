[True]
Run timestamp: 07082023_185404_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8919; val_auprc_score: 0.8916; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 6828.7440; train_edge_recon_loss: 35552.9227; train_gene_expr_recon_loss: 637921.6875; train_masked_gp_l1_reg_loss: 15889.4840; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266954.4392; train_global_loss: 963147.2778; train_optim_loss: 963147.2778; val_kl_reg_loss: 11420.2412; val_edge_recon_loss: 40649.9258; val_gene_expr_recon_loss: 575816.5000; val_masked_gp_l1_reg_loss: 10856.5742; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260731.8125; val_global_loss: 899475.0625; val_optim_loss: 899475.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8926; val_auprc_score: 0.8859; val_best_acc_score: 0.5181; val_best_f1_score: 0.6747; train_kl_reg_loss: 16916.1332; train_edge_recon_loss: 38307.0777; train_gene_expr_recon_loss: 559684.8611; train_masked_gp_l1_reg_loss: 9110.4953; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262453.2587; train_global_loss: 886471.8194; train_optim_loss: 886471.8194; val_kl_reg_loss: 18302.1660; val_edge_recon_loss: 40640.5625; val_gene_expr_recon_loss: 516342.4062; val_masked_gp_l1_reg_loss: 7983.1533; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255775.2656; val_global_loss: 839043.5000; val_optim_loss: 839043.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8902; val_auprc_score: 0.8853; val_best_acc_score: 0.5309; val_best_f1_score: 0.6806; train_kl_reg_loss: 22047.8394; train_edge_recon_loss: 38864.1280; train_gene_expr_recon_loss: 509179.2569; train_masked_gp_l1_reg_loss: 8363.7916; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257513.0451; train_global_loss: 835968.0347; train_optim_loss: 835968.0347; val_kl_reg_loss: 19021.1191; val_edge_recon_loss: 40633.6758; val_gene_expr_recon_loss: 487400.8750; val_masked_gp_l1_reg_loss: 8631.3750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251890.5781; val_global_loss: 807577.6250; val_optim_loss: 807577.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8839; val_auprc_score: 0.8774; val_best_acc_score: 0.5523; val_best_f1_score: 0.6901; train_kl_reg_loss: 22461.8980; train_edge_recon_loss: 38908.1146; train_gene_expr_recon_loss: 485624.7986; train_masked_gp_l1_reg_loss: 8531.5762; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253263.0122; train_global_loss: 808789.4028; train_optim_loss: 808789.4028; val_kl_reg_loss: 20983.1582; val_edge_recon_loss: 40619.1445; val_gene_expr_recon_loss: 465908.5938; val_masked_gp_l1_reg_loss: 8444.5889; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248967.0938; val_global_loss: 784922.5000; val_optim_loss: 784922.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8931; val_auprc_score: 0.8863; val_best_acc_score: 0.5874; val_best_f1_score: 0.7062; train_kl_reg_loss: 22625.7615; train_edge_recon_loss: 38942.9245; train_gene_expr_recon_loss: 468029.9444; train_masked_gp_l1_reg_loss: 8410.1487; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250749.1441; train_global_loss: 788757.9028; train_optim_loss: 788757.9028; val_kl_reg_loss: 21512.1055; val_edge_recon_loss: 40599.1055; val_gene_expr_recon_loss: 452618.3125; val_masked_gp_l1_reg_loss: 8337.3740; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246748.5312; val_global_loss: 769815.4375; val_optim_loss: 769815.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8888; val_auprc_score: 0.8825; val_best_acc_score: 0.6452; val_best_f1_score: 0.7350; train_kl_reg_loss: 23123.3318; train_edge_recon_loss: 38946.3993; train_gene_expr_recon_loss: 457877.7535; train_masked_gp_l1_reg_loss: 8305.3672; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249928.0972; train_global_loss: 778180.9444; train_optim_loss: 778180.9444; val_kl_reg_loss: 21805.5117; val_edge_recon_loss: 40569.2344; val_gene_expr_recon_loss: 442889.9688; val_masked_gp_l1_reg_loss: 8258.9668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244984.9844; val_global_loss: 758508.6875; val_optim_loss: 758508.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8953; val_auprc_score: 0.8826; val_best_acc_score: 0.7138; val_best_f1_score: 0.7725; train_kl_reg_loss: 23573.0521; train_edge_recon_loss: 39007.7070; train_gene_expr_recon_loss: 445337.2465; train_masked_gp_l1_reg_loss: 8243.4041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246848.9062; train_global_loss: 763010.2986; train_optim_loss: 763010.2986; val_kl_reg_loss: 23239.4414; val_edge_recon_loss: 40500.5664; val_gene_expr_recon_loss: 434073.6250; val_masked_gp_l1_reg_loss: 8210.5879; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243206.5625; val_global_loss: 749230.7500; val_optim_loss: 749230.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8968; val_auprc_score: 0.8865; val_best_acc_score: 0.7590; val_best_f1_score: 0.7973; train_kl_reg_loss: 24463.9277; train_edge_recon_loss: 39020.8520; train_gene_expr_recon_loss: 438878.2431; train_masked_gp_l1_reg_loss: 8195.3667; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245098.1076; train_global_loss: 755656.5069; train_optim_loss: 755656.5069; val_kl_reg_loss: 23049.1641; val_edge_recon_loss: 40416.0352; val_gene_expr_recon_loss: 428443.5000; val_masked_gp_l1_reg_loss: 8184.8564; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241768.5000; val_global_loss: 741862.0000; val_optim_loss: 741862.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9009; val_auprc_score: 0.8921; val_best_acc_score: 0.7905; val_best_f1_score: 0.8157; train_kl_reg_loss: 24855.6513; train_edge_recon_loss: 39004.2548; train_gene_expr_recon_loss: 434962.1979; train_masked_gp_l1_reg_loss: 8183.6946; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244904.5052; train_global_loss: 751910.2986; train_optim_loss: 751910.2986; val_kl_reg_loss: 23521.3281; val_edge_recon_loss: 40344.0195; val_gene_expr_recon_loss: 423281.0938; val_masked_gp_l1_reg_loss: 8179.5322; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240511.5938; val_global_loss: 735837.5625; val_optim_loss: 735837.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9061; val_auprc_score: 0.8983; val_best_acc_score: 0.8092; val_best_f1_score: 0.8271; train_kl_reg_loss: 24952.9076; train_edge_recon_loss: 38962.8793; train_gene_expr_recon_loss: 429451.5139; train_masked_gp_l1_reg_loss: 8182.5581; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243581.8212; train_global_loss: 745131.6806; train_optim_loss: 745131.6806; val_kl_reg_loss: 23460.8438; val_edge_recon_loss: 40308.1016; val_gene_expr_recon_loss: 419422.9688; val_masked_gp_l1_reg_loss: 8182.8711; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239454.9375; val_global_loss: 730829.7500; val_optim_loss: 730829.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9146; val_auprc_score: 0.9074; val_best_acc_score: 0.8306; val_best_f1_score: 0.8414; train_kl_reg_loss: 24595.4612; train_edge_recon_loss: 38923.0508; train_gene_expr_recon_loss: 425397.1285; train_masked_gp_l1_reg_loss: 8192.9722; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241140.7205; train_global_loss: 738249.3403; train_optim_loss: 738249.3403; val_kl_reg_loss: 23649.2578; val_edge_recon_loss: 40235.2266; val_gene_expr_recon_loss: 415920.6250; val_masked_gp_l1_reg_loss: 8196.1230; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238312.2031; val_global_loss: 726313.4375; val_optim_loss: 726313.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9187; val_auprc_score: 0.9125; val_best_acc_score: 0.8455; val_best_f1_score: 0.8504; train_kl_reg_loss: 24350.7600; train_edge_recon_loss: 38875.4015; train_gene_expr_recon_loss: 422953.8854; train_masked_gp_l1_reg_loss: 8198.5143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240839.1632; train_global_loss: 735217.7292; train_optim_loss: 735217.7292; val_kl_reg_loss: 22982.3945; val_edge_recon_loss: 40203.5195; val_gene_expr_recon_loss: 413693.5938; val_masked_gp_l1_reg_loss: 8202.8652; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237453.3750; val_global_loss: 722535.7500; val_optim_loss: 722535.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9229; val_auprc_score: 0.9154; val_best_acc_score: 0.8529; val_best_f1_score: 0.8540; train_kl_reg_loss: 24043.6825; train_edge_recon_loss: 38819.0100; train_gene_expr_recon_loss: 420388.5208; train_masked_gp_l1_reg_loss: 8207.8134; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240354.0938; train_global_loss: 731813.1181; train_optim_loss: 731813.1181; val_kl_reg_loss: 22431.8984; val_edge_recon_loss: 40138.0938; val_gene_expr_recon_loss: 411768.5312; val_masked_gp_l1_reg_loss: 8213.3926; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236595.5781; val_global_loss: 719147.5000; val_optim_loss: 719147.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9272; val_auprc_score: 0.9160; val_best_acc_score: 0.8537; val_best_f1_score: 0.8520; train_kl_reg_loss: 23719.5295; train_edge_recon_loss: 38766.4696; train_gene_expr_recon_loss: 417212.1424; train_masked_gp_l1_reg_loss: 8222.3198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238472.2465; train_global_loss: 726392.7083; train_optim_loss: 726392.7083; val_kl_reg_loss: 22287.0742; val_edge_recon_loss: 40068.8750; val_gene_expr_recon_loss: 409626.3125; val_masked_gp_l1_reg_loss: 8226.2432; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235683.4688; val_global_loss: 715892.0000; val_optim_loss: 715892.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9368; val_auprc_score: 0.9307; val_best_acc_score: 0.8593; val_best_f1_score: 0.8553; train_kl_reg_loss: 23409.5514; train_edge_recon_loss: 38692.3220; train_gene_expr_recon_loss: 416474.6597; train_masked_gp_l1_reg_loss: 8231.9668; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238098.3229; train_global_loss: 724906.8333; train_optim_loss: 724906.8333; val_kl_reg_loss: 22250.6973; val_edge_recon_loss: 40002.2930; val_gene_expr_recon_loss: 407664.2500; val_masked_gp_l1_reg_loss: 8236.7783; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234937.4688; val_global_loss: 713091.5000; val_optim_loss: 713091.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9411; val_auprc_score: 0.9329; val_best_acc_score: 0.8588; val_best_f1_score: 0.8516; train_kl_reg_loss: 23175.5896; train_edge_recon_loss: 38634.1246; train_gene_expr_recon_loss: 415073.3681; train_masked_gp_l1_reg_loss: 8242.9017; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238134.1476; train_global_loss: 723260.1319; train_optim_loss: 723260.1319; val_kl_reg_loss: 21633.0195; val_edge_recon_loss: 39898.2773; val_gene_expr_recon_loss: 406486.5000; val_masked_gp_l1_reg_loss: 8242.0557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234201.8750; val_global_loss: 710461.7500; val_optim_loss: 710461.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9445; val_auprc_score: 0.9382; val_best_acc_score: 0.8584; val_best_f1_score: 0.8483; train_kl_reg_loss: 22831.6786; train_edge_recon_loss: 38567.0964; train_gene_expr_recon_loss: 411845.8819; train_masked_gp_l1_reg_loss: 8248.7758; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236443.4531; train_global_loss: 717936.8750; train_optim_loss: 717936.8750; val_kl_reg_loss: 21263.0859; val_edge_recon_loss: 39855.7422; val_gene_expr_recon_loss: 405261.7812; val_masked_gp_l1_reg_loss: 8250.7090; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233439.4062; val_global_loss: 708070.7500; val_optim_loss: 708070.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9404; val_auprc_score: 0.9313; val_best_acc_score: 0.8467; val_best_f1_score: 0.8353; train_kl_reg_loss: 22468.6163; train_edge_recon_loss: 38517.1411; train_gene_expr_recon_loss: 411665.1389; train_masked_gp_l1_reg_loss: 8257.5603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235672.1128; train_global_loss: 716580.5625; train_optim_loss: 716580.5625; val_kl_reg_loss: 21373.1914; val_edge_recon_loss: 39795.4688; val_gene_expr_recon_loss: 403546.4375; val_masked_gp_l1_reg_loss: 8264.3340; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232746.9219; val_global_loss: 705726.3750; val_optim_loss: 705726.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9459; val_auprc_score: 0.9384; val_best_acc_score: 0.8484; val_best_f1_score: 0.8384; train_kl_reg_loss: 22199.2967; train_edge_recon_loss: 38461.1350; train_gene_expr_recon_loss: 410022.8854; train_masked_gp_l1_reg_loss: 8277.8506; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234791.5608; train_global_loss: 713752.7361; train_optim_loss: 713752.7361; val_kl_reg_loss: 20529.6758; val_edge_recon_loss: 39730.7812; val_gene_expr_recon_loss: 403070.1875; val_masked_gp_l1_reg_loss: 8280.6436; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232196.1406; val_global_loss: 703807.4375; val_optim_loss: 703807.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9497; val_auprc_score: 0.9438; val_best_acc_score: 0.8426; val_best_f1_score: 0.8490; train_kl_reg_loss: 22035.3307; train_edge_recon_loss: 38422.1406; train_gene_expr_recon_loss: 409736.4306; train_masked_gp_l1_reg_loss: 8285.7488; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235217.6997; train_global_loss: 713697.3403; train_optim_loss: 713697.3403; val_kl_reg_loss: 20455.5781; val_edge_recon_loss: 39673.5469; val_gene_expr_recon_loss: 401735.4375; val_masked_gp_l1_reg_loss: 8292.5957; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231698.5781; val_global_loss: 701855.7500; val_optim_loss: 701855.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9527; val_auprc_score: 0.9489; val_best_acc_score: 0.8390; val_best_f1_score: 0.8535; train_kl_reg_loss: 21724.4737; train_edge_recon_loss: 38373.2739; train_gene_expr_recon_loss: 408795.5382; train_masked_gp_l1_reg_loss: 8301.0322; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234253.7344; train_global_loss: 711448.0417; train_optim_loss: 711448.0417; val_kl_reg_loss: 20171.7227; val_edge_recon_loss: 39642.0195; val_gene_expr_recon_loss: 400848.4375; val_masked_gp_l1_reg_loss: 8307.3154; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231116.7031; val_global_loss: 700086.1875; val_optim_loss: 700086.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9492; val_auprc_score: 0.9419; val_best_acc_score: 0.8378; val_best_f1_score: 0.8572; train_kl_reg_loss: 21461.3694; train_edge_recon_loss: 38332.4549; train_gene_expr_recon_loss: 408517.6250; train_masked_gp_l1_reg_loss: 8321.3866; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234731.1701; train_global_loss: 711364.0139; train_optim_loss: 711364.0139; val_kl_reg_loss: 19732.2539; val_edge_recon_loss: 39591.9922; val_gene_expr_recon_loss: 400280.9375; val_masked_gp_l1_reg_loss: 8329.6006; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230621.4375; val_global_loss: 698556.2500; val_optim_loss: 698556.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9523; val_auprc_score: 0.9465; val_best_acc_score: 0.8395; val_best_f1_score: 0.8584; train_kl_reg_loss: 21173.6936; train_edge_recon_loss: 38282.9128; train_gene_expr_recon_loss: 406434.7917; train_masked_gp_l1_reg_loss: 8338.9429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233404.8385; train_global_loss: 707635.1806; train_optim_loss: 707635.1806; val_kl_reg_loss: 19597.6250; val_edge_recon_loss: 39560.1680; val_gene_expr_recon_loss: 399185.3125; val_masked_gp_l1_reg_loss: 8341.6787; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230085.3438; val_global_loss: 696770.1250; val_optim_loss: 696770.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9551; val_auprc_score: 0.9504; val_best_acc_score: 0.8479; val_best_f1_score: 0.8648; train_kl_reg_loss: 20899.2795; train_edge_recon_loss: 38249.6385; train_gene_expr_recon_loss: 405051.5590; train_masked_gp_l1_reg_loss: 8351.9372; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231773.0017; train_global_loss: 704325.4167; train_optim_loss: 704325.4167; val_kl_reg_loss: 19660.8066; val_edge_recon_loss: 39529.5430; val_gene_expr_recon_loss: 398047.0312; val_masked_gp_l1_reg_loss: 8355.7021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229668.4375; val_global_loss: 695261.5000; val_optim_loss: 695261.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9579; val_auprc_score: 0.9564; val_best_acc_score: 0.8549; val_best_f1_score: 0.8701; train_kl_reg_loss: 20684.5720; train_edge_recon_loss: 38219.7899; train_gene_expr_recon_loss: 403934.3993; train_masked_gp_l1_reg_loss: 8364.3085; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232781.1233; train_global_loss: 703984.1875; train_optim_loss: 703984.1875; val_kl_reg_loss: 19397.3203; val_edge_recon_loss: 39479.5898; val_gene_expr_recon_loss: 397331.3750; val_masked_gp_l1_reg_loss: 8372.0322; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229161.5000; val_global_loss: 693741.8125; val_optim_loss: 693741.8125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9538; val_auprc_score: 0.9518; val_best_acc_score: 0.8707; val_best_f1_score: 0.8792; train_kl_reg_loss: 19871.1018; train_edge_recon_loss: 40127.3759; train_gene_expr_recon_loss: 423892.1424; train_masked_gp_l1_reg_loss: 8382.1883; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236993.0260; train_global_loss: 729265.8264; train_optim_loss: 729265.8264; val_kl_reg_loss: 16362.2842; val_edge_recon_loss: 40360.5430; val_gene_expr_recon_loss: 413060.0312; val_masked_gp_l1_reg_loss: 8369.7832; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233127.8281; val_global_loss: 711280.5000; val_optim_loss: 711280.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9513; val_auprc_score: 0.9493; val_best_acc_score: 0.8681; val_best_f1_score: 0.8773; train_kl_reg_loss: 17683.4870; train_edge_recon_loss: 40234.7943; train_gene_expr_recon_loss: 418567.3194; train_masked_gp_l1_reg_loss: 8341.5750; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235020.6701; train_global_loss: 719847.8681; train_optim_loss: 719847.8681; val_kl_reg_loss: 16372.4961; val_edge_recon_loss: 40370.5039; val_gene_expr_recon_loss: 410709.5000; val_masked_gp_l1_reg_loss: 8300.2012; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232614.9219; val_global_loss: 708367.6250; val_optim_loss: 708367.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9480; val_auprc_score: 0.9423; val_best_acc_score: 0.8735; val_best_f1_score: 0.8790; train_kl_reg_loss: 16898.7795; train_edge_recon_loss: 40189.5326; train_gene_expr_recon_loss: 417352.4514; train_masked_gp_l1_reg_loss: 8266.7434; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235847.1962; train_global_loss: 718554.7083; train_optim_loss: 718554.7083; val_kl_reg_loss: 15156.9131; val_edge_recon_loss: 40286.9375; val_gene_expr_recon_loss: 410260.8438; val_masked_gp_l1_reg_loss: 8220.0938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232258.8125; val_global_loss: 706183.6250; val_optim_loss: 706183.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9547; val_auprc_score: 0.9501; val_best_acc_score: 0.8857; val_best_f1_score: 0.8879; train_kl_reg_loss: 16284.3755; train_edge_recon_loss: 40108.5716; train_gene_expr_recon_loss: 416016.3889; train_masked_gp_l1_reg_loss: 8183.9610; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235126.0382; train_global_loss: 715719.3333; train_optim_loss: 715719.3333; val_kl_reg_loss: 14798.3809; val_edge_recon_loss: 40210.4336; val_gene_expr_recon_loss: 409483.6250; val_masked_gp_l1_reg_loss: 8141.9966; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231989.3750; val_global_loss: 704623.8125; val_optim_loss: 704623.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9526; val_auprc_score: 0.9503; val_best_acc_score: 0.8824; val_best_f1_score: 0.8847; train_kl_reg_loss: 16117.2744; train_edge_recon_loss: 40073.3663; train_gene_expr_recon_loss: 417262.3854; train_masked_gp_l1_reg_loss: 8059.7453; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235191.4965; train_global_loss: 716704.2778; train_optim_loss: 716704.2778; val_kl_reg_loss: 14998.7285; val_edge_recon_loss: 40201.4336; val_gene_expr_recon_loss: 409119.0938; val_masked_gp_l1_reg_loss: 7991.4673; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231901.1250; val_global_loss: 704211.8750; val_optim_loss: 704211.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9541; val_auprc_score: 0.9521; val_best_acc_score: 0.8849; val_best_f1_score: 0.8868; train_kl_reg_loss: 16013.2400; train_edge_recon_loss: 40057.4397; train_gene_expr_recon_loss: 417002.2674; train_masked_gp_l1_reg_loss: 7972.9063; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234905.3090; train_global_loss: 715951.1597; train_optim_loss: 715951.1597; val_kl_reg_loss: 14894.3320; val_edge_recon_loss: 40188.1289; val_gene_expr_recon_loss: 409106.3125; val_masked_gp_l1_reg_loss: 7942.9077; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231957.5938; val_global_loss: 704089.2500; val_optim_loss: 704089.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9512; val_auprc_score: 0.9489; val_best_acc_score: 0.8816; val_best_f1_score: 0.8837; train_kl_reg_loss: 16023.0044; train_edge_recon_loss: 40053.8529; train_gene_expr_recon_loss: 417186.7222; train_masked_gp_l1_reg_loss: 7927.8137; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234171.6250; train_global_loss: 715363.0278; train_optim_loss: 715363.0278; val_kl_reg_loss: 14813.5020; val_edge_recon_loss: 40208.9883; val_gene_expr_recon_loss: 409101.6562; val_masked_gp_l1_reg_loss: 7910.1680; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231914.5312; val_global_loss: 703948.8750; val_optim_loss: 703948.8750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9519; val_auprc_score: 0.9491; val_best_acc_score: 0.8821; val_best_f1_score: 0.8840; train_kl_reg_loss: 15931.7776; train_edge_recon_loss: 40046.8268; train_gene_expr_recon_loss: 414787.5312; train_masked_gp_l1_reg_loss: 7899.4873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234068.6545; train_global_loss: 712734.2569; train_optim_loss: 712734.2569; val_kl_reg_loss: 14855.9854; val_edge_recon_loss: 40175.6953; val_gene_expr_recon_loss: 408966.4375; val_masked_gp_l1_reg_loss: 7887.8687; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231901.7344; val_global_loss: 703787.7500; val_optim_loss: 703787.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 56 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9588
val AUPRC score: 0.9546
val best accuracy score: 0.8930
val best F1 score: 0.8937
val target rna MSE score: 0.4806
val source rna MSE score: 0.3047
val target atac MSE score: 0.1291
val source atac MSE score: 0.0186
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
