[True]
Run timestamp: 07092023_165111_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6123; val_auprc_score: 0.6015; val_best_acc_score: 0.5075; val_best_f1_score: 0.6692; train_kl_reg_loss: 81127.8767; train_edge_recon_loss: 3573140.6174; train_gene_expr_recon_loss: 20857347.1818; train_masked_gp_l1_reg_loss: 62033.8672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 873438.4375; train_chrom_access_recon_loss: 2078101.8750; train_global_loss: 27525189.8788; train_optim_loss: 27525189.8788; val_kl_reg_loss: 66415.3540; val_edge_recon_loss: 4064905.9688; val_gene_expr_recon_loss: 19106456.5000; val_masked_gp_l1_reg_loss: 58505.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 742482.3125; val_chrom_access_recon_loss: 1972251.6562; val_global_loss: 26011017.7500; val_optim_loss: 26011017.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7085; val_auprc_score: 0.6875; val_best_acc_score: 0.5562; val_best_f1_score: 0.6875; train_kl_reg_loss: 104636.8492; train_edge_recon_loss: 3534586.2917; train_gene_expr_recon_loss: 18879802.5455; train_masked_gp_l1_reg_loss: 54659.7215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 613153.4408; train_chrom_access_recon_loss: 1965523.7936; train_global_loss: 25152362.6667; train_optim_loss: 25152362.6667; val_kl_reg_loss: 122739.2217; val_edge_recon_loss: 4061392.4062; val_gene_expr_recon_loss: 18564626.7500; val_masked_gp_l1_reg_loss: 52542.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 492024.7188; val_chrom_access_recon_loss: 1954751.3438; val_global_loss: 25248076.0000; val_optim_loss: 25248076.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7585; val_auprc_score: 0.7445; val_best_acc_score: 0.6902; val_best_f1_score: 0.7025; train_kl_reg_loss: 100077.5916; train_edge_recon_loss: 3521201.0720; train_gene_expr_recon_loss: 18545941.8485; train_masked_gp_l1_reg_loss: 53109.9463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 404051.8490; train_chrom_access_recon_loss: 1938825.6970; train_global_loss: 24563207.9394; train_optim_loss: 24563207.9394; val_kl_reg_loss: 104311.2529; val_edge_recon_loss: 4009039.4688; val_gene_expr_recon_loss: 18280713.2500; val_masked_gp_l1_reg_loss: 54349.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 328086.3125; val_chrom_access_recon_loss: 1924213.6094; val_global_loss: 24700713.7500; val_optim_loss: 24700713.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8298; val_auprc_score: 0.7980; val_best_acc_score: 0.7630; val_best_f1_score: 0.7829; train_kl_reg_loss: 85278.8804; train_edge_recon_loss: 3483977.4621; train_gene_expr_recon_loss: 18395081.6667; train_masked_gp_l1_reg_loss: 56058.4761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277122.7067; train_chrom_access_recon_loss: 1928832.5019; train_global_loss: 24226351.3939; train_optim_loss: 24226351.3939; val_kl_reg_loss: 76114.7305; val_edge_recon_loss: 3715912.5312; val_gene_expr_recon_loss: 18111734.7500; val_masked_gp_l1_reg_loss: 57613.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233077.5156; val_chrom_access_recon_loss: 1920669.4219; val_global_loss: 24115123.2500; val_optim_loss: 24115123.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8376; val_auprc_score: 0.7902; val_best_acc_score: 0.7689; val_best_f1_score: 0.7974; train_kl_reg_loss: 78025.2817; train_edge_recon_loss: 3195407.7538; train_gene_expr_recon_loss: 18279135.1515; train_masked_gp_l1_reg_loss: 59563.5286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201591.9463; train_chrom_access_recon_loss: 1918744.7841; train_global_loss: 23732468.5758; train_optim_loss: 23732468.5758; val_kl_reg_loss: 93077.9902; val_edge_recon_loss: 2994994.7188; val_gene_expr_recon_loss: 18129561.2500; val_masked_gp_l1_reg_loss: 61238.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173500.3438; val_chrom_access_recon_loss: 1922478.5938; val_global_loss: 23374850.7500; val_optim_loss: 23374850.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8525; val_auprc_score: 0.8081; val_best_acc_score: 0.7872; val_best_f1_score: 0.8150; train_kl_reg_loss: 104293.0419; train_edge_recon_loss: 2965408.1932; train_gene_expr_recon_loss: 18135185.3636; train_masked_gp_l1_reg_loss: 62082.6797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152341.9105; train_chrom_access_recon_loss: 1904564.9186; train_global_loss: 23323876.0000; train_optim_loss: 23323876.0000; val_kl_reg_loss: 103315.6582; val_edge_recon_loss: 2948288.6875; val_gene_expr_recon_loss: 17816375.8750; val_masked_gp_l1_reg_loss: 63089.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133622.4062; val_chrom_access_recon_loss: 1893419.9844; val_global_loss: 22958112.0000; val_optim_loss: 22958112.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8557; val_auprc_score: 0.8241; val_best_acc_score: 0.7915; val_best_f1_score: 0.8199; train_kl_reg_loss: 103540.8582; train_edge_recon_loss: 2902016.1061; train_gene_expr_recon_loss: 18037991.7273; train_masked_gp_l1_reg_loss: 64303.3328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120013.7666; train_chrom_access_recon_loss: 1895127.4110; train_global_loss: 23122993.0606; train_optim_loss: 23122993.0606; val_kl_reg_loss: 100798.4326; val_edge_recon_loss: 2902991.7812; val_gene_expr_recon_loss: 17972476.7500; val_masked_gp_l1_reg_loss: 65610.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107846.7656; val_chrom_access_recon_loss: 1908211.5312; val_global_loss: 23057934.2500; val_optim_loss: 23057934.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8706; val_auprc_score: 0.8378; val_best_acc_score: 0.7972; val_best_f1_score: 0.8223; train_kl_reg_loss: 102015.8345; train_edge_recon_loss: 2887914.3258; train_gene_expr_recon_loss: 17945960.3333; train_masked_gp_l1_reg_loss: 66603.1293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98605.1010; train_chrom_access_recon_loss: 1886852.2121; train_global_loss: 22987950.8182; train_optim_loss: 22987950.8182; val_kl_reg_loss: 98915.0830; val_edge_recon_loss: 2897454.2188; val_gene_expr_recon_loss: 17809040.0000; val_masked_gp_l1_reg_loss: 67758.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90185.5781; val_chrom_access_recon_loss: 1884808.6250; val_global_loss: 22848162.0000; val_optim_loss: 22848162.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8713; val_auprc_score: 0.8373; val_best_acc_score: 0.7966; val_best_f1_score: 0.8211; train_kl_reg_loss: 100144.2582; train_edge_recon_loss: 2847995.7576; train_gene_expr_recon_loss: 17858081.3939; train_masked_gp_l1_reg_loss: 68694.3742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83987.4459; train_chrom_access_recon_loss: 1878388.5890; train_global_loss: 22837292.2121; train_optim_loss: 22837292.2121; val_kl_reg_loss: 102270.0713; val_edge_recon_loss: 2907406.5000; val_gene_expr_recon_loss: 17852486.2500; val_masked_gp_l1_reg_loss: 69742.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78174.8203; val_chrom_access_recon_loss: 1885903.2812; val_global_loss: 22895982.5000; val_optim_loss: 22895982.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8920; val_auprc_score: 0.8636; val_best_acc_score: 0.8200; val_best_f1_score: 0.8343; train_kl_reg_loss: 98467.1335; train_edge_recon_loss: 2835902.3523; train_gene_expr_recon_loss: 17793815.7879; train_masked_gp_l1_reg_loss: 70498.3034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73417.4238; train_chrom_access_recon_loss: 1870889.0398; train_global_loss: 22742990.1212; train_optim_loss: 22742990.1212; val_kl_reg_loss: 97558.2031; val_edge_recon_loss: 2849471.2812; val_gene_expr_recon_loss: 17611799.0000; val_masked_gp_l1_reg_loss: 71632.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69165.5938; val_chrom_access_recon_loss: 1876793.3438; val_global_loss: 22576420.2500; val_optim_loss: 22576420.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8941; val_auprc_score: 0.8656; val_best_acc_score: 0.8240; val_best_f1_score: 0.8354; train_kl_reg_loss: 97171.4787; train_edge_recon_loss: 2818087.7121; train_gene_expr_recon_loss: 17724685.0606; train_masked_gp_l1_reg_loss: 72366.8654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65701.6955; train_chrom_access_recon_loss: 1864937.1780; train_global_loss: 22642950.2121; train_optim_loss: 22642950.2121; val_kl_reg_loss: 101555.3799; val_edge_recon_loss: 2841032.1562; val_gene_expr_recon_loss: 17552343.5000; val_masked_gp_l1_reg_loss: 73229.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62419.7734; val_chrom_access_recon_loss: 1870584.7188; val_global_loss: 22501165.2500; val_optim_loss: 22501165.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8948; val_auprc_score: 0.8620; val_best_acc_score: 0.8248; val_best_f1_score: 0.8433; train_kl_reg_loss: 96414.5928; train_edge_recon_loss: 2816530.9621; train_gene_expr_recon_loss: 17651238.3182; train_masked_gp_l1_reg_loss: 73902.2405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59826.2540; train_chrom_access_recon_loss: 1857826.4148; train_global_loss: 22555738.9091; train_optim_loss: 22555738.9091; val_kl_reg_loss: 93730.8838; val_edge_recon_loss: 2857794.8125; val_gene_expr_recon_loss: 17525352.7500; val_masked_gp_l1_reg_loss: 74589.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57490.5156; val_chrom_access_recon_loss: 1852302.4062; val_global_loss: 22461261.0000; val_optim_loss: 22461261.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9205; val_auprc_score: 0.8897; val_best_acc_score: 0.8584; val_best_f1_score: 0.8661; train_kl_reg_loss: 94024.3500; train_edge_recon_loss: 2794904.9659; train_gene_expr_recon_loss: 17590845.8485; train_masked_gp_l1_reg_loss: 75467.9763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55579.9117; train_chrom_access_recon_loss: 1850217.3390; train_global_loss: 22461040.2727; train_optim_loss: 22461040.2727; val_kl_reg_loss: 93398.4531; val_edge_recon_loss: 2777646.7188; val_gene_expr_recon_loss: 17623569.5000; val_masked_gp_l1_reg_loss: 76299.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53840.8516; val_chrom_access_recon_loss: 1844670.6875; val_global_loss: 22469425.5000; val_optim_loss: 22469425.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9185; val_auprc_score: 0.8937; val_best_acc_score: 0.8549; val_best_f1_score: 0.8612; train_kl_reg_loss: 92926.1249; train_edge_recon_loss: 2780562.4508; train_gene_expr_recon_loss: 17536176.4697; train_masked_gp_l1_reg_loss: 77096.6765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52040.3101; train_chrom_access_recon_loss: 1844050.1004; train_global_loss: 22382852.0303; train_optim_loss: 22382852.0303; val_kl_reg_loss: 92645.1670; val_edge_recon_loss: 2820647.7188; val_gene_expr_recon_loss: 17338697.2500; val_masked_gp_l1_reg_loss: 77907.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50708.8242; val_chrom_access_recon_loss: 1829212.2969; val_global_loss: 22209818.2500; val_optim_loss: 22209818.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9263; val_auprc_score: 0.9028; val_best_acc_score: 0.8641; val_best_f1_score: 0.8714; train_kl_reg_loss: 91405.5276; train_edge_recon_loss: 2765621.1818; train_gene_expr_recon_loss: 17479609.8939; train_masked_gp_l1_reg_loss: 78615.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49349.7739; train_chrom_access_recon_loss: 1839722.8807; train_global_loss: 22304325.3333; train_optim_loss: 22304325.3333; val_kl_reg_loss: 93482.0820; val_edge_recon_loss: 2802219.5625; val_gene_expr_recon_loss: 17475771.0000; val_masked_gp_l1_reg_loss: 79583.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48159.6914; val_chrom_access_recon_loss: 1850030.3281; val_global_loss: 22349246.7500; val_optim_loss: 22349246.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9273; val_auprc_score: 0.9006; val_best_acc_score: 0.8678; val_best_f1_score: 0.8753; train_kl_reg_loss: 93522.6502; train_edge_recon_loss: 2758691.6780; train_gene_expr_recon_loss: 17410735.6970; train_masked_gp_l1_reg_loss: 80085.2803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47003.4764; train_chrom_access_recon_loss: 1832787.2311; train_global_loss: 22222825.9697; train_optim_loss: 22222825.9697; val_kl_reg_loss: 94921.7012; val_edge_recon_loss: 2792660.1562; val_gene_expr_recon_loss: 17440608.3750; val_masked_gp_l1_reg_loss: 80593.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45984.3438; val_chrom_access_recon_loss: 1842625.4219; val_global_loss: 22297394.2500; val_optim_loss: 22297394.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9261; val_auprc_score: 0.9008; val_best_acc_score: 0.8662; val_best_f1_score: 0.8712; train_kl_reg_loss: 91764.7795; train_edge_recon_loss: 2743778.7045; train_gene_expr_recon_loss: 17373236.9848; train_masked_gp_l1_reg_loss: 81254.5604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45014.5181; train_chrom_access_recon_loss: 1827119.9053; train_global_loss: 22162169.3333; train_optim_loss: 22162169.3333; val_kl_reg_loss: 90754.3174; val_edge_recon_loss: 2815278.9062; val_gene_expr_recon_loss: 17305968.7500; val_masked_gp_l1_reg_loss: 81854.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44073.2539; val_chrom_access_recon_loss: 1844505.6250; val_global_loss: 22182435.5000; val_optim_loss: 22182435.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9309; val_auprc_score: 0.9071; val_best_acc_score: 0.8694; val_best_f1_score: 0.8756; train_kl_reg_loss: 90154.5208; train_edge_recon_loss: 2745465.6818; train_gene_expr_recon_loss: 17326483.6970; train_masked_gp_l1_reg_loss: 82506.3690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43077.3258; train_chrom_access_recon_loss: 1823036.2689; train_global_loss: 22110724.1515; train_optim_loss: 22110724.1515; val_kl_reg_loss: 90108.9814; val_edge_recon_loss: 2772668.2500; val_gene_expr_recon_loss: 17392782.5000; val_masked_gp_l1_reg_loss: 83156.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42275.2031; val_chrom_access_recon_loss: 1830391.8438; val_global_loss: 22211383.5000; val_optim_loss: 22211383.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9381; val_auprc_score: 0.9197; val_best_acc_score: 0.8753; val_best_f1_score: 0.8802; train_kl_reg_loss: 88639.5685; train_edge_recon_loss: 2734277.9545; train_gene_expr_recon_loss: 17274239.8485; train_masked_gp_l1_reg_loss: 83716.6071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41409.2818; train_chrom_access_recon_loss: 1816272.5549; train_global_loss: 22038555.7273; train_optim_loss: 22038555.7273; val_kl_reg_loss: 90660.9131; val_edge_recon_loss: 2776836.6875; val_gene_expr_recon_loss: 17156458.5000; val_masked_gp_l1_reg_loss: 84315.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40863.8711; val_chrom_access_recon_loss: 1800557.0156; val_global_loss: 21949693.0000; val_optim_loss: 21949693.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9368; val_auprc_score: 0.9169; val_best_acc_score: 0.8799; val_best_f1_score: 0.8850; train_kl_reg_loss: 87470.9469; train_edge_recon_loss: 2742893.1553; train_gene_expr_recon_loss: 17246799.1212; train_masked_gp_l1_reg_loss: 84910.4508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40059.3498; train_chrom_access_recon_loss: 1814513.8996; train_global_loss: 22016646.9091; train_optim_loss: 22016646.9091; val_kl_reg_loss: 84788.2539; val_edge_recon_loss: 2766322.8750; val_gene_expr_recon_loss: 17085297.7500; val_masked_gp_l1_reg_loss: 85486.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39454.3672; val_chrom_access_recon_loss: 1807796.6562; val_global_loss: 21869145.7500; val_optim_loss: 21869145.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9339; val_auprc_score: 0.9059; val_best_acc_score: 0.8788; val_best_f1_score: 0.8858; train_kl_reg_loss: 87258.7746; train_edge_recon_loss: 2727968.7841; train_gene_expr_recon_loss: 17190193.8333; train_masked_gp_l1_reg_loss: 85940.6772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38968.3932; train_chrom_access_recon_loss: 1808111.4583; train_global_loss: 21938442.0909; train_optim_loss: 21938442.0909; val_kl_reg_loss: 85640.7500; val_edge_recon_loss: 2768871.1562; val_gene_expr_recon_loss: 17053122.6250; val_masked_gp_l1_reg_loss: 86434.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38317.2734; val_chrom_access_recon_loss: 1793331.7500; val_global_loss: 21825718.2500; val_optim_loss: 21825718.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9401; val_auprc_score: 0.9216; val_best_acc_score: 0.8794; val_best_f1_score: 0.8841; train_kl_reg_loss: 86683.1289; train_edge_recon_loss: 2721768.5568; train_gene_expr_recon_loss: 17162651.5606; train_masked_gp_l1_reg_loss: 86915.2650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37846.9276; train_chrom_access_recon_loss: 1804056.7822; train_global_loss: 21899922.1818; train_optim_loss: 21899922.1818; val_kl_reg_loss: 87964.5527; val_edge_recon_loss: 2779830.8125; val_gene_expr_recon_loss: 16979460.7500; val_masked_gp_l1_reg_loss: 87495.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37314.2539; val_chrom_access_recon_loss: 1817653.2188; val_global_loss: 21789719.5000; val_optim_loss: 21789719.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9499; val_auprc_score: 0.9359; val_best_acc_score: 0.8936; val_best_f1_score: 0.8963; train_kl_reg_loss: 85255.9886; train_edge_recon_loss: 2715929.1932; train_gene_expr_recon_loss: 17139011.9848; train_masked_gp_l1_reg_loss: 87903.8588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36988.9764; train_chrom_access_recon_loss: 1802487.4015; train_global_loss: 21867577.4848; train_optim_loss: 21867577.4848; val_kl_reg_loss: 83127.0176; val_edge_recon_loss: 2731778.4062; val_gene_expr_recon_loss: 16965211.3750; val_masked_gp_l1_reg_loss: 88371.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36834.7578; val_chrom_access_recon_loss: 1772623.5781; val_global_loss: 21677946.2500; val_optim_loss: 21677946.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9479; val_auprc_score: 0.9272; val_best_acc_score: 0.8947; val_best_f1_score: 0.8981; train_kl_reg_loss: 83848.8241; train_edge_recon_loss: 2721788.0152; train_gene_expr_recon_loss: 17091129.3030; train_masked_gp_l1_reg_loss: 88913.1616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36349.2782; train_chrom_access_recon_loss: 1795498.8542; train_global_loss: 21817527.6970; train_optim_loss: 21817527.6970; val_kl_reg_loss: 83443.3857; val_edge_recon_loss: 2733067.1875; val_gene_expr_recon_loss: 17043814.8750; val_masked_gp_l1_reg_loss: 89420.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36178.6797; val_chrom_access_recon_loss: 1790588.7344; val_global_loss: 21776512.2500; val_optim_loss: 21776512.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9534; val_auprc_score: 0.9341; val_best_acc_score: 0.9038; val_best_f1_score: 0.9067; train_kl_reg_loss: 83730.0264; train_edge_recon_loss: 2708183.7159; train_gene_expr_recon_loss: 17057741.1061; train_masked_gp_l1_reg_loss: 89845.9235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35765.1123; train_chrom_access_recon_loss: 1792360.2027; train_global_loss: 21767626.1212; train_optim_loss: 21767626.1212; val_kl_reg_loss: 83860.2539; val_edge_recon_loss: 2691033.4375; val_gene_expr_recon_loss: 16915722.6250; val_masked_gp_l1_reg_loss: 90396.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35463.3555; val_chrom_access_recon_loss: 1784427.4688; val_global_loss: 21600903.5000; val_optim_loss: 21600903.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9483; val_auprc_score: 0.9333; val_best_acc_score: 0.8958; val_best_f1_score: 0.9008; train_kl_reg_loss: 99109.2968; train_edge_recon_loss: 2783237.9735; train_gene_expr_recon_loss: 16253033.7879; train_masked_gp_l1_reg_loss: 89855.9238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31958.5492; train_chrom_access_recon_loss: 1707032.8598; train_global_loss: 20964228.5758; train_optim_loss: 20964228.5758; val_kl_reg_loss: 45923.2793; val_edge_recon_loss: 2767230.9375; val_gene_expr_recon_loss: 16123662.6250; val_masked_gp_l1_reg_loss: 89080.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30882.7520; val_chrom_access_recon_loss: 1698355.2969; val_global_loss: 20755134.2500; val_optim_loss: 20755134.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9487; val_auprc_score: 0.9271; val_best_acc_score: 0.8931; val_best_f1_score: 0.8983; train_kl_reg_loss: 96607.7470; train_edge_recon_loss: 2745539.2879; train_gene_expr_recon_loss: 16114923.6667; train_masked_gp_l1_reg_loss: 88946.8487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30836.0287; train_chrom_access_recon_loss: 1685772.2405; train_global_loss: 20762625.8182; train_optim_loss: 20762625.8182; val_kl_reg_loss: 49759.3242; val_edge_recon_loss: 2773774.8125; val_gene_expr_recon_loss: 15978368.0000; val_masked_gp_l1_reg_loss: 88833.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30694.1230; val_chrom_access_recon_loss: 1671351.5469; val_global_loss: 20592781.2500; val_optim_loss: 20592781.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9425; val_auprc_score: 0.9217; val_best_acc_score: 0.8909; val_best_f1_score: 0.8951; train_kl_reg_loss: 91499.7969; train_edge_recon_loss: 2729758.8485; train_gene_expr_recon_loss: 16002392.4848; train_masked_gp_l1_reg_loss: 88719.0064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30619.0611; train_chrom_access_recon_loss: 1671116.6250; train_global_loss: 20614105.8182; train_optim_loss: 20614105.8182; val_kl_reg_loss: 51746.3379; val_edge_recon_loss: 2779716.6250; val_gene_expr_recon_loss: 15730865.3750; val_masked_gp_l1_reg_loss: 88609.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30565.2676; val_chrom_access_recon_loss: 1653978.4062; val_global_loss: 20335482.7500; val_optim_loss: 20335482.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9454; val_auprc_score: 0.9262; val_best_acc_score: 0.8901; val_best_f1_score: 0.8962; train_kl_reg_loss: 86739.9228; train_edge_recon_loss: 2724682.3220; train_gene_expr_recon_loss: 15899605.6364; train_masked_gp_l1_reg_loss: 88485.0353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30196.7764; train_chrom_access_recon_loss: 1656147.2822; train_global_loss: 20485857.0606; train_optim_loss: 20485857.0606; val_kl_reg_loss: 52270.6016; val_edge_recon_loss: 2758671.6875; val_gene_expr_recon_loss: 15938393.7500; val_masked_gp_l1_reg_loss: 88312.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29965.6133; val_chrom_access_recon_loss: 1675119.6094; val_global_loss: 20542733.5000; val_optim_loss: 20542733.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9516; val_auprc_score: 0.9343; val_best_acc_score: 0.8968; val_best_f1_score: 0.9002; train_kl_reg_loss: 82376.3485; train_edge_recon_loss: 2710640.6061; train_gene_expr_recon_loss: 15818077.9848; train_masked_gp_l1_reg_loss: 88228.1501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29906.2389; train_chrom_access_recon_loss: 1646688.9470; train_global_loss: 20375918.2424; train_optim_loss: 20375918.2424; val_kl_reg_loss: 54350.7012; val_edge_recon_loss: 2753188.7500; val_gene_expr_recon_loss: 15760223.7500; val_masked_gp_l1_reg_loss: 88144.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29843.2852; val_chrom_access_recon_loss: 1653233.5469; val_global_loss: 20338985.2500; val_optim_loss: 20338985.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9484; val_auprc_score: 0.9230; val_best_acc_score: 0.8955; val_best_f1_score: 0.9008; train_kl_reg_loss: 77054.6916; train_edge_recon_loss: 2711723.5379; train_gene_expr_recon_loss: 15764787.7121; train_masked_gp_l1_reg_loss: 88094.8419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29771.8468; train_chrom_access_recon_loss: 1643722.3598; train_global_loss: 20315155.1818; train_optim_loss: 20315155.1818; val_kl_reg_loss: 54517.6284; val_edge_recon_loss: 2747343.3750; val_gene_expr_recon_loss: 15650116.0000; val_masked_gp_l1_reg_loss: 88076.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29686.8105; val_chrom_access_recon_loss: 1653468.5469; val_global_loss: 20223207.7500; val_optim_loss: 20223207.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9194; val_best_acc_score: 0.8904; val_best_f1_score: 0.8954; train_kl_reg_loss: 77338.8207; train_edge_recon_loss: 2704673.0644; train_gene_expr_recon_loss: 15714925.8333; train_masked_gp_l1_reg_loss: 87963.2929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29376.9155; train_chrom_access_recon_loss: 1637373.0587; train_global_loss: 20251651.1515; train_optim_loss: 20251651.1515; val_kl_reg_loss: 55261.2881; val_edge_recon_loss: 2766928.1875; val_gene_expr_recon_loss: 15659535.1250; val_masked_gp_l1_reg_loss: 87898.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29087.8633; val_chrom_access_recon_loss: 1654924.7344; val_global_loss: 20253635.5000; val_optim_loss: 20253635.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9495; val_auprc_score: 0.9268; val_best_acc_score: 0.8982; val_best_f1_score: 0.9021; train_kl_reg_loss: 74613.9809; train_edge_recon_loss: 2703225.4432; train_gene_expr_recon_loss: 15646540.4394; train_masked_gp_l1_reg_loss: 87817.5977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29085.2538; train_chrom_access_recon_loss: 1629989.1439; train_global_loss: 20171271.8788; train_optim_loss: 20171271.8788; val_kl_reg_loss: 56466.1060; val_edge_recon_loss: 2727044.1562; val_gene_expr_recon_loss: 15433456.2500; val_masked_gp_l1_reg_loss: 87720.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29101.9629; val_chrom_access_recon_loss: 1620010.3906; val_global_loss: 19953799.0000; val_optim_loss: 19953799.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9473; val_auprc_score: 0.9254; val_best_acc_score: 0.8958; val_best_f1_score: 0.9005; train_kl_reg_loss: 73353.1336; train_edge_recon_loss: 2700131.7197; train_gene_expr_recon_loss: 15508442.1970; train_masked_gp_l1_reg_loss: 87621.4122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29061.6349; train_chrom_access_recon_loss: 1615697.0909; train_global_loss: 20014307.1818; train_optim_loss: 20014307.1818; val_kl_reg_loss: 56466.4023; val_edge_recon_loss: 2753288.9375; val_gene_expr_recon_loss: 15323210.7500; val_masked_gp_l1_reg_loss: 87562.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28946.1973; val_chrom_access_recon_loss: 1629134.3594; val_global_loss: 19878608.5000; val_optim_loss: 19878608.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9498; val_auprc_score: 0.9323; val_best_acc_score: 0.8936; val_best_f1_score: 0.8978; train_kl_reg_loss: 73440.7476; train_edge_recon_loss: 2694897.0189; train_gene_expr_recon_loss: 15435087.8182; train_masked_gp_l1_reg_loss: 87479.5734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28888.9934; train_chrom_access_recon_loss: 1606667.5890; train_global_loss: 19926461.8485; train_optim_loss: 19926461.8485; val_kl_reg_loss: 54345.0620; val_edge_recon_loss: 2766240.4062; val_gene_expr_recon_loss: 15316939.8750; val_masked_gp_l1_reg_loss: 87461.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28898.5527; val_chrom_access_recon_loss: 1609049.2188; val_global_loss: 19862934.7500; val_optim_loss: 19862934.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9515; val_auprc_score: 0.9296; val_best_acc_score: 0.9033; val_best_f1_score: 0.9082; train_kl_reg_loss: 72570.6083; train_edge_recon_loss: 2701184.8826; train_gene_expr_recon_loss: 15376506.2121; train_masked_gp_l1_reg_loss: 87436.4858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28827.8295; train_chrom_access_recon_loss: 1599970.2614; train_global_loss: 19866496.0909; train_optim_loss: 19866496.0909; val_kl_reg_loss: 52637.0791; val_edge_recon_loss: 2714458.5000; val_gene_expr_recon_loss: 15221246.7500; val_masked_gp_l1_reg_loss: 87392.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28677.9199; val_chrom_access_recon_loss: 1582072.0156; val_global_loss: 19686483.7500; val_optim_loss: 19686483.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9562; val_auprc_score: 0.9396; val_best_acc_score: 0.9070; val_best_f1_score: 0.9107; train_kl_reg_loss: 70885.8825; train_edge_recon_loss: 2699527.8485; train_gene_expr_recon_loss: 15310293.2727; train_masked_gp_l1_reg_loss: 87378.7012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28682.6116; train_chrom_access_recon_loss: 1592872.2102; train_global_loss: 19789640.3939; train_optim_loss: 19789640.3939; val_kl_reg_loss: 54116.9648; val_edge_recon_loss: 2710561.6562; val_gene_expr_recon_loss: 15345455.7500; val_masked_gp_l1_reg_loss: 87366.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28679.1504; val_chrom_access_recon_loss: 1605166.9375; val_global_loss: 19831347.5000; val_optim_loss: 19831347.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9546; val_auprc_score: 0.9348; val_best_acc_score: 0.9081; val_best_f1_score: 0.9112; train_kl_reg_loss: 70704.2362; train_edge_recon_loss: 2693687.6326; train_gene_expr_recon_loss: 15265028.3485; train_masked_gp_l1_reg_loss: 87303.5192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28638.3558; train_chrom_access_recon_loss: 1589964.4602; train_global_loss: 19735326.3636; train_optim_loss: 19735326.3636; val_kl_reg_loss: 52290.3940; val_edge_recon_loss: 2718714.8125; val_gene_expr_recon_loss: 15167142.1250; val_masked_gp_l1_reg_loss: 87209.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28533.6953; val_chrom_access_recon_loss: 1589309.6719; val_global_loss: 19643201.2500; val_optim_loss: 19643201.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9521; val_auprc_score: 0.9311; val_best_acc_score: 0.9038; val_best_f1_score: 0.9069; train_kl_reg_loss: 69858.3911; train_edge_recon_loss: 2695839.7689; train_gene_expr_recon_loss: 15211579.3636; train_masked_gp_l1_reg_loss: 87221.5334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28517.7743; train_chrom_access_recon_loss: 1581215.9735; train_global_loss: 19674233.0000; train_optim_loss: 19674233.0000; val_kl_reg_loss: 50722.6484; val_edge_recon_loss: 2742114.5625; val_gene_expr_recon_loss: 15135078.5000; val_masked_gp_l1_reg_loss: 87249.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28453.1406; val_chrom_access_recon_loss: 1566423.4688; val_global_loss: 19610042.7500; val_optim_loss: 19610042.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9544; val_auprc_score: 0.9375; val_best_acc_score: 0.9017; val_best_f1_score: 0.9059; train_kl_reg_loss: 69434.4381; train_edge_recon_loss: 2692047.4242; train_gene_expr_recon_loss: 15136629.7424; train_masked_gp_l1_reg_loss: 87180.4052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28465.4342; train_chrom_access_recon_loss: 1571002.7519; train_global_loss: 19584760.2121; train_optim_loss: 19584760.2121; val_kl_reg_loss: 52684.9102; val_edge_recon_loss: 2719070.2812; val_gene_expr_recon_loss: 15049774.5000; val_masked_gp_l1_reg_loss: 87182.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28346.5508; val_chrom_access_recon_loss: 1567823.1094; val_global_loss: 19504880.2500; val_optim_loss: 19504880.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9599; val_auprc_score: 0.9402; val_best_acc_score: 0.9119; val_best_f1_score: 0.9150; train_kl_reg_loss: 69056.7906; train_edge_recon_loss: 2690855.0227; train_gene_expr_recon_loss: 15032348.1515; train_masked_gp_l1_reg_loss: 87131.5343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28340.5477; train_chrom_access_recon_loss: 1561187.0227; train_global_loss: 19468919.2121; train_optim_loss: 19468919.2121; val_kl_reg_loss: 53952.9531; val_edge_recon_loss: 2712647.3750; val_gene_expr_recon_loss: 14963859.6250; val_masked_gp_l1_reg_loss: 87056.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28282.6719; val_chrom_access_recon_loss: 1557339.3906; val_global_loss: 19403137.5000; val_optim_loss: 19403137.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9573; val_auprc_score: 0.9395; val_best_acc_score: 0.9057; val_best_f1_score: 0.9097; train_kl_reg_loss: 68135.5906; train_edge_recon_loss: 2691628.9735; train_gene_expr_recon_loss: 14999118.4848; train_masked_gp_l1_reg_loss: 87026.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28218.2414; train_chrom_access_recon_loss: 1557969.0133; train_global_loss: 19432097.1515; train_optim_loss: 19432097.1515; val_kl_reg_loss: 49023.7261; val_edge_recon_loss: 2735693.0000; val_gene_expr_recon_loss: 14959117.1250; val_masked_gp_l1_reg_loss: 87039.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28180.8379; val_chrom_access_recon_loss: 1555169.4375; val_global_loss: 19414223.2500; val_optim_loss: 19414223.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9583; val_auprc_score: 0.9396; val_best_acc_score: 0.9119; val_best_f1_score: 0.9147; train_kl_reg_loss: 67491.7769; train_edge_recon_loss: 2691461.2008; train_gene_expr_recon_loss: 14976356.7727; train_masked_gp_l1_reg_loss: 87052.2778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28159.9023; train_chrom_access_recon_loss: 1556402.8580; train_global_loss: 19406924.9697; train_optim_loss: 19406924.9697; val_kl_reg_loss: 52358.9414; val_edge_recon_loss: 2716385.2500; val_gene_expr_recon_loss: 14814072.2500; val_masked_gp_l1_reg_loss: 87080.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28043.7344; val_chrom_access_recon_loss: 1541424.7656; val_global_loss: 19239365.5000; val_optim_loss: 19239365.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9532; val_auprc_score: 0.9385; val_best_acc_score: 0.9019; val_best_f1_score: 0.9054; train_kl_reg_loss: 67614.9056; train_edge_recon_loss: 2688980.0833; train_gene_expr_recon_loss: 14949467.7424; train_masked_gp_l1_reg_loss: 87066.9607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28033.0421; train_chrom_access_recon_loss: 1553945.9015; train_global_loss: 19375108.4242; train_optim_loss: 19375108.4242; val_kl_reg_loss: 49564.9048; val_edge_recon_loss: 2754743.2812; val_gene_expr_recon_loss: 14782907.5000; val_masked_gp_l1_reg_loss: 87086.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28013.5918; val_chrom_access_recon_loss: 1547075.1406; val_global_loss: 19249390.2500; val_optim_loss: 19249390.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9604; val_auprc_score: 0.9417; val_best_acc_score: 0.9124; val_best_f1_score: 0.9153; train_kl_reg_loss: 67835.4113; train_edge_recon_loss: 2683055.2008; train_gene_expr_recon_loss: 14881023.2121; train_masked_gp_l1_reg_loss: 87091.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28026.9859; train_chrom_access_recon_loss: 1550840.5890; train_global_loss: 19297872.4545; train_optim_loss: 19297872.4545; val_kl_reg_loss: 50496.1528; val_edge_recon_loss: 2682539.4375; val_gene_expr_recon_loss: 14861373.3750; val_masked_gp_l1_reg_loss: 87081.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27892.5957; val_chrom_access_recon_loss: 1566382.6875; val_global_loss: 19275765.7500; val_optim_loss: 19275765.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9595; val_auprc_score: 0.9453; val_best_acc_score: 0.9081; val_best_f1_score: 0.9101; train_kl_reg_loss: 65651.3792; train_edge_recon_loss: 2684251.2689; train_gene_expr_recon_loss: 14846570.9545; train_masked_gp_l1_reg_loss: 87124.3494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27954.6924; train_chrom_access_recon_loss: 1546289.1648; train_global_loss: 19257841.9394; train_optim_loss: 19257841.9394; val_kl_reg_loss: 46785.5938; val_edge_recon_loss: 2728727.7812; val_gene_expr_recon_loss: 14873442.6250; val_masked_gp_l1_reg_loss: 87080.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27982.6562; val_chrom_access_recon_loss: 1552553.2500; val_global_loss: 19316570.7500; val_optim_loss: 19316570.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9541; val_auprc_score: 0.9373; val_best_acc_score: 0.9060; val_best_f1_score: 0.9094; train_kl_reg_loss: 65313.5892; train_edge_recon_loss: 2675258.8106; train_gene_expr_recon_loss: 14807876.6667; train_masked_gp_l1_reg_loss: 87195.5687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27957.5786; train_chrom_access_recon_loss: 1542198.6326; train_global_loss: 19205800.6667; train_optim_loss: 19205800.6667; val_kl_reg_loss: 49499.7241; val_edge_recon_loss: 2743206.2812; val_gene_expr_recon_loss: 14834895.7500; val_masked_gp_l1_reg_loss: 87237.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27835.2852; val_chrom_access_recon_loss: 1556958.3906; val_global_loss: 19299634.2500; val_optim_loss: 19299634.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9587; val_auprc_score: 0.9393; val_best_acc_score: 0.9121; val_best_f1_score: 0.9150; train_kl_reg_loss: 65615.9370; train_edge_recon_loss: 2682721.6780; train_gene_expr_recon_loss: 14726775.6970; train_masked_gp_l1_reg_loss: 86965.8124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26336.6689; train_chrom_access_recon_loss: 1541481.4299; train_global_loss: 19129897.2424; train_optim_loss: 19129897.2424; val_kl_reg_loss: 49287.8442; val_edge_recon_loss: 2682417.5312; val_gene_expr_recon_loss: 14750711.8750; val_masked_gp_l1_reg_loss: 86870.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25866.4121; val_chrom_access_recon_loss: 1549601.2500; val_global_loss: 19144755.0000; val_optim_loss: 19144755.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9581; val_auprc_score: 0.9386; val_best_acc_score: 0.9100; val_best_f1_score: 0.9142; train_kl_reg_loss: 66460.4578; train_edge_recon_loss: 2678745.7614; train_gene_expr_recon_loss: 14702655.5303; train_masked_gp_l1_reg_loss: 86841.0225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25729.9339; train_chrom_access_recon_loss: 1538205.8561; train_global_loss: 19098638.4848; train_optim_loss: 19098638.4848; val_kl_reg_loss: 49817.1328; val_edge_recon_loss: 2700974.5000; val_gene_expr_recon_loss: 14668115.6250; val_masked_gp_l1_reg_loss: 86815.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25609.3926; val_chrom_access_recon_loss: 1546001.9531; val_global_loss: 19077335.2500; val_optim_loss: 19077335.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9546; val_auprc_score: 0.9361; val_best_acc_score: 0.9073; val_best_f1_score: 0.9109; train_kl_reg_loss: 66622.0198; train_edge_recon_loss: 2680614.7045; train_gene_expr_recon_loss: 14693064.2121; train_masked_gp_l1_reg_loss: 86805.7430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25544.5471; train_chrom_access_recon_loss: 1538442.1648; train_global_loss: 19091093.4242; train_optim_loss: 19091093.4242; val_kl_reg_loss: 50440.5132; val_edge_recon_loss: 2731216.3125; val_gene_expr_recon_loss: 14588423.6250; val_masked_gp_l1_reg_loss: 86793.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25465.6328; val_chrom_access_recon_loss: 1540385.0469; val_global_loss: 19022725.5000; val_optim_loss: 19022725.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9618; val_auprc_score: 0.9461; val_best_acc_score: 0.9138; val_best_f1_score: 0.9173; train_kl_reg_loss: 66788.5767; train_edge_recon_loss: 2676029.3485; train_gene_expr_recon_loss: 14706438.7879; train_masked_gp_l1_reg_loss: 86782.0633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25410.2564; train_chrom_access_recon_loss: 1540227.1591; train_global_loss: 19101675.8788; train_optim_loss: 19101675.8788; val_kl_reg_loss: 50187.8062; val_edge_recon_loss: 2682675.3438; val_gene_expr_recon_loss: 14582402.2500; val_masked_gp_l1_reg_loss: 86778.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25353.4980; val_chrom_access_recon_loss: 1535201.0469; val_global_loss: 18962597.7500; val_optim_loss: 18962597.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9670; val_auprc_score: 0.9528; val_best_acc_score: 0.9207; val_best_f1_score: 0.9234; train_kl_reg_loss: 66497.6049; train_edge_recon_loss: 2681534.8371; train_gene_expr_recon_loss: 14700239.1515; train_masked_gp_l1_reg_loss: 86769.9563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25320.4529; train_chrom_access_recon_loss: 1538719.7860; train_global_loss: 19099081.8788; train_optim_loss: 19099081.8788; val_kl_reg_loss: 50595.1528; val_edge_recon_loss: 2669307.5625; val_gene_expr_recon_loss: 14833253.5000; val_masked_gp_l1_reg_loss: 86763.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25273.9414; val_chrom_access_recon_loss: 1561901.3594; val_global_loss: 19227095.5000; val_optim_loss: 19227095.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9547; val_auprc_score: 0.9411; val_best_acc_score: 0.8990; val_best_f1_score: 0.9044; train_kl_reg_loss: 66487.8110; train_edge_recon_loss: 2677865.8864; train_gene_expr_recon_loss: 14688803.5606; train_masked_gp_l1_reg_loss: 86762.4498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25246.1252; train_chrom_access_recon_loss: 1538124.0436; train_global_loss: 19083289.8485; train_optim_loss: 19083289.8485; val_kl_reg_loss: 51001.3364; val_edge_recon_loss: 2724519.7188; val_gene_expr_recon_loss: 14655147.6250; val_masked_gp_l1_reg_loss: 86754.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25199.6758; val_chrom_access_recon_loss: 1521494.0312; val_global_loss: 19064117.2500; val_optim_loss: 19064117.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9586; val_auprc_score: 0.9448; val_best_acc_score: 0.9113; val_best_f1_score: 0.9152; train_kl_reg_loss: 66345.2965; train_edge_recon_loss: 2685293.9621; train_gene_expr_recon_loss: 14683539.7121; train_masked_gp_l1_reg_loss: 86752.8890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25172.9523; train_chrom_access_recon_loss: 1537678.2481; train_global_loss: 19084783.0606; train_optim_loss: 19084783.0606; val_kl_reg_loss: 50431.4487; val_edge_recon_loss: 2696738.1250; val_gene_expr_recon_loss: 14753328.2500; val_masked_gp_l1_reg_loss: 86746.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25125.8477; val_chrom_access_recon_loss: 1545776.3125; val_global_loss: 19158145.5000; val_optim_loss: 19158145.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9558; val_auprc_score: 0.9405; val_best_acc_score: 0.9011; val_best_f1_score: 0.9054; train_kl_reg_loss: 65934.3733; train_edge_recon_loss: 2680105.5720; train_gene_expr_recon_loss: 14693937.3636; train_masked_gp_l1_reg_loss: 86747.5269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25105.2242; train_chrom_access_recon_loss: 1538344.2424; train_global_loss: 19090174.2121; train_optim_loss: 19090174.2121; val_kl_reg_loss: 50590.5898; val_edge_recon_loss: 2720396.4688; val_gene_expr_recon_loss: 14703915.0000; val_masked_gp_l1_reg_loss: 86740.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25057.8496; val_chrom_access_recon_loss: 1537197.7812; val_global_loss: 19123897.2500; val_optim_loss: 19123897.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9576; val_auprc_score: 0.9436; val_best_acc_score: 0.9081; val_best_f1_score: 0.9124; train_kl_reg_loss: 65645.5672; train_edge_recon_loss: 2677555.2917; train_gene_expr_recon_loss: 14682437.0000; train_masked_gp_l1_reg_loss: 86709.5004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24904.5451; train_chrom_access_recon_loss: 1537192.1913; train_global_loss: 19074444.0909; train_optim_loss: 19074444.0909; val_kl_reg_loss: 50511.9556; val_edge_recon_loss: 2719413.6875; val_gene_expr_recon_loss: 14665355.1250; val_masked_gp_l1_reg_loss: 86698.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24864.8750; val_chrom_access_recon_loss: 1533091.2812; val_global_loss: 19079934.0000; val_optim_loss: 19079934.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9509; val_auprc_score: 0.9327; val_best_acc_score: 0.9030; val_best_f1_score: 0.9073; train_kl_reg_loss: 65835.4899; train_edge_recon_loss: 2672167.8864; train_gene_expr_recon_loss: 14697473.6364; train_masked_gp_l1_reg_loss: 86695.0920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24854.0705; train_chrom_access_recon_loss: 1538243.7689; train_global_loss: 19085270.1515; train_optim_loss: 19085270.1515; val_kl_reg_loss: 50843.2031; val_edge_recon_loss: 2720710.6562; val_gene_expr_recon_loss: 14692921.0000; val_masked_gp_l1_reg_loss: 86691.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24842.7285; val_chrom_access_recon_loss: 1550607.3125; val_global_loss: 19126616.5000; val_optim_loss: 19126616.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9598; val_auprc_score: 0.9424; val_best_acc_score: 0.9105; val_best_f1_score: 0.9138; train_kl_reg_loss: 65737.8075; train_edge_recon_loss: 2678104.6818; train_gene_expr_recon_loss: 14685034.3030; train_masked_gp_l1_reg_loss: 86689.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24834.5719; train_chrom_access_recon_loss: 1537751.8125; train_global_loss: 19078152.9394; train_optim_loss: 19078152.9394; val_kl_reg_loss: 50687.5356; val_edge_recon_loss: 2703027.0312; val_gene_expr_recon_loss: 14700165.2500; val_masked_gp_l1_reg_loss: 86686.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24825.4219; val_chrom_access_recon_loss: 1542857.8438; val_global_loss: 19108249.5000; val_optim_loss: 19108249.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9605; val_auprc_score: 0.9458; val_best_acc_score: 0.9116; val_best_f1_score: 0.9153; train_kl_reg_loss: 65700.8691; train_edge_recon_loss: 2676659.8068; train_gene_expr_recon_loss: 14699573.0758; train_masked_gp_l1_reg_loss: 86685.8603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24819.0574; train_chrom_access_recon_loss: 1538423.4053; train_global_loss: 19091861.5758; train_optim_loss: 19091861.5758; val_kl_reg_loss: 50392.4087; val_edge_recon_loss: 2693656.0625; val_gene_expr_recon_loss: 14662087.2500; val_masked_gp_l1_reg_loss: 86683.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24811.6523; val_chrom_access_recon_loss: 1541116.6250; val_global_loss: 19058748.2500; val_optim_loss: 19058748.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 37 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9548
val AUPRC score: 0.9380
val best accuracy score: 0.9052
val best F1 score: 0.9098
val target rna MSE score: 1.9720
val source rna MSE score: 0.7454
val target atac MSE score: 0.3140
val source atac MSE score: 0.0705
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
