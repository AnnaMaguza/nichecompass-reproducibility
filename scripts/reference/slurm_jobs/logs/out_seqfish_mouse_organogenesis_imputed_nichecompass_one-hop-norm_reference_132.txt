[True]
Run timestamp: 27072023_024744_132.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_132']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8874; val_auprc_score: 0.9769; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 421438.1004; train_edge_recon_loss: 10912030.2558; train_gene_expr_recon_loss: 29243329.5535; train_masked_gp_l1_reg_loss: 14774.0355; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40591571.8977; train_optim_loss: 40591571.8977; val_kl_reg_loss: 314866.6940; val_edge_recon_loss: 12297415.8333; val_gene_expr_recon_loss: 22506907.2500; val_masked_gp_l1_reg_loss: 15684.8340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35134873.5833; val_optim_loss: 35134873.5833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8625; val_auprc_score: 0.9728; val_best_acc_score: 0.8620; val_best_f1_score: 0.9250; train_kl_reg_loss: 236513.9526; train_edge_recon_loss: 10783479.1581; train_gene_expr_recon_loss: 20146007.8326; train_masked_gp_l1_reg_loss: 16834.1544; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31182835.1442; train_optim_loss: 31182835.1442; val_kl_reg_loss: 26276.5751; val_edge_recon_loss: 11975398.9583; val_gene_expr_recon_loss: 13512438.2083; val_masked_gp_l1_reg_loss: 19228.1328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25533341.5833; val_optim_loss: 25533341.5833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8278; val_auprc_score: 0.9663; val_best_acc_score: 0.8633; val_best_f1_score: 0.9258; train_kl_reg_loss: 113234.7645; train_edge_recon_loss: 10476626.7419; train_gene_expr_recon_loss: 11233329.2186; train_masked_gp_l1_reg_loss: 20455.8026; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21843646.4000; train_optim_loss: 21843646.4000; val_kl_reg_loss: 113757.4281; val_edge_recon_loss: 11679370.0417; val_gene_expr_recon_loss: 10319568.9167; val_masked_gp_l1_reg_loss: 20440.9766; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22133136.5000; val_optim_loss: 22133136.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8090; val_auprc_score: 0.9622; val_best_acc_score: 0.8649; val_best_f1_score: 0.9270; train_kl_reg_loss: 162764.3999; train_edge_recon_loss: 10373683.0070; train_gene_expr_recon_loss: 10061943.4605; train_masked_gp_l1_reg_loss: 20389.0843; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20618779.9535; train_optim_loss: 20618779.9535; val_kl_reg_loss: 153782.5859; val_edge_recon_loss: 11513079.5833; val_gene_expr_recon_loss: 9811442.7917; val_masked_gp_l1_reg_loss: 20457.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21498763.1667; val_optim_loss: 21498763.1667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8084; val_auprc_score: 0.9583; val_best_acc_score: 0.8708; val_best_f1_score: 0.9286; train_kl_reg_loss: 159063.1462; train_edge_recon_loss: 10488530.9721; train_gene_expr_recon_loss: 9748681.6791; train_masked_gp_l1_reg_loss: 20677.8698; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20416953.7023; train_optim_loss: 20416953.7023; val_kl_reg_loss: 132448.6504; val_edge_recon_loss: 11639969.0417; val_gene_expr_recon_loss: 9567103.7083; val_masked_gp_l1_reg_loss: 21117.3633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21360639.2500; val_optim_loss: 21360639.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8295; val_auprc_score: 0.9603; val_best_acc_score: 0.8796; val_best_f1_score: 0.9335; train_kl_reg_loss: 141635.4080; train_edge_recon_loss: 10230644.4349; train_gene_expr_recon_loss: 9439846.8047; train_masked_gp_l1_reg_loss: 21321.7636; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19833448.2698; train_optim_loss: 19833448.2698; val_kl_reg_loss: 117687.3252; val_edge_recon_loss: 11081803.5417; val_gene_expr_recon_loss: 9291721.4167; val_masked_gp_l1_reg_loss: 21638.9180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20512850.5000; val_optim_loss: 20512850.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8363; val_auprc_score: 0.9609; val_best_acc_score: 0.8881; val_best_f1_score: 0.9372; train_kl_reg_loss: 107263.1235; train_edge_recon_loss: 9694264.9930; train_gene_expr_recon_loss: 9232541.2977; train_masked_gp_l1_reg_loss: 22168.8441; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19056238.2186; train_optim_loss: 19056238.2186; val_kl_reg_loss: 121248.7448; val_edge_recon_loss: 9397287.5208; val_gene_expr_recon_loss: 9114990.6667; val_masked_gp_l1_reg_loss: 22758.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18656285.0417; val_optim_loss: 18656285.0417
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8395; val_auprc_score: 0.9625; val_best_acc_score: 0.8892; val_best_f1_score: 0.9384; train_kl_reg_loss: 157011.0730; train_edge_recon_loss: 9103727.6651; train_gene_expr_recon_loss: 9030797.5163; train_masked_gp_l1_reg_loss: 23349.3336; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18314885.5907; train_optim_loss: 18314885.5907; val_kl_reg_loss: 183473.1074; val_edge_recon_loss: 8892010.5208; val_gene_expr_recon_loss: 8918377.5833; val_masked_gp_l1_reg_loss: 23921.3672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18017783.1250; val_optim_loss: 18017783.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8381; val_auprc_score: 0.9625; val_best_acc_score: 0.8932; val_best_f1_score: 0.9402; train_kl_reg_loss: 199130.0565; train_edge_recon_loss: 8954080.7651; train_gene_expr_recon_loss: 8837410.4698; train_masked_gp_l1_reg_loss: 24392.0931; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18015013.3628; train_optim_loss: 18015013.3628; val_kl_reg_loss: 202817.8542; val_edge_recon_loss: 8868043.4583; val_gene_expr_recon_loss: 8741342.2917; val_masked_gp_l1_reg_loss: 24874.4102; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17837077.6250; val_optim_loss: 17837077.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8388; val_auprc_score: 0.9619; val_best_acc_score: 0.8916; val_best_f1_score: 0.9391; train_kl_reg_loss: 200089.2656; train_edge_recon_loss: 8856094.0279; train_gene_expr_recon_loss: 8671013.4930; train_masked_gp_l1_reg_loss: 25347.1418; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17752544.0372; train_optim_loss: 17752544.0372; val_kl_reg_loss: 187956.0853; val_edge_recon_loss: 9118340.6250; val_gene_expr_recon_loss: 8575459.6667; val_masked_gp_l1_reg_loss: 25828.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17907584.4167; val_optim_loss: 17907584.4167
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8488; val_auprc_score: 0.9639; val_best_acc_score: 0.9002; val_best_f1_score: 0.9438; train_kl_reg_loss: 184117.9907; train_edge_recon_loss: 8653058.0186; train_gene_expr_recon_loss: 8515765.9767; train_masked_gp_l1_reg_loss: 26279.8218; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17379221.7767; train_optim_loss: 17379221.7767; val_kl_reg_loss: 172692.4648; val_edge_recon_loss: 8963079.9583; val_gene_expr_recon_loss: 8430034.4583; val_masked_gp_l1_reg_loss: 26760.0781; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17592566.8750; val_optim_loss: 17592566.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8498; val_auprc_score: 0.9640; val_best_acc_score: 0.9022; val_best_f1_score: 0.9451; train_kl_reg_loss: 172317.9677; train_edge_recon_loss: 8703016.0721; train_gene_expr_recon_loss: 8385644.7651; train_masked_gp_l1_reg_loss: 27236.0692; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17288214.8093; train_optim_loss: 17288214.8093; val_kl_reg_loss: 159551.9349; val_edge_recon_loss: 8921631.2083; val_gene_expr_recon_loss: 8306043.3333; val_masked_gp_l1_reg_loss: 27697.7520; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17414924.4167; val_optim_loss: 17414924.4167
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8623; val_auprc_score: 0.9692; val_best_acc_score: 0.9103; val_best_f1_score: 0.9497; train_kl_reg_loss: 159748.4837; train_edge_recon_loss: 8594110.3535; train_gene_expr_recon_loss: 8265854.5093; train_masked_gp_l1_reg_loss: 28148.2528; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17047861.5535; train_optim_loss: 17047861.5535; val_kl_reg_loss: 148732.7285; val_edge_recon_loss: 8496441.7083; val_gene_expr_recon_loss: 8179239.5208; val_masked_gp_l1_reg_loss: 28602.5762; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16853016.4167; val_optim_loss: 16853016.4167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8670; val_auprc_score: 0.9699; val_best_acc_score: 0.9064; val_best_f1_score: 0.9474; train_kl_reg_loss: 147118.7405; train_edge_recon_loss: 8566526.9930; train_gene_expr_recon_loss: 8131924.0953; train_masked_gp_l1_reg_loss: 29013.1907; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16874583.0326; train_optim_loss: 16874583.0326; val_kl_reg_loss: 136027.2507; val_edge_recon_loss: 8681471.2917; val_gene_expr_recon_loss: 8064970.5000; val_masked_gp_l1_reg_loss: 29400.3105; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16911869.0833; val_optim_loss: 16911869.0833
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8767; val_auprc_score: 0.9700; val_best_acc_score: 0.9103; val_best_f1_score: 0.9494; train_kl_reg_loss: 132842.7892; train_edge_recon_loss: 8396408.1558; train_gene_expr_recon_loss: 8018216.3349; train_masked_gp_l1_reg_loss: 29789.0156; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16577256.3070; train_optim_loss: 16577256.3070; val_kl_reg_loss: 120493.4694; val_edge_recon_loss: 8488637.6250; val_gene_expr_recon_loss: 7955854.1667; val_masked_gp_l1_reg_loss: 30175.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16595160.9583; val_optim_loss: 16595160.9583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8917; val_auprc_score: 0.9749; val_best_acc_score: 0.9075; val_best_f1_score: 0.9474; train_kl_reg_loss: 121307.9201; train_edge_recon_loss: 8288361.9209; train_gene_expr_recon_loss: 7922342.4535; train_masked_gp_l1_reg_loss: 30567.8515; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16362580.1721; train_optim_loss: 16362580.1721; val_kl_reg_loss: 115671.9004; val_edge_recon_loss: 8351003.9792; val_gene_expr_recon_loss: 7861503.5208; val_masked_gp_l1_reg_loss: 30964.8633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16359144.0417; val_optim_loss: 16359144.0417
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8993; val_auprc_score: 0.9768; val_best_acc_score: 0.9083; val_best_f1_score: 0.9475; train_kl_reg_loss: 113571.8403; train_edge_recon_loss: 8234388.2209; train_gene_expr_recon_loss: 7831693.7837; train_masked_gp_l1_reg_loss: 31363.3560; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16211017.1953; train_optim_loss: 16211017.1953; val_kl_reg_loss: 110879.3477; val_edge_recon_loss: 8340016.0417; val_gene_expr_recon_loss: 7778382.6667; val_masked_gp_l1_reg_loss: 31757.7109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16261036.0833; val_optim_loss: 16261036.0833
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9021; val_auprc_score: 0.9777; val_best_acc_score: 0.9130; val_best_f1_score: 0.9501; train_kl_reg_loss: 111471.3750; train_edge_recon_loss: 8113468.4047; train_gene_expr_recon_loss: 7749484.7233; train_masked_gp_l1_reg_loss: 32072.0390; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16006496.6372; train_optim_loss: 16006496.6372; val_kl_reg_loss: 100759.9596; val_edge_recon_loss: 8443867.6458; val_gene_expr_recon_loss: 7690895.5625; val_masked_gp_l1_reg_loss: 32380.1680; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16267903.1250; val_optim_loss: 16267903.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9087; val_auprc_score: 0.9788; val_best_acc_score: 0.9185; val_best_f1_score: 0.9532; train_kl_reg_loss: 99946.4674; train_edge_recon_loss: 8087363.9744; train_gene_expr_recon_loss: 7671231.6814; train_masked_gp_l1_reg_loss: 32695.6069; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15891237.6698; train_optim_loss: 15891237.6698; val_kl_reg_loss: 92786.5540; val_edge_recon_loss: 8175255.1042; val_gene_expr_recon_loss: 7623798.6875; val_masked_gp_l1_reg_loss: 32986.5938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15924827.2917; val_optim_loss: 15924827.2917
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9159; val_auprc_score: 0.9807; val_best_acc_score: 0.9210; val_best_f1_score: 0.9544; train_kl_reg_loss: 91419.2361; train_edge_recon_loss: 8027192.8721; train_gene_expr_recon_loss: 7604789.0884; train_masked_gp_l1_reg_loss: 33237.8227; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15756638.9860; train_optim_loss: 15756638.9860; val_kl_reg_loss: 87536.5212; val_edge_recon_loss: 8343452.4792; val_gene_expr_recon_loss: 7553410.5000; val_masked_gp_l1_reg_loss: 33471.8984; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16017871.6250; val_optim_loss: 16017871.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9223; val_auprc_score: 0.9839; val_best_acc_score: 0.9242; val_best_f1_score: 0.9564; train_kl_reg_loss: 82459.3908; train_edge_recon_loss: 7980457.6953; train_gene_expr_recon_loss: 7542204.9884; train_masked_gp_l1_reg_loss: 33662.2378; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15638784.3116; train_optim_loss: 15638784.3116; val_kl_reg_loss: 77230.1149; val_edge_recon_loss: 8049584.8333; val_gene_expr_recon_loss: 7493274.7708; val_masked_gp_l1_reg_loss: 33838.6641; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15653928.7500; val_optim_loss: 15653928.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9298; val_auprc_score: 0.9845; val_best_acc_score: 0.9217; val_best_f1_score: 0.9550; train_kl_reg_loss: 74607.2075; train_edge_recon_loss: 7888518.4093; train_gene_expr_recon_loss: 7480842.9674; train_masked_gp_l1_reg_loss: 33932.5186; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15477901.1256; train_optim_loss: 15477901.1256; val_kl_reg_loss: 66646.8716; val_edge_recon_loss: 8113921.4167; val_gene_expr_recon_loss: 7444374.0000; val_masked_gp_l1_reg_loss: 33989.0469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15658931.3333; val_optim_loss: 15658931.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9236; val_auprc_score: 0.9822; val_best_acc_score: 0.9230; val_best_f1_score: 0.9557; train_kl_reg_loss: 68481.5397; train_edge_recon_loss: 7922926.8209; train_gene_expr_recon_loss: 7428613.2419; train_masked_gp_l1_reg_loss: 33997.5526; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15454019.1814; train_optim_loss: 15454019.1814; val_kl_reg_loss: 62129.3158; val_edge_recon_loss: 8097270.5833; val_gene_expr_recon_loss: 7384875.9375; val_masked_gp_l1_reg_loss: 33997.6562; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15578273.7917; val_optim_loss: 15578273.7917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9248; val_auprc_score: 0.9840; val_best_acc_score: 0.9251; val_best_f1_score: 0.9573; train_kl_reg_loss: 59769.7679; train_edge_recon_loss: 7908977.4767; train_gene_expr_recon_loss: 7385876.3512; train_masked_gp_l1_reg_loss: 33952.7237; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15388576.2651; train_optim_loss: 15388576.2651; val_kl_reg_loss: 56920.3996; val_edge_recon_loss: 7867444.5625; val_gene_expr_recon_loss: 7349876.4167; val_masked_gp_l1_reg_loss: 33824.9453; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15308066.3333; val_optim_loss: 15308066.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9297; val_auprc_score: 0.9839; val_best_acc_score: 0.9280; val_best_f1_score: 0.9584; train_kl_reg_loss: 55853.7668; train_edge_recon_loss: 7873571.2233; train_gene_expr_recon_loss: 7342164.9279; train_masked_gp_l1_reg_loss: 33630.1783; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15305220.0605; train_optim_loss: 15305220.0605; val_kl_reg_loss: 51492.8726; val_edge_recon_loss: 8070662.4375; val_gene_expr_recon_loss: 7315664.3125; val_masked_gp_l1_reg_loss: 33436.9570; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15471256.5833; val_optim_loss: 15471256.5833
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9413; val_auprc_score: 0.9874; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 50553.4744; train_edge_recon_loss: 7831032.4000; train_gene_expr_recon_loss: 7301437.4279; train_masked_gp_l1_reg_loss: 33165.1350; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15216188.4837; train_optim_loss: 15216188.4837; val_kl_reg_loss: 45424.4862; val_edge_recon_loss: 7779099.9167; val_gene_expr_recon_loss: 7265414.5833; val_masked_gp_l1_reg_loss: 32875.0156; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15122814.2083; val_optim_loss: 15122814.2083
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9422; val_auprc_score: 0.9868; val_best_acc_score: 0.9338; val_best_f1_score: 0.9614; train_kl_reg_loss: 46517.1803; train_edge_recon_loss: 7784565.1279; train_gene_expr_recon_loss: 7269620.8163; train_masked_gp_l1_reg_loss: 32550.5515; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15133253.6419; train_optim_loss: 15133253.6419; val_kl_reg_loss: 45548.7323; val_edge_recon_loss: 7950878.5833; val_gene_expr_recon_loss: 7229924.3333; val_masked_gp_l1_reg_loss: 32156.5664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15258508.5417; val_optim_loss: 15258508.5417
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9413; val_auprc_score: 0.9862; val_best_acc_score: 0.9368; val_best_f1_score: 0.9634; train_kl_reg_loss: 45687.3144; train_edge_recon_loss: 7723875.5279; train_gene_expr_recon_loss: 7236527.3977; train_masked_gp_l1_reg_loss: 31742.0640; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15037832.3488; train_optim_loss: 15037832.3488; val_kl_reg_loss: 44922.3765; val_edge_recon_loss: 7988624.3958; val_gene_expr_recon_loss: 7208624.1250; val_masked_gp_l1_reg_loss: 31331.2598; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15273501.7083; val_optim_loss: 15273501.7083
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9472; val_auprc_score: 0.9879; val_best_acc_score: 0.9390; val_best_f1_score: 0.9645; train_kl_reg_loss: 45184.0594; train_edge_recon_loss: 7753210.8140; train_gene_expr_recon_loss: 7201739.1977; train_masked_gp_l1_reg_loss: 30885.9179; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15031019.9674; train_optim_loss: 15031019.9674; val_kl_reg_loss: 41502.2114; val_edge_recon_loss: 7967165.2917; val_gene_expr_recon_loss: 7178491.6250; val_masked_gp_l1_reg_loss: 30479.4121; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15217638.2500; val_optim_loss: 15217638.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9484; val_auprc_score: 0.9875; val_best_acc_score: 0.9373; val_best_f1_score: 0.9635; train_kl_reg_loss: 42420.9272; train_edge_recon_loss: 7811930.0977; train_gene_expr_recon_loss: 7178616.7767; train_masked_gp_l1_reg_loss: 30061.8515; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15063029.5953; train_optim_loss: 15063029.5953; val_kl_reg_loss: 40506.6506; val_edge_recon_loss: 7998376.3125; val_gene_expr_recon_loss: 7164231.8750; val_masked_gp_l1_reg_loss: 29606.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15232721.8333; val_optim_loss: 15232721.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9452; val_auprc_score: 0.9868; val_best_acc_score: 0.9377; val_best_f1_score: 0.9638; train_kl_reg_loss: 41559.7144; train_edge_recon_loss: 7794799.6651; train_gene_expr_recon_loss: 7143229.3907; train_masked_gp_l1_reg_loss: 29489.2286; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15009078.0558; train_optim_loss: 15009078.0558; val_kl_reg_loss: 41088.2567; val_edge_recon_loss: 8173571.6042; val_gene_expr_recon_loss: 7127900.7083; val_masked_gp_l1_reg_loss: 29418.8477; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15371979.6250; val_optim_loss: 15371979.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9482; val_auprc_score: 0.9879; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 41786.0218; train_edge_recon_loss: 7732717.2930; train_gene_expr_recon_loss: 7141918.2442; train_masked_gp_l1_reg_loss: 29367.3561; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14945788.9209; train_optim_loss: 14945788.9209; val_kl_reg_loss: 39959.4883; val_edge_recon_loss: 7947967.9167; val_gene_expr_recon_loss: 7123705.3333; val_masked_gp_l1_reg_loss: 29317.5215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15140950.5417; val_optim_loss: 15140950.5417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9435; val_auprc_score: 0.9869; val_best_acc_score: 0.9388; val_best_f1_score: 0.9648; train_kl_reg_loss: 41319.8783; train_edge_recon_loss: 7669600.1837; train_gene_expr_recon_loss: 7136610.4116; train_masked_gp_l1_reg_loss: 29270.6056; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14876801.0744; train_optim_loss: 14876801.0744; val_kl_reg_loss: 40487.3006; val_edge_recon_loss: 7801879.0625; val_gene_expr_recon_loss: 7124787.5833; val_masked_gp_l1_reg_loss: 29221.2266; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14996374.9583; val_optim_loss: 14996374.9583
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9546; val_auprc_score: 0.9902; val_best_acc_score: 0.9410; val_best_f1_score: 0.9659; train_kl_reg_loss: 41079.5956; train_edge_recon_loss: 7739988.5465; train_gene_expr_recon_loss: 7135934.6279; train_masked_gp_l1_reg_loss: 29169.1398; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14946171.9302; train_optim_loss: 14946171.9302; val_kl_reg_loss: 39998.9648; val_edge_recon_loss: 7801451.7500; val_gene_expr_recon_loss: 7118863.7500; val_masked_gp_l1_reg_loss: 29120.0820; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14989434.5833; val_optim_loss: 14989434.5833
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9465; val_auprc_score: 0.9883; val_best_acc_score: 0.9393; val_best_f1_score: 0.9651; train_kl_reg_loss: 40820.5960; train_edge_recon_loss: 7663842.7302; train_gene_expr_recon_loss: 7128477.7744; train_masked_gp_l1_reg_loss: 29063.2818; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14862204.3814; train_optim_loss: 14862204.3814; val_kl_reg_loss: 39583.7598; val_edge_recon_loss: 7708087.6250; val_gene_expr_recon_loss: 7123897.2083; val_masked_gp_l1_reg_loss: 29005.5371; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14900574.5417; val_optim_loss: 14900574.5417
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9471; val_auprc_score: 0.9873; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 40126.2920; train_edge_recon_loss: 7702545.6116; train_gene_expr_recon_loss: 7128115.5442; train_masked_gp_l1_reg_loss: 28949.6784; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14899737.1023; train_optim_loss: 14899737.1023; val_kl_reg_loss: 38984.3472; val_edge_recon_loss: 7933565.2083; val_gene_expr_recon_loss: 7119527.0208; val_masked_gp_l1_reg_loss: 28900.0039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15120976.5417; val_optim_loss: 15120976.5417
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9440; val_auprc_score: 0.9875; val_best_acc_score: 0.9380; val_best_f1_score: 0.9642; train_kl_reg_loss: 39400.0584; train_edge_recon_loss: 7772422.6860; train_gene_expr_recon_loss: 7122692.5628; train_masked_gp_l1_reg_loss: 28836.3659; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14963351.5907; train_optim_loss: 14963351.5907; val_kl_reg_loss: 38118.1330; val_edge_recon_loss: 7981395.2292; val_gene_expr_recon_loss: 7105574.6458; val_masked_gp_l1_reg_loss: 28771.6172; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15153860.0833; val_optim_loss: 15153860.0833
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9533; val_auprc_score: 0.9899; val_best_acc_score: 0.9411; val_best_f1_score: 0.9661; train_kl_reg_loss: 39160.9320; train_edge_recon_loss: 7671706.2465; train_gene_expr_recon_loss: 7120176.3233; train_masked_gp_l1_reg_loss: 28708.4665; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14859751.9767; train_optim_loss: 14859751.9767; val_kl_reg_loss: 38436.8551; val_edge_recon_loss: 7748682.8542; val_gene_expr_recon_loss: 7104861.2083; val_masked_gp_l1_reg_loss: 28646.7383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14920628.0417; val_optim_loss: 14920628.0417
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9517; val_auprc_score: 0.9887; val_best_acc_score: 0.9392; val_best_f1_score: 0.9645; train_kl_reg_loss: 39394.5318; train_edge_recon_loss: 7704398.6907; train_gene_expr_recon_loss: 7115577.1116; train_masked_gp_l1_reg_loss: 28566.5302; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14887936.8465; train_optim_loss: 14887936.8465; val_kl_reg_loss: 37949.8180; val_edge_recon_loss: 8056883.7500; val_gene_expr_recon_loss: 7096109.6042; val_masked_gp_l1_reg_loss: 28487.9277; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15219431.1667; val_optim_loss: 15219431.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9433; val_auprc_score: 0.9862; val_best_acc_score: 0.9356; val_best_f1_score: 0.9628; train_kl_reg_loss: 38825.8684; train_edge_recon_loss: 7690024.2093; train_gene_expr_recon_loss: 7111705.0279; train_masked_gp_l1_reg_loss: 28468.3102; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14869023.4279; train_optim_loss: 14869023.4279; val_kl_reg_loss: 37812.3813; val_edge_recon_loss: 8137464.5208; val_gene_expr_recon_loss: 7099351.3958; val_masked_gp_l1_reg_loss: 28454.9922; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15303083.1667; val_optim_loss: 15303083.1667
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9532; val_auprc_score: 0.9889; val_best_acc_score: 0.9416; val_best_f1_score: 0.9662; train_kl_reg_loss: 38709.0015; train_edge_recon_loss: 7651667.8023; train_gene_expr_recon_loss: 7110585.9233; train_masked_gp_l1_reg_loss: 28445.3010; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14829408.0558; train_optim_loss: 14829408.0558; val_kl_reg_loss: 37755.2280; val_edge_recon_loss: 7804213.6875; val_gene_expr_recon_loss: 7110318.3750; val_masked_gp_l1_reg_loss: 28435.7070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14980723.3333; val_optim_loss: 14980723.3333
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9527; val_auprc_score: 0.9890; val_best_acc_score: 0.9411; val_best_f1_score: 0.9657; train_kl_reg_loss: 38968.9669; train_edge_recon_loss: 7722342.2814; train_gene_expr_recon_loss: 7112453.9581; train_masked_gp_l1_reg_loss: 28425.7158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14902190.9302; train_optim_loss: 14902190.9302; val_kl_reg_loss: 37892.5160; val_edge_recon_loss: 8000675.1875; val_gene_expr_recon_loss: 7097117.9167; val_masked_gp_l1_reg_loss: 28415.3887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15164100.7083; val_optim_loss: 15164100.7083
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9464; val_auprc_score: 0.9872; val_best_acc_score: 0.9372; val_best_f1_score: 0.9639; train_kl_reg_loss: 38938.5330; train_edge_recon_loss: 7715539.5674; train_gene_expr_recon_loss: 7113653.8093; train_masked_gp_l1_reg_loss: 28404.9071; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14896536.7953; train_optim_loss: 14896536.7953; val_kl_reg_loss: 37908.4388; val_edge_recon_loss: 7964137.8958; val_gene_expr_recon_loss: 7105911.6667; val_masked_gp_l1_reg_loss: 28394.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15136352.0000; val_optim_loss: 15136352.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 53 min 6 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9473
Val AUPRC score: 0.9868
Val best accuracy score: 0.9411
Val best F1 score: 0.9660
Val gene expr MSE score: 22759.0526
Val cat covariate0 mean sim diff: -0.0016

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
