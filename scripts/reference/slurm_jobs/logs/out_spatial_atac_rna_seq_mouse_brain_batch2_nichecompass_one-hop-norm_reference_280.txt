[True]
Run timestamp: 07092023_061140_280.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_280']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 946 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4542, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6544; val_auprc_score: 0.6360; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 62999.2220; train_edge_recon_loss: 3550777.8636; train_gene_expr_recon_loss: 14754384.9545; train_masked_gp_l1_reg_loss: 40176.0874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7620631.3068; train_chrom_access_recon_loss: 5248535.1439; train_global_loss: 31277504.6667; train_optim_loss: 31277504.6667; val_kl_reg_loss: 71318.0381; val_edge_recon_loss: 4065528.7812; val_gene_expr_recon_loss: 13639457.0000; val_masked_gp_l1_reg_loss: 38105.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2707774.0000; val_chrom_access_recon_loss: 5068655.7500; val_global_loss: 25590839.2500; val_optim_loss: 25590839.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6844; val_auprc_score: 0.6715; val_best_acc_score: 0.5696; val_best_f1_score: 0.6898; train_kl_reg_loss: 116863.7188; train_edge_recon_loss: 3534756.4470; train_gene_expr_recon_loss: 13195990.1364; train_masked_gp_l1_reg_loss: 35101.2261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 984696.2169; train_chrom_access_recon_loss: 4982886.5076; train_global_loss: 22850294.3636; train_optim_loss: 22850294.3636; val_kl_reg_loss: 126216.6729; val_edge_recon_loss: 4061410.8438; val_gene_expr_recon_loss: 13053118.2500; val_masked_gp_l1_reg_loss: 33351.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 321938.4062; val_chrom_access_recon_loss: 4947482.3125; val_global_loss: 22543517.7500; val_optim_loss: 22543517.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7066; val_auprc_score: 0.6904; val_best_acc_score: 0.6351; val_best_f1_score: 0.6914; train_kl_reg_loss: 110818.1853; train_edge_recon_loss: 3527062.9773; train_gene_expr_recon_loss: 12983716.6212; train_masked_gp_l1_reg_loss: 33362.4567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237535.0144; train_chrom_access_recon_loss: 4941450.8939; train_global_loss: 21833946.2424; train_optim_loss: 21833946.2424; val_kl_reg_loss: 114667.3604; val_edge_recon_loss: 4051401.8438; val_gene_expr_recon_loss: 12912233.6250; val_masked_gp_l1_reg_loss: 33736.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189535.2812; val_chrom_access_recon_loss: 4942494.1875; val_global_loss: 22244069.0000; val_optim_loss: 22244069.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7498; val_auprc_score: 0.7225; val_best_acc_score: 0.6577; val_best_f1_score: 0.7259; train_kl_reg_loss: 99431.7150; train_edge_recon_loss: 3514517.4015; train_gene_expr_recon_loss: 12875923.9394; train_masked_gp_l1_reg_loss: 34620.5339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168818.3542; train_chrom_access_recon_loss: 4914914.8636; train_global_loss: 21608226.8788; train_optim_loss: 21608226.8788; val_kl_reg_loss: 88094.4688; val_edge_recon_loss: 3981417.1875; val_gene_expr_recon_loss: 12888871.2500; val_masked_gp_l1_reg_loss: 35839.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153727.1875; val_chrom_access_recon_loss: 4890006.5000; val_global_loss: 22037957.0000; val_optim_loss: 22037957.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8176; val_auprc_score: 0.7911; val_best_acc_score: 0.7434; val_best_f1_score: 0.7698; train_kl_reg_loss: 82524.6483; train_edge_recon_loss: 3460611.0038; train_gene_expr_recon_loss: 12793351.6061; train_masked_gp_l1_reg_loss: 37027.9934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143681.5689; train_chrom_access_recon_loss: 4884812.6667; train_global_loss: 21402009.3636; train_optim_loss: 21402009.3636; val_kl_reg_loss: 71562.1270; val_edge_recon_loss: 3568294.2188; val_gene_expr_recon_loss: 12847390.6250; val_masked_gp_l1_reg_loss: 38086.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135887.9062; val_chrom_access_recon_loss: 4898759.1250; val_global_loss: 21559980.0000; val_optim_loss: 21559980.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8393; val_auprc_score: 0.8155; val_best_acc_score: 0.7622; val_best_f1_score: 0.7876; train_kl_reg_loss: 77922.3129; train_edge_recon_loss: 3183938.2727; train_gene_expr_recon_loss: 12728106.1667; train_masked_gp_l1_reg_loss: 39771.3549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131612.0088; train_chrom_access_recon_loss: 4864893.2955; train_global_loss: 21026243.2727; train_optim_loss: 21026243.2727; val_kl_reg_loss: 87304.1201; val_edge_recon_loss: 3127673.6875; val_gene_expr_recon_loss: 12700760.7500; val_masked_gp_l1_reg_loss: 41255.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127707.8438; val_chrom_access_recon_loss: 4805877.7500; val_global_loss: 20890580.2500; val_optim_loss: 20890580.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8697; val_auprc_score: 0.8428; val_best_acc_score: 0.8015; val_best_f1_score: 0.8136; train_kl_reg_loss: 96344.1580; train_edge_recon_loss: 2994073.9091; train_gene_expr_recon_loss: 12686553.6970; train_masked_gp_l1_reg_loss: 42943.4734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123839.4624; train_chrom_access_recon_loss: 4843281.0000; train_global_loss: 20787035.8788; train_optim_loss: 20787035.8788; val_kl_reg_loss: 103275.8496; val_edge_recon_loss: 2952778.2188; val_gene_expr_recon_loss: 12679762.7500; val_masked_gp_l1_reg_loss: 44180.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121324.1719; val_chrom_access_recon_loss: 4824135.8750; val_global_loss: 20725457.7500; val_optim_loss: 20725457.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8797; val_auprc_score: 0.8538; val_best_acc_score: 0.8090; val_best_f1_score: 0.8207; train_kl_reg_loss: 110725.1871; train_edge_recon_loss: 2878567.9432; train_gene_expr_recon_loss: 12603825.9394; train_masked_gp_l1_reg_loss: 44885.6834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117880.8075; train_chrom_access_recon_loss: 4816296.9621; train_global_loss: 20572182.4848; train_optim_loss: 20572182.4848; val_kl_reg_loss: 109005.2744; val_edge_recon_loss: 2917404.2188; val_gene_expr_recon_loss: 12555093.7500; val_masked_gp_l1_reg_loss: 45816.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114980.6641; val_chrom_access_recon_loss: 4773310.8750; val_global_loss: 20515611.7500; val_optim_loss: 20515611.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8769; val_auprc_score: 0.8463; val_best_acc_score: 0.8055; val_best_f1_score: 0.8222; train_kl_reg_loss: 113563.8379; train_edge_recon_loss: 2840600.1780; train_gene_expr_recon_loss: 12550776.2576; train_masked_gp_l1_reg_loss: 46625.4265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112861.0111; train_chrom_access_recon_loss: 4800418.1061; train_global_loss: 20464844.8788; train_optim_loss: 20464844.8788; val_kl_reg_loss: 115162.9600; val_edge_recon_loss: 2915540.2500; val_gene_expr_recon_loss: 12504978.1250; val_masked_gp_l1_reg_loss: 47446.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110894.6641; val_chrom_access_recon_loss: 4774978.6875; val_global_loss: 20469002.2500; val_optim_loss: 20469002.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8934; val_auprc_score: 0.8597; val_best_acc_score: 0.8270; val_best_f1_score: 0.8423; train_kl_reg_loss: 110599.4547; train_edge_recon_loss: 2836872.6553; train_gene_expr_recon_loss: 12490854.7424; train_masked_gp_l1_reg_loss: 48214.2652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110074.8220; train_chrom_access_recon_loss: 4776873.2045; train_global_loss: 20373489.0606; train_optim_loss: 20373489.0606; val_kl_reg_loss: 111834.0684; val_edge_recon_loss: 2877611.0312; val_gene_expr_recon_loss: 12442399.6250; val_masked_gp_l1_reg_loss: 49010.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108423.7500; val_chrom_access_recon_loss: 4762186.7500; val_global_loss: 20351465.5000; val_optim_loss: 20351465.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9007; val_auprc_score: 0.8776; val_best_acc_score: 0.8310; val_best_f1_score: 0.8463; train_kl_reg_loss: 110999.9527; train_edge_recon_loss: 2824485.7765; train_gene_expr_recon_loss: 12455441.3939; train_masked_gp_l1_reg_loss: 49703.5123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108089.7924; train_chrom_access_recon_loss: 4762410.5682; train_global_loss: 20311131.0909; train_optim_loss: 20311131.0909; val_kl_reg_loss: 108636.9727; val_edge_recon_loss: 2858445.1250; val_gene_expr_recon_loss: 12357521.8750; val_masked_gp_l1_reg_loss: 50378.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107821.5469; val_chrom_access_recon_loss: 4704584.6250; val_global_loss: 20187389.7500; val_optim_loss: 20187389.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9043; val_auprc_score: 0.8808; val_best_acc_score: 0.8431; val_best_f1_score: 0.8525; train_kl_reg_loss: 109011.9109; train_edge_recon_loss: 2827187.0568; train_gene_expr_recon_loss: 12392322.3939; train_masked_gp_l1_reg_loss: 50939.4099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107617.5730; train_chrom_access_recon_loss: 4740532.0076; train_global_loss: 20227610.3333; train_optim_loss: 20227610.3333; val_kl_reg_loss: 108209.2686; val_edge_recon_loss: 2866744.9375; val_gene_expr_recon_loss: 12347482.3750; val_masked_gp_l1_reg_loss: 51591.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107693.0469; val_chrom_access_recon_loss: 4726857.7500; val_global_loss: 20208578.0000; val_optim_loss: 20208578.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9020; val_auprc_score: 0.8716; val_best_acc_score: 0.8466; val_best_f1_score: 0.8575; train_kl_reg_loss: 109556.8748; train_edge_recon_loss: 2809106.2992; train_gene_expr_recon_loss: 12345922.5606; train_masked_gp_l1_reg_loss: 52055.4627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107413.7340; train_chrom_access_recon_loss: 4724894.2121; train_global_loss: 20148949.1515; train_optim_loss: 20148949.1515; val_kl_reg_loss: 101776.8066; val_edge_recon_loss: 2834988.8125; val_gene_expr_recon_loss: 12313929.7500; val_masked_gp_l1_reg_loss: 52625.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107195.8047; val_chrom_access_recon_loss: 4742617.6250; val_global_loss: 20153134.2500; val_optim_loss: 20153134.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8994; val_auprc_score: 0.8654; val_best_acc_score: 0.8385; val_best_f1_score: 0.8484; train_kl_reg_loss: 105226.7882; train_edge_recon_loss: 2806057.0947; train_gene_expr_recon_loss: 12303539.6364; train_masked_gp_l1_reg_loss: 53080.6264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107061.3185; train_chrom_access_recon_loss: 4708638.2803; train_global_loss: 20083603.6667; train_optim_loss: 20083603.6667; val_kl_reg_loss: 103826.2246; val_edge_recon_loss: 2885585.5000; val_gene_expr_recon_loss: 12319739.2500; val_masked_gp_l1_reg_loss: 53718.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107281.3984; val_chrom_access_recon_loss: 4749665.6250; val_global_loss: 20219815.5000; val_optim_loss: 20219815.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9099; val_auprc_score: 0.8785; val_best_acc_score: 0.8498; val_best_f1_score: 0.8607; train_kl_reg_loss: 103265.0827; train_edge_recon_loss: 2801627.1856; train_gene_expr_recon_loss: 12264629.3636; train_masked_gp_l1_reg_loss: 54095.8601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107225.1804; train_chrom_access_recon_loss: 4696656.8864; train_global_loss: 20027499.6667; train_optim_loss: 20027499.6667; val_kl_reg_loss: 96717.6348; val_edge_recon_loss: 2848279.2812; val_gene_expr_recon_loss: 12295006.6250; val_masked_gp_l1_reg_loss: 54654.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107714.6875; val_chrom_access_recon_loss: 4719219.0000; val_global_loss: 20121591.5000; val_optim_loss: 20121591.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9129; val_auprc_score: 0.8826; val_best_acc_score: 0.8530; val_best_f1_score: 0.8609; train_kl_reg_loss: 102408.3506; train_edge_recon_loss: 2796108.3788; train_gene_expr_recon_loss: 12241434.6364; train_masked_gp_l1_reg_loss: 55058.9303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107016.9286; train_chrom_access_recon_loss: 4683599.0833; train_global_loss: 19985626.5455; train_optim_loss: 19985626.5455; val_kl_reg_loss: 102057.1162; val_edge_recon_loss: 2834893.8750; val_gene_expr_recon_loss: 12199640.8750; val_masked_gp_l1_reg_loss: 55389.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106743.0000; val_chrom_access_recon_loss: 4623619.0000; val_global_loss: 19922344.0000; val_optim_loss: 19922344.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9134; val_auprc_score: 0.8884; val_best_acc_score: 0.8517; val_best_f1_score: 0.8596; train_kl_reg_loss: 103098.5378; train_edge_recon_loss: 2778842.2008; train_gene_expr_recon_loss: 12197236.3485; train_masked_gp_l1_reg_loss: 55791.3304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106989.6806; train_chrom_access_recon_loss: 4668487.8939; train_global_loss: 19910446.0606; train_optim_loss: 19910446.0606; val_kl_reg_loss: 100011.4746; val_edge_recon_loss: 2846676.8750; val_gene_expr_recon_loss: 12135782.5000; val_masked_gp_l1_reg_loss: 56187.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107490.2344; val_chrom_access_recon_loss: 4650491.1250; val_global_loss: 19896639.2500; val_optim_loss: 19896639.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9134; val_auprc_score: 0.8926; val_best_acc_score: 0.8506; val_best_f1_score: 0.8576; train_kl_reg_loss: 98821.8799; train_edge_recon_loss: 2791500.0189; train_gene_expr_recon_loss: 12156164.1061; train_masked_gp_l1_reg_loss: 56577.2898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106888.1400; train_chrom_access_recon_loss: 4653775.1061; train_global_loss: 19863726.3333; train_optim_loss: 19863726.3333; val_kl_reg_loss: 95687.6133; val_edge_recon_loss: 2846322.7812; val_gene_expr_recon_loss: 12274049.6250; val_masked_gp_l1_reg_loss: 57004.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107122.1797; val_chrom_access_recon_loss: 4664431.8750; val_global_loss: 20044617.7500; val_optim_loss: 20044617.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9203; val_auprc_score: 0.8957; val_best_acc_score: 0.8624; val_best_f1_score: 0.8679; train_kl_reg_loss: 96015.0709; train_edge_recon_loss: 2796970.8068; train_gene_expr_recon_loss: 12132578.4394; train_masked_gp_l1_reg_loss: 57342.3325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106797.7818; train_chrom_access_recon_loss: 4643366.7197; train_global_loss: 19833071.2121; train_optim_loss: 19833071.2121; val_kl_reg_loss: 94858.7871; val_edge_recon_loss: 2829940.7500; val_gene_expr_recon_loss: 12111200.1250; val_masked_gp_l1_reg_loss: 57688.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106921.9219; val_chrom_access_recon_loss: 4641176.1875; val_global_loss: 19841787.0000; val_optim_loss: 19841787.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9158; val_auprc_score: 0.8872; val_best_acc_score: 0.8576; val_best_f1_score: 0.8670; train_kl_reg_loss: 95659.6839; train_edge_recon_loss: 2775409.5152; train_gene_expr_recon_loss: 12106896.8636; train_masked_gp_l1_reg_loss: 58012.3910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106229.4592; train_chrom_access_recon_loss: 4634417.6212; train_global_loss: 19776625.4848; train_optim_loss: 19776625.4848; val_kl_reg_loss: 92930.4248; val_edge_recon_loss: 2823510.9062; val_gene_expr_recon_loss: 12113166.5000; val_masked_gp_l1_reg_loss: 58380.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106235.1953; val_chrom_access_recon_loss: 4628895.3750; val_global_loss: 19823119.5000; val_optim_loss: 19823119.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9231; val_auprc_score: 0.8990; val_best_acc_score: 0.8662; val_best_f1_score: 0.8721; train_kl_reg_loss: 93268.8089; train_edge_recon_loss: 2775213.1629; train_gene_expr_recon_loss: 12082489.6667; train_masked_gp_l1_reg_loss: 58745.7658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106255.4257; train_chrom_access_recon_loss: 4621973.0758; train_global_loss: 19737945.6667; train_optim_loss: 19737945.6667; val_kl_reg_loss: 92539.8447; val_edge_recon_loss: 2804904.9688; val_gene_expr_recon_loss: 12093010.2500; val_masked_gp_l1_reg_loss: 59085.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105951.5938; val_chrom_access_recon_loss: 4640697.0000; val_global_loss: 19796189.2500; val_optim_loss: 19796189.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9268; val_auprc_score: 0.9111; val_best_acc_score: 0.8638; val_best_f1_score: 0.8703; train_kl_reg_loss: 94115.1924; train_edge_recon_loss: 2763945.9659; train_gene_expr_recon_loss: 12057437.1667; train_masked_gp_l1_reg_loss: 59361.6706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105900.5402; train_chrom_access_recon_loss: 4614683.0379; train_global_loss: 19695443.6364; train_optim_loss: 19695443.6364; val_kl_reg_loss: 94502.8877; val_edge_recon_loss: 2801935.1562; val_gene_expr_recon_loss: 12054526.5000; val_masked_gp_l1_reg_loss: 59719.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106851.4062; val_chrom_access_recon_loss: 4608569.1250; val_global_loss: 19726104.5000; val_optim_loss: 19726104.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9277; val_auprc_score: 0.9034; val_best_acc_score: 0.8716; val_best_f1_score: 0.8761; train_kl_reg_loss: 92087.8422; train_edge_recon_loss: 2759268.5530; train_gene_expr_recon_loss: 12033542.4091; train_masked_gp_l1_reg_loss: 60045.3555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106566.9921; train_chrom_access_recon_loss: 4601145.6288; train_global_loss: 19652656.8788; train_optim_loss: 19652656.8788; val_kl_reg_loss: 91973.6963; val_edge_recon_loss: 2776753.7812; val_gene_expr_recon_loss: 11861396.5000; val_masked_gp_l1_reg_loss: 60349.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106160.6406; val_chrom_access_recon_loss: 4539846.1250; val_global_loss: 19436479.7500; val_optim_loss: 19436479.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9237; val_auprc_score: 0.8970; val_best_acc_score: 0.8657; val_best_f1_score: 0.8759; train_kl_reg_loss: 91297.9931; train_edge_recon_loss: 2767670.1326; train_gene_expr_recon_loss: 12003896.9394; train_masked_gp_l1_reg_loss: 60626.7143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106222.3139; train_chrom_access_recon_loss: 4591309.7273; train_global_loss: 19621023.8182; train_optim_loss: 19621023.8182; val_kl_reg_loss: 93105.6025; val_edge_recon_loss: 2763358.1875; val_gene_expr_recon_loss: 11989127.5000; val_masked_gp_l1_reg_loss: 60879.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105837.1094; val_chrom_access_recon_loss: 4592430.3750; val_global_loss: 19604737.7500; val_optim_loss: 19604737.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9273; val_auprc_score: 0.9049; val_best_acc_score: 0.8686; val_best_f1_score: 0.8774; train_kl_reg_loss: 91192.3643; train_edge_recon_loss: 2752020.6515; train_gene_expr_recon_loss: 11980060.2273; train_masked_gp_l1_reg_loss: 61121.9005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105951.5919; train_chrom_access_recon_loss: 4581115.3106; train_global_loss: 19571461.9697; train_optim_loss: 19571461.9697; val_kl_reg_loss: 90166.3076; val_edge_recon_loss: 2794430.5625; val_gene_expr_recon_loss: 11937384.2500; val_masked_gp_l1_reg_loss: 61409.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105933.7500; val_chrom_access_recon_loss: 4585395.6875; val_global_loss: 19574720.5000; val_optim_loss: 19574720.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9285; val_auprc_score: 0.9077; val_best_acc_score: 0.8716; val_best_f1_score: 0.8774; train_kl_reg_loss: 96374.8196; train_edge_recon_loss: 2774770.1098; train_gene_expr_recon_loss: 11809971.5303; train_masked_gp_l1_reg_loss: 61069.6538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107009.7900; train_chrom_access_recon_loss: 4541115.7197; train_global_loss: 19390311.6667; train_optim_loss: 19390311.6667; val_kl_reg_loss: 65472.6421; val_edge_recon_loss: 2803769.6250; val_gene_expr_recon_loss: 11861116.8750; val_masked_gp_l1_reg_loss: 60849.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107460.0078; val_chrom_access_recon_loss: 4522990.7500; val_global_loss: 19421658.7500; val_optim_loss: 19421658.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9260; val_auprc_score: 0.8978; val_best_acc_score: 0.8702; val_best_f1_score: 0.8747; train_kl_reg_loss: 95974.2892; train_edge_recon_loss: 2767471.2765; train_gene_expr_recon_loss: 11744112.5152; train_masked_gp_l1_reg_loss: 60961.6609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106757.8362; train_chrom_access_recon_loss: 4491744.0417; train_global_loss: 19267021.7879; train_optim_loss: 19267021.7879; val_kl_reg_loss: 70135.6562; val_edge_recon_loss: 2823555.1875; val_gene_expr_recon_loss: 11822306.5000; val_masked_gp_l1_reg_loss: 61150.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106162.5781; val_chrom_access_recon_loss: 4540911.5625; val_global_loss: 19424221.5000; val_optim_loss: 19424221.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9298; val_auprc_score: 0.9065; val_best_acc_score: 0.8692; val_best_f1_score: 0.8770; train_kl_reg_loss: 93564.6948; train_edge_recon_loss: 2751960.9697; train_gene_expr_recon_loss: 11727988.7424; train_masked_gp_l1_reg_loss: 61238.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105466.1228; train_chrom_access_recon_loss: 4481809.4242; train_global_loss: 19222028.5455; train_optim_loss: 19222028.5455; val_kl_reg_loss: 73231.7158; val_edge_recon_loss: 2802014.0938; val_gene_expr_recon_loss: 11720273.3750; val_masked_gp_l1_reg_loss: 61353.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105214.9531; val_chrom_access_recon_loss: 4457734.1250; val_global_loss: 19219821.5000; val_optim_loss: 19219821.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9364; val_auprc_score: 0.9204; val_best_acc_score: 0.8780; val_best_f1_score: 0.8841; train_kl_reg_loss: 91114.8460; train_edge_recon_loss: 2747162.3030; train_gene_expr_recon_loss: 11711472.2121; train_masked_gp_l1_reg_loss: 61471.1373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104835.3589; train_chrom_access_recon_loss: 4480907.3902; train_global_loss: 19196963.1212; train_optim_loss: 19196963.1212; val_kl_reg_loss: 75708.3652; val_edge_recon_loss: 2777011.4062; val_gene_expr_recon_loss: 11734319.2500; val_masked_gp_l1_reg_loss: 61586.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104428.0391; val_chrom_access_recon_loss: 4489370.5000; val_global_loss: 19242423.0000; val_optim_loss: 19242423.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9371; val_auprc_score: 0.9201; val_best_acc_score: 0.8791; val_best_f1_score: 0.8861; train_kl_reg_loss: 89217.7257; train_edge_recon_loss: 2729230.6023; train_gene_expr_recon_loss: 11694632.0303; train_masked_gp_l1_reg_loss: 61739.8083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104195.8595; train_chrom_access_recon_loss: 4470919.9697; train_global_loss: 19149936.0606; train_optim_loss: 19149936.0606; val_kl_reg_loss: 78335.1904; val_edge_recon_loss: 2736875.7500; val_gene_expr_recon_loss: 11658618.5000; val_masked_gp_l1_reg_loss: 61888.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103162.8047; val_chrom_access_recon_loss: 4446427.1875; val_global_loss: 19085307.7500; val_optim_loss: 19085307.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9358; val_auprc_score: 0.9179; val_best_acc_score: 0.8708; val_best_f1_score: 0.8786; train_kl_reg_loss: 87185.8119; train_edge_recon_loss: 2738900.2538; train_gene_expr_recon_loss: 11672956.3636; train_masked_gp_l1_reg_loss: 62039.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103575.6310; train_chrom_access_recon_loss: 4467029.1364; train_global_loss: 19131686.6061; train_optim_loss: 19131686.6061; val_kl_reg_loss: 76324.9785; val_edge_recon_loss: 2794226.8125; val_gene_expr_recon_loss: 11635094.1250; val_masked_gp_l1_reg_loss: 62194.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103445.4219; val_chrom_access_recon_loss: 4429417.1250; val_global_loss: 19100703.0000; val_optim_loss: 19100703.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9387; val_auprc_score: 0.9170; val_best_acc_score: 0.8821; val_best_f1_score: 0.8885; train_kl_reg_loss: 84634.9007; train_edge_recon_loss: 2736409.6098; train_gene_expr_recon_loss: 11650224.8333; train_masked_gp_l1_reg_loss: 62322.9613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103174.0426; train_chrom_access_recon_loss: 4453868.2917; train_global_loss: 19090634.6970; train_optim_loss: 19090634.6970; val_kl_reg_loss: 73744.0010; val_edge_recon_loss: 2760733.4375; val_gene_expr_recon_loss: 11642584.3750; val_masked_gp_l1_reg_loss: 62436.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103683.7344; val_chrom_access_recon_loss: 4469537.0000; val_global_loss: 19112719.7500; val_optim_loss: 19112719.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9357; val_auprc_score: 0.9198; val_best_acc_score: 0.8769; val_best_f1_score: 0.8821; train_kl_reg_loss: 83554.7704; train_edge_recon_loss: 2730284.2992; train_gene_expr_recon_loss: 11638399.5455; train_masked_gp_l1_reg_loss: 62598.6726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103021.0473; train_chrom_access_recon_loss: 4448952.6970; train_global_loss: 19066811.0000; train_optim_loss: 19066811.0000; val_kl_reg_loss: 77719.5801; val_edge_recon_loss: 2804539.6250; val_gene_expr_recon_loss: 11619590.6250; val_masked_gp_l1_reg_loss: 62810.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103277.1562; val_chrom_access_recon_loss: 4415171.3750; val_global_loss: 19083108.5000; val_optim_loss: 19083108.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9377; val_auprc_score: 0.9176; val_best_acc_score: 0.8812; val_best_f1_score: 0.8876; train_kl_reg_loss: 84640.9473; train_edge_recon_loss: 2718397.6553; train_gene_expr_recon_loss: 11616196.5000; train_masked_gp_l1_reg_loss: 62893.6042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102958.4729; train_chrom_access_recon_loss: 4443400.9091; train_global_loss: 19028488.0606; train_optim_loss: 19028488.0606; val_kl_reg_loss: 77767.7139; val_edge_recon_loss: 2740759.9375; val_gene_expr_recon_loss: 11635387.2500; val_masked_gp_l1_reg_loss: 63024.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102696.1641; val_chrom_access_recon_loss: 4459671.0000; val_global_loss: 19079306.0000; val_optim_loss: 19079306.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9393; val_auprc_score: 0.9192; val_best_acc_score: 0.8812; val_best_f1_score: 0.8864; train_kl_reg_loss: 82679.3710; train_edge_recon_loss: 2720680.7652; train_gene_expr_recon_loss: 11604209.2727; train_masked_gp_l1_reg_loss: 63182.6598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103103.7041; train_chrom_access_recon_loss: 4436183.9053; train_global_loss: 19010039.5455; train_optim_loss: 19010039.5455; val_kl_reg_loss: 77232.6445; val_edge_recon_loss: 2757835.3438; val_gene_expr_recon_loss: 11611759.2500; val_masked_gp_l1_reg_loss: 63359.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103419.4766; val_chrom_access_recon_loss: 4419290.8125; val_global_loss: 19032897.2500; val_optim_loss: 19032897.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9418; val_auprc_score: 0.9179; val_best_acc_score: 0.8845; val_best_f1_score: 0.8896; train_kl_reg_loss: 82446.4721; train_edge_recon_loss: 2708029.8636; train_gene_expr_recon_loss: 11582946.6212; train_masked_gp_l1_reg_loss: 63503.9711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102961.5036; train_chrom_access_recon_loss: 4433664.3712; train_global_loss: 18973552.9091; train_optim_loss: 18973552.9091; val_kl_reg_loss: 76643.8398; val_edge_recon_loss: 2765481.0625; val_gene_expr_recon_loss: 11591230.6250; val_masked_gp_l1_reg_loss: 63676.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102896.4609; val_chrom_access_recon_loss: 4433233.8750; val_global_loss: 19033162.5000; val_optim_loss: 19033162.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9458; val_auprc_score: 0.9257; val_best_acc_score: 0.8858; val_best_f1_score: 0.8910; train_kl_reg_loss: 81868.3616; train_edge_recon_loss: 2721782.8939; train_gene_expr_recon_loss: 11563237.0303; train_masked_gp_l1_reg_loss: 63809.8416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102747.2367; train_chrom_access_recon_loss: 4426286.1136; train_global_loss: 18959731.4848; train_optim_loss: 18959731.4848; val_kl_reg_loss: 79628.9551; val_edge_recon_loss: 2755261.5938; val_gene_expr_recon_loss: 11564433.2500; val_masked_gp_l1_reg_loss: 63880.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102944.9141; val_chrom_access_recon_loss: 4445456.0625; val_global_loss: 19011606.2500; val_optim_loss: 19011606.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9408; val_auprc_score: 0.9159; val_best_acc_score: 0.8872; val_best_f1_score: 0.8925; train_kl_reg_loss: 82946.8329; train_edge_recon_loss: 2704029.2462; train_gene_expr_recon_loss: 11547357.1515; train_masked_gp_l1_reg_loss: 64021.0105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102399.9801; train_chrom_access_recon_loss: 4421589.4659; train_global_loss: 18922343.7879; train_optim_loss: 18922343.7879; val_kl_reg_loss: 78794.7148; val_edge_recon_loss: 2767270.3750; val_gene_expr_recon_loss: 11482795.0000; val_masked_gp_l1_reg_loss: 64135.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102209.3281; val_chrom_access_recon_loss: 4385386.5000; val_global_loss: 18880590.5000; val_optim_loss: 18880590.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9469; val_auprc_score: 0.9281; val_best_acc_score: 0.8896; val_best_f1_score: 0.8949; train_kl_reg_loss: 81581.7414; train_edge_recon_loss: 2710778.6705; train_gene_expr_recon_loss: 11541671.0909; train_masked_gp_l1_reg_loss: 64310.6377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102293.8027; train_chrom_access_recon_loss: 4414047.6515; train_global_loss: 18914683.6970; train_optim_loss: 18914683.6970; val_kl_reg_loss: 77794.9395; val_edge_recon_loss: 2747521.5312; val_gene_expr_recon_loss: 11540565.0000; val_masked_gp_l1_reg_loss: 64432.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102302.6562; val_chrom_access_recon_loss: 4445721.6875; val_global_loss: 18978338.0000; val_optim_loss: 18978338.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9424; val_auprc_score: 0.9190; val_best_acc_score: 0.8880; val_best_f1_score: 0.8930; train_kl_reg_loss: 81407.1113; train_edge_recon_loss: 2698562.3523; train_gene_expr_recon_loss: 11517982.1515; train_masked_gp_l1_reg_loss: 64586.0640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102396.0858; train_chrom_access_recon_loss: 4405046.2008; train_global_loss: 18869980.0909; train_optim_loss: 18869980.0909; val_kl_reg_loss: 78530.6611; val_edge_recon_loss: 2768358.5938; val_gene_expr_recon_loss: 11551125.6250; val_masked_gp_l1_reg_loss: 64732.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103009.4922; val_chrom_access_recon_loss: 4403250.6875; val_global_loss: 18969006.0000; val_optim_loss: 18969006.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9526; val_auprc_score: 0.9290; val_best_acc_score: 0.9027; val_best_f1_score: 0.9050; train_kl_reg_loss: 80202.6945; train_edge_recon_loss: 2713810.1553; train_gene_expr_recon_loss: 11505156.1818; train_masked_gp_l1_reg_loss: 64891.8285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102439.9071; train_chrom_access_recon_loss: 4403215.1364; train_global_loss: 18869715.8485; train_optim_loss: 18869715.8485; val_kl_reg_loss: 76824.6816; val_edge_recon_loss: 2721550.5938; val_gene_expr_recon_loss: 11582173.0000; val_masked_gp_l1_reg_loss: 65045.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102698.7109; val_chrom_access_recon_loss: 4407161.4375; val_global_loss: 18955454.7500; val_optim_loss: 18955454.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9542; val_auprc_score: 0.9417; val_best_acc_score: 0.8966; val_best_f1_score: 0.9005; train_kl_reg_loss: 80733.5522; train_edge_recon_loss: 2700574.7462; train_gene_expr_recon_loss: 11491906.7121; train_masked_gp_l1_reg_loss: 65195.1058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102233.6102; train_chrom_access_recon_loss: 4397662.8750; train_global_loss: 18838306.5152; train_optim_loss: 18838306.5152; val_kl_reg_loss: 77637.5322; val_edge_recon_loss: 2754130.0938; val_gene_expr_recon_loss: 11523889.8750; val_masked_gp_l1_reg_loss: 65354.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101863.7109; val_chrom_access_recon_loss: 4408904.1875; val_global_loss: 18931780.0000; val_optim_loss: 18931780.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9554; val_auprc_score: 0.9374; val_best_acc_score: 0.9006; val_best_f1_score: 0.9023; train_kl_reg_loss: 80878.8551; train_edge_recon_loss: 2695195.1439; train_gene_expr_recon_loss: 11486332.0152; train_masked_gp_l1_reg_loss: 65062.0128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78840.2971; train_chrom_access_recon_loss: 4396127.4091; train_global_loss: 18802435.7576; train_optim_loss: 18802435.7576; val_kl_reg_loss: 79962.5049; val_edge_recon_loss: 2716562.2188; val_gene_expr_recon_loss: 11505277.0000; val_masked_gp_l1_reg_loss: 64892.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74626.2188; val_chrom_access_recon_loss: 4370974.5625; val_global_loss: 18812295.7500; val_optim_loss: 18812295.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9512; val_auprc_score: 0.9229; val_best_acc_score: 0.9003; val_best_f1_score: 0.9034; train_kl_reg_loss: 81690.6887; train_edge_recon_loss: 2706632.7576; train_gene_expr_recon_loss: 11478307.6818; train_masked_gp_l1_reg_loss: 64847.5666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74413.8970; train_chrom_access_recon_loss: 4388505.7311; train_global_loss: 18794398.3636; train_optim_loss: 18794398.3636; val_kl_reg_loss: 79030.1641; val_edge_recon_loss: 2738825.4688; val_gene_expr_recon_loss: 11540192.2500; val_masked_gp_l1_reg_loss: 64807.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74225.0938; val_chrom_access_recon_loss: 4402914.7500; val_global_loss: 18899995.0000; val_optim_loss: 18899995.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9505; val_auprc_score: 0.9283; val_best_acc_score: 0.8987; val_best_f1_score: 0.9025; train_kl_reg_loss: 81420.6928; train_edge_recon_loss: 2704167.4356; train_gene_expr_recon_loss: 11485818.0000; train_masked_gp_l1_reg_loss: 64797.4805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74119.3479; train_chrom_access_recon_loss: 4393544.8523; train_global_loss: 18803867.7576; train_optim_loss: 18803867.7576; val_kl_reg_loss: 79192.6748; val_edge_recon_loss: 2736851.8125; val_gene_expr_recon_loss: 11493535.2500; val_masked_gp_l1_reg_loss: 64789.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73997.1641; val_chrom_access_recon_loss: 4379025.2812; val_global_loss: 18827390.7500; val_optim_loss: 18827390.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9530; val_auprc_score: 0.9369; val_best_acc_score: 0.8990; val_best_f1_score: 0.9011; train_kl_reg_loss: 81885.7962; train_edge_recon_loss: 2696783.8409; train_gene_expr_recon_loss: 11475507.1364; train_masked_gp_l1_reg_loss: 64792.0011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73910.4537; train_chrom_access_recon_loss: 4387011.4167; train_global_loss: 18779890.6970; train_optim_loss: 18779890.6970; val_kl_reg_loss: 80154.6240; val_edge_recon_loss: 2730273.5312; val_gene_expr_recon_loss: 11422522.2500; val_masked_gp_l1_reg_loss: 64794.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73773.8203; val_chrom_access_recon_loss: 4386148.3125; val_global_loss: 18757666.7500; val_optim_loss: 18757666.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9557; val_auprc_score: 0.9385; val_best_acc_score: 0.9014; val_best_f1_score: 0.9054; train_kl_reg_loss: 81372.5521; train_edge_recon_loss: 2704380.9053; train_gene_expr_recon_loss: 11466469.8030; train_masked_gp_l1_reg_loss: 64802.6047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73669.6651; train_chrom_access_recon_loss: 4387938.9924; train_global_loss: 18778634.5152; train_optim_loss: 18778634.5152; val_kl_reg_loss: 79538.5752; val_edge_recon_loss: 2716796.0312; val_gene_expr_recon_loss: 11489559.6250; val_masked_gp_l1_reg_loss: 64808.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73678.6719; val_chrom_access_recon_loss: 4384711.1875; val_global_loss: 18809093.5000; val_optim_loss: 18809093.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9529; val_auprc_score: 0.9364; val_best_acc_score: 0.8979; val_best_f1_score: 0.9014; train_kl_reg_loss: 81332.0468; train_edge_recon_loss: 2709897.9659; train_gene_expr_recon_loss: 11473286.4697; train_masked_gp_l1_reg_loss: 64822.5078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73562.6924; train_chrom_access_recon_loss: 4389628.0947; train_global_loss: 18792529.7273; train_optim_loss: 18792529.7273; val_kl_reg_loss: 80142.0869; val_edge_recon_loss: 2728587.4062; val_gene_expr_recon_loss: 11521414.3750; val_masked_gp_l1_reg_loss: 64829.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73504.8984; val_chrom_access_recon_loss: 4397125.3125; val_global_loss: 18865604.7500; val_optim_loss: 18865604.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9505; val_auprc_score: 0.9322; val_best_acc_score: 0.8976; val_best_f1_score: 0.9001; train_kl_reg_loss: 82092.0065; train_edge_recon_loss: 2703914.2045; train_gene_expr_recon_loss: 11473830.5455; train_masked_gp_l1_reg_loss: 64842.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73424.7956; train_chrom_access_recon_loss: 4386211.4432; train_global_loss: 18784315.0606; train_optim_loss: 18784315.0606; val_kl_reg_loss: 80905.3926; val_edge_recon_loss: 2745980.9375; val_gene_expr_recon_loss: 11606332.3750; val_masked_gp_l1_reg_loss: 64846.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73312.5625; val_chrom_access_recon_loss: 4409420.4688; val_global_loss: 18980798.2500; val_optim_loss: 18980798.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9518; val_auprc_score: 0.9340; val_best_acc_score: 0.8998; val_best_f1_score: 0.9027; train_kl_reg_loss: 81632.9811; train_edge_recon_loss: 2704187.2576; train_gene_expr_recon_loss: 11470781.3485; train_masked_gp_l1_reg_loss: 64857.2032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73249.8252; train_chrom_access_recon_loss: 4385408.9735; train_global_loss: 18780117.5152; train_optim_loss: 18780117.5152; val_kl_reg_loss: 79528.4473; val_edge_recon_loss: 2713745.5000; val_gene_expr_recon_loss: 11384517.8750; val_masked_gp_l1_reg_loss: 64869.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73222.2656; val_chrom_access_recon_loss: 4309510.4062; val_global_loss: 18625393.1250; val_optim_loss: 18625393.1250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9575; val_auprc_score: 0.9447; val_best_acc_score: 0.9041; val_best_f1_score: 0.9059; train_kl_reg_loss: 82124.5308; train_edge_recon_loss: 2690385.5265; train_gene_expr_recon_loss: 11471396.8182; train_masked_gp_l1_reg_loss: 64891.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73212.9772; train_chrom_access_recon_loss: 4387468.0833; train_global_loss: 18769479.3333; train_optim_loss: 18769479.3333; val_kl_reg_loss: 80797.8252; val_edge_recon_loss: 2725822.7500; val_gene_expr_recon_loss: 11586663.6250; val_masked_gp_l1_reg_loss: 64904.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73181.8203; val_chrom_access_recon_loss: 4420490.5625; val_global_loss: 18951861.5000; val_optim_loss: 18951861.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9466; val_auprc_score: 0.9223; val_best_acc_score: 0.8979; val_best_f1_score: 0.9016; train_kl_reg_loss: 82289.7347; train_edge_recon_loss: 2694480.5000; train_gene_expr_recon_loss: 11462732.6970; train_masked_gp_l1_reg_loss: 64918.7530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73026.7135; train_chrom_access_recon_loss: 4383191.8371; train_global_loss: 18760640.3333; train_optim_loss: 18760640.3333; val_kl_reg_loss: 79442.5566; val_edge_recon_loss: 2726304.7500; val_gene_expr_recon_loss: 11605364.7500; val_masked_gp_l1_reg_loss: 64930.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72969.3281; val_chrom_access_recon_loss: 4471807.6875; val_global_loss: 19020819.7500; val_optim_loss: 19020819.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9547; val_auprc_score: 0.9348; val_best_acc_score: 0.9046; val_best_f1_score: 0.9077; train_kl_reg_loss: 81875.2861; train_edge_recon_loss: 2702394.2311; train_gene_expr_recon_loss: 11469360.5455; train_masked_gp_l1_reg_loss: 64944.7876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72926.1912; train_chrom_access_recon_loss: 4381397.3220; train_global_loss: 18772898.4242; train_optim_loss: 18772898.4242; val_kl_reg_loss: 80322.6387; val_edge_recon_loss: 2704497.4688; val_gene_expr_recon_loss: 11555015.6250; val_masked_gp_l1_reg_loss: 64958.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72798.8750; val_chrom_access_recon_loss: 4400398.0000; val_global_loss: 18877990.7500; val_optim_loss: 18877990.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9506; val_auprc_score: 0.9285; val_best_acc_score: 0.9017; val_best_f1_score: 0.9044; train_kl_reg_loss: 81780.2105; train_edge_recon_loss: 2698039.0038; train_gene_expr_recon_loss: 11452816.9545; train_masked_gp_l1_reg_loss: 64986.1966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72849.4006; train_chrom_access_recon_loss: 4378586.8144; train_global_loss: 18749058.5152; train_optim_loss: 18749058.5152; val_kl_reg_loss: 79559.3105; val_edge_recon_loss: 2736946.5625; val_gene_expr_recon_loss: 11469713.8750; val_masked_gp_l1_reg_loss: 64994.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72796.3125; val_chrom_access_recon_loss: 4411222.4375; val_global_loss: 18835233.2500; val_optim_loss: 18835233.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9502; val_auprc_score: 0.9303; val_best_acc_score: 0.8944; val_best_f1_score: 0.8973; train_kl_reg_loss: 81787.0194; train_edge_recon_loss: 2698672.6970; train_gene_expr_recon_loss: 11452293.6061; train_masked_gp_l1_reg_loss: 64965.1230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70208.0630; train_chrom_access_recon_loss: 4376513.9394; train_global_loss: 18744440.4242; train_optim_loss: 18744440.4242; val_kl_reg_loss: 79798.0820; val_edge_recon_loss: 2724328.4688; val_gene_expr_recon_loss: 11514618.2500; val_masked_gp_l1_reg_loss: 64948.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69732.9297; val_chrom_access_recon_loss: 4368070.3125; val_global_loss: 18821496.2500; val_optim_loss: 18821496.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9570; val_auprc_score: 0.9412; val_best_acc_score: 0.9084; val_best_f1_score: 0.9096; train_kl_reg_loss: 81735.7109; train_edge_recon_loss: 2688457.3674; train_gene_expr_recon_loss: 11450619.4394; train_masked_gp_l1_reg_loss: 64941.7691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69699.5051; train_chrom_access_recon_loss: 4376644.0303; train_global_loss: 18732097.9091; train_optim_loss: 18732097.9091; val_kl_reg_loss: 79949.0264; val_edge_recon_loss: 2693148.7500; val_gene_expr_recon_loss: 11529814.7500; val_masked_gp_l1_reg_loss: 64937.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69682.1250; val_chrom_access_recon_loss: 4378670.4375; val_global_loss: 18816202.7500; val_optim_loss: 18816202.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9507; val_auprc_score: 0.9275; val_best_acc_score: 0.8995; val_best_f1_score: 0.9020; train_kl_reg_loss: 81831.8684; train_edge_recon_loss: 2692730.6288; train_gene_expr_recon_loss: 11460909.6212; train_masked_gp_l1_reg_loss: 64935.4338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69669.2440; train_chrom_access_recon_loss: 4378527.0076; train_global_loss: 18748603.6667; train_optim_loss: 18748603.6667; val_kl_reg_loss: 79968.6582; val_edge_recon_loss: 2741831.5312; val_gene_expr_recon_loss: 11614357.6250; val_masked_gp_l1_reg_loss: 64932.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69651.9609; val_chrom_access_recon_loss: 4419952.1875; val_global_loss: 18990695.0000; val_optim_loss: 18990695.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9539; val_auprc_score: 0.9376; val_best_acc_score: 0.9025; val_best_f1_score: 0.9043; train_kl_reg_loss: 81939.8888; train_edge_recon_loss: 2695718.7311; train_gene_expr_recon_loss: 11465511.2273; train_masked_gp_l1_reg_loss: 64932.6006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69643.0040; train_chrom_access_recon_loss: 4379227.3371; train_global_loss: 18756972.9091; train_optim_loss: 18756972.9091; val_kl_reg_loss: 80240.0020; val_edge_recon_loss: 2736796.9688; val_gene_expr_recon_loss: 11508641.7500; val_masked_gp_l1_reg_loss: 64931.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69631.3047; val_chrom_access_recon_loss: 4401787.1562; val_global_loss: 18862029.0000; val_optim_loss: 18862029.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 52 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9521
val AUPRC score: 0.9362
val best accuracy score: 0.9019
val best F1 score: 0.9038
val target rna MSE score: 1.1128
val source rna MSE score: 0.4306
val target atac MSE score: 0.4828
val source atac MSE score: 0.1045
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
