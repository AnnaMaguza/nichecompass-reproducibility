[True]
Run timestamp: 10082023_221435_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7010; val_auprc_score: 0.7412; val_best_acc_score: 0.5042; val_best_f1_score: 0.6680; train_kl_reg_loss: 119740.6527; train_edge_recon_loss: 3826525.7786; train_gene_expr_recon_loss: 45630129.9847; train_masked_gp_l1_reg_loss: 86157.7548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245451.4303; train_chrom_access_recon_loss: 5546605.4847; train_global_loss: 55454610.9618; train_optim_loss: 55454610.9618; val_kl_reg_loss: 100724.3135; val_edge_recon_loss: 4064998.5000; val_gene_expr_recon_loss: 39244058.6667; val_masked_gp_l1_reg_loss: 84376.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240754.8281; val_chrom_access_recon_loss: 5223076.1667; val_global_loss: 48957990.1333; val_optim_loss: 48957990.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7309; val_auprc_score: 0.7545; val_best_acc_score: 0.6368; val_best_f1_score: 0.6994; train_kl_reg_loss: 169837.7954; train_edge_recon_loss: 3681287.7977; train_gene_expr_recon_loss: 38659439.2672; train_masked_gp_l1_reg_loss: 83326.4387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235312.2057; train_chrom_access_recon_loss: 5189010.6985; train_global_loss: 48018213.9542; train_optim_loss: 48018213.9542; val_kl_reg_loss: 178794.7052; val_edge_recon_loss: 4052405.4833; val_gene_expr_recon_loss: 37479111.2000; val_masked_gp_l1_reg_loss: 80045.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228499.0000; val_chrom_access_recon_loss: 5128865.1000; val_global_loss: 47147721.0667; val_optim_loss: 47147721.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8104; val_auprc_score: 0.8225; val_best_acc_score: 0.7020; val_best_f1_score: 0.7401; train_kl_reg_loss: 189682.3467; train_edge_recon_loss: 3567380.4084; train_gene_expr_recon_loss: 37002501.2214; train_masked_gp_l1_reg_loss: 77992.8701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221704.4784; train_chrom_access_recon_loss: 5108355.8015; train_global_loss: 46167616.3969; train_optim_loss: 46167616.3969; val_kl_reg_loss: 189918.1417; val_edge_recon_loss: 3983701.8333; val_gene_expr_recon_loss: 36927308.2667; val_masked_gp_l1_reg_loss: 77704.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214926.9531; val_chrom_access_recon_loss: 5076897.3000; val_global_loss: 46470457.6000; val_optim_loss: 46470457.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8746; val_auprc_score: 0.8674; val_best_acc_score: 0.7902; val_best_f1_score: 0.8075; train_kl_reg_loss: 156932.1650; train_edge_recon_loss: 3467089.4924; train_gene_expr_recon_loss: 36621610.5954; train_masked_gp_l1_reg_loss: 79089.6908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208473.4795; train_chrom_access_recon_loss: 5080507.2405; train_global_loss: 45613702.9313; train_optim_loss: 45613702.9313; val_kl_reg_loss: 146676.7594; val_edge_recon_loss: 3290807.7167; val_gene_expr_recon_loss: 36683198.6667; val_masked_gp_l1_reg_loss: 80617.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202062.7500; val_chrom_access_recon_loss: 5060054.1667; val_global_loss: 45463417.6000; val_optim_loss: 45463417.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8960; val_auprc_score: 0.8809; val_best_acc_score: 0.8174; val_best_f1_score: 0.8294; train_kl_reg_loss: 184733.0407; train_edge_recon_loss: 3076073.1870; train_gene_expr_recon_loss: 36355813.4962; train_masked_gp_l1_reg_loss: 83230.1517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196218.7661; train_chrom_access_recon_loss: 5055154.0458; train_global_loss: 44951222.8092; train_optim_loss: 44951222.8092; val_kl_reg_loss: 187450.0083; val_edge_recon_loss: 2994437.7000; val_gene_expr_recon_loss: 36469595.2000; val_masked_gp_l1_reg_loss: 84216.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190573.5156; val_chrom_access_recon_loss: 5043196.4000; val_global_loss: 44969466.4000; val_optim_loss: 44969466.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9171; val_auprc_score: 0.9062; val_best_acc_score: 0.8414; val_best_f1_score: 0.8464; train_kl_reg_loss: 191918.7854; train_edge_recon_loss: 2976562.4008; train_gene_expr_recon_loss: 36120153.0076; train_masked_gp_l1_reg_loss: 85526.9085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185410.8408; train_chrom_access_recon_loss: 5036899.2824; train_global_loss: 44596471.2366; train_optim_loss: 44596471.2366; val_kl_reg_loss: 183509.3781; val_edge_recon_loss: 2931219.8833; val_gene_expr_recon_loss: 36335365.3333; val_masked_gp_l1_reg_loss: 86802.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180227.2500; val_chrom_access_recon_loss: 5036461.6000; val_global_loss: 44753588.2667; val_optim_loss: 44753588.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9241; val_auprc_score: 0.9104; val_best_acc_score: 0.8533; val_best_f1_score: 0.8602; train_kl_reg_loss: 187051.3635; train_edge_recon_loss: 2932342.9618; train_gene_expr_recon_loss: 35869234.4427; train_masked_gp_l1_reg_loss: 87981.6175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175382.8918; train_chrom_access_recon_loss: 5006560.5611; train_global_loss: 44258553.7710; train_optim_loss: 44258553.7710; val_kl_reg_loss: 182881.7250; val_edge_recon_loss: 2918125.6000; val_gene_expr_recon_loss: 35938643.4667; val_masked_gp_l1_reg_loss: 89083.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170578.3906; val_chrom_access_recon_loss: 4996842.2333; val_global_loss: 44296157.3333; val_optim_loss: 44296157.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9335; val_auprc_score: 0.9225; val_best_acc_score: 0.8659; val_best_f1_score: 0.8721; train_kl_reg_loss: 180342.7233; train_edge_recon_loss: 2898944.0477; train_gene_expr_recon_loss: 35645191.2824; train_masked_gp_l1_reg_loss: 90322.8421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166147.8224; train_chrom_access_recon_loss: 4979861.1794; train_global_loss: 43960809.5878; train_optim_loss: 43960809.5878; val_kl_reg_loss: 177034.8594; val_edge_recon_loss: 2899745.3500; val_gene_expr_recon_loss: 35684399.2000; val_masked_gp_l1_reg_loss: 91401.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161748.9062; val_chrom_access_recon_loss: 4959190.0667; val_global_loss: 43973517.3333; val_optim_loss: 43973517.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9365; val_auprc_score: 0.9258; val_best_acc_score: 0.8721; val_best_f1_score: 0.8760; train_kl_reg_loss: 175116.1107; train_edge_recon_loss: 2885183.0668; train_gene_expr_recon_loss: 35508606.6565; train_masked_gp_l1_reg_loss: 92458.2276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157591.4041; train_chrom_access_recon_loss: 4968435.9466; train_global_loss: 43787391.7252; train_optim_loss: 43787391.7252; val_kl_reg_loss: 171831.2323; val_edge_recon_loss: 2877270.5167; val_gene_expr_recon_loss: 35685849.8667; val_masked_gp_l1_reg_loss: 93617.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153576.5469; val_chrom_access_recon_loss: 4979940.8667; val_global_loss: 43962083.2000; val_optim_loss: 43962083.2000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9415; val_auprc_score: 0.9321; val_best_acc_score: 0.8795; val_best_f1_score: 0.8844; train_kl_reg_loss: 170452.5476; train_edge_recon_loss: 2873710.6622; train_gene_expr_recon_loss: 35428777.0534; train_masked_gp_l1_reg_loss: 94763.9048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149802.6809; train_chrom_access_recon_loss: 4963037.4198; train_global_loss: 43680544.1221; train_optim_loss: 43680544.1221; val_kl_reg_loss: 168116.3927; val_edge_recon_loss: 2896467.0667; val_gene_expr_recon_loss: 35589225.3333; val_masked_gp_l1_reg_loss: 95817.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146187.8750; val_chrom_access_recon_loss: 4955255.2667; val_global_loss: 43851067.4667; val_optim_loss: 43851067.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9368; val_best_acc_score: 0.8878; val_best_f1_score: 0.8925; train_kl_reg_loss: 162783.4828; train_edge_recon_loss: 2851455.1737; train_gene_expr_recon_loss: 35223939.0382; train_masked_gp_l1_reg_loss: 96835.9000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142780.7923; train_chrom_access_recon_loss: 4934286.7328; train_global_loss: 43412080.8550; train_optim_loss: 43412080.8550; val_kl_reg_loss: 160233.9865; val_edge_recon_loss: 2850401.5667; val_gene_expr_recon_loss: 35536913.8667; val_masked_gp_l1_reg_loss: 97863.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139461.8438; val_chrom_access_recon_loss: 4958050.8333; val_global_loss: 43742924.0000; val_optim_loss: 43742924.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9475; val_auprc_score: 0.9393; val_best_acc_score: 0.8853; val_best_f1_score: 0.8902; train_kl_reg_loss: 158997.5485; train_edge_recon_loss: 2835466.5649; train_gene_expr_recon_loss: 35149106.6565; train_masked_gp_l1_reg_loss: 98918.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136259.9412; train_chrom_access_recon_loss: 4932049.3550; train_global_loss: 43310798.8397; train_optim_loss: 43310798.8397; val_kl_reg_loss: 156890.6104; val_edge_recon_loss: 2832988.3000; val_gene_expr_recon_loss: 35307264.2667; val_masked_gp_l1_reg_loss: 99846.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133029.6875; val_chrom_access_recon_loss: 4911815.8333; val_global_loss: 43441835.2000; val_optim_loss: 43441835.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9529; val_auprc_score: 0.9454; val_best_acc_score: 0.8948; val_best_f1_score: 0.8987; train_kl_reg_loss: 155177.2228; train_edge_recon_loss: 2823318.3817; train_gene_expr_recon_loss: 35039258.2137; train_masked_gp_l1_reg_loss: 100980.8251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129943.7777; train_chrom_access_recon_loss: 4919053.2328; train_global_loss: 43167731.3893; train_optim_loss: 43167731.3893; val_kl_reg_loss: 152458.7667; val_edge_recon_loss: 2820882.9833; val_gene_expr_recon_loss: 35080659.4667; val_masked_gp_l1_reg_loss: 101865.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126844.3984; val_chrom_access_recon_loss: 4896262.9667; val_global_loss: 43178972.5333; val_optim_loss: 43178972.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9569; val_auprc_score: 0.9507; val_best_acc_score: 0.8972; val_best_f1_score: 0.9010; train_kl_reg_loss: 149514.6859; train_edge_recon_loss: 2815090.5611; train_gene_expr_recon_loss: 34913438.5038; train_masked_gp_l1_reg_loss: 103052.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123939.4916; train_chrom_access_recon_loss: 4908442.2481; train_global_loss: 43013478.3511; train_optim_loss: 43013478.3511; val_kl_reg_loss: 149500.1656; val_edge_recon_loss: 2821409.3500; val_gene_expr_recon_loss: 35102576.5333; val_masked_gp_l1_reg_loss: 104572.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120985.5859; val_chrom_access_recon_loss: 4915875.3333; val_global_loss: 43214917.0667; val_optim_loss: 43214917.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9586; val_auprc_score: 0.9519; val_best_acc_score: 0.8988; val_best_f1_score: 0.9013; train_kl_reg_loss: 145241.5237; train_edge_recon_loss: 2801404.2538; train_gene_expr_recon_loss: 34869021.4351; train_masked_gp_l1_reg_loss: 105446.3724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118305.5471; train_chrom_access_recon_loss: 4906150.9962; train_global_loss: 42945570.2595; train_optim_loss: 42945570.2595; val_kl_reg_loss: 147634.4302; val_edge_recon_loss: 2811839.2500; val_gene_expr_recon_loss: 35165747.6000; val_masked_gp_l1_reg_loss: 106198.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115573.2656; val_chrom_access_recon_loss: 4915810.6000; val_global_loss: 43262804.0000; val_optim_loss: 43262804.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9576; val_auprc_score: 0.9468; val_best_acc_score: 0.8991; val_best_f1_score: 0.9010; train_kl_reg_loss: 144335.4474; train_edge_recon_loss: 2796307.3015; train_gene_expr_recon_loss: 34754039.5267; train_masked_gp_l1_reg_loss: 107110.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113074.7879; train_chrom_access_recon_loss: 4891038.5229; train_global_loss: 42805906.4427; train_optim_loss: 42805906.4427; val_kl_reg_loss: 140933.1667; val_edge_recon_loss: 2802525.3500; val_gene_expr_recon_loss: 34942027.0667; val_masked_gp_l1_reg_loss: 107897.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110576.9062; val_chrom_access_recon_loss: 4886085.5000; val_global_loss: 42990042.6667; val_optim_loss: 42990042.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9631; val_auprc_score: 0.9592; val_best_acc_score: 0.9018; val_best_f1_score: 0.9040; train_kl_reg_loss: 141728.3726; train_edge_recon_loss: 2783639.3225; train_gene_expr_recon_loss: 34703344.5802; train_masked_gp_l1_reg_loss: 108870.6920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108184.6421; train_chrom_access_recon_loss: 4888751.5840; train_global_loss: 42734519.0840; train_optim_loss: 42734519.0840; val_kl_reg_loss: 142546.9562; val_edge_recon_loss: 2806706.9333; val_gene_expr_recon_loss: 34904366.1333; val_masked_gp_l1_reg_loss: 109863.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105877.9766; val_chrom_access_recon_loss: 4878969.2333; val_global_loss: 42948329.8667; val_optim_loss: 42948329.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9660; val_auprc_score: 0.9592; val_best_acc_score: 0.9091; val_best_f1_score: 0.9120; train_kl_reg_loss: 139062.8791; train_edge_recon_loss: 2780536.1603; train_gene_expr_recon_loss: 34654977.9084; train_masked_gp_l1_reg_loss: 110784.3205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103654.0805; train_chrom_access_recon_loss: 4885449.7099; train_global_loss: 42674465.1298; train_optim_loss: 42674465.1298; val_kl_reg_loss: 139235.7062; val_edge_recon_loss: 2775326.1667; val_gene_expr_recon_loss: 34947443.7333; val_masked_gp_l1_reg_loss: 111759.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101476.4688; val_chrom_access_recon_loss: 4901502.4667; val_global_loss: 42976744.2667; val_optim_loss: 42976744.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9668; val_auprc_score: 0.9586; val_best_acc_score: 0.9123; val_best_f1_score: 0.9160; train_kl_reg_loss: 135765.4005; train_edge_recon_loss: 2777807.0496; train_gene_expr_recon_loss: 34573662.4122; train_masked_gp_l1_reg_loss: 112679.7170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99421.9569; train_chrom_access_recon_loss: 4876005.4351; train_global_loss: 42575342.0763; train_optim_loss: 42575342.0763; val_kl_reg_loss: 134515.4250; val_edge_recon_loss: 2769971.6333; val_gene_expr_recon_loss: 34882137.8667; val_masked_gp_l1_reg_loss: 113574.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97407.9844; val_chrom_access_recon_loss: 4903943.5333; val_global_loss: 42901552.5333; val_optim_loss: 42901552.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9703; val_auprc_score: 0.9636; val_best_acc_score: 0.9151; val_best_f1_score: 0.9179; train_kl_reg_loss: 133325.2838; train_edge_recon_loss: 2769608.9599; train_gene_expr_recon_loss: 34555616.2748; train_masked_gp_l1_reg_loss: 114565.5796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95586.1376; train_chrom_access_recon_loss: 4878973.9924; train_global_loss: 42547676.1832; train_optim_loss: 42547676.1832; val_kl_reg_loss: 132772.3448; val_edge_recon_loss: 2763037.1333; val_gene_expr_recon_loss: 34676632.2667; val_masked_gp_l1_reg_loss: 115488.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93765.6953; val_chrom_access_recon_loss: 4866648.4667; val_global_loss: 42648341.8667; val_optim_loss: 42648341.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9697; val_auprc_score: 0.9622; val_best_acc_score: 0.9196; val_best_f1_score: 0.9211; train_kl_reg_loss: 132129.7559; train_edge_recon_loss: 2756870.3130; train_gene_expr_recon_loss: 34498392.4580; train_masked_gp_l1_reg_loss: 116419.1548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92105.7671; train_chrom_access_recon_loss: 4876691.7901; train_global_loss: 42472609.0992; train_optim_loss: 42472609.0992; val_kl_reg_loss: 130881.7932; val_edge_recon_loss: 2771602.9833; val_gene_expr_recon_loss: 34749425.6000; val_masked_gp_l1_reg_loss: 117318.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90386.3672; val_chrom_access_recon_loss: 4862434.4333; val_global_loss: 42722052.2667; val_optim_loss: 42722052.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9678; val_auprc_score: 0.9599; val_best_acc_score: 0.9144; val_best_f1_score: 0.9178; train_kl_reg_loss: 130788.4142; train_edge_recon_loss: 2757941.2424; train_gene_expr_recon_loss: 34399682.3664; train_masked_gp_l1_reg_loss: 118293.4877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88905.4167; train_chrom_access_recon_loss: 4867123.7901; train_global_loss: 42362734.8092; train_optim_loss: 42362734.8092; val_kl_reg_loss: 130473.6115; val_edge_recon_loss: 2777705.0500; val_gene_expr_recon_loss: 34508804.0000; val_masked_gp_l1_reg_loss: 119124.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87325.4609; val_chrom_access_recon_loss: 4847159.8667; val_global_loss: 42470590.6667; val_optim_loss: 42470590.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9710; val_auprc_score: 0.9660; val_best_acc_score: 0.9151; val_best_f1_score: 0.9186; train_kl_reg_loss: 129076.1734; train_edge_recon_loss: 2756058.5592; train_gene_expr_recon_loss: 34354038.5954; train_masked_gp_l1_reg_loss: 120163.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85998.0901; train_chrom_access_recon_loss: 4861706.7176; train_global_loss: 42307041.8931; train_optim_loss: 42307041.8931; val_kl_reg_loss: 129143.8307; val_edge_recon_loss: 2774243.3833; val_gene_expr_recon_loss: 34687149.8667; val_masked_gp_l1_reg_loss: 121037.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84599.3750; val_chrom_access_recon_loss: 4868363.3333; val_global_loss: 42664536.5333; val_optim_loss: 42664536.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9684; val_auprc_score: 0.9602; val_best_acc_score: 0.9150; val_best_f1_score: 0.9169; train_kl_reg_loss: 127132.8061; train_edge_recon_loss: 2750468.5916; train_gene_expr_recon_loss: 34271283.2824; train_masked_gp_l1_reg_loss: 122030.7780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83288.4591; train_chrom_access_recon_loss: 4857399.2443; train_global_loss: 42211603.5115; train_optim_loss: 42211603.5115; val_kl_reg_loss: 127347.5240; val_edge_recon_loss: 2772915.3167; val_gene_expr_recon_loss: 34587562.9333; val_masked_gp_l1_reg_loss: 122789.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81964.2969; val_chrom_access_recon_loss: 4859263.7333; val_global_loss: 42551841.8667; val_optim_loss: 42551841.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9760; val_auprc_score: 0.9701; val_best_acc_score: 0.9251; val_best_f1_score: 0.9270; train_kl_reg_loss: 125749.3433; train_edge_recon_loss: 2744942.9447; train_gene_expr_recon_loss: 34272544.8855; train_masked_gp_l1_reg_loss: 123870.1268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80826.1322; train_chrom_access_recon_loss: 4863586.3779; train_global_loss: 42211519.5115; train_optim_loss: 42211519.5115; val_kl_reg_loss: 126790.3719; val_edge_recon_loss: 2747811.3500; val_gene_expr_recon_loss: 34446716.1333; val_masked_gp_l1_reg_loss: 124911.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79648.7891; val_chrom_access_recon_loss: 4825944.0000; val_global_loss: 42351821.6000; val_optim_loss: 42351821.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9546; val_auprc_score: 0.9468; val_best_acc_score: 0.8923; val_best_f1_score: 0.8971; train_kl_reg_loss: 156517.4930; train_edge_recon_loss: 3034254.9981; train_gene_expr_recon_loss: 39627864.5191; train_masked_gp_l1_reg_loss: 127605.2721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86149.3352; train_chrom_access_recon_loss: 5039514.2061; train_global_loss: 48071905.5878; train_optim_loss: 48071905.5878; val_kl_reg_loss: 16031.8025; val_edge_recon_loss: 2916784.8833; val_gene_expr_recon_loss: 41538174.6667; val_masked_gp_l1_reg_loss: 128991.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88401.6719; val_chrom_access_recon_loss: 5074661.9333; val_global_loss: 49763045.3333; val_optim_loss: 49763045.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9366; val_auprc_score: 0.9247; val_best_acc_score: 0.8701; val_best_f1_score: 0.8757; train_kl_reg_loss: 116346.6722; train_edge_recon_loss: 2842817.3111; train_gene_expr_recon_loss: 40980454.9618; train_masked_gp_l1_reg_loss: 126814.9010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86489.8844; train_chrom_access_recon_loss: 5051826.6412; train_global_loss: 49204750.6260; train_optim_loss: 49204750.6260; val_kl_reg_loss: 20821.2773; val_edge_recon_loss: 2837840.5333; val_gene_expr_recon_loss: 40986372.0000; val_masked_gp_l1_reg_loss: 124188.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84431.5312; val_chrom_access_recon_loss: 5050250.2667; val_global_loss: 49103904.8000; val_optim_loss: 49103904.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9428; val_auprc_score: 0.9297; val_best_acc_score: 0.8793; val_best_f1_score: 0.8835; train_kl_reg_loss: 72955.1084; train_edge_recon_loss: 2793807.9905; train_gene_expr_recon_loss: 40373439.6641; train_masked_gp_l1_reg_loss: 121399.5422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82266.1408; train_chrom_access_recon_loss: 5043502.9618; train_global_loss: 48487371.1450; train_optim_loss: 48487371.1450; val_kl_reg_loss: 27582.8609; val_edge_recon_loss: 2780733.5000; val_gene_expr_recon_loss: 40419889.6000; val_masked_gp_l1_reg_loss: 118565.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80125.5781; val_chrom_access_recon_loss: 5033364.6667; val_global_loss: 48460258.6667; val_optim_loss: 48460258.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9509; val_auprc_score: 0.9402; val_best_acc_score: 0.8879; val_best_f1_score: 0.8924; train_kl_reg_loss: 62292.0412; train_edge_recon_loss: 2760236.8492; train_gene_expr_recon_loss: 39786662.1985; train_masked_gp_l1_reg_loss: 115851.2484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78141.7655; train_chrom_access_recon_loss: 5025735.7061; train_global_loss: 47828919.6947; train_optim_loss: 47828919.6947; val_kl_reg_loss: 30837.9997; val_edge_recon_loss: 2746146.8167; val_gene_expr_recon_loss: 39817222.1333; val_masked_gp_l1_reg_loss: 113169.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76152.9766; val_chrom_access_recon_loss: 5021321.1667; val_global_loss: 47804847.7333; val_optim_loss: 47804847.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9473; val_auprc_score: 0.9337; val_best_acc_score: 0.8864; val_best_f1_score: 0.8922; train_kl_reg_loss: 57797.4187; train_edge_recon_loss: 2740991.7500; train_gene_expr_recon_loss: 39564671.8168; train_masked_gp_l1_reg_loss: 112655.4249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75919.9864; train_chrom_access_recon_loss: 5021735.5229; train_global_loss: 47573771.8473; train_optim_loss: 47573771.8473; val_kl_reg_loss: 30763.5618; val_edge_recon_loss: 2745846.5667; val_gene_expr_recon_loss: 39739885.3333; val_masked_gp_l1_reg_loss: 112352.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75690.7344; val_chrom_access_recon_loss: 5008077.3333; val_global_loss: 47712616.5333; val_optim_loss: 47712616.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9487; val_auprc_score: 0.9358; val_best_acc_score: 0.8855; val_best_f1_score: 0.8903; train_kl_reg_loss: 56906.5911; train_edge_recon_loss: 2739820.1718; train_gene_expr_recon_loss: 39467394.8702; train_masked_gp_l1_reg_loss: 112066.4146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75461.9473; train_chrom_access_recon_loss: 5015007.6298; train_global_loss: 47466657.8015; train_optim_loss: 47466657.8015; val_kl_reg_loss: 30659.1396; val_edge_recon_loss: 2740296.5333; val_gene_expr_recon_loss: 39646440.2667; val_masked_gp_l1_reg_loss: 111772.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75224.8125; val_chrom_access_recon_loss: 5009078.4000; val_global_loss: 47613470.1333; val_optim_loss: 47613470.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9466; val_auprc_score: 0.9320; val_best_acc_score: 0.8831; val_best_f1_score: 0.8886; train_kl_reg_loss: 55911.1529; train_edge_recon_loss: 2744755.9809; train_gene_expr_recon_loss: 39490624.6107; train_masked_gp_l1_reg_loss: 111476.5131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74990.2060; train_chrom_access_recon_loss: 5021641.8206; train_global_loss: 47499400.4275; train_optim_loss: 47499400.4275; val_kl_reg_loss: 30673.3316; val_edge_recon_loss: 2758048.1667; val_gene_expr_recon_loss: 39551570.4000; val_masked_gp_l1_reg_loss: 111169.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74745.4375; val_chrom_access_recon_loss: 4997915.8333; val_global_loss: 47524119.4667; val_optim_loss: 47524119.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9489; val_auprc_score: 0.9333; val_best_acc_score: 0.8884; val_best_f1_score: 0.8949; train_kl_reg_loss: 54953.8474; train_edge_recon_loss: 2733252.6851; train_gene_expr_recon_loss: 39448696.5802; train_masked_gp_l1_reg_loss: 110856.0613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74498.4332; train_chrom_access_recon_loss: 5018817.1603; train_global_loss: 47441074.8092; train_optim_loss: 47441074.8092; val_kl_reg_loss: 30788.4875; val_edge_recon_loss: 2761921.4500; val_gene_expr_recon_loss: 39705596.8000; val_masked_gp_l1_reg_loss: 110533.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74238.8438; val_chrom_access_recon_loss: 5031280.4333; val_global_loss: 47714358.4000; val_optim_loss: 47714358.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9707
val AUPRC score: 0.9607
val best accuracy score: 0.9202
val best F1 score: 0.9227
val target rna MSE score: 2.7307
val source rna MSE score: 111.8331
val target atac MSE score: 0.3611
val source atac MSE score: 24.0520
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
