[True]
Run timestamp: 02082023_021532_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8711; val_auprc_score: 0.9738; val_best_acc_score: 0.8739; val_best_f1_score: 0.9296; train_kl_reg_loss: 42233.7347; train_edge_recon_loss: 112105.1195; train_gene_expr_recon_loss: 2394726.1801; train_masked_gp_l1_reg_loss: 5892.9806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66173.0114; train_global_loss: 2621131.0236; train_optim_loss: 2621131.0236; val_kl_reg_loss: 28677.3543; val_edge_recon_loss: 108265.6803; val_gene_expr_recon_loss: 1994620.4919; val_masked_gp_l1_reg_loss: 6784.3560; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43550.8438; val_global_loss: 2181898.5242; val_optim_loss: 2181898.5242
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9174; val_auprc_score: 0.9824; val_best_acc_score: 0.9069; val_best_f1_score: 0.9470; train_kl_reg_loss: 24923.6402; train_edge_recon_loss: 102751.9634; train_gene_expr_recon_loss: 1900139.2625; train_masked_gp_l1_reg_loss: 7680.0319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32773.1671; train_global_loss: 2068268.0663; train_optim_loss: 2068268.0663; val_kl_reg_loss: 22481.5089; val_edge_recon_loss: 101531.6655; val_gene_expr_recon_loss: 1816193.1384; val_masked_gp_l1_reg_loss: 8455.6064; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24871.5234; val_global_loss: 1973533.4462; val_optim_loss: 1973533.4462
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9269; val_auprc_score: 0.9838; val_best_acc_score: 0.9228; val_best_f1_score: 0.9558; train_kl_reg_loss: 20471.1159; train_edge_recon_loss: 96246.3936; train_gene_expr_recon_loss: 1757226.7030; train_masked_gp_l1_reg_loss: 9002.7455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20832.4617; train_global_loss: 1903779.4177; train_optim_loss: 1903779.4177; val_kl_reg_loss: 18669.4181; val_edge_recon_loss: 95525.0456; val_gene_expr_recon_loss: 1703373.3817; val_masked_gp_l1_reg_loss: 9444.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17926.7422; val_global_loss: 1844938.9704; val_optim_loss: 1844938.9704
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9441; val_auprc_score: 0.9879; val_best_acc_score: 0.9349; val_best_f1_score: 0.9628; train_kl_reg_loss: 16890.9035; train_edge_recon_loss: 92262.3024; train_gene_expr_recon_loss: 1660698.5851; train_masked_gp_l1_reg_loss: 9621.2019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16303.2849; train_global_loss: 1795776.2764; train_optim_loss: 1795776.2764; val_kl_reg_loss: 15368.2780; val_edge_recon_loss: 89170.0709; val_gene_expr_recon_loss: 1619810.2258; val_masked_gp_l1_reg_loss: 9635.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15017.3652; val_global_loss: 1749001.9449; val_optim_loss: 1749001.9449
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9489; val_auprc_score: 0.9887; val_best_acc_score: 0.9372; val_best_f1_score: 0.9640; train_kl_reg_loss: 13819.7572; train_edge_recon_loss: 88266.2677; train_gene_expr_recon_loss: 1591397.4058; train_masked_gp_l1_reg_loss: 9308.7985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13941.2943; train_global_loss: 1716733.5228; train_optim_loss: 1716733.5228; val_kl_reg_loss: 12756.0020; val_edge_recon_loss: 86199.5753; val_gene_expr_recon_loss: 1563263.0699; val_masked_gp_l1_reg_loss: 8827.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12717.9609; val_global_loss: 1683764.5215; val_optim_loss: 1683764.5215
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9531; val_auprc_score: 0.9892; val_best_acc_score: 0.9450; val_best_f1_score: 0.9684; train_kl_reg_loss: 11798.9160; train_edge_recon_loss: 85963.8104; train_gene_expr_recon_loss: 1543899.3620; train_masked_gp_l1_reg_loss: 8178.8151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11388.7394; train_global_loss: 1661229.6437; train_optim_loss: 1661229.6437; val_kl_reg_loss: 11255.5318; val_edge_recon_loss: 84918.9162; val_gene_expr_recon_loss: 1527256.9731; val_masked_gp_l1_reg_loss: 7549.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10143.5898; val_global_loss: 1641124.2970; val_optim_loss: 1641124.2970
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9586; val_auprc_score: 0.9909; val_best_acc_score: 0.9457; val_best_f1_score: 0.9686; train_kl_reg_loss: 10500.9219; train_edge_recon_loss: 83456.8611; train_gene_expr_recon_loss: 1511404.6958; train_masked_gp_l1_reg_loss: 7103.1900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9153.8516; train_global_loss: 1621619.5231; train_optim_loss: 1621619.5231; val_kl_reg_loss: 10065.6425; val_edge_recon_loss: 83953.6309; val_gene_expr_recon_loss: 1495656.0632; val_masked_gp_l1_reg_loss: 6718.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8398.6436; val_global_loss: 1604792.2204; val_optim_loss: 1604792.2204
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9563; val_auprc_score: 0.9902; val_best_acc_score: 0.9471; val_best_f1_score: 0.9695; train_kl_reg_loss: 9822.0127; train_edge_recon_loss: 82954.4715; train_gene_expr_recon_loss: 1487483.8324; train_masked_gp_l1_reg_loss: 6486.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8196.6312; train_global_loss: 1594943.4370; train_optim_loss: 1594943.4370; val_kl_reg_loss: 9705.4891; val_edge_recon_loss: 81604.3997; val_gene_expr_recon_loss: 1474637.2366; val_masked_gp_l1_reg_loss: 6205.2803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8075.0303; val_global_loss: 1580227.3790; val_optim_loss: 1580227.3790
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9607; val_auprc_score: 0.9914; val_best_acc_score: 0.9498; val_best_f1_score: 0.9711; train_kl_reg_loss: 9369.8669; train_edge_recon_loss: 81725.4696; train_gene_expr_recon_loss: 1466901.5115; train_masked_gp_l1_reg_loss: 6082.7826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7817.9094; train_global_loss: 1571897.5357; train_optim_loss: 1571897.5357; val_kl_reg_loss: 9161.8811; val_edge_recon_loss: 81225.4225; val_gene_expr_recon_loss: 1458701.5968; val_masked_gp_l1_reg_loss: 5990.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7502.2510; val_global_loss: 1562581.8952; val_optim_loss: 1562581.8952
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9573; val_auprc_score: 0.9901; val_best_acc_score: 0.9514; val_best_f1_score: 0.9720; train_kl_reg_loss: 9129.3337; train_edge_recon_loss: 81272.7136; train_gene_expr_recon_loss: 1454970.5838; train_masked_gp_l1_reg_loss: 5931.2678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7201.5897; train_global_loss: 1558505.4881; train_optim_loss: 1558505.4881; val_kl_reg_loss: 8995.0044; val_edge_recon_loss: 81142.3238; val_gene_expr_recon_loss: 1449602.9960; val_masked_gp_l1_reg_loss: 5876.8433; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6928.0688; val_global_loss: 1552545.3239; val_optim_loss: 1552545.3239
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9579; val_auprc_score: 0.9894; val_best_acc_score: 0.9515; val_best_f1_score: 0.9720; train_kl_reg_loss: 8915.2903; train_edge_recon_loss: 80545.8044; train_gene_expr_recon_loss: 1446843.1644; train_masked_gp_l1_reg_loss: 5845.6141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6731.6384; train_global_loss: 1548881.5112; train_optim_loss: 1548881.5112; val_kl_reg_loss: 8685.0456; val_edge_recon_loss: 80543.0586; val_gene_expr_recon_loss: 1442290.4476; val_masked_gp_l1_reg_loss: 5791.3623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6559.6572; val_global_loss: 1543869.5511; val_optim_loss: 1543869.5511
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9585; val_auprc_score: 0.9900; val_best_acc_score: 0.9519; val_best_f1_score: 0.9722; train_kl_reg_loss: 8732.9303; train_edge_recon_loss: 81043.3034; train_gene_expr_recon_loss: 1441032.5402; train_masked_gp_l1_reg_loss: 5773.0358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6462.1560; train_global_loss: 1543043.9646; train_optim_loss: 1543043.9646; val_kl_reg_loss: 8585.1091; val_edge_recon_loss: 82252.3634; val_gene_expr_recon_loss: 1436994.2944; val_masked_gp_l1_reg_loss: 5740.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6399.2578; val_global_loss: 1539971.2675; val_optim_loss: 1539971.2675
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9604; val_auprc_score: 0.9908; val_best_acc_score: 0.9499; val_best_f1_score: 0.9710; train_kl_reg_loss: 8617.4536; train_edge_recon_loss: 80926.8868; train_gene_expr_recon_loss: 1442550.7210; train_masked_gp_l1_reg_loss: 5851.1331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6455.5953; train_global_loss: 1544401.7854; train_optim_loss: 1544401.7854; val_kl_reg_loss: 8492.7575; val_edge_recon_loss: 81464.9302; val_gene_expr_recon_loss: 1437157.1008; val_masked_gp_l1_reg_loss: 5739.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6509.0093; val_global_loss: 1539363.6613; val_optim_loss: 1539363.6613
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9580; val_auprc_score: 0.9894; val_best_acc_score: 0.9517; val_best_f1_score: 0.9720; train_kl_reg_loss: 8458.3956; train_edge_recon_loss: 80812.8842; train_gene_expr_recon_loss: 1435930.8850; train_masked_gp_l1_reg_loss: 5638.4880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6317.9239; train_global_loss: 1537158.5757; train_optim_loss: 1537158.5757; val_kl_reg_loss: 8405.6334; val_edge_recon_loss: 81055.0612; val_gene_expr_recon_loss: 1432545.3078; val_masked_gp_l1_reg_loss: 5583.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6135.2119; val_global_loss: 1533724.5027; val_optim_loss: 1533724.5027
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9582; val_auprc_score: 0.9896; val_best_acc_score: 0.9516; val_best_f1_score: 0.9720; train_kl_reg_loss: 8386.0296; train_edge_recon_loss: 80066.1558; train_gene_expr_recon_loss: 1433068.6810; train_masked_gp_l1_reg_loss: 5576.3223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6026.2439; train_global_loss: 1533123.4283; train_optim_loss: 1533123.4283; val_kl_reg_loss: 8276.8301; val_edge_recon_loss: 82092.7579; val_gene_expr_recon_loss: 1430532.5847; val_masked_gp_l1_reg_loss: 5562.5562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5913.9087; val_global_loss: 1532378.5524; val_optim_loss: 1532378.5524
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9578; val_auprc_score: 0.9898; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 8296.7987; train_edge_recon_loss: 79873.3412; train_gene_expr_recon_loss: 1431125.6175; train_masked_gp_l1_reg_loss: 5546.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5840.5561; train_global_loss: 1530682.3913; train_optim_loss: 1530682.3913; val_kl_reg_loss: 8379.7930; val_edge_recon_loss: 80713.8456; val_gene_expr_recon_loss: 1430080.4839; val_masked_gp_l1_reg_loss: 5529.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5781.6523; val_global_loss: 1530485.2500; val_optim_loss: 1530485.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9577; val_auprc_score: 0.9903; val_best_acc_score: 0.9511; val_best_f1_score: 0.9718; train_kl_reg_loss: 8283.0371; train_edge_recon_loss: 79704.9451; train_gene_expr_recon_loss: 1429702.8100; train_masked_gp_l1_reg_loss: 5518.8670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5739.0128; train_global_loss: 1528948.6753; train_optim_loss: 1528948.6753; val_kl_reg_loss: 8270.4920; val_edge_recon_loss: 80333.3317; val_gene_expr_recon_loss: 1427493.5444; val_masked_gp_l1_reg_loss: 5514.3481; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5698.7812; val_global_loss: 1527310.4973; val_optim_loss: 1527310.4973
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9659; val_auprc_score: 0.9923; val_best_acc_score: 0.9552; val_best_f1_score: 0.9741; train_kl_reg_loss: 8219.1479; train_edge_recon_loss: 79923.3998; train_gene_expr_recon_loss: 1427888.2836; train_masked_gp_l1_reg_loss: 5495.9840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5699.4005; train_global_loss: 1527226.2177; train_optim_loss: 1527226.2177; val_kl_reg_loss: 8117.3372; val_edge_recon_loss: 79669.4515; val_gene_expr_recon_loss: 1427410.1223; val_masked_gp_l1_reg_loss: 5468.2954; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5669.0879; val_global_loss: 1526334.2930; val_optim_loss: 1526334.2930
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9628; val_auprc_score: 0.9918; val_best_acc_score: 0.9544; val_best_f1_score: 0.9737; train_kl_reg_loss: 8195.3578; train_edge_recon_loss: 80021.0472; train_gene_expr_recon_loss: 1426919.3692; train_masked_gp_l1_reg_loss: 5476.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5651.7386; train_global_loss: 1526263.8889; train_optim_loss: 1526263.8889; val_kl_reg_loss: 8162.4092; val_edge_recon_loss: 78607.2113; val_gene_expr_recon_loss: 1425803.4664; val_masked_gp_l1_reg_loss: 5473.9502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5617.8896; val_global_loss: 1523664.9651; val_optim_loss: 1523664.9651
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9631; val_auprc_score: 0.9914; val_best_acc_score: 0.9537; val_best_f1_score: 0.9731; train_kl_reg_loss: 8184.3589; train_edge_recon_loss: 79972.6177; train_gene_expr_recon_loss: 1426439.0886; train_masked_gp_l1_reg_loss: 5459.8104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5555.4630; train_global_loss: 1525611.3362; train_optim_loss: 1525611.3362; val_kl_reg_loss: 8120.8149; val_edge_recon_loss: 80537.9957; val_gene_expr_recon_loss: 1424045.6425; val_masked_gp_l1_reg_loss: 5438.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5487.4854; val_global_loss: 1523630.5739; val_optim_loss: 1523630.5739
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9618; val_auprc_score: 0.9916; val_best_acc_score: 0.9539; val_best_f1_score: 0.9735; train_kl_reg_loss: 8141.2432; train_edge_recon_loss: 79285.2611; train_gene_expr_recon_loss: 1425854.3787; train_masked_gp_l1_reg_loss: 5441.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5426.8330; train_global_loss: 1524149.0565; train_optim_loss: 1524149.0565; val_kl_reg_loss: 8045.6604; val_edge_recon_loss: 77813.4299; val_gene_expr_recon_loss: 1423558.1371; val_masked_gp_l1_reg_loss: 5437.2207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5353.1665; val_global_loss: 1520207.5995; val_optim_loss: 1520207.5995
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9612; val_auprc_score: 0.9914; val_best_acc_score: 0.9516; val_best_f1_score: 0.9721; train_kl_reg_loss: 8135.3445; train_edge_recon_loss: 79972.8154; train_gene_expr_recon_loss: 1425819.5172; train_masked_gp_l1_reg_loss: 5438.2847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5303.8854; train_global_loss: 1524669.8493; train_optim_loss: 1524669.8493; val_kl_reg_loss: 8104.3230; val_edge_recon_loss: 78637.6544; val_gene_expr_recon_loss: 1426402.3011; val_masked_gp_l1_reg_loss: 5448.9521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5271.3652; val_global_loss: 1523864.6546; val_optim_loss: 1523864.6546
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9616; val_auprc_score: 0.9913; val_best_acc_score: 0.9497; val_best_f1_score: 0.9709; train_kl_reg_loss: 8113.7959; train_edge_recon_loss: 79639.1399; train_gene_expr_recon_loss: 1425101.8965; train_masked_gp_l1_reg_loss: 5430.9124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5196.5625; train_global_loss: 1523482.3072; train_optim_loss: 1523482.3072; val_kl_reg_loss: 8163.8048; val_edge_recon_loss: 80547.0527; val_gene_expr_recon_loss: 1425520.2997; val_masked_gp_l1_reg_loss: 5424.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5138.3213; val_global_loss: 1524793.7836; val_optim_loss: 1524793.7836
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9592; val_auprc_score: 0.9903; val_best_acc_score: 0.9473; val_best_f1_score: 0.9694; train_kl_reg_loss: 8063.3724; train_edge_recon_loss: 79734.1465; train_gene_expr_recon_loss: 1424766.8614; train_masked_gp_l1_reg_loss: 5414.8935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5098.5736; train_global_loss: 1523077.8445; train_optim_loss: 1523077.8445; val_kl_reg_loss: 8150.9383; val_edge_recon_loss: 81945.3943; val_gene_expr_recon_loss: 1426041.4167; val_masked_gp_l1_reg_loss: 5424.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5060.9541; val_global_loss: 1526623.1223; val_optim_loss: 1526623.1223
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9664; val_auprc_score: 0.9920; val_best_acc_score: 0.9566; val_best_f1_score: 0.9749; train_kl_reg_loss: 8043.6450; train_edge_recon_loss: 79231.9744; train_gene_expr_recon_loss: 1424476.8864; train_masked_gp_l1_reg_loss: 5410.7718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5011.2108; train_global_loss: 1522174.4894; train_optim_loss: 1522174.4894; val_kl_reg_loss: 7936.9162; val_edge_recon_loss: 78748.8180; val_gene_expr_recon_loss: 1422841.1922; val_masked_gp_l1_reg_loss: 5395.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4969.1592; val_global_loss: 1519891.4234; val_optim_loss: 1519891.4234
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9634; val_auprc_score: 0.9915; val_best_acc_score: 0.9505; val_best_f1_score: 0.9714; train_kl_reg_loss: 6955.7377; train_edge_recon_loss: 80105.4727; train_gene_expr_recon_loss: 1625660.3005; train_masked_gp_l1_reg_loss: 5418.5945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2322.0237; train_global_loss: 1720462.1320; train_optim_loss: 1720462.1320; val_kl_reg_loss: 6203.8924; val_edge_recon_loss: 80651.1557; val_gene_expr_recon_loss: 1595167.4731; val_masked_gp_l1_reg_loss: 5378.2622; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1293.4653; val_global_loss: 1688694.2715; val_optim_loss: 1688694.2715
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9582; val_auprc_score: 0.9895; val_best_acc_score: 0.9486; val_best_f1_score: 0.9703; train_kl_reg_loss: 6570.1331; train_edge_recon_loss: 79140.9170; train_gene_expr_recon_loss: 1594674.3871; train_masked_gp_l1_reg_loss: 5376.4376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 965.5119; train_global_loss: 1686727.3864; train_optim_loss: 1686727.3864; val_kl_reg_loss: 6260.6754; val_edge_recon_loss: 81059.0159; val_gene_expr_recon_loss: 1592357.2258; val_masked_gp_l1_reg_loss: 5380.1392; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 730.2715; val_global_loss: 1685787.2863; val_optim_loss: 1685787.2863
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9567; val_auprc_score: 0.9899; val_best_acc_score: 0.9453; val_best_f1_score: 0.9685; train_kl_reg_loss: 6447.7881; train_edge_recon_loss: 79357.8674; train_gene_expr_recon_loss: 1587469.7370; train_masked_gp_l1_reg_loss: 5384.5992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 584.8287; train_global_loss: 1679244.8208; train_optim_loss: 1679244.8208; val_kl_reg_loss: 6454.9330; val_edge_recon_loss: 80083.7115; val_gene_expr_recon_loss: 1585421.1653; val_masked_gp_l1_reg_loss: 5378.9136; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 466.0229; val_global_loss: 1677804.6895; val_optim_loss: 1677804.6895
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9614; val_auprc_score: 0.9898; val_best_acc_score: 0.9525; val_best_f1_score: 0.9725; train_kl_reg_loss: 6365.9550; train_edge_recon_loss: 79491.3222; train_gene_expr_recon_loss: 1580069.1169; train_masked_gp_l1_reg_loss: 5379.6094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 381.8612; train_global_loss: 1671687.8602; train_optim_loss: 1671687.8602; val_kl_reg_loss: 6233.0145; val_edge_recon_loss: 80383.9588; val_gene_expr_recon_loss: 1573209.4583; val_masked_gp_l1_reg_loss: 5377.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 306.7056; val_global_loss: 1665510.3038; val_optim_loss: 1665510.3038

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9629; val_auprc_score: 0.9916; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 6327.0569; train_edge_recon_loss: 78886.6159; train_gene_expr_recon_loss: 1574999.8059; train_masked_gp_l1_reg_loss: 5232.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227.9817; train_global_loss: 1665674.1045; train_optim_loss: 1665674.1045; val_kl_reg_loss: 6178.6029; val_edge_recon_loss: 77957.1072; val_gene_expr_recon_loss: 1573603.9960; val_masked_gp_l1_reg_loss: 5218.9463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218.4701; val_global_loss: 1663177.1976; val_optim_loss: 1663177.1976
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9644; val_auprc_score: 0.9906; val_best_acc_score: 0.9549; val_best_f1_score: 0.9739; train_kl_reg_loss: 6320.1095; train_edge_recon_loss: 78733.0504; train_gene_expr_recon_loss: 1574362.8648; train_masked_gp_l1_reg_loss: 5219.9986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208.3932; train_global_loss: 1664844.4176; train_optim_loss: 1664844.4176; val_kl_reg_loss: 6166.6608; val_edge_recon_loss: 79259.6071; val_gene_expr_recon_loss: 1571743.8925; val_masked_gp_l1_reg_loss: 5220.0483; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197.4208; val_global_loss: 1662587.5282; val_optim_loss: 1662587.5282
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9643; val_auprc_score: 0.9909; val_best_acc_score: 0.9548; val_best_f1_score: 0.9738; train_kl_reg_loss: 6321.3525; train_edge_recon_loss: 79010.6988; train_gene_expr_recon_loss: 1574097.3622; train_masked_gp_l1_reg_loss: 5219.7693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184.0019; train_global_loss: 1664833.1849; train_optim_loss: 1664833.1849; val_kl_reg_loss: 6219.6377; val_edge_recon_loss: 79139.7700; val_gene_expr_recon_loss: 1571521.9624; val_masked_gp_l1_reg_loss: 5218.8486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169.6801; val_global_loss: 1662269.8723; val_optim_loss: 1662269.8723
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9644; val_auprc_score: 0.9916; val_best_acc_score: 0.9533; val_best_f1_score: 0.9729; train_kl_reg_loss: 6313.5846; train_edge_recon_loss: 78942.7632; train_gene_expr_recon_loss: 1573240.3566; train_masked_gp_l1_reg_loss: 5220.3680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153.7014; train_global_loss: 1663870.7734; train_optim_loss: 1663870.7734; val_kl_reg_loss: 6210.3209; val_edge_recon_loss: 78932.2133; val_gene_expr_recon_loss: 1571134.9933; val_masked_gp_l1_reg_loss: 5219.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137.2985; val_global_loss: 1661634.1586; val_optim_loss: 1661634.1586

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 235 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9568
val AUPRC score: 0.9898
val best accuracy score: 0.9470
val best F1 score: 0.9694
val target rna MSE score: 9.7027
val source rna MSE score: 22.5075
Val cat covariate0 mean sim diff: -0.0041

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
