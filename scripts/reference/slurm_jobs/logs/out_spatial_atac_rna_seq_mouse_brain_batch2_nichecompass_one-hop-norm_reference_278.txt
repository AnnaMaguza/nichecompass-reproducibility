[True]
Run timestamp: 07092023_054317_278.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_278']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 22333 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 25929, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6783; val_auprc_score: 0.6594; val_best_acc_score: 0.5196; val_best_f1_score: 0.6736; train_kl_reg_loss: 47471.8671; train_edge_recon_loss: 3595878.7500; train_gene_expr_recon_loss: 15189447.2727; train_masked_gp_l1_reg_loss: 44163.6093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7801156.1174; train_chrom_access_recon_loss: 50036411.2727; train_global_loss: 76714528.9697; train_optim_loss: 76714528.9697; val_kl_reg_loss: 97321.9150; val_edge_recon_loss: 4064096.6562; val_gene_expr_recon_loss: 13763128.6250; val_masked_gp_l1_reg_loss: 42288.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2957367.2500; val_chrom_access_recon_loss: 48348728.5000; val_global_loss: 69272932.5000; val_optim_loss: 69272932.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7091; val_auprc_score: 0.7001; val_best_acc_score: 0.5862; val_best_f1_score: 0.6910; train_kl_reg_loss: 127261.0352; train_edge_recon_loss: 3583978.4773; train_gene_expr_recon_loss: 13340394.3636; train_masked_gp_l1_reg_loss: 37851.4792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1169687.3954; train_chrom_access_recon_loss: 47447166.8485; train_global_loss: 65706339.5152; train_optim_loss: 65706339.5152; val_kl_reg_loss: 137025.3379; val_edge_recon_loss: 4060066.9375; val_gene_expr_recon_loss: 13208651.3750; val_masked_gp_l1_reg_loss: 35078.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 431714.8438; val_chrom_access_recon_loss: 47322123.0000; val_global_loss: 65194659.5000; val_optim_loss: 65194659.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7774; val_auprc_score: 0.7590; val_best_acc_score: 0.6867; val_best_f1_score: 0.7343; train_kl_reg_loss: 128772.2721; train_edge_recon_loss: 3542730.0682; train_gene_expr_recon_loss: 12995410.9242; train_masked_gp_l1_reg_loss: 34740.6970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 308538.5481; train_chrom_access_recon_loss: 47018335.1515; train_global_loss: 64028528.0000; train_optim_loss: 64028528.0000; val_kl_reg_loss: 112975.8594; val_edge_recon_loss: 3998437.1250; val_gene_expr_recon_loss: 13029455.7500; val_masked_gp_l1_reg_loss: 35115.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232316.5312; val_chrom_access_recon_loss: 47156771.0000; val_global_loss: 64565073.0000; val_optim_loss: 64565073.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8142; val_auprc_score: 0.7791; val_best_acc_score: 0.7399; val_best_f1_score: 0.7758; train_kl_reg_loss: 106963.3854; train_edge_recon_loss: 3475968.3977; train_gene_expr_recon_loss: 12861050.6515; train_masked_gp_l1_reg_loss: 35848.7919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200637.6861; train_chrom_access_recon_loss: 46665551.3333; train_global_loss: 63346020.0606; train_optim_loss: 63346020.0606; val_kl_reg_loss: 88207.2090; val_edge_recon_loss: 3448216.4062; val_gene_expr_recon_loss: 12792227.3750; val_masked_gp_l1_reg_loss: 36721.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178313.2656; val_chrom_access_recon_loss: 46442920.5000; val_global_loss: 62986605.5000; val_optim_loss: 62986605.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8209; val_auprc_score: 0.7782; val_best_acc_score: 0.7397; val_best_f1_score: 0.7820; train_kl_reg_loss: 118431.0269; train_edge_recon_loss: 3130037.7386; train_gene_expr_recon_loss: 12783633.6667; train_masked_gp_l1_reg_loss: 37695.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166982.2642; train_chrom_access_recon_loss: 46381223.9394; train_global_loss: 62618003.8182; train_optim_loss: 62618003.8182; val_kl_reg_loss: 149447.9863; val_edge_recon_loss: 3048418.0625; val_gene_expr_recon_loss: 12851899.0000; val_masked_gp_l1_reg_loss: 38612.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157855.5156; val_chrom_access_recon_loss: 46823678.0000; val_global_loss: 63069912.5000; val_optim_loss: 63069912.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8265; val_auprc_score: 0.7756; val_best_acc_score: 0.7566; val_best_f1_score: 0.7889; train_kl_reg_loss: 139671.1065; train_edge_recon_loss: 2997232.0152; train_gene_expr_recon_loss: 12710311.2424; train_masked_gp_l1_reg_loss: 39299.8341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151829.7446; train_chrom_access_recon_loss: 46159164.0000; train_global_loss: 62197508.0606; train_optim_loss: 62197508.0606; val_kl_reg_loss: 130465.0127; val_edge_recon_loss: 3008943.7812; val_gene_expr_recon_loss: 12707256.8750; val_masked_gp_l1_reg_loss: 39991.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146618.8750; val_chrom_access_recon_loss: 45711939.5000; val_global_loss: 61745215.5000; val_optim_loss: 61745215.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8283; val_auprc_score: 0.7843; val_best_acc_score: 0.7681; val_best_f1_score: 0.7968; train_kl_reg_loss: 133532.3031; train_edge_recon_loss: 2983954.6970; train_gene_expr_recon_loss: 12637549.8485; train_masked_gp_l1_reg_loss: 40611.1039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142524.3054; train_chrom_access_recon_loss: 45947823.0909; train_global_loss: 61885995.3939; train_optim_loss: 61885995.3939; val_kl_reg_loss: 130305.9023; val_edge_recon_loss: 3006685.7188; val_gene_expr_recon_loss: 12634023.2500; val_masked_gp_l1_reg_loss: 41256.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138874.3906; val_chrom_access_recon_loss: 45705341.0000; val_global_loss: 61656487.0000; val_optim_loss: 61656487.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8394; val_auprc_score: 0.7953; val_best_acc_score: 0.7818; val_best_f1_score: 0.8087; train_kl_reg_loss: 127648.8578; train_edge_recon_loss: 2944377.8750; train_gene_expr_recon_loss: 12576456.4091; train_masked_gp_l1_reg_loss: 41863.3264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136113.9089; train_chrom_access_recon_loss: 45744629.3939; train_global_loss: 61571089.6364; train_optim_loss: 61571089.6364; val_kl_reg_loss: 119708.5215; val_edge_recon_loss: 2935525.7188; val_gene_expr_recon_loss: 12494400.0000; val_masked_gp_l1_reg_loss: 42467.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133950.2812; val_chrom_access_recon_loss: 45123664.0000; val_global_loss: 60849715.5000; val_optim_loss: 60849715.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8498; val_auprc_score: 0.8036; val_best_acc_score: 0.7918; val_best_f1_score: 0.8180; train_kl_reg_loss: 124598.7913; train_edge_recon_loss: 2915939.9583; train_gene_expr_recon_loss: 12535810.4697; train_masked_gp_l1_reg_loss: 42928.9858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131903.4541; train_chrom_access_recon_loss: 45609074.4242; train_global_loss: 61360256.0000; train_optim_loss: 61360256.0000; val_kl_reg_loss: 123493.9170; val_edge_recon_loss: 2949135.6875; val_gene_expr_recon_loss: 12634841.5000; val_masked_gp_l1_reg_loss: 43417.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130296.3281; val_chrom_access_recon_loss: 45936836.5000; val_global_loss: 61818020.5000; val_optim_loss: 61818020.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8552; val_auprc_score: 0.8095; val_best_acc_score: 0.7926; val_best_f1_score: 0.8204; train_kl_reg_loss: 122526.3716; train_edge_recon_loss: 2896564.2121; train_gene_expr_recon_loss: 12482553.8030; train_masked_gp_l1_reg_loss: 43988.9254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128789.1980; train_chrom_access_recon_loss: 45430098.9697; train_global_loss: 61104521.5758; train_optim_loss: 61104521.5758; val_kl_reg_loss: 123577.2246; val_edge_recon_loss: 2915144.0625; val_gene_expr_recon_loss: 12411049.3750; val_masked_gp_l1_reg_loss: 44536.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127790.5000; val_chrom_access_recon_loss: 44998946.5000; val_global_loss: 60621044.5000; val_optim_loss: 60621044.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8644; val_auprc_score: 0.8238; val_best_acc_score: 0.8025; val_best_f1_score: 0.8275; train_kl_reg_loss: 122088.8029; train_edge_recon_loss: 2879164.1705; train_gene_expr_recon_loss: 12428712.2273; train_masked_gp_l1_reg_loss: 45004.3150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126134.1665; train_chrom_access_recon_loss: 45232274.8485; train_global_loss: 60833378.5455; train_optim_loss: 60833378.5455; val_kl_reg_loss: 118275.8877; val_edge_recon_loss: 2919291.2812; val_gene_expr_recon_loss: 12418666.1250; val_masked_gp_l1_reg_loss: 45562.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124809.9531; val_chrom_access_recon_loss: 45222986.5000; val_global_loss: 60849592.5000; val_optim_loss: 60849592.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8646; val_auprc_score: 0.8265; val_best_acc_score: 0.7937; val_best_f1_score: 0.8226; train_kl_reg_loss: 121904.1576; train_edge_recon_loss: 2860857.5530; train_gene_expr_recon_loss: 12388082.2576; train_masked_gp_l1_reg_loss: 45982.6770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123918.0494; train_chrom_access_recon_loss: 45083458.4242; train_global_loss: 60624203.2727; train_optim_loss: 60624203.2727; val_kl_reg_loss: 120669.7412; val_edge_recon_loss: 2911647.8750; val_gene_expr_recon_loss: 12562339.8750; val_masked_gp_l1_reg_loss: 46436.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122923.3516; val_chrom_access_recon_loss: 45939101.5000; val_global_loss: 61703118.5000; val_optim_loss: 61703118.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8794; val_auprc_score: 0.8433; val_best_acc_score: 0.8074; val_best_f1_score: 0.8300; train_kl_reg_loss: 120811.6098; train_edge_recon_loss: 2846744.9886; train_gene_expr_recon_loss: 12340766.7273; train_masked_gp_l1_reg_loss: 46942.3900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121911.5451; train_chrom_access_recon_loss: 44895368.5455; train_global_loss: 60372545.6364; train_optim_loss: 60372545.6364; val_kl_reg_loss: 120561.5059; val_edge_recon_loss: 2883555.8750; val_gene_expr_recon_loss: 12514533.5000; val_masked_gp_l1_reg_loss: 47529.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121130.2812; val_chrom_access_recon_loss: 45715958.5000; val_global_loss: 61403269.0000; val_optim_loss: 61403269.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8923; val_auprc_score: 0.8607; val_best_acc_score: 0.8192; val_best_f1_score: 0.8377; train_kl_reg_loss: 121370.0032; train_edge_recon_loss: 2829815.6894; train_gene_expr_recon_loss: 12299780.6818; train_masked_gp_l1_reg_loss: 47997.2597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120370.9760; train_chrom_access_recon_loss: 44724764.7273; train_global_loss: 60144099.3333; train_optim_loss: 60144099.3333; val_kl_reg_loss: 120048.0361; val_edge_recon_loss: 2851336.7500; val_gene_expr_recon_loss: 12366073.2500; val_masked_gp_l1_reg_loss: 48445.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119565.9844; val_chrom_access_recon_loss: 44878181.5000; val_global_loss: 60383651.0000; val_optim_loss: 60383651.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9064; val_auprc_score: 0.8806; val_best_acc_score: 0.8337; val_best_f1_score: 0.8471; train_kl_reg_loss: 120238.1727; train_edge_recon_loss: 2815295.7689; train_gene_expr_recon_loss: 12258067.8485; train_masked_gp_l1_reg_loss: 48793.5453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118848.6849; train_chrom_access_recon_loss: 44553060.6667; train_global_loss: 59914304.6061; train_optim_loss: 59914304.6061; val_kl_reg_loss: 122173.6201; val_edge_recon_loss: 2816559.3750; val_gene_expr_recon_loss: 12225271.1250; val_masked_gp_l1_reg_loss: 49351.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118353.8594; val_chrom_access_recon_loss: 44636206.5000; val_global_loss: 59967916.5000; val_optim_loss: 59967916.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9090; val_auprc_score: 0.8790; val_best_acc_score: 0.8423; val_best_f1_score: 0.8540; train_kl_reg_loss: 118640.0881; train_edge_recon_loss: 2814269.2045; train_gene_expr_recon_loss: 12230096.3182; train_masked_gp_l1_reg_loss: 49710.4228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117575.6972; train_chrom_access_recon_loss: 44431726.3636; train_global_loss: 59762017.8182; train_optim_loss: 59762017.8182; val_kl_reg_loss: 118569.8242; val_edge_recon_loss: 2830582.9688; val_gene_expr_recon_loss: 12269602.5000; val_masked_gp_l1_reg_loss: 50035.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116778.9609; val_chrom_access_recon_loss: 44664279.5000; val_global_loss: 60049849.5000; val_optim_loss: 60049849.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9045; val_auprc_score: 0.8729; val_best_acc_score: 0.8418; val_best_f1_score: 0.8521; train_kl_reg_loss: 116842.7908; train_edge_recon_loss: 2805597.4773; train_gene_expr_recon_loss: 12199963.4545; train_masked_gp_l1_reg_loss: 50475.2213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116309.6583; train_chrom_access_recon_loss: 44256900.8485; train_global_loss: 59546089.6970; train_optim_loss: 59546089.6970; val_kl_reg_loss: 115902.2432; val_edge_recon_loss: 2860403.0000; val_gene_expr_recon_loss: 12187851.5000; val_masked_gp_l1_reg_loss: 50804.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115883.2500; val_chrom_access_recon_loss: 44493078.5000; val_global_loss: 59823923.5000; val_optim_loss: 59823923.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9121; val_auprc_score: 0.8802; val_best_acc_score: 0.8495; val_best_f1_score: 0.8608; train_kl_reg_loss: 117497.8358; train_edge_recon_loss: 2783998.5833; train_gene_expr_recon_loss: 12158850.7576; train_masked_gp_l1_reg_loss: 51213.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115210.5646; train_chrom_access_recon_loss: 44089357.4545; train_global_loss: 59316128.3636; train_optim_loss: 59316128.3636; val_kl_reg_loss: 114990.7549; val_edge_recon_loss: 2822004.5938; val_gene_expr_recon_loss: 12214798.3750; val_masked_gp_l1_reg_loss: 51628.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115118.1797; val_chrom_access_recon_loss: 44124278.5000; val_global_loss: 59442819.0000; val_optim_loss: 59442819.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9220; val_auprc_score: 0.8932; val_best_acc_score: 0.8600; val_best_f1_score: 0.8716; train_kl_reg_loss: 115836.9813; train_edge_recon_loss: 2778471.5947; train_gene_expr_recon_loss: 12143079.1212; train_masked_gp_l1_reg_loss: 52051.1547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114410.2692; train_chrom_access_recon_loss: 43944880.0606; train_global_loss: 59148729.0303; train_optim_loss: 59148729.0303; val_kl_reg_loss: 117378.0547; val_edge_recon_loss: 2805970.0938; val_gene_expr_recon_loss: 12307827.5000; val_masked_gp_l1_reg_loss: 52252.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113984.7969; val_chrom_access_recon_loss: 44511284.0000; val_global_loss: 59908698.0000; val_optim_loss: 59908698.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9232; val_auprc_score: 0.8948; val_best_acc_score: 0.8587; val_best_f1_score: 0.8690; train_kl_reg_loss: 115873.8209; train_edge_recon_loss: 2784221.7652; train_gene_expr_recon_loss: 12113313.0606; train_masked_gp_l1_reg_loss: 52727.1623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113388.7140; train_chrom_access_recon_loss: 43854793.5758; train_global_loss: 59034318.3030; train_optim_loss: 59034318.3030; val_kl_reg_loss: 113867.0488; val_edge_recon_loss: 2801843.4062; val_gene_expr_recon_loss: 12109701.0000; val_masked_gp_l1_reg_loss: 53129.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113362.8750; val_chrom_access_recon_loss: 43888734.5000; val_global_loss: 59080638.5000; val_optim_loss: 59080638.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9246; val_auprc_score: 0.8927; val_best_acc_score: 0.8630; val_best_f1_score: 0.8742; train_kl_reg_loss: 114837.4397; train_edge_recon_loss: 2776177.7803; train_gene_expr_recon_loss: 12090311.7576; train_masked_gp_l1_reg_loss: 53494.2396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112822.8279; train_chrom_access_recon_loss: 43695228.1818; train_global_loss: 58842872.1212; train_optim_loss: 58842872.1212; val_kl_reg_loss: 113652.1260; val_edge_recon_loss: 2797263.0625; val_gene_expr_recon_loss: 12097033.5000; val_masked_gp_l1_reg_loss: 53846.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112450.6406; val_chrom_access_recon_loss: 43761411.0000; val_global_loss: 58935658.0000; val_optim_loss: 58935658.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9243; val_auprc_score: 0.8924; val_best_acc_score: 0.8667; val_best_f1_score: 0.8767; train_kl_reg_loss: 114640.0578; train_edge_recon_loss: 2764289.3826; train_gene_expr_recon_loss: 12060711.2879; train_masked_gp_l1_reg_loss: 54130.2319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112119.4098; train_chrom_access_recon_loss: 43528725.6364; train_global_loss: 58634616.0606; train_optim_loss: 58634616.0606; val_kl_reg_loss: 113330.4092; val_edge_recon_loss: 2783269.8125; val_gene_expr_recon_loss: 12153376.7500; val_masked_gp_l1_reg_loss: 54420.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112051.1328; val_chrom_access_recon_loss: 44065057.0000; val_global_loss: 59281506.0000; val_optim_loss: 59281506.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9239; val_auprc_score: 0.8915; val_best_acc_score: 0.8670; val_best_f1_score: 0.8756; train_kl_reg_loss: 113373.3733; train_edge_recon_loss: 2759856.8371; train_gene_expr_recon_loss: 12027671.8939; train_masked_gp_l1_reg_loss: 54697.9528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111380.5279; train_chrom_access_recon_loss: 43376833.0303; train_global_loss: 58443813.6364; train_optim_loss: 58443813.6364; val_kl_reg_loss: 112823.2725; val_edge_recon_loss: 2802186.7188; val_gene_expr_recon_loss: 12080991.3750; val_masked_gp_l1_reg_loss: 54955.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111045.2500; val_chrom_access_recon_loss: 44026473.0000; val_global_loss: 59188473.5000; val_optim_loss: 59188473.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9295; val_auprc_score: 0.9056; val_best_acc_score: 0.8686; val_best_f1_score: 0.8781; train_kl_reg_loss: 112824.9609; train_edge_recon_loss: 2765667.8523; train_gene_expr_recon_loss: 12022671.6818; train_masked_gp_l1_reg_loss: 55295.9273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110762.7414; train_chrom_access_recon_loss: 43286284.7273; train_global_loss: 58353508.0000; train_optim_loss: 58353508.0000; val_kl_reg_loss: 111880.4111; val_edge_recon_loss: 2791663.1562; val_gene_expr_recon_loss: 12198387.7500; val_masked_gp_l1_reg_loss: 55816.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111502.2891; val_chrom_access_recon_loss: 43999995.5000; val_global_loss: 59269245.0000; val_optim_loss: 59269245.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9241; val_auprc_score: 0.8901; val_best_acc_score: 0.8764; val_best_f1_score: 0.8862; train_kl_reg_loss: 112690.0710; train_edge_recon_loss: 2754627.0682; train_gene_expr_recon_loss: 11983582.0000; train_masked_gp_l1_reg_loss: 55997.5932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110795.7848; train_chrom_access_recon_loss: 43108902.9091; train_global_loss: 58126595.3333; train_optim_loss: 58126595.3333; val_kl_reg_loss: 110220.1094; val_edge_recon_loss: 2789520.1250; val_gene_expr_recon_loss: 11975972.1250; val_masked_gp_l1_reg_loss: 56240.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110454.8750; val_chrom_access_recon_loss: 43175842.5000; val_global_loss: 58218250.0000; val_optim_loss: 58218250.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9382; val_auprc_score: 0.9114; val_best_acc_score: 0.8772; val_best_f1_score: 0.8816; train_kl_reg_loss: 110324.4985; train_edge_recon_loss: 2795354.2348; train_gene_expr_recon_loss: 11807295.4242; train_masked_gp_l1_reg_loss: 54776.6674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118493.2668; train_chrom_access_recon_loss: 43199452.6667; train_global_loss: 58085696.9697; train_optim_loss: 58085696.9697; val_kl_reg_loss: 78668.0459; val_edge_recon_loss: 2811417.5312; val_gene_expr_recon_loss: 11825023.8750; val_masked_gp_l1_reg_loss: 53977.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120874.6953; val_chrom_access_recon_loss: 43594139.5000; val_global_loss: 58484101.5000; val_optim_loss: 58484101.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9327; val_auprc_score: 0.9091; val_best_acc_score: 0.8716; val_best_f1_score: 0.8802; train_kl_reg_loss: 115015.0743; train_edge_recon_loss: 2770840.7462; train_gene_expr_recon_loss: 11732669.1515; train_masked_gp_l1_reg_loss: 53768.6070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118338.8864; train_chrom_access_recon_loss: 42788771.2727; train_global_loss: 57579403.5152; train_optim_loss: 57579403.5152; val_kl_reg_loss: 80849.6943; val_edge_recon_loss: 2797374.5625; val_gene_expr_recon_loss: 11605078.7500; val_masked_gp_l1_reg_loss: 53600.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116001.8672; val_chrom_access_recon_loss: 42700171.0000; val_global_loss: 57353076.0000; val_optim_loss: 57353076.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9313; val_auprc_score: 0.9072; val_best_acc_score: 0.8735; val_best_f1_score: 0.8825; train_kl_reg_loss: 113489.6229; train_edge_recon_loss: 2758626.4924; train_gene_expr_recon_loss: 11684684.9848; train_masked_gp_l1_reg_loss: 53480.3204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114439.4890; train_chrom_access_recon_loss: 42569591.3939; train_global_loss: 57294312.3636; train_optim_loss: 57294312.3636; val_kl_reg_loss: 81290.9219; val_edge_recon_loss: 2811869.2500; val_gene_expr_recon_loss: 11649167.0000; val_masked_gp_l1_reg_loss: 53378.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112889.8672; val_chrom_access_recon_loss: 42940313.5000; val_global_loss: 57648910.5000; val_optim_loss: 57648910.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9315; val_auprc_score: 0.9075; val_best_acc_score: 0.8716; val_best_f1_score: 0.8811; train_kl_reg_loss: 110054.9750; train_edge_recon_loss: 2758319.2841; train_gene_expr_recon_loss: 11639000.4091; train_masked_gp_l1_reg_loss: 53349.9941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111806.1547; train_chrom_access_recon_loss: 42440915.5152; train_global_loss: 57113446.5455; train_optim_loss: 57113446.5455; val_kl_reg_loss: 82775.7002; val_edge_recon_loss: 2809761.0312; val_gene_expr_recon_loss: 11728170.8750; val_masked_gp_l1_reg_loss: 53292.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110611.4219; val_chrom_access_recon_loss: 42677662.5000; val_global_loss: 57462273.5000; val_optim_loss: 57462273.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9324; val_auprc_score: 0.9043; val_best_acc_score: 0.8780; val_best_f1_score: 0.8856; train_kl_reg_loss: 1396055.1020; train_edge_recon_loss: 2762435.0795; train_gene_expr_recon_loss: 11642567.0909; train_masked_gp_l1_reg_loss: 53206.6098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108542.6703; train_chrom_access_recon_loss: 42317167.9394; train_global_loss: 58279974.0000; train_optim_loss: 58279974.0000; val_kl_reg_loss: 90351.9863; val_edge_recon_loss: 2768628.3438; val_gene_expr_recon_loss: 11835787.3750; val_masked_gp_l1_reg_loss: 52959.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105344.9766; val_chrom_access_recon_loss: 43022198.5000; val_global_loss: 57875270.0000; val_optim_loss: 57875270.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9295; val_auprc_score: 0.9022; val_best_acc_score: 0.8740; val_best_f1_score: 0.8822; train_kl_reg_loss: 111815.4448; train_edge_recon_loss: 2760937.4053; train_gene_expr_recon_loss: 11649809.3333; train_masked_gp_l1_reg_loss: 52623.5271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106050.6774; train_chrom_access_recon_loss: 42241035.8788; train_global_loss: 56922272.3030; train_optim_loss: 56922272.3030; val_kl_reg_loss: 88828.2275; val_edge_recon_loss: 2801913.0312; val_gene_expr_recon_loss: 11618222.5000; val_masked_gp_l1_reg_loss: 52367.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105505.5859; val_chrom_access_recon_loss: 41885232.0000; val_global_loss: 56552068.5000; val_optim_loss: 56552068.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9387; val_auprc_score: 0.9113; val_best_acc_score: 0.8874; val_best_f1_score: 0.8931; train_kl_reg_loss: 108592.6078; train_edge_recon_loss: 2737876.5265; train_gene_expr_recon_loss: 11562195.3636; train_masked_gp_l1_reg_loss: 52121.5475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104954.3653; train_chrom_access_recon_loss: 41963961.5152; train_global_loss: 56529702.0606; train_optim_loss: 56529702.0606; val_kl_reg_loss: 91287.7988; val_edge_recon_loss: 2773121.1875; val_gene_expr_recon_loss: 11593547.7500; val_masked_gp_l1_reg_loss: 51932.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104216.3281; val_chrom_access_recon_loss: 41792923.5000; val_global_loss: 56407029.5000; val_optim_loss: 56407029.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9327; val_auprc_score: 0.9106; val_best_acc_score: 0.8740; val_best_f1_score: 0.8806; train_kl_reg_loss: 360735.2622; train_edge_recon_loss: 2757831.8750; train_gene_expr_recon_loss: 11552709.2121; train_masked_gp_l1_reg_loss: 51573.7588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102808.8645; train_chrom_access_recon_loss: 41851061.8182; train_global_loss: 56676720.7879; train_optim_loss: 56676720.7879; val_kl_reg_loss: 86552.5488; val_edge_recon_loss: 2793584.8750; val_gene_expr_recon_loss: 11726448.0000; val_masked_gp_l1_reg_loss: 51296.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102414.5234; val_chrom_access_recon_loss: 42020904.0000; val_global_loss: 56781200.5000; val_optim_loss: 56781200.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9316; val_auprc_score: 0.9055; val_best_acc_score: 0.8740; val_best_f1_score: 0.8807; train_kl_reg_loss: 8185842018580.3838; train_edge_recon_loss: 2776527.5492; train_gene_expr_recon_loss: 11588970.3636; train_masked_gp_l1_reg_loss: 51091.5823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101140.5994; train_chrom_access_recon_loss: 41812454.3030; train_global_loss: 8185897987790.0605; train_optim_loss: 8185897987790.0605; val_kl_reg_loss: 113402.1641; val_edge_recon_loss: 2829306.2812; val_gene_expr_recon_loss: 11668385.7500; val_masked_gp_l1_reg_loss: 50857.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98669.9219; val_chrom_access_recon_loss: 42085687.0000; val_global_loss: 56846309.5000; val_optim_loss: 56846309.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9242; val_auprc_score: 0.8983; val_best_acc_score: 0.8686; val_best_f1_score: 0.8754; train_kl_reg_loss: 2276344453227.6865; train_edge_recon_loss: 2789460.8144; train_gene_expr_recon_loss: 11601113.8030; train_masked_gp_l1_reg_loss: 50470.7491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93666.7766; train_chrom_access_recon_loss: 41704091.9394; train_global_loss: 2276400614264.0000; train_optim_loss: 2276400614264.0000; val_kl_reg_loss: 103776.0908; val_edge_recon_loss: 2807565.2500; val_gene_expr_recon_loss: 11705832.6250; val_masked_gp_l1_reg_loss: 50060.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92403.5312; val_chrom_access_recon_loss: 42212333.5000; val_global_loss: 56971972.5000; val_optim_loss: 56971972.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9278; val_auprc_score: 0.8967; val_best_acc_score: 0.8667; val_best_f1_score: 0.8749; train_kl_reg_loss: 1556969.2016; train_edge_recon_loss: 2777299.1932; train_gene_expr_recon_loss: 11521502.5606; train_masked_gp_l1_reg_loss: 49727.5963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94034.3608; train_chrom_access_recon_loss: 41609111.3939; train_global_loss: 57608644.2424; train_optim_loss: 57608644.2424; val_kl_reg_loss: 76025781709989.8281; val_edge_recon_loss: 2799181.8438; val_gene_expr_recon_loss: 11443395.5000; val_masked_gp_l1_reg_loss: 49459.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95834.3359; val_chrom_access_recon_loss: 41513408.5000; val_global_loss: 76025835761441.0000; val_optim_loss: 76025835761441.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9343; val_auprc_score: 0.9102; val_best_acc_score: 0.8745; val_best_f1_score: 0.8820; train_kl_reg_loss: 1296334601631.9553; train_edge_recon_loss: 2781018.2235; train_gene_expr_recon_loss: 11474534.5152; train_masked_gp_l1_reg_loss: 49192.3184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72975.0812; train_chrom_access_recon_loss: 41526810.7273; train_global_loss: 1296390420608.3030; train_optim_loss: 1296390420608.3030; val_kl_reg_loss: 819538.4541; val_edge_recon_loss: 2803595.9375; val_gene_expr_recon_loss: 11476964.5000; val_masked_gp_l1_reg_loss: 49068.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69222.7422; val_chrom_access_recon_loss: 41208886.0000; val_global_loss: 56427275.5000; val_optim_loss: 56427275.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9348; val_auprc_score: 0.9120; val_best_acc_score: 0.8788; val_best_f1_score: 0.8857; train_kl_reg_loss: 215499235920471.3438; train_edge_recon_loss: 2785305.0303; train_gene_expr_recon_loss: 11473656.5606; train_masked_gp_l1_reg_loss: 49005.6471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68884.2621; train_chrom_access_recon_loss: 41432740.5455; train_global_loss: 215499290781914.9062; train_optim_loss: 215499290781914.9062; val_kl_reg_loss: 101790.1768; val_edge_recon_loss: 2779746.4062; val_gene_expr_recon_loss: 11496525.3750; val_masked_gp_l1_reg_loss: 48962.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68681.0078; val_chrom_access_recon_loss: 41590925.5000; val_global_loss: 56086630.5000; val_optim_loss: 56086630.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9302; val_auprc_score: 0.8992; val_best_acc_score: 0.8759; val_best_f1_score: 0.8833; train_kl_reg_loss: 1038349.4540; train_edge_recon_loss: 2781918.8409; train_gene_expr_recon_loss: 11472275.7727; train_masked_gp_l1_reg_loss: 48938.6826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68587.0228; train_chrom_access_recon_loss: 41472321.7576; train_global_loss: 56882391.3333; train_optim_loss: 56882391.3333; val_kl_reg_loss: 101328.3057; val_edge_recon_loss: 2792957.9375; val_gene_expr_recon_loss: 11404177.6250; val_masked_gp_l1_reg_loss: 48913.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68545.3594; val_chrom_access_recon_loss: 41399306.0000; val_global_loss: 55815229.0000; val_optim_loss: 55815229.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9339; val_auprc_score: 0.9074; val_best_acc_score: 0.8743; val_best_f1_score: 0.8809; train_kl_reg_loss: 169869.4528; train_edge_recon_loss: 2779354.7462; train_gene_expr_recon_loss: 11431142.3333; train_masked_gp_l1_reg_loss: 48888.0440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68513.8133; train_chrom_access_recon_loss: 41354894.7273; train_global_loss: 55852663.0303; train_optim_loss: 55852663.0303; val_kl_reg_loss: 100488.2402; val_edge_recon_loss: 2811265.6562; val_gene_expr_recon_loss: 11339169.5000; val_masked_gp_l1_reg_loss: 48855.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68525.5156; val_chrom_access_recon_loss: 41095510.5000; val_global_loss: 55463816.0000; val_optim_loss: 55463816.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9331; val_auprc_score: 0.9040; val_best_acc_score: 0.8761; val_best_f1_score: 0.8832; train_kl_reg_loss: 123214.0917; train_edge_recon_loss: 2753711.7879; train_gene_expr_recon_loss: 11432503.6364; train_masked_gp_l1_reg_loss: 48847.5855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68566.1420; train_chrom_access_recon_loss: 41364580.3636; train_global_loss: 55791423.6970; train_optim_loss: 55791423.6970; val_kl_reg_loss: 101084.4365; val_edge_recon_loss: 2785746.3750; val_gene_expr_recon_loss: 11482036.6250; val_masked_gp_l1_reg_loss: 48820.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68571.6719; val_chrom_access_recon_loss: 41451846.5000; val_global_loss: 55938106.5000; val_optim_loss: 55938106.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9336; val_auprc_score: 0.9136; val_best_acc_score: 0.8694; val_best_f1_score: 0.8790; train_kl_reg_loss: 122643.3956; train_edge_recon_loss: 2768121.8371; train_gene_expr_recon_loss: 11431132.5909; train_masked_gp_l1_reg_loss: 48809.8636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68410.6864; train_chrom_access_recon_loss: 41348489.7576; train_global_loss: 55787607.8788; train_optim_loss: 55787607.8788; val_kl_reg_loss: 101203.1064; val_edge_recon_loss: 2811450.0000; val_gene_expr_recon_loss: 11374315.7500; val_masked_gp_l1_reg_loss: 48793.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68375.5156; val_chrom_access_recon_loss: 41607019.0000; val_global_loss: 56011157.0000; val_optim_loss: 56011157.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9330; val_auprc_score: 0.9092; val_best_acc_score: 0.8708; val_best_f1_score: 0.8794; train_kl_reg_loss: 122302.8097; train_edge_recon_loss: 2760814.3561; train_gene_expr_recon_loss: 11418837.6212; train_masked_gp_l1_reg_loss: 48784.1806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68375.7041; train_chrom_access_recon_loss: 41323995.5758; train_global_loss: 55743110.3030; train_optim_loss: 55743110.3030; val_kl_reg_loss: 102032.1826; val_edge_recon_loss: 2792711.8125; val_gene_expr_recon_loss: 11420889.3750; val_masked_gp_l1_reg_loss: 48766.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68346.6172; val_chrom_access_recon_loss: 41416206.0000; val_global_loss: 55848954.0000; val_optim_loss: 55848954.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9358; val_auprc_score: 0.9118; val_best_acc_score: 0.8807; val_best_f1_score: 0.8866; train_kl_reg_loss: 235051.1726; train_edge_recon_loss: 2763806.0455; train_gene_expr_recon_loss: 11405888.5455; train_masked_gp_l1_reg_loss: 48746.9060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68324.4943; train_chrom_access_recon_loss: 41346325.2727; train_global_loss: 55868142.6061; train_optim_loss: 55868142.6061; val_kl_reg_loss: 101197.1191; val_edge_recon_loss: 2758105.1875; val_gene_expr_recon_loss: 11521809.7500; val_masked_gp_l1_reg_loss: 48723.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68303.8750; val_chrom_access_recon_loss: 41872104.5000; val_global_loss: 56370244.0000; val_optim_loss: 56370244.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9343; val_auprc_score: 0.9131; val_best_acc_score: 0.8743; val_best_f1_score: 0.8822; train_kl_reg_loss: 118913.7126; train_edge_recon_loss: 2760669.6098; train_gene_expr_recon_loss: 11443966.2576; train_masked_gp_l1_reg_loss: 48700.9750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65777.8572; train_chrom_access_recon_loss: 41321958.0606; train_global_loss: 55759986.6061; train_optim_loss: 55759986.6061; val_kl_reg_loss: 101703.4971; val_edge_recon_loss: 2792342.1875; val_gene_expr_recon_loss: 11477193.1250; val_masked_gp_l1_reg_loss: 48690.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65338.5078; val_chrom_access_recon_loss: 41361250.0000; val_global_loss: 55846518.0000; val_optim_loss: 55846518.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9366; val_auprc_score: 0.9123; val_best_acc_score: 0.8802; val_best_f1_score: 0.8871; train_kl_reg_loss: 203661.8192; train_edge_recon_loss: 2764148.9545; train_gene_expr_recon_loss: 11397773.9091; train_masked_gp_l1_reg_loss: 48684.8775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65326.5444; train_chrom_access_recon_loss: 41245960.7879; train_global_loss: 55725556.6667; train_optim_loss: 55725556.6667; val_kl_reg_loss: 103995.4736; val_edge_recon_loss: 2786451.1562; val_gene_expr_recon_loss: 11484389.5000; val_masked_gp_l1_reg_loss: 48679.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65319.1680; val_chrom_access_recon_loss: 41383517.5000; val_global_loss: 55872351.5000; val_optim_loss: 55872351.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9391; val_auprc_score: 0.9201; val_best_acc_score: 0.8818; val_best_f1_score: 0.8884; train_kl_reg_loss: 118654.9865; train_edge_recon_loss: 2766243.4773; train_gene_expr_recon_loss: 11387080.3939; train_masked_gp_l1_reg_loss: 48675.5501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65312.3428; train_chrom_access_recon_loss: 41223493.1515; train_global_loss: 55609459.8182; train_optim_loss: 55609459.8182; val_kl_reg_loss: 100852.6875; val_edge_recon_loss: 2774421.7188; val_gene_expr_recon_loss: 11417508.8750; val_masked_gp_l1_reg_loss: 48671.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65305.0469; val_chrom_access_recon_loss: 41144965.0000; val_global_loss: 55551725.0000; val_optim_loss: 55551725.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9331; val_auprc_score: 0.9083; val_best_acc_score: 0.8735; val_best_f1_score: 0.8807; train_kl_reg_loss: 122249.2363; train_edge_recon_loss: 2775694.2159; train_gene_expr_recon_loss: 11408090.3485; train_masked_gp_l1_reg_loss: 48668.3306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65303.7930; train_chrom_access_recon_loss: 41296104.9697; train_global_loss: 55716111.0303; train_optim_loss: 55716111.0303; val_kl_reg_loss: 506786.5908; val_edge_recon_loss: 2794005.7188; val_gene_expr_recon_loss: 11466383.1250; val_masked_gp_l1_reg_loss: 48665.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65296.0664; val_chrom_access_recon_loss: 41468657.0000; val_global_loss: 56349794.5000; val_optim_loss: 56349794.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 22 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9353
val AUPRC score: 0.9101
val best accuracy score: 0.8794
val best F1 score: 0.8852
val target rna MSE score: 1.5905
val source rna MSE score: 0.8441
val target atac MSE score: 0.1280
val source atac MSE score: 0.0336
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
