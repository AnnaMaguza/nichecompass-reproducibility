[True]
Run timestamp: 27072023_023118_128.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_128']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8661; val_auprc_score: 0.9737; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 352132.4305; train_edge_recon_loss: 10575283.3953; train_gene_expr_recon_loss: 22512911.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33440327.6372; train_optim_loss: 33440327.6372; val_kl_reg_loss: 301640.3737; val_edge_recon_loss: 12000300.0000; val_gene_expr_recon_loss: 10984461.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23286402.0833; val_optim_loss: 23286402.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8444; val_auprc_score: 0.9703; val_best_acc_score: 0.8680; val_best_f1_score: 0.9283; train_kl_reg_loss: 295071.8235; train_edge_recon_loss: 10533342.5023; train_gene_expr_recon_loss: 10490123.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21318538.0372; train_optim_loss: 21318538.0372; val_kl_reg_loss: 263189.6107; val_edge_recon_loss: 11592167.5000; val_gene_expr_recon_loss: 10152635.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22007992.0833; val_optim_loss: 22007992.0833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8603; val_auprc_score: 0.9715; val_best_acc_score: 0.8723; val_best_f1_score: 0.9291; train_kl_reg_loss: 231082.1422; train_edge_recon_loss: 10600102.5070; train_gene_expr_recon_loss: 10063532.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20894717.0884; train_optim_loss: 20894717.0884; val_kl_reg_loss: 161490.1862; val_edge_recon_loss: 12038847.3333; val_gene_expr_recon_loss: 9901802.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22102139.5833; val_optim_loss: 22102139.5833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8543; val_auprc_score: 0.9680; val_best_acc_score: 0.8775; val_best_f1_score: 0.9320; train_kl_reg_loss: 193584.3958; train_edge_recon_loss: 10377397.3953; train_gene_expr_recon_loss: 9717956.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20288938.0186; train_optim_loss: 20288938.0186; val_kl_reg_loss: 177611.9062; val_edge_recon_loss: 11955850.7083; val_gene_expr_recon_loss: 9498950.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21632412.7500; val_optim_loss: 21632412.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8643; val_auprc_score: 0.9675; val_best_acc_score: 0.8904; val_best_f1_score: 0.9380; train_kl_reg_loss: 151941.8378; train_edge_recon_loss: 10160916.3419; train_gene_expr_recon_loss: 9380648.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19693506.4372; train_optim_loss: 19693506.4372; val_kl_reg_loss: 90979.0599; val_edge_recon_loss: 10585919.5417; val_gene_expr_recon_loss: 9268087.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19944986.0000; val_optim_loss: 19944986.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8535; val_auprc_score: 0.9662; val_best_acc_score: 0.8888; val_best_f1_score: 0.9379; train_kl_reg_loss: 126725.3630; train_edge_recon_loss: 9267900.9605; train_gene_expr_recon_loss: 9178668.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18573295.0791; train_optim_loss: 18573295.0791; val_kl_reg_loss: 166078.8112; val_edge_recon_loss: 9181009.6042; val_gene_expr_recon_loss: 9007622.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18354710.4167; val_optim_loss: 18354710.4167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8488; val_auprc_score: 0.9646; val_best_acc_score: 0.8947; val_best_f1_score: 0.9410; train_kl_reg_loss: 185097.8423; train_edge_recon_loss: 8750020.5488; train_gene_expr_recon_loss: 8902393.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17837511.6279; train_optim_loss: 17837511.6279; val_kl_reg_loss: 177066.9531; val_edge_recon_loss: 8950066.3542; val_gene_expr_recon_loss: 8758801.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17885935.1667; val_optim_loss: 17885935.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8643; val_auprc_score: 0.9690; val_best_acc_score: 0.9084; val_best_f1_score: 0.9481; train_kl_reg_loss: 175525.4927; train_edge_recon_loss: 8594006.0605; train_gene_expr_recon_loss: 8685242.4233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17454773.8884; train_optim_loss: 17454773.8884; val_kl_reg_loss: 168579.2754; val_edge_recon_loss: 8571763.3333; val_gene_expr_recon_loss: 8556283.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17296625.6667; val_optim_loss: 17296625.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8817; val_auprc_score: 0.9731; val_best_acc_score: 0.9096; val_best_f1_score: 0.9488; train_kl_reg_loss: 164100.1674; train_edge_recon_loss: 8387276.3140; train_gene_expr_recon_loss: 8491274.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17042651.2558; train_optim_loss: 17042651.2558; val_kl_reg_loss: 152301.9531; val_edge_recon_loss: 8521441.6042; val_gene_expr_recon_loss: 8379042.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17052786.2500; val_optim_loss: 17052786.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8835; val_auprc_score: 0.9726; val_best_acc_score: 0.9080; val_best_f1_score: 0.9480; train_kl_reg_loss: 155123.1842; train_edge_recon_loss: 8297814.5256; train_gene_expr_recon_loss: 8337260.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16790197.8000; train_optim_loss: 16790197.8000; val_kl_reg_loss: 152560.2148; val_edge_recon_loss: 8601100.1250; val_gene_expr_recon_loss: 8230003.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16983664.2083; val_optim_loss: 16983664.2083
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9087; val_auprc_score: 0.9802; val_best_acc_score: 0.9207; val_best_f1_score: 0.9547; train_kl_reg_loss: 137935.2924; train_edge_recon_loss: 8250885.4279; train_gene_expr_recon_loss: 8199562.6767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16588383.3628; train_optim_loss: 16588383.3628; val_kl_reg_loss: 130515.3337; val_edge_recon_loss: 8097346.3750; val_gene_expr_recon_loss: 8103793.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16331655.4167; val_optim_loss: 16331655.4167
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9080; val_auprc_score: 0.9794; val_best_acc_score: 0.9229; val_best_f1_score: 0.9559; train_kl_reg_loss: 135364.0589; train_edge_recon_loss: 8136753.1442; train_gene_expr_recon_loss: 8069806.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16341923.5674; train_optim_loss: 16341923.5674; val_kl_reg_loss: 126988.8867; val_edge_recon_loss: 8132165.7708; val_gene_expr_recon_loss: 7980929.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16240084.1667; val_optim_loss: 16240084.1667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9173; val_auprc_score: 0.9815; val_best_acc_score: 0.9229; val_best_f1_score: 0.9556; train_kl_reg_loss: 123952.5561; train_edge_recon_loss: 8006314.2000; train_gene_expr_recon_loss: 7958311.8256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16088578.5860; train_optim_loss: 16088578.5860; val_kl_reg_loss: 119907.7064; val_edge_recon_loss: 8147877.4167; val_gene_expr_recon_loss: 7880584.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16148369.8333; val_optim_loss: 16148369.8333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9214; val_auprc_score: 0.9824; val_best_acc_score: 0.9221; val_best_f1_score: 0.9553; train_kl_reg_loss: 113041.9393; train_edge_recon_loss: 8122527.3372; train_gene_expr_recon_loss: 7859623.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16095192.4558; train_optim_loss: 16095192.4558; val_kl_reg_loss: 103254.1927; val_edge_recon_loss: 8217838.3958; val_gene_expr_recon_loss: 7782708.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16103800.5000; val_optim_loss: 16103800.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9268; val_auprc_score: 0.9840; val_best_acc_score: 0.9221; val_best_f1_score: 0.9552; train_kl_reg_loss: 101151.9662; train_edge_recon_loss: 8003320.9256; train_gene_expr_recon_loss: 7766226.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15870699.6326; train_optim_loss: 15870699.6326; val_kl_reg_loss: 94538.6172; val_edge_recon_loss: 8198065.3125; val_gene_expr_recon_loss: 7695253.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15987857.3750; val_optim_loss: 15987857.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9285; val_auprc_score: 0.9850; val_best_acc_score: 0.9232; val_best_f1_score: 0.9560; train_kl_reg_loss: 92021.4272; train_edge_recon_loss: 7932544.4256; train_gene_expr_recon_loss: 7685775.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15710340.9767; train_optim_loss: 15710340.9767; val_kl_reg_loss: 85574.9193; val_edge_recon_loss: 7866573.4583; val_gene_expr_recon_loss: 7621978.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15574126.9583; val_optim_loss: 15574126.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9282; val_auprc_score: 0.9837; val_best_acc_score: 0.9248; val_best_f1_score: 0.9564; train_kl_reg_loss: 79928.5525; train_edge_recon_loss: 7883211.7930; train_gene_expr_recon_loss: 7611133.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15574273.9674; train_optim_loss: 15574273.9674; val_kl_reg_loss: 71349.7188; val_edge_recon_loss: 8114443.0208; val_gene_expr_recon_loss: 7549644.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15735436.7083; val_optim_loss: 15735436.7083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9359; val_auprc_score: 0.9860; val_best_acc_score: 0.9274; val_best_f1_score: 0.9581; train_kl_reg_loss: 71261.6413; train_edge_recon_loss: 7876803.4651; train_gene_expr_recon_loss: 7546450.8930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15494516.0512; train_optim_loss: 15494516.0512; val_kl_reg_loss: 62676.0811; val_edge_recon_loss: 8094202.3750; val_gene_expr_recon_loss: 7500472.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15657350.8750; val_optim_loss: 15657350.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9351; val_auprc_score: 0.9842; val_best_acc_score: 0.9294; val_best_f1_score: 0.9596; train_kl_reg_loss: 64046.8206; train_edge_recon_loss: 7876771.2047; train_gene_expr_recon_loss: 7484089.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15424907.3953; train_optim_loss: 15424907.3953; val_kl_reg_loss: 60097.7907; val_edge_recon_loss: 7995945.5833; val_gene_expr_recon_loss: 7432155.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15488199.1667; val_optim_loss: 15488199.1667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9384; val_auprc_score: 0.9862; val_best_acc_score: 0.9303; val_best_f1_score: 0.9595; train_kl_reg_loss: 59014.5355; train_edge_recon_loss: 7837581.8140; train_gene_expr_recon_loss: 7426810.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15323406.5721; train_optim_loss: 15323406.5721; val_kl_reg_loss: 53395.3216; val_edge_recon_loss: 8160765.0417; val_gene_expr_recon_loss: 7378521.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15592682.2500; val_optim_loss: 15592682.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9467; val_auprc_score: 0.9878; val_best_acc_score: 0.9342; val_best_f1_score: 0.9619; train_kl_reg_loss: 52774.6613; train_edge_recon_loss: 7815203.5744; train_gene_expr_recon_loss: 7376412.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15244390.9209; train_optim_loss: 15244390.9209; val_kl_reg_loss: 51000.3377; val_edge_recon_loss: 7885182.2500; val_gene_expr_recon_loss: 7328459.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15264642.2083; val_optim_loss: 15264642.2083
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9458; val_auprc_score: 0.9870; val_best_acc_score: 0.9344; val_best_f1_score: 0.9617; train_kl_reg_loss: 49863.1640; train_edge_recon_loss: 7867704.9279; train_gene_expr_recon_loss: 7331501.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15249069.1209; train_optim_loss: 15249069.1209; val_kl_reg_loss: 47191.1761; val_edge_recon_loss: 8141494.3333; val_gene_expr_recon_loss: 7274453.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15463139.5000; val_optim_loss: 15463139.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9475; val_auprc_score: 0.9871; val_best_acc_score: 0.9381; val_best_f1_score: 0.9639; train_kl_reg_loss: 47089.9791; train_edge_recon_loss: 7907162.5953; train_gene_expr_recon_loss: 7285942.5535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15240195.1302; train_optim_loss: 15240195.1302; val_kl_reg_loss: 42251.6554; val_edge_recon_loss: 8235662.2500; val_gene_expr_recon_loss: 7243485.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15521399.5000; val_optim_loss: 15521399.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9530; val_auprc_score: 0.9889; val_best_acc_score: 0.9437; val_best_f1_score: 0.9675; train_kl_reg_loss: 43669.5580; train_edge_recon_loss: 7774074.9186; train_gene_expr_recon_loss: 7249163.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15066908.4000; train_optim_loss: 15066908.4000; val_kl_reg_loss: 41459.8372; val_edge_recon_loss: 7906461.8333; val_gene_expr_recon_loss: 7198388.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15146310.5000; val_optim_loss: 15146310.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9560; val_auprc_score: 0.9901; val_best_acc_score: 0.9420; val_best_f1_score: 0.9661; train_kl_reg_loss: 42072.5963; train_edge_recon_loss: 7625366.5233; train_gene_expr_recon_loss: 7208587.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14876026.2930; train_optim_loss: 14876026.2930; val_kl_reg_loss: 40002.2090; val_edge_recon_loss: 8088504.7708; val_gene_expr_recon_loss: 7158976.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15287483.4167; val_optim_loss: 15287483.4167
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9594; val_auprc_score: 0.9913; val_best_acc_score: 0.9467; val_best_f1_score: 0.9691; train_kl_reg_loss: 39952.2047; train_edge_recon_loss: 7690687.9070; train_gene_expr_recon_loss: 7177736.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14908376.9721; train_optim_loss: 14908376.9721; val_kl_reg_loss: 35965.7900; val_edge_recon_loss: 7788115.8958; val_gene_expr_recon_loss: 7128603.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14952685.5000; val_optim_loss: 14952685.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9520; val_auprc_score: 0.9890; val_best_acc_score: 0.9456; val_best_f1_score: 0.9685; train_kl_reg_loss: 37393.7252; train_edge_recon_loss: 7685793.1953; train_gene_expr_recon_loss: 7150455.4116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14873642.3581; train_optim_loss: 14873642.3581; val_kl_reg_loss: 36048.2655; val_edge_recon_loss: 7867156.0000; val_gene_expr_recon_loss: 7102791.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15005995.9167; val_optim_loss: 15005995.9167
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9560; val_auprc_score: 0.9900; val_best_acc_score: 0.9495; val_best_f1_score: 0.9708; train_kl_reg_loss: 37119.5867; train_edge_recon_loss: 7755895.0837; train_gene_expr_recon_loss: 7122623.6186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14915638.3116; train_optim_loss: 14915638.3116; val_kl_reg_loss: 36356.1660; val_edge_recon_loss: 7747773.1042; val_gene_expr_recon_loss: 7077356.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14861485.4167; val_optim_loss: 14861485.4167
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9589; val_auprc_score: 0.9901; val_best_acc_score: 0.9517; val_best_f1_score: 0.9721; train_kl_reg_loss: 36495.9041; train_edge_recon_loss: 7725104.5488; train_gene_expr_recon_loss: 7103660.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14865261.2326; train_optim_loss: 14865261.2326; val_kl_reg_loss: 37568.4396; val_edge_recon_loss: 7598236.1875; val_gene_expr_recon_loss: 7067539.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14703343.6250; val_optim_loss: 14703343.6250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9589; val_auprc_score: 0.9899; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 36500.9217; train_edge_recon_loss: 7644216.5349; train_gene_expr_recon_loss: 7079944.0163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14760661.4512; train_optim_loss: 14760661.4512; val_kl_reg_loss: 34298.9797; val_edge_recon_loss: 7693267.4792; val_gene_expr_recon_loss: 7052640.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14780206.8750; val_optim_loss: 14780206.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9605; val_auprc_score: 0.9904; val_best_acc_score: 0.9502; val_best_f1_score: 0.9711; train_kl_reg_loss: 35189.8042; train_edge_recon_loss: 7676376.7023; train_gene_expr_recon_loss: 7060567.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14772134.3116; train_optim_loss: 14772134.3116; val_kl_reg_loss: 33511.5031; val_edge_recon_loss: 8039791.0625; val_gene_expr_recon_loss: 7022460.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15095763.1250; val_optim_loss: 15095763.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9626; val_auprc_score: 0.9916; val_best_acc_score: 0.9546; val_best_f1_score: 0.9736; train_kl_reg_loss: 34616.5414; train_edge_recon_loss: 7681905.3512; train_gene_expr_recon_loss: 7039461.3651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14755983.2512; train_optim_loss: 14755983.2512; val_kl_reg_loss: 33867.2292; val_edge_recon_loss: 7866619.8958; val_gene_expr_recon_loss: 7006100.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14906587.2500; val_optim_loss: 14906587.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9670; val_auprc_score: 0.9921; val_best_acc_score: 0.9553; val_best_f1_score: 0.9739; train_kl_reg_loss: 33580.7535; train_edge_recon_loss: 7674602.1186; train_gene_expr_recon_loss: 7022507.9116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14730690.7860; train_optim_loss: 14730690.7860; val_kl_reg_loss: 33911.9185; val_edge_recon_loss: 7959876.8542; val_gene_expr_recon_loss: 6995478.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14989267.0833; val_optim_loss: 14989267.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9614; val_auprc_score: 0.9911; val_best_acc_score: 0.9551; val_best_f1_score: 0.9739; train_kl_reg_loss: 34167.5048; train_edge_recon_loss: 7674220.1279; train_gene_expr_recon_loss: 6984184.9209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14692572.5628; train_optim_loss: 14692572.5628; val_kl_reg_loss: 32752.3887; val_edge_recon_loss: 7724865.7292; val_gene_expr_recon_loss: 6956016.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14713634.8750; val_optim_loss: 14713634.8750
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9638; val_auprc_score: 0.9912; val_best_acc_score: 0.9553; val_best_f1_score: 0.9739; train_kl_reg_loss: 33678.5294; train_edge_recon_loss: 7660130.2930; train_gene_expr_recon_loss: 6979086.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14672895.5349; train_optim_loss: 14672895.5349; val_kl_reg_loss: 33189.7725; val_edge_recon_loss: 7924352.2708; val_gene_expr_recon_loss: 6952712.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14910254.1250; val_optim_loss: 14910254.1250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9595; val_auprc_score: 0.9902; val_best_acc_score: 0.9551; val_best_f1_score: 0.9739; train_kl_reg_loss: 33627.5930; train_edge_recon_loss: 7588452.7326; train_gene_expr_recon_loss: 6975799.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14597880.2744; train_optim_loss: 14597880.2744; val_kl_reg_loss: 33275.5728; val_edge_recon_loss: 7825364.1042; val_gene_expr_recon_loss: 6952136.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14810776.2917; val_optim_loss: 14810776.2917
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9633; val_auprc_score: 0.9905; val_best_acc_score: 0.9542; val_best_f1_score: 0.9733; train_kl_reg_loss: 33278.2620; train_edge_recon_loss: 7614307.1465; train_gene_expr_recon_loss: 6976354.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14623939.7488; train_optim_loss: 14623939.7488; val_kl_reg_loss: 32753.0776; val_edge_recon_loss: 7818895.1667; val_gene_expr_recon_loss: 6953833.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14805481.3750; val_optim_loss: 14805481.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 47 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9609
Val AUPRC score: 0.9913
Val best accuracy score: 0.9534
Val best F1 score: 0.9731
Val gene expr MSE score: 53948.6876
Val cat covariate0 mean sim diff: -0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
