[True]
Run timestamp: 10082023_201844_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7787; val_auprc_score: 0.8003; val_best_acc_score: 0.5342; val_best_f1_score: 0.6795; train_kl_reg_loss: 216725.5983; train_edge_recon_loss: 3840031.9141; train_gene_expr_recon_loss: 29466090.6412; train_masked_gp_l1_reg_loss: 82301.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244068.1014; train_chrom_access_recon_loss: 76852933.8015; train_global_loss: 110702151.5115; train_optim_loss: 110702151.5115; val_kl_reg_loss: 159643.5156; val_edge_recon_loss: 4062768.9833; val_gene_expr_recon_loss: 23531940.6667; val_masked_gp_l1_reg_loss: 79644.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239537.7500; val_chrom_access_recon_loss: 69757210.6667; val_global_loss: 97830745.6000; val_optim_loss: 97830745.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7863; val_auprc_score: 0.8106; val_best_acc_score: 0.6501; val_best_f1_score: 0.7171; train_kl_reg_loss: 195732.9816; train_edge_recon_loss: 3715578.6145; train_gene_expr_recon_loss: 22857182.3359; train_masked_gp_l1_reg_loss: 75642.2197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232827.7049; train_chrom_access_recon_loss: 69481833.3130; train_global_loss: 96558797.2519; train_optim_loss: 96558797.2519; val_kl_reg_loss: 227014.9031; val_edge_recon_loss: 4055010.3500; val_gene_expr_recon_loss: 22501670.2667; val_masked_gp_l1_reg_loss: 73478.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225256.7344; val_chrom_access_recon_loss: 68905200.5333; val_global_loss: 95987630.4000; val_optim_loss: 95987630.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8714; val_auprc_score: 0.8686; val_best_acc_score: 0.7875; val_best_f1_score: 0.7941; train_kl_reg_loss: 190254.9449; train_edge_recon_loss: 3582314.9733; train_gene_expr_recon_loss: 22310219.2519; train_masked_gp_l1_reg_loss: 73467.2476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217148.5918; train_chrom_access_recon_loss: 68956356.9466; train_global_loss: 95329762.0153; train_optim_loss: 95329762.0153; val_kl_reg_loss: 167547.2052; val_edge_recon_loss: 3786032.3833; val_gene_expr_recon_loss: 22157153.3333; val_masked_gp_l1_reg_loss: 74710.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208860.4062; val_chrom_access_recon_loss: 68249706.1333; val_global_loss: 94644007.4667; val_optim_loss: 94644007.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8819; val_auprc_score: 0.8713; val_best_acc_score: 0.7975; val_best_f1_score: 0.8167; train_kl_reg_loss: 184363.0037; train_edge_recon_loss: 3209619.6794; train_gene_expr_recon_loss: 22064981.0840; train_masked_gp_l1_reg_loss: 76257.7340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200746.3022; train_chrom_access_recon_loss: 68405641.5267; train_global_loss: 94141609.1603; train_optim_loss: 94141609.1603; val_kl_reg_loss: 204906.3010; val_edge_recon_loss: 3072620.6000; val_gene_expr_recon_loss: 21933114.9333; val_masked_gp_l1_reg_loss: 77176.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192650.9062; val_chrom_access_recon_loss: 67698147.7333; val_global_loss: 93178616.5333; val_optim_loss: 93178616.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8975; val_auprc_score: 0.8834; val_best_acc_score: 0.8181; val_best_f1_score: 0.8353; train_kl_reg_loss: 203925.2170; train_edge_recon_loss: 3017544.9714; train_gene_expr_recon_loss: 21925860.7023; train_masked_gp_l1_reg_loss: 78088.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185052.5256; train_chrom_access_recon_loss: 68053873.2824; train_global_loss: 93464345.0992; train_optim_loss: 93464345.0992; val_kl_reg_loss: 211686.6156; val_edge_recon_loss: 2970086.8667; val_gene_expr_recon_loss: 21865843.3333; val_masked_gp_l1_reg_loss: 79061.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177625.4688; val_chrom_access_recon_loss: 67554933.0667; val_global_loss: 92859237.3333; val_optim_loss: 92859237.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9082; val_auprc_score: 0.8962; val_best_acc_score: 0.8305; val_best_f1_score: 0.8433; train_kl_reg_loss: 195658.4247; train_edge_recon_loss: 2967456.3836; train_gene_expr_recon_loss: 21756006.9008; train_masked_gp_l1_reg_loss: 79906.5567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170905.8350; train_chrom_access_recon_loss: 67582931.3282; train_global_loss: 92752865.1603; train_optim_loss: 92752865.1603; val_kl_reg_loss: 189682.5229; val_edge_recon_loss: 2947931.0167; val_gene_expr_recon_loss: 21597597.2000; val_masked_gp_l1_reg_loss: 80777.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164415.9219; val_chrom_access_recon_loss: 66933800.0000; val_global_loss: 91914204.8000; val_optim_loss: 91914204.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9212; val_auprc_score: 0.9106; val_best_acc_score: 0.8441; val_best_f1_score: 0.8566; train_kl_reg_loss: 189948.2195; train_edge_recon_loss: 2916679.3321; train_gene_expr_recon_loss: 21611410.6107; train_masked_gp_l1_reg_loss: 81738.4661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158439.4059; train_chrom_access_recon_loss: 67195864.4885; train_global_loss: 92154080.4275; train_optim_loss: 92154080.4275; val_kl_reg_loss: 184771.3750; val_edge_recon_loss: 2911149.2833; val_gene_expr_recon_loss: 21549709.4667; val_masked_gp_l1_reg_loss: 82553.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152621.4844; val_chrom_access_recon_loss: 66524486.1333; val_global_loss: 91405291.7333; val_optim_loss: 91405291.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9323; val_auprc_score: 0.9174; val_best_acc_score: 0.8623; val_best_f1_score: 0.8699; train_kl_reg_loss: 185892.7935; train_edge_recon_loss: 2889231.1431; train_gene_expr_recon_loss: 21523623.9847; train_masked_gp_l1_reg_loss: 83608.6268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147328.0829; train_chrom_access_recon_loss: 66966038.1985; train_global_loss: 91795722.8092; train_optim_loss: 91795722.8092; val_kl_reg_loss: 184797.8198; val_edge_recon_loss: 2885439.5333; val_gene_expr_recon_loss: 21439061.0667; val_masked_gp_l1_reg_loss: 84576.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142121.6562; val_chrom_access_recon_loss: 66260446.1333; val_global_loss: 90996442.1333; val_optim_loss: 90996442.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9419; val_auprc_score: 0.9291; val_best_acc_score: 0.8715; val_best_f1_score: 0.8799; train_kl_reg_loss: 179444.8385; train_edge_recon_loss: 2869971.5420; train_gene_expr_recon_loss: 21405435.4962; train_masked_gp_l1_reg_loss: 85533.8325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137440.9142; train_chrom_access_recon_loss: 66587117.4351; train_global_loss: 91264944.1832; train_optim_loss: 91264944.1832; val_kl_reg_loss: 176464.5719; val_edge_recon_loss: 2860728.7333; val_gene_expr_recon_loss: 21392954.9333; val_masked_gp_l1_reg_loss: 86279.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132866.0938; val_chrom_access_recon_loss: 66311927.7333; val_global_loss: 90961221.8667; val_optim_loss: 90961221.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9411; val_auprc_score: 0.9261; val_best_acc_score: 0.8736; val_best_f1_score: 0.8810; train_kl_reg_loss: 175825.2166; train_edge_recon_loss: 2845952.1775; train_gene_expr_recon_loss: 21312028.3053; train_masked_gp_l1_reg_loss: 87462.7396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128595.7846; train_chrom_access_recon_loss: 66264528.5802; train_global_loss: 90814392.6718; train_optim_loss: 90814392.6718; val_kl_reg_loss: 172088.3146; val_edge_recon_loss: 2862170.6000; val_gene_expr_recon_loss: 21243408.8000; val_masked_gp_l1_reg_loss: 88334.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124424.7812; val_chrom_access_recon_loss: 65466758.4000; val_global_loss: 89957184.5333; val_optim_loss: 89957184.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9504; val_auprc_score: 0.9415; val_best_acc_score: 0.8870; val_best_f1_score: 0.8909; train_kl_reg_loss: 171831.4307; train_edge_recon_loss: 2824626.7481; train_gene_expr_recon_loss: 21227768.1985; train_masked_gp_l1_reg_loss: 89276.8062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120678.7433; train_chrom_access_recon_loss: 65985344.5496; train_global_loss: 90419526.2901; train_optim_loss: 90419526.2901; val_kl_reg_loss: 168869.8135; val_edge_recon_loss: 2830640.5833; val_gene_expr_recon_loss: 21236776.5333; val_masked_gp_l1_reg_loss: 90158.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117031.5156; val_chrom_access_recon_loss: 66045115.4667; val_global_loss: 90488592.0000; val_optim_loss: 90488592.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9486; val_auprc_score: 0.9366; val_best_acc_score: 0.8863; val_best_f1_score: 0.8930; train_kl_reg_loss: 166819.1573; train_edge_recon_loss: 2818572.4313; train_gene_expr_recon_loss: 21176714.9313; train_masked_gp_l1_reg_loss: 91129.2928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113791.3800; train_chrom_access_recon_loss: 65884038.3206; train_global_loss: 90251065.7099; train_optim_loss: 90251065.7099; val_kl_reg_loss: 167403.5792; val_edge_recon_loss: 2816326.1500; val_gene_expr_recon_loss: 21205648.2667; val_masked_gp_l1_reg_loss: 91968.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110628.4062; val_chrom_access_recon_loss: 65691396.5333; val_global_loss: 90083370.1333; val_optim_loss: 90083370.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9484; val_auprc_score: 0.9363; val_best_acc_score: 0.8844; val_best_f1_score: 0.8904; train_kl_reg_loss: 163121.7213; train_edge_recon_loss: 2806174.7710; train_gene_expr_recon_loss: 21118764.1374; train_masked_gp_l1_reg_loss: 92708.7166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107730.7709; train_chrom_access_recon_loss: 65709332.0000; train_global_loss: 89997831.8779; train_optim_loss: 89997831.8779; val_kl_reg_loss: 157546.4990; val_edge_recon_loss: 2833214.5333; val_gene_expr_recon_loss: 21090347.7333; val_masked_gp_l1_reg_loss: 93650.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104973.4531; val_chrom_access_recon_loss: 65303541.6000; val_global_loss: 89583275.2000; val_optim_loss: 89583275.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9527; val_auprc_score: 0.9430; val_best_acc_score: 0.8901; val_best_f1_score: 0.8955; train_kl_reg_loss: 159102.2458; train_edge_recon_loss: 2795859.8302; train_gene_expr_recon_loss: 21080154.3969; train_masked_gp_l1_reg_loss: 94296.6205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102464.4260; train_chrom_access_recon_loss: 65622146.9924; train_global_loss: 89854024.7939; train_optim_loss: 89854024.7939; val_kl_reg_loss: 156896.2146; val_edge_recon_loss: 2791715.5667; val_gene_expr_recon_loss: 20950004.1333; val_masked_gp_l1_reg_loss: 95202.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99985.6406; val_chrom_access_recon_loss: 64844594.4000; val_global_loss: 88938397.8667; val_optim_loss: 88938397.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9567; val_auprc_score: 0.9469; val_best_acc_score: 0.8956; val_best_f1_score: 0.9003; train_kl_reg_loss: 156420.7815; train_edge_recon_loss: 2789928.3092; train_gene_expr_recon_loss: 20976821.9084; train_masked_gp_l1_reg_loss: 95952.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97861.0776; train_chrom_access_recon_loss: 65210225.6489; train_global_loss: 89327209.9542; train_optim_loss: 89327209.9542; val_kl_reg_loss: 153856.9156; val_edge_recon_loss: 2786999.7000; val_gene_expr_recon_loss: 20893161.4667; val_masked_gp_l1_reg_loss: 96854.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95847.9766; val_chrom_access_recon_loss: 64554951.4667; val_global_loss: 88581672.0000; val_optim_loss: 88581672.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9546; val_auprc_score: 0.9446; val_best_acc_score: 0.8922; val_best_f1_score: 0.8966; train_kl_reg_loss: 151856.3719; train_edge_recon_loss: 2787148.9504; train_gene_expr_recon_loss: 20980767.2519; train_masked_gp_l1_reg_loss: 97614.4518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93982.3644; train_chrom_access_recon_loss: 65232540.7328; train_global_loss: 89343910.0458; train_optim_loss: 89343910.0458; val_kl_reg_loss: 153163.8646; val_edge_recon_loss: 2819692.6667; val_gene_expr_recon_loss: 20930228.1333; val_masked_gp_l1_reg_loss: 98409.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92191.3359; val_chrom_access_recon_loss: 64583419.4667; val_global_loss: 88677105.0667; val_optim_loss: 88677105.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9648; val_auprc_score: 0.9576; val_best_acc_score: 0.9088; val_best_f1_score: 0.9125; train_kl_reg_loss: 150063.2734; train_edge_recon_loss: 2775624.4370; train_gene_expr_recon_loss: 20885017.8473; train_masked_gp_l1_reg_loss: 99044.6074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90555.4947; train_chrom_access_recon_loss: 64902462.4733; train_global_loss: 88902768.2443; train_optim_loss: 88902768.2443; val_kl_reg_loss: 146661.5094; val_edge_recon_loss: 2754498.2833; val_gene_expr_recon_loss: 20901356.6667; val_masked_gp_l1_reg_loss: 99857.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88889.8516; val_chrom_access_recon_loss: 64525652.8000; val_global_loss: 88516917.3333; val_optim_loss: 88516917.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9613; val_auprc_score: 0.9524; val_best_acc_score: 0.9014; val_best_f1_score: 0.9056; train_kl_reg_loss: 146355.1634; train_edge_recon_loss: 2777202.5000; train_gene_expr_recon_loss: 20869849.9084; train_masked_gp_l1_reg_loss: 100714.5766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87318.8575; train_chrom_access_recon_loss: 64893903.7557; train_global_loss: 88875344.6107; train_optim_loss: 88875344.6107; val_kl_reg_loss: 144361.3500; val_edge_recon_loss: 2785418.1000; val_gene_expr_recon_loss: 20817013.3333; val_masked_gp_l1_reg_loss: 101492.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85669.1094; val_chrom_access_recon_loss: 64365244.5333; val_global_loss: 88299198.9333; val_optim_loss: 88299198.9333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9656; val_auprc_score: 0.9597; val_best_acc_score: 0.9088; val_best_f1_score: 0.9124; train_kl_reg_loss: 144459.8833; train_edge_recon_loss: 2765478.5076; train_gene_expr_recon_loss: 20850959.0992; train_masked_gp_l1_reg_loss: 102248.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84172.7585; train_chrom_access_recon_loss: 64856554.6565; train_global_loss: 88803873.2824; train_optim_loss: 88803873.2824; val_kl_reg_loss: 140199.3927; val_edge_recon_loss: 2759464.5500; val_gene_expr_recon_loss: 20878431.8667; val_masked_gp_l1_reg_loss: 103029.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82610.2812; val_chrom_access_recon_loss: 64351988.2667; val_global_loss: 88315723.7333; val_optim_loss: 88315723.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9641; val_auprc_score: 0.9571; val_best_acc_score: 0.9084; val_best_f1_score: 0.9121; train_kl_reg_loss: 141195.5014; train_edge_recon_loss: 2768140.1927; train_gene_expr_recon_loss: 20805934.4427; train_masked_gp_l1_reg_loss: 103762.5775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81239.3968; train_chrom_access_recon_loss: 64680145.6183; train_global_loss: 88580417.7099; train_optim_loss: 88580417.7099; val_kl_reg_loss: 140527.7469; val_edge_recon_loss: 2769215.1500; val_gene_expr_recon_loss: 20794399.7333; val_masked_gp_l1_reg_loss: 104515.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79955.1875; val_chrom_access_recon_loss: 64231149.8667; val_global_loss: 88119764.2667; val_optim_loss: 88119764.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9674; val_auprc_score: 0.9615; val_best_acc_score: 0.9117; val_best_f1_score: 0.9143; train_kl_reg_loss: 139526.8276; train_edge_recon_loss: 2757803.2080; train_gene_expr_recon_loss: 20747499.1145; train_masked_gp_l1_reg_loss: 105342.9070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78610.7167; train_chrom_access_recon_loss: 64482573.6489; train_global_loss: 88311356.7634; train_optim_loss: 88311356.7634; val_kl_reg_loss: 140817.4844; val_edge_recon_loss: 2773366.4167; val_gene_expr_recon_loss: 20771934.0000; val_masked_gp_l1_reg_loss: 105927.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77364.3594; val_chrom_access_recon_loss: 64277186.6667; val_global_loss: 88146596.8000; val_optim_loss: 88146596.8000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9694; val_auprc_score: 0.9609; val_best_acc_score: 0.9151; val_best_f1_score: 0.9188; train_kl_reg_loss: 137253.9870; train_edge_recon_loss: 2761543.0897; train_gene_expr_recon_loss: 20716168.4275; train_masked_gp_l1_reg_loss: 106813.0569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76235.6117; train_chrom_access_recon_loss: 64382094.6260; train_global_loss: 88180108.6412; train_optim_loss: 88180108.6412; val_kl_reg_loss: 134448.2885; val_edge_recon_loss: 2761380.3500; val_gene_expr_recon_loss: 20703714.6667; val_masked_gp_l1_reg_loss: 107465.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75004.4766; val_chrom_access_recon_loss: 63928673.3333; val_global_loss: 87710686.4000; val_optim_loss: 87710686.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9699; val_auprc_score: 0.9640; val_best_acc_score: 0.9188; val_best_f1_score: 0.9215; train_kl_reg_loss: 136450.1240; train_edge_recon_loss: 2754377.7691; train_gene_expr_recon_loss: 20723444.1221; train_masked_gp_l1_reg_loss: 109040.8767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74036.1169; train_chrom_access_recon_loss: 64461575.4198; train_global_loss: 88258924.5802; train_optim_loss: 88258924.5802; val_kl_reg_loss: 137268.0500; val_edge_recon_loss: 2765221.7667; val_gene_expr_recon_loss: 20666042.4000; val_masked_gp_l1_reg_loss: 110702.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73139.7188; val_chrom_access_recon_loss: 63795295.2000; val_global_loss: 87547668.8000; val_optim_loss: 87547668.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9689; val_auprc_score: 0.9617; val_best_acc_score: 0.9161; val_best_f1_score: 0.9188; train_kl_reg_loss: 133579.9742; train_edge_recon_loss: 2749143.0935; train_gene_expr_recon_loss: 20698727.9389; train_masked_gp_l1_reg_loss: 113562.5051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72175.8797; train_chrom_access_recon_loss: 64340054.0458; train_global_loss: 88107243.4809; train_optim_loss: 88107243.4809; val_kl_reg_loss: 132399.1724; val_edge_recon_loss: 2766128.9333; val_gene_expr_recon_loss: 20748764.8000; val_masked_gp_l1_reg_loss: 117054.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71173.4453; val_chrom_access_recon_loss: 64360292.5333; val_global_loss: 88195813.3333; val_optim_loss: 88195813.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9708; val_auprc_score: 0.9651; val_best_acc_score: 0.9190; val_best_f1_score: 0.9226; train_kl_reg_loss: 132581.7873; train_edge_recon_loss: 2754042.9828; train_gene_expr_recon_loss: 20660823.0992; train_masked_gp_l1_reg_loss: 116952.3988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70324.3795; train_chrom_access_recon_loss: 64159249.5267; train_global_loss: 87893974.2901; train_optim_loss: 87893974.2901; val_kl_reg_loss: 133515.8339; val_edge_recon_loss: 2781813.6500; val_gene_expr_recon_loss: 20638171.4667; val_masked_gp_l1_reg_loss: 117001.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69388.5547; val_chrom_access_recon_loss: 63725060.0000; val_global_loss: 87464950.9333; val_optim_loss: 87464950.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9464; val_auprc_score: 0.9315; val_best_acc_score: 0.8836; val_best_f1_score: 0.8900; train_kl_reg_loss: 149979.5891; train_edge_recon_loss: 2910906.8130; train_gene_expr_recon_loss: 24652451.9084; train_masked_gp_l1_reg_loss: 115707.1558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75014.8684; train_chrom_access_recon_loss: 67202567.7557; train_global_loss: 95106628.3359; train_optim_loss: 95106628.3359; val_kl_reg_loss: 15724.6111; val_edge_recon_loss: 2805246.8333; val_gene_expr_recon_loss: 25162475.0667; val_masked_gp_l1_reg_loss: 113455.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76183.7500; val_chrom_access_recon_loss: 67219636.5333; val_global_loss: 95392722.6667; val_optim_loss: 95392722.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9449; val_auprc_score: 0.9267; val_best_acc_score: 0.8866; val_best_f1_score: 0.8932; train_kl_reg_loss: 79052.0850; train_edge_recon_loss: 2734958.1927; train_gene_expr_recon_loss: 24803111.0076; train_masked_gp_l1_reg_loss: 109700.0648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73656.0216; train_chrom_access_recon_loss: 67275890.9008; train_global_loss: 95076368.5496; train_optim_loss: 95076368.5496; val_kl_reg_loss: 22457.2145; val_edge_recon_loss: 2736030.3000; val_gene_expr_recon_loss: 24462774.9333; val_masked_gp_l1_reg_loss: 105854.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71202.4609; val_chrom_access_recon_loss: 66178481.0667; val_global_loss: 93576799.4667; val_optim_loss: 93576799.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9508; val_auprc_score: 0.9323; val_best_acc_score: 0.9004; val_best_f1_score: 0.9051; train_kl_reg_loss: 53545.6545; train_edge_recon_loss: 2706574.2786; train_gene_expr_recon_loss: 24376563.5725; train_masked_gp_l1_reg_loss: 102251.9825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69138.7932; train_chrom_access_recon_loss: 67128749.1603; train_global_loss: 94436823.3893; train_optim_loss: 94436823.3893; val_kl_reg_loss: 26759.2251; val_edge_recon_loss: 2684629.1667; val_gene_expr_recon_loss: 24136420.6667; val_masked_gp_l1_reg_loss: 98712.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67146.2656; val_chrom_access_recon_loss: 66705136.8000; val_global_loss: 93718802.6667; val_optim_loss: 93718802.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9480; val_auprc_score: 0.9275; val_best_acc_score: 0.8922; val_best_f1_score: 0.8983; train_kl_reg_loss: 48299.6814; train_edge_recon_loss: 2687455.3664; train_gene_expr_recon_loss: 24018351.7252; train_masked_gp_l1_reg_loss: 95497.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65492.4995; train_chrom_access_recon_loss: 66856063.6336; train_global_loss: 93771160.6718; train_optim_loss: 93771160.6718; val_kl_reg_loss: 28669.0223; val_edge_recon_loss: 2701287.3167; val_gene_expr_recon_loss: 23870541.3333; val_masked_gp_l1_reg_loss: 92279.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63838.9961; val_chrom_access_recon_loss: 66495228.2667; val_global_loss: 93251844.8000; val_optim_loss: 93251844.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9533; val_auprc_score: 0.9395; val_best_acc_score: 0.8950; val_best_f1_score: 0.9003; train_kl_reg_loss: 44373.0250; train_edge_recon_loss: 2682612.3950; train_gene_expr_recon_loss: 23840152.8397; train_masked_gp_l1_reg_loss: 91687.5708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63589.6073; train_chrom_access_recon_loss: 66634214.7786; train_global_loss: 93356630.2901; train_optim_loss: 93356630.2901; val_kl_reg_loss: 28917.6253; val_edge_recon_loss: 2702915.2500; val_gene_expr_recon_loss: 23896334.5333; val_masked_gp_l1_reg_loss: 91351.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63374.1328; val_chrom_access_recon_loss: 66626331.7333; val_global_loss: 93409224.0000; val_optim_loss: 93409224.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9530; val_auprc_score: 0.9369; val_best_acc_score: 0.8948; val_best_f1_score: 0.8996; train_kl_reg_loss: 44184.1995; train_edge_recon_loss: 2686657.6240; train_gene_expr_recon_loss: 23806254.5802; train_masked_gp_l1_reg_loss: 91026.4338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63169.1572; train_chrom_access_recon_loss: 66627507.3282; train_global_loss: 93318799.1450; train_optim_loss: 93318799.1450; val_kl_reg_loss: 29335.2457; val_edge_recon_loss: 2702519.9000; val_gene_expr_recon_loss: 23756691.6000; val_masked_gp_l1_reg_loss: 90690.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62942.7500; val_chrom_access_recon_loss: 66278815.7333; val_global_loss: 92920994.1333; val_optim_loss: 92920994.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9550; val_auprc_score: 0.9411; val_best_acc_score: 0.9014; val_best_f1_score: 0.9059; train_kl_reg_loss: 44008.9879; train_edge_recon_loss: 2685274.3950; train_gene_expr_recon_loss: 23786910.1527; train_masked_gp_l1_reg_loss: 90351.6887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62714.8607; train_chrom_access_recon_loss: 66667605.2214; train_global_loss: 93336865.2214; train_optim_loss: 93336865.2214; val_kl_reg_loss: 29698.6855; val_edge_recon_loss: 2686859.9000; val_gene_expr_recon_loss: 23706442.1333; val_masked_gp_l1_reg_loss: 90004.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62491.0508; val_chrom_access_recon_loss: 65928181.8667; val_global_loss: 92503678.9333; val_optim_loss: 92503678.9333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9535; val_auprc_score: 0.9381; val_best_acc_score: 0.8953; val_best_f1_score: 0.9007; train_kl_reg_loss: 43794.7041; train_edge_recon_loss: 2681728.1718; train_gene_expr_recon_loss: 23788488.7023; train_masked_gp_l1_reg_loss: 89652.3027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62259.8488; train_chrom_access_recon_loss: 66821994.5344; train_global_loss: 93487918.2901; train_optim_loss: 93487918.2901; val_kl_reg_loss: 29542.2904; val_edge_recon_loss: 2697196.5167; val_gene_expr_recon_loss: 23700799.0667; val_masked_gp_l1_reg_loss: 89294.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62035.5586; val_chrom_access_recon_loss: 65887723.4667; val_global_loss: 92466593.0667; val_optim_loss: 92466593.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9682
val AUPRC score: 0.9587
val best accuracy score: 0.9136
val best F1 score: 0.9159
val target rna MSE score: 2.8696
val source rna MSE score: 271.0655
val target atac MSE score: 0.1265
val source atac MSE score: 2.5512
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
