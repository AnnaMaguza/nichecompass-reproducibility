[True]
Run timestamp: 07092023_065709_288.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_288']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3385 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7888, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6175; val_auprc_score: 0.5989; val_best_acc_score: 0.5086; val_best_f1_score: 0.6699; train_kl_reg_loss: 45907.2420; train_edge_recon_loss: 3600488.6212; train_gene_expr_recon_loss: 17248654.1515; train_masked_gp_l1_reg_loss: 49493.8955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10067172.9318; train_chrom_access_recon_loss: 14956203.6212; train_global_loss: 45967920.4242; train_optim_loss: 45967920.4242; val_kl_reg_loss: 67664.7651; val_edge_recon_loss: 4065080.7500; val_gene_expr_recon_loss: 15152126.0000; val_masked_gp_l1_reg_loss: 47670.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3679917.0000; val_chrom_access_recon_loss: 14090186.5000; val_global_loss: 37102644.0000; val_optim_loss: 37102644.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6933; val_auprc_score: 0.6807; val_best_acc_score: 0.5516; val_best_f1_score: 0.6828; train_kl_reg_loss: 117004.6175; train_edge_recon_loss: 3552839.1856; train_gene_expr_recon_loss: 15078610.2121; train_masked_gp_l1_reg_loss: 43522.1017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1396839.3887; train_chrom_access_recon_loss: 14156816.7879; train_global_loss: 34345632.2121; train_optim_loss: 34345632.2121; val_kl_reg_loss: 116873.4707; val_edge_recon_loss: 4061687.8438; val_gene_expr_recon_loss: 14551633.7500; val_masked_gp_l1_reg_loss: 40606.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 488066.5625; val_chrom_access_recon_loss: 14004069.0000; val_global_loss: 33262936.0000; val_optim_loss: 33262936.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7233; val_auprc_score: 0.6992; val_best_acc_score: 0.6505; val_best_f1_score: 0.7093; train_kl_reg_loss: 120320.2403; train_edge_recon_loss: 3537066.4508; train_gene_expr_recon_loss: 14705712.9848; train_masked_gp_l1_reg_loss: 39704.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 343614.7540; train_chrom_access_recon_loss: 14019797.6667; train_global_loss: 32766216.1212; train_optim_loss: 32766216.1212; val_kl_reg_loss: 118985.2939; val_edge_recon_loss: 4053658.5000; val_gene_expr_recon_loss: 14586453.6250; val_masked_gp_l1_reg_loss: 39475.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 256710.4219; val_chrom_access_recon_loss: 13944296.0000; val_global_loss: 32999580.2500; val_optim_loss: 32999580.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7648; val_auprc_score: 0.7434; val_best_acc_score: 0.6720; val_best_f1_score: 0.7196; train_kl_reg_loss: 109083.5743; train_edge_recon_loss: 3528153.5114; train_gene_expr_recon_loss: 14561397.0758; train_masked_gp_l1_reg_loss: 40010.9663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219411.4524; train_chrom_access_recon_loss: 13913147.1515; train_global_loss: 32371203.7879; train_optim_loss: 32371203.7879; val_kl_reg_loss: 100387.6777; val_edge_recon_loss: 4007382.4062; val_gene_expr_recon_loss: 14360573.3750; val_masked_gp_l1_reg_loss: 41019.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193144.8906; val_chrom_access_recon_loss: 13767094.3750; val_global_loss: 32469601.7500; val_optim_loss: 32469601.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7901; val_auprc_score: 0.7620; val_best_acc_score: 0.7168; val_best_f1_score: 0.7456; train_kl_reg_loss: 96387.5494; train_edge_recon_loss: 3497612.0038; train_gene_expr_recon_loss: 14461213.7121; train_masked_gp_l1_reg_loss: 42162.0581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179513.8906; train_chrom_access_recon_loss: 13823180.5455; train_global_loss: 32100069.9091; train_optim_loss: 32100069.9091; val_kl_reg_loss: 87521.5254; val_edge_recon_loss: 3791493.7188; val_gene_expr_recon_loss: 14155338.6250; val_masked_gp_l1_reg_loss: 43506.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168475.5469; val_chrom_access_recon_loss: 13586381.3750; val_global_loss: 31832717.0000; val_optim_loss: 31832717.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8102; val_auprc_score: 0.7761; val_best_acc_score: 0.7324; val_best_f1_score: 0.7679; train_kl_reg_loss: 86692.5992; train_edge_recon_loss: 3316281.6288; train_gene_expr_recon_loss: 14399176.6515; train_masked_gp_l1_reg_loss: 45045.8172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162129.7100; train_chrom_access_recon_loss: 13765820.0606; train_global_loss: 31775146.5758; train_optim_loss: 31775146.5758; val_kl_reg_loss: 94850.3604; val_edge_recon_loss: 3247239.0625; val_gene_expr_recon_loss: 14380142.2500; val_masked_gp_l1_reg_loss: 46724.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157550.3125; val_chrom_access_recon_loss: 13892616.2500; val_global_loss: 31819121.5000; val_optim_loss: 31819121.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8407; val_auprc_score: 0.8102; val_best_acc_score: 0.7542; val_best_f1_score: 0.7835; train_kl_reg_loss: 110740.5938; train_edge_recon_loss: 3066784.8258; train_gene_expr_recon_loss: 14357905.4545; train_masked_gp_l1_reg_loss: 47905.4912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154441.7609; train_chrom_access_recon_loss: 13688619.5758; train_global_loss: 31426397.6667; train_optim_loss: 31426397.6667; val_kl_reg_loss: 121003.1426; val_edge_recon_loss: 3047478.5625; val_gene_expr_recon_loss: 14143885.2500; val_masked_gp_l1_reg_loss: 48942.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150934.1562; val_chrom_access_recon_loss: 13521692.0000; val_global_loss: 31033935.2500; val_optim_loss: 31033935.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8683; val_auprc_score: 0.8313; val_best_acc_score: 0.7896; val_best_f1_score: 0.7995; train_kl_reg_loss: 117450.3447; train_edge_recon_loss: 2986686.2197; train_gene_expr_recon_loss: 14287614.8485; train_masked_gp_l1_reg_loss: 50124.9590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149525.4870; train_chrom_access_recon_loss: 13615661.8788; train_global_loss: 31207063.7576; train_optim_loss: 31207063.7576; val_kl_reg_loss: 119252.2402; val_edge_recon_loss: 2958794.1250; val_gene_expr_recon_loss: 14133706.3750; val_masked_gp_l1_reg_loss: 51378.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148719.0469; val_chrom_access_recon_loss: 13631083.5000; val_global_loss: 31042934.2500; val_optim_loss: 31042934.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8650; val_auprc_score: 0.8232; val_best_acc_score: 0.7963; val_best_f1_score: 0.8103; train_kl_reg_loss: 119076.6854; train_edge_recon_loss: 2942759.0758; train_gene_expr_recon_loss: 14197793.6364; train_masked_gp_l1_reg_loss: 51985.8169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145631.4754; train_chrom_access_recon_loss: 13541830.1970; train_global_loss: 30999076.6970; train_optim_loss: 30999076.6970; val_kl_reg_loss: 117100.8682; val_edge_recon_loss: 3026724.9062; val_gene_expr_recon_loss: 14032165.8750; val_masked_gp_l1_reg_loss: 52570.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143236.7500; val_chrom_access_recon_loss: 13619892.6250; val_global_loss: 30991691.2500; val_optim_loss: 30991691.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8858; val_auprc_score: 0.8479; val_best_acc_score: 0.8184; val_best_f1_score: 0.8298; train_kl_reg_loss: 112411.2054; train_edge_recon_loss: 2921947.4697; train_gene_expr_recon_loss: 14147152.8939; train_masked_gp_l1_reg_loss: 53315.8276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141659.9093; train_chrom_access_recon_loss: 13491016.6818; train_global_loss: 30867503.9697; train_optim_loss: 30867503.9697; val_kl_reg_loss: 109777.7188; val_edge_recon_loss: 2957403.6250; val_gene_expr_recon_loss: 13966009.5000; val_masked_gp_l1_reg_loss: 54138.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140646.1562; val_chrom_access_recon_loss: 13525722.0000; val_global_loss: 30753697.5000; val_optim_loss: 30753697.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9093; val_auprc_score: 0.8768; val_best_acc_score: 0.8436; val_best_f1_score: 0.8558; train_kl_reg_loss: 111426.1841; train_edge_recon_loss: 2881622.2803; train_gene_expr_recon_loss: 14080691.9394; train_masked_gp_l1_reg_loss: 54859.3384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139724.6948; train_chrom_access_recon_loss: 13432081.5152; train_global_loss: 30700405.8788; train_optim_loss: 30700405.8788; val_kl_reg_loss: 110203.4727; val_edge_recon_loss: 2903353.3438; val_gene_expr_recon_loss: 13981224.7500; val_masked_gp_l1_reg_loss: 55652.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139256.4219; val_chrom_access_recon_loss: 13478397.0000; val_global_loss: 30668087.0000; val_optim_loss: 30668087.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9019; val_auprc_score: 0.8607; val_best_acc_score: 0.8450; val_best_f1_score: 0.8550; train_kl_reg_loss: 113696.3200; train_edge_recon_loss: 2852008.1439; train_gene_expr_recon_loss: 14042710.0909; train_masked_gp_l1_reg_loss: 56317.9920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138406.1759; train_chrom_access_recon_loss: 13397873.3030; train_global_loss: 30601011.8182; train_optim_loss: 30601011.8182; val_kl_reg_loss: 114386.1611; val_edge_recon_loss: 2868819.4062; val_gene_expr_recon_loss: 13799788.3750; val_masked_gp_l1_reg_loss: 57022.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138306.5000; val_chrom_access_recon_loss: 13225112.6250; val_global_loss: 30203434.7500; val_optim_loss: 30203434.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9127; val_auprc_score: 0.8845; val_best_acc_score: 0.8541; val_best_f1_score: 0.8645; train_kl_reg_loss: 113995.5189; train_edge_recon_loss: 2844799.5947; train_gene_expr_recon_loss: 13994155.6212; train_masked_gp_l1_reg_loss: 57497.3977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137566.3544; train_chrom_access_recon_loss: 13347296.3485; train_global_loss: 30495310.9394; train_optim_loss: 30495310.9394; val_kl_reg_loss: 109893.3828; val_edge_recon_loss: 2877152.2188; val_gene_expr_recon_loss: 13939010.2500; val_masked_gp_l1_reg_loss: 58175.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136786.0938; val_chrom_access_recon_loss: 13384729.0000; val_global_loss: 30505746.7500; val_optim_loss: 30505746.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9241; val_auprc_score: 0.8931; val_best_acc_score: 0.8667; val_best_f1_score: 0.8741; train_kl_reg_loss: 114440.9818; train_edge_recon_loss: 2812288.1970; train_gene_expr_recon_loss: 13937546.0606; train_masked_gp_l1_reg_loss: 58749.1544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136125.8904; train_chrom_access_recon_loss: 13306286.3485; train_global_loss: 30365436.6061; train_optim_loss: 30365436.6061; val_kl_reg_loss: 115030.6602; val_edge_recon_loss: 2801206.1250; val_gene_expr_recon_loss: 13726961.2500; val_masked_gp_l1_reg_loss: 59329.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136168.2969; val_chrom_access_recon_loss: 13164860.1250; val_global_loss: 30003555.7500; val_optim_loss: 30003555.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9213; val_auprc_score: 0.8930; val_best_acc_score: 0.8662; val_best_f1_score: 0.8734; train_kl_reg_loss: 113185.8398; train_edge_recon_loss: 2804638.5227; train_gene_expr_recon_loss: 13894097.6364; train_masked_gp_l1_reg_loss: 59939.8256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135716.5729; train_chrom_access_recon_loss: 13260215.3485; train_global_loss: 30267793.7273; train_optim_loss: 30267793.7273; val_kl_reg_loss: 111019.1123; val_edge_recon_loss: 2832587.3438; val_gene_expr_recon_loss: 13653970.2500; val_masked_gp_l1_reg_loss: 60644.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135875.6406; val_chrom_access_recon_loss: 13090802.2500; val_global_loss: 29884899.2500; val_optim_loss: 29884899.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9205; val_auprc_score: 0.8931; val_best_acc_score: 0.8675; val_best_f1_score: 0.8752; train_kl_reg_loss: 111642.1398; train_edge_recon_loss: 2808013.6439; train_gene_expr_recon_loss: 13877316.2727; train_masked_gp_l1_reg_loss: 61454.0868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135880.9287; train_chrom_access_recon_loss: 13218801.2424; train_global_loss: 30213108.2424; train_optim_loss: 30213108.2424; val_kl_reg_loss: 108814.1777; val_edge_recon_loss: 2833788.7500; val_gene_expr_recon_loss: 13635708.5000; val_masked_gp_l1_reg_loss: 61746.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135843.1250; val_chrom_access_recon_loss: 13092061.0000; val_global_loss: 29867962.5000; val_optim_loss: 29867962.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9301; val_auprc_score: 0.9067; val_best_acc_score: 0.8743; val_best_f1_score: 0.8801; train_kl_reg_loss: 112128.0302; train_edge_recon_loss: 2788756.1629; train_gene_expr_recon_loss: 13812307.5455; train_masked_gp_l1_reg_loss: 62134.6784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135499.4557; train_chrom_access_recon_loss: 13170203.3939; train_global_loss: 30081029.3636; train_optim_loss: 30081029.3636; val_kl_reg_loss: 109886.8877; val_edge_recon_loss: 2776158.1250; val_gene_expr_recon_loss: 13598342.0000; val_masked_gp_l1_reg_loss: 62745.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134860.0781; val_chrom_access_recon_loss: 12999876.7500; val_global_loss: 29681869.7500; val_optim_loss: 29681869.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9194; val_auprc_score: 0.8887; val_best_acc_score: 0.8665; val_best_f1_score: 0.8753; train_kl_reg_loss: 111025.6142; train_edge_recon_loss: 2776382.8712; train_gene_expr_recon_loss: 13774851.4091; train_masked_gp_l1_reg_loss: 63055.1837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134349.1510; train_chrom_access_recon_loss: 13142338.1061; train_global_loss: 30002002.2727; train_optim_loss: 30002002.2727; val_kl_reg_loss: 109289.9570; val_edge_recon_loss: 2835550.8438; val_gene_expr_recon_loss: 13674885.6250; val_masked_gp_l1_reg_loss: 63555.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134044.2188; val_chrom_access_recon_loss: 13083453.3750; val_global_loss: 29900779.2500; val_optim_loss: 29900779.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9261; val_auprc_score: 0.8933; val_best_acc_score: 0.8735; val_best_f1_score: 0.8797; train_kl_reg_loss: 108314.5011; train_edge_recon_loss: 2775341.2045; train_gene_expr_recon_loss: 13754127.5152; train_masked_gp_l1_reg_loss: 64047.9518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134260.7981; train_chrom_access_recon_loss: 13111400.5000; train_global_loss: 29947492.3636; train_optim_loss: 29947492.3636; val_kl_reg_loss: 107724.1143; val_edge_recon_loss: 2783572.9375; val_gene_expr_recon_loss: 13524343.1250; val_masked_gp_l1_reg_loss: 64453.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133805.5156; val_chrom_access_recon_loss: 12981454.0000; val_global_loss: 29595354.7500; val_optim_loss: 29595354.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9260; val_auprc_score: 0.8988; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 108442.9702; train_edge_recon_loss: 2774904.7879; train_gene_expr_recon_loss: 13697717.8333; train_masked_gp_l1_reg_loss: 64962.5899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133693.6967; train_chrom_access_recon_loss: 13074141.2273; train_global_loss: 29853862.9394; train_optim_loss: 29853862.9394; val_kl_reg_loss: 109433.0039; val_edge_recon_loss: 2800739.5000; val_gene_expr_recon_loss: 13582177.2500; val_masked_gp_l1_reg_loss: 65430.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133342.4844; val_chrom_access_recon_loss: 12997872.7500; val_global_loss: 29688995.0000; val_optim_loss: 29688995.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9372; val_auprc_score: 0.9119; val_best_acc_score: 0.8850; val_best_f1_score: 0.8901; train_kl_reg_loss: 107819.4216; train_edge_recon_loss: 2767340.7917; train_gene_expr_recon_loss: 13677897.0455; train_masked_gp_l1_reg_loss: 65784.3116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133162.8672; train_chrom_access_recon_loss: 13051078.4545; train_global_loss: 29803082.8182; train_optim_loss: 29803082.8182; val_kl_reg_loss: 104168.0361; val_edge_recon_loss: 2746468.9688; val_gene_expr_recon_loss: 13463051.0000; val_masked_gp_l1_reg_loss: 66194.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132970.4531; val_chrom_access_recon_loss: 13080929.5000; val_global_loss: 29593781.7500; val_optim_loss: 29593781.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9347; val_auprc_score: 0.9102; val_best_acc_score: 0.8794; val_best_f1_score: 0.8858; train_kl_reg_loss: 107689.4458; train_edge_recon_loss: 2762754.2538; train_gene_expr_recon_loss: 13647199.3333; train_masked_gp_l1_reg_loss: 66535.6722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132698.0265; train_chrom_access_recon_loss: 13017040.6212; train_global_loss: 29733917.2424; train_optim_loss: 29733917.2424; val_kl_reg_loss: 106568.0645; val_edge_recon_loss: 2787618.2500; val_gene_expr_recon_loss: 13523483.5000; val_masked_gp_l1_reg_loss: 66943.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132930.3125; val_chrom_access_recon_loss: 13047907.5000; val_global_loss: 29665451.0000; val_optim_loss: 29665451.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9328; val_auprc_score: 0.9109; val_best_acc_score: 0.8769; val_best_f1_score: 0.8839; train_kl_reg_loss: 106824.5142; train_edge_recon_loss: 2754774.2159; train_gene_expr_recon_loss: 13624509.6667; train_masked_gp_l1_reg_loss: 67232.7060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132934.7450; train_chrom_access_recon_loss: 12978868.9242; train_global_loss: 29665144.6061; train_optim_loss: 29665144.6061; val_kl_reg_loss: 106807.7188; val_edge_recon_loss: 2772622.1562; val_gene_expr_recon_loss: 13450846.7500; val_masked_gp_l1_reg_loss: 67634.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133295.0156; val_chrom_access_recon_loss: 12790581.2500; val_global_loss: 29321788.5000; val_optim_loss: 29321788.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9339; val_auprc_score: 0.9102; val_best_acc_score: 0.8823; val_best_f1_score: 0.8879; train_kl_reg_loss: 105459.9268; train_edge_recon_loss: 2756846.9962; train_gene_expr_recon_loss: 13585934.1061; train_masked_gp_l1_reg_loss: 67942.2306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133096.8648; train_chrom_access_recon_loss: 12958714.2121; train_global_loss: 29607994.3636; train_optim_loss: 29607994.3636; val_kl_reg_loss: 106088.8398; val_edge_recon_loss: 2771531.3750; val_gene_expr_recon_loss: 13446746.6250; val_masked_gp_l1_reg_loss: 68314.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133024.7812; val_chrom_access_recon_loss: 12910754.0000; val_global_loss: 29436460.5000; val_optim_loss: 29436460.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9359; val_auprc_score: 0.9172; val_best_acc_score: 0.8743; val_best_f1_score: 0.8822; train_kl_reg_loss: 105064.4112; train_edge_recon_loss: 2741529.0682; train_gene_expr_recon_loss: 13563181.3485; train_masked_gp_l1_reg_loss: 68629.2300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132928.1657; train_chrom_access_recon_loss: 12925016.8636; train_global_loss: 29536348.9394; train_optim_loss: 29536348.9394; val_kl_reg_loss: 105061.2627; val_edge_recon_loss: 2782741.1250; val_gene_expr_recon_loss: 13377564.8750; val_masked_gp_l1_reg_loss: 68841.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132709.4219; val_chrom_access_recon_loss: 12838245.5000; val_global_loss: 29305163.5000; val_optim_loss: 29305163.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9374; val_auprc_score: 0.9114; val_best_acc_score: 0.8874; val_best_f1_score: 0.8940; train_kl_reg_loss: 101873.4032; train_edge_recon_loss: 2774923.9470; train_gene_expr_recon_loss: 13439243.7727; train_masked_gp_l1_reg_loss: 68594.4010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138322.2985; train_chrom_access_recon_loss: 12927939.3182; train_global_loss: 29450897.3636; train_optim_loss: 29450897.3636; val_kl_reg_loss: 77399.7998; val_edge_recon_loss: 2778986.7812; val_gene_expr_recon_loss: 13322663.1250; val_masked_gp_l1_reg_loss: 68461.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135909.0000; val_chrom_access_recon_loss: 12958895.2500; val_global_loss: 29342315.2500; val_optim_loss: 29342315.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9441; val_auprc_score: 0.9242; val_best_acc_score: 0.8874; val_best_f1_score: 0.8934; train_kl_reg_loss: 105023.8572; train_edge_recon_loss: 2754998.3977; train_gene_expr_recon_loss: 13392034.6970; train_masked_gp_l1_reg_loss: 68583.8243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132407.5263; train_chrom_access_recon_loss: 12803351.5303; train_global_loss: 29256399.9394; train_optim_loss: 29256399.9394; val_kl_reg_loss: 80960.4160; val_edge_recon_loss: 2757503.8125; val_gene_expr_recon_loss: 13194793.2500; val_masked_gp_l1_reg_loss: 68758.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129939.9688; val_chrom_access_recon_loss: 12642169.8750; val_global_loss: 28874127.2500; val_optim_loss: 28874127.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9342; val_auprc_score: 0.9118; val_best_acc_score: 0.8791; val_best_f1_score: 0.8861; train_kl_reg_loss: 104414.7016; train_edge_recon_loss: 2753659.4508; train_gene_expr_recon_loss: 13359782.3182; train_masked_gp_l1_reg_loss: 68842.8738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127790.1354; train_chrom_access_recon_loss: 12780359.8182; train_global_loss: 29194849.4242; train_optim_loss: 29194849.4242; val_kl_reg_loss: 84094.5605; val_edge_recon_loss: 2818035.7500; val_gene_expr_recon_loss: 13306570.1250; val_masked_gp_l1_reg_loss: 68926.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126368.6562; val_chrom_access_recon_loss: 12782844.2500; val_global_loss: 29186840.2500; val_optim_loss: 29186840.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9391; val_auprc_score: 0.9188; val_best_acc_score: 0.8821; val_best_f1_score: 0.8880; train_kl_reg_loss: 101992.6198; train_edge_recon_loss: 2740948.1515; train_gene_expr_recon_loss: 13338955.2424; train_masked_gp_l1_reg_loss: 69082.1884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125122.2823; train_chrom_access_recon_loss: 12758616.2879; train_global_loss: 29134716.7576; train_optim_loss: 29134716.7576; val_kl_reg_loss: 84435.7441; val_edge_recon_loss: 2777149.0625; val_gene_expr_recon_loss: 13195446.0000; val_masked_gp_l1_reg_loss: 69295.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123976.7266; val_chrom_access_recon_loss: 12706662.2500; val_global_loss: 28956966.0000; val_optim_loss: 28956966.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9377; val_auprc_score: 0.9140; val_best_acc_score: 0.8786; val_best_f1_score: 0.8851; train_kl_reg_loss: 100936.9916; train_edge_recon_loss: 2740165.1439; train_gene_expr_recon_loss: 13311582.3788; train_masked_gp_l1_reg_loss: 69418.8398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123194.9309; train_chrom_access_recon_loss: 12727535.1818; train_global_loss: 29072833.2424; train_optim_loss: 29072833.2424; val_kl_reg_loss: 83863.2070; val_edge_recon_loss: 2802843.7500; val_gene_expr_recon_loss: 13209428.2500; val_masked_gp_l1_reg_loss: 69611.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122030.6797; val_chrom_access_recon_loss: 12678413.8750; val_global_loss: 28966191.5000; val_optim_loss: 28966191.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9509; val_auprc_score: 0.9306; val_best_acc_score: 0.8966; val_best_f1_score: 0.9008; train_kl_reg_loss: 99577.6484; train_edge_recon_loss: 2744284.7803; train_gene_expr_recon_loss: 13295862.2121; train_masked_gp_l1_reg_loss: 69781.4154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121750.0039; train_chrom_access_recon_loss: 12707095.6212; train_global_loss: 29038351.6970; train_optim_loss: 29038351.6970; val_kl_reg_loss: 85044.4111; val_edge_recon_loss: 2718263.3750; val_gene_expr_recon_loss: 13015253.6250; val_masked_gp_l1_reg_loss: 69929.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121763.2656; val_chrom_access_recon_loss: 12585155.1250; val_global_loss: 28595408.7500; val_optim_loss: 28595408.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9468; val_auprc_score: 0.9290; val_best_acc_score: 0.8907; val_best_f1_score: 0.8960; train_kl_reg_loss: 97115.1424; train_edge_recon_loss: 2733276.5455; train_gene_expr_recon_loss: 13283780.2273; train_masked_gp_l1_reg_loss: 70097.6824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121378.6188; train_chrom_access_recon_loss: 12686612.5152; train_global_loss: 28992260.6667; train_optim_loss: 28992260.6667; val_kl_reg_loss: 89414.8926; val_edge_recon_loss: 2759954.6250; val_gene_expr_recon_loss: 13147836.5000; val_masked_gp_l1_reg_loss: 70238.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121443.0859; val_chrom_access_recon_loss: 12639574.5000; val_global_loss: 28828461.5000; val_optim_loss: 28828461.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9503; val_auprc_score: 0.9311; val_best_acc_score: 0.8974; val_best_f1_score: 0.9032; train_kl_reg_loss: 96204.4966; train_edge_recon_loss: 2736609.5985; train_gene_expr_recon_loss: 13267918.3333; train_masked_gp_l1_reg_loss: 70393.1188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120475.2430; train_chrom_access_recon_loss: 12677104.6818; train_global_loss: 28968705.3636; train_optim_loss: 28968705.3636; val_kl_reg_loss: 88259.7900; val_edge_recon_loss: 2724455.2188; val_gene_expr_recon_loss: 13054881.1250; val_masked_gp_l1_reg_loss: 70569.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120282.2734; val_chrom_access_recon_loss: 12482787.5000; val_global_loss: 28541234.7500; val_optim_loss: 28541234.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9496; val_auprc_score: 0.9349; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 95711.1196; train_edge_recon_loss: 2727343.6402; train_gene_expr_recon_loss: 13236630.7727; train_masked_gp_l1_reg_loss: 70722.4934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120056.2202; train_chrom_access_recon_loss: 12631516.0455; train_global_loss: 28881980.2424; train_optim_loss: 28881980.2424; val_kl_reg_loss: 88490.1885; val_edge_recon_loss: 2764557.7812; val_gene_expr_recon_loss: 13231895.3750; val_masked_gp_l1_reg_loss: 70937.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119357.9219; val_chrom_access_recon_loss: 12718361.6250; val_global_loss: 28993600.0000; val_optim_loss: 28993600.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9525; val_auprc_score: 0.9345; val_best_acc_score: 0.8974; val_best_f1_score: 0.9011; train_kl_reg_loss: 95632.2792; train_edge_recon_loss: 2732134.2765; train_gene_expr_recon_loss: 13215586.1364; train_masked_gp_l1_reg_loss: 71063.2885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119537.3243; train_chrom_access_recon_loss: 12605554.8182; train_global_loss: 28839508.1212; train_optim_loss: 28839508.1212; val_kl_reg_loss: 87508.3906; val_edge_recon_loss: 2738555.3750; val_gene_expr_recon_loss: 13122787.2500; val_masked_gp_l1_reg_loss: 71177.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119608.9531; val_chrom_access_recon_loss: 12513109.6250; val_global_loss: 28652748.2500; val_optim_loss: 28652748.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9470; val_auprc_score: 0.9265; val_best_acc_score: 0.8987; val_best_f1_score: 0.9028; train_kl_reg_loss: 92813.0704; train_edge_recon_loss: 2722937.3068; train_gene_expr_recon_loss: 13202836.0758; train_masked_gp_l1_reg_loss: 71371.3344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119241.9608; train_chrom_access_recon_loss: 12583688.0000; train_global_loss: 28792887.6364; train_optim_loss: 28792887.6364; val_kl_reg_loss: 87127.7930; val_edge_recon_loss: 2758688.8125; val_gene_expr_recon_loss: 13120668.8750; val_masked_gp_l1_reg_loss: 71524.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119014.3828; val_chrom_access_recon_loss: 12587710.7500; val_global_loss: 28744735.5000; val_optim_loss: 28744735.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9495; val_auprc_score: 0.9303; val_best_acc_score: 0.8992; val_best_f1_score: 0.9038; train_kl_reg_loss: 93685.8788; train_edge_recon_loss: 2724020.6364; train_gene_expr_recon_loss: 13173972.7727; train_masked_gp_l1_reg_loss: 71657.6149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118965.6436; train_chrom_access_recon_loss: 12542379.3182; train_global_loss: 28724681.7576; train_optim_loss: 28724681.7576; val_kl_reg_loss: 91209.7168; val_edge_recon_loss: 2765150.0312; val_gene_expr_recon_loss: 13057748.8750; val_masked_gp_l1_reg_loss: 71832.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119663.8828; val_chrom_access_recon_loss: 12622866.3750; val_global_loss: 28728470.7500; val_optim_loss: 28728470.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9478; val_auprc_score: 0.9263; val_best_acc_score: 0.8974; val_best_f1_score: 0.9023; train_kl_reg_loss: 94927.8123; train_edge_recon_loss: 2711424.8295; train_gene_expr_recon_loss: 13149817.4545; train_masked_gp_l1_reg_loss: 71453.1871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89452.1085; train_chrom_access_recon_loss: 12527075.9091; train_global_loss: 28644151.2727; train_optim_loss: 28644151.2727; val_kl_reg_loss: 90161.2285; val_edge_recon_loss: 2763159.2188; val_gene_expr_recon_loss: 13095360.7500; val_masked_gp_l1_reg_loss: 71235.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84299.3281; val_chrom_access_recon_loss: 12553293.0000; val_global_loss: 28657509.2500; val_optim_loss: 28657509.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9510; val_auprc_score: 0.9356; val_best_acc_score: 0.8984; val_best_f1_score: 0.9031; train_kl_reg_loss: 95197.5752; train_edge_recon_loss: 2718019.4205; train_gene_expr_recon_loss: 13149123.2576; train_masked_gp_l1_reg_loss: 71158.3978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84016.7416; train_chrom_access_recon_loss: 12529370.1667; train_global_loss: 28646885.5152; train_optim_loss: 28646885.5152; val_kl_reg_loss: 90299.2275; val_edge_recon_loss: 2743235.3125; val_gene_expr_recon_loss: 13101190.5000; val_masked_gp_l1_reg_loss: 71106.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83913.8672; val_chrom_access_recon_loss: 12516166.7500; val_global_loss: 28605911.7500; val_optim_loss: 28605911.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9475; val_auprc_score: 0.9244; val_best_acc_score: 0.8949; val_best_f1_score: 0.9006; train_kl_reg_loss: 94311.5578; train_edge_recon_loss: 2712242.3598; train_gene_expr_recon_loss: 13148380.1212; train_masked_gp_l1_reg_loss: 71092.3393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83711.9160; train_chrom_access_recon_loss: 12524705.6970; train_global_loss: 28634443.9697; train_optim_loss: 28634443.9697; val_kl_reg_loss: 89916.6260; val_edge_recon_loss: 2768085.7812; val_gene_expr_recon_loss: 12933021.3750; val_masked_gp_l1_reg_loss: 71076.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83499.5859; val_chrom_access_recon_loss: 12409969.2500; val_global_loss: 28355569.0000; val_optim_loss: 28355569.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9544; val_auprc_score: 0.9350; val_best_acc_score: 0.9044; val_best_f1_score: 0.9090; train_kl_reg_loss: 95182.4163; train_edge_recon_loss: 2714164.9583; train_gene_expr_recon_loss: 13158659.8182; train_masked_gp_l1_reg_loss: 71069.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83354.3804; train_chrom_access_recon_loss: 12536073.2273; train_global_loss: 28658504.3333; train_optim_loss: 28658504.3333; val_kl_reg_loss: 91110.5410; val_edge_recon_loss: 2752045.0938; val_gene_expr_recon_loss: 12957443.5000; val_masked_gp_l1_reg_loss: 71058.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83217.3359; val_chrom_access_recon_loss: 12455376.0000; val_global_loss: 28410251.5000; val_optim_loss: 28410251.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9577; val_auprc_score: 0.9421; val_best_acc_score: 0.9062; val_best_f1_score: 0.9101; train_kl_reg_loss: 95552.0762; train_edge_recon_loss: 2709553.5909; train_gene_expr_recon_loss: 13159078.2727; train_masked_gp_l1_reg_loss: 71064.3504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83123.4564; train_chrom_access_recon_loss: 12533196.4697; train_global_loss: 28651568.0303; train_optim_loss: 28651568.0303; val_kl_reg_loss: 91574.9971; val_edge_recon_loss: 2731099.5000; val_gene_expr_recon_loss: 13097520.8750; val_masked_gp_l1_reg_loss: 71061.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83117.4922; val_chrom_access_recon_loss: 12513190.7500; val_global_loss: 28587564.0000; val_optim_loss: 28587564.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9515; val_auprc_score: 0.9308; val_best_acc_score: 0.9017; val_best_f1_score: 0.9072; train_kl_reg_loss: 95209.9605; train_edge_recon_loss: 2723112.5038; train_gene_expr_recon_loss: 13144339.8333; train_masked_gp_l1_reg_loss: 71065.1688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82867.0013; train_chrom_access_recon_loss: 12517009.7879; train_global_loss: 28633604.3636; train_optim_loss: 28633604.3636; val_kl_reg_loss: 90854.0430; val_edge_recon_loss: 2745926.0625; val_gene_expr_recon_loss: 13041706.6250; val_masked_gp_l1_reg_loss: 71069.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82754.3828; val_chrom_access_recon_loss: 12467841.5000; val_global_loss: 28500151.2500; val_optim_loss: 28500151.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9456; val_auprc_score: 0.9196; val_best_acc_score: 0.8963; val_best_f1_score: 0.9014; train_kl_reg_loss: 95238.2879; train_edge_recon_loss: 2714734.0114; train_gene_expr_recon_loss: 13135060.0152; train_masked_gp_l1_reg_loss: 71087.5063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82656.6603; train_chrom_access_recon_loss: 12514772.9545; train_global_loss: 28613549.5455; train_optim_loss: 28613549.5455; val_kl_reg_loss: 92363.4854; val_edge_recon_loss: 2741116.1875; val_gene_expr_recon_loss: 12982754.1250; val_masked_gp_l1_reg_loss: 71094.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82550.0156; val_chrom_access_recon_loss: 12354409.1250; val_global_loss: 28324286.7500; val_optim_loss: 28324286.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9488; val_auprc_score: 0.9237; val_best_acc_score: 0.8987; val_best_f1_score: 0.9038; train_kl_reg_loss: 95439.3717; train_edge_recon_loss: 2715272.0530; train_gene_expr_recon_loss: 13138068.3333; train_masked_gp_l1_reg_loss: 71096.4445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82407.9892; train_chrom_access_recon_loss: 12514091.4545; train_global_loss: 28616375.8788; train_optim_loss: 28616375.8788; val_kl_reg_loss: 92291.4697; val_edge_recon_loss: 2733832.0312; val_gene_expr_recon_loss: 13014589.8750; val_masked_gp_l1_reg_loss: 71100.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82316.1172; val_chrom_access_recon_loss: 12536138.6250; val_global_loss: 28530267.7500; val_optim_loss: 28530267.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9497; val_auprc_score: 0.9320; val_best_acc_score: 0.8984; val_best_f1_score: 0.9022; train_kl_reg_loss: 95042.4373; train_edge_recon_loss: 2713780.4924; train_gene_expr_recon_loss: 13132116.2273; train_masked_gp_l1_reg_loss: 71117.3802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82238.5333; train_chrom_access_recon_loss: 12498619.1061; train_global_loss: 28592914.1515; train_optim_loss: 28592914.1515; val_kl_reg_loss: 91667.7910; val_edge_recon_loss: 2747800.5625; val_gene_expr_recon_loss: 13098248.5000; val_masked_gp_l1_reg_loss: 71128.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82243.6016; val_chrom_access_recon_loss: 12482153.2500; val_global_loss: 28573242.0000; val_optim_loss: 28573242.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9496; val_auprc_score: 0.9289; val_best_acc_score: 0.8971; val_best_f1_score: 0.9036; train_kl_reg_loss: 94625.1959; train_edge_recon_loss: 2710823.3826; train_gene_expr_recon_loss: 13138541.9545; train_masked_gp_l1_reg_loss: 71140.4986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82043.8241; train_chrom_access_recon_loss: 12504832.3333; train_global_loss: 28602007.4242; train_optim_loss: 28602007.4242; val_kl_reg_loss: 89700.2646; val_edge_recon_loss: 2756663.2500; val_gene_expr_recon_loss: 13033417.7500; val_masked_gp_l1_reg_loss: 71153.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81956.3359; val_chrom_access_recon_loss: 12519993.5000; val_global_loss: 28552884.5000; val_optim_loss: 28552884.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9538; val_auprc_score: 0.9331; val_best_acc_score: 0.9054; val_best_f1_score: 0.9091; train_kl_reg_loss: 94767.5394; train_edge_recon_loss: 2716239.1553; train_gene_expr_recon_loss: 13134272.1970; train_masked_gp_l1_reg_loss: 71174.1680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81869.3563; train_chrom_access_recon_loss: 12490135.6061; train_global_loss: 28588458.1515; train_optim_loss: 28588458.1515; val_kl_reg_loss: 91618.1885; val_edge_recon_loss: 2702763.4688; val_gene_expr_recon_loss: 13053558.7500; val_masked_gp_l1_reg_loss: 71175.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81693.8047; val_chrom_access_recon_loss: 12508255.0000; val_global_loss: 28509065.0000; val_optim_loss: 28509065.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9524; val_auprc_score: 0.9351; val_best_acc_score: 0.8995; val_best_f1_score: 0.9052; train_kl_reg_loss: 95093.5830; train_edge_recon_loss: 2709546.9394; train_gene_expr_recon_loss: 13132063.1667; train_masked_gp_l1_reg_loss: 71136.7834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78446.7591; train_chrom_access_recon_loss: 12493734.0909; train_global_loss: 28580021.2727; train_optim_loss: 28580021.2727; val_kl_reg_loss: 91848.2832; val_edge_recon_loss: 2741172.0625; val_gene_expr_recon_loss: 12921026.5000; val_masked_gp_l1_reg_loss: 71113.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77884.7344; val_chrom_access_recon_loss: 12512514.7500; val_global_loss: 28415559.7500; val_optim_loss: 28415559.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9576; val_auprc_score: 0.9434; val_best_acc_score: 0.9054; val_best_f1_score: 0.9102; train_kl_reg_loss: 95166.3223; train_edge_recon_loss: 2707093.8409; train_gene_expr_recon_loss: 13140425.5758; train_masked_gp_l1_reg_loss: 71104.7362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77871.2790; train_chrom_access_recon_loss: 12509376.6667; train_global_loss: 28601038.3939; train_optim_loss: 28601038.3939; val_kl_reg_loss: 91055.9062; val_edge_recon_loss: 2708756.9375; val_gene_expr_recon_loss: 13073835.3750; val_masked_gp_l1_reg_loss: 71096.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77862.7344; val_chrom_access_recon_loss: 12624852.5000; val_global_loss: 28647459.5000; val_optim_loss: 28647459.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9531; val_auprc_score: 0.9299; val_best_acc_score: 0.9025; val_best_f1_score: 0.9069; train_kl_reg_loss: 95097.1768; train_edge_recon_loss: 2703187.3182; train_gene_expr_recon_loss: 13132135.0606; train_masked_gp_l1_reg_loss: 71092.6716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77845.6985; train_chrom_access_recon_loss: 12497165.4091; train_global_loss: 28576523.3939; train_optim_loss: 28576523.3939; val_kl_reg_loss: 91696.1045; val_edge_recon_loss: 2761176.4375; val_gene_expr_recon_loss: 12897643.1250; val_masked_gp_l1_reg_loss: 71088.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77831.8203; val_chrom_access_recon_loss: 12335518.0000; val_global_loss: 28234955.0000; val_optim_loss: 28234955.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9540; val_auprc_score: 0.9334; val_best_acc_score: 0.8974; val_best_f1_score: 0.9022; train_kl_reg_loss: 94961.9711; train_edge_recon_loss: 2713920.1591; train_gene_expr_recon_loss: 13138743.9242; train_masked_gp_l1_reg_loss: 71087.7869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77825.4332; train_chrom_access_recon_loss: 12514715.6667; train_global_loss: 28611255.0000; train_optim_loss: 28611255.0000; val_kl_reg_loss: 91486.2314; val_edge_recon_loss: 2744973.1562; val_gene_expr_recon_loss: 13045517.3750; val_masked_gp_l1_reg_loss: 71085.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77819.9219; val_chrom_access_recon_loss: 12538515.8750; val_global_loss: 28569398.7500; val_optim_loss: 28569398.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9482; val_auprc_score: 0.9244; val_best_acc_score: 0.8987; val_best_f1_score: 0.9036; train_kl_reg_loss: 94929.2706; train_edge_recon_loss: 2713557.2083; train_gene_expr_recon_loss: 13128755.5606; train_masked_gp_l1_reg_loss: 71086.2946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77805.6681; train_chrom_access_recon_loss: 12494951.3333; train_global_loss: 28581085.3939; train_optim_loss: 28581085.3939; val_kl_reg_loss: 92294.5273; val_edge_recon_loss: 2737322.7188; val_gene_expr_recon_loss: 13007045.5000; val_masked_gp_l1_reg_loss: 71084.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77806.9688; val_chrom_access_recon_loss: 12495739.1250; val_global_loss: 28481293.7500; val_optim_loss: 28481293.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9466; val_auprc_score: 0.9267; val_best_acc_score: 0.8920; val_best_f1_score: 0.8984; train_kl_reg_loss: 94898.6268; train_edge_recon_loss: 2717522.4659; train_gene_expr_recon_loss: 13129949.4242; train_masked_gp_l1_reg_loss: 71085.3821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77789.0774; train_chrom_access_recon_loss: 12496597.3939; train_global_loss: 28587842.4242; train_optim_loss: 28587842.4242; val_kl_reg_loss: 91026.8418; val_edge_recon_loss: 2760194.1250; val_gene_expr_recon_loss: 12961687.5000; val_masked_gp_l1_reg_loss: 71084.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77776.6875; val_chrom_access_recon_loss: 12431334.7500; val_global_loss: 28393103.7500; val_optim_loss: 28393103.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9504; val_auprc_score: 0.9353; val_best_acc_score: 0.8982; val_best_f1_score: 0.9037; train_kl_reg_loss: 94896.0851; train_edge_recon_loss: 2710364.8144; train_gene_expr_recon_loss: 13136673.6970; train_masked_gp_l1_reg_loss: 71085.5347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77763.2681; train_chrom_access_recon_loss: 12490777.5303; train_global_loss: 28581560.8788; train_optim_loss: 28581560.8788; val_kl_reg_loss: 91902.4160; val_edge_recon_loss: 2738171.3750; val_gene_expr_recon_loss: 13009503.5000; val_masked_gp_l1_reg_loss: 71085.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77753.9219; val_chrom_access_recon_loss: 12474715.0000; val_global_loss: 28463132.2500; val_optim_loss: 28463132.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9541; val_auprc_score: 0.9375; val_best_acc_score: 0.9052; val_best_f1_score: 0.9097; train_kl_reg_loss: 94997.7818; train_edge_recon_loss: 2712991.6288; train_gene_expr_recon_loss: 13125660.0303; train_masked_gp_l1_reg_loss: 71081.7354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77421.1481; train_chrom_access_recon_loss: 12494751.1667; train_global_loss: 28576903.4545; train_optim_loss: 28576903.4545; val_kl_reg_loss: 91460.9102; val_edge_recon_loss: 2744237.3438; val_gene_expr_recon_loss: 13011334.0000; val_masked_gp_l1_reg_loss: 71079.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77363.1094; val_chrom_access_recon_loss: 12463672.6250; val_global_loss: 28459148.0000; val_optim_loss: 28459148.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9498; val_auprc_score: 0.9321; val_best_acc_score: 0.8955; val_best_f1_score: 0.9014; train_kl_reg_loss: 94990.2938; train_edge_recon_loss: 2716302.8333; train_gene_expr_recon_loss: 13128924.4091; train_masked_gp_l1_reg_loss: 71078.5877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77361.5268; train_chrom_access_recon_loss: 12499335.3030; train_global_loss: 28587992.9394; train_optim_loss: 28587992.9394; val_kl_reg_loss: 91709.4277; val_edge_recon_loss: 2752774.6875; val_gene_expr_recon_loss: 12925867.6250; val_masked_gp_l1_reg_loss: 71077.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77360.5156; val_chrom_access_recon_loss: 12345563.7500; val_global_loss: 28264354.0000; val_optim_loss: 28264354.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9538; val_auprc_score: 0.9377; val_best_acc_score: 0.9019; val_best_f1_score: 0.9053; train_kl_reg_loss: 94938.7375; train_edge_recon_loss: 2716262.3788; train_gene_expr_recon_loss: 13134044.4697; train_masked_gp_l1_reg_loss: 71077.4000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77358.6686; train_chrom_access_recon_loss: 12495625.3182; train_global_loss: 28589306.9697; train_optim_loss: 28589306.9697; val_kl_reg_loss: 91828.6191; val_edge_recon_loss: 2739969.6875; val_gene_expr_recon_loss: 12869524.7500; val_masked_gp_l1_reg_loss: 71076.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77357.2266; val_chrom_access_recon_loss: 12446939.3750; val_global_loss: 28296696.0000; val_optim_loss: 28296696.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9502; val_auprc_score: 0.9339; val_best_acc_score: 0.8979; val_best_f1_score: 0.9034; train_kl_reg_loss: 94980.7281; train_edge_recon_loss: 2712590.4924; train_gene_expr_recon_loss: 13139261.5455; train_masked_gp_l1_reg_loss: 71076.6454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77356.2087; train_chrom_access_recon_loss: 12509867.8030; train_global_loss: 28605133.3333; train_optim_loss: 28605133.3333; val_kl_reg_loss: 91972.5654; val_edge_recon_loss: 2754443.0000; val_gene_expr_recon_loss: 13051354.2500; val_masked_gp_l1_reg_loss: 71076.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77354.8594; val_chrom_access_recon_loss: 12402146.3750; val_global_loss: 28448347.2500; val_optim_loss: 28448347.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 54 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9504
val AUPRC score: 0.9331
val best accuracy score: 0.8949
val best F1 score: 0.9000
val target rna MSE score: 0.8995
val source rna MSE score: 0.3467
val target atac MSE score: 0.3278
val source atac MSE score: 0.0746
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
