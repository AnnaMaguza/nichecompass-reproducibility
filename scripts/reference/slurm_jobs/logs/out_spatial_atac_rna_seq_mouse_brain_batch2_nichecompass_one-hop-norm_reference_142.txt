[True]
Run timestamp: 10102023_042947_142.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_142']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7778; val_auprc_score: 0.7953; val_best_acc_score: 0.5059; val_best_f1_score: 0.6686; train_kl_reg_loss: 60162.6513; train_edge_recon_loss: 3514349.8130; train_gene_expr_recon_loss: 13539710.8702; train_masked_gp_l1_reg_loss: 113527.1741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2781564.6474; train_chrom_access_recon_loss: 11240035.8931; train_global_loss: 31249351.1603; train_optim_loss: 31249351.1603; val_kl_reg_loss: 96858.9260; val_edge_recon_loss: 4064555.3500; val_gene_expr_recon_loss: 12903509.2000; val_masked_gp_l1_reg_loss: 101432.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 443986.3750; val_chrom_access_recon_loss: 10803128.4667; val_global_loss: 28413470.1333; val_optim_loss: 28413470.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7960; val_auprc_score: 0.8138; val_best_acc_score: 0.6638; val_best_f1_score: 0.7272; train_kl_reg_loss: 84964.5699; train_edge_recon_loss: 3504048.4122; train_gene_expr_recon_loss: 12582967.2824; train_masked_gp_l1_reg_loss: 99752.3262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239974.7296; train_chrom_access_recon_loss: 10795567.0000; train_global_loss: 27307274.2595; train_optim_loss: 27307274.2595; val_kl_reg_loss: 73404.1443; val_edge_recon_loss: 4046492.6167; val_gene_expr_recon_loss: 12580824.0667; val_masked_gp_l1_reg_loss: 100118.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148237.0938; val_chrom_access_recon_loss: 10618217.0000; val_global_loss: 27567293.8667; val_optim_loss: 27567293.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8708; val_auprc_score: 0.8679; val_best_acc_score: 0.7753; val_best_f1_score: 0.7982; train_kl_reg_loss: 70883.4549; train_edge_recon_loss: 3356592.5439; train_gene_expr_recon_loss: 12420959.9771; train_masked_gp_l1_reg_loss: 104530.2804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121328.7295; train_chrom_access_recon_loss: 10670332.7099; train_global_loss: 26744627.7710; train_optim_loss: 26744627.7710; val_kl_reg_loss: 83161.3911; val_edge_recon_loss: 3017628.1833; val_gene_expr_recon_loss: 12513343.5333; val_masked_gp_l1_reg_loss: 117671.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104686.7969; val_chrom_access_recon_loss: 10522030.8000; val_global_loss: 26358521.7333; val_optim_loss: 26358521.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8806; val_auprc_score: 0.8745; val_best_acc_score: 0.7769; val_best_f1_score: 0.8019; train_kl_reg_loss: 94306.1694; train_edge_recon_loss: 2972691.0172; train_gene_expr_recon_loss: 12322962.6260; train_masked_gp_l1_reg_loss: 119575.1892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95735.6384; train_chrom_access_recon_loss: 10561024.5267; train_global_loss: 26166295.0229; train_optim_loss: 26166295.0229; val_kl_reg_loss: 94695.1443; val_edge_recon_loss: 2971539.5667; val_gene_expr_recon_loss: 12371884.9333; val_masked_gp_l1_reg_loss: 119670.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89315.1797; val_chrom_access_recon_loss: 10387592.4667; val_global_loss: 26034698.4000; val_optim_loss: 26034698.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8929; val_auprc_score: 0.8801; val_best_acc_score: 0.8080; val_best_f1_score: 0.8216; train_kl_reg_loss: 93611.6810; train_edge_recon_loss: 2929050.3340; train_gene_expr_recon_loss: 12198489.7176; train_masked_gp_l1_reg_loss: 119884.5985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85746.2240; train_chrom_access_recon_loss: 10463410.7176; train_global_loss: 25890193.2977; train_optim_loss: 25890193.2977; val_kl_reg_loss: 89506.5167; val_edge_recon_loss: 2903978.3333; val_gene_expr_recon_loss: 12292422.6000; val_masked_gp_l1_reg_loss: 120423.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83705.1094; val_chrom_access_recon_loss: 10388003.3333; val_global_loss: 25878039.6000; val_optim_loss: 25878039.6000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9084; val_auprc_score: 0.8925; val_best_acc_score: 0.8289; val_best_f1_score: 0.8446; train_kl_reg_loss: 91755.3302; train_edge_recon_loss: 2860494.3740; train_gene_expr_recon_loss: 12089951.9924; train_masked_gp_l1_reg_loss: 121259.3027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83017.0169; train_chrom_access_recon_loss: 10389098.9695; train_global_loss: 25635577.0076; train_optim_loss: 25635577.0076; val_kl_reg_loss: 88849.2063; val_edge_recon_loss: 2873232.6833; val_gene_expr_recon_loss: 12156548.8000; val_masked_gp_l1_reg_loss: 122526.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82309.5625; val_chrom_access_recon_loss: 10252031.7333; val_global_loss: 25575498.6667; val_optim_loss: 25575498.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9180; val_auprc_score: 0.9014; val_best_acc_score: 0.8483; val_best_f1_score: 0.8580; train_kl_reg_loss: 95522.7870; train_edge_recon_loss: 2808170.8130; train_gene_expr_recon_loss: 12003149.1908; train_masked_gp_l1_reg_loss: 123348.3753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81576.2154; train_chrom_access_recon_loss: 10317808.9924; train_global_loss: 25429576.2443; train_optim_loss: 25429576.2443; val_kl_reg_loss: 96041.2224; val_edge_recon_loss: 2842744.0333; val_gene_expr_recon_loss: 12075077.9333; val_masked_gp_l1_reg_loss: 124550.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81798.2031; val_chrom_access_recon_loss: 10190406.2000; val_global_loss: 25410617.4667; val_optim_loss: 25410617.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9295; val_auprc_score: 0.9130; val_best_acc_score: 0.8632; val_best_f1_score: 0.8709; train_kl_reg_loss: 93873.5409; train_edge_recon_loss: 2796396.3645; train_gene_expr_recon_loss: 11922960.6412; train_masked_gp_l1_reg_loss: 125147.2603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81772.3162; train_chrom_access_recon_loss: 10250334.3130; train_global_loss: 25270484.4733; train_optim_loss: 25270484.4733; val_kl_reg_loss: 95178.0974; val_edge_recon_loss: 2798401.0667; val_gene_expr_recon_loss: 11948003.6000; val_masked_gp_l1_reg_loss: 126222.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82671.0938; val_chrom_access_recon_loss: 10102225.2000; val_global_loss: 25152701.7333; val_optim_loss: 25152701.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9393; val_auprc_score: 0.9223; val_best_acc_score: 0.8746; val_best_f1_score: 0.8813; train_kl_reg_loss: 92688.3916; train_edge_recon_loss: 2779526.9771; train_gene_expr_recon_loss: 11859446.0916; train_masked_gp_l1_reg_loss: 126435.7456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83165.4653; train_chrom_access_recon_loss: 10199692.0534; train_global_loss: 25140954.7481; train_optim_loss: 25140954.7481; val_kl_reg_loss: 92833.3203; val_edge_recon_loss: 2780422.4333; val_gene_expr_recon_loss: 11927626.0667; val_masked_gp_l1_reg_loss: 127130.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82882.9844; val_chrom_access_recon_loss: 10063181.2667; val_global_loss: 25074076.4000; val_optim_loss: 25074076.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9411; val_auprc_score: 0.9262; val_best_acc_score: 0.8820; val_best_f1_score: 0.8897; train_kl_reg_loss: 93721.3873; train_edge_recon_loss: 2759264.7481; train_gene_expr_recon_loss: 11792695.0229; train_masked_gp_l1_reg_loss: 127336.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83372.6769; train_chrom_access_recon_loss: 10143133.2977; train_global_loss: 24999523.6947; train_optim_loss: 24999523.6947; val_kl_reg_loss: 94398.5312; val_edge_recon_loss: 2745033.6500; val_gene_expr_recon_loss: 11908515.7333; val_masked_gp_l1_reg_loss: 127224.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82506.7109; val_chrom_access_recon_loss: 10018568.0667; val_global_loss: 24976247.0667; val_optim_loss: 24976247.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9487; val_auprc_score: 0.9359; val_best_acc_score: 0.8855; val_best_f1_score: 0.8910; train_kl_reg_loss: 92137.3204; train_edge_recon_loss: 2752523.5344; train_gene_expr_recon_loss: 11737419.4962; train_masked_gp_l1_reg_loss: 127758.8789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82393.8195; train_chrom_access_recon_loss: 10101331.4962; train_global_loss: 24893564.5191; train_optim_loss: 24893564.5191; val_kl_reg_loss: 93119.9594; val_edge_recon_loss: 2753106.8667; val_gene_expr_recon_loss: 11851301.9333; val_masked_gp_l1_reg_loss: 128117.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81967.2734; val_chrom_access_recon_loss: 10002779.6667; val_global_loss: 24910393.6000; val_optim_loss: 24910393.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9518; val_auprc_score: 0.9394; val_best_acc_score: 0.8930; val_best_f1_score: 0.8975; train_kl_reg_loss: 91995.6577; train_edge_recon_loss: 2747854.1698; train_gene_expr_recon_loss: 11683980.6870; train_masked_gp_l1_reg_loss: 127906.0847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81346.5978; train_chrom_access_recon_loss: 10044883.7481; train_global_loss: 24777966.9313; train_optim_loss: 24777966.9313; val_kl_reg_loss: 91855.2630; val_edge_recon_loss: 2751363.2333; val_gene_expr_recon_loss: 11729759.8667; val_masked_gp_l1_reg_loss: 128317.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81801.6172; val_chrom_access_recon_loss: 9893105.5333; val_global_loss: 24676203.7333; val_optim_loss: 24676203.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9538; val_auprc_score: 0.9391; val_best_acc_score: 0.8950; val_best_f1_score: 0.9002; train_kl_reg_loss: 90539.9112; train_edge_recon_loss: 2747464.1947; train_gene_expr_recon_loss: 11652152.6718; train_masked_gp_l1_reg_loss: 128184.6245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80466.3812; train_chrom_access_recon_loss: 10016481.5725; train_global_loss: 24715289.4351; train_optim_loss: 24715289.4351; val_kl_reg_loss: 89267.8005; val_edge_recon_loss: 2727003.2333; val_gene_expr_recon_loss: 11771110.8667; val_masked_gp_l1_reg_loss: 128292.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80424.6250; val_chrom_access_recon_loss: 9896218.5333; val_global_loss: 24692318.2667; val_optim_loss: 24692318.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9538; val_auprc_score: 0.9431; val_best_acc_score: 0.8919; val_best_f1_score: 0.8963; train_kl_reg_loss: 88975.3422; train_edge_recon_loss: 2736391.1221; train_gene_expr_recon_loss: 11599265.2061; train_masked_gp_l1_reg_loss: 128355.3445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79584.6380; train_chrom_access_recon_loss: 9957488.8168; train_global_loss: 24590060.3206; train_optim_loss: 24590060.3206; val_kl_reg_loss: 91224.8234; val_edge_recon_loss: 2749003.2500; val_gene_expr_recon_loss: 11650066.4000; val_masked_gp_l1_reg_loss: 128590.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79358.2344; val_chrom_access_recon_loss: 9862048.9333; val_global_loss: 24560292.5333; val_optim_loss: 24560292.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9599; val_auprc_score: 0.9502; val_best_acc_score: 0.8979; val_best_f1_score: 0.9022; train_kl_reg_loss: 89609.3491; train_edge_recon_loss: 2732448.8435; train_gene_expr_recon_loss: 11570996.4198; train_masked_gp_l1_reg_loss: 128191.9674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78839.9248; train_chrom_access_recon_loss: 9930138.3817; train_global_loss: 24530224.8244; train_optim_loss: 24530224.8244; val_kl_reg_loss: 88538.3141; val_edge_recon_loss: 2739631.4833; val_gene_expr_recon_loss: 11661579.4000; val_masked_gp_l1_reg_loss: 128579.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78436.5469; val_chrom_access_recon_loss: 9846557.4667; val_global_loss: 24543322.8000; val_optim_loss: 24543322.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9588; val_auprc_score: 0.9466; val_best_acc_score: 0.9025; val_best_f1_score: 0.9050; train_kl_reg_loss: 88932.9344; train_edge_recon_loss: 2722832.1240; train_gene_expr_recon_loss: 11540785.9618; train_masked_gp_l1_reg_loss: 128137.5805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78276.2839; train_chrom_access_recon_loss: 9893437.8931; train_global_loss: 24452402.7786; train_optim_loss: 24452402.7786; val_kl_reg_loss: 88238.4703; val_edge_recon_loss: 2743350.7167; val_gene_expr_recon_loss: 11635540.0667; val_masked_gp_l1_reg_loss: 128517.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78348.7109; val_chrom_access_recon_loss: 9797659.8667; val_global_loss: 24471654.9333; val_optim_loss: 24471654.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9617; val_auprc_score: 0.9518; val_best_acc_score: 0.9092; val_best_f1_score: 0.9127; train_kl_reg_loss: 88056.7773; train_edge_recon_loss: 2722449.8607; train_gene_expr_recon_loss: 11508427.9618; train_masked_gp_l1_reg_loss: 128108.7819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77775.2253; train_chrom_access_recon_loss: 9856541.7328; train_global_loss: 24381360.3359; train_optim_loss: 24381360.3359; val_kl_reg_loss: 88616.1146; val_edge_recon_loss: 2734234.8167; val_gene_expr_recon_loss: 11605720.1333; val_masked_gp_l1_reg_loss: 127954.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77679.3359; val_chrom_access_recon_loss: 9753570.1333; val_global_loss: 24387775.3333; val_optim_loss: 24387775.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9629; val_auprc_score: 0.9527; val_best_acc_score: 0.9093; val_best_f1_score: 0.9135; train_kl_reg_loss: 87090.9247; train_edge_recon_loss: 2720306.8740; train_gene_expr_recon_loss: 11492666.4351; train_masked_gp_l1_reg_loss: 127982.1068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77389.6112; train_chrom_access_recon_loss: 9848178.4809; train_global_loss: 24353614.5038; train_optim_loss: 24353614.5038; val_kl_reg_loss: 88131.7724; val_edge_recon_loss: 2742556.1000; val_gene_expr_recon_loss: 11549047.7333; val_masked_gp_l1_reg_loss: 127835.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77118.2500; val_chrom_access_recon_loss: 9706505.1333; val_global_loss: 24291193.4667; val_optim_loss: 24291193.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9650; val_auprc_score: 0.9545; val_best_acc_score: 0.9127; val_best_f1_score: 0.9153; train_kl_reg_loss: 86852.5439; train_edge_recon_loss: 2717455.8874; train_gene_expr_recon_loss: 11459218.6412; train_masked_gp_l1_reg_loss: 127623.6751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76814.5865; train_chrom_access_recon_loss: 9796879.4046; train_global_loss: 24264844.6107; train_optim_loss: 24264844.6107; val_kl_reg_loss: 84576.9359; val_edge_recon_loss: 2730250.7167; val_gene_expr_recon_loss: 11549249.3333; val_masked_gp_l1_reg_loss: 128152.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77494.2656; val_chrom_access_recon_loss: 9675365.7333; val_global_loss: 24245088.4000; val_optim_loss: 24245088.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9677; val_auprc_score: 0.9593; val_best_acc_score: 0.9135; val_best_f1_score: 0.9160; train_kl_reg_loss: 85248.5826; train_edge_recon_loss: 2710364.9523; train_gene_expr_recon_loss: 11444426.0229; train_masked_gp_l1_reg_loss: 127804.8334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76719.9403; train_chrom_access_recon_loss: 9771798.5802; train_global_loss: 24216362.9466; train_optim_loss: 24216362.9466; val_kl_reg_loss: 87601.2630; val_edge_recon_loss: 2718492.0000; val_gene_expr_recon_loss: 11481056.2667; val_masked_gp_l1_reg_loss: 127774.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76989.7891; val_chrom_access_recon_loss: 9632825.7333; val_global_loss: 24124740.8000; val_optim_loss: 24124740.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9662; val_auprc_score: 0.9522; val_best_acc_score: 0.9148; val_best_f1_score: 0.9178; train_kl_reg_loss: 86773.4690; train_edge_recon_loss: 2706719.2252; train_gene_expr_recon_loss: 11422394.9771; train_masked_gp_l1_reg_loss: 127449.6450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76507.3952; train_chrom_access_recon_loss: 9751574.6412; train_global_loss: 24171419.3435; train_optim_loss: 24171419.3435; val_kl_reg_loss: 87726.3745; val_edge_recon_loss: 2731538.2333; val_gene_expr_recon_loss: 11500788.6667; val_masked_gp_l1_reg_loss: 127344.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75966.8906; val_chrom_access_recon_loss: 9657488.2667; val_global_loss: 24180852.2667; val_optim_loss: 24180852.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9740; val_auprc_score: 0.9666; val_best_acc_score: 0.9254; val_best_f1_score: 0.9283; train_kl_reg_loss: 85956.7274; train_edge_recon_loss: 2705509.5401; train_gene_expr_recon_loss: 11406251.5191; train_masked_gp_l1_reg_loss: 127098.3730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76249.3312; train_chrom_access_recon_loss: 9720263.0534; train_global_loss: 24121328.4580; train_optim_loss: 24121328.4580; val_kl_reg_loss: 86066.6505; val_edge_recon_loss: 2709406.7167; val_gene_expr_recon_loss: 11438835.3333; val_masked_gp_l1_reg_loss: 127458.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76870.6172; val_chrom_access_recon_loss: 9637869.2000; val_global_loss: 24076508.2667; val_optim_loss: 24076508.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9705; val_auprc_score: 0.9617; val_best_acc_score: 0.9221; val_best_f1_score: 0.9251; train_kl_reg_loss: 85248.1175; train_edge_recon_loss: 2706501.6718; train_gene_expr_recon_loss: 11393245.3969; train_masked_gp_l1_reg_loss: 126824.8463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76523.9547; train_chrom_access_recon_loss: 9697485.2672; train_global_loss: 24085829.2824; train_optim_loss: 24085829.2824; val_kl_reg_loss: 83376.4245; val_edge_recon_loss: 2718179.0333; val_gene_expr_recon_loss: 11440306.2667; val_masked_gp_l1_reg_loss: 126756.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76951.8906; val_chrom_access_recon_loss: 9590400.5333; val_global_loss: 24035970.0000; val_optim_loss: 24035970.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9708; val_auprc_score: 0.9616; val_best_acc_score: 0.9225; val_best_f1_score: 0.9244; train_kl_reg_loss: 85388.9763; train_edge_recon_loss: 2703164.8034; train_gene_expr_recon_loss: 11373311.5954; train_masked_gp_l1_reg_loss: 126395.9876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76618.7535; train_chrom_access_recon_loss: 9685202.5802; train_global_loss: 24050082.7939; train_optim_loss: 24050082.7939; val_kl_reg_loss: 87287.2781; val_edge_recon_loss: 2714318.6000; val_gene_expr_recon_loss: 11466431.5333; val_masked_gp_l1_reg_loss: 126286.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76936.5312; val_chrom_access_recon_loss: 9605780.6000; val_global_loss: 24077042.2667; val_optim_loss: 24077042.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9737; val_auprc_score: 0.9638; val_best_acc_score: 0.9263; val_best_f1_score: 0.9291; train_kl_reg_loss: 85719.3705; train_edge_recon_loss: 2705118.1947; train_gene_expr_recon_loss: 11361425.2595; train_masked_gp_l1_reg_loss: 125839.1591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76884.5432; train_chrom_access_recon_loss: 9650480.8855; train_global_loss: 24005467.4504; train_optim_loss: 24005467.4504; val_kl_reg_loss: 87513.3417; val_edge_recon_loss: 2706222.3500; val_gene_expr_recon_loss: 11470760.4000; val_masked_gp_l1_reg_loss: 125641.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77029.9844; val_chrom_access_recon_loss: 9571536.2000; val_global_loss: 24038704.0000; val_optim_loss: 24038704.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9738; val_auprc_score: 0.9656; val_best_acc_score: 0.9278; val_best_f1_score: 0.9301; train_kl_reg_loss: 84873.2133; train_edge_recon_loss: 2699753.2500; train_gene_expr_recon_loss: 11353201.4046; train_masked_gp_l1_reg_loss: 125103.0510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77090.9935; train_chrom_access_recon_loss: 9637827.7557; train_global_loss: 23977849.6031; train_optim_loss: 23977849.6031; val_kl_reg_loss: 82907.7448; val_edge_recon_loss: 2708088.8500; val_gene_expr_recon_loss: 11436802.2000; val_masked_gp_l1_reg_loss: 124807.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77564.6719; val_chrom_access_recon_loss: 9562521.0667; val_global_loss: 23992691.6000; val_optim_loss: 23992691.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9753; val_auprc_score: 0.9690; val_best_acc_score: 0.9287; val_best_f1_score: 0.9305; train_kl_reg_loss: 84264.7270; train_edge_recon_loss: 2698830.0649; train_gene_expr_recon_loss: 11335329.0763; train_masked_gp_l1_reg_loss: 124426.7465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77642.5190; train_chrom_access_recon_loss: 9607000.4275; train_global_loss: 23927493.7252; train_optim_loss: 23927493.7252; val_kl_reg_loss: 84896.5672; val_edge_recon_loss: 2714220.7833; val_gene_expr_recon_loss: 11320755.9333; val_masked_gp_l1_reg_loss: 124671.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77914.1953; val_chrom_access_recon_loss: 9483705.0000; val_global_loss: 23806164.4000; val_optim_loss: 23806164.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9754; val_auprc_score: 0.9684; val_best_acc_score: 0.9295; val_best_f1_score: 0.9323; train_kl_reg_loss: 84339.0985; train_edge_recon_loss: 2701467.1622; train_gene_expr_recon_loss: 11321427.0763; train_masked_gp_l1_reg_loss: 123932.4230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78024.4865; train_chrom_access_recon_loss: 9587116.5115; train_global_loss: 23896306.7634; train_optim_loss: 23896306.7634; val_kl_reg_loss: 85315.7990; val_edge_recon_loss: 2703923.3667; val_gene_expr_recon_loss: 11372951.1333; val_masked_gp_l1_reg_loss: 123669.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77977.7109; val_chrom_access_recon_loss: 9521953.8667; val_global_loss: 23885791.2000; val_optim_loss: 23885791.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9737; val_auprc_score: 0.9667; val_best_acc_score: 0.9263; val_best_f1_score: 0.9295; train_kl_reg_loss: 83124.3216; train_edge_recon_loss: 2698543.6756; train_gene_expr_recon_loss: 11309578.7405; train_masked_gp_l1_reg_loss: 123068.5806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78449.0814; train_chrom_access_recon_loss: 9569855.2977; train_global_loss: 23862619.6489; train_optim_loss: 23862619.6489; val_kl_reg_loss: 84901.8885; val_edge_recon_loss: 2708565.5000; val_gene_expr_recon_loss: 11356158.8000; val_masked_gp_l1_reg_loss: 122659.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78460.4766; val_chrom_access_recon_loss: 9459994.6000; val_global_loss: 23810740.6667; val_optim_loss: 23810740.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9780; val_auprc_score: 0.9733; val_best_acc_score: 0.9313; val_best_f1_score: 0.9337; train_kl_reg_loss: 84759.4668; train_edge_recon_loss: 2692641.6221; train_gene_expr_recon_loss: 11296736.5115; train_masked_gp_l1_reg_loss: 122377.1717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78971.8095; train_chrom_access_recon_loss: 9549133.8015; train_global_loss: 23824620.4733; train_optim_loss: 23824620.4733; val_kl_reg_loss: 85915.3083; val_edge_recon_loss: 2708275.5667; val_gene_expr_recon_loss: 11371595.8667; val_masked_gp_l1_reg_loss: 121984.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79092.6094; val_chrom_access_recon_loss: 9453497.7333; val_global_loss: 23820362.6667; val_optim_loss: 23820362.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9776; val_auprc_score: 0.9695; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 84324.8887; train_edge_recon_loss: 2694003.7443; train_gene_expr_recon_loss: 11282854.2977; train_masked_gp_l1_reg_loss: 121611.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79174.3603; train_chrom_access_recon_loss: 9529490.3893; train_global_loss: 23791458.9618; train_optim_loss: 23791458.9618; val_kl_reg_loss: 84117.5875; val_edge_recon_loss: 2686718.7000; val_gene_expr_recon_loss: 11395685.7333; val_masked_gp_l1_reg_loss: 121070.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79419.9453; val_chrom_access_recon_loss: 9503840.6000; val_global_loss: 23870853.6000; val_optim_loss: 23870853.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9777; val_auprc_score: 0.9709; val_best_acc_score: 0.9313; val_best_f1_score: 0.9331; train_kl_reg_loss: 84569.8333; train_edge_recon_loss: 2695870.7500; train_gene_expr_recon_loss: 11280793.7405; train_masked_gp_l1_reg_loss: 115783.6768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61254.7413; train_chrom_access_recon_loss: 9511195.6107; train_global_loss: 23749468.3817; train_optim_loss: 23749468.3817; val_kl_reg_loss: 87041.8693; val_edge_recon_loss: 2694565.3833; val_gene_expr_recon_loss: 11389012.8000; val_masked_gp_l1_reg_loss: 114682.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59018.9375; val_chrom_access_recon_loss: 9481905.4667; val_global_loss: 23826226.5333; val_optim_loss: 23826226.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9763; val_auprc_score: 0.9696; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 86262.7944; train_edge_recon_loss: 2692849.5992; train_gene_expr_recon_loss: 11264981.7710; train_masked_gp_l1_reg_loss: 114481.0290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58544.3072; train_chrom_access_recon_loss: 9484497.0229; train_global_loss: 23701616.5496; train_optim_loss: 23701616.5496; val_kl_reg_loss: 88853.3432; val_edge_recon_loss: 2701158.9833; val_gene_expr_recon_loss: 11387938.8667; val_masked_gp_l1_reg_loss: 114399.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58323.3164; val_chrom_access_recon_loss: 9504542.7333; val_global_loss: 23855216.1333; val_optim_loss: 23855216.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9733; val_auprc_score: 0.9649; val_best_acc_score: 0.9285; val_best_f1_score: 0.9302; train_kl_reg_loss: 87319.2083; train_edge_recon_loss: 2685355.6737; train_gene_expr_recon_loss: 11274380.2748; train_masked_gp_l1_reg_loss: 114272.5394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58082.3699; train_chrom_access_recon_loss: 9505681.3435; train_global_loss: 23725091.4504; train_optim_loss: 23725091.4504; val_kl_reg_loss: 88684.3354; val_edge_recon_loss: 2720251.3833; val_gene_expr_recon_loss: 11355429.1333; val_masked_gp_l1_reg_loss: 114187.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57906.8906; val_chrom_access_recon_loss: 9476246.0000; val_global_loss: 23812706.2667; val_optim_loss: 23812706.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9746; val_auprc_score: 0.9677; val_best_acc_score: 0.9262; val_best_f1_score: 0.9286; train_kl_reg_loss: 87121.9867; train_edge_recon_loss: 2683447.1584; train_gene_expr_recon_loss: 11261457.1374; train_masked_gp_l1_reg_loss: 114108.6650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57699.9498; train_chrom_access_recon_loss: 9486034.4733; train_global_loss: 23689869.5267; train_optim_loss: 23689869.5267; val_kl_reg_loss: 89053.4286; val_edge_recon_loss: 2697920.9000; val_gene_expr_recon_loss: 11382885.7333; val_masked_gp_l1_reg_loss: 114040.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57593.7891; val_chrom_access_recon_loss: 9480115.3333; val_global_loss: 23821610.1333; val_optim_loss: 23821610.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 26 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9763
val AUPRC score: 0.9702
val best accuracy score: 0.9314
val best F1 score: 0.9331
val target rna MSE score: 1.2615
val source rna MSE score: 0.5466
val target atac MSE score: 0.3310
val source atac MSE score: 0.0981
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
