[True]
Run timestamp: 26072023_035056_142.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_142']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9369; val_auprc_score: 0.9453; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 10812.5582; train_edge_recon_loss: 34737856.8889; train_gene_expr_recon_loss: 3165785.3889; train_masked_gp_l1_reg_loss: 1866.7796; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108753409.7778; train_global_loss: 146669733.3333; train_optim_loss: 146669733.3333; val_kl_reg_loss: 15274.8828; val_edge_recon_loss: 40647496.0000; val_gene_expr_recon_loss: 3098053.2500; val_masked_gp_l1_reg_loss: 1889.6013; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107218816.0000; val_global_loss: 150981536.0000; val_optim_loss: 150981536.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9066; val_auprc_score: 0.9158; val_best_acc_score: 0.5159; val_best_f1_score: 0.6737; train_kl_reg_loss: 35871.5629; train_edge_recon_loss: 34833866.6667; train_gene_expr_recon_loss: 3079078.9722; train_masked_gp_l1_reg_loss: 1980.8507; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107992935.1111; train_global_loss: 145943735.1111; train_optim_loss: 145943735.1111; val_kl_reg_loss: 32379.9004; val_edge_recon_loss: 40641100.0000; val_gene_expr_recon_loss: 2934106.5000; val_masked_gp_l1_reg_loss: 2131.0625; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105737200.0000; val_global_loss: 149346912.0000; val_optim_loss: 149346912.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8859; val_auprc_score: 0.8981; val_best_acc_score: 0.5109; val_best_f1_score: 0.6715; train_kl_reg_loss: 89770.0499; train_edge_recon_loss: 34818257.7778; train_gene_expr_recon_loss: 2841327.8056; train_masked_gp_l1_reg_loss: 2291.3879; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105274441.7778; train_global_loss: 143026088.8889; train_optim_loss: 143026088.8889; val_kl_reg_loss: 135256.2188; val_edge_recon_loss: 40647136.0000; val_gene_expr_recon_loss: 2723988.7500; val_masked_gp_l1_reg_loss: 2494.9722; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103692760.0000; val_global_loss: 147201632.0000; val_optim_loss: 147201632.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9043; val_auprc_score: 0.9141; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 188039.3125; train_edge_recon_loss: 34829192.8889; train_gene_expr_recon_loss: 2655176.5278; train_masked_gp_l1_reg_loss: 2633.0013; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102992593.7778; train_global_loss: 140667637.3333; train_optim_loss: 140667637.3333; val_kl_reg_loss: 289132.1562; val_edge_recon_loss: 40653212.0000; val_gene_expr_recon_loss: 2553413.7500; val_masked_gp_l1_reg_loss: 2780.6592; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101910112.0000; val_global_loss: 145408640.0000; val_optim_loss: 145408640.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9139; val_auprc_score: 0.9190; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 250062.9618; train_edge_recon_loss: 34811493.3333; train_gene_expr_recon_loss: 2502684.3889; train_masked_gp_l1_reg_loss: 2860.4962; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101128580.4444; train_global_loss: 138695681.7778; train_optim_loss: 138695681.7778; val_kl_reg_loss: 229547.8750; val_edge_recon_loss: 40651624.0000; val_gene_expr_recon_loss: 2433246.7500; val_masked_gp_l1_reg_loss: 2937.1489; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100763688.0000; val_global_loss: 144081040.0000; val_optim_loss: 144081040.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9193; val_auprc_score: 0.9209; val_best_acc_score: 0.5051; val_best_f1_score: 0.6689; train_kl_reg_loss: 272301.9983; train_edge_recon_loss: 34830712.8889; train_gene_expr_recon_loss: 2392937.6111; train_masked_gp_l1_reg_loss: 2968.7537; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99818168.0000; train_global_loss: 137317088.0000; train_optim_loss: 137317088.0000; val_kl_reg_loss: 355843.8750; val_edge_recon_loss: 40648892.0000; val_gene_expr_recon_loss: 2344213.5000; val_masked_gp_l1_reg_loss: 2993.0537; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99677864.0000; val_global_loss: 143029808.0000; val_optim_loss: 143029808.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9110; val_auprc_score: 0.9106; val_best_acc_score: 0.5057; val_best_f1_score: 0.6691; train_kl_reg_loss: 348786.7986; train_edge_recon_loss: 34809429.3333; train_gene_expr_recon_loss: 2322067.9444; train_masked_gp_l1_reg_loss: 2993.8954; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99428576.0000; train_global_loss: 136911848.8889; train_optim_loss: 136911848.8889; val_kl_reg_loss: 200528.8438; val_edge_recon_loss: 40644184.0000; val_gene_expr_recon_loss: 2290742.0000; val_masked_gp_l1_reg_loss: 2984.8970; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98811088.0000; val_global_loss: 141949536.0000; val_optim_loss: 141949536.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9043; val_auprc_score: 0.9036; val_best_acc_score: 0.5098; val_best_f1_score: 0.6710; train_kl_reg_loss: 354151.2257; train_edge_recon_loss: 34849703.5556; train_gene_expr_recon_loss: 2262693.5000; train_masked_gp_l1_reg_loss: 2970.4842; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98187854.2222; train_global_loss: 135657370.6667; train_optim_loss: 135657370.6667; val_kl_reg_loss: 338291.0000; val_edge_recon_loss: 40641180.0000; val_gene_expr_recon_loss: 2235159.7500; val_masked_gp_l1_reg_loss: 2949.1880; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98172640.0000; val_global_loss: 141390224.0000; val_optim_loss: 141390224.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9077; val_auprc_score: 0.9067; val_best_acc_score: 0.5154; val_best_f1_score: 0.6734; train_kl_reg_loss: 361688.7847; train_edge_recon_loss: 34867918.2222; train_gene_expr_recon_loss: 2216144.1389; train_masked_gp_l1_reg_loss: 2931.3599; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97918878.2222; train_global_loss: 135367562.6667; train_optim_loss: 135367562.6667; val_kl_reg_loss: 235133.8438; val_edge_recon_loss: 40634724.0000; val_gene_expr_recon_loss: 2208216.2500; val_masked_gp_l1_reg_loss: 2910.5310; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97887496.0000; val_global_loss: 140968480.0000; val_optim_loss: 140968480.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9043; val_auprc_score: 0.9002; val_best_acc_score: 0.5353; val_best_f1_score: 0.6825; train_kl_reg_loss: 349260.1910; train_edge_recon_loss: 34872898.2222; train_gene_expr_recon_loss: 2209369.1944; train_masked_gp_l1_reg_loss: 2892.2657; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98016733.3333; train_global_loss: 135451153.7778; train_optim_loss: 135451153.7778; val_kl_reg_loss: 257634.4375; val_edge_recon_loss: 40626928.0000; val_gene_expr_recon_loss: 2192630.7500; val_masked_gp_l1_reg_loss: 2868.5535; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97739536.0000; val_global_loss: 140819600.0000; val_optim_loss: 140819600.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8983; val_auprc_score: 0.8975; val_best_acc_score: 0.5565; val_best_f1_score: 0.6923; train_kl_reg_loss: 336832.2760; train_edge_recon_loss: 34887981.7778; train_gene_expr_recon_loss: 2173307.7778; train_masked_gp_l1_reg_loss: 2852.6111; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97199826.6667; train_global_loss: 134600800.8889; train_optim_loss: 134600800.8889; val_kl_reg_loss: 314065.1875; val_edge_recon_loss: 40619628.0000; val_gene_expr_recon_loss: 2169053.0000; val_masked_gp_l1_reg_loss: 2831.1533; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97462472.0000; val_global_loss: 140568048.0000; val_optim_loss: 140568048.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8996; val_auprc_score: 0.8968; val_best_acc_score: 0.5930; val_best_f1_score: 0.7099; train_kl_reg_loss: 348147.3125; train_edge_recon_loss: 34859310.2222; train_gene_expr_recon_loss: 2177985.2222; train_masked_gp_l1_reg_loss: 2814.2431; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98006119.1111; train_global_loss: 135394376.8889; train_optim_loss: 135394376.8889; val_kl_reg_loss: 225757.6094; val_edge_recon_loss: 40605624.0000; val_gene_expr_recon_loss: 2163413.5000; val_masked_gp_l1_reg_loss: 2792.8225; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97442520.0000; val_global_loss: 140440096.0000; val_optim_loss: 140440096.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9031; val_auprc_score: 0.8949; val_best_acc_score: 0.6401; val_best_f1_score: 0.7334; train_kl_reg_loss: 338675.0017; train_edge_recon_loss: 34883951.1111; train_gene_expr_recon_loss: 2168209.1667; train_masked_gp_l1_reg_loss: 2779.0256; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97478038.2222; train_global_loss: 134871649.7778; train_optim_loss: 134871649.7778; val_kl_reg_loss: 253973.8438; val_edge_recon_loss: 40587412.0000; val_gene_expr_recon_loss: 2150685.0000; val_masked_gp_l1_reg_loss: 2763.0112; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97279480.0000; val_global_loss: 140274304.0000; val_optim_loss: 140274304.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9061; val_auprc_score: 0.9030; val_best_acc_score: 0.6897; val_best_f1_score: 0.7598; train_kl_reg_loss: 316776.4878; train_edge_recon_loss: 34876339.1111; train_gene_expr_recon_loss: 2141574.8611; train_masked_gp_l1_reg_loss: 2752.8707; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96823745.7778; train_global_loss: 134161189.3333; train_optim_loss: 134161189.3333; val_kl_reg_loss: 253228.2812; val_edge_recon_loss: 40558684.0000; val_gene_expr_recon_loss: 2147121.2500; val_masked_gp_l1_reg_loss: 2740.0540; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97148816.0000; val_global_loss: 140110592.0000; val_optim_loss: 140110592.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9001; val_auprc_score: 0.8913; val_best_acc_score: 0.7610; val_best_f1_score: 0.8001; train_kl_reg_loss: 323464.9983; train_edge_recon_loss: 34856028.4444; train_gene_expr_recon_loss: 2142211.9444; train_masked_gp_l1_reg_loss: 2732.9488; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96990916.4444; train_global_loss: 134315354.6667; train_optim_loss: 134315354.6667; val_kl_reg_loss: 285782.6250; val_edge_recon_loss: 40504472.0000; val_gene_expr_recon_loss: 2136527.2500; val_masked_gp_l1_reg_loss: 2723.5767; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97065624.0000; val_global_loss: 139995136.0000; val_optim_loss: 139995136.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9082; val_auprc_score: 0.9027; val_best_acc_score: 0.8107; val_best_f1_score: 0.8293; train_kl_reg_loss: 309323.3125; train_edge_recon_loss: 34845216.4444; train_gene_expr_recon_loss: 2142666.1944; train_masked_gp_l1_reg_loss: 2720.6715; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97094525.3333; train_global_loss: 134394452.4444; train_optim_loss: 134394452.4444; val_kl_reg_loss: 260310.2188; val_edge_recon_loss: 40428560.0000; val_gene_expr_recon_loss: 2129601.2500; val_masked_gp_l1_reg_loss: 2713.6523; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96866520.0000; val_global_loss: 139687712.0000; val_optim_loss: 139687712.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9140; val_auprc_score: 0.9051; val_best_acc_score: 0.8397; val_best_f1_score: 0.8421; train_kl_reg_loss: 308722.2431; train_edge_recon_loss: 34801631.5556; train_gene_expr_recon_loss: 2141451.6389; train_masked_gp_l1_reg_loss: 2709.6960; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97097365.3333; train_global_loss: 134351881.7778; train_optim_loss: 134351881.7778; val_kl_reg_loss: 217485.5625; val_edge_recon_loss: 40280492.0000; val_gene_expr_recon_loss: 2127399.2500; val_masked_gp_l1_reg_loss: 2702.9990; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96794744.0000; val_global_loss: 139422816.0000; val_optim_loss: 139422816.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9071; val_auprc_score: 0.8928; val_best_acc_score: 0.8192; val_best_f1_score: 0.8064; train_kl_reg_loss: 306381.3715; train_edge_recon_loss: 34741957.7778; train_gene_expr_recon_loss: 2119148.9306; train_masked_gp_l1_reg_loss: 2699.8526; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96539968.8889; train_global_loss: 133710156.4444; train_optim_loss: 133710156.4444; val_kl_reg_loss: 230905.8438; val_edge_recon_loss: 39975660.0000; val_gene_expr_recon_loss: 2125791.7500; val_masked_gp_l1_reg_loss: 2695.4531; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96803120.0000; val_global_loss: 139138176.0000; val_optim_loss: 139138176.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9042; val_auprc_score: 0.8916; val_best_acc_score: 0.7963; val_best_f1_score: 0.8227; train_kl_reg_loss: 288587.6580; train_edge_recon_loss: 34665168.4444; train_gene_expr_recon_loss: 2113911.5833; train_masked_gp_l1_reg_loss: 2695.0617; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96452926.2222; train_global_loss: 133523288.0000; train_optim_loss: 133523288.0000; val_kl_reg_loss: 278841.3438; val_edge_recon_loss: 39430220.0000; val_gene_expr_recon_loss: 2120418.7500; val_masked_gp_l1_reg_loss: 2693.5779; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96575728.0000; val_global_loss: 138407904.0000; val_optim_loss: 138407904.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9040; val_auprc_score: 0.8911; val_best_acc_score: 0.8248; val_best_f1_score: 0.8309; train_kl_reg_loss: 276750.8455; train_edge_recon_loss: 34487300.4444; train_gene_expr_recon_loss: 2120362.8056; train_masked_gp_l1_reg_loss: 2694.9354; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96549314.6667; train_global_loss: 133436424.8889; train_optim_loss: 133436424.8889; val_kl_reg_loss: 217449.7500; val_edge_recon_loss: 38238252.0000; val_gene_expr_recon_loss: 2125848.2500; val_masked_gp_l1_reg_loss: 2695.4285; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96625528.0000; val_global_loss: 137209776.0000; val_optim_loss: 137209776.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9168; val_auprc_score: 0.9007; val_best_acc_score: 0.8436; val_best_f1_score: 0.8535; train_kl_reg_loss: 230466.4792; train_edge_recon_loss: 34123953.7778; train_gene_expr_recon_loss: 2127704.3333; train_masked_gp_l1_reg_loss: 2701.8888; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96509653.3333; train_global_loss: 132994479.1111; train_optim_loss: 132994479.1111; val_kl_reg_loss: 153668.4062; val_edge_recon_loss: 35545756.0000; val_gene_expr_recon_loss: 2140836.7500; val_masked_gp_l1_reg_loss: 2710.4170; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96752224.0000; val_global_loss: 134595200.0000; val_optim_loss: 134595200.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9101; val_auprc_score: 0.8941; val_best_acc_score: 0.8345; val_best_f1_score: 0.8443; train_kl_reg_loss: 124752.5547; train_edge_recon_loss: 32688160.0000; train_gene_expr_recon_loss: 2165234.8611; train_masked_gp_l1_reg_loss: 2728.7303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96487835.5556; train_global_loss: 131468713.7778; train_optim_loss: 131468713.7778; val_kl_reg_loss: 77012.8750; val_edge_recon_loss: 30861926.0000; val_gene_expr_recon_loss: 2207926.0000; val_masked_gp_l1_reg_loss: 2757.3828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97142640.0000; val_global_loss: 130292264.0000; val_optim_loss: 130292264.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9050; val_auprc_score: 0.8872; val_best_acc_score: 0.8285; val_best_f1_score: 0.8410; train_kl_reg_loss: 108660.5686; train_edge_recon_loss: 29721008.4444; train_gene_expr_recon_loss: 2214178.1111; train_masked_gp_l1_reg_loss: 2802.9974; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96963358.2222; train_global_loss: 129010008.8889; train_optim_loss: 129010008.8889; val_kl_reg_loss: 161196.1875; val_edge_recon_loss: 28888082.0000; val_gene_expr_recon_loss: 2230271.0000; val_masked_gp_l1_reg_loss: 2863.9343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97150360.0000; val_global_loss: 128432768.0000; val_optim_loss: 128432768.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9085; val_auprc_score: 0.8856; val_best_acc_score: 0.8331; val_best_f1_score: 0.8435; train_kl_reg_loss: 179560.5191; train_edge_recon_loss: 28978619.3333; train_gene_expr_recon_loss: 2195702.2500; train_masked_gp_l1_reg_loss: 2909.1623; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97086603.5556; train_global_loss: 128443396.4444; train_optim_loss: 128443396.4444; val_kl_reg_loss: 148301.7188; val_edge_recon_loss: 28675988.0000; val_gene_expr_recon_loss: 2206052.0000; val_masked_gp_l1_reg_loss: 2951.7786; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96899752.0000; val_global_loss: 127933048.0000; val_optim_loss: 127933048.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9008; val_auprc_score: 0.8747; val_best_acc_score: 0.8282; val_best_f1_score: 0.8381; train_kl_reg_loss: 168296.2604; train_edge_recon_loss: 28596066.0000; train_gene_expr_recon_loss: 2186764.0556; train_masked_gp_l1_reg_loss: 2985.9388; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96299130.6667; train_global_loss: 127253242.6667; train_optim_loss: 127253242.6667; val_kl_reg_loss: 201221.9688; val_edge_recon_loss: 28460472.0000; val_gene_expr_recon_loss: 2183054.0000; val_masked_gp_l1_reg_loss: 3024.6646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96770800.0000; val_global_loss: 127618576.0000; val_optim_loss: 127618576.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9036; val_auprc_score: 0.8757; val_best_acc_score: 0.8323; val_best_f1_score: 0.8430; train_kl_reg_loss: 243030.6562; train_edge_recon_loss: 28687076.0000; train_gene_expr_recon_loss: 2189591.0833; train_masked_gp_l1_reg_loss: 3064.6240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96913509.3333; train_global_loss: 128036271.1111; train_optim_loss: 128036271.1111; val_kl_reg_loss: 137034.7812; val_edge_recon_loss: 28712854.0000; val_gene_expr_recon_loss: 2187217.0000; val_masked_gp_l1_reg_loss: 3108.7148; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96674912.0000; val_global_loss: 127715120.0000; val_optim_loss: 127715120.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9089; val_auprc_score: 0.8838; val_best_acc_score: 0.8355; val_best_f1_score: 0.8428; train_kl_reg_loss: 338410.8507; train_edge_recon_loss: 28290614.8889; train_gene_expr_recon_loss: 2159330.0417; train_masked_gp_l1_reg_loss: 3134.0343; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96075302.2222; train_global_loss: 126866791.1111; train_optim_loss: 126866791.1111; val_kl_reg_loss: 169478.8125; val_edge_recon_loss: 28220972.0000; val_gene_expr_recon_loss: 2163525.2500; val_masked_gp_l1_reg_loss: 3157.3262; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96389200.0000; val_global_loss: 126946336.0000; val_optim_loss: 126946336.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9103; val_auprc_score: 0.8856; val_best_acc_score: 0.8394; val_best_f1_score: 0.8471; train_kl_reg_loss: 388982.2431; train_edge_recon_loss: 28090688.0000; train_gene_expr_recon_loss: 2138716.0972; train_masked_gp_l1_reg_loss: 3168.5531; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95815719.1111; train_global_loss: 126437273.7778; train_optim_loss: 126437273.7778; val_kl_reg_loss: 181574.8125; val_edge_recon_loss: 28067202.0000; val_gene_expr_recon_loss: 2159227.5000; val_masked_gp_l1_reg_loss: 3178.6030; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96456168.0000; val_global_loss: 126867352.0000; val_optim_loss: 126867352.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9116; val_auprc_score: 0.8897; val_best_acc_score: 0.8378; val_best_f1_score: 0.8459; train_kl_reg_loss: 411638.5451; train_edge_recon_loss: 27884916.0000; train_gene_expr_recon_loss: 2138358.7500; train_masked_gp_l1_reg_loss: 3185.7017; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95998800.0000; train_global_loss: 126436897.7778; train_optim_loss: 126436897.7778; val_kl_reg_loss: 188271.9062; val_edge_recon_loss: 28059310.0000; val_gene_expr_recon_loss: 2149084.7500; val_masked_gp_l1_reg_loss: 3191.9058; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96231336.0000; val_global_loss: 126631192.0000; val_optim_loss: 126631192.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9149; val_auprc_score: 0.8892; val_best_acc_score: 0.8464; val_best_f1_score: 0.8540; train_kl_reg_loss: 431364.9826; train_edge_recon_loss: 27839580.8889; train_gene_expr_recon_loss: 2151651.3889; train_masked_gp_l1_reg_loss: 3196.3122; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96322123.5556; train_global_loss: 126747917.3333; train_optim_loss: 126747917.3333; val_kl_reg_loss: 194946.5000; val_edge_recon_loss: 28028724.0000; val_gene_expr_recon_loss: 2146128.2500; val_masked_gp_l1_reg_loss: 3200.5610; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96057464.0000; val_global_loss: 126430464.0000; val_optim_loss: 126430464.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9170; val_auprc_score: 0.8894; val_best_acc_score: 0.8508; val_best_f1_score: 0.8567; train_kl_reg_loss: 431821.0521; train_edge_recon_loss: 27690583.3333; train_gene_expr_recon_loss: 2139021.6111; train_masked_gp_l1_reg_loss: 3204.3845; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96243620.4444; train_global_loss: 126508250.6667; train_optim_loss: 126508250.6667; val_kl_reg_loss: 200723.8438; val_edge_recon_loss: 27795162.0000; val_gene_expr_recon_loss: 2140365.5000; val_masked_gp_l1_reg_loss: 3206.5500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96040552.0000; val_global_loss: 126180008.0000; val_optim_loss: 126180008.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9187; val_auprc_score: 0.8972; val_best_acc_score: 0.8480; val_best_f1_score: 0.8556; train_kl_reg_loss: 430703.5799; train_edge_recon_loss: 27699242.0000; train_gene_expr_recon_loss: 2122580.6389; train_masked_gp_l1_reg_loss: 3210.5709; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95275354.6667; train_global_loss: 125531091.5556; train_optim_loss: 125531091.5556; val_kl_reg_loss: 209756.1094; val_edge_recon_loss: 27943298.0000; val_gene_expr_recon_loss: 2133814.0000; val_masked_gp_l1_reg_loss: 3215.0728; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95968256.0000; val_global_loss: 126258336.0000; val_optim_loss: 126258336.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9199; val_auprc_score: 0.8938; val_best_acc_score: 0.8500; val_best_f1_score: 0.8594; train_kl_reg_loss: 429358.4653; train_edge_recon_loss: 27658726.6667; train_gene_expr_recon_loss: 2130665.2778; train_masked_gp_l1_reg_loss: 3219.1222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95740493.3333; train_global_loss: 125962463.1111; train_optim_loss: 125962463.1111; val_kl_reg_loss: 211995.8750; val_edge_recon_loss: 27747262.0000; val_gene_expr_recon_loss: 2135672.2500; val_masked_gp_l1_reg_loss: 3222.9668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96012776.0000; val_global_loss: 126110928.0000; val_optim_loss: 126110928.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9233; val_auprc_score: 0.8991; val_best_acc_score: 0.8565; val_best_f1_score: 0.8640; train_kl_reg_loss: 419688.4722; train_edge_recon_loss: 27666769.5556; train_gene_expr_recon_loss: 2116990.5417; train_masked_gp_l1_reg_loss: 3226.1434; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95544571.5556; train_global_loss: 125751246.2222; train_optim_loss: 125751246.2222; val_kl_reg_loss: 214451.3750; val_edge_recon_loss: 27658152.0000; val_gene_expr_recon_loss: 2122802.2500; val_masked_gp_l1_reg_loss: 3227.2383; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95804480.0000; val_global_loss: 125803112.0000; val_optim_loss: 125803112.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9271; val_auprc_score: 0.9076; val_best_acc_score: 0.8604; val_best_f1_score: 0.8689; train_kl_reg_loss: 406306.1528; train_edge_recon_loss: 27620867.1111; train_gene_expr_recon_loss: 2116123.1944; train_masked_gp_l1_reg_loss: 3229.3689; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94997413.3333; train_global_loss: 125143939.5556; train_optim_loss: 125143939.5556; val_kl_reg_loss: 207432.8750; val_edge_recon_loss: 27531112.0000; val_gene_expr_recon_loss: 2122992.2500; val_masked_gp_l1_reg_loss: 3230.9436; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95782536.0000; val_global_loss: 125647304.0000; val_optim_loss: 125647304.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9265; val_auprc_score: 0.9035; val_best_acc_score: 0.8603; val_best_f1_score: 0.8682; train_kl_reg_loss: 405166.6215; train_edge_recon_loss: 27448952.4444; train_gene_expr_recon_loss: 2110858.2222; train_masked_gp_l1_reg_loss: 3234.3478; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95175744.0000; train_global_loss: 125143955.5556; train_optim_loss: 125143955.5556; val_kl_reg_loss: 219127.1562; val_edge_recon_loss: 27444922.0000; val_gene_expr_recon_loss: 2122674.5000; val_masked_gp_l1_reg_loss: 3237.4370; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95775584.0000; val_global_loss: 125565544.0000; val_optim_loss: 125565544.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9324; val_auprc_score: 0.9101; val_best_acc_score: 0.8686; val_best_f1_score: 0.8762; train_kl_reg_loss: 399745.9549; train_edge_recon_loss: 27425522.6667; train_gene_expr_recon_loss: 2104181.9722; train_masked_gp_l1_reg_loss: 3241.7421; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95004408.8889; train_global_loss: 124937101.3333; train_optim_loss: 124937101.3333; val_kl_reg_loss: 223652.8281; val_edge_recon_loss: 27388596.0000; val_gene_expr_recon_loss: 2116895.2500; val_masked_gp_l1_reg_loss: 3246.3066; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95675408.0000; val_global_loss: 125407800.0000; val_optim_loss: 125407800.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9277; val_auprc_score: 0.9013; val_best_acc_score: 0.8643; val_best_f1_score: 0.8727; train_kl_reg_loss: 398846.0556; train_edge_recon_loss: 27476398.4444; train_gene_expr_recon_loss: 2111058.1111; train_masked_gp_l1_reg_loss: 3250.2150; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95363322.6667; train_global_loss: 125352875.5556; train_optim_loss: 125352875.5556; val_kl_reg_loss: 217150.3750; val_edge_recon_loss: 27580812.0000; val_gene_expr_recon_loss: 2114643.2500; val_masked_gp_l1_reg_loss: 3253.1929; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95520296.0000; val_global_loss: 125436160.0000; val_optim_loss: 125436160.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9315; val_auprc_score: 0.9097; val_best_acc_score: 0.8636; val_best_f1_score: 0.8719; train_kl_reg_loss: 393204.9931; train_edge_recon_loss: 27448134.8889; train_gene_expr_recon_loss: 2118960.3472; train_masked_gp_l1_reg_loss: 3255.0824; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95418490.6667; train_global_loss: 125382046.2222; train_optim_loss: 125382046.2222; val_kl_reg_loss: 212441.7812; val_edge_recon_loss: 27427014.0000; val_gene_expr_recon_loss: 2118054.2500; val_masked_gp_l1_reg_loss: 3257.0186; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95547432.0000; val_global_loss: 125308200.0000; val_optim_loss: 125308200.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9313; val_auprc_score: 0.9096; val_best_acc_score: 0.8674; val_best_f1_score: 0.8768; train_kl_reg_loss: 384683.0278; train_edge_recon_loss: 27531879.3333; train_gene_expr_recon_loss: 2103564.8194; train_masked_gp_l1_reg_loss: 3260.9672; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95182813.3333; train_global_loss: 125206200.8889; train_optim_loss: 125206200.8889; val_kl_reg_loss: 206542.0000; val_edge_recon_loss: 27459922.0000; val_gene_expr_recon_loss: 2116076.7500; val_masked_gp_l1_reg_loss: 3264.9175; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95562320.0000; val_global_loss: 125348128.0000; val_optim_loss: 125348128.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9289; val_auprc_score: 0.9060; val_best_acc_score: 0.8638; val_best_f1_score: 0.8725; train_kl_reg_loss: 382042.0174; train_edge_recon_loss: 27418105.7778; train_gene_expr_recon_loss: 2101528.1667; train_masked_gp_l1_reg_loss: 3269.1580; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95211179.5556; train_global_loss: 125116123.5556; train_optim_loss: 125116123.5556; val_kl_reg_loss: 202252.8125; val_edge_recon_loss: 27615568.0000; val_gene_expr_recon_loss: 2109897.5000; val_masked_gp_l1_reg_loss: 3273.3345; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95314784.0000; val_global_loss: 125245776.0000; val_optim_loss: 125245776.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9310; val_auprc_score: 0.9089; val_best_acc_score: 0.8686; val_best_f1_score: 0.8781; train_kl_reg_loss: 380863.5000; train_edge_recon_loss: 27341092.4444; train_gene_expr_recon_loss: 2106496.4306; train_masked_gp_l1_reg_loss: 3277.3935; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95116297.7778; train_global_loss: 124948026.6667; train_optim_loss: 124948026.6667; val_kl_reg_loss: 199783.8125; val_edge_recon_loss: 27511748.0000; val_gene_expr_recon_loss: 2126747.2500; val_masked_gp_l1_reg_loss: 3281.8723; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95480344.0000; val_global_loss: 125321904.0000; val_optim_loss: 125321904.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9393; val_auprc_score: 0.9205; val_best_acc_score: 0.8760; val_best_f1_score: 0.8838; train_kl_reg_loss: 380713.3299; train_edge_recon_loss: 27547951.7778; train_gene_expr_recon_loss: 2120198.5556; train_masked_gp_l1_reg_loss: 3286.7970; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94728755.5556; train_global_loss: 124780903.1111; train_optim_loss: 124780903.1111; val_kl_reg_loss: 193437.2031; val_edge_recon_loss: 27125486.0000; val_gene_expr_recon_loss: 2120858.7500; val_masked_gp_l1_reg_loss: 3291.3867; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95304416.0000; val_global_loss: 124747488.0000; val_optim_loss: 124747488.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9302; val_auprc_score: 0.9037; val_best_acc_score: 0.8709; val_best_f1_score: 0.8786; train_kl_reg_loss: 376854.2396; train_edge_recon_loss: 27473174.2222; train_gene_expr_recon_loss: 2118174.7222; train_masked_gp_l1_reg_loss: 3296.2751; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95048255.1111; train_global_loss: 125019755.5556; train_optim_loss: 125019755.5556; val_kl_reg_loss: 187010.2188; val_edge_recon_loss: 27560448.0000; val_gene_expr_recon_loss: 2111909.5000; val_masked_gp_l1_reg_loss: 3301.9937; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95209912.0000; val_global_loss: 125072584.0000; val_optim_loss: 125072584.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9304; val_auprc_score: 0.9073; val_best_acc_score: 0.8698; val_best_f1_score: 0.8763; train_kl_reg_loss: 377264.7292; train_edge_recon_loss: 27306282.2222; train_gene_expr_recon_loss: 2106583.8889; train_masked_gp_l1_reg_loss: 3305.7363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94938936.8889; train_global_loss: 124732374.2222; train_optim_loss: 124732374.2222; val_kl_reg_loss: 187465.3438; val_edge_recon_loss: 27806222.0000; val_gene_expr_recon_loss: 2108046.0000; val_masked_gp_l1_reg_loss: 3309.6963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95094432.0000; val_global_loss: 125199472.0000; val_optim_loss: 125199472.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9387; val_auprc_score: 0.9185; val_best_acc_score: 0.8774; val_best_f1_score: 0.8844; train_kl_reg_loss: 378740.0903; train_edge_recon_loss: 27374198.2222; train_gene_expr_recon_loss: 2093541.1250; train_masked_gp_l1_reg_loss: 3314.2626; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94931896.8889; train_global_loss: 124781690.6667; train_optim_loss: 124781690.6667; val_kl_reg_loss: 169208.4531; val_edge_recon_loss: 27418270.0000; val_gene_expr_recon_loss: 2109447.7500; val_masked_gp_l1_reg_loss: 3319.3340; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95043528.0000; val_global_loss: 124743776.0000; val_optim_loss: 124743776.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9408; val_auprc_score: 0.9215; val_best_acc_score: 0.8797; val_best_f1_score: 0.8858; train_kl_reg_loss: 380773.1389; train_edge_recon_loss: 27486124.6667; train_gene_expr_recon_loss: 2116169.6944; train_masked_gp_l1_reg_loss: 3325.7236; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95309800.0000; train_global_loss: 125296192.8889; train_optim_loss: 125296192.8889; val_kl_reg_loss: 182292.0312; val_edge_recon_loss: 27803352.0000; val_gene_expr_recon_loss: 2100432.2500; val_masked_gp_l1_reg_loss: 3332.3359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95195008.0000; val_global_loss: 125284416.0000; val_optim_loss: 125284416.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9361; val_auprc_score: 0.9124; val_best_acc_score: 0.8775; val_best_f1_score: 0.8843; train_kl_reg_loss: 334150.2882; train_edge_recon_loss: 27650334.2222; train_gene_expr_recon_loss: 2108536.4444; train_masked_gp_l1_reg_loss: 3335.3395; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94626093.3333; train_global_loss: 124722449.7778; train_optim_loss: 124722449.7778; val_kl_reg_loss: 139156.5781; val_edge_recon_loss: 27833260.0000; val_gene_expr_recon_loss: 2110873.5000; val_masked_gp_l1_reg_loss: 3340.8948; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95107904.0000; val_global_loss: 125194536.0000; val_optim_loss: 125194536.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9377; val_auprc_score: 0.9123; val_best_acc_score: 0.8795; val_best_f1_score: 0.8856; train_kl_reg_loss: 313336.4306; train_edge_recon_loss: 27675852.8889; train_gene_expr_recon_loss: 2100367.9028; train_masked_gp_l1_reg_loss: 3347.3506; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94453706.6667; train_global_loss: 124546610.6667; train_optim_loss: 124546610.6667; val_kl_reg_loss: 147931.7812; val_edge_recon_loss: 27768838.0000; val_gene_expr_recon_loss: 2105818.2500; val_masked_gp_l1_reg_loss: 3354.0571; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94938792.0000; val_global_loss: 124964736.0000; val_optim_loss: 124964736.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9371; val_auprc_score: 0.9143; val_best_acc_score: 0.8816; val_best_f1_score: 0.8863; train_kl_reg_loss: 327453.5868; train_edge_recon_loss: 27455381.7778; train_gene_expr_recon_loss: 2096052.2083; train_masked_gp_l1_reg_loss: 3360.2464; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94252234.6667; train_global_loss: 124134483.5556; train_optim_loss: 124134483.5556; val_kl_reg_loss: 162782.0312; val_edge_recon_loss: 27666512.0000; val_gene_expr_recon_loss: 2100682.7500; val_masked_gp_l1_reg_loss: 3366.8179; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94954456.0000; val_global_loss: 124887800.0000; val_optim_loss: 124887800.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9389; val_auprc_score: 0.9177; val_best_acc_score: 0.8816; val_best_f1_score: 0.8875; train_kl_reg_loss: 341706.8194; train_edge_recon_loss: 27507386.2222; train_gene_expr_recon_loss: 2086520.8333; train_masked_gp_l1_reg_loss: 3366.8561; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94395112.8889; train_global_loss: 124334091.5556; train_optim_loss: 124334091.5556; val_kl_reg_loss: 163823.8125; val_edge_recon_loss: 27440646.0000; val_gene_expr_recon_loss: 2097467.2500; val_masked_gp_l1_reg_loss: 3366.7981; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94904456.0000; val_global_loss: 124609760.0000; val_optim_loss: 124609760.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9406; val_auprc_score: 0.9200; val_best_acc_score: 0.8814; val_best_f1_score: 0.8875; train_kl_reg_loss: 338287.9722; train_edge_recon_loss: 27389274.6667; train_gene_expr_recon_loss: 2084025.6667; train_masked_gp_l1_reg_loss: 3366.6314; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 93998795.5556; train_global_loss: 123813748.4444; train_optim_loss: 123813748.4444; val_kl_reg_loss: 162884.2188; val_edge_recon_loss: 27474326.0000; val_gene_expr_recon_loss: 2099199.5000; val_masked_gp_l1_reg_loss: 3366.5405; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94891352.0000; val_global_loss: 124631128.0000; val_optim_loss: 124631128.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9420; val_auprc_score: 0.9247; val_best_acc_score: 0.8810; val_best_f1_score: 0.8869; train_kl_reg_loss: 338278.1562; train_edge_recon_loss: 27374064.2222; train_gene_expr_recon_loss: 2093791.7083; train_masked_gp_l1_reg_loss: 3366.6889; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94546216.0000; train_global_loss: 124355718.2222; train_optim_loss: 124355718.2222; val_kl_reg_loss: 164719.2500; val_edge_recon_loss: 27354666.0000; val_gene_expr_recon_loss: 2097788.0000; val_masked_gp_l1_reg_loss: 3366.9204; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94844752.0000; val_global_loss: 124465296.0000; val_optim_loss: 124465296.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9375; val_auprc_score: 0.9141; val_best_acc_score: 0.8793; val_best_f1_score: 0.8876; train_kl_reg_loss: 338463.1181; train_edge_recon_loss: 27444620.8889; train_gene_expr_recon_loss: 2093128.6111; train_masked_gp_l1_reg_loss: 3367.1651; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96638536.0000; train_global_loss: 126518115.5556; train_optim_loss: 126518115.5556; val_kl_reg_loss: 159478.1094; val_edge_recon_loss: 27601150.0000; val_gene_expr_recon_loss: 2094429.3750; val_masked_gp_l1_reg_loss: 3367.4146; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95157152.0000; val_global_loss: 125015576.0000; val_optim_loss: 125015576.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9379; val_auprc_score: 0.9122; val_best_acc_score: 0.8802; val_best_f1_score: 0.8874; train_kl_reg_loss: 333264.2396; train_edge_recon_loss: 27851208.8889; train_gene_expr_recon_loss: 2090020.0000; train_masked_gp_l1_reg_loss: 3367.1503; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94509694.2222; train_global_loss: 124787554.6667; train_optim_loss: 124787554.6667; val_kl_reg_loss: 150961.4688; val_edge_recon_loss: 27991640.0000; val_gene_expr_recon_loss: 2105917.5000; val_masked_gp_l1_reg_loss: 3366.7476; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94859696.0000; val_global_loss: 125111584.0000; val_optim_loss: 125111584.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9348; val_auprc_score: 0.9107; val_best_acc_score: 0.8750; val_best_f1_score: 0.8831; train_kl_reg_loss: 309820.7812; train_edge_recon_loss: 27872408.2222; train_gene_expr_recon_loss: 2100574.4722; train_masked_gp_l1_reg_loss: 3366.8933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94406916.4444; train_global_loss: 124693087.1111; train_optim_loss: 124693087.1111; val_kl_reg_loss: 137884.8438; val_edge_recon_loss: 27961436.0000; val_gene_expr_recon_loss: 2100696.2500; val_masked_gp_l1_reg_loss: 3367.5024; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94859016.0000; val_global_loss: 125062400.0000; val_optim_loss: 125062400.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9353; val_auprc_score: 0.9101; val_best_acc_score: 0.8779; val_best_f1_score: 0.8846; train_kl_reg_loss: 297031.0625; train_edge_recon_loss: 27671028.4444; train_gene_expr_recon_loss: 2094980.0694; train_masked_gp_l1_reg_loss: 3368.1609; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94820725.3333; train_global_loss: 124887134.2222; train_optim_loss: 124887134.2222; val_kl_reg_loss: 133595.1719; val_edge_recon_loss: 27723190.0000; val_gene_expr_recon_loss: 2098713.2500; val_masked_gp_l1_reg_loss: 3368.9136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94711680.0000; val_global_loss: 124670544.0000; val_optim_loss: 124670544.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9442; val_auprc_score: 0.9263; val_best_acc_score: 0.8816; val_best_f1_score: 0.8889; train_kl_reg_loss: 291038.8438; train_edge_recon_loss: 27435336.0000; train_gene_expr_recon_loss: 2097529.0972; train_masked_gp_l1_reg_loss: 3368.9392; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94527198.2222; train_global_loss: 124354471.1111; train_optim_loss: 124354471.1111; val_kl_reg_loss: 133675.4844; val_edge_recon_loss: 27618370.0000; val_gene_expr_recon_loss: 2099819.7500; val_masked_gp_l1_reg_loss: 3368.9863; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94788160.0000; val_global_loss: 124643392.0000; val_optim_loss: 124643392.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9406; val_auprc_score: 0.9217; val_best_acc_score: 0.8804; val_best_f1_score: 0.8873; train_kl_reg_loss: 292408.1076; train_edge_recon_loss: 27468461.3333; train_gene_expr_recon_loss: 2104938.1667; train_masked_gp_l1_reg_loss: 3369.0400; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94567367.1111; train_global_loss: 124436543.1111; train_optim_loss: 124436543.1111; val_kl_reg_loss: 134163.2812; val_edge_recon_loss: 27693052.0000; val_gene_expr_recon_loss: 2101942.7500; val_masked_gp_l1_reg_loss: 3369.1084; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94894392.0000; val_global_loss: 124826920.0000; val_optim_loss: 124826920.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9395; val_auprc_score: 0.9202; val_best_acc_score: 0.8824; val_best_f1_score: 0.8896; train_kl_reg_loss: 290902.1806; train_edge_recon_loss: 27588884.2222; train_gene_expr_recon_loss: 2112152.6667; train_masked_gp_l1_reg_loss: 3369.1625; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94766154.6667; train_global_loss: 124761464.0000; train_optim_loss: 124761464.0000; val_kl_reg_loss: 133660.8125; val_edge_recon_loss: 27542428.0000; val_gene_expr_recon_loss: 2099272.2500; val_masked_gp_l1_reg_loss: 3369.2419; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94726160.0000; val_global_loss: 124504888.0000; val_optim_loss: 124504888.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9412; val_auprc_score: 0.9236; val_best_acc_score: 0.8844; val_best_f1_score: 0.8913; train_kl_reg_loss: 290674.0972; train_edge_recon_loss: 27511504.4444; train_gene_expr_recon_loss: 2099144.3333; train_masked_gp_l1_reg_loss: 3369.3216; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94067985.7778; train_global_loss: 123972679.1111; train_optim_loss: 123972679.1111; val_kl_reg_loss: 134628.8750; val_edge_recon_loss: 27546120.0000; val_gene_expr_recon_loss: 2098785.0000; val_masked_gp_l1_reg_loss: 3369.4204; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94678792.0000; val_global_loss: 124461696.0000; val_optim_loss: 124461696.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9417; val_auprc_score: 0.9258; val_best_acc_score: 0.8783; val_best_f1_score: 0.8856; train_kl_reg_loss: 291500.2188; train_edge_recon_loss: 27520335.3333; train_gene_expr_recon_loss: 2093462.8056; train_masked_gp_l1_reg_loss: 3369.4984; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94383183.1111; train_global_loss: 124291850.6667; train_optim_loss: 124291850.6667; val_kl_reg_loss: 134570.2031; val_edge_recon_loss: 27621508.0000; val_gene_expr_recon_loss: 2100453.7500; val_masked_gp_l1_reg_loss: 3369.5947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94746856.0000; val_global_loss: 124606760.0000; val_optim_loss: 124606760.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9417; val_auprc_score: 0.9226; val_best_acc_score: 0.8779; val_best_f1_score: 0.8857; train_kl_reg_loss: 292825.4167; train_edge_recon_loss: 27534144.0000; train_gene_expr_recon_loss: 2095177.5278; train_masked_gp_l1_reg_loss: 3369.6655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94647155.5556; train_global_loss: 124572672.0000; train_optim_loss: 124572672.0000; val_kl_reg_loss: 135121.9062; val_edge_recon_loss: 27707266.0000; val_gene_expr_recon_loss: 2099321.0000; val_masked_gp_l1_reg_loss: 3369.7534; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94747064.0000; val_global_loss: 124692144.0000; val_optim_loss: 124692144.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9413; val_auprc_score: 0.9221; val_best_acc_score: 0.8806; val_best_f1_score: 0.8868; train_kl_reg_loss: 293109.4861; train_edge_recon_loss: 27469743.3333; train_gene_expr_recon_loss: 2103940.6528; train_masked_gp_l1_reg_loss: 3369.8212; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94505329.7778; train_global_loss: 124375492.4444; train_optim_loss: 124375492.4444; val_kl_reg_loss: 135888.9375; val_edge_recon_loss: 27705898.0000; val_gene_expr_recon_loss: 2099805.0000; val_masked_gp_l1_reg_loss: 3369.9048; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94859992.0000; val_global_loss: 124804952.0000; val_optim_loss: 124804952.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9408; val_auprc_score: 0.9189; val_best_acc_score: 0.8818; val_best_f1_score: 0.8890; train_kl_reg_loss: 292684.7674; train_edge_recon_loss: 27465150.8889; train_gene_expr_recon_loss: 2089562.8889; train_masked_gp_l1_reg_loss: 3369.9708; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94469303.1111; train_global_loss: 124320070.2222; train_optim_loss: 124320070.2222; val_kl_reg_loss: 136094.7812; val_edge_recon_loss: 27659324.0000; val_gene_expr_recon_loss: 2099927.2500; val_masked_gp_l1_reg_loss: 3370.0488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94889664.0000; val_global_loss: 124788384.0000; val_optim_loss: 124788384.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9415; val_auprc_score: 0.9203; val_best_acc_score: 0.8831; val_best_f1_score: 0.8885; train_kl_reg_loss: 293845.7778; train_edge_recon_loss: 27411969.3333; train_gene_expr_recon_loss: 2087766.0139; train_masked_gp_l1_reg_loss: 3370.0520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94359765.3333; train_global_loss: 124156715.5556; train_optim_loss: 124156715.5556; val_kl_reg_loss: 136074.9062; val_edge_recon_loss: 27632174.0000; val_gene_expr_recon_loss: 2099462.7500; val_masked_gp_l1_reg_loss: 3370.0566; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94789392.0000; val_global_loss: 124660472.0000; val_optim_loss: 124660472.0000
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9410; val_auprc_score: 0.9193; val_best_acc_score: 0.8835; val_best_f1_score: 0.8904; train_kl_reg_loss: 294270.8924; train_edge_recon_loss: 27464329.5556; train_gene_expr_recon_loss: 2090107.4861; train_masked_gp_l1_reg_loss: 3370.0628; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94617607.1111; train_global_loss: 124469685.3333; train_optim_loss: 124469685.3333; val_kl_reg_loss: 136450.9375; val_edge_recon_loss: 27471736.0000; val_gene_expr_recon_loss: 2099956.7500; val_masked_gp_l1_reg_loss: 3370.0698; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94816752.0000; val_global_loss: 124528264.0000; val_optim_loss: 124528264.0000
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9399; val_auprc_score: 0.9170; val_best_acc_score: 0.8824; val_best_f1_score: 0.8895; train_kl_reg_loss: 294697.3368; train_edge_recon_loss: 27468888.8889; train_gene_expr_recon_loss: 2102007.8333; train_masked_gp_l1_reg_loss: 3370.0761; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94911972.4444; train_global_loss: 124780937.7778; train_optim_loss: 124780937.7778; val_kl_reg_loss: 136361.5625; val_edge_recon_loss: 27653050.0000; val_gene_expr_recon_loss: 2101216.2500; val_masked_gp_l1_reg_loss: 3370.0840; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94907856.0000; val_global_loss: 124801856.0000; val_optim_loss: 124801856.0000
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9368; val_auprc_score: 0.9148; val_best_acc_score: 0.8774; val_best_f1_score: 0.8836; train_kl_reg_loss: 294477.8542; train_edge_recon_loss: 27565885.1111; train_gene_expr_recon_loss: 2091588.3611; train_masked_gp_l1_reg_loss: 3370.0899; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94809673.7778; train_global_loss: 124764994.6667; train_optim_loss: 124764994.6667; val_kl_reg_loss: 136048.2188; val_edge_recon_loss: 27841642.0000; val_gene_expr_recon_loss: 2098279.0000; val_masked_gp_l1_reg_loss: 3370.0977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94642032.0000; val_global_loss: 124721368.0000; val_optim_loss: 124721368.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 38 sec.
Using best model state, which was in epoch 61.

--- MODEL EVALUATION ---
Val AUROC score: 0.9387
Val AUPRC score: 0.9139
Val best accuracy score: 0.8769
Val best F1 score: 0.8849
Val gene expr MSE score: 0.4684
Val chrom access MSE score: 0.0862
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
