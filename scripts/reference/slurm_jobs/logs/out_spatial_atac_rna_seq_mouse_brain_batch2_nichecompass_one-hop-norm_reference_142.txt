[True]
Run timestamp: 07082023_214752_142.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_142']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9484; val_auprc_score: 0.9543; val_best_acc_score: 0.5162; val_best_f1_score: 0.6739; train_kl_reg_loss: 16977.1388; train_edge_recon_loss: 3470010.9167; train_gene_expr_recon_loss: 623541.0625; train_masked_gp_l1_reg_loss: 16486.8728; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 267400.6875; train_global_loss: 4394416.6111; train_optim_loss: 4394416.6111; val_kl_reg_loss: 7450.4043; val_edge_recon_loss: 4062961.2500; val_gene_expr_recon_loss: 614970.5625; val_masked_gp_l1_reg_loss: 12087.3447; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 265748.4375; val_global_loss: 4963218.5000; val_optim_loss: 4963218.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9520; val_auprc_score: 0.9553; val_best_acc_score: 0.5803; val_best_f1_score: 0.7040; train_kl_reg_loss: 8903.7503; train_edge_recon_loss: 3473054.0000; train_gene_expr_recon_loss: 590434.2917; train_masked_gp_l1_reg_loss: 10172.3213; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261468.5069; train_global_loss: 4344032.8333; train_optim_loss: 4344032.8333; val_kl_reg_loss: 7481.0732; val_edge_recon_loss: 4060530.0000; val_gene_expr_recon_loss: 589724.5625; val_masked_gp_l1_reg_loss: 8580.0088; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263254.4062; val_global_loss: 4929570.0000; val_optim_loss: 4929570.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9442; val_auprc_score: 0.9426; val_best_acc_score: 0.7515; val_best_f1_score: 0.7994; train_kl_reg_loss: 8452.2848; train_edge_recon_loss: 3474925.8889; train_gene_expr_recon_loss: 568559.4583; train_masked_gp_l1_reg_loss: 8330.0215; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260396.5295; train_global_loss: 4320664.0556; train_optim_loss: 4320664.0556; val_kl_reg_loss: 7779.3770; val_edge_recon_loss: 4050727.5000; val_gene_expr_recon_loss: 565910.5625; val_masked_gp_l1_reg_loss: 8055.3755; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260806.5469; val_global_loss: 4893279.5000; val_optim_loss: 4893279.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9213; val_auprc_score: 0.9087; val_best_acc_score: 0.8267; val_best_f1_score: 0.8170; train_kl_reg_loss: 9633.5891; train_edge_recon_loss: 3471800.6944; train_gene_expr_recon_loss: 545483.1319; train_masked_gp_l1_reg_loss: 7748.0111; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258680.9427; train_global_loss: 4293346.3889; train_optim_loss: 4293346.3889; val_kl_reg_loss: 9434.9375; val_edge_recon_loss: 3955778.5000; val_gene_expr_recon_loss: 545848.2500; val_masked_gp_l1_reg_loss: 7460.8994; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258474.7031; val_global_loss: 4776997.5000; val_optim_loss: 4776997.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8770; val_auprc_score: 0.8647; val_best_acc_score: 0.7842; val_best_f1_score: 0.8029; train_kl_reg_loss: 7140.7889; train_edge_recon_loss: 3412500.8611; train_gene_expr_recon_loss: 535382.6875; train_masked_gp_l1_reg_loss: 7347.6584; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256937.3872; train_global_loss: 4219309.3333; train_optim_loss: 4219309.3333; val_kl_reg_loss: 3815.5950; val_edge_recon_loss: 3131041.2500; val_gene_expr_recon_loss: 559902.0000; val_masked_gp_l1_reg_loss: 7222.1782; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259309.7656; val_global_loss: 3961290.7500; val_optim_loss: 3961290.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8779; val_auprc_score: 0.8717; val_best_acc_score: 0.7782; val_best_f1_score: 0.7910; train_kl_reg_loss: 12694.5904; train_edge_recon_loss: 2986481.6944; train_gene_expr_recon_loss: 557187.8194; train_masked_gp_l1_reg_loss: 7162.4569; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258284.8733; train_global_loss: 3821811.3611; train_optim_loss: 3821811.3611; val_kl_reg_loss: 31109.3125; val_edge_recon_loss: 2882276.0000; val_gene_expr_recon_loss: 565451.5625; val_masked_gp_l1_reg_loss: 7089.0410; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259255.7188; val_global_loss: 3745181.5000; val_optim_loss: 3745181.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8851; val_auprc_score: 0.8685; val_best_acc_score: 0.7912; val_best_f1_score: 0.8056; train_kl_reg_loss: 42327.3980; train_edge_recon_loss: 2840588.1667; train_gene_expr_recon_loss: 537318.5590; train_masked_gp_l1_reg_loss: 7020.0373; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256290.7882; train_global_loss: 3683544.8889; train_optim_loss: 3683544.8889; val_kl_reg_loss: 47483.0000; val_edge_recon_loss: 2854725.7500; val_gene_expr_recon_loss: 541435.9375; val_masked_gp_l1_reg_loss: 6949.6216; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256523.3125; val_global_loss: 3707117.5000; val_optim_loss: 3707117.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9028; val_auprc_score: 0.8745; val_best_acc_score: 0.8320; val_best_f1_score: 0.8467; train_kl_reg_loss: 41352.3411; train_edge_recon_loss: 2819731.1667; train_gene_expr_recon_loss: 525853.6667; train_masked_gp_l1_reg_loss: 6905.0764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254924.7951; train_global_loss: 3648767.0833; train_optim_loss: 3648767.0833; val_kl_reg_loss: 29393.4609; val_edge_recon_loss: 2785368.2500; val_gene_expr_recon_loss: 540485.8750; val_masked_gp_l1_reg_loss: 6869.6582; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256139.1562; val_global_loss: 3618256.5000; val_optim_loss: 3618256.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9273; val_auprc_score: 0.9069; val_best_acc_score: 0.8620; val_best_f1_score: 0.8701; train_kl_reg_loss: 26591.2083; train_edge_recon_loss: 2765216.0000; train_gene_expr_recon_loss: 529321.4028; train_masked_gp_l1_reg_loss: 6840.3153; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256451.0417; train_global_loss: 3584420.0000; train_optim_loss: 3584420.0000; val_kl_reg_loss: 27361.7656; val_edge_recon_loss: 2765799.7500; val_gene_expr_recon_loss: 544638.1875; val_masked_gp_l1_reg_loss: 6796.3696; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256244.0469; val_global_loss: 3600840.0000; val_optim_loss: 3600840.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9367; val_auprc_score: 0.9154; val_best_acc_score: 0.8763; val_best_f1_score: 0.8841; train_kl_reg_loss: 32711.5872; train_edge_recon_loss: 2718139.8333; train_gene_expr_recon_loss: 527688.4688; train_masked_gp_l1_reg_loss: 6786.0866; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254859.6007; train_global_loss: 3540185.6111; train_optim_loss: 3540185.6111; val_kl_reg_loss: 36575.2109; val_edge_recon_loss: 2702861.2500; val_gene_expr_recon_loss: 529418.0000; val_masked_gp_l1_reg_loss: 6778.6519; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254667.8906; val_global_loss: 3530301.2500; val_optim_loss: 3530301.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9381; val_auprc_score: 0.9140; val_best_acc_score: 0.8821; val_best_f1_score: 0.8885; train_kl_reg_loss: 36624.7396; train_edge_recon_loss: 2702670.2222; train_gene_expr_recon_loss: 516642.9965; train_masked_gp_l1_reg_loss: 6782.0170; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252996.8021; train_global_loss: 3515716.7778; train_optim_loss: 3515716.7778; val_kl_reg_loss: 33948.1211; val_edge_recon_loss: 2722258.7500; val_gene_expr_recon_loss: 521637.3750; val_masked_gp_l1_reg_loss: 6791.8921; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253679.0781; val_global_loss: 3538315.0000; val_optim_loss: 3538315.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9425; val_auprc_score: 0.9217; val_best_acc_score: 0.8860; val_best_f1_score: 0.8927; train_kl_reg_loss: 32085.5388; train_edge_recon_loss: 2711597.3611; train_gene_expr_recon_loss: 512779.2500; train_masked_gp_l1_reg_loss: 6823.3487; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251580.7396; train_global_loss: 3514866.1944; train_optim_loss: 3514866.1944; val_kl_reg_loss: 30680.6680; val_edge_recon_loss: 2728867.2500; val_gene_expr_recon_loss: 517863.9688; val_masked_gp_l1_reg_loss: 6866.1333; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253101.3750; val_global_loss: 3537379.5000; val_optim_loss: 3537379.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9451; val_auprc_score: 0.9223; val_best_acc_score: 0.8922; val_best_f1_score: 0.8976; train_kl_reg_loss: 31572.0955; train_edge_recon_loss: 2718599.5833; train_gene_expr_recon_loss: 506414.2569; train_masked_gp_l1_reg_loss: 6909.2240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251496.0920; train_global_loss: 3514991.2778; train_optim_loss: 3514991.2778; val_kl_reg_loss: 31210.2324; val_edge_recon_loss: 2698190.2500; val_gene_expr_recon_loss: 512583.2500; val_masked_gp_l1_reg_loss: 6944.9609; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252286.3594; val_global_loss: 3501215.0000; val_optim_loss: 3501215.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9561; val_auprc_score: 0.9414; val_best_acc_score: 0.9006; val_best_f1_score: 0.9052; train_kl_reg_loss: 30369.9937; train_edge_recon_loss: 2704588.5833; train_gene_expr_recon_loss: 501645.7118; train_masked_gp_l1_reg_loss: 6994.7783; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251199.3681; train_global_loss: 3494798.4167; train_optim_loss: 3494798.4167; val_kl_reg_loss: 28243.5000; val_edge_recon_loss: 2693548.5000; val_gene_expr_recon_loss: 516058.3125; val_masked_gp_l1_reg_loss: 7052.5298; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252162.9219; val_global_loss: 3497065.7500; val_optim_loss: 3497065.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9577; val_auprc_score: 0.9413; val_best_acc_score: 0.9007; val_best_f1_score: 0.9069; train_kl_reg_loss: 28542.7266; train_edge_recon_loss: 2699395.5833; train_gene_expr_recon_loss: 496648.9896; train_masked_gp_l1_reg_loss: 7094.0633; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249439.5972; train_global_loss: 3481120.9444; train_optim_loss: 3481120.9444; val_kl_reg_loss: 28177.8926; val_edge_recon_loss: 2674918.5000; val_gene_expr_recon_loss: 509605.1875; val_masked_gp_l1_reg_loss: 7138.4385; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251665.7969; val_global_loss: 3471506.0000; val_optim_loss: 3471506.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9624; val_auprc_score: 0.9490; val_best_acc_score: 0.9101; val_best_f1_score: 0.9145; train_kl_reg_loss: 28283.0755; train_edge_recon_loss: 2681083.6389; train_gene_expr_recon_loss: 497363.5903; train_masked_gp_l1_reg_loss: 7170.3573; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249583.9184; train_global_loss: 3463484.6389; train_optim_loss: 3463484.6389; val_kl_reg_loss: 25735.7148; val_edge_recon_loss: 2662184.5000; val_gene_expr_recon_loss: 505936.9375; val_masked_gp_l1_reg_loss: 7209.1943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250995.1719; val_global_loss: 3452061.7500; val_optim_loss: 3452061.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9630; val_auprc_score: 0.9505; val_best_acc_score: 0.9074; val_best_f1_score: 0.9107; train_kl_reg_loss: 27087.6921; train_edge_recon_loss: 2671745.7778; train_gene_expr_recon_loss: 494390.8333; train_masked_gp_l1_reg_loss: 7252.1981; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248588.6649; train_global_loss: 3449065.2222; train_optim_loss: 3449065.2222; val_kl_reg_loss: 30116.0781; val_edge_recon_loss: 2698671.5000; val_gene_expr_recon_loss: 504924.6875; val_masked_gp_l1_reg_loss: 7301.6201; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250654.9844; val_global_loss: 3491668.7500; val_optim_loss: 3491668.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9592; val_auprc_score: 0.9376; val_best_acc_score: 0.9135; val_best_f1_score: 0.9178; train_kl_reg_loss: 32440.3179; train_edge_recon_loss: 2667639.2222; train_gene_expr_recon_loss: 489680.5312; train_masked_gp_l1_reg_loss: 7339.4558; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249262.1128; train_global_loss: 3446361.6944; train_optim_loss: 3446361.6944; val_kl_reg_loss: 31443.1777; val_edge_recon_loss: 2678434.2500; val_gene_expr_recon_loss: 502034.7812; val_masked_gp_l1_reg_loss: 7390.8291; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250086.9375; val_global_loss: 3469390.0000; val_optim_loss: 3469390.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9613; val_auprc_score: 0.9424; val_best_acc_score: 0.9128; val_best_f1_score: 0.9165; train_kl_reg_loss: 32055.6115; train_edge_recon_loss: 2658998.4444; train_gene_expr_recon_loss: 487885.8125; train_masked_gp_l1_reg_loss: 7435.0072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248103.2795; train_global_loss: 3434478.0556; train_optim_loss: 3434478.0556; val_kl_reg_loss: 31003.5977; val_edge_recon_loss: 2673504.7500; val_gene_expr_recon_loss: 494442.5625; val_masked_gp_l1_reg_loss: 7468.3394; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249203.6875; val_global_loss: 3455622.7500; val_optim_loss: 3455622.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9634; val_auprc_score: 0.9456; val_best_acc_score: 0.9158; val_best_f1_score: 0.9193; train_kl_reg_loss: 31475.2324; train_edge_recon_loss: 2648482.9722; train_gene_expr_recon_loss: 483846.6910; train_masked_gp_l1_reg_loss: 7500.1744; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248086.4427; train_global_loss: 3419391.4722; train_optim_loss: 3419391.4722; val_kl_reg_loss: 29279.5195; val_edge_recon_loss: 2667835.7500; val_gene_expr_recon_loss: 497464.0938; val_masked_gp_l1_reg_loss: 7538.5908; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249235.6250; val_global_loss: 3451353.5000; val_optim_loss: 3451353.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9696; val_auprc_score: 0.9561; val_best_acc_score: 0.9236; val_best_f1_score: 0.9269; train_kl_reg_loss: 29640.3407; train_edge_recon_loss: 2648091.2778; train_gene_expr_recon_loss: 481985.6389; train_masked_gp_l1_reg_loss: 7572.9951; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247546.2083; train_global_loss: 3414836.3889; train_optim_loss: 3414836.3889; val_kl_reg_loss: 28430.1484; val_edge_recon_loss: 2665494.0000; val_gene_expr_recon_loss: 493610.6250; val_masked_gp_l1_reg_loss: 7606.0552; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248374.2500; val_global_loss: 3443515.2500; val_optim_loss: 3443515.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9708; val_auprc_score: 0.9561; val_best_acc_score: 0.9266; val_best_f1_score: 0.9292; train_kl_reg_loss: 29327.3956; train_edge_recon_loss: 2647945.0278; train_gene_expr_recon_loss: 479260.5417; train_masked_gp_l1_reg_loss: 7638.3553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246969.6753; train_global_loss: 3411141.0833; train_optim_loss: 3411141.0833; val_kl_reg_loss: 28039.9336; val_edge_recon_loss: 2662782.0000; val_gene_expr_recon_loss: 494751.8125; val_masked_gp_l1_reg_loss: 7668.6670; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248384.0156; val_global_loss: 3441626.5000; val_optim_loss: 3441626.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9747; val_auprc_score: 0.9637; val_best_acc_score: 0.9310; val_best_f1_score: 0.9338; train_kl_reg_loss: 28605.0599; train_edge_recon_loss: 2650359.8611; train_gene_expr_recon_loss: 480071.3229; train_masked_gp_l1_reg_loss: 7696.3451; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247572.0677; train_global_loss: 3414304.6667; train_optim_loss: 3414304.6667; val_kl_reg_loss: 28489.5273; val_edge_recon_loss: 2637091.2500; val_gene_expr_recon_loss: 494236.1875; val_masked_gp_l1_reg_loss: 7734.1455; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248303.3125; val_global_loss: 3415854.5000; val_optim_loss: 3415854.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9728; val_auprc_score: 0.9597; val_best_acc_score: 0.9316; val_best_f1_score: 0.9339; train_kl_reg_loss: 29182.1263; train_edge_recon_loss: 2646461.9722; train_gene_expr_recon_loss: 475450.2535; train_masked_gp_l1_reg_loss: 7766.5068; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246686.1007; train_global_loss: 3405547.0000; train_optim_loss: 3405547.0000; val_kl_reg_loss: 28604.3398; val_edge_recon_loss: 2642250.7500; val_gene_expr_recon_loss: 492176.3750; val_masked_gp_l1_reg_loss: 7795.2925; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247900.4375; val_global_loss: 3418727.2500; val_optim_loss: 3418727.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9744; val_auprc_score: 0.9619; val_best_acc_score: 0.9302; val_best_f1_score: 0.9324; train_kl_reg_loss: 28805.1378; train_edge_recon_loss: 2649892.6111; train_gene_expr_recon_loss: 474143.6597; train_masked_gp_l1_reg_loss: 7819.5012; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245622.2969; train_global_loss: 3406283.1944; train_optim_loss: 3406283.1944; val_kl_reg_loss: 28630.8320; val_edge_recon_loss: 2652518.5000; val_gene_expr_recon_loss: 486091.9375; val_masked_gp_l1_reg_loss: 7848.8081; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246996.7031; val_global_loss: 3422086.7500; val_optim_loss: 3422086.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9738; val_auprc_score: 0.9634; val_best_acc_score: 0.9326; val_best_f1_score: 0.9347; train_kl_reg_loss: 29178.7691; train_edge_recon_loss: 2639641.7778; train_gene_expr_recon_loss: 480689.8333; train_masked_gp_l1_reg_loss: 7867.4677; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245915.9115; train_global_loss: 3403293.8056; train_optim_loss: 3403293.8056; val_kl_reg_loss: 19414.2734; val_edge_recon_loss: 2668545.0000; val_gene_expr_recon_loss: 494181.6250; val_masked_gp_l1_reg_loss: 7867.7051; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247761.4219; val_global_loss: 3437770.2500; val_optim_loss: 3437770.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9779; val_auprc_score: 0.9689; val_best_acc_score: 0.9351; val_best_f1_score: 0.9375; train_kl_reg_loss: 29201.9618; train_edge_recon_loss: 2636515.5833; train_gene_expr_recon_loss: 480680.4618; train_masked_gp_l1_reg_loss: 7875.8411; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246146.2431; train_global_loss: 3400420.1389; train_optim_loss: 3400420.1389; val_kl_reg_loss: 19645.3125; val_edge_recon_loss: 2633936.7500; val_gene_expr_recon_loss: 495424.1875; val_masked_gp_l1_reg_loss: 7878.2666; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247639.5938; val_global_loss: 3404524.0000; val_optim_loss: 3404524.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9766; val_auprc_score: 0.9681; val_best_acc_score: 0.9376; val_best_f1_score: 0.9395; train_kl_reg_loss: 27206.3518; train_edge_recon_loss: 2632125.8056; train_gene_expr_recon_loss: 476564.5972; train_masked_gp_l1_reg_loss: 7882.9147; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244531.4531; train_global_loss: 3388311.1111; train_optim_loss: 3388311.1111; val_kl_reg_loss: 18561.9219; val_edge_recon_loss: 2633835.7500; val_gene_expr_recon_loss: 494019.5625; val_masked_gp_l1_reg_loss: 7882.3286; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247327.1562; val_global_loss: 3401626.7500; val_optim_loss: 3401626.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9802; val_auprc_score: 0.9733; val_best_acc_score: 0.9378; val_best_f1_score: 0.9392; train_kl_reg_loss: 26437.5312; train_edge_recon_loss: 2634808.7778; train_gene_expr_recon_loss: 477845.9236; train_masked_gp_l1_reg_loss: 7886.1835; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244079.9062; train_global_loss: 3391058.3611; train_optim_loss: 3391058.3611; val_kl_reg_loss: 20367.6836; val_edge_recon_loss: 2628044.2500; val_gene_expr_recon_loss: 489629.3125; val_masked_gp_l1_reg_loss: 7895.0239; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246624.1719; val_global_loss: 3392560.5000; val_optim_loss: 3392560.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9733; val_auprc_score: 0.9618; val_best_acc_score: 0.9320; val_best_f1_score: 0.9345; train_kl_reg_loss: 27596.9750; train_edge_recon_loss: 2629921.0833; train_gene_expr_recon_loss: 472381.7847; train_masked_gp_l1_reg_loss: 7919.4878; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243480.0955; train_global_loss: 3381299.3611; train_optim_loss: 3381299.3611; val_kl_reg_loss: 21908.9707; val_edge_recon_loss: 2666114.0000; val_gene_expr_recon_loss: 483589.0625; val_masked_gp_l1_reg_loss: 7939.4390; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245594.6719; val_global_loss: 3425146.2500; val_optim_loss: 3425146.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9781; val_auprc_score: 0.9702; val_best_acc_score: 0.9404; val_best_f1_score: 0.9418; train_kl_reg_loss: 27142.1289; train_edge_recon_loss: 2630359.8611; train_gene_expr_recon_loss: 469596.3403; train_masked_gp_l1_reg_loss: 7961.8262; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243532.6319; train_global_loss: 3378592.8333; train_optim_loss: 3378592.8333; val_kl_reg_loss: 20990.9961; val_edge_recon_loss: 2619258.2500; val_gene_expr_recon_loss: 481912.6875; val_masked_gp_l1_reg_loss: 7972.4482; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245393.1094; val_global_loss: 3375527.5000; val_optim_loss: 3375527.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9754; val_auprc_score: 0.9640; val_best_acc_score: 0.9390; val_best_f1_score: 0.9409; train_kl_reg_loss: 25990.0679; train_edge_recon_loss: 2623446.7222; train_gene_expr_recon_loss: 468056.1319; train_masked_gp_l1_reg_loss: 7983.3641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243162.2240; train_global_loss: 3368638.5833; train_optim_loss: 3368638.5833; val_kl_reg_loss: 21173.0352; val_edge_recon_loss: 2638855.5000; val_gene_expr_recon_loss: 483430.7500; val_masked_gp_l1_reg_loss: 7992.1489; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245253.4688; val_global_loss: 3396705.0000; val_optim_loss: 3396705.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9770; val_auprc_score: 0.9663; val_best_acc_score: 0.9372; val_best_f1_score: 0.9394; train_kl_reg_loss: 25961.3032; train_edge_recon_loss: 2626522.8889; train_gene_expr_recon_loss: 466858.8576; train_masked_gp_l1_reg_loss: 8008.8710; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242961.6528; train_global_loss: 3370313.5556; train_optim_loss: 3370313.5556; val_kl_reg_loss: 20786.5195; val_edge_recon_loss: 2630469.0000; val_gene_expr_recon_loss: 484520.6875; val_masked_gp_l1_reg_loss: 8022.5430; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245210.4219; val_global_loss: 3389009.2500; val_optim_loss: 3389009.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9784; val_auprc_score: 0.9690; val_best_acc_score: 0.9410; val_best_f1_score: 0.9428; train_kl_reg_loss: 24557.5638; train_edge_recon_loss: 2619281.0000; train_gene_expr_recon_loss: 464248.5486; train_masked_gp_l1_reg_loss: 8040.7499; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241836.7274; train_global_loss: 3357964.6389; train_optim_loss: 3357964.6389; val_kl_reg_loss: 21202.0059; val_edge_recon_loss: 2627602.7500; val_gene_expr_recon_loss: 481470.2500; val_masked_gp_l1_reg_loss: 8058.4370; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244872.6094; val_global_loss: 3383206.0000; val_optim_loss: 3383206.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9783; val_auprc_score: 0.9702; val_best_acc_score: 0.9402; val_best_f1_score: 0.9421; train_kl_reg_loss: 26013.8806; train_edge_recon_loss: 2616497.1667; train_gene_expr_recon_loss: 466098.3854; train_masked_gp_l1_reg_loss: 8073.2899; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243285.9271; train_global_loss: 3359968.6667; train_optim_loss: 3359968.6667; val_kl_reg_loss: 22395.8242; val_edge_recon_loss: 2635066.5000; val_gene_expr_recon_loss: 482486.0938; val_masked_gp_l1_reg_loss: 8090.1465; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244770.5625; val_global_loss: 3392809.0000; val_optim_loss: 3392809.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9811; val_auprc_score: 0.9736; val_best_acc_score: 0.9429; val_best_f1_score: 0.9441; train_kl_reg_loss: 25800.7908; train_edge_recon_loss: 2614988.8056; train_gene_expr_recon_loss: 464171.7292; train_masked_gp_l1_reg_loss: 8020.3963; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242104.1892; train_global_loss: 3355086.0000; train_optim_loss: 3355086.0000; val_kl_reg_loss: 22238.4648; val_edge_recon_loss: 2630211.7500; val_gene_expr_recon_loss: 479172.6562; val_masked_gp_l1_reg_loss: 7958.3828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244237.6406; val_global_loss: 3383819.2500; val_optim_loss: 3383819.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9821; val_auprc_score: 0.9754; val_best_acc_score: 0.9453; val_best_f1_score: 0.9471; train_kl_reg_loss: 25641.0712; train_edge_recon_loss: 2613653.6944; train_gene_expr_recon_loss: 464292.7882; train_masked_gp_l1_reg_loss: 7941.9756; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242798.8281; train_global_loss: 3354328.3889; train_optim_loss: 3354328.3889; val_kl_reg_loss: 21915.0508; val_edge_recon_loss: 2607083.5000; val_gene_expr_recon_loss: 480041.4375; val_masked_gp_l1_reg_loss: 7917.7920; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244417.1875; val_global_loss: 3361375.0000; val_optim_loss: 3361375.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9806; val_auprc_score: 0.9724; val_best_acc_score: 0.9442; val_best_f1_score: 0.9458; train_kl_reg_loss: 25346.3047; train_edge_recon_loss: 2610869.0000; train_gene_expr_recon_loss: 465056.2535; train_masked_gp_l1_reg_loss: 7907.4470; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241401.1788; train_global_loss: 3350580.1944; train_optim_loss: 3350580.1944; val_kl_reg_loss: 21555.3008; val_edge_recon_loss: 2635402.7500; val_gene_expr_recon_loss: 480233.8750; val_masked_gp_l1_reg_loss: 7896.1758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244308.8438; val_global_loss: 3389397.0000; val_optim_loss: 3389397.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9792; val_auprc_score: 0.9689; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 25072.8780; train_edge_recon_loss: 2623721.6111; train_gene_expr_recon_loss: 465705.1701; train_masked_gp_l1_reg_loss: 7891.2542; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241673.8733; train_global_loss: 3364064.8056; train_optim_loss: 3364064.8056; val_kl_reg_loss: 21441.7793; val_edge_recon_loss: 2615308.2500; val_gene_expr_recon_loss: 480390.0625; val_masked_gp_l1_reg_loss: 7886.0649; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244394.0469; val_global_loss: 3369420.0000; val_optim_loss: 3369420.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9780; val_auprc_score: 0.9671; val_best_acc_score: 0.9407; val_best_f1_score: 0.9426; train_kl_reg_loss: 25027.9724; train_edge_recon_loss: 2613356.0278; train_gene_expr_recon_loss: 465371.6076; train_masked_gp_l1_reg_loss: 7885.1902; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242332.4635; train_global_loss: 3353973.2778; train_optim_loss: 3353973.2778; val_kl_reg_loss: 21233.7812; val_edge_recon_loss: 2615470.5000; val_gene_expr_recon_loss: 480171.8438; val_masked_gp_l1_reg_loss: 7882.9536; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244287.2344; val_global_loss: 3369046.2500; val_optim_loss: 3369046.2500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9836; val_auprc_score: 0.9779; val_best_acc_score: 0.9479; val_best_f1_score: 0.9492; train_kl_reg_loss: 24587.7982; train_edge_recon_loss: 2613380.8056; train_gene_expr_recon_loss: 463391.7292; train_masked_gp_l1_reg_loss: 7883.4440; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242406.6007; train_global_loss: 3351650.3333; train_optim_loss: 3351650.3333; val_kl_reg_loss: 21168.8008; val_edge_recon_loss: 2616573.2500; val_gene_expr_recon_loss: 480479.3125; val_masked_gp_l1_reg_loss: 7882.8525; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244330.3906; val_global_loss: 3370434.5000; val_optim_loss: 3370434.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9816; val_auprc_score: 0.9718; val_best_acc_score: 0.9454; val_best_f1_score: 0.9470; train_kl_reg_loss: 24468.8294; train_edge_recon_loss: 2612787.7222; train_gene_expr_recon_loss: 465597.1771; train_masked_gp_l1_reg_loss: 7874.9440; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242123.9705; train_global_loss: 3352852.6667; train_optim_loss: 3352852.6667; val_kl_reg_loss: 21217.3086; val_edge_recon_loss: 2621426.5000; val_gene_expr_recon_loss: 480065.1250; val_masked_gp_l1_reg_loss: 7867.5044; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244244.7969; val_global_loss: 3374821.2500; val_optim_loss: 3374821.2500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9789; val_auprc_score: 0.9698; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 24501.9590; train_edge_recon_loss: 2615793.8056; train_gene_expr_recon_loss: 462622.2986; train_masked_gp_l1_reg_loss: 7866.0662; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241848.5851; train_global_loss: 3352632.6667; train_optim_loss: 3352632.6667; val_kl_reg_loss: 21185.9453; val_edge_recon_loss: 2627512.7500; val_gene_expr_recon_loss: 479799.2500; val_masked_gp_l1_reg_loss: 7863.4727; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244239.2812; val_global_loss: 3380600.7500; val_optim_loss: 3380600.7500
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9795; val_auprc_score: 0.9707; val_best_acc_score: 0.9427; val_best_f1_score: 0.9445; train_kl_reg_loss: 24630.5638; train_edge_recon_loss: 2611751.1111; train_gene_expr_recon_loss: 462150.4757; train_masked_gp_l1_reg_loss: 7862.2142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241511.7569; train_global_loss: 3347906.1389; train_optim_loss: 3347906.1389; val_kl_reg_loss: 21296.1836; val_edge_recon_loss: 2622802.2500; val_gene_expr_recon_loss: 479796.6875; val_masked_gp_l1_reg_loss: 7860.9131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244248.0000; val_global_loss: 3376004.2500; val_optim_loss: 3376004.2500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9786; val_auprc_score: 0.9683; val_best_acc_score: 0.9391; val_best_f1_score: 0.9408; train_kl_reg_loss: 24640.1005; train_edge_recon_loss: 2620845.3056; train_gene_expr_recon_loss: 463862.2743; train_masked_gp_l1_reg_loss: 7860.2276; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243314.9583; train_global_loss: 3360522.9444; train_optim_loss: 3360522.9444; val_kl_reg_loss: 21240.1289; val_edge_recon_loss: 2632042.5000; val_gene_expr_recon_loss: 479853.7500; val_masked_gp_l1_reg_loss: 7859.5723; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244274.0938; val_global_loss: 3385270.0000; val_optim_loss: 3385270.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 9 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9771
val AUPRC score: 0.9676
val best accuracy score: 0.9386
val best F1 score: 0.9401
val target rna MSE score: 0.4129
val source rna MSE score: 0.3186
val target atac MSE score: 0.1372
val source atac MSE score: 0.0210
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
