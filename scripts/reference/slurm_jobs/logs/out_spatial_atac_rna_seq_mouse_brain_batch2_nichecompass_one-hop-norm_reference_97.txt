[True]
Run timestamp: 07082023_202534_97.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_97']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8959; val_auprc_score: 0.9052; val_best_acc_score: 0.5317; val_best_f1_score: 0.6808; train_kl_reg_loss: 5197.0045; train_edge_recon_loss: 348585.6701; train_gene_expr_recon_loss: 639762.7847; train_masked_gp_l1_reg_loss: 15796.7444; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265656.6337; train_global_loss: 1274998.8333; train_optim_loss: 1274998.8333; val_kl_reg_loss: 8564.6143; val_edge_recon_loss: 406317.0938; val_gene_expr_recon_loss: 607669.1250; val_masked_gp_l1_reg_loss: 10474.9824; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 261074.4688; val_global_loss: 1294100.3750; val_optim_loss: 1294100.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8941; val_auprc_score: 0.9038; val_best_acc_score: 0.5271; val_best_f1_score: 0.6783; train_kl_reg_loss: 11385.1928; train_edge_recon_loss: 354499.4861; train_gene_expr_recon_loss: 575679.4792; train_masked_gp_l1_reg_loss: 8582.7882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262601.2934; train_global_loss: 1212748.2500; train_optim_loss: 1212748.2500; val_kl_reg_loss: 14514.9102; val_edge_recon_loss: 406342.9688; val_gene_expr_recon_loss: 545254.9375; val_masked_gp_l1_reg_loss: 7394.6934; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256585.4219; val_global_loss: 1230092.8750; val_optim_loss: 1230092.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8780; val_auprc_score: 0.8840; val_best_acc_score: 0.5496; val_best_f1_score: 0.6874; train_kl_reg_loss: 16579.4905; train_edge_recon_loss: 357994.3438; train_gene_expr_recon_loss: 528681.5417; train_masked_gp_l1_reg_loss: 7777.6714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 259609.4497; train_global_loss: 1170642.4722; train_optim_loss: 1170642.4722; val_kl_reg_loss: 16881.1035; val_edge_recon_loss: 406162.5625; val_gene_expr_recon_loss: 511154.0312; val_masked_gp_l1_reg_loss: 8081.6660; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252769.6250; val_global_loss: 1195049.0000; val_optim_loss: 1195049.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8958; val_auprc_score: 0.8985; val_best_acc_score: 0.6159; val_best_f1_score: 0.7187; train_kl_reg_loss: 18410.4807; train_edge_recon_loss: 358603.2500; train_gene_expr_recon_loss: 498737.2986; train_masked_gp_l1_reg_loss: 8039.4425; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253155.9983; train_global_loss: 1136946.4722; train_optim_loss: 1136946.4722; val_kl_reg_loss: 20065.9863; val_edge_recon_loss: 405699.7188; val_gene_expr_recon_loss: 488368.6875; val_masked_gp_l1_reg_loss: 8051.9688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249800.0469; val_global_loss: 1171986.3750; val_optim_loss: 1171986.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9064; val_auprc_score: 0.9041; val_best_acc_score: 0.7328; val_best_f1_score: 0.7824; train_kl_reg_loss: 19699.0853; train_edge_recon_loss: 358620.0139; train_gene_expr_recon_loss: 479548.6736; train_masked_gp_l1_reg_loss: 8088.6262; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251583.4809; train_global_loss: 1117539.8889; train_optim_loss: 1117539.8889; val_kl_reg_loss: 21922.3633; val_edge_recon_loss: 404740.7188; val_gene_expr_recon_loss: 472099.3125; val_masked_gp_l1_reg_loss: 8102.6099; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247475.6094; val_global_loss: 1154340.6250; val_optim_loss: 1154340.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9085; val_auprc_score: 0.9041; val_best_acc_score: 0.8320; val_best_f1_score: 0.8387; train_kl_reg_loss: 20265.9933; train_edge_recon_loss: 358135.3854; train_gene_expr_recon_loss: 468708.2951; train_masked_gp_l1_reg_loss: 8121.2401; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251208.8125; train_global_loss: 1106439.7361; train_optim_loss: 1106439.7361; val_kl_reg_loss: 20120.2070; val_edge_recon_loss: 401019.4062; val_gene_expr_recon_loss: 462619.4375; val_masked_gp_l1_reg_loss: 8131.5488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245794.8281; val_global_loss: 1137685.5000; val_optim_loss: 1137685.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9136; val_auprc_score: 0.9011; val_best_acc_score: 0.8242; val_best_f1_score: 0.8404; train_kl_reg_loss: 19824.2259; train_edge_recon_loss: 355960.2847; train_gene_expr_recon_loss: 457498.8576; train_masked_gp_l1_reg_loss: 8159.1591; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246771.1285; train_global_loss: 1088213.6389; train_optim_loss: 1088213.6389; val_kl_reg_loss: 19531.3242; val_edge_recon_loss: 386899.5312; val_gene_expr_recon_loss: 456215.7812; val_masked_gp_l1_reg_loss: 8174.1758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244569.1406; val_global_loss: 1115390.0000; val_optim_loss: 1115390.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9065; val_auprc_score: 0.8945; val_best_acc_score: 0.8262; val_best_f1_score: 0.8349; train_kl_reg_loss: 19315.3268; train_edge_recon_loss: 345261.3194; train_gene_expr_recon_loss: 453960.6667; train_masked_gp_l1_reg_loss: 8206.5036; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247298.1597; train_global_loss: 1074041.9583; train_optim_loss: 1074041.9583; val_kl_reg_loss: 19736.3984; val_edge_recon_loss: 341961.6562; val_gene_expr_recon_loss: 456962.6562; val_masked_gp_l1_reg_loss: 8247.5498; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244284.6719; val_global_loss: 1071193.0000; val_optim_loss: 1071193.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9047; val_auprc_score: 0.8884; val_best_acc_score: 0.8166; val_best_f1_score: 0.8272; train_kl_reg_loss: 27772.3822; train_edge_recon_loss: 318156.8056; train_gene_expr_recon_loss: 454549.2778; train_masked_gp_l1_reg_loss: 8313.0413; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247787.9201; train_global_loss: 1056579.4167; train_optim_loss: 1056579.4167; val_kl_reg_loss: 30749.2305; val_edge_recon_loss: 309859.0312; val_gene_expr_recon_loss: 454874.9062; val_masked_gp_l1_reg_loss: 8393.8193; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243658.4531; val_global_loss: 1047535.3750; val_optim_loss: 1047535.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9221; val_auprc_score: 0.9067; val_best_acc_score: 0.8429; val_best_f1_score: 0.8513; train_kl_reg_loss: 28535.3110; train_edge_recon_loss: 307788.3576; train_gene_expr_recon_loss: 449870.7812; train_masked_gp_l1_reg_loss: 8465.0392; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246368.3715; train_global_loss: 1041027.8750; train_optim_loss: 1041027.8750; val_kl_reg_loss: 24849.8945; val_edge_recon_loss: 306009.3750; val_gene_expr_recon_loss: 452723.6250; val_masked_gp_l1_reg_loss: 8534.8301; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242920.2812; val_global_loss: 1035038.0000; val_optim_loss: 1035038.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9309; val_auprc_score: 0.9154; val_best_acc_score: 0.8572; val_best_f1_score: 0.8663; train_kl_reg_loss: 27676.4590; train_edge_recon_loss: 304596.1389; train_gene_expr_recon_loss: 445372.5764; train_masked_gp_l1_reg_loss: 8583.3923; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244745.2378; train_global_loss: 1030973.7917; train_optim_loss: 1030973.7917; val_kl_reg_loss: 26886.4570; val_edge_recon_loss: 301107.5938; val_gene_expr_recon_loss: 446947.1250; val_masked_gp_l1_reg_loss: 8636.0107; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241778.1562; val_global_loss: 1025355.3750; val_optim_loss: 1025355.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9357; val_auprc_score: 0.9161; val_best_acc_score: 0.8669; val_best_f1_score: 0.8739; train_kl_reg_loss: 27492.0703; train_edge_recon_loss: 300418.6632; train_gene_expr_recon_loss: 445081.7049; train_masked_gp_l1_reg_loss: 8672.0383; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244854.1528; train_global_loss: 1026518.6111; train_optim_loss: 1026518.6111; val_kl_reg_loss: 27122.7617; val_edge_recon_loss: 301748.0625; val_gene_expr_recon_loss: 442731.6250; val_masked_gp_l1_reg_loss: 8721.3623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241068.3125; val_global_loss: 1021392.1250; val_optim_loss: 1021392.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9484; val_auprc_score: 0.9322; val_best_acc_score: 0.8829; val_best_f1_score: 0.8901; train_kl_reg_loss: 27692.3826; train_edge_recon_loss: 297670.1667; train_gene_expr_recon_loss: 439636.8854; train_masked_gp_l1_reg_loss: 8757.5433; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243480.3351; train_global_loss: 1017237.3125; train_optim_loss: 1017237.3125; val_kl_reg_loss: 26216.1758; val_edge_recon_loss: 295768.1875; val_gene_expr_recon_loss: 442928.6562; val_masked_gp_l1_reg_loss: 8804.4199; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240717.3125; val_global_loss: 1014434.7500; val_optim_loss: 1014434.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9542; val_auprc_score: 0.9415; val_best_acc_score: 0.8929; val_best_f1_score: 0.8985; train_kl_reg_loss: 27616.5421; train_edge_recon_loss: 295306.3646; train_gene_expr_recon_loss: 439216.8924; train_masked_gp_l1_reg_loss: 8839.7012; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243215.2344; train_global_loss: 1014194.7222; train_optim_loss: 1014194.7222; val_kl_reg_loss: 27030.7207; val_edge_recon_loss: 295955.0000; val_gene_expr_recon_loss: 439157.6250; val_masked_gp_l1_reg_loss: 8880.1455; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239923.7500; val_global_loss: 1010947.2500; val_optim_loss: 1010947.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9621; val_auprc_score: 0.9485; val_best_acc_score: 0.9080; val_best_f1_score: 0.9110; train_kl_reg_loss: 27588.5454; train_edge_recon_loss: 293075.2153; train_gene_expr_recon_loss: 434993.1076; train_masked_gp_l1_reg_loss: 8912.8930; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241677.8733; train_global_loss: 1006247.6458; train_optim_loss: 1006247.6458; val_kl_reg_loss: 26827.5840; val_edge_recon_loss: 292164.4062; val_gene_expr_recon_loss: 437429.3125; val_masked_gp_l1_reg_loss: 8944.8184; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239285.0156; val_global_loss: 1004651.1250; val_optim_loss: 1004651.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9664; val_auprc_score: 0.9543; val_best_acc_score: 0.9159; val_best_f1_score: 0.9180; train_kl_reg_loss: 27740.5790; train_edge_recon_loss: 291423.0694; train_gene_expr_recon_loss: 434784.5417; train_masked_gp_l1_reg_loss: 8970.0054; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240794.6094; train_global_loss: 1003712.7847; train_optim_loss: 1003712.7847; val_kl_reg_loss: 27318.7461; val_edge_recon_loss: 290517.5938; val_gene_expr_recon_loss: 436323.3125; val_masked_gp_l1_reg_loss: 8996.6650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238873.0469; val_global_loss: 1002029.3750; val_optim_loss: 1002029.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9646; val_auprc_score: 0.9509; val_best_acc_score: 0.9136; val_best_f1_score: 0.9164; train_kl_reg_loss: 27634.5994; train_edge_recon_loss: 290512.3438; train_gene_expr_recon_loss: 433096.6736; train_masked_gp_l1_reg_loss: 9026.3019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241802.6997; train_global_loss: 1002072.6042; train_optim_loss: 1002072.6042; val_kl_reg_loss: 27438.8711; val_edge_recon_loss: 290057.9375; val_gene_expr_recon_loss: 433877.0625; val_masked_gp_l1_reg_loss: 9065.3887; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238183.7344; val_global_loss: 998623.0000; val_optim_loss: 998623.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9702; val_auprc_score: 0.9609; val_best_acc_score: 0.9216; val_best_f1_score: 0.9243; train_kl_reg_loss: 27482.0035; train_edge_recon_loss: 290543.2778; train_gene_expr_recon_loss: 428532.0000; train_masked_gp_l1_reg_loss: 9098.1109; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239870.4757; train_global_loss: 995525.8611; train_optim_loss: 995525.8611; val_kl_reg_loss: 26401.3672; val_edge_recon_loss: 288720.4062; val_gene_expr_recon_loss: 432446.5000; val_masked_gp_l1_reg_loss: 9123.0117; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237581.8125; val_global_loss: 994273.0625; val_optim_loss: 994273.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9680; val_auprc_score: 0.9551; val_best_acc_score: 0.9213; val_best_f1_score: 0.9226; train_kl_reg_loss: 27154.2990; train_edge_recon_loss: 289882.1285; train_gene_expr_recon_loss: 426859.7326; train_masked_gp_l1_reg_loss: 9146.1392; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239813.8663; train_global_loss: 992856.1667; train_optim_loss: 992856.1667; val_kl_reg_loss: 26551.6582; val_edge_recon_loss: 288341.2500; val_gene_expr_recon_loss: 432214.1250; val_masked_gp_l1_reg_loss: 9171.3047; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237243.5625; val_global_loss: 993521.8750; val_optim_loss: 993521.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9734; val_auprc_score: 0.9663; val_best_acc_score: 0.9266; val_best_f1_score: 0.9277; train_kl_reg_loss: 27275.3513; train_edge_recon_loss: 288650.0625; train_gene_expr_recon_loss: 427092.6458; train_masked_gp_l1_reg_loss: 9200.1368; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239433.1545; train_global_loss: 991651.3472; train_optim_loss: 991651.3472; val_kl_reg_loss: 25700.0957; val_edge_recon_loss: 286773.8125; val_gene_expr_recon_loss: 432364.2812; val_masked_gp_l1_reg_loss: 9224.6006; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236866.9219; val_global_loss: 990929.7500; val_optim_loss: 990929.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9746; val_auprc_score: 0.9656; val_best_acc_score: 0.9275; val_best_f1_score: 0.9303; train_kl_reg_loss: 26592.6693; train_edge_recon_loss: 288903.6354; train_gene_expr_recon_loss: 426998.1806; train_masked_gp_l1_reg_loss: 9250.0543; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238774.1319; train_global_loss: 990518.6806; train_optim_loss: 990518.6806; val_kl_reg_loss: 26511.6875; val_edge_recon_loss: 289664.9688; val_gene_expr_recon_loss: 428258.4375; val_masked_gp_l1_reg_loss: 9273.6377; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236098.0938; val_global_loss: 989806.8750; val_optim_loss: 989806.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9778; val_auprc_score: 0.9694; val_best_acc_score: 0.9316; val_best_f1_score: 0.9340; train_kl_reg_loss: 27013.1491; train_edge_recon_loss: 286957.1528; train_gene_expr_recon_loss: 423716.6667; train_masked_gp_l1_reg_loss: 9297.3920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238162.9826; train_global_loss: 985147.3403; train_optim_loss: 985147.3403; val_kl_reg_loss: 26910.2246; val_edge_recon_loss: 289136.2188; val_gene_expr_recon_loss: 426444.4375; val_masked_gp_l1_reg_loss: 9315.1631; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235462.0625; val_global_loss: 987268.1250; val_optim_loss: 987268.1250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9765; val_auprc_score: 0.9680; val_best_acc_score: 0.9322; val_best_f1_score: 0.9337; train_kl_reg_loss: 26672.6734; train_edge_recon_loss: 287617.5278; train_gene_expr_recon_loss: 423643.4097; train_masked_gp_l1_reg_loss: 9334.7513; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238235.6979; train_global_loss: 985504.0694; train_optim_loss: 985504.0694; val_kl_reg_loss: 26484.8125; val_edge_recon_loss: 288591.9062; val_gene_expr_recon_loss: 426419.0000; val_masked_gp_l1_reg_loss: 9355.0791; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235129.1719; val_global_loss: 985980.0000; val_optim_loss: 985980.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9759; val_auprc_score: 0.9664; val_best_acc_score: 0.9316; val_best_f1_score: 0.9330; train_kl_reg_loss: 26585.4952; train_edge_recon_loss: 286708.6181; train_gene_expr_recon_loss: 423322.6389; train_masked_gp_l1_reg_loss: 9375.8408; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237489.5556; train_global_loss: 983482.1458; train_optim_loss: 983482.1458; val_kl_reg_loss: 26711.2441; val_edge_recon_loss: 286206.4375; val_gene_expr_recon_loss: 425969.8750; val_masked_gp_l1_reg_loss: 9400.6943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235063.9375; val_global_loss: 983352.1875; val_optim_loss: 983352.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9752; val_auprc_score: 0.9663; val_best_acc_score: 0.9310; val_best_f1_score: 0.9326; train_kl_reg_loss: 26817.8281; train_edge_recon_loss: 286248.8715; train_gene_expr_recon_loss: 421897.3299; train_masked_gp_l1_reg_loss: 9424.4851; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236666.6024; train_global_loss: 981055.1319; train_optim_loss: 981055.1319; val_kl_reg_loss: 25363.3125; val_edge_recon_loss: 286802.8438; val_gene_expr_recon_loss: 426791.8125; val_masked_gp_l1_reg_loss: 9448.6689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235023.0000; val_global_loss: 983429.6875; val_optim_loss: 983429.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9798; val_auprc_score: 0.9742; val_best_acc_score: 0.9361; val_best_f1_score: 0.9377; train_kl_reg_loss: 27453.6684; train_edge_recon_loss: 294102.4236; train_gene_expr_recon_loss: 432464.6146; train_masked_gp_l1_reg_loss: 9470.7814; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240221.0781; train_global_loss: 1003712.5694; train_optim_loss: 1003712.5694; val_kl_reg_loss: 16879.7715; val_edge_recon_loss: 289686.4688; val_gene_expr_recon_loss: 436932.1875; val_masked_gp_l1_reg_loss: 9470.8965; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236899.2969; val_global_loss: 989868.6250; val_optim_loss: 989868.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9763; val_auprc_score: 0.9692; val_best_acc_score: 0.9282; val_best_f1_score: 0.9295; train_kl_reg_loss: 24764.3937; train_edge_recon_loss: 289577.5590; train_gene_expr_recon_loss: 430637.5208; train_masked_gp_l1_reg_loss: 9475.4476; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240011.5851; train_global_loss: 994466.4931; train_optim_loss: 994466.4931; val_kl_reg_loss: 19383.8086; val_edge_recon_loss: 287615.1562; val_gene_expr_recon_loss: 434004.4688; val_masked_gp_l1_reg_loss: 9477.1650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236149.7344; val_global_loss: 986630.3750; val_optim_loss: 986630.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9769; val_auprc_score: 0.9669; val_best_acc_score: 0.9322; val_best_f1_score: 0.9342; train_kl_reg_loss: 23726.3203; train_edge_recon_loss: 285654.4271; train_gene_expr_recon_loss: 427033.8403; train_masked_gp_l1_reg_loss: 9481.9337; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238745.1892; train_global_loss: 984641.7083; train_optim_loss: 984641.7083; val_kl_reg_loss: 20416.2695; val_edge_recon_loss: 285803.1250; val_gene_expr_recon_loss: 433636.1562; val_masked_gp_l1_reg_loss: 9481.6689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235942.0469; val_global_loss: 985279.3125; val_optim_loss: 985279.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9733; val_auprc_score: 0.9595; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 23628.0473; train_edge_recon_loss: 285443.8194; train_gene_expr_recon_loss: 426298.3056; train_masked_gp_l1_reg_loss: 9400.4198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237440.0139; train_global_loss: 982210.5972; train_optim_loss: 982210.5972; val_kl_reg_loss: 20936.6387; val_edge_recon_loss: 286748.0625; val_gene_expr_recon_loss: 431939.9375; val_masked_gp_l1_reg_loss: 9331.1006; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235770.2344; val_global_loss: 984726.0000; val_optim_loss: 984726.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9739; val_auprc_score: 0.9621; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 23368.0015; train_edge_recon_loss: 283990.1701; train_gene_expr_recon_loss: 425284.8646; train_masked_gp_l1_reg_loss: 9313.5443; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237363.0677; train_global_loss: 979319.6250; train_optim_loss: 979319.6250; val_kl_reg_loss: 20775.6641; val_edge_recon_loss: 285644.8750; val_gene_expr_recon_loss: 432317.3125; val_masked_gp_l1_reg_loss: 9286.0498; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235716.8750; val_global_loss: 983740.8125; val_optim_loss: 983740.8125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9775; val_auprc_score: 0.9690; val_best_acc_score: 0.9324; val_best_f1_score: 0.9336; train_kl_reg_loss: 23582.5334; train_edge_recon_loss: 283941.1597; train_gene_expr_recon_loss: 427070.9132; train_masked_gp_l1_reg_loss: 9272.9044; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238059.8542; train_global_loss: 981927.3681; train_optim_loss: 981927.3681; val_kl_reg_loss: 21076.0781; val_edge_recon_loss: 285363.0625; val_gene_expr_recon_loss: 432216.5625; val_masked_gp_l1_reg_loss: 9258.1982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235703.8281; val_global_loss: 983617.6875; val_optim_loss: 983617.6875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9763; val_auprc_score: 0.9683; val_best_acc_score: 0.9333; val_best_f1_score: 0.9353; train_kl_reg_loss: 23686.3038; train_edge_recon_loss: 284022.7604; train_gene_expr_recon_loss: 427332.5625; train_masked_gp_l1_reg_loss: 9250.6372; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238097.8021; train_global_loss: 982390.0833; train_optim_loss: 982390.0833; val_kl_reg_loss: 21061.2617; val_edge_recon_loss: 284008.1250; val_gene_expr_recon_loss: 431898.0000; val_masked_gp_l1_reg_loss: 9242.8271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235677.4219; val_global_loss: 981887.6250; val_optim_loss: 981887.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9738; val_auprc_score: 0.9656; val_best_acc_score: 0.9291; val_best_f1_score: 0.9316; train_kl_reg_loss: 23338.8546; train_edge_recon_loss: 284126.5069; train_gene_expr_recon_loss: 423902.9826; train_masked_gp_l1_reg_loss: 9239.5543; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237610.0764; train_global_loss: 978217.9653; train_optim_loss: 978217.9653; val_kl_reg_loss: 21009.0488; val_edge_recon_loss: 284373.8125; val_gene_expr_recon_loss: 431921.4062; val_masked_gp_l1_reg_loss: 9234.7168; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235614.1875; val_global_loss: 982153.1250; val_optim_loss: 982153.1250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9751; val_auprc_score: 0.9656; val_best_acc_score: 0.9276; val_best_f1_score: 0.9302; train_kl_reg_loss: 23527.1838; train_edge_recon_loss: 284588.0590; train_gene_expr_recon_loss: 426885.3889; train_masked_gp_l1_reg_loss: 9232.4283; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238017.0191; train_global_loss: 982250.0833; train_optim_loss: 982250.0833; val_kl_reg_loss: 21276.5898; val_edge_recon_loss: 286656.7500; val_gene_expr_recon_loss: 431344.1875; val_masked_gp_l1_reg_loss: 9229.8252; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235525.2656; val_global_loss: 984032.5625; val_optim_loss: 984032.5625
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9745; val_auprc_score: 0.9636; val_best_acc_score: 0.9289; val_best_f1_score: 0.9313; train_kl_reg_loss: 23357.5894; train_edge_recon_loss: 283917.4375; train_gene_expr_recon_loss: 427632.7118; train_masked_gp_l1_reg_loss: 9228.0281; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238706.2222; train_global_loss: 982841.9792; train_optim_loss: 982841.9792; val_kl_reg_loss: 21104.4102; val_edge_recon_loss: 285343.8438; val_gene_expr_recon_loss: 431582.5625; val_masked_gp_l1_reg_loss: 9226.1172; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235513.9688; val_global_loss: 982770.8750; val_optim_loss: 982770.8750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9760; val_auprc_score: 0.9651; val_best_acc_score: 0.9332; val_best_f1_score: 0.9354; train_kl_reg_loss: 23301.4965; train_edge_recon_loss: 284261.2153; train_gene_expr_recon_loss: 425464.7882; train_masked_gp_l1_reg_loss: 9225.6851; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236839.2135; train_global_loss: 979092.4167; train_optim_loss: 979092.4167; val_kl_reg_loss: 21173.0000; val_edge_recon_loss: 282864.2500; val_gene_expr_recon_loss: 431245.5625; val_masked_gp_l1_reg_loss: 9224.8164; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235463.1562; val_global_loss: 979970.7500; val_optim_loss: 979970.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9768; val_auprc_score: 0.9685; val_best_acc_score: 0.9344; val_best_f1_score: 0.9369; train_kl_reg_loss: 23363.0302; train_edge_recon_loss: 283577.5903; train_gene_expr_recon_loss: 428595.0833; train_masked_gp_l1_reg_loss: 9224.3701; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239675.4132; train_global_loss: 984435.5000; train_optim_loss: 984435.5000; val_kl_reg_loss: 21166.9961; val_edge_recon_loss: 283214.6875; val_gene_expr_recon_loss: 431470.4062; val_masked_gp_l1_reg_loss: 9223.1816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235444.1875; val_global_loss: 980519.5000; val_optim_loss: 980519.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9767; val_auprc_score: 0.9684; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 23295.5254; train_edge_recon_loss: 284492.0799; train_gene_expr_recon_loss: 425472.9826; train_masked_gp_l1_reg_loss: 9223.9048; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237330.6806; train_global_loss: 979815.1667; train_optim_loss: 979815.1667; val_kl_reg_loss: 21237.3984; val_edge_recon_loss: 284189.4062; val_gene_expr_recon_loss: 431120.3125; val_masked_gp_l1_reg_loss: 9223.6348; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235403.3750; val_global_loss: 981174.1250; val_optim_loss: 981174.1250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9743; val_auprc_score: 0.9634; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 23189.9935; train_edge_recon_loss: 283857.9583; train_gene_expr_recon_loss: 426128.6076; train_masked_gp_l1_reg_loss: 9223.0346; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237000.8438; train_global_loss: 979400.4306; train_optim_loss: 979400.4306; val_kl_reg_loss: 21241.0703; val_edge_recon_loss: 285050.7500; val_gene_expr_recon_loss: 431055.9375; val_masked_gp_l1_reg_loss: 9222.3965; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235426.7812; val_global_loss: 981996.8750; val_optim_loss: 981996.8750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9769; val_auprc_score: 0.9698; val_best_acc_score: 0.9325; val_best_f1_score: 0.9346; train_kl_reg_loss: 23264.7428; train_edge_recon_loss: 283626.4653; train_gene_expr_recon_loss: 423982.8819; train_masked_gp_l1_reg_loss: 9222.1864; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236319.4583; train_global_loss: 976415.7361; train_optim_loss: 976415.7361; val_kl_reg_loss: 21250.4121; val_edge_recon_loss: 283922.9688; val_gene_expr_recon_loss: 431369.6562; val_masked_gp_l1_reg_loss: 9221.6318; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235430.9531; val_global_loss: 981195.5625; val_optim_loss: 981195.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9767; val_auprc_score: 0.9656; val_best_acc_score: 0.9365; val_best_f1_score: 0.9383; train_kl_reg_loss: 23205.4605; train_edge_recon_loss: 283068.6736; train_gene_expr_recon_loss: 426760.6181; train_masked_gp_l1_reg_loss: 9213.3765; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237693.9861; train_global_loss: 979942.0903; train_optim_loss: 979942.0903; val_kl_reg_loss: 21275.3086; val_edge_recon_loss: 283444.4688; val_gene_expr_recon_loss: 431238.7812; val_masked_gp_l1_reg_loss: 9206.2754; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235388.9375; val_global_loss: 980553.7500; val_optim_loss: 980553.7500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9745; val_auprc_score: 0.9654; val_best_acc_score: 0.9297; val_best_f1_score: 0.9314; train_kl_reg_loss: 23211.2869; train_edge_recon_loss: 283355.0347; train_gene_expr_recon_loss: 426426.1250; train_masked_gp_l1_reg_loss: 9204.8739; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237386.9740; train_global_loss: 979584.3125; train_optim_loss: 979584.3125; val_kl_reg_loss: 21297.7207; val_edge_recon_loss: 285454.7188; val_gene_expr_recon_loss: 430934.0000; val_masked_gp_l1_reg_loss: 9202.3232; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235382.9531; val_global_loss: 982271.6875; val_optim_loss: 982271.6875
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9764; val_auprc_score: 0.9663; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 23258.7326; train_edge_recon_loss: 283624.1215; train_gene_expr_recon_loss: 425852.4549; train_masked_gp_l1_reg_loss: 9201.2679; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237605.8906; train_global_loss: 979542.4514; train_optim_loss: 979542.4514; val_kl_reg_loss: 21276.4258; val_edge_recon_loss: 285195.3750; val_gene_expr_recon_loss: 430920.2500; val_masked_gp_l1_reg_loss: 9200.0010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235361.8125; val_global_loss: 981953.8750; val_optim_loss: 981953.8750
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9781; val_auprc_score: 0.9710; val_best_acc_score: 0.9348; val_best_f1_score: 0.9367; train_kl_reg_loss: 23205.5315; train_edge_recon_loss: 284007.3090; train_gene_expr_recon_loss: 425613.9340; train_masked_gp_l1_reg_loss: 9199.3251; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237908.0312; train_global_loss: 979934.1111; train_optim_loss: 979934.1111; val_kl_reg_loss: 21216.1445; val_edge_recon_loss: 283916.8125; val_gene_expr_recon_loss: 430994.4375; val_masked_gp_l1_reg_loss: 9198.5996; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235330.3906; val_global_loss: 980656.3750; val_optim_loss: 980656.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 1 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9780
val AUPRC score: 0.9718
val best accuracy score: 0.9325
val best F1 score: 0.9351
val target rna MSE score: 0.3927
val source rna MSE score: 0.2272
val target atac MSE score: 0.1320
val source atac MSE score: 0.0197
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
