[True]
Run timestamp: 26072023_223350_62.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_62']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8773; val_auprc_score: 0.9760; val_best_acc_score: 0.8565; val_best_f1_score: 0.9226; train_kl_reg_loss: 103753.2239; train_edge_recon_loss: 1101226.3433; train_gene_expr_recon_loss: 1626446.4279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2831425.9878; train_optim_loss: 2831425.9878; val_kl_reg_loss: 70195.7692; val_edge_recon_loss: 1173004.9401; val_gene_expr_recon_loss: 1124354.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2367555.0052; val_optim_loss: 2367555.0052
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8509; val_auprc_score: 0.9705; val_best_acc_score: 0.8660; val_best_f1_score: 0.9262; train_kl_reg_loss: 66802.7458; train_edge_recon_loss: 1068671.2494; train_gene_expr_recon_loss: 1077205.7102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2212679.6994; train_optim_loss: 2212679.6994; val_kl_reg_loss: 59500.2858; val_edge_recon_loss: 1190359.0156; val_gene_expr_recon_loss: 1022167.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2272026.5521; val_optim_loss: 2272026.5521
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8540; val_auprc_score: 0.9665; val_best_acc_score: 0.8862; val_best_f1_score: 0.9364; train_kl_reg_loss: 50695.8415; train_edge_recon_loss: 1058112.8605; train_gene_expr_recon_loss: 1003760.7221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2112569.4233; train_optim_loss: 2112569.4233; val_kl_reg_loss: 38034.8177; val_edge_recon_loss: 1095328.5859; val_gene_expr_recon_loss: 978110.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2111474.3333; val_optim_loss: 2111474.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8480; val_auprc_score: 0.9671; val_best_acc_score: 0.8941; val_best_f1_score: 0.9412; train_kl_reg_loss: 48076.2272; train_edge_recon_loss: 947254.0686; train_gene_expr_recon_loss: 962063.3997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1957393.6994; train_optim_loss: 1957393.6994; val_kl_reg_loss: 47746.3861; val_edge_recon_loss: 901322.4193; val_gene_expr_recon_loss: 939515.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1888583.8906; val_optim_loss: 1888583.8906
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8470; val_auprc_score: 0.9657; val_best_acc_score: 0.8957; val_best_f1_score: 0.9415; train_kl_reg_loss: 44835.9489; train_edge_recon_loss: 899605.3442; train_gene_expr_recon_loss: 925998.1730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1870439.4628; train_optim_loss: 1870439.4628; val_kl_reg_loss: 37520.2899; val_edge_recon_loss: 916202.1302; val_gene_expr_recon_loss: 906611.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1860334.1094; val_optim_loss: 1860334.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8674; val_auprc_score: 0.9710; val_best_acc_score: 0.9079; val_best_f1_score: 0.9481; train_kl_reg_loss: 36498.6697; train_edge_recon_loss: 871431.6808; train_gene_expr_recon_loss: 895366.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1803296.5860; train_optim_loss: 1803296.5860; val_kl_reg_loss: 32654.5474; val_edge_recon_loss: 859354.0833; val_gene_expr_recon_loss: 879760.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1771769.4323; val_optim_loss: 1771769.4323
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9003; val_auprc_score: 0.9788; val_best_acc_score: 0.9148; val_best_f1_score: 0.9520; train_kl_reg_loss: 30754.6403; train_edge_recon_loss: 839852.8985; train_gene_expr_recon_loss: 871654.4602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1742262.0012; train_optim_loss: 1742262.0012; val_kl_reg_loss: 27313.8622; val_edge_recon_loss: 810886.5781; val_gene_expr_recon_loss: 857885.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1696086.2240; val_optim_loss: 1696086.2240
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9075; val_auprc_score: 0.9795; val_best_acc_score: 0.9212; val_best_f1_score: 0.9549; train_kl_reg_loss: 26432.8838; train_edge_recon_loss: 820707.8041; train_gene_expr_recon_loss: 851775.4148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1698916.1029; train_optim_loss: 1698916.1029; val_kl_reg_loss: 23679.2752; val_edge_recon_loss: 840502.4427; val_gene_expr_recon_loss: 839767.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1703949.2760; val_optim_loss: 1703949.2760
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9143; val_auprc_score: 0.9810; val_best_acc_score: 0.9221; val_best_f1_score: 0.9557; train_kl_reg_loss: 22273.7795; train_edge_recon_loss: 808765.2750; train_gene_expr_recon_loss: 834533.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1665572.8093; train_optim_loss: 1665572.8093; val_kl_reg_loss: 19904.4373; val_edge_recon_loss: 806951.8516; val_gene_expr_recon_loss: 825433.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1652289.3802; val_optim_loss: 1652289.3802
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9291; val_auprc_score: 0.9842; val_best_acc_score: 0.9232; val_best_f1_score: 0.9557; train_kl_reg_loss: 18384.4410; train_edge_recon_loss: 793090.0270; train_gene_expr_recon_loss: 820392.3250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1631866.7965; train_optim_loss: 1631866.7965; val_kl_reg_loss: 16700.9488; val_edge_recon_loss: 824752.3854; val_gene_expr_recon_loss: 811663.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1653117.2604; val_optim_loss: 1653117.2604
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9436; val_auprc_score: 0.9884; val_best_acc_score: 0.9327; val_best_f1_score: 0.9612; train_kl_reg_loss: 15332.3447; train_edge_recon_loss: 793815.2890; train_gene_expr_recon_loss: 807479.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1616626.8965; train_optim_loss: 1616626.8965; val_kl_reg_loss: 14065.2644; val_edge_recon_loss: 790330.9089; val_gene_expr_recon_loss: 799507.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1603903.9792; val_optim_loss: 1603903.9792
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9401; val_auprc_score: 0.9865; val_best_acc_score: 0.9300; val_best_f1_score: 0.9594; train_kl_reg_loss: 13738.5390; train_edge_recon_loss: 782399.4067; train_gene_expr_recon_loss: 796355.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1592493.1971; train_optim_loss: 1592493.1971; val_kl_reg_loss: 13364.9747; val_edge_recon_loss: 818600.7786; val_gene_expr_recon_loss: 789239.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1621205.2552; val_optim_loss: 1621205.2552
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9485; val_auprc_score: 0.9880; val_best_acc_score: 0.9385; val_best_f1_score: 0.9645; train_kl_reg_loss: 12890.4604; train_edge_recon_loss: 784090.2113; train_gene_expr_recon_loss: 786284.4619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1583265.1430; train_optim_loss: 1583265.1430; val_kl_reg_loss: 12520.7869; val_edge_recon_loss: 788089.3984; val_gene_expr_recon_loss: 779672.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1580282.3490; val_optim_loss: 1580282.3490
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9472; val_auprc_score: 0.9880; val_best_acc_score: 0.9386; val_best_f1_score: 0.9646; train_kl_reg_loss: 12369.1439; train_edge_recon_loss: 781843.4811; train_gene_expr_recon_loss: 777512.8078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1571725.4331; train_optim_loss: 1571725.4331; val_kl_reg_loss: 11980.9772; val_edge_recon_loss: 786844.0807; val_gene_expr_recon_loss: 771010.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1569835.2812; val_optim_loss: 1569835.2812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9505; val_auprc_score: 0.9894; val_best_acc_score: 0.9400; val_best_f1_score: 0.9654; train_kl_reg_loss: 11845.1104; train_edge_recon_loss: 771521.2058; train_gene_expr_recon_loss: 769915.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1553282.0244; train_optim_loss: 1553282.0244; val_kl_reg_loss: 11174.0619; val_edge_recon_loss: 782437.8047; val_gene_expr_recon_loss: 764637.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1558249.4740; val_optim_loss: 1558249.4740
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9505; val_auprc_score: 0.9877; val_best_acc_score: 0.9441; val_best_f1_score: 0.9677; train_kl_reg_loss: 11520.4584; train_edge_recon_loss: 777426.1689; train_gene_expr_recon_loss: 762867.5134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1551814.1360; train_optim_loss: 1551814.1360; val_kl_reg_loss: 11247.9252; val_edge_recon_loss: 784098.5000; val_gene_expr_recon_loss: 758739.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554085.9688; val_optim_loss: 1554085.9688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9562; val_auprc_score: 0.9899; val_best_acc_score: 0.9416; val_best_f1_score: 0.9665; train_kl_reg_loss: 11326.2976; train_edge_recon_loss: 775670.3099; train_gene_expr_recon_loss: 756530.0363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1543526.6384; train_optim_loss: 1543526.6384; val_kl_reg_loss: 11002.5750; val_edge_recon_loss: 761431.3099; val_gene_expr_recon_loss: 751856.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1524290.2188; val_optim_loss: 1524290.2188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9546; val_auprc_score: 0.9886; val_best_acc_score: 0.9449; val_best_f1_score: 0.9683; train_kl_reg_loss: 11176.7704; train_edge_recon_loss: 774890.0369; train_gene_expr_recon_loss: 751103.0770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1537169.8797; train_optim_loss: 1537169.8797; val_kl_reg_loss: 10730.6793; val_edge_recon_loss: 776960.7891; val_gene_expr_recon_loss: 745341.1276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1533032.5885; val_optim_loss: 1533032.5885
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9526; val_auprc_score: 0.9882; val_best_acc_score: 0.9436; val_best_f1_score: 0.9673; train_kl_reg_loss: 10876.0510; train_edge_recon_loss: 773026.3648; train_gene_expr_recon_loss: 745567.0070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1529469.4267; train_optim_loss: 1529469.4267; val_kl_reg_loss: 11152.8495; val_edge_recon_loss: 799790.2865; val_gene_expr_recon_loss: 741835.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1552778.2865; val_optim_loss: 1552778.2865
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9599; val_auprc_score: 0.9899; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 10755.1252; train_edge_recon_loss: 779607.3151; train_gene_expr_recon_loss: 740513.9407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1530876.3791; train_optim_loss: 1530876.3791; val_kl_reg_loss: 10020.5208; val_edge_recon_loss: 773357.3776; val_gene_expr_recon_loss: 736478.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1519856.2083; val_optim_loss: 1519856.2083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9553; val_auprc_score: 0.9897; val_best_acc_score: 0.9444; val_best_f1_score: 0.9677; train_kl_reg_loss: 10437.7166; train_edge_recon_loss: 758479.8125; train_gene_expr_recon_loss: 736201.3078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505118.8372; train_optim_loss: 1505118.8372; val_kl_reg_loss: 10950.5928; val_edge_recon_loss: 798153.5807; val_gene_expr_recon_loss: 734442.9870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1543547.1615; val_optim_loss: 1543547.1615
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9571; val_auprc_score: 0.9892; val_best_acc_score: 0.9464; val_best_f1_score: 0.9689; train_kl_reg_loss: 10549.4338; train_edge_recon_loss: 766549.3942; train_gene_expr_recon_loss: 732305.0576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509403.8826; train_optim_loss: 1509403.8826; val_kl_reg_loss: 10258.8078; val_edge_recon_loss: 796632.4688; val_gene_expr_recon_loss: 728745.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1535636.3802; val_optim_loss: 1535636.3802
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9616; val_auprc_score: 0.9911; val_best_acc_score: 0.9493; val_best_f1_score: 0.9707; train_kl_reg_loss: 10434.5506; train_edge_recon_loss: 767877.2608; train_gene_expr_recon_loss: 728593.1753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506904.9826; train_optim_loss: 1506904.9826; val_kl_reg_loss: 10515.3088; val_edge_recon_loss: 777698.4245; val_gene_expr_recon_loss: 724350.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512563.7396; val_optim_loss: 1512563.7396
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9667; val_auprc_score: 0.9920; val_best_acc_score: 0.9521; val_best_f1_score: 0.9721; train_kl_reg_loss: 10412.3488; train_edge_recon_loss: 766776.6099; train_gene_expr_recon_loss: 725370.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1502559.9285; train_optim_loss: 1502559.9285; val_kl_reg_loss: 10297.3311; val_edge_recon_loss: 804301.8594; val_gene_expr_recon_loss: 721819.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1536418.6562; val_optim_loss: 1536418.6562
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9601; val_auprc_score: 0.9901; val_best_acc_score: 0.9514; val_best_f1_score: 0.9719; train_kl_reg_loss: 10344.8919; train_edge_recon_loss: 765525.6762; train_gene_expr_recon_loss: 721437.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497307.6959; train_optim_loss: 1497307.6959; val_kl_reg_loss: 10430.5258; val_edge_recon_loss: 786958.6901; val_gene_expr_recon_loss: 718407.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1515796.9948; val_optim_loss: 1515796.9948
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9646; val_auprc_score: 0.9903; val_best_acc_score: 0.9543; val_best_f1_score: 0.9734; train_kl_reg_loss: 9601.4063; train_edge_recon_loss: 772477.4259; train_gene_expr_recon_loss: 719723.8174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501802.6471; train_optim_loss: 1501802.6471; val_kl_reg_loss: 7883.5919; val_edge_recon_loss: 796641.1745; val_gene_expr_recon_loss: 716656.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1521180.8594; val_optim_loss: 1521180.8594
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9597; val_auprc_score: 0.9905; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 8876.7509; train_edge_recon_loss: 769479.9904; train_gene_expr_recon_loss: 716955.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495311.7709; train_optim_loss: 1495311.7709; val_kl_reg_loss: 7632.7691; val_edge_recon_loss: 792421.1458; val_gene_expr_recon_loss: 713311.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513365.6094; val_optim_loss: 1513365.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9636; val_auprc_score: 0.9917; val_best_acc_score: 0.9533; val_best_f1_score: 0.9729; train_kl_reg_loss: 8697.3446; train_edge_recon_loss: 769934.6692; train_gene_expr_recon_loss: 713969.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492602.0081; train_optim_loss: 1492602.0081; val_kl_reg_loss: 7470.5455; val_edge_recon_loss: 787028.5052; val_gene_expr_recon_loss: 712206.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506705.9010; val_optim_loss: 1506705.9010
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9663; val_auprc_score: 0.9918; val_best_acc_score: 0.9544; val_best_f1_score: 0.9735; train_kl_reg_loss: 8688.4886; train_edge_recon_loss: 762613.9276; train_gene_expr_recon_loss: 713768.1762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485070.5878; train_optim_loss: 1485070.5878; val_kl_reg_loss: 7421.8201; val_edge_recon_loss: 793776.5938; val_gene_expr_recon_loss: 711389.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512587.7656; val_optim_loss: 1512587.7656
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9643; val_auprc_score: 0.9923; val_best_acc_score: 0.9553; val_best_f1_score: 0.9743; train_kl_reg_loss: 8621.8700; train_edge_recon_loss: 769597.6355; train_gene_expr_recon_loss: 713291.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491510.6384; train_optim_loss: 1491510.6384; val_kl_reg_loss: 7422.2137; val_edge_recon_loss: 754515.5156; val_gene_expr_recon_loss: 710789.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1472727.0156; val_optim_loss: 1472727.0156
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9683; val_auprc_score: 0.9928; val_best_acc_score: 0.9553; val_best_f1_score: 0.9742; train_kl_reg_loss: 8556.2459; train_edge_recon_loss: 771283.3462; train_gene_expr_recon_loss: 712765.2291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492604.8192; train_optim_loss: 1492604.8192; val_kl_reg_loss: 7395.4602; val_edge_recon_loss: 770354.1276; val_gene_expr_recon_loss: 711425.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1489175.4115; val_optim_loss: 1489175.4115
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9655; val_auprc_score: 0.9919; val_best_acc_score: 0.9572; val_best_f1_score: 0.9752; train_kl_reg_loss: 8541.6408; train_edge_recon_loss: 766551.3695; train_gene_expr_recon_loss: 712443.2701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1487536.2767; train_optim_loss: 1487536.2767; val_kl_reg_loss: 7300.6265; val_edge_recon_loss: 753695.7448; val_gene_expr_recon_loss: 710762.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1471759.3438; val_optim_loss: 1471759.3438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9665; val_auprc_score: 0.9919; val_best_acc_score: 0.9564; val_best_f1_score: 0.9748; train_kl_reg_loss: 8510.5285; train_edge_recon_loss: 770870.4872; train_gene_expr_recon_loss: 712293.9823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491675.0000; train_optim_loss: 1491675.0000; val_kl_reg_loss: 7277.0976; val_edge_recon_loss: 771014.8802; val_gene_expr_recon_loss: 710775.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1489066.9948; val_optim_loss: 1489066.9948
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9680; val_auprc_score: 0.9924; val_best_acc_score: 0.9568; val_best_f1_score: 0.9749; train_kl_reg_loss: 8336.5579; train_edge_recon_loss: 760565.0224; train_gene_expr_recon_loss: 711882.1427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1480783.7209; train_optim_loss: 1480783.7209; val_kl_reg_loss: 7271.0842; val_edge_recon_loss: 779020.0651; val_gene_expr_recon_loss: 710024.3151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1496315.4635; val_optim_loss: 1496315.4635
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9607; val_auprc_score: 0.9911; val_best_acc_score: 0.9531; val_best_f1_score: 0.9730; train_kl_reg_loss: 8310.4109; train_edge_recon_loss: 766953.6942; train_gene_expr_recon_loss: 711543.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1486807.5157; train_optim_loss: 1486807.5157; val_kl_reg_loss: 7249.8329; val_edge_recon_loss: 774944.3151; val_gene_expr_recon_loss: 710160.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492354.6510; val_optim_loss: 1492354.6510
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9615; val_auprc_score: 0.9904; val_best_acc_score: 0.9541; val_best_f1_score: 0.9732; train_kl_reg_loss: 8311.1340; train_edge_recon_loss: 763581.9352; train_gene_expr_recon_loss: 711322.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1483215.4913; train_optim_loss: 1483215.4913; val_kl_reg_loss: 7154.8908; val_edge_recon_loss: 811563.6458; val_gene_expr_recon_loss: 709716.5130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1528435.0573; val_optim_loss: 1528435.0573

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9676; val_auprc_score: 0.9925; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 8195.8819; train_edge_recon_loss: 762358.0360; train_gene_expr_recon_loss: 711079.6020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1481633.5198; train_optim_loss: 1481633.5198; val_kl_reg_loss: 7125.4118; val_edge_recon_loss: 771718.8307; val_gene_expr_recon_loss: 709299.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488143.8958; val_optim_loss: 1488143.8958
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9646; val_auprc_score: 0.9917; val_best_acc_score: 0.9537; val_best_f1_score: 0.9732; train_kl_reg_loss: 8177.0416; train_edge_recon_loss: 760543.2927; train_gene_expr_recon_loss: 711109.8634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1479830.1965; train_optim_loss: 1479830.1965; val_kl_reg_loss: 7126.6385; val_edge_recon_loss: 787342.7839; val_gene_expr_recon_loss: 709704.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1504174.1458; val_optim_loss: 1504174.1458
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9645; val_auprc_score: 0.9919; val_best_acc_score: 0.9565; val_best_f1_score: 0.9748; train_kl_reg_loss: 8189.9458; train_edge_recon_loss: 763085.0331; train_gene_expr_recon_loss: 710684.6945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1481959.6744; train_optim_loss: 1481959.6744; val_kl_reg_loss: 7159.9980; val_edge_recon_loss: 777639.5104; val_gene_expr_recon_loss: 709626.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494426.2604; val_optim_loss: 1494426.2604
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9635; val_auprc_score: 0.9915; val_best_acc_score: 0.9539; val_best_f1_score: 0.9732; train_kl_reg_loss: 8222.2074; train_edge_recon_loss: 759530.2212; train_gene_expr_recon_loss: 710636.8253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478389.2552; train_optim_loss: 1478389.2552; val_kl_reg_loss: 7171.4732; val_edge_recon_loss: 787047.0599; val_gene_expr_recon_loss: 709049.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1503267.7552; val_optim_loss: 1503267.7552

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 50 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9624
Val AUPRC score: 0.9911
Val best accuracy score: 0.9558
Val best F1 score: 0.9743
Val gene expr MSE score: 40409.8986
Val cat covariate0 mean sim diff: -0.0015

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
