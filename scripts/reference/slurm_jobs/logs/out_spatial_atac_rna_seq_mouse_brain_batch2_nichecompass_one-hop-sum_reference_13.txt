[True]
Run timestamp: 10082023_191338_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7615; val_auprc_score: 0.7761; val_best_acc_score: 0.5788; val_best_f1_score: 0.6987; train_kl_reg_loss: 131473.9558; train_edge_recon_loss: 3668661.3817; train_gene_expr_recon_loss: 28848817.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25641931.0840; train_global_loss: 58290884.5191; train_optim_loss: 58290884.5191; val_kl_reg_loss: 174755.5417; val_edge_recon_loss: 4061157.0333; val_gene_expr_recon_loss: 23383777.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23477547.7333; val_global_loss: 51097237.6000; val_optim_loss: 51097237.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8047; val_auprc_score: 0.8177; val_best_acc_score: 0.7137; val_best_f1_score: 0.7372; train_kl_reg_loss: 177361.5701; train_edge_recon_loss: 3625478.9943; train_gene_expr_recon_loss: 22727050.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23163899.0229; train_global_loss: 49693789.8931; train_optim_loss: 49693789.8931; val_kl_reg_loss: 213291.2812; val_edge_recon_loss: 4042873.4500; val_gene_expr_recon_loss: 22466775.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23311775.2000; val_global_loss: 50034716.0000; val_optim_loss: 50034716.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8626; val_auprc_score: 0.8597; val_best_acc_score: 0.7643; val_best_f1_score: 0.7843; train_kl_reg_loss: 154603.2851; train_edge_recon_loss: 3477127.3702; train_gene_expr_recon_loss: 22223677.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22903684.2443; train_global_loss: 48759092.3053; train_optim_loss: 48759092.3053; val_kl_reg_loss: 157199.1688; val_edge_recon_loss: 3198427.2667; val_gene_expr_recon_loss: 22252584.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23093373.7333; val_global_loss: 48701584.2667; val_optim_loss: 48701584.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8776; val_auprc_score: 0.8656; val_best_acc_score: 0.7926; val_best_f1_score: 0.8075; train_kl_reg_loss: 183717.7213; train_edge_recon_loss: 3045923.8969; train_gene_expr_recon_loss: 22012541.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22788499.9084; train_global_loss: 48030682.5649; train_optim_loss: 48030682.5649; val_kl_reg_loss: 186542.3000; val_edge_recon_loss: 3019252.3000; val_gene_expr_recon_loss: 21994819.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22876294.9333; val_global_loss: 48076909.3333; val_optim_loss: 48076909.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9057; val_auprc_score: 0.8935; val_best_acc_score: 0.8216; val_best_f1_score: 0.8326; train_kl_reg_loss: 171383.4662; train_edge_recon_loss: 2975152.0630; train_gene_expr_recon_loss: 21827649.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22641736.7786; train_global_loss: 47615921.9237; train_optim_loss: 47615921.9237; val_kl_reg_loss: 166570.2125; val_edge_recon_loss: 2958997.0833; val_gene_expr_recon_loss: 21767809.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22781716.6667; val_global_loss: 47675093.0667; val_optim_loss: 47675093.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9204; val_auprc_score: 0.9029; val_best_acc_score: 0.8523; val_best_f1_score: 0.8603; train_kl_reg_loss: 163040.4846; train_edge_recon_loss: 2931872.8664; train_gene_expr_recon_loss: 21690163.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22523409.0840; train_global_loss: 47308486.1069; train_optim_loss: 47308486.1069; val_kl_reg_loss: 157640.6729; val_edge_recon_loss: 2906401.9500; val_gene_expr_recon_loss: 21720383.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22669210.4000; val_global_loss: 47453636.5333; val_optim_loss: 47453636.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9286; val_auprc_score: 0.9136; val_best_acc_score: 0.8630; val_best_f1_score: 0.8713; train_kl_reg_loss: 158273.9135; train_edge_recon_loss: 2868365.1985; train_gene_expr_recon_loss: 21583993.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22421584.9924; train_global_loss: 47032217.5267; train_optim_loss: 47032217.5267; val_kl_reg_loss: 158674.4156; val_edge_recon_loss: 2878075.4667; val_gene_expr_recon_loss: 21585174.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22568864.2667; val_global_loss: 47190788.5333; val_optim_loss: 47190788.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9328; val_auprc_score: 0.9179; val_best_acc_score: 0.8680; val_best_f1_score: 0.8778; train_kl_reg_loss: 153775.9328; train_edge_recon_loss: 2839326.3244; train_gene_expr_recon_loss: 21486407.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22336528.2748; train_global_loss: 46816038.2290; train_optim_loss: 46816038.2290; val_kl_reg_loss: 151460.7906; val_edge_recon_loss: 2841754.3167; val_gene_expr_recon_loss: 21476429.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22469730.1333; val_global_loss: 46939374.9333; val_optim_loss: 46939374.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9465; val_auprc_score: 0.9337; val_best_acc_score: 0.8845; val_best_f1_score: 0.8911; train_kl_reg_loss: 149136.7563; train_edge_recon_loss: 2816900.0019; train_gene_expr_recon_loss: 21363153.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22210208.1679; train_global_loss: 46539398.9008; train_optim_loss: 46539398.9008; val_kl_reg_loss: 147728.9125; val_edge_recon_loss: 2807366.5500; val_gene_expr_recon_loss: 21446228.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22473369.2000; val_global_loss: 46874693.8667; val_optim_loss: 46874693.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9465; val_auprc_score: 0.9292; val_best_acc_score: 0.8884; val_best_f1_score: 0.8958; train_kl_reg_loss: 143630.2603; train_edge_recon_loss: 2796835.5706; train_gene_expr_recon_loss: 21273342.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22114640.7176; train_global_loss: 46328449.2214; train_optim_loss: 46328449.2214; val_kl_reg_loss: 142350.8542; val_edge_recon_loss: 2796445.2667; val_gene_expr_recon_loss: 21315312.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22212050.0000; val_global_loss: 46466158.4000; val_optim_loss: 46466158.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9528; val_auprc_score: 0.9395; val_best_acc_score: 0.8945; val_best_f1_score: 0.8993; train_kl_reg_loss: 140018.8065; train_edge_recon_loss: 2790090.6107; train_gene_expr_recon_loss: 21198810.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22042004.8702; train_global_loss: 46170925.1298; train_optim_loss: 46170925.1298; val_kl_reg_loss: 136074.5917; val_edge_recon_loss: 2793422.6333; val_gene_expr_recon_loss: 21283458.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22226962.8000; val_global_loss: 46439918.6667; val_optim_loss: 46439918.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9527; val_auprc_score: 0.9405; val_best_acc_score: 0.8894; val_best_f1_score: 0.8957; train_kl_reg_loss: 134724.8293; train_edge_recon_loss: 2779937.5763; train_gene_expr_recon_loss: 21125123.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21949631.3740; train_global_loss: 45989417.2824; train_optim_loss: 45989417.2824; val_kl_reg_loss: 133386.5073; val_edge_recon_loss: 2777699.9500; val_gene_expr_recon_loss: 21180397.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22038592.6667; val_global_loss: 46130076.8000; val_optim_loss: 46130076.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9562; val_auprc_score: 0.9439; val_best_acc_score: 0.8954; val_best_f1_score: 0.9006; train_kl_reg_loss: 131154.3191; train_edge_recon_loss: 2761437.2996; train_gene_expr_recon_loss: 21063701.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21908685.3130; train_global_loss: 45864978.0153; train_optim_loss: 45864978.0153; val_kl_reg_loss: 128180.2167; val_edge_recon_loss: 2782457.6333; val_gene_expr_recon_loss: 21128769.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22114167.4667; val_global_loss: 46153574.6667; val_optim_loss: 46153574.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9588; val_auprc_score: 0.9481; val_best_acc_score: 0.8992; val_best_f1_score: 0.9033; train_kl_reg_loss: 127004.9830; train_edge_recon_loss: 2764612.4065; train_gene_expr_recon_loss: 20996712.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21835428.3817; train_global_loss: 45723758.2290; train_optim_loss: 45723758.2290; val_kl_reg_loss: 125828.2026; val_edge_recon_loss: 2776027.0667; val_gene_expr_recon_loss: 21113682.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22068161.2000; val_global_loss: 46083699.2000; val_optim_loss: 46083699.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9615; val_auprc_score: 0.9512; val_best_acc_score: 0.9064; val_best_f1_score: 0.9096; train_kl_reg_loss: 123038.4150; train_edge_recon_loss: 2750946.7920; train_gene_expr_recon_loss: 20913208.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21732121.4198; train_global_loss: 45519315.2061; train_optim_loss: 45519315.2061; val_kl_reg_loss: 124260.5026; val_edge_recon_loss: 2757231.2667; val_gene_expr_recon_loss: 21017336.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22019497.4667; val_global_loss: 45918325.8667; val_optim_loss: 45918325.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9630; val_auprc_score: 0.9521; val_best_acc_score: 0.9060; val_best_f1_score: 0.9094; train_kl_reg_loss: 120454.4263; train_edge_recon_loss: 2750072.0134; train_gene_expr_recon_loss: 20883900.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21720733.7863; train_global_loss: 45475160.7328; train_optim_loss: 45475160.7328; val_kl_reg_loss: 118440.4182; val_edge_recon_loss: 2760542.0833; val_gene_expr_recon_loss: 20959887.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21934752.1333; val_global_loss: 45773622.4000; val_optim_loss: 45773622.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9681; val_auprc_score: 0.9603; val_best_acc_score: 0.9155; val_best_f1_score: 0.9186; train_kl_reg_loss: 117649.5963; train_edge_recon_loss: 2742726.4046; train_gene_expr_recon_loss: 20850868.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21696130.3511; train_global_loss: 45407375.0840; train_optim_loss: 45407375.0840; val_kl_reg_loss: 113410.3214; val_edge_recon_loss: 2762513.7667; val_gene_expr_recon_loss: 20881087.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21755806.4000; val_global_loss: 45512817.8667; val_optim_loss: 45512817.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9711; val_auprc_score: 0.9640; val_best_acc_score: 0.9197; val_best_f1_score: 0.9226; train_kl_reg_loss: 114001.1960; train_edge_recon_loss: 2740980.0859; train_gene_expr_recon_loss: 20767691.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21603976.0000; train_global_loss: 45226648.3969; train_optim_loss: 45226648.3969; val_kl_reg_loss: 113680.5109; val_edge_recon_loss: 2743124.0167; val_gene_expr_recon_loss: 20813990.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21716493.8667; val_global_loss: 45387288.5333; val_optim_loss: 45387288.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9685; val_auprc_score: 0.9621; val_best_acc_score: 0.9132; val_best_f1_score: 0.9159; train_kl_reg_loss: 112028.2505; train_edge_recon_loss: 2735130.4981; train_gene_expr_recon_loss: 20719197.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21558825.0534; train_global_loss: 45125180.9160; train_optim_loss: 45125180.9160; val_kl_reg_loss: 113126.3438; val_edge_recon_loss: 2760298.7500; val_gene_expr_recon_loss: 20832295.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21740479.6000; val_global_loss: 45446200.8000; val_optim_loss: 45446200.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9732; val_auprc_score: 0.9674; val_best_acc_score: 0.9260; val_best_f1_score: 0.9288; train_kl_reg_loss: 110735.9741; train_edge_recon_loss: 2729010.8817; train_gene_expr_recon_loss: 20658577.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21506571.7710; train_global_loss: 45004895.7252; train_optim_loss: 45004895.7252; val_kl_reg_loss: 107723.3208; val_edge_recon_loss: 2729847.0833; val_gene_expr_recon_loss: 20769666.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21683823.8667; val_global_loss: 45291060.5333; val_optim_loss: 45291060.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9714; val_auprc_score: 0.9629; val_best_acc_score: 0.9204; val_best_f1_score: 0.9226; train_kl_reg_loss: 107816.1765; train_edge_recon_loss: 2725298.2786; train_gene_expr_recon_loss: 20629147.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21481940.3206; train_global_loss: 44944202.3817; train_optim_loss: 44944202.3817; val_kl_reg_loss: 107758.2651; val_edge_recon_loss: 2759889.1833; val_gene_expr_recon_loss: 20736781.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21562251.8667; val_global_loss: 45166681.0667; val_optim_loss: 45166681.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9733; val_auprc_score: 0.9676; val_best_acc_score: 0.9262; val_best_f1_score: 0.9287; train_kl_reg_loss: 107748.9436; train_edge_recon_loss: 2714594.9962; train_gene_expr_recon_loss: 20621698.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21484447.6947; train_global_loss: 44928490.2595; train_optim_loss: 44928490.2595; val_kl_reg_loss: 106586.1609; val_edge_recon_loss: 2733434.2333; val_gene_expr_recon_loss: 20731957.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21696043.2000; val_global_loss: 45268021.3333; val_optim_loss: 45268021.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9768; val_auprc_score: 0.9722; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 105122.7725; train_edge_recon_loss: 2719289.6489; train_gene_expr_recon_loss: 20572058.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21438235.7863; train_global_loss: 44834706.3511; train_optim_loss: 44834706.3511; val_kl_reg_loss: 106240.0141; val_edge_recon_loss: 2736153.9667; val_gene_expr_recon_loss: 20608106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21435017.7333; val_global_loss: 44885517.6000; val_optim_loss: 44885517.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9765; val_auprc_score: 0.9721; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 105250.6080; train_edge_recon_loss: 2713701.9866; train_gene_expr_recon_loss: 20538522.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21442458.9618; train_global_loss: 44799934.4122; train_optim_loss: 44799934.4122; val_kl_reg_loss: 104568.2224; val_edge_recon_loss: 2738572.5833; val_gene_expr_recon_loss: 20677588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21622944.1333; val_global_loss: 45143672.5333; val_optim_loss: 45143672.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9780; val_auprc_score: 0.9736; val_best_acc_score: 0.9338; val_best_f1_score: 0.9362; train_kl_reg_loss: 103091.8771; train_edge_recon_loss: 2710576.0248; train_gene_expr_recon_loss: 20482162.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21373283.2824; train_global_loss: 44669113.3740; train_optim_loss: 44669113.3740; val_kl_reg_loss: 103380.4911; val_edge_recon_loss: 2725574.9000; val_gene_expr_recon_loss: 20665997.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21618490.5333; val_global_loss: 45113443.7333; val_optim_loss: 45113443.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9322; val_auprc_score: 0.9136; val_best_acc_score: 0.8653; val_best_f1_score: 0.8759; train_kl_reg_loss: 93539.9121; train_edge_recon_loss: 2860405.0363; train_gene_expr_recon_loss: 25308117.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22388838.0000; train_global_loss: 50650900.1221; train_optim_loss: 50650900.1221; val_kl_reg_loss: 13566.7225; val_edge_recon_loss: 2811372.4500; val_gene_expr_recon_loss: 24741094.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22458598.1333; val_global_loss: 50024632.2667; val_optim_loss: 50024632.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9234; val_auprc_score: 0.9016; val_best_acc_score: 0.8588; val_best_f1_score: 0.8700; train_kl_reg_loss: 59982.5482; train_edge_recon_loss: 2773966.7118; train_gene_expr_recon_loss: 24468228.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22303856.7481; train_global_loss: 49606034.3206; train_optim_loss: 49606034.3206; val_kl_reg_loss: 17782.3387; val_edge_recon_loss: 2767540.6500; val_gene_expr_recon_loss: 24311665.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22398711.6000; val_global_loss: 49495700.0000; val_optim_loss: 49495700.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9299; val_auprc_score: 0.9116; val_best_acc_score: 0.8635; val_best_f1_score: 0.8724; train_kl_reg_loss: 49334.1426; train_edge_recon_loss: 2750327.9313; train_gene_expr_recon_loss: 24209751.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22226512.5038; train_global_loss: 49235925.8931; train_optim_loss: 49235925.8931; val_kl_reg_loss: 18554.9363; val_edge_recon_loss: 2739969.3667; val_gene_expr_recon_loss: 24229334.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22351925.3333; val_global_loss: 49339784.5333; val_optim_loss: 49339784.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9267; val_auprc_score: 0.9074; val_best_acc_score: 0.8614; val_best_f1_score: 0.8694; train_kl_reg_loss: 48852.9364; train_edge_recon_loss: 2743465.8492; train_gene_expr_recon_loss: 24156186.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22178533.5725; train_global_loss: 49127038.6260; train_optim_loss: 49127038.6260; val_kl_reg_loss: 19853.4473; val_edge_recon_loss: 2761652.6500; val_gene_expr_recon_loss: 24169215.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22305665.4667; val_global_loss: 49256386.1333; val_optim_loss: 49256386.1333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9247; val_auprc_score: 0.9012; val_best_acc_score: 0.8600; val_best_f1_score: 0.8699; train_kl_reg_loss: 47716.3606; train_edge_recon_loss: 2740275.2576; train_gene_expr_recon_loss: 24141627.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22208096.6565; train_global_loss: 49137715.4504; train_optim_loss: 49137715.4504; val_kl_reg_loss: 20436.8596; val_edge_recon_loss: 2763172.4000; val_gene_expr_recon_loss: 24212174.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22456120.2667; val_global_loss: 49451903.4667; val_optim_loss: 49451903.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9286; val_auprc_score: 0.9058; val_best_acc_score: 0.8663; val_best_f1_score: 0.8747; train_kl_reg_loss: 46678.3066; train_edge_recon_loss: 2727897.1069; train_gene_expr_recon_loss: 24120170.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22206273.9695; train_global_loss: 49101019.7863; train_optim_loss: 49101019.7863; val_kl_reg_loss: 20721.4203; val_edge_recon_loss: 2745852.3667; val_gene_expr_recon_loss: 24127206.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22299686.2667; val_global_loss: 49193467.4667; val_optim_loss: 49193467.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 46 min 43 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9720
val AUPRC score: 0.9672
val best accuracy score: 0.9179
val best F1 score: 0.9198
val target rna MSE score: 1.9059
val source rna MSE score: 58.6721
val target atac MSE score: 0.1295
val source atac MSE score: 1.0423
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
