[True]
Run timestamp: 10102023_094323_220.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_220']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6801; val_auprc_score: 0.6463; val_best_acc_score: 0.5274; val_best_f1_score: 0.6773; train_kl_reg_loss: 36800.2378; train_edge_recon_loss: 724771.2216; train_gene_expr_recon_loss: 23169385.1818; train_masked_gp_l1_reg_loss: 157448.5083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4904081.5000; train_chrom_access_recon_loss: 2982684.7917; train_global_loss: 31975171.5758; train_optim_loss: 31975171.5758; val_kl_reg_loss: 79642.8369; val_edge_recon_loss: 812758.3047; val_gene_expr_recon_loss: 21331672.7500; val_masked_gp_l1_reg_loss: 126171.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2663708.0000; val_chrom_access_recon_loss: 2846743.4062; val_global_loss: 27860698.0000; val_optim_loss: 27860698.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7088; val_auprc_score: 0.6956; val_best_acc_score: 0.6021; val_best_f1_score: 0.7029; train_kl_reg_loss: 83904.3751; train_edge_recon_loss: 741254.3068; train_gene_expr_recon_loss: 21331060.4545; train_masked_gp_l1_reg_loss: 115417.3287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1430511.5038; train_chrom_access_recon_loss: 2825309.2235; train_global_loss: 26527457.2121; train_optim_loss: 26527457.2121; val_kl_reg_loss: 85992.5918; val_edge_recon_loss: 811877.2812; val_gene_expr_recon_loss: 20929046.7500; val_masked_gp_l1_reg_loss: 109202.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 678642.8125; val_chrom_access_recon_loss: 2827865.2500; val_global_loss: 25442625.5000; val_optim_loss: 25442625.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7909; val_auprc_score: 0.7708; val_best_acc_score: 0.7238; val_best_f1_score: 0.7384; train_kl_reg_loss: 78228.3106; train_edge_recon_loss: 735047.3646; train_gene_expr_recon_loss: 21118007.3939; train_masked_gp_l1_reg_loss: 107255.3584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 446475.9223; train_chrom_access_recon_loss: 2804748.7879; train_global_loss: 25289763.1515; train_optim_loss: 25289763.1515; val_kl_reg_loss: 74788.4746; val_edge_recon_loss: 802409.4531; val_gene_expr_recon_loss: 21017936.5000; val_masked_gp_l1_reg_loss: 106519.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 300770.1562; val_chrom_access_recon_loss: 2804702.6875; val_global_loss: 25107127.0000; val_optim_loss: 25107127.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8435; val_auprc_score: 0.8122; val_best_acc_score: 0.7681; val_best_f1_score: 0.7930; train_kl_reg_loss: 72250.6999; train_edge_recon_loss: 726561.2235; train_gene_expr_recon_loss: 20956510.3333; train_masked_gp_l1_reg_loss: 107050.9186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243218.1510; train_chrom_access_recon_loss: 2790477.2008; train_global_loss: 24896068.5758; train_optim_loss: 24896068.5758; val_kl_reg_loss: 70836.1807; val_edge_recon_loss: 778107.2266; val_gene_expr_recon_loss: 20586744.2500; val_masked_gp_l1_reg_loss: 107653.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201184.7188; val_chrom_access_recon_loss: 2769145.5000; val_global_loss: 24513670.7500; val_optim_loss: 24513670.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8693; val_auprc_score: 0.8317; val_best_acc_score: 0.8052; val_best_f1_score: 0.8213; train_kl_reg_loss: 69478.1188; train_edge_recon_loss: 705736.4801; train_gene_expr_recon_loss: 20810132.4545; train_masked_gp_l1_reg_loss: 108300.5346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178456.3949; train_chrom_access_recon_loss: 2775591.6174; train_global_loss: 24647695.4545; train_optim_loss: 24647695.4545; val_kl_reg_loss: 72816.6416; val_edge_recon_loss: 709884.8516; val_gene_expr_recon_loss: 20559338.7500; val_masked_gp_l1_reg_loss: 109457.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160905.7188; val_chrom_access_recon_loss: 2760481.6250; val_global_loss: 24372886.0000; val_optim_loss: 24372886.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8755; val_auprc_score: 0.8411; val_best_acc_score: 0.8074; val_best_f1_score: 0.8243; train_kl_reg_loss: 75365.4696; train_edge_recon_loss: 662775.7367; train_gene_expr_recon_loss: 20661451.9091; train_masked_gp_l1_reg_loss: 110293.5187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148649.3239; train_chrom_access_recon_loss: 2758941.8333; train_global_loss: 24417477.7879; train_optim_loss: 24417477.7879; val_kl_reg_loss: 79789.3154; val_edge_recon_loss: 650272.2266; val_gene_expr_recon_loss: 20417999.0000; val_masked_gp_l1_reg_loss: 110954.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138552.5781; val_chrom_access_recon_loss: 2745699.4062; val_global_loss: 24143265.2500; val_optim_loss: 24143265.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8869; val_auprc_score: 0.8589; val_best_acc_score: 0.8181; val_best_f1_score: 0.8344; train_kl_reg_loss: 80896.5264; train_edge_recon_loss: 637362.2936; train_gene_expr_recon_loss: 20562144.2424; train_masked_gp_l1_reg_loss: 111794.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130325.6693; train_chrom_access_recon_loss: 2750959.6553; train_global_loss: 24273482.5152; train_optim_loss: 24273482.5152; val_kl_reg_loss: 82912.8945; val_edge_recon_loss: 632340.4922; val_gene_expr_recon_loss: 20394331.2500; val_masked_gp_l1_reg_loss: 112947.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123454.7266; val_chrom_access_recon_loss: 2724503.4375; val_global_loss: 24070490.0000; val_optim_loss: 24070490.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8966; val_auprc_score: 0.8632; val_best_acc_score: 0.8310; val_best_f1_score: 0.8454; train_kl_reg_loss: 79656.7841; train_edge_recon_loss: 631542.7083; train_gene_expr_recon_loss: 20467371.2727; train_masked_gp_l1_reg_loss: 113532.6229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117875.8551; train_chrom_access_recon_loss: 2734520.4242; train_global_loss: 24144499.7576; train_optim_loss: 24144499.7576; val_kl_reg_loss: 77448.8027; val_edge_recon_loss: 627996.2109; val_gene_expr_recon_loss: 20358708.2500; val_masked_gp_l1_reg_loss: 114174.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113570.9922; val_chrom_access_recon_loss: 2729033.9062; val_global_loss: 24020931.0000; val_optim_loss: 24020931.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9039; val_auprc_score: 0.8714; val_best_acc_score: 0.8326; val_best_f1_score: 0.8467; train_kl_reg_loss: 79599.8108; train_edge_recon_loss: 620620.4545; train_gene_expr_recon_loss: 20376683.0909; train_masked_gp_l1_reg_loss: 114810.6218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109837.6418; train_chrom_access_recon_loss: 2723482.4394; train_global_loss: 24025034.1818; train_optim_loss: 24025034.1818; val_kl_reg_loss: 78000.8877; val_edge_recon_loss: 619077.5781; val_gene_expr_recon_loss: 20135541.2500; val_masked_gp_l1_reg_loss: 115687.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106791.9766; val_chrom_access_recon_loss: 2709485.5938; val_global_loss: 23764585.0000; val_optim_loss: 23764585.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9051; val_auprc_score: 0.8791; val_best_acc_score: 0.8337; val_best_f1_score: 0.8466; train_kl_reg_loss: 78656.7893; train_edge_recon_loss: 618814.5170; train_gene_expr_recon_loss: 20286555.2727; train_masked_gp_l1_reg_loss: 115971.0369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105068.7562; train_chrom_access_recon_loss: 2717352.1932; train_global_loss: 23922418.8182; train_optim_loss: 23922418.8182; val_kl_reg_loss: 78907.9268; val_edge_recon_loss: 618314.6484; val_gene_expr_recon_loss: 20059354.5000; val_masked_gp_l1_reg_loss: 116509.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103684.8125; val_chrom_access_recon_loss: 2721484.2500; val_global_loss: 23698255.5000; val_optim_loss: 23698255.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9131; val_auprc_score: 0.8874; val_best_acc_score: 0.8466; val_best_f1_score: 0.8563; train_kl_reg_loss: 77959.3967; train_edge_recon_loss: 613060.0246; train_gene_expr_recon_loss: 20213471.0606; train_masked_gp_l1_reg_loss: 116705.9186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102433.1120; train_chrom_access_recon_loss: 2705813.5189; train_global_loss: 23829443.0303; train_optim_loss: 23829443.0303; val_kl_reg_loss: 78019.0547; val_edge_recon_loss: 619621.2266; val_gene_expr_recon_loss: 20087905.5000; val_masked_gp_l1_reg_loss: 117362.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101418.9688; val_chrom_access_recon_loss: 2714289.0000; val_global_loss: 23718614.2500; val_optim_loss: 23718614.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9125; val_auprc_score: 0.8853; val_best_acc_score: 0.8415; val_best_f1_score: 0.8523; train_kl_reg_loss: 77233.8674; train_edge_recon_loss: 611964.8447; train_gene_expr_recon_loss: 20121232.2424; train_masked_gp_l1_reg_loss: 117422.1501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99399.4859; train_chrom_access_recon_loss: 2695288.9773; train_global_loss: 23722541.6061; train_optim_loss: 23722541.6061; val_kl_reg_loss: 75821.2061; val_edge_recon_loss: 615668.7031; val_gene_expr_recon_loss: 19974762.2500; val_masked_gp_l1_reg_loss: 117993.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97748.9766; val_chrom_access_recon_loss: 2706091.9062; val_global_loss: 23588086.2500; val_optim_loss: 23588086.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9217; val_auprc_score: 0.9011; val_best_acc_score: 0.8549; val_best_f1_score: 0.8638; train_kl_reg_loss: 76135.7038; train_edge_recon_loss: 608293.4252; train_gene_expr_recon_loss: 20078482.5758; train_masked_gp_l1_reg_loss: 118364.4187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96263.3181; train_chrom_access_recon_loss: 2688850.3788; train_global_loss: 23666390.1515; train_optim_loss: 23666390.1515; val_kl_reg_loss: 75124.4062; val_edge_recon_loss: 611160.5312; val_gene_expr_recon_loss: 20029270.7500; val_masked_gp_l1_reg_loss: 118594.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94918.9375; val_chrom_access_recon_loss: 2684732.9688; val_global_loss: 23613800.5000; val_optim_loss: 23613800.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9206; val_auprc_score: 0.8933; val_best_acc_score: 0.8557; val_best_f1_score: 0.8662; train_kl_reg_loss: 76291.9749; train_edge_recon_loss: 605278.4081; train_gene_expr_recon_loss: 20015369.1212; train_masked_gp_l1_reg_loss: 118799.0903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93697.2817; train_chrom_access_recon_loss: 2682135.2235; train_global_loss: 23591571.0303; train_optim_loss: 23591571.0303; val_kl_reg_loss: 73857.7031; val_edge_recon_loss: 607604.9219; val_gene_expr_recon_loss: 19721795.5000; val_masked_gp_l1_reg_loss: 119280.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92879.1406; val_chrom_access_recon_loss: 2672544.5938; val_global_loss: 23287962.5000; val_optim_loss: 23287962.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9263; val_auprc_score: 0.9013; val_best_acc_score: 0.8608; val_best_f1_score: 0.8694; train_kl_reg_loss: 74791.9593; train_edge_recon_loss: 605552.8902; train_gene_expr_recon_loss: 19938227.3939; train_masked_gp_l1_reg_loss: 119500.9611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91892.9774; train_chrom_access_recon_loss: 2672547.9697; train_global_loss: 23502514.6061; train_optim_loss: 23502514.6061; val_kl_reg_loss: 74226.4707; val_edge_recon_loss: 605242.2578; val_gene_expr_recon_loss: 19763539.2500; val_masked_gp_l1_reg_loss: 119855.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90860.0234; val_chrom_access_recon_loss: 2661958.3438; val_global_loss: 23315682.0000; val_optim_loss: 23315682.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9214; val_auprc_score: 0.8977; val_best_acc_score: 0.8555; val_best_f1_score: 0.8623; train_kl_reg_loss: 74197.5637; train_edge_recon_loss: 605420.5076; train_gene_expr_recon_loss: 19890508.6061; train_masked_gp_l1_reg_loss: 120142.0187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90281.8114; train_chrom_access_recon_loss: 2663473.6136; train_global_loss: 23444024.1515; train_optim_loss: 23444024.1515; val_kl_reg_loss: 72986.2451; val_edge_recon_loss: 611271.4531; val_gene_expr_recon_loss: 19837688.2500; val_masked_gp_l1_reg_loss: 120475.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89682.4922; val_chrom_access_recon_loss: 2676970.5000; val_global_loss: 23409074.0000; val_optim_loss: 23409074.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9272; val_auprc_score: 0.9008; val_best_acc_score: 0.8622; val_best_f1_score: 0.8724; train_kl_reg_loss: 73682.5868; train_edge_recon_loss: 601779.9545; train_gene_expr_recon_loss: 19828076.8182; train_masked_gp_l1_reg_loss: 120876.7451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89023.0112; train_chrom_access_recon_loss: 2653894.9697; train_global_loss: 23367333.9697; train_optim_loss: 23367333.9697; val_kl_reg_loss: 75079.5381; val_edge_recon_loss: 606545.0547; val_gene_expr_recon_loss: 19815572.5000; val_masked_gp_l1_reg_loss: 121309.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88487.6641; val_chrom_access_recon_loss: 2655613.0000; val_global_loss: 23362608.0000; val_optim_loss: 23362608.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9365; val_auprc_score: 0.9183; val_best_acc_score: 0.8718; val_best_f1_score: 0.8798; train_kl_reg_loss: 73467.1771; train_edge_recon_loss: 600580.1695; train_gene_expr_recon_loss: 19756969.4848; train_masked_gp_l1_reg_loss: 121499.6194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87874.3256; train_chrom_access_recon_loss: 2644197.1591; train_global_loss: 23284587.8788; train_optim_loss: 23284587.8788; val_kl_reg_loss: 71478.1396; val_edge_recon_loss: 596550.4766; val_gene_expr_recon_loss: 19526628.7500; val_masked_gp_l1_reg_loss: 121836.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87521.7578; val_chrom_access_recon_loss: 2674359.4062; val_global_loss: 23078374.5000; val_optim_loss: 23078374.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9332; val_auprc_score: 0.9113; val_best_acc_score: 0.8684; val_best_f1_score: 0.8747; train_kl_reg_loss: 72673.1693; train_edge_recon_loss: 602320.6203; train_gene_expr_recon_loss: 19715075.5758; train_masked_gp_l1_reg_loss: 122055.1600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87039.9295; train_chrom_access_recon_loss: 2635302.0530; train_global_loss: 23234466.6667; train_optim_loss: 23234466.6667; val_kl_reg_loss: 70744.8086; val_edge_recon_loss: 604014.3281; val_gene_expr_recon_loss: 19628625.7500; val_masked_gp_l1_reg_loss: 122545.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87111.8984; val_chrom_access_recon_loss: 2670658.0000; val_global_loss: 23183700.5000; val_optim_loss: 23183700.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9374; val_auprc_score: 0.9194; val_best_acc_score: 0.8751; val_best_f1_score: 0.8807; train_kl_reg_loss: 72496.2264; train_edge_recon_loss: 597162.5597; train_gene_expr_recon_loss: 19666804.1818; train_masked_gp_l1_reg_loss: 122823.3757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86583.5964; train_chrom_access_recon_loss: 2626791.0492; train_global_loss: 23172661.0000; train_optim_loss: 23172661.0000; val_kl_reg_loss: 71025.0117; val_edge_recon_loss: 603110.5469; val_gene_expr_recon_loss: 19387716.7500; val_masked_gp_l1_reg_loss: 123338.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86776.5781; val_chrom_access_recon_loss: 2607033.7188; val_global_loss: 22878999.5000; val_optim_loss: 22878999.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9377; val_auprc_score: 0.9206; val_best_acc_score: 0.8735; val_best_f1_score: 0.8793; train_kl_reg_loss: 71463.5531; train_edge_recon_loss: 597749.8532; train_gene_expr_recon_loss: 19616421.1212; train_masked_gp_l1_reg_loss: 123724.0162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86190.7700; train_chrom_access_recon_loss: 2619258.4470; train_global_loss: 23114807.6364; train_optim_loss: 23114807.6364; val_kl_reg_loss: 71868.6025; val_edge_recon_loss: 601315.9062; val_gene_expr_recon_loss: 19337459.2500; val_masked_gp_l1_reg_loss: 124188.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86042.6641; val_chrom_access_recon_loss: 2593249.0000; val_global_loss: 22814122.7500; val_optim_loss: 22814122.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9416; val_auprc_score: 0.9148; val_best_acc_score: 0.8794; val_best_f1_score: 0.8854; train_kl_reg_loss: 71462.5161; train_edge_recon_loss: 595680.3182; train_gene_expr_recon_loss: 19567027.0909; train_masked_gp_l1_reg_loss: 124650.7048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86015.8790; train_chrom_access_recon_loss: 2611713.3220; train_global_loss: 23056549.6667; train_optim_loss: 23056549.6667; val_kl_reg_loss: 69674.2305; val_edge_recon_loss: 604800.2031; val_gene_expr_recon_loss: 19282997.2500; val_masked_gp_l1_reg_loss: 124937.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85210.3906; val_chrom_access_recon_loss: 2590536.2188; val_global_loss: 22758155.5000; val_optim_loss: 22758155.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9414; val_auprc_score: 0.9196; val_best_acc_score: 0.8753; val_best_f1_score: 0.8790; train_kl_reg_loss: 70907.7842; train_edge_recon_loss: 595555.2254; train_gene_expr_recon_loss: 19519977.4242; train_masked_gp_l1_reg_loss: 125308.2782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85154.8707; train_chrom_access_recon_loss: 2603208.8447; train_global_loss: 23000112.3333; train_optim_loss: 23000112.3333; val_kl_reg_loss: 70662.4502; val_edge_recon_loss: 603235.3125; val_gene_expr_recon_loss: 19398728.5000; val_masked_gp_l1_reg_loss: 126049.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85675.1719; val_chrom_access_recon_loss: 2622694.7812; val_global_loss: 22907047.0000; val_optim_loss: 22907047.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9376; val_auprc_score: 0.9121; val_best_acc_score: 0.8753; val_best_f1_score: 0.8821; train_kl_reg_loss: 70460.5439; train_edge_recon_loss: 594437.7718; train_gene_expr_recon_loss: 19475361.1818; train_masked_gp_l1_reg_loss: 126487.9476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85081.6023; train_chrom_access_recon_loss: 2596289.6023; train_global_loss: 22948118.4545; train_optim_loss: 22948118.4545; val_kl_reg_loss: 69562.5391; val_edge_recon_loss: 601747.2578; val_gene_expr_recon_loss: 19374319.5000; val_masked_gp_l1_reg_loss: 127106.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85290.6094; val_chrom_access_recon_loss: 2612515.4375; val_global_loss: 22870540.7500; val_optim_loss: 22870540.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9447; val_auprc_score: 0.9280; val_best_acc_score: 0.8861; val_best_f1_score: 0.8911; train_kl_reg_loss: 70069.7040; train_edge_recon_loss: 593440.6780; train_gene_expr_recon_loss: 19427153.0000; train_masked_gp_l1_reg_loss: 127552.7630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84717.6786; train_chrom_access_recon_loss: 2587745.1705; train_global_loss: 22890678.7273; train_optim_loss: 22890678.7273; val_kl_reg_loss: 69829.8848; val_edge_recon_loss: 597339.2031; val_gene_expr_recon_loss: 19381651.7500; val_masked_gp_l1_reg_loss: 128273.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84207.4766; val_chrom_access_recon_loss: 2619469.0000; val_global_loss: 22880772.0000; val_optim_loss: 22880772.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9344; val_auprc_score: 0.9114; val_best_acc_score: 0.8705; val_best_f1_score: 0.8775; train_kl_reg_loss: 64587.5930; train_edge_recon_loss: 655936.2093; train_gene_expr_recon_loss: 18484700.7576; train_masked_gp_l1_reg_loss: 127279.3403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79387.4541; train_chrom_access_recon_loss: 2520682.4886; train_global_loss: 21932573.8788; train_optim_loss: 21932573.8788; val_kl_reg_loss: 40584.8843; val_edge_recon_loss: 629143.4062; val_gene_expr_recon_loss: 18233758.2500; val_masked_gp_l1_reg_loss: 125897.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76927.8750; val_chrom_access_recon_loss: 2475115.0312; val_global_loss: 21581427.5000; val_optim_loss: 21581427.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9320; val_auprc_score: 0.9100; val_best_acc_score: 0.8700; val_best_f1_score: 0.8771; train_kl_reg_loss: 63992.4794; train_edge_recon_loss: 611500.8968; train_gene_expr_recon_loss: 18382540.1515; train_masked_gp_l1_reg_loss: 124886.7488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76621.8986; train_chrom_access_recon_loss: 2492416.3902; train_global_loss: 21751958.3939; train_optim_loss: 21751958.3939; val_kl_reg_loss: 51490.6050; val_edge_recon_loss: 602155.1172; val_gene_expr_recon_loss: 18235019.5000; val_masked_gp_l1_reg_loss: 124067.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76953.3203; val_chrom_access_recon_loss: 2489215.8438; val_global_loss: 21578903.2500; val_optim_loss: 21578903.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9335; val_auprc_score: 0.9127; val_best_acc_score: 0.8692; val_best_f1_score: 0.8767; train_kl_reg_loss: 61723.2874; train_edge_recon_loss: 602176.1903; train_gene_expr_recon_loss: 18328660.1515; train_masked_gp_l1_reg_loss: 123524.9691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76523.6464; train_chrom_access_recon_loss: 2484888.3068; train_global_loss: 21677496.4545; train_optim_loss: 21677496.4545; val_kl_reg_loss: 52411.5737; val_edge_recon_loss: 604882.7734; val_gene_expr_recon_loss: 18271787.5000; val_masked_gp_l1_reg_loss: 123029.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76036.7188; val_chrom_access_recon_loss: 2477468.3438; val_global_loss: 21605616.0000; val_optim_loss: 21605616.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9350; val_auprc_score: 0.9151; val_best_acc_score: 0.8732; val_best_f1_score: 0.8803; train_kl_reg_loss: 61134.0308; train_edge_recon_loss: 596120.2869; train_gene_expr_recon_loss: 18299792.5152; train_masked_gp_l1_reg_loss: 122761.4280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76141.0581; train_chrom_access_recon_loss: 2483270.7121; train_global_loss: 21639219.7576; train_optim_loss: 21639219.7576; val_kl_reg_loss: 54491.1899; val_edge_recon_loss: 598707.7188; val_gene_expr_recon_loss: 18229126.0000; val_masked_gp_l1_reg_loss: 122523.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75909.8359; val_chrom_access_recon_loss: 2495496.8438; val_global_loss: 21576256.2500; val_optim_loss: 21576256.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9328; val_auprc_score: 0.9109; val_best_acc_score: 0.8729; val_best_f1_score: 0.8806; train_kl_reg_loss: 60489.1068; train_edge_recon_loss: 594013.3580; train_gene_expr_recon_loss: 18252294.3939; train_masked_gp_l1_reg_loss: 122267.0336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75979.3256; train_chrom_access_recon_loss: 2477242.0152; train_global_loss: 21582285.0909; train_optim_loss: 21582285.0909; val_kl_reg_loss: 55774.8442; val_edge_recon_loss: 600727.1172; val_gene_expr_recon_loss: 18024084.0000; val_masked_gp_l1_reg_loss: 122087.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75738.6953; val_chrom_access_recon_loss: 2471139.1562; val_global_loss: 21349551.0000; val_optim_loss: 21349551.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9389; val_auprc_score: 0.9169; val_best_acc_score: 0.8845; val_best_f1_score: 0.8908; train_kl_reg_loss: 59965.8980; train_edge_recon_loss: 590344.8191; train_gene_expr_recon_loss: 18219364.1818; train_masked_gp_l1_reg_loss: 122090.7556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75707.1539; train_chrom_access_recon_loss: 2475688.6932; train_global_loss: 21543161.3636; train_optim_loss: 21543161.3636; val_kl_reg_loss: 57291.0684; val_edge_recon_loss: 587234.6875; val_gene_expr_recon_loss: 18284534.2500; val_masked_gp_l1_reg_loss: 122317.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75779.3125; val_chrom_access_recon_loss: 2511266.0625; val_global_loss: 21638424.0000; val_optim_loss: 21638424.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9470; val_auprc_score: 0.9258; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 58634.8067; train_edge_recon_loss: 590280.8835; train_gene_expr_recon_loss: 18160115.5758; train_masked_gp_l1_reg_loss: 122452.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75604.4925; train_chrom_access_recon_loss: 2473125.5455; train_global_loss: 21480213.4848; train_optim_loss: 21480213.4848; val_kl_reg_loss: 54846.2651; val_edge_recon_loss: 584478.7500; val_gene_expr_recon_loss: 18172712.2500; val_masked_gp_l1_reg_loss: 122796.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75693.7578; val_chrom_access_recon_loss: 2469101.5625; val_global_loss: 21479629.2500; val_optim_loss: 21479629.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9378; val_auprc_score: 0.9119; val_best_acc_score: 0.8748; val_best_f1_score: 0.8808; train_kl_reg_loss: 58825.6229; train_edge_recon_loss: 586668.7718; train_gene_expr_recon_loss: 18128700.1515; train_masked_gp_l1_reg_loss: 122956.5092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75076.8807; train_chrom_access_recon_loss: 2465810.6098; train_global_loss: 21438038.3939; train_optim_loss: 21438038.3939; val_kl_reg_loss: 57599.8638; val_edge_recon_loss: 592126.6562; val_gene_expr_recon_loss: 18066995.5000; val_masked_gp_l1_reg_loss: 123269.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74984.6016; val_chrom_access_recon_loss: 2461366.8438; val_global_loss: 21376342.7500; val_optim_loss: 21376342.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9437; val_auprc_score: 0.9240; val_best_acc_score: 0.8850; val_best_f1_score: 0.8900; train_kl_reg_loss: 58819.6232; train_edge_recon_loss: 587457.8958; train_gene_expr_recon_loss: 18071289.1818; train_masked_gp_l1_reg_loss: 123508.7274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74833.1842; train_chrom_access_recon_loss: 2464348.3144; train_global_loss: 21380256.8182; train_optim_loss: 21380256.8182; val_kl_reg_loss: 56764.5044; val_edge_recon_loss: 591850.6641; val_gene_expr_recon_loss: 18149397.7500; val_masked_gp_l1_reg_loss: 123669.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74492.7656; val_chrom_access_recon_loss: 2485894.1562; val_global_loss: 21482069.2500; val_optim_loss: 21482069.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9476; val_auprc_score: 0.9309; val_best_acc_score: 0.8861; val_best_f1_score: 0.8906; train_kl_reg_loss: 58679.0499; train_edge_recon_loss: 583653.4356; train_gene_expr_recon_loss: 18041952.6061; train_masked_gp_l1_reg_loss: 120766.2718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61911.2012; train_chrom_access_recon_loss: 2458981.5227; train_global_loss: 21325944.0000; train_optim_loss: 21325944.0000; val_kl_reg_loss: 57699.9541; val_edge_recon_loss: 590330.6641; val_gene_expr_recon_loss: 17916931.0000; val_masked_gp_l1_reg_loss: 119823.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58776.0117; val_chrom_access_recon_loss: 2456361.5625; val_global_loss: 21199923.7500; val_optim_loss: 21199923.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9398; val_auprc_score: 0.9196; val_best_acc_score: 0.8753; val_best_f1_score: 0.8843; train_kl_reg_loss: 59757.4275; train_edge_recon_loss: 585086.4848; train_gene_expr_recon_loss: 18020987.9545; train_masked_gp_l1_reg_loss: 119681.9737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58185.6657; train_chrom_access_recon_loss: 2457475.9129; train_global_loss: 21301175.6970; train_optim_loss: 21301175.6970; val_kl_reg_loss: 58639.7690; val_edge_recon_loss: 593762.0234; val_gene_expr_recon_loss: 18124007.0000; val_masked_gp_l1_reg_loss: 119587.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57704.1016; val_chrom_access_recon_loss: 2477806.0625; val_global_loss: 21431506.5000; val_optim_loss: 21431506.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9402; val_auprc_score: 0.9185; val_best_acc_score: 0.8842; val_best_f1_score: 0.8893; train_kl_reg_loss: 60273.5650; train_edge_recon_loss: 583306.2112; train_gene_expr_recon_loss: 18018030.0303; train_masked_gp_l1_reg_loss: 119560.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57360.9817; train_chrom_access_recon_loss: 2457861.0606; train_global_loss: 21296392.3636; train_optim_loss: 21296392.3636; val_kl_reg_loss: 58606.3472; val_edge_recon_loss: 589945.4141; val_gene_expr_recon_loss: 18000820.0000; val_masked_gp_l1_reg_loss: 119557.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57090.7305; val_chrom_access_recon_loss: 2459803.0312; val_global_loss: 21285822.7500; val_optim_loss: 21285822.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9353; val_auprc_score: 0.9113; val_best_acc_score: 0.8772; val_best_f1_score: 0.8855; train_kl_reg_loss: 60632.9613; train_edge_recon_loss: 583243.4934; train_gene_expr_recon_loss: 18023113.5455; train_masked_gp_l1_reg_loss: 119542.5316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56904.8762; train_chrom_access_recon_loss: 2455867.5985; train_global_loss: 21299304.9394; train_optim_loss: 21299304.9394; val_kl_reg_loss: 59182.2124; val_edge_recon_loss: 589349.1797; val_gene_expr_recon_loss: 17966588.7500; val_masked_gp_l1_reg_loss: 119546.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56653.8359; val_chrom_access_recon_loss: 2475577.0625; val_global_loss: 21266897.5000; val_optim_loss: 21266897.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9450; val_auprc_score: 0.9228; val_best_acc_score: 0.8850; val_best_f1_score: 0.8903; train_kl_reg_loss: 60733.7938; train_edge_recon_loss: 583395.9394; train_gene_expr_recon_loss: 18008365.0909; train_masked_gp_l1_reg_loss: 119571.7095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56428.8182; train_chrom_access_recon_loss: 2453846.1667; train_global_loss: 21282341.8485; train_optim_loss: 21282341.8485; val_kl_reg_loss: 59059.0039; val_edge_recon_loss: 587828.3906; val_gene_expr_recon_loss: 18041327.7500; val_masked_gp_l1_reg_loss: 119569.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56238.2031; val_chrom_access_recon_loss: 2448700.5312; val_global_loss: 21312723.5000; val_optim_loss: 21312723.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9411; val_auprc_score: 0.9151; val_best_acc_score: 0.8885; val_best_f1_score: 0.8954; train_kl_reg_loss: 60809.3218; train_edge_recon_loss: 584096.2254; train_gene_expr_recon_loss: 18000956.6970; train_masked_gp_l1_reg_loss: 119269.5922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54907.1990; train_chrom_access_recon_loss: 2455315.7917; train_global_loss: 21275354.8788; train_optim_loss: 21275354.8788; val_kl_reg_loss: 59058.1777; val_edge_recon_loss: 589671.8359; val_gene_expr_recon_loss: 18059355.0000; val_masked_gp_l1_reg_loss: 119147.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54584.5039; val_chrom_access_recon_loss: 2485323.4375; val_global_loss: 21367140.7500; val_optim_loss: 21367140.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9428; val_auprc_score: 0.9222; val_best_acc_score: 0.8831; val_best_f1_score: 0.8883; train_kl_reg_loss: 60879.6486; train_edge_recon_loss: 582863.6799; train_gene_expr_recon_loss: 18006439.4545; train_masked_gp_l1_reg_loss: 119119.1525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54507.9207; train_chrom_access_recon_loss: 2458785.5682; train_global_loss: 21282595.2424; train_optim_loss: 21282595.2424; val_kl_reg_loss: 59371.7188; val_edge_recon_loss: 589330.1641; val_gene_expr_recon_loss: 18013362.7500; val_masked_gp_l1_reg_loss: 119099.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54441.8008; val_chrom_access_recon_loss: 2457083.9688; val_global_loss: 21292690.5000; val_optim_loss: 21292690.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9435; val_auprc_score: 0.9261; val_best_acc_score: 0.8837; val_best_f1_score: 0.8892; train_kl_reg_loss: 60925.6660; train_edge_recon_loss: 583977.6402; train_gene_expr_recon_loss: 18004157.9394; train_masked_gp_l1_reg_loss: 119085.4207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54396.2135; train_chrom_access_recon_loss: 2456527.7727; train_global_loss: 21279070.6970; train_optim_loss: 21279070.6970; val_kl_reg_loss: 58803.2197; val_edge_recon_loss: 588903.9453; val_gene_expr_recon_loss: 17858736.7500; val_masked_gp_l1_reg_loss: 119077.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54346.1328; val_chrom_access_recon_loss: 2456145.1250; val_global_loss: 21136013.2500; val_optim_loss: 21136013.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9428; val_auprc_score: 0.9242; val_best_acc_score: 0.8861; val_best_f1_score: 0.8922; train_kl_reg_loss: 60954.9952; train_edge_recon_loss: 585323.0739; train_gene_expr_recon_loss: 18011251.2121; train_masked_gp_l1_reg_loss: 119073.3183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54313.7568; train_chrom_access_recon_loss: 2456155.9015; train_global_loss: 21287072.0909; train_optim_loss: 21287072.0909; val_kl_reg_loss: 59460.7524; val_edge_recon_loss: 588617.1953; val_gene_expr_recon_loss: 18190110.2500; val_masked_gp_l1_reg_loss: 119070.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54275.4336; val_chrom_access_recon_loss: 2490587.6562; val_global_loss: 21502122.0000; val_optim_loss: 21502122.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9416; val_auprc_score: 0.9186; val_best_acc_score: 0.8845; val_best_f1_score: 0.8896; train_kl_reg_loss: 60991.4050; train_edge_recon_loss: 583966.9025; train_gene_expr_recon_loss: 18009816.6061; train_masked_gp_l1_reg_loss: 119067.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54240.3209; train_chrom_access_recon_loss: 2456681.0492; train_global_loss: 21284763.3636; train_optim_loss: 21284763.3636; val_kl_reg_loss: 59130.6582; val_edge_recon_loss: 590307.9219; val_gene_expr_recon_loss: 17869490.7500; val_masked_gp_l1_reg_loss: 119065.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54207.9609; val_chrom_access_recon_loss: 2431280.4062; val_global_loss: 21123483.7500; val_optim_loss: 21123483.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9390; val_auprc_score: 0.9198; val_best_acc_score: 0.8778; val_best_f1_score: 0.8854; train_kl_reg_loss: 60981.5961; train_edge_recon_loss: 583631.1591; train_gene_expr_recon_loss: 18000035.6364; train_masked_gp_l1_reg_loss: 119064.9367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54184.9301; train_chrom_access_recon_loss: 2456359.2803; train_global_loss: 21274257.5758; train_optim_loss: 21274257.5758; val_kl_reg_loss: 59286.8726; val_edge_recon_loss: 588840.3594; val_gene_expr_recon_loss: 17988295.5000; val_masked_gp_l1_reg_loss: 119063.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54150.9258; val_chrom_access_recon_loss: 2456989.8750; val_global_loss: 21266626.7500; val_optim_loss: 21266626.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9433; val_auprc_score: 0.9248; val_best_acc_score: 0.8864; val_best_f1_score: 0.8911; train_kl_reg_loss: 61016.9268; train_edge_recon_loss: 585426.2888; train_gene_expr_recon_loss: 17997997.8788; train_masked_gp_l1_reg_loss: 119063.0656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54121.6584; train_chrom_access_recon_loss: 2453162.1970; train_global_loss: 21270788.0303; train_optim_loss: 21270788.0303; val_kl_reg_loss: 59213.1997; val_edge_recon_loss: 589029.7891; val_gene_expr_recon_loss: 18053855.2500; val_masked_gp_l1_reg_loss: 119064.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54091.9570; val_chrom_access_recon_loss: 2485667.1562; val_global_loss: 21360921.0000; val_optim_loss: 21360921.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9433; val_auprc_score: 0.9165; val_best_acc_score: 0.8866; val_best_f1_score: 0.8926; train_kl_reg_loss: 61092.3871; train_edge_recon_loss: 582957.0436; train_gene_expr_recon_loss: 18003143.1212; train_masked_gp_l1_reg_loss: 119066.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54070.1934; train_chrom_access_recon_loss: 2456342.3939; train_global_loss: 21276671.6364; train_optim_loss: 21276671.6364; val_kl_reg_loss: 59310.0801; val_edge_recon_loss: 588133.6016; val_gene_expr_recon_loss: 18002484.5000; val_masked_gp_l1_reg_loss: 119064.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54042.4102; val_chrom_access_recon_loss: 2464580.1875; val_global_loss: 21287614.2500; val_optim_loss: 21287614.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9363; val_auprc_score: 0.9101; val_best_acc_score: 0.8780; val_best_f1_score: 0.8842; train_kl_reg_loss: 61062.4879; train_edge_recon_loss: 583997.5739; train_gene_expr_recon_loss: 17999065.2121; train_masked_gp_l1_reg_loss: 119066.9866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54019.0493; train_chrom_access_recon_loss: 2457114.6591; train_global_loss: 21274325.8485; train_optim_loss: 21274325.8485; val_kl_reg_loss: 59279.6592; val_edge_recon_loss: 589123.4375; val_gene_expr_recon_loss: 18013220.2500; val_masked_gp_l1_reg_loss: 119067.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53996.8867; val_chrom_access_recon_loss: 2462876.1875; val_global_loss: 21297563.5000; val_optim_loss: 21297563.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9446; val_auprc_score: 0.9263; val_best_acc_score: 0.8821; val_best_f1_score: 0.8892; train_kl_reg_loss: 61059.4549; train_edge_recon_loss: 582323.1922; train_gene_expr_recon_loss: 18015588.4848; train_masked_gp_l1_reg_loss: 119036.2785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53860.9760; train_chrom_access_recon_loss: 2457065.1705; train_global_loss: 21288933.6667; train_optim_loss: 21288933.6667; val_kl_reg_loss: 59141.3770; val_edge_recon_loss: 588648.2344; val_gene_expr_recon_loss: 17950637.0000; val_masked_gp_l1_reg_loss: 119024.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53829.7070; val_chrom_access_recon_loss: 2450530.5938; val_global_loss: 21221811.2500; val_optim_loss: 21221811.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9419; val_auprc_score: 0.9253; val_best_acc_score: 0.8764; val_best_f1_score: 0.8843; train_kl_reg_loss: 61048.8700; train_edge_recon_loss: 581942.2812; train_gene_expr_recon_loss: 17997181.0000; train_masked_gp_l1_reg_loss: 119020.7154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53823.4975; train_chrom_access_recon_loss: 2453728.5758; train_global_loss: 21266744.8182; train_optim_loss: 21266744.8182; val_kl_reg_loss: 59630.1055; val_edge_recon_loss: 592178.4219; val_gene_expr_recon_loss: 18047500.2500; val_masked_gp_l1_reg_loss: 119018.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53817.0469; val_chrom_access_recon_loss: 2470995.2500; val_global_loss: 21343140.2500; val_optim_loss: 21343140.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9425; val_auprc_score: 0.9198; val_best_acc_score: 0.8796; val_best_f1_score: 0.8871; train_kl_reg_loss: 61129.0317; train_edge_recon_loss: 584516.6856; train_gene_expr_recon_loss: 17989978.8485; train_masked_gp_l1_reg_loss: 119016.6162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53812.2953; train_chrom_access_recon_loss: 2453216.3030; train_global_loss: 21261669.9394; train_optim_loss: 21261669.9394; val_kl_reg_loss: 59174.4219; val_edge_recon_loss: 586963.8672; val_gene_expr_recon_loss: 17811697.0000; val_masked_gp_l1_reg_loss: 119015.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53806.8711; val_chrom_access_recon_loss: 2457275.4062; val_global_loss: 21087932.0000; val_optim_loss: 21087932.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9425; val_auprc_score: 0.9255; val_best_acc_score: 0.8826; val_best_f1_score: 0.8890; train_kl_reg_loss: 61048.8268; train_edge_recon_loss: 582660.1714; train_gene_expr_recon_loss: 17999017.7273; train_masked_gp_l1_reg_loss: 119014.5245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53803.4071; train_chrom_access_recon_loss: 2453820.4394; train_global_loss: 21269365.0303; train_optim_loss: 21269365.0303; val_kl_reg_loss: 59651.2983; val_edge_recon_loss: 588321.1719; val_gene_expr_recon_loss: 18027987.0000; val_masked_gp_l1_reg_loss: 119013.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53799.2109; val_chrom_access_recon_loss: 2452656.7188; val_global_loss: 21301430.2500; val_optim_loss: 21301430.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9427; val_auprc_score: 0.9221; val_best_acc_score: 0.8831; val_best_f1_score: 0.8882; train_kl_reg_loss: 61078.5429; train_edge_recon_loss: 582905.0407; train_gene_expr_recon_loss: 17998769.3030; train_masked_gp_l1_reg_loss: 119013.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53795.8011; train_chrom_access_recon_loss: 2455477.3598; train_global_loss: 21271039.6364; train_optim_loss: 21271039.6364; val_kl_reg_loss: 59420.5977; val_edge_recon_loss: 591322.7266; val_gene_expr_recon_loss: 17897152.2500; val_masked_gp_l1_reg_loss: 119012.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53792.6484; val_chrom_access_recon_loss: 2469943.1562; val_global_loss: 21190643.5000; val_optim_loss: 21190643.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9375; val_auprc_score: 0.9109; val_best_acc_score: 0.8810; val_best_f1_score: 0.8865; train_kl_reg_loss: 61095.7037; train_edge_recon_loss: 584474.5237; train_gene_expr_recon_loss: 18010624.0000; train_masked_gp_l1_reg_loss: 119012.5092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53789.1083; train_chrom_access_recon_loss: 2456409.7917; train_global_loss: 21285405.2424; train_optim_loss: 21285405.2424; val_kl_reg_loss: 59375.1777; val_edge_recon_loss: 588724.4297; val_gene_expr_recon_loss: 17999108.7500; val_masked_gp_l1_reg_loss: 119012.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53785.4297; val_chrom_access_recon_loss: 2485903.4375; val_global_loss: 21305909.5000; val_optim_loss: 21305909.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9445; val_auprc_score: 0.9319; val_best_acc_score: 0.8812; val_best_f1_score: 0.8875; train_kl_reg_loss: 61106.6406; train_edge_recon_loss: 583046.9962; train_gene_expr_recon_loss: 18003962.7576; train_masked_gp_l1_reg_loss: 119012.1027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53782.5587; train_chrom_access_recon_loss: 2456385.3258; train_global_loss: 21277296.2424; train_optim_loss: 21277296.2424; val_kl_reg_loss: 59409.0723; val_edge_recon_loss: 589880.0938; val_gene_expr_recon_loss: 17921831.7500; val_masked_gp_l1_reg_loss: 119011.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53779.2656; val_chrom_access_recon_loss: 2495499.4062; val_global_loss: 21239412.5000; val_optim_loss: 21239412.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9449; val_auprc_score: 0.9295; val_best_acc_score: 0.8855; val_best_f1_score: 0.8902; train_kl_reg_loss: 61087.1918; train_edge_recon_loss: 582914.9725; train_gene_expr_recon_loss: 17992172.2424; train_masked_gp_l1_reg_loss: 119008.7401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53766.0205; train_chrom_access_recon_loss: 2451189.9508; train_global_loss: 21260139.3636; train_optim_loss: 21260139.3636; val_kl_reg_loss: 59397.2886; val_edge_recon_loss: 590650.0547; val_gene_expr_recon_loss: 17850280.0000; val_masked_gp_l1_reg_loss: 119007.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53763.0039; val_chrom_access_recon_loss: 2426723.8125; val_global_loss: 21099822.5000; val_optim_loss: 21099822.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9409; val_auprc_score: 0.9210; val_best_acc_score: 0.8839; val_best_f1_score: 0.8914; train_kl_reg_loss: 61114.5904; train_edge_recon_loss: 584271.0123; train_gene_expr_recon_loss: 18000058.9091; train_masked_gp_l1_reg_loss: 119006.9666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53762.3501; train_chrom_access_recon_loss: 2455667.6553; train_global_loss: 21273881.1212; train_optim_loss: 21273881.1212; val_kl_reg_loss: 59201.3662; val_edge_recon_loss: 587369.4609; val_gene_expr_recon_loss: 17992112.7500; val_masked_gp_l1_reg_loss: 119006.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53761.7617; val_chrom_access_recon_loss: 2470296.7812; val_global_loss: 21281748.0000; val_optim_loss: 21281748.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9483; val_auprc_score: 0.9338; val_best_acc_score: 0.8853; val_best_f1_score: 0.8907; train_kl_reg_loss: 61078.2716; train_edge_recon_loss: 583234.3400; train_gene_expr_recon_loss: 17988161.6061; train_masked_gp_l1_reg_loss: 119006.4712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53761.2804; train_chrom_access_recon_loss: 2452983.5303; train_global_loss: 21258225.3636; train_optim_loss: 21258225.3636; val_kl_reg_loss: 59487.9478; val_edge_recon_loss: 584366.6016; val_gene_expr_recon_loss: 17836516.2500; val_masked_gp_l1_reg_loss: 119006.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53760.8164; val_chrom_access_recon_loss: 2469219.4688; val_global_loss: 21122356.2500; val_optim_loss: 21122356.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9420; val_auprc_score: 0.9196; val_best_acc_score: 0.8818; val_best_f1_score: 0.8876; train_kl_reg_loss: 61089.8672; train_edge_recon_loss: 583934.6629; train_gene_expr_recon_loss: 17987522.9394; train_masked_gp_l1_reg_loss: 119006.2114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53760.4661; train_chrom_access_recon_loss: 2454530.1364; train_global_loss: 21259843.5152; train_optim_loss: 21259843.5152; val_kl_reg_loss: 59404.5981; val_edge_recon_loss: 589348.5000; val_gene_expr_recon_loss: 18044279.7500; val_masked_gp_l1_reg_loss: 119006.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53760.0391; val_chrom_access_recon_loss: 2483527.4062; val_global_loss: 21349326.2500; val_optim_loss: 21349326.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 45 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9450
val AUPRC score: 0.9271
val best accuracy score: 0.8901
val best F1 score: 0.8961
val target rna MSE score: 1.3019
val source rna MSE score: 0.7354
val target atac MSE score: 0.4661
val source atac MSE score: 0.2017
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
