[True]
Run timestamp: 07092023_002703_220.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_220']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 797 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3511, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6982; val_auprc_score: 0.6688; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 48937.8350; train_edge_recon_loss: 3533614.5265; train_gene_expr_recon_loss: 12513648.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 812719.8220; train_chrom_access_recon_loss: 4402325.7879; train_global_loss: 21311246.4545; train_optim_loss: 21311246.4545; val_kl_reg_loss: 91557.0654; val_edge_recon_loss: 4064745.6875; val_gene_expr_recon_loss: 11226286.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 612518.6250; val_chrom_access_recon_loss: 4108218.9062; val_global_loss: 20103326.7500; val_optim_loss: 20103326.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7085; val_auprc_score: 0.6907; val_best_acc_score: 0.6408; val_best_f1_score: 0.6992; train_kl_reg_loss: 93253.7596; train_edge_recon_loss: 3518909.3068; train_gene_expr_recon_loss: 11306777.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 445023.5147; train_chrom_access_recon_loss: 4180112.4848; train_global_loss: 19544076.6970; train_optim_loss: 19544076.6970; val_kl_reg_loss: 68431.1001; val_edge_recon_loss: 4053720.5000; val_gene_expr_recon_loss: 10901405.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 306425.0625; val_chrom_access_recon_loss: 4008387.5000; val_global_loss: 19338369.2500; val_optim_loss: 19338369.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7614; val_auprc_score: 0.7474; val_best_acc_score: 0.6642; val_best_f1_score: 0.7232; train_kl_reg_loss: 83176.5605; train_edge_recon_loss: 3509819.9659; train_gene_expr_recon_loss: 11136759.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228879.1354; train_chrom_access_recon_loss: 4139709.2045; train_global_loss: 19098344.0606; train_optim_loss: 19098344.0606; val_kl_reg_loss: 79192.5273; val_edge_recon_loss: 3972665.8438; val_gene_expr_recon_loss: 10839942.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169195.4844; val_chrom_access_recon_loss: 4004076.3750; val_global_loss: 19065072.2500; val_optim_loss: 19065072.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7827; val_auprc_score: 0.7809; val_best_acc_score: 0.6991; val_best_f1_score: 0.7285; train_kl_reg_loss: 63387.4469; train_edge_recon_loss: 3411267.4848; train_gene_expr_recon_loss: 11061313.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136238.0205; train_chrom_access_recon_loss: 4116414.3561; train_global_loss: 18788621.0606; train_optim_loss: 18788621.0606; val_kl_reg_loss: 53580.6167; val_edge_recon_loss: 3357131.6875; val_gene_expr_recon_loss: 10760831.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110255.4297; val_chrom_access_recon_loss: 3979638.1562; val_global_loss: 18261437.5000; val_optim_loss: 18261437.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8121; val_auprc_score: 0.8029; val_best_acc_score: 0.7276; val_best_f1_score: 0.7464; train_kl_reg_loss: 71503.0556; train_edge_recon_loss: 3125728.7992; train_gene_expr_recon_loss: 10998445.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93396.6607; train_chrom_access_recon_loss: 4094078.6402; train_global_loss: 18383152.3030; train_optim_loss: 18383152.3030; val_kl_reg_loss: 82201.9893; val_edge_recon_loss: 3121179.4688; val_gene_expr_recon_loss: 10701131.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80170.1250; val_chrom_access_recon_loss: 3936982.8125; val_global_loss: 17921665.2500; val_optim_loss: 17921665.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8738; val_auprc_score: 0.8550; val_best_acc_score: 0.7982; val_best_f1_score: 0.8119; train_kl_reg_loss: 77989.9950; train_edge_recon_loss: 2973374.3674; train_gene_expr_recon_loss: 10928278.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71879.8295; train_chrom_access_recon_loss: 4074710.2879; train_global_loss: 18126232.7879; train_optim_loss: 18126232.7879; val_kl_reg_loss: 77656.0781; val_edge_recon_loss: 2949126.6250; val_gene_expr_recon_loss: 10719894.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65025.5859; val_chrom_access_recon_loss: 3945218.5312; val_global_loss: 17756922.0000; val_optim_loss: 17756922.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9063; val_auprc_score: 0.8847; val_best_acc_score: 0.8396; val_best_f1_score: 0.8496; train_kl_reg_loss: 83845.0977; train_edge_recon_loss: 2857645.1288; train_gene_expr_recon_loss: 10848978.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59978.1088; train_chrom_access_recon_loss: 4052653.9470; train_global_loss: 17903101.0606; train_optim_loss: 17903101.0606; val_kl_reg_loss: 75525.6426; val_edge_recon_loss: 2866865.5625; val_gene_expr_recon_loss: 10521646.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55408.0195; val_chrom_access_recon_loss: 3896225.5000; val_global_loss: 17415671.0000; val_optim_loss: 17415671.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8976; val_auprc_score: 0.8678; val_best_acc_score: 0.8305; val_best_f1_score: 0.8434; train_kl_reg_loss: 87007.4782; train_edge_recon_loss: 2819753.0189; train_gene_expr_recon_loss: 10789725.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51903.1218; train_chrom_access_recon_loss: 4036417.9545; train_global_loss: 17784806.8788; train_optim_loss: 17784806.8788; val_kl_reg_loss: 84778.5938; val_edge_recon_loss: 2866572.6250; val_gene_expr_recon_loss: 10522988.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48458.0391; val_chrom_access_recon_loss: 3861458.5625; val_global_loss: 17384256.5000; val_optim_loss: 17384256.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9063; val_auprc_score: 0.8860; val_best_acc_score: 0.8372; val_best_f1_score: 0.8473; train_kl_reg_loss: 84762.3813; train_edge_recon_loss: 2806025.2386; train_gene_expr_recon_loss: 10735287.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46029.3500; train_chrom_access_recon_loss: 4012169.0152; train_global_loss: 17684273.6970; train_optim_loss: 17684273.6970; val_kl_reg_loss: 85494.4570; val_edge_recon_loss: 2845743.4062; val_gene_expr_recon_loss: 10453554.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43754.2891; val_chrom_access_recon_loss: 3882350.8125; val_global_loss: 17310897.1250; val_optim_loss: 17310897.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9067; val_auprc_score: 0.8754; val_best_acc_score: 0.8418; val_best_f1_score: 0.8547; train_kl_reg_loss: 85539.4382; train_edge_recon_loss: 2788713.8371; train_gene_expr_recon_loss: 10699527.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41824.1230; train_chrom_access_recon_loss: 4001119.3750; train_global_loss: 17616724.2424; train_optim_loss: 17616724.2424; val_kl_reg_loss: 80979.1133; val_edge_recon_loss: 2810020.4688; val_gene_expr_recon_loss: 10421228.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40223.0820; val_chrom_access_recon_loss: 3870281.0312; val_global_loss: 17222732.6250; val_optim_loss: 17222732.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9040; val_auprc_score: 0.8745; val_best_acc_score: 0.8436; val_best_f1_score: 0.8557; train_kl_reg_loss: 82282.1409; train_edge_recon_loss: 2787118.0568; train_gene_expr_recon_loss: 10632986.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38837.9389; train_chrom_access_recon_loss: 3979910.7879; train_global_loss: 17521135.5152; train_optim_loss: 17521135.5152; val_kl_reg_loss: 81299.5342; val_edge_recon_loss: 2816157.8438; val_gene_expr_recon_loss: 10337610.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37609.4805; val_chrom_access_recon_loss: 3844578.1250; val_global_loss: 17117255.6250; val_optim_loss: 17117255.6250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9160; val_auprc_score: 0.8879; val_best_acc_score: 0.8522; val_best_f1_score: 0.8609; train_kl_reg_loss: 80975.8066; train_edge_recon_loss: 2773787.5568; train_gene_expr_recon_loss: 10596492.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36432.6623; train_chrom_access_recon_loss: 3969148.7045; train_global_loss: 17456837.7576; train_optim_loss: 17456837.7576; val_kl_reg_loss: 76252.2812; val_edge_recon_loss: 2791856.2188; val_gene_expr_recon_loss: 10392295.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35636.0195; val_chrom_access_recon_loss: 3840293.5938; val_global_loss: 17136333.5000; val_optim_loss: 17136333.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9146; val_auprc_score: 0.8831; val_best_acc_score: 0.8563; val_best_f1_score: 0.8651; train_kl_reg_loss: 78407.7874; train_edge_recon_loss: 2783953.7992; train_gene_expr_recon_loss: 10561306.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34649.9819; train_chrom_access_recon_loss: 3954227.2083; train_global_loss: 17412545.7727; train_optim_loss: 17412545.7727; val_kl_reg_loss: 76196.3320; val_edge_recon_loss: 2783366.9375; val_gene_expr_recon_loss: 10316996.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34114.6562; val_chrom_access_recon_loss: 3823283.5625; val_global_loss: 17033959.0000; val_optim_loss: 17033959.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9217; val_auprc_score: 0.8959; val_best_acc_score: 0.8587; val_best_f1_score: 0.8670; train_kl_reg_loss: 76321.4058; train_edge_recon_loss: 2761314.3826; train_gene_expr_recon_loss: 10524697.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33371.6048; train_chrom_access_recon_loss: 3943054.3636; train_global_loss: 17338759.6061; train_optim_loss: 17338759.6061; val_kl_reg_loss: 75023.1309; val_edge_recon_loss: 2753476.7500; val_gene_expr_recon_loss: 10346394.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32768.7969; val_chrom_access_recon_loss: 3818705.7188; val_global_loss: 17026368.7500; val_optim_loss: 17026368.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9141; val_auprc_score: 0.8781; val_best_acc_score: 0.8589; val_best_f1_score: 0.8676; train_kl_reg_loss: 73962.8697; train_edge_recon_loss: 2760317.3864; train_gene_expr_recon_loss: 10496233.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32300.0598; train_chrom_access_recon_loss: 3932490.4470; train_global_loss: 17295304.4697; train_optim_loss: 17295304.4697; val_kl_reg_loss: 72704.7998; val_edge_recon_loss: 2758488.2812; val_gene_expr_recon_loss: 10314606.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31803.6035; val_chrom_access_recon_loss: 3810121.1562; val_global_loss: 16987724.7500; val_optim_loss: 16987724.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9230; val_auprc_score: 0.8942; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 71717.7707; train_edge_recon_loss: 2750257.7348; train_gene_expr_recon_loss: 10444397.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31384.1048; train_chrom_access_recon_loss: 3911937.7841; train_global_loss: 17209694.8636; train_optim_loss: 17209694.8636; val_kl_reg_loss: 72358.1172; val_edge_recon_loss: 2783149.2500; val_gene_expr_recon_loss: 10315967.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31194.7793; val_chrom_access_recon_loss: 3816136.8125; val_global_loss: 17018806.7500; val_optim_loss: 17018806.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9198; val_auprc_score: 0.8888; val_best_acc_score: 0.8619; val_best_f1_score: 0.8705; train_kl_reg_loss: 71372.7882; train_edge_recon_loss: 2735595.3902; train_gene_expr_recon_loss: 10429136.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30695.4895; train_chrom_access_recon_loss: 3906046.8977; train_global_loss: 17172847.4242; train_optim_loss: 17172847.4242; val_kl_reg_loss: 70559.2793; val_edge_recon_loss: 2773094.1875; val_gene_expr_recon_loss: 10200313.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30583.8770; val_chrom_access_recon_loss: 3822468.0938; val_global_loss: 16897018.6250; val_optim_loss: 16897018.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9177; val_auprc_score: 0.8814; val_best_acc_score: 0.8573; val_best_f1_score: 0.8644; train_kl_reg_loss: 69090.1937; train_edge_recon_loss: 2736979.4735; train_gene_expr_recon_loss: 10401983.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30151.5947; train_chrom_access_recon_loss: 3897677.2462; train_global_loss: 17135881.5909; train_optim_loss: 17135881.5909; val_kl_reg_loss: 67650.4014; val_edge_recon_loss: 2797342.8438; val_gene_expr_recon_loss: 10073448.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29915.4121; val_chrom_access_recon_loss: 3772069.6875; val_global_loss: 16740426.1250; val_optim_loss: 16740426.1250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9244; val_auprc_score: 0.9026; val_best_acc_score: 0.8581; val_best_f1_score: 0.8677; train_kl_reg_loss: 68459.3062; train_edge_recon_loss: 2735797.1174; train_gene_expr_recon_loss: 10367520.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29648.3382; train_chrom_access_recon_loss: 3881356.7235; train_global_loss: 17082782.1061; train_optim_loss: 17082782.1061; val_kl_reg_loss: 68546.2646; val_edge_recon_loss: 2792175.6562; val_gene_expr_recon_loss: 10187083.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29559.9336; val_chrom_access_recon_loss: 3782767.3125; val_global_loss: 16860132.3750; val_optim_loss: 16860132.3750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9365; val_auprc_score: 0.9106; val_best_acc_score: 0.8729; val_best_f1_score: 0.8795; train_kl_reg_loss: 66661.9741; train_edge_recon_loss: 2722827.3864; train_gene_expr_recon_loss: 10347298.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29283.6520; train_chrom_access_recon_loss: 3876264.6856; train_global_loss: 17042336.1515; train_optim_loss: 17042336.1515; val_kl_reg_loss: 68175.8408; val_edge_recon_loss: 2736155.9688; val_gene_expr_recon_loss: 10173297.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29026.9590; val_chrom_access_recon_loss: 3782702.1875; val_global_loss: 16789358.5000; val_optim_loss: 16789358.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9244; val_auprc_score: 0.8890; val_best_acc_score: 0.8710; val_best_f1_score: 0.8774; train_kl_reg_loss: 66264.6326; train_edge_recon_loss: 2724862.8826; train_gene_expr_recon_loss: 10319595.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28891.8309; train_chrom_access_recon_loss: 3866742.9015; train_global_loss: 17006357.2424; train_optim_loss: 17006357.2424; val_kl_reg_loss: 65944.2896; val_edge_recon_loss: 2769655.6875; val_gene_expr_recon_loss: 10078685.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28915.8301; val_chrom_access_recon_loss: 3706838.5938; val_global_loss: 16650040.1250; val_optim_loss: 16650040.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9346; val_auprc_score: 0.9084; val_best_acc_score: 0.8753; val_best_f1_score: 0.8827; train_kl_reg_loss: 66025.9551; train_edge_recon_loss: 2707522.0871; train_gene_expr_recon_loss: 10300825.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28668.6399; train_chrom_access_recon_loss: 3853933.5492; train_global_loss: 16956976.3030; train_optim_loss: 16956976.3030; val_kl_reg_loss: 65935.9717; val_edge_recon_loss: 2732373.9062; val_gene_expr_recon_loss: 9967185.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28688.8730; val_chrom_access_recon_loss: 3710715.6562; val_global_loss: 16504900.2500; val_optim_loss: 16504900.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9315; val_auprc_score: 0.9021; val_best_acc_score: 0.8737; val_best_f1_score: 0.8799; train_kl_reg_loss: 64416.9646; train_edge_recon_loss: 2710054.9015; train_gene_expr_recon_loss: 10272074.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28486.0255; train_chrom_access_recon_loss: 3844717.9053; train_global_loss: 16919750.6515; train_optim_loss: 16919750.6515; val_kl_reg_loss: 64845.9985; val_edge_recon_loss: 2743709.0312; val_gene_expr_recon_loss: 10018348.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28437.9336; val_chrom_access_recon_loss: 3722171.3438; val_global_loss: 16577513.0000; val_optim_loss: 16577513.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9370; val_auprc_score: 0.9120; val_best_acc_score: 0.8783; val_best_f1_score: 0.8841; train_kl_reg_loss: 63055.1415; train_edge_recon_loss: 2709811.9242; train_gene_expr_recon_loss: 10256566.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28354.3058; train_chrom_access_recon_loss: 3838776.8258; train_global_loss: 16896564.9545; train_optim_loss: 16896564.9545; val_kl_reg_loss: 62417.3970; val_edge_recon_loss: 2719036.1250; val_gene_expr_recon_loss: 10009076.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28234.8203; val_chrom_access_recon_loss: 3704350.8750; val_global_loss: 16523116.1250; val_optim_loss: 16523116.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9456; val_auprc_score: 0.9273; val_best_acc_score: 0.8864; val_best_f1_score: 0.8918; train_kl_reg_loss: 63023.1581; train_edge_recon_loss: 2700935.2235; train_gene_expr_recon_loss: 10234065.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28066.6142; train_chrom_access_recon_loss: 3829608.6136; train_global_loss: 16855699.1364; train_optim_loss: 16855699.1364; val_kl_reg_loss: 61616.4219; val_edge_recon_loss: 2715462.3750; val_gene_expr_recon_loss: 9997386.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28104.4922; val_chrom_access_recon_loss: 3748731.2188; val_global_loss: 16551300.7500; val_optim_loss: 16551300.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9372; val_auprc_score: 0.9127; val_best_acc_score: 0.8864; val_best_f1_score: 0.8932; train_kl_reg_loss: 62064.3787; train_edge_recon_loss: 2702738.0455; train_gene_expr_recon_loss: 10209769.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27894.4807; train_chrom_access_recon_loss: 3821104.3788; train_global_loss: 16823570.9091; train_optim_loss: 16823570.9091; val_kl_reg_loss: 61998.5190; val_edge_recon_loss: 2716319.9688; val_gene_expr_recon_loss: 10003130.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28020.8672; val_chrom_access_recon_loss: 3695302.2812; val_global_loss: 16504772.0000; val_optim_loss: 16504772.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9389; val_auprc_score: 0.9160; val_best_acc_score: 0.8783; val_best_f1_score: 0.8852; train_kl_reg_loss: 62084.6680; train_edge_recon_loss: 2693187.9508; train_gene_expr_recon_loss: 10189432.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27886.8875; train_chrom_access_recon_loss: 3810743.6932; train_global_loss: 16783336.1364; train_optim_loss: 16783336.1364; val_kl_reg_loss: 57480.2505; val_edge_recon_loss: 2742782.4062; val_gene_expr_recon_loss: 9974497.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27851.4590; val_chrom_access_recon_loss: 3694441.4375; val_global_loss: 16497052.2500; val_optim_loss: 16497052.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9452; val_auprc_score: 0.9258; val_best_acc_score: 0.8861; val_best_f1_score: 0.8908; train_kl_reg_loss: 60023.2902; train_edge_recon_loss: 2697906.5795; train_gene_expr_recon_loss: 10171562.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27809.9802; train_chrom_access_recon_loss: 3800246.1402; train_global_loss: 16757548.7273; train_optim_loss: 16757548.7273; val_kl_reg_loss: 58881.2295; val_edge_recon_loss: 2741285.5312; val_gene_expr_recon_loss: 9954812.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27883.4688; val_chrom_access_recon_loss: 3675499.0625; val_global_loss: 16458361.3750; val_optim_loss: 16458361.3750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9437; val_auprc_score: 0.9223; val_best_acc_score: 0.8866; val_best_f1_score: 0.8914; train_kl_reg_loss: 60717.4332; train_edge_recon_loss: 2687037.9318; train_gene_expr_recon_loss: 10154489.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27691.9540; train_chrom_access_recon_loss: 3797579.8371; train_global_loss: 16727516.5909; train_optim_loss: 16727516.5909; val_kl_reg_loss: 59900.4546; val_edge_recon_loss: 2734361.6250; val_gene_expr_recon_loss: 9986982.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27660.9688; val_chrom_access_recon_loss: 3699375.3438; val_global_loss: 16508281.2500; val_optim_loss: 16508281.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9461; val_auprc_score: 0.9257; val_best_acc_score: 0.8925; val_best_f1_score: 0.8982; train_kl_reg_loss: 59906.2721; train_edge_recon_loss: 2687468.6932; train_gene_expr_recon_loss: 10134047.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27628.5916; train_chrom_access_recon_loss: 3786101.9508; train_global_loss: 16695152.9545; train_optim_loss: 16695152.9545; val_kl_reg_loss: 60114.2520; val_edge_recon_loss: 2728955.2188; val_gene_expr_recon_loss: 9976549.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27613.9102; val_chrom_access_recon_loss: 3746933.5312; val_global_loss: 16540167.1250; val_optim_loss: 16540167.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9532; val_auprc_score: 0.9385; val_best_acc_score: 0.8944; val_best_f1_score: 0.8998; train_kl_reg_loss: 58781.4957; train_edge_recon_loss: 2695035.3182; train_gene_expr_recon_loss: 10116171.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27585.0567; train_chrom_access_recon_loss: 3776654.6856; train_global_loss: 16674227.6212; train_optim_loss: 16674227.6212; val_kl_reg_loss: 59303.6392; val_edge_recon_loss: 2710282.5625; val_gene_expr_recon_loss: 9974506.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27456.6406; val_chrom_access_recon_loss: 3656933.6562; val_global_loss: 16428483.5000; val_optim_loss: 16428483.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9522; val_auprc_score: 0.9367; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 58849.2143; train_edge_recon_loss: 2681327.3295; train_gene_expr_recon_loss: 10100049.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27364.9588; train_chrom_access_recon_loss: 3770687.6061; train_global_loss: 16638278.1667; train_optim_loss: 16638278.1667; val_kl_reg_loss: 56716.2559; val_edge_recon_loss: 2721887.9062; val_gene_expr_recon_loss: 9833702.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27357.6172; val_chrom_access_recon_loss: 3625261.9375; val_global_loss: 16264926.5000; val_optim_loss: 16264926.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9543; val_auprc_score: 0.9372; val_best_acc_score: 0.9011; val_best_f1_score: 0.9061; train_kl_reg_loss: 57907.9448; train_edge_recon_loss: 2669368.5000; train_gene_expr_recon_loss: 10085737.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27400.3029; train_chrom_access_recon_loss: 3764411.4621; train_global_loss: 16604825.2121; train_optim_loss: 16604825.2121; val_kl_reg_loss: 58408.4932; val_edge_recon_loss: 2699298.9688; val_gene_expr_recon_loss: 9861106.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27569.7324; val_chrom_access_recon_loss: 3638332.5938; val_global_loss: 16284716.8750; val_optim_loss: 16284716.8750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9524; val_auprc_score: 0.9315; val_best_acc_score: 0.8998; val_best_f1_score: 0.9045; train_kl_reg_loss: 58474.3406; train_edge_recon_loss: 2669628.5644; train_gene_expr_recon_loss: 10074321.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27424.4269; train_chrom_access_recon_loss: 3755383.6023; train_global_loss: 16585232.0909; train_optim_loss: 16585232.0909; val_kl_reg_loss: 57718.2354; val_edge_recon_loss: 2712000.0312; val_gene_expr_recon_loss: 9883221.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27488.7090; val_chrom_access_recon_loss: 3666119.6562; val_global_loss: 16346548.1250; val_optim_loss: 16346548.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9533; val_auprc_score: 0.9352; val_best_acc_score: 0.8952; val_best_f1_score: 0.9015; train_kl_reg_loss: 57162.6498; train_edge_recon_loss: 2672816.2917; train_gene_expr_recon_loss: 10054154.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27388.0994; train_chrom_access_recon_loss: 3744808.2045; train_global_loss: 16556330.1212; train_optim_loss: 16556330.1212; val_kl_reg_loss: 56339.8198; val_edge_recon_loss: 2720491.0938; val_gene_expr_recon_loss: 9828171.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27414.8008; val_chrom_access_recon_loss: 3624702.9688; val_global_loss: 16257120.6250; val_optim_loss: 16257120.6250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9571; val_auprc_score: 0.9387; val_best_acc_score: 0.9065; val_best_f1_score: 0.9096; train_kl_reg_loss: 56436.4486; train_edge_recon_loss: 2679511.0379; train_gene_expr_recon_loss: 10032433.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27383.7478; train_chrom_access_recon_loss: 3736131.3750; train_global_loss: 16531896.2727; train_optim_loss: 16531896.2727; val_kl_reg_loss: 56589.5386; val_edge_recon_loss: 2698297.8750; val_gene_expr_recon_loss: 9916024.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27411.3945; val_chrom_access_recon_loss: 3670563.9688; val_global_loss: 16368886.7500; val_optim_loss: 16368886.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9551; val_auprc_score: 0.9398; val_best_acc_score: 0.9001; val_best_f1_score: 0.9049; train_kl_reg_loss: 56507.3526; train_edge_recon_loss: 2671566.9015; train_gene_expr_recon_loss: 10027520.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27269.8293; train_chrom_access_recon_loss: 3727540.7462; train_global_loss: 16510405.3030; train_optim_loss: 16510405.3030; val_kl_reg_loss: 57063.6064; val_edge_recon_loss: 2711740.9688; val_gene_expr_recon_loss: 9910541.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27476.9375; val_chrom_access_recon_loss: 3685885.0625; val_global_loss: 16392708.0000; val_optim_loss: 16392708.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9553; val_auprc_score: 0.9345; val_best_acc_score: 0.9019; val_best_f1_score: 0.9057; train_kl_reg_loss: 56522.8926; train_edge_recon_loss: 2668579.1364; train_gene_expr_recon_loss: 10008696.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27348.0129; train_chrom_access_recon_loss: 3718171.1402; train_global_loss: 16479318.0606; train_optim_loss: 16479318.0606; val_kl_reg_loss: 56052.4946; val_edge_recon_loss: 2700010.7188; val_gene_expr_recon_loss: 9774283.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27466.1172; val_chrom_access_recon_loss: 3585658.7188; val_global_loss: 16143471.1250; val_optim_loss: 16143471.1250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9575; val_auprc_score: 0.9421; val_best_acc_score: 0.9046; val_best_f1_score: 0.9092; train_kl_reg_loss: 55140.6848; train_edge_recon_loss: 2676614.6553; train_gene_expr_recon_loss: 9999719.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27339.0522; train_chrom_access_recon_loss: 3714862.9356; train_global_loss: 16473676.8182; train_optim_loss: 16473676.8182; val_kl_reg_loss: 53609.2056; val_edge_recon_loss: 2704569.0000; val_gene_expr_recon_loss: 9706199.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27389.0586; val_chrom_access_recon_loss: 3585166.8125; val_global_loss: 16076934.1250; val_optim_loss: 16076934.1250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9620; val_auprc_score: 0.9495; val_best_acc_score: 0.9100; val_best_f1_score: 0.9125; train_kl_reg_loss: 54661.6052; train_edge_recon_loss: 2673286.9394; train_gene_expr_recon_loss: 9979699.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27420.1080; train_chrom_access_recon_loss: 3703317.2538; train_global_loss: 16438385.3030; train_optim_loss: 16438385.3030; val_kl_reg_loss: 55839.3882; val_edge_recon_loss: 2673885.8438; val_gene_expr_recon_loss: 9871365.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27555.6816; val_chrom_access_recon_loss: 3648163.4688; val_global_loss: 16276810.5000; val_optim_loss: 16276810.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9579; val_auprc_score: 0.9413; val_best_acc_score: 0.9119; val_best_f1_score: 0.9142; train_kl_reg_loss: 54821.9856; train_edge_recon_loss: 2671704.9924; train_gene_expr_recon_loss: 9973622.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27350.9503; train_chrom_access_recon_loss: 3699016.1023; train_global_loss: 16426517.1364; train_optim_loss: 16426517.1364; val_kl_reg_loss: 54127.6626; val_edge_recon_loss: 2698195.5938; val_gene_expr_recon_loss: 9828653.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27353.7656; val_chrom_access_recon_loss: 3631502.9062; val_global_loss: 16239833.3750; val_optim_loss: 16239833.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9541; val_auprc_score: 0.9366; val_best_acc_score: 0.8968; val_best_f1_score: 0.9028; train_kl_reg_loss: 54345.9843; train_edge_recon_loss: 2655836.8030; train_gene_expr_recon_loss: 9949448.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27372.0903; train_chrom_access_recon_loss: 3687190.2273; train_global_loss: 16374193.1364; train_optim_loss: 16374193.1364; val_kl_reg_loss: 54082.0176; val_edge_recon_loss: 2708877.0625; val_gene_expr_recon_loss: 9837541.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27463.4121; val_chrom_access_recon_loss: 3610253.0312; val_global_loss: 16238216.5000; val_optim_loss: 16238216.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9562; val_auprc_score: 0.9426; val_best_acc_score: 0.9030; val_best_f1_score: 0.9062; train_kl_reg_loss: 54072.7596; train_edge_recon_loss: 2665562.2917; train_gene_expr_recon_loss: 9943092.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27462.7091; train_chrom_access_recon_loss: 3677852.9280; train_global_loss: 16368043.3182; train_optim_loss: 16368043.3182; val_kl_reg_loss: 54658.9800; val_edge_recon_loss: 2734408.0938; val_gene_expr_recon_loss: 9794757.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27465.5703; val_chrom_access_recon_loss: 3622736.5625; val_global_loss: 16234027.3750; val_optim_loss: 16234027.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9575; val_auprc_score: 0.9326; val_best_acc_score: 0.9097; val_best_f1_score: 0.9116; train_kl_reg_loss: 54952.3230; train_edge_recon_loss: 2664237.2992; train_gene_expr_recon_loss: 9918968.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23994.7903; train_chrom_access_recon_loss: 3664503.4470; train_global_loss: 16326656.0152; train_optim_loss: 16326656.0152; val_kl_reg_loss: 54599.8877; val_edge_recon_loss: 2690973.0938; val_gene_expr_recon_loss: 9762760.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22823.4062; val_chrom_access_recon_loss: 3584856.0625; val_global_loss: 16116012.5000; val_optim_loss: 16116012.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9574; val_auprc_score: 0.9338; val_best_acc_score: 0.9068; val_best_f1_score: 0.9089; train_kl_reg_loss: 55413.9648; train_edge_recon_loss: 2663462.6629; train_gene_expr_recon_loss: 9913453.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22658.1488; train_chrom_access_recon_loss: 3664067.6250; train_global_loss: 16319056.0758; train_optim_loss: 16319056.0758; val_kl_reg_loss: 55736.3042; val_edge_recon_loss: 2710378.8438; val_gene_expr_recon_loss: 9701157.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22560.3535; val_chrom_access_recon_loss: 3556498.4688; val_global_loss: 16046331.3750; val_optim_loss: 16046331.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9537; val_auprc_score: 0.9295; val_best_acc_score: 0.9041; val_best_f1_score: 0.9066; train_kl_reg_loss: 55462.9441; train_edge_recon_loss: 2668814.3750; train_gene_expr_recon_loss: 9917249.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22504.0430; train_chrom_access_recon_loss: 3667150.7311; train_global_loss: 16331181.7727; train_optim_loss: 16331181.7727; val_kl_reg_loss: 55206.2451; val_edge_recon_loss: 2711633.0938; val_gene_expr_recon_loss: 9816621.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22454.2754; val_chrom_access_recon_loss: 3632273.9062; val_global_loss: 16238189.0000; val_optim_loss: 16238189.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9620; val_auprc_score: 0.9432; val_best_acc_score: 0.9135; val_best_f1_score: 0.9153; train_kl_reg_loss: 55495.2438; train_edge_recon_loss: 2661561.8447; train_gene_expr_recon_loss: 9912768.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22415.6026; train_chrom_access_recon_loss: 3662276.2424; train_global_loss: 16314517.6364; train_optim_loss: 16314517.6364; val_kl_reg_loss: 54948.6724; val_edge_recon_loss: 2690164.8125; val_gene_expr_recon_loss: 9716752.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22382.1816; val_chrom_access_recon_loss: 3575568.3125; val_global_loss: 16059816.6250; val_optim_loss: 16059816.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9612; val_auprc_score: 0.9458; val_best_acc_score: 0.9097; val_best_f1_score: 0.9118; train_kl_reg_loss: 55324.4936; train_edge_recon_loss: 2661948.6174; train_gene_expr_recon_loss: 9915327.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22369.5881; train_chrom_access_recon_loss: 3661424.6553; train_global_loss: 16316394.6212; train_optim_loss: 16316394.6212; val_kl_reg_loss: 55545.1099; val_edge_recon_loss: 2667368.6875; val_gene_expr_recon_loss: 9762086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22338.8730; val_chrom_access_recon_loss: 3591309.4688; val_global_loss: 16098648.1250; val_optim_loss: 16098648.1250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9593; val_auprc_score: 0.9438; val_best_acc_score: 0.9052; val_best_f1_score: 0.9090; train_kl_reg_loss: 55452.0872; train_edge_recon_loss: 2677640.0379; train_gene_expr_recon_loss: 9910096.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22319.1757; train_chrom_access_recon_loss: 3657607.9280; train_global_loss: 16323115.7727; train_optim_loss: 16323115.7727; val_kl_reg_loss: 55328.8945; val_edge_recon_loss: 2673091.2812; val_gene_expr_recon_loss: 9854509.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22301.1484; val_chrom_access_recon_loss: 3582863.5000; val_global_loss: 16188094.1250; val_optim_loss: 16188094.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9552; val_auprc_score: 0.9392; val_best_acc_score: 0.8995; val_best_f1_score: 0.9035; train_kl_reg_loss: 55345.6501; train_edge_recon_loss: 2660207.0947; train_gene_expr_recon_loss: 9909135.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21958.3452; train_chrom_access_recon_loss: 3656620.1288; train_global_loss: 16303266.7879; train_optim_loss: 16303266.7879; val_kl_reg_loss: 55318.8818; val_edge_recon_loss: 2705413.6250; val_gene_expr_recon_loss: 9799938.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21845.5137; val_chrom_access_recon_loss: 3568699.7500; val_global_loss: 16151216.5000; val_optim_loss: 16151216.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9555; val_auprc_score: 0.9316; val_best_acc_score: 0.9033; val_best_f1_score: 0.9074; train_kl_reg_loss: 55477.7759; train_edge_recon_loss: 2658994.8485; train_gene_expr_recon_loss: 9910381.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21828.6523; train_chrom_access_recon_loss: 3659656.9621; train_global_loss: 16306339.3030; train_optim_loss: 16306339.3030; val_kl_reg_loss: 54855.3281; val_edge_recon_loss: 2701024.8438; val_gene_expr_recon_loss: 9762982.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21815.5312; val_chrom_access_recon_loss: 3584559.6250; val_global_loss: 16125238.6250; val_optim_loss: 16125238.6250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9562; val_auprc_score: 0.9386; val_best_acc_score: 0.9019; val_best_f1_score: 0.9077; train_kl_reg_loss: 55423.9370; train_edge_recon_loss: 2655298.5341; train_gene_expr_recon_loss: 9902213.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21806.9787; train_chrom_access_recon_loss: 3658450.3788; train_global_loss: 16293193.3333; train_optim_loss: 16293193.3333; val_kl_reg_loss: 55796.1699; val_edge_recon_loss: 2701474.7188; val_gene_expr_recon_loss: 9766582.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21800.0605; val_chrom_access_recon_loss: 3580237.5000; val_global_loss: 16125891.0000; val_optim_loss: 16125891.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9570; val_auprc_score: 0.9415; val_best_acc_score: 0.9014; val_best_f1_score: 0.9050; train_kl_reg_loss: 55569.0679; train_edge_recon_loss: 2659840.6970; train_gene_expr_recon_loss: 9903442.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21794.5169; train_chrom_access_recon_loss: 3655483.0227; train_global_loss: 16296129.7273; train_optim_loss: 16296129.7273; val_kl_reg_loss: 55664.6382; val_edge_recon_loss: 2720435.7188; val_gene_expr_recon_loss: 9781824.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21788.8145; val_chrom_access_recon_loss: 3611106.4375; val_global_loss: 16190819.8750; val_optim_loss: 16190819.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 50 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9560
val AUPRC score: 0.9378
val best accuracy score: 0.9070
val best F1 score: 0.9095
val target rna MSE score: 1.0853
val source rna MSE score: 0.3004
val target atac MSE score: 0.4505
val source atac MSE score: 0.0941
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
