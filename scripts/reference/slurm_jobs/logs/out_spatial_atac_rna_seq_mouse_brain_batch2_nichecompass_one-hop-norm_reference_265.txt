[True]
Run timestamp: 07092023_045541_265.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_265']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7830; val_auprc_score: 0.8038; val_best_acc_score: 0.5171; val_best_f1_score: 0.6706; train_kl_reg_loss: 88311.9580; train_edge_recon_loss: 3603572.5725; train_gene_expr_recon_loss: 17317408.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1253337.3063; train_chrom_access_recon_loss: 62071522.7786; train_global_loss: 84334153.5878; train_optim_loss: 84334153.5878; val_kl_reg_loss: 119480.5698; val_edge_recon_loss: 4063078.1833; val_gene_expr_recon_loss: 15800547.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 717493.0625; val_chrom_access_recon_loss: 59326927.2000; val_global_loss: 80027527.4667; val_optim_loss: 80027527.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8517; val_auprc_score: 0.8554; val_best_acc_score: 0.7088; val_best_f1_score: 0.7600; train_kl_reg_loss: 121335.4529; train_edge_recon_loss: 3541489.6183; train_gene_expr_recon_loss: 15611143.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 442765.6155; train_chrom_access_recon_loss: 59163475.3893; train_global_loss: 78880209.5267; train_optim_loss: 78880209.5267; val_kl_reg_loss: 118872.4151; val_edge_recon_loss: 4053163.6333; val_gene_expr_recon_loss: 15487101.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 269983.8438; val_chrom_access_recon_loss: 58538260.8000; val_global_loss: 78467381.3333; val_optim_loss: 78467381.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8836; val_auprc_score: 0.8759; val_best_acc_score: 0.7825; val_best_f1_score: 0.8135; train_kl_reg_loss: 104707.1608; train_edge_recon_loss: 3518282.2863; train_gene_expr_recon_loss: 15350777.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204247.8390; train_chrom_access_recon_loss: 58338879.6031; train_global_loss: 77516893.8015; train_optim_loss: 77516893.8015; val_kl_reg_loss: 85664.4661; val_edge_recon_loss: 3948075.5333; val_gene_expr_recon_loss: 15278975.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158887.7344; val_chrom_access_recon_loss: 57881656.8000; val_global_loss: 77353260.2667; val_optim_loss: 77353260.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8780; val_auprc_score: 0.8609; val_best_acc_score: 0.8018; val_best_f1_score: 0.8176; train_kl_reg_loss: 81513.6583; train_edge_recon_loss: 3401726.1966; train_gene_expr_recon_loss: 15173612.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133850.5852; train_chrom_access_recon_loss: 57756616.5191; train_global_loss: 76547319.5725; train_optim_loss: 76547319.5725; val_kl_reg_loss: 81932.8125; val_edge_recon_loss: 3080495.2000; val_gene_expr_recon_loss: 15155135.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114096.4844; val_chrom_access_recon_loss: 57562516.8000; val_global_loss: 75994176.5333; val_optim_loss: 75994176.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8777; val_auprc_score: 0.8585; val_best_acc_score: 0.8056; val_best_f1_score: 0.8253; train_kl_reg_loss: 108403.2852; train_edge_recon_loss: 2999482.4885; train_gene_expr_recon_loss: 15009726.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102105.1185; train_chrom_access_recon_loss: 57191613.9237; train_global_loss: 75411331.6031; train_optim_loss: 75411331.6031; val_kl_reg_loss: 108414.6708; val_edge_recon_loss: 2957499.5167; val_gene_expr_recon_loss: 14913510.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92579.2500; val_chrom_access_recon_loss: 56676293.3333; val_global_loss: 74748297.0667; val_optim_loss: 74748297.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8814; val_auprc_score: 0.8628; val_best_acc_score: 0.8044; val_best_f1_score: 0.8288; train_kl_reg_loss: 112911.2039; train_edge_recon_loss: 2934644.6469; train_gene_expr_recon_loss: 14884209.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86006.4618; train_chrom_access_recon_loss: 56814318.7176; train_global_loss: 74832090.2595; train_optim_loss: 74832090.2595; val_kl_reg_loss: 111124.6307; val_edge_recon_loss: 2895807.9167; val_gene_expr_recon_loss: 14803902.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80389.9141; val_chrom_access_recon_loss: 56388305.0667; val_global_loss: 74279530.6667; val_optim_loss: 74279530.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8845; val_auprc_score: 0.8647; val_best_acc_score: 0.8048; val_best_f1_score: 0.8307; train_kl_reg_loss: 109399.7068; train_edge_recon_loss: 2893695.2443; train_gene_expr_recon_loss: 14760314.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76332.6997; train_chrom_access_recon_loss: 56315159.2366; train_global_loss: 74154901.6794; train_optim_loss: 74154901.6794; val_kl_reg_loss: 107525.2135; val_edge_recon_loss: 2910046.8333; val_gene_expr_recon_loss: 14706482.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72886.4219; val_chrom_access_recon_loss: 55951277.0667; val_global_loss: 73748216.5333; val_optim_loss: 73748216.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9136; val_auprc_score: 0.8968; val_best_acc_score: 0.8350; val_best_f1_score: 0.8474; train_kl_reg_loss: 110232.7044; train_edge_recon_loss: 2861886.7710; train_gene_expr_recon_loss: 14666330.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70213.7844; train_chrom_access_recon_loss: 55945384.1527; train_global_loss: 73654047.5725; train_optim_loss: 73654047.5725; val_kl_reg_loss: 108533.6469; val_edge_recon_loss: 2825716.9667; val_gene_expr_recon_loss: 14588646.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67803.2812; val_chrom_access_recon_loss: 55601635.7333; val_global_loss: 73192336.5333; val_optim_loss: 73192336.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9284; val_auprc_score: 0.9134; val_best_acc_score: 0.8518; val_best_f1_score: 0.8625; train_kl_reg_loss: 107980.9475; train_edge_recon_loss: 2830889.2137; train_gene_expr_recon_loss: 14555139.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65794.6636; train_chrom_access_recon_loss: 55522050.2901; train_global_loss: 73081854.6870; train_optim_loss: 73081854.6870; val_kl_reg_loss: 107437.2391; val_edge_recon_loss: 2813575.8167; val_gene_expr_recon_loss: 14544620.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64188.4297; val_chrom_access_recon_loss: 55454748.8000; val_global_loss: 72984570.1333; val_optim_loss: 72984570.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9367; val_auprc_score: 0.9208; val_best_acc_score: 0.8723; val_best_f1_score: 0.8804; train_kl_reg_loss: 108510.4226; train_edge_recon_loss: 2802237.9237; train_gene_expr_recon_loss: 14481978.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62793.4968; train_chrom_access_recon_loss: 55225455.4809; train_global_loss: 72680975.9389; train_optim_loss: 72680975.9389; val_kl_reg_loss: 107525.5203; val_edge_recon_loss: 2786460.5000; val_gene_expr_recon_loss: 14442151.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61348.8711; val_chrom_access_recon_loss: 54906617.3333; val_global_loss: 72304102.4000; val_optim_loss: 72304102.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9392; val_auprc_score: 0.9252; val_best_acc_score: 0.8751; val_best_f1_score: 0.8831; train_kl_reg_loss: 105604.9096; train_edge_recon_loss: 2770407.4656; train_gene_expr_recon_loss: 14418047.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60529.5258; train_chrom_access_recon_loss: 54919854.6565; train_global_loss: 72274444.4580; train_optim_loss: 72274444.4580; val_kl_reg_loss: 107206.1172; val_edge_recon_loss: 2776366.6333; val_gene_expr_recon_loss: 14417272.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59710.9844; val_chrom_access_recon_loss: 54699159.7333; val_global_loss: 72059713.8667; val_optim_loss: 72059713.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9409; val_auprc_score: 0.9238; val_best_acc_score: 0.8770; val_best_f1_score: 0.8844; train_kl_reg_loss: 103855.7689; train_edge_recon_loss: 2769217.9237; train_gene_expr_recon_loss: 14337181.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58977.2633; train_chrom_access_recon_loss: 54565643.4198; train_global_loss: 71834875.5420; train_optim_loss: 71834875.5420; val_kl_reg_loss: 101588.9156; val_edge_recon_loss: 2798788.2667; val_gene_expr_recon_loss: 14388610.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58537.5547; val_chrom_access_recon_loss: 54533734.1333; val_global_loss: 71881259.7333; val_optim_loss: 71881259.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9455; val_auprc_score: 0.9314; val_best_acc_score: 0.8879; val_best_f1_score: 0.8942; train_kl_reg_loss: 101401.0970; train_edge_recon_loss: 2762807.1889; train_gene_expr_recon_loss: 14280030.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57743.0137; train_chrom_access_recon_loss: 54281054.6565; train_global_loss: 71483036.2443; train_optim_loss: 71483036.2443; val_kl_reg_loss: 99323.4276; val_edge_recon_loss: 2772430.6500; val_gene_expr_recon_loss: 14277596.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57226.9180; val_chrom_access_recon_loss: 54201486.1333; val_global_loss: 71408061.8667; val_optim_loss: 71408061.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9486; val_auprc_score: 0.9331; val_best_acc_score: 0.8894; val_best_f1_score: 0.8965; train_kl_reg_loss: 99708.1179; train_edge_recon_loss: 2750523.3798; train_gene_expr_recon_loss: 14225945.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56863.7765; train_chrom_access_recon_loss: 54044380.2748; train_global_loss: 71177420.6412; train_optim_loss: 71177420.6412; val_kl_reg_loss: 100513.3667; val_edge_recon_loss: 2763125.8667; val_gene_expr_recon_loss: 14161045.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56625.0742; val_chrom_access_recon_loss: 53898112.2667; val_global_loss: 70979421.6000; val_optim_loss: 70979421.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9566; val_auprc_score: 0.9466; val_best_acc_score: 0.9007; val_best_f1_score: 0.9062; train_kl_reg_loss: 97526.2856; train_edge_recon_loss: 2738203.7595; train_gene_expr_recon_loss: 14171814.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56391.8300; train_chrom_access_recon_loss: 53687196.8244; train_global_loss: 70751133.1603; train_optim_loss: 70751133.1603; val_kl_reg_loss: 96721.8984; val_edge_recon_loss: 2750572.2833; val_gene_expr_recon_loss: 14193154.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56115.1875; val_chrom_access_recon_loss: 53705470.1333; val_global_loss: 70802034.6667; val_optim_loss: 70802034.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9567; val_auprc_score: 0.9445; val_best_acc_score: 0.9012; val_best_f1_score: 0.9071; train_kl_reg_loss: 95881.1791; train_edge_recon_loss: 2739765.2137; train_gene_expr_recon_loss: 14134763.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56147.7338; train_chrom_access_recon_loss: 53499021.7405; train_global_loss: 70525579.1450; train_optim_loss: 70525579.1450; val_kl_reg_loss: 92693.1693; val_edge_recon_loss: 2739838.4667; val_gene_expr_recon_loss: 14053398.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55560.2891; val_chrom_access_recon_loss: 53276122.1333; val_global_loss: 70217611.4667; val_optim_loss: 70217611.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9589; val_auprc_score: 0.9462; val_best_acc_score: 0.9065; val_best_f1_score: 0.9112; train_kl_reg_loss: 94272.6873; train_edge_recon_loss: 2727509.6489; train_gene_expr_recon_loss: 14079640.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55655.0945; train_chrom_access_recon_loss: 53185068.5191; train_global_loss: 70142145.8931; train_optim_loss: 70142145.8931; val_kl_reg_loss: 93230.5979; val_edge_recon_loss: 2733514.9667; val_gene_expr_recon_loss: 14116233.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55686.6758; val_chrom_access_recon_loss: 53259423.7333; val_global_loss: 70258088.5333; val_optim_loss: 70258088.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9624; val_auprc_score: 0.9532; val_best_acc_score: 0.9122; val_best_f1_score: 0.9166; train_kl_reg_loss: 92537.0342; train_edge_recon_loss: 2727087.2385; train_gene_expr_recon_loss: 14038800.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55505.8796; train_chrom_access_recon_loss: 52965753.7405; train_global_loss: 69879683.9695; train_optim_loss: 69879683.9695; val_kl_reg_loss: 90323.3484; val_edge_recon_loss: 2722951.8500; val_gene_expr_recon_loss: 14086711.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55856.4922; val_chrom_access_recon_loss: 53048848.5333; val_global_loss: 70004692.2667; val_optim_loss: 70004692.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9632; val_auprc_score: 0.9517; val_best_acc_score: 0.9134; val_best_f1_score: 0.9174; train_kl_reg_loss: 91305.9884; train_edge_recon_loss: 2718332.8282; train_gene_expr_recon_loss: 14005713.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55570.8260; train_chrom_access_recon_loss: 52766487.2061; train_global_loss: 69637410.3511; train_optim_loss: 69637410.3511; val_kl_reg_loss: 89332.2120; val_edge_recon_loss: 2727158.8833; val_gene_expr_recon_loss: 14018821.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55521.5469; val_chrom_access_recon_loss: 52935768.0000; val_global_loss: 69826603.2000; val_optim_loss: 69826603.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9674; val_auprc_score: 0.9591; val_best_acc_score: 0.9170; val_best_f1_score: 0.9195; train_kl_reg_loss: 90246.7002; train_edge_recon_loss: 2708934.1985; train_gene_expr_recon_loss: 13969727.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55586.9928; train_chrom_access_recon_loss: 52525909.5267; train_global_loss: 69350405.4962; train_optim_loss: 69350405.4962; val_kl_reg_loss: 88472.2255; val_edge_recon_loss: 2719237.3833; val_gene_expr_recon_loss: 13995386.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55505.1211; val_chrom_access_recon_loss: 52726014.4000; val_global_loss: 69584616.5333; val_optim_loss: 69584616.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9683; val_auprc_score: 0.9616; val_best_acc_score: 0.9185; val_best_f1_score: 0.9220; train_kl_reg_loss: 89159.8257; train_edge_recon_loss: 2711365.7882; train_gene_expr_recon_loss: 13947221.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55659.3655; train_chrom_access_recon_loss: 52324962.8702; train_global_loss: 69128369.6183; train_optim_loss: 69128369.6183; val_kl_reg_loss: 88612.4307; val_edge_recon_loss: 2730900.5000; val_gene_expr_recon_loss: 13894474.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55481.3281; val_chrom_access_recon_loss: 52261982.1333; val_global_loss: 69031450.4000; val_optim_loss: 69031450.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9712; val_auprc_score: 0.9647; val_best_acc_score: 0.9210; val_best_f1_score: 0.9235; train_kl_reg_loss: 88736.9299; train_edge_recon_loss: 2711619.4218; train_gene_expr_recon_loss: 13920643.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55691.0234; train_chrom_access_recon_loss: 52149614.2290; train_global_loss: 68926305.5573; train_optim_loss: 68926305.5573; val_kl_reg_loss: 89130.0521; val_edge_recon_loss: 2721735.1833; val_gene_expr_recon_loss: 13985337.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56079.1992; val_chrom_access_recon_loss: 52759943.7333; val_global_loss: 69612225.8667; val_optim_loss: 69612225.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9716; val_auprc_score: 0.9651; val_best_acc_score: 0.9210; val_best_f1_score: 0.9237; train_kl_reg_loss: 87478.8145; train_edge_recon_loss: 2702879.3817; train_gene_expr_recon_loss: 13904023.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55844.4941; train_chrom_access_recon_loss: 52032589.9847; train_global_loss: 68782816.2748; train_optim_loss: 68782816.2748; val_kl_reg_loss: 86073.7198; val_edge_recon_loss: 2740416.9167; val_gene_expr_recon_loss: 13927052.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56025.0977; val_chrom_access_recon_loss: 52346345.0667; val_global_loss: 69155912.8000; val_optim_loss: 69155912.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9517; val_auprc_score: 0.9385; val_best_acc_score: 0.8880; val_best_f1_score: 0.8933; train_kl_reg_loss: 598807.2749; train_edge_recon_loss: 2793421.2786; train_gene_expr_recon_loss: 14309516.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59964.3697; train_chrom_access_recon_loss: 53519393.0687; train_global_loss: 71281102.5038; train_optim_loss: 71281102.5038; val_kl_reg_loss: 101389.1422; val_edge_recon_loss: 2815908.3833; val_gene_expr_recon_loss: 14125043.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63851.1914; val_chrom_access_recon_loss: 52758116.0000; val_global_loss: 69864308.5333; val_optim_loss: 69864308.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9419; val_auprc_score: 0.9314; val_best_acc_score: 0.8742; val_best_f1_score: 0.8811; train_kl_reg_loss: 1633971.7300; train_edge_recon_loss: 2880886.7748; train_gene_expr_recon_loss: 14444047.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61327.2541; train_chrom_access_recon_loss: 54000839.5420; train_global_loss: 73021072.5496; train_optim_loss: 73021072.5496; val_kl_reg_loss: 108011.2917; val_edge_recon_loss: 2983106.3500; val_gene_expr_recon_loss: 14240291.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59515.3672; val_chrom_access_recon_loss: 53116847.7333; val_global_loss: 70507772.2667; val_optim_loss: 70507772.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9458; val_auprc_score: 0.9350; val_best_acc_score: 0.8825; val_best_f1_score: 0.8889; train_kl_reg_loss: 111808.0547; train_edge_recon_loss: 2934314.2691; train_gene_expr_recon_loss: 14150863.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45143.2115; train_chrom_access_recon_loss: 52979572.4885; train_global_loss: 70221701.3130; train_optim_loss: 70221701.3130; val_kl_reg_loss: 92507.4760; val_edge_recon_loss: 2875514.5167; val_gene_expr_recon_loss: 14023604.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40502.5625; val_chrom_access_recon_loss: 52326146.6667; val_global_loss: 69358274.9333; val_optim_loss: 69358274.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9439; val_auprc_score: 0.9337; val_best_acc_score: 0.8760; val_best_f1_score: 0.8822; train_kl_reg_loss: 113447.3473; train_edge_recon_loss: 2836347.6031; train_gene_expr_recon_loss: 13960231.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39175.3157; train_chrom_access_recon_loss: 52452177.7710; train_global_loss: 69401379.2977; train_optim_loss: 69401379.2977; val_kl_reg_loss: 88951.7448; val_edge_recon_loss: 2835459.9833; val_gene_expr_recon_loss: 13831748.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38174.3945; val_chrom_access_recon_loss: 52000022.4000; val_global_loss: 68794356.2667; val_optim_loss: 68794356.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9399; val_auprc_score: 0.9246; val_best_acc_score: 0.8766; val_best_f1_score: 0.8844; train_kl_reg_loss: 110946.9504; train_edge_recon_loss: 2807579.1698; train_gene_expr_recon_loss: 13804518.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37534.9855; train_chrom_access_recon_loss: 52081991.8473; train_global_loss: 68842571.3282; train_optim_loss: 68842571.3282; val_kl_reg_loss: 85524.1276; val_edge_recon_loss: 2815519.7000; val_gene_expr_recon_loss: 13811785.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36931.5625; val_chrom_access_recon_loss: 51900429.6000; val_global_loss: 68650190.9333; val_optim_loss: 68650190.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9460; val_auprc_score: 0.9361; val_best_acc_score: 0.8806; val_best_f1_score: 0.8872; train_kl_reg_loss: 110397.5948; train_edge_recon_loss: 2787677.9866; train_gene_expr_recon_loss: 13764250.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36525.9982; train_chrom_access_recon_loss: 51886988.7939; train_global_loss: 68585840.6412; train_optim_loss: 68585840.6412; val_kl_reg_loss: 84747.4708; val_edge_recon_loss: 2793465.5167; val_gene_expr_recon_loss: 13746041.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36176.0820; val_chrom_access_recon_loss: 51751654.1333; val_global_loss: 68412084.8000; val_optim_loss: 68412084.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9433; val_auprc_score: 0.9325; val_best_acc_score: 0.8771; val_best_f1_score: 0.8846; train_kl_reg_loss: 110296.5871; train_edge_recon_loss: 2785765.5897; train_gene_expr_recon_loss: 13734819.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35897.1216; train_chrom_access_recon_loss: 51833717.6489; train_global_loss: 68500496.8855; train_optim_loss: 68500496.8855; val_kl_reg_loss: 83528.6583; val_edge_recon_loss: 2812268.2667; val_gene_expr_recon_loss: 13701851.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35638.3242; val_chrom_access_recon_loss: 51638572.8000; val_global_loss: 68271858.6667; val_optim_loss: 68271858.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9475; val_auprc_score: 0.9362; val_best_acc_score: 0.8855; val_best_f1_score: 0.8924; train_kl_reg_loss: 109815.8451; train_edge_recon_loss: 2786833.2595; train_gene_expr_recon_loss: 13708242.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35417.4023; train_chrom_access_recon_loss: 51725781.6489; train_global_loss: 68366090.5954; train_optim_loss: 68366090.5954; val_kl_reg_loss: 83797.6760; val_edge_recon_loss: 2779403.7167; val_gene_expr_recon_loss: 13756998.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35239.0000; val_chrom_access_recon_loss: 51866269.3333; val_global_loss: 68521709.3333; val_optim_loss: 68521709.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9439; val_auprc_score: 0.9306; val_best_acc_score: 0.8824; val_best_f1_score: 0.8892; train_kl_reg_loss: 109452.4702; train_edge_recon_loss: 2774156.8073; train_gene_expr_recon_loss: 13709530.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35075.9645; train_chrom_access_recon_loss: 51738606.2595; train_global_loss: 68366822.1679; train_optim_loss: 68366822.1679; val_kl_reg_loss: 83506.9901; val_edge_recon_loss: 2787503.1167; val_gene_expr_recon_loss: 13741860.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34915.6016; val_chrom_access_recon_loss: 51762036.0000; val_global_loss: 68409822.1333; val_optim_loss: 68409822.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9505; val_auprc_score: 0.9378; val_best_acc_score: 0.8863; val_best_f1_score: 0.8918; train_kl_reg_loss: 109411.6392; train_edge_recon_loss: 2776430.7366; train_gene_expr_recon_loss: 13697090.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34818.4892; train_chrom_access_recon_loss: 51709391.1145; train_global_loss: 68327142.9618; train_optim_loss: 68327142.9618; val_kl_reg_loss: 82189.2823; val_edge_recon_loss: 2778001.5833; val_gene_expr_recon_loss: 13639862.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34675.9883; val_chrom_access_recon_loss: 51573325.0667; val_global_loss: 68108054.4000; val_optim_loss: 68108054.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9458; val_auprc_score: 0.9363; val_best_acc_score: 0.8774; val_best_f1_score: 0.8842; train_kl_reg_loss: 108746.3107; train_edge_recon_loss: 2771916.3645; train_gene_expr_recon_loss: 13678445.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34578.9284; train_chrom_access_recon_loss: 51689049.1603; train_global_loss: 68282736.6718; train_optim_loss: 68282736.6718; val_kl_reg_loss: 81855.1146; val_edge_recon_loss: 2796548.8167; val_gene_expr_recon_loss: 13697241.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34502.6445; val_chrom_access_recon_loss: 51513065.6000; val_global_loss: 68123213.6000; val_optim_loss: 68123213.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9448; val_auprc_score: 0.9324; val_best_acc_score: 0.8812; val_best_f1_score: 0.8876; train_kl_reg_loss: 109176.0957; train_edge_recon_loss: 2768365.3989; train_gene_expr_recon_loss: 13681369.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34453.2560; train_chrom_access_recon_loss: 51662593.6794; train_global_loss: 68255957.9542; train_optim_loss: 68255957.9542; val_kl_reg_loss: 82620.1328; val_edge_recon_loss: 2793414.3333; val_gene_expr_recon_loss: 13754600.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34381.1719; val_chrom_access_recon_loss: 51794377.8667; val_global_loss: 68459394.9333; val_optim_loss: 68459394.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9476; val_auprc_score: 0.9374; val_best_acc_score: 0.8835; val_best_f1_score: 0.8902; train_kl_reg_loss: 109049.6295; train_edge_recon_loss: 2765585.2099; train_gene_expr_recon_loss: 13674829.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34300.8266; train_chrom_access_recon_loss: 51654245.8321; train_global_loss: 68238011.3282; train_optim_loss: 68238011.3282; val_kl_reg_loss: 81683.8214; val_edge_recon_loss: 2787261.1667; val_gene_expr_recon_loss: 13725589.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34232.8477; val_chrom_access_recon_loss: 51539744.2667; val_global_loss: 68168510.9333; val_optim_loss: 68168510.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9528; val_auprc_score: 0.9444; val_best_acc_score: 0.8875; val_best_f1_score: 0.8914; train_kl_reg_loss: 108861.1453; train_edge_recon_loss: 2755776.9599; train_gene_expr_recon_loss: 13662854.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34194.5082; train_chrom_access_recon_loss: 51601305.7710; train_global_loss: 68162992.4885; train_optim_loss: 68162992.4885; val_kl_reg_loss: 81479.8104; val_edge_recon_loss: 2782678.2500; val_gene_expr_recon_loss: 13721699.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34139.4531; val_chrom_access_recon_loss: 51753174.6667; val_global_loss: 68373171.7333; val_optim_loss: 68373171.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9455; val_auprc_score: 0.9292; val_best_acc_score: 0.8814; val_best_f1_score: 0.8869; train_kl_reg_loss: 108495.0864; train_edge_recon_loss: 2757979.7710; train_gene_expr_recon_loss: 13662642.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33769.5463; train_chrom_access_recon_loss: 51617394.0153; train_global_loss: 68180281.1908; train_optim_loss: 68180281.1908; val_kl_reg_loss: 81207.9214; val_edge_recon_loss: 2799752.1333; val_gene_expr_recon_loss: 13695931.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33706.9648; val_chrom_access_recon_loss: 51732970.6667; val_global_loss: 68343569.0667; val_optim_loss: 68343569.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9496; val_auprc_score: 0.9375; val_best_acc_score: 0.8821; val_best_f1_score: 0.8907; train_kl_reg_loss: 108413.5442; train_edge_recon_loss: 2753094.0153; train_gene_expr_recon_loss: 13664594.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33687.0917; train_chrom_access_recon_loss: 51578276.4885; train_global_loss: 68138065.6794; train_optim_loss: 68138065.6794; val_kl_reg_loss: 80996.5594; val_edge_recon_loss: 2770583.6500; val_gene_expr_recon_loss: 13659340.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33668.3125; val_chrom_access_recon_loss: 51381841.0667; val_global_loss: 67926430.6667; val_optim_loss: 67926430.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9514; val_auprc_score: 0.9373; val_best_acc_score: 0.8913; val_best_f1_score: 0.8953; train_kl_reg_loss: 108136.5472; train_edge_recon_loss: 2757859.4981; train_gene_expr_recon_loss: 13661238.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33653.7400; train_chrom_access_recon_loss: 51585402.5344; train_global_loss: 68146291.0840; train_optim_loss: 68146291.0840; val_kl_reg_loss: 81141.6302; val_edge_recon_loss: 2767115.9833; val_gene_expr_recon_loss: 13680577.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33640.5273; val_chrom_access_recon_loss: 51533341.3333; val_global_loss: 68095817.8667; val_optim_loss: 68095817.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9534; val_auprc_score: 0.9421; val_best_acc_score: 0.8903; val_best_f1_score: 0.8944; train_kl_reg_loss: 108088.4237; train_edge_recon_loss: 2753065.0363; train_gene_expr_recon_loss: 13660921.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33631.6662; train_chrom_access_recon_loss: 51608467.3282; train_global_loss: 68164174.1374; train_optim_loss: 68164174.1374; val_kl_reg_loss: 81186.1135; val_edge_recon_loss: 2763041.3167; val_gene_expr_recon_loss: 13648495.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33621.6719; val_chrom_access_recon_loss: 51280004.0000; val_global_loss: 67806349.3333; val_optim_loss: 67806349.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9467; val_auprc_score: 0.9350; val_best_acc_score: 0.8840; val_best_f1_score: 0.8895; train_kl_reg_loss: 108044.4187; train_edge_recon_loss: 2753776.7118; train_gene_expr_recon_loss: 13654301.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33611.9875; train_chrom_access_recon_loss: 51581491.5420; train_global_loss: 68131226.2595; train_optim_loss: 68131226.2595; val_kl_reg_loss: 81556.4385; val_edge_recon_loss: 2780277.2000; val_gene_expr_recon_loss: 13726175.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33600.0469; val_chrom_access_recon_loss: 51610580.2667; val_global_loss: 68232189.3333; val_optim_loss: 68232189.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9552; val_auprc_score: 0.9417; val_best_acc_score: 0.8911; val_best_f1_score: 0.8974; train_kl_reg_loss: 108049.8944; train_edge_recon_loss: 2759525.3321; train_gene_expr_recon_loss: 13654909.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33592.6258; train_chrom_access_recon_loss: 51571266.2290; train_global_loss: 68127343.3588; train_optim_loss: 68127343.3588; val_kl_reg_loss: 81320.0776; val_edge_recon_loss: 2752900.4500; val_gene_expr_recon_loss: 13748806.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33581.9727; val_chrom_access_recon_loss: 51909703.4667; val_global_loss: 68526312.5333; val_optim_loss: 68526312.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9505; val_auprc_score: 0.9384; val_best_acc_score: 0.8887; val_best_f1_score: 0.8940; train_kl_reg_loss: 108048.2814; train_edge_recon_loss: 2748097.6260; train_gene_expr_recon_loss: 13654425.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33574.7437; train_chrom_access_recon_loss: 51564537.2519; train_global_loss: 68108683.8168; train_optim_loss: 68108683.8168; val_kl_reg_loss: 80819.2260; val_edge_recon_loss: 2770619.4500; val_gene_expr_recon_loss: 13616927.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33565.0469; val_chrom_access_recon_loss: 51288834.1333; val_global_loss: 67790765.3333; val_optim_loss: 67790765.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9498; val_auprc_score: 0.9343; val_best_acc_score: 0.8902; val_best_f1_score: 0.8961; train_kl_reg_loss: 107780.0558; train_edge_recon_loss: 2753786.8550; train_gene_expr_recon_loss: 13649773.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33555.9993; train_chrom_access_recon_loss: 51536186.8702; train_global_loss: 68081083.1756; train_optim_loss: 68081083.1756; val_kl_reg_loss: 81131.6438; val_edge_recon_loss: 2757253.0000; val_gene_expr_recon_loss: 13698024.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33546.5898; val_chrom_access_recon_loss: 51641700.0000; val_global_loss: 68211656.5333; val_optim_loss: 68211656.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9533; val_auprc_score: 0.9434; val_best_acc_score: 0.8899; val_best_f1_score: 0.8948; train_kl_reg_loss: 107840.7028; train_edge_recon_loss: 2758666.4656; train_gene_expr_recon_loss: 13651592.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33542.2465; train_chrom_access_recon_loss: 51553779.7557; train_global_loss: 68105421.3740; train_optim_loss: 68105421.3740; val_kl_reg_loss: 80995.1417; val_edge_recon_loss: 2760789.5500; val_gene_expr_recon_loss: 13700967.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33532.8867; val_chrom_access_recon_loss: 51565681.8667; val_global_loss: 68141966.1333; val_optim_loss: 68141966.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9500; val_auprc_score: 0.9335; val_best_acc_score: 0.8888; val_best_f1_score: 0.8938; train_kl_reg_loss: 107549.7489; train_edge_recon_loss: 2763086.9370; train_gene_expr_recon_loss: 13655105.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33526.6411; train_chrom_access_recon_loss: 51557599.2977; train_global_loss: 68116868.3664; train_optim_loss: 68116868.3664; val_kl_reg_loss: 81183.5708; val_edge_recon_loss: 2765726.7500; val_gene_expr_recon_loss: 13702666.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33517.2852; val_chrom_access_recon_loss: 51466396.8000; val_global_loss: 68049491.2000; val_optim_loss: 68049491.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9511; val_auprc_score: 0.9413; val_best_acc_score: 0.8902; val_best_f1_score: 0.8953; train_kl_reg_loss: 107445.6351; train_edge_recon_loss: 2752549.2137; train_gene_expr_recon_loss: 13653003.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33510.3928; train_chrom_access_recon_loss: 51534151.8473; train_global_loss: 68080660.4885; train_optim_loss: 68080660.4885; val_kl_reg_loss: 81279.9458; val_edge_recon_loss: 2771988.4500; val_gene_expr_recon_loss: 13639904.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33502.9180; val_chrom_access_recon_loss: 51250124.5333; val_global_loss: 67776799.4667; val_optim_loss: 67776799.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9509; val_auprc_score: 0.9390; val_best_acc_score: 0.8902; val_best_f1_score: 0.8957; train_kl_reg_loss: 107440.4125; train_edge_recon_loss: 2753382.2805; train_gene_expr_recon_loss: 13655225.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33497.7929; train_chrom_access_recon_loss: 51595442.7481; train_global_loss: 68144989.0687; train_optim_loss: 68144989.0687; val_kl_reg_loss: 80990.8771; val_edge_recon_loss: 2765425.4167; val_gene_expr_recon_loss: 13658792.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33490.2578; val_chrom_access_recon_loss: 51426621.3333; val_global_loss: 67965320.0000; val_optim_loss: 67965320.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9490; val_auprc_score: 0.9386; val_best_acc_score: 0.8860; val_best_f1_score: 0.8917; train_kl_reg_loss: 107435.9820; train_edge_recon_loss: 2749526.4389; train_gene_expr_recon_loss: 13644813.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33483.4947; train_chrom_access_recon_loss: 51534398.4427; train_global_loss: 68069657.9237; train_optim_loss: 68069657.9237; val_kl_reg_loss: 80418.3125; val_edge_recon_loss: 2788457.0000; val_gene_expr_recon_loss: 13674691.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33473.7930; val_chrom_access_recon_loss: 51406506.1333; val_global_loss: 67983546.4000; val_optim_loss: 67983546.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9535; val_auprc_score: 0.9465; val_best_acc_score: 0.8907; val_best_f1_score: 0.8947; train_kl_reg_loss: 106945.6292; train_edge_recon_loss: 2757335.7863; train_gene_expr_recon_loss: 13652028.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33466.3678; train_chrom_access_recon_loss: 51553512.7023; train_global_loss: 68103289.4962; train_optim_loss: 68103289.4962; val_kl_reg_loss: 81085.2094; val_edge_recon_loss: 2765224.2167; val_gene_expr_recon_loss: 13653854.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33457.6797; val_chrom_access_recon_loss: 51493184.8000; val_global_loss: 68026806.1333; val_optim_loss: 68026806.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9527; val_auprc_score: 0.9414; val_best_acc_score: 0.8934; val_best_f1_score: 0.8980; train_kl_reg_loss: 107017.1701; train_edge_recon_loss: 2755044.2156; train_gene_expr_recon_loss: 13651886.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33451.5321; train_chrom_access_recon_loss: 51558382.1069; train_global_loss: 68105782.1374; train_optim_loss: 68105782.1374; val_kl_reg_loss: 80666.0557; val_edge_recon_loss: 2762647.1667; val_gene_expr_recon_loss: 13658931.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33440.1016; val_chrom_access_recon_loss: 51484620.0000; val_global_loss: 68020304.5333; val_optim_loss: 68020304.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9519; val_auprc_score: 0.9423; val_best_acc_score: 0.8884; val_best_f1_score: 0.8946; train_kl_reg_loss: 106966.4268; train_edge_recon_loss: 2757963.4427; train_gene_expr_recon_loss: 13663151.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33402.9274; train_chrom_access_recon_loss: 51601329.6794; train_global_loss: 68162813.5267; train_optim_loss: 68162813.5267; val_kl_reg_loss: 80707.9516; val_edge_recon_loss: 2758315.3667; val_gene_expr_recon_loss: 13647906.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33397.0273; val_chrom_access_recon_loss: 51585797.0667; val_global_loss: 68106124.0000; val_optim_loss: 68106124.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9555; val_auprc_score: 0.9475; val_best_acc_score: 0.8910; val_best_f1_score: 0.8956; train_kl_reg_loss: 107087.6390; train_edge_recon_loss: 2754046.2557; train_gene_expr_recon_loss: 13648856.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33395.0771; train_chrom_access_recon_loss: 51526730.9924; train_global_loss: 68070116.9771; train_optim_loss: 68070116.9771; val_kl_reg_loss: 80746.9911; val_edge_recon_loss: 2758381.6500; val_gene_expr_recon_loss: 13657768.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33393.3125; val_chrom_access_recon_loss: 51478227.2000; val_global_loss: 68008518.6667; val_optim_loss: 68008518.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9495; val_auprc_score: 0.9376; val_best_acc_score: 0.8853; val_best_f1_score: 0.8919; train_kl_reg_loss: 106976.0788; train_edge_recon_loss: 2753377.9275; train_gene_expr_recon_loss: 13650018.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33391.6979; train_chrom_access_recon_loss: 51579758.6870; train_global_loss: 68123522.1985; train_optim_loss: 68123522.1985; val_kl_reg_loss: 80745.7516; val_edge_recon_loss: 2780357.2500; val_gene_expr_recon_loss: 13628831.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33390.2109; val_chrom_access_recon_loss: 51377260.5333; val_global_loss: 67900585.3333; val_optim_loss: 67900585.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9532; val_auprc_score: 0.9419; val_best_acc_score: 0.8922; val_best_f1_score: 0.8965; train_kl_reg_loss: 107004.1021; train_edge_recon_loss: 2751995.0840; train_gene_expr_recon_loss: 13651846.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33389.0819; train_chrom_access_recon_loss: 51559976.7634; train_global_loss: 68104211.9389; train_optim_loss: 68104211.9389; val_kl_reg_loss: 80683.8938; val_edge_recon_loss: 2781786.2333; val_gene_expr_recon_loss: 13688409.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33387.7891; val_chrom_access_recon_loss: 51303266.9333; val_global_loss: 67887534.9333; val_optim_loss: 67887534.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 170 min 31 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9513
val AUPRC score: 0.9405
val best accuracy score: 0.8906
val best F1 score: 0.8944
val target rna MSE score: 1.1559
val source rna MSE score: 0.4034
val target atac MSE score: 0.1232
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
