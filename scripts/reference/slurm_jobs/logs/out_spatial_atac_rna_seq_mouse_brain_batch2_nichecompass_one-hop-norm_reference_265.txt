[True]
Run timestamp: 10102023_123317_265.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_265']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7638; val_auprc_score: 0.7887; val_best_acc_score: 0.5236; val_best_f1_score: 0.6761; train_kl_reg_loss: 69279.2628; train_edge_recon_loss: 747340.8607; train_gene_expr_recon_loss: 22366846.8092; train_masked_gp_l1_reg_loss: 64866.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4085061.2066; train_chrom_access_recon_loss: 4766546.5191; train_global_loss: 32099941.0534; train_optim_loss: 32099941.0534; val_kl_reg_loss: 84569.7104; val_edge_recon_loss: 812701.7250; val_gene_expr_recon_loss: 20832043.0667; val_masked_gp_l1_reg_loss: 69754.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1022494.7500; val_chrom_access_recon_loss: 4550989.8667; val_global_loss: 27372552.2667; val_optim_loss: 27372552.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8472; val_auprc_score: 0.8564; val_best_acc_score: 0.7664; val_best_f1_score: 0.7598; train_kl_reg_loss: 74435.0511; train_edge_recon_loss: 733918.1670; train_gene_expr_recon_loss: 20959948.7481; train_masked_gp_l1_reg_loss: 70134.7426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 528363.5215; train_chrom_access_recon_loss: 4608413.5439; train_global_loss: 26975213.8168; train_optim_loss: 26975213.8168; val_kl_reg_loss: 60955.9487; val_edge_recon_loss: 800424.8667; val_gene_expr_recon_loss: 20577403.8667; val_masked_gp_l1_reg_loss: 71232.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 291947.2500; val_chrom_access_recon_loss: 4506578.6667; val_global_loss: 26308543.0667; val_optim_loss: 26308543.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8996; val_auprc_score: 0.8891; val_best_acc_score: 0.8217; val_best_f1_score: 0.8288; train_kl_reg_loss: 64356.4777; train_edge_recon_loss: 711655.9776; train_gene_expr_recon_loss: 20675490.3053; train_masked_gp_l1_reg_loss: 72711.7509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222721.3610; train_chrom_access_recon_loss: 4551712.0553; train_global_loss: 26298647.9237; train_optim_loss: 26298647.9237; val_kl_reg_loss: 63468.3068; val_edge_recon_loss: 720993.3292; val_gene_expr_recon_loss: 20358981.2000; val_masked_gp_l1_reg_loss: 74359.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184178.7344; val_chrom_access_recon_loss: 4481290.7000; val_global_loss: 25883271.3333; val_optim_loss: 25883271.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9226; val_auprc_score: 0.9094; val_best_acc_score: 0.8506; val_best_f1_score: 0.8572; train_kl_reg_loss: 70352.6777; train_edge_recon_loss: 648538.5329; train_gene_expr_recon_loss: 20386352.2290; train_masked_gp_l1_reg_loss: 76086.0476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166875.3063; train_chrom_access_recon_loss: 4501911.5687; train_global_loss: 25850116.4580; train_optim_loss: 25850116.4580; val_kl_reg_loss: 71443.0865; val_edge_recon_loss: 626054.4917; val_gene_expr_recon_loss: 19990311.3333; val_masked_gp_l1_reg_loss: 77966.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154541.7656; val_chrom_access_recon_loss: 4388068.8333; val_global_loss: 25308386.0000; val_optim_loss: 25308386.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9265; val_auprc_score: 0.9086; val_best_acc_score: 0.8584; val_best_f1_score: 0.8663; train_kl_reg_loss: 73819.3121; train_edge_recon_loss: 618125.1613; train_gene_expr_recon_loss: 20187319.7863; train_masked_gp_l1_reg_loss: 79382.0208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144419.5218; train_chrom_access_recon_loss: 4470100.4580; train_global_loss: 25573166.3359; train_optim_loss: 25573166.3359; val_kl_reg_loss: 71745.3068; val_edge_recon_loss: 612803.6125; val_gene_expr_recon_loss: 19819966.5333; val_masked_gp_l1_reg_loss: 80553.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136524.3125; val_chrom_access_recon_loss: 4380305.0500; val_global_loss: 25101898.5333; val_optim_loss: 25101898.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9309; val_auprc_score: 0.9214; val_best_acc_score: 0.8596; val_best_f1_score: 0.8665; train_kl_reg_loss: 72235.1693; train_edge_recon_loss: 608822.6670; train_gene_expr_recon_loss: 20047810.8397; train_masked_gp_l1_reg_loss: 81537.0139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129230.1360; train_chrom_access_recon_loss: 4438105.6527; train_global_loss: 25377741.3740; train_optim_loss: 25377741.3740; val_kl_reg_loss: 71636.3781; val_edge_recon_loss: 607678.4125; val_gene_expr_recon_loss: 19630143.3333; val_masked_gp_l1_reg_loss: 82355.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123977.8125; val_chrom_access_recon_loss: 4335289.4833; val_global_loss: 24851081.6000; val_optim_loss: 24851081.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9333; val_auprc_score: 0.9199; val_best_acc_score: 0.8627; val_best_f1_score: 0.8724; train_kl_reg_loss: 69662.9427; train_edge_recon_loss: 603711.7610; train_gene_expr_recon_loss: 19902498.4122; train_masked_gp_l1_reg_loss: 82979.2037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120009.0197; train_chrom_access_recon_loss: 4405540.0305; train_global_loss: 25184401.3588; train_optim_loss: 25184401.3588; val_kl_reg_loss: 68611.9474; val_edge_recon_loss: 603048.7250; val_gene_expr_recon_loss: 19540303.3333; val_masked_gp_l1_reg_loss: 83554.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117083.3906; val_chrom_access_recon_loss: 4312910.3000; val_global_loss: 24725511.7333; val_optim_loss: 24725511.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9382; val_auprc_score: 0.9249; val_best_acc_score: 0.8689; val_best_f1_score: 0.8756; train_kl_reg_loss: 68486.5450; train_edge_recon_loss: 600539.4084; train_gene_expr_recon_loss: 19762505.0076; train_masked_gp_l1_reg_loss: 83892.6968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115761.3318; train_chrom_access_recon_loss: 4374703.6851; train_global_loss: 25005888.3969; train_optim_loss: 25005888.3969; val_kl_reg_loss: 66680.8031; val_edge_recon_loss: 600533.2417; val_gene_expr_recon_loss: 19455915.2000; val_masked_gp_l1_reg_loss: 84293.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116628.1406; val_chrom_access_recon_loss: 4285240.2167; val_global_loss: 24609291.0667; val_optim_loss: 24609291.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9382; val_auprc_score: 0.9263; val_best_acc_score: 0.8672; val_best_f1_score: 0.8752; train_kl_reg_loss: 66627.7827; train_edge_recon_loss: 596655.4074; train_gene_expr_recon_loss: 19650240.3053; train_masked_gp_l1_reg_loss: 84638.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114481.5280; train_chrom_access_recon_loss: 4351307.2691; train_global_loss: 24863950.7481; train_optim_loss: 24863950.7481; val_kl_reg_loss: 65554.7253; val_edge_recon_loss: 600423.4333; val_gene_expr_recon_loss: 19264542.2667; val_masked_gp_l1_reg_loss: 84987.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115786.5703; val_chrom_access_recon_loss: 4253636.6500; val_global_loss: 24384930.9333; val_optim_loss: 24384930.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9493; val_auprc_score: 0.9380; val_best_acc_score: 0.8808; val_best_f1_score: 0.8872; train_kl_reg_loss: 65439.9178; train_edge_recon_loss: 593784.5811; train_gene_expr_recon_loss: 19585769.0687; train_masked_gp_l1_reg_loss: 85376.5104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113156.3483; train_chrom_access_recon_loss: 4332829.7443; train_global_loss: 24776356.1527; train_optim_loss: 24776356.1527; val_kl_reg_loss: 62711.4271; val_edge_recon_loss: 594526.2375; val_gene_expr_recon_loss: 19173021.6000; val_masked_gp_l1_reg_loss: 85534.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110799.3906; val_chrom_access_recon_loss: 4235062.4333; val_global_loss: 24261656.0000; val_optim_loss: 24261656.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9522; val_auprc_score: 0.9446; val_best_acc_score: 0.8857; val_best_f1_score: 0.8894; train_kl_reg_loss: 64206.7082; train_edge_recon_loss: 592206.2328; train_gene_expr_recon_loss: 19482782.0916; train_masked_gp_l1_reg_loss: 85922.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109877.7831; train_chrom_access_recon_loss: 4307618.9866; train_global_loss: 24642614.2137; train_optim_loss: 24642614.2137; val_kl_reg_loss: 64521.8547; val_edge_recon_loss: 592507.9125; val_gene_expr_recon_loss: 19115377.6000; val_masked_gp_l1_reg_loss: 86392.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110388.4766; val_chrom_access_recon_loss: 4219037.2000; val_global_loss: 24188224.8000; val_optim_loss: 24188224.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9581; val_auprc_score: 0.9504; val_best_acc_score: 0.8985; val_best_f1_score: 0.9016; train_kl_reg_loss: 63627.1833; train_edge_recon_loss: 589559.8282; train_gene_expr_recon_loss: 19380011.3435; train_masked_gp_l1_reg_loss: 86655.4920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107932.8775; train_chrom_access_recon_loss: 4281421.5687; train_global_loss: 24509208.3206; train_optim_loss: 24509208.3206; val_kl_reg_loss: 63547.3164; val_edge_recon_loss: 588773.6792; val_gene_expr_recon_loss: 19151544.0000; val_masked_gp_l1_reg_loss: 86997.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106473.2578; val_chrom_access_recon_loss: 4209195.1500; val_global_loss: 24206532.1333; val_optim_loss: 24206532.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9608; val_auprc_score: 0.9515; val_best_acc_score: 0.9018; val_best_f1_score: 0.9040; train_kl_reg_loss: 62828.3248; train_edge_recon_loss: 588423.5949; train_gene_expr_recon_loss: 19321853.8473; train_masked_gp_l1_reg_loss: 87207.9986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105548.6321; train_chrom_access_recon_loss: 4266066.4790; train_global_loss: 24431928.9160; train_optim_loss: 24431928.9160; val_kl_reg_loss: 62356.4867; val_edge_recon_loss: 589364.6000; val_gene_expr_recon_loss: 19004180.4000; val_masked_gp_l1_reg_loss: 87509.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105165.3906; val_chrom_access_recon_loss: 4186299.7333; val_global_loss: 24034877.0667; val_optim_loss: 24034877.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9603; val_auprc_score: 0.9490; val_best_acc_score: 0.9049; val_best_f1_score: 0.9069; train_kl_reg_loss: 62439.8535; train_edge_recon_loss: 585835.6274; train_gene_expr_recon_loss: 19256023.0992; train_masked_gp_l1_reg_loss: 87758.5700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103950.1574; train_chrom_access_recon_loss: 4249769.9542; train_global_loss: 24345777.1298; train_optim_loss: 24345777.1298; val_kl_reg_loss: 60781.4266; val_edge_recon_loss: 589360.3333; val_gene_expr_recon_loss: 18973723.4667; val_masked_gp_l1_reg_loss: 88154.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103907.5469; val_chrom_access_recon_loss: 4177580.2833; val_global_loss: 23993507.2000; val_optim_loss: 23993507.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9633; val_auprc_score: 0.9566; val_best_acc_score: 0.9072; val_best_f1_score: 0.9102; train_kl_reg_loss: 61812.1211; train_edge_recon_loss: 583762.0014; train_gene_expr_recon_loss: 19191076.6565; train_masked_gp_l1_reg_loss: 88541.5515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102873.6568; train_chrom_access_recon_loss: 4231158.2156; train_global_loss: 24259224.2748; train_optim_loss: 24259224.2748; val_kl_reg_loss: 61857.0151; val_edge_recon_loss: 583817.3833; val_gene_expr_recon_loss: 18859446.1333; val_masked_gp_l1_reg_loss: 88741.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102449.1641; val_chrom_access_recon_loss: 4139414.3500; val_global_loss: 23835727.0667; val_optim_loss: 23835727.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9634; val_auprc_score: 0.9558; val_best_acc_score: 0.9089; val_best_f1_score: 0.9122; train_kl_reg_loss: 61281.7153; train_edge_recon_loss: 584051.1536; train_gene_expr_recon_loss: 19128570.9160; train_masked_gp_l1_reg_loss: 89140.8200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101876.7183; train_chrom_access_recon_loss: 4208848.3187; train_global_loss: 24173769.5878; train_optim_loss: 24173769.5878; val_kl_reg_loss: 62271.5776; val_edge_recon_loss: 589365.0833; val_gene_expr_recon_loss: 18911371.3333; val_masked_gp_l1_reg_loss: 89497.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101732.3984; val_chrom_access_recon_loss: 4143775.9667; val_global_loss: 23898013.7333; val_optim_loss: 23898013.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9608; val_auprc_score: 0.9491; val_best_acc_score: 0.9070; val_best_f1_score: 0.9107; train_kl_reg_loss: 60593.7708; train_edge_recon_loss: 581803.8268; train_gene_expr_recon_loss: 19075719.6031; train_masked_gp_l1_reg_loss: 89818.5747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101180.0524; train_chrom_access_recon_loss: 4188436.3073; train_global_loss: 24097552.1374; train_optim_loss: 24097552.1374; val_kl_reg_loss: 59188.4221; val_edge_recon_loss: 586002.0083; val_gene_expr_recon_loss: 18829515.7333; val_masked_gp_l1_reg_loss: 90314.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102435.9297; val_chrom_access_recon_loss: 4119358.3500; val_global_loss: 23786814.8000; val_optim_loss: 23786814.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9670; val_auprc_score: 0.9578; val_best_acc_score: 0.9167; val_best_f1_score: 0.9188; train_kl_reg_loss: 59905.7235; train_edge_recon_loss: 582484.0954; train_gene_expr_recon_loss: 19014246.9618; train_masked_gp_l1_reg_loss: 90613.6798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101225.6240; train_chrom_access_recon_loss: 4170831.7576; train_global_loss: 24019307.7405; train_optim_loss: 24019307.7405; val_kl_reg_loss: 59045.2688; val_edge_recon_loss: 583641.8542; val_gene_expr_recon_loss: 18774190.5333; val_masked_gp_l1_reg_loss: 91079.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101652.8281; val_chrom_access_recon_loss: 4097301.0000; val_global_loss: 23706910.6667; val_optim_loss: 23706910.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9657; val_auprc_score: 0.9576; val_best_acc_score: 0.9128; val_best_f1_score: 0.9161; train_kl_reg_loss: 59668.3393; train_edge_recon_loss: 580354.5429; train_gene_expr_recon_loss: 18964286.4885; train_masked_gp_l1_reg_loss: 91444.7632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101165.0556; train_chrom_access_recon_loss: 4151272.9275; train_global_loss: 23948192.1985; train_optim_loss: 23948192.1985; val_kl_reg_loss: 59515.9034; val_edge_recon_loss: 586049.5417; val_gene_expr_recon_loss: 18697305.3333; val_masked_gp_l1_reg_loss: 91681.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101162.3359; val_chrom_access_recon_loss: 4087095.5667; val_global_loss: 23622810.4000; val_optim_loss: 23622810.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9683; val_auprc_score: 0.9612; val_best_acc_score: 0.9157; val_best_f1_score: 0.9188; train_kl_reg_loss: 59457.3867; train_edge_recon_loss: 580328.1135; train_gene_expr_recon_loss: 18894184.9313; train_masked_gp_l1_reg_loss: 92092.4033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101076.6494; train_chrom_access_recon_loss: 4128720.1202; train_global_loss: 23855859.6947; train_optim_loss: 23855859.6947; val_kl_reg_loss: 59116.1721; val_edge_recon_loss: 582527.0792; val_gene_expr_recon_loss: 18598927.6000; val_masked_gp_l1_reg_loss: 92487.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101100.8359; val_chrom_access_recon_loss: 4067072.3000; val_global_loss: 23501230.6667; val_optim_loss: 23501230.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9695; val_auprc_score: 0.9620; val_best_acc_score: 0.9190; val_best_f1_score: 0.9216; train_kl_reg_loss: 58942.9811; train_edge_recon_loss: 579439.4237; train_gene_expr_recon_loss: 18872528.9160; train_masked_gp_l1_reg_loss: 92819.7333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101011.5644; train_chrom_access_recon_loss: 4113951.4924; train_global_loss: 23818694.0763; train_optim_loss: 23818694.0763; val_kl_reg_loss: 58607.0109; val_edge_recon_loss: 581672.4208; val_gene_expr_recon_loss: 18668455.8667; val_masked_gp_l1_reg_loss: 93275.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102162.7031; val_chrom_access_recon_loss: 4060316.5667; val_global_loss: 23564489.6000; val_optim_loss: 23564489.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9690; val_auprc_score: 0.9590; val_best_acc_score: 0.9179; val_best_f1_score: 0.9205; train_kl_reg_loss: 58407.5680; train_edge_recon_loss: 580118.1150; train_gene_expr_recon_loss: 18822786.7328; train_masked_gp_l1_reg_loss: 93765.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101322.9669; train_chrom_access_recon_loss: 4094707.6393; train_global_loss: 23751108.2901; train_optim_loss: 23751108.2901; val_kl_reg_loss: 58216.8562; val_edge_recon_loss: 580646.5125; val_gene_expr_recon_loss: 18614024.6667; val_masked_gp_l1_reg_loss: 93968.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101621.2734; val_chrom_access_recon_loss: 4041151.4000; val_global_loss: 23489629.3333; val_optim_loss: 23489629.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9707; val_auprc_score: 0.9608; val_best_acc_score: 0.9232; val_best_f1_score: 0.9252; train_kl_reg_loss: 58231.7310; train_edge_recon_loss: 579735.3531; train_gene_expr_recon_loss: 18798432.9618; train_masked_gp_l1_reg_loss: 94381.5008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101455.3463; train_chrom_access_recon_loss: 4079325.0115; train_global_loss: 23711562.1679; train_optim_loss: 23711562.1679; val_kl_reg_loss: 57708.9135; val_edge_recon_loss: 579636.3417; val_gene_expr_recon_loss: 18550023.4667; val_masked_gp_l1_reg_loss: 94749.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101943.7266; val_chrom_access_recon_loss: 4036486.4667; val_global_loss: 23420549.3333; val_optim_loss: 23420549.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9685; val_auprc_score: 0.9614; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 58420.5907; train_edge_recon_loss: 577079.4766; train_gene_expr_recon_loss: 18751025.6489; train_masked_gp_l1_reg_loss: 95200.0081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101347.7903; train_chrom_access_recon_loss: 4060947.3702; train_global_loss: 23644021.0076; train_optim_loss: 23644021.0076; val_kl_reg_loss: 57616.6849; val_edge_recon_loss: 579683.5750; val_gene_expr_recon_loss: 18639848.5333; val_masked_gp_l1_reg_loss: 95524.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101450.4609; val_chrom_access_recon_loss: 4017821.1667; val_global_loss: 23491944.1333; val_optim_loss: 23491944.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9710; val_auprc_score: 0.9633; val_best_acc_score: 0.9178; val_best_f1_score: 0.9206; train_kl_reg_loss: 57919.0061; train_edge_recon_loss: 577815.6398; train_gene_expr_recon_loss: 18677948.0840; train_masked_gp_l1_reg_loss: 95958.1273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101407.8894; train_chrom_access_recon_loss: 4033772.6317; train_global_loss: 23544821.4351; train_optim_loss: 23544821.4351; val_kl_reg_loss: 58271.8596; val_edge_recon_loss: 578642.1125; val_gene_expr_recon_loss: 18508235.7333; val_masked_gp_l1_reg_loss: 96289.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101404.3359; val_chrom_access_recon_loss: 3993105.1667; val_global_loss: 23335948.8000; val_optim_loss: 23335948.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9467; val_auprc_score: 0.9376; val_best_acc_score: 0.8810; val_best_f1_score: 0.8851; train_kl_reg_loss: 53220.0728; train_edge_recon_loss: 624945.8650; train_gene_expr_recon_loss: 17521372.7481; train_masked_gp_l1_reg_loss: 95198.8609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90244.2401; train_chrom_access_recon_loss: 3898183.1221; train_global_loss: 22283164.8397; train_optim_loss: 22283164.8397; val_kl_reg_loss: 33745.9461; val_edge_recon_loss: 601180.4708; val_gene_expr_recon_loss: 17182248.9333; val_masked_gp_l1_reg_loss: 93447.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88507.6875; val_chrom_access_recon_loss: 3793491.0667; val_global_loss: 21792623.0667; val_optim_loss: 21792623.0667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9561; val_auprc_score: 0.9492; val_best_acc_score: 0.8926; val_best_f1_score: 0.8951; train_kl_reg_loss: 50255.0137; train_edge_recon_loss: 589051.9260; train_gene_expr_recon_loss: 17416884.8244; train_masked_gp_l1_reg_loss: 91706.2558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88165.3551; train_chrom_access_recon_loss: 3859392.1240; train_global_loss: 22095455.6183; train_optim_loss: 22095455.6183; val_kl_reg_loss: 40506.3120; val_edge_recon_loss: 587151.0000; val_gene_expr_recon_loss: 17196877.4667; val_masked_gp_l1_reg_loss: 90133.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88920.0000; val_chrom_access_recon_loss: 3795016.1833; val_global_loss: 21798605.3333; val_optim_loss: 21798605.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9585; val_auprc_score: 0.9521; val_best_acc_score: 0.8963; val_best_f1_score: 0.8997; train_kl_reg_loss: 49438.6201; train_edge_recon_loss: 580528.3869; train_gene_expr_recon_loss: 17365558.4733; train_masked_gp_l1_reg_loss: 88756.6099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88039.0849; train_chrom_access_recon_loss: 3853071.8435; train_global_loss: 22025393.1145; train_optim_loss: 22025393.1145; val_kl_reg_loss: 41153.2438; val_edge_recon_loss: 585659.0958; val_gene_expr_recon_loss: 17159950.6667; val_masked_gp_l1_reg_loss: 87566.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88237.3828; val_chrom_access_recon_loss: 3794864.0833; val_global_loss: 21757431.4667; val_optim_loss: 21757431.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9640; val_auprc_score: 0.9579; val_best_acc_score: 0.9078; val_best_f1_score: 0.9103; train_kl_reg_loss: 48931.5682; train_edge_recon_loss: 576812.1097; train_gene_expr_recon_loss: 17332604.0763; train_masked_gp_l1_reg_loss: 86811.4745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87938.9023; train_chrom_access_recon_loss: 3846615.6260; train_global_loss: 21979713.7863; train_optim_loss: 21979713.7863; val_kl_reg_loss: 41620.3419; val_edge_recon_loss: 578096.6875; val_gene_expr_recon_loss: 17146295.8000; val_masked_gp_l1_reg_loss: 86023.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88030.3828; val_chrom_access_recon_loss: 3788321.9167; val_global_loss: 21728388.5333; val_optim_loss: 21728388.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9655; val_auprc_score: 0.9585; val_best_acc_score: 0.9117; val_best_f1_score: 0.9135; train_kl_reg_loss: 48615.8293; train_edge_recon_loss: 573452.0544; train_gene_expr_recon_loss: 17304327.0153; train_masked_gp_l1_reg_loss: 85523.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87991.7885; train_chrom_access_recon_loss: 3846606.2863; train_global_loss: 21946516.0305; train_optim_loss: 21946516.0305; val_kl_reg_loss: 43987.0286; val_edge_recon_loss: 576909.9417; val_gene_expr_recon_loss: 17130280.4000; val_masked_gp_l1_reg_loss: 85026.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87966.1250; val_chrom_access_recon_loss: 3779802.0333; val_global_loss: 21703971.2000; val_optim_loss: 21703971.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9660; val_auprc_score: 0.9559; val_best_acc_score: 0.9130; val_best_f1_score: 0.9146; train_kl_reg_loss: 47991.1786; train_edge_recon_loss: 573615.5095; train_gene_expr_recon_loss: 17261934.5878; train_masked_gp_l1_reg_loss: 84667.8849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87866.9974; train_chrom_access_recon_loss: 3835197.6889; train_global_loss: 21891274.0153; train_optim_loss: 21891274.0153; val_kl_reg_loss: 42540.0878; val_edge_recon_loss: 574386.5042; val_gene_expr_recon_loss: 17044260.8667; val_masked_gp_l1_reg_loss: 84341.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88245.2734; val_chrom_access_recon_loss: 3764437.2667; val_global_loss: 21598212.8000; val_optim_loss: 21598212.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9642; val_auprc_score: 0.9540; val_best_acc_score: 0.9124; val_best_f1_score: 0.9151; train_kl_reg_loss: 47897.1835; train_edge_recon_loss: 572986.3049; train_gene_expr_recon_loss: 17215958.1908; train_masked_gp_l1_reg_loss: 84048.6433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88080.6572; train_chrom_access_recon_loss: 3828991.3073; train_global_loss: 21837962.4122; train_optim_loss: 21837962.4122; val_kl_reg_loss: 44293.8586; val_edge_recon_loss: 572648.4958; val_gene_expr_recon_loss: 17025896.3333; val_masked_gp_l1_reg_loss: 83762.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87869.4609; val_chrom_access_recon_loss: 3748210.1833; val_global_loss: 21562680.6667; val_optim_loss: 21562680.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9620; val_auprc_score: 0.9515; val_best_acc_score: 0.9089; val_best_f1_score: 0.9126; train_kl_reg_loss: 47870.5175; train_edge_recon_loss: 569757.4714; train_gene_expr_recon_loss: 17197571.5496; train_masked_gp_l1_reg_loss: 83619.2467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88127.7208; train_chrom_access_recon_loss: 3824220.5878; train_global_loss: 21811166.9771; train_optim_loss: 21811166.9771; val_kl_reg_loss: 44262.8216; val_edge_recon_loss: 575675.2542; val_gene_expr_recon_loss: 16985443.2000; val_masked_gp_l1_reg_loss: 83452.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88047.8984; val_chrom_access_recon_loss: 3749385.6333; val_global_loss: 21526266.5333; val_optim_loss: 21526266.5333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9633; val_auprc_score: 0.9514; val_best_acc_score: 0.9142; val_best_f1_score: 0.9173; train_kl_reg_loss: 47703.8392; train_edge_recon_loss: 570450.1551; train_gene_expr_recon_loss: 17189079.5954; train_masked_gp_l1_reg_loss: 83250.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88387.9981; train_chrom_access_recon_loss: 3824801.1317; train_global_loss: 21803673.4504; train_optim_loss: 21803673.4504; val_kl_reg_loss: 44011.2516; val_edge_recon_loss: 571370.2833; val_gene_expr_recon_loss: 17043395.8000; val_masked_gp_l1_reg_loss: 83018.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88159.9297; val_chrom_access_recon_loss: 3767705.6333; val_global_loss: 21597660.8000; val_optim_loss: 21597660.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9667; val_auprc_score: 0.9567; val_best_acc_score: 0.9157; val_best_f1_score: 0.9181; train_kl_reg_loss: 47681.4774; train_edge_recon_loss: 569408.4141; train_gene_expr_recon_loss: 17162430.2748; train_masked_gp_l1_reg_loss: 82866.3560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88584.3591; train_chrom_access_recon_loss: 3817731.4275; train_global_loss: 21768702.3664; train_optim_loss: 21768702.3664; val_kl_reg_loss: 44677.4229; val_edge_recon_loss: 572517.9083; val_gene_expr_recon_loss: 17001843.8667; val_masked_gp_l1_reg_loss: 82647.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88577.2578; val_chrom_access_recon_loss: 3761272.6167; val_global_loss: 21551537.6000; val_optim_loss: 21551537.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9668; val_auprc_score: 0.9585; val_best_acc_score: 0.9194; val_best_f1_score: 0.9224; train_kl_reg_loss: 47792.4082; train_edge_recon_loss: 568817.5997; train_gene_expr_recon_loss: 17144265.0076; train_masked_gp_l1_reg_loss: 82651.8342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88600.9588; train_chrom_access_recon_loss: 3814178.9427; train_global_loss: 21746306.6260; train_optim_loss: 21746306.6260; val_kl_reg_loss: 43261.8685; val_edge_recon_loss: 571301.3042; val_gene_expr_recon_loss: 16905005.0000; val_masked_gp_l1_reg_loss: 82751.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88884.9766; val_chrom_access_recon_loss: 3729664.8000; val_global_loss: 21420868.8000; val_optim_loss: 21420868.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9664; val_auprc_score: 0.9561; val_best_acc_score: 0.9165; val_best_f1_score: 0.9195; train_kl_reg_loss: 48218.5663; train_edge_recon_loss: 570145.1536; train_gene_expr_recon_loss: 17100747.8931; train_masked_gp_l1_reg_loss: 82689.4764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89069.2356; train_chrom_access_recon_loss: 3806242.0496; train_global_loss: 21697112.4122; train_optim_loss: 21697112.4122; val_kl_reg_loss: 43696.8143; val_edge_recon_loss: 571967.7417; val_gene_expr_recon_loss: 16884334.4000; val_masked_gp_l1_reg_loss: 82625.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88887.9062; val_chrom_access_recon_loss: 3749067.9667; val_global_loss: 21420580.9333; val_optim_loss: 21420580.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9673; val_auprc_score: 0.9583; val_best_acc_score: 0.9142; val_best_f1_score: 0.9185; train_kl_reg_loss: 47969.3979; train_edge_recon_loss: 570187.3158; train_gene_expr_recon_loss: 17069871.2595; train_masked_gp_l1_reg_loss: 82630.5484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89288.5087; train_chrom_access_recon_loss: 3799130.3244; train_global_loss: 21659077.3588; train_optim_loss: 21659077.3588; val_kl_reg_loss: 43959.9651; val_edge_recon_loss: 568439.2500; val_gene_expr_recon_loss: 16952238.6667; val_masked_gp_l1_reg_loss: 82595.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89246.8828; val_chrom_access_recon_loss: 3756339.0667; val_global_loss: 21492819.2000; val_optim_loss: 21492819.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9568; val_auprc_score: 0.9428; val_best_acc_score: 0.8983; val_best_f1_score: 0.9027; train_kl_reg_loss: 46391.4367; train_edge_recon_loss: 584153.1670; train_gene_expr_recon_loss: 17217972.1908; train_masked_gp_l1_reg_loss: 81687.0595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89918.2837; train_chrom_access_recon_loss: 3809566.2939; train_global_loss: 21829688.4580; train_optim_loss: 21829688.4580; val_kl_reg_loss: 41010.4622; val_edge_recon_loss: 593157.8083; val_gene_expr_recon_loss: 17174260.7333; val_masked_gp_l1_reg_loss: 78538.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88626.9844; val_chrom_access_recon_loss: 3773926.6500; val_global_loss: 21749519.4667; val_optim_loss: 21749519.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9653; val_auprc_score: 0.9549; val_best_acc_score: 0.9138; val_best_f1_score: 0.9167; train_kl_reg_loss: 49612.1933; train_edge_recon_loss: 575305.2705; train_gene_expr_recon_loss: 17222162.6260; train_masked_gp_l1_reg_loss: 77649.2065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87178.9163; train_chrom_access_recon_loss: 3805233.2557; train_global_loss: 21817141.3893; train_optim_loss: 21817141.3893; val_kl_reg_loss: 46802.0763; val_edge_recon_loss: 573790.4667; val_gene_expr_recon_loss: 16928631.6667; val_masked_gp_l1_reg_loss: 77186.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87220.3828; val_chrom_access_recon_loss: 3737095.1667; val_global_loss: 21450725.4667; val_optim_loss: 21450725.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9461; val_auprc_score: 0.9357; val_best_acc_score: 0.8782; val_best_f1_score: 0.8845; train_kl_reg_loss: 1216380166.9161; train_edge_recon_loss: 651894.0635; train_gene_expr_recon_loss: 17512348.4656; train_masked_gp_l1_reg_loss: 75713.5298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90375.9735; train_chrom_access_recon_loss: 3840911.8798; train_global_loss: 1238551518.3206; train_optim_loss: 1238551518.3206; val_kl_reg_loss: 42496.3138; val_edge_recon_loss: 676060.7750; val_gene_expr_recon_loss: 17192781.3333; val_masked_gp_l1_reg_loss: 69355.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91582.4922; val_chrom_access_recon_loss: 3772509.9167; val_global_loss: 21844786.2667; val_optim_loss: 21844786.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9458; val_auprc_score: 0.9332; val_best_acc_score: 0.8822; val_best_f1_score: 0.8883; train_kl_reg_loss: 43496.7881; train_edge_recon_loss: 658531.7548; train_gene_expr_recon_loss: 17425938.7099; train_masked_gp_l1_reg_loss: 68268.1078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73148.2468; train_chrom_access_recon_loss: 3835898.1164; train_global_loss: 22105281.6794; train_optim_loss: 22105281.6794; val_kl_reg_loss: 38225.7820; val_edge_recon_loss: 654867.9500; val_gene_expr_recon_loss: 17186178.2000; val_masked_gp_l1_reg_loss: 67799.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70264.7109; val_chrom_access_recon_loss: 3784282.2167; val_global_loss: 21801618.1333; val_optim_loss: 21801618.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9494; val_auprc_score: 0.9384; val_best_acc_score: 0.8839; val_best_f1_score: 0.8908; train_kl_reg_loss: 41845.8712; train_edge_recon_loss: 644889.2786; train_gene_expr_recon_loss: 17321682.9618; train_masked_gp_l1_reg_loss: 67590.2642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69363.6138; train_chrom_access_recon_loss: 3829463.8779; train_global_loss: 21974835.9847; train_optim_loss: 21974835.9847; val_kl_reg_loss: 37396.2516; val_edge_recon_loss: 637150.5417; val_gene_expr_recon_loss: 17115536.0000; val_masked_gp_l1_reg_loss: 67428.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68579.8672; val_chrom_access_recon_loss: 3758563.0667; val_global_loss: 21684653.6000; val_optim_loss: 21684653.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9446; val_auprc_score: 0.9281; val_best_acc_score: 0.8809; val_best_f1_score: 0.8874; train_kl_reg_loss: 41911.5589; train_edge_recon_loss: 631902.8616; train_gene_expr_recon_loss: 17311469.2214; train_masked_gp_l1_reg_loss: 67342.0834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68050.3801; train_chrom_access_recon_loss: 3828610.3263; train_global_loss: 21949286.2443; train_optim_loss: 21949286.2443; val_kl_reg_loss: 38161.2307; val_edge_recon_loss: 631934.5833; val_gene_expr_recon_loss: 17149984.2667; val_masked_gp_l1_reg_loss: 67268.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67597.7500; val_chrom_access_recon_loss: 3763424.9833; val_global_loss: 21718371.2000; val_optim_loss: 21718371.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9433; val_auprc_score: 0.9245; val_best_acc_score: 0.8760; val_best_f1_score: 0.8833; train_kl_reg_loss: 42534.5474; train_edge_recon_loss: 624907.1083; train_gene_expr_recon_loss: 17292281.9542; train_masked_gp_l1_reg_loss: 67238.7016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67308.4263; train_chrom_access_recon_loss: 3819691.4943; train_global_loss: 21913962.1985; train_optim_loss: 21913962.1985; val_kl_reg_loss: 37083.9701; val_edge_recon_loss: 625234.2125; val_gene_expr_recon_loss: 16918759.2000; val_masked_gp_l1_reg_loss: 67229.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66972.1719; val_chrom_access_recon_loss: 3721752.2833; val_global_loss: 21437032.1333; val_optim_loss: 21437032.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 58 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9660
val AUPRC score: 0.9568
val best accuracy score: 0.9124
val best F1 score: 0.9159
val target rna MSE score: 1.2633
val source rna MSE score: 0.5468
val target atac MSE score: 0.4845
val source atac MSE score: 0.1480
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
