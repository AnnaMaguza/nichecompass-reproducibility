[True]
Run timestamp: 07082023_220855_153.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_153']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8771; val_auprc_score: 0.8901; val_best_acc_score: 0.5503; val_best_f1_score: 0.6887; train_kl_reg_loss: 34751.5608; train_edge_recon_loss: 3474498.9722; train_gene_expr_recon_loss: 1176707.7778; train_masked_gp_l1_reg_loss: 16269.9372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166696.2413; train_chrom_access_recon_loss: 649268.0590; train_global_loss: 5518192.5000; train_optim_loss: 5518192.5000; val_kl_reg_loss: 13839.2725; val_edge_recon_loss: 4061897.7500; val_gene_expr_recon_loss: 965353.7500; val_masked_gp_l1_reg_loss: 11724.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162139.1406; val_chrom_access_recon_loss: 502625.9375; val_global_loss: 5717581.0000; val_optim_loss: 5717581.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8739; val_auprc_score: 0.8884; val_best_acc_score: 0.5637; val_best_f1_score: 0.6944; train_kl_reg_loss: 13773.7662; train_edge_recon_loss: 3477879.0556; train_gene_expr_recon_loss: 916862.5625; train_masked_gp_l1_reg_loss: 9813.8891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159245.6719; train_chrom_access_recon_loss: 488985.3056; train_global_loss: 5066560.2222; train_optim_loss: 5066560.2222; val_kl_reg_loss: 11184.9463; val_edge_recon_loss: 4060985.5000; val_gene_expr_recon_loss: 840799.0000; val_masked_gp_l1_reg_loss: 8261.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155540.7188; val_chrom_access_recon_loss: 470254.2500; val_global_loss: 5547026.0000; val_optim_loss: 5547026.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8663; val_auprc_score: 0.8763; val_best_acc_score: 0.5927; val_best_f1_score: 0.7077; train_kl_reg_loss: 13379.0242; train_edge_recon_loss: 3477946.9167; train_gene_expr_recon_loss: 840231.5208; train_masked_gp_l1_reg_loss: 8138.7246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152241.4097; train_chrom_access_recon_loss: 464055.7326; train_global_loss: 4955993.3889; train_optim_loss: 4955993.3889; val_kl_reg_loss: 14275.1738; val_edge_recon_loss: 4058045.5000; val_gene_expr_recon_loss: 797473.8750; val_masked_gp_l1_reg_loss: 8034.9912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147865.9062; val_chrom_access_recon_loss: 460159.6562; val_global_loss: 5485855.0000; val_optim_loss: 5485855.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8525; val_auprc_score: 0.8617; val_best_acc_score: 0.6439; val_best_f1_score: 0.7301; train_kl_reg_loss: 15638.7660; train_edge_recon_loss: 3477642.0278; train_gene_expr_recon_loss: 800707.4306; train_masked_gp_l1_reg_loss: 7844.7320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143977.0365; train_chrom_access_recon_loss: 459368.2014; train_global_loss: 4905178.1667; train_optim_loss: 4905178.1667; val_kl_reg_loss: 14079.0078; val_edge_recon_loss: 4051188.2500; val_gene_expr_recon_loss: 769339.6250; val_masked_gp_l1_reg_loss: 7685.2314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138902.8281; val_chrom_access_recon_loss: 455462.6875; val_global_loss: 5436657.5000; val_optim_loss: 5436657.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8433; val_auprc_score: 0.8497; val_best_acc_score: 0.7110; val_best_f1_score: 0.7596; train_kl_reg_loss: 15711.8923; train_edge_recon_loss: 3476921.8611; train_gene_expr_recon_loss: 779761.7917; train_masked_gp_l1_reg_loss: 7652.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134620.2917; train_chrom_access_recon_loss: 455097.3924; train_global_loss: 4869765.7778; train_optim_loss: 4869765.7778; val_kl_reg_loss: 13556.7490; val_edge_recon_loss: 4030408.7500; val_gene_expr_recon_loss: 750417.2500; val_masked_gp_l1_reg_loss: 7620.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129198.6875; val_chrom_access_recon_loss: 452517.2812; val_global_loss: 5383719.5000; val_optim_loss: 5383719.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8369; val_auprc_score: 0.8355; val_best_acc_score: 0.7551; val_best_f1_score: 0.7539; train_kl_reg_loss: 15149.7318; train_edge_recon_loss: 3472357.7778; train_gene_expr_recon_loss: 761301.7569; train_masked_gp_l1_reg_loss: 7646.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124842.8924; train_chrom_access_recon_loss: 455939.0243; train_global_loss: 4837237.7778; train_optim_loss: 4837237.7778; val_kl_reg_loss: 12777.5312; val_edge_recon_loss: 3969153.5000; val_gene_expr_recon_loss: 735123.7500; val_masked_gp_l1_reg_loss: 7676.6792; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119423.9844; val_chrom_access_recon_loss: 450411.5625; val_global_loss: 5294567.0000; val_optim_loss: 5294567.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8220; val_auprc_score: 0.8103; val_best_acc_score: 0.7398; val_best_f1_score: 0.7643; train_kl_reg_loss: 12056.5411; train_edge_recon_loss: 3443552.7500; train_gene_expr_recon_loss: 749758.9722; train_masked_gp_l1_reg_loss: 7723.9430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115164.3585; train_chrom_access_recon_loss: 451372.8056; train_global_loss: 4779629.2778; train_optim_loss: 4779629.2778; val_kl_reg_loss: 7914.1987; val_edge_recon_loss: 3664525.7500; val_gene_expr_recon_loss: 737014.6250; val_masked_gp_l1_reg_loss: 7774.3481; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109913.0078; val_chrom_access_recon_loss: 450366.5938; val_global_loss: 4977508.5000; val_optim_loss: 4977508.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8398; val_auprc_score: 0.8313; val_best_acc_score: 0.7561; val_best_f1_score: 0.7795; train_kl_reg_loss: 8031.6754; train_edge_recon_loss: 3234335.1111; train_gene_expr_recon_loss: 773039.6319; train_masked_gp_l1_reg_loss: 7828.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105922.7422; train_chrom_access_recon_loss: 453233.6736; train_global_loss: 4582391.0000; train_optim_loss: 4582391.0000; val_kl_reg_loss: 14481.2490; val_edge_recon_loss: 3046171.7500; val_gene_expr_recon_loss: 776377.3750; val_masked_gp_l1_reg_loss: 7887.5073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101116.1094; val_chrom_access_recon_loss: 454049.8125; val_global_loss: 4400084.0000; val_optim_loss: 4400084.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8764; val_auprc_score: 0.8656; val_best_acc_score: 0.7815; val_best_f1_score: 0.8002; train_kl_reg_loss: 28866.1037; train_edge_recon_loss: 2930574.6389; train_gene_expr_recon_loss: 783108.8403; train_masked_gp_l1_reg_loss: 7931.6395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97526.0625; train_chrom_access_recon_loss: 454544.4167; train_global_loss: 4302551.6111; train_optim_loss: 4302551.6111; val_kl_reg_loss: 45850.7109; val_edge_recon_loss: 2866009.5000; val_gene_expr_recon_loss: 747843.5625; val_masked_gp_l1_reg_loss: 7979.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93150.5469; val_chrom_access_recon_loss: 450181.8438; val_global_loss: 4211016.0000; val_optim_loss: 4211016.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8875; val_auprc_score: 0.8699; val_best_acc_score: 0.8021; val_best_f1_score: 0.8176; train_kl_reg_loss: 55515.7231; train_edge_recon_loss: 2860432.4722; train_gene_expr_recon_loss: 751182.5903; train_masked_gp_l1_reg_loss: 8025.8009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89786.5894; train_chrom_access_recon_loss: 450250.2118; train_global_loss: 4215193.4444; train_optim_loss: 4215193.4444; val_kl_reg_loss: 55094.6250; val_edge_recon_loss: 2844499.7500; val_gene_expr_recon_loss: 733720.6250; val_masked_gp_l1_reg_loss: 8074.2114; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85652.0703; val_chrom_access_recon_loss: 448152.9375; val_global_loss: 4175194.2500; val_optim_loss: 4175194.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9044; val_auprc_score: 0.8777; val_best_acc_score: 0.8356; val_best_f1_score: 0.8467; train_kl_reg_loss: 49452.9831; train_edge_recon_loss: 2825228.9722; train_gene_expr_recon_loss: 756276.7778; train_masked_gp_l1_reg_loss: 8101.4291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82491.7188; train_chrom_access_recon_loss: 452659.6215; train_global_loss: 4174211.5556; train_optim_loss: 4174211.5556; val_kl_reg_loss: 35159.9609; val_edge_recon_loss: 2773454.7500; val_gene_expr_recon_loss: 736886.1250; val_masked_gp_l1_reg_loss: 8143.0542; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78667.8828; val_chrom_access_recon_loss: 447860.1562; val_global_loss: 4080172.2500; val_optim_loss: 4080172.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9200; val_auprc_score: 0.8947; val_best_acc_score: 0.8585; val_best_f1_score: 0.8681; train_kl_reg_loss: 33223.9857; train_edge_recon_loss: 2775154.5556; train_gene_expr_recon_loss: 745622.6806; train_masked_gp_l1_reg_loss: 8132.9009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75869.0634; train_chrom_access_recon_loss: 447384.3715; train_global_loss: 4085387.6111; train_optim_loss: 4085387.6111; val_kl_reg_loss: 33657.6641; val_edge_recon_loss: 2760826.2500; val_gene_expr_recon_loss: 733578.3125; val_masked_gp_l1_reg_loss: 8100.9282; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72507.4219; val_chrom_access_recon_loss: 446637.7500; val_global_loss: 4055308.5000; val_optim_loss: 4055308.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9235; val_auprc_score: 0.8962; val_best_acc_score: 0.8689; val_best_f1_score: 0.8770; train_kl_reg_loss: 37255.7652; train_edge_recon_loss: 2756180.8611; train_gene_expr_recon_loss: 741028.8056; train_masked_gp_l1_reg_loss: 8075.6188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70022.2543; train_chrom_access_recon_loss: 446287.4792; train_global_loss: 4058850.6944; train_optim_loss: 4058850.6944; val_kl_reg_loss: 40636.1992; val_edge_recon_loss: 2742900.5000; val_gene_expr_recon_loss: 726777.3750; val_masked_gp_l1_reg_loss: 8047.6631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67038.4844; val_chrom_access_recon_loss: 445104.2500; val_global_loss: 4030504.5000; val_optim_loss: 4030504.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9316; val_auprc_score: 0.9057; val_best_acc_score: 0.8743; val_best_f1_score: 0.8819; train_kl_reg_loss: 43599.1007; train_edge_recon_loss: 2729014.8056; train_gene_expr_recon_loss: 742756.1528; train_masked_gp_l1_reg_loss: 8011.9701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64831.7504; train_chrom_access_recon_loss: 446857.3125; train_global_loss: 4035071.1111; train_optim_loss: 4035071.1111; val_kl_reg_loss: 42653.0859; val_edge_recon_loss: 2760522.2500; val_gene_expr_recon_loss: 717860.3750; val_masked_gp_l1_reg_loss: 8004.0601; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62164.8750; val_chrom_access_recon_loss: 443644.0938; val_global_loss: 4034848.5000; val_optim_loss: 4034848.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9354; val_auprc_score: 0.9142; val_best_acc_score: 0.8778; val_best_f1_score: 0.8853; train_kl_reg_loss: 42489.1736; train_edge_recon_loss: 2726181.2500; train_gene_expr_recon_loss: 729076.7986; train_masked_gp_l1_reg_loss: 8009.9078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60184.9835; train_chrom_access_recon_loss: 445419.5590; train_global_loss: 4011361.7500; train_optim_loss: 4011361.7500; val_kl_reg_loss: 40322.3203; val_edge_recon_loss: 2735158.5000; val_gene_expr_recon_loss: 714650.7500; val_masked_gp_l1_reg_loss: 7998.1611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57774.9414; val_chrom_access_recon_loss: 442632.6562; val_global_loss: 3998537.5000; val_optim_loss: 3998537.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9399; val_auprc_score: 0.9189; val_best_acc_score: 0.8857; val_best_f1_score: 0.8928; train_kl_reg_loss: 40582.5091; train_edge_recon_loss: 2713102.2222; train_gene_expr_recon_loss: 725779.8750; train_masked_gp_l1_reg_loss: 8011.3948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55983.0234; train_chrom_access_recon_loss: 442766.3403; train_global_loss: 3986225.3889; train_optim_loss: 3986225.3889; val_kl_reg_loss: 38853.1680; val_edge_recon_loss: 2739551.0000; val_gene_expr_recon_loss: 710840.7500; val_masked_gp_l1_reg_loss: 8017.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53800.6836; val_chrom_access_recon_loss: 441687.6562; val_global_loss: 3992751.2500; val_optim_loss: 3992751.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9454; val_auprc_score: 0.9252; val_best_acc_score: 0.8959; val_best_f1_score: 0.9017; train_kl_reg_loss: 39609.7882; train_edge_recon_loss: 2708583.7778; train_gene_expr_recon_loss: 723434.9583; train_masked_gp_l1_reg_loss: 8032.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52189.1554; train_chrom_access_recon_loss: 442040.9201; train_global_loss: 3973891.2778; train_optim_loss: 3973891.2778; val_kl_reg_loss: 38158.2891; val_edge_recon_loss: 2721722.7500; val_gene_expr_recon_loss: 704455.0000; val_masked_gp_l1_reg_loss: 8052.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50229.7461; val_chrom_access_recon_loss: 440659.7188; val_global_loss: 3963278.2500; val_optim_loss: 3963278.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9459; val_auprc_score: 0.9258; val_best_acc_score: 0.8946; val_best_f1_score: 0.9009; train_kl_reg_loss: 37519.1997; train_edge_recon_loss: 2722503.5278; train_gene_expr_recon_loss: 716233.7847; train_masked_gp_l1_reg_loss: 8069.5681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48772.0395; train_chrom_access_recon_loss: 440988.0069; train_global_loss: 3974086.1944; train_optim_loss: 3974086.1944; val_kl_reg_loss: 35725.7852; val_edge_recon_loss: 2721492.7500; val_gene_expr_recon_loss: 701670.3750; val_masked_gp_l1_reg_loss: 8080.8745; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47007.7969; val_chrom_access_recon_loss: 440090.7188; val_global_loss: 3954068.2500; val_optim_loss: 3954068.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9501; val_auprc_score: 0.9312; val_best_acc_score: 0.9029; val_best_f1_score: 0.9078; train_kl_reg_loss: 37038.2418; train_edge_recon_loss: 2721362.5556; train_gene_expr_recon_loss: 717449.8819; train_masked_gp_l1_reg_loss: 8109.0196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45686.7227; train_chrom_access_recon_loss: 441915.2778; train_global_loss: 3971561.6944; train_optim_loss: 3971561.6944; val_kl_reg_loss: 37256.6406; val_edge_recon_loss: 2712525.2500; val_gene_expr_recon_loss: 697893.5625; val_masked_gp_l1_reg_loss: 8142.7173; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44089.1484; val_chrom_access_recon_loss: 439482.4375; val_global_loss: 3939390.0000; val_optim_loss: 3939390.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9470; val_auprc_score: 0.9283; val_best_acc_score: 0.8967; val_best_f1_score: 0.9030; train_kl_reg_loss: 37847.2235; train_edge_recon_loss: 2725433.3611; train_gene_expr_recon_loss: 713551.8889; train_masked_gp_l1_reg_loss: 8177.6377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42901.2075; train_chrom_access_recon_loss: 440048.4306; train_global_loss: 3967959.8056; train_optim_loss: 3967959.8056; val_kl_reg_loss: 37826.1250; val_edge_recon_loss: 2727864.0000; val_gene_expr_recon_loss: 697745.7500; val_masked_gp_l1_reg_loss: 8223.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41457.2188; val_chrom_access_recon_loss: 438320.7500; val_global_loss: 3951437.5000; val_optim_loss: 3951437.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9534; val_auprc_score: 0.9357; val_best_acc_score: 0.9031; val_best_f1_score: 0.9083; train_kl_reg_loss: 39709.4683; train_edge_recon_loss: 2715178.7500; train_gene_expr_recon_loss: 709050.9375; train_masked_gp_l1_reg_loss: 8250.5365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40374.4284; train_chrom_access_recon_loss: 440102.8194; train_global_loss: 3952666.9444; train_optim_loss: 3952666.9444; val_kl_reg_loss: 37774.4062; val_edge_recon_loss: 2727608.5000; val_gene_expr_recon_loss: 692969.9375; val_masked_gp_l1_reg_loss: 8281.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39044.6328; val_chrom_access_recon_loss: 437837.7812; val_global_loss: 3943517.5000; val_optim_loss: 3943517.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9566; val_auprc_score: 0.9433; val_best_acc_score: 0.9031; val_best_f1_score: 0.9071; train_kl_reg_loss: 37672.4392; train_edge_recon_loss: 2706609.6111; train_gene_expr_recon_loss: 709369.1806; train_masked_gp_l1_reg_loss: 8315.6679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38057.9779; train_chrom_access_recon_loss: 438265.8750; train_global_loss: 3938290.7222; train_optim_loss: 3938290.7222; val_kl_reg_loss: 36326.4375; val_edge_recon_loss: 2710005.7500; val_gene_expr_recon_loss: 692991.1250; val_masked_gp_l1_reg_loss: 8350.4072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36855.8398; val_chrom_access_recon_loss: 436916.7500; val_global_loss: 3921446.5000; val_optim_loss: 3921446.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9606; val_auprc_score: 0.9475; val_best_acc_score: 0.9084; val_best_f1_score: 0.9127; train_kl_reg_loss: 36867.7752; train_edge_recon_loss: 2703639.3333; train_gene_expr_recon_loss: 704301.5417; train_masked_gp_l1_reg_loss: 8380.7578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35962.6263; train_chrom_access_recon_loss: 436830.2118; train_global_loss: 3925982.1389; train_optim_loss: 3925982.1389; val_kl_reg_loss: 36259.1953; val_edge_recon_loss: 2708480.0000; val_gene_expr_recon_loss: 688715.8750; val_masked_gp_l1_reg_loss: 8414.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34869.6016; val_chrom_access_recon_loss: 436398.3438; val_global_loss: 3913137.5000; val_optim_loss: 3913137.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9579; val_auprc_score: 0.9428; val_best_acc_score: 0.9056; val_best_f1_score: 0.9101; train_kl_reg_loss: 36569.7904; train_edge_recon_loss: 2704401.5556; train_gene_expr_recon_loss: 705561.0833; train_masked_gp_l1_reg_loss: 8452.1761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34049.8780; train_chrom_access_recon_loss: 436439.4062; train_global_loss: 3925473.8889; train_optim_loss: 3925473.8889; val_kl_reg_loss: 35113.2422; val_edge_recon_loss: 2710439.2500; val_gene_expr_recon_loss: 689710.3750; val_masked_gp_l1_reg_loss: 8492.8623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33055.7852; val_chrom_access_recon_loss: 435973.1875; val_global_loss: 3912784.7500; val_optim_loss: 3912784.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9646; val_auprc_score: 0.9491; val_best_acc_score: 0.9159; val_best_f1_score: 0.9195; train_kl_reg_loss: 35862.4831; train_edge_recon_loss: 2700377.6111; train_gene_expr_recon_loss: 699504.8056; train_masked_gp_l1_reg_loss: 8523.2489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32320.3012; train_chrom_access_recon_loss: 438413.4931; train_global_loss: 3915002.0278; train_optim_loss: 3915002.0278; val_kl_reg_loss: 34163.6523; val_edge_recon_loss: 2692075.0000; val_gene_expr_recon_loss: 688759.2500; val_masked_gp_l1_reg_loss: 8563.2959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31416.9824; val_chrom_access_recon_loss: 435633.8750; val_global_loss: 3890612.0000; val_optim_loss: 3890612.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9684; val_auprc_score: 0.9574; val_best_acc_score: 0.9200; val_best_f1_score: 0.9235; train_kl_reg_loss: 30384.9729; train_edge_recon_loss: 2685773.2778; train_gene_expr_recon_loss: 1012270.5972; train_masked_gp_l1_reg_loss: 8585.8223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30466.9737; train_chrom_access_recon_loss: 464034.0972; train_global_loss: 4231515.7222; train_optim_loss: 4231515.7222; val_kl_reg_loss: 12127.3232; val_edge_recon_loss: 2679790.7500; val_gene_expr_recon_loss: 979824.6250; val_masked_gp_l1_reg_loss: 8595.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29141.8477; val_chrom_access_recon_loss: 461142.0000; val_global_loss: 4170622.0000; val_optim_loss: 4170622.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9700; val_auprc_score: 0.9612; val_best_acc_score: 0.9209; val_best_f1_score: 0.9228; train_kl_reg_loss: 27196.7826; train_edge_recon_loss: 2671507.8056; train_gene_expr_recon_loss: 1001252.5347; train_masked_gp_l1_reg_loss: 8630.5543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28000.9722; train_chrom_access_recon_loss: 461311.0833; train_global_loss: 4197899.7222; train_optim_loss: 4197899.7222; val_kl_reg_loss: 12279.0527; val_edge_recon_loss: 2662508.0000; val_gene_expr_recon_loss: 983421.0000; val_masked_gp_l1_reg_loss: 8672.2100; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26585.0078; val_chrom_access_recon_loss: 461352.1875; val_global_loss: 4154817.5000; val_optim_loss: 4154817.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9711; val_auprc_score: 0.9610; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 24417.4091; train_edge_recon_loss: 2655713.2222; train_gene_expr_recon_loss: 1003640.5833; train_masked_gp_l1_reg_loss: 8705.2697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25507.0460; train_chrom_access_recon_loss: 462884.5799; train_global_loss: 4180868.1389; train_optim_loss: 4180868.1389; val_kl_reg_loss: 11757.2383; val_edge_recon_loss: 2659826.7500; val_gene_expr_recon_loss: 980498.2500; val_masked_gp_l1_reg_loss: 8749.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24205.5664; val_chrom_access_recon_loss: 461118.6562; val_global_loss: 4146155.7500; val_optim_loss: 4146155.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9716; val_auprc_score: 0.9579; val_best_acc_score: 0.9250; val_best_f1_score: 0.9280; train_kl_reg_loss: 22925.6315; train_edge_recon_loss: 2655471.9722; train_gene_expr_recon_loss: 994285.6458; train_masked_gp_l1_reg_loss: 8790.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23251.0979; train_chrom_access_recon_loss: 461455.0382; train_global_loss: 4166179.6667; train_optim_loss: 4166179.6667; val_kl_reg_loss: 13003.4863; val_edge_recon_loss: 2659011.5000; val_gene_expr_recon_loss: 973012.7500; val_masked_gp_l1_reg_loss: 8839.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22108.1875; val_chrom_access_recon_loss: 460008.1562; val_global_loss: 4135983.5000; val_optim_loss: 4135983.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9678; val_auprc_score: 0.9557; val_best_acc_score: 0.9185; val_best_f1_score: 0.9212; train_kl_reg_loss: 24106.4672; train_edge_recon_loss: 2653974.6389; train_gene_expr_recon_loss: 994377.6250; train_masked_gp_l1_reg_loss: 8772.1394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21924.8576; train_chrom_access_recon_loss: 461213.4826; train_global_loss: 4164369.1944; train_optim_loss: 4164369.1944; val_kl_reg_loss: 13107.0332; val_edge_recon_loss: 2679351.2500; val_gene_expr_recon_loss: 973037.8125; val_masked_gp_l1_reg_loss: 8715.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21722.1719; val_chrom_access_recon_loss: 460080.7188; val_global_loss: 4156014.7500; val_optim_loss: 4156014.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9746; val_auprc_score: 0.9648; val_best_acc_score: 0.9271; val_best_f1_score: 0.9296; train_kl_reg_loss: 24022.6931; train_edge_recon_loss: 2649856.6667; train_gene_expr_recon_loss: 992653.9931; train_masked_gp_l1_reg_loss: 8706.3342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21599.7589; train_chrom_access_recon_loss: 461272.7326; train_global_loss: 4158112.2222; train_optim_loss: 4158112.2222; val_kl_reg_loss: 13062.5195; val_edge_recon_loss: 2654677.7500; val_gene_expr_recon_loss: 973248.3750; val_masked_gp_l1_reg_loss: 8688.1357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21442.1777; val_chrom_access_recon_loss: 460068.3750; val_global_loss: 4131187.5000; val_optim_loss: 4131187.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9706; val_auprc_score: 0.9584; val_best_acc_score: 0.9258; val_best_f1_score: 0.9283; train_kl_reg_loss: 23585.5855; train_edge_recon_loss: 2650875.5278; train_gene_expr_recon_loss: 991661.5069; train_masked_gp_l1_reg_loss: 8681.1389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21329.4659; train_chrom_access_recon_loss: 459887.2083; train_global_loss: 4156020.4444; train_optim_loss: 4156020.4444; val_kl_reg_loss: 12983.5254; val_edge_recon_loss: 2656469.7500; val_gene_expr_recon_loss: 972295.0000; val_masked_gp_l1_reg_loss: 8674.3965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21192.1211; val_chrom_access_recon_loss: 459937.5938; val_global_loss: 4131552.2500; val_optim_loss: 4131552.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9700; val_auprc_score: 0.9572; val_best_acc_score: 0.9231; val_best_f1_score: 0.9255; train_kl_reg_loss: 23341.2559; train_edge_recon_loss: 2651184.3889; train_gene_expr_recon_loss: 991484.2292; train_masked_gp_l1_reg_loss: 8672.2750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21088.6780; train_chrom_access_recon_loss: 461829.5729; train_global_loss: 4157600.3611; train_optim_loss: 4157600.3611; val_kl_reg_loss: 12904.8828; val_edge_recon_loss: 2665014.0000; val_gene_expr_recon_loss: 972555.0000; val_masked_gp_l1_reg_loss: 8671.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20965.6523; val_chrom_access_recon_loss: 459958.7500; val_global_loss: 4140069.5000; val_optim_loss: 4140069.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9666
val AUPRC score: 0.9544
val best accuracy score: 0.9142
val best F1 score: 0.9178
val target rna MSE score: 3.6795
val source rna MSE score: 3.1704
val target atac MSE score: 0.1333
val source atac MSE score: 0.0215
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
