[True]
Run timestamp: 29072023_133553_155.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_155']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8655; val_auprc_score: 0.8901; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3768.8804; train_edge_recon_loss: 34713721.3333; train_gene_expr_recon_loss: 73475851.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 18796023.5556; train_global_loss: 126989365.3333; train_optim_loss: 126989365.3333; val_kl_reg_loss: 7659.0635; val_edge_recon_loss: 40653436.0000; val_gene_expr_recon_loss: 65769536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17273732.0000; val_global_loss: 123704368.0000; val_optim_loss: 123704368.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8861; val_auprc_score: 0.9037; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 27641.6271; train_edge_recon_loss: 34806210.6667; train_gene_expr_recon_loss: 62696098.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17946983.5556; train_global_loss: 115476934.2222; train_optim_loss: 115476934.2222; val_kl_reg_loss: 53732.2539; val_edge_recon_loss: 40659872.0000; val_gene_expr_recon_loss: 60306560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17867108.0000; val_global_loss: 118887264.0000; val_optim_loss: 118887264.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8798; val_auprc_score: 0.8958; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 86987.3872; train_edge_recon_loss: 34809096.8889; train_gene_expr_recon_loss: 58991876.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17759610.4444; train_global_loss: 111647571.5556; train_optim_loss: 111647571.5556; val_kl_reg_loss: 97765.9844; val_edge_recon_loss: 40659304.0000; val_gene_expr_recon_loss: 57704024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17183866.0000; val_global_loss: 115644952.0000; val_optim_loss: 115644952.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8863; val_auprc_score: 0.8989; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 200902.6424; train_edge_recon_loss: 34780507.5556; train_gene_expr_recon_loss: 56562315.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17410179.3333; train_global_loss: 108953904.8889; train_optim_loss: 108953904.8889; val_kl_reg_loss: 129347.7500; val_edge_recon_loss: 40659180.0000; val_gene_expr_recon_loss: 54480680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16985710.0000; val_global_loss: 112254920.0000; val_optim_loss: 112254920.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8824; val_auprc_score: 0.8925; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 238223.6597; train_edge_recon_loss: 34797478.6667; train_gene_expr_recon_loss: 52965256.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17218646.6667; train_global_loss: 105219606.2222; train_optim_loss: 105219606.2222; val_kl_reg_loss: 215771.3594; val_edge_recon_loss: 40658464.0000; val_gene_expr_recon_loss: 51541324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16884324.0000; val_global_loss: 109299888.0000; val_optim_loss: 109299888.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8833; val_auprc_score: 0.8951; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 284647.7170; train_edge_recon_loss: 34816447.5556; train_gene_expr_recon_loss: 50460042.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17006643.1111; train_global_loss: 102567778.6667; train_optim_loss: 102567778.6667; val_kl_reg_loss: 317554.7500; val_edge_recon_loss: 40658496.0000; val_gene_expr_recon_loss: 49026808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16593627.0000; val_global_loss: 106596488.0000; val_optim_loss: 106596488.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8799; val_auprc_score: 0.8931; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 320354.2951; train_edge_recon_loss: 34817514.2222; train_gene_expr_recon_loss: 47949997.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16681586.4444; train_global_loss: 99769451.5556; train_optim_loss: 99769451.5556; val_kl_reg_loss: 259407.1250; val_edge_recon_loss: 40658228.0000; val_gene_expr_recon_loss: 46848184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16372775.0000; val_global_loss: 104138600.0000; val_optim_loss: 104138600.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8605; val_auprc_score: 0.8720; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 341577.9931; train_edge_recon_loss: 34841840.4444; train_gene_expr_recon_loss: 45708527.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16467080.8889; train_global_loss: 97359025.7778; train_optim_loss: 97359025.7778; val_kl_reg_loss: 256173.2188; val_edge_recon_loss: 40656320.0000; val_gene_expr_recon_loss: 44979692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16166581.0000; val_global_loss: 102058768.0000; val_optim_loss: 102058768.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8409; val_auprc_score: 0.8546; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 360639.1458; train_edge_recon_loss: 34841542.6667; train_gene_expr_recon_loss: 44124562.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16219936.0000; train_global_loss: 95546678.2222; train_optim_loss: 95546678.2222; val_kl_reg_loss: 253644.6250; val_edge_recon_loss: 40655104.0000; val_gene_expr_recon_loss: 43398128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15902810.0000; val_global_loss: 100209688.0000; val_optim_loss: 100209688.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8360; val_auprc_score: 0.8476; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 360036.2153; train_edge_recon_loss: 34874516.4444; train_gene_expr_recon_loss: 42642806.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16028770.0000; train_global_loss: 93906128.8889; train_optim_loss: 93906128.8889; val_kl_reg_loss: 260318.0469; val_edge_recon_loss: 40653332.0000; val_gene_expr_recon_loss: 42195336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15752856.0000; val_global_loss: 98861848.0000; val_optim_loss: 98861848.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8248; val_auprc_score: 0.8378; val_best_acc_score: 0.5092; val_best_f1_score: 0.6707; train_kl_reg_loss: 361664.6771; train_edge_recon_loss: 34872042.6667; train_gene_expr_recon_loss: 41611990.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15904052.1111; train_global_loss: 92749749.3333; train_optim_loss: 92749749.3333; val_kl_reg_loss: 290106.9688; val_edge_recon_loss: 40650888.0000; val_gene_expr_recon_loss: 41287124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15595856.0000; val_global_loss: 97823976.0000; val_optim_loss: 97823976.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8105; val_auprc_score: 0.8217; val_best_acc_score: 0.5163; val_best_f1_score: 0.6739; train_kl_reg_loss: 351649.0382; train_edge_recon_loss: 34883408.8889; train_gene_expr_recon_loss: 40944201.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15789662.7778; train_global_loss: 91968923.5556; train_optim_loss: 91968923.5556; val_kl_reg_loss: 247570.2969; val_edge_recon_loss: 40647676.0000; val_gene_expr_recon_loss: 40710288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15493780.0000; val_global_loss: 97099312.0000; val_optim_loss: 97099312.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8188; val_auprc_score: 0.8272; val_best_acc_score: 0.5205; val_best_f1_score: 0.6758; train_kl_reg_loss: 341644.4583; train_edge_recon_loss: 34880120.8889; train_gene_expr_recon_loss: 40308963.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15669295.2222; train_global_loss: 91200024.8889; train_optim_loss: 91200024.8889; val_kl_reg_loss: 282484.5000; val_edge_recon_loss: 40644452.0000; val_gene_expr_recon_loss: 40203684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15417775.0000; val_global_loss: 96548400.0000; val_optim_loss: 96548400.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8094; val_auprc_score: 0.8184; val_best_acc_score: 0.5249; val_best_f1_score: 0.6777; train_kl_reg_loss: 336188.8993; train_edge_recon_loss: 34855163.1111; train_gene_expr_recon_loss: 39833908.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15536684.7778; train_global_loss: 90561946.6667; train_optim_loss: 90561946.6667; val_kl_reg_loss: 231165.6406; val_edge_recon_loss: 40640496.0000; val_gene_expr_recon_loss: 39896016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15340378.0000; val_global_loss: 96108056.0000; val_optim_loss: 96108056.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8071; val_auprc_score: 0.8132; val_best_acc_score: 0.5354; val_best_f1_score: 0.6822; train_kl_reg_loss: 318409.0903; train_edge_recon_loss: 34887552.4444; train_gene_expr_recon_loss: 39717401.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15574872.2222; train_global_loss: 90498235.5556; train_optim_loss: 90498235.5556; val_kl_reg_loss: 244746.8281; val_edge_recon_loss: 40634444.0000; val_gene_expr_recon_loss: 39554448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15278296.0000; val_global_loss: 95711936.0000; val_optim_loss: 95711936.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8098; val_auprc_score: 0.8124; val_best_acc_score: 0.5393; val_best_f1_score: 0.6833; train_kl_reg_loss: 317896.8090; train_edge_recon_loss: 34868661.7778; train_gene_expr_recon_loss: 39401266.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15484136.1111; train_global_loss: 90071961.7778; train_optim_loss: 90071961.7778; val_kl_reg_loss: 226929.5000; val_edge_recon_loss: 40629868.0000; val_gene_expr_recon_loss: 39398512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15277658.0000; val_global_loss: 95532968.0000; val_optim_loss: 95532968.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8065; val_auprc_score: 0.8098; val_best_acc_score: 0.5519; val_best_f1_score: 0.6890; train_kl_reg_loss: 304283.9253; train_edge_recon_loss: 34865489.7778; train_gene_expr_recon_loss: 39225100.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15430559.0000; train_global_loss: 89825433.7778; train_optim_loss: 89825433.7778; val_kl_reg_loss: 247752.7656; val_edge_recon_loss: 40623532.0000; val_gene_expr_recon_loss: 39193032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15229670.0000; val_global_loss: 95293992.0000; val_optim_loss: 95293992.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8121; val_auprc_score: 0.8136; val_best_acc_score: 0.5742; val_best_f1_score: 0.6992; train_kl_reg_loss: 303804.2830; train_edge_recon_loss: 34859911.5556; train_gene_expr_recon_loss: 39075266.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15458033.7778; train_global_loss: 89697015.1111; train_optim_loss: 89697015.1111; val_kl_reg_loss: 196488.2656; val_edge_recon_loss: 40612076.0000; val_gene_expr_recon_loss: 39118588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15224512.0000; val_global_loss: 95151664.0000; val_optim_loss: 95151664.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8070; val_auprc_score: 0.8013; val_best_acc_score: 0.5876; val_best_f1_score: 0.7050; train_kl_reg_loss: 290798.1962; train_edge_recon_loss: 34856432.0000; train_gene_expr_recon_loss: 38898199.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15415155.1111; train_global_loss: 89460584.0000; train_optim_loss: 89460584.0000; val_kl_reg_loss: 210978.2969; val_edge_recon_loss: 40603016.0000; val_gene_expr_recon_loss: 38973608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15188488.0000; val_global_loss: 94976088.0000; val_optim_loss: 94976088.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8149; val_auprc_score: 0.8082; val_best_acc_score: 0.6163; val_best_f1_score: 0.7185; train_kl_reg_loss: 282827.5573; train_edge_recon_loss: 34850642.6667; train_gene_expr_recon_loss: 38768071.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15333345.5556; train_global_loss: 89234888.0000; train_optim_loss: 89234888.0000; val_kl_reg_loss: 221885.4688; val_edge_recon_loss: 40591376.0000; val_gene_expr_recon_loss: 38884632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15174386.0000; val_global_loss: 94872272.0000; val_optim_loss: 94872272.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8084; val_auprc_score: 0.8035; val_best_acc_score: 0.6285; val_best_f1_score: 0.7233; train_kl_reg_loss: 278322.7240; train_edge_recon_loss: 34825461.3333; train_gene_expr_recon_loss: 38849691.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15428088.8889; train_global_loss: 89381563.5556; train_optim_loss: 89381563.5556; val_kl_reg_loss: 201579.1562; val_edge_recon_loss: 40577580.0000; val_gene_expr_recon_loss: 38770176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15131213.0000; val_global_loss: 94680552.0000; val_optim_loss: 94680552.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8146; val_auprc_score: 0.8059; val_best_acc_score: 0.6568; val_best_f1_score: 0.7374; train_kl_reg_loss: 274846.4392; train_edge_recon_loss: 34852976.8889; train_gene_expr_recon_loss: 38788951.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15303118.4444; train_global_loss: 89219892.4444; train_optim_loss: 89219892.4444; val_kl_reg_loss: 223671.4062; val_edge_recon_loss: 40556092.0000; val_gene_expr_recon_loss: 38688180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15143518.0000; val_global_loss: 94611464.0000; val_optim_loss: 94611464.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8158; val_auprc_score: 0.8047; val_best_acc_score: 0.6877; val_best_f1_score: 0.7525; train_kl_reg_loss: 259065.3889; train_edge_recon_loss: 34842083.1111; train_gene_expr_recon_loss: 38402142.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15295168.3333; train_global_loss: 88798461.3333; train_optim_loss: 88798461.3333; val_kl_reg_loss: 214902.2656; val_edge_recon_loss: 40526400.0000; val_gene_expr_recon_loss: 38644696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15116468.0000; val_global_loss: 94502464.0000; val_optim_loss: 94502464.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8186; val_auprc_score: 0.8111; val_best_acc_score: 0.7037; val_best_f1_score: 0.7582; train_kl_reg_loss: 267823.6233; train_edge_recon_loss: 34818584.4444; train_gene_expr_recon_loss: 38567452.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15332407.3333; train_global_loss: 88986269.3333; train_optim_loss: 88986269.3333; val_kl_reg_loss: 168336.7031; val_edge_recon_loss: 40485192.0000; val_gene_expr_recon_loss: 38659372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15114522.0000; val_global_loss: 94427416.0000; val_optim_loss: 94427416.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8245; val_auprc_score: 0.8109; val_best_acc_score: 0.7223; val_best_f1_score: 0.7677; train_kl_reg_loss: 251991.5556; train_edge_recon_loss: 34844534.2222; train_gene_expr_recon_loss: 38514467.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15287354.0000; train_global_loss: 88898345.7778; train_optim_loss: 88898345.7778; val_kl_reg_loss: 222501.8281; val_edge_recon_loss: 40459452.0000; val_gene_expr_recon_loss: 38402680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15053522.0000; val_global_loss: 94138152.0000; val_optim_loss: 94138152.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8297; val_auprc_score: 0.8162; val_best_acc_score: 0.7433; val_best_f1_score: 0.7737; train_kl_reg_loss: 316225.1597; train_edge_recon_loss: 38970279.5556; train_gene_expr_recon_loss: 38861924.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15260710.0000; train_global_loss: 93409138.6667; train_optim_loss: 93409138.6667; val_kl_reg_loss: 86111.3438; val_edge_recon_loss: 40355704.0000; val_gene_expr_recon_loss: 40129588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15250386.0000; val_global_loss: 95821792.0000; val_optim_loss: 95821792.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.7660; val_auprc_score: 0.7634; val_best_acc_score: 0.6846; val_best_f1_score: 0.7305; train_kl_reg_loss: 81577.7639; train_edge_recon_loss: 36211752.0000; train_gene_expr_recon_loss: 44833783.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15772191.1111; train_global_loss: 96899304.0000; train_optim_loss: 96899304.0000; val_kl_reg_loss: 1642.5269; val_edge_recon_loss: 40295400.0000; val_gene_expr_recon_loss: 51568488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16172952.0000; val_global_loss: 108038488.0000; val_optim_loss: 108038488.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8514; val_auprc_score: 0.8401; val_best_acc_score: 0.6637; val_best_f1_score: 0.7446; train_kl_reg_loss: 16024.6975; train_edge_recon_loss: 35412808.0000; train_gene_expr_recon_loss: 47697380.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16159087.2222; train_global_loss: 99285300.4444; train_optim_loss: 99285300.4444; val_kl_reg_loss: 30349.4102; val_edge_recon_loss: 40525888.0000; val_gene_expr_recon_loss: 42732552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15609408.0000; val_global_loss: 98898192.0000; val_optim_loss: 98898192.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8344; val_auprc_score: 0.8222; val_best_acc_score: 0.6572; val_best_f1_score: 0.7410; train_kl_reg_loss: 28631.6115; train_edge_recon_loss: 35048385.3333; train_gene_expr_recon_loss: 41685486.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15748986.0000; train_global_loss: 92511491.5556; train_optim_loss: 92511491.5556; val_kl_reg_loss: 46674.2422; val_edge_recon_loss: 40539144.0000; val_gene_expr_recon_loss: 40445264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15379918.0000; val_global_loss: 96411008.0000; val_optim_loss: 96411008.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8346; val_auprc_score: 0.8226; val_best_acc_score: 0.6673; val_best_f1_score: 0.7465; train_kl_reg_loss: 48206.4753; train_edge_recon_loss: 34985451.5556; train_gene_expr_recon_loss: 40687362.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15648106.4444; train_global_loss: 91369126.2222; train_optim_loss: 91369126.2222; val_kl_reg_loss: 39968.5312; val_edge_recon_loss: 40527140.0000; val_gene_expr_recon_loss: 40381388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15380274.0000; val_global_loss: 96328768.0000; val_optim_loss: 96328768.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8318; val_auprc_score: 0.8171; val_best_acc_score: 0.6626; val_best_f1_score: 0.7435; train_kl_reg_loss: 42576.3546; train_edge_recon_loss: 35151567.5556; train_gene_expr_recon_loss: 40590765.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15607665.0000; train_global_loss: 91392575.1111; train_optim_loss: 91392575.1111; val_kl_reg_loss: 41455.4805; val_edge_recon_loss: 40536448.0000; val_gene_expr_recon_loss: 40210188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15329575.0000; val_global_loss: 96117672.0000; val_optim_loss: 96117672.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8345; val_auprc_score: 0.8234; val_best_acc_score: 0.6599; val_best_f1_score: 0.7428; train_kl_reg_loss: 49690.6046; train_edge_recon_loss: 35123022.2222; train_gene_expr_recon_loss: 40213656.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15482513.7778; train_global_loss: 90868884.4444; train_optim_loss: 90868884.4444; val_kl_reg_loss: 52860.6719; val_edge_recon_loss: 40537412.0000; val_gene_expr_recon_loss: 40098672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15329438.0000; val_global_loss: 96018384.0000; val_optim_loss: 96018384.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8310; val_auprc_score: 0.8190; val_best_acc_score: 0.6531; val_best_f1_score: 0.7390; train_kl_reg_loss: 59085.1797; train_edge_recon_loss: 35096625.3333; train_gene_expr_recon_loss: 40116892.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15511422.0000; train_global_loss: 90784024.8889; train_optim_loss: 90784024.8889; val_kl_reg_loss: 54272.8594; val_edge_recon_loss: 40546284.0000; val_gene_expr_recon_loss: 39924904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15292626.0000; val_global_loss: 95818080.0000; val_optim_loss: 95818080.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 45 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8244
val AUPRC score: 0.8121
val best accuracy score: 0.7005
val best F1 score: 0.7587
val target rna MSE score: 1.0088
val source rna MSE score: 1.6106
val target atac MSE score: 0.1187
val source atac MSE score: 0.0215
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
