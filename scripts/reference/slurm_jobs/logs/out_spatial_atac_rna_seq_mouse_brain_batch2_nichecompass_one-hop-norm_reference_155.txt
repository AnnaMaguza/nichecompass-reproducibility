[True]
Run timestamp: 26072023_041210_155.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_155']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9154; val_auprc_score: 0.9282; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 17032.8892; train_edge_recon_loss: 34729327.1111; train_gene_expr_recon_loss: 31991089.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10947253.7778; train_global_loss: 77684702.2222; train_optim_loss: 77684702.2222; val_kl_reg_loss: 36188.7227; val_edge_recon_loss: 40648708.0000; val_gene_expr_recon_loss: 30058954.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10625394.0000; val_global_loss: 81369240.0000; val_optim_loss: 81369240.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8996; val_auprc_score: 0.9143; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 65843.6176; train_edge_recon_loss: 34837781.3333; train_gene_expr_recon_loss: 29167789.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10691281.6667; train_global_loss: 74762693.3333; train_optim_loss: 74762693.3333; val_kl_reg_loss: 144118.2031; val_edge_recon_loss: 40652792.0000; val_gene_expr_recon_loss: 27894640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10450273.0000; val_global_loss: 79141824.0000; val_optim_loss: 79141824.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8931; val_auprc_score: 0.9053; val_best_acc_score: 0.5054; val_best_f1_score: 0.6690; train_kl_reg_loss: 171509.9062; train_edge_recon_loss: 34807646.2222; train_gene_expr_recon_loss: 27231013.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10507533.2222; train_global_loss: 72717702.2222; train_optim_loss: 72717702.2222; val_kl_reg_loss: 253633.8125; val_edge_recon_loss: 40653264.0000; val_gene_expr_recon_loss: 25893542.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10257605.0000; val_global_loss: 77058048.0000; val_optim_loss: 77058048.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8943; val_auprc_score: 0.8996; val_best_acc_score: 0.5078; val_best_f1_score: 0.6701; train_kl_reg_loss: 245808.8229; train_edge_recon_loss: 34840235.1111; train_gene_expr_recon_loss: 25173650.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10281737.7778; train_global_loss: 70541431.1111; train_optim_loss: 70541431.1111; val_kl_reg_loss: 181663.8750; val_edge_recon_loss: 40650092.0000; val_gene_expr_recon_loss: 24394476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10083919.0000; val_global_loss: 75310152.0000; val_optim_loss: 75310152.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8904; val_auprc_score: 0.8992; val_best_acc_score: 0.5071; val_best_f1_score: 0.6698; train_kl_reg_loss: 301691.1979; train_edge_recon_loss: 34829321.3333; train_gene_expr_recon_loss: 24014904.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10150211.8889; train_global_loss: 69296129.7778; train_optim_loss: 69296129.7778; val_kl_reg_loss: 270582.3750; val_edge_recon_loss: 40650760.0000; val_gene_expr_recon_loss: 23310386.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9964965.0000; val_global_loss: 74196696.0000; val_optim_loss: 74196696.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8944; val_auprc_score: 0.8992; val_best_acc_score: 0.5088; val_best_f1_score: 0.6705; train_kl_reg_loss: 356933.7743; train_edge_recon_loss: 34832172.8889; train_gene_expr_recon_loss: 23116827.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10096970.5556; train_global_loss: 68402904.8889; train_optim_loss: 68402904.8889; val_kl_reg_loss: 277649.1875; val_edge_recon_loss: 40647008.0000; val_gene_expr_recon_loss: 22563780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9883338.0000; val_global_loss: 73371776.0000; val_optim_loss: 73371776.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8946; val_auprc_score: 0.8961; val_best_acc_score: 0.5210; val_best_f1_score: 0.6760; train_kl_reg_loss: 367778.8924; train_edge_recon_loss: 34855746.2222; train_gene_expr_recon_loss: 22369940.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9938720.0000; train_global_loss: 67532187.1111; train_optim_loss: 67532187.1111; val_kl_reg_loss: 289483.0625; val_edge_recon_loss: 40638596.0000; val_gene_expr_recon_loss: 22077554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9813549.0000; val_global_loss: 72819184.0000; val_optim_loss: 72819184.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9015; val_auprc_score: 0.9015; val_best_acc_score: 0.5375; val_best_f1_score: 0.6835; train_kl_reg_loss: 370541.9236; train_edge_recon_loss: 34860636.4444; train_gene_expr_recon_loss: 21897279.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9865944.1111; train_global_loss: 66994401.7778; train_optim_loss: 66994401.7778; val_kl_reg_loss: 343892.3125; val_edge_recon_loss: 40630520.0000; val_gene_expr_recon_loss: 21685924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9767845.0000; val_global_loss: 72428184.0000; val_optim_loss: 72428184.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9001; val_auprc_score: 0.8937; val_best_acc_score: 0.5717; val_best_f1_score: 0.6998; train_kl_reg_loss: 385417.4931; train_edge_recon_loss: 34860463.5556; train_gene_expr_recon_loss: 21656912.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9846751.3333; train_global_loss: 66749545.7778; train_optim_loss: 66749545.7778; val_kl_reg_loss: 334277.1562; val_edge_recon_loss: 40615184.0000; val_gene_expr_recon_loss: 21439556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9742983.0000; val_global_loss: 72132000.0000; val_optim_loss: 72132000.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8996; val_auprc_score: 0.8945; val_best_acc_score: 0.6249; val_best_f1_score: 0.7265; train_kl_reg_loss: 371883.3160; train_edge_recon_loss: 34885149.7778; train_gene_expr_recon_loss: 21445759.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9802460.5556; train_global_loss: 66505252.8889; train_optim_loss: 66505252.8889; val_kl_reg_loss: 321718.2500; val_edge_recon_loss: 40591256.0000; val_gene_expr_recon_loss: 21253882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9727994.0000; val_global_loss: 71894848.0000; val_optim_loss: 71894848.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8965; val_auprc_score: 0.8887; val_best_acc_score: 0.6703; val_best_f1_score: 0.7499; train_kl_reg_loss: 367418.9514; train_edge_recon_loss: 34848354.2222; train_gene_expr_recon_loss: 21371381.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9868043.7778; train_global_loss: 66455199.5556; train_optim_loss: 66455199.5556; val_kl_reg_loss: 280774.9375; val_edge_recon_loss: 40555060.0000; val_gene_expr_recon_loss: 21117798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9708112.0000; val_global_loss: 71661744.0000; val_optim_loss: 71661744.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9021; val_auprc_score: 0.8908; val_best_acc_score: 0.7396; val_best_f1_score: 0.7893; train_kl_reg_loss: 355403.5729; train_edge_recon_loss: 34864861.3333; train_gene_expr_recon_loss: 21130543.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9798170.3333; train_global_loss: 66148979.5556; train_optim_loss: 66148979.5556; val_kl_reg_loss: 242575.3438; val_edge_recon_loss: 40485612.0000; val_gene_expr_recon_loss: 21040210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9691583.0000; val_global_loss: 71459984.0000; val_optim_loss: 71459984.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9017; val_auprc_score: 0.8942; val_best_acc_score: 0.7718; val_best_f1_score: 0.8061; train_kl_reg_loss: 352976.2431; train_edge_recon_loss: 34836813.3333; train_gene_expr_recon_loss: 21171512.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776917.3333; train_global_loss: 66138220.4444; train_optim_loss: 66138220.4444; val_kl_reg_loss: 279148.6562; val_edge_recon_loss: 40384336.0000; val_gene_expr_recon_loss: 20966282.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9671989.0000; val_global_loss: 71301760.0000; val_optim_loss: 71301760.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8988; val_auprc_score: 0.8879; val_best_acc_score: 0.8064; val_best_f1_score: 0.8235; train_kl_reg_loss: 319336.3958; train_edge_recon_loss: 34848126.6667; train_gene_expr_recon_loss: 20986247.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737097.5556; train_global_loss: 65890808.0000; train_optim_loss: 65890808.0000; val_kl_reg_loss: 248943.2188; val_edge_recon_loss: 40226532.0000; val_gene_expr_recon_loss: 20921418.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9662588.0000; val_global_loss: 71059488.0000; val_optim_loss: 71059488.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9016; val_auprc_score: 0.8910; val_best_acc_score: 0.8199; val_best_f1_score: 0.8229; train_kl_reg_loss: 317484.2743; train_edge_recon_loss: 34810928.4444; train_gene_expr_recon_loss: 20993863.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9768556.1111; train_global_loss: 65890832.0000; train_optim_loss: 65890832.0000; val_kl_reg_loss: 208562.6094; val_edge_recon_loss: 39947076.0000; val_gene_expr_recon_loss: 20895142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9655852.0000; val_global_loss: 70706640.0000; val_optim_loss: 70706640.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8997; val_auprc_score: 0.8864; val_best_acc_score: 0.8046; val_best_f1_score: 0.7993; train_kl_reg_loss: 282957.1979; train_edge_recon_loss: 34780860.0000; train_gene_expr_recon_loss: 20852616.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750078.6667; train_global_loss: 65666512.4444; train_optim_loss: 65666512.4444; val_kl_reg_loss: 257651.3750; val_edge_recon_loss: 39486128.0000; val_gene_expr_recon_loss: 20821232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9648421.0000; val_global_loss: 70213432.0000; val_optim_loss: 70213432.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8993; val_auprc_score: 0.8821; val_best_acc_score: 0.8119; val_best_f1_score: 0.8319; train_kl_reg_loss: 255228.4670; train_edge_recon_loss: 34665805.3333; train_gene_expr_recon_loss: 20775345.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9716457.2222; train_global_loss: 65412835.5556; train_optim_loss: 65412835.5556; val_kl_reg_loss: 208308.0000; val_edge_recon_loss: 38350284.0000; val_gene_expr_recon_loss: 20829306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9645439.0000; val_global_loss: 69033336.0000; val_optim_loss: 69033336.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9025; val_auprc_score: 0.8877; val_best_acc_score: 0.8251; val_best_f1_score: 0.8333; train_kl_reg_loss: 194231.1979; train_edge_recon_loss: 34283825.3333; train_gene_expr_recon_loss: 20966420.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816128.0000; train_global_loss: 65260605.3333; train_optim_loss: 65260605.3333; val_kl_reg_loss: 104871.1250; val_edge_recon_loss: 35519620.0000; val_gene_expr_recon_loss: 20985578.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9665283.0000; val_global_loss: 66275356.0000; val_optim_loss: 66275356.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8824; val_auprc_score: 0.8657; val_best_acc_score: 0.7979; val_best_f1_score: 0.8071; train_kl_reg_loss: 94525.0226; train_edge_recon_loss: 32481254.0000; train_gene_expr_recon_loss: 21262514.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776080.1111; train_global_loss: 63614372.8889; train_optim_loss: 63614372.8889; val_kl_reg_loss: 75669.0469; val_edge_recon_loss: 30718560.0000; val_gene_expr_recon_loss: 21676298.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9764720.0000; val_global_loss: 62235248.0000; val_optim_loss: 62235248.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8758; val_auprc_score: 0.8550; val_best_acc_score: 0.7827; val_best_f1_score: 0.8018; train_kl_reg_loss: 125622.8273; train_edge_recon_loss: 30016547.5556; train_gene_expr_recon_loss: 21497322.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9860243.1111; train_global_loss: 61499736.0000; train_optim_loss: 61499736.0000; val_kl_reg_loss: 184933.0469; val_edge_recon_loss: 29224652.0000; val_gene_expr_recon_loss: 21381012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9713008.0000; val_global_loss: 60503608.0000; val_optim_loss: 60503608.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8672; val_auprc_score: 0.8428; val_best_acc_score: 0.7836; val_best_f1_score: 0.8059; train_kl_reg_loss: 222708.5226; train_edge_recon_loss: 29345263.5556; train_gene_expr_recon_loss: 21361909.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9777705.3333; train_global_loss: 60707587.1111; train_optim_loss: 60707587.1111; val_kl_reg_loss: 226376.8281; val_edge_recon_loss: 29838396.0000; val_gene_expr_recon_loss: 21066474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9665289.0000; val_global_loss: 60796536.0000; val_optim_loss: 60796536.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8814; val_auprc_score: 0.8694; val_best_acc_score: 0.7858; val_best_f1_score: 0.8018; train_kl_reg_loss: 229318.7014; train_edge_recon_loss: 29629573.1111; train_gene_expr_recon_loss: 21187628.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9779264.7778; train_global_loss: 60825784.4444; train_optim_loss: 60825784.4444; val_kl_reg_loss: 265582.9375; val_edge_recon_loss: 29317116.0000; val_gene_expr_recon_loss: 21075858.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9668009.0000; val_global_loss: 60326564.0000; val_optim_loss: 60326564.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8747; val_auprc_score: 0.8523; val_best_acc_score: 0.7933; val_best_f1_score: 0.8033; train_kl_reg_loss: 332968.5000; train_edge_recon_loss: 29058420.8889; train_gene_expr_recon_loss: 20986852.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9745989.6667; train_global_loss: 60124231.5556; train_optim_loss: 60124231.5556; val_kl_reg_loss: 366658.6250; val_edge_recon_loss: 28891092.0000; val_gene_expr_recon_loss: 20927022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9636630.0000; val_global_loss: 59821400.0000; val_optim_loss: 59821400.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8857; val_auprc_score: 0.8667; val_best_acc_score: 0.8009; val_best_f1_score: 0.8105; train_kl_reg_loss: 390585.9722; train_edge_recon_loss: 28803290.2222; train_gene_expr_recon_loss: 20799546.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697907.6667; train_global_loss: 59691329.7778; train_optim_loss: 59691329.7778; val_kl_reg_loss: 385253.6875; val_edge_recon_loss: 28403286.0000; val_gene_expr_recon_loss: 20795682.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9605828.0000; val_global_loss: 59190052.0000; val_optim_loss: 59190052.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8874; val_auprc_score: 0.8645; val_best_acc_score: 0.8048; val_best_f1_score: 0.8087; train_kl_reg_loss: 394931.1562; train_edge_recon_loss: 28716198.4444; train_gene_expr_recon_loss: 20854346.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750091.4444; train_global_loss: 59715567.5556; train_optim_loss: 59715567.5556; val_kl_reg_loss: 374635.0000; val_edge_recon_loss: 28623558.0000; val_gene_expr_recon_loss: 20763158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9605298.0000; val_global_loss: 59366648.0000; val_optim_loss: 59366648.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8898; val_auprc_score: 0.8653; val_best_acc_score: 0.8106; val_best_f1_score: 0.8276; train_kl_reg_loss: 403561.4931; train_edge_recon_loss: 29823037.7778; train_gene_expr_recon_loss: 21155045.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9727211.6667; train_global_loss: 61108855.5556; train_optim_loss: 61108855.5556; val_kl_reg_loss: 86801.0938; val_edge_recon_loss: 29302486.0000; val_gene_expr_recon_loss: 21259190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9705972.0000; val_global_loss: 60354452.0000; val_optim_loss: 60354452.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8920; val_auprc_score: 0.8713; val_best_acc_score: 0.8112; val_best_f1_score: 0.8290; train_kl_reg_loss: 506891.5521; train_edge_recon_loss: 29275809.3333; train_gene_expr_recon_loss: 21330744.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9797008.3333; train_global_loss: 60910454.2222; train_optim_loss: 60910454.2222; val_kl_reg_loss: 104930.0547; val_edge_recon_loss: 29206466.0000; val_gene_expr_recon_loss: 21183862.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673892.0000; val_global_loss: 60169148.0000; val_optim_loss: 60169148.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8941; val_auprc_score: 0.8717; val_best_acc_score: 0.8130; val_best_f1_score: 0.8305; train_kl_reg_loss: 533372.3576; train_edge_recon_loss: 28991442.0000; train_gene_expr_recon_loss: 21100505.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9704887.1111; train_global_loss: 60330207.5556; train_optim_loss: 60330207.5556; val_kl_reg_loss: 119785.0469; val_edge_recon_loss: 28636968.0000; val_gene_expr_recon_loss: 21018306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9630918.0000; val_global_loss: 59405976.0000; val_optim_loss: 59405976.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8929; val_auprc_score: 0.8707; val_best_acc_score: 0.8131; val_best_f1_score: 0.8303; train_kl_reg_loss: 544740.0417; train_edge_recon_loss: 28899246.8889; train_gene_expr_recon_loss: 21014195.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9721733.0000; train_global_loss: 60179915.5556; train_optim_loss: 60179915.5556; val_kl_reg_loss: 124362.9844; val_edge_recon_loss: 28963834.0000; val_gene_expr_recon_loss: 20969750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9630798.0000; val_global_loss: 59688744.0000; val_optim_loss: 59688744.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8876; val_auprc_score: 0.8661; val_best_acc_score: 0.8026; val_best_f1_score: 0.8224; train_kl_reg_loss: 549859.6944; train_edge_recon_loss: 28943006.6667; train_gene_expr_recon_loss: 21030935.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757927.4444; train_global_loss: 60281730.2222; train_optim_loss: 60281730.2222; val_kl_reg_loss: 126556.2578; val_edge_recon_loss: 28933752.0000; val_gene_expr_recon_loss: 20909528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9617361.0000; val_global_loss: 59587196.0000; val_optim_loss: 59587196.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8940; val_auprc_score: 0.8781; val_best_acc_score: 0.8099; val_best_f1_score: 0.8278; train_kl_reg_loss: 535043.5278; train_edge_recon_loss: 28888947.1111; train_gene_expr_recon_loss: 20868064.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9657669.8889; train_global_loss: 59949724.8889; train_optim_loss: 59949724.8889; val_kl_reg_loss: 124705.4375; val_edge_recon_loss: 29268002.0000; val_gene_expr_recon_loss: 20921176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9620940.0000; val_global_loss: 59934824.0000; val_optim_loss: 59934824.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8871; val_auprc_score: 0.8684; val_best_acc_score: 0.8025; val_best_f1_score: 0.8223; train_kl_reg_loss: 534309.9444; train_edge_recon_loss: 28938479.3333; train_gene_expr_recon_loss: 20942030.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9691609.7778; train_global_loss: 60106429.3333; train_optim_loss: 60106429.3333; val_kl_reg_loss: 130738.7656; val_edge_recon_loss: 29304146.0000; val_gene_expr_recon_loss: 20905526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9620218.0000; val_global_loss: 59960624.0000; val_optim_loss: 59960624.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 29 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.8909
Val AUPRC score: 0.8728
Val best accuracy score: 0.8058
Val best F1 score: 0.8245
Val gene expr MSE score: 0.4760
Val chrom access MSE score: 0.0948
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
