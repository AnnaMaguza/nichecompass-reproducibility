[True]
Run timestamp: 07082023_221222_155.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_155']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8886; val_auprc_score: 0.8939; val_best_acc_score: 0.6102; val_best_f1_score: 0.7162; train_kl_reg_loss: 29400.2501; train_edge_recon_loss: 3472722.4722; train_gene_expr_recon_loss: 1216212.8472; train_masked_gp_l1_reg_loss: 4504.9587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119307.9479; train_chrom_access_recon_loss: 722440.0104; train_global_loss: 5564588.6111; train_optim_loss: 5564588.6111; val_kl_reg_loss: 8956.2344; val_edge_recon_loss: 4057448.5000; val_gene_expr_recon_loss: 1094821.8750; val_masked_gp_l1_reg_loss: 4041.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116858.8281; val_chrom_access_recon_loss: 493758.1562; val_global_loss: 5775884.5000; val_optim_loss: 5775884.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8863; val_auprc_score: 0.8935; val_best_acc_score: 0.6233; val_best_f1_score: 0.7228; train_kl_reg_loss: 8103.7856; train_edge_recon_loss: 3472464.4167; train_gene_expr_recon_loss: 1017920.3056; train_masked_gp_l1_reg_loss: 3944.6444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115144.5399; train_chrom_access_recon_loss: 493918.0382; train_global_loss: 5111495.8333; train_optim_loss: 5111495.8333; val_kl_reg_loss: 8820.0234; val_edge_recon_loss: 4056953.2500; val_gene_expr_recon_loss: 952005.2500; val_masked_gp_l1_reg_loss: 3902.5681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112987.5078; val_chrom_access_recon_loss: 489580.7188; val_global_loss: 5624249.0000; val_optim_loss: 5624249.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8783; val_auprc_score: 0.8849; val_best_acc_score: 0.6353; val_best_f1_score: 0.7280; train_kl_reg_loss: 10424.7323; train_edge_recon_loss: 3475718.1389; train_gene_expr_recon_loss: 908208.8681; train_masked_gp_l1_reg_loss: 3948.6247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111234.5521; train_chrom_access_recon_loss: 484489.5486; train_global_loss: 4994024.5000; train_optim_loss: 4994024.5000; val_kl_reg_loss: 11553.9668; val_edge_recon_loss: 4054873.5000; val_gene_expr_recon_loss: 866910.7500; val_masked_gp_l1_reg_loss: 4015.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109001.4844; val_chrom_access_recon_loss: 472585.3438; val_global_loss: 5518940.0000; val_optim_loss: 5518940.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8708; val_auprc_score: 0.8725; val_best_acc_score: 0.6673; val_best_f1_score: 0.7415; train_kl_reg_loss: 14101.9033; train_edge_recon_loss: 3476713.0556; train_gene_expr_recon_loss: 836665.8958; train_masked_gp_l1_reg_loss: 4056.1191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107099.7726; train_chrom_access_recon_loss: 466273.2361; train_global_loss: 4904909.8333; train_optim_loss: 4904909.8333; val_kl_reg_loss: 12902.5879; val_edge_recon_loss: 4047995.7500; val_gene_expr_recon_loss: 808488.0625; val_masked_gp_l1_reg_loss: 4095.2144; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104622.5781; val_chrom_access_recon_loss: 459904.9375; val_global_loss: 5438009.0000; val_optim_loss: 5438009.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8632; val_auprc_score: 0.8638; val_best_acc_score: 0.7292; val_best_f1_score: 0.7735; train_kl_reg_loss: 16020.6984; train_edge_recon_loss: 3476219.2778; train_gene_expr_recon_loss: 788383.1597; train_masked_gp_l1_reg_loss: 4119.8595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102482.7352; train_chrom_access_recon_loss: 457207.6840; train_global_loss: 4844433.5000; train_optim_loss: 4844433.5000; val_kl_reg_loss: 15167.2227; val_edge_recon_loss: 4032679.2500; val_gene_expr_recon_loss: 770870.0000; val_masked_gp_l1_reg_loss: 4148.5928; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99711.4062; val_chrom_access_recon_loss: 454420.7500; val_global_loss: 5376997.0000; val_optim_loss: 5376997.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8608; val_auprc_score: 0.8528; val_best_acc_score: 0.7953; val_best_f1_score: 0.7977; train_kl_reg_loss: 16087.6628; train_edge_recon_loss: 3472796.7500; train_gene_expr_recon_loss: 759709.7986; train_masked_gp_l1_reg_loss: 4180.3762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97376.1042; train_chrom_access_recon_loss: 452435.0903; train_global_loss: 4802585.7778; train_optim_loss: 4802585.7778; val_kl_reg_loss: 15539.4180; val_edge_recon_loss: 3981511.5000; val_gene_expr_recon_loss: 750928.8750; val_masked_gp_l1_reg_loss: 4220.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94411.3281; val_chrom_access_recon_loss: 451400.9688; val_global_loss: 5298012.5000; val_optim_loss: 5298012.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8538; val_auprc_score: 0.8363; val_best_acc_score: 0.7801; val_best_f1_score: 0.7916; train_kl_reg_loss: 13363.5499; train_edge_recon_loss: 3450713.4444; train_gene_expr_recon_loss: 746909.2014; train_masked_gp_l1_reg_loss: 4261.7560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92002.8047; train_chrom_access_recon_loss: 450795.3646; train_global_loss: 4758046.1667; train_optim_loss: 4758046.1667; val_kl_reg_loss: 9760.8320; val_edge_recon_loss: 3726104.7500; val_gene_expr_recon_loss: 748977.5000; val_masked_gp_l1_reg_loss: 4315.5601; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88992.4922; val_chrom_access_recon_loss: 450229.3125; val_global_loss: 5028380.5000; val_optim_loss: 5028380.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8536; val_auprc_score: 0.8328; val_best_acc_score: 0.7784; val_best_f1_score: 0.8035; train_kl_reg_loss: 9347.1863; train_edge_recon_loss: 3297851.6944; train_gene_expr_recon_loss: 762150.4514; train_masked_gp_l1_reg_loss: 4377.8451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86633.1267; train_chrom_access_recon_loss: 452758.2986; train_global_loss: 4613118.6667; train_optim_loss: 4613118.6667; val_kl_reg_loss: 11469.7305; val_edge_recon_loss: 3055878.5000; val_gene_expr_recon_loss: 782981.5625; val_masked_gp_l1_reg_loss: 4480.6880; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83741.0938; val_chrom_access_recon_loss: 453008.5000; val_global_loss: 4391560.0000; val_optim_loss: 4391560.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8738; val_auprc_score: 0.8604; val_best_acc_score: 0.7821; val_best_f1_score: 0.8065; train_kl_reg_loss: 23880.0888; train_edge_recon_loss: 2958140.5000; train_gene_expr_recon_loss: 777078.7847; train_masked_gp_l1_reg_loss: 4587.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81489.5391; train_chrom_access_recon_loss: 451088.2778; train_global_loss: 4296264.3889; train_optim_loss: 4296264.3889; val_kl_reg_loss: 37942.7422; val_edge_recon_loss: 2914088.7500; val_gene_expr_recon_loss: 763831.7500; val_masked_gp_l1_reg_loss: 4680.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78680.3125; val_chrom_access_recon_loss: 451074.5625; val_global_loss: 4250299.0000; val_optim_loss: 4250299.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8934; val_auprc_score: 0.8705; val_best_acc_score: 0.8131; val_best_f1_score: 0.8257; train_kl_reg_loss: 46275.0013; train_edge_recon_loss: 2852970.9167; train_gene_expr_recon_loss: 757906.9792; train_masked_gp_l1_reg_loss: 4717.9670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76460.7943; train_chrom_access_recon_loss: 451739.8368; train_global_loss: 4190071.5556; train_optim_loss: 4190071.5556; val_kl_reg_loss: 45777.4453; val_edge_recon_loss: 2856271.5000; val_gene_expr_recon_loss: 750914.3125; val_masked_gp_l1_reg_loss: 4758.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73704.8672; val_chrom_access_recon_loss: 449140.1875; val_global_loss: 4180566.5000; val_optim_loss: 4180566.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9124; val_auprc_score: 0.8879; val_best_acc_score: 0.8417; val_best_f1_score: 0.8561; train_kl_reg_loss: 40922.2747; train_edge_recon_loss: 2819024.5556; train_gene_expr_recon_loss: 745633.7500; train_masked_gp_l1_reg_loss: 4798.2920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71552.9852; train_chrom_access_recon_loss: 447645.5660; train_global_loss: 4129577.5000; train_optim_loss: 4129577.5000; val_kl_reg_loss: 32328.4883; val_edge_recon_loss: 2764225.0000; val_gene_expr_recon_loss: 750341.3750; val_masked_gp_l1_reg_loss: 4839.3423; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68896.2969; val_chrom_access_recon_loss: 448263.1875; val_global_loss: 4068893.7500; val_optim_loss: 4068893.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9258; val_auprc_score: 0.8999; val_best_acc_score: 0.8654; val_best_f1_score: 0.8743; train_kl_reg_loss: 32776.5679; train_edge_recon_loss: 2753419.6944; train_gene_expr_recon_loss: 742549.9583; train_masked_gp_l1_reg_loss: 4869.0330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66848.0729; train_chrom_access_recon_loss: 446315.8160; train_global_loss: 4046779.0833; train_optim_loss: 4046779.0833; val_kl_reg_loss: 32609.8281; val_edge_recon_loss: 2762447.5000; val_gene_expr_recon_loss: 744266.2500; val_masked_gp_l1_reg_loss: 4893.2280; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64325.1367; val_chrom_access_recon_loss: 446981.0938; val_global_loss: 4055523.0000; val_optim_loss: 4055523.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9309; val_auprc_score: 0.9075; val_best_acc_score: 0.8701; val_best_f1_score: 0.8784; train_kl_reg_loss: 36996.7331; train_edge_recon_loss: 2734644.4444; train_gene_expr_recon_loss: 737872.3611; train_masked_gp_l1_reg_loss: 4903.3776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62384.7921; train_chrom_access_recon_loss: 445677.0625; train_global_loss: 4022478.7778; train_optim_loss: 4022478.7778; val_kl_reg_loss: 37957.1094; val_edge_recon_loss: 2745847.7500; val_gene_expr_recon_loss: 738600.0000; val_masked_gp_l1_reg_loss: 4912.3989; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60001.7891; val_chrom_access_recon_loss: 445789.3125; val_global_loss: 4033108.2500; val_optim_loss: 4033108.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9419; val_auprc_score: 0.9290; val_best_acc_score: 0.8793; val_best_f1_score: 0.8865; train_kl_reg_loss: 40569.2730; train_edge_recon_loss: 2730053.3611; train_gene_expr_recon_loss: 728931.6736; train_masked_gp_l1_reg_loss: 4922.2485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58177.8507; train_chrom_access_recon_loss: 445565.3264; train_global_loss: 4008219.5833; train_optim_loss: 4008219.5833; val_kl_reg_loss: 39551.1172; val_edge_recon_loss: 2711540.2500; val_gene_expr_recon_loss: 730920.1250; val_masked_gp_l1_reg_loss: 4924.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55945.0156; val_chrom_access_recon_loss: 444386.1250; val_global_loss: 3987267.5000; val_optim_loss: 3987267.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9446; val_auprc_score: 0.9275; val_best_acc_score: 0.8840; val_best_f1_score: 0.8909; train_kl_reg_loss: 39296.2214; train_edge_recon_loss: 2721721.2500; train_gene_expr_recon_loss: 723811.7500; train_masked_gp_l1_reg_loss: 4937.7119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54240.2305; train_chrom_access_recon_loss: 442678.8125; train_global_loss: 3986685.9167; train_optim_loss: 3986685.9167; val_kl_reg_loss: 37504.0000; val_edge_recon_loss: 2737944.2500; val_gene_expr_recon_loss: 724074.0000; val_masked_gp_l1_reg_loss: 4948.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52156.7773; val_chrom_access_recon_loss: 443245.1562; val_global_loss: 3999872.7500; val_optim_loss: 3999872.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9476; val_auprc_score: 0.9299; val_best_acc_score: 0.8903; val_best_f1_score: 0.8955; train_kl_reg_loss: 37928.9028; train_edge_recon_loss: 2715170.5556; train_gene_expr_recon_loss: 718974.5208; train_masked_gp_l1_reg_loss: 4956.0667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50574.7609; train_chrom_access_recon_loss: 441748.3403; train_global_loss: 3969353.1389; train_optim_loss: 3969353.1389; val_kl_reg_loss: 35861.9961; val_edge_recon_loss: 2745683.2500; val_gene_expr_recon_loss: 718433.6250; val_masked_gp_l1_reg_loss: 4963.3872; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48648.2031; val_chrom_access_recon_loss: 442588.0000; val_global_loss: 3996178.7500; val_optim_loss: 3996178.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9490; val_auprc_score: 0.9336; val_best_acc_score: 0.8906; val_best_f1_score: 0.8981; train_kl_reg_loss: 36445.1489; train_edge_recon_loss: 2707611.3611; train_gene_expr_recon_loss: 715800.0833; train_masked_gp_l1_reg_loss: 4979.7191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47201.5668; train_chrom_access_recon_loss: 440565.8611; train_global_loss: 3952603.7222; train_optim_loss: 3952603.7222; val_kl_reg_loss: 35676.6680; val_edge_recon_loss: 2740133.7500; val_gene_expr_recon_loss: 719619.1250; val_masked_gp_l1_reg_loss: 4997.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45443.9922; val_chrom_access_recon_loss: 441455.7188; val_global_loss: 3987327.2500; val_optim_loss: 3987327.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9586; val_auprc_score: 0.9449; val_best_acc_score: 0.9088; val_best_f1_score: 0.9138; train_kl_reg_loss: 37011.2786; train_edge_recon_loss: 2709216.2222; train_gene_expr_recon_loss: 714218.7847; train_masked_gp_l1_reg_loss: 5018.6197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44131.4180; train_chrom_access_recon_loss: 441075.7569; train_global_loss: 3950672.0833; train_optim_loss: 3950672.0833; val_kl_reg_loss: 36226.8555; val_edge_recon_loss: 2706968.2500; val_gene_expr_recon_loss: 714911.6250; val_masked_gp_l1_reg_loss: 5032.2681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42533.5625; val_chrom_access_recon_loss: 440907.0312; val_global_loss: 3946579.2500; val_optim_loss: 3946579.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9638; val_auprc_score: 0.9517; val_best_acc_score: 0.9179; val_best_f1_score: 0.9212; train_kl_reg_loss: 36333.6762; train_edge_recon_loss: 2709864.7500; train_gene_expr_recon_loss: 710828.4931; train_masked_gp_l1_reg_loss: 5051.9613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41343.4757; train_chrom_access_recon_loss: 441482.7222; train_global_loss: 3944905.0556; train_optim_loss: 3944905.0556; val_kl_reg_loss: 34287.7969; val_edge_recon_loss: 2697600.7500; val_gene_expr_recon_loss: 710240.5000; val_masked_gp_l1_reg_loss: 5076.4683; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39894.9570; val_chrom_access_recon_loss: 440189.2188; val_global_loss: 3927289.7500; val_optim_loss: 3927289.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9686; val_auprc_score: 0.9568; val_best_acc_score: 0.9235; val_best_f1_score: 0.9270; train_kl_reg_loss: 34730.1050; train_edge_recon_loss: 2693486.6111; train_gene_expr_recon_loss: 707799.7222; train_masked_gp_l1_reg_loss: 5101.3372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38810.8589; train_chrom_access_recon_loss: 440245.2292; train_global_loss: 3920173.8056; train_optim_loss: 3920173.8056; val_kl_reg_loss: 33668.6992; val_edge_recon_loss: 2688985.2500; val_gene_expr_recon_loss: 711352.0000; val_masked_gp_l1_reg_loss: 5123.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37494.0273; val_chrom_access_recon_loss: 439705.3750; val_global_loss: 3916329.0000; val_optim_loss: 3916329.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9685; val_auprc_score: 0.9564; val_best_acc_score: 0.9241; val_best_f1_score: 0.9273; train_kl_reg_loss: 34319.9010; train_edge_recon_loss: 2687569.7500; train_gene_expr_recon_loss: 703160.6944; train_masked_gp_l1_reg_loss: 5143.2859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36514.0946; train_chrom_access_recon_loss: 438798.8681; train_global_loss: 3905506.5833; train_optim_loss: 3905506.5833; val_kl_reg_loss: 33743.9922; val_edge_recon_loss: 2705189.0000; val_gene_expr_recon_loss: 706713.5000; val_masked_gp_l1_reg_loss: 5161.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35322.6289; val_chrom_access_recon_loss: 438604.1562; val_global_loss: 3924735.0000; val_optim_loss: 3924735.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9699; val_auprc_score: 0.9551; val_best_acc_score: 0.9259; val_best_f1_score: 0.9294; train_kl_reg_loss: 35393.6107; train_edge_recon_loss: 2677560.4444; train_gene_expr_recon_loss: 703400.0417; train_masked_gp_l1_reg_loss: 5180.9335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34440.5312; train_chrom_access_recon_loss: 437265.9861; train_global_loss: 3893241.6667; train_optim_loss: 3893241.6667; val_kl_reg_loss: 36353.7031; val_edge_recon_loss: 2696155.0000; val_gene_expr_recon_loss: 703758.9375; val_masked_gp_l1_reg_loss: 5195.4741; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33363.5586; val_chrom_access_recon_loss: 437848.0625; val_global_loss: 3912674.7500; val_optim_loss: 3912674.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9726; val_auprc_score: 0.9602; val_best_acc_score: 0.9283; val_best_f1_score: 0.9314; train_kl_reg_loss: 37413.4970; train_edge_recon_loss: 2679224.1389; train_gene_expr_recon_loss: 700899.9444; train_masked_gp_l1_reg_loss: 5213.9729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32559.9225; train_chrom_access_recon_loss: 438117.7083; train_global_loss: 3893429.2222; train_optim_loss: 3893429.2222; val_kl_reg_loss: 37979.2500; val_edge_recon_loss: 2688294.0000; val_gene_expr_recon_loss: 701869.5625; val_masked_gp_l1_reg_loss: 5230.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31576.3184; val_chrom_access_recon_loss: 437407.0312; val_global_loss: 3902356.2500; val_optim_loss: 3902356.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9717; val_auprc_score: 0.9587; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 39013.2135; train_edge_recon_loss: 2672679.4167; train_gene_expr_recon_loss: 696843.6736; train_masked_gp_l1_reg_loss: 5250.2123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30834.0145; train_chrom_access_recon_loss: 437272.6181; train_global_loss: 3881893.1389; train_optim_loss: 3881893.1389; val_kl_reg_loss: 38827.7578; val_edge_recon_loss: 2680512.7500; val_gene_expr_recon_loss: 699626.3750; val_masked_gp_l1_reg_loss: 5270.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29929.1309; val_chrom_access_recon_loss: 436842.6875; val_global_loss: 3891009.7500; val_optim_loss: 3891009.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9724; val_auprc_score: 0.9582; val_best_acc_score: 0.9318; val_best_f1_score: 0.9339; train_kl_reg_loss: 39060.7083; train_edge_recon_loss: 2671971.9722; train_gene_expr_recon_loss: 693310.8333; train_masked_gp_l1_reg_loss: 5290.1675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29253.2240; train_chrom_access_recon_loss: 437004.8750; train_global_loss: 3875891.6944; train_optim_loss: 3875891.6944; val_kl_reg_loss: 37901.2148; val_edge_recon_loss: 2670583.5000; val_gene_expr_recon_loss: 699649.0625; val_masked_gp_l1_reg_loss: 5306.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28422.4453; val_chrom_access_recon_loss: 436172.7500; val_global_loss: 3878035.7500; val_optim_loss: 3878035.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9773; val_auprc_score: 0.9695; val_best_acc_score: 0.9372; val_best_f1_score: 0.9392; train_kl_reg_loss: 35415.4253; train_edge_recon_loss: 2666390.8611; train_gene_expr_recon_loss: 1035822.0000; train_masked_gp_l1_reg_loss: 5339.9175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27622.3257; train_chrom_access_recon_loss: 462093.3889; train_global_loss: 4232683.8889; train_optim_loss: 4232683.8889; val_kl_reg_loss: 12784.8086; val_edge_recon_loss: 2660934.7500; val_gene_expr_recon_loss: 1030933.0000; val_masked_gp_l1_reg_loss: 5384.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26530.7930; val_chrom_access_recon_loss: 461416.2500; val_global_loss: 4197984.0000; val_optim_loss: 4197984.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9741; val_auprc_score: 0.9645; val_best_acc_score: 0.9353; val_best_f1_score: 0.9379; train_kl_reg_loss: 31106.8997; train_edge_recon_loss: 2652114.3333; train_gene_expr_recon_loss: 1029801.4167; train_masked_gp_l1_reg_loss: 5415.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25602.2574; train_chrom_access_recon_loss: 462377.5104; train_global_loss: 4206418.3056; train_optim_loss: 4206418.3056; val_kl_reg_loss: 11216.2783; val_edge_recon_loss: 2666939.5000; val_gene_expr_recon_loss: 1044297.3125; val_masked_gp_l1_reg_loss: 5452.5171; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24449.2383; val_chrom_access_recon_loss: 462434.6250; val_global_loss: 4214789.5000; val_optim_loss: 4214789.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9793; val_auprc_score: 0.9716; val_best_acc_score: 0.9388; val_best_f1_score: 0.9408; train_kl_reg_loss: 27794.2101; train_edge_recon_loss: 2661772.6111; train_gene_expr_recon_loss: 1024338.0764; train_masked_gp_l1_reg_loss: 5478.4523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23562.7630; train_chrom_access_recon_loss: 461826.3715; train_global_loss: 4204772.4167; train_optim_loss: 4204772.4167; val_kl_reg_loss: 11749.9062; val_edge_recon_loss: 2668664.7500; val_gene_expr_recon_loss: 1031720.9375; val_masked_gp_l1_reg_loss: 5509.7290; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22483.9805; val_chrom_access_recon_loss: 460933.2500; val_global_loss: 4201063.0000; val_optim_loss: 4201063.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9764; val_auprc_score: 0.9668; val_best_acc_score: 0.9355; val_best_f1_score: 0.9381; train_kl_reg_loss: 26598.8943; train_edge_recon_loss: 2656034.2778; train_gene_expr_recon_loss: 1019815.5833; train_masked_gp_l1_reg_loss: 5531.9201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21677.6094; train_chrom_access_recon_loss: 460989.2361; train_global_loss: 4190647.4444; train_optim_loss: 4190647.4444; val_kl_reg_loss: 11569.4570; val_edge_recon_loss: 2651547.5000; val_gene_expr_recon_loss: 1028572.6250; val_masked_gp_l1_reg_loss: 5558.6553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20703.3008; val_chrom_access_recon_loss: 460296.0000; val_global_loss: 4178247.5000; val_optim_loss: 4178247.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9767; val_auprc_score: 0.9658; val_best_acc_score: 0.9380; val_best_f1_score: 0.9400; train_kl_reg_loss: 25384.4651; train_edge_recon_loss: 2652090.0556; train_gene_expr_recon_loss: 1017894.5486; train_masked_gp_l1_reg_loss: 5550.1478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20580.7658; train_chrom_access_recon_loss: 460135.7639; train_global_loss: 4181635.7222; train_optim_loss: 4181635.7222; val_kl_reg_loss: 11741.4170; val_edge_recon_loss: 2660811.2500; val_gene_expr_recon_loss: 1025201.8750; val_masked_gp_l1_reg_loss: 5541.3530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20435.2852; val_chrom_access_recon_loss: 459982.8750; val_global_loss: 4183714.0000; val_optim_loss: 4183714.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9795; val_auprc_score: 0.9727; val_best_acc_score: 0.9413; val_best_f1_score: 0.9434; train_kl_reg_loss: 25255.6732; train_edge_recon_loss: 2647135.3889; train_gene_expr_recon_loss: 1011872.8194; train_masked_gp_l1_reg_loss: 5539.7074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20337.7574; train_chrom_access_recon_loss: 457942.6910; train_global_loss: 4168084.0833; train_optim_loss: 4168084.0833; val_kl_reg_loss: 11727.1357; val_edge_recon_loss: 2644503.0000; val_gene_expr_recon_loss: 1025886.1250; val_masked_gp_l1_reg_loss: 5537.0679; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20214.2949; val_chrom_access_recon_loss: 460115.6250; val_global_loss: 4167983.5000; val_optim_loss: 4167983.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9763; val_auprc_score: 0.9661; val_best_acc_score: 0.9360; val_best_f1_score: 0.9383; train_kl_reg_loss: 25160.2324; train_edge_recon_loss: 2644973.8611; train_gene_expr_recon_loss: 1016327.0069; train_masked_gp_l1_reg_loss: 5535.6021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20122.7830; train_chrom_access_recon_loss: 458955.1424; train_global_loss: 4171074.6944; train_optim_loss: 4171074.6944; val_kl_reg_loss: 11812.6680; val_edge_recon_loss: 2667207.7500; val_gene_expr_recon_loss: 1025194.7500; val_masked_gp_l1_reg_loss: 5534.1494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20010.8809; val_chrom_access_recon_loss: 459942.9688; val_global_loss: 4189703.5000; val_optim_loss: 4189703.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9793; val_auprc_score: 0.9719; val_best_acc_score: 0.9419; val_best_f1_score: 0.9436; train_kl_reg_loss: 25045.8783; train_edge_recon_loss: 2646752.5278; train_gene_expr_recon_loss: 1017241.2917; train_masked_gp_l1_reg_loss: 5533.7760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19925.1847; train_chrom_access_recon_loss: 458917.7951; train_global_loss: 4173416.4722; train_optim_loss: 4173416.4722; val_kl_reg_loss: 11813.4805; val_edge_recon_loss: 2665774.2500; val_gene_expr_recon_loss: 1025064.3750; val_masked_gp_l1_reg_loss: 5533.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19822.1836; val_chrom_access_recon_loss: 459833.7500; val_global_loss: 4187842.0000; val_optim_loss: 4187842.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9743
val AUPRC score: 0.9636
val best accuracy score: 0.9352
val best F1 score: 0.9374
val target rna MSE score: 3.9462
val source rna MSE score: 3.2572
val target atac MSE score: 0.1347
val source atac MSE score: 0.0212
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
