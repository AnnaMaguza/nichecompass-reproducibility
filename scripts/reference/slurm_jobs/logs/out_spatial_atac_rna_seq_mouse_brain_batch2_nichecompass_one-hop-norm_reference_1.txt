[True]
Run timestamp: 07092023_135041_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7633; val_auprc_score: 0.7807; val_best_acc_score: 0.5380; val_best_f1_score: 0.6815; train_kl_reg_loss: 52844.3445; train_edge_recon_loss: 3527950.8779; train_gene_expr_recon_loss: 12786142.8702; train_masked_gp_l1_reg_loss: 56969.8806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 638167.3464; train_chrom_access_recon_loss: 909691.1937; train_global_loss: 17971766.4504; train_optim_loss: 17971766.4504; val_kl_reg_loss: 78086.9974; val_edge_recon_loss: 4062840.0167; val_gene_expr_recon_loss: 11985799.1333; val_masked_gp_l1_reg_loss: 54456.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 334252.3438; val_chrom_access_recon_loss: 887287.5208; val_global_loss: 17402721.8667; val_optim_loss: 17402721.8667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8378; val_auprc_score: 0.8478; val_best_acc_score: 0.7522; val_best_f1_score: 0.7367; train_kl_reg_loss: 71415.9227; train_edge_recon_loss: 3504078.5248; train_gene_expr_recon_loss: 11876732.3206; train_masked_gp_l1_reg_loss: 54310.1849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202539.1187; train_chrom_access_recon_loss: 866957.6298; train_global_loss: 16576033.7328; train_optim_loss: 16576033.7328; val_kl_reg_loss: 64803.6982; val_edge_recon_loss: 4012440.1833; val_gene_expr_recon_loss: 11757221.1333; val_masked_gp_l1_reg_loss: 55388.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120322.8906; val_chrom_access_recon_loss: 869475.0375; val_global_loss: 16879652.3333; val_optim_loss: 16879652.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8837; val_auprc_score: 0.8719; val_best_acc_score: 0.8010; val_best_f1_score: 0.8203; train_kl_reg_loss: 52287.3345; train_edge_recon_loss: 3281924.0458; train_gene_expr_recon_loss: 11705938.1145; train_masked_gp_l1_reg_loss: 60575.2549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91945.8572; train_chrom_access_recon_loss: 857052.7581; train_global_loss: 16049723.3511; train_optim_loss: 16049723.3511; val_kl_reg_loss: 63109.0836; val_edge_recon_loss: 2955381.8833; val_gene_expr_recon_loss: 11638594.4667; val_masked_gp_l1_reg_loss: 69085.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72709.1953; val_chrom_access_recon_loss: 864680.8042; val_global_loss: 15663561.2667; val_optim_loss: 15663561.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9183; val_auprc_score: 0.9018; val_best_acc_score: 0.8471; val_best_f1_score: 0.8575; train_kl_reg_loss: 72136.8799; train_edge_recon_loss: 2881353.1889; train_gene_expr_recon_loss: 11583645.9008; train_masked_gp_l1_reg_loss: 71977.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60424.8233; train_chrom_access_recon_loss: 847190.1636; train_global_loss: 15516728.4504; train_optim_loss: 15516728.4504; val_kl_reg_loss: 77821.0604; val_edge_recon_loss: 2837613.9167; val_gene_expr_recon_loss: 11437214.8667; val_masked_gp_l1_reg_loss: 73638.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50855.7422; val_chrom_access_recon_loss: 854070.9625; val_global_loss: 15331215.8667; val_optim_loss: 15331215.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9336; val_auprc_score: 0.9201; val_best_acc_score: 0.8708; val_best_f1_score: 0.8773; train_kl_reg_loss: 82765.6287; train_edge_recon_loss: 2819118.4733; train_gene_expr_recon_loss: 11422894.5496; train_masked_gp_l1_reg_loss: 74083.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45102.0798; train_chrom_access_recon_loss: 838312.9423; train_global_loss: 15282277.1221; train_optim_loss: 15282277.1221; val_kl_reg_loss: 81529.1062; val_edge_recon_loss: 2785448.9167; val_gene_expr_recon_loss: 11330972.9333; val_masked_gp_l1_reg_loss: 74850.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40774.8008; val_chrom_access_recon_loss: 845928.2292; val_global_loss: 15159504.1333; val_optim_loss: 15159504.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9355; val_auprc_score: 0.9238; val_best_acc_score: 0.8715; val_best_f1_score: 0.8787; train_kl_reg_loss: 82928.5029; train_edge_recon_loss: 2793926.1565; train_gene_expr_recon_loss: 11305500.4656; train_masked_gp_l1_reg_loss: 75513.5958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37973.8166; train_chrom_access_recon_loss: 831490.0515; train_global_loss: 15127332.7099; train_optim_loss: 15127332.7099; val_kl_reg_loss: 78462.7760; val_edge_recon_loss: 2808578.0667; val_gene_expr_recon_loss: 11236017.5333; val_masked_gp_l1_reg_loss: 76443.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36116.4258; val_chrom_access_recon_loss: 839321.2792; val_global_loss: 15074938.8000; val_optim_loss: 15074938.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9383; val_auprc_score: 0.9253; val_best_acc_score: 0.8760; val_best_f1_score: 0.8820; train_kl_reg_loss: 81057.1370; train_edge_recon_loss: 2780225.9084; train_gene_expr_recon_loss: 11204035.9771; train_masked_gp_l1_reg_loss: 77165.2204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34920.8952; train_chrom_access_recon_loss: 823819.8125; train_global_loss: 15001225.0611; train_optim_loss: 15001225.0611; val_kl_reg_loss: 78625.1635; val_edge_recon_loss: 2793554.4500; val_gene_expr_recon_loss: 11113044.3333; val_masked_gp_l1_reg_loss: 77909.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34066.8047; val_chrom_access_recon_loss: 831706.1042; val_global_loss: 14928907.0000; val_optim_loss: 14928907.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9363; val_auprc_score: 0.9199; val_best_acc_score: 0.8769; val_best_f1_score: 0.8841; train_kl_reg_loss: 77706.4200; train_edge_recon_loss: 2774354.5802; train_gene_expr_recon_loss: 11121457.5802; train_masked_gp_l1_reg_loss: 78629.0742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33165.8551; train_chrom_access_recon_loss: 818261.1431; train_global_loss: 14903574.6489; train_optim_loss: 14903574.6489; val_kl_reg_loss: 74912.6833; val_edge_recon_loss: 2786057.4833; val_gene_expr_recon_loss: 11110971.5333; val_masked_gp_l1_reg_loss: 79532.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32836.2227; val_chrom_access_recon_loss: 826924.5000; val_global_loss: 14911234.2667; val_optim_loss: 14911234.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9444; val_auprc_score: 0.9301; val_best_acc_score: 0.8840; val_best_f1_score: 0.8899; train_kl_reg_loss: 73124.7742; train_edge_recon_loss: 2764435.6947; train_gene_expr_recon_loss: 11038458.3817; train_masked_gp_l1_reg_loss: 80272.0228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31630.3397; train_chrom_access_recon_loss: 812589.2948; train_global_loss: 14800510.5191; train_optim_loss: 14800510.5191; val_kl_reg_loss: 71846.7120; val_edge_recon_loss: 2763740.9000; val_gene_expr_recon_loss: 11012148.9333; val_masked_gp_l1_reg_loss: 81373.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31290.4902; val_chrom_access_recon_loss: 825711.3792; val_global_loss: 14786110.8667; val_optim_loss: 14786110.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9476; val_auprc_score: 0.9353; val_best_acc_score: 0.8888; val_best_f1_score: 0.8924; train_kl_reg_loss: 72709.0435; train_edge_recon_loss: 2757321.7710; train_gene_expr_recon_loss: 10969788.7328; train_masked_gp_l1_reg_loss: 81878.2288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30366.9351; train_chrom_access_recon_loss: 807591.7500; train_global_loss: 14719656.4733; train_optim_loss: 14719656.4733; val_kl_reg_loss: 70637.5396; val_edge_recon_loss: 2756310.7667; val_gene_expr_recon_loss: 10937373.6000; val_masked_gp_l1_reg_loss: 82564.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30173.6855; val_chrom_access_recon_loss: 817084.5917; val_global_loss: 14694144.5333; val_optim_loss: 14694144.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9466; val_auprc_score: 0.9345; val_best_acc_score: 0.8853; val_best_f1_score: 0.8905; train_kl_reg_loss: 71116.4092; train_edge_recon_loss: 2755267.4676; train_gene_expr_recon_loss: 10908250.2977; train_masked_gp_l1_reg_loss: 83096.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29308.2131; train_chrom_access_recon_loss: 803127.8464; train_global_loss: 14650166.5344; train_optim_loss: 14650166.5344; val_kl_reg_loss: 69862.6578; val_edge_recon_loss: 2770991.3167; val_gene_expr_recon_loss: 10870538.3333; val_masked_gp_l1_reg_loss: 83844.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28741.5527; val_chrom_access_recon_loss: 815916.8083; val_global_loss: 14639895.2000; val_optim_loss: 14639895.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9466; val_auprc_score: 0.9329; val_best_acc_score: 0.8874; val_best_f1_score: 0.8931; train_kl_reg_loss: 70425.5637; train_edge_recon_loss: 2738400.8092; train_gene_expr_recon_loss: 10850595.7557; train_masked_gp_l1_reg_loss: 84199.4337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28312.2683; train_chrom_access_recon_loss: 798584.6584; train_global_loss: 14570518.4809; train_optim_loss: 14570518.4809; val_kl_reg_loss: 67801.5378; val_edge_recon_loss: 2745649.6333; val_gene_expr_recon_loss: 10792916.5333; val_masked_gp_l1_reg_loss: 84894.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28191.0059; val_chrom_access_recon_loss: 807942.0667; val_global_loss: 14527395.8000; val_optim_loss: 14527395.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9544; val_auprc_score: 0.9442; val_best_acc_score: 0.8973; val_best_f1_score: 0.8997; train_kl_reg_loss: 69067.4480; train_edge_recon_loss: 2727433.2844; train_gene_expr_recon_loss: 10817647.7405; train_masked_gp_l1_reg_loss: 85517.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27582.2721; train_chrom_access_recon_loss: 796467.6250; train_global_loss: 14523716.0229; train_optim_loss: 14523716.0229; val_kl_reg_loss: 66735.6578; val_edge_recon_loss: 2745984.0667; val_gene_expr_recon_loss: 10774438.8000; val_masked_gp_l1_reg_loss: 85976.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27441.6758; val_chrom_access_recon_loss: 807130.5625; val_global_loss: 14507708.2667; val_optim_loss: 14507708.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9527; val_auprc_score: 0.9384; val_best_acc_score: 0.8941; val_best_f1_score: 0.8988; train_kl_reg_loss: 68467.3549; train_edge_recon_loss: 2718155.8092; train_gene_expr_recon_loss: 10769946.9313; train_masked_gp_l1_reg_loss: 86529.5813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27075.1839; train_chrom_access_recon_loss: 793143.9990; train_global_loss: 14463318.8397; train_optim_loss: 14463318.8397; val_kl_reg_loss: 69241.9919; val_edge_recon_loss: 2731560.0500; val_gene_expr_recon_loss: 10735274.0667; val_masked_gp_l1_reg_loss: 86917.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26731.4824; val_chrom_access_recon_loss: 802554.7750; val_global_loss: 14452279.8000; val_optim_loss: 14452279.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9575; val_auprc_score: 0.9478; val_best_acc_score: 0.8957; val_best_f1_score: 0.8992; train_kl_reg_loss: 67335.3922; train_edge_recon_loss: 2707851.9256; train_gene_expr_recon_loss: 10736154.7863; train_masked_gp_l1_reg_loss: 87512.2242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26627.3942; train_chrom_access_recon_loss: 790299.1985; train_global_loss: 14415780.9618; train_optim_loss: 14415780.9618; val_kl_reg_loss: 66652.9797; val_edge_recon_loss: 2714613.0167; val_gene_expr_recon_loss: 10683798.4000; val_masked_gp_l1_reg_loss: 88165.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26510.8984; val_chrom_access_recon_loss: 799747.8750; val_global_loss: 14379489.0000; val_optim_loss: 14379489.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9626; val_auprc_score: 0.9540; val_best_acc_score: 0.9023; val_best_f1_score: 0.9047; train_kl_reg_loss: 67606.0670; train_edge_recon_loss: 2698943.8950; train_gene_expr_recon_loss: 10686723.7786; train_masked_gp_l1_reg_loss: 88488.1645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26263.3968; train_chrom_access_recon_loss: 786850.4933; train_global_loss: 14354875.8626; train_optim_loss: 14354875.8626; val_kl_reg_loss: 66639.4180; val_edge_recon_loss: 2702771.7500; val_gene_expr_recon_loss: 10649760.4000; val_masked_gp_l1_reg_loss: 88976.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26078.0039; val_chrom_access_recon_loss: 796861.7208; val_global_loss: 14331088.1333; val_optim_loss: 14331088.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9619; val_auprc_score: 0.9516; val_best_acc_score: 0.9092; val_best_f1_score: 0.9124; train_kl_reg_loss: 66411.3907; train_edge_recon_loss: 2700478.8263; train_gene_expr_recon_loss: 10651854.5344; train_masked_gp_l1_reg_loss: 89402.4753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25891.8081; train_chrom_access_recon_loss: 783955.4957; train_global_loss: 14317994.5267; train_optim_loss: 14317994.5267; val_kl_reg_loss: 65265.2948; val_edge_recon_loss: 2700568.2333; val_gene_expr_recon_loss: 10646688.2667; val_masked_gp_l1_reg_loss: 89912.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25996.3008; val_chrom_access_recon_loss: 793905.4875; val_global_loss: 14322336.1333; val_optim_loss: 14322336.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9643; val_auprc_score: 0.9526; val_best_acc_score: 0.9101; val_best_f1_score: 0.9129; train_kl_reg_loss: 66648.8140; train_edge_recon_loss: 2695579.8149; train_gene_expr_recon_loss: 10622356.7481; train_masked_gp_l1_reg_loss: 90214.7480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25721.0824; train_chrom_access_recon_loss: 782009.8507; train_global_loss: 14282531.1450; train_optim_loss: 14282531.1450; val_kl_reg_loss: 68481.4156; val_edge_recon_loss: 2690434.0000; val_gene_expr_recon_loss: 10585817.3333; val_masked_gp_l1_reg_loss: 90561.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25644.5098; val_chrom_access_recon_loss: 789646.8875; val_global_loss: 14250586.6000; val_optim_loss: 14250586.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9650; val_auprc_score: 0.9526; val_best_acc_score: 0.9093; val_best_f1_score: 0.9115; train_kl_reg_loss: 65592.9391; train_edge_recon_loss: 2689708.1355; train_gene_expr_recon_loss: 10592623.9466; train_masked_gp_l1_reg_loss: 90867.4273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25357.0262; train_chrom_access_recon_loss: 779680.4294; train_global_loss: 14243829.8931; train_optim_loss: 14243829.8931; val_kl_reg_loss: 62582.2547; val_edge_recon_loss: 2700019.1167; val_gene_expr_recon_loss: 10561626.1333; val_masked_gp_l1_reg_loss: 91330.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25609.0273; val_chrom_access_recon_loss: 790826.9833; val_global_loss: 14231993.4667; val_optim_loss: 14231993.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9659; val_auprc_score: 0.9570; val_best_acc_score: 0.9113; val_best_f1_score: 0.9154; train_kl_reg_loss: 65089.3411; train_edge_recon_loss: 2691146.9580; train_gene_expr_recon_loss: 10575227.4809; train_masked_gp_l1_reg_loss: 91538.5012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25178.3723; train_chrom_access_recon_loss: 777796.3302; train_global_loss: 14225977.0611; train_optim_loss: 14225977.0611; val_kl_reg_loss: 63585.6297; val_edge_recon_loss: 2698499.0000; val_gene_expr_recon_loss: 10533354.7333; val_masked_gp_l1_reg_loss: 91799.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25101.8984; val_chrom_access_recon_loss: 787247.6000; val_global_loss: 14199588.8000; val_optim_loss: 14199588.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9712; val_auprc_score: 0.9639; val_best_acc_score: 0.9193; val_best_f1_score: 0.9218; train_kl_reg_loss: 65699.1594; train_edge_recon_loss: 2683276.5363; train_gene_expr_recon_loss: 10539336.2824; train_masked_gp_l1_reg_loss: 91954.6612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24849.5135; train_chrom_access_recon_loss: 775497.1775; train_global_loss: 14180613.4046; train_optim_loss: 14180613.4046; val_kl_reg_loss: 64265.7607; val_edge_recon_loss: 2675837.4167; val_gene_expr_recon_loss: 10504085.8667; val_masked_gp_l1_reg_loss: 92340.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24772.1895; val_chrom_access_recon_loss: 785147.9208; val_global_loss: 14146449.0000; val_optim_loss: 14146449.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9657; val_auprc_score: 0.9559; val_best_acc_score: 0.9113; val_best_f1_score: 0.9152; train_kl_reg_loss: 64322.1782; train_edge_recon_loss: 2686346.8989; train_gene_expr_recon_loss: 10527731.6565; train_masked_gp_l1_reg_loss: 92483.2786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24762.1087; train_chrom_access_recon_loss: 774553.3960; train_global_loss: 14170199.4580; train_optim_loss: 14170199.4580; val_kl_reg_loss: 62816.0615; val_edge_recon_loss: 2709416.7333; val_gene_expr_recon_loss: 10472081.2000; val_masked_gp_l1_reg_loss: 92631.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24580.7148; val_chrom_access_recon_loss: 783862.6708; val_global_loss: 14145388.5333; val_optim_loss: 14145388.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9711; val_auprc_score: 0.9631; val_best_acc_score: 0.9217; val_best_f1_score: 0.9245; train_kl_reg_loss: 64341.0067; train_edge_recon_loss: 2678501.0954; train_gene_expr_recon_loss: 10502164.8779; train_masked_gp_l1_reg_loss: 92975.8340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24635.6807; train_chrom_access_recon_loss: 773021.7839; train_global_loss: 14135640.2901; train_optim_loss: 14135640.2901; val_kl_reg_loss: 64081.2919; val_edge_recon_loss: 2692739.9500; val_gene_expr_recon_loss: 10503103.2667; val_masked_gp_l1_reg_loss: 93154.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24538.3828; val_chrom_access_recon_loss: 786126.8042; val_global_loss: 14163744.1333; val_optim_loss: 14163744.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9744; val_auprc_score: 0.9677; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 64069.2093; train_edge_recon_loss: 2680571.9599; train_gene_expr_recon_loss: 10487266.4351; train_masked_gp_l1_reg_loss: 93467.3445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24506.7047; train_chrom_access_recon_loss: 771836.6078; train_global_loss: 14121718.3206; train_optim_loss: 14121718.3206; val_kl_reg_loss: 62357.9073; val_edge_recon_loss: 2675604.0833; val_gene_expr_recon_loss: 10465785.2667; val_masked_gp_l1_reg_loss: 93701.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24673.4961; val_chrom_access_recon_loss: 782294.3958; val_global_loss: 14104415.8000; val_optim_loss: 14104415.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9723; val_auprc_score: 0.9647; val_best_acc_score: 0.9270; val_best_f1_score: 0.9285; train_kl_reg_loss: 62783.9219; train_edge_recon_loss: 2673122.7691; train_gene_expr_recon_loss: 10462856.8244; train_masked_gp_l1_reg_loss: 93992.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24484.2134; train_chrom_access_recon_loss: 769644.4084; train_global_loss: 14086884.5115; train_optim_loss: 14086884.5115; val_kl_reg_loss: 61938.8044; val_edge_recon_loss: 2686145.1167; val_gene_expr_recon_loss: 10476102.8667; val_masked_gp_l1_reg_loss: 94209.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24468.1523; val_chrom_access_recon_loss: 781343.5917; val_global_loss: 14124208.4000; val_optim_loss: 14124208.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9720; val_auprc_score: 0.9630; val_best_acc_score: 0.9224; val_best_f1_score: 0.9264; train_kl_reg_loss: 69875.1918; train_edge_recon_loss: 2697513.6889; train_gene_expr_recon_loss: 10229181.2824; train_masked_gp_l1_reg_loss: 92929.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21288.7177; train_chrom_access_recon_loss: 754077.9136; train_global_loss: 13864866.7481; train_optim_loss: 13864866.7481; val_kl_reg_loss: 43138.7578; val_edge_recon_loss: 2704069.7833; val_gene_expr_recon_loss: 10175284.4000; val_masked_gp_l1_reg_loss: 92783.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20919.8008; val_chrom_access_recon_loss: 758863.1167; val_global_loss: 13795058.9333; val_optim_loss: 13795058.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9731; val_auprc_score: 0.9663; val_best_acc_score: 0.9245; val_best_f1_score: 0.9258; train_kl_reg_loss: 65988.6801; train_edge_recon_loss: 2683895.2576; train_gene_expr_recon_loss: 10188012.6565; train_masked_gp_l1_reg_loss: 92933.3214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21082.0584; train_chrom_access_recon_loss: 751084.0544; train_global_loss: 13802996.0153; train_optim_loss: 13802996.0153; val_kl_reg_loss: 46262.8492; val_edge_recon_loss: 2706636.9833; val_gene_expr_recon_loss: 10154940.4667; val_masked_gp_l1_reg_loss: 93016.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21169.3184; val_chrom_access_recon_loss: 759619.9292; val_global_loss: 13781645.1333; val_optim_loss: 13781645.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9726; val_auprc_score: 0.9630; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 63415.9052; train_edge_recon_loss: 2675178.4981; train_gene_expr_recon_loss: 10171145.2366; train_masked_gp_l1_reg_loss: 93061.3734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21286.7190; train_chrom_access_recon_loss: 749930.8259; train_global_loss: 13774018.5344; train_optim_loss: 13774018.5344; val_kl_reg_loss: 48933.7727; val_edge_recon_loss: 2682872.4500; val_gene_expr_recon_loss: 10119816.1333; val_masked_gp_l1_reg_loss: 93066.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21362.8320; val_chrom_access_recon_loss: 757979.7167; val_global_loss: 13724032.0667; val_optim_loss: 13724032.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9756; val_auprc_score: 0.9694; val_best_acc_score: 0.9285; val_best_f1_score: 0.9306; train_kl_reg_loss: 60148.2377; train_edge_recon_loss: 2672501.3664; train_gene_expr_recon_loss: 10152899.5802; train_masked_gp_l1_reg_loss: 93021.7790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21444.7428; train_chrom_access_recon_loss: 748880.6670; train_global_loss: 13748896.3359; train_optim_loss: 13748896.3359; val_kl_reg_loss: 50566.5602; val_edge_recon_loss: 2691913.4000; val_gene_expr_recon_loss: 10126871.4667; val_masked_gp_l1_reg_loss: 92977.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21476.5137; val_chrom_access_recon_loss: 757475.2458; val_global_loss: 13741280.5333; val_optim_loss: 13741280.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9768; val_auprc_score: 0.9707; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 58834.3379; train_edge_recon_loss: 2670536.3302; train_gene_expr_recon_loss: 10137363.5038; train_masked_gp_l1_reg_loss: 92900.2562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21516.4404; train_chrom_access_recon_loss: 747390.6131; train_global_loss: 13728541.4809; train_optim_loss: 13728541.4809; val_kl_reg_loss: 49442.4318; val_edge_recon_loss: 2683232.5667; val_gene_expr_recon_loss: 10111117.2000; val_masked_gp_l1_reg_loss: 92902.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21551.9043; val_chrom_access_recon_loss: 756036.9125; val_global_loss: 13714284.2000; val_optim_loss: 13714284.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9773; val_auprc_score: 0.9724; val_best_acc_score: 0.9329; val_best_f1_score: 0.9345; train_kl_reg_loss: 58456.4573; train_edge_recon_loss: 2672006.5401; train_gene_expr_recon_loss: 10121847.4733; train_masked_gp_l1_reg_loss: 92793.8850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21620.0946; train_chrom_access_recon_loss: 746558.5181; train_global_loss: 13713282.9695; train_optim_loss: 13713282.9695; val_kl_reg_loss: 51238.4953; val_edge_recon_loss: 2677387.7000; val_gene_expr_recon_loss: 10078464.4000; val_masked_gp_l1_reg_loss: 92650.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21622.8281; val_chrom_access_recon_loss: 753728.1500; val_global_loss: 13675092.7333; val_optim_loss: 13675092.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9758; val_auprc_score: 0.9675; val_best_acc_score: 0.9325; val_best_f1_score: 0.9347; train_kl_reg_loss: 57505.2988; train_edge_recon_loss: 2669000.9828; train_gene_expr_recon_loss: 10092815.8855; train_masked_gp_l1_reg_loss: 92561.3022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21625.8430; train_chrom_access_recon_loss: 744263.6083; train_global_loss: 13677772.9542; train_optim_loss: 13677772.9542; val_kl_reg_loss: 48767.4589; val_edge_recon_loss: 2658592.5333; val_gene_expr_recon_loss: 10065168.7333; val_masked_gp_l1_reg_loss: 92484.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21687.9238; val_chrom_access_recon_loss: 752699.1875; val_global_loss: 13639400.8667; val_optim_loss: 13639400.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9791; val_auprc_score: 0.9736; val_best_acc_score: 0.9337; val_best_f1_score: 0.9351; train_kl_reg_loss: 56454.7858; train_edge_recon_loss: 2665309.6908; train_gene_expr_recon_loss: 10088695.8015; train_masked_gp_l1_reg_loss: 92515.2003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21681.9338; train_chrom_access_recon_loss: 744048.0897; train_global_loss: 13668705.5725; train_optim_loss: 13668705.5725; val_kl_reg_loss: 51800.9492; val_edge_recon_loss: 2674019.2000; val_gene_expr_recon_loss: 10071393.6667; val_masked_gp_l1_reg_loss: 92540.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21739.4980; val_chrom_access_recon_loss: 754010.3875; val_global_loss: 13665504.2667; val_optim_loss: 13665504.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9735; val_auprc_score: 0.9642; val_best_acc_score: 0.9278; val_best_f1_score: 0.9299; train_kl_reg_loss: 56034.7012; train_edge_recon_loss: 2667536.2385; train_gene_expr_recon_loss: 10081700.0305; train_masked_gp_l1_reg_loss: 92510.5833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21748.9684; train_chrom_access_recon_loss: 743538.8640; train_global_loss: 13663069.4122; train_optim_loss: 13663069.4122; val_kl_reg_loss: 53298.6245; val_edge_recon_loss: 2701920.2167; val_gene_expr_recon_loss: 10075218.3333; val_masked_gp_l1_reg_loss: 92389.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21681.3477; val_chrom_access_recon_loss: 753824.8583; val_global_loss: 13698332.9333; val_optim_loss: 13698332.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9801; val_auprc_score: 0.9744; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 55307.2082; train_edge_recon_loss: 2662902.1336; train_gene_expr_recon_loss: 10067061.1679; train_masked_gp_l1_reg_loss: 92410.5292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21753.5887; train_chrom_access_recon_loss: 740827.5520; train_global_loss: 13640262.2366; train_optim_loss: 13640262.2366; val_kl_reg_loss: 52654.6781; val_edge_recon_loss: 2664388.5167; val_gene_expr_recon_loss: 10119170.0667; val_masked_gp_l1_reg_loss: 92386.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21759.6191; val_chrom_access_recon_loss: 753524.4417; val_global_loss: 13703884.7333; val_optim_loss: 13703884.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9777; val_auprc_score: 0.9702; val_best_acc_score: 0.9364; val_best_f1_score: 0.9386; train_kl_reg_loss: 55232.4273; train_edge_recon_loss: 2665809.1870; train_gene_expr_recon_loss: 10056496.2443; train_masked_gp_l1_reg_loss: 92387.6332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21771.8470; train_chrom_access_recon_loss: 741191.2362; train_global_loss: 13632888.6336; train_optim_loss: 13632888.6336; val_kl_reg_loss: 52154.3510; val_edge_recon_loss: 2682798.6667; val_gene_expr_recon_loss: 10054724.1333; val_masked_gp_l1_reg_loss: 92289.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21752.7520; val_chrom_access_recon_loss: 750865.4500; val_global_loss: 13654585.5333; val_optim_loss: 13654585.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9768; val_auprc_score: 0.9673; val_best_acc_score: 0.9355; val_best_f1_score: 0.9376; train_kl_reg_loss: 55352.0297; train_edge_recon_loss: 2661788.8683; train_gene_expr_recon_loss: 10047700.0611; train_masked_gp_l1_reg_loss: 91570.9312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19867.0163; train_chrom_access_recon_loss: 739977.4609; train_global_loss: 13616256.2748; train_optim_loss: 13616256.2748; val_kl_reg_loss: 53691.0471; val_edge_recon_loss: 2682540.1000; val_gene_expr_recon_loss: 9995589.6667; val_masked_gp_l1_reg_loss: 91273.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19543.7168; val_chrom_access_recon_loss: 747450.8542; val_global_loss: 13590088.6667; val_optim_loss: 13590088.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9785; val_auprc_score: 0.9711; val_best_acc_score: 0.9378; val_best_f1_score: 0.9398; train_kl_reg_loss: 56637.5264; train_edge_recon_loss: 2655869.9885; train_gene_expr_recon_loss: 10040777.1527; train_masked_gp_l1_reg_loss: 91194.1060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19446.9402; train_chrom_access_recon_loss: 739729.1264; train_global_loss: 13603654.8092; train_optim_loss: 13603654.8092; val_kl_reg_loss: 54512.9818; val_edge_recon_loss: 2675023.8500; val_gene_expr_recon_loss: 10071762.2667; val_masked_gp_l1_reg_loss: 91123.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19345.6367; val_chrom_access_recon_loss: 751605.9583; val_global_loss: 13663375.2000; val_optim_loss: 13663375.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9778; val_auprc_score: 0.9714; val_best_acc_score: 0.9369; val_best_f1_score: 0.9390; train_kl_reg_loss: 56868.5764; train_edge_recon_loss: 2661449.3225; train_gene_expr_recon_loss: 10036749.0076; train_masked_gp_l1_reg_loss: 91086.0440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19284.9215; train_chrom_access_recon_loss: 739240.7848; train_global_loss: 13604678.5802; train_optim_loss: 13604678.5802; val_kl_reg_loss: 54437.9273; val_edge_recon_loss: 2671133.7000; val_gene_expr_recon_loss: 10004392.8000; val_masked_gp_l1_reg_loss: 91061.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19222.9316; val_chrom_access_recon_loss: 750163.1208; val_global_loss: 13590412.6000; val_optim_loss: 13590412.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9785; val_auprc_score: 0.9715; val_best_acc_score: 0.9391; val_best_f1_score: 0.9411; train_kl_reg_loss: 56671.3771; train_edge_recon_loss: 2662072.9809; train_gene_expr_recon_loss: 10036419.1908; train_masked_gp_l1_reg_loss: 91046.5803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19177.8435; train_chrom_access_recon_loss: 739688.2925; train_global_loss: 13605076.3206; train_optim_loss: 13605076.3206; val_kl_reg_loss: 54196.2833; val_edge_recon_loss: 2658953.4333; val_gene_expr_recon_loss: 10061364.0000; val_masked_gp_l1_reg_loss: 91021.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19124.8984; val_chrom_access_recon_loss: 753855.8958; val_global_loss: 13638516.7333; val_optim_loss: 13638516.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9766; val_auprc_score: 0.9703; val_best_acc_score: 0.9349; val_best_f1_score: 0.9367; train_kl_reg_loss: 56721.0530; train_edge_recon_loss: 2655005.2252; train_gene_expr_recon_loss: 10033817.7786; train_masked_gp_l1_reg_loss: 91020.1548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19083.9918; train_chrom_access_recon_loss: 739071.0200; train_global_loss: 13594719.2137; train_optim_loss: 13594719.2137; val_kl_reg_loss: 54483.3768; val_edge_recon_loss: 2662960.0833; val_gene_expr_recon_loss: 10048704.8667; val_masked_gp_l1_reg_loss: 90992.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19039.0957; val_chrom_access_recon_loss: 753399.0000; val_global_loss: 13629578.3333; val_optim_loss: 13629578.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9777; val_auprc_score: 0.9665; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 56727.6452; train_edge_recon_loss: 2661076.4962; train_gene_expr_recon_loss: 10026173.8168; train_masked_gp_l1_reg_loss: 90924.1806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18850.1747; train_chrom_access_recon_loss: 739595.4967; train_global_loss: 13593347.7939; train_optim_loss: 13593347.7939; val_kl_reg_loss: 54712.5841; val_edge_recon_loss: 2672298.1333; val_gene_expr_recon_loss: 9982234.4667; val_masked_gp_l1_reg_loss: 90892.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18823.3184; val_chrom_access_recon_loss: 747583.2708; val_global_loss: 13566544.4667; val_optim_loss: 13566544.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9808; val_auprc_score: 0.9765; val_best_acc_score: 0.9382; val_best_f1_score: 0.9397; train_kl_reg_loss: 56859.0409; train_edge_recon_loss: 2657809.2653; train_gene_expr_recon_loss: 10036646.2977; train_masked_gp_l1_reg_loss: 90880.2972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18813.5993; train_chrom_access_recon_loss: 740536.6393; train_global_loss: 13601545.1679; train_optim_loss: 13601545.1679; val_kl_reg_loss: 54704.8490; val_edge_recon_loss: 2668051.9500; val_gene_expr_recon_loss: 10037423.3333; val_masked_gp_l1_reg_loss: 90871.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18804.7051; val_chrom_access_recon_loss: 753248.5125; val_global_loss: 13623104.6000; val_optim_loss: 13623104.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9792; val_auprc_score: 0.9748; val_best_acc_score: 0.9376; val_best_f1_score: 0.9393; train_kl_reg_loss: 57026.9207; train_edge_recon_loss: 2657589.0191; train_gene_expr_recon_loss: 10029602.7176; train_masked_gp_l1_reg_loss: 90864.6389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18796.5766; train_chrom_access_recon_loss: 739124.3449; train_global_loss: 13593004.3282; train_optim_loss: 13593004.3282; val_kl_reg_loss: 55019.6378; val_edge_recon_loss: 2659113.5167; val_gene_expr_recon_loss: 10054233.2667; val_masked_gp_l1_reg_loss: 90856.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18788.7969; val_chrom_access_recon_loss: 749324.8542; val_global_loss: 13627337.1333; val_optim_loss: 13627337.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9802; val_auprc_score: 0.9713; val_best_acc_score: 0.9426; val_best_f1_score: 0.9440; train_kl_reg_loss: 56931.4014; train_edge_recon_loss: 2661240.8664; train_gene_expr_recon_loss: 10033906.5878; train_masked_gp_l1_reg_loss: 90852.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18782.7102; train_chrom_access_recon_loss: 739111.6355; train_global_loss: 13600825.9695; train_optim_loss: 13600825.9695; val_kl_reg_loss: 54553.1021; val_edge_recon_loss: 2648580.7167; val_gene_expr_recon_loss: 10017624.2000; val_masked_gp_l1_reg_loss: 90848.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18775.6172; val_chrom_access_recon_loss: 749902.6292; val_global_loss: 13580284.6667; val_optim_loss: 13580284.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9804; val_auprc_score: 0.9719; val_best_acc_score: 0.9410; val_best_f1_score: 0.9431; train_kl_reg_loss: 56730.1851; train_edge_recon_loss: 2663591.0153; train_gene_expr_recon_loss: 10026741.4733; train_masked_gp_l1_reg_loss: 90844.5302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18769.4342; train_chrom_access_recon_loss: 739113.5887; train_global_loss: 13595790.2290; train_optim_loss: 13595790.2290; val_kl_reg_loss: 54707.2935; val_edge_recon_loss: 2656576.8000; val_gene_expr_recon_loss: 10041462.6667; val_masked_gp_l1_reg_loss: 90842.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18763.3672; val_chrom_access_recon_loss: 752713.7958; val_global_loss: 13615065.4000; val_optim_loss: 13615065.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9785; val_auprc_score: 0.9717; val_best_acc_score: 0.9379; val_best_f1_score: 0.9400; train_kl_reg_loss: 56776.1296; train_edge_recon_loss: 2664369.5344; train_gene_expr_recon_loss: 10033338.9237; train_masked_gp_l1_reg_loss: 90834.9586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18744.0850; train_chrom_access_recon_loss: 739335.1951; train_global_loss: 13603398.8244; train_optim_loss: 13603398.8244; val_kl_reg_loss: 54799.1055; val_edge_recon_loss: 2666642.7833; val_gene_expr_recon_loss: 9998554.7333; val_masked_gp_l1_reg_loss: 90831.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18741.4141; val_chrom_access_recon_loss: 749994.6208; val_global_loss: 13579563.2667; val_optim_loss: 13579563.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9798; val_auprc_score: 0.9733; val_best_acc_score: 0.9399; val_best_f1_score: 0.9415; train_kl_reg_loss: 56706.5062; train_edge_recon_loss: 2659342.3492; train_gene_expr_recon_loss: 10029146.7939; train_masked_gp_l1_reg_loss: 90829.8204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18740.5858; train_chrom_access_recon_loss: 739139.5239; train_global_loss: 13593905.5802; train_optim_loss: 13593905.5802; val_kl_reg_loss: 54675.8987; val_edge_recon_loss: 2656916.6333; val_gene_expr_recon_loss: 10087206.8667; val_masked_gp_l1_reg_loss: 90828.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18739.6172; val_chrom_access_recon_loss: 752143.6125; val_global_loss: 13660511.9333; val_optim_loss: 13660511.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9791; val_auprc_score: 0.9729; val_best_acc_score: 0.9410; val_best_f1_score: 0.9428; train_kl_reg_loss: 56779.6609; train_edge_recon_loss: 2658448.8531; train_gene_expr_recon_loss: 10031622.1756; train_masked_gp_l1_reg_loss: 90827.6283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18738.8167; train_chrom_access_recon_loss: 739357.7529; train_global_loss: 13595774.7634; train_optim_loss: 13595774.7634; val_kl_reg_loss: 54633.6982; val_edge_recon_loss: 2661296.2167; val_gene_expr_recon_loss: 10029183.8000; val_masked_gp_l1_reg_loss: 90826.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18738.0332; val_chrom_access_recon_loss: 750629.9417; val_global_loss: 13605308.7333; val_optim_loss: 13605308.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9802; val_auprc_score: 0.9743; val_best_acc_score: 0.9403; val_best_f1_score: 0.9418; train_kl_reg_loss: 56747.0328; train_edge_recon_loss: 2655543.5859; train_gene_expr_recon_loss: 10029237.3359; train_masked_gp_l1_reg_loss: 90826.1973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18737.3128; train_chrom_access_recon_loss: 739253.0024; train_global_loss: 13590344.6489; train_optim_loss: 13590344.6489; val_kl_reg_loss: 54699.8719; val_edge_recon_loss: 2661983.7167; val_gene_expr_recon_loss: 9998906.0667; val_masked_gp_l1_reg_loss: 90825.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18736.5645; val_chrom_access_recon_loss: 747960.3667; val_global_loss: 13573112.8667; val_optim_loss: 13573112.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 57 min 45 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9787
val AUPRC score: 0.9695
val best accuracy score: 0.9365
val best F1 score: 0.9390
val target rna MSE score: 1.2053
val source rna MSE score: 0.2644
val target atac MSE score: 0.5037
val source atac MSE score: 0.0810
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
