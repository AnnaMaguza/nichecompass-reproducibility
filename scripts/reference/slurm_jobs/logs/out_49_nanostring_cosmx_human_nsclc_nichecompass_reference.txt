[True, False, True]
Run timestamp: 19102023_172905_49.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50.0', '--lambda_l1_addon', '500.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_49']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9049; val_auprc_score: 0.9788; val_best_acc_score: 0.9066; val_best_f1_score: 0.9468; train_kl_reg_loss: 27701.4478; train_edge_recon_loss: 8219635.3921; train_gene_expr_recon_loss: 27797128.6868; train_masked_gp_l1_reg_loss: 3078.0317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 265361.3920; train_global_loss: 36312904.9251; train_optim_loss: 36312904.9251; val_kl_reg_loss: 28451.7749; val_edge_recon_loss: 8335643.0749; val_gene_expr_recon_loss: 25112573.9352; val_masked_gp_l1_reg_loss: 4166.4331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159569.7656; val_global_loss: 33640404.8583; val_optim_loss: 33640404.8583
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9085; val_auprc_score: 0.9797; val_best_acc_score: 0.9088; val_best_f1_score: 0.9478; train_kl_reg_loss: 34415.5552; train_edge_recon_loss: 7962247.1252; train_gene_expr_recon_loss: 23678188.6995; train_masked_gp_l1_reg_loss: 5022.1587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167405.9336; train_global_loss: 31847279.4440; train_optim_loss: 31847279.4440; val_kl_reg_loss: 40156.1792; val_edge_recon_loss: 8301589.5526; val_gene_expr_recon_loss: 22683839.9190; val_masked_gp_l1_reg_loss: 5607.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171021.1719; val_global_loss: 31202215.5951; val_optim_loss: 31202215.5951
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9168; val_auprc_score: 0.9820; val_best_acc_score: 0.9128; val_best_f1_score: 0.9501; train_kl_reg_loss: 43352.5173; train_edge_recon_loss: 7893343.3784; train_gene_expr_recon_loss: 22195630.6065; train_masked_gp_l1_reg_loss: 5804.2056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171368.8938; train_global_loss: 30309499.5704; train_optim_loss: 30309499.5704; val_kl_reg_loss: 46733.4523; val_edge_recon_loss: 8242957.6356; val_gene_expr_recon_loss: 21870050.6235; val_masked_gp_l1_reg_loss: 5901.0308; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170465.1562; val_global_loss: 30336109.7571; val_optim_loss: 30336109.7571
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9192; val_auprc_score: 0.9824; val_best_acc_score: 0.9157; val_best_f1_score: 0.9518; train_kl_reg_loss: 50989.9554; train_edge_recon_loss: 7908956.2780; train_gene_expr_recon_loss: 21643059.4819; train_masked_gp_l1_reg_loss: 5880.0061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169465.8389; train_global_loss: 29778351.5379; train_optim_loss: 29778351.5379; val_kl_reg_loss: 53887.0287; val_edge_recon_loss: 8212358.6943; val_gene_expr_recon_loss: 21516406.3563; val_masked_gp_l1_reg_loss: 5878.6685; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167884.8906; val_global_loss: 29956414.0891; val_optim_loss: 29956414.0891
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9238; val_auprc_score: 0.9833; val_best_acc_score: 0.9192; val_best_f1_score: 0.9537; train_kl_reg_loss: 56310.4231; train_edge_recon_loss: 7886113.3777; train_gene_expr_recon_loss: 21376878.0966; train_masked_gp_l1_reg_loss: 5887.5494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167117.7295; train_global_loss: 29492307.1507; train_optim_loss: 29492307.1507; val_kl_reg_loss: 59395.7331; val_edge_recon_loss: 8272692.4879; val_gene_expr_recon_loss: 22051480.9636; val_masked_gp_l1_reg_loss: 5898.4395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166975.1406; val_global_loss: 30556443.2065; val_optim_loss: 30556443.2065
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8986; val_auprc_score: 0.9766; val_best_acc_score: 0.9073; val_best_f1_score: 0.9473; train_kl_reg_loss: 196189.1594; train_edge_recon_loss: 7987770.0526; train_gene_expr_recon_loss: 24034986.9946; train_masked_gp_l1_reg_loss: 5622.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235573.8422; train_global_loss: 32460142.6110; train_optim_loss: 32460142.6110; val_kl_reg_loss: 29501.3688; val_edge_recon_loss: 8231720.3968; val_gene_expr_recon_loss: 25485845.2227; val_masked_gp_l1_reg_loss: 4984.2988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 431539.7812; val_global_loss: 34183590.9231; val_optim_loss: 34183590.9231
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9241; val_auprc_score: 0.9830; val_best_acc_score: 0.9193; val_best_f1_score: 0.9538; train_kl_reg_loss: 42718.9182; train_edge_recon_loss: 7906809.6625; train_gene_expr_recon_loss: 22866175.6119; train_masked_gp_l1_reg_loss: 5570.0224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245867.5885; train_global_loss: 31067141.7545; train_optim_loss: 31067141.7545; val_kl_reg_loss: 55515.7872; val_edge_recon_loss: 8276754.8522; val_gene_expr_recon_loss: 21819772.4130; val_masked_gp_l1_reg_loss: 5710.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177914.3750; val_global_loss: 30335667.0607; val_optim_loss: 30335667.0607
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9194; val_auprc_score: 0.9822; val_best_acc_score: 0.9162; val_best_f1_score: 0.9519; train_kl_reg_loss: 494708824.3806; train_edge_recon_loss: 8025220.1063; train_gene_expr_recon_loss: 25189958.5388; train_masked_gp_l1_reg_loss: 5302.5157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 357858.7061; train_global_loss: 528287150.3466; train_optim_loss: 528287150.3466; val_kl_reg_loss: 50634.6896; val_edge_recon_loss: 8251754.0000; val_gene_expr_recon_loss: 23009347.5628; val_masked_gp_l1_reg_loss: 5134.2534; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 400606.7500; val_global_loss: 31717476.3158; val_optim_loss: 31717476.3158

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9223; val_auprc_score: 0.9831; val_best_acc_score: 0.9182; val_best_f1_score: 0.9531; train_kl_reg_loss: 52763.4207; train_edge_recon_loss: 7907346.1137; train_gene_expr_recon_loss: 22610334.7374; train_masked_gp_l1_reg_loss: 5172.8103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 358824.7754; train_global_loss: 30934441.8294; train_optim_loss: 30934441.8294; val_kl_reg_loss: 55640.8404; val_edge_recon_loss: 8173899.7854; val_gene_expr_recon_loss: 22427189.9028; val_masked_gp_l1_reg_loss: 5216.2300; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 323046.4062; val_global_loss: 30984992.4211; val_optim_loss: 30984992.4211
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9247; val_auprc_score: 0.9835; val_best_acc_score: 0.9180; val_best_f1_score: 0.9530; train_kl_reg_loss: 59200.5528; train_edge_recon_loss: 7863428.0474; train_gene_expr_recon_loss: 22157850.7644; train_masked_gp_l1_reg_loss: 5254.2760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 280978.0282; train_global_loss: 30366711.7202; train_optim_loss: 30366711.7202; val_kl_reg_loss: 63019.7102; val_edge_recon_loss: 8246678.5607; val_gene_expr_recon_loss: 22001561.4818; val_masked_gp_l1_reg_loss: 5281.6919; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239243.5312; val_global_loss: 30555785.7085; val_optim_loss: 30555785.7085
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9275; val_auprc_score: 0.9842; val_best_acc_score: 0.9206; val_best_f1_score: 0.9545; train_kl_reg_loss: 66338.6313; train_edge_recon_loss: 7876819.5181; train_gene_expr_recon_loss: 21774261.9206; train_masked_gp_l1_reg_loss: 5284.1088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204743.3564; train_global_loss: 29927447.4810; train_optim_loss: 29927447.4810; val_kl_reg_loss: 70341.0384; val_edge_recon_loss: 8135092.5202; val_gene_expr_recon_loss: 21668189.2389; val_masked_gp_l1_reg_loss: 5278.7124; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175456.0938; val_global_loss: 30054356.7935; val_optim_loss: 30054356.7935
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9292; val_auprc_score: 0.9846; val_best_acc_score: 0.9214; val_best_f1_score: 0.9549; train_kl_reg_loss: 71948.8977; train_edge_recon_loss: 7864808.4303; train_gene_expr_recon_loss: 21471266.5614; train_masked_gp_l1_reg_loss: 5271.6761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156293.2413; train_global_loss: 29569588.7626; train_optim_loss: 29569588.7626; val_kl_reg_loss: 74002.9232; val_edge_recon_loss: 8204542.8927; val_gene_expr_recon_loss: 21429896.3806; val_masked_gp_l1_reg_loss: 5253.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141016.5312; val_global_loss: 29854712.2591; val_optim_loss: 29854712.2591
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9306; val_auprc_score: 0.9848; val_best_acc_score: 0.9224; val_best_f1_score: 0.9555; train_kl_reg_loss: 75729.1893; train_edge_recon_loss: 7890359.1000; train_gene_expr_recon_loss: 21250416.4242; train_masked_gp_l1_reg_loss: 5224.8561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131795.4565; train_global_loss: 29353525.1065; train_optim_loss: 29353525.1065; val_kl_reg_loss: 76879.7932; val_edge_recon_loss: 8215902.3340; val_gene_expr_recon_loss: 21230332.9231; val_masked_gp_l1_reg_loss: 5201.2368; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124542.9766; val_global_loss: 29652859.0526; val_optim_loss: 29652859.0526
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9311; val_auprc_score: 0.9851; val_best_acc_score: 0.9217; val_best_f1_score: 0.9550; train_kl_reg_loss: 77473.8640; train_edge_recon_loss: 7853281.6992; train_gene_expr_recon_loss: 21095662.4549; train_masked_gp_l1_reg_loss: 5191.5281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120191.8790; train_global_loss: 29151801.4449; train_optim_loss: 29151801.4449; val_kl_reg_loss: 79010.2850; val_edge_recon_loss: 8252508.8320; val_gene_expr_recon_loss: 21111875.6275; val_masked_gp_l1_reg_loss: 5180.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116365.8516; val_global_loss: 29564940.7126; val_optim_loss: 29564940.7126
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9325; val_auprc_score: 0.9853; val_best_acc_score: 0.9244; val_best_f1_score: 0.9566; train_kl_reg_loss: 78300.0577; train_edge_recon_loss: 7862777.4883; train_gene_expr_recon_loss: 20992442.6471; train_masked_gp_l1_reg_loss: 5176.9285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114037.2741; train_global_loss: 29052734.3989; train_optim_loss: 29052734.3989; val_kl_reg_loss: 77977.4542; val_edge_recon_loss: 8194663.0870; val_gene_expr_recon_loss: 21028722.4939; val_masked_gp_l1_reg_loss: 5184.8901; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111823.8203; val_global_loss: 29418371.0526; val_optim_loss: 29418371.0526
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9331; val_auprc_score: 0.9856; val_best_acc_score: 0.9241; val_best_f1_score: 0.9563; train_kl_reg_loss: 78422.3830; train_edge_recon_loss: 7863724.2683; train_gene_expr_recon_loss: 20911267.4955; train_masked_gp_l1_reg_loss: 5177.9170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110348.3461; train_global_loss: 28968940.4224; train_optim_loss: 28968940.4224; val_kl_reg_loss: 78890.5563; val_edge_recon_loss: 8220432.0668; val_gene_expr_recon_loss: 20987084.0567; val_masked_gp_l1_reg_loss: 5180.9263; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108933.2031; val_global_loss: 29400520.6397; val_optim_loss: 29400520.6397
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9331; val_auprc_score: 0.9854; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 78223.7794; train_edge_recon_loss: 7852757.8921; train_gene_expr_recon_loss: 20858211.0939; train_masked_gp_l1_reg_loss: 5186.6312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107943.9430; train_global_loss: 28902323.3222; train_optim_loss: 28902323.3222; val_kl_reg_loss: 78176.5628; val_edge_recon_loss: 8159263.3138; val_gene_expr_recon_loss: 20926730.5911; val_masked_gp_l1_reg_loss: 5188.8975; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107031.8906; val_global_loss: 29276390.4372; val_optim_loss: 29276390.4372
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9360; val_auprc_score: 0.9862; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 78406.2439; train_edge_recon_loss: 7875833.5429; train_gene_expr_recon_loss: 20811542.5190; train_masked_gp_l1_reg_loss: 5191.9633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106197.9229; train_global_loss: 28877172.2040; train_optim_loss: 28877172.2040; val_kl_reg_loss: 78631.3428; val_edge_recon_loss: 8146882.3198; val_gene_expr_recon_loss: 20874770.7449; val_masked_gp_l1_reg_loss: 5202.5361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105388.8828; val_global_loss: 29210874.3806; val_optim_loss: 29210874.3806
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9347; val_auprc_score: 0.9859; val_best_acc_score: 0.9266; val_best_f1_score: 0.9579; train_kl_reg_loss: 77828.9816; train_edge_recon_loss: 7878531.5088; train_gene_expr_recon_loss: 20767768.4134; train_masked_gp_l1_reg_loss: 5214.5180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104792.1767; train_global_loss: 28834135.5496; train_optim_loss: 28834135.5496; val_kl_reg_loss: 76992.7905; val_edge_recon_loss: 8133399.4555; val_gene_expr_recon_loss: 20848211.6194; val_masked_gp_l1_reg_loss: 5226.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104046.5156; val_global_loss: 29167875.8300; val_optim_loss: 29167875.8300
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9360; val_auprc_score: 0.9862; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 77449.7924; train_edge_recon_loss: 7870934.2268; train_gene_expr_recon_loss: 20726007.4224; train_masked_gp_l1_reg_loss: 5234.7118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103643.8978; train_global_loss: 28783270.0677; train_optim_loss: 28783270.0677; val_kl_reg_loss: 77048.5079; val_edge_recon_loss: 8133129.9615; val_gene_expr_recon_loss: 20797274.8583; val_masked_gp_l1_reg_loss: 5243.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103277.4844; val_global_loss: 29115975.3522; val_optim_loss: 29115975.3522
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9363; val_auprc_score: 0.9863; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 76803.5834; train_edge_recon_loss: 7858762.4321; train_gene_expr_recon_loss: 20696428.8005; train_masked_gp_l1_reg_loss: 5254.0795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102724.9050; train_global_loss: 28739973.8592; train_optim_loss: 28739973.8592; val_kl_reg_loss: 77504.0113; val_edge_recon_loss: 8166718.5364; val_gene_expr_recon_loss: 20773313.9595; val_masked_gp_l1_reg_loss: 5267.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102362.1484; val_global_loss: 29125166.4939; val_optim_loss: 29125166.4939
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9388; val_auprc_score: 0.9868; val_best_acc_score: 0.9285; val_best_f1_score: 0.9588; train_kl_reg_loss: 76023.7716; train_edge_recon_loss: 7867626.7022; train_gene_expr_recon_loss: 20651959.4495; train_masked_gp_l1_reg_loss: 5292.5686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102009.6680; train_global_loss: 28702912.1480; train_optim_loss: 28702912.1480; val_kl_reg_loss: 75602.6468; val_edge_recon_loss: 8144532.9433; val_gene_expr_recon_loss: 20754345.8866; val_masked_gp_l1_reg_loss: 5327.4399; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101616.0156; val_global_loss: 29081425.5304; val_optim_loss: 29081425.5304
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9401; val_auprc_score: 0.9870; val_best_acc_score: 0.9287; val_best_f1_score: 0.9589; train_kl_reg_loss: 74319.1077; train_edge_recon_loss: 7866873.4623; train_gene_expr_recon_loss: 20621067.2356; train_masked_gp_l1_reg_loss: 5373.6306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101460.5713; train_global_loss: 28669094.0884; train_optim_loss: 28669094.0884; val_kl_reg_loss: 73723.3985; val_edge_recon_loss: 8209728.3907; val_gene_expr_recon_loss: 20686167.0364; val_masked_gp_l1_reg_loss: 5439.1479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101266.7422; val_global_loss: 29076324.8340; val_optim_loss: 29076324.8340
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9871; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 72397.0298; train_edge_recon_loss: 7838788.8964; train_gene_expr_recon_loss: 20590545.0271; train_masked_gp_l1_reg_loss: 5524.1623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101018.3424; train_global_loss: 28608273.4702; train_optim_loss: 28608273.4702; val_kl_reg_loss: 72297.2674; val_edge_recon_loss: 8125051.5850; val_gene_expr_recon_loss: 20668086.7368; val_masked_gp_l1_reg_loss: 5597.9224; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100894.0312; val_global_loss: 28971927.6680; val_optim_loss: 28971927.6680
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9402; val_auprc_score: 0.9874; val_best_acc_score: 0.9293; val_best_f1_score: 0.9594; train_kl_reg_loss: 71742.2009; train_edge_recon_loss: 7819635.5774; train_gene_expr_recon_loss: 20555721.2699; train_masked_gp_l1_reg_loss: 5652.5818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100579.7664; train_global_loss: 28553331.3773; train_optim_loss: 28553331.3773; val_kl_reg_loss: 72021.8545; val_edge_recon_loss: 8075249.7024; val_gene_expr_recon_loss: 20629822.5992; val_masked_gp_l1_reg_loss: 5704.4321; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100377.9062; val_global_loss: 28883176.0891; val_optim_loss: 28883176.0891
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9434; val_auprc_score: 0.9880; val_best_acc_score: 0.9309; val_best_f1_score: 0.9601; train_kl_reg_loss: 72618.3484; train_edge_recon_loss: 7876405.3317; train_gene_expr_recon_loss: 20537796.1634; train_masked_gp_l1_reg_loss: 5745.7322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101371.2944; train_global_loss: 28593936.8863; train_optim_loss: 28593936.8863; val_kl_reg_loss: 51449.0965; val_edge_recon_loss: 8137075.9737; val_gene_expr_recon_loss: 20593826.4130; val_masked_gp_l1_reg_loss: 5784.6504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100631.9453; val_global_loss: 28888767.5223; val_optim_loss: 28888767.5223
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9412; val_auprc_score: 0.9874; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 72937.1299; train_edge_recon_loss: 7861967.1340; train_gene_expr_recon_loss: 20472768.2996; train_masked_gp_l1_reg_loss: 5815.6628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99856.0387; train_global_loss: 28513344.3168; train_optim_loss: 28513344.3168; val_kl_reg_loss: 52713.4465; val_edge_recon_loss: 8166265.3097; val_gene_expr_recon_loss: 20566044.6559; val_masked_gp_l1_reg_loss: 5851.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99058.5469; val_global_loss: 28889933.3846; val_optim_loss: 28889933.3846
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9406; val_auprc_score: 0.9871; val_best_acc_score: 0.9297; val_best_f1_score: 0.9596; train_kl_reg_loss: 71580.8553; train_edge_recon_loss: 7861854.7906; train_gene_expr_recon_loss: 20436951.0975; train_masked_gp_l1_reg_loss: 5886.6329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98306.7655; train_global_loss: 28474580.2247; train_optim_loss: 28474580.2247; val_kl_reg_loss: 53217.5998; val_edge_recon_loss: 8173747.1700; val_gene_expr_recon_loss: 20542447.6194; val_masked_gp_l1_reg_loss: 5927.1787; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97650.1797; val_global_loss: 28872990.4534; val_optim_loss: 28872990.4534
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9421; val_auprc_score: 0.9877; val_best_acc_score: 0.9311; val_best_f1_score: 0.9603; train_kl_reg_loss: 69634.5736; train_edge_recon_loss: 7873150.8075; train_gene_expr_recon_loss: 20409151.2753; train_masked_gp_l1_reg_loss: 5978.0556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96932.4850; train_global_loss: 28454847.2157; train_optim_loss: 28454847.2157; val_kl_reg_loss: 54215.0294; val_edge_recon_loss: 8075773.7126; val_gene_expr_recon_loss: 20499870.2753; val_masked_gp_l1_reg_loss: 6021.2446; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96395.6719; val_global_loss: 28732276.9879; val_optim_loss: 28732276.9879
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9417; val_auprc_score: 0.9875; val_best_acc_score: 0.9302; val_best_f1_score: 0.9597; train_kl_reg_loss: 67908.7095; train_edge_recon_loss: 7858427.9558; train_gene_expr_recon_loss: 20382569.2563; train_masked_gp_l1_reg_loss: 6060.1212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96480.8831; train_global_loss: 28411446.9088; train_optim_loss: 28411446.9088; val_kl_reg_loss: 54855.7623; val_edge_recon_loss: 8154374.6377; val_gene_expr_recon_loss: 20468497.8138; val_masked_gp_l1_reg_loss: 6096.8926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96477.6016; val_global_loss: 28780302.2672; val_optim_loss: 28780302.2672
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9438; val_auprc_score: 0.9879; val_best_acc_score: 0.9313; val_best_f1_score: 0.9604; train_kl_reg_loss: 66922.3868; train_edge_recon_loss: 7843145.9957; train_gene_expr_recon_loss: 20348670.9630; train_masked_gp_l1_reg_loss: 6131.0371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96389.9848; train_global_loss: 28361260.3935; train_optim_loss: 28361260.3935; val_kl_reg_loss: 55057.4259; val_edge_recon_loss: 8205332.2773; val_gene_expr_recon_loss: 20460290.4534; val_masked_gp_l1_reg_loss: 6163.3521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96356.5234; val_global_loss: 28823200.1700; val_optim_loss: 28823200.1700
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9436; val_auprc_score: 0.9881; val_best_acc_score: 0.9310; val_best_f1_score: 0.9604; train_kl_reg_loss: 65672.0737; train_edge_recon_loss: 7852039.2080; train_gene_expr_recon_loss: 20331072.8727; train_masked_gp_l1_reg_loss: 6206.3493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96342.1352; train_global_loss: 28351332.7139; train_optim_loss: 28351332.7139; val_kl_reg_loss: 56477.7138; val_edge_recon_loss: 8073789.9190; val_gene_expr_recon_loss: 20419584.9798; val_masked_gp_l1_reg_loss: 6253.0142; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96351.8594; val_global_loss: 28652458.6154; val_optim_loss: 28652458.6154
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9445; val_auprc_score: 0.9880; val_best_acc_score: 0.9321; val_best_f1_score: 0.9609; train_kl_reg_loss: 65050.2302; train_edge_recon_loss: 7847236.6340; train_gene_expr_recon_loss: 20308169.4278; train_masked_gp_l1_reg_loss: 6286.0491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96280.2845; train_global_loss: 28323022.7076; train_optim_loss: 28323022.7076; val_kl_reg_loss: 55627.9301; val_edge_recon_loss: 8149173.6377; val_gene_expr_recon_loss: 20408653.2874; val_masked_gp_l1_reg_loss: 6327.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96404.0156; val_global_loss: 28716186.7692; val_optim_loss: 28716186.7692
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9436; val_auprc_score: 0.9879; val_best_acc_score: 0.9311; val_best_f1_score: 0.9603; train_kl_reg_loss: 64373.5133; train_edge_recon_loss: 7827339.0686; train_gene_expr_recon_loss: 20286357.6787; train_masked_gp_l1_reg_loss: 6361.3630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96197.4734; train_global_loss: 28280629.1318; train_optim_loss: 28280629.1318; val_kl_reg_loss: 57054.8103; val_edge_recon_loss: 8169597.7874; val_gene_expr_recon_loss: 20394812.7692; val_masked_gp_l1_reg_loss: 6402.3491; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96119.1875; val_global_loss: 28723987.3117; val_optim_loss: 28723987.3117
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9420; val_auprc_score: 0.9877; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 64159.9935; train_edge_recon_loss: 7823613.8592; train_gene_expr_recon_loss: 20265336.7247; train_masked_gp_l1_reg_loss: 6436.0680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96034.0353; train_global_loss: 28255580.6625; train_optim_loss: 28255580.6625; val_kl_reg_loss: 58167.6574; val_edge_recon_loss: 8138509.3644; val_gene_expr_recon_loss: 20377662.0081; val_masked_gp_l1_reg_loss: 6476.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95861.5312; val_global_loss: 28676676.9879; val_optim_loss: 28676676.9879
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9440; val_auprc_score: 0.9878; val_best_acc_score: 0.9321; val_best_f1_score: 0.9610; train_kl_reg_loss: 63888.3714; train_edge_recon_loss: 7829654.3254; train_gene_expr_recon_loss: 20253353.2148; train_masked_gp_l1_reg_loss: 6504.9081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95909.9612; train_global_loss: 28249310.8366; train_optim_loss: 28249310.8366; val_kl_reg_loss: 57820.6154; val_edge_recon_loss: 8143827.4028; val_gene_expr_recon_loss: 20363287.3117; val_masked_gp_l1_reg_loss: 6543.3325; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95716.5078; val_global_loss: 28667195.3360; val_optim_loss: 28667195.3360

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9432; val_auprc_score: 0.9876; val_best_acc_score: 0.9317; val_best_f1_score: 0.9606; train_kl_reg_loss: 63321.7741; train_edge_recon_loss: 7821784.7166; train_gene_expr_recon_loss: 20253844.5668; train_masked_gp_l1_reg_loss: 6550.8614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91117.6119; train_global_loss: 28236619.4874; train_optim_loss: 28236619.4874; val_kl_reg_loss: 57509.1405; val_edge_recon_loss: 8164942.4555; val_gene_expr_recon_loss: 20349959.9595; val_masked_gp_l1_reg_loss: 6559.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90365.8125; val_global_loss: 28669337.5385; val_optim_loss: 28669337.5385
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9454; val_auprc_score: 0.9883; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 63252.1054; train_edge_recon_loss: 7837846.2398; train_gene_expr_recon_loss: 20234920.4531; train_masked_gp_l1_reg_loss: 6567.6524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90179.0614; train_global_loss: 28232765.5334; train_optim_loss: 28232765.5334; val_kl_reg_loss: 57154.8057; val_edge_recon_loss: 8099042.7591; val_gene_expr_recon_loss: 20357128.3887; val_masked_gp_l1_reg_loss: 6575.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89999.1719; val_global_loss: 28609901.9514; val_optim_loss: 28609901.9514
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9449; val_auprc_score: 0.9881; val_best_acc_score: 0.9322; val_best_f1_score: 0.9609; train_kl_reg_loss: 63147.8487; train_edge_recon_loss: 7808078.5397; train_gene_expr_recon_loss: 20228993.6661; train_masked_gp_l1_reg_loss: 6583.6324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89874.7502; train_global_loss: 28196678.3700; train_optim_loss: 28196678.3700; val_kl_reg_loss: 57412.9742; val_edge_recon_loss: 8152636.9312; val_gene_expr_recon_loss: 20339605.5304; val_masked_gp_l1_reg_loss: 6591.1162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89732.6641; val_global_loss: 28645979.4656; val_optim_loss: 28645979.4656
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9448; val_auprc_score: 0.9881; val_best_acc_score: 0.9319; val_best_f1_score: 0.9608; train_kl_reg_loss: 63078.1652; train_edge_recon_loss: 7810706.9842; train_gene_expr_recon_loss: 20221624.2843; train_masked_gp_l1_reg_loss: 6597.7843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89611.3437; train_global_loss: 28191618.5578; train_optim_loss: 28191618.5578; val_kl_reg_loss: 57696.3138; val_edge_recon_loss: 8165387.3907; val_gene_expr_recon_loss: 20329335.3279; val_masked_gp_l1_reg_loss: 6604.2803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89516.2578; val_global_loss: 28648539.0445; val_optim_loss: 28648539.0445
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9454; val_auprc_score: 0.9884; val_best_acc_score: 0.9329; val_best_f1_score: 0.9613; train_kl_reg_loss: 63083.8823; train_edge_recon_loss: 7842904.7502; train_gene_expr_recon_loss: 20218574.6381; train_masked_gp_l1_reg_loss: 6610.7776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89414.1318; train_global_loss: 28220588.2473; train_optim_loss: 28220588.2473; val_kl_reg_loss: 57743.3056; val_edge_recon_loss: 8137495.1275; val_gene_expr_recon_loss: 20329196.7530; val_masked_gp_l1_reg_loss: 6616.7783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89302.6562; val_global_loss: 28620353.1822; val_optim_loss: 28620353.1822
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9452; val_auprc_score: 0.9880; val_best_acc_score: 0.9321; val_best_f1_score: 0.9609; train_kl_reg_loss: 62967.7988; train_edge_recon_loss: 7818838.7432; train_gene_expr_recon_loss: 20214411.7067; train_masked_gp_l1_reg_loss: 6623.3394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89252.8966; train_global_loss: 28192094.4991; train_optim_loss: 28192094.4991; val_kl_reg_loss: 57878.6634; val_edge_recon_loss: 8145953.9474; val_gene_expr_recon_loss: 20320432.5911; val_masked_gp_l1_reg_loss: 6630.2202; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89202.5391; val_global_loss: 28620097.1498; val_optim_loss: 28620097.1498

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9439; val_auprc_score: 0.9880; val_best_acc_score: 0.9324; val_best_f1_score: 0.9611; train_kl_reg_loss: 62915.9492; train_edge_recon_loss: 7827566.5675; train_gene_expr_recon_loss: 20209131.8962; train_masked_gp_l1_reg_loss: 6630.8551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88677.0331; train_global_loss: 28194922.2347; train_optim_loss: 28194922.2347; val_kl_reg_loss: 57714.7185; val_edge_recon_loss: 8105225.3745; val_gene_expr_recon_loss: 20313863.2227; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88535.1875; val_global_loss: 28571971.3360; val_optim_loss: 28571971.3360
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9436; val_auprc_score: 0.9879; val_best_acc_score: 0.9325; val_best_f1_score: 0.9611; train_kl_reg_loss: 62956.7745; train_edge_recon_loss: 7844309.3533; train_gene_expr_recon_loss: 20204813.8836; train_masked_gp_l1_reg_loss: 6632.2327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88489.8975; train_global_loss: 28207201.9395; train_optim_loss: 28207201.9395; val_kl_reg_loss: 57790.8363; val_edge_recon_loss: 8113544.3259; val_gene_expr_recon_loss: 20320045.5385; val_masked_gp_l1_reg_loss: 6632.8584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88452.8359; val_global_loss: 28586464.7611; val_optim_loss: 28586464.7611
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9459; val_auprc_score: 0.9884; val_best_acc_score: 0.9332; val_best_f1_score: 0.9615; train_kl_reg_loss: 62949.7621; train_edge_recon_loss: 7804984.8337; train_gene_expr_recon_loss: 20209713.2482; train_masked_gp_l1_reg_loss: 6633.5391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88428.5759; train_global_loss: 28172710.2094; train_optim_loss: 28172710.2094; val_kl_reg_loss: 57734.9786; val_edge_recon_loss: 8115237.0931; val_gene_expr_recon_loss: 20344338.8745; val_masked_gp_l1_reg_loss: 6634.2207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88409.4219; val_global_loss: 28612354.9474; val_optim_loss: 28612354.9474
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9437; val_auprc_score: 0.9878; val_best_acc_score: 0.9322; val_best_f1_score: 0.9610; train_kl_reg_loss: 62945.2429; train_edge_recon_loss: 7836964.1701; train_gene_expr_recon_loss: 20209335.9684; train_masked_gp_l1_reg_loss: 6634.9017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88397.0587; train_global_loss: 28204277.3773; train_optim_loss: 28204277.3773; val_kl_reg_loss: 57658.6230; val_edge_recon_loss: 8135714.3401; val_gene_expr_recon_loss: 20309499.2632; val_masked_gp_l1_reg_loss: 6635.5728; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88382.8750; val_global_loss: 28597890.2591; val_optim_loss: 28597890.2591
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9451; val_auprc_score: 0.9882; val_best_acc_score: 0.9322; val_best_f1_score: 0.9609; train_kl_reg_loss: 62938.0291; train_edge_recon_loss: 7832155.1713; train_gene_expr_recon_loss: 20204736.9810; train_masked_gp_l1_reg_loss: 6636.1771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88373.4108; train_global_loss: 28194839.6092; train_optim_loss: 28194839.6092; val_kl_reg_loss: 57703.6726; val_edge_recon_loss: 8183945.9332; val_gene_expr_recon_loss: 20337896.4372; val_masked_gp_l1_reg_loss: 6636.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88367.0469; val_global_loss: 28674550.1053; val_optim_loss: 28674550.1053

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9428; val_auprc_score: 0.9876; val_best_acc_score: 0.9316; val_best_f1_score: 0.9606; train_kl_reg_loss: 62911.3361; train_edge_recon_loss: 7807960.8130; train_gene_expr_recon_loss: 20206941.5144; train_masked_gp_l1_reg_loss: 6636.9009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88315.2390; train_global_loss: 28172764.8709; train_optim_loss: 28172764.8709; val_kl_reg_loss: 57742.8459; val_edge_recon_loss: 8149209.6134; val_gene_expr_recon_loss: 20335432.1943; val_masked_gp_l1_reg_loss: 6636.9463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88299.6016; val_global_loss: 28637320.6640; val_optim_loss: 28637320.6640
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9445; val_auprc_score: 0.9881; val_best_acc_score: 0.9325; val_best_f1_score: 0.9612; train_kl_reg_loss: 62902.9925; train_edge_recon_loss: 7821479.9204; train_gene_expr_recon_loss: 20201675.8394; train_masked_gp_l1_reg_loss: 6636.9958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88294.1394; train_global_loss: 28180989.9170; train_optim_loss: 28180989.9170; val_kl_reg_loss: 57719.0216; val_edge_recon_loss: 8131234.5567; val_gene_expr_recon_loss: 20317396.1781; val_masked_gp_l1_reg_loss: 6637.0405; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88289.6328; val_global_loss: 28601277.7976; val_optim_loss: 28601277.7976
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9453; val_auprc_score: 0.9882; val_best_acc_score: 0.9319; val_best_f1_score: 0.9608; train_kl_reg_loss: 62939.1954; train_edge_recon_loss: 7838901.0923; train_gene_expr_recon_loss: 20204891.3321; train_masked_gp_l1_reg_loss: 6637.0851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88286.3676; train_global_loss: 28201656.0081; train_optim_loss: 28201656.0081; val_kl_reg_loss: 57721.5007; val_edge_recon_loss: 8156097.1174; val_gene_expr_recon_loss: 20320419.4737; val_masked_gp_l1_reg_loss: 6637.1323; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88283.5703; val_global_loss: 28629160.0729; val_optim_loss: 28629160.0729
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9451; val_auprc_score: 0.9882; val_best_acc_score: 0.9331; val_best_f1_score: 0.9614; train_kl_reg_loss: 62917.4762; train_edge_recon_loss: 7811149.5210; train_gene_expr_recon_loss: 20206865.2816; train_masked_gp_l1_reg_loss: 6637.1871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88281.2044; train_global_loss: 28175851.6020; train_optim_loss: 28175851.6020; val_kl_reg_loss: 57720.7355; val_edge_recon_loss: 8139623.5395; val_gene_expr_recon_loss: 20339472.1215; val_masked_gp_l1_reg_loss: 6637.2358; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88278.9922; val_global_loss: 28631732.3077; val_optim_loss: 28631732.3077

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 523 min 46 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9443
val AUPRC score: 0.9881
val best accuracy score: 0.9326
val best F1 score: 0.9613
val target rna MSE score: 0.5707
val source rna MSE score: 0.1510
Val cat covariate0 mean sim diff: -0.0009
Val cat covariate1 mean sim diff: -0.0526
Val cat covariate2 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
