[True]
Run timestamp: 10082023_215800_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7614; val_auprc_score: 0.7847; val_best_acc_score: 0.5053; val_best_f1_score: 0.6687; train_kl_reg_loss: 163356.9547; train_edge_recon_loss: 3791337.9580; train_gene_expr_recon_loss: 46740906.8702; train_masked_gp_l1_reg_loss: 83234.0713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244930.3220; train_chrom_access_recon_loss: 5848221.1603; train_global_loss: 56871987.4504; train_optim_loss: 56871987.4504; val_kl_reg_loss: 189028.0312; val_edge_recon_loss: 4064905.5333; val_gene_expr_recon_loss: 39034527.2000; val_masked_gp_l1_reg_loss: 84579.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 241210.1094; val_chrom_access_recon_loss: 5264839.8667; val_global_loss: 48879092.8000; val_optim_loss: 48879092.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8114; val_auprc_score: 0.8257; val_best_acc_score: 0.6738; val_best_f1_score: 0.7355; train_kl_reg_loss: 206179.3002; train_edge_recon_loss: 3610135.9313; train_gene_expr_recon_loss: 37858246.9313; train_masked_gp_l1_reg_loss: 80066.5246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234924.3724; train_chrom_access_recon_loss: 5179741.8931; train_global_loss: 47169294.6870; train_optim_loss: 47169294.6870; val_kl_reg_loss: 202769.9823; val_edge_recon_loss: 4054671.7167; val_gene_expr_recon_loss: 37250389.0667; val_masked_gp_l1_reg_loss: 76425.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228336.9688; val_chrom_access_recon_loss: 5167184.2000; val_global_loss: 46979774.1333; val_optim_loss: 46979774.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8811; val_auprc_score: 0.8799; val_best_acc_score: 0.7594; val_best_f1_score: 0.7869; train_kl_reg_loss: 189938.2177; train_edge_recon_loss: 3565359.2786; train_gene_expr_recon_loss: 36992235.0229; train_masked_gp_l1_reg_loss: 76285.0153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221981.0027; train_chrom_access_recon_loss: 5123348.2595; train_global_loss: 46169146.7176; train_optim_loss: 46169146.7176; val_kl_reg_loss: 180084.8448; val_edge_recon_loss: 3969111.6333; val_gene_expr_recon_loss: 36620689.0667; val_masked_gp_l1_reg_loss: 77486.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215621.7812; val_chrom_access_recon_loss: 5115674.9333; val_global_loss: 46178668.0000; val_optim_loss: 46178668.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9121; val_auprc_score: 0.9049; val_best_acc_score: 0.8327; val_best_f1_score: 0.8434; train_kl_reg_loss: 157702.5827; train_edge_recon_loss: 3483645.8187; train_gene_expr_recon_loss: 36596405.0382; train_masked_gp_l1_reg_loss: 79009.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209552.1560; train_chrom_access_recon_loss: 5083448.6947; train_global_loss: 45609764.4580; train_optim_loss: 45609764.4580; val_kl_reg_loss: 142294.6427; val_edge_recon_loss: 3505653.0500; val_gene_expr_recon_loss: 36708087.7333; val_masked_gp_l1_reg_loss: 80702.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203542.9844; val_chrom_access_recon_loss: 5115324.7333; val_global_loss: 45755608.2667; val_optim_loss: 45755608.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9062; val_auprc_score: 0.8899; val_best_acc_score: 0.8259; val_best_f1_score: 0.8351; train_kl_reg_loss: 156172.6865; train_edge_recon_loss: 3188158.2595; train_gene_expr_recon_loss: 36459095.6947; train_masked_gp_l1_reg_loss: 83501.7868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198055.4018; train_chrom_access_recon_loss: 5064226.9427; train_global_loss: 45149210.9313; train_optim_loss: 45149210.9313; val_kl_reg_loss: 168453.4260; val_edge_recon_loss: 3090712.6667; val_gene_expr_recon_loss: 36258441.8667; val_masked_gp_l1_reg_loss: 84950.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192499.5156; val_chrom_access_recon_loss: 5091801.5333; val_global_loss: 44886861.0667; val_optim_loss: 44886861.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9094; val_auprc_score: 0.8982; val_best_acc_score: 0.8248; val_best_f1_score: 0.8387; train_kl_reg_loss: 188101.2803; train_edge_recon_loss: 2995104.4542; train_gene_expr_recon_loss: 36159407.4504; train_masked_gp_l1_reg_loss: 85546.3609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187195.7474; train_chrom_access_recon_loss: 5039428.6298; train_global_loss: 44654784.2443; train_optim_loss: 44654784.2443; val_kl_reg_loss: 193532.7500; val_edge_recon_loss: 3003140.6167; val_gene_expr_recon_loss: 35945891.2000; val_masked_gp_l1_reg_loss: 86449.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182141.2188; val_chrom_access_recon_loss: 5057808.6667; val_global_loss: 44468961.0667; val_optim_loss: 44468961.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9157; val_auprc_score: 0.9038; val_best_acc_score: 0.8374; val_best_f1_score: 0.8477; train_kl_reg_loss: 189251.9121; train_edge_recon_loss: 2943885.4943; train_gene_expr_recon_loss: 35914068.0611; train_masked_gp_l1_reg_loss: 87715.3192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177681.0612; train_chrom_access_recon_loss: 5013512.5878; train_global_loss: 44326114.3511; train_optim_loss: 44326114.3511; val_kl_reg_loss: 185021.9281; val_edge_recon_loss: 2936681.0833; val_gene_expr_recon_loss: 35804149.8667; val_masked_gp_l1_reg_loss: 88832.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173269.6719; val_chrom_access_recon_loss: 5033067.2333; val_global_loss: 44221021.0667; val_optim_loss: 44221021.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9207; val_auprc_score: 0.9085; val_best_acc_score: 0.8428; val_best_f1_score: 0.8524; train_kl_reg_loss: 181487.8607; train_edge_recon_loss: 2924448.0057; train_gene_expr_recon_loss: 35758045.9542; train_masked_gp_l1_reg_loss: 90060.0247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169216.8025; train_chrom_access_recon_loss: 4998058.9847; train_global_loss: 44121317.4351; train_optim_loss: 44121317.4351; val_kl_reg_loss: 178633.6302; val_edge_recon_loss: 2917786.4167; val_gene_expr_recon_loss: 35596677.3333; val_masked_gp_l1_reg_loss: 91329.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165157.3281; val_chrom_access_recon_loss: 4997124.2333; val_global_loss: 43946706.1333; val_optim_loss: 43946706.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9243; val_auprc_score: 0.9132; val_best_acc_score: 0.8459; val_best_f1_score: 0.8573; train_kl_reg_loss: 176787.8742; train_edge_recon_loss: 2897479.3130; train_gene_expr_recon_loss: 35548537.5878; train_masked_gp_l1_reg_loss: 92515.0747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161398.8637; train_chrom_access_recon_loss: 4967967.0725; train_global_loss: 43844685.5878; train_optim_loss: 43844685.5878; val_kl_reg_loss: 171870.1427; val_edge_recon_loss: 2919238.3500; val_gene_expr_recon_loss: 35541570.1333; val_masked_gp_l1_reg_loss: 93484.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157620.3438; val_chrom_access_recon_loss: 4996446.1000; val_global_loss: 43880228.0000; val_optim_loss: 43880228.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9258; val_auprc_score: 0.9133; val_best_acc_score: 0.8511; val_best_f1_score: 0.8622; train_kl_reg_loss: 169075.2189; train_edge_recon_loss: 2889851.0630; train_gene_expr_recon_loss: 35441589.3435; train_masked_gp_l1_reg_loss: 94648.6235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154061.0039; train_chrom_access_recon_loss: 4962980.1756; train_global_loss: 43712205.5878; train_optim_loss: 43712205.5878; val_kl_reg_loss: 164749.2938; val_edge_recon_loss: 2906058.6500; val_gene_expr_recon_loss: 35372132.8000; val_masked_gp_l1_reg_loss: 95997.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150575.6406; val_chrom_access_recon_loss: 4982883.4667; val_global_loss: 43672396.8000; val_optim_loss: 43672396.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9318; val_auprc_score: 0.9172; val_best_acc_score: 0.8647; val_best_f1_score: 0.8728; train_kl_reg_loss: 164203.0920; train_edge_recon_loss: 2876204.8378; train_gene_expr_recon_loss: 35306561.0687; train_masked_gp_l1_reg_loss: 96949.1383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147290.0247; train_chrom_access_recon_loss: 4943693.4809; train_global_loss: 43534901.2519; train_optim_loss: 43534901.2519; val_kl_reg_loss: 161908.0708; val_edge_recon_loss: 2877994.2500; val_gene_expr_recon_loss: 35226890.6667; val_masked_gp_l1_reg_loss: 98074.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143997.5938; val_chrom_access_recon_loss: 4974376.6667; val_global_loss: 43483242.4000; val_optim_loss: 43483242.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9374; val_auprc_score: 0.9267; val_best_acc_score: 0.8707; val_best_f1_score: 0.8780; train_kl_reg_loss: 157041.6873; train_edge_recon_loss: 2855261.4160; train_gene_expr_recon_loss: 35221247.8015; train_masked_gp_l1_reg_loss: 99080.5459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140973.8979; train_chrom_access_recon_loss: 4933827.5916; train_global_loss: 43407433.2519; train_optim_loss: 43407433.2519; val_kl_reg_loss: 156155.3833; val_edge_recon_loss: 2853530.8000; val_gene_expr_recon_loss: 35262017.0667; val_masked_gp_l1_reg_loss: 100387.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137980.2031; val_chrom_access_recon_loss: 4962225.8000; val_global_loss: 43472297.3333; val_optim_loss: 43472297.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9448; val_auprc_score: 0.9349; val_best_acc_score: 0.8822; val_best_f1_score: 0.8902; train_kl_reg_loss: 154639.6104; train_edge_recon_loss: 2841933.1832; train_gene_expr_recon_loss: 35078172.0458; train_masked_gp_l1_reg_loss: 101229.6468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135225.6039; train_chrom_access_recon_loss: 4920759.9389; train_global_loss: 43231959.9695; train_optim_loss: 43231959.9695; val_kl_reg_loss: 153159.2771; val_edge_recon_loss: 2833817.4167; val_gene_expr_recon_loss: 35175123.7333; val_masked_gp_l1_reg_loss: 102140.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132504.0938; val_chrom_access_recon_loss: 4974394.0333; val_global_loss: 43371137.8667; val_optim_loss: 43371137.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9476; val_auprc_score: 0.9383; val_best_acc_score: 0.8804; val_best_f1_score: 0.8877; train_kl_reg_loss: 150250.4046; train_edge_recon_loss: 2832680.4885; train_gene_expr_recon_loss: 34999121.0840; train_masked_gp_l1_reg_loss: 103294.4511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129887.5203; train_chrom_access_recon_loss: 4914922.6412; train_global_loss: 43130156.7023; train_optim_loss: 43130156.7023; val_kl_reg_loss: 150008.6854; val_edge_recon_loss: 2830995.2167; val_gene_expr_recon_loss: 34989825.0667; val_masked_gp_l1_reg_loss: 104169.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127213.4297; val_chrom_access_recon_loss: 4944106.0667; val_global_loss: 43146315.7333; val_optim_loss: 43146315.7333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9516; val_auprc_score: 0.9438; val_best_acc_score: 0.8870; val_best_f1_score: 0.8928; train_kl_reg_loss: 146664.7376; train_edge_recon_loss: 2815603.1374; train_gene_expr_recon_loss: 34895297.3130; train_masked_gp_l1_reg_loss: 105244.5100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124748.8701; train_chrom_access_recon_loss: 4902440.9198; train_global_loss: 42989999.6031; train_optim_loss: 42989999.6031; val_kl_reg_loss: 144251.7990; val_edge_recon_loss: 2835555.5167; val_gene_expr_recon_loss: 34884122.2667; val_masked_gp_l1_reg_loss: 106228.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122268.6016; val_chrom_access_recon_loss: 4936457.0333; val_global_loss: 43028883.2000; val_optim_loss: 43028883.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9582; val_auprc_score: 0.9522; val_best_acc_score: 0.8941; val_best_f1_score: 0.8979; train_kl_reg_loss: 143142.8170; train_edge_recon_loss: 2795806.0363; train_gene_expr_recon_loss: 34822616.7634; train_masked_gp_l1_reg_loss: 107296.3969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119884.4735; train_chrom_access_recon_loss: 4897851.1679; train_global_loss: 42886597.3435; train_optim_loss: 42886597.3435; val_kl_reg_loss: 145909.6781; val_edge_recon_loss: 2806806.3500; val_gene_expr_recon_loss: 34681274.2667; val_masked_gp_l1_reg_loss: 108286.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117462.1562; val_chrom_access_recon_loss: 4921309.6000; val_global_loss: 42781051.7333; val_optim_loss: 42781051.7333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9580; val_auprc_score: 0.9482; val_best_acc_score: 0.8972; val_best_f1_score: 0.9010; train_kl_reg_loss: 142090.2667; train_edge_recon_loss: 2792138.8531; train_gene_expr_recon_loss: 34714843.1450; train_masked_gp_l1_reg_loss: 109329.4513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115258.0200; train_chrom_access_recon_loss: 4883617.6489; train_global_loss: 42757277.6183; train_optim_loss: 42757277.6183; val_kl_reg_loss: 140851.4813; val_edge_recon_loss: 2806738.0667; val_gene_expr_recon_loss: 34738603.8667; val_masked_gp_l1_reg_loss: 110209.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113015.6094; val_chrom_access_recon_loss: 4909774.3667; val_global_loss: 42819192.0000; val_optim_loss: 42819192.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9621; val_auprc_score: 0.9505; val_best_acc_score: 0.9096; val_best_f1_score: 0.9123; train_kl_reg_loss: 138745.5706; train_edge_recon_loss: 2784258.6813; train_gene_expr_recon_loss: 34698556.0916; train_masked_gp_l1_reg_loss: 111185.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110876.9296; train_chrom_access_recon_loss: 4887113.2252; train_global_loss: 42730736.5802; train_optim_loss: 42730736.5802; val_kl_reg_loss: 136520.7177; val_edge_recon_loss: 2785379.4667; val_gene_expr_recon_loss: 34592696.2667; val_masked_gp_l1_reg_loss: 112261.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108699.8438; val_chrom_access_recon_loss: 4907497.4000; val_global_loss: 42643053.6000; val_optim_loss: 42643053.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9648; val_auprc_score: 0.9553; val_best_acc_score: 0.9108; val_best_f1_score: 0.9140; train_kl_reg_loss: 135590.1460; train_edge_recon_loss: 2781425.6221; train_gene_expr_recon_loss: 34622684.3511; train_masked_gp_l1_reg_loss: 113238.0021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106721.6010; train_chrom_access_recon_loss: 4877161.8740; train_global_loss: 42636821.6794; train_optim_loss: 42636821.6794; val_kl_reg_loss: 137284.7073; val_edge_recon_loss: 2775202.7167; val_gene_expr_recon_loss: 34570841.6000; val_masked_gp_l1_reg_loss: 114339.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104733.7891; val_chrom_access_recon_loss: 4889454.3667; val_global_loss: 42591854.9333; val_optim_loss: 42591854.9333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9671; val_auprc_score: 0.9599; val_best_acc_score: 0.9151; val_best_f1_score: 0.9173; train_kl_reg_loss: 134447.0839; train_edge_recon_loss: 2774957.2195; train_gene_expr_recon_loss: 34553552.7939; train_masked_gp_l1_reg_loss: 115095.9776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102833.1812; train_chrom_access_recon_loss: 4870926.1069; train_global_loss: 42551812.3359; train_optim_loss: 42551812.3359; val_kl_reg_loss: 134641.7016; val_edge_recon_loss: 2770816.2500; val_gene_expr_recon_loss: 34633559.2000; val_masked_gp_l1_reg_loss: 115845.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100985.8438; val_chrom_access_recon_loss: 4897760.4667; val_global_loss: 42653605.6000; val_optim_loss: 42653605.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9666; val_auprc_score: 0.9560; val_best_acc_score: 0.9158; val_best_f1_score: 0.9196; train_kl_reg_loss: 131602.3887; train_edge_recon_loss: 2773108.3034; train_gene_expr_recon_loss: 34524893.9237; train_masked_gp_l1_reg_loss: 116858.7748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99204.7742; train_chrom_access_recon_loss: 4870598.2481; train_global_loss: 42516266.3511; train_optim_loss: 42516266.3511; val_kl_reg_loss: 132068.3500; val_edge_recon_loss: 2775687.8667; val_gene_expr_recon_loss: 34551536.8000; val_masked_gp_l1_reg_loss: 117902.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97453.3906; val_chrom_access_recon_loss: 4892421.0000; val_global_loss: 42567070.1333; val_optim_loss: 42567070.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9725; val_auprc_score: 0.9668; val_best_acc_score: 0.9224; val_best_f1_score: 0.9250; train_kl_reg_loss: 129696.4145; train_edge_recon_loss: 2774706.0076; train_gene_expr_recon_loss: 34456513.1298; train_masked_gp_l1_reg_loss: 118727.9739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95826.1215; train_chrom_access_recon_loss: 4867504.7481; train_global_loss: 42442974.3206; train_optim_loss: 42442974.3206; val_kl_reg_loss: 129656.3318; val_edge_recon_loss: 2759504.8333; val_gene_expr_recon_loss: 34423674.2667; val_masked_gp_l1_reg_loss: 119593.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94232.2109; val_chrom_access_recon_loss: 4885885.5667; val_global_loss: 42412544.5333; val_optim_loss: 42412544.5333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9741; val_auprc_score: 0.9669; val_best_acc_score: 0.9255; val_best_f1_score: 0.9279; train_kl_reg_loss: 127672.5122; train_edge_recon_loss: 2756153.0324; train_gene_expr_recon_loss: 34377546.4580; train_masked_gp_l1_reg_loss: 120544.5850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92713.8539; train_chrom_access_recon_loss: 4859232.2405; train_global_loss: 42333862.5954; train_optim_loss: 42333862.5954; val_kl_reg_loss: 126242.4672; val_edge_recon_loss: 2748675.5000; val_gene_expr_recon_loss: 34478629.2000; val_masked_gp_l1_reg_loss: 121409.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91178.1484; val_chrom_access_recon_loss: 4904091.2000; val_global_loss: 42470226.4000; val_optim_loss: 42470226.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9736; val_auprc_score: 0.9651; val_best_acc_score: 0.9276; val_best_f1_score: 0.9296; train_kl_reg_loss: 126061.7658; train_edge_recon_loss: 2756722.6240; train_gene_expr_recon_loss: 34350819.0992; train_masked_gp_l1_reg_loss: 122344.4164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89816.0029; train_chrom_access_recon_loss: 4862115.3779; train_global_loss: 42307879.2672; train_optim_loss: 42307879.2672; val_kl_reg_loss: 126767.5047; val_edge_recon_loss: 2770233.3000; val_gene_expr_recon_loss: 34450406.9333; val_masked_gp_l1_reg_loss: 123615.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88506.1016; val_chrom_access_recon_loss: 4902223.1667; val_global_loss: 42461754.4000; val_optim_loss: 42461754.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9749; val_auprc_score: 0.9698; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 125448.6615; train_edge_recon_loss: 2746199.6756; train_gene_expr_recon_loss: 34292422.9618; train_masked_gp_l1_reg_loss: 124272.3254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87166.7106; train_chrom_access_recon_loss: 4856704.6450; train_global_loss: 42232214.7786; train_optim_loss: 42232214.7786; val_kl_reg_loss: 124320.9411; val_edge_recon_loss: 2765224.0000; val_gene_expr_recon_loss: 34188391.6000; val_masked_gp_l1_reg_loss: 125123.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85852.9688; val_chrom_access_recon_loss: 4865775.3000; val_global_loss: 42154687.7333; val_optim_loss: 42154687.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9715; val_auprc_score: 0.9671; val_best_acc_score: 0.9173; val_best_f1_score: 0.9190; train_kl_reg_loss: 141872.4937; train_edge_recon_loss: 2867410.2137; train_gene_expr_recon_loss: 36282651.4809; train_masked_gp_l1_reg_loss: 126477.2545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89124.7031; train_chrom_access_recon_loss: 4940405.3473; train_global_loss: 44447941.0687; train_optim_loss: 44447941.0687; val_kl_reg_loss: 49250.4328; val_edge_recon_loss: 2829348.4833; val_gene_expr_recon_loss: 36134992.8000; val_masked_gp_l1_reg_loss: 127688.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89775.2578; val_chrom_access_recon_loss: 4960371.4000; val_global_loss: 44191427.4667; val_optim_loss: 44191427.4667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9729; val_auprc_score: 0.9684; val_best_acc_score: 0.9219; val_best_f1_score: 0.9250; train_kl_reg_loss: 133998.3658; train_edge_recon_loss: 2792313.7920; train_gene_expr_recon_loss: 36025972.9160; train_masked_gp_l1_reg_loss: 128097.9594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88811.2505; train_chrom_access_recon_loss: 4927902.9122; train_global_loss: 44097097.1603; train_optim_loss: 44097097.1603; val_kl_reg_loss: 59839.3526; val_edge_recon_loss: 2766072.0167; val_gene_expr_recon_loss: 35994714.4000; val_masked_gp_l1_reg_loss: 128105.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87349.5469; val_chrom_access_recon_loss: 4973956.0000; val_global_loss: 44010033.8667; val_optim_loss: 44010033.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9713; val_auprc_score: 0.9657; val_best_acc_score: 0.9174; val_best_f1_score: 0.9201; train_kl_reg_loss: 119651.7400; train_edge_recon_loss: 2772129.6565; train_gene_expr_recon_loss: 35863397.9542; train_masked_gp_l1_reg_loss: 127743.4262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85866.9727; train_chrom_access_recon_loss: 4923777.1260; train_global_loss: 43892566.6565; train_optim_loss: 43892566.6565; val_kl_reg_loss: 66517.3427; val_edge_recon_loss: 2774629.3667; val_gene_expr_recon_loss: 35826724.1333; val_masked_gp_l1_reg_loss: 127415.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84327.3594; val_chrom_access_recon_loss: 4939755.1000; val_global_loss: 43819369.6000; val_optim_loss: 43819369.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9717; val_auprc_score: 0.9657; val_best_acc_score: 0.9173; val_best_f1_score: 0.9197; train_kl_reg_loss: 112667.2564; train_edge_recon_loss: 2767210.6985; train_gene_expr_recon_loss: 35885602.6565; train_masked_gp_l1_reg_loss: 127032.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83266.8919; train_chrom_access_recon_loss: 4922839.4771; train_global_loss: 43898619.1756; train_optim_loss: 43898619.1756; val_kl_reg_loss: 63161.0625; val_edge_recon_loss: 2780173.6667; val_gene_expr_recon_loss: 36155006.9333; val_masked_gp_l1_reg_loss: 126550.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82324.0391; val_chrom_access_recon_loss: 4986845.8000; val_global_loss: 44194063.7333; val_optim_loss: 44194063.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9687; val_auprc_score: 0.9571; val_best_acc_score: 0.9173; val_best_f1_score: 0.9196; train_kl_reg_loss: 113594.8979; train_edge_recon_loss: 2764497.5229; train_gene_expr_recon_loss: 36054828.9771; train_masked_gp_l1_reg_loss: 126230.8695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82147.4051; train_chrom_access_recon_loss: 4929763.0458; train_global_loss: 44071062.6870; train_optim_loss: 44071062.6870; val_kl_reg_loss: 66667.0427; val_edge_recon_loss: 2766735.1333; val_gene_expr_recon_loss: 36190321.3333; val_masked_gp_l1_reg_loss: 126141.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81980.4922; val_chrom_access_recon_loss: 4995106.7667; val_global_loss: 44226950.6667; val_optim_loss: 44226950.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9705; val_auprc_score: 0.9649; val_best_acc_score: 0.9155; val_best_f1_score: 0.9188; train_kl_reg_loss: 114893.5785; train_edge_recon_loss: 2767040.5916; train_gene_expr_recon_loss: 36020421.8015; train_masked_gp_l1_reg_loss: 126063.7498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81829.6161; train_chrom_access_recon_loss: 4923593.4885; train_global_loss: 44033843.2061; train_optim_loss: 44033843.2061; val_kl_reg_loss: 68525.8255; val_edge_recon_loss: 2774676.8333; val_gene_expr_recon_loss: 35954272.8000; val_masked_gp_l1_reg_loss: 125992.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81658.4141; val_chrom_access_recon_loss: 4936300.5000; val_global_loss: 43941428.2667; val_optim_loss: 43941428.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9710; val_auprc_score: 0.9648; val_best_acc_score: 0.9161; val_best_f1_score: 0.9193; train_kl_reg_loss: 114952.5866; train_edge_recon_loss: 2763466.3225; train_gene_expr_recon_loss: 36041619.9084; train_masked_gp_l1_reg_loss: 125908.8591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81484.6621; train_chrom_access_recon_loss: 4925291.7328; train_global_loss: 44052724.0916; train_optim_loss: 44052724.0916; val_kl_reg_loss: 70172.4385; val_edge_recon_loss: 2764866.0667; val_gene_expr_recon_loss: 36120481.3333; val_masked_gp_l1_reg_loss: 125826.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81307.0859; val_chrom_access_recon_loss: 4959759.1333; val_global_loss: 44122415.4667; val_optim_loss: 44122415.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9710; val_auprc_score: 0.9629; val_best_acc_score: 0.9197; val_best_f1_score: 0.9224; train_kl_reg_loss: 114579.7424; train_edge_recon_loss: 2753871.3664; train_gene_expr_recon_loss: 36043875.1145; train_masked_gp_l1_reg_loss: 125735.1405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81123.7250; train_chrom_access_recon_loss: 4923825.7557; train_global_loss: 44043010.7481; train_optim_loss: 44043010.7481; val_kl_reg_loss: 71053.4583; val_edge_recon_loss: 2740014.4000; val_gene_expr_recon_loss: 36185642.6667; val_masked_gp_l1_reg_loss: 125638.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80940.3594; val_chrom_access_recon_loss: 4977653.8667; val_global_loss: 44180944.8000; val_optim_loss: 44180944.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9753
val AUPRC score: 0.9704
val best accuracy score: 0.9241
val best F1 score: 0.9270
val target rna MSE score: 1.1832
val source rna MSE score: 41.7910
val target atac MSE score: 0.3538
val source atac MSE score: 3.2912
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
