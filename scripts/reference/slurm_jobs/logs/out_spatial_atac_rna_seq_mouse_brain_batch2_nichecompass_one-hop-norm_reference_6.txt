[True]
Run timestamp: 26072023_010025_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9394; val_auprc_score: 0.9407; val_best_acc_score: 0.5975; val_best_f1_score: 0.7127; train_kl_reg_loss: 3653.9483; train_edge_recon_loss: 349023.0625; train_gene_expr_recon_loss: 307845.2535; train_masked_gp_l1_reg_loss: 1593.8708; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1072534.1458; train_global_loss: 1734650.3056; train_optim_loss: 1734650.3056; val_kl_reg_loss: 5819.7734; val_edge_recon_loss: 405975.8750; val_gene_expr_recon_loss: 287910.9375; val_masked_gp_l1_reg_loss: 1371.4539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063117.2500; val_global_loss: 1764195.2500; val_optim_loss: 1764195.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9112; val_auprc_score: 0.9132; val_best_acc_score: 0.6632; val_best_f1_score: 0.7467; train_kl_reg_loss: 9663.4673; train_edge_recon_loss: 353550.0833; train_gene_expr_recon_loss: 282831.2326; train_masked_gp_l1_reg_loss: 1319.3278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059347.7361; train_global_loss: 1706711.8333; train_optim_loss: 1706711.8333; val_kl_reg_loss: 9576.0078; val_edge_recon_loss: 405586.2812; val_gene_expr_recon_loss: 267662.5625; val_masked_gp_l1_reg_loss: 1302.8113; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1042808.8125; val_global_loss: 1726936.5000; val_optim_loss: 1726936.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9086; val_auprc_score: 0.9045; val_best_acc_score: 0.7877; val_best_f1_score: 0.8194; train_kl_reg_loss: 14908.5840; train_edge_recon_loss: 356744.7882; train_gene_expr_recon_loss: 262387.6059; train_masked_gp_l1_reg_loss: 1354.7546; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037961.6250; train_global_loss: 1673357.3472; train_optim_loss: 1673357.3472; val_kl_reg_loss: 13492.4102; val_edge_recon_loss: 403843.0938; val_gene_expr_recon_loss: 251623.9688; val_masked_gp_l1_reg_loss: 1435.7363; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025951.2500; val_global_loss: 1696346.5000; val_optim_loss: 1696346.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8857; val_auprc_score: 0.8670; val_best_acc_score: 0.7827; val_best_f1_score: 0.8161; train_kl_reg_loss: 16759.0202; train_edge_recon_loss: 356414.9861; train_gene_expr_recon_loss: 249870.2778; train_masked_gp_l1_reg_loss: 1495.0816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018746.1319; train_global_loss: 1643285.4861; train_optim_loss: 1643285.4861; val_kl_reg_loss: 15246.1455; val_edge_recon_loss: 390470.8438; val_gene_expr_recon_loss: 242758.5000; val_masked_gp_l1_reg_loss: 1554.2681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014595.8750; val_global_loss: 1664625.6250; val_optim_loss: 1664625.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8727; val_auprc_score: 0.8488; val_best_acc_score: 0.7898; val_best_f1_score: 0.8118; train_kl_reg_loss: 17240.8338; train_edge_recon_loss: 344944.1667; train_gene_expr_recon_loss: 244923.0451; train_masked_gp_l1_reg_loss: 1591.6618; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011282.3194; train_global_loss: 1619982.0278; train_optim_loss: 1619982.0278; val_kl_reg_loss: 16937.1699; val_edge_recon_loss: 334661.5625; val_gene_expr_recon_loss: 241808.1875; val_masked_gp_l1_reg_loss: 1634.7727; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010697.7500; val_global_loss: 1605739.3750; val_optim_loss: 1605739.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8702; val_auprc_score: 0.8545; val_best_acc_score: 0.7781; val_best_f1_score: 0.8058; train_kl_reg_loss: 26019.4184; train_edge_recon_loss: 314504.7153; train_gene_expr_recon_loss: 242628.2448; train_masked_gp_l1_reg_loss: 1670.3013; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009788.7361; train_global_loss: 1594611.4444; train_optim_loss: 1594611.4444; val_kl_reg_loss: 27607.6270; val_edge_recon_loss: 313579.3125; val_gene_expr_recon_loss: 235719.2344; val_masked_gp_l1_reg_loss: 1710.5603; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001866.2500; val_global_loss: 1580483.0000; val_optim_loss: 1580483.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8898; val_auprc_score: 0.8724; val_best_acc_score: 0.7986; val_best_f1_score: 0.8202; train_kl_reg_loss: 26363.0258; train_edge_recon_loss: 308677.6597; train_gene_expr_recon_loss: 239154.1545; train_masked_gp_l1_reg_loss: 1739.4600; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008964.8681; train_global_loss: 1584899.1389; train_optim_loss: 1584899.1389; val_kl_reg_loss: 23555.6250; val_edge_recon_loss: 305615.4375; val_gene_expr_recon_loss: 233717.4844; val_masked_gp_l1_reg_loss: 1772.6788; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999403.5000; val_global_loss: 1564064.7500; val_optim_loss: 1564064.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8899; val_auprc_score: 0.8694; val_best_acc_score: 0.7897; val_best_f1_score: 0.8135; train_kl_reg_loss: 25455.3431; train_edge_recon_loss: 306962.1285; train_gene_expr_recon_loss: 235688.0677; train_masked_gp_l1_reg_loss: 1796.9702; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003255.5833; train_global_loss: 1573158.0694; train_optim_loss: 1573158.0694; val_kl_reg_loss: 22284.9570; val_edge_recon_loss: 303701.9062; val_gene_expr_recon_loss: 231787.2969; val_masked_gp_l1_reg_loss: 1823.5103; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998006.5625; val_global_loss: 1557604.2500; val_optim_loss: 1557604.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8987; val_auprc_score: 0.8825; val_best_acc_score: 0.7960; val_best_f1_score: 0.8186; train_kl_reg_loss: 24959.8739; train_edge_recon_loss: 305382.7500; train_gene_expr_recon_loss: 232613.7656; train_masked_gp_l1_reg_loss: 1847.0233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998477.6736; train_global_loss: 1563281.0972; train_optim_loss: 1563281.0972; val_kl_reg_loss: 24194.4727; val_edge_recon_loss: 305000.4688; val_gene_expr_recon_loss: 227941.1719; val_masked_gp_l1_reg_loss: 1871.0864; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 992953.6875; val_global_loss: 1551960.8750; val_optim_loss: 1551960.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9145; val_auprc_score: 0.8983; val_best_acc_score: 0.8273; val_best_f1_score: 0.8413; train_kl_reg_loss: 24861.4844; train_edge_recon_loss: 304285.7257; train_gene_expr_recon_loss: 229340.5052; train_masked_gp_l1_reg_loss: 1894.4557; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997316.0833; train_global_loss: 1557698.2361; train_optim_loss: 1557698.2361; val_kl_reg_loss: 24511.9375; val_edge_recon_loss: 301806.4688; val_gene_expr_recon_loss: 226409.7031; val_masked_gp_l1_reg_loss: 1917.9331; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990893.1250; val_global_loss: 1545539.2500; val_optim_loss: 1545539.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9226; val_auprc_score: 0.9082; val_best_acc_score: 0.8498; val_best_f1_score: 0.8562; train_kl_reg_loss: 24782.0508; train_edge_recon_loss: 301684.1910; train_gene_expr_recon_loss: 229583.2743; train_masked_gp_l1_reg_loss: 1938.8446; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994634.3889; train_global_loss: 1552622.7500; train_optim_loss: 1552622.7500; val_kl_reg_loss: 23432.6113; val_edge_recon_loss: 298489.3125; val_gene_expr_recon_loss: 226038.8750; val_masked_gp_l1_reg_loss: 1962.7803; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990562.2500; val_global_loss: 1540485.7500; val_optim_loss: 1540485.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9375; val_auprc_score: 0.9233; val_best_acc_score: 0.8667; val_best_f1_score: 0.8733; train_kl_reg_loss: 24765.4900; train_edge_recon_loss: 300056.5278; train_gene_expr_recon_loss: 226254.4010; train_masked_gp_l1_reg_loss: 1984.8341; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987216.0764; train_global_loss: 1540277.3194; train_optim_loss: 1540277.3194; val_kl_reg_loss: 24046.6016; val_edge_recon_loss: 299339.0312; val_gene_expr_recon_loss: 223869.1094; val_masked_gp_l1_reg_loss: 2008.7671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987737.5000; val_global_loss: 1537001.0000; val_optim_loss: 1537001.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9504; val_auprc_score: 0.9355; val_best_acc_score: 0.8886; val_best_f1_score: 0.8921; train_kl_reg_loss: 25345.1602; train_edge_recon_loss: 296244.2292; train_gene_expr_recon_loss: 225922.9722; train_masked_gp_l1_reg_loss: 2029.4910; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986575.4028; train_global_loss: 1536117.2361; train_optim_loss: 1536117.2361; val_kl_reg_loss: 23264.4922; val_edge_recon_loss: 296751.1562; val_gene_expr_recon_loss: 223091.4531; val_masked_gp_l1_reg_loss: 2055.2183; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985532.3125; val_global_loss: 1530694.6250; val_optim_loss: 1530694.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9534; val_auprc_score: 0.9393; val_best_acc_score: 0.8960; val_best_f1_score: 0.8990; train_kl_reg_loss: 25693.4397; train_edge_recon_loss: 293973.5521; train_gene_expr_recon_loss: 225049.5399; train_masked_gp_l1_reg_loss: 2075.7403; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985825.2639; train_global_loss: 1532617.5417; train_optim_loss: 1532617.5417; val_kl_reg_loss: 24038.3555; val_edge_recon_loss: 294319.1250; val_gene_expr_recon_loss: 221352.9844; val_masked_gp_l1_reg_loss: 2097.3801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982802.3750; val_global_loss: 1524610.2500; val_optim_loss: 1524610.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9542; val_auprc_score: 0.9392; val_best_acc_score: 0.8995; val_best_f1_score: 0.9031; train_kl_reg_loss: 25509.7231; train_edge_recon_loss: 293615.1667; train_gene_expr_recon_loss: 224013.2969; train_masked_gp_l1_reg_loss: 2117.5149; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984722.4931; train_global_loss: 1529978.1667; train_optim_loss: 1529978.1667; val_kl_reg_loss: 24151.5352; val_edge_recon_loss: 288546.7812; val_gene_expr_recon_loss: 221674.0938; val_masked_gp_l1_reg_loss: 2139.2019; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982730.9375; val_global_loss: 1519242.5000; val_optim_loss: 1519242.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9590; val_auprc_score: 0.9484; val_best_acc_score: 0.9073; val_best_f1_score: 0.9110; train_kl_reg_loss: 25331.4915; train_edge_recon_loss: 291167.2049; train_gene_expr_recon_loss: 222462.2205; train_masked_gp_l1_reg_loss: 2160.4907; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983835.2569; train_global_loss: 1524956.6528; train_optim_loss: 1524956.6528; val_kl_reg_loss: 24000.0078; val_edge_recon_loss: 289775.0938; val_gene_expr_recon_loss: 221081.6094; val_masked_gp_l1_reg_loss: 2179.5518; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982803.7500; val_global_loss: 1519840.0000; val_optim_loss: 1519840.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9610; val_auprc_score: 0.9433; val_best_acc_score: 0.9124; val_best_f1_score: 0.9153; train_kl_reg_loss: 25095.6204; train_edge_recon_loss: 289635.0174; train_gene_expr_recon_loss: 221226.8247; train_masked_gp_l1_reg_loss: 2196.7396; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982150.0347; train_global_loss: 1520304.2361; train_optim_loss: 1520304.2361; val_kl_reg_loss: 24356.0742; val_edge_recon_loss: 288501.3125; val_gene_expr_recon_loss: 219324.2812; val_masked_gp_l1_reg_loss: 2213.2305; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979659.3125; val_global_loss: 1514054.2500; val_optim_loss: 1514054.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9632; val_auprc_score: 0.9491; val_best_acc_score: 0.9127; val_best_f1_score: 0.9155; train_kl_reg_loss: 25289.9117; train_edge_recon_loss: 287998.6007; train_gene_expr_recon_loss: 221208.6528; train_masked_gp_l1_reg_loss: 2227.5278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981586.0278; train_global_loss: 1518310.7222; train_optim_loss: 1518310.7222; val_kl_reg_loss: 24256.2715; val_edge_recon_loss: 288811.7500; val_gene_expr_recon_loss: 217837.0938; val_masked_gp_l1_reg_loss: 2244.4861; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977715.3125; val_global_loss: 1510865.0000; val_optim_loss: 1510865.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9651; val_auprc_score: 0.9536; val_best_acc_score: 0.9131; val_best_f1_score: 0.9169; train_kl_reg_loss: 24905.8451; train_edge_recon_loss: 287577.2778; train_gene_expr_recon_loss: 219401.9757; train_masked_gp_l1_reg_loss: 2259.6629; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977586.3264; train_global_loss: 1511731.0833; train_optim_loss: 1511731.0833; val_kl_reg_loss: 23421.3496; val_edge_recon_loss: 287571.3438; val_gene_expr_recon_loss: 219114.8438; val_masked_gp_l1_reg_loss: 2277.0271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978528.3125; val_global_loss: 1510912.7500; val_optim_loss: 1510912.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9683; val_auprc_score: 0.9579; val_best_acc_score: 0.9189; val_best_f1_score: 0.9219; train_kl_reg_loss: 24857.2151; train_edge_recon_loss: 287963.2778; train_gene_expr_recon_loss: 219163.1389; train_masked_gp_l1_reg_loss: 2294.8401; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980995.8750; train_global_loss: 1515274.3472; train_optim_loss: 1515274.3472; val_kl_reg_loss: 22187.7461; val_edge_recon_loss: 287359.5000; val_gene_expr_recon_loss: 218717.4844; val_masked_gp_l1_reg_loss: 2308.8433; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977928.7500; val_global_loss: 1508502.2500; val_optim_loss: 1508502.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9660; val_auprc_score: 0.9561; val_best_acc_score: 0.9136; val_best_f1_score: 0.9171; train_kl_reg_loss: 24509.3902; train_edge_recon_loss: 286695.2951; train_gene_expr_recon_loss: 219421.7708; train_masked_gp_l1_reg_loss: 2322.7502; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978830.2917; train_global_loss: 1511779.5000; train_optim_loss: 1511779.5000; val_kl_reg_loss: 22682.0352; val_edge_recon_loss: 288962.4688; val_gene_expr_recon_loss: 217560.8125; val_masked_gp_l1_reg_loss: 2338.5586; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975631.9375; val_global_loss: 1507175.7500; val_optim_loss: 1507175.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9674; val_auprc_score: 0.9560; val_best_acc_score: 0.9223; val_best_f1_score: 0.9252; train_kl_reg_loss: 24235.5095; train_edge_recon_loss: 286082.9132; train_gene_expr_recon_loss: 219371.5521; train_masked_gp_l1_reg_loss: 2352.0461; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978198.0833; train_global_loss: 1510240.1389; train_optim_loss: 1510240.1389; val_kl_reg_loss: 23092.2500; val_edge_recon_loss: 283784.9375; val_gene_expr_recon_loss: 217826.6406; val_masked_gp_l1_reg_loss: 2365.4712; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976512.8750; val_global_loss: 1503582.2500; val_optim_loss: 1503582.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9691; val_auprc_score: 0.9575; val_best_acc_score: 0.9208; val_best_f1_score: 0.9232; train_kl_reg_loss: 24168.5482; train_edge_recon_loss: 285433.4965; train_gene_expr_recon_loss: 216873.9670; train_masked_gp_l1_reg_loss: 2381.4484; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974216.5486; train_global_loss: 1503074.0278; train_optim_loss: 1503074.0278; val_kl_reg_loss: 24023.7363; val_edge_recon_loss: 286691.6562; val_gene_expr_recon_loss: 215438.4531; val_masked_gp_l1_reg_loss: 2396.5833; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971921.6875; val_global_loss: 1500472.1250; val_optim_loss: 1500472.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9720; val_auprc_score: 0.9627; val_best_acc_score: 0.9217; val_best_f1_score: 0.9253; train_kl_reg_loss: 24040.4763; train_edge_recon_loss: 285424.9236; train_gene_expr_recon_loss: 216685.4080; train_masked_gp_l1_reg_loss: 2407.4766; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973298.9931; train_global_loss: 1501857.2639; train_optim_loss: 1501857.2639; val_kl_reg_loss: 22320.0195; val_edge_recon_loss: 286268.3750; val_gene_expr_recon_loss: 216101.9688; val_masked_gp_l1_reg_loss: 2419.9185; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972558.2500; val_global_loss: 1499668.5000; val_optim_loss: 1499668.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9681; val_auprc_score: 0.9556; val_best_acc_score: 0.9255; val_best_f1_score: 0.9285; train_kl_reg_loss: 23929.3511; train_edge_recon_loss: 284529.0035; train_gene_expr_recon_loss: 216116.5920; train_masked_gp_l1_reg_loss: 2433.6520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972055.2222; train_global_loss: 1499063.7778; train_optim_loss: 1499063.7778; val_kl_reg_loss: 22410.6855; val_edge_recon_loss: 283263.2812; val_gene_expr_recon_loss: 215902.9531; val_masked_gp_l1_reg_loss: 2445.7588; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969875.8750; val_global_loss: 1493898.5000; val_optim_loss: 1493898.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9706; val_auprc_score: 0.9607; val_best_acc_score: 0.9209; val_best_f1_score: 0.9234; train_kl_reg_loss: 26205.3118; train_edge_recon_loss: 299747.0625; train_gene_expr_recon_loss: 222724.1319; train_masked_gp_l1_reg_loss: 2461.4042; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978398.3472; train_global_loss: 1529536.2500; train_optim_loss: 1529536.2500; val_kl_reg_loss: 13279.6270; val_edge_recon_loss: 292109.5000; val_gene_expr_recon_loss: 220983.6406; val_masked_gp_l1_reg_loss: 2477.1091; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977928.0625; val_global_loss: 1506778.0000; val_optim_loss: 1506778.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9706; val_auprc_score: 0.9605; val_best_acc_score: 0.9233; val_best_f1_score: 0.9254; train_kl_reg_loss: 22056.7652; train_edge_recon_loss: 291343.5486; train_gene_expr_recon_loss: 218555.2604; train_masked_gp_l1_reg_loss: 2485.9906; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970643.0278; train_global_loss: 1505084.5833; train_optim_loss: 1505084.5833; val_kl_reg_loss: 14890.0957; val_edge_recon_loss: 287821.6562; val_gene_expr_recon_loss: 219717.4219; val_masked_gp_l1_reg_loss: 2493.8032; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974985.2500; val_global_loss: 1499908.2500; val_optim_loss: 1499908.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9692; val_auprc_score: 0.9550; val_best_acc_score: 0.9221; val_best_f1_score: 0.9252; train_kl_reg_loss: 21332.8633; train_edge_recon_loss: 286372.1458; train_gene_expr_recon_loss: 218837.4983; train_masked_gp_l1_reg_loss: 2498.5255; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978902.0833; train_global_loss: 1507943.1111; train_optim_loss: 1507943.1111; val_kl_reg_loss: 16285.5547; val_edge_recon_loss: 288406.4688; val_gene_expr_recon_loss: 218178.0938; val_masked_gp_l1_reg_loss: 2502.7444; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974704.1250; val_global_loss: 1500077.0000; val_optim_loss: 1500077.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9716; val_auprc_score: 0.9608; val_best_acc_score: 0.9291; val_best_f1_score: 0.9311; train_kl_reg_loss: 21429.7246; train_edge_recon_loss: 286700.0799; train_gene_expr_recon_loss: 219044.7899; train_masked_gp_l1_reg_loss: 2507.1054; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973452.9444; train_global_loss: 1503134.6111; train_optim_loss: 1503134.6111; val_kl_reg_loss: 16621.1992; val_edge_recon_loss: 285339.0625; val_gene_expr_recon_loss: 217582.3594; val_masked_gp_l1_reg_loss: 2511.9966; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972741.8750; val_global_loss: 1494796.5000; val_optim_loss: 1494796.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9627; val_best_acc_score: 0.9264; val_best_f1_score: 0.9289; train_kl_reg_loss: 21408.2758; train_edge_recon_loss: 285231.2500; train_gene_expr_recon_loss: 218570.7031; train_masked_gp_l1_reg_loss: 2508.4677; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973772.3333; train_global_loss: 1501491.0278; train_optim_loss: 1501491.0278; val_kl_reg_loss: 16321.4443; val_edge_recon_loss: 286625.5000; val_gene_expr_recon_loss: 216986.5938; val_masked_gp_l1_reg_loss: 2504.6172; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973241.8125; val_global_loss: 1495680.0000; val_optim_loss: 1495680.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9725; val_auprc_score: 0.9638; val_best_acc_score: 0.9248; val_best_f1_score: 0.9274; train_kl_reg_loss: 21507.7361; train_edge_recon_loss: 285588.5590; train_gene_expr_recon_loss: 217592.4635; train_masked_gp_l1_reg_loss: 2503.3504; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974898.7500; train_global_loss: 1502090.8889; train_optim_loss: 1502090.8889; val_kl_reg_loss: 16361.2363; val_edge_recon_loss: 286900.3125; val_gene_expr_recon_loss: 217735.2500; val_masked_gp_l1_reg_loss: 2501.6343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973525.4375; val_global_loss: 1497023.8750; val_optim_loss: 1497023.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9721; val_auprc_score: 0.9598; val_best_acc_score: 0.9290; val_best_f1_score: 0.9312; train_kl_reg_loss: 21583.6155; train_edge_recon_loss: 285296.8889; train_gene_expr_recon_loss: 218723.0816; train_masked_gp_l1_reg_loss: 2500.8274; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974881.9514; train_global_loss: 1502986.3611; train_optim_loss: 1502986.3611; val_kl_reg_loss: 16666.6484; val_edge_recon_loss: 286572.7188; val_gene_expr_recon_loss: 216853.3281; val_masked_gp_l1_reg_loss: 2499.9648; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971075.7500; val_global_loss: 1493668.3750; val_optim_loss: 1493668.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9742; val_auprc_score: 0.9653; val_best_acc_score: 0.9290; val_best_f1_score: 0.9314; train_kl_reg_loss: 21364.8236; train_edge_recon_loss: 285377.2986; train_gene_expr_recon_loss: 217136.6007; train_masked_gp_l1_reg_loss: 2499.4708; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969185.1181; train_global_loss: 1495563.3333; train_optim_loss: 1495563.3333; val_kl_reg_loss: 16433.9688; val_edge_recon_loss: 286322.1875; val_gene_expr_recon_loss: 217008.7344; val_masked_gp_l1_reg_loss: 2499.1013; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970480.0000; val_global_loss: 1492744.0000; val_optim_loss: 1492744.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9736; val_auprc_score: 0.9662; val_best_acc_score: 0.9298; val_best_f1_score: 0.9320; train_kl_reg_loss: 21504.3852; train_edge_recon_loss: 284772.9653; train_gene_expr_recon_loss: 217335.7726; train_masked_gp_l1_reg_loss: 2499.0565; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975666.0417; train_global_loss: 1501778.2361; train_optim_loss: 1501778.2361; val_kl_reg_loss: 16431.9551; val_edge_recon_loss: 285912.8750; val_gene_expr_recon_loss: 216980.1094; val_masked_gp_l1_reg_loss: 2498.9426; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972285.1875; val_global_loss: 1494109.0000; val_optim_loss: 1494109.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9725; val_auprc_score: 0.9627; val_best_acc_score: 0.9285; val_best_f1_score: 0.9308; train_kl_reg_loss: 21375.7988; train_edge_recon_loss: 284475.3507; train_gene_expr_recon_loss: 217756.7622; train_masked_gp_l1_reg_loss: 2498.9455; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972247.1319; train_global_loss: 1498354.0000; train_optim_loss: 1498354.0000; val_kl_reg_loss: 16416.5762; val_edge_recon_loss: 286426.1562; val_gene_expr_recon_loss: 217174.7812; val_masked_gp_l1_reg_loss: 2498.9988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972549.2500; val_global_loss: 1495065.7500; val_optim_loss: 1495065.7500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9731; val_auprc_score: 0.9636; val_best_acc_score: 0.9289; val_best_f1_score: 0.9310; train_kl_reg_loss: 21523.2320; train_edge_recon_loss: 285521.1771; train_gene_expr_recon_loss: 217664.6476; train_masked_gp_l1_reg_loss: 2499.0649; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970541.4097; train_global_loss: 1497749.5000; train_optim_loss: 1497749.5000; val_kl_reg_loss: 16509.2754; val_edge_recon_loss: 285744.9688; val_gene_expr_recon_loss: 217132.4531; val_masked_gp_l1_reg_loss: 2499.2085; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972126.6250; val_global_loss: 1494012.5000; val_optim_loss: 1494012.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9727; val_auprc_score: 0.9620; val_best_acc_score: 0.9270; val_best_f1_score: 0.9293; train_kl_reg_loss: 21262.8296; train_edge_recon_loss: 284651.7153; train_gene_expr_recon_loss: 218896.3455; train_masked_gp_l1_reg_loss: 2499.4417; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974274.9097; train_global_loss: 1501585.2500; train_optim_loss: 1501585.2500; val_kl_reg_loss: 16452.2910; val_edge_recon_loss: 285805.9062; val_gene_expr_recon_loss: 216900.8594; val_masked_gp_l1_reg_loss: 2499.6897; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971257.5000; val_global_loss: 1492916.2500; val_optim_loss: 1492916.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9744; val_auprc_score: 0.9639; val_best_acc_score: 0.9293; val_best_f1_score: 0.9314; train_kl_reg_loss: 21103.5770; train_edge_recon_loss: 285328.4688; train_gene_expr_recon_loss: 218211.9444; train_masked_gp_l1_reg_loss: 2499.3307; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972589.5694; train_global_loss: 1499732.8750; train_optim_loss: 1499732.8750; val_kl_reg_loss: 16496.0586; val_edge_recon_loss: 286797.3438; val_gene_expr_recon_loss: 217098.1406; val_masked_gp_l1_reg_loss: 2499.0103; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972865.1875; val_global_loss: 1495755.7500; val_optim_loss: 1495755.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9728; val_auprc_score: 0.9629; val_best_acc_score: 0.9247; val_best_f1_score: 0.9273; train_kl_reg_loss: 21185.2116; train_edge_recon_loss: 284873.3021; train_gene_expr_recon_loss: 218546.4444; train_masked_gp_l1_reg_loss: 2498.9491; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975269.0903; train_global_loss: 1502373.0000; train_optim_loss: 1502373.0000; val_kl_reg_loss: 16641.5059; val_edge_recon_loss: 286340.0312; val_gene_expr_recon_loss: 217369.3125; val_masked_gp_l1_reg_loss: 2498.8313; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974230.1250; val_global_loss: 1497079.7500; val_optim_loss: 1497079.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9727; val_auprc_score: 0.9627; val_best_acc_score: 0.9291; val_best_f1_score: 0.9312; train_kl_reg_loss: 21159.9941; train_edge_recon_loss: 284578.8438; train_gene_expr_recon_loss: 218683.5347; train_masked_gp_l1_reg_loss: 2498.7731; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974851.5556; train_global_loss: 1501772.7222; train_optim_loss: 1501772.7222; val_kl_reg_loss: 16611.0391; val_edge_recon_loss: 285234.8750; val_gene_expr_recon_loss: 217079.4375; val_masked_gp_l1_reg_loss: 2498.7114; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973216.5000; val_global_loss: 1494640.5000; val_optim_loss: 1494640.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9710; val_auprc_score: 0.9595; val_best_acc_score: 0.9256; val_best_f1_score: 0.9280; train_kl_reg_loss: 21203.5584; train_edge_recon_loss: 283538.4306; train_gene_expr_recon_loss: 217740.5451; train_masked_gp_l1_reg_loss: 2498.6843; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972816.5000; train_global_loss: 1497797.7222; train_optim_loss: 1497797.7222; val_kl_reg_loss: 16690.6016; val_edge_recon_loss: 286141.4375; val_gene_expr_recon_loss: 216980.3281; val_masked_gp_l1_reg_loss: 2498.6577; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972257.5000; val_global_loss: 1494568.5000; val_optim_loss: 1494568.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 12 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9724
Val AUPRC score: 0.9618
Val best accuracy score: 0.9271
Val best F1 score: 0.9294
Val gene expr MSE score: 0.4707
Val chrom access MSE score: 0.0871
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
