[True]
Run timestamp: 10082023_145555_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7783; val_auprc_score: 0.8004; val_best_acc_score: 0.6048; val_best_f1_score: 0.7063; train_kl_reg_loss: 112300.9279; train_edge_recon_loss: 3653232.1240; train_gene_expr_recon_loss: 15169531.8321; train_masked_gp_l1_reg_loss: 76198.0141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239670.2474; train_chrom_access_recon_loss: 11159272.6947; train_global_loss: 30410205.7405; train_optim_loss: 30410205.7405; val_kl_reg_loss: 133592.0187; val_edge_recon_loss: 4059444.6167; val_gene_expr_recon_loss: 13089185.4667; val_masked_gp_l1_reg_loss: 74960.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227145.7031; val_chrom_access_recon_loss: 10485198.6000; val_global_loss: 28069526.1333; val_optim_loss: 28069526.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8380; val_auprc_score: 0.8443; val_best_acc_score: 0.7451; val_best_f1_score: 0.7645; train_kl_reg_loss: 129981.2854; train_edge_recon_loss: 3545305.3664; train_gene_expr_recon_loss: 12748279.2061; train_masked_gp_l1_reg_loss: 71758.2117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211602.7239; train_chrom_access_recon_loss: 10354567.5267; train_global_loss: 27061494.3359; train_optim_loss: 27061494.3359; val_kl_reg_loss: 109571.7250; val_edge_recon_loss: 3646679.3167; val_gene_expr_recon_loss: 12545415.2000; val_masked_gp_l1_reg_loss: 70736.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195649.8594; val_chrom_access_recon_loss: 10281654.8667; val_global_loss: 26849708.1333; val_optim_loss: 26849708.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8673; val_auprc_score: 0.8645; val_best_acc_score: 0.7638; val_best_f1_score: 0.7841; train_kl_reg_loss: 145851.6070; train_edge_recon_loss: 3108530.6011; train_gene_expr_recon_loss: 12469300.2290; train_masked_gp_l1_reg_loss: 72702.5815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180739.0218; train_chrom_access_recon_loss: 10212794.8244; train_global_loss: 26189918.8702; train_optim_loss: 26189918.8702; val_kl_reg_loss: 156411.1365; val_edge_recon_loss: 3037511.0667; val_gene_expr_recon_loss: 12353754.2000; val_masked_gp_l1_reg_loss: 74247.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166295.7969; val_chrom_access_recon_loss: 10172964.0000; val_global_loss: 25961183.4667; val_optim_loss: 25961183.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8935; val_auprc_score: 0.8756; val_best_acc_score: 0.8169; val_best_f1_score: 0.8323; train_kl_reg_loss: 145417.3539; train_edge_recon_loss: 2973998.1145; train_gene_expr_recon_loss: 12287311.0534; train_masked_gp_l1_reg_loss: 75938.6960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153676.3909; train_chrom_access_recon_loss: 10107340.6107; train_global_loss: 25743682.2443; train_optim_loss: 25743682.2443; val_kl_reg_loss: 143252.4542; val_edge_recon_loss: 2924394.2500; val_gene_expr_recon_loss: 12243712.6000; val_masked_gp_l1_reg_loss: 77791.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141815.8750; val_chrom_access_recon_loss: 10070172.8667; val_global_loss: 25601139.2000; val_optim_loss: 25601139.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9189; val_auprc_score: 0.9038; val_best_acc_score: 0.8479; val_best_f1_score: 0.8594; train_kl_reg_loss: 142608.4913; train_edge_recon_loss: 2869411.0115; train_gene_expr_recon_loss: 12158519.6412; train_masked_gp_l1_reg_loss: 79556.4537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132138.5285; train_chrom_access_recon_loss: 10027006.4580; train_global_loss: 25409240.6718; train_optim_loss: 25409240.6718; val_kl_reg_loss: 143264.2719; val_edge_recon_loss: 2865433.3500; val_gene_expr_recon_loss: 12138988.4667; val_masked_gp_l1_reg_loss: 81203.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122962.9141; val_chrom_access_recon_loss: 10000941.2667; val_global_loss: 25352793.4667; val_optim_loss: 25352793.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9275; val_auprc_score: 0.9115; val_best_acc_score: 0.8569; val_best_f1_score: 0.8683; train_kl_reg_loss: 138745.1407; train_edge_recon_loss: 2834386.1374; train_gene_expr_recon_loss: 12034331.7405; train_masked_gp_l1_reg_loss: 82640.0037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114632.7401; train_chrom_access_recon_loss: 9933083.4962; train_global_loss: 25137819.2977; train_optim_loss: 25137819.2977; val_kl_reg_loss: 137132.0479; val_edge_recon_loss: 2845358.7000; val_gene_expr_recon_loss: 12008742.6667; val_masked_gp_l1_reg_loss: 84104.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106715.6094; val_chrom_access_recon_loss: 9914165.6667; val_global_loss: 25096220.0000; val_optim_loss: 25096220.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9312; val_auprc_score: 0.9179; val_best_acc_score: 0.8618; val_best_f1_score: 0.8707; train_kl_reg_loss: 134886.4228; train_edge_recon_loss: 2822430.8073; train_gene_expr_recon_loss: 11938369.0229; train_masked_gp_l1_reg_loss: 85133.8868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99905.5553; train_chrom_access_recon_loss: 9873373.7023; train_global_loss: 24954099.4504; train_optim_loss: 24954099.4504; val_kl_reg_loss: 130017.5156; val_edge_recon_loss: 2822456.7000; val_gene_expr_recon_loss: 11920511.6000; val_masked_gp_l1_reg_loss: 86372.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93403.9453; val_chrom_access_recon_loss: 9826465.0000; val_global_loss: 24879226.4000; val_optim_loss: 24879226.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9411; val_auprc_score: 0.9279; val_best_acc_score: 0.8759; val_best_f1_score: 0.8820; train_kl_reg_loss: 128361.9829; train_edge_recon_loss: 2797706.7576; train_gene_expr_recon_loss: 11843183.4656; train_masked_gp_l1_reg_loss: 87473.2755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87904.4849; train_chrom_access_recon_loss: 9798729.2519; train_global_loss: 24743359.0992; train_optim_loss: 24743359.0992; val_kl_reg_loss: 123612.6479; val_edge_recon_loss: 2805132.8167; val_gene_expr_recon_loss: 11809129.8000; val_masked_gp_l1_reg_loss: 88600.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82760.4141; val_chrom_access_recon_loss: 9755371.2667; val_global_loss: 24664606.6667; val_optim_loss: 24664606.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9392; val_auprc_score: 0.9237; val_best_acc_score: 0.8758; val_best_f1_score: 0.8838; train_kl_reg_loss: 125171.9958; train_edge_recon_loss: 2790529.5782; train_gene_expr_recon_loss: 11768330.0382; train_masked_gp_l1_reg_loss: 89535.6734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78685.1332; train_chrom_access_recon_loss: 9744632.8855; train_global_loss: 24596885.2519; train_optim_loss: 24596885.2519; val_kl_reg_loss: 121877.5875; val_edge_recon_loss: 2801830.8667; val_gene_expr_recon_loss: 11762524.0000; val_masked_gp_l1_reg_loss: 90678.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74902.5547; val_chrom_access_recon_loss: 9793281.4000; val_global_loss: 24645095.8667; val_optim_loss: 24645095.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9448; val_auprc_score: 0.9295; val_best_acc_score: 0.8836; val_best_f1_score: 0.8914; train_kl_reg_loss: 120561.9435; train_edge_recon_loss: 2776989.2672; train_gene_expr_recon_loss: 11697352.8702; train_masked_gp_l1_reg_loss: 91582.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71340.9788; train_chrom_access_recon_loss: 9701811.1298; train_global_loss: 24459638.7176; train_optim_loss: 24459638.7176; val_kl_reg_loss: 119357.4844; val_edge_recon_loss: 2765997.4667; val_gene_expr_recon_loss: 11689729.2000; val_masked_gp_l1_reg_loss: 92579.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67927.3438; val_chrom_access_recon_loss: 9675257.8667; val_global_loss: 24410848.2667; val_optim_loss: 24410848.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9526; val_auprc_score: 0.9403; val_best_acc_score: 0.8957; val_best_f1_score: 0.9005; train_kl_reg_loss: 117710.3671; train_edge_recon_loss: 2769051.1603; train_gene_expr_recon_loss: 11624480.3053; train_masked_gp_l1_reg_loss: 93509.6545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64804.5281; train_chrom_access_recon_loss: 9629609.8092; train_global_loss: 24299165.7557; train_optim_loss: 24299165.7557; val_kl_reg_loss: 119776.6297; val_edge_recon_loss: 2781755.5167; val_gene_expr_recon_loss: 11646543.4667; val_masked_gp_l1_reg_loss: 94450.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61806.3711; val_chrom_access_recon_loss: 9634640.2000; val_global_loss: 24338971.8667; val_optim_loss: 24338971.8667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9562; val_auprc_score: 0.9423; val_best_acc_score: 0.9011; val_best_f1_score: 0.9054; train_kl_reg_loss: 114516.9095; train_edge_recon_loss: 2757400.6546; train_gene_expr_recon_loss: 11564390.0458; train_masked_gp_l1_reg_loss: 95382.7607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59159.5847; train_chrom_access_recon_loss: 9578599.1145; train_global_loss: 24169448.9618; train_optim_loss: 24169448.9618; val_kl_reg_loss: 111008.6859; val_edge_recon_loss: 2760581.3833; val_gene_expr_recon_loss: 11577153.8000; val_masked_gp_l1_reg_loss: 96272.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56570.6055; val_chrom_access_recon_loss: 9563973.4667; val_global_loss: 24165561.4667; val_optim_loss: 24165561.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9541; val_auprc_score: 0.9417; val_best_acc_score: 0.8945; val_best_f1_score: 0.8999; train_kl_reg_loss: 111544.6349; train_edge_recon_loss: 2750508.9523; train_gene_expr_recon_loss: 11513529.3359; train_masked_gp_l1_reg_loss: 97142.4461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54329.5275; train_chrom_access_recon_loss: 9535114.7481; train_global_loss: 24062169.7099; train_optim_loss: 24062169.7099; val_kl_reg_loss: 109603.0948; val_edge_recon_loss: 2780613.6833; val_gene_expr_recon_loss: 11524468.8000; val_masked_gp_l1_reg_loss: 98019.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52179.8516; val_chrom_access_recon_loss: 9547041.2000; val_global_loss: 24111926.6667; val_optim_loss: 24111926.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9471; val_best_acc_score: 0.9015; val_best_f1_score: 0.9070; train_kl_reg_loss: 109336.2291; train_edge_recon_loss: 2741285.3130; train_gene_expr_recon_loss: 11470656.5191; train_masked_gp_l1_reg_loss: 98832.6890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50200.6817; train_chrom_access_recon_loss: 9488680.3053; train_global_loss: 23958991.8321; train_optim_loss: 23958991.8321; val_kl_reg_loss: 107947.4422; val_edge_recon_loss: 2759216.5833; val_gene_expr_recon_loss: 11445324.8667; val_masked_gp_l1_reg_loss: 99739.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48388.8789; val_chrom_access_recon_loss: 9436536.1333; val_global_loss: 23897152.8000; val_optim_loss: 23897152.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9618; val_auprc_score: 0.9512; val_best_acc_score: 0.9088; val_best_f1_score: 0.9131; train_kl_reg_loss: 107478.0524; train_edge_recon_loss: 2735593.1107; train_gene_expr_recon_loss: 11431665.5496; train_masked_gp_l1_reg_loss: 100492.4677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46650.9577; train_chrom_access_recon_loss: 9451748.3435; train_global_loss: 23873628.6107; train_optim_loss: 23873628.6107; val_kl_reg_loss: 101429.2286; val_edge_recon_loss: 2757051.3000; val_gene_expr_recon_loss: 11445216.5333; val_masked_gp_l1_reg_loss: 101301.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45073.1250; val_chrom_access_recon_loss: 9461913.0667; val_global_loss: 23911984.9333; val_optim_loss: 23911984.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9655; val_auprc_score: 0.9559; val_best_acc_score: 0.9158; val_best_f1_score: 0.9184; train_kl_reg_loss: 106034.1525; train_edge_recon_loss: 2726607.1069; train_gene_expr_recon_loss: 11381743.9084; train_masked_gp_l1_reg_loss: 102016.2622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43495.8487; train_chrom_access_recon_loss: 9408717.4122; train_global_loss: 23768614.7634; train_optim_loss: 23768614.7634; val_kl_reg_loss: 105577.0953; val_edge_recon_loss: 2727423.1333; val_gene_expr_recon_loss: 11391505.4667; val_masked_gp_l1_reg_loss: 102658.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41997.3672; val_chrom_access_recon_loss: 9418349.2000; val_global_loss: 23787511.2000; val_optim_loss: 23787511.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9676; val_auprc_score: 0.9591; val_best_acc_score: 0.9158; val_best_f1_score: 0.9194; train_kl_reg_loss: 103866.8457; train_edge_recon_loss: 2727614.6908; train_gene_expr_recon_loss: 11352103.3282; train_masked_gp_l1_reg_loss: 103437.5657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40727.6683; train_chrom_access_recon_loss: 9387013.1374; train_global_loss: 23714763.2672; train_optim_loss: 23714763.2672; val_kl_reg_loss: 101237.8042; val_edge_recon_loss: 2738533.4167; val_gene_expr_recon_loss: 11371993.0667; val_masked_gp_l1_reg_loss: 104233.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39557.4102; val_chrom_access_recon_loss: 9372371.8000; val_global_loss: 23727926.9333; val_optim_loss: 23727926.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9683; val_auprc_score: 0.9595; val_best_acc_score: 0.9193; val_best_f1_score: 0.9225; train_kl_reg_loss: 102377.1427; train_edge_recon_loss: 2716776.1450; train_gene_expr_recon_loss: 11316254.1603; train_masked_gp_l1_reg_loss: 104907.0361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38324.7159; train_chrom_access_recon_loss: 9349838.6031; train_global_loss: 23628477.8779; train_optim_loss: 23628477.8779; val_kl_reg_loss: 102938.6729; val_edge_recon_loss: 2724713.1833; val_gene_expr_recon_loss: 11323159.4667; val_masked_gp_l1_reg_loss: 105729.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37212.5625; val_chrom_access_recon_loss: 9350366.8667; val_global_loss: 23644121.3333; val_optim_loss: 23644121.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9681; val_auprc_score: 0.9597; val_best_acc_score: 0.9189; val_best_f1_score: 0.9220; train_kl_reg_loss: 100904.6092; train_edge_recon_loss: 2714670.8798; train_gene_expr_recon_loss: 11284027.0458; train_masked_gp_l1_reg_loss: 106268.2954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36217.4457; train_chrom_access_recon_loss: 9307514.7328; train_global_loss: 23549603.0382; train_optim_loss: 23549603.0382; val_kl_reg_loss: 100178.7896; val_edge_recon_loss: 2726599.4333; val_gene_expr_recon_loss: 11274993.4000; val_masked_gp_l1_reg_loss: 106904.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35207.7969; val_chrom_access_recon_loss: 9277145.2667; val_global_loss: 23521030.1333; val_optim_loss: 23521030.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9723; val_auprc_score: 0.9630; val_best_acc_score: 0.9228; val_best_f1_score: 0.9259; train_kl_reg_loss: 100649.5862; train_edge_recon_loss: 2712842.4885; train_gene_expr_recon_loss: 11261564.9695; train_masked_gp_l1_reg_loss: 107499.8378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34304.9663; train_chrom_access_recon_loss: 9277839.8931; train_global_loss: 23494701.6947; train_optim_loss: 23494701.6947; val_kl_reg_loss: 100669.5073; val_edge_recon_loss: 2709449.7500; val_gene_expr_recon_loss: 11288201.8667; val_masked_gp_l1_reg_loss: 108102.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33469.7500; val_chrom_access_recon_loss: 9298905.5333; val_global_loss: 23538798.5333; val_optim_loss: 23538798.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9754; val_auprc_score: 0.9701; val_best_acc_score: 0.9263; val_best_f1_score: 0.9287; train_kl_reg_loss: 98829.1380; train_edge_recon_loss: 2712149.0649; train_gene_expr_recon_loss: 11228051.8397; train_masked_gp_l1_reg_loss: 108712.1741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32703.2072; train_chrom_access_recon_loss: 9249871.9771; train_global_loss: 23430317.4351; train_optim_loss: 23430317.4351; val_kl_reg_loss: 99606.5234; val_edge_recon_loss: 2701064.8833; val_gene_expr_recon_loss: 11271950.2667; val_masked_gp_l1_reg_loss: 109436.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32055.0840; val_chrom_access_recon_loss: 9289887.8667; val_global_loss: 23504000.5333; val_optim_loss: 23504000.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9742; val_auprc_score: 0.9655; val_best_acc_score: 0.9299; val_best_f1_score: 0.9324; train_kl_reg_loss: 97741.5060; train_edge_recon_loss: 2705812.9676; train_gene_expr_recon_loss: 11208709.2519; train_masked_gp_l1_reg_loss: 109872.8831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31394.4242; train_chrom_access_recon_loss: 9229251.1832; train_global_loss: 23382782.1985; train_optim_loss: 23382782.1985; val_kl_reg_loss: 96707.1385; val_edge_recon_loss: 2716416.3167; val_gene_expr_recon_loss: 11227721.5333; val_masked_gp_l1_reg_loss: 110646.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30845.9102; val_chrom_access_recon_loss: 9297019.7333; val_global_loss: 23479357.7333; val_optim_loss: 23479357.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9763; val_auprc_score: 0.9703; val_best_acc_score: 0.9293; val_best_f1_score: 0.9308; train_kl_reg_loss: 97063.4281; train_edge_recon_loss: 2703058.6336; train_gene_expr_recon_loss: 11185730.0840; train_masked_gp_l1_reg_loss: 111055.1388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30292.9634; train_chrom_access_recon_loss: 9212640.6565; train_global_loss: 23339840.8397; train_optim_loss: 23339840.8397; val_kl_reg_loss: 95082.0656; val_edge_recon_loss: 2696062.5000; val_gene_expr_recon_loss: 11233227.2667; val_masked_gp_l1_reg_loss: 111684.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29866.1445; val_chrom_access_recon_loss: 9190746.2000; val_global_loss: 23356669.0667; val_optim_loss: 23356669.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9784; val_auprc_score: 0.9722; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 95187.3761; train_edge_recon_loss: 2706844.6450; train_gene_expr_recon_loss: 11159255.9084; train_masked_gp_l1_reg_loss: 112240.2655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29352.7778; train_chrom_access_recon_loss: 9176305.4427; train_global_loss: 23279186.4427; train_optim_loss: 23279186.4427; val_kl_reg_loss: 95172.9255; val_edge_recon_loss: 2701674.5333; val_gene_expr_recon_loss: 11191772.4000; val_masked_gp_l1_reg_loss: 112781.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29008.4590; val_chrom_access_recon_loss: 9218590.9333; val_global_loss: 23349000.9333; val_optim_loss: 23349000.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9773; val_auprc_score: 0.9714; val_best_acc_score: 0.9360; val_best_f1_score: 0.9379; train_kl_reg_loss: 94768.6984; train_edge_recon_loss: 2692054.5248; train_gene_expr_recon_loss: 11143841.1679; train_masked_gp_l1_reg_loss: 113270.8119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28573.2337; train_chrom_access_recon_loss: 9159384.8397; train_global_loss: 23231893.2824; train_optim_loss: 23231893.2824; val_kl_reg_loss: 94155.7188; val_edge_recon_loss: 2710889.8667; val_gene_expr_recon_loss: 11193694.8667; val_masked_gp_l1_reg_loss: 113955.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28166.4805; val_chrom_access_recon_loss: 9192101.9333; val_global_loss: 23332963.3333; val_optim_loss: 23332963.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8523; val_auprc_score: 0.8491; val_best_acc_score: 0.6330; val_best_f1_score: 0.7261; train_kl_reg_loss: 106245.1521; train_edge_recon_loss: 3243622.0267; train_gene_expr_recon_loss: 13380260.7023; train_masked_gp_l1_reg_loss: 114216.9894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28042.8096; train_chrom_access_recon_loss: 9726164.9237; train_global_loss: 26598552.5954; train_optim_loss: 26598552.5954; val_kl_reg_loss: 16788.8783; val_edge_recon_loss: 4057575.4167; val_gene_expr_recon_loss: 13765601.8667; val_masked_gp_l1_reg_loss: 110563.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27686.8828; val_chrom_access_recon_loss: 9727672.2667; val_global_loss: 27705888.8000; val_optim_loss: 27705888.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8834; val_auprc_score: 0.8711; val_best_acc_score: 0.7986; val_best_f1_score: 0.8113; train_kl_reg_loss: 34286.6390; train_edge_recon_loss: 3449962.6164; train_gene_expr_recon_loss: 13720672.1985; train_masked_gp_l1_reg_loss: 104533.0725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25810.6326; train_chrom_access_recon_loss: 9692923.4733; train_global_loss: 27028188.6565; train_optim_loss: 27028188.6565; val_kl_reg_loss: 8071.8080; val_edge_recon_loss: 2949319.1000; val_gene_expr_recon_loss: 13604375.8000; val_masked_gp_l1_reg_loss: 99994.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24651.1172; val_chrom_access_recon_loss: 9686724.0667; val_global_loss: 26373136.6667; val_optim_loss: 26373136.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8843; val_auprc_score: 0.8738; val_best_acc_score: 0.7856; val_best_f1_score: 0.8080; train_kl_reg_loss: 28171.9502; train_edge_recon_loss: 2883987.9103; train_gene_expr_recon_loss: 13494755.5725; train_masked_gp_l1_reg_loss: 95726.4435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24060.3401; train_chrom_access_recon_loss: 9641392.9466; train_global_loss: 26168095.0840; train_optim_loss: 26168095.0840; val_kl_reg_loss: 13957.6902; val_edge_recon_loss: 2859181.1333; val_gene_expr_recon_loss: 13386520.8667; val_masked_gp_l1_reg_loss: 91376.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23545.9961; val_chrom_access_recon_loss: 9595776.7333; val_global_loss: 25970358.4000; val_optim_loss: 25970358.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8809; val_auprc_score: 0.8649; val_best_acc_score: 0.7856; val_best_f1_score: 0.8060; train_kl_reg_loss: 25749.9072; train_edge_recon_loss: 2862610.8683; train_gene_expr_recon_loss: 13375635.9313; train_masked_gp_l1_reg_loss: 87271.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23193.7258; train_chrom_access_recon_loss: 9619543.6794; train_global_loss: 25994006.0763; train_optim_loss: 25994006.0763; val_kl_reg_loss: 15235.4359; val_edge_recon_loss: 2866773.1500; val_gene_expr_recon_loss: 13350007.0667; val_masked_gp_l1_reg_loss: 83306.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22979.8594; val_chrom_access_recon_loss: 9620304.4667; val_global_loss: 25958607.0667; val_optim_loss: 25958607.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8857; val_auprc_score: 0.8707; val_best_acc_score: 0.7895; val_best_f1_score: 0.8095; train_kl_reg_loss: 23992.4584; train_edge_recon_loss: 2850561.7462; train_gene_expr_recon_loss: 13310302.2061; train_masked_gp_l1_reg_loss: 82572.5994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22883.1407; train_chrom_access_recon_loss: 9609722.2977; train_global_loss: 25900034.5344; train_optim_loss: 25900034.5344; val_kl_reg_loss: 15485.3772; val_edge_recon_loss: 2858450.2333; val_gene_expr_recon_loss: 13324913.2667; val_masked_gp_l1_reg_loss: 82145.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22841.9883; val_chrom_access_recon_loss: 9625140.8667; val_global_loss: 25928978.0000; val_optim_loss: 25928978.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8874; val_auprc_score: 0.8691; val_best_acc_score: 0.7983; val_best_f1_score: 0.8179; train_kl_reg_loss: 23927.6234; train_edge_recon_loss: 2845789.8378; train_gene_expr_recon_loss: 13288640.8779; train_masked_gp_l1_reg_loss: 81744.3687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22815.9929; train_chrom_access_recon_loss: 9596491.7023; train_global_loss: 25859410.3969; train_optim_loss: 25859410.3969; val_kl_reg_loss: 15800.7494; val_edge_recon_loss: 2833269.9333; val_gene_expr_recon_loss: 13336390.7333; val_masked_gp_l1_reg_loss: 81329.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22786.6582; val_chrom_access_recon_loss: 9625984.4000; val_global_loss: 25915563.0667; val_optim_loss: 25915563.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8862; val_auprc_score: 0.8698; val_best_acc_score: 0.7926; val_best_f1_score: 0.8137; train_kl_reg_loss: 24094.7945; train_edge_recon_loss: 2840127.3969; train_gene_expr_recon_loss: 13288330.4351; train_masked_gp_l1_reg_loss: 80915.9257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22757.8497; train_chrom_access_recon_loss: 9600363.7786; train_global_loss: 25856590.2443; train_optim_loss: 25856590.2443; val_kl_reg_loss: 16114.0051; val_edge_recon_loss: 2857978.5500; val_gene_expr_recon_loss: 13317754.5333; val_masked_gp_l1_reg_loss: 80490.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22733.7383; val_chrom_access_recon_loss: 9592530.4000; val_global_loss: 25887602.8000; val_optim_loss: 25887602.8000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8818; val_auprc_score: 0.8623; val_best_acc_score: 0.7912; val_best_f1_score: 0.8122; train_kl_reg_loss: 24160.0767; train_edge_recon_loss: 2839275.9466; train_gene_expr_recon_loss: 13273353.5649; train_masked_gp_l1_reg_loss: 80063.6334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22704.7133; train_chrom_access_recon_loss: 9595927.3893; train_global_loss: 25835485.4351; train_optim_loss: 25835485.4351; val_kl_reg_loss: 16385.5181; val_edge_recon_loss: 2859766.7500; val_gene_expr_recon_loss: 13324491.8667; val_masked_gp_l1_reg_loss: 79623.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22674.5215; val_chrom_access_recon_loss: 9591693.9333; val_global_loss: 25894636.2667; val_optim_loss: 25894636.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 56 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9761
val AUPRC score: 0.9678
val best accuracy score: 0.9321
val best F1 score: 0.9338
val target rna MSE score: 4.4326
val source rna MSE score: 4.1744
val target atac MSE score: 0.1289
val source atac MSE score: 33.4275
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
