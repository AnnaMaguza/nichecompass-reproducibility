[True]
Run timestamp: 24072023_160956_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8976; val_auprc_score: 0.9072; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 5699.9278; train_edge_recon_loss: 351047.9792; train_gene_expr_recon_loss: 308258.4965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10754907.7778; train_global_loss: 11419914.2222; train_optim_loss: 11419914.2222; val_kl_reg_loss: 13799.0430; val_edge_recon_loss: 406536.0312; val_gene_expr_recon_loss: 290465.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10506160.0000; val_global_loss: 11216961.0000; val_optim_loss: 11216961.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8548; val_auprc_score: 0.8642; val_best_acc_score: 0.5079; val_best_f1_score: 0.6702; train_kl_reg_loss: 20304.7131; train_edge_recon_loss: 363523.9306; train_gene_expr_recon_loss: 283672.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10523296.6667; train_global_loss: 11190797.7778; train_optim_loss: 11190797.7778; val_kl_reg_loss: 27675.0703; val_edge_recon_loss: 406512.6250; val_gene_expr_recon_loss: 265201.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10275567.0000; val_global_loss: 10974956.0000; val_optim_loss: 10974956.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8634; val_auprc_score: 0.8756; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 37432.5386; train_edge_recon_loss: 377133.0764; train_gene_expr_recon_loss: 259957.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10281576.4444; train_global_loss: 10956099.5556; train_optim_loss: 10956099.5556; val_kl_reg_loss: 42279.3984; val_edge_recon_loss: 406546.0938; val_gene_expr_recon_loss: 247900.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10062674.0000; val_global_loss: 10759400.0000; val_optim_loss: 10759400.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8798; val_auprc_score: 0.8847; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 49936.7956; train_edge_recon_loss: 384092.2049; train_gene_expr_recon_loss: 245582.1649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10106662.1111; train_global_loss: 10786273.4444; train_optim_loss: 10786273.4444; val_kl_reg_loss: 49756.8828; val_edge_recon_loss: 406557.7188; val_gene_expr_recon_loss: 236001.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9881385.0000; val_global_loss: 10573702.0000; val_optim_loss: 10573702.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8918; val_auprc_score: 0.8926; val_best_acc_score: 0.5090; val_best_f1_score: 0.6707; train_kl_reg_loss: 58147.6701; train_edge_recon_loss: 386957.4132; train_gene_expr_recon_loss: 236830.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9988658.0000; train_global_loss: 10670593.8889; train_optim_loss: 10670593.8889; val_kl_reg_loss: 58100.5156; val_edge_recon_loss: 406519.4688; val_gene_expr_recon_loss: 228575.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9788175.0000; val_global_loss: 10481371.0000; val_optim_loss: 10481371.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8909; val_auprc_score: 0.8914; val_best_acc_score: 0.5147; val_best_f1_score: 0.6733; train_kl_reg_loss: 63021.6415; train_edge_recon_loss: 387374.4826; train_gene_expr_recon_loss: 229482.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9827157.0000; train_global_loss: 10507035.6667; train_optim_loss: 10507035.6667; val_kl_reg_loss: 64963.2969; val_edge_recon_loss: 406454.7188; val_gene_expr_recon_loss: 223577.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9738317.0000; val_global_loss: 10433312.0000; val_optim_loss: 10433312.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8854; val_auprc_score: 0.8855; val_best_acc_score: 0.5309; val_best_f1_score: 0.6801; train_kl_reg_loss: 64932.7943; train_edge_recon_loss: 386801.2049; train_gene_expr_recon_loss: 225157.8837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9872679.2222; train_global_loss: 10549571.1111; train_optim_loss: 10549571.1111; val_kl_reg_loss: 62212.6133; val_edge_recon_loss: 406313.8125; val_gene_expr_recon_loss: 219949.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9700660.0000; val_global_loss: 10389136.0000; val_optim_loss: 10389136.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8804; val_auprc_score: 0.8779; val_best_acc_score: 0.5763; val_best_f1_score: 0.7004; train_kl_reg_loss: 65233.8472; train_edge_recon_loss: 384795.0139; train_gene_expr_recon_loss: 222515.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9771254.2222; train_global_loss: 10443798.4444; train_optim_loss: 10443798.4444; val_kl_reg_loss: 56164.9492; val_edge_recon_loss: 406066.2500; val_gene_expr_recon_loss: 217471.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9656867.0000; val_global_loss: 10336569.0000; val_optim_loss: 10336569.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8825; val_auprc_score: 0.8817; val_best_acc_score: 0.6432; val_best_f1_score: 0.7330; train_kl_reg_loss: 63973.3255; train_edge_recon_loss: 385153.7431; train_gene_expr_recon_loss: 219341.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9785147.2222; train_global_loss: 10453615.7778; train_optim_loss: 10453615.7778; val_kl_reg_loss: 53208.3516; val_edge_recon_loss: 405688.0312; val_gene_expr_recon_loss: 215845.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9637637.0000; val_global_loss: 10312379.0000; val_optim_loss: 10312379.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8858; val_auprc_score: 0.8825; val_best_acc_score: 0.6908; val_best_f1_score: 0.7578; train_kl_reg_loss: 60378.2040; train_edge_recon_loss: 385200.2535; train_gene_expr_recon_loss: 219267.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9779667.5556; train_global_loss: 10444513.2222; train_optim_loss: 10444513.2222; val_kl_reg_loss: 55738.8984; val_edge_recon_loss: 405373.8125; val_gene_expr_recon_loss: 214095.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624758.0000; val_global_loss: 10299966.0000; val_optim_loss: 10299966.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8951; val_auprc_score: 0.8855; val_best_acc_score: 0.7825; val_best_f1_score: 0.8112; train_kl_reg_loss: 61553.5347; train_edge_recon_loss: 381481.2153; train_gene_expr_recon_loss: 217515.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9765288.1111; train_global_loss: 10425838.1111; train_optim_loss: 10425838.1111; val_kl_reg_loss: 50459.6289; val_edge_recon_loss: 404507.5625; val_gene_expr_recon_loss: 213592.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9601219.0000; val_global_loss: 10269779.0000; val_optim_loss: 10269779.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8963; val_auprc_score: 0.8862; val_best_acc_score: 0.8185; val_best_f1_score: 0.8306; train_kl_reg_loss: 57197.3989; train_edge_recon_loss: 381747.1562; train_gene_expr_recon_loss: 217045.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748938.3333; train_global_loss: 10404928.3333; train_optim_loss: 10404928.3333; val_kl_reg_loss: 52117.6094; val_edge_recon_loss: 403496.0000; val_gene_expr_recon_loss: 212314.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9608935.0000; val_global_loss: 10276863.0000; val_optim_loss: 10276863.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9007; val_auprc_score: 0.8887; val_best_acc_score: 0.8199; val_best_f1_score: 0.8138; train_kl_reg_loss: 58116.0291; train_edge_recon_loss: 378428.5069; train_gene_expr_recon_loss: 215556.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9732473.7778; train_global_loss: 10384574.8889; train_optim_loss: 10384574.8889; val_kl_reg_loss: 51092.6406; val_edge_recon_loss: 401317.2188; val_gene_expr_recon_loss: 211565.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9580184.0000; val_global_loss: 10244160.0000; val_optim_loss: 10244160.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9067; val_auprc_score: 0.8950; val_best_acc_score: 0.7947; val_best_f1_score: 0.8028; train_kl_reg_loss: 55178.1359; train_edge_recon_loss: 377309.2083; train_gene_expr_recon_loss: 214130.6128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9673314.3333; train_global_loss: 10319932.2222; train_optim_loss: 10319932.2222; val_kl_reg_loss: 52119.0586; val_edge_recon_loss: 397701.9062; val_gene_expr_recon_loss: 211007.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9591666.0000; val_global_loss: 10252494.0000; val_optim_loss: 10252494.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9150; val_auprc_score: 0.9027; val_best_acc_score: 0.8333; val_best_f1_score: 0.8483; train_kl_reg_loss: 55638.7977; train_edge_recon_loss: 373549.6285; train_gene_expr_recon_loss: 214633.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9718086.0000; train_global_loss: 10361908.2222; train_optim_loss: 10361908.2222; val_kl_reg_loss: 46356.0781; val_edge_recon_loss: 390337.0312; val_gene_expr_recon_loss: 210916.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9569130.0000; val_global_loss: 10216740.0000; val_optim_loss: 10216740.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9075; val_auprc_score: 0.8897; val_best_acc_score: 0.8283; val_best_f1_score: 0.8381; train_kl_reg_loss: 52989.4497; train_edge_recon_loss: 370715.6771; train_gene_expr_recon_loss: 214275.3628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674209.6667; train_global_loss: 10312190.0000; train_optim_loss: 10312190.0000; val_kl_reg_loss: 50281.4336; val_edge_recon_loss: 382181.8750; val_gene_expr_recon_loss: 209827.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9565918.0000; val_global_loss: 10208209.0000; val_optim_loss: 10208209.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9093; val_auprc_score: 0.8941; val_best_acc_score: 0.8304; val_best_f1_score: 0.8351; train_kl_reg_loss: 54171.7478; train_edge_recon_loss: 362595.4549; train_gene_expr_recon_loss: 212888.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9646607.0000; train_global_loss: 10276262.7778; train_optim_loss: 10276262.7778; val_kl_reg_loss: 50404.7617; val_edge_recon_loss: 366056.1250; val_gene_expr_recon_loss: 209784.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9558016.0000; val_global_loss: 10184261.0000; val_optim_loss: 10184261.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9151; val_auprc_score: 0.9050; val_best_acc_score: 0.8302; val_best_f1_score: 0.8409; train_kl_reg_loss: 55602.8390; train_edge_recon_loss: 352637.0139; train_gene_expr_recon_loss: 214232.4549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697901.1111; train_global_loss: 10320373.5556; train_optim_loss: 10320373.5556; val_kl_reg_loss: 55342.0000; val_edge_recon_loss: 349398.0938; val_gene_expr_recon_loss: 209588.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9554221.0000; val_global_loss: 10168550.0000; val_optim_loss: 10168550.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9044; val_auprc_score: 0.8851; val_best_acc_score: 0.8208; val_best_f1_score: 0.8317; train_kl_reg_loss: 60340.6372; train_edge_recon_loss: 341761.2812; train_gene_expr_recon_loss: 212840.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9670323.8889; train_global_loss: 10285266.5556; train_optim_loss: 10285266.5556; val_kl_reg_loss: 58463.4961; val_edge_recon_loss: 342827.1250; val_gene_expr_recon_loss: 209119.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9538460.0000; val_global_loss: 10148870.0000; val_optim_loss: 10148870.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9090; val_auprc_score: 0.8912; val_best_acc_score: 0.8316; val_best_f1_score: 0.8412; train_kl_reg_loss: 60827.1953; train_edge_recon_loss: 336334.9097; train_gene_expr_recon_loss: 211607.6858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9635818.4444; train_global_loss: 10244588.2222; train_optim_loss: 10244588.2222; val_kl_reg_loss: 56110.4453; val_edge_recon_loss: 336061.2188; val_gene_expr_recon_loss: 208959.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9523560.0000; val_global_loss: 10124691.0000; val_optim_loss: 10124691.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9061; val_auprc_score: 0.8865; val_best_acc_score: 0.8324; val_best_f1_score: 0.8420; train_kl_reg_loss: 60030.8919; train_edge_recon_loss: 333744.6806; train_gene_expr_recon_loss: 212998.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9642699.0000; train_global_loss: 10249473.1111; train_optim_loss: 10249473.1111; val_kl_reg_loss: 57246.5625; val_edge_recon_loss: 334958.5625; val_gene_expr_recon_loss: 208513.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9520921.0000; val_global_loss: 10121639.0000; val_optim_loss: 10121639.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9068; val_auprc_score: 0.8838; val_best_acc_score: 0.8312; val_best_f1_score: 0.8455; train_kl_reg_loss: 58843.0191; train_edge_recon_loss: 331817.2431; train_gene_expr_recon_loss: 211595.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647095.6667; train_global_loss: 10249352.0000; train_optim_loss: 10249352.0000; val_kl_reg_loss: 55415.3711; val_edge_recon_loss: 331169.2812; val_gene_expr_recon_loss: 208255.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9511478.0000; val_global_loss: 10106318.0000; val_optim_loss: 10106318.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9077; val_auprc_score: 0.8848; val_best_acc_score: 0.8343; val_best_f1_score: 0.8478; train_kl_reg_loss: 58592.5434; train_edge_recon_loss: 329016.4722; train_gene_expr_recon_loss: 210055.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9595340.5556; train_global_loss: 10193004.6667; train_optim_loss: 10193004.6667; val_kl_reg_loss: 55233.6328; val_edge_recon_loss: 330214.8125; val_gene_expr_recon_loss: 208180.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9506849.0000; val_global_loss: 10100478.0000; val_optim_loss: 10100478.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9095; val_auprc_score: 0.8845; val_best_acc_score: 0.8352; val_best_f1_score: 0.8488; train_kl_reg_loss: 58211.3646; train_edge_recon_loss: 327340.4722; train_gene_expr_recon_loss: 211962.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647175.7778; train_global_loss: 10244690.0000; train_optim_loss: 10244690.0000; val_kl_reg_loss: 54782.4062; val_edge_recon_loss: 326821.9062; val_gene_expr_recon_loss: 207820.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9502126.0000; val_global_loss: 10091551.0000; val_optim_loss: 10091551.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9067; val_auprc_score: 0.8836; val_best_acc_score: 0.8331; val_best_f1_score: 0.8471; train_kl_reg_loss: 56828.6111; train_edge_recon_loss: 326309.0035; train_gene_expr_recon_loss: 209977.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9568838.8889; train_global_loss: 10161954.4444; train_optim_loss: 10161954.4444; val_kl_reg_loss: 54804.6719; val_edge_recon_loss: 327099.3438; val_gene_expr_recon_loss: 207610.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9494313.0000; val_global_loss: 10083827.0000; val_optim_loss: 10083827.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9104; val_auprc_score: 0.8903; val_best_acc_score: 0.8348; val_best_f1_score: 0.8478; train_kl_reg_loss: 56211.5482; train_edge_recon_loss: 358687.7153; train_gene_expr_recon_loss: 211006.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627069.8889; train_global_loss: 10252975.8889; train_optim_loss: 10252975.8889; val_kl_reg_loss: 35496.0391; val_edge_recon_loss: 354399.6250; val_gene_expr_recon_loss: 207948.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9532506.0000; val_global_loss: 10130350.0000; val_optim_loss: 10130350.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9156; val_auprc_score: 0.8955; val_best_acc_score: 0.8409; val_best_f1_score: 0.8525; train_kl_reg_loss: 55958.0842; train_edge_recon_loss: 347332.9340; train_gene_expr_recon_loss: 210716.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9607240.0000; train_global_loss: 10221247.4444; train_optim_loss: 10221247.4444; val_kl_reg_loss: 39508.0586; val_edge_recon_loss: 343772.4062; val_gene_expr_recon_loss: 207422.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9503058.0000; val_global_loss: 10093760.0000; val_optim_loss: 10093760.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9101; val_auprc_score: 0.8915; val_best_acc_score: 0.8366; val_best_f1_score: 0.8488; train_kl_reg_loss: 53259.6389; train_edge_recon_loss: 342577.0451; train_gene_expr_recon_loss: 210019.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9580035.6667; train_global_loss: 10185892.3333; train_optim_loss: 10185892.3333; val_kl_reg_loss: 38841.0547; val_edge_recon_loss: 339595.3750; val_gene_expr_recon_loss: 207769.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9500816.0000; val_global_loss: 10087022.0000; val_optim_loss: 10087022.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9069; val_auprc_score: 0.8837; val_best_acc_score: 0.8288; val_best_f1_score: 0.8430; train_kl_reg_loss: 53537.4644; train_edge_recon_loss: 336645.2326; train_gene_expr_recon_loss: 210970.7882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9646626.2222; train_global_loss: 10247779.6667; train_optim_loss: 10247779.6667; val_kl_reg_loss: 38458.6719; val_edge_recon_loss: 334495.8750; val_gene_expr_recon_loss: 208017.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9507667.0000; val_global_loss: 10088639.0000; val_optim_loss: 10088639.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9119; val_auprc_score: 0.8905; val_best_acc_score: 0.8352; val_best_f1_score: 0.8471; train_kl_reg_loss: 52136.1163; train_edge_recon_loss: 333540.0590; train_gene_expr_recon_loss: 211074.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9638919.2222; train_global_loss: 10235670.4444; train_optim_loss: 10235670.4444; val_kl_reg_loss: 43541.5000; val_edge_recon_loss: 334390.7188; val_gene_expr_recon_loss: 206821.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9486398.0000; val_global_loss: 10071152.0000; val_optim_loss: 10071152.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9090; val_auprc_score: 0.8869; val_best_acc_score: 0.8336; val_best_f1_score: 0.8478; train_kl_reg_loss: 54058.3090; train_edge_recon_loss: 334516.8472; train_gene_expr_recon_loss: 209589.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9567148.0000; train_global_loss: 10165313.1111; train_optim_loss: 10165313.1111; val_kl_reg_loss: 40635.3359; val_edge_recon_loss: 334138.3750; val_gene_expr_recon_loss: 207238.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9488382.0000; val_global_loss: 10070394.0000; val_optim_loss: 10070394.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9120; val_auprc_score: 0.8919; val_best_acc_score: 0.8359; val_best_f1_score: 0.8474; train_kl_reg_loss: 52338.2465; train_edge_recon_loss: 332634.7222; train_gene_expr_recon_loss: 211413.7396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9643718.8889; train_global_loss: 10240105.7778; train_optim_loss: 10240105.7778; val_kl_reg_loss: 42486.6953; val_edge_recon_loss: 334577.8438; val_gene_expr_recon_loss: 207026.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9496371.0000; val_global_loss: 10080462.0000; val_optim_loss: 10080462.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9029; val_auprc_score: 0.8782; val_best_acc_score: 0.8246; val_best_f1_score: 0.8403; train_kl_reg_loss: 53927.5521; train_edge_recon_loss: 332899.8229; train_gene_expr_recon_loss: 211457.6337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9649166.6667; train_global_loss: 10247451.6667; train_optim_loss: 10247451.6667; val_kl_reg_loss: 41661.2734; val_edge_recon_loss: 332733.7188; val_gene_expr_recon_loss: 207257.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9497227.0000; val_global_loss: 10078880.0000; val_optim_loss: 10078880.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9077; val_auprc_score: 0.8886; val_best_acc_score: 0.8290; val_best_f1_score: 0.8443; train_kl_reg_loss: 52629.5000; train_edge_recon_loss: 332035.8021; train_gene_expr_recon_loss: 210729.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9643827.4444; train_global_loss: 10239222.1111; train_optim_loss: 10239222.1111; val_kl_reg_loss: 42492.6211; val_edge_recon_loss: 334979.7500; val_gene_expr_recon_loss: 207060.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9494263.0000; val_global_loss: 10078796.0000; val_optim_loss: 10078796.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9028; val_auprc_score: 0.8783; val_best_acc_score: 0.8252; val_best_f1_score: 0.8408; train_kl_reg_loss: 53456.3424; train_edge_recon_loss: 331491.0556; train_gene_expr_recon_loss: 210210.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591552.4444; train_global_loss: 10186710.7778; train_optim_loss: 10186710.7778; val_kl_reg_loss: 42145.5234; val_edge_recon_loss: 333685.2188; val_gene_expr_recon_loss: 206905.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9476057.0000; val_global_loss: 10058793.0000; val_optim_loss: 10058793.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9092; val_auprc_score: 0.8886; val_best_acc_score: 0.8325; val_best_f1_score: 0.8458; train_kl_reg_loss: 52840.7131; train_edge_recon_loss: 331427.2188; train_gene_expr_recon_loss: 210108.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9586073.7778; train_global_loss: 10180449.6667; train_optim_loss: 10180449.6667; val_kl_reg_loss: 42515.1172; val_edge_recon_loss: 331849.3438; val_gene_expr_recon_loss: 206933.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9486801.0000; val_global_loss: 10068099.0000; val_optim_loss: 10068099.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9078; val_auprc_score: 0.8890; val_best_acc_score: 0.8293; val_best_f1_score: 0.8432; train_kl_reg_loss: 53207.4965; train_edge_recon_loss: 332482.5417; train_gene_expr_recon_loss: 208796.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9528826.0000; train_global_loss: 10123312.7778; train_optim_loss: 10123312.7778; val_kl_reg_loss: 42571.1484; val_edge_recon_loss: 332143.5938; val_gene_expr_recon_loss: 207010.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9483308.0000; val_global_loss: 10065033.0000; val_optim_loss: 10065033.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9079; val_auprc_score: 0.8886; val_best_acc_score: 0.8298; val_best_f1_score: 0.8438; train_kl_reg_loss: 52730.6892; train_edge_recon_loss: 331435.1493; train_gene_expr_recon_loss: 209364.1476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9533775.2222; train_global_loss: 10127305.3333; train_optim_loss: 10127305.3333; val_kl_reg_loss: 42027.0938; val_edge_recon_loss: 333043.4375; val_gene_expr_recon_loss: 206752.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9478266.0000; val_global_loss: 10060089.0000; val_optim_loss: 10060089.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9022; val_auprc_score: 0.8809; val_best_acc_score: 0.8223; val_best_f1_score: 0.8387; train_kl_reg_loss: 52994.2574; train_edge_recon_loss: 332694.7778; train_gene_expr_recon_loss: 210377.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9595111.3333; train_global_loss: 10191177.6667; train_optim_loss: 10191177.6667; val_kl_reg_loss: 41750.5117; val_edge_recon_loss: 333796.3438; val_gene_expr_recon_loss: 206672.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9462781.0000; val_global_loss: 10045000.0000; val_optim_loss: 10045000.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9022; val_auprc_score: 0.8801; val_best_acc_score: 0.8232; val_best_f1_score: 0.8404; train_kl_reg_loss: 52830.2287; train_edge_recon_loss: 332194.9167; train_gene_expr_recon_loss: 208968.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9586067.5556; train_global_loss: 10180061.3333; train_optim_loss: 10180061.3333; val_kl_reg_loss: 41523.3281; val_edge_recon_loss: 333082.2500; val_gene_expr_recon_loss: 206764.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9472403.0000; val_global_loss: 10053773.0000; val_optim_loss: 10053773.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9065; val_auprc_score: 0.8843; val_best_acc_score: 0.8298; val_best_f1_score: 0.8447; train_kl_reg_loss: 52583.0994; train_edge_recon_loss: 332621.9236; train_gene_expr_recon_loss: 210003.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9563793.5556; train_global_loss: 10159001.5556; train_optim_loss: 10159001.5556; val_kl_reg_loss: 41909.2422; val_edge_recon_loss: 332425.6250; val_gene_expr_recon_loss: 206935.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9486691.0000; val_global_loss: 10067962.0000; val_optim_loss: 10067962.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9036; val_auprc_score: 0.8809; val_best_acc_score: 0.8278; val_best_f1_score: 0.8417; train_kl_reg_loss: 52856.0712; train_edge_recon_loss: 331645.6944; train_gene_expr_recon_loss: 210910.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624056.4444; train_global_loss: 10219468.7778; train_optim_loss: 10219468.7778; val_kl_reg_loss: 41683.6523; val_edge_recon_loss: 332439.7812; val_gene_expr_recon_loss: 207115.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9481813.0000; val_global_loss: 10063052.0000; val_optim_loss: 10063052.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9108; val_auprc_score: 0.8877; val_best_acc_score: 0.8345; val_best_f1_score: 0.8463; train_kl_reg_loss: 52356.4874; train_edge_recon_loss: 331128.1493; train_gene_expr_recon_loss: 211283.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9621938.0000; train_global_loss: 10216706.7778; train_optim_loss: 10216706.7778; val_kl_reg_loss: 41992.5391; val_edge_recon_loss: 331583.4375; val_gene_expr_recon_loss: 206704.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9483639.0000; val_global_loss: 10063920.0000; val_optim_loss: 10063920.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9081; val_auprc_score: 0.8891; val_best_acc_score: 0.8266; val_best_f1_score: 0.8410; train_kl_reg_loss: 53011.4861; train_edge_recon_loss: 332054.3090; train_gene_expr_recon_loss: 211147.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9577654.7778; train_global_loss: 10173867.8889; train_optim_loss: 10173867.8889; val_kl_reg_loss: 41992.8555; val_edge_recon_loss: 332892.3438; val_gene_expr_recon_loss: 206859.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9492573.0000; val_global_loss: 10074318.0000; val_optim_loss: 10074318.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9080; val_auprc_score: 0.8906; val_best_acc_score: 0.8251; val_best_f1_score: 0.8401; train_kl_reg_loss: 52937.2595; train_edge_recon_loss: 331667.9826; train_gene_expr_recon_loss: 209522.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9569031.0000; train_global_loss: 10163159.2222; train_optim_loss: 10163159.2222; val_kl_reg_loss: 41809.0234; val_edge_recon_loss: 333645.0938; val_gene_expr_recon_loss: 206902.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9482105.0000; val_global_loss: 10064461.0000; val_optim_loss: 10064461.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9062; val_auprc_score: 0.8842; val_best_acc_score: 0.8294; val_best_f1_score: 0.8436; train_kl_reg_loss: 52649.0525; train_edge_recon_loss: 331520.7326; train_gene_expr_recon_loss: 209954.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590168.2222; train_global_loss: 10184292.7778; train_optim_loss: 10184292.7778; val_kl_reg_loss: 41656.3750; val_edge_recon_loss: 332159.0312; val_gene_expr_recon_loss: 206808.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9473207.0000; val_global_loss: 10053831.0000; val_optim_loss: 10053831.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9065; val_auprc_score: 0.8836; val_best_acc_score: 0.8296; val_best_f1_score: 0.8461; train_kl_reg_loss: 52807.0069; train_edge_recon_loss: 331880.5035; train_gene_expr_recon_loss: 211264.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9614503.1111; train_global_loss: 10210454.8889; train_optim_loss: 10210454.8889; val_kl_reg_loss: 41581.2422; val_edge_recon_loss: 330470.5938; val_gene_expr_recon_loss: 206551.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9460168.0000; val_global_loss: 10038771.0000; val_optim_loss: 10038771.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9042; val_auprc_score: 0.8818; val_best_acc_score: 0.8235; val_best_f1_score: 0.8385; train_kl_reg_loss: 52616.7378; train_edge_recon_loss: 331388.2882; train_gene_expr_recon_loss: 209865.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602868.3333; train_global_loss: 10196739.3333; train_optim_loss: 10196739.3333; val_kl_reg_loss: 41691.4648; val_edge_recon_loss: 332760.7500; val_gene_expr_recon_loss: 206790.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9483549.0000; val_global_loss: 10064792.0000; val_optim_loss: 10064792.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9048; val_auprc_score: 0.8805; val_best_acc_score: 0.8283; val_best_f1_score: 0.8426; train_kl_reg_loss: 52818.7730; train_edge_recon_loss: 331385.4097; train_gene_expr_recon_loss: 211241.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9662106.1111; train_global_loss: 10257552.1111; train_optim_loss: 10257552.1111; val_kl_reg_loss: 41704.6523; val_edge_recon_loss: 332632.7500; val_gene_expr_recon_loss: 206726.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9472452.0000; val_global_loss: 10053515.0000; val_optim_loss: 10053515.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9091; val_auprc_score: 0.8904; val_best_acc_score: 0.8306; val_best_f1_score: 0.8443; train_kl_reg_loss: 52634.9484; train_edge_recon_loss: 330567.1424; train_gene_expr_recon_loss: 210070.9497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9581260.0000; train_global_loss: 10174533.0000; train_optim_loss: 10174533.0000; val_kl_reg_loss: 41723.5234; val_edge_recon_loss: 331174.3438; val_gene_expr_recon_loss: 207016.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9486358.0000; val_global_loss: 10066272.0000; val_optim_loss: 10066272.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9090; val_auprc_score: 0.8868; val_best_acc_score: 0.8294; val_best_f1_score: 0.8422; train_kl_reg_loss: 52735.8142; train_edge_recon_loss: 330873.0278; train_gene_expr_recon_loss: 210484.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630724.2222; train_global_loss: 10224817.3333; train_optim_loss: 10224817.3333; val_kl_reg_loss: 41721.1797; val_edge_recon_loss: 332690.5938; val_gene_expr_recon_loss: 206819.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9475616.0000; val_global_loss: 10056847.0000; val_optim_loss: 10056847.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9057; val_auprc_score: 0.8828; val_best_acc_score: 0.8281; val_best_f1_score: 0.8430; train_kl_reg_loss: 52738.4961; train_edge_recon_loss: 330607.3646; train_gene_expr_recon_loss: 210109.6649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9626211.0000; train_global_loss: 10219666.5556; train_optim_loss: 10219666.5556; val_kl_reg_loss: 41614.5156; val_edge_recon_loss: 334142.0625; val_gene_expr_recon_loss: 206649.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9470660.0000; val_global_loss: 10053066.0000; val_optim_loss: 10053066.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9109; val_auprc_score: 0.8913; val_best_acc_score: 0.8321; val_best_f1_score: 0.8465; train_kl_reg_loss: 52636.4770; train_edge_recon_loss: 332030.3507; train_gene_expr_recon_loss: 210029.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9604514.3333; train_global_loss: 10199210.2222; train_optim_loss: 10199210.2222; val_kl_reg_loss: 41768.1484; val_edge_recon_loss: 331815.1875; val_gene_expr_recon_loss: 206742.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9482676.0000; val_global_loss: 10063002.0000; val_optim_loss: 10063002.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9024; val_auprc_score: 0.8813; val_best_acc_score: 0.8236; val_best_f1_score: 0.8404; train_kl_reg_loss: 52615.6419; train_edge_recon_loss: 331452.3576; train_gene_expr_recon_loss: 209844.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9579659.1111; train_global_loss: 10173571.7778; train_optim_loss: 10173571.7778; val_kl_reg_loss: 41528.6602; val_edge_recon_loss: 333121.8125; val_gene_expr_recon_loss: 206729.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9465927.0000; val_global_loss: 10047307.0000; val_optim_loss: 10047307.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9050; val_auprc_score: 0.8836; val_best_acc_score: 0.8289; val_best_f1_score: 0.8423; train_kl_reg_loss: 52624.2635; train_edge_recon_loss: 331680.0243; train_gene_expr_recon_loss: 210493.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9566204.4444; train_global_loss: 10161002.0000; train_optim_loss: 10161002.0000; val_kl_reg_loss: 41737.9844; val_edge_recon_loss: 331408.6562; val_gene_expr_recon_loss: 206769.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9474839.0000; val_global_loss: 10054755.0000; val_optim_loss: 10054755.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 33 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9081
Val AUPRC score: 0.8860
Val best accuracy score: 0.8336
Val best F1 score: 0.8469
Val gene expr MSE score: 0.5211
Val chrom access MSE score: 0.0847
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
