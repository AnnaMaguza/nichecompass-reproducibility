[True]
Run timestamp: 07092023_135041_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.5898; val_auprc_score: 0.5929; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 49594.0556; train_edge_recon_loss: 3536969.4318; train_gene_expr_recon_loss: 16644505.6818; train_masked_gp_l1_reg_loss: 84566.7240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1462311.3333; train_chrom_access_recon_loss: 1273761.7822; train_global_loss: 23051709.1515; train_optim_loss: 23051709.1515; val_kl_reg_loss: 102712.9951; val_edge_recon_loss: 4065588.9688; val_gene_expr_recon_loss: 15260375.6250; val_masked_gp_l1_reg_loss: 82124.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1110452.5000; val_chrom_access_recon_loss: 1231335.3594; val_global_loss: 21852588.7500; val_optim_loss: 21852588.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7112; val_auprc_score: 0.7007; val_best_acc_score: 0.5102; val_best_f1_score: 0.6702; train_kl_reg_loss: 101519.4724; train_edge_recon_loss: 3523720.6174; train_gene_expr_recon_loss: 14876533.7273; train_masked_gp_l1_reg_loss: 77452.9123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 814810.0208; train_chrom_access_recon_loss: 1204978.0341; train_global_loss: 20599014.8182; train_optim_loss: 20599014.8182; val_kl_reg_loss: 90416.5654; val_edge_recon_loss: 4064327.3750; val_gene_expr_recon_loss: 14574488.6250; val_masked_gp_l1_reg_loss: 74598.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 567262.5000; val_chrom_access_recon_loss: 1201785.0781; val_global_loss: 20572877.5000; val_optim_loss: 20572877.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7737; val_auprc_score: 0.7638; val_best_acc_score: 0.6075; val_best_f1_score: 0.7069; train_kl_reg_loss: 99786.7530; train_edge_recon_loss: 3522045.1629; train_gene_expr_recon_loss: 14611090.4091; train_masked_gp_l1_reg_loss: 74389.8732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 424191.9920; train_chrom_access_recon_loss: 1187935.5663; train_global_loss: 19919439.6970; train_optim_loss: 19919439.6970; val_kl_reg_loss: 101117.3145; val_edge_recon_loss: 4057036.3750; val_gene_expr_recon_loss: 14503328.0000; val_masked_gp_l1_reg_loss: 75045.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 311318.9062; val_chrom_access_recon_loss: 1188292.9688; val_global_loss: 20236138.2500; val_optim_loss: 20236138.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8115; val_auprc_score: 0.7959; val_best_acc_score: 0.7448; val_best_f1_score: 0.7423; train_kl_reg_loss: 91788.1121; train_edge_recon_loss: 3514321.0720; train_gene_expr_recon_loss: 14491700.5606; train_masked_gp_l1_reg_loss: 76518.9858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245629.9794; train_chrom_access_recon_loss: 1179134.8977; train_global_loss: 19599093.8485; train_optim_loss: 19599093.8485; val_kl_reg_loss: 81978.0605; val_edge_recon_loss: 4006688.7188; val_gene_expr_recon_loss: 14373681.2500; val_masked_gp_l1_reg_loss: 78239.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192842.5312; val_chrom_access_recon_loss: 1173889.3125; val_global_loss: 19907319.5000; val_optim_loss: 19907319.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8270; val_auprc_score: 0.7990; val_best_acc_score: 0.7569; val_best_f1_score: 0.7819; train_kl_reg_loss: 76692.7678; train_edge_recon_loss: 3465031.4242; train_gene_expr_recon_loss: 14395590.2424; train_masked_gp_l1_reg_loss: 80239.3737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161378.8781; train_chrom_access_recon_loss: 1174053.7386; train_global_loss: 19352986.1818; train_optim_loss: 19352986.1818; val_kl_reg_loss: 64261.7070; val_edge_recon_loss: 3520734.0000; val_gene_expr_recon_loss: 14367579.7500; val_masked_gp_l1_reg_loss: 83035.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136243.1094; val_chrom_access_recon_loss: 1185950.2031; val_global_loss: 19357805.2500; val_optim_loss: 19357805.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8327; val_auprc_score: 0.7923; val_best_acc_score: 0.7598; val_best_f1_score: 0.7926; train_kl_reg_loss: 66189.2102; train_edge_recon_loss: 3189037.5152; train_gene_expr_recon_loss: 14390150.6061; train_masked_gp_l1_reg_loss: 87191.0262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122316.8784; train_chrom_access_recon_loss: 1170013.3636; train_global_loss: 19024898.5455; train_optim_loss: 19024898.5455; val_kl_reg_loss: 81907.4072; val_edge_recon_loss: 3056580.4375; val_gene_expr_recon_loss: 14277295.6250; val_masked_gp_l1_reg_loss: 90216.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107413.1953; val_chrom_access_recon_loss: 1160832.7109; val_global_loss: 18774246.5000; val_optim_loss: 18774246.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8458; val_auprc_score: 0.8102; val_best_acc_score: 0.7555; val_best_f1_score: 0.7929; train_kl_reg_loss: 97062.3828; train_edge_recon_loss: 2985269.3598; train_gene_expr_recon_loss: 14285436.6515; train_masked_gp_l1_reg_loss: 91517.3402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95764.5597; train_chrom_access_recon_loss: 1163420.2727; train_global_loss: 18718470.7879; train_optim_loss: 18718470.7879; val_kl_reg_loss: 103290.2061; val_edge_recon_loss: 2957258.4062; val_gene_expr_recon_loss: 14371774.3750; val_masked_gp_l1_reg_loss: 92303.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85814.6641; val_chrom_access_recon_loss: 1174164.3125; val_global_loss: 18784605.2500; val_optim_loss: 18784605.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8469; val_auprc_score: 0.8032; val_best_acc_score: 0.7743; val_best_f1_score: 0.7942; train_kl_reg_loss: 103301.8958; train_edge_recon_loss: 2959368.3636; train_gene_expr_recon_loss: 14205114.7424; train_masked_gp_l1_reg_loss: 93278.7565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78883.3338; train_chrom_access_recon_loss: 1157759.8996; train_global_loss: 18597707.1212; train_optim_loss: 18597707.1212; val_kl_reg_loss: 102091.4229; val_edge_recon_loss: 2950699.6250; val_gene_expr_recon_loss: 14157677.0000; val_masked_gp_l1_reg_loss: 94500.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73093.8125; val_chrom_access_recon_loss: 1171657.9375; val_global_loss: 18549719.7500; val_optim_loss: 18549719.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8423; val_auprc_score: 0.8007; val_best_acc_score: 0.7614; val_best_f1_score: 0.7887; train_kl_reg_loss: 100662.5258; train_edge_recon_loss: 2928333.6477; train_gene_expr_recon_loss: 14118693.7273; train_masked_gp_l1_reg_loss: 95340.8117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68077.4250; train_chrom_access_recon_loss: 1151612.1932; train_global_loss: 18462720.4848; train_optim_loss: 18462720.4848; val_kl_reg_loss: 95291.5664; val_edge_recon_loss: 3000181.6875; val_gene_expr_recon_loss: 14205645.8750; val_masked_gp_l1_reg_loss: 96388.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64018.1328; val_chrom_access_recon_loss: 1166436.8125; val_global_loss: 18627962.0000; val_optim_loss: 18627962.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8665; val_auprc_score: 0.8280; val_best_acc_score: 0.7867; val_best_f1_score: 0.8057; train_kl_reg_loss: 98638.7791; train_edge_recon_loss: 2909784.8788; train_gene_expr_recon_loss: 14074303.8485; train_masked_gp_l1_reg_loss: 97263.8729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60496.6800; train_chrom_access_recon_loss: 1147614.5568; train_global_loss: 18388102.5455; train_optim_loss: 18388102.5455; val_kl_reg_loss: 94495.6641; val_edge_recon_loss: 2935490.5625; val_gene_expr_recon_loss: 14040942.6250; val_masked_gp_l1_reg_loss: 98109.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57258.5703; val_chrom_access_recon_loss: 1156413.7500; val_global_loss: 18382710.7500; val_optim_loss: 18382710.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8695; val_auprc_score: 0.8260; val_best_acc_score: 0.8001; val_best_f1_score: 0.8194; train_kl_reg_loss: 93575.8344; train_edge_recon_loss: 2889739.8030; train_gene_expr_recon_loss: 14012850.2879; train_masked_gp_l1_reg_loss: 99048.6052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54922.1677; train_chrom_access_recon_loss: 1143876.7708; train_global_loss: 18294013.4848; train_optim_loss: 18294013.4848; val_kl_reg_loss: 93370.0791; val_edge_recon_loss: 2926717.1250; val_gene_expr_recon_loss: 13921562.1250; val_masked_gp_l1_reg_loss: 99911.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52868.2188; val_chrom_access_recon_loss: 1146187.0312; val_global_loss: 18240616.5000; val_optim_loss: 18240616.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8853; val_auprc_score: 0.8517; val_best_acc_score: 0.8229; val_best_f1_score: 0.8422; train_kl_reg_loss: 95787.4895; train_edge_recon_loss: 2840631.0152; train_gene_expr_recon_loss: 13956211.5909; train_masked_gp_l1_reg_loss: 100890.9864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51389.5763; train_chrom_access_recon_loss: 1137659.7348; train_global_loss: 18182570.3939; train_optim_loss: 18182570.3939; val_kl_reg_loss: 99974.1064; val_edge_recon_loss: 2837858.2500; val_gene_expr_recon_loss: 13826006.3750; val_masked_gp_l1_reg_loss: 101859.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50246.8047; val_chrom_access_recon_loss: 1139184.1719; val_global_loss: 18055129.0000; val_optim_loss: 18055129.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9036; val_auprc_score: 0.8756; val_best_acc_score: 0.8348; val_best_f1_score: 0.8466; train_kl_reg_loss: 96686.8424; train_edge_recon_loss: 2820127.8485; train_gene_expr_recon_loss: 13924551.9242; train_masked_gp_l1_reg_loss: 102656.0560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49216.9252; train_chrom_access_recon_loss: 1136251.6326; train_global_loss: 18129491.3333; train_optim_loss: 18129491.3333; val_kl_reg_loss: 93640.5029; val_edge_recon_loss: 2859463.5625; val_gene_expr_recon_loss: 13798133.6250; val_masked_gp_l1_reg_loss: 103664.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48584.1289; val_chrom_access_recon_loss: 1136220.6562; val_global_loss: 18039705.7500; val_optim_loss: 18039705.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9007; val_auprc_score: 0.8634; val_best_acc_score: 0.8380; val_best_f1_score: 0.8512; train_kl_reg_loss: 95297.3627; train_edge_recon_loss: 2813275.6515; train_gene_expr_recon_loss: 13870556.9848; train_masked_gp_l1_reg_loss: 104570.4764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47602.1814; train_chrom_access_recon_loss: 1130789.9205; train_global_loss: 18062092.4848; train_optim_loss: 18062092.4848; val_kl_reg_loss: 101802.8965; val_edge_recon_loss: 2826523.2500; val_gene_expr_recon_loss: 13911147.6250; val_masked_gp_l1_reg_loss: 105444.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46918.6289; val_chrom_access_recon_loss: 1149918.8750; val_global_loss: 18141755.0000; val_optim_loss: 18141755.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9025; val_auprc_score: 0.8672; val_best_acc_score: 0.8388; val_best_f1_score: 0.8497; train_kl_reg_loss: 96976.2852; train_edge_recon_loss: 2792761.5644; train_gene_expr_recon_loss: 13825432.0000; train_masked_gp_l1_reg_loss: 105944.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46377.5509; train_chrom_access_recon_loss: 1127633.6364; train_global_loss: 17995125.3939; train_optim_loss: 17995125.3939; val_kl_reg_loss: 92639.5566; val_edge_recon_loss: 2844314.8750; val_gene_expr_recon_loss: 13815865.1250; val_masked_gp_l1_reg_loss: 106886.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46253.5859; val_chrom_access_recon_loss: 1140045.6250; val_global_loss: 18046005.2500; val_optim_loss: 18046005.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9163; val_auprc_score: 0.8883; val_best_acc_score: 0.8563; val_best_f1_score: 0.8680; train_kl_reg_loss: 93649.9895; train_edge_recon_loss: 2778288.5833; train_gene_expr_recon_loss: 13786855.4091; train_masked_gp_l1_reg_loss: 107373.1449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45507.4337; train_chrom_access_recon_loss: 1124162.9318; train_global_loss: 17935837.6364; train_optim_loss: 17935837.6364; val_kl_reg_loss: 92610.8330; val_edge_recon_loss: 2805131.7500; val_gene_expr_recon_loss: 13757336.7500; val_masked_gp_l1_reg_loss: 108169.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45465.2227; val_chrom_access_recon_loss: 1127076.0312; val_global_loss: 17935790.7500; val_optim_loss: 17935790.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9167; val_auprc_score: 0.8886; val_best_acc_score: 0.8595; val_best_f1_score: 0.8698; train_kl_reg_loss: 93430.4508; train_edge_recon_loss: 2772205.6174; train_gene_expr_recon_loss: 13762322.8636; train_masked_gp_l1_reg_loss: 108809.7732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44896.9084; train_chrom_access_recon_loss: 1121423.6345; train_global_loss: 17903089.0909; train_optim_loss: 17903089.0909; val_kl_reg_loss: 90660.6162; val_edge_recon_loss: 2794253.2500; val_gene_expr_recon_loss: 13648181.5000; val_masked_gp_l1_reg_loss: 109569.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44552.1680; val_chrom_access_recon_loss: 1130920.0312; val_global_loss: 17818137.2500; val_optim_loss: 17818137.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9186; val_auprc_score: 0.8940; val_best_acc_score: 0.8571; val_best_f1_score: 0.8665; train_kl_reg_loss: 92319.0482; train_edge_recon_loss: 2768235.9583; train_gene_expr_recon_loss: 13719175.5909; train_masked_gp_l1_reg_loss: 110057.0266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44019.6806; train_chrom_access_recon_loss: 1117836.6932; train_global_loss: 17851644.0606; train_optim_loss: 17851644.0606; val_kl_reg_loss: 95153.3896; val_edge_recon_loss: 2797379.2500; val_gene_expr_recon_loss: 13631497.0000; val_masked_gp_l1_reg_loss: 110448.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43627.4727; val_chrom_access_recon_loss: 1120463.3750; val_global_loss: 17798568.5000; val_optim_loss: 17798568.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9212; val_auprc_score: 0.8859; val_best_acc_score: 0.8646; val_best_f1_score: 0.8727; train_kl_reg_loss: 92864.1003; train_edge_recon_loss: 2750383.8598; train_gene_expr_recon_loss: 13689899.2727; train_masked_gp_l1_reg_loss: 110878.1225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43292.8873; train_chrom_access_recon_loss: 1115842.3750; train_global_loss: 17803160.7576; train_optim_loss: 17803160.7576; val_kl_reg_loss: 94733.0430; val_edge_recon_loss: 2741560.6875; val_gene_expr_recon_loss: 13626054.1250; val_masked_gp_l1_reg_loss: 111436.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43031.1953; val_chrom_access_recon_loss: 1119452.3750; val_global_loss: 17736268.2500; val_optim_loss: 17736268.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9167; val_auprc_score: 0.8942; val_best_acc_score: 0.8557; val_best_f1_score: 0.8650; train_kl_reg_loss: 91601.7126; train_edge_recon_loss: 2751513.4470; train_gene_expr_recon_loss: 13650515.9091; train_masked_gp_l1_reg_loss: 111950.8031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42705.6534; train_chrom_access_recon_loss: 1112058.6553; train_global_loss: 17760346.3939; train_optim_loss: 17760346.3939; val_kl_reg_loss: 94234.1699; val_edge_recon_loss: 2804980.0625; val_gene_expr_recon_loss: 13545140.3750; val_masked_gp_l1_reg_loss: 112500.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42378.9805; val_chrom_access_recon_loss: 1118192.3281; val_global_loss: 17717426.5000; val_optim_loss: 17717426.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9260; val_auprc_score: 0.8952; val_best_acc_score: 0.8716; val_best_f1_score: 0.8772; train_kl_reg_loss: 92149.8410; train_edge_recon_loss: 2746997.4318; train_gene_expr_recon_loss: 13639273.9091; train_masked_gp_l1_reg_loss: 112886.4479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42015.1975; train_chrom_access_recon_loss: 1110607.9252; train_global_loss: 17743930.9091; train_optim_loss: 17743930.9091; val_kl_reg_loss: 89754.8418; val_edge_recon_loss: 2790620.7812; val_gene_expr_recon_loss: 13575755.7500; val_masked_gp_l1_reg_loss: 113520.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41740.0078; val_chrom_access_recon_loss: 1115853.7500; val_global_loss: 17727244.7500; val_optim_loss: 17727244.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9287; val_auprc_score: 0.8982; val_best_acc_score: 0.8702; val_best_f1_score: 0.8764; train_kl_reg_loss: 90352.3879; train_edge_recon_loss: 2751306.8409; train_gene_expr_recon_loss: 13592757.8636; train_masked_gp_l1_reg_loss: 113817.3376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41473.8833; train_chrom_access_recon_loss: 1107128.7074; train_global_loss: 17696837.0606; train_optim_loss: 17696837.0606; val_kl_reg_loss: 93287.0137; val_edge_recon_loss: 2771653.6562; val_gene_expr_recon_loss: 13616393.1250; val_masked_gp_l1_reg_loss: 114276.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41075.6953; val_chrom_access_recon_loss: 1121734.3438; val_global_loss: 17758420.5000; val_optim_loss: 17758420.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9311; val_auprc_score: 0.9060; val_best_acc_score: 0.8737; val_best_f1_score: 0.8802; train_kl_reg_loss: 89440.8047; train_edge_recon_loss: 2736404.6439; train_gene_expr_recon_loss: 13561776.8333; train_masked_gp_l1_reg_loss: 114608.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40920.3727; train_chrom_access_recon_loss: 1104591.1496; train_global_loss: 17647742.0455; train_optim_loss: 17647742.0455; val_kl_reg_loss: 90476.2314; val_edge_recon_loss: 2728299.7500; val_gene_expr_recon_loss: 13462688.6250; val_masked_gp_l1_reg_loss: 114930.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40572.7383; val_chrom_access_recon_loss: 1107327.8594; val_global_loss: 17544295.5000; val_optim_loss: 17544295.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9373; val_auprc_score: 0.9110; val_best_acc_score: 0.8799; val_best_f1_score: 0.8851; train_kl_reg_loss: 88947.2625; train_edge_recon_loss: 2743540.3902; train_gene_expr_recon_loss: 13541596.7273; train_masked_gp_l1_reg_loss: 115298.9219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40383.8643; train_chrom_access_recon_loss: 1102435.8532; train_global_loss: 17632203.0152; train_optim_loss: 17632203.0152; val_kl_reg_loss: 87569.8906; val_edge_recon_loss: 2774708.1562; val_gene_expr_recon_loss: 13463269.5000; val_masked_gp_l1_reg_loss: 115758.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40203.2695; val_chrom_access_recon_loss: 1114141.7656; val_global_loss: 17595650.7500; val_optim_loss: 17595650.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9352; val_auprc_score: 0.9031; val_best_acc_score: 0.8804; val_best_f1_score: 0.8860; train_kl_reg_loss: 87652.2543; train_edge_recon_loss: 2738469.7652; train_gene_expr_recon_loss: 13511894.0606; train_masked_gp_l1_reg_loss: 116091.0039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39957.0373; train_chrom_access_recon_loss: 1100028.4148; train_global_loss: 17594092.5303; train_optim_loss: 17594092.5303; val_kl_reg_loss: 85770.1914; val_edge_recon_loss: 2768038.0000; val_gene_expr_recon_loss: 13481608.5000; val_masked_gp_l1_reg_loss: 116524.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40031.5195; val_chrom_access_recon_loss: 1100728.0625; val_global_loss: 17592701.2500; val_optim_loss: 17592701.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9362; val_auprc_score: 0.9126; val_best_acc_score: 0.8737; val_best_f1_score: 0.8804; train_kl_reg_loss: 95118.7515; train_edge_recon_loss: 2758539.6250; train_gene_expr_recon_loss: 13278407.4545; train_masked_gp_l1_reg_loss: 115596.8474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35060.8311; train_chrom_access_recon_loss: 1084220.5379; train_global_loss: 17366944.1212; train_optim_loss: 17366944.1212; val_kl_reg_loss: 63771.2173; val_edge_recon_loss: 2759400.1875; val_gene_expr_recon_loss: 13090517.8750; val_masked_gp_l1_reg_loss: 115387.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33779.8945; val_chrom_access_recon_loss: 1086667.2344; val_global_loss: 17149524.8750; val_optim_loss: 17149524.8750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9424; val_auprc_score: 0.9253; val_best_acc_score: 0.8847; val_best_f1_score: 0.8889; train_kl_reg_loss: 95905.1523; train_edge_recon_loss: 2752482.0492; train_gene_expr_recon_loss: 13223269.3030; train_masked_gp_l1_reg_loss: 115624.0608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33711.1426; train_chrom_access_recon_loss: 1075303.9924; train_global_loss: 17296295.7424; train_optim_loss: 17296295.7424; val_kl_reg_loss: 67600.9121; val_edge_recon_loss: 2761297.9062; val_gene_expr_recon_loss: 13194349.2500; val_masked_gp_l1_reg_loss: 115925.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33693.5508; val_chrom_access_recon_loss: 1076987.5000; val_global_loss: 17249854.5000; val_optim_loss: 17249854.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9380; val_auprc_score: 0.9061; val_best_acc_score: 0.8826; val_best_f1_score: 0.8880; train_kl_reg_loss: 92640.9013; train_edge_recon_loss: 2736914.4962; train_gene_expr_recon_loss: 13207945.5606; train_masked_gp_l1_reg_loss: 116093.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33600.4657; train_chrom_access_recon_loss: 1073513.2159; train_global_loss: 17260707.7121; train_optim_loss: 17260707.7121; val_kl_reg_loss: 68235.8770; val_edge_recon_loss: 2769205.2188; val_gene_expr_recon_loss: 13197743.1250; val_masked_gp_l1_reg_loss: 116417.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33589.0000; val_chrom_access_recon_loss: 1082863.6484; val_global_loss: 17268055.0000; val_optim_loss: 17268055.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9469; val_auprc_score: 0.9282; val_best_acc_score: 0.8888; val_best_f1_score: 0.8940; train_kl_reg_loss: 89533.1164; train_edge_recon_loss: 2729258.1288; train_gene_expr_recon_loss: 13178189.3788; train_masked_gp_l1_reg_loss: 116629.0991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33554.5096; train_chrom_access_recon_loss: 1071708.9034; train_global_loss: 17218873.1515; train_optim_loss: 17218873.1515; val_kl_reg_loss: 69294.7031; val_edge_recon_loss: 2742811.9688; val_gene_expr_recon_loss: 13071814.6250; val_masked_gp_l1_reg_loss: 116891.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33536.7188; val_chrom_access_recon_loss: 1083603.8594; val_global_loss: 17117953.8750; val_optim_loss: 17117953.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9395; val_auprc_score: 0.9073; val_best_acc_score: 0.8861; val_best_f1_score: 0.8907; train_kl_reg_loss: 86952.3402; train_edge_recon_loss: 2719885.6136; train_gene_expr_recon_loss: 13161668.0152; train_masked_gp_l1_reg_loss: 116974.7292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33491.6983; train_chrom_access_recon_loss: 1070124.3759; train_global_loss: 17189096.6667; train_optim_loss: 17189096.6667; val_kl_reg_loss: 68956.2207; val_edge_recon_loss: 2761781.0312; val_gene_expr_recon_loss: 13161378.7500; val_masked_gp_l1_reg_loss: 117268.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33476.6406; val_chrom_access_recon_loss: 1072537.8359; val_global_loss: 17215399.1250; val_optim_loss: 17215399.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9450; val_auprc_score: 0.9183; val_best_acc_score: 0.8920; val_best_f1_score: 0.8978; train_kl_reg_loss: 85702.9002; train_edge_recon_loss: 2709341.9129; train_gene_expr_recon_loss: 13129915.5909; train_masked_gp_l1_reg_loss: 117362.8159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33384.4825; train_chrom_access_recon_loss: 1068358.6771; train_global_loss: 17144066.4697; train_optim_loss: 17144066.4697; val_kl_reg_loss: 71495.0566; val_edge_recon_loss: 2718794.7812; val_gene_expr_recon_loss: 12944254.3750; val_masked_gp_l1_reg_loss: 117559.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33283.3359; val_chrom_access_recon_loss: 1068216.7344; val_global_loss: 16953604.2500; val_optim_loss: 16953604.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9490; val_auprc_score: 0.9299; val_best_acc_score: 0.8960; val_best_f1_score: 0.9010; train_kl_reg_loss: 83711.5768; train_edge_recon_loss: 2709924.6705; train_gene_expr_recon_loss: 13105428.7121; train_masked_gp_l1_reg_loss: 117545.9657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33156.5709; train_chrom_access_recon_loss: 1065844.0587; train_global_loss: 17115611.6515; train_optim_loss: 17115611.6515; val_kl_reg_loss: 73449.2783; val_edge_recon_loss: 2736283.2812; val_gene_expr_recon_loss: 13083428.8750; val_masked_gp_l1_reg_loss: 117630.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33099.2852; val_chrom_access_recon_loss: 1072679.2031; val_global_loss: 17116570.1250; val_optim_loss: 17116570.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9483; val_auprc_score: 0.9293; val_best_acc_score: 0.8933; val_best_f1_score: 0.8993; train_kl_reg_loss: 82164.2704; train_edge_recon_loss: 2717597.5038; train_gene_expr_recon_loss: 13089562.7424; train_masked_gp_l1_reg_loss: 117726.7507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33007.8925; train_chrom_access_recon_loss: 1063912.0114; train_global_loss: 17103971.0758; train_optim_loss: 17103971.0758; val_kl_reg_loss: 73517.5029; val_edge_recon_loss: 2750560.2812; val_gene_expr_recon_loss: 13096636.6250; val_masked_gp_l1_reg_loss: 117789.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32937.4531; val_chrom_access_recon_loss: 1064481.5547; val_global_loss: 17135922.2500; val_optim_loss: 17135922.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9504; val_auprc_score: 0.9313; val_best_acc_score: 0.8963; val_best_f1_score: 0.9005; train_kl_reg_loss: 81783.7042; train_edge_recon_loss: 2708708.3447; train_gene_expr_recon_loss: 13078206.9242; train_masked_gp_l1_reg_loss: 117850.1568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32900.8278; train_chrom_access_recon_loss: 1062688.5369; train_global_loss: 17082138.5152; train_optim_loss: 17082138.5152; val_kl_reg_loss: 76048.3857; val_edge_recon_loss: 2732011.8438; val_gene_expr_recon_loss: 13105212.3750; val_masked_gp_l1_reg_loss: 118060.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32837.0195; val_chrom_access_recon_loss: 1070843.4219; val_global_loss: 17135013.7500; val_optim_loss: 17135013.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9504; val_auprc_score: 0.9283; val_best_acc_score: 0.8979; val_best_f1_score: 0.9011; train_kl_reg_loss: 81099.5594; train_edge_recon_loss: 2706432.2614; train_gene_expr_recon_loss: 13065839.5303; train_masked_gp_l1_reg_loss: 118089.4415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32729.4408; train_chrom_access_recon_loss: 1061791.4309; train_global_loss: 17065981.7576; train_optim_loss: 17065981.7576; val_kl_reg_loss: 76337.3066; val_edge_recon_loss: 2759834.5625; val_gene_expr_recon_loss: 13039067.6250; val_masked_gp_l1_reg_loss: 118265.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32668.6621; val_chrom_access_recon_loss: 1070165.1094; val_global_loss: 17096338.2500; val_optim_loss: 17096338.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9465; val_auprc_score: 0.9222; val_best_acc_score: 0.8960; val_best_f1_score: 0.9007; train_kl_reg_loss: 82475.4022; train_edge_recon_loss: 2708019.3561; train_gene_expr_recon_loss: 13052647.1364; train_masked_gp_l1_reg_loss: 117350.1450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29881.8584; train_chrom_access_recon_loss: 1060553.1212; train_global_loss: 17050927.1667; train_optim_loss: 17050927.1667; val_kl_reg_loss: 76696.7520; val_edge_recon_loss: 2756900.7188; val_gene_expr_recon_loss: 13085503.8750; val_masked_gp_l1_reg_loss: 116862.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29144.9863; val_chrom_access_recon_loss: 1084175.9453; val_global_loss: 17149284.1250; val_optim_loss: 17149284.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9482; val_auprc_score: 0.9248; val_best_acc_score: 0.8968; val_best_f1_score: 0.9015; train_kl_reg_loss: 82422.4267; train_edge_recon_loss: 2690526.0417; train_gene_expr_recon_loss: 13035599.8939; train_masked_gp_l1_reg_loss: 116727.3106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28972.3103; train_chrom_access_recon_loss: 1060329.1193; train_global_loss: 17014577.1818; train_optim_loss: 17014577.1818; val_kl_reg_loss: 76808.3564; val_edge_recon_loss: 2736036.5000; val_gene_expr_recon_loss: 13006211.2500; val_masked_gp_l1_reg_loss: 116632.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28841.4609; val_chrom_access_recon_loss: 1062882.5156; val_global_loss: 17027411.5000; val_optim_loss: 17027411.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9508; val_auprc_score: 0.9294; val_best_acc_score: 0.8987; val_best_f1_score: 0.9026; train_kl_reg_loss: 82475.2724; train_edge_recon_loss: 2695614.8788; train_gene_expr_recon_loss: 13034075.8030; train_masked_gp_l1_reg_loss: 116572.4374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28742.3282; train_chrom_access_recon_loss: 1059454.1922; train_global_loss: 17016935.0000; train_optim_loss: 17016935.0000; val_kl_reg_loss: 77623.5664; val_edge_recon_loss: 2723408.6875; val_gene_expr_recon_loss: 13146026.8750; val_masked_gp_l1_reg_loss: 116520.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28644.0469; val_chrom_access_recon_loss: 1079461.7656; val_global_loss: 17171685.7500; val_optim_loss: 17171685.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9539; val_auprc_score: 0.9375; val_best_acc_score: 0.8992; val_best_f1_score: 0.9027; train_kl_reg_loss: 82660.1901; train_edge_recon_loss: 2691143.7083; train_gene_expr_recon_loss: 13036994.7727; train_masked_gp_l1_reg_loss: 116505.0258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28580.2413; train_chrom_access_recon_loss: 1060063.5398; train_global_loss: 17015947.3939; train_optim_loss: 17015947.3939; val_kl_reg_loss: 77115.9238; val_edge_recon_loss: 2743019.5625; val_gene_expr_recon_loss: 13114751.5000; val_masked_gp_l1_reg_loss: 116482.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28507.9473; val_chrom_access_recon_loss: 1070633.6562; val_global_loss: 17150510.3750; val_optim_loss: 17150510.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 22 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9416
val AUPRC score: 0.9102
val best accuracy score: 0.8845
val best F1 score: 0.8920
val target rna MSE score: 0.9399
val source rna MSE score: 0.3636
val target atac MSE score: 0.4909
val source atac MSE score: 0.1103
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
