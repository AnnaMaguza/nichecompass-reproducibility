[True]
Run timestamp: 07082023_170335_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8764; val_auprc_score: 0.8857; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 135109.3505; train_edge_recon_loss: 36419.6766; train_gene_expr_recon_loss: 1209643.6736; train_masked_gp_l1_reg_loss: 8714.9393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167031.1997; train_chrom_access_recon_loss: 2653708.5000; train_global_loss: 4210627.3889; train_optim_loss: 4210627.3889; val_kl_reg_loss: 32608.8047; val_edge_recon_loss: 40660.2266; val_gene_expr_recon_loss: 1023394.6250; val_masked_gp_l1_reg_loss: 7448.9038; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162451.7812; val_chrom_access_recon_loss: 1851476.3750; val_global_loss: 3118040.5000; val_optim_loss: 3118040.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8621; val_auprc_score: 0.8687; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 38796.0751; train_edge_recon_loss: 39687.6862; train_gene_expr_recon_loss: 905838.1875; train_masked_gp_l1_reg_loss: 7099.3459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159425.8160; train_chrom_access_recon_loss: 1637940.6250; train_global_loss: 2788787.7778; train_optim_loss: 2788787.7778; val_kl_reg_loss: 36701.3047; val_edge_recon_loss: 40657.2070; val_gene_expr_recon_loss: 808778.5625; val_masked_gp_l1_reg_loss: 6833.5537; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155694.2500; val_chrom_access_recon_loss: 1480524.6250; val_global_loss: 2529189.5000; val_optim_loss: 2529189.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8581; val_auprc_score: 0.8653; val_best_acc_score: 0.5047; val_best_f1_score: 0.6688; train_kl_reg_loss: 33401.1137; train_edge_recon_loss: 39454.1970; train_gene_expr_recon_loss: 803169.9514; train_masked_gp_l1_reg_loss: 6920.4702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152657.4340; train_chrom_access_recon_loss: 1426661.0694; train_global_loss: 2462264.2778; train_optim_loss: 2462264.2778; val_kl_reg_loss: 29780.0840; val_edge_recon_loss: 40653.3164; val_gene_expr_recon_loss: 770731.8750; val_masked_gp_l1_reg_loss: 7070.3540; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148758.4688; val_chrom_access_recon_loss: 1406230.5000; val_global_loss: 2403224.5000; val_optim_loss: 2403224.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8449; val_auprc_score: 0.8521; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 33892.1391; train_edge_recon_loss: 39236.9718; train_gene_expr_recon_loss: 772637.0208; train_masked_gp_l1_reg_loss: 7088.7497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145439.2431; train_chrom_access_recon_loss: 1382654.2917; train_global_loss: 2380948.4444; train_optim_loss: 2380948.4444; val_kl_reg_loss: 30074.3242; val_edge_recon_loss: 40652.4258; val_gene_expr_recon_loss: 744951.5625; val_masked_gp_l1_reg_loss: 7061.2197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141160.0781; val_chrom_access_recon_loss: 1384160.2500; val_global_loss: 2348060.0000; val_optim_loss: 2348060.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8407; val_auprc_score: 0.8455; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 30670.4896; train_edge_recon_loss: 39306.9774; train_gene_expr_recon_loss: 747109.3125; train_masked_gp_l1_reg_loss: 6995.1653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137512.2066; train_chrom_access_recon_loss: 1363157.0556; train_global_loss: 2324751.1389; train_optim_loss: 2324751.1389; val_kl_reg_loss: 29975.1445; val_edge_recon_loss: 40649.3945; val_gene_expr_recon_loss: 728831.2500; val_masked_gp_l1_reg_loss: 6898.1421; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132847.9844; val_chrom_access_recon_loss: 1367475.2500; val_global_loss: 2306677.2500; val_optim_loss: 2306677.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8337; val_auprc_score: 0.8415; val_best_acc_score: 0.5199; val_best_f1_score: 0.6754; train_kl_reg_loss: 30215.0688; train_edge_recon_loss: 39251.7947; train_gene_expr_recon_loss: 728656.5139; train_masked_gp_l1_reg_loss: 6825.2805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129033.2917; train_chrom_access_recon_loss: 1345434.7778; train_global_loss: 2279416.6944; train_optim_loss: 2279416.6944; val_kl_reg_loss: 29937.9629; val_edge_recon_loss: 40644.1289; val_gene_expr_recon_loss: 715876.6250; val_masked_gp_l1_reg_loss: 6732.9546; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124247.9531; val_chrom_access_recon_loss: 1357710.0000; val_global_loss: 2275149.5000; val_optim_loss: 2275149.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8217; val_auprc_score: 0.8294; val_best_acc_score: 0.5346; val_best_f1_score: 0.6820; train_kl_reg_loss: 30659.5035; train_edge_recon_loss: 39267.8585; train_gene_expr_recon_loss: 720521.6389; train_masked_gp_l1_reg_loss: 6661.0205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120443.3455; train_chrom_access_recon_loss: 1342641.2361; train_global_loss: 2260194.5556; train_optim_loss: 2260194.5556; val_kl_reg_loss: 30717.8809; val_edge_recon_loss: 40633.1406; val_gene_expr_recon_loss: 705520.7500; val_masked_gp_l1_reg_loss: 6575.2046; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115737.5391; val_chrom_access_recon_loss: 1350608.8750; val_global_loss: 2249793.5000; val_optim_loss: 2249793.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8168; val_auprc_score: 0.8208; val_best_acc_score: 0.5447; val_best_f1_score: 0.6863; train_kl_reg_loss: 29787.4264; train_edge_recon_loss: 39237.4857; train_gene_expr_recon_loss: 710838.9514; train_masked_gp_l1_reg_loss: 6530.4123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112082.7465; train_chrom_access_recon_loss: 1331378.3056; train_global_loss: 2229855.3611; train_optim_loss: 2229855.3611; val_kl_reg_loss: 29697.2695; val_edge_recon_loss: 40624.4570; val_gene_expr_recon_loss: 696390.6250; val_masked_gp_l1_reg_loss: 6475.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107600.0781; val_chrom_access_recon_loss: 1345753.8750; val_global_loss: 2226542.0000; val_optim_loss: 2226542.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8231; val_auprc_score: 0.8300; val_best_acc_score: 0.5566; val_best_f1_score: 0.6903; train_kl_reg_loss: 29430.5508; train_edge_recon_loss: 39218.7157; train_gene_expr_recon_loss: 699722.4167; train_masked_gp_l1_reg_loss: 6438.4851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104175.1944; train_chrom_access_recon_loss: 1327561.9028; train_global_loss: 2206547.2778; train_optim_loss: 2206547.2778; val_kl_reg_loss: 28450.0273; val_edge_recon_loss: 40604.1641; val_gene_expr_recon_loss: 687910.6250; val_masked_gp_l1_reg_loss: 6391.0908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99987.4844; val_chrom_access_recon_loss: 1340615.8750; val_global_loss: 2203959.2500; val_optim_loss: 2203959.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8430; val_auprc_score: 0.8423; val_best_acc_score: 0.5656; val_best_f1_score: 0.6927; train_kl_reg_loss: 28598.6810; train_edge_recon_loss: 39159.1120; train_gene_expr_recon_loss: 693450.0278; train_masked_gp_l1_reg_loss: 6369.7725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96806.7821; train_chrom_access_recon_loss: 1325899.5278; train_global_loss: 2190283.8889; train_optim_loss: 2190283.8889; val_kl_reg_loss: 28048.9258; val_edge_recon_loss: 40571.8047; val_gene_expr_recon_loss: 677871.0000; val_masked_gp_l1_reg_loss: 6338.5010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92935.7891; val_chrom_access_recon_loss: 1335811.3750; val_global_loss: 2181577.5000; val_optim_loss: 2181577.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8593; val_auprc_score: 0.8555; val_best_acc_score: 0.6012; val_best_f1_score: 0.7085; train_kl_reg_loss: 27891.0827; train_edge_recon_loss: 39160.5217; train_gene_expr_recon_loss: 682484.2847; train_masked_gp_l1_reg_loss: 6317.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90030.7170; train_chrom_access_recon_loss: 1319650.4861; train_global_loss: 2165534.4167; train_optim_loss: 2165534.4167; val_kl_reg_loss: 26436.6719; val_edge_recon_loss: 40520.7422; val_gene_expr_recon_loss: 671275.8750; val_masked_gp_l1_reg_loss: 6290.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86512.5781; val_chrom_access_recon_loss: 1331711.1250; val_global_loss: 2162747.0000; val_optim_loss: 2162747.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8513; val_auprc_score: 0.8462; val_best_acc_score: 0.6295; val_best_f1_score: 0.7222; train_kl_reg_loss: 27527.3390; train_edge_recon_loss: 39121.1181; train_gene_expr_recon_loss: 674333.0139; train_masked_gp_l1_reg_loss: 6278.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83898.2266; train_chrom_access_recon_loss: 1317286.1250; train_global_loss: 2148444.1944; train_optim_loss: 2148444.1944; val_kl_reg_loss: 26581.5840; val_edge_recon_loss: 40499.9609; val_gene_expr_recon_loss: 664561.7500; val_masked_gp_l1_reg_loss: 6258.2280; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80728.5234; val_chrom_access_recon_loss: 1326924.8750; val_global_loss: 2145555.0000; val_optim_loss: 2145555.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8437; val_auprc_score: 0.8433; val_best_acc_score: 0.6345; val_best_f1_score: 0.7231; train_kl_reg_loss: 26960.3895; train_edge_recon_loss: 39122.7804; train_gene_expr_recon_loss: 667017.3125; train_masked_gp_l1_reg_loss: 6247.2998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78366.2057; train_chrom_access_recon_loss: 1308327.0417; train_global_loss: 2126041.0417; train_optim_loss: 2126041.0417; val_kl_reg_loss: 27476.7734; val_edge_recon_loss: 40477.7266; val_gene_expr_recon_loss: 659782.3750; val_masked_gp_l1_reg_loss: 6233.2173; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75516.0469; val_chrom_access_recon_loss: 1322688.7500; val_global_loss: 2132175.0000; val_optim_loss: 2132175.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8353; val_auprc_score: 0.8345; val_best_acc_score: 0.6586; val_best_f1_score: 0.7339; train_kl_reg_loss: 26726.2923; train_edge_recon_loss: 39117.2044; train_gene_expr_recon_loss: 665717.6319; train_masked_gp_l1_reg_loss: 6226.5257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73390.1276; train_chrom_access_recon_loss: 1307315.3611; train_global_loss: 2118493.1389; train_optim_loss: 2118493.1389; val_kl_reg_loss: 25523.1426; val_edge_recon_loss: 40448.7383; val_gene_expr_recon_loss: 656606.6875; val_masked_gp_l1_reg_loss: 6214.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70824.4453; val_chrom_access_recon_loss: 1319345.1250; val_global_loss: 2118962.5000; val_optim_loss: 2118962.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8397; val_auprc_score: 0.8394; val_best_acc_score: 0.6955; val_best_f1_score: 0.7529; train_kl_reg_loss: 26335.5401; train_edge_recon_loss: 39106.5221; train_gene_expr_recon_loss: 660828.7153; train_masked_gp_l1_reg_loss: 6210.8967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68906.6589; train_chrom_access_recon_loss: 1299903.8333; train_global_loss: 2101292.1667; train_optim_loss: 2101292.1667; val_kl_reg_loss: 24897.6016; val_edge_recon_loss: 40406.1484; val_gene_expr_recon_loss: 653474.9375; val_masked_gp_l1_reg_loss: 6197.8955; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66571.4375; val_chrom_access_recon_loss: 1316405.7500; val_global_loss: 2107953.7500; val_optim_loss: 2107953.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8488; val_auprc_score: 0.8508; val_best_acc_score: 0.7278; val_best_f1_score: 0.7691; train_kl_reg_loss: 25952.0371; train_edge_recon_loss: 39082.8859; train_gene_expr_recon_loss: 658246.3125; train_masked_gp_l1_reg_loss: 6197.4520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64825.4891; train_chrom_access_recon_loss: 1296846.5694; train_global_loss: 2091150.7500; train_optim_loss: 2091150.7500; val_kl_reg_loss: 24234.0820; val_edge_recon_loss: 40377.5547; val_gene_expr_recon_loss: 650628.6250; val_masked_gp_l1_reg_loss: 6185.1982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62694.2500; val_chrom_access_recon_loss: 1314044.0000; val_global_loss: 2098163.7500; val_optim_loss: 2098163.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8530; val_auprc_score: 0.8544; val_best_acc_score: 0.7424; val_best_f1_score: 0.7767; train_kl_reg_loss: 25711.3175; train_edge_recon_loss: 39068.6076; train_gene_expr_recon_loss: 657740.0208; train_masked_gp_l1_reg_loss: 6181.9264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61094.1458; train_chrom_access_recon_loss: 1299728.1389; train_global_loss: 2089524.1250; train_optim_loss: 2089524.1250; val_kl_reg_loss: 24281.6055; val_edge_recon_loss: 40335.6953; val_gene_expr_recon_loss: 647467.7500; val_masked_gp_l1_reg_loss: 6172.2407; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59140.2031; val_chrom_access_recon_loss: 1311123.2500; val_global_loss: 2088520.7500; val_optim_loss: 2088520.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8578; val_auprc_score: 0.8569; val_best_acc_score: 0.7654; val_best_f1_score: 0.7894; train_kl_reg_loss: 25291.4731; train_edge_recon_loss: 39059.5820; train_gene_expr_recon_loss: 653237.4861; train_masked_gp_l1_reg_loss: 6172.5033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57669.3329; train_chrom_access_recon_loss: 1296803.2778; train_global_loss: 2078233.6667; train_optim_loss: 2078233.6667; val_kl_reg_loss: 22779.2422; val_edge_recon_loss: 40315.8203; val_gene_expr_recon_loss: 646964.9375; val_masked_gp_l1_reg_loss: 6162.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55864.7305; val_chrom_access_recon_loss: 1309511.7500; val_global_loss: 2081598.7500; val_optim_loss: 2081598.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8681; val_auprc_score: 0.8697; val_best_acc_score: 0.7745; val_best_f1_score: 0.7951; train_kl_reg_loss: 24764.9117; train_edge_recon_loss: 39015.9032; train_gene_expr_recon_loss: 651740.4722; train_masked_gp_l1_reg_loss: 6161.2133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54513.6029; train_chrom_access_recon_loss: 1293858.8333; train_global_loss: 2070054.9583; train_optim_loss: 2070054.9583; val_kl_reg_loss: 22737.2305; val_edge_recon_loss: 40284.8281; val_gene_expr_recon_loss: 644505.1250; val_masked_gp_l1_reg_loss: 6157.8105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52860.5078; val_chrom_access_recon_loss: 1306692.6250; val_global_loss: 2073238.1250; val_optim_loss: 2073238.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8788; val_auprc_score: 0.8769; val_best_acc_score: 0.7998; val_best_f1_score: 0.8110; train_kl_reg_loss: 24389.3635; train_edge_recon_loss: 38994.8581; train_gene_expr_recon_loss: 648213.3264; train_masked_gp_l1_reg_loss: 6159.9003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51617.3299; train_chrom_access_recon_loss: 1292447.0417; train_global_loss: 2061821.8194; train_optim_loss: 2061821.8194; val_kl_reg_loss: 22127.8320; val_edge_recon_loss: 40242.9180; val_gene_expr_recon_loss: 643476.7500; val_masked_gp_l1_reg_loss: 6160.0679; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50083.1211; val_chrom_access_recon_loss: 1304933.5000; val_global_loss: 2067024.2500; val_optim_loss: 2067024.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8920; val_auprc_score: 0.8908; val_best_acc_score: 0.8172; val_best_f1_score: 0.8222; train_kl_reg_loss: 24042.8904; train_edge_recon_loss: 38952.4288; train_gene_expr_recon_loss: 644977.8819; train_masked_gp_l1_reg_loss: 6160.9421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48933.1628; train_chrom_access_recon_loss: 1283757.9028; train_global_loss: 2046825.1944; train_optim_loss: 2046825.1944; val_kl_reg_loss: 21739.3887; val_edge_recon_loss: 40188.7578; val_gene_expr_recon_loss: 641946.6250; val_masked_gp_l1_reg_loss: 6152.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47518.4023; val_chrom_access_recon_loss: 1302901.1250; val_global_loss: 2060447.2500; val_optim_loss: 2060447.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8945; val_auprc_score: 0.8916; val_best_acc_score: 0.8199; val_best_f1_score: 0.8236; train_kl_reg_loss: 23815.7457; train_edge_recon_loss: 38914.6992; train_gene_expr_recon_loss: 645877.7986; train_masked_gp_l1_reg_loss: 6161.7352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46454.0924; train_chrom_access_recon_loss: 1289427.1528; train_global_loss: 2050651.2222; train_optim_loss: 2050651.2222; val_kl_reg_loss: 22212.5273; val_edge_recon_loss: 40162.0625; val_gene_expr_recon_loss: 639397.0000; val_masked_gp_l1_reg_loss: 6162.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45136.3867; val_chrom_access_recon_loss: 1300898.2500; val_global_loss: 2053968.7500; val_optim_loss: 2053968.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9015; val_auprc_score: 0.8961; val_best_acc_score: 0.8310; val_best_f1_score: 0.8298; train_kl_reg_loss: 23560.5217; train_edge_recon_loss: 38886.4284; train_gene_expr_recon_loss: 644222.8681; train_masked_gp_l1_reg_loss: 6165.0608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44149.8772; train_chrom_access_recon_loss: 1282146.8750; train_global_loss: 2039131.6389; train_optim_loss: 2039131.6389; val_kl_reg_loss: 21598.2461; val_edge_recon_loss: 40089.3594; val_gene_expr_recon_loss: 638606.1250; val_masked_gp_l1_reg_loss: 6164.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42925.1094; val_chrom_access_recon_loss: 1298492.8750; val_global_loss: 2047876.2500; val_optim_loss: 2047876.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9016; val_auprc_score: 0.8924; val_best_acc_score: 0.8282; val_best_f1_score: 0.8267; train_kl_reg_loss: 23120.6842; train_edge_recon_loss: 38826.7834; train_gene_expr_recon_loss: 643508.6181; train_masked_gp_l1_reg_loss: 6169.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42009.6623; train_chrom_access_recon_loss: 1284752.7222; train_global_loss: 2038388.3472; train_optim_loss: 2038388.3472; val_kl_reg_loss: 21887.7109; val_edge_recon_loss: 40095.2656; val_gene_expr_recon_loss: 636274.0000; val_masked_gp_l1_reg_loss: 6168.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40876.8672; val_chrom_access_recon_loss: 1298966.0000; val_global_loss: 2044268.7500; val_optim_loss: 2044268.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9065; val_auprc_score: 0.8990; val_best_acc_score: 0.8296; val_best_f1_score: 0.8235; train_kl_reg_loss: 22713.8485; train_edge_recon_loss: 38749.9401; train_gene_expr_recon_loss: 643657.9167; train_masked_gp_l1_reg_loss: 6182.9864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40022.1419; train_chrom_access_recon_loss: 1287612.2778; train_global_loss: 2038939.0972; train_optim_loss: 2038939.0972; val_kl_reg_loss: 21670.6543; val_edge_recon_loss: 39999.1055; val_gene_expr_recon_loss: 634917.6250; val_masked_gp_l1_reg_loss: 6193.6650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38958.8164; val_chrom_access_recon_loss: 1297241.1250; val_global_loss: 2038981.0000; val_optim_loss: 2038981.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9004; val_auprc_score: 0.8911; val_best_acc_score: 0.8274; val_best_f1_score: 0.8295; train_kl_reg_loss: 19842.6795; train_edge_recon_loss: 39760.0000; train_gene_expr_recon_loss: 898478.8403; train_masked_gp_l1_reg_loss: 6328.1148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38018.1354; train_chrom_access_recon_loss: 1349449.6111; train_global_loss: 2351877.3333; train_optim_loss: 2351877.3333; val_kl_reg_loss: 17985.4941; val_edge_recon_loss: 40154.6289; val_gene_expr_recon_loss: 888453.1250; val_masked_gp_l1_reg_loss: 6573.5688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36752.7461; val_chrom_access_recon_loss: 1366592.1250; val_global_loss: 2356511.7500; val_optim_loss: 2356511.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9041; val_auprc_score: 0.8912; val_best_acc_score: 0.8323; val_best_f1_score: 0.8308; train_kl_reg_loss: 19381.4794; train_edge_recon_loss: 39776.5109; train_gene_expr_recon_loss: 888466.1944; train_masked_gp_l1_reg_loss: 6759.9635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35710.0148; train_chrom_access_recon_loss: 1344093.9583; train_global_loss: 2334188.1389; train_optim_loss: 2334188.1389; val_kl_reg_loss: 16915.6113; val_edge_recon_loss: 40085.4414; val_gene_expr_recon_loss: 882835.5625; val_masked_gp_l1_reg_loss: 6965.5801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34430.0078; val_chrom_access_recon_loss: 1365087.1250; val_global_loss: 2346319.2500; val_optim_loss: 2346319.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9137; val_auprc_score: 0.9047; val_best_acc_score: 0.8385; val_best_f1_score: 0.8356; train_kl_reg_loss: 19111.8349; train_edge_recon_loss: 39757.9115; train_gene_expr_recon_loss: 892260.6597; train_masked_gp_l1_reg_loss: 7100.6152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33460.0757; train_chrom_access_recon_loss: 1349666.8472; train_global_loss: 2341357.9444; train_optim_loss: 2341357.9444; val_kl_reg_loss: 17325.9375; val_edge_recon_loss: 40066.1797; val_gene_expr_recon_loss: 877699.3750; val_masked_gp_l1_reg_loss: 7249.0225; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32283.9043; val_chrom_access_recon_loss: 1362869.0000; val_global_loss: 2337493.5000; val_optim_loss: 2337493.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9138; val_auprc_score: 0.9069; val_best_acc_score: 0.8360; val_best_f1_score: 0.8309; train_kl_reg_loss: 19104.5074; train_edge_recon_loss: 39751.7109; train_gene_expr_recon_loss: 885550.5486; train_masked_gp_l1_reg_loss: 7347.8219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31405.4108; train_chrom_access_recon_loss: 1349146.4306; train_global_loss: 2332306.4722; train_optim_loss: 2332306.4722; val_kl_reg_loss: 17146.1406; val_edge_recon_loss: 40036.9062; val_gene_expr_recon_loss: 874055.0000; val_masked_gp_l1_reg_loss: 7456.9854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30343.8496; val_chrom_access_recon_loss: 1360626.5000; val_global_loss: 2329665.5000; val_optim_loss: 2329665.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9226; val_auprc_score: 0.9114; val_best_acc_score: 0.8460; val_best_f1_score: 0.8430; train_kl_reg_loss: 18994.2474; train_edge_recon_loss: 39726.3073; train_gene_expr_recon_loss: 881672.7917; train_masked_gp_l1_reg_loss: 7436.3302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30177.0618; train_chrom_access_recon_loss: 1347599.9306; train_global_loss: 2325606.6111; train_optim_loss: 2325606.6111; val_kl_reg_loss: 18254.2734; val_edge_recon_loss: 40066.6953; val_gene_expr_recon_loss: 872523.8750; val_masked_gp_l1_reg_loss: 7418.3794; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29992.2578; val_chrom_access_recon_loss: 1359947.5000; val_global_loss: 2328203.0000; val_optim_loss: 2328203.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9167; val_auprc_score: 0.9054; val_best_acc_score: 0.8402; val_best_f1_score: 0.8353; train_kl_reg_loss: 18870.5881; train_edge_recon_loss: 39722.0269; train_gene_expr_recon_loss: 881684.9028; train_masked_gp_l1_reg_loss: 7414.8899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29882.7828; train_chrom_access_recon_loss: 1348882.4861; train_global_loss: 2326457.6944; train_optim_loss: 2326457.6944; val_kl_reg_loss: 17321.8281; val_edge_recon_loss: 40044.0000; val_gene_expr_recon_loss: 872757.3750; val_masked_gp_l1_reg_loss: 7409.0571; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29740.8379; val_chrom_access_recon_loss: 1360033.0000; val_global_loss: 2327306.0000; val_optim_loss: 2327306.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9141; val_auprc_score: 0.9026; val_best_acc_score: 0.8355; val_best_f1_score: 0.8323; train_kl_reg_loss: 18917.6517; train_edge_recon_loss: 39722.9991; train_gene_expr_recon_loss: 876538.4097; train_masked_gp_l1_reg_loss: 7408.1548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29638.0247; train_chrom_access_recon_loss: 1336522.8333; train_global_loss: 2308748.0833; train_optim_loss: 2308748.0833; val_kl_reg_loss: 17829.9062; val_edge_recon_loss: 40060.2266; val_gene_expr_recon_loss: 871993.0000; val_masked_gp_l1_reg_loss: 7407.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29512.4707; val_chrom_access_recon_loss: 1359487.2500; val_global_loss: 2326290.0000; val_optim_loss: 2326290.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9178; val_auprc_score: 0.9082; val_best_acc_score: 0.8407; val_best_f1_score: 0.8360; train_kl_reg_loss: 18859.3741; train_edge_recon_loss: 39708.4201; train_gene_expr_recon_loss: 881005.3889; train_masked_gp_l1_reg_loss: 7407.1562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29416.7582; train_chrom_access_recon_loss: 1339418.7500; train_global_loss: 2315815.8056; train_optim_loss: 2315815.8056; val_kl_reg_loss: 17703.3086; val_edge_recon_loss: 40038.9453; val_gene_expr_recon_loss: 871803.8750; val_masked_gp_l1_reg_loss: 7408.6724; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29301.8770; val_chrom_access_recon_loss: 1359492.7500; val_global_loss: 2325749.5000; val_optim_loss: 2325749.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 14 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9027
val AUPRC score: 0.8942
val best accuracy score: 0.8290
val best F1 score: 0.8356
val target rna MSE score: 3.8834
val source rna MSE score: 3.1208
val target atac MSE score: 0.1379
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
