Run timestamp: 20062023_155329_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '20', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 20, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 20, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9271; val_auprc_score: 0.9902; val_best_acc_score: 0.9689; val_best_f1_score: 0.9833; train_kl_reg_loss: 4404.7343; train_edge_recon_loss: 43928.2919; train_cond_contrastive_loss: 32549.2368; train_gene_expr_recon_loss: 116282.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197164.6712; train_optim_loss: 197164.6712; val_kl_reg_loss: 3952.4862; val_edge_recon_loss: 40831.7443; val_cond_contrastive_loss: 31974.9807; val_gene_expr_recon_loss: 104598.3549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181357.5664; val_optim_loss: 181357.5664
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9263; val_auprc_score: 0.9897; val_best_acc_score: 0.9690; val_best_f1_score: 0.9834; train_kl_reg_loss: 4285.5698; train_edge_recon_loss: 40926.1965; train_cond_contrastive_loss: 32361.1597; train_gene_expr_recon_loss: 102001.2012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179574.1272; train_optim_loss: 179574.1272; val_kl_reg_loss: 4328.7067; val_edge_recon_loss: 40765.1082; val_cond_contrastive_loss: 32101.8797; val_gene_expr_recon_loss: 98955.4352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176151.1304; val_optim_loss: 176151.1304
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9239; val_auprc_score: 0.9889; val_best_acc_score: 0.9710; val_best_f1_score: 0.9844; train_kl_reg_loss: 4514.0921; train_edge_recon_loss: 40821.2830; train_cond_contrastive_loss: 32452.3643; train_gene_expr_recon_loss: 97658.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175445.9837; train_optim_loss: 175445.9837; val_kl_reg_loss: 4610.0608; val_edge_recon_loss: 41213.4091; val_cond_contrastive_loss: 32113.1129; val_gene_expr_recon_loss: 95698.8699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173635.4514; val_optim_loss: 173635.4514
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9291; val_auprc_score: 0.9899; val_best_acc_score: 0.9701; val_best_f1_score: 0.9840; train_kl_reg_loss: 4669.0398; train_edge_recon_loss: 40663.4784; train_cond_contrastive_loss: 32486.4208; train_gene_expr_recon_loss: 95163.3525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172982.2914; train_optim_loss: 172982.2914; val_kl_reg_loss: 4436.7797; val_edge_recon_loss: 40908.6313; val_cond_contrastive_loss: 32293.6921; val_gene_expr_recon_loss: 93758.2556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171397.3594; val_optim_loss: 171397.3594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9282; val_auprc_score: 0.9895; val_best_acc_score: 0.9704; val_best_f1_score: 0.9841; train_kl_reg_loss: 4771.7548; train_edge_recon_loss: 40387.4570; train_cond_contrastive_loss: 32487.1742; train_gene_expr_recon_loss: 93611.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171258.0076; train_optim_loss: 171258.0076; val_kl_reg_loss: 4685.3876; val_edge_recon_loss: 41231.0910; val_cond_contrastive_loss: 32291.7779; val_gene_expr_recon_loss: 92478.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170687.0435; val_optim_loss: 170687.0435
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9306; val_auprc_score: 0.9899; val_best_acc_score: 0.9701; val_best_f1_score: 0.9840; train_kl_reg_loss: 4850.9720; train_edge_recon_loss: 40525.4825; train_cond_contrastive_loss: 32480.3880; train_gene_expr_recon_loss: 92540.7712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170397.6140; train_optim_loss: 170397.6140; val_kl_reg_loss: 4865.7042; val_edge_recon_loss: 40705.3939; val_cond_contrastive_loss: 32299.3732; val_gene_expr_recon_loss: 91634.8595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169505.3328; val_optim_loss: 169505.3328
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9290; val_auprc_score: 0.9895; val_best_acc_score: 0.9707; val_best_f1_score: 0.9843; train_kl_reg_loss: 4918.5035; train_edge_recon_loss: 40425.4397; train_cond_contrastive_loss: 32469.1748; train_gene_expr_recon_loss: 91744.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169557.8863; train_optim_loss: 169557.8863; val_kl_reg_loss: 4760.9706; val_edge_recon_loss: 40822.4401; val_cond_contrastive_loss: 32368.2282; val_gene_expr_recon_loss: 90955.0413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168906.6797; val_optim_loss: 168906.6797
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9287; val_auprc_score: 0.9897; val_best_acc_score: 0.9701; val_best_f1_score: 0.9840; train_kl_reg_loss: 4972.6821; train_edge_recon_loss: 40480.8901; train_cond_contrastive_loss: 32455.3955; train_gene_expr_recon_loss: 91151.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169060.4976; train_optim_loss: 169060.4976; val_kl_reg_loss: 4900.7761; val_edge_recon_loss: 40645.9557; val_cond_contrastive_loss: 32232.4230; val_gene_expr_recon_loss: 90405.7821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168184.9373; val_optim_loss: 168184.9373
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9321; val_auprc_score: 0.9900; val_best_acc_score: 0.9711; val_best_f1_score: 0.9845; train_kl_reg_loss: 5004.6063; train_edge_recon_loss: 40305.4788; train_cond_contrastive_loss: 32436.9444; train_gene_expr_recon_loss: 90704.8865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168451.9163; train_optim_loss: 168451.9163; val_kl_reg_loss: 4807.7946; val_edge_recon_loss: 40713.8425; val_cond_contrastive_loss: 32228.2186; val_gene_expr_recon_loss: 90063.9513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167813.8066; val_optim_loss: 167813.8066
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9332; val_auprc_score: 0.9902; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 5034.8098; train_edge_recon_loss: 40360.3160; train_cond_contrastive_loss: 32425.3317; train_gene_expr_recon_loss: 90337.1118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168157.5694; train_optim_loss: 168157.5694; val_kl_reg_loss: 4880.0484; val_edge_recon_loss: 40787.1669; val_cond_contrastive_loss: 32172.4597; val_gene_expr_recon_loss: 89702.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167541.9592; val_optim_loss: 167541.9592
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9336; val_auprc_score: 0.9903; val_best_acc_score: 0.9731; val_best_f1_score: 0.9856; train_kl_reg_loss: 5067.4431; train_edge_recon_loss: 40181.4908; train_cond_contrastive_loss: 32412.7787; train_gene_expr_recon_loss: 90031.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167692.9523; train_optim_loss: 167692.9523; val_kl_reg_loss: 4902.6406; val_edge_recon_loss: 40668.2164; val_cond_contrastive_loss: 32213.4607; val_gene_expr_recon_loss: 89449.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167233.4692; val_optim_loss: 167233.4692
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9349; val_auprc_score: 0.9905; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 5090.0972; train_edge_recon_loss: 40288.2933; train_cond_contrastive_loss: 32401.4659; train_gene_expr_recon_loss: 89792.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167571.8673; train_optim_loss: 167571.8673; val_kl_reg_loss: 4888.8631; val_edge_recon_loss: 40470.8289; val_cond_contrastive_loss: 32250.7077; val_gene_expr_recon_loss: 89281.3350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166891.7339; val_optim_loss: 166891.7339
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9344; val_auprc_score: 0.9903; val_best_acc_score: 0.9731; val_best_f1_score: 0.9855; train_kl_reg_loss: 5111.3899; train_edge_recon_loss: 40324.1052; train_cond_contrastive_loss: 32388.6255; train_gene_expr_recon_loss: 89608.2787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167432.3989; train_optim_loss: 167432.3989; val_kl_reg_loss: 5116.1331; val_edge_recon_loss: 40735.8752; val_cond_contrastive_loss: 32149.7921; val_gene_expr_recon_loss: 89056.9354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167058.7351; val_optim_loss: 167058.7351
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9356; val_auprc_score: 0.9903; val_best_acc_score: 0.9739; val_best_f1_score: 0.9860; train_kl_reg_loss: 5127.3219; train_edge_recon_loss: 40198.0121; train_cond_contrastive_loss: 32379.2480; train_gene_expr_recon_loss: 89398.8613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167103.4433; train_optim_loss: 167103.4433; val_kl_reg_loss: 5045.0210; val_edge_recon_loss: 40730.8676; val_cond_contrastive_loss: 32115.7230; val_gene_expr_recon_loss: 88862.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166754.1155; val_optim_loss: 166754.1155
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9345; val_auprc_score: 0.9902; val_best_acc_score: 0.9740; val_best_f1_score: 0.9860; train_kl_reg_loss: 5142.1577; train_edge_recon_loss: 40333.0564; train_cond_contrastive_loss: 32367.1169; train_gene_expr_recon_loss: 89238.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167080.4332; train_optim_loss: 167080.4332; val_kl_reg_loss: 5053.9372; val_edge_recon_loss: 40591.8406; val_cond_contrastive_loss: 32090.4692; val_gene_expr_recon_loss: 88777.7810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166514.0288; val_optim_loss: 166514.0288
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9354; val_auprc_score: 0.9902; val_best_acc_score: 0.9734; val_best_f1_score: 0.9857; train_kl_reg_loss: 5152.6181; train_edge_recon_loss: 40300.5180; train_cond_contrastive_loss: 32353.2647; train_gene_expr_recon_loss: 89117.8925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166924.2935; train_optim_loss: 166924.2935; val_kl_reg_loss: 5010.0006; val_edge_recon_loss: 40967.1074; val_cond_contrastive_loss: 32172.6489; val_gene_expr_recon_loss: 88644.4331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166794.1902; val_optim_loss: 166794.1902
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9361; val_auprc_score: 0.9904; val_best_acc_score: 0.9742; val_best_f1_score: 0.9862; train_kl_reg_loss: 5163.9042; train_edge_recon_loss: 40241.1580; train_cond_contrastive_loss: 32344.4292; train_gene_expr_recon_loss: 89039.9665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166789.4579; train_optim_loss: 166789.4579; val_kl_reg_loss: 5141.0212; val_edge_recon_loss: 40624.2879; val_cond_contrastive_loss: 32108.6504; val_gene_expr_recon_loss: 88540.2141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166414.1736; val_optim_loss: 166414.1736
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9373; val_auprc_score: 0.9906; val_best_acc_score: 0.9729; val_best_f1_score: 0.9854; train_kl_reg_loss: 5176.2615; train_edge_recon_loss: 40068.7006; train_cond_contrastive_loss: 32330.8654; train_gene_expr_recon_loss: 88911.5916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166487.4185; train_optim_loss: 166487.4185; val_kl_reg_loss: 5038.5208; val_edge_recon_loss: 40919.7421; val_cond_contrastive_loss: 32153.5082; val_gene_expr_recon_loss: 88364.3507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166476.1221; val_optim_loss: 166476.1221
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9367; val_auprc_score: 0.9903; val_best_acc_score: 0.9745; val_best_f1_score: 0.9863; train_kl_reg_loss: 5182.2031; train_edge_recon_loss: 40270.5382; train_cond_contrastive_loss: 32328.0057; train_gene_expr_recon_loss: 88817.3863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166598.1336; train_optim_loss: 166598.1336; val_kl_reg_loss: 5218.1117; val_edge_recon_loss: 40451.5403; val_cond_contrastive_loss: 32058.4463; val_gene_expr_recon_loss: 88443.7258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166171.8252; val_optim_loss: 166171.8252
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9378; val_auprc_score: 0.9907; val_best_acc_score: 0.9744; val_best_f1_score: 0.9862; train_kl_reg_loss: 5187.3002; train_edge_recon_loss: 40167.3256; train_cond_contrastive_loss: 32314.7435; train_gene_expr_recon_loss: 88767.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166437.1036; train_optim_loss: 166437.1036; val_kl_reg_loss: 5089.7186; val_edge_recon_loss: 40560.1988; val_cond_contrastive_loss: 32105.5139; val_gene_expr_recon_loss: 88374.2926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166129.7246; val_optim_loss: 166129.7246
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9381; val_auprc_score: 0.9908; val_best_acc_score: 0.9746; val_best_f1_score: 0.9863; train_kl_reg_loss: 5191.8986; train_edge_recon_loss: 40113.0632; train_cond_contrastive_loss: 32307.4859; train_gene_expr_recon_loss: 88681.3006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166293.7483; train_optim_loss: 166293.7483; val_kl_reg_loss: 5130.6228; val_edge_recon_loss: 40059.6279; val_cond_contrastive_loss: 32079.7394; val_gene_expr_recon_loss: 88300.8989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165570.8884; val_optim_loss: 165570.8884
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9413; val_auprc_score: 0.9913; val_best_acc_score: 0.9753; val_best_f1_score: 0.9867; train_kl_reg_loss: 5198.7347; train_edge_recon_loss: 40029.2671; train_cond_contrastive_loss: 32299.4256; train_gene_expr_recon_loss: 88638.9764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166166.4034; train_optim_loss: 166166.4034; val_kl_reg_loss: 5161.6204; val_edge_recon_loss: 40368.8422; val_cond_contrastive_loss: 32072.6631; val_gene_expr_recon_loss: 88296.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165899.2883; val_optim_loss: 165899.2883
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9413; val_auprc_score: 0.9910; val_best_acc_score: 0.9749; val_best_f1_score: 0.9865; train_kl_reg_loss: 5202.0277; train_edge_recon_loss: 39974.1044; train_cond_contrastive_loss: 32295.1885; train_gene_expr_recon_loss: 88582.9988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166054.3198; train_optim_loss: 166054.3198; val_kl_reg_loss: 5086.4882; val_edge_recon_loss: 40416.9497; val_cond_contrastive_loss: 32071.5054; val_gene_expr_recon_loss: 88260.4166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165835.3591; val_optim_loss: 165835.3591
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9389; val_auprc_score: 0.9908; val_best_acc_score: 0.9749; val_best_f1_score: 0.9865; train_kl_reg_loss: 5206.2202; train_edge_recon_loss: 40046.3620; train_cond_contrastive_loss: 32284.2830; train_gene_expr_recon_loss: 88544.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 166081.3132; train_optim_loss: 166081.3132; val_kl_reg_loss: 5234.4570; val_edge_recon_loss: 40833.7418; val_cond_contrastive_loss: 32007.4286; val_gene_expr_recon_loss: 88147.6686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166223.2959; val_optim_loss: 166223.2959

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9408; val_auprc_score: 0.9910; val_best_acc_score: 0.9749; val_best_f1_score: 0.9865; train_kl_reg_loss: 5165.5172; train_edge_recon_loss: 39790.0635; train_cond_contrastive_loss: 32289.8021; train_gene_expr_recon_loss: 88122.5697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165367.9527; train_optim_loss: 165367.9527; val_kl_reg_loss: 5050.1553; val_edge_recon_loss: 40390.8854; val_cond_contrastive_loss: 32110.2512; val_gene_expr_recon_loss: 87922.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165473.6875; val_optim_loss: 165473.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9414; val_auprc_score: 0.9911; val_best_acc_score: 0.9763; val_best_f1_score: 0.9873; train_kl_reg_loss: 5197.2832; train_edge_recon_loss: 40018.7169; train_cond_contrastive_loss: 32448.0674; train_gene_expr_recon_loss: 88042.1147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165706.1823; train_optim_loss: 165706.1823; val_kl_reg_loss: 4778.6696; val_edge_recon_loss: 40688.9297; val_cond_contrastive_loss: 32166.5991; val_gene_expr_recon_loss: 87807.0120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165441.2100; val_optim_loss: 165441.2100
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9442; val_auprc_score: 0.9913; val_best_acc_score: 0.9759; val_best_f1_score: 0.9870; train_kl_reg_loss: 5057.7400; train_edge_recon_loss: 39974.6020; train_cond_contrastive_loss: 32328.5305; train_gene_expr_recon_loss: 88010.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165371.6275; train_optim_loss: 165371.6275; val_kl_reg_loss: 4806.4104; val_edge_recon_loss: 40800.2424; val_cond_contrastive_loss: 32164.0520; val_gene_expr_recon_loss: 87789.2673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165559.9729; val_optim_loss: 165559.9729
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9401; val_auprc_score: 0.9909; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 5045.5678; train_edge_recon_loss: 40115.3989; train_cond_contrastive_loss: 32296.7146; train_gene_expr_recon_loss: 88018.4481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165476.1294; train_optim_loss: 165476.1294; val_kl_reg_loss: 4846.1454; val_edge_recon_loss: 40362.3257; val_cond_contrastive_loss: 32122.4904; val_gene_expr_recon_loss: 87856.3745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165187.3362; val_optim_loss: 165187.3362
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9445; val_auprc_score: 0.9916; val_best_acc_score: 0.9757; val_best_f1_score: 0.9869; train_kl_reg_loss: 5035.1616; train_edge_recon_loss: 39964.4555; train_cond_contrastive_loss: 32285.9524; train_gene_expr_recon_loss: 88015.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165301.1647; train_optim_loss: 165301.1647; val_kl_reg_loss: 4859.2609; val_edge_recon_loss: 40568.0153; val_cond_contrastive_loss: 32119.0917; val_gene_expr_recon_loss: 87731.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165277.9543; val_optim_loss: 165277.9543
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9426; val_auprc_score: 0.9912; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 5024.4779; train_edge_recon_loss: 39964.8027; train_cond_contrastive_loss: 32278.4813; train_gene_expr_recon_loss: 87988.1514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165255.9134; train_optim_loss: 165255.9134; val_kl_reg_loss: 4827.2054; val_edge_recon_loss: 40536.4279; val_cond_contrastive_loss: 32113.1122; val_gene_expr_recon_loss: 87781.9574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165258.7031; val_optim_loss: 165258.7031
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9405; val_auprc_score: 0.9910; val_best_acc_score: 0.9750; val_best_f1_score: 0.9865; train_kl_reg_loss: 5014.9551; train_edge_recon_loss: 39824.5556; train_cond_contrastive_loss: 32278.1359; train_gene_expr_recon_loss: 87991.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165109.0792; train_optim_loss: 165109.0792; val_kl_reg_loss: 4842.6909; val_edge_recon_loss: 40593.3806; val_cond_contrastive_loss: 32150.4060; val_gene_expr_recon_loss: 87689.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165275.5564; val_optim_loss: 165275.5564

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9421; val_auprc_score: 0.9911; val_best_acc_score: 0.9759; val_best_f1_score: 0.9871; train_kl_reg_loss: 5008.4710; train_edge_recon_loss: 39873.6083; train_cond_contrastive_loss: 32274.2035; train_gene_expr_recon_loss: 87907.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165063.7481; train_optim_loss: 165063.7481; val_kl_reg_loss: 4869.6954; val_edge_recon_loss: 40395.4684; val_cond_contrastive_loss: 32101.2899; val_gene_expr_recon_loss: 87708.3772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165074.8323; val_optim_loss: 165074.8323
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9395; val_auprc_score: 0.9909; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 5011.9815; train_edge_recon_loss: 39866.3971; train_cond_contrastive_loss: 32270.5217; train_gene_expr_recon_loss: 87935.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165084.4701; train_optim_loss: 165084.4701; val_kl_reg_loss: 4877.3263; val_edge_recon_loss: 40525.2493; val_cond_contrastive_loss: 32088.6219; val_gene_expr_recon_loss: 87748.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165239.5330; val_optim_loss: 165239.5330
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9412; val_auprc_score: 0.9911; val_best_acc_score: 0.9757; val_best_f1_score: 0.9869; train_kl_reg_loss: 5013.8482; train_edge_recon_loss: 40059.8825; train_cond_contrastive_loss: 32269.6671; train_gene_expr_recon_loss: 87926.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165269.5893; train_optim_loss: 165269.5893; val_kl_reg_loss: 4884.4803; val_edge_recon_loss: 40225.8737; val_cond_contrastive_loss: 32091.8196; val_gene_expr_recon_loss: 87771.7980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164973.9714; val_optim_loss: 164973.9714
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9402; val_auprc_score: 0.9909; val_best_acc_score: 0.9754; val_best_f1_score: 0.9868; train_kl_reg_loss: 5007.2180; train_edge_recon_loss: 39952.3119; train_cond_contrastive_loss: 32275.6755; train_gene_expr_recon_loss: 87882.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165117.6563; train_optim_loss: 165117.6563; val_kl_reg_loss: 4867.6463; val_edge_recon_loss: 40640.3038; val_cond_contrastive_loss: 32106.3301; val_gene_expr_recon_loss: 87723.6636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165337.9436; val_optim_loss: 165337.9436
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9411; val_auprc_score: 0.9910; val_best_acc_score: 0.9756; val_best_f1_score: 0.9869; train_kl_reg_loss: 5007.7958; train_edge_recon_loss: 39946.1237; train_cond_contrastive_loss: 32267.9050; train_gene_expr_recon_loss: 87906.9174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165128.7417; train_optim_loss: 165128.7417; val_kl_reg_loss: 4877.5009; val_edge_recon_loss: 40417.9492; val_cond_contrastive_loss: 32078.4857; val_gene_expr_recon_loss: 87675.9706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165049.9060; val_optim_loss: 165049.9060
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9416; val_auprc_score: 0.9909; val_best_acc_score: 0.9755; val_best_f1_score: 0.9868; train_kl_reg_loss: 5003.6333; train_edge_recon_loss: 39926.8956; train_cond_contrastive_loss: 32268.0816; train_gene_expr_recon_loss: 87917.9376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165116.5483; train_optim_loss: 165116.5483; val_kl_reg_loss: 4871.9278; val_edge_recon_loss: 40775.0912; val_cond_contrastive_loss: 32090.5941; val_gene_expr_recon_loss: 87699.9298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165437.5435; val_optim_loss: 165437.5435

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9430; val_auprc_score: 0.9912; val_best_acc_score: 0.9756; val_best_f1_score: 0.9869; train_kl_reg_loss: 5000.6308; train_edge_recon_loss: 39930.3063; train_cond_contrastive_loss: 32275.0807; train_gene_expr_recon_loss: 87902.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165108.1538; train_optim_loss: 165108.1538; val_kl_reg_loss: 4871.9093; val_edge_recon_loss: 40530.7054; val_cond_contrastive_loss: 32088.9639; val_gene_expr_recon_loss: 87791.0824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165282.6602; val_optim_loss: 165282.6602
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9407; val_auprc_score: 0.9908; val_best_acc_score: 0.9755; val_best_f1_score: 0.9869; train_kl_reg_loss: 5000.7857; train_edge_recon_loss: 39869.8458; train_cond_contrastive_loss: 32274.3899; train_gene_expr_recon_loss: 87909.4778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165054.4990; train_optim_loss: 165054.4990; val_kl_reg_loss: 4874.8990; val_edge_recon_loss: 40472.2585; val_cond_contrastive_loss: 32099.2209; val_gene_expr_recon_loss: 87674.2136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165120.5913; val_optim_loss: 165120.5913
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9418; val_auprc_score: 0.9910; val_best_acc_score: 0.9753; val_best_f1_score: 0.9867; train_kl_reg_loss: 5003.1874; train_edge_recon_loss: 40083.5146; train_cond_contrastive_loss: 32271.1160; train_gene_expr_recon_loss: 87893.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 165251.6853; train_optim_loss: 165251.6853; val_kl_reg_loss: 4876.4694; val_edge_recon_loss: 40861.2046; val_cond_contrastive_loss: 32093.3368; val_gene_expr_recon_loss: 87704.3060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165535.3176; val_optim_loss: 165535.3176
