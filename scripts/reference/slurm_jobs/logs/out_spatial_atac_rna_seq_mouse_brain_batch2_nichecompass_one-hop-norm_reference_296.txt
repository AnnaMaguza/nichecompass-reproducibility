[True]
Run timestamp: 07092023_072425_296.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_296']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 22333 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 25929, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6840; val_auprc_score: 0.6696; val_best_acc_score: 0.5097; val_best_f1_score: 0.6698; train_kl_reg_loss: 45872.4379; train_edge_recon_loss: 3621385.0795; train_gene_expr_recon_loss: 15051065.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1148904.8873; train_chrom_access_recon_loss: 50174469.8182; train_global_loss: 70041697.6970; train_optim_loss: 70041697.6970; val_kl_reg_loss: 132260.9346; val_edge_recon_loss: 4064137.1875; val_gene_expr_recon_loss: 13486242.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 910363.7500; val_chrom_access_recon_loss: 47662698.5000; val_global_loss: 66255702.0000; val_optim_loss: 66255702.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6852; val_auprc_score: 0.6800; val_best_acc_score: 0.5398; val_best_f1_score: 0.6771; train_kl_reg_loss: 127124.4738; train_edge_recon_loss: 3559217.8788; train_gene_expr_recon_loss: 13270854.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 680750.5952; train_chrom_access_recon_loss: 47556263.4545; train_global_loss: 65194210.9697; train_optim_loss: 65194210.9697; val_kl_reg_loss: 121421.9707; val_edge_recon_loss: 4062110.6562; val_gene_expr_recon_loss: 13084988.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 480707.9062; val_chrom_access_recon_loss: 47105133.0000; val_global_loss: 64854361.5000; val_optim_loss: 64854361.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7498; val_auprc_score: 0.7252; val_best_acc_score: 0.6741; val_best_f1_score: 0.7108; train_kl_reg_loss: 124305.2653; train_edge_recon_loss: 3544649.7500; train_gene_expr_recon_loss: 13026666.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 362261.8783; train_chrom_access_recon_loss: 47069780.9091; train_global_loss: 64127663.8182; train_optim_loss: 64127663.8182; val_kl_reg_loss: 118547.5723; val_edge_recon_loss: 4051721.9688; val_gene_expr_recon_loss: 12946716.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 271182.4375; val_chrom_access_recon_loss: 46694749.5000; val_global_loss: 64082917.0000; val_optim_loss: 64082917.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8046; val_auprc_score: 0.7807; val_best_acc_score: 0.7112; val_best_f1_score: 0.7615; train_kl_reg_loss: 112284.4026; train_edge_recon_loss: 3524990.3523; train_gene_expr_recon_loss: 12910083.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221226.3258; train_chrom_access_recon_loss: 46771504.8485; train_global_loss: 63540088.9697; train_optim_loss: 63540088.9697; val_kl_reg_loss: 96833.1816; val_edge_recon_loss: 3977381.8438; val_gene_expr_recon_loss: 12816506.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181758.3281; val_chrom_access_recon_loss: 46436024.0000; val_global_loss: 63508503.5000; val_optim_loss: 63508503.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8167; val_auprc_score: 0.7779; val_best_acc_score: 0.7488; val_best_f1_score: 0.7806; train_kl_reg_loss: 92554.0511; train_edge_recon_loss: 3462406.3295; train_gene_expr_recon_loss: 12810702.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158026.8198; train_chrom_access_recon_loss: 46454245.3939; train_global_loss: 62977934.7879; train_optim_loss: 62977934.7879; val_kl_reg_loss: 77798.8770; val_edge_recon_loss: 3451972.1250; val_gene_expr_recon_loss: 12816800.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137935.7031; val_chrom_access_recon_loss: 46481074.5000; val_global_loss: 62965583.0000; val_optim_loss: 62965583.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8276; val_auprc_score: 0.7832; val_best_acc_score: 0.7614; val_best_f1_score: 0.7823; train_kl_reg_loss: 103718.9066; train_edge_recon_loss: 3120396.4545; train_gene_expr_recon_loss: 12732038.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123610.9060; train_chrom_access_recon_loss: 46241306.0000; train_global_loss: 62321070.4242; train_optim_loss: 62321070.4242; val_kl_reg_loss: 110478.2939; val_edge_recon_loss: 3042743.5000; val_gene_expr_recon_loss: 12665552.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111047.9219; val_chrom_access_recon_loss: 45910820.0000; val_global_loss: 61840641.5000; val_optim_loss: 61840641.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8493; val_auprc_score: 0.8020; val_best_acc_score: 0.7826; val_best_f1_score: 0.8055; train_kl_reg_loss: 126016.3932; train_edge_recon_loss: 2982459.5227; train_gene_expr_recon_loss: 12660200.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101509.4798; train_chrom_access_recon_loss: 46050398.3030; train_global_loss: 61920583.8182; train_optim_loss: 61920583.8182; val_kl_reg_loss: 121665.7676; val_edge_recon_loss: 2919292.0625; val_gene_expr_recon_loss: 12737221.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93289.6406; val_chrom_access_recon_loss: 46017747.0000; val_global_loss: 61889215.5000; val_optim_loss: 61889215.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8517; val_auprc_score: 0.8044; val_best_acc_score: 0.7875; val_best_f1_score: 0.8129; train_kl_reg_loss: 121521.0930; train_edge_recon_loss: 2952971.1439; train_gene_expr_recon_loss: 12588732.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87085.4889; train_chrom_access_recon_loss: 45799726.7879; train_global_loss: 61550036.7879; train_optim_loss: 61550036.7879; val_kl_reg_loss: 121671.8369; val_edge_recon_loss: 2908214.6875; val_gene_expr_recon_loss: 12620331.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81504.9922; val_chrom_access_recon_loss: 45762830.5000; val_global_loss: 61494554.0000; val_optim_loss: 61494554.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8447; val_auprc_score: 0.7965; val_best_acc_score: 0.7837; val_best_f1_score: 0.8147; train_kl_reg_loss: 118282.1345; train_edge_recon_loss: 2911360.1061; train_gene_expr_recon_loss: 12547496.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77206.3980; train_chrom_access_recon_loss: 45657543.2121; train_global_loss: 61311888.0000; train_optim_loss: 61311888.0000; val_kl_reg_loss: 114142.1172; val_edge_recon_loss: 2917458.6562; val_gene_expr_recon_loss: 12524619.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73375.2109; val_chrom_access_recon_loss: 45431263.5000; val_global_loss: 61060859.0000; val_optim_loss: 61060859.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8475; val_auprc_score: 0.8042; val_best_acc_score: 0.7869; val_best_f1_score: 0.8149; train_kl_reg_loss: 114381.4136; train_edge_recon_loss: 2888755.9053; train_gene_expr_recon_loss: 12484334.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70354.3713; train_chrom_access_recon_loss: 45433340.3636; train_global_loss: 60991166.5455; train_optim_loss: 60991166.5455; val_kl_reg_loss: 113495.3594; val_edge_recon_loss: 2913073.9688; val_gene_expr_recon_loss: 12461720.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67593.3672; val_chrom_access_recon_loss: 45443601.5000; val_global_loss: 60999483.5000; val_optim_loss: 60999483.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8691; val_auprc_score: 0.8316; val_best_acc_score: 0.8052; val_best_f1_score: 0.8295; train_kl_reg_loss: 112554.2375; train_edge_recon_loss: 2872625.1098; train_gene_expr_recon_loss: 12439276.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65174.6271; train_chrom_access_recon_loss: 45308146.4242; train_global_loss: 60797777.1515; train_optim_loss: 60797777.1515; val_kl_reg_loss: 111263.8643; val_edge_recon_loss: 2848864.3750; val_gene_expr_recon_loss: 12525948.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63074.6719; val_chrom_access_recon_loss: 44637774.0000; val_global_loss: 60186925.0000; val_optim_loss: 60186925.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8854; val_auprc_score: 0.8532; val_best_acc_score: 0.8119; val_best_f1_score: 0.8328; train_kl_reg_loss: 112062.3065; train_edge_recon_loss: 2847942.9848; train_gene_expr_recon_loss: 12390465.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61298.0069; train_chrom_access_recon_loss: 45128687.5758; train_global_loss: 60540456.9091; train_optim_loss: 60540456.9091; val_kl_reg_loss: 112363.2607; val_edge_recon_loss: 2890726.5938; val_gene_expr_recon_loss: 12384269.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59703.4805; val_chrom_access_recon_loss: 44858387.0000; val_global_loss: 60305449.0000; val_optim_loss: 60305449.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8873; val_auprc_score: 0.8544; val_best_acc_score: 0.8184; val_best_f1_score: 0.8374; train_kl_reg_loss: 111453.8809; train_edge_recon_loss: 2822333.8447; train_gene_expr_recon_loss: 12343905.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58305.4822; train_chrom_access_recon_loss: 44967047.7576; train_global_loss: 60303046.4242; train_optim_loss: 60303046.4242; val_kl_reg_loss: 106463.2363; val_edge_recon_loss: 2878565.2812; val_gene_expr_recon_loss: 12263399.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57336.5859; val_chrom_access_recon_loss: 44976217.5000; val_global_loss: 60281982.0000; val_optim_loss: 60281982.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8906; val_auprc_score: 0.8579; val_best_acc_score: 0.8229; val_best_f1_score: 0.8417; train_kl_reg_loss: 110004.0507; train_edge_recon_loss: 2818768.1742; train_gene_expr_recon_loss: 12306795.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56157.1158; train_chrom_access_recon_loss: 44862046.5455; train_global_loss: 60153772.0606; train_optim_loss: 60153772.0606; val_kl_reg_loss: 108462.2266; val_edge_recon_loss: 2890198.3438; val_gene_expr_recon_loss: 12238804.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55064.2930; val_chrom_access_recon_loss: 44801066.5000; val_global_loss: 60093595.5000; val_optim_loss: 60093595.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9045; val_auprc_score: 0.8744; val_best_acc_score: 0.8372; val_best_f1_score: 0.8536; train_kl_reg_loss: 107885.1502; train_edge_recon_loss: 2810881.9886; train_gene_expr_recon_loss: 12265380.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54159.4303; train_chrom_access_recon_loss: 44645625.0909; train_global_loss: 59883932.1212; train_optim_loss: 59883932.1212; val_kl_reg_loss: 106242.8711; val_edge_recon_loss: 2841680.6875; val_gene_expr_recon_loss: 12262138.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53376.7461; val_chrom_access_recon_loss: 44517861.0000; val_global_loss: 59781299.0000; val_optim_loss: 59781299.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9055; val_auprc_score: 0.8753; val_best_acc_score: 0.8463; val_best_f1_score: 0.8578; train_kl_reg_loss: 106117.6175; train_edge_recon_loss: 2793057.4545; train_gene_expr_recon_loss: 12222100.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52692.0078; train_chrom_access_recon_loss: 44495500.0606; train_global_loss: 59669468.0000; train_optim_loss: 59669468.0000; val_kl_reg_loss: 105467.0586; val_edge_recon_loss: 2851384.7188; val_gene_expr_recon_loss: 12344751.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52193.9336; val_chrom_access_recon_loss: 44522849.0000; val_global_loss: 59876648.0000; val_optim_loss: 59876648.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9110; val_auprc_score: 0.8831; val_best_acc_score: 0.8501; val_best_f1_score: 0.8627; train_kl_reg_loss: 105940.5929; train_edge_recon_loss: 2783490.1326; train_gene_expr_recon_loss: 12199662.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51598.1046; train_chrom_access_recon_loss: 44388550.0606; train_global_loss: 59529241.3939; train_optim_loss: 59529241.3939; val_kl_reg_loss: 105455.9482; val_edge_recon_loss: 2812681.0000; val_gene_expr_recon_loss: 12286690.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50918.0938; val_chrom_access_recon_loss: 44629510.5000; val_global_loss: 59885256.0000; val_optim_loss: 59885256.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9158; val_auprc_score: 0.8849; val_best_acc_score: 0.8552; val_best_f1_score: 0.8658; train_kl_reg_loss: 105290.7743; train_edge_recon_loss: 2773978.0606; train_gene_expr_recon_loss: 12158601.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50473.7264; train_chrom_access_recon_loss: 44205842.6061; train_global_loss: 59294187.3939; train_optim_loss: 59294187.3939; val_kl_reg_loss: 102472.1553; val_edge_recon_loss: 2781714.5625; val_gene_expr_recon_loss: 12153437.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50134.3047; val_chrom_access_recon_loss: 43900115.0000; val_global_loss: 58987872.0000; val_optim_loss: 58987872.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9159; val_auprc_score: 0.8852; val_best_acc_score: 0.8555; val_best_f1_score: 0.8664; train_kl_reg_loss: 102842.8058; train_edge_recon_loss: 2763429.8371; train_gene_expr_recon_loss: 12129521.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49703.9916; train_chrom_access_recon_loss: 44084661.0303; train_global_loss: 59130158.7879; train_optim_loss: 59130158.7879; val_kl_reg_loss: 104186.3760; val_edge_recon_loss: 2816835.4688; val_gene_expr_recon_loss: 12097659.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49232.1172; val_chrom_access_recon_loss: 44289460.5000; val_global_loss: 59357373.5000; val_optim_loss: 59357373.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9272; val_auprc_score: 0.9025; val_best_acc_score: 0.8654; val_best_f1_score: 0.8748; train_kl_reg_loss: 102279.2137; train_edge_recon_loss: 2763566.9432; train_gene_expr_recon_loss: 12093844.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48929.1802; train_chrom_access_recon_loss: 43927766.5455; train_global_loss: 58936386.7273; train_optim_loss: 58936386.7273; val_kl_reg_loss: 101022.4707; val_edge_recon_loss: 2783659.1562; val_gene_expr_recon_loss: 12274664.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48827.3828; val_chrom_access_recon_loss: 44653470.5000; val_global_loss: 59861644.0000; val_optim_loss: 59861644.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9240; val_auprc_score: 0.8951; val_best_acc_score: 0.8649; val_best_f1_score: 0.8760; train_kl_reg_loss: 100877.6606; train_edge_recon_loss: 2748079.7614; train_gene_expr_recon_loss: 12073266.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48424.8033; train_chrom_access_recon_loss: 43802786.7879; train_global_loss: 58773435.8182; train_optim_loss: 58773435.8182; val_kl_reg_loss: 99576.2373; val_edge_recon_loss: 2779934.7188; val_gene_expr_recon_loss: 12166910.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48128.1484; val_chrom_access_recon_loss: 43998320.5000; val_global_loss: 59092871.0000; val_optim_loss: 59092871.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9232; val_auprc_score: 0.8959; val_best_acc_score: 0.8611; val_best_f1_score: 0.8734; train_kl_reg_loss: 99944.9521; train_edge_recon_loss: 2740489.3295; train_gene_expr_recon_loss: 12037544.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48029.6182; train_chrom_access_recon_loss: 43638807.5758; train_global_loss: 58564816.0606; train_optim_loss: 58564816.0606; val_kl_reg_loss: 98516.2090; val_edge_recon_loss: 2797761.2812; val_gene_expr_recon_loss: 12104222.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47672.6211; val_chrom_access_recon_loss: 43764082.0000; val_global_loss: 58812255.0000; val_optim_loss: 58812255.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9241; val_auprc_score: 0.8971; val_best_acc_score: 0.8589; val_best_f1_score: 0.8707; train_kl_reg_loss: 99009.3999; train_edge_recon_loss: 2748277.4621; train_gene_expr_recon_loss: 12010521.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47407.6676; train_chrom_access_recon_loss: 43525226.0000; train_global_loss: 58430442.2424; train_optim_loss: 58430442.2424; val_kl_reg_loss: 96921.9385; val_edge_recon_loss: 2810762.5625; val_gene_expr_recon_loss: 12197861.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47481.3008; val_chrom_access_recon_loss: 43982117.0000; val_global_loss: 59135144.0000; val_optim_loss: 59135144.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9290; val_auprc_score: 0.9091; val_best_acc_score: 0.8673; val_best_f1_score: 0.8753; train_kl_reg_loss: 97644.1713; train_edge_recon_loss: 2739261.9470; train_gene_expr_recon_loss: 11988874.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47191.0092; train_chrom_access_recon_loss: 43362501.5152; train_global_loss: 58235473.6970; train_optim_loss: 58235473.6970; val_kl_reg_loss: 94394.5547; val_edge_recon_loss: 2782106.0312; val_gene_expr_recon_loss: 12046239.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47059.5938; val_chrom_access_recon_loss: 43478964.0000; val_global_loss: 58448764.0000; val_optim_loss: 58448764.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9223; val_auprc_score: 0.8952; val_best_acc_score: 0.8606; val_best_f1_score: 0.8690; train_kl_reg_loss: 95613.9022; train_edge_recon_loss: 2731608.5455; train_gene_expr_recon_loss: 11963452.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46883.4028; train_chrom_access_recon_loss: 43249498.9091; train_global_loss: 58087057.2727; train_optim_loss: 58087057.2727; val_kl_reg_loss: 96014.9170; val_edge_recon_loss: 2802057.9688; val_gene_expr_recon_loss: 12026893.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46653.0078; val_chrom_access_recon_loss: 43574670.0000; val_global_loss: 58546290.0000; val_optim_loss: 58546290.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9325; val_auprc_score: 0.9091; val_best_acc_score: 0.8729; val_best_f1_score: 0.8802; train_kl_reg_loss: 100879.8610; train_edge_recon_loss: 2756498.9205; train_gene_expr_recon_loss: 11794636.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41361.6997; train_chrom_access_recon_loss: 43086265.4545; train_global_loss: 57779642.7273; train_optim_loss: 57779642.7273; val_kl_reg_loss: 73433.9414; val_edge_recon_loss: 2788640.0625; val_gene_expr_recon_loss: 11862348.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40028.4922; val_chrom_access_recon_loss: 43133450.5000; val_global_loss: 57897901.0000; val_optim_loss: 57897901.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9329; val_auprc_score: 0.9093; val_best_acc_score: 0.8732; val_best_f1_score: 0.8809; train_kl_reg_loss: 101212.7494; train_edge_recon_loss: 2737441.1553; train_gene_expr_recon_loss: 11775302.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39551.7567; train_chrom_access_recon_loss: 42930951.3939; train_global_loss: 57584459.0909; train_optim_loss: 57584459.0909; val_kl_reg_loss: 72347.1094; val_edge_recon_loss: 2773221.1875; val_gene_expr_recon_loss: 11695007.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39146.2969; val_chrom_access_recon_loss: 42332720.0000; val_global_loss: 56912441.0000; val_optim_loss: 56912441.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9276; val_auprc_score: 0.9011; val_best_acc_score: 0.8713; val_best_f1_score: 0.8791; train_kl_reg_loss: 97508.1792; train_edge_recon_loss: 2728249.5189; train_gene_expr_recon_loss: 11741535.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38988.1428; train_chrom_access_recon_loss: 42813093.4545; train_global_loss: 57419374.4848; train_optim_loss: 57419374.4848; val_kl_reg_loss: 74777.9600; val_edge_recon_loss: 2775996.7500; val_gene_expr_recon_loss: 11859318.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38885.1875; val_chrom_access_recon_loss: 42898192.0000; val_global_loss: 57647171.0000; val_optim_loss: 57647171.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9399; val_auprc_score: 0.9151; val_best_acc_score: 0.8831; val_best_f1_score: 0.8901; train_kl_reg_loss: 93170.2733; train_edge_recon_loss: 2733034.1932; train_gene_expr_recon_loss: 11705685.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38754.3541; train_chrom_access_recon_loss: 42668321.6364; train_global_loss: 57238966.3636; train_optim_loss: 57238966.3636; val_kl_reg_loss: 75156.8350; val_edge_recon_loss: 2751164.9688; val_gene_expr_recon_loss: 11762551.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38765.0547; val_chrom_access_recon_loss: 42795645.5000; val_global_loss: 57423284.0000; val_optim_loss: 57423284.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9395; val_auprc_score: 0.9168; val_best_acc_score: 0.8850; val_best_f1_score: 0.8916; train_kl_reg_loss: 91019.1868; train_edge_recon_loss: 2729606.3864; train_gene_expr_recon_loss: 11675779.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38659.5218; train_chrom_access_recon_loss: 42543697.2121; train_global_loss: 57078762.1212; train_optim_loss: 57078762.1212; val_kl_reg_loss: 75123.0078; val_edge_recon_loss: 2753738.9688; val_gene_expr_recon_loss: 11745778.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38576.4023; val_chrom_access_recon_loss: 42420419.5000; val_global_loss: 57033636.0000; val_optim_loss: 57033636.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9255; val_best_acc_score: 0.8896; val_best_f1_score: 0.8960; train_kl_reg_loss: 88203.1205; train_edge_recon_loss: 2726171.3144; train_gene_expr_recon_loss: 11653148.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38537.2651; train_chrom_access_recon_loss: 42448904.0000; train_global_loss: 56954964.5455; train_optim_loss: 56954964.5455; val_kl_reg_loss: 75172.1797; val_edge_recon_loss: 2764538.7188; val_gene_expr_recon_loss: 11803067.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38435.5000; val_chrom_access_recon_loss: 42745831.0000; val_global_loss: 57427044.5000; val_optim_loss: 57427044.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9457; val_auprc_score: 0.9242; val_best_acc_score: 0.8928; val_best_f1_score: 0.8983; train_kl_reg_loss: 88457.4927; train_edge_recon_loss: 2719889.2955; train_gene_expr_recon_loss: 11644789.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36240.0082; train_chrom_access_recon_loss: 42414745.7576; train_global_loss: 56904121.8182; train_optim_loss: 56904121.8182; val_kl_reg_loss: 76309.4521; val_edge_recon_loss: 2731260.7500; val_gene_expr_recon_loss: 11665491.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35694.0898; val_chrom_access_recon_loss: 42044302.5000; val_global_loss: 56553058.5000; val_optim_loss: 56553058.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9410; val_auprc_score: 0.9211; val_best_acc_score: 0.8823; val_best_f1_score: 0.8898; train_kl_reg_loss: 89105.8551; train_edge_recon_loss: 2713341.4583; train_gene_expr_recon_loss: 11629110.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35580.2253; train_chrom_access_recon_loss: 42329721.3333; train_global_loss: 56796859.2121; train_optim_loss: 56796859.2121; val_kl_reg_loss: 77664.4990; val_edge_recon_loss: 2778072.9375; val_gene_expr_recon_loss: 11724520.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35480.6523; val_chrom_access_recon_loss: 42784078.0000; val_global_loss: 57399817.0000; val_optim_loss: 57399817.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9395; val_auprc_score: 0.9138; val_best_acc_score: 0.8874; val_best_f1_score: 0.8948; train_kl_reg_loss: 89367.5162; train_edge_recon_loss: 2715402.5720; train_gene_expr_recon_loss: 11622825.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35413.1676; train_chrom_access_recon_loss: 42347947.6364; train_global_loss: 56810956.9091; train_optim_loss: 56810956.9091; val_kl_reg_loss: 76985.1094; val_edge_recon_loss: 2768808.1875; val_gene_expr_recon_loss: 11616034.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35348.7109; val_chrom_access_recon_loss: 42388314.5000; val_global_loss: 56885491.5000; val_optim_loss: 56885491.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9504; val_auprc_score: 0.9315; val_best_acc_score: 0.9022; val_best_f1_score: 0.9065; train_kl_reg_loss: 88731.2112; train_edge_recon_loss: 2706047.1174; train_gene_expr_recon_loss: 11616975.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35293.4878; train_chrom_access_recon_loss: 42310017.2727; train_global_loss: 56757064.9091; train_optim_loss: 56757064.9091; val_kl_reg_loss: 77558.7520; val_edge_recon_loss: 2741846.7500; val_gene_expr_recon_loss: 11630827.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35238.5781; val_chrom_access_recon_loss: 41853925.0000; val_global_loss: 56339396.5000; val_optim_loss: 56339396.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9398; val_auprc_score: 0.9128; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 88774.0682; train_edge_recon_loss: 2719826.7614; train_gene_expr_recon_loss: 11624093.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35193.1480; train_chrom_access_recon_loss: 42321602.5455; train_global_loss: 56789490.1818; train_optim_loss: 56789490.1818; val_kl_reg_loss: 77405.4688; val_edge_recon_loss: 2741388.0938; val_gene_expr_recon_loss: 11732255.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35146.3672; val_chrom_access_recon_loss: 42591569.5000; val_global_loss: 57177765.0000; val_optim_loss: 57177765.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9406; val_auprc_score: 0.9192; val_best_acc_score: 0.8829; val_best_f1_score: 0.8901; train_kl_reg_loss: 88162.7647; train_edge_recon_loss: 2714582.6023; train_gene_expr_recon_loss: 11622973.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35086.9358; train_chrom_access_recon_loss: 42301835.3939; train_global_loss: 56762641.3333; train_optim_loss: 56762641.3333; val_kl_reg_loss: 76809.6768; val_edge_recon_loss: 2755383.4375; val_gene_expr_recon_loss: 11715697.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35033.4883; val_chrom_access_recon_loss: 42020884.0000; val_global_loss: 56603807.5000; val_optim_loss: 56603807.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9420; val_auprc_score: 0.9136; val_best_acc_score: 0.8907; val_best_f1_score: 0.8975; train_kl_reg_loss: 88265.9917; train_edge_recon_loss: 2697089.3523; train_gene_expr_recon_loss: 11613860.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34995.4775; train_chrom_access_recon_loss: 42278970.5455; train_global_loss: 56713181.8788; train_optim_loss: 56713181.8788; val_kl_reg_loss: 77857.7520; val_edge_recon_loss: 2757431.2188; val_gene_expr_recon_loss: 11653926.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34945.9219; val_chrom_access_recon_loss: 42160937.5000; val_global_loss: 56685099.0000; val_optim_loss: 56685099.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9461; val_auprc_score: 0.9312; val_best_acc_score: 0.8933; val_best_f1_score: 0.8993; train_kl_reg_loss: 88272.6012; train_edge_recon_loss: 2707816.7538; train_gene_expr_recon_loss: 11612870.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34905.9451; train_chrom_access_recon_loss: 42287359.9394; train_global_loss: 56731225.8182; train_optim_loss: 56731225.8182; val_kl_reg_loss: 77544.7031; val_edge_recon_loss: 2736337.1562; val_gene_expr_recon_loss: 11622872.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34857.3516; val_chrom_access_recon_loss: 41714535.0000; val_global_loss: 56186146.0000; val_optim_loss: 56186146.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9395; val_auprc_score: 0.9123; val_best_acc_score: 0.8845; val_best_f1_score: 0.8915; train_kl_reg_loss: 87501.3686; train_edge_recon_loss: 2702377.8295; train_gene_expr_recon_loss: 11609682.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34811.9409; train_chrom_access_recon_loss: 42298567.6364; train_global_loss: 56732941.2727; train_optim_loss: 56732941.2727; val_kl_reg_loss: 77585.6455; val_edge_recon_loss: 2767582.5000; val_gene_expr_recon_loss: 11575368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34772.9648; val_chrom_access_recon_loss: 42266936.0000; val_global_loss: 56722245.5000; val_optim_loss: 56722245.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9464; val_auprc_score: 0.9218; val_best_acc_score: 0.8992; val_best_f1_score: 0.9041; train_kl_reg_loss: 87325.9523; train_edge_recon_loss: 2700897.2159; train_gene_expr_recon_loss: 11608194.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34713.5434; train_chrom_access_recon_loss: 42252209.4545; train_global_loss: 56683340.3030; train_optim_loss: 56683340.3030; val_kl_reg_loss: 78121.0869; val_edge_recon_loss: 2740096.3750; val_gene_expr_recon_loss: 11650880.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34676.3359; val_chrom_access_recon_loss: 42490228.5000; val_global_loss: 56994002.0000; val_optim_loss: 56994002.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9403; val_auprc_score: 0.9136; val_best_acc_score: 0.8925; val_best_f1_score: 0.8985; train_kl_reg_loss: 87321.5008; train_edge_recon_loss: 2708784.4242; train_gene_expr_recon_loss: 11611955.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34627.5585; train_chrom_access_recon_loss: 42258906.7879; train_global_loss: 56701595.8182; train_optim_loss: 56701595.8182; val_kl_reg_loss: 77554.2324; val_edge_recon_loss: 2762281.0000; val_gene_expr_recon_loss: 11653773.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34573.0586; val_chrom_access_recon_loss: 42141608.5000; val_global_loss: 56669790.0000; val_optim_loss: 56669790.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9551; val_auprc_score: 0.9393; val_best_acc_score: 0.8976; val_best_f1_score: 0.9017; train_kl_reg_loss: 86878.8346; train_edge_recon_loss: 2707003.3220; train_gene_expr_recon_loss: 11603033.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34547.9721; train_chrom_access_recon_loss: 42219012.4242; train_global_loss: 56650475.7576; train_optim_loss: 56650475.7576; val_kl_reg_loss: 77007.6445; val_edge_recon_loss: 2754640.0625; val_gene_expr_recon_loss: 11571974.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34503.4023; val_chrom_access_recon_loss: 41797359.0000; val_global_loss: 56235484.0000; val_optim_loss: 56235484.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9525; val_auprc_score: 0.9356; val_best_acc_score: 0.9049; val_best_f1_score: 0.9076; train_kl_reg_loss: 86275.4989; train_edge_recon_loss: 2702680.8220; train_gene_expr_recon_loss: 11600194.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34262.7252; train_chrom_access_recon_loss: 42230033.3333; train_global_loss: 56653447.0909; train_optim_loss: 56653447.0909; val_kl_reg_loss: 77362.1494; val_edge_recon_loss: 2734397.6875; val_gene_expr_recon_loss: 11617745.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34206.3594; val_chrom_access_recon_loss: 41818680.5000; val_global_loss: 56282392.0000; val_optim_loss: 56282392.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9495; val_auprc_score: 0.9302; val_best_acc_score: 0.9006; val_best_f1_score: 0.9042; train_kl_reg_loss: 86449.1145; train_edge_recon_loss: 2708787.8788; train_gene_expr_recon_loss: 11607547.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34193.0784; train_chrom_access_recon_loss: 42254502.4242; train_global_loss: 56691479.9394; train_optim_loss: 56691479.9394; val_kl_reg_loss: 77370.3359; val_edge_recon_loss: 2728922.5000; val_gene_expr_recon_loss: 11728197.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34181.0742; val_chrom_access_recon_loss: 42623923.5000; val_global_loss: 57192595.0000; val_optim_loss: 57192595.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9469; val_auprc_score: 0.9306; val_best_acc_score: 0.8960; val_best_f1_score: 0.8998; train_kl_reg_loss: 86320.5946; train_edge_recon_loss: 2709931.4432; train_gene_expr_recon_loss: 11598501.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34171.9687; train_chrom_access_recon_loss: 42184986.9091; train_global_loss: 56613912.3636; train_optim_loss: 56613912.3636; val_kl_reg_loss: 77484.9082; val_edge_recon_loss: 2760923.8125; val_gene_expr_recon_loss: 11721480.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34161.9883; val_chrom_access_recon_loss: 42001937.5000; val_global_loss: 56595988.5000; val_optim_loss: 56595988.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9479; val_auprc_score: 0.9315; val_best_acc_score: 0.8982; val_best_f1_score: 0.9032; train_kl_reg_loss: 86384.7383; train_edge_recon_loss: 2699762.9318; train_gene_expr_recon_loss: 11609123.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34154.6952; train_chrom_access_recon_loss: 42236506.0606; train_global_loss: 56665932.0606; train_optim_loss: 56665932.0606; val_kl_reg_loss: 77066.2852; val_edge_recon_loss: 2729674.5938; val_gene_expr_recon_loss: 11670367.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34146.1406; val_chrom_access_recon_loss: 41957730.0000; val_global_loss: 56468984.5000; val_optim_loss: 56468984.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 3 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9429
val AUPRC score: 0.9192
val best accuracy score: 0.8915
val best F1 score: 0.8976
val target rna MSE score: 1.1805
val source rna MSE score: 0.4666
val target atac MSE score: 0.1229
val source atac MSE score: 0.0271
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
