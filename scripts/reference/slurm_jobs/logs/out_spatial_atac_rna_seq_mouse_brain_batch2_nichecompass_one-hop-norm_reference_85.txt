[True]
Run timestamp: 10102023_001935_85.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_85']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7667; val_auprc_score: 0.7931; val_best_acc_score: 0.5432; val_best_f1_score: 0.6810; train_kl_reg_loss: 57486.8933; train_edge_recon_loss: 3502044.4637; train_gene_expr_recon_loss: 13478872.9237; train_masked_gp_l1_reg_loss: 35456.8024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2420763.7815; train_chrom_access_recon_loss: 6726262.4198; train_global_loss: 26220887.3435; train_optim_loss: 26220887.3435; val_kl_reg_loss: 73893.0716; val_edge_recon_loss: 4061918.8167; val_gene_expr_recon_loss: 12784785.5333; val_masked_gp_l1_reg_loss: 42450.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 589273.3750; val_chrom_access_recon_loss: 6652834.6667; val_global_loss: 24205156.2667; val_optim_loss: 24205156.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7783; val_auprc_score: 0.7972; val_best_acc_score: 0.6853; val_best_f1_score: 0.7196; train_kl_reg_loss: 75014.4379; train_edge_recon_loss: 3494496.5763; train_gene_expr_recon_loss: 12617467.0000; train_masked_gp_l1_reg_loss: 44245.1719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 306160.8825; train_chrom_access_recon_loss: 6476531.7977; train_global_loss: 23013915.8626; train_optim_loss: 23013915.8626; val_kl_reg_loss: 62709.2714; val_edge_recon_loss: 3999093.2500; val_gene_expr_recon_loss: 12611301.6667; val_masked_gp_l1_reg_loss: 46170.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173432.0938; val_chrom_access_recon_loss: 6589238.0667; val_global_loss: 23481944.1333; val_optim_loss: 23481944.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8482; val_auprc_score: 0.8477; val_best_acc_score: 0.7548; val_best_f1_score: 0.7732; train_kl_reg_loss: 78201.6769; train_edge_recon_loss: 3214123.4523; train_gene_expr_recon_loss: 12466243.4427; train_masked_gp_l1_reg_loss: 49997.5849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136968.1163; train_chrom_access_recon_loss: 6406489.6603; train_global_loss: 22352023.9542; train_optim_loss: 22352023.9542; val_kl_reg_loss: 92713.0219; val_edge_recon_loss: 3087904.6500; val_gene_expr_recon_loss: 12401371.1333; val_masked_gp_l1_reg_loss: 53690.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112690.3594; val_chrom_access_recon_loss: 6493030.9667; val_global_loss: 22241400.4000; val_optim_loss: 22241400.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9185; val_auprc_score: 0.9065; val_best_acc_score: 0.8483; val_best_f1_score: 0.8596; train_kl_reg_loss: 91629.1597; train_edge_recon_loss: 2919208.3454; train_gene_expr_recon_loss: 12299581.6870; train_masked_gp_l1_reg_loss: 56344.3058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103674.8569; train_chrom_access_recon_loss: 6318932.1832; train_global_loss: 21789370.6870; train_optim_loss: 21789370.6870; val_kl_reg_loss: 89156.0068; val_edge_recon_loss: 2824300.1500; val_gene_expr_recon_loss: 12281244.6667; val_masked_gp_l1_reg_loss: 58914.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97341.0156; val_chrom_access_recon_loss: 6419767.6667; val_global_loss: 21770723.4667; val_optim_loss: 21770723.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9259; val_auprc_score: 0.9103; val_best_acc_score: 0.8581; val_best_f1_score: 0.8679; train_kl_reg_loss: 90097.8827; train_edge_recon_loss: 2814173.5744; train_gene_expr_recon_loss: 12174593.3130; train_masked_gp_l1_reg_loss: 60641.5457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94439.2625; train_chrom_access_recon_loss: 6261039.2061; train_global_loss: 21494984.7786; train_optim_loss: 21494984.7786; val_kl_reg_loss: 88961.1141; val_edge_recon_loss: 2814990.2833; val_gene_expr_recon_loss: 12177876.2000; val_masked_gp_l1_reg_loss: 62347.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91615.8750; val_chrom_access_recon_loss: 6387169.9333; val_global_loss: 21622960.6667; val_optim_loss: 21622960.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9330; val_auprc_score: 0.9185; val_best_acc_score: 0.8703; val_best_f1_score: 0.8773; train_kl_reg_loss: 89428.3458; train_edge_recon_loss: 2794054.6737; train_gene_expr_recon_loss: 12073574.5573; train_masked_gp_l1_reg_loss: 63751.3791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88912.6445; train_chrom_access_recon_loss: 6219299.9618; train_global_loss: 21329021.4046; train_optim_loss: 21329021.4046; val_kl_reg_loss: 87082.8276; val_edge_recon_loss: 2790415.7667; val_gene_expr_recon_loss: 12070658.0667; val_masked_gp_l1_reg_loss: 64856.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87257.1094; val_chrom_access_recon_loss: 6354035.8667; val_global_loss: 21454306.2667; val_optim_loss: 21454306.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9334; val_auprc_score: 0.9175; val_best_acc_score: 0.8724; val_best_f1_score: 0.8791; train_kl_reg_loss: 85579.4241; train_edge_recon_loss: 2779240.6412; train_gene_expr_recon_loss: 11989663.8473; train_masked_gp_l1_reg_loss: 65917.8709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84956.1558; train_chrom_access_recon_loss: 6186621.2786; train_global_loss: 21191979.2214; train_optim_loss: 21191979.2214; val_kl_reg_loss: 81386.3844; val_edge_recon_loss: 2800123.5500; val_gene_expr_recon_loss: 11981273.1333; val_masked_gp_l1_reg_loss: 66842.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82872.8906; val_chrom_access_recon_loss: 6307894.5667; val_global_loss: 21320393.4667; val_optim_loss: 21320393.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9369; val_auprc_score: 0.9244; val_best_acc_score: 0.8732; val_best_f1_score: 0.8802; train_kl_reg_loss: 81460.7752; train_edge_recon_loss: 2771876.1813; train_gene_expr_recon_loss: 11903568.4962; train_masked_gp_l1_reg_loss: 67800.0227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81452.3442; train_chrom_access_recon_loss: 6143157.7595; train_global_loss: 21049315.5115; train_optim_loss: 21049315.5115; val_kl_reg_loss: 82936.5745; val_edge_recon_loss: 2777570.9500; val_gene_expr_recon_loss: 11877226.3333; val_masked_gp_l1_reg_loss: 68705.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80119.0625; val_chrom_access_recon_loss: 6248658.5667; val_global_loss: 21135216.4000; val_optim_loss: 21135216.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9368; val_auprc_score: 0.9203; val_best_acc_score: 0.8770; val_best_f1_score: 0.8836; train_kl_reg_loss: 81343.7826; train_edge_recon_loss: 2751666.0649; train_gene_expr_recon_loss: 11826146.6031; train_masked_gp_l1_reg_loss: 69395.8151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78758.0428; train_chrom_access_recon_loss: 6095911.6489; train_global_loss: 20903221.9695; train_optim_loss: 20903221.9695; val_kl_reg_loss: 80609.2188; val_edge_recon_loss: 2800049.5500; val_gene_expr_recon_loss: 11850299.9333; val_masked_gp_l1_reg_loss: 70122.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78366.0938; val_chrom_access_recon_loss: 6227309.1333; val_global_loss: 21106755.4667; val_optim_loss: 21106755.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9451; val_auprc_score: 0.9294; val_best_acc_score: 0.8878; val_best_f1_score: 0.8909; train_kl_reg_loss: 79007.1019; train_edge_recon_loss: 2748435.7443; train_gene_expr_recon_loss: 11773557.4198; train_masked_gp_l1_reg_loss: 70776.1210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76977.0805; train_chrom_access_recon_loss: 6075647.0840; train_global_loss: 20824400.5954; train_optim_loss: 20824400.5954; val_kl_reg_loss: 80693.0219; val_edge_recon_loss: 2761820.9167; val_gene_expr_recon_loss: 11779302.4000; val_masked_gp_l1_reg_loss: 71342.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76551.5234; val_chrom_access_recon_loss: 6178493.6333; val_global_loss: 20948204.6667; val_optim_loss: 20948204.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9409; val_auprc_score: 0.9233; val_best_acc_score: 0.8808; val_best_f1_score: 0.8857; train_kl_reg_loss: 76777.6834; train_edge_recon_loss: 2741265.9981; train_gene_expr_recon_loss: 11731854.2672; train_masked_gp_l1_reg_loss: 71888.0351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76012.6206; train_chrom_access_recon_loss: 6052937.3053; train_global_loss: 20750735.8473; train_optim_loss: 20750735.8473; val_kl_reg_loss: 76676.7240; val_edge_recon_loss: 2778432.5333; val_gene_expr_recon_loss: 11699898.5333; val_masked_gp_l1_reg_loss: 72502.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75372.9062; val_chrom_access_recon_loss: 6160511.2000; val_global_loss: 20863393.8667; val_optim_loss: 20863393.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9450; val_auprc_score: 0.9307; val_best_acc_score: 0.8839; val_best_f1_score: 0.8907; train_kl_reg_loss: 76630.7904; train_edge_recon_loss: 2721773.3912; train_gene_expr_recon_loss: 11664847.7710; train_masked_gp_l1_reg_loss: 72900.6602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75335.1469; train_chrom_access_recon_loss: 6016224.9389; train_global_loss: 20627712.7634; train_optim_loss: 20627712.7634; val_kl_reg_loss: 77633.1349; val_edge_recon_loss: 2756705.5500; val_gene_expr_recon_loss: 11649028.5333; val_masked_gp_l1_reg_loss: 73286.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76137.8750; val_chrom_access_recon_loss: 6106070.6333; val_global_loss: 20738862.9333; val_optim_loss: 20738862.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9499; val_auprc_score: 0.9369; val_best_acc_score: 0.8880; val_best_f1_score: 0.8933; train_kl_reg_loss: 74261.3214; train_edge_recon_loss: 2726003.2805; train_gene_expr_recon_loss: 11631078.3588; train_masked_gp_l1_reg_loss: 73698.9864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75381.5075; train_chrom_access_recon_loss: 5989701.0420; train_global_loss: 20570124.5954; train_optim_loss: 20570124.5954; val_kl_reg_loss: 75740.2849; val_edge_recon_loss: 2744744.0500; val_gene_expr_recon_loss: 11659929.2667; val_masked_gp_l1_reg_loss: 74040.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75947.8984; val_chrom_access_recon_loss: 6112075.7667; val_global_loss: 20742477.3333; val_optim_loss: 20742477.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9503; val_auprc_score: 0.9351; val_best_acc_score: 0.8948; val_best_f1_score: 0.8989; train_kl_reg_loss: 73814.0139; train_edge_recon_loss: 2721401.6107; train_gene_expr_recon_loss: 11589006.4580; train_masked_gp_l1_reg_loss: 74283.9327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75036.2592; train_chrom_access_recon_loss: 5970900.2557; train_global_loss: 20504442.4580; train_optim_loss: 20504442.4580; val_kl_reg_loss: 72958.2099; val_edge_recon_loss: 2721896.6000; val_gene_expr_recon_loss: 11602700.6667; val_masked_gp_l1_reg_loss: 74712.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75123.8438; val_chrom_access_recon_loss: 6077344.7000; val_global_loss: 20624736.8000; val_optim_loss: 20624736.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9532; val_auprc_score: 0.9425; val_best_acc_score: 0.8937; val_best_f1_score: 0.8990; train_kl_reg_loss: 71824.6060; train_edge_recon_loss: 2709512.5458; train_gene_expr_recon_loss: 11550989.1069; train_masked_gp_l1_reg_loss: 74981.6400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74510.9288; train_chrom_access_recon_loss: 5948651.5076; train_global_loss: 20430470.4580; train_optim_loss: 20430470.4580; val_kl_reg_loss: 73644.4104; val_edge_recon_loss: 2740377.0000; val_gene_expr_recon_loss: 11613565.2000; val_masked_gp_l1_reg_loss: 75225.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74572.0625; val_chrom_access_recon_loss: 6093993.3667; val_global_loss: 20671376.9333; val_optim_loss: 20671376.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9547; val_auprc_score: 0.9397; val_best_acc_score: 0.8984; val_best_f1_score: 0.9016; train_kl_reg_loss: 72813.2609; train_edge_recon_loss: 2701712.0553; train_gene_expr_recon_loss: 11514511.9695; train_masked_gp_l1_reg_loss: 75458.7780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74041.6760; train_chrom_access_recon_loss: 5928861.1947; train_global_loss: 20367398.9160; train_optim_loss: 20367398.9160; val_kl_reg_loss: 74829.8641; val_edge_recon_loss: 2724847.8167; val_gene_expr_recon_loss: 11603929.9333; val_masked_gp_l1_reg_loss: 75659.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73496.4609; val_chrom_access_recon_loss: 6084519.8333; val_global_loss: 20637282.2667; val_optim_loss: 20637282.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9591; val_auprc_score: 0.9476; val_best_acc_score: 0.9016; val_best_f1_score: 0.9058; train_kl_reg_loss: 69854.9559; train_edge_recon_loss: 2705812.5134; train_gene_expr_recon_loss: 11486773.9847; train_masked_gp_l1_reg_loss: 75931.5066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73323.5092; train_chrom_access_recon_loss: 5913540.0458; train_global_loss: 20325236.3511; train_optim_loss: 20325236.3511; val_kl_reg_loss: 69159.6161; val_edge_recon_loss: 2718847.9000; val_gene_expr_recon_loss: 11524359.4667; val_masked_gp_l1_reg_loss: 76260.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73360.9219; val_chrom_access_recon_loss: 6065072.5333; val_global_loss: 20527061.4667; val_optim_loss: 20527061.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9636; val_auprc_score: 0.9529; val_best_acc_score: 0.9124; val_best_f1_score: 0.9161; train_kl_reg_loss: 70610.5823; train_edge_recon_loss: 2687979.6355; train_gene_expr_recon_loss: 11457437.3740; train_masked_gp_l1_reg_loss: 76360.8763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72708.7958; train_chrom_access_recon_loss: 5893455.9427; train_global_loss: 20258553.2366; train_optim_loss: 20258553.2366; val_kl_reg_loss: 72233.1927; val_edge_recon_loss: 2698535.0333; val_gene_expr_recon_loss: 11464669.9333; val_masked_gp_l1_reg_loss: 76533.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72821.3047; val_chrom_access_recon_loss: 5997544.3667; val_global_loss: 20382336.4000; val_optim_loss: 20382336.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9502; val_best_acc_score: 0.9042; val_best_f1_score: 0.9064; train_kl_reg_loss: 70122.4142; train_edge_recon_loss: 2699375.2405; train_gene_expr_recon_loss: 11431390.0229; train_masked_gp_l1_reg_loss: 76643.6419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72357.5734; train_chrom_access_recon_loss: 5879761.3511; train_global_loss: 20229650.2595; train_optim_loss: 20229650.2595; val_kl_reg_loss: 70405.2531; val_edge_recon_loss: 2735723.9500; val_gene_expr_recon_loss: 11434634.6667; val_masked_gp_l1_reg_loss: 76732.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72448.9688; val_chrom_access_recon_loss: 5975552.6000; val_global_loss: 20365498.5333; val_optim_loss: 20365498.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9653; val_auprc_score: 0.9548; val_best_acc_score: 0.9117; val_best_f1_score: 0.9156; train_kl_reg_loss: 70334.1321; train_edge_recon_loss: 2682488.2805; train_gene_expr_recon_loss: 11424028.6031; train_masked_gp_l1_reg_loss: 76758.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72136.8896; train_chrom_access_recon_loss: 5870886.0763; train_global_loss: 20196632.6565; train_optim_loss: 20196632.6565; val_kl_reg_loss: 70230.1396; val_edge_recon_loss: 2703644.9167; val_gene_expr_recon_loss: 11474169.0667; val_masked_gp_l1_reg_loss: 76954.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71602.6250; val_chrom_access_recon_loss: 6019948.3000; val_global_loss: 20416549.2000; val_optim_loss: 20416549.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9656; val_auprc_score: 0.9567; val_best_acc_score: 0.9138; val_best_f1_score: 0.9168; train_kl_reg_loss: 69650.4415; train_edge_recon_loss: 2688529.3912; train_gene_expr_recon_loss: 11388344.3435; train_masked_gp_l1_reg_loss: 76953.7286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71770.0977; train_chrom_access_recon_loss: 5847766.4656; train_global_loss: 20143014.4580; train_optim_loss: 20143014.4580; val_kl_reg_loss: 72057.7891; val_edge_recon_loss: 2687365.5667; val_gene_expr_recon_loss: 11392666.6667; val_masked_gp_l1_reg_loss: 76909.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71381.0156; val_chrom_access_recon_loss: 5983924.9000; val_global_loss: 20284304.9333; val_optim_loss: 20284304.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9690; val_auprc_score: 0.9598; val_best_acc_score: 0.9150; val_best_f1_score: 0.9175; train_kl_reg_loss: 69454.8389; train_edge_recon_loss: 2683268.0267; train_gene_expr_recon_loss: 11361119.5649; train_masked_gp_l1_reg_loss: 76993.3683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71322.6656; train_chrom_access_recon_loss: 5837922.6450; train_global_loss: 20100081.1298; train_optim_loss: 20100081.1298; val_kl_reg_loss: 68826.9156; val_edge_recon_loss: 2691577.7500; val_gene_expr_recon_loss: 11400945.2000; val_masked_gp_l1_reg_loss: 76989.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71335.3750; val_chrom_access_recon_loss: 5964663.9000; val_global_loss: 20274337.6000; val_optim_loss: 20274337.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9668; val_auprc_score: 0.9592; val_best_acc_score: 0.9136; val_best_f1_score: 0.9166; train_kl_reg_loss: 68023.8372; train_edge_recon_loss: 2682268.8836; train_gene_expr_recon_loss: 11354438.2748; train_masked_gp_l1_reg_loss: 77057.8750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71097.5771; train_chrom_access_recon_loss: 5823548.6183; train_global_loss: 20076435.0076; train_optim_loss: 20076435.0076; val_kl_reg_loss: 66937.3284; val_edge_recon_loss: 2701963.3500; val_gene_expr_recon_loss: 11445870.8000; val_masked_gp_l1_reg_loss: 77209.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71073.5078; val_chrom_access_recon_loss: 5986363.6667; val_global_loss: 20349417.7333; val_optim_loss: 20349417.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9691; val_auprc_score: 0.9605; val_best_acc_score: 0.9163; val_best_f1_score: 0.9176; train_kl_reg_loss: 68195.8592; train_edge_recon_loss: 2685248.3092; train_gene_expr_recon_loss: 11332470.9542; train_masked_gp_l1_reg_loss: 77152.3407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70906.4869; train_chrom_access_recon_loss: 5810904.8397; train_global_loss: 20044878.8702; train_optim_loss: 20044878.8702; val_kl_reg_loss: 67063.0182; val_edge_recon_loss: 2696064.5833; val_gene_expr_recon_loss: 11370886.8667; val_masked_gp_l1_reg_loss: 77294.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71349.1953; val_chrom_access_recon_loss: 5930886.3333; val_global_loss: 20213544.8000; val_optim_loss: 20213544.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9725; val_auprc_score: 0.9645; val_best_acc_score: 0.9235; val_best_f1_score: 0.9258; train_kl_reg_loss: 68277.2272; train_edge_recon_loss: 2680351.4160; train_gene_expr_recon_loss: 11319502.4885; train_masked_gp_l1_reg_loss: 77209.6577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70700.7217; train_chrom_access_recon_loss: 5799564.0954; train_global_loss: 20015605.5115; train_optim_loss: 20015605.5115; val_kl_reg_loss: 67222.1943; val_edge_recon_loss: 2659030.5000; val_gene_expr_recon_loss: 11343643.4667; val_masked_gp_l1_reg_loss: 77161.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70956.7422; val_chrom_access_recon_loss: 5925717.2667; val_global_loss: 20143731.3333; val_optim_loss: 20143731.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9706; val_auprc_score: 0.9611; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 67667.8747; train_edge_recon_loss: 2678170.6584; train_gene_expr_recon_loss: 11310605.4275; train_masked_gp_l1_reg_loss: 77040.2411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70760.6037; train_chrom_access_recon_loss: 5792755.4618; train_global_loss: 19997000.1985; train_optim_loss: 19997000.1985; val_kl_reg_loss: 66936.3240; val_edge_recon_loss: 2684313.7500; val_gene_expr_recon_loss: 11357822.6000; val_masked_gp_l1_reg_loss: 77006.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70921.8281; val_chrom_access_recon_loss: 5909655.8667; val_global_loss: 20166656.6667; val_optim_loss: 20166656.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9722; val_auprc_score: 0.9623; val_best_acc_score: 0.9212; val_best_f1_score: 0.9239; train_kl_reg_loss: 67213.6486; train_edge_recon_loss: 2681757.5382; train_gene_expr_recon_loss: 11288200.0000; train_masked_gp_l1_reg_loss: 77012.1538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70820.8241; train_chrom_access_recon_loss: 5779599.7595; train_global_loss: 19964604.0153; train_optim_loss: 19964604.0153; val_kl_reg_loss: 67517.9669; val_edge_recon_loss: 2702987.1500; val_gene_expr_recon_loss: 11363125.4667; val_masked_gp_l1_reg_loss: 76914.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70903.8047; val_chrom_access_recon_loss: 5922205.0000; val_global_loss: 20203654.6667; val_optim_loss: 20203654.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9750; val_auprc_score: 0.9693; val_best_acc_score: 0.9283; val_best_f1_score: 0.9309; train_kl_reg_loss: 65632.1849; train_edge_recon_loss: 2681213.0363; train_gene_expr_recon_loss: 11288291.2366; train_masked_gp_l1_reg_loss: 76960.7476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70753.3791; train_chrom_access_recon_loss: 5780174.5191; train_global_loss: 19963025.0534; train_optim_loss: 19963025.0534; val_kl_reg_loss: 66751.2805; val_edge_recon_loss: 2692366.3000; val_gene_expr_recon_loss: 11351390.1333; val_masked_gp_l1_reg_loss: 77150.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70943.2422; val_chrom_access_recon_loss: 5923447.9667; val_global_loss: 20182048.6667; val_optim_loss: 20182048.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9727; val_auprc_score: 0.9620; val_best_acc_score: 0.9293; val_best_f1_score: 0.9319; train_kl_reg_loss: 66643.7353; train_edge_recon_loss: 2674600.3263; train_gene_expr_recon_loss: 11271655.2366; train_masked_gp_l1_reg_loss: 76911.2443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70665.6326; train_chrom_access_recon_loss: 5764974.9389; train_global_loss: 19925451.1145; train_optim_loss: 19925451.1145; val_kl_reg_loss: 69647.7625; val_edge_recon_loss: 2683033.2000; val_gene_expr_recon_loss: 11307562.4667; val_masked_gp_l1_reg_loss: 76760.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70513.7266; val_chrom_access_recon_loss: 5901268.5667; val_global_loss: 20108785.6000; val_optim_loss: 20108785.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9735; val_auprc_score: 0.9668; val_best_acc_score: 0.9275; val_best_f1_score: 0.9303; train_kl_reg_loss: 66613.9298; train_edge_recon_loss: 2674240.3225; train_gene_expr_recon_loss: 11265478.3435; train_masked_gp_l1_reg_loss: 76751.9589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70814.2512; train_chrom_access_recon_loss: 5754746.1031; train_global_loss: 19908644.8702; train_optim_loss: 19908644.8702; val_kl_reg_loss: 68412.3188; val_edge_recon_loss: 2684291.9500; val_gene_expr_recon_loss: 11305865.0000; val_masked_gp_l1_reg_loss: 76742.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71244.9609; val_chrom_access_recon_loss: 5887114.1333; val_global_loss: 20093671.3333; val_optim_loss: 20093671.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9789; val_auprc_score: 0.9744; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 65258.4707; train_edge_recon_loss: 2673804.3569; train_gene_expr_recon_loss: 11253931.5344; train_masked_gp_l1_reg_loss: 76605.3434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71084.1566; train_chrom_access_recon_loss: 5748380.8015; train_global_loss: 19889064.6718; train_optim_loss: 19889064.6718; val_kl_reg_loss: 64487.5956; val_edge_recon_loss: 2687543.6500; val_gene_expr_recon_loss: 11286312.9333; val_masked_gp_l1_reg_loss: 76456.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70800.0391; val_chrom_access_recon_loss: 5878425.5667; val_global_loss: 20064026.9333; val_optim_loss: 20064026.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9795; val_auprc_score: 0.9737; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 64666.5236; train_edge_recon_loss: 2673550.5553; train_gene_expr_recon_loss: 11252515.7099; train_masked_gp_l1_reg_loss: 76449.9507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71057.5106; train_chrom_access_recon_loss: 5741847.6756; train_global_loss: 19880087.8473; train_optim_loss: 19880087.8473; val_kl_reg_loss: 63933.7943; val_edge_recon_loss: 2681190.1500; val_gene_expr_recon_loss: 11280051.2667; val_masked_gp_l1_reg_loss: 76449.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71375.7500; val_chrom_access_recon_loss: 5857596.0333; val_global_loss: 20030597.3333; val_optim_loss: 20030597.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9794; val_auprc_score: 0.9700; val_best_acc_score: 0.9378; val_best_f1_score: 0.9391; train_kl_reg_loss: 64427.6311; train_edge_recon_loss: 2668711.7443; train_gene_expr_recon_loss: 11242027.4046; train_masked_gp_l1_reg_loss: 76410.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71245.1984; train_chrom_access_recon_loss: 5733640.5000; train_global_loss: 19856462.7023; train_optim_loss: 19856462.7023; val_kl_reg_loss: 63264.9424; val_edge_recon_loss: 2675297.1500; val_gene_expr_recon_loss: 11284392.4667; val_masked_gp_l1_reg_loss: 76276.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71392.8359; val_chrom_access_recon_loss: 5873855.0667; val_global_loss: 20044478.6667; val_optim_loss: 20044478.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9795; val_auprc_score: 0.9721; val_best_acc_score: 0.9386; val_best_f1_score: 0.9403; train_kl_reg_loss: 64512.9894; train_edge_recon_loss: 2666270.5935; train_gene_expr_recon_loss: 11221847.8092; train_masked_gp_l1_reg_loss: 76266.4299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71329.3340; train_chrom_access_recon_loss: 5713829.0840; train_global_loss: 19814056.2290; train_optim_loss: 19814056.2290; val_kl_reg_loss: 68874.3599; val_edge_recon_loss: 2673000.4000; val_gene_expr_recon_loss: 11297443.8000; val_masked_gp_l1_reg_loss: 76208.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71386.5156; val_chrom_access_recon_loss: 5891758.3667; val_global_loss: 20078673.2000; val_optim_loss: 20078673.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9792; val_auprc_score: 0.9736; val_best_acc_score: 0.9386; val_best_f1_score: 0.9397; train_kl_reg_loss: 65620.6787; train_edge_recon_loss: 2665548.7844; train_gene_expr_recon_loss: 11222562.0687; train_masked_gp_l1_reg_loss: 75988.9834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71354.1230; train_chrom_access_recon_loss: 5713727.2481; train_global_loss: 19814801.9389; train_optim_loss: 19814801.9389; val_kl_reg_loss: 65277.5893; val_edge_recon_loss: 2667070.6000; val_gene_expr_recon_loss: 11223465.3333; val_masked_gp_l1_reg_loss: 75676.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71386.2891; val_chrom_access_recon_loss: 5847723.6333; val_global_loss: 19950600.1333; val_optim_loss: 19950600.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9774; val_auprc_score: 0.9681; val_best_acc_score: 0.9345; val_best_f1_score: 0.9365; train_kl_reg_loss: 64543.3613; train_edge_recon_loss: 2660169.7176; train_gene_expr_recon_loss: 11220189.3893; train_masked_gp_l1_reg_loss: 75716.0126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71525.7982; train_chrom_access_recon_loss: 5708704.6450; train_global_loss: 19800848.8702; train_optim_loss: 19800848.8702; val_kl_reg_loss: 62967.1654; val_edge_recon_loss: 2690187.4667; val_gene_expr_recon_loss: 11278092.0667; val_masked_gp_l1_reg_loss: 75723.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72020.8125; val_chrom_access_recon_loss: 5881116.9333; val_global_loss: 20060108.5333; val_optim_loss: 20060108.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9774; val_auprc_score: 0.9688; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 65389.5769; train_edge_recon_loss: 2657716.4676; train_gene_expr_recon_loss: 11207714.2214; train_masked_gp_l1_reg_loss: 75559.4135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71907.4448; train_chrom_access_recon_loss: 5694402.4504; train_global_loss: 19772689.4962; train_optim_loss: 19772689.4962; val_kl_reg_loss: 65263.6281; val_edge_recon_loss: 2681829.6500; val_gene_expr_recon_loss: 11292692.6000; val_masked_gp_l1_reg_loss: 75450.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72266.9062; val_chrom_access_recon_loss: 5883453.6667; val_global_loss: 20070957.4667; val_optim_loss: 20070957.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9816; val_auprc_score: 0.9744; val_best_acc_score: 0.9453; val_best_f1_score: 0.9464; train_kl_reg_loss: 64059.0686; train_edge_recon_loss: 2663533.0305; train_gene_expr_recon_loss: 11205390.2214; train_masked_gp_l1_reg_loss: 75288.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72245.6458; train_chrom_access_recon_loss: 5693947.4847; train_global_loss: 19774464.1069; train_optim_loss: 19774464.1069; val_kl_reg_loss: 64716.4906; val_edge_recon_loss: 2680409.0167; val_gene_expr_recon_loss: 11275096.2667; val_masked_gp_l1_reg_loss: 75232.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72408.9766; val_chrom_access_recon_loss: 5869473.3667; val_global_loss: 20037336.4000; val_optim_loss: 20037336.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9814; val_auprc_score: 0.9748; val_best_acc_score: 0.9438; val_best_f1_score: 0.9448; train_kl_reg_loss: 64104.5070; train_edge_recon_loss: 2658318.9637; train_gene_expr_recon_loss: 11185519.8168; train_masked_gp_l1_reg_loss: 75074.0650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72438.5607; train_chrom_access_recon_loss: 5676732.3359; train_global_loss: 19732188.1679; train_optim_loss: 19732188.1679; val_kl_reg_loss: 62236.1659; val_edge_recon_loss: 2661699.0500; val_gene_expr_recon_loss: 11277240.9333; val_masked_gp_l1_reg_loss: 74913.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72528.1875; val_chrom_access_recon_loss: 5894922.2667; val_global_loss: 20043540.4000; val_optim_loss: 20043540.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9830; val_auprc_score: 0.9789; val_best_acc_score: 0.9426; val_best_f1_score: 0.9443; train_kl_reg_loss: 64292.9155; train_edge_recon_loss: 2662840.2233; train_gene_expr_recon_loss: 11172248.8168; train_masked_gp_l1_reg_loss: 73892.9567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57218.6045; train_chrom_access_recon_loss: 5667635.4542; train_global_loss: 19698128.9771; train_optim_loss: 19698128.9771; val_kl_reg_loss: 65584.6982; val_edge_recon_loss: 2670268.2000; val_gene_expr_recon_loss: 11261942.8667; val_masked_gp_l1_reg_loss: 73501.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55147.2734; val_chrom_access_recon_loss: 5845109.0333; val_global_loss: 19971552.8000; val_optim_loss: 19971552.8000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9816; val_auprc_score: 0.9743; val_best_acc_score: 0.9458; val_best_f1_score: 0.9473; train_kl_reg_loss: 65662.2883; train_edge_recon_loss: 2658209.3149; train_gene_expr_recon_loss: 11183153.2137; train_masked_gp_l1_reg_loss: 73437.8697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54744.1503; train_chrom_access_recon_loss: 5668838.4046; train_global_loss: 19704045.2214; train_optim_loss: 19704045.2214; val_kl_reg_loss: 66373.7784; val_edge_recon_loss: 2664514.2333; val_gene_expr_recon_loss: 11261761.4000; val_masked_gp_l1_reg_loss: 73378.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54449.9961; val_chrom_access_recon_loss: 5851188.3667; val_global_loss: 19971666.0000; val_optim_loss: 19971666.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9804; val_auprc_score: 0.9753; val_best_acc_score: 0.9402; val_best_f1_score: 0.9421; train_kl_reg_loss: 66074.4401; train_edge_recon_loss: 2660193.1603; train_gene_expr_recon_loss: 11175046.6641; train_masked_gp_l1_reg_loss: 73356.2094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54237.3670; train_chrom_access_recon_loss: 5661340.8282; train_global_loss: 19690248.7786; train_optim_loss: 19690248.7786; val_kl_reg_loss: 67079.6771; val_edge_recon_loss: 2670546.6500; val_gene_expr_recon_loss: 11236844.5333; val_masked_gp_l1_reg_loss: 73301.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54007.7656; val_chrom_access_recon_loss: 5851882.2000; val_global_loss: 19953661.7333; val_optim_loss: 19953661.7333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9772; val_auprc_score: 0.9656; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 66656.7313; train_edge_recon_loss: 2661872.3149; train_gene_expr_recon_loss: 11192328.5115; train_masked_gp_l1_reg_loss: 73274.8241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53818.0687; train_chrom_access_recon_loss: 5669643.3664; train_global_loss: 19717593.7710; train_optim_loss: 19717593.7710; val_kl_reg_loss: 67378.6448; val_edge_recon_loss: 2669021.5000; val_gene_expr_recon_loss: 11221219.3333; val_masked_gp_l1_reg_loss: 73235.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53657.0234; val_chrom_access_recon_loss: 5851999.6667; val_global_loss: 19936511.2000; val_optim_loss: 19936511.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9791; val_auprc_score: 0.9703; val_best_acc_score: 0.9422; val_best_f1_score: 0.9439; train_kl_reg_loss: 66783.8502; train_edge_recon_loss: 2653634.9695; train_gene_expr_recon_loss: 11159971.9389; train_masked_gp_l1_reg_loss: 73213.5506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53460.7365; train_chrom_access_recon_loss: 5655105.4847; train_global_loss: 19662170.5954; train_optim_loss: 19662170.5954; val_kl_reg_loss: 66929.4529; val_edge_recon_loss: 2669334.5000; val_gene_expr_recon_loss: 11234647.4667; val_masked_gp_l1_reg_loss: 73175.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53285.7148; val_chrom_access_recon_loss: 5844059.5000; val_global_loss: 19941433.2000; val_optim_loss: 19941433.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9841; val_auprc_score: 0.9801; val_best_acc_score: 0.9453; val_best_f1_score: 0.9468; train_kl_reg_loss: 66722.2792; train_edge_recon_loss: 2651169.9962; train_gene_expr_recon_loss: 11172761.5725; train_masked_gp_l1_reg_loss: 73148.5499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53126.3043; train_chrom_access_recon_loss: 5662056.7214; train_global_loss: 19678985.4046; train_optim_loss: 19678985.4046; val_kl_reg_loss: 67212.8339; val_edge_recon_loss: 2657874.7167; val_gene_expr_recon_loss: 11209864.8667; val_masked_gp_l1_reg_loss: 73114.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52993.3047; val_chrom_access_recon_loss: 5808068.6000; val_global_loss: 19869128.2667; val_optim_loss: 19869128.2667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9802; val_auprc_score: 0.9727; val_best_acc_score: 0.9418; val_best_f1_score: 0.9432; train_kl_reg_loss: 67080.9300; train_edge_recon_loss: 2659754.5324; train_gene_expr_recon_loss: 11172237.4198; train_masked_gp_l1_reg_loss: 73106.2268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52854.5279; train_chrom_access_recon_loss: 5658213.1870; train_global_loss: 19683246.8244; train_optim_loss: 19683246.8244; val_kl_reg_loss: 66909.0839; val_edge_recon_loss: 2674518.8000; val_gene_expr_recon_loss: 11245137.2667; val_masked_gp_l1_reg_loss: 73073.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52720.8242; val_chrom_access_recon_loss: 5835479.7333; val_global_loss: 19947838.9333; val_optim_loss: 19947838.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9815; val_auprc_score: 0.9748; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 66590.2556; train_edge_recon_loss: 2655451.1527; train_gene_expr_recon_loss: 11168076.0840; train_masked_gp_l1_reg_loss: 73050.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52599.9655; train_chrom_access_recon_loss: 5662967.7061; train_global_loss: 19678735.8015; train_optim_loss: 19678735.8015; val_kl_reg_loss: 66527.0646; val_edge_recon_loss: 2680957.6833; val_gene_expr_recon_loss: 11232323.0000; val_masked_gp_l1_reg_loss: 73029.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52497.0195; val_chrom_access_recon_loss: 5812074.4667; val_global_loss: 19917408.2667; val_optim_loss: 19917408.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9808; val_auprc_score: 0.9735; val_best_acc_score: 0.9435; val_best_f1_score: 0.9453; train_kl_reg_loss: 66777.1800; train_edge_recon_loss: 2656328.5229; train_gene_expr_recon_loss: 11167444.9695; train_masked_gp_l1_reg_loss: 73021.3139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52406.7936; train_chrom_access_recon_loss: 5659857.7137; train_global_loss: 19675836.5649; train_optim_loss: 19675836.5649; val_kl_reg_loss: 67408.7799; val_edge_recon_loss: 2670830.6333; val_gene_expr_recon_loss: 11278333.4667; val_masked_gp_l1_reg_loss: 72991.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52264.9766; val_chrom_access_recon_loss: 5866243.0333; val_global_loss: 20008073.2000; val_optim_loss: 20008073.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9816; val_auprc_score: 0.9753; val_best_acc_score: 0.9433; val_best_f1_score: 0.9450; train_kl_reg_loss: 66766.9136; train_edge_recon_loss: 2653711.6279; train_gene_expr_recon_loss: 11168632.0153; train_masked_gp_l1_reg_loss: 72976.8500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52156.2816; train_chrom_access_recon_loss: 5657032.8053; train_global_loss: 19671276.5344; train_optim_loss: 19671276.5344; val_kl_reg_loss: 66859.0555; val_edge_recon_loss: 2666285.9333; val_gene_expr_recon_loss: 11236065.0000; val_masked_gp_l1_reg_loss: 72958.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52101.0859; val_chrom_access_recon_loss: 5845804.0333; val_global_loss: 19940073.8667; val_optim_loss: 19940073.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9816; val_auprc_score: 0.9764; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 66685.9724; train_edge_recon_loss: 2660302.5267; train_gene_expr_recon_loss: 11166919.8626; train_masked_gp_l1_reg_loss: 72843.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50539.6539; train_chrom_access_recon_loss: 5649507.6298; train_global_loss: 19666799.1145; train_optim_loss: 19666799.1145; val_kl_reg_loss: 66957.4362; val_edge_recon_loss: 2682818.1500; val_gene_expr_recon_loss: 11289928.4667; val_masked_gp_l1_reg_loss: 72792.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50326.6562; val_chrom_access_recon_loss: 5854229.8000; val_global_loss: 20017052.6667; val_optim_loss: 20017052.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9831; val_auprc_score: 0.9740; val_best_acc_score: 0.9472; val_best_f1_score: 0.9488; train_kl_reg_loss: 66871.5870; train_edge_recon_loss: 2655770.1927; train_gene_expr_recon_loss: 11165837.9084; train_masked_gp_l1_reg_loss: 72777.3358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50279.3136; train_chrom_access_recon_loss: 5649110.3779; train_global_loss: 19660646.7634; train_optim_loss: 19660646.7634; val_kl_reg_loss: 66996.2375; val_edge_recon_loss: 2680800.1833; val_gene_expr_recon_loss: 11201682.4667; val_masked_gp_l1_reg_loss: 72762.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50238.8477; val_chrom_access_recon_loss: 5819696.0000; val_global_loss: 19892177.2000; val_optim_loss: 19892177.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9830; val_auprc_score: 0.9790; val_best_acc_score: 0.9438; val_best_f1_score: 0.9455; train_kl_reg_loss: 66762.2863; train_edge_recon_loss: 2655506.5019; train_gene_expr_recon_loss: 11177811.7786; train_masked_gp_l1_reg_loss: 72755.7033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50202.0252; train_chrom_access_recon_loss: 5663559.1603; train_global_loss: 19686597.5115; train_optim_loss: 19686597.5115; val_kl_reg_loss: 67022.7776; val_edge_recon_loss: 2674969.0333; val_gene_expr_recon_loss: 11212291.8000; val_masked_gp_l1_reg_loss: 72748.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50175.6328; val_chrom_access_recon_loss: 5839518.8000; val_global_loss: 19916726.5333; val_optim_loss: 19916726.5333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9841; val_auprc_score: 0.9766; val_best_acc_score: 0.9469; val_best_f1_score: 0.9479; train_kl_reg_loss: 66797.4001; train_edge_recon_loss: 2655668.4599; train_gene_expr_recon_loss: 11168009.8855; train_masked_gp_l1_reg_loss: 72747.2551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50147.1994; train_chrom_access_recon_loss: 5650976.8969; train_global_loss: 19664346.9771; train_optim_loss: 19664346.9771; val_kl_reg_loss: 67275.3695; val_edge_recon_loss: 2662623.8667; val_gene_expr_recon_loss: 11225679.0667; val_masked_gp_l1_reg_loss: 72742.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50122.4844; val_chrom_access_recon_loss: 5851157.7000; val_global_loss: 19929600.9333; val_optim_loss: 19929600.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 12 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9821
val AUPRC score: 0.9769
val best accuracy score: 0.9453
val best F1 score: 0.9468
val target rna MSE score: 1.1968
val source rna MSE score: 0.4468
val target atac MSE score: 0.3542
val source atac MSE score: 0.1023
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
