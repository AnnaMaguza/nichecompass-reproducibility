[True]
Run timestamp: 07092023_191126_85.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_85']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1133 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5654, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1133

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7862; val_auprc_score: 0.7984; val_best_acc_score: 0.5226; val_best_f1_score: 0.6760; train_kl_reg_loss: 83286.8796; train_edge_recon_loss: 3542270.4618; train_gene_expr_recon_loss: 28241808.2748; train_masked_gp_l1_reg_loss: 96953.9009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1337971.8640; train_chrom_access_recon_loss: 6625391.9313; train_global_loss: 39927682.9924; train_optim_loss: 39927682.9924; val_kl_reg_loss: 101327.6568; val_edge_recon_loss: 4063746.8667; val_gene_expr_recon_loss: 25840232.5333; val_masked_gp_l1_reg_loss: 87427.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 884154.8750; val_chrom_access_recon_loss: 6347482.8667; val_global_loss: 37324372.0000; val_optim_loss: 37324372.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8276; val_auprc_score: 0.8333; val_best_acc_score: 0.6380; val_best_f1_score: 0.7267; train_kl_reg_loss: 110211.5461; train_edge_recon_loss: 3528939.0935; train_gene_expr_recon_loss: 25904879.1450; train_masked_gp_l1_reg_loss: 83513.6898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 605423.5730; train_chrom_access_recon_loss: 6327725.3053; train_global_loss: 36560692.3053; train_optim_loss: 36560692.3053; val_kl_reg_loss: 104738.1635; val_edge_recon_loss: 4055929.7000; val_gene_expr_recon_loss: 25414248.1333; val_masked_gp_l1_reg_loss: 82579.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 402488.2188; val_chrom_access_recon_loss: 6248240.1667; val_global_loss: 36308224.2667; val_optim_loss: 36308224.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8734; val_auprc_score: 0.8689; val_best_acc_score: 0.7696; val_best_f1_score: 0.7865; train_kl_reg_loss: 92921.5346; train_edge_recon_loss: 3509679.7786; train_gene_expr_recon_loss: 25513486.7481; train_masked_gp_l1_reg_loss: 84684.1397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 301653.4820; train_chrom_access_recon_loss: 6245958.6260; train_global_loss: 35748384.3053; train_optim_loss: 35748384.3053; val_kl_reg_loss: 86675.5016; val_edge_recon_loss: 3883539.3833; val_gene_expr_recon_loss: 25000998.2667; val_masked_gp_l1_reg_loss: 87403.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228771.7031; val_chrom_access_recon_loss: 6192681.1333; val_global_loss: 35480070.9333; val_optim_loss: 35480070.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8741; val_auprc_score: 0.8620; val_best_acc_score: 0.7739; val_best_f1_score: 0.7969; train_kl_reg_loss: 79495.2531; train_edge_recon_loss: 3244758.3034; train_gene_expr_recon_loss: 25221004.6718; train_masked_gp_l1_reg_loss: 91817.2386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188687.0960; train_chrom_access_recon_loss: 6178830.5763; train_global_loss: 35004592.8550; train_optim_loss: 35004592.8550; val_kl_reg_loss: 103083.9036; val_edge_recon_loss: 2977994.6167; val_gene_expr_recon_loss: 24866967.4667; val_masked_gp_l1_reg_loss: 97435.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155754.4375; val_chrom_access_recon_loss: 6116340.1333; val_global_loss: 34317576.5333; val_optim_loss: 34317576.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8874; val_auprc_score: 0.8779; val_best_acc_score: 0.7902; val_best_f1_score: 0.8064; train_kl_reg_loss: 109042.5376; train_edge_recon_loss: 2961111.8321; train_gene_expr_recon_loss: 24983675.6947; train_masked_gp_l1_reg_loss: 98363.1783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133771.8029; train_chrom_access_recon_loss: 6123483.4809; train_global_loss: 34409448.6565; train_optim_loss: 34409448.6565; val_kl_reg_loss: 101181.7422; val_edge_recon_loss: 2966754.0167; val_gene_expr_recon_loss: 24539496.2667; val_masked_gp_l1_reg_loss: 99727.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115911.1953; val_chrom_access_recon_loss: 6067210.2333; val_global_loss: 33890282.6667; val_optim_loss: 33890282.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9006; val_auprc_score: 0.8904; val_best_acc_score: 0.8011; val_best_f1_score: 0.8214; train_kl_reg_loss: 107333.0766; train_edge_recon_loss: 2936703.2156; train_gene_expr_recon_loss: 24747769.5420; train_masked_gp_l1_reg_loss: 101652.4911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103907.8921; train_chrom_access_recon_loss: 6065778.2290; train_global_loss: 34063144.5954; train_optim_loss: 34063144.5954; val_kl_reg_loss: 98375.0068; val_edge_recon_loss: 2951438.1167; val_gene_expr_recon_loss: 24448794.9333; val_masked_gp_l1_reg_loss: 103508.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94538.9375; val_chrom_access_recon_loss: 6045881.8333; val_global_loss: 33742535.6000; val_optim_loss: 33742535.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9166; val_auprc_score: 0.9067; val_best_acc_score: 0.8267; val_best_f1_score: 0.8385; train_kl_reg_loss: 101584.4668; train_edge_recon_loss: 2898914.1813; train_gene_expr_recon_loss: 24565815.0534; train_masked_gp_l1_reg_loss: 105151.2671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87607.8690; train_chrom_access_recon_loss: 6018264.4275; train_global_loss: 33777337.1145; train_optim_loss: 33777337.1145; val_kl_reg_loss: 99522.7812; val_edge_recon_loss: 2874779.2833; val_gene_expr_recon_loss: 24159335.7333; val_masked_gp_l1_reg_loss: 106569.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81951.2422; val_chrom_access_recon_loss: 5951419.5000; val_global_loss: 33273578.9333; val_optim_loss: 33273578.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9197; val_auprc_score: 0.9047; val_best_acc_score: 0.8469; val_best_f1_score: 0.8576; train_kl_reg_loss: 100219.7412; train_edge_recon_loss: 2858620.0534; train_gene_expr_recon_loss: 24389073.0382; train_masked_gp_l1_reg_loss: 108104.8281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78501.1549; train_chrom_access_recon_loss: 5972869.7710; train_global_loss: 33507388.5496; train_optim_loss: 33507388.5496; val_kl_reg_loss: 99906.6151; val_edge_recon_loss: 2849821.2500; val_gene_expr_recon_loss: 24097404.1333; val_masked_gp_l1_reg_loss: 109558.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75860.9531; val_chrom_access_recon_loss: 5949707.2000; val_global_loss: 33182257.3333; val_optim_loss: 33182257.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9301; val_auprc_score: 0.9146; val_best_acc_score: 0.8597; val_best_f1_score: 0.8697; train_kl_reg_loss: 102494.2554; train_edge_recon_loss: 2821327.8817; train_gene_expr_recon_loss: 24241364.0611; train_masked_gp_l1_reg_loss: 110682.5921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73035.0010; train_chrom_access_recon_loss: 5937321.3931; train_global_loss: 33286225.0687; train_optim_loss: 33286225.0687; val_kl_reg_loss: 98708.6911; val_edge_recon_loss: 2819303.1167; val_gene_expr_recon_loss: 23966216.0000; val_masked_gp_l1_reg_loss: 112079.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71678.6328; val_chrom_access_recon_loss: 5898320.9000; val_global_loss: 32966306.6667; val_optim_loss: 32966306.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9419; val_auprc_score: 0.9306; val_best_acc_score: 0.8773; val_best_f1_score: 0.8828; train_kl_reg_loss: 101262.9808; train_edge_recon_loss: 2809141.7557; train_gene_expr_recon_loss: 24119876.9771; train_masked_gp_l1_reg_loss: 113137.9433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69227.5999; train_chrom_access_recon_loss: 5906150.7824; train_global_loss: 33118798.1069; train_optim_loss: 33118798.1069; val_kl_reg_loss: 102219.5760; val_edge_recon_loss: 2768529.5333; val_gene_expr_recon_loss: 23655271.4667; val_masked_gp_l1_reg_loss: 113874.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66534.0781; val_chrom_access_recon_loss: 5849654.6000; val_global_loss: 32556082.9333; val_optim_loss: 32556082.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9446; val_auprc_score: 0.9332; val_best_acc_score: 0.8805; val_best_f1_score: 0.8877; train_kl_reg_loss: 100055.5927; train_edge_recon_loss: 2788045.9866; train_gene_expr_recon_loss: 24011536.4733; train_masked_gp_l1_reg_loss: 114964.0295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65388.5242; train_chrom_access_recon_loss: 5871299.3359; train_global_loss: 32951289.9847; train_optim_loss: 32951289.9847; val_kl_reg_loss: 100896.3266; val_edge_recon_loss: 2783478.3000; val_gene_expr_recon_loss: 23705947.2000; val_masked_gp_l1_reg_loss: 115847.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64095.3008; val_chrom_access_recon_loss: 5831824.6333; val_global_loss: 32602090.8000; val_optim_loss: 32602090.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9470; val_auprc_score: 0.9367; val_best_acc_score: 0.8806; val_best_f1_score: 0.8864; train_kl_reg_loss: 97665.2569; train_edge_recon_loss: 2768840.1279; train_gene_expr_recon_loss: 23873595.8015; train_masked_gp_l1_reg_loss: 116810.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62660.1984; train_chrom_access_recon_loss: 5838383.2328; train_global_loss: 32757955.0992; train_optim_loss: 32757955.0992; val_kl_reg_loss: 96620.0891; val_edge_recon_loss: 2776756.8667; val_gene_expr_recon_loss: 23576313.2000; val_masked_gp_l1_reg_loss: 117809.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61739.2891; val_chrom_access_recon_loss: 5806756.7333; val_global_loss: 32435997.3333; val_optim_loss: 32435997.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9493; val_auprc_score: 0.9343; val_best_acc_score: 0.8937; val_best_f1_score: 0.8972; train_kl_reg_loss: 96640.0132; train_edge_recon_loss: 2759789.2557; train_gene_expr_recon_loss: 23789528.7176; train_masked_gp_l1_reg_loss: 118530.7838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60335.6523; train_chrom_access_recon_loss: 5816642.4466; train_global_loss: 32641466.8855; train_optim_loss: 32641466.8855; val_kl_reg_loss: 97993.6682; val_edge_recon_loss: 2758264.8833; val_gene_expr_recon_loss: 23590444.8000; val_masked_gp_l1_reg_loss: 119459.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59224.1211; val_chrom_access_recon_loss: 5807293.4667; val_global_loss: 32432680.6667; val_optim_loss: 32432680.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9543; val_auprc_score: 0.9408; val_best_acc_score: 0.8988; val_best_f1_score: 0.9036; train_kl_reg_loss: 94887.5342; train_edge_recon_loss: 2753967.8626; train_gene_expr_recon_loss: 23694219.6947; train_masked_gp_l1_reg_loss: 120287.5734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58394.8163; train_chrom_access_recon_loss: 5792290.0344; train_global_loss: 32514047.5267; train_optim_loss: 32514047.5267; val_kl_reg_loss: 93871.8464; val_edge_recon_loss: 2751020.9333; val_gene_expr_recon_loss: 23398568.1333; val_masked_gp_l1_reg_loss: 121206.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57962.9375; val_chrom_access_recon_loss: 5747314.4333; val_global_loss: 32169943.3333; val_optim_loss: 32169943.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9579; val_auprc_score: 0.9472; val_best_acc_score: 0.8988; val_best_f1_score: 0.9037; train_kl_reg_loss: 94620.2084; train_edge_recon_loss: 2740898.9809; train_gene_expr_recon_loss: 23606774.4275; train_masked_gp_l1_reg_loss: 121865.5499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56756.7402; train_chrom_access_recon_loss: 5768325.1260; train_global_loss: 32389240.9771; train_optim_loss: 32389240.9771; val_kl_reg_loss: 93747.2021; val_edge_recon_loss: 2731211.7167; val_gene_expr_recon_loss: 23381252.1333; val_masked_gp_l1_reg_loss: 122718.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56466.4492; val_chrom_access_recon_loss: 5738732.8000; val_global_loss: 32124127.8667; val_optim_loss: 32124127.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9631; val_auprc_score: 0.9550; val_best_acc_score: 0.9020; val_best_f1_score: 0.9043; train_kl_reg_loss: 92662.7959; train_edge_recon_loss: 2730217.9408; train_gene_expr_recon_loss: 23517527.2519; train_masked_gp_l1_reg_loss: 123347.0877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55417.0544; train_chrom_access_recon_loss: 5740857.9122; train_global_loss: 32260029.8779; train_optim_loss: 32260029.8779; val_kl_reg_loss: 92368.9130; val_edge_recon_loss: 2742616.9833; val_gene_expr_recon_loss: 23264194.6667; val_masked_gp_l1_reg_loss: 124151.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54649.2305; val_chrom_access_recon_loss: 5721705.5333; val_global_loss: 31999688.0000; val_optim_loss: 31999688.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9618; val_auprc_score: 0.9509; val_best_acc_score: 0.9025; val_best_f1_score: 0.9069; train_kl_reg_loss: 92447.0003; train_edge_recon_loss: 2728949.0534; train_gene_expr_recon_loss: 23481546.9160; train_masked_gp_l1_reg_loss: 124780.6177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54319.7818; train_chrom_access_recon_loss: 5735360.5992; train_global_loss: 32217404.0611; train_optim_loss: 32217404.0611; val_kl_reg_loss: 91056.9490; val_edge_recon_loss: 2736278.9000; val_gene_expr_recon_loss: 23236430.0000; val_masked_gp_l1_reg_loss: 125358.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53592.5547; val_chrom_access_recon_loss: 5698693.7333; val_global_loss: 31941409.7333; val_optim_loss: 31941409.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9648; val_auprc_score: 0.9518; val_best_acc_score: 0.9140; val_best_f1_score: 0.9163; train_kl_reg_loss: 90875.7696; train_edge_recon_loss: 2726232.3416; train_gene_expr_recon_loss: 23403390.1832; train_masked_gp_l1_reg_loss: 126088.3551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53484.6646; train_chrom_access_recon_loss: 5714568.2939; train_global_loss: 32114639.4198; train_optim_loss: 32114639.4198; val_kl_reg_loss: 90679.2714; val_edge_recon_loss: 2723493.8500; val_gene_expr_recon_loss: 23046053.7333; val_masked_gp_l1_reg_loss: 126630.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53158.8125; val_chrom_access_recon_loss: 5661008.0333; val_global_loss: 31701022.6667; val_optim_loss: 31701022.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9706; val_auprc_score: 0.9639; val_best_acc_score: 0.9159; val_best_f1_score: 0.9180; train_kl_reg_loss: 90808.5932; train_edge_recon_loss: 2715350.2958; train_gene_expr_recon_loss: 23322613.8931; train_masked_gp_l1_reg_loss: 127290.1081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52602.3250; train_chrom_access_recon_loss: 5685564.5878; train_global_loss: 31994229.6031; train_optim_loss: 31994229.6031; val_kl_reg_loss: 89329.5203; val_edge_recon_loss: 2702371.8000; val_gene_expr_recon_loss: 23099073.2000; val_masked_gp_l1_reg_loss: 128090.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52530.7969; val_chrom_access_recon_loss: 5673334.7333; val_global_loss: 31744729.2000; val_optim_loss: 31744729.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9690; val_auprc_score: 0.9613; val_best_acc_score: 0.9165; val_best_f1_score: 0.9201; train_kl_reg_loss: 89941.7474; train_edge_recon_loss: 2714290.4962; train_gene_expr_recon_loss: 23269054.2595; train_masked_gp_l1_reg_loss: 128472.9977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52100.5569; train_chrom_access_recon_loss: 5678506.9427; train_global_loss: 31932366.8855; train_optim_loss: 31932366.8855; val_kl_reg_loss: 89212.0437; val_edge_recon_loss: 2709883.0833; val_gene_expr_recon_loss: 23034357.0667; val_masked_gp_l1_reg_loss: 129050.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52018.9219; val_chrom_access_recon_loss: 5645333.8667; val_global_loss: 31659854.1333; val_optim_loss: 31659854.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9680; val_auprc_score: 0.9583; val_best_acc_score: 0.9144; val_best_f1_score: 0.9189; train_kl_reg_loss: 88243.8078; train_edge_recon_loss: 2715836.0134; train_gene_expr_recon_loss: 23227140.7176; train_masked_gp_l1_reg_loss: 129562.9679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51732.7206; train_chrom_access_recon_loss: 5664160.4122; train_global_loss: 31876676.9008; train_optim_loss: 31876676.9008; val_kl_reg_loss: 87450.2844; val_edge_recon_loss: 2707947.9500; val_gene_expr_recon_loss: 22976825.8667; val_masked_gp_l1_reg_loss: 130242.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52068.7266; val_chrom_access_recon_loss: 5652220.8000; val_global_loss: 31606755.0667; val_optim_loss: 31606755.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9718; val_auprc_score: 0.9643; val_best_acc_score: 0.9212; val_best_f1_score: 0.9254; train_kl_reg_loss: 88129.4132; train_edge_recon_loss: 2702700.7882; train_gene_expr_recon_loss: 23176544.8397; train_masked_gp_l1_reg_loss: 130707.2183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51667.2938; train_chrom_access_recon_loss: 5650031.5344; train_global_loss: 31799781.2214; train_optim_loss: 31799781.2214; val_kl_reg_loss: 88362.9349; val_edge_recon_loss: 2701927.7333; val_gene_expr_recon_loss: 23075230.5333; val_masked_gp_l1_reg_loss: 131422.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52112.6953; val_chrom_access_recon_loss: 5660998.3000; val_global_loss: 31710053.6000; val_optim_loss: 31710053.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9692; val_auprc_score: 0.9603; val_best_acc_score: 0.9173; val_best_f1_score: 0.9210; train_kl_reg_loss: 87701.3663; train_edge_recon_loss: 2698947.0305; train_gene_expr_recon_loss: 23115009.3130; train_masked_gp_l1_reg_loss: 131755.7075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51790.7017; train_chrom_access_recon_loss: 5636503.5687; train_global_loss: 31721707.8779; train_optim_loss: 31721707.8779; val_kl_reg_loss: 86970.6198; val_edge_recon_loss: 2715833.7000; val_gene_expr_recon_loss: 22918408.6667; val_masked_gp_l1_reg_loss: 132202.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51853.4102; val_chrom_access_recon_loss: 5611976.6667; val_global_loss: 31517245.7333; val_optim_loss: 31517245.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9733; val_auprc_score: 0.9644; val_best_acc_score: 0.9282; val_best_f1_score: 0.9303; train_kl_reg_loss: 86997.4789; train_edge_recon_loss: 2701140.5248; train_gene_expr_recon_loss: 23082922.8550; train_masked_gp_l1_reg_loss: 132793.5837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51841.6936; train_chrom_access_recon_loss: 5628259.1908; train_global_loss: 31683955.1298; train_optim_loss: 31683955.1298; val_kl_reg_loss: 85827.5651; val_edge_recon_loss: 2704829.7500; val_gene_expr_recon_loss: 22790100.2667; val_masked_gp_l1_reg_loss: 133265.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51845.9414; val_chrom_access_recon_loss: 5602852.5333; val_global_loss: 31368722.1333; val_optim_loss: 31368722.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9708; val_auprc_score: 0.9613; val_best_acc_score: 0.9190; val_best_f1_score: 0.9215; train_kl_reg_loss: 86524.5564; train_edge_recon_loss: 2700475.9275; train_gene_expr_recon_loss: 23046263.7863; train_masked_gp_l1_reg_loss: 133770.8302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51912.1628; train_chrom_access_recon_loss: 5614855.8779; train_global_loss: 31633803.1450; train_optim_loss: 31633803.1450; val_kl_reg_loss: 85202.2224; val_edge_recon_loss: 2731876.1167; val_gene_expr_recon_loss: 22834880.2667; val_masked_gp_l1_reg_loss: 134415.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52158.6914; val_chrom_access_recon_loss: 5633517.9333; val_global_loss: 31472050.5333; val_optim_loss: 31472050.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9745; val_auprc_score: 0.9683; val_best_acc_score: 0.9254; val_best_f1_score: 0.9286; train_kl_reg_loss: 92324.0280; train_edge_recon_loss: 2721911.8435; train_gene_expr_recon_loss: 22443947.5573; train_masked_gp_l1_reg_loss: 131584.7058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44140.8455; train_chrom_access_recon_loss: 5488606.4618; train_global_loss: 30922515.4656; train_optim_loss: 30922515.4656; val_kl_reg_loss: 60411.6867; val_edge_recon_loss: 2720545.4167; val_gene_expr_recon_loss: 22261557.2000; val_masked_gp_l1_reg_loss: 130574.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42560.8828; val_chrom_access_recon_loss: 5462159.2667; val_global_loss: 30677807.4667; val_optim_loss: 30677807.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9771; val_auprc_score: 0.9722; val_best_acc_score: 0.9286; val_best_f1_score: 0.9303; train_kl_reg_loss: 90777.1744; train_edge_recon_loss: 2708685.4905; train_gene_expr_recon_loss: 22382445.1298; train_masked_gp_l1_reg_loss: 130344.6270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42369.2702; train_chrom_access_recon_loss: 5450025.6565; train_global_loss: 30804647.3282; train_optim_loss: 30804647.3282; val_kl_reg_loss: 63244.2568; val_edge_recon_loss: 2702643.1167; val_gene_expr_recon_loss: 22119254.9333; val_masked_gp_l1_reg_loss: 130159.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42429.0508; val_chrom_access_recon_loss: 5420852.4333; val_global_loss: 30478584.5333; val_optim_loss: 30478584.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9764; val_auprc_score: 0.9704; val_best_acc_score: 0.9286; val_best_f1_score: 0.9316; train_kl_reg_loss: 87434.7555; train_edge_recon_loss: 2701829.4561; train_gene_expr_recon_loss: 22332514.9771; train_masked_gp_l1_reg_loss: 130028.5436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42204.3377; train_chrom_access_recon_loss: 5433895.2023; train_global_loss: 30727907.2214; train_optim_loss: 30727907.2214; val_kl_reg_loss: 65506.9542; val_edge_recon_loss: 2712426.5167; val_gene_expr_recon_loss: 22184349.2000; val_masked_gp_l1_reg_loss: 129859.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41962.4648; val_chrom_access_recon_loss: 5441921.7667; val_global_loss: 30576026.2667; val_optim_loss: 30576026.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9777; val_auprc_score: 0.9688; val_best_acc_score: 0.9338; val_best_f1_score: 0.9362; train_kl_reg_loss: 84402.4062; train_edge_recon_loss: 2695214.3397; train_gene_expr_recon_loss: 22269898.7481; train_masked_gp_l1_reg_loss: 129609.7999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41889.8750; train_chrom_access_recon_loss: 5417886.2557; train_global_loss: 30638901.4198; train_optim_loss: 30638901.4198; val_kl_reg_loss: 66618.8349; val_edge_recon_loss: 2693134.5833; val_gene_expr_recon_loss: 22079310.2667; val_masked_gp_l1_reg_loss: 129559.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41884.2070; val_chrom_access_recon_loss: 5402071.1333; val_global_loss: 30412578.9333; val_optim_loss: 30412578.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9774; val_auprc_score: 0.9719; val_best_acc_score: 0.9305; val_best_f1_score: 0.9330; train_kl_reg_loss: 81966.6185; train_edge_recon_loss: 2701041.9752; train_gene_expr_recon_loss: 22242660.2137; train_masked_gp_l1_reg_loss: 129340.4107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41771.2602; train_chrom_access_recon_loss: 5408022.2290; train_global_loss: 30604802.8092; train_optim_loss: 30604802.8092; val_kl_reg_loss: 66469.5057; val_edge_recon_loss: 2704369.6333; val_gene_expr_recon_loss: 22044075.3333; val_masked_gp_l1_reg_loss: 129213.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41807.9297; val_chrom_access_recon_loss: 5395769.6667; val_global_loss: 30381706.4000; val_optim_loss: 30381706.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9764; val_auprc_score: 0.9700; val_best_acc_score: 0.9310; val_best_f1_score: 0.9333; train_kl_reg_loss: 80630.7833; train_edge_recon_loss: 2691669.8664; train_gene_expr_recon_loss: 22209354.0305; train_masked_gp_l1_reg_loss: 129047.8640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41636.0068; train_chrom_access_recon_loss: 5398511.9275; train_global_loss: 30550850.4122; train_optim_loss: 30550850.4122; val_kl_reg_loss: 69033.0583; val_edge_recon_loss: 2702739.7167; val_gene_expr_recon_loss: 22034844.9333; val_masked_gp_l1_reg_loss: 128954.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41697.9805; val_chrom_access_recon_loss: 5388574.8667; val_global_loss: 30365844.4000; val_optim_loss: 30365844.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9776; val_auprc_score: 0.9711; val_best_acc_score: 0.9305; val_best_f1_score: 0.9327; train_kl_reg_loss: 78538.2036; train_edge_recon_loss: 2682554.4905; train_gene_expr_recon_loss: 22192611.6947; train_masked_gp_l1_reg_loss: 128895.3759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41681.6148; train_chrom_access_recon_loss: 5399300.1679; train_global_loss: 30523581.7710; train_optim_loss: 30523581.7710; val_kl_reg_loss: 69516.9870; val_edge_recon_loss: 2714492.9833; val_gene_expr_recon_loss: 21976624.5333; val_masked_gp_l1_reg_loss: 128790.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41345.4297; val_chrom_access_recon_loss: 5380941.3667; val_global_loss: 30311711.8667; val_optim_loss: 30311711.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9788; val_auprc_score: 0.9702; val_best_acc_score: 0.9371; val_best_f1_score: 0.9397; train_kl_reg_loss: 77477.4584; train_edge_recon_loss: 2681488.2290; train_gene_expr_recon_loss: 22164291.2214; train_masked_gp_l1_reg_loss: 128734.9325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41426.7535; train_chrom_access_recon_loss: 5396023.1450; train_global_loss: 30489441.5573; train_optim_loss: 30489441.5573; val_kl_reg_loss: 71726.2391; val_edge_recon_loss: 2686885.6667; val_gene_expr_recon_loss: 21996177.3333; val_masked_gp_l1_reg_loss: 128655.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41281.5820; val_chrom_access_recon_loss: 5399635.2667; val_global_loss: 30324362.5333; val_optim_loss: 30324362.5333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9788; val_auprc_score: 0.9734; val_best_acc_score: 0.9298; val_best_f1_score: 0.9326; train_kl_reg_loss: 77399.3032; train_edge_recon_loss: 2688078.4084; train_gene_expr_recon_loss: 22125194.2595; train_masked_gp_l1_reg_loss: 128676.4684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41296.0897; train_chrom_access_recon_loss: 5383922.0191; train_global_loss: 30444566.6107; train_optim_loss: 30444566.6107; val_kl_reg_loss: 70732.0094; val_edge_recon_loss: 2697412.2667; val_gene_expr_recon_loss: 21887189.6000; val_masked_gp_l1_reg_loss: 128607.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40953.4102; val_chrom_access_recon_loss: 5371850.6000; val_global_loss: 30196746.5333; val_optim_loss: 30196746.5333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9805; val_auprc_score: 0.9750; val_best_acc_score: 0.9338; val_best_f1_score: 0.9358; train_kl_reg_loss: 76281.7134; train_edge_recon_loss: 2690309.6069; train_gene_expr_recon_loss: 22112663.6336; train_masked_gp_l1_reg_loss: 128562.2810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40899.7703; train_chrom_access_recon_loss: 5385237.1107; train_global_loss: 30433954.0916; train_optim_loss: 30433954.0916; val_kl_reg_loss: 71681.3406; val_edge_recon_loss: 2697641.2167; val_gene_expr_recon_loss: 21815671.2000; val_masked_gp_l1_reg_loss: 128535.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40820.8516; val_chrom_access_recon_loss: 5360999.8000; val_global_loss: 30115349.2000; val_optim_loss: 30115349.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9807; val_auprc_score: 0.9774; val_best_acc_score: 0.9337; val_best_f1_score: 0.9353; train_kl_reg_loss: 75443.1249; train_edge_recon_loss: 2687289.7805; train_gene_expr_recon_loss: 22088820.8397; train_masked_gp_l1_reg_loss: 128591.4807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40786.2450; train_chrom_access_recon_loss: 5381770.3511; train_global_loss: 30402701.7557; train_optim_loss: 30402701.7557; val_kl_reg_loss: 73565.1432; val_edge_recon_loss: 2720204.6833; val_gene_expr_recon_loss: 21930073.7333; val_masked_gp_l1_reg_loss: 128698.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40738.8242; val_chrom_access_recon_loss: 5375289.1667; val_global_loss: 30268568.4000; val_optim_loss: 30268568.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9819; val_auprc_score: 0.9757; val_best_acc_score: 0.9394; val_best_f1_score: 0.9411; train_kl_reg_loss: 75106.9735; train_edge_recon_loss: 2677761.2080; train_gene_expr_recon_loss: 22079849.0840; train_masked_gp_l1_reg_loss: 128651.4451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40396.8689; train_chrom_access_recon_loss: 5385010.3168; train_global_loss: 30386775.8779; train_optim_loss: 30386775.8779; val_kl_reg_loss: 72008.2745; val_edge_recon_loss: 2693446.8000; val_gene_expr_recon_loss: 21746165.7333; val_masked_gp_l1_reg_loss: 128633.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39969.2461; val_chrom_access_recon_loss: 5340111.4333; val_global_loss: 30020336.0000; val_optim_loss: 30020336.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9819; val_auprc_score: 0.9771; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 75163.2908; train_edge_recon_loss: 2684369.0076; train_gene_expr_recon_loss: 22057384.7023; train_masked_gp_l1_reg_loss: 128633.9001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39804.5427; train_chrom_access_recon_loss: 5375144.4885; train_global_loss: 30360500.1221; train_optim_loss: 30360500.1221; val_kl_reg_loss: 69458.3089; val_edge_recon_loss: 2690476.8833; val_gene_expr_recon_loss: 21841514.8000; val_masked_gp_l1_reg_loss: 128670.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39679.5977; val_chrom_access_recon_loss: 5353369.2000; val_global_loss: 30123169.3333; val_optim_loss: 30123169.3333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9824; val_auprc_score: 0.9789; val_best_acc_score: 0.9402; val_best_f1_score: 0.9420; train_kl_reg_loss: 74029.2632; train_edge_recon_loss: 2678418.6069; train_gene_expr_recon_loss: 22042544.0916; train_masked_gp_l1_reg_loss: 128730.4936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39546.7709; train_chrom_access_recon_loss: 5372498.8168; train_global_loss: 30335768.0153; train_optim_loss: 30335768.0153; val_kl_reg_loss: 71051.2917; val_edge_recon_loss: 2684479.5167; val_gene_expr_recon_loss: 21821991.0667; val_masked_gp_l1_reg_loss: 128862.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39564.9609; val_chrom_access_recon_loss: 5346894.9333; val_global_loss: 30092842.6667; val_optim_loss: 30092842.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9826; val_auprc_score: 0.9788; val_best_acc_score: 0.9407; val_best_f1_score: 0.9427; train_kl_reg_loss: 73388.9072; train_edge_recon_loss: 2686799.4256; train_gene_expr_recon_loss: 22024501.0534; train_masked_gp_l1_reg_loss: 128929.1966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39470.6913; train_chrom_access_recon_loss: 5365435.5000; train_global_loss: 30318524.7786; train_optim_loss: 30318524.7786; val_kl_reg_loss: 70670.5682; val_edge_recon_loss: 2682141.0333; val_gene_expr_recon_loss: 21842020.9333; val_masked_gp_l1_reg_loss: 129056.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39374.2734; val_chrom_access_recon_loss: 5362520.8667; val_global_loss: 30125783.3333; val_optim_loss: 30125783.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9835; val_auprc_score: 0.9794; val_best_acc_score: 0.9398; val_best_f1_score: 0.9419; train_kl_reg_loss: 73498.6171; train_edge_recon_loss: 2675824.1603; train_gene_expr_recon_loss: 21982271.5878; train_masked_gp_l1_reg_loss: 129146.5282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39336.8958; train_chrom_access_recon_loss: 5358808.3130; train_global_loss: 30258886.1679; train_optim_loss: 30258886.1679; val_kl_reg_loss: 71453.1766; val_edge_recon_loss: 2705938.6333; val_gene_expr_recon_loss: 21817111.8667; val_masked_gp_l1_reg_loss: 129215.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39154.6914; val_chrom_access_recon_loss: 5348654.8000; val_global_loss: 30111528.5333; val_optim_loss: 30111528.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9853; val_auprc_score: 0.9825; val_best_acc_score: 0.9469; val_best_f1_score: 0.9485; train_kl_reg_loss: 74395.6604; train_edge_recon_loss: 2679390.9256; train_gene_expr_recon_loss: 21977238.4885; train_masked_gp_l1_reg_loss: 127959.6583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35637.3473; train_chrom_access_recon_loss: 5359265.3473; train_global_loss: 30253887.5115; train_optim_loss: 30253887.5115; val_kl_reg_loss: 72599.3109; val_edge_recon_loss: 2667254.0833; val_gene_expr_recon_loss: 21829935.2000; val_masked_gp_l1_reg_loss: 127464.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34922.1914; val_chrom_access_recon_loss: 5330574.9667; val_global_loss: 30062749.4667; val_optim_loss: 30062749.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9825; val_auprc_score: 0.9750; val_best_acc_score: 0.9431; val_best_f1_score: 0.9446; train_kl_reg_loss: 75206.0936; train_edge_recon_loss: 2673876.6374; train_gene_expr_recon_loss: 21943571.7405; train_masked_gp_l1_reg_loss: 127326.0623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34665.1971; train_chrom_access_recon_loss: 5351455.5725; train_global_loss: 30206101.3282; train_optim_loss: 30206101.3282; val_kl_reg_loss: 73586.7609; val_edge_recon_loss: 2689561.9333; val_gene_expr_recon_loss: 21920265.6000; val_masked_gp_l1_reg_loss: 127212.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34402.4492; val_chrom_access_recon_loss: 5367122.0333; val_global_loss: 30212149.7333; val_optim_loss: 30212149.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9825; val_auprc_score: 0.9786; val_best_acc_score: 0.9406; val_best_f1_score: 0.9419; train_kl_reg_loss: 75487.5921; train_edge_recon_loss: 2674383.7500; train_gene_expr_recon_loss: 21943868.8092; train_masked_gp_l1_reg_loss: 127154.6497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34230.1676; train_chrom_access_recon_loss: 5355034.9046; train_global_loss: 30210159.9084; train_optim_loss: 30210159.9084; val_kl_reg_loss: 73839.3458; val_edge_recon_loss: 2677767.8167; val_gene_expr_recon_loss: 21798535.2000; val_masked_gp_l1_reg_loss: 127112.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34037.5781; val_chrom_access_recon_loss: 5361994.5000; val_global_loss: 30073286.8000; val_optim_loss: 30073286.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9847; val_auprc_score: 0.9817; val_best_acc_score: 0.9449; val_best_f1_score: 0.9467; train_kl_reg_loss: 75689.4688; train_edge_recon_loss: 2674947.0019; train_gene_expr_recon_loss: 21945305.4656; train_masked_gp_l1_reg_loss: 127076.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33919.8846; train_chrom_access_recon_loss: 5353976.3779; train_global_loss: 30210914.7481; train_optim_loss: 30210914.7481; val_kl_reg_loss: 72950.0479; val_edge_recon_loss: 2671482.9333; val_gene_expr_recon_loss: 21786271.7333; val_masked_gp_l1_reg_loss: 127038.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33773.9766; val_chrom_access_recon_loss: 5308697.3667; val_global_loss: 30000213.8667; val_optim_loss: 30000213.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9822; val_auprc_score: 0.9758; val_best_acc_score: 0.9403; val_best_f1_score: 0.9421; train_kl_reg_loss: 75341.4279; train_edge_recon_loss: 2678138.1336; train_gene_expr_recon_loss: 21937383.9237; train_masked_gp_l1_reg_loss: 127043.2398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33693.2847; train_chrom_access_recon_loss: 5352959.4771; train_global_loss: 30204559.2672; train_optim_loss: 30204559.2672; val_kl_reg_loss: 73649.0813; val_edge_recon_loss: 2685471.6000; val_gene_expr_recon_loss: 21844300.2667; val_masked_gp_l1_reg_loss: 127047.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33556.3555; val_chrom_access_recon_loss: 5375114.1000; val_global_loss: 30139139.2000; val_optim_loss: 30139139.2000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9835; val_auprc_score: 0.9804; val_best_acc_score: 0.9426; val_best_f1_score: 0.9446; train_kl_reg_loss: 75578.9625; train_edge_recon_loss: 2676608.9351; train_gene_expr_recon_loss: 21928032.0305; train_masked_gp_l1_reg_loss: 127031.1564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33450.4361; train_chrom_access_recon_loss: 5354951.6450; train_global_loss: 30195653.3740; train_optim_loss: 30195653.3740; val_kl_reg_loss: 73372.7073; val_edge_recon_loss: 2684913.9167; val_gene_expr_recon_loss: 21693371.0667; val_masked_gp_l1_reg_loss: 127019.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33343.7227; val_chrom_access_recon_loss: 5322612.1000; val_global_loss: 29934633.6000; val_optim_loss: 29934633.6000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9833; val_auprc_score: 0.9801; val_best_acc_score: 0.9427; val_best_f1_score: 0.9442; train_kl_reg_loss: 75385.6565; train_edge_recon_loss: 2675701.3607; train_gene_expr_recon_loss: 21944805.0076; train_masked_gp_l1_reg_loss: 127024.2427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33270.4321; train_chrom_access_recon_loss: 5358129.5916; train_global_loss: 30214316.1679; train_optim_loss: 30214316.1679; val_kl_reg_loss: 74088.9068; val_edge_recon_loss: 2679741.8500; val_gene_expr_recon_loss: 21797138.4000; val_masked_gp_l1_reg_loss: 127028.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33143.0742; val_chrom_access_recon_loss: 5327288.7667; val_global_loss: 30038429.4667; val_optim_loss: 30038429.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9828; val_auprc_score: 0.9787; val_best_acc_score: 0.9422; val_best_f1_score: 0.9442; train_kl_reg_loss: 75408.7029; train_edge_recon_loss: 2671206.5840; train_gene_expr_recon_loss: 21945898.3359; train_masked_gp_l1_reg_loss: 127046.9213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33076.3391; train_chrom_access_recon_loss: 5353616.5153; train_global_loss: 30206253.3435; train_optim_loss: 30206253.3435; val_kl_reg_loss: 74238.6677; val_edge_recon_loss: 2689570.7500; val_gene_expr_recon_loss: 21825733.6000; val_masked_gp_l1_reg_loss: 127027.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32973.7930; val_chrom_access_recon_loss: 5346431.7000; val_global_loss: 30095976.5333; val_optim_loss: 30095976.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9843; val_auprc_score: 0.9809; val_best_acc_score: 0.9425; val_best_f1_score: 0.9445; train_kl_reg_loss: 75487.7793; train_edge_recon_loss: 2679733.3550; train_gene_expr_recon_loss: 21941192.1527; train_masked_gp_l1_reg_loss: 127044.9334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32906.0884; train_chrom_access_recon_loss: 5350973.8321; train_global_loss: 30207338.2290; train_optim_loss: 30207338.2290; val_kl_reg_loss: 73204.6125; val_edge_recon_loss: 2679890.9333; val_gene_expr_recon_loss: 21752655.6000; val_masked_gp_l1_reg_loss: 127037.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32813.1523; val_chrom_access_recon_loss: 5328071.0000; val_global_loss: 29993673.8667; val_optim_loss: 29993673.8667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9853; val_auprc_score: 0.9803; val_best_acc_score: 0.9452; val_best_f1_score: 0.9470; train_kl_reg_loss: 75245.2929; train_edge_recon_loss: 2678265.5573; train_gene_expr_recon_loss: 21925578.0000; train_masked_gp_l1_reg_loss: 127050.8169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32739.4899; train_chrom_access_recon_loss: 5353964.0534; train_global_loss: 30192843.2824; train_optim_loss: 30192843.2824; val_kl_reg_loss: 73348.2786; val_edge_recon_loss: 2671992.9333; val_gene_expr_recon_loss: 21792638.1333; val_masked_gp_l1_reg_loss: 127057.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32662.0723; val_chrom_access_recon_loss: 5368934.6333; val_global_loss: 30066634.0000; val_optim_loss: 30066634.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9844; val_auprc_score: 0.9815; val_best_acc_score: 0.9452; val_best_f1_score: 0.9465; train_kl_reg_loss: 75095.3173; train_edge_recon_loss: 2673852.4084; train_gene_expr_recon_loss: 21917014.6107; train_masked_gp_l1_reg_loss: 126934.7635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32302.4734; train_chrom_access_recon_loss: 5351861.0916; train_global_loss: 30177060.7023; train_optim_loss: 30177060.7023; val_kl_reg_loss: 73558.9812; val_edge_recon_loss: 2694550.9333; val_gene_expr_recon_loss: 21839526.4000; val_masked_gp_l1_reg_loss: 126875.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32239.1289; val_chrom_access_recon_loss: 5364745.8333; val_global_loss: 30131498.0000; val_optim_loss: 30131498.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9835; val_auprc_score: 0.9765; val_best_acc_score: 0.9427; val_best_f1_score: 0.9443; train_kl_reg_loss: 75393.8104; train_edge_recon_loss: 2668656.4179; train_gene_expr_recon_loss: 21940699.6947; train_masked_gp_l1_reg_loss: 126850.7349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32213.8117; train_chrom_access_recon_loss: 5353912.5191; train_global_loss: 30197726.9771; train_optim_loss: 30197726.9771; val_kl_reg_loss: 73698.5875; val_edge_recon_loss: 2675745.9667; val_gene_expr_recon_loss: 21912934.9333; val_masked_gp_l1_reg_loss: 126833.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32191.5898; val_chrom_access_recon_loss: 5370200.7667; val_global_loss: 30191606.1333; val_optim_loss: 30191606.1333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9836; val_auprc_score: 0.9797; val_best_acc_score: 0.9440; val_best_f1_score: 0.9454; train_kl_reg_loss: 75378.2312; train_edge_recon_loss: 2675248.4828; train_gene_expr_recon_loss: 21926374.8855; train_masked_gp_l1_reg_loss: 126822.0203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32173.7836; train_chrom_access_recon_loss: 5349346.6069; train_global_loss: 30185344.0458; train_optim_loss: 30185344.0458; val_kl_reg_loss: 73772.1516; val_edge_recon_loss: 2687754.0500; val_gene_expr_recon_loss: 21804747.8667; val_masked_gp_l1_reg_loss: 126811.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32154.7852; val_chrom_access_recon_loss: 5339476.2000; val_global_loss: 30064716.1333; val_optim_loss: 30064716.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9849; val_auprc_score: 0.9805; val_best_acc_score: 0.9483; val_best_f1_score: 0.9494; train_kl_reg_loss: 75254.2796; train_edge_recon_loss: 2679648.1336; train_gene_expr_recon_loss: 21914167.7099; train_masked_gp_l1_reg_loss: 126804.8330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32137.4519; train_chrom_access_recon_loss: 5350854.8130; train_global_loss: 30178867.2366; train_optim_loss: 30178867.2366; val_kl_reg_loss: 73802.8609; val_edge_recon_loss: 2682944.6833; val_gene_expr_recon_loss: 21899524.2667; val_masked_gp_l1_reg_loss: 126797.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32121.9355; val_chrom_access_recon_loss: 5348419.9333; val_global_loss: 30163611.6000; val_optim_loss: 30163611.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 75 min 20 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9808
val AUPRC score: 0.9763
val best accuracy score: 0.9351
val best F1 score: 0.9378
val target rna MSE score: 0.7815
val source rna MSE score: 0.1510
val target atac MSE score: 0.5005
val source atac MSE score: 0.0790
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
