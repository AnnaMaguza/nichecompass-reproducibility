[True]
Run timestamp: 10082023_233145_98.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_98']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6901; val_auprc_score: 0.7372; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 132181.6047; train_edge_recon_loss: 3819934.1508; train_gene_expr_recon_loss: 45407889.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6891210.4695; train_global_loss: 56251216.3053; train_optim_loss: 56251216.3053; val_kl_reg_loss: 209645.1281; val_edge_recon_loss: 4065618.2833; val_gene_expr_recon_loss: 38300777.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6444955.4000; val_global_loss: 49020996.5333; val_optim_loss: 49020996.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7434; val_auprc_score: 0.7713; val_best_acc_score: 0.5521; val_best_f1_score: 0.6858; train_kl_reg_loss: 187283.6042; train_edge_recon_loss: 3692497.9332; train_gene_expr_recon_loss: 38031119.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6434854.9351; train_global_loss: 48345756.1832; train_optim_loss: 48345756.1832; val_kl_reg_loss: 205022.0500; val_edge_recon_loss: 4062371.1167; val_gene_expr_recon_loss: 36910740.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6319593.3000; val_global_loss: 47497726.9333; val_optim_loss: 47497726.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8604; val_auprc_score: 0.8638; val_best_acc_score: 0.7811; val_best_f1_score: 0.7740; train_kl_reg_loss: 191198.1968; train_edge_recon_loss: 3579484.4618; train_gene_expr_recon_loss: 36975218.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6345544.7977; train_global_loss: 47091445.5267; train_optim_loss: 47091445.5267; val_kl_reg_loss: 186825.8031; val_edge_recon_loss: 4027568.0333; val_gene_expr_recon_loss: 36339457.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6256285.4667; val_global_loss: 46810136.8000; val_optim_loss: 46810136.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9094; val_auprc_score: 0.9015; val_best_acc_score: 0.8347; val_best_f1_score: 0.8415; train_kl_reg_loss: 164985.3420; train_edge_recon_loss: 3537702.2328; train_gene_expr_recon_loss: 36565584.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6303686.3321; train_global_loss: 46571958.4122; train_optim_loss: 46571958.4122; val_kl_reg_loss: 143419.0333; val_edge_recon_loss: 3836448.2833; val_gene_expr_recon_loss: 36043969.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6221049.9000; val_global_loss: 46244886.6667; val_optim_loss: 46244886.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9088; val_auprc_score: 0.8992; val_best_acc_score: 0.8285; val_best_f1_score: 0.8382; train_kl_reg_loss: 137704.0555; train_edge_recon_loss: 3322163.8607; train_gene_expr_recon_loss: 36318584.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6283336.6603; train_global_loss: 46061788.7939; train_optim_loss: 46061788.7939; val_kl_reg_loss: 160319.7135; val_edge_recon_loss: 3067127.0333; val_gene_expr_recon_loss: 35830192.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6178017.4333; val_global_loss: 45235656.5333; val_optim_loss: 45235656.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9110; val_auprc_score: 0.8977; val_best_acc_score: 0.8331; val_best_f1_score: 0.8422; train_kl_reg_loss: 175313.9091; train_edge_recon_loss: 2987459.4828; train_gene_expr_recon_loss: 36045088.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6239946.6069; train_global_loss: 45447808.1832; train_optim_loss: 45447808.1832; val_kl_reg_loss: 178786.9781; val_edge_recon_loss: 2983169.1333; val_gene_expr_recon_loss: 35494473.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6138279.3000; val_global_loss: 44794708.8000; val_optim_loss: 44794708.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9213; val_auprc_score: 0.9080; val_best_acc_score: 0.8468; val_best_f1_score: 0.8570; train_kl_reg_loss: 176100.7972; train_edge_recon_loss: 2947167.0420; train_gene_expr_recon_loss: 35873045.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6215105.5115; train_global_loss: 45211418.7176; train_optim_loss: 45211418.7176; val_kl_reg_loss: 171925.8281; val_edge_recon_loss: 2941140.6167; val_gene_expr_recon_loss: 35367894.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6120076.3000; val_global_loss: 44601037.0667; val_optim_loss: 44601037.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9233; val_auprc_score: 0.9092; val_best_acc_score: 0.8526; val_best_f1_score: 0.8605; train_kl_reg_loss: 171305.4167; train_edge_recon_loss: 2909849.4351; train_gene_expr_recon_loss: 35649392.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6187690.7786; train_global_loss: 44918237.8931; train_optim_loss: 44918237.8931; val_kl_reg_loss: 169838.2625; val_edge_recon_loss: 2926380.4333; val_gene_expr_recon_loss: 35190834.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6104196.3000; val_global_loss: 44391249.6000; val_optim_loss: 44391249.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9293; val_auprc_score: 0.9134; val_best_acc_score: 0.8634; val_best_f1_score: 0.8708; train_kl_reg_loss: 166140.3272; train_edge_recon_loss: 2888858.9179; train_gene_expr_recon_loss: 35510001.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6175907.0000; train_global_loss: 44740907.5725; train_optim_loss: 44740907.5725; val_kl_reg_loss: 163526.7458; val_edge_recon_loss: 2885217.3000; val_gene_expr_recon_loss: 35048328.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6103628.7667; val_global_loss: 44200700.8000; val_optim_loss: 44200700.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9352; val_auprc_score: 0.9219; val_best_acc_score: 0.8666; val_best_f1_score: 0.8727; train_kl_reg_loss: 158430.2047; train_edge_recon_loss: 2867257.7958; train_gene_expr_recon_loss: 35349626.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6148726.4504; train_global_loss: 44524040.2137; train_optim_loss: 44524040.2137; val_kl_reg_loss: 154072.9750; val_edge_recon_loss: 2881689.7333; val_gene_expr_recon_loss: 34946506.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6086871.8667; val_global_loss: 44069140.8000; val_optim_loss: 44069140.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9342; val_auprc_score: 0.9224; val_best_acc_score: 0.8685; val_best_f1_score: 0.8752; train_kl_reg_loss: 153717.1382; train_edge_recon_loss: 2853440.7328; train_gene_expr_recon_loss: 35218938.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6129634.3626; train_global_loss: 44355731.0534; train_optim_loss: 44355731.0534; val_kl_reg_loss: 151782.5406; val_edge_recon_loss: 2886766.8667; val_gene_expr_recon_loss: 34872479.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6061420.5667; val_global_loss: 43972448.5333; val_optim_loss: 43972448.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9386; val_auprc_score: 0.9264; val_best_acc_score: 0.8727; val_best_f1_score: 0.8791; train_kl_reg_loss: 145860.5974; train_edge_recon_loss: 2850188.4218; train_gene_expr_recon_loss: 35207799.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6129963.9542; train_global_loss: 44333812.1527; train_optim_loss: 44333812.1527; val_kl_reg_loss: 133343.5359; val_edge_recon_loss: 2849022.6333; val_gene_expr_recon_loss: 34954832.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6049443.8000; val_global_loss: 43986642.4000; val_optim_loss: 43986642.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9414; val_auprc_score: 0.9302; val_best_acc_score: 0.8759; val_best_f1_score: 0.8831; train_kl_reg_loss: 140844.8189; train_edge_recon_loss: 2839673.4962; train_gene_expr_recon_loss: 35135861.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6117299.8664; train_global_loss: 44233680.0305; train_optim_loss: 44233680.0305; val_kl_reg_loss: 140950.0135; val_edge_recon_loss: 2838857.7000; val_gene_expr_recon_loss: 34689350.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6054157.2333; val_global_loss: 43723314.9333; val_optim_loss: 43723314.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9474; val_auprc_score: 0.9353; val_best_acc_score: 0.8837; val_best_f1_score: 0.8896; train_kl_reg_loss: 140126.3130; train_edge_recon_loss: 2809435.0420; train_gene_expr_recon_loss: 35012511.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6104769.0115; train_global_loss: 44066842.1374; train_optim_loss: 44066842.1374; val_kl_reg_loss: 136122.5516; val_edge_recon_loss: 2826681.4333; val_gene_expr_recon_loss: 34529455.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6004536.6333; val_global_loss: 43496796.2667; val_optim_loss: 43496796.2667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9497; val_auprc_score: 0.9405; val_best_acc_score: 0.8867; val_best_f1_score: 0.8910; train_kl_reg_loss: 137204.5879; train_edge_recon_loss: 2804960.1412; train_gene_expr_recon_loss: 34890363.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6083218.0802; train_global_loss: 43915745.6794; train_optim_loss: 43915745.6794; val_kl_reg_loss: 136493.6229; val_edge_recon_loss: 2813672.9167; val_gene_expr_recon_loss: 34398127.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5992649.9000; val_global_loss: 43340944.2667; val_optim_loss: 43340944.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9540; val_auprc_score: 0.9465; val_best_acc_score: 0.8915; val_best_f1_score: 0.8962; train_kl_reg_loss: 134811.3662; train_edge_recon_loss: 2789863.8569; train_gene_expr_recon_loss: 34778852.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6071366.2137; train_global_loss: 43774893.8931; train_optim_loss: 43774893.8931; val_kl_reg_loss: 133549.8375; val_edge_recon_loss: 2796444.2167; val_gene_expr_recon_loss: 34335216.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6004834.8667; val_global_loss: 43270045.3333; val_optim_loss: 43270045.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9564; val_auprc_score: 0.9478; val_best_acc_score: 0.8964; val_best_f1_score: 0.8999; train_kl_reg_loss: 130275.8349; train_edge_recon_loss: 2791084.2004; train_gene_expr_recon_loss: 34707039.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6060413.9504; train_global_loss: 43688813.2519; train_optim_loss: 43688813.2519; val_kl_reg_loss: 129330.2792; val_edge_recon_loss: 2798902.6833; val_gene_expr_recon_loss: 34316619.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5997987.6000; val_global_loss: 43242839.4667; val_optim_loss: 43242839.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9562; val_auprc_score: 0.9471; val_best_acc_score: 0.8940; val_best_f1_score: 0.8984; train_kl_reg_loss: 126772.1997; train_edge_recon_loss: 2773547.1756; train_gene_expr_recon_loss: 34688569.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6060473.2863; train_global_loss: 43649361.6794; train_optim_loss: 43649361.6794; val_kl_reg_loss: 125029.6021; val_edge_recon_loss: 2829773.9167; val_gene_expr_recon_loss: 34245817.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5987358.6333; val_global_loss: 43187980.0000; val_optim_loss: 43187980.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9588; val_auprc_score: 0.9508; val_best_acc_score: 0.9007; val_best_f1_score: 0.9043; train_kl_reg_loss: 124824.7285; train_edge_recon_loss: 2771118.7366; train_gene_expr_recon_loss: 34657317.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6057520.1718; train_global_loss: 43610780.9160; train_optim_loss: 43610780.9160; val_kl_reg_loss: 126466.1161; val_edge_recon_loss: 2779790.0167; val_gene_expr_recon_loss: 34157595.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5985826.2667; val_global_loss: 43049677.8667; val_optim_loss: 43049677.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9591; val_auprc_score: 0.9519; val_best_acc_score: 0.9016; val_best_f1_score: 0.9059; train_kl_reg_loss: 122963.8217; train_edge_recon_loss: 2766507.4580; train_gene_expr_recon_loss: 34550583.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6046047.0420; train_global_loss: 43486102.2595; train_optim_loss: 43486102.2595; val_kl_reg_loss: 122694.8849; val_edge_recon_loss: 2801664.2167; val_gene_expr_recon_loss: 34269743.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5988918.8667; val_global_loss: 43183021.0667; val_optim_loss: 43183021.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9627; val_auprc_score: 0.9543; val_best_acc_score: 0.9116; val_best_f1_score: 0.9147; train_kl_reg_loss: 121008.4483; train_edge_recon_loss: 2756731.6279; train_gene_expr_recon_loss: 34517252.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6041711.6908; train_global_loss: 43436703.6641; train_optim_loss: 43436703.6641; val_kl_reg_loss: 119391.8182; val_edge_recon_loss: 2769792.5833; val_gene_expr_recon_loss: 34012312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5943705.6333; val_global_loss: 42845202.1333; val_optim_loss: 42845202.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9664; val_auprc_score: 0.9553; val_best_acc_score: 0.9155; val_best_f1_score: 0.9189; train_kl_reg_loss: 117338.5809; train_edge_recon_loss: 2753842.9256; train_gene_expr_recon_loss: 34444492.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6035219.0229; train_global_loss: 43350892.7634; train_optim_loss: 43350892.7634; val_kl_reg_loss: 115222.9052; val_edge_recon_loss: 2773339.6000; val_gene_expr_recon_loss: 33994692.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5959411.9333; val_global_loss: 42842667.7333; val_optim_loss: 42842667.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9665; val_auprc_score: 0.9606; val_best_acc_score: 0.9130; val_best_f1_score: 0.9154; train_kl_reg_loss: 114773.3167; train_edge_recon_loss: 2757381.3531; train_gene_expr_recon_loss: 34385350.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6026556.6832; train_global_loss: 43284061.4046; train_optim_loss: 43284061.4046; val_kl_reg_loss: 113733.5495; val_edge_recon_loss: 2771721.4833; val_gene_expr_recon_loss: 34096588.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5974089.7000; val_global_loss: 42956133.3333; val_optim_loss: 42956133.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9684; val_auprc_score: 0.9622; val_best_acc_score: 0.9122; val_best_f1_score: 0.9152; train_kl_reg_loss: 113386.6297; train_edge_recon_loss: 2742316.4408; train_gene_expr_recon_loss: 34331555.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6022627.3168; train_global_loss: 43209885.4351; train_optim_loss: 43209885.4351; val_kl_reg_loss: 115087.1552; val_edge_recon_loss: 2762292.6333; val_gene_expr_recon_loss: 34075765.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5963987.4667; val_global_loss: 42917133.6000; val_optim_loss: 42917133.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9703; val_auprc_score: 0.9646; val_best_acc_score: 0.9201; val_best_f1_score: 0.9225; train_kl_reg_loss: 111176.9281; train_edge_recon_loss: 2742790.2519; train_gene_expr_recon_loss: 34274652.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6016273.7099; train_global_loss: 43144893.1603; train_optim_loss: 43144893.1603; val_kl_reg_loss: 109944.1896; val_edge_recon_loss: 2757208.3333; val_gene_expr_recon_loss: 33905138.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5948762.2667; val_global_loss: 42721053.8667; val_optim_loss: 42721053.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9730; val_auprc_score: 0.9667; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 118052.1503; train_edge_recon_loss: 2792719.8721; train_gene_expr_recon_loss: 35719351.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6206120.6260; train_global_loss: 44836244.4885; train_optim_loss: 44836244.4885; val_kl_reg_loss: 63630.5112; val_edge_recon_loss: 2769582.7167; val_gene_expr_recon_loss: 35035480.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6052595.8333; val_global_loss: 43921289.3333; val_optim_loss: 43921289.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9706; val_auprc_score: 0.9638; val_best_acc_score: 0.9174; val_best_f1_score: 0.9200; train_kl_reg_loss: 118233.1840; train_edge_recon_loss: 2772981.6622; train_gene_expr_recon_loss: 35450383.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6138733.9466; train_global_loss: 44480332.6412; train_optim_loss: 44480332.6412; val_kl_reg_loss: 66229.4656; val_edge_recon_loss: 2763388.6833; val_gene_expr_recon_loss: 34976821.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6029773.6000; val_global_loss: 43836212.5333; val_optim_loss: 43836212.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9704; val_auprc_score: 0.9638; val_best_acc_score: 0.9210; val_best_f1_score: 0.9233; train_kl_reg_loss: 111928.4985; train_edge_recon_loss: 2758341.9676; train_gene_expr_recon_loss: 35352053.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6114387.5000; train_global_loss: 44336710.8702; train_optim_loss: 44336710.8702; val_kl_reg_loss: 70415.4208; val_edge_recon_loss: 2758563.4333; val_gene_expr_recon_loss: 35023440.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6044428.8333; val_global_loss: 43896848.0000; val_optim_loss: 43896848.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9699; val_auprc_score: 0.9631; val_best_acc_score: 0.9181; val_best_f1_score: 0.9203; train_kl_reg_loss: 106532.8704; train_edge_recon_loss: 2750958.5744; train_gene_expr_recon_loss: 35308100.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6111395.9466; train_global_loss: 44276988.1221; train_optim_loss: 44276988.1221; val_kl_reg_loss: 70424.3651; val_edge_recon_loss: 2766028.2000; val_gene_expr_recon_loss: 34800252.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6027465.6333; val_global_loss: 43664170.9333; val_optim_loss: 43664170.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9685; val_auprc_score: 0.9604; val_best_acc_score: 0.9197; val_best_f1_score: 0.9232; train_kl_reg_loss: 104322.0521; train_edge_recon_loss: 2734618.7729; train_gene_expr_recon_loss: 35172620.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6098250.1336; train_global_loss: 44109811.3282; train_optim_loss: 44109811.3282; val_kl_reg_loss: 71512.3885; val_edge_recon_loss: 2748297.0667; val_gene_expr_recon_loss: 34895938.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6049817.6333; val_global_loss: 43765565.6000; val_optim_loss: 43765565.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9687; val_auprc_score: 0.9589; val_best_acc_score: 0.9181; val_best_f1_score: 0.9216; train_kl_reg_loss: 103979.9195; train_edge_recon_loss: 2743887.9294; train_gene_expr_recon_loss: 35213450.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6103212.1679; train_global_loss: 44164530.5038; train_optim_loss: 44164530.5038; val_kl_reg_loss: 72534.4333; val_edge_recon_loss: 2743474.5000; val_gene_expr_recon_loss: 34941857.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6060794.5000; val_global_loss: 43818660.0000; val_optim_loss: 43818660.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9715; val_auprc_score: 0.9664; val_best_acc_score: 0.9200; val_best_f1_score: 0.9224; train_kl_reg_loss: 103567.8904; train_edge_recon_loss: 2734348.0286; train_gene_expr_recon_loss: 35169322.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6096371.9122; train_global_loss: 44103610.5954; train_optim_loss: 44103610.5954; val_kl_reg_loss: 72323.9120; val_edge_recon_loss: 2750972.5000; val_gene_expr_recon_loss: 34924415.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6027516.7000; val_global_loss: 43775229.3333; val_optim_loss: 43775229.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9728; val_auprc_score: 0.9670; val_best_acc_score: 0.9223; val_best_f1_score: 0.9245; train_kl_reg_loss: 102568.7179; train_edge_recon_loss: 2737484.5076; train_gene_expr_recon_loss: 35191012.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6103223.9313; train_global_loss: 44134289.8015; train_optim_loss: 44134289.8015; val_kl_reg_loss: 72402.5146; val_edge_recon_loss: 2738755.0000; val_gene_expr_recon_loss: 34821648.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6020250.9333; val_global_loss: 43653056.8000; val_optim_loss: 43653056.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9700
val AUPRC score: 0.9649
val best accuracy score: 0.9146
val best F1 score: 0.9170
val target rna MSE score: 1.0900
val source rna MSE score: 21.0864
val target atac MSE score: 0.5636
val source atac MSE score: 6.0112
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
