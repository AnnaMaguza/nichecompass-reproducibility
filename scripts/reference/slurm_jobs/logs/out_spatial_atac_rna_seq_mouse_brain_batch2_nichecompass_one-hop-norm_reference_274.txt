[True]
Run timestamp: 07092023_053230_274.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_274']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 797 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3511, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6736; val_auprc_score: 0.6548; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 50316.7981; train_edge_recon_loss: 3541528.7273; train_gene_expr_recon_loss: 12572724.6212; train_masked_gp_l1_reg_loss: 33736.2007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5529114.7576; train_chrom_access_recon_loss: 4400200.1553; train_global_loss: 26127621.1515; train_optim_loss: 26127621.1515; val_kl_reg_loss: 109396.8545; val_edge_recon_loss: 4065540.4062; val_gene_expr_recon_loss: 11394645.0000; val_masked_gp_l1_reg_loss: 31905.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1945425.3750; val_chrom_access_recon_loss: 4102263.3125; val_global_loss: 21649177.0000; val_optim_loss: 21649177.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6968; val_auprc_score: 0.6833; val_best_acc_score: 0.6002; val_best_f1_score: 0.7005; train_kl_reg_loss: 105343.7405; train_edge_recon_loss: 3526727.7008; train_gene_expr_recon_loss: 11312656.6818; train_masked_gp_l1_reg_loss: 29722.0619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 693684.8636; train_chrom_access_recon_loss: 4179839.3447; train_global_loss: 19847974.4848; train_optim_loss: 19847974.4848; val_kl_reg_loss: 106469.9453; val_edge_recon_loss: 4059336.8438; val_gene_expr_recon_loss: 11104190.8750; val_masked_gp_l1_reg_loss: 28506.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217103.1250; val_chrom_access_recon_loss: 4060640.3750; val_global_loss: 19576248.2500; val_optim_loss: 19576248.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7466; val_auprc_score: 0.7255; val_best_acc_score: 0.6789; val_best_f1_score: 0.7004; train_kl_reg_loss: 96237.9683; train_edge_recon_loss: 3517672.8523; train_gene_expr_recon_loss: 11138965.7273; train_masked_gp_l1_reg_loss: 28741.7453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162969.5871; train_chrom_access_recon_loss: 4147426.9091; train_global_loss: 19092014.8788; train_optim_loss: 19092014.8788; val_kl_reg_loss: 95325.8965; val_edge_recon_loss: 4020767.0312; val_gene_expr_recon_loss: 10967018.8750; val_masked_gp_l1_reg_loss: 29451.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131163.5625; val_chrom_access_recon_loss: 4028803.0000; val_global_loss: 19272530.2500; val_optim_loss: 19272530.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7944; val_auprc_score: 0.7650; val_best_acc_score: 0.7233; val_best_f1_score: 0.7466; train_kl_reg_loss: 79321.7109; train_edge_recon_loss: 3490539.2273; train_gene_expr_recon_loss: 11045093.5000; train_masked_gp_l1_reg_loss: 30412.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117893.1689; train_chrom_access_recon_loss: 4118281.2273; train_global_loss: 18881541.0606; train_optim_loss: 18881541.0606; val_kl_reg_loss: 56249.7227; val_edge_recon_loss: 3716166.4688; val_gene_expr_recon_loss: 11011870.7500; val_masked_gp_l1_reg_loss: 31401.5176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108507.6875; val_chrom_access_recon_loss: 4044396.5625; val_global_loss: 18968593.5000; val_optim_loss: 18968593.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8343; val_auprc_score: 0.8077; val_best_acc_score: 0.7485; val_best_f1_score: 0.7864; train_kl_reg_loss: 73201.8135; train_edge_recon_loss: 3217172.3030; train_gene_expr_recon_loss: 11001111.2576; train_masked_gp_l1_reg_loss: 32496.9676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103665.4695; train_chrom_access_recon_loss: 4095968.4167; train_global_loss: 18523616.3030; train_optim_loss: 18523616.3030; val_kl_reg_loss: 91272.2178; val_edge_recon_loss: 3034399.4688; val_gene_expr_recon_loss: 10886578.1250; val_masked_gp_l1_reg_loss: 33871.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99761.9766; val_chrom_access_recon_loss: 4016057.0312; val_global_loss: 18161941.5000; val_optim_loss: 18161941.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8735; val_auprc_score: 0.8453; val_best_acc_score: 0.7926; val_best_f1_score: 0.8165; train_kl_reg_loss: 100663.4297; train_edge_recon_loss: 2937862.3826; train_gene_expr_recon_loss: 10931672.1061; train_masked_gp_l1_reg_loss: 34300.7141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95930.8002; train_chrom_access_recon_loss: 4073569.0758; train_global_loss: 18173998.4242; train_optim_loss: 18173998.4242; val_kl_reg_loss: 102320.6719; val_edge_recon_loss: 2885762.3125; val_gene_expr_recon_loss: 10837068.0000; val_masked_gp_l1_reg_loss: 34814.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92082.2109; val_chrom_access_recon_loss: 3992690.5000; val_global_loss: 17944737.0000; val_optim_loss: 17944737.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8891; val_auprc_score: 0.8587; val_best_acc_score: 0.8197; val_best_f1_score: 0.8344; train_kl_reg_loss: 99628.3761; train_edge_recon_loss: 2891468.4242; train_gene_expr_recon_loss: 10863862.5606; train_masked_gp_l1_reg_loss: 35671.7970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89842.3922; train_chrom_access_recon_loss: 4053592.7576; train_global_loss: 18034066.2727; train_optim_loss: 18034066.2727; val_kl_reg_loss: 96154.0117; val_edge_recon_loss: 2851606.4688; val_gene_expr_recon_loss: 10800903.2500; val_masked_gp_l1_reg_loss: 36579.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87891.0703; val_chrom_access_recon_loss: 3959294.9688; val_global_loss: 17832428.7500; val_optim_loss: 17832428.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8874; val_auprc_score: 0.8591; val_best_acc_score: 0.8197; val_best_f1_score: 0.8353; train_kl_reg_loss: 99447.1413; train_edge_recon_loss: 2858969.1742; train_gene_expr_recon_loss: 10811235.8788; train_masked_gp_l1_reg_loss: 37378.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86507.8668; train_chrom_access_recon_loss: 4030772.1591; train_global_loss: 17924310.7576; train_optim_loss: 17924310.7576; val_kl_reg_loss: 94054.7539; val_edge_recon_loss: 2910326.5938; val_gene_expr_recon_loss: 10767053.5000; val_masked_gp_l1_reg_loss: 38174.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85946.6953; val_chrom_access_recon_loss: 3960336.5938; val_global_loss: 17855892.5000; val_optim_loss: 17855892.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8930; val_auprc_score: 0.8643; val_best_acc_score: 0.8270; val_best_f1_score: 0.8424; train_kl_reg_loss: 98768.8327; train_edge_recon_loss: 2829092.0189; train_gene_expr_recon_loss: 10756930.2424; train_masked_gp_l1_reg_loss: 38889.1969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85457.0118; train_chrom_access_recon_loss: 4012086.0417; train_global_loss: 17821223.3636; train_optim_loss: 17821223.3636; val_kl_reg_loss: 100255.7314; val_edge_recon_loss: 2849182.1562; val_gene_expr_recon_loss: 10646803.1250; val_masked_gp_l1_reg_loss: 39624.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85307.8828; val_chrom_access_recon_loss: 3909844.9062; val_global_loss: 17631018.7500; val_optim_loss: 17631018.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8996; val_auprc_score: 0.8770; val_best_acc_score: 0.8283; val_best_f1_score: 0.8438; train_kl_reg_loss: 98800.3543; train_edge_recon_loss: 2827682.4811; train_gene_expr_recon_loss: 10719236.8485; train_masked_gp_l1_reg_loss: 40188.3088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85106.4134; train_chrom_access_recon_loss: 3997528.2311; train_global_loss: 17768542.7576; train_optim_loss: 17768542.7576; val_kl_reg_loss: 96197.9697; val_edge_recon_loss: 2862063.9062; val_gene_expr_recon_loss: 10495710.7500; val_masked_gp_l1_reg_loss: 40798.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84499.3984; val_chrom_access_recon_loss: 3858347.8438; val_global_loss: 17437617.5000; val_optim_loss: 17437617.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8963; val_auprc_score: 0.8719; val_best_acc_score: 0.8302; val_best_f1_score: 0.8409; train_kl_reg_loss: 97555.8559; train_edge_recon_loss: 2806910.4280; train_gene_expr_recon_loss: 10671745.7424; train_masked_gp_l1_reg_loss: 41392.7886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84609.8602; train_chrom_access_recon_loss: 3984533.9735; train_global_loss: 17686748.5758; train_optim_loss: 17686748.5758; val_kl_reg_loss: 97760.9824; val_edge_recon_loss: 2881919.7812; val_gene_expr_recon_loss: 10564488.5000; val_masked_gp_l1_reg_loss: 41954.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85215.6094; val_chrom_access_recon_loss: 3887463.2500; val_global_loss: 17558802.5000; val_optim_loss: 17558802.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9058; val_auprc_score: 0.8840; val_best_acc_score: 0.8350; val_best_f1_score: 0.8468; train_kl_reg_loss: 95112.7835; train_edge_recon_loss: 2805242.0417; train_gene_expr_recon_loss: 10621444.1818; train_masked_gp_l1_reg_loss: 42437.7186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85674.1426; train_chrom_access_recon_loss: 3967813.1894; train_global_loss: 17617724.2273; train_optim_loss: 17617724.2273; val_kl_reg_loss: 91795.1455; val_edge_recon_loss: 2821511.5625; val_gene_expr_recon_loss: 10489694.1250; val_masked_gp_l1_reg_loss: 42951.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86109.8516; val_chrom_access_recon_loss: 3883442.2812; val_global_loss: 17415504.2500; val_optim_loss: 17415504.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9095; val_auprc_score: 0.8854; val_best_acc_score: 0.8401; val_best_f1_score: 0.8544; train_kl_reg_loss: 93156.6113; train_edge_recon_loss: 2809007.6667; train_gene_expr_recon_loss: 10583734.6364; train_masked_gp_l1_reg_loss: 43370.7989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86149.9928; train_chrom_access_recon_loss: 3948430.2348; train_global_loss: 17563850.1061; train_optim_loss: 17563850.1061; val_kl_reg_loss: 92571.6084; val_edge_recon_loss: 2828689.1562; val_gene_expr_recon_loss: 10473856.0000; val_masked_gp_l1_reg_loss: 43859.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86100.9453; val_chrom_access_recon_loss: 3863107.8438; val_global_loss: 17388185.5000; val_optim_loss: 17388185.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9122; val_auprc_score: 0.8878; val_best_acc_score: 0.8418; val_best_f1_score: 0.8525; train_kl_reg_loss: 92963.0620; train_edge_recon_loss: 2785431.5492; train_gene_expr_recon_loss: 10544347.9545; train_masked_gp_l1_reg_loss: 44252.3400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86327.6374; train_chrom_access_recon_loss: 3940283.8106; train_global_loss: 17493606.5000; train_optim_loss: 17493606.5000; val_kl_reg_loss: 90642.8359; val_edge_recon_loss: 2819546.9062; val_gene_expr_recon_loss: 10474723.6250; val_masked_gp_l1_reg_loss: 44716.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86676.1797; val_chrom_access_recon_loss: 3822596.1250; val_global_loss: 17338902.5000; val_optim_loss: 17338902.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9153; val_auprc_score: 0.8918; val_best_acc_score: 0.8517; val_best_f1_score: 0.8612; train_kl_reg_loss: 90713.7733; train_edge_recon_loss: 2780382.0076; train_gene_expr_recon_loss: 10518029.6667; train_masked_gp_l1_reg_loss: 45100.8473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86246.8822; train_chrom_access_recon_loss: 3927167.8826; train_global_loss: 17447641.1061; train_optim_loss: 17447641.1061; val_kl_reg_loss: 89450.7656; val_edge_recon_loss: 2843062.0000; val_gene_expr_recon_loss: 10375862.2500; val_masked_gp_l1_reg_loss: 45512.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86145.2188; val_chrom_access_recon_loss: 3815636.3750; val_global_loss: 17255669.5000; val_optim_loss: 17255669.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9155; val_auprc_score: 0.8877; val_best_acc_score: 0.8493; val_best_f1_score: 0.8600; train_kl_reg_loss: 88890.6179; train_edge_recon_loss: 2772025.6364; train_gene_expr_recon_loss: 10486035.2879; train_masked_gp_l1_reg_loss: 45895.7803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86293.3681; train_chrom_access_recon_loss: 3917749.8523; train_global_loss: 17396890.5000; train_optim_loss: 17396890.5000; val_kl_reg_loss: 89247.5264; val_edge_recon_loss: 2831956.4062; val_gene_expr_recon_loss: 10416788.6250; val_masked_gp_l1_reg_loss: 46327.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86453.0312; val_chrom_access_recon_loss: 3828541.7812; val_global_loss: 17299315.0000; val_optim_loss: 17299315.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9240; val_auprc_score: 0.9035; val_best_acc_score: 0.8581; val_best_f1_score: 0.8657; train_kl_reg_loss: 86559.2208; train_edge_recon_loss: 2760944.1780; train_gene_expr_recon_loss: 10457134.8939; train_masked_gp_l1_reg_loss: 46646.3743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86339.3941; train_chrom_access_recon_loss: 3906141.4962; train_global_loss: 17343765.3788; train_optim_loss: 17343765.3788; val_kl_reg_loss: 87032.3652; val_edge_recon_loss: 2811585.2812; val_gene_expr_recon_loss: 10263464.8750; val_masked_gp_l1_reg_loss: 47028.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86257.4766; val_chrom_access_recon_loss: 3804302.9375; val_global_loss: 17099670.3750; val_optim_loss: 17099670.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9236; val_auprc_score: 0.8991; val_best_acc_score: 0.8619; val_best_f1_score: 0.8706; train_kl_reg_loss: 86017.2232; train_edge_recon_loss: 2752824.2652; train_gene_expr_recon_loss: 10437746.8636; train_masked_gp_l1_reg_loss: 47419.8828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86015.5839; train_chrom_access_recon_loss: 3896940.7386; train_global_loss: 17306964.5152; train_optim_loss: 17306964.5152; val_kl_reg_loss: 82917.0732; val_edge_recon_loss: 2779745.9375; val_gene_expr_recon_loss: 10329373.3750; val_masked_gp_l1_reg_loss: 47849.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85760.3047; val_chrom_access_recon_loss: 3822053.9062; val_global_loss: 17147699.0000; val_optim_loss: 17147699.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9257; val_auprc_score: 0.9021; val_best_acc_score: 0.8614; val_best_f1_score: 0.8696; train_kl_reg_loss: 85564.8965; train_edge_recon_loss: 2751169.7955; train_gene_expr_recon_loss: 10401042.9091; train_masked_gp_l1_reg_loss: 48105.7048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85801.5240; train_chrom_access_recon_loss: 3882260.7727; train_global_loss: 17253945.5303; train_optim_loss: 17253945.5303; val_kl_reg_loss: 84660.7861; val_edge_recon_loss: 2802985.5938; val_gene_expr_recon_loss: 10304604.6250; val_masked_gp_l1_reg_loss: 48547.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86036.5938; val_chrom_access_recon_loss: 3801086.6562; val_global_loss: 17127921.7500; val_optim_loss: 17127921.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9290; val_auprc_score: 0.9045; val_best_acc_score: 0.8700; val_best_f1_score: 0.8789; train_kl_reg_loss: 84790.4590; train_edge_recon_loss: 2737576.9773; train_gene_expr_recon_loss: 10374086.3636; train_masked_gp_l1_reg_loss: 48832.3354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85777.3948; train_chrom_access_recon_loss: 3871876.7614; train_global_loss: 17202940.1818; train_optim_loss: 17202940.1818; val_kl_reg_loss: 84611.1406; val_edge_recon_loss: 2777238.8750; val_gene_expr_recon_loss: 10280254.1250; val_masked_gp_l1_reg_loss: 49228.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85982.2422; val_chrom_access_recon_loss: 3786126.7188; val_global_loss: 17063440.6250; val_optim_loss: 17063440.6250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9350; val_auprc_score: 0.9161; val_best_acc_score: 0.8786; val_best_f1_score: 0.8835; train_kl_reg_loss: 83964.1621; train_edge_recon_loss: 2742613.3447; train_gene_expr_recon_loss: 10354671.1667; train_masked_gp_l1_reg_loss: 49457.7234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85769.6702; train_chrom_access_recon_loss: 3864467.6970; train_global_loss: 17180943.7879; train_optim_loss: 17180943.7879; val_kl_reg_loss: 81053.5742; val_edge_recon_loss: 2761810.3438; val_gene_expr_recon_loss: 10143611.2500; val_masked_gp_l1_reg_loss: 49701.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85676.5234; val_chrom_access_recon_loss: 3745575.3438; val_global_loss: 16867428.6250; val_optim_loss: 16867428.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9321; val_auprc_score: 0.9078; val_best_acc_score: 0.8743; val_best_f1_score: 0.8792; train_kl_reg_loss: 82872.8194; train_edge_recon_loss: 2746437.7992; train_gene_expr_recon_loss: 10327403.4091; train_masked_gp_l1_reg_loss: 50054.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85319.0659; train_chrom_access_recon_loss: 3851782.7197; train_global_loss: 17143870.0303; train_optim_loss: 17143870.0303; val_kl_reg_loss: 81544.0947; val_edge_recon_loss: 2766519.6562; val_gene_expr_recon_loss: 10225647.3750; val_masked_gp_l1_reg_loss: 50375.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85798.9922; val_chrom_access_recon_loss: 3770307.3438; val_global_loss: 16980192.2500; val_optim_loss: 16980192.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9411; val_auprc_score: 0.9195; val_best_acc_score: 0.8842; val_best_f1_score: 0.8887; train_kl_reg_loss: 83312.4621; train_edge_recon_loss: 2733787.3333; train_gene_expr_recon_loss: 10307829.5606; train_masked_gp_l1_reg_loss: 50692.0839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85706.9326; train_chrom_access_recon_loss: 3846896.0341; train_global_loss: 17108224.4242; train_optim_loss: 17108224.4242; val_kl_reg_loss: 82945.3926; val_edge_recon_loss: 2714828.0000; val_gene_expr_recon_loss: 10287715.1250; val_masked_gp_l1_reg_loss: 51052.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85876.1250; val_chrom_access_recon_loss: 3794867.5625; val_global_loss: 17017284.2500; val_optim_loss: 17017284.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9328; val_auprc_score: 0.9070; val_best_acc_score: 0.8740; val_best_f1_score: 0.8831; train_kl_reg_loss: 81946.0621; train_edge_recon_loss: 2728994.6970; train_gene_expr_recon_loss: 10283881.2273; train_masked_gp_l1_reg_loss: 51230.3562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85874.3410; train_chrom_access_recon_loss: 3836005.5227; train_global_loss: 17067932.2273; train_optim_loss: 17067932.2273; val_kl_reg_loss: 80568.0645; val_edge_recon_loss: 2770332.8750; val_gene_expr_recon_loss: 10136346.8750; val_masked_gp_l1_reg_loss: 51487.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86223.1172; val_chrom_access_recon_loss: 3751947.0000; val_global_loss: 16876904.3750; val_optim_loss: 16876904.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9452; val_auprc_score: 0.9249; val_best_acc_score: 0.8847; val_best_f1_score: 0.8884; train_kl_reg_loss: 83119.7375; train_edge_recon_loss: 2728785.6136; train_gene_expr_recon_loss: 10254488.3788; train_masked_gp_l1_reg_loss: 51754.6699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86235.7391; train_chrom_access_recon_loss: 3822228.6250; train_global_loss: 17026612.7727; train_optim_loss: 17026612.7727; val_kl_reg_loss: 81452.0879; val_edge_recon_loss: 2753633.6250; val_gene_expr_recon_loss: 10178730.1250; val_masked_gp_l1_reg_loss: 52054.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86363.6172; val_chrom_access_recon_loss: 3752638.6875; val_global_loss: 16904873.5000; val_optim_loss: 16904873.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9350; val_auprc_score: 0.9128; val_best_acc_score: 0.8740; val_best_f1_score: 0.8796; train_kl_reg_loss: 84305.1856; train_edge_recon_loss: 2754489.7045; train_gene_expr_recon_loss: 10106938.0000; train_masked_gp_l1_reg_loss: 51557.1442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66890.0910; train_chrom_access_recon_loss: 3844711.0833; train_global_loss: 16908891.1818; train_optim_loss: 16908891.1818; val_kl_reg_loss: 56024.0698; val_edge_recon_loss: 2793437.2812; val_gene_expr_recon_loss: 10031395.5000; val_masked_gp_l1_reg_loss: 51194.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63297.6367; val_chrom_access_recon_loss: 3779876.7500; val_global_loss: 16775226.6250; val_optim_loss: 16775226.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9376; val_auprc_score: 0.9166; val_best_acc_score: 0.8796; val_best_f1_score: 0.8844; train_kl_reg_loss: 89265.3106; train_edge_recon_loss: 2745062.7879; train_gene_expr_recon_loss: 10084403.3333; train_masked_gp_l1_reg_loss: 51075.4554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62994.2328; train_chrom_access_recon_loss: 3792147.1705; train_global_loss: 16824948.2727; train_optim_loss: 16824948.2727; val_kl_reg_loss: 57845.3281; val_edge_recon_loss: 2751918.5938; val_gene_expr_recon_loss: 10053205.2500; val_masked_gp_l1_reg_loss: 50993.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62774.7188; val_chrom_access_recon_loss: 3722673.0312; val_global_loss: 16699410.3750; val_optim_loss: 16699410.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9374; val_auprc_score: 0.9139; val_best_acc_score: 0.8818; val_best_f1_score: 0.8871; train_kl_reg_loss: 90507.4476; train_edge_recon_loss: 2750440.5492; train_gene_expr_recon_loss: 10082356.9091; train_masked_gp_l1_reg_loss: 50967.7606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62597.1090; train_chrom_access_recon_loss: 3788500.8977; train_global_loss: 16825370.5909; train_optim_loss: 16825370.5909; val_kl_reg_loss: 58277.2124; val_edge_recon_loss: 2767733.5312; val_gene_expr_recon_loss: 10066679.1250; val_masked_gp_l1_reg_loss: 50946.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62466.7852; val_chrom_access_recon_loss: 3698835.9688; val_global_loss: 16704939.8750; val_optim_loss: 16704939.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9382; val_auprc_score: 0.9111; val_best_acc_score: 0.8794; val_best_f1_score: 0.8848; train_kl_reg_loss: 92558.7678; train_edge_recon_loss: 2744211.8939; train_gene_expr_recon_loss: 10081363.6970; train_masked_gp_l1_reg_loss: 50944.6056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62328.8007; train_chrom_access_recon_loss: 3783461.2348; train_global_loss: 16814869.0909; train_optim_loss: 16814869.0909; val_kl_reg_loss: 59965.2295; val_edge_recon_loss: 2742464.9688; val_gene_expr_recon_loss: 9964692.0000; val_masked_gp_l1_reg_loss: 50936.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62253.0586; val_chrom_access_recon_loss: 3706990.5625; val_global_loss: 16587303.0000; val_optim_loss: 16587303.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9357; val_auprc_score: 0.9141; val_best_acc_score: 0.8737; val_best_f1_score: 0.8807; train_kl_reg_loss: 91876.6429; train_edge_recon_loss: 2743136.1780; train_gene_expr_recon_loss: 10073643.5758; train_masked_gp_l1_reg_loss: 50941.4179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62149.6062; train_chrom_access_recon_loss: 3782541.6364; train_global_loss: 16804289.0606; train_optim_loss: 16804289.0606; val_kl_reg_loss: 59948.1714; val_edge_recon_loss: 2755870.1875; val_gene_expr_recon_loss: 9980123.2500; val_masked_gp_l1_reg_loss: 50948.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62101.9688; val_chrom_access_recon_loss: 3722077.1562; val_global_loss: 16631068.7500; val_optim_loss: 16631068.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9372; val_auprc_score: 0.9182; val_best_acc_score: 0.8753; val_best_f1_score: 0.8822; train_kl_reg_loss: 90831.2638; train_edge_recon_loss: 2732606.4659; train_gene_expr_recon_loss: 10071132.3636; train_masked_gp_l1_reg_loss: 50970.6209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62034.6967; train_chrom_access_recon_loss: 3779518.5682; train_global_loss: 16787093.8333; train_optim_loss: 16787093.8333; val_kl_reg_loss: 60851.0469; val_edge_recon_loss: 2779641.7812; val_gene_expr_recon_loss: 9998124.6250; val_masked_gp_l1_reg_loss: 50984.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61987.2305; val_chrom_access_recon_loss: 3697439.4688; val_global_loss: 16649028.7500; val_optim_loss: 16649028.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9392; val_auprc_score: 0.9160; val_best_acc_score: 0.8769; val_best_f1_score: 0.8835; train_kl_reg_loss: 91644.6682; train_edge_recon_loss: 2731785.3409; train_gene_expr_recon_loss: 10062727.5909; train_masked_gp_l1_reg_loss: 50999.1526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61920.3199; train_chrom_access_recon_loss: 3778326.5076; train_global_loss: 16777403.5303; train_optim_loss: 16777403.5303; val_kl_reg_loss: 61229.6172; val_edge_recon_loss: 2785639.4688; val_gene_expr_recon_loss: 10007349.0000; val_masked_gp_l1_reg_loss: 51007.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61978.7148; val_chrom_access_recon_loss: 3715940.6250; val_global_loss: 16683144.7500; val_optim_loss: 16683144.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9341; val_auprc_score: 0.9080; val_best_acc_score: 0.8724; val_best_f1_score: 0.8794; train_kl_reg_loss: 91366.2730; train_edge_recon_loss: 2723391.0758; train_gene_expr_recon_loss: 10057306.1061; train_masked_gp_l1_reg_loss: 51025.3809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61925.0785; train_chrom_access_recon_loss: 3776775.0379; train_global_loss: 16761788.8030; train_optim_loss: 16761788.8030; val_kl_reg_loss: 62382.2661; val_edge_recon_loss: 2782235.3125; val_gene_expr_recon_loss: 9982159.8750; val_masked_gp_l1_reg_loss: 51036.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61874.0000; val_chrom_access_recon_loss: 3674471.9062; val_global_loss: 16614160.2500; val_optim_loss: 16614160.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9428; val_auprc_score: 0.9219; val_best_acc_score: 0.8837; val_best_f1_score: 0.8885; train_kl_reg_loss: 90857.6874; train_edge_recon_loss: 2733609.2538; train_gene_expr_recon_loss: 10055611.2879; train_masked_gp_l1_reg_loss: 51021.8472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59996.7422; train_chrom_access_recon_loss: 3775931.4470; train_global_loss: 16767028.2424; train_optim_loss: 16767028.2424; val_kl_reg_loss: 62195.6426; val_edge_recon_loss: 2772356.0312; val_gene_expr_recon_loss: 9931837.0000; val_masked_gp_l1_reg_loss: 51012.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59656.4180; val_chrom_access_recon_loss: 3708279.2812; val_global_loss: 16585337.0000; val_optim_loss: 16585337.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9399; val_auprc_score: 0.9191; val_best_acc_score: 0.8815; val_best_f1_score: 0.8874; train_kl_reg_loss: 90959.8349; train_edge_recon_loss: 2738138.2917; train_gene_expr_recon_loss: 10061095.6364; train_masked_gp_l1_reg_loss: 51008.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59636.7705; train_chrom_access_recon_loss: 3776482.2311; train_global_loss: 16777321.2424; train_optim_loss: 16777321.2424; val_kl_reg_loss: 62794.5757; val_edge_recon_loss: 2758550.5312; val_gene_expr_recon_loss: 10081904.2500; val_masked_gp_l1_reg_loss: 51005.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59624.0859; val_chrom_access_recon_loss: 3766614.8125; val_global_loss: 16780493.1250; val_optim_loss: 16780493.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9414; val_auprc_score: 0.9184; val_best_acc_score: 0.8869; val_best_f1_score: 0.8919; train_kl_reg_loss: 90701.3172; train_edge_recon_loss: 2727346.0341; train_gene_expr_recon_loss: 10047104.4394; train_masked_gp_l1_reg_loss: 51004.1473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59613.9000; train_chrom_access_recon_loss: 3773273.8333; train_global_loss: 16749043.6364; train_optim_loss: 16749043.6364; val_kl_reg_loss: 62178.3291; val_edge_recon_loss: 2724521.0000; val_gene_expr_recon_loss: 9951248.6250; val_masked_gp_l1_reg_loss: 51002.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59602.5234; val_chrom_access_recon_loss: 3715720.9375; val_global_loss: 16564274.7500; val_optim_loss: 16564274.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9424; val_auprc_score: 0.9224; val_best_acc_score: 0.8831; val_best_f1_score: 0.8887; train_kl_reg_loss: 90431.3665; train_edge_recon_loss: 2715251.8258; train_gene_expr_recon_loss: 10044668.7879; train_masked_gp_l1_reg_loss: 51002.5286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59600.6659; train_chrom_access_recon_loss: 3777748.6061; train_global_loss: 16738703.6818; train_optim_loss: 16738703.6818; val_kl_reg_loss: 62232.1289; val_edge_recon_loss: 2763023.4375; val_gene_expr_recon_loss: 9930090.2500; val_masked_gp_l1_reg_loss: 51002.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59598.6602; val_chrom_access_recon_loss: 3670621.9375; val_global_loss: 16536569.1250; val_optim_loss: 16536569.1250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9378; val_auprc_score: 0.9182; val_best_acc_score: 0.8775; val_best_f1_score: 0.8841; train_kl_reg_loss: 90290.2650; train_edge_recon_loss: 2722965.5530; train_gene_expr_recon_loss: 10056526.6818; train_masked_gp_l1_reg_loss: 51003.9577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59597.0130; train_chrom_access_recon_loss: 3775977.1402; train_global_loss: 16756360.5152; train_optim_loss: 16756360.5152; val_kl_reg_loss: 62574.2451; val_edge_recon_loss: 2760049.4062; val_gene_expr_recon_loss: 9974464.2500; val_masked_gp_l1_reg_loss: 51004.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59603.5938; val_chrom_access_recon_loss: 3716612.5938; val_global_loss: 16624308.6250; val_optim_loss: 16624308.6250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9416; val_auprc_score: 0.9221; val_best_acc_score: 0.8821; val_best_f1_score: 0.8869; train_kl_reg_loss: 90237.5658; train_edge_recon_loss: 2732708.5265; train_gene_expr_recon_loss: 10052269.4394; train_masked_gp_l1_reg_loss: 51004.8732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59594.2134; train_chrom_access_recon_loss: 3775240.9773; train_global_loss: 16761055.5000; train_optim_loss: 16761055.5000; val_kl_reg_loss: 62625.6118; val_edge_recon_loss: 2784470.4062; val_gene_expr_recon_loss: 9892855.1250; val_masked_gp_l1_reg_loss: 51004.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59590.8672; val_chrom_access_recon_loss: 3712252.0000; val_global_loss: 16562798.8750; val_optim_loss: 16562798.8750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9330; val_auprc_score: 0.9081; val_best_acc_score: 0.8710; val_best_f1_score: 0.8776; train_kl_reg_loss: 90099.8434; train_edge_recon_loss: 2732776.8598; train_gene_expr_recon_loss: 10055797.3333; train_masked_gp_l1_reg_loss: 51006.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59590.4359; train_chrom_access_recon_loss: 3776902.0985; train_global_loss: 16766173.4091; train_optim_loss: 16766173.4091; val_kl_reg_loss: 62196.6973; val_edge_recon_loss: 2771788.4688; val_gene_expr_recon_loss: 9871759.7500; val_masked_gp_l1_reg_loss: 51006.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59589.3516; val_chrom_access_recon_loss: 3683613.1250; val_global_loss: 16499953.8750; val_optim_loss: 16499953.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9415; val_auprc_score: 0.9212; val_best_acc_score: 0.8837; val_best_f1_score: 0.8891; train_kl_reg_loss: 90005.0489; train_edge_recon_loss: 2736404.2614; train_gene_expr_recon_loss: 10050967.6970; train_masked_gp_l1_reg_loss: 51008.8381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59589.7660; train_chrom_access_recon_loss: 3775862.1326; train_global_loss: 16763837.7121; train_optim_loss: 16763837.7121; val_kl_reg_loss: 62308.4170; val_edge_recon_loss: 2735027.0000; val_gene_expr_recon_loss: 9896661.8750; val_masked_gp_l1_reg_loss: 51008.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59584.3125; val_chrom_access_recon_loss: 3687015.1875; val_global_loss: 16491605.6250; val_optim_loss: 16491605.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9391; val_auprc_score: 0.9216; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 89627.3839; train_edge_recon_loss: 2730772.6667; train_gene_expr_recon_loss: 10053771.4697; train_masked_gp_l1_reg_loss: 51010.5847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59581.3694; train_chrom_access_recon_loss: 3777670.5492; train_global_loss: 16762434.0000; train_optim_loss: 16762434.0000; val_kl_reg_loss: 61975.6460; val_edge_recon_loss: 2758883.8438; val_gene_expr_recon_loss: 9961766.2500; val_masked_gp_l1_reg_loss: 51011.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59583.5625; val_chrom_access_recon_loss: 3692832.4688; val_global_loss: 16586053.2500; val_optim_loss: 16586053.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9343; val_auprc_score: 0.9087; val_best_acc_score: 0.8778; val_best_f1_score: 0.8842; train_kl_reg_loss: 89758.7633; train_edge_recon_loss: 2732081.3902; train_gene_expr_recon_loss: 10050679.7727; train_masked_gp_l1_reg_loss: 51013.6621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59579.4216; train_chrom_access_recon_loss: 3770648.8523; train_global_loss: 16753761.6515; train_optim_loss: 16753761.6515; val_kl_reg_loss: 62002.7158; val_edge_recon_loss: 2768049.7500; val_gene_expr_recon_loss: 9883612.0000; val_masked_gp_l1_reg_loss: 51014.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59576.2109; val_chrom_access_recon_loss: 3655463.6562; val_global_loss: 16479718.0000; val_optim_loss: 16479718.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9397; val_auprc_score: 0.9186; val_best_acc_score: 0.8839; val_best_f1_score: 0.8884; train_kl_reg_loss: 89487.9875; train_edge_recon_loss: 2726489.0682; train_gene_expr_recon_loss: 10048364.0303; train_masked_gp_l1_reg_loss: 51016.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59570.2457; train_chrom_access_recon_loss: 3774805.4886; train_global_loss: 16749732.8939; train_optim_loss: 16749732.8939; val_kl_reg_loss: 62143.3838; val_edge_recon_loss: 2774428.9375; val_gene_expr_recon_loss: 9952717.2500; val_masked_gp_l1_reg_loss: 51017.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59563.1562; val_chrom_access_recon_loss: 3699557.8438; val_global_loss: 16599427.3750; val_optim_loss: 16599427.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9409; val_auprc_score: 0.9235; val_best_acc_score: 0.8786; val_best_f1_score: 0.8844; train_kl_reg_loss: 89711.5626; train_edge_recon_loss: 2728799.6250; train_gene_expr_recon_loss: 10046702.7727; train_masked_gp_l1_reg_loss: 51019.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59566.4167; train_chrom_access_recon_loss: 3773977.4962; train_global_loss: 16749777.2121; train_optim_loss: 16749777.2121; val_kl_reg_loss: 62214.8843; val_edge_recon_loss: 2782343.3438; val_gene_expr_recon_loss: 9991989.1250; val_masked_gp_l1_reg_loss: 51019.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59566.1719; val_chrom_access_recon_loss: 3700545.0000; val_global_loss: 16647678.6250; val_optim_loss: 16647678.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9382; val_auprc_score: 0.9187; val_best_acc_score: 0.8791; val_best_f1_score: 0.8853; train_kl_reg_loss: 89546.9825; train_edge_recon_loss: 2724964.2803; train_gene_expr_recon_loss: 10049147.1364; train_masked_gp_l1_reg_loss: 51021.5630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59560.9934; train_chrom_access_recon_loss: 3774148.5720; train_global_loss: 16748389.6818; train_optim_loss: 16748389.6818; val_kl_reg_loss: 61938.5356; val_edge_recon_loss: 2747883.9688; val_gene_expr_recon_loss: 9898319.8750; val_masked_gp_l1_reg_loss: 51022.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59557.9297; val_chrom_access_recon_loss: 3671618.1562; val_global_loss: 16490341.1250; val_optim_loss: 16490341.1250
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9403; val_auprc_score: 0.9204; val_best_acc_score: 0.8845; val_best_f1_score: 0.8898; train_kl_reg_loss: 89648.3699; train_edge_recon_loss: 2733592.1591; train_gene_expr_recon_loss: 10048391.3939; train_masked_gp_l1_reg_loss: 51023.9815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59557.4318; train_chrom_access_recon_loss: 3778010.2992; train_global_loss: 16760223.6970; train_optim_loss: 16760223.6970; val_kl_reg_loss: 62527.7627; val_edge_recon_loss: 2734357.7188; val_gene_expr_recon_loss: 9933693.6250; val_masked_gp_l1_reg_loss: 51024.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59558.5039; val_chrom_access_recon_loss: 3692466.1250; val_global_loss: 16533629.3750; val_optim_loss: 16533629.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9374; val_auprc_score: 0.9165; val_best_acc_score: 0.8799; val_best_f1_score: 0.8859; train_kl_reg_loss: 89562.6051; train_edge_recon_loss: 2727467.5909; train_gene_expr_recon_loss: 10051520.7273; train_masked_gp_l1_reg_loss: 51023.2812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59368.0906; train_chrom_access_recon_loss: 3773950.6477; train_global_loss: 16752893.0303; train_optim_loss: 16752893.0303; val_kl_reg_loss: 62361.9937; val_edge_recon_loss: 2765880.9062; val_gene_expr_recon_loss: 10070406.8750; val_masked_gp_l1_reg_loss: 51022.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59334.1680; val_chrom_access_recon_loss: 3733809.2812; val_global_loss: 16742814.8750; val_optim_loss: 16742814.8750
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9376; val_auprc_score: 0.9206; val_best_acc_score: 0.8794; val_best_f1_score: 0.8855; train_kl_reg_loss: 89431.5005; train_edge_recon_loss: 2726106.5303; train_gene_expr_recon_loss: 10040740.5000; train_masked_gp_l1_reg_loss: 51022.0098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59333.0811; train_chrom_access_recon_loss: 3768848.7576; train_global_loss: 16735482.2273; train_optim_loss: 16735482.2273; val_kl_reg_loss: 62139.4287; val_edge_recon_loss: 2765598.0625; val_gene_expr_recon_loss: 9934412.6250; val_masked_gp_l1_reg_loss: 51021.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59331.8867; val_chrom_access_recon_loss: 3702334.8125; val_global_loss: 16574839.1250; val_optim_loss: 16574839.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9375; val_auprc_score: 0.9159; val_best_acc_score: 0.8769; val_best_f1_score: 0.8830; train_kl_reg_loss: 89436.6136; train_edge_recon_loss: 2725881.8750; train_gene_expr_recon_loss: 10050979.5000; train_masked_gp_l1_reg_loss: 51021.5218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59330.9748; train_chrom_access_recon_loss: 3775414.8485; train_global_loss: 16752065.2424; train_optim_loss: 16752065.2424; val_kl_reg_loss: 62032.9014; val_edge_recon_loss: 2765861.0000; val_gene_expr_recon_loss: 9912519.2500; val_masked_gp_l1_reg_loss: 51021.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59329.7969; val_chrom_access_recon_loss: 3686431.9375; val_global_loss: 16537196.2500; val_optim_loss: 16537196.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9294; val_auprc_score: 0.9064; val_best_acc_score: 0.8692; val_best_f1_score: 0.8760; train_kl_reg_loss: 89375.9039; train_edge_recon_loss: 2730898.2538; train_gene_expr_recon_loss: 10046661.5455; train_masked_gp_l1_reg_loss: 51021.2901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59329.8071; train_chrom_access_recon_loss: 3771956.1098; train_global_loss: 16749242.6364; train_optim_loss: 16749242.6364; val_kl_reg_loss: 62221.9844; val_edge_recon_loss: 2789040.0000; val_gene_expr_recon_loss: 9936509.5000; val_masked_gp_l1_reg_loss: 51021.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59329.2266; val_chrom_access_recon_loss: 3683700.5000; val_global_loss: 16581822.0000; val_optim_loss: 16581822.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 18 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9365
val AUPRC score: 0.9170
val best accuracy score: 0.8753
val best F1 score: 0.8817
val target rna MSE score: 1.4951
val source rna MSE score: 0.6242
val target atac MSE score: 0.4542
val source atac MSE score: 0.1014
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
