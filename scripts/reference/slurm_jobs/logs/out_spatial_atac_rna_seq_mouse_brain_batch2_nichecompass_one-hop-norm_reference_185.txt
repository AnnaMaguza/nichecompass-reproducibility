[True]
Run timestamp: 08082023_073423_185.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_185']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7191; val_auprc_score: 0.7426; val_best_acc_score: 0.6200; val_best_f1_score: 0.6900; train_kl_reg_loss: 13963.9740; train_edge_recon_loss: 37434.8773; train_gene_expr_recon_loss: 530746.0166; train_masked_gp_l1_reg_loss: 5703.8251; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262635.5386; train_global_loss: 850484.2320; train_optim_loss: 850484.2320; val_kl_reg_loss: 23068.8357; val_edge_recon_loss: 40566.4580; val_gene_expr_recon_loss: 451483.3594; val_masked_gp_l1_reg_loss: 5751.7812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250567.9824; val_global_loss: 771438.3906; val_optim_loss: 771438.3906
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7900; val_auprc_score: 0.7985; val_best_acc_score: 0.7106; val_best_f1_score: 0.7254; train_kl_reg_loss: 22870.5996; train_edge_recon_loss: 39075.8273; train_gene_expr_recon_loss: 431807.5616; train_masked_gp_l1_reg_loss: 5773.6966; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246973.7436; train_global_loss: 746501.4299; train_optim_loss: 746501.4299; val_kl_reg_loss: 21054.5259; val_edge_recon_loss: 40459.4751; val_gene_expr_recon_loss: 425546.1484; val_masked_gp_l1_reg_loss: 5842.1494; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244441.1699; val_global_loss: 737343.4688; val_optim_loss: 737343.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8886; val_auprc_score: 0.8813; val_best_acc_score: 0.7807; val_best_f1_score: 0.7521; train_kl_reg_loss: 21169.6420; train_edge_recon_loss: 38876.3529; train_gene_expr_recon_loss: 415734.9754; train_masked_gp_l1_reg_loss: 5927.3023; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241192.4382; train_global_loss: 722900.7093; train_optim_loss: 722900.7093; val_kl_reg_loss: 20247.0200; val_edge_recon_loss: 40179.0327; val_gene_expr_recon_loss: 413976.0312; val_masked_gp_l1_reg_loss: 6021.0713; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238859.4453; val_global_loss: 719282.5859; val_optim_loss: 719282.5859
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9174; val_auprc_score: 0.9064; val_best_acc_score: 0.7759; val_best_f1_score: 0.8134; train_kl_reg_loss: 19254.9458; train_edge_recon_loss: 38549.0252; train_gene_expr_recon_loss: 408381.9896; train_masked_gp_l1_reg_loss: 6085.5202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237406.2853; train_global_loss: 709677.7699; train_optim_loss: 709677.7699; val_kl_reg_loss: 19413.2869; val_edge_recon_loss: 39897.7373; val_gene_expr_recon_loss: 410750.0586; val_masked_gp_l1_reg_loss: 6152.1162; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235223.7441; val_global_loss: 711436.9375; val_optim_loss: 711436.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9273; val_auprc_score: 0.9177; val_best_acc_score: 0.8379; val_best_f1_score: 0.8545; train_kl_reg_loss: 17883.8607; train_edge_recon_loss: 38225.6655; train_gene_expr_recon_loss: 403943.3295; train_masked_gp_l1_reg_loss: 6201.9454; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234827.1203; train_global_loss: 701081.9261; train_optim_loss: 701081.9261; val_kl_reg_loss: 17321.5371; val_edge_recon_loss: 39559.2837; val_gene_expr_recon_loss: 407057.0547; val_masked_gp_l1_reg_loss: 6265.9521; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234136.7344; val_global_loss: 704340.5547; val_optim_loss: 704340.5547
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9288; val_auprc_score: 0.9225; val_best_acc_score: 0.8447; val_best_f1_score: 0.8561; train_kl_reg_loss: 16773.4524; train_edge_recon_loss: 37923.9086; train_gene_expr_recon_loss: 400152.1776; train_masked_gp_l1_reg_loss: 6303.9008; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232280.3374; train_global_loss: 693433.7746; train_optim_loss: 693433.7746; val_kl_reg_loss: 16548.8345; val_edge_recon_loss: 39250.2051; val_gene_expr_recon_loss: 405856.2383; val_masked_gp_l1_reg_loss: 6350.3604; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233409.9707; val_global_loss: 701415.6172; val_optim_loss: 701415.6172
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9338; val_auprc_score: 0.9261; val_best_acc_score: 0.8577; val_best_f1_score: 0.8615; train_kl_reg_loss: 15816.0462; train_edge_recon_loss: 37666.5578; train_gene_expr_recon_loss: 397553.3073; train_masked_gp_l1_reg_loss: 6392.0513; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 230812.2045; train_global_loss: 688240.1638; train_optim_loss: 688240.1638; val_kl_reg_loss: 15131.0797; val_edge_recon_loss: 38997.4834; val_gene_expr_recon_loss: 405604.2188; val_masked_gp_l1_reg_loss: 6436.6787; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231565.4316; val_global_loss: 697734.9219; val_optim_loss: 697734.9219
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9364; val_auprc_score: 0.9294; val_best_acc_score: 0.8530; val_best_f1_score: 0.8621; train_kl_reg_loss: 15136.3163; train_edge_recon_loss: 37432.3252; train_gene_expr_recon_loss: 394657.2723; train_masked_gp_l1_reg_loss: 6467.8545; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 228762.6181; train_global_loss: 682456.3911; train_optim_loss: 682456.3911; val_kl_reg_loss: 14412.6993; val_edge_recon_loss: 38743.6060; val_gene_expr_recon_loss: 400352.0781; val_masked_gp_l1_reg_loss: 6500.3862; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229122.3613; val_global_loss: 689131.1172; val_optim_loss: 689131.1172
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9409; val_auprc_score: 0.9366; val_best_acc_score: 0.8615; val_best_f1_score: 0.8689; train_kl_reg_loss: 14573.8466; train_edge_recon_loss: 37190.5173; train_gene_expr_recon_loss: 391890.5047; train_masked_gp_l1_reg_loss: 6532.2306; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 227334.0194; train_global_loss: 677521.1184; train_optim_loss: 677521.1184; val_kl_reg_loss: 13703.9453; val_edge_recon_loss: 38485.1431; val_gene_expr_recon_loss: 397661.9453; val_masked_gp_l1_reg_loss: 6575.8228; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229973.2266; val_global_loss: 686400.0781; val_optim_loss: 686400.0781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9439; val_auprc_score: 0.9411; val_best_acc_score: 0.8634; val_best_f1_score: 0.8675; train_kl_reg_loss: 14055.8767; train_edge_recon_loss: 36961.5578; train_gene_expr_recon_loss: 389502.8859; train_masked_gp_l1_reg_loss: 6599.6420; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 226198.4020; train_global_loss: 673318.3608; train_optim_loss: 673318.3608; val_kl_reg_loss: 14086.1326; val_edge_recon_loss: 38313.0186; val_gene_expr_recon_loss: 395504.0703; val_masked_gp_l1_reg_loss: 6631.1963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 225671.2656; val_global_loss: 680205.6641; val_optim_loss: 680205.6641
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9473; val_auprc_score: 0.9428; val_best_acc_score: 0.8739; val_best_f1_score: 0.8727; train_kl_reg_loss: 13650.3879; train_edge_recon_loss: 36768.0972; train_gene_expr_recon_loss: 387249.8419; train_masked_gp_l1_reg_loss: 6656.8041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 224913.6383; train_global_loss: 669238.7680; train_optim_loss: 669238.7680; val_kl_reg_loss: 13371.7766; val_edge_recon_loss: 38016.3682; val_gene_expr_recon_loss: 392857.1484; val_masked_gp_l1_reg_loss: 6681.3076; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 225680.5312; val_global_loss: 676607.1484; val_optim_loss: 676607.1484
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9504; val_auprc_score: 0.9505; val_best_acc_score: 0.8735; val_best_f1_score: 0.8781; train_kl_reg_loss: 13310.4160; train_edge_recon_loss: 36572.6148; train_gene_expr_recon_loss: 385166.3963; train_masked_gp_l1_reg_loss: 6705.4600; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 223394.5871; train_global_loss: 665149.4744; train_optim_loss: 665149.4744; val_kl_reg_loss: 12360.5099; val_edge_recon_loss: 37737.6675; val_gene_expr_recon_loss: 393454.5898; val_masked_gp_l1_reg_loss: 6741.0063; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 223181.9062; val_global_loss: 673475.6719; val_optim_loss: 673475.6719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9492; val_auprc_score: 0.9485; val_best_acc_score: 0.8717; val_best_f1_score: 0.8735; train_kl_reg_loss: 12985.4391; train_edge_recon_loss: 36404.0443; train_gene_expr_recon_loss: 382950.2902; train_masked_gp_l1_reg_loss: 6758.5521; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 222460.8407; train_global_loss: 661559.1714; train_optim_loss: 661559.1714; val_kl_reg_loss: 12615.3137; val_edge_recon_loss: 37643.0864; val_gene_expr_recon_loss: 389737.4844; val_masked_gp_l1_reg_loss: 6785.6494; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 223663.9141; val_global_loss: 670445.4531; val_optim_loss: 670445.4531
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9570; val_auprc_score: 0.9554; val_best_acc_score: 0.8825; val_best_f1_score: 0.8828; train_kl_reg_loss: 12755.0489; train_edge_recon_loss: 36226.6164; train_gene_expr_recon_loss: 381178.3092; train_masked_gp_l1_reg_loss: 6809.7159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 221837.0791; train_global_loss: 658806.7699; train_optim_loss: 658806.7699; val_kl_reg_loss: 12287.6333; val_edge_recon_loss: 37348.5679; val_gene_expr_recon_loss: 393514.2734; val_masked_gp_l1_reg_loss: 6840.3901; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 220834.7266; val_global_loss: 670825.5859; val_optim_loss: 670825.5859
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9551; val_auprc_score: 0.9552; val_best_acc_score: 0.8801; val_best_f1_score: 0.8827; train_kl_reg_loss: 12506.2333; train_edge_recon_loss: 36069.1415; train_gene_expr_recon_loss: 378976.7221; train_masked_gp_l1_reg_loss: 6853.6193; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 221091.5301; train_global_loss: 655497.2491; train_optim_loss: 655497.2491; val_kl_reg_loss: 11966.1487; val_edge_recon_loss: 37222.3413; val_gene_expr_recon_loss: 388289.3828; val_masked_gp_l1_reg_loss: 6882.6655; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 222997.0195; val_global_loss: 667357.5547; val_optim_loss: 667357.5547
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9612; val_auprc_score: 0.9609; val_best_acc_score: 0.8886; val_best_f1_score: 0.8880; train_kl_reg_loss: 12269.8945; train_edge_recon_loss: 35908.7521; train_gene_expr_recon_loss: 376857.7012; train_masked_gp_l1_reg_loss: 6903.7641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 219822.9728; train_global_loss: 651763.0862; train_optim_loss: 651763.0862; val_kl_reg_loss: 12044.3829; val_edge_recon_loss: 37041.5103; val_gene_expr_recon_loss: 382892.2344; val_masked_gp_l1_reg_loss: 6932.9531; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 220666.7344; val_global_loss: 659577.8203; val_optim_loss: 659577.8203
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9646; val_auprc_score: 0.9639; val_best_acc_score: 0.8942; val_best_f1_score: 0.8964; train_kl_reg_loss: 12112.8046; train_edge_recon_loss: 35746.7994; train_gene_expr_recon_loss: 375257.3153; train_masked_gp_l1_reg_loss: 6948.2468; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 219428.8726; train_global_loss: 649494.0360; train_optim_loss: 649494.0360; val_kl_reg_loss: 11979.9189; val_edge_recon_loss: 36766.7832; val_gene_expr_recon_loss: 384094.2812; val_masked_gp_l1_reg_loss: 6972.4600; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 220197.8438; val_global_loss: 660011.2969; val_optim_loss: 660011.2969
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9659; val_auprc_score: 0.9648; val_best_acc_score: 0.8983; val_best_f1_score: 0.8986; train_kl_reg_loss: 11944.7395; train_edge_recon_loss: 35572.9439; train_gene_expr_recon_loss: 373034.5767; train_masked_gp_l1_reg_loss: 6995.8832; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 218404.0204; train_global_loss: 645952.1638; train_optim_loss: 645952.1638; val_kl_reg_loss: 11842.8558; val_edge_recon_loss: 36706.0171; val_gene_expr_recon_loss: 383246.6211; val_masked_gp_l1_reg_loss: 7025.3105; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 218302.3164; val_global_loss: 657123.1250; val_optim_loss: 657123.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9683; val_auprc_score: 0.9685; val_best_acc_score: 0.8995; val_best_f1_score: 0.9013; train_kl_reg_loss: 11825.0899; train_edge_recon_loss: 35463.9874; train_gene_expr_recon_loss: 371106.2268; train_masked_gp_l1_reg_loss: 7043.4062; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 217396.4716; train_global_loss: 642835.1818; train_optim_loss: 642835.1818; val_kl_reg_loss: 11509.9611; val_edge_recon_loss: 36410.0298; val_gene_expr_recon_loss: 384066.9336; val_masked_gp_l1_reg_loss: 7062.3149; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 219761.1484; val_global_loss: 658810.3906; val_optim_loss: 658810.3906
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9677; val_auprc_score: 0.9684; val_best_acc_score: 0.9015; val_best_f1_score: 0.9006; train_kl_reg_loss: 11704.1262; train_edge_recon_loss: 35320.1663; train_gene_expr_recon_loss: 369387.0483; train_masked_gp_l1_reg_loss: 7080.9619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 217269.1439; train_global_loss: 640761.4451; train_optim_loss: 640761.4451; val_kl_reg_loss: 11492.3932; val_edge_recon_loss: 36276.7529; val_gene_expr_recon_loss: 380071.1953; val_masked_gp_l1_reg_loss: 7116.4814; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 218102.5645; val_global_loss: 653059.3750; val_optim_loss: 653059.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9693; val_auprc_score: 0.9704; val_best_acc_score: 0.9029; val_best_f1_score: 0.9048; train_kl_reg_loss: 11629.9430; train_edge_recon_loss: 35179.5763; train_gene_expr_recon_loss: 368102.2931; train_masked_gp_l1_reg_loss: 7136.0080; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 216452.6650; train_global_loss: 638500.4858; train_optim_loss: 638500.4858; val_kl_reg_loss: 11446.1930; val_edge_recon_loss: 36057.7612; val_gene_expr_recon_loss: 378713.6172; val_masked_gp_l1_reg_loss: 7148.5493; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 217110.9004; val_global_loss: 650477.0312; val_optim_loss: 650477.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9718; val_auprc_score: 0.9719; val_best_acc_score: 0.9109; val_best_f1_score: 0.9108; train_kl_reg_loss: 11682.7663; train_edge_recon_loss: 35069.8042; train_gene_expr_recon_loss: 366099.6719; train_masked_gp_l1_reg_loss: 7167.2385; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 215726.4529; train_global_loss: 635745.9299; train_optim_loss: 635745.9299; val_kl_reg_loss: 11232.5576; val_edge_recon_loss: 35956.1582; val_gene_expr_recon_loss: 377455.2188; val_masked_gp_l1_reg_loss: 7184.1982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 216789.9766; val_global_loss: 648618.0938; val_optim_loss: 648618.0938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9576; val_auprc_score: 0.9561; val_best_acc_score: 0.8866; val_best_f1_score: 0.8860; train_kl_reg_loss: 17071.1400; train_edge_recon_loss: 35262.0531; train_gene_expr_recon_loss: 370109.9953; train_masked_gp_l1_reg_loss: 7202.4972; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 216116.3374; train_global_loss: 645762.0227; train_optim_loss: 645762.0227; val_kl_reg_loss: 14770.4119; val_edge_recon_loss: 36402.4395; val_gene_expr_recon_loss: 377965.5703; val_masked_gp_l1_reg_loss: 7218.1650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 216584.2402; val_global_loss: 652940.8203; val_optim_loss: 652940.8203
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9426; val_auprc_score: 0.9473; val_best_acc_score: 0.8677; val_best_f1_score: 0.8690; train_kl_reg_loss: 20972971.4156; train_edge_recon_loss: 35604.5947; train_gene_expr_recon_loss: 380238.2273; train_masked_gp_l1_reg_loss: 7196.8146; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 218185.8518; train_global_loss: 21614195.7027; train_optim_loss: 21614195.7027; val_kl_reg_loss: 24856.2749; val_edge_recon_loss: 36523.7910; val_gene_expr_recon_loss: 385639.7227; val_masked_gp_l1_reg_loss: 7218.7007; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 216429.2852; val_global_loss: 670667.7656; val_optim_loss: 670667.7656
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9492; val_auprc_score: 0.9527; val_best_acc_score: 0.8763; val_best_f1_score: 0.8782; train_kl_reg_loss: 35556.8501; train_edge_recon_loss: 35583.9419; train_gene_expr_recon_loss: 376900.5431; train_masked_gp_l1_reg_loss: 7222.1891; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 216791.8227; train_global_loss: 672055.3456; train_optim_loss: 672055.3456; val_kl_reg_loss: 21789.2339; val_edge_recon_loss: 36405.9888; val_gene_expr_recon_loss: 380062.4375; val_masked_gp_l1_reg_loss: 7257.2925; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 214509.4004; val_global_loss: 660024.3281; val_optim_loss: 660024.3281
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9294; val_auprc_score: 0.9306; val_best_acc_score: 0.8527; val_best_f1_score: 0.8572; train_kl_reg_loss: 27041.6344; train_edge_recon_loss: 38423.8282; train_gene_expr_recon_loss: 432381.4389; train_masked_gp_l1_reg_loss: 7215.7674; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232597.5670; train_global_loss: 737660.2358; train_optim_loss: 737660.2358; val_kl_reg_loss: 14280.4670; val_edge_recon_loss: 38376.6377; val_gene_expr_recon_loss: 431320.4219; val_masked_gp_l1_reg_loss: 7151.9395; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233471.9043; val_global_loss: 724601.3828; val_optim_loss: 724601.3828

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9355; val_auprc_score: 0.9399; val_best_acc_score: 0.8561; val_best_f1_score: 0.8602; train_kl_reg_loss: 13995.3919; train_edge_recon_loss: 37826.9850; train_gene_expr_recon_loss: 426858.5800; train_masked_gp_l1_reg_loss: 7052.2458; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232098.6551; train_global_loss: 717831.8561; train_optim_loss: 717831.8561; val_kl_reg_loss: 11310.9321; val_edge_recon_loss: 37894.4502; val_gene_expr_recon_loss: 434040.1641; val_masked_gp_l1_reg_loss: 7015.4189; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232213.9766; val_global_loss: 722474.9219; val_optim_loss: 722474.9219
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9420; val_auprc_score: 0.9453; val_best_acc_score: 0.8662; val_best_f1_score: 0.8699; train_kl_reg_loss: 12853.6648; train_edge_recon_loss: 37316.0651; train_gene_expr_recon_loss: 425524.9531; train_masked_gp_l1_reg_loss: 6995.6789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231638.9323; train_global_loss: 714329.2964; train_optim_loss: 714329.2964; val_kl_reg_loss: 10683.4663; val_edge_recon_loss: 37630.9697; val_gene_expr_recon_loss: 429967.0078; val_masked_gp_l1_reg_loss: 6975.0415; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233168.1621; val_global_loss: 718424.6484; val_optim_loss: 718424.6484
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9429; val_auprc_score: 0.9448; val_best_acc_score: 0.8704; val_best_f1_score: 0.8718; train_kl_reg_loss: 12580.4676; train_edge_recon_loss: 37120.2896; train_gene_expr_recon_loss: 424447.6638; train_masked_gp_l1_reg_loss: 6954.9837; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231814.1110; train_global_loss: 712917.5199; train_optim_loss: 712917.5199; val_kl_reg_loss: 10181.3628; val_edge_recon_loss: 37456.5786; val_gene_expr_recon_loss: 429657.8594; val_masked_gp_l1_reg_loss: 6934.2471; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234143.9414; val_global_loss: 718374.0000; val_optim_loss: 718374.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9457; val_auprc_score: 0.9463; val_best_acc_score: 0.8762; val_best_f1_score: 0.8757; train_kl_reg_loss: 13568.2050; train_edge_recon_loss: 36911.8097; train_gene_expr_recon_loss: 423942.5909; train_masked_gp_l1_reg_loss: 6915.2496; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231782.6454; train_global_loss: 713120.5019; train_optim_loss: 713120.5019; val_kl_reg_loss: 9853.3978; val_edge_recon_loss: 37228.9229; val_gene_expr_recon_loss: 427893.5039; val_masked_gp_l1_reg_loss: 6895.3799; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232757.2383; val_global_loss: 714628.4297; val_optim_loss: 714628.4297

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 27 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9618
val AUPRC score: 0.9642
val best accuracy score: 0.8975
val best F1 score: 0.8946
val target rna MSE score: 0.5316
val source rna MSE score: 0.3378
val target atac MSE score: 0.1331
val source atac MSE score: 0.0230
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
