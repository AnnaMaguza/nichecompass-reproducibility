[True]
Run timestamp: 01082023_092057_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8941; val_auprc_score: 0.9797; val_best_acc_score: 0.8617; val_best_f1_score: 0.9244; train_kl_reg_loss: 39052.0352; train_edge_recon_loss: 1029654.9444; train_gene_expr_recon_loss: 528013.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113699.6871; train_global_loss: 1710420.2199; train_optim_loss: 1710420.2199; val_kl_reg_loss: 23275.3984; val_edge_recon_loss: 1215409.8125; val_gene_expr_recon_loss: 448315.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100623.6094; val_global_loss: 1787623.9167; val_optim_loss: 1787623.9167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8877; val_auprc_score: 0.9783; val_best_acc_score: 0.8624; val_best_f1_score: 0.9247; train_kl_reg_loss: 20507.7089; train_edge_recon_loss: 1030817.0590; train_gene_expr_recon_loss: 381307.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90137.8469; train_global_loss: 1522769.6412; train_optim_loss: 1522769.6412; val_kl_reg_loss: 11508.2428; val_edge_recon_loss: 1206819.0208; val_gene_expr_recon_loss: 313659.7760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79916.3984; val_global_loss: 1611903.4375; val_optim_loss: 1611903.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8618; val_auprc_score: 0.9728; val_best_acc_score: 0.8608; val_best_f1_score: 0.9238; train_kl_reg_loss: 13542.0575; train_edge_recon_loss: 1026574.1481; train_gene_expr_recon_loss: 286734.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70331.4563; train_global_loss: 1397181.7917; train_optim_loss: 1397181.7917; val_kl_reg_loss: 11421.0247; val_edge_recon_loss: 1189958.8333; val_gene_expr_recon_loss: 268842.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60580.9688; val_global_loss: 1530803.4167; val_optim_loss: 1530803.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8492; val_auprc_score: 0.9658; val_best_acc_score: 0.8868; val_best_f1_score: 0.9370; train_kl_reg_loss: 9539.2747; train_edge_recon_loss: 987538.4583; train_gene_expr_recon_loss: 272093.9456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52269.8852; train_global_loss: 1321441.5694; train_optim_loss: 1321441.5694; val_kl_reg_loss: 8923.0409; val_edge_recon_loss: 906764.5417; val_gene_expr_recon_loss: 288717.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44511.9531; val_global_loss: 1248917.3542; val_optim_loss: 1248917.3542
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8459; val_auprc_score: 0.9640; val_best_acc_score: 0.8873; val_best_f1_score: 0.9368; train_kl_reg_loss: 15334.4521; train_edge_recon_loss: 887288.4144; train_gene_expr_recon_loss: 271962.2523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38573.4671; train_global_loss: 1213158.5764; train_optim_loss: 1213158.5764; val_kl_reg_loss: 15681.3415; val_edge_recon_loss: 925459.6354; val_gene_expr_recon_loss: 265389.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33055.2773; val_global_loss: 1239586.0000; val_optim_loss: 1239586.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8502; val_auprc_score: 0.9644; val_best_acc_score: 0.8947; val_best_f1_score: 0.9408; train_kl_reg_loss: 17895.9526; train_edge_recon_loss: 873844.6736; train_gene_expr_recon_loss: 258475.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29190.9937; train_global_loss: 1179406.8426; train_optim_loss: 1179406.8426; val_kl_reg_loss: 17426.3236; val_edge_recon_loss: 898297.0000; val_gene_expr_recon_loss: 251896.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25932.1777; val_global_loss: 1193552.3750; val_optim_loss: 1193552.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8687; val_auprc_score: 0.9712; val_best_acc_score: 0.9094; val_best_f1_score: 0.9491; train_kl_reg_loss: 16899.6517; train_edge_recon_loss: 867377.8819; train_gene_expr_recon_loss: 252096.7821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23657.1002; train_global_loss: 1160031.4167; train_optim_loss: 1160031.4167; val_kl_reg_loss: 14766.0736; val_edge_recon_loss: 831253.9792; val_gene_expr_recon_loss: 253045.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21611.4219; val_global_loss: 1120676.5417; val_optim_loss: 1120676.5417
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8937; val_auprc_score: 0.9762; val_best_acc_score: 0.9108; val_best_f1_score: 0.9495; train_kl_reg_loss: 18062.3927; train_edge_recon_loss: 844049.9861; train_gene_expr_recon_loss: 247030.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20076.2544; train_global_loss: 1129218.7118; train_optim_loss: 1129218.7118; val_kl_reg_loss: 18483.1611; val_edge_recon_loss: 835230.6250; val_gene_expr_recon_loss: 243469.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18657.6719; val_global_loss: 1115841.0208; val_optim_loss: 1115841.0208
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8968; val_auprc_score: 0.9767; val_best_acc_score: 0.9053; val_best_f1_score: 0.9465; train_kl_reg_loss: 19599.7612; train_edge_recon_loss: 823205.9398; train_gene_expr_recon_loss: 241409.0932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17590.8774; train_global_loss: 1101805.6644; train_optim_loss: 1101805.6644; val_kl_reg_loss: 18855.8324; val_edge_recon_loss: 840984.0521; val_gene_expr_recon_loss: 239073.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16624.6484; val_global_loss: 1115537.5625; val_optim_loss: 1115537.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9077; val_auprc_score: 0.9791; val_best_acc_score: 0.9043; val_best_f1_score: 0.9454; train_kl_reg_loss: 19397.5051; train_edge_recon_loss: 825755.4734; train_gene_expr_recon_loss: 237537.2743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15910.3255; train_global_loss: 1098600.5764; train_optim_loss: 1098600.5764; val_kl_reg_loss: 18369.2327; val_edge_recon_loss: 858772.4896; val_gene_expr_recon_loss: 235222.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15251.7188; val_global_loss: 1127615.6875; val_optim_loss: 1127615.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9046; val_auprc_score: 0.9791; val_best_acc_score: 0.9108; val_best_f1_score: 0.9489; train_kl_reg_loss: 19090.6850; train_edge_recon_loss: 821094.2477; train_gene_expr_recon_loss: 234043.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14745.2652; train_global_loss: 1088973.3472; train_optim_loss: 1088973.3472; val_kl_reg_loss: 18096.7249; val_edge_recon_loss: 833289.6667; val_gene_expr_recon_loss: 230641.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14293.0615; val_global_loss: 1096321.1146; val_optim_loss: 1096321.1146
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9146; val_auprc_score: 0.9821; val_best_acc_score: 0.9128; val_best_f1_score: 0.9502; train_kl_reg_loss: 18133.9471; train_edge_recon_loss: 812456.4178; train_gene_expr_recon_loss: 231238.4589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13906.3928; train_global_loss: 1075735.2176; train_optim_loss: 1075735.2176; val_kl_reg_loss: 17847.2526; val_edge_recon_loss: 815022.6771; val_gene_expr_recon_loss: 229077.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13534.9824; val_global_loss: 1075482.3021; val_optim_loss: 1075482.3021
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9231; val_auprc_score: 0.9826; val_best_acc_score: 0.9179; val_best_f1_score: 0.9530; train_kl_reg_loss: 17400.9212; train_edge_recon_loss: 806729.0475; train_gene_expr_recon_loss: 228958.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13273.4934; train_global_loss: 1066361.8183; train_optim_loss: 1066361.8183; val_kl_reg_loss: 16838.1087; val_edge_recon_loss: 830442.2500; val_gene_expr_recon_loss: 227281.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13054.3516; val_global_loss: 1087616.6667; val_optim_loss: 1087616.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9229; val_auprc_score: 0.9832; val_best_acc_score: 0.9213; val_best_f1_score: 0.9553; train_kl_reg_loss: 18215.0059; train_edge_recon_loss: 803668.4329; train_gene_expr_recon_loss: 225546.8096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12818.8007; train_global_loss: 1060249.0509; train_optim_loss: 1060249.0509; val_kl_reg_loss: 17010.4160; val_edge_recon_loss: 821873.9479; val_gene_expr_recon_loss: 222136.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12561.5342; val_global_loss: 1073582.0417; val_optim_loss: 1073582.0417
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9402; val_auprc_score: 0.9867; val_best_acc_score: 0.9283; val_best_f1_score: 0.9585; train_kl_reg_loss: 17462.1266; train_edge_recon_loss: 807954.4433; train_gene_expr_recon_loss: 222798.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12335.0395; train_global_loss: 1060549.6817; train_optim_loss: 1060549.6817; val_kl_reg_loss: 16770.5042; val_edge_recon_loss: 815172.2292; val_gene_expr_recon_loss: 221298.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12132.8398; val_global_loss: 1065374.4062; val_optim_loss: 1065374.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9306; val_auprc_score: 0.9843; val_best_acc_score: 0.9266; val_best_f1_score: 0.9577; train_kl_reg_loss: 17356.6121; train_edge_recon_loss: 800475.9618; train_gene_expr_recon_loss: 220082.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11964.8140; train_global_loss: 1049880.1551; train_optim_loss: 1049880.1551; val_kl_reg_loss: 16988.3877; val_edge_recon_loss: 813427.0729; val_gene_expr_recon_loss: 218939.3880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11775.9277; val_global_loss: 1061130.7708; val_optim_loss: 1061130.7708
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9397; val_auprc_score: 0.9869; val_best_acc_score: 0.9288; val_best_f1_score: 0.9587; train_kl_reg_loss: 16753.9270; train_edge_recon_loss: 800887.1620; train_gene_expr_recon_loss: 217536.4728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11614.5891; train_global_loss: 1046792.1366; train_optim_loss: 1046792.1366; val_kl_reg_loss: 16668.6768; val_edge_recon_loss: 813725.3542; val_gene_expr_recon_loss: 215599.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11450.3789; val_global_loss: 1057444.3333; val_optim_loss: 1057444.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9398; val_auprc_score: 0.9852; val_best_acc_score: 0.9330; val_best_f1_score: 0.9612; train_kl_reg_loss: 16237.1740; train_edge_recon_loss: 795568.2662; train_gene_expr_recon_loss: 215118.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11282.6696; train_global_loss: 1038206.7361; train_optim_loss: 1038206.7361; val_kl_reg_loss: 15254.9279; val_edge_recon_loss: 804117.2188; val_gene_expr_recon_loss: 213718.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11133.3779; val_global_loss: 1044223.5729; val_optim_loss: 1044223.5729
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9475; val_auprc_score: 0.9881; val_best_acc_score: 0.9358; val_best_f1_score: 0.9631; train_kl_reg_loss: 15960.0093; train_edge_recon_loss: 797792.0579; train_gene_expr_recon_loss: 212821.6753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11010.8467; train_global_loss: 1037584.5961; train_optim_loss: 1037584.5961; val_kl_reg_loss: 15124.8870; val_edge_recon_loss: 781282.7188; val_gene_expr_recon_loss: 210978.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10879.3906; val_global_loss: 1018265.2917; val_optim_loss: 1018265.2917
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9434; val_auprc_score: 0.9867; val_best_acc_score: 0.9350; val_best_f1_score: 0.9623; train_kl_reg_loss: 15475.3687; train_edge_recon_loss: 785300.4144; train_gene_expr_recon_loss: 210490.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10743.0452; train_global_loss: 1022008.9016; train_optim_loss: 1022008.9016; val_kl_reg_loss: 15086.9546; val_edge_recon_loss: 817753.5312; val_gene_expr_recon_loss: 208242.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10609.0879; val_global_loss: 1051692.2604; val_optim_loss: 1051692.2604
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9464; val_auprc_score: 0.9882; val_best_acc_score: 0.9333; val_best_f1_score: 0.9615; train_kl_reg_loss: 14822.8167; train_edge_recon_loss: 790057.3843; train_gene_expr_recon_loss: 208505.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10481.2329; train_global_loss: 1023866.5451; train_optim_loss: 1023866.5451; val_kl_reg_loss: 13376.1969; val_edge_recon_loss: 796967.8750; val_gene_expr_recon_loss: 207776.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10340.7607; val_global_loss: 1028460.9688; val_optim_loss: 1028460.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9468; val_auprc_score: 0.9873; val_best_acc_score: 0.9391; val_best_f1_score: 0.9646; train_kl_reg_loss: 14783.5051; train_edge_recon_loss: 797216.2535; train_gene_expr_recon_loss: 206552.8249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10208.8859; train_global_loss: 1028761.4676; train_optim_loss: 1028761.4676; val_kl_reg_loss: 13640.8104; val_edge_recon_loss: 805822.5625; val_gene_expr_recon_loss: 205468.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10062.3652; val_global_loss: 1034994.1667; val_optim_loss: 1034994.1667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9505; val_auprc_score: 0.9890; val_best_acc_score: 0.9376; val_best_f1_score: 0.9640; train_kl_reg_loss: 14401.1837; train_edge_recon_loss: 787399.0104; train_gene_expr_recon_loss: 204587.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9898.7431; train_global_loss: 1016286.1829; train_optim_loss: 1016286.1829; val_kl_reg_loss: 13859.9731; val_edge_recon_loss: 797958.9792; val_gene_expr_recon_loss: 203372.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9706.4160; val_global_loss: 1024897.8958; val_optim_loss: 1024897.8958

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9540; val_auprc_score: 0.9895; val_best_acc_score: 0.9396; val_best_f1_score: 0.9647; train_kl_reg_loss: 14213.1159; train_edge_recon_loss: 781170.2836; train_gene_expr_recon_loss: 203354.7911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9610.6720; train_global_loss: 1008348.8646; train_optim_loss: 1008348.8646; val_kl_reg_loss: 13810.6104; val_edge_recon_loss: 809678.2604; val_gene_expr_recon_loss: 203138.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9572.7549; val_global_loss: 1036200.3958; val_optim_loss: 1036200.3958
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9548; val_auprc_score: 0.9896; val_best_acc_score: 0.9421; val_best_f1_score: 0.9664; train_kl_reg_loss: 14179.9227; train_edge_recon_loss: 789413.2477; train_gene_expr_recon_loss: 203223.9971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9553.9409; train_global_loss: 1016371.1146; train_optim_loss: 1016371.1146; val_kl_reg_loss: 13513.7808; val_edge_recon_loss: 795113.3958; val_gene_expr_recon_loss: 202416.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9535.1309; val_global_loss: 1020579.0208; val_optim_loss: 1020579.0208
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9540; val_auprc_score: 0.9900; val_best_acc_score: 0.9416; val_best_f1_score: 0.9662; train_kl_reg_loss: 13995.1045; train_edge_recon_loss: 789603.0648; train_gene_expr_recon_loss: 203013.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9517.1387; train_global_loss: 1016128.3391; train_optim_loss: 1016128.3391; val_kl_reg_loss: 13526.1825; val_edge_recon_loss: 776812.5938; val_gene_expr_recon_loss: 202506.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9497.5078; val_global_loss: 1002342.8125; val_optim_loss: 1002342.8125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9481; val_auprc_score: 0.9875; val_best_acc_score: 0.9377; val_best_f1_score: 0.9639; train_kl_reg_loss: 13927.8125; train_edge_recon_loss: 787152.6887; train_gene_expr_recon_loss: 202852.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9479.8224; train_global_loss: 1013412.7141; train_optim_loss: 1013412.7141; val_kl_reg_loss: 13336.6113; val_edge_recon_loss: 815824.0729; val_gene_expr_recon_loss: 202341.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9461.7920; val_global_loss: 1040964.2188; val_optim_loss: 1040964.2188
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9497; val_auprc_score: 0.9886; val_best_acc_score: 0.9413; val_best_f1_score: 0.9660; train_kl_reg_loss: 13888.9135; train_edge_recon_loss: 786342.6319; train_gene_expr_recon_loss: 202617.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9442.2551; train_global_loss: 1012290.9352; train_optim_loss: 1012290.9352; val_kl_reg_loss: 13436.2056; val_edge_recon_loss: 783269.1771; val_gene_expr_recon_loss: 202193.4089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9420.3037; val_global_loss: 1008319.1042; val_optim_loss: 1008319.1042
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9529; val_auprc_score: 0.9896; val_best_acc_score: 0.9401; val_best_f1_score: 0.9655; train_kl_reg_loss: 13792.8541; train_edge_recon_loss: 789957.4491; train_gene_expr_recon_loss: 202501.0437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9398.1666; train_global_loss: 1015649.5162; train_optim_loss: 1015649.5162; val_kl_reg_loss: 13311.9097; val_edge_recon_loss: 785777.7292; val_gene_expr_recon_loss: 202205.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9376.0352; val_global_loss: 1010671.4375; val_optim_loss: 1010671.4375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9499; val_auprc_score: 0.9879; val_best_acc_score: 0.9398; val_best_f1_score: 0.9654; train_kl_reg_loss: 13708.3470; train_edge_recon_loss: 782517.4780; train_gene_expr_recon_loss: 202273.4300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9356.2716; train_global_loss: 1007855.5324; train_optim_loss: 1007855.5324; val_kl_reg_loss: 13168.9539; val_edge_recon_loss: 774882.1771; val_gene_expr_recon_loss: 202561.8464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9336.3359; val_global_loss: 999949.2917; val_optim_loss: 999949.2917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9512; val_auprc_score: 0.9884; val_best_acc_score: 0.9382; val_best_f1_score: 0.9640; train_kl_reg_loss: 13439.8079; train_edge_recon_loss: 787617.2060; train_gene_expr_recon_loss: 202201.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9317.1493; train_global_loss: 1012575.3345; train_optim_loss: 1012575.3345; val_kl_reg_loss: 13053.3037; val_edge_recon_loss: 823313.8333; val_gene_expr_recon_loss: 201949.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9297.5498; val_global_loss: 1047614.4583; val_optim_loss: 1047614.4583
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9511; val_auprc_score: 0.9889; val_best_acc_score: 0.9406; val_best_f1_score: 0.9657; train_kl_reg_loss: 13473.0548; train_edge_recon_loss: 776518.3090; train_gene_expr_recon_loss: 202007.8776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9277.1490; train_global_loss: 1001276.3958; train_optim_loss: 1001276.3958; val_kl_reg_loss: 13103.2495; val_edge_recon_loss: 791935.0208; val_gene_expr_recon_loss: 201775.4896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9254.4707; val_global_loss: 1016068.2500; val_optim_loss: 1016068.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9512; val_auprc_score: 0.9885; val_best_acc_score: 0.9428; val_best_f1_score: 0.9670; train_kl_reg_loss: 13618.5126; train_edge_recon_loss: 784847.4954; train_gene_expr_recon_loss: 201737.4612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9231.5336; train_global_loss: 1009435.0081; train_optim_loss: 1009435.0081; val_kl_reg_loss: 13220.2952; val_edge_recon_loss: 783899.4271; val_gene_expr_recon_loss: 201642.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9207.2451; val_global_loss: 1007969.0208; val_optim_loss: 1007969.0208
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9550; val_auprc_score: 0.9904; val_best_acc_score: 0.9382; val_best_f1_score: 0.9641; train_kl_reg_loss: 13522.3225; train_edge_recon_loss: 776442.2870; train_gene_expr_recon_loss: 201588.3449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9185.3224; train_global_loss: 1000738.2755; train_optim_loss: 1000738.2755; val_kl_reg_loss: 13000.1854; val_edge_recon_loss: 809394.2396; val_gene_expr_recon_loss: 201452.5599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9163.6025; val_global_loss: 1033010.6042; val_optim_loss: 1033010.6042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9468; val_auprc_score: 0.9862; val_best_acc_score: 0.9390; val_best_f1_score: 0.9646; train_kl_reg_loss: 13362.9542; train_edge_recon_loss: 787749.2940; train_gene_expr_recon_loss: 201478.4068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9154.4303; train_global_loss: 1011745.0799; train_optim_loss: 1011745.0799; val_kl_reg_loss: 12873.5347; val_edge_recon_loss: 809056.2917; val_gene_expr_recon_loss: 201704.9870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9150.4043; val_global_loss: 1032785.1875; val_optim_loss: 1032785.1875
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9546; val_auprc_score: 0.9901; val_best_acc_score: 0.9419; val_best_f1_score: 0.9665; train_kl_reg_loss: 13304.2592; train_edge_recon_loss: 778058.4838; train_gene_expr_recon_loss: 201495.1496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9148.1454; train_global_loss: 1002006.0451; train_optim_loss: 1002006.0451; val_kl_reg_loss: 12873.5562; val_edge_recon_loss: 786311.2188; val_gene_expr_recon_loss: 201300.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9145.8877; val_global_loss: 1009631.1146; val_optim_loss: 1009631.1146
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9532; val_auprc_score: 0.9886; val_best_acc_score: 0.9421; val_best_f1_score: 0.9664; train_kl_reg_loss: 13265.1032; train_edge_recon_loss: 785221.4329; train_gene_expr_recon_loss: 201486.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9143.6309; train_global_loss: 1009117.1458; train_optim_loss: 1009117.1458; val_kl_reg_loss: 12882.4515; val_edge_recon_loss: 802716.2604; val_gene_expr_recon_loss: 201354.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9141.3828; val_global_loss: 1026094.9688; val_optim_loss: 1026094.9688
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9523; val_auprc_score: 0.9892; val_best_acc_score: 0.9421; val_best_f1_score: 0.9665; train_kl_reg_loss: 13258.6184; train_edge_recon_loss: 780950.8171; train_gene_expr_recon_loss: 201507.6178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9139.1213; train_global_loss: 1004856.1759; train_optim_loss: 1004856.1759; val_kl_reg_loss: 12847.8574; val_edge_recon_loss: 784519.3958; val_gene_expr_recon_loss: 201406.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9136.8564; val_global_loss: 1007910.2188; val_optim_loss: 1007910.2188

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 2 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9479
val AUPRC score: 0.9882
val best accuracy score: 0.9393
val best F1 score: 0.9651
val target rna MSE score: 108.1004
val source rna MSE score: 9.4466
Val cat covariate0 mean sim diff: -0.0015

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
