[True]
Run timestamp: 10082023_202425_38.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_38']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7341; val_auprc_score: 0.7669; val_best_acc_score: 0.5039; val_best_f1_score: 0.6682; train_kl_reg_loss: 131533.1841; train_edge_recon_loss: 3686220.7576; train_gene_expr_recon_loss: 26633133.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6856719.4351; train_global_loss: 37307607.1450; train_optim_loss: 37307607.1450; val_kl_reg_loss: 174442.3365; val_edge_recon_loss: 4064964.6500; val_gene_expr_recon_loss: 23119920.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6483831.4000; val_global_loss: 33843159.3333; val_optim_loss: 33843159.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7853; val_auprc_score: 0.8018; val_best_acc_score: 0.6382; val_best_f1_score: 0.7201; train_kl_reg_loss: 172762.8750; train_edge_recon_loss: 3587106.2863; train_gene_expr_recon_loss: 22674034.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6429398.7634; train_global_loss: 32863302.5802; train_optim_loss: 32863302.5802; val_kl_reg_loss: 162657.5667; val_edge_recon_loss: 4055577.5167; val_gene_expr_recon_loss: 22296126.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6370629.3000; val_global_loss: 32884990.8000; val_optim_loss: 32884990.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8727; val_auprc_score: 0.8730; val_best_acc_score: 0.7874; val_best_f1_score: 0.7735; train_kl_reg_loss: 156140.0140; train_edge_recon_loss: 3548610.4618; train_gene_expr_recon_loss: 22222842.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6367304.9084; train_global_loss: 32294897.5420; train_optim_loss: 32294897.5420; val_kl_reg_loss: 162434.6479; val_edge_recon_loss: 3998104.1667; val_gene_expr_recon_loss: 22093550.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6374071.5333; val_global_loss: 32628160.2667; val_optim_loss: 32628160.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9076; val_auprc_score: 0.8993; val_best_acc_score: 0.8248; val_best_f1_score: 0.8340; train_kl_reg_loss: 128462.6801; train_edge_recon_loss: 3481805.5115; train_gene_expr_recon_loss: 21964336.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6317674.2557; train_global_loss: 31892279.0840; train_optim_loss: 31892279.0840; val_kl_reg_loss: 110916.5250; val_edge_recon_loss: 3429406.1333; val_gene_expr_recon_loss: 21827018.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6289931.2667; val_global_loss: 31657272.4000; val_optim_loss: 31657272.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9033; val_auprc_score: 0.8904; val_best_acc_score: 0.8251; val_best_f1_score: 0.8355; train_kl_reg_loss: 144590.7548; train_edge_recon_loss: 3079988.6088; train_gene_expr_recon_loss: 21863167.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6295146.3130; train_global_loss: 31382893.6947; train_optim_loss: 31382893.6947; val_kl_reg_loss: 155150.7687; val_edge_recon_loss: 2960912.9000; val_gene_expr_recon_loss: 21673041.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6257684.9000; val_global_loss: 31046789.7333; val_optim_loss: 31046789.7333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9163; val_auprc_score: 0.9013; val_best_acc_score: 0.8409; val_best_f1_score: 0.8515; train_kl_reg_loss: 155957.6974; train_edge_recon_loss: 2937259.0763; train_gene_expr_recon_loss: 21715518.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6263996.0649; train_global_loss: 31072731.1908; train_optim_loss: 31072731.1908; val_kl_reg_loss: 156865.2000; val_edge_recon_loss: 2925090.5167; val_gene_expr_recon_loss: 21585499.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6236738.4000; val_global_loss: 30904193.2000; val_optim_loss: 30904193.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9229; val_auprc_score: 0.9062; val_best_acc_score: 0.8542; val_best_f1_score: 0.8633; train_kl_reg_loss: 153126.9014; train_edge_recon_loss: 2895587.5401; train_gene_expr_recon_loss: 21566034.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6233792.3740; train_global_loss: 30848541.1145; train_optim_loss: 30848541.1145; val_kl_reg_loss: 148321.7177; val_edge_recon_loss: 2900773.5000; val_gene_expr_recon_loss: 21419230.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6188428.6667; val_global_loss: 30656754.9333; val_optim_loss: 30656754.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9286; val_auprc_score: 0.9097; val_best_acc_score: 0.8678; val_best_f1_score: 0.8751; train_kl_reg_loss: 146445.4596; train_edge_recon_loss: 2873299.8244; train_gene_expr_recon_loss: 21453320.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6206751.0573; train_global_loss: 30679816.5954; train_optim_loss: 30679816.5954; val_kl_reg_loss: 142874.4771; val_edge_recon_loss: 2866063.2333; val_gene_expr_recon_loss: 21334599.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6185591.0333; val_global_loss: 30529128.6667; val_optim_loss: 30529128.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9338; val_auprc_score: 0.9181; val_best_acc_score: 0.8766; val_best_f1_score: 0.8827; train_kl_reg_loss: 140891.7843; train_edge_recon_loss: 2854585.2805; train_gene_expr_recon_loss: 21335236.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6174647.4847; train_global_loss: 30505361.4656; train_optim_loss: 30505361.4656; val_kl_reg_loss: 140270.9854; val_edge_recon_loss: 2864354.0500; val_gene_expr_recon_loss: 21314832.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6174262.9667; val_global_loss: 30493720.2667; val_optim_loss: 30493720.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9380; val_auprc_score: 0.9245; val_best_acc_score: 0.8760; val_best_f1_score: 0.8822; train_kl_reg_loss: 136221.2059; train_edge_recon_loss: 2832727.0687; train_gene_expr_recon_loss: 21274067.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6161429.3969; train_global_loss: 30404444.9771; train_optim_loss: 30404444.9771; val_kl_reg_loss: 128714.9391; val_edge_recon_loss: 2849204.2833; val_gene_expr_recon_loss: 21177736.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6151680.4333; val_global_loss: 30307336.1333; val_optim_loss: 30307336.1333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9457; val_auprc_score: 0.9342; val_best_acc_score: 0.8871; val_best_f1_score: 0.8922; train_kl_reg_loss: 130879.6345; train_edge_recon_loss: 2826828.9065; train_gene_expr_recon_loss: 21175959.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6136788.3168; train_global_loss: 30270456.1985; train_optim_loss: 30270456.1985; val_kl_reg_loss: 125739.1193; val_edge_recon_loss: 2805937.8500; val_gene_expr_recon_loss: 21078268.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6117800.5000; val_global_loss: 30127746.4000; val_optim_loss: 30127746.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9469; val_auprc_score: 0.9348; val_best_acc_score: 0.8913; val_best_f1_score: 0.8955; train_kl_reg_loss: 124888.0639; train_edge_recon_loss: 2823871.7595; train_gene_expr_recon_loss: 21118399.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6122213.0763; train_global_loss: 30189372.3664; train_optim_loss: 30189372.3664; val_kl_reg_loss: 122447.9974; val_edge_recon_loss: 2819423.6333; val_gene_expr_recon_loss: 21067934.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6141053.1000; val_global_loss: 30150859.0667; val_optim_loss: 30150859.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9456; val_auprc_score: 0.9309; val_best_acc_score: 0.8871; val_best_f1_score: 0.8926; train_kl_reg_loss: 121763.6410; train_edge_recon_loss: 2803925.0553; train_gene_expr_recon_loss: 21047375.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6104756.6183; train_global_loss: 30077821.0534; train_optim_loss: 30077821.0534; val_kl_reg_loss: 118465.6854; val_edge_recon_loss: 2813803.3000; val_gene_expr_recon_loss: 20922693.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6071473.0667; val_global_loss: 29926435.4667; val_optim_loss: 29926435.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9560; val_auprc_score: 0.9449; val_best_acc_score: 0.8973; val_best_f1_score: 0.9009; train_kl_reg_loss: 117041.3607; train_edge_recon_loss: 2798860.2290; train_gene_expr_recon_loss: 21020639.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6097663.7672; train_global_loss: 30034204.7328; train_optim_loss: 30034204.7328; val_kl_reg_loss: 117235.8964; val_edge_recon_loss: 2776564.8333; val_gene_expr_recon_loss: 20905093.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6081084.0667; val_global_loss: 29879978.6667; val_optim_loss: 29879978.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9527; val_auprc_score: 0.9396; val_best_acc_score: 0.8937; val_best_f1_score: 0.8983; train_kl_reg_loss: 115942.1803; train_edge_recon_loss: 2785452.7176; train_gene_expr_recon_loss: 20972036.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6091750.1947; train_global_loss: 29965181.5420; train_optim_loss: 29965181.5420; val_kl_reg_loss: 114997.8714; val_edge_recon_loss: 2765873.6333; val_gene_expr_recon_loss: 20926319.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6073829.3667; val_global_loss: 29881020.4000; val_optim_loss: 29881020.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9532; val_auprc_score: 0.9424; val_best_acc_score: 0.8945; val_best_f1_score: 0.8983; train_kl_reg_loss: 111916.2858; train_edge_recon_loss: 2774340.7309; train_gene_expr_recon_loss: 20897907.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6069635.0420; train_global_loss: 29853799.8168; train_optim_loss: 29853799.8168; val_kl_reg_loss: 108684.6422; val_edge_recon_loss: 2778027.3167; val_gene_expr_recon_loss: 20805595.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6051864.9667; val_global_loss: 29744172.0000; val_optim_loss: 29744172.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9585; val_auprc_score: 0.9496; val_best_acc_score: 0.9007; val_best_f1_score: 0.9029; train_kl_reg_loss: 108925.8429; train_edge_recon_loss: 2765592.0420; train_gene_expr_recon_loss: 20856786.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6062606.7328; train_global_loss: 29793910.8397; train_optim_loss: 29793910.8397; val_kl_reg_loss: 108174.5396; val_edge_recon_loss: 2764402.2500; val_gene_expr_recon_loss: 20780440.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6036845.8333; val_global_loss: 29689863.3333; val_optim_loss: 29689863.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9614; val_auprc_score: 0.9549; val_best_acc_score: 0.9037; val_best_f1_score: 0.9068; train_kl_reg_loss: 107406.8938; train_edge_recon_loss: 2756478.2710; train_gene_expr_recon_loss: 20815721.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6049440.5038; train_global_loss: 29729046.8702; train_optim_loss: 29729046.8702; val_kl_reg_loss: 106604.8844; val_edge_recon_loss: 2739873.5500; val_gene_expr_recon_loss: 20716418.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6031559.5667; val_global_loss: 29594456.2667; val_optim_loss: 29594456.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9602; val_auprc_score: 0.9512; val_best_acc_score: 0.9026; val_best_f1_score: 0.9069; train_kl_reg_loss: 105143.1633; train_edge_recon_loss: 2747142.9370; train_gene_expr_recon_loss: 20781670.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6051097.8473; train_global_loss: 29685054.9618; train_optim_loss: 29685054.9618; val_kl_reg_loss: 103042.5828; val_edge_recon_loss: 2760875.4500; val_gene_expr_recon_loss: 20676151.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6024564.8000; val_global_loss: 29564634.0000; val_optim_loss: 29564634.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9624; val_auprc_score: 0.9536; val_best_acc_score: 0.9046; val_best_f1_score: 0.9071; train_kl_reg_loss: 102576.7207; train_edge_recon_loss: 2745035.5916; train_gene_expr_recon_loss: 20748233.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6039222.0038; train_global_loss: 29635068.1374; train_optim_loss: 29635068.1374; val_kl_reg_loss: 102501.1880; val_edge_recon_loss: 2762504.0833; val_gene_expr_recon_loss: 20662942.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6013331.9667; val_global_loss: 29541279.4667; val_optim_loss: 29541279.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9655; val_auprc_score: 0.9568; val_best_acc_score: 0.9113; val_best_f1_score: 0.9131; train_kl_reg_loss: 100401.0759; train_edge_recon_loss: 2735639.1851; train_gene_expr_recon_loss: 20687523.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6025224.2290; train_global_loss: 29548787.4656; train_optim_loss: 29548787.4656; val_kl_reg_loss: 99933.5813; val_edge_recon_loss: 2747009.3000; val_gene_expr_recon_loss: 20706390.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6028280.8333; val_global_loss: 29581614.2667; val_optim_loss: 29581614.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9650; val_auprc_score: 0.9578; val_best_acc_score: 0.9099; val_best_f1_score: 0.9134; train_kl_reg_loss: 98050.0182; train_edge_recon_loss: 2736456.3989; train_gene_expr_recon_loss: 20664555.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6022215.2405; train_global_loss: 29521277.0534; train_optim_loss: 29521277.0534; val_kl_reg_loss: 96736.6562; val_edge_recon_loss: 2761766.3667; val_gene_expr_recon_loss: 20528502.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5983843.7333; val_global_loss: 29370849.4667; val_optim_loss: 29370849.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9641; val_auprc_score: 0.9541; val_best_acc_score: 0.9122; val_best_f1_score: 0.9146; train_kl_reg_loss: 96338.6868; train_edge_recon_loss: 2727741.4122; train_gene_expr_recon_loss: 20652811.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6020189.4008; train_global_loss: 29497080.4885; train_optim_loss: 29497080.4885; val_kl_reg_loss: 95550.4594; val_edge_recon_loss: 2759310.7000; val_gene_expr_recon_loss: 20602904.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6026520.5000; val_global_loss: 29484286.5333; val_optim_loss: 29484286.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9664; val_auprc_score: 0.9587; val_best_acc_score: 0.9136; val_best_f1_score: 0.9158; train_kl_reg_loss: 95530.3928; train_edge_recon_loss: 2724540.7214; train_gene_expr_recon_loss: 20596758.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6000717.9656; train_global_loss: 29417547.5420; train_optim_loss: 29417547.5420; val_kl_reg_loss: 95597.9203; val_edge_recon_loss: 2752803.3333; val_gene_expr_recon_loss: 20558805.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5998108.5333; val_global_loss: 29405315.3333; val_optim_loss: 29405315.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9718; val_auprc_score: 0.9663; val_best_acc_score: 0.9194; val_best_f1_score: 0.9205; train_kl_reg_loss: 93741.6821; train_edge_recon_loss: 2723024.7653; train_gene_expr_recon_loss: 20560766.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5993204.8931; train_global_loss: 29370738.1832; train_optim_loss: 29370738.1832; val_kl_reg_loss: 92062.1026; val_edge_recon_loss: 2735463.5667; val_gene_expr_recon_loss: 20443313.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5980733.1000; val_global_loss: 29251571.4667; val_optim_loss: 29251571.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9711; val_auprc_score: 0.9620; val_best_acc_score: 0.9227; val_best_f1_score: 0.9248; train_kl_reg_loss: 94591.3636; train_edge_recon_loss: 2740212.9218; train_gene_expr_recon_loss: 20836881.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6069688.8626; train_global_loss: 29741374.6260; train_optim_loss: 29741374.6260; val_kl_reg_loss: 68195.1469; val_edge_recon_loss: 2737200.7333; val_gene_expr_recon_loss: 20803561.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6063897.5333; val_global_loss: 29672854.6667; val_optim_loss: 29672854.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9731; val_auprc_score: 0.9666; val_best_acc_score: 0.9237; val_best_f1_score: 0.9256; train_kl_reg_loss: 92617.5104; train_edge_recon_loss: 2723249.3302; train_gene_expr_recon_loss: 20769944.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6048448.2137; train_global_loss: 29634259.6641; train_optim_loss: 29634259.6641; val_kl_reg_loss: 69866.9531; val_edge_recon_loss: 2721545.7667; val_gene_expr_recon_loss: 20795922.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6051159.7333; val_global_loss: 29638494.6667; val_optim_loss: 29638494.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9739; val_auprc_score: 0.9668; val_best_acc_score: 0.9252; val_best_f1_score: 0.9278; train_kl_reg_loss: 89612.9174; train_edge_recon_loss: 2708280.8779; train_gene_expr_recon_loss: 20758557.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6042088.0534; train_global_loss: 29598538.9924; train_optim_loss: 29598538.9924; val_kl_reg_loss: 71231.7906; val_edge_recon_loss: 2720002.5833; val_gene_expr_recon_loss: 20647636.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6007054.3667; val_global_loss: 29445925.4667; val_optim_loss: 29445925.4667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9740; val_auprc_score: 0.9670; val_best_acc_score: 0.9232; val_best_f1_score: 0.9267; train_kl_reg_loss: 86056.4788; train_edge_recon_loss: 2709030.5229; train_gene_expr_recon_loss: 20729692.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6044657.2672; train_global_loss: 29569436.2443; train_optim_loss: 29569436.2443; val_kl_reg_loss: 71510.5745; val_edge_recon_loss: 2714665.8167; val_gene_expr_recon_loss: 20773517.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6138032.7000; val_global_loss: 29697726.6667; val_optim_loss: 29697726.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9703; val_auprc_score: 0.9617; val_best_acc_score: 0.9210; val_best_f1_score: 0.9234; train_kl_reg_loss: 85316.3556; train_edge_recon_loss: 2707491.3950; train_gene_expr_recon_loss: 20683133.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6098701.0267; train_global_loss: 29574642.4275; train_optim_loss: 29574642.4275; val_kl_reg_loss: 72606.6552; val_edge_recon_loss: 2728728.3500; val_gene_expr_recon_loss: 20572718.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6067616.7333; val_global_loss: 29441670.9333; val_optim_loss: 29441670.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9742; val_auprc_score: 0.9664; val_best_acc_score: 0.9263; val_best_f1_score: 0.9280; train_kl_reg_loss: 85370.1358; train_edge_recon_loss: 2705883.2443; train_gene_expr_recon_loss: 20669639.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6107299.6985; train_global_loss: 29568192.2137; train_optim_loss: 29568192.2137; val_kl_reg_loss: 73416.1880; val_edge_recon_loss: 2720348.8333; val_gene_expr_recon_loss: 20754583.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6126648.1333; val_global_loss: 29674996.5333; val_optim_loss: 29674996.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9761; val_auprc_score: 0.9706; val_best_acc_score: 0.9294; val_best_f1_score: 0.9312; train_kl_reg_loss: 85529.7238; train_edge_recon_loss: 2703035.8989; train_gene_expr_recon_loss: 20699051.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6104929.9160; train_global_loss: 29592547.2672; train_optim_loss: 29592547.2672; val_kl_reg_loss: 73590.7281; val_edge_recon_loss: 2703630.4167; val_gene_expr_recon_loss: 20663372.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6093274.5667; val_global_loss: 29533867.6000; val_optim_loss: 29533867.6000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9764; val_auprc_score: 0.9679; val_best_acc_score: 0.9282; val_best_f1_score: 0.9302; train_kl_reg_loss: 85104.6216; train_edge_recon_loss: 2702867.1431; train_gene_expr_recon_loss: 20709788.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6104888.1374; train_global_loss: 29602648.5496; train_optim_loss: 29602648.5496; val_kl_reg_loss: 72732.9807; val_edge_recon_loss: 2697756.4167; val_gene_expr_recon_loss: 20615930.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6107523.4667; val_global_loss: 29493942.5333; val_optim_loss: 29493942.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9748
val AUPRC score: 0.9674
val best accuracy score: 0.9206
val best F1 score: 0.9238
val target rna MSE score: 0.9119
val source rna MSE score: 13.5220
val target atac MSE score: 0.5454
val source atac MSE score: 4.4394
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
