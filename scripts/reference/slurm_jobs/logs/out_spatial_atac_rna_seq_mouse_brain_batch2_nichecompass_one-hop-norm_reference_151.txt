[True]
Run timestamp: 07082023_220530_151.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_151']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9592; val_auprc_score: 0.9621; val_best_acc_score: 0.8848; val_best_f1_score: 0.8829; train_kl_reg_loss: 4136.3720; train_edge_recon_loss: 3467547.5833; train_gene_expr_recon_loss: 632673.9444; train_masked_gp_l1_reg_loss: 16155.3121; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 267019.2500; train_global_loss: 4387532.5000; train_optim_loss: 4387532.5000; val_kl_reg_loss: 864.1892; val_edge_recon_loss: 4038715.2500; val_gene_expr_recon_loss: 633096.1250; val_masked_gp_l1_reg_loss: 10758.1445; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263213.5625; val_global_loss: 4946647.0000; val_optim_loss: 4946647.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9422; val_auprc_score: 0.9335; val_best_acc_score: 0.8658; val_best_f1_score: 0.8754; train_kl_reg_loss: 875.9313; train_edge_recon_loss: 3456242.1944; train_gene_expr_recon_loss: 618426.5208; train_masked_gp_l1_reg_loss: 8193.6268; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266108.1910; train_global_loss: 4349846.5000; train_optim_loss: 4349846.5000; val_kl_reg_loss: 923.6664; val_edge_recon_loss: 3775477.7500; val_gene_expr_recon_loss: 612517.9375; val_masked_gp_l1_reg_loss: 6160.6372; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 261651.7500; val_global_loss: 4656732.0000; val_optim_loss: 4656732.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9162; val_auprc_score: 0.9051; val_best_acc_score: 0.8367; val_best_f1_score: 0.8427; train_kl_reg_loss: 2772.0090; train_edge_recon_loss: 3264480.2222; train_gene_expr_recon_loss: 598376.0556; train_masked_gp_l1_reg_loss: 6027.1039; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262374.5069; train_global_loss: 4134029.9167; train_optim_loss: 4134029.9167; val_kl_reg_loss: 9596.5781; val_edge_recon_loss: 2887083.0000; val_gene_expr_recon_loss: 589395.1875; val_masked_gp_l1_reg_loss: 5900.2441; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259709.2500; val_global_loss: 3751684.2500; val_optim_loss: 3751684.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9174; val_auprc_score: 0.8960; val_best_acc_score: 0.8477; val_best_f1_score: 0.8594; train_kl_reg_loss: 24385.2990; train_edge_recon_loss: 2796903.9722; train_gene_expr_recon_loss: 589564.0625; train_masked_gp_l1_reg_loss: 5596.0105; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262071.2153; train_global_loss: 3678520.4722; train_optim_loss: 3678520.4722; val_kl_reg_loss: 40509.2812; val_edge_recon_loss: 2735451.7500; val_gene_expr_recon_loss: 592795.8750; val_masked_gp_l1_reg_loss: 5368.5322; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259258.7656; val_global_loss: 3633384.2500; val_optim_loss: 3633384.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9112; val_best_acc_score: 0.8663; val_best_f1_score: 0.8747; train_kl_reg_loss: 43089.2105; train_edge_recon_loss: 2725100.0000; train_gene_expr_recon_loss: 574567.0833; train_masked_gp_l1_reg_loss: 5339.3444; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260030.0955; train_global_loss: 3608125.7222; train_optim_loss: 3608125.7222; val_kl_reg_loss: 39105.1875; val_edge_recon_loss: 2731756.2500; val_gene_expr_recon_loss: 567266.3125; val_masked_gp_l1_reg_loss: 5259.2070; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257019.3594; val_global_loss: 3600406.2500; val_optim_loss: 3600406.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9355; val_auprc_score: 0.9195; val_best_acc_score: 0.8716; val_best_f1_score: 0.8799; train_kl_reg_loss: 34518.8071; train_edge_recon_loss: 2715816.0556; train_gene_expr_recon_loss: 563345.9583; train_masked_gp_l1_reg_loss: 5207.5240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258120.7309; train_global_loss: 3577009.0833; train_optim_loss: 3577009.0833; val_kl_reg_loss: 29915.5742; val_edge_recon_loss: 2742065.7500; val_gene_expr_recon_loss: 563786.0625; val_masked_gp_l1_reg_loss: 5155.3750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256154.5938; val_global_loss: 3597077.0000; val_optim_loss: 3597077.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9425; val_auprc_score: 0.9251; val_best_acc_score: 0.8822; val_best_f1_score: 0.8887; train_kl_reg_loss: 30147.9950; train_edge_recon_loss: 2700325.3611; train_gene_expr_recon_loss: 553593.0972; train_masked_gp_l1_reg_loss: 5144.1973; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258549.9080; train_global_loss: 3547760.5556; train_optim_loss: 3547760.5556; val_kl_reg_loss: 28395.5586; val_edge_recon_loss: 2741193.0000; val_gene_expr_recon_loss: 556141.8125; val_masked_gp_l1_reg_loss: 5145.2642; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255147.2188; val_global_loss: 3586022.7500; val_optim_loss: 3586022.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9526; val_auprc_score: 0.9390; val_best_acc_score: 0.8973; val_best_f1_score: 0.9030; train_kl_reg_loss: 28724.3709; train_edge_recon_loss: 2682280.1944; train_gene_expr_recon_loss: 549819.5000; train_masked_gp_l1_reg_loss: 5176.3801; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256841.2049; train_global_loss: 3522841.8056; train_optim_loss: 3522841.8056; val_kl_reg_loss: 28625.3086; val_edge_recon_loss: 2698935.2500; val_gene_expr_recon_loss: 541897.8750; val_masked_gp_l1_reg_loss: 5213.8887; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253877.1250; val_global_loss: 3528549.5000; val_optim_loss: 3528549.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9576; val_auprc_score: 0.9436; val_best_acc_score: 0.9047; val_best_f1_score: 0.9093; train_kl_reg_loss: 28698.0964; train_edge_recon_loss: 2677704.8889; train_gene_expr_recon_loss: 537863.4653; train_masked_gp_l1_reg_loss: 5264.3717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254479.2622; train_global_loss: 3504010.0278; train_optim_loss: 3504010.0278; val_kl_reg_loss: 28053.8105; val_edge_recon_loss: 2671885.5000; val_gene_expr_recon_loss: 539991.5000; val_masked_gp_l1_reg_loss: 5337.7202; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252830.8594; val_global_loss: 3498099.2500; val_optim_loss: 3498099.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9579; val_auprc_score: 0.9452; val_best_acc_score: 0.9049; val_best_f1_score: 0.9088; train_kl_reg_loss: 28812.2283; train_edge_recon_loss: 2668498.6944; train_gene_expr_recon_loss: 533754.8819; train_masked_gp_l1_reg_loss: 5397.5538; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 255786.5226; train_global_loss: 3492249.8889; train_optim_loss: 3492249.8889; val_kl_reg_loss: 29596.5195; val_edge_recon_loss: 2703466.7500; val_gene_expr_recon_loss: 526183.8750; val_masked_gp_l1_reg_loss: 5473.3843; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251366.1562; val_global_loss: 3516086.7500; val_optim_loss: 3516086.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9621; val_auprc_score: 0.9483; val_best_acc_score: 0.9112; val_best_f1_score: 0.9149; train_kl_reg_loss: 29595.4694; train_edge_recon_loss: 2667618.3056; train_gene_expr_recon_loss: 524532.5972; train_masked_gp_l1_reg_loss: 5548.6778; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254583.9774; train_global_loss: 3481878.9722; train_optim_loss: 3481878.9722; val_kl_reg_loss: 28488.8457; val_edge_recon_loss: 2656182.2500; val_gene_expr_recon_loss: 523436.4375; val_masked_gp_l1_reg_loss: 5632.6406; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250870.5000; val_global_loss: 3464610.7500; val_optim_loss: 3464610.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9641; val_auprc_score: 0.9525; val_best_acc_score: 0.9131; val_best_f1_score: 0.9173; train_kl_reg_loss: 29456.3748; train_edge_recon_loss: 2674156.8611; train_gene_expr_recon_loss: 518256.8333; train_masked_gp_l1_reg_loss: 5701.1393; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252441.1493; train_global_loss: 3480012.4167; train_optim_loss: 3480012.4167; val_kl_reg_loss: 28492.8711; val_edge_recon_loss: 2665324.7500; val_gene_expr_recon_loss: 517560.5938; val_masked_gp_l1_reg_loss: 5791.0410; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250066.8750; val_global_loss: 3467236.0000; val_optim_loss: 3467236.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9671; val_auprc_score: 0.9570; val_best_acc_score: 0.9158; val_best_f1_score: 0.9186; train_kl_reg_loss: 28542.2409; train_edge_recon_loss: 2661938.7778; train_gene_expr_recon_loss: 512257.1910; train_masked_gp_l1_reg_loss: 5869.5219; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251765.9549; train_global_loss: 3460373.6944; train_optim_loss: 3460373.6944; val_kl_reg_loss: 28009.2305; val_edge_recon_loss: 2670784.2500; val_gene_expr_recon_loss: 510719.5000; val_masked_gp_l1_reg_loss: 5955.2002; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249088.6250; val_global_loss: 3464557.0000; val_optim_loss: 3464557.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9685; val_auprc_score: 0.9580; val_best_acc_score: 0.9219; val_best_f1_score: 0.9250; train_kl_reg_loss: 28833.5306; train_edge_recon_loss: 2662580.0833; train_gene_expr_recon_loss: 506600.5972; train_masked_gp_l1_reg_loss: 6027.8362; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250636.0712; train_global_loss: 3454678.1111; train_optim_loss: 3454678.1111; val_kl_reg_loss: 29357.6504; val_edge_recon_loss: 2656346.7500; val_gene_expr_recon_loss: 506080.2500; val_masked_gp_l1_reg_loss: 6107.7549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248193.5625; val_global_loss: 3446086.0000; val_optim_loss: 3446086.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9674; val_auprc_score: 0.9554; val_best_acc_score: 0.9209; val_best_f1_score: 0.9243; train_kl_reg_loss: 29738.6246; train_edge_recon_loss: 2650927.4167; train_gene_expr_recon_loss: 500448.2153; train_masked_gp_l1_reg_loss: 6176.6095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250764.3125; train_global_loss: 3438055.1944; train_optim_loss: 3438055.1944; val_kl_reg_loss: 27781.6172; val_edge_recon_loss: 2660010.2500; val_gene_expr_recon_loss: 500974.5000; val_masked_gp_l1_reg_loss: 6261.8237; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247544.8906; val_global_loss: 3442573.0000; val_optim_loss: 3442573.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9683; val_auprc_score: 0.9534; val_best_acc_score: 0.9233; val_best_f1_score: 0.9264; train_kl_reg_loss: 28553.8583; train_edge_recon_loss: 2658112.6111; train_gene_expr_recon_loss: 500699.5347; train_masked_gp_l1_reg_loss: 6332.7849; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250009.6458; train_global_loss: 3443708.3889; train_optim_loss: 3443708.3889; val_kl_reg_loss: 27521.6523; val_edge_recon_loss: 2662117.2500; val_gene_expr_recon_loss: 497770.9688; val_masked_gp_l1_reg_loss: 6414.1431; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247044.0469; val_global_loss: 3440868.2500; val_optim_loss: 3440868.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9723; val_auprc_score: 0.9623; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 28343.0126; train_edge_recon_loss: 2653597.7778; train_gene_expr_recon_loss: 495533.3785; train_masked_gp_l1_reg_loss: 6481.3716; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248893.1927; train_global_loss: 3432848.7778; train_optim_loss: 3432848.7778; val_kl_reg_loss: 28235.6406; val_edge_recon_loss: 2665940.7500; val_gene_expr_recon_loss: 495855.3125; val_masked_gp_l1_reg_loss: 6565.1494; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246390.6250; val_global_loss: 3442987.5000; val_optim_loss: 3442987.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9729; val_auprc_score: 0.9617; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 29151.5030; train_edge_recon_loss: 2653960.8611; train_gene_expr_recon_loss: 490335.4028; train_masked_gp_l1_reg_loss: 6647.4154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248596.2205; train_global_loss: 3428691.4722; train_optim_loss: 3428691.4722; val_kl_reg_loss: 27698.3086; val_edge_recon_loss: 2663720.2500; val_gene_expr_recon_loss: 492464.6562; val_masked_gp_l1_reg_loss: 6732.8862; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245996.0938; val_global_loss: 3436612.2500; val_optim_loss: 3436612.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9713; val_auprc_score: 0.9607; val_best_acc_score: 0.9279; val_best_f1_score: 0.9306; train_kl_reg_loss: 28435.7819; train_edge_recon_loss: 2651954.8889; train_gene_expr_recon_loss: 487642.1319; train_masked_gp_l1_reg_loss: 6787.6612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248306.4062; train_global_loss: 3423126.8889; train_optim_loss: 3423126.8889; val_kl_reg_loss: 27721.1113; val_edge_recon_loss: 2669525.2500; val_gene_expr_recon_loss: 488731.9375; val_masked_gp_l1_reg_loss: 6858.4429; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245924.9531; val_global_loss: 3438761.7500; val_optim_loss: 3438761.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9725; val_auprc_score: 0.9579; val_best_acc_score: 0.9345; val_best_f1_score: 0.9363; train_kl_reg_loss: 28134.5241; train_edge_recon_loss: 2644735.3056; train_gene_expr_recon_loss: 484964.9757; train_masked_gp_l1_reg_loss: 6916.1809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247099.4601; train_global_loss: 3411850.4167; train_optim_loss: 3411850.4167; val_kl_reg_loss: 26867.1152; val_edge_recon_loss: 2659846.0000; val_gene_expr_recon_loss: 491969.7812; val_masked_gp_l1_reg_loss: 6972.6104; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245765.8906; val_global_loss: 3431421.2500; val_optim_loss: 3431421.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9730; val_auprc_score: 0.9590; val_best_acc_score: 0.9293; val_best_f1_score: 0.9320; train_kl_reg_loss: 27818.3056; train_edge_recon_loss: 2642727.3611; train_gene_expr_recon_loss: 482390.7604; train_masked_gp_l1_reg_loss: 7029.0091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247281.4878; train_global_loss: 3407246.9167; train_optim_loss: 3407246.9167; val_kl_reg_loss: 27110.7852; val_edge_recon_loss: 2653576.2500; val_gene_expr_recon_loss: 483619.2812; val_masked_gp_l1_reg_loss: 7086.2788; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244889.8750; val_global_loss: 3416282.5000; val_optim_loss: 3416282.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9752; val_auprc_score: 0.9652; val_best_acc_score: 0.9334; val_best_f1_score: 0.9359; train_kl_reg_loss: 27593.2185; train_edge_recon_loss: 2643910.5278; train_gene_expr_recon_loss: 479793.9097; train_masked_gp_l1_reg_loss: 7138.4009; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246644.6979; train_global_loss: 3405080.7500; train_optim_loss: 3405080.7500; val_kl_reg_loss: 26476.8516; val_edge_recon_loss: 2634895.2500; val_gene_expr_recon_loss: 482496.9062; val_masked_gp_l1_reg_loss: 7194.2798; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244258.2500; val_global_loss: 3395321.5000; val_optim_loss: 3395321.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9779; val_auprc_score: 0.9708; val_best_acc_score: 0.9380; val_best_f1_score: 0.9402; train_kl_reg_loss: 26792.9253; train_edge_recon_loss: 2638556.9444; train_gene_expr_recon_loss: 478535.4167; train_masked_gp_l1_reg_loss: 7246.9664; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245978.8229; train_global_loss: 3397111.0556; train_optim_loss: 3397111.0556; val_kl_reg_loss: 25991.6602; val_edge_recon_loss: 2647219.5000; val_gene_expr_recon_loss: 482683.9688; val_masked_gp_l1_reg_loss: 7293.8770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244137.6875; val_global_loss: 3407327.0000; val_optim_loss: 3407327.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9764; val_auprc_score: 0.9688; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 27229.4891; train_edge_recon_loss: 2641091.5556; train_gene_expr_recon_loss: 475519.2604; train_masked_gp_l1_reg_loss: 7334.0431; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245003.4392; train_global_loss: 3396177.7778; train_optim_loss: 3396177.7778; val_kl_reg_loss: 26675.8438; val_edge_recon_loss: 2648002.0000; val_gene_expr_recon_loss: 481610.0938; val_masked_gp_l1_reg_loss: 7385.2954; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243584.7188; val_global_loss: 3407257.7500; val_optim_loss: 3407257.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9788; val_auprc_score: 0.9714; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 26879.0219; train_edge_recon_loss: 2634625.6667; train_gene_expr_recon_loss: 473119.0000; train_masked_gp_l1_reg_loss: 7427.6517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244681.7812; train_global_loss: 3386733.1111; train_optim_loss: 3386733.1111; val_kl_reg_loss: 27424.2305; val_edge_recon_loss: 2654450.5000; val_gene_expr_recon_loss: 477607.6250; val_masked_gp_l1_reg_loss: 7474.2578; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243115.2031; val_global_loss: 3410072.0000; val_optim_loss: 3410072.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9776; val_auprc_score: 0.9684; val_best_acc_score: 0.9372; val_best_f1_score: 0.9392; train_kl_reg_loss: 28598.0881; train_edge_recon_loss: 2642081.8056; train_gene_expr_recon_loss: 490281.6562; train_masked_gp_l1_reg_loss: 7477.2909; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247242.0920; train_global_loss: 3415680.9722; train_optim_loss: 3415680.9722; val_kl_reg_loss: 14094.9688; val_edge_recon_loss: 2648476.7500; val_gene_expr_recon_loss: 497512.0000; val_masked_gp_l1_reg_loss: 7467.1416; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245279.5625; val_global_loss: 3412830.5000; val_optim_loss: 3412830.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9794; val_auprc_score: 0.9704; val_best_acc_score: 0.9433; val_best_f1_score: 0.9448; train_kl_reg_loss: 27148.3166; train_edge_recon_loss: 2631005.7500; train_gene_expr_recon_loss: 491199.8993; train_masked_gp_l1_reg_loss: 7379.1005; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246831.0903; train_global_loss: 3403564.1667; train_optim_loss: 3403564.1667; val_kl_reg_loss: 13963.7686; val_edge_recon_loss: 2617549.5000; val_gene_expr_recon_loss: 499259.7500; val_masked_gp_l1_reg_loss: 7288.3594; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245651.5938; val_global_loss: 3383712.7500; val_optim_loss: 3383712.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9783; val_auprc_score: 0.9711; val_best_acc_score: 0.9379; val_best_f1_score: 0.9401; train_kl_reg_loss: 26445.6191; train_edge_recon_loss: 2633862.0278; train_gene_expr_recon_loss: 488129.6007; train_masked_gp_l1_reg_loss: 7269.0933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246086.3177; train_global_loss: 3401792.6111; train_optim_loss: 3401792.6111; val_kl_reg_loss: 13522.4590; val_edge_recon_loss: 2634759.7500; val_gene_expr_recon_loss: 494809.6250; val_masked_gp_l1_reg_loss: 7239.7700; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244951.6875; val_global_loss: 3395283.5000; val_optim_loss: 3395283.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9771; val_auprc_score: 0.9685; val_best_acc_score: 0.9411; val_best_f1_score: 0.9428; train_kl_reg_loss: 25682.2344; train_edge_recon_loss: 2633007.6667; train_gene_expr_recon_loss: 487235.5972; train_masked_gp_l1_reg_loss: 7224.9352; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246253.9306; train_global_loss: 3399404.4167; train_optim_loss: 3399404.4167; val_kl_reg_loss: 13381.0977; val_edge_recon_loss: 2647897.0000; val_gene_expr_recon_loss: 497842.0000; val_masked_gp_l1_reg_loss: 7209.3799; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245361.0781; val_global_loss: 3411690.5000; val_optim_loss: 3411690.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9733; val_auprc_score: 0.9615; val_best_acc_score: 0.9351; val_best_f1_score: 0.9377; train_kl_reg_loss: 25479.7418; train_edge_recon_loss: 2625812.3056; train_gene_expr_recon_loss: 488357.1979; train_masked_gp_l1_reg_loss: 7201.0685; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246947.9045; train_global_loss: 3393798.1944; train_optim_loss: 3393798.1944; val_kl_reg_loss: 13389.9473; val_edge_recon_loss: 2662944.2500; val_gene_expr_recon_loss: 495907.3438; val_masked_gp_l1_reg_loss: 7193.2495; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245106.3281; val_global_loss: 3424541.0000; val_optim_loss: 3424541.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9776; val_auprc_score: 0.9686; val_best_acc_score: 0.9384; val_best_f1_score: 0.9405; train_kl_reg_loss: 25364.7702; train_edge_recon_loss: 2627980.7222; train_gene_expr_recon_loss: 487712.3090; train_masked_gp_l1_reg_loss: 7189.8247; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247219.9375; train_global_loss: 3395467.5556; train_optim_loss: 3395467.5556; val_kl_reg_loss: 13418.3389; val_edge_recon_loss: 2640877.2500; val_gene_expr_recon_loss: 496339.2188; val_masked_gp_l1_reg_loss: 7185.1958; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245249.4375; val_global_loss: 3403069.5000; val_optim_loss: 3403069.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9752; val_auprc_score: 0.9644; val_best_acc_score: 0.9364; val_best_f1_score: 0.9386; train_kl_reg_loss: 25172.7845; train_edge_recon_loss: 2627711.8889; train_gene_expr_recon_loss: 485971.6771; train_masked_gp_l1_reg_loss: 7175.9729; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245889.8455; train_global_loss: 3391922.2222; train_optim_loss: 3391922.2222; val_kl_reg_loss: 13477.9805; val_edge_recon_loss: 2654136.0000; val_gene_expr_recon_loss: 496147.3750; val_masked_gp_l1_reg_loss: 7166.8315; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245239.3281; val_global_loss: 3416167.5000; val_optim_loss: 3416167.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9771; val_auprc_score: 0.9697; val_best_acc_score: 0.9390; val_best_f1_score: 0.9412; train_kl_reg_loss: 25252.5137; train_edge_recon_loss: 2627451.1111; train_gene_expr_recon_loss: 486917.9757; train_masked_gp_l1_reg_loss: 7165.0505; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246702.4184; train_global_loss: 3393489.1389; train_optim_loss: 3393489.1389; val_kl_reg_loss: 13491.7520; val_edge_recon_loss: 2652109.5000; val_gene_expr_recon_loss: 495855.8125; val_masked_gp_l1_reg_loss: 7161.9194; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245146.7031; val_global_loss: 3413765.7500; val_optim_loss: 3413765.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9774; val_auprc_score: 0.9681; val_best_acc_score: 0.9372; val_best_f1_score: 0.9396; train_kl_reg_loss: 25287.3125; train_edge_recon_loss: 2635371.8333; train_gene_expr_recon_loss: 486980.3924; train_masked_gp_l1_reg_loss: 7160.2685; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247028.5642; train_global_loss: 3401828.5278; train_optim_loss: 3401828.5278; val_kl_reg_loss: 13497.7891; val_edge_recon_loss: 2660412.7500; val_gene_expr_recon_loss: 495593.5938; val_masked_gp_l1_reg_loss: 7158.4082; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245041.9375; val_global_loss: 3421704.5000; val_optim_loss: 3421704.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9786; val_auprc_score: 0.9694; val_best_acc_score: 0.9399; val_best_f1_score: 0.9420; train_kl_reg_loss: 25390.4436; train_edge_recon_loss: 2630438.1667; train_gene_expr_recon_loss: 487185.2674; train_masked_gp_l1_reg_loss: 7157.4673; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246105.5851; train_global_loss: 3396276.9722; train_optim_loss: 3396276.9722; val_kl_reg_loss: 13453.3906; val_edge_recon_loss: 2642554.0000; val_gene_expr_recon_loss: 495795.8750; val_masked_gp_l1_reg_loss: 7156.4561; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245074.5156; val_global_loss: 3404034.5000; val_optim_loss: 3404034.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 54 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9766
val AUPRC score: 0.9657
val best accuracy score: 0.9368
val best F1 score: 0.9389
val target rna MSE score: 0.4374
val source rna MSE score: 0.2875
val target atac MSE score: 0.1324
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
