[True]
Run timestamp: 10082023_132812_1002.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1002']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7440; val_auprc_score: 0.7658; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 72871.7739; train_edge_recon_loss: 3617684.6183; train_gene_expr_recon_loss: 14420505.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 734230.8974; train_global_loss: 18845292.3969; train_optim_loss: 18845292.3969; val_kl_reg_loss: 107882.6031; val_edge_recon_loss: 4065264.4167; val_gene_expr_recon_loss: 12952596.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 696960.0750; val_global_loss: 17822703.3333; val_optim_loss: 17822703.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7933; val_auprc_score: 0.8078; val_best_acc_score: 0.7071; val_best_f1_score: 0.7180; train_kl_reg_loss: 112604.8068; train_edge_recon_loss: 3529994.0153; train_gene_expr_recon_loss: 12676646.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 689792.7729; train_global_loss: 17009038.3664; train_optim_loss: 17009038.3664; val_kl_reg_loss: 108324.0917; val_edge_recon_loss: 4033633.6000; val_gene_expr_recon_loss: 12551205.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 682520.8208; val_global_loss: 17375684.1333; val_optim_loss: 17375684.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8305; val_auprc_score: 0.8405; val_best_acc_score: 0.7412; val_best_f1_score: 0.7518; train_kl_reg_loss: 90073.2230; train_edge_recon_loss: 3454186.7214; train_gene_expr_recon_loss: 12424733.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 679641.9747; train_global_loss: 16648635.6641; train_optim_loss: 16648635.6641; val_kl_reg_loss: 78627.7880; val_edge_recon_loss: 3366561.0333; val_gene_expr_recon_loss: 12354545.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 673504.7958; val_global_loss: 16473239.0667; val_optim_loss: 16473239.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9031; val_auprc_score: 0.8962; val_best_acc_score: 0.8267; val_best_f1_score: 0.8338; train_kl_reg_loss: 97781.5696; train_edge_recon_loss: 3074638.1737; train_gene_expr_recon_loss: 12297554.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 673735.7457; train_global_loss: 16143709.5649; train_optim_loss: 16143709.5649; val_kl_reg_loss: 102582.0240; val_edge_recon_loss: 2941748.0667; val_gene_expr_recon_loss: 12299002.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 673230.1750; val_global_loss: 16016562.8000; val_optim_loss: 16016562.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9233; val_auprc_score: 0.9135; val_best_acc_score: 0.8500; val_best_f1_score: 0.8566; train_kl_reg_loss: 111680.2273; train_edge_recon_loss: 2874129.3779; train_gene_expr_recon_loss: 12141562.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 666792.1613; train_global_loss: 15794163.7328; train_optim_loss: 15794163.7328; val_kl_reg_loss: 117838.8802; val_edge_recon_loss: 2842368.0333; val_gene_expr_recon_loss: 12078668.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 663883.1083; val_global_loss: 15702758.8000; val_optim_loss: 15702758.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9265; val_auprc_score: 0.9143; val_best_acc_score: 0.8572; val_best_f1_score: 0.8640; train_kl_reg_loss: 111865.9415; train_edge_recon_loss: 2831298.4656; train_gene_expr_recon_loss: 12026664.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 661083.6097; train_global_loss: 15630912.8321; train_optim_loss: 15630912.8321; val_kl_reg_loss: 110284.5875; val_edge_recon_loss: 2834495.7667; val_gene_expr_recon_loss: 12020406.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 656895.4667; val_global_loss: 15622082.4667; val_optim_loss: 15622082.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9237; val_auprc_score: 0.9062; val_best_acc_score: 0.8589; val_best_f1_score: 0.8686; train_kl_reg_loss: 106097.3182; train_edge_recon_loss: 2806977.4561; train_gene_expr_recon_loss: 11918316.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 655047.5057; train_global_loss: 15486438.9847; train_optim_loss: 15486438.9847; val_kl_reg_loss: 101815.7964; val_edge_recon_loss: 2833756.3333; val_gene_expr_recon_loss: 11952897.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 650882.1917; val_global_loss: 15539351.3333; val_optim_loss: 15539351.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9275; val_auprc_score: 0.9101; val_best_acc_score: 0.8642; val_best_f1_score: 0.8732; train_kl_reg_loss: 98580.7942; train_edge_recon_loss: 2807337.0076; train_gene_expr_recon_loss: 11833954.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 650375.3163; train_global_loss: 15390247.8779; train_optim_loss: 15390247.8779; val_kl_reg_loss: 98091.2635; val_edge_recon_loss: 2807757.0000; val_gene_expr_recon_loss: 11839399.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 647803.6833; val_global_loss: 15393051.9333; val_optim_loss: 15393051.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9378; val_auprc_score: 0.9246; val_best_acc_score: 0.8759; val_best_f1_score: 0.8831; train_kl_reg_loss: 94577.4846; train_edge_recon_loss: 2787992.1794; train_gene_expr_recon_loss: 11744625.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 645459.0396; train_global_loss: 15272654.7023; train_optim_loss: 15272654.7023; val_kl_reg_loss: 90169.8156; val_edge_recon_loss: 2804394.4333; val_gene_expr_recon_loss: 11806183.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 646571.8458; val_global_loss: 15347319.9333; val_optim_loss: 15347319.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9383; val_auprc_score: 0.9213; val_best_acc_score: 0.8797; val_best_f1_score: 0.8871; train_kl_reg_loss: 91048.5191; train_edge_recon_loss: 2793927.2977; train_gene_expr_recon_loss: 11673034.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 641710.3034; train_global_loss: 15199720.3893; train_optim_loss: 15199720.3893; val_kl_reg_loss: 88226.9552; val_edge_recon_loss: 2776254.9000; val_gene_expr_recon_loss: 11684725.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 639133.8167; val_global_loss: 15188341.3333; val_optim_loss: 15188341.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9397; val_auprc_score: 0.9261; val_best_acc_score: 0.8774; val_best_f1_score: 0.8835; train_kl_reg_loss: 88090.6588; train_edge_recon_loss: 2785983.6393; train_gene_expr_recon_loss: 11610657.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 638285.5844; train_global_loss: 15123016.9466; train_optim_loss: 15123016.9466; val_kl_reg_loss: 84508.3172; val_edge_recon_loss: 2784771.8833; val_gene_expr_recon_loss: 11607717.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 633532.9667; val_global_loss: 15110530.8000; val_optim_loss: 15110530.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9420; val_auprc_score: 0.9259; val_best_acc_score: 0.8860; val_best_f1_score: 0.8911; train_kl_reg_loss: 84675.0363; train_edge_recon_loss: 2778367.5324; train_gene_expr_recon_loss: 11561595.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 635807.7481; train_global_loss: 15060446.2748; train_optim_loss: 15060446.2748; val_kl_reg_loss: 80791.7740; val_edge_recon_loss: 2775296.5333; val_gene_expr_recon_loss: 11567686.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 631023.9500; val_global_loss: 15054798.4000; val_optim_loss: 15054798.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9402; val_auprc_score: 0.9254; val_best_acc_score: 0.8754; val_best_f1_score: 0.8815; train_kl_reg_loss: 81071.9497; train_edge_recon_loss: 2765561.1908; train_gene_expr_recon_loss: 11506216.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 632200.5740; train_global_loss: 14985049.8015; train_optim_loss: 14985049.8015; val_kl_reg_loss: 75816.1297; val_edge_recon_loss: 2771019.8333; val_gene_expr_recon_loss: 11524622.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 630151.3458; val_global_loss: 15001609.6667; val_optim_loss: 15001609.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9495; val_auprc_score: 0.9386; val_best_acc_score: 0.8864; val_best_f1_score: 0.8896; train_kl_reg_loss: 78213.4880; train_edge_recon_loss: 2766985.5095; train_gene_expr_recon_loss: 11475226.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 630868.1951; train_global_loss: 14951293.6489; train_optim_loss: 14951293.6489; val_kl_reg_loss: 79313.7760; val_edge_recon_loss: 2772247.6167; val_gene_expr_recon_loss: 11445907.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 627023.1167; val_global_loss: 14924492.2000; val_optim_loss: 14924492.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9500; val_auprc_score: 0.9372; val_best_acc_score: 0.8922; val_best_f1_score: 0.8963; train_kl_reg_loss: 76221.0812; train_edge_recon_loss: 2755959.5763; train_gene_expr_recon_loss: 11416904.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 627137.9981; train_global_loss: 14876223.2672; train_optim_loss: 14876223.2672; val_kl_reg_loss: 75517.1974; val_edge_recon_loss: 2767696.0833; val_gene_expr_recon_loss: 11418013.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 622888.7875; val_global_loss: 14884115.5333; val_optim_loss: 14884115.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9499; val_auprc_score: 0.9398; val_best_acc_score: 0.8907; val_best_f1_score: 0.8946; train_kl_reg_loss: 74357.9447; train_edge_recon_loss: 2748703.5344; train_gene_expr_recon_loss: 11381737.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 625667.1584; train_global_loss: 14830466.4504; train_optim_loss: 14830466.4504; val_kl_reg_loss: 72792.2865; val_edge_recon_loss: 2769726.6667; val_gene_expr_recon_loss: 11416379.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 620551.1458; val_global_loss: 14879449.4667; val_optim_loss: 14879449.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9515; val_auprc_score: 0.9394; val_best_acc_score: 0.8922; val_best_f1_score: 0.8970; train_kl_reg_loss: 73277.1873; train_edge_recon_loss: 2734381.0382; train_gene_expr_recon_loss: 11338473.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 623687.6508; train_global_loss: 14769819.4809; train_optim_loss: 14769819.4809; val_kl_reg_loss: 70024.1672; val_edge_recon_loss: 2764569.6000; val_gene_expr_recon_loss: 11342266.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618997.5250; val_global_loss: 14795858.2000; val_optim_loss: 14795858.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9559; val_auprc_score: 0.9425; val_best_acc_score: 0.9011; val_best_f1_score: 0.9053; train_kl_reg_loss: 70778.9705; train_edge_recon_loss: 2732097.0115; train_gene_expr_recon_loss: 11305131.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 621742.0887; train_global_loss: 14729749.6794; train_optim_loss: 14729749.6794; val_kl_reg_loss: 67228.8339; val_edge_recon_loss: 2732408.8167; val_gene_expr_recon_loss: 11311403.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618254.9417; val_global_loss: 14729296.0000; val_optim_loss: 14729296.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9566; val_auprc_score: 0.9440; val_best_acc_score: 0.9011; val_best_f1_score: 0.9057; train_kl_reg_loss: 69240.9620; train_edge_recon_loss: 2726473.8111; train_gene_expr_recon_loss: 11270083.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 619936.1240; train_global_loss: 14685734.6794; train_optim_loss: 14685734.6794; val_kl_reg_loss: 68197.3734; val_edge_recon_loss: 2731776.7500; val_gene_expr_recon_loss: 11235033.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 614904.2417; val_global_loss: 14649912.0667; val_optim_loss: 14649912.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9569; val_auprc_score: 0.9438; val_best_acc_score: 0.9011; val_best_f1_score: 0.9046; train_kl_reg_loss: 68677.8374; train_edge_recon_loss: 2714218.1698; train_gene_expr_recon_loss: 11254574.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 619206.8340; train_global_loss: 14656677.4198; train_optim_loss: 14656677.4198; val_kl_reg_loss: 67919.0734; val_edge_recon_loss: 2725839.2000; val_gene_expr_recon_loss: 11289783.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 617568.6167; val_global_loss: 14701110.1333; val_optim_loss: 14701110.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9590; val_auprc_score: 0.9463; val_best_acc_score: 0.9049; val_best_f1_score: 0.9093; train_kl_reg_loss: 68101.9567; train_edge_recon_loss: 2702225.2844; train_gene_expr_recon_loss: 11223254.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 617389.9857; train_global_loss: 14610972.0305; train_optim_loss: 14610972.0305; val_kl_reg_loss: 67869.2000; val_edge_recon_loss: 2699789.9500; val_gene_expr_recon_loss: 11221475.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 615268.4792; val_global_loss: 14604403.4000; val_optim_loss: 14604403.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9647; val_auprc_score: 0.9547; val_best_acc_score: 0.9116; val_best_f1_score: 0.9146; train_kl_reg_loss: 66816.7201; train_edge_recon_loss: 2698767.4885; train_gene_expr_recon_loss: 11197775.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 616516.4141; train_global_loss: 14579876.3740; train_optim_loss: 14579876.3740; val_kl_reg_loss: 65864.4977; val_edge_recon_loss: 2717399.2667; val_gene_expr_recon_loss: 11266109.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 616028.9750; val_global_loss: 14665402.0667; val_optim_loss: 14665402.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9637; val_auprc_score: 0.9510; val_best_acc_score: 0.9081; val_best_f1_score: 0.9100; train_kl_reg_loss: 66027.2547; train_edge_recon_loss: 2692928.5534; train_gene_expr_recon_loss: 11168232.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 614312.3096; train_global_loss: 14541500.6336; train_optim_loss: 14541500.6336; val_kl_reg_loss: 64100.4318; val_edge_recon_loss: 2713122.0000; val_gene_expr_recon_loss: 11164886.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 610898.7750; val_global_loss: 14553007.6000; val_optim_loss: 14553007.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9650; val_auprc_score: 0.9548; val_best_acc_score: 0.9081; val_best_f1_score: 0.9125; train_kl_reg_loss: 64078.1183; train_edge_recon_loss: 2687953.5458; train_gene_expr_recon_loss: 11147593.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 613313.4356; train_global_loss: 14512938.3969; train_optim_loss: 14512938.3969; val_kl_reg_loss: 63515.5398; val_edge_recon_loss: 2710517.2333; val_gene_expr_recon_loss: 11190503.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 611835.3958; val_global_loss: 14576371.6667; val_optim_loss: 14576371.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9659; val_auprc_score: 0.9531; val_best_acc_score: 0.9173; val_best_f1_score: 0.9205; train_kl_reg_loss: 63367.2091; train_edge_recon_loss: 2688337.8989; train_gene_expr_recon_loss: 11131364.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 612927.4532; train_global_loss: 14495997.4733; train_optim_loss: 14495997.4733; val_kl_reg_loss: 62296.2674; val_edge_recon_loss: 2691489.5667; val_gene_expr_recon_loss: 11158839.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 612317.3708; val_global_loss: 14524943.0000; val_optim_loss: 14524943.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9692; val_auprc_score: 0.9566; val_best_acc_score: 0.9221; val_best_f1_score: 0.9238; train_kl_reg_loss: 70947.6483; train_edge_recon_loss: 2714323.4313; train_gene_expr_recon_loss: 11396509.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 629090.4666; train_global_loss: 14810871.2061; train_optim_loss: 14810871.2061; val_kl_reg_loss: 33756.0310; val_edge_recon_loss: 2708610.5167; val_gene_expr_recon_loss: 11436465.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 626929.9167; val_global_loss: 14805761.6667; val_optim_loss: 14805761.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9711; val_auprc_score: 0.9632; val_best_acc_score: 0.9237; val_best_f1_score: 0.9260; train_kl_reg_loss: 73865.1014; train_edge_recon_loss: 2708348.2557; train_gene_expr_recon_loss: 11479229.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 631183.7238; train_global_loss: 14892626.7328; train_optim_loss: 14892626.7328; val_kl_reg_loss: 25951.6492; val_edge_recon_loss: 2711212.5000; val_gene_expr_recon_loss: 11568148.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 631181.6125; val_global_loss: 14936494.0000; val_optim_loss: 14936494.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9610; val_auprc_score: 0.9486; val_best_acc_score: 0.9018; val_best_f1_score: 0.9067; train_kl_reg_loss: 73223.4050; train_edge_recon_loss: 2725421.8492; train_gene_expr_recon_loss: 11616250.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 635248.1493; train_global_loss: 15050143.7023; train_optim_loss: 15050143.7023; val_kl_reg_loss: 19862.6272; val_edge_recon_loss: 2735078.0167; val_gene_expr_recon_loss: 11786409.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 635485.3958; val_global_loss: 15176835.9333; val_optim_loss: 15176835.9333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9628; val_auprc_score: 0.9524; val_best_acc_score: 0.9128; val_best_f1_score: 0.9161; train_kl_reg_loss: 71567.7166; train_edge_recon_loss: 2725796.1565; train_gene_expr_recon_loss: 11786290.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 636505.7028; train_global_loss: 15220160.1527; train_optim_loss: 15220160.1527; val_kl_reg_loss: 19090.6523; val_edge_recon_loss: 2739844.8667; val_gene_expr_recon_loss: 11851303.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 637160.7667; val_global_loss: 15247399.5333; val_optim_loss: 15247399.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9647; val_auprc_score: 0.9560; val_best_acc_score: 0.9119; val_best_f1_score: 0.9147; train_kl_reg_loss: 63555.1260; train_edge_recon_loss: 2699947.9179; train_gene_expr_recon_loss: 11826698.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 636586.4809; train_global_loss: 15226788.4351; train_optim_loss: 15226788.4351; val_kl_reg_loss: 19149.9469; val_edge_recon_loss: 2712591.0167; val_gene_expr_recon_loss: 11873256.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 634842.8708; val_global_loss: 15239840.3333; val_optim_loss: 15239840.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9660; val_auprc_score: 0.9582; val_best_acc_score: 0.9112; val_best_f1_score: 0.9137; train_kl_reg_loss: 64519.9285; train_edge_recon_loss: 2707756.8664; train_gene_expr_recon_loss: 11851915.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 637587.6842; train_global_loss: 15261779.6794; train_optim_loss: 15261779.6794; val_kl_reg_loss: 20037.3117; val_edge_recon_loss: 2716949.2500; val_gene_expr_recon_loss: 11925570.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 637895.3375; val_global_loss: 15300452.6667; val_optim_loss: 15300452.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9679; val_auprc_score: 0.9585; val_best_acc_score: 0.9163; val_best_f1_score: 0.9191; train_kl_reg_loss: 63522.5841; train_edge_recon_loss: 2706173.9046; train_gene_expr_recon_loss: 11845993.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 637028.9594; train_global_loss: 15252719.3664; train_optim_loss: 15252719.3664; val_kl_reg_loss: 20203.2064; val_edge_recon_loss: 2696759.8667; val_gene_expr_recon_loss: 11867424.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 632911.3792; val_global_loss: 15217298.8000; val_optim_loss: 15217298.8000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9682; val_auprc_score: 0.9569; val_best_acc_score: 0.9179; val_best_f1_score: 0.9204; train_kl_reg_loss: 61527.5349; train_edge_recon_loss: 2698650.8340; train_gene_expr_recon_loss: 11855987.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 637066.9323; train_global_loss: 15253232.3893; train_optim_loss: 15253232.3893; val_kl_reg_loss: 20094.4611; val_edge_recon_loss: 2704872.3333; val_gene_expr_recon_loss: 11921889.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 637921.4000; val_global_loss: 15284777.1333; val_optim_loss: 15284777.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9655
val AUPRC score: 0.9552
val best accuracy score: 0.9144
val best F1 score: 0.9169
val target rna MSE score: 0.9915
val source rna MSE score: 0.3138
val target atac MSE score: 0.5488
val source atac MSE score: 0.1432
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
