[True]
Run timestamp: 10082023_222937_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7548; val_auprc_score: 0.7803; val_best_acc_score: 0.5088; val_best_f1_score: 0.6703; train_kl_reg_loss: 105114.5318; train_edge_recon_loss: 3711757.6145; train_gene_expr_recon_loss: 44821888.7939; train_masked_gp_l1_reg_loss: 92378.7546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242723.1623; train_chrom_access_recon_loss: 16365766.3740; train_global_loss: 65339629.5267; train_optim_loss: 65339629.5267; val_kl_reg_loss: 191893.1323; val_edge_recon_loss: 4064799.2833; val_gene_expr_recon_loss: 38203749.0667; val_masked_gp_l1_reg_loss: 87669.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237135.8906; val_chrom_access_recon_loss: 15600576.4000; val_global_loss: 58385821.8667; val_optim_loss: 58385821.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8406; val_auprc_score: 0.8483; val_best_acc_score: 0.6929; val_best_f1_score: 0.7514; train_kl_reg_loss: 211242.9068; train_edge_recon_loss: 3614768.2958; train_gene_expr_recon_loss: 37575904.8244; train_masked_gp_l1_reg_loss: 82480.2996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230858.7747; train_chrom_access_recon_loss: 15435836.2748; train_global_loss: 57151091.3282; train_optim_loss: 57151091.3282; val_kl_reg_loss: 192609.3208; val_edge_recon_loss: 4053158.1333; val_gene_expr_recon_loss: 37037216.2667; val_masked_gp_l1_reg_loss: 79176.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224364.9844; val_chrom_access_recon_loss: 15341824.9333; val_global_loss: 56928348.5333; val_optim_loss: 56928348.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9021; val_auprc_score: 0.8927; val_best_acc_score: 0.7961; val_best_f1_score: 0.8250; train_kl_reg_loss: 183776.7966; train_edge_recon_loss: 3560693.2863; train_gene_expr_recon_loss: 36984179.4198; train_masked_gp_l1_reg_loss: 79243.4862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218017.9896; train_chrom_access_recon_loss: 15323993.2214; train_global_loss: 56349904.5191; train_optim_loss: 56349904.5191; val_kl_reg_loss: 170876.8427; val_edge_recon_loss: 3950141.9333; val_gene_expr_recon_loss: 36661171.7333; val_masked_gp_l1_reg_loss: 80275.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211649.0469; val_chrom_access_recon_loss: 15339132.2000; val_global_loss: 56413246.9333; val_optim_loss: 56413246.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9048; val_auprc_score: 0.8949; val_best_acc_score: 0.8199; val_best_f1_score: 0.8339; train_kl_reg_loss: 148676.9022; train_edge_recon_loss: 3433610.1469; train_gene_expr_recon_loss: 36644847.2672; train_masked_gp_l1_reg_loss: 81497.1985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205552.7762; train_chrom_access_recon_loss: 15216219.9084; train_global_loss: 55730404.0305; train_optim_loss: 55730404.0305; val_kl_reg_loss: 152971.3646; val_edge_recon_loss: 3160279.9500; val_gene_expr_recon_loss: 36361828.2667; val_masked_gp_l1_reg_loss: 83091.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199517.8125; val_chrom_access_recon_loss: 15155900.6000; val_global_loss: 55113587.7333; val_optim_loss: 55113587.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8929; val_auprc_score: 0.8773; val_best_acc_score: 0.8083; val_best_f1_score: 0.8267; train_kl_reg_loss: 181677.6923; train_edge_recon_loss: 3055363.4065; train_gene_expr_recon_loss: 36385983.7557; train_masked_gp_l1_reg_loss: 83934.1087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193959.2066; train_chrom_access_recon_loss: 15143537.2137; train_global_loss: 55044455.6947; train_optim_loss: 55044455.6947; val_kl_reg_loss: 189536.0760; val_edge_recon_loss: 3018835.1167; val_gene_expr_recon_loss: 36139049.8667; val_masked_gp_l1_reg_loss: 85019.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188503.1406; val_chrom_access_recon_loss: 15097792.7333; val_global_loss: 54718737.6000; val_optim_loss: 54718737.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9025; val_auprc_score: 0.8891; val_best_acc_score: 0.8149; val_best_f1_score: 0.8304; train_kl_reg_loss: 182650.0223; train_edge_recon_loss: 2979354.1851; train_gene_expr_recon_loss: 36105760.7939; train_masked_gp_l1_reg_loss: 85995.7961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183467.3187; train_chrom_access_recon_loss: 15051642.5802; train_global_loss: 54588870.4733; train_optim_loss: 54588870.4733; val_kl_reg_loss: 180273.9240; val_edge_recon_loss: 2994017.4833; val_gene_expr_recon_loss: 35919063.4667; val_masked_gp_l1_reg_loss: 87098.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178452.3906; val_chrom_access_recon_loss: 15042199.7333; val_global_loss: 54401105.6000; val_optim_loss: 54401105.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9229; val_auprc_score: 0.9105; val_best_acc_score: 0.8477; val_best_f1_score: 0.8574; train_kl_reg_loss: 176181.0518; train_edge_recon_loss: 2945564.9676; train_gene_expr_recon_loss: 35897009.1908; train_masked_gp_l1_reg_loss: 88486.5398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173712.5301; train_chrom_access_recon_loss: 14984058.1298; train_global_loss: 54265012.4580; train_optim_loss: 54265012.4580; val_kl_reg_loss: 169649.9427; val_edge_recon_loss: 2927315.3667; val_gene_expr_recon_loss: 35717902.9333; val_masked_gp_l1_reg_loss: 89987.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169018.7812; val_chrom_access_recon_loss: 14984296.0667; val_global_loss: 54058172.0000; val_optim_loss: 54058172.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9334; val_auprc_score: 0.9178; val_best_acc_score: 0.8682; val_best_f1_score: 0.8754; train_kl_reg_loss: 171035.8525; train_edge_recon_loss: 2908963.4733; train_gene_expr_recon_loss: 35729009.0992; train_masked_gp_l1_reg_loss: 90984.7804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164737.0138; train_chrom_access_recon_loss: 14933013.0305; train_global_loss: 53997743.2672; train_optim_loss: 53997743.2672; val_kl_reg_loss: 164428.2667; val_edge_recon_loss: 2893171.7167; val_gene_expr_recon_loss: 35548898.9333; val_masked_gp_l1_reg_loss: 92279.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160493.0938; val_chrom_access_recon_loss: 14921483.4667; val_global_loss: 53780754.9333; val_optim_loss: 53780754.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9385; val_auprc_score: 0.9266; val_best_acc_score: 0.8707; val_best_f1_score: 0.8786; train_kl_reg_loss: 168579.7022; train_edge_recon_loss: 2868470.3855; train_gene_expr_recon_loss: 35591213.3893; train_masked_gp_l1_reg_loss: 93327.5920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156584.7535; train_chrom_access_recon_loss: 14896262.5802; train_global_loss: 53774438.4427; train_optim_loss: 53774438.4427; val_kl_reg_loss: 167328.7781; val_edge_recon_loss: 2865039.7000; val_gene_expr_recon_loss: 35557022.1333; val_masked_gp_l1_reg_loss: 94699.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152711.5469; val_chrom_access_recon_loss: 15011899.2667; val_global_loss: 53848702.1333; val_optim_loss: 53848702.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9425; val_auprc_score: 0.9324; val_best_acc_score: 0.8760; val_best_f1_score: 0.8837; train_kl_reg_loss: 163125.1976; train_edge_recon_loss: 2859195.3168; train_gene_expr_recon_loss: 35390825.4351; train_masked_gp_l1_reg_loss: 95772.6806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149035.3337; train_chrom_access_recon_loss: 14814634.8092; train_global_loss: 53472588.7023; train_optim_loss: 53472588.7023; val_kl_reg_loss: 164725.0323; val_edge_recon_loss: 2852614.2833; val_gene_expr_recon_loss: 35191912.2667; val_masked_gp_l1_reg_loss: 97064.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145425.7500; val_chrom_access_recon_loss: 14797568.7333; val_global_loss: 53249307.7333; val_optim_loss: 53249307.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9525; val_auprc_score: 0.9444; val_best_acc_score: 0.8930; val_best_f1_score: 0.8973; train_kl_reg_loss: 160089.2917; train_edge_recon_loss: 2834201.4580; train_gene_expr_recon_loss: 35305950.7786; train_masked_gp_l1_reg_loss: 98075.5447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141960.6163; train_chrom_access_recon_loss: 14799889.7786; train_global_loss: 53340167.2061; train_optim_loss: 53340167.2061; val_kl_reg_loss: 157772.0240; val_edge_recon_loss: 2820463.4833; val_gene_expr_recon_loss: 35202196.0000; val_masked_gp_l1_reg_loss: 99338.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138586.3750; val_chrom_access_recon_loss: 14852588.2000; val_global_loss: 53270947.7333; val_optim_loss: 53270947.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9498; val_auprc_score: 0.9421; val_best_acc_score: 0.8855; val_best_f1_score: 0.8902; train_kl_reg_loss: 155273.4482; train_edge_recon_loss: 2821592.2023; train_gene_expr_recon_loss: 35165146.1374; train_masked_gp_l1_reg_loss: 100377.6188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135416.0105; train_chrom_access_recon_loss: 14753554.6412; train_global_loss: 53131359.7252; train_optim_loss: 53131359.7252; val_kl_reg_loss: 154017.1917; val_edge_recon_loss: 2842693.4167; val_gene_expr_recon_loss: 35176225.8667; val_masked_gp_l1_reg_loss: 101706.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132365.0625; val_chrom_access_recon_loss: 14851292.7333; val_global_loss: 53258301.3333; val_optim_loss: 53258301.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9576; val_auprc_score: 0.9496; val_best_acc_score: 0.8968; val_best_f1_score: 0.9005; train_kl_reg_loss: 151810.9448; train_edge_recon_loss: 2814780.0954; train_gene_expr_recon_loss: 35077369.2214; train_masked_gp_l1_reg_loss: 102626.5197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129487.5157; train_chrom_access_recon_loss: 14740553.1450; train_global_loss: 53016627.1145; train_optim_loss: 53016627.1145; val_kl_reg_loss: 149683.6854; val_edge_recon_loss: 2803926.9833; val_gene_expr_recon_loss: 34889070.4000; val_masked_gp_l1_reg_loss: 103811.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126759.0547; val_chrom_access_recon_loss: 14732491.1333; val_global_loss: 52805744.0000; val_optim_loss: 52805744.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9587; val_auprc_score: 0.9512; val_best_acc_score: 0.8957; val_best_f1_score: 0.9002; train_kl_reg_loss: 147945.8811; train_edge_recon_loss: 2805124.4847; train_gene_expr_recon_loss: 34966250.4275; train_masked_gp_l1_reg_loss: 104784.6575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124248.7756; train_chrom_access_recon_loss: 14698111.5420; train_global_loss: 52846465.5878; train_optim_loss: 52846465.5878; val_kl_reg_loss: 145337.5760; val_edge_recon_loss: 2833532.6667; val_gene_expr_recon_loss: 34889736.8000; val_masked_gp_l1_reg_loss: 105853.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121783.8047; val_chrom_access_recon_loss: 14773425.8667; val_global_loss: 52869669.0667; val_optim_loss: 52869669.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9602; val_auprc_score: 0.9493; val_best_acc_score: 0.9030; val_best_f1_score: 0.9078; train_kl_reg_loss: 144546.7122; train_edge_recon_loss: 2790668.1412; train_gene_expr_recon_loss: 34868366.0153; train_masked_gp_l1_reg_loss: 106865.6470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119467.9117; train_chrom_access_recon_loss: 14669691.8321; train_global_loss: 52699606.5344; train_optim_loss: 52699606.5344; val_kl_reg_loss: 143576.0969; val_edge_recon_loss: 2798671.2167; val_gene_expr_recon_loss: 34802836.2667; val_masked_gp_l1_reg_loss: 107889.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117116.4766; val_chrom_access_recon_loss: 14728156.2667; val_global_loss: 52698243.4667; val_optim_loss: 52698243.4667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9629; val_auprc_score: 0.9543; val_best_acc_score: 0.9045; val_best_f1_score: 0.9079; train_kl_reg_loss: 140870.7032; train_edge_recon_loss: 2788140.7004; train_gene_expr_recon_loss: 34785830.5496; train_masked_gp_l1_reg_loss: 108936.6908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114941.0914; train_chrom_access_recon_loss: 14651526.0076; train_global_loss: 52590245.8931; train_optim_loss: 52590245.8931; val_kl_reg_loss: 140957.9385; val_edge_recon_loss: 2786347.3667; val_gene_expr_recon_loss: 34713705.8667; val_masked_gp_l1_reg_loss: 110084.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112701.8672; val_chrom_access_recon_loss: 14730698.4000; val_global_loss: 52594493.3333; val_optim_loss: 52594493.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9621; val_auprc_score: 0.9538; val_best_acc_score: 0.9033; val_best_f1_score: 0.9069; train_kl_reg_loss: 138597.8653; train_edge_recon_loss: 2783683.4599; train_gene_expr_recon_loss: 34716975.1908; train_masked_gp_l1_reg_loss: 111122.2601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110637.9832; train_chrom_access_recon_loss: 14631944.4351; train_global_loss: 52492961.1298; train_optim_loss: 52492961.1298; val_kl_reg_loss: 139202.0052; val_edge_recon_loss: 2784816.2500; val_gene_expr_recon_loss: 34584692.9333; val_masked_gp_l1_reg_loss: 111903.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108549.0234; val_chrom_access_recon_loss: 14638196.4667; val_global_loss: 52367359.7333; val_optim_loss: 52367359.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9684; val_auprc_score: 0.9621; val_best_acc_score: 0.9124; val_best_f1_score: 0.9135; train_kl_reg_loss: 136616.1674; train_edge_recon_loss: 2770926.1317; train_gene_expr_recon_loss: 34686417.8626; train_masked_gp_l1_reg_loss: 113040.0544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106564.9282; train_chrom_access_recon_loss: 14639583.0000; train_global_loss: 52453148.0916; train_optim_loss: 52453148.0916; val_kl_reg_loss: 135242.0458; val_edge_recon_loss: 2781005.9333; val_gene_expr_recon_loss: 34487681.6000; val_masked_gp_l1_reg_loss: 114047.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104676.4766; val_chrom_access_recon_loss: 14606781.1333; val_global_loss: 52229434.4000; val_optim_loss: 52229434.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9710; val_auprc_score: 0.9642; val_best_acc_score: 0.9151; val_best_f1_score: 0.9174; train_kl_reg_loss: 133657.3060; train_edge_recon_loss: 2767192.9427; train_gene_expr_recon_loss: 34544902.6260; train_masked_gp_l1_reg_loss: 115130.3707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102826.9899; train_chrom_access_recon_loss: 14586631.7252; train_global_loss: 52250341.8626; train_optim_loss: 52250341.8626; val_kl_reg_loss: 132607.4266; val_edge_recon_loss: 2766137.3667; val_gene_expr_recon_loss: 34599814.4000; val_masked_gp_l1_reg_loss: 116200.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101048.4297; val_chrom_access_recon_loss: 14697218.6667; val_global_loss: 52413025.6000; val_optim_loss: 52413025.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9719; val_auprc_score: 0.9668; val_best_acc_score: 0.9196; val_best_f1_score: 0.9227; train_kl_reg_loss: 131324.9437; train_edge_recon_loss: 2769462.9447; train_gene_expr_recon_loss: 34483946.7939; train_masked_gp_l1_reg_loss: 117300.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99369.5985; train_chrom_access_recon_loss: 14585802.2366; train_global_loss: 52187207.1145; train_optim_loss: 52187207.1145; val_kl_reg_loss: 131913.4708; val_edge_recon_loss: 2768756.3333; val_gene_expr_recon_loss: 34446713.8667; val_masked_gp_l1_reg_loss: 118288.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97686.4375; val_chrom_access_recon_loss: 14631494.8667; val_global_loss: 52194853.8667; val_optim_loss: 52194853.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9727; val_auprc_score: 0.9685; val_best_acc_score: 0.9171; val_best_f1_score: 0.9206; train_kl_reg_loss: 130392.0250; train_edge_recon_loss: 2756768.9885; train_gene_expr_recon_loss: 34410989.3893; train_masked_gp_l1_reg_loss: 119316.7495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96096.0022; train_chrom_access_recon_loss: 14559192.2748; train_global_loss: 52072755.6031; train_optim_loss: 52072755.6031; val_kl_reg_loss: 129695.1333; val_edge_recon_loss: 2773444.2833; val_gene_expr_recon_loss: 34526981.0667; val_masked_gp_l1_reg_loss: 120166.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94534.8281; val_chrom_access_recon_loss: 14664645.0667; val_global_loss: 52309470.1333; val_optim_loss: 52309470.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9701; val_auprc_score: 0.9642; val_best_acc_score: 0.9171; val_best_f1_score: 0.9203; train_kl_reg_loss: 128743.6530; train_edge_recon_loss: 2758115.3950; train_gene_expr_recon_loss: 34339753.5115; train_masked_gp_l1_reg_loss: 121364.4602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93030.1991; train_chrom_access_recon_loss: 14540237.3664; train_global_loss: 51981244.6107; train_optim_loss: 51981244.6107; val_kl_reg_loss: 127363.4885; val_edge_recon_loss: 2776135.7833; val_gene_expr_recon_loss: 34334018.6667; val_masked_gp_l1_reg_loss: 122269.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91500.6797; val_chrom_access_recon_loss: 14562010.3333; val_global_loss: 52013296.8000; val_optim_loss: 52013296.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9758; val_auprc_score: 0.9711; val_best_acc_score: 0.9268; val_best_f1_score: 0.9292; train_kl_reg_loss: 126679.3327; train_edge_recon_loss: 2754070.6317; train_gene_expr_recon_loss: 34281498.2443; train_masked_gp_l1_reg_loss: 123443.3671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90137.9691; train_chrom_access_recon_loss: 14531661.0076; train_global_loss: 51907490.5344; train_optim_loss: 51907490.5344; val_kl_reg_loss: 126048.9937; val_edge_recon_loss: 2746660.4833; val_gene_expr_recon_loss: 34343902.2667; val_masked_gp_l1_reg_loss: 124405.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88803.4766; val_chrom_access_recon_loss: 14621840.9333; val_global_loss: 52051660.5333; val_optim_loss: 52051660.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9752; val_auprc_score: 0.9677; val_best_acc_score: 0.9220; val_best_f1_score: 0.9249; train_kl_reg_loss: 125828.1345; train_edge_recon_loss: 2743117.6966; train_gene_expr_recon_loss: 34268024.1985; train_masked_gp_l1_reg_loss: 125467.8399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87439.7143; train_chrom_access_recon_loss: 14550479.6794; train_global_loss: 51900356.9160; train_optim_loss: 51900356.9160; val_kl_reg_loss: 124801.4490; val_edge_recon_loss: 2766293.5167; val_gene_expr_recon_loss: 34283021.0667; val_masked_gp_l1_reg_loss: 126534.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86166.1484; val_chrom_access_recon_loss: 14602532.5333; val_global_loss: 51989353.0667; val_optim_loss: 51989353.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9707; val_best_acc_score: 0.9227; val_best_f1_score: 0.9253; train_kl_reg_loss: 123820.2759; train_edge_recon_loss: 2746671.6603; train_gene_expr_recon_loss: 34231965.5878; train_masked_gp_l1_reg_loss: 127565.6690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84979.5540; train_chrom_access_recon_loss: 14536167.8550; train_global_loss: 51851170.4427; train_optim_loss: 51851170.4427; val_kl_reg_loss: 122691.3807; val_edge_recon_loss: 2746021.0667; val_gene_expr_recon_loss: 34262027.4667; val_masked_gp_l1_reg_loss: 128635.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83737.5234; val_chrom_access_recon_loss: 14564295.3333; val_global_loss: 51907406.9333; val_optim_loss: 51907406.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9737; val_auprc_score: 0.9690; val_best_acc_score: 0.9206; val_best_f1_score: 0.9224; train_kl_reg_loss: 130504.6625; train_edge_recon_loss: 2809031.1851; train_gene_expr_recon_loss: 36014902.0611; train_masked_gp_l1_reg_loss: 128641.6007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85877.6269; train_chrom_access_recon_loss: 14750468.0382; train_global_loss: 53919425.0076; train_optim_loss: 53919425.0076; val_kl_reg_loss: 51142.6188; val_edge_recon_loss: 2818411.5333; val_gene_expr_recon_loss: 36165480.5333; val_masked_gp_l1_reg_loss: 130309.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88396.5469; val_chrom_access_recon_loss: 14718610.1333; val_global_loss: 53972348.8000; val_optim_loss: 53972348.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9705; val_auprc_score: 0.9642; val_best_acc_score: 0.9158; val_best_f1_score: 0.9192; train_kl_reg_loss: 140898.0651; train_edge_recon_loss: 2811273.0973; train_gene_expr_recon_loss: 36485201.2824; train_masked_gp_l1_reg_loss: 131946.1987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89485.8220; train_chrom_access_recon_loss: 14811924.3359; train_global_loss: 54470729.1908; train_optim_loss: 54470729.1908; val_kl_reg_loss: 42761.9802; val_edge_recon_loss: 2824872.4333; val_gene_expr_recon_loss: 36552626.6667; val_masked_gp_l1_reg_loss: 133242.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89750.9453; val_chrom_access_recon_loss: 14905403.4667; val_global_loss: 54548660.8000; val_optim_loss: 54548660.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9629; val_auprc_score: 0.9548; val_best_acc_score: 0.9015; val_best_f1_score: 0.9046; train_kl_reg_loss: 144182.5191; train_edge_recon_loss: 2845897.1126; train_gene_expr_recon_loss: 37226402.0763; train_masked_gp_l1_reg_loss: 134165.4784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89549.1658; train_chrom_access_recon_loss: 14914418.4427; train_global_loss: 55354614.9618; train_optim_loss: 55354614.9618; val_kl_reg_loss: 38300.9492; val_edge_recon_loss: 2840519.7667; val_gene_expr_recon_loss: 37672394.4000; val_masked_gp_l1_reg_loss: 134726.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89078.5312; val_chrom_access_recon_loss: 14942422.1333; val_global_loss: 55717445.3333; val_optim_loss: 55717445.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9564; val_auprc_score: 0.9486; val_best_acc_score: 0.8928; val_best_f1_score: 0.8983; train_kl_reg_loss: 121956.5905; train_edge_recon_loss: 2818605.7233; train_gene_expr_recon_loss: 37914321.5573; train_masked_gp_l1_reg_loss: 133962.6005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88023.6901; train_chrom_access_recon_loss: 14909091.4351; train_global_loss: 55985961.7710; train_optim_loss: 55985961.7710; val_kl_reg_loss: 39851.7216; val_edge_recon_loss: 2811337.1000; val_gene_expr_recon_loss: 37738788.2667; val_masked_gp_l1_reg_loss: 132775.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86196.2188; val_chrom_access_recon_loss: 14990853.6000; val_global_loss: 55799802.4000; val_optim_loss: 55799802.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9556; val_auprc_score: 0.9439; val_best_acc_score: 0.8932; val_best_f1_score: 0.8992; train_kl_reg_loss: 110510.6630; train_edge_recon_loss: 2800764.0496; train_gene_expr_recon_loss: 37800060.3359; train_masked_gp_l1_reg_loss: 132354.2829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85765.4705; train_chrom_access_recon_loss: 14901956.7557; train_global_loss: 55831411.5420; train_optim_loss: 55831411.5420; val_kl_reg_loss: 41838.7659; val_edge_recon_loss: 2784062.5667; val_gene_expr_recon_loss: 37655504.2667; val_masked_gp_l1_reg_loss: 132121.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85355.4844; val_chrom_access_recon_loss: 14896828.2000; val_global_loss: 55595709.0667; val_optim_loss: 55595709.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9564; val_auprc_score: 0.9472; val_best_acc_score: 0.8928; val_best_f1_score: 0.8983; train_kl_reg_loss: 107454.0385; train_edge_recon_loss: 2791373.3779; train_gene_expr_recon_loss: 37766284.1221; train_masked_gp_l1_reg_loss: 131914.1799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85005.5448; train_chrom_access_recon_loss: 14898632.6565; train_global_loss: 55780664.1527; train_optim_loss: 55780664.1527; val_kl_reg_loss: 42729.1409; val_edge_recon_loss: 2794610.1500; val_gene_expr_recon_loss: 37881698.4000; val_masked_gp_l1_reg_loss: 131698.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84668.5938; val_chrom_access_recon_loss: 15049216.0667; val_global_loss: 55984621.6000; val_optim_loss: 55984621.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9560; val_auprc_score: 0.9457; val_best_acc_score: 0.8938; val_best_f1_score: 0.9001; train_kl_reg_loss: 105347.7486; train_edge_recon_loss: 2789836.2328; train_gene_expr_recon_loss: 37741877.7710; train_masked_gp_l1_reg_loss: 131470.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84351.0602; train_chrom_access_recon_loss: 14897254.3740; train_global_loss: 55750138.0763; train_optim_loss: 55750138.0763; val_kl_reg_loss: 43654.9057; val_edge_recon_loss: 2804776.6000; val_gene_expr_recon_loss: 37621467.4667; val_masked_gp_l1_reg_loss: 131243.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84022.1094; val_chrom_access_recon_loss: 14938660.1333; val_global_loss: 55623828.0000; val_optim_loss: 55623828.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9557; val_auprc_score: 0.9400; val_best_acc_score: 0.8969; val_best_f1_score: 0.9029; train_kl_reg_loss: 102926.1896; train_edge_recon_loss: 2774883.8244; train_gene_expr_recon_loss: 37717968.2137; train_masked_gp_l1_reg_loss: 131008.5915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83707.0615; train_chrom_access_recon_loss: 14898373.0687; train_global_loss: 55708866.4122; train_optim_loss: 55708866.4122; val_kl_reg_loss: 44733.8362; val_edge_recon_loss: 2778625.5500; val_gene_expr_recon_loss: 37481341.6000; val_masked_gp_l1_reg_loss: 130757.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83382.7812; val_chrom_access_recon_loss: 14908400.2667; val_global_loss: 55427241.8667; val_optim_loss: 55427241.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 25 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9747
val AUPRC score: 0.9690
val best accuracy score: 0.9258
val best F1 score: 0.9277
val target rna MSE score: 1.0058
val source rna MSE score: 71.4324
val target atac MSE score: 0.3528
val source atac MSE score: 2.6872
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
