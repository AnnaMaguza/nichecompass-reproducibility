[True]
Run timestamp: 06092023_235407_213.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_213']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1131 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5649, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7584; val_auprc_score: 0.7778; val_best_acc_score: 0.5674; val_best_f1_score: 0.6915; train_kl_reg_loss: 78516.7003; train_edge_recon_loss: 3561022.5153; train_gene_expr_recon_loss: 17153447.4275; train_masked_gp_l1_reg_loss: 48794.8732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5730577.0952; train_chrom_access_recon_loss: 3979892.8702; train_global_loss: 30552251.5267; train_optim_loss: 30552251.5267; val_kl_reg_loss: 120965.1172; val_edge_recon_loss: 4061136.5667; val_gene_expr_recon_loss: 15848197.4000; val_masked_gp_l1_reg_loss: 44425.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 492142.9062; val_chrom_access_recon_loss: 3851776.5000; val_global_loss: 24418643.3333; val_optim_loss: 24418643.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7956; val_auprc_score: 0.8050; val_best_acc_score: 0.7103; val_best_f1_score: 0.7162; train_kl_reg_loss: 107719.4322; train_edge_recon_loss: 3523772.5210; train_gene_expr_recon_loss: 15625817.0763; train_masked_gp_l1_reg_loss: 43138.6606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 287726.4699; train_chrom_access_recon_loss: 3811559.5344; train_global_loss: 23399733.7252; train_optim_loss: 23399733.7252; val_kl_reg_loss: 111946.0719; val_edge_recon_loss: 4026285.6667; val_gene_expr_recon_loss: 15526191.4667; val_masked_gp_l1_reg_loss: 43209.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199087.5312; val_chrom_access_recon_loss: 3759995.6667; val_global_loss: 23666717.0667; val_optim_loss: 23666717.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8312; val_auprc_score: 0.8402; val_best_acc_score: 0.7354; val_best_f1_score: 0.7539; train_kl_reg_loss: 83454.3366; train_edge_recon_loss: 3414508.4733; train_gene_expr_recon_loss: 15378493.3740; train_masked_gp_l1_reg_loss: 44942.8335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172130.4484; train_chrom_access_recon_loss: 3756302.9046; train_global_loss: 22849832.5038; train_optim_loss: 22849832.5038; val_kl_reg_loss: 90403.0682; val_edge_recon_loss: 3240186.5167; val_gene_expr_recon_loss: 15316686.9333; val_masked_gp_l1_reg_loss: 47259.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155228.4062; val_chrom_access_recon_loss: 3726985.8500; val_global_loss: 22576749.8667; val_optim_loss: 22576749.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8389; val_auprc_score: 0.8427; val_best_acc_score: 0.7428; val_best_f1_score: 0.7637; train_kl_reg_loss: 103494.3253; train_edge_recon_loss: 3109110.5840; train_gene_expr_recon_loss: 15217737.5191; train_masked_gp_l1_reg_loss: 49243.8177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145711.8792; train_chrom_access_recon_loss: 3717103.6279; train_global_loss: 22342401.8321; train_optim_loss: 22342401.8321; val_kl_reg_loss: 110959.7854; val_edge_recon_loss: 3088196.1167; val_gene_expr_recon_loss: 15153735.3333; val_masked_gp_l1_reg_loss: 50997.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138658.1406; val_chrom_access_recon_loss: 3689142.5333; val_global_loss: 22231689.8667; val_optim_loss: 22231689.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8701; val_auprc_score: 0.8701; val_best_acc_score: 0.7794; val_best_f1_score: 0.7854; train_kl_reg_loss: 104552.9919; train_edge_recon_loss: 3033191.7252; train_gene_expr_recon_loss: 15055534.3130; train_masked_gp_l1_reg_loss: 52527.2801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134276.2569; train_chrom_access_recon_loss: 3675930.4504; train_global_loss: 22056013.0076; train_optim_loss: 22056013.0076; val_kl_reg_loss: 104150.8073; val_edge_recon_loss: 3022583.0833; val_gene_expr_recon_loss: 14972458.2667; val_masked_gp_l1_reg_loss: 54058.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132187.6875; val_chrom_access_recon_loss: 3655097.6000; val_global_loss: 21940535.7333; val_optim_loss: 21940535.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9078; val_auprc_score: 0.9002; val_best_acc_score: 0.8314; val_best_f1_score: 0.8364; train_kl_reg_loss: 102089.0873; train_edge_recon_loss: 2938279.0229; train_gene_expr_recon_loss: 14922804.0992; train_masked_gp_l1_reg_loss: 55448.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129610.5416; train_chrom_access_recon_loss: 3642017.7920; train_global_loss: 21790249.0687; train_optim_loss: 21790249.0687; val_kl_reg_loss: 105407.7130; val_edge_recon_loss: 2912100.6333; val_gene_expr_recon_loss: 14921389.4000; val_masked_gp_l1_reg_loss: 57054.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128492.2188; val_chrom_access_recon_loss: 3621971.9333; val_global_loss: 21746415.7333; val_optim_loss: 21746415.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9244; val_auprc_score: 0.9116; val_best_acc_score: 0.8531; val_best_f1_score: 0.8620; train_kl_reg_loss: 106538.4631; train_edge_recon_loss: 2844987.4905; train_gene_expr_recon_loss: 14803650.9771; train_masked_gp_l1_reg_loss: 58231.1253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127872.3628; train_chrom_access_recon_loss: 3612425.4065; train_global_loss: 21553705.8321; train_optim_loss: 21553705.8321; val_kl_reg_loss: 104788.5109; val_edge_recon_loss: 2851263.9000; val_gene_expr_recon_loss: 14773651.1333; val_masked_gp_l1_reg_loss: 59377.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127700.4297; val_chrom_access_recon_loss: 3585980.0667; val_global_loss: 21502761.3333; val_optim_loss: 21502761.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9326; val_auprc_score: 0.9198; val_best_acc_score: 0.8674; val_best_f1_score: 0.8739; train_kl_reg_loss: 104989.6808; train_edge_recon_loss: 2812373.6145; train_gene_expr_recon_loss: 14692839.4427; train_masked_gp_l1_reg_loss: 60524.8113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127405.0276; train_chrom_access_recon_loss: 3586604.6393; train_global_loss: 21384737.4351; train_optim_loss: 21384737.4351; val_kl_reg_loss: 105985.9958; val_edge_recon_loss: 2827800.1000; val_gene_expr_recon_loss: 14716527.6000; val_masked_gp_l1_reg_loss: 61491.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128103.3594; val_chrom_access_recon_loss: 3574980.8833; val_global_loss: 21414890.5333; val_optim_loss: 21414890.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9380; val_auprc_score: 0.9258; val_best_acc_score: 0.8779; val_best_f1_score: 0.8837; train_kl_reg_loss: 103450.9818; train_edge_recon_loss: 2801926.7653; train_gene_expr_recon_loss: 14592237.7939; train_masked_gp_l1_reg_loss: 62395.3321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127773.4166; train_chrom_access_recon_loss: 3557373.1202; train_global_loss: 21245157.5420; train_optim_loss: 21245157.5420; val_kl_reg_loss: 101209.7594; val_edge_recon_loss: 2802303.3333; val_gene_expr_recon_loss: 14612833.3333; val_masked_gp_l1_reg_loss: 63329.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128685.1484; val_chrom_access_recon_loss: 3553778.1833; val_global_loss: 21262140.5333; val_optim_loss: 21262140.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9402; val_auprc_score: 0.9265; val_best_acc_score: 0.8798; val_best_f1_score: 0.8860; train_kl_reg_loss: 100908.8539; train_edge_recon_loss: 2799112.2653; train_gene_expr_recon_loss: 14519217.1603; train_masked_gp_l1_reg_loss: 64063.8520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127703.8431; train_chrom_access_recon_loss: 3541410.0496; train_global_loss: 21152416.1832; train_optim_loss: 21152416.1832; val_kl_reg_loss: 100703.7146; val_edge_recon_loss: 2786727.8167; val_gene_expr_recon_loss: 14570281.5333; val_masked_gp_l1_reg_loss: 64827.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127312.9688; val_chrom_access_recon_loss: 3528584.6333; val_global_loss: 21178437.7333; val_optim_loss: 21178437.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9378; val_auprc_score: 0.9231; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 98160.8731; train_edge_recon_loss: 2788699.9981; train_gene_expr_recon_loss: 14434382.6794; train_masked_gp_l1_reg_loss: 65551.0820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127333.7544; train_chrom_access_recon_loss: 3520769.7920; train_global_loss: 21034898.1527; train_optim_loss: 21034898.1527; val_kl_reg_loss: 96810.6094; val_edge_recon_loss: 2804058.5333; val_gene_expr_recon_loss: 14378637.0000; val_masked_gp_l1_reg_loss: 66272.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126999.3594; val_chrom_access_recon_loss: 3500981.2167; val_global_loss: 20973759.4667; val_optim_loss: 20973759.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9442; val_auprc_score: 0.9297; val_best_acc_score: 0.8859; val_best_f1_score: 0.8913; train_kl_reg_loss: 99271.6373; train_edge_recon_loss: 2778385.8187; train_gene_expr_recon_loss: 14364098.0763; train_masked_gp_l1_reg_loss: 66838.3811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126700.2369; train_chrom_access_recon_loss: 3503844.1927; train_global_loss: 20939138.3511; train_optim_loss: 20939138.3511; val_kl_reg_loss: 100217.4156; val_edge_recon_loss: 2772452.7000; val_gene_expr_recon_loss: 14409643.6667; val_masked_gp_l1_reg_loss: 67445.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126367.7031; val_chrom_access_recon_loss: 3506805.5333; val_global_loss: 20982933.3333; val_optim_loss: 20982933.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9450; val_auprc_score: 0.9317; val_best_acc_score: 0.8848; val_best_f1_score: 0.8909; train_kl_reg_loss: 96112.9174; train_edge_recon_loss: 2771211.2347; train_gene_expr_recon_loss: 14309593.3359; train_masked_gp_l1_reg_loss: 67978.5592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126462.1002; train_chrom_access_recon_loss: 3486307.6412; train_global_loss: 20857665.7710; train_optim_loss: 20857665.7710; val_kl_reg_loss: 94237.9130; val_edge_recon_loss: 2781667.5000; val_gene_expr_recon_loss: 14361437.6667; val_masked_gp_l1_reg_loss: 68466.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126153.8203; val_chrom_access_recon_loss: 3496067.9167; val_global_loss: 20928031.7333; val_optim_loss: 20928031.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9494; val_auprc_score: 0.9369; val_best_acc_score: 0.8868; val_best_f1_score: 0.8916; train_kl_reg_loss: 92878.6177; train_edge_recon_loss: 2763265.3683; train_gene_expr_recon_loss: 14258704.6947; train_masked_gp_l1_reg_loss: 69059.0873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126251.6117; train_chrom_access_recon_loss: 3473720.4695; train_global_loss: 20783879.8321; train_optim_loss: 20783879.8321; val_kl_reg_loss: 94424.3359; val_edge_recon_loss: 2780498.5333; val_gene_expr_recon_loss: 14274235.8000; val_masked_gp_l1_reg_loss: 69660.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126393.7969; val_chrom_access_recon_loss: 3465712.8667; val_global_loss: 20810925.6000; val_optim_loss: 20810925.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9487; val_auprc_score: 0.9367; val_best_acc_score: 0.8897; val_best_f1_score: 0.8943; train_kl_reg_loss: 94427.3986; train_edge_recon_loss: 2759161.2538; train_gene_expr_recon_loss: 14203820.4962; train_masked_gp_l1_reg_loss: 70107.0940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126046.7326; train_chrom_access_recon_loss: 3459080.1221; train_global_loss: 20712643.1603; train_optim_loss: 20712643.1603; val_kl_reg_loss: 95351.5646; val_edge_recon_loss: 2754057.1000; val_gene_expr_recon_loss: 14224605.6000; val_masked_gp_l1_reg_loss: 70566.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125541.0156; val_chrom_access_recon_loss: 3456982.9000; val_global_loss: 20727105.3333; val_optim_loss: 20727105.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9501; val_auprc_score: 0.9382; val_best_acc_score: 0.8894; val_best_f1_score: 0.8933; train_kl_reg_loss: 92530.9549; train_edge_recon_loss: 2750668.6546; train_gene_expr_recon_loss: 14157532.6947; train_masked_gp_l1_reg_loss: 71065.0370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125862.3414; train_chrom_access_recon_loss: 3449143.6355; train_global_loss: 20646803.3282; train_optim_loss: 20646803.3282; val_kl_reg_loss: 94167.0823; val_edge_recon_loss: 2778261.8667; val_gene_expr_recon_loss: 14222153.2000; val_masked_gp_l1_reg_loss: 71622.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125470.3984; val_chrom_access_recon_loss: 3455479.4333; val_global_loss: 20747153.7333; val_optim_loss: 20747153.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9519; val_auprc_score: 0.9376; val_best_acc_score: 0.8948; val_best_f1_score: 0.8995; train_kl_reg_loss: 92027.5777; train_edge_recon_loss: 2741082.5782; train_gene_expr_recon_loss: 14115322.0916; train_masked_gp_l1_reg_loss: 71993.3404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125810.2999; train_chrom_access_recon_loss: 3436699.4008; train_global_loss: 20582935.4046; train_optim_loss: 20582935.4046; val_kl_reg_loss: 89086.2063; val_edge_recon_loss: 2760331.7000; val_gene_expr_recon_loss: 14157041.5333; val_masked_gp_l1_reg_loss: 72357.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126176.2344; val_chrom_access_recon_loss: 3429574.2833; val_global_loss: 20634567.0667; val_optim_loss: 20634567.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9559; val_auprc_score: 0.9452; val_best_acc_score: 0.8994; val_best_f1_score: 0.9042; train_kl_reg_loss: 91553.5379; train_edge_recon_loss: 2736862.8588; train_gene_expr_recon_loss: 14077187.2824; train_masked_gp_l1_reg_loss: 72758.1478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125862.0869; train_chrom_access_recon_loss: 3425251.0878; train_global_loss: 20529474.9313; train_optim_loss: 20529474.9313; val_kl_reg_loss: 92583.3750; val_edge_recon_loss: 2725605.8500; val_gene_expr_recon_loss: 14110038.8667; val_masked_gp_l1_reg_loss: 73155.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125982.7422; val_chrom_access_recon_loss: 3429698.6000; val_global_loss: 20557064.5333; val_optim_loss: 20557064.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9553; val_auprc_score: 0.9442; val_best_acc_score: 0.9014; val_best_f1_score: 0.9040; train_kl_reg_loss: 89382.1049; train_edge_recon_loss: 2737708.7176; train_gene_expr_recon_loss: 14048583.3893; train_masked_gp_l1_reg_loss: 73495.5599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126370.6346; train_chrom_access_recon_loss: 3419409.6450; train_global_loss: 20494950.1069; train_optim_loss: 20494950.1069; val_kl_reg_loss: 89300.0109; val_edge_recon_loss: 2758042.5833; val_gene_expr_recon_loss: 14072962.9333; val_masked_gp_l1_reg_loss: 73973.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127396.7344; val_chrom_access_recon_loss: 3425118.7667; val_global_loss: 20546794.6667; val_optim_loss: 20546794.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9579; val_auprc_score: 0.9457; val_best_acc_score: 0.9010; val_best_f1_score: 0.9058; train_kl_reg_loss: 88743.1053; train_edge_recon_loss: 2741118.8550; train_gene_expr_recon_loss: 14003473.8092; train_masked_gp_l1_reg_loss: 74298.2331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127656.5530; train_chrom_access_recon_loss: 3408698.1107; train_global_loss: 20443988.7328; train_optim_loss: 20443988.7328; val_kl_reg_loss: 89179.0307; val_edge_recon_loss: 2732393.5833; val_gene_expr_recon_loss: 14039501.8000; val_masked_gp_l1_reg_loss: 74735.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128721.3125; val_chrom_access_recon_loss: 3406399.0333; val_global_loss: 20470931.0667; val_optim_loss: 20470931.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9621; val_auprc_score: 0.9480; val_best_acc_score: 0.9069; val_best_f1_score: 0.9108; train_kl_reg_loss: 89303.6344; train_edge_recon_loss: 2730273.8798; train_gene_expr_recon_loss: 13969721.3359; train_masked_gp_l1_reg_loss: 74967.1685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128867.6684; train_chrom_access_recon_loss: 3399971.2462; train_global_loss: 20393104.9771; train_optim_loss: 20393104.9771; val_kl_reg_loss: 88420.3125; val_edge_recon_loss: 2725372.0167; val_gene_expr_recon_loss: 13984197.2667; val_masked_gp_l1_reg_loss: 75259.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129234.6328; val_chrom_access_recon_loss: 3390209.6333; val_global_loss: 20392694.0000; val_optim_loss: 20392694.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9572; val_auprc_score: 0.9476; val_best_acc_score: 0.8984; val_best_f1_score: 0.9035; train_kl_reg_loss: 89408.2977; train_edge_recon_loss: 2717528.2576; train_gene_expr_recon_loss: 13937646.2595; train_masked_gp_l1_reg_loss: 75586.1187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129922.1808; train_chrom_access_recon_loss: 3391524.6775; train_global_loss: 20341615.7710; train_optim_loss: 20341615.7710; val_kl_reg_loss: 91576.9568; val_edge_recon_loss: 2749241.0833; val_gene_expr_recon_loss: 14015534.9333; val_masked_gp_l1_reg_loss: 75803.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130561.8281; val_chrom_access_recon_loss: 3396235.7833; val_global_loss: 20458954.9333; val_optim_loss: 20458954.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9621; val_auprc_score: 0.9508; val_best_acc_score: 0.9081; val_best_f1_score: 0.9115; train_kl_reg_loss: 88036.1674; train_edge_recon_loss: 2722862.7748; train_gene_expr_recon_loss: 13912195.0763; train_masked_gp_l1_reg_loss: 76088.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130435.0423; train_chrom_access_recon_loss: 3386930.2996; train_global_loss: 20316547.4962; train_optim_loss: 20316547.4962; val_kl_reg_loss: 89134.6021; val_edge_recon_loss: 2731298.9667; val_gene_expr_recon_loss: 13978784.6667; val_masked_gp_l1_reg_loss: 76394.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130902.8906; val_chrom_access_recon_loss: 3409793.4667; val_global_loss: 20416308.1333; val_optim_loss: 20416308.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9659; val_auprc_score: 0.9578; val_best_acc_score: 0.9109; val_best_f1_score: 0.9139; train_kl_reg_loss: 87536.7387; train_edge_recon_loss: 2711813.1412; train_gene_expr_recon_loss: 13897098.4885; train_masked_gp_l1_reg_loss: 76698.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130780.0609; train_chrom_access_recon_loss: 3381998.3798; train_global_loss: 20285925.6641; train_optim_loss: 20285925.6641; val_kl_reg_loss: 89962.2911; val_edge_recon_loss: 2717328.5500; val_gene_expr_recon_loss: 13983169.6667; val_masked_gp_l1_reg_loss: 76925.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130297.1797; val_chrom_access_recon_loss: 3388138.9667; val_global_loss: 20385823.2000; val_optim_loss: 20385823.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9634; val_auprc_score: 0.9551; val_best_acc_score: 0.9100; val_best_f1_score: 0.9137; train_kl_reg_loss: 87518.8108; train_edge_recon_loss: 2713242.6069; train_gene_expr_recon_loss: 13869843.9389; train_masked_gp_l1_reg_loss: 77218.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131085.9793; train_chrom_access_recon_loss: 3376076.8321; train_global_loss: 20254986.3817; train_optim_loss: 20254986.3817; val_kl_reg_loss: 87302.3047; val_edge_recon_loss: 2725409.3667; val_gene_expr_recon_loss: 13912331.3333; val_masked_gp_l1_reg_loss: 77498.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130317.4766; val_chrom_access_recon_loss: 3372634.4833; val_global_loss: 20305493.4667; val_optim_loss: 20305493.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9660; val_auprc_score: 0.9569; val_best_acc_score: 0.9161; val_best_f1_score: 0.9190; train_kl_reg_loss: 112480.8216; train_edge_recon_loss: 2791596.5649; train_gene_expr_recon_loss: 12605006.6794; train_masked_gp_l1_reg_loss: 75284.4620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129384.4837; train_chrom_access_recon_loss: 3039085.2080; train_global_loss: 18752838.1985; train_optim_loss: 18752838.1985; val_kl_reg_loss: 36651.8427; val_edge_recon_loss: 2758050.1333; val_gene_expr_recon_loss: 12405843.9333; val_masked_gp_l1_reg_loss: 74022.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133004.4219; val_chrom_access_recon_loss: 2944191.5833; val_global_loss: 18351763.6000; val_optim_loss: 18351763.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9654; val_auprc_score: 0.9557; val_best_acc_score: 0.9185; val_best_f1_score: 0.9208; train_kl_reg_loss: 102995.7869; train_edge_recon_loss: 2755670.2099; train_gene_expr_recon_loss: 12176016.2977; train_masked_gp_l1_reg_loss: 72999.4136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133879.2165; train_chrom_access_recon_loss: 2888879.7309; train_global_loss: 18130440.5649; train_optim_loss: 18130440.5649; val_kl_reg_loss: 36178.5198; val_edge_recon_loss: 2769737.0333; val_gene_expr_recon_loss: 11899594.3333; val_masked_gp_l1_reg_loss: 72012.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135235.2188; val_chrom_access_recon_loss: 2804305.4500; val_global_loss: 17717062.2667; val_optim_loss: 17717062.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9651; val_auprc_score: 0.9560; val_best_acc_score: 0.9128; val_best_f1_score: 0.9164; train_kl_reg_loss: 92032.6751; train_edge_recon_loss: 2748356.7042; train_gene_expr_recon_loss: 11690637.3053; train_masked_gp_l1_reg_loss: 70810.9367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135421.1603; train_chrom_access_recon_loss: 2766461.9313; train_global_loss: 17503720.6260; train_optim_loss: 17503720.6260; val_kl_reg_loss: 39708.8036; val_edge_recon_loss: 2757337.6833; val_gene_expr_recon_loss: 11468110.6667; val_masked_gp_l1_reg_loss: 69621.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134316.7344; val_chrom_access_recon_loss: 2705675.8333; val_global_loss: 17174772.0667; val_optim_loss: 17174772.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9613; val_auprc_score: 0.9487; val_best_acc_score: 0.9134; val_best_f1_score: 0.9164; train_kl_reg_loss: 86354.8591; train_edge_recon_loss: 2750913.2156; train_gene_expr_recon_loss: 11110898.3282; train_masked_gp_l1_reg_loss: 68260.4134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134491.1305; train_chrom_access_recon_loss: 2644300.5496; train_global_loss: 16795218.4885; train_optim_loss: 16795218.4885; val_kl_reg_loss: 36373.6565; val_edge_recon_loss: 2757697.7833; val_gene_expr_recon_loss: 10867445.4000; val_masked_gp_l1_reg_loss: 66780.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135136.8750; val_chrom_access_recon_loss: 2590516.8833; val_global_loss: 16453950.6667; val_optim_loss: 16453950.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9596; val_auprc_score: 0.9454; val_best_acc_score: 0.9050; val_best_f1_score: 0.9092; train_kl_reg_loss: 80357.3282; train_edge_recon_loss: 2736988.9847; train_gene_expr_recon_loss: 10578990.0000; train_masked_gp_l1_reg_loss: 65121.3673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133603.4814; train_chrom_access_recon_loss: 2510197.8206; train_global_loss: 16105258.9542; train_optim_loss: 16105258.9542; val_kl_reg_loss: 41037.3891; val_edge_recon_loss: 2747561.9833; val_gene_expr_recon_loss: 10501768.6000; val_masked_gp_l1_reg_loss: 63387.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132262.7031; val_chrom_access_recon_loss: 2478361.8500; val_global_loss: 15964379.8000; val_optim_loss: 15964379.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9625; val_auprc_score: 0.9529; val_best_acc_score: 0.9124; val_best_f1_score: 0.9169; train_kl_reg_loss: 77825.7349; train_edge_recon_loss: 2731213.5115; train_gene_expr_recon_loss: 10442434.5115; train_masked_gp_l1_reg_loss: 61727.1693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132296.3907; train_chrom_access_recon_loss: 2467459.7767; train_global_loss: 15912957.1069; train_optim_loss: 15912957.1069; val_kl_reg_loss: 43603.0354; val_edge_recon_loss: 2731548.1167; val_gene_expr_recon_loss: 10468109.6000; val_masked_gp_l1_reg_loss: 60083.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131315.0625; val_chrom_access_recon_loss: 2465742.4833; val_global_loss: 15900402.2667; val_optim_loss: 15900402.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9627; val_auprc_score: 0.9473; val_best_acc_score: 0.9163; val_best_f1_score: 0.9192; train_kl_reg_loss: 71991.5551; train_edge_recon_loss: 2720074.4218; train_gene_expr_recon_loss: 10352502.2595; train_masked_gp_l1_reg_loss: 58460.7599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130918.6233; train_chrom_access_recon_loss: 2450808.6107; train_global_loss: 15784756.3282; train_optim_loss: 15784756.3282; val_kl_reg_loss: 49429.2021; val_edge_recon_loss: 2709271.4333; val_gene_expr_recon_loss: 10298869.0667; val_masked_gp_l1_reg_loss: 56829.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130101.5938; val_chrom_access_recon_loss: 2440464.0167; val_global_loss: 15684965.9333; val_optim_loss: 15684965.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9642; val_auprc_score: 0.9517; val_best_acc_score: 0.9175; val_best_f1_score: 0.9201; train_kl_reg_loss: 69785.6387; train_edge_recon_loss: 2710971.6679; train_gene_expr_recon_loss: 10267640.6870; train_masked_gp_l1_reg_loss: 55352.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129170.6920; train_chrom_access_recon_loss: 2436478.8473; train_global_loss: 15669399.7023; train_optim_loss: 15669399.7023; val_kl_reg_loss: 51808.7141; val_edge_recon_loss: 2702101.5833; val_gene_expr_recon_loss: 10278178.3333; val_masked_gp_l1_reg_loss: 53896.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128412.9766; val_chrom_access_recon_loss: 2435924.2000; val_global_loss: 15650322.8667; val_optim_loss: 15650322.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9659; val_auprc_score: 0.9548; val_best_acc_score: 0.9165; val_best_f1_score: 0.9194; train_kl_reg_loss: 67254.2276; train_edge_recon_loss: 2702966.0172; train_gene_expr_recon_loss: 10209878.0229; train_masked_gp_l1_reg_loss: 52580.7303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127926.7496; train_chrom_access_recon_loss: 2418916.2615; train_global_loss: 15579522.0076; train_optim_loss: 15579522.0076; val_kl_reg_loss: 51762.7331; val_edge_recon_loss: 2704527.7167; val_gene_expr_recon_loss: 10213598.7333; val_masked_gp_l1_reg_loss: 51234.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127704.5469; val_chrom_access_recon_loss: 2410165.3000; val_global_loss: 15558994.5333; val_optim_loss: 15558994.5333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9644; val_auprc_score: 0.9524; val_best_acc_score: 0.9157; val_best_f1_score: 0.9188; train_kl_reg_loss: 65352.8004; train_edge_recon_loss: 2702207.3817; train_gene_expr_recon_loss: 10160600.1298; train_masked_gp_l1_reg_loss: 50032.8119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127182.3868; train_chrom_access_recon_loss: 2408460.6718; train_global_loss: 15513836.2061; train_optim_loss: 15513836.2061; val_kl_reg_loss: 55332.3258; val_edge_recon_loss: 2713019.4500; val_gene_expr_recon_loss: 10172626.8667; val_masked_gp_l1_reg_loss: 48801.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126329.1641; val_chrom_access_recon_loss: 2403754.1167; val_global_loss: 15519863.8667; val_optim_loss: 15519863.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9634; val_auprc_score: 0.9467; val_best_acc_score: 0.9179; val_best_f1_score: 0.9207; train_kl_reg_loss: 64086.8095; train_edge_recon_loss: 2698947.8931; train_gene_expr_recon_loss: 9894048.7023; train_masked_gp_l1_reg_loss: 47679.1105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126524.9084; train_chrom_access_recon_loss: 2358951.8483; train_global_loss: 15190239.3359; train_optim_loss: 15190239.3359; val_kl_reg_loss: 53781.1484; val_edge_recon_loss: 2713347.2000; val_gene_expr_recon_loss: 9872983.6000; val_masked_gp_l1_reg_loss: 46522.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127076.2812; val_chrom_access_recon_loss: 2342791.7000; val_global_loss: 15156502.7333; val_optim_loss: 15156502.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9693; val_auprc_score: 0.9594; val_best_acc_score: 0.9212; val_best_f1_score: 0.9247; train_kl_reg_loss: 64284.3122; train_edge_recon_loss: 2698466.1031; train_gene_expr_recon_loss: 9793475.3817; train_masked_gp_l1_reg_loss: 45374.7845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126432.5461; train_chrom_access_recon_loss: 2340849.8330; train_global_loss: 15068882.9313; train_optim_loss: 15068882.9313; val_kl_reg_loss: 58307.3464; val_edge_recon_loss: 2686166.5333; val_gene_expr_recon_loss: 9813576.2667; val_masked_gp_l1_reg_loss: 44259.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126437.9453; val_chrom_access_recon_loss: 2337887.8500; val_global_loss: 15066634.9333; val_optim_loss: 15066634.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9686; val_auprc_score: 0.9546; val_best_acc_score: 0.9231; val_best_f1_score: 0.9257; train_kl_reg_loss: 62627.2563; train_edge_recon_loss: 2696654.0458; train_gene_expr_recon_loss: 9776032.6031; train_masked_gp_l1_reg_loss: 43210.4130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126522.3934; train_chrom_access_recon_loss: 2336995.0134; train_global_loss: 15042041.7557; train_optim_loss: 15042041.7557; val_kl_reg_loss: 58845.5531; val_edge_recon_loss: 2681258.1333; val_gene_expr_recon_loss: 9800985.0000; val_masked_gp_l1_reg_loss: 42193.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126024.3516; val_chrom_access_recon_loss: 2341021.3167; val_global_loss: 15050328.1333; val_optim_loss: 15050328.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9666; val_auprc_score: 0.9535; val_best_acc_score: 0.9184; val_best_f1_score: 0.9214; train_kl_reg_loss: 62357.5844; train_edge_recon_loss: 2702391.2786; train_gene_expr_recon_loss: 9761897.7786; train_masked_gp_l1_reg_loss: 41283.3947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126446.5554; train_chrom_access_recon_loss: 2335271.5344; train_global_loss: 15029648.1756; train_optim_loss: 15029648.1756; val_kl_reg_loss: 56160.9794; val_edge_recon_loss: 2721740.3667; val_gene_expr_recon_loss: 9798735.5333; val_masked_gp_l1_reg_loss: 40414.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126609.8203; val_chrom_access_recon_loss: 2332005.4333; val_global_loss: 15075667.2667; val_optim_loss: 15075667.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9689; val_auprc_score: 0.9591; val_best_acc_score: 0.9204; val_best_f1_score: 0.9239; train_kl_reg_loss: 61208.2249; train_edge_recon_loss: 2695216.3836; train_gene_expr_recon_loss: 9763323.6183; train_masked_gp_l1_reg_loss: 39631.6811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126376.6750; train_chrom_access_recon_loss: 2333868.1994; train_global_loss: 15019624.7786; train_optim_loss: 15019624.7786; val_kl_reg_loss: 58138.0263; val_edge_recon_loss: 2704791.6667; val_gene_expr_recon_loss: 9769710.5333; val_masked_gp_l1_reg_loss: 38858.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127095.6484; val_chrom_access_recon_loss: 2329644.4500; val_global_loss: 15028239.6000; val_optim_loss: 15028239.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9685; val_auprc_score: 0.9553; val_best_acc_score: 0.9205; val_best_f1_score: 0.9224; train_kl_reg_loss: 61558.9182; train_edge_recon_loss: 2684824.4828; train_gene_expr_recon_loss: 9742472.5115; train_masked_gp_l1_reg_loss: 38191.7722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126586.1043; train_chrom_access_recon_loss: 2327779.7977; train_global_loss: 14981413.7481; train_optim_loss: 14981413.7481; val_kl_reg_loss: 56934.6427; val_edge_recon_loss: 2711493.2667; val_gene_expr_recon_loss: 9722968.8667; val_masked_gp_l1_reg_loss: 37511.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125755.0938; val_chrom_access_recon_loss: 2323785.4333; val_global_loss: 14978449.2000; val_optim_loss: 14978449.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9683; val_auprc_score: 0.9540; val_best_acc_score: 0.9221; val_best_f1_score: 0.9250; train_kl_reg_loss: 61516.6657; train_edge_recon_loss: 2679204.9351; train_gene_expr_recon_loss: 9735255.3435; train_masked_gp_l1_reg_loss: 36943.9476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126872.3780; train_chrom_access_recon_loss: 2326203.7405; train_global_loss: 14965997.0229; train_optim_loss: 14965997.0229; val_kl_reg_loss: 56621.5419; val_edge_recon_loss: 2699137.3833; val_gene_expr_recon_loss: 9768979.6667; val_masked_gp_l1_reg_loss: 36410.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127043.1719; val_chrom_access_recon_loss: 2320769.0500; val_global_loss: 15008961.6000; val_optim_loss: 15008961.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9709; val_auprc_score: 0.9583; val_best_acc_score: 0.9256; val_best_f1_score: 0.9281; train_kl_reg_loss: 60461.7063; train_edge_recon_loss: 2684736.0095; train_gene_expr_recon_loss: 9728843.4122; train_masked_gp_l1_reg_loss: 35925.1894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126851.2451; train_chrom_access_recon_loss: 2324881.9504; train_global_loss: 14961699.4580; train_optim_loss: 14961699.4580; val_kl_reg_loss: 57474.0555; val_edge_recon_loss: 2688618.6667; val_gene_expr_recon_loss: 9747532.2000; val_masked_gp_l1_reg_loss: 35482.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127625.5391; val_chrom_access_recon_loss: 2323826.4333; val_global_loss: 14980560.4000; val_optim_loss: 14980560.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9718; val_auprc_score: 0.9631; val_best_acc_score: 0.9239; val_best_f1_score: 0.9272; train_kl_reg_loss: 58688.0655; train_edge_recon_loss: 2690071.2271; train_gene_expr_recon_loss: 9723967.5191; train_masked_gp_l1_reg_loss: 35086.3546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127484.9104; train_chrom_access_recon_loss: 2323633.0954; train_global_loss: 14958931.2214; train_optim_loss: 14958931.2214; val_kl_reg_loss: 56028.5443; val_edge_recon_loss: 2701407.9000; val_gene_expr_recon_loss: 9737012.2000; val_masked_gp_l1_reg_loss: 34711.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126668.7109; val_chrom_access_recon_loss: 2324650.5167; val_global_loss: 14980480.1333; val_optim_loss: 14980480.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9694; val_auprc_score: 0.9569; val_best_acc_score: 0.9225; val_best_f1_score: 0.9250; train_kl_reg_loss: 59700.0774; train_edge_recon_loss: 2684792.5706; train_gene_expr_recon_loss: 9717135.2290; train_masked_gp_l1_reg_loss: 34369.6262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127195.2968; train_chrom_access_recon_loss: 2321188.5382; train_global_loss: 14944381.3053; train_optim_loss: 14944381.3053; val_kl_reg_loss: 56344.0448; val_edge_recon_loss: 2709656.6500; val_gene_expr_recon_loss: 9754768.6667; val_masked_gp_l1_reg_loss: 34068.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127839.7031; val_chrom_access_recon_loss: 2322325.3500; val_global_loss: 15005002.6667; val_optim_loss: 15005002.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9697; val_auprc_score: 0.9580; val_best_acc_score: 0.9223; val_best_f1_score: 0.9248; train_kl_reg_loss: 58987.9014; train_edge_recon_loss: 2687446.0878; train_gene_expr_recon_loss: 9707560.0611; train_masked_gp_l1_reg_loss: 33755.8071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94571.4723; train_chrom_access_recon_loss: 2320485.5773; train_global_loss: 14902806.8626; train_optim_loss: 14902806.8626; val_kl_reg_loss: 59320.2055; val_edge_recon_loss: 2698621.3000; val_gene_expr_recon_loss: 9761252.6000; val_masked_gp_l1_reg_loss: 33690.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91398.2188; val_chrom_access_recon_loss: 2320113.1833; val_global_loss: 14964396.2667; val_optim_loss: 14964396.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9720; val_auprc_score: 0.9618; val_best_acc_score: 0.9245; val_best_f1_score: 0.9269; train_kl_reg_loss: 61056.6048; train_edge_recon_loss: 2683362.9828; train_gene_expr_recon_loss: 9705114.8321; train_masked_gp_l1_reg_loss: 33653.7429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91041.8030; train_chrom_access_recon_loss: 2319293.9790; train_global_loss: 14893523.9084; train_optim_loss: 14893523.9084; val_kl_reg_loss: 59674.5219; val_edge_recon_loss: 2679414.0000; val_gene_expr_recon_loss: 9763780.6000; val_masked_gp_l1_reg_loss: 33617.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90721.0859; val_chrom_access_recon_loss: 2326481.3167; val_global_loss: 14953689.6667; val_optim_loss: 14953689.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9687; val_auprc_score: 0.9560; val_best_acc_score: 0.9194; val_best_f1_score: 0.9225; train_kl_reg_loss: 61430.0462; train_edge_recon_loss: 2690417.3740; train_gene_expr_recon_loss: 9705411.4580; train_masked_gp_l1_reg_loss: 33584.0896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90565.3104; train_chrom_access_recon_loss: 2319442.0410; train_global_loss: 14900850.3664; train_optim_loss: 14900850.3664; val_kl_reg_loss: 59590.6328; val_edge_recon_loss: 2713780.4000; val_gene_expr_recon_loss: 9741353.2667; val_masked_gp_l1_reg_loss: 33547.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90313.8281; val_chrom_access_recon_loss: 2319367.1167; val_global_loss: 14957952.3333; val_optim_loss: 14957952.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9698; val_auprc_score: 0.9585; val_best_acc_score: 0.9267; val_best_f1_score: 0.9290; train_kl_reg_loss: 61203.2951; train_edge_recon_loss: 2679628.8607; train_gene_expr_recon_loss: 9708726.5496; train_masked_gp_l1_reg_loss: 33511.1521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90156.9006; train_chrom_access_recon_loss: 2321883.8740; train_global_loss: 14895110.5267; train_optim_loss: 14895110.5267; val_kl_reg_loss: 59201.2128; val_edge_recon_loss: 2682345.7667; val_gene_expr_recon_loss: 9733273.5333; val_masked_gp_l1_reg_loss: 33474.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90077.2891; val_chrom_access_recon_loss: 2321333.4833; val_global_loss: 14919704.9333; val_optim_loss: 14919704.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9719; val_auprc_score: 0.9619; val_best_acc_score: 0.9219; val_best_f1_score: 0.9245; train_kl_reg_loss: 61127.6888; train_edge_recon_loss: 2677171.8034; train_gene_expr_recon_loss: 9702305.3817; train_masked_gp_l1_reg_loss: 33436.7927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89935.0324; train_chrom_access_recon_loss: 2317987.9008; train_global_loss: 14881964.5954; train_optim_loss: 14881964.5954; val_kl_reg_loss: 59576.1828; val_edge_recon_loss: 2697177.8500; val_gene_expr_recon_loss: 9730027.4000; val_masked_gp_l1_reg_loss: 33397.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89764.4688; val_chrom_access_recon_loss: 2311333.4917; val_global_loss: 14921276.8667; val_optim_loss: 14921276.8667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9720; val_auprc_score: 0.9631; val_best_acc_score: 0.9213; val_best_f1_score: 0.9249; train_kl_reg_loss: 61910.1147; train_edge_recon_loss: 2683069.7443; train_gene_expr_recon_loss: 9703630.3359; train_masked_gp_l1_reg_loss: 33363.3131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89688.7983; train_chrom_access_recon_loss: 2319458.3092; train_global_loss: 14891120.5878; train_optim_loss: 14891120.5878; val_kl_reg_loss: 60749.6193; val_edge_recon_loss: 2680299.0500; val_gene_expr_recon_loss: 9741410.9333; val_masked_gp_l1_reg_loss: 33324.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89539.8750; val_chrom_access_recon_loss: 2329545.2833; val_global_loss: 14934868.9333; val_optim_loss: 14934868.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9698; val_auprc_score: 0.9566; val_best_acc_score: 0.9200; val_best_f1_score: 0.9238; train_kl_reg_loss: 61888.0693; train_edge_recon_loss: 2683200.1832; train_gene_expr_recon_loss: 9702270.5038; train_masked_gp_l1_reg_loss: 33286.0667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89431.5295; train_chrom_access_recon_loss: 2317325.0487; train_global_loss: 14887401.5267; train_optim_loss: 14887401.5267; val_kl_reg_loss: 60564.3750; val_edge_recon_loss: 2702825.1167; val_gene_expr_recon_loss: 9691269.5333; val_masked_gp_l1_reg_loss: 33245.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89229.8203; val_chrom_access_recon_loss: 2311071.6333; val_global_loss: 14888205.6000; val_optim_loss: 14888205.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9705; val_auprc_score: 0.9613; val_best_acc_score: 0.9237; val_best_f1_score: 0.9265; train_kl_reg_loss: 61663.6881; train_edge_recon_loss: 2683380.2939; train_gene_expr_recon_loss: 9695692.0687; train_masked_gp_l1_reg_loss: 33207.5106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89137.2766; train_chrom_access_recon_loss: 2318879.0887; train_global_loss: 14881959.8779; train_optim_loss: 14881959.8779; val_kl_reg_loss: 60220.1508; val_edge_recon_loss: 2702719.9000; val_gene_expr_recon_loss: 9692751.6667; val_masked_gp_l1_reg_loss: 33168.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89130.2109; val_chrom_access_recon_loss: 2319399.4167; val_global_loss: 14897389.1333; val_optim_loss: 14897389.1333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9676; val_auprc_score: 0.9537; val_best_acc_score: 0.9194; val_best_f1_score: 0.9225; train_kl_reg_loss: 61647.2204; train_edge_recon_loss: 2685387.3015; train_gene_expr_recon_loss: 9690632.3511; train_masked_gp_l1_reg_loss: 33127.8180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89023.7568; train_chrom_access_recon_loss: 2316697.8321; train_global_loss: 14876516.3282; train_optim_loss: 14876516.3282; val_kl_reg_loss: 60457.2018; val_edge_recon_loss: 2701016.3167; val_gene_expr_recon_loss: 9743744.3333; val_masked_gp_l1_reg_loss: 33085.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88859.7891; val_chrom_access_recon_loss: 2327378.1750; val_global_loss: 14954541.0000; val_optim_loss: 14954541.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9701; val_auprc_score: 0.9585; val_best_acc_score: 0.9281; val_best_f1_score: 0.9309; train_kl_reg_loss: 61943.3056; train_edge_recon_loss: 2686986.4084; train_gene_expr_recon_loss: 9699053.6641; train_masked_gp_l1_reg_loss: 33046.0088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88810.7528; train_chrom_access_recon_loss: 2317301.5363; train_global_loss: 14887141.6489; train_optim_loss: 14887141.6489; val_kl_reg_loss: 60497.0893; val_edge_recon_loss: 2669782.7167; val_gene_expr_recon_loss: 9692910.2667; val_masked_gp_l1_reg_loss: 33005.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88801.0078; val_chrom_access_recon_loss: 2325237.0000; val_global_loss: 14870233.9333; val_optim_loss: 14870233.9333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9701; val_auprc_score: 0.9602; val_best_acc_score: 0.9223; val_best_f1_score: 0.9251; train_kl_reg_loss: 61903.2724; train_edge_recon_loss: 2678722.4561; train_gene_expr_recon_loss: 9701705.6718; train_masked_gp_l1_reg_loss: 32961.3358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88621.2947; train_chrom_access_recon_loss: 2319537.4885; train_global_loss: 14883451.5038; train_optim_loss: 14883451.5038; val_kl_reg_loss: 59723.1789; val_edge_recon_loss: 2710372.9500; val_gene_expr_recon_loss: 9725514.6667; val_masked_gp_l1_reg_loss: 32918.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88665.5391; val_chrom_access_recon_loss: 2317215.7000; val_global_loss: 14934411.4000; val_optim_loss: 14934411.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9709; val_auprc_score: 0.9596; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 61657.1724; train_edge_recon_loss: 2679883.0706; train_gene_expr_recon_loss: 9695599.6107; train_masked_gp_l1_reg_loss: 32877.3941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88516.5988; train_chrom_access_recon_loss: 2316717.7882; train_global_loss: 14875251.6031; train_optim_loss: 14875251.6031; val_kl_reg_loss: 61015.6031; val_edge_recon_loss: 2682384.6833; val_gene_expr_recon_loss: 9735878.6000; val_masked_gp_l1_reg_loss: 32832.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88563.1328; val_chrom_access_recon_loss: 2314720.7833; val_global_loss: 14915394.6000; val_optim_loss: 14915394.6000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9729; val_auprc_score: 0.9632; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 62466.0813; train_edge_recon_loss: 2678012.6240; train_gene_expr_recon_loss: 9692468.3664; train_masked_gp_l1_reg_loss: 32785.9371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88314.1229; train_chrom_access_recon_loss: 2316918.2805; train_global_loss: 14870965.4427; train_optim_loss: 14870965.4427; val_kl_reg_loss: 61387.3604; val_edge_recon_loss: 2696285.8333; val_gene_expr_recon_loss: 9723300.0000; val_masked_gp_l1_reg_loss: 32741.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88439.7578; val_chrom_access_recon_loss: 2324460.7333; val_global_loss: 14926615.0000; val_optim_loss: 14926615.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9708; val_auprc_score: 0.9566; val_best_acc_score: 0.9235; val_best_f1_score: 0.9263; train_kl_reg_loss: 62232.0422; train_edge_recon_loss: 2680357.3397; train_gene_expr_recon_loss: 9691027.0916; train_masked_gp_l1_reg_loss: 32695.5940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88177.6355; train_chrom_access_recon_loss: 2318207.9122; train_global_loss: 14872697.6336; train_optim_loss: 14872697.6336; val_kl_reg_loss: 61139.7542; val_edge_recon_loss: 2694327.4333; val_gene_expr_recon_loss: 9751576.8667; val_masked_gp_l1_reg_loss: 32650.0879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88150.9844; val_chrom_access_recon_loss: 2326028.7500; val_global_loss: 14953873.7333; val_optim_loss: 14953873.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9710; val_auprc_score: 0.9582; val_best_acc_score: 0.9236; val_best_f1_score: 0.9263; train_kl_reg_loss: 62457.6577; train_edge_recon_loss: 2680427.5305; train_gene_expr_recon_loss: 9693424.1908; train_masked_gp_l1_reg_loss: 32607.7765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84467.7190; train_chrom_access_recon_loss: 2317380.6469; train_global_loss: 14870765.4351; train_optim_loss: 14870765.4351; val_kl_reg_loss: 61132.4880; val_edge_recon_loss: 2689472.9167; val_gene_expr_recon_loss: 9728796.4000; val_masked_gp_l1_reg_loss: 32598.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84093.9922; val_chrom_access_recon_loss: 2314106.3833; val_global_loss: 14910200.2000; val_optim_loss: 14910200.2000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9713; val_auprc_score: 0.9605; val_best_acc_score: 0.9260; val_best_f1_score: 0.9286; train_kl_reg_loss: 62363.4128; train_edge_recon_loss: 2679256.9809; train_gene_expr_recon_loss: 9696530.8473; train_masked_gp_l1_reg_loss: 32592.3564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84055.7881; train_chrom_access_recon_loss: 2317802.0954; train_global_loss: 14872601.4275; train_optim_loss: 14872601.4275; val_kl_reg_loss: 61140.7299; val_edge_recon_loss: 2672977.8167; val_gene_expr_recon_loss: 9748322.4000; val_masked_gp_l1_reg_loss: 32586.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84014.0234; val_chrom_access_recon_loss: 2333445.4167; val_global_loss: 14932486.2667; val_optim_loss: 14932486.2667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9701; val_auprc_score: 0.9563; val_best_acc_score: 0.9235; val_best_f1_score: 0.9262; train_kl_reg_loss: 62389.4242; train_edge_recon_loss: 2678573.3092; train_gene_expr_recon_loss: 9698563.5878; train_masked_gp_l1_reg_loss: 32580.5219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84003.1103; train_chrom_access_recon_loss: 2318109.7471; train_global_loss: 14874219.7786; train_optim_loss: 14874219.7786; val_kl_reg_loss: 61118.2661; val_edge_recon_loss: 2686259.6167; val_gene_expr_recon_loss: 9713039.1333; val_masked_gp_l1_reg_loss: 32574.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83981.6953; val_chrom_access_recon_loss: 2318104.1000; val_global_loss: 14895077.2000; val_optim_loss: 14895077.2000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9693; val_auprc_score: 0.9593; val_best_acc_score: 0.9190; val_best_f1_score: 0.9222; train_kl_reg_loss: 62332.1516; train_edge_recon_loss: 2682810.9008; train_gene_expr_recon_loss: 9698028.2901; train_masked_gp_l1_reg_loss: 32568.2536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83975.3030; train_chrom_access_recon_loss: 2318328.7042; train_global_loss: 14878043.4733; train_optim_loss: 14878043.4733; val_kl_reg_loss: 61231.3667; val_edge_recon_loss: 2683166.5333; val_gene_expr_recon_loss: 9754890.9333; val_masked_gp_l1_reg_loss: 32562.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83961.1875; val_chrom_access_recon_loss: 2325785.9500; val_global_loss: 14941597.7333; val_optim_loss: 14941597.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 104 min 46 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9724
val AUPRC score: 0.9642
val best accuracy score: 0.9264
val best F1 score: 0.9288
val target rna MSE score: 2.3204
val source rna MSE score: 1.3769
val target atac MSE score: 0.5074
val source atac MSE score: 0.0827
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
