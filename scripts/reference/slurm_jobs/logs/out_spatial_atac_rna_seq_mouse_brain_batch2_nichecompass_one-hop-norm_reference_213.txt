[True]
Run timestamp: 10102023_091512_213.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_213']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7753; val_auprc_score: 0.7918; val_best_acc_score: 0.5183; val_best_f1_score: 0.6740; train_kl_reg_loss: 79967.6253; train_edge_recon_loss: 751584.8669; train_gene_expr_recon_loss: 22197826.8092; train_masked_gp_l1_reg_loss: 41894.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2928124.8492; train_chrom_access_recon_loss: 6682179.1679; train_global_loss: 32681578.2595; train_optim_loss: 32681578.2595; val_kl_reg_loss: 93663.6198; val_edge_recon_loss: 812828.6708; val_gene_expr_recon_loss: 21253600.8000; val_masked_gp_l1_reg_loss: 44974.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1092266.8750; val_chrom_access_recon_loss: 6527641.8667; val_global_loss: 29824974.8000; val_optim_loss: 29824974.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7955; val_auprc_score: 0.8126; val_best_acc_score: 0.6136; val_best_f1_score: 0.7112; train_kl_reg_loss: 80946.3419; train_edge_recon_loss: 738051.0119; train_gene_expr_recon_loss: 21062975.8168; train_masked_gp_l1_reg_loss: 46192.8890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 584904.8163; train_chrom_access_recon_loss: 6478321.1107; train_global_loss: 28991391.7252; train_optim_loss: 28991391.7252; val_kl_reg_loss: 97596.7589; val_edge_recon_loss: 810897.6417; val_gene_expr_recon_loss: 20942708.6667; val_masked_gp_l1_reg_loss: 46957.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 326907.4375; val_chrom_access_recon_loss: 6436835.7333; val_global_loss: 28661904.8000; val_optim_loss: 28661904.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8680; val_auprc_score: 0.8698; val_best_acc_score: 0.7579; val_best_f1_score: 0.7904; train_kl_reg_loss: 69198.9526; train_edge_recon_loss: 727729.9308; train_gene_expr_recon_loss: 20754077.7405; train_masked_gp_l1_reg_loss: 47495.0281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238844.5730; train_chrom_access_recon_loss: 6402387.4542; train_global_loss: 28239733.5878; train_optim_loss: 28239733.5878; val_kl_reg_loss: 66017.0591; val_edge_recon_loss: 781489.6458; val_gene_expr_recon_loss: 20589109.0667; val_masked_gp_l1_reg_loss: 48889.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190317.7188; val_chrom_access_recon_loss: 6316031.1667; val_global_loss: 27991854.8000; val_optim_loss: 27991854.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9053; val_auprc_score: 0.8974; val_best_acc_score: 0.8158; val_best_f1_score: 0.8276; train_kl_reg_loss: 63364.9796; train_edge_recon_loss: 691247.7576; train_gene_expr_recon_loss: 20474079.8015; train_masked_gp_l1_reg_loss: 50822.3079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172375.7781; train_chrom_access_recon_loss: 6325855.3779; train_global_loss: 27777745.9847; train_optim_loss: 27777745.9847; val_kl_reg_loss: 71269.4406; val_edge_recon_loss: 656271.2208; val_gene_expr_recon_loss: 20445402.2667; val_masked_gp_l1_reg_loss: 52671.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159091.0938; val_chrom_access_recon_loss: 6277776.2000; val_global_loss: 27662483.2000; val_optim_loss: 27662483.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8997; val_auprc_score: 0.8835; val_best_acc_score: 0.8170; val_best_f1_score: 0.8303; train_kl_reg_loss: 73962.6137; train_edge_recon_loss: 645776.8564; train_gene_expr_recon_loss: 20266966.8550; train_masked_gp_l1_reg_loss: 53984.9036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147016.3548; train_chrom_access_recon_loss: 6274813.7176; train_global_loss: 27462521.4046; train_optim_loss: 27462521.4046; val_kl_reg_loss: 75180.1547; val_edge_recon_loss: 627382.2583; val_gene_expr_recon_loss: 20212352.0000; val_masked_gp_l1_reg_loss: 55449.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135052.9219; val_chrom_access_recon_loss: 6255917.6000; val_global_loss: 27361334.2667; val_optim_loss: 27361334.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9210; val_auprc_score: 0.9102; val_best_acc_score: 0.8421; val_best_f1_score: 0.8512; train_kl_reg_loss: 70719.2407; train_edge_recon_loss: 634847.6999; train_gene_expr_recon_loss: 20142417.3740; train_masked_gp_l1_reg_loss: 56417.6582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127974.5479; train_chrom_access_recon_loss: 6235934.1450; train_global_loss: 27268310.7481; train_optim_loss: 27268310.7481; val_kl_reg_loss: 66853.1112; val_edge_recon_loss: 634029.5667; val_gene_expr_recon_loss: 20058121.4667; val_masked_gp_l1_reg_loss: 56839.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132165.5156; val_chrom_access_recon_loss: 6199621.3000; val_global_loss: 27147631.2000; val_optim_loss: 27147631.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9318; val_auprc_score: 0.9183; val_best_acc_score: 0.8584; val_best_f1_score: 0.8664; train_kl_reg_loss: 66686.3129; train_edge_recon_loss: 620435.5124; train_gene_expr_recon_loss: 19952800.8244; train_masked_gp_l1_reg_loss: 57740.3156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120942.2650; train_chrom_access_recon_loss: 6186913.1145; train_global_loss: 27005518.2595; train_optim_loss: 27005518.2595; val_kl_reg_loss: 66999.1654; val_edge_recon_loss: 609075.5958; val_gene_expr_recon_loss: 19943444.4000; val_masked_gp_l1_reg_loss: 58733.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115875.8047; val_chrom_access_recon_loss: 6180003.1000; val_global_loss: 26974132.2667; val_optim_loss: 26974132.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9356; val_auprc_score: 0.9234; val_best_acc_score: 0.8643; val_best_f1_score: 0.8722; train_kl_reg_loss: 66148.4666; train_edge_recon_loss: 609627.5802; train_gene_expr_recon_loss: 19827432.7634; train_masked_gp_l1_reg_loss: 59554.8947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111105.8766; train_chrom_access_recon_loss: 6147838.0954; train_global_loss: 26821707.6794; train_optim_loss: 26821707.6794; val_kl_reg_loss: 64926.8424; val_edge_recon_loss: 605414.1083; val_gene_expr_recon_loss: 19819742.2667; val_masked_gp_l1_reg_loss: 60483.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109070.1016; val_chrom_access_recon_loss: 6129437.8333; val_global_loss: 26789075.0667; val_optim_loss: 26789075.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9403; val_auprc_score: 0.9314; val_best_acc_score: 0.8707; val_best_f1_score: 0.8785; train_kl_reg_loss: 64711.1514; train_edge_recon_loss: 604066.4642; train_gene_expr_recon_loss: 19697998.8092; train_masked_gp_l1_reg_loss: 61248.5475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105815.4488; train_chrom_access_recon_loss: 6103459.5916; train_global_loss: 26637300.0305; train_optim_loss: 26637300.0305; val_kl_reg_loss: 65041.5362; val_edge_recon_loss: 603732.8792; val_gene_expr_recon_loss: 19741550.2667; val_masked_gp_l1_reg_loss: 61958.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104599.7109; val_chrom_access_recon_loss: 6084080.8000; val_global_loss: 26660963.4667; val_optim_loss: 26660963.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9455; val_auprc_score: 0.9354; val_best_acc_score: 0.8812; val_best_f1_score: 0.8870; train_kl_reg_loss: 63117.3653; train_edge_recon_loss: 599205.3321; train_gene_expr_recon_loss: 19591885.7252; train_masked_gp_l1_reg_loss: 62628.9961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101895.7991; train_chrom_access_recon_loss: 6077320.5115; train_global_loss: 26496053.5878; train_optim_loss: 26496053.5878; val_kl_reg_loss: 61085.4344; val_edge_recon_loss: 598089.4833; val_gene_expr_recon_loss: 19534926.8000; val_masked_gp_l1_reg_loss: 63303.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100118.3594; val_chrom_access_recon_loss: 6043504.8333; val_global_loss: 26401028.6667; val_optim_loss: 26401028.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9469; val_auprc_score: 0.9321; val_best_acc_score: 0.8817; val_best_f1_score: 0.8873; train_kl_reg_loss: 62373.7561; train_edge_recon_loss: 593946.8354; train_gene_expr_recon_loss: 19517825.0687; train_masked_gp_l1_reg_loss: 63998.2403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98298.4573; train_chrom_access_recon_loss: 6050908.8702; train_global_loss: 26387351.0992; train_optim_loss: 26387351.0992; val_kl_reg_loss: 62752.2362; val_edge_recon_loss: 592552.3208; val_gene_expr_recon_loss: 19519279.3333; val_masked_gp_l1_reg_loss: 64972.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96776.1641; val_chrom_access_recon_loss: 6026653.9000; val_global_loss: 26362985.8667; val_optim_loss: 26362985.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9497; val_auprc_score: 0.9406; val_best_acc_score: 0.8810; val_best_f1_score: 0.8866; train_kl_reg_loss: 59364.1076; train_edge_recon_loss: 595413.2948; train_gene_expr_recon_loss: 19474371.1145; train_masked_gp_l1_reg_loss: 65237.3901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99059.0019; train_chrom_access_recon_loss: 6035240.9198; train_global_loss: 26328685.9847; train_optim_loss: 26328685.9847; val_kl_reg_loss: 59305.6107; val_edge_recon_loss: 595760.8208; val_gene_expr_recon_loss: 19388276.4000; val_masked_gp_l1_reg_loss: 65820.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100113.5391; val_chrom_access_recon_loss: 6001291.2667; val_global_loss: 26210568.1333; val_optim_loss: 26210568.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9542; val_auprc_score: 0.9461; val_best_acc_score: 0.8930; val_best_f1_score: 0.8946; train_kl_reg_loss: 59683.2626; train_edge_recon_loss: 590847.7762; train_gene_expr_recon_loss: 19359131.9695; train_masked_gp_l1_reg_loss: 66298.5113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95963.5233; train_chrom_access_recon_loss: 6009194.1260; train_global_loss: 26181118.9618; train_optim_loss: 26181118.9618; val_kl_reg_loss: 59208.1185; val_edge_recon_loss: 594147.1042; val_gene_expr_recon_loss: 19284935.0667; val_masked_gp_l1_reg_loss: 66551.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93459.5547; val_chrom_access_recon_loss: 5957309.8000; val_global_loss: 26055611.7333; val_optim_loss: 26055611.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9488; val_auprc_score: 0.9385; val_best_acc_score: 0.8805; val_best_f1_score: 0.8854; train_kl_reg_loss: 59406.4091; train_edge_recon_loss: 587518.2848; train_gene_expr_recon_loss: 19247145.9542; train_masked_gp_l1_reg_loss: 67032.7796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92230.4878; train_chrom_access_recon_loss: 5976779.8969; train_global_loss: 26030113.7710; train_optim_loss: 26030113.7710; val_kl_reg_loss: 59351.0440; val_edge_recon_loss: 590035.2333; val_gene_expr_recon_loss: 19221285.4667; val_masked_gp_l1_reg_loss: 67473.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92277.1250; val_chrom_access_recon_loss: 5958026.6333; val_global_loss: 25988450.5333; val_optim_loss: 25988450.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9566; val_auprc_score: 0.9484; val_best_acc_score: 0.8976; val_best_f1_score: 0.9009; train_kl_reg_loss: 58438.7736; train_edge_recon_loss: 585483.8869; train_gene_expr_recon_loss: 19194892.7023; train_masked_gp_l1_reg_loss: 67563.4126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90144.7591; train_chrom_access_recon_loss: 5955668.5573; train_global_loss: 25952192.2443; train_optim_loss: 25952192.2443; val_kl_reg_loss: 58329.0648; val_edge_recon_loss: 586137.0042; val_gene_expr_recon_loss: 19170947.7333; val_masked_gp_l1_reg_loss: 67946.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89433.9844; val_chrom_access_recon_loss: 5904778.5333; val_global_loss: 25877572.4000; val_optim_loss: 25877572.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9578; val_auprc_score: 0.9482; val_best_acc_score: 0.8992; val_best_f1_score: 0.9034; train_kl_reg_loss: 57327.7532; train_edge_recon_loss: 582863.4642; train_gene_expr_recon_loss: 19127528.5344; train_masked_gp_l1_reg_loss: 68169.0166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88437.7972; train_chrom_access_recon_loss: 5935725.0267; train_global_loss: 25860051.6489; train_optim_loss: 25860051.6489; val_kl_reg_loss: 55747.7339; val_edge_recon_loss: 583940.2000; val_gene_expr_recon_loss: 19243426.1333; val_masked_gp_l1_reg_loss: 68436.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88252.9141; val_chrom_access_recon_loss: 5952903.1667; val_global_loss: 25992705.3333; val_optim_loss: 25992705.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9560; val_best_acc_score: 0.9039; val_best_f1_score: 0.9073; train_kl_reg_loss: 56588.9601; train_edge_recon_loss: 580475.5391; train_gene_expr_recon_loss: 19074727.3282; train_masked_gp_l1_reg_loss: 68670.7428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87321.3153; train_chrom_access_recon_loss: 5917761.1718; train_global_loss: 25785544.9924; train_optim_loss: 25785544.9924; val_kl_reg_loss: 56712.6503; val_edge_recon_loss: 581179.5375; val_gene_expr_recon_loss: 19119249.6000; val_masked_gp_l1_reg_loss: 68905.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86256.8594; val_chrom_access_recon_loss: 5918461.2000; val_global_loss: 25830764.8000; val_optim_loss: 25830764.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9602; val_auprc_score: 0.9533; val_best_acc_score: 0.9015; val_best_f1_score: 0.9038; train_kl_reg_loss: 56040.3805; train_edge_recon_loss: 580423.5969; train_gene_expr_recon_loss: 19042974.4885; train_masked_gp_l1_reg_loss: 69079.4129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86091.0014; train_chrom_access_recon_loss: 5902188.8321; train_global_loss: 25736797.6031; train_optim_loss: 25736797.6031; val_kl_reg_loss: 55251.5924; val_edge_recon_loss: 585385.4333; val_gene_expr_recon_loss: 19092524.1333; val_masked_gp_l1_reg_loss: 69338.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86295.8828; val_chrom_access_recon_loss: 5899161.1667; val_global_loss: 25787956.2667; val_optim_loss: 25787956.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9625; val_auprc_score: 0.9563; val_best_acc_score: 0.9037; val_best_f1_score: 0.9062; train_kl_reg_loss: 55191.0494; train_edge_recon_loss: 579413.2834; train_gene_expr_recon_loss: 18984507.8931; train_masked_gp_l1_reg_loss: 69576.3413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85602.4825; train_chrom_access_recon_loss: 5882025.7786; train_global_loss: 25656316.7634; train_optim_loss: 25656316.7634; val_kl_reg_loss: 54905.2635; val_edge_recon_loss: 581628.0708; val_gene_expr_recon_loss: 18974724.0000; val_masked_gp_l1_reg_loss: 69859.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86124.4375; val_chrom_access_recon_loss: 5848185.1333; val_global_loss: 25615426.4000; val_optim_loss: 25615426.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9654; val_auprc_score: 0.9565; val_best_acc_score: 0.9097; val_best_f1_score: 0.9135; train_kl_reg_loss: 54720.9544; train_edge_recon_loss: 578185.9838; train_gene_expr_recon_loss: 18950411.0687; train_masked_gp_l1_reg_loss: 70015.2236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85460.0469; train_chrom_access_recon_loss: 5869624.5038; train_global_loss: 25608417.8168; train_optim_loss: 25608417.8168; val_kl_reg_loss: 55337.4305; val_edge_recon_loss: 581022.4458; val_gene_expr_recon_loss: 18943233.4667; val_masked_gp_l1_reg_loss: 70277.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85454.6875; val_chrom_access_recon_loss: 5842244.1000; val_global_loss: 25577569.2000; val_optim_loss: 25577569.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9664; val_auprc_score: 0.9584; val_best_acc_score: 0.9117; val_best_f1_score: 0.9140; train_kl_reg_loss: 54251.9332; train_edge_recon_loss: 576697.1441; train_gene_expr_recon_loss: 18884714.2901; train_masked_gp_l1_reg_loss: 70556.3554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85066.0568; train_chrom_access_recon_loss: 5843340.6374; train_global_loss: 25514626.3664; train_optim_loss: 25514626.3664; val_kl_reg_loss: 54519.7474; val_edge_recon_loss: 577279.1750; val_gene_expr_recon_loss: 18923284.8000; val_masked_gp_l1_reg_loss: 70910.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85904.3906; val_chrom_access_recon_loss: 5834526.6000; val_global_loss: 25546424.1333; val_optim_loss: 25546424.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9667; val_auprc_score: 0.9595; val_best_acc_score: 0.9146; val_best_f1_score: 0.9179; train_kl_reg_loss: 53713.2401; train_edge_recon_loss: 575768.6546; train_gene_expr_recon_loss: 18860753.4198; train_masked_gp_l1_reg_loss: 71176.9410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85183.2598; train_chrom_access_recon_loss: 5835707.8282; train_global_loss: 25482303.2672; train_optim_loss: 25482303.2672; val_kl_reg_loss: 53389.9857; val_edge_recon_loss: 575779.4042; val_gene_expr_recon_loss: 18921772.5333; val_masked_gp_l1_reg_loss: 71508.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85948.8984; val_chrom_access_recon_loss: 5833004.7000; val_global_loss: 25541402.8000; val_optim_loss: 25541402.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9663; val_auprc_score: 0.9575; val_best_acc_score: 0.9140; val_best_f1_score: 0.9167; train_kl_reg_loss: 53191.5700; train_edge_recon_loss: 575413.2805; train_gene_expr_recon_loss: 18824127.0229; train_masked_gp_l1_reg_loss: 71816.5970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85481.1560; train_chrom_access_recon_loss: 5826026.5573; train_global_loss: 25436056.1221; train_optim_loss: 25436056.1221; val_kl_reg_loss: 52731.8021; val_edge_recon_loss: 577985.8500; val_gene_expr_recon_loss: 18920586.0000; val_masked_gp_l1_reg_loss: 72214.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86926.9375; val_chrom_access_recon_loss: 5830838.3333; val_global_loss: 25541282.0000; val_optim_loss: 25541282.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9663; val_auprc_score: 0.9592; val_best_acc_score: 0.9076; val_best_f1_score: 0.9113; train_kl_reg_loss: 52701.0154; train_edge_recon_loss: 574327.3564; train_gene_expr_recon_loss: 18792329.5191; train_masked_gp_l1_reg_loss: 72463.9779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85982.5512; train_chrom_access_recon_loss: 5816609.9771; train_global_loss: 25394414.3817; train_optim_loss: 25394414.3817; val_kl_reg_loss: 52851.0745; val_edge_recon_loss: 579324.0792; val_gene_expr_recon_loss: 18803920.9333; val_masked_gp_l1_reg_loss: 72818.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87042.5781; val_chrom_access_recon_loss: 5786363.1667; val_global_loss: 25382318.9333; val_optim_loss: 25382318.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9704; val_auprc_score: 0.9626; val_best_acc_score: 0.9229; val_best_f1_score: 0.9251; train_kl_reg_loss: 52689.5969; train_edge_recon_loss: 573323.9194; train_gene_expr_recon_loss: 18748249.0076; train_masked_gp_l1_reg_loss: 73100.0402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86791.7015; train_chrom_access_recon_loss: 5796760.3511; train_global_loss: 25330914.7786; train_optim_loss: 25330914.7786; val_kl_reg_loss: 52239.6396; val_edge_recon_loss: 574019.8042; val_gene_expr_recon_loss: 18797417.2000; val_masked_gp_l1_reg_loss: 73346.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86442.6719; val_chrom_access_recon_loss: 5789609.5333; val_global_loss: 25373074.0000; val_optim_loss: 25373074.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9619; val_auprc_score: 0.9551; val_best_acc_score: 0.9053; val_best_f1_score: 0.9090; train_kl_reg_loss: 52651.3849; train_edge_recon_loss: 611475.8349; train_gene_expr_recon_loss: 17598421.6183; train_masked_gp_l1_reg_loss: 72808.5091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75237.9810; train_chrom_access_recon_loss: 5512640.4198; train_global_loss: 23923235.8473; train_optim_loss: 23923235.8473; val_kl_reg_loss: 32873.4493; val_edge_recon_loss: 587255.1792; val_gene_expr_recon_loss: 17581376.1333; val_masked_gp_l1_reg_loss: 72082.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73474.4766; val_chrom_access_recon_loss: 5480316.1333; val_global_loss: 23827376.9333; val_optim_loss: 23827376.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9595; val_auprc_score: 0.9506; val_best_acc_score: 0.9016; val_best_f1_score: 0.9051; train_kl_reg_loss: 47467.2316; train_edge_recon_loss: 580834.1073; train_gene_expr_recon_loss: 17510513.6183; train_masked_gp_l1_reg_loss: 71185.4252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73178.2382; train_chrom_access_recon_loss: 5483545.6031; train_global_loss: 23766724.1527; train_optim_loss: 23766724.1527; val_kl_reg_loss: 37254.6133; val_edge_recon_loss: 580236.2708; val_gene_expr_recon_loss: 17668822.4667; val_masked_gp_l1_reg_loss: 70267.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72760.1250; val_chrom_access_recon_loss: 5479941.4667; val_global_loss: 23909282.6667; val_optim_loss: 23909282.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9643; val_auprc_score: 0.9532; val_best_acc_score: 0.9084; val_best_f1_score: 0.9109; train_kl_reg_loss: 45622.8872; train_edge_recon_loss: 573950.4089; train_gene_expr_recon_loss: 17489311.3206; train_masked_gp_l1_reg_loss: 69744.9132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72975.1754; train_chrom_access_recon_loss: 5486823.0840; train_global_loss: 23738427.9695; train_optim_loss: 23738427.9695; val_kl_reg_loss: 38610.4552; val_edge_recon_loss: 574326.4792; val_gene_expr_recon_loss: 17496072.3333; val_masked_gp_l1_reg_loss: 69150.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73098.2344; val_chrom_access_recon_loss: 5476556.8333; val_global_loss: 23727814.0000; val_optim_loss: 23727814.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9647; val_auprc_score: 0.9538; val_best_acc_score: 0.9127; val_best_f1_score: 0.9145; train_kl_reg_loss: 44428.3938; train_edge_recon_loss: 570355.1236; train_gene_expr_recon_loss: 17456261.9542; train_masked_gp_l1_reg_loss: 68689.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73204.3523; train_chrom_access_recon_loss: 5476656.5344; train_global_loss: 23689595.9084; train_optim_loss: 23689595.9084; val_kl_reg_loss: 39851.8664; val_edge_recon_loss: 567703.1625; val_gene_expr_recon_loss: 17557896.9333; val_masked_gp_l1_reg_loss: 68317.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73240.5234; val_chrom_access_recon_loss: 5473136.6667; val_global_loss: 23780146.6667; val_optim_loss: 23780146.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9671; val_auprc_score: 0.9573; val_best_acc_score: 0.9166; val_best_f1_score: 0.9192; train_kl_reg_loss: 43434.5066; train_edge_recon_loss: 569009.8235; train_gene_expr_recon_loss: 17417240.0382; train_masked_gp_l1_reg_loss: 68121.2321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73134.9903; train_chrom_access_recon_loss: 5464048.0344; train_global_loss: 23634988.6412; train_optim_loss: 23634988.6412; val_kl_reg_loss: 37802.3690; val_edge_recon_loss: 573443.0333; val_gene_expr_recon_loss: 17532093.4667; val_masked_gp_l1_reg_loss: 67743.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73103.1797; val_chrom_access_recon_loss: 5467582.0667; val_global_loss: 23751768.6667; val_optim_loss: 23751768.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9670; val_auprc_score: 0.9581; val_best_acc_score: 0.9151; val_best_f1_score: 0.9172; train_kl_reg_loss: 43609.3483; train_edge_recon_loss: 566575.9957; train_gene_expr_recon_loss: 17398675.0000; train_masked_gp_l1_reg_loss: 67454.9513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73108.1192; train_chrom_access_recon_loss: 5460436.1718; train_global_loss: 23609859.4962; train_optim_loss: 23609859.4962; val_kl_reg_loss: 39495.2578; val_edge_recon_loss: 568449.2625; val_gene_expr_recon_loss: 17463333.0000; val_masked_gp_l1_reg_loss: 67066.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73493.3750; val_chrom_access_recon_loss: 5451658.9667; val_global_loss: 23663496.0000; val_optim_loss: 23663496.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9627; val_auprc_score: 0.9538; val_best_acc_score: 0.9082; val_best_f1_score: 0.9114; train_kl_reg_loss: 43429.2249; train_edge_recon_loss: 568268.8726; train_gene_expr_recon_loss: 17372153.1527; train_masked_gp_l1_reg_loss: 66911.6065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73248.3725; train_chrom_access_recon_loss: 5454347.4580; train_global_loss: 23578358.7023; train_optim_loss: 23578358.7023; val_kl_reg_loss: 38570.3555; val_edge_recon_loss: 577680.3167; val_gene_expr_recon_loss: 17393128.4000; val_masked_gp_l1_reg_loss: 66771.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73336.5938; val_chrom_access_recon_loss: 5424106.8667; val_global_loss: 23573594.4000; val_optim_loss: 23573594.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9679; val_auprc_score: 0.9599; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 43035.0397; train_edge_recon_loss: 567627.4141; train_gene_expr_recon_loss: 17320852.7939; train_masked_gp_l1_reg_loss: 66436.4079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73017.6276; train_chrom_access_recon_loss: 5443175.7710; train_global_loss: 23514144.9160; train_optim_loss: 23514144.9160; val_kl_reg_loss: 40452.1797; val_edge_recon_loss: 566922.0208; val_gene_expr_recon_loss: 17403190.8667; val_masked_gp_l1_reg_loss: 66198.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73019.2656; val_chrom_access_recon_loss: 5440255.1000; val_global_loss: 23590038.2667; val_optim_loss: 23590038.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9680; val_auprc_score: 0.9584; val_best_acc_score: 0.9166; val_best_f1_score: 0.9191; train_kl_reg_loss: 43066.4182; train_edge_recon_loss: 564464.0577; train_gene_expr_recon_loss: 17309279.7939; train_masked_gp_l1_reg_loss: 66155.6503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73037.5112; train_chrom_access_recon_loss: 5447762.6794; train_global_loss: 23503766.1374; train_optim_loss: 23503766.1374; val_kl_reg_loss: 40643.3346; val_edge_recon_loss: 565617.9000; val_gene_expr_recon_loss: 17411432.9333; val_masked_gp_l1_reg_loss: 66051.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72918.2109; val_chrom_access_recon_loss: 5420024.9667; val_global_loss: 23576689.4667; val_optim_loss: 23576689.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9617; val_auprc_score: 0.9503; val_best_acc_score: 0.9105; val_best_f1_score: 0.9142; train_kl_reg_loss: 42730.6007; train_edge_recon_loss: 564297.0248; train_gene_expr_recon_loss: 17279132.6565; train_masked_gp_l1_reg_loss: 66171.2115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73046.9816; train_chrom_access_recon_loss: 5446105.4198; train_global_loss: 23471484.0458; train_optim_loss: 23471484.0458; val_kl_reg_loss: 40008.9961; val_edge_recon_loss: 570964.9208; val_gene_expr_recon_loss: 17455961.6000; val_masked_gp_l1_reg_loss: 66177.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73344.5781; val_chrom_access_recon_loss: 5476062.8333; val_global_loss: 23682520.5333; val_optim_loss: 23682520.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9675; val_auprc_score: 0.9571; val_best_acc_score: 0.9175; val_best_f1_score: 0.9213; train_kl_reg_loss: 42458.8136; train_edge_recon_loss: 563385.9432; train_gene_expr_recon_loss: 17273112.4580; train_masked_gp_l1_reg_loss: 66268.8627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73257.6877; train_chrom_access_recon_loss: 5446993.8702; train_global_loss: 23465477.7252; train_optim_loss: 23465477.7252; val_kl_reg_loss: 40132.2362; val_edge_recon_loss: 566556.0417; val_gene_expr_recon_loss: 17413224.0667; val_masked_gp_l1_reg_loss: 66294.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73382.8594; val_chrom_access_recon_loss: 5439468.1667; val_global_loss: 23599056.8000; val_optim_loss: 23599056.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9731; val_auprc_score: 0.9651; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 41624.4968; train_edge_recon_loss: 564070.2758; train_gene_expr_recon_loss: 17233833.5496; train_masked_gp_l1_reg_loss: 65873.2338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61825.6849; train_chrom_access_recon_loss: 5458065.3969; train_global_loss: 23425292.4275; train_optim_loss: 23425292.4275; val_kl_reg_loss: 39806.9560; val_edge_recon_loss: 564308.6792; val_gene_expr_recon_loss: 17374489.2667; val_masked_gp_l1_reg_loss: 65727.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59655.4062; val_chrom_access_recon_loss: 5425413.2333; val_global_loss: 23529402.1333; val_optim_loss: 23529402.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9695; val_auprc_score: 0.9591; val_best_acc_score: 0.9192; val_best_f1_score: 0.9218; train_kl_reg_loss: 42139.8706; train_edge_recon_loss: 563466.7233; train_gene_expr_recon_loss: 17215752.8092; train_masked_gp_l1_reg_loss: 65698.1851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59103.1701; train_chrom_access_recon_loss: 5446071.7595; train_global_loss: 23392232.5191; train_optim_loss: 23392232.5191; val_kl_reg_loss: 40493.2464; val_edge_recon_loss: 562612.6833; val_gene_expr_recon_loss: 17355254.4000; val_masked_gp_l1_reg_loss: 65685.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58659.1875; val_chrom_access_recon_loss: 5447376.1333; val_global_loss: 23530082.6667; val_optim_loss: 23530082.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9684; val_auprc_score: 0.9540; val_best_acc_score: 0.9219; val_best_f1_score: 0.9243; train_kl_reg_loss: 42793.6807; train_edge_recon_loss: 563126.8960; train_gene_expr_recon_loss: 17195363.1756; train_masked_gp_l1_reg_loss: 65660.2586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58363.9151; train_chrom_access_recon_loss: 5435057.7824; train_global_loss: 23360365.7710; train_optim_loss: 23360365.7710; val_kl_reg_loss: 40869.1000; val_edge_recon_loss: 563601.6667; val_gene_expr_recon_loss: 17299425.8000; val_masked_gp_l1_reg_loss: 65648.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58036.2930; val_chrom_access_recon_loss: 5452588.5333; val_global_loss: 23480169.0667; val_optim_loss: 23480169.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9685; val_auprc_score: 0.9599; val_best_acc_score: 0.9146; val_best_f1_score: 0.9178; train_kl_reg_loss: 43036.6393; train_edge_recon_loss: 561866.3483; train_gene_expr_recon_loss: 17207738.5573; train_masked_gp_l1_reg_loss: 65632.0081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57765.4545; train_chrom_access_recon_loss: 5434482.5573; train_global_loss: 23370521.5420; train_optim_loss: 23370521.5420; val_kl_reg_loss: 41251.6185; val_edge_recon_loss: 569994.0792; val_gene_expr_recon_loss: 17284900.0667; val_masked_gp_l1_reg_loss: 65630.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57568.1094; val_chrom_access_recon_loss: 5413040.4667; val_global_loss: 23432384.5333; val_optim_loss: 23432384.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9681; val_auprc_score: 0.9599; val_best_acc_score: 0.9214; val_best_f1_score: 0.9243; train_kl_reg_loss: 43273.0432; train_edge_recon_loss: 562404.7147; train_gene_expr_recon_loss: 17190980.4885; train_masked_gp_l1_reg_loss: 65620.8083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57306.2627; train_chrom_access_recon_loss: 5429031.0191; train_global_loss: 23348616.3817; train_optim_loss: 23348616.3817; val_kl_reg_loss: 41559.4349; val_edge_recon_loss: 562016.8500; val_gene_expr_recon_loss: 17270107.2000; val_masked_gp_l1_reg_loss: 65615.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57041.0781; val_chrom_access_recon_loss: 5407741.0000; val_global_loss: 23404082.0000; val_optim_loss: 23404082.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9670; val_auprc_score: 0.9563; val_best_acc_score: 0.9155; val_best_f1_score: 0.9199; train_kl_reg_loss: 43489.2822; train_edge_recon_loss: 562149.4919; train_gene_expr_recon_loss: 17205830.2137; train_masked_gp_l1_reg_loss: 65615.0740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56870.7723; train_chrom_access_recon_loss: 5437767.6527; train_global_loss: 23371722.3664; train_optim_loss: 23371722.3664; val_kl_reg_loss: 41443.2029; val_edge_recon_loss: 566756.5500; val_gene_expr_recon_loss: 17360928.7333; val_masked_gp_l1_reg_loss: 65616.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56644.7656; val_chrom_access_recon_loss: 5436894.5333; val_global_loss: 23528283.2000; val_optim_loss: 23528283.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9714; val_auprc_score: 0.9643; val_best_acc_score: 0.9237; val_best_f1_score: 0.9254; train_kl_reg_loss: 43434.7500; train_edge_recon_loss: 562488.6651; train_gene_expr_recon_loss: 17204224.1832; train_masked_gp_l1_reg_loss: 65613.1638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56416.7055; train_chrom_access_recon_loss: 5438622.7557; train_global_loss: 23370800.2290; train_optim_loss: 23370800.2290; val_kl_reg_loss: 41579.3461; val_edge_recon_loss: 565936.6292; val_gene_expr_recon_loss: 17290357.0667; val_masked_gp_l1_reg_loss: 65611.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56208.7734; val_chrom_access_recon_loss: 5403816.5333; val_global_loss: 23423509.4667; val_optim_loss: 23423509.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9709; val_auprc_score: 0.9624; val_best_acc_score: 0.9232; val_best_f1_score: 0.9249; train_kl_reg_loss: 43486.1560; train_edge_recon_loss: 561219.8736; train_gene_expr_recon_loss: 17192078.7710; train_masked_gp_l1_reg_loss: 65610.0775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56010.4448; train_chrom_access_recon_loss: 5432061.1718; train_global_loss: 23350466.5802; train_optim_loss: 23350466.5802; val_kl_reg_loss: 41790.7070; val_edge_recon_loss: 567309.3625; val_gene_expr_recon_loss: 17333370.2000; val_masked_gp_l1_reg_loss: 65601.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55785.0234; val_chrom_access_recon_loss: 5415276.4333; val_global_loss: 23479134.4000; val_optim_loss: 23479134.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9671; val_auprc_score: 0.9571; val_best_acc_score: 0.9179; val_best_f1_score: 0.9219; train_kl_reg_loss: 43631.8603; train_edge_recon_loss: 561983.1861; train_gene_expr_recon_loss: 17185971.6260; train_masked_gp_l1_reg_loss: 65600.8995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55671.4328; train_chrom_access_recon_loss: 5431353.9313; train_global_loss: 23344212.9008; train_optim_loss: 23344212.9008; val_kl_reg_loss: 41668.5701; val_edge_recon_loss: 567780.8792; val_gene_expr_recon_loss: 17261297.9333; val_masked_gp_l1_reg_loss: 65591.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55391.3359; val_chrom_access_recon_loss: 5394472.3000; val_global_loss: 23386203.2000; val_optim_loss: 23386203.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9715; val_auprc_score: 0.9613; val_best_acc_score: 0.9237; val_best_f1_score: 0.9253; train_kl_reg_loss: 43608.1008; train_edge_recon_loss: 560495.5305; train_gene_expr_recon_loss: 17180069.2290; train_masked_gp_l1_reg_loss: 65597.0645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55194.1352; train_chrom_access_recon_loss: 5434083.6412; train_global_loss: 23339047.7863; train_optim_loss: 23339047.7863; val_kl_reg_loss: 41755.4555; val_edge_recon_loss: 565981.6500; val_gene_expr_recon_loss: 17277608.3333; val_masked_gp_l1_reg_loss: 65590.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55035.5391; val_chrom_access_recon_loss: 5418195.6000; val_global_loss: 23424166.9333; val_optim_loss: 23424166.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9706; val_auprc_score: 0.9633; val_best_acc_score: 0.9208; val_best_f1_score: 0.9234; train_kl_reg_loss: 43523.8676; train_edge_recon_loss: 561823.1212; train_gene_expr_recon_loss: 17178675.3282; train_masked_gp_l1_reg_loss: 65601.6401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54827.2968; train_chrom_access_recon_loss: 5429211.7023; train_global_loss: 23333663.1450; train_optim_loss: 23333663.1450; val_kl_reg_loss: 41613.7651; val_edge_recon_loss: 565883.5958; val_gene_expr_recon_loss: 17445357.4000; val_masked_gp_l1_reg_loss: 65588.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54641.0391; val_chrom_access_recon_loss: 5462857.4667; val_global_loss: 23635942.6667; val_optim_loss: 23635942.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9685; val_auprc_score: 0.9597; val_best_acc_score: 0.9197; val_best_f1_score: 0.9225; train_kl_reg_loss: 43515.2718; train_edge_recon_loss: 561276.6489; train_gene_expr_recon_loss: 17173032.2443; train_masked_gp_l1_reg_loss: 65591.5463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54456.2315; train_chrom_access_recon_loss: 5426262.6603; train_global_loss: 23324134.7176; train_optim_loss: 23324134.7176; val_kl_reg_loss: 41542.3690; val_edge_recon_loss: 567379.5167; val_gene_expr_recon_loss: 17235017.3333; val_masked_gp_l1_reg_loss: 65586.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54294.4570; val_chrom_access_recon_loss: 5404158.1333; val_global_loss: 23367977.8667; val_optim_loss: 23367977.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9726; val_auprc_score: 0.9659; val_best_acc_score: 0.9223; val_best_f1_score: 0.9250; train_kl_reg_loss: 43641.2374; train_edge_recon_loss: 560799.8402; train_gene_expr_recon_loss: 17175707.7328; train_masked_gp_l1_reg_loss: 65586.8649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54062.2623; train_chrom_access_recon_loss: 5431941.0382; train_global_loss: 23331738.9771; train_optim_loss: 23331738.9771; val_kl_reg_loss: 41807.1672; val_edge_recon_loss: 563760.6583; val_gene_expr_recon_loss: 17255101.0667; val_masked_gp_l1_reg_loss: 65583.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53884.9648; val_chrom_access_recon_loss: 5422951.3667; val_global_loss: 23403088.1333; val_optim_loss: 23403088.1333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9689; val_auprc_score: 0.9583; val_best_acc_score: 0.9202; val_best_f1_score: 0.9232; train_kl_reg_loss: 43689.9397; train_edge_recon_loss: 560931.4618; train_gene_expr_recon_loss: 17166061.9695; train_masked_gp_l1_reg_loss: 65583.3547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53734.6125; train_chrom_access_recon_loss: 5429234.8855; train_global_loss: 23319236.2595; train_optim_loss: 23319236.2595; val_kl_reg_loss: 41959.5966; val_edge_recon_loss: 564657.4958; val_gene_expr_recon_loss: 17305095.2000; val_masked_gp_l1_reg_loss: 65588.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53529.6484; val_chrom_access_recon_loss: 5412065.2333; val_global_loss: 23442895.3333; val_optim_loss: 23442895.3333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9685; val_auprc_score: 0.9573; val_best_acc_score: 0.9220; val_best_f1_score: 0.9255; train_kl_reg_loss: 43638.9296; train_edge_recon_loss: 560181.4709; train_gene_expr_recon_loss: 17168334.2214; train_masked_gp_l1_reg_loss: 65593.8052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53352.1112; train_chrom_access_recon_loss: 5422095.5344; train_global_loss: 23313195.8626; train_optim_loss: 23313195.8626; val_kl_reg_loss: 41809.2258; val_edge_recon_loss: 562860.2708; val_gene_expr_recon_loss: 17265759.6667; val_masked_gp_l1_reg_loss: 65593.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53149.8047; val_chrom_access_recon_loss: 5410524.3000; val_global_loss: 23399697.4667; val_optim_loss: 23399697.4667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9707; val_auprc_score: 0.9610; val_best_acc_score: 0.9278; val_best_f1_score: 0.9300; train_kl_reg_loss: 43459.2391; train_edge_recon_loss: 562083.1546; train_gene_expr_recon_loss: 17163152.1679; train_masked_gp_l1_reg_loss: 65593.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53009.3721; train_chrom_access_recon_loss: 5431581.1947; train_global_loss: 23318878.5344; train_optim_loss: 23318878.5344; val_kl_reg_loss: 41685.5591; val_edge_recon_loss: 565123.3333; val_gene_expr_recon_loss: 17307657.4000; val_masked_gp_l1_reg_loss: 65596.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52825.9141; val_chrom_access_recon_loss: 5418828.8333; val_global_loss: 23451717.2000; val_optim_loss: 23451717.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9700; val_auprc_score: 0.9622; val_best_acc_score: 0.9213; val_best_f1_score: 0.9244; train_kl_reg_loss: 43426.8487; train_edge_recon_loss: 561211.3230; train_gene_expr_recon_loss: 17159560.1603; train_masked_gp_l1_reg_loss: 65546.1550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51709.9886; train_chrom_access_recon_loss: 5427975.1908; train_global_loss: 23309429.6336; train_optim_loss: 23309429.6336; val_kl_reg_loss: 41542.7867; val_edge_recon_loss: 569411.5750; val_gene_expr_recon_loss: 17260147.8667; val_masked_gp_l1_reg_loss: 65519.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51524.7695; val_chrom_access_recon_loss: 5414985.0000; val_global_loss: 23403131.3333; val_optim_loss: 23403131.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9733; val_auprc_score: 0.9668; val_best_acc_score: 0.9252; val_best_f1_score: 0.9283; train_kl_reg_loss: 43472.8473; train_edge_recon_loss: 561015.2056; train_gene_expr_recon_loss: 17155708.1069; train_masked_gp_l1_reg_loss: 65511.6891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51461.0692; train_chrom_access_recon_loss: 5425352.2939; train_global_loss: 23302521.1756; train_optim_loss: 23302521.1756; val_kl_reg_loss: 41638.8005; val_edge_recon_loss: 563974.0125; val_gene_expr_recon_loss: 17312376.8000; val_masked_gp_l1_reg_loss: 65505.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51398.9961; val_chrom_access_recon_loss: 5431534.3000; val_global_loss: 23466428.0000; val_optim_loss: 23466428.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9672; val_auprc_score: 0.9578; val_best_acc_score: 0.9150; val_best_f1_score: 0.9192; train_kl_reg_loss: 43531.4790; train_edge_recon_loss: 562270.6670; train_gene_expr_recon_loss: 17167937.6336; train_masked_gp_l1_reg_loss: 65501.4791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51358.1616; train_chrom_access_recon_loss: 5432078.1260; train_global_loss: 23322677.4656; train_optim_loss: 23322677.4656; val_kl_reg_loss: 41787.7237; val_edge_recon_loss: 567857.4958; val_gene_expr_recon_loss: 17320542.1333; val_masked_gp_l1_reg_loss: 65498.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51309.5430; val_chrom_access_recon_loss: 5427780.0000; val_global_loss: 23474775.0667; val_optim_loss: 23474775.0667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9730; val_auprc_score: 0.9671; val_best_acc_score: 0.9243; val_best_f1_score: 0.9269; train_kl_reg_loss: 43534.1076; train_edge_recon_loss: 561765.1159; train_gene_expr_recon_loss: 17158719.5573; train_masked_gp_l1_reg_loss: 65494.3152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51277.2266; train_chrom_access_recon_loss: 5425416.9389; train_global_loss: 23306207.4809; train_optim_loss: 23306207.4809; val_kl_reg_loss: 42000.3831; val_edge_recon_loss: 563851.4167; val_gene_expr_recon_loss: 17313482.3333; val_masked_gp_l1_reg_loss: 65491.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51235.8945; val_chrom_access_recon_loss: 5424964.8667; val_global_loss: 23461026.9333; val_optim_loss: 23461026.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 59 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9723
val AUPRC score: 0.9649
val best accuracy score: 0.9229
val best F1 score: 0.9255
val target rna MSE score: 1.2680
val source rna MSE score: 0.5145
val target atac MSE score: 0.3322
val source atac MSE score: 0.1047
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
