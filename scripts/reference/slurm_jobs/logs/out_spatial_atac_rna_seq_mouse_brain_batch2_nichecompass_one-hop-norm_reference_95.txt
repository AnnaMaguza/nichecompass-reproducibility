[True]
Run timestamp: 26072023_025830_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9009; val_auprc_score: 0.9124; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10968.7507; train_edge_recon_loss: 3484840.2500; train_gene_expr_recon_loss: 31044144.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1092207.1250; train_global_loss: 35632160.0000; train_optim_loss: 35632160.0000; val_kl_reg_loss: 51024.1758; val_edge_recon_loss: 4066001.7500; val_gene_expr_recon_loss: 29775310.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1069307.8750; val_global_loss: 34961644.0000; val_optim_loss: 34961644.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8950; val_auprc_score: 0.9044; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 43349.7131; train_edge_recon_loss: 3536352.8611; train_gene_expr_recon_loss: 28608344.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1081778.0139; train_global_loss: 33269824.6667; train_optim_loss: 33269824.6667; val_kl_reg_loss: 53905.3516; val_edge_recon_loss: 4065896.5000; val_gene_expr_recon_loss: 27871488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1055565.0000; val_global_loss: 33046856.0000; val_optim_loss: 33046856.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8871; val_auprc_score: 0.8916; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 75355.0221; train_edge_recon_loss: 3561065.3056; train_gene_expr_recon_loss: 26395000.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052976.0625; train_global_loss: 31084397.5556; train_optim_loss: 31084397.5556; val_kl_reg_loss: 95719.7344; val_edge_recon_loss: 4065891.5000; val_gene_expr_recon_loss: 25911402.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1035289.7500; val_global_loss: 31108304.0000; val_optim_loss: 31108304.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8810; val_auprc_score: 0.8858; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 107781.6979; train_edge_recon_loss: 3588521.2500; train_gene_expr_recon_loss: 24667520.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1026373.6944; train_global_loss: 29390197.1111; train_optim_loss: 29390197.1111; val_kl_reg_loss: 139701.7812; val_edge_recon_loss: 4065879.5000; val_gene_expr_recon_loss: 24452958.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015620.5000; val_global_loss: 29674160.0000; val_optim_loss: 29674160.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8730; val_auprc_score: 0.8783; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 145752.3872; train_edge_recon_loss: 3617558.3333; train_gene_expr_recon_loss: 23547241.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014316.0486; train_global_loss: 28324869.1111; train_optim_loss: 28324869.1111; val_kl_reg_loss: 128036.1797; val_edge_recon_loss: 4065827.2500; val_gene_expr_recon_loss: 23540878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004683.2500; val_global_loss: 28739426.0000; val_optim_loss: 28739426.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8804; val_auprc_score: 0.8857; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 144857.3915; train_edge_recon_loss: 3614467.7222; train_gene_expr_recon_loss: 22830017.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002289.1111; train_global_loss: 27591631.3333; train_optim_loss: 27591631.3333; val_kl_reg_loss: 151076.7500; val_edge_recon_loss: 4065718.2500; val_gene_expr_recon_loss: 22996932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998941.1250; val_global_loss: 28212670.0000; val_optim_loss: 28212670.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8846; val_auprc_score: 0.8855; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 164402.0521; train_edge_recon_loss: 3611932.0278; train_gene_expr_recon_loss: 22160214.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998544.7153; train_global_loss: 26935093.1111; train_optim_loss: 26935093.1111; val_kl_reg_loss: 146850.3906; val_edge_recon_loss: 4065734.7500; val_gene_expr_recon_loss: 22447248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991000.1250; val_global_loss: 27650832.0000; val_optim_loss: 27650832.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8880; val_auprc_score: 0.8875; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 176533.7483; train_edge_recon_loss: 3609961.5556; train_gene_expr_recon_loss: 21817828.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988510.6389; train_global_loss: 26592834.6667; train_optim_loss: 26592834.6667; val_kl_reg_loss: 164038.4062; val_edge_recon_loss: 4065458.7500; val_gene_expr_recon_loss: 22065782.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987833.2500; val_global_loss: 27283114.0000; val_optim_loss: 27283114.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8836; val_auprc_score: 0.8788; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 181988.1406; train_edge_recon_loss: 3615537.3611; train_gene_expr_recon_loss: 21590004.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987132.4306; train_global_loss: 26374663.1111; train_optim_loss: 26374663.1111; val_kl_reg_loss: 165708.4062; val_edge_recon_loss: 4064937.5000; val_gene_expr_recon_loss: 21821038.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983005.7500; val_global_loss: 27034690.0000; val_optim_loss: 27034690.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8872; val_auprc_score: 0.8818; val_best_acc_score: 0.5195; val_best_f1_score: 0.6752; train_kl_reg_loss: 187916.0087; train_edge_recon_loss: 3610205.5278; train_gene_expr_recon_loss: 21378202.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982585.3056; train_global_loss: 26158909.1111; train_optim_loss: 26158909.1111; val_kl_reg_loss: 154498.3906; val_edge_recon_loss: 4063830.7500; val_gene_expr_recon_loss: 21652210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981138.0625; val_global_loss: 26851678.0000; val_optim_loss: 26851678.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8857; val_auprc_score: 0.8767; val_best_acc_score: 0.5591; val_best_f1_score: 0.6932; train_kl_reg_loss: 178916.8385; train_edge_recon_loss: 3607254.8611; train_gene_expr_recon_loss: 21040724.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976349.4028; train_global_loss: 25803245.5556; train_optim_loss: 25803245.5556; val_kl_reg_loss: 172579.0000; val_edge_recon_loss: 4061972.0000; val_gene_expr_recon_loss: 21549854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978359.1875; val_global_loss: 26762764.0000; val_optim_loss: 26762764.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8913; val_auprc_score: 0.8820; val_best_acc_score: 0.6245; val_best_f1_score: 0.7247; train_kl_reg_loss: 181310.3993; train_edge_recon_loss: 3592869.5278; train_gene_expr_recon_loss: 21034896.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979981.7778; train_global_loss: 25789058.4444; train_optim_loss: 25789058.4444; val_kl_reg_loss: 155611.6562; val_edge_recon_loss: 4058614.2500; val_gene_expr_recon_loss: 21493968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978005.8750; val_global_loss: 26686200.0000; val_optim_loss: 26686200.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8902; val_auprc_score: 0.8809; val_best_acc_score: 0.6780; val_best_f1_score: 0.7519; train_kl_reg_loss: 177049.8073; train_edge_recon_loss: 3588423.4722; train_gene_expr_recon_loss: 20974290.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978873.9931; train_global_loss: 25718637.7778; train_optim_loss: 25718637.7778; val_kl_reg_loss: 148511.1094; val_edge_recon_loss: 4054510.5000; val_gene_expr_recon_loss: 21403680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976272.4375; val_global_loss: 26582974.0000; val_optim_loss: 26582974.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8908; val_auprc_score: 0.8814; val_best_acc_score: 0.7357; val_best_f1_score: 0.7840; train_kl_reg_loss: 170900.7917; train_edge_recon_loss: 3584810.5000; train_gene_expr_recon_loss: 20970525.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977962.1875; train_global_loss: 25704198.8889; train_optim_loss: 25704198.8889; val_kl_reg_loss: 148027.5625; val_edge_recon_loss: 4047584.0000; val_gene_expr_recon_loss: 21356116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974650.3125; val_global_loss: 26526378.0000; val_optim_loss: 26526378.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8913; val_auprc_score: 0.8788; val_best_acc_score: 0.7738; val_best_f1_score: 0.8051; train_kl_reg_loss: 169732.4115; train_edge_recon_loss: 3573825.8611; train_gene_expr_recon_loss: 20822749.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970853.8819; train_global_loss: 25537162.2222; train_optim_loss: 25537162.2222; val_kl_reg_loss: 133762.9688; val_edge_recon_loss: 4038842.2500; val_gene_expr_recon_loss: 21308050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974665.0625; val_global_loss: 26455322.0000; val_optim_loss: 26455322.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8937; val_auprc_score: 0.8842; val_best_acc_score: 0.7992; val_best_f1_score: 0.8196; train_kl_reg_loss: 161163.4844; train_edge_recon_loss: 3576245.4444; train_gene_expr_recon_loss: 20732806.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970240.4444; train_global_loss: 25440456.0000; train_optim_loss: 25440456.0000; val_kl_reg_loss: 152055.6562; val_edge_recon_loss: 4030192.5000; val_gene_expr_recon_loss: 21260906.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972881.6875; val_global_loss: 26416036.0000; val_optim_loss: 26416036.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9002; val_auprc_score: 0.8893; val_best_acc_score: 0.8262; val_best_f1_score: 0.8337; train_kl_reg_loss: 162688.1007; train_edge_recon_loss: 3560576.3889; train_gene_expr_recon_loss: 20640130.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966261.3542; train_global_loss: 25329656.2222; train_optim_loss: 25329656.2222; val_kl_reg_loss: 146912.7031; val_edge_recon_loss: 4016084.0000; val_gene_expr_recon_loss: 21200552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971386.3750; val_global_loss: 26334934.0000; val_optim_loss: 26334934.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9018; val_auprc_score: 0.8901; val_best_acc_score: 0.8308; val_best_f1_score: 0.8300; train_kl_reg_loss: 158217.9427; train_edge_recon_loss: 3558273.3611; train_gene_expr_recon_loss: 20834783.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972203.3333; train_global_loss: 25523478.4444; train_optim_loss: 25523478.4444; val_kl_reg_loss: 128614.3672; val_edge_recon_loss: 3992303.0000; val_gene_expr_recon_loss: 21188852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971302.9375; val_global_loss: 26281072.0000; val_optim_loss: 26281072.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9041; val_auprc_score: 0.8916; val_best_acc_score: 0.8236; val_best_f1_score: 0.8141; train_kl_reg_loss: 151735.9540; train_edge_recon_loss: 3551503.5000; train_gene_expr_recon_loss: 20698384.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968118.4722; train_global_loss: 25369743.3333; train_optim_loss: 25369743.3333; val_kl_reg_loss: 129464.1641; val_edge_recon_loss: 3963937.7500; val_gene_expr_recon_loss: 21157438.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970285.1250; val_global_loss: 26221126.0000; val_optim_loss: 26221126.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9101; val_auprc_score: 0.9019; val_best_acc_score: 0.8118; val_best_f1_score: 0.8150; train_kl_reg_loss: 146754.4028; train_edge_recon_loss: 3542232.2222; train_gene_expr_recon_loss: 20702186.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971552.1597; train_global_loss: 25362725.5556; train_optim_loss: 25362725.5556; val_kl_reg_loss: 130659.7344; val_edge_recon_loss: 3927171.5000; val_gene_expr_recon_loss: 21087434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966993.8125; val_global_loss: 26112260.0000; val_optim_loss: 26112260.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9056; val_auprc_score: 0.8926; val_best_acc_score: 0.8137; val_best_f1_score: 0.8331; train_kl_reg_loss: 142466.0799; train_edge_recon_loss: 3524015.9444; train_gene_expr_recon_loss: 20561425.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958911.8403; train_global_loss: 25186819.3333; train_optim_loss: 25186819.3333; val_kl_reg_loss: 125110.7812; val_edge_recon_loss: 3864040.2500; val_gene_expr_recon_loss: 21081488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967747.5000; val_global_loss: 26038388.0000; val_optim_loss: 26038388.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9085; val_auprc_score: 0.8981; val_best_acc_score: 0.8289; val_best_f1_score: 0.8403; train_kl_reg_loss: 138635.1450; train_edge_recon_loss: 3503506.3333; train_gene_expr_recon_loss: 20690652.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969855.7639; train_global_loss: 25302649.5556; train_optim_loss: 25302649.5556; val_kl_reg_loss: 107944.3750; val_edge_recon_loss: 3773022.5000; val_gene_expr_recon_loss: 21068006.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968767.4375; val_global_loss: 25917740.0000; val_optim_loss: 25917740.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9054; val_auprc_score: 0.8900; val_best_acc_score: 0.8259; val_best_f1_score: 0.8324; train_kl_reg_loss: 124700.6476; train_edge_recon_loss: 3475260.3056; train_gene_expr_recon_loss: 20532828.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963342.3819; train_global_loss: 25096131.7778; train_optim_loss: 25096131.7778; val_kl_reg_loss: 110200.5938; val_edge_recon_loss: 3664640.2500; val_gene_expr_recon_loss: 21052988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966841.0625; val_global_loss: 25794670.0000; val_optim_loss: 25794670.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9075; val_auprc_score: 0.8878; val_best_acc_score: 0.8271; val_best_f1_score: 0.8385; train_kl_reg_loss: 124016.8273; train_edge_recon_loss: 3409062.4444; train_gene_expr_recon_loss: 20600097.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966680.1389; train_global_loss: 25099857.1111; train_optim_loss: 25099857.1111; val_kl_reg_loss: 112712.5469; val_edge_recon_loss: 3487513.0000; val_gene_expr_recon_loss: 21055510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968138.8750; val_global_loss: 25623874.0000; val_optim_loss: 25623874.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9138; val_auprc_score: 0.9000; val_best_acc_score: 0.8327; val_best_f1_score: 0.8375; train_kl_reg_loss: 121207.5069; train_edge_recon_loss: 3328603.0278; train_gene_expr_recon_loss: 20630188.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966998.0486; train_global_loss: 25046997.3333; train_optim_loss: 25046997.3333; val_kl_reg_loss: 119082.4531; val_edge_recon_loss: 3315447.5000; val_gene_expr_recon_loss: 21024912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966299.3125; val_global_loss: 25425742.0000; val_optim_loss: 25425742.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9107; val_auprc_score: 0.8968; val_best_acc_score: 0.8255; val_best_f1_score: 0.8341; train_kl_reg_loss: 126948.6215; train_edge_recon_loss: 3538029.9444; train_gene_expr_recon_loss: 20967372.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965413.5833; train_global_loss: 25597764.2222; train_optim_loss: 25597764.2222; val_kl_reg_loss: 60792.7969; val_edge_recon_loss: 3553698.7500; val_gene_expr_recon_loss: 21589844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970218.5000; val_global_loss: 26174554.0000; val_optim_loss: 26174554.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9172; val_auprc_score: 0.9063; val_best_acc_score: 0.8275; val_best_f1_score: 0.8393; train_kl_reg_loss: 115018.8359; train_edge_recon_loss: 3502710.7222; train_gene_expr_recon_loss: 21138569.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965340.9236; train_global_loss: 25721639.7778; train_optim_loss: 25721639.7778; val_kl_reg_loss: 55222.5273; val_edge_recon_loss: 3621947.5000; val_gene_expr_recon_loss: 21502500.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969055.7500; val_global_loss: 26148726.0000; val_optim_loss: 26148726.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9075; val_auprc_score: 0.8915; val_best_acc_score: 0.8135; val_best_f1_score: 0.8298; train_kl_reg_loss: 84785.3377; train_edge_recon_loss: 3528844.2500; train_gene_expr_recon_loss: 21103074.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968407.8681; train_global_loss: 25685111.7778; train_optim_loss: 25685111.7778; val_kl_reg_loss: 59566.0742; val_edge_recon_loss: 3670051.0000; val_gene_expr_recon_loss: 21471520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966886.0000; val_global_loss: 26168022.0000; val_optim_loss: 26168022.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9120; val_auprc_score: 0.8963; val_best_acc_score: 0.8246; val_best_f1_score: 0.8387; train_kl_reg_loss: 70360.8086; train_edge_recon_loss: 3545675.2500; train_gene_expr_recon_loss: 21705945.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970142.6181; train_global_loss: 26292124.6667; train_optim_loss: 26292124.6667; val_kl_reg_loss: 41710.4766; val_edge_recon_loss: 3635304.5000; val_gene_expr_recon_loss: 21519458.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967819.0000; val_global_loss: 26164292.0000; val_optim_loss: 26164292.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9181; val_auprc_score: 0.9081; val_best_acc_score: 0.8273; val_best_f1_score: 0.8411; train_kl_reg_loss: 58755.8932; train_edge_recon_loss: 3547831.8611; train_gene_expr_recon_loss: 20959515.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965840.3472; train_global_loss: 25531943.5556; train_optim_loss: 25531943.5556; val_kl_reg_loss: 43108.4180; val_edge_recon_loss: 3631307.2500; val_gene_expr_recon_loss: 21513786.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967949.4375; val_global_loss: 26156152.0000; val_optim_loss: 26156152.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9111; val_auprc_score: 0.8936; val_best_acc_score: 0.8217; val_best_f1_score: 0.8370; train_kl_reg_loss: 66577.5078; train_edge_recon_loss: 3527097.0000; train_gene_expr_recon_loss: 21128433.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976291.2639; train_global_loss: 25698399.1111; train_optim_loss: 25698399.1111; val_kl_reg_loss: 52338.2734; val_edge_recon_loss: 3636624.7500; val_gene_expr_recon_loss: 21421918.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965771.2500; val_global_loss: 26076652.0000; val_optim_loss: 26076652.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9131; val_auprc_score: 0.8990; val_best_acc_score: 0.8208; val_best_f1_score: 0.8361; train_kl_reg_loss: 74702.9106; train_edge_recon_loss: 3509269.5278; train_gene_expr_recon_loss: 20941846.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962450.7083; train_global_loss: 25488269.7778; train_optim_loss: 25488269.7778; val_kl_reg_loss: 56521.8672; val_edge_recon_loss: 3632572.5000; val_gene_expr_recon_loss: 21402412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965488.2500; val_global_loss: 26056994.0000; val_optim_loss: 26056994.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9144; val_auprc_score: 0.9010; val_best_acc_score: 0.8246; val_best_f1_score: 0.8385; train_kl_reg_loss: 79024.7517; train_edge_recon_loss: 3505516.0833; train_gene_expr_recon_loss: 20921444.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965716.9792; train_global_loss: 25471701.7778; train_optim_loss: 25471701.7778; val_kl_reg_loss: 58288.2578; val_edge_recon_loss: 3628182.7500; val_gene_expr_recon_loss: 21390776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965113.8125; val_global_loss: 26042362.0000; val_optim_loss: 26042362.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9147
Val AUPRC score: 0.9028
Val best accuracy score: 0.8335
Val best F1 score: 0.8434
Val gene expr MSE score: 0.5585
Val chrom access MSE score: 0.0868
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
