[True]
Run timestamp: 07092023_193946_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3433 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7954, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7533; val_auprc_score: 0.7763; val_best_acc_score: 0.5209; val_best_f1_score: 0.6745; train_kl_reg_loss: 104899.4613; train_edge_recon_loss: 3650434.8511; train_gene_expr_recon_loss: 28718700.3969; train_masked_gp_l1_reg_loss: 207866.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6427442.2896; train_chrom_access_recon_loss: 15992604.6565; train_global_loss: 55101948.1221; train_optim_loss: 55101948.1221; val_kl_reg_loss: 94966.3510; val_edge_recon_loss: 4063853.1167; val_gene_expr_recon_loss: 26089638.1333; val_masked_gp_l1_reg_loss: 189661.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 825323.0000; val_chrom_access_recon_loss: 15024313.6667; val_global_loss: 46287756.5333; val_optim_loss: 46287756.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8089; val_auprc_score: 0.8282; val_best_acc_score: 0.7022; val_best_f1_score: 0.7365; train_kl_reg_loss: 132616.2873; train_edge_recon_loss: 3557984.9847; train_gene_expr_recon_loss: 26164547.3740; train_masked_gp_l1_reg_loss: 179890.4430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 451231.4742; train_chrom_access_recon_loss: 15174977.0611; train_global_loss: 45661247.4809; train_optim_loss: 45661247.4809; val_kl_reg_loss: 131208.0536; val_edge_recon_loss: 4039628.3667; val_gene_expr_recon_loss: 25533661.0667; val_masked_gp_l1_reg_loss: 175470.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 289784.0938; val_chrom_access_recon_loss: 14904624.0000; val_global_loss: 45074374.9333; val_optim_loss: 45074374.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8690; val_auprc_score: 0.8611; val_best_acc_score: 0.7885; val_best_f1_score: 0.8087; train_kl_reg_loss: 119451.3681; train_edge_recon_loss: 3480195.3378; train_gene_expr_recon_loss: 25713719.7099; train_masked_gp_l1_reg_loss: 177338.8936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244590.9841; train_chrom_access_recon_loss: 14938683.4656; train_global_loss: 44673979.8473; train_optim_loss: 44673979.8473; val_kl_reg_loss: 114945.2161; val_edge_recon_loss: 3337853.7000; val_gene_expr_recon_loss: 25144225.6000; val_masked_gp_l1_reg_loss: 183160.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215131.5000; val_chrom_access_recon_loss: 14634772.2667; val_global_loss: 43630088.8000; val_optim_loss: 43630088.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8854; val_auprc_score: 0.8744; val_best_acc_score: 0.7858; val_best_f1_score: 0.8074; train_kl_reg_loss: 146482.8370; train_edge_recon_loss: 3056756.4332; train_gene_expr_recon_loss: 25423997.7405; train_masked_gp_l1_reg_loss: 188110.9101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200894.4177; train_chrom_access_recon_loss: 14750463.5420; train_global_loss: 43766705.6794; train_optim_loss: 43766705.6794; val_kl_reg_loss: 149140.5885; val_edge_recon_loss: 2994301.5000; val_gene_expr_recon_loss: 24767890.8000; val_masked_gp_l1_reg_loss: 190528.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189336.2969; val_chrom_access_recon_loss: 14418913.0000; val_global_loss: 42710110.4000; val_optim_loss: 42710110.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8966; val_auprc_score: 0.8858; val_best_acc_score: 0.8037; val_best_f1_score: 0.8189; train_kl_reg_loss: 150621.3923; train_edge_recon_loss: 2978455.7500; train_gene_expr_recon_loss: 25174031.5725; train_masked_gp_l1_reg_loss: 192641.1738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181776.3746; train_chrom_access_recon_loss: 14604641.4275; train_global_loss: 43282167.8168; train_optim_loss: 43282167.8168; val_kl_reg_loss: 142141.5448; val_edge_recon_loss: 2962136.5833; val_gene_expr_recon_loss: 24530532.0000; val_masked_gp_l1_reg_loss: 194767.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175331.9531; val_chrom_access_recon_loss: 14275833.5333; val_global_loss: 42280743.2000; val_optim_loss: 42280743.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9094; val_auprc_score: 0.8980; val_best_acc_score: 0.8254; val_best_f1_score: 0.8358; train_kl_reg_loss: 146657.1151; train_edge_recon_loss: 2954553.2767; train_gene_expr_recon_loss: 24938098.8244; train_masked_gp_l1_reg_loss: 196366.0219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171004.2638; train_chrom_access_recon_loss: 14468212.3206; train_global_loss: 42874891.5420; train_optim_loss: 42874891.5420; val_kl_reg_loss: 150043.9573; val_edge_recon_loss: 2923230.3167; val_gene_expr_recon_loss: 24379197.7333; val_masked_gp_l1_reg_loss: 198649.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167435.4219; val_chrom_access_recon_loss: 14186327.0000; val_global_loss: 42004885.0667; val_optim_loss: 42004885.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9273; val_auprc_score: 0.9148; val_best_acc_score: 0.8519; val_best_f1_score: 0.8630; train_kl_reg_loss: 145546.7375; train_edge_recon_loss: 2911693.7519; train_gene_expr_recon_loss: 24727877.1756; train_masked_gp_l1_reg_loss: 200055.2022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163989.8575; train_chrom_access_recon_loss: 14349023.3206; train_global_loss: 42498186.0153; train_optim_loss: 42498186.0153; val_kl_reg_loss: 146622.5625; val_edge_recon_loss: 2892784.7500; val_gene_expr_recon_loss: 24228785.7333; val_masked_gp_l1_reg_loss: 201986.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161936.2812; val_chrom_access_recon_loss: 14145470.4667; val_global_loss: 41777585.8667; val_optim_loss: 41777585.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9347; val_auprc_score: 0.9211; val_best_acc_score: 0.8632; val_best_f1_score: 0.8728; train_kl_reg_loss: 147534.7948; train_edge_recon_loss: 2855920.9256; train_gene_expr_recon_loss: 24563869.6947; train_masked_gp_l1_reg_loss: 203524.5045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159816.8473; train_chrom_access_recon_loss: 14239604.7634; train_global_loss: 42170271.7863; train_optim_loss: 42170271.7863; val_kl_reg_loss: 146292.5063; val_edge_recon_loss: 2857497.6833; val_gene_expr_recon_loss: 24123561.6000; val_masked_gp_l1_reg_loss: 205092.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159058.1719; val_chrom_access_recon_loss: 14038239.2000; val_global_loss: 41529741.0667; val_optim_loss: 41529741.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9465; val_auprc_score: 0.9361; val_best_acc_score: 0.8848; val_best_f1_score: 0.8894; train_kl_reg_loss: 146097.0816; train_edge_recon_loss: 2836943.3340; train_gene_expr_recon_loss: 24407551.8626; train_masked_gp_l1_reg_loss: 206294.9858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157355.7858; train_chrom_access_recon_loss: 14139923.9084; train_global_loss: 41894167.1145; train_optim_loss: 41894167.1145; val_kl_reg_loss: 149660.2448; val_edge_recon_loss: 2824047.1500; val_gene_expr_recon_loss: 23841024.4000; val_masked_gp_l1_reg_loss: 207543.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156922.0312; val_chrom_access_recon_loss: 13876711.6000; val_global_loss: 41055909.0667; val_optim_loss: 41055909.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9465; val_auprc_score: 0.9353; val_best_acc_score: 0.8833; val_best_f1_score: 0.8881; train_kl_reg_loss: 146054.0835; train_edge_recon_loss: 2820383.9656; train_gene_expr_recon_loss: 24256183.8473; train_masked_gp_l1_reg_loss: 208250.3780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156135.3133; train_chrom_access_recon_loss: 14035958.6565; train_global_loss: 41622966.3206; train_optim_loss: 41622966.3206; val_kl_reg_loss: 144504.9875; val_edge_recon_loss: 2821195.2667; val_gene_expr_recon_loss: 23852258.4000; val_masked_gp_l1_reg_loss: 209447.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155441.7969; val_chrom_access_recon_loss: 13891578.0000; val_global_loss: 41074426.9333; val_optim_loss: 41074426.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9516; val_auprc_score: 0.9408; val_best_acc_score: 0.8882; val_best_f1_score: 0.8930; train_kl_reg_loss: 142221.1758; train_edge_recon_loss: 2814907.3149; train_gene_expr_recon_loss: 24144258.9008; train_masked_gp_l1_reg_loss: 210212.0539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155291.5474; train_chrom_access_recon_loss: 13964454.4580; train_global_loss: 41431345.5573; train_optim_loss: 41431345.5573; val_kl_reg_loss: 140287.0667; val_edge_recon_loss: 2822213.7000; val_gene_expr_recon_loss: 23633863.7333; val_masked_gp_l1_reg_loss: 210940.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155867.8281; val_chrom_access_recon_loss: 13748024.1333; val_global_loss: 40711197.0667; val_optim_loss: 40711197.0667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9538; val_auprc_score: 0.9428; val_best_acc_score: 0.8937; val_best_f1_score: 0.8988; train_kl_reg_loss: 142125.2647; train_edge_recon_loss: 2792187.4695; train_gene_expr_recon_loss: 24014498.8092; train_masked_gp_l1_reg_loss: 211998.6104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155089.1405; train_chrom_access_recon_loss: 13889163.3969; train_global_loss: 41205062.2901; train_optim_loss: 41205062.2901; val_kl_reg_loss: 142171.8021; val_edge_recon_loss: 2802377.8000; val_gene_expr_recon_loss: 23580872.2667; val_masked_gp_l1_reg_loss: 212864.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154743.2188; val_chrom_access_recon_loss: 13682196.7333; val_global_loss: 40575226.4000; val_optim_loss: 40575226.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9561; val_auprc_score: 0.9431; val_best_acc_score: 0.8949; val_best_f1_score: 0.8987; train_kl_reg_loss: 141241.8459; train_edge_recon_loss: 2793726.8302; train_gene_expr_recon_loss: 23920760.9771; train_masked_gp_l1_reg_loss: 213488.7031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153653.4135; train_chrom_access_recon_loss: 13827349.1374; train_global_loss: 41050220.9466; train_optim_loss: 41050220.9466; val_kl_reg_loss: 139972.0896; val_edge_recon_loss: 2799092.1500; val_gene_expr_recon_loss: 23495913.4667; val_masked_gp_l1_reg_loss: 214526.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153695.7031; val_chrom_access_recon_loss: 13614250.0667; val_global_loss: 40417449.3333; val_optim_loss: 40417449.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9552; val_auprc_score: 0.9447; val_best_acc_score: 0.8971; val_best_f1_score: 0.9015; train_kl_reg_loss: 140640.3872; train_edge_recon_loss: 2787139.1508; train_gene_expr_recon_loss: 23823086.0458; train_masked_gp_l1_reg_loss: 215047.4227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152917.3311; train_chrom_access_recon_loss: 13759595.9237; train_global_loss: 40878426.4427; train_optim_loss: 40878426.4427; val_kl_reg_loss: 141963.6146; val_edge_recon_loss: 2799079.2500; val_gene_expr_recon_loss: 23462988.5333; val_masked_gp_l1_reg_loss: 215841.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153529.1562; val_chrom_access_recon_loss: 13568630.8000; val_global_loss: 40342034.4000; val_optim_loss: 40342034.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9575; val_auprc_score: 0.9460; val_best_acc_score: 0.8988; val_best_f1_score: 0.9018; train_kl_reg_loss: 140624.6345; train_edge_recon_loss: 2776144.1927; train_gene_expr_recon_loss: 23747152.9466; train_masked_gp_l1_reg_loss: 216035.3853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151453.4020; train_chrom_access_recon_loss: 13714993.8702; train_global_loss: 40746404.1832; train_optim_loss: 40746404.1832; val_kl_reg_loss: 138961.1667; val_edge_recon_loss: 2793850.6833; val_gene_expr_recon_loss: 23310849.4667; val_masked_gp_l1_reg_loss: 216370.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150482.6094; val_chrom_access_recon_loss: 13473049.1333; val_global_loss: 40083562.4000; val_optim_loss: 40083562.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9642; val_auprc_score: 0.9580; val_best_acc_score: 0.9014; val_best_f1_score: 0.9058; train_kl_reg_loss: 138821.0600; train_edge_recon_loss: 2768876.9866; train_gene_expr_recon_loss: 23676152.0153; train_masked_gp_l1_reg_loss: 217030.1211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150354.5484; train_chrom_access_recon_loss: 13660203.0153; train_global_loss: 40611437.7710; train_optim_loss: 40611437.7710; val_kl_reg_loss: 141114.8708; val_edge_recon_loss: 2779251.1500; val_gene_expr_recon_loss: 23191664.9333; val_masked_gp_l1_reg_loss: 217520.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150203.1562; val_chrom_access_recon_loss: 13521100.4667; val_global_loss: 40000855.7333; val_optim_loss: 40000855.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9630; val_auprc_score: 0.9537; val_best_acc_score: 0.9070; val_best_f1_score: 0.9112; train_kl_reg_loss: 138187.9451; train_edge_recon_loss: 2771745.9485; train_gene_expr_recon_loss: 23599128.5954; train_masked_gp_l1_reg_loss: 218075.2920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149478.2122; train_chrom_access_recon_loss: 13606152.4122; train_global_loss: 40482768.3053; train_optim_loss: 40482768.3053; val_kl_reg_loss: 134675.5641; val_edge_recon_loss: 2777654.7667; val_gene_expr_recon_loss: 23100396.6667; val_masked_gp_l1_reg_loss: 218791.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149855.2812; val_chrom_access_recon_loss: 13395961.4667; val_global_loss: 39777336.2667; val_optim_loss: 39777336.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9668; val_auprc_score: 0.9585; val_best_acc_score: 0.9109; val_best_f1_score: 0.9148; train_kl_reg_loss: 136629.6268; train_edge_recon_loss: 2765252.0821; train_gene_expr_recon_loss: 23533550.5038; train_masked_gp_l1_reg_loss: 218964.1314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148736.4866; train_chrom_access_recon_loss: 13559182.9695; train_global_loss: 40362315.7863; train_optim_loss: 40362315.7863; val_kl_reg_loss: 136369.7323; val_edge_recon_loss: 2772744.2000; val_gene_expr_recon_loss: 23163726.5333; val_masked_gp_l1_reg_loss: 219269.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147976.1719; val_chrom_access_recon_loss: 13355263.0667; val_global_loss: 39795349.3333; val_optim_loss: 39795349.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9695; val_auprc_score: 0.9622; val_best_acc_score: 0.9162; val_best_f1_score: 0.9196; train_kl_reg_loss: 136858.2774; train_edge_recon_loss: 2761835.9046; train_gene_expr_recon_loss: 23495790.3817; train_masked_gp_l1_reg_loss: 219627.3498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148206.6808; train_chrom_access_recon_loss: 13534372.2061; train_global_loss: 40296690.5649; train_optim_loss: 40296690.5649; val_kl_reg_loss: 133669.8089; val_edge_recon_loss: 2765692.1833; val_gene_expr_recon_loss: 23112086.8000; val_masked_gp_l1_reg_loss: 219328.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147036.7812; val_chrom_access_recon_loss: 13389568.6000; val_global_loss: 39767381.0667; val_optim_loss: 39767381.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9690; val_auprc_score: 0.9615; val_best_acc_score: 0.9165; val_best_f1_score: 0.9189; train_kl_reg_loss: 135885.7129; train_edge_recon_loss: 2755876.8740; train_gene_expr_recon_loss: 23397020.1985; train_masked_gp_l1_reg_loss: 220219.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147352.3005; train_chrom_access_recon_loss: 13463691.4504; train_global_loss: 40120045.9237; train_optim_loss: 40120045.9237; val_kl_reg_loss: 136247.7734; val_edge_recon_loss: 2759149.7000; val_gene_expr_recon_loss: 22960895.4667; val_masked_gp_l1_reg_loss: 220605.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147848.2969; val_chrom_access_recon_loss: 13280649.9333; val_global_loss: 39505396.5333; val_optim_loss: 39505396.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9695; val_auprc_score: 0.9568; val_best_acc_score: 0.9213; val_best_f1_score: 0.9233; train_kl_reg_loss: 135081.8811; train_edge_recon_loss: 2755896.5363; train_gene_expr_recon_loss: 23368588.4733; train_masked_gp_l1_reg_loss: 220812.3812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146986.7253; train_chrom_access_recon_loss: 13449274.8015; train_global_loss: 40076640.7328; train_optim_loss: 40076640.7328; val_kl_reg_loss: 136358.3417; val_edge_recon_loss: 2750174.2667; val_gene_expr_recon_loss: 22893764.6667; val_masked_gp_l1_reg_loss: 221541.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147795.9688; val_chrom_access_recon_loss: 13206975.5333; val_global_loss: 39356610.6667; val_optim_loss: 39356610.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9708; val_auprc_score: 0.9633; val_best_acc_score: 0.9189; val_best_f1_score: 0.9219; train_kl_reg_loss: 134271.1219; train_edge_recon_loss: 2756353.0420; train_gene_expr_recon_loss: 23341478.7023; train_masked_gp_l1_reg_loss: 221509.1564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147125.2189; train_chrom_access_recon_loss: 13420928.5038; train_global_loss: 40021666.0153; train_optim_loss: 40021666.0153; val_kl_reg_loss: 134467.7625; val_edge_recon_loss: 2768706.8833; val_gene_expr_recon_loss: 22924116.1333; val_masked_gp_l1_reg_loss: 222165.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147494.8438; val_chrom_access_recon_loss: 13254499.6667; val_global_loss: 39451450.6667; val_optim_loss: 39451450.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9713; val_auprc_score: 0.9633; val_best_acc_score: 0.9213; val_best_f1_score: 0.9234; train_kl_reg_loss: 134317.9160; train_edge_recon_loss: 2751840.4008; train_gene_expr_recon_loss: 23267888.9466; train_masked_gp_l1_reg_loss: 222133.2461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146869.2487; train_chrom_access_recon_loss: 13371393.8321; train_global_loss: 39894443.7557; train_optim_loss: 39894443.7557; val_kl_reg_loss: 132033.0896; val_edge_recon_loss: 2759768.0333; val_gene_expr_recon_loss: 22846492.5333; val_masked_gp_l1_reg_loss: 222624.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147491.4844; val_chrom_access_recon_loss: 13202104.0667; val_global_loss: 39310513.6000; val_optim_loss: 39310513.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9631; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 134165.2129; train_edge_recon_loss: 2747630.8206; train_gene_expr_recon_loss: 23229238.1527; train_masked_gp_l1_reg_loss: 222552.2180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147054.7609; train_chrom_access_recon_loss: 13344075.6107; train_global_loss: 39824716.7634; train_optim_loss: 39824716.7634; val_kl_reg_loss: 136291.1458; val_edge_recon_loss: 2769068.6167; val_gene_expr_recon_loss: 22764266.5333; val_masked_gp_l1_reg_loss: 222587.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146898.3438; val_chrom_access_recon_loss: 13133431.0667; val_global_loss: 39172543.7333; val_optim_loss: 39172543.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9719; val_auprc_score: 0.9613; val_best_acc_score: 0.9208; val_best_f1_score: 0.9237; train_kl_reg_loss: 135076.3992; train_edge_recon_loss: 2745611.4313; train_gene_expr_recon_loss: 23193531.3130; train_masked_gp_l1_reg_loss: 222671.3929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146802.3802; train_chrom_access_recon_loss: 13327616.6260; train_global_loss: 39771309.3435; train_optim_loss: 39771309.3435; val_kl_reg_loss: 136294.1823; val_edge_recon_loss: 2772441.7833; val_gene_expr_recon_loss: 22884232.2667; val_masked_gp_l1_reg_loss: 222917.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146552.8906; val_chrom_access_recon_loss: 13239103.0000; val_global_loss: 39401540.5333; val_optim_loss: 39401540.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9734; val_auprc_score: 0.9651; val_best_acc_score: 0.9228; val_best_f1_score: 0.9252; train_kl_reg_loss: 139810.3457; train_edge_recon_loss: 2793702.1164; train_gene_expr_recon_loss: 22588440.5191; train_masked_gp_l1_reg_loss: 216890.1243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141225.7547; train_chrom_access_recon_loss: 13031466.8397; train_global_loss: 38911535.4809; train_optim_loss: 38911535.4809; val_kl_reg_loss: 99079.8938; val_edge_recon_loss: 2772559.5500; val_gene_expr_recon_loss: 22174752.5333; val_masked_gp_l1_reg_loss: 214983.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141275.4844; val_chrom_access_recon_loss: 12822794.8667; val_global_loss: 38225446.9333; val_optim_loss: 38225446.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9769; val_auprc_score: 0.9713; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 137829.5660; train_edge_recon_loss: 2758961.5744; train_gene_expr_recon_loss: 22545158.3969; train_masked_gp_l1_reg_loss: 214037.8168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140010.6999; train_chrom_access_recon_loss: 12983103.9389; train_global_loss: 38779102.0458; train_optim_loss: 38779102.0458; val_kl_reg_loss: 108512.6328; val_edge_recon_loss: 2744535.4333; val_gene_expr_recon_loss: 22145985.3333; val_masked_gp_l1_reg_loss: 213645.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139838.7812; val_chrom_access_recon_loss: 12820359.2667; val_global_loss: 38172877.3333; val_optim_loss: 38172877.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9716; val_auprc_score: 0.9595; val_best_acc_score: 0.9262; val_best_f1_score: 0.9278; train_kl_reg_loss: 131324.7849; train_edge_recon_loss: 2753312.3359; train_gene_expr_recon_loss: 22498436.7176; train_masked_gp_l1_reg_loss: 212751.8470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139398.0289; train_chrom_access_recon_loss: 12950624.8321; train_global_loss: 38685848.7328; train_optim_loss: 38685848.7328; val_kl_reg_loss: 113857.7021; val_edge_recon_loss: 2753679.0833; val_gene_expr_recon_loss: 22103312.1333; val_masked_gp_l1_reg_loss: 212599.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138505.9688; val_chrom_access_recon_loss: 12762522.1333; val_global_loss: 38084477.0667; val_optim_loss: 38084477.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9748; val_auprc_score: 0.9698; val_best_acc_score: 0.9258; val_best_f1_score: 0.9281; train_kl_reg_loss: 129080.1311; train_edge_recon_loss: 2745950.5897; train_gene_expr_recon_loss: 22463158.2443; train_masked_gp_l1_reg_loss: 211918.9499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138476.8205; train_chrom_access_recon_loss: 12928567.9237; train_global_loss: 38617152.5496; train_optim_loss: 38617152.5496; val_kl_reg_loss: 113752.4823; val_edge_recon_loss: 2764142.3333; val_gene_expr_recon_loss: 22115664.1333; val_masked_gp_l1_reg_loss: 211366.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139218.9062; val_chrom_access_recon_loss: 12745838.9333; val_global_loss: 38089981.3333; val_optim_loss: 38089981.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9732; val_auprc_score: 0.9648; val_best_acc_score: 0.9262; val_best_f1_score: 0.9283; train_kl_reg_loss: 127480.5440; train_edge_recon_loss: 2742977.6107; train_gene_expr_recon_loss: 22405979.5725; train_masked_gp_l1_reg_loss: 210982.3903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137605.1935; train_chrom_access_recon_loss: 12885917.8855; train_global_loss: 38510943.2672; train_optim_loss: 38510943.2672; val_kl_reg_loss: 117076.6130; val_edge_recon_loss: 2765278.2500; val_gene_expr_recon_loss: 21986748.5333; val_masked_gp_l1_reg_loss: 210622.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137033.7812; val_chrom_access_recon_loss: 12642634.4667; val_global_loss: 37859394.1333; val_optim_loss: 37859394.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9771; val_auprc_score: 0.9721; val_best_acc_score: 0.9294; val_best_f1_score: 0.9313; train_kl_reg_loss: 126829.9317; train_edge_recon_loss: 2739878.7080; train_gene_expr_recon_loss: 22374115.4962; train_masked_gp_l1_reg_loss: 210026.4215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136747.4020; train_chrom_access_recon_loss: 12867736.8244; train_global_loss: 38455334.6565; train_optim_loss: 38455334.6565; val_kl_reg_loss: 117001.6927; val_edge_recon_loss: 2755652.9833; val_gene_expr_recon_loss: 21992553.4667; val_masked_gp_l1_reg_loss: 209794.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136823.2188; val_chrom_access_recon_loss: 12683872.6667; val_global_loss: 37895698.4000; val_optim_loss: 37895698.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9765; val_auprc_score: 0.9702; val_best_acc_score: 0.9294; val_best_f1_score: 0.9312; train_kl_reg_loss: 124952.1208; train_edge_recon_loss: 2740099.2615; train_gene_expr_recon_loss: 22328374.9160; train_masked_gp_l1_reg_loss: 209382.0309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136313.5853; train_chrom_access_recon_loss: 12837138.8473; train_global_loss: 38376260.7328; train_optim_loss: 38376260.7328; val_kl_reg_loss: 114558.5901; val_edge_recon_loss: 2754560.9000; val_gene_expr_recon_loss: 22004325.8667; val_masked_gp_l1_reg_loss: 209075.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135735.7812; val_chrom_access_recon_loss: 12688315.5333; val_global_loss: 37906572.8000; val_optim_loss: 37906572.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9789; val_auprc_score: 0.9722; val_best_acc_score: 0.9314; val_best_f1_score: 0.9325; train_kl_reg_loss: 123747.0909; train_edge_recon_loss: 2733635.2786; train_gene_expr_recon_loss: 22299872.8244; train_masked_gp_l1_reg_loss: 208769.0446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135697.9964; train_chrom_access_recon_loss: 12816804.3282; train_global_loss: 38318526.6870; train_optim_loss: 38318526.6870; val_kl_reg_loss: 120069.2437; val_edge_recon_loss: 2745904.3333; val_gene_expr_recon_loss: 21897608.4000; val_masked_gp_l1_reg_loss: 208446.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135823.3438; val_chrom_access_recon_loss: 12625542.0000; val_global_loss: 37733394.1333; val_optim_loss: 37733394.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9799; val_auprc_score: 0.9750; val_best_acc_score: 0.9317; val_best_f1_score: 0.9334; train_kl_reg_loss: 123571.0309; train_edge_recon_loss: 2735370.5611; train_gene_expr_recon_loss: 22273561.5267; train_masked_gp_l1_reg_loss: 208234.9332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135332.1997; train_chrom_access_recon_loss: 12802221.5038; train_global_loss: 38278291.8168; train_optim_loss: 38278291.8168; val_kl_reg_loss: 119062.2042; val_edge_recon_loss: 2733363.3667; val_gene_expr_recon_loss: 21828429.0667; val_masked_gp_l1_reg_loss: 208201.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136197.2656; val_chrom_access_recon_loss: 12621402.1333; val_global_loss: 37646656.8000; val_optim_loss: 37646656.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9800; val_auprc_score: 0.9766; val_best_acc_score: 0.9321; val_best_f1_score: 0.9338; train_kl_reg_loss: 122376.0303; train_edge_recon_loss: 2731491.4389; train_gene_expr_recon_loss: 22240895.1145; train_masked_gp_l1_reg_loss: 207837.2889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135328.4590; train_chrom_access_recon_loss: 12774692.8168; train_global_loss: 38212621.1298; train_optim_loss: 38212621.1298; val_kl_reg_loss: 119269.2427; val_edge_recon_loss: 2738836.6000; val_gene_expr_recon_loss: 21942776.9333; val_masked_gp_l1_reg_loss: 207678.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135850.2188; val_chrom_access_recon_loss: 12617058.0667; val_global_loss: 37761469.0667; val_optim_loss: 37761469.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9777; val_auprc_score: 0.9697; val_best_acc_score: 0.9299; val_best_f1_score: 0.9311; train_kl_reg_loss: 123218.4487; train_edge_recon_loss: 2731347.8111; train_gene_expr_recon_loss: 22211549.5115; train_masked_gp_l1_reg_loss: 207242.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135199.7660; train_chrom_access_recon_loss: 12741565.7405; train_global_loss: 38150123.3893; train_optim_loss: 38150123.3893; val_kl_reg_loss: 118862.5667; val_edge_recon_loss: 2756836.2667; val_gene_expr_recon_loss: 21903710.4000; val_masked_gp_l1_reg_loss: 207170.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134540.9219; val_chrom_access_recon_loss: 12549451.8667; val_global_loss: 37670571.7333; val_optim_loss: 37670571.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9795; val_auprc_score: 0.9744; val_best_acc_score: 0.9320; val_best_f1_score: 0.9336; train_kl_reg_loss: 122569.0565; train_edge_recon_loss: 2732503.7443; train_gene_expr_recon_loss: 22207382.3511; train_masked_gp_l1_reg_loss: 206914.2362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134746.9258; train_chrom_access_recon_loss: 12719046.7557; train_global_loss: 38123162.9618; train_optim_loss: 38123162.9618; val_kl_reg_loss: 118609.2656; val_edge_recon_loss: 2744313.0500; val_gene_expr_recon_loss: 21835443.2000; val_masked_gp_l1_reg_loss: 206967.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134880.6719; val_chrom_access_recon_loss: 12566769.4667; val_global_loss: 37606982.9333; val_optim_loss: 37606982.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9787; val_auprc_score: 0.9733; val_best_acc_score: 0.9333; val_best_f1_score: 0.9350; train_kl_reg_loss: 122283.7331; train_edge_recon_loss: 2727601.9103; train_gene_expr_recon_loss: 22175370.5802; train_masked_gp_l1_reg_loss: 206837.2681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134530.8849; train_chrom_access_recon_loss: 12696743.3511; train_global_loss: 38063367.8168; train_optim_loss: 38063367.8168; val_kl_reg_loss: 117279.6635; val_edge_recon_loss: 2745156.3167; val_gene_expr_recon_loss: 21822399.0667; val_masked_gp_l1_reg_loss: 206812.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133828.8906; val_chrom_access_recon_loss: 12502523.5333; val_global_loss: 37527998.9333; val_optim_loss: 37527998.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9813; val_auprc_score: 0.9762; val_best_acc_score: 0.9367; val_best_f1_score: 0.9374; train_kl_reg_loss: 121906.4862; train_edge_recon_loss: 2730134.5344; train_gene_expr_recon_loss: 22158842.2748; train_masked_gp_l1_reg_loss: 206647.6473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134395.2836; train_chrom_access_recon_loss: 12684192.0992; train_global_loss: 38036118.3511; train_optim_loss: 38036118.3511; val_kl_reg_loss: 118519.2234; val_edge_recon_loss: 2736175.7000; val_gene_expr_recon_loss: 21829378.6667; val_masked_gp_l1_reg_loss: 206883.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135229.5156; val_chrom_access_recon_loss: 12502620.6667; val_global_loss: 37528808.5333; val_optim_loss: 37528808.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9804; val_auprc_score: 0.9755; val_best_acc_score: 0.9371; val_best_f1_score: 0.9386; train_kl_reg_loss: 121990.8569; train_edge_recon_loss: 2730935.2824; train_gene_expr_recon_loss: 22143876.4580; train_masked_gp_l1_reg_loss: 206468.8996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134458.6868; train_chrom_access_recon_loss: 12682699.3435; train_global_loss: 38020429.6183; train_optim_loss: 38020429.6183; val_kl_reg_loss: 116503.3828; val_edge_recon_loss: 2746747.7667; val_gene_expr_recon_loss: 21849212.8000; val_masked_gp_l1_reg_loss: 206474.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134755.6719; val_chrom_access_recon_loss: 12509698.8000; val_global_loss: 37563392.5333; val_optim_loss: 37563392.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9804; val_auprc_score: 0.9739; val_best_acc_score: 0.9372; val_best_f1_score: 0.9388; train_kl_reg_loss: 121662.9956; train_edge_recon_loss: 2730442.5420; train_gene_expr_recon_loss: 22131250.2290; train_masked_gp_l1_reg_loss: 206237.3977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134043.1900; train_chrom_access_recon_loss: 12671895.0916; train_global_loss: 37995531.3588; train_optim_loss: 37995531.3588; val_kl_reg_loss: 122546.9839; val_edge_recon_loss: 2737335.0000; val_gene_expr_recon_loss: 21847649.2000; val_masked_gp_l1_reg_loss: 206218.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133101.9844; val_chrom_access_recon_loss: 12495481.3333; val_global_loss: 37542332.2667; val_optim_loss: 37542332.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9825; val_auprc_score: 0.9776; val_best_acc_score: 0.9409; val_best_f1_score: 0.9420; train_kl_reg_loss: 121907.6079; train_edge_recon_loss: 2720616.1164; train_gene_expr_recon_loss: 22106443.1145; train_masked_gp_l1_reg_loss: 206135.1318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133955.9976; train_chrom_access_recon_loss: 12661558.2366; train_global_loss: 37950615.9084; train_optim_loss: 37950615.9084; val_kl_reg_loss: 122006.4578; val_edge_recon_loss: 2742899.9167; val_gene_expr_recon_loss: 21808421.8667; val_masked_gp_l1_reg_loss: 206078.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134419.0312; val_chrom_access_recon_loss: 12534766.2000; val_global_loss: 37548592.5333; val_optim_loss: 37548592.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9810; val_auprc_score: 0.9750; val_best_acc_score: 0.9406; val_best_f1_score: 0.9418; train_kl_reg_loss: 122865.5443; train_edge_recon_loss: 2731510.4256; train_gene_expr_recon_loss: 22068479.3893; train_masked_gp_l1_reg_loss: 201778.1155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97933.8865; train_chrom_access_recon_loss: 12640950.6336; train_global_loss: 37863518.3206; train_optim_loss: 37863518.3206; val_kl_reg_loss: 124415.2943; val_edge_recon_loss: 2723739.1333; val_gene_expr_recon_loss: 21789305.7333; val_masked_gp_l1_reg_loss: 200470.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93638.2031; val_chrom_access_recon_loss: 12509626.8667; val_global_loss: 37441195.7333; val_optim_loss: 37441195.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9805; val_auprc_score: 0.9758; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 125726.0389; train_edge_recon_loss: 2722985.9027; train_gene_expr_recon_loss: 22093124.6565; train_masked_gp_l1_reg_loss: 200070.5191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92916.7950; train_chrom_access_recon_loss: 12659554.9237; train_global_loss: 37894378.8702; train_optim_loss: 37894378.8702; val_kl_reg_loss: 126291.9141; val_edge_recon_loss: 2734680.1000; val_gene_expr_recon_loss: 21695825.7333; val_masked_gp_l1_reg_loss: 199806.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92470.7578; val_chrom_access_recon_loss: 12443238.9333; val_global_loss: 37292313.3333; val_optim_loss: 37292313.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9838; val_auprc_score: 0.9800; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 126904.4200; train_edge_recon_loss: 2724917.5305; train_gene_expr_recon_loss: 22065953.2977; train_masked_gp_l1_reg_loss: 199612.4442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92124.1174; train_chrom_access_recon_loss: 12645098.0534; train_global_loss: 37854609.9237; train_optim_loss: 37854609.9237; val_kl_reg_loss: 125621.6198; val_edge_recon_loss: 2742070.8000; val_gene_expr_recon_loss: 21804641.3333; val_masked_gp_l1_reg_loss: 199442.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91984.8750; val_chrom_access_recon_loss: 12451046.2000; val_global_loss: 37414806.6667; val_optim_loss: 37414806.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9818; val_auprc_score: 0.9776; val_best_acc_score: 0.9383; val_best_f1_score: 0.9402; train_kl_reg_loss: 126777.2053; train_edge_recon_loss: 2721194.3225; train_gene_expr_recon_loss: 22078468.5191; train_masked_gp_l1_reg_loss: 199284.8546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91606.2046; train_chrom_access_recon_loss: 12652109.3511; train_global_loss: 37869440.3664; train_optim_loss: 37869440.3664; val_kl_reg_loss: 126954.4932; val_edge_recon_loss: 2727166.1167; val_gene_expr_recon_loss: 21760552.9333; val_masked_gp_l1_reg_loss: 199179.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91236.6484; val_chrom_access_recon_loss: 12456037.2000; val_global_loss: 37361126.1333; val_optim_loss: 37361126.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9832; val_auprc_score: 0.9792; val_best_acc_score: 0.9450; val_best_f1_score: 0.9461; train_kl_reg_loss: 127158.3510; train_edge_recon_loss: 2715099.9905; train_gene_expr_recon_loss: 22074750.8244; train_masked_gp_l1_reg_loss: 199063.4185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90939.8629; train_chrom_access_recon_loss: 12647311.7710; train_global_loss: 37854324.2137; train_optim_loss: 37854324.2137; val_kl_reg_loss: 127349.4417; val_edge_recon_loss: 2727612.2833; val_gene_expr_recon_loss: 21742006.0000; val_masked_gp_l1_reg_loss: 198989.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90779.3359; val_chrom_access_recon_loss: 12500156.2000; val_global_loss: 37386894.6667; val_optim_loss: 37386894.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9828; val_auprc_score: 0.9776; val_best_acc_score: 0.9426; val_best_f1_score: 0.9443; train_kl_reg_loss: 127252.9822; train_edge_recon_loss: 2719111.0420; train_gene_expr_recon_loss: 22080840.7939; train_masked_gp_l1_reg_loss: 198892.6430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90454.0491; train_chrom_access_recon_loss: 12651798.1908; train_global_loss: 37868349.6794; train_optim_loss: 37868349.6794; val_kl_reg_loss: 126871.7651; val_edge_recon_loss: 2723336.3833; val_gene_expr_recon_loss: 21776034.8000; val_masked_gp_l1_reg_loss: 198823.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90432.5234; val_chrom_access_recon_loss: 12443768.7333; val_global_loss: 37359267.7333; val_optim_loss: 37359267.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9797; val_auprc_score: 0.9725; val_best_acc_score: 0.9376; val_best_f1_score: 0.9391; train_kl_reg_loss: 127018.9086; train_edge_recon_loss: 2719151.6374; train_gene_expr_recon_loss: 22067489.5267; train_masked_gp_l1_reg_loss: 198364.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86465.0569; train_chrom_access_recon_loss: 12635505.4656; train_global_loss: 37833995.4809; train_optim_loss: 37833995.4809; val_kl_reg_loss: 126708.6526; val_edge_recon_loss: 2727274.1500; val_gene_expr_recon_loss: 21757307.6000; val_masked_gp_l1_reg_loss: 198186.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85890.5703; val_chrom_access_recon_loss: 12471090.4000; val_global_loss: 37366457.0667; val_optim_loss: 37366457.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9817; val_auprc_score: 0.9749; val_best_acc_score: 0.9399; val_best_f1_score: 0.9413; train_kl_reg_loss: 127071.5983; train_edge_recon_loss: 2724487.2920; train_gene_expr_recon_loss: 22062705.0229; train_masked_gp_l1_reg_loss: 198126.9141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85773.3637; train_chrom_access_recon_loss: 12641025.5649; train_global_loss: 37839189.5573; train_optim_loss: 37839189.5573; val_kl_reg_loss: 126801.6734; val_edge_recon_loss: 2727413.3333; val_gene_expr_recon_loss: 21705029.3333; val_masked_gp_l1_reg_loss: 198071.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85653.4141; val_chrom_access_recon_loss: 12451845.9333; val_global_loss: 37294816.5333; val_optim_loss: 37294816.5333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9822; val_auprc_score: 0.9749; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 127252.0783; train_edge_recon_loss: 2722027.4313; train_gene_expr_recon_loss: 22065342.8855; train_masked_gp_l1_reg_loss: 198039.1526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85569.2786; train_chrom_access_recon_loss: 12645891.9847; train_global_loss: 37844122.9008; train_optim_loss: 37844122.9008; val_kl_reg_loss: 126673.4375; val_edge_recon_loss: 2729783.4000; val_gene_expr_recon_loss: 21773777.8667; val_masked_gp_l1_reg_loss: 198011.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85496.0625; val_chrom_access_recon_loss: 12522166.1333; val_global_loss: 37435908.8000; val_optim_loss: 37435908.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9839; val_auprc_score: 0.9794; val_best_acc_score: 0.9429; val_best_f1_score: 0.9440; train_kl_reg_loss: 127286.3470; train_edge_recon_loss: 2723538.9275; train_gene_expr_recon_loss: 22076742.6565; train_masked_gp_l1_reg_loss: 197990.9849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85447.0522; train_chrom_access_recon_loss: 12659533.6183; train_global_loss: 37870539.5115; train_optim_loss: 37870539.5115; val_kl_reg_loss: 126800.6854; val_edge_recon_loss: 2753786.8667; val_gene_expr_recon_loss: 21756652.9333; val_masked_gp_l1_reg_loss: 197969.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85390.0391; val_chrom_access_recon_loss: 12461401.7333; val_global_loss: 37382001.6000; val_optim_loss: 37382001.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 98 min 4 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9833
val AUPRC score: 0.9784
val best accuracy score: 0.9426
val best F1 score: 0.9434
val target rna MSE score: 0.8566
val source rna MSE score: 0.2278
val target atac MSE score: 0.3343
val source atac MSE score: 0.0549
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
