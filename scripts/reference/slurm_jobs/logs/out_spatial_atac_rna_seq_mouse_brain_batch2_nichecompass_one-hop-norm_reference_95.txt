[True]
Run timestamp: 07082023_202445_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8942; val_auprc_score: 0.9091; val_best_acc_score: 0.5070; val_best_f1_score: 0.6698; train_kl_reg_loss: 9194.2770; train_edge_recon_loss: 348572.8160; train_gene_expr_recon_loss: 1152153.5972; train_masked_gp_l1_reg_loss: 8592.0002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119395.9826; train_chrom_access_recon_loss: 775560.3993; train_global_loss: 2413469.1250; train_optim_loss: 2413469.1250; val_kl_reg_loss: 3494.7910; val_edge_recon_loss: 406495.7500; val_gene_expr_recon_loss: 1049440.2500; val_masked_gp_l1_reg_loss: 6984.7681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117192.2266; val_chrom_access_recon_loss: 510497.8438; val_global_loss: 2094105.6250; val_optim_loss: 2094105.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9030; val_auprc_score: 0.9126; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 3979.7933; train_edge_recon_loss: 349851.3160; train_gene_expr_recon_loss: 988618.2500; train_masked_gp_l1_reg_loss: 6469.7550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115837.5035; train_chrom_access_recon_loss: 495645.5625; train_global_loss: 1960402.2222; train_optim_loss: 1960402.2222; val_kl_reg_loss: 6070.4531; val_edge_recon_loss: 406548.0938; val_gene_expr_recon_loss: 919541.5000; val_masked_gp_l1_reg_loss: 6172.4082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114194.4141; val_chrom_access_recon_loss: 480892.4375; val_global_loss: 1933419.2500; val_optim_loss: 1933419.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9006; val_auprc_score: 0.9148; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 10214.2917; train_edge_recon_loss: 354025.5382; train_gene_expr_recon_loss: 872065.4722; train_masked_gp_l1_reg_loss: 6371.6424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112859.6311; train_chrom_access_recon_loss: 480788.8958; train_global_loss: 1836325.4583; train_optim_loss: 1836325.4583; val_kl_reg_loss: 13311.5820; val_edge_recon_loss: 406579.9688; val_gene_expr_recon_loss: 823356.8750; val_masked_gp_l1_reg_loss: 6625.1782; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111117.4531; val_chrom_access_recon_loss: 468608.6875; val_global_loss: 1829599.7500; val_optim_loss: 1829599.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8930; val_auprc_score: 0.9046; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 15089.7619; train_edge_recon_loss: 357051.8194; train_gene_expr_recon_loss: 801252.4306; train_masked_gp_l1_reg_loss: 6713.8152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109577.0000; train_chrom_access_recon_loss: 467369.3264; train_global_loss: 1757054.1389; train_optim_loss: 1757054.1389; val_kl_reg_loss: 15470.1270; val_edge_recon_loss: 406566.0312; val_gene_expr_recon_loss: 770011.4375; val_masked_gp_l1_reg_loss: 6791.0933; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107554.9922; val_chrom_access_recon_loss: 454902.5000; val_global_loss: 1761296.2500; val_optim_loss: 1761296.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8918; val_auprc_score: 0.9055; val_best_acc_score: 0.5070; val_best_f1_score: 0.6697; train_kl_reg_loss: 17353.4791; train_edge_recon_loss: 358007.1806; train_gene_expr_recon_loss: 754255.2292; train_masked_gp_l1_reg_loss: 6839.8651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105793.8342; train_chrom_access_recon_loss: 455533.7674; train_global_loss: 1697783.3750; train_optim_loss: 1697783.3750; val_kl_reg_loss: 17659.9609; val_edge_recon_loss: 406552.2812; val_gene_expr_recon_loss: 735399.8750; val_masked_gp_l1_reg_loss: 6869.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103506.1875; val_chrom_access_recon_loss: 448793.8438; val_global_loss: 1718781.3750; val_optim_loss: 1718781.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8913; val_auprc_score: 0.9004; val_best_acc_score: 0.5132; val_best_f1_score: 0.6723; train_kl_reg_loss: 17846.7574; train_edge_recon_loss: 358332.2951; train_gene_expr_recon_loss: 727879.8472; train_masked_gp_l1_reg_loss: 6872.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101557.9523; train_chrom_access_recon_loss: 450850.2188; train_global_loss: 1663339.5556; train_optim_loss: 1663339.5556; val_kl_reg_loss: 17638.7637; val_edge_recon_loss: 406503.4062; val_gene_expr_recon_loss: 717398.7500; val_masked_gp_l1_reg_loss: 6866.6123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99072.4062; val_chrom_access_recon_loss: 445211.7188; val_global_loss: 1692691.6250; val_optim_loss: 1692691.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8883; val_auprc_score: 0.8947; val_best_acc_score: 0.5152; val_best_f1_score: 0.6730; train_kl_reg_loss: 18213.0623; train_edge_recon_loss: 358092.7743; train_gene_expr_recon_loss: 711878.1597; train_masked_gp_l1_reg_loss: 6862.4985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97032.5694; train_chrom_access_recon_loss: 445996.4514; train_global_loss: 1638075.5000; train_optim_loss: 1638075.5000; val_kl_reg_loss: 18440.5742; val_edge_recon_loss: 406451.1562; val_gene_expr_recon_loss: 704182.3125; val_masked_gp_l1_reg_loss: 6846.5728; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94467.8906; val_chrom_access_recon_loss: 442948.7812; val_global_loss: 1673337.2500; val_optim_loss: 1673337.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8885; val_auprc_score: 0.8934; val_best_acc_score: 0.5268; val_best_f1_score: 0.6770; train_kl_reg_loss: 18583.7580; train_edge_recon_loss: 357982.9062; train_gene_expr_recon_loss: 703024.5972; train_masked_gp_l1_reg_loss: 6845.0947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92408.0208; train_chrom_access_recon_loss: 447938.7778; train_global_loss: 1626783.1667; train_optim_loss: 1626783.1667; val_kl_reg_loss: 16848.9375; val_edge_recon_loss: 406321.5000; val_gene_expr_recon_loss: 695066.3750; val_masked_gp_l1_reg_loss: 6823.8765; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89830.7109; val_chrom_access_recon_loss: 441248.8125; val_global_loss: 1656140.2500; val_optim_loss: 1656140.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8838; val_auprc_score: 0.8903; val_best_acc_score: 0.5473; val_best_f1_score: 0.6853; train_kl_reg_loss: 18292.2678; train_edge_recon_loss: 357928.6701; train_gene_expr_recon_loss: 694432.2708; train_masked_gp_l1_reg_loss: 6821.9469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87778.2135; train_chrom_access_recon_loss: 444846.1771; train_global_loss: 1610099.5833; train_optim_loss: 1610099.5833; val_kl_reg_loss: 17366.8047; val_edge_recon_loss: 406131.9375; val_gene_expr_recon_loss: 686662.8125; val_masked_gp_l1_reg_loss: 6807.8130; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85218.2031; val_chrom_access_recon_loss: 439867.0000; val_global_loss: 1642054.6250; val_optim_loss: 1642054.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8832; val_auprc_score: 0.8849; val_best_acc_score: 0.6207; val_best_f1_score: 0.7199; train_kl_reg_loss: 18641.8281; train_edge_recon_loss: 357876.5417; train_gene_expr_recon_loss: 685725.1458; train_masked_gp_l1_reg_loss: 6812.1604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83199.8073; train_chrom_access_recon_loss: 444345.5347; train_global_loss: 1596601.0417; train_optim_loss: 1596601.0417; val_kl_reg_loss: 17777.6426; val_edge_recon_loss: 405648.6562; val_gene_expr_recon_loss: 679903.8750; val_masked_gp_l1_reg_loss: 6798.5840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80689.4453; val_chrom_access_recon_loss: 438568.4688; val_global_loss: 1629386.8750; val_optim_loss: 1629386.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8825; val_auprc_score: 0.8791; val_best_acc_score: 0.7126; val_best_f1_score: 0.7679; train_kl_reg_loss: 18835.8594; train_edge_recon_loss: 357585.2951; train_gene_expr_recon_loss: 678958.1597; train_masked_gp_l1_reg_loss: 6801.1890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78721.8602; train_chrom_access_recon_loss: 441468.7917; train_global_loss: 1582371.1944; train_optim_loss: 1582371.1944; val_kl_reg_loss: 17620.3477; val_edge_recon_loss: 404744.5312; val_gene_expr_recon_loss: 674748.0000; val_masked_gp_l1_reg_loss: 6792.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76287.6172; val_chrom_access_recon_loss: 437395.9062; val_global_loss: 1617588.8750; val_optim_loss: 1617588.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8729; val_auprc_score: 0.8649; val_best_acc_score: 0.7720; val_best_f1_score: 0.7963; train_kl_reg_loss: 18652.1862; train_edge_recon_loss: 357145.2674; train_gene_expr_recon_loss: 673925.5625; train_masked_gp_l1_reg_loss: 6801.1744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74390.1233; train_chrom_access_recon_loss: 439598.3993; train_global_loss: 1570512.7083; train_optim_loss: 1570512.7083; val_kl_reg_loss: 18133.2715; val_edge_recon_loss: 403521.4688; val_gene_expr_recon_loss: 669985.1250; val_masked_gp_l1_reg_loss: 6798.0488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72042.0469; val_chrom_access_recon_loss: 436272.3125; val_global_loss: 1606752.2500; val_optim_loss: 1606752.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8757; val_auprc_score: 0.8646; val_best_acc_score: 0.8013; val_best_f1_score: 0.8005; train_kl_reg_loss: 18753.9197; train_edge_recon_loss: 356608.2153; train_gene_expr_recon_loss: 669306.7917; train_masked_gp_l1_reg_loss: 6805.0457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70214.6719; train_chrom_access_recon_loss: 438893.0972; train_global_loss: 1560581.7500; train_optim_loss: 1560581.7500; val_kl_reg_loss: 17167.7383; val_edge_recon_loss: 400795.6875; val_gene_expr_recon_loss: 667411.1250; val_masked_gp_l1_reg_loss: 6802.1733; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67959.5469; val_chrom_access_recon_loss: 435332.6562; val_global_loss: 1595468.7500; val_optim_loss: 1595468.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8827; val_auprc_score: 0.8770; val_best_acc_score: 0.7794; val_best_f1_score: 0.7848; train_kl_reg_loss: 18202.1300; train_edge_recon_loss: 355555.2292; train_gene_expr_recon_loss: 669282.2431; train_masked_gp_l1_reg_loss: 6812.9989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66221.2491; train_chrom_access_recon_loss: 437880.9826; train_global_loss: 1553954.8333; train_optim_loss: 1553954.8333; val_kl_reg_loss: 17110.7559; val_edge_recon_loss: 396371.5000; val_gene_expr_recon_loss: 664365.9375; val_masked_gp_l1_reg_loss: 6816.5747; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64074.7695; val_chrom_access_recon_loss: 434418.3125; val_global_loss: 1583158.0000; val_optim_loss: 1583158.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8916; val_auprc_score: 0.8782; val_best_acc_score: 0.8021; val_best_f1_score: 0.8193; train_kl_reg_loss: 17765.7969; train_edge_recon_loss: 353830.1424; train_gene_expr_recon_loss: 660554.3194; train_masked_gp_l1_reg_loss: 6830.0680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62421.3672; train_chrom_access_recon_loss: 435379.9965; train_global_loss: 1536781.6944; train_optim_loss: 1536781.6944; val_kl_reg_loss: 16750.2500; val_edge_recon_loss: 389055.7188; val_gene_expr_recon_loss: 662607.1250; val_masked_gp_l1_reg_loss: 6836.1499; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60388.0312; val_chrom_access_recon_loss: 433688.6250; val_global_loss: 1569325.8750; val_optim_loss: 1569325.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9080; val_auprc_score: 0.8933; val_best_acc_score: 0.8297; val_best_f1_score: 0.8392; train_kl_reg_loss: 16981.9876; train_edge_recon_loss: 350829.2535; train_gene_expr_recon_loss: 663971.4444; train_masked_gp_l1_reg_loss: 6851.6448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58831.2122; train_chrom_access_recon_loss: 437526.9062; train_global_loss: 1534992.4583; train_optim_loss: 1534992.4583; val_kl_reg_loss: 15276.9082; val_edge_recon_loss: 374395.3125; val_gene_expr_recon_loss: 662350.5000; val_masked_gp_l1_reg_loss: 6860.1001; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56921.8008; val_chrom_access_recon_loss: 433208.5938; val_global_loss: 1549013.2500; val_optim_loss: 1549013.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9288; val_auprc_score: 0.9120; val_best_acc_score: 0.8564; val_best_f1_score: 0.8622; train_kl_reg_loss: 16046.8944; train_edge_recon_loss: 343662.2743; train_gene_expr_recon_loss: 660275.4861; train_masked_gp_l1_reg_loss: 6888.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55471.7313; train_chrom_access_recon_loss: 435456.6181; train_global_loss: 1517801.5139; train_optim_loss: 1517801.5139; val_kl_reg_loss: 15094.0605; val_edge_recon_loss: 347551.3750; val_gene_expr_recon_loss: 663358.7500; val_masked_gp_l1_reg_loss: 6909.0747; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53694.9922; val_chrom_access_recon_loss: 433246.1875; val_global_loss: 1519854.5000; val_optim_loss: 1519854.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9207; val_auprc_score: 0.8965; val_best_acc_score: 0.8519; val_best_f1_score: 0.8602; train_kl_reg_loss: 17710.8098; train_edge_recon_loss: 326089.8021; train_gene_expr_recon_loss: 667442.3889; train_masked_gp_l1_reg_loss: 6939.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52346.4931; train_chrom_access_recon_loss: 437606.7882; train_global_loss: 1508135.6389; train_optim_loss: 1508135.6389; val_kl_reg_loss: 20538.0859; val_edge_recon_loss: 317026.7500; val_gene_expr_recon_loss: 665201.6250; val_masked_gp_l1_reg_loss: 6985.0679; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50698.8633; val_chrom_access_recon_loss: 433083.4375; val_global_loss: 1493533.7500; val_optim_loss: 1493533.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9222; val_auprc_score: 0.9043; val_best_acc_score: 0.8495; val_best_f1_score: 0.8577; train_kl_reg_loss: 25155.1209; train_edge_recon_loss: 309064.8542; train_gene_expr_recon_loss: 664007.7986; train_masked_gp_l1_reg_loss: 7027.1002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49454.7552; train_chrom_access_recon_loss: 435747.1215; train_global_loss: 1490456.7639; train_optim_loss: 1490456.7639; val_kl_reg_loss: 26583.8457; val_edge_recon_loss: 302575.3438; val_gene_expr_recon_loss: 662783.2500; val_masked_gp_l1_reg_loss: 7081.4409; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47927.5625; val_chrom_access_recon_loss: 431907.7500; val_global_loss: 1478859.2500; val_optim_loss: 1478859.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9181; val_auprc_score: 0.8955; val_best_acc_score: 0.8448; val_best_f1_score: 0.8540; train_kl_reg_loss: 27165.3103; train_edge_recon_loss: 302533.6215; train_gene_expr_recon_loss: 663135.3958; train_masked_gp_l1_reg_loss: 7119.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46772.4527; train_chrom_access_recon_loss: 436520.2431; train_global_loss: 1483246.8611; train_optim_loss: 1483246.8611; val_kl_reg_loss: 24719.2949; val_edge_recon_loss: 304320.0625; val_gene_expr_recon_loss: 660328.1875; val_masked_gp_l1_reg_loss: 7155.3364; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45355.4102; val_chrom_access_recon_loss: 431281.0938; val_global_loss: 1473159.3750; val_optim_loss: 1473159.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9172; val_auprc_score: 0.9005; val_best_acc_score: 0.8407; val_best_f1_score: 0.8526; train_kl_reg_loss: 25558.8770; train_edge_recon_loss: 301297.9062; train_gene_expr_recon_loss: 660152.2292; train_masked_gp_l1_reg_loss: 7182.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44287.3741; train_chrom_access_recon_loss: 433525.5868; train_global_loss: 1472004.1944; train_optim_loss: 1472004.1944; val_kl_reg_loss: 24762.2266; val_edge_recon_loss: 303432.6875; val_gene_expr_recon_loss: 658986.6250; val_masked_gp_l1_reg_loss: 7210.2983; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42971.3125; val_chrom_access_recon_loss: 430511.7188; val_global_loss: 1467874.8750; val_optim_loss: 1467874.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9194; val_auprc_score: 0.9007; val_best_acc_score: 0.8452; val_best_f1_score: 0.8566; train_kl_reg_loss: 25755.8919; train_edge_recon_loss: 298503.4792; train_gene_expr_recon_loss: 657404.8889; train_masked_gp_l1_reg_loss: 7233.8847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41974.4722; train_chrom_access_recon_loss: 432513.9236; train_global_loss: 1463386.5556; train_optim_loss: 1463386.5556; val_kl_reg_loss: 25090.8828; val_edge_recon_loss: 297164.1562; val_gene_expr_recon_loss: 657636.7500; val_masked_gp_l1_reg_loss: 7258.1807; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40753.5859; val_chrom_access_recon_loss: 429694.4375; val_global_loss: 1457598.0000; val_optim_loss: 1457598.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9208; val_auprc_score: 0.9008; val_best_acc_score: 0.8464; val_best_f1_score: 0.8580; train_kl_reg_loss: 25655.2463; train_edge_recon_loss: 297863.4757; train_gene_expr_recon_loss: 657426.4861; train_masked_gp_l1_reg_loss: 7288.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39826.6506; train_chrom_access_recon_loss: 433102.1910; train_global_loss: 1461162.1389; train_optim_loss: 1461162.1389; val_kl_reg_loss: 24552.5312; val_edge_recon_loss: 298836.4688; val_gene_expr_recon_loss: 656757.6250; val_masked_gp_l1_reg_loss: 7314.3647; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38688.6641; val_chrom_access_recon_loss: 429238.0000; val_global_loss: 1455387.7500; val_optim_loss: 1455387.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9305; val_auprc_score: 0.9187; val_best_acc_score: 0.8562; val_best_f1_score: 0.8651; train_kl_reg_loss: 25651.7294; train_edge_recon_loss: 295010.6701; train_gene_expr_recon_loss: 655778.8472; train_masked_gp_l1_reg_loss: 7334.9913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37837.9284; train_chrom_access_recon_loss: 432337.1111; train_global_loss: 1453951.2778; train_optim_loss: 1453951.2778; val_kl_reg_loss: 24540.1641; val_edge_recon_loss: 294485.9062; val_gene_expr_recon_loss: 655961.6875; val_masked_gp_l1_reg_loss: 7359.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36785.6602; val_chrom_access_recon_loss: 428681.8750; val_global_loss: 1447815.0000; val_optim_loss: 1447815.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9211; val_auprc_score: 0.9002; val_best_acc_score: 0.8529; val_best_f1_score: 0.8603; train_kl_reg_loss: 25711.7324; train_edge_recon_loss: 294458.5556; train_gene_expr_recon_loss: 651635.2083; train_masked_gp_l1_reg_loss: 7383.4777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35992.0634; train_chrom_access_recon_loss: 430955.6910; train_global_loss: 1446136.7083; train_optim_loss: 1446136.7083; val_kl_reg_loss: 24261.9648; val_edge_recon_loss: 297854.4062; val_gene_expr_recon_loss: 654469.5625; val_masked_gp_l1_reg_loss: 7406.9927; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35011.5195; val_chrom_access_recon_loss: 427941.2500; val_global_loss: 1446945.7500; val_optim_loss: 1446945.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9308; val_auprc_score: 0.9170; val_best_acc_score: 0.8535; val_best_f1_score: 0.8635; train_kl_reg_loss: 23750.3943; train_edge_recon_loss: 300786.8160; train_gene_expr_recon_loss: 901580.3681; train_masked_gp_l1_reg_loss: 7498.9501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34139.5295; train_chrom_access_recon_loss: 456830.9062; train_global_loss: 1724586.9444; train_optim_loss: 1724586.9444; val_kl_reg_loss: 13922.2373; val_edge_recon_loss: 298373.8438; val_gene_expr_recon_loss: 890335.2500; val_masked_gp_l1_reg_loss: 7661.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32975.2422; val_chrom_access_recon_loss: 451376.2812; val_global_loss: 1694644.2500; val_optim_loss: 1694644.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9265; val_auprc_score: 0.9062; val_best_acc_score: 0.8593; val_best_f1_score: 0.8677; train_kl_reg_loss: 23058.1684; train_edge_recon_loss: 295431.8542; train_gene_expr_recon_loss: 890779.8472; train_masked_gp_l1_reg_loss: 7833.1486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32013.6059; train_chrom_access_recon_loss: 453811.4479; train_global_loss: 1702928.1250; train_optim_loss: 1702928.1250; val_kl_reg_loss: 14852.1348; val_edge_recon_loss: 295048.7188; val_gene_expr_recon_loss: 886778.1250; val_masked_gp_l1_reg_loss: 8040.2632; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30826.8398; val_chrom_access_recon_loss: 450754.7500; val_global_loss: 1686300.8750; val_optim_loss: 1686300.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9341; val_auprc_score: 0.9181; val_best_acc_score: 0.8658; val_best_f1_score: 0.8719; train_kl_reg_loss: 21000.8945; train_edge_recon_loss: 292308.3333; train_gene_expr_recon_loss: 886735.2083; train_masked_gp_l1_reg_loss: 8178.4739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29919.6960; train_chrom_access_recon_loss: 452521.0208; train_global_loss: 1690663.6250; train_optim_loss: 1690663.6250; val_kl_reg_loss: 15375.4180; val_edge_recon_loss: 292737.3125; val_gene_expr_recon_loss: 883512.2500; val_masked_gp_l1_reg_loss: 8338.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28818.1602; val_chrom_access_recon_loss: 450211.4375; val_global_loss: 1678993.2500; val_optim_loss: 1678993.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9418; val_auprc_score: 0.9249; val_best_acc_score: 0.8764; val_best_f1_score: 0.8827; train_kl_reg_loss: 20201.4015; train_edge_recon_loss: 289560.2083; train_gene_expr_recon_loss: 882913.3333; train_masked_gp_l1_reg_loss: 8444.8470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27988.4405; train_chrom_access_recon_loss: 454565.6806; train_global_loss: 1683673.9167; train_optim_loss: 1683673.9167; val_kl_reg_loss: 16130.5703; val_edge_recon_loss: 287198.3125; val_gene_expr_recon_loss: 880277.5625; val_masked_gp_l1_reg_loss: 8565.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26979.2891; val_chrom_access_recon_loss: 449673.9375; val_global_loss: 1668825.2500; val_optim_loss: 1668825.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9379; val_auprc_score: 0.9198; val_best_acc_score: 0.8743; val_best_f1_score: 0.8792; train_kl_reg_loss: 19585.1257; train_edge_recon_loss: 288692.7917; train_gene_expr_recon_loss: 879544.0556; train_masked_gp_l1_reg_loss: 8540.9411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26861.4670; train_chrom_access_recon_loss: 451357.4410; train_global_loss: 1674581.8333; train_optim_loss: 1674581.8333; val_kl_reg_loss: 16528.8750; val_edge_recon_loss: 290798.4688; val_gene_expr_recon_loss: 878998.0000; val_masked_gp_l1_reg_loss: 8520.2217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26718.6172; val_chrom_access_recon_loss: 449369.0000; val_global_loss: 1670933.2500; val_optim_loss: 1670933.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9390; val_auprc_score: 0.9241; val_best_acc_score: 0.8716; val_best_f1_score: 0.8776; train_kl_reg_loss: 19825.4297; train_edge_recon_loss: 289030.0625; train_gene_expr_recon_loss: 878670.3472; train_masked_gp_l1_reg_loss: 8519.3179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26619.8181; train_chrom_access_recon_loss: 453092.4583; train_global_loss: 1675757.4028; train_optim_loss: 1675757.4028; val_kl_reg_loss: 16588.3945; val_edge_recon_loss: 290749.0938; val_gene_expr_recon_loss: 878858.7500; val_masked_gp_l1_reg_loss: 8514.9404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26495.9297; val_chrom_access_recon_loss: 449424.1250; val_global_loss: 1670631.2500; val_optim_loss: 1670631.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9393; val_auprc_score: 0.9238; val_best_acc_score: 0.8743; val_best_f1_score: 0.8812; train_kl_reg_loss: 19602.3440; train_edge_recon_loss: 289308.6840; train_gene_expr_recon_loss: 879563.2847; train_masked_gp_l1_reg_loss: 8514.4756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26402.8273; train_chrom_access_recon_loss: 451202.0486; train_global_loss: 1674593.6667; train_optim_loss: 1674593.6667; val_kl_reg_loss: 16460.9805; val_edge_recon_loss: 289690.6250; val_gene_expr_recon_loss: 878566.8750; val_masked_gp_l1_reg_loss: 8514.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26288.4980; val_chrom_access_recon_loss: 449326.7188; val_global_loss: 1668848.3750; val_optim_loss: 1668848.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9413; val_auprc_score: 0.9232; val_best_acc_score: 0.8787; val_best_f1_score: 0.8843; train_kl_reg_loss: 19411.7489; train_edge_recon_loss: 289433.2431; train_gene_expr_recon_loss: 876647.7986; train_masked_gp_l1_reg_loss: 8516.4142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26200.0679; train_chrom_access_recon_loss: 449942.9410; train_global_loss: 1670152.2500; train_optim_loss: 1670152.2500; val_kl_reg_loss: 16457.7012; val_edge_recon_loss: 289620.0312; val_gene_expr_recon_loss: 878270.1250; val_masked_gp_l1_reg_loss: 8519.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26093.1602; val_chrom_access_recon_loss: 449281.1875; val_global_loss: 1668241.5000; val_optim_loss: 1668241.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9230
val AUPRC score: 0.9032
val best accuracy score: 0.8482
val best F1 score: 0.8589
val target rna MSE score: 4.0375
val source rna MSE score: 3.1055
val target atac MSE score: 0.1355
val source atac MSE score: 0.0199
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
