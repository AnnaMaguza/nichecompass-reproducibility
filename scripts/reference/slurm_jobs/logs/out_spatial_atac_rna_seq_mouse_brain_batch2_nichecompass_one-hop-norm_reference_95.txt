[True]
Run timestamp: 29072023_122103_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8804; val_auprc_score: 0.9030; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3452.3544; train_edge_recon_loss: 3483212.9167; train_gene_expr_recon_loss: 79779552.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1892129.6250; train_global_loss: 85158346.6667; train_optim_loss: 85158346.6667; val_kl_reg_loss: 4610.2959; val_edge_recon_loss: 4065713.2500; val_gene_expr_recon_loss: 71601968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1733967.0000; val_global_loss: 77406256.0000; val_optim_loss: 77406256.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9101; val_auprc_score: 0.9171; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 26084.1442; train_edge_recon_loss: 3501591.8889; train_gene_expr_recon_loss: 67554344.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1753680.5972; train_global_loss: 72835700.4444; train_optim_loss: 72835700.4444; val_kl_reg_loss: 50103.5703; val_edge_recon_loss: 4066191.2500; val_gene_expr_recon_loss: 63956612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1766571.7500; val_global_loss: 69839472.0000; val_optim_loss: 69839472.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8987; val_auprc_score: 0.9109; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 60220.8277; train_edge_recon_loss: 3566022.0278; train_gene_expr_recon_loss: 62353015.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1782692.0972; train_global_loss: 67761949.7778; train_optim_loss: 67761949.7778; val_kl_reg_loss: 62381.4961; val_edge_recon_loss: 4066172.2500; val_gene_expr_recon_loss: 60823904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1760338.2500; val_global_loss: 66712796.0000; val_optim_loss: 66712796.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8830; val_auprc_score: 0.8921; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 88576.1085; train_edge_recon_loss: 3576121.3889; train_gene_expr_recon_loss: 59365863.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1753531.6944; train_global_loss: 64784092.8889; train_optim_loss: 64784092.8889; val_kl_reg_loss: 113994.4062; val_edge_recon_loss: 4066094.7500; val_gene_expr_recon_loss: 57797944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1727458.5000; val_global_loss: 63705492.0000; val_optim_loss: 63705492.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8886; val_auprc_score: 0.8964; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 127213.4566; train_edge_recon_loss: 3604664.2778; train_gene_expr_recon_loss: 56355180.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1733145.2639; train_global_loss: 61820204.4444; train_optim_loss: 61820204.4444; val_kl_reg_loss: 113122.0859; val_edge_recon_loss: 4066051.7500; val_gene_expr_recon_loss: 54866376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1706378.5000; val_global_loss: 60751928.0000; val_optim_loss: 60751928.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8865; val_auprc_score: 0.8938; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 156631.3802; train_edge_recon_loss: 3603582.9722; train_gene_expr_recon_loss: 53388733.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1710073.2917; train_global_loss: 58859020.8889; train_optim_loss: 58859020.8889; val_kl_reg_loss: 132117.5781; val_edge_recon_loss: 4066012.2500; val_gene_expr_recon_loss: 52117440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1695886.6250; val_global_loss: 58011456.0000; val_optim_loss: 58011456.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8786; val_auprc_score: 0.8851; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 167325.1771; train_edge_recon_loss: 3616515.0000; train_gene_expr_recon_loss: 50955765.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1705294.4306; train_global_loss: 56444900.8889; train_optim_loss: 56444900.8889; val_kl_reg_loss: 137030.9375; val_edge_recon_loss: 4065926.0000; val_gene_expr_recon_loss: 49676236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1666205.2500; val_global_loss: 55545396.0000; val_optim_loss: 55545396.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8627; val_auprc_score: 0.8668; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 175792.1441; train_edge_recon_loss: 3614321.6667; train_gene_expr_recon_loss: 48237284.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1670508.0417; train_global_loss: 53697906.2222; train_optim_loss: 53697906.2222; val_kl_reg_loss: 153781.7031; val_edge_recon_loss: 4065869.5000; val_gene_expr_recon_loss: 47369600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1649730.5000; val_global_loss: 53238984.0000; val_optim_loss: 53238984.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8553; val_auprc_score: 0.8610; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 190286.3125; train_edge_recon_loss: 3607962.5000; train_gene_expr_recon_loss: 46699802.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1666081.9861; train_global_loss: 52164132.4444; train_optim_loss: 52164132.4444; val_kl_reg_loss: 142124.6406; val_edge_recon_loss: 4065715.2500; val_gene_expr_recon_loss: 45516076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1625849.0000; val_global_loss: 51349764.0000; val_optim_loss: 51349764.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8486; val_auprc_score: 0.8564; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 191925.4323; train_edge_recon_loss: 3610854.3611; train_gene_expr_recon_loss: 44510891.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1631959.7361; train_global_loss: 49945630.2222; train_optim_loss: 49945630.2222; val_kl_reg_loss: 132187.4219; val_edge_recon_loss: 4065524.2500; val_gene_expr_recon_loss: 43952444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1609684.7500; val_global_loss: 49759840.0000; val_optim_loss: 49759840.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8391; val_auprc_score: 0.8448; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 185663.7500; train_edge_recon_loss: 3614074.2778; train_gene_expr_recon_loss: 43112996.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1618795.1528; train_global_loss: 48531529.3333; train_optim_loss: 48531529.3333; val_kl_reg_loss: 136932.4062; val_edge_recon_loss: 4065280.7500; val_gene_expr_recon_loss: 42700172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1592870.7500; val_global_loss: 48495256.0000; val_optim_loss: 48495256.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8329; val_auprc_score: 0.8409; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 182262.4306; train_edge_recon_loss: 3604568.3611; train_gene_expr_recon_loss: 41766022.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1588304.7222; train_global_loss: 47141157.7778; train_optim_loss: 47141157.7778; val_kl_reg_loss: 144176.4062; val_edge_recon_loss: 4065100.7500; val_gene_expr_recon_loss: 41644524.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1579071.6250; val_global_loss: 47432872.0000; val_optim_loss: 47432872.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8273; val_auprc_score: 0.8345; val_best_acc_score: 0.5156; val_best_f1_score: 0.6735; train_kl_reg_loss: 182189.8142; train_edge_recon_loss: 3594046.6944; train_gene_expr_recon_loss: 41154532.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1581772.0833; train_global_loss: 46512540.4444; train_optim_loss: 46512540.4444; val_kl_reg_loss: 139773.2344; val_edge_recon_loss: 4064847.7500; val_gene_expr_recon_loss: 40876416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1567163.6250; val_global_loss: 46648200.0000; val_optim_loss: 46648200.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8196; val_auprc_score: 0.8260; val_best_acc_score: 0.5189; val_best_f1_score: 0.6750; train_kl_reg_loss: 178702.8976; train_edge_recon_loss: 3588736.9444; train_gene_expr_recon_loss: 40397313.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1576855.8194; train_global_loss: 45741610.2222; train_optim_loss: 45741610.2222; val_kl_reg_loss: 137289.4375; val_edge_recon_loss: 4064623.0000; val_gene_expr_recon_loss: 40274128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1559232.1250; val_global_loss: 46035272.0000; val_optim_loss: 46035272.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8152; val_auprc_score: 0.8199; val_best_acc_score: 0.5221; val_best_f1_score: 0.6762; train_kl_reg_loss: 176248.4097; train_edge_recon_loss: 3583921.0556; train_gene_expr_recon_loss: 39858657.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1565072.0556; train_global_loss: 45183899.5556; train_optim_loss: 45183899.5556; val_kl_reg_loss: 142078.4062; val_edge_recon_loss: 4064315.5000; val_gene_expr_recon_loss: 39932068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1552061.0000; val_global_loss: 45690524.0000; val_optim_loss: 45690524.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8143; val_auprc_score: 0.8197; val_best_acc_score: 0.5264; val_best_f1_score: 0.6780; train_kl_reg_loss: 170893.1215; train_edge_recon_loss: 3581609.9444; train_gene_expr_recon_loss: 39387953.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1553148.6528; train_global_loss: 44693605.3333; train_optim_loss: 44693605.3333; val_kl_reg_loss: 132000.4688; val_edge_recon_loss: 4063899.2500; val_gene_expr_recon_loss: 39641896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545662.0000; val_global_loss: 45383456.0000; val_optim_loss: 45383456.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8112; val_auprc_score: 0.8110; val_best_acc_score: 0.5318; val_best_f1_score: 0.6803; train_kl_reg_loss: 167055.6076; train_edge_recon_loss: 3579315.9722; train_gene_expr_recon_loss: 39220667.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558873.2500; train_global_loss: 44525912.0000; train_optim_loss: 44525912.0000; val_kl_reg_loss: 130377.7969; val_edge_recon_loss: 4063445.7500; val_gene_expr_recon_loss: 39383796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540098.7500; val_global_loss: 45117720.0000; val_optim_loss: 45117720.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8146; val_auprc_score: 0.8127; val_best_acc_score: 0.5402; val_best_f1_score: 0.6834; train_kl_reg_loss: 166826.6319; train_edge_recon_loss: 3572317.8056; train_gene_expr_recon_loss: 39184048.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558403.3472; train_global_loss: 44481597.7778; train_optim_loss: 44481597.7778; val_kl_reg_loss: 134279.3281; val_edge_recon_loss: 4062786.0000; val_gene_expr_recon_loss: 39217220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537970.7500; val_global_loss: 44952256.0000; val_optim_loss: 44952256.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8201; val_auprc_score: 0.8156; val_best_acc_score: 0.5562; val_best_f1_score: 0.6904; train_kl_reg_loss: 161776.8524; train_edge_recon_loss: 3571073.0833; train_gene_expr_recon_loss: 38834678.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541715.4722; train_global_loss: 44109243.1111; train_optim_loss: 44109243.1111; val_kl_reg_loss: 124532.9531; val_edge_recon_loss: 4061860.2500; val_gene_expr_recon_loss: 39086860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533488.1250; val_global_loss: 44806740.0000; val_optim_loss: 44806740.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8321; val_auprc_score: 0.8313; val_best_acc_score: 0.5819; val_best_f1_score: 0.7019; train_kl_reg_loss: 159132.6762; train_edge_recon_loss: 3567760.8611; train_gene_expr_recon_loss: 38964019.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1549673.7917; train_global_loss: 44240586.6667; train_optim_loss: 44240586.6667; val_kl_reg_loss: 134959.9531; val_edge_recon_loss: 4060629.5000; val_gene_expr_recon_loss: 38979612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533174.1250; val_global_loss: 44708376.0000; val_optim_loss: 44708376.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8341; val_auprc_score: 0.8270; val_best_acc_score: 0.6132; val_best_f1_score: 0.7171; train_kl_reg_loss: 156597.7969; train_edge_recon_loss: 3562568.9722; train_gene_expr_recon_loss: 38711972.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533377.4167; train_global_loss: 43964516.0000; train_optim_loss: 43964516.0000; val_kl_reg_loss: 128095.1875; val_edge_recon_loss: 4058932.0000; val_gene_expr_recon_loss: 38843952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529679.8750; val_global_loss: 44560660.0000; val_optim_loss: 44560660.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8389; val_auprc_score: 0.8359; val_best_acc_score: 0.6618; val_best_f1_score: 0.7410; train_kl_reg_loss: 152644.5920; train_edge_recon_loss: 3562261.3611; train_gene_expr_recon_loss: 38617861.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541765.8333; train_global_loss: 43874534.2222; train_optim_loss: 43874534.2222; val_kl_reg_loss: 115913.5938; val_edge_recon_loss: 4055690.2500; val_gene_expr_recon_loss: 38828472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529200.0000; val_global_loss: 44529276.0000; val_optim_loss: 44529276.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8421; val_auprc_score: 0.8377; val_best_acc_score: 0.6807; val_best_f1_score: 0.7500; train_kl_reg_loss: 147316.5069; train_edge_recon_loss: 3563645.7500; train_gene_expr_recon_loss: 38404799.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538557.2361; train_global_loss: 43654318.6667; train_optim_loss: 43654318.6667; val_kl_reg_loss: 125145.7031; val_edge_recon_loss: 4053587.5000; val_gene_expr_recon_loss: 38710764.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527437.6250; val_global_loss: 44416932.0000; val_optim_loss: 44416932.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8522; val_auprc_score: 0.8447; val_best_acc_score: 0.7179; val_best_f1_score: 0.7691; train_kl_reg_loss: 151193.2170; train_edge_recon_loss: 3552548.6667; train_gene_expr_recon_loss: 38424717.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1527832.0972; train_global_loss: 43656291.1111; train_optim_loss: 43656291.1111; val_kl_reg_loss: 121111.6719; val_edge_recon_loss: 4049064.0000; val_gene_expr_recon_loss: 38635284.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522965.8750; val_global_loss: 44328424.0000; val_optim_loss: 44328424.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8549; val_auprc_score: 0.8455; val_best_acc_score: 0.7394; val_best_f1_score: 0.7794; train_kl_reg_loss: 143490.7040; train_edge_recon_loss: 3555672.5278; train_gene_expr_recon_loss: 38501040.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1534115.2639; train_global_loss: 43734318.6667; train_optim_loss: 43734318.6667; val_kl_reg_loss: 120139.8594; val_edge_recon_loss: 4044262.5000; val_gene_expr_recon_loss: 38613720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524961.8750; val_global_loss: 44303084.0000; val_optim_loss: 44303084.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8626; val_auprc_score: 0.8525; val_best_acc_score: 0.6911; val_best_f1_score: 0.7590; train_kl_reg_loss: 188216.0868; train_edge_recon_loss: 3671359.6389; train_gene_expr_recon_loss: 38747947.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540359.1528; train_global_loss: 44147883.1111; train_optim_loss: 44147883.1111; val_kl_reg_loss: 103238.8281; val_edge_recon_loss: 4053284.7500; val_gene_expr_recon_loss: 38735760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527353.7500; val_global_loss: 44419636.0000; val_optim_loss: 44419636.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8547; val_auprc_score: 0.8400; val_best_acc_score: 0.5912; val_best_f1_score: 0.7084; train_kl_reg_loss: 91353.0000; train_edge_recon_loss: 3742382.5278; train_gene_expr_recon_loss: 38876198.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546222.6111; train_global_loss: 44256157.3333; train_optim_loss: 44256157.3333; val_kl_reg_loss: 60317.0234; val_edge_recon_loss: 4060777.7500; val_gene_expr_recon_loss: 38935216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528208.2500; val_global_loss: 44584520.0000; val_optim_loss: 44584520.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8281; val_auprc_score: 0.8171; val_best_acc_score: 0.5427; val_best_f1_score: 0.6859; train_kl_reg_loss: 92513.4809; train_edge_recon_loss: 3695775.6389; train_gene_expr_recon_loss: 38841423.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1534430.7361; train_global_loss: 44164143.1111; train_optim_loss: 44164143.1111; val_kl_reg_loss: 42099.6797; val_edge_recon_loss: 4063091.2500; val_gene_expr_recon_loss: 39225016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529971.7500; val_global_loss: 44860180.0000; val_optim_loss: 44860180.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8192; val_auprc_score: 0.8086; val_best_acc_score: 0.5187; val_best_f1_score: 0.6751; train_kl_reg_loss: 65761.9253; train_edge_recon_loss: 3719784.6389; train_gene_expr_recon_loss: 38966350.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547289.6667; train_global_loss: 44299186.6667; train_optim_loss: 44299186.6667; val_kl_reg_loss: 42220.2812; val_edge_recon_loss: 4063854.2500; val_gene_expr_recon_loss: 39049912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1525414.1250; val_global_loss: 44681404.0000; val_optim_loss: 44681404.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8203; val_auprc_score: 0.8069; val_best_acc_score: 0.5166; val_best_f1_score: 0.6741; train_kl_reg_loss: 49240.4128; train_edge_recon_loss: 3743860.2222; train_gene_expr_recon_loss: 38824793.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1532374.6250; train_global_loss: 44150269.3333; train_optim_loss: 44150269.3333; val_kl_reg_loss: 56740.3594; val_edge_recon_loss: 4064020.2500; val_gene_expr_recon_loss: 38805856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524308.0000; val_global_loss: 44450924.0000; val_optim_loss: 44450924.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8230; val_auprc_score: 0.8120; val_best_acc_score: 0.5218; val_best_f1_score: 0.6765; train_kl_reg_loss: 69292.4909; train_edge_recon_loss: 3675366.4444; train_gene_expr_recon_loss: 38920986.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538091.6111; train_global_loss: 44203737.7778; train_optim_loss: 44203737.7778; val_kl_reg_loss: 63953.3359; val_edge_recon_loss: 4063860.0000; val_gene_expr_recon_loss: 38697032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1519955.5000; val_global_loss: 44344800.0000; val_optim_loss: 44344800.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8242; val_auprc_score: 0.8063; val_best_acc_score: 0.5283; val_best_f1_score: 0.6793; train_kl_reg_loss: 63221.6285; train_edge_recon_loss: 3684406.8333; train_gene_expr_recon_loss: 38740153.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1537943.9583; train_global_loss: 44025725.7778; train_optim_loss: 44025725.7778; val_kl_reg_loss: 58337.3672; val_edge_recon_loss: 4063569.0000; val_gene_expr_recon_loss: 38733896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522669.0000; val_global_loss: 44378472.0000; val_optim_loss: 44378472.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8223; val_auprc_score: 0.8083; val_best_acc_score: 0.5305; val_best_f1_score: 0.6803; train_kl_reg_loss: 72629.2821; train_edge_recon_loss: 3697640.2778; train_gene_expr_recon_loss: 38534440.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536277.9444; train_global_loss: 43840988.4444; train_optim_loss: 43840988.4444; val_kl_reg_loss: 75457.1641; val_edge_recon_loss: 4063567.7500; val_gene_expr_recon_loss: 38704268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523837.3750; val_global_loss: 44367128.0000; val_optim_loss: 44367128.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8586
val AUPRC score: 0.8482
val best accuracy score: 0.7150
val best F1 score: 0.7688
val target rna MSE score: 1.4996
val source rna MSE score: 1.0718
val target atac MSE score: 0.1285
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
