[True]
Run timestamp: 10082023_192052_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7939; val_auprc_score: 0.8080; val_best_acc_score: 0.5777; val_best_f1_score: 0.6988; train_kl_reg_loss: 244659.2693; train_edge_recon_loss: 3758086.3378; train_gene_expr_recon_loss: 27017068.8397; train_masked_gp_l1_reg_loss: 76814.0471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242104.1718; train_chrom_access_recon_loss: 73331986.7176; train_global_loss: 104670719.2061; train_optim_loss: 104670719.2061; val_kl_reg_loss: 304999.1979; val_edge_recon_loss: 4060973.7000; val_gene_expr_recon_loss: 22818997.6000; val_masked_gp_l1_reg_loss: 68964.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234882.7344; val_chrom_access_recon_loss: 69594265.0667; val_global_loss: 97083080.5333; val_optim_loss: 97083080.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8806; val_auprc_score: 0.8734; val_best_acc_score: 0.7720; val_best_f1_score: 0.8052; train_kl_reg_loss: 252516.1868; train_edge_recon_loss: 3610668.6469; train_gene_expr_recon_loss: 22645843.7252; train_masked_gp_l1_reg_loss: 66548.3464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224220.0420; train_chrom_access_recon_loss: 69269978.0153; train_global_loss: 96069775.0840; train_optim_loss: 96069775.0840; val_kl_reg_loss: 237483.8760; val_edge_recon_loss: 3941886.7833; val_gene_expr_recon_loss: 22214359.4667; val_masked_gp_l1_reg_loss: 66508.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212980.9844; val_chrom_access_recon_loss: 68833487.7333; val_global_loss: 95506705.0667; val_optim_loss: 95506705.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8933; val_auprc_score: 0.8820; val_best_acc_score: 0.8088; val_best_f1_score: 0.8216; train_kl_reg_loss: 209123.6573; train_edge_recon_loss: 3347340.4485; train_gene_expr_recon_loss: 22162611.3130; train_masked_gp_l1_reg_loss: 67922.8772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202067.8024; train_chrom_access_recon_loss: 68606375.2366; train_global_loss: 94595441.6489; train_optim_loss: 94595441.6489; val_kl_reg_loss: 233793.8604; val_edge_recon_loss: 3089807.5167; val_gene_expr_recon_loss: 22004906.1333; val_masked_gp_l1_reg_loss: 69408.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191330.8438; val_chrom_access_recon_loss: 68610472.2667; val_global_loss: 94199717.8667; val_optim_loss: 94199717.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9013; val_auprc_score: 0.8902; val_best_acc_score: 0.8130; val_best_f1_score: 0.8326; train_kl_reg_loss: 236762.4169; train_edge_recon_loss: 3032906.3645; train_gene_expr_recon_loss: 21963665.1145; train_masked_gp_l1_reg_loss: 70437.0374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181622.0104; train_chrom_access_recon_loss: 68139471.8473; train_global_loss: 93624864.8550; train_optim_loss: 93624864.8550; val_kl_reg_loss: 228682.9167; val_edge_recon_loss: 3006926.1500; val_gene_expr_recon_loss: 21905690.8000; val_masked_gp_l1_reg_loss: 71531.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172305.3906; val_chrom_access_recon_loss: 68172929.8667; val_global_loss: 93558067.7333; val_optim_loss: 93558067.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9066; val_auprc_score: 0.8895; val_best_acc_score: 0.8279; val_best_f1_score: 0.8424; train_kl_reg_loss: 223600.6221; train_edge_recon_loss: 2971999.4809; train_gene_expr_recon_loss: 21786046.3969; train_masked_gp_l1_reg_loss: 72741.1352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164140.8702; train_chrom_access_recon_loss: 67763310.1069; train_global_loss: 92981838.5954; train_optim_loss: 92981838.5954; val_kl_reg_loss: 222235.5927; val_edge_recon_loss: 2977015.9000; val_gene_expr_recon_loss: 21677226.1333; val_masked_gp_l1_reg_loss: 73984.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156357.6875; val_chrom_access_recon_loss: 67531797.3333; val_global_loss: 92638616.5333; val_optim_loss: 92638616.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9164; val_auprc_score: 0.9010; val_best_acc_score: 0.8398; val_best_f1_score: 0.8503; train_kl_reg_loss: 212548.1914; train_edge_recon_loss: 2944265.5420; train_gene_expr_recon_loss: 21659919.1603; train_masked_gp_l1_reg_loss: 75189.4208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149579.4798; train_chrom_access_recon_loss: 67371089.9542; train_global_loss: 92412592.3664; train_optim_loss: 92412592.3664; val_kl_reg_loss: 204213.9281; val_edge_recon_loss: 2924464.0333; val_gene_expr_recon_loss: 21577249.7333; val_masked_gp_l1_reg_loss: 76419.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143093.5000; val_chrom_access_recon_loss: 67499157.6000; val_global_loss: 92424598.9333; val_optim_loss: 92424598.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9302; val_auprc_score: 0.9180; val_best_acc_score: 0.8576; val_best_f1_score: 0.8636; train_kl_reg_loss: 200695.7906; train_edge_recon_loss: 2913903.8664; train_gene_expr_recon_loss: 21540988.1679; train_masked_gp_l1_reg_loss: 77759.5961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137495.9392; train_chrom_access_recon_loss: 67086545.2519; train_global_loss: 91957388.7634; train_optim_loss: 91957388.7634; val_kl_reg_loss: 195605.9583; val_edge_recon_loss: 2907889.3167; val_gene_expr_recon_loss: 21482571.6000; val_masked_gp_l1_reg_loss: 78907.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132043.8281; val_chrom_access_recon_loss: 67101145.6000; val_global_loss: 91898164.8000; val_optim_loss: 91898164.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9416; val_auprc_score: 0.9305; val_best_acc_score: 0.8728; val_best_f1_score: 0.8803; train_kl_reg_loss: 193468.5173; train_edge_recon_loss: 2882774.5229; train_gene_expr_recon_loss: 21406846.8702; train_masked_gp_l1_reg_loss: 80157.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127129.4169; train_chrom_access_recon_loss: 66683582.1069; train_global_loss: 91373959.3893; train_optim_loss: 91373959.3893; val_kl_reg_loss: 192300.8333; val_edge_recon_loss: 2889717.1500; val_gene_expr_recon_loss: 21317581.0667; val_masked_gp_l1_reg_loss: 81247.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122493.5703; val_chrom_access_recon_loss: 66597774.4000; val_global_loss: 91201115.7333; val_optim_loss: 91201115.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9470; val_auprc_score: 0.9331; val_best_acc_score: 0.8825; val_best_f1_score: 0.8889; train_kl_reg_loss: 188233.9064; train_edge_recon_loss: 2858697.3244; train_gene_expr_recon_loss: 21335383.2061; train_masked_gp_l1_reg_loss: 82436.3817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118210.0815; train_chrom_access_recon_loss: 66473864.6412; train_global_loss: 91056825.4656; train_optim_loss: 91056825.4656; val_kl_reg_loss: 184821.5917; val_edge_recon_loss: 2847866.3500; val_gene_expr_recon_loss: 21241777.7333; val_masked_gp_l1_reg_loss: 83557.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114257.5703; val_chrom_access_recon_loss: 66682109.3333; val_global_loss: 91154391.4667; val_optim_loss: 91154391.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9545; val_auprc_score: 0.9434; val_best_acc_score: 0.8942; val_best_f1_score: 0.8994; train_kl_reg_loss: 183948.4622; train_edge_recon_loss: 2832150.5191; train_gene_expr_recon_loss: 21259551.6183; train_masked_gp_l1_reg_loss: 84659.5645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110683.4822; train_chrom_access_recon_loss: 66241937.3435; train_global_loss: 90712930.9313; train_optim_loss: 90712930.9313; val_kl_reg_loss: 183426.3667; val_edge_recon_loss: 2837181.0667; val_gene_expr_recon_loss: 21252807.6000; val_masked_gp_l1_reg_loss: 85526.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107272.9766; val_chrom_access_recon_loss: 66604008.5333; val_global_loss: 91070221.3333; val_optim_loss: 91070221.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9574; val_auprc_score: 0.9475; val_best_acc_score: 0.8983; val_best_f1_score: 0.9006; train_kl_reg_loss: 180951.4882; train_edge_recon_loss: 2818906.1565; train_gene_expr_recon_loss: 21160324.0305; train_masked_gp_l1_reg_loss: 86701.2506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104194.3821; train_chrom_access_recon_loss: 65926205.9847; train_global_loss: 90277283.1756; train_optim_loss: 90277283.1756; val_kl_reg_loss: 177549.2156; val_edge_recon_loss: 2824328.0833; val_gene_expr_recon_loss: 21222219.8667; val_masked_gp_l1_reg_loss: 87750.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101449.1797; val_chrom_access_recon_loss: 66520554.4000; val_global_loss: 90933851.2000; val_optim_loss: 90933851.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9563; val_auprc_score: 0.9466; val_best_acc_score: 0.8996; val_best_f1_score: 0.9055; train_kl_reg_loss: 175126.8408; train_edge_recon_loss: 2807947.5382; train_gene_expr_recon_loss: 21088971.8779; train_masked_gp_l1_reg_loss: 88805.5924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99044.4042; train_chrom_access_recon_loss: 65695681.1603; train_global_loss: 89955577.5267; train_optim_loss: 89955577.5267; val_kl_reg_loss: 172589.8750; val_edge_recon_loss: 2833513.5500; val_gene_expr_recon_loss: 20967480.0000; val_masked_gp_l1_reg_loss: 89704.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96623.2891; val_chrom_access_recon_loss: 65689044.2667; val_global_loss: 89848956.2667; val_optim_loss: 89848956.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9592; val_auprc_score: 0.9494; val_best_acc_score: 0.9018; val_best_f1_score: 0.9061; train_kl_reg_loss: 168782.7812; train_edge_recon_loss: 2803047.1489; train_gene_expr_recon_loss: 21021226.5344; train_masked_gp_l1_reg_loss: 90756.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94485.5673; train_chrom_access_recon_loss: 65353487.8168; train_global_loss: 89531786.7481; train_optim_loss: 89531786.7481; val_kl_reg_loss: 167526.6469; val_edge_recon_loss: 2815046.2667; val_gene_expr_recon_loss: 20955887.4667; val_masked_gp_l1_reg_loss: 91900.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92461.6562; val_chrom_access_recon_loss: 65516592.0000; val_global_loss: 89639414.4000; val_optim_loss: 89639414.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9640; val_auprc_score: 0.9537; val_best_acc_score: 0.9095; val_best_f1_score: 0.9139; train_kl_reg_loss: 167005.6984; train_edge_recon_loss: 2788841.1985; train_gene_expr_recon_loss: 20996372.2748; train_masked_gp_l1_reg_loss: 92876.4632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90333.6684; train_chrom_access_recon_loss: 65405903.6336; train_global_loss: 89541333.4351; train_optim_loss: 89541333.4351; val_kl_reg_loss: 161295.0312; val_edge_recon_loss: 2796615.8167; val_gene_expr_recon_loss: 20966736.0000; val_masked_gp_l1_reg_loss: 93802.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88409.4375; val_chrom_access_recon_loss: 65399973.6000; val_global_loss: 89506832.0000; val_optim_loss: 89506832.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9675; val_auprc_score: 0.9602; val_best_acc_score: 0.9136; val_best_f1_score: 0.9163; train_kl_reg_loss: 162433.0401; train_edge_recon_loss: 2789284.8950; train_gene_expr_recon_loss: 20926205.2214; train_masked_gp_l1_reg_loss: 94836.1082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86577.8420; train_chrom_access_recon_loss: 65206415.3282; train_global_loss: 89265752.6107; train_optim_loss: 89265752.6107; val_kl_reg_loss: 159697.4698; val_edge_recon_loss: 2782482.9667; val_gene_expr_recon_loss: 20860142.2667; val_masked_gp_l1_reg_loss: 95598.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84714.7969; val_chrom_access_recon_loss: 65152387.4667; val_global_loss: 89135021.8667; val_optim_loss: 89135021.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9673; val_auprc_score: 0.9615; val_best_acc_score: 0.9107; val_best_f1_score: 0.9154; train_kl_reg_loss: 159934.2183; train_edge_recon_loss: 2787912.8989; train_gene_expr_recon_loss: 20897616.1527; train_masked_gp_l1_reg_loss: 96741.1199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82969.2439; train_chrom_access_recon_loss: 65077393.3130; train_global_loss: 89102566.9618; train_optim_loss: 89102566.9618; val_kl_reg_loss: 153863.1271; val_edge_recon_loss: 2791439.1667; val_gene_expr_recon_loss: 20939003.0667; val_masked_gp_l1_reg_loss: 97568.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81390.5781; val_chrom_access_recon_loss: 65691015.4667; val_global_loss: 89754278.9333; val_optim_loss: 89754278.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9695; val_auprc_score: 0.9639; val_best_acc_score: 0.9162; val_best_f1_score: 0.9187; train_kl_reg_loss: 156975.4946; train_edge_recon_loss: 2772861.2844; train_gene_expr_recon_loss: 20819281.0687; train_masked_gp_l1_reg_loss: 98590.1583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79899.8578; train_chrom_access_recon_loss: 64772332.5496; train_global_loss: 88699940.3359; train_optim_loss: 88699940.3359; val_kl_reg_loss: 155107.4427; val_edge_recon_loss: 2793827.1833; val_gene_expr_recon_loss: 20795229.0667; val_masked_gp_l1_reg_loss: 99437.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78460.2422; val_chrom_access_recon_loss: 64965303.2000; val_global_loss: 88887366.4000; val_optim_loss: 88887366.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9698; val_auprc_score: 0.9635; val_best_acc_score: 0.9181; val_best_f1_score: 0.9211; train_kl_reg_loss: 154010.6276; train_edge_recon_loss: 2772929.5553; train_gene_expr_recon_loss: 20805187.4809; train_masked_gp_l1_reg_loss: 100461.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77228.3101; train_chrom_access_recon_loss: 64774168.7023; train_global_loss: 88683985.8321; train_optim_loss: 88683985.8321; val_kl_reg_loss: 150442.4323; val_edge_recon_loss: 2788261.3167; val_gene_expr_recon_loss: 20857359.8667; val_masked_gp_l1_reg_loss: 101287.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76004.5625; val_chrom_access_recon_loss: 65230804.0000; val_global_loss: 89204160.0000; val_optim_loss: 89204160.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9693; val_auprc_score: 0.9623; val_best_acc_score: 0.9143; val_best_f1_score: 0.9179; train_kl_reg_loss: 151336.0383; train_edge_recon_loss: 2768219.3836; train_gene_expr_recon_loss: 20756228.6260; train_masked_gp_l1_reg_loss: 102217.6913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74730.0398; train_chrom_access_recon_loss: 64657047.6031; train_global_loss: 88509779.3588; train_optim_loss: 88509779.3588; val_kl_reg_loss: 150063.1865; val_edge_recon_loss: 2791469.6667; val_gene_expr_recon_loss: 20727555.6000; val_masked_gp_l1_reg_loss: 103029.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73588.5469; val_chrom_access_recon_loss: 64551519.2000; val_global_loss: 88397226.6667; val_optim_loss: 88397226.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9709; val_auprc_score: 0.9654; val_best_acc_score: 0.9181; val_best_f1_score: 0.9219; train_kl_reg_loss: 151210.9358; train_edge_recon_loss: 2768338.9561; train_gene_expr_recon_loss: 20713397.7252; train_masked_gp_l1_reg_loss: 104015.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72599.7617; train_chrom_access_recon_loss: 64537609.8626; train_global_loss: 88347172.5802; train_optim_loss: 88347172.5802; val_kl_reg_loss: 148011.2885; val_edge_recon_loss: 2796963.5667; val_gene_expr_recon_loss: 20726142.0000; val_masked_gp_l1_reg_loss: 104928.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71621.0312; val_chrom_access_recon_loss: 64979630.4000; val_global_loss: 88827297.0667; val_optim_loss: 88827297.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9715; val_auprc_score: 0.9654; val_best_acc_score: 0.9235; val_best_f1_score: 0.9259; train_kl_reg_loss: 149999.6992; train_edge_recon_loss: 2763982.0935; train_gene_expr_recon_loss: 20653247.6489; train_masked_gp_l1_reg_loss: 105688.4822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70732.3890; train_chrom_access_recon_loss: 64272266.0763; train_global_loss: 88015916.3359; train_optim_loss: 88015916.3359; val_kl_reg_loss: 146232.5312; val_edge_recon_loss: 2777539.4167; val_gene_expr_recon_loss: 20729136.9333; val_masked_gp_l1_reg_loss: 106391.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69779.0312; val_chrom_access_recon_loss: 64837472.2667; val_global_loss: 88666553.6000; val_optim_loss: 88666553.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9778; val_auprc_score: 0.9744; val_best_acc_score: 0.9282; val_best_f1_score: 0.9300; train_kl_reg_loss: 147368.0581; train_edge_recon_loss: 2766153.6584; train_gene_expr_recon_loss: 20615970.1985; train_masked_gp_l1_reg_loss: 107103.2349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68949.0708; train_chrom_access_recon_loss: 64193976.9771; train_global_loss: 87899521.2824; train_optim_loss: 87899521.2824; val_kl_reg_loss: 147089.7188; val_edge_recon_loss: 2766731.4167; val_gene_expr_recon_loss: 20650600.8000; val_masked_gp_l1_reg_loss: 107929.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68086.1797; val_chrom_access_recon_loss: 64541168.2667; val_global_loss: 88281606.4000; val_optim_loss: 88281606.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9754; val_auprc_score: 0.9698; val_best_acc_score: 0.9227; val_best_f1_score: 0.9264; train_kl_reg_loss: 146444.3440; train_edge_recon_loss: 2758644.4618; train_gene_expr_recon_loss: 20571436.9771; train_masked_gp_l1_reg_loss: 108706.0673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67268.3648; train_chrom_access_recon_loss: 64070923.9084; train_global_loss: 87723424.4275; train_optim_loss: 87723424.4275; val_kl_reg_loss: 144422.2865; val_edge_recon_loss: 2783990.8667; val_gene_expr_recon_loss: 20529502.6667; val_masked_gp_l1_reg_loss: 109479.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66571.3359; val_chrom_access_recon_loss: 63804275.4667; val_global_loss: 87438242.6667; val_optim_loss: 87438242.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9765; val_auprc_score: 0.9727; val_best_acc_score: 0.9279; val_best_f1_score: 0.9307; train_kl_reg_loss: 145673.2722; train_edge_recon_loss: 2759600.4103; train_gene_expr_recon_loss: 20566126.7176; train_masked_gp_l1_reg_loss: 110211.8704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65708.0887; train_chrom_access_recon_loss: 64111639.6336; train_global_loss: 87758959.9389; train_optim_loss: 87758959.9389; val_kl_reg_loss: 143195.0438; val_edge_recon_loss: 2754143.8833; val_gene_expr_recon_loss: 20796463.7333; val_masked_gp_l1_reg_loss: 110850.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64853.4258; val_chrom_access_recon_loss: 64189775.7333; val_global_loss: 88059282.6667; val_optim_loss: 88059282.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9775; val_auprc_score: 0.9729; val_best_acc_score: 0.9266; val_best_f1_score: 0.9290; train_kl_reg_loss: 142851.1366; train_edge_recon_loss: 2762748.9218; train_gene_expr_recon_loss: 20726399.8321; train_masked_gp_l1_reg_loss: 111367.7380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64030.9819; train_chrom_access_recon_loss: 64131566.4733; train_global_loss: 87938965.0076; train_optim_loss: 87938965.0076; val_kl_reg_loss: 145738.0708; val_edge_recon_loss: 2756431.0333; val_gene_expr_recon_loss: 20637284.4000; val_masked_gp_l1_reg_loss: 111887.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62801.8438; val_chrom_access_recon_loss: 63849763.4667; val_global_loss: 87563907.2000; val_optim_loss: 87563907.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9758; val_auprc_score: 0.9719; val_best_acc_score: 0.9263; val_best_f1_score: 0.9285; train_kl_reg_loss: 156947.5869; train_edge_recon_loss: 2825366.8263; train_gene_expr_recon_loss: 21864579.9542; train_masked_gp_l1_reg_loss: 109690.4800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63325.5567; train_chrom_access_recon_loss: 65129485.0992; train_global_loss: 90149395.7252; train_optim_loss: 90149395.7252; val_kl_reg_loss: 69678.6042; val_edge_recon_loss: 2802498.2333; val_gene_expr_recon_loss: 22432142.1333; val_masked_gp_l1_reg_loss: 108872.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63397.1797; val_chrom_access_recon_loss: 65822188.2667; val_global_loss: 91298777.6000; val_optim_loss: 91298777.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9630; val_best_acc_score: 0.9166; val_best_f1_score: 0.9199; train_kl_reg_loss: 153461.3927; train_edge_recon_loss: 2799836.8359; train_gene_expr_recon_loss: 21798301.8779; train_masked_gp_l1_reg_loss: 108808.1733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63275.3131; train_chrom_access_recon_loss: 65030610.9008; train_global_loss: 89954294.5344; train_optim_loss: 89954294.5344; val_kl_reg_loss: 63187.5310; val_edge_recon_loss: 2821156.9500; val_gene_expr_recon_loss: 21697960.6667; val_masked_gp_l1_reg_loss: 108755.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63099.0547; val_chrom_access_recon_loss: 65344604.5333; val_global_loss: 90098766.4000; val_optim_loss: 90098766.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9706; val_auprc_score: 0.9625; val_best_acc_score: 0.9139; val_best_f1_score: 0.9163; train_kl_reg_loss: 149584.6583; train_edge_recon_loss: 2817077.9504; train_gene_expr_recon_loss: 21766153.5115; train_masked_gp_l1_reg_loss: 108364.6799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62866.9336; train_chrom_access_recon_loss: 65088319.9389; train_global_loss: 89992367.5115; train_optim_loss: 89992367.5115; val_kl_reg_loss: 63988.6177; val_edge_recon_loss: 2818107.5167; val_gene_expr_recon_loss: 21778869.4667; val_masked_gp_l1_reg_loss: 108256.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62697.0352; val_chrom_access_recon_loss: 65538662.9333; val_global_loss: 90370582.9333; val_optim_loss: 90370582.9333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9718; val_auprc_score: 0.9672; val_best_acc_score: 0.9162; val_best_f1_score: 0.9188; train_kl_reg_loss: 153920.5194; train_edge_recon_loss: 2799066.3760; train_gene_expr_recon_loss: 21782201.0229; train_masked_gp_l1_reg_loss: 108224.1578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62544.8430; train_chrom_access_recon_loss: 65145223.3588; train_global_loss: 90051180.5802; train_optim_loss: 90051180.5802; val_kl_reg_loss: 66015.3977; val_edge_recon_loss: 2831054.2333; val_gene_expr_recon_loss: 21740963.6000; val_masked_gp_l1_reg_loss: 108189.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62389.1719; val_chrom_access_recon_loss: 65116541.0667; val_global_loss: 89925153.6000; val_optim_loss: 89925153.6000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9713; val_auprc_score: 0.9664; val_best_acc_score: 0.9167; val_best_f1_score: 0.9191; train_kl_reg_loss: 154389.8556; train_edge_recon_loss: 2796732.0534; train_gene_expr_recon_loss: 21861718.6870; train_masked_gp_l1_reg_loss: 108114.2319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62362.2890; train_chrom_access_recon_loss: 65175220.7023; train_global_loss: 90158537.6489; train_optim_loss: 90158537.6489; val_kl_reg_loss: 68052.3708; val_edge_recon_loss: 2796829.5667; val_gene_expr_recon_loss: 21873826.8000; val_masked_gp_l1_reg_loss: 108031.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62334.7969; val_chrom_access_recon_loss: 65723552.0000; val_global_loss: 90632627.2000; val_optim_loss: 90632627.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9724; val_auprc_score: 0.9681; val_best_acc_score: 0.9170; val_best_f1_score: 0.9195; train_kl_reg_loss: 152513.1719; train_edge_recon_loss: 2789238.7481; train_gene_expr_recon_loss: 21833796.9924; train_masked_gp_l1_reg_loss: 107912.0475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62272.4181; train_chrom_access_recon_loss: 65114629.3435; train_global_loss: 90060362.6870; train_optim_loss: 90060362.6870; val_kl_reg_loss: 70188.5323; val_edge_recon_loss: 2816103.9667; val_gene_expr_recon_loss: 21813819.6000; val_masked_gp_l1_reg_loss: 107773.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62176.3047; val_chrom_access_recon_loss: 65325567.4667; val_global_loss: 90195629.3333; val_optim_loss: 90195629.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 42 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9767
val AUPRC score: 0.9728
val best accuracy score: 0.9286
val best F1 score: 0.9299
val target rna MSE score: 1.6118
val source rna MSE score: 47.7016
val target atac MSE score: 0.1266
val source atac MSE score: 0.9380
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
