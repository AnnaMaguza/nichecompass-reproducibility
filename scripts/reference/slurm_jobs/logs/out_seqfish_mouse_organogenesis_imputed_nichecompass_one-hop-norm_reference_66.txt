[True]
Run timestamp: 01082023_090822_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9117; val_auprc_score: 0.9832; val_best_acc_score: 0.8571; val_best_f1_score: 0.9231; train_kl_reg_loss: 280118.1549; train_edge_recon_loss: 117232.2883; train_gene_expr_recon_loss: 47908895.7778; train_masked_gp_l1_reg_loss: 13951.0631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118605.2555; train_global_loss: 48438802.1481; train_optim_loss: 48438802.1481; val_kl_reg_loss: 397076.7865; val_edge_recon_loss: 116158.7174; val_gene_expr_recon_loss: 39849574.6667; val_masked_gp_l1_reg_loss: 14661.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110064.2109; val_global_loss: 40487533.3333; val_optim_loss: 40487533.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8841; val_auprc_score: 0.9765; val_best_acc_score: 0.8504; val_best_f1_score: 0.9191; train_kl_reg_loss: 377189.7529; train_edge_recon_loss: 119375.1668; train_gene_expr_recon_loss: 35323293.9259; train_masked_gp_l1_reg_loss: 14673.9911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103229.8274; train_global_loss: 35937763.2222; train_optim_loss: 35937763.2222; val_kl_reg_loss: 332905.9271; val_edge_recon_loss: 121653.2982; val_gene_expr_recon_loss: 29909716.3333; val_masked_gp_l1_reg_loss: 14608.5400; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96648.1328; val_global_loss: 30475531.3333; val_optim_loss: 30475531.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8621; val_auprc_score: 0.9721; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 320327.4606; train_edge_recon_loss: 118774.6049; train_gene_expr_recon_loss: 26356800.3333; train_masked_gp_l1_reg_loss: 14502.4805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91249.7073; train_global_loss: 26901654.5926; train_optim_loss: 26901654.5926; val_kl_reg_loss: 286653.0052; val_edge_recon_loss: 120678.2266; val_gene_expr_recon_loss: 24129098.3333; val_masked_gp_l1_reg_loss: 14392.7334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86151.6328; val_global_loss: 24636973.6667; val_optim_loss: 24636973.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8500; val_auprc_score: 0.9683; val_best_acc_score: 0.8650; val_best_f1_score: 0.9266; train_kl_reg_loss: 276278.6594; train_edge_recon_loss: 118966.0213; train_gene_expr_recon_loss: 23542578.4815; train_masked_gp_l1_reg_loss: 14312.6721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82240.4494; train_global_loss: 24034376.5556; train_optim_loss: 24034376.5556; val_kl_reg_loss: 246578.4740; val_edge_recon_loss: 119801.1810; val_gene_expr_recon_loss: 23189115.3333; val_masked_gp_l1_reg_loss: 14249.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78715.6641; val_global_loss: 23648460.6667; val_optim_loss: 23648460.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8454; val_auprc_score: 0.9674; val_best_acc_score: 0.8813; val_best_f1_score: 0.9338; train_kl_reg_loss: 237824.3385; train_edge_recon_loss: 120364.3566; train_gene_expr_recon_loss: 22998232.4815; train_masked_gp_l1_reg_loss: 14213.9802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76332.3197; train_global_loss: 23446967.3704; train_optim_loss: 23446967.3704; val_kl_reg_loss: 214193.6484; val_edge_recon_loss: 118559.0339; val_gene_expr_recon_loss: 22856340.0000; val_masked_gp_l1_reg_loss: 14191.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74380.5859; val_global_loss: 23277664.0000; val_optim_loss: 23277664.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8430; val_auprc_score: 0.9661; val_best_acc_score: 0.8682; val_best_f1_score: 0.9282; train_kl_reg_loss: 209328.8464; train_edge_recon_loss: 119673.6481; train_gene_expr_recon_loss: 22711900.1111; train_masked_gp_l1_reg_loss: 14193.4204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73503.6108; train_global_loss: 23128599.5926; train_optim_loss: 23128599.5926; val_kl_reg_loss: 191236.2839; val_edge_recon_loss: 119392.2031; val_gene_expr_recon_loss: 22590250.0000; val_masked_gp_l1_reg_loss: 14205.3428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73068.5234; val_global_loss: 22988152.3333; val_optim_loss: 22988152.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8473; val_auprc_score: 0.9683; val_best_acc_score: 0.8756; val_best_f1_score: 0.9317; train_kl_reg_loss: 188562.5350; train_edge_recon_loss: 118772.6700; train_gene_expr_recon_loss: 22491505.7778; train_masked_gp_l1_reg_loss: 14231.5398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72954.3236; train_global_loss: 22886026.7407; train_optim_loss: 22886026.7407; val_kl_reg_loss: 173075.4714; val_edge_recon_loss: 117316.3451; val_gene_expr_recon_loss: 22390114.0000; val_masked_gp_l1_reg_loss: 14266.6465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72848.0625; val_global_loss: 22767619.6667; val_optim_loss: 22767619.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8510; val_auprc_score: 0.9682; val_best_acc_score: 0.8782; val_best_f1_score: 0.9326; train_kl_reg_loss: 172617.0055; train_edge_recon_loss: 117585.3614; train_gene_expr_recon_loss: 22277891.8519; train_masked_gp_l1_reg_loss: 14319.5026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72748.8443; train_global_loss: 22655162.5556; train_optim_loss: 22655162.5556; val_kl_reg_loss: 159858.5130; val_edge_recon_loss: 118072.0443; val_gene_expr_recon_loss: 22204486.3333; val_masked_gp_l1_reg_loss: 14384.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72644.1719; val_global_loss: 22569445.0000; val_optim_loss: 22569445.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8621; val_auprc_score: 0.9701; val_best_acc_score: 0.8797; val_best_f1_score: 0.9327; train_kl_reg_loss: 159736.9146; train_edge_recon_loss: 119147.1538; train_gene_expr_recon_loss: 22087751.3333; train_masked_gp_l1_reg_loss: 14454.8448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72537.9920; train_global_loss: 22453628.0370; train_optim_loss: 22453628.0370; val_kl_reg_loss: 148540.2526; val_edge_recon_loss: 120144.9779; val_gene_expr_recon_loss: 22005870.0000; val_masked_gp_l1_reg_loss: 14532.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72426.0938; val_global_loss: 22361513.3333; val_optim_loss: 22361513.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8643; val_auprc_score: 0.9717; val_best_acc_score: 0.8792; val_best_f1_score: 0.9322; train_kl_reg_loss: 148814.1299; train_edge_recon_loss: 117444.6740; train_gene_expr_recon_loss: 21910073.0370; train_masked_gp_l1_reg_loss: 14609.1573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72315.0488; train_global_loss: 22263256.2222; train_optim_loss: 22263256.2222; val_kl_reg_loss: 138586.2656; val_edge_recon_loss: 117136.9688; val_gene_expr_recon_loss: 21815375.0000; val_masked_gp_l1_reg_loss: 14687.3418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72198.1016; val_global_loss: 22157984.3333; val_optim_loss: 22157984.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8732; val_auprc_score: 0.9731; val_best_acc_score: 0.8781; val_best_f1_score: 0.9323; train_kl_reg_loss: 139613.8976; train_edge_recon_loss: 117075.7036; train_gene_expr_recon_loss: 21735657.4815; train_masked_gp_l1_reg_loss: 14761.6911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72083.7685; train_global_loss: 22079192.4444; train_optim_loss: 22079192.4444; val_kl_reg_loss: 130985.1732; val_edge_recon_loss: 117433.1016; val_gene_expr_recon_loss: 21631632.6667; val_masked_gp_l1_reg_loss: 14830.5566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71963.8750; val_global_loss: 21966845.0000; val_optim_loss: 21966845.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8733; val_auprc_score: 0.9728; val_best_acc_score: 0.8821; val_best_f1_score: 0.9336; train_kl_reg_loss: 131657.9634; train_edge_recon_loss: 116019.6698; train_gene_expr_recon_loss: 21575029.5926; train_masked_gp_l1_reg_loss: 14892.1578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71844.5137; train_global_loss: 21909443.6667; train_optim_loss: 21909443.6667; val_kl_reg_loss: 123183.6862; val_edge_recon_loss: 116342.3997; val_gene_expr_recon_loss: 21508400.3333; val_masked_gp_l1_reg_loss: 14952.3496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71719.3906; val_global_loss: 21834598.3333; val_optim_loss: 21834598.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8749; val_auprc_score: 0.9726; val_best_acc_score: 0.8818; val_best_f1_score: 0.9326; train_kl_reg_loss: 124652.8194; train_edge_recon_loss: 117667.0256; train_gene_expr_recon_loss: 21409110.6667; train_masked_gp_l1_reg_loss: 15002.2480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71598.2556; train_global_loss: 21738031.0000; train_optim_loss: 21738031.0000; val_kl_reg_loss: 117142.4740; val_edge_recon_loss: 117512.0443; val_gene_expr_recon_loss: 21350612.3333; val_masked_gp_l1_reg_loss: 15059.4629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71471.7109; val_global_loss: 21671799.0000; val_optim_loss: 21671799.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8869; val_auprc_score: 0.9756; val_best_acc_score: 0.8854; val_best_f1_score: 0.9339; train_kl_reg_loss: 118532.1144; train_edge_recon_loss: 117626.0618; train_gene_expr_recon_loss: 21257006.4815; train_masked_gp_l1_reg_loss: 15102.7662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71348.7397; train_global_loss: 21579616.3333; train_optim_loss: 21579616.3333; val_kl_reg_loss: 111495.6133; val_edge_recon_loss: 118251.4232; val_gene_expr_recon_loss: 21219517.6667; val_masked_gp_l1_reg_loss: 15153.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71223.8828; val_global_loss: 21535642.6667; val_optim_loss: 21535642.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8887; val_auprc_score: 0.9762; val_best_acc_score: 0.8864; val_best_f1_score: 0.9351; train_kl_reg_loss: 113146.1704; train_edge_recon_loss: 117388.0995; train_gene_expr_recon_loss: 21104405.7407; train_masked_gp_l1_reg_loss: 15201.8831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71105.3031; train_global_loss: 21421247.2593; train_optim_loss: 21421247.2593; val_kl_reg_loss: 107117.3203; val_edge_recon_loss: 116395.6706; val_gene_expr_recon_loss: 21034374.0000; val_masked_gp_l1_reg_loss: 15252.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70985.3203; val_global_loss: 21344125.0000; val_optim_loss: 21344125.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8911; val_auprc_score: 0.9772; val_best_acc_score: 0.8885; val_best_f1_score: 0.9370; train_kl_reg_loss: 108229.4161; train_edge_recon_loss: 115659.9389; train_gene_expr_recon_loss: 20958461.6296; train_masked_gp_l1_reg_loss: 15301.0451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70871.6558; train_global_loss: 21268523.9259; train_optim_loss: 21268523.9259; val_kl_reg_loss: 102248.5794; val_edge_recon_loss: 116682.9948; val_gene_expr_recon_loss: 20881174.0000; val_masked_gp_l1_reg_loss: 15353.7871; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70754.6719; val_global_loss: 21186213.3333; val_optim_loss: 21186213.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8960; val_auprc_score: 0.9782; val_best_acc_score: 0.8899; val_best_f1_score: 0.9377; train_kl_reg_loss: 103941.3906; train_edge_recon_loss: 115309.8095; train_gene_expr_recon_loss: 20807898.8148; train_masked_gp_l1_reg_loss: 15401.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70645.1059; train_global_loss: 21113196.9259; train_optim_loss: 21113196.9259; val_kl_reg_loss: 98358.7682; val_edge_recon_loss: 115888.1732; val_gene_expr_recon_loss: 20735625.6667; val_masked_gp_l1_reg_loss: 15449.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70531.6562; val_global_loss: 21035854.3333; val_optim_loss: 21035854.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8994; val_auprc_score: 0.9798; val_best_acc_score: 0.8961; val_best_f1_score: 0.9410; train_kl_reg_loss: 100187.7020; train_edge_recon_loss: 115917.7604; train_gene_expr_recon_loss: 20666911.1111; train_masked_gp_l1_reg_loss: 15495.2258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70419.9871; train_global_loss: 20968932.0000; train_optim_loss: 20968932.0000; val_kl_reg_loss: 94897.3008; val_edge_recon_loss: 112671.2279; val_gene_expr_recon_loss: 20603599.3333; val_masked_gp_l1_reg_loss: 15543.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70306.1328; val_global_loss: 20897017.6667; val_optim_loss: 20897017.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9114; val_auprc_score: 0.9811; val_best_acc_score: 0.8983; val_best_f1_score: 0.9417; train_kl_reg_loss: 96818.8090; train_edge_recon_loss: 115647.8200; train_gene_expr_recon_loss: 20525164.5556; train_masked_gp_l1_reg_loss: 15586.3448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70194.2329; train_global_loss: 20823411.7037; train_optim_loss: 20823411.7037; val_kl_reg_loss: 91433.6107; val_edge_recon_loss: 117176.5651; val_gene_expr_recon_loss: 20453800.0000; val_masked_gp_l1_reg_loss: 15633.0479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70074.9375; val_global_loss: 20748118.0000; val_optim_loss: 20748118.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9066; val_auprc_score: 0.9794; val_best_acc_score: 0.8966; val_best_f1_score: 0.9406; train_kl_reg_loss: 93636.3325; train_edge_recon_loss: 114649.4643; train_gene_expr_recon_loss: 20391352.7778; train_masked_gp_l1_reg_loss: 15677.7168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69956.5082; train_global_loss: 20685272.8889; train_optim_loss: 20685272.8889; val_kl_reg_loss: 88926.0039; val_edge_recon_loss: 116654.4219; val_gene_expr_recon_loss: 20369701.0000; val_masked_gp_l1_reg_loss: 15723.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69831.4844; val_global_loss: 20660837.3333; val_optim_loss: 20660837.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9093; val_auprc_score: 0.9804; val_best_acc_score: 0.9010; val_best_f1_score: 0.9429; train_kl_reg_loss: 90794.9644; train_edge_recon_loss: 116480.0153; train_gene_expr_recon_loss: 20260573.3333; train_masked_gp_l1_reg_loss: 15767.7007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69709.6168; train_global_loss: 20553325.6667; train_optim_loss: 20553325.6667; val_kl_reg_loss: 86383.2396; val_edge_recon_loss: 116264.5755; val_gene_expr_recon_loss: 20218327.0000; val_masked_gp_l1_reg_loss: 15809.8525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69582.4609; val_global_loss: 20506367.0000; val_optim_loss: 20506367.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9084; val_auprc_score: 0.9813; val_best_acc_score: 0.9011; val_best_f1_score: 0.9430; train_kl_reg_loss: 88125.3954; train_edge_recon_loss: 115386.5599; train_gene_expr_recon_loss: 20144365.0741; train_masked_gp_l1_reg_loss: 15850.9173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69455.4099; train_global_loss: 20433183.5926; train_optim_loss: 20433183.5926; val_kl_reg_loss: 83908.4987; val_edge_recon_loss: 112934.3906; val_gene_expr_recon_loss: 20111900.6667; val_masked_gp_l1_reg_loss: 15900.4150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69321.3750; val_global_loss: 20393965.6667; val_optim_loss: 20393965.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9151; val_auprc_score: 0.9832; val_best_acc_score: 0.9042; val_best_f1_score: 0.9446; train_kl_reg_loss: 85650.7305; train_edge_recon_loss: 113923.5687; train_gene_expr_recon_loss: 20026030.0370; train_masked_gp_l1_reg_loss: 15940.7761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69184.8817; train_global_loss: 20310729.9259; train_optim_loss: 20310729.9259; val_kl_reg_loss: 81471.8034; val_edge_recon_loss: 112868.3255; val_gene_expr_recon_loss: 19977308.0000; val_masked_gp_l1_reg_loss: 15984.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69040.5781; val_global_loss: 20256672.3333; val_optim_loss: 20256672.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9129; val_auprc_score: 0.9805; val_best_acc_score: 0.9003; val_best_f1_score: 0.9418; train_kl_reg_loss: 83415.8365; train_edge_recon_loss: 114557.3286; train_gene_expr_recon_loss: 19906483.1111; train_masked_gp_l1_reg_loss: 16026.0270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68905.2781; train_global_loss: 20189387.5556; train_optim_loss: 20189387.5556; val_kl_reg_loss: 79340.0859; val_edge_recon_loss: 119122.5352; val_gene_expr_recon_loss: 19863529.6667; val_masked_gp_l1_reg_loss: 16067.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68764.0547; val_global_loss: 20146824.0000; val_optim_loss: 20146824.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9149; val_auprc_score: 0.9821; val_best_acc_score: 0.9023; val_best_f1_score: 0.9429; train_kl_reg_loss: 81247.0632; train_edge_recon_loss: 115848.7273; train_gene_expr_recon_loss: 19798644.2593; train_masked_gp_l1_reg_loss: 16110.2512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68620.9239; train_global_loss: 20080471.1481; train_optim_loss: 20080471.1481; val_kl_reg_loss: 77700.5560; val_edge_recon_loss: 116909.4701; val_gene_expr_recon_loss: 19743291.0000; val_masked_gp_l1_reg_loss: 16156.1768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68469.9609; val_global_loss: 20022527.0000; val_optim_loss: 20022527.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9151; val_auprc_score: 0.9828; val_best_acc_score: 0.9013; val_best_f1_score: 0.9438; train_kl_reg_loss: 79272.6522; train_edge_recon_loss: 114847.9264; train_gene_expr_recon_loss: 19687353.6667; train_masked_gp_l1_reg_loss: 16195.4879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68326.2323; train_global_loss: 19965995.9259; train_optim_loss: 19965995.9259; val_kl_reg_loss: 75804.9831; val_edge_recon_loss: 114833.4753; val_gene_expr_recon_loss: 19631860.3333; val_masked_gp_l1_reg_loss: 16236.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68173.7969; val_global_loss: 19906908.3333; val_optim_loss: 19906908.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9137; val_auprc_score: 0.9808; val_best_acc_score: 0.9009; val_best_f1_score: 0.9427; train_kl_reg_loss: 77315.0262; train_edge_recon_loss: 114466.5962; train_gene_expr_recon_loss: 19585328.1852; train_masked_gp_l1_reg_loss: 16274.5660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68019.0637; train_global_loss: 19861403.3704; train_optim_loss: 19861403.3704; val_kl_reg_loss: 74005.0573; val_edge_recon_loss: 116115.2396; val_gene_expr_recon_loss: 19547939.3333; val_masked_gp_l1_reg_loss: 16317.1865; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67860.3047; val_global_loss: 19822237.6667; val_optim_loss: 19822237.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9138; val_auprc_score: 0.9813; val_best_acc_score: 0.9023; val_best_f1_score: 0.9442; train_kl_reg_loss: 75469.8066; train_edge_recon_loss: 113542.3108; train_gene_expr_recon_loss: 19483611.9630; train_masked_gp_l1_reg_loss: 16352.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67700.1068; train_global_loss: 19756676.1852; train_optim_loss: 19756676.1852; val_kl_reg_loss: 71995.1133; val_edge_recon_loss: 114341.5885; val_gene_expr_recon_loss: 19429882.0000; val_masked_gp_l1_reg_loss: 16399.0020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67536.0000; val_global_loss: 19700154.6667; val_optim_loss: 19700154.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9170; val_auprc_score: 0.9822; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 2148613821606.0793; train_edge_recon_loss: 111831.5865; train_gene_expr_recon_loss: 226907663.7778; train_masked_gp_l1_reg_loss: 16627.1228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67429.7982; train_global_loss: 2148840899799.0371; train_optim_loss: 2148840899799.0371; val_kl_reg_loss: 115837334.6667; val_edge_recon_loss: 117819.2760; val_gene_expr_recon_loss: 586144480.0000; val_masked_gp_l1_reg_loss: 18379.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68112.4375; val_global_loss: 702186101.3333; val_optim_loss: 702186101.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9251; val_auprc_score: 0.9845; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 33687807724620700.0000; train_edge_recon_loss: 115866.4253; train_gene_expr_recon_loss: 684535908.7407; train_masked_gp_l1_reg_loss: 19707.4822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70000.6486; train_global_loss: 33687808395840004.0000; train_optim_loss: 33687808395840004.0000; val_kl_reg_loss: 8617878.5000; val_edge_recon_loss: 118025.0091; val_gene_expr_recon_loss: 581954346.6667; val_masked_gp_l1_reg_loss: 19929.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70319.6719; val_global_loss: 590780469.3333; val_optim_loss: 590780469.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9199; val_auprc_score: 0.9828; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 456194936567476.3750; train_edge_recon_loss: 118589.9861; train_gene_expr_recon_loss: 574331854.2222; train_masked_gp_l1_reg_loss: 19831.3715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70140.2203; train_global_loss: 456195500569826.3750; train_optim_loss: 456195500569826.3750; val_kl_reg_loss: 2048342.5208; val_edge_recon_loss: 120588.2513; val_gene_expr_recon_loss: 564312576.0000; val_masked_gp_l1_reg_loss: 19652.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69964.1875; val_global_loss: 566571104.0000; val_optim_loss: 566571104.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9198; val_auprc_score: 0.9819; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 376387076080854.9375; train_edge_recon_loss: 118774.2921; train_gene_expr_recon_loss: 575107662.2222; train_masked_gp_l1_reg_loss: 19467.9877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69778.2645; train_global_loss: 376387640798552.8750; train_optim_loss: 376387640798552.8750; val_kl_reg_loss: 5822066.1667; val_edge_recon_loss: 118560.6445; val_gene_expr_recon_loss: 559934602.6667; val_masked_gp_l1_reg_loss: 19353.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69585.8984; val_global_loss: 565964138.6667; val_optim_loss: 565964138.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9213; val_auprc_score: 0.9838; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 5844072.5556; train_edge_recon_loss: 118790.9295; train_gene_expr_recon_loss: 559496763.2593; train_masked_gp_l1_reg_loss: 19336.0350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69534.1037; train_global_loss: 565548485.9259; train_optim_loss: 565548485.9259; val_kl_reg_loss: 5300849.4167; val_edge_recon_loss: 117143.0977; val_gene_expr_recon_loss: 558923808.0000; val_masked_gp_l1_reg_loss: 19317.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69507.8984; val_global_loss: 564430624.0000; val_optim_loss: 564430624.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9191; val_auprc_score: 0.9822; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 5163776.1759; train_edge_recon_loss: 120425.6667; train_gene_expr_recon_loss: 559156803.5556; train_masked_gp_l1_reg_loss: 19298.2975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69489.8225; train_global_loss: 564529806.2222; train_optim_loss: 564529806.2222; val_kl_reg_loss: 4675175.0000; val_edge_recon_loss: 120459.2969; val_gene_expr_recon_loss: 558587925.3333; val_masked_gp_l1_reg_loss: 19278.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69470.3281; val_global_loss: 563472266.6667; val_optim_loss: 563472266.6667
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9155; val_auprc_score: 0.9813; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 4569177.9444; train_edge_recon_loss: 119086.2854; train_gene_expr_recon_loss: 558629828.7407; train_masked_gp_l1_reg_loss: 19259.5815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69449.8589; train_global_loss: 563406794.6667; train_optim_loss: 563406794.6667; val_kl_reg_loss: 4151251.0000; val_edge_recon_loss: 119719.4010; val_gene_expr_recon_loss: 557783797.3333; val_masked_gp_l1_reg_loss: 19239.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69428.0547; val_global_loss: 562143466.6667; val_optim_loss: 562143466.6667
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9147; val_auprc_score: 0.9812; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 4073893.9444; train_edge_recon_loss: 118765.3040; train_gene_expr_recon_loss: 558048333.0370; train_masked_gp_l1_reg_loss: 19220.0255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69407.2305; train_global_loss: 562329611.8519; train_optim_loss: 562329611.8519; val_kl_reg_loss: 3715783.3750; val_edge_recon_loss: 120936.1055; val_gene_expr_recon_loss: 557100650.6667; val_masked_gp_l1_reg_loss: 19199.5527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69384.9844; val_global_loss: 561025952.0000; val_optim_loss: 561025952.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 11 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9170
val AUPRC score: 0.9831
val best accuracy score: 0.9026
val best F1 score: 0.9440
val target rna MSE score: 4.3673
val source rna MSE score: 4.1938
Val cat covariate0 mean sim diff: -0.0016

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
