[True]
Run timestamp: 08082023_043444_66.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_66']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9207; val_auprc_score: 0.9838; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 181176.4446; train_edge_recon_loss: 1130416.2470; train_gene_expr_recon_loss: 3863863.4111; train_masked_gp_l1_reg_loss: 10911.7241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176952.9126; train_global_loss: 5363320.7500; train_optim_loss: 5363320.7500; val_kl_reg_loss: 184479.1133; val_edge_recon_loss: 1209499.8958; val_gene_expr_recon_loss: 2725286.8542; val_masked_gp_l1_reg_loss: 11227.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169639.0938; val_global_loss: 4300132.5000; val_optim_loss: 4300132.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9217; val_auprc_score: 0.9842; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 174283.5700; train_edge_recon_loss: 1137635.3113; train_gene_expr_recon_loss: 2958005.7716; train_masked_gp_l1_reg_loss: 10993.2234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159648.4683; train_global_loss: 4440566.3149; train_optim_loss: 4440566.3149; val_kl_reg_loss: 131265.2350; val_edge_recon_loss: 1196179.6146; val_gene_expr_recon_loss: 2682128.9167; val_masked_gp_l1_reg_loss: 10721.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149221.0781; val_global_loss: 4169515.9792; val_optim_loss: 4169515.9792
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9134; val_auprc_score: 0.9828; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 114361.9403; train_edge_recon_loss: 1101290.0276; train_gene_expr_recon_loss: 2624994.0865; train_masked_gp_l1_reg_loss: 10576.2247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139086.3088; train_global_loss: 3990308.5913; train_optim_loss: 3990308.5913; val_kl_reg_loss: 94107.8906; val_edge_recon_loss: 1204406.8542; val_gene_expr_recon_loss: 2539344.1667; val_masked_gp_l1_reg_loss: 10499.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129000.2500; val_global_loss: 3977358.6667; val_optim_loss: 3977358.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8997; val_auprc_score: 0.9804; val_best_acc_score: 0.8614; val_best_f1_score: 0.9249; train_kl_reg_loss: 87984.8924; train_edge_recon_loss: 1081000.0397; train_gene_expr_recon_loss: 2506529.4207; train_masked_gp_l1_reg_loss: 10456.3748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119841.2906; train_global_loss: 3805812.0288; train_optim_loss: 3805812.0288; val_kl_reg_loss: 78639.9694; val_edge_recon_loss: 1192253.5833; val_gene_expr_recon_loss: 2392292.6458; val_masked_gp_l1_reg_loss: 10405.5967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110974.3281; val_global_loss: 3784565.9792; val_optim_loss: 3784565.9792
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8737; val_auprc_score: 0.9735; val_best_acc_score: 0.8806; val_best_f1_score: 0.9338; train_kl_reg_loss: 78807.0669; train_edge_recon_loss: 1080052.5331; train_gene_expr_recon_loss: 2284139.9303; train_masked_gp_l1_reg_loss: 10447.5981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103349.5522; train_global_loss: 3556796.6659; train_optim_loss: 3556796.6659; val_kl_reg_loss: 72797.3418; val_edge_recon_loss: 1187512.1875; val_gene_expr_recon_loss: 2246451.0625; val_masked_gp_l1_reg_loss: 10367.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96007.2188; val_global_loss: 3613135.5625; val_optim_loss: 3613135.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8688; val_auprc_score: 0.9697; val_best_acc_score: 0.8977; val_best_f1_score: 0.9422; train_kl_reg_loss: 70382.3084; train_edge_recon_loss: 1063412.7782; train_gene_expr_recon_loss: 2228847.9832; train_masked_gp_l1_reg_loss: 10325.1991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89817.8676; train_global_loss: 3462786.1394; train_optim_loss: 3462786.1394; val_kl_reg_loss: 61223.1777; val_edge_recon_loss: 1159552.3958; val_gene_expr_recon_loss: 2203482.5000; val_masked_gp_l1_reg_loss: 10314.1660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83957.0703; val_global_loss: 3518529.3333; val_optim_loss: 3518529.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8749; val_auprc_score: 0.9703; val_best_acc_score: 0.9037; val_best_f1_score: 0.9455; train_kl_reg_loss: 62163.2082; train_edge_recon_loss: 1033892.1436; train_gene_expr_recon_loss: 2190104.8990; train_masked_gp_l1_reg_loss: 10385.0318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78941.2441; train_global_loss: 3375486.5409; train_optim_loss: 3375486.5409; val_kl_reg_loss: 60841.5023; val_edge_recon_loss: 1050819.0312; val_gene_expr_recon_loss: 2170621.1875; val_masked_gp_l1_reg_loss: 10496.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74131.5781; val_global_loss: 3366909.9375; val_optim_loss: 3366909.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8690; val_auprc_score: 0.9674; val_best_acc_score: 0.9036; val_best_f1_score: 0.9453; train_kl_reg_loss: 67343.3152; train_edge_recon_loss: 982374.7602; train_gene_expr_recon_loss: 2156515.5072; train_masked_gp_l1_reg_loss: 10644.2511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69995.2664; train_global_loss: 3286873.0889; train_optim_loss: 3286873.0889; val_kl_reg_loss: 68991.5169; val_edge_recon_loss: 995217.4948; val_gene_expr_recon_loss: 2139395.8958; val_masked_gp_l1_reg_loss: 10791.0293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66024.7422; val_global_loss: 3280420.6667; val_optim_loss: 3280420.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8697; val_auprc_score: 0.9693; val_best_acc_score: 0.9075; val_best_f1_score: 0.9477; train_kl_reg_loss: 69477.0068; train_edge_recon_loss: 950605.0673; train_gene_expr_recon_loss: 2125408.4327; train_masked_gp_l1_reg_loss: 10920.7786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62624.2168; train_global_loss: 3219035.5072; train_optim_loss: 3219035.5072; val_kl_reg_loss: 66737.5306; val_edge_recon_loss: 940477.5052; val_gene_expr_recon_loss: 2110304.3438; val_masked_gp_l1_reg_loss: 11046.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59388.3398; val_global_loss: 3187954.6042; val_optim_loss: 3187954.6042
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8715; val_auprc_score: 0.9699; val_best_acc_score: 0.9077; val_best_f1_score: 0.9479; train_kl_reg_loss: 66205.4390; train_edge_recon_loss: 932953.1797; train_gene_expr_recon_loss: 2096493.5433; train_masked_gp_l1_reg_loss: 11163.1949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56603.9405; train_global_loss: 3163419.2981; train_optim_loss: 3163419.2981; val_kl_reg_loss: 63181.3483; val_edge_recon_loss: 932167.8333; val_gene_expr_recon_loss: 2080776.0625; val_masked_gp_l1_reg_loss: 11283.9463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53943.5234; val_global_loss: 3141352.7500; val_optim_loss: 3141352.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8764; val_auprc_score: 0.9718; val_best_acc_score: 0.9104; val_best_f1_score: 0.9497; train_kl_reg_loss: 62771.7723; train_edge_recon_loss: 911794.3329; train_gene_expr_recon_loss: 2070167.9327; train_masked_gp_l1_reg_loss: 11400.2595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51637.6230; train_global_loss: 3107771.9159; train_optim_loss: 3107771.9159; val_kl_reg_loss: 60041.9183; val_edge_recon_loss: 912208.1719; val_gene_expr_recon_loss: 2052683.9062; val_masked_gp_l1_reg_loss: 11519.6338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49416.4219; val_global_loss: 3085870.2917; val_optim_loss: 3085870.2917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8735; val_auprc_score: 0.9711; val_best_acc_score: 0.9113; val_best_f1_score: 0.9502; train_kl_reg_loss: 59120.4618; train_edge_recon_loss: 908362.0036; train_gene_expr_recon_loss: 2043638.4832; train_masked_gp_l1_reg_loss: 11636.4459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47443.3908; train_global_loss: 3070200.8125; train_optim_loss: 3070200.8125; val_kl_reg_loss: 56995.1191; val_edge_recon_loss: 904491.8854; val_gene_expr_recon_loss: 2027396.7812; val_masked_gp_l1_reg_loss: 11757.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45520.0742; val_global_loss: 3046161.7917; val_optim_loss: 3046161.7917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8793; val_auprc_score: 0.9723; val_best_acc_score: 0.9131; val_best_f1_score: 0.9513; train_kl_reg_loss: 56012.3697; train_edge_recon_loss: 903170.0096; train_gene_expr_recon_loss: 2018143.5012; train_masked_gp_l1_reg_loss: 11877.1755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43820.8073; train_global_loss: 3033023.8413; train_optim_loss: 3033023.8413; val_kl_reg_loss: 53206.1826; val_edge_recon_loss: 894724.8906; val_gene_expr_recon_loss: 2002996.8542; val_masked_gp_l1_reg_loss: 12006.7207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42230.6953; val_global_loss: 3005165.4792; val_optim_loss: 3005165.4792
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8861; val_auprc_score: 0.9745; val_best_acc_score: 0.9167; val_best_f1_score: 0.9531; train_kl_reg_loss: 52125.2853; train_edge_recon_loss: 893427.0775; train_gene_expr_recon_loss: 1992010.1575; train_masked_gp_l1_reg_loss: 12136.8961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40819.1774; train_global_loss: 2990518.5938; train_optim_loss: 2990518.5938; val_kl_reg_loss: 49832.5264; val_edge_recon_loss: 874639.1094; val_gene_expr_recon_loss: 1976411.7188; val_masked_gp_l1_reg_loss: 12269.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39472.0117; val_global_loss: 2952625.3958; val_optim_loss: 2952625.3958
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8932; val_auprc_score: 0.9757; val_best_acc_score: 0.9182; val_best_f1_score: 0.9537; train_kl_reg_loss: 49820.7041; train_edge_recon_loss: 877873.8047; train_gene_expr_recon_loss: 1967420.3798; train_masked_gp_l1_reg_loss: 12398.3326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38236.4879; train_global_loss: 2945749.7139; train_optim_loss: 2945749.7139; val_kl_reg_loss: 48534.0394; val_edge_recon_loss: 882039.6094; val_gene_expr_recon_loss: 1953165.8438; val_masked_gp_l1_reg_loss: 12529.7119; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37039.2031; val_global_loss: 2933308.4792; val_optim_loss: 2933308.4792
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9100; val_auprc_score: 0.9800; val_best_acc_score: 0.9238; val_best_f1_score: 0.9569; train_kl_reg_loss: 47645.8691; train_edge_recon_loss: 873438.0006; train_gene_expr_recon_loss: 1944502.2885; train_masked_gp_l1_reg_loss: 12658.8255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35900.4325; train_global_loss: 2914145.4447; train_optim_loss: 2914145.4447; val_kl_reg_loss: 45413.4225; val_edge_recon_loss: 845066.3177; val_gene_expr_recon_loss: 1931997.4375; val_masked_gp_l1_reg_loss: 12791.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34786.9102; val_global_loss: 2870056.2083; val_optim_loss: 2870056.2083
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9215; val_auprc_score: 0.9826; val_best_acc_score: 0.9279; val_best_f1_score: 0.9589; train_kl_reg_loss: 45353.6756; train_edge_recon_loss: 858667.4868; train_gene_expr_recon_loss: 1924156.5685; train_masked_gp_l1_reg_loss: 12920.4467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33740.0074; train_global_loss: 2874838.1875; train_optim_loss: 2874838.1875; val_kl_reg_loss: 43517.8919; val_edge_recon_loss: 856216.3177; val_gene_expr_recon_loss: 1912214.2500; val_masked_gp_l1_reg_loss: 13051.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32741.5703; val_global_loss: 2857741.1875; val_optim_loss: 2857741.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9309; val_auprc_score: 0.9847; val_best_acc_score: 0.9350; val_best_f1_score: 0.9628; train_kl_reg_loss: 43752.7151; train_edge_recon_loss: 844331.1761; train_gene_expr_recon_loss: 1904169.7500; train_masked_gp_l1_reg_loss: 13163.6061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31850.0144; train_global_loss: 2837267.2692; train_optim_loss: 2837267.2692; val_kl_reg_loss: 42674.8542; val_edge_recon_loss: 829641.7292; val_gene_expr_recon_loss: 1891352.0104; val_masked_gp_l1_reg_loss: 13266.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30990.6738; val_global_loss: 2807925.8333; val_optim_loss: 2807925.8333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9364; val_auprc_score: 0.9861; val_best_acc_score: 0.9349; val_best_f1_score: 0.9628; train_kl_reg_loss: 41677.2067; train_edge_recon_loss: 837145.9838; train_gene_expr_recon_loss: 1885763.1875; train_masked_gp_l1_reg_loss: 13350.6815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30239.7034; train_global_loss: 2808176.7500; train_optim_loss: 2808176.7500; val_kl_reg_loss: 40219.1797; val_edge_recon_loss: 830235.4323; val_gene_expr_recon_loss: 1873333.1250; val_masked_gp_l1_reg_loss: 13429.3457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29514.6094; val_global_loss: 2786731.4792; val_optim_loss: 2786731.4792
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9444; val_auprc_score: 0.9874; val_best_acc_score: 0.9363; val_best_f1_score: 0.9633; train_kl_reg_loss: 38409.3637; train_edge_recon_loss: 826046.6004; train_gene_expr_recon_loss: 1868188.1743; train_masked_gp_l1_reg_loss: 13491.0856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28906.1589; train_global_loss: 2775041.3894; train_optim_loss: 2775041.3894; val_kl_reg_loss: 36532.7035; val_edge_recon_loss: 836928.4635; val_gene_expr_recon_loss: 1858154.9271; val_masked_gp_l1_reg_loss: 13545.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28336.9746; val_global_loss: 2773498.8958; val_optim_loss: 2773498.8958
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9480; val_auprc_score: 0.9887; val_best_acc_score: 0.9381; val_best_f1_score: 0.9645; train_kl_reg_loss: 35503.0350; train_edge_recon_loss: 818524.3305; train_gene_expr_recon_loss: 1850525.9519; train_masked_gp_l1_reg_loss: 13575.0035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27802.8237; train_global_loss: 2745931.1562; train_optim_loss: 2745931.1562; val_kl_reg_loss: 33035.4982; val_edge_recon_loss: 814529.3646; val_gene_expr_recon_loss: 1842194.4271; val_masked_gp_l1_reg_loss: 13590.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27301.0898; val_global_loss: 2730651.0000; val_optim_loss: 2730651.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9468; val_auprc_score: 0.9883; val_best_acc_score: 0.9390; val_best_f1_score: 0.9649; train_kl_reg_loss: 32597.0492; train_edge_recon_loss: 816252.8305; train_gene_expr_recon_loss: 1834513.4255; train_masked_gp_l1_reg_loss: 13584.0733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26847.3715; train_global_loss: 2723794.7332; train_optim_loss: 2723794.7332; val_kl_reg_loss: 30651.4222; val_edge_recon_loss: 817153.0885; val_gene_expr_recon_loss: 1825230.2396; val_masked_gp_l1_reg_loss: 13563.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26415.3145; val_global_loss: 2713013.2708; val_optim_loss: 2713013.2708
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9499; val_auprc_score: 0.9891; val_best_acc_score: 0.9408; val_best_f1_score: 0.9660; train_kl_reg_loss: 29838.1727; train_edge_recon_loss: 814800.0992; train_gene_expr_recon_loss: 1819008.2404; train_masked_gp_l1_reg_loss: 13516.5391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26004.2781; train_global_loss: 2703167.3125; train_optim_loss: 2703167.3125; val_kl_reg_loss: 28790.3823; val_edge_recon_loss: 810470.2917; val_gene_expr_recon_loss: 1809367.3646; val_masked_gp_l1_reg_loss: 13456.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25622.0273; val_global_loss: 2687706.3125; val_optim_loss: 2687706.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9525; val_auprc_score: 0.9893; val_best_acc_score: 0.9417; val_best_f1_score: 0.9663; train_kl_reg_loss: 27395.9931; train_edge_recon_loss: 812137.2188; train_gene_expr_recon_loss: 1804273.7548; train_masked_gp_l1_reg_loss: 13370.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25222.9537; train_global_loss: 2682400.0553; train_optim_loss: 2682400.0553; val_kl_reg_loss: 26173.4774; val_edge_recon_loss: 809467.4740; val_gene_expr_recon_loss: 1794744.2812; val_masked_gp_l1_reg_loss: 13268.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24824.8066; val_global_loss: 2668478.7500; val_optim_loss: 2668478.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9506; val_auprc_score: 0.9888; val_best_acc_score: 0.9405; val_best_f1_score: 0.9655; train_kl_reg_loss: 25412.9602; train_edge_recon_loss: 803264.6791; train_gene_expr_recon_loss: 1789451.7620; train_masked_gp_l1_reg_loss: 13139.2664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24412.3474; train_global_loss: 2655680.9928; train_optim_loss: 2655680.9928; val_kl_reg_loss: 24268.9548; val_edge_recon_loss: 814007.0938; val_gene_expr_recon_loss: 1782028.0521; val_masked_gp_l1_reg_loss: 12992.4893; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23989.3262; val_global_loss: 2657285.8542; val_optim_loss: 2657285.8542
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9553; val_auprc_score: 0.9899; val_best_acc_score: 0.9432; val_best_f1_score: 0.9671; train_kl_reg_loss: 21301.3726; train_edge_recon_loss: 815332.4093; train_gene_expr_recon_loss: 2525311.7464; train_masked_gp_l1_reg_loss: 13416.5075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20652.5873; train_global_loss: 3396014.6394; train_optim_loss: 3396014.6394; val_kl_reg_loss: 11184.4388; val_edge_recon_loss: 815815.7552; val_gene_expr_recon_loss: 2047449.7500; val_masked_gp_l1_reg_loss: 13298.5410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17504.1562; val_global_loss: 2905252.7500; val_optim_loss: 2905252.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9591; val_auprc_score: 0.9911; val_best_acc_score: 0.9472; val_best_f1_score: 0.9695; train_kl_reg_loss: 18228.7573; train_edge_recon_loss: 800892.6016; train_gene_expr_recon_loss: 1969116.6839; train_masked_gp_l1_reg_loss: 12927.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15327.3833; train_global_loss: 2816492.6298; train_optim_loss: 2816492.6298; val_kl_reg_loss: 9427.4806; val_edge_recon_loss: 789019.6250; val_gene_expr_recon_loss: 1920084.9583; val_masked_gp_l1_reg_loss: 12551.8701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13433.9121; val_global_loss: 2744517.8125; val_optim_loss: 2744517.8125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9617; val_auprc_score: 0.9913; val_best_acc_score: 0.9492; val_best_f1_score: 0.9706; train_kl_reg_loss: 13760.8368; train_edge_recon_loss: 787369.5865; train_gene_expr_recon_loss: 1898812.2812; train_masked_gp_l1_reg_loss: 12196.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12050.1446; train_global_loss: 2724189.0409; train_optim_loss: 2724189.0409; val_kl_reg_loss: 7483.2212; val_edge_recon_loss: 791597.0312; val_gene_expr_recon_loss: 1880152.2917; val_masked_gp_l1_reg_loss: 11848.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10815.6455; val_global_loss: 2701896.8125; val_optim_loss: 2701896.8125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9643; val_auprc_score: 0.9915; val_best_acc_score: 0.9528; val_best_f1_score: 0.9728; train_kl_reg_loss: 10973.8996; train_edge_recon_loss: 786768.3606; train_gene_expr_recon_loss: 1870485.6382; train_masked_gp_l1_reg_loss: 11533.8872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9865.1962; train_global_loss: 2689626.9976; train_optim_loss: 2689626.9976; val_kl_reg_loss: 6314.3896; val_edge_recon_loss: 788164.1823; val_gene_expr_recon_loss: 1860901.1250; val_masked_gp_l1_reg_loss: 11219.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8998.2070; val_global_loss: 2675597.9792; val_optim_loss: 2675597.9792

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9660; val_auprc_score: 0.9922; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 9744.9751; train_edge_recon_loss: 783636.6340; train_gene_expr_recon_loss: 1860096.0084; train_masked_gp_l1_reg_loss: 11173.4069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8802.3058; train_global_loss: 2673453.3558; train_optim_loss: 2673453.3558; val_kl_reg_loss: 6223.8460; val_edge_recon_loss: 784036.8854; val_gene_expr_recon_loss: 1858771.5000; val_masked_gp_l1_reg_loss: 11141.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8711.7598; val_global_loss: 2668885.7083; val_optim_loss: 2668885.7083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9649; val_auprc_score: 0.9919; val_best_acc_score: 0.9553; val_best_f1_score: 0.9742; train_kl_reg_loss: 9509.3883; train_edge_recon_loss: 781104.8558; train_gene_expr_recon_loss: 1858429.1274; train_masked_gp_l1_reg_loss: 11111.4078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8634.6390; train_global_loss: 2668789.4303; train_optim_loss: 2668789.4303; val_kl_reg_loss: 6121.0972; val_edge_recon_loss: 776386.1927; val_gene_expr_recon_loss: 1858778.7708; val_masked_gp_l1_reg_loss: 11080.1455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8555.1523; val_global_loss: 2660921.5833; val_optim_loss: 2660921.5833
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9678; val_auprc_score: 0.9927; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 9302.2440; train_edge_recon_loss: 780284.7590; train_gene_expr_recon_loss: 1857097.2524; train_masked_gp_l1_reg_loss: 11048.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8477.2913; train_global_loss: 2666209.7957; train_optim_loss: 2666209.7957; val_kl_reg_loss: 6017.8147; val_edge_recon_loss: 777018.2292; val_gene_expr_recon_loss: 1855200.9479; val_masked_gp_l1_reg_loss: 11015.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8397.4395; val_global_loss: 2657650.2500; val_optim_loss: 2657650.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9695; val_auprc_score: 0.9934; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 9065.1365; train_edge_recon_loss: 778571.5571; train_gene_expr_recon_loss: 1855585.4904; train_masked_gp_l1_reg_loss: 10983.2528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8317.9178; train_global_loss: 2662523.3534; train_optim_loss: 2662523.3534; val_kl_reg_loss: 5929.7296; val_edge_recon_loss: 774365.5104; val_gene_expr_recon_loss: 1855075.9896; val_masked_gp_l1_reg_loss: 10949.9629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8236.6689; val_global_loss: 2654557.9375; val_optim_loss: 2654557.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9681; val_auprc_score: 0.9927; val_best_acc_score: 0.9562; val_best_f1_score: 0.9747; train_kl_reg_loss: 8830.9721; train_edge_recon_loss: 782160.5919; train_gene_expr_recon_loss: 1853315.3281; train_masked_gp_l1_reg_loss: 10916.4404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8156.3579; train_global_loss: 2663379.6923; train_optim_loss: 2663379.6923; val_kl_reg_loss: 5767.0002; val_edge_recon_loss: 774608.6042; val_gene_expr_recon_loss: 1854244.4375; val_masked_gp_l1_reg_loss: 10882.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8073.7158; val_global_loss: 2653576.0417; val_optim_loss: 2653576.0417
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9663; val_auprc_score: 0.9922; val_best_acc_score: 0.9538; val_best_f1_score: 0.9732; train_kl_reg_loss: 8691.6950; train_edge_recon_loss: 778725.0986; train_gene_expr_recon_loss: 1852349.3930; train_masked_gp_l1_reg_loss: 10847.9502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7992.8218; train_global_loss: 2658606.9591; train_optim_loss: 2658606.9591; val_kl_reg_loss: 5716.7899; val_edge_recon_loss: 798164.1667; val_gene_expr_recon_loss: 1852910.7292; val_masked_gp_l1_reg_loss: 10812.9316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7909.9878; val_global_loss: 2675514.6875; val_optim_loss: 2675514.6875
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9664; val_auprc_score: 0.9922; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 8559.6078; train_edge_recon_loss: 783738.6394; train_gene_expr_recon_loss: 1850516.5529; train_masked_gp_l1_reg_loss: 10777.6414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7827.8568; train_global_loss: 2661420.2909; train_optim_loss: 2661420.2909; val_kl_reg_loss: 5667.6771; val_edge_recon_loss: 787111.4792; val_gene_expr_recon_loss: 1848993.6146; val_masked_gp_l1_reg_loss: 10740.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7743.8027; val_global_loss: 2660257.0208; val_optim_loss: 2660257.0208
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9682; val_auprc_score: 0.9929; val_best_acc_score: 0.9566; val_best_f1_score: 0.9749; train_kl_reg_loss: 8336.7841; train_edge_recon_loss: 781523.0270; train_gene_expr_recon_loss: 1848290.9135; train_masked_gp_l1_reg_loss: 10704.7254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7661.7541; train_global_loss: 2656517.1947; train_optim_loss: 2656517.1947; val_kl_reg_loss: 5513.6313; val_edge_recon_loss: 778796.1719; val_gene_expr_recon_loss: 1846326.9271; val_masked_gp_l1_reg_loss: 10668.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7577.7002; val_global_loss: 2648882.7500; val_optim_loss: 2648882.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9695; val_auprc_score: 0.9930; val_best_acc_score: 0.9573; val_best_f1_score: 0.9752; train_kl_reg_loss: 8064.4720; train_edge_recon_loss: 777519.1562; train_gene_expr_recon_loss: 1846670.9615; train_masked_gp_l1_reg_loss: 10630.7535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7494.3301; train_global_loss: 2650379.6803; train_optim_loss: 2650379.6803; val_kl_reg_loss: 5373.0680; val_edge_recon_loss: 780165.5260; val_gene_expr_recon_loss: 1844591.0625; val_masked_gp_l1_reg_loss: 10592.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7409.2051; val_global_loss: 2648131.6667; val_optim_loss: 2648131.6667
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9688; val_auprc_score: 0.9930; val_best_acc_score: 0.9568; val_best_f1_score: 0.9750; train_kl_reg_loss: 7918.9881; train_edge_recon_loss: 775196.2302; train_gene_expr_recon_loss: 1844942.8486; train_masked_gp_l1_reg_loss: 10554.8269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7325.7062; train_global_loss: 2645938.6226; train_optim_loss: 2645938.6226; val_kl_reg_loss: 5274.9789; val_edge_recon_loss: 774854.1979; val_gene_expr_recon_loss: 1842659.7292; val_masked_gp_l1_reg_loss: 10516.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7239.9590; val_global_loss: 2640545.1458; val_optim_loss: 2640545.1458
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9678; val_auprc_score: 0.9929; val_best_acc_score: 0.9572; val_best_f1_score: 0.9753; train_kl_reg_loss: 7679.5558; train_edge_recon_loss: 775340.0673; train_gene_expr_recon_loss: 1844066.5661; train_masked_gp_l1_reg_loss: 10477.4318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7156.0511; train_global_loss: 2644719.6755; train_optim_loss: 2644719.6755; val_kl_reg_loss: 5233.3181; val_edge_recon_loss: 773313.5156; val_gene_expr_recon_loss: 1842290.4479; val_masked_gp_l1_reg_loss: 10438.7979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7070.0869; val_global_loss: 2638346.0625; val_optim_loss: 2638346.0625
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9693; val_auprc_score: 0.9931; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 7560.5081; train_edge_recon_loss: 776836.2758; train_gene_expr_recon_loss: 1841700.0228; train_masked_gp_l1_reg_loss: 10399.9669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6985.4485; train_global_loss: 2643482.2043; train_optim_loss: 2643482.2043; val_kl_reg_loss: 5099.2664; val_edge_recon_loss: 774991.7031; val_gene_expr_recon_loss: 1840181.8125; val_masked_gp_l1_reg_loss: 10359.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6898.9199; val_global_loss: 2637531.5417; val_optim_loss: 2637531.5417
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9712; val_auprc_score: 0.9938; val_best_acc_score: 0.9570; val_best_f1_score: 0.9751; train_kl_reg_loss: 7463.5118; train_edge_recon_loss: 776510.0379; train_gene_expr_recon_loss: 1840162.3281; train_masked_gp_l1_reg_loss: 10318.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6814.2598; train_global_loss: 2641268.8966; train_optim_loss: 2641268.8966; val_kl_reg_loss: 4997.0854; val_edge_recon_loss: 779496.6823; val_gene_expr_recon_loss: 1839402.8229; val_masked_gp_l1_reg_loss: 10276.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6728.0820; val_global_loss: 2640901.3333; val_optim_loss: 2640901.3333
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9716; val_auprc_score: 0.9937; val_best_acc_score: 0.9578; val_best_f1_score: 0.9755; train_kl_reg_loss: 7158.6093; train_edge_recon_loss: 775354.8209; train_gene_expr_recon_loss: 1838450.9159; train_masked_gp_l1_reg_loss: 10235.7151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6643.2087; train_global_loss: 2637843.2596; train_optim_loss: 2637843.2596; val_kl_reg_loss: 4883.9769; val_edge_recon_loss: 781286.2656; val_gene_expr_recon_loss: 1837249.7917; val_masked_gp_l1_reg_loss: 10194.4902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6556.6406; val_global_loss: 2640171.2708; val_optim_loss: 2640171.2708
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9699; val_auprc_score: 0.9930; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 6940.2525; train_edge_recon_loss: 775132.6274; train_gene_expr_recon_loss: 1837223.2079; train_masked_gp_l1_reg_loss: 10152.9820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6471.8893; train_global_loss: 2635920.9663; train_optim_loss: 2635920.9663; val_kl_reg_loss: 4736.4164; val_edge_recon_loss: 787817.5156; val_gene_expr_recon_loss: 1835614.4896; val_masked_gp_l1_reg_loss: 10109.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6385.1602; val_global_loss: 2644663.4375; val_optim_loss: 2644663.4375
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9705; val_auprc_score: 0.9934; val_best_acc_score: 0.9578; val_best_f1_score: 0.9756; train_kl_reg_loss: 6813.9585; train_edge_recon_loss: 776118.1641; train_gene_expr_recon_loss: 1835858.6106; train_masked_gp_l1_reg_loss: 10067.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6300.5146; train_global_loss: 2635159.0192; train_optim_loss: 2635159.0192; val_kl_reg_loss: 4741.9965; val_edge_recon_loss: 782745.6979; val_gene_expr_recon_loss: 1835149.0729; val_masked_gp_l1_reg_loss: 10023.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6214.0176; val_global_loss: 2638874.2292; val_optim_loss: 2638874.2292

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9707; val_auprc_score: 0.9934; val_best_acc_score: 0.9584; val_best_f1_score: 0.9759; train_kl_reg_loss: 6771.1829; train_edge_recon_loss: 772779.7079; train_gene_expr_recon_loss: 1834261.5481; train_masked_gp_l1_reg_loss: 10016.1174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6188.1230; train_global_loss: 2630016.6779; train_optim_loss: 2630016.6779; val_kl_reg_loss: 4719.6907; val_edge_recon_loss: 769903.3542; val_gene_expr_recon_loss: 1835446.5938; val_masked_gp_l1_reg_loss: 10011.1650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6177.4712; val_global_loss: 2626258.3958; val_optim_loss: 2626258.3958
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9710; val_auprc_score: 0.9937; val_best_acc_score: 0.9576; val_best_f1_score: 0.9755; train_kl_reg_loss: 6718.2248; train_edge_recon_loss: 769395.4273; train_gene_expr_recon_loss: 1833966.8233; train_masked_gp_l1_reg_loss: 10006.4808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6168.5199; train_global_loss: 2626255.4736; train_optim_loss: 2626255.4736; val_kl_reg_loss: 4703.0363; val_edge_recon_loss: 780342.9948; val_gene_expr_recon_loss: 1832138.9896; val_masked_gp_l1_reg_loss: 10001.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6159.2178; val_global_loss: 2633346.0208; val_optim_loss: 2633346.0208
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9702; val_auprc_score: 0.9928; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 6709.0592; train_edge_recon_loss: 775610.5571; train_gene_expr_recon_loss: 1834547.2728; train_masked_gp_l1_reg_loss: 9996.9626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6149.9133; train_global_loss: 2633013.7788; train_optim_loss: 2633013.7788; val_kl_reg_loss: 4688.4580; val_edge_recon_loss: 776188.2344; val_gene_expr_recon_loss: 1832604.1562; val_masked_gp_l1_reg_loss: 9992.1475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6140.2827; val_global_loss: 2629613.3750; val_optim_loss: 2629613.3750
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9704; val_auprc_score: 0.9935; val_best_acc_score: 0.9571; val_best_f1_score: 0.9751; train_kl_reg_loss: 6684.0254; train_edge_recon_loss: 776725.4850; train_gene_expr_recon_loss: 1833940.1226; train_masked_gp_l1_reg_loss: 9987.1957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6130.5249; train_global_loss: 2633467.3582; train_optim_loss: 2633467.3582; val_kl_reg_loss: 4670.1453; val_edge_recon_loss: 777035.2448; val_gene_expr_recon_loss: 1833876.3333; val_masked_gp_l1_reg_loss: 9982.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6120.4502; val_global_loss: 2631684.3333; val_optim_loss: 2631684.3333
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9701; val_auprc_score: 0.9931; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 6668.9513; train_edge_recon_loss: 773173.7506; train_gene_expr_recon_loss: 1834046.1394; train_masked_gp_l1_reg_loss: 9976.9783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6110.3300; train_global_loss: 2629976.1466; train_optim_loss: 2629976.1466; val_kl_reg_loss: 4715.4945; val_edge_recon_loss: 772379.6510; val_gene_expr_recon_loss: 1833421.3958; val_masked_gp_l1_reg_loss: 9971.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6099.8428; val_global_loss: 2626588.0625; val_optim_loss: 2626588.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9725; val_auprc_score: 0.9939; val_best_acc_score: 0.9599; val_best_f1_score: 0.9768; train_kl_reg_loss: 6656.2435; train_edge_recon_loss: 777006.3660; train_gene_expr_recon_loss: 1834034.7981; train_masked_gp_l1_reg_loss: 9970.8938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6096.8887; train_global_loss: 2633765.1851; train_optim_loss: 2633765.1851; val_kl_reg_loss: 4673.3840; val_edge_recon_loss: 765145.6615; val_gene_expr_recon_loss: 1832680.8958; val_masked_gp_l1_reg_loss: 9970.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6095.5947; val_global_loss: 2618565.7292; val_optim_loss: 2618565.7292
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9723; val_auprc_score: 0.9934; val_best_acc_score: 0.9596; val_best_f1_score: 0.9767; train_kl_reg_loss: 6649.0211; train_edge_recon_loss: 771530.0000; train_gene_expr_recon_loss: 1834150.0901; train_masked_gp_l1_reg_loss: 9969.7552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6094.4915; train_global_loss: 2628393.3654; train_optim_loss: 2628393.3654; val_kl_reg_loss: 4677.2726; val_edge_recon_loss: 764827.3646; val_gene_expr_recon_loss: 1833582.7292; val_masked_gp_l1_reg_loss: 9969.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6093.3438; val_global_loss: 2619149.8750; val_optim_loss: 2619149.8750
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9715; val_auprc_score: 0.9936; val_best_acc_score: 0.9580; val_best_f1_score: 0.9756; train_kl_reg_loss: 6645.3411; train_edge_recon_loss: 774663.1791; train_gene_expr_recon_loss: 1833492.8822; train_masked_gp_l1_reg_loss: 9968.6083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6092.1895; train_global_loss: 2630862.2067; train_optim_loss: 2630862.2067; val_kl_reg_loss: 4649.3382; val_edge_recon_loss: 774842.9844; val_gene_expr_recon_loss: 1832815.0625; val_masked_gp_l1_reg_loss: 9968.0186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6090.9966; val_global_loss: 2628366.3750; val_optim_loss: 2628366.3750
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9705; val_auprc_score: 0.9935; val_best_acc_score: 0.9596; val_best_f1_score: 0.9766; train_kl_reg_loss: 6644.0754; train_edge_recon_loss: 773461.3419; train_gene_expr_recon_loss: 1833371.6406; train_masked_gp_l1_reg_loss: 9967.4221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6089.7823; train_global_loss: 2629534.2596; train_optim_loss: 2629534.2596; val_kl_reg_loss: 4711.9530; val_edge_recon_loss: 769422.5573; val_gene_expr_recon_loss: 1833045.3646; val_masked_gp_l1_reg_loss: 9966.8145; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6088.5293; val_global_loss: 2623235.1458; val_optim_loss: 2623235.1458
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9708; val_auprc_score: 0.9936; val_best_acc_score: 0.9578; val_best_f1_score: 0.9756; train_kl_reg_loss: 6629.4004; train_edge_recon_loss: 776839.0463; train_gene_expr_recon_loss: 1833222.4171; train_masked_gp_l1_reg_loss: 9966.2054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6087.2654; train_global_loss: 2632744.3293; train_optim_loss: 2632744.3293; val_kl_reg_loss: 4658.2370; val_edge_recon_loss: 775079.7188; val_gene_expr_recon_loss: 1831532.0729; val_masked_gp_l1_reg_loss: 9965.5654; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6085.9531; val_global_loss: 2627321.5625; val_optim_loss: 2627321.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9690; val_auprc_score: 0.9926; val_best_acc_score: 0.9579; val_best_f1_score: 0.9757; train_kl_reg_loss: 6633.9373; train_edge_recon_loss: 772575.0198; train_gene_expr_recon_loss: 1833664.9423; train_masked_gp_l1_reg_loss: 9965.4640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6085.6228; train_global_loss: 2628925.0168; train_optim_loss: 2628925.0168; val_kl_reg_loss: 4669.0638; val_edge_recon_loss: 770461.9323; val_gene_expr_recon_loss: 1833371.7083; val_masked_gp_l1_reg_loss: 9965.3926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6085.4648; val_global_loss: 2624553.6875; val_optim_loss: 2624553.6875
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9714; val_auprc_score: 0.9934; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 6636.1557; train_edge_recon_loss: 777867.1070; train_gene_expr_recon_loss: 1833900.9351; train_masked_gp_l1_reg_loss: 9965.3258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6085.3275; train_global_loss: 2634454.8221; train_optim_loss: 2634454.8221; val_kl_reg_loss: 4655.1874; val_edge_recon_loss: 783498.0260; val_gene_expr_recon_loss: 1831551.7396; val_masked_gp_l1_reg_loss: 9965.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6085.1846; val_global_loss: 2635755.4792; val_optim_loss: 2635755.4792
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9701; val_auprc_score: 0.9933; val_best_acc_score: 0.9583; val_best_f1_score: 0.9758; train_kl_reg_loss: 6629.3842; train_edge_recon_loss: 774030.8077; train_gene_expr_recon_loss: 1833397.3522; train_masked_gp_l1_reg_loss: 9965.1898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6085.0405; train_global_loss: 2630107.8462; train_optim_loss: 2630107.8462; val_kl_reg_loss: 4665.4318; val_edge_recon_loss: 778799.1302; val_gene_expr_recon_loss: 1833936.1771; val_masked_gp_l1_reg_loss: 9965.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6084.8916; val_global_loss: 2633450.7083; val_optim_loss: 2633450.7083
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9695; val_auprc_score: 0.9925; val_best_acc_score: 0.9578; val_best_f1_score: 0.9754; train_kl_reg_loss: 6634.2436; train_edge_recon_loss: 773926.3546; train_gene_expr_recon_loss: 1833758.6611; train_masked_gp_l1_reg_loss: 9965.0459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6084.7411; train_global_loss: 2630368.9904; train_optim_loss: 2630368.9904; val_kl_reg_loss: 4652.9951; val_edge_recon_loss: 795015.7135; val_gene_expr_recon_loss: 1831973.0521; val_masked_gp_l1_reg_loss: 9964.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6084.5850; val_global_loss: 2647691.2708; val_optim_loss: 2647691.2708

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 169 min 5 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9721
val AUPRC score: 0.9941
val best accuracy score: 0.9590
val best F1 score: 0.9763
val target rna MSE score: 3.6901
val source rna MSE score: 7.5496
Val cat covariate0 mean sim diff: -0.0024

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
