Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9272; val_auprc_score: 0.9883; val_best_acc_score: 0.9344; val_best_f1_score: 0.9637; train_kl_reg_loss: 28315.6369; train_edge_recon_loss: 617965.3031; train_cat_covariates_contrastive_loss: 955081.8288; train_gene_expr_recon_loss: 1740607.1735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8029.4060; train_global_loss: 3349999.3481; train_optim_loss: 3349999.3481; val_kl_reg_loss: 28159.8280; val_edge_recon_loss: 638456.6165; val_cat_covariates_contrastive_loss: 954701.1019; val_gene_expr_recon_loss: 1743512.4765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8053.1289; val_global_loss: 3372883.2747; val_optim_loss: 3372883.2747
[True, False, True]
Run timestamp: 02092023_233857_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8958; val_auprc_score: 0.9816; val_best_acc_score: 0.9172; val_best_f1_score: 0.9541; train_kl_reg_loss: 18410.5448; train_edge_recon_loss: 737927.5885; train_cat_covariates_contrastive_loss: 952264.9364; train_gene_expr_recon_loss: 2586227.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58067.7584; train_global_loss: 4352898.3851; train_optim_loss: 4352898.3851; val_kl_reg_loss: 20252.6010; val_edge_recon_loss: 735514.2237; val_cat_covariates_contrastive_loss: 952318.3136; val_gene_expr_recon_loss: 2260203.1773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13595.0020; val_global_loss: 3981883.3218; val_optim_loss: 3981883.3218
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9274; val_auprc_score: 0.9883; val_best_acc_score: 0.9351; val_best_f1_score: 0.9642; train_kl_reg_loss: 28093.5468; train_edge_recon_loss: 616022.6351; train_cat_covariates_contrastive_loss: 955099.5813; train_gene_expr_recon_loss: 1739825.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8073.9153; train_global_loss: 3347115.1419; train_optim_loss: 3347115.1419; val_kl_reg_loss: 27776.1891; val_edge_recon_loss: 638500.5019; val_cat_covariates_contrastive_loss: 955189.6804; val_gene_expr_recon_loss: 1743889.2635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8089.7583; val_global_loss: 3373445.3943; val_optim_loss: 3373445.3943
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9089; val_auprc_score: 0.9837; val_best_acc_score: 0.9220; val_best_f1_score: 0.9564; train_kl_reg_loss: 21755.9660; train_edge_recon_loss: 707537.7421; train_cat_covariates_contrastive_loss: 953504.7427; train_gene_expr_recon_loss: 2115351.2302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14366.1926; train_global_loss: 3812515.8730; train_optim_loss: 3812515.8730; val_kl_reg_loss: 23324.3005; val_edge_recon_loss: 723385.2998; val_cat_covariates_contrastive_loss: 953540.7230; val_gene_expr_recon_loss: 2026852.4970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15199.0713; val_global_loss: 3742301.8183; val_optim_loss: 3742301.8183
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9118; val_auprc_score: 0.9843; val_best_acc_score: 0.9224; val_best_f1_score: 0.9567; train_kl_reg_loss: 23826.5337; train_edge_recon_loss: 703379.7213; train_cat_covariates_contrastive_loss: 954103.8569; train_gene_expr_recon_loss: 1986527.3944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15733.1054; train_global_loss: 3683570.6112; train_optim_loss: 3683570.6112; val_kl_reg_loss: 24392.6675; val_edge_recon_loss: 721230.9255; val_cat_covariates_contrastive_loss: 954148.7844; val_gene_expr_recon_loss: 1959025.8356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15886.3438; val_global_loss: 3674684.4576; val_optim_loss: 3674684.4576
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9283; val_auprc_score: 0.9887; val_best_acc_score: 0.9351; val_best_f1_score: 0.9642; train_kl_reg_loss: 27912.0301; train_edge_recon_loss: 617395.4084; train_cat_covariates_contrastive_loss: 954879.4531; train_gene_expr_recon_loss: 1738828.4817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8110.7627; train_global_loss: 3347126.1362; train_optim_loss: 3347126.1362; val_kl_reg_loss: 27761.6644; val_edge_recon_loss: 629784.7115; val_cat_covariates_contrastive_loss: 954966.4431; val_gene_expr_recon_loss: 1742339.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8125.0269; val_global_loss: 3362976.9059; val_optim_loss: 3362976.9059
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9134; val_auprc_score: 0.9845; val_best_acc_score: 0.9289; val_best_f1_score: 0.9604; train_kl_reg_loss: 24745.1953; train_edge_recon_loss: 702331.9604; train_cat_covariates_contrastive_loss: 954004.0081; train_gene_expr_recon_loss: 1939542.1275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16101.9551; train_global_loss: 3636725.2454; train_optim_loss: 3636725.2454; val_kl_reg_loss: 25340.4487; val_edge_recon_loss: 716918.6544; val_cat_covariates_contrastive_loss: 952492.6049; val_gene_expr_recon_loss: 1930656.1873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16163.8721; val_global_loss: 3641571.6574; val_optim_loss: 3641571.6574
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9245; val_auprc_score: 0.9879; val_best_acc_score: 0.9331; val_best_f1_score: 0.9631; train_kl_reg_loss: 27694.1602; train_edge_recon_loss: 616578.3299; train_cat_covariates_contrastive_loss: 955122.5086; train_gene_expr_recon_loss: 1738872.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8136.7957; train_global_loss: 3346404.5705; train_optim_loss: 3346404.5705; val_kl_reg_loss: 27699.7573; val_edge_recon_loss: 636054.2486; val_cat_covariates_contrastive_loss: 954583.7595; val_gene_expr_recon_loss: 1740355.5343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8146.2534; val_global_loss: 3366839.5579; val_optim_loss: 3366839.5579
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9112; val_auprc_score: 0.9840; val_best_acc_score: 0.9199; val_best_f1_score: 0.9553; train_kl_reg_loss: 25313.9718; train_edge_recon_loss: 700111.4770; train_cat_covariates_contrastive_loss: 954061.3180; train_gene_expr_recon_loss: 1914350.5849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16338.8253; train_global_loss: 3610176.1736; train_optim_loss: 3610176.1736; val_kl_reg_loss: 26108.5148; val_edge_recon_loss: 727937.8728; val_cat_covariates_contrastive_loss: 952867.1148; val_gene_expr_recon_loss: 1910653.2050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16429.5430; val_global_loss: 3633996.2137; val_optim_loss: 3633996.2137
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9198; val_auprc_score: 0.9857; val_best_acc_score: 0.9252; val_best_f1_score: 0.9583; train_kl_reg_loss: 25772.3464; train_edge_recon_loss: 697743.6632; train_cat_covariates_contrastive_loss: 954037.0867; train_gene_expr_recon_loss: 1897401.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16398.5584; train_global_loss: 3591352.8801; train_optim_loss: 3591352.8801; val_kl_reg_loss: 25646.3686; val_edge_recon_loss: 723299.2769; val_cat_covariates_contrastive_loss: 954631.6622; val_gene_expr_recon_loss: 1891942.3573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16350.6660; val_global_loss: 3611870.4109; val_optim_loss: 3611870.4109
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9271; val_auprc_score: 0.9885; val_best_acc_score: 0.9359; val_best_f1_score: 0.9646; train_kl_reg_loss: 27650.4686; train_edge_recon_loss: 613012.0571; train_cat_covariates_contrastive_loss: 954631.9127; train_gene_expr_recon_loss: 1737849.5891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8158.0720; train_global_loss: 3341302.0970; train_optim_loss: 3341302.0970; val_kl_reg_loss: 27310.9698; val_edge_recon_loss: 628241.8433; val_cat_covariates_contrastive_loss: 954240.4485; val_gene_expr_recon_loss: 1741231.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8183.5928; val_global_loss: 3359208.2145; val_optim_loss: 3359208.2145
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9227; val_auprc_score: 0.9865; val_best_acc_score: 0.9273; val_best_f1_score: 0.9595; train_kl_reg_loss: 26238.8944; train_edge_recon_loss: 699372.7133; train_cat_covariates_contrastive_loss: 954259.7946; train_gene_expr_recon_loss: 1882275.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16608.1171; train_global_loss: 3578754.8769; train_optim_loss: 3578754.8769; val_kl_reg_loss: 26236.2487; val_edge_recon_loss: 713355.6094; val_cat_covariates_contrastive_loss: 955880.2050; val_gene_expr_recon_loss: 1883686.4161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16610.2188; val_global_loss: 3595768.7232; val_optim_loss: 3595768.7232
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9253; val_auprc_score: 0.9880; val_best_acc_score: 0.9334; val_best_f1_score: 0.9632; train_kl_reg_loss: 27509.8842; train_edge_recon_loss: 616229.5783; train_cat_covariates_contrastive_loss: 954561.7195; train_gene_expr_recon_loss: 1737470.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8190.9891; train_global_loss: 3343962.4806; train_optim_loss: 3343962.4806; val_kl_reg_loss: 27281.3351; val_edge_recon_loss: 632446.5677; val_cat_covariates_contrastive_loss: 954578.7836; val_gene_expr_recon_loss: 1740998.9610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8197.5898; val_global_loss: 3363503.1597; val_optim_loss: 3363503.1597
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9189; val_auprc_score: 0.9854; val_best_acc_score: 0.9249; val_best_f1_score: 0.9580; train_kl_reg_loss: 26628.4596; train_edge_recon_loss: 697716.1564; train_cat_covariates_contrastive_loss: 954410.0635; train_gene_expr_recon_loss: 1871719.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16755.8290; train_global_loss: 3567230.0044; train_optim_loss: 3567230.0044; val_kl_reg_loss: 26834.3052; val_edge_recon_loss: 725589.0304; val_cat_covariates_contrastive_loss: 953926.3945; val_gene_expr_recon_loss: 1867010.5069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16830.0820; val_global_loss: 3590190.2344; val_optim_loss: 3590190.2344
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9304; val_auprc_score: 0.9890; val_best_acc_score: 0.9358; val_best_f1_score: 0.9645; train_kl_reg_loss: 27342.9929; train_edge_recon_loss: 616062.0773; train_cat_covariates_contrastive_loss: 954446.4080; train_gene_expr_recon_loss: 1737014.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8216.0276; train_global_loss: 3343081.6906; train_optim_loss: 3343081.6906; val_kl_reg_loss: 26798.3433; val_edge_recon_loss: 631765.5009; val_cat_covariates_contrastive_loss: 955958.7388; val_gene_expr_recon_loss: 1739783.6265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8239.6924; val_global_loss: 3362545.9583; val_optim_loss: 3362545.9583
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9160; val_auprc_score: 0.9847; val_best_acc_score: 0.9245; val_best_f1_score: 0.9579; train_kl_reg_loss: 27041.8806; train_edge_recon_loss: 697841.3625; train_cat_covariates_contrastive_loss: 954388.1651; train_gene_expr_recon_loss: 1863187.6010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16861.6098; train_global_loss: 3559320.6192; train_optim_loss: 3559320.6192; val_kl_reg_loss: 28255.8870; val_edge_recon_loss: 725799.9862; val_cat_covariates_contrastive_loss: 952847.9442; val_gene_expr_recon_loss: 1866060.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16898.4688; val_global_loss: 3589862.8140; val_optim_loss: 3589862.8140
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9170; val_auprc_score: 0.9847; val_best_acc_score: 0.9259; val_best_f1_score: 0.9585; train_kl_reg_loss: 27280.0382; train_edge_recon_loss: 696792.0747; train_cat_covariates_contrastive_loss: 954665.0179; train_gene_expr_recon_loss: 1854558.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16932.2448; train_global_loss: 3550228.1336; train_optim_loss: 3550228.1336; val_kl_reg_loss: 27779.4047; val_edge_recon_loss: 719955.8387; val_cat_covariates_contrastive_loss: 953240.8162; val_gene_expr_recon_loss: 1853148.2824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16996.2422; val_global_loss: 3571120.6047; val_optim_loss: 3571120.6047
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9252; val_auprc_score: 0.9880; val_best_acc_score: 0.9346; val_best_f1_score: 0.9639; train_kl_reg_loss: 27220.1025; train_edge_recon_loss: 614429.8079; train_cat_covariates_contrastive_loss: 954445.5138; train_gene_expr_recon_loss: 1736377.3045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8241.5278; train_global_loss: 3340714.2567; train_optim_loss: 3340714.2567; val_kl_reg_loss: 27475.8913; val_edge_recon_loss: 633301.1743; val_cat_covariates_contrastive_loss: 953248.4655; val_gene_expr_recon_loss: 1740426.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8243.1172; val_global_loss: 3362695.1134; val_optim_loss: 3362695.1134
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9175; val_auprc_score: 0.9854; val_best_acc_score: 0.9224; val_best_f1_score: 0.9568; train_kl_reg_loss: 27615.9646; train_edge_recon_loss: 696717.5275; train_cat_covariates_contrastive_loss: 954771.7112; train_gene_expr_recon_loss: 1850148.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17091.3091; train_global_loss: 3546344.8967; train_optim_loss: 3546344.8967; val_kl_reg_loss: 28370.2083; val_edge_recon_loss: 710081.3880; val_cat_covariates_contrastive_loss: 953965.6827; val_gene_expr_recon_loss: 1850510.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16926.8789; val_global_loss: 3559854.4429; val_optim_loss: 3559854.4429
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9292; val_auprc_score: 0.9888; val_best_acc_score: 0.9354; val_best_f1_score: 0.9645; train_kl_reg_loss: 27105.1281; train_edge_recon_loss: 615816.9720; train_cat_covariates_contrastive_loss: 954250.0177; train_gene_expr_recon_loss: 1735615.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8259.5584; train_global_loss: 3341046.7184; train_optim_loss: 3341046.7184; val_kl_reg_loss: 26843.5289; val_edge_recon_loss: 628703.6160; val_cat_covariates_contrastive_loss: 954354.0743; val_gene_expr_recon_loss: 1741057.8106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8263.4414; val_global_loss: 3359222.5324; val_optim_loss: 3359222.5324
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9164; val_auprc_score: 0.9848; val_best_acc_score: 0.9212; val_best_f1_score: 0.9559; train_kl_reg_loss: 27827.7043; train_edge_recon_loss: 699937.6045; train_cat_covariates_contrastive_loss: 954834.3152; train_gene_expr_recon_loss: 1844290.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17262.5507; train_global_loss: 3544152.8636; train_optim_loss: 3544152.8636; val_kl_reg_loss: 28123.0606; val_edge_recon_loss: 723670.9255; val_cat_covariates_contrastive_loss: 953868.7783; val_gene_expr_recon_loss: 1848759.6168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17115.0117; val_global_loss: 3571537.3901; val_optim_loss: 3571537.3901
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9205; val_auprc_score: 0.9857; val_best_acc_score: 0.9248; val_best_f1_score: 0.9579; train_kl_reg_loss: 28036.6993; train_edge_recon_loss: 699301.2611; train_cat_covariates_contrastive_loss: 954955.6797; train_gene_expr_recon_loss: 1838748.1537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17417.4550; train_global_loss: 3538459.2453; train_optim_loss: 3538459.2453; val_kl_reg_loss: 27666.3401; val_edge_recon_loss: 718638.6596; val_cat_covariates_contrastive_loss: 954749.4349; val_gene_expr_recon_loss: 1855018.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17459.8691; val_global_loss: 3573532.4187; val_optim_loss: 3573532.4187

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9285; val_auprc_score: 0.9886; val_best_acc_score: 0.9353; val_best_f1_score: 0.9643; train_kl_reg_loss: 26980.4039; train_edge_recon_loss: 616353.6305; train_cat_covariates_contrastive_loss: 954213.9297; train_gene_expr_recon_loss: 1732297.9326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8055.0847; train_global_loss: 3337900.9798; train_optim_loss: 3337900.9798; val_kl_reg_loss: 27026.9663; val_edge_recon_loss: 632386.6918; val_cat_covariates_contrastive_loss: 953814.5071; val_gene_expr_recon_loss: 1737300.4090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8050.8311; val_global_loss: 3358579.3272; val_optim_loss: 3358579.3272
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9240; val_auprc_score: 0.9863; val_best_acc_score: 0.9268; val_best_f1_score: 0.9590; train_kl_reg_loss: 28106.6587; train_edge_recon_loss: 697607.5180; train_cat_covariates_contrastive_loss: 954948.1139; train_gene_expr_recon_loss: 1836404.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17507.8094; train_global_loss: 3534574.9946; train_optim_loss: 3534574.9946; val_kl_reg_loss: 28575.9072; val_edge_recon_loss: 719101.5413; val_cat_covariates_contrastive_loss: 955444.2485; val_gene_expr_recon_loss: 1862976.0744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17702.9668; val_global_loss: 3583800.7751; val_optim_loss: 3583800.7751
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9293; val_auprc_score: 0.9888; val_best_acc_score: 0.9350; val_best_f1_score: 0.9641; train_kl_reg_loss: 27021.7879; train_edge_recon_loss: 616678.8646; train_cat_covariates_contrastive_loss: 954168.6322; train_gene_expr_recon_loss: 1732047.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8049.2421; train_global_loss: 3337965.7660; train_optim_loss: 3337965.7660; val_kl_reg_loss: 26982.1993; val_edge_recon_loss: 634194.0681; val_cat_covariates_contrastive_loss: 954091.0044; val_gene_expr_recon_loss: 1738720.0806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8048.2500; val_global_loss: 3362035.6042; val_optim_loss: 3362035.6042
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9234; val_auprc_score: 0.9861; val_best_acc_score: 0.9274; val_best_f1_score: 0.9594; train_kl_reg_loss: 28391.7510; train_edge_recon_loss: 697362.0335; train_cat_covariates_contrastive_loss: 955154.9114; train_gene_expr_recon_loss: 1833167.8547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17605.1959; train_global_loss: 3531681.7433; train_optim_loss: 3531681.7433; val_kl_reg_loss: 28888.3863; val_edge_recon_loss: 719989.7982; val_cat_covariates_contrastive_loss: 954598.3443; val_gene_expr_recon_loss: 1837417.0376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17594.9160; val_global_loss: 3558488.5718; val_optim_loss: 3558488.5718
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9248; val_auprc_score: 0.9863; val_best_acc_score: 0.9306; val_best_f1_score: 0.9611; train_kl_reg_loss: 28427.4239; train_edge_recon_loss: 698467.3719; train_cat_covariates_contrastive_loss: 955164.8805; train_gene_expr_recon_loss: 1828392.8979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17652.7552; train_global_loss: 3528105.3309; train_optim_loss: 3528105.3309; val_kl_reg_loss: 29047.2508; val_edge_recon_loss: 718097.6112; val_cat_covariates_contrastive_loss: 953674.3720; val_gene_expr_recon_loss: 1832867.7608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17581.7539; val_global_loss: 3551268.7543; val_optim_loss: 3551268.7543
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9272; val_auprc_score: 0.9882; val_best_acc_score: 0.9331; val_best_f1_score: 0.9631; train_kl_reg_loss: 26961.4922; train_edge_recon_loss: 616345.2888; train_cat_covariates_contrastive_loss: 954275.6072; train_gene_expr_recon_loss: 1730957.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8050.8022; train_global_loss: 3336590.7162; train_optim_loss: 3336590.7162; val_kl_reg_loss: 27051.3269; val_edge_recon_loss: 642021.6685; val_cat_covariates_contrastive_loss: 953786.1993; val_gene_expr_recon_loss: 1737375.9317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8051.3594; val_global_loss: 3368286.3735; val_optim_loss: 3368286.3735
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9158; val_auprc_score: 0.9846; val_best_acc_score: 0.9226; val_best_f1_score: 0.9567; train_kl_reg_loss: 28581.9715; train_edge_recon_loss: 697314.9146; train_cat_covariates_contrastive_loss: 955106.2954; train_gene_expr_recon_loss: 1825635.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17746.2339; train_global_loss: 3524385.1222; train_optim_loss: 3524385.1222; val_kl_reg_loss: 28619.3869; val_edge_recon_loss: 714206.1799; val_cat_covariates_contrastive_loss: 954607.6838; val_gene_expr_recon_loss: 1830367.0394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17748.6152; val_global_loss: 3545548.7889; val_optim_loss: 3545548.7889
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9284; val_auprc_score: 0.9887; val_best_acc_score: 0.9354; val_best_f1_score: 0.9644; train_kl_reg_loss: 27021.9312; train_edge_recon_loss: 614961.6577; train_cat_covariates_contrastive_loss: 954193.0667; train_gene_expr_recon_loss: 1731612.7607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8052.1775; train_global_loss: 3335841.5972; train_optim_loss: 3335841.5972; val_kl_reg_loss: 26997.8414; val_edge_recon_loss: 629073.8336; val_cat_covariates_contrastive_loss: 954335.5725; val_gene_expr_recon_loss: 1736296.0409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8052.6084; val_global_loss: 3354755.7863; val_optim_loss: 3354755.7863
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9251; val_auprc_score: 0.9865; val_best_acc_score: 0.9270; val_best_f1_score: 0.9591; train_kl_reg_loss: 28730.6728; train_edge_recon_loss: 693982.8141; train_cat_covariates_contrastive_loss: 955290.3753; train_gene_expr_recon_loss: 1822899.3616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17829.2123; train_global_loss: 3518732.4363; train_optim_loss: 3518732.4363; val_kl_reg_loss: 28274.3688; val_edge_recon_loss: 717773.2687; val_cat_covariates_contrastive_loss: 956280.9278; val_gene_expr_recon_loss: 1831910.9537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17813.2598; val_global_loss: 3552052.7768; val_optim_loss: 3552052.7768
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9187; val_auprc_score: 0.9848; val_best_acc_score: 0.9282; val_best_f1_score: 0.9598; train_kl_reg_loss: 28730.9905; train_edge_recon_loss: 697447.6322; train_cat_covariates_contrastive_loss: 955205.0101; train_gene_expr_recon_loss: 1819583.4162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17934.5109; train_global_loss: 3518901.5651; train_optim_loss: 3518901.5651; val_kl_reg_loss: 30800.5824; val_edge_recon_loss: 721643.2610; val_cat_covariates_contrastive_loss: 952084.9572; val_gene_expr_recon_loss: 1845611.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17778.2793; val_global_loss: 3567918.3036; val_optim_loss: 3567918.3036
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9271; val_auprc_score: 0.9882; val_best_acc_score: 0.9346; val_best_f1_score: 0.9638; train_kl_reg_loss: 26934.7512; train_edge_recon_loss: 612652.3123; train_cat_covariates_contrastive_loss: 954128.1565; train_gene_expr_recon_loss: 1731171.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8054.4010; train_global_loss: 3332941.3059; train_optim_loss: 3332941.3059; val_kl_reg_loss: 27013.1052; val_edge_recon_loss: 632088.8698; val_cat_covariates_contrastive_loss: 953731.8981; val_gene_expr_recon_loss: 1736912.4730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8056.0591; val_global_loss: 3357802.3465; val_optim_loss: 3357802.3465
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9257; val_auprc_score: 0.9865; val_best_acc_score: 0.9286; val_best_f1_score: 0.9601; train_kl_reg_loss: 29072.1868; train_edge_recon_loss: 694906.3667; train_cat_covariates_contrastive_loss: 955424.5431; train_gene_expr_recon_loss: 1820761.3466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17932.4877; train_global_loss: 3518096.9293; train_optim_loss: 3518096.9293; val_kl_reg_loss: 29358.4021; val_edge_recon_loss: 716237.6694; val_cat_covariates_contrastive_loss: 954753.3739; val_gene_expr_recon_loss: 1828405.0095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17908.0957; val_global_loss: 3546662.4611; val_optim_loss: 3546662.4611
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9297; val_auprc_score: 0.9888; val_best_acc_score: 0.9356; val_best_f1_score: 0.9644; train_kl_reg_loss: 26946.7823; train_edge_recon_loss: 614967.6266; train_cat_covariates_contrastive_loss: 954240.3607; train_gene_expr_recon_loss: 1731286.7009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8058.6993; train_global_loss: 3335500.1719; train_optim_loss: 3335500.1719; val_kl_reg_loss: 26820.9873; val_edge_recon_loss: 633402.0018; val_cat_covariates_contrastive_loss: 954345.6622; val_gene_expr_recon_loss: 1735343.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8059.8013; val_global_loss: 3357972.1674; val_optim_loss: 3357972.1674
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9262; val_auprc_score: 0.9864; val_best_acc_score: 0.9315; val_best_f1_score: 0.9616; train_kl_reg_loss: 29233.6794; train_edge_recon_loss: 695149.5246; train_cat_covariates_contrastive_loss: 955554.0141; train_gene_expr_recon_loss: 1817365.3183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17990.7457; train_global_loss: 3515293.2836; train_optim_loss: 3515293.2836; val_kl_reg_loss: 28916.3277; val_edge_recon_loss: 718968.2956; val_cat_covariates_contrastive_loss: 954934.9048; val_gene_expr_recon_loss: 1824625.1626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17999.4980; val_global_loss: 3545444.1877; val_optim_loss: 3545444.1877
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9235; val_auprc_score: 0.9862; val_best_acc_score: 0.9239; val_best_f1_score: 0.9573; train_kl_reg_loss: 29572.8046; train_edge_recon_loss: 696523.8806; train_cat_covariates_contrastive_loss: 955448.5952; train_gene_expr_recon_loss: 1815255.8593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17996.6478; train_global_loss: 3514797.7861; train_optim_loss: 3514797.7861; val_kl_reg_loss: 29577.2269; val_edge_recon_loss: 715688.4673; val_cat_covariates_contrastive_loss: 955372.7874; val_gene_expr_recon_loss: 1814828.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17865.0508; val_global_loss: 3533331.8659; val_optim_loss: 3533331.8659
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9304; val_auprc_score: 0.9890; val_best_acc_score: 0.9351; val_best_f1_score: 0.9642; train_kl_reg_loss: 26924.7214; train_edge_recon_loss: 614031.3900; train_cat_covariates_contrastive_loss: 954082.8467; train_gene_expr_recon_loss: 1730865.4762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8061.2505; train_global_loss: 3333965.6833; train_optim_loss: 3333965.6833; val_kl_reg_loss: 26835.5056; val_edge_recon_loss: 629603.7396; val_cat_covariates_contrastive_loss: 954457.5075; val_gene_expr_recon_loss: 1735872.0976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8062.2271; val_global_loss: 3354831.1003; val_optim_loss: 3354831.1003
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9299; val_auprc_score: 0.9874; val_best_acc_score: 0.9304; val_best_f1_score: 0.9608; train_kl_reg_loss: 70797841870450319360.0000; train_edge_recon_loss: 697992.9450; train_cat_covariates_contrastive_loss: 957085.9550; train_gene_expr_recon_loss: 1873140.7959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17961.2324; train_global_loss: 70797841870453882880.0000; train_optim_loss: 70797841870453882880.0000; val_kl_reg_loss: 34793.9736; val_edge_recon_loss: 721488.6427; val_cat_covariates_contrastive_loss: 958410.8237; val_gene_expr_recon_loss: 1847356.0117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17951.9141; val_global_loss: 3580001.4524; val_optim_loss: 3580001.4524
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9267; val_auprc_score: 0.9882; val_best_acc_score: 0.9347; val_best_f1_score: 0.9640; train_kl_reg_loss: 26913.8565; train_edge_recon_loss: 614787.7473; train_cat_covariates_contrastive_loss: 954075.2707; train_gene_expr_recon_loss: 1731165.3078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8064.9295; train_global_loss: 3335007.1157; train_optim_loss: 3335007.1157; val_kl_reg_loss: 27037.0762; val_edge_recon_loss: 637502.6582; val_cat_covariates_contrastive_loss: 953590.4005; val_gene_expr_recon_loss: 1737728.9279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8066.4702; val_global_loss: 3363925.5664; val_optim_loss: 3363925.5664
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9237; val_auprc_score: 0.9863; val_best_acc_score: 0.9274; val_best_f1_score: 0.9594; train_kl_reg_loss: 24003270.8056; train_edge_recon_loss: 697669.6275; train_cat_covariates_contrastive_loss: 957528.6773; train_gene_expr_recon_loss: 1845197.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17952.9025; train_global_loss: 27521619.3178; train_optim_loss: 27521619.3178; val_kl_reg_loss: 35795.1481; val_edge_recon_loss: 710633.1116; val_cat_covariates_contrastive_loss: 957427.4384; val_gene_expr_recon_loss: 1840715.8815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17956.4062; val_global_loss: 3562528.0865; val_optim_loss: 3562528.0865
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9248; val_auprc_score: 0.9865; val_best_acc_score: 0.9257; val_best_f1_score: 0.9584; train_kl_reg_loss: 233020772.9841; train_edge_recon_loss: 696271.0677; train_cat_covariates_contrastive_loss: 957564.3380; train_gene_expr_recon_loss: 1845721.6438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17975.0963; train_global_loss: 236538302.7821; train_optim_loss: 236538302.7821; val_kl_reg_loss: 35902.9497; val_edge_recon_loss: 714693.0671; val_cat_covariates_contrastive_loss: 958381.4857; val_gene_expr_recon_loss: 1842451.2587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17759.6230; val_global_loss: 3569188.2638; val_optim_loss: 3569188.2638

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9297; val_auprc_score: 0.9888; val_best_acc_score: 0.9347; val_best_f1_score: 0.9640; train_kl_reg_loss: 26922.5651; train_edge_recon_loss: 612595.2358; train_cat_covariates_contrastive_loss: 954009.1437; train_gene_expr_recon_loss: 1730968.6683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8044.0126; train_global_loss: 3332539.6196; train_optim_loss: 3332539.6196; val_kl_reg_loss: 26897.8045; val_edge_recon_loss: 631454.7030; val_cat_covariates_contrastive_loss: 953907.4743; val_gene_expr_recon_loss: 1736423.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8042.6543; val_global_loss: 3356726.0802; val_optim_loss: 3356726.0802
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9112; val_auprc_score: 0.9843; val_best_acc_score: 0.9218; val_best_f1_score: 0.9563; train_kl_reg_loss: 286710.4315; train_edge_recon_loss: 707419.3674; train_cat_covariates_contrastive_loss: 957133.9448; train_gene_expr_recon_loss: 1549809.6784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13794.6171; train_global_loss: 3514868.0446; train_optim_loss: 3514868.0446; val_kl_reg_loss: 24167.4800; val_edge_recon_loss: 726187.6572; val_cat_covariates_contrastive_loss: 957117.4851; val_gene_expr_recon_loss: 1517700.8655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13902.3848; val_global_loss: 3239075.9810; val_optim_loss: 3239075.9810
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9274; val_auprc_score: 0.9883; val_best_acc_score: 0.9342; val_best_f1_score: 0.9637; train_kl_reg_loss: 26875.8597; train_edge_recon_loss: 615076.8506; train_cat_covariates_contrastive_loss: 954154.4035; train_gene_expr_recon_loss: 1730384.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8042.5133; train_global_loss: 3334534.1823; train_optim_loss: 3334534.1823; val_kl_reg_loss: 26876.6143; val_edge_recon_loss: 636648.8600; val_cat_covariates_contrastive_loss: 953774.8565; val_gene_expr_recon_loss: 1736346.2998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8042.6055; val_global_loss: 3361689.1327; val_optim_loss: 3361689.1327
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9133; val_auprc_score: 0.9839; val_best_acc_score: 0.9273; val_best_f1_score: 0.9594; train_kl_reg_loss: 1547080777.1649; train_edge_recon_loss: 700529.8205; train_cat_covariates_contrastive_loss: 954909.3910; train_gene_expr_recon_loss: 1504726.0921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13903.1710; train_global_loss: 1550254846.1671; train_optim_loss: 1550254846.1671; val_kl_reg_loss: 27006.0826; val_edge_recon_loss: 722514.2911; val_cat_covariates_contrastive_loss: 953418.5000; val_gene_expr_recon_loss: 1492072.0095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13951.3555; val_global_loss: 3208962.1479; val_optim_loss: 3208962.1479
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9271; val_auprc_score: 0.9884; val_best_acc_score: 0.9348; val_best_f1_score: 0.9640; train_kl_reg_loss: 26900.1700; train_edge_recon_loss: 617514.8172; train_cat_covariates_contrastive_loss: 954209.0385; train_gene_expr_recon_loss: 1730670.3267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8042.6084; train_global_loss: 3337336.9543; train_optim_loss: 3337336.9543; val_kl_reg_loss: 26917.4676; val_edge_recon_loss: 631519.6780; val_cat_covariates_contrastive_loss: 953683.1900; val_gene_expr_recon_loss: 1736007.9452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8042.4668; val_global_loss: 3356170.7870; val_optim_loss: 3356170.7870
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9150; val_auprc_score: 0.9848; val_best_acc_score: 0.9246; val_best_f1_score: 0.9578; train_kl_reg_loss: 302551350.6945; train_edge_recon_loss: 698464.3845; train_cat_covariates_contrastive_loss: 954771.4725; train_gene_expr_recon_loss: 1487960.0559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13980.2631; train_global_loss: 305706539.8681; train_optim_loss: 305706539.8681; val_kl_reg_loss: 25280.7734; val_edge_recon_loss: 716308.9240; val_cat_covariates_contrastive_loss: 954548.8886; val_gene_expr_recon_loss: 1486016.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13952.8408; val_global_loss: 3196108.2405; val_optim_loss: 3196108.2405
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9290; val_auprc_score: 0.9885; val_best_acc_score: 0.9341; val_best_f1_score: 0.9636; train_kl_reg_loss: 26911.3349; train_edge_recon_loss: 615532.0506; train_cat_covariates_contrastive_loss: 954115.4155; train_gene_expr_recon_loss: 1731049.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8042.6847; train_global_loss: 3335651.0501; train_optim_loss: 3335651.0501; val_kl_reg_loss: 26887.2189; val_edge_recon_loss: 644550.1515; val_cat_covariates_contrastive_loss: 954058.8833; val_gene_expr_recon_loss: 1736221.4306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8042.7383; val_global_loss: 3369760.4336; val_optim_loss: 3369760.4336
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9133; val_auprc_score: 0.9845; val_best_acc_score: 0.9235; val_best_f1_score: 0.9573; train_kl_reg_loss: 66266.0284; train_edge_recon_loss: 708650.2364; train_cat_covariates_contrastive_loss: 954369.5557; train_gene_expr_recon_loss: 1650896.8799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14200.0998; train_global_loss: 3394382.7989; train_optim_loss: 3394382.7989; val_kl_reg_loss: 20168.6069; val_edge_recon_loss: 717834.6894; val_cat_covariates_contrastive_loss: 951685.2158; val_gene_expr_recon_loss: 1588676.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13912.8203; val_global_loss: 3292277.9048; val_optim_loss: 3292277.9048

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1285 min 36 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.8790
val AUPRC score: 0.9736
val best accuracy score: 0.9282
val best F1 score: 0.9602
val target rna MSE score: 0.3479
val source rna MSE score: 0.0675
Val cat covariate0 mean sim diff: -0.0012
Val cat covariate1 mean sim diff: -0.0710
Val cat covariate2 mean sim diff: -0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9168; val_auprc_score: 0.9850; val_best_acc_score: 0.9243; val_best_f1_score: 0.9577; train_kl_reg_loss: 21281.2759; train_edge_recon_loss: 696680.4758; train_cat_covariates_contrastive_loss: 951483.6211; train_gene_expr_recon_loss: 1529337.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13824.6902; train_global_loss: 3212607.3795; train_optim_loss: 3212607.3795; val_kl_reg_loss: 20095.1510; val_edge_recon_loss: 726183.4885; val_cat_covariates_contrastive_loss: 952252.5095; val_gene_expr_recon_loss: 1499264.9022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13609.1387; val_global_loss: 3211405.3019; val_optim_loss: 3211405.3019
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9195; val_auprc_score: 0.9858; val_best_acc_score: 0.9270; val_best_f1_score: 0.9592; train_kl_reg_loss: 20837283275466255395980975276032.0000; train_edge_recon_loss: 696966.2131; train_cat_covariates_contrastive_loss: 952216.1660; train_gene_expr_recon_loss: 1490132.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13761.1690; train_global_loss: 20837283275466255395980975276032.0000; train_optim_loss: 20837283275466255395980975276032.0000; val_kl_reg_loss: inf; val_edge_recon_loss: 716026.4896; val_cat_covariates_contrastive_loss: 954167.4178; val_gene_expr_recon_loss: 1486404.0904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13841.4062; val_global_loss: inf; val_optim_loss: inf
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9127; val_auprc_score: 0.9840; val_best_acc_score: 0.9235; val_best_f1_score: 0.9572; train_kl_reg_loss: inf; train_edge_recon_loss: 697414.0948; train_cat_covariates_contrastive_loss: 952367.8870; train_gene_expr_recon_loss: 1473573.3259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13685.3700; train_global_loss: inf; train_optim_loss: inf; val_kl_reg_loss: 100964616200921418131553910784.0000; val_edge_recon_loss: 726313.2443; val_cat_covariates_contrastive_loss: 951277.9492; val_gene_expr_recon_loss: 1469602.0666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13501.9434; val_global_loss: 100964616200921418131553910784.0000; val_optim_loss: 100964616200921418131553910784.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9187; val_auprc_score: 0.9853; val_best_acc_score: 0.9258; val_best_f1_score: 0.9585; train_kl_reg_loss: inf; train_edge_recon_loss: 694665.7681; train_cat_covariates_contrastive_loss: 951669.2153; train_gene_expr_recon_loss: 1452164.8811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6896.4921; train_global_loss: inf; train_optim_loss: inf; val_kl_reg_loss: 317431766076469132294873965133824.0000; val_edge_recon_loss: 718565.1628; val_cat_covariates_contrastive_loss: 951589.3051; val_gene_expr_recon_loss: 1451846.0307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6891.5332; val_global_loss: 317431766076469132294873965133824.0000; val_optim_loss: 317431766076469132294873965133824.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9177; val_auprc_score: 0.9850; val_best_acc_score: 0.9272; val_best_f1_score: 0.9595; train_kl_reg_loss: inf; train_edge_recon_loss: 693413.0018; train_cat_covariates_contrastive_loss: 951565.2493; train_gene_expr_recon_loss: 1448404.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6833.3412; train_global_loss: inf; train_optim_loss: inf; val_kl_reg_loss: 158671176547397035611001693667328.0000; val_edge_recon_loss: 711221.0075; val_cat_covariates_contrastive_loss: 951464.9719; val_gene_expr_recon_loss: 1450189.5441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6799.2886; val_global_loss: 158671176547397035611001693667328.0000; val_optim_loss: 158671176547397035611001693667328.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9176; val_auprc_score: 0.9849; val_best_acc_score: 0.9272; val_best_f1_score: 0.9594; train_kl_reg_loss: 13546901555008003860683473027072.0000; train_edge_recon_loss: 694132.8439; train_cat_covariates_contrastive_loss: 951595.6997; train_gene_expr_recon_loss: 1445027.4343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6808.9866; train_global_loss: 13546901555008003860683473027072.0000; train_optim_loss: 13546901555008003860683473027072.0000; val_kl_reg_loss: 198251657588652601757453298696192.0000; val_edge_recon_loss: 720804.9208; val_cat_covariates_contrastive_loss: 949936.4483; val_gene_expr_recon_loss: 1447497.2517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6809.7676; val_global_loss: 198251657588652601757453298696192.0000; val_optim_loss: 198251657588652601757453298696192.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9212; val_auprc_score: 0.9858; val_best_acc_score: 0.9273; val_best_f1_score: 0.9594; train_kl_reg_loss: 21756069203911142310507330928640.0000; train_edge_recon_loss: 694031.0543; train_cat_covariates_contrastive_loss: 951415.5645; train_gene_expr_recon_loss: 1442622.9763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6812.6039; train_global_loss: 21756069203911142310507330928640.0000; train_optim_loss: 21756069203911142310507330928640.0000; val_kl_reg_loss: 158589281744718215532344567136256.0000; val_edge_recon_loss: 713988.9749; val_cat_covariates_contrastive_loss: 951285.9375; val_gene_expr_recon_loss: 1445188.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6786.9893; val_global_loss: 158589281744718215532344567136256.0000; val_optim_loss: 158589281744718215532344567136256.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 803 min 44 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.8655
val AUPRC score: 0.9661
val best accuracy score: 0.9161
val best F1 score: 0.9529
val target rna MSE score: 0.4479
val source rna MSE score: 0.1919
Val cat covariate0 mean sim diff: -0.0026
Val cat covariate1 mean sim diff: -0.0592
Val cat covariate2 mean sim diff: -0.0023

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
