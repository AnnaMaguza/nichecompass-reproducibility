[True]
Run timestamp: 10102023_001735_84.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_84']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6799; val_auprc_score: 0.6681; val_best_acc_score: 0.5059; val_best_f1_score: 0.6693; train_kl_reg_loss: 38869.3583; train_edge_recon_loss: 3513819.1439; train_gene_expr_recon_loss: 14039215.2879; train_masked_gp_l1_reg_loss: 90138.3021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2985273.2008; train_chrom_access_recon_loss: 3001731.0720; train_global_loss: 23669046.1515; train_optim_loss: 23669046.1515; val_kl_reg_loss: 45010.4565; val_edge_recon_loss: 4064881.5000; val_gene_expr_recon_loss: 13126090.3750; val_masked_gp_l1_reg_loss: 78930.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1679715.3750; val_chrom_access_recon_loss: 2851830.5312; val_global_loss: 21846459.0000; val_optim_loss: 21846459.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6648; val_auprc_score: 0.6545; val_best_acc_score: 0.5656; val_best_f1_score: 0.6857; train_kl_reg_loss: 82207.0324; train_edge_recon_loss: 3511666.1364; train_gene_expr_recon_loss: 12913831.4697; train_masked_gp_l1_reg_loss: 77158.7415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 934488.6046; train_chrom_access_recon_loss: 2850723.1629; train_global_loss: 20370075.0606; train_optim_loss: 20370075.0606; val_kl_reg_loss: 92274.3564; val_edge_recon_loss: 4060663.5938; val_gene_expr_recon_loss: 12631239.0000; val_masked_gp_l1_reg_loss: 75710.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 462012.3125; val_chrom_access_recon_loss: 2833974.6875; val_global_loss: 20155873.5000; val_optim_loss: 20155873.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7296; val_auprc_score: 0.7025; val_best_acc_score: 0.6711; val_best_f1_score: 0.6981; train_kl_reg_loss: 81714.9688; train_edge_recon_loss: 3507499.2652; train_gene_expr_recon_loss: 12712789.1970; train_masked_gp_l1_reg_loss: 75705.1386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 307562.1804; train_chrom_access_recon_loss: 2818658.7311; train_global_loss: 19503929.5758; train_optim_loss: 19503929.5758; val_kl_reg_loss: 74099.9355; val_edge_recon_loss: 4023919.7188; val_gene_expr_recon_loss: 12510344.8750; val_masked_gp_l1_reg_loss: 76464.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 207100.4688; val_chrom_access_recon_loss: 2807653.2812; val_global_loss: 19699582.0000; val_optim_loss: 19699582.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8001; val_auprc_score: 0.7750; val_best_acc_score: 0.7206; val_best_f1_score: 0.7497; train_kl_reg_loss: 68288.5063; train_edge_recon_loss: 3464284.8144; train_gene_expr_recon_loss: 12617093.4545; train_masked_gp_l1_reg_loss: 78214.6965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163652.1335; train_chrom_access_recon_loss: 2805726.0303; train_global_loss: 19197259.6970; train_optim_loss: 19197259.6970; val_kl_reg_loss: 59513.9409; val_edge_recon_loss: 3547242.0000; val_gene_expr_recon_loss: 12381298.3750; val_masked_gp_l1_reg_loss: 81699.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132366.4531; val_chrom_access_recon_loss: 2774720.3750; val_global_loss: 18976839.5000; val_optim_loss: 18976839.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8424; val_auprc_score: 0.8116; val_best_acc_score: 0.7539; val_best_f1_score: 0.7943; train_kl_reg_loss: 75478.6547; train_edge_recon_loss: 3097054.1932; train_gene_expr_recon_loss: 12581854.8939; train_masked_gp_l1_reg_loss: 87426.9351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117498.7063; train_chrom_access_recon_loss: 2791640.6591; train_global_loss: 18750953.9697; train_optim_loss: 18750953.9697; val_kl_reg_loss: 90802.6826; val_edge_recon_loss: 2954325.3750; val_gene_expr_recon_loss: 12385294.0000; val_masked_gp_l1_reg_loss: 92575.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107231.0703; val_chrom_access_recon_loss: 2781421.6562; val_global_loss: 18411649.7500; val_optim_loss: 18411649.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8512; val_auprc_score: 0.8084; val_best_acc_score: 0.7706; val_best_f1_score: 0.7958; train_kl_reg_loss: 95417.7598; train_edge_recon_loss: 2943116.5720; train_gene_expr_recon_loss: 12474462.6212; train_masked_gp_l1_reg_loss: 93088.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97554.7726; train_chrom_access_recon_loss: 2774316.1250; train_global_loss: 18477956.6667; train_optim_loss: 18477956.6667; val_kl_reg_loss: 96079.7734; val_edge_recon_loss: 2939994.7500; val_gene_expr_recon_loss: 12217692.8750; val_masked_gp_l1_reg_loss: 93645.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90227.1875; val_chrom_access_recon_loss: 2746198.3438; val_global_loss: 18183838.0000; val_optim_loss: 18183838.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8618; val_auprc_score: 0.8227; val_best_acc_score: 0.7872; val_best_f1_score: 0.8133; train_kl_reg_loss: 93790.7952; train_edge_recon_loss: 2899037.6061; train_gene_expr_recon_loss: 12380636.1364; train_masked_gp_l1_reg_loss: 94197.1461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86121.5945; train_chrom_access_recon_loss: 2757305.2045; train_global_loss: 18311088.4242; train_optim_loss: 18311088.4242; val_kl_reg_loss: 90437.6934; val_edge_recon_loss: 2922861.4688; val_gene_expr_recon_loss: 12134174.2500; val_masked_gp_l1_reg_loss: 94672.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82095.5859; val_chrom_access_recon_loss: 2742427.1250; val_global_loss: 18066668.2500; val_optim_loss: 18066668.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8775; val_auprc_score: 0.8380; val_best_acc_score: 0.8117; val_best_f1_score: 0.8315; train_kl_reg_loss: 90299.7728; train_edge_recon_loss: 2875935.0303; train_gene_expr_recon_loss: 12330320.7576; train_masked_gp_l1_reg_loss: 95357.0425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78991.9727; train_chrom_access_recon_loss: 2749756.0000; train_global_loss: 18220660.4242; train_optim_loss: 18220660.4242; val_kl_reg_loss: 90487.7842; val_edge_recon_loss: 2853883.6875; val_gene_expr_recon_loss: 12197228.6250; val_masked_gp_l1_reg_loss: 96417.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75977.1094; val_chrom_access_recon_loss: 2746782.5312; val_global_loss: 18060776.2500; val_optim_loss: 18060776.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8807; val_auprc_score: 0.8400; val_best_acc_score: 0.8224; val_best_f1_score: 0.8378; train_kl_reg_loss: 94574.0984; train_edge_recon_loss: 2833482.5492; train_gene_expr_recon_loss: 12263370.7121; train_masked_gp_l1_reg_loss: 97239.8783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73840.9482; train_chrom_access_recon_loss: 2738458.4773; train_global_loss: 18100966.6364; train_optim_loss: 18100966.6364; val_kl_reg_loss: 97439.7578; val_edge_recon_loss: 2837943.5312; val_gene_expr_recon_loss: 12061065.7500; val_masked_gp_l1_reg_loss: 98349.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71944.2422; val_chrom_access_recon_loss: 2723473.5000; val_global_loss: 17890216.7500; val_optim_loss: 17890216.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8905; val_auprc_score: 0.8507; val_best_acc_score: 0.8313; val_best_f1_score: 0.8427; train_kl_reg_loss: 92042.1855; train_edge_recon_loss: 2818390.5417; train_gene_expr_recon_loss: 12217399.3485; train_masked_gp_l1_reg_loss: 99865.9209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70242.8706; train_chrom_access_recon_loss: 2726201.5417; train_global_loss: 18024142.3636; train_optim_loss: 18024142.3636; val_kl_reg_loss: 93353.2051; val_edge_recon_loss: 2820180.8750; val_gene_expr_recon_loss: 12063536.8750; val_masked_gp_l1_reg_loss: 100886.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68667.0078; val_chrom_access_recon_loss: 2726780.5938; val_global_loss: 17873405.7500; val_optim_loss: 17873405.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8976; val_auprc_score: 0.8640; val_best_acc_score: 0.8299; val_best_f1_score: 0.8462; train_kl_reg_loss: 91741.9065; train_edge_recon_loss: 2794714.1818; train_gene_expr_recon_loss: 12170477.7273; train_masked_gp_l1_reg_loss: 103207.8430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67305.0217; train_chrom_access_recon_loss: 2719949.1932; train_global_loss: 17947395.8788; train_optim_loss: 17947395.8788; val_kl_reg_loss: 90071.4609; val_edge_recon_loss: 2844871.4375; val_gene_expr_recon_loss: 11988323.7500; val_masked_gp_l1_reg_loss: 103668.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66544.8125; val_chrom_access_recon_loss: 2688924.9375; val_global_loss: 17782404.5000; val_optim_loss: 17782404.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9022; val_auprc_score: 0.8660; val_best_acc_score: 0.8369; val_best_f1_score: 0.8496; train_kl_reg_loss: 90373.8839; train_edge_recon_loss: 2783377.4697; train_gene_expr_recon_loss: 12128274.2727; train_masked_gp_l1_reg_loss: 105681.0881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65063.8981; train_chrom_access_recon_loss: 2705855.5038; train_global_loss: 17878626.2121; train_optim_loss: 17878626.2121; val_kl_reg_loss: 88781.1650; val_edge_recon_loss: 2847244.4375; val_gene_expr_recon_loss: 11957813.3750; val_masked_gp_l1_reg_loss: 105574.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64162.9297; val_chrom_access_recon_loss: 2684597.3125; val_global_loss: 17748174.0000; val_optim_loss: 17748174.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9076; val_auprc_score: 0.8694; val_best_acc_score: 0.8506; val_best_f1_score: 0.8613; train_kl_reg_loss: 89767.3996; train_edge_recon_loss: 2781298.4659; train_gene_expr_recon_loss: 12079763.9697; train_masked_gp_l1_reg_loss: 104857.7238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63192.4994; train_chrom_access_recon_loss: 2695657.9129; train_global_loss: 17814538.0000; train_optim_loss: 17814538.0000; val_kl_reg_loss: 88574.6201; val_edge_recon_loss: 2799879.9062; val_gene_expr_recon_loss: 11966969.1250; val_masked_gp_l1_reg_loss: 104942.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63079.4023; val_chrom_access_recon_loss: 2681532.9062; val_global_loss: 17704978.5000; val_optim_loss: 17704978.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9159; val_auprc_score: 0.8790; val_best_acc_score: 0.8579; val_best_f1_score: 0.8663; train_kl_reg_loss: 89817.9925; train_edge_recon_loss: 2769577.3826; train_gene_expr_recon_loss: 12038467.2424; train_masked_gp_l1_reg_loss: 104532.5843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62318.8275; train_chrom_access_recon_loss: 2688905.6136; train_global_loss: 17753619.5455; train_optim_loss: 17753619.5455; val_kl_reg_loss: 87849.9131; val_edge_recon_loss: 2799281.1250; val_gene_expr_recon_loss: 11801614.1250; val_masked_gp_l1_reg_loss: 104789.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61673.4453; val_chrom_access_recon_loss: 2670487.8750; val_global_loss: 17525696.5000; val_optim_loss: 17525696.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9149; val_auprc_score: 0.8848; val_best_acc_score: 0.8560; val_best_f1_score: 0.8641; train_kl_reg_loss: 88901.8451; train_edge_recon_loss: 2768401.1553; train_gene_expr_recon_loss: 12008847.8182; train_masked_gp_l1_reg_loss: 104865.2604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61556.8933; train_chrom_access_recon_loss: 2684733.0189; train_global_loss: 17717306.0000; train_optim_loss: 17717306.0000; val_kl_reg_loss: 88975.2275; val_edge_recon_loss: 2772692.5625; val_gene_expr_recon_loss: 11758999.5000; val_masked_gp_l1_reg_loss: 105083.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61417.3359; val_chrom_access_recon_loss: 2696623.9688; val_global_loss: 17483792.2500; val_optim_loss: 17483792.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9136; val_auprc_score: 0.8795; val_best_acc_score: 0.8520; val_best_f1_score: 0.8619; train_kl_reg_loss: 87369.9780; train_edge_recon_loss: 2761267.2727; train_gene_expr_recon_loss: 11981265.5909; train_masked_gp_l1_reg_loss: 105526.3490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60855.2024; train_chrom_access_recon_loss: 2676263.0795; train_global_loss: 17672547.5455; train_optim_loss: 17672547.5455; val_kl_reg_loss: 88773.2314; val_edge_recon_loss: 2820097.0625; val_gene_expr_recon_loss: 11897127.1250; val_masked_gp_l1_reg_loss: 105969.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60882.6055; val_chrom_access_recon_loss: 2677620.5312; val_global_loss: 17650471.0000; val_optim_loss: 17650471.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9187; val_auprc_score: 0.8902; val_best_acc_score: 0.8584; val_best_f1_score: 0.8672; train_kl_reg_loss: 87450.4516; train_edge_recon_loss: 2750543.0000; train_gene_expr_recon_loss: 11943289.7576; train_masked_gp_l1_reg_loss: 106058.0745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60457.3820; train_chrom_access_recon_loss: 2668751.1439; train_global_loss: 17616549.9091; train_optim_loss: 17616549.9091; val_kl_reg_loss: 87601.6328; val_edge_recon_loss: 2774067.3438; val_gene_expr_recon_loss: 11731286.8750; val_masked_gp_l1_reg_loss: 106443.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60528.8164; val_chrom_access_recon_loss: 2661631.8750; val_global_loss: 17421560.2500; val_optim_loss: 17421560.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9144; val_auprc_score: 0.8825; val_best_acc_score: 0.8536; val_best_f1_score: 0.8638; train_kl_reg_loss: 86886.1986; train_edge_recon_loss: 2735762.7841; train_gene_expr_recon_loss: 11914623.8333; train_masked_gp_l1_reg_loss: 106659.2186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60448.2612; train_chrom_access_recon_loss: 2663991.5341; train_global_loss: 17568371.9697; train_optim_loss: 17568371.9697; val_kl_reg_loss: 88742.1846; val_edge_recon_loss: 2805762.6562; val_gene_expr_recon_loss: 11735696.2500; val_masked_gp_l1_reg_loss: 106776.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60644.3477; val_chrom_access_recon_loss: 2642561.6875; val_global_loss: 17440183.5000; val_optim_loss: 17440183.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9268; val_auprc_score: 0.8938; val_best_acc_score: 0.8702; val_best_f1_score: 0.8792; train_kl_reg_loss: 86513.1120; train_edge_recon_loss: 2737359.7083; train_gene_expr_recon_loss: 11862877.6212; train_masked_gp_l1_reg_loss: 107106.4826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60444.2055; train_chrom_access_recon_loss: 2650904.2614; train_global_loss: 17505205.3030; train_optim_loss: 17505205.3030; val_kl_reg_loss: 80683.3438; val_edge_recon_loss: 2761112.9375; val_gene_expr_recon_loss: 11779964.7500; val_masked_gp_l1_reg_loss: 107607.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60920.5352; val_chrom_access_recon_loss: 2661752.2812; val_global_loss: 17452042.2500; val_optim_loss: 17452042.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9264; val_auprc_score: 0.8985; val_best_acc_score: 0.8702; val_best_f1_score: 0.8772; train_kl_reg_loss: 83901.6723; train_edge_recon_loss: 2739803.1174; train_gene_expr_recon_loss: 11848897.9697; train_masked_gp_l1_reg_loss: 107806.0210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60718.8899; train_chrom_access_recon_loss: 2645119.7273; train_global_loss: 17486247.3182; train_optim_loss: 17486247.3182; val_kl_reg_loss: 87051.8154; val_edge_recon_loss: 2785243.4062; val_gene_expr_recon_loss: 11571069.6250; val_masked_gp_l1_reg_loss: 108243.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60215.0312; val_chrom_access_recon_loss: 2601797.6250; val_global_loss: 17213620.1250; val_optim_loss: 17213620.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9230; val_auprc_score: 0.8924; val_best_acc_score: 0.8686; val_best_f1_score: 0.8779; train_kl_reg_loss: 85379.7975; train_edge_recon_loss: 2738204.5568; train_gene_expr_recon_loss: 11827538.6970; train_masked_gp_l1_reg_loss: 108375.9999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60138.7431; train_chrom_access_recon_loss: 2643831.4962; train_global_loss: 17463469.3030; train_optim_loss: 17463469.3030; val_kl_reg_loss: 86194.5078; val_edge_recon_loss: 2775091.7188; val_gene_expr_recon_loss: 11792987.5000; val_masked_gp_l1_reg_loss: 108478.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60172.7031; val_chrom_access_recon_loss: 2650893.4688; val_global_loss: 17473819.5000; val_optim_loss: 17473819.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9317; val_auprc_score: 0.9025; val_best_acc_score: 0.8751; val_best_f1_score: 0.8822; train_kl_reg_loss: 84926.0508; train_edge_recon_loss: 2735106.1439; train_gene_expr_recon_loss: 11801555.3182; train_masked_gp_l1_reg_loss: 108568.5805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59946.3735; train_chrom_access_recon_loss: 2635786.2841; train_global_loss: 17425888.7576; train_optim_loss: 17425888.7576; val_kl_reg_loss: 81196.0723; val_edge_recon_loss: 2762432.3438; val_gene_expr_recon_loss: 11646031.7500; val_masked_gp_l1_reg_loss: 108764.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59757.7383; val_chrom_access_recon_loss: 2646015.6875; val_global_loss: 17304197.7500; val_optim_loss: 17304197.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9321; val_auprc_score: 0.8968; val_best_acc_score: 0.8804; val_best_f1_score: 0.8861; train_kl_reg_loss: 82523.5268; train_edge_recon_loss: 2726563.5303; train_gene_expr_recon_loss: 11778125.7121; train_masked_gp_l1_reg_loss: 109088.5175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59712.9331; train_chrom_access_recon_loss: 2629841.6098; train_global_loss: 17385856.0000; train_optim_loss: 17385856.0000; val_kl_reg_loss: 84300.3916; val_edge_recon_loss: 2751677.5625; val_gene_expr_recon_loss: 11608527.6250; val_masked_gp_l1_reg_loss: 109389.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59359.7734; val_chrom_access_recon_loss: 2639070.3438; val_global_loss: 17252324.7500; val_optim_loss: 17252324.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9268; val_auprc_score: 0.8900; val_best_acc_score: 0.8732; val_best_f1_score: 0.8811; train_kl_reg_loss: 83541.9072; train_edge_recon_loss: 2735556.3030; train_gene_expr_recon_loss: 11757301.3788; train_masked_gp_l1_reg_loss: 109585.3422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59366.3691; train_chrom_access_recon_loss: 2625345.1780; train_global_loss: 17370696.5455; train_optim_loss: 17370696.5455; val_kl_reg_loss: 86215.1406; val_edge_recon_loss: 2763530.1250; val_gene_expr_recon_loss: 11617836.0000; val_masked_gp_l1_reg_loss: 109559.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59057.6367; val_chrom_access_recon_loss: 2617891.0625; val_global_loss: 17254090.5000; val_optim_loss: 17254090.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9387; val_auprc_score: 0.9147; val_best_acc_score: 0.8898; val_best_f1_score: 0.8957; train_kl_reg_loss: 85586.6360; train_edge_recon_loss: 2723518.0985; train_gene_expr_recon_loss: 11728614.5909; train_masked_gp_l1_reg_loss: 106769.3907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47772.9170; train_chrom_access_recon_loss: 2617712.0303; train_global_loss: 17309973.6212; train_optim_loss: 17309973.6212; val_kl_reg_loss: 85242.8037; val_edge_recon_loss: 2715193.4688; val_gene_expr_recon_loss: 11645499.5000; val_masked_gp_l1_reg_loss: 105715.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45045.9492; val_chrom_access_recon_loss: 2619399.0938; val_global_loss: 17216095.8750; val_optim_loss: 17216095.8750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9342; val_auprc_score: 0.9070; val_best_acc_score: 0.8812; val_best_f1_score: 0.8882; train_kl_reg_loss: 84723.1488; train_edge_recon_loss: 2715762.7765; train_gene_expr_recon_loss: 11739602.6364; train_masked_gp_l1_reg_loss: 105550.1370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44826.5807; train_chrom_access_recon_loss: 2617535.2235; train_global_loss: 17308000.5758; train_optim_loss: 17308000.5758; val_kl_reg_loss: 85044.8809; val_edge_recon_loss: 2746804.4688; val_gene_expr_recon_loss: 11580242.5000; val_masked_gp_l1_reg_loss: 105473.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44628.4727; val_chrom_access_recon_loss: 2638941.9688; val_global_loss: 17201134.7500; val_optim_loss: 17201134.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9372; val_auprc_score: 0.9100; val_best_acc_score: 0.8898; val_best_f1_score: 0.8944; train_kl_reg_loss: 85073.3982; train_edge_recon_loss: 2721138.0341; train_gene_expr_recon_loss: 11724865.5455; train_masked_gp_l1_reg_loss: 105461.8678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44527.9516; train_chrom_access_recon_loss: 2615565.5833; train_global_loss: 17296632.4848; train_optim_loss: 17296632.4848; val_kl_reg_loss: 83972.7734; val_edge_recon_loss: 2750404.2812; val_gene_expr_recon_loss: 11509224.7500; val_masked_gp_l1_reg_loss: 105452.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44411.6445; val_chrom_access_recon_loss: 2608589.6875; val_global_loss: 17102056.5000; val_optim_loss: 17102056.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9400; val_auprc_score: 0.9126; val_best_acc_score: 0.8880; val_best_f1_score: 0.8938; train_kl_reg_loss: 84999.2686; train_edge_recon_loss: 2704060.0303; train_gene_expr_recon_loss: 11726031.5455; train_masked_gp_l1_reg_loss: 105460.9147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44343.4174; train_chrom_access_recon_loss: 2615999.6818; train_global_loss: 17280894.8333; train_optim_loss: 17280894.8333; val_kl_reg_loss: 84698.3008; val_edge_recon_loss: 2735387.5312; val_gene_expr_recon_loss: 11562094.5000; val_masked_gp_l1_reg_loss: 105463.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44249.3242; val_chrom_access_recon_loss: 2610071.5000; val_global_loss: 17141964.8750; val_optim_loss: 17141964.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9379; val_auprc_score: 0.9026; val_best_acc_score: 0.8939; val_best_f1_score: 0.8988; train_kl_reg_loss: 85217.9464; train_edge_recon_loss: 2722687.7955; train_gene_expr_recon_loss: 11724361.2727; train_masked_gp_l1_reg_loss: 105482.8024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44170.0891; train_chrom_access_recon_loss: 2616030.1705; train_global_loss: 17297950.0606; train_optim_loss: 17297950.0606; val_kl_reg_loss: 84066.8965; val_edge_recon_loss: 2736011.1562; val_gene_expr_recon_loss: 11649474.2500; val_masked_gp_l1_reg_loss: 105524.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44106.4688; val_chrom_access_recon_loss: 2634325.0938; val_global_loss: 17253508.8750; val_optim_loss: 17253508.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9392; val_auprc_score: 0.9136; val_best_acc_score: 0.8869; val_best_f1_score: 0.8932; train_kl_reg_loss: 84795.2228; train_edge_recon_loss: 2714792.0682; train_gene_expr_recon_loss: 11723810.1667; train_masked_gp_l1_reg_loss: 105505.0908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44031.6934; train_chrom_access_recon_loss: 2614463.9848; train_global_loss: 17287398.1818; train_optim_loss: 17287398.1818; val_kl_reg_loss: 84272.9883; val_edge_recon_loss: 2738116.4375; val_gene_expr_recon_loss: 11610395.3750; val_masked_gp_l1_reg_loss: 105504.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43967.5234; val_chrom_access_recon_loss: 2603743.5000; val_global_loss: 17186000.3750; val_optim_loss: 17186000.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9453; val_auprc_score: 0.9260; val_best_acc_score: 0.8923; val_best_f1_score: 0.8965; train_kl_reg_loss: 84248.6084; train_edge_recon_loss: 2712412.8409; train_gene_expr_recon_loss: 11720644.1515; train_masked_gp_l1_reg_loss: 105541.4141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43918.3772; train_chrom_access_recon_loss: 2614142.0379; train_global_loss: 17280907.3636; train_optim_loss: 17280907.3636; val_kl_reg_loss: 83932.1152; val_edge_recon_loss: 2733738.9062; val_gene_expr_recon_loss: 11565972.5000; val_masked_gp_l1_reg_loss: 105597.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43896.2227; val_chrom_access_recon_loss: 2600708.9062; val_global_loss: 17133846.1250; val_optim_loss: 17133846.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9345; val_auprc_score: 0.9048; val_best_acc_score: 0.8831; val_best_f1_score: 0.8888; train_kl_reg_loss: 84497.0469; train_edge_recon_loss: 2723329.8788; train_gene_expr_recon_loss: 11710248.5000; train_masked_gp_l1_reg_loss: 105271.4631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42771.3664; train_chrom_access_recon_loss: 2609551.2841; train_global_loss: 17275669.5303; train_optim_loss: 17275669.5303; val_kl_reg_loss: 84417.4248; val_edge_recon_loss: 2781393.5938; val_gene_expr_recon_loss: 11537594.1250; val_masked_gp_l1_reg_loss: 105111.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42490.4023; val_chrom_access_recon_loss: 2614388.1250; val_global_loss: 17165395.2500; val_optim_loss: 17165395.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9277; val_auprc_score: 0.9010; val_best_acc_score: 0.8753; val_best_f1_score: 0.8837; train_kl_reg_loss: 84601.9041; train_edge_recon_loss: 2724737.0455; train_gene_expr_recon_loss: 11721555.0758; train_masked_gp_l1_reg_loss: 105076.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42461.9401; train_chrom_access_recon_loss: 2614292.7311; train_global_loss: 17292725.2273; train_optim_loss: 17292725.2273; val_kl_reg_loss: 83720.1484; val_edge_recon_loss: 2769439.4062; val_gene_expr_recon_loss: 11566237.8750; val_masked_gp_l1_reg_loss: 105055.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42441.6641; val_chrom_access_recon_loss: 2621604.9062; val_global_loss: 17188500.2500; val_optim_loss: 17188500.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9364; val_auprc_score: 0.9074; val_best_acc_score: 0.8842; val_best_f1_score: 0.8897; train_kl_reg_loss: 84562.9825; train_edge_recon_loss: 2717994.4659; train_gene_expr_recon_loss: 11716730.0758; train_masked_gp_l1_reg_loss: 105045.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42426.4047; train_chrom_access_recon_loss: 2612523.2311; train_global_loss: 17279282.4242; train_optim_loss: 17279282.4242; val_kl_reg_loss: 83922.0576; val_edge_recon_loss: 2776236.2188; val_gene_expr_recon_loss: 11592643.3750; val_masked_gp_l1_reg_loss: 105035.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42414.4922; val_chrom_access_recon_loss: 2602272.4062; val_global_loss: 17202523.1250; val_optim_loss: 17202523.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9393; val_auprc_score: 0.9139; val_best_acc_score: 0.8855; val_best_f1_score: 0.8917; train_kl_reg_loss: 84617.1190; train_edge_recon_loss: 2707992.8485; train_gene_expr_recon_loss: 11717825.0000; train_masked_gp_l1_reg_loss: 105029.8577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42399.9787; train_chrom_access_recon_loss: 2614081.9167; train_global_loss: 17271946.7121; train_optim_loss: 17271946.7121; val_kl_reg_loss: 84087.8369; val_edge_recon_loss: 2754343.2500; val_gene_expr_recon_loss: 11658933.0000; val_masked_gp_l1_reg_loss: 105029.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42391.4805; val_chrom_access_recon_loss: 2612829.0938; val_global_loss: 17257613.1250; val_optim_loss: 17257613.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 28 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9389
val AUPRC score: 0.9114
val best accuracy score: 0.8909
val best F1 score: 0.8963
val target rna MSE score: 1.1947
val source rna MSE score: 0.9305
val target atac MSE score: 0.4785
val source atac MSE score: 0.1950
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
