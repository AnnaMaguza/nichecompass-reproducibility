[True]
Run timestamp: 07082023_200222_84.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_84']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8957; val_auprc_score: 0.9119; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 14101.0947; train_edge_recon_loss: 350501.4618; train_gene_expr_recon_loss: 1201137.2083; train_masked_gp_l1_reg_loss: 4591.8015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166981.0156; train_chrom_access_recon_loss: 798801.1597; train_global_loss: 2536113.7778; train_optim_loss: 2536113.7778; val_kl_reg_loss: 6617.9707; val_edge_recon_loss: 406545.9062; val_gene_expr_recon_loss: 989929.6250; val_masked_gp_l1_reg_loss: 4109.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162248.1875; val_chrom_access_recon_loss: 504574.1562; val_global_loss: 2074025.1250; val_optim_loss: 2074025.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8863; val_auprc_score: 0.8987; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 8608.2086; train_edge_recon_loss: 352725.9688; train_gene_expr_recon_loss: 917804.0208; train_masked_gp_l1_reg_loss: 4042.1988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159339.1302; train_chrom_access_recon_loss: 491041.1042; train_global_loss: 1933560.6250; train_optim_loss: 1933560.6250; val_kl_reg_loss: 11942.9131; val_edge_recon_loss: 406568.7812; val_gene_expr_recon_loss: 822780.8750; val_masked_gp_l1_reg_loss: 4066.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155717.6719; val_chrom_access_recon_loss: 464357.1875; val_global_loss: 1865434.2500; val_optim_loss: 1865434.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8743; val_auprc_score: 0.8950; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 13814.7308; train_edge_recon_loss: 356461.8507; train_gene_expr_recon_loss: 809479.6806; train_masked_gp_l1_reg_loss: 4184.2835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152486.6840; train_chrom_access_recon_loss: 468317.1181; train_global_loss: 1804744.3472; train_optim_loss: 1804744.3472; val_kl_reg_loss: 13944.9219; val_edge_recon_loss: 406553.0625; val_gene_expr_recon_loss: 770334.9375; val_masked_gp_l1_reg_loss: 4315.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148140.0625; val_chrom_access_recon_loss: 452634.0312; val_global_loss: 1795922.7500; val_optim_loss: 1795922.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8722; val_auprc_score: 0.8880; val_best_acc_score: 0.5143; val_best_f1_score: 0.6729; train_kl_reg_loss: 16379.5841; train_edge_recon_loss: 357265.3958; train_gene_expr_recon_loss: 762908.5972; train_masked_gp_l1_reg_loss: 4370.6475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144327.1719; train_chrom_access_recon_loss: 458352.7014; train_global_loss: 1743604.0833; train_optim_loss: 1743604.0833; val_kl_reg_loss: 17301.3672; val_edge_recon_loss: 406518.0000; val_gene_expr_recon_loss: 736317.2500; val_masked_gp_l1_reg_loss: 4402.1260; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139411.1562; val_chrom_access_recon_loss: 447615.2500; val_global_loss: 1751565.1250; val_optim_loss: 1751565.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8725; val_auprc_score: 0.8856; val_best_acc_score: 0.5178; val_best_f1_score: 0.6740; train_kl_reg_loss: 17905.5317; train_edge_recon_loss: 358119.8472; train_gene_expr_recon_loss: 739794.8264; train_masked_gp_l1_reg_loss: 4404.0915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135308.6528; train_chrom_access_recon_loss: 453078.0833; train_global_loss: 1708611.0556; train_optim_loss: 1708611.0556; val_kl_reg_loss: 16947.4414; val_edge_recon_loss: 406461.3750; val_gene_expr_recon_loss: 718059.2500; val_masked_gp_l1_reg_loss: 4403.3091; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130141.2656; val_chrom_access_recon_loss: 443879.4062; val_global_loss: 1719891.8750; val_optim_loss: 1719891.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8726; val_auprc_score: 0.8831; val_best_acc_score: 0.5234; val_best_f1_score: 0.6764; train_kl_reg_loss: 18645.8939; train_edge_recon_loss: 358276.6806; train_gene_expr_recon_loss: 719303.0000; train_masked_gp_l1_reg_loss: 4409.4998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126012.5095; train_chrom_access_recon_loss: 448440.9167; train_global_loss: 1675088.5000; train_optim_loss: 1675088.5000; val_kl_reg_loss: 17791.0195; val_edge_recon_loss: 406381.1562; val_gene_expr_recon_loss: 703006.3750; val_masked_gp_l1_reg_loss: 4400.9370; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120870.5078; val_chrom_access_recon_loss: 441365.2500; val_global_loss: 1693815.1250; val_optim_loss: 1693815.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8708; val_auprc_score: 0.8793; val_best_acc_score: 0.5404; val_best_f1_score: 0.6824; train_kl_reg_loss: 18719.5067; train_edge_recon_loss: 358092.7569; train_gene_expr_recon_loss: 707835.9028; train_masked_gp_l1_reg_loss: 4396.7988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116823.0069; train_chrom_access_recon_loss: 446722.5243; train_global_loss: 1652590.4722; train_optim_loss: 1652590.4722; val_kl_reg_loss: 17857.5996; val_edge_recon_loss: 406186.1875; val_gene_expr_recon_loss: 692042.3750; val_masked_gp_l1_reg_loss: 4389.1060; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111825.7109; val_chrom_access_recon_loss: 439530.9062; val_global_loss: 1671831.8750; val_optim_loss: 1671831.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8682; val_auprc_score: 0.8730; val_best_acc_score: 0.5899; val_best_f1_score: 0.7037; train_kl_reg_loss: 18824.4844; train_edge_recon_loss: 357755.8785; train_gene_expr_recon_loss: 696399.2986; train_masked_gp_l1_reg_loss: 4387.6926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107957.8967; train_chrom_access_recon_loss: 446003.6215; train_global_loss: 1631328.8750; train_optim_loss: 1631328.8750; val_kl_reg_loss: 16793.2422; val_edge_recon_loss: 405855.2812; val_gene_expr_recon_loss: 683536.9375; val_masked_gp_l1_reg_loss: 4380.3730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103213.0078; val_chrom_access_recon_loss: 437977.0938; val_global_loss: 1651756.0000; val_optim_loss: 1651756.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8685; val_auprc_score: 0.8699; val_best_acc_score: 0.6572; val_best_f1_score: 0.7358; train_kl_reg_loss: 18657.0614; train_edge_recon_loss: 357700.5000; train_gene_expr_recon_loss: 688602.8472; train_masked_gp_l1_reg_loss: 4387.8221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99598.1719; train_chrom_access_recon_loss: 445258.4826; train_global_loss: 1614204.8889; train_optim_loss: 1614204.8889; val_kl_reg_loss: 18571.1484; val_edge_recon_loss: 405315.2500; val_gene_expr_recon_loss: 675807.7500; val_masked_gp_l1_reg_loss: 4388.6294; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95187.3594; val_chrom_access_recon_loss: 436628.9062; val_global_loss: 1635899.0000; val_optim_loss: 1635899.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8711; val_auprc_score: 0.8670; val_best_acc_score: 0.7463; val_best_f1_score: 0.7844; train_kl_reg_loss: 18812.0560; train_edge_recon_loss: 357384.0729; train_gene_expr_recon_loss: 675649.4931; train_masked_gp_l1_reg_loss: 4398.6930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91849.8116; train_chrom_access_recon_loss: 442706.0521; train_global_loss: 1590800.1944; train_optim_loss: 1590800.1944; val_kl_reg_loss: 18057.9727; val_edge_recon_loss: 404406.8438; val_gene_expr_recon_loss: 670674.1875; val_masked_gp_l1_reg_loss: 4401.0864; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87802.0156; val_chrom_access_recon_loss: 435373.0938; val_global_loss: 1620715.2500; val_optim_loss: 1620715.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8704; val_auprc_score: 0.8630; val_best_acc_score: 0.7895; val_best_f1_score: 0.8008; train_kl_reg_loss: 18772.2257; train_edge_recon_loss: 357038.0139; train_gene_expr_recon_loss: 681147.6736; train_masked_gp_l1_reg_loss: 4406.0047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84783.9601; train_chrom_access_recon_loss: 441832.2014; train_global_loss: 1587980.0139; train_optim_loss: 1587980.0139; val_kl_reg_loss: 16512.1152; val_edge_recon_loss: 402807.9375; val_gene_expr_recon_loss: 668055.1250; val_masked_gp_l1_reg_loss: 4403.2666; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81142.2188; val_chrom_access_recon_loss: 434300.0625; val_global_loss: 1607220.7500; val_optim_loss: 1607220.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8700; val_auprc_score: 0.8590; val_best_acc_score: 0.7883; val_best_f1_score: 0.7795; train_kl_reg_loss: 18649.4093; train_edge_recon_loss: 356735.7674; train_gene_expr_recon_loss: 673214.8958; train_masked_gp_l1_reg_loss: 4413.5120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78457.1345; train_chrom_access_recon_loss: 440133.3299; train_global_loss: 1571604.0139; train_optim_loss: 1571604.0139; val_kl_reg_loss: 16681.1230; val_edge_recon_loss: 400335.5000; val_gene_expr_recon_loss: 664293.7500; val_masked_gp_l1_reg_loss: 4416.0879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75201.9844; val_chrom_access_recon_loss: 433212.7812; val_global_loss: 1594141.2500; val_optim_loss: 1594141.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8836; val_auprc_score: 0.8743; val_best_acc_score: 0.7676; val_best_f1_score: 0.7959; train_kl_reg_loss: 18520.1263; train_edge_recon_loss: 355746.0694; train_gene_expr_recon_loss: 677669.6250; train_masked_gp_l1_reg_loss: 4426.0036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72791.9757; train_chrom_access_recon_loss: 441821.6736; train_global_loss: 1570975.4722; train_optim_loss: 1570975.4722; val_kl_reg_loss: 16553.3516; val_edge_recon_loss: 396153.7500; val_gene_expr_recon_loss: 660881.8750; val_masked_gp_l1_reg_loss: 4431.1587; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69879.4453; val_chrom_access_recon_loss: 432375.3750; val_global_loss: 1580275.0000; val_optim_loss: 1580275.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9028; val_auprc_score: 0.8909; val_best_acc_score: 0.8265; val_best_f1_score: 0.8341; train_kl_reg_loss: 17915.3563; train_edge_recon_loss: 353892.1806; train_gene_expr_recon_loss: 669469.1667; train_masked_gp_l1_reg_loss: 4450.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67723.2092; train_chrom_access_recon_loss: 439886.9583; train_global_loss: 1553337.1667; train_optim_loss: 1553337.1667; val_kl_reg_loss: 16749.9062; val_edge_recon_loss: 385475.1562; val_gene_expr_recon_loss: 658290.6250; val_masked_gp_l1_reg_loss: 4459.5239; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65096.1797; val_chrom_access_recon_loss: 431549.1250; val_global_loss: 1561620.5000; val_optim_loss: 1561620.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9088; val_auprc_score: 0.8954; val_best_acc_score: 0.8316; val_best_f1_score: 0.8376; train_kl_reg_loss: 17057.8566; train_edge_recon_loss: 348852.3854; train_gene_expr_recon_loss: 668701.4653; train_masked_gp_l1_reg_loss: 4474.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63145.0586; train_chrom_access_recon_loss: 437478.6944; train_global_loss: 1539710.0972; train_optim_loss: 1539710.0972; val_kl_reg_loss: 15828.7031; val_edge_recon_loss: 360400.4375; val_gene_expr_recon_loss: 658781.6250; val_masked_gp_l1_reg_loss: 4487.7725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60781.4688; val_chrom_access_recon_loss: 431283.0938; val_global_loss: 1531563.1250; val_optim_loss: 1531563.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9043; val_auprc_score: 0.8907; val_best_acc_score: 0.8195; val_best_f1_score: 0.8297; train_kl_reg_loss: 17678.0336; train_edge_recon_loss: 333388.0382; train_gene_expr_recon_loss: 667382.0694; train_masked_gp_l1_reg_loss: 4512.4336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59035.7274; train_chrom_access_recon_loss: 439564.3160; train_global_loss: 1521560.6528; train_optim_loss: 1521560.6528; val_kl_reg_loss: 20079.4609; val_edge_recon_loss: 325011.5938; val_gene_expr_recon_loss: 661102.6250; val_masked_gp_l1_reg_loss: 4540.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56912.6172; val_chrom_access_recon_loss: 431427.4375; val_global_loss: 1499074.2500; val_optim_loss: 1499074.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9059; val_auprc_score: 0.8924; val_best_acc_score: 0.8231; val_best_f1_score: 0.8348; train_kl_reg_loss: 24829.4382; train_edge_recon_loss: 313326.0208; train_gene_expr_recon_loss: 667894.7083; train_masked_gp_l1_reg_loss: 4576.7229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55335.1558; train_chrom_access_recon_loss: 438625.9653; train_global_loss: 1504588.0139; train_optim_loss: 1504588.0139; val_kl_reg_loss: 26476.9766; val_edge_recon_loss: 308743.4375; val_gene_expr_recon_loss: 658202.7500; val_masked_gp_l1_reg_loss: 4612.2881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53413.5586; val_chrom_access_recon_loss: 430143.8438; val_global_loss: 1481592.8750; val_optim_loss: 1481592.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9071; val_auprc_score: 0.8856; val_best_acc_score: 0.8320; val_best_f1_score: 0.8437; train_kl_reg_loss: 26003.5200; train_edge_recon_loss: 307493.3438; train_gene_expr_recon_loss: 662221.3889; train_masked_gp_l1_reg_loss: 4643.3636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51986.3720; train_chrom_access_recon_loss: 437488.8160; train_global_loss: 1489836.8056; train_optim_loss: 1489836.8056; val_kl_reg_loss: 23872.6406; val_edge_recon_loss: 306190.0938; val_gene_expr_recon_loss: 656548.7500; val_masked_gp_l1_reg_loss: 4674.4346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50236.4023; val_chrom_access_recon_loss: 429394.5312; val_global_loss: 1470916.8750; val_optim_loss: 1470916.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9104; val_auprc_score: 0.8892; val_best_acc_score: 0.8363; val_best_f1_score: 0.8476; train_kl_reg_loss: 25277.6339; train_edge_recon_loss: 303413.3542; train_gene_expr_recon_loss: 662391.3264; train_masked_gp_l1_reg_loss: 4706.0961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48925.2192; train_chrom_access_recon_loss: 436332.2639; train_global_loss: 1481045.8889; train_optim_loss: 1481045.8889; val_kl_reg_loss: 25267.4570; val_edge_recon_loss: 302584.4375; val_gene_expr_recon_loss: 654827.8750; val_masked_gp_l1_reg_loss: 4735.8604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47320.9180; val_chrom_access_recon_loss: 428740.6250; val_global_loss: 1463477.2500; val_optim_loss: 1463477.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9152; val_auprc_score: 0.8936; val_best_acc_score: 0.8442; val_best_f1_score: 0.8567; train_kl_reg_loss: 25979.3880; train_edge_recon_loss: 300654.2674; train_gene_expr_recon_loss: 666227.0278; train_masked_gp_l1_reg_loss: 4763.9168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46120.2934; train_chrom_access_recon_loss: 437328.7569; train_global_loss: 1481073.6667; train_optim_loss: 1481073.6667; val_kl_reg_loss: 24792.8301; val_edge_recon_loss: 297940.5000; val_gene_expr_recon_loss: 654136.6250; val_masked_gp_l1_reg_loss: 4789.5483; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44654.0234; val_chrom_access_recon_loss: 427883.5938; val_global_loss: 1454197.1250; val_optim_loss: 1454197.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9260; val_auprc_score: 0.9031; val_best_acc_score: 0.8564; val_best_f1_score: 0.8648; train_kl_reg_loss: 26093.9008; train_edge_recon_loss: 297646.8889; train_gene_expr_recon_loss: 660782.8056; train_masked_gp_l1_reg_loss: 4810.6840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43569.0373; train_chrom_access_recon_loss: 435112.5069; train_global_loss: 1468015.8194; train_optim_loss: 1468015.8194; val_kl_reg_loss: 25509.1992; val_edge_recon_loss: 297884.2812; val_gene_expr_recon_loss: 652206.3125; val_masked_gp_l1_reg_loss: 4827.9380; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42215.8789; val_chrom_access_recon_loss: 427100.9688; val_global_loss: 1449744.5000; val_optim_loss: 1449744.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9320; val_auprc_score: 0.9143; val_best_acc_score: 0.8643; val_best_f1_score: 0.8712; train_kl_reg_loss: 26328.9907; train_edge_recon_loss: 295342.2535; train_gene_expr_recon_loss: 657848.5069; train_masked_gp_l1_reg_loss: 4845.7850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41207.1723; train_chrom_access_recon_loss: 433487.5243; train_global_loss: 1459060.2083; train_optim_loss: 1459060.2083; val_kl_reg_loss: 25883.4805; val_edge_recon_loss: 296682.5312; val_gene_expr_recon_loss: 650107.1250; val_masked_gp_l1_reg_loss: 4864.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39960.5312; val_chrom_access_recon_loss: 426552.7500; val_global_loss: 1444051.2500; val_optim_loss: 1444051.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9379; val_auprc_score: 0.9178; val_best_acc_score: 0.8760; val_best_f1_score: 0.8808; train_kl_reg_loss: 26155.6243; train_edge_recon_loss: 296096.3125; train_gene_expr_recon_loss: 654903.2292; train_masked_gp_l1_reg_loss: 4886.5261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39026.6862; train_chrom_access_recon_loss: 433609.6632; train_global_loss: 1454678.0417; train_optim_loss: 1454678.0417; val_kl_reg_loss: 25320.4922; val_edge_recon_loss: 295897.2500; val_gene_expr_recon_loss: 648461.1250; val_masked_gp_l1_reg_loss: 4905.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37874.0703; val_chrom_access_recon_loss: 425723.8125; val_global_loss: 1438182.0000; val_optim_loss: 1438182.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9397; val_auprc_score: 0.9230; val_best_acc_score: 0.8751; val_best_f1_score: 0.8806; train_kl_reg_loss: 26248.9323; train_edge_recon_loss: 294302.5208; train_gene_expr_recon_loss: 656394.5069; train_masked_gp_l1_reg_loss: 4926.8802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37005.2435; train_chrom_access_recon_loss: 433263.5799; train_global_loss: 1452141.6389; train_optim_loss: 1452141.6389; val_kl_reg_loss: 25259.1895; val_edge_recon_loss: 295684.3438; val_gene_expr_recon_loss: 648409.7500; val_masked_gp_l1_reg_loss: 4945.2979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35939.1094; val_chrom_access_recon_loss: 425038.7188; val_global_loss: 1435276.3750; val_optim_loss: 1435276.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9449; val_auprc_score: 0.9298; val_best_acc_score: 0.8835; val_best_f1_score: 0.8869; train_kl_reg_loss: 26164.2932; train_edge_recon_loss: 293835.3403; train_gene_expr_recon_loss: 651558.4861; train_masked_gp_l1_reg_loss: 4966.5127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35145.8121; train_chrom_access_recon_loss: 431075.5694; train_global_loss: 1442745.9861; train_optim_loss: 1442745.9861; val_kl_reg_loss: 25897.4863; val_edge_recon_loss: 294027.5938; val_gene_expr_recon_loss: 646764.5000; val_masked_gp_l1_reg_loss: 4984.1265; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34162.6367; val_chrom_access_recon_loss: 424418.6875; val_global_loss: 1430255.0000; val_optim_loss: 1430255.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9445; val_auprc_score: 0.9295; val_best_acc_score: 0.8831; val_best_f1_score: 0.8878; train_kl_reg_loss: 24184.6237; train_edge_recon_loss: 293238.8681; train_gene_expr_recon_loss: 954224.3889; train_masked_gp_l1_reg_loss: 5064.5322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33248.7973; train_chrom_access_recon_loss: 455915.8507; train_global_loss: 1765877.0278; train_optim_loss: 1765877.0278; val_kl_reg_loss: 17064.6680; val_edge_recon_loss: 289795.8438; val_gene_expr_recon_loss: 942659.8125; val_masked_gp_l1_reg_loss: 5187.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32012.2949; val_chrom_access_recon_loss: 446903.7500; val_global_loss: 1733623.7500; val_optim_loss: 1733623.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9440; val_auprc_score: 0.9302; val_best_acc_score: 0.8826; val_best_f1_score: 0.8869; train_kl_reg_loss: 22776.7665; train_edge_recon_loss: 289550.4965; train_gene_expr_recon_loss: 957190.5972; train_masked_gp_l1_reg_loss: 5292.9312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30986.2934; train_chrom_access_recon_loss: 454389.8576; train_global_loss: 1760186.9306; train_optim_loss: 1760186.9306; val_kl_reg_loss: 17640.0215; val_edge_recon_loss: 290467.7188; val_gene_expr_recon_loss: 938547.3750; val_masked_gp_l1_reg_loss: 5415.0659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29718.6094; val_chrom_access_recon_loss: 446259.8125; val_global_loss: 1728048.7500; val_optim_loss: 1728048.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9512; val_auprc_score: 0.9375; val_best_acc_score: 0.8914; val_best_f1_score: 0.8961; train_kl_reg_loss: 21857.8789; train_edge_recon_loss: 289049.9097; train_gene_expr_recon_loss: 944347.1319; train_masked_gp_l1_reg_loss: 5504.3564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28756.6456; train_chrom_access_recon_loss: 455070.1562; train_global_loss: 1744586.1111; train_optim_loss: 1744586.1111; val_kl_reg_loss: 18211.8945; val_edge_recon_loss: 287560.5625; val_gene_expr_recon_loss: 933343.9375; val_masked_gp_l1_reg_loss: 5604.4556; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27590.5098; val_chrom_access_recon_loss: 445538.3438; val_global_loss: 1717849.7500; val_optim_loss: 1717849.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9522; val_auprc_score: 0.9374; val_best_acc_score: 0.8915; val_best_f1_score: 0.8958; train_kl_reg_loss: 21501.1487; train_edge_recon_loss: 287487.3472; train_gene_expr_recon_loss: 938251.5417; train_masked_gp_l1_reg_loss: 5677.0700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26722.6808; train_chrom_access_recon_loss: 453318.7222; train_global_loss: 1732958.5000; train_optim_loss: 1732958.5000; val_kl_reg_loss: 19258.2422; val_edge_recon_loss: 286607.8125; val_gene_expr_recon_loss: 929093.3750; val_masked_gp_l1_reg_loss: 5759.4751; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25678.0059; val_chrom_access_recon_loss: 444753.2188; val_global_loss: 1711150.2500; val_optim_loss: 1711150.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9533; val_auprc_score: 0.9389; val_best_acc_score: 0.8923; val_best_f1_score: 0.8968; train_kl_reg_loss: 21585.5371; train_edge_recon_loss: 286918.4062; train_gene_expr_recon_loss: 939691.7361; train_masked_gp_l1_reg_loss: 5752.4953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25507.6697; train_chrom_access_recon_loss: 452349.5833; train_global_loss: 1731805.4583; train_optim_loss: 1731805.4583; val_kl_reg_loss: 19484.4102; val_edge_recon_loss: 289048.6250; val_gene_expr_recon_loss: 927640.3750; val_masked_gp_l1_reg_loss: 5745.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25320.9648; val_chrom_access_recon_loss: 444629.0938; val_global_loss: 1711868.7500; val_optim_loss: 1711868.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9537; val_auprc_score: 0.9383; val_best_acc_score: 0.8946; val_best_f1_score: 0.8991; train_kl_reg_loss: 21573.0321; train_edge_recon_loss: 287326.9479; train_gene_expr_recon_loss: 938836.3403; train_masked_gp_l1_reg_loss: 5745.1298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25211.8757; train_chrom_access_recon_loss: 452281.8403; train_global_loss: 1730975.2222; train_optim_loss: 1730975.2222; val_kl_reg_loss: 19347.7383; val_edge_recon_loss: 287120.2812; val_gene_expr_recon_loss: 927584.8125; val_masked_gp_l1_reg_loss: 5744.2573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25069.4238; val_chrom_access_recon_loss: 444553.1250; val_global_loss: 1709419.6250; val_optim_loss: 1709419.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9539; val_auprc_score: 0.9379; val_best_acc_score: 0.8979; val_best_f1_score: 0.9004; train_kl_reg_loss: 21474.0981; train_edge_recon_loss: 286653.4410; train_gene_expr_recon_loss: 941647.7569; train_masked_gp_l1_reg_loss: 5745.1642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24967.5230; train_chrom_access_recon_loss: 452765.1875; train_global_loss: 1733253.1667; train_optim_loss: 1733253.1667; val_kl_reg_loss: 19354.2148; val_edge_recon_loss: 288386.0625; val_gene_expr_recon_loss: 927471.0000; val_masked_gp_l1_reg_loss: 5746.8530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24843.0664; val_chrom_access_recon_loss: 444518.1250; val_global_loss: 1710319.3750; val_optim_loss: 1710319.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9536; val_auprc_score: 0.9399; val_best_acc_score: 0.8946; val_best_f1_score: 0.8976; train_kl_reg_loss: 21515.8934; train_edge_recon_loss: 286321.4340; train_gene_expr_recon_loss: 935327.0625; train_masked_gp_l1_reg_loss: 5749.2591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24748.7860; train_chrom_access_recon_loss: 452347.2118; train_global_loss: 1726009.6667; train_optim_loss: 1726009.6667; val_kl_reg_loss: 19628.7539; val_edge_recon_loss: 287735.0000; val_gene_expr_recon_loss: 926890.1875; val_masked_gp_l1_reg_loss: 5752.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24635.9941; val_chrom_access_recon_loss: 444430.7500; val_global_loss: 1709073.3750; val_optim_loss: 1709073.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9400
val AUPRC score: 0.9225
val best accuracy score: 0.8747
val best F1 score: 0.8802
val target rna MSE score: 3.7756
val source rna MSE score: 3.0558
val target atac MSE score: 0.1320
val source atac MSE score: 0.0194
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
