[True]
Run timestamp: 26072023_024314_84.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_84']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9135; val_auprc_score: 0.9249; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 9203.5735; train_edge_recon_loss: 3476460.5000; train_gene_expr_recon_loss: 3218189.3056; train_masked_gp_l1_reg_loss: 1873.8998; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10978597.0000; train_global_loss: 17684324.2222; train_optim_loss: 17684324.2222; val_kl_reg_loss: 14462.5039; val_edge_recon_loss: 4065299.0000; val_gene_expr_recon_loss: 3088727.0000; val_masked_gp_l1_reg_loss: 1905.5979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10678284.0000; val_global_loss: 17848678.0000; val_optim_loss: 17848678.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8921; val_auprc_score: 0.9005; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 25833.6723; train_edge_recon_loss: 3495077.2222; train_gene_expr_recon_loss: 2964033.5833; train_masked_gp_l1_reg_loss: 1996.5789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10642478.2222; train_global_loss: 17129418.8889; train_optim_loss: 17129418.8889; val_kl_reg_loss: 39130.5898; val_edge_recon_loss: 4065193.7500; val_gene_expr_recon_loss: 2832203.7500; val_masked_gp_l1_reg_loss: 2138.9866; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10496128.0000; val_global_loss: 17434796.0000; val_optim_loss: 17434796.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8790; val_auprc_score: 0.8889; val_best_acc_score: 0.5071; val_best_f1_score: 0.6697; train_kl_reg_loss: 52230.5234; train_edge_recon_loss: 3517377.1667; train_gene_expr_recon_loss: 2720342.7500; train_masked_gp_l1_reg_loss: 2275.5111; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10471044.2222; train_global_loss: 16763270.0000; train_optim_loss: 16763270.0000; val_kl_reg_loss: 52664.0938; val_edge_recon_loss: 4065168.0000; val_gene_expr_recon_loss: 2618132.0000; val_masked_gp_l1_reg_loss: 2437.8052; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10290809.0000; val_global_loss: 17029212.0000; val_optim_loss: 17029212.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8853; val_auprc_score: 0.8890; val_best_acc_score: 0.5084; val_best_f1_score: 0.6700; train_kl_reg_loss: 70690.2452; train_edge_recon_loss: 3531223.1389; train_gene_expr_recon_loss: 2511364.8611; train_masked_gp_l1_reg_loss: 2534.4063; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10201748.7778; train_global_loss: 16317561.2222; train_optim_loss: 16317561.2222; val_kl_reg_loss: 78196.7266; val_edge_recon_loss: 4065163.7500; val_gene_expr_recon_loss: 2439512.0000; val_masked_gp_l1_reg_loss: 2629.2944; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10105392.0000; val_global_loss: 16690894.0000; val_optim_loss: 16690894.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8899; val_auprc_score: 0.8887; val_best_acc_score: 0.5084; val_best_f1_score: 0.6700; train_kl_reg_loss: 90729.9627; train_edge_recon_loss: 3537856.2222; train_gene_expr_recon_loss: 2382442.1111; train_masked_gp_l1_reg_loss: 2673.0136; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10081614.8889; train_global_loss: 16095316.1111; train_optim_loss: 16095316.1111; val_kl_reg_loss: 83374.6250; val_edge_recon_loss: 4064894.5000; val_gene_expr_recon_loss: 2350420.2500; val_masked_gp_l1_reg_loss: 2712.1497; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9983492.0000; val_global_loss: 16484893.0000; val_optim_loss: 16484893.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8946; val_auprc_score: 0.8916; val_best_acc_score: 0.5171; val_best_f1_score: 0.6739; train_kl_reg_loss: 104393.1233; train_edge_recon_loss: 3539729.0278; train_gene_expr_recon_loss: 2304055.0556; train_masked_gp_l1_reg_loss: 2725.5823; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9940155.2222; train_global_loss: 15891058.2222; train_optim_loss: 15891058.2222; val_kl_reg_loss: 84874.6953; val_edge_recon_loss: 4064117.0000; val_gene_expr_recon_loss: 2282496.7500; val_masked_gp_l1_reg_loss: 2732.8308; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9898249.0000; val_global_loss: 16332470.0000; val_optim_loss: 16332470.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9009; val_auprc_score: 0.8979; val_best_acc_score: 0.5327; val_best_f1_score: 0.6807; train_kl_reg_loss: 108100.4271; train_edge_recon_loss: 3544507.1944; train_gene_expr_recon_loss: 2239803.0000; train_masked_gp_l1_reg_loss: 2730.1888; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9867803.0000; train_global_loss: 15762943.7778; train_optim_loss: 15762943.7778; val_kl_reg_loss: 87859.8438; val_edge_recon_loss: 4062921.5000; val_gene_expr_recon_loss: 2239131.5000; val_masked_gp_l1_reg_loss: 2725.3384; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9846898.0000; val_global_loss: 16239536.0000; val_optim_loss: 16239536.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9014; val_auprc_score: 0.8986; val_best_acc_score: 0.5604; val_best_f1_score: 0.6932; train_kl_reg_loss: 112316.2682; train_edge_recon_loss: 3542360.3333; train_gene_expr_recon_loss: 2209380.9722; train_masked_gp_l1_reg_loss: 2719.2048; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9815948.6667; train_global_loss: 15682725.4444; train_optim_loss: 15682725.4444; val_kl_reg_loss: 81349.5234; val_edge_recon_loss: 4061214.2500; val_gene_expr_recon_loss: 2210176.0000; val_masked_gp_l1_reg_loss: 2708.6680; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810708.0000; val_global_loss: 16166156.0000; val_optim_loss: 16166156.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8987; val_auprc_score: 0.8944; val_best_acc_score: 0.5957; val_best_f1_score: 0.7092; train_kl_reg_loss: 111532.5538; train_edge_recon_loss: 3539335.1944; train_gene_expr_recon_loss: 2192387.3333; train_masked_gp_l1_reg_loss: 2704.2425; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9832118.3333; train_global_loss: 15678077.3333; train_optim_loss: 15678077.3333; val_kl_reg_loss: 89182.3828; val_edge_recon_loss: 4059176.2500; val_gene_expr_recon_loss: 2187587.7500; val_masked_gp_l1_reg_loss: 2700.8540; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9791564.0000; val_global_loss: 16130212.0000; val_optim_loss: 16130212.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8992; val_auprc_score: 0.8933; val_best_acc_score: 0.6428; val_best_f1_score: 0.7328; train_kl_reg_loss: 108633.8646; train_edge_recon_loss: 3539416.2222; train_gene_expr_recon_loss: 2161535.6667; train_masked_gp_l1_reg_loss: 2697.5248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9781796.2222; train_global_loss: 15594079.6667; train_optim_loss: 15594079.6667; val_kl_reg_loss: 95531.2188; val_edge_recon_loss: 4056640.0000; val_gene_expr_recon_loss: 2168276.2500; val_masked_gp_l1_reg_loss: 2692.2222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9763854.0000; val_global_loss: 16086994.0000; val_optim_loss: 16086994.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9044; val_auprc_score: 0.8928; val_best_acc_score: 0.7219; val_best_f1_score: 0.7770; train_kl_reg_loss: 108082.7118; train_edge_recon_loss: 3534728.2500; train_gene_expr_recon_loss: 2144557.5833; train_masked_gp_l1_reg_loss: 2691.0443; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9738614.7778; train_global_loss: 15528674.2222; train_optim_loss: 15528674.2222; val_kl_reg_loss: 82743.9766; val_edge_recon_loss: 4051213.2500; val_gene_expr_recon_loss: 2162709.5000; val_masked_gp_l1_reg_loss: 2692.4045; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9762111.0000; val_global_loss: 16061470.0000; val_optim_loss: 16061470.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9111; val_auprc_score: 0.8989; val_best_acc_score: 0.7711; val_best_f1_score: 0.8074; train_kl_reg_loss: 104129.2674; train_edge_recon_loss: 3531783.6389; train_gene_expr_recon_loss: 2158256.4444; train_masked_gp_l1_reg_loss: 2696.7812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9790998.5556; train_global_loss: 15587864.8889; train_optim_loss: 15587864.8889; val_kl_reg_loss: 88422.1562; val_edge_recon_loss: 4045777.5000; val_gene_expr_recon_loss: 2149451.2500; val_masked_gp_l1_reg_loss: 2699.8223; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9732680.0000; val_global_loss: 16019031.0000; val_optim_loss: 16019031.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9088; val_auprc_score: 0.8996; val_best_acc_score: 0.8064; val_best_f1_score: 0.8290; train_kl_reg_loss: 100830.1155; train_edge_recon_loss: 3527912.2500; train_gene_expr_recon_loss: 2133459.7083; train_masked_gp_l1_reg_loss: 2705.3393; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9761315.5556; train_global_loss: 15526222.8889; train_optim_loss: 15526222.8889; val_kl_reg_loss: 83899.5156; val_edge_recon_loss: 4038446.2500; val_gene_expr_recon_loss: 2140140.7500; val_masked_gp_l1_reg_loss: 2710.9546; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9706609.0000; val_global_loss: 15971806.0000; val_optim_loss: 15971806.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9100; val_auprc_score: 0.8956; val_best_acc_score: 0.8364; val_best_f1_score: 0.8448; train_kl_reg_loss: 98869.7960; train_edge_recon_loss: 3524832.4444; train_gene_expr_recon_loss: 2121097.2500; train_masked_gp_l1_reg_loss: 2715.5284; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9736500.4444; train_global_loss: 15484015.5556; train_optim_loss: 15484015.5556; val_kl_reg_loss: 85469.0859; val_edge_recon_loss: 4020427.7500; val_gene_expr_recon_loss: 2132721.7500; val_masked_gp_l1_reg_loss: 2719.6470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9699415.0000; val_global_loss: 15940753.0000; val_optim_loss: 15940753.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9140; val_auprc_score: 0.8986; val_best_acc_score: 0.8336; val_best_f1_score: 0.8268; train_kl_reg_loss: 95364.8950; train_edge_recon_loss: 3518496.5833; train_gene_expr_recon_loss: 2126499.2222; train_masked_gp_l1_reg_loss: 2724.9530; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9723107.6667; train_global_loss: 15466193.3333; train_optim_loss: 15466193.3333; val_kl_reg_loss: 83213.8750; val_edge_recon_loss: 3983270.7500; val_gene_expr_recon_loss: 2132041.7500; val_masked_gp_l1_reg_loss: 2731.0298; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9706447.0000; val_global_loss: 15907704.0000; val_optim_loss: 15907704.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9152; val_auprc_score: 0.8960; val_best_acc_score: 0.8061; val_best_f1_score: 0.8318; train_kl_reg_loss: 90092.8446; train_edge_recon_loss: 3507639.6944; train_gene_expr_recon_loss: 2112421.7639; train_masked_gp_l1_reg_loss: 2737.0744; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9698287.1111; train_global_loss: 15411178.4444; train_optim_loss: 15411178.4444; val_kl_reg_loss: 81817.9062; val_edge_recon_loss: 3910629.5000; val_gene_expr_recon_loss: 2124895.2500; val_masked_gp_l1_reg_loss: 2741.9204; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9684699.0000; val_global_loss: 15804784.0000; val_optim_loss: 15804784.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9234; val_auprc_score: 0.9071; val_best_acc_score: 0.8464; val_best_f1_score: 0.8526; train_kl_reg_loss: 82958.6875; train_edge_recon_loss: 3478489.0000; train_gene_expr_recon_loss: 2115388.3056; train_masked_gp_l1_reg_loss: 2748.0553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9749959.5556; train_global_loss: 15429543.7778; train_optim_loss: 15429543.7778; val_kl_reg_loss: 63661.0000; val_edge_recon_loss: 3731446.7500; val_gene_expr_recon_loss: 2129316.0000; val_masked_gp_l1_reg_loss: 2754.5186; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9676772.0000; val_global_loss: 15603950.0000; val_optim_loss: 15603950.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9149; val_auprc_score: 0.8990; val_best_acc_score: 0.8340; val_best_f1_score: 0.8441; train_kl_reg_loss: 66582.4375; train_edge_recon_loss: 3394934.9167; train_gene_expr_recon_loss: 2121332.0278; train_masked_gp_l1_reg_loss: 2762.8462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759774.4444; train_global_loss: 15345386.6667; train_optim_loss: 15345386.6667; val_kl_reg_loss: 57204.0000; val_edge_recon_loss: 3377613.2500; val_gene_expr_recon_loss: 2139320.5000; val_masked_gp_l1_reg_loss: 2773.5625; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9687798.0000; val_global_loss: 15264710.0000; val_optim_loss: 15264710.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8972; val_auprc_score: 0.8804; val_best_acc_score: 0.8137; val_best_f1_score: 0.8229; train_kl_reg_loss: 67489.6467; train_edge_recon_loss: 3188923.0833; train_gene_expr_recon_loss: 2126847.1806; train_masked_gp_l1_reg_loss: 2790.3193; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9666943.1111; train_global_loss: 15052993.1111; train_optim_loss: 15052993.1111; val_kl_reg_loss: 83518.5156; val_edge_recon_loss: 3077856.5000; val_gene_expr_recon_loss: 2148376.7500; val_masked_gp_l1_reg_loss: 2812.9238; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9700241.0000; val_global_loss: 15012806.0000; val_optim_loss: 15012806.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8873; val_auprc_score: 0.8648; val_best_acc_score: 0.7994; val_best_f1_score: 0.8204; train_kl_reg_loss: 110488.7769; train_edge_recon_loss: 2996188.6667; train_gene_expr_recon_loss: 2134264.4167; train_masked_gp_l1_reg_loss: 2832.9752; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9716906.4444; train_global_loss: 14960681.3333; train_optim_loss: 14960681.3333; val_kl_reg_loss: 130165.3984; val_edge_recon_loss: 2954844.7500; val_gene_expr_recon_loss: 2135995.5000; val_masked_gp_l1_reg_loss: 2855.7068; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9678487.0000; val_global_loss: 14902348.0000; val_optim_loss: 14902348.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8891; val_auprc_score: 0.8692; val_best_acc_score: 0.8017; val_best_f1_score: 0.8233; train_kl_reg_loss: 138696.0156; train_edge_recon_loss: 2951923.6111; train_gene_expr_recon_loss: 2120297.6806; train_masked_gp_l1_reg_loss: 2870.3738; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694325.1111; train_global_loss: 14908112.7778; train_optim_loss: 14908112.7778; val_kl_reg_loss: 130947.1016; val_edge_recon_loss: 2929622.7500; val_gene_expr_recon_loss: 2124595.0000; val_masked_gp_l1_reg_loss: 2887.5598; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9659659.0000; val_global_loss: 14847712.0000; val_optim_loss: 14847712.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8930; val_auprc_score: 0.8725; val_best_acc_score: 0.8083; val_best_f1_score: 0.8294; train_kl_reg_loss: 127097.1207; train_edge_recon_loss: 2927943.0000; train_gene_expr_recon_loss: 2105296.4444; train_masked_gp_l1_reg_loss: 2904.2265; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647408.4444; train_global_loss: 14810649.1111; train_optim_loss: 14810649.1111; val_kl_reg_loss: 116153.0312; val_edge_recon_loss: 2924625.7500; val_gene_expr_recon_loss: 2120042.0000; val_masked_gp_l1_reg_loss: 2927.7144; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643334.0000; val_global_loss: 14807082.0000; val_optim_loss: 14807082.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8942; val_auprc_score: 0.8717; val_best_acc_score: 0.8145; val_best_f1_score: 0.8306; train_kl_reg_loss: 119165.9306; train_edge_recon_loss: 2926056.5000; train_gene_expr_recon_loss: 2097941.2917; train_masked_gp_l1_reg_loss: 2945.8078; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9649605.5556; train_global_loss: 14795714.8889; train_optim_loss: 14795714.8889; val_kl_reg_loss: 113746.8594; val_edge_recon_loss: 2913296.5000; val_gene_expr_recon_loss: 2116023.5000; val_masked_gp_l1_reg_loss: 2961.6753; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9638314.0000; val_global_loss: 14784342.0000; val_optim_loss: 14784342.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8956; val_auprc_score: 0.8733; val_best_acc_score: 0.8208; val_best_f1_score: 0.8345; train_kl_reg_loss: 115660.8264; train_edge_recon_loss: 2906446.2500; train_gene_expr_recon_loss: 2092024.5556; train_masked_gp_l1_reg_loss: 2971.2486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624150.8889; train_global_loss: 14741253.6667; train_optim_loss: 14741253.6667; val_kl_reg_loss: 110545.1562; val_edge_recon_loss: 2938555.7500; val_gene_expr_recon_loss: 2114754.7500; val_masked_gp_l1_reg_loss: 2980.7993; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9636184.0000; val_global_loss: 14803021.0000; val_optim_loss: 14803021.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9023; val_auprc_score: 0.8787; val_best_acc_score: 0.8310; val_best_f1_score: 0.8463; train_kl_reg_loss: 112697.4227; train_edge_recon_loss: 2893459.9167; train_gene_expr_recon_loss: 2080663.6250; train_masked_gp_l1_reg_loss: 2989.0017; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9588949.8889; train_global_loss: 14678759.7778; train_optim_loss: 14678759.7778; val_kl_reg_loss: 109771.8359; val_edge_recon_loss: 2900605.0000; val_gene_expr_recon_loss: 2114499.5000; val_masked_gp_l1_reg_loss: 2998.5828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624587.0000; val_global_loss: 14752462.0000; val_optim_loss: 14752462.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9109; val_auprc_score: 0.8880; val_best_acc_score: 0.8324; val_best_f1_score: 0.8448; train_kl_reg_loss: 137401.7682; train_edge_recon_loss: 3145244.6111; train_gene_expr_recon_loss: 2143166.0278; train_masked_gp_l1_reg_loss: 3020.8955; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9717363.4444; train_global_loss: 15146196.7778; train_optim_loss: 15146196.7778; val_kl_reg_loss: 37450.2109; val_edge_recon_loss: 3055162.5000; val_gene_expr_recon_loss: 2157040.2500; val_masked_gp_l1_reg_loss: 3055.5125; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9682822.0000; val_global_loss: 14935530.0000; val_optim_loss: 14935530.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9137; val_auprc_score: 0.8944; val_best_acc_score: 0.8319; val_best_f1_score: 0.8472; train_kl_reg_loss: 169505.2135; train_edge_recon_loss: 3015778.0833; train_gene_expr_recon_loss: 2127550.4861; train_masked_gp_l1_reg_loss: 3081.5911; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9629288.5556; train_global_loss: 14945203.8889; train_optim_loss: 14945203.8889; val_kl_reg_loss: 41555.3906; val_edge_recon_loss: 2953651.7500; val_gene_expr_recon_loss: 2158053.0000; val_masked_gp_l1_reg_loss: 3109.8057; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9675352.0000; val_global_loss: 14831722.0000; val_optim_loss: 14831722.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9114; val_auprc_score: 0.8871; val_best_acc_score: 0.8354; val_best_f1_score: 0.8478; train_kl_reg_loss: 155753.0365; train_edge_recon_loss: 2973549.2222; train_gene_expr_recon_loss: 2131137.4722; train_masked_gp_l1_reg_loss: 3126.9670; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697064.7778; train_global_loss: 14960631.4444; train_optim_loss: 14960631.4444; val_kl_reg_loss: 46142.1289; val_edge_recon_loss: 2932686.2500; val_gene_expr_recon_loss: 2144534.2500; val_masked_gp_l1_reg_loss: 3145.5049; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9654831.0000; val_global_loss: 14781340.0000; val_optim_loss: 14781340.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9114; val_auprc_score: 0.8926; val_best_acc_score: 0.8341; val_best_f1_score: 0.8472; train_kl_reg_loss: 133505.1892; train_edge_recon_loss: 2952046.7500; train_gene_expr_recon_loss: 2116656.2639; train_masked_gp_l1_reg_loss: 3157.0307; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9653103.5556; train_global_loss: 14858468.7778; train_optim_loss: 14858468.7778; val_kl_reg_loss: 51003.4297; val_edge_recon_loss: 2916637.0000; val_gene_expr_recon_loss: 2136687.5000; val_masked_gp_l1_reg_loss: 3168.3003; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9649102.0000; val_global_loss: 14756598.0000; val_optim_loss: 14756598.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9055; val_auprc_score: 0.8817; val_best_acc_score: 0.8246; val_best_f1_score: 0.8409; train_kl_reg_loss: 122133.4679; train_edge_recon_loss: 2931452.5556; train_gene_expr_recon_loss: 2107716.1250; train_masked_gp_l1_reg_loss: 3168.6503; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628100.3333; train_global_loss: 14792571.1111; train_optim_loss: 14792571.1111; val_kl_reg_loss: 52489.8750; val_edge_recon_loss: 2952828.0000; val_gene_expr_recon_loss: 2132452.2500; val_masked_gp_l1_reg_loss: 3168.7896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9634349.0000; val_global_loss: 14775288.0000; val_optim_loss: 14775288.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9114; val_auprc_score: 0.8934; val_best_acc_score: 0.8323; val_best_f1_score: 0.8462; train_kl_reg_loss: 122358.4609; train_edge_recon_loss: 2925185.1389; train_gene_expr_recon_loss: 2115982.6111; train_masked_gp_l1_reg_loss: 3168.6493; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9673258.6667; train_global_loss: 14839953.5556; train_optim_loss: 14839953.5556; val_kl_reg_loss: 52515.1523; val_edge_recon_loss: 2927119.2500; val_gene_expr_recon_loss: 2133388.2500; val_masked_gp_l1_reg_loss: 3168.3689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9642121.0000; val_global_loss: 14758312.0000; val_optim_loss: 14758312.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9064; val_auprc_score: 0.8858; val_best_acc_score: 0.8234; val_best_f1_score: 0.8389; train_kl_reg_loss: 120843.7170; train_edge_recon_loss: 2923182.1667; train_gene_expr_recon_loss: 2122917.8056; train_masked_gp_l1_reg_loss: 3168.1464; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9664388.0000; train_global_loss: 14834499.7778; train_optim_loss: 14834499.7778; val_kl_reg_loss: 53108.9492; val_edge_recon_loss: 2936948.0000; val_gene_expr_recon_loss: 2131095.2500; val_masked_gp_l1_reg_loss: 3167.9348; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9644956.0000; val_global_loss: 14769276.0000; val_optim_loss: 14769276.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9102; val_auprc_score: 0.8895; val_best_acc_score: 0.8297; val_best_f1_score: 0.8440; train_kl_reg_loss: 119807.9288; train_edge_recon_loss: 2917171.9167; train_gene_expr_recon_loss: 2106920.1528; train_masked_gp_l1_reg_loss: 3167.8748; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630508.3333; train_global_loss: 14777576.3333; train_optim_loss: 14777576.3333; val_kl_reg_loss: 53512.5391; val_edge_recon_loss: 2922878.7500; val_gene_expr_recon_loss: 2132474.5000; val_masked_gp_l1_reg_loss: 3167.8130; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9652669.0000; val_global_loss: 14764703.0000; val_optim_loss: 14764703.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 42 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9191
Val AUPRC score: 0.8977
Val best accuracy score: 0.8445
Val best F1 score: 0.8580
Val gene expr MSE score: 0.4539
Val chrom access MSE score: 0.0871
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
