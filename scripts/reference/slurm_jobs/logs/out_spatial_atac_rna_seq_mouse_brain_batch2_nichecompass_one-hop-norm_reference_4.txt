[True]
Run timestamp: 09102023_184234_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6464; val_auprc_score: 0.6326; val_best_acc_score: 0.5056; val_best_f1_score: 0.6688; train_kl_reg_loss: 43436.3334; train_edge_recon_loss: 3508675.0720; train_gene_expr_recon_loss: 14060084.7879; train_masked_gp_l1_reg_loss: 99159.6446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3076306.7292; train_chrom_access_recon_loss: 1003091.3352; train_global_loss: 21790753.9394; train_optim_loss: 21790753.9394; val_kl_reg_loss: 71397.3447; val_edge_recon_loss: 4065005.5625; val_gene_expr_recon_loss: 13183105.7500; val_masked_gp_l1_reg_loss: 85996.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1803504.0000; val_chrom_access_recon_loss: 950421.2031; val_global_loss: 20159430.0000; val_optim_loss: 20159430.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6648; val_auprc_score: 0.6517; val_best_acc_score: 0.5427; val_best_f1_score: 0.6818; train_kl_reg_loss: 85787.4743; train_edge_recon_loss: 3512007.2424; train_gene_expr_recon_loss: 12814252.8030; train_masked_gp_l1_reg_loss: 81062.4837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1023878.8172; train_chrom_access_recon_loss: 952194.2992; train_global_loss: 18469183.2727; train_optim_loss: 18469183.2727; val_kl_reg_loss: 88026.9551; val_edge_recon_loss: 4063000.3750; val_gene_expr_recon_loss: 12753393.0000; val_masked_gp_l1_reg_loss: 78818.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 513152.8125; val_chrom_access_recon_loss: 930704.2812; val_global_loss: 18427094.5000; val_optim_loss: 18427094.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7210; val_auprc_score: 0.6900; val_best_acc_score: 0.6566; val_best_f1_score: 0.6945; train_kl_reg_loss: 81493.4310; train_edge_recon_loss: 3508766.3258; train_gene_expr_recon_loss: 12663215.3485; train_masked_gp_l1_reg_loss: 77875.5592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 342492.2663; train_chrom_access_recon_loss: 940798.0085; train_global_loss: 17614640.9697; train_optim_loss: 17614640.9697; val_kl_reg_loss: 84694.1621; val_edge_recon_loss: 4042651.4062; val_gene_expr_recon_loss: 12678078.5000; val_masked_gp_l1_reg_loss: 77616.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230488.1406; val_chrom_access_recon_loss: 934963.9453; val_global_loss: 18048492.2500; val_optim_loss: 18048492.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7834; val_auprc_score: 0.7596; val_best_acc_score: 0.7050; val_best_f1_score: 0.7473; train_kl_reg_loss: 69735.4590; train_edge_recon_loss: 3483940.5871; train_gene_expr_recon_loss: 12573019.8788; train_masked_gp_l1_reg_loss: 78718.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182138.8440; train_chrom_access_recon_loss: 936556.6155; train_global_loss: 17324110.0758; train_optim_loss: 17324110.0758; val_kl_reg_loss: 59667.6167; val_edge_recon_loss: 3680693.2812; val_gene_expr_recon_loss: 12698737.0000; val_masked_gp_l1_reg_loss: 81153.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148037.9375; val_chrom_access_recon_loss: 935262.4453; val_global_loss: 17603551.2500; val_optim_loss: 17603551.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8503; val_auprc_score: 0.8266; val_best_acc_score: 0.7786; val_best_f1_score: 0.7954; train_kl_reg_loss: 60609.3540; train_edge_recon_loss: 3163310.4545; train_gene_expr_recon_loss: 12549429.2879; train_masked_gp_l1_reg_loss: 87277.2943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129730.4931; train_chrom_access_recon_loss: 934665.2443; train_global_loss: 16925022.0000; train_optim_loss: 16925022.0000; val_kl_reg_loss: 72231.1826; val_edge_recon_loss: 3048975.1562; val_gene_expr_recon_loss: 12686549.8750; val_masked_gp_l1_reg_loss: 94850.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116112.5391; val_chrom_access_recon_loss: 928326.6250; val_global_loss: 16947045.8750; val_optim_loss: 16947045.8750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8732; val_auprc_score: 0.8426; val_best_acc_score: 0.8041; val_best_f1_score: 0.8239; train_kl_reg_loss: 76606.6818; train_edge_recon_loss: 2938644.0341; train_gene_expr_recon_loss: 12464794.3939; train_masked_gp_l1_reg_loss: 98585.6631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105335.2752; train_chrom_access_recon_loss: 928669.8040; train_global_loss: 16612635.8333; train_optim_loss: 16612635.8333; val_kl_reg_loss: 86944.7744; val_edge_recon_loss: 2924516.3125; val_gene_expr_recon_loss: 12515212.1250; val_masked_gp_l1_reg_loss: 100574.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96433.4375; val_chrom_access_recon_loss: 921469.4609; val_global_loss: 16645149.7500; val_optim_loss: 16645149.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8939; val_auprc_score: 0.8736; val_best_acc_score: 0.8186; val_best_f1_score: 0.8301; train_kl_reg_loss: 93924.1283; train_edge_recon_loss: 2833095.4583; train_gene_expr_recon_loss: 12368459.7727; train_masked_gp_l1_reg_loss: 100936.5508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88521.1170; train_chrom_access_recon_loss: 922845.2263; train_global_loss: 16407782.2727; train_optim_loss: 16407782.2727; val_kl_reg_loss: 92971.0049; val_edge_recon_loss: 2849662.5625; val_gene_expr_recon_loss: 12469557.0000; val_masked_gp_l1_reg_loss: 101556.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83217.9766; val_chrom_access_recon_loss: 921862.5234; val_global_loss: 16518827.2500; val_optim_loss: 16518827.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8842; val_auprc_score: 0.8471; val_best_acc_score: 0.8294; val_best_f1_score: 0.8421; train_kl_reg_loss: 96304.1987; train_edge_recon_loss: 2823528.3371; train_gene_expr_recon_loss: 12304044.0303; train_masked_gp_l1_reg_loss: 101834.7262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79499.5640; train_chrom_access_recon_loss: 919734.1193; train_global_loss: 16324944.9091; train_optim_loss: 16324944.9091; val_kl_reg_loss: 95206.1768; val_edge_recon_loss: 2868016.2500; val_gene_expr_recon_loss: 12367498.2500; val_masked_gp_l1_reg_loss: 102149.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77190.8516; val_chrom_access_recon_loss: 903180.3516; val_global_loss: 16413241.0000; val_optim_loss: 16413241.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8900; val_auprc_score: 0.8540; val_best_acc_score: 0.8307; val_best_f1_score: 0.8441; train_kl_reg_loss: 96272.8996; train_edge_recon_loss: 2800081.9773; train_gene_expr_recon_loss: 12248555.9242; train_masked_gp_l1_reg_loss: 102457.7706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75054.3755; train_chrom_access_recon_loss: 914650.4792; train_global_loss: 16237073.4697; train_optim_loss: 16237073.4697; val_kl_reg_loss: 92748.2734; val_edge_recon_loss: 2875613.8438; val_gene_expr_recon_loss: 12231145.6250; val_masked_gp_l1_reg_loss: 102821.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73889.7188; val_chrom_access_recon_loss: 901976.4609; val_global_loss: 16278196.2500; val_optim_loss: 16278196.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9101; val_auprc_score: 0.8813; val_best_acc_score: 0.8536; val_best_f1_score: 0.8627; train_kl_reg_loss: 93507.8855; train_edge_recon_loss: 2800307.2235; train_gene_expr_recon_loss: 12195754.3182; train_masked_gp_l1_reg_loss: 103100.6552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72088.7612; train_chrom_access_recon_loss: 911875.6458; train_global_loss: 16176634.5455; train_optim_loss: 16176634.5455; val_kl_reg_loss: 91172.8379; val_edge_recon_loss: 2777645.3750; val_gene_expr_recon_loss: 12244629.8750; val_masked_gp_l1_reg_loss: 103602.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70155.9062; val_chrom_access_recon_loss: 896946.5000; val_global_loss: 16184152.5000; val_optim_loss: 16184152.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9034; val_auprc_score: 0.8639; val_best_acc_score: 0.8442; val_best_f1_score: 0.8554; train_kl_reg_loss: 89451.1712; train_edge_recon_loss: 2808846.8977; train_gene_expr_recon_loss: 12134883.4697; train_masked_gp_l1_reg_loss: 103961.4270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68725.1233; train_chrom_access_recon_loss: 907896.8551; train_global_loss: 16113764.9545; train_optim_loss: 16113764.9545; val_kl_reg_loss: 86764.4785; val_edge_recon_loss: 2864575.4688; val_gene_expr_recon_loss: 12146661.2500; val_masked_gp_l1_reg_loss: 104362.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68592.4531; val_chrom_access_recon_loss: 894269.3672; val_global_loss: 16165225.3750; val_optim_loss: 16165225.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9036; val_auprc_score: 0.8683; val_best_acc_score: 0.8407; val_best_f1_score: 0.8524; train_kl_reg_loss: 88120.7562; train_edge_recon_loss: 2794469.0303; train_gene_expr_recon_loss: 12089953.5758; train_masked_gp_l1_reg_loss: 104445.1491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66716.5301; train_chrom_access_recon_loss: 904593.9044; train_global_loss: 16048298.9394; train_optim_loss: 16048298.9394; val_kl_reg_loss: 88526.7471; val_edge_recon_loss: 2828587.8125; val_gene_expr_recon_loss: 12201101.2500; val_masked_gp_l1_reg_loss: 104817.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66107.0625; val_chrom_access_recon_loss: 896663.6641; val_global_loss: 16185804.6250; val_optim_loss: 16185804.6250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9084; val_auprc_score: 0.8761; val_best_acc_score: 0.8501; val_best_f1_score: 0.8580; train_kl_reg_loss: 88191.4213; train_edge_recon_loss: 2797275.0530; train_gene_expr_recon_loss: 12055956.1364; train_masked_gp_l1_reg_loss: 105068.9561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65273.9886; train_chrom_access_recon_loss: 901852.3769; train_global_loss: 16013618.0152; train_optim_loss: 16013618.0152; val_kl_reg_loss: 90431.7188; val_edge_recon_loss: 2820734.1250; val_gene_expr_recon_loss: 12128979.8750; val_masked_gp_l1_reg_loss: 105081.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63867.7305; val_chrom_access_recon_loss: 898825.7266; val_global_loss: 16107921.2500; val_optim_loss: 16107921.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9146; val_auprc_score: 0.8915; val_best_acc_score: 0.8533; val_best_f1_score: 0.8630; train_kl_reg_loss: 88773.9724; train_edge_recon_loss: 2785288.2614; train_gene_expr_recon_loss: 12014437.0758; train_masked_gp_l1_reg_loss: 105230.8755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63256.0044; train_chrom_access_recon_loss: 899250.7869; train_global_loss: 15956236.9091; train_optim_loss: 15956236.9091; val_kl_reg_loss: 86959.9863; val_edge_recon_loss: 2825474.7500; val_gene_expr_recon_loss: 12153260.5000; val_masked_gp_l1_reg_loss: 105724.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63686.4961; val_chrom_access_recon_loss: 897747.9766; val_global_loss: 16132853.1250; val_optim_loss: 16132853.1250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9116; val_auprc_score: 0.8801; val_best_acc_score: 0.8549; val_best_f1_score: 0.8651; train_kl_reg_loss: 87790.9138; train_edge_recon_loss: 2769454.4167; train_gene_expr_recon_loss: 11980636.1818; train_masked_gp_l1_reg_loss: 105649.8433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63011.5684; train_chrom_access_recon_loss: 897281.6951; train_global_loss: 15903824.5909; train_optim_loss: 15903824.5909; val_kl_reg_loss: 87243.4561; val_edge_recon_loss: 2813885.6562; val_gene_expr_recon_loss: 12003613.1250; val_masked_gp_l1_reg_loss: 106000.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62389.5430; val_chrom_access_recon_loss: 887466.2656; val_global_loss: 15960598.7500; val_optim_loss: 15960598.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9094; val_auprc_score: 0.8765; val_best_acc_score: 0.8544; val_best_f1_score: 0.8650; train_kl_reg_loss: 85537.0566; train_edge_recon_loss: 2763284.4432; train_gene_expr_recon_loss: 11932477.1364; train_masked_gp_l1_reg_loss: 106384.8310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62433.3541; train_chrom_access_recon_loss: 894456.2235; train_global_loss: 15844573.1061; train_optim_loss: 15844573.1061; val_kl_reg_loss: 83082.2852; val_edge_recon_loss: 2807033.2188; val_gene_expr_recon_loss: 11914344.1250; val_masked_gp_l1_reg_loss: 106658.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62668.8906; val_chrom_access_recon_loss: 879001.6875; val_global_loss: 15852789.1250; val_optim_loss: 15852789.1250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9109; val_auprc_score: 0.8804; val_best_acc_score: 0.8498; val_best_f1_score: 0.8621; train_kl_reg_loss: 85509.0083; train_edge_recon_loss: 2760503.2008; train_gene_expr_recon_loss: 11906472.2273; train_masked_gp_l1_reg_loss: 106987.5884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62924.0018; train_chrom_access_recon_loss: 892648.1364; train_global_loss: 15815044.1515; train_optim_loss: 15815044.1515; val_kl_reg_loss: 84592.3760; val_edge_recon_loss: 2823987.7500; val_gene_expr_recon_loss: 11940612.3750; val_masked_gp_l1_reg_loss: 107475.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63093.9258; val_chrom_access_recon_loss: 877166.4766; val_global_loss: 15896927.8750; val_optim_loss: 15896927.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9177; val_auprc_score: 0.8913; val_best_acc_score: 0.8600; val_best_f1_score: 0.8687; train_kl_reg_loss: 84405.7418; train_edge_recon_loss: 2759219.4091; train_gene_expr_recon_loss: 11875028.3788; train_masked_gp_l1_reg_loss: 107581.9458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62893.5133; train_chrom_access_recon_loss: 889476.6506; train_global_loss: 15778605.6061; train_optim_loss: 15778605.6061; val_kl_reg_loss: 82443.7588; val_edge_recon_loss: 2782423.3750; val_gene_expr_recon_loss: 11924957.0000; val_masked_gp_l1_reg_loss: 107827.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63016.3047; val_chrom_access_recon_loss: 888782.4844; val_global_loss: 15849450.5000; val_optim_loss: 15849450.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9161; val_auprc_score: 0.8847; val_best_acc_score: 0.8576; val_best_f1_score: 0.8686; train_kl_reg_loss: 82830.7918; train_edge_recon_loss: 2749937.2045; train_gene_expr_recon_loss: 11848948.8485; train_masked_gp_l1_reg_loss: 108059.4338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62954.2038; train_chrom_access_recon_loss: 888109.3722; train_global_loss: 15740839.9394; train_optim_loss: 15740839.9394; val_kl_reg_loss: 85580.0547; val_edge_recon_loss: 2786322.1875; val_gene_expr_recon_loss: 12026238.1250; val_masked_gp_l1_reg_loss: 108565.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62974.7969; val_chrom_access_recon_loss: 884157.1953; val_global_loss: 15953837.7500; val_optim_loss: 15953837.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9233; val_auprc_score: 0.8988; val_best_acc_score: 0.8641; val_best_f1_score: 0.8743; train_kl_reg_loss: 83612.2536; train_edge_recon_loss: 2747528.5114; train_gene_expr_recon_loss: 11825050.0758; train_masked_gp_l1_reg_loss: 108478.5788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62625.6404; train_chrom_access_recon_loss: 885991.0388; train_global_loss: 15713286.0455; train_optim_loss: 15713286.0455; val_kl_reg_loss: 83485.3408; val_edge_recon_loss: 2751037.2812; val_gene_expr_recon_loss: 11910694.7500; val_masked_gp_l1_reg_loss: 108750.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62166.9922; val_chrom_access_recon_loss: 871057.0625; val_global_loss: 15787192.3750; val_optim_loss: 15787192.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9235; val_auprc_score: 0.8928; val_best_acc_score: 0.8697; val_best_f1_score: 0.8756; train_kl_reg_loss: 85126.7489; train_edge_recon_loss: 2738922.2538; train_gene_expr_recon_loss: 11783773.0606; train_masked_gp_l1_reg_loss: 108658.2330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61931.4025; train_chrom_access_recon_loss: 883316.1335; train_global_loss: 15661727.8636; train_optim_loss: 15661727.8636; val_kl_reg_loss: 85293.4160; val_edge_recon_loss: 2779493.8438; val_gene_expr_recon_loss: 11856959.2500; val_masked_gp_l1_reg_loss: 109265.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62822.3320; val_chrom_access_recon_loss: 884242.8672; val_global_loss: 15778076.3750; val_optim_loss: 15778076.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9117; val_auprc_score: 0.8767; val_best_acc_score: 0.8549; val_best_f1_score: 0.8642; train_kl_reg_loss: 82090.1013; train_edge_recon_loss: 2741081.1553; train_gene_expr_recon_loss: 11777556.2424; train_masked_gp_l1_reg_loss: 109211.9025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61990.0094; train_chrom_access_recon_loss: 882238.1619; train_global_loss: 15654167.6212; train_optim_loss: 15654167.6212; val_kl_reg_loss: 82640.7148; val_edge_recon_loss: 2815119.9688; val_gene_expr_recon_loss: 11749231.5000; val_masked_gp_l1_reg_loss: 109330.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61647.5547; val_chrom_access_recon_loss: 864352.3281; val_global_loss: 15682323.6250; val_optim_loss: 15682323.6250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9230; val_auprc_score: 0.8968; val_best_acc_score: 0.8654; val_best_f1_score: 0.8734; train_kl_reg_loss: 83130.6309; train_edge_recon_loss: 2729885.0644; train_gene_expr_recon_loss: 11743906.0909; train_masked_gp_l1_reg_loss: 109379.3326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61323.4205; train_chrom_access_recon_loss: 879056.8210; train_global_loss: 15606681.3182; train_optim_loss: 15606681.3182; val_kl_reg_loss: 82301.3154; val_edge_recon_loss: 2799063.0312; val_gene_expr_recon_loss: 11892700.5000; val_masked_gp_l1_reg_loss: 109665.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61073.7500; val_chrom_access_recon_loss: 869632.2734; val_global_loss: 15814436.1250; val_optim_loss: 15814436.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9208; val_auprc_score: 0.8853; val_best_acc_score: 0.8592; val_best_f1_score: 0.8691; train_kl_reg_loss: 82303.7545; train_edge_recon_loss: 2741140.8409; train_gene_expr_recon_loss: 11722993.0909; train_masked_gp_l1_reg_loss: 109683.4858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60792.2199; train_chrom_access_recon_loss: 878248.7907; train_global_loss: 15595162.1667; train_optim_loss: 15595162.1667; val_kl_reg_loss: 79209.8320; val_edge_recon_loss: 2808759.2812; val_gene_expr_recon_loss: 11807708.1250; val_masked_gp_l1_reg_loss: 110138.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61205.8594; val_chrom_access_recon_loss: 872771.1094; val_global_loss: 15739793.0000; val_optim_loss: 15739793.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9285; val_auprc_score: 0.9066; val_best_acc_score: 0.8684; val_best_f1_score: 0.8752; train_kl_reg_loss: 81084.1734; train_edge_recon_loss: 2720738.1515; train_gene_expr_recon_loss: 11704984.7879; train_masked_gp_l1_reg_loss: 110071.6504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60736.7946; train_chrom_access_recon_loss: 877160.7263; train_global_loss: 15554776.2121; train_optim_loss: 15554776.2121; val_kl_reg_loss: 79597.3447; val_edge_recon_loss: 2775511.9375; val_gene_expr_recon_loss: 11827874.5000; val_masked_gp_l1_reg_loss: 110173.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60376.1914; val_chrom_access_recon_loss: 874785.2891; val_global_loss: 15728319.3750; val_optim_loss: 15728319.3750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9235; val_auprc_score: 0.8885; val_best_acc_score: 0.8670; val_best_f1_score: 0.8758; train_kl_reg_loss: 105062.1684; train_edge_recon_loss: 2853348.7500; train_gene_expr_recon_loss: 10752137.4697; train_masked_gp_l1_reg_loss: 109992.3487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54565.2114; train_chrom_access_recon_loss: 828101.8996; train_global_loss: 14703207.7727; train_optim_loss: 14703207.7727; val_kl_reg_loss: 31351.7065; val_edge_recon_loss: 2804647.1875; val_gene_expr_recon_loss: 10757703.8750; val_masked_gp_l1_reg_loss: 109752.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54592.3633; val_chrom_access_recon_loss: 816431.3828; val_global_loss: 14574478.1250; val_optim_loss: 14574478.1250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9354; val_auprc_score: 0.9110; val_best_acc_score: 0.8815; val_best_f1_score: 0.8877; train_kl_reg_loss: 90783.5163; train_edge_recon_loss: 2749873.6818; train_gene_expr_recon_loss: 10709839.9697; train_masked_gp_l1_reg_loss: 109089.1815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55108.3558; train_chrom_access_recon_loss: 814207.3712; train_global_loss: 14528902.0606; train_optim_loss: 14528902.0606; val_kl_reg_loss: 37774.6069; val_edge_recon_loss: 2759190.5625; val_gene_expr_recon_loss: 10850869.2500; val_masked_gp_l1_reg_loss: 108431.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55696.5898; val_chrom_access_recon_loss: 803721.6953; val_global_loss: 14615685.3750; val_optim_loss: 14615685.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9270; val_auprc_score: 0.9043; val_best_acc_score: 0.8665; val_best_f1_score: 0.8764; train_kl_reg_loss: 78563.1074; train_edge_recon_loss: 2750138.7197; train_gene_expr_recon_loss: 10687982.9697; train_masked_gp_l1_reg_loss: 107518.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55850.2799; train_chrom_access_recon_loss: 813794.1752; train_global_loss: 14493847.3030; train_optim_loss: 14493847.3030; val_kl_reg_loss: 44304.0659; val_edge_recon_loss: 2784523.5312; val_gene_expr_recon_loss: 10670857.6250; val_masked_gp_l1_reg_loss: 106605.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55924.7227; val_chrom_access_recon_loss: 807464.1562; val_global_loss: 14469679.5000; val_optim_loss: 14469679.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9299; val_auprc_score: 0.9004; val_best_acc_score: 0.8786; val_best_f1_score: 0.8855; train_kl_reg_loss: 69438.0829; train_edge_recon_loss: 2735075.8636; train_gene_expr_recon_loss: 10664323.5758; train_masked_gp_l1_reg_loss: 105809.5097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56224.4658; train_chrom_access_recon_loss: 812135.5227; train_global_loss: 14443007.1818; train_optim_loss: 14443007.1818; val_kl_reg_loss: 48190.8687; val_edge_recon_loss: 2744500.9062; val_gene_expr_recon_loss: 10813932.8750; val_masked_gp_l1_reg_loss: 105067.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56483.5156; val_chrom_access_recon_loss: 805430.5156; val_global_loss: 14573606.3750; val_optim_loss: 14573606.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9340; val_auprc_score: 0.9111; val_best_acc_score: 0.8753; val_best_f1_score: 0.8833; train_kl_reg_loss: 65198.4398; train_edge_recon_loss: 2724807.5455; train_gene_expr_recon_loss: 10647626.9242; train_masked_gp_l1_reg_loss: 104521.1048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56317.3291; train_chrom_access_recon_loss: 810967.9366; train_global_loss: 14409439.3182; train_optim_loss: 14409439.3182; val_kl_reg_loss: 48350.0918; val_edge_recon_loss: 2734499.2188; val_gene_expr_recon_loss: 10675534.6250; val_masked_gp_l1_reg_loss: 103895.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56201.7422; val_chrom_access_recon_loss: 800907.5156; val_global_loss: 14419389.3750; val_optim_loss: 14419389.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9278; val_auprc_score: 0.8974; val_best_acc_score: 0.8710; val_best_f1_score: 0.8802; train_kl_reg_loss: 64633.3174; train_edge_recon_loss: 2716101.8220; train_gene_expr_recon_loss: 10628398.8485; train_masked_gp_l1_reg_loss: 103230.3775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56149.8868; train_chrom_access_recon_loss: 810388.9896; train_global_loss: 14378903.1212; train_optim_loss: 14378903.1212; val_kl_reg_loss: 51753.7031; val_edge_recon_loss: 2762235.2812; val_gene_expr_recon_loss: 10715101.2500; val_masked_gp_l1_reg_loss: 102609.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56078.8281; val_chrom_access_recon_loss: 811582.3281; val_global_loss: 14499361.5000; val_optim_loss: 14499361.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9357; val_auprc_score: 0.9122; val_best_acc_score: 0.8804; val_best_f1_score: 0.8879; train_kl_reg_loss: 63000.4309; train_edge_recon_loss: 2710910.9356; train_gene_expr_recon_loss: 10604460.4394; train_masked_gp_l1_reg_loss: 101996.2463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56229.7671; train_chrom_access_recon_loss: 807580.8674; train_global_loss: 14344178.7273; train_optim_loss: 14344178.7273; val_kl_reg_loss: 52286.7598; val_edge_recon_loss: 2730572.7188; val_gene_expr_recon_loss: 10674492.8750; val_masked_gp_l1_reg_loss: 101379.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56148.7852; val_chrom_access_recon_loss: 797061.1016; val_global_loss: 14411941.3750; val_optim_loss: 14411941.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9322; val_auprc_score: 0.9086; val_best_acc_score: 0.8780; val_best_f1_score: 0.8875; train_kl_reg_loss: 61064.5732; train_edge_recon_loss: 2708286.0152; train_gene_expr_recon_loss: 10587746.2879; train_masked_gp_l1_reg_loss: 100995.7327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56208.4481; train_chrom_access_recon_loss: 804100.3201; train_global_loss: 14318401.4545; train_optim_loss: 14318401.4545; val_kl_reg_loss: 56421.1587; val_edge_recon_loss: 2744347.0625; val_gene_expr_recon_loss: 10710626.6250; val_masked_gp_l1_reg_loss: 100456.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56134.6836; val_chrom_access_recon_loss: 804284.8672; val_global_loss: 14472270.7500; val_optim_loss: 14472270.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9341; val_auprc_score: 0.9132; val_best_acc_score: 0.8778; val_best_f1_score: 0.8863; train_kl_reg_loss: 62176.5995; train_edge_recon_loss: 2715815.4015; train_gene_expr_recon_loss: 10579408.5000; train_masked_gp_l1_reg_loss: 99811.0153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56054.1952; train_chrom_access_recon_loss: 802451.8655; train_global_loss: 14315717.5455; train_optim_loss: 14315717.5455; val_kl_reg_loss: 55884.8589; val_edge_recon_loss: 2745534.7812; val_gene_expr_recon_loss: 10689674.3750; val_masked_gp_l1_reg_loss: 99340.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56055.2891; val_chrom_access_recon_loss: 799382.6641; val_global_loss: 14445871.3750; val_optim_loss: 14445871.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9322; val_auprc_score: 0.9089; val_best_acc_score: 0.8767; val_best_f1_score: 0.8843; train_kl_reg_loss: 62639.1151; train_edge_recon_loss: 2709717.3864; train_gene_expr_recon_loss: 10561165.2424; train_masked_gp_l1_reg_loss: 98748.1944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55929.3091; train_chrom_access_recon_loss: 799506.8807; train_global_loss: 14287706.1212; train_optim_loss: 14287706.1212; val_kl_reg_loss: 52636.8906; val_edge_recon_loss: 2756894.0000; val_gene_expr_recon_loss: 10637092.0000; val_masked_gp_l1_reg_loss: 98160.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56155.7969; val_chrom_access_recon_loss: 795742.2812; val_global_loss: 14396682.1250; val_optim_loss: 14396682.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9286; val_auprc_score: 0.9039; val_best_acc_score: 0.8761; val_best_f1_score: 0.8847; train_kl_reg_loss: 62193.5171; train_edge_recon_loss: 2704076.5038; train_gene_expr_recon_loss: 10533182.2273; train_masked_gp_l1_reg_loss: 97740.7406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55943.0408; train_chrom_access_recon_loss: 797966.4167; train_global_loss: 14251102.4242; train_optim_loss: 14251102.4242; val_kl_reg_loss: 53543.3525; val_edge_recon_loss: 2734291.5938; val_gene_expr_recon_loss: 10563206.0000; val_masked_gp_l1_reg_loss: 97422.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56055.6641; val_chrom_access_recon_loss: 791700.3984; val_global_loss: 14296219.2500; val_optim_loss: 14296219.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9419; val_auprc_score: 0.9141; val_best_acc_score: 0.8853; val_best_f1_score: 0.8918; train_kl_reg_loss: 59867.2164; train_edge_recon_loss: 2705292.8447; train_gene_expr_recon_loss: 10506281.2879; train_masked_gp_l1_reg_loss: 97041.5359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55866.0848; train_chrom_access_recon_loss: 796309.8040; train_global_loss: 14220658.7424; train_optim_loss: 14220658.7424; val_kl_reg_loss: 53317.2207; val_edge_recon_loss: 2750464.0312; val_gene_expr_recon_loss: 10561213.3750; val_masked_gp_l1_reg_loss: 96676.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55598.0625; val_chrom_access_recon_loss: 792038.2812; val_global_loss: 14309306.7500; val_optim_loss: 14309306.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9435; val_auprc_score: 0.9156; val_best_acc_score: 0.8920; val_best_f1_score: 0.8986; train_kl_reg_loss: 59833.0812; train_edge_recon_loss: 2715205.9280; train_gene_expr_recon_loss: 10496430.6515; train_masked_gp_l1_reg_loss: 96379.2158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55811.7419; train_chrom_access_recon_loss: 795194.5985; train_global_loss: 14218855.1364; train_optim_loss: 14218855.1364; val_kl_reg_loss: 57153.8745; val_edge_recon_loss: 2705202.0938; val_gene_expr_recon_loss: 10509812.1250; val_masked_gp_l1_reg_loss: 96201.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55787.8320; val_chrom_access_recon_loss: 788399.7188; val_global_loss: 14212557.0000; val_optim_loss: 14212557.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9493; val_auprc_score: 0.9316; val_best_acc_score: 0.8952; val_best_f1_score: 0.8998; train_kl_reg_loss: 60724.5592; train_edge_recon_loss: 2697778.7992; train_gene_expr_recon_loss: 10484951.9697; train_masked_gp_l1_reg_loss: 95760.0463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55731.9442; train_chrom_access_recon_loss: 795358.1383; train_global_loss: 14190305.4242; train_optim_loss: 14190305.4242; val_kl_reg_loss: 53103.2637; val_edge_recon_loss: 2701745.8438; val_gene_expr_recon_loss: 10497041.0000; val_masked_gp_l1_reg_loss: 95612.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55828.3711; val_chrom_access_recon_loss: 782362.7891; val_global_loss: 14185692.6250; val_optim_loss: 14185692.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9462; val_auprc_score: 0.9220; val_best_acc_score: 0.8909; val_best_f1_score: 0.8974; train_kl_reg_loss: 60659.2554; train_edge_recon_loss: 2692881.5530; train_gene_expr_recon_loss: 10464799.5606; train_masked_gp_l1_reg_loss: 95370.3203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55721.8274; train_chrom_access_recon_loss: 792416.1837; train_global_loss: 14161848.7424; train_optim_loss: 14161848.7424; val_kl_reg_loss: 59172.4736; val_edge_recon_loss: 2690491.6562; val_gene_expr_recon_loss: 10581877.6250; val_masked_gp_l1_reg_loss: 95007.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55886.9688; val_chrom_access_recon_loss: 791699.7734; val_global_loss: 14274135.7500; val_optim_loss: 14274135.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9404; val_auprc_score: 0.9159; val_best_acc_score: 0.8850; val_best_f1_score: 0.8892; train_kl_reg_loss: 60436.5881; train_edge_recon_loss: 2702686.9394; train_gene_expr_recon_loss: 10453332.2121; train_masked_gp_l1_reg_loss: 94653.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55724.4522; train_chrom_access_recon_loss: 791282.1193; train_global_loss: 14158116.2121; train_optim_loss: 14158116.2121; val_kl_reg_loss: 53574.2241; val_edge_recon_loss: 2750774.8750; val_gene_expr_recon_loss: 10559248.5000; val_masked_gp_l1_reg_loss: 94445.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55670.8086; val_chrom_access_recon_loss: 792601.2266; val_global_loss: 14306315.8750; val_optim_loss: 14306315.8750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9432; val_auprc_score: 0.9286; val_best_acc_score: 0.8861; val_best_f1_score: 0.8906; train_kl_reg_loss: 59699.5237; train_edge_recon_loss: 2687879.3864; train_gene_expr_recon_loss: 10440823.4091; train_masked_gp_l1_reg_loss: 94290.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55624.2453; train_chrom_access_recon_loss: 790723.6155; train_global_loss: 14129041.0909; train_optim_loss: 14129041.0909; val_kl_reg_loss: 56939.3452; val_edge_recon_loss: 2745806.9375; val_gene_expr_recon_loss: 10487545.5000; val_masked_gp_l1_reg_loss: 94032.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55580.7773; val_chrom_access_recon_loss: 780287.5234; val_global_loss: 14220193.1250; val_optim_loss: 14220193.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9457; val_auprc_score: 0.9258; val_best_acc_score: 0.8861; val_best_f1_score: 0.8907; train_kl_reg_loss: 58992.6919; train_edge_recon_loss: 2695494.0492; train_gene_expr_recon_loss: 10431691.1061; train_masked_gp_l1_reg_loss: 93838.4237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55729.5922; train_chrom_access_recon_loss: 790305.5028; train_global_loss: 14126051.3788; train_optim_loss: 14126051.3788; val_kl_reg_loss: 56667.2456; val_edge_recon_loss: 2743248.5312; val_gene_expr_recon_loss: 10594181.1250; val_masked_gp_l1_reg_loss: 93677.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55808.6758; val_chrom_access_recon_loss: 792360.8125; val_global_loss: 14335943.7500; val_optim_loss: 14335943.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9445; val_auprc_score: 0.9229; val_best_acc_score: 0.8858; val_best_f1_score: 0.8910; train_kl_reg_loss: 60446.3335; train_edge_recon_loss: 2695643.3826; train_gene_expr_recon_loss: 10410088.2727; train_masked_gp_l1_reg_loss: 92324.6755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48124.5908; train_chrom_access_recon_loss: 788929.0549; train_global_loss: 14095556.3636; train_optim_loss: 14095556.3636; val_kl_reg_loss: 57064.9941; val_edge_recon_loss: 2702126.5000; val_gene_expr_recon_loss: 10557474.1250; val_masked_gp_l1_reg_loss: 91874.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46398.3320; val_chrom_access_recon_loss: 793444.2891; val_global_loss: 14248382.0000; val_optim_loss: 14248382.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9493; val_auprc_score: 0.9333; val_best_acc_score: 0.8907; val_best_f1_score: 0.8958; train_kl_reg_loss: 60659.8147; train_edge_recon_loss: 2684107.9129; train_gene_expr_recon_loss: 10411244.4091; train_masked_gp_l1_reg_loss: 91764.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46129.5750; train_chrom_access_recon_loss: 789156.2358; train_global_loss: 14083062.4697; train_optim_loss: 14083062.4697; val_kl_reg_loss: 57337.6714; val_edge_recon_loss: 2713663.6875; val_gene_expr_recon_loss: 10481087.0000; val_masked_gp_l1_reg_loss: 91699.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45930.1523; val_chrom_access_recon_loss: 787753.3594; val_global_loss: 14177470.7500; val_optim_loss: 14177470.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9483; val_auprc_score: 0.9302; val_best_acc_score: 0.8907; val_best_f1_score: 0.8957; train_kl_reg_loss: 60517.8081; train_edge_recon_loss: 2693982.0152; train_gene_expr_recon_loss: 10404771.3182; train_masked_gp_l1_reg_loss: 91661.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45785.4535; train_chrom_access_recon_loss: 788992.9962; train_global_loss: 14085710.8636; train_optim_loss: 14085710.8636; val_kl_reg_loss: 56799.4404; val_edge_recon_loss: 2697879.0312; val_gene_expr_recon_loss: 10491575.5000; val_masked_gp_l1_reg_loss: 91626.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45632.5625; val_chrom_access_recon_loss: 792541.8047; val_global_loss: 14176054.7500; val_optim_loss: 14176054.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9468; val_auprc_score: 0.9232; val_best_acc_score: 0.8888; val_best_f1_score: 0.8953; train_kl_reg_loss: 61029.2467; train_edge_recon_loss: 2692856.6591; train_gene_expr_recon_loss: 10404796.5909; train_masked_gp_l1_reg_loss: 91581.6759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45522.3871; train_chrom_access_recon_loss: 788756.0653; train_global_loss: 14084542.7576; train_optim_loss: 14084542.7576; val_kl_reg_loss: 56748.2871; val_edge_recon_loss: 2717947.6875; val_gene_expr_recon_loss: 10467290.1250; val_masked_gp_l1_reg_loss: 91564.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45434.1445; val_chrom_access_recon_loss: 780319.6953; val_global_loss: 14159304.5000; val_optim_loss: 14159304.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9406; val_auprc_score: 0.9144; val_best_acc_score: 0.8845; val_best_f1_score: 0.8914; train_kl_reg_loss: 61011.8365; train_edge_recon_loss: 2687605.2652; train_gene_expr_recon_loss: 10394846.8333; train_masked_gp_l1_reg_loss: 91525.5138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45341.9901; train_chrom_access_recon_loss: 787692.7093; train_global_loss: 14068024.1212; train_optim_loss: 14068024.1212; val_kl_reg_loss: 57668.5381; val_edge_recon_loss: 2743441.0000; val_gene_expr_recon_loss: 10477728.8750; val_masked_gp_l1_reg_loss: 91494.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45265.9141; val_chrom_access_recon_loss: 783967.5078; val_global_loss: 14199566.7500; val_optim_loss: 14199566.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9442; val_auprc_score: 0.9190; val_best_acc_score: 0.8893; val_best_f1_score: 0.8943; train_kl_reg_loss: 60999.9722; train_edge_recon_loss: 2686300.2008; train_gene_expr_recon_loss: 10397292.5909; train_masked_gp_l1_reg_loss: 91463.4624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45164.9309; train_chrom_access_recon_loss: 789023.3144; train_global_loss: 14070244.5455; train_optim_loss: 14070244.5455; val_kl_reg_loss: 56990.6855; val_edge_recon_loss: 2711200.5625; val_gene_expr_recon_loss: 10469587.2500; val_masked_gp_l1_reg_loss: 91431.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45089.4609; val_chrom_access_recon_loss: 781667.5391; val_global_loss: 14155967.0000; val_optim_loss: 14155967.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9491; val_auprc_score: 0.9325; val_best_acc_score: 0.8904; val_best_f1_score: 0.8960; train_kl_reg_loss: 61595.5661; train_edge_recon_loss: 2692983.3485; train_gene_expr_recon_loss: 10407423.3182; train_masked_gp_l1_reg_loss: 91383.0723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45023.6527; train_chrom_access_recon_loss: 789334.6231; train_global_loss: 14087743.5303; train_optim_loss: 14087743.5303; val_kl_reg_loss: 57976.3647; val_edge_recon_loss: 2703444.6250; val_gene_expr_recon_loss: 10529215.5000; val_masked_gp_l1_reg_loss: 91337.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44940.2305; val_chrom_access_recon_loss: 781158.6719; val_global_loss: 14208072.3750; val_optim_loss: 14208072.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9492; val_auprc_score: 0.9295; val_best_acc_score: 0.8958; val_best_f1_score: 0.8996; train_kl_reg_loss: 61317.7915; train_edge_recon_loss: 2678681.1742; train_gene_expr_recon_loss: 10401195.6515; train_masked_gp_l1_reg_loss: 91301.4439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44892.8200; train_chrom_access_recon_loss: 789385.2206; train_global_loss: 14066773.9697; train_optim_loss: 14066773.9697; val_kl_reg_loss: 57830.7905; val_edge_recon_loss: 2701245.9062; val_gene_expr_recon_loss: 10383154.3750; val_masked_gp_l1_reg_loss: 91263.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44835.5391; val_chrom_access_recon_loss: 780925.7109; val_global_loss: 14059257.1250; val_optim_loss: 14059257.1250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9467; val_auprc_score: 0.9302; val_best_acc_score: 0.8898; val_best_f1_score: 0.8932; train_kl_reg_loss: 61752.7486; train_edge_recon_loss: 2693432.5303; train_gene_expr_recon_loss: 10395610.6818; train_masked_gp_l1_reg_loss: 91216.7893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44794.3978; train_chrom_access_recon_loss: 788899.7036; train_global_loss: 14075706.8939; train_optim_loss: 14075706.8939; val_kl_reg_loss: 58502.6670; val_edge_recon_loss: 2727071.1875; val_gene_expr_recon_loss: 10517987.6250; val_masked_gp_l1_reg_loss: 91179.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44746.5664; val_chrom_access_recon_loss: 777699.1172; val_global_loss: 14217187.7500; val_optim_loss: 14217187.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9469; val_auprc_score: 0.9285; val_best_acc_score: 0.8907; val_best_f1_score: 0.8933; train_kl_reg_loss: 61503.3720; train_edge_recon_loss: 2682285.8144; train_gene_expr_recon_loss: 10386263.8333; train_masked_gp_l1_reg_loss: 91140.4375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44652.5916; train_chrom_access_recon_loss: 788665.2566; train_global_loss: 14054511.2576; train_optim_loss: 14054511.2576; val_kl_reg_loss: 57602.7158; val_edge_recon_loss: 2751428.3750; val_gene_expr_recon_loss: 10476380.2500; val_masked_gp_l1_reg_loss: 91093.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44587.8906; val_chrom_access_recon_loss: 780114.4375; val_global_loss: 14201206.7500; val_optim_loss: 14201206.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9536; val_auprc_score: 0.9351; val_best_acc_score: 0.8966; val_best_f1_score: 0.8984; train_kl_reg_loss: 62251.3203; train_edge_recon_loss: 2680853.2841; train_gene_expr_recon_loss: 10401411.8030; train_masked_gp_l1_reg_loss: 91062.4092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44546.2909; train_chrom_access_recon_loss: 789401.5445; train_global_loss: 14069526.7121; train_optim_loss: 14069526.7121; val_kl_reg_loss: 59254.2642; val_edge_recon_loss: 2696441.3438; val_gene_expr_recon_loss: 10435265.1250; val_masked_gp_l1_reg_loss: 90990.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44427.6953; val_chrom_access_recon_loss: 777964.9531; val_global_loss: 14104343.5000; val_optim_loss: 14104343.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9434; val_auprc_score: 0.9205; val_best_acc_score: 0.8861; val_best_f1_score: 0.8914; train_kl_reg_loss: 62355.8612; train_edge_recon_loss: 2686395.4924; train_gene_expr_recon_loss: 10384925.3788; train_masked_gp_l1_reg_loss: 90947.2872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44372.6844; train_chrom_access_recon_loss: 788015.5824; train_global_loss: 14057012.2727; train_optim_loss: 14057012.2727; val_kl_reg_loss: 58901.7578; val_edge_recon_loss: 2712641.2812; val_gene_expr_recon_loss: 10427943.7500; val_masked_gp_l1_reg_loss: 90903.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44337.5977; val_chrom_access_recon_loss: 779219.1328; val_global_loss: 14113946.8750; val_optim_loss: 14113946.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9356; val_best_acc_score: 0.8949; val_best_f1_score: 0.8984; train_kl_reg_loss: 62371.8292; train_edge_recon_loss: 2691839.9659; train_gene_expr_recon_loss: 10384699.0606; train_masked_gp_l1_reg_loss: 90750.8140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43543.7430; train_chrom_access_recon_loss: 787515.6922; train_global_loss: 14060721.1061; train_optim_loss: 14060721.1061; val_kl_reg_loss: 59075.1963; val_edge_recon_loss: 2722284.8750; val_gene_expr_recon_loss: 10527823.8750; val_masked_gp_l1_reg_loss: 90700.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43379.7773; val_chrom_access_recon_loss: 784531.5312; val_global_loss: 14227796.6250; val_optim_loss: 14227796.6250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9480; val_auprc_score: 0.9246; val_best_acc_score: 0.8925; val_best_f1_score: 0.8966; train_kl_reg_loss: 62206.5949; train_edge_recon_loss: 2693827.4886; train_gene_expr_recon_loss: 10378430.2727; train_masked_gp_l1_reg_loss: 90684.7866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43356.1093; train_chrom_access_recon_loss: 788386.7737; train_global_loss: 14056892.0152; train_optim_loss: 14056892.0152; val_kl_reg_loss: 58392.9717; val_edge_recon_loss: 2723824.2188; val_gene_expr_recon_loss: 10463170.6250; val_masked_gp_l1_reg_loss: 90671.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43336.5000; val_chrom_access_recon_loss: 790573.9609; val_global_loss: 14169969.8750; val_optim_loss: 14169969.8750
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9393; val_auprc_score: 0.9201; val_best_acc_score: 0.8786; val_best_f1_score: 0.8831; train_kl_reg_loss: 62129.2540; train_edge_recon_loss: 2682656.2576; train_gene_expr_recon_loss: 10385595.5758; train_masked_gp_l1_reg_loss: 90663.8429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43323.0612; train_chrom_access_recon_loss: 788628.9697; train_global_loss: 14052996.8939; train_optim_loss: 14052996.8939; val_kl_reg_loss: 58956.4194; val_edge_recon_loss: 2742047.0938; val_gene_expr_recon_loss: 10524554.6250; val_masked_gp_l1_reg_loss: 90654.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43307.2070; val_chrom_access_recon_loss: 789747.8047; val_global_loss: 14249267.1250; val_optim_loss: 14249267.1250
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9388; val_auprc_score: 0.9084; val_best_acc_score: 0.8855; val_best_f1_score: 0.8894; train_kl_reg_loss: 62272.3475; train_edge_recon_loss: 2680505.0758; train_gene_expr_recon_loss: 10391768.6364; train_masked_gp_l1_reg_loss: 90647.0514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43294.0842; train_chrom_access_recon_loss: 789422.2765; train_global_loss: 14057909.5000; train_optim_loss: 14057909.5000; val_kl_reg_loss: 58611.5225; val_edge_recon_loss: 2727466.3750; val_gene_expr_recon_loss: 10517807.6250; val_masked_gp_l1_reg_loss: 90640.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43281.4102; val_chrom_access_recon_loss: 789260.2344; val_global_loss: 14227066.7500; val_optim_loss: 14227066.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 36 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9453
val AUPRC score: 0.9240
val best accuracy score: 0.8831
val best F1 score: 0.8872
val target rna MSE score: 1.7407
val source rna MSE score: 0.8648
val target atac MSE score: 0.4685
val source atac MSE score: 0.1933
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
