[True]
Run timestamp: 07092023_135041_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6033; val_auprc_score: 0.6022; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 42407.0636; train_edge_recon_loss: 3535016.3485; train_gene_expr_recon_loss: 12614926.2273; train_masked_gp_l1_reg_loss: 57414.1458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 820533.4290; train_chrom_access_recon_loss: 2063671.8314; train_global_loss: 19133969.0909; train_optim_loss: 19133969.0909; val_kl_reg_loss: 90490.3818; val_edge_recon_loss: 4065445.1875; val_gene_expr_recon_loss: 11660425.1250; val_masked_gp_l1_reg_loss: 54984.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 631268.5625; val_chrom_access_recon_loss: 1972340.8594; val_global_loss: 18474954.7500; val_optim_loss: 18474954.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6575; val_auprc_score: 0.6424; val_best_acc_score: 0.5250; val_best_f1_score: 0.6756; train_kl_reg_loss: 86068.4843; train_edge_recon_loss: 3515873.2197; train_gene_expr_recon_loss: 11339504.9697; train_masked_gp_l1_reg_loss: 52695.2024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 466454.6037; train_chrom_access_recon_loss: 1959150.6307; train_global_loss: 17419746.8485; train_optim_loss: 17419746.8485; val_kl_reg_loss: 80761.9893; val_edge_recon_loss: 4063718.3438; val_gene_expr_recon_loss: 11260471.8750; val_masked_gp_l1_reg_loss: 51153.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 326069.2812; val_chrom_access_recon_loss: 1930438.4375; val_global_loss: 17712612.6250; val_optim_loss: 17712612.6250
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7225; val_auprc_score: 0.7066; val_best_acc_score: 0.6298; val_best_f1_score: 0.7056; train_kl_reg_loss: 81615.0500; train_edge_recon_loss: 3511820.2500; train_gene_expr_recon_loss: 11156529.7879; train_masked_gp_l1_reg_loss: 51397.4218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243833.9943; train_chrom_access_recon_loss: 1934747.9299; train_global_loss: 16979944.4394; train_optim_loss: 16979944.4394; val_kl_reg_loss: 82658.5391; val_edge_recon_loss: 4055861.2188; val_gene_expr_recon_loss: 11280118.3750; val_masked_gp_l1_reg_loss: 52167.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179310.8750; val_chrom_access_recon_loss: 1930372.6719; val_global_loss: 17580488.7500; val_optim_loss: 17580488.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8188; val_auprc_score: 0.7843; val_best_acc_score: 0.7346; val_best_f1_score: 0.7710; train_kl_reg_loss: 73682.2310; train_edge_recon_loss: 3501250.1591; train_gene_expr_recon_loss: 11055429.6970; train_masked_gp_l1_reg_loss: 53449.9060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142334.2776; train_chrom_access_recon_loss: 1922150.9432; train_global_loss: 16748297.2424; train_optim_loss: 16748297.2424; val_kl_reg_loss: 65356.1982; val_edge_recon_loss: 3946243.5938; val_gene_expr_recon_loss: 11122497.0000; val_masked_gp_l1_reg_loss: 54983.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113213.8281; val_chrom_access_recon_loss: 1909878.4688; val_global_loss: 17212173.3750; val_optim_loss: 17212173.3750
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8468; val_auprc_score: 0.8146; val_best_acc_score: 0.7652; val_best_f1_score: 0.7948; train_kl_reg_loss: 57547.3907; train_edge_recon_loss: 3270511.2992; train_gene_expr_recon_loss: 11006297.0000; train_masked_gp_l1_reg_loss: 57662.2345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96618.0025; train_chrom_access_recon_loss: 1918024.1686; train_global_loss: 16406660.1515; train_optim_loss: 16406660.1515; val_kl_reg_loss: 76489.8115; val_edge_recon_loss: 2952478.5625; val_gene_expr_recon_loss: 11124005.2500; val_masked_gp_l1_reg_loss: 60381.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82710.5078; val_chrom_access_recon_loss: 1915689.3750; val_global_loss: 16211756.1250; val_optim_loss: 16211756.1250
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8424; val_auprc_score: 0.8102; val_best_acc_score: 0.7550; val_best_f1_score: 0.7914; train_kl_reg_loss: 72632.8005; train_edge_recon_loss: 2998167.9053; train_gene_expr_recon_loss: 10964297.6061; train_masked_gp_l1_reg_loss: 62055.8611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74363.3585; train_chrom_access_recon_loss: 1906725.3049; train_global_loss: 16078242.9091; train_optim_loss: 16078242.9091; val_kl_reg_loss: 87504.8867; val_edge_recon_loss: 2965479.0312; val_gene_expr_recon_loss: 11077836.8750; val_masked_gp_l1_reg_loss: 63069.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64668.2617; val_chrom_access_recon_loss: 1910829.4375; val_global_loss: 16169388.1250; val_optim_loss: 16169388.1250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8490; val_auprc_score: 0.8069; val_best_acc_score: 0.7706; val_best_f1_score: 0.7924; train_kl_reg_loss: 86024.5418; train_edge_recon_loss: 2953011.6856; train_gene_expr_recon_loss: 10851949.7121; train_masked_gp_l1_reg_loss: 64015.0692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58401.4141; train_chrom_access_recon_loss: 1893157.0871; train_global_loss: 15906559.4697; train_optim_loss: 15906559.4697; val_kl_reg_loss: 87421.8730; val_edge_recon_loss: 2959598.5312; val_gene_expr_recon_loss: 10993377.6250; val_masked_gp_l1_reg_loss: 65059.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53147.3555; val_chrom_access_recon_loss: 1910554.3281; val_global_loss: 16069159.5000; val_optim_loss: 16069159.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8739; val_auprc_score: 0.8536; val_best_acc_score: 0.7883; val_best_f1_score: 0.8012; train_kl_reg_loss: 85967.2725; train_edge_recon_loss: 2914263.5795; train_gene_expr_recon_loss: 10785934.3788; train_masked_gp_l1_reg_loss: 65900.1899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49367.3485; train_chrom_access_recon_loss: 1882812.3561; train_global_loss: 15784245.1515; train_optim_loss: 15784245.1515; val_kl_reg_loss: 83516.3096; val_edge_recon_loss: 2951982.8125; val_gene_expr_recon_loss: 10902873.2500; val_masked_gp_l1_reg_loss: 66924.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46054.6953; val_chrom_access_recon_loss: 1887401.6250; val_global_loss: 15938753.8750; val_optim_loss: 15938753.8750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8924; val_auprc_score: 0.8591; val_best_acc_score: 0.8221; val_best_f1_score: 0.8366; train_kl_reg_loss: 83168.9432; train_edge_recon_loss: 2889966.3674; train_gene_expr_recon_loss: 10734337.0455; train_masked_gp_l1_reg_loss: 67872.5375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43461.4442; train_chrom_access_recon_loss: 1875079.3106; train_global_loss: 15693885.7121; train_optim_loss: 15693885.7121; val_kl_reg_loss: 81465.5039; val_edge_recon_loss: 2885912.7188; val_gene_expr_recon_loss: 10917555.2500; val_masked_gp_l1_reg_loss: 69075.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41272.4492; val_chrom_access_recon_loss: 1905510.7188; val_global_loss: 15900792.2500; val_optim_loss: 15900792.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9032; val_auprc_score: 0.8676; val_best_acc_score: 0.8407; val_best_f1_score: 0.8531; train_kl_reg_loss: 83840.1207; train_edge_recon_loss: 2831147.1212; train_gene_expr_recon_loss: 10690710.4545; train_masked_gp_l1_reg_loss: 70082.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39363.2514; train_chrom_access_recon_loss: 1869556.9905; train_global_loss: 15584700.2121; train_optim_loss: 15584700.2121; val_kl_reg_loss: 82889.6064; val_edge_recon_loss: 2851653.7500; val_gene_expr_recon_loss: 10800833.1250; val_masked_gp_l1_reg_loss: 71294.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37663.8594; val_chrom_access_recon_loss: 1884741.9062; val_global_loss: 15729076.2500; val_optim_loss: 15729076.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9141; val_auprc_score: 0.8856; val_best_acc_score: 0.8536; val_best_f1_score: 0.8628; train_kl_reg_loss: 82961.0762; train_edge_recon_loss: 2811202.5000; train_gene_expr_recon_loss: 10646634.0606; train_masked_gp_l1_reg_loss: 72263.0661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36229.2359; train_chrom_access_recon_loss: 1861322.5076; train_global_loss: 15510612.5000; train_optim_loss: 15510612.5000; val_kl_reg_loss: 82235.0713; val_edge_recon_loss: 2801423.0625; val_gene_expr_recon_loss: 10765773.3750; val_masked_gp_l1_reg_loss: 73218.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35125.9336; val_chrom_access_recon_loss: 1868471.5938; val_global_loss: 15626248.2500; val_optim_loss: 15626248.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9178; val_auprc_score: 0.8906; val_best_acc_score: 0.8565; val_best_f1_score: 0.8673; train_kl_reg_loss: 86557.4078; train_edge_recon_loss: 2781375.9280; train_gene_expr_recon_loss: 10601983.2424; train_masked_gp_l1_reg_loss: 73994.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34080.3549; train_chrom_access_recon_loss: 1855345.0625; train_global_loss: 15433336.5758; train_optim_loss: 15433336.5758; val_kl_reg_loss: 82394.6270; val_edge_recon_loss: 2833198.7500; val_gene_expr_recon_loss: 10772778.1250; val_masked_gp_l1_reg_loss: 74811.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33381.1641; val_chrom_access_recon_loss: 1863111.9531; val_global_loss: 15659676.3750; val_optim_loss: 15659676.3750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9203; val_auprc_score: 0.8874; val_best_acc_score: 0.8627; val_best_f1_score: 0.8716; train_kl_reg_loss: 86506.2786; train_edge_recon_loss: 2769692.8144; train_gene_expr_recon_loss: 10560515.5000; train_masked_gp_l1_reg_loss: 75388.1626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32592.6570; train_chrom_access_recon_loss: 1848829.1705; train_global_loss: 15373524.5909; train_optim_loss: 15373524.5909; val_kl_reg_loss: 84982.6523; val_edge_recon_loss: 2786516.5000; val_gene_expr_recon_loss: 10751180.5000; val_masked_gp_l1_reg_loss: 76023.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32159.3691; val_chrom_access_recon_loss: 1849812.9062; val_global_loss: 15580674.5000; val_optim_loss: 15580674.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9290; val_auprc_score: 0.9013; val_best_acc_score: 0.8759; val_best_f1_score: 0.8819; train_kl_reg_loss: 82417.8967; train_edge_recon_loss: 2752458.1629; train_gene_expr_recon_loss: 10526574.9848; train_masked_gp_l1_reg_loss: 76837.5133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31519.2823; train_chrom_access_recon_loss: 1842517.6477; train_global_loss: 15312325.4394; train_optim_loss: 15312325.4394; val_kl_reg_loss: 79803.1660; val_edge_recon_loss: 2775014.5625; val_gene_expr_recon_loss: 10661537.2500; val_masked_gp_l1_reg_loss: 77576.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31081.1523; val_chrom_access_recon_loss: 1850538.6719; val_global_loss: 15475551.6250; val_optim_loss: 15475551.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9333; val_auprc_score: 0.9073; val_best_acc_score: 0.8778; val_best_f1_score: 0.8843; train_kl_reg_loss: 82555.2068; train_edge_recon_loss: 2753639.4280; train_gene_expr_recon_loss: 10491164.5000; train_masked_gp_l1_reg_loss: 78220.3054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30614.7965; train_chrom_access_recon_loss: 1835491.1364; train_global_loss: 15271685.3636; train_optim_loss: 15271685.3636; val_kl_reg_loss: 79856.4619; val_edge_recon_loss: 2791550.0625; val_gene_expr_recon_loss: 10706543.7500; val_masked_gp_l1_reg_loss: 78815.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30288.4551; val_chrom_access_recon_loss: 1849986.7344; val_global_loss: 15537040.0000; val_optim_loss: 15537040.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9358; val_auprc_score: 0.9103; val_best_acc_score: 0.8794; val_best_f1_score: 0.8872; train_kl_reg_loss: 83505.2537; train_edge_recon_loss: 2740825.8826; train_gene_expr_recon_loss: 10458098.9242; train_masked_gp_l1_reg_loss: 79306.6746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29974.9886; train_chrom_access_recon_loss: 1830241.6042; train_global_loss: 15221953.4545; train_optim_loss: 15221953.4545; val_kl_reg_loss: 78990.4678; val_edge_recon_loss: 2757835.0312; val_gene_expr_recon_loss: 10563120.0000; val_masked_gp_l1_reg_loss: 79948.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29917.1074; val_chrom_access_recon_loss: 1832167.8125; val_global_loss: 15341979.2500; val_optim_loss: 15341979.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9317; val_auprc_score: 0.9029; val_best_acc_score: 0.8726; val_best_f1_score: 0.8794; train_kl_reg_loss: 79429.5026; train_edge_recon_loss: 2723258.4508; train_gene_expr_recon_loss: 10430475.6364; train_masked_gp_l1_reg_loss: 80519.8142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29458.9786; train_chrom_access_recon_loss: 1825171.9924; train_global_loss: 15168314.3788; train_optim_loss: 15168314.3788; val_kl_reg_loss: 78815.0000; val_edge_recon_loss: 2786744.1250; val_gene_expr_recon_loss: 10606407.5000; val_masked_gp_l1_reg_loss: 81347.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29293.0176; val_chrom_access_recon_loss: 1833666.8906; val_global_loss: 15416274.7500; val_optim_loss: 15416274.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9383; val_auprc_score: 0.9185; val_best_acc_score: 0.8853; val_best_f1_score: 0.8915; train_kl_reg_loss: 80546.9753; train_edge_recon_loss: 2725034.2424; train_gene_expr_recon_loss: 10406122.4091; train_masked_gp_l1_reg_loss: 81664.5502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28940.9981; train_chrom_access_recon_loss: 1822283.5682; train_global_loss: 15144592.8939; train_optim_loss: 15144592.8939; val_kl_reg_loss: 84589.3076; val_edge_recon_loss: 2726874.0625; val_gene_expr_recon_loss: 10623153.7500; val_masked_gp_l1_reg_loss: 82029.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28712.1895; val_chrom_access_recon_loss: 1820989.7031; val_global_loss: 15366348.0000; val_optim_loss: 15366348.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9453; val_auprc_score: 0.9230; val_best_acc_score: 0.8907; val_best_f1_score: 0.8966; train_kl_reg_loss: 80466.0225; train_edge_recon_loss: 2710095.2159; train_gene_expr_recon_loss: 10369706.5606; train_masked_gp_l1_reg_loss: 82397.8292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28460.2136; train_chrom_access_recon_loss: 1814787.0455; train_global_loss: 15085912.7424; train_optim_loss: 15085912.7424; val_kl_reg_loss: 77948.2090; val_edge_recon_loss: 2761931.0938; val_gene_expr_recon_loss: 10491671.7500; val_masked_gp_l1_reg_loss: 82849.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28297.0527; val_chrom_access_recon_loss: 1811990.6719; val_global_loss: 15254688.7500; val_optim_loss: 15254688.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9417; val_auprc_score: 0.9205; val_best_acc_score: 0.8850; val_best_f1_score: 0.8933; train_kl_reg_loss: 77253.5226; train_edge_recon_loss: 2712497.5038; train_gene_expr_recon_loss: 10340208.2727; train_masked_gp_l1_reg_loss: 83297.1094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28015.1232; train_chrom_access_recon_loss: 1808918.4186; train_global_loss: 15050189.9545; train_optim_loss: 15050189.9545; val_kl_reg_loss: 74638.6143; val_edge_recon_loss: 2732379.1562; val_gene_expr_recon_loss: 10529180.0000; val_masked_gp_l1_reg_loss: 83730.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27921.3535; val_chrom_access_recon_loss: 1814526.0625; val_global_loss: 15262375.8750; val_optim_loss: 15262375.8750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9444; val_auprc_score: 0.9248; val_best_acc_score: 0.8877; val_best_f1_score: 0.8925; train_kl_reg_loss: 76458.8503; train_edge_recon_loss: 2728228.5265; train_gene_expr_recon_loss: 10319248.0000; train_masked_gp_l1_reg_loss: 84109.6035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27768.1788; train_chrom_access_recon_loss: 1805859.9545; train_global_loss: 15041673.1515; train_optim_loss: 15041673.1515; val_kl_reg_loss: 77190.7812; val_edge_recon_loss: 2745996.2188; val_gene_expr_recon_loss: 10456694.6250; val_masked_gp_l1_reg_loss: 84605.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27734.4062; val_chrom_access_recon_loss: 1800611.7656; val_global_loss: 15192832.3750; val_optim_loss: 15192832.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9423; val_auprc_score: 0.9215; val_best_acc_score: 0.8850; val_best_f1_score: 0.8916; train_kl_reg_loss: 75605.1323; train_edge_recon_loss: 2702323.0076; train_gene_expr_recon_loss: 10305756.8333; train_masked_gp_l1_reg_loss: 84958.5463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27440.2282; train_chrom_access_recon_loss: 1802994.4924; train_global_loss: 14999078.2273; train_optim_loss: 14999078.2273; val_kl_reg_loss: 73362.6416; val_edge_recon_loss: 2745094.7188; val_gene_expr_recon_loss: 10493132.3750; val_masked_gp_l1_reg_loss: 85396.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27405.4512; val_chrom_access_recon_loss: 1803189.2344; val_global_loss: 15227581.0000; val_optim_loss: 15227581.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9478; val_auprc_score: 0.9314; val_best_acc_score: 0.8933; val_best_f1_score: 0.8971; train_kl_reg_loss: 74578.6523; train_edge_recon_loss: 2701980.3333; train_gene_expr_recon_loss: 10278577.3788; train_masked_gp_l1_reg_loss: 85816.3551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27322.8567; train_chrom_access_recon_loss: 1796180.3201; train_global_loss: 14964455.9545; train_optim_loss: 14964455.9545; val_kl_reg_loss: 76065.6875; val_edge_recon_loss: 2727133.2500; val_gene_expr_recon_loss: 10416072.3750; val_masked_gp_l1_reg_loss: 86114.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27199.6211; val_chrom_access_recon_loss: 1794397.2500; val_global_loss: 15126983.5000; val_optim_loss: 15126983.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9544; val_auprc_score: 0.9406; val_best_acc_score: 0.8990; val_best_f1_score: 0.9037; train_kl_reg_loss: 75302.7678; train_edge_recon_loss: 2701721.1553; train_gene_expr_recon_loss: 10255162.1061; train_masked_gp_l1_reg_loss: 86413.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27097.3291; train_chrom_access_recon_loss: 1793909.4848; train_global_loss: 14939606.5152; train_optim_loss: 14939606.5152; val_kl_reg_loss: 73081.3164; val_edge_recon_loss: 2724699.3750; val_gene_expr_recon_loss: 10446846.7500; val_masked_gp_l1_reg_loss: 86846.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27047.5352; val_chrom_access_recon_loss: 1817575.8438; val_global_loss: 15176098.3750; val_optim_loss: 15176098.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9455; val_auprc_score: 0.9248; val_best_acc_score: 0.8915; val_best_f1_score: 0.8979; train_kl_reg_loss: 74246.1136; train_edge_recon_loss: 2699108.7273; train_gene_expr_recon_loss: 10228520.4242; train_masked_gp_l1_reg_loss: 87129.8505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26925.8518; train_chrom_access_recon_loss: 1788883.5985; train_global_loss: 14904814.6061; train_optim_loss: 14904814.6061; val_kl_reg_loss: 75064.8477; val_edge_recon_loss: 2745081.1562; val_gene_expr_recon_loss: 10439113.1250; val_masked_gp_l1_reg_loss: 87458.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26983.7402; val_chrom_access_recon_loss: 1814754.9375; val_global_loss: 15188457.2500; val_optim_loss: 15188457.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9418; val_auprc_score: 0.9115; val_best_acc_score: 0.8890; val_best_f1_score: 0.8956; train_kl_reg_loss: 84840.4979; train_edge_recon_loss: 2753201.9621; train_gene_expr_recon_loss: 10087735.4242; train_masked_gp_l1_reg_loss: 86914.2857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21868.0765; train_chrom_access_recon_loss: 1762784.1420; train_global_loss: 14797344.3333; train_optim_loss: 14797344.3333; val_kl_reg_loss: 48216.4561; val_edge_recon_loss: 2762091.0625; val_gene_expr_recon_loss: 10191097.5000; val_masked_gp_l1_reg_loss: 86736.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20478.5469; val_chrom_access_recon_loss: 1752805.2656; val_global_loss: 14861425.1250; val_optim_loss: 14861425.1250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9480; val_auprc_score: 0.9297; val_best_acc_score: 0.8958; val_best_f1_score: 0.8997; train_kl_reg_loss: 80485.9012; train_edge_recon_loss: 2722998.3106; train_gene_expr_recon_loss: 10019419.0152; train_masked_gp_l1_reg_loss: 87038.8065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20375.5360; train_chrom_access_recon_loss: 1742528.7576; train_global_loss: 14672846.3485; train_optim_loss: 14672846.3485; val_kl_reg_loss: 54863.0498; val_edge_recon_loss: 2740417.9062; val_gene_expr_recon_loss: 10118157.7500; val_masked_gp_l1_reg_loss: 87402.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20395.5117; val_chrom_access_recon_loss: 1736947.0312; val_global_loss: 14758185.0000; val_optim_loss: 14758185.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9543; val_auprc_score: 0.9366; val_best_acc_score: 0.9033; val_best_f1_score: 0.9064; train_kl_reg_loss: 79157.7796; train_edge_recon_loss: 2711125.3788; train_gene_expr_recon_loss: 10002244.0606; train_masked_gp_l1_reg_loss: 87543.8668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20376.2946; train_chrom_access_recon_loss: 1738832.9489; train_global_loss: 14639280.4394; train_optim_loss: 14639280.4394; val_kl_reg_loss: 54171.2329; val_edge_recon_loss: 2721000.1250; val_gene_expr_recon_loss: 10088947.6250; val_masked_gp_l1_reg_loss: 87721.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20393.2695; val_chrom_access_recon_loss: 1746506.3438; val_global_loss: 14718740.1250; val_optim_loss: 14718740.1250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9571; val_auprc_score: 0.9401; val_best_acc_score: 0.9017; val_best_f1_score: 0.9067; train_kl_reg_loss: 75387.5343; train_edge_recon_loss: 2703943.2424; train_gene_expr_recon_loss: 9980046.1667; train_masked_gp_l1_reg_loss: 87852.1351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20445.4302; train_chrom_access_recon_loss: 1735282.5265; train_global_loss: 14602957.1364; train_optim_loss: 14602957.1364; val_kl_reg_loss: 55643.3877; val_edge_recon_loss: 2728314.2812; val_gene_expr_recon_loss: 10186818.5000; val_masked_gp_l1_reg_loss: 88130.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20543.8418; val_chrom_access_recon_loss: 1745945.8125; val_global_loss: 14825396.0000; val_optim_loss: 14825396.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9494; val_auprc_score: 0.9297; val_best_acc_score: 0.8966; val_best_f1_score: 0.9017; train_kl_reg_loss: 72288.8655; train_edge_recon_loss: 2699605.3864; train_gene_expr_recon_loss: 9947441.6061; train_masked_gp_l1_reg_loss: 88260.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20518.1669; train_chrom_access_recon_loss: 1729575.3352; train_global_loss: 14557689.8485; train_optim_loss: 14557689.8485; val_kl_reg_loss: 56863.7026; val_edge_recon_loss: 2733967.4062; val_gene_expr_recon_loss: 10188931.5000; val_masked_gp_l1_reg_loss: 88347.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20509.6504; val_chrom_access_recon_loss: 1745300.5781; val_global_loss: 14833920.7500; val_optim_loss: 14833920.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9549; val_auprc_score: 0.9374; val_best_acc_score: 0.9070; val_best_f1_score: 0.9115; train_kl_reg_loss: 68476.1664; train_edge_recon_loss: 2705189.9508; train_gene_expr_recon_loss: 9935562.2273; train_masked_gp_l1_reg_loss: 88520.6973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20554.6789; train_chrom_access_recon_loss: 1725807.4830; train_global_loss: 14544111.1818; train_optim_loss: 14544111.1818; val_kl_reg_loss: 60647.6318; val_edge_recon_loss: 2703601.5000; val_gene_expr_recon_loss: 10046063.0000; val_masked_gp_l1_reg_loss: 88705.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20606.4121; val_chrom_access_recon_loss: 1752736.4375; val_global_loss: 14672360.5000; val_optim_loss: 14672360.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9487; val_auprc_score: 0.9312; val_best_acc_score: 0.8931; val_best_f1_score: 0.8996; train_kl_reg_loss: 69193.8894; train_edge_recon_loss: 2701212.9735; train_gene_expr_recon_loss: 9914860.8030; train_masked_gp_l1_reg_loss: 88742.0927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20592.4489; train_chrom_access_recon_loss: 1725042.8580; train_global_loss: 14519645.0455; train_optim_loss: 14519645.0455; val_kl_reg_loss: 61043.8999; val_edge_recon_loss: 2768023.6875; val_gene_expr_recon_loss: 10102250.6250; val_masked_gp_l1_reg_loss: 88836.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20523.9668; val_chrom_access_recon_loss: 1732977.9375; val_global_loss: 14773656.1250; val_optim_loss: 14773656.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9550; val_auprc_score: 0.9364; val_best_acc_score: 0.9054; val_best_f1_score: 0.9099; train_kl_reg_loss: 69862.9721; train_edge_recon_loss: 2703179.2841; train_gene_expr_recon_loss: 9902317.8333; train_masked_gp_l1_reg_loss: 88858.5219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20515.3664; train_chrom_access_recon_loss: 1722396.0985; train_global_loss: 14507130.1515; train_optim_loss: 14507130.1515; val_kl_reg_loss: 58663.6777; val_edge_recon_loss: 2720570.9688; val_gene_expr_recon_loss: 9994013.5000; val_masked_gp_l1_reg_loss: 88901.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20499.2930; val_chrom_access_recon_loss: 1700216.7500; val_global_loss: 14582865.0000; val_optim_loss: 14582865.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9561; val_auprc_score: 0.9348; val_best_acc_score: 0.9033; val_best_f1_score: 0.9079; train_kl_reg_loss: 67408.6692; train_edge_recon_loss: 2696532.9432; train_gene_expr_recon_loss: 9888589.8333; train_masked_gp_l1_reg_loss: 89001.2705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20476.7827; train_chrom_access_recon_loss: 1720404.1402; train_global_loss: 14482413.4848; train_optim_loss: 14482413.4848; val_kl_reg_loss: 62132.0356; val_edge_recon_loss: 2716962.4062; val_gene_expr_recon_loss: 10084741.1250; val_masked_gp_l1_reg_loss: 89101.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20432.5410; val_chrom_access_recon_loss: 1720986.6875; val_global_loss: 14694356.2500; val_optim_loss: 14694356.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9583; val_auprc_score: 0.9384; val_best_acc_score: 0.9081; val_best_f1_score: 0.9125; train_kl_reg_loss: 67739.7846; train_edge_recon_loss: 2689222.2538; train_gene_expr_recon_loss: 9873615.1818; train_masked_gp_l1_reg_loss: 89138.7164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20430.6733; train_chrom_access_recon_loss: 1717822.4072; train_global_loss: 14457969.1515; train_optim_loss: 14457969.1515; val_kl_reg_loss: 60313.5532; val_edge_recon_loss: 2707991.6250; val_gene_expr_recon_loss: 9948429.3750; val_masked_gp_l1_reg_loss: 89246.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20380.7402; val_chrom_access_recon_loss: 1713451.5312; val_global_loss: 14539813.1250; val_optim_loss: 14539813.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9551; val_auprc_score: 0.9379; val_best_acc_score: 0.9027; val_best_f1_score: 0.9066; train_kl_reg_loss: 65600.4035; train_edge_recon_loss: 2687525.8788; train_gene_expr_recon_loss: 9858763.3788; train_masked_gp_l1_reg_loss: 89348.1243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20425.3946; train_chrom_access_recon_loss: 1714739.7765; train_global_loss: 14436402.9091; train_optim_loss: 14436402.9091; val_kl_reg_loss: 60886.0703; val_edge_recon_loss: 2701962.5000; val_gene_expr_recon_loss: 10036263.3750; val_masked_gp_l1_reg_loss: 89486.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20479.0352; val_chrom_access_recon_loss: 1725898.5625; val_global_loss: 14634975.3750; val_optim_loss: 14634975.3750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9567; val_auprc_score: 0.9404; val_best_acc_score: 0.9054; val_best_f1_score: 0.9098; train_kl_reg_loss: 63642.5895; train_edge_recon_loss: 2686793.1780; train_gene_expr_recon_loss: 9838229.6818; train_masked_gp_l1_reg_loss: 89617.9058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20465.5665; train_chrom_access_recon_loss: 1712156.1591; train_global_loss: 14410904.9848; train_optim_loss: 14410904.9848; val_kl_reg_loss: 58115.2622; val_edge_recon_loss: 2706825.5938; val_gene_expr_recon_loss: 10023518.2500; val_masked_gp_l1_reg_loss: 89840.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20417.3281; val_chrom_access_recon_loss: 1720921.2969; val_global_loss: 14619637.1250; val_optim_loss: 14619637.1250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9590; val_auprc_score: 0.9362; val_best_acc_score: 0.9146; val_best_f1_score: 0.9182; train_kl_reg_loss: 65325.7518; train_edge_recon_loss: 2680204.0076; train_gene_expr_recon_loss: 9832745.8030; train_masked_gp_l1_reg_loss: 89857.1064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20391.4534; train_chrom_access_recon_loss: 1711958.1799; train_global_loss: 14400482.4242; train_optim_loss: 14400482.4242; val_kl_reg_loss: 58817.3384; val_edge_recon_loss: 2693339.1562; val_gene_expr_recon_loss: 9989942.2500; val_masked_gp_l1_reg_loss: 90011.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20398.6270; val_chrom_access_recon_loss: 1714603.0312; val_global_loss: 14567111.7500; val_optim_loss: 14567111.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9639; val_auprc_score: 0.9468; val_best_acc_score: 0.9191; val_best_f1_score: 0.9227; train_kl_reg_loss: 64960.7256; train_edge_recon_loss: 2676666.4318; train_gene_expr_recon_loss: 9823441.2424; train_masked_gp_l1_reg_loss: 90050.4396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20362.7005; train_chrom_access_recon_loss: 1707165.5511; train_global_loss: 14382647.1212; train_optim_loss: 14382647.1212; val_kl_reg_loss: 59618.9565; val_edge_recon_loss: 2692035.3750; val_gene_expr_recon_loss: 10035729.5000; val_masked_gp_l1_reg_loss: 90124.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20425.0215; val_chrom_access_recon_loss: 1734170.3125; val_global_loss: 14632104.2500; val_optim_loss: 14632104.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9560; val_auprc_score: 0.9380; val_best_acc_score: 0.9081; val_best_f1_score: 0.9119; train_kl_reg_loss: 64025.2673; train_edge_recon_loss: 2672885.0038; train_gene_expr_recon_loss: 9797374.9848; train_masked_gp_l1_reg_loss: 89612.1125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18942.1961; train_chrom_access_recon_loss: 1702529.8504; train_global_loss: 14345369.3636; train_optim_loss: 14345369.3636; val_kl_reg_loss: 60660.5859; val_edge_recon_loss: 2710419.4375; val_gene_expr_recon_loss: 10015687.1250; val_masked_gp_l1_reg_loss: 89353.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18621.9551; val_chrom_access_recon_loss: 1723987.3438; val_global_loss: 14618729.6250; val_optim_loss: 14618729.6250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9565; val_auprc_score: 0.9386; val_best_acc_score: 0.9103; val_best_f1_score: 0.9143; train_kl_reg_loss: 64403.2338; train_edge_recon_loss: 2682885.5682; train_gene_expr_recon_loss: 9800677.8030; train_masked_gp_l1_reg_loss: 89283.7591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18578.0767; train_chrom_access_recon_loss: 1705474.5492; train_global_loss: 14361303.0152; train_optim_loss: 14361303.0152; val_kl_reg_loss: 60551.1304; val_edge_recon_loss: 2693653.7500; val_gene_expr_recon_loss: 9986220.0000; val_masked_gp_l1_reg_loss: 89240.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18542.6973; val_chrom_access_recon_loss: 1710189.4219; val_global_loss: 14558397.1250; val_optim_loss: 14558397.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9587; val_auprc_score: 0.9384; val_best_acc_score: 0.9108; val_best_f1_score: 0.9139; train_kl_reg_loss: 64394.1401; train_edge_recon_loss: 2682539.2008; train_gene_expr_recon_loss: 9797701.7576; train_masked_gp_l1_reg_loss: 89227.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18517.7080; train_chrom_access_recon_loss: 1703508.1705; train_global_loss: 14355888.6364; train_optim_loss: 14355888.6364; val_kl_reg_loss: 60767.4146; val_edge_recon_loss: 2697950.1250; val_gene_expr_recon_loss: 9983799.1250; val_masked_gp_l1_reg_loss: 89225.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18491.6289; val_chrom_access_recon_loss: 1710564.3438; val_global_loss: 14560799.0000; val_optim_loss: 14560799.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9552; val_auprc_score: 0.9383; val_best_acc_score: 0.9089; val_best_f1_score: 0.9121; train_kl_reg_loss: 64279.1881; train_edge_recon_loss: 2672184.3750; train_gene_expr_recon_loss: 9797269.8939; train_masked_gp_l1_reg_loss: 89235.3642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18473.7732; train_chrom_access_recon_loss: 1704708.9962; train_global_loss: 14346151.5909; train_optim_loss: 14346151.5909; val_kl_reg_loss: 60797.2051; val_edge_recon_loss: 2727278.6562; val_gene_expr_recon_loss: 9886903.0000; val_masked_gp_l1_reg_loss: 89233.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18453.1797; val_chrom_access_recon_loss: 1699572.3281; val_global_loss: 14482237.1250; val_optim_loss: 14482237.1250
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9543; val_auprc_score: 0.9364; val_best_acc_score: 0.9022; val_best_f1_score: 0.9069; train_kl_reg_loss: 64606.1206; train_edge_recon_loss: 2680258.9962; train_gene_expr_recon_loss: 9796823.6970; train_masked_gp_l1_reg_loss: 89243.9047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18433.2066; train_chrom_access_recon_loss: 1703812.1288; train_global_loss: 14353177.9848; train_optim_loss: 14353177.9848; val_kl_reg_loss: 60362.3755; val_edge_recon_loss: 2710867.9062; val_gene_expr_recon_loss: 10030244.2500; val_masked_gp_l1_reg_loss: 89256.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18415.8711; val_chrom_access_recon_loss: 1717226.0000; val_global_loss: 14626373.5000; val_optim_loss: 14626373.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9569; val_auprc_score: 0.9400; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 64124.4525; train_edge_recon_loss: 2677723.8826; train_gene_expr_recon_loss: 9797366.2879; train_masked_gp_l1_reg_loss: 89264.7281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18398.4368; train_chrom_access_recon_loss: 1703737.6856; train_global_loss: 14350615.3333; train_optim_loss: 14350615.3333; val_kl_reg_loss: 60411.4443; val_edge_recon_loss: 2705531.0312; val_gene_expr_recon_loss: 9904190.3750; val_masked_gp_l1_reg_loss: 89289.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18382.2305; val_chrom_access_recon_loss: 1701548.7500; val_global_loss: 14479352.6250; val_optim_loss: 14479352.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9565; val_auprc_score: 0.9361; val_best_acc_score: 0.9087; val_best_f1_score: 0.9133; train_kl_reg_loss: 64024.7754; train_edge_recon_loss: 2680912.1439; train_gene_expr_recon_loss: 9787758.5455; train_masked_gp_l1_reg_loss: 89307.6347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18368.9863; train_chrom_access_recon_loss: 1702213.6932; train_global_loss: 14342585.6667; train_optim_loss: 14342585.6667; val_kl_reg_loss: 60484.3711; val_edge_recon_loss: 2713410.0312; val_gene_expr_recon_loss: 9965930.1250; val_masked_gp_l1_reg_loss: 89323.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18350.8730; val_chrom_access_recon_loss: 1693993.3750; val_global_loss: 14541491.8750; val_optim_loss: 14541491.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9543; val_auprc_score: 0.9296; val_best_acc_score: 0.9046; val_best_f1_score: 0.9096; train_kl_reg_loss: 63998.5708; train_edge_recon_loss: 2674880.3371; train_gene_expr_recon_loss: 9791897.4242; train_masked_gp_l1_reg_loss: 89335.1076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18333.4685; train_chrom_access_recon_loss: 1703002.0644; train_global_loss: 14341447.0152; train_optim_loss: 14341447.0152; val_kl_reg_loss: 60622.5547; val_edge_recon_loss: 2732905.9062; val_gene_expr_recon_loss: 9967351.2500; val_masked_gp_l1_reg_loss: 89359.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18316.9746; val_chrom_access_recon_loss: 1701997.2031; val_global_loss: 14570554.1250; val_optim_loss: 14570554.1250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9560; val_auprc_score: 0.9365; val_best_acc_score: 0.9057; val_best_f1_score: 0.9109; train_kl_reg_loss: 64290.8973; train_edge_recon_loss: 2675379.4129; train_gene_expr_recon_loss: 9786235.2424; train_masked_gp_l1_reg_loss: 89368.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18303.2218; train_chrom_access_recon_loss: 1701499.5682; train_global_loss: 14335076.3182; train_optim_loss: 14335076.3182; val_kl_reg_loss: 60873.3823; val_edge_recon_loss: 2711805.8125; val_gene_expr_recon_loss: 10047366.6250; val_masked_gp_l1_reg_loss: 89381.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18290.8203; val_chrom_access_recon_loss: 1721880.5156; val_global_loss: 14649598.2500; val_optim_loss: 14649598.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9608; val_auprc_score: 0.9464; val_best_acc_score: 0.9095; val_best_f1_score: 0.9131; train_kl_reg_loss: 64041.2657; train_edge_recon_loss: 2665460.1061; train_gene_expr_recon_loss: 9783007.1515; train_masked_gp_l1_reg_loss: 89397.6684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18277.8674; train_chrom_access_recon_loss: 1702225.8920; train_global_loss: 14322409.9394; train_optim_loss: 14322409.9394; val_kl_reg_loss: 60340.3945; val_edge_recon_loss: 2704242.9062; val_gene_expr_recon_loss: 9965855.6250; val_masked_gp_l1_reg_loss: 89415.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18261.4434; val_chrom_access_recon_loss: 1705984.5469; val_global_loss: 14544100.2500; val_optim_loss: 14544100.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9600; val_auprc_score: 0.9476; val_best_acc_score: 0.9108; val_best_f1_score: 0.9138; train_kl_reg_loss: 64051.7866; train_edge_recon_loss: 2674064.6932; train_gene_expr_recon_loss: 9786924.0455; train_masked_gp_l1_reg_loss: 89366.8594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18102.7865; train_chrom_access_recon_loss: 1703972.8144; train_global_loss: 14336482.9697; train_optim_loss: 14336482.9697; val_kl_reg_loss: 61091.5293; val_edge_recon_loss: 2717783.7500; val_gene_expr_recon_loss: 10027338.5000; val_masked_gp_l1_reg_loss: 89340.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18072.3867; val_chrom_access_recon_loss: 1707817.9688; val_global_loss: 14621445.0000; val_optim_loss: 14621445.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9585; val_auprc_score: 0.9439; val_best_acc_score: 0.9078; val_best_f1_score: 0.9116; train_kl_reg_loss: 64181.7749; train_edge_recon_loss: 2676549.5000; train_gene_expr_recon_loss: 9779718.7273; train_masked_gp_l1_reg_loss: 89330.9834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18068.7638; train_chrom_access_recon_loss: 1701539.5095; train_global_loss: 14329389.2727; train_optim_loss: 14329389.2727; val_kl_reg_loss: 61657.6641; val_edge_recon_loss: 2692076.8750; val_gene_expr_recon_loss: 9957355.7500; val_masked_gp_l1_reg_loss: 89323.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18066.5977; val_chrom_access_recon_loss: 1721999.8438; val_global_loss: 14540480.1250; val_optim_loss: 14540480.1250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9617; val_auprc_score: 0.9482; val_best_acc_score: 0.9124; val_best_f1_score: 0.9146; train_kl_reg_loss: 64226.3093; train_edge_recon_loss: 2678429.5606; train_gene_expr_recon_loss: 9783610.8182; train_masked_gp_l1_reg_loss: 89319.8916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18063.9201; train_chrom_access_recon_loss: 1703127.4962; train_global_loss: 14336778.0606; train_optim_loss: 14336778.0606; val_kl_reg_loss: 60870.3916; val_edge_recon_loss: 2681483.6875; val_gene_expr_recon_loss: 9938566.0000; val_masked_gp_l1_reg_loss: 89316.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18061.1816; val_chrom_access_recon_loss: 1702110.6875; val_global_loss: 14490407.6250; val_optim_loss: 14490407.6250
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9595; val_auprc_score: 0.9449; val_best_acc_score: 0.9089; val_best_f1_score: 0.9135; train_kl_reg_loss: 64090.5101; train_edge_recon_loss: 2679235.3295; train_gene_expr_recon_loss: 9780167.1515; train_masked_gp_l1_reg_loss: 89315.4580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18059.6391; train_chrom_access_recon_loss: 1702272.1913; train_global_loss: 14333140.2424; train_optim_loss: 14333140.2424; val_kl_reg_loss: 60747.2769; val_edge_recon_loss: 2719369.6875; val_gene_expr_recon_loss: 9991514.2500; val_masked_gp_l1_reg_loss: 89313.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18056.5977; val_chrom_access_recon_loss: 1712754.1875; val_global_loss: 14591755.6250; val_optim_loss: 14591755.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 50 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9586
val AUPRC score: 0.9421
val best accuracy score: 0.9049
val best F1 score: 0.9096
val target rna MSE score: 1.2632
val source rna MSE score: 0.3817
val target atac MSE score: 0.3209
val source atac MSE score: 0.0713
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
