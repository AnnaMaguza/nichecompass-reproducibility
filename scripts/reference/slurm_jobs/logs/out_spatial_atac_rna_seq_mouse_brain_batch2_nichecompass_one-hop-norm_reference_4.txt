[True]
Run timestamp: 10082023_145555_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7640; val_auprc_score: 0.7826; val_best_acc_score: 0.5926; val_best_f1_score: 0.6990; train_kl_reg_loss: 97342.9125; train_edge_recon_loss: 3579484.3168; train_gene_expr_recon_loss: 15079593.4046; train_masked_gp_l1_reg_loss: 79940.1115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238990.6124; train_chrom_access_recon_loss: 11223456.9542; train_global_loss: 30298808.2901; train_optim_loss: 30298808.2901; val_kl_reg_loss: 130605.0552; val_edge_recon_loss: 4059516.5667; val_gene_expr_recon_loss: 12772383.8000; val_masked_gp_l1_reg_loss: 73195.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226039.1094; val_chrom_access_recon_loss: 10397913.7333; val_global_loss: 27659654.6667; val_optim_loss: 27659654.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8467; val_auprc_score: 0.8510; val_best_acc_score: 0.7224; val_best_f1_score: 0.7571; train_kl_reg_loss: 131781.0106; train_edge_recon_loss: 3539700.7233; train_gene_expr_recon_loss: 12651201.5267; train_masked_gp_l1_reg_loss: 70000.9983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211269.9416; train_chrom_access_recon_loss: 10329434.1298; train_global_loss: 26933388.3969; train_optim_loss: 26933388.3969; val_kl_reg_loss: 128875.9724; val_edge_recon_loss: 3997955.2333; val_gene_expr_recon_loss: 12418234.7333; val_masked_gp_l1_reg_loss: 69916.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196176.1406; val_chrom_access_recon_loss: 10256261.6667; val_global_loss: 27067420.4000; val_optim_loss: 27067420.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8684; val_auprc_score: 0.8556; val_best_acc_score: 0.7780; val_best_f1_score: 0.8018; train_kl_reg_loss: 120224.2079; train_edge_recon_loss: 3241976.7672; train_gene_expr_recon_loss: 12441778.2061; train_masked_gp_l1_reg_loss: 73328.0925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181748.4759; train_chrom_access_recon_loss: 10204981.8015; train_global_loss: 26264037.5267; train_optim_loss: 26264037.5267; val_kl_reg_loss: 152237.1542; val_edge_recon_loss: 3029441.7500; val_gene_expr_recon_loss: 12254386.9333; val_masked_gp_l1_reg_loss: 77094.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167480.8281; val_chrom_access_recon_loss: 10150411.2667; val_global_loss: 25831052.1333; val_optim_loss: 25831052.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9106; val_auprc_score: 0.8951; val_best_acc_score: 0.8288; val_best_f1_score: 0.8409; train_kl_reg_loss: 138165.6178; train_edge_recon_loss: 2943450.9561; train_gene_expr_recon_loss: 12285161.1374; train_masked_gp_l1_reg_loss: 78514.4140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154345.3104; train_chrom_access_recon_loss: 10103215.6183; train_global_loss: 25702852.9008; train_optim_loss: 25702852.9008; val_kl_reg_loss: 137825.2198; val_edge_recon_loss: 2911238.3833; val_gene_expr_recon_loss: 12147956.0667; val_masked_gp_l1_reg_loss: 80480.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141752.6094; val_chrom_access_recon_loss: 10072803.6667; val_global_loss: 25492056.4000; val_optim_loss: 25492056.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9291; val_auprc_score: 0.9102; val_best_acc_score: 0.8692; val_best_f1_score: 0.8760; train_kl_reg_loss: 133328.7440; train_edge_recon_loss: 2878348.8874; train_gene_expr_recon_loss: 12157744.3969; train_masked_gp_l1_reg_loss: 82155.8709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130789.1660; train_chrom_access_recon_loss: 10021241.6641; train_global_loss: 25403608.6870; train_optim_loss: 25403608.6870; val_kl_reg_loss: 131740.2531; val_edge_recon_loss: 2857861.8667; val_gene_expr_recon_loss: 11986262.0667; val_masked_gp_l1_reg_loss: 83899.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120557.6641; val_chrom_access_recon_loss: 9961172.3333; val_global_loss: 25141493.6000; val_optim_loss: 25141493.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9327; val_auprc_score: 0.9160; val_best_acc_score: 0.8690; val_best_f1_score: 0.8785; train_kl_reg_loss: 128385.8913; train_edge_recon_loss: 2842117.8798; train_gene_expr_recon_loss: 12043329.5573; train_masked_gp_l1_reg_loss: 85341.6451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112195.1450; train_chrom_access_recon_loss: 9953550.9695; train_global_loss: 25164921.0382; train_optim_loss: 25164921.0382; val_kl_reg_loss: 133639.7104; val_edge_recon_loss: 2842531.5500; val_gene_expr_recon_loss: 11913083.8000; val_masked_gp_l1_reg_loss: 86563.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104423.2891; val_chrom_access_recon_loss: 9923097.2000; val_global_loss: 25003339.0667; val_optim_loss: 25003339.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9408; val_auprc_score: 0.9238; val_best_acc_score: 0.8797; val_best_f1_score: 0.8877; train_kl_reg_loss: 125584.3863; train_edge_recon_loss: 2807195.8626; train_gene_expr_recon_loss: 11942372.7176; train_masked_gp_l1_reg_loss: 87840.4495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97756.3700; train_chrom_access_recon_loss: 9879745.7481; train_global_loss: 24940495.5878; train_optim_loss: 24940495.5878; val_kl_reg_loss: 120640.9380; val_edge_recon_loss: 2802298.9000; val_gene_expr_recon_loss: 11830755.0667; val_masked_gp_l1_reg_loss: 89280.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91425.1250; val_chrom_access_recon_loss: 9849918.6667; val_global_loss: 24784319.7333; val_optim_loss: 24784319.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9493; val_auprc_score: 0.9351; val_best_acc_score: 0.8887; val_best_f1_score: 0.8948; train_kl_reg_loss: 122973.7223; train_edge_recon_loss: 2787104.8531; train_gene_expr_recon_loss: 11842257.1679; train_masked_gp_l1_reg_loss: 90231.3256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86020.9658; train_chrom_access_recon_loss: 9806451.8092; train_global_loss: 24735040.0153; train_optim_loss: 24735040.0153; val_kl_reg_loss: 118403.5599; val_edge_recon_loss: 2766561.8833; val_gene_expr_recon_loss: 11740304.4667; val_masked_gp_l1_reg_loss: 91348.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80944.0469; val_chrom_access_recon_loss: 9777401.5333; val_global_loss: 24574963.4667; val_optim_loss: 24574963.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9510; val_auprc_score: 0.9386; val_best_acc_score: 0.8948; val_best_f1_score: 0.9001; train_kl_reg_loss: 118479.5052; train_edge_recon_loss: 2768406.0573; train_gene_expr_recon_loss: 11771026.5496; train_masked_gp_l1_reg_loss: 92414.1675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76550.6761; train_chrom_access_recon_loss: 9739794.0153; train_global_loss: 24566671.0229; train_optim_loss: 24566671.0229; val_kl_reg_loss: 117926.4526; val_edge_recon_loss: 2785988.9333; val_gene_expr_recon_loss: 11664920.4667; val_masked_gp_l1_reg_loss: 93463.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72419.3047; val_chrom_access_recon_loss: 9704073.2667; val_global_loss: 24438791.8667; val_optim_loss: 24438791.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9550; val_auprc_score: 0.9419; val_best_acc_score: 0.8983; val_best_f1_score: 0.9017; train_kl_reg_loss: 116085.1988; train_edge_recon_loss: 2766765.5878; train_gene_expr_recon_loss: 11705460.5420; train_masked_gp_l1_reg_loss: 94482.1223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68770.1650; train_chrom_access_recon_loss: 9692442.2977; train_global_loss: 24444005.8168; train_optim_loss: 24444005.8168; val_kl_reg_loss: 114239.2786; val_edge_recon_loss: 2766992.7833; val_gene_expr_recon_loss: 11573581.8667; val_masked_gp_l1_reg_loss: 95542.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65250.5234; val_chrom_access_recon_loss: 9622160.8000; val_global_loss: 24237767.3333; val_optim_loss: 24237767.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9556; val_auprc_score: 0.9436; val_best_acc_score: 0.9004; val_best_f1_score: 0.9051; train_kl_reg_loss: 113334.8027; train_edge_recon_loss: 2748731.7481; train_gene_expr_recon_loss: 11630835.9924; train_masked_gp_l1_reg_loss: 96428.9227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62217.1093; train_chrom_access_recon_loss: 9633172.2443; train_global_loss: 24284720.8855; train_optim_loss: 24284720.8855; val_kl_reg_loss: 115004.1167; val_edge_recon_loss: 2764880.1667; val_gene_expr_recon_loss: 11572145.9333; val_masked_gp_l1_reg_loss: 97447.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59290.2461; val_chrom_access_recon_loss: 9650884.2667; val_global_loss: 24259652.4000; val_optim_loss: 24259652.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9569; val_auprc_score: 0.9426; val_best_acc_score: 0.9020; val_best_f1_score: 0.9073; train_kl_reg_loss: 111494.9934; train_edge_recon_loss: 2747445.4332; train_gene_expr_recon_loss: 11573227.0458; train_masked_gp_l1_reg_loss: 98261.0441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56823.0568; train_chrom_access_recon_loss: 9581485.3206; train_global_loss: 24168736.7023; train_optim_loss: 24168736.7023; val_kl_reg_loss: 110391.8609; val_edge_recon_loss: 2756747.8833; val_gene_expr_recon_loss: 11468820.7333; val_masked_gp_l1_reg_loss: 99107.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54380.5781; val_chrom_access_recon_loss: 9555456.5333; val_global_loss: 24044905.6000; val_optim_loss: 24044905.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9622; val_auprc_score: 0.9490; val_best_acc_score: 0.9107; val_best_f1_score: 0.9144; train_kl_reg_loss: 108964.7972; train_edge_recon_loss: 2735548.4523; train_gene_expr_recon_loss: 11524153.8168; train_masked_gp_l1_reg_loss: 99990.7097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52284.9427; train_chrom_access_recon_loss: 9534191.2519; train_global_loss: 24055134.0611; train_optim_loss: 24055134.0611; val_kl_reg_loss: 108618.1417; val_edge_recon_loss: 2742474.7333; val_gene_expr_recon_loss: 11463052.2000; val_masked_gp_l1_reg_loss: 100846.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50290.6172; val_chrom_access_recon_loss: 9523596.1333; val_global_loss: 23988878.4000; val_optim_loss: 23988878.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9632; val_auprc_score: 0.9553; val_best_acc_score: 0.9104; val_best_f1_score: 0.9140; train_kl_reg_loss: 107636.4852; train_edge_recon_loss: 2733704.1966; train_gene_expr_recon_loss: 11473047.3969; train_masked_gp_l1_reg_loss: 101613.1837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48557.6989; train_chrom_access_recon_loss: 9495118.0916; train_global_loss: 23959676.9771; train_optim_loss: 23959676.9771; val_kl_reg_loss: 105734.8104; val_edge_recon_loss: 2756678.6333; val_gene_expr_recon_loss: 11397748.2667; val_masked_gp_l1_reg_loss: 102454.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46940.4375; val_chrom_access_recon_loss: 9459966.6667; val_global_loss: 23869522.5333; val_optim_loss: 23869522.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9673; val_auprc_score: 0.9569; val_best_acc_score: 0.9146; val_best_f1_score: 0.9177; train_kl_reg_loss: 105216.1123; train_edge_recon_loss: 2725403.3187; train_gene_expr_recon_loss: 11437282.8931; train_masked_gp_l1_reg_loss: 103206.5510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45441.8859; train_chrom_access_recon_loss: 9462016.8321; train_global_loss: 23878567.6336; train_optim_loss: 23878567.6336; val_kl_reg_loss: 106695.4771; val_edge_recon_loss: 2720230.4333; val_gene_expr_recon_loss: 11318332.1333; val_masked_gp_l1_reg_loss: 103979.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44042.7305; val_chrom_access_recon_loss: 9407983.3333; val_global_loss: 23701264.0000; val_optim_loss: 23701264.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9700; val_auprc_score: 0.9584; val_best_acc_score: 0.9198; val_best_f1_score: 0.9220; train_kl_reg_loss: 103126.9068; train_edge_recon_loss: 2723112.0019; train_gene_expr_recon_loss: 11390023.3664; train_masked_gp_l1_reg_loss: 104756.6899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42805.0924; train_chrom_access_recon_loss: 9417939.6183; train_global_loss: 23781763.6183; train_optim_loss: 23781763.6183; val_kl_reg_loss: 99986.6068; val_edge_recon_loss: 2724299.2333; val_gene_expr_recon_loss: 11312286.4667; val_masked_gp_l1_reg_loss: 105546.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41578.4336; val_chrom_access_recon_loss: 9365237.8667; val_global_loss: 23648934.9333; val_optim_loss: 23648934.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9687; val_auprc_score: 0.9593; val_best_acc_score: 0.9189; val_best_f1_score: 0.9220; train_kl_reg_loss: 101133.7202; train_edge_recon_loss: 2716504.5076; train_gene_expr_recon_loss: 11353915.1145; train_masked_gp_l1_reg_loss: 106188.9728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40552.6342; train_chrom_access_recon_loss: 9374321.5344; train_global_loss: 23692616.4733; train_optim_loss: 23692616.4733; val_kl_reg_loss: 102841.8703; val_edge_recon_loss: 2736800.7333; val_gene_expr_recon_loss: 11265149.5333; val_masked_gp_l1_reg_loss: 107081.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39604.0156; val_chrom_access_recon_loss: 9349462.0000; val_global_loss: 23600940.2667; val_optim_loss: 23600940.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9737; val_auprc_score: 0.9662; val_best_acc_score: 0.9227; val_best_f1_score: 0.9257; train_kl_reg_loss: 100402.3500; train_edge_recon_loss: 2711381.4122; train_gene_expr_recon_loss: 11326794.4962; train_masked_gp_l1_reg_loss: 107696.7113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38608.8388; train_chrom_access_recon_loss: 9346383.0916; train_global_loss: 23631266.9466; train_optim_loss: 23631266.9466; val_kl_reg_loss: 99476.3646; val_edge_recon_loss: 2710660.4833; val_gene_expr_recon_loss: 11243748.2000; val_masked_gp_l1_reg_loss: 108230.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37659.2461; val_chrom_access_recon_loss: 9323402.2000; val_global_loss: 23523177.0667; val_optim_loss: 23523177.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9726; val_auprc_score: 0.9643; val_best_acc_score: 0.9243; val_best_f1_score: 0.9267; train_kl_reg_loss: 99599.5871; train_edge_recon_loss: 2700947.3531; train_gene_expr_recon_loss: 11285263.2137; train_masked_gp_l1_reg_loss: 108905.5487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36796.8649; train_chrom_access_recon_loss: 9306952.5649; train_global_loss: 23538465.1298; train_optim_loss: 23538465.1298; val_kl_reg_loss: 98691.6938; val_edge_recon_loss: 2712484.1333; val_gene_expr_recon_loss: 11233034.1333; val_masked_gp_l1_reg_loss: 109557.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36002.3750; val_chrom_access_recon_loss: 9287160.8667; val_global_loss: 23476930.9333; val_optim_loss: 23476930.9333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9762; val_auprc_score: 0.9670; val_best_acc_score: 0.9326; val_best_f1_score: 0.9354; train_kl_reg_loss: 98233.1847; train_edge_recon_loss: 2701109.6985; train_gene_expr_recon_loss: 11258652.6641; train_masked_gp_l1_reg_loss: 110101.1897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35253.3636; train_chrom_access_recon_loss: 9276548.4962; train_global_loss: 23479898.5649; train_optim_loss: 23479898.5649; val_kl_reg_loss: 97985.7229; val_edge_recon_loss: 2714411.3833; val_gene_expr_recon_loss: 11220889.5333; val_masked_gp_l1_reg_loss: 110739.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34598.5039; val_chrom_access_recon_loss: 9298238.2667; val_global_loss: 23476864.4000; val_optim_loss: 23476864.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9765; val_auprc_score: 0.9700; val_best_acc_score: 0.9321; val_best_f1_score: 0.9342; train_kl_reg_loss: 96686.7291; train_edge_recon_loss: 2703934.8969; train_gene_expr_recon_loss: 11241137.8321; train_masked_gp_l1_reg_loss: 111273.4201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33938.2537; train_chrom_access_recon_loss: 9263653.0458; train_global_loss: 23450624.1374; train_optim_loss: 23450624.1374; val_kl_reg_loss: 96115.9859; val_edge_recon_loss: 2722488.4333; val_gene_expr_recon_loss: 11155267.1333; val_masked_gp_l1_reg_loss: 112074.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33291.1211; val_chrom_access_recon_loss: 9226026.8667; val_global_loss: 23345263.6000; val_optim_loss: 23345263.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9767; val_auprc_score: 0.9694; val_best_acc_score: 0.9368; val_best_f1_score: 0.9389; train_kl_reg_loss: 96012.5947; train_edge_recon_loss: 2697814.0076; train_gene_expr_recon_loss: 11208660.3282; train_masked_gp_l1_reg_loss: 112463.2449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32773.2528; train_chrom_access_recon_loss: 9226321.4198; train_global_loss: 23374044.7939; train_optim_loss: 23374044.7939; val_kl_reg_loss: 96855.9260; val_edge_recon_loss: 2707190.8667; val_gene_expr_recon_loss: 11155670.0000; val_masked_gp_l1_reg_loss: 113047.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32216.8203; val_chrom_access_recon_loss: 9207079.4667; val_global_loss: 23312061.0667; val_optim_loss: 23312061.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9793; val_auprc_score: 0.9748; val_best_acc_score: 0.9375; val_best_f1_score: 0.9395; train_kl_reg_loss: 95573.0165; train_edge_recon_loss: 2696848.5038; train_gene_expr_recon_loss: 11184318.1221; train_masked_gp_l1_reg_loss: 113441.4443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31790.1184; train_chrom_access_recon_loss: 9200067.3702; train_global_loss: 23322038.6260; train_optim_loss: 23322038.6260; val_kl_reg_loss: 98654.3188; val_edge_recon_loss: 2707049.3333; val_gene_expr_recon_loss: 11103542.1333; val_masked_gp_l1_reg_loss: 114084.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31402.5020; val_chrom_access_recon_loss: 9140594.9333; val_global_loss: 23195327.7333; val_optim_loss: 23195327.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9803; val_auprc_score: 0.9749; val_best_acc_score: 0.9404; val_best_f1_score: 0.9425; train_kl_reg_loss: 95352.8411; train_edge_recon_loss: 2685802.6718; train_gene_expr_recon_loss: 11162088.2519; train_masked_gp_l1_reg_loss: 114481.3111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31024.8846; train_chrom_access_recon_loss: 9177828.5153; train_global_loss: 23266578.5191; train_optim_loss: 23266578.5191; val_kl_reg_loss: 98028.8797; val_edge_recon_loss: 2695053.0167; val_gene_expr_recon_loss: 11122483.6667; val_masked_gp_l1_reg_loss: 114988.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30772.5898; val_chrom_access_recon_loss: 9179646.8000; val_global_loss: 23240973.4667; val_optim_loss: 23240973.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9803; val_auprc_score: 0.9724; val_best_acc_score: 0.9433; val_best_f1_score: 0.9449; train_kl_reg_loss: 94408.9772; train_edge_recon_loss: 2689443.5420; train_gene_expr_recon_loss: 11146769.1374; train_masked_gp_l1_reg_loss: 115482.7641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30420.5173; train_chrom_access_recon_loss: 9161027.9580; train_global_loss: 23237552.9771; train_optim_loss: 23237552.9771; val_kl_reg_loss: 92733.2411; val_edge_recon_loss: 2710032.2333; val_gene_expr_recon_loss: 11070496.0000; val_masked_gp_l1_reg_loss: 115834.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30040.9082; val_chrom_access_recon_loss: 9152250.3333; val_global_loss: 23171387.0667; val_optim_loss: 23171387.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9774; val_auprc_score: 0.9707; val_best_acc_score: 0.9361; val_best_f1_score: 0.9378; train_kl_reg_loss: 107122.4621; train_edge_recon_loss: 2745751.9828; train_gene_expr_recon_loss: 11658235.7557; train_masked_gp_l1_reg_loss: 115746.1939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27806.8855; train_chrom_access_recon_loss: 9304660.0229; train_global_loss: 23959323.3740; train_optim_loss: 23959323.3740; val_kl_reg_loss: 45116.0089; val_edge_recon_loss: 2723200.5667; val_gene_expr_recon_loss: 11582276.3333; val_masked_gp_l1_reg_loss: 115835.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26490.6992; val_chrom_access_recon_loss: 9309371.2000; val_global_loss: 23802289.8667; val_optim_loss: 23802289.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9765; val_auprc_score: 0.9699; val_best_acc_score: 0.9336; val_best_f1_score: 0.9356; train_kl_reg_loss: 87710.7529; train_edge_recon_loss: 2691829.9122; train_gene_expr_recon_loss: 11594517.7481; train_masked_gp_l1_reg_loss: 115392.3071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25725.2329; train_chrom_access_recon_loss: 9280397.2061; train_global_loss: 23795573.3130; train_optim_loss: 23795573.3130; val_kl_reg_loss: 50423.4898; val_edge_recon_loss: 2714801.2000; val_gene_expr_recon_loss: 11556855.7333; val_masked_gp_l1_reg_loss: 114879.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25114.5488; val_chrom_access_recon_loss: 9277909.0667; val_global_loss: 23739984.4000; val_optim_loss: 23739984.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9801; val_auprc_score: 0.9750; val_best_acc_score: 0.9386; val_best_f1_score: 0.9405; train_kl_reg_loss: 80096.6461; train_edge_recon_loss: 2687381.6355; train_gene_expr_recon_loss: 11553911.6870; train_masked_gp_l1_reg_loss: 114280.8969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24606.5560; train_chrom_access_recon_loss: 9257548.5115; train_global_loss: 23717825.9847; train_optim_loss: 23717825.9847; val_kl_reg_loss: 53818.0969; val_edge_recon_loss: 2690060.0333; val_gene_expr_recon_loss: 11458186.1333; val_masked_gp_l1_reg_loss: 113608.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24169.2344; val_chrom_access_recon_loss: 9221904.6000; val_global_loss: 23561746.8000; val_optim_loss: 23561746.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9799; val_auprc_score: 0.9748; val_best_acc_score: 0.9375; val_best_f1_score: 0.9395; train_kl_reg_loss: 75468.2873; train_edge_recon_loss: 2678956.9676; train_gene_expr_recon_loss: 11526791.1679; train_masked_gp_l1_reg_loss: 112857.1690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23700.3553; train_chrom_access_recon_loss: 9241304.1145; train_global_loss: 23659078.0458; train_optim_loss: 23659078.0458; val_kl_reg_loss: 56064.8419; val_edge_recon_loss: 2694045.9000; val_gene_expr_recon_loss: 11488786.0667; val_masked_gp_l1_reg_loss: 112064.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23284.7695; val_chrom_access_recon_loss: 9272211.4000; val_global_loss: 23646457.3333; val_optim_loss: 23646457.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9779; val_auprc_score: 0.9713; val_best_acc_score: 0.9342; val_best_f1_score: 0.9365; train_kl_reg_loss: 74070.1116; train_edge_recon_loss: 2677080.4542; train_gene_expr_recon_loss: 11501621.6794; train_masked_gp_l1_reg_loss: 111495.1056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23108.0124; train_chrom_access_recon_loss: 9221749.4809; train_global_loss: 23609124.9160; train_optim_loss: 23609124.9160; val_kl_reg_loss: 57895.5602; val_edge_recon_loss: 2702891.2833; val_gene_expr_recon_loss: 11438271.6667; val_masked_gp_l1_reg_loss: 111285.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23001.6484; val_chrom_access_recon_loss: 9266934.9333; val_global_loss: 23600281.3333; val_optim_loss: 23600281.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9804; val_auprc_score: 0.9747; val_best_acc_score: 0.9390; val_best_f1_score: 0.9403; train_kl_reg_loss: 74712.6438; train_edge_recon_loss: 2671914.4809; train_gene_expr_recon_loss: 11494639.4885; train_masked_gp_l1_reg_loss: 111158.8765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22922.2373; train_chrom_access_recon_loss: 9225850.2176; train_global_loss: 23601197.9237; train_optim_loss: 23601197.9237; val_kl_reg_loss: 58754.5099; val_edge_recon_loss: 2699863.0000; val_gene_expr_recon_loss: 11443130.6000; val_masked_gp_l1_reg_loss: 111034.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22846.0137; val_chrom_access_recon_loss: 9234613.7333; val_global_loss: 23570242.0000; val_optim_loss: 23570242.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9807; val_auprc_score: 0.9747; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 74246.3949; train_edge_recon_loss: 2679929.8874; train_gene_expr_recon_loss: 11499732.3893; train_masked_gp_l1_reg_loss: 110915.0768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22775.5633; train_chrom_access_recon_loss: 9222902.5382; train_global_loss: 23610501.7710; train_optim_loss: 23610501.7710; val_kl_reg_loss: 58399.9302; val_edge_recon_loss: 2678597.8667; val_gene_expr_recon_loss: 11416562.8667; val_masked_gp_l1_reg_loss: 110797.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22704.4863; val_chrom_access_recon_loss: 9232294.7333; val_global_loss: 23519356.1333; val_optim_loss: 23519356.1333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9786; val_auprc_score: 0.9695; val_best_acc_score: 0.9379; val_best_f1_score: 0.9400; train_kl_reg_loss: 74333.2164; train_edge_recon_loss: 2675928.8950; train_gene_expr_recon_loss: 11495020.6260; train_masked_gp_l1_reg_loss: 110683.4800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22637.1528; train_chrom_access_recon_loss: 9224118.4427; train_global_loss: 23602721.8931; train_optim_loss: 23602721.8931; val_kl_reg_loss: 58363.8617; val_edge_recon_loss: 2705860.1000; val_gene_expr_recon_loss: 11446891.4667; val_masked_gp_l1_reg_loss: 110572.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22566.8145; val_chrom_access_recon_loss: 9236625.6000; val_global_loss: 23580879.7333; val_optim_loss: 23580879.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 77 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9811
val AUPRC score: 0.9763
val best accuracy score: 0.9437
val best F1 score: 0.9450
val target rna MSE score: 3.0765
val source rna MSE score: 3.2435
val target atac MSE score: 0.1243
val source atac MSE score: 0.1256
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
