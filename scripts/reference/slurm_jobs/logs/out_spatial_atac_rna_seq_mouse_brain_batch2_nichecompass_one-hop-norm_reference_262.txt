[True]
Run timestamp: 07092023_044553_262.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_262']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 946 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4542, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6842; val_auprc_score: 0.6613; val_best_acc_score: 0.5263; val_best_f1_score: 0.6773; train_kl_reg_loss: 59129.5507; train_edge_recon_loss: 3538291.2992; train_gene_expr_recon_loss: 14579717.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1121254.9650; train_chrom_access_recon_loss: 5257745.1894; train_global_loss: 24556138.1818; train_optim_loss: 24556138.1818; val_kl_reg_loss: 99690.2969; val_edge_recon_loss: 4063834.0000; val_gene_expr_recon_loss: 13395513.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 849690.2500; val_chrom_access_recon_loss: 5074213.7500; val_global_loss: 23482941.5000; val_optim_loss: 23482941.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7096; val_auprc_score: 0.6896; val_best_acc_score: 0.6188; val_best_f1_score: 0.7088; train_kl_reg_loss: 108838.3709; train_edge_recon_loss: 3529017.5644; train_gene_expr_recon_loss: 13147894.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 621811.8447; train_chrom_access_recon_loss: 4980474.9848; train_global_loss: 22388037.0909; train_optim_loss: 22388037.0909; val_kl_reg_loss: 107905.2070; val_edge_recon_loss: 4058788.4688; val_gene_expr_recon_loss: 13170792.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 432093.3750; val_chrom_access_recon_loss: 5044932.8125; val_global_loss: 22814513.5000; val_optim_loss: 22814513.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7727; val_auprc_score: 0.7572; val_best_acc_score: 0.6964; val_best_f1_score: 0.7133; train_kl_reg_loss: 96953.0533; train_edge_recon_loss: 3520978.0000; train_gene_expr_recon_loss: 12953454.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 323979.7696; train_chrom_access_recon_loss: 4933876.2803; train_global_loss: 21829241.7576; train_optim_loss: 21829241.7576; val_kl_reg_loss: 100688.6279; val_edge_recon_loss: 4013958.6562; val_gene_expr_recon_loss: 12996238.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239223.4688; val_chrom_access_recon_loss: 4999875.8750; val_global_loss: 22349984.7500; val_optim_loss: 22349984.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8414; val_auprc_score: 0.8239; val_best_acc_score: 0.7622; val_best_f1_score: 0.7744; train_kl_reg_loss: 80350.3256; train_edge_recon_loss: 3476580.7652; train_gene_expr_recon_loss: 12840192.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190390.8736; train_chrom_access_recon_loss: 4906344.8182; train_global_loss: 21493859.3939; train_optim_loss: 21493859.3939; val_kl_reg_loss: 61070.3296; val_edge_recon_loss: 3647371.1875; val_gene_expr_recon_loss: 12984639.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151330.2969; val_chrom_access_recon_loss: 4976089.0000; val_global_loss: 21820499.5000; val_optim_loss: 21820499.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8489; val_auprc_score: 0.8155; val_best_acc_score: 0.7711; val_best_f1_score: 0.7906; train_kl_reg_loss: 77107.8861; train_edge_recon_loss: 3152435.0341; train_gene_expr_recon_loss: 12776887.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128223.0913; train_chrom_access_recon_loss: 4880652.6061; train_global_loss: 21015305.3939; train_optim_loss: 21015305.3939; val_kl_reg_loss: 96572.8213; val_edge_recon_loss: 3013050.4062; val_gene_expr_recon_loss: 12777097.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108557.8125; val_chrom_access_recon_loss: 4948767.6875; val_global_loss: 20944046.0000; val_optim_loss: 20944046.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8569; val_auprc_score: 0.8303; val_best_acc_score: 0.7810; val_best_f1_score: 0.8088; train_kl_reg_loss: 99859.2204; train_edge_recon_loss: 2925575.4129; train_gene_expr_recon_loss: 12691981.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94470.9386; train_chrom_access_recon_loss: 4852454.6970; train_global_loss: 20664341.8485; train_optim_loss: 20664341.8485; val_kl_reg_loss: 100401.6494; val_edge_recon_loss: 2929834.0938; val_gene_expr_recon_loss: 12765576.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82367.8125; val_chrom_access_recon_loss: 4950242.3125; val_global_loss: 20828422.5000; val_optim_loss: 20828422.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8607; val_auprc_score: 0.8267; val_best_acc_score: 0.7907; val_best_f1_score: 0.8092; train_kl_reg_loss: 98408.5246; train_edge_recon_loss: 2888232.5720; train_gene_expr_recon_loss: 12628793.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73608.2884; train_chrom_access_recon_loss: 4831448.2348; train_global_loss: 20520490.6970; train_optim_loss: 20520490.6970; val_kl_reg_loss: 100889.0205; val_edge_recon_loss: 2918241.2500; val_gene_expr_recon_loss: 12631107.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66003.6562; val_chrom_access_recon_loss: 4896402.9375; val_global_loss: 20612645.5000; val_optim_loss: 20612645.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8757; val_auprc_score: 0.8425; val_best_acc_score: 0.8047; val_best_f1_score: 0.8194; train_kl_reg_loss: 95904.4560; train_edge_recon_loss: 2870620.2424; train_gene_expr_recon_loss: 12556334.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60544.3598; train_chrom_access_recon_loss: 4811540.6667; train_global_loss: 20394944.1818; train_optim_loss: 20394944.1818; val_kl_reg_loss: 99963.2715; val_edge_recon_loss: 2920090.0938; val_gene_expr_recon_loss: 12547204.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55339.1250; val_chrom_access_recon_loss: 4901400.5000; val_global_loss: 20523997.5000; val_optim_loss: 20523997.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8597; val_auprc_score: 0.8176; val_best_acc_score: 0.7955; val_best_f1_score: 0.8144; train_kl_reg_loss: 96875.1349; train_edge_recon_loss: 2831635.6553; train_gene_expr_recon_loss: 12491337.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51671.4228; train_chrom_access_recon_loss: 4790527.3409; train_global_loss: 20262046.5758; train_optim_loss: 20262046.5758; val_kl_reg_loss: 100472.6494; val_edge_recon_loss: 2924878.7500; val_gene_expr_recon_loss: 12506776.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48557.8672; val_chrom_access_recon_loss: 4847279.9375; val_global_loss: 20427966.5000; val_optim_loss: 20427966.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8967; val_auprc_score: 0.8690; val_best_acc_score: 0.8340; val_best_f1_score: 0.8451; train_kl_reg_loss: 93190.5044; train_edge_recon_loss: 2811728.0568; train_gene_expr_recon_loss: 12446544.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45883.6606; train_chrom_access_recon_loss: 4770178.5076; train_global_loss: 20167525.1212; train_optim_loss: 20167525.1212; val_kl_reg_loss: 93026.7871; val_edge_recon_loss: 2828605.8438; val_gene_expr_recon_loss: 12493003.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43427.5938; val_chrom_access_recon_loss: 4888782.8125; val_global_loss: 20346847.0000; val_optim_loss: 20346847.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8925; val_auprc_score: 0.8533; val_best_acc_score: 0.8326; val_best_f1_score: 0.8500; train_kl_reg_loss: 91961.4357; train_edge_recon_loss: 2812716.8523; train_gene_expr_recon_loss: 12395105.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41867.4209; train_chrom_access_recon_loss: 4750977.9167; train_global_loss: 20092629.3030; train_optim_loss: 20092629.3030; val_kl_reg_loss: 92121.5303; val_edge_recon_loss: 2833083.5312; val_gene_expr_recon_loss: 12497939.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40331.1094; val_chrom_access_recon_loss: 4839380.6875; val_global_loss: 20302856.7500; val_optim_loss: 20302856.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8952; val_auprc_score: 0.8647; val_best_acc_score: 0.8340; val_best_f1_score: 0.8498; train_kl_reg_loss: 87809.5278; train_edge_recon_loss: 2793160.7273; train_gene_expr_recon_loss: 12352328.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39208.8424; train_chrom_access_recon_loss: 4733242.3788; train_global_loss: 20005750.2727; train_optim_loss: 20005750.2727; val_kl_reg_loss: 85612.2119; val_edge_recon_loss: 2852129.0938; val_gene_expr_recon_loss: 12340462.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38105.6719; val_chrom_access_recon_loss: 4789701.8750; val_global_loss: 20106012.5000; val_optim_loss: 20106012.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8998; val_auprc_score: 0.8762; val_best_acc_score: 0.8366; val_best_f1_score: 0.8505; train_kl_reg_loss: 84816.3349; train_edge_recon_loss: 2789799.1818; train_gene_expr_recon_loss: 12304709.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37412.4125; train_chrom_access_recon_loss: 4714496.0530; train_global_loss: 19931232.8788; train_optim_loss: 19931232.8788; val_kl_reg_loss: 86285.8076; val_edge_recon_loss: 2832344.1250; val_gene_expr_recon_loss: 12264144.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36851.2500; val_chrom_access_recon_loss: 4778223.7500; val_global_loss: 19997849.2500; val_optim_loss: 19997849.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8971; val_auprc_score: 0.8588; val_best_acc_score: 0.8385; val_best_f1_score: 0.8530; train_kl_reg_loss: 84438.1249; train_edge_recon_loss: 2776779.6780; train_gene_expr_recon_loss: 12266646.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36341.1048; train_chrom_access_recon_loss: 4700779.6742; train_global_loss: 19864984.9697; train_optim_loss: 19864984.9697; val_kl_reg_loss: 82505.0625; val_edge_recon_loss: 2849968.0938; val_gene_expr_recon_loss: 12376191.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36068.5273; val_chrom_access_recon_loss: 4782666.8125; val_global_loss: 20127400.0000; val_optim_loss: 20127400.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9065; val_auprc_score: 0.8736; val_best_acc_score: 0.8487; val_best_f1_score: 0.8613; train_kl_reg_loss: 82813.8452; train_edge_recon_loss: 2763413.9280; train_gene_expr_recon_loss: 12222034.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35886.9978; train_chrom_access_recon_loss: 4684856.2424; train_global_loss: 19789005.2424; train_optim_loss: 19789005.2424; val_kl_reg_loss: 83208.9053; val_edge_recon_loss: 2818251.0312; val_gene_expr_recon_loss: 12237350.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35707.8867; val_chrom_access_recon_loss: 4800133.5000; val_global_loss: 19974651.5000; val_optim_loss: 19974651.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9130; val_auprc_score: 0.8834; val_best_acc_score: 0.8498; val_best_f1_score: 0.8615; train_kl_reg_loss: 81074.1085; train_edge_recon_loss: 2760751.5379; train_gene_expr_recon_loss: 12188303.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35268.9243; train_chrom_access_recon_loss: 4673054.2727; train_global_loss: 19738452.3636; train_optim_loss: 19738452.3636; val_kl_reg_loss: 81106.3584; val_edge_recon_loss: 2806562.4062; val_gene_expr_recon_loss: 12184111.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35181.6758; val_chrom_access_recon_loss: 4715718.3750; val_global_loss: 19822680.7500; val_optim_loss: 19822680.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9163; val_auprc_score: 0.8821; val_best_acc_score: 0.8576; val_best_f1_score: 0.8682; train_kl_reg_loss: 80080.5688; train_edge_recon_loss: 2754658.9129; train_gene_expr_recon_loss: 12152079.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34872.5775; train_chrom_access_recon_loss: 4656606.7273; train_global_loss: 19678297.9697; train_optim_loss: 19678297.9697; val_kl_reg_loss: 78591.8994; val_edge_recon_loss: 2789621.5938; val_gene_expr_recon_loss: 12159585.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34653.4062; val_chrom_access_recon_loss: 4764293.1875; val_global_loss: 19826744.7500; val_optim_loss: 19826744.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9220; val_auprc_score: 0.8923; val_best_acc_score: 0.8649; val_best_f1_score: 0.8749; train_kl_reg_loss: 78960.8598; train_edge_recon_loss: 2748948.0303; train_gene_expr_recon_loss: 12123134.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34410.8877; train_chrom_access_recon_loss: 4651206.4545; train_global_loss: 19636660.8485; train_optim_loss: 19636660.8485; val_kl_reg_loss: 79536.7979; val_edge_recon_loss: 2762386.2812; val_gene_expr_recon_loss: 12231187.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34154.8359; val_chrom_access_recon_loss: 4727151.8125; val_global_loss: 19834417.2500; val_optim_loss: 19834417.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9281; val_auprc_score: 0.8963; val_best_acc_score: 0.8740; val_best_f1_score: 0.8816; train_kl_reg_loss: 78227.2881; train_edge_recon_loss: 2730595.5985; train_gene_expr_recon_loss: 12083411.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33806.7288; train_chrom_access_recon_loss: 4628802.4621; train_global_loss: 19554843.7576; train_optim_loss: 19554843.7576; val_kl_reg_loss: 80147.9336; val_edge_recon_loss: 2761768.5312; val_gene_expr_recon_loss: 12179109.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33649.6758; val_chrom_access_recon_loss: 4726754.7500; val_global_loss: 19781430.7500; val_optim_loss: 19781430.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9024; val_best_acc_score: 0.8737; val_best_f1_score: 0.8821; train_kl_reg_loss: 77244.2115; train_edge_recon_loss: 2729312.6098; train_gene_expr_recon_loss: 12051363.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33449.7262; train_chrom_access_recon_loss: 4618891.6591; train_global_loss: 19510261.8182; train_optim_loss: 19510261.8182; val_kl_reg_loss: 77276.8936; val_edge_recon_loss: 2749876.1875; val_gene_expr_recon_loss: 12149707.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33299.1719; val_chrom_access_recon_loss: 4694068.8125; val_global_loss: 19704228.0000; val_optim_loss: 19704228.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9283; val_auprc_score: 0.9012; val_best_acc_score: 0.8702; val_best_f1_score: 0.8793; train_kl_reg_loss: 75581.8821; train_edge_recon_loss: 2732020.4697; train_gene_expr_recon_loss: 12032565.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33100.8625; train_chrom_access_recon_loss: 4606493.8030; train_global_loss: 19479762.3030; train_optim_loss: 19479762.3030; val_kl_reg_loss: 77362.8994; val_edge_recon_loss: 2765330.1562; val_gene_expr_recon_loss: 12106220.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33004.3828; val_chrom_access_recon_loss: 4660581.6875; val_global_loss: 19642498.7500; val_optim_loss: 19642498.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9323; val_auprc_score: 0.9001; val_best_acc_score: 0.8791; val_best_f1_score: 0.8849; train_kl_reg_loss: 74153.8514; train_edge_recon_loss: 2721361.7689; train_gene_expr_recon_loss: 12001146.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32812.3586; train_chrom_access_recon_loss: 4598070.3864; train_global_loss: 19427544.6667; train_optim_loss: 19427544.6667; val_kl_reg_loss: 73129.4570; val_edge_recon_loss: 2718176.5000; val_gene_expr_recon_loss: 12100757.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32909.0117; val_chrom_access_recon_loss: 4668063.6875; val_global_loss: 19593036.2500; val_optim_loss: 19593036.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9343; val_auprc_score: 0.9104; val_best_acc_score: 0.8794; val_best_f1_score: 0.8874; train_kl_reg_loss: 73145.6248; train_edge_recon_loss: 2711025.1477; train_gene_expr_recon_loss: 11968806.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32686.1822; train_chrom_access_recon_loss: 4583417.5530; train_global_loss: 19369080.4848; train_optim_loss: 19369080.4848; val_kl_reg_loss: 72189.4814; val_edge_recon_loss: 2762020.6875; val_gene_expr_recon_loss: 12047474.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32510.0898; val_chrom_access_recon_loss: 4663006.3750; val_global_loss: 19577201.0000; val_optim_loss: 19577201.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9301; val_auprc_score: 0.8944; val_best_acc_score: 0.8743; val_best_f1_score: 0.8819; train_kl_reg_loss: 72421.7930; train_edge_recon_loss: 2706176.2765; train_gene_expr_recon_loss: 11960124.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32339.7244; train_chrom_access_recon_loss: 4579326.5682; train_global_loss: 19350389.3333; train_optim_loss: 19350389.3333; val_kl_reg_loss: 74041.8008; val_edge_recon_loss: 2805489.4375; val_gene_expr_recon_loss: 11813861.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32386.2363; val_chrom_access_recon_loss: 4696651.6875; val_global_loss: 19422430.7500; val_optim_loss: 19422430.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9448; val_auprc_score: 0.9191; val_best_acc_score: 0.8904; val_best_f1_score: 0.8964; train_kl_reg_loss: 72723.4157; train_edge_recon_loss: 2705168.4053; train_gene_expr_recon_loss: 11926216.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32130.9807; train_chrom_access_recon_loss: 4562935.3864; train_global_loss: 19299174.5455; train_optim_loss: 19299174.5455; val_kl_reg_loss: 72476.3076; val_edge_recon_loss: 2757944.7812; val_gene_expr_recon_loss: 11909561.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32212.7969; val_chrom_access_recon_loss: 4647427.2500; val_global_loss: 19419622.5000; val_optim_loss: 19419622.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9436; val_auprc_score: 0.9199; val_best_acc_score: 0.8882; val_best_f1_score: 0.8928; train_kl_reg_loss: 74580.2601; train_edge_recon_loss: 2728741.3144; train_gene_expr_recon_loss: 11778245.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27561.1662; train_chrom_access_recon_loss: 4536764.5038; train_global_loss: 19145892.3030; train_optim_loss: 19145892.3030; val_kl_reg_loss: 58127.3462; val_edge_recon_loss: 2757079.2812; val_gene_expr_recon_loss: 11679632.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26322.3789; val_chrom_access_recon_loss: 4598608.6875; val_global_loss: 19119770.2500; val_optim_loss: 19119770.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9495; val_auprc_score: 0.9336; val_best_acc_score: 0.8917; val_best_f1_score: 0.8967; train_kl_reg_loss: 76112.6578; train_edge_recon_loss: 2712056.0303; train_gene_expr_recon_loss: 11688150.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26237.0204; train_chrom_access_recon_loss: 4493735.9621; train_global_loss: 18996291.8485; train_optim_loss: 18996291.8485; val_kl_reg_loss: 57160.4409; val_edge_recon_loss: 2744697.7812; val_gene_expr_recon_loss: 11650111.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26164.8320; val_chrom_access_recon_loss: 4557901.8750; val_global_loss: 19036036.0000; val_optim_loss: 19036036.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9513; val_auprc_score: 0.9309; val_best_acc_score: 0.8952; val_best_f1_score: 0.8990; train_kl_reg_loss: 73261.6007; train_edge_recon_loss: 2699754.5076; train_gene_expr_recon_loss: 11666306.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26098.6633; train_chrom_access_recon_loss: 4484026.4318; train_global_loss: 18949447.4242; train_optim_loss: 18949447.4242; val_kl_reg_loss: 59141.7480; val_edge_recon_loss: 2750637.1562; val_gene_expr_recon_loss: 11758551.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26145.5527; val_chrom_access_recon_loss: 4590544.9375; val_global_loss: 19185021.0000; val_optim_loss: 19185021.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9464; val_auprc_score: 0.9239; val_best_acc_score: 0.8933; val_best_f1_score: 0.8982; train_kl_reg_loss: 70457.1741; train_edge_recon_loss: 2705774.9432; train_gene_expr_recon_loss: 11624042.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26179.7618; train_chrom_access_recon_loss: 4470813.2045; train_global_loss: 18897266.9697; train_optim_loss: 18897266.9697; val_kl_reg_loss: 58610.0918; val_edge_recon_loss: 2738894.7812; val_gene_expr_recon_loss: 11668817.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26074.1172; val_chrom_access_recon_loss: 4531431.5000; val_global_loss: 19023827.5000; val_optim_loss: 19023827.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9518; val_auprc_score: 0.9268; val_best_acc_score: 0.8990; val_best_f1_score: 0.9024; train_kl_reg_loss: 68304.7929; train_edge_recon_loss: 2697549.3788; train_gene_expr_recon_loss: 11611192.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26044.8388; train_chrom_access_recon_loss: 4461823.0758; train_global_loss: 18864914.9394; train_optim_loss: 18864914.9394; val_kl_reg_loss: 58045.8687; val_edge_recon_loss: 2737565.6875; val_gene_expr_recon_loss: 11728136.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26120.7344; val_chrom_access_recon_loss: 4555257.9375; val_global_loss: 19105127.0000; val_optim_loss: 19105127.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9512; val_auprc_score: 0.9292; val_best_acc_score: 0.9030; val_best_f1_score: 0.9066; train_kl_reg_loss: 67740.1157; train_edge_recon_loss: 2692068.2424; train_gene_expr_recon_loss: 11573881.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26142.0661; train_chrom_access_recon_loss: 4439915.1061; train_global_loss: 18799746.8485; train_optim_loss: 18799746.8485; val_kl_reg_loss: 58148.1323; val_edge_recon_loss: 2713141.6875; val_gene_expr_recon_loss: 11729479.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26014.6699; val_chrom_access_recon_loss: 4527695.5000; val_global_loss: 19054480.2500; val_optim_loss: 19054480.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9545; val_auprc_score: 0.9365; val_best_acc_score: 0.9044; val_best_f1_score: 0.9081; train_kl_reg_loss: 65142.0050; train_edge_recon_loss: 2692927.6894; train_gene_expr_recon_loss: 11552962.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26114.8477; train_chrom_access_recon_loss: 4435984.2348; train_global_loss: 18773131.5455; train_optim_loss: 18773131.5455; val_kl_reg_loss: 58549.4214; val_edge_recon_loss: 2701121.6250; val_gene_expr_recon_loss: 11561527.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26154.6074; val_chrom_access_recon_loss: 4512411.5625; val_global_loss: 18859765.2500; val_optim_loss: 18859765.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9556; val_auprc_score: 0.9410; val_best_acc_score: 0.9041; val_best_f1_score: 0.9082; train_kl_reg_loss: 64556.2475; train_edge_recon_loss: 2688493.5000; train_gene_expr_recon_loss: 11535707.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26140.0039; train_chrom_access_recon_loss: 4425236.7803; train_global_loss: 18740134.2727; train_optim_loss: 18740134.2727; val_kl_reg_loss: 60355.4951; val_edge_recon_loss: 2721706.7500; val_gene_expr_recon_loss: 11694372.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26171.5996; val_chrom_access_recon_loss: 4505624.1250; val_global_loss: 19008230.5000; val_optim_loss: 19008230.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9483; val_auprc_score: 0.9275; val_best_acc_score: 0.8963; val_best_f1_score: 0.9018; train_kl_reg_loss: 62965.1887; train_edge_recon_loss: 2687383.8939; train_gene_expr_recon_loss: 11520637.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26216.8477; train_chrom_access_recon_loss: 4423903.7273; train_global_loss: 18721107.6970; train_optim_loss: 18721107.6970; val_kl_reg_loss: 57015.6650; val_edge_recon_loss: 2722378.5312; val_gene_expr_recon_loss: 11587309.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26273.1992; val_chrom_access_recon_loss: 4564436.5000; val_global_loss: 18957412.5000; val_optim_loss: 18957412.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9560; val_auprc_score: 0.9395; val_best_acc_score: 0.9065; val_best_f1_score: 0.9098; train_kl_reg_loss: 61311.0661; train_edge_recon_loss: 2687180.2879; train_gene_expr_recon_loss: 11500518.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26275.3229; train_chrom_access_recon_loss: 4412765.7273; train_global_loss: 18688050.9697; train_optim_loss: 18688050.9697; val_kl_reg_loss: 58866.6553; val_edge_recon_loss: 2701251.7188; val_gene_expr_recon_loss: 11630663.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26247.6797; val_chrom_access_recon_loss: 4506236.1250; val_global_loss: 18923266.0000; val_optim_loss: 18923266.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9564; val_auprc_score: 0.9337; val_best_acc_score: 0.9113; val_best_f1_score: 0.9152; train_kl_reg_loss: 60907.8177; train_edge_recon_loss: 2682038.2689; train_gene_expr_recon_loss: 11478993.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26261.1250; train_chrom_access_recon_loss: 4408366.4394; train_global_loss: 18656566.9394; train_optim_loss: 18656566.9394; val_kl_reg_loss: 55132.7910; val_edge_recon_loss: 2717124.1875; val_gene_expr_recon_loss: 11578538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26336.4199; val_chrom_access_recon_loss: 4501894.7500; val_global_loss: 18879026.0000; val_optim_loss: 18879026.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9594; val_auprc_score: 0.9459; val_best_acc_score: 0.9143; val_best_f1_score: 0.9179; train_kl_reg_loss: 60122.3778; train_edge_recon_loss: 2674313.8636; train_gene_expr_recon_loss: 11465984.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24270.9581; train_chrom_access_recon_loss: 4401518.6894; train_global_loss: 18626209.9697; train_optim_loss: 18626209.9697; val_kl_reg_loss: 57394.0132; val_edge_recon_loss: 2696854.4688; val_gene_expr_recon_loss: 11506025.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23837.2734; val_chrom_access_recon_loss: 4476614.8125; val_global_loss: 18760725.2500; val_optim_loss: 18760725.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9594; val_auprc_score: 0.9422; val_best_acc_score: 0.9132; val_best_f1_score: 0.9174; train_kl_reg_loss: 61618.9049; train_edge_recon_loss: 2676012.9924; train_gene_expr_recon_loss: 11449754.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23769.8762; train_chrom_access_recon_loss: 4396584.4205; train_global_loss: 18607740.1818; train_optim_loss: 18607740.1818; val_kl_reg_loss: 58015.4893; val_edge_recon_loss: 2688394.5000; val_gene_expr_recon_loss: 11558510.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23704.5664; val_chrom_access_recon_loss: 4487567.8125; val_global_loss: 18816193.0000; val_optim_loss: 18816193.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9594; val_auprc_score: 0.9461; val_best_acc_score: 0.9062; val_best_f1_score: 0.9112; train_kl_reg_loss: 61508.5888; train_edge_recon_loss: 2674126.5189; train_gene_expr_recon_loss: 11450629.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23654.1602; train_chrom_access_recon_loss: 4397710.6061; train_global_loss: 18607629.3333; train_optim_loss: 18607629.3333; val_kl_reg_loss: 57540.3745; val_edge_recon_loss: 2685745.8438; val_gene_expr_recon_loss: 11558412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23623.1387; val_chrom_access_recon_loss: 4484741.0000; val_global_loss: 18810062.2500; val_optim_loss: 18810062.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9569; val_auprc_score: 0.9372; val_best_acc_score: 0.9089; val_best_f1_score: 0.9122; train_kl_reg_loss: 61227.4830; train_edge_recon_loss: 2666915.9621; train_gene_expr_recon_loss: 11453635.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23601.3821; train_chrom_access_recon_loss: 4400251.0530; train_global_loss: 18605631.0909; train_optim_loss: 18605631.0909; val_kl_reg_loss: 58867.4775; val_edge_recon_loss: 2711899.0000; val_gene_expr_recon_loss: 11564819.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23568.2676; val_chrom_access_recon_loss: 4498884.9375; val_global_loss: 18858038.7500; val_optim_loss: 18858038.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9532; val_auprc_score: 0.9328; val_best_acc_score: 0.9038; val_best_f1_score: 0.9080; train_kl_reg_loss: 61629.2457; train_edge_recon_loss: 2675319.7462; train_gene_expr_recon_loss: 11447903.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23541.0435; train_chrom_access_recon_loss: 4398423.6212; train_global_loss: 18606816.5758; train_optim_loss: 18606816.5758; val_kl_reg_loss: 58329.6963; val_edge_recon_loss: 2716306.0938; val_gene_expr_recon_loss: 11546522.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23520.8184; val_chrom_access_recon_loss: 4477487.5000; val_global_loss: 18822166.7500; val_optim_loss: 18822166.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9542; val_auprc_score: 0.9324; val_best_acc_score: 0.9065; val_best_f1_score: 0.9111; train_kl_reg_loss: 61804.2718; train_edge_recon_loss: 2682850.8030; train_gene_expr_recon_loss: 11440763.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23298.1883; train_chrom_access_recon_loss: 4394401.5038; train_global_loss: 18603118.6667; train_optim_loss: 18603118.6667; val_kl_reg_loss: 59177.2529; val_edge_recon_loss: 2723897.6875; val_gene_expr_recon_loss: 11643026.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23254.0625; val_chrom_access_recon_loss: 4492768.6875; val_global_loss: 18942124.5000; val_optim_loss: 18942124.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9603; val_auprc_score: 0.9430; val_best_acc_score: 0.9135; val_best_f1_score: 0.9165; train_kl_reg_loss: 61816.9850; train_edge_recon_loss: 2674126.7083; train_gene_expr_recon_loss: 11447089.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23249.0415; train_chrom_access_recon_loss: 4396259.2538; train_global_loss: 18602541.8182; train_optim_loss: 18602541.8182; val_kl_reg_loss: 58996.1636; val_edge_recon_loss: 2718485.9688; val_gene_expr_recon_loss: 11738781.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23243.7051; val_chrom_access_recon_loss: 4548528.4375; val_global_loss: 19088036.2500; val_optim_loss: 19088036.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9400; val_best_acc_score: 0.9087; val_best_f1_score: 0.9122; train_kl_reg_loss: 61711.7445; train_edge_recon_loss: 2675549.9432; train_gene_expr_recon_loss: 11441443.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23238.8028; train_chrom_access_recon_loss: 4393682.5114; train_global_loss: 18595626.3333; train_optim_loss: 18595626.3333; val_kl_reg_loss: 58517.5459; val_edge_recon_loss: 2716126.0625; val_gene_expr_recon_loss: 11545092.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23233.9355; val_chrom_access_recon_loss: 4513869.0625; val_global_loss: 18856838.7500; val_optim_loss: 18856838.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9518; val_auprc_score: 0.9326; val_best_acc_score: 0.9038; val_best_f1_score: 0.9080; train_kl_reg_loss: 61770.7618; train_edge_recon_loss: 2682560.2348; train_gene_expr_recon_loss: 11446906.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23232.1570; train_chrom_access_recon_loss: 4398739.4205; train_global_loss: 18613208.9091; train_optim_loss: 18613208.9091; val_kl_reg_loss: 58364.0640; val_edge_recon_loss: 2699352.6250; val_gene_expr_recon_loss: 11537304.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23228.4004; val_chrom_access_recon_loss: 4495014.9375; val_global_loss: 18813264.5000; val_optim_loss: 18813264.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 57 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9539
val AUPRC score: 0.9298
val best accuracy score: 0.9060
val best F1 score: 0.9102
val target rna MSE score: 0.9872
val source rna MSE score: 0.3066
val target atac MSE score: 0.4977
val source atac MSE score: 0.1066
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
