[True]
Run timestamp: 10082023_134058_1010.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1010']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7720; val_auprc_score: 0.7879; val_best_acc_score: 0.5496; val_best_f1_score: 0.6875; train_kl_reg_loss: 111512.0743; train_edge_recon_loss: 3562470.6584; train_gene_expr_recon_loss: 14374561.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2181399.1698; train_global_loss: 20229943.7863; train_optim_loss: 20229943.7863; val_kl_reg_loss: 122609.4182; val_edge_recon_loss: 4062603.7167; val_gene_expr_recon_loss: 12636426.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2018341.3750; val_global_loss: 18839980.2667; val_optim_loss: 18839980.2667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8509; val_auprc_score: 0.8487; val_best_acc_score: 0.7336; val_best_f1_score: 0.7765; train_kl_reg_loss: 124004.3046; train_edge_recon_loss: 3532450.9427; train_gene_expr_recon_loss: 12597648.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2065588.6861; train_global_loss: 18319692.7023; train_optim_loss: 18319692.7023; val_kl_reg_loss: 101625.4964; val_edge_recon_loss: 3949904.3667; val_gene_expr_recon_loss: 12345938.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1984110.4500; val_global_loss: 18381578.6667; val_optim_loss: 18381578.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9059; val_auprc_score: 0.8949; val_best_acc_score: 0.8320; val_best_f1_score: 0.8470; train_kl_reg_loss: 100612.2024; train_edge_recon_loss: 3233237.8836; train_gene_expr_recon_loss: 12429532.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2040952.5706; train_global_loss: 17804335.0534; train_optim_loss: 17804335.0534; val_kl_reg_loss: 123943.6318; val_edge_recon_loss: 2930644.5667; val_gene_expr_recon_loss: 12211084.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1962435.2083; val_global_loss: 17228108.2667; val_optim_loss: 17228108.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9194; val_auprc_score: 0.9025; val_best_acc_score: 0.8562; val_best_f1_score: 0.8660; train_kl_reg_loss: 129617.4778; train_edge_recon_loss: 2876377.5305; train_gene_expr_recon_loss: 12270209.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2018083.9046; train_global_loss: 17294288.0382; train_optim_loss: 17294288.0382; val_kl_reg_loss: 125506.8932; val_edge_recon_loss: 2871371.7833; val_gene_expr_recon_loss: 12066278.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1947181.0250; val_global_loss: 17010338.2000; val_optim_loss: 17010338.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9245; val_auprc_score: 0.9067; val_best_acc_score: 0.8623; val_best_f1_score: 0.8704; train_kl_reg_loss: 121641.8215; train_edge_recon_loss: 2844384.8588; train_gene_expr_recon_loss: 12137878.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1999634.4676; train_global_loss: 17103539.1450; train_optim_loss: 17103539.1450; val_kl_reg_loss: 120698.2427; val_edge_recon_loss: 2851137.8833; val_gene_expr_recon_loss: 11938508.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1921345.4250; val_global_loss: 16831689.3333; val_optim_loss: 16831689.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9290; val_auprc_score: 0.9129; val_best_acc_score: 0.8662; val_best_f1_score: 0.8733; train_kl_reg_loss: 116110.9383; train_edge_recon_loss: 2813768.9370; train_gene_expr_recon_loss: 12011769.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1982306.0210; train_global_loss: 16923955.0382; train_optim_loss: 16923955.0382; val_kl_reg_loss: 109628.5651; val_edge_recon_loss: 2819127.3500; val_gene_expr_recon_loss: 11768634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1904880.3833; val_global_loss: 16602270.3333; val_optim_loss: 16602270.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9337; val_auprc_score: 0.9155; val_best_acc_score: 0.8743; val_best_f1_score: 0.8824; train_kl_reg_loss: 108749.9487; train_edge_recon_loss: 2804105.9027; train_gene_expr_recon_loss: 11913720.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1966385.3263; train_global_loss: 16792962.2366; train_optim_loss: 16792962.2366; val_kl_reg_loss: 105262.7260; val_edge_recon_loss: 2792896.4000; val_gene_expr_recon_loss: 11741012.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1899498.2583; val_global_loss: 16538669.5333; val_optim_loss: 16538669.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9371; val_auprc_score: 0.9228; val_best_acc_score: 0.8735; val_best_f1_score: 0.8787; train_kl_reg_loss: 102569.5927; train_edge_recon_loss: 2797979.7137; train_gene_expr_recon_loss: 11813414.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1950006.7729; train_global_loss: 16663970.7710; train_optim_loss: 16663970.7710; val_kl_reg_loss: 95347.5141; val_edge_recon_loss: 2788749.3833; val_gene_expr_recon_loss: 11673729.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1884285.3333; val_global_loss: 16442111.6667; val_optim_loss: 16442111.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9417; val_auprc_score: 0.9251; val_best_acc_score: 0.8832; val_best_f1_score: 0.8885; train_kl_reg_loss: 97735.7920; train_edge_recon_loss: 2789599.8225; train_gene_expr_recon_loss: 11736518.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1938202.3092; train_global_loss: 16562056.4427; train_optim_loss: 16562056.4427; val_kl_reg_loss: 95553.8719; val_edge_recon_loss: 2773937.8500; val_gene_expr_recon_loss: 11653249.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1883306.0500; val_global_loss: 16406047.0000; val_optim_loss: 16406047.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9421; val_auprc_score: 0.9286; val_best_acc_score: 0.8859; val_best_f1_score: 0.8916; train_kl_reg_loss: 93246.4138; train_edge_recon_loss: 2775064.7786; train_gene_expr_recon_loss: 11678269.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1928780.1689; train_global_loss: 16475360.5802; train_optim_loss: 16475360.5802; val_kl_reg_loss: 92262.9984; val_edge_recon_loss: 2769124.4667; val_gene_expr_recon_loss: 11537874.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1868963.1750; val_global_loss: 16268225.4000; val_optim_loss: 16268225.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9383; val_auprc_score: 0.9178; val_best_acc_score: 0.8824; val_best_f1_score: 0.8894; train_kl_reg_loss: 89044.0425; train_edge_recon_loss: 2770868.5019; train_gene_expr_recon_loss: 11604638.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1915632.3502; train_global_loss: 16380183.8168; train_optim_loss: 16380183.8168; val_kl_reg_loss: 86129.9615; val_edge_recon_loss: 2780506.1167; val_gene_expr_recon_loss: 11474813.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1858170.6500; val_global_loss: 16199620.3333; val_optim_loss: 16199620.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9316; val_best_acc_score: 0.8907; val_best_f1_score: 0.8973; train_kl_reg_loss: 84808.3401; train_edge_recon_loss: 2761450.7080; train_gene_expr_recon_loss: 11550682.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1905559.6880; train_global_loss: 16302501.0687; train_optim_loss: 16302501.0687; val_kl_reg_loss: 83820.3781; val_edge_recon_loss: 2777226.4167; val_gene_expr_recon_loss: 11432290.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1852294.1250; val_global_loss: 16145631.6667; val_optim_loss: 16145631.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9499; val_auprc_score: 0.9349; val_best_acc_score: 0.8976; val_best_f1_score: 0.9025; train_kl_reg_loss: 83966.8092; train_edge_recon_loss: 2739942.3989; train_gene_expr_recon_loss: 11505221.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1900379.8760; train_global_loss: 16229510.2214; train_optim_loss: 16229510.2214; val_kl_reg_loss: 81231.0646; val_edge_recon_loss: 2753819.5500; val_gene_expr_recon_loss: 11368779.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1846608.4583; val_global_loss: 16050438.3333; val_optim_loss: 16050438.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9555; val_auprc_score: 0.9452; val_best_acc_score: 0.8972; val_best_f1_score: 0.9024; train_kl_reg_loss: 81155.4739; train_edge_recon_loss: 2737863.6050; train_gene_expr_recon_loss: 11459424.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1891984.2395; train_global_loss: 16170428.1908; train_optim_loss: 16170428.1908; val_kl_reg_loss: 78979.9500; val_edge_recon_loss: 2761351.9833; val_gene_expr_recon_loss: 11321229.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1829446.8167; val_global_loss: 15991008.6667; val_optim_loss: 15991008.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9574; val_auprc_score: 0.9463; val_best_acc_score: 0.8963; val_best_f1_score: 0.9019; train_kl_reg_loss: 80131.3903; train_edge_recon_loss: 2723543.9027; train_gene_expr_recon_loss: 11404717.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1882807.4523; train_global_loss: 16091200.0000; train_optim_loss: 16091200.0000; val_kl_reg_loss: 78248.8599; val_edge_recon_loss: 2745398.3333; val_gene_expr_recon_loss: 11313214.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1824140.0167; val_global_loss: 15961002.1333; val_optim_loss: 15961002.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9569; val_auprc_score: 0.9445; val_best_acc_score: 0.8985; val_best_f1_score: 0.9030; train_kl_reg_loss: 78015.6252; train_edge_recon_loss: 2722449.0706; train_gene_expr_recon_loss: 11371575.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1877474.7032; train_global_loss: 16049515.3282; train_optim_loss: 16049515.3282; val_kl_reg_loss: 77176.2250; val_edge_recon_loss: 2734330.4667; val_gene_expr_recon_loss: 11234870.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1812983.5417; val_global_loss: 15859360.8667; val_optim_loss: 15859360.8667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9633; val_auprc_score: 0.9535; val_best_acc_score: 0.9081; val_best_f1_score: 0.9099; train_kl_reg_loss: 76579.0094; train_edge_recon_loss: 2712444.3034; train_gene_expr_recon_loss: 11338536.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1872684.6985; train_global_loss: 16000244.5038; train_optim_loss: 16000244.5038; val_kl_reg_loss: 73940.5057; val_edge_recon_loss: 2734542.2333; val_gene_expr_recon_loss: 11210891.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1807147.7000; val_global_loss: 15826521.4667; val_optim_loss: 15826521.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9637; val_auprc_score: 0.9516; val_best_acc_score: 0.9092; val_best_f1_score: 0.9124; train_kl_reg_loss: 75189.7935; train_edge_recon_loss: 2699705.1679; train_gene_expr_recon_loss: 11298193.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1866881.2805; train_global_loss: 15939969.7176; train_optim_loss: 15939969.7176; val_kl_reg_loss: 74807.1823; val_edge_recon_loss: 2698947.7333; val_gene_expr_recon_loss: 11206931.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1805350.3583; val_global_loss: 15786036.6000; val_optim_loss: 15786036.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9676; val_auprc_score: 0.9592; val_best_acc_score: 0.9132; val_best_f1_score: 0.9166; train_kl_reg_loss: 73899.9301; train_edge_recon_loss: 2705514.8550; train_gene_expr_recon_loss: 11265768.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1861014.2185; train_global_loss: 15906197.7939; train_optim_loss: 15906197.7939; val_kl_reg_loss: 72202.7250; val_edge_recon_loss: 2700586.7667; val_gene_expr_recon_loss: 11171058.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1805203.1250; val_global_loss: 15749051.0667; val_optim_loss: 15749051.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9675; val_auprc_score: 0.9580; val_best_acc_score: 0.9143; val_best_f1_score: 0.9169; train_kl_reg_loss: 72427.6252; train_edge_recon_loss: 2695287.5744; train_gene_expr_recon_loss: 11238769.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1856295.3330; train_global_loss: 15862780.4046; train_optim_loss: 15862780.4046; val_kl_reg_loss: 73402.5875; val_edge_recon_loss: 2704350.6167; val_gene_expr_recon_loss: 11168155.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1808008.9750; val_global_loss: 15753917.6000; val_optim_loss: 15753917.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9692; val_auprc_score: 0.9599; val_best_acc_score: 0.9173; val_best_f1_score: 0.9187; train_kl_reg_loss: 70819.4181; train_edge_recon_loss: 2690975.7557; train_gene_expr_recon_loss: 11208377.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1851772.3731; train_global_loss: 15821945.4046; train_optim_loss: 15821945.4046; val_kl_reg_loss: 70684.7927; val_edge_recon_loss: 2692593.8333; val_gene_expr_recon_loss: 11085753.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1795339.0083; val_global_loss: 15644370.6000; val_optim_loss: 15644370.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9702; val_auprc_score: 0.9600; val_best_acc_score: 0.9188; val_best_f1_score: 0.9222; train_kl_reg_loss: 69587.3732; train_edge_recon_loss: 2678491.6851; train_gene_expr_recon_loss: 11183237.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1847944.9218; train_global_loss: 15779261.0534; train_optim_loss: 15779261.0534; val_kl_reg_loss: 68929.1000; val_edge_recon_loss: 2700022.8667; val_gene_expr_recon_loss: 11103172.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1790452.1083; val_global_loss: 15662575.9333; val_optim_loss: 15662575.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9717; val_auprc_score: 0.9633; val_best_acc_score: 0.9235; val_best_f1_score: 0.9257; train_kl_reg_loss: 68946.6461; train_edge_recon_loss: 2680520.1622; train_gene_expr_recon_loss: 11152885.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1843114.4380; train_global_loss: 15745467.0611; train_optim_loss: 15745467.0611; val_kl_reg_loss: 68473.9589; val_edge_recon_loss: 2690772.5667; val_gene_expr_recon_loss: 11078747.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1787684.6500; val_global_loss: 15625678.3333; val_optim_loss: 15625678.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9748; val_auprc_score: 0.9684; val_best_acc_score: 0.9250; val_best_f1_score: 0.9271; train_kl_reg_loss: 67894.4537; train_edge_recon_loss: 2676212.2576; train_gene_expr_recon_loss: 11127559.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1839851.5372; train_global_loss: 15711517.6718; train_optim_loss: 15711517.6718; val_kl_reg_loss: 67200.0703; val_edge_recon_loss: 2675942.4500; val_gene_expr_recon_loss: 11049944.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1780840.8000; val_global_loss: 15573927.5333; val_optim_loss: 15573927.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9771; val_auprc_score: 0.9705; val_best_acc_score: 0.9316; val_best_f1_score: 0.9338; train_kl_reg_loss: 66417.5505; train_edge_recon_loss: 2675295.8626; train_gene_expr_recon_loss: 11111288.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1837421.1031; train_global_loss: 15690422.5115; train_optim_loss: 15690422.5115; val_kl_reg_loss: 64783.6542; val_edge_recon_loss: 2676356.4833; val_gene_expr_recon_loss: 11053229.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1789712.7250; val_global_loss: 15584082.0000; val_optim_loss: 15584082.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9356; val_auprc_score: 0.9205; val_best_acc_score: 0.8712; val_best_f1_score: 0.8779; train_kl_reg_loss: 98739.8669; train_edge_recon_loss: 2796673.2576; train_gene_expr_recon_loss: 12147985.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1932974.3712; train_global_loss: 16976372.4962; train_optim_loss: 16976372.4962; val_kl_reg_loss: 8115.6968; val_edge_recon_loss: 2861334.8833; val_gene_expr_recon_loss: 12959643.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1921637.8333; val_global_loss: 17750731.6000; val_optim_loss: 17750731.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9394; val_auprc_score: 0.9205; val_best_acc_score: 0.8802; val_best_f1_score: 0.8850; train_kl_reg_loss: 58468.1061; train_edge_recon_loss: 2752035.6698; train_gene_expr_recon_loss: 13170747.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1979603.7090; train_global_loss: 17960854.4809; train_optim_loss: 17960854.4809; val_kl_reg_loss: 10472.1452; val_edge_recon_loss: 2747381.5500; val_gene_expr_recon_loss: 12919106.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1900382.6333; val_global_loss: 17577342.5333; val_optim_loss: 17577342.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9408; val_auprc_score: 0.9243; val_best_acc_score: 0.8822; val_best_f1_score: 0.8892; train_kl_reg_loss: 31891.5666; train_edge_recon_loss: 2731969.4351; train_gene_expr_recon_loss: 13055735.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1971387.1555; train_global_loss: 17790983.7252; train_optim_loss: 17790983.7252; val_kl_reg_loss: 14198.6026; val_edge_recon_loss: 2728348.0000; val_gene_expr_recon_loss: 12927227.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1906073.6583; val_global_loss: 17575848.5333; val_optim_loss: 17575848.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9442; val_auprc_score: 0.9273; val_best_acc_score: 0.8903; val_best_f1_score: 0.8958; train_kl_reg_loss: 29361.5657; train_edge_recon_loss: 2718476.9542; train_gene_expr_recon_loss: 12985089.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1965550.2977; train_global_loss: 17698478.4656; train_optim_loss: 17698478.4656; val_kl_reg_loss: 14480.0220; val_edge_recon_loss: 2707646.1000; val_gene_expr_recon_loss: 12847149.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1915421.3083; val_global_loss: 17484696.9333; val_optim_loss: 17484696.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9429; val_auprc_score: 0.9254; val_best_acc_score: 0.8884; val_best_f1_score: 0.8926; train_kl_reg_loss: 28224.3608; train_edge_recon_loss: 2723097.2195; train_gene_expr_recon_loss: 12987216.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1966902.7719; train_global_loss: 17705440.4275; train_optim_loss: 17705440.4275; val_kl_reg_loss: 14677.7794; val_edge_recon_loss: 2729865.9000; val_gene_expr_recon_loss: 12831065.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1903451.5917; val_global_loss: 17479060.8000; val_optim_loss: 17479060.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9401; val_auprc_score: 0.9178; val_best_acc_score: 0.8874; val_best_f1_score: 0.8920; train_kl_reg_loss: 27591.8287; train_edge_recon_loss: 2721846.7004; train_gene_expr_recon_loss: 12970019.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1965286.8559; train_global_loss: 17684745.1374; train_optim_loss: 17684745.1374; val_kl_reg_loss: 15155.6223; val_edge_recon_loss: 2736904.4333; val_gene_expr_recon_loss: 12902360.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1908247.3583; val_global_loss: 17562668.2667; val_optim_loss: 17562668.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9421; val_auprc_score: 0.9230; val_best_acc_score: 0.8867; val_best_f1_score: 0.8918; train_kl_reg_loss: 27134.7512; train_edge_recon_loss: 2724716.7538; train_gene_expr_recon_loss: 12966076.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1965507.1326; train_global_loss: 17683435.4275; train_optim_loss: 17683435.4275; val_kl_reg_loss: 15425.1022; val_edge_recon_loss: 2733094.9000; val_gene_expr_recon_loss: 12837454.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1900480.2667; val_global_loss: 17486454.5333; val_optim_loss: 17486454.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 23 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9763
val AUPRC score: 0.9711
val best accuracy score: 0.9254
val best F1 score: 0.9270
val target rna MSE score: 1.3371
val source rna MSE score: 5.3060
val target atac MSE score: 0.5541
val source atac MSE score: 0.1337
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
