[True]
Run timestamp: 10082023_191923_20.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_20']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6869; val_auprc_score: 0.7327; val_best_acc_score: 0.5028; val_best_f1_score: 0.6676; train_kl_reg_loss: 127752.1231; train_edge_recon_loss: 3675549.3969; train_gene_expr_recon_loss: 27937995.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4142489.2844; train_global_loss: 35883786.2595; train_optim_loss: 35883786.2595; val_kl_reg_loss: 128665.3844; val_edge_recon_loss: 4065184.4167; val_gene_expr_recon_loss: 23528464.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3934830.0500; val_global_loss: 31657144.6667; val_optim_loss: 31657144.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7603; val_auprc_score: 0.7768; val_best_acc_score: 0.6700; val_best_f1_score: 0.7141; train_kl_reg_loss: 159506.2742; train_edge_recon_loss: 3603415.9924; train_gene_expr_recon_loss: 23004431.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3860490.0210; train_global_loss: 30627843.3740; train_optim_loss: 30627843.3740; val_kl_reg_loss: 163356.8156; val_edge_recon_loss: 4045488.5500; val_gene_expr_recon_loss: 22269908.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3832981.1667; val_global_loss: 30311735.8667; val_optim_loss: 30311735.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8384; val_auprc_score: 0.8447; val_best_acc_score: 0.7468; val_best_f1_score: 0.7628; train_kl_reg_loss: 149801.3333; train_edge_recon_loss: 3544432.6546; train_gene_expr_recon_loss: 22256690.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3801102.8969; train_global_loss: 29752027.1450; train_optim_loss: 29752027.1450; val_kl_reg_loss: 138550.4958; val_edge_recon_loss: 3915760.8000; val_gene_expr_recon_loss: 22052903.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3824090.7500; val_global_loss: 29931305.6000; val_optim_loss: 29931305.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8443; val_auprc_score: 0.8298; val_best_acc_score: 0.7594; val_best_f1_score: 0.7858; train_kl_reg_loss: 118515.8453; train_edge_recon_loss: 3388006.8359; train_gene_expr_recon_loss: 22056954.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3782827.6622; train_global_loss: 29346305.2977; train_optim_loss: 29346305.2977; val_kl_reg_loss: 128622.3870; val_edge_recon_loss: 3206308.2167; val_gene_expr_recon_loss: 21835680.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3788585.2000; val_global_loss: 28959196.8000; val_optim_loss: 28959196.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8873; val_auprc_score: 0.8710; val_best_acc_score: 0.8017; val_best_f1_score: 0.8122; train_kl_reg_loss: 144569.7356; train_edge_recon_loss: 3056892.4599; train_gene_expr_recon_loss: 21913940.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3765238.7309; train_global_loss: 28880641.8931; train_optim_loss: 28880641.8931; val_kl_reg_loss: 147198.5938; val_edge_recon_loss: 2985101.2333; val_gene_expr_recon_loss: 21768581.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3786129.0833; val_global_loss: 28687010.0000; val_optim_loss: 28687010.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8832; val_auprc_score: 0.8639; val_best_acc_score: 0.8049; val_best_f1_score: 0.8173; train_kl_reg_loss: 151695.8782; train_edge_recon_loss: 2964674.6908; train_gene_expr_recon_loss: 21766511.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3749150.1870; train_global_loss: 28632032.0153; train_optim_loss: 28632032.0153; val_kl_reg_loss: 144079.8292; val_edge_recon_loss: 2984392.3500; val_gene_expr_recon_loss: 21620098.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3766532.5167; val_global_loss: 28515103.3333; val_optim_loss: 28515103.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9067; val_auprc_score: 0.8892; val_best_acc_score: 0.8288; val_best_f1_score: 0.8398; train_kl_reg_loss: 144640.2598; train_edge_recon_loss: 2926326.1050; train_gene_expr_recon_loss: 21638428.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3734284.0744; train_global_loss: 28443678.3969; train_optim_loss: 28443678.3969; val_kl_reg_loss: 136609.6953; val_edge_recon_loss: 2903276.3833; val_gene_expr_recon_loss: 21456858.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3744606.3333; val_global_loss: 28241350.9333; val_optim_loss: 28241350.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9098; val_auprc_score: 0.8941; val_best_acc_score: 0.8382; val_best_f1_score: 0.8494; train_kl_reg_loss: 136323.9336; train_edge_recon_loss: 2902342.0687; train_gene_expr_recon_loss: 21507957.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3717692.0210; train_global_loss: 28264315.2366; train_optim_loss: 28264315.2366; val_kl_reg_loss: 134475.8589; val_edge_recon_loss: 2885669.0167; val_gene_expr_recon_loss: 21405203.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3736844.8833; val_global_loss: 28162193.0667; val_optim_loss: 28162193.0667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9117; val_auprc_score: 0.8935; val_best_acc_score: 0.8428; val_best_f1_score: 0.8539; train_kl_reg_loss: 131584.9735; train_edge_recon_loss: 2876818.2252; train_gene_expr_recon_loss: 21397674.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3700221.0134; train_global_loss: 28106298.3817; train_optim_loss: 28106298.3817; val_kl_reg_loss: 133667.9479; val_edge_recon_loss: 2887605.3833; val_gene_expr_recon_loss: 21269877.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3722276.6333; val_global_loss: 28013427.4667; val_optim_loss: 28013427.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9211; val_auprc_score: 0.9058; val_best_acc_score: 0.8479; val_best_f1_score: 0.8569; train_kl_reg_loss: 128213.6656; train_edge_recon_loss: 2860020.9885; train_gene_expr_recon_loss: 21306484.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3689619.4924; train_global_loss: 27984338.7328; train_optim_loss: 27984338.7328; val_kl_reg_loss: 124803.2276; val_edge_recon_loss: 2865819.6000; val_gene_expr_recon_loss: 21223534.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3715996.8333; val_global_loss: 27930154.1333; val_optim_loss: 27930154.1333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9254; val_auprc_score: 0.9111; val_best_acc_score: 0.8566; val_best_f1_score: 0.8672; train_kl_reg_loss: 124495.6700; train_edge_recon_loss: 2841030.7309; train_gene_expr_recon_loss: 21230443.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3680729.4733; train_global_loss: 27876699.1908; train_optim_loss: 27876699.1908; val_kl_reg_loss: 116584.4563; val_edge_recon_loss: 2853048.9500; val_gene_expr_recon_loss: 21219752.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3711787.9333; val_global_loss: 27901174.2667; val_optim_loss: 27901174.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9277; val_auprc_score: 0.9141; val_best_acc_score: 0.8619; val_best_f1_score: 0.8698; train_kl_reg_loss: 119270.9569; train_edge_recon_loss: 2816076.3588; train_gene_expr_recon_loss: 21124683.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3666219.6240; train_global_loss: 27726250.2901; train_optim_loss: 27726250.2901; val_kl_reg_loss: 117344.2245; val_edge_recon_loss: 2825469.5833; val_gene_expr_recon_loss: 21033749.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3693391.1833; val_global_loss: 27669955.0667; val_optim_loss: 27669955.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9332; val_auprc_score: 0.9191; val_best_acc_score: 0.8650; val_best_f1_score: 0.8723; train_kl_reg_loss: 116772.9898; train_edge_recon_loss: 2805596.6183; train_gene_expr_recon_loss: 21100357.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3663711.3340; train_global_loss: 27686438.7328; train_optim_loss: 27686438.7328; val_kl_reg_loss: 117381.1490; val_edge_recon_loss: 2850408.9833; val_gene_expr_recon_loss: 20964216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3691105.8167; val_global_loss: 27623112.2667; val_optim_loss: 27623112.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9403; val_auprc_score: 0.9260; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 116483.0145; train_edge_recon_loss: 2789649.6966; train_gene_expr_recon_loss: 21047278.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3658637.1240; train_global_loss: 27612047.8626; train_optim_loss: 27612047.8626; val_kl_reg_loss: 116146.5167; val_edge_recon_loss: 2793528.5000; val_gene_expr_recon_loss: 20891845.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3668636.6333; val_global_loss: 27470157.0667; val_optim_loss: 27470157.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9440; val_auprc_score: 0.9320; val_best_acc_score: 0.8800; val_best_f1_score: 0.8856; train_kl_reg_loss: 111248.9896; train_edge_recon_loss: 2791536.5229; train_gene_expr_recon_loss: 20998285.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3649173.6641; train_global_loss: 27550244.3359; train_optim_loss: 27550244.3359; val_kl_reg_loss: 108831.2703; val_edge_recon_loss: 2798256.5333; val_gene_expr_recon_loss: 20882511.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3669857.5167; val_global_loss: 27459457.0667; val_optim_loss: 27459457.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9502; val_auprc_score: 0.9381; val_best_acc_score: 0.8898; val_best_f1_score: 0.8948; train_kl_reg_loss: 109297.3013; train_edge_recon_loss: 2775804.9790; train_gene_expr_recon_loss: 20929212.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3640594.3492; train_global_loss: 27454909.6489; train_optim_loss: 27454909.6489; val_kl_reg_loss: 106903.9453; val_edge_recon_loss: 2781104.9167; val_gene_expr_recon_loss: 20947483.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3682412.8833; val_global_loss: 27517905.0667; val_optim_loss: 27517905.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9479; val_auprc_score: 0.9362; val_best_acc_score: 0.8882; val_best_f1_score: 0.8916; train_kl_reg_loss: 106510.4061; train_edge_recon_loss: 2764699.6336; train_gene_expr_recon_loss: 20874748.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3635515.7328; train_global_loss: 27381474.1221; train_optim_loss: 27381474.1221; val_kl_reg_loss: 106351.3750; val_edge_recon_loss: 2788036.2833; val_gene_expr_recon_loss: 20827336.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3665401.1167; val_global_loss: 27387125.6000; val_optim_loss: 27387125.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9525; val_auprc_score: 0.9424; val_best_acc_score: 0.8921; val_best_f1_score: 0.8955; train_kl_reg_loss: 105200.4219; train_edge_recon_loss: 2767397.2080; train_gene_expr_recon_loss: 20859930.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3633327.2214; train_global_loss: 27365855.0992; train_optim_loss: 27365855.0992; val_kl_reg_loss: 102430.9927; val_edge_recon_loss: 2771023.6500; val_gene_expr_recon_loss: 20769148.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3655040.6667; val_global_loss: 27297643.4667; val_optim_loss: 27297643.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9579; val_auprc_score: 0.9488; val_best_acc_score: 0.9012; val_best_f1_score: 0.9044; train_kl_reg_loss: 101985.1064; train_edge_recon_loss: 2751062.9981; train_gene_expr_recon_loss: 20823957.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3629117.8359; train_global_loss: 27306123.0992; train_optim_loss: 27306123.0992; val_kl_reg_loss: 101122.7490; val_edge_recon_loss: 2759032.6000; val_gene_expr_recon_loss: 20846500.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3675559.9500; val_global_loss: 27382215.8667; val_optim_loss: 27382215.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9566; val_auprc_score: 0.9464; val_best_acc_score: 0.8999; val_best_f1_score: 0.9033; train_kl_reg_loss: 100717.3043; train_edge_recon_loss: 2743862.2653; train_gene_expr_recon_loss: 20782203.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3624054.9027; train_global_loss: 27250837.6183; train_optim_loss: 27250837.6183; val_kl_reg_loss: 100728.4693; val_edge_recon_loss: 2765803.8000; val_gene_expr_recon_loss: 20752288.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3669996.7833; val_global_loss: 27288817.7333; val_optim_loss: 27288817.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9597; val_auprc_score: 0.9494; val_best_acc_score: 0.9054; val_best_f1_score: 0.9083; train_kl_reg_loss: 97951.3526; train_edge_recon_loss: 2740984.8168; train_gene_expr_recon_loss: 20750294.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3618487.4218; train_global_loss: 27207717.7863; train_optim_loss: 27207717.7863; val_kl_reg_loss: 96283.8052; val_edge_recon_loss: 2748482.0167; val_gene_expr_recon_loss: 20666135.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3658562.8500; val_global_loss: 27169464.2667; val_optim_loss: 27169464.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9642; val_auprc_score: 0.9527; val_best_acc_score: 0.9120; val_best_f1_score: 0.9145; train_kl_reg_loss: 96045.8659; train_edge_recon_loss: 2738577.8702; train_gene_expr_recon_loss: 20733116.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3618590.6679; train_global_loss: 27186331.0229; train_optim_loss: 27186331.0229; val_kl_reg_loss: 96102.2203; val_edge_recon_loss: 2746864.7667; val_gene_expr_recon_loss: 20644931.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3641699.0667; val_global_loss: 27129597.6000; val_optim_loss: 27129597.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9642; val_auprc_score: 0.9558; val_best_acc_score: 0.9109; val_best_f1_score: 0.9143; train_kl_reg_loss: 94113.8575; train_edge_recon_loss: 2735442.4160; train_gene_expr_recon_loss: 20692826.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3615877.7615; train_global_loss: 27138260.9008; train_optim_loss: 27138260.9008; val_kl_reg_loss: 92883.5583; val_edge_recon_loss: 2744015.9500; val_gene_expr_recon_loss: 20670330.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3646133.2167; val_global_loss: 27153362.9333; val_optim_loss: 27153362.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9681; val_auprc_score: 0.9587; val_best_acc_score: 0.9200; val_best_f1_score: 0.9220; train_kl_reg_loss: 92367.4210; train_edge_recon_loss: 2726278.1412; train_gene_expr_recon_loss: 20692128.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3615100.0115; train_global_loss: 27125873.9695; train_optim_loss: 27125873.9695; val_kl_reg_loss: 90432.1995; val_edge_recon_loss: 2716382.8833; val_gene_expr_recon_loss: 20645645.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3651479.8000; val_global_loss: 27103940.0000; val_optim_loss: 27103940.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9604; val_auprc_score: 0.9481; val_best_acc_score: 0.9080; val_best_f1_score: 0.9117; train_kl_reg_loss: 90831.0103; train_edge_recon_loss: 2720312.5859; train_gene_expr_recon_loss: 20666696.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3614174.4790; train_global_loss: 27092014.3969; train_optim_loss: 27092014.3969; val_kl_reg_loss: 90235.1646; val_edge_recon_loss: 2744194.0000; val_gene_expr_recon_loss: 20656331.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3653253.0500; val_global_loss: 27144013.4667; val_optim_loss: 27144013.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9661; val_auprc_score: 0.9580; val_best_acc_score: 0.9115; val_best_f1_score: 0.9148; train_kl_reg_loss: 110047.3068; train_edge_recon_loss: 2798470.5496; train_gene_expr_recon_loss: 21791568.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3711906.6031; train_global_loss: 28411992.4122; train_optim_loss: 28411992.4122; val_kl_reg_loss: 29616.6176; val_edge_recon_loss: 2800403.1833; val_gene_expr_recon_loss: 21737464.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3730358.2333; val_global_loss: 28297842.6667; val_optim_loss: 28297842.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9610; val_auprc_score: 0.9488; val_best_acc_score: 0.9096; val_best_f1_score: 0.9125; train_kl_reg_loss: 111923.3218; train_edge_recon_loss: 2783631.9905; train_gene_expr_recon_loss: 21921537.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3703521.8779; train_global_loss: 28520615.1145; train_optim_loss: 28520615.1145; val_kl_reg_loss: 31234.5469; val_edge_recon_loss: 2776356.0000; val_gene_expr_recon_loss: 21872492.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3733822.5000; val_global_loss: 28413905.7333; val_optim_loss: 28413905.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9626; val_auprc_score: 0.9500; val_best_acc_score: 0.9148; val_best_f1_score: 0.9178; train_kl_reg_loss: 96895.3236; train_edge_recon_loss: 2767146.8187; train_gene_expr_recon_loss: 22029963.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3699898.3989; train_global_loss: 28593903.8321; train_optim_loss: 28593903.8321; val_kl_reg_loss: 32116.2190; val_edge_recon_loss: 2758286.6500; val_gene_expr_recon_loss: 22161348.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3749626.9333; val_global_loss: 28701378.6667; val_optim_loss: 28701378.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9629; val_auprc_score: 0.9510; val_best_acc_score: 0.9134; val_best_f1_score: 0.9151; train_kl_reg_loss: 94534.8562; train_edge_recon_loss: 2753516.1584; train_gene_expr_recon_loss: 22090386.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3693261.9008; train_global_loss: 28631699.8015; train_optim_loss: 28631699.8015; val_kl_reg_loss: 31318.7061; val_edge_recon_loss: 2775601.1167; val_gene_expr_recon_loss: 22026508.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3728689.0000; val_global_loss: 28562116.8000; val_optim_loss: 28562116.8000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9655; val_auprc_score: 0.9554; val_best_acc_score: 0.9167; val_best_f1_score: 0.9197; train_kl_reg_loss: 94552.0435; train_edge_recon_loss: 2759212.2958; train_gene_expr_recon_loss: 22090176.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3695284.3855; train_global_loss: 28639225.3740; train_optim_loss: 28639225.3740; val_kl_reg_loss: 31571.8914; val_edge_recon_loss: 2741757.7667; val_gene_expr_recon_loss: 22045756.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3729963.7833; val_global_loss: 28549050.1333; val_optim_loss: 28549050.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9576; val_auprc_score: 0.9430; val_best_acc_score: 0.9053; val_best_f1_score: 0.9097; train_kl_reg_loss: 94871.2164; train_edge_recon_loss: 2771573.6336; train_gene_expr_recon_loss: 22069379.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3695203.7691; train_global_loss: 28631028.2443; train_optim_loss: 28631028.2443; val_kl_reg_loss: 24870.3214; val_edge_recon_loss: 2823086.8333; val_gene_expr_recon_loss: 21959142.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3742210.9000; val_global_loss: 28549310.4000; val_optim_loss: 28549310.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9582; val_auprc_score: 0.9430; val_best_acc_score: 0.9080; val_best_f1_score: 0.9122; train_kl_reg_loss: 95539.6073; train_edge_recon_loss: 2780874.9122; train_gene_expr_recon_loss: 22045531.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3689856.3760; train_global_loss: 28611802.6870; train_optim_loss: 28611802.6870; val_kl_reg_loss: 26636.8872; val_edge_recon_loss: 2797295.5500; val_gene_expr_recon_loss: 21995128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3727349.4500; val_global_loss: 28546410.0000; val_optim_loss: 28546410.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 15 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9672
val AUPRC score: 0.9587
val best accuracy score: 0.9185
val best F1 score: 0.9216
val target rna MSE score: 1.0813
val source rna MSE score: 18.5866
val target atac MSE score: 0.5884
val source atac MSE score: 6.2924
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
