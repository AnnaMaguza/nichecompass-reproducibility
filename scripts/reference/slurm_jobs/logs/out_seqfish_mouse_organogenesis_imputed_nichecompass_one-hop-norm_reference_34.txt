[True]
Run timestamp: 01082023_073220_34.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_34']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9175; val_auprc_score: 0.9834; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 53457.2353; train_edge_recon_loss: 11703.5446; train_gene_expr_recon_loss: 54668926.7407; train_masked_gp_l1_reg_loss: 7350.9502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118508.8173; train_global_loss: 54859947.6296; train_optim_loss: 54859947.6296; val_kl_reg_loss: 172212.9609; val_edge_recon_loss: 12032.2096; val_gene_expr_recon_loss: 40913484.0000; val_masked_gp_l1_reg_loss: 8115.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109953.0469; val_global_loss: 41215796.6667; val_optim_loss: 41215796.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9033; val_auprc_score: 0.9808; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 220819.9890; train_edge_recon_loss: 11887.5608; train_gene_expr_recon_loss: 37865695.1111; train_masked_gp_l1_reg_loss: 8074.4648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103083.0271; train_global_loss: 38209560.1481; train_optim_loss: 38209560.1481; val_kl_reg_loss: 225125.2656; val_edge_recon_loss: 11794.1047; val_gene_expr_recon_loss: 34236256.6667; val_masked_gp_l1_reg_loss: 7998.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96540.7969; val_global_loss: 34577716.0000; val_optim_loss: 34577716.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8803; val_auprc_score: 0.9760; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 230085.4844; train_edge_recon_loss: 11903.5054; train_gene_expr_recon_loss: 29892008.8148; train_masked_gp_l1_reg_loss: 7915.0161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91275.0460; train_global_loss: 30233187.9630; train_optim_loss: 30233187.9630; val_kl_reg_loss: 212688.0000; val_edge_recon_loss: 12156.1546; val_gene_expr_recon_loss: 25937772.0000; val_masked_gp_l1_reg_loss: 7833.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86315.0781; val_global_loss: 26256766.0000; val_optim_loss: 26256766.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8538; val_auprc_score: 0.9705; val_best_acc_score: 0.8569; val_best_f1_score: 0.9227; train_kl_reg_loss: 208874.9838; train_edge_recon_loss: 11922.2333; train_gene_expr_recon_loss: 24104912.4444; train_masked_gp_l1_reg_loss: 7775.5463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82489.6104; train_global_loss: 24415974.7037; train_optim_loss: 24415974.7037; val_kl_reg_loss: 188329.0052; val_edge_recon_loss: 11863.8600; val_gene_expr_recon_loss: 22993211.0000; val_masked_gp_l1_reg_loss: 7729.9028; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79021.1406; val_global_loss: 23280156.0000; val_optim_loss: 23280156.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8447; val_auprc_score: 0.9678; val_best_acc_score: 0.8632; val_best_f1_score: 0.9256; train_kl_reg_loss: 183161.7185; train_edge_recon_loss: 12006.8428; train_gene_expr_recon_loss: 22525627.2963; train_masked_gp_l1_reg_loss: 7706.9578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76662.7898; train_global_loss: 22805165.5185; train_optim_loss: 22805165.5185; val_kl_reg_loss: 164958.7630; val_edge_recon_loss: 11915.8302; val_gene_expr_recon_loss: 22256413.6667; val_masked_gp_l1_reg_loss: 7697.1118; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74740.1562; val_global_loss: 22515726.0000; val_optim_loss: 22515726.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8433; val_auprc_score: 0.9675; val_best_acc_score: 0.8794; val_best_f1_score: 0.9331; train_kl_reg_loss: 161643.5535; train_edge_recon_loss: 11866.0826; train_gene_expr_recon_loss: 22045378.5185; train_masked_gp_l1_reg_loss: 7706.3668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73891.9353; train_global_loss: 22300486.5556; train_optim_loss: 22300486.5556; val_kl_reg_loss: 147515.2552; val_edge_recon_loss: 11861.4238; val_gene_expr_recon_loss: 21878036.6667; val_masked_gp_l1_reg_loss: 7724.7549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73484.6719; val_global_loss: 22118621.3333; val_optim_loss: 22118621.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8381; val_auprc_score: 0.9658; val_best_acc_score: 0.8697; val_best_f1_score: 0.9292; train_kl_reg_loss: 145865.0145; train_edge_recon_loss: 11943.4257; train_gene_expr_recon_loss: 21743388.1111; train_masked_gp_l1_reg_loss: 7751.4804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73395.7983; train_global_loss: 21982343.8148; train_optim_loss: 21982343.8148; val_kl_reg_loss: 134361.3490; val_edge_recon_loss: 11657.4388; val_gene_expr_recon_loss: 21622645.3333; val_masked_gp_l1_reg_loss: 7779.3315; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73317.9375; val_global_loss: 21849761.6667; val_optim_loss: 21849761.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8462; val_auprc_score: 0.9662; val_best_acc_score: 0.8735; val_best_f1_score: 0.9304; train_kl_reg_loss: 134166.9550; train_edge_recon_loss: 11861.7775; train_gene_expr_recon_loss: 21492825.4444; train_masked_gp_l1_reg_loss: 7802.8214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73245.3511; train_global_loss: 21719902.4074; train_optim_loss: 21719902.4074; val_kl_reg_loss: 124710.5247; val_edge_recon_loss: 12156.4222; val_gene_expr_recon_loss: 21345236.0000; val_masked_gp_l1_reg_loss: 7825.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73168.3281; val_global_loss: 21563096.6667; val_optim_loss: 21563096.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8478; val_auprc_score: 0.9661; val_best_acc_score: 0.8750; val_best_f1_score: 0.9305; train_kl_reg_loss: 125033.9556; train_edge_recon_loss: 11843.2154; train_gene_expr_recon_loss: 21276161.4074; train_masked_gp_l1_reg_loss: 7846.3587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73090.3734; train_global_loss: 21493975.2963; train_optim_loss: 21493975.2963; val_kl_reg_loss: 117310.5286; val_edge_recon_loss: 12175.4746; val_gene_expr_recon_loss: 21179996.6667; val_masked_gp_l1_reg_loss: 7869.7778; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73009.1328; val_global_loss: 21390362.6667; val_optim_loss: 21390362.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8584; val_auprc_score: 0.9696; val_best_acc_score: 0.8770; val_best_f1_score: 0.9321; train_kl_reg_loss: 117604.2393; train_edge_recon_loss: 11754.4602; train_gene_expr_recon_loss: 21085735.1852; train_masked_gp_l1_reg_loss: 7894.3212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72926.5058; train_global_loss: 21295914.8148; train_optim_loss: 21295914.8148; val_kl_reg_loss: 110657.6445; val_edge_recon_loss: 11674.8792; val_gene_expr_recon_loss: 20977779.0000; val_masked_gp_l1_reg_loss: 7921.4639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72839.4141; val_global_loss: 21180873.3333; val_optim_loss: 21180873.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8517; val_auprc_score: 0.9683; val_best_acc_score: 0.8722; val_best_f1_score: 0.9296; train_kl_reg_loss: 111432.3860; train_edge_recon_loss: 11799.0317; train_gene_expr_recon_loss: 20904515.5185; train_masked_gp_l1_reg_loss: 7946.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72751.3426; train_global_loss: 21108444.4444; train_optim_loss: 21108444.4444; val_kl_reg_loss: 104974.7786; val_edge_recon_loss: 11806.2432; val_gene_expr_recon_loss: 20819356.0000; val_masked_gp_l1_reg_loss: 7972.5854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72657.8281; val_global_loss: 21016767.0000; val_optim_loss: 21016767.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8688; val_auprc_score: 0.9719; val_best_acc_score: 0.8741; val_best_f1_score: 0.9301; train_kl_reg_loss: 106138.2066; train_edge_recon_loss: 11897.7972; train_gene_expr_recon_loss: 20735004.5926; train_masked_gp_l1_reg_loss: 7998.5105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72566.0606; train_global_loss: 20933605.0741; train_optim_loss: 20933605.0741; val_kl_reg_loss: 99814.3438; val_edge_recon_loss: 11981.6986; val_gene_expr_recon_loss: 20646282.6667; val_masked_gp_l1_reg_loss: 8027.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72469.4609; val_global_loss: 20838576.3333; val_optim_loss: 20838576.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8732; val_auprc_score: 0.9729; val_best_acc_score: 0.8766; val_best_f1_score: 0.9313; train_kl_reg_loss: 101425.0094; train_edge_recon_loss: 11673.9359; train_gene_expr_recon_loss: 20564491.2963; train_masked_gp_l1_reg_loss: 8054.7642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72376.9722; train_global_loss: 20758022.0370; train_optim_loss: 20758022.0370; val_kl_reg_loss: 95607.0221; val_edge_recon_loss: 11732.6237; val_gene_expr_recon_loss: 20483079.6667; val_masked_gp_l1_reg_loss: 8085.1802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72282.0234; val_global_loss: 20670787.0000; val_optim_loss: 20670787.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8732; val_auprc_score: 0.9728; val_best_acc_score: 0.8776; val_best_f1_score: 0.9316; train_kl_reg_loss: 97188.9725; train_edge_recon_loss: 11735.5371; train_gene_expr_recon_loss: 20408859.3704; train_masked_gp_l1_reg_loss: 8115.4098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72189.5495; train_global_loss: 20598088.8519; train_optim_loss: 20598088.8519; val_kl_reg_loss: 92064.9870; val_edge_recon_loss: 11832.0342; val_gene_expr_recon_loss: 20319626.3333; val_masked_gp_l1_reg_loss: 8148.3784; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72094.7578; val_global_loss: 20503765.3333; val_optim_loss: 20503765.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8737; val_auprc_score: 0.9729; val_best_acc_score: 0.8829; val_best_f1_score: 0.9345; train_kl_reg_loss: 93481.6662; train_edge_recon_loss: 11538.2880; train_gene_expr_recon_loss: 20247734.2222; train_masked_gp_l1_reg_loss: 8178.0727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72007.4010; train_global_loss: 20432939.7037; train_optim_loss: 20432939.7037; val_kl_reg_loss: 88749.9036; val_edge_recon_loss: 11418.7993; val_gene_expr_recon_loss: 20182257.6667; val_masked_gp_l1_reg_loss: 8211.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71920.5078; val_global_loss: 20362558.6667; val_optim_loss: 20362558.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8868; val_auprc_score: 0.9766; val_best_acc_score: 0.8805; val_best_f1_score: 0.9332; train_kl_reg_loss: 90196.3558; train_edge_recon_loss: 11648.4510; train_gene_expr_recon_loss: 20105003.7037; train_masked_gp_l1_reg_loss: 8241.2666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71838.1808; train_global_loss: 20286928.1111; train_optim_loss: 20286928.1111; val_kl_reg_loss: 85258.0703; val_edge_recon_loss: 11530.6034; val_gene_expr_recon_loss: 20036010.6667; val_masked_gp_l1_reg_loss: 8276.3496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71754.6406; val_global_loss: 20212829.3333; val_optim_loss: 20212829.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8888; val_auprc_score: 0.9769; val_best_acc_score: 0.8821; val_best_f1_score: 0.9334; train_kl_reg_loss: 87233.6926; train_edge_recon_loss: 11667.9687; train_gene_expr_recon_loss: 19955230.8519; train_masked_gp_l1_reg_loss: 8308.8990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71679.4486; train_global_loss: 20134120.8148; train_optim_loss: 20134120.8148; val_kl_reg_loss: 82605.5365; val_edge_recon_loss: 11687.4601; val_gene_expr_recon_loss: 19885076.6667; val_masked_gp_l1_reg_loss: 8341.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71602.7266; val_global_loss: 20059313.6667; val_optim_loss: 20059313.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8912; val_auprc_score: 0.9765; val_best_acc_score: 0.8831; val_best_f1_score: 0.9335; train_kl_reg_loss: 84511.9589; train_edge_recon_loss: 11601.5556; train_gene_expr_recon_loss: 19815878.6667; train_masked_gp_l1_reg_loss: 8375.1346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71524.7917; train_global_loss: 19991892.3333; train_optim_loss: 19991892.3333; val_kl_reg_loss: 80143.9635; val_edge_recon_loss: 11954.2772; val_gene_expr_recon_loss: 19725377.6667; val_masked_gp_l1_reg_loss: 8410.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71444.4375; val_global_loss: 19897330.0000; val_optim_loss: 19897330.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8948; val_auprc_score: 0.9774; val_best_acc_score: 0.8881; val_best_f1_score: 0.9364; train_kl_reg_loss: 81888.7237; train_edge_recon_loss: 11513.8515; train_gene_expr_recon_loss: 19681140.2593; train_masked_gp_l1_reg_loss: 8445.2235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71365.3859; train_global_loss: 19854353.2963; train_optim_loss: 19854353.2963; val_kl_reg_loss: 77887.1107; val_edge_recon_loss: 11589.5142; val_gene_expr_recon_loss: 19627587.3333; val_masked_gp_l1_reg_loss: 8480.4307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71280.3750; val_global_loss: 19796823.6667; val_optim_loss: 19796823.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8960; val_auprc_score: 0.9777; val_best_acc_score: 0.8882; val_best_f1_score: 0.9360; train_kl_reg_loss: 79548.9378; train_edge_recon_loss: 11550.4729; train_gene_expr_recon_loss: 19556077.1481; train_masked_gp_l1_reg_loss: 8511.7810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71194.4110; train_global_loss: 19726882.7407; train_optim_loss: 19726882.7407; val_kl_reg_loss: 75997.9206; val_edge_recon_loss: 11792.5968; val_gene_expr_recon_loss: 19469229.0000; val_masked_gp_l1_reg_loss: 8549.0967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71101.0938; val_global_loss: 19636671.6667; val_optim_loss: 19636671.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9012; val_auprc_score: 0.9793; val_best_acc_score: 0.8973; val_best_f1_score: 0.9413; train_kl_reg_loss: 77421.6916; train_edge_recon_loss: 11394.9364; train_gene_expr_recon_loss: 19435320.6296; train_masked_gp_l1_reg_loss: 8579.2204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71007.3744; train_global_loss: 19603723.6296; train_optim_loss: 19603723.6296; val_kl_reg_loss: 73545.2604; val_edge_recon_loss: 11170.1678; val_gene_expr_recon_loss: 19381518.6667; val_masked_gp_l1_reg_loss: 8610.2061; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70905.3203; val_global_loss: 19545750.3333; val_optim_loss: 19545750.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9033; val_auprc_score: 0.9807; val_best_acc_score: 0.8954; val_best_f1_score: 0.9400; train_kl_reg_loss: 75312.7073; train_edge_recon_loss: 11570.7720; train_gene_expr_recon_loss: 19317224.0741; train_masked_gp_l1_reg_loss: 8641.7859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70800.4366; train_global_loss: 19483549.6296; train_optim_loss: 19483549.6296; val_kl_reg_loss: 71654.4349; val_edge_recon_loss: 11318.7153; val_gene_expr_recon_loss: 19234780.0000; val_masked_gp_l1_reg_loss: 8677.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70687.9766; val_global_loss: 19397119.0000; val_optim_loss: 19397119.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9084; val_auprc_score: 0.9811; val_best_acc_score: 0.8962; val_best_f1_score: 0.9402; train_kl_reg_loss: 73433.2760; train_edge_recon_loss: 11547.5071; train_gene_expr_recon_loss: 19199863.3333; train_masked_gp_l1_reg_loss: 8703.1226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70575.0417; train_global_loss: 19364122.3333; train_optim_loss: 19364122.3333; val_kl_reg_loss: 70201.3815; val_edge_recon_loss: 11378.0697; val_gene_expr_recon_loss: 19135652.6667; val_masked_gp_l1_reg_loss: 8734.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70455.0312; val_global_loss: 19296422.0000; val_optim_loss: 19296422.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9035; val_auprc_score: 0.9793; val_best_acc_score: 0.8950; val_best_f1_score: 0.9393; train_kl_reg_loss: 71575.4871; train_edge_recon_loss: 11362.5558; train_gene_expr_recon_loss: 19096751.3333; train_masked_gp_l1_reg_loss: 8762.9670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70332.7876; train_global_loss: 19258784.8889; train_optim_loss: 19258784.8889; val_kl_reg_loss: 68234.8438; val_edge_recon_loss: 11500.9819; val_gene_expr_recon_loss: 19031054.6667; val_masked_gp_l1_reg_loss: 8793.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70205.1875; val_global_loss: 19189790.3333; val_optim_loss: 19189790.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9110; val_auprc_score: 0.9813; val_best_acc_score: 0.8980; val_best_f1_score: 0.9411; train_kl_reg_loss: 69871.5071; train_edge_recon_loss: 11423.0046; train_gene_expr_recon_loss: 18991516.7407; train_masked_gp_l1_reg_loss: 8820.7839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70075.8018; train_global_loss: 19151708.0370; train_optim_loss: 19151708.0370; val_kl_reg_loss: 66797.4193; val_edge_recon_loss: 11342.7920; val_gene_expr_recon_loss: 18948392.6667; val_masked_gp_l1_reg_loss: 8852.7725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69939.6953; val_global_loss: 19105325.0000; val_optim_loss: 19105325.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8880; val_auprc_score: 0.9765; val_best_acc_score: 0.8764; val_best_f1_score: 0.9295; train_kl_reg_loss: 48662.9008; train_edge_recon_loss: 11669.5217; train_gene_expr_recon_loss: 36123150.2963; train_masked_gp_l1_reg_loss: 10603.2343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69775.2990; train_global_loss: 36263861.5185; train_optim_loss: 36263861.5185; val_kl_reg_loss: 52921.5163; val_edge_recon_loss: 12157.3210; val_gene_expr_recon_loss: 31831283.3333; val_masked_gp_l1_reg_loss: 11261.5957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69593.4453; val_global_loss: 31977218.3333; val_optim_loss: 31977218.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8924; val_auprc_score: 0.9777; val_best_acc_score: 0.8844; val_best_f1_score: 0.9326; train_kl_reg_loss: 61826.0982; train_edge_recon_loss: 11734.0468; train_gene_expr_recon_loss: 29214644.3333; train_masked_gp_l1_reg_loss: 11123.7308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69412.0690; train_global_loss: 29368740.2593; train_optim_loss: 29368740.2593; val_kl_reg_loss: 61537.3978; val_edge_recon_loss: 11765.1590; val_gene_expr_recon_loss: 26820780.0000; val_masked_gp_l1_reg_loss: 10968.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69222.5859; val_global_loss: 26974272.6667; val_optim_loss: 26974272.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9030; val_auprc_score: 0.9802; val_best_acc_score: 0.8868; val_best_f1_score: 0.9357; train_kl_reg_loss: 62747.9385; train_edge_recon_loss: 11617.6698; train_gene_expr_recon_loss: 25301818.0741; train_masked_gp_l1_reg_loss: 10859.4179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69036.0137; train_global_loss: 25456079.0741; train_optim_loss: 25456079.0741; val_kl_reg_loss: 59143.7305; val_edge_recon_loss: 11670.0269; val_gene_expr_recon_loss: 23903680.3333; val_masked_gp_l1_reg_loss: 10774.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68840.8594; val_global_loss: 24054108.0000; val_optim_loss: 24054108.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9039; val_auprc_score: 0.9807; val_best_acc_score: 0.8917; val_best_f1_score: 0.9383; train_kl_reg_loss: 60257.4391; train_edge_recon_loss: 11547.7529; train_gene_expr_recon_loss: 23046259.5185; train_masked_gp_l1_reg_loss: 10721.6545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68649.5459; train_global_loss: 23197436.0370; train_optim_loss: 23197436.0370; val_kl_reg_loss: 56448.3587; val_edge_recon_loss: 11307.7360; val_gene_expr_recon_loss: 22235240.6667; val_masked_gp_l1_reg_loss: 10677.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68449.1250; val_global_loss: 22382124.6667; val_optim_loss: 22382124.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8979; val_auprc_score: 0.9780; val_best_acc_score: 0.8909; val_best_f1_score: 0.9377; train_kl_reg_loss: 58738.6076; train_edge_recon_loss: 11579.3608; train_gene_expr_recon_loss: 22207065.5185; train_masked_gp_l1_reg_loss: 10665.3253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68397.4294; train_global_loss: 22356446.3704; train_optim_loss: 22356446.3704; val_kl_reg_loss: 56331.3451; val_edge_recon_loss: 11466.8385; val_gene_expr_recon_loss: 22127967.0000; val_masked_gp_l1_reg_loss: 10657.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68370.0703; val_global_loss: 22274793.6667; val_optim_loss: 22274793.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9019; val_auprc_score: 0.9799; val_best_acc_score: 0.8878; val_best_f1_score: 0.9359; train_kl_reg_loss: 58437.1395; train_edge_recon_loss: 11427.3610; train_gene_expr_recon_loss: 22092402.8519; train_masked_gp_l1_reg_loss: 10652.4207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68349.4634; train_global_loss: 22241269.1852; train_optim_loss: 22241269.1852; val_kl_reg_loss: 55683.5241; val_edge_recon_loss: 11696.4699; val_gene_expr_recon_loss: 21983221.0000; val_masked_gp_l1_reg_loss: 10647.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68328.0938; val_global_loss: 22129576.6667; val_optim_loss: 22129576.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9000; val_auprc_score: 0.9790; val_best_acc_score: 0.8888; val_best_f1_score: 0.9362; train_kl_reg_loss: 58106.3130; train_edge_recon_loss: 11612.6733; train_gene_expr_recon_loss: 21980737.2963; train_masked_gp_l1_reg_loss: 10643.7640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68307.0532; train_global_loss: 22129407.0370; train_optim_loss: 22129407.0370; val_kl_reg_loss: 55625.0931; val_edge_recon_loss: 11829.5882; val_gene_expr_recon_loss: 21901611.6667; val_masked_gp_l1_reg_loss: 10639.4189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68285.0938; val_global_loss: 22047992.3333; val_optim_loss: 22047992.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9036; val_auprc_score: 0.9793; val_best_acc_score: 0.8879; val_best_f1_score: 0.9356; train_kl_reg_loss: 57834.5366; train_edge_recon_loss: 11661.5137; train_gene_expr_recon_loss: 21882654.6667; train_masked_gp_l1_reg_loss: 10635.7054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68263.3084; train_global_loss: 22031049.7778; train_optim_loss: 22031049.7778; val_kl_reg_loss: 55281.9245; val_edge_recon_loss: 11957.7546; val_gene_expr_recon_loss: 21822183.3333; val_masked_gp_l1_reg_loss: 10632.1348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68240.4219; val_global_loss: 21968295.0000; val_optim_loss: 21968295.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9098
val AUPRC score: 0.9813
val best accuracy score: 0.9001
val best F1 score: 0.9421
val target rna MSE score: 22.2730
val source rna MSE score: 114.8956
Val cat covariate0 mean sim diff: 0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
