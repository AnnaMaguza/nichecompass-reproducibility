[True]
Run timestamp: 07082023_221703_157.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_157']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9647; val_auprc_score: 0.9673; val_best_acc_score: 0.8758; val_best_f1_score: 0.8637; train_kl_reg_loss: 2558.6062; train_edge_recon_loss: 3466529.1389; train_gene_expr_recon_loss: 623160.2778; train_masked_gp_l1_reg_loss: 8356.7797; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265267.8594; train_global_loss: 4365872.7222; train_optim_loss: 4365872.7222; val_kl_reg_loss: 896.3368; val_edge_recon_loss: 4022666.2500; val_gene_expr_recon_loss: 616690.5625; val_masked_gp_l1_reg_loss: 5966.3018; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 264900.6562; val_global_loss: 4911120.0000; val_optim_loss: 4911120.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9301; val_auprc_score: 0.9223; val_best_acc_score: 0.8523; val_best_f1_score: 0.8590; train_kl_reg_loss: 1016.5471; train_edge_recon_loss: 3442419.1667; train_gene_expr_recon_loss: 608320.9792; train_masked_gp_l1_reg_loss: 4851.4008; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263654.6285; train_global_loss: 4320262.6667; train_optim_loss: 4320262.6667; val_kl_reg_loss: 1544.6992; val_edge_recon_loss: 3364101.2500; val_gene_expr_recon_loss: 596540.3125; val_masked_gp_l1_reg_loss: 3967.2888; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263218.1562; val_global_loss: 4229371.5000; val_optim_loss: 4229371.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9031; val_auprc_score: 0.8853; val_best_acc_score: 0.8292; val_best_f1_score: 0.8397; train_kl_reg_loss: 7847.0486; train_edge_recon_loss: 3054434.5833; train_gene_expr_recon_loss: 583538.7431; train_masked_gp_l1_reg_loss: 3953.0990; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261491.3837; train_global_loss: 3911264.8889; train_optim_loss: 3911264.8889; val_kl_reg_loss: 23092.3730; val_edge_recon_loss: 2810869.5000; val_gene_expr_recon_loss: 585520.2500; val_masked_gp_l1_reg_loss: 3995.9683; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 261685.2969; val_global_loss: 3685163.2500; val_optim_loss: 3685163.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9211; val_auprc_score: 0.8982; val_best_acc_score: 0.8575; val_best_f1_score: 0.8668; train_kl_reg_loss: 36590.7140; train_edge_recon_loss: 2762352.5278; train_gene_expr_recon_loss: 577290.4028; train_masked_gp_l1_reg_loss: 3909.0656; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261143.5608; train_global_loss: 3641286.2222; train_optim_loss: 3641286.2222; val_kl_reg_loss: 41271.2852; val_edge_recon_loss: 2748827.7500; val_gene_expr_recon_loss: 566220.7500; val_masked_gp_l1_reg_loss: 3871.7795; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259671.6094; val_global_loss: 3619863.0000; val_optim_loss: 3619863.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9272; val_auprc_score: 0.9101; val_best_acc_score: 0.8628; val_best_f1_score: 0.8719; train_kl_reg_loss: 37029.6276; train_edge_recon_loss: 2733111.8056; train_gene_expr_recon_loss: 561873.3125; train_masked_gp_l1_reg_loss: 3900.7749; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 259603.5382; train_global_loss: 3595519.1389; train_optim_loss: 3595519.1389; val_kl_reg_loss: 31337.1953; val_edge_recon_loss: 2745226.5000; val_gene_expr_recon_loss: 556277.6875; val_masked_gp_l1_reg_loss: 3944.5034; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258591.3750; val_global_loss: 3595377.5000; val_optim_loss: 3595377.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9312; val_auprc_score: 0.9109; val_best_acc_score: 0.8750; val_best_f1_score: 0.8822; train_kl_reg_loss: 31657.2205; train_edge_recon_loss: 2720122.3889; train_gene_expr_recon_loss: 551875.0833; train_masked_gp_l1_reg_loss: 4000.7719; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258176.7465; train_global_loss: 3565832.1667; train_optim_loss: 3565832.1667; val_kl_reg_loss: 32118.8828; val_edge_recon_loss: 2702354.0000; val_gene_expr_recon_loss: 543885.6250; val_masked_gp_l1_reg_loss: 4054.6543; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256870.0625; val_global_loss: 3539283.2500; val_optim_loss: 3539283.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9346; val_auprc_score: 0.9146; val_best_acc_score: 0.8742; val_best_f1_score: 0.8812; train_kl_reg_loss: 33280.3366; train_edge_recon_loss: 2716880.2222; train_gene_expr_recon_loss: 538878.0833; train_masked_gp_l1_reg_loss: 4095.4142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257460.0087; train_global_loss: 3550594.0278; train_optim_loss: 3550594.0278; val_kl_reg_loss: 31894.6289; val_edge_recon_loss: 2731391.2500; val_gene_expr_recon_loss: 533817.2500; val_masked_gp_l1_reg_loss: 4142.1855; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255810.2969; val_global_loss: 3557055.7500; val_optim_loss: 3557055.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9404; val_auprc_score: 0.9245; val_best_acc_score: 0.8814; val_best_f1_score: 0.8873; train_kl_reg_loss: 31459.0007; train_edge_recon_loss: 2711440.5833; train_gene_expr_recon_loss: 531878.3472; train_masked_gp_l1_reg_loss: 4201.6075; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256043.5156; train_global_loss: 3535023.0556; train_optim_loss: 3535023.0556; val_kl_reg_loss: 30459.8516; val_edge_recon_loss: 2715533.5000; val_gene_expr_recon_loss: 524784.0000; val_masked_gp_l1_reg_loss: 4275.0625; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254700.5625; val_global_loss: 3529752.7500; val_optim_loss: 3529752.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9419; val_auprc_score: 0.9252; val_best_acc_score: 0.8822; val_best_f1_score: 0.8896; train_kl_reg_loss: 30681.2700; train_edge_recon_loss: 2713047.4722; train_gene_expr_recon_loss: 522502.6111; train_masked_gp_l1_reg_loss: 4343.4702; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254001.1580; train_global_loss: 3524575.9722; train_optim_loss: 3524575.9722; val_kl_reg_loss: 29670.7344; val_edge_recon_loss: 2727142.5000; val_gene_expr_recon_loss: 519187.0625; val_masked_gp_l1_reg_loss: 4430.2124; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253796.0625; val_global_loss: 3534226.5000; val_optim_loss: 3534226.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9467; val_auprc_score: 0.9289; val_best_acc_score: 0.8922; val_best_f1_score: 0.8976; train_kl_reg_loss: 29713.3822; train_edge_recon_loss: 2706580.5000; train_gene_expr_recon_loss: 513836.0694; train_masked_gp_l1_reg_loss: 4515.9878; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252869.8038; train_global_loss: 3507515.7222; train_optim_loss: 3507515.7222; val_kl_reg_loss: 28558.7578; val_edge_recon_loss: 2699605.2500; val_gene_expr_recon_loss: 517084.9375; val_masked_gp_l1_reg_loss: 4603.5190; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253066.5469; val_global_loss: 3502919.0000; val_optim_loss: 3502919.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9506; val_auprc_score: 0.9334; val_best_acc_score: 0.8957; val_best_f1_score: 0.9009; train_kl_reg_loss: 28970.6947; train_edge_recon_loss: 2693805.3333; train_gene_expr_recon_loss: 511254.1215; train_masked_gp_l1_reg_loss: 4672.6319; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253143.2760; train_global_loss: 3491846.0556; train_optim_loss: 3491846.0556; val_kl_reg_loss: 29259.5273; val_edge_recon_loss: 2689858.7500; val_gene_expr_recon_loss: 505752.1250; val_masked_gp_l1_reg_loss: 4760.5059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252131.5625; val_global_loss: 3481762.5000; val_optim_loss: 3481762.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9509; val_auprc_score: 0.9316; val_best_acc_score: 0.8964; val_best_f1_score: 0.9011; train_kl_reg_loss: 29111.3247; train_edge_recon_loss: 2687060.3333; train_gene_expr_recon_loss: 505290.8090; train_masked_gp_l1_reg_loss: 4835.3432; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252596.6684; train_global_loss: 3478894.5278; train_optim_loss: 3478894.5278; val_kl_reg_loss: 26032.3145; val_edge_recon_loss: 2711281.7500; val_gene_expr_recon_loss: 502140.1875; val_masked_gp_l1_reg_loss: 4922.3315; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251354.6875; val_global_loss: 3495731.2500; val_optim_loss: 3495731.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9587; val_auprc_score: 0.9471; val_best_acc_score: 0.9008; val_best_f1_score: 0.9059; train_kl_reg_loss: 26071.7281; train_edge_recon_loss: 2678559.8611; train_gene_expr_recon_loss: 503412.1458; train_masked_gp_l1_reg_loss: 4987.5291; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251808.5712; train_global_loss: 3464839.8333; train_optim_loss: 3464839.8333; val_kl_reg_loss: 27036.7773; val_edge_recon_loss: 2682594.7500; val_gene_expr_recon_loss: 504875.8750; val_masked_gp_l1_reg_loss: 5054.5747; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251185.9844; val_global_loss: 3470748.0000; val_optim_loss: 3470748.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9538; val_auprc_score: 0.9374; val_best_acc_score: 0.8989; val_best_f1_score: 0.9047; train_kl_reg_loss: 28216.7854; train_edge_recon_loss: 2662451.5556; train_gene_expr_recon_loss: 498009.0417; train_masked_gp_l1_reg_loss: 5109.4852; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249839.1441; train_global_loss: 3443626.0000; train_optim_loss: 3443626.0000; val_kl_reg_loss: 27812.8047; val_edge_recon_loss: 2702588.2500; val_gene_expr_recon_loss: 496808.1875; val_masked_gp_l1_reg_loss: 5174.3750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250197.9062; val_global_loss: 3482581.5000; val_optim_loss: 3482581.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9610; val_auprc_score: 0.9461; val_best_acc_score: 0.9096; val_best_f1_score: 0.9134; train_kl_reg_loss: 27147.0226; train_edge_recon_loss: 2663890.0556; train_gene_expr_recon_loss: 495719.3785; train_masked_gp_l1_reg_loss: 5224.2368; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251807.5069; train_global_loss: 3443788.1944; train_optim_loss: 3443788.1944; val_kl_reg_loss: 26901.5605; val_edge_recon_loss: 2683771.7500; val_gene_expr_recon_loss: 491404.5312; val_masked_gp_l1_reg_loss: 5278.8374; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249420.9531; val_global_loss: 3456777.5000; val_optim_loss: 3456777.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9680; val_auprc_score: 0.9580; val_best_acc_score: 0.9143; val_best_f1_score: 0.9180; train_kl_reg_loss: 27906.7012; train_edge_recon_loss: 2652890.6389; train_gene_expr_recon_loss: 491146.8819; train_masked_gp_l1_reg_loss: 5332.4316; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249305.1389; train_global_loss: 3426581.8056; train_optim_loss: 3426581.8056; val_kl_reg_loss: 27850.4805; val_edge_recon_loss: 2656854.0000; val_gene_expr_recon_loss: 487679.0000; val_masked_gp_l1_reg_loss: 5388.2026; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248795.0000; val_global_loss: 3426566.7500; val_optim_loss: 3426566.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9679; val_auprc_score: 0.9547; val_best_acc_score: 0.9163; val_best_f1_score: 0.9183; train_kl_reg_loss: 27093.1534; train_edge_recon_loss: 2651032.5278; train_gene_expr_recon_loss: 487433.8715; train_masked_gp_l1_reg_loss: 5438.4831; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249226.2865; train_global_loss: 3420224.3611; train_optim_loss: 3420224.3611; val_kl_reg_loss: 26468.6016; val_edge_recon_loss: 2660615.7500; val_gene_expr_recon_loss: 482765.3750; val_masked_gp_l1_reg_loss: 5486.9819; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248153.7344; val_global_loss: 3423490.2500; val_optim_loss: 3423490.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9669; val_auprc_score: 0.9545; val_best_acc_score: 0.9177; val_best_f1_score: 0.9211; train_kl_reg_loss: 27199.4355; train_edge_recon_loss: 2651740.6667; train_gene_expr_recon_loss: 482168.1493; train_masked_gp_l1_reg_loss: 5525.9725; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247977.8854; train_global_loss: 3414612.1389; train_optim_loss: 3414612.1389; val_kl_reg_loss: 25990.6660; val_edge_recon_loss: 2645517.2500; val_gene_expr_recon_loss: 484916.7812; val_masked_gp_l1_reg_loss: 5564.9453; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248006.1719; val_global_loss: 3409996.0000; val_optim_loss: 3409996.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9699; val_auprc_score: 0.9593; val_best_acc_score: 0.9228; val_best_f1_score: 0.9256; train_kl_reg_loss: 26170.0632; train_edge_recon_loss: 2651521.7500; train_gene_expr_recon_loss: 483070.5312; train_masked_gp_l1_reg_loss: 5604.7363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248301.3663; train_global_loss: 3414668.4444; train_optim_loss: 3414668.4444; val_kl_reg_loss: 26411.1992; val_edge_recon_loss: 2662680.2500; val_gene_expr_recon_loss: 483270.1875; val_masked_gp_l1_reg_loss: 5652.3047; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247763.5000; val_global_loss: 3425777.5000; val_optim_loss: 3425777.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9737; val_auprc_score: 0.9646; val_best_acc_score: 0.9279; val_best_f1_score: 0.9304; train_kl_reg_loss: 26597.8403; train_edge_recon_loss: 2638799.5833; train_gene_expr_recon_loss: 477947.2396; train_masked_gp_l1_reg_loss: 5693.6517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246517.3507; train_global_loss: 3395555.5556; train_optim_loss: 3395555.5556; val_kl_reg_loss: 26390.9492; val_edge_recon_loss: 2638886.7500; val_gene_expr_recon_loss: 482561.2500; val_masked_gp_l1_reg_loss: 5734.7407; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247275.3125; val_global_loss: 3400849.0000; val_optim_loss: 3400849.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9732; val_auprc_score: 0.9641; val_best_acc_score: 0.9270; val_best_f1_score: 0.9296; train_kl_reg_loss: 27874.3900; train_edge_recon_loss: 2631943.5556; train_gene_expr_recon_loss: 476221.1528; train_masked_gp_l1_reg_loss: 5769.0628; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245678.1337; train_global_loss: 3387486.2222; train_optim_loss: 3387486.2222; val_kl_reg_loss: 27731.5156; val_edge_recon_loss: 2643908.5000; val_gene_expr_recon_loss: 479634.2812; val_masked_gp_l1_reg_loss: 5809.9243; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246683.5938; val_global_loss: 3403767.7500; val_optim_loss: 3403767.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9745; val_auprc_score: 0.9654; val_best_acc_score: 0.9309; val_best_f1_score: 0.9335; train_kl_reg_loss: 27769.8730; train_edge_recon_loss: 2632822.8889; train_gene_expr_recon_loss: 473661.9271; train_masked_gp_l1_reg_loss: 5839.0701; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246699.7188; train_global_loss: 3386793.5278; train_optim_loss: 3386793.5278; val_kl_reg_loss: 27172.3359; val_edge_recon_loss: 2658467.5000; val_gene_expr_recon_loss: 473089.1250; val_masked_gp_l1_reg_loss: 5875.8047; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245842.1094; val_global_loss: 3410446.7500; val_optim_loss: 3410446.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9758; val_auprc_score: 0.9670; val_best_acc_score: 0.9303; val_best_f1_score: 0.9331; train_kl_reg_loss: 27637.7018; train_edge_recon_loss: 2628769.8333; train_gene_expr_recon_loss: 470742.3264; train_masked_gp_l1_reg_loss: 5913.7805; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244613.3785; train_global_loss: 3377677.0000; train_optim_loss: 3377677.0000; val_kl_reg_loss: 26681.6836; val_edge_recon_loss: 2641144.0000; val_gene_expr_recon_loss: 471893.7500; val_masked_gp_l1_reg_loss: 5952.6836; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245266.9219; val_global_loss: 3390939.2500; val_optim_loss: 3390939.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9799; val_auprc_score: 0.9734; val_best_acc_score: 0.9392; val_best_f1_score: 0.9412; train_kl_reg_loss: 27062.0304; train_edge_recon_loss: 2624455.2222; train_gene_expr_recon_loss: 470093.0243; train_masked_gp_l1_reg_loss: 5992.0422; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245251.1493; train_global_loss: 3372853.4444; train_optim_loss: 3372853.4444; val_kl_reg_loss: 26627.9629; val_edge_recon_loss: 2625709.2500; val_gene_expr_recon_loss: 473083.9062; val_masked_gp_l1_reg_loss: 6026.5698; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245164.4531; val_global_loss: 3376612.2500; val_optim_loss: 3376612.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9799; val_auprc_score: 0.9739; val_best_acc_score: 0.9415; val_best_f1_score: 0.9428; train_kl_reg_loss: 27013.3451; train_edge_recon_loss: 2624044.7222; train_gene_expr_recon_loss: 469464.9062; train_masked_gp_l1_reg_loss: 6064.5115; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244989.5069; train_global_loss: 3371577.0278; train_optim_loss: 3371577.0278; val_kl_reg_loss: 28377.4004; val_edge_recon_loss: 2614789.5000; val_gene_expr_recon_loss: 469418.1875; val_masked_gp_l1_reg_loss: 6095.5869; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244750.3906; val_global_loss: 3363431.2500; val_optim_loss: 3363431.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9783; val_auprc_score: 0.9697; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 28503.4486; train_edge_recon_loss: 2636251.0833; train_gene_expr_recon_loss: 498284.8229; train_masked_gp_l1_reg_loss: 6114.9567; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247835.1007; train_global_loss: 3416989.3611; train_optim_loss: 3416989.3611; val_kl_reg_loss: 12517.4492; val_edge_recon_loss: 2640325.5000; val_gene_expr_recon_loss: 491077.1875; val_masked_gp_l1_reg_loss: 6096.9438; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247562.1562; val_global_loss: 3397579.5000; val_optim_loss: 3397579.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9762; val_auprc_score: 0.9691; val_best_acc_score: 0.9328; val_best_f1_score: 0.9353; train_kl_reg_loss: 26869.9121; train_edge_recon_loss: 2619423.8333; train_gene_expr_recon_loss: 492109.2049; train_masked_gp_l1_reg_loss: 6076.5751; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247701.8663; train_global_loss: 3392181.4444; train_optim_loss: 3392181.4444; val_kl_reg_loss: 11101.5986; val_edge_recon_loss: 2650553.0000; val_gene_expr_recon_loss: 492470.8125; val_masked_gp_l1_reg_loss: 6052.4238; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247507.0000; val_global_loss: 3407684.7500; val_optim_loss: 3407684.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9804; val_auprc_score: 0.9730; val_best_acc_score: 0.9421; val_best_f1_score: 0.9437; train_kl_reg_loss: 23486.3390; train_edge_recon_loss: 2626629.5556; train_gene_expr_recon_loss: 489084.2292; train_masked_gp_l1_reg_loss: 6038.3906; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248082.5122; train_global_loss: 3393321.1111; train_optim_loss: 3393321.1111; val_kl_reg_loss: 11479.6904; val_edge_recon_loss: 2622180.2500; val_gene_expr_recon_loss: 488911.6250; val_masked_gp_l1_reg_loss: 6021.1660; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246992.7188; val_global_loss: 3375585.5000; val_optim_loss: 3375585.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9796; val_auprc_score: 0.9718; val_best_acc_score: 0.9411; val_best_f1_score: 0.9423; train_kl_reg_loss: 22557.1053; train_edge_recon_loss: 2621448.3056; train_gene_expr_recon_loss: 484840.4062; train_masked_gp_l1_reg_loss: 6012.0240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246184.9132; train_global_loss: 3381042.7778; train_optim_loss: 3381042.7778; val_kl_reg_loss: 11473.0449; val_edge_recon_loss: 2616705.2500; val_gene_expr_recon_loss: 487517.2500; val_masked_gp_l1_reg_loss: 6003.7930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246762.2500; val_global_loss: 3368461.5000; val_optim_loss: 3368461.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9817; val_auprc_score: 0.9769; val_best_acc_score: 0.9423; val_best_f1_score: 0.9434; train_kl_reg_loss: 21529.0312; train_edge_recon_loss: 2621999.6667; train_gene_expr_recon_loss: 480563.2049; train_masked_gp_l1_reg_loss: 5967.3954; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245163.3733; train_global_loss: 3375222.6111; train_optim_loss: 3375222.6111; val_kl_reg_loss: 11467.5879; val_edge_recon_loss: 2616644.0000; val_gene_expr_recon_loss: 489372.3750; val_masked_gp_l1_reg_loss: 5933.3735; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246974.5625; val_global_loss: 3370391.7500; val_optim_loss: 3370391.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9825; val_auprc_score: 0.9774; val_best_acc_score: 0.9452; val_best_f1_score: 0.9461; train_kl_reg_loss: 21396.3147; train_edge_recon_loss: 2617898.3611; train_gene_expr_recon_loss: 483151.5521; train_masked_gp_l1_reg_loss: 5923.9816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246531.2170; train_global_loss: 3374901.3889; train_optim_loss: 3374901.3889; val_kl_reg_loss: 11519.4355; val_edge_recon_loss: 2612127.7500; val_gene_expr_recon_loss: 489384.3125; val_masked_gp_l1_reg_loss: 5909.2290; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246957.2812; val_global_loss: 3365898.0000; val_optim_loss: 3365898.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9796; val_auprc_score: 0.9720; val_best_acc_score: 0.9422; val_best_f1_score: 0.9435; train_kl_reg_loss: 21522.0345; train_edge_recon_loss: 2617517.1944; train_gene_expr_recon_loss: 484857.8125; train_masked_gp_l1_reg_loss: 5900.8076; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245839.5122; train_global_loss: 3375637.4167; train_optim_loss: 3375637.4167; val_kl_reg_loss: 11570.7607; val_edge_recon_loss: 2622367.2500; val_gene_expr_recon_loss: 487955.2188; val_masked_gp_l1_reg_loss: 5891.7021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246784.5938; val_global_loss: 3374569.5000; val_optim_loss: 3374569.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9834; val_auprc_score: 0.9760; val_best_acc_score: 0.9449; val_best_f1_score: 0.9458; train_kl_reg_loss: 21611.5297; train_edge_recon_loss: 2617492.6667; train_gene_expr_recon_loss: 482344.1215; train_masked_gp_l1_reg_loss: 5886.7524; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246386.2361; train_global_loss: 3373721.3333; train_optim_loss: 3373721.3333; val_kl_reg_loss: 11724.1504; val_edge_recon_loss: 2622000.2500; val_gene_expr_recon_loss: 487541.0000; val_masked_gp_l1_reg_loss: 5881.5654; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246674.9531; val_global_loss: 3373822.0000; val_optim_loss: 3373822.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9787
val AUPRC score: 0.9726
val best accuracy score: 0.9383
val best F1 score: 0.9396
val target rna MSE score: 0.4812
val source rna MSE score: 0.2995
val target atac MSE score: 0.1358
val source atac MSE score: 0.0218
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
