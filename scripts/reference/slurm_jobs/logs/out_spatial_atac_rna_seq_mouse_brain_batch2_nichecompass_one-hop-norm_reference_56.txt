[True]
Run timestamp: 24072023_165649_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9514; val_auprc_score: 0.9555; val_best_acc_score: 0.5177; val_best_f1_score: 0.6746; train_kl_reg_loss: 256405.1229; train_edge_recon_loss: 34668788.4444; train_gene_expr_recon_loss: 342584.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1158539.7639; train_global_loss: 36426317.3333; train_optim_loss: 36426317.3333; val_kl_reg_loss: 34730.9336; val_edge_recon_loss: 40624204.0000; val_gene_expr_recon_loss: 318847.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056367.3750; val_global_loss: 42034152.0000; val_optim_loss: 42034152.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9445; val_auprc_score: 0.9505; val_best_acc_score: 0.6424; val_best_f1_score: 0.7347; train_kl_reg_loss: 21234.8185; train_edge_recon_loss: 34677117.7778; train_gene_expr_recon_loss: 324197.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1107867.5000; train_global_loss: 36130417.3333; train_optim_loss: 36130417.3333; val_kl_reg_loss: 13074.6426; val_edge_recon_loss: 40584940.0000; val_gene_expr_recon_loss: 316294.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1053990.0000; val_global_loss: 41968304.0000; val_optim_loss: 41968304.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9400; val_auprc_score: 0.9427; val_best_acc_score: 0.6997; val_best_f1_score: 0.7666; train_kl_reg_loss: 18776.4006; train_edge_recon_loss: 34670298.6667; train_gene_expr_recon_loss: 317137.7396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1095459.6528; train_global_loss: 36101672.8889; train_optim_loss: 36101672.8889; val_kl_reg_loss: 9320.8018; val_edge_recon_loss: 40560816.0000; val_gene_expr_recon_loss: 309346.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1047697.0000; val_global_loss: 41927180.0000; val_optim_loss: 41927180.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9325; val_auprc_score: 0.9351; val_best_acc_score: 0.8239; val_best_f1_score: 0.8419; train_kl_reg_loss: 12652.8837; train_edge_recon_loss: 34676228.8889; train_gene_expr_recon_loss: 313263.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1089707.3750; train_global_loss: 36091852.4444; train_optim_loss: 36091852.4444; val_kl_reg_loss: 7025.2051; val_edge_recon_loss: 40412504.0000; val_gene_expr_recon_loss: 304653.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045453.8125; val_global_loss: 41769632.0000; val_optim_loss: 41769632.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9115; val_auprc_score: 0.9077; val_best_acc_score: 0.7910; val_best_f1_score: 0.8209; train_kl_reg_loss: 8584.0318; train_edge_recon_loss: 34652108.4444; train_gene_expr_recon_loss: 304381.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1079763.4306; train_global_loss: 36044835.5556; train_optim_loss: 36044835.5556; val_kl_reg_loss: 3577.5933; val_edge_recon_loss: 39061556.0000; val_gene_expr_recon_loss: 299867.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1039997.2500; val_global_loss: 40404996.0000; val_optim_loss: 40404996.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8543; val_auprc_score: 0.8467; val_best_acc_score: 0.7556; val_best_f1_score: 0.7846; train_kl_reg_loss: 3288.8362; train_edge_recon_loss: 34020424.6667; train_gene_expr_recon_loss: 302692.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069829.6250; train_global_loss: 35396235.1111; train_optim_loss: 35396235.1111; val_kl_reg_loss: 2601.3247; val_edge_recon_loss: 29914110.0000; val_gene_expr_recon_loss: 305555.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048058.2500; val_global_loss: 31270326.0000; val_optim_loss: 31270326.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8675; val_auprc_score: 0.8595; val_best_acc_score: 0.7700; val_best_f1_score: 0.7890; train_kl_reg_loss: 9635.3023; train_edge_recon_loss: 29473869.7778; train_gene_expr_recon_loss: 313227.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1080284.4861; train_global_loss: 30877017.1111; train_optim_loss: 30877017.1111; val_kl_reg_loss: 21100.7676; val_edge_recon_loss: 28580856.0000; val_gene_expr_recon_loss: 314854.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051283.8750; val_global_loss: 29968094.0000; val_optim_loss: 29968094.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8789; val_auprc_score: 0.8667; val_best_acc_score: 0.7894; val_best_f1_score: 0.7994; train_kl_reg_loss: 30629.3290; train_edge_recon_loss: 28170511.1111; train_gene_expr_recon_loss: 311973.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1076919.1250; train_global_loss: 29590033.5556; train_optim_loss: 29590033.5556; val_kl_reg_loss: 37511.2969; val_edge_recon_loss: 28107506.0000; val_gene_expr_recon_loss: 307213.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045693.7500; val_global_loss: 29497926.0000; val_optim_loss: 29497926.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8903; val_auprc_score: 0.8606; val_best_acc_score: 0.8138; val_best_f1_score: 0.8274; train_kl_reg_loss: 42126.0503; train_edge_recon_loss: 27995062.2222; train_gene_expr_recon_loss: 306804.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070741.2083; train_global_loss: 29414733.3333; train_optim_loss: 29414733.3333; val_kl_reg_loss: 42649.6875; val_edge_recon_loss: 27648962.0000; val_gene_expr_recon_loss: 305179.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1042666.3125; val_global_loss: 29039458.0000; val_optim_loss: 29039458.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9071; val_auprc_score: 0.8748; val_best_acc_score: 0.8428; val_best_f1_score: 0.8567; train_kl_reg_loss: 44628.5547; train_edge_recon_loss: 27464303.5556; train_gene_expr_recon_loss: 304159.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070015.1806; train_global_loss: 28883106.6667; train_optim_loss: 28883106.6667; val_kl_reg_loss: 42820.6016; val_edge_recon_loss: 27541450.0000; val_gene_expr_recon_loss: 301124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040377.8750; val_global_loss: 28925772.0000; val_optim_loss: 28925772.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9221; val_auprc_score: 0.8936; val_best_acc_score: 0.8663; val_best_f1_score: 0.8752; train_kl_reg_loss: 45778.4223; train_edge_recon_loss: 27136470.6667; train_gene_expr_recon_loss: 302514.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1071431.1111; train_global_loss: 28556195.3333; train_optim_loss: 28556195.3333; val_kl_reg_loss: 42519.3516; val_edge_recon_loss: 26652200.0000; val_gene_expr_recon_loss: 297166.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1039196.9375; val_global_loss: 28031082.0000; val_optim_loss: 28031082.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9215; val_auprc_score: 0.8976; val_best_acc_score: 0.8566; val_best_f1_score: 0.8672; train_kl_reg_loss: 44729.4444; train_edge_recon_loss: 27019615.3333; train_gene_expr_recon_loss: 298098.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065304.2153; train_global_loss: 28427747.1111; train_optim_loss: 28427747.1111; val_kl_reg_loss: 40648.4609; val_edge_recon_loss: 27231080.0000; val_gene_expr_recon_loss: 295836.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1039494.5000; val_global_loss: 28607058.0000; val_optim_loss: 28607058.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9259; val_auprc_score: 0.9056; val_best_acc_score: 0.8653; val_best_f1_score: 0.8738; train_kl_reg_loss: 41927.1198; train_edge_recon_loss: 26977711.1111; train_gene_expr_recon_loss: 298161.9271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1068874.7083; train_global_loss: 28386674.8889; train_optim_loss: 28386674.8889; val_kl_reg_loss: 38301.4336; val_edge_recon_loss: 27163964.0000; val_gene_expr_recon_loss: 295039.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1036685.0000; val_global_loss: 28533992.0000; val_optim_loss: 28533992.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9316; val_auprc_score: 0.9068; val_best_acc_score: 0.8719; val_best_f1_score: 0.8802; train_kl_reg_loss: 39436.1597; train_edge_recon_loss: 26827058.6667; train_gene_expr_recon_loss: 294918.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060946.8194; train_global_loss: 28222360.4444; train_optim_loss: 28222360.4444; val_kl_reg_loss: 36559.3789; val_edge_recon_loss: 26944288.0000; val_gene_expr_recon_loss: 295546.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1036098.9375; val_global_loss: 28312492.0000; val_optim_loss: 28312492.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9411; val_auprc_score: 0.9244; val_best_acc_score: 0.8801; val_best_f1_score: 0.8867; train_kl_reg_loss: 38136.8624; train_edge_recon_loss: 26812167.3333; train_gene_expr_recon_loss: 293922.2847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060864.3889; train_global_loss: 28205090.6667; train_optim_loss: 28205090.6667; val_kl_reg_loss: 35146.3789; val_edge_recon_loss: 26659694.0000; val_gene_expr_recon_loss: 293421.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1034082.4375; val_global_loss: 28022344.0000; val_optim_loss: 28022344.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9427; val_auprc_score: 0.9217; val_best_acc_score: 0.8906; val_best_f1_score: 0.8963; train_kl_reg_loss: 36297.5547; train_edge_recon_loss: 26848844.0000; train_gene_expr_recon_loss: 291902.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050273.9167; train_global_loss: 28227317.3333; train_optim_loss: 28227317.3333; val_kl_reg_loss: 33772.3086; val_edge_recon_loss: 26783436.0000; val_gene_expr_recon_loss: 287984.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032311.5625; val_global_loss: 28137504.0000; val_optim_loss: 28137504.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9540; val_auprc_score: 0.9369; val_best_acc_score: 0.9022; val_best_f1_score: 0.9071; train_kl_reg_loss: 34897.1341; train_edge_recon_loss: 26667359.3333; train_gene_expr_recon_loss: 289921.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051556.3333; train_global_loss: 28043734.2222; train_optim_loss: 28043734.2222; val_kl_reg_loss: 32681.8945; val_edge_recon_loss: 26651508.0000; val_gene_expr_recon_loss: 288992.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032437.6250; val_global_loss: 28005620.0000; val_optim_loss: 28005620.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9461; val_auprc_score: 0.9244; val_best_acc_score: 0.8898; val_best_f1_score: 0.8959; train_kl_reg_loss: 34319.3368; train_edge_recon_loss: 26521631.3333; train_gene_expr_recon_loss: 289881.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056259.9097; train_global_loss: 27902091.5556; train_optim_loss: 27902091.5556; val_kl_reg_loss: 33227.2695; val_edge_recon_loss: 26892060.0000; val_gene_expr_recon_loss: 294195.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032290.7500; val_global_loss: 28251774.0000; val_optim_loss: 28251774.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9500; val_auprc_score: 0.9303; val_best_acc_score: 0.8941; val_best_f1_score: 0.8994; train_kl_reg_loss: 34290.1437; train_edge_recon_loss: 26579436.4444; train_gene_expr_recon_loss: 288331.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049871.8819; train_global_loss: 27951930.0000; train_optim_loss: 27951930.0000; val_kl_reg_loss: 32897.2266; val_edge_recon_loss: 26708194.0000; val_gene_expr_recon_loss: 288248.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028343.8125; val_global_loss: 28057684.0000; val_optim_loss: 28057684.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9506; val_auprc_score: 0.9277; val_best_acc_score: 0.8949; val_best_f1_score: 0.9009; train_kl_reg_loss: 34400.7196; train_edge_recon_loss: 26470340.0000; train_gene_expr_recon_loss: 289727.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058056.1319; train_global_loss: 27852524.8889; train_optim_loss: 27852524.8889; val_kl_reg_loss: 32883.0742; val_edge_recon_loss: 26700058.0000; val_gene_expr_recon_loss: 283497.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025397.8750; val_global_loss: 28041838.0000; val_optim_loss: 28041838.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9577; val_auprc_score: 0.9394; val_best_acc_score: 0.9011; val_best_f1_score: 0.9066; train_kl_reg_loss: 34198.5421; train_edge_recon_loss: 26364871.1111; train_gene_expr_recon_loss: 286130.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051137.7569; train_global_loss: 27736338.0000; train_optim_loss: 27736338.0000; val_kl_reg_loss: 32715.4453; val_edge_recon_loss: 26569444.0000; val_gene_expr_recon_loss: 282816.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024352.0000; val_global_loss: 27909328.0000; val_optim_loss: 27909328.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9603; val_auprc_score: 0.9458; val_best_acc_score: 0.9082; val_best_f1_score: 0.9121; train_kl_reg_loss: 33941.7739; train_edge_recon_loss: 26425195.3333; train_gene_expr_recon_loss: 284804.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046011.0556; train_global_loss: 27789952.4444; train_optim_loss: 27789952.4444; val_kl_reg_loss: 32658.8828; val_edge_recon_loss: 26493300.0000; val_gene_expr_recon_loss: 280879.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022255.3750; val_global_loss: 27829094.0000; val_optim_loss: 27829094.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9589; val_auprc_score: 0.9429; val_best_acc_score: 0.9088; val_best_f1_score: 0.9127; train_kl_reg_loss: 33708.0638; train_edge_recon_loss: 26418199.7778; train_gene_expr_recon_loss: 283704.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050784.6250; train_global_loss: 27786397.5556; train_optim_loss: 27786397.5556; val_kl_reg_loss: 32017.5625; val_edge_recon_loss: 26567120.0000; val_gene_expr_recon_loss: 284641.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023435.8125; val_global_loss: 27907216.0000; val_optim_loss: 27907216.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9574; val_auprc_score: 0.9410; val_best_acc_score: 0.9035; val_best_f1_score: 0.9096; train_kl_reg_loss: 33616.9709; train_edge_recon_loss: 26411450.6667; train_gene_expr_recon_loss: 281114.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041945.7569; train_global_loss: 27768127.3333; train_optim_loss: 27768127.3333; val_kl_reg_loss: 32049.8848; val_edge_recon_loss: 26806882.0000; val_gene_expr_recon_loss: 281869.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021590.2500; val_global_loss: 28142392.0000; val_optim_loss: 28142392.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9575; val_auprc_score: 0.9416; val_best_acc_score: 0.9080; val_best_f1_score: 0.9125; train_kl_reg_loss: 33139.0438; train_edge_recon_loss: 26405184.6667; train_gene_expr_recon_loss: 280712.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044858.2778; train_global_loss: 27763894.6667; train_optim_loss: 27763894.6667; val_kl_reg_loss: 31553.7344; val_edge_recon_loss: 26546586.0000; val_gene_expr_recon_loss: 278550.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021471.1875; val_global_loss: 27878162.0000; val_optim_loss: 27878162.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9602; val_auprc_score: 0.9448; val_best_acc_score: 0.9107; val_best_f1_score: 0.9152; train_kl_reg_loss: 32611.4952; train_edge_recon_loss: 26347475.1111; train_gene_expr_recon_loss: 280239.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043278.2569; train_global_loss: 27703604.4444; train_optim_loss: 27703604.4444; val_kl_reg_loss: 29551.7988; val_edge_recon_loss: 26710812.0000; val_gene_expr_recon_loss: 283173.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022135.8750; val_global_loss: 28045674.0000; val_optim_loss: 28045674.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9669; val_auprc_score: 0.9554; val_best_acc_score: 0.9170; val_best_f1_score: 0.9203; train_kl_reg_loss: 32872.6461; train_edge_recon_loss: 26372306.2222; train_gene_expr_recon_loss: 279975.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043121.9792; train_global_loss: 27728275.5556; train_optim_loss: 27728275.5556; val_kl_reg_loss: 29836.2363; val_edge_recon_loss: 26446310.0000; val_gene_expr_recon_loss: 278234.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018427.1875; val_global_loss: 27772808.0000; val_optim_loss: 27772808.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9635; val_auprc_score: 0.9495; val_best_acc_score: 0.9146; val_best_f1_score: 0.9194; train_kl_reg_loss: 32695.8800; train_edge_recon_loss: 26264946.4444; train_gene_expr_recon_loss: 279771.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044268.0278; train_global_loss: 27621682.2222; train_optim_loss: 27621682.2222; val_kl_reg_loss: 29361.2031; val_edge_recon_loss: 26594868.0000; val_gene_expr_recon_loss: 280586.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020112.8125; val_global_loss: 27924928.0000; val_optim_loss: 27924928.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9640; val_auprc_score: 0.9503; val_best_acc_score: 0.9147; val_best_f1_score: 0.9188; train_kl_reg_loss: 32625.3872; train_edge_recon_loss: 26325439.3333; train_gene_expr_recon_loss: 280565.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043741.5764; train_global_loss: 27682372.0000; train_optim_loss: 27682372.0000; val_kl_reg_loss: 29819.2969; val_edge_recon_loss: 26429942.0000; val_gene_expr_recon_loss: 280324.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019602.3125; val_global_loss: 27759688.0000; val_optim_loss: 27759688.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9613; val_auprc_score: 0.9433; val_best_acc_score: 0.9153; val_best_f1_score: 0.9194; train_kl_reg_loss: 32492.9657; train_edge_recon_loss: 26359900.2222; train_gene_expr_recon_loss: 279711.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043248.2361; train_global_loss: 27715353.3333; train_optim_loss: 27715353.3333; val_kl_reg_loss: 29295.0977; val_edge_recon_loss: 26267946.0000; val_gene_expr_recon_loss: 279310.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018743.2500; val_global_loss: 27595296.0000; val_optim_loss: 27595296.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9654; val_auprc_score: 0.9488; val_best_acc_score: 0.9170; val_best_f1_score: 0.9210; train_kl_reg_loss: 32424.0130; train_edge_recon_loss: 26258091.5556; train_gene_expr_recon_loss: 279460.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046313.0556; train_global_loss: 27616289.7778; train_optim_loss: 27616289.7778; val_kl_reg_loss: 29604.2031; val_edge_recon_loss: 26308996.0000; val_gene_expr_recon_loss: 279666.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018718.1250; val_global_loss: 27636984.0000; val_optim_loss: 27636984.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9595; val_auprc_score: 0.9387; val_best_acc_score: 0.9128; val_best_f1_score: 0.9172; train_kl_reg_loss: 32242.1552; train_edge_recon_loss: 26420137.3333; train_gene_expr_recon_loss: 279734.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043785.0278; train_global_loss: 27775898.8889; train_optim_loss: 27775898.8889; val_kl_reg_loss: 29012.0645; val_edge_recon_loss: 26463104.0000; val_gene_expr_recon_loss: 280106.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019443.7500; val_global_loss: 27791666.0000; val_optim_loss: 27791666.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9658; val_auprc_score: 0.9521; val_best_acc_score: 0.9182; val_best_f1_score: 0.9222; train_kl_reg_loss: 32522.6684; train_edge_recon_loss: 26237232.4444; train_gene_expr_recon_loss: 279999.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042711.0278; train_global_loss: 27592465.1111; train_optim_loss: 27592465.1111; val_kl_reg_loss: 29388.5234; val_edge_recon_loss: 26441062.0000; val_gene_expr_recon_loss: 279870.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018957.6875; val_global_loss: 27769278.0000; val_optim_loss: 27769278.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9631; val_auprc_score: 0.9473; val_best_acc_score: 0.9117; val_best_f1_score: 0.9163; train_kl_reg_loss: 32196.5469; train_edge_recon_loss: 26329706.4444; train_gene_expr_recon_loss: 279206.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042926.6250; train_global_loss: 27684036.0000; train_optim_loss: 27684036.0000; val_kl_reg_loss: 29365.4727; val_edge_recon_loss: 26534278.0000; val_gene_expr_recon_loss: 280208.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020791.6250; val_global_loss: 27864644.0000; val_optim_loss: 27864644.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9618; val_auprc_score: 0.9481; val_best_acc_score: 0.9113; val_best_f1_score: 0.9160; train_kl_reg_loss: 32098.9779; train_edge_recon_loss: 26261747.3333; train_gene_expr_recon_loss: 279208.4132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043284.3056; train_global_loss: 27616339.1111; train_optim_loss: 27616339.1111; val_kl_reg_loss: 29106.2188; val_edge_recon_loss: 26528484.0000; val_gene_expr_recon_loss: 279676.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017915.0000; val_global_loss: 27855180.0000; val_optim_loss: 27855180.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9634; val_auprc_score: 0.9442; val_best_acc_score: 0.9167; val_best_f1_score: 0.9207; train_kl_reg_loss: 32052.6680; train_edge_recon_loss: 26391580.6667; train_gene_expr_recon_loss: 279278.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038686.8819; train_global_loss: 27741598.4444; train_optim_loss: 27741598.4444; val_kl_reg_loss: 29150.3418; val_edge_recon_loss: 26354944.0000; val_gene_expr_recon_loss: 279550.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018744.5000; val_global_loss: 27682388.0000; val_optim_loss: 27682388.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9614; val_auprc_score: 0.9460; val_best_acc_score: 0.9163; val_best_f1_score: 0.9204; train_kl_reg_loss: 31851.0749; train_edge_recon_loss: 26386362.8889; train_gene_expr_recon_loss: 278069.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038717.8194; train_global_loss: 27735002.0000; train_optim_loss: 27735002.0000; val_kl_reg_loss: 29121.9961; val_edge_recon_loss: 26577314.0000; val_gene_expr_recon_loss: 279449.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017435.1875; val_global_loss: 27903322.0000; val_optim_loss: 27903322.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9586; val_auprc_score: 0.9428; val_best_acc_score: 0.9115; val_best_f1_score: 0.9161; train_kl_reg_loss: 32006.8498; train_edge_recon_loss: 26330188.8889; train_gene_expr_recon_loss: 279559.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043240.0139; train_global_loss: 27684995.1111; train_optim_loss: 27684995.1111; val_kl_reg_loss: 29085.1348; val_edge_recon_loss: 26476986.0000; val_gene_expr_recon_loss: 279287.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018524.8125; val_global_loss: 27803884.0000; val_optim_loss: 27803884.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 20 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9627
Val AUPRC score: 0.9490
Val best accuracy score: 0.9128
Val best F1 score: 0.9174
Val gene expr MSE score: 0.6593
Val chrom access MSE score: 0.0874
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
