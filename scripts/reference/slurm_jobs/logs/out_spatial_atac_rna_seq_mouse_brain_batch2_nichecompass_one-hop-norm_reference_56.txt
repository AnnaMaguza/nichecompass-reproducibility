[True]
Run timestamp: 26072023_021103_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9663; val_auprc_score: 0.9667; val_best_acc_score: 0.8857; val_best_f1_score: 0.8756; train_kl_reg_loss: 1566.8341; train_edge_recon_loss: 3466201.4722; train_gene_expr_recon_loss: 325080.2257; train_masked_gp_l1_reg_loss: 1560.8532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1079584.3472; train_global_loss: 4873993.7778; train_optim_loss: 4873993.7778; val_kl_reg_loss: 1335.8441; val_edge_recon_loss: 4039201.5000; val_gene_expr_recon_loss: 317046.5625; val_masked_gp_l1_reg_loss: 1243.3694; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1093144.2500; val_global_loss: 5451972.0000; val_optim_loss: 5451972.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9228; val_auprc_score: 0.9161; val_best_acc_score: 0.8420; val_best_f1_score: 0.8458; train_kl_reg_loss: 780.6563; train_edge_recon_loss: 3456516.3611; train_gene_expr_recon_loss: 315528.3854; train_masked_gp_l1_reg_loss: 1108.7198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075693.5556; train_global_loss: 4849627.6667; train_optim_loss: 4849627.6667; val_kl_reg_loss: 617.5426; val_edge_recon_loss: 3698252.2500; val_gene_expr_recon_loss: 308004.7500; val_masked_gp_l1_reg_loss: 998.3113; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1088168.0000; val_global_loss: 5096041.0000; val_optim_loss: 5096041.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8789; val_auprc_score: 0.8682; val_best_acc_score: 0.7828; val_best_f1_score: 0.7979; train_kl_reg_loss: 2432.4558; train_edge_recon_loss: 3277277.1389; train_gene_expr_recon_loss: 303128.5556; train_masked_gp_l1_reg_loss: 1005.1009; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063507.8889; train_global_loss: 4647351.0556; train_optim_loss: 4647351.0556; val_kl_reg_loss: 7248.8545; val_edge_recon_loss: 2903453.7500; val_gene_expr_recon_loss: 299561.5938; val_masked_gp_l1_reg_loss: 1054.0962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1087644.6250; val_global_loss: 4298962.5000; val_optim_loss: 4298962.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8957; val_auprc_score: 0.8915; val_best_acc_score: 0.8080; val_best_f1_score: 0.8138; train_kl_reg_loss: 17443.9185; train_edge_recon_loss: 2864775.3056; train_gene_expr_recon_loss: 303482.1701; train_masked_gp_l1_reg_loss: 1074.0154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069123.8194; train_global_loss: 4255899.1667; train_optim_loss: 4255899.1667; val_kl_reg_loss: 30043.6816; val_edge_recon_loss: 2866885.0000; val_gene_expr_recon_loss: 297854.0000; val_masked_gp_l1_reg_loss: 1081.9130; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080408.7500; val_global_loss: 4276273.5000; val_optim_loss: 4276273.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9000; val_auprc_score: 0.8825; val_best_acc_score: 0.8161; val_best_f1_score: 0.8292; train_kl_reg_loss: 35160.9147; train_edge_recon_loss: 2820788.4444; train_gene_expr_recon_loss: 293295.3576; train_masked_gp_l1_reg_loss: 1104.0159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060167.3819; train_global_loss: 4210516.1111; train_optim_loss: 4210516.1111; val_kl_reg_loss: 31274.6484; val_edge_recon_loss: 2812159.2500; val_gene_expr_recon_loss: 286176.8750; val_masked_gp_l1_reg_loss: 1146.2412; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071579.2500; val_global_loss: 4202336.5000; val_optim_loss: 4202336.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9249; val_auprc_score: 0.9026; val_best_acc_score: 0.8591; val_best_f1_score: 0.8659; train_kl_reg_loss: 25867.2357; train_edge_recon_loss: 2773764.8611; train_gene_expr_recon_loss: 289397.4965; train_masked_gp_l1_reg_loss: 1180.8547; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058655.1181; train_global_loss: 4148865.5833; train_optim_loss: 4148865.5833; val_kl_reg_loss: 21873.6914; val_edge_recon_loss: 2746251.5000; val_gene_expr_recon_loss: 282883.4062; val_masked_gp_l1_reg_loss: 1228.5063; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1069450.0000; val_global_loss: 4121687.2500; val_optim_loss: 4121687.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9239; val_auprc_score: 0.9037; val_best_acc_score: 0.8580; val_best_f1_score: 0.8665; train_kl_reg_loss: 23016.7365; train_edge_recon_loss: 2719742.3611; train_gene_expr_recon_loss: 285123.3611; train_masked_gp_l1_reg_loss: 1277.8983; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047122.3889; train_global_loss: 4076282.7500; train_optim_loss: 4076282.7500; val_kl_reg_loss: 26939.8496; val_edge_recon_loss: 2744614.5000; val_gene_expr_recon_loss: 285117.1250; val_masked_gp_l1_reg_loss: 1333.3961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1066694.7500; val_global_loss: 4124699.7500; val_optim_loss: 4124699.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9318; val_auprc_score: 0.9146; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 29555.4783; train_edge_recon_loss: 2718746.0556; train_gene_expr_recon_loss: 280781.6076; train_masked_gp_l1_reg_loss: 1364.6809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048967.6875; train_global_loss: 4079415.5556; train_optim_loss: 4079415.5556; val_kl_reg_loss: 29754.2539; val_edge_recon_loss: 2741578.7500; val_gene_expr_recon_loss: 274779.5000; val_masked_gp_l1_reg_loss: 1404.9938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058634.7500; val_global_loss: 4106152.2500; val_optim_loss: 4106152.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9296; val_auprc_score: 0.9078; val_best_acc_score: 0.8690; val_best_f1_score: 0.8771; train_kl_reg_loss: 28471.5069; train_edge_recon_loss: 2704555.7222; train_gene_expr_recon_loss: 274434.4201; train_masked_gp_l1_reg_loss: 1434.7153; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037848.4097; train_global_loss: 4046744.8611; train_optim_loss: 4046744.8611; val_kl_reg_loss: 26462.8184; val_edge_recon_loss: 2714841.0000; val_gene_expr_recon_loss: 269047.6875; val_masked_gp_l1_reg_loss: 1467.7826; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051331.7500; val_global_loss: 4063151.0000; val_optim_loss: 4063151.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9372; val_auprc_score: 0.9167; val_best_acc_score: 0.8766; val_best_f1_score: 0.8835; train_kl_reg_loss: 25562.2400; train_edge_recon_loss: 2722539.6111; train_gene_expr_recon_loss: 269286.1701; train_masked_gp_l1_reg_loss: 1498.3968; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037095.2639; train_global_loss: 4055981.6667; train_optim_loss: 4055981.6667; val_kl_reg_loss: 25809.2227; val_edge_recon_loss: 2716898.2500; val_gene_expr_recon_loss: 264904.5312; val_masked_gp_l1_reg_loss: 1534.2870; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1049602.6250; val_global_loss: 4058749.0000; val_optim_loss: 4058749.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9426; val_auprc_score: 0.9233; val_best_acc_score: 0.8816; val_best_f1_score: 0.8876; train_kl_reg_loss: 26852.6406; train_edge_recon_loss: 2703854.3611; train_gene_expr_recon_loss: 267020.2882; train_masked_gp_l1_reg_loss: 1565.0930; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032434.7361; train_global_loss: 4031727.0833; train_optim_loss: 4031727.0833; val_kl_reg_loss: 26885.4922; val_edge_recon_loss: 2724495.5000; val_gene_expr_recon_loss: 263773.8750; val_masked_gp_l1_reg_loss: 1601.2988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048644.2500; val_global_loss: 4065400.5000; val_optim_loss: 4065400.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9498; val_auprc_score: 0.9322; val_best_acc_score: 0.8921; val_best_f1_score: 0.8976; train_kl_reg_loss: 25927.7289; train_edge_recon_loss: 2700909.4167; train_gene_expr_recon_loss: 264095.3247; train_masked_gp_l1_reg_loss: 1635.0890; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027486.7917; train_global_loss: 4020054.2778; train_optim_loss: 4020054.2778; val_kl_reg_loss: 24356.0742; val_edge_recon_loss: 2702935.0000; val_gene_expr_recon_loss: 261761.1094; val_masked_gp_l1_reg_loss: 1676.5936; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046847.8750; val_global_loss: 4037576.5000; val_optim_loss: 4037576.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9510; val_auprc_score: 0.9330; val_best_acc_score: 0.8964; val_best_f1_score: 0.9019; train_kl_reg_loss: 24946.2363; train_edge_recon_loss: 2682555.1111; train_gene_expr_recon_loss: 262975.4236; train_masked_gp_l1_reg_loss: 1706.9539; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028477.5417; train_global_loss: 4000661.2778; train_optim_loss: 4000661.2778; val_kl_reg_loss: 25306.3789; val_edge_recon_loss: 2702514.7500; val_gene_expr_recon_loss: 256886.7344; val_masked_gp_l1_reg_loss: 1740.6702; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040543.3125; val_global_loss: 4026992.0000; val_optim_loss: 4026992.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9537; val_auprc_score: 0.9342; val_best_acc_score: 0.8971; val_best_f1_score: 0.9022; train_kl_reg_loss: 25414.9160; train_edge_recon_loss: 2672393.3611; train_gene_expr_recon_loss: 260119.1042; train_masked_gp_l1_reg_loss: 1769.3360; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1022600.7569; train_global_loss: 3982297.4722; train_optim_loss: 3982297.4722; val_kl_reg_loss: 25089.5234; val_edge_recon_loss: 2687091.0000; val_gene_expr_recon_loss: 254723.7344; val_masked_gp_l1_reg_loss: 1801.2864; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1035850.4375; val_global_loss: 4004556.0000; val_optim_loss: 4004556.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9553; val_auprc_score: 0.9384; val_best_acc_score: 0.8989; val_best_f1_score: 0.9043; train_kl_reg_loss: 24984.3414; train_edge_recon_loss: 2664919.9722; train_gene_expr_recon_loss: 259100.9045; train_masked_gp_l1_reg_loss: 1825.1296; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027973.6389; train_global_loss: 3978804.0278; train_optim_loss: 3978804.0278; val_kl_reg_loss: 25200.6230; val_edge_recon_loss: 2678869.7500; val_gene_expr_recon_loss: 256634.2344; val_masked_gp_l1_reg_loss: 1858.1616; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037622.8125; val_global_loss: 4000185.5000; val_optim_loss: 4000185.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9616; val_auprc_score: 0.9504; val_best_acc_score: 0.9051; val_best_f1_score: 0.9097; train_kl_reg_loss: 25191.5903; train_edge_recon_loss: 2661831.6111; train_gene_expr_recon_loss: 256614.6979; train_masked_gp_l1_reg_loss: 1880.5130; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023597.0625; train_global_loss: 3969115.4722; train_optim_loss: 3969115.4722; val_kl_reg_loss: 24221.8086; val_edge_recon_loss: 2669609.2500; val_gene_expr_recon_loss: 256120.0781; val_masked_gp_l1_reg_loss: 1907.9890; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038343.1250; val_global_loss: 3990202.0000; val_optim_loss: 3990202.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9629; val_auprc_score: 0.9443; val_best_acc_score: 0.9143; val_best_f1_score: 0.9178; train_kl_reg_loss: 24163.9442; train_edge_recon_loss: 2653282.5000; train_gene_expr_recon_loss: 256650.2014; train_masked_gp_l1_reg_loss: 1929.8947; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020640.8403; train_global_loss: 3956667.3611; train_optim_loss: 3956667.3611; val_kl_reg_loss: 24467.1719; val_edge_recon_loss: 2664896.0000; val_gene_expr_recon_loss: 252047.2031; val_masked_gp_l1_reg_loss: 1952.1265; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1033417.4375; val_global_loss: 3976780.2500; val_optim_loss: 3976780.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9593; val_auprc_score: 0.9441; val_best_acc_score: 0.9093; val_best_f1_score: 0.9132; train_kl_reg_loss: 24697.6170; train_edge_recon_loss: 2647117.8611; train_gene_expr_recon_loss: 253403.9410; train_masked_gp_l1_reg_loss: 1965.2098; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014415.6458; train_global_loss: 3941600.3056; train_optim_loss: 3941600.3056; val_kl_reg_loss: 24675.7305; val_edge_recon_loss: 2680591.2500; val_gene_expr_recon_loss: 253128.3125; val_masked_gp_l1_reg_loss: 1977.8921; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1033345.6250; val_global_loss: 3993719.0000; val_optim_loss: 3993719.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9669; val_auprc_score: 0.9507; val_best_acc_score: 0.9189; val_best_f1_score: 0.9220; train_kl_reg_loss: 24814.2604; train_edge_recon_loss: 2648482.1111; train_gene_expr_recon_loss: 251850.6667; train_masked_gp_l1_reg_loss: 1991.1304; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015124.7708; train_global_loss: 3942263.0000; train_optim_loss: 3942263.0000; val_kl_reg_loss: 24649.9414; val_edge_recon_loss: 2671358.0000; val_gene_expr_recon_loss: 252678.0781; val_masked_gp_l1_reg_loss: 2005.2246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032268.9375; val_global_loss: 3982960.2500; val_optim_loss: 3982960.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9689; val_auprc_score: 0.9575; val_best_acc_score: 0.9235; val_best_f1_score: 0.9263; train_kl_reg_loss: 23766.1098; train_edge_recon_loss: 2648127.1389; train_gene_expr_recon_loss: 249335.0417; train_masked_gp_l1_reg_loss: 2015.1107; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005381.8611; train_global_loss: 3928625.2500; train_optim_loss: 3928625.2500; val_kl_reg_loss: 23987.5000; val_edge_recon_loss: 2649346.5000; val_gene_expr_recon_loss: 250831.0625; val_masked_gp_l1_reg_loss: 2025.3101; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031095.6250; val_global_loss: 3957286.0000; val_optim_loss: 3957286.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9650; val_auprc_score: 0.9493; val_best_acc_score: 0.9204; val_best_f1_score: 0.9232; train_kl_reg_loss: 24537.4497; train_edge_recon_loss: 2637232.4722; train_gene_expr_recon_loss: 248862.3438; train_masked_gp_l1_reg_loss: 2033.7318; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009756.2639; train_global_loss: 3922422.3056; train_optim_loss: 3922422.3056; val_kl_reg_loss: 25035.9004; val_edge_recon_loss: 2666667.5000; val_gene_expr_recon_loss: 246414.5000; val_masked_gp_l1_reg_loss: 2045.6416; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025207.0625; val_global_loss: 3965370.7500; val_optim_loss: 3965370.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9670; val_auprc_score: 0.9559; val_best_acc_score: 0.9174; val_best_f1_score: 0.9218; train_kl_reg_loss: 25414.4544; train_edge_recon_loss: 2648882.8611; train_gene_expr_recon_loss: 246029.7135; train_masked_gp_l1_reg_loss: 2057.6465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002869.2153; train_global_loss: 3925253.9722; train_optim_loss: 3925253.9722; val_kl_reg_loss: 25240.3867; val_edge_recon_loss: 2664018.0000; val_gene_expr_recon_loss: 246342.4688; val_masked_gp_l1_reg_loss: 2071.0801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024486.8125; val_global_loss: 3962158.7500; val_optim_loss: 3962158.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9693; val_auprc_score: 0.9569; val_best_acc_score: 0.9220; val_best_f1_score: 0.9253; train_kl_reg_loss: 25181.8906; train_edge_recon_loss: 2638002.0833; train_gene_expr_recon_loss: 245386.4253; train_masked_gp_l1_reg_loss: 2086.9440; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007326.9931; train_global_loss: 3917984.3056; train_optim_loss: 3917984.3056; val_kl_reg_loss: 25052.5391; val_edge_recon_loss: 2659202.0000; val_gene_expr_recon_loss: 244908.3125; val_masked_gp_l1_reg_loss: 2101.7317; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022051.6875; val_global_loss: 3953316.2500; val_optim_loss: 3953316.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9684; val_auprc_score: 0.9523; val_best_acc_score: 0.9212; val_best_f1_score: 0.9242; train_kl_reg_loss: 25300.8303; train_edge_recon_loss: 2644629.5000; train_gene_expr_recon_loss: 243152.8073; train_masked_gp_l1_reg_loss: 2115.0742; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003478.3750; train_global_loss: 3918676.5833; train_optim_loss: 3918676.5833; val_kl_reg_loss: 24642.1152; val_edge_recon_loss: 2652256.5000; val_gene_expr_recon_loss: 246036.6562; val_masked_gp_l1_reg_loss: 2131.0083; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024920.9375; val_global_loss: 3949987.2500; val_optim_loss: 3949987.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9721; val_auprc_score: 0.9626; val_best_acc_score: 0.9258; val_best_f1_score: 0.9291; train_kl_reg_loss: 25396.6165; train_edge_recon_loss: 2635657.2778; train_gene_expr_recon_loss: 244070.2361; train_masked_gp_l1_reg_loss: 2144.7080; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008324.0278; train_global_loss: 3915592.8333; train_optim_loss: 3915592.8333; val_kl_reg_loss: 24981.4492; val_edge_recon_loss: 2636749.2500; val_gene_expr_recon_loss: 245252.0000; val_masked_gp_l1_reg_loss: 2154.9075; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022426.2500; val_global_loss: 3931564.0000; val_optim_loss: 3931564.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9727; val_auprc_score: 0.9622; val_best_acc_score: 0.9278; val_best_f1_score: 0.9304; train_kl_reg_loss: 26165.0082; train_edge_recon_loss: 2629775.9167; train_gene_expr_recon_loss: 241802.6979; train_masked_gp_l1_reg_loss: 2168.6655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001217.4236; train_global_loss: 3901129.6944; train_optim_loss: 3901129.6944; val_kl_reg_loss: 25427.3633; val_edge_recon_loss: 2657225.2500; val_gene_expr_recon_loss: 243034.7344; val_masked_gp_l1_reg_loss: 2180.6335; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019127.0000; val_global_loss: 3946995.0000; val_optim_loss: 3946995.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9727; val_auprc_score: 0.9583; val_best_acc_score: 0.9329; val_best_f1_score: 0.9356; train_kl_reg_loss: 25803.6087; train_edge_recon_loss: 2638257.1111; train_gene_expr_recon_loss: 240750.8368; train_masked_gp_l1_reg_loss: 2192.6278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000390.9514; train_global_loss: 3907395.1111; train_optim_loss: 3907395.1111; val_kl_reg_loss: 25290.5938; val_edge_recon_loss: 2646868.7500; val_gene_expr_recon_loss: 242524.6562; val_masked_gp_l1_reg_loss: 2204.9692; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019020.3125; val_global_loss: 3935909.2500; val_optim_loss: 3935909.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9749; val_auprc_score: 0.9657; val_best_acc_score: 0.9333; val_best_f1_score: 0.9357; train_kl_reg_loss: 25842.5061; train_edge_recon_loss: 2640005.9444; train_gene_expr_recon_loss: 238381.1632; train_masked_gp_l1_reg_loss: 2219.9671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992805.0625; train_global_loss: 3899254.5278; train_optim_loss: 3899254.5278; val_kl_reg_loss: 24893.1484; val_edge_recon_loss: 2638535.7500; val_gene_expr_recon_loss: 242301.9844; val_masked_gp_l1_reg_loss: 2235.6934; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018792.5000; val_global_loss: 3926759.2500; val_optim_loss: 3926759.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9765; val_auprc_score: 0.9643; val_best_acc_score: 0.9355; val_best_f1_score: 0.9378; train_kl_reg_loss: 25378.0566; train_edge_recon_loss: 2635082.0000; train_gene_expr_recon_loss: 238650.8299; train_masked_gp_l1_reg_loss: 2249.5403; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997244.0417; train_global_loss: 3898604.5556; train_optim_loss: 3898604.5556; val_kl_reg_loss: 25601.4375; val_edge_recon_loss: 2645048.2500; val_gene_expr_recon_loss: 240593.2500; val_masked_gp_l1_reg_loss: 2264.1794; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016058.3750; val_global_loss: 3929565.5000; val_optim_loss: 3929565.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9781; val_auprc_score: 0.9681; val_best_acc_score: 0.9422; val_best_f1_score: 0.9440; train_kl_reg_loss: 26315.7858; train_edge_recon_loss: 2632393.1667; train_gene_expr_recon_loss: 237263.8073; train_masked_gp_l1_reg_loss: 2279.5061; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993290.0417; train_global_loss: 3891542.3333; train_optim_loss: 3891542.3333; val_kl_reg_loss: 26034.8359; val_edge_recon_loss: 2616518.2500; val_gene_expr_recon_loss: 238983.5625; val_masked_gp_l1_reg_loss: 2294.5774; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015109.3750; val_global_loss: 3898940.5000; val_optim_loss: 3898940.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9746; val_auprc_score: 0.9643; val_best_acc_score: 0.9348; val_best_f1_score: 0.9378; train_kl_reg_loss: 26258.2930; train_edge_recon_loss: 2636697.0556; train_gene_expr_recon_loss: 236651.1042; train_masked_gp_l1_reg_loss: 2308.2991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994122.1181; train_global_loss: 3896036.8333; train_optim_loss: 3896036.8333; val_kl_reg_loss: 25103.7344; val_edge_recon_loss: 2654025.0000; val_gene_expr_recon_loss: 239205.0781; val_masked_gp_l1_reg_loss: 2319.3232; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013434.1250; val_global_loss: 3934087.0000; val_optim_loss: 3934087.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9731; val_auprc_score: 0.9609; val_best_acc_score: 0.9336; val_best_f1_score: 0.9363; train_kl_reg_loss: 25692.2172; train_edge_recon_loss: 2630238.8056; train_gene_expr_recon_loss: 237894.7674; train_masked_gp_l1_reg_loss: 2333.4818; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 995884.8750; train_global_loss: 3892044.1111; train_optim_loss: 3892044.1111; val_kl_reg_loss: 25270.2891; val_edge_recon_loss: 2652991.0000; val_gene_expr_recon_loss: 239886.6562; val_masked_gp_l1_reg_loss: 2346.8064; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013711.5000; val_global_loss: 3934206.2500; val_optim_loss: 3934206.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9749; val_auprc_score: 0.9637; val_best_acc_score: 0.9341; val_best_f1_score: 0.9360; train_kl_reg_loss: 25892.1233; train_edge_recon_loss: 2639984.2778; train_gene_expr_recon_loss: 235896.2413; train_masked_gp_l1_reg_loss: 2363.3445; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992709.8958; train_global_loss: 3896845.8333; train_optim_loss: 3896845.8333; val_kl_reg_loss: 25363.2012; val_edge_recon_loss: 2659537.0000; val_gene_expr_recon_loss: 237970.0781; val_masked_gp_l1_reg_loss: 2381.2021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010304.8125; val_global_loss: 3935556.2500; val_optim_loss: 3935556.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9765; val_auprc_score: 0.9633; val_best_acc_score: 0.9410; val_best_f1_score: 0.9422; train_kl_reg_loss: 26474.0948; train_edge_recon_loss: 2630367.6944; train_gene_expr_recon_loss: 235849.3681; train_masked_gp_l1_reg_loss: 2396.6306; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989123.6528; train_global_loss: 3884211.3611; train_optim_loss: 3884211.3611; val_kl_reg_loss: 26095.5215; val_edge_recon_loss: 2651549.2500; val_gene_expr_recon_loss: 235812.6094; val_masked_gp_l1_reg_loss: 2414.1165; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009123.6875; val_global_loss: 3924995.0000; val_optim_loss: 3924995.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9784; val_auprc_score: 0.9702; val_best_acc_score: 0.9415; val_best_f1_score: 0.9428; train_kl_reg_loss: 26490.2702; train_edge_recon_loss: 2625259.3889; train_gene_expr_recon_loss: 233891.8559; train_masked_gp_l1_reg_loss: 2411.8245; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988213.7986; train_global_loss: 3876267.1111; train_optim_loss: 3876267.1111; val_kl_reg_loss: 25507.3750; val_edge_recon_loss: 2629826.7500; val_gene_expr_recon_loss: 236712.0625; val_masked_gp_l1_reg_loss: 2405.6724; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008667.6250; val_global_loss: 3903119.5000; val_optim_loss: 3903119.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9765; val_auprc_score: 0.9652; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 26192.0082; train_edge_recon_loss: 2627295.2222; train_gene_expr_recon_loss: 234174.9427; train_masked_gp_l1_reg_loss: 2401.9375; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988664.1667; train_global_loss: 3878728.2500; train_optim_loss: 3878728.2500; val_kl_reg_loss: 25746.5312; val_edge_recon_loss: 2633749.0000; val_gene_expr_recon_loss: 235985.7969; val_masked_gp_l1_reg_loss: 2398.5205; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008189.5000; val_global_loss: 3906069.2500; val_optim_loss: 3906069.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9771; val_auprc_score: 0.9655; val_best_acc_score: 0.9407; val_best_f1_score: 0.9425; train_kl_reg_loss: 26299.5966; train_edge_recon_loss: 2624802.6944; train_gene_expr_recon_loss: 234018.5816; train_masked_gp_l1_reg_loss: 2397.4784; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992486.1042; train_global_loss: 3880004.4167; train_optim_loss: 3880004.4167; val_kl_reg_loss: 25620.5469; val_edge_recon_loss: 2630664.5000; val_gene_expr_recon_loss: 236515.5156; val_masked_gp_l1_reg_loss: 2395.9568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009102.1250; val_global_loss: 3904298.5000; val_optim_loss: 3904298.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9744; val_auprc_score: 0.9637; val_best_acc_score: 0.9392; val_best_f1_score: 0.9411; train_kl_reg_loss: 26146.0970; train_edge_recon_loss: 2629406.5278; train_gene_expr_recon_loss: 234880.3542; train_masked_gp_l1_reg_loss: 2395.4266; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993134.7569; train_global_loss: 3885963.1667; train_optim_loss: 3885963.1667; val_kl_reg_loss: 25615.8633; val_edge_recon_loss: 2651677.7500; val_gene_expr_recon_loss: 236115.3750; val_masked_gp_l1_reg_loss: 2394.6548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010135.6250; val_global_loss: 3925939.5000; val_optim_loss: 3925939.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 28 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9756
Val AUPRC score: 0.9646
Val best accuracy score: 0.9367
Val best F1 score: 0.9390
Val gene expr MSE score: 0.4987
Val chrom access MSE score: 0.0908
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
