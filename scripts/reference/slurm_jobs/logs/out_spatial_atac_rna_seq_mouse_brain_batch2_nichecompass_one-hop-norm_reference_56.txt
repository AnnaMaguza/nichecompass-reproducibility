[True]
Run timestamp: 07092023_165810_56.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_56']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6026; val_auprc_score: 0.5969; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 43523.9208; train_edge_recon_loss: 3552137.6061; train_gene_expr_recon_loss: 28353326.2121; train_masked_gp_l1_reg_loss: 98311.2560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1593816.2689; train_chrom_access_recon_loss: 3004959.8864; train_global_loss: 36646074.8788; train_optim_loss: 36646074.8788; val_kl_reg_loss: 222460.7363; val_edge_recon_loss: 4065804.4688; val_gene_expr_recon_loss: 26104973.5000; val_masked_gp_l1_reg_loss: 98785.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1371141.2500; val_chrom_access_recon_loss: 2901292.6250; val_global_loss: 34764459.5000; val_optim_loss: 34764459.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7261; val_auprc_score: 0.6989; val_best_acc_score: 0.5497; val_best_f1_score: 0.6865; train_kl_reg_loss: 101933.4840; train_edge_recon_loss: 3547122.5000; train_gene_expr_recon_loss: 24925802.1818; train_masked_gp_l1_reg_loss: 91028.0833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1131891.8343; train_chrom_access_recon_loss: 2843982.7311; train_global_loss: 32641760.6667; train_optim_loss: 32641760.6667; val_kl_reg_loss: 114255.8477; val_edge_recon_loss: 4062545.6250; val_gene_expr_recon_loss: 25002448.0000; val_masked_gp_l1_reg_loss: 86301.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 902966.8750; val_chrom_access_recon_loss: 2822860.7188; val_global_loss: 32991378.2500; val_optim_loss: 32991378.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7285; val_auprc_score: 0.7101; val_best_acc_score: 0.6427; val_best_f1_score: 0.7083; train_kl_reg_loss: 109268.1387; train_edge_recon_loss: 3530146.4242; train_gene_expr_recon_loss: 24372264.5758; train_masked_gp_l1_reg_loss: 84520.9795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 730129.0710; train_chrom_access_recon_loss: 2807636.3409; train_global_loss: 31633965.4848; train_optim_loss: 31633965.4848; val_kl_reg_loss: 117185.3857; val_edge_recon_loss: 4048761.5000; val_gene_expr_recon_loss: 24639790.5000; val_masked_gp_l1_reg_loss: 83678.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 579661.9375; val_chrom_access_recon_loss: 2799259.2812; val_global_loss: 32268336.2500; val_optim_loss: 32268336.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8214; val_auprc_score: 0.8015; val_best_acc_score: 0.7176; val_best_f1_score: 0.7430; train_kl_reg_loss: 101864.9899; train_edge_recon_loss: 3518001.2121; train_gene_expr_recon_loss: 24122355.3030; train_masked_gp_l1_reg_loss: 84484.0820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 478720.2027; train_chrom_access_recon_loss: 2785287.1098; train_global_loss: 31090712.8182; train_optim_loss: 31090712.8182; val_kl_reg_loss: 100378.1074; val_edge_recon_loss: 3979844.4062; val_gene_expr_recon_loss: 24414150.2500; val_masked_gp_l1_reg_loss: 85738.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 393140.2812; val_chrom_access_recon_loss: 2807846.0000; val_global_loss: 31781096.5000; val_optim_loss: 31781096.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8588; val_auprc_score: 0.8214; val_best_acc_score: 0.7861; val_best_f1_score: 0.8104; train_kl_reg_loss: 86913.1843; train_edge_recon_loss: 3468587.7955; train_gene_expr_recon_loss: 23950903.3333; train_masked_gp_l1_reg_loss: 87542.6291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 335727.7140; train_chrom_access_recon_loss: 2771520.4811; train_global_loss: 30701195.4545; train_optim_loss: 30701195.4545; val_kl_reg_loss: 70255.3408; val_edge_recon_loss: 3539096.2188; val_gene_expr_recon_loss: 24348635.5000; val_masked_gp_l1_reg_loss: 89696.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 284499.0000; val_chrom_access_recon_loss: 2762910.4375; val_global_loss: 31095092.5000; val_optim_loss: 31095092.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8731; val_auprc_score: 0.8427; val_best_acc_score: 0.7934; val_best_f1_score: 0.8095; train_kl_reg_loss: 83954.0072; train_edge_recon_loss: 3168181.5265; train_gene_expr_recon_loss: 23901691.4848; train_masked_gp_l1_reg_loss: 92583.2549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 248132.8501; train_chrom_access_recon_loss: 2769922.2462; train_global_loss: 30264465.5455; train_optim_loss: 30264465.5455; val_kl_reg_loss: 76102.7568; val_edge_recon_loss: 3196157.6562; val_gene_expr_recon_loss: 24321899.5000; val_masked_gp_l1_reg_loss: 95682.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218512.9375; val_chrom_access_recon_loss: 2777132.9062; val_global_loss: 30685487.2500; val_optim_loss: 30685487.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8433; val_auprc_score: 0.7952; val_best_acc_score: 0.7767; val_best_f1_score: 0.8011; train_kl_reg_loss: 102412.3857; train_edge_recon_loss: 3022069.4432; train_gene_expr_recon_loss: 23726069.0000; train_masked_gp_l1_reg_loss: 97548.0356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193248.4647; train_chrom_access_recon_loss: 2749107.3788; train_global_loss: 29890454.4242; train_optim_loss: 29890454.4242; val_kl_reg_loss: 110321.1807; val_edge_recon_loss: 2970793.6250; val_gene_expr_recon_loss: 23887567.0000; val_masked_gp_l1_reg_loss: 98229.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170896.0000; val_chrom_access_recon_loss: 2744196.2812; val_global_loss: 29982004.0000; val_optim_loss: 29982004.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8519; val_auprc_score: 0.8089; val_best_acc_score: 0.7845; val_best_f1_score: 0.8031; train_kl_reg_loss: 115689.9600; train_edge_recon_loss: 2968916.3447; train_gene_expr_recon_loss: 23614427.2121; train_masked_gp_l1_reg_loss: 98834.3888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154560.5353; train_chrom_access_recon_loss: 2737228.7083; train_global_loss: 29689656.9697; train_optim_loss: 29689656.9697; val_kl_reg_loss: 114819.8057; val_edge_recon_loss: 2955282.4375; val_gene_expr_recon_loss: 23877579.0000; val_masked_gp_l1_reg_loss: 99994.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140230.7812; val_chrom_access_recon_loss: 2729519.5312; val_global_loss: 29917424.7500; val_optim_loss: 29917424.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8583; val_auprc_score: 0.8154; val_best_acc_score: 0.7877; val_best_f1_score: 0.8126; train_kl_reg_loss: 112256.8074; train_edge_recon_loss: 2947056.8523; train_gene_expr_recon_loss: 23495091.2424; train_masked_gp_l1_reg_loss: 100976.2178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129049.2172; train_chrom_access_recon_loss: 2723329.4621; train_global_loss: 29507759.8788; train_optim_loss: 29507759.8788; val_kl_reg_loss: 113996.9004; val_edge_recon_loss: 2924406.9062; val_gene_expr_recon_loss: 23885219.2500; val_masked_gp_l1_reg_loss: 102193.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119293.6016; val_chrom_access_recon_loss: 2743683.5938; val_global_loss: 29888794.7500; val_optim_loss: 29888794.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8659; val_auprc_score: 0.8323; val_best_acc_score: 0.7896; val_best_f1_score: 0.8166; train_kl_reg_loss: 108802.3656; train_edge_recon_loss: 2936875.3220; train_gene_expr_recon_loss: 23391435.3030; train_masked_gp_l1_reg_loss: 103024.1024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111398.3632; train_chrom_access_recon_loss: 2708643.5038; train_global_loss: 29360179.2121; train_optim_loss: 29360179.2121; val_kl_reg_loss: 111217.0713; val_edge_recon_loss: 2917334.6250; val_gene_expr_recon_loss: 23657019.2500; val_masked_gp_l1_reg_loss: 103916.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104211.8906; val_chrom_access_recon_loss: 2710935.6250; val_global_loss: 29604634.2500; val_optim_loss: 29604634.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8745; val_auprc_score: 0.8404; val_best_acc_score: 0.7980; val_best_f1_score: 0.8220; train_kl_reg_loss: 106956.2255; train_edge_recon_loss: 2921586.1023; train_gene_expr_recon_loss: 23287354.6364; train_masked_gp_l1_reg_loss: 104860.6186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98532.8923; train_chrom_access_recon_loss: 2698253.5985; train_global_loss: 29217544.2121; train_optim_loss: 29217544.2121; val_kl_reg_loss: 107730.8623; val_edge_recon_loss: 2902478.0625; val_gene_expr_recon_loss: 23649525.5000; val_masked_gp_l1_reg_loss: 105940.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93338.7969; val_chrom_access_recon_loss: 2707119.8125; val_global_loss: 29566132.7500; val_optim_loss: 29566132.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8776; val_auprc_score: 0.8419; val_best_acc_score: 0.8015; val_best_f1_score: 0.8235; train_kl_reg_loss: 106843.5371; train_edge_recon_loss: 2886311.6629; train_gene_expr_recon_loss: 23217457.0303; train_masked_gp_l1_reg_loss: 106810.3694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88841.8101; train_chrom_access_recon_loss: 2691594.0795; train_global_loss: 29097858.4242; train_optim_loss: 29097858.4242; val_kl_reg_loss: 106804.7344; val_edge_recon_loss: 2913781.5625; val_gene_expr_recon_loss: 23472322.2500; val_masked_gp_l1_reg_loss: 108764.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85339.3438; val_chrom_access_recon_loss: 2681263.1250; val_global_loss: 29368275.7500; val_optim_loss: 29368275.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8965; val_auprc_score: 0.8709; val_best_acc_score: 0.8211; val_best_f1_score: 0.8374; train_kl_reg_loss: 104152.6323; train_edge_recon_loss: 2859544.0114; train_gene_expr_recon_loss: 23151211.5758; train_masked_gp_l1_reg_loss: 109474.5085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81575.7485; train_chrom_access_recon_loss: 2682513.7803; train_global_loss: 28988472.2121; train_optim_loss: 28988472.2121; val_kl_reg_loss: 102852.3789; val_edge_recon_loss: 2860948.5625; val_gene_expr_recon_loss: 23610050.0000; val_masked_gp_l1_reg_loss: 110392.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78235.3281; val_chrom_access_recon_loss: 2693035.7812; val_global_loss: 29455515.2500; val_optim_loss: 29455515.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9084; val_auprc_score: 0.8763; val_best_acc_score: 0.8444; val_best_f1_score: 0.8564; train_kl_reg_loss: 106892.3500; train_edge_recon_loss: 2837200.4053; train_gene_expr_recon_loss: 23078609.2727; train_masked_gp_l1_reg_loss: 110917.4937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75524.0156; train_chrom_access_recon_loss: 2674038.3750; train_global_loss: 28883182.0606; train_optim_loss: 28883182.0606; val_kl_reg_loss: 102734.1777; val_edge_recon_loss: 2866832.4062; val_gene_expr_recon_loss: 23441263.0000; val_masked_gp_l1_reg_loss: 111855.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73447.8438; val_chrom_access_recon_loss: 2683772.0938; val_global_loss: 29279905.7500; val_optim_loss: 29279905.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9160; val_auprc_score: 0.8868; val_best_acc_score: 0.8514; val_best_f1_score: 0.8629; train_kl_reg_loss: 105776.7962; train_edge_recon_loss: 2812578.9432; train_gene_expr_recon_loss: 22995530.8182; train_masked_gp_l1_reg_loss: 112556.2557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71268.7057; train_chrom_access_recon_loss: 2665038.5038; train_global_loss: 28762750.0303; train_optim_loss: 28762750.0303; val_kl_reg_loss: 110977.1416; val_edge_recon_loss: 2837853.9688; val_gene_expr_recon_loss: 23425207.2500; val_masked_gp_l1_reg_loss: 113314.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69131.4844; val_chrom_access_recon_loss: 2685877.6250; val_global_loss: 29242362.0000; val_optim_loss: 29242362.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9247; val_auprc_score: 0.8984; val_best_acc_score: 0.8627; val_best_f1_score: 0.8717; train_kl_reg_loss: 108206.6945; train_edge_recon_loss: 2796723.2008; train_gene_expr_recon_loss: 22922880.5758; train_masked_gp_l1_reg_loss: 114013.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67470.0901; train_chrom_access_recon_loss: 2654793.1288; train_global_loss: 28664087.6970; train_optim_loss: 28664087.6970; val_kl_reg_loss: 102858.8965; val_edge_recon_loss: 2837480.9062; val_gene_expr_recon_loss: 23346733.7500; val_masked_gp_l1_reg_loss: 114819.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66055.9688; val_chrom_access_recon_loss: 2667410.1250; val_global_loss: 29135359.7500; val_optim_loss: 29135359.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9288; val_auprc_score: 0.8930; val_best_acc_score: 0.8694; val_best_f1_score: 0.8773; train_kl_reg_loss: 106289.6129; train_edge_recon_loss: 2787340.7008; train_gene_expr_recon_loss: 22863062.1515; train_masked_gp_l1_reg_loss: 115539.1473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64336.8506; train_chrom_access_recon_loss: 2648413.2083; train_global_loss: 28584981.5758; train_optim_loss: 28584981.5758; val_kl_reg_loss: 106469.7080; val_edge_recon_loss: 2793810.4375; val_gene_expr_recon_loss: 23064498.0000; val_masked_gp_l1_reg_loss: 116440.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63095.1953; val_chrom_access_recon_loss: 2656334.5000; val_global_loss: 28800649.0000; val_optim_loss: 28800649.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9290; val_auprc_score: 0.9020; val_best_acc_score: 0.8697; val_best_f1_score: 0.8768; train_kl_reg_loss: 107464.7237; train_edge_recon_loss: 2782422.9356; train_gene_expr_recon_loss: 22822892.1212; train_masked_gp_l1_reg_loss: 116891.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61707.6045; train_chrom_access_recon_loss: 2639593.9773; train_global_loss: 28530972.6667; train_optim_loss: 28530972.6667; val_kl_reg_loss: 103434.7900; val_edge_recon_loss: 2823112.0938; val_gene_expr_recon_loss: 23174234.0000; val_masked_gp_l1_reg_loss: 117666.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60886.3906; val_chrom_access_recon_loss: 2666840.2812; val_global_loss: 28946173.2500; val_optim_loss: 28946173.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9332; val_auprc_score: 0.9047; val_best_acc_score: 0.8748; val_best_f1_score: 0.8826; train_kl_reg_loss: 105295.8110; train_edge_recon_loss: 2774496.0455; train_gene_expr_recon_loss: 22755888.9394; train_masked_gp_l1_reg_loss: 118217.2943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59424.7075; train_chrom_access_recon_loss: 2633678.7576; train_global_loss: 28447001.3030; train_optim_loss: 28447001.3030; val_kl_reg_loss: 107289.7188; val_edge_recon_loss: 2793771.0938; val_gene_expr_recon_loss: 22926403.5000; val_masked_gp_l1_reg_loss: 118821.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58605.9492; val_chrom_access_recon_loss: 2619484.4375; val_global_loss: 28624376.7500; val_optim_loss: 28624376.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9345; val_auprc_score: 0.9106; val_best_acc_score: 0.8756; val_best_f1_score: 0.8814; train_kl_reg_loss: 103848.2389; train_edge_recon_loss: 2769426.0265; train_gene_expr_recon_loss: 22684270.7879; train_masked_gp_l1_reg_loss: 119339.3877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57395.7326; train_chrom_access_recon_loss: 2626345.2386; train_global_loss: 28360625.3636; train_optim_loss: 28360625.3636; val_kl_reg_loss: 102994.7070; val_edge_recon_loss: 2801109.5938; val_gene_expr_recon_loss: 23095090.7500; val_masked_gp_l1_reg_loss: 120118.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56544.8750; val_chrom_access_recon_loss: 2655649.0312; val_global_loss: 28831506.2500; val_optim_loss: 28831506.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9370; val_auprc_score: 0.9147; val_best_acc_score: 0.8788; val_best_f1_score: 0.8856; train_kl_reg_loss: 102105.8372; train_edge_recon_loss: 2757448.8939; train_gene_expr_recon_loss: 22647501.8182; train_masked_gp_l1_reg_loss: 120564.2914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55522.4464; train_chrom_access_recon_loss: 2621272.1780; train_global_loss: 28304415.4848; train_optim_loss: 28304415.4848; val_kl_reg_loss: 100242.2275; val_edge_recon_loss: 2789290.3750; val_gene_expr_recon_loss: 23008434.0000; val_masked_gp_l1_reg_loss: 121264.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54772.9727; val_chrom_access_recon_loss: 2628444.8125; val_global_loss: 28702448.2500; val_optim_loss: 28702448.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9343; val_auprc_score: 0.9143; val_best_acc_score: 0.8702; val_best_f1_score: 0.8774; train_kl_reg_loss: 101851.5084; train_edge_recon_loss: 2750760.4280; train_gene_expr_recon_loss: 22606220.8788; train_masked_gp_l1_reg_loss: 121663.2570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54073.5712; train_chrom_access_recon_loss: 2613194.9811; train_global_loss: 28247764.7273; train_optim_loss: 28247764.7273; val_kl_reg_loss: 99843.1826; val_edge_recon_loss: 2830304.5000; val_gene_expr_recon_loss: 23020156.2500; val_masked_gp_l1_reg_loss: 122082.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53564.9414; val_chrom_access_recon_loss: 2628834.4688; val_global_loss: 28754785.0000; val_optim_loss: 28754785.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9364; val_auprc_score: 0.9118; val_best_acc_score: 0.8775; val_best_f1_score: 0.8854; train_kl_reg_loss: 101391.8245; train_edge_recon_loss: 2742957.7083; train_gene_expr_recon_loss: 22542237.9394; train_masked_gp_l1_reg_loss: 122606.1638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52914.5143; train_chrom_access_recon_loss: 2604859.6894; train_global_loss: 28166967.7879; train_optim_loss: 28166967.7879; val_kl_reg_loss: 101363.5830; val_edge_recon_loss: 2802240.0625; val_gene_expr_recon_loss: 23019647.5000; val_masked_gp_l1_reg_loss: 123073.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52456.2852; val_chrom_access_recon_loss: 2638910.7188; val_global_loss: 28737691.5000; val_optim_loss: 28737691.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9375; val_auprc_score: 0.9153; val_best_acc_score: 0.8783; val_best_f1_score: 0.8856; train_kl_reg_loss: 101616.1330; train_edge_recon_loss: 2747602.5871; train_gene_expr_recon_loss: 22516716.2121; train_masked_gp_l1_reg_loss: 121364.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45281.6884; train_chrom_access_recon_loss: 2602738.6667; train_global_loss: 28135319.9091; train_optim_loss: 28135319.9091; val_kl_reg_loss: 102435.2666; val_edge_recon_loss: 2775288.3750; val_gene_expr_recon_loss: 23093549.0000; val_masked_gp_l1_reg_loss: 120384.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42214.9570; val_chrom_access_recon_loss: 2632790.0625; val_global_loss: 28766661.0000; val_optim_loss: 28766661.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9357; val_auprc_score: 0.9091; val_best_acc_score: 0.8802; val_best_f1_score: 0.8859; train_kl_reg_loss: 102358.6216; train_edge_recon_loss: 2745489.8636; train_gene_expr_recon_loss: 22490371.7273; train_masked_gp_l1_reg_loss: 120159.2772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41757.1200; train_chrom_access_recon_loss: 2598854.7045; train_global_loss: 28098991.6364; train_optim_loss: 28098991.6364; val_kl_reg_loss: 102457.6309; val_edge_recon_loss: 2771856.5312; val_gene_expr_recon_loss: 22945583.7500; val_masked_gp_l1_reg_loss: 120034.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41486.5039; val_chrom_access_recon_loss: 2635113.7812; val_global_loss: 28616532.0000; val_optim_loss: 28616532.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9404; val_auprc_score: 0.9176; val_best_acc_score: 0.8812; val_best_f1_score: 0.8889; train_kl_reg_loss: 112136.9356; train_edge_recon_loss: 2785395.4811; train_gene_expr_recon_loss: 22331121.6970; train_masked_gp_l1_reg_loss: 119585.7914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40097.0871; train_chrom_access_recon_loss: 2599582.4015; train_global_loss: 27987919.2121; train_optim_loss: 27987919.2121; val_kl_reg_loss: 72271.2656; val_edge_recon_loss: 2816032.8750; val_gene_expr_recon_loss: 22909684.5000; val_masked_gp_l1_reg_loss: 119391.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39299.9922; val_chrom_access_recon_loss: 2619124.0938; val_global_loss: 28575804.5000; val_optim_loss: 28575804.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9402; val_auprc_score: 0.9193; val_best_acc_score: 0.8853; val_best_f1_score: 0.8922; train_kl_reg_loss: 115184.0797; train_edge_recon_loss: 2794500.7992; train_gene_expr_recon_loss: 22195192.1515; train_masked_gp_l1_reg_loss: 119364.0063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38924.3331; train_chrom_access_recon_loss: 2568391.4773; train_global_loss: 27831557.0303; train_optim_loss: 27831557.0303; val_kl_reg_loss: 72840.6680; val_edge_recon_loss: 2810690.2188; val_gene_expr_recon_loss: 22658478.7500; val_masked_gp_l1_reg_loss: 119356.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38549.4609; val_chrom_access_recon_loss: 2591881.5312; val_global_loss: 28291797.7500; val_optim_loss: 28291797.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9494; val_auprc_score: 0.9358; val_best_acc_score: 0.8936; val_best_f1_score: 0.8977; train_kl_reg_loss: 115363.2724; train_edge_recon_loss: 2783568.6515; train_gene_expr_recon_loss: 22187269.7273; train_masked_gp_l1_reg_loss: 119373.0090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38241.7164; train_chrom_access_recon_loss: 2564308.2652; train_global_loss: 27808124.5152; train_optim_loss: 27808124.5152; val_kl_reg_loss: 73388.2607; val_edge_recon_loss: 2791247.0000; val_gene_expr_recon_loss: 22547790.0000; val_masked_gp_l1_reg_loss: 119395.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37955.3438; val_chrom_access_recon_loss: 2564640.3750; val_global_loss: 28134417.2500; val_optim_loss: 28134417.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9484; val_auprc_score: 0.9316; val_best_acc_score: 0.8872; val_best_f1_score: 0.8940; train_kl_reg_loss: 116372.8287; train_edge_recon_loss: 2779063.1250; train_gene_expr_recon_loss: 22160505.2424; train_masked_gp_l1_reg_loss: 119425.0102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37736.7031; train_chrom_access_recon_loss: 2561928.8826; train_global_loss: 27775032.1515; train_optim_loss: 27775032.1515; val_kl_reg_loss: 72943.0400; val_edge_recon_loss: 2805085.9062; val_gene_expr_recon_loss: 22504675.7500; val_masked_gp_l1_reg_loss: 119456.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37508.2578; val_chrom_access_recon_loss: 2565416.4375; val_global_loss: 28105085.5000; val_optim_loss: 28105085.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9466; val_auprc_score: 0.9280; val_best_acc_score: 0.8912; val_best_f1_score: 0.8966; train_kl_reg_loss: 116282.5249; train_edge_recon_loss: 2782279.1742; train_gene_expr_recon_loss: 22157598.0303; train_masked_gp_l1_reg_loss: 119501.5047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37336.2235; train_chrom_access_recon_loss: 2560919.1591; train_global_loss: 27773916.7576; train_optim_loss: 27773916.7576; val_kl_reg_loss: 74165.0059; val_edge_recon_loss: 2788640.0938; val_gene_expr_recon_loss: 22631153.0000; val_masked_gp_l1_reg_loss: 119507.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37144.2812; val_chrom_access_recon_loss: 2577920.1875; val_global_loss: 28228530.2500; val_optim_loss: 28228530.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9390; val_auprc_score: 0.9117; val_best_acc_score: 0.8815; val_best_f1_score: 0.8875; train_kl_reg_loss: 116301.7746; train_edge_recon_loss: 2776433.1515; train_gene_expr_recon_loss: 22148674.7879; train_masked_gp_l1_reg_loss: 119543.7633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37015.4625; train_chrom_access_recon_loss: 2558375.8826; train_global_loss: 27756344.7879; train_optim_loss: 27756344.7879; val_kl_reg_loss: 74679.1357; val_edge_recon_loss: 2821723.5000; val_gene_expr_recon_loss: 22640422.0000; val_masked_gp_l1_reg_loss: 119557.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36860.1094; val_chrom_access_recon_loss: 2577276.0625; val_global_loss: 28270518.2500; val_optim_loss: 28270518.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9409; val_auprc_score: 0.9157; val_best_acc_score: 0.8855; val_best_f1_score: 0.8912; train_kl_reg_loss: 116074.0243; train_edge_recon_loss: 2774766.0833; train_gene_expr_recon_loss: 22146122.1818; train_masked_gp_l1_reg_loss: 119594.9643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36749.9838; train_chrom_access_recon_loss: 2556638.9242; train_global_loss: 27749946.3333; train_optim_loss: 27749946.3333; val_kl_reg_loss: 74517.6924; val_edge_recon_loss: 2817742.4688; val_gene_expr_recon_loss: 22454761.2500; val_masked_gp_l1_reg_loss: 119625.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36619.9023; val_chrom_access_recon_loss: 2565700.3438; val_global_loss: 28068967.5000; val_optim_loss: 28068967.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9464; val_auprc_score: 0.9261; val_best_acc_score: 0.8893; val_best_f1_score: 0.8931; train_kl_reg_loss: 115422.4612; train_edge_recon_loss: 2772593.2765; train_gene_expr_recon_loss: 22132598.1515; train_masked_gp_l1_reg_loss: 119655.6798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36533.9946; train_chrom_access_recon_loss: 2555471.0417; train_global_loss: 27732274.5455; train_optim_loss: 27732274.5455; val_kl_reg_loss: 74077.6289; val_edge_recon_loss: 2779881.9062; val_gene_expr_recon_loss: 22480012.2500; val_masked_gp_l1_reg_loss: 119683.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36430.7344; val_chrom_access_recon_loss: 2550712.9688; val_global_loss: 28040798.5000; val_optim_loss: 28040798.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9471; val_auprc_score: 0.9265; val_best_acc_score: 0.8952; val_best_f1_score: 0.8994; train_kl_reg_loss: 115255.7597; train_edge_recon_loss: 2769867.8144; train_gene_expr_recon_loss: 22129735.3030; train_masked_gp_l1_reg_loss: 119718.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36347.6362; train_chrom_access_recon_loss: 2555156.7652; train_global_loss: 27726081.3333; train_optim_loss: 27726081.3333; val_kl_reg_loss: 75077.5986; val_edge_recon_loss: 2779311.7500; val_gene_expr_recon_loss: 22540462.5000; val_masked_gp_l1_reg_loss: 119719.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36226.8633; val_chrom_access_recon_loss: 2557361.2188; val_global_loss: 28108159.0000; val_optim_loss: 28108159.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9465; val_auprc_score: 0.9264; val_best_acc_score: 0.8941; val_best_f1_score: 0.8994; train_kl_reg_loss: 114492.6342; train_edge_recon_loss: 2775998.6023; train_gene_expr_recon_loss: 22140877.3636; train_masked_gp_l1_reg_loss: 119754.9509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36145.2373; train_chrom_access_recon_loss: 2556827.4394; train_global_loss: 27744096.3333; train_optim_loss: 27744096.3333; val_kl_reg_loss: 75634.8301; val_edge_recon_loss: 2776609.6250; val_gene_expr_recon_loss: 22540819.2500; val_masked_gp_l1_reg_loss: 119788.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36053.6172; val_chrom_access_recon_loss: 2566802.6875; val_global_loss: 28115708.0000; val_optim_loss: 28115708.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9410; val_auprc_score: 0.9159; val_best_acc_score: 0.8858; val_best_f1_score: 0.8924; train_kl_reg_loss: 114911.0640; train_edge_recon_loss: 2770577.7462; train_gene_expr_recon_loss: 22123217.4242; train_masked_gp_l1_reg_loss: 119809.1181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35986.5558; train_chrom_access_recon_loss: 2553580.0379; train_global_loss: 27718081.8788; train_optim_loss: 27718081.8788; val_kl_reg_loss: 77138.7158; val_edge_recon_loss: 2793201.9062; val_gene_expr_recon_loss: 22631576.7500; val_masked_gp_l1_reg_loss: 119844.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35903.9688; val_chrom_access_recon_loss: 2583486.0625; val_global_loss: 28241151.2500; val_optim_loss: 28241151.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9431; val_auprc_score: 0.9222; val_best_acc_score: 0.8888; val_best_f1_score: 0.8952; train_kl_reg_loss: 114599.3807; train_edge_recon_loss: 2757281.8902; train_gene_expr_recon_loss: 22094676.3333; train_masked_gp_l1_reg_loss: 119874.2621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35839.4661; train_chrom_access_recon_loss: 2552148.9811; train_global_loss: 27674420.2727; train_optim_loss: 27674420.2727; val_kl_reg_loss: 76483.6953; val_edge_recon_loss: 2785627.3125; val_gene_expr_recon_loss: 22455134.5000; val_masked_gp_l1_reg_loss: 119888.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35746.5859; val_chrom_access_recon_loss: 2533621.9062; val_global_loss: 28006501.5000; val_optim_loss: 28006501.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9471; val_auprc_score: 0.9295; val_best_acc_score: 0.8893; val_best_f1_score: 0.8933; train_kl_reg_loss: 113215.9602; train_edge_recon_loss: 2766183.5227; train_gene_expr_recon_loss: 22108183.6970; train_masked_gp_l1_reg_loss: 119924.0252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35694.4732; train_chrom_access_recon_loss: 2551250.2917; train_global_loss: 27694451.7879; train_optim_loss: 27694451.7879; val_kl_reg_loss: 77672.6348; val_edge_recon_loss: 2809840.0312; val_gene_expr_recon_loss: 22698847.7500; val_masked_gp_l1_reg_loss: 119930.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35608.4102; val_chrom_access_recon_loss: 2575886.6562; val_global_loss: 28317785.2500; val_optim_loss: 28317785.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9453; val_auprc_score: 0.9245; val_best_acc_score: 0.8907; val_best_f1_score: 0.8963; train_kl_reg_loss: 113138.2338; train_edge_recon_loss: 2763782.2917; train_gene_expr_recon_loss: 22097673.5758; train_masked_gp_l1_reg_loss: 119958.2430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35544.5024; train_chrom_access_recon_loss: 2550048.8295; train_global_loss: 27680145.7576; train_optim_loss: 27680145.7576; val_kl_reg_loss: 77575.4004; val_edge_recon_loss: 2785872.4062; val_gene_expr_recon_loss: 22395988.0000; val_masked_gp_l1_reg_loss: 119996.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35463.8242; val_chrom_access_recon_loss: 2550660.2188; val_global_loss: 27965556.2500; val_optim_loss: 27965556.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9424; val_auprc_score: 0.9208; val_best_acc_score: 0.8912; val_best_f1_score: 0.8963; train_kl_reg_loss: 111804.7591; train_edge_recon_loss: 2766848.3788; train_gene_expr_recon_loss: 22096818.5152; train_masked_gp_l1_reg_loss: 120008.7636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35406.2298; train_chrom_access_recon_loss: 2550312.1326; train_global_loss: 27681198.8182; train_optim_loss: 27681198.8182; val_kl_reg_loss: 77328.0068; val_edge_recon_loss: 2782472.4062; val_gene_expr_recon_loss: 22513479.2500; val_masked_gp_l1_reg_loss: 120020.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35328.3633; val_chrom_access_recon_loss: 2569836.4375; val_global_loss: 28098464.2500; val_optim_loss: 28098464.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9425; val_auprc_score: 0.9162; val_best_acc_score: 0.8874; val_best_f1_score: 0.8930; train_kl_reg_loss: 111414.6383; train_edge_recon_loss: 2755356.3561; train_gene_expr_recon_loss: 22098989.6061; train_masked_gp_l1_reg_loss: 120059.4824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35271.9485; train_chrom_access_recon_loss: 2550041.0455; train_global_loss: 27671133.2424; train_optim_loss: 27671133.2424; val_kl_reg_loss: 78023.4893; val_edge_recon_loss: 2816258.0312; val_gene_expr_recon_loss: 22448457.7500; val_masked_gp_l1_reg_loss: 120073.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35194.3164; val_chrom_access_recon_loss: 2576143.0312; val_global_loss: 28074150.0000; val_optim_loss: 28074150.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9376; val_auprc_score: 0.9107; val_best_acc_score: 0.8807; val_best_f1_score: 0.8882; train_kl_reg_loss: 111557.2173; train_edge_recon_loss: 2748438.1061; train_gene_expr_recon_loss: 22079979.1515; train_masked_gp_l1_reg_loss: 120104.0697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35148.2165; train_chrom_access_recon_loss: 2547397.1061; train_global_loss: 27642624.0303; train_optim_loss: 27642624.0303; val_kl_reg_loss: 78795.0605; val_edge_recon_loss: 2821435.0000; val_gene_expr_recon_loss: 22504362.7500; val_masked_gp_l1_reg_loss: 120110.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35059.9727; val_chrom_access_recon_loss: 2557628.9062; val_global_loss: 28117391.7500; val_optim_loss: 28117391.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9456; val_auprc_score: 0.9204; val_best_acc_score: 0.8960; val_best_f1_score: 0.9002; train_kl_reg_loss: 110968.5508; train_edge_recon_loss: 2754015.0341; train_gene_expr_recon_loss: 22079291.6061; train_masked_gp_l1_reg_loss: 120152.2437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35020.7244; train_chrom_access_recon_loss: 2548049.5644; train_global_loss: 27647497.7576; train_optim_loss: 27647497.7576; val_kl_reg_loss: 79271.2861; val_edge_recon_loss: 2773800.9062; val_gene_expr_recon_loss: 22786799.0000; val_masked_gp_l1_reg_loss: 120161.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34951.4766; val_chrom_access_recon_loss: 2586344.8438; val_global_loss: 28381330.0000; val_optim_loss: 28381330.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9471; val_auprc_score: 0.9293; val_best_acc_score: 0.8893; val_best_f1_score: 0.8954; train_kl_reg_loss: 110254.1710; train_edge_recon_loss: 2757765.8447; train_gene_expr_recon_loss: 22045839.9091; train_masked_gp_l1_reg_loss: 120094.4594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34695.4607; train_chrom_access_recon_loss: 2543847.8864; train_global_loss: 27612497.8788; train_optim_loss: 27612497.8788; val_kl_reg_loss: 78797.1504; val_edge_recon_loss: 2796244.7812; val_gene_expr_recon_loss: 22627840.7500; val_masked_gp_l1_reg_loss: 120048.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34622.4258; val_chrom_access_recon_loss: 2577457.2500; val_global_loss: 28235010.0000; val_optim_loss: 28235010.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9458; val_auprc_score: 0.9249; val_best_acc_score: 0.8874; val_best_f1_score: 0.8938; train_kl_reg_loss: 110322.0142; train_edge_recon_loss: 2747698.9962; train_gene_expr_recon_loss: 22053512.2121; train_masked_gp_l1_reg_loss: 120029.1261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34599.6738; train_chrom_access_recon_loss: 2547721.4280; train_global_loss: 27613883.4242; train_optim_loss: 27613883.4242; val_kl_reg_loss: 79453.8721; val_edge_recon_loss: 2776121.5625; val_gene_expr_recon_loss: 22235467.5000; val_masked_gp_l1_reg_loss: 120012.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34577.4219; val_chrom_access_recon_loss: 2552123.1562; val_global_loss: 27797755.7500; val_optim_loss: 27797755.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9485; val_auprc_score: 0.9307; val_best_acc_score: 0.8944; val_best_f1_score: 0.8974; train_kl_reg_loss: 110249.6688; train_edge_recon_loss: 2755132.9432; train_gene_expr_recon_loss: 22059083.1515; train_masked_gp_l1_reg_loss: 120002.7740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34559.7884; train_chrom_access_recon_loss: 2546623.9659; train_global_loss: 27625652.2727; train_optim_loss: 27625652.2727; val_kl_reg_loss: 79466.1885; val_edge_recon_loss: 2781139.8750; val_gene_expr_recon_loss: 22245954.7500; val_masked_gp_l1_reg_loss: 119992.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34541.7891; val_chrom_access_recon_loss: 2545799.9688; val_global_loss: 27806895.2500; val_optim_loss: 27806895.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9374; val_auprc_score: 0.9107; val_best_acc_score: 0.8898; val_best_f1_score: 0.8947; train_kl_reg_loss: 110086.2250; train_edge_recon_loss: 2753115.3826; train_gene_expr_recon_loss: 22059160.5455; train_masked_gp_l1_reg_loss: 119988.1275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34528.7571; train_chrom_access_recon_loss: 2546950.7386; train_global_loss: 27623829.5758; train_optim_loss: 27623829.5758; val_kl_reg_loss: 79308.0820; val_edge_recon_loss: 2802665.5938; val_gene_expr_recon_loss: 22619506.2500; val_masked_gp_l1_reg_loss: 119984.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34514.5000; val_chrom_access_recon_loss: 2577591.3438; val_global_loss: 28233569.5000; val_optim_loss: 28233569.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9418; val_auprc_score: 0.9175; val_best_acc_score: 0.8842; val_best_f1_score: 0.8902; train_kl_reg_loss: 110011.4039; train_edge_recon_loss: 2752348.7879; train_gene_expr_recon_loss: 22061279.0909; train_masked_gp_l1_reg_loss: 119981.7887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34504.6636; train_chrom_access_recon_loss: 2546342.2273; train_global_loss: 27624468.0303; train_optim_loss: 27624468.0303; val_kl_reg_loss: 79430.0215; val_edge_recon_loss: 2777077.5312; val_gene_expr_recon_loss: 22623808.5000; val_masked_gp_l1_reg_loss: 119978.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34491.7227; val_chrom_access_recon_loss: 2606899.3125; val_global_loss: 28241685.5000; val_optim_loss: 28241685.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9408; val_auprc_score: 0.9190; val_best_acc_score: 0.8839; val_best_f1_score: 0.8910; train_kl_reg_loss: 109939.5704; train_edge_recon_loss: 2749873.5265; train_gene_expr_recon_loss: 22049101.9091; train_masked_gp_l1_reg_loss: 119978.7312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34482.4901; train_chrom_access_recon_loss: 2546546.4394; train_global_loss: 27609922.9091; train_optim_loss: 27609922.9091; val_kl_reg_loss: 79982.1504; val_edge_recon_loss: 2793873.9375; val_gene_expr_recon_loss: 22533518.7500; val_masked_gp_l1_reg_loss: 119974.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34469.8594; val_chrom_access_recon_loss: 2579928.6250; val_global_loss: 28141747.7500; val_optim_loss: 28141747.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9467; val_auprc_score: 0.9258; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 109982.0282; train_edge_recon_loss: 2757392.8182; train_gene_expr_recon_loss: 22059725.0303; train_masked_gp_l1_reg_loss: 119967.3770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34442.9171; train_chrom_access_recon_loss: 2546854.6515; train_global_loss: 27628364.9394; train_optim_loss: 27628364.9394; val_kl_reg_loss: 79184.6748; val_edge_recon_loss: 2769540.0000; val_gene_expr_recon_loss: 22595306.0000; val_masked_gp_l1_reg_loss: 119963.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34436.0273; val_chrom_access_recon_loss: 2574385.1562; val_global_loss: 28172816.2500; val_optim_loss: 28172816.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9411; val_auprc_score: 0.9149; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 110049.3357; train_edge_recon_loss: 2757400.5455; train_gene_expr_recon_loss: 22059183.8182; train_masked_gp_l1_reg_loss: 119961.3151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34433.8339; train_chrom_access_recon_loss: 2546185.4621; train_global_loss: 27627214.1818; train_optim_loss: 27627214.1818; val_kl_reg_loss: 79150.8037; val_edge_recon_loss: 2788632.5000; val_gene_expr_recon_loss: 22429132.7500; val_masked_gp_l1_reg_loss: 119959.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34431.7734; val_chrom_access_recon_loss: 2551945.7188; val_global_loss: 28003253.0000; val_optim_loss: 28003253.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9436; val_auprc_score: 0.9201; val_best_acc_score: 0.8896; val_best_f1_score: 0.8946; train_kl_reg_loss: 110137.5640; train_edge_recon_loss: 2759011.5492; train_gene_expr_recon_loss: 22053936.5455; train_masked_gp_l1_reg_loss: 119958.5704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34429.8900; train_chrom_access_recon_loss: 2546599.0492; train_global_loss: 27624073.0909; train_optim_loss: 27624073.0909; val_kl_reg_loss: 79558.7354; val_edge_recon_loss: 2769403.2188; val_gene_expr_recon_loss: 22528717.2500; val_masked_gp_l1_reg_loss: 119957.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34427.8789; val_chrom_access_recon_loss: 2565687.0000; val_global_loss: 28097752.0000; val_optim_loss: 28097752.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9396; val_auprc_score: 0.9132; val_best_acc_score: 0.8847; val_best_f1_score: 0.8905; train_kl_reg_loss: 110150.5625; train_edge_recon_loss: 2754765.2348; train_gene_expr_recon_loss: 22063448.7273; train_masked_gp_l1_reg_loss: 119956.7752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34426.4909; train_chrom_access_recon_loss: 2546122.3674; train_global_loss: 27628870.4848; train_optim_loss: 27628870.4848; val_kl_reg_loss: 79705.6621; val_edge_recon_loss: 2809851.6875; val_gene_expr_recon_loss: 22608191.0000; val_masked_gp_l1_reg_loss: 119955.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34424.7930; val_chrom_access_recon_loss: 2562529.0625; val_global_loss: 28214657.7500; val_optim_loss: 28214657.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 48 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9507
val AUPRC score: 0.9322
val best accuracy score: 0.8974
val best F1 score: 0.9018
val target rna MSE score: 0.8711
val source rna MSE score: 0.4509
val target atac MSE score: 0.3323
val source atac MSE score: 0.0746
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
