[True, False, True]
Run timestamp: 19102023_180839_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 474107
Number of validation nodes: 52678
Number of training edges: 1120696
Number of validation edges: 124521
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8976; val_auprc_score: 0.9767; val_best_acc_score: 0.9041; val_best_f1_score: 0.9454; train_kl_reg_loss: 26120.2084; train_edge_recon_loss: 8206323.5982; train_gene_expr_recon_loss: 27621294.1334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151568.9566; train_global_loss: 36005306.9009; train_optim_loss: 36005306.9009; val_kl_reg_loss: 26944.3064; val_edge_recon_loss: 8387243.5000; val_gene_expr_recon_loss: 24906582.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121130.9844; val_global_loss: 33441901.5820; val_optim_loss: 33441901.5820
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9078; val_auprc_score: 0.9793; val_best_acc_score: 0.9087; val_best_f1_score: 0.9479; train_kl_reg_loss: 32862.7390; train_edge_recon_loss: 7961782.0747; train_gene_expr_recon_loss: 23454099.2937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127416.7799; train_global_loss: 31576160.8753; train_optim_loss: 31576160.8753; val_kl_reg_loss: 37955.0176; val_edge_recon_loss: 8345898.1865; val_gene_expr_recon_loss: 22601950.0656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128646.3906; val_global_loss: 31114449.2705; val_optim_loss: 31114449.2705
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9160; val_auprc_score: 0.9811; val_best_acc_score: 0.9138; val_best_f1_score: 0.9506; train_kl_reg_loss: 41989.8849; train_edge_recon_loss: 7945534.1279; train_gene_expr_recon_loss: 22059026.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125461.6960; train_global_loss: 30172012.4714; train_optim_loss: 30172012.4714; val_kl_reg_loss: 45686.9626; val_edge_recon_loss: 8389595.1557; val_gene_expr_recon_loss: 21796743.3852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122138.6953; val_global_loss: 30354163.5246; val_optim_loss: 30354163.5246
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9164; val_auprc_score: 0.9817; val_best_acc_score: 0.9149; val_best_f1_score: 0.9513; train_kl_reg_loss: 49663.2518; train_edge_recon_loss: 7942907.6345; train_gene_expr_recon_loss: 21496166.0164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119077.6835; train_global_loss: 29607814.5884; train_optim_loss: 29607814.5884; val_kl_reg_loss: 52914.3649; val_edge_recon_loss: 8186301.0389; val_gene_expr_recon_loss: 21435596.0246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116331.7891; val_global_loss: 29791143.4754; val_optim_loss: 29791143.4754
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9194; val_auprc_score: 0.9821; val_best_acc_score: 0.9175; val_best_f1_score: 0.9526; train_kl_reg_loss: 55788.1011; train_edge_recon_loss: 7930822.1083; train_gene_expr_recon_loss: 21206640.3381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114307.9648; train_global_loss: 29307558.5043; train_optim_loss: 29307558.5043; val_kl_reg_loss: 56984.2945; val_edge_recon_loss: 8208192.9426; val_gene_expr_recon_loss: 21190315.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112632.5312; val_global_loss: 29568124.6393; val_optim_loss: 29568124.6393
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9230; val_auprc_score: 0.9830; val_best_acc_score: 0.9177; val_best_f1_score: 0.9528; train_kl_reg_loss: 60475.9887; train_edge_recon_loss: 7933020.9902; train_gene_expr_recon_loss: 21029607.5048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110713.4751; train_global_loss: 29133817.9306; train_optim_loss: 29133817.9306; val_kl_reg_loss: 62754.0377; val_edge_recon_loss: 8236364.9980; val_gene_expr_recon_loss: 21036983.6885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108837.1328; val_global_loss: 29444940.7377; val_optim_loss: 29444940.7377
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9212; val_auprc_score: 0.9823; val_best_acc_score: 0.9178; val_best_f1_score: 0.9528; train_kl_reg_loss: 66861.1312; train_edge_recon_loss: 7909950.5021; train_gene_expr_recon_loss: 20922939.2042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107511.9982; train_global_loss: 29007262.8269; train_optim_loss: 29007262.8269; val_kl_reg_loss: 69630.1657; val_edge_recon_loss: 8285541.9693; val_gene_expr_recon_loss: 20931166.2459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105668.0547; val_global_loss: 29392006.3607; val_optim_loss: 29392006.3607
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9241; val_auprc_score: 0.9833; val_best_acc_score: 0.9200; val_best_f1_score: 0.9541; train_kl_reg_loss: 71644.7938; train_edge_recon_loss: 7929659.6039; train_gene_expr_recon_loss: 20812013.0206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104732.8400; train_global_loss: 28918050.2604; train_optim_loss: 28918050.2604; val_kl_reg_loss: 73372.8728; val_edge_recon_loss: 8246867.2869; val_gene_expr_recon_loss: 20908616.7787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103693.5547; val_global_loss: 29332551.0082; val_optim_loss: 29332551.0082
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9209; val_auprc_score: 0.9823; val_best_acc_score: 0.9186; val_best_f1_score: 0.9534; train_kl_reg_loss: 56966.3550; train_edge_recon_loss: 8004179.6352; train_gene_expr_recon_loss: 23049292.7483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121858.2165; train_global_loss: 31232296.9712; train_optim_loss: 31232296.9712; val_kl_reg_loss: 69719.8730; val_edge_recon_loss: 8203197.6230; val_gene_expr_recon_loss: 21610129.1967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104590.8594; val_global_loss: 29987636.6311; val_optim_loss: 29987636.6311
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9239; val_auprc_score: 0.9833; val_best_acc_score: 0.9188; val_best_f1_score: 0.9534; train_kl_reg_loss: 88117.1006; train_edge_recon_loss: 7930187.2837; train_gene_expr_recon_loss: 21344629.3531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100613.2176; train_global_loss: 29463546.9612; train_optim_loss: 29463546.9612; val_kl_reg_loss: 79728.6965; val_edge_recon_loss: 8206870.1721; val_gene_expr_recon_loss: 21128312.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99861.7188; val_global_loss: 29514773.8934; val_optim_loss: 29514773.8934
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9060; val_auprc_score: 0.9781; val_best_acc_score: 0.9104; val_best_f1_score: 0.9489; train_kl_reg_loss: 70508.4455; train_edge_recon_loss: 7988601.7869; train_gene_expr_recon_loss: 23664418.7775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121327.2743; train_global_loss: 31844856.2851; train_optim_loss: 31844856.2851; val_kl_reg_loss: 34922.3279; val_edge_recon_loss: 8304342.1947; val_gene_expr_recon_loss: 25114912.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159342.5000; val_global_loss: 33613519.6803; val_optim_loss: 33613519.6803
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9234; val_auprc_score: 0.9831; val_best_acc_score: 0.9184; val_best_f1_score: 0.9533; train_kl_reg_loss: 56880.6872; train_edge_recon_loss: 7934268.7876; train_gene_expr_recon_loss: 22815621.6080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134575.2094; train_global_loss: 30941346.2714; train_optim_loss: 30941346.2714; val_kl_reg_loss: 1611876.1205; val_edge_recon_loss: 8247059.8668; val_gene_expr_recon_loss: 21671410.7541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114270.1641; val_global_loss: 31644616.8361; val_optim_loss: 31644616.8361

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9250; val_auprc_score: 0.9835; val_best_acc_score: 0.9192; val_best_f1_score: 0.9536; train_kl_reg_loss: 92717.4550; train_edge_recon_loss: 7895493.1597; train_gene_expr_recon_loss: 21342834.0932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105708.3490; train_global_loss: 29436753.1174; train_optim_loss: 29436753.1174; val_kl_reg_loss: 76135.9918; val_edge_recon_loss: 8267898.4426; val_gene_expr_recon_loss: 21353460.5164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101844.8125; val_global_loss: 29799338.9426; val_optim_loss: 29799338.9426
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9252; val_auprc_score: 0.9835; val_best_acc_score: 0.9200; val_best_f1_score: 0.9541; train_kl_reg_loss: 78438.8654; train_edge_recon_loss: 7907737.4868; train_gene_expr_recon_loss: 21122931.5413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98708.2701; train_global_loss: 29207816.1517; train_optim_loss: 29207816.1517; val_kl_reg_loss: 80553.8392; val_edge_recon_loss: 8221314.4037; val_gene_expr_recon_loss: 21138371.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95602.2266; val_global_loss: 29535841.9590; val_optim_loss: 29535841.9590
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9277; val_auprc_score: 0.9842; val_best_acc_score: 0.9211; val_best_f1_score: 0.9546; train_kl_reg_loss: 82449.8796; train_edge_recon_loss: 7888307.9456; train_gene_expr_recon_loss: 20908234.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92542.0855; train_global_loss: 28971534.4212; train_optim_loss: 28971534.4212; val_kl_reg_loss: 84813.0040; val_edge_recon_loss: 8252767.5328; val_gene_expr_recon_loss: 20930422.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89641.5625; val_global_loss: 29357645.2869; val_optim_loss: 29357645.2869
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9291; val_auprc_score: 0.9844; val_best_acc_score: 0.9213; val_best_f1_score: 0.9548; train_kl_reg_loss: 86186.2805; train_edge_recon_loss: 7891013.9680; train_gene_expr_recon_loss: 20722850.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87009.0708; train_global_loss: 28787059.8648; train_optim_loss: 28787059.8648; val_kl_reg_loss: 87648.3311; val_edge_recon_loss: 8264824.3115; val_gene_expr_recon_loss: 20783545.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84645.2344; val_global_loss: 29220663.7459; val_optim_loss: 29220663.7459
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9312; val_auprc_score: 0.9849; val_best_acc_score: 0.9220; val_best_f1_score: 0.9552; train_kl_reg_loss: 88271.8471; train_edge_recon_loss: 7911470.8673; train_gene_expr_recon_loss: 20590023.6629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82518.8315; train_global_loss: 28672285.2133; train_optim_loss: 28672285.2133; val_kl_reg_loss: 89248.2613; val_edge_recon_loss: 8230491.6127; val_gene_expr_recon_loss: 20665606.9262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80621.1562; val_global_loss: 29065968.8361; val_optim_loss: 29065968.8361
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9298; val_auprc_score: 0.9845; val_best_acc_score: 0.9222; val_best_f1_score: 0.9552; train_kl_reg_loss: 89519.5114; train_edge_recon_loss: 7894556.5747; train_gene_expr_recon_loss: 20503364.4769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79154.7711; train_global_loss: 28566595.3047; train_optim_loss: 28566595.3047; val_kl_reg_loss: 89975.5506; val_edge_recon_loss: 8222105.8033; val_gene_expr_recon_loss: 20609394.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77808.0391; val_global_loss: 28999283.8852; val_optim_loss: 28999283.8852
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9305; val_auprc_score: 0.9849; val_best_acc_score: 0.9223; val_best_f1_score: 0.9555; train_kl_reg_loss: 89592.2836; train_edge_recon_loss: 7892669.1327; train_gene_expr_recon_loss: 20447777.8246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76800.5681; train_global_loss: 28506839.8063; train_optim_loss: 28506839.8063; val_kl_reg_loss: 89568.8592; val_edge_recon_loss: 8210648.0943; val_gene_expr_recon_loss: 20556399.3361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75856.1250; val_global_loss: 28932472.2869; val_optim_loss: 28932472.2869
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9313; val_auprc_score: 0.9850; val_best_acc_score: 0.9236; val_best_f1_score: 0.9561; train_kl_reg_loss: 89321.4770; train_edge_recon_loss: 7903928.2686; train_gene_expr_recon_loss: 20391542.7730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75113.1709; train_global_loss: 28459905.7186; train_optim_loss: 28459905.7186; val_kl_reg_loss: 89342.4914; val_edge_recon_loss: 8189087.7541; val_gene_expr_recon_loss: 20527653.8934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74461.4922; val_global_loss: 28880546.1393; val_optim_loss: 28880546.1393
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9314; val_auprc_score: 0.9851; val_best_acc_score: 0.9235; val_best_f1_score: 0.9560; train_kl_reg_loss: 88638.7853; train_edge_recon_loss: 7907494.6014; train_gene_expr_recon_loss: 20358450.5555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73947.7644; train_global_loss: 28428531.6711; train_optim_loss: 28428531.6711; val_kl_reg_loss: 87808.6201; val_edge_recon_loss: 8255243.0225; val_gene_expr_recon_loss: 20507405.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73465.2578; val_global_loss: 28923922.7459; val_optim_loss: 28923922.7459
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9326; val_auprc_score: 0.9853; val_best_acc_score: 0.9240; val_best_f1_score: 0.9563; train_kl_reg_loss: 87120.6264; train_edge_recon_loss: 7917375.4271; train_gene_expr_recon_loss: 20328822.2248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73109.7419; train_global_loss: 28406428.0512; train_optim_loss: 28406428.0512; val_kl_reg_loss: 86929.1143; val_edge_recon_loss: 8232499.2930; val_gene_expr_recon_loss: 20473443.3852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72775.9766; val_global_loss: 28865647.7377; val_optim_loss: 28865647.7377
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9334; val_auprc_score: 0.9857; val_best_acc_score: 0.9243; val_best_f1_score: 0.9565; train_kl_reg_loss: 86449.2184; train_edge_recon_loss: 7885984.0710; train_gene_expr_recon_loss: 20298888.6286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72528.3878; train_global_loss: 28343850.3024; train_optim_loss: 28343850.3024; val_kl_reg_loss: 86644.1457; val_edge_recon_loss: 8193148.6906; val_gene_expr_recon_loss: 20455236.3361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72254.4297; val_global_loss: 28807283.1803; val_optim_loss: 28807283.1803
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9332; val_auprc_score: 0.9853; val_best_acc_score: 0.9246; val_best_f1_score: 0.9566; train_kl_reg_loss: 85844.8927; train_edge_recon_loss: 7910653.5043; train_gene_expr_recon_loss: 20284559.0717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72086.0658; train_global_loss: 28353143.5532; train_optim_loss: 28353143.5532; val_kl_reg_loss: 85770.1984; val_edge_recon_loss: 8245404.3750; val_gene_expr_recon_loss: 20402693.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71922.3281; val_global_loss: 28805789.7131; val_optim_loss: 28805789.7131
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9336; val_auprc_score: 0.9855; val_best_acc_score: 0.9248; val_best_f1_score: 0.9567; train_kl_reg_loss: 84812.4834; train_edge_recon_loss: 7909807.0057; train_gene_expr_recon_loss: 20259446.1544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71781.6477; train_global_loss: 28325847.3202; train_optim_loss: 28325847.3202; val_kl_reg_loss: 84669.5585; val_edge_recon_loss: 8260399.9385; val_gene_expr_recon_loss: 20420130.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71687.0156; val_global_loss: 28836887.4918; val_optim_loss: 28836887.4918
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9316; val_auprc_score: 0.9853; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 86554.1702; train_edge_recon_loss: 7953875.6437; train_gene_expr_recon_loss: 20047941.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71732.3183; train_global_loss: 28160103.5085; train_optim_loss: 28160103.5085; val_kl_reg_loss: 59779.3489; val_edge_recon_loss: 8169948.1066; val_gene_expr_recon_loss: 20210507.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71791.0234; val_global_loss: 28512026.6148; val_optim_loss: 28512026.6148
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9323; val_auprc_score: 0.9851; val_best_acc_score: 0.9251; val_best_f1_score: 0.9570; train_kl_reg_loss: 87285.6815; train_edge_recon_loss: 7919349.4269; train_gene_expr_recon_loss: 20033384.8159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71749.1561; train_global_loss: 28111769.0982; train_optim_loss: 28111769.0982; val_kl_reg_loss: 61489.2723; val_edge_recon_loss: 8241294.1742; val_gene_expr_recon_loss: 20197488.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71803.0000; val_global_loss: 28572074.7541; val_optim_loss: 28572074.7541
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9312; val_auprc_score: 0.9847; val_best_acc_score: 0.9241; val_best_f1_score: 0.9563; train_kl_reg_loss: 85217.4233; train_edge_recon_loss: 7903025.9143; train_gene_expr_recon_loss: 20014196.9995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71717.1798; train_global_loss: 28074157.5505; train_optim_loss: 28074157.5505; val_kl_reg_loss: 61730.7449; val_edge_recon_loss: 8283421.3852; val_gene_expr_recon_loss: 20190408.5410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71700.5703; val_global_loss: 28607260.6721; val_optim_loss: 28607260.6721
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9304; val_auprc_score: 0.9846; val_best_acc_score: 0.9237; val_best_f1_score: 0.9561; train_kl_reg_loss: 82635.2606; train_edge_recon_loss: 7922435.1841; train_gene_expr_recon_loss: 19998632.0503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71717.2218; train_global_loss: 28075419.6994; train_optim_loss: 28075419.6994; val_kl_reg_loss: 63423.8511; val_edge_recon_loss: 8278045.4980; val_gene_expr_recon_loss: 20166778.1885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71721.0469; val_global_loss: 28579969.5984; val_optim_loss: 28579969.5984
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9332; val_auprc_score: 0.9853; val_best_acc_score: 0.9248; val_best_f1_score: 0.9568; train_kl_reg_loss: 80284.3901; train_edge_recon_loss: 7916387.1000; train_gene_expr_recon_loss: 19994457.0699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71692.8475; train_global_loss: 28062821.4472; train_optim_loss: 28062821.4472; val_kl_reg_loss: 64152.4003; val_edge_recon_loss: 8269346.3811; val_gene_expr_recon_loss: 20161694.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71715.0547; val_global_loss: 28566909.3443; val_optim_loss: 28566909.3443

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9342; val_auprc_score: 0.9856; val_best_acc_score: 0.9251; val_best_f1_score: 0.9569; train_kl_reg_loss: 78804.8194; train_edge_recon_loss: 7920637.0158; train_gene_expr_recon_loss: 19954515.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70704.7111; train_global_loss: 28024661.6976; train_optim_loss: 28024661.6976; val_kl_reg_loss: 63919.7515; val_edge_recon_loss: 8238252.3648; val_gene_expr_recon_loss: 20137101.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70238.6797; val_global_loss: 28509511.8279; val_optim_loss: 28509511.8279
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9324; val_auprc_score: 0.9851; val_best_acc_score: 0.9245; val_best_f1_score: 0.9566; train_kl_reg_loss: 78575.0940; train_edge_recon_loss: 7917889.6565; train_gene_expr_recon_loss: 19946727.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70076.3951; train_global_loss: 28013268.2741; train_optim_loss: 28013268.2741; val_kl_reg_loss: 63973.3477; val_edge_recon_loss: 8240229.1148; val_gene_expr_recon_loss: 20128833.9016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69955.0625; val_global_loss: 28502992.3852; val_optim_loss: 28502992.3852
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9343; val_auprc_score: 0.9858; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 78293.3366; train_edge_recon_loss: 7923577.4543; train_gene_expr_recon_loss: 19941817.4153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69885.1717; train_global_loss: 28013573.3531; train_optim_loss: 28013573.3531; val_kl_reg_loss: 64073.0574; val_edge_recon_loss: 8170245.8094; val_gene_expr_recon_loss: 20122646.1393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69818.4062; val_global_loss: 28426783.0410; val_optim_loss: 28426783.0410
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9340; val_auprc_score: 0.9855; val_best_acc_score: 0.9259; val_best_f1_score: 0.9574; train_kl_reg_loss: 78201.8321; train_edge_recon_loss: 7910880.1048; train_gene_expr_recon_loss: 19943313.7277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69767.5200; train_global_loss: 28002163.1942; train_optim_loss: 28002163.1942; val_kl_reg_loss: 64226.0610; val_edge_recon_loss: 8145156.1639; val_gene_expr_recon_loss: 20118115.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69736.4688; val_global_loss: 28397233.9672; val_optim_loss: 28397233.9672
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9346; val_auprc_score: 0.9856; val_best_acc_score: 0.9256; val_best_f1_score: 0.9571; train_kl_reg_loss: 77877.3691; train_edge_recon_loss: 7903754.8275; train_gene_expr_recon_loss: 19943001.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69699.0495; train_global_loss: 27994332.6752; train_optim_loss: 27994332.6752; val_kl_reg_loss: 64335.2910; val_edge_recon_loss: 8260287.9713; val_gene_expr_recon_loss: 20145405.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69666.8672; val_global_loss: 28539694.9836; val_optim_loss: 28539694.9836
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9328; val_auprc_score: 0.9851; val_best_acc_score: 0.9243; val_best_f1_score: 0.9564; train_kl_reg_loss: 77514.4124; train_edge_recon_loss: 7934841.7067; train_gene_expr_recon_loss: 19941714.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69650.3063; train_global_loss: 28023721.3677; train_optim_loss: 28023721.3677; val_kl_reg_loss: 64308.7015; val_edge_recon_loss: 8307800.3279; val_gene_expr_recon_loss: 20124599.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69635.5625; val_global_loss: 28566344.6148; val_optim_loss: 28566344.6148
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9347; val_auprc_score: 0.9860; val_best_acc_score: 0.9261; val_best_f1_score: 0.9577; train_kl_reg_loss: 77241.5973; train_edge_recon_loss: 7903846.9461; train_gene_expr_recon_loss: 19935247.6638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69598.0016; train_global_loss: 27985934.2275; train_optim_loss: 27985934.2275; val_kl_reg_loss: 64549.1194; val_edge_recon_loss: 8177444.0943; val_gene_expr_recon_loss: 20102906.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69578.7344; val_global_loss: 28414477.7541; val_optim_loss: 28414477.7541
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9339; val_auprc_score: 0.9856; val_best_acc_score: 0.9260; val_best_f1_score: 0.9575; train_kl_reg_loss: 77095.4101; train_edge_recon_loss: 7900746.2330; train_gene_expr_recon_loss: 19937856.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69553.3639; train_global_loss: 27985251.1466; train_optim_loss: 27985251.1466; val_kl_reg_loss: 64645.9339; val_edge_recon_loss: 8176248.0348; val_gene_expr_recon_loss: 20096581.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69526.4531; val_global_loss: 28407001.9754; val_optim_loss: 28407001.9754

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9341; val_auprc_score: 0.9857; val_best_acc_score: 0.9249; val_best_f1_score: 0.9569; train_kl_reg_loss: 77035.3988; train_edge_recon_loss: 7904099.3910; train_gene_expr_recon_loss: 19927591.7688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69440.0633; train_global_loss: 27978166.6688; train_optim_loss: 27978166.6688; val_kl_reg_loss: 64667.4378; val_edge_recon_loss: 8222018.2930; val_gene_expr_recon_loss: 20112287.6967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69389.1250; val_global_loss: 28468363.4918; val_optim_loss: 28468363.4918
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9331; val_auprc_score: 0.9852; val_best_acc_score: 0.9259; val_best_f1_score: 0.9574; train_kl_reg_loss: 76989.0562; train_edge_recon_loss: 7923621.9392; train_gene_expr_recon_loss: 19924705.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69365.5825; train_global_loss: 27994682.4833; train_optim_loss: 27994682.4833; val_kl_reg_loss: 64755.2548; val_edge_recon_loss: 8202775.7049; val_gene_expr_recon_loss: 20103808.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69344.7656; val_global_loss: 28440683.8197; val_optim_loss: 28440683.8197
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9326; val_auprc_score: 0.9850; val_best_acc_score: 0.9251; val_best_f1_score: 0.9570; train_kl_reg_loss: 77008.3682; train_edge_recon_loss: 7925026.5834; train_gene_expr_recon_loss: 19928896.2750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69330.8467; train_global_loss: 28000262.0292; train_optim_loss: 28000262.0292; val_kl_reg_loss: 64685.7649; val_edge_recon_loss: 8298045.9795; val_gene_expr_recon_loss: 20091834.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69319.9844; val_global_loss: 28523886.4180; val_optim_loss: 28523886.4180
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9331; val_auprc_score: 0.9856; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 76946.2202; train_edge_recon_loss: 7891077.3586; train_gene_expr_recon_loss: 19928773.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69309.6010; train_global_loss: 27966106.9219; train_optim_loss: 27966106.9219; val_kl_reg_loss: 64729.7403; val_edge_recon_loss: 8127343.7520; val_gene_expr_recon_loss: 20123752.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69301.1328; val_global_loss: 28385128.2213; val_optim_loss: 28385128.2213
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9334; val_auprc_score: 0.9852; val_best_acc_score: 0.9253; val_best_f1_score: 0.9571; train_kl_reg_loss: 76910.6762; train_edge_recon_loss: 7886601.3632; train_gene_expr_recon_loss: 19923008.0411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69294.0973; train_global_loss: 27955814.2659; train_optim_loss: 27955814.2659; val_kl_reg_loss: 64790.0972; val_edge_recon_loss: 8261750.1926; val_gene_expr_recon_loss: 20129569.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69288.0469; val_global_loss: 28525397.7705; val_optim_loss: 28525397.7705
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9331; val_auprc_score: 0.9856; val_best_acc_score: 0.9246; val_best_f1_score: 0.9567; train_kl_reg_loss: 76886.5491; train_edge_recon_loss: 7911277.8945; train_gene_expr_recon_loss: 19926234.0475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69281.3259; train_global_loss: 27983679.8310; train_optim_loss: 27983679.8310; val_kl_reg_loss: 64706.0471; val_edge_recon_loss: 8218200.1373; val_gene_expr_recon_loss: 20096692.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69275.1562; val_global_loss: 28448875.1230; val_optim_loss: 28448875.1230
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9333; val_auprc_score: 0.9851; val_best_acc_score: 0.9253; val_best_f1_score: 0.9570; train_kl_reg_loss: 76871.9204; train_edge_recon_loss: 7913126.0231; train_gene_expr_recon_loss: 19924666.1772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69270.9684; train_global_loss: 27983935.2143; train_optim_loss: 27983935.2143; val_kl_reg_loss: 64730.8829; val_edge_recon_loss: 8271751.4283; val_gene_expr_recon_loss: 20116136.8279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69267.0312; val_global_loss: 28521887.1148; val_optim_loss: 28521887.1148
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9334; val_auprc_score: 0.9855; val_best_acc_score: 0.9252; val_best_f1_score: 0.9570; train_kl_reg_loss: 76838.4548; train_edge_recon_loss: 7916598.3358; train_gene_expr_recon_loss: 19923123.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69261.7052; train_global_loss: 27985821.7241; train_optim_loss: 27985821.7241; val_kl_reg_loss: 64776.9922; val_edge_recon_loss: 8219411.7049; val_gene_expr_recon_loss: 20116097.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69258.4375; val_global_loss: 28469544.6311; val_optim_loss: 28469544.6311

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9330; val_auprc_score: 0.9851; val_best_acc_score: 0.9254; val_best_f1_score: 0.9571; train_kl_reg_loss: 76832.7300; train_edge_recon_loss: 7910941.2604; train_gene_expr_recon_loss: 19929740.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69250.1551; train_global_loss: 27986764.5290; train_optim_loss: 27986764.5290; val_kl_reg_loss: 64721.2556; val_edge_recon_loss: 8277221.7254; val_gene_expr_recon_loss: 20109672.8525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69245.1719; val_global_loss: 28520861.8525; val_optim_loss: 28520861.8525
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9323; val_auprc_score: 0.9852; val_best_acc_score: 0.9252; val_best_f1_score: 0.9570; train_kl_reg_loss: 76814.0132; train_edge_recon_loss: 7898902.7798; train_gene_expr_recon_loss: 19917237.3942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69242.5716; train_global_loss: 27962196.6697; train_optim_loss: 27962196.6697; val_kl_reg_loss: 64781.5346; val_edge_recon_loss: 8211548.0676; val_gene_expr_recon_loss: 20101866.9426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69240.4688; val_global_loss: 28447436.5738; val_optim_loss: 28447436.5738
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9343; val_auprc_score: 0.9855; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 76798.9661; train_edge_recon_loss: 7901991.1370; train_gene_expr_recon_loss: 19921396.5135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69238.9358; train_global_loss: 27969425.5532; train_optim_loss: 27969425.5532; val_kl_reg_loss: 64789.8893; val_edge_recon_loss: 8265425.3299; val_gene_expr_recon_loss: 20119070.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69237.4375; val_global_loss: 28518524.1066; val_optim_loss: 28518524.1066
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9321; val_auprc_score: 0.9850; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 76827.2690; train_edge_recon_loss: 7933722.2997; train_gene_expr_recon_loss: 19930782.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69236.3546; train_global_loss: 28010568.5445; train_optim_loss: 28010568.5445; val_kl_reg_loss: 64761.6704; val_edge_recon_loss: 8131150.5430; val_gene_expr_recon_loss: 20097971.3689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69235.3281; val_global_loss: 28363119.5492; val_optim_loss: 28363119.5492
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9333; val_auprc_score: 0.9852; val_best_acc_score: 0.9251; val_best_f1_score: 0.9569; train_kl_reg_loss: 76802.2684; train_edge_recon_loss: 7904483.6809; train_gene_expr_recon_loss: 19926543.3413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69234.3754; train_global_loss: 27977063.7049; train_optim_loss: 27977063.7049; val_kl_reg_loss: 64701.7672; val_edge_recon_loss: 8304625.2992; val_gene_expr_recon_loss: 20118234.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69233.5078; val_global_loss: 28556795.6885; val_optim_loss: 28556795.6885
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9332; val_auprc_score: 0.9853; val_best_acc_score: 0.9254; val_best_f1_score: 0.9571; train_kl_reg_loss: 76793.1344; train_edge_recon_loss: 7922469.0144; train_gene_expr_recon_loss: 19926828.9968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69232.7948; train_global_loss: 27995323.8593; train_optim_loss: 27995323.8593; val_kl_reg_loss: 64729.5250; val_edge_recon_loss: 8222509.1189; val_gene_expr_recon_loss: 20116438.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69232.0703; val_global_loss: 28472908.8852; val_optim_loss: 28472908.8852
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9341; val_auprc_score: 0.9855; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 76786.1530; train_edge_recon_loss: 7903759.5489; train_gene_expr_recon_loss: 19927299.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69231.3571; train_global_loss: 27977076.9922; train_optim_loss: 27977076.9922; val_kl_reg_loss: 64726.7699; val_edge_recon_loss: 8194136.8258; val_gene_expr_recon_loss: 20103672.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69230.5391; val_global_loss: 28431766.1721; val_optim_loss: 28431766.1721
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9332; val_auprc_score: 0.9857; val_best_acc_score: 0.9256; val_best_f1_score: 0.9573; train_kl_reg_loss: 76793.8908; train_edge_recon_loss: 7891782.6003; train_gene_expr_recon_loss: 19928012.9776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69229.8733; train_global_loss: 27965819.4628; train_optim_loss: 27965819.4628; val_kl_reg_loss: 64701.4161; val_edge_recon_loss: 8134096.4672; val_gene_expr_recon_loss: 20091820.7295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69229.1875; val_global_loss: 28359848.6557; val_optim_loss: 28359848.6557
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9328; val_auprc_score: 0.9853; val_best_acc_score: 0.9258; val_best_f1_score: 0.9573; train_kl_reg_loss: 76792.4467; train_edge_recon_loss: 7910112.3753; train_gene_expr_recon_loss: 19920250.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69228.5070; train_global_loss: 27976383.9059; train_optim_loss: 27976383.9059; val_kl_reg_loss: 64755.7460; val_edge_recon_loss: 8232754.5840; val_gene_expr_recon_loss: 20122011.8443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69227.9141; val_global_loss: 28488750.1393; val_optim_loss: 28488750.1393
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9338; val_auprc_score: 0.9857; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 76767.7881; train_edge_recon_loss: 7908319.2615; train_gene_expr_recon_loss: 19925169.3540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69227.4275; train_global_loss: 27979483.8913; train_optim_loss: 27979483.8913; val_kl_reg_loss: 64693.1386; val_edge_recon_loss: 8188940.8996; val_gene_expr_recon_loss: 20108620.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69226.9297; val_global_loss: 28431480.5082; val_optim_loss: 28431480.5082
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9333; val_auprc_score: 0.9854; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 76791.4189; train_edge_recon_loss: 7904469.8205; train_gene_expr_recon_loss: 19919085.4006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69226.3913; train_global_loss: 27969572.6131; train_optim_loss: 27969572.6131; val_kl_reg_loss: 64762.6256; val_edge_recon_loss: 8189378.7664; val_gene_expr_recon_loss: 20108655.5902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69225.8047; val_global_loss: 28432023.0492; val_optim_loss: 28432023.0492
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9336; val_auprc_score: 0.9856; val_best_acc_score: 0.9248; val_best_f1_score: 0.9568; train_kl_reg_loss: 76745.6659; train_edge_recon_loss: 7898162.2864; train_gene_expr_recon_loss: 19926622.1407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69225.3168; train_global_loss: 27970755.4920; train_optim_loss: 27970755.4920; val_kl_reg_loss: 64688.5470; val_edge_recon_loss: 8202943.3668; val_gene_expr_recon_loss: 20093275.0738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69224.9141; val_global_loss: 28430131.0164; val_optim_loss: 28430131.0164

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9332; val_auprc_score: 0.9855; val_best_acc_score: 0.9254; val_best_f1_score: 0.9571; train_kl_reg_loss: 76775.5993; train_edge_recon_loss: 7892856.8954; train_gene_expr_recon_loss: 19931519.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69224.0978; train_global_loss: 27970375.5569; train_optim_loss: 27970375.5569; val_kl_reg_loss: 64769.1754; val_edge_recon_loss: 8208953.7561; val_gene_expr_recon_loss: 20095153.5492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69223.6016; val_global_loss: 28438100.4180; val_optim_loss: 28438100.4180
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9350; val_auprc_score: 0.9860; val_best_acc_score: 0.9264; val_best_f1_score: 0.9578; train_kl_reg_loss: 76754.5355; train_edge_recon_loss: 7901857.2026; train_gene_expr_recon_loss: 19924404.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69223.3359; train_global_loss: 27972239.7798; train_optim_loss: 27972239.7798; val_kl_reg_loss: 64724.5818; val_edge_recon_loss: 8141665.9959; val_gene_expr_recon_loss: 20101303.1557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69223.1094; val_global_loss: 28376917.6393; val_optim_loss: 28376917.6393
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9327; val_auprc_score: 0.9852; val_best_acc_score: 0.9257; val_best_f1_score: 0.9574; train_kl_reg_loss: 76782.8026; train_edge_recon_loss: 7893372.6281; train_gene_expr_recon_loss: 19934109.1357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69222.9445; train_global_loss: 27973487.2188; train_optim_loss: 27973487.2188; val_kl_reg_loss: 64726.5611; val_edge_recon_loss: 8188180.0369; val_gene_expr_recon_loss: 20105815.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69222.7969; val_global_loss: 28427944.3279; val_optim_loss: 28427944.3279
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9341; val_auprc_score: 0.9856; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 76775.9748; train_edge_recon_loss: 7897684.6989; train_gene_expr_recon_loss: 19921386.4038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69222.6728; train_global_loss: 27965069.0836; train_optim_loss: 27965069.0836; val_kl_reg_loss: 64707.6334; val_edge_recon_loss: 8192806.8443; val_gene_expr_recon_loss: 20096724.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69222.5547; val_global_loss: 28423460.4672; val_optim_loss: 28423460.4672

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 798 min 8 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9333
val AUPRC score: 0.9854
val best accuracy score: 0.9254
val best F1 score: 0.9572
val target rna MSE score: 0.5763
val source rna MSE score: 0.1553
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0498
Val cat covariate2 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
