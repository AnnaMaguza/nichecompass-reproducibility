[True]
Run timestamp: 10082023_193220_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7443; val_auprc_score: 0.7727; val_best_acc_score: 0.5043; val_best_f1_score: 0.6679; train_kl_reg_loss: 78283.1405; train_edge_recon_loss: 3749411.5248; train_gene_expr_recon_loss: 28637524.7023; train_masked_gp_l1_reg_loss: 84935.5829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243711.5571; train_chrom_access_recon_loss: 16929248.0153; train_global_loss: 49723114.3206; train_optim_loss: 49723114.3206; val_kl_reg_loss: 186759.0953; val_edge_recon_loss: 4064856.7667; val_gene_expr_recon_loss: 24106863.8667; val_masked_gp_l1_reg_loss: 86561.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237949.4844; val_chrom_access_recon_loss: 15778738.8667; val_global_loss: 44461730.6667; val_optim_loss: 44461730.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7670; val_auprc_score: 0.7972; val_best_acc_score: 0.6508; val_best_f1_score: 0.7060; train_kl_reg_loss: 145082.5654; train_edge_recon_loss: 3628026.9389; train_gene_expr_recon_loss: 23178118.4275; train_masked_gp_l1_reg_loss: 82806.8721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230382.8307; train_chrom_access_recon_loss: 15530944.5649; train_global_loss: 42795362.1374; train_optim_loss: 42795362.1374; val_kl_reg_loss: 161956.1156; val_edge_recon_loss: 4046123.0333; val_gene_expr_recon_loss: 22548304.0000; val_masked_gp_l1_reg_loss: 80121.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221952.0938; val_chrom_access_recon_loss: 15471841.4000; val_global_loss: 42530298.4000; val_optim_loss: 42530298.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7833; val_auprc_score: 0.8106; val_best_acc_score: 0.7102; val_best_f1_score: 0.7126; train_kl_reg_loss: 154255.6362; train_edge_recon_loss: 3548863.8817; train_gene_expr_recon_loss: 22324439.2977; train_masked_gp_l1_reg_loss: 78268.0290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213243.6739; train_chrom_access_recon_loss: 15319257.8015; train_global_loss: 41638328.3359; train_optim_loss: 41638328.3359; val_kl_reg_loss: 140801.9865; val_edge_recon_loss: 3986067.0333; val_gene_expr_recon_loss: 22245948.5333; val_masked_gp_l1_reg_loss: 77462.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 204500.7656; val_chrom_access_recon_loss: 15406362.6000; val_global_loss: 42061142.6667; val_optim_loss: 42061142.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8365; val_auprc_score: 0.8475; val_best_acc_score: 0.7501; val_best_f1_score: 0.7590; train_kl_reg_loss: 133738.2919; train_edge_recon_loss: 3497462.6374; train_gene_expr_recon_loss: 22066079.2824; train_masked_gp_l1_reg_loss: 77856.2818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196198.3675; train_chrom_access_recon_loss: 15219871.5115; train_global_loss: 41191206.3511; train_optim_loss: 41191206.3511; val_kl_reg_loss: 123727.6177; val_edge_recon_loss: 3693673.5833; val_gene_expr_recon_loss: 22044628.6667; val_masked_gp_l1_reg_loss: 79073.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 187953.3438; val_chrom_access_recon_loss: 15361309.8000; val_global_loss: 41490367.4667; val_optim_loss: 41490367.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8701; val_auprc_score: 0.8660; val_best_acc_score: 0.7902; val_best_f1_score: 0.7925; train_kl_reg_loss: 127871.2909; train_edge_recon_loss: 3288652.4370; train_gene_expr_recon_loss: 21938555.3282; train_masked_gp_l1_reg_loss: 81028.2688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180202.1766; train_chrom_access_recon_loss: 15172626.3435; train_global_loss: 40788936.0611; train_optim_loss: 40788936.0611; val_kl_reg_loss: 137700.3958; val_edge_recon_loss: 3212984.9667; val_gene_expr_recon_loss: 21913887.4667; val_masked_gp_l1_reg_loss: 82919.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172659.3906; val_chrom_access_recon_loss: 15291197.4667; val_global_loss: 40811350.9333; val_optim_loss: 40811350.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9077; val_auprc_score: 0.8997; val_best_acc_score: 0.8320; val_best_f1_score: 0.8424; train_kl_reg_loss: 147983.1535; train_edge_recon_loss: 3061365.3454; train_gene_expr_recon_loss: 21803994.9618; train_masked_gp_l1_reg_loss: 84456.2544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165800.3563; train_chrom_access_recon_loss: 15097840.2214; train_global_loss: 40361440.2443; train_optim_loss: 40361440.2443; val_kl_reg_loss: 170791.8260; val_edge_recon_loss: 3026644.0167; val_gene_expr_recon_loss: 21800113.6000; val_masked_gp_l1_reg_loss: 85972.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159264.5312; val_chrom_access_recon_loss: 15129172.8667; val_global_loss: 40371957.8667; val_optim_loss: 40371957.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9283; val_auprc_score: 0.9166; val_best_acc_score: 0.8610; val_best_f1_score: 0.8675; train_kl_reg_loss: 153267.6178; train_edge_recon_loss: 2932364.6718; train_gene_expr_recon_loss: 21640541.9237; train_masked_gp_l1_reg_loss: 87137.6620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153467.1845; train_chrom_access_recon_loss: 15006838.1069; train_global_loss: 39973617.3130; train_optim_loss: 39973617.3130; val_kl_reg_loss: 155466.0312; val_edge_recon_loss: 2884394.7167; val_gene_expr_recon_loss: 21639106.0000; val_masked_gp_l1_reg_loss: 88533.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147815.9062; val_chrom_access_recon_loss: 15112520.6000; val_global_loss: 40027837.6000; val_optim_loss: 40027837.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9320; val_auprc_score: 0.9184; val_best_acc_score: 0.8655; val_best_f1_score: 0.8709; train_kl_reg_loss: 153084.7752; train_edge_recon_loss: 2889718.0878; train_gene_expr_recon_loss: 21507074.1221; train_masked_gp_l1_reg_loss: 89541.1044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142506.6620; train_chrom_access_recon_loss: 14944790.4122; train_global_loss: 39726715.0229; train_optim_loss: 39726715.0229; val_kl_reg_loss: 149341.9604; val_edge_recon_loss: 2879948.0667; val_gene_expr_recon_loss: 21595876.0000; val_masked_gp_l1_reg_loss: 90533.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137230.0000; val_chrom_access_recon_loss: 15108196.2667; val_global_loss: 39961126.6667; val_optim_loss: 39961126.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9348; val_auprc_score: 0.9236; val_best_acc_score: 0.8732; val_best_f1_score: 0.8800; train_kl_reg_loss: 149510.5363; train_edge_recon_loss: 2867399.8053; train_gene_expr_recon_loss: 21397867.3740; train_masked_gp_l1_reg_loss: 91665.7810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132338.3040; train_chrom_access_recon_loss: 14879980.0305; train_global_loss: 39518761.4351; train_optim_loss: 39518761.4351; val_kl_reg_loss: 150748.8771; val_edge_recon_loss: 2874193.8667; val_gene_expr_recon_loss: 21356738.1333; val_masked_gp_l1_reg_loss: 92707.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127642.0625; val_chrom_access_recon_loss: 14936798.8000; val_global_loss: 39538829.6000; val_optim_loss: 39538829.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9375; val_auprc_score: 0.9204; val_best_acc_score: 0.8770; val_best_f1_score: 0.8835; train_kl_reg_loss: 144328.7907; train_edge_recon_loss: 2857365.5267; train_gene_expr_recon_loss: 21320446.1527; train_masked_gp_l1_reg_loss: 93714.9244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123325.5780; train_chrom_access_recon_loss: 14847159.1298; train_global_loss: 39386339.9084; train_optim_loss: 39386339.9084; val_kl_reg_loss: 143026.9010; val_edge_recon_loss: 2851112.8167; val_gene_expr_recon_loss: 21335254.2667; val_masked_gp_l1_reg_loss: 94792.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119071.5234; val_chrom_access_recon_loss: 14921967.8667; val_global_loss: 39465225.6000; val_optim_loss: 39465225.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9406; val_auprc_score: 0.9259; val_best_acc_score: 0.8897; val_best_f1_score: 0.8957; train_kl_reg_loss: 143114.3687; train_edge_recon_loss: 2839993.0420; train_gene_expr_recon_loss: 21249323.2977; train_masked_gp_l1_reg_loss: 95592.4192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115054.9893; train_chrom_access_recon_loss: 14805818.3282; train_global_loss: 39248896.3664; train_optim_loss: 39248896.3664; val_kl_reg_loss: 135252.2807; val_edge_recon_loss: 2836112.1000; val_gene_expr_recon_loss: 21285157.2000; val_masked_gp_l1_reg_loss: 96518.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111144.5703; val_chrom_access_recon_loss: 14858185.4667; val_global_loss: 39322368.8000; val_optim_loss: 39322368.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9402; val_auprc_score: 0.9240; val_best_acc_score: 0.8839; val_best_f1_score: 0.8903; train_kl_reg_loss: 138638.5900; train_edge_recon_loss: 2822453.2176; train_gene_expr_recon_loss: 21183168.6260; train_masked_gp_l1_reg_loss: 97331.9417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107544.3417; train_chrom_access_recon_loss: 14776067.1756; train_global_loss: 39125203.7252; train_optim_loss: 39125203.7252; val_kl_reg_loss: 135444.4953; val_edge_recon_loss: 2832572.9667; val_gene_expr_recon_loss: 21150210.0000; val_masked_gp_l1_reg_loss: 98395.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104153.1953; val_chrom_access_recon_loss: 14807749.2667; val_global_loss: 39128526.4000; val_optim_loss: 39128526.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9395; val_auprc_score: 0.9229; val_best_acc_score: 0.8806; val_best_f1_score: 0.8870; train_kl_reg_loss: 134071.4091; train_edge_recon_loss: 2816789.3721; train_gene_expr_recon_loss: 21114262.6565; train_masked_gp_l1_reg_loss: 99142.3500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101001.8164; train_chrom_access_recon_loss: 14741727.8473; train_global_loss: 39006995.6947; train_optim_loss: 39006995.6947; val_kl_reg_loss: 131250.0589; val_edge_recon_loss: 2844532.6333; val_gene_expr_recon_loss: 21100675.2000; val_masked_gp_l1_reg_loss: 100017.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97870.6875; val_chrom_access_recon_loss: 14798782.9333; val_global_loss: 39073129.3333; val_optim_loss: 39073129.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9459; val_auprc_score: 0.9335; val_best_acc_score: 0.8866; val_best_f1_score: 0.8905; train_kl_reg_loss: 130134.5338; train_edge_recon_loss: 2813516.4351; train_gene_expr_recon_loss: 21063871.9847; train_masked_gp_l1_reg_loss: 100713.6870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95158.0354; train_chrom_access_recon_loss: 14719900.0305; train_global_loss: 38923294.6565; train_optim_loss: 38923294.6565; val_kl_reg_loss: 127086.5604; val_edge_recon_loss: 2816451.2833; val_gene_expr_recon_loss: 21033291.8667; val_masked_gp_l1_reg_loss: 101658.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92514.6484; val_chrom_access_recon_loss: 14769711.8000; val_global_loss: 38940713.0667; val_optim_loss: 38940713.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9465; val_auprc_score: 0.9351; val_best_acc_score: 0.8876; val_best_f1_score: 0.8925; train_kl_reg_loss: 126954.8274; train_edge_recon_loss: 2797272.3034; train_gene_expr_recon_loss: 21012442.2443; train_masked_gp_l1_reg_loss: 102242.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89977.9511; train_chrom_access_recon_loss: 14688142.1603; train_global_loss: 38817032.1527; train_optim_loss: 38817032.1527; val_kl_reg_loss: 127269.6224; val_edge_recon_loss: 2811766.8833; val_gene_expr_recon_loss: 21064803.0667; val_masked_gp_l1_reg_loss: 102981.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87649.8438; val_chrom_access_recon_loss: 14790740.8667; val_global_loss: 38985212.8000; val_optim_loss: 38985212.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9533; val_auprc_score: 0.9422; val_best_acc_score: 0.8971; val_best_f1_score: 0.9028; train_kl_reg_loss: 125816.6558; train_edge_recon_loss: 2792721.5134; train_gene_expr_recon_loss: 20971809.2824; train_masked_gp_l1_reg_loss: 103664.7641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85382.0116; train_chrom_access_recon_loss: 14669517.8015; train_global_loss: 38748911.9695; train_optim_loss: 38748911.9695; val_kl_reg_loss: 122720.5214; val_edge_recon_loss: 2797278.9833; val_gene_expr_recon_loss: 21029985.4667; val_masked_gp_l1_reg_loss: 104333.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83120.0703; val_chrom_access_recon_loss: 14814179.8667; val_global_loss: 38951619.2000; val_optim_loss: 38951619.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9529; val_auprc_score: 0.9424; val_best_acc_score: 0.8965; val_best_f1_score: 0.9018; train_kl_reg_loss: 123746.3082; train_edge_recon_loss: 2784599.9427; train_gene_expr_recon_loss: 20918196.6412; train_masked_gp_l1_reg_loss: 105076.7716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80917.7360; train_chrom_access_recon_loss: 14631684.5267; train_global_loss: 38644222.0153; train_optim_loss: 38644222.0153; val_kl_reg_loss: 121461.8594; val_edge_recon_loss: 2782983.3167; val_gene_expr_recon_loss: 20976271.2000; val_masked_gp_l1_reg_loss: 105833.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78815.9688; val_chrom_access_recon_loss: 14748884.4667; val_global_loss: 38814250.9333; val_optim_loss: 38814250.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9576; val_auprc_score: 0.9464; val_best_acc_score: 0.9038; val_best_f1_score: 0.9079; train_kl_reg_loss: 120879.2783; train_edge_recon_loss: 2788580.8531; train_gene_expr_recon_loss: 20894383.3130; train_masked_gp_l1_reg_loss: 106479.2869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76798.0103; train_chrom_access_recon_loss: 14624262.2137; train_global_loss: 38611382.9313; train_optim_loss: 38611382.9313; val_kl_reg_loss: 118565.0323; val_edge_recon_loss: 2764094.7500; val_gene_expr_recon_loss: 20945942.9333; val_masked_gp_l1_reg_loss: 107132.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74838.0859; val_chrom_access_recon_loss: 14778319.9333; val_global_loss: 38788892.8000; val_optim_loss: 38788892.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9596; val_auprc_score: 0.9514; val_best_acc_score: 0.9020; val_best_f1_score: 0.9055; train_kl_reg_loss: 118398.0537; train_edge_recon_loss: 2772201.7443; train_gene_expr_recon_loss: 20832818.3969; train_masked_gp_l1_reg_loss: 107802.0722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72981.8282; train_chrom_access_recon_loss: 14585736.0458; train_global_loss: 38489938.1679; train_optim_loss: 38489938.1679; val_kl_reg_loss: 117955.4406; val_edge_recon_loss: 2765842.0667; val_gene_expr_recon_loss: 20810391.4667; val_masked_gp_l1_reg_loss: 108612.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71132.3125; val_chrom_access_recon_loss: 14629681.6000; val_global_loss: 38503614.6667; val_optim_loss: 38503614.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9543; val_auprc_score: 0.9399; val_best_acc_score: 0.8967; val_best_f1_score: 0.9028; train_kl_reg_loss: 118102.1298; train_edge_recon_loss: 2767477.1508; train_gene_expr_recon_loss: 20832220.2443; train_masked_gp_l1_reg_loss: 109131.4176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69505.9700; train_chrom_access_recon_loss: 14602853.7557; train_global_loss: 38499290.6870; train_optim_loss: 38499290.6870; val_kl_reg_loss: 118063.8115; val_edge_recon_loss: 2783747.7833; val_gene_expr_recon_loss: 20823524.8000; val_masked_gp_l1_reg_loss: 109816.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67920.2031; val_chrom_access_recon_loss: 14697240.5333; val_global_loss: 38600312.8000; val_optim_loss: 38600312.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9567; val_auprc_score: 0.9453; val_best_acc_score: 0.8981; val_best_f1_score: 0.9036; train_kl_reg_loss: 116485.4505; train_edge_recon_loss: 2760202.1527; train_gene_expr_recon_loss: 20793097.0076; train_masked_gp_l1_reg_loss: 110469.3482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66451.2993; train_chrom_access_recon_loss: 14581383.4885; train_global_loss: 38428088.8244; train_optim_loss: 38428088.8244; val_kl_reg_loss: 116073.9880; val_edge_recon_loss: 2766401.9833; val_gene_expr_recon_loss: 20792260.6667; val_masked_gp_l1_reg_loss: 111208.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65097.2734; val_chrom_access_recon_loss: 14674669.1333; val_global_loss: 38525711.7333; val_optim_loss: 38525711.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9609; val_auprc_score: 0.9486; val_best_acc_score: 0.9070; val_best_f1_score: 0.9109; train_kl_reg_loss: 114438.2858; train_edge_recon_loss: 2766043.2271; train_gene_expr_recon_loss: 20793188.0153; train_masked_gp_l1_reg_loss: 111738.2749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63781.3210; train_chrom_access_recon_loss: 14594800.8855; train_global_loss: 38443989.8015; train_optim_loss: 38443989.8015; val_kl_reg_loss: 111859.8490; val_edge_recon_loss: 2771699.7500; val_gene_expr_recon_loss: 20763421.2000; val_masked_gp_l1_reg_loss: 112402.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62591.8086; val_chrom_access_recon_loss: 14657871.8667; val_global_loss: 38479846.4000; val_optim_loss: 38479846.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9592; val_auprc_score: 0.9466; val_best_acc_score: 0.9070; val_best_f1_score: 0.9112; train_kl_reg_loss: 112511.7003; train_edge_recon_loss: 2752515.0229; train_gene_expr_recon_loss: 20736121.5420; train_masked_gp_l1_reg_loss: 113040.1753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61470.8345; train_chrom_access_recon_loss: 14555637.0153; train_global_loss: 38331296.3053; train_optim_loss: 38331296.3053; val_kl_reg_loss: 110586.2865; val_edge_recon_loss: 2771841.3833; val_gene_expr_recon_loss: 20683512.2667; val_masked_gp_l1_reg_loss: 113744.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60487.0742; val_chrom_access_recon_loss: 14600766.9333; val_global_loss: 38340938.9333; val_optim_loss: 38340938.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9665; val_auprc_score: 0.9557; val_best_acc_score: 0.9157; val_best_f1_score: 0.9194; train_kl_reg_loss: 110682.0951; train_edge_recon_loss: 2746124.4447; train_gene_expr_recon_loss: 20717921.5573; train_masked_gp_l1_reg_loss: 114543.4962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59456.2176; train_chrom_access_recon_loss: 14553003.6260; train_global_loss: 38301731.3893; train_optim_loss: 38301731.3893; val_kl_reg_loss: 111205.6927; val_edge_recon_loss: 2743957.5167; val_gene_expr_recon_loss: 20802610.9333; val_masked_gp_l1_reg_loss: 115297.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58483.1836; val_chrom_access_recon_loss: 14722561.5333; val_global_loss: 38554117.6000; val_optim_loss: 38554117.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9653; val_auprc_score: 0.9567; val_best_acc_score: 0.9144; val_best_f1_score: 0.9165; train_kl_reg_loss: 111206.1573; train_edge_recon_loss: 2740022.8263; train_gene_expr_recon_loss: 20712529.0992; train_masked_gp_l1_reg_loss: 115760.8489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57685.3539; train_chrom_access_recon_loss: 14558685.6870; train_global_loss: 38295889.8015; train_optim_loss: 38295889.8015; val_kl_reg_loss: 110672.6594; val_edge_recon_loss: 2757221.7333; val_gene_expr_recon_loss: 20663541.4667; val_masked_gp_l1_reg_loss: 116412.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56849.9688; val_chrom_access_recon_loss: 14588475.0000; val_global_loss: 38293173.0667; val_optim_loss: 38293173.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9593; val_auprc_score: 0.9482; val_best_acc_score: 0.9073; val_best_f1_score: 0.9105; train_kl_reg_loss: 112395.4693; train_edge_recon_loss: 2826736.0458; train_gene_expr_recon_loss: 21568428.4275; train_masked_gp_l1_reg_loss: 116888.8552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58736.3141; train_chrom_access_recon_loss: 14750091.7634; train_global_loss: 39433276.7328; train_optim_loss: 39433276.7328; val_kl_reg_loss: 51032.2474; val_edge_recon_loss: 2799371.0667; val_gene_expr_recon_loss: 21446732.0000; val_masked_gp_l1_reg_loss: 117412.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58117.6094; val_chrom_access_recon_loss: 14806150.7333; val_global_loss: 39278815.7333; val_optim_loss: 39278815.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9600; val_auprc_score: 0.9477; val_best_acc_score: 0.9080; val_best_f1_score: 0.9114; train_kl_reg_loss: 111584.1362; train_edge_recon_loss: 2772652.4351; train_gene_expr_recon_loss: 21376356.5038; train_masked_gp_l1_reg_loss: 117635.5341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57124.8227; train_chrom_access_recon_loss: 14678070.3206; train_global_loss: 39113423.5725; train_optim_loss: 39113423.5725; val_kl_reg_loss: 56926.7156; val_edge_recon_loss: 2776472.4833; val_gene_expr_recon_loss: 21341962.1333; val_masked_gp_l1_reg_loss: 117850.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56001.9453; val_chrom_access_recon_loss: 14718996.0000; val_global_loss: 39068209.3333; val_optim_loss: 39068209.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9637; val_auprc_score: 0.9521; val_best_acc_score: 0.9136; val_best_f1_score: 0.9161; train_kl_reg_loss: 103505.7357; train_edge_recon_loss: 2754335.1889; train_gene_expr_recon_loss: 21330699.7252; train_masked_gp_l1_reg_loss: 117934.0338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55225.3696; train_chrom_access_recon_loss: 14680028.2824; train_global_loss: 39041728.5802; train_optim_loss: 39041728.5802; val_kl_reg_loss: 61341.4932; val_edge_recon_loss: 2749946.6167; val_gene_expr_recon_loss: 21365458.8000; val_masked_gp_l1_reg_loss: 117846.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54313.5977; val_chrom_access_recon_loss: 14795736.1333; val_global_loss: 39144643.2000; val_optim_loss: 39144643.2000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9670; val_auprc_score: 0.9573; val_best_acc_score: 0.9135; val_best_f1_score: 0.9160; train_kl_reg_loss: 97805.9781; train_edge_recon_loss: 2745200.6622; train_gene_expr_recon_loss: 21262191.1908; train_masked_gp_l1_reg_loss: 117822.4447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53454.6140; train_chrom_access_recon_loss: 14662243.7023; train_global_loss: 38938718.4122; train_optim_loss: 38938718.4122; val_kl_reg_loss: 66295.7831; val_edge_recon_loss: 2737537.7000; val_gene_expr_recon_loss: 21204741.0667; val_masked_gp_l1_reg_loss: 117715.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52573.5117; val_chrom_access_recon_loss: 14680648.1333; val_global_loss: 38859513.3333; val_optim_loss: 38859513.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9607; val_auprc_score: 0.9476; val_best_acc_score: 0.9041; val_best_f1_score: 0.9075; train_kl_reg_loss: 94914.7198; train_edge_recon_loss: 2732084.8149; train_gene_expr_recon_loss: 21226879.1450; train_masked_gp_l1_reg_loss: 117214.8559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52267.2431; train_chrom_access_recon_loss: 14661065.8626; train_global_loss: 38884426.7786; train_optim_loss: 38884426.7786; val_kl_reg_loss: 66999.7857; val_edge_recon_loss: 2768052.6333; val_gene_expr_recon_loss: 21260741.8667; val_masked_gp_l1_reg_loss: 117050.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52020.9180; val_chrom_access_recon_loss: 14770217.4667; val_global_loss: 39035082.1333; val_optim_loss: 39035082.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9624; val_auprc_score: 0.9489; val_best_acc_score: 0.9100; val_best_f1_score: 0.9122; train_kl_reg_loss: 95467.0417; train_edge_recon_loss: 2735042.4179; train_gene_expr_recon_loss: 21209181.9542; train_masked_gp_l1_reg_loss: 116979.8805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51842.5892; train_chrom_access_recon_loss: 14645623.1985; train_global_loss: 38854137.2519; train_optim_loss: 38854137.2519; val_kl_reg_loss: 67451.4698; val_edge_recon_loss: 2755318.8000; val_gene_expr_recon_loss: 21307957.0667; val_masked_gp_l1_reg_loss: 116908.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51676.2344; val_chrom_access_recon_loss: 14800325.1333; val_global_loss: 39099636.2667; val_optim_loss: 39099636.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9635; val_auprc_score: 0.9517; val_best_acc_score: 0.9104; val_best_f1_score: 0.9143; train_kl_reg_loss: 95316.0469; train_edge_recon_loss: 2733562.6546; train_gene_expr_recon_loss: 21207978.0458; train_masked_gp_l1_reg_loss: 116851.5585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51523.2558; train_chrom_access_recon_loss: 14654852.8397; train_global_loss: 38860084.3664; train_optim_loss: 38860084.3664; val_kl_reg_loss: 67817.3167; val_edge_recon_loss: 2757346.1000; val_gene_expr_recon_loss: 21171840.4000; val_masked_gp_l1_reg_loss: 116801.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51374.5469; val_chrom_access_recon_loss: 14725873.7333; val_global_loss: 38891053.3333; val_optim_loss: 38891053.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9662; val_auprc_score: 0.9542; val_best_acc_score: 0.9194; val_best_f1_score: 0.9214; train_kl_reg_loss: 95122.2620; train_edge_recon_loss: 2728467.6279; train_gene_expr_recon_loss: 21196647.2366; train_masked_gp_l1_reg_loss: 116763.2348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51243.5624; train_chrom_access_recon_loss: 14644504.4580; train_global_loss: 38832747.9389; train_optim_loss: 38832747.9389; val_kl_reg_loss: 68687.5370; val_edge_recon_loss: 2734158.7000; val_gene_expr_recon_loss: 21313556.6667; val_masked_gp_l1_reg_loss: 116712.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51095.3477; val_chrom_access_recon_loss: 14783649.8667; val_global_loss: 39067860.5333; val_optim_loss: 39067860.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9679
val AUPRC score: 0.9594
val best accuracy score: 0.9159
val best F1 score: 0.9187
val target rna MSE score: 1.3984
val source rna MSE score: 49.8421
val target atac MSE score: 0.3568
val source atac MSE score: 1205.1683
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
