Run timestamp: 14062023_191900.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '10000.', '--contrastive_logits_ratio', '0.03125', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1583.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 734, n_latent: 734, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 734, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 734, n_cond_embed_input: 734, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9502; val_auprc_score: 0.9940; val_best_acc_score: 0.9697; val_best_f1_score: 0.9838; train_kl_reg_loss: 2259.4636; train_edge_recon_loss: 41477.1399; train_cond_contrastive_loss: 3745.5434; train_gene_expr_recon_loss: 104045.3986; train_masked_gp_l1_reg_loss: 437.6581; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151965.2038; train_optim_loss: 151965.2038; val_kl_reg_loss: 2289.7479; val_edge_recon_loss: 40393.0128; val_cond_contrastive_loss: 3621.5925; val_gene_expr_recon_loss: 99230.8688; val_masked_gp_l1_reg_loss: 546.3504; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146081.5649; val_optim_loss: 146081.5649
Run timestamp: 14062023_191901.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', '20', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '10000.', '--contrastive_logits_ratio', '0.03125', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1583.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 734, n_latent: 734, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 734, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 734, n_cond_embed_input: 20, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9507; val_auprc_score: 0.9936; val_best_acc_score: 0.9708; val_best_f1_score: 0.9843; train_kl_reg_loss: 3030.9088; train_edge_recon_loss: 42445.8106; train_cond_contrastive_loss: 3949.9037; train_gene_expr_recon_loss: 109397.9805; train_masked_gp_l1_reg_loss: 719.1503; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159543.7535; train_optim_loss: 159543.7535; val_kl_reg_loss: 2372.4400; val_edge_recon_loss: 40930.1577; val_cond_contrastive_loss: 3645.8319; val_gene_expr_recon_loss: 99305.5216; val_masked_gp_l1_reg_loss: 678.3308; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146932.2803; val_optim_loss: 146932.2803
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9549; val_auprc_score: 0.9949; val_best_acc_score: 0.9727; val_best_f1_score: 0.9853; train_kl_reg_loss: 2390.3427; train_edge_recon_loss: 40239.1472; train_cond_contrastive_loss: 3737.1550; train_gene_expr_recon_loss: 97165.1443; train_masked_gp_l1_reg_loss: 581.8718; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144113.6612; train_optim_loss: 144113.6612; val_kl_reg_loss: 2373.0321; val_edge_recon_loss: 40439.2816; val_cond_contrastive_loss: 3625.1369; val_gene_expr_recon_loss: 95200.1178; val_masked_gp_l1_reg_loss: 607.1233; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142244.6941; val_optim_loss: 142244.6941
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9509; val_auprc_score: 0.9934; val_best_acc_score: 0.9732; val_best_f1_score: 0.9856; train_kl_reg_loss: 2448.2115; train_edge_recon_loss: 40107.3460; train_cond_contrastive_loss: 3767.8560; train_gene_expr_recon_loss: 97345.6751; train_masked_gp_l1_reg_loss: 674.5772; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144343.6658; train_optim_loss: 144343.6658; val_kl_reg_loss: 2445.8744; val_edge_recon_loss: 40747.7261; val_cond_contrastive_loss: 3628.0728; val_gene_expr_recon_loss: 95236.1143; val_masked_gp_l1_reg_loss: 681.2178; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142739.0068; val_optim_loss: 142739.0068
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9524; val_auprc_score: 0.9946; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 2459.0937; train_edge_recon_loss: 40234.3954; train_cond_contrastive_loss: 3716.0240; train_gene_expr_recon_loss: 94134.5793; train_masked_gp_l1_reg_loss: 620.1771; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141164.2690; train_optim_loss: 141164.2690; val_kl_reg_loss: 2484.5764; val_edge_recon_loss: 40556.2946; val_cond_contrastive_loss: 3626.2862; val_gene_expr_recon_loss: 93044.7433; val_masked_gp_l1_reg_loss: 629.0317; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140340.9319; val_optim_loss: 140340.9319
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9481; val_auprc_score: 0.9931; val_best_acc_score: 0.9737; val_best_f1_score: 0.9859; train_kl_reg_loss: 2496.2701; train_edge_recon_loss: 40206.4823; train_cond_contrastive_loss: 3740.6795; train_gene_expr_recon_loss: 94217.4667; train_masked_gp_l1_reg_loss: 690.9138; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141351.8126; train_optim_loss: 141351.8126; val_kl_reg_loss: 2460.5455; val_edge_recon_loss: 40795.1368; val_cond_contrastive_loss: 3625.1696; val_gene_expr_recon_loss: 92932.1735; val_masked_gp_l1_reg_loss: 699.0575; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140512.0881; val_optim_loss: 140512.0881
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9540; val_auprc_score: 0.9947; val_best_acc_score: 0.9731; val_best_f1_score: 0.9855; train_kl_reg_loss: 2502.9427; train_edge_recon_loss: 40161.2564; train_cond_contrastive_loss: 3715.9462; train_gene_expr_recon_loss: 92462.8036; train_masked_gp_l1_reg_loss: 630.6556; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139473.6045; train_optim_loss: 139473.6045; val_kl_reg_loss: 2417.9687; val_edge_recon_loss: 41442.6743; val_cond_contrastive_loss: 3604.6963; val_gene_expr_recon_loss: 91745.2501; val_masked_gp_l1_reg_loss: 633.8288; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139844.4165; val_optim_loss: 139844.4165
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9494; val_auprc_score: 0.9930; val_best_acc_score: 0.9754; val_best_f1_score: 0.9868; train_kl_reg_loss: 2541.2920; train_edge_recon_loss: 40234.6126; train_cond_contrastive_loss: 3722.3367; train_gene_expr_recon_loss: 92407.0688; train_masked_gp_l1_reg_loss: 707.5943; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139612.9038; train_optim_loss: 139612.9038; val_kl_reg_loss: 2573.7607; val_edge_recon_loss: 41374.8611; val_cond_contrastive_loss: 3597.9031; val_gene_expr_recon_loss: 91478.8330; val_masked_gp_l1_reg_loss: 714.0016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139739.3584; val_optim_loss: 139739.3584
Run timestamp: 14062023_191900.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '10000.', '--contrastive_logits_ratio', '0.03125', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1583.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 734, n_latent: 734, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 734, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 734, n_cond_embed_input: 734, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 4503608
Number of validation edges: 500400
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9702; val_auprc_score: 0.9966; val_best_acc_score: 0.9801; val_best_f1_score: 0.9893; train_kl_reg_loss: 2249.9416; train_edge_recon_loss: 40663.2545; train_cond_contrastive_loss: 3672.8887; train_gene_expr_recon_loss: 102255.2799; train_masked_gp_l1_reg_loss: 465.8376; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149307.2023; train_optim_loss: 149307.2023; val_kl_reg_loss: 2325.4866; val_edge_recon_loss: 39992.7054; val_cond_contrastive_loss: 3564.2552; val_gene_expr_recon_loss: 97921.4524; val_masked_gp_l1_reg_loss: 544.0488; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144347.9460; val_optim_loss: 144347.9460
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9574; val_auprc_score: 0.9953; val_best_acc_score: 0.9744; val_best_f1_score: 0.9862; train_kl_reg_loss: 2528.2670; train_edge_recon_loss: 40118.5473; train_cond_contrastive_loss: 3708.2470; train_gene_expr_recon_loss: 91472.7084; train_masked_gp_l1_reg_loss: 634.1374; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138461.9071; train_optim_loss: 138461.9071; val_kl_reg_loss: 2476.8038; val_edge_recon_loss: 40769.2334; val_cond_contrastive_loss: 3634.4346; val_gene_expr_recon_loss: 91085.1660; val_masked_gp_l1_reg_loss: 634.9456; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138600.5918; val_optim_loss: 138600.5918
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9497; val_auprc_score: 0.9928; val_best_acc_score: 0.9763; val_best_f1_score: 0.9873; train_kl_reg_loss: 2565.5885; train_edge_recon_loss: 40124.6338; train_cond_contrastive_loss: 3705.8548; train_gene_expr_recon_loss: 91295.4428; train_masked_gp_l1_reg_loss: 718.9125; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138410.4317; train_optim_loss: 138410.4317; val_kl_reg_loss: 2508.2443; val_edge_recon_loss: 41292.1984; val_cond_contrastive_loss: 3633.5111; val_gene_expr_recon_loss: 90683.4124; val_masked_gp_l1_reg_loss: 722.9376; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138840.3047; val_optim_loss: 138840.3047
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9540; val_auprc_score: 0.9947; val_best_acc_score: 0.9737; val_best_f1_score: 0.9859; train_kl_reg_loss: 2558.0986; train_edge_recon_loss: 40142.3036; train_cond_contrastive_loss: 3692.0188; train_gene_expr_recon_loss: 90878.8285; train_masked_gp_l1_reg_loss: 637.5575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137908.8066; train_optim_loss: 137908.8066; val_kl_reg_loss: 2479.2773; val_edge_recon_loss: 41270.5061; val_cond_contrastive_loss: 3587.3064; val_gene_expr_recon_loss: 90538.2074; val_masked_gp_l1_reg_loss: 638.6398; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138513.9377; val_optim_loss: 138513.9377
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9486; val_auprc_score: 0.9929; val_best_acc_score: 0.9762; val_best_f1_score: 0.9872; train_kl_reg_loss: 2591.6323; train_edge_recon_loss: 40182.7109; train_cond_contrastive_loss: 3697.1989; train_gene_expr_recon_loss: 90566.8514; train_masked_gp_l1_reg_loss: 723.2546; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137761.6483; train_optim_loss: 137761.6483; val_kl_reg_loss: 2522.5140; val_edge_recon_loss: 40796.1426; val_cond_contrastive_loss: 3607.6594; val_gene_expr_recon_loss: 90088.2106; val_masked_gp_l1_reg_loss: 724.5013; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137739.0254; val_optim_loss: 137739.0254
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9569; val_auprc_score: 0.9951; val_best_acc_score: 0.9753; val_best_f1_score: 0.9867; train_kl_reg_loss: 2577.5828; train_edge_recon_loss: 40122.4925; train_cond_contrastive_loss: 3689.1634; train_gene_expr_recon_loss: 90477.5888; train_masked_gp_l1_reg_loss: 640.0414; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137506.8687; train_optim_loss: 137506.8687; val_kl_reg_loss: 2519.7966; val_edge_recon_loss: 40802.7515; val_cond_contrastive_loss: 3610.7625; val_gene_expr_recon_loss: 90329.4785; val_masked_gp_l1_reg_loss: 641.6350; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137904.4297; val_optim_loss: 137904.4297
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9503; val_auprc_score: 0.9930; val_best_acc_score: 0.9772; val_best_f1_score: 0.9878; train_kl_reg_loss: 2608.9823; train_edge_recon_loss: 40092.0560; train_cond_contrastive_loss: 3693.8789; train_gene_expr_recon_loss: 90106.5196; train_masked_gp_l1_reg_loss: 724.6552; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137226.0919; train_optim_loss: 137226.0919; val_kl_reg_loss: 2528.9606; val_edge_recon_loss: 41189.9057; val_cond_contrastive_loss: 3626.5541; val_gene_expr_recon_loss: 89804.8320; val_masked_gp_l1_reg_loss: 725.4566; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137875.7056; val_optim_loss: 137875.7056
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9551; val_auprc_score: 0.9949; val_best_acc_score: 0.9752; val_best_f1_score: 0.9867; train_kl_reg_loss: 2588.5728; train_edge_recon_loss: 39980.2897; train_cond_contrastive_loss: 3676.5900; train_gene_expr_recon_loss: 90201.9774; train_masked_gp_l1_reg_loss: 645.4736; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137092.9035; train_optim_loss: 137092.9035; val_kl_reg_loss: 2523.2465; val_edge_recon_loss: 40825.9179; val_cond_contrastive_loss: 3587.8437; val_gene_expr_recon_loss: 89972.6062; val_masked_gp_l1_reg_loss: 649.2380; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137558.8484; val_optim_loss: 137558.8484
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9743; val_auprc_score: 0.9972; val_best_acc_score: 0.9816; val_best_f1_score: 0.9901; train_kl_reg_loss: 2362.5079; train_edge_recon_loss: 39854.4446; train_cond_contrastive_loss: 3654.4820; train_gene_expr_recon_loss: 96397.6760; train_masked_gp_l1_reg_loss: 549.9551; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142819.0660; train_optim_loss: 142819.0660; val_kl_reg_loss: 2390.4273; val_edge_recon_loss: 39958.6545; val_cond_contrastive_loss: 3565.2886; val_gene_expr_recon_loss: 94957.0109; val_masked_gp_l1_reg_loss: 551.9325; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141423.3187; val_optim_loss: 141423.3187
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9502; val_auprc_score: 0.9930; val_best_acc_score: 0.9762; val_best_f1_score: 0.9872; train_kl_reg_loss: 2616.9619; train_edge_recon_loss: 40144.8532; train_cond_contrastive_loss: 3677.8166; train_gene_expr_recon_loss: 89785.1363; train_masked_gp_l1_reg_loss: 726.0699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136950.8382; train_optim_loss: 136950.8382; val_kl_reg_loss: 2604.3905; val_edge_recon_loss: 41834.5624; val_cond_contrastive_loss: 3590.3472; val_gene_expr_recon_loss: 89537.1958; val_masked_gp_l1_reg_loss: 726.3501; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138292.8394; val_optim_loss: 138292.8394
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9555; val_auprc_score: 0.9949; val_best_acc_score: 0.9758; val_best_f1_score: 0.9870; train_kl_reg_loss: 2599.6065; train_edge_recon_loss: 39962.1927; train_cond_contrastive_loss: 3683.5527; train_gene_expr_recon_loss: 89948.3413; train_masked_gp_l1_reg_loss: 652.2678; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136845.9610; train_optim_loss: 136845.9610; val_kl_reg_loss: 2522.2392; val_edge_recon_loss: 40783.6229; val_cond_contrastive_loss: 3570.2231; val_gene_expr_recon_loss: 89798.2601; val_masked_gp_l1_reg_loss: 656.2775; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137330.6267; val_optim_loss: 137330.6267
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9516; val_auprc_score: 0.9932; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2622.0913; train_edge_recon_loss: 40168.3984; train_cond_contrastive_loss: 3677.1591; train_gene_expr_recon_loss: 89581.5398; train_masked_gp_l1_reg_loss: 728.2761; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136777.4643; train_optim_loss: 136777.4643; val_kl_reg_loss: 2568.3139; val_edge_recon_loss: 40891.9375; val_cond_contrastive_loss: 3621.1351; val_gene_expr_recon_loss: 89263.9283; val_masked_gp_l1_reg_loss: 729.1816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137074.5037; val_optim_loss: 137074.5037
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9569; val_auprc_score: 0.9950; val_best_acc_score: 0.9751; val_best_f1_score: 0.9866; train_kl_reg_loss: 2607.9715; train_edge_recon_loss: 40125.6475; train_cond_contrastive_loss: 3676.7674; train_gene_expr_recon_loss: 89802.5796; train_masked_gp_l1_reg_loss: 657.5944; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136870.5602; train_optim_loss: 136870.5602; val_kl_reg_loss: 2535.1604; val_edge_recon_loss: 40956.3862; val_cond_contrastive_loss: 3598.1046; val_gene_expr_recon_loss: 89664.2947; val_masked_gp_l1_reg_loss: 659.5970; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137413.5406; val_optim_loss: 137413.5406
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9493; val_auprc_score: 0.9927; val_best_acc_score: 0.9779; val_best_f1_score: 0.9881; train_kl_reg_loss: 2632.0968; train_edge_recon_loss: 40089.8130; train_cond_contrastive_loss: 3670.2617; train_gene_expr_recon_loss: 89404.9649; train_masked_gp_l1_reg_loss: 730.5286; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136527.6648; train_optim_loss: 136527.6648; val_kl_reg_loss: 2560.5751; val_edge_recon_loss: 40722.6439; val_cond_contrastive_loss: 3588.9550; val_gene_expr_recon_loss: 89213.8889; val_masked_gp_l1_reg_loss: 730.5211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136816.5784; val_optim_loss: 136816.5784
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9565; val_auprc_score: 0.9949; val_best_acc_score: 0.9758; val_best_f1_score: 0.9870; train_kl_reg_loss: 2619.4232; train_edge_recon_loss: 40084.8193; train_cond_contrastive_loss: 3673.7718; train_gene_expr_recon_loss: 89679.4432; train_masked_gp_l1_reg_loss: 659.5598; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136717.0171; train_optim_loss: 136717.0171; val_kl_reg_loss: 2557.5194; val_edge_recon_loss: 41100.4633; val_cond_contrastive_loss: 3619.1153; val_gene_expr_recon_loss: 89537.4299; val_masked_gp_l1_reg_loss: 661.0604; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137475.5908; val_optim_loss: 137475.5908
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9503; val_auprc_score: 0.9929; val_best_acc_score: 0.9777; val_best_f1_score: 0.9880; train_kl_reg_loss: 2639.2594; train_edge_recon_loss: 40014.1701; train_cond_contrastive_loss: 3665.6653; train_gene_expr_recon_loss: 89292.8960; train_masked_gp_l1_reg_loss: 731.4289; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136343.4195; train_optim_loss: 136343.4195; val_kl_reg_loss: 2608.4018; val_edge_recon_loss: 41133.9526; val_cond_contrastive_loss: 3580.8965; val_gene_expr_recon_loss: 89003.7603; val_masked_gp_l1_reg_loss: 732.9509; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137059.9644; val_optim_loss: 137059.9644
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9569; val_auprc_score: 0.9952; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 2623.3918; train_edge_recon_loss: 39963.6169; train_cond_contrastive_loss: 3667.1592; train_gene_expr_recon_loss: 89550.5175; train_masked_gp_l1_reg_loss: 663.0575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136467.7427; train_optim_loss: 136467.7427; val_kl_reg_loss: 2526.0026; val_edge_recon_loss: 40834.4735; val_cond_contrastive_loss: 3586.1802; val_gene_expr_recon_loss: 89473.5046; val_masked_gp_l1_reg_loss: 663.7372; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137083.8953; val_optim_loss: 137083.8953
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9755; val_auprc_score: 0.9974; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2436.4514; train_edge_recon_loss: 39948.8681; train_cond_contrastive_loss: 3637.8481; train_gene_expr_recon_loss: 94428.7017; train_masked_gp_l1_reg_loss: 554.1202; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141005.9897; train_optim_loss: 141005.9897; val_kl_reg_loss: 2503.8788; val_edge_recon_loss: 39766.8245; val_cond_contrastive_loss: 3523.4594; val_gene_expr_recon_loss: 93781.5797; val_masked_gp_l1_reg_loss: 556.3989; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140132.1489; val_optim_loss: 140132.1489
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9511; val_auprc_score: 0.9933; val_best_acc_score: 0.9776; val_best_f1_score: 0.9880; train_kl_reg_loss: 2644.6700; train_edge_recon_loss: 40002.9892; train_cond_contrastive_loss: 3667.1218; train_gene_expr_recon_loss: 89156.4029; train_masked_gp_l1_reg_loss: 732.5290; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136203.7130; train_optim_loss: 136203.7130; val_kl_reg_loss: 2627.9483; val_edge_recon_loss: 40984.7215; val_cond_contrastive_loss: 3571.5714; val_gene_expr_recon_loss: 88943.1688; val_masked_gp_l1_reg_loss: 732.5726; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136859.9875; val_optim_loss: 136859.9875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9598; val_auprc_score: 0.9955; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 2626.6396; train_edge_recon_loss: 39977.7125; train_cond_contrastive_loss: 3668.3936; train_gene_expr_recon_loss: 89490.3434; train_masked_gp_l1_reg_loss: 666.3402; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136429.4291; train_optim_loss: 136429.4291; val_kl_reg_loss: 2566.5187; val_edge_recon_loss: 40794.8535; val_cond_contrastive_loss: 3616.6500; val_gene_expr_recon_loss: 89389.0895; val_masked_gp_l1_reg_loss: 667.8564; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137034.9709; val_optim_loss: 137034.9709
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9514; val_auprc_score: 0.9932; val_best_acc_score: 0.9786; val_best_f1_score: 0.9885; train_kl_reg_loss: 2656.2804; train_edge_recon_loss: 40198.4912; train_cond_contrastive_loss: 3656.4678; train_gene_expr_recon_loss: 89084.6707; train_masked_gp_l1_reg_loss: 733.7916; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136329.7016; train_optim_loss: 136329.7016; val_kl_reg_loss: 2549.3599; val_edge_recon_loss: 40595.3849; val_cond_contrastive_loss: 3602.6493; val_gene_expr_recon_loss: 88898.5345; val_masked_gp_l1_reg_loss: 733.2379; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136379.1631; val_optim_loss: 136379.1631
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9569; val_auprc_score: 0.9951; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 2640.2352; train_edge_recon_loss: 40085.6344; train_cond_contrastive_loss: 3663.0478; train_gene_expr_recon_loss: 89375.6703; train_masked_gp_l1_reg_loss: 667.9051; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136432.4928; train_optim_loss: 136432.4928; val_kl_reg_loss: 2583.6164; val_edge_recon_loss: 40420.2570; val_cond_contrastive_loss: 3564.2592; val_gene_expr_recon_loss: 89306.0204; val_masked_gp_l1_reg_loss: 669.3141; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136543.4659; val_optim_loss: 136543.4659
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9499; val_auprc_score: 0.9932; val_best_acc_score: 0.9774; val_best_f1_score: 0.9879; train_kl_reg_loss: 2652.7470; train_edge_recon_loss: 40088.0475; train_cond_contrastive_loss: 3654.1077; train_gene_expr_recon_loss: 88989.0457; train_masked_gp_l1_reg_loss: 733.9642; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136117.9122; train_optim_loss: 136117.9122; val_kl_reg_loss: 2599.9730; val_edge_recon_loss: 40777.2383; val_cond_contrastive_loss: 3560.1370; val_gene_expr_recon_loss: 88802.7543; val_masked_gp_l1_reg_loss: 733.8484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136473.9463; val_optim_loss: 136473.9463
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9575; val_auprc_score: 0.9951; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 2639.5803; train_edge_recon_loss: 39968.8238; train_cond_contrastive_loss: 3665.0002; train_gene_expr_recon_loss: 89339.1782; train_masked_gp_l1_reg_loss: 669.6233; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136282.2054; train_optim_loss: 136282.2054; val_kl_reg_loss: 2582.2292; val_edge_recon_loss: 41294.6436; val_cond_contrastive_loss: 3567.2709; val_gene_expr_recon_loss: 89336.2794; val_masked_gp_l1_reg_loss: 670.2485; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137450.6726; val_optim_loss: 137450.6726
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9492; val_auprc_score: 0.9927; val_best_acc_score: 0.9780; val_best_f1_score: 0.9882; train_kl_reg_loss: 2652.4955; train_edge_recon_loss: 39905.8113; train_cond_contrastive_loss: 3654.3698; train_gene_expr_recon_loss: 88953.3106; train_masked_gp_l1_reg_loss: 732.2509; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135898.2382; train_optim_loss: 135898.2382; val_kl_reg_loss: 2630.5681; val_edge_recon_loss: 40694.5193; val_cond_contrastive_loss: 3568.2859; val_gene_expr_recon_loss: 88813.6703; val_masked_gp_l1_reg_loss: 732.4230; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136439.4646; val_optim_loss: 136439.4646
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9607; val_auprc_score: 0.9956; val_best_acc_score: 0.9770; val_best_f1_score: 0.9876; train_kl_reg_loss: 2644.4376; train_edge_recon_loss: 40044.0130; train_cond_contrastive_loss: 3658.6879; train_gene_expr_recon_loss: 89251.7121; train_masked_gp_l1_reg_loss: 672.6520; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136271.5022; train_optim_loss: 136271.5022; val_kl_reg_loss: 2526.4278; val_edge_recon_loss: 40526.6525; val_cond_contrastive_loss: 3605.6306; val_gene_expr_recon_loss: 89212.6613; val_masked_gp_l1_reg_loss: 672.8743; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136544.2478; val_optim_loss: 136544.2478
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9762; val_auprc_score: 0.9975; val_best_acc_score: 0.9825; val_best_f1_score: 0.9906; train_kl_reg_loss: 2478.3440; train_edge_recon_loss: 39739.8393; train_cond_contrastive_loss: 3624.6787; train_gene_expr_recon_loss: 93536.9812; train_masked_gp_l1_reg_loss: 561.7054; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139941.5482; train_optim_loss: 139941.5482; val_kl_reg_loss: 2480.7955; val_edge_recon_loss: 40244.1537; val_cond_contrastive_loss: 3538.6106; val_gene_expr_recon_loss: 93101.0582; val_masked_gp_l1_reg_loss: 566.6510; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139931.2744; val_optim_loss: 139931.2744
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9512; val_auprc_score: 0.9929; val_best_acc_score: 0.9788; val_best_f1_score: 0.9886; train_kl_reg_loss: 2657.7029; train_edge_recon_loss: 40125.8515; train_cond_contrastive_loss: 3655.8098; train_gene_expr_recon_loss: 88893.5936; train_masked_gp_l1_reg_loss: 731.2611; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136064.2187; train_optim_loss: 136064.2187; val_kl_reg_loss: 2601.9705; val_edge_recon_loss: 41097.8958; val_cond_contrastive_loss: 3564.6838; val_gene_expr_recon_loss: 88743.5867; val_masked_gp_l1_reg_loss: 731.8054; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136739.9487; val_optim_loss: 136739.9487
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9569; val_auprc_score: 0.9951; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 2647.2705; train_edge_recon_loss: 39876.1751; train_cond_contrastive_loss: 3656.6331; train_gene_expr_recon_loss: 89207.0631; train_masked_gp_l1_reg_loss: 674.4500; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136061.5920; train_optim_loss: 136061.5920; val_kl_reg_loss: 2596.0980; val_edge_recon_loss: 40681.5881; val_cond_contrastive_loss: 3578.3854; val_gene_expr_recon_loss: 89165.4832; val_masked_gp_l1_reg_loss: 675.4297; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136696.9873; val_optim_loss: 136696.9873

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9598; val_auprc_score: 0.9955; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 2623.8327; train_edge_recon_loss: 40006.9334; train_cond_contrastive_loss: 3655.1017; train_gene_expr_recon_loss: 88981.8705; train_masked_gp_l1_reg_loss: 665.2479; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135932.9864; train_optim_loss: 135932.9864; val_kl_reg_loss: 2540.8302; val_edge_recon_loss: 41124.8620; val_cond_contrastive_loss: 3591.1557; val_gene_expr_recon_loss: 88939.1637; val_masked_gp_l1_reg_loss: 664.4689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136860.4795; val_optim_loss: 136860.4795

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9514; val_auprc_score: 0.9932; val_best_acc_score: 0.9787; val_best_f1_score: 0.9885; train_kl_reg_loss: 2634.2130; train_edge_recon_loss: 39832.6209; train_cond_contrastive_loss: 3648.4738; train_gene_expr_recon_loss: 88725.0366; train_masked_gp_l1_reg_loss: 722.0250; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135562.3694; train_optim_loss: 135562.3694; val_kl_reg_loss: 2570.3151; val_edge_recon_loss: 40796.2092; val_cond_contrastive_loss: 3565.2844; val_gene_expr_recon_loss: 88638.6742; val_masked_gp_l1_reg_loss: 721.8271; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136292.3112; val_optim_loss: 136292.3112
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9573; val_auprc_score: 0.9951; val_best_acc_score: 0.9765; val_best_f1_score: 0.9874; train_kl_reg_loss: 2616.6038; train_edge_recon_loss: 39885.6347; train_cond_contrastive_loss: 3661.2092; train_gene_expr_recon_loss: 88945.6260; train_masked_gp_l1_reg_loss: 664.4814; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135773.5551; train_optim_loss: 135773.5551; val_kl_reg_loss: 2575.4188; val_edge_recon_loss: 40959.0006; val_cond_contrastive_loss: 3585.9093; val_gene_expr_recon_loss: 88970.3762; val_masked_gp_l1_reg_loss: 664.7828; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136755.4868; val_optim_loss: 136755.4868
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9510; val_auprc_score: 0.9931; val_best_acc_score: 0.9790; val_best_f1_score: 0.9887; train_kl_reg_loss: 2631.3596; train_edge_recon_loss: 39866.6853; train_cond_contrastive_loss: 3649.9853; train_gene_expr_recon_loss: 88724.0220; train_masked_gp_l1_reg_loss: 721.5863; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135593.6383; train_optim_loss: 135593.6383; val_kl_reg_loss: 2597.3946; val_edge_recon_loss: 40686.2559; val_cond_contrastive_loss: 3566.3073; val_gene_expr_recon_loss: 88598.4653; val_masked_gp_l1_reg_loss: 721.6283; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136170.0487; val_optim_loss: 136170.0487
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9575; val_auprc_score: 0.9951; val_best_acc_score: 0.9770; val_best_f1_score: 0.9876; train_kl_reg_loss: 2620.2226; train_edge_recon_loss: 39884.6910; train_cond_contrastive_loss: 3655.8514; train_gene_expr_recon_loss: 88947.8065; train_masked_gp_l1_reg_loss: 664.8463; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135773.4181; train_optim_loss: 135773.4181; val_kl_reg_loss: 2571.5216; val_edge_recon_loss: 40836.3981; val_cond_contrastive_loss: 3583.3212; val_gene_expr_recon_loss: 89014.7456; val_masked_gp_l1_reg_loss: 665.1121; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136671.0940; val_optim_loss: 136671.0940
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9481; val_auprc_score: 0.9923; val_best_acc_score: 0.9783; val_best_f1_score: 0.9883; train_kl_reg_loss: 2633.7199; train_edge_recon_loss: 40024.2227; train_cond_contrastive_loss: 3650.5090; train_gene_expr_recon_loss: 88707.4919; train_masked_gp_l1_reg_loss: 721.7686; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135737.7119; train_optim_loss: 135737.7119; val_kl_reg_loss: 2581.5579; val_edge_recon_loss: 41275.1239; val_cond_contrastive_loss: 3563.9744; val_gene_expr_recon_loss: 88666.9575; val_masked_gp_l1_reg_loss: 721.9300; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136809.5510; val_optim_loss: 136809.5510
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9770; val_auprc_score: 0.9975; val_best_acc_score: 0.9835; val_best_f1_score: 0.9911; train_kl_reg_loss: 2511.8142; train_edge_recon_loss: 39921.6819; train_cond_contrastive_loss: 3617.8339; train_gene_expr_recon_loss: 93031.2722; train_masked_gp_l1_reg_loss: 570.9457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139653.5481; train_optim_loss: 139653.5481; val_kl_reg_loss: 2504.2003; val_edge_recon_loss: 39877.8825; val_cond_contrastive_loss: 3523.5995; val_gene_expr_recon_loss: 92742.0567; val_masked_gp_l1_reg_loss: 574.9960; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139222.7391; val_optim_loss: 139222.7391
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9507; val_auprc_score: 0.9932; val_best_acc_score: 0.9784; val_best_f1_score: 0.9884; train_kl_reg_loss: 2630.8436; train_edge_recon_loss: 39934.9380; train_cond_contrastive_loss: 3648.4084; train_gene_expr_recon_loss: 88694.8591; train_masked_gp_l1_reg_loss: 722.0682; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135631.1170; train_optim_loss: 135631.1170; val_kl_reg_loss: 2575.2599; val_edge_recon_loss: 41244.2723; val_cond_contrastive_loss: 3576.8987; val_gene_expr_recon_loss: 88659.0818; val_masked_gp_l1_reg_loss: 722.2668; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136777.7778; val_optim_loss: 136777.7778
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9522; val_auprc_score: 0.9933; val_best_acc_score: 0.9793; val_best_f1_score: 0.9889; train_kl_reg_loss: 2628.1266; train_edge_recon_loss: 39913.3939; train_cond_contrastive_loss: 3652.2580; train_gene_expr_recon_loss: 88673.8480; train_masked_gp_l1_reg_loss: 722.5939; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135590.2206; train_optim_loss: 135590.2206; val_kl_reg_loss: 2579.9985; val_edge_recon_loss: 40462.0337; val_cond_contrastive_loss: 3570.0593; val_gene_expr_recon_loss: 88595.2408; val_masked_gp_l1_reg_loss: 723.0128; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135930.3477; val_optim_loss: 135930.3477
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9505; val_auprc_score: 0.9929; val_best_acc_score: 0.9788; val_best_f1_score: 0.9886; train_kl_reg_loss: 2630.3928; train_edge_recon_loss: 39927.3742; train_cond_contrastive_loss: 3645.9347; train_gene_expr_recon_loss: 88670.0261; train_masked_gp_l1_reg_loss: 723.4443; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135597.1721; train_optim_loss: 135597.1721; val_kl_reg_loss: 2575.6053; val_edge_recon_loss: 40820.2667; val_cond_contrastive_loss: 3568.3548; val_gene_expr_recon_loss: 88573.6825; val_masked_gp_l1_reg_loss: 723.8988; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136261.8152; val_optim_loss: 136261.8152
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9519; val_auprc_score: 0.9930; val_best_acc_score: 0.9793; val_best_f1_score: 0.9889; train_kl_reg_loss: 2633.0689; train_edge_recon_loss: 40097.0067; train_cond_contrastive_loss: 3646.7045; train_gene_expr_recon_loss: 88645.2710; train_masked_gp_l1_reg_loss: 724.1840; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135746.2348; train_optim_loss: 135746.2348; val_kl_reg_loss: 2586.4416; val_edge_recon_loss: 40644.3109; val_cond_contrastive_loss: 3563.0179; val_gene_expr_recon_loss: 88605.0364; val_masked_gp_l1_reg_loss: 724.2421; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136123.0416; val_optim_loss: 136123.0416
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9513; val_auprc_score: 0.9931; val_best_acc_score: 0.9786; val_best_f1_score: 0.9885; train_kl_reg_loss: 2633.9909; train_edge_recon_loss: 40041.2248; train_cond_contrastive_loss: 3641.3994; train_gene_expr_recon_loss: 88662.5380; train_masked_gp_l1_reg_loss: 724.9378; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135704.0906; train_optim_loss: 135704.0906; val_kl_reg_loss: 2580.0425; val_edge_recon_loss: 41507.9868; val_cond_contrastive_loss: 3559.5036; val_gene_expr_recon_loss: 88607.1644; val_masked_gp_l1_reg_loss: 725.7048; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136980.3994; val_optim_loss: 136980.3994

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 108 min 5 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9589
Val AUPRC score: 0.9953
Val best accuracy score: 0.9763
Val best F1 score: 0.9872
Val gene expr MSE score: 0.7817

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9776; val_auprc_score: 0.9976; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2529.4783; train_edge_recon_loss: 39847.9970; train_cond_contrastive_loss: 3614.8825; train_gene_expr_recon_loss: 92737.2171; train_masked_gp_l1_reg_loss: 577.7367; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139307.3118; train_optim_loss: 139307.3118; val_kl_reg_loss: 2433.7353; val_edge_recon_loss: 39895.5606; val_cond_contrastive_loss: 3532.8471; val_gene_expr_recon_loss: 92532.5986; val_masked_gp_l1_reg_loss: 580.2807; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138975.0225; val_optim_loss: 138975.0225

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9525; val_auprc_score: 0.9933; val_best_acc_score: 0.9792; val_best_f1_score: 0.9888; train_kl_reg_loss: 2623.7512; train_edge_recon_loss: 39955.3413; train_cond_contrastive_loss: 3643.5129; train_gene_expr_recon_loss: 88611.8394; train_masked_gp_l1_reg_loss: 724.7059; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135559.1499; train_optim_loss: 135559.1499; val_kl_reg_loss: 2566.3183; val_edge_recon_loss: 40547.0864; val_cond_contrastive_loss: 3565.4245; val_gene_expr_recon_loss: 88599.9446; val_masked_gp_l1_reg_loss: 724.6742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136003.4458; val_optim_loss: 136003.4458
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9534; val_auprc_score: 0.9938; val_best_acc_score: 0.9776; val_best_f1_score: 0.9880; train_kl_reg_loss: 2519.2923; train_edge_recon_loss: 40021.2279; train_cond_contrastive_loss: 3894.0158; train_gene_expr_recon_loss: 88580.7115; train_masked_gp_l1_reg_loss: 724.6110; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135739.8589; train_optim_loss: 135739.8589; val_kl_reg_loss: 2063.6683; val_edge_recon_loss: 41400.0261; val_cond_contrastive_loss: 3791.2436; val_gene_expr_recon_loss: 88594.4419; val_masked_gp_l1_reg_loss: 724.4662; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136573.8489; val_optim_loss: 136573.8489
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9516; val_auprc_score: 0.9934; val_best_acc_score: 0.9776; val_best_f1_score: 0.9880; train_kl_reg_loss: 2470.8315; train_edge_recon_loss: 40059.4794; train_cond_contrastive_loss: 3838.0679; train_gene_expr_recon_loss: 88600.1161; train_masked_gp_l1_reg_loss: 724.2779; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135692.7731; train_optim_loss: 135692.7731; val_kl_reg_loss: 2065.2993; val_edge_recon_loss: 41517.4631; val_cond_contrastive_loss: 3759.5901; val_gene_expr_recon_loss: 88585.4973; val_masked_gp_l1_reg_loss: 724.1181; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136651.9752; val_optim_loss: 136651.9752
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9761; val_auprc_score: 0.9975; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2546.8859; train_edge_recon_loss: 39810.2855; train_cond_contrastive_loss: 3611.7539; train_gene_expr_recon_loss: 92493.0764; train_masked_gp_l1_reg_loss: 581.5992; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139043.6008; train_optim_loss: 139043.6008; val_kl_reg_loss: 2531.2551; val_edge_recon_loss: 40186.3306; val_cond_contrastive_loss: 3517.3404; val_gene_expr_recon_loss: 92310.9477; val_masked_gp_l1_reg_loss: 585.1678; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139131.0467; val_optim_loss: 139131.0467
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9843; val_best_f1_score: 0.9915; train_kl_reg_loss: 2562.4993; train_edge_recon_loss: 39781.6852; train_cond_contrastive_loss: 3606.9330; train_gene_expr_recon_loss: 92333.2664; train_masked_gp_l1_reg_loss: 584.3214; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138868.7052; train_optim_loss: 138868.7052; val_kl_reg_loss: 2529.7005; val_edge_recon_loss: 39244.2628; val_cond_contrastive_loss: 3516.0682; val_gene_expr_recon_loss: 92145.3730; val_masked_gp_l1_reg_loss: 585.6403; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138021.0447; val_optim_loss: 138021.0447

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 155 min 16 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9569
Val AUPRC score: 0.9944
Val best accuracy score: 0.9787
Val best F1 score: 0.9886
Val gene expr MSE score: 0.7972

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9776; val_auprc_score: 0.9976; val_best_acc_score: 0.9838; val_best_f1_score: 0.9913; train_kl_reg_loss: 2573.2356; train_edge_recon_loss: 39721.4386; train_cond_contrastive_loss: 3604.4439; train_gene_expr_recon_loss: 92201.8062; train_masked_gp_l1_reg_loss: 586.7030; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138687.6271; train_optim_loss: 138687.6271; val_kl_reg_loss: 2537.1440; val_edge_recon_loss: 39799.5299; val_cond_contrastive_loss: 3538.6353; val_gene_expr_recon_loss: 91942.6587; val_masked_gp_l1_reg_loss: 586.5383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138404.4986; val_optim_loss: 138404.4986
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9781; val_auprc_score: 0.9977; val_best_acc_score: 0.9848; val_best_f1_score: 0.9918; train_kl_reg_loss: 2582.7880; train_edge_recon_loss: 39896.7761; train_cond_contrastive_loss: 3603.0781; train_gene_expr_recon_loss: 92069.1079; train_masked_gp_l1_reg_loss: 589.1844; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138740.9345; train_optim_loss: 138740.9345; val_kl_reg_loss: 2548.2510; val_edge_recon_loss: 39627.5644; val_cond_contrastive_loss: 3528.7754; val_gene_expr_recon_loss: 91919.7840; val_masked_gp_l1_reg_loss: 591.0512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138215.4214; val_optim_loss: 138215.4214
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9847; val_best_f1_score: 0.9918; train_kl_reg_loss: 2587.2541; train_edge_recon_loss: 39632.3209; train_cond_contrastive_loss: 3598.8795; train_gene_expr_recon_loss: 92015.0175; train_masked_gp_l1_reg_loss: 592.2806; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138425.7526; train_optim_loss: 138425.7526; val_kl_reg_loss: 2533.3562; val_edge_recon_loss: 39438.1415; val_cond_contrastive_loss: 3500.8361; val_gene_expr_recon_loss: 91963.3647; val_masked_gp_l1_reg_loss: 593.1593; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138028.8545; val_optim_loss: 138028.8545

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9779; val_auprc_score: 0.9977; val_best_acc_score: 0.9847; val_best_f1_score: 0.9918; train_kl_reg_loss: 2565.0914; train_edge_recon_loss: 39756.5556; train_cond_contrastive_loss: 3600.9271; train_gene_expr_recon_loss: 91777.8902; train_masked_gp_l1_reg_loss: 580.5111; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138280.9752; train_optim_loss: 138280.9752; val_kl_reg_loss: 2516.8198; val_edge_recon_loss: 39695.2880; val_cond_contrastive_loss: 3529.4455; val_gene_expr_recon_loss: 91683.6899; val_masked_gp_l1_reg_loss: 580.2382; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138005.4770; val_optim_loss: 138005.4770
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9788; val_auprc_score: 0.9978; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2563.7477; train_edge_recon_loss: 39590.4088; train_cond_contrastive_loss: 3603.1568; train_gene_expr_recon_loss: 91735.1969; train_masked_gp_l1_reg_loss: 580.5469; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138073.0575; train_optim_loss: 138073.0575; val_kl_reg_loss: 2521.2231; val_edge_recon_loss: 39604.6665; val_cond_contrastive_loss: 3530.4322; val_gene_expr_recon_loss: 91681.3219; val_masked_gp_l1_reg_loss: 580.6516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137918.2999; val_optim_loss: 137918.2999
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9788; val_auprc_score: 0.9978; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2565.2431; train_edge_recon_loss: 39678.9023; train_cond_contrastive_loss: 3602.0705; train_gene_expr_recon_loss: 91750.9968; train_masked_gp_l1_reg_loss: 581.0783; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138178.2914; train_optim_loss: 138178.2914; val_kl_reg_loss: 2500.9907; val_edge_recon_loss: 39352.1886; val_cond_contrastive_loss: 3521.6626; val_gene_expr_recon_loss: 91657.8678; val_masked_gp_l1_reg_loss: 581.4019; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137614.1155; val_optim_loss: 137614.1155
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9790; val_auprc_score: 0.9978; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2565.7435; train_edge_recon_loss: 39623.2069; train_cond_contrastive_loss: 3601.9508; train_gene_expr_recon_loss: 91697.6053; train_masked_gp_l1_reg_loss: 582.1155; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138070.6219; train_optim_loss: 138070.6219; val_kl_reg_loss: 2504.9303; val_edge_recon_loss: 39850.4165; val_cond_contrastive_loss: 3520.3974; val_gene_expr_recon_loss: 91645.9642; val_masked_gp_l1_reg_loss: 582.7982; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138104.5046; val_optim_loss: 138104.5046
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9789; val_auprc_score: 0.9978; val_best_acc_score: 0.9850; val_best_f1_score: 0.9919; train_kl_reg_loss: 2565.4613; train_edge_recon_loss: 39642.0391; train_cond_contrastive_loss: 3601.2360; train_gene_expr_recon_loss: 91704.2742; train_masked_gp_l1_reg_loss: 583.2249; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138096.2355; train_optim_loss: 138096.2355; val_kl_reg_loss: 2540.6157; val_edge_recon_loss: 39744.8569; val_cond_contrastive_loss: 3517.8974; val_gene_expr_recon_loss: 91598.9208; val_masked_gp_l1_reg_loss: 583.7050; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137985.9943; val_optim_loss: 137985.9943
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9793; val_auprc_score: 0.9978; val_best_acc_score: 0.9852; val_best_f1_score: 0.9920; train_kl_reg_loss: 2565.5527; train_edge_recon_loss: 39659.6696; train_cond_contrastive_loss: 3599.0330; train_gene_expr_recon_loss: 91685.5042; train_masked_gp_l1_reg_loss: 584.4061; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138094.1653; train_optim_loss: 138094.1653; val_kl_reg_loss: 2530.2298; val_edge_recon_loss: 39776.3642; val_cond_contrastive_loss: 3521.6845; val_gene_expr_recon_loss: 91653.4339; val_masked_gp_l1_reg_loss: 585.1696; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138066.8848; val_optim_loss: 138066.8848

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2563.8036; train_edge_recon_loss: 39644.4069; train_cond_contrastive_loss: 3598.7182; train_gene_expr_recon_loss: 91702.4165; train_masked_gp_l1_reg_loss: 583.7540; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138093.0986; train_optim_loss: 138093.0986; val_kl_reg_loss: 2526.1468; val_edge_recon_loss: 39696.9153; val_cond_contrastive_loss: 3522.7109; val_gene_expr_recon_loss: 91556.8940; val_masked_gp_l1_reg_loss: 583.7412; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137886.4017; val_optim_loss: 137886.4017
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9784; val_auprc_score: 0.9977; val_best_acc_score: 0.9851; val_best_f1_score: 0.9920; train_kl_reg_loss: 2563.8929; train_edge_recon_loss: 39675.8742; train_cond_contrastive_loss: 3597.5409; train_gene_expr_recon_loss: 91660.8071; train_masked_gp_l1_reg_loss: 583.7898; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138081.9042; train_optim_loss: 138081.9042; val_kl_reg_loss: 2532.0316; val_edge_recon_loss: 39778.3504; val_cond_contrastive_loss: 3518.2556; val_gene_expr_recon_loss: 91640.3981; val_masked_gp_l1_reg_loss: 583.8518; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138052.8957; val_optim_loss: 138052.8957
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9790; val_auprc_score: 0.9978; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2566.0132; train_edge_recon_loss: 39682.3556; train_cond_contrastive_loss: 3595.7136; train_gene_expr_recon_loss: 91655.8140; train_masked_gp_l1_reg_loss: 583.8974; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138083.7943; train_optim_loss: 138083.7943; val_kl_reg_loss: 2520.0692; val_edge_recon_loss: 39931.8290; val_cond_contrastive_loss: 3518.7956; val_gene_expr_recon_loss: 91618.3540; val_masked_gp_l1_reg_loss: 583.9473; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138173.0010; val_optim_loss: 138173.0010

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 411 min 16 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9812
Val AUPRC score: 0.9981
Val best accuracy score: 0.9842
Val best F1 score: 0.9915
Val gene expr MSE score: 0.7678

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
