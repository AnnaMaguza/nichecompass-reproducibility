[True]
Run timestamp: 07092023_063727_286.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_286']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1123 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5626, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6083; val_auprc_score: 0.6047; val_best_acc_score: 0.5008; val_best_f1_score: 0.6667; train_kl_reg_loss: 67483.9949; train_edge_recon_loss: 3571761.3939; train_gene_expr_recon_loss: 16726873.6667; train_masked_gp_l1_reg_loss: 47322.4308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9929204.0758; train_chrom_access_recon_loss: 6356106.0076; train_global_loss: 36698751.6667; train_optim_loss: 36698751.6667; val_kl_reg_loss: 53982.2798; val_edge_recon_loss: 4065331.4375; val_gene_expr_recon_loss: 15383187.2500; val_masked_gp_l1_reg_loss: 45158.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3502901.7500; val_chrom_access_recon_loss: 6063960.4375; val_global_loss: 29114521.5000; val_optim_loss: 29114521.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6565; val_auprc_score: 0.6427; val_best_acc_score: 0.5277; val_best_f1_score: 0.6760; train_kl_reg_loss: 112811.2537; train_edge_recon_loss: 3545758.7879; train_gene_expr_recon_loss: 14984855.4394; train_masked_gp_l1_reg_loss: 42735.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1292694.0772; train_chrom_access_recon_loss: 6045187.1818; train_global_loss: 26024042.2121; train_optim_loss: 26024042.2121; val_kl_reg_loss: 116455.2256; val_edge_recon_loss: 4063699.6875; val_gene_expr_recon_loss: 14761358.7500; val_masked_gp_l1_reg_loss: 40699.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 432326.0312; val_chrom_access_recon_loss: 5993804.4375; val_global_loss: 25408344.2500; val_optim_loss: 25408344.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7109; val_auprc_score: 0.6891; val_best_acc_score: 0.5774; val_best_f1_score: 0.6956; train_kl_reg_loss: 116687.1586; train_edge_recon_loss: 3535441.4545; train_gene_expr_recon_loss: 14620980.9394; train_masked_gp_l1_reg_loss: 40329.3206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304325.4706; train_chrom_access_recon_loss: 5979471.3864; train_global_loss: 24597236.0000; train_optim_loss: 24597236.0000; val_kl_reg_loss: 126953.1309; val_edge_recon_loss: 4059873.1875; val_gene_expr_recon_loss: 14529584.2500; val_masked_gp_l1_reg_loss: 40241.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227960.5781; val_chrom_access_recon_loss: 5939326.8750; val_global_loss: 24923939.0000; val_optim_loss: 24923939.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7702; val_auprc_score: 0.7519; val_best_acc_score: 0.6913; val_best_f1_score: 0.7332; train_kl_reg_loss: 108394.0898; train_edge_recon_loss: 3528628.1742; train_gene_expr_recon_loss: 14479132.4394; train_masked_gp_l1_reg_loss: 40570.2033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200182.1470; train_chrom_access_recon_loss: 5928328.6061; train_global_loss: 24285235.7576; train_optim_loss: 24285235.7576; val_kl_reg_loss: 105493.6152; val_edge_recon_loss: 4043063.3750; val_gene_expr_recon_loss: 14301131.2500; val_masked_gp_l1_reg_loss: 41304.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180636.6406; val_chrom_access_recon_loss: 5857350.8750; val_global_loss: 24528979.0000; val_optim_loss: 24528979.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8245; val_auprc_score: 0.8048; val_best_acc_score: 0.7141; val_best_f1_score: 0.7424; train_kl_reg_loss: 97860.4015; train_edge_recon_loss: 3515333.7879; train_gene_expr_recon_loss: 14387783.9394; train_masked_gp_l1_reg_loss: 42267.4350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169936.8679; train_chrom_access_recon_loss: 5900385.7500; train_global_loss: 24113568.2727; train_optim_loss: 24113568.2727; val_kl_reg_loss: 100779.0723; val_edge_recon_loss: 3985562.8750; val_gene_expr_recon_loss: 14291421.6250; val_masked_gp_l1_reg_loss: 43426.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161820.0000; val_chrom_access_recon_loss: 5879225.8125; val_global_loss: 24462234.7500; val_optim_loss: 24462234.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8563; val_auprc_score: 0.8272; val_best_acc_score: 0.7765; val_best_f1_score: 0.7995; train_kl_reg_loss: 83954.2863; train_edge_recon_loss: 3463671.4091; train_gene_expr_recon_loss: 14294393.1515; train_masked_gp_l1_reg_loss: 44560.2685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155957.1084; train_chrom_access_recon_loss: 5863238.6288; train_global_loss: 23905774.6970; train_optim_loss: 23905774.6970; val_kl_reg_loss: 70027.3779; val_edge_recon_loss: 3461704.7812; val_gene_expr_recon_loss: 14251827.5000; val_masked_gp_l1_reg_loss: 45827.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151714.6562; val_chrom_access_recon_loss: 5832690.8750; val_global_loss: 23813792.2500; val_optim_loss: 23813792.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8607; val_auprc_score: 0.8203; val_best_acc_score: 0.7770; val_best_f1_score: 0.8043; train_kl_reg_loss: 103849.3304; train_edge_recon_loss: 3062176.2386; train_gene_expr_recon_loss: 14253485.6515; train_masked_gp_l1_reg_loss: 47236.6346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147899.7801; train_chrom_access_recon_loss: 5843132.7727; train_global_loss: 23457780.6970; train_optim_loss: 23457780.6970; val_kl_reg_loss: 117004.8818; val_edge_recon_loss: 2923291.3438; val_gene_expr_recon_loss: 14166774.6250; val_masked_gp_l1_reg_loss: 48496.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144500.4844; val_chrom_access_recon_loss: 5792917.0000; val_global_loss: 23192983.5000; val_optim_loss: 23192983.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8662; val_auprc_score: 0.8346; val_best_acc_score: 0.7915; val_best_f1_score: 0.8026; train_kl_reg_loss: 120351.6572; train_edge_recon_loss: 2957427.3712; train_gene_expr_recon_loss: 14160344.1970; train_masked_gp_l1_reg_loss: 49396.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140475.6465; train_chrom_access_recon_loss: 5804419.9242; train_global_loss: 23232415.8182; train_optim_loss: 23232415.8182; val_kl_reg_loss: 120616.8008; val_edge_recon_loss: 2957989.8750; val_gene_expr_recon_loss: 14121190.2500; val_masked_gp_l1_reg_loss: 50365.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137787.8281; val_chrom_access_recon_loss: 5811714.3750; val_global_loss: 23199665.2500; val_optim_loss: 23199665.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8805; val_auprc_score: 0.8511; val_best_acc_score: 0.8012; val_best_f1_score: 0.8181; train_kl_reg_loss: 118326.9035; train_edge_recon_loss: 2907073.6174; train_gene_expr_recon_loss: 14099460.1818; train_masked_gp_l1_reg_loss: 51266.6712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135829.5277; train_chrom_access_recon_loss: 5772097.1136; train_global_loss: 23084054.0303; train_optim_loss: 23084054.0303; val_kl_reg_loss: 115461.1338; val_edge_recon_loss: 2929392.2500; val_gene_expr_recon_loss: 14015797.3750; val_masked_gp_l1_reg_loss: 52227.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134023.8594; val_chrom_access_recon_loss: 5793688.0000; val_global_loss: 23040590.5000; val_optim_loss: 23040590.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8799; val_auprc_score: 0.8337; val_best_acc_score: 0.8146; val_best_f1_score: 0.8333; train_kl_reg_loss: 112617.5309; train_edge_recon_loss: 2910318.7727; train_gene_expr_recon_loss: 14051060.1818; train_masked_gp_l1_reg_loss: 53017.2333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132561.6181; train_chrom_access_recon_loss: 5752481.3409; train_global_loss: 23012057.0303; train_optim_loss: 23012057.0303; val_kl_reg_loss: 111298.2207; val_edge_recon_loss: 2878816.8438; val_gene_expr_recon_loss: 13996716.7500; val_masked_gp_l1_reg_loss: 53936.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131435.7656; val_chrom_access_recon_loss: 5728551.4375; val_global_loss: 22900756.0000; val_optim_loss: 22900756.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8962; val_auprc_score: 0.8657; val_best_acc_score: 0.8329; val_best_f1_score: 0.8516; train_kl_reg_loss: 113391.9804; train_edge_recon_loss: 2860470.8826; train_gene_expr_recon_loss: 13994204.1061; train_masked_gp_l1_reg_loss: 54603.8817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130746.2835; train_chrom_access_recon_loss: 5726260.5000; train_global_loss: 22879677.5758; train_optim_loss: 22879677.5758; val_kl_reg_loss: 111400.1914; val_edge_recon_loss: 2881360.1250; val_gene_expr_recon_loss: 13829673.3750; val_masked_gp_l1_reg_loss: 55386.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130577.3281; val_chrom_access_recon_loss: 5647507.4375; val_global_loss: 22655905.0000; val_optim_loss: 22655905.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8919; val_auprc_score: 0.8564; val_best_acc_score: 0.8246; val_best_f1_score: 0.8437; train_kl_reg_loss: 113170.4728; train_edge_recon_loss: 2868743.3636; train_gene_expr_recon_loss: 13954856.7879; train_masked_gp_l1_reg_loss: 56079.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129623.7599; train_chrom_access_recon_loss: 5711754.8636; train_global_loss: 22834228.7576; train_optim_loss: 22834228.7576; val_kl_reg_loss: 111925.4863; val_edge_recon_loss: 2892057.6875; val_gene_expr_recon_loss: 13887927.2500; val_masked_gp_l1_reg_loss: 56843.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129731.6094; val_chrom_access_recon_loss: 5629421.1875; val_global_loss: 22707908.0000; val_optim_loss: 22707908.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9150; val_auprc_score: 0.8863; val_best_acc_score: 0.8498; val_best_f1_score: 0.8575; train_kl_reg_loss: 114659.0840; train_edge_recon_loss: 2840342.9621; train_gene_expr_recon_loss: 13899973.5758; train_masked_gp_l1_reg_loss: 57467.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129897.7878; train_chrom_access_recon_loss: 5686207.3864; train_global_loss: 22728548.1818; train_optim_loss: 22728548.1818; val_kl_reg_loss: 112217.3545; val_edge_recon_loss: 2850890.3438; val_gene_expr_recon_loss: 13855831.3750; val_masked_gp_l1_reg_loss: 58065.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130287.5547; val_chrom_access_recon_loss: 5652597.6875; val_global_loss: 22659890.7500; val_optim_loss: 22659890.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9102; val_auprc_score: 0.8819; val_best_acc_score: 0.8474; val_best_f1_score: 0.8566; train_kl_reg_loss: 113008.8977; train_edge_recon_loss: 2819952.2917; train_gene_expr_recon_loss: 13862932.3030; train_masked_gp_l1_reg_loss: 58627.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130521.4795; train_chrom_access_recon_loss: 5666218.5530; train_global_loss: 22651261.4848; train_optim_loss: 22651261.4848; val_kl_reg_loss: 110802.9932; val_edge_recon_loss: 2860422.7188; val_gene_expr_recon_loss: 13876575.3750; val_masked_gp_l1_reg_loss: 59311.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131332.8906; val_chrom_access_recon_loss: 5635495.9375; val_global_loss: 22673941.2500; val_optim_loss: 22673941.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9133; val_auprc_score: 0.8804; val_best_acc_score: 0.8530; val_best_f1_score: 0.8631; train_kl_reg_loss: 110031.5375; train_edge_recon_loss: 2816609.0606; train_gene_expr_recon_loss: 13817017.1515; train_masked_gp_l1_reg_loss: 59854.6963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131603.0032; train_chrom_access_recon_loss: 5648848.0152; train_global_loss: 22583963.4545; train_optim_loss: 22583963.4545; val_kl_reg_loss: 110270.1377; val_edge_recon_loss: 2830137.6875; val_gene_expr_recon_loss: 13867495.5000; val_masked_gp_l1_reg_loss: 60494.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131837.0156; val_chrom_access_recon_loss: 5627902.8125; val_global_loss: 22628137.5000; val_optim_loss: 22628137.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9206; val_auprc_score: 0.8946; val_best_acc_score: 0.8641; val_best_f1_score: 0.8742; train_kl_reg_loss: 108592.3714; train_edge_recon_loss: 2807395.9545; train_gene_expr_recon_loss: 13770401.0000; train_masked_gp_l1_reg_loss: 60877.5766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132149.5488; train_chrom_access_recon_loss: 5630231.2652; train_global_loss: 22509647.8788; train_optim_loss: 22509647.8788; val_kl_reg_loss: 105038.6367; val_edge_recon_loss: 2821578.5625; val_gene_expr_recon_loss: 13724712.8750; val_masked_gp_l1_reg_loss: 61523.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132841.0469; val_chrom_access_recon_loss: 5588010.3750; val_global_loss: 22433706.2500; val_optim_loss: 22433706.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9182; val_auprc_score: 0.8900; val_best_acc_score: 0.8598; val_best_f1_score: 0.8729; train_kl_reg_loss: 108127.3625; train_edge_recon_loss: 2795083.3106; train_gene_expr_recon_loss: 13731127.2424; train_masked_gp_l1_reg_loss: 61925.8679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132963.4995; train_chrom_access_recon_loss: 5611410.2348; train_global_loss: 22440637.5152; train_optim_loss: 22440637.5152; val_kl_reg_loss: 107766.1943; val_edge_recon_loss: 2843649.4062; val_gene_expr_recon_loss: 13762883.5000; val_masked_gp_l1_reg_loss: 62460.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133269.6250; val_chrom_access_recon_loss: 5631123.8125; val_global_loss: 22541152.7500; val_optim_loss: 22541152.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9332; val_auprc_score: 0.9153; val_best_acc_score: 0.8686; val_best_f1_score: 0.8784; train_kl_reg_loss: 106308.0824; train_edge_recon_loss: 2794019.0417; train_gene_expr_recon_loss: 13703411.6818; train_masked_gp_l1_reg_loss: 62876.0798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133245.5909; train_chrom_access_recon_loss: 5596459.6364; train_global_loss: 22396320.1212; train_optim_loss: 22396320.1212; val_kl_reg_loss: 106843.4004; val_edge_recon_loss: 2791044.5312; val_gene_expr_recon_loss: 13727743.6250; val_masked_gp_l1_reg_loss: 63390.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133837.5000; val_chrom_access_recon_loss: 5568957.3750; val_global_loss: 22391817.5000; val_optim_loss: 22391817.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9234; val_auprc_score: 0.8967; val_best_acc_score: 0.8632; val_best_f1_score: 0.8726; train_kl_reg_loss: 105017.5645; train_edge_recon_loss: 2776040.1818; train_gene_expr_recon_loss: 13664701.2727; train_masked_gp_l1_reg_loss: 63790.7093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133841.4704; train_chrom_access_recon_loss: 5581162.5530; train_global_loss: 22324553.8788; train_optim_loss: 22324553.8788; val_kl_reg_loss: 104989.9424; val_edge_recon_loss: 2849288.2188; val_gene_expr_recon_loss: 13647347.1250; val_masked_gp_l1_reg_loss: 64247.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133929.5312; val_chrom_access_recon_loss: 5548070.1875; val_global_loss: 22347872.2500; val_optim_loss: 22347872.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9254; val_auprc_score: 0.8996; val_best_acc_score: 0.8708; val_best_f1_score: 0.8783; train_kl_reg_loss: 104898.6800; train_edge_recon_loss: 2775464.1591; train_gene_expr_recon_loss: 13640911.3485; train_masked_gp_l1_reg_loss: 64695.3597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134220.5547; train_chrom_access_recon_loss: 5567456.3333; train_global_loss: 22287646.4242; train_optim_loss: 22287646.4242; val_kl_reg_loss: 105855.4707; val_edge_recon_loss: 2827856.8750; val_gene_expr_recon_loss: 13725693.1250; val_masked_gp_l1_reg_loss: 65069.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133797.3906; val_chrom_access_recon_loss: 5586502.1250; val_global_loss: 22444774.2500; val_optim_loss: 22444774.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9260; val_auprc_score: 0.8976; val_best_acc_score: 0.8702; val_best_f1_score: 0.8790; train_kl_reg_loss: 105123.5916; train_edge_recon_loss: 2780595.4886; train_gene_expr_recon_loss: 13612808.7879; train_masked_gp_l1_reg_loss: 65398.8778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133731.5488; train_chrom_access_recon_loss: 5554731.9091; train_global_loss: 22252390.2121; train_optim_loss: 22252390.2121; val_kl_reg_loss: 104540.9268; val_edge_recon_loss: 2799429.4375; val_gene_expr_recon_loss: 13717574.8750; val_masked_gp_l1_reg_loss: 65732.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134125.2188; val_chrom_access_recon_loss: 5537201.1250; val_global_loss: 22358604.2500; val_optim_loss: 22358604.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9284; val_auprc_score: 0.9048; val_best_acc_score: 0.8735; val_best_f1_score: 0.8806; train_kl_reg_loss: 103702.8317; train_edge_recon_loss: 2761004.3674; train_gene_expr_recon_loss: 13582162.6667; train_masked_gp_l1_reg_loss: 66164.9177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134324.1738; train_chrom_access_recon_loss: 5538054.4091; train_global_loss: 22185413.3030; train_optim_loss: 22185413.3030; val_kl_reg_loss: 104618.0000; val_edge_recon_loss: 2793829.6250; val_gene_expr_recon_loss: 13562214.7500; val_masked_gp_l1_reg_loss: 66551.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133729.4062; val_chrom_access_recon_loss: 5588411.3750; val_global_loss: 22249355.0000; val_optim_loss: 22249355.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9340; val_auprc_score: 0.9128; val_best_acc_score: 0.8735; val_best_f1_score: 0.8807; train_kl_reg_loss: 103707.5588; train_edge_recon_loss: 2765770.0038; train_gene_expr_recon_loss: 13546943.9697; train_masked_gp_l1_reg_loss: 66868.2228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133772.4422; train_chrom_access_recon_loss: 5517686.0000; train_global_loss: 22134748.1515; train_optim_loss: 22134748.1515; val_kl_reg_loss: 106371.9707; val_edge_recon_loss: 2787011.0938; val_gene_expr_recon_loss: 13690007.1250; val_masked_gp_l1_reg_loss: 67336.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133772.3906; val_chrom_access_recon_loss: 5562860.5625; val_global_loss: 22347359.0000; val_optim_loss: 22347359.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9301; val_auprc_score: 0.9035; val_best_acc_score: 0.8702; val_best_f1_score: 0.8784; train_kl_reg_loss: 103912.1999; train_edge_recon_loss: 2744989.3750; train_gene_expr_recon_loss: 13517458.1061; train_masked_gp_l1_reg_loss: 67661.6577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134240.5445; train_chrom_access_recon_loss: 5508559.9318; train_global_loss: 22076821.6970; train_optim_loss: 22076821.6970; val_kl_reg_loss: 104249.3154; val_edge_recon_loss: 2813405.0312; val_gene_expr_recon_loss: 13494402.2500; val_masked_gp_l1_reg_loss: 68043.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134015.2969; val_chrom_access_recon_loss: 5513920.6875; val_global_loss: 22128035.5000; val_optim_loss: 22128035.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9377; val_auprc_score: 0.9094; val_best_acc_score: 0.8845; val_best_f1_score: 0.8912; train_kl_reg_loss: 103292.9821; train_edge_recon_loss: 2748596.1174; train_gene_expr_recon_loss: 13500611.7424; train_masked_gp_l1_reg_loss: 68279.1939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133889.6854; train_chrom_access_recon_loss: 5500712.3864; train_global_loss: 22055382.1818; train_optim_loss: 22055382.1818; val_kl_reg_loss: 104925.2852; val_edge_recon_loss: 2757373.8750; val_gene_expr_recon_loss: 13449666.5000; val_masked_gp_l1_reg_loss: 68577.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133829.5000; val_chrom_access_recon_loss: 5509482.4375; val_global_loss: 22023854.2500; val_optim_loss: 22023854.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9453; val_auprc_score: 0.9290; val_best_acc_score: 0.8880; val_best_f1_score: 0.8926; train_kl_reg_loss: 105015.2495; train_edge_recon_loss: 2776466.0644; train_gene_expr_recon_loss: 13272704.2273; train_masked_gp_l1_reg_loss: 68178.1630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135752.3700; train_chrom_access_recon_loss: 5452240.6136; train_global_loss: 21810356.7273; train_optim_loss: 21810356.7273; val_kl_reg_loss: 74007.4512; val_edge_recon_loss: 2798738.5000; val_gene_expr_recon_loss: 13277960.0000; val_masked_gp_l1_reg_loss: 67938.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135513.3750; val_chrom_access_recon_loss: 5451604.6250; val_global_loss: 21805761.5000; val_optim_loss: 21805761.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9443; val_auprc_score: 0.9236; val_best_acc_score: 0.8866; val_best_f1_score: 0.8925; train_kl_reg_loss: 108785.2932; train_edge_recon_loss: 2756830.8485; train_gene_expr_recon_loss: 13221190.9394; train_masked_gp_l1_reg_loss: 67993.2319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134343.0864; train_chrom_access_recon_loss: 5396054.8106; train_global_loss: 21685198.3636; train_optim_loss: 21685198.3636; val_kl_reg_loss: 75609.1641; val_edge_recon_loss: 2758610.0625; val_gene_expr_recon_loss: 13201364.0000; val_masked_gp_l1_reg_loss: 68080.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133563.5625; val_chrom_access_recon_loss: 5394667.6250; val_global_loss: 21631895.7500; val_optim_loss: 21631895.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9387; val_auprc_score: 0.9178; val_best_acc_score: 0.8866; val_best_f1_score: 0.8930; train_kl_reg_loss: 107251.2724; train_edge_recon_loss: 2749995.9015; train_gene_expr_recon_loss: 13165357.6061; train_masked_gp_l1_reg_loss: 68227.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132820.8568; train_chrom_access_recon_loss: 5376380.2348; train_global_loss: 21600033.2121; train_optim_loss: 21600033.2121; val_kl_reg_loss: 79133.4727; val_edge_recon_loss: 2775540.6250; val_gene_expr_recon_loss: 13169431.2500; val_masked_gp_l1_reg_loss: 68393.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132082.1719; val_chrom_access_recon_loss: 5390357.7500; val_global_loss: 21614939.0000; val_optim_loss: 21614939.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9509; val_auprc_score: 0.9356; val_best_acc_score: 0.8966; val_best_f1_score: 0.8999; train_kl_reg_loss: 102372.2135; train_edge_recon_loss: 2749252.3788; train_gene_expr_recon_loss: 13137102.8788; train_masked_gp_l1_reg_loss: 68561.1463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132259.1214; train_chrom_access_recon_loss: 5355023.1439; train_global_loss: 21544571.0909; train_optim_loss: 21544571.0909; val_kl_reg_loss: 80237.4834; val_edge_recon_loss: 2751357.6562; val_gene_expr_recon_loss: 13243676.8750; val_masked_gp_l1_reg_loss: 68730.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131366.0156; val_chrom_access_recon_loss: 5383375.2500; val_global_loss: 21658743.2500; val_optim_loss: 21658743.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9469; val_auprc_score: 0.9247; val_best_acc_score: 0.8933; val_best_f1_score: 0.8980; train_kl_reg_loss: 102438.1780; train_edge_recon_loss: 2738365.5341; train_gene_expr_recon_loss: 13100305.4242; train_masked_gp_l1_reg_loss: 68793.4657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131591.3603; train_chrom_access_recon_loss: 5341801.9470; train_global_loss: 21483295.9697; train_optim_loss: 21483295.9697; val_kl_reg_loss: 81857.7168; val_edge_recon_loss: 2748458.0312; val_gene_expr_recon_loss: 12938804.6250; val_masked_gp_l1_reg_loss: 68915.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131257.4844; val_chrom_access_recon_loss: 5279104.4375; val_global_loss: 21248397.5000; val_optim_loss: 21248397.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9510; val_auprc_score: 0.9333; val_best_acc_score: 0.8933; val_best_f1_score: 0.8993; train_kl_reg_loss: 98138.1044; train_edge_recon_loss: 2746129.8295; train_gene_expr_recon_loss: 13063649.1818; train_masked_gp_l1_reg_loss: 69024.0174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131238.9281; train_chrom_access_recon_loss: 5317760.7045; train_global_loss: 21425940.9697; train_optim_loss: 21425940.9697; val_kl_reg_loss: 81508.4971; val_edge_recon_loss: 2726162.5000; val_gene_expr_recon_loss: 12996863.3750; val_masked_gp_l1_reg_loss: 69160.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131307.7344; val_chrom_access_recon_loss: 5289804.2500; val_global_loss: 21294806.2500; val_optim_loss: 21294806.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9472; val_auprc_score: 0.9255; val_best_acc_score: 0.8923; val_best_f1_score: 0.8986; train_kl_reg_loss: 96324.6233; train_edge_recon_loss: 2734742.9053; train_gene_expr_recon_loss: 13025702.6364; train_masked_gp_l1_reg_loss: 69272.7673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131085.1261; train_chrom_access_recon_loss: 5311094.3409; train_global_loss: 21368222.3939; train_optim_loss: 21368222.3939; val_kl_reg_loss: 82975.6250; val_edge_recon_loss: 2756391.9375; val_gene_expr_recon_loss: 12955548.0000; val_masked_gp_l1_reg_loss: 69402.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131555.8438; val_chrom_access_recon_loss: 5310563.9375; val_global_loss: 21306438.5000; val_optim_loss: 21306438.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9513; val_auprc_score: 0.9265; val_best_acc_score: 0.9025; val_best_f1_score: 0.9074; train_kl_reg_loss: 97447.9238; train_edge_recon_loss: 2730991.0114; train_gene_expr_recon_loss: 12981587.1818; train_masked_gp_l1_reg_loss: 69472.8454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130501.8480; train_chrom_access_recon_loss: 5295750.1288; train_global_loss: 21305751.0000; train_optim_loss: 21305751.0000; val_kl_reg_loss: 83823.6982; val_edge_recon_loss: 2719282.5625; val_gene_expr_recon_loss: 12803307.7500; val_masked_gp_l1_reg_loss: 69557.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130798.3984; val_chrom_access_recon_loss: 5266736.4375; val_global_loss: 21073506.2500; val_optim_loss: 21073506.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9486; val_auprc_score: 0.9288; val_best_acc_score: 0.8995; val_best_f1_score: 0.9055; train_kl_reg_loss: 95336.5850; train_edge_recon_loss: 2735215.0530; train_gene_expr_recon_loss: 12951510.2727; train_masked_gp_l1_reg_loss: 69666.9229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130481.9812; train_chrom_access_recon_loss: 5290697.0833; train_global_loss: 21272907.7273; train_optim_loss: 21272907.7273; val_kl_reg_loss: 84504.4561; val_edge_recon_loss: 2766030.4375; val_gene_expr_recon_loss: 12951281.3750; val_masked_gp_l1_reg_loss: 69799.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130392.5000; val_chrom_access_recon_loss: 5304662.4375; val_global_loss: 21306670.5000; val_optim_loss: 21306670.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9529; val_auprc_score: 0.9353; val_best_acc_score: 0.9035; val_best_f1_score: 0.9081; train_kl_reg_loss: 93865.6394; train_edge_recon_loss: 2724245.7538; train_gene_expr_recon_loss: 12921038.9697; train_masked_gp_l1_reg_loss: 69876.5379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130258.5812; train_chrom_access_recon_loss: 5277239.2500; train_global_loss: 21216524.8182; train_optim_loss: 21216524.8182; val_kl_reg_loss: 83201.4521; val_edge_recon_loss: 2747428.4688; val_gene_expr_recon_loss: 12956380.2500; val_masked_gp_l1_reg_loss: 69974.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130147.1562; val_chrom_access_recon_loss: 5313342.8750; val_global_loss: 21300475.5000; val_optim_loss: 21300475.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9426; val_auprc_score: 0.9125; val_best_acc_score: 0.8966; val_best_f1_score: 0.9025; train_kl_reg_loss: 93895.3604; train_edge_recon_loss: 2716293.1742; train_gene_expr_recon_loss: 12893046.1515; train_masked_gp_l1_reg_loss: 70034.5088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129827.3807; train_chrom_access_recon_loss: 5269163.8864; train_global_loss: 21172260.6061; train_optim_loss: 21172260.6061; val_kl_reg_loss: 83446.1768; val_edge_recon_loss: 2764781.6250; val_gene_expr_recon_loss: 12924616.2500; val_masked_gp_l1_reg_loss: 70081.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129769.6406; val_chrom_access_recon_loss: 5212682.3750; val_global_loss: 21185377.7500; val_optim_loss: 21185377.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9533; val_auprc_score: 0.9352; val_best_acc_score: 0.9035; val_best_f1_score: 0.9074; train_kl_reg_loss: 91247.2266; train_edge_recon_loss: 2721403.2879; train_gene_expr_recon_loss: 12891497.5909; train_masked_gp_l1_reg_loss: 70209.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129608.4205; train_chrom_access_recon_loss: 5264245.4848; train_global_loss: 21168211.9697; train_optim_loss: 21168211.9697; val_kl_reg_loss: 80541.6924; val_edge_recon_loss: 2764934.4688; val_gene_expr_recon_loss: 12930374.7500; val_masked_gp_l1_reg_loss: 70277.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130196.7188; val_chrom_access_recon_loss: 5286753.6250; val_global_loss: 21263078.7500; val_optim_loss: 21263078.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9560; val_auprc_score: 0.9369; val_best_acc_score: 0.9068; val_best_f1_score: 0.9124; train_kl_reg_loss: 90609.0617; train_edge_recon_loss: 2715776.9735; train_gene_expr_recon_loss: 12874115.8788; train_masked_gp_l1_reg_loss: 69981.9616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98780.8907; train_chrom_access_recon_loss: 5261605.3864; train_global_loss: 21110870.2424; train_optim_loss: 21110870.2424; val_kl_reg_loss: 83802.4727; val_edge_recon_loss: 2712452.6562; val_gene_expr_recon_loss: 12956208.5000; val_masked_gp_l1_reg_loss: 69840.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92893.1172; val_chrom_access_recon_loss: 5317993.6250; val_global_loss: 21233190.7500; val_optim_loss: 21233190.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9556; val_auprc_score: 0.9413; val_best_acc_score: 0.9062; val_best_f1_score: 0.9109; train_kl_reg_loss: 92831.7533; train_edge_recon_loss: 2711470.7197; train_gene_expr_recon_loss: 12861460.5000; train_masked_gp_l1_reg_loss: 69797.8182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92469.3576; train_chrom_access_recon_loss: 5253863.3485; train_global_loss: 21081893.3333; train_optim_loss: 21081893.3333; val_kl_reg_loss: 83281.1406; val_edge_recon_loss: 2738537.1250; val_gene_expr_recon_loss: 12829593.0000; val_masked_gp_l1_reg_loss: 69761.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92200.1016; val_chrom_access_recon_loss: 5208358.7500; val_global_loss: 21021731.7500; val_optim_loss: 21021731.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9528; val_auprc_score: 0.9323; val_best_acc_score: 0.9022; val_best_f1_score: 0.9079; train_kl_reg_loss: 93250.4147; train_edge_recon_loss: 2717462.6098; train_gene_expr_recon_loss: 12850584.3333; train_masked_gp_l1_reg_loss: 69746.2685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91986.0862; train_chrom_access_recon_loss: 5247823.8485; train_global_loss: 21070853.6667; train_optim_loss: 21070853.6667; val_kl_reg_loss: 85471.5869; val_edge_recon_loss: 2746083.4375; val_gene_expr_recon_loss: 12789853.3750; val_masked_gp_l1_reg_loss: 69727.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91712.7500; val_chrom_access_recon_loss: 5302592.7500; val_global_loss: 21085440.7500; val_optim_loss: 21085440.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9544; val_auprc_score: 0.9339; val_best_acc_score: 0.9095; val_best_f1_score: 0.9136; train_kl_reg_loss: 93846.5676; train_edge_recon_loss: 2714009.0076; train_gene_expr_recon_loss: 12847419.2576; train_masked_gp_l1_reg_loss: 69722.4571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91622.5412; train_chrom_access_recon_loss: 5240584.3788; train_global_loss: 21057204.2121; train_optim_loss: 21057204.2121; val_kl_reg_loss: 84311.3428; val_edge_recon_loss: 2727529.3438; val_gene_expr_recon_loss: 12895984.3750; val_masked_gp_l1_reg_loss: 69710.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91399.1094; val_chrom_access_recon_loss: 5282084.4375; val_global_loss: 21151018.5000; val_optim_loss: 21151018.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9502; val_auprc_score: 0.9198; val_best_acc_score: 0.9105; val_best_f1_score: 0.9145; train_kl_reg_loss: 93054.4934; train_edge_recon_loss: 2712500.0455; train_gene_expr_recon_loss: 12843594.5000; train_masked_gp_l1_reg_loss: 69712.1518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91290.7170; train_chrom_access_recon_loss: 5241520.2348; train_global_loss: 21051672.2121; train_optim_loss: 21051672.2121; val_kl_reg_loss: 84582.6279; val_edge_recon_loss: 2724557.7812; val_gene_expr_recon_loss: 12835011.7500; val_masked_gp_l1_reg_loss: 69715.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91321.8516; val_chrom_access_recon_loss: 5222713.5625; val_global_loss: 21027903.0000; val_optim_loss: 21027903.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9537; val_auprc_score: 0.9368; val_best_acc_score: 0.9025; val_best_f1_score: 0.9070; train_kl_reg_loss: 93233.6525; train_edge_recon_loss: 2722475.7500; train_gene_expr_recon_loss: 12853981.2424; train_masked_gp_l1_reg_loss: 69716.0295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91101.7179; train_chrom_access_recon_loss: 5249558.6212; train_global_loss: 21080067.0606; train_optim_loss: 21080067.0606; val_kl_reg_loss: 86235.3594; val_edge_recon_loss: 2750687.3750; val_gene_expr_recon_loss: 12911693.7500; val_masked_gp_l1_reg_loss: 69714.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91006.5156; val_chrom_access_recon_loss: 5256562.3750; val_global_loss: 21165900.5000; val_optim_loss: 21165900.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9533; val_auprc_score: 0.9288; val_best_acc_score: 0.9078; val_best_f1_score: 0.9128; train_kl_reg_loss: 93792.9296; train_edge_recon_loss: 2710805.6780; train_gene_expr_recon_loss: 12839021.4242; train_masked_gp_l1_reg_loss: 69687.0626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87589.1481; train_chrom_access_recon_loss: 5243202.3864; train_global_loss: 21044098.6970; train_optim_loss: 21044098.6970; val_kl_reg_loss: 85632.4746; val_edge_recon_loss: 2732210.7188; val_gene_expr_recon_loss: 12890009.7500; val_masked_gp_l1_reg_loss: 69672.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86917.4219; val_chrom_access_recon_loss: 5300085.6875; val_global_loss: 21164528.2500; val_optim_loss: 21164528.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9576; val_auprc_score: 0.9389; val_best_acc_score: 0.9097; val_best_f1_score: 0.9138; train_kl_reg_loss: 93750.3364; train_edge_recon_loss: 2714038.6515; train_gene_expr_recon_loss: 12837003.5606; train_masked_gp_l1_reg_loss: 69666.3964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86859.5170; train_chrom_access_recon_loss: 5240661.1439; train_global_loss: 21041979.4242; train_optim_loss: 21041979.4242; val_kl_reg_loss: 85580.5830; val_edge_recon_loss: 2725653.8125; val_gene_expr_recon_loss: 12773984.7500; val_masked_gp_l1_reg_loss: 69660.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86824.3984; val_chrom_access_recon_loss: 5200124.0000; val_global_loss: 20941828.0000; val_optim_loss: 20941828.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9546; val_auprc_score: 0.9385; val_best_acc_score: 0.9070; val_best_f1_score: 0.9115; train_kl_reg_loss: 93635.9154; train_edge_recon_loss: 2706002.4470; train_gene_expr_recon_loss: 12833980.5909; train_masked_gp_l1_reg_loss: 69657.5505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86785.6777; train_chrom_access_recon_loss: 5239317.4015; train_global_loss: 21029379.6970; train_optim_loss: 21029379.6970; val_kl_reg_loss: 86041.9590; val_edge_recon_loss: 2749079.2812; val_gene_expr_recon_loss: 12880038.7500; val_masked_gp_l1_reg_loss: 69654.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86747.3047; val_chrom_access_recon_loss: 5246130.9375; val_global_loss: 21117692.0000; val_optim_loss: 21117692.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9547; val_auprc_score: 0.9332; val_best_acc_score: 0.9038; val_best_f1_score: 0.9086; train_kl_reg_loss: 93785.9126; train_edge_recon_loss: 2720256.1288; train_gene_expr_recon_loss: 12835358.6061; train_masked_gp_l1_reg_loss: 69652.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86737.3993; train_chrom_access_recon_loss: 5239037.1894; train_global_loss: 21044827.7879; train_optim_loss: 21044827.7879; val_kl_reg_loss: 85384.7568; val_edge_recon_loss: 2761232.2500; val_gene_expr_recon_loss: 12929413.6250; val_masked_gp_l1_reg_loss: 69649.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86717.4219; val_chrom_access_recon_loss: 5232115.6250; val_global_loss: 21164513.7500; val_optim_loss: 21164513.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9469; val_auprc_score: 0.9211; val_best_acc_score: 0.8992; val_best_f1_score: 0.9047; train_kl_reg_loss: 93783.5479; train_edge_recon_loss: 2703991.3258; train_gene_expr_recon_loss: 12857223.3636; train_masked_gp_l1_reg_loss: 69648.8963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86690.6361; train_chrom_access_recon_loss: 5247560.9621; train_global_loss: 21058898.8182; train_optim_loss: 21058898.8182; val_kl_reg_loss: 85602.4775; val_edge_recon_loss: 2746854.0938; val_gene_expr_recon_loss: 12859130.8750; val_masked_gp_l1_reg_loss: 69647.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86687.6641; val_chrom_access_recon_loss: 5247166.3750; val_global_loss: 21095089.0000; val_optim_loss: 21095089.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9488; val_auprc_score: 0.9256; val_best_acc_score: 0.9011; val_best_f1_score: 0.9063; train_kl_reg_loss: 93652.9433; train_edge_recon_loss: 2715358.3902; train_gene_expr_recon_loss: 12849018.4091; train_masked_gp_l1_reg_loss: 69647.0856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86661.7125; train_chrom_access_recon_loss: 5246583.8409; train_global_loss: 21060922.3333; train_optim_loss: 21060922.3333; val_kl_reg_loss: 85975.4844; val_edge_recon_loss: 2753747.4375; val_gene_expr_recon_loss: 12820112.0000; val_masked_gp_l1_reg_loss: 69646.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86643.3984; val_chrom_access_recon_loss: 5249253.3750; val_global_loss: 21065378.2500; val_optim_loss: 21065378.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9556; val_auprc_score: 0.9378; val_best_acc_score: 0.9062; val_best_f1_score: 0.9108; train_kl_reg_loss: 93684.7810; train_edge_recon_loss: 2721978.9508; train_gene_expr_recon_loss: 12844645.6061; train_masked_gp_l1_reg_loss: 69643.8301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86301.6262; train_chrom_access_recon_loss: 5241235.7955; train_global_loss: 21057490.6061; train_optim_loss: 21057490.6061; val_kl_reg_loss: 86133.5020; val_edge_recon_loss: 2736151.3750; val_gene_expr_recon_loss: 12886734.8750; val_masked_gp_l1_reg_loss: 69642.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86235.4766; val_chrom_access_recon_loss: 5284825.7500; val_global_loss: 21149722.7500; val_optim_loss: 21149722.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9586; val_auprc_score: 0.9435; val_best_acc_score: 0.9124; val_best_f1_score: 0.9162; train_kl_reg_loss: 93807.7597; train_edge_recon_loss: 2705398.8371; train_gene_expr_recon_loss: 12843255.1818; train_masked_gp_l1_reg_loss: 69641.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86228.3432; train_chrom_access_recon_loss: 5240681.7576; train_global_loss: 21039013.4242; train_optim_loss: 21039013.4242; val_kl_reg_loss: 85568.2871; val_edge_recon_loss: 2733781.0000; val_gene_expr_recon_loss: 12828596.8750; val_masked_gp_l1_reg_loss: 69641.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86225.0156; val_chrom_access_recon_loss: 5199099.7500; val_global_loss: 21002911.7500; val_optim_loss: 21002911.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9564; val_auprc_score: 0.9379; val_best_acc_score: 0.9103; val_best_f1_score: 0.9143; train_kl_reg_loss: 93710.0947; train_edge_recon_loss: 2700322.6061; train_gene_expr_recon_loss: 12844119.5758; train_masked_gp_l1_reg_loss: 69640.7000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86222.2085; train_chrom_access_recon_loss: 5242877.1515; train_global_loss: 21036892.4242; train_optim_loss: 21036892.4242; val_kl_reg_loss: 85938.1924; val_edge_recon_loss: 2736442.2812; val_gene_expr_recon_loss: 12944882.7500; val_masked_gp_l1_reg_loss: 69640.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86218.6094; val_chrom_access_recon_loss: 5275219.3750; val_global_loss: 21198341.5000; val_optim_loss: 21198341.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9573; val_auprc_score: 0.9429; val_best_acc_score: 0.9095; val_best_f1_score: 0.9136; train_kl_reg_loss: 93714.7157; train_edge_recon_loss: 2707369.5379; train_gene_expr_recon_loss: 12847950.0909; train_masked_gp_l1_reg_loss: 69640.0939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86217.7683; train_chrom_access_recon_loss: 5249514.4242; train_global_loss: 21054406.5758; train_optim_loss: 21054406.5758; val_kl_reg_loss: 85421.8809; val_edge_recon_loss: 2732539.6875; val_gene_expr_recon_loss: 12854733.2500; val_masked_gp_l1_reg_loss: 69639.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86214.8906; val_chrom_access_recon_loss: 5244213.6875; val_global_loss: 21072764.0000; val_optim_loss: 21072764.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 9 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9560
val AUPRC score: 0.9377
val best accuracy score: 0.9103
val best F1 score: 0.9149
val target rna MSE score: 0.9250
val source rna MSE score: 0.3259
val target atac MSE score: 0.4850
val source atac MSE score: 0.1070
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
