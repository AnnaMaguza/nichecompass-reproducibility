[True]
Run timestamp: 10082023_222422_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7062; val_auprc_score: 0.7429; val_best_acc_score: 0.5034; val_best_f1_score: 0.6679; train_kl_reg_loss: 199544.8197; train_edge_recon_loss: 3743263.4733; train_gene_expr_recon_loss: 46534670.9924; train_masked_gp_l1_reg_loss: 89369.4424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245299.3180; train_chrom_access_recon_loss: 4151355.1508; train_global_loss: 54963503.1756; train_optim_loss: 54963503.1756; val_kl_reg_loss: 78777.4172; val_edge_recon_loss: 4065293.6167; val_gene_expr_recon_loss: 39562221.8667; val_masked_gp_l1_reg_loss: 91920.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240341.5469; val_chrom_access_recon_loss: 3903330.5833; val_global_loss: 47941884.0000; val_optim_loss: 47941884.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7676; val_auprc_score: 0.7913; val_best_acc_score: 0.5158; val_best_f1_score: 0.6729; train_kl_reg_loss: 120588.3505; train_edge_recon_loss: 3698358.9447; train_gene_expr_recon_loss: 39146744.6412; train_masked_gp_l1_reg_loss: 91579.6454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234645.2034; train_chrom_access_recon_loss: 3885569.5553; train_global_loss: 47177486.1069; train_optim_loss: 47177486.1069; val_kl_reg_loss: 67140.3659; val_edge_recon_loss: 4063904.3833; val_gene_expr_recon_loss: 38210528.5333; val_masked_gp_l1_reg_loss: 99300.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229808.5469; val_chrom_access_recon_loss: 3862857.3500; val_global_loss: 46533537.8667; val_optim_loss: 46533537.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7552; val_auprc_score: 0.7719; val_best_acc_score: 0.6521; val_best_f1_score: 0.7136; train_kl_reg_loss: 147092.5989; train_edge_recon_loss: 3593896.0095; train_gene_expr_recon_loss: 37551657.5267; train_masked_gp_l1_reg_loss: 93300.8116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223107.8652; train_chrom_access_recon_loss: 3819837.3034; train_global_loss: 45428892.2443; train_optim_loss: 45428892.2443; val_kl_reg_loss: 135909.4734; val_edge_recon_loss: 4051492.2500; val_gene_expr_recon_loss: 36893022.6667; val_masked_gp_l1_reg_loss: 90347.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216226.8125; val_chrom_access_recon_loss: 3773795.5167; val_global_loss: 45160796.2667; val_optim_loss: 45160796.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7852; val_auprc_score: 0.7922; val_best_acc_score: 0.7040; val_best_f1_score: 0.7150; train_kl_reg_loss: 148839.3538; train_edge_recon_loss: 3546172.5515; train_gene_expr_recon_loss: 36888496.4580; train_masked_gp_l1_reg_loss: 89249.1022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209583.8075; train_chrom_access_recon_loss: 3784310.4237; train_global_loss: 44666651.7863; train_optim_loss: 44666651.7863; val_kl_reg_loss: 134667.8870; val_edge_recon_loss: 4013111.1167; val_gene_expr_recon_loss: 36660275.4667; val_masked_gp_l1_reg_loss: 88707.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203023.0781; val_chrom_access_recon_loss: 3788372.1000; val_global_loss: 44888158.9333; val_optim_loss: 44888158.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8409; val_auprc_score: 0.8424; val_best_acc_score: 0.7518; val_best_f1_score: 0.7669; train_kl_reg_loss: 134680.0921; train_edge_recon_loss: 3511430.2176; train_gene_expr_recon_loss: 36574698.4733; train_masked_gp_l1_reg_loss: 89308.5511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196845.6479; train_chrom_access_recon_loss: 3770981.4313; train_global_loss: 44277944.6412; train_optim_loss: 44277944.6412; val_kl_reg_loss: 131210.7188; val_edge_recon_loss: 3831089.8000; val_gene_expr_recon_loss: 36254058.9333; val_masked_gp_l1_reg_loss: 90642.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190722.6875; val_chrom_access_recon_loss: 3739262.1833; val_global_loss: 44236989.6000; val_optim_loss: 44236989.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8652; val_auprc_score: 0.8533; val_best_acc_score: 0.7789; val_best_f1_score: 0.8028; train_kl_reg_loss: 121028.6089; train_edge_recon_loss: 3404287.3302; train_gene_expr_recon_loss: 36311915.8168; train_masked_gp_l1_reg_loss: 91783.7287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185009.4734; train_chrom_access_recon_loss: 3749832.0954; train_global_loss: 43863857.2214; train_optim_loss: 43863857.2214; val_kl_reg_loss: 109520.6297; val_edge_recon_loss: 3400284.0333; val_gene_expr_recon_loss: 36099825.0667; val_masked_gp_l1_reg_loss: 93809.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179526.4219; val_chrom_access_recon_loss: 3733375.4167; val_global_loss: 43616340.8000; val_optim_loss: 43616340.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8723; val_auprc_score: 0.8568; val_best_acc_score: 0.7782; val_best_f1_score: 0.7995; train_kl_reg_loss: 138698.9810; train_edge_recon_loss: 3138009.7519; train_gene_expr_recon_loss: 36121835.4504; train_masked_gp_l1_reg_loss: 94744.8409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174440.0567; train_chrom_access_recon_loss: 3737785.2385; train_global_loss: 43405514.1374; train_optim_loss: 43405514.1374; val_kl_reg_loss: 148022.6187; val_edge_recon_loss: 3049833.6667; val_gene_expr_recon_loss: 35889102.6667; val_masked_gp_l1_reg_loss: 95889.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169622.0938; val_chrom_access_recon_loss: 3721214.0667; val_global_loss: 43073685.6000; val_optim_loss: 43073685.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8903; val_auprc_score: 0.8791; val_best_acc_score: 0.8085; val_best_f1_score: 0.8196; train_kl_reg_loss: 155247.6910; train_edge_recon_loss: 3026016.6221; train_gene_expr_recon_loss: 35927395.2977; train_masked_gp_l1_reg_loss: 96701.4152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165386.4934; train_chrom_access_recon_loss: 3721593.7939; train_global_loss: 43092341.3130; train_optim_loss: 43092341.3130; val_kl_reg_loss: 158456.6156; val_edge_recon_loss: 2990100.2667; val_gene_expr_recon_loss: 35783765.0667; val_masked_gp_l1_reg_loss: 97624.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161193.9219; val_chrom_access_recon_loss: 3717872.1000; val_global_loss: 42909009.8667; val_optim_loss: 42909009.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8991; val_auprc_score: 0.8846; val_best_acc_score: 0.8178; val_best_f1_score: 0.8258; train_kl_reg_loss: 155043.6333; train_edge_recon_loss: 2987375.7824; train_gene_expr_recon_loss: 35702576.0458; train_masked_gp_l1_reg_loss: 98397.2574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157232.7219; train_chrom_access_recon_loss: 3708290.9160; train_global_loss: 42808916.4885; train_optim_loss: 42808916.4885; val_kl_reg_loss: 150563.4635; val_edge_recon_loss: 2965253.8500; val_gene_expr_recon_loss: 35571487.2000; val_masked_gp_l1_reg_loss: 99361.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153385.0938; val_chrom_access_recon_loss: 3703776.8500; val_global_loss: 42643825.8667; val_optim_loss: 42643825.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9052; val_auprc_score: 0.8896; val_best_acc_score: 0.8251; val_best_f1_score: 0.8397; train_kl_reg_loss: 150479.5184; train_edge_recon_loss: 2943043.5076; train_gene_expr_recon_loss: 35570974.7328; train_masked_gp_l1_reg_loss: 100126.9424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149719.7486; train_chrom_access_recon_loss: 3703297.4542; train_global_loss: 42617642.0153; train_optim_loss: 42617642.0153; val_kl_reg_loss: 147622.8896; val_edge_recon_loss: 2941270.2667; val_gene_expr_recon_loss: 35374641.3333; val_masked_gp_l1_reg_loss: 101064.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146212.4062; val_chrom_access_recon_loss: 3689062.2833; val_global_loss: 42399872.2667; val_optim_loss: 42399872.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9145; val_auprc_score: 0.8973; val_best_acc_score: 0.8399; val_best_f1_score: 0.8536; train_kl_reg_loss: 147545.1467; train_edge_recon_loss: 2913718.9485; train_gene_expr_recon_loss: 35424659.6947; train_masked_gp_l1_reg_loss: 101892.9236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142760.6316; train_chrom_access_recon_loss: 3690378.6870; train_global_loss: 42420955.8168; train_optim_loss: 42420955.8168; val_kl_reg_loss: 146739.1833; val_edge_recon_loss: 2890561.0667; val_gene_expr_recon_loss: 35232650.9333; val_masked_gp_l1_reg_loss: 102830.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139422.7344; val_chrom_access_recon_loss: 3672851.9167; val_global_loss: 42185058.6667; val_optim_loss: 42185058.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9175; val_auprc_score: 0.9032; val_best_acc_score: 0.8414; val_best_f1_score: 0.8531; train_kl_reg_loss: 147102.7982; train_edge_recon_loss: 2888524.0153; train_gene_expr_recon_loss: 35249031.4962; train_masked_gp_l1_reg_loss: 103593.8451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136416.7440; train_chrom_access_recon_loss: 3675851.5095; train_global_loss: 42200520.3664; train_optim_loss: 42200520.3664; val_kl_reg_loss: 151468.6885; val_edge_recon_loss: 2869509.0500; val_gene_expr_recon_loss: 35049762.1333; val_masked_gp_l1_reg_loss: 104375.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133394.4219; val_chrom_access_recon_loss: 3658825.4667; val_global_loss: 41967337.6000; val_optim_loss: 41967337.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9310; val_auprc_score: 0.9184; val_best_acc_score: 0.8588; val_best_f1_score: 0.8678; train_kl_reg_loss: 147554.2791; train_edge_recon_loss: 2853215.8664; train_gene_expr_recon_loss: 35139396.6718; train_masked_gp_l1_reg_loss: 105147.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130728.2378; train_chrom_access_recon_loss: 3667569.7748; train_global_loss: 42043613.1603; train_optim_loss: 42043613.1603; val_kl_reg_loss: 145024.9031; val_edge_recon_loss: 2827190.7500; val_gene_expr_recon_loss: 35242776.0000; val_masked_gp_l1_reg_loss: 105907.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128004.3672; val_chrom_access_recon_loss: 3671437.2167; val_global_loss: 42120340.5333; val_optim_loss: 42120340.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9285; val_auprc_score: 0.9174; val_best_acc_score: 0.8519; val_best_f1_score: 0.8624; train_kl_reg_loss: 143967.1101; train_edge_recon_loss: 2854126.8817; train_gene_expr_recon_loss: 35060601.9237; train_masked_gp_l1_reg_loss: 106739.2661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125332.2054; train_chrom_access_recon_loss: 3664416.6260; train_global_loss: 41955184.0611; train_optim_loss: 41955184.0611; val_kl_reg_loss: 143619.5792; val_edge_recon_loss: 2884348.6000; val_gene_expr_recon_loss: 34907645.6000; val_masked_gp_l1_reg_loss: 107498.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122637.9375; val_chrom_access_recon_loss: 3659628.4500; val_global_loss: 41825378.6667; val_optim_loss: 41825378.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9323; val_auprc_score: 0.9195; val_best_acc_score: 0.8572; val_best_f1_score: 0.8644; train_kl_reg_loss: 139012.4652; train_edge_recon_loss: 2846812.3798; train_gene_expr_recon_loss: 34993526.7328; train_masked_gp_l1_reg_loss: 108313.8597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120073.2862; train_chrom_access_recon_loss: 3657778.5802; train_global_loss: 41865517.3435; train_optim_loss: 41865517.3435; val_kl_reg_loss: 135631.0990; val_edge_recon_loss: 2864234.2833; val_gene_expr_recon_loss: 34978691.2000; val_masked_gp_l1_reg_loss: 109151.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117478.6641; val_chrom_access_recon_loss: 3660337.2500; val_global_loss: 41865526.4000; val_optim_loss: 41865526.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9422; val_auprc_score: 0.9320; val_best_acc_score: 0.8733; val_best_f1_score: 0.8807; train_kl_reg_loss: 136668.5287; train_edge_recon_loss: 2837698.2882; train_gene_expr_recon_loss: 34895189.3130; train_masked_gp_l1_reg_loss: 110024.3027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115122.9637; train_chrom_access_recon_loss: 3649055.0782; train_global_loss: 41743758.5038; train_optim_loss: 41743758.5038; val_kl_reg_loss: 138779.0781; val_edge_recon_loss: 2835458.0333; val_gene_expr_recon_loss: 34763662.6667; val_masked_gp_l1_reg_loss: 110823.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112732.5469; val_chrom_access_recon_loss: 3645298.1667; val_global_loss: 41606753.6000; val_optim_loss: 41606753.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9399; val_auprc_score: 0.9290; val_best_acc_score: 0.8719; val_best_f1_score: 0.8784; train_kl_reg_loss: 134286.6385; train_edge_recon_loss: 2826040.6851; train_gene_expr_recon_loss: 34795939.3130; train_masked_gp_l1_reg_loss: 111511.5957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110513.8631; train_chrom_access_recon_loss: 3643632.8931; train_global_loss: 41621925.0076; train_optim_loss: 41621925.0076; val_kl_reg_loss: 137048.2333; val_edge_recon_loss: 2825890.6833; val_gene_expr_recon_loss: 34756160.2667; val_masked_gp_l1_reg_loss: 112443.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108332.6016; val_chrom_access_recon_loss: 3641912.9500; val_global_loss: 41581788.5333; val_optim_loss: 41581788.5333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9490; val_auprc_score: 0.9402; val_best_acc_score: 0.8810; val_best_f1_score: 0.8856; train_kl_reg_loss: 132902.9109; train_edge_recon_loss: 2817414.3092; train_gene_expr_recon_loss: 34736385.1756; train_masked_gp_l1_reg_loss: 113206.5847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106227.9594; train_chrom_access_recon_loss: 3640642.7500; train_global_loss: 41546779.6336; train_optim_loss: 41546779.6336; val_kl_reg_loss: 131395.0557; val_edge_recon_loss: 2813213.5333; val_gene_expr_recon_loss: 34527124.8000; val_masked_gp_l1_reg_loss: 113713.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104143.2969; val_chrom_access_recon_loss: 3635980.7500; val_global_loss: 41325569.8667; val_optim_loss: 41325569.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9455; val_auprc_score: 0.9362; val_best_acc_score: 0.8762; val_best_f1_score: 0.8819; train_kl_reg_loss: 130535.7641; train_edge_recon_loss: 2810546.9504; train_gene_expr_recon_loss: 34703205.4504; train_masked_gp_l1_reg_loss: 114639.8117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102166.8761; train_chrom_access_recon_loss: 3634164.6279; train_global_loss: 41495259.6031; train_optim_loss: 41495259.6031; val_kl_reg_loss: 126750.5182; val_edge_recon_loss: 2843339.8833; val_gene_expr_recon_loss: 34468308.0000; val_masked_gp_l1_reg_loss: 115417.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100243.0938; val_chrom_access_recon_loss: 3631720.0667; val_global_loss: 41285777.6000; val_optim_loss: 41285777.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9490; val_auprc_score: 0.9388; val_best_acc_score: 0.8816; val_best_f1_score: 0.8882; train_kl_reg_loss: 128520.0269; train_edge_recon_loss: 2799661.1317; train_gene_expr_recon_loss: 34623962.6870; train_masked_gp_l1_reg_loss: 116227.6310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98370.9955; train_chrom_access_recon_loss: 3632137.6641; train_global_loss: 41398880.0000; train_optim_loss: 41398880.0000; val_kl_reg_loss: 126484.4495; val_edge_recon_loss: 2811728.0167; val_gene_expr_recon_loss: 34546437.4667; val_masked_gp_l1_reg_loss: 117089.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96573.4141; val_chrom_access_recon_loss: 3620227.5500; val_global_loss: 41318538.4000; val_optim_loss: 41318538.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9556; val_auprc_score: 0.9466; val_best_acc_score: 0.8914; val_best_f1_score: 0.8949; train_kl_reg_loss: 125716.6411; train_edge_recon_loss: 2791378.2576; train_gene_expr_recon_loss: 34569498.4122; train_masked_gp_l1_reg_loss: 117857.9222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94895.7647; train_chrom_access_recon_loss: 3629810.4790; train_global_loss: 41329157.1908; train_optim_loss: 41329157.1908; val_kl_reg_loss: 126123.7677; val_edge_recon_loss: 2802353.4333; val_gene_expr_recon_loss: 34302393.2000; val_masked_gp_l1_reg_loss: 118702.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93187.1094; val_chrom_access_recon_loss: 3618949.3833; val_global_loss: 41061712.2667; val_optim_loss: 41061712.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9622; val_auprc_score: 0.9550; val_best_acc_score: 0.9026; val_best_f1_score: 0.9064; train_kl_reg_loss: 124151.9946; train_edge_recon_loss: 2789945.5744; train_gene_expr_recon_loss: 34478189.3893; train_masked_gp_l1_reg_loss: 119319.7256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91619.0328; train_chrom_access_recon_loss: 3620378.4103; train_global_loss: 41223604.2748; train_optim_loss: 41223604.2748; val_kl_reg_loss: 123153.1234; val_edge_recon_loss: 2774407.1833; val_gene_expr_recon_loss: 34616769.8667; val_masked_gp_l1_reg_loss: 120009.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90020.9766; val_chrom_access_recon_loss: 3640953.3000; val_global_loss: 41365312.0000; val_optim_loss: 41365312.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9620; val_auprc_score: 0.9548; val_best_acc_score: 0.9012; val_best_f1_score: 0.9061; train_kl_reg_loss: 122914.0366; train_edge_recon_loss: 2779600.0324; train_gene_expr_recon_loss: 34436550.4733; train_masked_gp_l1_reg_loss: 120795.4328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88588.1405; train_chrom_access_recon_loss: 3619034.4179; train_global_loss: 41167482.5038; train_optim_loss: 41167482.5038; val_kl_reg_loss: 123604.1578; val_edge_recon_loss: 2772202.0000; val_gene_expr_recon_loss: 34380456.2667; val_masked_gp_l1_reg_loss: 121762.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87106.6641; val_chrom_access_recon_loss: 3620657.4500; val_global_loss: 41105792.0000; val_optim_loss: 41105792.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9665; val_auprc_score: 0.9587; val_best_acc_score: 0.9095; val_best_f1_score: 0.9130; train_kl_reg_loss: 121108.8121; train_edge_recon_loss: 2774341.1508; train_gene_expr_recon_loss: 34440978.0916; train_masked_gp_l1_reg_loss: 122458.8566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85809.9634; train_chrom_access_recon_loss: 3620887.5744; train_global_loss: 41165584.5496; train_optim_loss: 41165584.5496; val_kl_reg_loss: 120802.4870; val_edge_recon_loss: 2749763.4500; val_gene_expr_recon_loss: 34313260.2667; val_masked_gp_l1_reg_loss: 123073.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84506.9688; val_chrom_access_recon_loss: 3603324.4833; val_global_loss: 40994730.9333; val_optim_loss: 40994730.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9663; val_auprc_score: 0.9590; val_best_acc_score: 0.9103; val_best_f1_score: 0.9123; train_kl_reg_loss: 120163.9508; train_edge_recon_loss: 2764171.4790; train_gene_expr_recon_loss: 34414907.8015; train_masked_gp_l1_reg_loss: 123946.4933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83377.4221; train_chrom_access_recon_loss: 3622803.1183; train_global_loss: 41129370.2290; train_optim_loss: 41129370.2290; val_kl_reg_loss: 118207.8333; val_edge_recon_loss: 2762557.3167; val_gene_expr_recon_loss: 34259956.6667; val_masked_gp_l1_reg_loss: 124687.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82200.6562; val_chrom_access_recon_loss: 3602293.1000; val_global_loss: 40949902.9333; val_optim_loss: 40949902.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9676; val_auprc_score: 0.9579; val_best_acc_score: 0.9142; val_best_f1_score: 0.9165; train_kl_reg_loss: 131769.6486; train_edge_recon_loss: 2829355.5802; train_gene_expr_recon_loss: 35633189.6489; train_masked_gp_l1_reg_loss: 124519.2015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83242.3378; train_chrom_access_recon_loss: 3711099.3206; train_global_loss: 42513176.0000; train_optim_loss: 42513176.0000; val_kl_reg_loss: 63176.4253; val_edge_recon_loss: 2792536.6000; val_gene_expr_recon_loss: 35424462.1333; val_masked_gp_l1_reg_loss: 124951.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83070.2969; val_chrom_access_recon_loss: 3680494.1333; val_global_loss: 42168692.8000; val_optim_loss: 42168692.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9682; val_auprc_score: 0.9613; val_best_acc_score: 0.9126; val_best_f1_score: 0.9155; train_kl_reg_loss: 129361.2663; train_edge_recon_loss: 2784611.5592; train_gene_expr_recon_loss: 35429509.4351; train_masked_gp_l1_reg_loss: 125381.1054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82333.7604; train_chrom_access_recon_loss: 3682939.1355; train_global_loss: 42234136.1527; train_optim_loss: 42234136.1527; val_kl_reg_loss: 69569.7672; val_edge_recon_loss: 2786079.1000; val_gene_expr_recon_loss: 35195366.9333; val_masked_gp_l1_reg_loss: 125763.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81498.8750; val_chrom_access_recon_loss: 3672674.1500; val_global_loss: 41930953.8667; val_optim_loss: 41930953.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9697; val_auprc_score: 0.9610; val_best_acc_score: 0.9169; val_best_f1_score: 0.9203; train_kl_reg_loss: 121244.4144; train_edge_recon_loss: 2767507.2252; train_gene_expr_recon_loss: 35359241.4656; train_masked_gp_l1_reg_loss: 125983.1691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80665.6338; train_chrom_access_recon_loss: 3675060.3664; train_global_loss: 42129702.3817; train_optim_loss: 42129702.3817; val_kl_reg_loss: 72429.6505; val_edge_recon_loss: 2755803.4667; val_gene_expr_recon_loss: 35277513.2000; val_masked_gp_l1_reg_loss: 126201.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79713.8359; val_chrom_access_recon_loss: 3683113.0333; val_global_loss: 41994772.0000; val_optim_loss: 41994772.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9687; val_auprc_score: 0.9605; val_best_acc_score: 0.9162; val_best_f1_score: 0.9189; train_kl_reg_loss: 115232.6941; train_edge_recon_loss: 2759582.2118; train_gene_expr_recon_loss: 35290716.2137; train_masked_gp_l1_reg_loss: 126295.7371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78705.1524; train_chrom_access_recon_loss: 3670147.0458; train_global_loss: 42040679.1756; train_optim_loss: 42040679.1756; val_kl_reg_loss: 78067.1474; val_edge_recon_loss: 2756812.5333; val_gene_expr_recon_loss: 35150477.8667; val_masked_gp_l1_reg_loss: 126300.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77534.5703; val_chrom_access_recon_loss: 3659414.3333; val_global_loss: 41848607.2000; val_optim_loss: 41848607.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9699; val_auprc_score: 0.9624; val_best_acc_score: 0.9165; val_best_f1_score: 0.9189; train_kl_reg_loss: 113499.6642; train_edge_recon_loss: 2747407.8111; train_gene_expr_recon_loss: 35199098.3969; train_masked_gp_l1_reg_loss: 125896.1570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77147.4354; train_chrom_access_recon_loss: 3668056.8378; train_global_loss: 41931106.2901; train_optim_loss: 41931106.2901; val_kl_reg_loss: 78830.3052; val_edge_recon_loss: 2762571.4833; val_gene_expr_recon_loss: 35073110.4000; val_masked_gp_l1_reg_loss: 125745.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76849.1797; val_chrom_access_recon_loss: 3669846.7833; val_global_loss: 41786951.7333; val_optim_loss: 41786951.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9690; val_auprc_score: 0.9606; val_best_acc_score: 0.9179; val_best_f1_score: 0.9210; train_kl_reg_loss: 113274.5049; train_edge_recon_loss: 2745029.2519; train_gene_expr_recon_loss: 35163015.4504; train_masked_gp_l1_reg_loss: 125667.8390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76624.2635; train_chrom_access_recon_loss: 3665649.6145; train_global_loss: 41889260.9771; train_optim_loss: 41889260.9771; val_kl_reg_loss: 79115.0495; val_edge_recon_loss: 2733067.8167; val_gene_expr_recon_loss: 35151887.0667; val_masked_gp_l1_reg_loss: 125600.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76410.9609; val_chrom_access_recon_loss: 3667542.9667; val_global_loss: 41833624.5333; val_optim_loss: 41833624.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9694; val_auprc_score: 0.9624; val_best_acc_score: 0.9155; val_best_f1_score: 0.9183; train_kl_reg_loss: 112418.0312; train_edge_recon_loss: 2743980.8874; train_gene_expr_recon_loss: 35147574.1527; train_masked_gp_l1_reg_loss: 125553.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76200.6478; train_chrom_access_recon_loss: 3664859.3206; train_global_loss: 41870586.3206; train_optim_loss: 41870586.3206; val_kl_reg_loss: 80679.3495; val_edge_recon_loss: 2755593.9667; val_gene_expr_recon_loss: 35100641.6000; val_masked_gp_l1_reg_loss: 125484.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75981.4297; val_chrom_access_recon_loss: 3655593.4833; val_global_loss: 41793972.2667; val_optim_loss: 41793972.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9658; val_auprc_score: 0.9558; val_best_acc_score: 0.9116; val_best_f1_score: 0.9148; train_kl_reg_loss: 112110.7162; train_edge_recon_loss: 2748798.1851; train_gene_expr_recon_loss: 35132314.3511; train_masked_gp_l1_reg_loss: 125440.4776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75793.8078; train_chrom_access_recon_loss: 3660444.7595; train_global_loss: 41854902.1374; train_optim_loss: 41854902.1374; val_kl_reg_loss: 80951.6370; val_edge_recon_loss: 2768289.0500; val_gene_expr_recon_loss: 35012541.6000; val_masked_gp_l1_reg_loss: 125394.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75594.1484; val_chrom_access_recon_loss: 3655359.6167; val_global_loss: 41718133.8667; val_optim_loss: 41718133.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 1 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9668
val AUPRC score: 0.9589
val best accuracy score: 0.9157
val best F1 score: 0.9178
val target rna MSE score: 1.1653
val source rna MSE score: 14.1232
val target atac MSE score: 0.5753
val source atac MSE score: 6.6127
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
