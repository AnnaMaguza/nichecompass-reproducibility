[True, False, True]
Run timestamp: 19102023_180356_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8964; val_auprc_score: 0.9827; val_best_acc_score: 0.9195; val_best_f1_score: 0.9557; train_kl_reg_loss: 31719.6782; train_edge_recon_loss: 6388130.7374; train_gene_expr_recon_loss: 26261560.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158628.8388; train_global_loss: 32840040.1475; train_optim_loss: 32840040.1475; val_kl_reg_loss: 35131.9694; val_edge_recon_loss: 6461838.3519; val_gene_expr_recon_loss: 23142638.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137130.5312; val_global_loss: 29776738.9506; val_optim_loss: 29776738.9506
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9048; val_auprc_score: 0.9840; val_best_acc_score: 0.9225; val_best_f1_score: 0.9573; train_kl_reg_loss: 39777.5968; train_edge_recon_loss: 6189595.8720; train_gene_expr_recon_loss: 22060535.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133636.6439; train_global_loss: 28423545.2837; train_optim_loss: 28423545.2837; val_kl_reg_loss: 45084.3739; val_edge_recon_loss: 6457543.3596; val_gene_expr_recon_loss: 21467924.6296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127954.1719; val_global_loss: 28098506.3889; val_optim_loss: 28098506.3889
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9100; val_auprc_score: 0.9851; val_best_acc_score: 0.9239; val_best_f1_score: 0.9580; train_kl_reg_loss: 47435.9357; train_edge_recon_loss: 6172638.7684; train_gene_expr_recon_loss: 21142779.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122610.4300; train_global_loss: 27485464.2381; train_optim_loss: 27485464.2381; val_kl_reg_loss: 50427.2792; val_edge_recon_loss: 6392367.6574; val_gene_expr_recon_loss: 20984832.7160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117851.3906; val_global_loss: 27545479.5802; val_optim_loss: 27545479.5802
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9199; val_auprc_score: 0.9867; val_best_acc_score: 0.9295; val_best_f1_score: 0.9609; train_kl_reg_loss: 52541.9664; train_edge_recon_loss: 6151391.9472; train_gene_expr_recon_loss: 20823898.9420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114235.7197; train_global_loss: 27142068.5578; train_optim_loss: 27142068.5578; val_kl_reg_loss: 55840.8964; val_edge_recon_loss: 6374753.0833; val_gene_expr_recon_loss: 20820748.7716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111088.5391; val_global_loss: 27362430.7840; val_optim_loss: 27362430.7840
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9256; val_auprc_score: 0.9878; val_best_acc_score: 0.9313; val_best_f1_score: 0.9620; train_kl_reg_loss: 55658.3915; train_edge_recon_loss: 6134922.9993; train_gene_expr_recon_loss: 20527278.0220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108363.2703; train_global_loss: 26826222.6504; train_optim_loss: 26826222.6504; val_kl_reg_loss: 57285.7727; val_edge_recon_loss: 6344321.5525; val_gene_expr_recon_loss: 20490667.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106632.4688; val_global_loss: 26998907.1605; val_optim_loss: 26998907.1605
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9269; val_auprc_score: 0.9881; val_best_acc_score: 0.9320; val_best_f1_score: 0.9623; train_kl_reg_loss: 133089.9935; train_edge_recon_loss: 6114174.3425; train_gene_expr_recon_loss: 20429333.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104810.3532; train_global_loss: 26781408.6484; train_optim_loss: 26781408.6484; val_kl_reg_loss: 63657.8356; val_edge_recon_loss: 6364380.2284; val_gene_expr_recon_loss: 20344996.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102736.5234; val_global_loss: 26875770.7037; val_optim_loss: 26875770.7037
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9311; val_auprc_score: 0.9888; val_best_acc_score: 0.9345; val_best_f1_score: 0.9636; train_kl_reg_loss: 63279.4106; train_edge_recon_loss: 6127592.9133; train_gene_expr_recon_loss: 20236845.2425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102229.9703; train_global_loss: 26529947.5245; train_optim_loss: 26529947.5245; val_kl_reg_loss: 63379.0203; val_edge_recon_loss: 6318928.4105; val_gene_expr_recon_loss: 20224057.8025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101607.5312; val_global_loss: 26707973.2346; val_optim_loss: 26707973.2346
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9325; val_auprc_score: 0.9889; val_best_acc_score: 0.9349; val_best_f1_score: 0.9640; train_kl_reg_loss: 16712387.7502; train_edge_recon_loss: 6118000.3423; train_gene_expr_recon_loss: 20356739.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100195.9613; train_global_loss: 43287324.2539; train_optim_loss: 43287324.2539; val_kl_reg_loss: 82660.8844; val_edge_recon_loss: 6358786.5062; val_gene_expr_recon_loss: 20427979.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97262.9844; val_global_loss: 26966688.8704; val_optim_loss: 26966688.8704
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9355; val_auprc_score: 0.9893; val_best_acc_score: 0.9380; val_best_f1_score: 0.9655; train_kl_reg_loss: 92123.0872; train_edge_recon_loss: 6103114.2322; train_gene_expr_recon_loss: 20241598.8768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96608.7700; train_global_loss: 26533444.9695; train_optim_loss: 26533444.9695; val_kl_reg_loss: 78155.6830; val_edge_recon_loss: 6351862.0864; val_gene_expr_recon_loss: 20256749.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95696.0234; val_global_loss: 26782463.6543; val_optim_loss: 26782463.6543
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9378; val_auprc_score: 0.9898; val_best_acc_score: 0.9384; val_best_f1_score: 0.9658; train_kl_reg_loss: 80381.9427; train_edge_recon_loss: 6117359.6729; train_gene_expr_recon_loss: 20112052.8878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95754.6658; train_global_loss: 26405549.1767; train_optim_loss: 26405549.1767; val_kl_reg_loss: 78888.6842; val_edge_recon_loss: 6371014.9738; val_gene_expr_recon_loss: 20144108.2160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95822.5000; val_global_loss: 26689833.9198; val_optim_loss: 26689833.9198
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9383; val_auprc_score: 0.9900; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 334115.8009; train_edge_recon_loss: 6109641.1826; train_gene_expr_recon_loss: 20039622.6717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95746.3290; train_global_loss: 26579126.0089; train_optim_loss: 26579126.0089; val_kl_reg_loss: 83389.5470; val_edge_recon_loss: 6343850.7701; val_gene_expr_recon_loss: 20129105.2840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95226.8438; val_global_loss: 26651571.5741; val_optim_loss: 26651571.5741
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9398; val_auprc_score: 0.9903; val_best_acc_score: 0.9399; val_best_f1_score: 0.9667; train_kl_reg_loss: 86406.1826; train_edge_recon_loss: 6114666.9262; train_gene_expr_recon_loss: 20002469.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94908.1483; train_global_loss: 26298450.4130; train_optim_loss: 26298450.4130; val_kl_reg_loss: 86532.1284; val_edge_recon_loss: 6352504.8117; val_gene_expr_recon_loss: 19993787.6852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95359.1641; val_global_loss: 26528184.6111; val_optim_loss: 26528184.6111
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9398; val_auprc_score: 0.9901; val_best_acc_score: 0.9409; val_best_f1_score: 0.9672; train_kl_reg_loss: 86424.1689; train_edge_recon_loss: 6095998.3424; train_gene_expr_recon_loss: 19909349.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95116.6607; train_global_loss: 26186888.6422; train_optim_loss: 26186888.6422; val_kl_reg_loss: 91685.9434; val_edge_recon_loss: 6287891.6235; val_gene_expr_recon_loss: 20003546.3951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95549.6953; val_global_loss: 26478673.9383; val_optim_loss: 26478673.9383
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8236; val_auprc_score: 0.9695; val_best_acc_score: 0.9010; val_best_f1_score: 0.9465; train_kl_reg_loss: 3659897.0152; train_edge_recon_loss: 6911743.9201; train_gene_expr_recon_loss: 53086555.1588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132302.8968; train_global_loss: 63790499.0429; train_optim_loss: 63790499.0429; val_kl_reg_loss: 490078.3259; val_edge_recon_loss: 7232203.0309; val_gene_expr_recon_loss: 45053249.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157176.6406; val_global_loss: 52932707.3951; val_optim_loss: 52932707.3951
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9068; val_auprc_score: 0.9844; val_best_acc_score: 0.9208; val_best_f1_score: 0.9563; train_kl_reg_loss: 286601.1133; train_edge_recon_loss: 6601255.2833; train_gene_expr_recon_loss: 34743430.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129715.4476; train_global_loss: 41761002.0048; train_optim_loss: 41761002.0048; val_kl_reg_loss: 172153.6950; val_edge_recon_loss: 6472262.9722; val_gene_expr_recon_loss: 23176542.5802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108335.2422; val_global_loss: 29929295.2160; val_optim_loss: 29929295.2160
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9368; val_auprc_score: 0.9896; val_best_acc_score: 0.9362; val_best_f1_score: 0.9645; train_kl_reg_loss: 140497.9200; train_edge_recon_loss: 6110325.9882; train_gene_expr_recon_loss: 20850511.4381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91907.4012; train_global_loss: 27193242.7396; train_optim_loss: 27193242.7396; val_kl_reg_loss: 129936.5824; val_edge_recon_loss: 6453640.1890; val_gene_expr_recon_loss: 20307207.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86678.7812; val_global_loss: 26977462.7284; val_optim_loss: 26977462.7284
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8764; val_auprc_score: 0.9784; val_best_acc_score: 0.9153; val_best_f1_score: 0.9536; train_kl_reg_loss: 159246.8689; train_edge_recon_loss: 6396371.5467; train_gene_expr_recon_loss: 28204127.4470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108113.3161; train_global_loss: 34867859.2048; train_optim_loss: 34867859.2048; val_kl_reg_loss: 201140.1916; val_edge_recon_loss: 6852081.6883; val_gene_expr_recon_loss: 41055001.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183959.4531; val_global_loss: 48292183.8642; val_optim_loss: 48292183.8642

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9059; val_auprc_score: 0.9834; val_best_acc_score: 0.9235; val_best_f1_score: 0.9577; train_kl_reg_loss: 160494.2861; train_edge_recon_loss: 6354351.9294; train_gene_expr_recon_loss: 29458708.7396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177636.3436; train_global_loss: 36151191.3084; train_optim_loss: 36151191.3084; val_kl_reg_loss: 141027.8759; val_edge_recon_loss: 6542335.1358; val_gene_expr_recon_loss: 23519383.2407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170906.6094; val_global_loss: 30373652.1914; val_optim_loss: 30373652.1914
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9293; val_auprc_score: 0.9882; val_best_acc_score: 0.9339; val_best_f1_score: 0.9633; train_kl_reg_loss: 133183.5979; train_edge_recon_loss: 6139739.3304; train_gene_expr_recon_loss: 22189909.0449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158228.3451; train_global_loss: 28621060.2806; train_optim_loss: 28621060.2806; val_kl_reg_loss: 127951.8697; val_edge_recon_loss: 6381885.8287; val_gene_expr_recon_loss: 21220018.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144071.6875; val_global_loss: 27873927.7778; val_optim_loss: 27873927.7778
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9368; val_auprc_score: 0.9896; val_best_acc_score: 0.9372; val_best_f1_score: 0.9652; train_kl_reg_loss: 123398.4762; train_edge_recon_loss: 6096153.5938; train_gene_expr_recon_loss: 20571376.2436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131872.3430; train_global_loss: 26922800.6292; train_optim_loss: 26922800.6292; val_kl_reg_loss: 122042.0514; val_edge_recon_loss: 6370452.1227; val_gene_expr_recon_loss: 20252392.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120975.9766; val_global_loss: 26865862.8457; val_optim_loss: 26865862.8457
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9391; val_auprc_score: 0.9901; val_best_acc_score: 0.9388; val_best_f1_score: 0.9660; train_kl_reg_loss: 119874.5232; train_edge_recon_loss: 6084281.0941; train_gene_expr_recon_loss: 19939462.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112388.6777; train_global_loss: 26256007.1877; train_optim_loss: 26256007.1877; val_kl_reg_loss: 119414.0243; val_edge_recon_loss: 6360307.8827; val_gene_expr_recon_loss: 19882723.5247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104940.3281; val_global_loss: 26467385.4012; val_optim_loss: 26467385.4012
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9426; val_auprc_score: 0.9908; val_best_acc_score: 0.9401; val_best_f1_score: 0.9667; train_kl_reg_loss: 116467.9712; train_edge_recon_loss: 6106693.4236; train_gene_expr_recon_loss: 19705455.8813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99229.4342; train_global_loss: 26027846.7163; train_optim_loss: 26027846.7163; val_kl_reg_loss: 115822.2788; val_edge_recon_loss: 6315866.0494; val_gene_expr_recon_loss: 19718939.9506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94384.3359; val_global_loss: 26245012.2593; val_optim_loss: 26245012.2593
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9406; val_auprc_score: 0.9901; val_best_acc_score: 0.9398; val_best_f1_score: 0.9665; train_kl_reg_loss: 113289.0381; train_edge_recon_loss: 6087290.0089; train_gene_expr_recon_loss: 19601113.2103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90727.7789; train_global_loss: 25892420.0302; train_optim_loss: 25892420.0302; val_kl_reg_loss: 111655.8116; val_edge_recon_loss: 6422603.3133; val_gene_expr_recon_loss: 19691736.2593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87576.5391; val_global_loss: 26313571.4012; val_optim_loss: 26313571.4012
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9417; val_auprc_score: 0.9902; val_best_acc_score: 0.9409; val_best_f1_score: 0.9671; train_kl_reg_loss: 109913.2474; train_edge_recon_loss: 6079990.1582; train_gene_expr_recon_loss: 19534331.1822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85264.0130; train_global_loss: 25809498.6003; train_optim_loss: 25809498.6003; val_kl_reg_loss: 109502.0654; val_edge_recon_loss: 6396164.8966; val_gene_expr_recon_loss: 19599946.9568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83215.9922; val_global_loss: 26188829.9630; val_optim_loss: 26188829.9630
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9428; val_auprc_score: 0.9906; val_best_acc_score: 0.9411; val_best_f1_score: 0.9672; train_kl_reg_loss: 107484.7026; train_edge_recon_loss: 6091482.1568; train_gene_expr_recon_loss: 19494062.3856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81621.8914; train_global_loss: 25774651.1465; train_optim_loss: 25774651.1465; val_kl_reg_loss: 107523.9597; val_edge_recon_loss: 6401996.9059; val_gene_expr_recon_loss: 19570823.6049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80215.5859; val_global_loss: 26160560.5247; val_optim_loss: 26160560.5247
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9396; val_auprc_score: 0.9900; val_best_acc_score: 0.9401; val_best_f1_score: 0.9667; train_kl_reg_loss: 113084.4033; train_edge_recon_loss: 6170467.7596; train_gene_expr_recon_loss: 19316789.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79226.8638; train_global_loss: 25679568.8144; train_optim_loss: 25679568.8144; val_kl_reg_loss: 61388.9836; val_edge_recon_loss: 6429837.6427; val_gene_expr_recon_loss: 19394028.6605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78309.1875; val_global_loss: 25963565.3086; val_optim_loss: 25963565.3086
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9393; val_auprc_score: 0.9900; val_best_acc_score: 0.9399; val_best_f1_score: 0.9666; train_kl_reg_loss: 112383.4494; train_edge_recon_loss: 6149256.0547; train_gene_expr_recon_loss: 19291531.9856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77648.1976; train_global_loss: 25630819.6878; train_optim_loss: 25630819.6878; val_kl_reg_loss: 63654.9219; val_edge_recon_loss: 6409449.3318; val_gene_expr_recon_loss: 19374711.0062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76987.7812; val_global_loss: 25924803.2901; val_optim_loss: 25924803.2901
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9400; val_auprc_score: 0.9901; val_best_acc_score: 0.9402; val_best_f1_score: 0.9668; train_kl_reg_loss: 107045.6921; train_edge_recon_loss: 6129601.6563; train_gene_expr_recon_loss: 19250248.7581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76504.6900; train_global_loss: 25563400.7808; train_optim_loss: 25563400.7808; val_kl_reg_loss: 65902.4894; val_edge_recon_loss: 6406848.8395; val_gene_expr_recon_loss: 19323382.7160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76024.5703; val_global_loss: 25872158.0123; val_optim_loss: 25872158.0123
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9397; val_auprc_score: 0.9902; val_best_acc_score: 0.9407; val_best_f1_score: 0.9671; train_kl_reg_loss: 100757.7614; train_edge_recon_loss: 6133229.5864; train_gene_expr_recon_loss: 19219707.9554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75692.7651; train_global_loss: 25529388.0583; train_optim_loss: 25529388.0583; val_kl_reg_loss: 68575.8696; val_edge_recon_loss: 6331173.0772; val_gene_expr_recon_loss: 19307563.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75428.6484; val_global_loss: 25782740.8457; val_optim_loss: 25782740.8457
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9419; val_auprc_score: 0.9905; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 95691.3911; train_edge_recon_loss: 6105608.0841; train_gene_expr_recon_loss: 19201742.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75129.8663; train_global_loss: 25478171.5561; train_optim_loss: 25478171.5561; val_kl_reg_loss: 69098.3884; val_edge_recon_loss: 6330621.2886; val_gene_expr_recon_loss: 19289465.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74888.1328; val_global_loss: 25764073.5370; val_optim_loss: 25764073.5370
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9416; val_auprc_score: 0.9904; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 92178.5716; train_edge_recon_loss: 6118503.0917; train_gene_expr_recon_loss: 19188208.1468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74756.3815; train_global_loss: 25473646.2148; train_optim_loss: 25473646.2148; val_kl_reg_loss: 71432.9610; val_edge_recon_loss: 6346416.6883; val_gene_expr_recon_loss: 19265137.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74611.7422; val_global_loss: 25757599.2469; val_optim_loss: 25757599.2469
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9422; val_auprc_score: 0.9906; val_best_acc_score: 0.9418; val_best_f1_score: 0.9676; train_kl_reg_loss: 89825.6099; train_edge_recon_loss: 6114698.2732; train_gene_expr_recon_loss: 19164123.9067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74516.4518; train_global_loss: 25443164.2504; train_optim_loss: 25443164.2504; val_kl_reg_loss: 71874.7290; val_edge_recon_loss: 6323133.5679; val_gene_expr_recon_loss: 19237524.0679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74396.4141; val_global_loss: 25706928.3333; val_optim_loss: 25706928.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9420; val_auprc_score: 0.9906; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 88353.7957; train_edge_recon_loss: 6125705.5105; train_gene_expr_recon_loss: 19136974.5688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74405.8298; train_global_loss: 25425439.7118; train_optim_loss: 25425439.7118; val_kl_reg_loss: 71455.1613; val_edge_recon_loss: 6336807.0972; val_gene_expr_recon_loss: 19241006.3395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74399.9609; val_global_loss: 25723668.6235; val_optim_loss: 25723668.6235
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9431; val_auprc_score: 0.9908; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 87643.9429; train_edge_recon_loss: 6116375.3455; train_gene_expr_recon_loss: 19121309.9602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74337.3273; train_global_loss: 25399666.5571; train_optim_loss: 25399666.5571; val_kl_reg_loss: 71043.0258; val_edge_recon_loss: 6311939.5031; val_gene_expr_recon_loss: 19194955.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74311.8984; val_global_loss: 25652249.6543; val_optim_loss: 25652249.6543
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9434; val_auprc_score: 0.9907; val_best_acc_score: 0.9419; val_best_f1_score: 0.9677; train_kl_reg_loss: 87018.4097; train_edge_recon_loss: 6098012.0389; train_gene_expr_recon_loss: 19101021.5623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74313.5595; train_global_loss: 25360365.5664; train_optim_loss: 25360365.5664; val_kl_reg_loss: 72814.4146; val_edge_recon_loss: 6322100.7747; val_gene_expr_recon_loss: 19206748.5123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74256.9219; val_global_loss: 25675919.6914; val_optim_loss: 25675919.6914
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9445; val_auprc_score: 0.9912; val_best_acc_score: 0.9427; val_best_f1_score: 0.9682; train_kl_reg_loss: 86051.0381; train_edge_recon_loss: 6108969.1419; train_gene_expr_recon_loss: 19085582.0720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74324.9190; train_global_loss: 25354927.1780; train_optim_loss: 25354927.1780; val_kl_reg_loss: 73641.0932; val_edge_recon_loss: 6280980.2824; val_gene_expr_recon_loss: 19192006.5864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74398.1562; val_global_loss: 25621025.9938; val_optim_loss: 25621025.9938
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9464; val_auprc_score: 0.9913; val_best_acc_score: 0.9430; val_best_f1_score: 0.9683; train_kl_reg_loss: 84968.6793; train_edge_recon_loss: 6094769.4507; train_gene_expr_recon_loss: 19080085.7111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74401.9774; train_global_loss: 25334225.8031; train_optim_loss: 25334225.8031; val_kl_reg_loss: 75310.6054; val_edge_recon_loss: 6310893.8519; val_gene_expr_recon_loss: 19193238.2407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74417.3125; val_global_loss: 25653860.6728; val_optim_loss: 25653860.6728
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9441; val_auprc_score: 0.9910; val_best_acc_score: 0.9427; val_best_f1_score: 0.9681; train_kl_reg_loss: 84459.3050; train_edge_recon_loss: 6086680.9715; train_gene_expr_recon_loss: 19066646.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74459.0415; train_global_loss: 25312245.6810; train_optim_loss: 25312245.6810; val_kl_reg_loss: 75325.5340; val_edge_recon_loss: 6319675.7500; val_gene_expr_recon_loss: 19162183.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74537.6562; val_global_loss: 25631722.6235; val_optim_loss: 25631722.6235
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9440; val_auprc_score: 0.9909; val_best_acc_score: 0.9419; val_best_f1_score: 0.9676; train_kl_reg_loss: 84083.2172; train_edge_recon_loss: 6067744.7877; train_gene_expr_recon_loss: 19060829.8621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74517.6075; train_global_loss: 25287175.4964; train_optim_loss: 25287175.4964; val_kl_reg_loss: 75245.2715; val_edge_recon_loss: 6392586.6373; val_gene_expr_recon_loss: 19143711.9136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74517.8750; val_global_loss: 25686061.8333; val_optim_loss: 25686061.8333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9456; val_auprc_score: 0.9910; val_best_acc_score: 0.9422; val_best_f1_score: 0.9678; train_kl_reg_loss: 84044.8713; train_edge_recon_loss: 6080249.9281; train_gene_expr_recon_loss: 19047747.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74588.3738; train_global_loss: 25286630.6532; train_optim_loss: 25286630.6532; val_kl_reg_loss: 76181.5797; val_edge_recon_loss: 6390172.0540; val_gene_expr_recon_loss: 19146860.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74601.2656; val_global_loss: 25687815.9630; val_optim_loss: 25687815.9630

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9463; val_auprc_score: 0.9911; val_best_acc_score: 0.9429; val_best_f1_score: 0.9682; train_kl_reg_loss: 83293.2668; train_edge_recon_loss: 6080935.3388; train_gene_expr_recon_loss: 19007933.0491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73540.4939; train_global_loss: 25245702.1393; train_optim_loss: 25245702.1393; val_kl_reg_loss: 75689.3477; val_edge_recon_loss: 6314969.2886; val_gene_expr_recon_loss: 19093300.9136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73129.0781; val_global_loss: 25557089.6111; val_optim_loss: 25557089.6111
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9442; val_auprc_score: 0.9909; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 83152.9257; train_edge_recon_loss: 6094326.7634; train_gene_expr_recon_loss: 19003507.8175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73014.7320; train_global_loss: 25254002.2738; train_optim_loss: 25254002.2738; val_kl_reg_loss: 75598.8272; val_edge_recon_loss: 6334412.9360; val_gene_expr_recon_loss: 19107577.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72930.4609; val_global_loss: 25590519.0926; val_optim_loss: 25590519.0926
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9432; val_auprc_score: 0.9908; val_best_acc_score: 0.9423; val_best_f1_score: 0.9680; train_kl_reg_loss: 83097.9621; train_edge_recon_loss: 6080989.4927; train_gene_expr_recon_loss: 18996282.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72889.9712; train_global_loss: 25233259.7681; train_optim_loss: 25233259.7681; val_kl_reg_loss: 75613.5703; val_edge_recon_loss: 6303597.6304; val_gene_expr_recon_loss: 19087929.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72864.9062; val_global_loss: 25540004.5988; val_optim_loss: 25540004.5988
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9458; val_auprc_score: 0.9913; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 83064.3159; train_edge_recon_loss: 6100042.1479; train_gene_expr_recon_loss: 18999273.6350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72835.0183; train_global_loss: 25255215.0593; train_optim_loss: 25255215.0593; val_kl_reg_loss: 75630.1711; val_edge_recon_loss: 6298940.3812; val_gene_expr_recon_loss: 19100850.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72811.4219; val_global_loss: 25548233.5802; val_optim_loss: 25548233.5802
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9459; val_auprc_score: 0.9913; val_best_acc_score: 0.9418; val_best_f1_score: 0.9676; train_kl_reg_loss: 82944.9957; train_edge_recon_loss: 6094024.1559; train_gene_expr_recon_loss: 18993437.3983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72800.6103; train_global_loss: 25243207.2110; train_optim_loss: 25243207.2110; val_kl_reg_loss: 75665.7282; val_edge_recon_loss: 6354903.1744; val_gene_expr_recon_loss: 19097825.2284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72786.7344; val_global_loss: 25601180.1543; val_optim_loss: 25601180.1543
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9449; val_auprc_score: 0.9911; val_best_acc_score: 0.9424; val_best_f1_score: 0.9680; train_kl_reg_loss: 82946.5116; train_edge_recon_loss: 6106313.6149; train_gene_expr_recon_loss: 18994255.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72773.9895; train_global_loss: 25256289.3825; train_optim_loss: 25256289.3825; val_kl_reg_loss: 75883.3590; val_edge_recon_loss: 6322506.7269; val_gene_expr_recon_loss: 19103318.2160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72778.0938; val_global_loss: 25574486.4198; val_optim_loss: 25574486.4198
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9462; val_auprc_score: 0.9912; val_best_acc_score: 0.9426; val_best_f1_score: 0.9680; train_kl_reg_loss: 82897.7203; train_edge_recon_loss: 6111833.6660; train_gene_expr_recon_loss: 18991957.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72761.7621; train_global_loss: 25259450.2367; train_optim_loss: 25259450.2367; val_kl_reg_loss: 76055.1216; val_edge_recon_loss: 6357055.3164; val_gene_expr_recon_loss: 19104720.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72738.7891; val_global_loss: 25610568.8765; val_optim_loss: 25610568.8765

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9445; val_auprc_score: 0.9909; val_best_acc_score: 0.9435; val_best_f1_score: 0.9686; train_kl_reg_loss: 83011.6783; train_edge_recon_loss: 6089029.0082; train_gene_expr_recon_loss: 18987556.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72652.2633; train_global_loss: 25232249.3331; train_optim_loss: 25232249.3331; val_kl_reg_loss: 76095.7139; val_edge_recon_loss: 6263492.5039; val_gene_expr_recon_loss: 19097591.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72602.2188; val_global_loss: 25509781.8395; val_optim_loss: 25509781.8395
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9450; val_auprc_score: 0.9911; val_best_acc_score: 0.9422; val_best_f1_score: 0.9679; train_kl_reg_loss: 82949.1726; train_edge_recon_loss: 6091599.7907; train_gene_expr_recon_loss: 18987725.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72579.4030; train_global_loss: 25234853.9678; train_optim_loss: 25234853.9678; val_kl_reg_loss: 76063.2934; val_edge_recon_loss: 6340807.8194; val_gene_expr_recon_loss: 19094439.8210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72561.1328; val_global_loss: 25583872.9259; val_optim_loss: 25583872.9259
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9443; val_auprc_score: 0.9909; val_best_acc_score: 0.9424; val_best_f1_score: 0.9680; train_kl_reg_loss: 82944.9442; train_edge_recon_loss: 6074871.1535; train_gene_expr_recon_loss: 18982913.1513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72548.3553; train_global_loss: 25213277.4847; train_optim_loss: 25213277.4847; val_kl_reg_loss: 76167.8519; val_edge_recon_loss: 6318388.6682; val_gene_expr_recon_loss: 19097799.6049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72537.0078; val_global_loss: 25564894.1049; val_optim_loss: 25564894.1049
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9446; val_auprc_score: 0.9909; val_best_acc_score: 0.9428; val_best_f1_score: 0.9681; train_kl_reg_loss: 82887.1850; train_edge_recon_loss: 6095397.2040; train_gene_expr_recon_loss: 18987436.7334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72529.6732; train_global_loss: 25238250.9187; train_optim_loss: 25238250.9187; val_kl_reg_loss: 75978.9998; val_edge_recon_loss: 6363510.3511; val_gene_expr_recon_loss: 19107038.0309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72522.6562; val_global_loss: 25619049.4630; val_optim_loss: 25619049.4630
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9452; val_auprc_score: 0.9911; val_best_acc_score: 0.9427; val_best_f1_score: 0.9680; train_kl_reg_loss: 82899.0634; train_edge_recon_loss: 6098766.5602; train_gene_expr_recon_loss: 18991483.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72516.5174; train_global_loss: 25245665.6069; train_optim_loss: 25245665.6069; val_kl_reg_loss: 76016.1027; val_edge_recon_loss: 6359393.5957; val_gene_expr_recon_loss: 19083661.8765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72510.9375; val_global_loss: 25591581.5741; val_optim_loss: 25591581.5741

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9462; val_auprc_score: 0.9914; val_best_acc_score: 0.9428; val_best_f1_score: 0.9682; train_kl_reg_loss: 82876.0245; train_edge_recon_loss: 6083427.2411; train_gene_expr_recon_loss: 18986783.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72502.9033; train_global_loss: 25225589.8395; train_optim_loss: 25225589.8395; val_kl_reg_loss: 76043.8505; val_edge_recon_loss: 6318738.4090; val_gene_expr_recon_loss: 19097322.0432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72498.0078; val_global_loss: 25564602.2531; val_optim_loss: 25564602.2531
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9440; val_auprc_score: 0.9909; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 82891.1845; train_edge_recon_loss: 6082129.9512; train_gene_expr_recon_loss: 18984310.4309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72495.5283; train_global_loss: 25221827.2487; train_optim_loss: 25221827.2487; val_kl_reg_loss: 76094.1875; val_edge_recon_loss: 6319169.9398; val_gene_expr_recon_loss: 19099694.3272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72493.3438; val_global_loss: 25567452.4815; val_optim_loss: 25567452.4815
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9456; val_auprc_score: 0.9911; val_best_acc_score: 0.9426; val_best_f1_score: 0.9680; train_kl_reg_loss: 82887.4184; train_edge_recon_loss: 6094716.5662; train_gene_expr_recon_loss: 18982688.4467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72491.7947; train_global_loss: 25232784.1057; train_optim_loss: 25232784.1057; val_kl_reg_loss: 76137.6159; val_edge_recon_loss: 6359517.8488; val_gene_expr_recon_loss: 19102511.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72490.1953; val_global_loss: 25610657.2963; val_optim_loss: 25610657.2963
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9441; val_auprc_score: 0.9910; val_best_acc_score: 0.9424; val_best_f1_score: 0.9679; train_kl_reg_loss: 82874.2898; train_edge_recon_loss: 6092467.5078; train_gene_expr_recon_loss: 18985737.7523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72488.9846; train_global_loss: 25233568.5338; train_optim_loss: 25233568.5338; val_kl_reg_loss: 76078.9255; val_edge_recon_loss: 6289113.3981; val_gene_expr_recon_loss: 19096555.3827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72488.0000; val_global_loss: 25534235.7160; val_optim_loss: 25534235.7160

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 912 min 8 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9447
val AUPRC score: 0.9910
val best accuracy score: 0.9427
val best F1 score: 0.9681
val target rna MSE score: 0.5066
val source rna MSE score: 0.1648
Val cat covariate0 mean sim diff: -0.0013
Val cat covariate1 mean sim diff: -0.0607
Val cat covariate2 mean sim diff: -0.0010

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
