[True]
Run timestamp: 10082023_213343_59.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_59']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6864; val_auprc_score: 0.7331; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 121692.1241; train_edge_recon_loss: 3813610.8760; train_gene_expr_recon_loss: 44842558.7481; train_masked_gp_l1_reg_loss: 83028.3947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244539.6956; train_chrom_access_recon_loss: 1366770.6708; train_global_loss: 50472200.2748; train_optim_loss: 50472200.2748; val_kl_reg_loss: 104400.7880; val_edge_recon_loss: 4065886.0500; val_gene_expr_recon_loss: 39618353.0667; val_masked_gp_l1_reg_loss: 84137.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239708.0312; val_chrom_access_recon_loss: 1282705.2833; val_global_loss: 45395189.0667; val_optim_loss: 45395189.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7709; val_auprc_score: 0.7870; val_best_acc_score: 0.6194; val_best_f1_score: 0.7123; train_kl_reg_loss: 193321.0075; train_edge_recon_loss: 3645586.1469; train_gene_expr_recon_loss: 38284617.7405; train_masked_gp_l1_reg_loss: 80703.4752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233242.6753; train_chrom_access_recon_loss: 1279869.4924; train_global_loss: 43717340.5496; train_optim_loss: 43717340.5496; val_kl_reg_loss: 209755.7583; val_edge_recon_loss: 4057500.9500; val_gene_expr_recon_loss: 37479170.4000; val_masked_gp_l1_reg_loss: 77675.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226303.0781; val_chrom_access_recon_loss: 1259286.2750; val_global_loss: 43309693.0667; val_optim_loss: 43309693.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8384; val_auprc_score: 0.8369; val_best_acc_score: 0.7588; val_best_f1_score: 0.7515; train_kl_reg_loss: 188423.0225; train_edge_recon_loss: 3568162.2328; train_gene_expr_recon_loss: 37026153.9237; train_masked_gp_l1_reg_loss: 76573.8269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219510.6421; train_chrom_access_recon_loss: 1263120.5057; train_global_loss: 42341944.3359; train_optim_loss: 42341944.3359; val_kl_reg_loss: 172042.3729; val_edge_recon_loss: 4016855.2500; val_gene_expr_recon_loss: 37042644.5333; val_masked_gp_l1_reg_loss: 76468.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212733.9375; val_chrom_access_recon_loss: 1250368.7417; val_global_loss: 42771110.6667; val_optim_loss: 42771110.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8904; val_auprc_score: 0.8790; val_best_acc_score: 0.8147; val_best_f1_score: 0.8218; train_kl_reg_loss: 161319.7486; train_edge_recon_loss: 3534854.2233; train_gene_expr_recon_loss: 36657091.8168; train_masked_gp_l1_reg_loss: 77911.9437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206434.4806; train_chrom_access_recon_loss: 1255685.8674; train_global_loss: 41893298.1069; train_optim_loss: 41893298.1069; val_kl_reg_loss: 155732.2062; val_edge_recon_loss: 3852243.2000; val_gene_expr_recon_loss: 36433793.6000; val_masked_gp_l1_reg_loss: 79530.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200308.3438; val_chrom_access_recon_loss: 1235546.9417; val_global_loss: 41957155.2000; val_optim_loss: 41957155.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8981; val_auprc_score: 0.8866; val_best_acc_score: 0.8088; val_best_f1_score: 0.8215; train_kl_reg_loss: 140935.9055; train_edge_recon_loss: 3316963.7634; train_gene_expr_recon_loss: 36390888.8550; train_masked_gp_l1_reg_loss: 81222.1332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194906.2538; train_chrom_access_recon_loss: 1251300.8836; train_global_loss: 41376217.8321; train_optim_loss: 41376217.8321; val_kl_reg_loss: 165429.9479; val_edge_recon_loss: 3061447.9833; val_gene_expr_recon_loss: 36174728.9333; val_masked_gp_l1_reg_loss: 83844.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189778.8125; val_chrom_access_recon_loss: 1228420.8750; val_global_loss: 40903652.0000; val_optim_loss: 40903652.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9034; val_auprc_score: 0.8871; val_best_acc_score: 0.8242; val_best_f1_score: 0.8356; train_kl_reg_loss: 175289.6973; train_edge_recon_loss: 3028705.5611; train_gene_expr_recon_loss: 36113729.0992; train_masked_gp_l1_reg_loss: 84659.3422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185311.9331; train_chrom_access_recon_loss: 1244604.6660; train_global_loss: 40832300.4885; train_optim_loss: 40832300.4885; val_kl_reg_loss: 172069.8656; val_edge_recon_loss: 3009040.7167; val_gene_expr_recon_loss: 36085269.3333; val_masked_gp_l1_reg_loss: 85423.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180906.0781; val_chrom_access_recon_loss: 1227945.5583; val_global_loss: 40760657.6000; val_optim_loss: 40760657.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9102; val_auprc_score: 0.8933; val_best_acc_score: 0.8358; val_best_f1_score: 0.8462; train_kl_reg_loss: 173905.4305; train_edge_recon_loss: 2971742.5248; train_gene_expr_recon_loss: 35925279.1450; train_masked_gp_l1_reg_loss: 86595.7789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176701.0699; train_chrom_access_recon_loss: 1240521.2176; train_global_loss: 40574745.2824; train_optim_loss: 40574745.2824; val_kl_reg_loss: 169624.9656; val_edge_recon_loss: 2961221.9833; val_gene_expr_recon_loss: 35957840.8000; val_masked_gp_l1_reg_loss: 87715.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172412.6875; val_chrom_access_recon_loss: 1226302.0000; val_global_loss: 40575118.1333; val_optim_loss: 40575118.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9186; val_auprc_score: 0.9032; val_best_acc_score: 0.8453; val_best_f1_score: 0.8556; train_kl_reg_loss: 169460.7505; train_edge_recon_loss: 2930108.1336; train_gene_expr_recon_loss: 35711531.2061; train_masked_gp_l1_reg_loss: 88883.8247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168309.6145; train_chrom_access_recon_loss: 1235235.9752; train_global_loss: 40303529.7099; train_optim_loss: 40303529.7099; val_kl_reg_loss: 164920.3167; val_edge_recon_loss: 2914336.1667; val_gene_expr_recon_loss: 35754837.8667; val_masked_gp_l1_reg_loss: 90173.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164217.2812; val_chrom_access_recon_loss: 1221397.4583; val_global_loss: 40309879.7333; val_optim_loss: 40309879.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9183; val_auprc_score: 0.9022; val_best_acc_score: 0.8461; val_best_f1_score: 0.8562; train_kl_reg_loss: 166066.8751; train_edge_recon_loss: 2897013.0897; train_gene_expr_recon_loss: 35584410.8397; train_masked_gp_l1_reg_loss: 91281.2397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160303.0038; train_chrom_access_recon_loss: 1233500.1365; train_global_loss: 40132575.1756; train_optim_loss: 40132575.1756; val_kl_reg_loss: 163836.4198; val_edge_recon_loss: 2900913.5167; val_gene_expr_recon_loss: 35640696.2667; val_masked_gp_l1_reg_loss: 92528.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156392.6562; val_chrom_access_recon_loss: 1219278.3667; val_global_loss: 40173644.8000; val_optim_loss: 40173644.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9291; val_auprc_score: 0.9156; val_best_acc_score: 0.8569; val_best_f1_score: 0.8642; train_kl_reg_loss: 159937.5159; train_edge_recon_loss: 2883703.8664; train_gene_expr_recon_loss: 35475137.8626; train_masked_gp_l1_reg_loss: 93605.8937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152707.2601; train_chrom_access_recon_loss: 1231631.5468; train_global_loss: 39996724.0611; train_optim_loss: 39996724.0611; val_kl_reg_loss: 157673.0885; val_edge_recon_loss: 2861288.2000; val_gene_expr_recon_loss: 35381725.4667; val_masked_gp_l1_reg_loss: 94712.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149047.2344; val_chrom_access_recon_loss: 1215341.8000; val_global_loss: 39859788.2667; val_optim_loss: 39859788.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9307; val_auprc_score: 0.9202; val_best_acc_score: 0.8579; val_best_f1_score: 0.8663; train_kl_reg_loss: 157950.3975; train_edge_recon_loss: 2874616.6832; train_gene_expr_recon_loss: 35301424.6412; train_masked_gp_l1_reg_loss: 95735.3177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145661.2655; train_chrom_access_recon_loss: 1225848.4895; train_global_loss: 39801236.8550; train_optim_loss: 39801236.8550; val_kl_reg_loss: 159357.0604; val_edge_recon_loss: 2884034.4833; val_gene_expr_recon_loss: 35445219.4667; val_masked_gp_l1_reg_loss: 96590.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142236.9688; val_chrom_access_recon_loss: 1217211.8000; val_global_loss: 39944650.6667; val_optim_loss: 39944650.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9369; val_auprc_score: 0.9244; val_best_acc_score: 0.8681; val_best_f1_score: 0.8732; train_kl_reg_loss: 152402.6939; train_edge_recon_loss: 2856724.4866; train_gene_expr_recon_loss: 35172508.6107; train_masked_gp_l1_reg_loss: 97919.3283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139118.9423; train_chrom_access_recon_loss: 1223950.1870; train_global_loss: 39642624.1221; train_optim_loss: 39642624.1221; val_kl_reg_loss: 150248.4698; val_edge_recon_loss: 2869094.5500; val_gene_expr_recon_loss: 35308723.2000; val_masked_gp_l1_reg_loss: 99135.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135983.6719; val_chrom_access_recon_loss: 1212649.2667; val_global_loss: 39775835.2000; val_optim_loss: 39775835.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9419; val_auprc_score: 0.9310; val_best_acc_score: 0.8729; val_best_f1_score: 0.8793; train_kl_reg_loss: 147985.8767; train_edge_recon_loss: 2847060.2729; train_gene_expr_recon_loss: 35080206.7023; train_masked_gp_l1_reg_loss: 99977.3242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133078.5686; train_chrom_access_recon_loss: 1221974.3025; train_global_loss: 39530283.5115; train_optim_loss: 39530283.5115; val_kl_reg_loss: 147394.0177; val_edge_recon_loss: 2836708.1667; val_gene_expr_recon_loss: 35087835.8667; val_masked_gp_l1_reg_loss: 101046.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130248.0000; val_chrom_access_recon_loss: 1207662.5333; val_global_loss: 39510896.0000; val_optim_loss: 39510896.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9472; val_auprc_score: 0.9376; val_best_acc_score: 0.8793; val_best_f1_score: 0.8822; train_kl_reg_loss: 145606.5858; train_edge_recon_loss: 2823618.9084; train_gene_expr_recon_loss: 35004060.6107; train_masked_gp_l1_reg_loss: 101898.3866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127590.5862; train_chrom_access_recon_loss: 1220431.2080; train_global_loss: 39423206.2595; train_optim_loss: 39423206.2595; val_kl_reg_loss: 144087.0323; val_edge_recon_loss: 2819517.4667; val_gene_expr_recon_loss: 35204984.8000; val_masked_gp_l1_reg_loss: 102963.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124909.8516; val_chrom_access_recon_loss: 1217665.2667; val_global_loss: 39614126.6667; val_optim_loss: 39614126.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9492; val_auprc_score: 0.9390; val_best_acc_score: 0.8826; val_best_f1_score: 0.8880; train_kl_reg_loss: 141888.0329; train_edge_recon_loss: 2823639.3550; train_gene_expr_recon_loss: 34870354.8244; train_masked_gp_l1_reg_loss: 103828.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122411.8310; train_chrom_access_recon_loss: 1217353.3521; train_global_loss: 39279476.3664; train_optim_loss: 39279476.3664; val_kl_reg_loss: 144677.9042; val_edge_recon_loss: 2842572.8167; val_gene_expr_recon_loss: 35098578.9333; val_masked_gp_l1_reg_loss: 104932.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119865.9688; val_chrom_access_recon_loss: 1206313.0167; val_global_loss: 39516938.6667; val_optim_loss: 39516938.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9489; val_auprc_score: 0.9388; val_best_acc_score: 0.8824; val_best_f1_score: 0.8880; train_kl_reg_loss: 139877.2235; train_edge_recon_loss: 2810390.5916; train_gene_expr_recon_loss: 34821896.4427; train_masked_gp_l1_reg_loss: 105681.2372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117473.0910; train_chrom_access_recon_loss: 1216106.6002; train_global_loss: 39211425.1603; train_optim_loss: 39211425.1603; val_kl_reg_loss: 140045.3302; val_edge_recon_loss: 2839111.3833; val_gene_expr_recon_loss: 34834093.3333; val_masked_gp_l1_reg_loss: 106796.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115140.1406; val_chrom_access_recon_loss: 1201389.7500; val_global_loss: 39236576.0000; val_optim_loss: 39236576.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9501; val_auprc_score: 0.9396; val_best_acc_score: 0.8857; val_best_f1_score: 0.8901; train_kl_reg_loss: 136923.4453; train_edge_recon_loss: 2807577.2882; train_gene_expr_recon_loss: 34760278.9313; train_masked_gp_l1_reg_loss: 107677.2384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112865.3828; train_chrom_access_recon_loss: 1215295.9666; train_global_loss: 39140618.1374; train_optim_loss: 39140618.1374; val_kl_reg_loss: 139137.6177; val_edge_recon_loss: 2820164.4667; val_gene_expr_recon_loss: 34807530.8000; val_masked_gp_l1_reg_loss: 108632.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110617.1406; val_chrom_access_recon_loss: 1200407.8750; val_global_loss: 39186489.0667; val_optim_loss: 39186489.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9609; val_auprc_score: 0.9533; val_best_acc_score: 0.8988; val_best_f1_score: 0.9031; train_kl_reg_loss: 134888.4989; train_edge_recon_loss: 2791581.3454; train_gene_expr_recon_loss: 34690695.5115; train_masked_gp_l1_reg_loss: 109521.9506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108493.0539; train_chrom_access_recon_loss: 1214356.5439; train_global_loss: 39049536.7939; train_optim_loss: 39049536.7939; val_kl_reg_loss: 131786.6208; val_edge_recon_loss: 2804465.1500; val_gene_expr_recon_loss: 34830700.2667; val_masked_gp_l1_reg_loss: 110534.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106494.0078; val_chrom_access_recon_loss: 1201057.9750; val_global_loss: 39185040.8000; val_optim_loss: 39185040.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9617; val_auprc_score: 0.9545; val_best_acc_score: 0.9053; val_best_f1_score: 0.9087; train_kl_reg_loss: 131552.3173; train_edge_recon_loss: 2783363.7729; train_gene_expr_recon_loss: 34643553.7252; train_masked_gp_l1_reg_loss: 111485.4835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104549.4148; train_chrom_access_recon_loss: 1213957.7758; train_global_loss: 38988462.5954; train_optim_loss: 38988462.5954; val_kl_reg_loss: 128795.5141; val_edge_recon_loss: 2784084.0833; val_gene_expr_recon_loss: 34688730.4000; val_masked_gp_l1_reg_loss: 112461.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102645.6172; val_chrom_access_recon_loss: 1201201.7000; val_global_loss: 39017915.2000; val_optim_loss: 39017915.2000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9638; val_auprc_score: 0.9576; val_best_acc_score: 0.9061; val_best_f1_score: 0.9080; train_kl_reg_loss: 131036.8529; train_edge_recon_loss: 2770533.8149; train_gene_expr_recon_loss: 34519325.5420; train_masked_gp_l1_reg_loss: 113317.9266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100846.2440; train_chrom_access_recon_loss: 1210919.7767; train_global_loss: 38845980.2748; train_optim_loss: 38845980.2748; val_kl_reg_loss: 131822.3068; val_edge_recon_loss: 2778008.2500; val_gene_expr_recon_loss: 34664093.3333; val_masked_gp_l1_reg_loss: 114209.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99045.8594; val_chrom_access_recon_loss: 1198244.1083; val_global_loss: 38985421.0667; val_optim_loss: 38985421.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9636; val_auprc_score: 0.9539; val_best_acc_score: 0.9093; val_best_f1_score: 0.9116; train_kl_reg_loss: 131132.8392; train_edge_recon_loss: 2764487.0172; train_gene_expr_recon_loss: 34502416.9313; train_masked_gp_l1_reg_loss: 115069.6929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97393.1112; train_chrom_access_recon_loss: 1210602.2662; train_global_loss: 38821101.9847; train_optim_loss: 38821101.9847; val_kl_reg_loss: 131009.4495; val_edge_recon_loss: 2764236.3333; val_gene_expr_recon_loss: 34538391.7333; val_masked_gp_l1_reg_loss: 116040.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95805.8750; val_chrom_access_recon_loss: 1192847.7750; val_global_loss: 38838329.6000; val_optim_loss: 38838329.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9644; val_auprc_score: 0.9560; val_best_acc_score: 0.9089; val_best_f1_score: 0.9128; train_kl_reg_loss: 127898.5221; train_edge_recon_loss: 2758685.7080; train_gene_expr_recon_loss: 34445649.0687; train_masked_gp_l1_reg_loss: 116932.3493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94131.7303; train_chrom_access_recon_loss: 1210748.1727; train_global_loss: 38754045.3130; train_optim_loss: 38754045.3130; val_kl_reg_loss: 125089.7026; val_edge_recon_loss: 2776168.9000; val_gene_expr_recon_loss: 34618232.5333; val_masked_gp_l1_reg_loss: 117939.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92658.9453; val_chrom_access_recon_loss: 1195695.9083; val_global_loss: 38925786.9333; val_optim_loss: 38925786.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9677; val_auprc_score: 0.9624; val_best_acc_score: 0.9088; val_best_f1_score: 0.9119; train_kl_reg_loss: 125799.4662; train_edge_recon_loss: 2761940.2824; train_gene_expr_recon_loss: 34395051.8321; train_masked_gp_l1_reg_loss: 118782.5883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91034.0765; train_chrom_access_recon_loss: 1208937.6746; train_global_loss: 38701546.0763; train_optim_loss: 38701546.0763; val_kl_reg_loss: 124607.7911; val_edge_recon_loss: 2773031.4000; val_gene_expr_recon_loss: 34528764.1333; val_masked_gp_l1_reg_loss: 119807.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89612.4531; val_chrom_access_recon_loss: 1198334.2500; val_global_loss: 38834157.8667; val_optim_loss: 38834157.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9683; val_auprc_score: 0.9607; val_best_acc_score: 0.9150; val_best_f1_score: 0.9183; train_kl_reg_loss: 124643.0279; train_edge_recon_loss: 2755954.2176; train_gene_expr_recon_loss: 34365097.1603; train_masked_gp_l1_reg_loss: 120725.5546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88164.4653; train_chrom_access_recon_loss: 1209641.9284; train_global_loss: 38664226.2595; train_optim_loss: 38664226.2595; val_kl_reg_loss: 123979.9068; val_edge_recon_loss: 2773249.4167; val_gene_expr_recon_loss: 34546316.0000; val_masked_gp_l1_reg_loss: 121484.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86735.4609; val_chrom_access_recon_loss: 1200808.7167; val_global_loss: 38852574.1333; val_optim_loss: 38852574.1333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9738; val_auprc_score: 0.9700; val_best_acc_score: 0.9189; val_best_f1_score: 0.9213; train_kl_reg_loss: 122811.1605; train_edge_recon_loss: 2746667.7939; train_gene_expr_recon_loss: 34311126.4733; train_masked_gp_l1_reg_loss: 122370.1750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85348.2742; train_chrom_access_recon_loss: 1209343.1050; train_global_loss: 38597666.9313; train_optim_loss: 38597666.9313; val_kl_reg_loss: 122373.0385; val_edge_recon_loss: 2744282.8167; val_gene_expr_recon_loss: 34552006.4000; val_masked_gp_l1_reg_loss: 123445.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84050.1953; val_chrom_access_recon_loss: 1204013.7833; val_global_loss: 38830171.2000; val_optim_loss: 38830171.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9689; val_auprc_score: 0.9625; val_best_acc_score: 0.9182; val_best_f1_score: 0.9207; train_kl_reg_loss: 132649.3964; train_edge_recon_loss: 2817107.3760; train_gene_expr_recon_loss: 35643277.0687; train_masked_gp_l1_reg_loss: 123784.9695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85409.3398; train_chrom_access_recon_loss: 1238764.1918; train_global_loss: 40040992.4580; train_optim_loss: 40040992.4580; val_kl_reg_loss: 61059.4365; val_edge_recon_loss: 2811909.6167; val_gene_expr_recon_loss: 35755261.3333; val_masked_gp_l1_reg_loss: 124280.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85098.0859; val_chrom_access_recon_loss: 1226726.6750; val_global_loss: 40064337.6000; val_optim_loss: 40064337.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9720; val_auprc_score: 0.9647; val_best_acc_score: 0.9202; val_best_f1_score: 0.9225; train_kl_reg_loss: 129977.0463; train_edge_recon_loss: 2785419.7366; train_gene_expr_recon_loss: 35453210.0916; train_masked_gp_l1_reg_loss: 124757.8692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84050.9787; train_chrom_access_recon_loss: 1233220.9237; train_global_loss: 39810636.5802; train_optim_loss: 39810636.5802; val_kl_reg_loss: 67796.5625; val_edge_recon_loss: 2771455.3667; val_gene_expr_recon_loss: 35651902.4000; val_masked_gp_l1_reg_loss: 125229.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83102.6406; val_chrom_access_recon_loss: 1218276.0500; val_global_loss: 39917762.9333; val_optim_loss: 39917762.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9700; val_auprc_score: 0.9630; val_best_acc_score: 0.9198; val_best_f1_score: 0.9229; train_kl_reg_loss: 120919.5518; train_edge_recon_loss: 2760669.7023; train_gene_expr_recon_loss: 35377895.4198; train_masked_gp_l1_reg_loss: 125524.8443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82156.3074; train_chrom_access_recon_loss: 1229913.0372; train_global_loss: 39697078.9313; train_optim_loss: 39697078.9313; val_kl_reg_loss: 71744.2495; val_edge_recon_loss: 2756063.8167; val_gene_expr_recon_loss: 35435017.8667; val_masked_gp_l1_reg_loss: 125720.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81036.5078; val_chrom_access_recon_loss: 1218459.1333; val_global_loss: 39688041.8667; val_optim_loss: 39688041.8667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9682; val_best_acc_score: 0.9216; val_best_f1_score: 0.9245; train_kl_reg_loss: 114193.2866; train_edge_recon_loss: 2755476.9485; train_gene_expr_recon_loss: 35235449.1450; train_masked_gp_l1_reg_loss: 125705.3195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79853.2445; train_chrom_access_recon_loss: 1227099.2004; train_global_loss: 39537777.0687; train_optim_loss: 39537777.0687; val_kl_reg_loss: 76696.2849; val_edge_recon_loss: 2743097.7500; val_gene_expr_recon_loss: 35384089.6000; val_masked_gp_l1_reg_loss: 125790.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78528.5547; val_chrom_access_recon_loss: 1212153.2417; val_global_loss: 39620356.2667; val_optim_loss: 39620356.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9704; val_auprc_score: 0.9629; val_best_acc_score: 0.9224; val_best_f1_score: 0.9253; train_kl_reg_loss: 111335.1063; train_edge_recon_loss: 2739491.5821; train_gene_expr_recon_loss: 35184976.2901; train_masked_gp_l1_reg_loss: 125400.3767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78173.7927; train_chrom_access_recon_loss: 1225275.6384; train_global_loss: 39464652.4885; train_optim_loss: 39464652.4885; val_kl_reg_loss: 78352.2495; val_edge_recon_loss: 2766902.5333; val_gene_expr_recon_loss: 35300711.4667; val_masked_gp_l1_reg_loss: 125255.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77871.9688; val_chrom_access_recon_loss: 1212651.2167; val_global_loss: 39561745.6000; val_optim_loss: 39561745.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9736; val_auprc_score: 0.9681; val_best_acc_score: 0.9223; val_best_f1_score: 0.9250; train_kl_reg_loss: 110812.4602; train_edge_recon_loss: 2740476.0611; train_gene_expr_recon_loss: 35204671.5878; train_masked_gp_l1_reg_loss: 125212.1613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77663.9487; train_chrom_access_recon_loss: 1228568.7214; train_global_loss: 39487404.7634; train_optim_loss: 39487404.7634; val_kl_reg_loss: 79098.1714; val_edge_recon_loss: 2732220.7000; val_gene_expr_recon_loss: 35446080.5333; val_masked_gp_l1_reg_loss: 125170.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77469.3203; val_chrom_access_recon_loss: 1218328.9833; val_global_loss: 39678368.8000; val_optim_loss: 39678368.8000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9709; val_auprc_score: 0.9620; val_best_acc_score: 0.9206; val_best_f1_score: 0.9235; train_kl_reg_loss: 110488.3802; train_edge_recon_loss: 2737126.0840; train_gene_expr_recon_loss: 35227540.3359; train_masked_gp_l1_reg_loss: 125141.0336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77285.2298; train_chrom_access_recon_loss: 1229395.7099; train_global_loss: 39506976.8855; train_optim_loss: 39506976.8855; val_kl_reg_loss: 79551.9089; val_edge_recon_loss: 2743087.2667; val_gene_expr_recon_loss: 35360811.4667; val_masked_gp_l1_reg_loss: 125134.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77112.5156; val_chrom_access_recon_loss: 1215390.0500; val_global_loss: 39601088.8000; val_optim_loss: 39601088.8000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9721; val_auprc_score: 0.9676; val_best_acc_score: 0.9192; val_best_f1_score: 0.9213; train_kl_reg_loss: 109510.7957; train_edge_recon_loss: 2737277.8626; train_gene_expr_recon_loss: 35230556.6412; train_masked_gp_l1_reg_loss: 125117.6796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76944.7873; train_chrom_access_recon_loss: 1230797.5897; train_global_loss: 39510205.6794; train_optim_loss: 39510205.6794; val_kl_reg_loss: 80131.1641; val_edge_recon_loss: 2752110.6833; val_gene_expr_recon_loss: 35434611.2000; val_masked_gp_l1_reg_loss: 125086.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76757.2734; val_chrom_access_recon_loss: 1217064.4750; val_global_loss: 39685761.6000; val_optim_loss: 39685761.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 51 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9694
val AUPRC score: 0.9605
val best accuracy score: 0.9166
val best F1 score: 0.9192
val target rna MSE score: 1.0417
val source rna MSE score: 18.2191
val target atac MSE score: 0.5528
val source atac MSE score: 6.1810
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
