[True]
Run timestamp: 07092023_040251_258.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_258']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2393 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5107, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6213; val_auprc_score: 0.6187; val_best_acc_score: 0.5021; val_best_f1_score: 0.6675; train_kl_reg_loss: 44510.6326; train_edge_recon_loss: 3560533.7197; train_gene_expr_recon_loss: 12585708.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 813565.3201; train_chrom_access_recon_loss: 10247968.2576; train_global_loss: 27252286.4848; train_optim_loss: 27252286.4848; val_kl_reg_loss: 85564.0576; val_edge_recon_loss: 4065646.4375; val_gene_expr_recon_loss: 11370230.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 616256.6250; val_chrom_access_recon_loss: 9834977.3750; val_global_loss: 25972675.5000; val_optim_loss: 25972675.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6683; val_auprc_score: 0.6550; val_best_acc_score: 0.5476; val_best_f1_score: 0.6837; train_kl_reg_loss: 85435.0059; train_edge_recon_loss: 3532459.3902; train_gene_expr_recon_loss: 11330686.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 450520.8509; train_chrom_access_recon_loss: 9727186.8485; train_global_loss: 25126288.6970; train_optim_loss: 25126288.6970; val_kl_reg_loss: 90657.9033; val_edge_recon_loss: 4061781.7188; val_gene_expr_recon_loss: 11246158.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 311023.2812; val_chrom_access_recon_loss: 9789913.2500; val_global_loss: 25499534.2500; val_optim_loss: 25499534.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7462; val_auprc_score: 0.7305; val_best_acc_score: 0.6744; val_best_f1_score: 0.7114; train_kl_reg_loss: 85352.0470; train_edge_recon_loss: 3511868.8409; train_gene_expr_recon_loss: 11114510.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232712.9737; train_chrom_access_recon_loss: 9608358.8788; train_global_loss: 24552802.6364; train_optim_loss: 24552802.6364; val_kl_reg_loss: 84336.7617; val_edge_recon_loss: 3997672.0625; val_gene_expr_recon_loss: 11031348.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172478.0781; val_chrom_access_recon_loss: 9696886.2500; val_global_loss: 24982721.7500; val_optim_loss: 24982721.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8223; val_auprc_score: 0.7729; val_best_acc_score: 0.7689; val_best_f1_score: 0.8010; train_kl_reg_loss: 67981.9493; train_edge_recon_loss: 3430671.8750; train_gene_expr_recon_loss: 11018636.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139856.6155; train_chrom_access_recon_loss: 9544191.2576; train_global_loss: 24201338.2727; train_optim_loss: 24201338.2727; val_kl_reg_loss: 58892.1982; val_edge_recon_loss: 3277784.9062; val_gene_expr_recon_loss: 11097207.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114250.5859; val_chrom_access_recon_loss: 9702520.7500; val_global_loss: 24250656.2500; val_optim_loss: 24250656.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8316; val_auprc_score: 0.7995; val_best_acc_score: 0.7448; val_best_f1_score: 0.7854; train_kl_reg_loss: 65265.5798; train_edge_recon_loss: 3096800.7045; train_gene_expr_recon_loss: 11000309.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100161.0758; train_chrom_access_recon_loss: 9531491.9394; train_global_loss: 23794028.9394; train_optim_loss: 23794028.9394; val_kl_reg_loss: 75980.6855; val_edge_recon_loss: 3072181.5938; val_gene_expr_recon_loss: 10830217.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88265.0312; val_chrom_access_recon_loss: 9507540.8750; val_global_loss: 23574186.0000; val_optim_loss: 23574186.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8435; val_auprc_score: 0.8052; val_best_acc_score: 0.7620; val_best_f1_score: 0.7980; train_kl_reg_loss: 85838.1934; train_edge_recon_loss: 2966840.1818; train_gene_expr_recon_loss: 10902245.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77956.7424; train_chrom_access_recon_loss: 9465686.0606; train_global_loss: 23498566.9394; train_optim_loss: 23498566.9394; val_kl_reg_loss: 80811.4824; val_edge_recon_loss: 2967785.5938; val_gene_expr_recon_loss: 10756118.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69997.7812; val_chrom_access_recon_loss: 9531505.7500; val_global_loss: 23406219.2500; val_optim_loss: 23406219.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8512; val_auprc_score: 0.8092; val_best_acc_score: 0.7708; val_best_f1_score: 0.7972; train_kl_reg_loss: 85989.8465; train_edge_recon_loss: 2936814.0682; train_gene_expr_recon_loss: 10821493.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63674.6838; train_chrom_access_recon_loss: 9414302.0152; train_global_loss: 23322274.2727; train_optim_loss: 23322274.2727; val_kl_reg_loss: 86663.4961; val_edge_recon_loss: 2923654.6562; val_gene_expr_recon_loss: 10743225.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58095.6289; val_chrom_access_recon_loss: 9505479.7500; val_global_loss: 23317120.0000; val_optim_loss: 23317120.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8657; val_auprc_score: 0.8299; val_best_acc_score: 0.7859; val_best_f1_score: 0.8087; train_kl_reg_loss: 85949.6662; train_edge_recon_loss: 2937129.1023; train_gene_expr_recon_loss: 10751226.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54104.1438; train_chrom_access_recon_loss: 9353464.9242; train_global_loss: 23181874.0000; train_optim_loss: 23181874.0000; val_kl_reg_loss: 83629.5449; val_edge_recon_loss: 2849187.0312; val_gene_expr_recon_loss: 10646853.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50691.5469; val_chrom_access_recon_loss: 9415693.0000; val_global_loss: 23046055.0000; val_optim_loss: 23046055.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8622; val_auprc_score: 0.8282; val_best_acc_score: 0.7832; val_best_f1_score: 0.8078; train_kl_reg_loss: 83925.0095; train_edge_recon_loss: 2918999.6023; train_gene_expr_recon_loss: 10701637.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47753.1300; train_chrom_access_recon_loss: 9307211.1515; train_global_loss: 23059526.3030; train_optim_loss: 23059526.3030; val_kl_reg_loss: 81327.0049; val_edge_recon_loss: 2945223.7500; val_gene_expr_recon_loss: 10645292.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45293.9570; val_chrom_access_recon_loss: 9428108.1250; val_global_loss: 23145245.5000; val_optim_loss: 23145245.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8685; val_auprc_score: 0.8308; val_best_acc_score: 0.7920; val_best_f1_score: 0.8142; train_kl_reg_loss: 79966.6629; train_edge_recon_loss: 2891466.7992; train_gene_expr_recon_loss: 10660356.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43198.1951; train_chrom_access_recon_loss: 9274286.6061; train_global_loss: 22949274.6061; train_optim_loss: 22949274.6061; val_kl_reg_loss: 78708.1348; val_edge_recon_loss: 2911146.3438; val_gene_expr_recon_loss: 10700100.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41418.1836; val_chrom_access_recon_loss: 9456816.3750; val_global_loss: 23188188.7500; val_optim_loss: 23188188.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8928; val_auprc_score: 0.8610; val_best_acc_score: 0.8162; val_best_f1_score: 0.8349; train_kl_reg_loss: 75462.6987; train_edge_recon_loss: 2877079.6212; train_gene_expr_recon_loss: 10610783.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39867.8411; train_chrom_access_recon_loss: 9236521.8636; train_global_loss: 22839714.8788; train_optim_loss: 22839714.8788; val_kl_reg_loss: 78110.5156; val_edge_recon_loss: 2822389.7188; val_gene_expr_recon_loss: 10656788.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38596.9336; val_chrom_access_recon_loss: 9399862.7500; val_global_loss: 22995748.5000; val_optim_loss: 22995748.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8961; val_auprc_score: 0.8697; val_best_acc_score: 0.8275; val_best_f1_score: 0.8444; train_kl_reg_loss: 75204.4598; train_edge_recon_loss: 2838029.3447; train_gene_expr_recon_loss: 10577507.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37469.6966; train_chrom_access_recon_loss: 9218079.4091; train_global_loss: 22746290.3030; train_optim_loss: 22746290.3030; val_kl_reg_loss: 75817.0156; val_edge_recon_loss: 2852844.0000; val_gene_expr_recon_loss: 10417192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36613.1172; val_chrom_access_recon_loss: 9367208.6250; val_global_loss: 22749674.2500; val_optim_loss: 22749674.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9131; val_auprc_score: 0.8818; val_best_acc_score: 0.8544; val_best_f1_score: 0.8648; train_kl_reg_loss: 78304.4162; train_edge_recon_loss: 2796103.4015; train_gene_expr_recon_loss: 10535460.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35809.1039; train_chrom_access_recon_loss: 9185741.2424; train_global_loss: 22631419.0303; train_optim_loss: 22631419.0303; val_kl_reg_loss: 80142.3447; val_edge_recon_loss: 2793170.7188; val_gene_expr_recon_loss: 10544493.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35118.9414; val_chrom_access_recon_loss: 9230009.8750; val_global_loss: 22682934.7500; val_optim_loss: 22682934.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9106; val_auprc_score: 0.8823; val_best_acc_score: 0.8477; val_best_f1_score: 0.8590; train_kl_reg_loss: 77537.4760; train_edge_recon_loss: 2773771.3144; train_gene_expr_recon_loss: 10502543.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34357.1959; train_chrom_access_recon_loss: 9148438.8030; train_global_loss: 22536648.8485; train_optim_loss: 22536648.8485; val_kl_reg_loss: 80852.8311; val_edge_recon_loss: 2805619.3125; val_gene_expr_recon_loss: 10471515.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33782.6875; val_chrom_access_recon_loss: 9273865.5000; val_global_loss: 22665636.2500; val_optim_loss: 22665636.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9128; val_auprc_score: 0.8796; val_best_acc_score: 0.8503; val_best_f1_score: 0.8624; train_kl_reg_loss: 79165.3451; train_edge_recon_loss: 2761176.0530; train_gene_expr_recon_loss: 10465941.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33325.6842; train_chrom_access_recon_loss: 9108862.3030; train_global_loss: 22448471.0000; train_optim_loss: 22448471.0000; val_kl_reg_loss: 78836.0303; val_edge_recon_loss: 2808887.0000; val_gene_expr_recon_loss: 10373106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32950.2539; val_chrom_access_recon_loss: 9201827.2500; val_global_loss: 22495606.5000; val_optim_loss: 22495606.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9171; val_auprc_score: 0.8874; val_best_acc_score: 0.8598; val_best_f1_score: 0.8686; train_kl_reg_loss: 77054.8371; train_edge_recon_loss: 2751403.8220; train_gene_expr_recon_loss: 10440466.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32412.2567; train_chrom_access_recon_loss: 9084580.0152; train_global_loss: 22385917.7273; train_optim_loss: 22385917.7273; val_kl_reg_loss: 77260.9639; val_edge_recon_loss: 2781317.9688; val_gene_expr_recon_loss: 10414081.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32158.7578; val_chrom_access_recon_loss: 9185589.1250; val_global_loss: 22490408.5000; val_optim_loss: 22490408.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9241; val_auprc_score: 0.8975; val_best_acc_score: 0.8657; val_best_f1_score: 0.8743; train_kl_reg_loss: 76882.9090; train_edge_recon_loss: 2739022.9621; train_gene_expr_recon_loss: 10408741.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31613.0692; train_chrom_access_recon_loss: 9061149.5000; train_global_loss: 22317409.8182; train_optim_loss: 22317409.8182; val_kl_reg_loss: 76181.8975; val_edge_recon_loss: 2779806.1250; val_gene_expr_recon_loss: 10279514.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31477.7793; val_chrom_access_recon_loss: 9112909.1250; val_global_loss: 22279890.2500; val_optim_loss: 22279890.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9229; val_auprc_score: 0.8971; val_best_acc_score: 0.8659; val_best_f1_score: 0.8746; train_kl_reg_loss: 74949.0993; train_edge_recon_loss: 2733733.9129; train_gene_expr_recon_loss: 10376074.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31091.9262; train_chrom_access_recon_loss: 9034468.3182; train_global_loss: 22250318.0606; train_optim_loss: 22250318.0606; val_kl_reg_loss: 78086.8740; val_edge_recon_loss: 2774769.1875; val_gene_expr_recon_loss: 10330431.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30739.4043; val_chrom_access_recon_loss: 9081230.3750; val_global_loss: 22295257.5000; val_optim_loss: 22295257.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9343; val_auprc_score: 0.9119; val_best_acc_score: 0.8702; val_best_f1_score: 0.8789; train_kl_reg_loss: 75122.0017; train_edge_recon_loss: 2724281.8902; train_gene_expr_recon_loss: 10353036.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30506.0912; train_chrom_access_recon_loss: 9015359.2727; train_global_loss: 22198305.7879; train_optim_loss: 22198305.7879; val_kl_reg_loss: 76912.9189; val_edge_recon_loss: 2753897.9688; val_gene_expr_recon_loss: 10307365.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30406.5547; val_chrom_access_recon_loss: 9197437.1250; val_global_loss: 22366020.2500; val_optim_loss: 22366020.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9267; val_auprc_score: 0.8996; val_best_acc_score: 0.8665; val_best_f1_score: 0.8745; train_kl_reg_loss: 72650.7485; train_edge_recon_loss: 2727841.4811; train_gene_expr_recon_loss: 10327951.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30034.4025; train_chrom_access_recon_loss: 8985527.6364; train_global_loss: 22144005.7879; train_optim_loss: 22144005.7879; val_kl_reg_loss: 76193.4355; val_edge_recon_loss: 2769840.7188; val_gene_expr_recon_loss: 10319132.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29811.9199; val_chrom_access_recon_loss: 9095481.8750; val_global_loss: 22290461.0000; val_optim_loss: 22290461.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9300; val_auprc_score: 0.9012; val_best_acc_score: 0.8769; val_best_f1_score: 0.8828; train_kl_reg_loss: 72794.0753; train_edge_recon_loss: 2716934.6818; train_gene_expr_recon_loss: 10295650.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29589.9279; train_chrom_access_recon_loss: 8963823.7121; train_global_loss: 22078792.6667; train_optim_loss: 22078792.6667; val_kl_reg_loss: 74166.6318; val_edge_recon_loss: 2738680.3125; val_gene_expr_recon_loss: 10208821.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29409.2188; val_chrom_access_recon_loss: 9032932.3750; val_global_loss: 22084010.2500; val_optim_loss: 22084010.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9398; val_auprc_score: 0.9185; val_best_acc_score: 0.8796; val_best_f1_score: 0.8853; train_kl_reg_loss: 71559.0798; train_edge_recon_loss: 2718495.0000; train_gene_expr_recon_loss: 10274044.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29168.2170; train_chrom_access_recon_loss: 8936009.2879; train_global_loss: 22029276.1212; train_optim_loss: 22029276.1212; val_kl_reg_loss: 70970.4150; val_edge_recon_loss: 2723384.5625; val_gene_expr_recon_loss: 10307551.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29078.9551; val_chrom_access_recon_loss: 9036534.6250; val_global_loss: 22167520.5000; val_optim_loss: 22167520.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9405; val_auprc_score: 0.9200; val_best_acc_score: 0.8791; val_best_f1_score: 0.8846; train_kl_reg_loss: 69372.4226; train_edge_recon_loss: 2719697.8712; train_gene_expr_recon_loss: 10260028.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28849.4395; train_chrom_access_recon_loss: 8921782.6364; train_global_loss: 21999731.2424; train_optim_loss: 21999731.2424; val_kl_reg_loss: 68782.7334; val_edge_recon_loss: 2731748.5312; val_gene_expr_recon_loss: 10253142.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28731.2539; val_chrom_access_recon_loss: 8976171.7500; val_global_loss: 22058576.5000; val_optim_loss: 22058576.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9440; val_auprc_score: 0.9218; val_best_acc_score: 0.8877; val_best_f1_score: 0.8933; train_kl_reg_loss: 68309.0320; train_edge_recon_loss: 2709986.7614; train_gene_expr_recon_loss: 10231858.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28580.2687; train_chrom_access_recon_loss: 8898231.5758; train_global_loss: 21936966.2424; train_optim_loss: 21936966.2424; val_kl_reg_loss: 69840.9766; val_edge_recon_loss: 2696280.2188; val_gene_expr_recon_loss: 10260168.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28575.7871; val_chrom_access_recon_loss: 9106660.6250; val_global_loss: 22161525.7500; val_optim_loss: 22161525.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9419; val_auprc_score: 0.9198; val_best_acc_score: 0.8845; val_best_f1_score: 0.8896; train_kl_reg_loss: 67536.7041; train_edge_recon_loss: 2707411.4280; train_gene_expr_recon_loss: 10216294.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28404.6750; train_chrom_access_recon_loss: 8883081.5303; train_global_loss: 21902729.0909; train_optim_loss: 21902729.0909; val_kl_reg_loss: 68763.8926; val_edge_recon_loss: 2719342.9375; val_gene_expr_recon_loss: 10125481.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28304.8984; val_chrom_access_recon_loss: 8907783.9375; val_global_loss: 21849676.7500; val_optim_loss: 21849676.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9499; val_auprc_score: 0.9336; val_best_acc_score: 0.8933; val_best_f1_score: 0.8973; train_kl_reg_loss: 70327.5034; train_edge_recon_loss: 2726633.1970; train_gene_expr_recon_loss: 10120438.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25662.7555; train_chrom_access_recon_loss: 8851376.1439; train_global_loss: 21794438.0303; train_optim_loss: 21794438.0303; val_kl_reg_loss: 54898.2744; val_edge_recon_loss: 2729508.6875; val_gene_expr_recon_loss: 10154091.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25093.6211; val_chrom_access_recon_loss: 8964637.7500; val_global_loss: 21928230.2500; val_optim_loss: 21928230.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9408; val_auprc_score: 0.9192; val_best_acc_score: 0.8818; val_best_f1_score: 0.8858; train_kl_reg_loss: 72023.7938; train_edge_recon_loss: 2722443.4242; train_gene_expr_recon_loss: 10072033.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24832.4692; train_chrom_access_recon_loss: 8793348.9470; train_global_loss: 21684682.2424; train_optim_loss: 21684682.2424; val_kl_reg_loss: 53065.7583; val_edge_recon_loss: 2753529.0625; val_gene_expr_recon_loss: 10074123.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24720.5820; val_chrom_access_recon_loss: 8933467.7500; val_global_loss: 21838907.0000; val_optim_loss: 21838907.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9463; val_auprc_score: 0.9243; val_best_acc_score: 0.8880; val_best_f1_score: 0.8940; train_kl_reg_loss: 70467.0388; train_edge_recon_loss: 2705496.8258; train_gene_expr_recon_loss: 10038409.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24560.2468; train_chrom_access_recon_loss: 8775630.2197; train_global_loss: 21614564.2727; train_optim_loss: 21614564.2727; val_kl_reg_loss: 52558.7334; val_edge_recon_loss: 2743828.1250; val_gene_expr_recon_loss: 9973644.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24484.5527; val_chrom_access_recon_loss: 8875836.1250; val_global_loss: 21670352.5000; val_optim_loss: 21670352.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9429; val_auprc_score: 0.9215; val_best_acc_score: 0.8885; val_best_f1_score: 0.8940; train_kl_reg_loss: 68339.5204; train_edge_recon_loss: 2705186.1023; train_gene_expr_recon_loss: 10006827.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24445.6447; train_chrom_access_recon_loss: 8743425.1742; train_global_loss: 21548224.0606; train_optim_loss: 21548224.0606; val_kl_reg_loss: 51577.5620; val_edge_recon_loss: 2749087.8750; val_gene_expr_recon_loss: 9998056.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24389.1230; val_chrom_access_recon_loss: 8834641.8750; val_global_loss: 21657752.5000; val_optim_loss: 21657752.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9437; val_auprc_score: 0.9193; val_best_acc_score: 0.8877; val_best_f1_score: 0.8939; train_kl_reg_loss: 65790.9393; train_edge_recon_loss: 2702014.3371; train_gene_expr_recon_loss: 9991114.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24381.7185; train_chrom_access_recon_loss: 8715037.6061; train_global_loss: 21498339.1212; train_optim_loss: 21498339.1212; val_kl_reg_loss: 51717.5557; val_edge_recon_loss: 2753697.8750; val_gene_expr_recon_loss: 9901297.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24254.3320; val_chrom_access_recon_loss: 8768379.0000; val_global_loss: 21499345.2500; val_optim_loss: 21499345.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9459; val_auprc_score: 0.9186; val_best_acc_score: 0.8955; val_best_f1_score: 0.8991; train_kl_reg_loss: 64553.1864; train_edge_recon_loss: 2700977.5833; train_gene_expr_recon_loss: 9967938.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24281.0414; train_chrom_access_recon_loss: 8702021.7803; train_global_loss: 21459771.7576; train_optim_loss: 21459771.7576; val_kl_reg_loss: 53097.2363; val_edge_recon_loss: 2724810.8438; val_gene_expr_recon_loss: 9877712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24239.4336; val_chrom_access_recon_loss: 8742471.4375; val_global_loss: 21422330.5000; val_optim_loss: 21422330.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9478; val_auprc_score: 0.9301; val_best_acc_score: 0.8971; val_best_f1_score: 0.9030; train_kl_reg_loss: 62132.8265; train_edge_recon_loss: 2696261.3144; train_gene_expr_recon_loss: 9939577.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24181.4675; train_chrom_access_recon_loss: 8674427.9015; train_global_loss: 21396581.3939; train_optim_loss: 21396581.3939; val_kl_reg_loss: 52243.1436; val_edge_recon_loss: 2725683.5312; val_gene_expr_recon_loss: 9972748.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24169.5840; val_chrom_access_recon_loss: 8803851.0000; val_global_loss: 21578696.2500; val_optim_loss: 21578696.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9412; val_auprc_score: 0.9167; val_best_acc_score: 0.8909; val_best_f1_score: 0.8974; train_kl_reg_loss: 62402.5750; train_edge_recon_loss: 2691191.8750; train_gene_expr_recon_loss: 9920444.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24094.4802; train_chrom_access_recon_loss: 8661231.4924; train_global_loss: 21359365.2727; train_optim_loss: 21359365.2727; val_kl_reg_loss: 51418.5181; val_edge_recon_loss: 2748859.3125; val_gene_expr_recon_loss: 9886155.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24095.4023; val_chrom_access_recon_loss: 8726952.6250; val_global_loss: 21437480.2500; val_optim_loss: 21437480.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9486; val_auprc_score: 0.9282; val_best_acc_score: 0.8976; val_best_f1_score: 0.9018; train_kl_reg_loss: 61107.0216; train_edge_recon_loss: 2696395.7311; train_gene_expr_recon_loss: 9902407.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24064.7101; train_chrom_access_recon_loss: 8645216.8788; train_global_loss: 21329191.4848; train_optim_loss: 21329191.4848; val_kl_reg_loss: 52906.1719; val_edge_recon_loss: 2705466.8750; val_gene_expr_recon_loss: 9864871.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24078.2676; val_chrom_access_recon_loss: 8747768.8750; val_global_loss: 21395091.5000; val_optim_loss: 21395091.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9506; val_auprc_score: 0.9300; val_best_acc_score: 0.8976; val_best_f1_score: 0.9027; train_kl_reg_loss: 59309.0169; train_edge_recon_loss: 2685780.8977; train_gene_expr_recon_loss: 9890551.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24048.1163; train_chrom_access_recon_loss: 8634003.3712; train_global_loss: 21293693.2424; train_optim_loss: 21293693.2424; val_kl_reg_loss: 51513.9277; val_edge_recon_loss: 2720238.7812; val_gene_expr_recon_loss: 9920339.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23985.5742; val_chrom_access_recon_loss: 8762360.3750; val_global_loss: 21478438.0000; val_optim_loss: 21478438.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9528; val_auprc_score: 0.9380; val_best_acc_score: 0.8966; val_best_f1_score: 0.9020; train_kl_reg_loss: 57638.4316; train_edge_recon_loss: 2686738.6894; train_gene_expr_recon_loss: 9871171.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23933.5740; train_chrom_access_recon_loss: 8614130.9167; train_global_loss: 21253612.7576; train_optim_loss: 21253612.7576; val_kl_reg_loss: 50935.4028; val_edge_recon_loss: 2723483.4375; val_gene_expr_recon_loss: 9837646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23995.0508; val_chrom_access_recon_loss: 8724987.1250; val_global_loss: 21361047.0000; val_optim_loss: 21361047.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9575; val_auprc_score: 0.9406; val_best_acc_score: 0.9068; val_best_f1_score: 0.9096; train_kl_reg_loss: 57380.8890; train_edge_recon_loss: 2676603.3939; train_gene_expr_recon_loss: 9857241.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23918.9913; train_chrom_access_recon_loss: 8597108.9773; train_global_loss: 21212254.2424; train_optim_loss: 21212254.2424; val_kl_reg_loss: 51245.8071; val_edge_recon_loss: 2700000.7500; val_gene_expr_recon_loss: 9806252.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23916.6367; val_chrom_access_recon_loss: 8670382.5000; val_global_loss: 21251798.5000; val_optim_loss: 21251798.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9546; val_auprc_score: 0.9376; val_best_acc_score: 0.9035; val_best_f1_score: 0.9075; train_kl_reg_loss: 56647.0938; train_edge_recon_loss: 2685572.5076; train_gene_expr_recon_loss: 9840499.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23910.2950; train_chrom_access_recon_loss: 8583388.8561; train_global_loss: 21190018.5152; train_optim_loss: 21190018.5152; val_kl_reg_loss: 51048.0737; val_edge_recon_loss: 2689062.8125; val_gene_expr_recon_loss: 9878256.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23914.3711; val_chrom_access_recon_loss: 8781698.5000; val_global_loss: 21423980.2500; val_optim_loss: 21423980.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9500; val_auprc_score: 0.9301; val_best_acc_score: 0.8987; val_best_f1_score: 0.9025; train_kl_reg_loss: 56354.0532; train_edge_recon_loss: 2674745.6856; train_gene_expr_recon_loss: 9817811.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23870.0201; train_chrom_access_recon_loss: 8571776.9848; train_global_loss: 21144558.5455; train_optim_loss: 21144558.5455; val_kl_reg_loss: 51355.8779; val_edge_recon_loss: 2702674.5000; val_gene_expr_recon_loss: 9800737.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23810.2461; val_chrom_access_recon_loss: 8621255.1250; val_global_loss: 21199832.7500; val_optim_loss: 21199832.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9507; val_auprc_score: 0.9251; val_best_acc_score: 0.9041; val_best_f1_score: 0.9084; train_kl_reg_loss: 55125.4622; train_edge_recon_loss: 2675998.5455; train_gene_expr_recon_loss: 9797511.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23802.0004; train_chrom_access_recon_loss: 8541626.6364; train_global_loss: 21094063.9394; train_optim_loss: 21094063.9394; val_kl_reg_loss: 51385.5688; val_edge_recon_loss: 2732395.6250; val_gene_expr_recon_loss: 9795844.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23799.7227; val_chrom_access_recon_loss: 8686473.6250; val_global_loss: 21289899.5000; val_optim_loss: 21289899.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9595; val_auprc_score: 0.9429; val_best_acc_score: 0.9089; val_best_f1_score: 0.9119; train_kl_reg_loss: 55788.1665; train_edge_recon_loss: 2669323.8598; train_gene_expr_recon_loss: 9791043.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23753.3470; train_chrom_access_recon_loss: 8543092.2045; train_global_loss: 21083001.0606; train_optim_loss: 21083001.0606; val_kl_reg_loss: 49831.5225; val_edge_recon_loss: 2694893.1562; val_gene_expr_recon_loss: 9826639.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23803.5645; val_chrom_access_recon_loss: 8707537.6250; val_global_loss: 21302705.7500; val_optim_loss: 21302705.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9566; val_auprc_score: 0.9407; val_best_acc_score: 0.9054; val_best_f1_score: 0.9082; train_kl_reg_loss: 54384.9502; train_edge_recon_loss: 2676406.8333; train_gene_expr_recon_loss: 9767864.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23812.0539; train_chrom_access_recon_loss: 8520730.4773; train_global_loss: 21043199.2121; train_optim_loss: 21043199.2121; val_kl_reg_loss: 49165.9434; val_edge_recon_loss: 2698974.3125; val_gene_expr_recon_loss: 9734449.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23765.0000; val_chrom_access_recon_loss: 8610932.8750; val_global_loss: 21117288.0000; val_optim_loss: 21117288.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9583; val_auprc_score: 0.9408; val_best_acc_score: 0.9087; val_best_f1_score: 0.9112; train_kl_reg_loss: 53078.2295; train_edge_recon_loss: 2669293.7803; train_gene_expr_recon_loss: 9765553.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23775.9738; train_chrom_access_recon_loss: 8519442.3333; train_global_loss: 21031144.0000; train_optim_loss: 21031144.0000; val_kl_reg_loss: 48940.4336; val_edge_recon_loss: 2685779.5000; val_gene_expr_recon_loss: 9644164.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23801.2207; val_chrom_access_recon_loss: 8522392.9375; val_global_loss: 20925079.0000; val_optim_loss: 20925079.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9535; val_auprc_score: 0.9342; val_best_acc_score: 0.9041; val_best_f1_score: 0.9083; train_kl_reg_loss: 52460.8771; train_edge_recon_loss: 2668636.7803; train_gene_expr_recon_loss: 9753556.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23801.6815; train_chrom_access_recon_loss: 8506740.4242; train_global_loss: 21005196.1818; train_optim_loss: 21005196.1818; val_kl_reg_loss: 49669.5962; val_edge_recon_loss: 2696556.7188; val_gene_expr_recon_loss: 9759705.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23741.3906; val_chrom_access_recon_loss: 8586490.1250; val_global_loss: 21116163.2500; val_optim_loss: 21116163.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9543; val_auprc_score: 0.9365; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 52209.4839; train_edge_recon_loss: 2667462.2159; train_gene_expr_recon_loss: 9735094.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23738.7019; train_chrom_access_recon_loss: 8482480.6061; train_global_loss: 20960985.2727; train_optim_loss: 20960985.2727; val_kl_reg_loss: 49903.3301; val_edge_recon_loss: 2673216.9062; val_gene_expr_recon_loss: 9769870.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23758.2969; val_chrom_access_recon_loss: 8561522.2500; val_global_loss: 21078271.2500; val_optim_loss: 21078271.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9613; val_auprc_score: 0.9455; val_best_acc_score: 0.9116; val_best_f1_score: 0.9150; train_kl_reg_loss: 51693.4924; train_edge_recon_loss: 2674840.8447; train_gene_expr_recon_loss: 9722535.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23723.0480; train_chrom_access_recon_loss: 8467596.4015; train_global_loss: 20940389.0000; train_optim_loss: 20940389.0000; val_kl_reg_loss: 49815.8535; val_edge_recon_loss: 2702074.1250; val_gene_expr_recon_loss: 9781493.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23751.2383; val_chrom_access_recon_loss: 8703943.6250; val_global_loss: 21261078.5000; val_optim_loss: 21261078.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9573; val_auprc_score: 0.9392; val_best_acc_score: 0.9081; val_best_f1_score: 0.9112; train_kl_reg_loss: 52059.7772; train_edge_recon_loss: 2660041.4280; train_gene_expr_recon_loss: 9710245.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23698.9361; train_chrom_access_recon_loss: 8454661.3712; train_global_loss: 20900707.5152; train_optim_loss: 20900707.5152; val_kl_reg_loss: 48679.4326; val_edge_recon_loss: 2706496.1875; val_gene_expr_recon_loss: 9668346.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23681.6465; val_chrom_access_recon_loss: 8545461.1875; val_global_loss: 20992664.7500; val_optim_loss: 20992664.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9540; val_auprc_score: 0.9359; val_best_acc_score: 0.9030; val_best_f1_score: 0.9073; train_kl_reg_loss: 51409.0034; train_edge_recon_loss: 2661730.0000; train_gene_expr_recon_loss: 9694975.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22032.8088; train_chrom_access_recon_loss: 8440763.3788; train_global_loss: 20870910.3030; train_optim_loss: 20870910.3030; val_kl_reg_loss: 49195.0449; val_edge_recon_loss: 2711730.2188; val_gene_expr_recon_loss: 9737426.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21660.1504; val_chrom_access_recon_loss: 8589044.4375; val_global_loss: 21109056.0000; val_optim_loss: 21109056.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9610; val_auprc_score: 0.9459; val_best_acc_score: 0.9116; val_best_f1_score: 0.9149; train_kl_reg_loss: 51911.4264; train_edge_recon_loss: 2665410.0265; train_gene_expr_recon_loss: 9692797.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21597.1050; train_chrom_access_recon_loss: 8443339.0833; train_global_loss: 20875054.4848; train_optim_loss: 20875054.4848; val_kl_reg_loss: 49232.4722; val_edge_recon_loss: 2688907.2188; val_gene_expr_recon_loss: 9739171.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21543.8047; val_chrom_access_recon_loss: 8606707.4375; val_global_loss: 21105562.2500; val_optim_loss: 21105562.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9528; val_auprc_score: 0.9313; val_best_acc_score: 0.9054; val_best_f1_score: 0.9107; train_kl_reg_loss: 52017.8461; train_edge_recon_loss: 2658835.1288; train_gene_expr_recon_loss: 9685567.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21509.5864; train_chrom_access_recon_loss: 8424326.5909; train_global_loss: 20842256.1515; train_optim_loss: 20842256.1515; val_kl_reg_loss: 49201.7588; val_edge_recon_loss: 2693655.4062; val_gene_expr_recon_loss: 9667266.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21474.8418; val_chrom_access_recon_loss: 8514997.8750; val_global_loss: 20946597.2500; val_optim_loss: 20946597.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9602; val_auprc_score: 0.9441; val_best_acc_score: 0.9095; val_best_f1_score: 0.9132; train_kl_reg_loss: 51879.2851; train_edge_recon_loss: 2665349.8788; train_gene_expr_recon_loss: 9683431.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21447.3230; train_chrom_access_recon_loss: 8423867.9394; train_global_loss: 20845975.9697; train_optim_loss: 20845975.9697; val_kl_reg_loss: 49455.5576; val_edge_recon_loss: 2697186.5938; val_gene_expr_recon_loss: 9697325.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21426.2598; val_chrom_access_recon_loss: 8540209.0625; val_global_loss: 21005602.7500; val_optim_loss: 21005602.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 11 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9563
val AUPRC score: 0.9421
val best accuracy score: 0.9030
val best F1 score: 0.9050
val target rna MSE score: 1.3560
val source rna MSE score: 0.3958
val target atac MSE score: 0.3270
val source atac MSE score: 0.0710
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
