[True]
Run timestamp: 10102023_120119_256.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_256']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6479; val_auprc_score: 0.6423; val_best_acc_score: 0.5035; val_best_f1_score: 0.6679; train_kl_reg_loss: 52227.9701; train_edge_recon_loss: 750607.1960; train_gene_expr_recon_loss: 23281380.9091; train_masked_gp_l1_reg_loss: 161307.2474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5001853.5000; train_chrom_access_recon_loss: 11582588.7879; train_global_loss: 40829965.6970; train_optim_loss: 40829965.6970; val_kl_reg_loss: 82896.9873; val_edge_recon_loss: 813049.3516; val_gene_expr_recon_loss: 21487612.5000; val_masked_gp_l1_reg_loss: 125541.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2816727.5000; val_chrom_access_recon_loss: 11146280.1250; val_global_loss: 36472108.0000; val_optim_loss: 36472108.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7037; val_auprc_score: 0.6821; val_best_acc_score: 0.5658; val_best_f1_score: 0.6918; train_kl_reg_loss: 91550.1207; train_edge_recon_loss: 751054.9148; train_gene_expr_recon_loss: 21327171.8788; train_masked_gp_l1_reg_loss: 114877.5204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1548583.1449; train_chrom_access_recon_loss: 11002095.9242; train_global_loss: 34835333.4848; train_optim_loss: 34835333.4848; val_kl_reg_loss: 87505.1895; val_edge_recon_loss: 812389.8828; val_gene_expr_recon_loss: 20942647.0000; val_masked_gp_l1_reg_loss: 109149.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 754789.0625; val_chrom_access_recon_loss: 11003202.5000; val_global_loss: 33709684.5000; val_optim_loss: 33709684.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7695; val_auprc_score: 0.7588; val_best_acc_score: 0.6677; val_best_f1_score: 0.7258; train_kl_reg_loss: 86787.5882; train_edge_recon_loss: 741341.4432; train_gene_expr_recon_loss: 21093372.3030; train_masked_gp_l1_reg_loss: 106204.3094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 500844.6766; train_chrom_access_recon_loss: 10924508.9697; train_global_loss: 33453059.3939; train_optim_loss: 33453059.3939; val_kl_reg_loss: 79556.9492; val_edge_recon_loss: 810564.4297; val_gene_expr_recon_loss: 20676791.7500; val_masked_gp_l1_reg_loss: 104280.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 334403.1875; val_chrom_access_recon_loss: 10952720.3750; val_global_loss: 32958317.2500; val_optim_loss: 32958317.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8451; val_auprc_score: 0.8262; val_best_acc_score: 0.7273; val_best_f1_score: 0.7609; train_kl_reg_loss: 80368.0521; train_edge_recon_loss: 734900.2926; train_gene_expr_recon_loss: 20938964.0606; train_masked_gp_l1_reg_loss: 104150.3011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 262351.6286; train_chrom_access_recon_loss: 10834610.2273; train_global_loss: 32955344.5455; train_optim_loss: 32955344.5455; val_kl_reg_loss: 76302.9756; val_edge_recon_loss: 799122.2578; val_gene_expr_recon_loss: 20592794.7500; val_masked_gp_l1_reg_loss: 104294.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208957.5156; val_chrom_access_recon_loss: 10940280.5000; val_global_loss: 32721752.7500; val_optim_loss: 32721752.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8683; val_auprc_score: 0.8364; val_best_acc_score: 0.7982; val_best_f1_score: 0.8130; train_kl_reg_loss: 74404.1764; train_edge_recon_loss: 726022.2907; train_gene_expr_recon_loss: 20792833.9091; train_masked_gp_l1_reg_loss: 105243.7927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182553.6269; train_chrom_access_recon_loss: 10772287.3939; train_global_loss: 32653345.0303; train_optim_loss: 32653345.0303; val_kl_reg_loss: 69625.1104; val_edge_recon_loss: 764375.1016; val_gene_expr_recon_loss: 20449309.0000; val_masked_gp_l1_reg_loss: 106135.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163221.0938; val_chrom_access_recon_loss: 10839435.0000; val_global_loss: 32392102.0000; val_optim_loss: 32392102.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8793; val_auprc_score: 0.8471; val_best_acc_score: 0.8095; val_best_f1_score: 0.8289; train_kl_reg_loss: 70596.2404; train_edge_recon_loss: 700248.7727; train_gene_expr_recon_loss: 20662608.7273; train_masked_gp_l1_reg_loss: 107524.3374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151370.3906; train_chrom_access_recon_loss: 10715118.4545; train_global_loss: 32407467.2121; train_optim_loss: 32407467.2121; val_kl_reg_loss: 72549.5498; val_edge_recon_loss: 684461.8828; val_gene_expr_recon_loss: 20559308.5000; val_masked_gp_l1_reg_loss: 109326.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141999.7656; val_chrom_access_recon_loss: 10841053.1250; val_global_loss: 32408698.7500; val_optim_loss: 32408698.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8717; val_auprc_score: 0.8274; val_best_acc_score: 0.8039; val_best_f1_score: 0.8210; train_kl_reg_loss: 79497.6942; train_edge_recon_loss: 657074.4545; train_gene_expr_recon_loss: 20527455.3030; train_masked_gp_l1_reg_loss: 110307.3365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134783.6171; train_chrom_access_recon_loss: 10654851.3030; train_global_loss: 32163969.8182; train_optim_loss: 32163969.8182; val_kl_reg_loss: 80046.0186; val_edge_recon_loss: 646673.8516; val_gene_expr_recon_loss: 20315215.5000; val_masked_gp_l1_reg_loss: 111561.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128010.0703; val_chrom_access_recon_loss: 10795978.0000; val_global_loss: 32077485.7500; val_optim_loss: 32077485.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8904; val_auprc_score: 0.8578; val_best_acc_score: 0.8178; val_best_f1_score: 0.8353; train_kl_reg_loss: 83555.0688; train_edge_recon_loss: 635247.8703; train_gene_expr_recon_loss: 20443309.6061; train_masked_gp_l1_reg_loss: 112151.4954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122406.8563; train_chrom_access_recon_loss: 10623094.9091; train_global_loss: 32019765.8788; train_optim_loss: 32019765.8788; val_kl_reg_loss: 84323.9785; val_edge_recon_loss: 635283.8516; val_gene_expr_recon_loss: 20083526.0000; val_masked_gp_l1_reg_loss: 112850.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117014.7109; val_chrom_access_recon_loss: 10571530.3750; val_global_loss: 31604528.0000; val_optim_loss: 31604528.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9016; val_auprc_score: 0.8797; val_best_acc_score: 0.8289; val_best_f1_score: 0.8446; train_kl_reg_loss: 83366.0543; train_edge_recon_loss: 628609.7386; train_gene_expr_recon_loss: 20355518.0303; train_masked_gp_l1_reg_loss: 113260.0470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112885.0874; train_chrom_access_recon_loss: 10582900.5758; train_global_loss: 31876539.5152; train_optim_loss: 31876539.5152; val_kl_reg_loss: 82714.9053; val_edge_recon_loss: 622651.2734; val_gene_expr_recon_loss: 19999487.0000; val_masked_gp_l1_reg_loss: 113922.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108935.6406; val_chrom_access_recon_loss: 10727717.8750; val_global_loss: 31655429.2500; val_optim_loss: 31655429.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8873; val_auprc_score: 0.8581; val_best_acc_score: 0.8149; val_best_f1_score: 0.8349; train_kl_reg_loss: 82375.4634; train_edge_recon_loss: 622959.4697; train_gene_expr_recon_loss: 20267076.5758; train_masked_gp_l1_reg_loss: 114465.6418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106134.1125; train_chrom_access_recon_loss: 10541685.7121; train_global_loss: 31734697.1212; train_optim_loss: 31734697.1212; val_kl_reg_loss: 82260.6553; val_edge_recon_loss: 628599.3203; val_gene_expr_recon_loss: 19939364.2500; val_masked_gp_l1_reg_loss: 114849.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102621.3203; val_chrom_access_recon_loss: 10555558.8750; val_global_loss: 31423255.0000; val_optim_loss: 31423255.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9006; val_auprc_score: 0.8718; val_best_acc_score: 0.8286; val_best_f1_score: 0.8436; train_kl_reg_loss: 80639.6918; train_edge_recon_loss: 622908.9309; train_gene_expr_recon_loss: 20202204.7273; train_masked_gp_l1_reg_loss: 115460.5792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100223.4360; train_chrom_access_recon_loss: 10497714.6364; train_global_loss: 31619152.1212; train_optim_loss: 31619152.1212; val_kl_reg_loss: 80034.8926; val_edge_recon_loss: 623398.7188; val_gene_expr_recon_loss: 19902015.0000; val_masked_gp_l1_reg_loss: 115900.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98651.7969; val_chrom_access_recon_loss: 10610885.0000; val_global_loss: 31430885.7500; val_optim_loss: 31430885.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9050; val_auprc_score: 0.8783; val_best_acc_score: 0.8385; val_best_f1_score: 0.8501; train_kl_reg_loss: 80235.8372; train_edge_recon_loss: 616676.3163; train_gene_expr_recon_loss: 20122464.9394; train_masked_gp_l1_reg_loss: 116193.3685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96354.8472; train_chrom_access_recon_loss: 10469507.5758; train_global_loss: 31501432.7879; train_optim_loss: 31501432.7879; val_kl_reg_loss: 80112.0840; val_edge_recon_loss: 621403.3359; val_gene_expr_recon_loss: 19925270.5000; val_masked_gp_l1_reg_loss: 116598.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94445.6016; val_chrom_access_recon_loss: 10535386.2500; val_global_loss: 31373216.5000; val_optim_loss: 31373216.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9082; val_auprc_score: 0.8814; val_best_acc_score: 0.8407; val_best_f1_score: 0.8495; train_kl_reg_loss: 79441.6065; train_edge_recon_loss: 613374.5549; train_gene_expr_recon_loss: 20047117.6061; train_masked_gp_l1_reg_loss: 116951.3140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93033.0935; train_chrom_access_recon_loss: 10420674.3939; train_global_loss: 31370592.6364; train_optim_loss: 31370592.6364; val_kl_reg_loss: 78716.5742; val_edge_recon_loss: 616297.8672; val_gene_expr_recon_loss: 19692014.7500; val_masked_gp_l1_reg_loss: 117404.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92037.9219; val_chrom_access_recon_loss: 10471354.7500; val_global_loss: 31067825.7500; val_optim_loss: 31067825.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9106; val_auprc_score: 0.8907; val_best_acc_score: 0.8366; val_best_f1_score: 0.8526; train_kl_reg_loss: 78015.2920; train_edge_recon_loss: 613457.6477; train_gene_expr_recon_loss: 19996578.1818; train_masked_gp_l1_reg_loss: 117712.7223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90741.2699; train_chrom_access_recon_loss: 10391960.3030; train_global_loss: 31288465.3636; train_optim_loss: 31288465.3636; val_kl_reg_loss: 76921.1719; val_edge_recon_loss: 617011.8516; val_gene_expr_recon_loss: 19816037.0000; val_masked_gp_l1_reg_loss: 118062.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89469.3203; val_chrom_access_recon_loss: 10511523.7500; val_global_loss: 31229025.7500; val_optim_loss: 31229025.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9012; val_auprc_score: 0.8728; val_best_acc_score: 0.8246; val_best_f1_score: 0.8379; train_kl_reg_loss: 77820.8860; train_edge_recon_loss: 609738.3892; train_gene_expr_recon_loss: 19932855.0303; train_masked_gp_l1_reg_loss: 118227.9445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88402.2099; train_chrom_access_recon_loss: 10362167.8939; train_global_loss: 31189212.1515; train_optim_loss: 31189212.1515; val_kl_reg_loss: 74736.9893; val_edge_recon_loss: 622510.5469; val_gene_expr_recon_loss: 19612186.5000; val_masked_gp_l1_reg_loss: 118861.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87948.2422; val_chrom_access_recon_loss: 10485741.8750; val_global_loss: 31001985.7500; val_optim_loss: 31001985.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9173; val_auprc_score: 0.8989; val_best_acc_score: 0.8393; val_best_f1_score: 0.8540; train_kl_reg_loss: 76872.9266; train_edge_recon_loss: 606354.9451; train_gene_expr_recon_loss: 19873712.7879; train_masked_gp_l1_reg_loss: 118920.5163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87057.6286; train_chrom_access_recon_loss: 10326498.4394; train_global_loss: 31089417.1818; train_optim_loss: 31089417.1818; val_kl_reg_loss: 75418.3193; val_edge_recon_loss: 611386.9453; val_gene_expr_recon_loss: 19582378.5000; val_masked_gp_l1_reg_loss: 119176.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86351.3125; val_chrom_access_recon_loss: 10348414.6250; val_global_loss: 30823126.7500; val_optim_loss: 30823126.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9158; val_auprc_score: 0.8915; val_best_acc_score: 0.8426; val_best_f1_score: 0.8515; train_kl_reg_loss: 75874.7512; train_edge_recon_loss: 609650.6487; train_gene_expr_recon_loss: 19826512.9091; train_masked_gp_l1_reg_loss: 119348.3393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85852.9549; train_chrom_access_recon_loss: 10294200.6667; train_global_loss: 31011440.2121; train_optim_loss: 31011440.2121; val_kl_reg_loss: 74843.9199; val_edge_recon_loss: 614851.6953; val_gene_expr_recon_loss: 19753753.0000; val_masked_gp_l1_reg_loss: 119757.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85435.7266; val_chrom_access_recon_loss: 10501143.7500; val_global_loss: 31149786.2500; val_optim_loss: 31149786.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9195; val_auprc_score: 0.8937; val_best_acc_score: 0.8471; val_best_f1_score: 0.8573; train_kl_reg_loss: 75299.9772; train_edge_recon_loss: 605665.3021; train_gene_expr_recon_loss: 19785033.1818; train_masked_gp_l1_reg_loss: 119888.2544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84713.0083; train_chrom_access_recon_loss: 10269527.3333; train_global_loss: 30940127.0000; train_optim_loss: 30940127.0000; val_kl_reg_loss: 75925.8662; val_edge_recon_loss: 607203.8984; val_gene_expr_recon_loss: 19761089.7500; val_masked_gp_l1_reg_loss: 120486.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84810.8516; val_chrom_access_recon_loss: 10389696.7500; val_global_loss: 31039212.0000; val_optim_loss: 31039212.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9205; val_auprc_score: 0.8965; val_best_acc_score: 0.8538; val_best_f1_score: 0.8577; train_kl_reg_loss: 74814.9080; train_edge_recon_loss: 604741.6648; train_gene_expr_recon_loss: 19738455.0000; train_masked_gp_l1_reg_loss: 120706.3455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84275.7182; train_chrom_access_recon_loss: 10228088.4848; train_global_loss: 30851081.9091; train_optim_loss: 30851081.9091; val_kl_reg_loss: 75922.0625; val_edge_recon_loss: 607724.2656; val_gene_expr_recon_loss: 19364031.7500; val_masked_gp_l1_reg_loss: 121064.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83869.9609; val_chrom_access_recon_loss: 10240947.1250; val_global_loss: 30493558.5000; val_optim_loss: 30493558.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9192; val_auprc_score: 0.8963; val_best_acc_score: 0.8517; val_best_f1_score: 0.8589; train_kl_reg_loss: 74265.9944; train_edge_recon_loss: 604009.5076; train_gene_expr_recon_loss: 19694715.4848; train_masked_gp_l1_reg_loss: 121178.5677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83950.5691; train_chrom_access_recon_loss: 10200929.4545; train_global_loss: 30779049.3939; train_optim_loss: 30779049.3939; val_kl_reg_loss: 75255.2422; val_edge_recon_loss: 611584.2969; val_gene_expr_recon_loss: 19470436.2500; val_masked_gp_l1_reg_loss: 121686.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84208.1953; val_chrom_access_recon_loss: 10362308.6250; val_global_loss: 30725478.5000; val_optim_loss: 30725478.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9331; val_auprc_score: 0.9132; val_best_acc_score: 0.8622; val_best_f1_score: 0.8684; train_kl_reg_loss: 73886.6181; train_edge_recon_loss: 601196.4545; train_gene_expr_recon_loss: 19628468.0606; train_masked_gp_l1_reg_loss: 121720.1745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84108.6294; train_chrom_access_recon_loss: 10156530.5000; train_global_loss: 30665910.7879; train_optim_loss: 30665910.7879; val_kl_reg_loss: 73918.5195; val_edge_recon_loss: 598221.3828; val_gene_expr_recon_loss: 19438338.7500; val_masked_gp_l1_reg_loss: 121869.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83879.2812; val_chrom_access_recon_loss: 10176099.1250; val_global_loss: 30492327.7500; val_optim_loss: 30492327.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9265; val_auprc_score: 0.9068; val_best_acc_score: 0.8579; val_best_f1_score: 0.8646; train_kl_reg_loss: 73582.9831; train_edge_recon_loss: 601606.9811; train_gene_expr_recon_loss: 19587436.2121; train_masked_gp_l1_reg_loss: 122180.9029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84351.1209; train_chrom_access_recon_loss: 10134551.7727; train_global_loss: 30603710.0909; train_optim_loss: 30603710.0909; val_kl_reg_loss: 73349.1729; val_edge_recon_loss: 605498.9844; val_gene_expr_recon_loss: 19484178.0000; val_masked_gp_l1_reg_loss: 122446.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85067.5859; val_chrom_access_recon_loss: 10220135.2500; val_global_loss: 30590675.2500; val_optim_loss: 30590675.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9240; val_auprc_score: 0.8997; val_best_acc_score: 0.8538; val_best_f1_score: 0.8632; train_kl_reg_loss: 72959.5491; train_edge_recon_loss: 601842.5218; train_gene_expr_recon_loss: 19558820.8788; train_masked_gp_l1_reg_loss: 122765.2235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84850.6238; train_chrom_access_recon_loss: 10102886.9697; train_global_loss: 30544125.6364; train_optim_loss: 30544125.6364; val_kl_reg_loss: 71775.2529; val_edge_recon_loss: 606199.9844; val_gene_expr_recon_loss: 19458461.2500; val_masked_gp_l1_reg_loss: 123316.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85740.6172; val_chrom_access_recon_loss: 10303410.5000; val_global_loss: 30648903.0000; val_optim_loss: 30648903.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9286; val_auprc_score: 0.9090; val_best_acc_score: 0.8624; val_best_f1_score: 0.8691; train_kl_reg_loss: 72765.3556; train_edge_recon_loss: 599991.6837; train_gene_expr_recon_loss: 19505667.6061; train_masked_gp_l1_reg_loss: 123483.9408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85414.0891; train_chrom_access_recon_loss: 10066766.8030; train_global_loss: 30454089.6667; train_optim_loss: 30454089.6667; val_kl_reg_loss: 71696.8486; val_edge_recon_loss: 603802.1406; val_gene_expr_recon_loss: 19308844.7500; val_masked_gp_l1_reg_loss: 123666.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86022.9531; val_chrom_access_recon_loss: 10157234.6250; val_global_loss: 30351266.5000; val_optim_loss: 30351266.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9287; val_auprc_score: 0.9092; val_best_acc_score: 0.8622; val_best_f1_score: 0.8697; train_kl_reg_loss: 72202.2005; train_edge_recon_loss: 599888.1108; train_gene_expr_recon_loss: 19456111.2727; train_masked_gp_l1_reg_loss: 123994.0082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86007.3205; train_chrom_access_recon_loss: 10022401.2424; train_global_loss: 30360604.2424; train_optim_loss: 30360604.2424; val_kl_reg_loss: 71855.3105; val_edge_recon_loss: 605845.1016; val_gene_expr_recon_loss: 19371749.2500; val_masked_gp_l1_reg_loss: 124253.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86430.7969; val_chrom_access_recon_loss: 10060524.6250; val_global_loss: 30320658.2500; val_optim_loss: 30320658.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8587; val_auprc_score: 0.8291; val_best_acc_score: 0.7652; val_best_f1_score: 0.7512; train_kl_reg_loss: 40065.5289; train_edge_recon_loss: 778214.9062; train_gene_expr_recon_loss: 18397483.7576; train_masked_gp_l1_reg_loss: 123553.9638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87622.4151; train_chrom_access_recon_loss: 9631606.5152; train_global_loss: 29058547.0606; train_optim_loss: 29058547.0606; val_kl_reg_loss: 16670.0615; val_edge_recon_loss: 800909.9453; val_gene_expr_recon_loss: 18038016.0000; val_masked_gp_l1_reg_loss: 123134.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94360.2109; val_chrom_access_recon_loss: 9504809.8750; val_global_loss: 28577900.0000; val_optim_loss: 28577900.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8662; val_auprc_score: 0.8356; val_best_acc_score: 0.7762; val_best_f1_score: 0.8064; train_kl_reg_loss: 24982.8981; train_edge_recon_loss: 786432.6155; train_gene_expr_recon_loss: 18085533.2727; train_masked_gp_l1_reg_loss: 118435.0078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95231.0372; train_chrom_access_recon_loss: 9459975.0606; train_global_loss: 28570589.6061; train_optim_loss: 28570589.6061; val_kl_reg_loss: 16843.5273; val_edge_recon_loss: 793614.0156; val_gene_expr_recon_loss: 17988950.2500; val_masked_gp_l1_reg_loss: 114096.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95043.6484; val_chrom_access_recon_loss: 9592310.2500; val_global_loss: 28600857.7500; val_optim_loss: 28600857.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8773; val_auprc_score: 0.8479; val_best_acc_score: 0.8041; val_best_f1_score: 0.8208; train_kl_reg_loss: 24720.8397; train_edge_recon_loss: 785056.2244; train_gene_expr_recon_loss: 18007471.3030; train_masked_gp_l1_reg_loss: 111002.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93611.6664; train_chrom_access_recon_loss: 9426003.0758; train_global_loss: 28447865.5758; train_optim_loss: 28447865.5758; val_kl_reg_loss: 16976.0774; val_edge_recon_loss: 780642.5469; val_gene_expr_recon_loss: 17635986.5000; val_masked_gp_l1_reg_loss: 108213.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92259.6719; val_chrom_access_recon_loss: 9372322.5000; val_global_loss: 28006401.7500; val_optim_loss: 28006401.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8832; val_auprc_score: 0.8527; val_best_acc_score: 0.8157; val_best_f1_score: 0.8261; train_kl_reg_loss: 25493.7333; train_edge_recon_loss: 769460.6364; train_gene_expr_recon_loss: 17934391.1515; train_masked_gp_l1_reg_loss: 106527.9119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90689.9375; train_chrom_access_recon_loss: 9393996.6061; train_global_loss: 28320559.9697; train_optim_loss: 28320559.9697; val_kl_reg_loss: 18829.5247; val_edge_recon_loss: 764295.1016; val_gene_expr_recon_loss: 17790907.2500; val_masked_gp_l1_reg_loss: 105140.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88545.5391; val_chrom_access_recon_loss: 9433134.2500; val_global_loss: 28200852.0000; val_optim_loss: 28200852.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8967; val_auprc_score: 0.8693; val_best_acc_score: 0.8248; val_best_f1_score: 0.8377; train_kl_reg_loss: 27215.5581; train_edge_recon_loss: 746202.8324; train_gene_expr_recon_loss: 17926938.6061; train_masked_gp_l1_reg_loss: 104286.2306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87786.9111; train_chrom_access_recon_loss: 9380287.8030; train_global_loss: 28272717.9394; train_optim_loss: 28272717.9394; val_kl_reg_loss: 20054.0635; val_edge_recon_loss: 735310.0625; val_gene_expr_recon_loss: 17581240.0000; val_masked_gp_l1_reg_loss: 103561.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86504.0625; val_chrom_access_recon_loss: 9387988.5000; val_global_loss: 27914658.7500; val_optim_loss: 27914658.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8851; val_auprc_score: 0.8516; val_best_acc_score: 0.8178; val_best_f1_score: 0.8309; train_kl_reg_loss: 26912.7762; train_edge_recon_loss: 734311.3049; train_gene_expr_recon_loss: 17881393.6364; train_masked_gp_l1_reg_loss: 102909.3919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86815.9476; train_chrom_access_recon_loss: 9363371.3788; train_global_loss: 28195714.5758; train_optim_loss: 28195714.5758; val_kl_reg_loss: 21643.3293; val_edge_recon_loss: 715076.3750; val_gene_expr_recon_loss: 17571564.7500; val_masked_gp_l1_reg_loss: 102186.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84991.1562; val_chrom_access_recon_loss: 9391398.0000; val_global_loss: 27886860.0000; val_optim_loss: 27886860.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8765; val_auprc_score: 0.8403; val_best_acc_score: 0.8033; val_best_f1_score: 0.8223; train_kl_reg_loss: 31190.5770; train_edge_recon_loss: 697640.7453; train_gene_expr_recon_loss: 17828356.1818; train_masked_gp_l1_reg_loss: 101674.3956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83390.7280; train_chrom_access_recon_loss: 9353102.0152; train_global_loss: 28095354.6667; train_optim_loss: 28095354.6667; val_kl_reg_loss: 24497.8901; val_edge_recon_loss: 691013.2969; val_gene_expr_recon_loss: 17635623.7500; val_masked_gp_l1_reg_loss: 101216.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82044.5078; val_chrom_access_recon_loss: 9371284.3750; val_global_loss: 27905679.0000; val_optim_loss: 27905679.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8805; val_auprc_score: 0.8486; val_best_acc_score: 0.8017; val_best_f1_score: 0.8210; train_kl_reg_loss: 34303.4224; train_edge_recon_loss: 671549.2841; train_gene_expr_recon_loss: 17797966.0606; train_masked_gp_l1_reg_loss: 101307.5049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80795.9079; train_chrom_access_recon_loss: 9342196.6061; train_global_loss: 28028118.7576; train_optim_loss: 28028118.7576; val_kl_reg_loss: 27738.4072; val_edge_recon_loss: 664196.6641; val_gene_expr_recon_loss: 17534216.7500; val_masked_gp_l1_reg_loss: 101341.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79981.0156; val_chrom_access_recon_loss: 9394313.5000; val_global_loss: 27801789.5000; val_optim_loss: 27801789.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8716; val_auprc_score: 0.8382; val_best_acc_score: 0.7950; val_best_f1_score: 0.8174; train_kl_reg_loss: 37023.8558; train_edge_recon_loss: 649362.8163; train_gene_expr_recon_loss: 17777507.6364; train_masked_gp_l1_reg_loss: 101456.9048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79212.1365; train_chrom_access_recon_loss: 9332928.7121; train_global_loss: 27977492.0909; train_optim_loss: 27977492.0909; val_kl_reg_loss: 33398.0234; val_edge_recon_loss: 639174.7109; val_gene_expr_recon_loss: 17504996.0000; val_masked_gp_l1_reg_loss: 101374.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78394.1719; val_chrom_access_recon_loss: 9377207.3750; val_global_loss: 27734544.2500; val_optim_loss: 27734544.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8604; val_auprc_score: 0.8267; val_best_acc_score: 0.7834; val_best_f1_score: 0.8085; train_kl_reg_loss: 40673.5605; train_edge_recon_loss: 630174.4081; train_gene_expr_recon_loss: 17745311.0909; train_masked_gp_l1_reg_loss: 101263.1726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77830.8245; train_chrom_access_recon_loss: 9321305.9697; train_global_loss: 27916559.0303; train_optim_loss: 27916559.0303; val_kl_reg_loss: 38744.0723; val_edge_recon_loss: 633798.6875; val_gene_expr_recon_loss: 17454507.0000; val_masked_gp_l1_reg_loss: 101037.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77364.0625; val_chrom_access_recon_loss: 9314640.3750; val_global_loss: 27620092.0000; val_optim_loss: 27620092.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8633; val_auprc_score: 0.8235; val_best_acc_score: 0.7891; val_best_f1_score: 0.8124; train_kl_reg_loss: 44487.3083; train_edge_recon_loss: 617898.9631; train_gene_expr_recon_loss: 17707804.7576; train_masked_gp_l1_reg_loss: 100839.0919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76670.5868; train_chrom_access_recon_loss: 9300597.1364; train_global_loss: 27848297.8788; train_optim_loss: 27848297.8788; val_kl_reg_loss: 42851.1763; val_edge_recon_loss: 622048.8359; val_gene_expr_recon_loss: 17437104.5000; val_masked_gp_l1_reg_loss: 100775.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76212.1562; val_chrom_access_recon_loss: 9373541.3750; val_global_loss: 27652534.0000; val_optim_loss: 27652534.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8643; val_auprc_score: 0.8302; val_best_acc_score: 0.7861; val_best_f1_score: 0.8104; train_kl_reg_loss: 46775.3459; train_edge_recon_loss: 613422.6023; train_gene_expr_recon_loss: 17682303.6364; train_masked_gp_l1_reg_loss: 100167.8343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75913.6722; train_chrom_access_recon_loss: 9284215.9545; train_global_loss: 27802799.1818; train_optim_loss: 27802799.1818; val_kl_reg_loss: 44531.4360; val_edge_recon_loss: 622389.2344; val_gene_expr_recon_loss: 17341202.0000; val_masked_gp_l1_reg_loss: 100029.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75375.6328; val_chrom_access_recon_loss: 9260910.0000; val_global_loss: 27444439.0000; val_optim_loss: 27444439.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8665; val_auprc_score: 0.8249; val_best_acc_score: 0.7974; val_best_f1_score: 0.8199; train_kl_reg_loss: 47443.4450; train_edge_recon_loss: 612727.8807; train_gene_expr_recon_loss: 17662486.2121; train_masked_gp_l1_reg_loss: 99649.4396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75099.7264; train_chrom_access_recon_loss: 9273346.4848; train_global_loss: 27770753.2727; train_optim_loss: 27770753.2727; val_kl_reg_loss: 45558.9692; val_edge_recon_loss: 607415.8047; val_gene_expr_recon_loss: 17453156.5000; val_masked_gp_l1_reg_loss: 99342.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74888.7734; val_chrom_access_recon_loss: 9438067.2500; val_global_loss: 27718428.5000; val_optim_loss: 27718428.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8613; val_auprc_score: 0.8177; val_best_acc_score: 0.7902; val_best_f1_score: 0.8155; train_kl_reg_loss: 48343.8043; train_edge_recon_loss: 610627.3400; train_gene_expr_recon_loss: 17622555.6212; train_masked_gp_l1_reg_loss: 99002.1825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74390.6153; train_chrom_access_recon_loss: 9247533.1364; train_global_loss: 27702452.7273; train_optim_loss: 27702452.7273; val_kl_reg_loss: 45630.3032; val_edge_recon_loss: 616121.2109; val_gene_expr_recon_loss: 17369649.0000; val_masked_gp_l1_reg_loss: 98796.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74172.6953; val_chrom_access_recon_loss: 9257391.0000; val_global_loss: 27461759.2500; val_optim_loss: 27461759.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8718; val_auprc_score: 0.8429; val_best_acc_score: 0.7961; val_best_f1_score: 0.8207; train_kl_reg_loss: 48116.1441; train_edge_recon_loss: 611410.5104; train_gene_expr_recon_loss: 17596436.0758; train_masked_gp_l1_reg_loss: 98453.8858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73824.0456; train_chrom_access_recon_loss: 9230687.6970; train_global_loss: 27658928.1818; train_optim_loss: 27658928.1818; val_kl_reg_loss: 46469.4272; val_edge_recon_loss: 609032.2969; val_gene_expr_recon_loss: 17515934.0000; val_masked_gp_l1_reg_loss: 98305.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73519.3984; val_chrom_access_recon_loss: 9403081.0000; val_global_loss: 27746342.2500; val_optim_loss: 27746342.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8672; val_auprc_score: 0.8309; val_best_acc_score: 0.7920; val_best_f1_score: 0.8176; train_kl_reg_loss: 48768.4041; train_edge_recon_loss: 610110.5890; train_gene_expr_recon_loss: 17571745.9091; train_masked_gp_l1_reg_loss: 98017.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73111.0675; train_chrom_access_recon_loss: 9210475.3030; train_global_loss: 27612228.6364; train_optim_loss: 27612228.6364; val_kl_reg_loss: 46102.5645; val_edge_recon_loss: 612915.0391; val_gene_expr_recon_loss: 17267719.3750; val_masked_gp_l1_reg_loss: 97731.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72806.8906; val_chrom_access_recon_loss: 9253262.2500; val_global_loss: 27350537.0000; val_optim_loss: 27350537.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8698; val_auprc_score: 0.8388; val_best_acc_score: 0.7929; val_best_f1_score: 0.8158; train_kl_reg_loss: 49129.5165; train_edge_recon_loss: 607339.4877; train_gene_expr_recon_loss: 17559731.3182; train_masked_gp_l1_reg_loss: 97532.3121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72566.3969; train_chrom_access_recon_loss: 9201763.4848; train_global_loss: 27588062.6970; train_optim_loss: 27588062.6970; val_kl_reg_loss: 47253.6470; val_edge_recon_loss: 614280.3594; val_gene_expr_recon_loss: 17198824.5000; val_masked_gp_l1_reg_loss: 97284.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72300.0391; val_chrom_access_recon_loss: 9193551.3750; val_global_loss: 27223493.7500; val_optim_loss: 27223493.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8687; val_auprc_score: 0.8300; val_best_acc_score: 0.7963; val_best_f1_score: 0.8223; train_kl_reg_loss: 49320.2688; train_edge_recon_loss: 608873.9403; train_gene_expr_recon_loss: 17518353.2273; train_masked_gp_l1_reg_loss: 97248.8724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71993.9673; train_chrom_access_recon_loss: 9182981.1667; train_global_loss: 27528771.6061; train_optim_loss: 27528771.6061; val_kl_reg_loss: 45952.8916; val_edge_recon_loss: 611125.4922; val_gene_expr_recon_loss: 17324390.0000; val_masked_gp_l1_reg_loss: 97137.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71765.7422; val_chrom_access_recon_loss: 9279582.5000; val_global_loss: 27429954.5000; val_optim_loss: 27429954.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8607; val_auprc_score: 0.8294; val_best_acc_score: 0.7851; val_best_f1_score: 0.8108; train_kl_reg_loss: 49680.8450; train_edge_recon_loss: 608333.1316; train_gene_expr_recon_loss: 17501393.2727; train_masked_gp_l1_reg_loss: 96982.4735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71395.2044; train_chrom_access_recon_loss: 9169854.1212; train_global_loss: 27497639.0909; train_optim_loss: 27497639.0909; val_kl_reg_loss: 46880.3042; val_edge_recon_loss: 623924.5000; val_gene_expr_recon_loss: 17275340.5000; val_masked_gp_l1_reg_loss: 96951.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70863.3047; val_chrom_access_recon_loss: 9253795.0000; val_global_loss: 27367757.2500; val_optim_loss: 27367757.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8707; val_auprc_score: 0.8376; val_best_acc_score: 0.7961; val_best_f1_score: 0.8188; train_kl_reg_loss: 49937.6487; train_edge_recon_loss: 602685.9735; train_gene_expr_recon_loss: 17487983.3788; train_masked_gp_l1_reg_loss: 96812.2359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70830.0433; train_chrom_access_recon_loss: 9160998.7121; train_global_loss: 27469248.0000; train_optim_loss: 27469248.0000; val_kl_reg_loss: 47654.4766; val_edge_recon_loss: 608046.4922; val_gene_expr_recon_loss: 17235711.6250; val_masked_gp_l1_reg_loss: 96786.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70668.4844; val_chrom_access_recon_loss: 9208800.7500; val_global_loss: 27267666.5000; val_optim_loss: 27267666.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8753; val_auprc_score: 0.8383; val_best_acc_score: 0.8060; val_best_f1_score: 0.8288; train_kl_reg_loss: 50274.4725; train_edge_recon_loss: 601815.8769; train_gene_expr_recon_loss: 17477687.1818; train_masked_gp_l1_reg_loss: 96698.6383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70533.1824; train_chrom_access_recon_loss: 9158984.9091; train_global_loss: 27455994.2727; train_optim_loss: 27455994.2727; val_kl_reg_loss: 47815.5688; val_edge_recon_loss: 600983.6016; val_gene_expr_recon_loss: 17143083.7500; val_masked_gp_l1_reg_loss: 96747.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70292.0703; val_chrom_access_recon_loss: 9202754.0000; val_global_loss: 27161677.2500; val_optim_loss: 27161677.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8743; val_auprc_score: 0.8441; val_best_acc_score: 0.7990; val_best_f1_score: 0.8215; train_kl_reg_loss: 50471.7031; train_edge_recon_loss: 601100.8343; train_gene_expr_recon_loss: 17450385.9394; train_masked_gp_l1_reg_loss: 96530.8208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70009.5284; train_chrom_access_recon_loss: 9147641.1364; train_global_loss: 27416139.9091; train_optim_loss: 27416139.9091; val_kl_reg_loss: 47866.6846; val_edge_recon_loss: 604576.9609; val_gene_expr_recon_loss: 17137593.0000; val_masked_gp_l1_reg_loss: 96432.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69823.2578; val_chrom_access_recon_loss: 9171580.3750; val_global_loss: 27127873.0000; val_optim_loss: 27127873.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8724; val_auprc_score: 0.8312; val_best_acc_score: 0.8049; val_best_f1_score: 0.8272; train_kl_reg_loss: 50460.9247; train_edge_recon_loss: 598785.5777; train_gene_expr_recon_loss: 17434699.0000; train_masked_gp_l1_reg_loss: 96290.2071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69680.9001; train_chrom_access_recon_loss: 9150906.6818; train_global_loss: 27400823.1515; train_optim_loss: 27400823.1515; val_kl_reg_loss: 48558.6665; val_edge_recon_loss: 600364.5703; val_gene_expr_recon_loss: 17135208.1250; val_masked_gp_l1_reg_loss: 96283.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69547.8594; val_chrom_access_recon_loss: 9194563.1250; val_global_loss: 27144526.2500; val_optim_loss: 27144526.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8798; val_auprc_score: 0.8356; val_best_acc_score: 0.8130; val_best_f1_score: 0.8322; train_kl_reg_loss: 50680.4463; train_edge_recon_loss: 598981.5862; train_gene_expr_recon_loss: 17433386.9091; train_masked_gp_l1_reg_loss: 96134.6779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69270.1354; train_chrom_access_recon_loss: 9138989.7273; train_global_loss: 27387443.5152; train_optim_loss: 27387443.5152; val_kl_reg_loss: 48973.5718; val_edge_recon_loss: 598817.9375; val_gene_expr_recon_loss: 17108378.7500; val_masked_gp_l1_reg_loss: 96194.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69414.4844; val_chrom_access_recon_loss: 9171034.8750; val_global_loss: 27092813.0000; val_optim_loss: 27092813.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8757; val_auprc_score: 0.8379; val_best_acc_score: 0.8103; val_best_f1_score: 0.8293; train_kl_reg_loss: 50701.0794; train_edge_recon_loss: 601142.3892; train_gene_expr_recon_loss: 17406624.0909; train_masked_gp_l1_reg_loss: 96040.8988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69124.3942; train_chrom_access_recon_loss: 9132663.2273; train_global_loss: 27356295.9697; train_optim_loss: 27356295.9697; val_kl_reg_loss: 48440.0161; val_edge_recon_loss: 608879.5859; val_gene_expr_recon_loss: 17121502.7500; val_masked_gp_l1_reg_loss: 96088.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68535.2734; val_chrom_access_recon_loss: 9109982.6250; val_global_loss: 27053429.2500; val_optim_loss: 27053429.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8774; val_auprc_score: 0.8412; val_best_acc_score: 0.8055; val_best_f1_score: 0.8261; train_kl_reg_loss: 50415.5522; train_edge_recon_loss: 599247.3608; train_gene_expr_recon_loss: 17389280.6212; train_masked_gp_l1_reg_loss: 96063.2138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68680.2299; train_chrom_access_recon_loss: 9122680.2424; train_global_loss: 27326367.2424; train_optim_loss: 27326367.2424; val_kl_reg_loss: 49149.2168; val_edge_recon_loss: 607268.8359; val_gene_expr_recon_loss: 17178264.2500; val_masked_gp_l1_reg_loss: 95964.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68751.3516; val_chrom_access_recon_loss: 9093718.3750; val_global_loss: 27093117.2500; val_optim_loss: 27093117.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8754; val_auprc_score: 0.8398; val_best_acc_score: 0.8036; val_best_f1_score: 0.8244; train_kl_reg_loss: 50411.2491; train_edge_recon_loss: 599741.5085; train_gene_expr_recon_loss: 17364473.2273; train_masked_gp_l1_reg_loss: 95949.8594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68504.6901; train_chrom_access_recon_loss: 9110657.5152; train_global_loss: 27289737.8788; train_optim_loss: 27289737.8788; val_kl_reg_loss: 48297.3599; val_edge_recon_loss: 605180.2656; val_gene_expr_recon_loss: 16986946.1250; val_masked_gp_l1_reg_loss: 95946.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68511.1484; val_chrom_access_recon_loss: 9119671.7500; val_global_loss: 26924553.7500; val_optim_loss: 26924553.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8820; val_auprc_score: 0.8472; val_best_acc_score: 0.8154; val_best_f1_score: 0.8323; train_kl_reg_loss: 50659.6371; train_edge_recon_loss: 595814.0445; train_gene_expr_recon_loss: 17362791.3788; train_masked_gp_l1_reg_loss: 95921.1017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68126.4783; train_chrom_access_recon_loss: 9113758.1061; train_global_loss: 27287070.8182; train_optim_loss: 27287070.8182; val_kl_reg_loss: 50459.5498; val_edge_recon_loss: 595325.6016; val_gene_expr_recon_loss: 17123534.6250; val_masked_gp_l1_reg_loss: 95814.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68298.3125; val_chrom_access_recon_loss: 9209277.8750; val_global_loss: 27142709.7500; val_optim_loss: 27142709.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8890; val_auprc_score: 0.8603; val_best_acc_score: 0.8208; val_best_f1_score: 0.8368; train_kl_reg_loss: 50717.3997; train_edge_recon_loss: 597710.8617; train_gene_expr_recon_loss: 17354441.3939; train_masked_gp_l1_reg_loss: 95823.0330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67991.9465; train_chrom_access_recon_loss: 9111419.1061; train_global_loss: 27278103.6970; train_optim_loss: 27278103.6970; val_kl_reg_loss: 49194.4243; val_edge_recon_loss: 604329.7812; val_gene_expr_recon_loss: 17223425.1250; val_masked_gp_l1_reg_loss: 95889.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67873.3359; val_chrom_access_recon_loss: 9223507.3750; val_global_loss: 27264220.2500; val_optim_loss: 27264220.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8825; val_auprc_score: 0.8447; val_best_acc_score: 0.8181; val_best_f1_score: 0.8367; train_kl_reg_loss: 50730.1123; train_edge_recon_loss: 596562.8902; train_gene_expr_recon_loss: 17356961.6515; train_masked_gp_l1_reg_loss: 95894.2704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67737.3000; train_chrom_access_recon_loss: 9112948.8636; train_global_loss: 27280834.8485; train_optim_loss: 27280834.8485; val_kl_reg_loss: 49977.0874; val_edge_recon_loss: 594937.8750; val_gene_expr_recon_loss: 17008470.1250; val_masked_gp_l1_reg_loss: 95913.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67892.6719; val_chrom_access_recon_loss: 9072609.9375; val_global_loss: 26889801.0000; val_optim_loss: 26889801.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8923; val_auprc_score: 0.8675; val_best_acc_score: 0.8173; val_best_f1_score: 0.8338; train_kl_reg_loss: 50764.2630; train_edge_recon_loss: 596618.3996; train_gene_expr_recon_loss: 17348407.4848; train_masked_gp_l1_reg_loss: 95933.8040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67605.2897; train_chrom_access_recon_loss: 9106643.5303; train_global_loss: 27265972.9697; train_optim_loss: 27265972.9697; val_kl_reg_loss: 49664.6104; val_edge_recon_loss: 602048.7812; val_gene_expr_recon_loss: 17005930.8750; val_masked_gp_l1_reg_loss: 95961.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67199.8516; val_chrom_access_recon_loss: 9105192.8750; val_global_loss: 26925999.0000; val_optim_loss: 26925999.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8894; val_auprc_score: 0.8547; val_best_acc_score: 0.8229; val_best_f1_score: 0.8402; train_kl_reg_loss: 50949.0247; train_edge_recon_loss: 595248.7225; train_gene_expr_recon_loss: 17321399.6061; train_masked_gp_l1_reg_loss: 96011.0223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67398.4866; train_chrom_access_recon_loss: 9101196.4394; train_global_loss: 27232203.4242; train_optim_loss: 27232203.4242; val_kl_reg_loss: 49752.2373; val_edge_recon_loss: 600270.9531; val_gene_expr_recon_loss: 17112120.7500; val_masked_gp_l1_reg_loss: 95988.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67215.3203; val_chrom_access_recon_loss: 9092322.7500; val_global_loss: 27017670.7500; val_optim_loss: 27017670.7500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8857; val_auprc_score: 0.8543; val_best_acc_score: 0.8162; val_best_f1_score: 0.8335; train_kl_reg_loss: 50846.1030; train_edge_recon_loss: 594713.4527; train_gene_expr_recon_loss: 17316967.8485; train_masked_gp_l1_reg_loss: 96007.0282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67136.8524; train_chrom_access_recon_loss: 9094087.7424; train_global_loss: 27219758.9697; train_optim_loss: 27219758.9697; val_kl_reg_loss: 50444.5654; val_edge_recon_loss: 599779.7422; val_gene_expr_recon_loss: 17291810.6250; val_masked_gp_l1_reg_loss: 96151.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67055.4688; val_chrom_access_recon_loss: 9254855.2500; val_global_loss: 27360098.0000; val_optim_loss: 27360098.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8960; val_auprc_score: 0.8614; val_best_acc_score: 0.8318; val_best_f1_score: 0.8446; train_kl_reg_loss: 51132.5717; train_edge_recon_loss: 591669.5312; train_gene_expr_recon_loss: 17321008.9848; train_masked_gp_l1_reg_loss: 96132.2853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67116.8794; train_chrom_access_recon_loss: 9102203.3333; train_global_loss: 27229263.3333; train_optim_loss: 27229263.3333; val_kl_reg_loss: 50196.8589; val_edge_recon_loss: 591661.8281; val_gene_expr_recon_loss: 17142937.0000; val_masked_gp_l1_reg_loss: 96106.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67056.9219; val_chrom_access_recon_loss: 9140969.1250; val_global_loss: 27088927.2500; val_optim_loss: 27088927.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8942; val_auprc_score: 0.8614; val_best_acc_score: 0.8240; val_best_f1_score: 0.8392; train_kl_reg_loss: 51094.3349; train_edge_recon_loss: 593555.1222; train_gene_expr_recon_loss: 17305991.6818; train_masked_gp_l1_reg_loss: 93400.0470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54438.6955; train_chrom_access_recon_loss: 9086816.2727; train_global_loss: 27185296.0000; train_optim_loss: 27185296.0000; val_kl_reg_loss: 50868.5444; val_edge_recon_loss: 598350.8438; val_gene_expr_recon_loss: 17244560.0000; val_masked_gp_l1_reg_loss: 92616.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52016.2812; val_chrom_access_recon_loss: 9165864.0000; val_global_loss: 27204275.7500; val_optim_loss: 27204275.7500
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8895; val_auprc_score: 0.8570; val_best_acc_score: 0.8262; val_best_f1_score: 0.8403; train_kl_reg_loss: 51302.6897; train_edge_recon_loss: 593145.9650; train_gene_expr_recon_loss: 17288587.0455; train_masked_gp_l1_reg_loss: 92500.1044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51794.7164; train_chrom_access_recon_loss: 9070833.0758; train_global_loss: 27148163.3333; train_optim_loss: 27148163.3333; val_kl_reg_loss: 50850.8506; val_edge_recon_loss: 599949.0469; val_gene_expr_recon_loss: 17038619.3750; val_masked_gp_l1_reg_loss: 92427.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51556.6211; val_chrom_access_recon_loss: 9064947.3750; val_global_loss: 26898350.7500; val_optim_loss: 26898350.7500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8973; val_auprc_score: 0.8724; val_best_acc_score: 0.8278; val_best_f1_score: 0.8416; train_kl_reg_loss: 51644.5169; train_edge_recon_loss: 592823.8750; train_gene_expr_recon_loss: 17293099.4242; train_masked_gp_l1_reg_loss: 92356.4532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51347.6978; train_chrom_access_recon_loss: 9077281.1364; train_global_loss: 27158553.1515; train_optim_loss: 27158553.1515; val_kl_reg_loss: 51034.3115; val_edge_recon_loss: 597898.0234; val_gene_expr_recon_loss: 17152947.5000; val_masked_gp_l1_reg_loss: 92307.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51176.5586; val_chrom_access_recon_loss: 9161693.0000; val_global_loss: 27107056.5000; val_optim_loss: 27107056.5000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.8928; val_auprc_score: 0.8570; val_best_acc_score: 0.8310; val_best_f1_score: 0.8444; train_kl_reg_loss: 51828.1487; train_edge_recon_loss: 592966.8447; train_gene_expr_recon_loss: 17293601.2576; train_masked_gp_l1_reg_loss: 92294.8651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51067.4136; train_chrom_access_recon_loss: 9086882.4394; train_global_loss: 27168641.0303; train_optim_loss: 27168641.0303; val_kl_reg_loss: 50805.8960; val_edge_recon_loss: 591696.2734; val_gene_expr_recon_loss: 17109957.5000; val_masked_gp_l1_reg_loss: 92266.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50925.0586; val_chrom_access_recon_loss: 9122216.7500; val_global_loss: 27017868.2500; val_optim_loss: 27017868.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 5 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.8925
val AUPRC score: 0.8640
val best accuracy score: 0.8192
val best F1 score: 0.8363
val target rna MSE score: 1.7103
val source rna MSE score: 1.0203
val target atac MSE score: 0.3241
val source atac MSE score: 0.1389
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
