[True]
Run timestamp: 07092023_035812_256.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_256']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 797 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3511, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6321; val_auprc_score: 0.6180; val_best_acc_score: 0.5075; val_best_f1_score: 0.6698; train_kl_reg_loss: 37601.7918; train_edge_recon_loss: 3556424.8068; train_gene_expr_recon_loss: 12524316.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 822265.0218; train_chrom_access_recon_loss: 4425986.8144; train_global_loss: 21366594.5152; train_optim_loss: 21366594.5152; val_kl_reg_loss: 122164.9844; val_edge_recon_loss: 4065014.3438; val_gene_expr_recon_loss: 11546848.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 632295.8125; val_chrom_access_recon_loss: 4213003.5000; val_global_loss: 20579327.7500; val_optim_loss: 20579327.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6749; val_auprc_score: 0.6707; val_best_acc_score: 0.5817; val_best_f1_score: 0.6875; train_kl_reg_loss: 87631.8098; train_edge_recon_loss: 3521651.7348; train_gene_expr_recon_loss: 11320617.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 467364.5630; train_chrom_access_recon_loss: 4196554.9962; train_global_loss: 19593820.1212; train_optim_loss: 19593820.1212; val_kl_reg_loss: 87928.5850; val_edge_recon_loss: 4059114.1875; val_gene_expr_recon_loss: 11320347.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 326564.5938; val_chrom_access_recon_loss: 4161321.6562; val_global_loss: 19955277.0000; val_optim_loss: 19955277.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7741; val_auprc_score: 0.7550; val_best_acc_score: 0.7010; val_best_f1_score: 0.7113; train_kl_reg_loss: 81912.7545; train_edge_recon_loss: 3511910.9091; train_gene_expr_recon_loss: 11140887.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243869.8007; train_chrom_access_recon_loss: 4146157.4583; train_global_loss: 19124738.0303; train_optim_loss: 19124738.0303; val_kl_reg_loss: 82601.2217; val_edge_recon_loss: 4003344.5625; val_gene_expr_recon_loss: 11121506.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179443.0000; val_chrom_access_recon_loss: 4098287.4062; val_global_loss: 19485182.0000; val_optim_loss: 19485182.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8455; val_auprc_score: 0.8223; val_best_acc_score: 0.7724; val_best_f1_score: 0.7893; train_kl_reg_loss: 65880.5394; train_edge_recon_loss: 3460237.2614; train_gene_expr_recon_loss: 11040790.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143002.8196; train_chrom_access_recon_loss: 4123709.6439; train_global_loss: 18833620.5455; train_optim_loss: 18833620.5455; val_kl_reg_loss: 53102.0674; val_edge_recon_loss: 3489337.5625; val_gene_expr_recon_loss: 11004421.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114712.1250; val_chrom_access_recon_loss: 4076207.2812; val_global_loss: 18737780.7500; val_optim_loss: 18737780.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8530; val_auprc_score: 0.8134; val_best_acc_score: 0.7789; val_best_f1_score: 0.7930; train_kl_reg_loss: 70369.9188; train_edge_recon_loss: 3077366.2917; train_gene_expr_recon_loss: 10993810.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99841.2308; train_chrom_access_recon_loss: 4102748.2311; train_global_loss: 18344135.6667; train_optim_loss: 18344135.6667; val_kl_reg_loss: 85131.8750; val_edge_recon_loss: 2978963.0938; val_gene_expr_recon_loss: 10925914.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86545.8672; val_chrom_access_recon_loss: 4038866.5938; val_global_loss: 18115421.5000; val_optim_loss: 18115421.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8695; val_auprc_score: 0.8488; val_best_acc_score: 0.7840; val_best_f1_score: 0.8008; train_kl_reg_loss: 85590.3847; train_edge_recon_loss: 2925080.5682; train_gene_expr_recon_loss: 10890783.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76101.2513; train_chrom_access_recon_loss: 4074528.5644; train_global_loss: 18052083.8485; train_optim_loss: 18052083.8485; val_kl_reg_loss: 86752.2646; val_edge_recon_loss: 2938020.2188; val_gene_expr_recon_loss: 10937697.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66876.2734; val_chrom_access_recon_loss: 4052541.1875; val_global_loss: 18081886.7500; val_optim_loss: 18081886.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8816; val_auprc_score: 0.8476; val_best_acc_score: 0.8117; val_best_f1_score: 0.8246; train_kl_reg_loss: 86302.8841; train_edge_recon_loss: 2878740.0038; train_gene_expr_recon_loss: 10837022.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60513.4231; train_chrom_access_recon_loss: 4056892.6932; train_global_loss: 17919471.3333; train_optim_loss: 17919471.3333; val_kl_reg_loss: 83721.6953; val_edge_recon_loss: 2852804.8750; val_gene_expr_recon_loss: 10812504.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54963.1836; val_chrom_access_recon_loss: 4001361.9062; val_global_loss: 17805355.7500; val_optim_loss: 17805355.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8835; val_auprc_score: 0.8548; val_best_acc_score: 0.8127; val_best_f1_score: 0.8238; train_kl_reg_loss: 82506.4369; train_edge_recon_loss: 2857683.6098; train_gene_expr_recon_loss: 10781601.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50518.2737; train_chrom_access_recon_loss: 4035141.6553; train_global_loss: 17807451.0909; train_optim_loss: 17807451.0909; val_kl_reg_loss: 79801.4258; val_edge_recon_loss: 2911536.2812; val_gene_expr_recon_loss: 10780105.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46319.0938; val_chrom_access_recon_loss: 4024877.8750; val_global_loss: 17842640.5000; val_optim_loss: 17842640.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8996; val_auprc_score: 0.8697; val_best_acc_score: 0.8334; val_best_f1_score: 0.8418; train_kl_reg_loss: 80803.5773; train_edge_recon_loss: 2825430.1364; train_gene_expr_recon_loss: 10734482.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43237.7151; train_chrom_access_recon_loss: 4022007.8333; train_global_loss: 17705961.7273; train_optim_loss: 17705961.7273; val_kl_reg_loss: 85952.2324; val_edge_recon_loss: 2839033.9062; val_gene_expr_recon_loss: 10709405.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40698.6602; val_chrom_access_recon_loss: 3921649.4688; val_global_loss: 17596739.6250; val_optim_loss: 17596739.6250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8948; val_auprc_score: 0.8579; val_best_acc_score: 0.8302; val_best_f1_score: 0.8439; train_kl_reg_loss: 82543.7911; train_edge_recon_loss: 2818362.3902; train_gene_expr_recon_loss: 10676322.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38645.8528; train_chrom_access_recon_loss: 4001324.0568; train_global_loss: 17617198.2121; train_optim_loss: 17617198.2121; val_kl_reg_loss: 79952.0508; val_edge_recon_loss: 2855535.5625; val_gene_expr_recon_loss: 10688050.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36804.2109; val_chrom_access_recon_loss: 3970474.3750; val_global_loss: 17630817.0000; val_optim_loss: 17630817.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9122; val_auprc_score: 0.8878; val_best_acc_score: 0.8442; val_best_f1_score: 0.8530; train_kl_reg_loss: 82685.9220; train_edge_recon_loss: 2791726.2311; train_gene_expr_recon_loss: 10641409.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35593.9762; train_chrom_access_recon_loss: 3986150.2197; train_global_loss: 17537566.2121; train_optim_loss: 17537566.2121; val_kl_reg_loss: 81581.6396; val_edge_recon_loss: 2804396.6562; val_gene_expr_recon_loss: 10595615.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34620.3242; val_chrom_access_recon_loss: 3915208.8750; val_global_loss: 17431422.5000; val_optim_loss: 17431422.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9151; val_auprc_score: 0.8925; val_best_acc_score: 0.8442; val_best_f1_score: 0.8551; train_kl_reg_loss: 77891.8894; train_edge_recon_loss: 2799298.9242; train_gene_expr_recon_loss: 10598737.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33783.1532; train_chrom_access_recon_loss: 3976063.5682; train_global_loss: 17485775.3636; train_optim_loss: 17485775.3636; val_kl_reg_loss: 77050.8076; val_edge_recon_loss: 2805807.8438; val_gene_expr_recon_loss: 10508650.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33046.7695; val_chrom_access_recon_loss: 3901687.7812; val_global_loss: 17326244.0000; val_optim_loss: 17326244.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9092; val_auprc_score: 0.8687; val_best_acc_score: 0.8549; val_best_f1_score: 0.8624; train_kl_reg_loss: 77341.9330; train_edge_recon_loss: 2769957.6136; train_gene_expr_recon_loss: 10546005.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32510.5328; train_chrom_access_recon_loss: 3952309.4280; train_global_loss: 17378125.2121; train_optim_loss: 17378125.2121; val_kl_reg_loss: 77249.8271; val_edge_recon_loss: 2812718.8125; val_gene_expr_recon_loss: 10618631.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32080.0781; val_chrom_access_recon_loss: 3906049.2188; val_global_loss: 17446728.7500; val_optim_loss: 17446728.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9148; val_auprc_score: 0.8813; val_best_acc_score: 0.8549; val_best_f1_score: 0.8615; train_kl_reg_loss: 76298.0009; train_edge_recon_loss: 2764572.4773; train_gene_expr_recon_loss: 10517174.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31691.5665; train_chrom_access_recon_loss: 3941527.3068; train_global_loss: 17331263.5000; train_optim_loss: 17331263.5000; val_kl_reg_loss: 75594.5908; val_edge_recon_loss: 2800732.6250; val_gene_expr_recon_loss: 10533483.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31205.6328; val_chrom_access_recon_loss: 3919737.0312; val_global_loss: 17360754.0000; val_optim_loss: 17360754.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9206; val_auprc_score: 0.8982; val_best_acc_score: 0.8603; val_best_f1_score: 0.8688; train_kl_reg_loss: 72470.2873; train_edge_recon_loss: 2769131.2727; train_gene_expr_recon_loss: 10476869.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31016.4353; train_chrom_access_recon_loss: 3927345.4697; train_global_loss: 17276832.3485; train_optim_loss: 17276832.3485; val_kl_reg_loss: 71929.6289; val_edge_recon_loss: 2780620.7188; val_gene_expr_recon_loss: 10416009.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30742.5039; val_chrom_access_recon_loss: 3909416.5625; val_global_loss: 17208720.0000; val_optim_loss: 17208720.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9152; val_auprc_score: 0.8845; val_best_acc_score: 0.8600; val_best_f1_score: 0.8705; train_kl_reg_loss: 73104.2962; train_edge_recon_loss: 2740167.1970; train_gene_expr_recon_loss: 10440153.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30476.6515; train_chrom_access_recon_loss: 3914890.0265; train_global_loss: 17198791.4697; train_optim_loss: 17198791.4697; val_kl_reg_loss: 74738.2822; val_edge_recon_loss: 2771283.0312; val_gene_expr_recon_loss: 10404996.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30160.2637; val_chrom_access_recon_loss: 3840630.9375; val_global_loss: 17121809.3750; val_optim_loss: 17121809.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9253; val_auprc_score: 0.9011; val_best_acc_score: 0.8713; val_best_f1_score: 0.8784; train_kl_reg_loss: 71108.8110; train_edge_recon_loss: 2735618.2538; train_gene_expr_recon_loss: 10413800.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29959.0865; train_chrom_access_recon_loss: 3904674.2083; train_global_loss: 17155161.1212; train_optim_loss: 17155161.1212; val_kl_reg_loss: 70836.0488; val_edge_recon_loss: 2748304.3438; val_gene_expr_recon_loss: 10493865.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29902.7344; val_chrom_access_recon_loss: 3863380.2188; val_global_loss: 17206288.7500; val_optim_loss: 17206288.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9162; val_auprc_score: 0.8867; val_best_acc_score: 0.8557; val_best_f1_score: 0.8674; train_kl_reg_loss: 70826.9349; train_edge_recon_loss: 2748035.9318; train_gene_expr_recon_loss: 10385971.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29484.0224; train_chrom_access_recon_loss: 3895664.3182; train_global_loss: 17129983.1212; train_optim_loss: 17129983.1212; val_kl_reg_loss: 69404.0156; val_edge_recon_loss: 2800847.0625; val_gene_expr_recon_loss: 10405461.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29223.5352; val_chrom_access_recon_loss: 3880247.2812; val_global_loss: 17185184.0000; val_optim_loss: 17185184.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9251; val_auprc_score: 0.8971; val_best_acc_score: 0.8657; val_best_f1_score: 0.8734; train_kl_reg_loss: 70900.0504; train_edge_recon_loss: 2727010.9811; train_gene_expr_recon_loss: 10362450.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29034.9822; train_chrom_access_recon_loss: 3886964.0379; train_global_loss: 17076360.2879; train_optim_loss: 17076360.2879; val_kl_reg_loss: 69482.3799; val_edge_recon_loss: 2752231.5000; val_gene_expr_recon_loss: 10281733.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28793.4395; val_chrom_access_recon_loss: 3875986.7188; val_global_loss: 17008227.3750; val_optim_loss: 17008227.3750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9243; val_auprc_score: 0.8944; val_best_acc_score: 0.8635; val_best_f1_score: 0.8738; train_kl_reg_loss: 69071.6533; train_edge_recon_loss: 2725349.2311; train_gene_expr_recon_loss: 10329037.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28614.5001; train_chrom_access_recon_loss: 3872009.1629; train_global_loss: 17024082.3182; train_optim_loss: 17024082.3182; val_kl_reg_loss: 69284.9873; val_edge_recon_loss: 2768744.4375; val_gene_expr_recon_loss: 10383550.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28412.4258; val_chrom_access_recon_loss: 3859516.4688; val_global_loss: 17109507.7500; val_optim_loss: 17109507.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9291; val_auprc_score: 0.9016; val_best_acc_score: 0.8700; val_best_f1_score: 0.8764; train_kl_reg_loss: 68286.8548; train_edge_recon_loss: 2718383.1515; train_gene_expr_recon_loss: 10308059.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28197.2720; train_chrom_access_recon_loss: 3865380.1364; train_global_loss: 16988307.0606; train_optim_loss: 16988307.0606; val_kl_reg_loss: 69051.5010; val_edge_recon_loss: 2750912.0312; val_gene_expr_recon_loss: 10269175.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27957.5625; val_chrom_access_recon_loss: 3802745.5000; val_global_loss: 16919842.2500; val_optim_loss: 16919842.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9285; val_auprc_score: 0.9018; val_best_acc_score: 0.8662; val_best_f1_score: 0.8725; train_kl_reg_loss: 66158.1473; train_edge_recon_loss: 2709479.3030; train_gene_expr_recon_loss: 10279836.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27947.1887; train_chrom_access_recon_loss: 3853799.3371; train_global_loss: 16937221.0455; train_optim_loss: 16937221.0455; val_kl_reg_loss: 69441.8467; val_edge_recon_loss: 2770855.0938; val_gene_expr_recon_loss: 10301405.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27868.6855; val_chrom_access_recon_loss: 3815597.2188; val_global_loss: 16985168.2500; val_optim_loss: 16985168.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9325; val_auprc_score: 0.9107; val_best_acc_score: 0.8737; val_best_f1_score: 0.8819; train_kl_reg_loss: 66267.8755; train_edge_recon_loss: 2719965.9811; train_gene_expr_recon_loss: 10255843.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27602.7616; train_chrom_access_recon_loss: 3844267.1818; train_global_loss: 16913947.4697; train_optim_loss: 16913947.4697; val_kl_reg_loss: 66166.3516; val_edge_recon_loss: 2752609.7500; val_gene_expr_recon_loss: 10228503.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27529.4766; val_chrom_access_recon_loss: 3786490.6875; val_global_loss: 16861299.1250; val_optim_loss: 16861299.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9348; val_auprc_score: 0.9076; val_best_acc_score: 0.8794; val_best_f1_score: 0.8847; train_kl_reg_loss: 64625.2775; train_edge_recon_loss: 2703099.8712; train_gene_expr_recon_loss: 10234141.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27368.4746; train_chrom_access_recon_loss: 3833180.8030; train_global_loss: 16862415.5303; train_optim_loss: 16862415.5303; val_kl_reg_loss: 65555.5718; val_edge_recon_loss: 2720188.8125; val_gene_expr_recon_loss: 10229735.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27355.9883; val_chrom_access_recon_loss: 3771981.3125; val_global_loss: 16814817.2500; val_optim_loss: 16814817.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9419; val_auprc_score: 0.9229; val_best_acc_score: 0.8815; val_best_f1_score: 0.8883; train_kl_reg_loss: 63902.9489; train_edge_recon_loss: 2709772.1136; train_gene_expr_recon_loss: 10211043.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27260.7864; train_chrom_access_recon_loss: 3827169.9583; train_global_loss: 16839149.3030; train_optim_loss: 16839149.3030; val_kl_reg_loss: 66387.5776; val_edge_recon_loss: 2719897.0000; val_gene_expr_recon_loss: 10254494.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26938.5352; val_chrom_access_recon_loss: 3786729.7500; val_global_loss: 16854447.5000; val_optim_loss: 16854447.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9401; val_auprc_score: 0.9176; val_best_acc_score: 0.8823; val_best_f1_score: 0.8886; train_kl_reg_loss: 65338.1246; train_edge_recon_loss: 2709906.6515; train_gene_expr_recon_loss: 10188347.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23562.4359; train_chrom_access_recon_loss: 3836945.9583; train_global_loss: 16824100.9848; train_optim_loss: 16824100.9848; val_kl_reg_loss: 57338.2930; val_edge_recon_loss: 2746504.2812; val_gene_expr_recon_loss: 10207463.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22691.0059; val_chrom_access_recon_loss: 3807472.2500; val_global_loss: 16841469.7500; val_optim_loss: 16841469.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9448; val_auprc_score: 0.9233; val_best_acc_score: 0.8834; val_best_f1_score: 0.8892; train_kl_reg_loss: 64338.3063; train_edge_recon_loss: 2701495.5985; train_gene_expr_recon_loss: 10145685.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22500.8317; train_chrom_access_recon_loss: 3809979.1174; train_global_loss: 16743999.1818; train_optim_loss: 16743999.1818; val_kl_reg_loss: 56376.8677; val_edge_recon_loss: 2714448.7812; val_gene_expr_recon_loss: 10141525.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22394.1309; val_chrom_access_recon_loss: 3767281.8750; val_global_loss: 16702026.8750; val_optim_loss: 16702026.8750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9417; val_auprc_score: 0.9210; val_best_acc_score: 0.8861; val_best_f1_score: 0.8925; train_kl_reg_loss: 62795.1349; train_edge_recon_loss: 2695928.3977; train_gene_expr_recon_loss: 10125605.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22356.5855; train_chrom_access_recon_loss: 3803619.2652; train_global_loss: 16710304.8939; train_optim_loss: 16710304.8939; val_kl_reg_loss: 57771.7910; val_edge_recon_loss: 2730392.5312; val_gene_expr_recon_loss: 10166854.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22296.9062; val_chrom_access_recon_loss: 3792640.4688; val_global_loss: 16769956.1250; val_optim_loss: 16769956.1250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9424; val_auprc_score: 0.9205; val_best_acc_score: 0.8882; val_best_f1_score: 0.8922; train_kl_reg_loss: 62137.6218; train_edge_recon_loss: 2691541.4508; train_gene_expr_recon_loss: 10113120.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22281.6169; train_chrom_access_recon_loss: 3795207.4318; train_global_loss: 16684288.9545; train_optim_loss: 16684288.9545; val_kl_reg_loss: 56888.8081; val_edge_recon_loss: 2724708.9375; val_gene_expr_recon_loss: 10097699.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22205.2773; val_chrom_access_recon_loss: 3771779.1250; val_global_loss: 16673281.3750; val_optim_loss: 16673281.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9497; val_auprc_score: 0.9325; val_best_acc_score: 0.8928; val_best_f1_score: 0.8976; train_kl_reg_loss: 61634.8066; train_edge_recon_loss: 2689878.3409; train_gene_expr_recon_loss: 10089945.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22204.9755; train_chrom_access_recon_loss: 3786661.6477; train_global_loss: 16650325.5455; train_optim_loss: 16650325.5455; val_kl_reg_loss: 55087.5405; val_edge_recon_loss: 2703316.0312; val_gene_expr_recon_loss: 10120144.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22255.4473; val_chrom_access_recon_loss: 3758992.0625; val_global_loss: 16659795.3750; val_optim_loss: 16659795.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9443; val_auprc_score: 0.9172; val_best_acc_score: 0.8893; val_best_f1_score: 0.8952; train_kl_reg_loss: 60832.7354; train_edge_recon_loss: 2696927.1250; train_gene_expr_recon_loss: 10065554.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22200.9827; train_chrom_access_recon_loss: 3778996.3939; train_global_loss: 16624511.2576; train_optim_loss: 16624511.2576; val_kl_reg_loss: 53448.6758; val_edge_recon_loss: 2735630.7812; val_gene_expr_recon_loss: 10156995.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22169.3770; val_chrom_access_recon_loss: 3758773.1562; val_global_loss: 16727017.8750; val_optim_loss: 16727017.8750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9479; val_auprc_score: 0.9287; val_best_acc_score: 0.8917; val_best_f1_score: 0.8975; train_kl_reg_loss: 59323.2074; train_edge_recon_loss: 2683314.6477; train_gene_expr_recon_loss: 10055306.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22189.8413; train_chrom_access_recon_loss: 3773627.7500; train_global_loss: 16593761.8939; train_optim_loss: 16593761.8939; val_kl_reg_loss: 57056.9658; val_edge_recon_loss: 2717401.1250; val_gene_expr_recon_loss: 10083908.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22230.2930; val_chrom_access_recon_loss: 3741627.3750; val_global_loss: 16622224.1250; val_optim_loss: 16622224.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9448; val_auprc_score: 0.9141; val_best_acc_score: 0.8963; val_best_f1_score: 0.9015; train_kl_reg_loss: 59158.9563; train_edge_recon_loss: 2678296.4811; train_gene_expr_recon_loss: 10045754.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22183.9719; train_chrom_access_recon_loss: 3770498.9583; train_global_loss: 16575893.0758; train_optim_loss: 16575893.0758; val_kl_reg_loss: 54975.0215; val_edge_recon_loss: 2720609.1562; val_gene_expr_recon_loss: 10059891.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22190.8262; val_chrom_access_recon_loss: 3749229.3438; val_global_loss: 16606896.0000; val_optim_loss: 16606896.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9483; val_auprc_score: 0.9226; val_best_acc_score: 0.8987; val_best_f1_score: 0.9031; train_kl_reg_loss: 58060.7502; train_edge_recon_loss: 2681465.8220; train_gene_expr_recon_loss: 10021390.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22151.4142; train_chrom_access_recon_loss: 3760806.1326; train_global_loss: 16543874.5152; train_optim_loss: 16543874.5152; val_kl_reg_loss: 53548.8726; val_edge_recon_loss: 2684653.2188; val_gene_expr_recon_loss: 10074556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22139.1699; val_chrom_access_recon_loss: 3747580.1875; val_global_loss: 16582477.3750; val_optim_loss: 16582477.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9507; val_auprc_score: 0.9289; val_best_acc_score: 0.8958; val_best_f1_score: 0.8996; train_kl_reg_loss: 56699.9628; train_edge_recon_loss: 2679800.0682; train_gene_expr_recon_loss: 10007025.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22138.0176; train_chrom_access_recon_loss: 3758213.3712; train_global_loss: 16523876.8939; train_optim_loss: 16523876.8939; val_kl_reg_loss: 54038.0513; val_edge_recon_loss: 2707213.0625; val_gene_expr_recon_loss: 9978920.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22090.1855; val_chrom_access_recon_loss: 3702975.3438; val_global_loss: 16465237.0000; val_optim_loss: 16465237.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9532; val_auprc_score: 0.9323; val_best_acc_score: 0.9046; val_best_f1_score: 0.9068; train_kl_reg_loss: 55150.3349; train_edge_recon_loss: 2691292.1061; train_gene_expr_recon_loss: 9992574.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22123.6680; train_chrom_access_recon_loss: 3745489.0114; train_global_loss: 16506629.0758; train_optim_loss: 16506629.0758; val_kl_reg_loss: 51970.5430; val_edge_recon_loss: 2695007.5312; val_gene_expr_recon_loss: 10079432.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22110.6699; val_chrom_access_recon_loss: 3762352.9688; val_global_loss: 16610874.6250; val_optim_loss: 16610874.6250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9521; val_auprc_score: 0.9302; val_best_acc_score: 0.9017; val_best_f1_score: 0.9063; train_kl_reg_loss: 56358.5752; train_edge_recon_loss: 2673752.0227; train_gene_expr_recon_loss: 9969454.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22113.2270; train_chrom_access_recon_loss: 3733524.0189; train_global_loss: 16455202.4545; train_optim_loss: 16455202.4545; val_kl_reg_loss: 53476.2075; val_edge_recon_loss: 2711296.1250; val_gene_expr_recon_loss: 10048598.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22051.4004; val_chrom_access_recon_loss: 3715053.2500; val_global_loss: 16550474.7500; val_optim_loss: 16550474.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9546; val_auprc_score: 0.9392; val_best_acc_score: 0.9030; val_best_f1_score: 0.9065; train_kl_reg_loss: 54865.3162; train_edge_recon_loss: 2676038.6477; train_gene_expr_recon_loss: 9943302.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22067.8765; train_chrom_access_recon_loss: 3727620.2121; train_global_loss: 16423894.3030; train_optim_loss: 16423894.3030; val_kl_reg_loss: 51050.5396; val_edge_recon_loss: 2701551.8438; val_gene_expr_recon_loss: 9988788.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22042.2344; val_chrom_access_recon_loss: 3701134.3125; val_global_loss: 16464567.0000; val_optim_loss: 16464567.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9561; val_auprc_score: 0.9391; val_best_acc_score: 0.8955; val_best_f1_score: 0.9004; train_kl_reg_loss: 54387.5807; train_edge_recon_loss: 2675072.8712; train_gene_expr_recon_loss: 9937423.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22072.6139; train_chrom_access_recon_loss: 3724641.6856; train_global_loss: 16413598.6061; train_optim_loss: 16413598.6061; val_kl_reg_loss: 51489.6367; val_edge_recon_loss: 2714263.5000; val_gene_expr_recon_loss: 10024686.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22056.0605; val_chrom_access_recon_loss: 3685291.1562; val_global_loss: 16497786.7500; val_optim_loss: 16497786.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9553; val_auprc_score: 0.9336; val_best_acc_score: 0.9060; val_best_f1_score: 0.9103; train_kl_reg_loss: 53911.4873; train_edge_recon_loss: 2665526.4091; train_gene_expr_recon_loss: 9922966.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22026.7285; train_chrom_access_recon_loss: 3719627.6023; train_global_loss: 16384058.9545; train_optim_loss: 16384058.9545; val_kl_reg_loss: 50821.2695; val_edge_recon_loss: 2690303.3438; val_gene_expr_recon_loss: 10021288.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22064.9199; val_chrom_access_recon_loss: 3724308.5312; val_global_loss: 16508786.3750; val_optim_loss: 16508786.3750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9569; val_auprc_score: 0.9379; val_best_acc_score: 0.9081; val_best_f1_score: 0.9120; train_kl_reg_loss: 53296.1586; train_edge_recon_loss: 2679304.4697; train_gene_expr_recon_loss: 9905412.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22051.3932; train_chrom_access_recon_loss: 3711569.2803; train_global_loss: 16371633.9697; train_optim_loss: 16371633.9697; val_kl_reg_loss: 48327.1567; val_edge_recon_loss: 2687525.8438; val_gene_expr_recon_loss: 9984813.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22015.8633; val_chrom_access_recon_loss: 3684871.7812; val_global_loss: 16427554.2500; val_optim_loss: 16427554.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9596; val_auprc_score: 0.9397; val_best_acc_score: 0.9138; val_best_f1_score: 0.9153; train_kl_reg_loss: 52263.7107; train_edge_recon_loss: 2660574.9811; train_gene_expr_recon_loss: 9892391.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22090.8392; train_chrom_access_recon_loss: 3708174.9773; train_global_loss: 16335496.4394; train_optim_loss: 16335496.4394; val_kl_reg_loss: 49166.5396; val_edge_recon_loss: 2688801.8125; val_gene_expr_recon_loss: 10016428.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22052.1445; val_chrom_access_recon_loss: 3701460.6875; val_global_loss: 16477910.1250; val_optim_loss: 16477910.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9555; val_auprc_score: 0.9371; val_best_acc_score: 0.9046; val_best_f1_score: 0.9091; train_kl_reg_loss: 52098.1543; train_edge_recon_loss: 2665591.0189; train_gene_expr_recon_loss: 9875733.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22061.4195; train_chrom_access_recon_loss: 3699468.3106; train_global_loss: 16314952.6212; train_optim_loss: 16314952.6212; val_kl_reg_loss: 48873.6353; val_edge_recon_loss: 2719704.5000; val_gene_expr_recon_loss: 9868636.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22116.7207; val_chrom_access_recon_loss: 3686174.4688; val_global_loss: 16345505.8750; val_optim_loss: 16345505.8750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9560; val_auprc_score: 0.9312; val_best_acc_score: 0.9092; val_best_f1_score: 0.9129; train_kl_reg_loss: 51600.0211; train_edge_recon_loss: 2667354.7008; train_gene_expr_recon_loss: 9865599.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22065.9505; train_chrom_access_recon_loss: 3691919.2462; train_global_loss: 16298539.3788; train_optim_loss: 16298539.3788; val_kl_reg_loss: 50395.8389; val_edge_recon_loss: 2721246.5938; val_gene_expr_recon_loss: 9933177.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22028.9297; val_chrom_access_recon_loss: 3679299.4062; val_global_loss: 16406148.0000; val_optim_loss: 16406148.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9464; val_auprc_score: 0.9234; val_best_acc_score: 0.8979; val_best_f1_score: 0.9023; train_kl_reg_loss: 51161.9959; train_edge_recon_loss: 2668533.9886; train_gene_expr_recon_loss: 9849436.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22050.6290; train_chrom_access_recon_loss: 3685540.2955; train_global_loss: 16276723.5758; train_optim_loss: 16276723.5758; val_kl_reg_loss: 47913.7764; val_edge_recon_loss: 2731413.0312; val_gene_expr_recon_loss: 9954996.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21905.3496; val_chrom_access_recon_loss: 3716350.2812; val_global_loss: 16472579.1250; val_optim_loss: 16472579.1250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9583; val_auprc_score: 0.9404; val_best_acc_score: 0.9100; val_best_f1_score: 0.9139; train_kl_reg_loss: 50619.3917; train_edge_recon_loss: 2670645.9129; train_gene_expr_recon_loss: 9837816.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21565.7398; train_chrom_access_recon_loss: 3683911.6591; train_global_loss: 16264559.2424; train_optim_loss: 16264559.2424; val_kl_reg_loss: 48334.4712; val_edge_recon_loss: 2705209.8438; val_gene_expr_recon_loss: 9974433.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21516.6816; val_chrom_access_recon_loss: 3700098.5312; val_global_loss: 16449593.0000; val_optim_loss: 16449593.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9621; val_auprc_score: 0.9469; val_best_acc_score: 0.9146; val_best_f1_score: 0.9176; train_kl_reg_loss: 50860.2356; train_edge_recon_loss: 2664592.1818; train_gene_expr_recon_loss: 9824453.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21492.7224; train_chrom_access_recon_loss: 3678672.9697; train_global_loss: 16240071.5455; train_optim_loss: 16240071.5455; val_kl_reg_loss: 48423.3911; val_edge_recon_loss: 2698583.0312; val_gene_expr_recon_loss: 9937153.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21494.5977; val_chrom_access_recon_loss: 3653134.5938; val_global_loss: 16358789.1250; val_optim_loss: 16358789.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9604; val_auprc_score: 0.9442; val_best_acc_score: 0.9124; val_best_f1_score: 0.9151; train_kl_reg_loss: 50012.0345; train_edge_recon_loss: 2653574.2879; train_gene_expr_recon_loss: 9804638.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19924.5908; train_chrom_access_recon_loss: 3673506.4394; train_global_loss: 16201655.8636; train_optim_loss: 16201655.8636; val_kl_reg_loss: 48761.2886; val_edge_recon_loss: 2709499.8125; val_gene_expr_recon_loss: 9871016.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19603.1680; val_chrom_access_recon_loss: 3635711.5000; val_global_loss: 16284592.0000; val_optim_loss: 16284592.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9615; val_auprc_score: 0.9421; val_best_acc_score: 0.9130; val_best_f1_score: 0.9168; train_kl_reg_loss: 50635.6134; train_edge_recon_loss: 2661514.4545; train_gene_expr_recon_loss: 9804097.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19562.9357; train_chrom_access_recon_loss: 3669958.9205; train_global_loss: 16205768.9242; train_optim_loss: 16205768.9242; val_kl_reg_loss: 48882.6143; val_edge_recon_loss: 2693761.0312; val_gene_expr_recon_loss: 9904913.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19530.1113; val_chrom_access_recon_loss: 3661329.0938; val_global_loss: 16328416.6250; val_optim_loss: 16328416.6250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9613; val_auprc_score: 0.9466; val_best_acc_score: 0.9105; val_best_f1_score: 0.9146; train_kl_reg_loss: 50532.6258; train_edge_recon_loss: 2659501.5114; train_gene_expr_recon_loss: 9792854.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19501.9559; train_chrom_access_recon_loss: 3668681.4659; train_global_loss: 16191071.6970; train_optim_loss: 16191071.6970; val_kl_reg_loss: 49273.2271; val_edge_recon_loss: 2696005.6875; val_gene_expr_recon_loss: 9896305.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19477.5742; val_chrom_access_recon_loss: 3619297.6250; val_global_loss: 16280359.1250; val_optim_loss: 16280359.1250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9575; val_auprc_score: 0.9389; val_best_acc_score: 0.9081; val_best_f1_score: 0.9110; train_kl_reg_loss: 50964.9891; train_edge_recon_loss: 2663104.2803; train_gene_expr_recon_loss: 9804765.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19454.2815; train_chrom_access_recon_loss: 3675631.2159; train_global_loss: 16213919.9848; train_optim_loss: 16213919.9848; val_kl_reg_loss: 49986.6875; val_edge_recon_loss: 2702529.3125; val_gene_expr_recon_loss: 9906545.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19438.2051; val_chrom_access_recon_loss: 3661451.8438; val_global_loss: 16339951.6250; val_optim_loss: 16339951.6250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9597; val_auprc_score: 0.9390; val_best_acc_score: 0.9121; val_best_f1_score: 0.9149; train_kl_reg_loss: 51458.8438; train_edge_recon_loss: 2655499.8220; train_gene_expr_recon_loss: 9794788.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19422.2537; train_chrom_access_recon_loss: 3667066.6970; train_global_loss: 16188236.1061; train_optim_loss: 16188236.1061; val_kl_reg_loss: 49934.5854; val_edge_recon_loss: 2683174.8750; val_gene_expr_recon_loss: 9887510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19404.1895; val_chrom_access_recon_loss: 3649594.9688; val_global_loss: 16289618.3750; val_optim_loss: 16289618.3750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9577; val_auprc_score: 0.9355; val_best_acc_score: 0.9116; val_best_f1_score: 0.9150; train_kl_reg_loss: 51175.3878; train_edge_recon_loss: 2660961.7917; train_gene_expr_recon_loss: 9787453.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19381.0452; train_chrom_access_recon_loss: 3663938.1326; train_global_loss: 16182910.0303; train_optim_loss: 16182910.0303; val_kl_reg_loss: 49697.1069; val_edge_recon_loss: 2699318.3750; val_gene_expr_recon_loss: 9881460.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19365.7891; val_chrom_access_recon_loss: 3648210.4062; val_global_loss: 16298051.8750; val_optim_loss: 16298051.8750
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9557; val_auprc_score: 0.9355; val_best_acc_score: 0.9103; val_best_f1_score: 0.9145; train_kl_reg_loss: 50871.1252; train_edge_recon_loss: 2659415.8144; train_gene_expr_recon_loss: 9788782.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19347.4359; train_chrom_access_recon_loss: 3665260.8182; train_global_loss: 16183677.2424; train_optim_loss: 16183677.2424; val_kl_reg_loss: 49025.2646; val_edge_recon_loss: 2685646.2500; val_gene_expr_recon_loss: 9910214.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19330.6152; val_chrom_access_recon_loss: 3676443.7812; val_global_loss: 16340660.8750; val_optim_loss: 16340660.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9581; val_auprc_score: 0.9426; val_best_acc_score: 0.9100; val_best_f1_score: 0.9143; train_kl_reg_loss: 50784.4451; train_edge_recon_loss: 2652191.3636; train_gene_expr_recon_loss: 9785447.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19164.5808; train_chrom_access_recon_loss: 3665317.9318; train_global_loss: 16172905.8788; train_optim_loss: 16172905.8788; val_kl_reg_loss: 49230.4473; val_edge_recon_loss: 2712425.8125; val_gene_expr_recon_loss: 9852060.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19133.3555; val_chrom_access_recon_loss: 3674978.6250; val_global_loss: 16307828.1250; val_optim_loss: 16307828.1250
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9651; val_auprc_score: 0.9519; val_best_acc_score: 0.9151; val_best_f1_score: 0.9173; train_kl_reg_loss: 50897.5759; train_edge_recon_loss: 2659763.3447; train_gene_expr_recon_loss: 9782723.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19130.1099; train_chrom_access_recon_loss: 3664642.5379; train_global_loss: 16177157.3030; train_optim_loss: 16177157.3030; val_kl_reg_loss: 49671.2715; val_edge_recon_loss: 2692932.0625; val_gene_expr_recon_loss: 9838442.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19127.6465; val_chrom_access_recon_loss: 3649954.8125; val_global_loss: 16250129.0000; val_optim_loss: 16250129.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9619; val_auprc_score: 0.9474; val_best_acc_score: 0.9186; val_best_f1_score: 0.9218; train_kl_reg_loss: 50983.8970; train_edge_recon_loss: 2656365.3106; train_gene_expr_recon_loss: 9782640.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19125.2153; train_chrom_access_recon_loss: 3664081.8144; train_global_loss: 16173196.4545; train_optim_loss: 16173196.4545; val_kl_reg_loss: 49704.5249; val_edge_recon_loss: 2676559.1875; val_gene_expr_recon_loss: 10045047.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19122.6484; val_chrom_access_recon_loss: 3713655.0625; val_global_loss: 16504089.5000; val_optim_loss: 16504089.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9519; val_auprc_score: 0.9282; val_best_acc_score: 0.9022; val_best_f1_score: 0.9075; train_kl_reg_loss: 51075.2890; train_edge_recon_loss: 2655493.9129; train_gene_expr_recon_loss: 9786882.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19120.7702; train_chrom_access_recon_loss: 3667250.7576; train_global_loss: 16179823.5909; train_optim_loss: 16179823.5909; val_kl_reg_loss: 49806.8159; val_edge_recon_loss: 2718975.6562; val_gene_expr_recon_loss: 9884323.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19118.9551; val_chrom_access_recon_loss: 3643017.5938; val_global_loss: 16315242.2500; val_optim_loss: 16315242.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9632; val_auprc_score: 0.9482; val_best_acc_score: 0.9138; val_best_f1_score: 0.9161; train_kl_reg_loss: 51074.4558; train_edge_recon_loss: 2655482.1098; train_gene_expr_recon_loss: 9785823.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19117.1671; train_chrom_access_recon_loss: 3667356.8939; train_global_loss: 16178854.1970; train_optim_loss: 16178854.1970; val_kl_reg_loss: 49353.4854; val_edge_recon_loss: 2693489.7812; val_gene_expr_recon_loss: 9834656.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19115.5371; val_chrom_access_recon_loss: 3665313.7500; val_global_loss: 16261929.5000; val_optim_loss: 16261929.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9597; val_auprc_score: 0.9460; val_best_acc_score: 0.9111; val_best_f1_score: 0.9154; train_kl_reg_loss: 50956.1096; train_edge_recon_loss: 2657195.5417; train_gene_expr_recon_loss: 9788160.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19112.7880; train_chrom_access_recon_loss: 3667497.9659; train_global_loss: 16182922.5909; train_optim_loss: 16182922.5909; val_kl_reg_loss: 49498.0864; val_edge_recon_loss: 2696197.5625; val_gene_expr_recon_loss: 9864378.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19111.1309; val_chrom_access_recon_loss: 3676676.4062; val_global_loss: 16305861.2500; val_optim_loss: 16305861.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9569; val_auprc_score: 0.9402; val_best_acc_score: 0.9062; val_best_f1_score: 0.9110; train_kl_reg_loss: 50856.6352; train_edge_recon_loss: 2656005.6477; train_gene_expr_recon_loss: 9791937.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19093.9703; train_chrom_access_recon_loss: 3667084.9773; train_global_loss: 16184978.2273; train_optim_loss: 16184978.2273; val_kl_reg_loss: 49275.8652; val_edge_recon_loss: 2723586.0000; val_gene_expr_recon_loss: 9937262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19090.7344; val_chrom_access_recon_loss: 3670458.2812; val_global_loss: 16399673.1250; val_optim_loss: 16399673.1250
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9633; val_auprc_score: 0.9493; val_best_acc_score: 0.9135; val_best_f1_score: 0.9171; train_kl_reg_loss: 50862.0015; train_edge_recon_loss: 2651272.5492; train_gene_expr_recon_loss: 9783362.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19090.4921; train_chrom_access_recon_loss: 3667145.4659; train_global_loss: 16171732.8939; train_optim_loss: 16171732.8939; val_kl_reg_loss: 49480.2612; val_edge_recon_loss: 2671778.5000; val_gene_expr_recon_loss: 9884555.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19090.2520; val_chrom_access_recon_loss: 3648086.5312; val_global_loss: 16272990.5000; val_optim_loss: 16272990.5000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9603; val_auprc_score: 0.9431; val_best_acc_score: 0.9100; val_best_f1_score: 0.9143; train_kl_reg_loss: 50853.4521; train_edge_recon_loss: 2655394.1932; train_gene_expr_recon_loss: 9784881.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19089.9524; train_chrom_access_recon_loss: 3665345.2008; train_global_loss: 16175564.6667; train_optim_loss: 16175564.6667; val_kl_reg_loss: 49594.8838; val_edge_recon_loss: 2691094.8125; val_gene_expr_recon_loss: 9969612.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19089.6719; val_chrom_access_recon_loss: 3710047.2500; val_global_loss: 16439439.2500; val_optim_loss: 16439439.2500
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9593; val_auprc_score: 0.9437; val_best_acc_score: 0.9068; val_best_f1_score: 0.9103; train_kl_reg_loss: 50882.4207; train_edge_recon_loss: 2654531.4318; train_gene_expr_recon_loss: 9786109.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19089.4890; train_chrom_access_recon_loss: 3666621.2045; train_global_loss: 16177233.5606; train_optim_loss: 16177233.5606; val_kl_reg_loss: 49536.1089; val_edge_recon_loss: 2698207.5938; val_gene_expr_recon_loss: 10015637.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19089.2578; val_chrom_access_recon_loss: 3715580.0625; val_global_loss: 16498050.0000; val_optim_loss: 16498050.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 50 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9618
val AUPRC score: 0.9470
val best accuracy score: 0.9103
val best F1 score: 0.9121
val target rna MSE score: 1.1879
val source rna MSE score: 0.3345
val target atac MSE score: 0.4669
val source atac MSE score: 0.1013
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
