[True, False, True]
Run timestamp: 05092023_101353_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9211; val_auprc_score: 0.9862; val_best_acc_score: 0.9247; val_best_f1_score: 0.9580; train_kl_reg_loss: 16039.1558; train_edge_recon_loss: 719001.5995; train_cat_covariates_contrastive_loss: 101500.8373; train_gene_expr_recon_loss: 2531627.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59594.0269; train_global_loss: 3427763.0932; train_optim_loss: 3427763.0932; val_kl_reg_loss: 17086.6838; val_edge_recon_loss: 719258.1538; val_cat_covariates_contrastive_loss: 101422.3475; val_gene_expr_recon_loss: 2169661.4879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15541.3691; val_global_loss: 3022969.9152; val_optim_loss: 3022969.9152
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9314; val_auprc_score: 0.9877; val_best_acc_score: 0.9307; val_best_f1_score: 0.9611; train_kl_reg_loss: 18089.6544; train_edge_recon_loss: 693701.7271; train_cat_covariates_contrastive_loss: 101116.4459; train_gene_expr_recon_loss: 2048980.1781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15852.7282; train_global_loss: 2877740.7337; train_optim_loss: 2877740.7337; val_kl_reg_loss: 19283.4765; val_edge_recon_loss: 718034.8867; val_cat_covariates_contrastive_loss: 99989.9423; val_gene_expr_recon_loss: 1971747.6479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15961.5459; val_global_loss: 2825017.4533; val_optim_loss: 2825017.4533
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9381; val_auprc_score: 0.9889; val_best_acc_score: 0.9356; val_best_f1_score: 0.9638; train_kl_reg_loss: 19480.6562; train_edge_recon_loss: 690773.6763; train_cat_covariates_contrastive_loss: 100647.0033; train_gene_expr_recon_loss: 1938861.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16193.5221; train_global_loss: 2765956.8183; train_optim_loss: 2765956.8183; val_kl_reg_loss: 20046.7073; val_edge_recon_loss: 709282.8420; val_cat_covariates_contrastive_loss: 100888.5703; val_gene_expr_recon_loss: 1913457.7755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16265.4951; val_global_loss: 2759941.3875; val_optim_loss: 2759941.3875
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9391; val_auprc_score: 0.9892; val_best_acc_score: 0.9351; val_best_f1_score: 0.9637; train_kl_reg_loss: 20191.4604; train_edge_recon_loss: 688685.9195; train_cat_covariates_contrastive_loss: 100601.8608; train_gene_expr_recon_loss: 1898384.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16313.9946; train_global_loss: 2724177.8387; train_optim_loss: 2724177.8387; val_kl_reg_loss: 20563.8617; val_edge_recon_loss: 706437.7677; val_cat_covariates_contrastive_loss: 100763.1388; val_gene_expr_recon_loss: 1884345.8971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16474.5312; val_global_loss: 2728585.1721; val_optim_loss: 2728585.1721
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9433; val_auprc_score: 0.9898; val_best_acc_score: 0.9377; val_best_f1_score: 0.9649; train_kl_reg_loss: 20804.4312; train_edge_recon_loss: 689181.4017; train_cat_covariates_contrastive_loss: 100621.0455; train_gene_expr_recon_loss: 1874168.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16603.3040; train_global_loss: 2701378.6526; train_optim_loss: 2701378.6526; val_kl_reg_loss: 21128.5103; val_edge_recon_loss: 720289.2191; val_cat_covariates_contrastive_loss: 100908.1941; val_gene_expr_recon_loss: 1865122.9810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16753.4004; val_global_loss: 2724202.4031; val_optim_loss: 2724202.4031
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9407; val_auprc_score: 0.9893; val_best_acc_score: 0.9381; val_best_f1_score: 0.9652; train_kl_reg_loss: 21177.5933; train_edge_recon_loss: 688054.8392; train_cat_covariates_contrastive_loss: 100797.9744; train_gene_expr_recon_loss: 1857714.2139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16762.7230; train_global_loss: 2684507.3437; train_optim_loss: 2684507.3437; val_kl_reg_loss: 21960.1501; val_edge_recon_loss: 707183.1127; val_cat_covariates_contrastive_loss: 100269.3405; val_gene_expr_recon_loss: 1853229.9715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16742.6621; val_global_loss: 2699385.3261; val_optim_loss: 2699385.3261
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9434; val_auprc_score: 0.9901; val_best_acc_score: 0.9381; val_best_f1_score: 0.9652; train_kl_reg_loss: 21809.8567; train_edge_recon_loss: 685727.3483; train_cat_covariates_contrastive_loss: 100785.1708; train_gene_expr_recon_loss: 1846780.8193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16869.6384; train_global_loss: 2671972.8365; train_optim_loss: 2671972.8365; val_kl_reg_loss: 21434.6969; val_edge_recon_loss: 709829.7477; val_cat_covariates_contrastive_loss: 101652.5696; val_gene_expr_recon_loss: 1845816.8910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17060.1270; val_global_loss: 2695794.1557; val_optim_loss: 2695794.1557
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9451; val_auprc_score: 0.9902; val_best_acc_score: 0.9403; val_best_f1_score: 0.9664; train_kl_reg_loss: 22055.0479; train_edge_recon_loss: 688442.0345; train_cat_covariates_contrastive_loss: 100670.4997; train_gene_expr_recon_loss: 1835723.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17019.0953; train_global_loss: 2663910.5102; train_optim_loss: 2663910.5102; val_kl_reg_loss: 21834.4189; val_edge_recon_loss: 705860.5703; val_cat_covariates_contrastive_loss: 101534.5330; val_gene_expr_recon_loss: 1835275.6064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17047.6426; val_global_loss: 2681552.8728; val_optim_loss: 2681552.8728
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9445; val_auprc_score: 0.9901; val_best_acc_score: 0.9393; val_best_f1_score: 0.9659; train_kl_reg_loss: 22231.3437; train_edge_recon_loss: 686321.4047; train_cat_covariates_contrastive_loss: 100809.1886; train_gene_expr_recon_loss: 1828868.3605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17135.2697; train_global_loss: 2655365.5666; train_optim_loss: 2655365.5666; val_kl_reg_loss: 22118.0073; val_edge_recon_loss: 711800.3865; val_cat_covariates_contrastive_loss: 101502.0964; val_gene_expr_recon_loss: 1830903.7811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17184.3262; val_global_loss: 2683508.5182; val_optim_loss: 2683508.5182
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9459; val_auprc_score: 0.9903; val_best_acc_score: 0.9399; val_best_f1_score: 0.9661; train_kl_reg_loss: 22356.0537; train_edge_recon_loss: 687915.2898; train_cat_covariates_contrastive_loss: 100727.6662; train_gene_expr_recon_loss: 1821688.2560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17241.4419; train_global_loss: 2649928.7076; train_optim_loss: 2649928.7076; val_kl_reg_loss: 22283.9985; val_edge_recon_loss: 717534.1436; val_cat_covariates_contrastive_loss: 101623.0991; val_gene_expr_recon_loss: 1826183.3413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17249.0898; val_global_loss: 2684873.5839; val_optim_loss: 2684873.5839
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9481; val_auprc_score: 0.9907; val_best_acc_score: 0.9429; val_best_f1_score: 0.9678; train_kl_reg_loss: 22660.8548; train_edge_recon_loss: 687122.6761; train_cat_covariates_contrastive_loss: 100743.7759; train_gene_expr_recon_loss: 1817293.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17358.6085; train_global_loss: 2645179.4488; train_optim_loss: 2645179.4488; val_kl_reg_loss: 22643.2988; val_edge_recon_loss: 710591.4001; val_cat_covariates_contrastive_loss: 101505.3743; val_gene_expr_recon_loss: 1818336.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17573.4277; val_global_loss: 2670649.7682; val_optim_loss: 2670649.7682
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9460; val_auprc_score: 0.9901; val_best_acc_score: 0.9400; val_best_f1_score: 0.9662; train_kl_reg_loss: 22851.3913; train_edge_recon_loss: 687007.8224; train_cat_covariates_contrastive_loss: 100840.5022; train_gene_expr_recon_loss: 1812040.9506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17519.3893; train_global_loss: 2640260.0553; train_optim_loss: 2640260.0553; val_kl_reg_loss: 23159.1311; val_edge_recon_loss: 706237.5331; val_cat_covariates_contrastive_loss: 101087.0637; val_gene_expr_recon_loss: 1814532.3534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17801.3535; val_global_loss: 2662817.3330; val_optim_loss: 2662817.3330
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9440; val_auprc_score: 0.9896; val_best_acc_score: 0.9414; val_best_f1_score: 0.9670; train_kl_reg_loss: 22908.1037; train_edge_recon_loss: 686368.0902; train_cat_covariates_contrastive_loss: 100688.7584; train_gene_expr_recon_loss: 1807769.0344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17671.6900; train_global_loss: 2635405.6753; train_optim_loss: 2635405.6753; val_kl_reg_loss: 23511.5064; val_edge_recon_loss: 713658.1556; val_cat_covariates_contrastive_loss: 100263.4093; val_gene_expr_recon_loss: 1823195.5087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17731.1992; val_global_loss: 2678359.8296; val_optim_loss: 2678359.8296
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9465; val_auprc_score: 0.9902; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 23122.2795; train_edge_recon_loss: 686743.4615; train_cat_covariates_contrastive_loss: 100716.2307; train_gene_expr_recon_loss: 1805345.7716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17830.4053; train_global_loss: 2633758.1479; train_optim_loss: 2633758.1479; val_kl_reg_loss: 23367.4058; val_edge_recon_loss: 710112.4588; val_cat_covariates_contrastive_loss: 100784.8423; val_gene_expr_recon_loss: 1803944.0666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17963.5645; val_global_loss: 2656172.2716; val_optim_loss: 2656172.2716
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9488; val_auprc_score: 0.9909; val_best_acc_score: 0.9422; val_best_f1_score: 0.9675; train_kl_reg_loss: 23392.2830; train_edge_recon_loss: 686214.3713; train_cat_covariates_contrastive_loss: 100743.9552; train_gene_expr_recon_loss: 1801461.1683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17977.0012; train_global_loss: 2629788.7781; train_optim_loss: 2629788.7781; val_kl_reg_loss: 23436.3174; val_edge_recon_loss: 703718.8524; val_cat_covariates_contrastive_loss: 101496.5120; val_gene_expr_recon_loss: 1802349.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18077.6250; val_global_loss: 2649078.7578; val_optim_loss: 2649078.7578
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9349; val_auprc_score: 0.9879; val_best_acc_score: 0.9343; val_best_f1_score: 0.9632; train_kl_reg_loss: 23596.5995; train_edge_recon_loss: 686798.8972; train_cat_covariates_contrastive_loss: 100574.7542; train_gene_expr_recon_loss: 1823043.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18180.5718; train_global_loss: 2652194.4784; train_optim_loss: 2652194.4784; val_kl_reg_loss: 23468.1353; val_edge_recon_loss: 723194.1631; val_cat_covariates_contrastive_loss: 99249.2891; val_gene_expr_recon_loss: 2236189.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18063.8281; val_global_loss: 3100165.3114; val_optim_loss: 3100165.3114
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9486; val_auprc_score: 0.9908; val_best_acc_score: 0.9419; val_best_f1_score: 0.9674; train_kl_reg_loss: 24554.4767; train_edge_recon_loss: 684785.4515; train_cat_covariates_contrastive_loss: 100750.4315; train_gene_expr_recon_loss: 1834231.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18170.3252; train_global_loss: 2662491.7009; train_optim_loss: 2662491.7009; val_kl_reg_loss: 23930.5600; val_edge_recon_loss: 710018.0428; val_cat_covariates_contrastive_loss: 102032.4596; val_gene_expr_recon_loss: 1800519.4775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18247.3594; val_global_loss: 2654747.7837; val_optim_loss: 2654747.7837
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9030; val_auprc_score: 0.9827; val_best_acc_score: 0.9181; val_best_f1_score: 0.9542; train_kl_reg_loss: 32472.1910; train_edge_recon_loss: 694698.0067; train_cat_covariates_contrastive_loss: 100858.3821; train_gene_expr_recon_loss: 2288377.3290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19997.9804; train_global_loss: 3136403.8865; train_optim_loss: 3136403.8865; val_kl_reg_loss: 14209.4462; val_edge_recon_loss: 735673.4253; val_cat_covariates_contrastive_loss: 99542.2599; val_gene_expr_recon_loss: 2605113.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18212.7910; val_global_loss: 3472751.7690; val_optim_loss: 3472751.7690
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9475; val_auprc_score: 0.9906; val_best_acc_score: 0.9415; val_best_f1_score: 0.9670; train_kl_reg_loss: 20496.5704; train_edge_recon_loss: 689996.8332; train_cat_covariates_contrastive_loss: 99784.3846; train_gene_expr_recon_loss: 2169486.1579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18622.9222; train_global_loss: 2998386.8703; train_optim_loss: 2998386.8703; val_kl_reg_loss: 129948.7692; val_edge_recon_loss: 706304.6547; val_cat_covariates_contrastive_loss: 101316.4297; val_gene_expr_recon_loss: 1963209.9031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18557.2891; val_global_loss: 2919337.0026; val_optim_loss: 2919337.0026

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9457; val_auprc_score: 0.9900; val_best_acc_score: 0.9416; val_best_f1_score: 0.9671; train_kl_reg_loss: 37085.7344; train_edge_recon_loss: 681706.5910; train_cat_covariates_contrastive_loss: 100758.9245; train_gene_expr_recon_loss: 1923162.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9420.5402; train_global_loss: 2752133.8161; train_optim_loss: 2752133.8161; val_kl_reg_loss: 24757.6135; val_edge_recon_loss: 709760.4513; val_cat_covariates_contrastive_loss: 100663.8411; val_gene_expr_recon_loss: 1907227.2253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9387.4180; val_global_loss: 2751796.6332; val_optim_loss: 2751796.6332
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9474; val_auprc_score: 0.9904; val_best_acc_score: 0.9428; val_best_f1_score: 0.9678; train_kl_reg_loss: 24976.6374; train_edge_recon_loss: 681985.0519; train_cat_covariates_contrastive_loss: 100760.0449; train_gene_expr_recon_loss: 1883228.9360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9251.4318; train_global_loss: 2700202.0981; train_optim_loss: 2700202.0981; val_kl_reg_loss: 25582.0137; val_edge_recon_loss: 705627.8061; val_cat_covariates_contrastive_loss: 100795.1433; val_gene_expr_recon_loss: 1866446.9126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9159.3154; val_global_loss: 2707611.1228; val_optim_loss: 2707611.1228
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9496; val_auprc_score: 0.9909; val_best_acc_score: 0.9428; val_best_f1_score: 0.9678; train_kl_reg_loss: 25521.7263; train_edge_recon_loss: 684096.1327; train_cat_covariates_contrastive_loss: 100969.2844; train_gene_expr_recon_loss: 1842533.5819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9115.1310; train_global_loss: 2662235.8565; train_optim_loss: 2662235.8565; val_kl_reg_loss: 25843.8639; val_edge_recon_loss: 706708.7593; val_cat_covariates_contrastive_loss: 101230.1434; val_gene_expr_recon_loss: 1830121.6795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9045.9727; val_global_loss: 2672950.4498; val_optim_loss: 2672950.4498
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9505; val_auprc_score: 0.9912; val_best_acc_score: 0.9447; val_best_f1_score: 0.9689; train_kl_reg_loss: 25625.5118; train_edge_recon_loss: 682431.2465; train_cat_covariates_contrastive_loss: 100988.1953; train_gene_expr_recon_loss: 1809970.9338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9067.3774; train_global_loss: 2628083.2637; train_optim_loss: 2628083.2637; val_kl_reg_loss: 25494.7550; val_edge_recon_loss: 699575.2197; val_cat_covariates_contrastive_loss: 101423.7300; val_gene_expr_recon_loss: 1803518.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9046.0303; val_global_loss: 2639057.9092; val_optim_loss: 2639057.9092
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9493; val_auprc_score: 0.9907; val_best_acc_score: 0.9441; val_best_f1_score: 0.9685; train_kl_reg_loss: 25113.2416; train_edge_recon_loss: 683301.3848; train_cat_covariates_contrastive_loss: 100898.3411; train_gene_expr_recon_loss: 1790042.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9065.2011; train_global_loss: 2608420.2767; train_optim_loss: 2608420.2767; val_kl_reg_loss: 25070.4529; val_edge_recon_loss: 708382.4465; val_cat_covariates_contrastive_loss: 100882.6799; val_gene_expr_recon_loss: 1788508.9550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9057.7930; val_global_loss: 2631902.2829; val_optim_loss: 2631902.2829
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9503; val_auprc_score: 0.9909; val_best_acc_score: 0.9434; val_best_f1_score: 0.9681; train_kl_reg_loss: 24639.1180; train_edge_recon_loss: 685622.0469; train_cat_covariates_contrastive_loss: 100864.8815; train_gene_expr_recon_loss: 1777017.9292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9101.4796; train_global_loss: 2597245.4578; train_optim_loss: 2597245.4578; val_kl_reg_loss: 24505.2394; val_edge_recon_loss: 710247.2186; val_cat_covariates_contrastive_loss: 101245.7139; val_gene_expr_recon_loss: 1779320.7007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9182.1514; val_global_loss: 2624501.1246; val_optim_loss: 2624501.1246
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9441; val_auprc_score: 0.9899; val_best_acc_score: 0.9400; val_best_f1_score: 0.9663; train_kl_reg_loss: 24033.6739; train_edge_recon_loss: 686843.3002; train_cat_covariates_contrastive_loss: 101408.2364; train_gene_expr_recon_loss: 1691040.5731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7912.8132; train_global_loss: 2511238.5963; train_optim_loss: 2511238.5963; val_kl_reg_loss: 18671.2746; val_edge_recon_loss: 705466.8763; val_cat_covariates_contrastive_loss: 101276.9986; val_gene_expr_recon_loss: 1689202.3486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7616.3022; val_global_loss: 2522233.7439; val_optim_loss: 2522233.7439
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9464; val_auprc_score: 0.9904; val_best_acc_score: 0.9396; val_best_f1_score: 0.9660; train_kl_reg_loss: 22827.1949; train_edge_recon_loss: 686054.0070; train_cat_covariates_contrastive_loss: 100919.2191; train_gene_expr_recon_loss: 1676657.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7585.3249; train_global_loss: 2494043.1293; train_optim_loss: 2494043.1293; val_kl_reg_loss: 19147.4218; val_edge_recon_loss: 708099.3037; val_cat_covariates_contrastive_loss: 101105.2758; val_gene_expr_recon_loss: 1670966.8689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7606.2056; val_global_loss: 2506925.1133; val_optim_loss: 2506925.1133
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9439; val_auprc_score: 0.9898; val_best_acc_score: 0.9404; val_best_f1_score: 0.9665; train_kl_reg_loss: 21903.2495; train_edge_recon_loss: 687200.4290; train_cat_covariates_contrastive_loss: 100584.0899; train_gene_expr_recon_loss: 1660246.1695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7550.2014; train_global_loss: 2477484.1380; train_optim_loss: 2477484.1380; val_kl_reg_loss: 19594.3399; val_edge_recon_loss: 699562.6328; val_cat_covariates_contrastive_loss: 100318.8314; val_gene_expr_recon_loss: 1661484.7677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7493.1548; val_global_loss: 2488453.8192; val_optim_loss: 2488453.8192
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9440; val_auprc_score: 0.9897; val_best_acc_score: 0.9390; val_best_f1_score: 0.9657; train_kl_reg_loss: 865243091.4832; train_edge_recon_loss: 685443.2423; train_cat_covariates_contrastive_loss: 100403.6555; train_gene_expr_recon_loss: 1654020.3166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7542.5214; train_global_loss: 867690471.4989; train_optim_loss: 867690471.4989; val_kl_reg_loss: 20050.1676; val_edge_recon_loss: 709766.3207; val_cat_covariates_contrastive_loss: 100640.3739; val_gene_expr_recon_loss: 1659095.5160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7538.7075; val_global_loss: 2497091.1341; val_optim_loss: 2497091.1341
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9458; val_auprc_score: 0.9901; val_best_acc_score: 0.9405; val_best_f1_score: 0.9664; train_kl_reg_loss: 21375.6328; train_edge_recon_loss: 684227.6710; train_cat_covariates_contrastive_loss: 100277.8540; train_gene_expr_recon_loss: 1648992.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7560.3540; train_global_loss: 2462433.5627; train_optim_loss: 2462433.5627; val_kl_reg_loss: 19923.2791; val_edge_recon_loss: 707454.9842; val_cat_covariates_contrastive_loss: 100438.7200; val_gene_expr_recon_loss: 1650901.4425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7575.5581; val_global_loss: 2486293.9161; val_optim_loss: 2486293.9161
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9459; val_auprc_score: 0.9903; val_best_acc_score: 0.9407; val_best_f1_score: 0.9666; train_kl_reg_loss: 21130.8325; train_edge_recon_loss: 683288.6301; train_cat_covariates_contrastive_loss: 100239.9420; train_gene_expr_recon_loss: 1640892.8501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7564.8613; train_global_loss: 2453117.1169; train_optim_loss: 2453117.1169; val_kl_reg_loss: 19933.0570; val_edge_recon_loss: 699491.9506; val_cat_covariates_contrastive_loss: 100248.2522; val_gene_expr_recon_loss: 1645693.7924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7535.0093; val_global_loss: 2472902.0536; val_optim_loss: 2472902.0536
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9456; val_auprc_score: 0.9900; val_best_acc_score: 0.9414; val_best_f1_score: 0.9670; train_kl_reg_loss: 20937.4366; train_edge_recon_loss: 685657.6667; train_cat_covariates_contrastive_loss: 100217.3237; train_gene_expr_recon_loss: 1639747.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7571.3875; train_global_loss: 2454131.5546; train_optim_loss: 2454131.5546; val_kl_reg_loss: 19865.6162; val_edge_recon_loss: 706253.2628; val_cat_covariates_contrastive_loss: 100250.8343; val_gene_expr_recon_loss: 1645426.8568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7593.9785; val_global_loss: 2479390.5675; val_optim_loss: 2479390.5675
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9449; val_auprc_score: 0.9898; val_best_acc_score: 0.9406; val_best_f1_score: 0.9665; train_kl_reg_loss: 20858.8414; train_edge_recon_loss: 685302.6831; train_cat_covariates_contrastive_loss: 100158.2218; train_gene_expr_recon_loss: 1639061.5608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7580.8396; train_global_loss: 2452962.1446; train_optim_loss: 2452962.1446; val_kl_reg_loss: 19951.7816; val_edge_recon_loss: 706616.8586; val_cat_covariates_contrastive_loss: 100163.1806; val_gene_expr_recon_loss: 1645248.3058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7555.9082; val_global_loss: 2479536.1254; val_optim_loss: 2479536.1254
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9456; val_auprc_score: 0.9900; val_best_acc_score: 0.9406; val_best_f1_score: 0.9666; train_kl_reg_loss: 20744.5369; train_edge_recon_loss: 682589.4961; train_cat_covariates_contrastive_loss: 100135.7008; train_gene_expr_recon_loss: 1638136.0984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7585.6105; train_global_loss: 2449191.4415; train_optim_loss: 2449191.4415; val_kl_reg_loss: 19877.6161; val_edge_recon_loss: 706214.1653; val_cat_covariates_contrastive_loss: 100237.8402; val_gene_expr_recon_loss: 1642284.9278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7650.9355; val_global_loss: 2476265.5528; val_optim_loss: 2476265.5528
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9475; val_auprc_score: 0.9905; val_best_acc_score: 0.9421; val_best_f1_score: 0.9674; train_kl_reg_loss: 20581.5105; train_edge_recon_loss: 683340.6429; train_cat_covariates_contrastive_loss: 100120.8287; train_gene_expr_recon_loss: 1636212.4239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7596.5191; train_global_loss: 2447851.9284; train_optim_loss: 2447851.9284; val_kl_reg_loss: 19761.3006; val_edge_recon_loss: 701344.6799; val_cat_covariates_contrastive_loss: 100329.1946; val_gene_expr_recon_loss: 1642209.1116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7615.0161; val_global_loss: 2471259.2837; val_optim_loss: 2471259.2837
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9449; val_auprc_score: 0.9898; val_best_acc_score: 0.9409; val_best_f1_score: 0.9667; train_kl_reg_loss: 20477.0076; train_edge_recon_loss: 683555.4972; train_cat_covariates_contrastive_loss: 100072.5453; train_gene_expr_recon_loss: 1633916.2514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7604.8978; train_global_loss: 2445626.1989; train_optim_loss: 2445626.1989; val_kl_reg_loss: 19966.3054; val_edge_recon_loss: 711148.1985; val_cat_covariates_contrastive_loss: 100005.6914; val_gene_expr_recon_loss: 1638781.2119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7590.6533; val_global_loss: 2477492.1557; val_optim_loss: 2477492.1557
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9469; val_auprc_score: 0.9902; val_best_acc_score: 0.9417; val_best_f1_score: 0.9671; train_kl_reg_loss: 20435.7918; train_edge_recon_loss: 684381.6619; train_cat_covariates_contrastive_loss: 100134.8969; train_gene_expr_recon_loss: 1630578.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7610.1091; train_global_loss: 2443141.2485; train_optim_loss: 2443141.2485; val_kl_reg_loss: 19853.6664; val_edge_recon_loss: 711037.4409; val_cat_covariates_contrastive_loss: 100068.9931; val_gene_expr_recon_loss: 1638770.9810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7617.4526; val_global_loss: 2477348.5753; val_optim_loss: 2477348.5753
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9461; val_auprc_score: 0.9901; val_best_acc_score: 0.9422; val_best_f1_score: 0.9675; train_kl_reg_loss: 20466.6783; train_edge_recon_loss: 682923.9265; train_cat_covariates_contrastive_loss: 100185.4597; train_gene_expr_recon_loss: 1629094.8173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7619.3364; train_global_loss: 2440290.2155; train_optim_loss: 2440290.2155; val_kl_reg_loss: 19656.4739; val_edge_recon_loss: 703709.4349; val_cat_covariates_contrastive_loss: 100248.0068; val_gene_expr_recon_loss: 1637131.9784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7648.2759; val_global_loss: 2468394.1445; val_optim_loss: 2468394.1445
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9461; val_auprc_score: 0.9902; val_best_acc_score: 0.9409; val_best_f1_score: 0.9667; train_kl_reg_loss: 20338.4610; train_edge_recon_loss: 685821.3209; train_cat_covariates_contrastive_loss: 100059.9821; train_gene_expr_recon_loss: 1627562.6170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7634.1991; train_global_loss: 2441416.5788; train_optim_loss: 2441416.5788; val_kl_reg_loss: 19678.5343; val_edge_recon_loss: 707854.0993; val_cat_covariates_contrastive_loss: 100139.0554; val_gene_expr_recon_loss: 1633700.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7650.4897; val_global_loss: 2469022.8979; val_optim_loss: 2469022.8979
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9459; val_auprc_score: 0.9902; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 20247.4490; train_edge_recon_loss: 679460.5094; train_cat_covariates_contrastive_loss: 100018.0775; train_gene_expr_recon_loss: 1627142.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7654.3255; train_global_loss: 2434522.4811; train_optim_loss: 2434522.4811; val_kl_reg_loss: 19773.6623; val_edge_recon_loss: 704805.5888; val_cat_covariates_contrastive_loss: 99965.2002; val_gene_expr_recon_loss: 1633603.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7673.9351; val_global_loss: 2465822.3287; val_optim_loss: 2465822.3287
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9479; val_auprc_score: 0.9905; val_best_acc_score: 0.9413; val_best_f1_score: 0.9669; train_kl_reg_loss: 20126.0810; train_edge_recon_loss: 682874.0785; train_cat_covariates_contrastive_loss: 100023.0027; train_gene_expr_recon_loss: 1625810.2348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7680.4940; train_global_loss: 2436513.8861; train_optim_loss: 2436513.8861; val_kl_reg_loss: 19660.4711; val_edge_recon_loss: 706204.6058; val_cat_covariates_contrastive_loss: 100231.6010; val_gene_expr_recon_loss: 1633360.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7663.0498; val_global_loss: 2467120.3953; val_optim_loss: 2467120.3953
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9493; val_auprc_score: 0.9907; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 20025.6099; train_edge_recon_loss: 683963.8386; train_cat_covariates_contrastive_loss: 99951.9489; train_gene_expr_recon_loss: 1624177.6468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7708.5998; train_global_loss: 2435827.6437; train_optim_loss: 2435827.6437; val_kl_reg_loss: 19555.5094; val_edge_recon_loss: 715292.1927; val_cat_covariates_contrastive_loss: 100598.0301; val_gene_expr_recon_loss: 1630258.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7778.2637; val_global_loss: 2473482.4282; val_optim_loss: 2473482.4282
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9475; val_auprc_score: 0.9901; val_best_acc_score: 0.9417; val_best_f1_score: 0.9671; train_kl_reg_loss: 19962.4057; train_edge_recon_loss: 682556.5456; train_cat_covariates_contrastive_loss: 99949.9875; train_gene_expr_recon_loss: 1622889.0261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7732.3305; train_global_loss: 2433090.2978; train_optim_loss: 2433090.2978; val_kl_reg_loss: 19825.6894; val_edge_recon_loss: 711905.3099; val_cat_covariates_contrastive_loss: 99745.4212; val_gene_expr_recon_loss: 1629153.2898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7660.7554; val_global_loss: 2468290.4550; val_optim_loss: 2468290.4550
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9494; val_auprc_score: 0.9909; val_best_acc_score: 0.9427; val_best_f1_score: 0.9677; train_kl_reg_loss: 19865.5961; train_edge_recon_loss: 684827.4808; train_cat_covariates_contrastive_loss: 99947.1997; train_gene_expr_recon_loss: 1622925.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7741.5739; train_global_loss: 2435307.2878; train_optim_loss: 2435307.2878; val_kl_reg_loss: 19512.0929; val_edge_recon_loss: 706500.9715; val_cat_covariates_contrastive_loss: 100411.2200; val_gene_expr_recon_loss: 1629186.4901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7754.2075; val_global_loss: 2463365.0234; val_optim_loss: 2463365.0234
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9451; val_auprc_score: 0.9898; val_best_acc_score: 0.9422; val_best_f1_score: 0.9674; train_kl_reg_loss: 19797.0707; train_edge_recon_loss: 682412.7824; train_cat_covariates_contrastive_loss: 99919.6129; train_gene_expr_recon_loss: 1622691.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7766.7332; train_global_loss: 2432587.4663; train_optim_loss: 2432587.4663; val_kl_reg_loss: 19426.4547; val_edge_recon_loss: 707721.0662; val_cat_covariates_contrastive_loss: 99602.8727; val_gene_expr_recon_loss: 1629820.4983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7847.1807; val_global_loss: 2464418.1522; val_optim_loss: 2464418.1522
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9492; val_auprc_score: 0.9909; val_best_acc_score: 0.9428; val_best_f1_score: 0.9677; train_kl_reg_loss: 19746.0560; train_edge_recon_loss: 681303.5137; train_cat_covariates_contrastive_loss: 99881.2632; train_gene_expr_recon_loss: 1621385.9192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7789.1861; train_global_loss: 2430105.9360; train_optim_loss: 2430105.9360; val_kl_reg_loss: 19436.3459; val_edge_recon_loss: 701042.2726; val_cat_covariates_contrastive_loss: 99956.3168; val_gene_expr_recon_loss: 1628903.8235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7856.3281; val_global_loss: 2457195.0061; val_optim_loss: 2457195.0061
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9494; val_auprc_score: 0.9908; val_best_acc_score: 0.9432; val_best_f1_score: 0.9681; train_kl_reg_loss: 19702.9466; train_edge_recon_loss: 681541.9722; train_cat_covariates_contrastive_loss: 99799.8420; train_gene_expr_recon_loss: 1620655.8596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7786.5178; train_global_loss: 2429487.1401; train_optim_loss: 2429487.1401; val_kl_reg_loss: 19355.7149; val_edge_recon_loss: 698155.2495; val_cat_covariates_contrastive_loss: 99936.9821; val_gene_expr_recon_loss: 1625817.5151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7782.3691; val_global_loss: 2451047.7093; val_optim_loss: 2451047.7093
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9496; val_auprc_score: 0.9909; val_best_acc_score: 0.9426; val_best_f1_score: 0.9676; train_kl_reg_loss: 19628.3700; train_edge_recon_loss: 682143.3546; train_cat_covariates_contrastive_loss: 99915.4851; train_gene_expr_recon_loss: 1619846.8622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7787.2009; train_global_loss: 2429321.2726; train_optim_loss: 2429321.2726; val_kl_reg_loss: 19170.0814; val_edge_recon_loss: 703970.9035; val_cat_covariates_contrastive_loss: 100240.4641; val_gene_expr_recon_loss: 1626422.9589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7744.5713; val_global_loss: 2457548.9031; val_optim_loss: 2457548.9031
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9491; val_auprc_score: 0.9906; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 19542.7873; train_edge_recon_loss: 679683.5800; train_cat_covariates_contrastive_loss: 99878.8993; train_gene_expr_recon_loss: 1620330.3520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7795.8934; train_global_loss: 2427231.5106; train_optim_loss: 2427231.5106; val_kl_reg_loss: 19178.9564; val_edge_recon_loss: 705852.4362; val_cat_covariates_contrastive_loss: 99932.2843; val_gene_expr_recon_loss: 1627344.5320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7820.7119; val_global_loss: 2460128.9567; val_optim_loss: 2460128.9567
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9477; val_auprc_score: 0.9904; val_best_acc_score: 0.9424; val_best_f1_score: 0.9675; train_kl_reg_loss: 19483.4374; train_edge_recon_loss: 681554.2997; train_cat_covariates_contrastive_loss: 99845.2524; train_gene_expr_recon_loss: 1619565.9807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7807.2705; train_global_loss: 2428256.2381; train_optim_loss: 2428256.2381; val_kl_reg_loss: 19327.8966; val_edge_recon_loss: 702046.0400; val_cat_covariates_contrastive_loss: 99539.2854; val_gene_expr_recon_loss: 1628920.3971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7866.2778; val_global_loss: 2457699.8659; val_optim_loss: 2457699.8659
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9487; val_auprc_score: 0.9906; val_best_acc_score: 0.9425; val_best_f1_score: 0.9676; train_kl_reg_loss: 19388.5553; train_edge_recon_loss: 681828.8587; train_cat_covariates_contrastive_loss: 99781.1146; train_gene_expr_recon_loss: 1619516.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7843.4674; train_global_loss: 2428358.8250; train_optim_loss: 2428358.8250; val_kl_reg_loss: 19181.7629; val_edge_recon_loss: 706018.0963; val_cat_covariates_contrastive_loss: 99937.5116; val_gene_expr_recon_loss: 1625349.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7787.4995; val_global_loss: 2458274.4533; val_optim_loss: 2458274.4533

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9488; val_auprc_score: 0.9907; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 19302.2866; train_edge_recon_loss: 681067.8472; train_cat_covariates_contrastive_loss: 99781.5916; train_gene_expr_recon_loss: 1615775.9571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6997.6228; train_global_loss: 2422925.3017; train_optim_loss: 2422925.3017; val_kl_reg_loss: 19126.1534; val_edge_recon_loss: 701547.8893; val_cat_covariates_contrastive_loss: 99929.0656; val_gene_expr_recon_loss: 1624182.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6990.2017; val_global_loss: 2451775.3702; val_optim_loss: 2451775.3702
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9485; val_auprc_score: 0.9907; val_best_acc_score: 0.9422; val_best_f1_score: 0.9675; train_kl_reg_loss: 19310.0127; train_edge_recon_loss: 681168.6591; train_cat_covariates_contrastive_loss: 99772.8075; train_gene_expr_recon_loss: 1615383.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6988.0431; train_global_loss: 2422623.5004; train_optim_loss: 2422623.5004; val_kl_reg_loss: 19155.0882; val_edge_recon_loss: 705588.5547; val_cat_covariates_contrastive_loss: 99995.4865; val_gene_expr_recon_loss: 1622720.6497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6989.4360; val_global_loss: 2454449.2777; val_optim_loss: 2454449.2777
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9509; val_auprc_score: 0.9912; val_best_acc_score: 0.9432; val_best_f1_score: 0.9679; train_kl_reg_loss: 19346.8187; train_edge_recon_loss: 679990.8202; train_cat_covariates_contrastive_loss: 99769.7887; train_gene_expr_recon_loss: 1615554.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6990.6705; train_global_loss: 2421652.5914; train_optim_loss: 2421652.5914; val_kl_reg_loss: 19156.8579; val_edge_recon_loss: 701997.5570; val_cat_covariates_contrastive_loss: 100043.8745; val_gene_expr_recon_loss: 1622817.0277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6997.4727; val_global_loss: 2451012.8149; val_optim_loss: 2451012.8149
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9485; val_auprc_score: 0.9905; val_best_acc_score: 0.9419; val_best_f1_score: 0.9673; train_kl_reg_loss: 19310.2639; train_edge_recon_loss: 679350.6288; train_cat_covariates_contrastive_loss: 99755.9452; train_gene_expr_recon_loss: 1615338.5533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6994.7065; train_global_loss: 2420750.0974; train_optim_loss: 2420750.0974; val_kl_reg_loss: 19131.5140; val_edge_recon_loss: 708278.7716; val_cat_covariates_contrastive_loss: 99918.7601; val_gene_expr_recon_loss: 1622674.9144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6994.3569; val_global_loss: 2456998.2085; val_optim_loss: 2456998.2085
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9494; val_auprc_score: 0.9907; val_best_acc_score: 0.9432; val_best_f1_score: 0.9680; train_kl_reg_loss: 19336.4237; train_edge_recon_loss: 680313.0254; train_cat_covariates_contrastive_loss: 99773.4974; train_gene_expr_recon_loss: 1615162.3191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6990.3593; train_global_loss: 2421575.6245; train_optim_loss: 2421575.6245; val_kl_reg_loss: 19189.9197; val_edge_recon_loss: 701016.1185; val_cat_covariates_contrastive_loss: 99904.9111; val_gene_expr_recon_loss: 1623161.0112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6998.8188; val_global_loss: 2450270.7119; val_optim_loss: 2450270.7119
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9491; val_auprc_score: 0.9908; val_best_acc_score: 0.9422; val_best_f1_score: 0.9674; train_kl_reg_loss: 19330.8350; train_edge_recon_loss: 680981.5497; train_cat_covariates_contrastive_loss: 99749.6346; train_gene_expr_recon_loss: 1614592.9993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6994.9103; train_global_loss: 2421649.9298; train_optim_loss: 2421649.9298; val_kl_reg_loss: 19159.5049; val_edge_recon_loss: 708623.2457; val_cat_covariates_contrastive_loss: 100043.2296; val_gene_expr_recon_loss: 1623482.5969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6998.2988; val_global_loss: 2458306.8235; val_optim_loss: 2458306.8235
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9500; val_auprc_score: 0.9908; val_best_acc_score: 0.9425; val_best_f1_score: 0.9676; train_kl_reg_loss: 19323.5913; train_edge_recon_loss: 682373.3858; train_cat_covariates_contrastive_loss: 99775.8695; train_gene_expr_recon_loss: 1614650.2577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6987.5353; train_global_loss: 2423110.6430; train_optim_loss: 2423110.6430; val_kl_reg_loss: 19107.1493; val_edge_recon_loss: 707587.4770; val_cat_covariates_contrastive_loss: 99860.3998; val_gene_expr_recon_loss: 1623311.3028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6994.1694; val_global_loss: 2456860.5787; val_optim_loss: 2456860.5787
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9486; val_auprc_score: 0.9906; val_best_acc_score: 0.9425; val_best_f1_score: 0.9676; train_kl_reg_loss: 19295.4548; train_edge_recon_loss: 681820.2896; train_cat_covariates_contrastive_loss: 99743.5685; train_gene_expr_recon_loss: 1614300.4363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6992.4860; train_global_loss: 2422152.2366; train_optim_loss: 2422152.2366; val_kl_reg_loss: 19111.1648; val_edge_recon_loss: 708844.8090; val_cat_covariates_contrastive_loss: 99970.0411; val_gene_expr_recon_loss: 1622014.8460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6981.4854; val_global_loss: 2456922.3564; val_optim_loss: 2456922.3564
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9498; val_auprc_score: 0.9908; val_best_acc_score: 0.9432; val_best_f1_score: 0.9680; train_kl_reg_loss: 19300.4261; train_edge_recon_loss: 679818.4902; train_cat_covariates_contrastive_loss: 99745.5774; train_gene_expr_recon_loss: 1614425.8501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6995.6658; train_global_loss: 2420286.0052; train_optim_loss: 2420286.0052; val_kl_reg_loss: 19112.6323; val_edge_recon_loss: 699497.9274; val_cat_covariates_contrastive_loss: 99698.3010; val_gene_expr_recon_loss: 1623112.8910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7007.3682; val_global_loss: 2448429.0009; val_optim_loss: 2448429.0009
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9496; val_auprc_score: 0.9909; val_best_acc_score: 0.9428; val_best_f1_score: 0.9678; train_kl_reg_loss: 19259.1861; train_edge_recon_loss: 681029.9988; train_cat_covariates_contrastive_loss: 99795.5141; train_gene_expr_recon_loss: 1615007.8414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7002.9367; train_global_loss: 2422095.4751; train_optim_loss: 2422095.4751; val_kl_reg_loss: 19071.5990; val_edge_recon_loss: 701852.2939; val_cat_covariates_contrastive_loss: 99977.4041; val_gene_expr_recon_loss: 1622307.4970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7002.2441; val_global_loss: 2450211.0484; val_optim_loss: 2450211.0484
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9490; val_auprc_score: 0.9907; val_best_acc_score: 0.9431; val_best_f1_score: 0.9680; train_kl_reg_loss: 19250.2577; train_edge_recon_loss: 679177.3625; train_cat_covariates_contrastive_loss: 99730.8035; train_gene_expr_recon_loss: 1614357.8860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7000.6782; train_global_loss: 2419516.9859; train_optim_loss: 2419516.9859; val_kl_reg_loss: 19118.1669; val_edge_recon_loss: 706282.5575; val_cat_covariates_contrastive_loss: 99805.9559; val_gene_expr_recon_loss: 1622135.1051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7003.8525; val_global_loss: 2454345.5372; val_optim_loss: 2454345.5372
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9492; val_auprc_score: 0.9906; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 19280.2945; train_edge_recon_loss: 682901.3269; train_cat_covariates_contrastive_loss: 99703.8300; train_gene_expr_recon_loss: 1614262.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7009.9017; train_global_loss: 2423157.8165; train_optim_loss: 2423157.8165; val_kl_reg_loss: 19204.9682; val_edge_recon_loss: 709491.2811; val_cat_covariates_contrastive_loss: 99944.2028; val_gene_expr_recon_loss: 1621122.2634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7013.3589; val_global_loss: 2456775.9697; val_optim_loss: 2456775.9697
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9494; val_auprc_score: 0.9909; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 19282.1015; train_edge_recon_loss: 681410.4750; train_cat_covariates_contrastive_loss: 99637.6224; train_gene_expr_recon_loss: 1614540.1039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7009.4773; train_global_loss: 2421879.7841; train_optim_loss: 2421879.7841; val_kl_reg_loss: 19124.8209; val_edge_recon_loss: 698813.2072; val_cat_covariates_contrastive_loss: 99956.5236; val_gene_expr_recon_loss: 1622921.6254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7005.5361; val_global_loss: 2447821.6765; val_optim_loss: 2447821.6765
