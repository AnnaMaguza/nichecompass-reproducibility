[True]
Run timestamp: 07092023_074359_298.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_298']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 946 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4542, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6176; val_auprc_score: 0.6052; val_best_acc_score: 0.5021; val_best_f1_score: 0.6675; train_kl_reg_loss: 36177.5338; train_edge_recon_loss: 3560279.4773; train_gene_expr_recon_loss: 14686782.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1115449.7528; train_chrom_access_recon_loss: 5292416.7576; train_global_loss: 24691106.1818; train_optim_loss: 24691106.1818; val_kl_reg_loss: 214520.3906; val_edge_recon_loss: 4065282.6875; val_gene_expr_recon_loss: 13421499.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 844145.0000; val_chrom_access_recon_loss: 5061408.8125; val_global_loss: 23606856.5000; val_optim_loss: 23606856.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6781; val_auprc_score: 0.6489; val_best_acc_score: 0.5220; val_best_f1_score: 0.6753; train_kl_reg_loss: 82921.3326; train_edge_recon_loss: 3530247.3258; train_gene_expr_recon_loss: 13308648.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 616915.2064; train_chrom_access_recon_loss: 5021227.2348; train_global_loss: 22559959.9697; train_optim_loss: 22559959.9697; val_kl_reg_loss: 92858.0117; val_edge_recon_loss: 4063787.3750; val_gene_expr_recon_loss: 12939862.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 426113.0938; val_chrom_access_recon_loss: 4960795.1250; val_global_loss: 22483416.7500; val_optim_loss: 22483416.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7154; val_auprc_score: 0.7060; val_best_acc_score: 0.6346; val_best_f1_score: 0.6962; train_kl_reg_loss: 89099.9555; train_edge_recon_loss: 3516818.9962; train_gene_expr_recon_loss: 12997208.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 316286.4451; train_chrom_access_recon_loss: 4960530.8788; train_global_loss: 21879945.1515; train_optim_loss: 21879945.1515; val_kl_reg_loss: 87940.8555; val_edge_recon_loss: 4033622.9688; val_gene_expr_recon_loss: 12870908.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231447.1250; val_chrom_access_recon_loss: 4963181.5000; val_global_loss: 22187101.0000; val_optim_loss: 22187101.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7701; val_auprc_score: 0.7513; val_best_acc_score: 0.6816; val_best_f1_score: 0.7265; train_kl_reg_loss: 79218.2205; train_edge_recon_loss: 3495731.5682; train_gene_expr_recon_loss: 12862625.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183672.4666; train_chrom_access_recon_loss: 4926338.8561; train_global_loss: 21547586.5152; train_optim_loss: 21547586.5152; val_kl_reg_loss: 71045.2549; val_edge_recon_loss: 3842620.2188; val_gene_expr_recon_loss: 12858550.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146359.3750; val_chrom_access_recon_loss: 5010051.0625; val_global_loss: 21928627.2500; val_optim_loss: 21928627.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8092; val_auprc_score: 0.7862; val_best_acc_score: 0.7332; val_best_f1_score: 0.7678; train_kl_reg_loss: 65062.0182; train_edge_recon_loss: 3335891.7765; train_gene_expr_recon_loss: 12793693.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124159.6741; train_chrom_access_recon_loss: 4897954.8864; train_global_loss: 21216762.0303; train_optim_loss: 21216762.0303; val_kl_reg_loss: 73825.0874; val_edge_recon_loss: 3254527.3750; val_gene_expr_recon_loss: 12775312.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105863.9375; val_chrom_access_recon_loss: 4934762.1250; val_global_loss: 21144290.7500; val_optim_loss: 21144290.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8295; val_auprc_score: 0.7939; val_best_acc_score: 0.7448; val_best_f1_score: 0.7837; train_kl_reg_loss: 84270.5900; train_edge_recon_loss: 3063785.2121; train_gene_expr_recon_loss: 12734225.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93873.8763; train_chrom_access_recon_loss: 4877053.5152; train_global_loss: 20853209.0000; train_optim_loss: 20853209.0000; val_kl_reg_loss: 96123.6953; val_edge_recon_loss: 3027866.3438; val_gene_expr_recon_loss: 12599569.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82893.5781; val_chrom_access_recon_loss: 4864302.1250; val_global_loss: 20670756.2500; val_optim_loss: 20670756.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8524; val_auprc_score: 0.8270; val_best_acc_score: 0.7628; val_best_f1_score: 0.7924; train_kl_reg_loss: 91752.4734; train_edge_recon_loss: 2977571.8068; train_gene_expr_recon_loss: 12641102.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75130.0998; train_chrom_access_recon_loss: 4850940.1136; train_global_loss: 20636496.6364; train_optim_loss: 20636496.6364; val_kl_reg_loss: 91254.5918; val_edge_recon_loss: 2934603.8750; val_gene_expr_recon_loss: 12523321.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68551.1641; val_chrom_access_recon_loss: 4898681.4375; val_global_loss: 20516412.0000; val_optim_loss: 20516412.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8566; val_auprc_score: 0.8219; val_best_acc_score: 0.7824; val_best_f1_score: 0.7985; train_kl_reg_loss: 92318.7521; train_edge_recon_loss: 2934616.5227; train_gene_expr_recon_loss: 12572483.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63269.6709; train_chrom_access_recon_loss: 4829302.3712; train_global_loss: 20491991.3939; train_optim_loss: 20491991.3939; val_kl_reg_loss: 89305.7354; val_edge_recon_loss: 2942215.4688; val_gene_expr_recon_loss: 12474695.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58413.8203; val_chrom_access_recon_loss: 4865961.4375; val_global_loss: 20430592.0000; val_optim_loss: 20430592.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8788; val_auprc_score: 0.8409; val_best_acc_score: 0.8095; val_best_f1_score: 0.8233; train_kl_reg_loss: 88926.4364; train_edge_recon_loss: 2900578.3258; train_gene_expr_recon_loss: 12516035.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54719.2942; train_chrom_access_recon_loss: 4807056.3485; train_global_loss: 20367315.6667; train_optim_loss: 20367315.6667; val_kl_reg_loss: 86043.0830; val_edge_recon_loss: 2906198.0000; val_gene_expr_recon_loss: 12539238.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51297.4805; val_chrom_access_recon_loss: 4850468.6250; val_global_loss: 20433245.2500; val_optim_loss: 20433245.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8965; val_auprc_score: 0.8612; val_best_acc_score: 0.8305; val_best_f1_score: 0.8456; train_kl_reg_loss: 84375.9722; train_edge_recon_loss: 2862083.7462; train_gene_expr_recon_loss: 12444244.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48589.9444; train_chrom_access_recon_loss: 4778446.5909; train_global_loss: 20217740.4545; train_optim_loss: 20217740.4545; val_kl_reg_loss: 83822.8740; val_edge_recon_loss: 2856048.7188; val_gene_expr_recon_loss: 12373922.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46355.8672; val_chrom_access_recon_loss: 4768688.5000; val_global_loss: 20128838.2500; val_optim_loss: 20128838.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9056; val_auprc_score: 0.8743; val_best_acc_score: 0.8385; val_best_f1_score: 0.8501; train_kl_reg_loss: 86127.3777; train_edge_recon_loss: 2827929.6856; train_gene_expr_recon_loss: 12406749.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44223.5345; train_chrom_access_recon_loss: 4764651.5152; train_global_loss: 20129681.2424; train_optim_loss: 20129681.2424; val_kl_reg_loss: 86770.8740; val_edge_recon_loss: 2806381.2812; val_gene_expr_recon_loss: 12424730.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42588.5703; val_chrom_access_recon_loss: 4760612.5000; val_global_loss: 20121084.2500; val_optim_loss: 20121084.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9004; val_auprc_score: 0.8650; val_best_acc_score: 0.8313; val_best_f1_score: 0.8483; train_kl_reg_loss: 86873.8004; train_edge_recon_loss: 2805884.8561; train_gene_expr_recon_loss: 12354763.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41093.0456; train_chrom_access_recon_loss: 4746740.1970; train_global_loss: 20035354.9394; train_optim_loss: 20035354.9394; val_kl_reg_loss: 84057.1758; val_edge_recon_loss: 2862236.5938; val_gene_expr_recon_loss: 12191107.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39819.4766; val_chrom_access_recon_loss: 4688000.0625; val_global_loss: 19865221.0000; val_optim_loss: 19865221.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9110; val_auprc_score: 0.8838; val_best_acc_score: 0.8482; val_best_f1_score: 0.8602; train_kl_reg_loss: 83907.7621; train_edge_recon_loss: 2795609.4470; train_gene_expr_recon_loss: 12315253.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38903.4243; train_chrom_access_recon_loss: 4730013.6212; train_global_loss: 19963688.2121; train_optim_loss: 19963688.2121; val_kl_reg_loss: 80433.5869; val_edge_recon_loss: 2837073.2500; val_gene_expr_recon_loss: 12251985.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38228.8438; val_chrom_access_recon_loss: 4748223.0625; val_global_loss: 19955944.2500; val_optim_loss: 19955944.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9171; val_auprc_score: 0.8904; val_best_acc_score: 0.8595; val_best_f1_score: 0.8689; train_kl_reg_loss: 81725.7152; train_edge_recon_loss: 2790924.1667; train_gene_expr_recon_loss: 12268940.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37449.0701; train_chrom_access_recon_loss: 4717935.2576; train_global_loss: 19896974.2121; train_optim_loss: 19896974.2121; val_kl_reg_loss: 82235.2559; val_edge_recon_loss: 2807837.5625; val_gene_expr_recon_loss: 12127774.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36780.7188; val_chrom_access_recon_loss: 4709695.8125; val_global_loss: 19764323.7500; val_optim_loss: 19764323.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9215; val_auprc_score: 0.8949; val_best_acc_score: 0.8573; val_best_f1_score: 0.8665; train_kl_reg_loss: 80151.1120; train_edge_recon_loss: 2776178.1780; train_gene_expr_recon_loss: 12244013.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36475.4107; train_chrom_access_recon_loss: 4705565.6439; train_global_loss: 19842384.0909; train_optim_loss: 19842384.0909; val_kl_reg_loss: 80685.2676; val_edge_recon_loss: 2831639.4688; val_gene_expr_recon_loss: 12152806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36106.1836; val_chrom_access_recon_loss: 4656704.5938; val_global_loss: 19757942.0000; val_optim_loss: 19757942.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9147; val_auprc_score: 0.8889; val_best_acc_score: 0.8528; val_best_f1_score: 0.8618; train_kl_reg_loss: 81091.7933; train_edge_recon_loss: 2762744.1780; train_gene_expr_recon_loss: 12204265.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35738.1029; train_chrom_access_recon_loss: 4686052.9091; train_global_loss: 19769892.8182; train_optim_loss: 19769892.8182; val_kl_reg_loss: 79831.3848; val_edge_recon_loss: 2812677.0938; val_gene_expr_recon_loss: 12128604.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35397.4727; val_chrom_access_recon_loss: 4705433.5000; val_global_loss: 19761943.2500; val_optim_loss: 19761943.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9255; val_auprc_score: 0.9051; val_best_acc_score: 0.8608; val_best_f1_score: 0.8690; train_kl_reg_loss: 78982.1922; train_edge_recon_loss: 2754594.5455; train_gene_expr_recon_loss: 12161637.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35249.6554; train_chrom_access_recon_loss: 4677176.5758; train_global_loss: 19707640.5455; train_optim_loss: 19707640.5455; val_kl_reg_loss: 78260.6387; val_edge_recon_loss: 2778873.1250; val_gene_expr_recon_loss: 12126612.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35362.4922; val_chrom_access_recon_loss: 4760981.6250; val_global_loss: 19780090.0000; val_optim_loss: 19780090.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9227; val_auprc_score: 0.8975; val_best_acc_score: 0.8616; val_best_f1_score: 0.8709; train_kl_reg_loss: 76766.4047; train_edge_recon_loss: 2751366.1780; train_gene_expr_recon_loss: 12133270.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35056.2976; train_chrom_access_recon_loss: 4659541.6061; train_global_loss: 19656000.7576; train_optim_loss: 19656000.7576; val_kl_reg_loss: 76850.0469; val_edge_recon_loss: 2760871.1250; val_gene_expr_recon_loss: 12024527.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34889.0742; val_chrom_access_recon_loss: 4634047.1250; val_global_loss: 19531185.0000; val_optim_loss: 19531185.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9309; val_auprc_score: 0.9074; val_best_acc_score: 0.8735; val_best_f1_score: 0.8813; train_kl_reg_loss: 76998.3395; train_edge_recon_loss: 2744641.7424; train_gene_expr_recon_loss: 12101583.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34714.6009; train_chrom_access_recon_loss: 4646021.7955; train_global_loss: 19603960.3636; train_optim_loss: 19603960.3636; val_kl_reg_loss: 74694.4395; val_edge_recon_loss: 2756366.5312; val_gene_expr_recon_loss: 12057465.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34579.9492; val_chrom_access_recon_loss: 4642480.6875; val_global_loss: 19565587.2500; val_optim_loss: 19565587.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9294; val_auprc_score: 0.9049; val_best_acc_score: 0.8735; val_best_f1_score: 0.8831; train_kl_reg_loss: 74690.6991; train_edge_recon_loss: 2744521.6061; train_gene_expr_recon_loss: 12074039.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34361.8789; train_chrom_access_recon_loss: 4635249.4242; train_global_loss: 19562862.9394; train_optim_loss: 19562862.9394; val_kl_reg_loss: 73452.5801; val_edge_recon_loss: 2735535.4375; val_gene_expr_recon_loss: 11864343.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34235.4336; val_chrom_access_recon_loss: 4582612.8438; val_global_loss: 19290178.7500; val_optim_loss: 19290178.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9321; val_auprc_score: 0.9058; val_best_acc_score: 0.8751; val_best_f1_score: 0.8841; train_kl_reg_loss: 74356.4747; train_edge_recon_loss: 2726202.2576; train_gene_expr_recon_loss: 12037551.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33972.7971; train_chrom_access_recon_loss: 4620892.5152; train_global_loss: 19492975.8485; train_optim_loss: 19492975.8485; val_kl_reg_loss: 72392.5703; val_edge_recon_loss: 2762961.3438; val_gene_expr_recon_loss: 11975270.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33801.1328; val_chrom_access_recon_loss: 4643395.1250; val_global_loss: 19487820.5000; val_optim_loss: 19487820.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9337; val_auprc_score: 0.9091; val_best_acc_score: 0.8810; val_best_f1_score: 0.8884; train_kl_reg_loss: 71969.3460; train_edge_recon_loss: 2725232.7348; train_gene_expr_recon_loss: 12027004.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33679.8560; train_chrom_access_recon_loss: 4619795.5606; train_global_loss: 19477682.1818; train_optim_loss: 19477682.1818; val_kl_reg_loss: 70868.1113; val_edge_recon_loss: 2732880.1250; val_gene_expr_recon_loss: 11904064.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33603.6641; val_chrom_access_recon_loss: 4593349.2500; val_global_loss: 19334766.2500; val_optim_loss: 19334766.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9254; val_auprc_score: 0.8944; val_best_acc_score: 0.8651; val_best_f1_score: 0.8750; train_kl_reg_loss: 71421.1880; train_edge_recon_loss: 2719088.4091; train_gene_expr_recon_loss: 11991929.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33371.1255; train_chrom_access_recon_loss: 4604752.3182; train_global_loss: 19420562.2727; train_optim_loss: 19420562.2727; val_kl_reg_loss: 72371.3408; val_edge_recon_loss: 2773900.6875; val_gene_expr_recon_loss: 11923671.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33207.5391; val_chrom_access_recon_loss: 4603271.6250; val_global_loss: 19406423.2500; val_optim_loss: 19406423.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9375; val_auprc_score: 0.9162; val_best_acc_score: 0.8791; val_best_f1_score: 0.8863; train_kl_reg_loss: 71142.1120; train_edge_recon_loss: 2722209.6326; train_gene_expr_recon_loss: 11970687.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33145.4644; train_chrom_access_recon_loss: 4592754.9924; train_global_loss: 19389939.3636; train_optim_loss: 19389939.3636; val_kl_reg_loss: 68192.2178; val_edge_recon_loss: 2752666.8750; val_gene_expr_recon_loss: 11860816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32988.5820; val_chrom_access_recon_loss: 4582591.2500; val_global_loss: 19297255.5000; val_optim_loss: 19297255.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9375; val_auprc_score: 0.9144; val_best_acc_score: 0.8743; val_best_f1_score: 0.8822; train_kl_reg_loss: 68875.6671; train_edge_recon_loss: 2709938.6212; train_gene_expr_recon_loss: 11948295.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28641.2638; train_chrom_access_recon_loss: 4583747.0909; train_global_loss: 19339498.4242; train_optim_loss: 19339498.4242; val_kl_reg_loss: 70077.8633; val_edge_recon_loss: 2750217.5000; val_gene_expr_recon_loss: 11870424.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27206.6445; val_chrom_access_recon_loss: 4610326.1250; val_global_loss: 19328253.7500; val_optim_loss: 19328253.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9327; val_auprc_score: 0.9039; val_best_acc_score: 0.8772; val_best_f1_score: 0.8865; train_kl_reg_loss: 76398.1580; train_edge_recon_loss: 2777125.1780; train_gene_expr_recon_loss: 11682737.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26169.7616; train_chrom_access_recon_loss: 4565137.7652; train_global_loss: 19127568.6667; train_optim_loss: 19127568.6667; val_kl_reg_loss: 40119.3301; val_edge_recon_loss: 2821551.5938; val_gene_expr_recon_loss: 11578380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25228.7910; val_chrom_access_recon_loss: 4516588.1250; val_global_loss: 18981868.2500; val_optim_loss: 18981868.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9370; val_auprc_score: 0.9124; val_best_acc_score: 0.8839; val_best_f1_score: 0.8917; train_kl_reg_loss: 82949.0546; train_edge_recon_loss: 2772444.7538; train_gene_expr_recon_loss: 11557612.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24547.0001; train_chrom_access_recon_loss: 4466683.1288; train_global_loss: 18904236.7576; train_optim_loss: 18904236.7576; val_kl_reg_loss: 41494.3931; val_edge_recon_loss: 2788118.5938; val_gene_expr_recon_loss: 11425941.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23911.0371; val_chrom_access_recon_loss: 4430935.8438; val_global_loss: 18710401.0000; val_optim_loss: 18710401.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9350; val_auprc_score: 0.9068; val_best_acc_score: 0.8847; val_best_f1_score: 0.8924; train_kl_reg_loss: 86493.5929; train_edge_recon_loss: 2766400.1705; train_gene_expr_recon_loss: 11525710.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23400.4222; train_chrom_access_recon_loss: 4444230.7235; train_global_loss: 18846235.9697; train_optim_loss: 18846235.9697; val_kl_reg_loss: 42499.2310; val_edge_recon_loss: 2776252.6562; val_gene_expr_recon_loss: 11519728.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22923.8125; val_chrom_access_recon_loss: 4448286.7500; val_global_loss: 18809691.2500; val_optim_loss: 18809691.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9358; val_auprc_score: 0.9138; val_best_acc_score: 0.8764; val_best_f1_score: 0.8846; train_kl_reg_loss: 88350.7332; train_edge_recon_loss: 2759246.4015; train_gene_expr_recon_loss: 11475285.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22555.6700; train_chrom_access_recon_loss: 4409929.7424; train_global_loss: 18755368.0909; train_optim_loss: 18755368.0909; val_kl_reg_loss: 41940.2896; val_edge_recon_loss: 2828848.4375; val_gene_expr_recon_loss: 11361440.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22219.8223; val_chrom_access_recon_loss: 4392399.3125; val_global_loss: 18646848.5000; val_optim_loss: 18646848.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9398; val_auprc_score: 0.9226; val_best_acc_score: 0.8802; val_best_f1_score: 0.8890; train_kl_reg_loss: 88820.8363; train_edge_recon_loss: 2769693.0000; train_gene_expr_recon_loss: 11452309.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21964.7001; train_chrom_access_recon_loss: 4398220.5455; train_global_loss: 18731008.6364; train_optim_loss: 18731008.6364; val_kl_reg_loss: 42444.5864; val_edge_recon_loss: 2774909.7812; val_gene_expr_recon_loss: 11482983.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21721.1855; val_chrom_access_recon_loss: 4443388.6875; val_global_loss: 18765447.5000; val_optim_loss: 18765447.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9373; val_auprc_score: 0.9153; val_best_acc_score: 0.8764; val_best_f1_score: 0.8851; train_kl_reg_loss: 88983.6863; train_edge_recon_loss: 2767638.7879; train_gene_expr_recon_loss: 11439064.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21521.7744; train_chrom_access_recon_loss: 4394407.0985; train_global_loss: 18711616.1818; train_optim_loss: 18711616.1818; val_kl_reg_loss: 41697.8896; val_edge_recon_loss: 2787732.1250; val_gene_expr_recon_loss: 11453299.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21329.8379; val_chrom_access_recon_loss: 4445192.1875; val_global_loss: 18749252.2500; val_optim_loss: 18749252.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9372; val_auprc_score: 0.9145; val_best_acc_score: 0.8767; val_best_f1_score: 0.8859; train_kl_reg_loss: 88646.7332; train_edge_recon_loss: 2759239.7500; train_gene_expr_recon_loss: 11437569.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21177.5266; train_chrom_access_recon_loss: 4395000.2045; train_global_loss: 18701633.3333; train_optim_loss: 18701633.3333; val_kl_reg_loss: 41226.1836; val_edge_recon_loss: 2780536.1875; val_gene_expr_recon_loss: 11400336.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21030.1074; val_chrom_access_recon_loss: 4430365.5625; val_global_loss: 18673494.7500; val_optim_loss: 18673494.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9401; val_auprc_score: 0.9221; val_best_acc_score: 0.8772; val_best_f1_score: 0.8866; train_kl_reg_loss: 88543.5078; train_edge_recon_loss: 2761712.7576; train_gene_expr_recon_loss: 11415798.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20906.9660; train_chrom_access_recon_loss: 4383725.1098; train_global_loss: 18670686.3939; train_optim_loss: 18670686.3939; val_kl_reg_loss: 41509.4033; val_edge_recon_loss: 2775321.1875; val_gene_expr_recon_loss: 11365634.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20782.8945; val_chrom_access_recon_loss: 4374478.6875; val_global_loss: 18577727.0000; val_optim_loss: 18577727.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9359; val_auprc_score: 0.9125; val_best_acc_score: 0.8775; val_best_f1_score: 0.8861; train_kl_reg_loss: 88121.4419; train_edge_recon_loss: 2748984.5644; train_gene_expr_recon_loss: 11420212.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20678.5505; train_chrom_access_recon_loss: 4386007.9735; train_global_loss: 18664004.5758; train_optim_loss: 18664004.5758; val_kl_reg_loss: 42304.6216; val_edge_recon_loss: 2815660.8750; val_gene_expr_recon_loss: 11399400.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20581.9590; val_chrom_access_recon_loss: 4412276.0000; val_global_loss: 18690224.0000; val_optim_loss: 18690224.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9327; val_auprc_score: 0.9054; val_best_acc_score: 0.8743; val_best_f1_score: 0.8840; train_kl_reg_loss: 87700.0140; train_edge_recon_loss: 2758353.6326; train_gene_expr_recon_loss: 11411587.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20500.1508; train_chrom_access_recon_loss: 4379933.4394; train_global_loss: 18658074.6970; train_optim_loss: 18658074.6970; val_kl_reg_loss: 42630.9668; val_edge_recon_loss: 2797642.7500; val_gene_expr_recon_loss: 11407774.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20421.1602; val_chrom_access_recon_loss: 4400701.0625; val_global_loss: 18669170.5000; val_optim_loss: 18669170.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9185; val_best_acc_score: 0.8834; val_best_f1_score: 0.8910; train_kl_reg_loss: 87475.5066; train_edge_recon_loss: 2751911.3333; train_gene_expr_recon_loss: 11400706.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20348.5775; train_chrom_access_recon_loss: 4382370.1402; train_global_loss: 18642812.1212; train_optim_loss: 18642812.1212; val_kl_reg_loss: 42309.4150; val_edge_recon_loss: 2776768.5938; val_gene_expr_recon_loss: 11357608.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20275.1309; val_chrom_access_recon_loss: 4392608.5000; val_global_loss: 18589570.2500; val_optim_loss: 18589570.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9412; val_auprc_score: 0.9151; val_best_acc_score: 0.8858; val_best_f1_score: 0.8917; train_kl_reg_loss: 86762.0262; train_edge_recon_loss: 2759501.9508; train_gene_expr_recon_loss: 11384409.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20220.3363; train_chrom_access_recon_loss: 4376109.9621; train_global_loss: 18627004.0606; train_optim_loss: 18627004.0606; val_kl_reg_loss: 41393.9448; val_edge_recon_loss: 2763055.3750; val_gene_expr_recon_loss: 11345235.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20171.2695; val_chrom_access_recon_loss: 4413467.3125; val_global_loss: 18583323.2500; val_optim_loss: 18583323.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9293; val_auprc_score: 0.8990; val_best_acc_score: 0.8740; val_best_f1_score: 0.8832; train_kl_reg_loss: 85732.8655; train_edge_recon_loss: 2753672.3182; train_gene_expr_recon_loss: 11357441.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19965.1083; train_chrom_access_recon_loss: 4369414.7083; train_global_loss: 18586226.3636; train_optim_loss: 18586226.3636; val_kl_reg_loss: 41864.5513; val_edge_recon_loss: 2785645.1875; val_gene_expr_recon_loss: 11366859.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19923.2949; val_chrom_access_recon_loss: 4397277.0312; val_global_loss: 18611569.0000; val_optim_loss: 18611569.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9421; val_auprc_score: 0.9149; val_best_acc_score: 0.8864; val_best_f1_score: 0.8903; train_kl_reg_loss: 85897.2080; train_edge_recon_loss: 2752126.3902; train_gene_expr_recon_loss: 11356165.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19916.0478; train_chrom_access_recon_loss: 4368209.3220; train_global_loss: 18582314.9697; train_optim_loss: 18582314.9697; val_kl_reg_loss: 41983.8921; val_edge_recon_loss: 2765515.1562; val_gene_expr_recon_loss: 11334907.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19909.6719; val_chrom_access_recon_loss: 4345510.8125; val_global_loss: 18507827.2500; val_optim_loss: 18507827.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9412; val_auprc_score: 0.9222; val_best_acc_score: 0.8839; val_best_f1_score: 0.8926; train_kl_reg_loss: 85927.3198; train_edge_recon_loss: 2746022.8598; train_gene_expr_recon_loss: 11342380.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19903.3102; train_chrom_access_recon_loss: 4365320.9470; train_global_loss: 18559554.6061; train_optim_loss: 18559554.6061; val_kl_reg_loss: 41590.2739; val_edge_recon_loss: 2755671.4375; val_gene_expr_recon_loss: 11329150.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19896.6758; val_chrom_access_recon_loss: 4371684.9062; val_global_loss: 18517994.0000; val_optim_loss: 18517994.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9374; val_auprc_score: 0.9192; val_best_acc_score: 0.8735; val_best_f1_score: 0.8821; train_kl_reg_loss: 86032.2314; train_edge_recon_loss: 2747234.5644; train_gene_expr_recon_loss: 11358084.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19890.8718; train_chrom_access_recon_loss: 4374789.2727; train_global_loss: 18586031.0303; train_optim_loss: 18586031.0303; val_kl_reg_loss: 42101.0210; val_edge_recon_loss: 2806243.0312; val_gene_expr_recon_loss: 11317012.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19884.7070; val_chrom_access_recon_loss: 4395007.4375; val_global_loss: 18580249.5000; val_optim_loss: 18580249.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9329; val_auprc_score: 0.9079; val_best_acc_score: 0.8745; val_best_f1_score: 0.8823; train_kl_reg_loss: 85783.3588; train_edge_recon_loss: 2752328.5417; train_gene_expr_recon_loss: 11357199.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19879.0453; train_chrom_access_recon_loss: 4371808.1742; train_global_loss: 18586998.0606; train_optim_loss: 18586998.0606; val_kl_reg_loss: 41842.1772; val_edge_recon_loss: 2815687.8125; val_gene_expr_recon_loss: 11402265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19872.9102; val_chrom_access_recon_loss: 4400164.6250; val_global_loss: 18679832.7500; val_optim_loss: 18679832.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9387; val_auprc_score: 0.9152; val_best_acc_score: 0.8826; val_best_f1_score: 0.8902; train_kl_reg_loss: 85968.2285; train_edge_recon_loss: 2754108.1023; train_gene_expr_recon_loss: 11345142.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19866.7747; train_chrom_access_recon_loss: 4370731.6894; train_global_loss: 18575817.0909; train_optim_loss: 18575817.0909; val_kl_reg_loss: 41564.9883; val_edge_recon_loss: 2775896.7812; val_gene_expr_recon_loss: 11359816.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19861.0254; val_chrom_access_recon_loss: 4372162.1250; val_global_loss: 18569301.2500; val_optim_loss: 18569301.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9439; val_auprc_score: 0.9219; val_best_acc_score: 0.8831; val_best_f1_score: 0.8906; train_kl_reg_loss: 85627.0771; train_edge_recon_loss: 2754696.8939; train_gene_expr_recon_loss: 11348285.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19838.8235; train_chrom_access_recon_loss: 4373070.1212; train_global_loss: 18581518.3939; train_optim_loss: 18581518.3939; val_kl_reg_loss: 41442.6523; val_edge_recon_loss: 2788454.0938; val_gene_expr_recon_loss: 11303209.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19834.3789; val_chrom_access_recon_loss: 4400972.5938; val_global_loss: 18553913.2500; val_optim_loss: 18553913.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9406; val_auprc_score: 0.9226; val_best_acc_score: 0.8850; val_best_f1_score: 0.8922; train_kl_reg_loss: 85764.8617; train_edge_recon_loss: 2752775.8447; train_gene_expr_recon_loss: 11339238.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19833.5582; train_chrom_access_recon_loss: 4369472.0189; train_global_loss: 18567084.1515; train_optim_loss: 18567084.1515; val_kl_reg_loss: 41793.8066; val_edge_recon_loss: 2758704.5625; val_gene_expr_recon_loss: 11325866.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19832.7734; val_chrom_access_recon_loss: 4382406.6875; val_global_loss: 18528604.2500; val_optim_loss: 18528604.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9318; val_auprc_score: 0.9059; val_best_acc_score: 0.8743; val_best_f1_score: 0.8830; train_kl_reg_loss: 85747.8871; train_edge_recon_loss: 2752067.8864; train_gene_expr_recon_loss: 11340208.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19831.9898; train_chrom_access_recon_loss: 4369830.8447; train_global_loss: 18567687.2424; train_optim_loss: 18567687.2424; val_kl_reg_loss: 41321.7852; val_edge_recon_loss: 2816162.8438; val_gene_expr_recon_loss: 11235156.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19831.1875; val_chrom_access_recon_loss: 4373049.0000; val_global_loss: 18485520.7500; val_optim_loss: 18485520.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9381; val_auprc_score: 0.9164; val_best_acc_score: 0.8794; val_best_f1_score: 0.8876; train_kl_reg_loss: 85784.4545; train_edge_recon_loss: 2748393.9318; train_gene_expr_recon_loss: 11342825.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19830.4806; train_chrom_access_recon_loss: 4370311.9167; train_global_loss: 18567145.8485; train_optim_loss: 18567145.8485; val_kl_reg_loss: 41353.0405; val_edge_recon_loss: 2793523.5000; val_gene_expr_recon_loss: 11319475.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19829.7461; val_chrom_access_recon_loss: 4391426.7500; val_global_loss: 18565608.5000; val_optim_loss: 18565608.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9362; val_auprc_score: 0.9122; val_best_acc_score: 0.8799; val_best_f1_score: 0.8887; train_kl_reg_loss: 85708.8129; train_edge_recon_loss: 2747099.3371; train_gene_expr_recon_loss: 11338701.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19829.0905; train_chrom_access_recon_loss: 4372564.2424; train_global_loss: 18563902.7879; train_optim_loss: 18563902.7879; val_kl_reg_loss: 41399.8428; val_edge_recon_loss: 2791535.9062; val_gene_expr_recon_loss: 11219549.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19828.4980; val_chrom_access_recon_loss: 4368731.0625; val_global_loss: 18441043.7500; val_optim_loss: 18441043.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9328; val_auprc_score: 0.9038; val_best_acc_score: 0.8826; val_best_f1_score: 0.8889; train_kl_reg_loss: 85673.2189; train_edge_recon_loss: 2755060.2538; train_gene_expr_recon_loss: 11336957.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19827.7166; train_chrom_access_recon_loss: 4367378.5379; train_global_loss: 18564896.7879; train_optim_loss: 18564896.7879; val_kl_reg_loss: 41029.1562; val_edge_recon_loss: 2790931.7812; val_gene_expr_recon_loss: 11351124.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19827.0332; val_chrom_access_recon_loss: 4375156.5000; val_global_loss: 18578068.5000; val_optim_loss: 18578068.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9404; val_auprc_score: 0.9153; val_best_acc_score: 0.8864; val_best_f1_score: 0.8932; train_kl_reg_loss: 85729.2786; train_edge_recon_loss: 2749040.0341; train_gene_expr_recon_loss: 11345794.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19826.4031; train_chrom_access_recon_loss: 4371285.5947; train_global_loss: 18571675.3333; train_optim_loss: 18571675.3333; val_kl_reg_loss: 40999.9956; val_edge_recon_loss: 2757350.4688; val_gene_expr_recon_loss: 11158700.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19825.6484; val_chrom_access_recon_loss: 4292619.5000; val_global_loss: 18269497.0000; val_optim_loss: 18269497.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9380; val_auprc_score: 0.9075; val_best_acc_score: 0.8847; val_best_f1_score: 0.8920; train_kl_reg_loss: 85669.3487; train_edge_recon_loss: 2743645.5795; train_gene_expr_recon_loss: 11346953.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19824.9891; train_chrom_access_recon_loss: 4369977.6288; train_global_loss: 18566071.0606; train_optim_loss: 18566071.0606; val_kl_reg_loss: 41432.4307; val_edge_recon_loss: 2774275.6250; val_gene_expr_recon_loss: 11260851.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19824.2930; val_chrom_access_recon_loss: 4332188.7500; val_global_loss: 18428572.0000; val_optim_loss: 18428572.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9440; val_auprc_score: 0.9181; val_best_acc_score: 0.8893; val_best_f1_score: 0.8959; train_kl_reg_loss: 85699.4097; train_edge_recon_loss: 2747063.6591; train_gene_expr_recon_loss: 11340274.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19823.5188; train_chrom_access_recon_loss: 4369541.6515; train_global_loss: 18562402.3939; train_optim_loss: 18562402.3939; val_kl_reg_loss: 40860.3804; val_edge_recon_loss: 2744094.2500; val_gene_expr_recon_loss: 11324053.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19822.8633; val_chrom_access_recon_loss: 4371421.9062; val_global_loss: 18500253.0000; val_optim_loss: 18500253.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9394; val_auprc_score: 0.9149; val_best_acc_score: 0.8837; val_best_f1_score: 0.8904; train_kl_reg_loss: 85778.8253; train_edge_recon_loss: 2748809.6856; train_gene_expr_recon_loss: 11342949.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19822.0744; train_chrom_access_recon_loss: 4374344.9924; train_global_loss: 18571705.5758; train_optim_loss: 18571705.5758; val_kl_reg_loss: 41066.2544; val_edge_recon_loss: 2773935.4688; val_gene_expr_recon_loss: 11327986.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19821.3457; val_chrom_access_recon_loss: 4374671.7500; val_global_loss: 18537481.0000; val_optim_loss: 18537481.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9380; val_auprc_score: 0.9173; val_best_acc_score: 0.8786; val_best_f1_score: 0.8870; train_kl_reg_loss: 85687.7469; train_edge_recon_loss: 2755226.3371; train_gene_expr_recon_loss: 11334863.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19820.6124; train_chrom_access_recon_loss: 4367387.2992; train_global_loss: 18562985.4848; train_optim_loss: 18562985.4848; val_kl_reg_loss: 40929.0005; val_edge_recon_loss: 2798270.9688; val_gene_expr_recon_loss: 11314767.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19819.7793; val_chrom_access_recon_loss: 4391307.1875; val_global_loss: 18565095.0000; val_optim_loss: 18565095.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9449; val_auprc_score: 0.9221; val_best_acc_score: 0.8898; val_best_f1_score: 0.8964; train_kl_reg_loss: 85697.9125; train_edge_recon_loss: 2758642.4962; train_gene_expr_recon_loss: 11337260.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19817.4721; train_chrom_access_recon_loss: 4369893.2121; train_global_loss: 18571311.3333; train_optim_loss: 18571311.3333; val_kl_reg_loss: 41090.7446; val_edge_recon_loss: 2718690.8750; val_gene_expr_recon_loss: 11351256.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19816.9980; val_chrom_access_recon_loss: 4424924.2812; val_global_loss: 18555779.0000; val_optim_loss: 18555779.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9411; val_auprc_score: 0.9149; val_best_acc_score: 0.8885; val_best_f1_score: 0.8953; train_kl_reg_loss: 85623.9573; train_edge_recon_loss: 2751063.0379; train_gene_expr_recon_loss: 11340503.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19816.9059; train_chrom_access_recon_loss: 4369899.7121; train_global_loss: 18566907.5455; train_optim_loss: 18566907.5455; val_kl_reg_loss: 41079.5063; val_edge_recon_loss: 2749147.5000; val_gene_expr_recon_loss: 11251918.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19816.8223; val_chrom_access_recon_loss: 4377865.5625; val_global_loss: 18439827.2500; val_optim_loss: 18439827.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9392; val_auprc_score: 0.9214; val_best_acc_score: 0.8788; val_best_f1_score: 0.8888; train_kl_reg_loss: 85639.8081; train_edge_recon_loss: 2754953.8902; train_gene_expr_recon_loss: 11336916.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19816.7447; train_chrom_access_recon_loss: 4370306.2841; train_global_loss: 18567633.1818; train_optim_loss: 18567633.1818; val_kl_reg_loss: 41191.9697; val_edge_recon_loss: 2775139.2500; val_gene_expr_recon_loss: 11273267.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19816.6602; val_chrom_access_recon_loss: 4422635.8125; val_global_loss: 18532051.2500; val_optim_loss: 18532051.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9390; val_auprc_score: 0.9096; val_best_acc_score: 0.8861; val_best_f1_score: 0.8933; train_kl_reg_loss: 85699.2196; train_edge_recon_loss: 2741300.0758; train_gene_expr_recon_loss: 11333539.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19816.5816; train_chrom_access_recon_loss: 4370255.3939; train_global_loss: 18550611.1818; train_optim_loss: 18550611.1818; val_kl_reg_loss: 40966.2705; val_edge_recon_loss: 2780319.9375; val_gene_expr_recon_loss: 11313690.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19816.4941; val_chrom_access_recon_loss: 4380447.6875; val_global_loss: 18535239.7500; val_optim_loss: 18535239.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 35 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9344
val AUPRC score: 0.9148
val best accuracy score: 0.8724
val best F1 score: 0.8824
val target rna MSE score: 1.4012
val source rna MSE score: 0.5712
val target atac MSE score: 0.4843
val source atac MSE score: 0.1092
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
