[True]
Run timestamp: 10082023_182714_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7012; val_auprc_score: 0.7394; val_best_acc_score: 0.5020; val_best_f1_score: 0.6675; train_kl_reg_loss: 88138.5944; train_edge_recon_loss: 3713207.3034; train_gene_expr_recon_loss: 27232591.8779; train_masked_gp_l1_reg_loss: 79709.0395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241489.5807; train_chrom_access_recon_loss: 1386477.5057; train_global_loss: 32741613.8626; train_optim_loss: 32741613.8626; val_kl_reg_loss: 45175.8536; val_edge_recon_loss: 4065074.0167; val_gene_expr_recon_loss: 23627663.0667; val_masked_gp_l1_reg_loss: 81657.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233549.0781; val_chrom_access_recon_loss: 1299087.6500; val_global_loss: 29352208.6667; val_optim_loss: 29352208.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7191; val_auprc_score: 0.7558; val_best_acc_score: 0.5366; val_best_f1_score: 0.6799; train_kl_reg_loss: 103209.7386; train_edge_recon_loss: 3645741.0515; train_gene_expr_recon_loss: 23641265.3282; train_masked_gp_l1_reg_loss: 84324.8081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225366.8501; train_chrom_access_recon_loss: 1297927.8273; train_global_loss: 28997835.6947; train_optim_loss: 28997835.6947; val_kl_reg_loss: 101710.3339; val_edge_recon_loss: 4063136.5500; val_gene_expr_recon_loss: 22592969.6000; val_masked_gp_l1_reg_loss: 84959.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216277.2969; val_chrom_access_recon_loss: 1278861.7333; val_global_loss: 28337916.4000; val_optim_loss: 28337916.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8023; val_auprc_score: 0.8200; val_best_acc_score: 0.6544; val_best_f1_score: 0.7255; train_kl_reg_loss: 131612.8713; train_edge_recon_loss: 3544053.6508; train_gene_expr_recon_loss: 22436598.7481; train_masked_gp_l1_reg_loss: 82256.2663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206159.0947; train_chrom_access_recon_loss: 1273022.5143; train_global_loss: 27673703.0534; train_optim_loss: 27673703.0534; val_kl_reg_loss: 139556.3833; val_edge_recon_loss: 4056250.7167; val_gene_expr_recon_loss: 21906348.4000; val_masked_gp_l1_reg_loss: 80806.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196101.3906; val_chrom_access_recon_loss: 1256376.7917; val_global_loss: 27635440.6667; val_optim_loss: 27635440.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8778; val_auprc_score: 0.8739; val_best_acc_score: 0.7747; val_best_f1_score: 0.8061; train_kl_reg_loss: 122831.4798; train_edge_recon_loss: 3526959.0095; train_gene_expr_recon_loss: 22093285.3740; train_masked_gp_l1_reg_loss: 80950.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186836.4026; train_chrom_access_recon_loss: 1262064.0525; train_global_loss: 27272926.7939; train_optim_loss: 27272926.7939; val_kl_reg_loss: 118470.0667; val_edge_recon_loss: 3914642.6167; val_gene_expr_recon_loss: 21757685.0667; val_masked_gp_l1_reg_loss: 81713.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177774.1719; val_chrom_access_recon_loss: 1246617.0750; val_global_loss: 27296903.0667; val_optim_loss: 27296903.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8741; val_auprc_score: 0.8623; val_best_acc_score: 0.7885; val_best_f1_score: 0.8055; train_kl_reg_loss: 112047.9697; train_edge_recon_loss: 3296036.4599; train_gene_expr_recon_loss: 21940397.5878; train_masked_gp_l1_reg_loss: 83389.5012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169659.1331; train_chrom_access_recon_loss: 1256633.2634; train_global_loss: 26858163.8931; train_optim_loss: 26858163.8931; val_kl_reg_loss: 144672.7740; val_edge_recon_loss: 3044193.7333; val_gene_expr_recon_loss: 21604138.4000; val_masked_gp_l1_reg_loss: 84997.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161775.8125; val_chrom_access_recon_loss: 1242683.4167; val_global_loss: 26282462.5333; val_optim_loss: 26282462.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8955; val_auprc_score: 0.8817; val_best_acc_score: 0.8155; val_best_f1_score: 0.8298; train_kl_reg_loss: 147676.1229; train_edge_recon_loss: 3001560.2920; train_gene_expr_recon_loss: 21783782.6565; train_masked_gp_l1_reg_loss: 85886.7170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154606.0018; train_chrom_access_recon_loss: 1249860.0582; train_global_loss: 26423371.7405; train_optim_loss: 26423371.7405; val_kl_reg_loss: 146651.3354; val_edge_recon_loss: 2956900.2500; val_gene_expr_recon_loss: 21545436.4000; val_masked_gp_l1_reg_loss: 86931.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147742.0469; val_chrom_access_recon_loss: 1238342.8000; val_global_loss: 26122004.9333; val_optim_loss: 26122004.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9027; val_auprc_score: 0.8868; val_best_acc_score: 0.8267; val_best_f1_score: 0.8387; train_kl_reg_loss: 141109.1936; train_edge_recon_loss: 2965409.7653; train_gene_expr_recon_loss: 21642556.3817; train_masked_gp_l1_reg_loss: 88392.6530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141823.6973; train_chrom_access_recon_loss: 1245506.9561; train_global_loss: 26224798.6718; train_optim_loss: 26224798.6718; val_kl_reg_loss: 136732.9125; val_edge_recon_loss: 2955178.3167; val_gene_expr_recon_loss: 21368096.1333; val_masked_gp_l1_reg_loss: 89711.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136134.9844; val_chrom_access_recon_loss: 1232880.3667; val_global_loss: 25918733.7333; val_optim_loss: 25918733.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9099; val_auprc_score: 0.8956; val_best_acc_score: 0.8327; val_best_f1_score: 0.8487; train_kl_reg_loss: 136079.8946; train_edge_recon_loss: 2927307.4924; train_gene_expr_recon_loss: 21519122.4122; train_masked_gp_l1_reg_loss: 90980.0482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131044.1883; train_chrom_access_recon_loss: 1239905.7777; train_global_loss: 26044439.7863; train_optim_loss: 26044439.7863; val_kl_reg_loss: 133655.1839; val_edge_recon_loss: 2918615.3000; val_gene_expr_recon_loss: 21232679.7333; val_masked_gp_l1_reg_loss: 92285.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125968.9844; val_chrom_access_recon_loss: 1228051.8417; val_global_loss: 25731256.2667; val_optim_loss: 25731256.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9257; val_auprc_score: 0.9095; val_best_acc_score: 0.8545; val_best_f1_score: 0.8648; train_kl_reg_loss: 133772.8900; train_edge_recon_loss: 2882790.8931; train_gene_expr_recon_loss: 21421044.5802; train_masked_gp_l1_reg_loss: 93615.9030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121341.2211; train_chrom_access_recon_loss: 1235470.3473; train_global_loss: 25888035.8321; train_optim_loss: 25888035.8321; val_kl_reg_loss: 124527.1510; val_edge_recon_loss: 2875568.0000; val_gene_expr_recon_loss: 21202905.4667; val_masked_gp_l1_reg_loss: 94686.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116745.0312; val_chrom_access_recon_loss: 1227141.8250; val_global_loss: 25641574.5333; val_optim_loss: 25641574.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9264; val_auprc_score: 0.9147; val_best_acc_score: 0.8544; val_best_f1_score: 0.8640; train_kl_reg_loss: 133604.5510; train_edge_recon_loss: 2863953.1565; train_gene_expr_recon_loss: 21307369.2977; train_masked_gp_l1_reg_loss: 96043.8022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112615.5531; train_chrom_access_recon_loss: 1230266.9475; train_global_loss: 25743853.1603; train_optim_loss: 25743853.1603; val_kl_reg_loss: 131947.3016; val_edge_recon_loss: 2884562.0000; val_gene_expr_recon_loss: 21029850.5333; val_masked_gp_l1_reg_loss: 97188.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108550.6562; val_chrom_access_recon_loss: 1221267.8750; val_global_loss: 25473366.0000; val_optim_loss: 25473366.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9283; val_auprc_score: 0.9100; val_best_acc_score: 0.8646; val_best_f1_score: 0.8710; train_kl_reg_loss: 129199.8797; train_edge_recon_loss: 2845739.5534; train_gene_expr_recon_loss: 21217950.2137; train_masked_gp_l1_reg_loss: 98145.1405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104792.7361; train_chrom_access_recon_loss: 1227621.0906; train_global_loss: 25623448.5344; train_optim_loss: 25623448.5344; val_kl_reg_loss: 130168.3609; val_edge_recon_loss: 2862762.4000; val_gene_expr_recon_loss: 20966528.1333; val_masked_gp_l1_reg_loss: 99093.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101278.6641; val_chrom_access_recon_loss: 1217157.1500; val_global_loss: 25376988.4000; val_optim_loss: 25376988.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9372; val_auprc_score: 0.9217; val_best_acc_score: 0.8783; val_best_f1_score: 0.8830; train_kl_reg_loss: 125743.3768; train_edge_recon_loss: 2836536.2233; train_gene_expr_recon_loss: 21156947.4962; train_masked_gp_l1_reg_loss: 100128.6557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97897.3098; train_chrom_access_recon_loss: 1225742.6088; train_global_loss: 25542995.8168; train_optim_loss: 25542995.8168; val_kl_reg_loss: 131716.5703; val_edge_recon_loss: 2821573.0333; val_gene_expr_recon_loss: 20924817.8667; val_masked_gp_l1_reg_loss: 101076.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94594.5156; val_chrom_access_recon_loss: 1216949.4667; val_global_loss: 25290727.3333; val_optim_loss: 25290727.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9479; val_auprc_score: 0.9374; val_best_acc_score: 0.8894; val_best_f1_score: 0.8938; train_kl_reg_loss: 125131.0964; train_edge_recon_loss: 2824324.0954; train_gene_expr_recon_loss: 21069305.5725; train_masked_gp_l1_reg_loss: 101859.0327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91711.7210; train_chrom_access_recon_loss: 1221257.7137; train_global_loss: 25433589.2672; train_optim_loss: 25433589.2672; val_kl_reg_loss: 123343.4583; val_edge_recon_loss: 2822444.6667; val_gene_expr_recon_loss: 20894549.6000; val_masked_gp_l1_reg_loss: 102864.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88964.1719; val_chrom_access_recon_loss: 1218241.7917; val_global_loss: 25250407.2000; val_optim_loss: 25250407.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9452; val_auprc_score: 0.9327; val_best_acc_score: 0.8824; val_best_f1_score: 0.8906; train_kl_reg_loss: 122821.2989; train_edge_recon_loss: 2801135.8817; train_gene_expr_recon_loss: 21037674.8702; train_masked_gp_l1_reg_loss: 103572.9319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86397.6342; train_chrom_access_recon_loss: 1220868.2099; train_global_loss: 25372470.7786; train_optim_loss: 25372470.7786; val_kl_reg_loss: 126206.7365; val_edge_recon_loss: 2786881.5333; val_gene_expr_recon_loss: 20798844.2667; val_masked_gp_l1_reg_loss: 104345.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83881.9688; val_chrom_access_recon_loss: 1211107.7917; val_global_loss: 25111268.0000; val_optim_loss: 25111268.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9483; val_auprc_score: 0.9366; val_best_acc_score: 0.8848; val_best_f1_score: 0.8895; train_kl_reg_loss: 120788.6325; train_edge_recon_loss: 2787157.2424; train_gene_expr_recon_loss: 20971824.4427; train_masked_gp_l1_reg_loss: 105162.1698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81476.5707; train_chrom_access_recon_loss: 1218553.3426; train_global_loss: 25284962.4122; train_optim_loss: 25284962.4122; val_kl_reg_loss: 121543.5651; val_edge_recon_loss: 2790710.7167; val_gene_expr_recon_loss: 20729201.6000; val_masked_gp_l1_reg_loss: 106054.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79194.8516; val_chrom_access_recon_loss: 1208025.8917; val_global_loss: 25034729.8667; val_optim_loss: 25034729.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9527; val_auprc_score: 0.9432; val_best_acc_score: 0.8872; val_best_f1_score: 0.8927; train_kl_reg_loss: 118289.6452; train_edge_recon_loss: 2778928.6679; train_gene_expr_recon_loss: 20958660.7481; train_masked_gp_l1_reg_loss: 106843.0071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76951.8824; train_chrom_access_recon_loss: 1218681.4485; train_global_loss: 25258355.2824; train_optim_loss: 25258355.2824; val_kl_reg_loss: 114999.1885; val_edge_recon_loss: 2797468.4000; val_gene_expr_recon_loss: 20741461.0667; val_masked_gp_l1_reg_loss: 107697.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74887.3125; val_chrom_access_recon_loss: 1210155.7083; val_global_loss: 25046670.0000; val_optim_loss: 25046670.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9539; val_auprc_score: 0.9394; val_best_acc_score: 0.8963; val_best_f1_score: 0.9003; train_kl_reg_loss: 115515.1447; train_edge_recon_loss: 2773758.4237; train_gene_expr_recon_loss: 20894013.7099; train_masked_gp_l1_reg_loss: 108445.2022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72742.8863; train_chrom_access_recon_loss: 1215484.6307; train_global_loss: 25179959.9695; train_optim_loss: 25179959.9695; val_kl_reg_loss: 111554.7891; val_edge_recon_loss: 2776388.1500; val_gene_expr_recon_loss: 20685941.6000; val_masked_gp_l1_reg_loss: 109540.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70781.6094; val_chrom_access_recon_loss: 1201875.4000; val_global_loss: 24956082.0000; val_optim_loss: 24956082.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9573; val_auprc_score: 0.9443; val_best_acc_score: 0.8961; val_best_f1_score: 0.8997; train_kl_reg_loss: 114123.6947; train_edge_recon_loss: 2766466.6737; train_gene_expr_recon_loss: 20869554.3969; train_masked_gp_l1_reg_loss: 110100.6815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68916.2508; train_chrom_access_recon_loss: 1213842.7863; train_global_loss: 25143004.3817; train_optim_loss: 25143004.3817; val_kl_reg_loss: 114345.2500; val_edge_recon_loss: 2773632.3333; val_gene_expr_recon_loss: 20681978.1333; val_masked_gp_l1_reg_loss: 111011.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67046.1016; val_chrom_access_recon_loss: 1208346.8250; val_global_loss: 24956360.2667; val_optim_loss: 24956360.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9602; val_auprc_score: 0.9509; val_best_acc_score: 0.9006; val_best_f1_score: 0.9045; train_kl_reg_loss: 113580.2181; train_edge_recon_loss: 2754097.3130; train_gene_expr_recon_loss: 20866299.9847; train_masked_gp_l1_reg_loss: 111575.9740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65429.7640; train_chrom_access_recon_loss: 1214523.2023; train_global_loss: 25125506.5344; train_optim_loss: 25125506.5344; val_kl_reg_loss: 113604.1740; val_edge_recon_loss: 2751605.7833; val_gene_expr_recon_loss: 20651708.8000; val_masked_gp_l1_reg_loss: 112392.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63917.0781; val_chrom_access_recon_loss: 1205836.9000; val_global_loss: 24899065.6000; val_optim_loss: 24899065.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9620; val_auprc_score: 0.9509; val_best_acc_score: 0.9072; val_best_f1_score: 0.9102; train_kl_reg_loss: 112634.9978; train_edge_recon_loss: 2748155.6622; train_gene_expr_recon_loss: 20790052.0763; train_masked_gp_l1_reg_loss: 112986.9250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62410.0192; train_chrom_access_recon_loss: 1210251.6794; train_global_loss: 25036491.3282; train_optim_loss: 25036491.3282; val_kl_reg_loss: 115580.9865; val_edge_recon_loss: 2770388.6167; val_gene_expr_recon_loss: 20624064.5333; val_masked_gp_l1_reg_loss: 113676.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61065.0156; val_chrom_access_recon_loss: 1205751.2750; val_global_loss: 24890527.6000; val_optim_loss: 24890527.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9632; val_auprc_score: 0.9543; val_best_acc_score: 0.9060; val_best_f1_score: 0.9094; train_kl_reg_loss: 110735.5810; train_edge_recon_loss: 2743336.4542; train_gene_expr_recon_loss: 20792442.6260; train_masked_gp_l1_reg_loss: 114424.1868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59714.9476; train_chrom_access_recon_loss: 1211146.5296; train_global_loss: 25031800.4427; train_optim_loss: 25031800.4427; val_kl_reg_loss: 109382.6474; val_edge_recon_loss: 2749523.0500; val_gene_expr_recon_loss: 20588078.8000; val_masked_gp_l1_reg_loss: 115187.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58434.1875; val_chrom_access_recon_loss: 1200428.5583; val_global_loss: 24821034.9333; val_optim_loss: 24821034.9333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9665; val_auprc_score: 0.9594; val_best_acc_score: 0.9093; val_best_f1_score: 0.9129; train_kl_reg_loss: 110572.7968; train_edge_recon_loss: 2740894.4084; train_gene_expr_recon_loss: 20723357.3588; train_masked_gp_l1_reg_loss: 115794.8815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57201.2170; train_chrom_access_recon_loss: 1208861.1794; train_global_loss: 24956681.8015; train_optim_loss: 24956681.8015; val_kl_reg_loss: 110462.4880; val_edge_recon_loss: 2747709.6333; val_gene_expr_recon_loss: 20626556.0000; val_masked_gp_l1_reg_loss: 116414.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56016.4609; val_chrom_access_recon_loss: 1209751.8667; val_global_loss: 24866910.0000; val_optim_loss: 24866910.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9665; val_auprc_score: 0.9580; val_best_acc_score: 0.9134; val_best_f1_score: 0.9164; train_kl_reg_loss: 107925.8414; train_edge_recon_loss: 2731785.6069; train_gene_expr_recon_loss: 20739796.8550; train_masked_gp_l1_reg_loss: 117157.1766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54977.1506; train_chrom_access_recon_loss: 1210413.7252; train_global_loss: 24962056.2290; train_optim_loss: 24962056.2290; val_kl_reg_loss: 106971.1479; val_edge_recon_loss: 2763049.6167; val_gene_expr_recon_loss: 20524361.7333; val_masked_gp_l1_reg_loss: 117821.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53914.0859; val_chrom_access_recon_loss: 1199643.9167; val_global_loss: 24765762.5333; val_optim_loss: 24765762.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9695; val_auprc_score: 0.9602; val_best_acc_score: 0.9182; val_best_f1_score: 0.9204; train_kl_reg_loss: 106745.5639; train_edge_recon_loss: 2739596.7538; train_gene_expr_recon_loss: 20688742.6718; train_masked_gp_l1_reg_loss: 118478.0261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53041.1311; train_chrom_access_recon_loss: 1208172.4637; train_global_loss: 24914776.6260; train_optim_loss: 24914776.6260; val_kl_reg_loss: 107443.4625; val_edge_recon_loss: 2736245.9667; val_gene_expr_recon_loss: 20551445.7333; val_masked_gp_l1_reg_loss: 119131.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52227.3086; val_chrom_access_recon_loss: 1202737.9250; val_global_loss: 24769232.6667; val_optim_loss: 24769232.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9666; val_auprc_score: 0.9590; val_best_acc_score: 0.9144; val_best_f1_score: 0.9180; train_kl_reg_loss: 107190.6506; train_edge_recon_loss: 2724426.0553; train_gene_expr_recon_loss: 20666921.2672; train_masked_gp_l1_reg_loss: 119693.1568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51290.2296; train_chrom_access_recon_loss: 1207298.9523; train_global_loss: 24876820.3664; train_optim_loss: 24876820.3664; val_kl_reg_loss: 106597.4906; val_edge_recon_loss: 2756303.3667; val_gene_expr_recon_loss: 20543959.4667; val_masked_gp_l1_reg_loss: 120548.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50525.4805; val_chrom_access_recon_loss: 1203255.5333; val_global_loss: 24781189.6000; val_optim_loss: 24781189.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9684; val_auprc_score: 0.9619; val_best_acc_score: 0.9167; val_best_f1_score: 0.9192; train_kl_reg_loss: 117989.1924; train_edge_recon_loss: 2789074.3912; train_gene_expr_recon_loss: 21510140.0611; train_masked_gp_l1_reg_loss: 120959.0131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50609.5629; train_chrom_access_recon_loss: 1243060.9933; train_global_loss: 25831833.2824; train_optim_loss: 25831833.2824; val_kl_reg_loss: 49232.3057; val_edge_recon_loss: 2794385.6667; val_gene_expr_recon_loss: 21203745.0667; val_masked_gp_l1_reg_loss: 121702.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49602.9766; val_chrom_access_recon_loss: 1226874.7750; val_global_loss: 25445542.2667; val_optim_loss: 25445542.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9697; val_auprc_score: 0.9630; val_best_acc_score: 0.9166; val_best_f1_score: 0.9202; train_kl_reg_loss: 110105.5397; train_edge_recon_loss: 2757288.4427; train_gene_expr_recon_loss: 21364152.2290; train_masked_gp_l1_reg_loss: 122197.9596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48326.3671; train_chrom_access_recon_loss: 1232745.2634; train_global_loss: 25634815.4656; train_optim_loss: 25634815.4656; val_kl_reg_loss: 56258.8961; val_edge_recon_loss: 2756111.6833; val_gene_expr_recon_loss: 21202440.1333; val_masked_gp_l1_reg_loss: 122599.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47230.9844; val_chrom_access_recon_loss: 1225182.4083; val_global_loss: 25409822.9333; val_optim_loss: 25409822.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9682; val_auprc_score: 0.9577; val_best_acc_score: 0.9174; val_best_f1_score: 0.9192; train_kl_reg_loss: 103899.2634; train_edge_recon_loss: 2739994.0592; train_gene_expr_recon_loss: 21369444.6412; train_masked_gp_l1_reg_loss: 122169.4757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46839.3254; train_chrom_access_recon_loss: 1232210.3492; train_global_loss: 25614557.0076; train_optim_loss: 25614557.0076; val_kl_reg_loss: 57881.6862; val_edge_recon_loss: 2740650.5000; val_gene_expr_recon_loss: 21186352.4000; val_masked_gp_l1_reg_loss: 122056.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46541.7188; val_chrom_access_recon_loss: 1228960.0083; val_global_loss: 25382442.5333; val_optim_loss: 25382442.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9716; val_auprc_score: 0.9625; val_best_acc_score: 0.9200; val_best_f1_score: 0.9214; train_kl_reg_loss: 103791.5377; train_edge_recon_loss: 2744588.8092; train_gene_expr_recon_loss: 21364345.7557; train_masked_gp_l1_reg_loss: 122025.6246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46347.4603; train_chrom_access_recon_loss: 1230557.4466; train_global_loss: 25611656.7176; train_optim_loss: 25611656.7176; val_kl_reg_loss: 57689.9917; val_edge_recon_loss: 2732781.2167; val_gene_expr_recon_loss: 21169830.9333; val_masked_gp_l1_reg_loss: 121994.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46178.6523; val_chrom_access_recon_loss: 1224863.8083; val_global_loss: 25353338.0000; val_optim_loss: 25353338.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9724; val_auprc_score: 0.9659; val_best_acc_score: 0.9200; val_best_f1_score: 0.9212; train_kl_reg_loss: 103887.5672; train_edge_recon_loss: 2736933.9198; train_gene_expr_recon_loss: 21375421.8931; train_masked_gp_l1_reg_loss: 121965.1769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46014.8047; train_chrom_access_recon_loss: 1230013.2834; train_global_loss: 25614236.5954; train_optim_loss: 25614236.5954; val_kl_reg_loss: 58922.6714; val_edge_recon_loss: 2731719.9000; val_gene_expr_recon_loss: 21099557.4667; val_masked_gp_l1_reg_loss: 121946.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45844.0586; val_chrom_access_recon_loss: 1220313.9500; val_global_loss: 25278304.2667; val_optim_loss: 25278304.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9670; val_auprc_score: 0.9573; val_best_acc_score: 0.9135; val_best_f1_score: 0.9156; train_kl_reg_loss: 102418.2026; train_edge_recon_loss: 2730518.4504; train_gene_expr_recon_loss: 21379659.6947; train_masked_gp_l1_reg_loss: 121928.2682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45701.4282; train_chrom_access_recon_loss: 1230320.2366; train_global_loss: 25610546.0916; train_optim_loss: 25610546.0916; val_kl_reg_loss: 59002.8539; val_edge_recon_loss: 2757233.3500; val_gene_expr_recon_loss: 21175171.7333; val_masked_gp_l1_reg_loss: 121911.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45554.0977; val_chrom_access_recon_loss: 1217168.4667; val_global_loss: 25376042.2667; val_optim_loss: 25376042.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 36 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9669
val AUPRC score: 0.9576
val best accuracy score: 0.9144
val best F1 score: 0.9175
val target rna MSE score: 1.3045
val source rna MSE score: 54.4038
val target atac MSE score: 0.5577
val source atac MSE score: 6.1653
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
