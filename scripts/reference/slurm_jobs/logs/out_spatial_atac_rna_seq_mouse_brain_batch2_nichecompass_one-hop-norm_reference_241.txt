[True]
Run timestamp: 07092023_022241_241.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_241']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23411 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 27040, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7890; val_auprc_score: 0.8028; val_best_acc_score: 0.6496; val_best_f1_score: 0.7243; train_kl_reg_loss: 79574.2001; train_edge_recon_loss: 3619243.5076; train_gene_expr_recon_loss: 15352124.6794; train_masked_gp_l1_reg_loss: 40311.8225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4470722.2748; train_chrom_access_recon_loss: 53445909.0992; train_global_loss: 77007885.6794; train_optim_loss: 77007885.6794; val_kl_reg_loss: 124132.4495; val_edge_recon_loss: 4057137.0000; val_gene_expr_recon_loss: 14246352.6000; val_masked_gp_l1_reg_loss: 35734.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 422073.2500; val_chrom_access_recon_loss: 51365126.9333; val_global_loss: 70250557.3333; val_optim_loss: 70250557.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8704; val_auprc_score: 0.8684; val_best_acc_score: 0.7576; val_best_f1_score: 0.7920; train_kl_reg_loss: 121717.7665; train_edge_recon_loss: 3541055.4943; train_gene_expr_recon_loss: 13928994.1450; train_masked_gp_l1_reg_loss: 33681.4181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 281700.4416; train_chrom_access_recon_loss: 51096942.5954; train_global_loss: 69004091.8779; train_optim_loss: 69004091.8779; val_kl_reg_loss: 103564.0536; val_edge_recon_loss: 3945549.7667; val_gene_expr_recon_loss: 13751340.0000; val_masked_gp_l1_reg_loss: 33550.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197862.5938; val_chrom_access_recon_loss: 50309428.8000; val_global_loss: 68341294.6667; val_optim_loss: 68341294.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8787; val_auprc_score: 0.8767; val_best_acc_score: 0.7751; val_best_f1_score: 0.7966; train_kl_reg_loss: 101727.4909; train_edge_recon_loss: 3269753.0000; train_gene_expr_recon_loss: 13664533.2519; train_masked_gp_l1_reg_loss: 35030.0037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173205.5558; train_chrom_access_recon_loss: 50398846.7481; train_global_loss: 67643095.9695; train_optim_loss: 67643095.9695; val_kl_reg_loss: 132228.0125; val_edge_recon_loss: 3028972.7667; val_gene_expr_recon_loss: 13577169.6000; val_masked_gp_l1_reg_loss: 36664.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157490.1406; val_chrom_access_recon_loss: 49794367.4667; val_global_loss: 66726891.4667; val_optim_loss: 66726891.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8845; val_auprc_score: 0.8694; val_best_acc_score: 0.8017; val_best_f1_score: 0.8182; train_kl_reg_loss: 129865.3624; train_edge_recon_loss: 2988382.4427; train_gene_expr_recon_loss: 13508606.8931; train_masked_gp_l1_reg_loss: 37839.3256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148619.3366; train_chrom_access_recon_loss: 49899047.9084; train_global_loss: 66712361.0992; train_optim_loss: 66712361.0992; val_kl_reg_loss: 118203.9422; val_edge_recon_loss: 2981055.4500; val_gene_expr_recon_loss: 13422399.9333; val_masked_gp_l1_reg_loss: 39041.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141861.2344; val_chrom_access_recon_loss: 49174959.7333; val_global_loss: 65877521.8667; val_optim_loss: 65877521.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8954; val_auprc_score: 0.8794; val_best_acc_score: 0.8129; val_best_f1_score: 0.8298; train_kl_reg_loss: 123562.2298; train_edge_recon_loss: 2931276.6966; train_gene_expr_recon_loss: 13366911.8550; train_masked_gp_l1_reg_loss: 40187.6289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137306.7567; train_chrom_access_recon_loss: 49445629.0076; train_global_loss: 66044874.3206; train_optim_loss: 66044874.3206; val_kl_reg_loss: 119874.4130; val_edge_recon_loss: 2912244.6000; val_gene_expr_recon_loss: 13306417.0000; val_masked_gp_l1_reg_loss: 41293.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133392.0000; val_chrom_access_recon_loss: 48702444.8000; val_global_loss: 65215666.9333; val_optim_loss: 65215666.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9144; val_auprc_score: 0.8971; val_best_acc_score: 0.8407; val_best_f1_score: 0.8508; train_kl_reg_loss: 116196.8842; train_edge_recon_loss: 2887981.8340; train_gene_expr_recon_loss: 13260368.8626; train_masked_gp_l1_reg_loss: 42300.6786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130644.4179; train_chrom_access_recon_loss: 49078503.8779; train_global_loss: 65515996.3969; train_optim_loss: 65515996.3969; val_kl_reg_loss: 115568.2094; val_edge_recon_loss: 2867981.2833; val_gene_expr_recon_loss: 13221682.2000; val_masked_gp_l1_reg_loss: 43337.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128028.3828; val_chrom_access_recon_loss: 48490700.8000; val_global_loss: 64867297.8667; val_optim_loss: 64867297.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9285; val_auprc_score: 0.9102; val_best_acc_score: 0.8632; val_best_f1_score: 0.8716; train_kl_reg_loss: 117900.0684; train_edge_recon_loss: 2838386.6737; train_gene_expr_recon_loss: 13159909.8855; train_masked_gp_l1_reg_loss: 44339.7818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126015.4054; train_chrom_access_recon_loss: 48703562.6870; train_global_loss: 64990114.5038; train_optim_loss: 64990114.5038; val_kl_reg_loss: 118774.6240; val_edge_recon_loss: 2830585.3500; val_gene_expr_recon_loss: 13145341.0000; val_masked_gp_l1_reg_loss: 45321.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123955.4766; val_chrom_access_recon_loss: 48470540.5333; val_global_loss: 64734517.0667; val_optim_loss: 64734517.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9307; val_auprc_score: 0.9154; val_best_acc_score: 0.8622; val_best_f1_score: 0.8725; train_kl_reg_loss: 118776.9894; train_edge_recon_loss: 2805744.6412; train_gene_expr_recon_loss: 13069957.0992; train_masked_gp_l1_reg_loss: 46162.0775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122818.6030; train_chrom_access_recon_loss: 48341118.7481; train_global_loss: 64504578.0763; train_optim_loss: 64504578.0763; val_kl_reg_loss: 115917.4870; val_edge_recon_loss: 2814463.5000; val_gene_expr_recon_loss: 13075218.2000; val_masked_gp_l1_reg_loss: 47022.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121934.3281; val_chrom_access_recon_loss: 48043765.6000; val_global_loss: 64218321.0667; val_optim_loss: 64218321.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9393; val_auprc_score: 0.9240; val_best_acc_score: 0.8740; val_best_f1_score: 0.8803; train_kl_reg_loss: 117486.7001; train_edge_recon_loss: 2787673.7653; train_gene_expr_recon_loss: 12994674.9618; train_masked_gp_l1_reg_loss: 47858.5186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120626.0291; train_chrom_access_recon_loss: 48033625.3435; train_global_loss: 64101945.4351; train_optim_loss: 64101945.4351; val_kl_reg_loss: 114167.3755; val_edge_recon_loss: 2788042.5500; val_gene_expr_recon_loss: 12956452.8000; val_masked_gp_l1_reg_loss: 48726.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119435.8906; val_chrom_access_recon_loss: 47663815.2000; val_global_loss: 63690640.8000; val_optim_loss: 63690640.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9456; val_auprc_score: 0.9318; val_best_acc_score: 0.8821; val_best_f1_score: 0.8887; train_kl_reg_loss: 115595.6494; train_edge_recon_loss: 2772146.1107; train_gene_expr_recon_loss: 12919271.6641; train_masked_gp_l1_reg_loss: 49536.4946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118561.8120; train_chrom_access_recon_loss: 47710801.4962; train_global_loss: 63685913.3130; train_optim_loss: 63685913.3130; val_kl_reg_loss: 113435.7807; val_edge_recon_loss: 2785632.9667; val_gene_expr_recon_loss: 12869064.0667; val_masked_gp_l1_reg_loss: 50340.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117913.6797; val_chrom_access_recon_loss: 47248536.2667; val_global_loss: 63184922.6667; val_optim_loss: 63184922.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9475; val_auprc_score: 0.9306; val_best_acc_score: 0.8864; val_best_f1_score: 0.8933; train_kl_reg_loss: 113560.6690; train_edge_recon_loss: 2756702.1317; train_gene_expr_recon_loss: 12845422.4427; train_masked_gp_l1_reg_loss: 51286.6099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117152.1639; train_chrom_access_recon_loss: 47411104.8244; train_global_loss: 63295228.9160; train_optim_loss: 63295228.9160; val_kl_reg_loss: 111973.1135; val_edge_recon_loss: 2780813.9167; val_gene_expr_recon_loss: 12809448.4000; val_masked_gp_l1_reg_loss: 51831.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116384.2031; val_chrom_access_recon_loss: 47040237.3333; val_global_loss: 62910687.4667; val_optim_loss: 62910687.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9440; val_auprc_score: 0.9293; val_best_acc_score: 0.8822; val_best_f1_score: 0.8896; train_kl_reg_loss: 107959.6947; train_edge_recon_loss: 2771167.8588; train_gene_expr_recon_loss: 12814460.7099; train_masked_gp_l1_reg_loss: 52562.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116137.4367; train_chrom_access_recon_loss: 47204576.7939; train_global_loss: 63066864.7023; train_optim_loss: 63066864.7023; val_kl_reg_loss: 106659.5063; val_edge_recon_loss: 2767639.5667; val_gene_expr_recon_loss: 12723987.1333; val_masked_gp_l1_reg_loss: 53012.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115392.2734; val_chrom_access_recon_loss: 46739188.5333; val_global_loss: 62505879.7333; val_optim_loss: 62505879.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9371; val_auprc_score: 0.9251; val_best_acc_score: 0.8689; val_best_f1_score: 0.8791; train_kl_reg_loss: 102830.6761; train_edge_recon_loss: 2794246.5553; train_gene_expr_recon_loss: 13058526.3740; train_masked_gp_l1_reg_loss: 55377.5761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121007.5699; train_chrom_access_recon_loss: 47483558.9618; train_global_loss: 63615547.6641; train_optim_loss: 63615547.6641; val_kl_reg_loss: 103861.9536; val_edge_recon_loss: 2834188.5500; val_gene_expr_recon_loss: 12989301.5333; val_masked_gp_l1_reg_loss: 59146.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127449.5391; val_chrom_access_recon_loss: 47067811.4667; val_global_loss: 63181759.4667; val_optim_loss: 63181759.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9368; val_auprc_score: 0.9211; val_best_acc_score: 0.8774; val_best_f1_score: 0.8859; train_kl_reg_loss: 219971.3862; train_edge_recon_loss: 2847226.9885; train_gene_expr_recon_loss: 13096474.1985; train_masked_gp_l1_reg_loss: 64246.0405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124996.4891; train_chrom_access_recon_loss: 47770475.6947; train_global_loss: 64123390.6565; train_optim_loss: 64123390.6565; val_kl_reg_loss: 98666.2312; val_edge_recon_loss: 2837399.0500; val_gene_expr_recon_loss: 13110091.6667; val_masked_gp_l1_reg_loss: 67772.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128976.8672; val_chrom_access_recon_loss: 47603773.3333; val_global_loss: 63846678.4000; val_optim_loss: 63846678.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9418; val_auprc_score: 0.9287; val_best_acc_score: 0.8748; val_best_f1_score: 0.8829; train_kl_reg_loss: 96905.6766; train_edge_recon_loss: 2811230.1450; train_gene_expr_recon_loss: 12850983.5802; train_masked_gp_l1_reg_loss: 69142.4796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130451.2174; train_chrom_access_recon_loss: 47051732.1221; train_global_loss: 63010445.3130; train_optim_loss: 63010445.3130; val_kl_reg_loss: 98271.0542; val_edge_recon_loss: 2803081.9500; val_gene_expr_recon_loss: 12839734.5333; val_masked_gp_l1_reg_loss: 68636.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125689.3359; val_chrom_access_recon_loss: 46646392.8000; val_global_loss: 62581805.0667; val_optim_loss: 62581805.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9447; val_auprc_score: 0.9308; val_best_acc_score: 0.8771; val_best_f1_score: 0.8856; train_kl_reg_loss: 107071.7668; train_edge_recon_loss: 2772449.2176; train_gene_expr_recon_loss: 12732491.9618; train_masked_gp_l1_reg_loss: 68798.6915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125431.5680; train_chrom_access_recon_loss: 46547027.3588; train_global_loss: 62353270.6565; train_optim_loss: 62353270.6565; val_kl_reg_loss: 108032.8365; val_edge_recon_loss: 2767740.4500; val_gene_expr_recon_loss: 12738869.2000; val_masked_gp_l1_reg_loss: 68318.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122809.0781; val_chrom_access_recon_loss: 46450185.6000; val_global_loss: 62255956.0000; val_optim_loss: 62255956.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9444; val_auprc_score: 0.9296; val_best_acc_score: 0.8791; val_best_f1_score: 0.8860; train_kl_reg_loss: 108040.0938; train_edge_recon_loss: 2763120.6584; train_gene_expr_recon_loss: 12693135.5496; train_masked_gp_l1_reg_loss: 68186.3779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121273.3168; train_chrom_access_recon_loss: 46282989.2824; train_global_loss: 62036745.2214; train_optim_loss: 62036745.2214; val_kl_reg_loss: 107184.2531; val_edge_recon_loss: 2776787.0833; val_gene_expr_recon_loss: 12623943.6000; val_masked_gp_l1_reg_loss: 67833.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119281.9844; val_chrom_access_recon_loss: 45848790.6667; val_global_loss: 61543820.8000; val_optim_loss: 61543820.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9515; val_auprc_score: 0.9414; val_best_acc_score: 0.8833; val_best_f1_score: 0.8902; train_kl_reg_loss: 107824.4651; train_edge_recon_loss: 2758733.4885; train_gene_expr_recon_loss: 12618117.0382; train_masked_gp_l1_reg_loss: 67644.6432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118421.1365; train_chrom_access_recon_loss: 46021709.9542; train_global_loss: 61692450.6260; train_optim_loss: 61692450.6260; val_kl_reg_loss: 105040.0203; val_edge_recon_loss: 2763290.1667; val_gene_expr_recon_loss: 12635748.8000; val_masked_gp_l1_reg_loss: 67446.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118055.1719; val_chrom_access_recon_loss: 45895491.2000; val_global_loss: 61585071.7333; val_optim_loss: 61585071.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9448; val_auprc_score: 0.9276; val_best_acc_score: 0.8809; val_best_f1_score: 0.8894; train_kl_reg_loss: 106002.5547; train_edge_recon_loss: 2748411.8492; train_gene_expr_recon_loss: 12566028.3664; train_masked_gp_l1_reg_loss: 67379.0785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116796.1619; train_chrom_access_recon_loss: 45792388.3664; train_global_loss: 61397006.2595; train_optim_loss: 61397006.2595; val_kl_reg_loss: 102440.8547; val_edge_recon_loss: 2776679.8833; val_gene_expr_recon_loss: 12537768.4667; val_masked_gp_l1_reg_loss: 67291.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116545.4375; val_chrom_access_recon_loss: 45536359.2000; val_global_loss: 61137086.1333; val_optim_loss: 61137086.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9545; val_auprc_score: 0.9421; val_best_acc_score: 0.8898; val_best_f1_score: 0.8945; train_kl_reg_loss: 105020.0901; train_edge_recon_loss: 2740785.9427; train_gene_expr_recon_loss: 12519321.8626; train_masked_gp_l1_reg_loss: 67181.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115402.5437; train_chrom_access_recon_loss: 45614540.3053; train_global_loss: 61162252.1832; train_optim_loss: 61162252.1832; val_kl_reg_loss: 101349.9297; val_edge_recon_loss: 2758226.7167; val_gene_expr_recon_loss: 12547160.2667; val_masked_gp_l1_reg_loss: 66919.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114836.4062; val_chrom_access_recon_loss: 45392426.9333; val_global_loss: 60980918.9333; val_optim_loss: 60980918.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9512; val_auprc_score: 0.9388; val_best_acc_score: 0.8874; val_best_f1_score: 0.8941; train_kl_reg_loss: 104790.2863; train_edge_recon_loss: 2742896.0725; train_gene_expr_recon_loss: 12491938.4962; train_masked_gp_l1_reg_loss: 66793.3328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113260.0033; train_chrom_access_recon_loss: 45470290.3511; train_global_loss: 60989968.5496; train_optim_loss: 60989968.5496; val_kl_reg_loss: 103264.1755; val_edge_recon_loss: 2767078.3000; val_gene_expr_recon_loss: 12453754.4667; val_masked_gp_l1_reg_loss: 66580.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112957.4766; val_chrom_access_recon_loss: 45174384.8000; val_global_loss: 60678019.4667; val_optim_loss: 60678019.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9543; val_auprc_score: 0.9445; val_best_acc_score: 0.8950; val_best_f1_score: 0.8999; train_kl_reg_loss: 104261.1210; train_edge_recon_loss: 2734555.7882; train_gene_expr_recon_loss: 12461829.1756; train_masked_gp_l1_reg_loss: 66608.9631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112115.8921; train_chrom_access_recon_loss: 45280681.7710; train_global_loss: 60760052.8855; train_optim_loss: 60760052.8855; val_kl_reg_loss: 102158.5109; val_edge_recon_loss: 2738153.9333; val_gene_expr_recon_loss: 12480113.4667; val_masked_gp_l1_reg_loss: 66705.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112658.4531; val_chrom_access_recon_loss: 45252068.5333; val_global_loss: 60751858.6667; val_optim_loss: 60751858.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9527; val_auprc_score: 0.9403; val_best_acc_score: 0.8910; val_best_f1_score: 0.8973; train_kl_reg_loss: 102882.8735; train_edge_recon_loss: 2741110.7004; train_gene_expr_recon_loss: 12442026.1374; train_masked_gp_l1_reg_loss: 67804.5330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111754.4593; train_chrom_access_recon_loss: 45158290.8702; train_global_loss: 60623869.5878; train_optim_loss: 60623869.5878; val_kl_reg_loss: 100255.5339; val_edge_recon_loss: 2753603.0167; val_gene_expr_recon_loss: 12404164.7333; val_masked_gp_l1_reg_loss: 67582.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111681.0000; val_chrom_access_recon_loss: 44960936.8000; val_global_loss: 60398222.9333; val_optim_loss: 60398222.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9576; val_auprc_score: 0.9473; val_best_acc_score: 0.8977; val_best_f1_score: 0.9027; train_kl_reg_loss: 102785.2933; train_edge_recon_loss: 2733377.5477; train_gene_expr_recon_loss: 12414233.4580; train_masked_gp_l1_reg_loss: 67321.6677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111069.3526; train_chrom_access_recon_loss: 44996840.5191; train_global_loss: 60425628.0000; train_optim_loss: 60425628.0000; val_kl_reg_loss: 99604.0063; val_edge_recon_loss: 2737492.6167; val_gene_expr_recon_loss: 12430945.4667; val_masked_gp_l1_reg_loss: 67019.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111089.9766; val_chrom_access_recon_loss: 44946206.9333; val_global_loss: 60392358.9333; val_optim_loss: 60392358.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9574; val_auprc_score: 0.9467; val_best_acc_score: 0.8972; val_best_f1_score: 0.9027; train_kl_reg_loss: 101762.3181; train_edge_recon_loss: 2730249.0134; train_gene_expr_recon_loss: 12389370.0687; train_masked_gp_l1_reg_loss: 66863.0596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110462.9900; train_chrom_access_recon_loss: 44831248.9466; train_global_loss: 60229956.4580; train_optim_loss: 60229956.4580; val_kl_reg_loss: 100424.1667; val_edge_recon_loss: 2738794.6333; val_gene_expr_recon_loss: 12431540.5333; val_masked_gp_l1_reg_loss: 66697.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110294.1094; val_chrom_access_recon_loss: 44795196.5333; val_global_loss: 60242947.7333; val_optim_loss: 60242947.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9594; val_auprc_score: 0.9464; val_best_acc_score: 0.8999; val_best_f1_score: 0.9048; train_kl_reg_loss: 101275.6297; train_edge_recon_loss: 2735218.2004; train_gene_expr_recon_loss: 12379013.3511; train_masked_gp_l1_reg_loss: 66584.7002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109850.7529; train_chrom_access_recon_loss: 44755449.4351; train_global_loss: 60147391.9389; train_optim_loss: 60147391.9389; val_kl_reg_loss: 97000.6161; val_edge_recon_loss: 2724556.1000; val_gene_expr_recon_loss: 12398045.7333; val_masked_gp_l1_reg_loss: 66475.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110180.3750; val_chrom_access_recon_loss: 44681583.7333; val_global_loss: 60077841.3333; val_optim_loss: 60077841.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9579; val_auprc_score: 0.9470; val_best_acc_score: 0.8987; val_best_f1_score: 0.9021; train_kl_reg_loss: 99164.6984; train_edge_recon_loss: 2723935.2004; train_gene_expr_recon_loss: 12352122.6641; train_masked_gp_l1_reg_loss: 66459.9382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109782.3635; train_chrom_access_recon_loss: 44580679.0534; train_global_loss: 59932143.7557; train_optim_loss: 59932143.7557; val_kl_reg_loss: 97248.3422; val_edge_recon_loss: 2749592.9333; val_gene_expr_recon_loss: 12339266.8000; val_masked_gp_l1_reg_loss: 66384.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109944.3594; val_chrom_access_recon_loss: 44586377.3333; val_global_loss: 59948813.3333; val_optim_loss: 59948813.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9625; val_auprc_score: 0.9517; val_best_acc_score: 0.9008; val_best_f1_score: 0.9061; train_kl_reg_loss: 99122.7076; train_edge_recon_loss: 2729147.8969; train_gene_expr_recon_loss: 12336905.7939; train_masked_gp_l1_reg_loss: 66345.6120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109585.7400; train_chrom_access_recon_loss: 44510206.9313; train_global_loss: 59851314.6260; train_optim_loss: 59851314.6260; val_kl_reg_loss: 96616.9125; val_edge_recon_loss: 2725907.6833; val_gene_expr_recon_loss: 12285307.7333; val_masked_gp_l1_reg_loss: 66421.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109851.9297; val_chrom_access_recon_loss: 44309751.7333; val_global_loss: 59593858.1333; val_optim_loss: 59593858.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9576; val_auprc_score: 0.9474; val_best_acc_score: 0.8994; val_best_f1_score: 0.9042; train_kl_reg_loss: 95273.4514; train_edge_recon_loss: 2730926.4885; train_gene_expr_recon_loss: 12348070.0840; train_masked_gp_l1_reg_loss: 66386.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109312.2369; train_chrom_access_recon_loss: 44513235.9695; train_global_loss: 59863205.0382; train_optim_loss: 59863205.0382; val_kl_reg_loss: 93626.8687; val_edge_recon_loss: 2752485.7333; val_gene_expr_recon_loss: 12345065.1333; val_masked_gp_l1_reg_loss: 66320.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109274.7578; val_chrom_access_recon_loss: 44330180.2667; val_global_loss: 59696953.8667; val_optim_loss: 59696953.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9577; val_auprc_score: 0.9481; val_best_acc_score: 0.8987; val_best_f1_score: 0.9038; train_kl_reg_loss: 93575.3099; train_edge_recon_loss: 2734415.8569; train_gene_expr_recon_loss: 12327506.5267; train_masked_gp_l1_reg_loss: 66382.5806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110005.4952; train_chrom_access_recon_loss: 44386269.6794; train_global_loss: 59718155.4198; train_optim_loss: 59718155.4198; val_kl_reg_loss: 91599.6208; val_edge_recon_loss: 2742230.5500; val_gene_expr_recon_loss: 12325518.2000; val_masked_gp_l1_reg_loss: 66416.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110329.0938; val_chrom_access_recon_loss: 44314125.0667; val_global_loss: 59650218.4000; val_optim_loss: 59650218.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9618; val_auprc_score: 0.9526; val_best_acc_score: 0.8992; val_best_f1_score: 0.9043; train_kl_reg_loss: 92940.5854; train_edge_recon_loss: 2731713.0611; train_gene_expr_recon_loss: 12319175.8779; train_masked_gp_l1_reg_loss: 66489.0097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109869.7439; train_chrom_access_recon_loss: 44301768.3053; train_global_loss: 59621956.5802; train_optim_loss: 59621956.5802; val_kl_reg_loss: 91386.2599; val_edge_recon_loss: 2748922.9333; val_gene_expr_recon_loss: 12293442.4000; val_masked_gp_l1_reg_loss: 66931.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110000.0078; val_chrom_access_recon_loss: 44306474.9333; val_global_loss: 59617157.6000; val_optim_loss: 59617157.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9577; val_auprc_score: 0.9504; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 91376.1000; train_edge_recon_loss: 2746327.2366; train_gene_expr_recon_loss: 12334896.1450; train_masked_gp_l1_reg_loss: 69123.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111700.1942; train_chrom_access_recon_loss: 44579111.6641; train_global_loss: 59932535.1450; train_optim_loss: 59932535.1450; val_kl_reg_loss: 90004.9411; val_edge_recon_loss: 2782877.2833; val_gene_expr_recon_loss: 12358636.6000; val_masked_gp_l1_reg_loss: 72334.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113202.8281; val_chrom_access_recon_loss: 44437674.6667; val_global_loss: 59854730.6667; val_optim_loss: 59854730.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9573; val_auprc_score: 0.9469; val_best_acc_score: 0.9014; val_best_f1_score: 0.9056; train_kl_reg_loss: 84914.9057; train_edge_recon_loss: 2747093.9447; train_gene_expr_recon_loss: 12354137.5038; train_masked_gp_l1_reg_loss: 70966.7051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83592.1358; train_chrom_access_recon_loss: 44607489.1298; train_global_loss: 59948194.0458; train_optim_loss: 59948194.0458; val_kl_reg_loss: 87054.9250; val_edge_recon_loss: 2737063.2500; val_gene_expr_recon_loss: 12306550.0000; val_masked_gp_l1_reg_loss: 70059.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80865.8750; val_chrom_access_recon_loss: 44371414.4000; val_global_loss: 59653009.0667; val_optim_loss: 59653009.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9610; val_auprc_score: 0.9543; val_best_acc_score: 0.8988; val_best_f1_score: 0.9021; train_kl_reg_loss: 89304.1496; train_edge_recon_loss: 2742315.3683; train_gene_expr_recon_loss: 12312230.1908; train_masked_gp_l1_reg_loss: 69555.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80384.2965; train_chrom_access_recon_loss: 44217337.6794; train_global_loss: 59511127.6947; train_optim_loss: 59511127.6947; val_kl_reg_loss: 89543.9474; val_edge_recon_loss: 2759182.5000; val_gene_expr_recon_loss: 12312196.4000; val_masked_gp_l1_reg_loss: 69120.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79983.3203; val_chrom_access_recon_loss: 44174819.7333; val_global_loss: 59484845.6000; val_optim_loss: 59484845.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9617; val_auprc_score: 0.9525; val_best_acc_score: 0.9002; val_best_f1_score: 0.9050; train_kl_reg_loss: 92373.3743; train_edge_recon_loss: 2734932.9122; train_gene_expr_recon_loss: 12297381.0229; train_masked_gp_l1_reg_loss: 68805.2783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79724.7207; train_chrom_access_recon_loss: 44201873.8015; train_global_loss: 59475090.9924; train_optim_loss: 59475090.9924; val_kl_reg_loss: 92330.5208; val_edge_recon_loss: 2747381.5333; val_gene_expr_recon_loss: 12311278.0000; val_masked_gp_l1_reg_loss: 68519.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79673.7344; val_chrom_access_recon_loss: 44157009.3333; val_global_loss: 59456193.8667; val_optim_loss: 59456193.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9607; val_auprc_score: 0.9515; val_best_acc_score: 0.8981; val_best_f1_score: 0.9019; train_kl_reg_loss: 93867.1371; train_edge_recon_loss: 2732715.0076; train_gene_expr_recon_loss: 12290298.4427; train_masked_gp_l1_reg_loss: 68235.7853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79441.6920; train_chrom_access_recon_loss: 44111831.6641; train_global_loss: 59376389.7405; train_optim_loss: 59376389.7405; val_kl_reg_loss: 94021.7635; val_edge_recon_loss: 2746052.0333; val_gene_expr_recon_loss: 12297145.2667; val_masked_gp_l1_reg_loss: 68005.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79246.4453; val_chrom_access_recon_loss: 44048554.6667; val_global_loss: 59333024.0000; val_optim_loss: 59333024.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9601; val_auprc_score: 0.9503; val_best_acc_score: 0.9008; val_best_f1_score: 0.9048; train_kl_reg_loss: 95878.2375; train_edge_recon_loss: 2727325.8569; train_gene_expr_recon_loss: 12282672.6565; train_masked_gp_l1_reg_loss: 67798.6190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79183.2921; train_chrom_access_recon_loss: 44070058.2595; train_global_loss: 59322916.8244; train_optim_loss: 59322916.8244; val_kl_reg_loss: 95284.5849; val_edge_recon_loss: 2739781.6333; val_gene_expr_recon_loss: 12287914.1333; val_masked_gp_l1_reg_loss: 67558.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78724.7734; val_chrom_access_recon_loss: 44073321.6000; val_global_loss: 59342586.4000; val_optim_loss: 59342586.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9634; val_auprc_score: 0.9565; val_best_acc_score: 0.9020; val_best_f1_score: 0.9056; train_kl_reg_loss: 96675.0221; train_edge_recon_loss: 2720959.0000; train_gene_expr_recon_loss: 12283344.2672; train_masked_gp_l1_reg_loss: 67379.9259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78448.4180; train_chrom_access_recon_loss: 44079374.8702; train_global_loss: 59326181.4351; train_optim_loss: 59326181.4351; val_kl_reg_loss: 98154.4365; val_edge_recon_loss: 2727033.6833; val_gene_expr_recon_loss: 12265092.6667; val_masked_gp_l1_reg_loss: 67173.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78084.7812; val_chrom_access_recon_loss: 44087368.5333; val_global_loss: 59322907.2000; val_optim_loss: 59322907.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9621; val_auprc_score: 0.9546; val_best_acc_score: 0.9023; val_best_f1_score: 0.9056; train_kl_reg_loss: 98201.0245; train_edge_recon_loss: 2726994.3836; train_gene_expr_recon_loss: 12283551.3282; train_masked_gp_l1_reg_loss: 67002.9314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77824.0414; train_chrom_access_recon_loss: 44070096.9160; train_global_loss: 59323670.4733; train_optim_loss: 59323670.4733; val_kl_reg_loss: 97259.5255; val_edge_recon_loss: 2733976.9667; val_gene_expr_recon_loss: 12329034.0667; val_masked_gp_l1_reg_loss: 66833.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77577.5312; val_chrom_access_recon_loss: 44156771.4667; val_global_loss: 59461453.8667; val_optim_loss: 59461453.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9616; val_auprc_score: 0.9530; val_best_acc_score: 0.9035; val_best_f1_score: 0.9066; train_kl_reg_loss: 97929.3330; train_edge_recon_loss: 2723499.1031; train_gene_expr_recon_loss: 12267908.3359; train_masked_gp_l1_reg_loss: 66691.7655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77293.6785; train_chrom_access_recon_loss: 44018594.8397; train_global_loss: 59251917.1298; train_optim_loss: 59251917.1298; val_kl_reg_loss: 95380.2292; val_edge_recon_loss: 2735062.8000; val_gene_expr_recon_loss: 12276548.5333; val_masked_gp_l1_reg_loss: 66578.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77029.3828; val_chrom_access_recon_loss: 44343194.9333; val_global_loss: 59593794.4000; val_optim_loss: 59593794.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9605; val_auprc_score: 0.9532; val_best_acc_score: 0.8979; val_best_f1_score: 0.9023; train_kl_reg_loss: 96682.9631; train_edge_recon_loss: 2729887.9523; train_gene_expr_recon_loss: 12292717.3664; train_masked_gp_l1_reg_loss: 66437.8904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76186.4125; train_chrom_access_recon_loss: 44140311.6947; train_global_loss: 59402224.3969; train_optim_loss: 59402224.3969; val_kl_reg_loss: 97741.9078; val_edge_recon_loss: 2749797.1833; val_gene_expr_recon_loss: 12277440.8000; val_masked_gp_l1_reg_loss: 66209.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75368.4766; val_chrom_access_recon_loss: 44345657.8667; val_global_loss: 59612215.4667; val_optim_loss: 59612215.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9631; val_auprc_score: 0.9536; val_best_acc_score: 0.9034; val_best_f1_score: 0.9065; train_kl_reg_loss: 99010.8283; train_edge_recon_loss: 2722137.0115; train_gene_expr_recon_loss: 12265574.1069; train_masked_gp_l1_reg_loss: 66104.1904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75127.4012; train_chrom_access_recon_loss: 44017147.8473; train_global_loss: 59245101.4351; train_optim_loss: 59245101.4351; val_kl_reg_loss: 98482.8234; val_edge_recon_loss: 2732109.6667; val_gene_expr_recon_loss: 12293613.0000; val_masked_gp_l1_reg_loss: 65975.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74937.2578; val_chrom_access_recon_loss: 44242062.1333; val_global_loss: 59507180.2667; val_optim_loss: 59507180.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9588; val_auprc_score: 0.9506; val_best_acc_score: 0.8980; val_best_f1_score: 0.9020; train_kl_reg_loss: 99153.7770; train_edge_recon_loss: 2724324.9198; train_gene_expr_recon_loss: 12287210.6489; train_masked_gp_l1_reg_loss: 65846.2844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71960.4227; train_chrom_access_recon_loss: 44031213.4656; train_global_loss: 59279709.4656; train_optim_loss: 59279709.4656; val_kl_reg_loss: 98632.8016; val_edge_recon_loss: 2753311.7500; val_gene_expr_recon_loss: 12276520.8000; val_masked_gp_l1_reg_loss: 65753.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71711.8281; val_chrom_access_recon_loss: 44133937.3333; val_global_loss: 59399868.2667; val_optim_loss: 59399868.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9620; val_auprc_score: 0.9518; val_best_acc_score: 0.9041; val_best_f1_score: 0.9084; train_kl_reg_loss: 99532.1752; train_edge_recon_loss: 2722039.3588; train_gene_expr_recon_loss: 12269448.2672; train_masked_gp_l1_reg_loss: 65706.3412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71689.0867; train_chrom_access_recon_loss: 43997037.1603; train_global_loss: 59225452.3664; train_optim_loss: 59225452.3664; val_kl_reg_loss: 98906.4823; val_edge_recon_loss: 2726838.7167; val_gene_expr_recon_loss: 12300610.4000; val_masked_gp_l1_reg_loss: 65664.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71664.2969; val_chrom_access_recon_loss: 44236503.4667; val_global_loss: 59500187.2000; val_optim_loss: 59500187.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9607; val_auprc_score: 0.9508; val_best_acc_score: 0.9031; val_best_f1_score: 0.9072; train_kl_reg_loss: 99407.5859; train_edge_recon_loss: 2721780.5401; train_gene_expr_recon_loss: 12275528.3053; train_masked_gp_l1_reg_loss: 65634.8897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71650.0142; train_chrom_access_recon_loss: 43999739.7252; train_global_loss: 59233741.1298; train_optim_loss: 59233741.1298; val_kl_reg_loss: 98429.7000; val_edge_recon_loss: 2736210.4667; val_gene_expr_recon_loss: 12274839.6667; val_masked_gp_l1_reg_loss: 65605.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71632.5000; val_chrom_access_recon_loss: 44070196.2667; val_global_loss: 59316914.1333; val_optim_loss: 59316914.1333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9649; val_auprc_score: 0.9586; val_best_acc_score: 0.9046; val_best_f1_score: 0.9066; train_kl_reg_loss: 99609.6496; train_edge_recon_loss: 2728450.0420; train_gene_expr_recon_loss: 12268117.5267; train_masked_gp_l1_reg_loss: 65583.4078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71599.4311; train_chrom_access_recon_loss: 44016013.6794; train_global_loss: 59249373.7710; train_optim_loss: 59249373.7710; val_kl_reg_loss: 98874.1333; val_edge_recon_loss: 2741542.0167; val_gene_expr_recon_loss: 12323537.6667; val_masked_gp_l1_reg_loss: 65560.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71581.1406; val_chrom_access_recon_loss: 44218128.5333; val_global_loss: 59519223.4667; val_optim_loss: 59519223.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9654; val_auprc_score: 0.9594; val_best_acc_score: 0.9084; val_best_f1_score: 0.9100; train_kl_reg_loss: 99764.7319; train_edge_recon_loss: 2724121.2462; train_gene_expr_recon_loss: 12272177.2519; train_masked_gp_l1_reg_loss: 65543.1523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71552.7204; train_chrom_access_recon_loss: 44018480.7328; train_global_loss: 59251639.6947; train_optim_loss: 59251639.6947; val_kl_reg_loss: 99092.0979; val_edge_recon_loss: 2733369.4833; val_gene_expr_recon_loss: 12255993.0000; val_masked_gp_l1_reg_loss: 65521.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71535.8438; val_chrom_access_recon_loss: 44000763.7333; val_global_loss: 59226275.2000; val_optim_loss: 59226275.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9620; val_auprc_score: 0.9535; val_best_acc_score: 0.8985; val_best_f1_score: 0.9041; train_kl_reg_loss: 99995.0093; train_edge_recon_loss: 2727352.5038; train_gene_expr_recon_loss: 12277250.6031; train_masked_gp_l1_reg_loss: 65505.6357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71512.5596; train_chrom_access_recon_loss: 44004212.5496; train_global_loss: 59245828.7328; train_optim_loss: 59245828.7328; val_kl_reg_loss: 99215.2354; val_edge_recon_loss: 2742066.7333; val_gene_expr_recon_loss: 12292506.4667; val_masked_gp_l1_reg_loss: 65485.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71496.3047; val_chrom_access_recon_loss: 44159546.6667; val_global_loss: 59430316.8000; val_optim_loss: 59430316.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9606; val_auprc_score: 0.9521; val_best_acc_score: 0.9000; val_best_f1_score: 0.9041; train_kl_reg_loss: 99849.6632; train_edge_recon_loss: 2720748.7023; train_gene_expr_recon_loss: 12261568.9237; train_masked_gp_l1_reg_loss: 65469.8692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71475.8375; train_chrom_access_recon_loss: 43969034.5954; train_global_loss: 59188147.6641; train_optim_loss: 59188147.6641; val_kl_reg_loss: 98634.4495; val_edge_recon_loss: 2752083.8167; val_gene_expr_recon_loss: 12300328.9333; val_masked_gp_l1_reg_loss: 65447.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71458.4688; val_chrom_access_recon_loss: 44270341.8667; val_global_loss: 59558295.4667; val_optim_loss: 59558295.4667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9658; val_auprc_score: 0.9583; val_best_acc_score: 0.9077; val_best_f1_score: 0.9103; train_kl_reg_loss: 100146.5919; train_edge_recon_loss: 2723686.6870; train_gene_expr_recon_loss: 12275019.0534; train_masked_gp_l1_reg_loss: 65434.0945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71472.2135; train_chrom_access_recon_loss: 43997245.2214; train_global_loss: 59233003.8168; train_optim_loss: 59233003.8168; val_kl_reg_loss: 98925.5875; val_edge_recon_loss: 2712330.6167; val_gene_expr_recon_loss: 12264223.6667; val_masked_gp_l1_reg_loss: 65413.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71450.0078; val_chrom_access_recon_loss: 44114605.0667; val_global_loss: 59326948.0000; val_optim_loss: 59326948.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9614; val_auprc_score: 0.9530; val_best_acc_score: 0.9018; val_best_f1_score: 0.9052; train_kl_reg_loss: 100016.0050; train_edge_recon_loss: 2723822.8149; train_gene_expr_recon_loss: 12268796.3664; train_masked_gp_l1_reg_loss: 65398.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71421.7501; train_chrom_access_recon_loss: 43987256.8855; train_global_loss: 59216712.7939; train_optim_loss: 59216712.7939; val_kl_reg_loss: 99632.4609; val_edge_recon_loss: 2736470.3500; val_gene_expr_recon_loss: 12351663.8667; val_masked_gp_l1_reg_loss: 65380.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71395.3672; val_chrom_access_recon_loss: 44272529.8667; val_global_loss: 59597072.5333; val_optim_loss: 59597072.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9609; val_auprc_score: 0.9524; val_best_acc_score: 0.9034; val_best_f1_score: 0.9063; train_kl_reg_loss: 100063.3025; train_edge_recon_loss: 2720814.6641; train_gene_expr_recon_loss: 12270881.4504; train_masked_gp_l1_reg_loss: 65367.2403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71092.5677; train_chrom_access_recon_loss: 43958583.2977; train_global_loss: 59186802.6870; train_optim_loss: 59186802.6870; val_kl_reg_loss: 99062.9073; val_edge_recon_loss: 2722506.4167; val_gene_expr_recon_loss: 12279563.4000; val_masked_gp_l1_reg_loss: 65356.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71064.5547; val_chrom_access_recon_loss: 44177994.6667; val_global_loss: 59415549.6000; val_optim_loss: 59415549.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9630; val_auprc_score: 0.9540; val_best_acc_score: 0.9043; val_best_f1_score: 0.9091; train_kl_reg_loss: 99965.5705; train_edge_recon_loss: 2718405.4160; train_gene_expr_recon_loss: 12259694.2901; train_masked_gp_l1_reg_loss: 65351.3410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71061.1659; train_chrom_access_recon_loss: 43934638.2595; train_global_loss: 59149116.1527; train_optim_loss: 59149116.1527; val_kl_reg_loss: 98895.3740; val_edge_recon_loss: 2735093.6167; val_gene_expr_recon_loss: 12280882.8667; val_masked_gp_l1_reg_loss: 65346.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71057.6484; val_chrom_access_recon_loss: 44058955.4667; val_global_loss: 59310231.4667; val_optim_loss: 59310231.4667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9665; val_auprc_score: 0.9602; val_best_acc_score: 0.9046; val_best_f1_score: 0.9075; train_kl_reg_loss: 7800855.3216; train_edge_recon_loss: 2725520.7252; train_gene_expr_recon_loss: 12276267.0840; train_masked_gp_l1_reg_loss: 65342.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71053.3603; train_chrom_access_recon_loss: 43977896.2137; train_global_loss: 66916935.1145; train_optim_loss: 66916935.1145; val_kl_reg_loss: 99310.9141; val_edge_recon_loss: 2728471.7167; val_gene_expr_recon_loss: 12283371.5333; val_masked_gp_l1_reg_loss: 65338.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71051.1016; val_chrom_access_recon_loss: 44221784.8000; val_global_loss: 59469329.0667; val_optim_loss: 59469329.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9621; val_auprc_score: 0.9539; val_best_acc_score: 0.9020; val_best_f1_score: 0.9069; train_kl_reg_loss: 100099.8283; train_edge_recon_loss: 2720035.6546; train_gene_expr_recon_loss: 12272008.0534; train_masked_gp_l1_reg_loss: 65336.3785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71047.5418; train_chrom_access_recon_loss: 43982991.2366; train_global_loss: 59211518.7786; train_optim_loss: 59211518.7786; val_kl_reg_loss: 99238.6219; val_edge_recon_loss: 2734213.1333; val_gene_expr_recon_loss: 12300533.2667; val_masked_gp_l1_reg_loss: 65332.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71044.6094; val_chrom_access_recon_loss: 44209235.2000; val_global_loss: 59479598.6667; val_optim_loss: 59479598.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 4 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9615
val AUPRC score: 0.9527
val best accuracy score: 0.9025
val best F1 score: 0.9065
val target rna MSE score: 1.5792
val source rna MSE score: 0.4730
val target atac MSE score: 0.1530
val source atac MSE score: 0.0199
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
