[True]
Run timestamp: 24072023_170326_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9523; val_auprc_score: 0.9591; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 14723.1452; train_edge_recon_loss: 34725619.1111; train_gene_expr_recon_loss: 322512.9340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 109255089.7778; train_global_loss: 144317946.6667; train_optim_loss: 144317946.6667; val_kl_reg_loss: 49863.1836; val_edge_recon_loss: 40646976.0000; val_gene_expr_recon_loss: 309223.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106136944.0000; val_global_loss: 147143008.0000; val_optim_loss: 147143008.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9274; val_auprc_score: 0.9337; val_best_acc_score: 0.5047; val_best_f1_score: 0.6688; train_kl_reg_loss: 38062.9002; train_edge_recon_loss: 34836095.1111; train_gene_expr_recon_loss: 309782.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107455505.7778; train_global_loss: 142639445.3333; train_optim_loss: 142639445.3333; val_kl_reg_loss: 77399.4688; val_edge_recon_loss: 40646864.0000; val_gene_expr_recon_loss: 293328.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104530992.0000; val_global_loss: 145548576.0000; val_optim_loss: 145548576.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9042; val_auprc_score: 0.9145; val_best_acc_score: 0.5154; val_best_f1_score: 0.6736; train_kl_reg_loss: 115191.5330; train_edge_recon_loss: 34800508.8889; train_gene_expr_recon_loss: 290872.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105145660.4444; train_global_loss: 140352232.8889; train_optim_loss: 140352232.8889; val_kl_reg_loss: 210656.5625; val_edge_recon_loss: 40643348.0000; val_gene_expr_recon_loss: 271971.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102291968.0000; val_global_loss: 143417952.0000; val_optim_loss: 143417952.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9121; val_auprc_score: 0.9189; val_best_acc_score: 0.5070; val_best_f1_score: 0.6698; train_kl_reg_loss: 206375.3247; train_edge_recon_loss: 34843549.3333; train_gene_expr_recon_loss: 269168.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102058715.5556; train_global_loss: 137377806.2222; train_optim_loss: 137377806.2222; val_kl_reg_loss: 386346.1250; val_edge_recon_loss: 40650352.0000; val_gene_expr_recon_loss: 254977.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100447168.0000; val_global_loss: 141738848.0000; val_optim_loss: 141738848.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9211; val_auprc_score: 0.9242; val_best_acc_score: 0.5094; val_best_f1_score: 0.6709; train_kl_reg_loss: 305323.9722; train_edge_recon_loss: 34845214.6667; train_gene_expr_recon_loss: 255216.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101403661.3333; train_global_loss: 136809416.8889; train_optim_loss: 136809416.8889; val_kl_reg_loss: 175304.4531; val_edge_recon_loss: 40646544.0000; val_gene_expr_recon_loss: 243726.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99397912.0000; val_global_loss: 140463488.0000; val_optim_loss: 140463488.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9138; val_auprc_score: 0.9131; val_best_acc_score: 0.5154; val_best_f1_score: 0.6736; train_kl_reg_loss: 329760.5069; train_edge_recon_loss: 34840861.3333; train_gene_expr_recon_loss: 241653.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100179299.5556; train_global_loss: 135591576.8889; train_optim_loss: 135591576.8889; val_kl_reg_loss: 262287.1562; val_edge_recon_loss: 40639116.0000; val_gene_expr_recon_loss: 234175.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98248456.0000; val_global_loss: 139384032.0000; val_optim_loss: 139384032.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9078; val_auprc_score: 0.9057; val_best_acc_score: 0.5271; val_best_f1_score: 0.6789; train_kl_reg_loss: 360238.5972; train_edge_recon_loss: 34842760.8889; train_gene_expr_recon_loss: 233031.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98626264.8889; train_global_loss: 134062294.2222; train_optim_loss: 134062294.2222; val_kl_reg_loss: 288378.4688; val_edge_recon_loss: 40632708.0000; val_gene_expr_recon_loss: 228053.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97502408.0000; val_global_loss: 138651552.0000; val_optim_loss: 138651552.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9013; val_auprc_score: 0.9043; val_best_acc_score: 0.5507; val_best_f1_score: 0.6897; train_kl_reg_loss: 370140.5104; train_edge_recon_loss: 34865964.0000; train_gene_expr_recon_loss: 229033.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98317302.2222; train_global_loss: 133782440.0000; train_optim_loss: 133782440.0000; val_kl_reg_loss: 256601.2500; val_edge_recon_loss: 40623172.0000; val_gene_expr_recon_loss: 224321.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97221784.0000; val_global_loss: 138325872.0000; val_optim_loss: 138325872.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8948; val_auprc_score: 0.8983; val_best_acc_score: 0.5730; val_best_f1_score: 0.6998; train_kl_reg_loss: 377078.0903; train_edge_recon_loss: 34859196.4444; train_gene_expr_recon_loss: 224897.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98124927.1111; train_global_loss: 133586099.5556; train_optim_loss: 133586099.5556; val_kl_reg_loss: 210895.7969; val_edge_recon_loss: 40612020.0000; val_gene_expr_recon_loss: 221613.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96951344.0000; val_global_loss: 137995872.0000; val_optim_loss: 137995872.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8937; val_auprc_score: 0.8939; val_best_acc_score: 0.6078; val_best_f1_score: 0.7162; train_kl_reg_loss: 367994.4635; train_edge_recon_loss: 34895423.5556; train_gene_expr_recon_loss: 222788.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98238555.5556; train_global_loss: 133724764.4444; train_optim_loss: 133724764.4444; val_kl_reg_loss: 228974.7188; val_edge_recon_loss: 40597480.0000; val_gene_expr_recon_loss: 219437.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96534128.0000; val_global_loss: 137580016.0000; val_optim_loss: 137580016.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8903; val_auprc_score: 0.8823; val_best_acc_score: 0.6467; val_best_f1_score: 0.7360; train_kl_reg_loss: 344257.1840; train_edge_recon_loss: 34892342.6667; train_gene_expr_recon_loss: 220754.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97842797.3333; train_global_loss: 133300152.0000; train_optim_loss: 133300152.0000; val_kl_reg_loss: 241684.6875; val_edge_recon_loss: 40580072.0000; val_gene_expr_recon_loss: 217801.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96578736.0000; val_global_loss: 137618288.0000; val_optim_loss: 137618288.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8982; val_auprc_score: 0.8955; val_best_acc_score: 0.6727; val_best_f1_score: 0.7494; train_kl_reg_loss: 333408.7153; train_edge_recon_loss: 34868541.3333; train_gene_expr_recon_loss: 217000.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96909992.0000; train_global_loss: 132328943.1111; train_optim_loss: 132328943.1111; val_kl_reg_loss: 254173.0000; val_edge_recon_loss: 40565108.0000; val_gene_expr_recon_loss: 215954.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96347280.0000; val_global_loss: 137382512.0000; val_optim_loss: 137382512.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9042; val_auprc_score: 0.8991; val_best_acc_score: 0.7487; val_best_f1_score: 0.7926; train_kl_reg_loss: 328521.5660; train_edge_recon_loss: 34841041.3333; train_gene_expr_recon_loss: 218325.2205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97116875.5556; train_global_loss: 132504764.4444; train_optim_loss: 132504764.4444; val_kl_reg_loss: 207753.5312; val_edge_recon_loss: 40519704.0000; val_gene_expr_recon_loss: 215297.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96229968.0000; val_global_loss: 137172720.0000; val_optim_loss: 137172720.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9076; val_auprc_score: 0.9013; val_best_acc_score: 0.8098; val_best_f1_score: 0.8301; train_kl_reg_loss: 325684.0781; train_edge_recon_loss: 34868139.5556; train_gene_expr_recon_loss: 217685.7986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97630652.4444; train_global_loss: 133042162.6667; train_optim_loss: 133042162.6667; val_kl_reg_loss: 182335.6406; val_edge_recon_loss: 40437752.0000; val_gene_expr_recon_loss: 215569.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96285424.0000; val_global_loss: 137121088.0000; val_optim_loss: 137121088.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9119; val_auprc_score: 0.9069; val_best_acc_score: 0.8325; val_best_f1_score: 0.8402; train_kl_reg_loss: 323871.9861; train_edge_recon_loss: 34832523.5556; train_gene_expr_recon_loss: 215679.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96262928.0000; train_global_loss: 131635003.5556; train_optim_loss: 131635003.5556; val_kl_reg_loss: 234177.1250; val_edge_recon_loss: 40335036.0000; val_gene_expr_recon_loss: 214403.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96070672.0000; val_global_loss: 136854288.0000; val_optim_loss: 136854288.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9073; val_auprc_score: 0.8983; val_best_acc_score: 0.8265; val_best_f1_score: 0.8227; train_kl_reg_loss: 298684.7674; train_edge_recon_loss: 34836100.0000; train_gene_expr_recon_loss: 216106.7795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96776245.3333; train_global_loss: 132127136.8889; train_optim_loss: 132127136.8889; val_kl_reg_loss: 248029.8125; val_edge_recon_loss: 40116836.0000; val_gene_expr_recon_loss: 213169.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95748160.0000; val_global_loss: 136326192.0000; val_optim_loss: 136326192.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9132; val_auprc_score: 0.9051; val_best_acc_score: 0.8104; val_best_f1_score: 0.8084; train_kl_reg_loss: 284023.3872; train_edge_recon_loss: 34761551.5556; train_gene_expr_recon_loss: 215594.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96842142.2222; train_global_loss: 132103313.7778; train_optim_loss: 132103313.7778; val_kl_reg_loss: 231605.5781; val_edge_recon_loss: 39678824.0000; val_gene_expr_recon_loss: 212789.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95852264.0000; val_global_loss: 135975488.0000; val_optim_loss: 135975488.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9105; val_auprc_score: 0.9015; val_best_acc_score: 0.8196; val_best_f1_score: 0.8356; train_kl_reg_loss: 276156.0868; train_edge_recon_loss: 34655263.1111; train_gene_expr_recon_loss: 215465.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96768284.4444; train_global_loss: 131915168.8889; train_optim_loss: 131915168.8889; val_kl_reg_loss: 201378.6250; val_edge_recon_loss: 38688384.0000; val_gene_expr_recon_loss: 213410.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95865184.0000; val_global_loss: 134968352.0000; val_optim_loss: 134968352.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9007; val_auprc_score: 0.8906; val_best_acc_score: 0.8162; val_best_f1_score: 0.8219; train_kl_reg_loss: 236300.4045; train_edge_recon_loss: 34360681.3333; train_gene_expr_recon_loss: 216718.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96858385.7778; train_global_loss: 131672085.3333; train_optim_loss: 131672085.3333; val_kl_reg_loss: 136668.5625; val_edge_recon_loss: 36262552.0000; val_gene_expr_recon_loss: 214672.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95798504.0000; val_global_loss: 132412400.0000; val_optim_loss: 132412400.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8828; val_auprc_score: 0.8706; val_best_acc_score: 0.7935; val_best_f1_score: 0.7981; train_kl_reg_loss: 124790.0009; train_edge_recon_loss: 33045035.1111; train_gene_expr_recon_loss: 220442.9566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96967014.2222; train_global_loss: 130357282.6667; train_optim_loss: 130357282.6667; val_kl_reg_loss: 69467.2656; val_edge_recon_loss: 31613878.0000; val_gene_expr_recon_loss: 222218.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96426608.0000; val_global_loss: 128332176.0000; val_optim_loss: 128332176.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8807; val_auprc_score: 0.8606; val_best_acc_score: 0.7964; val_best_f1_score: 0.8110; train_kl_reg_loss: 106474.5052; train_edge_recon_loss: 30108740.0000; train_gene_expr_recon_loss: 225929.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97900057.7778; train_global_loss: 128341201.7778; train_optim_loss: 128341201.7778; val_kl_reg_loss: 150862.7812; val_edge_recon_loss: 29469552.0000; val_gene_expr_recon_loss: 220988.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96140400.0000; val_global_loss: 125981800.0000; val_optim_loss: 125981800.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8878; val_auprc_score: 0.8636; val_best_acc_score: 0.8065; val_best_f1_score: 0.8241; train_kl_reg_loss: 174951.1597; train_edge_recon_loss: 29618581.3333; train_gene_expr_recon_loss: 221738.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97017389.3333; train_global_loss: 127032657.7778; train_optim_loss: 127032657.7778; val_kl_reg_loss: 165539.3750; val_edge_recon_loss: 29722762.0000; val_gene_expr_recon_loss: 218465.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96214424.0000; val_global_loss: 126321192.0000; val_optim_loss: 126321192.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8923; val_auprc_score: 0.8695; val_best_acc_score: 0.8141; val_best_f1_score: 0.8240; train_kl_reg_loss: 148692.8229; train_edge_recon_loss: 29976465.3333; train_gene_expr_recon_loss: 221687.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96909666.6667; train_global_loss: 127256512.8889; train_optim_loss: 127256512.8889; val_kl_reg_loss: 164172.8438; val_edge_recon_loss: 29829162.0000; val_gene_expr_recon_loss: 217547.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95738752.0000; val_global_loss: 125949632.0000; val_optim_loss: 125949632.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8847; val_auprc_score: 0.8613; val_best_acc_score: 0.8015; val_best_f1_score: 0.8214; train_kl_reg_loss: 216790.6458; train_edge_recon_loss: 29059049.1111; train_gene_expr_recon_loss: 218867.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96774982.2222; train_global_loss: 126269688.0000; train_optim_loss: 126269688.0000; val_kl_reg_loss: 248175.2812; val_edge_recon_loss: 28844216.0000; val_gene_expr_recon_loss: 217355.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95849888.0000; val_global_loss: 125159632.0000; val_optim_loss: 125159632.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8849; val_auprc_score: 0.8580; val_best_acc_score: 0.8115; val_best_f1_score: 0.8263; train_kl_reg_loss: 279933.1840; train_edge_recon_loss: 28607157.3333; train_gene_expr_recon_loss: 217627.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96315205.3333; train_global_loss: 125419923.5556; train_optim_loss: 125419923.5556; val_kl_reg_loss: 280296.0312; val_edge_recon_loss: 28567538.0000; val_gene_expr_recon_loss: 215180.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95506960.0000; val_global_loss: 124569976.0000; val_optim_loss: 124569976.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8967; val_auprc_score: 0.8731; val_best_acc_score: 0.8235; val_best_f1_score: 0.8378; train_kl_reg_loss: 297155.6042; train_edge_recon_loss: 29516225.7778; train_gene_expr_recon_loss: 223033.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97225948.4444; train_global_loss: 127262363.5556; train_optim_loss: 127262363.5556; val_kl_reg_loss: 77051.2031; val_edge_recon_loss: 29241598.0000; val_gene_expr_recon_loss: 221873.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96062800.0000; val_global_loss: 125603328.0000; val_optim_loss: 125603328.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9035; val_auprc_score: 0.8760; val_best_acc_score: 0.8308; val_best_f1_score: 0.8458; train_kl_reg_loss: 382409.9097; train_edge_recon_loss: 28947008.6667; train_gene_expr_recon_loss: 221539.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96585302.2222; train_global_loss: 126136260.4444; train_optim_loss: 126136260.4444; val_kl_reg_loss: 98046.5234; val_edge_recon_loss: 28422270.0000; val_gene_expr_recon_loss: 221842.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96025304.0000; val_global_loss: 124767464.0000; val_optim_loss: 124767464.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8947; val_auprc_score: 0.8666; val_best_acc_score: 0.8252; val_best_f1_score: 0.8386; train_kl_reg_loss: 451815.7604; train_edge_recon_loss: 28533143.3333; train_gene_expr_recon_loss: 222933.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97437189.3333; train_global_loss: 126645081.7778; train_optim_loss: 126645081.7778; val_kl_reg_loss: 110295.7344; val_edge_recon_loss: 28826252.0000; val_gene_expr_recon_loss: 219220.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95510848.0000; val_global_loss: 124666616.0000; val_optim_loss: 124666616.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8976; val_auprc_score: 0.8712; val_best_acc_score: 0.8232; val_best_f1_score: 0.8380; train_kl_reg_loss: 470965.5451; train_edge_recon_loss: 28396401.5556; train_gene_expr_recon_loss: 221999.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96733646.2222; train_global_loss: 125823012.4444; train_optim_loss: 125823012.4444; val_kl_reg_loss: 111666.3125; val_edge_recon_loss: 28682182.0000; val_gene_expr_recon_loss: 219936.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95677456.0000; val_global_loss: 124691240.0000; val_optim_loss: 124691240.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9007; val_auprc_score: 0.8771; val_best_acc_score: 0.8277; val_best_f1_score: 0.8392; train_kl_reg_loss: 468869.5521; train_edge_recon_loss: 28318777.5556; train_gene_expr_recon_loss: 221342.3420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97025985.7778; train_global_loss: 126034976.0000; train_optim_loss: 126034976.0000; val_kl_reg_loss: 114500.9375; val_edge_recon_loss: 28575898.0000; val_gene_expr_recon_loss: 218291.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95454048.0000; val_global_loss: 124362736.0000; val_optim_loss: 124362736.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9016; val_auprc_score: 0.8726; val_best_acc_score: 0.8317; val_best_f1_score: 0.8432; train_kl_reg_loss: 464830.0174; train_edge_recon_loss: 28353652.6667; train_gene_expr_recon_loss: 221225.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96453091.5556; train_global_loss: 125492800.0000; train_optim_loss: 125492800.0000; val_kl_reg_loss: 114190.2656; val_edge_recon_loss: 28464394.0000; val_gene_expr_recon_loss: 218690.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95492272.0000; val_global_loss: 124289544.0000; val_optim_loss: 124289544.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9030; val_auprc_score: 0.8761; val_best_acc_score: 0.8327; val_best_f1_score: 0.8452; train_kl_reg_loss: 462483.8438; train_edge_recon_loss: 28166621.1111; train_gene_expr_recon_loss: 220701.4965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96632377.7778; train_global_loss: 125482185.7778; train_optim_loss: 125482185.7778; val_kl_reg_loss: 115839.9453; val_edge_recon_loss: 28410528.0000; val_gene_expr_recon_loss: 217933.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95300648.0000; val_global_loss: 124044952.0000; val_optim_loss: 124044952.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8981; val_auprc_score: 0.8713; val_best_acc_score: 0.8258; val_best_f1_score: 0.8396; train_kl_reg_loss: 461442.1632; train_edge_recon_loss: 28294196.4444; train_gene_expr_recon_loss: 219677.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96467825.7778; train_global_loss: 125443142.2222; train_optim_loss: 125443142.2222; val_kl_reg_loss: 118410.5469; val_edge_recon_loss: 28491796.0000; val_gene_expr_recon_loss: 218115.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95465712.0000; val_global_loss: 124294032.0000; val_optim_loss: 124294032.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8986; val_auprc_score: 0.8688; val_best_acc_score: 0.8227; val_best_f1_score: 0.8383; train_kl_reg_loss: 458536.3924; train_edge_recon_loss: 28207252.0000; train_gene_expr_recon_loss: 220302.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95987223.1111; train_global_loss: 124873313.7778; train_optim_loss: 124873313.7778; val_kl_reg_loss: 116812.1719; val_edge_recon_loss: 28470274.0000; val_gene_expr_recon_loss: 218702.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95477776.0000; val_global_loss: 124283568.0000; val_optim_loss: 124283568.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8976; val_auprc_score: 0.8679; val_best_acc_score: 0.8257; val_best_f1_score: 0.8392; train_kl_reg_loss: 454578.6562; train_edge_recon_loss: 28255181.5556; train_gene_expr_recon_loss: 219679.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96213863.1111; train_global_loss: 125143303.1111; train_optim_loss: 125143303.1111; val_kl_reg_loss: 116339.9844; val_edge_recon_loss: 28453088.0000; val_gene_expr_recon_loss: 218310.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95385600.0000; val_global_loss: 124173336.0000; val_optim_loss: 124173336.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9079; val_auprc_score: 0.8893; val_best_acc_score: 0.8309; val_best_f1_score: 0.8428; train_kl_reg_loss: 453718.2708; train_edge_recon_loss: 28209388.0000; train_gene_expr_recon_loss: 221363.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96563650.6667; train_global_loss: 125448120.8889; train_optim_loss: 125448120.8889; val_kl_reg_loss: 115105.5938; val_edge_recon_loss: 28402888.0000; val_gene_expr_recon_loss: 217962.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95360848.0000; val_global_loss: 124096800.0000; val_optim_loss: 124096800.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8925; val_auprc_score: 0.8630; val_best_acc_score: 0.8240; val_best_f1_score: 0.8379; train_kl_reg_loss: 453992.4167; train_edge_recon_loss: 28162088.4444; train_gene_expr_recon_loss: 219696.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96067899.5556; train_global_loss: 124903676.4444; train_optim_loss: 124903676.4444; val_kl_reg_loss: 113439.8438; val_edge_recon_loss: 28610286.0000; val_gene_expr_recon_loss: 218068.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95377160.0000; val_global_loss: 124318952.0000; val_optim_loss: 124318952.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9020; val_auprc_score: 0.8761; val_best_acc_score: 0.8279; val_best_f1_score: 0.8424; train_kl_reg_loss: 456599.1285; train_edge_recon_loss: 28209012.2222; train_gene_expr_recon_loss: 219911.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96252665.7778; train_global_loss: 125138189.3333; train_optim_loss: 125138189.3333; val_kl_reg_loss: 114017.3750; val_edge_recon_loss: 28173294.0000; val_gene_expr_recon_loss: 218315.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95446080.0000; val_global_loss: 123951712.0000; val_optim_loss: 123951712.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9039; val_auprc_score: 0.8813; val_best_acc_score: 0.8314; val_best_f1_score: 0.8437; train_kl_reg_loss: 453297.7674; train_edge_recon_loss: 28276710.2222; train_gene_expr_recon_loss: 220111.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96173611.5556; train_global_loss: 125123729.7778; train_optim_loss: 125123729.7778; val_kl_reg_loss: 113234.5781; val_edge_recon_loss: 28411394.0000; val_gene_expr_recon_loss: 218385.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95404304.0000; val_global_loss: 124147320.0000; val_optim_loss: 124147320.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9006; val_auprc_score: 0.8761; val_best_acc_score: 0.8259; val_best_f1_score: 0.8396; train_kl_reg_loss: 453460.3090; train_edge_recon_loss: 28233909.5556; train_gene_expr_recon_loss: 220612.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96296409.7778; train_global_loss: 125204392.0000; train_optim_loss: 125204392.0000; val_kl_reg_loss: 113238.4766; val_edge_recon_loss: 28433460.0000; val_gene_expr_recon_loss: 218293.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95420152.0000; val_global_loss: 124185144.0000; val_optim_loss: 124185144.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9018; val_auprc_score: 0.8763; val_best_acc_score: 0.8297; val_best_f1_score: 0.8405; train_kl_reg_loss: 453962.9028; train_edge_recon_loss: 28347865.5556; train_gene_expr_recon_loss: 220033.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96516056.0000; train_global_loss: 125537916.4444; train_optim_loss: 125537916.4444; val_kl_reg_loss: 112905.1953; val_edge_recon_loss: 28391916.0000; val_gene_expr_recon_loss: 218124.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95261144.0000; val_global_loss: 123984088.0000; val_optim_loss: 123984088.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9091; val_auprc_score: 0.8870; val_best_acc_score: 0.8364; val_best_f1_score: 0.8450; train_kl_reg_loss: 452648.0208; train_edge_recon_loss: 28255980.0000; train_gene_expr_recon_loss: 221027.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96115464.0000; train_global_loss: 125045120.0000; train_optim_loss: 125045120.0000; val_kl_reg_loss: 112327.8047; val_edge_recon_loss: 28341580.0000; val_gene_expr_recon_loss: 219023.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95475136.0000; val_global_loss: 124148064.0000; val_optim_loss: 124148064.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8949; val_auprc_score: 0.8648; val_best_acc_score: 0.8226; val_best_f1_score: 0.8361; train_kl_reg_loss: 457774.7396; train_edge_recon_loss: 28298351.7778; train_gene_expr_recon_loss: 222657.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96891505.7778; train_global_loss: 125870290.6667; train_optim_loss: 125870290.6667; val_kl_reg_loss: 111382.8438; val_edge_recon_loss: 28621184.0000; val_gene_expr_recon_loss: 218876.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95326520.0000; val_global_loss: 124277960.0000; val_optim_loss: 124277960.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9073; val_auprc_score: 0.8826; val_best_acc_score: 0.8321; val_best_f1_score: 0.8445; train_kl_reg_loss: 450661.7500; train_edge_recon_loss: 28315467.3333; train_gene_expr_recon_loss: 220474.5608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95862456.0000; train_global_loss: 124849062.2222; train_optim_loss: 124849062.2222; val_kl_reg_loss: 112062.4453; val_edge_recon_loss: 28103072.0000; val_gene_expr_recon_loss: 218785.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95383664.0000; val_global_loss: 123817584.0000; val_optim_loss: 123817584.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9025; val_auprc_score: 0.8763; val_best_acc_score: 0.8270; val_best_f1_score: 0.8407; train_kl_reg_loss: 452894.5208; train_edge_recon_loss: 28200459.7778; train_gene_expr_recon_loss: 219707.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95960996.4444; train_global_loss: 124834058.6667; train_optim_loss: 124834058.6667; val_kl_reg_loss: 111936.7812; val_edge_recon_loss: 28319878.0000; val_gene_expr_recon_loss: 218770.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95411568.0000; val_global_loss: 124062152.0000; val_optim_loss: 124062152.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.8932; val_auprc_score: 0.8671; val_best_acc_score: 0.8209; val_best_f1_score: 0.8347; train_kl_reg_loss: 454406.6701; train_edge_recon_loss: 28211547.7778; train_gene_expr_recon_loss: 221683.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96768680.8889; train_global_loss: 125656320.8889; train_optim_loss: 125656320.8889; val_kl_reg_loss: 111811.2500; val_edge_recon_loss: 28875026.0000; val_gene_expr_recon_loss: 218969.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95421696.0000; val_global_loss: 124627504.0000; val_optim_loss: 124627504.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.8992; val_auprc_score: 0.8693; val_best_acc_score: 0.8254; val_best_f1_score: 0.8396; train_kl_reg_loss: 452411.8785; train_edge_recon_loss: 28197546.0000; train_gene_expr_recon_loss: 220184.0608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96467363.5556; train_global_loss: 125337506.6667; train_optim_loss: 125337506.6667; val_kl_reg_loss: 111786.5703; val_edge_recon_loss: 28506842.0000; val_gene_expr_recon_loss: 218799.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95354224.0000; val_global_loss: 124191648.0000; val_optim_loss: 124191648.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9078; val_auprc_score: 0.8833; val_best_acc_score: 0.8368; val_best_f1_score: 0.8477; train_kl_reg_loss: 454297.6493; train_edge_recon_loss: 28279502.2222; train_gene_expr_recon_loss: 220688.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96853177.7778; train_global_loss: 125807665.7778; train_optim_loss: 125807665.7778; val_kl_reg_loss: 111629.3281; val_edge_recon_loss: 28185784.0000; val_gene_expr_recon_loss: 218690.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95357448.0000; val_global_loss: 123873552.0000; val_optim_loss: 123873552.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9022; val_auprc_score: 0.8731; val_best_acc_score: 0.8323; val_best_f1_score: 0.8416; train_kl_reg_loss: 454234.5208; train_edge_recon_loss: 28282244.2222; train_gene_expr_recon_loss: 221295.3142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96204873.7778; train_global_loss: 125162647.1111; train_optim_loss: 125162647.1111; val_kl_reg_loss: 112264.1641; val_edge_recon_loss: 28343412.0000; val_gene_expr_recon_loss: 218904.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95402360.0000; val_global_loss: 124076944.0000; val_optim_loss: 124076944.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9012; val_auprc_score: 0.8731; val_best_acc_score: 0.8288; val_best_f1_score: 0.8410; train_kl_reg_loss: 454592.5903; train_edge_recon_loss: 28368958.4444; train_gene_expr_recon_loss: 222201.5885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96467648.8889; train_global_loss: 125513402.6667; train_optim_loss: 125513402.6667; val_kl_reg_loss: 111874.5781; val_edge_recon_loss: 28460440.0000; val_gene_expr_recon_loss: 218900.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95482416.0000; val_global_loss: 124273632.0000; val_optim_loss: 124273632.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9010; val_auprc_score: 0.8758; val_best_acc_score: 0.8298; val_best_f1_score: 0.8400; train_kl_reg_loss: 457059.4410; train_edge_recon_loss: 28375247.1111; train_gene_expr_recon_loss: 220596.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96899762.6667; train_global_loss: 125952665.7778; train_optim_loss: 125952665.7778; val_kl_reg_loss: 112382.7188; val_edge_recon_loss: 28395748.0000; val_gene_expr_recon_loss: 219023.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95515456.0000; val_global_loss: 124242608.0000; val_optim_loss: 124242608.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.8943; val_auprc_score: 0.8674; val_best_acc_score: 0.8226; val_best_f1_score: 0.8375; train_kl_reg_loss: 454463.2743; train_edge_recon_loss: 28243277.5556; train_gene_expr_recon_loss: 220087.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96481333.3333; train_global_loss: 125399161.7778; train_optim_loss: 125399161.7778; val_kl_reg_loss: 111974.0469; val_edge_recon_loss: 28488902.0000; val_gene_expr_recon_loss: 218858.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95454408.0000; val_global_loss: 124274144.0000; val_optim_loss: 124274144.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 16 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9062
Val AUPRC score: 0.8810
Val best accuracy score: 0.8323
Val best F1 score: 0.8433
Val gene expr MSE score: 0.7130
Val chrom access MSE score: 0.0850
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
