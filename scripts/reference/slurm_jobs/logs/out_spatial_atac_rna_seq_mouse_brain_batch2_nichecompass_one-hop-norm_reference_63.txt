[True]
Run timestamp: 07082023_191300_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8760; val_auprc_score: 0.8920; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 30438.0188; train_edge_recon_loss: 352305.5625; train_gene_expr_recon_loss: 1287204.3194; train_masked_gp_l1_reg_loss: 16732.0579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167239.3247; train_chrom_access_recon_loss: 2658413.4722; train_global_loss: 4512332.7500; train_optim_loss: 4512332.7500; val_kl_reg_loss: 10584.6484; val_edge_recon_loss: 406560.2500; val_gene_expr_recon_loss: 1036631.2500; val_masked_gp_l1_reg_loss: 12936.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162779.4531; val_chrom_access_recon_loss: 1714461.1250; val_global_loss: 3343953.2500; val_optim_loss: 3343953.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8759; val_auprc_score: 0.8965; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 10053.7882; train_edge_recon_loss: 354043.1701; train_gene_expr_recon_loss: 965858.0625; train_masked_gp_l1_reg_loss: 11688.5101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160011.3872; train_chrom_access_recon_loss: 1546905.9167; train_global_loss: 3048560.8611; train_optim_loss: 3048560.8611; val_kl_reg_loss: 9076.5938; val_edge_recon_loss: 406562.0312; val_gene_expr_recon_loss: 884550.8750; val_masked_gp_l1_reg_loss: 10906.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156695.7969; val_chrom_access_recon_loss: 1425098.0000; val_global_loss: 2892889.5000; val_optim_loss: 2892889.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8766; val_auprc_score: 0.8947; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 11940.8236; train_edge_recon_loss: 355495.0243; train_gene_expr_recon_loss: 854672.5000; train_masked_gp_l1_reg_loss: 11184.2188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154049.8628; train_chrom_access_recon_loss: 1412282.4028; train_global_loss: 2799624.7778; train_optim_loss: 2799624.7778; val_kl_reg_loss: 15037.9033; val_edge_recon_loss: 406588.0625; val_gene_expr_recon_loss: 794262.8125; val_masked_gp_l1_reg_loss: 11437.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150585.1406; val_chrom_access_recon_loss: 1383981.7500; val_global_loss: 2761893.5000; val_optim_loss: 2761893.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8859; val_auprc_score: 0.9019; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 17125.2183; train_edge_recon_loss: 358919.0139; train_gene_expr_recon_loss: 790036.4722; train_masked_gp_l1_reg_loss: 11381.1712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147424.7830; train_chrom_access_recon_loss: 1379761.8611; train_global_loss: 2704648.5556; train_optim_loss: 2704648.5556; val_kl_reg_loss: 16806.0117; val_edge_recon_loss: 406577.1250; val_gene_expr_recon_loss: 758683.1875; val_masked_gp_l1_reg_loss: 11309.2959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143224.9688; val_chrom_access_recon_loss: 1361755.1250; val_global_loss: 2698355.5000; val_optim_loss: 2698355.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8836; val_auprc_score: 0.8923; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 18174.4340; train_edge_recon_loss: 358617.4167; train_gene_expr_recon_loss: 759415.1042; train_masked_gp_l1_reg_loss: 11289.6166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139608.0278; train_chrom_access_recon_loss: 1357906.0139; train_global_loss: 2645010.5833; train_optim_loss: 2645010.5833; val_kl_reg_loss: 19366.9395; val_edge_recon_loss: 406555.6250; val_gene_expr_recon_loss: 735989.0000; val_masked_gp_l1_reg_loss: 11243.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135009.9375; val_chrom_access_recon_loss: 1348701.5000; val_global_loss: 2656866.5000; val_optim_loss: 2656866.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8877; val_auprc_score: 0.8894; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 20428.2873; train_edge_recon_loss: 359900.3368; train_gene_expr_recon_loss: 734238.7847; train_masked_gp_l1_reg_loss: 11185.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131252.7413; train_chrom_access_recon_loss: 1346261.4167; train_global_loss: 2603266.7778; train_optim_loss: 2603266.7778; val_kl_reg_loss: 20712.6914; val_edge_recon_loss: 406490.2812; val_gene_expr_recon_loss: 717261.3750; val_masked_gp_l1_reg_loss: 11080.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126537.7188; val_chrom_access_recon_loss: 1339014.0000; val_global_loss: 2621096.5000; val_optim_loss: 2621096.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8779; val_auprc_score: 0.8773; val_best_acc_score: 0.5260; val_best_f1_score: 0.6777; train_kl_reg_loss: 20894.5312; train_edge_recon_loss: 359648.9965; train_gene_expr_recon_loss: 718076.1181; train_masked_gp_l1_reg_loss: 10998.0986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122775.8481; train_chrom_access_recon_loss: 1335852.7083; train_global_loss: 2568246.3333; train_optim_loss: 2568246.3333; val_kl_reg_loss: 22044.8203; val_edge_recon_loss: 406342.4688; val_gene_expr_recon_loss: 702680.3750; val_masked_gp_l1_reg_loss: 10892.5723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118108.7188; val_chrom_access_recon_loss: 1332022.3750; val_global_loss: 2592091.5000; val_optim_loss: 2592091.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8703; val_auprc_score: 0.8684; val_best_acc_score: 0.5670; val_best_f1_score: 0.6962; train_kl_reg_loss: 21832.5831; train_edge_recon_loss: 359689.5486; train_gene_expr_recon_loss: 704130.4236; train_masked_gp_l1_reg_loss: 10817.5610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114463.2977; train_chrom_access_recon_loss: 1330181.4306; train_global_loss: 2541114.8889; train_optim_loss: 2541114.8889; val_kl_reg_loss: 22475.1523; val_edge_recon_loss: 406024.1875; val_gene_expr_recon_loss: 690187.9375; val_masked_gp_l1_reg_loss: 10705.1416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109974.6875; val_chrom_access_recon_loss: 1325973.6250; val_global_loss: 2565340.5000; val_optim_loss: 2565340.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8519; val_auprc_score: 0.8513; val_best_acc_score: 0.6272; val_best_f1_score: 0.7226; train_kl_reg_loss: 22684.8813; train_edge_recon_loss: 359487.8090; train_gene_expr_recon_loss: 696138.8681; train_masked_gp_l1_reg_loss: 10619.2844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106515.6580; train_chrom_access_recon_loss: 1328328.3750; train_global_loss: 2523774.9444; train_optim_loss: 2523774.9444; val_kl_reg_loss: 21585.7891; val_edge_recon_loss: 405480.9062; val_gene_expr_recon_loss: 681512.1250; val_masked_gp_l1_reg_loss: 10506.9512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102279.2578; val_chrom_access_recon_loss: 1320183.7500; val_global_loss: 2541548.7500; val_optim_loss: 2541548.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8400; val_auprc_score: 0.8341; val_best_acc_score: 0.6995; val_best_f1_score: 0.7572; train_kl_reg_loss: 23367.3620; train_edge_recon_loss: 359594.1389; train_gene_expr_recon_loss: 687707.6042; train_masked_gp_l1_reg_loss: 10439.2448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99062.7318; train_chrom_access_recon_loss: 1326671.0000; train_global_loss: 2506842.0000; train_optim_loss: 2506842.0000; val_kl_reg_loss: 21828.2578; val_edge_recon_loss: 404533.9062; val_gene_expr_recon_loss: 674748.2500; val_masked_gp_l1_reg_loss: 10340.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95146.3594; val_chrom_access_recon_loss: 1315705.1250; val_global_loss: 2522302.0000; val_optim_loss: 2522302.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8327; val_auprc_score: 0.8259; val_best_acc_score: 0.7404; val_best_f1_score: 0.7705; train_kl_reg_loss: 23675.8561; train_edge_recon_loss: 359383.1354; train_gene_expr_recon_loss: 681474.8819; train_masked_gp_l1_reg_loss: 10278.8666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92199.3707; train_chrom_access_recon_loss: 1319811.2500; train_global_loss: 2486823.3333; train_optim_loss: 2486823.3333; val_kl_reg_loss: 22577.9609; val_edge_recon_loss: 403165.3438; val_gene_expr_recon_loss: 668908.3750; val_masked_gp_l1_reg_loss: 10194.2051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88623.1406; val_chrom_access_recon_loss: 1311512.8750; val_global_loss: 2504982.0000; val_optim_loss: 2504982.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8319; val_auprc_score: 0.8166; val_best_acc_score: 0.7497; val_best_f1_score: 0.7548; train_kl_reg_loss: 23934.4266; train_edge_recon_loss: 359002.1701; train_gene_expr_recon_loss: 678664.1667; train_masked_gp_l1_reg_loss: 10142.6616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85953.3646; train_chrom_access_recon_loss: 1319490.9167; train_global_loss: 2477187.6944; train_optim_loss: 2477187.6944; val_kl_reg_loss: 22535.6211; val_edge_recon_loss: 401195.5625; val_gene_expr_recon_loss: 664850.0000; val_masked_gp_l1_reg_loss: 10071.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82719.7812; val_chrom_access_recon_loss: 1307955.6250; val_global_loss: 2489328.2500; val_optim_loss: 2489328.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8439; val_auprc_score: 0.8389; val_best_acc_score: 0.7458; val_best_f1_score: 0.7570; train_kl_reg_loss: 23677.4607; train_edge_recon_loss: 358185.1389; train_gene_expr_recon_loss: 669174.3125; train_masked_gp_l1_reg_loss: 10041.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80308.7431; train_chrom_access_recon_loss: 1311466.0139; train_global_loss: 2452853.1667; train_optim_loss: 2452853.1667; val_kl_reg_loss: 21528.3594; val_edge_recon_loss: 397634.3125; val_gene_expr_recon_loss: 662432.1250; val_masked_gp_l1_reg_loss: 9996.1299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77377.4375; val_chrom_access_recon_loss: 1305373.1250; val_global_loss: 2474341.5000; val_optim_loss: 2474341.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8455; val_auprc_score: 0.8376; val_best_acc_score: 0.7416; val_best_f1_score: 0.7751; train_kl_reg_loss: 23434.7498; train_edge_recon_loss: 357062.7847; train_gene_expr_recon_loss: 672026.1597; train_masked_gp_l1_reg_loss: 9975.5352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75189.1814; train_chrom_access_recon_loss: 1312115.0833; train_global_loss: 2449803.5000; train_optim_loss: 2449803.5000; val_kl_reg_loss: 22782.2910; val_edge_recon_loss: 393195.1562; val_gene_expr_recon_loss: 658954.6250; val_masked_gp_l1_reg_loss: 9937.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72533.8438; val_chrom_access_recon_loss: 1302658.1250; val_global_loss: 2460061.5000; val_optim_loss: 2460061.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8524; val_auprc_score: 0.8454; val_best_acc_score: 0.7677; val_best_f1_score: 0.7792; train_kl_reg_loss: 22980.3273; train_edge_recon_loss: 354990.1458; train_gene_expr_recon_loss: 669612.5556; train_masked_gp_l1_reg_loss: 9917.3755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70543.5799; train_chrom_access_recon_loss: 1304883.1806; train_global_loss: 2432927.1667; train_optim_loss: 2432927.1667; val_kl_reg_loss: 20500.1680; val_edge_recon_loss: 384550.2188; val_gene_expr_recon_loss: 658959.6250; val_masked_gp_l1_reg_loss: 9886.5332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68119.1797; val_chrom_access_recon_loss: 1300873.8750; val_global_loss: 2442889.5000; val_optim_loss: 2442889.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8593; val_auprc_score: 0.8526; val_best_acc_score: 0.7741; val_best_f1_score: 0.7881; train_kl_reg_loss: 22379.4421; train_edge_recon_loss: 351772.4722; train_gene_expr_recon_loss: 665104.7639; train_masked_gp_l1_reg_loss: 9884.1359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66312.7830; train_chrom_access_recon_loss: 1305253.7639; train_global_loss: 2420707.3889; train_optim_loss: 2420707.3889; val_kl_reg_loss: 21145.0508; val_edge_recon_loss: 373093.5000; val_gene_expr_recon_loss: 656381.6875; val_masked_gp_l1_reg_loss: 9867.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64103.8203; val_chrom_access_recon_loss: 1298498.8750; val_global_loss: 2423090.7500; val_optim_loss: 2423090.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8707; val_auprc_score: 0.8645; val_best_acc_score: 0.7852; val_best_f1_score: 0.7930; train_kl_reg_loss: 22282.6289; train_edge_recon_loss: 345839.7778; train_gene_expr_recon_loss: 663136.2083; train_masked_gp_l1_reg_loss: 9862.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62439.9631; train_chrom_access_recon_loss: 1302578.1111; train_global_loss: 2406139.0833; train_optim_loss: 2406139.0833; val_kl_reg_loss: 22053.5117; val_edge_recon_loss: 356556.2188; val_gene_expr_recon_loss: 655769.1250; val_masked_gp_l1_reg_loss: 9854.2822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60410.8281; val_chrom_access_recon_loss: 1296604.0000; val_global_loss: 2401248.0000; val_optim_loss: 2401248.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8690; val_auprc_score: 0.8570; val_best_acc_score: 0.7863; val_best_f1_score: 0.7977; train_kl_reg_loss: 23749.3932; train_edge_recon_loss: 336305.0486; train_gene_expr_recon_loss: 662400.8403; train_masked_gp_l1_reg_loss: 9852.7040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58884.0699; train_chrom_access_recon_loss: 1299663.7083; train_global_loss: 2390855.7222; train_optim_loss: 2390855.7222; val_kl_reg_loss: 24820.2148; val_edge_recon_loss: 336468.7188; val_gene_expr_recon_loss: 655811.0000; val_masked_gp_l1_reg_loss: 9853.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57032.8828; val_chrom_access_recon_loss: 1295300.2500; val_global_loss: 2379286.5000; val_optim_loss: 2379286.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8763; val_auprc_score: 0.8604; val_best_acc_score: 0.7935; val_best_f1_score: 0.8053; train_kl_reg_loss: 27759.4013; train_edge_recon_loss: 325519.5660; train_gene_expr_recon_loss: 666542.5903; train_masked_gp_l1_reg_loss: 9869.3896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55646.9188; train_chrom_access_recon_loss: 1300097.1667; train_global_loss: 2385435.1111; train_optim_loss: 2385435.1111; val_kl_reg_loss: 29019.9902; val_edge_recon_loss: 323641.8750; val_gene_expr_recon_loss: 654686.6875; val_masked_gp_l1_reg_loss: 9891.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53963.4336; val_chrom_access_recon_loss: 1293619.3750; val_global_loss: 2364822.7500; val_optim_loss: 2364822.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8885; val_auprc_score: 0.8713; val_best_acc_score: 0.8071; val_best_f1_score: 0.8202; train_kl_reg_loss: 31014.0302; train_edge_recon_loss: 318399.9653; train_gene_expr_recon_loss: 662896.5556; train_masked_gp_l1_reg_loss: 9912.9810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52705.3785; train_chrom_access_recon_loss: 1298784.1528; train_global_loss: 2373712.9722; train_optim_loss: 2373712.9722; val_kl_reg_loss: 29783.0820; val_edge_recon_loss: 315388.7812; val_gene_expr_recon_loss: 653826.5000; val_masked_gp_l1_reg_loss: 9925.7793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51149.9609; val_chrom_access_recon_loss: 1291335.6250; val_global_loss: 2351409.7500; val_optim_loss: 2351409.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8922; val_auprc_score: 0.8722; val_best_acc_score: 0.8176; val_best_f1_score: 0.8287; train_kl_reg_loss: 30850.3016; train_edge_recon_loss: 313771.7639; train_gene_expr_recon_loss: 660691.5556; train_masked_gp_l1_reg_loss: 9949.4430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49987.4505; train_chrom_access_recon_loss: 1293857.8056; train_global_loss: 2359108.2778; train_optim_loss: 2359108.2778; val_kl_reg_loss: 29345.1992; val_edge_recon_loss: 314021.5938; val_gene_expr_recon_loss: 652922.0000; val_masked_gp_l1_reg_loss: 9961.5049; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48559.7070; val_chrom_access_recon_loss: 1289557.6250; val_global_loss: 2344367.5000; val_optim_loss: 2344367.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9109; val_auprc_score: 0.8912; val_best_acc_score: 0.8375; val_best_f1_score: 0.8471; train_kl_reg_loss: 30048.1625; train_edge_recon_loss: 309570.7569; train_gene_expr_recon_loss: 657584.0556; train_masked_gp_l1_reg_loss: 9973.9243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47491.9175; train_chrom_access_recon_loss: 1288423.6250; train_global_loss: 2343092.4722; train_optim_loss: 2343092.4722; val_kl_reg_loss: 28947.2773; val_edge_recon_loss: 309800.3125; val_gene_expr_recon_loss: 651848.0625; val_masked_gp_l1_reg_loss: 9975.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46170.2930; val_chrom_access_recon_loss: 1287431.8750; val_global_loss: 2334173.5000; val_optim_loss: 2334173.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9175; val_auprc_score: 0.8953; val_best_acc_score: 0.8460; val_best_f1_score: 0.8536; train_kl_reg_loss: 30040.8322; train_edge_recon_loss: 307368.3403; train_gene_expr_recon_loss: 659115.3333; train_masked_gp_l1_reg_loss: 9985.7683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45180.1667; train_chrom_access_recon_loss: 1286854.7500; train_global_loss: 2338545.1944; train_optim_loss: 2338545.1944; val_kl_reg_loss: 29168.7383; val_edge_recon_loss: 305369.5938; val_gene_expr_recon_loss: 650609.0000; val_masked_gp_l1_reg_loss: 10001.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43962.2734; val_chrom_access_recon_loss: 1285432.1250; val_global_loss: 2324542.7500; val_optim_loss: 2324542.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9240; val_auprc_score: 0.9038; val_best_acc_score: 0.8525; val_best_f1_score: 0.8595; train_kl_reg_loss: 30355.9397; train_edge_recon_loss: 304380.9583; train_gene_expr_recon_loss: 659198.7500; train_masked_gp_l1_reg_loss: 10008.1196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43041.4674; train_chrom_access_recon_loss: 1289311.1389; train_global_loss: 2336296.3889; train_optim_loss: 2336296.3889; val_kl_reg_loss: 29762.5078; val_edge_recon_loss: 302868.1562; val_gene_expr_recon_loss: 649169.3750; val_masked_gp_l1_reg_loss: 10020.2256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41906.5781; val_chrom_access_recon_loss: 1283000.0000; val_global_loss: 2316726.7500; val_optim_loss: 2316726.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9259; val_auprc_score: 0.9075; val_best_acc_score: 0.8558; val_best_f1_score: 0.8631; train_kl_reg_loss: 30623.1901; train_edge_recon_loss: 301853.6042; train_gene_expr_recon_loss: 655060.9097; train_masked_gp_l1_reg_loss: 10026.1759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41056.1849; train_chrom_access_recon_loss: 1286824.8750; train_global_loss: 2325444.9167; train_optim_loss: 2325444.9167; val_kl_reg_loss: 29552.0234; val_edge_recon_loss: 302898.1875; val_gene_expr_recon_loss: 648086.1250; val_masked_gp_l1_reg_loss: 10028.5615; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40003.7578; val_chrom_access_recon_loss: 1283646.3750; val_global_loss: 2314215.0000; val_optim_loss: 2314215.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9327; val_auprc_score: 0.9149; val_best_acc_score: 0.8614; val_best_f1_score: 0.8681; train_kl_reg_loss: 27374.6413; train_edge_recon_loss: 305633.5174; train_gene_expr_recon_loss: 999616.0486; train_masked_gp_l1_reg_loss: 10164.9355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39022.4744; train_chrom_access_recon_loss: 1357526.4444; train_global_loss: 2739338.0833; train_optim_loss: 2739338.0833; val_kl_reg_loss: 17536.3633; val_edge_recon_loss: 301706.0000; val_gene_expr_recon_loss: 986822.5000; val_masked_gp_l1_reg_loss: 10423.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37700.9180; val_chrom_access_recon_loss: 1354696.6250; val_global_loss: 2708886.0000; val_optim_loss: 2708886.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9347; val_auprc_score: 0.9171; val_best_acc_score: 0.8631; val_best_f1_score: 0.8713; train_kl_reg_loss: 26297.6341; train_edge_recon_loss: 300035.1979; train_gene_expr_recon_loss: 994462.2986; train_masked_gp_l1_reg_loss: 10692.0812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36606.1063; train_chrom_access_recon_loss: 1359218.6806; train_global_loss: 2727311.9444; train_optim_loss: 2727311.9444; val_kl_reg_loss: 19230.9727; val_edge_recon_loss: 296922.4688; val_gene_expr_recon_loss: 981069.5000; val_masked_gp_l1_reg_loss: 11011.8799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35256.0586; val_chrom_access_recon_loss: 1351866.5000; val_global_loss: 2695357.5000; val_optim_loss: 2695357.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9378; val_auprc_score: 0.9183; val_best_acc_score: 0.8707; val_best_f1_score: 0.8746; train_kl_reg_loss: 25897.6053; train_edge_recon_loss: 296576.2292; train_gene_expr_recon_loss: 989573.7222; train_masked_gp_l1_reg_loss: 11234.5322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34226.4744; train_chrom_access_recon_loss: 1358518.1250; train_global_loss: 2716026.6389; train_optim_loss: 2716026.6389; val_kl_reg_loss: 20333.5898; val_edge_recon_loss: 294709.5000; val_gene_expr_recon_loss: 975439.3750; val_masked_gp_l1_reg_loss: 11491.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32975.0312; val_chrom_access_recon_loss: 1349754.6250; val_global_loss: 2684703.7500; val_optim_loss: 2684703.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9364; val_auprc_score: 0.9180; val_best_acc_score: 0.8654; val_best_f1_score: 0.8729; train_kl_reg_loss: 24958.7461; train_edge_recon_loss: 295854.2639; train_gene_expr_recon_loss: 981704.3681; train_masked_gp_l1_reg_loss: 11673.4883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32042.8370; train_chrom_access_recon_loss: 1352681.5833; train_global_loss: 2698915.3056; train_optim_loss: 2698915.3056; val_kl_reg_loss: 21117.5000; val_edge_recon_loss: 294738.0625; val_gene_expr_recon_loss: 970793.7500; val_masked_gp_l1_reg_loss: 11875.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30919.8945; val_chrom_access_recon_loss: 1347667.6250; val_global_loss: 2677112.7500; val_optim_loss: 2677112.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9404; val_auprc_score: 0.9272; val_best_acc_score: 0.8681; val_best_f1_score: 0.8763; train_kl_reg_loss: 24608.3370; train_edge_recon_loss: 294768.9201; train_gene_expr_recon_loss: 977357.6736; train_masked_gp_l1_reg_loss: 11821.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30749.8548; train_chrom_access_recon_loss: 1350877.6528; train_global_loss: 2690184.1944; train_optim_loss: 2690184.1944; val_kl_reg_loss: 21038.6797; val_edge_recon_loss: 292791.2500; val_gene_expr_recon_loss: 970355.1250; val_masked_gp_l1_reg_loss: 11776.0596; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30559.3457; val_chrom_access_recon_loss: 1347563.3750; val_global_loss: 2674083.7500; val_optim_loss: 2674083.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9418; val_auprc_score: 0.9236; val_best_acc_score: 0.8742; val_best_f1_score: 0.8817; train_kl_reg_loss: 24624.5790; train_edge_recon_loss: 294329.3403; train_gene_expr_recon_loss: 979400.8819; train_masked_gp_l1_reg_loss: 11770.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30443.8312; train_chrom_access_recon_loss: 1354083.1806; train_global_loss: 2694652.2778; train_optim_loss: 2694652.2778; val_kl_reg_loss: 21245.4727; val_edge_recon_loss: 293172.0000; val_gene_expr_recon_loss: 969788.1250; val_masked_gp_l1_reg_loss: 11758.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30294.9180; val_chrom_access_recon_loss: 1347305.1250; val_global_loss: 2673564.2500; val_optim_loss: 2673564.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9393; val_auprc_score: 0.9241; val_best_acc_score: 0.8712; val_best_f1_score: 0.8774; train_kl_reg_loss: 24659.2079; train_edge_recon_loss: 294671.8785; train_gene_expr_recon_loss: 983140.0278; train_masked_gp_l1_reg_loss: 11756.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30185.9674; train_chrom_access_recon_loss: 1354495.0000; train_global_loss: 2698908.2222; train_optim_loss: 2698908.2222; val_kl_reg_loss: 21218.1758; val_edge_recon_loss: 293951.1875; val_gene_expr_recon_loss: 969686.1250; val_masked_gp_l1_reg_loss: 11754.4717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30052.9844; val_chrom_access_recon_loss: 1347403.2500; val_global_loss: 2674066.2500; val_optim_loss: 2674066.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9395; val_auprc_score: 0.9265; val_best_acc_score: 0.8666; val_best_f1_score: 0.8752; train_kl_reg_loss: 24577.6797; train_edge_recon_loss: 294709.5417; train_gene_expr_recon_loss: 976176.6875; train_masked_gp_l1_reg_loss: 11757.1022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29951.8778; train_chrom_access_recon_loss: 1349212.3611; train_global_loss: 2686385.2778; train_optim_loss: 2686385.2778; val_kl_reg_loss: 21396.6172; val_edge_recon_loss: 295993.8125; val_gene_expr_recon_loss: 969170.2500; val_masked_gp_l1_reg_loss: 11761.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29830.7988; val_chrom_access_recon_loss: 1346924.5000; val_global_loss: 2675077.5000; val_optim_loss: 2675077.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9279
val AUPRC score: 0.9085
val best accuracy score: 0.8549
val best F1 score: 0.8618
val target rna MSE score: 3.7404
val source rna MSE score: 3.1406
val target atac MSE score: 0.1313
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
