[True]
Run timestamp: 10102023_111113_245.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_245']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7736; val_auprc_score: 0.7987; val_best_acc_score: 0.5330; val_best_f1_score: 0.6799; train_kl_reg_loss: 66388.3913; train_edge_recon_loss: 753311.7667; train_gene_expr_recon_loss: 22303075.8015; train_masked_gp_l1_reg_loss: 44902.5896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3005540.5296; train_chrom_access_recon_loss: 11176717.1527; train_global_loss: 37349935.9389; train_optim_loss: 37349935.9389; val_kl_reg_loss: 58866.3948; val_edge_recon_loss: 812662.5083; val_gene_expr_recon_loss: 21292330.0000; val_masked_gp_l1_reg_loss: 52236.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1203682.3750; val_chrom_access_recon_loss: 10954069.5333; val_global_loss: 34373846.8000; val_optim_loss: 34373846.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7993; val_auprc_score: 0.8190; val_best_acc_score: 0.6458; val_best_f1_score: 0.7237; train_kl_reg_loss: 66558.2516; train_edge_recon_loss: 734495.4618; train_gene_expr_recon_loss: 20964582.5344; train_masked_gp_l1_reg_loss: 52522.7921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 660600.8504; train_chrom_access_recon_loss: 10784671.2137; train_global_loss: 33263431.1145; train_optim_loss: 33263431.1145; val_kl_reg_loss: 61755.6815; val_edge_recon_loss: 810723.7417; val_gene_expr_recon_loss: 20859644.5333; val_masked_gp_l1_reg_loss: 52698.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 367923.4062; val_chrom_access_recon_loss: 10809086.0000; val_global_loss: 32961832.1333; val_optim_loss: 32961832.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8808; val_auprc_score: 0.8803; val_best_acc_score: 0.7771; val_best_f1_score: 0.7609; train_kl_reg_loss: 60360.1047; train_edge_recon_loss: 723903.7944; train_gene_expr_recon_loss: 20648136.0916; train_masked_gp_l1_reg_loss: 53834.6242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 265163.5317; train_chrom_access_recon_loss: 10660459.8473; train_global_loss: 32411857.8626; train_optim_loss: 32411857.8626; val_kl_reg_loss: 56494.4951; val_edge_recon_loss: 797360.9292; val_gene_expr_recon_loss: 20543370.9333; val_masked_gp_l1_reg_loss: 54776.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203907.7812; val_chrom_access_recon_loss: 10689660.5333; val_global_loss: 32345570.9333; val_optim_loss: 32345570.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8926; val_auprc_score: 0.8846; val_best_acc_score: 0.8042; val_best_f1_score: 0.8191; train_kl_reg_loss: 54159.6435; train_edge_recon_loss: 699896.5134; train_gene_expr_recon_loss: 20365284.9008; train_masked_gp_l1_reg_loss: 55985.7035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180663.1690; train_chrom_access_recon_loss: 10533588.7939; train_global_loss: 31889578.6412; train_optim_loss: 31889578.6412; val_kl_reg_loss: 59707.1669; val_edge_recon_loss: 662680.6375; val_gene_expr_recon_loss: 20326820.5333; val_masked_gp_l1_reg_loss: 57466.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162816.9375; val_chrom_access_recon_loss: 10598939.5333; val_global_loss: 31868429.6000; val_optim_loss: 31868429.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9090; val_auprc_score: 0.8997; val_best_acc_score: 0.8242; val_best_f1_score: 0.8373; train_kl_reg_loss: 64933.6394; train_edge_recon_loss: 632154.9427; train_gene_expr_recon_loss: 20163560.3511; train_masked_gp_l1_reg_loss: 58799.0053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147219.9425; train_chrom_access_recon_loss: 10447762.8626; train_global_loss: 31514430.8855; train_optim_loss: 31514430.8855; val_kl_reg_loss: 65619.0286; val_edge_recon_loss: 623957.3750; val_gene_expr_recon_loss: 20148731.0667; val_masked_gp_l1_reg_loss: 59966.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134773.1250; val_chrom_access_recon_loss: 10546606.3333; val_global_loss: 31579654.0000; val_optim_loss: 31579654.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9120; val_auprc_score: 0.9026; val_best_acc_score: 0.8297; val_best_f1_score: 0.8399; train_kl_reg_loss: 64875.8394; train_edge_recon_loss: 615972.6947; train_gene_expr_recon_loss: 19985966.2137; train_masked_gp_l1_reg_loss: 60937.4482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126030.4400; train_chrom_access_recon_loss: 10360869.5191; train_global_loss: 31214652.1527; train_optim_loss: 31214652.1527; val_kl_reg_loss: 64814.4055; val_edge_recon_loss: 615244.8167; val_gene_expr_recon_loss: 19928379.4667; val_masked_gp_l1_reg_loss: 61766.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118864.9453; val_chrom_access_recon_loss: 10433132.2667; val_global_loss: 31222201.2000; val_optim_loss: 31222201.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9221; val_auprc_score: 0.9058; val_best_acc_score: 0.8475; val_best_f1_score: 0.8569; train_kl_reg_loss: 62940.8079; train_edge_recon_loss: 608350.0873; train_gene_expr_recon_loss: 19839252.0458; train_masked_gp_l1_reg_loss: 62500.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113802.4531; train_chrom_access_recon_loss: 10293560.1985; train_global_loss: 30980406.2901; train_optim_loss: 30980406.2901; val_kl_reg_loss: 61784.5539; val_edge_recon_loss: 605259.5750; val_gene_expr_recon_loss: 19822266.5333; val_masked_gp_l1_reg_loss: 63238.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110292.9766; val_chrom_access_recon_loss: 10344655.2667; val_global_loss: 31007496.1333; val_optim_loss: 31007496.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9271; val_auprc_score: 0.9152; val_best_acc_score: 0.8544; val_best_f1_score: 0.8622; train_kl_reg_loss: 61545.4514; train_edge_recon_loss: 603141.3583; train_gene_expr_recon_loss: 19716701.6031; train_masked_gp_l1_reg_loss: 63770.2932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106686.6036; train_chrom_access_recon_loss: 10228821.9160; train_global_loss: 30780667.1908; train_optim_loss: 30780667.1908; val_kl_reg_loss: 60406.5388; val_edge_recon_loss: 605608.5958; val_gene_expr_recon_loss: 19724260.5333; val_masked_gp_l1_reg_loss: 64399.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105243.1016; val_chrom_access_recon_loss: 10291156.6667; val_global_loss: 30851076.1333; val_optim_loss: 30851076.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9414; val_auprc_score: 0.9300; val_best_acc_score: 0.8676; val_best_f1_score: 0.8758; train_kl_reg_loss: 60162.8146; train_edge_recon_loss: 598758.4876; train_gene_expr_recon_loss: 19621324.4275; train_masked_gp_l1_reg_loss: 64848.5203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102393.3808; train_chrom_access_recon_loss: 10183787.1450; train_global_loss: 30631274.7939; train_optim_loss: 30631274.7939; val_kl_reg_loss: 60218.1826; val_edge_recon_loss: 599875.4917; val_gene_expr_recon_loss: 19514467.3333; val_masked_gp_l1_reg_loss: 65196.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100423.9531; val_chrom_access_recon_loss: 10237282.1333; val_global_loss: 30577462.9333; val_optim_loss: 30577462.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9441; val_auprc_score: 0.9339; val_best_acc_score: 0.8758; val_best_f1_score: 0.8809; train_kl_reg_loss: 59173.4605; train_edge_recon_loss: 593155.7219; train_gene_expr_recon_loss: 19517563.3893; train_masked_gp_l1_reg_loss: 65631.4646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99164.0938; train_chrom_access_recon_loss: 10127218.1908; train_global_loss: 30461906.3664; train_optim_loss: 30461906.3664; val_kl_reg_loss: 58225.4948; val_edge_recon_loss: 593809.6417; val_gene_expr_recon_loss: 19420432.1333; val_masked_gp_l1_reg_loss: 66010.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97543.0469; val_chrom_access_recon_loss: 10202392.8667; val_global_loss: 30438414.2667; val_optim_loss: 30438414.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9563; val_auprc_score: 0.9490; val_best_acc_score: 0.8913; val_best_f1_score: 0.8964; train_kl_reg_loss: 58510.8435; train_edge_recon_loss: 589498.9504; train_gene_expr_recon_loss: 19433724.1832; train_masked_gp_l1_reg_loss: 66331.3454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96233.9324; train_chrom_access_recon_loss: 10083616.1756; train_global_loss: 30327915.5420; train_optim_loss: 30327915.5420; val_kl_reg_loss: 57441.2195; val_edge_recon_loss: 586237.7708; val_gene_expr_recon_loss: 19439904.9333; val_masked_gp_l1_reg_loss: 66880.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96080.2734; val_chrom_access_recon_loss: 10152493.8667; val_global_loss: 30399037.4667; val_optim_loss: 30399037.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9568; val_auprc_score: 0.9497; val_best_acc_score: 0.8942; val_best_f1_score: 0.8984; train_kl_reg_loss: 57235.4987; train_edge_recon_loss: 587170.5210; train_gene_expr_recon_loss: 19351176.0611; train_masked_gp_l1_reg_loss: 67059.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94145.2453; train_chrom_access_recon_loss: 10027384.6260; train_global_loss: 30184171.2977; train_optim_loss: 30184171.2977; val_kl_reg_loss: 56851.3727; val_edge_recon_loss: 587325.8417; val_gene_expr_recon_loss: 19304771.3333; val_masked_gp_l1_reg_loss: 67410.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93965.9844; val_chrom_access_recon_loss: 10058621.6000; val_global_loss: 30168946.2667; val_optim_loss: 30168946.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9588; val_auprc_score: 0.9480; val_best_acc_score: 0.8994; val_best_f1_score: 0.9029; train_kl_reg_loss: 56533.5328; train_edge_recon_loss: 584072.6842; train_gene_expr_recon_loss: 19276980.8244; train_masked_gp_l1_reg_loss: 67813.7991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92519.0775; train_chrom_access_recon_loss: 9976698.4885; train_global_loss: 30054618.3206; train_optim_loss: 30054618.3206; val_kl_reg_loss: 57185.5544; val_edge_recon_loss: 588471.3417; val_gene_expr_recon_loss: 19246816.9333; val_masked_gp_l1_reg_loss: 68012.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91393.6797; val_chrom_access_recon_loss: 10086933.9333; val_global_loss: 30138813.6000; val_optim_loss: 30138813.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9628; val_auprc_score: 0.9535; val_best_acc_score: 0.9045; val_best_f1_score: 0.9077; train_kl_reg_loss: 56010.6840; train_edge_recon_loss: 581679.4318; train_gene_expr_recon_loss: 19199827.9084; train_masked_gp_l1_reg_loss: 68369.7617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90739.1803; train_chrom_access_recon_loss: 9938270.5115; train_global_loss: 29934897.4198; train_optim_loss: 29934897.4198; val_kl_reg_loss: 55892.9578; val_edge_recon_loss: 581634.2292; val_gene_expr_recon_loss: 19186171.3333; val_masked_gp_l1_reg_loss: 68699.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90088.2266; val_chrom_access_recon_loss: 10020098.9333; val_global_loss: 30002585.2000; val_optim_loss: 30002585.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9675; val_auprc_score: 0.9596; val_best_acc_score: 0.9131; val_best_f1_score: 0.9149; train_kl_reg_loss: 55320.4425; train_edge_recon_loss: 580855.2696; train_gene_expr_recon_loss: 19128332.1527; train_masked_gp_l1_reg_loss: 68908.1157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89603.8900; train_chrom_access_recon_loss: 9892657.8168; train_global_loss: 29815677.7252; train_optim_loss: 29815677.7252; val_kl_reg_loss: 55361.1818; val_edge_recon_loss: 581082.5167; val_gene_expr_recon_loss: 19064060.0000; val_masked_gp_l1_reg_loss: 69221.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89456.7109; val_chrom_access_recon_loss: 9933185.3333; val_global_loss: 29792366.9333; val_optim_loss: 29792366.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9672; val_auprc_score: 0.9587; val_best_acc_score: 0.9140; val_best_f1_score: 0.9168; train_kl_reg_loss: 54642.3716; train_edge_recon_loss: 578725.4552; train_gene_expr_recon_loss: 19102642.8397; train_masked_gp_l1_reg_loss: 69409.7984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88571.9977; train_chrom_access_recon_loss: 9868536.6718; train_global_loss: 29762529.0382; train_optim_loss: 29762529.0382; val_kl_reg_loss: 54903.9964; val_edge_recon_loss: 578537.6625; val_gene_expr_recon_loss: 19174862.1333; val_masked_gp_l1_reg_loss: 69715.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89209.0859; val_chrom_access_recon_loss: 9971217.8000; val_global_loss: 29938447.7333; val_optim_loss: 29938447.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9671; val_auprc_score: 0.9582; val_best_acc_score: 0.9131; val_best_f1_score: 0.9170; train_kl_reg_loss: 54208.9109; train_edge_recon_loss: 577166.1517; train_gene_expr_recon_loss: 19026745.7252; train_masked_gp_l1_reg_loss: 69893.4299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87954.5329; train_chrom_access_recon_loss: 9812792.6947; train_global_loss: 29628761.5115; train_optim_loss: 29628761.5115; val_kl_reg_loss: 51835.0482; val_edge_recon_loss: 580503.2708; val_gene_expr_recon_loss: 19055349.3333; val_masked_gp_l1_reg_loss: 70097.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87629.4609; val_chrom_access_recon_loss: 9894933.3333; val_global_loss: 29740349.0667; val_optim_loss: 29740349.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9686; val_auprc_score: 0.9592; val_best_acc_score: 0.9181; val_best_f1_score: 0.9205; train_kl_reg_loss: 53572.7032; train_edge_recon_loss: 576807.5611; train_gene_expr_recon_loss: 18994542.7481; train_masked_gp_l1_reg_loss: 70402.3633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87227.3042; train_chrom_access_recon_loss: 9789943.1756; train_global_loss: 29572495.7557; train_optim_loss: 29572495.7557; val_kl_reg_loss: 54291.4635; val_edge_recon_loss: 577138.0250; val_gene_expr_recon_loss: 18950173.3333; val_masked_gp_l1_reg_loss: 70603.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87984.2109; val_chrom_access_recon_loss: 9852183.4000; val_global_loss: 29592374.0000; val_optim_loss: 29592374.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9710; val_auprc_score: 0.9635; val_best_acc_score: 0.9220; val_best_f1_score: 0.9243; train_kl_reg_loss: 53246.9997; train_edge_recon_loss: 575146.0668; train_gene_expr_recon_loss: 18957618.1679; train_masked_gp_l1_reg_loss: 70849.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87184.6819; train_chrom_access_recon_loss: 9765270.0534; train_global_loss: 29509315.4962; train_optim_loss: 29509315.4962; val_kl_reg_loss: 52657.9016; val_edge_recon_loss: 576420.2208; val_gene_expr_recon_loss: 18928650.8000; val_masked_gp_l1_reg_loss: 71179.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87023.6406; val_chrom_access_recon_loss: 9864902.2667; val_global_loss: 29580835.2000; val_optim_loss: 29580835.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9701; val_auprc_score: 0.9626; val_best_acc_score: 0.9212; val_best_f1_score: 0.9229; train_kl_reg_loss: 52715.9396; train_edge_recon_loss: 573954.4919; train_gene_expr_recon_loss: 18918129.7557; train_masked_gp_l1_reg_loss: 71421.8923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87227.8263; train_chrom_access_recon_loss: 9729839.4809; train_global_loss: 29433289.3893; train_optim_loss: 29433289.3893; val_kl_reg_loss: 52178.1646; val_edge_recon_loss: 576059.7417; val_gene_expr_recon_loss: 18898180.8000; val_masked_gp_l1_reg_loss: 71625.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86673.6641; val_chrom_access_recon_loss: 9837113.9333; val_global_loss: 29521832.4000; val_optim_loss: 29521832.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9700; val_auprc_score: 0.9628; val_best_acc_score: 0.9227; val_best_f1_score: 0.9251; train_kl_reg_loss: 52443.3564; train_edge_recon_loss: 573964.0391; train_gene_expr_recon_loss: 18874693.0687; train_masked_gp_l1_reg_loss: 71904.6718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86957.3665; train_chrom_access_recon_loss: 9700942.4962; train_global_loss: 29360905.0076; train_optim_loss: 29360905.0076; val_kl_reg_loss: 53578.3607; val_edge_recon_loss: 575774.1208; val_gene_expr_recon_loss: 18897527.0667; val_masked_gp_l1_reg_loss: 72043.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86984.4688; val_chrom_access_recon_loss: 9789142.4000; val_global_loss: 29475049.8667; val_optim_loss: 29475049.8667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9720; val_auprc_score: 0.9646; val_best_acc_score: 0.9241; val_best_f1_score: 0.9269; train_kl_reg_loss: 52100.0290; train_edge_recon_loss: 573172.8750; train_gene_expr_recon_loss: 18836041.3435; train_masked_gp_l1_reg_loss: 72342.7382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87271.0482; train_chrom_access_recon_loss: 9665809.9160; train_global_loss: 29286737.9237; train_optim_loss: 29286737.9237; val_kl_reg_loss: 51963.9193; val_edge_recon_loss: 571487.7500; val_gene_expr_recon_loss: 18786168.0000; val_masked_gp_l1_reg_loss: 72654.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87806.5781; val_chrom_access_recon_loss: 9729521.2667; val_global_loss: 29299600.6667; val_optim_loss: 29299600.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9693; val_auprc_score: 0.9636; val_best_acc_score: 0.9158; val_best_f1_score: 0.9190; train_kl_reg_loss: 51856.6910; train_edge_recon_loss: 571480.8101; train_gene_expr_recon_loss: 18795976.4580; train_masked_gp_l1_reg_loss: 72869.5750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87484.4655; train_chrom_access_recon_loss: 9639130.6107; train_global_loss: 29218798.7023; train_optim_loss: 29218798.7023; val_kl_reg_loss: 52411.2352; val_edge_recon_loss: 575649.2333; val_gene_expr_recon_loss: 18864870.0000; val_masked_gp_l1_reg_loss: 73176.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86906.8203; val_chrom_access_recon_loss: 9821843.4667; val_global_loss: 29474855.4667; val_optim_loss: 29474855.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9727; val_auprc_score: 0.9667; val_best_acc_score: 0.9221; val_best_f1_score: 0.9254; train_kl_reg_loss: 51470.6140; train_edge_recon_loss: 573312.1899; train_gene_expr_recon_loss: 18769336.1374; train_masked_gp_l1_reg_loss: 73367.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87391.3808; train_chrom_access_recon_loss: 9601906.3206; train_global_loss: 29156784.1832; train_optim_loss: 29156784.1832; val_kl_reg_loss: 51972.0909; val_edge_recon_loss: 574553.5500; val_gene_expr_recon_loss: 18845876.1333; val_masked_gp_l1_reg_loss: 73569.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88514.6875; val_chrom_access_recon_loss: 9733540.2667; val_global_loss: 29368026.1333; val_optim_loss: 29368026.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9699; val_auprc_score: 0.9625; val_best_acc_score: 0.9194; val_best_f1_score: 0.9221; train_kl_reg_loss: 51009.4298; train_edge_recon_loss: 572704.1202; train_gene_expr_recon_loss: 18723149.0687; train_masked_gp_l1_reg_loss: 73805.4181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88126.1133; train_chrom_access_recon_loss: 9576676.8359; train_global_loss: 29085470.7786; train_optim_loss: 29085470.7786; val_kl_reg_loss: 51695.4167; val_edge_recon_loss: 576379.4917; val_gene_expr_recon_loss: 18785628.4000; val_masked_gp_l1_reg_loss: 74036.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87916.8281; val_chrom_access_recon_loss: 9747273.0000; val_global_loss: 29322928.4000; val_optim_loss: 29322928.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8733; val_auprc_score: 0.8696; val_best_acc_score: 0.7858; val_best_f1_score: 0.7990; train_kl_reg_loss: 24135.4872; train_edge_recon_loss: 732035.1088; train_gene_expr_recon_loss: 17510264.4504; train_masked_gp_l1_reg_loss: 74581.7415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88411.1927; train_chrom_access_recon_loss: 8996098.0229; train_global_loss: 27425525.9389; train_optim_loss: 27425525.9389; val_kl_reg_loss: 5080.6161; val_edge_recon_loss: 773398.1417; val_gene_expr_recon_loss: 17475310.0000; val_masked_gp_l1_reg_loss: 75582.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97964.6875; val_chrom_access_recon_loss: 9041832.0000; val_global_loss: 27469166.9333; val_optim_loss: 27469166.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8983; val_auprc_score: 0.8826; val_best_acc_score: 0.8223; val_best_f1_score: 0.8392; train_kl_reg_loss: 16254.0084; train_edge_recon_loss: 741600.0840; train_gene_expr_recon_loss: 17396870.5954; train_masked_gp_l1_reg_loss: 74315.9419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95900.6317; train_chrom_access_recon_loss: 8930104.5305; train_global_loss: 27255045.8015; train_optim_loss: 27255045.8015; val_kl_reg_loss: 9417.5585; val_edge_recon_loss: 726865.7083; val_gene_expr_recon_loss: 17298020.8000; val_masked_gp_l1_reg_loss: 71627.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91019.2109; val_chrom_access_recon_loss: 8899117.9000; val_global_loss: 27096070.0000; val_optim_loss: 27096070.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8914; val_auprc_score: 0.8751; val_best_acc_score: 0.8129; val_best_f1_score: 0.8246; train_kl_reg_loss: 17804.1031; train_edge_recon_loss: 703456.3263; train_gene_expr_recon_loss: 17269525.2595; train_masked_gp_l1_reg_loss: 69645.5283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90296.6480; train_chrom_access_recon_loss: 8875495.4427; train_global_loss: 27026223.1450; train_optim_loss: 27026223.1450; val_kl_reg_loss: 7426.0565; val_edge_recon_loss: 716037.0792; val_gene_expr_recon_loss: 17334973.6667; val_masked_gp_l1_reg_loss: 68233.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90245.5547; val_chrom_access_recon_loss: 8956552.2000; val_global_loss: 27173468.9333; val_optim_loss: 27173468.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8871; val_auprc_score: 0.8747; val_best_acc_score: 0.8011; val_best_f1_score: 0.8157; train_kl_reg_loss: 16167.2427; train_edge_recon_loss: 686896.8149; train_gene_expr_recon_loss: 17147181.6412; train_masked_gp_l1_reg_loss: 66974.8734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90807.0781; train_chrom_access_recon_loss: 8849965.3130; train_global_loss: 26857993.0992; train_optim_loss: 26857993.0992; val_kl_reg_loss: 9929.7393; val_edge_recon_loss: 688795.8542; val_gene_expr_recon_loss: 17119181.4667; val_masked_gp_l1_reg_loss: 65953.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92439.5703; val_chrom_access_recon_loss: 8902384.1333; val_global_loss: 26878685.4667; val_optim_loss: 26878685.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8875; val_auprc_score: 0.8743; val_best_acc_score: 0.8009; val_best_f1_score: 0.8199; train_kl_reg_loss: 17111.5829; train_edge_recon_loss: 668481.5768; train_gene_expr_recon_loss: 17092754.5267; train_masked_gp_l1_reg_loss: 65157.8514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91405.8756; train_chrom_access_recon_loss: 8839974.6336; train_global_loss: 26774886.2137; train_optim_loss: 26774886.2137; val_kl_reg_loss: 10900.8701; val_edge_recon_loss: 650511.9042; val_gene_expr_recon_loss: 17096735.6667; val_masked_gp_l1_reg_loss: 64495.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90739.6172; val_chrom_access_recon_loss: 8910200.3333; val_global_loss: 26823585.2000; val_optim_loss: 26823585.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8895; val_auprc_score: 0.8790; val_best_acc_score: 0.8011; val_best_f1_score: 0.8206; train_kl_reg_loss: 18794.7521; train_edge_recon_loss: 646344.7939; train_gene_expr_recon_loss: 17019100.8626; train_masked_gp_l1_reg_loss: 63790.5082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89922.2067; train_chrom_access_recon_loss: 8817958.3053; train_global_loss: 26655911.4809; train_optim_loss: 26655911.4809; val_kl_reg_loss: 12206.3514; val_edge_recon_loss: 642792.5542; val_gene_expr_recon_loss: 17035734.4000; val_masked_gp_l1_reg_loss: 62947.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88493.0234; val_chrom_access_recon_loss: 8851835.2667; val_global_loss: 26694010.6667; val_optim_loss: 26694010.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8832; val_auprc_score: 0.8709; val_best_acc_score: 0.7906; val_best_f1_score: 0.8177; train_kl_reg_loss: 20366.7633; train_edge_recon_loss: 628333.3683; train_gene_expr_recon_loss: 16993460.5954; train_masked_gp_l1_reg_loss: 62064.6287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87048.8491; train_chrom_access_recon_loss: 8804844.6870; train_global_loss: 26596118.8244; train_optim_loss: 26596118.8244; val_kl_reg_loss: 16998.6814; val_edge_recon_loss: 625010.0625; val_gene_expr_recon_loss: 16956816.8000; val_masked_gp_l1_reg_loss: 61112.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85453.3594; val_chrom_access_recon_loss: 8852888.2000; val_global_loss: 26598279.3333; val_optim_loss: 26598279.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8892; val_auprc_score: 0.8780; val_best_acc_score: 0.7982; val_best_f1_score: 0.8179; train_kl_reg_loss: 21494.3569; train_edge_recon_loss: 620661.9843; train_gene_expr_recon_loss: 16958739.3817; train_masked_gp_l1_reg_loss: 60365.5959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84332.9679; train_chrom_access_recon_loss: 8765784.1756; train_global_loss: 26511378.6412; train_optim_loss: 26511378.6412; val_kl_reg_loss: 14461.7249; val_edge_recon_loss: 631677.1625; val_gene_expr_recon_loss: 16897301.0000; val_masked_gp_l1_reg_loss: 59963.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85041.2422; val_chrom_access_recon_loss: 8817802.2000; val_global_loss: 26506248.2667; val_optim_loss: 26506248.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8886; val_auprc_score: 0.8739; val_best_acc_score: 0.8009; val_best_f1_score: 0.8256; train_kl_reg_loss: 20861.0247; train_edge_recon_loss: 623106.7395; train_gene_expr_recon_loss: 16926113.7557; train_masked_gp_l1_reg_loss: 59188.2755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84227.7271; train_chrom_access_recon_loss: 8757423.6450; train_global_loss: 26470921.1450; train_optim_loss: 26470921.1450; val_kl_reg_loss: 16899.4590; val_edge_recon_loss: 617998.8750; val_gene_expr_recon_loss: 16925636.0667; val_masked_gp_l1_reg_loss: 58497.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83125.8203; val_chrom_access_recon_loss: 8814327.7333; val_global_loss: 26516486.2667; val_optim_loss: 26516486.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8903; val_auprc_score: 0.8803; val_best_acc_score: 0.8003; val_best_f1_score: 0.8233; train_kl_reg_loss: 22438.8732; train_edge_recon_loss: 612485.2204; train_gene_expr_recon_loss: 16913672.9771; train_masked_gp_l1_reg_loss: 57905.9758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82193.2536; train_chrom_access_recon_loss: 8743673.9389; train_global_loss: 26432370.1679; train_optim_loss: 26432370.1679; val_kl_reg_loss: 18136.3721; val_edge_recon_loss: 614455.7375; val_gene_expr_recon_loss: 16869526.2000; val_masked_gp_l1_reg_loss: 57381.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81570.3203; val_chrom_access_recon_loss: 8803056.1000; val_global_loss: 26444126.4000; val_optim_loss: 26444126.4000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8947; val_auprc_score: 0.8864; val_best_acc_score: 0.7983; val_best_f1_score: 0.8254; train_kl_reg_loss: 24061.9638; train_edge_recon_loss: 606106.5897; train_gene_expr_recon_loss: 16879329.5649; train_masked_gp_l1_reg_loss: 56932.2999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80470.4105; train_chrom_access_recon_loss: 8733281.2481; train_global_loss: 26380182.0458; train_optim_loss: 26380182.0458; val_kl_reg_loss: 22063.8574; val_edge_recon_loss: 603972.9208; val_gene_expr_recon_loss: 16901996.4000; val_masked_gp_l1_reg_loss: 56470.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79390.3203; val_chrom_access_recon_loss: 8801389.8000; val_global_loss: 26465282.6667; val_optim_loss: 26465282.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8929; val_auprc_score: 0.8810; val_best_acc_score: 0.8072; val_best_f1_score: 0.8308; train_kl_reg_loss: 26493.2807; train_edge_recon_loss: 599098.8383; train_gene_expr_recon_loss: 16871766.0000; train_masked_gp_l1_reg_loss: 55990.4287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78655.7165; train_chrom_access_recon_loss: 8728658.1794; train_global_loss: 26360662.4580; train_optim_loss: 26360662.4580; val_kl_reg_loss: 24476.5342; val_edge_recon_loss: 598509.6875; val_gene_expr_recon_loss: 16853687.5333; val_masked_gp_l1_reg_loss: 55504.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78382.7812; val_chrom_access_recon_loss: 8809859.6667; val_global_loss: 26420419.3333; val_optim_loss: 26420419.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9024; val_auprc_score: 0.8906; val_best_acc_score: 0.8200; val_best_f1_score: 0.8404; train_kl_reg_loss: 27926.5580; train_edge_recon_loss: 594010.5205; train_gene_expr_recon_loss: 16866408.6794; train_masked_gp_l1_reg_loss: 55120.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77480.1977; train_chrom_access_recon_loss: 8736131.0840; train_global_loss: 26357076.9160; train_optim_loss: 26357076.9160; val_kl_reg_loss: 25447.5918; val_edge_recon_loss: 589080.4833; val_gene_expr_recon_loss: 16888070.7333; val_masked_gp_l1_reg_loss: 54809.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76633.3047; val_chrom_access_recon_loss: 8774741.3667; val_global_loss: 26408784.4000; val_optim_loss: 26408784.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8943; val_auprc_score: 0.8791; val_best_acc_score: 0.8100; val_best_f1_score: 0.8340; train_kl_reg_loss: 28626.6875; train_edge_recon_loss: 590399.1202; train_gene_expr_recon_loss: 16839930.6794; train_masked_gp_l1_reg_loss: 54422.0253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76366.6598; train_chrom_access_recon_loss: 8730126.3626; train_global_loss: 26319871.6947; train_optim_loss: 26319871.6947; val_kl_reg_loss: 26858.7263; val_edge_recon_loss: 592880.3542; val_gene_expr_recon_loss: 16854797.3333; val_masked_gp_l1_reg_loss: 54076.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75700.3047; val_chrom_access_recon_loss: 8788334.6667; val_global_loss: 26392647.3333; val_optim_loss: 26392647.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8969; val_auprc_score: 0.8799; val_best_acc_score: 0.8155; val_best_f1_score: 0.8370; train_kl_reg_loss: 29445.7282; train_edge_recon_loss: 587198.0262; train_gene_expr_recon_loss: 16826366.6870; train_masked_gp_l1_reg_loss: 53708.7482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75316.0695; train_chrom_access_recon_loss: 8717059.0115; train_global_loss: 26289094.0153; train_optim_loss: 26289094.0153; val_kl_reg_loss: 27655.5603; val_edge_recon_loss: 588022.6125; val_gene_expr_recon_loss: 16787412.4667; val_masked_gp_l1_reg_loss: 53343.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75164.3672; val_chrom_access_recon_loss: 8760773.6000; val_global_loss: 26292372.4000; val_optim_loss: 26292372.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8995; val_auprc_score: 0.8801; val_best_acc_score: 0.8209; val_best_f1_score: 0.8400; train_kl_reg_loss: 29689.7026; train_edge_recon_loss: 585718.8082; train_gene_expr_recon_loss: 16800454.7481; train_masked_gp_l1_reg_loss: 53119.4425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74582.4560; train_chrom_access_recon_loss: 8713151.7786; train_global_loss: 26256716.9618; train_optim_loss: 26256716.9618; val_kl_reg_loss: 28033.2632; val_edge_recon_loss: 583838.5708; val_gene_expr_recon_loss: 16829588.4667; val_masked_gp_l1_reg_loss: 52911.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74222.4219; val_chrom_access_recon_loss: 8799296.9000; val_global_loss: 26367891.3333; val_optim_loss: 26367891.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9036; val_auprc_score: 0.8877; val_best_acc_score: 0.8180; val_best_f1_score: 0.8352; train_kl_reg_loss: 30301.7716; train_edge_recon_loss: 581556.3426; train_gene_expr_recon_loss: 16823968.4656; train_masked_gp_l1_reg_loss: 52733.0641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73775.6257; train_chrom_access_recon_loss: 8714364.8702; train_global_loss: 26276700.0458; train_optim_loss: 26276700.0458; val_kl_reg_loss: 29146.8686; val_edge_recon_loss: 588310.0833; val_gene_expr_recon_loss: 16811163.6000; val_masked_gp_l1_reg_loss: 52542.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74090.0312; val_chrom_access_recon_loss: 8777113.8000; val_global_loss: 26332366.1333; val_optim_loss: 26332366.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9067; val_auprc_score: 0.8859; val_best_acc_score: 0.8319; val_best_f1_score: 0.8441; train_kl_reg_loss: 30536.7188; train_edge_recon_loss: 579248.4823; train_gene_expr_recon_loss: 16789516.0000; train_masked_gp_l1_reg_loss: 52300.9890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73562.5696; train_chrom_access_recon_loss: 8689647.6336; train_global_loss: 26214812.5496; train_optim_loss: 26214812.5496; val_kl_reg_loss: 29371.1309; val_edge_recon_loss: 578174.4042; val_gene_expr_recon_loss: 16750901.8000; val_masked_gp_l1_reg_loss: 52155.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72967.0234; val_chrom_access_recon_loss: 8739261.9333; val_global_loss: 26222833.4667; val_optim_loss: 26222833.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9100; val_auprc_score: 0.8950; val_best_acc_score: 0.8293; val_best_f1_score: 0.8462; train_kl_reg_loss: 31127.2415; train_edge_recon_loss: 577612.3526; train_gene_expr_recon_loss: 16769781.4351; train_masked_gp_l1_reg_loss: 51982.0915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72752.9461; train_chrom_access_recon_loss: 8687417.5573; train_global_loss: 26190673.6183; train_optim_loss: 26190673.6183; val_kl_reg_loss: 30965.6355; val_edge_recon_loss: 578883.4500; val_gene_expr_recon_loss: 16799535.4000; val_masked_gp_l1_reg_loss: 51842.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72664.8906; val_chrom_access_recon_loss: 8802580.0667; val_global_loss: 26336470.8000; val_optim_loss: 26336470.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9153; val_auprc_score: 0.8974; val_best_acc_score: 0.8308; val_best_f1_score: 0.8462; train_kl_reg_loss: 31528.4411; train_edge_recon_loss: 578083.6365; train_gene_expr_recon_loss: 16771380.8702; train_masked_gp_l1_reg_loss: 51672.6242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72499.0836; train_chrom_access_recon_loss: 8687137.6718; train_global_loss: 26192302.2595; train_optim_loss: 26192302.2595; val_kl_reg_loss: 29379.5115; val_edge_recon_loss: 577608.9750; val_gene_expr_recon_loss: 16792071.3333; val_masked_gp_l1_reg_loss: 51555.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72239.5469; val_chrom_access_recon_loss: 8753775.9333; val_global_loss: 26276631.6000; val_optim_loss: 26276631.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9111; val_auprc_score: 0.8934; val_best_acc_score: 0.8355; val_best_f1_score: 0.8488; train_kl_reg_loss: 31581.2371; train_edge_recon_loss: 578057.9704; train_gene_expr_recon_loss: 16783464.9008; train_masked_gp_l1_reg_loss: 51493.1247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72113.1333; train_chrom_access_recon_loss: 8689161.0573; train_global_loss: 26205871.3740; train_optim_loss: 26205871.3740; val_kl_reg_loss: 29671.0264; val_edge_recon_loss: 582716.3833; val_gene_expr_recon_loss: 16828985.3333; val_masked_gp_l1_reg_loss: 51463.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71852.2031; val_chrom_access_recon_loss: 8762998.0000; val_global_loss: 26327686.6667; val_optim_loss: 26327686.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9102; val_auprc_score: 0.8879; val_best_acc_score: 0.8364; val_best_f1_score: 0.8519; train_kl_reg_loss: 31885.4388; train_edge_recon_loss: 576964.6035; train_gene_expr_recon_loss: 16754193.7710; train_masked_gp_l1_reg_loss: 51305.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71776.6839; train_chrom_access_recon_loss: 8678290.3244; train_global_loss: 26164416.1679; train_optim_loss: 26164416.1679; val_kl_reg_loss: 31069.2409; val_edge_recon_loss: 575681.5750; val_gene_expr_recon_loss: 16817361.6667; val_masked_gp_l1_reg_loss: 51307.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71594.6016; val_chrom_access_recon_loss: 8797111.8000; val_global_loss: 26344126.5333; val_optim_loss: 26344126.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9198; val_auprc_score: 0.9047; val_best_acc_score: 0.8413; val_best_f1_score: 0.8537; train_kl_reg_loss: 32174.1741; train_edge_recon_loss: 575281.2228; train_gene_expr_recon_loss: 16732080.2061; train_masked_gp_l1_reg_loss: 50892.3841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60865.9803; train_chrom_access_recon_loss: 8670432.2137; train_global_loss: 26121726.1221; train_optim_loss: 26121726.1221; val_kl_reg_loss: 30954.0210; val_edge_recon_loss: 572750.3500; val_gene_expr_recon_loss: 16754297.2667; val_masked_gp_l1_reg_loss: 50730.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59358.1562; val_chrom_access_recon_loss: 8727411.6000; val_global_loss: 26195501.3333; val_optim_loss: 26195501.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9157; val_auprc_score: 0.8948; val_best_acc_score: 0.8374; val_best_f1_score: 0.8506; train_kl_reg_loss: 32246.6537; train_edge_recon_loss: 575384.2567; train_gene_expr_recon_loss: 16724350.6641; train_masked_gp_l1_reg_loss: 50677.0651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58976.5957; train_chrom_access_recon_loss: 8675469.7023; train_global_loss: 26117105.0382; train_optim_loss: 26117105.0382; val_kl_reg_loss: 31073.7047; val_edge_recon_loss: 576188.8125; val_gene_expr_recon_loss: 16774196.1333; val_masked_gp_l1_reg_loss: 50623.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58637.4844; val_chrom_access_recon_loss: 8782781.7667; val_global_loss: 26273502.6667; val_optim_loss: 26273502.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9203; val_auprc_score: 0.9052; val_best_acc_score: 0.8428; val_best_f1_score: 0.8564; train_kl_reg_loss: 32475.5578; train_edge_recon_loss: 574738.8068; train_gene_expr_recon_loss: 16723990.0916; train_masked_gp_l1_reg_loss: 50586.3188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58431.5077; train_chrom_access_recon_loss: 8663512.2290; train_global_loss: 26103734.5802; train_optim_loss: 26103734.5802; val_kl_reg_loss: 31169.7409; val_edge_recon_loss: 572406.2250; val_gene_expr_recon_loss: 16716691.0000; val_masked_gp_l1_reg_loss: 50548.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58135.3555; val_chrom_access_recon_loss: 8726275.9000; val_global_loss: 26155226.9333; val_optim_loss: 26155226.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9172; val_auprc_score: 0.9045; val_best_acc_score: 0.8379; val_best_f1_score: 0.8499; train_kl_reg_loss: 32693.4124; train_edge_recon_loss: 574331.3698; train_gene_expr_recon_loss: 16725777.1298; train_masked_gp_l1_reg_loss: 50511.6079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57951.2303; train_chrom_access_recon_loss: 8666017.4885; train_global_loss: 26107282.2290; train_optim_loss: 26107282.2290; val_kl_reg_loss: 31154.3934; val_edge_recon_loss: 576827.7667; val_gene_expr_recon_loss: 16755221.1333; val_masked_gp_l1_reg_loss: 50474.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57745.5742; val_chrom_access_recon_loss: 8768971.8667; val_global_loss: 26240395.0667; val_optim_loss: 26240395.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9118; val_auprc_score: 0.8946; val_best_acc_score: 0.8341; val_best_f1_score: 0.8491; train_kl_reg_loss: 32792.8112; train_edge_recon_loss: 576460.3807; train_gene_expr_recon_loss: 16726770.2443; train_masked_gp_l1_reg_loss: 50442.6798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57620.5606; train_chrom_access_recon_loss: 8676021.8511; train_global_loss: 26120108.6412; train_optim_loss: 26120108.6412; val_kl_reg_loss: 31482.8504; val_edge_recon_loss: 582134.3250; val_gene_expr_recon_loss: 16749659.8667; val_masked_gp_l1_reg_loss: 50414.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57406.1250; val_chrom_access_recon_loss: 8745004.7333; val_global_loss: 26216102.0000; val_optim_loss: 26216102.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9199; val_auprc_score: 0.9035; val_best_acc_score: 0.8405; val_best_f1_score: 0.8528; train_kl_reg_loss: 32859.4899; train_edge_recon_loss: 573900.3874; train_gene_expr_recon_loss: 16710305.2672; train_masked_gp_l1_reg_loss: 50389.6728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57259.1877; train_chrom_access_recon_loss: 8670272.6336; train_global_loss: 26094986.5954; train_optim_loss: 26094986.5954; val_kl_reg_loss: 31444.1741; val_edge_recon_loss: 571896.0000; val_gene_expr_recon_loss: 16735953.7333; val_masked_gp_l1_reg_loss: 50363.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57118.9375; val_chrom_access_recon_loss: 8746728.6000; val_global_loss: 26193504.8000; val_optim_loss: 26193504.8000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9170; val_auprc_score: 0.9022; val_best_acc_score: 0.8393; val_best_f1_score: 0.8511; train_kl_reg_loss: 32839.8017; train_edge_recon_loss: 572994.5611; train_gene_expr_recon_loss: 16699941.0763; train_masked_gp_l1_reg_loss: 50335.7814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56936.3558; train_chrom_access_recon_loss: 8659774.8702; train_global_loss: 26072822.4275; train_optim_loss: 26072822.4275; val_kl_reg_loss: 31703.7818; val_edge_recon_loss: 576389.3042; val_gene_expr_recon_loss: 16756428.2000; val_masked_gp_l1_reg_loss: 50309.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56756.8789; val_chrom_access_recon_loss: 8782990.8667; val_global_loss: 26254578.0000; val_optim_loss: 26254578.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9226; val_auprc_score: 0.9074; val_best_acc_score: 0.8465; val_best_f1_score: 0.8575; train_kl_reg_loss: 32927.2214; train_edge_recon_loss: 574369.0735; train_gene_expr_recon_loss: 16719323.2977; train_masked_gp_l1_reg_loss: 50266.0083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55684.2559; train_chrom_access_recon_loss: 8678154.5802; train_global_loss: 26110724.4275; train_optim_loss: 26110724.4275; val_kl_reg_loss: 31754.6199; val_edge_recon_loss: 573162.6375; val_gene_expr_recon_loss: 16683834.8667; val_masked_gp_l1_reg_loss: 50245.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55551.8086; val_chrom_access_recon_loss: 8733416.3333; val_global_loss: 26127966.4000; val_optim_loss: 26127966.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9205; val_auprc_score: 0.9047; val_best_acc_score: 0.8410; val_best_f1_score: 0.8539; train_kl_reg_loss: 32955.5469; train_edge_recon_loss: 575469.9962; train_gene_expr_recon_loss: 16727759.4885; train_masked_gp_l1_reg_loss: 50236.0043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55516.3548; train_chrom_access_recon_loss: 8668987.6374; train_global_loss: 26110924.8855; train_optim_loss: 26110924.8855; val_kl_reg_loss: 31552.0905; val_edge_recon_loss: 577062.3875; val_gene_expr_recon_loss: 16743973.0000; val_masked_gp_l1_reg_loss: 50226.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55485.2734; val_chrom_access_recon_loss: 8714702.4000; val_global_loss: 26173001.7333; val_optim_loss: 26173001.7333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9127; val_auprc_score: 0.8944; val_best_acc_score: 0.8341; val_best_f1_score: 0.8497; train_kl_reg_loss: 32991.4642; train_edge_recon_loss: 575530.7591; train_gene_expr_recon_loss: 16731171.3359; train_masked_gp_l1_reg_loss: 50219.3192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55459.3202; train_chrom_access_recon_loss: 8667662.8244; train_global_loss: 26113035.0992; train_optim_loss: 26113035.0992; val_kl_reg_loss: 31730.2892; val_edge_recon_loss: 580339.7000; val_gene_expr_recon_loss: 16822905.7333; val_masked_gp_l1_reg_loss: 50212.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55427.5000; val_chrom_access_recon_loss: 8792729.1667; val_global_loss: 26333344.8000; val_optim_loss: 26333344.8000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9239; val_auprc_score: 0.9099; val_best_acc_score: 0.8428; val_best_f1_score: 0.8531; train_kl_reg_loss: 32943.5818; train_edge_recon_loss: 573225.4504; train_gene_expr_recon_loss: 16724774.1908; train_masked_gp_l1_reg_loss: 50206.8903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55400.6498; train_chrom_access_recon_loss: 8673491.3168; train_global_loss: 26110041.9695; train_optim_loss: 26110041.9695; val_kl_reg_loss: 31750.5366; val_edge_recon_loss: 572634.1167; val_gene_expr_recon_loss: 16743588.7333; val_masked_gp_l1_reg_loss: 50202.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55379.3516; val_chrom_access_recon_loss: 8744197.7667; val_global_loss: 26197753.0667; val_optim_loss: 26197753.0667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9213; val_auprc_score: 0.9065; val_best_acc_score: 0.8421; val_best_f1_score: 0.8543; train_kl_reg_loss: 33015.7895; train_edge_recon_loss: 575629.2681; train_gene_expr_recon_loss: 16718154.1527; train_masked_gp_l1_reg_loss: 50197.6195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55358.7359; train_chrom_access_recon_loss: 8666566.5573; train_global_loss: 26098922.0916; train_optim_loss: 26098922.0916; val_kl_reg_loss: 31845.7288; val_edge_recon_loss: 573531.4875; val_gene_expr_recon_loss: 16784603.6667; val_masked_gp_l1_reg_loss: 50193.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55334.3945; val_chrom_access_recon_loss: 8784566.5333; val_global_loss: 26280075.4667; val_optim_loss: 26280075.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9145; val_auprc_score: 0.8979; val_best_acc_score: 0.8352; val_best_f1_score: 0.8487; train_kl_reg_loss: 33032.9419; train_edge_recon_loss: 574257.0310; train_gene_expr_recon_loss: 16718687.9618; train_masked_gp_l1_reg_loss: 50188.8980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55226.3319; train_chrom_access_recon_loss: 8666596.1336; train_global_loss: 26097989.2977; train_optim_loss: 26097989.2977; val_kl_reg_loss: 31759.4143; val_edge_recon_loss: 579426.9833; val_gene_expr_recon_loss: 16771166.2000; val_masked_gp_l1_reg_loss: 50187.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55213.7852; val_chrom_access_recon_loss: 8780203.0667; val_global_loss: 26267957.3333; val_optim_loss: 26267957.3333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9139; val_auprc_score: 0.8966; val_best_acc_score: 0.8370; val_best_f1_score: 0.8490; train_kl_reg_loss: 33047.0404; train_edge_recon_loss: 574631.9680; train_gene_expr_recon_loss: 16709240.4809; train_masked_gp_l1_reg_loss: 50186.0022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55209.7800; train_chrom_access_recon_loss: 8660983.6641; train_global_loss: 26083298.9466; train_optim_loss: 26083298.9466; val_kl_reg_loss: 31942.7251; val_edge_recon_loss: 577093.6042; val_gene_expr_recon_loss: 16734451.8667; val_masked_gp_l1_reg_loss: 50185.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55206.4414; val_chrom_access_recon_loss: 8780166.6000; val_global_loss: 26229046.5333; val_optim_loss: 26229046.5333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9180; val_auprc_score: 0.9013; val_best_acc_score: 0.8368; val_best_f1_score: 0.8494; train_kl_reg_loss: 33030.5665; train_edge_recon_loss: 573890.3201; train_gene_expr_recon_loss: 16698221.5573; train_masked_gp_l1_reg_loss: 50184.2207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55203.3700; train_chrom_access_recon_loss: 8652892.4695; train_global_loss: 26063422.3511; train_optim_loss: 26063422.3511; val_kl_reg_loss: 31923.5393; val_edge_recon_loss: 579554.3667; val_gene_expr_recon_loss: 16785984.0667; val_masked_gp_l1_reg_loss: 50183.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55200.2695; val_chrom_access_recon_loss: 8792046.7667; val_global_loss: 26294892.6667; val_optim_loss: 26294892.6667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9230; val_auprc_score: 0.9086; val_best_acc_score: 0.8430; val_best_f1_score: 0.8552; train_kl_reg_loss: 33058.9299; train_edge_recon_loss: 576231.1427; train_gene_expr_recon_loss: 16715551.6794; train_masked_gp_l1_reg_loss: 50183.0420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55197.6021; train_chrom_access_recon_loss: 8664456.9542; train_global_loss: 26094679.4198; train_optim_loss: 26094679.4198; val_kl_reg_loss: 31787.2995; val_edge_recon_loss: 575666.4333; val_gene_expr_recon_loss: 16708639.2000; val_masked_gp_l1_reg_loss: 50182.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55194.5586; val_chrom_access_recon_loss: 8733196.0667; val_global_loss: 26154664.9333; val_optim_loss: 26154664.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 56 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9161
val AUPRC score: 0.9014
val best accuracy score: 0.8364
val best F1 score: 0.8495
val target rna MSE score: 1.5367
val source rna MSE score: 0.6023
val target atac MSE score: 0.3447
val source atac MSE score: 0.1070
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
