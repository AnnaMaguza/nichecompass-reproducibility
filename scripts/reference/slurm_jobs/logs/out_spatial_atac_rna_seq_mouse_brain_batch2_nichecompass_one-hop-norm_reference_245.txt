[True]
Run timestamp: 07092023_025417_245.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_245']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2944 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6573, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7651; val_auprc_score: 0.7818; val_best_acc_score: 0.5472; val_best_f1_score: 0.6844; train_kl_reg_loss: 67126.6940; train_edge_recon_loss: 3572111.0802; train_gene_expr_recon_loss: 15410909.2214; train_masked_gp_l1_reg_loss: 40135.4761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4502984.2467; train_chrom_access_recon_loss: 13501420.8779; train_global_loss: 37094687.6031; train_optim_loss: 37094687.6031; val_kl_reg_loss: 106934.0938; val_edge_recon_loss: 4062050.1500; val_gene_expr_recon_loss: 14198936.2667; val_masked_gp_l1_reg_loss: 36967.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 400533.6875; val_chrom_access_recon_loss: 12992430.4000; val_global_loss: 31797852.9333; val_optim_loss: 31797852.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7938; val_auprc_score: 0.8106; val_best_acc_score: 0.7118; val_best_f1_score: 0.7187; train_kl_reg_loss: 98424.6861; train_edge_recon_loss: 3523922.5000; train_gene_expr_recon_loss: 13957698.9084; train_masked_gp_l1_reg_loss: 35890.6150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 236184.2954; train_chrom_access_recon_loss: 12900728.5267; train_global_loss: 30752849.6794; train_optim_loss: 30752849.6794; val_kl_reg_loss: 94356.4698; val_edge_recon_loss: 4035769.0167; val_gene_expr_recon_loss: 13829363.2667; val_masked_gp_l1_reg_loss: 35688.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165681.7812; val_chrom_access_recon_loss: 12775470.8000; val_global_loss: 30936329.6000; val_optim_loss: 30936329.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8891; val_auprc_score: 0.8834; val_best_acc_score: 0.8110; val_best_f1_score: 0.8242; train_kl_reg_loss: 80113.8505; train_edge_recon_loss: 3472548.0992; train_gene_expr_recon_loss: 13729584.1450; train_masked_gp_l1_reg_loss: 36958.8840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145007.9172; train_chrom_access_recon_loss: 12729082.5038; train_global_loss: 30193295.2061; train_optim_loss: 30193295.2061; val_kl_reg_loss: 57460.2039; val_edge_recon_loss: 3356247.0333; val_gene_expr_recon_loss: 13646911.6667; val_masked_gp_l1_reg_loss: 39135.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132898.0625; val_chrom_access_recon_loss: 12631186.6667; val_global_loss: 29863839.6000; val_optim_loss: 29863839.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9201; val_auprc_score: 0.9081; val_best_acc_score: 0.8504; val_best_f1_score: 0.8605; train_kl_reg_loss: 98520.2523; train_edge_recon_loss: 2961392.6088; train_gene_expr_recon_loss: 13561447.5802; train_masked_gp_l1_reg_loss: 41588.1827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128338.9741; train_chrom_access_recon_loss: 12563636.9618; train_global_loss: 29354924.5496; train_optim_loss: 29354924.5496; val_kl_reg_loss: 111479.3167; val_edge_recon_loss: 2864939.8333; val_gene_expr_recon_loss: 13449550.6667; val_masked_gp_l1_reg_loss: 43196.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123014.0938; val_chrom_access_recon_loss: 12484342.6000; val_global_loss: 29076522.5333; val_optim_loss: 29076522.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9344; val_auprc_score: 0.9224; val_best_acc_score: 0.8659; val_best_f1_score: 0.8719; train_kl_reg_loss: 111641.9514; train_edge_recon_loss: 2849744.0916; train_gene_expr_recon_loss: 13408385.2672; train_masked_gp_l1_reg_loss: 44702.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119518.4207; train_chrom_access_recon_loss: 12434491.9466; train_global_loss: 28968484.1679; train_optim_loss: 28968484.1679; val_kl_reg_loss: 108862.9219; val_edge_recon_loss: 2833265.7333; val_gene_expr_recon_loss: 13320569.2000; val_masked_gp_l1_reg_loss: 46173.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117513.9531; val_chrom_access_recon_loss: 12320710.8000; val_global_loss: 28747096.6667; val_optim_loss: 28747096.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9310; val_auprc_score: 0.9147; val_best_acc_score: 0.8665; val_best_f1_score: 0.8741; train_kl_reg_loss: 110203.1077; train_edge_recon_loss: 2833655.5305; train_gene_expr_recon_loss: 13289029.6641; train_masked_gp_l1_reg_loss: 47406.5584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115228.2028; train_chrom_access_recon_loss: 12321067.7634; train_global_loss: 28716590.8702; train_optim_loss: 28716590.8702; val_kl_reg_loss: 109739.9083; val_edge_recon_loss: 2822964.0167; val_gene_expr_recon_loss: 13219909.8000; val_masked_gp_l1_reg_loss: 48494.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113719.4531; val_chrom_access_recon_loss: 12224334.5333; val_global_loss: 28539161.8667; val_optim_loss: 28539161.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9349; val_auprc_score: 0.9197; val_best_acc_score: 0.8735; val_best_f1_score: 0.8805; train_kl_reg_loss: 106792.4054; train_edge_recon_loss: 2811043.3702; train_gene_expr_recon_loss: 13189614.9084; train_masked_gp_l1_reg_loss: 49583.7310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112275.6185; train_chrom_access_recon_loss: 12227296.3206; train_global_loss: 28496606.3053; train_optim_loss: 28496606.3053; val_kl_reg_loss: 103382.9641; val_edge_recon_loss: 2819972.2500; val_gene_expr_recon_loss: 13134545.6000; val_masked_gp_l1_reg_loss: 50596.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111717.7500; val_chrom_access_recon_loss: 12185569.7333; val_global_loss: 28405785.6000; val_optim_loss: 28405785.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9175; val_best_acc_score: 0.8771; val_best_f1_score: 0.8842; train_kl_reg_loss: 101893.6546; train_edge_recon_loss: 2797919.2023; train_gene_expr_recon_loss: 13090775.3817; train_masked_gp_l1_reg_loss: 51523.0012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110847.5457; train_chrom_access_recon_loss: 12132500.7557; train_global_loss: 28285459.4809; train_optim_loss: 28285459.4809; val_kl_reg_loss: 103091.4443; val_edge_recon_loss: 2814624.9333; val_gene_expr_recon_loss: 12994891.4667; val_masked_gp_l1_reg_loss: 52368.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110074.7422; val_chrom_access_recon_loss: 12032799.2667; val_global_loss: 28107850.9333; val_optim_loss: 28107850.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9390; val_auprc_score: 0.9233; val_best_acc_score: 0.8774; val_best_f1_score: 0.8852; train_kl_reg_loss: 98498.2897; train_edge_recon_loss: 2793632.8912; train_gene_expr_recon_loss: 13009194.5267; train_masked_gp_l1_reg_loss: 53210.1067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109678.2043; train_chrom_access_recon_loss: 12056746.3282; train_global_loss: 28120960.2443; train_optim_loss: 28120960.2443; val_kl_reg_loss: 97330.3938; val_edge_recon_loss: 2809938.5000; val_gene_expr_recon_loss: 12990371.4000; val_masked_gp_l1_reg_loss: 53899.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109170.6797; val_chrom_access_recon_loss: 12013414.6000; val_global_loss: 28074124.9333; val_optim_loss: 28074124.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9452; val_auprc_score: 0.9322; val_best_acc_score: 0.8829; val_best_f1_score: 0.8901; train_kl_reg_loss: 96711.5986; train_edge_recon_loss: 2788461.9847; train_gene_expr_recon_loss: 12926429.0687; train_masked_gp_l1_reg_loss: 54682.5532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109180.9931; train_chrom_access_recon_loss: 11994304.3435; train_global_loss: 27969770.5802; train_optim_loss: 27969770.5802; val_kl_reg_loss: 92271.9422; val_edge_recon_loss: 2793120.0000; val_gene_expr_recon_loss: 12886434.0000; val_masked_gp_l1_reg_loss: 55394.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109123.1562; val_chrom_access_recon_loss: 11944255.1333; val_global_loss: 27880598.9333; val_optim_loss: 27880598.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9521; val_auprc_score: 0.9389; val_best_acc_score: 0.8932; val_best_f1_score: 0.8987; train_kl_reg_loss: 93989.8889; train_edge_recon_loss: 2775590.1756; train_gene_expr_recon_loss: 12862893.6183; train_masked_gp_l1_reg_loss: 55994.3255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108929.3157; train_chrom_access_recon_loss: 11935811.5115; train_global_loss: 27833208.7786; train_optim_loss: 27833208.7786; val_kl_reg_loss: 88271.7177; val_edge_recon_loss: 2771894.1667; val_gene_expr_recon_loss: 12861170.0000; val_masked_gp_l1_reg_loss: 56714.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109019.3203; val_chrom_access_recon_loss: 11927948.8667; val_global_loss: 27815017.7333; val_optim_loss: 27815017.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9487; val_auprc_score: 0.9336; val_best_acc_score: 0.8914; val_best_f1_score: 0.8965; train_kl_reg_loss: 92206.5058; train_edge_recon_loss: 2759952.3034; train_gene_expr_recon_loss: 12798190.7252; train_masked_gp_l1_reg_loss: 57338.0163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109074.1300; train_chrom_access_recon_loss: 11864386.2061; train_global_loss: 27681147.7863; train_optim_loss: 27681147.7863; val_kl_reg_loss: 88912.8047; val_edge_recon_loss: 2778683.1500; val_gene_expr_recon_loss: 12764258.8667; val_masked_gp_l1_reg_loss: 58003.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109814.0938; val_chrom_access_recon_loss: 11809069.0667; val_global_loss: 27608741.7333; val_optim_loss: 27608741.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9552; val_auprc_score: 0.9433; val_best_acc_score: 0.8956; val_best_f1_score: 0.9001; train_kl_reg_loss: 92046.4541; train_edge_recon_loss: 2745045.3244; train_gene_expr_recon_loss: 12743204.5191; train_masked_gp_l1_reg_loss: 58476.1539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109291.0930; train_chrom_access_recon_loss: 11811206.0229; train_global_loss: 27559269.5420; train_optim_loss: 27559269.5420; val_kl_reg_loss: 90349.3661; val_edge_recon_loss: 2751617.6167; val_gene_expr_recon_loss: 12683851.2667; val_masked_gp_l1_reg_loss: 59054.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109161.7031; val_chrom_access_recon_loss: 11732366.7333; val_global_loss: 27426402.0000; val_optim_loss: 27426402.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9595; val_auprc_score: 0.9499; val_best_acc_score: 0.9027; val_best_f1_score: 0.9066; train_kl_reg_loss: 90164.0559; train_edge_recon_loss: 2746928.8645; train_gene_expr_recon_loss: 12691437.7099; train_masked_gp_l1_reg_loss: 59574.4810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109209.2137; train_chrom_access_recon_loss: 11755199.4733; train_global_loss: 27452513.6794; train_optim_loss: 27452513.6794; val_kl_reg_loss: 91035.0505; val_edge_recon_loss: 2732510.7000; val_gene_expr_recon_loss: 12639905.6667; val_masked_gp_l1_reg_loss: 59972.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108686.7031; val_chrom_access_recon_loss: 11668546.1333; val_global_loss: 27300657.7333; val_optim_loss: 27300657.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9538; val_auprc_score: 0.9414; val_best_acc_score: 0.9000; val_best_f1_score: 0.9037; train_kl_reg_loss: 90111.9012; train_edge_recon_loss: 2731264.8282; train_gene_expr_recon_loss: 12645314.2290; train_masked_gp_l1_reg_loss: 60424.2697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108971.4601; train_chrom_access_recon_loss: 11717002.9389; train_global_loss: 27353089.6641; train_optim_loss: 27353089.6641; val_kl_reg_loss: 88333.7255; val_edge_recon_loss: 2776854.1333; val_gene_expr_recon_loss: 12661939.1333; val_masked_gp_l1_reg_loss: 60935.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109208.7734; val_chrom_access_recon_loss: 11775341.2000; val_global_loss: 27472612.0000; val_optim_loss: 27472612.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9597; val_auprc_score: 0.9480; val_best_acc_score: 0.9089; val_best_f1_score: 0.9124; train_kl_reg_loss: 88230.1144; train_edge_recon_loss: 2733989.2691; train_gene_expr_recon_loss: 12598874.6565; train_masked_gp_l1_reg_loss: 61369.7088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109178.8344; train_chrom_access_recon_loss: 11667089.5038; train_global_loss: 27258732.1985; train_optim_loss: 27258732.1985; val_kl_reg_loss: 87244.6089; val_edge_recon_loss: 2733336.9667; val_gene_expr_recon_loss: 12572068.0667; val_masked_gp_l1_reg_loss: 61777.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109351.7109; val_chrom_access_recon_loss: 11642254.2000; val_global_loss: 27206034.0000; val_optim_loss: 27206034.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9651; val_auprc_score: 0.9560; val_best_acc_score: 0.9096; val_best_f1_score: 0.9127; train_kl_reg_loss: 88168.4563; train_edge_recon_loss: 2735723.7271; train_gene_expr_recon_loss: 12560422.5267; train_masked_gp_l1_reg_loss: 62140.4119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109070.0183; train_chrom_access_recon_loss: 11622948.3740; train_global_loss: 27178473.4962; train_optim_loss: 27178473.4962; val_kl_reg_loss: 87211.0698; val_edge_recon_loss: 2730181.2167; val_gene_expr_recon_loss: 12549285.8000; val_masked_gp_l1_reg_loss: 62529.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109521.8984; val_chrom_access_recon_loss: 11571527.3333; val_global_loss: 27110256.0000; val_optim_loss: 27110256.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9681; val_auprc_score: 0.9602; val_best_acc_score: 0.9188; val_best_f1_score: 0.9212; train_kl_reg_loss: 86061.0133; train_edge_recon_loss: 2723429.7023; train_gene_expr_recon_loss: 12525086.6870; train_masked_gp_l1_reg_loss: 62894.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109503.1434; train_chrom_access_recon_loss: 11587543.6489; train_global_loss: 27094518.8550; train_optim_loss: 27094518.8550; val_kl_reg_loss: 86309.2161; val_edge_recon_loss: 2711284.7667; val_gene_expr_recon_loss: 12508728.1333; val_masked_gp_l1_reg_loss: 63343.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109878.5391; val_chrom_access_recon_loss: 11532439.6667; val_global_loss: 27011984.8000; val_optim_loss: 27011984.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9697; val_auprc_score: 0.9622; val_best_acc_score: 0.9184; val_best_f1_score: 0.9205; train_kl_reg_loss: 85921.8179; train_edge_recon_loss: 2713517.4618; train_gene_expr_recon_loss: 12498607.8779; train_masked_gp_l1_reg_loss: 63600.5749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109803.0724; train_chrom_access_recon_loss: 11561688.5573; train_global_loss: 27033139.3588; train_optim_loss: 27033139.3588; val_kl_reg_loss: 83960.1687; val_edge_recon_loss: 2694826.1167; val_gene_expr_recon_loss: 12482424.0000; val_masked_gp_l1_reg_loss: 64075.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111130.1641; val_chrom_access_recon_loss: 11508162.1333; val_global_loss: 26944578.4000; val_optim_loss: 26944578.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9631; val_auprc_score: 0.9517; val_best_acc_score: 0.9117; val_best_f1_score: 0.9158; train_kl_reg_loss: 84611.9393; train_edge_recon_loss: 2717921.9008; train_gene_expr_recon_loss: 12461142.2519; train_masked_gp_l1_reg_loss: 64371.9650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110536.7873; train_chrom_access_recon_loss: 11528335.7023; train_global_loss: 26966920.4885; train_optim_loss: 26966920.4885; val_kl_reg_loss: 86719.9380; val_edge_recon_loss: 2716900.0667; val_gene_expr_recon_loss: 12458479.0667; val_masked_gp_l1_reg_loss: 64850.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110498.8125; val_chrom_access_recon_loss: 11495289.8000; val_global_loss: 26932737.7333; val_optim_loss: 26932737.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9683; val_auprc_score: 0.9595; val_best_acc_score: 0.9174; val_best_f1_score: 0.9192; train_kl_reg_loss: 84674.5510; train_edge_recon_loss: 2710564.5229; train_gene_expr_recon_loss: 12442458.0687; train_masked_gp_l1_reg_loss: 65042.1609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110855.5163; train_chrom_access_recon_loss: 11506558.9466; train_global_loss: 26920153.7252; train_optim_loss: 26920153.7252; val_kl_reg_loss: 85372.2344; val_edge_recon_loss: 2717375.3833; val_gene_expr_recon_loss: 12429084.2000; val_masked_gp_l1_reg_loss: 65162.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110771.8125; val_chrom_access_recon_loss: 11485185.2000; val_global_loss: 26892951.2000; val_optim_loss: 26892951.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9703; val_auprc_score: 0.9619; val_best_acc_score: 0.9208; val_best_f1_score: 0.9232; train_kl_reg_loss: 85044.0426; train_edge_recon_loss: 2707902.4771; train_gene_expr_recon_loss: 12408524.6260; train_masked_gp_l1_reg_loss: 65527.5461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111048.6099; train_chrom_access_recon_loss: 11466006.2748; train_global_loss: 26844053.5878; train_optim_loss: 26844053.5878; val_kl_reg_loss: 83168.4875; val_edge_recon_loss: 2705400.4333; val_gene_expr_recon_loss: 12384943.6000; val_masked_gp_l1_reg_loss: 65954.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111085.8594; val_chrom_access_recon_loss: 11439933.6000; val_global_loss: 26790486.1333; val_optim_loss: 26790486.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9673; val_auprc_score: 0.9592; val_best_acc_score: 0.9171; val_best_f1_score: 0.9199; train_kl_reg_loss: 83536.2563; train_edge_recon_loss: 2704720.4256; train_gene_expr_recon_loss: 12391697.5802; train_masked_gp_l1_reg_loss: 66193.8174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111346.7959; train_chrom_access_recon_loss: 11454356.0611; train_global_loss: 26811850.8855; train_optim_loss: 26811850.8855; val_kl_reg_loss: 83277.6714; val_edge_recon_loss: 2721476.6500; val_gene_expr_recon_loss: 12387373.2000; val_masked_gp_l1_reg_loss: 66525.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111658.9375; val_chrom_access_recon_loss: 11425722.6667; val_global_loss: 26796034.1333; val_optim_loss: 26796034.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9706; val_auprc_score: 0.9623; val_best_acc_score: 0.9212; val_best_f1_score: 0.9243; train_kl_reg_loss: 82786.6540; train_edge_recon_loss: 2703849.7691; train_gene_expr_recon_loss: 12359689.3282; train_masked_gp_l1_reg_loss: 66752.7923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111212.4895; train_chrom_access_recon_loss: 11419674.3969; train_global_loss: 26743965.3740; train_optim_loss: 26743965.3740; val_kl_reg_loss: 82042.8661; val_edge_recon_loss: 2710165.1167; val_gene_expr_recon_loss: 12342501.2000; val_masked_gp_l1_reg_loss: 67078.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112057.3828; val_chrom_access_recon_loss: 11415396.1333; val_global_loss: 26729240.2667; val_optim_loss: 26729240.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9752; val_auprc_score: 0.9702; val_best_acc_score: 0.9235; val_best_f1_score: 0.9256; train_kl_reg_loss: 82846.3324; train_edge_recon_loss: 2700112.8492; train_gene_expr_recon_loss: 12346970.5038; train_masked_gp_l1_reg_loss: 67318.4346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111641.3853; train_chrom_access_recon_loss: 11402616.4122; train_global_loss: 26711505.9237; train_optim_loss: 26711505.9237; val_kl_reg_loss: 81853.0016; val_edge_recon_loss: 2707243.2667; val_gene_expr_recon_loss: 12338775.9333; val_masked_gp_l1_reg_loss: 67482.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111730.8203; val_chrom_access_recon_loss: 11430504.8667; val_global_loss: 26737590.6667; val_optim_loss: 26737590.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9726; val_auprc_score: 0.9638; val_best_acc_score: 0.9217; val_best_f1_score: 0.9238; train_kl_reg_loss: 82490.8022; train_edge_recon_loss: 2701263.6450; train_gene_expr_recon_loss: 12319865.7481; train_masked_gp_l1_reg_loss: 67747.4807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111570.6313; train_chrom_access_recon_loss: 11374503.0763; train_global_loss: 26657441.4351; train_optim_loss: 26657441.4351; val_kl_reg_loss: 84513.0036; val_edge_recon_loss: 2706813.5167; val_gene_expr_recon_loss: 12337878.9333; val_masked_gp_l1_reg_loss: 68123.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112071.1328; val_chrom_access_recon_loss: 11425496.5333; val_global_loss: 26734896.9333; val_optim_loss: 26734896.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9772; val_auprc_score: 0.9701; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 81877.2194; train_edge_recon_loss: 2693082.3168; train_gene_expr_recon_loss: 12305315.4351; train_masked_gp_l1_reg_loss: 68266.4016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111427.1244; train_chrom_access_recon_loss: 11351994.5573; train_global_loss: 26611963.0382; train_optim_loss: 26611963.0382; val_kl_reg_loss: 82371.4021; val_edge_recon_loss: 2698657.4000; val_gene_expr_recon_loss: 12307411.2667; val_masked_gp_l1_reg_loss: 68421.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111549.9453; val_chrom_access_recon_loss: 11390057.2000; val_global_loss: 26658469.2000; val_optim_loss: 26658469.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9739; val_auprc_score: 0.9669; val_best_acc_score: 0.9270; val_best_f1_score: 0.9286; train_kl_reg_loss: 81719.2356; train_edge_recon_loss: 2688084.2634; train_gene_expr_recon_loss: 12287260.6031; train_masked_gp_l1_reg_loss: 68714.8267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111630.6970; train_chrom_access_recon_loss: 11337609.2901; train_global_loss: 26575018.8092; train_optim_loss: 26575018.8092; val_kl_reg_loss: 82067.7396; val_edge_recon_loss: 2697861.1833; val_gene_expr_recon_loss: 12288473.3333; val_masked_gp_l1_reg_loss: 68986.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111819.3516; val_chrom_access_recon_loss: 11348880.9333; val_global_loss: 26598089.0667; val_optim_loss: 26598089.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9748; val_auprc_score: 0.9655; val_best_acc_score: 0.9299; val_best_f1_score: 0.9320; train_kl_reg_loss: 80964.0915; train_edge_recon_loss: 2689805.8340; train_gene_expr_recon_loss: 12273057.4504; train_masked_gp_l1_reg_loss: 69202.8685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111508.2258; train_chrom_access_recon_loss: 11317537.3282; train_global_loss: 26542075.8931; train_optim_loss: 26542075.8931; val_kl_reg_loss: 81434.6443; val_edge_recon_loss: 2696277.2500; val_gene_expr_recon_loss: 12304773.3333; val_masked_gp_l1_reg_loss: 69548.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112426.6953; val_chrom_access_recon_loss: 11321672.4000; val_global_loss: 26586133.6000; val_optim_loss: 26586133.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9770; val_auprc_score: 0.9694; val_best_acc_score: 0.9293; val_best_f1_score: 0.9316; train_kl_reg_loss: 80064.7950; train_edge_recon_loss: 2694176.2252; train_gene_expr_recon_loss: 12252582.6489; train_masked_gp_l1_reg_loss: 69687.6809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111560.3299; train_chrom_access_recon_loss: 11283961.2366; train_global_loss: 26492032.9008; train_optim_loss: 26492032.9008; val_kl_reg_loss: 81821.0448; val_edge_recon_loss: 2703579.2000; val_gene_expr_recon_loss: 12280981.8667; val_masked_gp_l1_reg_loss: 69819.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112294.5859; val_chrom_access_recon_loss: 11287319.6667; val_global_loss: 26535815.8667; val_optim_loss: 26535815.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9776; val_auprc_score: 0.9703; val_best_acc_score: 0.9309; val_best_f1_score: 0.9335; train_kl_reg_loss: 79747.7221; train_edge_recon_loss: 2687059.9218; train_gene_expr_recon_loss: 12245892.4656; train_masked_gp_l1_reg_loss: 70116.7223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111657.4371; train_chrom_access_recon_loss: 11276963.9771; train_global_loss: 26471438.1985; train_optim_loss: 26471438.1985; val_kl_reg_loss: 80521.8651; val_edge_recon_loss: 2686544.7667; val_gene_expr_recon_loss: 12249945.3333; val_masked_gp_l1_reg_loss: 70322.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111798.4609; val_chrom_access_recon_loss: 11301963.9333; val_global_loss: 26501096.0000; val_optim_loss: 26501096.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9781; val_auprc_score: 0.9700; val_best_acc_score: 0.9333; val_best_f1_score: 0.9341; train_kl_reg_loss: 80768.4364; train_edge_recon_loss: 2685976.3645; train_gene_expr_recon_loss: 12236666.1298; train_masked_gp_l1_reg_loss: 70406.1863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111448.6601; train_chrom_access_recon_loss: 11261291.4656; train_global_loss: 26446557.2824; train_optim_loss: 26446557.2824; val_kl_reg_loss: 80128.7323; val_edge_recon_loss: 2681836.1833; val_gene_expr_recon_loss: 12252926.2000; val_masked_gp_l1_reg_loss: 70639.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110817.2500; val_chrom_access_recon_loss: 11291748.2000; val_global_loss: 26488096.2667; val_optim_loss: 26488096.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9809; val_auprc_score: 0.9756; val_best_acc_score: 0.9382; val_best_f1_score: 0.9396; train_kl_reg_loss: 79795.6351; train_edge_recon_loss: 2690517.8760; train_gene_expr_recon_loss: 12207610.7863; train_masked_gp_l1_reg_loss: 70722.9430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111347.0372; train_chrom_access_recon_loss: 11227825.7328; train_global_loss: 26387820.1832; train_optim_loss: 26387820.1832; val_kl_reg_loss: 78973.4328; val_edge_recon_loss: 2694710.6500; val_gene_expr_recon_loss: 12253544.8000; val_masked_gp_l1_reg_loss: 70986.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112106.5078; val_chrom_access_recon_loss: 11278825.1333; val_global_loss: 26489148.0000; val_optim_loss: 26489148.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9801; val_auprc_score: 0.9758; val_best_acc_score: 0.9368; val_best_f1_score: 0.9387; train_kl_reg_loss: 78666.2973; train_edge_recon_loss: 2693885.1450; train_gene_expr_recon_loss: 12209535.9008; train_masked_gp_l1_reg_loss: 71152.5193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111670.4490; train_chrom_access_recon_loss: 11227744.2290; train_global_loss: 26392654.5649; train_optim_loss: 26392654.5649; val_kl_reg_loss: 80636.3229; val_edge_recon_loss: 2692551.6833; val_gene_expr_recon_loss: 12206106.3333; val_masked_gp_l1_reg_loss: 71269.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111394.9688; val_chrom_access_recon_loss: 11266281.0000; val_global_loss: 26428240.1333; val_optim_loss: 26428240.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9785; val_auprc_score: 0.9722; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 79175.0853; train_edge_recon_loss: 2682474.7786; train_gene_expr_recon_loss: 12195409.9771; train_masked_gp_l1_reg_loss: 71423.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111588.2688; train_chrom_access_recon_loss: 11206067.9237; train_global_loss: 26346139.7405; train_optim_loss: 26346139.7405; val_kl_reg_loss: 78260.1740; val_edge_recon_loss: 2702243.4000; val_gene_expr_recon_loss: 12202198.9333; val_masked_gp_l1_reg_loss: 71529.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110575.8125; val_chrom_access_recon_loss: 11224578.2000; val_global_loss: 26389385.3333; val_optim_loss: 26389385.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9832; val_auprc_score: 0.9800; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 78964.9584; train_edge_recon_loss: 2682318.4752; train_gene_expr_recon_loss: 12190438.5191; train_masked_gp_l1_reg_loss: 71709.2501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111761.3179; train_chrom_access_recon_loss: 11208232.0840; train_global_loss: 26343424.6412; train_optim_loss: 26343424.6412; val_kl_reg_loss: 79816.5318; val_edge_recon_loss: 2693413.7167; val_gene_expr_recon_loss: 12225085.6667; val_masked_gp_l1_reg_loss: 71907.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111555.2031; val_chrom_access_recon_loss: 11251191.7333; val_global_loss: 26432970.4000; val_optim_loss: 26432970.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9825; val_auprc_score: 0.9764; val_best_acc_score: 0.9454; val_best_f1_score: 0.9466; train_kl_reg_loss: 78986.4237; train_edge_recon_loss: 2681633.2615; train_gene_expr_recon_loss: 12181169.9847; train_masked_gp_l1_reg_loss: 72048.9560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111715.0875; train_chrom_access_recon_loss: 11187094.6565; train_global_loss: 26312648.3359; train_optim_loss: 26312648.3359; val_kl_reg_loss: 79683.1964; val_edge_recon_loss: 2677210.2000; val_gene_expr_recon_loss: 12185183.7333; val_masked_gp_l1_reg_loss: 72099.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111898.2734; val_chrom_access_recon_loss: 11252606.1333; val_global_loss: 26378681.4667; val_optim_loss: 26378681.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9821; val_auprc_score: 0.9774; val_best_acc_score: 0.9399; val_best_f1_score: 0.9425; train_kl_reg_loss: 79033.6254; train_edge_recon_loss: 2677147.0076; train_gene_expr_recon_loss: 12163215.7481; train_masked_gp_l1_reg_loss: 72320.4768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111869.1243; train_chrom_access_recon_loss: 11171387.6870; train_global_loss: 26274973.5878; train_optim_loss: 26274973.5878; val_kl_reg_loss: 82029.2937; val_edge_recon_loss: 2688950.9500; val_gene_expr_recon_loss: 12187860.6667; val_masked_gp_l1_reg_loss: 72380.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112069.2188; val_chrom_access_recon_loss: 11207671.5333; val_global_loss: 26350961.4667; val_optim_loss: 26350961.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9830; val_auprc_score: 0.9785; val_best_acc_score: 0.9461; val_best_f1_score: 0.9471; train_kl_reg_loss: 78428.9700; train_edge_recon_loss: 2687678.1374; train_gene_expr_recon_loss: 12164176.6107; train_masked_gp_l1_reg_loss: 72585.4116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111974.8523; train_chrom_access_recon_loss: 11169349.4046; train_global_loss: 26284193.4351; train_optim_loss: 26284193.4351; val_kl_reg_loss: 77975.2125; val_edge_recon_loss: 2684481.4333; val_gene_expr_recon_loss: 12186719.6000; val_masked_gp_l1_reg_loss: 72670.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111469.0234; val_chrom_access_recon_loss: 11223670.5333; val_global_loss: 26356986.8000; val_optim_loss: 26356986.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9813; val_auprc_score: 0.9754; val_best_acc_score: 0.9414; val_best_f1_score: 0.9433; train_kl_reg_loss: 79042.9185; train_edge_recon_loss: 2674309.6164; train_gene_expr_recon_loss: 12151800.9237; train_masked_gp_l1_reg_loss: 72797.6601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111978.4372; train_chrom_access_recon_loss: 11143331.0458; train_global_loss: 26233260.6565; train_optim_loss: 26233260.6565; val_kl_reg_loss: 79390.8302; val_edge_recon_loss: 2689648.3333; val_gene_expr_recon_loss: 12173668.7333; val_masked_gp_l1_reg_loss: 72971.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112588.3750; val_chrom_access_recon_loss: 11208510.0000; val_global_loss: 26336777.6000; val_optim_loss: 26336777.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9842; val_auprc_score: 0.9773; val_best_acc_score: 0.9434; val_best_f1_score: 0.9457; train_kl_reg_loss: 78626.1786; train_edge_recon_loss: 2679987.5458; train_gene_expr_recon_loss: 12145639.0534; train_masked_gp_l1_reg_loss: 73099.2409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111929.4641; train_chrom_access_recon_loss: 11131322.5954; train_global_loss: 26220604.1832; train_optim_loss: 26220604.1832; val_kl_reg_loss: 80955.4646; val_edge_recon_loss: 2679950.7167; val_gene_expr_recon_loss: 12190160.3333; val_masked_gp_l1_reg_loss: 73133.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112569.4453; val_chrom_access_recon_loss: 11197661.4000; val_global_loss: 26334430.1333; val_optim_loss: 26334430.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9839; val_auprc_score: 0.9768; val_best_acc_score: 0.9457; val_best_f1_score: 0.9470; train_kl_reg_loss: 78630.8745; train_edge_recon_loss: 2677868.3416; train_gene_expr_recon_loss: 12136107.4198; train_masked_gp_l1_reg_loss: 73279.2057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112165.8723; train_chrom_access_recon_loss: 11118540.1145; train_global_loss: 26196591.8015; train_optim_loss: 26196591.8015; val_kl_reg_loss: 78617.7677; val_edge_recon_loss: 2692895.9667; val_gene_expr_recon_loss: 12138490.7333; val_masked_gp_l1_reg_loss: 73430.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112074.2734; val_chrom_access_recon_loss: 11180670.6667; val_global_loss: 26276180.4000; val_optim_loss: 26276180.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9835; val_auprc_score: 0.9791; val_best_acc_score: 0.9444; val_best_f1_score: 0.9456; train_kl_reg_loss: 79248.5397; train_edge_recon_loss: 2678528.9046; train_gene_expr_recon_loss: 12127098.4046; train_masked_gp_l1_reg_loss: 73495.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112064.0475; train_chrom_access_recon_loss: 11107926.5496; train_global_loss: 26178362.2137; train_optim_loss: 26178362.2137; val_kl_reg_loss: 80259.1000; val_edge_recon_loss: 2691923.3667; val_gene_expr_recon_loss: 12189629.0000; val_masked_gp_l1_reg_loss: 73559.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112493.7734; val_chrom_access_recon_loss: 11203871.2667; val_global_loss: 26351735.6000; val_optim_loss: 26351735.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9844; val_auprc_score: 0.9796; val_best_acc_score: 0.9472; val_best_f1_score: 0.9483; train_kl_reg_loss: 79236.0195; train_edge_recon_loss: 2673442.0153; train_gene_expr_recon_loss: 12131354.3740; train_masked_gp_l1_reg_loss: 73617.8914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112217.6987; train_chrom_access_recon_loss: 11107393.4122; train_global_loss: 26177261.4351; train_optim_loss: 26177261.4351; val_kl_reg_loss: 78470.1245; val_edge_recon_loss: 2691408.5833; val_gene_expr_recon_loss: 12138344.0000; val_masked_gp_l1_reg_loss: 73850.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112546.9688; val_chrom_access_recon_loss: 11201658.0000; val_global_loss: 26296277.4667; val_optim_loss: 26296277.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9852; val_auprc_score: 0.9803; val_best_acc_score: 0.9511; val_best_f1_score: 0.9524; train_kl_reg_loss: 78908.5377; train_edge_recon_loss: 2674421.9885; train_gene_expr_recon_loss: 12118027.4656; train_masked_gp_l1_reg_loss: 73846.8630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112384.4964; train_chrom_access_recon_loss: 11082326.3664; train_global_loss: 26139915.6336; train_optim_loss: 26139915.6336; val_kl_reg_loss: 80125.6406; val_edge_recon_loss: 2682172.8833; val_gene_expr_recon_loss: 12182177.0667; val_masked_gp_l1_reg_loss: 73840.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112771.4062; val_chrom_access_recon_loss: 11189073.2667; val_global_loss: 26320160.5333; val_optim_loss: 26320160.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9844; val_auprc_score: 0.9807; val_best_acc_score: 0.9434; val_best_f1_score: 0.9452; train_kl_reg_loss: 79399.5101; train_edge_recon_loss: 2666849.7271; train_gene_expr_recon_loss: 12113703.0916; train_masked_gp_l1_reg_loss: 73934.5638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112391.7236; train_chrom_access_recon_loss: 11077778.0000; train_global_loss: 26124056.5344; train_optim_loss: 26124056.5344; val_kl_reg_loss: 80575.1224; val_edge_recon_loss: 2689636.4667; val_gene_expr_recon_loss: 12132429.1333; val_masked_gp_l1_reg_loss: 74038.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112838.7891; val_chrom_access_recon_loss: 11182723.5333; val_global_loss: 26272242.4000; val_optim_loss: 26272242.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9867; val_auprc_score: 0.9820; val_best_acc_score: 0.9535; val_best_f1_score: 0.9545; train_kl_reg_loss: 79473.3286; train_edge_recon_loss: 2671803.4885; train_gene_expr_recon_loss: 12112689.0000; train_masked_gp_l1_reg_loss: 74119.6666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112379.1834; train_chrom_access_recon_loss: 11079215.9237; train_global_loss: 26129680.6565; train_optim_loss: 26129680.6565; val_kl_reg_loss: 79587.7854; val_edge_recon_loss: 2666194.1167; val_gene_expr_recon_loss: 12117279.4667; val_masked_gp_l1_reg_loss: 74150.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112205.5625; val_chrom_access_recon_loss: 11161374.6667; val_global_loss: 26210792.9333; val_optim_loss: 26210792.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9844; val_auprc_score: 0.9786; val_best_acc_score: 0.9473; val_best_f1_score: 0.9483; train_kl_reg_loss: 79560.3496; train_edge_recon_loss: 2664780.5038; train_gene_expr_recon_loss: 12097957.6336; train_masked_gp_l1_reg_loss: 74196.5611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112370.8338; train_chrom_access_recon_loss: 11056284.0305; train_global_loss: 26085149.9542; train_optim_loss: 26085149.9542; val_kl_reg_loss: 79065.3427; val_edge_recon_loss: 2686771.0500; val_gene_expr_recon_loss: 12120384.0667; val_masked_gp_l1_reg_loss: 74280.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112286.7578; val_chrom_access_recon_loss: 11145779.8000; val_global_loss: 26218568.2667; val_optim_loss: 26218568.2667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9860; val_auprc_score: 0.9821; val_best_acc_score: 0.9512; val_best_f1_score: 0.9524; train_kl_reg_loss: 78761.2366; train_edge_recon_loss: 2675924.8149; train_gene_expr_recon_loss: 12101198.1603; train_masked_gp_l1_reg_loss: 74334.1727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112445.5222; train_chrom_access_recon_loss: 11064112.0916; train_global_loss: 26106775.9084; train_optim_loss: 26106775.9084; val_kl_reg_loss: 81082.5505; val_edge_recon_loss: 2679593.5333; val_gene_expr_recon_loss: 12129386.1333; val_masked_gp_l1_reg_loss: 74425.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113185.7969; val_chrom_access_recon_loss: 11187514.2000; val_global_loss: 26265188.2667; val_optim_loss: 26265188.2667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9866; val_auprc_score: 0.9836; val_best_acc_score: 0.9530; val_best_f1_score: 0.9541; train_kl_reg_loss: 79790.1340; train_edge_recon_loss: 2664718.2252; train_gene_expr_recon_loss: 12090675.4504; train_masked_gp_l1_reg_loss: 74485.0875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112552.2725; train_chrom_access_recon_loss: 11049775.3664; train_global_loss: 26071996.6107; train_optim_loss: 26071996.6107; val_kl_reg_loss: 80518.2563; val_edge_recon_loss: 2684740.7167; val_gene_expr_recon_loss: 12140028.6000; val_masked_gp_l1_reg_loss: 74472.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112286.6875; val_chrom_access_recon_loss: 11182027.2000; val_global_loss: 26274074.8000; val_optim_loss: 26274074.8000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9860; val_auprc_score: 0.9803; val_best_acc_score: 0.9553; val_best_f1_score: 0.9564; train_kl_reg_loss: 79450.9564; train_edge_recon_loss: 2666108.2500; train_gene_expr_recon_loss: 12082548.9466; train_masked_gp_l1_reg_loss: 74552.6883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112649.2425; train_chrom_access_recon_loss: 11037608.7786; train_global_loss: 26052918.9924; train_optim_loss: 26052918.9924; val_kl_reg_loss: 79976.5120; val_edge_recon_loss: 2682339.7833; val_gene_expr_recon_loss: 12140203.8667; val_masked_gp_l1_reg_loss: 74679.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113280.3750; val_chrom_access_recon_loss: 11161926.8667; val_global_loss: 26252407.2000; val_optim_loss: 26252407.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9867; val_auprc_score: 0.9819; val_best_acc_score: 0.9565; val_best_f1_score: 0.9574; train_kl_reg_loss: 80367.2552; train_edge_recon_loss: 2666302.1889; train_gene_expr_recon_loss: 12068625.2748; train_masked_gp_l1_reg_loss: 73047.3757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82465.3698; train_chrom_access_recon_loss: 11002747.9618; train_global_loss: 25973555.5267; train_optim_loss: 25973555.5267; val_kl_reg_loss: 82019.9302; val_edge_recon_loss: 2669898.2667; val_gene_expr_recon_loss: 12101549.6667; val_masked_gp_l1_reg_loss: 72226.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78935.5312; val_chrom_access_recon_loss: 11131537.2000; val_global_loss: 26136167.2000; val_optim_loss: 26136167.2000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9874; val_auprc_score: 0.9838; val_best_acc_score: 0.9558; val_best_f1_score: 0.9567; train_kl_reg_loss: 82006.7195; train_edge_recon_loss: 2659310.3149; train_gene_expr_recon_loss: 12070009.8550; train_masked_gp_l1_reg_loss: 71992.1808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78510.0502; train_chrom_access_recon_loss: 10998193.8779; train_global_loss: 25960023.0382; train_optim_loss: 25960023.0382; val_kl_reg_loss: 83419.6089; val_edge_recon_loss: 2664200.5333; val_gene_expr_recon_loss: 12141461.2667; val_masked_gp_l1_reg_loss: 71817.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77880.9844; val_chrom_access_recon_loss: 11221652.4000; val_global_loss: 26260431.3333; val_optim_loss: 26260431.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9875; val_auprc_score: 0.9844; val_best_acc_score: 0.9545; val_best_f1_score: 0.9557; train_kl_reg_loss: 82628.2216; train_edge_recon_loss: 2657529.5229; train_gene_expr_recon_loss: 12066254.8855; train_masked_gp_l1_reg_loss: 71740.0797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77719.2164; train_chrom_access_recon_loss: 10991828.4885; train_global_loss: 25947700.2748; train_optim_loss: 25947700.2748; val_kl_reg_loss: 83565.3990; val_edge_recon_loss: 2679000.3000; val_gene_expr_recon_loss: 12149846.4000; val_masked_gp_l1_reg_loss: 71665.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77616.2578; val_chrom_access_recon_loss: 11124171.8667; val_global_loss: 26185864.6667; val_optim_loss: 26185864.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9862; val_auprc_score: 0.9815; val_best_acc_score: 0.9534; val_best_f1_score: 0.9546; train_kl_reg_loss: 82861.8254; train_edge_recon_loss: 2667006.1985; train_gene_expr_recon_loss: 12065427.0611; train_masked_gp_l1_reg_loss: 71631.1725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77409.4846; train_chrom_access_recon_loss: 10997408.7252; train_global_loss: 25961744.6412; train_optim_loss: 25961744.6412; val_kl_reg_loss: 83372.5505; val_edge_recon_loss: 2677229.0667; val_gene_expr_recon_loss: 12156151.0000; val_masked_gp_l1_reg_loss: 71586.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77224.3516; val_chrom_access_recon_loss: 11222112.3333; val_global_loss: 26287676.0000; val_optim_loss: 26287676.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9864; val_auprc_score: 0.9819; val_best_acc_score: 0.9522; val_best_f1_score: 0.9535; train_kl_reg_loss: 82750.7322; train_edge_recon_loss: 2663999.6450; train_gene_expr_recon_loss: 12068172.1374; train_masked_gp_l1_reg_loss: 71569.8416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77181.0178; train_chrom_access_recon_loss: 10999343.0153; train_global_loss: 25963016.3664; train_optim_loss: 25963016.3664; val_kl_reg_loss: 83592.5339; val_edge_recon_loss: 2666894.3833; val_gene_expr_recon_loss: 12113946.3333; val_masked_gp_l1_reg_loss: 71544.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76824.7969; val_chrom_access_recon_loss: 11141392.9333; val_global_loss: 26154196.4000; val_optim_loss: 26154196.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9890; val_auprc_score: 0.9854; val_best_acc_score: 0.9541; val_best_f1_score: 0.9553; train_kl_reg_loss: 82725.2168; train_edge_recon_loss: 2663620.9294; train_gene_expr_recon_loss: 12063553.1832; train_masked_gp_l1_reg_loss: 71389.0269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73804.4288; train_chrom_access_recon_loss: 10990184.1450; train_global_loss: 25945276.9771; train_optim_loss: 25945276.9771; val_kl_reg_loss: 83442.8995; val_edge_recon_loss: 2686971.5167; val_gene_expr_recon_loss: 12113632.0667; val_masked_gp_l1_reg_loss: 71297.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73487.8906; val_chrom_access_recon_loss: 11171233.2667; val_global_loss: 26200065.6000; val_optim_loss: 26200065.6000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9886; val_auprc_score: 0.9843; val_best_acc_score: 0.9563; val_best_f1_score: 0.9577; train_kl_reg_loss: 83023.1007; train_edge_recon_loss: 2655685.1584; train_gene_expr_recon_loss: 12064398.0229; train_masked_gp_l1_reg_loss: 71263.5741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73448.8497; train_chrom_access_recon_loss: 10987533.4351; train_global_loss: 25935352.1832; train_optim_loss: 25935352.1832; val_kl_reg_loss: 83650.2604; val_edge_recon_loss: 2662876.2167; val_gene_expr_recon_loss: 12125841.2000; val_masked_gp_l1_reg_loss: 71235.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73401.0547; val_chrom_access_recon_loss: 11169522.4667; val_global_loss: 26186526.2667; val_optim_loss: 26186526.2667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9871; val_auprc_score: 0.9832; val_best_acc_score: 0.9508; val_best_f1_score: 0.9516; train_kl_reg_loss: 83052.9221; train_edge_recon_loss: 2661545.2634; train_gene_expr_recon_loss: 12063500.4733; train_masked_gp_l1_reg_loss: 71220.3077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73381.6341; train_chrom_access_recon_loss: 10985231.8244; train_global_loss: 25937932.3206; train_optim_loss: 25937932.3206; val_kl_reg_loss: 83670.6370; val_edge_recon_loss: 2698288.3333; val_gene_expr_recon_loss: 12108797.8667; val_masked_gp_l1_reg_loss: 71204.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73354.8750; val_chrom_access_recon_loss: 11192114.7333; val_global_loss: 26227431.7333; val_optim_loss: 26227431.7333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9863; val_auprc_score: 0.9813; val_best_acc_score: 0.9535; val_best_f1_score: 0.9550; train_kl_reg_loss: 83031.5923; train_edge_recon_loss: 2666286.3969; train_gene_expr_recon_loss: 12060673.4046; train_masked_gp_l1_reg_loss: 71194.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73316.5040; train_chrom_access_recon_loss: 10986190.6260; train_global_loss: 25940693.3893; train_optim_loss: 25940693.3893; val_kl_reg_loss: 84032.5646; val_edge_recon_loss: 2676322.9167; val_gene_expr_recon_loss: 12106133.8000; val_masked_gp_l1_reg_loss: 71185.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73291.7188; val_chrom_access_recon_loss: 11134967.0000; val_global_loss: 26145934.5333; val_optim_loss: 26145934.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 101 min 49 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9872
val AUPRC score: 0.9826
val best accuracy score: 0.9541
val best F1 score: 0.9552
val target rna MSE score: 0.9309
val source rna MSE score: 0.1905
val target atac MSE score: 0.3408
val source atac MSE score: 0.0523
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
