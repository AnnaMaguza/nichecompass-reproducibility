[True]
Run timestamp: 10082023_191936_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7355; val_auprc_score: 0.7669; val_best_acc_score: 0.5085; val_best_f1_score: 0.6694; train_kl_reg_loss: 93223.5751; train_edge_recon_loss: 3700800.4733; train_gene_expr_recon_loss: 27324245.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16377159.4198; train_global_loss: 47495428.5191; train_optim_loss: 47495428.5191; val_kl_reg_loss: 166271.3073; val_edge_recon_loss: 4064517.8500; val_gene_expr_recon_loss: 23060806.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15550345.0000; val_global_loss: 42841940.5333; val_optim_loss: 42841940.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8025; val_auprc_score: 0.8155; val_best_acc_score: 0.7175; val_best_f1_score: 0.7290; train_kl_reg_loss: 174527.7993; train_edge_recon_loss: 3588434.5592; train_gene_expr_recon_loss: 22663838.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15449569.3053; train_global_loss: 41876370.3206; train_optim_loss: 41876370.3206; val_kl_reg_loss: 170157.9250; val_edge_recon_loss: 4037535.1667; val_gene_expr_recon_loss: 22209714.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15335422.8667; val_global_loss: 41752830.9333; val_optim_loss: 41752830.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8888; val_auprc_score: 0.8775; val_best_acc_score: 0.8110; val_best_f1_score: 0.8232; train_kl_reg_loss: 151522.4889; train_edge_recon_loss: 3530204.3092; train_gene_expr_recon_loss: 22225153.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15319644.2748; train_global_loss: 41226524.1527; train_optim_loss: 41226524.1527; val_kl_reg_loss: 134684.2839; val_edge_recon_loss: 3763550.9333; val_gene_expr_recon_loss: 22090481.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15280432.0000; val_global_loss: 41269148.5333; val_optim_loss: 41269148.5333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8968; val_auprc_score: 0.8821; val_best_acc_score: 0.8192; val_best_f1_score: 0.8339; train_kl_reg_loss: 140118.2904; train_edge_recon_loss: 3183937.3378; train_gene_expr_recon_loss: 22037724.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15205378.8702; train_global_loss: 40567158.3206; train_optim_loss: 40567158.3206; val_kl_reg_loss: 166862.7229; val_edge_recon_loss: 2988197.5167; val_gene_expr_recon_loss: 21860528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15153848.8667; val_global_loss: 40169437.3333; val_optim_loss: 40169437.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9031; val_auprc_score: 0.8844; val_best_acc_score: 0.8297; val_best_f1_score: 0.8432; train_kl_reg_loss: 164457.8952; train_edge_recon_loss: 2954346.6775; train_gene_expr_recon_loss: 21883119.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15137362.2519; train_global_loss: 40139286.1679; train_optim_loss: 40139286.1679; val_kl_reg_loss: 160667.2823; val_edge_recon_loss: 2948484.4333; val_gene_expr_recon_loss: 21649955.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15055044.2667; val_global_loss: 39814152.5333; val_optim_loss: 39814152.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9160; val_auprc_score: 0.9028; val_best_acc_score: 0.8401; val_best_f1_score: 0.8520; train_kl_reg_loss: 161758.4458; train_edge_recon_loss: 2900479.7595; train_gene_expr_recon_loss: 21755007.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15090651.0534; train_global_loss: 39907896.4275; train_optim_loss: 39907896.4275; val_kl_reg_loss: 150677.0365; val_edge_recon_loss: 2906442.5167; val_gene_expr_recon_loss: 21572738.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15033352.4667; val_global_loss: 39663210.4000; val_optim_loss: 39663210.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9225; val_auprc_score: 0.9057; val_best_acc_score: 0.8522; val_best_f1_score: 0.8616; train_kl_reg_loss: 148466.8898; train_edge_recon_loss: 2892392.3817; train_gene_expr_recon_loss: 21583518.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14985815.8015; train_global_loss: 39610193.5878; train_optim_loss: 39610193.5878; val_kl_reg_loss: 146570.2083; val_edge_recon_loss: 2871534.6333; val_gene_expr_recon_loss: 21375432.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14914076.1333; val_global_loss: 39307613.3333; val_optim_loss: 39307613.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9240; val_auprc_score: 0.9081; val_best_acc_score: 0.8476; val_best_f1_score: 0.8580; train_kl_reg_loss: 144632.2944; train_edge_recon_loss: 2864601.0515; train_gene_expr_recon_loss: 21459276.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14911543.6412; train_global_loss: 39380053.3435; train_optim_loss: 39380053.3435; val_kl_reg_loss: 143832.7333; val_edge_recon_loss: 2871911.8333; val_gene_expr_recon_loss: 21413075.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14955933.8667; val_global_loss: 39384754.9333; val_optim_loss: 39384754.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9354; val_auprc_score: 0.9233; val_best_acc_score: 0.8681; val_best_f1_score: 0.8739; train_kl_reg_loss: 137975.9485; train_edge_recon_loss: 2846116.7939; train_gene_expr_recon_loss: 21373651.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14872366.0382; train_global_loss: 39230109.8321; train_optim_loss: 39230109.8321; val_kl_reg_loss: 135318.4323; val_edge_recon_loss: 2831346.4667; val_gene_expr_recon_loss: 21243654.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14830402.1333; val_global_loss: 39040721.8667; val_optim_loss: 39040721.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9340; val_auprc_score: 0.9207; val_best_acc_score: 0.8680; val_best_f1_score: 0.8740; train_kl_reg_loss: 132154.4037; train_edge_recon_loss: 2835895.7615; train_gene_expr_recon_loss: 21276296.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14809882.8779; train_global_loss: 39054229.6183; train_optim_loss: 39054229.6183; val_kl_reg_loss: 131692.9417; val_edge_recon_loss: 2842457.4833; val_gene_expr_recon_loss: 21085072.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14732650.9333; val_global_loss: 38791873.8667; val_optim_loss: 38791873.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9418; val_auprc_score: 0.9318; val_best_acc_score: 0.8786; val_best_f1_score: 0.8850; train_kl_reg_loss: 128033.6055; train_edge_recon_loss: 2822001.0115; train_gene_expr_recon_loss: 21222522.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14793983.6260; train_global_loss: 38966540.4275; train_optim_loss: 38966540.4275; val_kl_reg_loss: 126584.3099; val_edge_recon_loss: 2822455.7667; val_gene_expr_recon_loss: 21174303.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14805276.0000; val_global_loss: 38928620.0000; val_optim_loss: 38928620.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9411; val_auprc_score: 0.9302; val_best_acc_score: 0.8764; val_best_f1_score: 0.8814; train_kl_reg_loss: 125151.2678; train_edge_recon_loss: 2816995.0821; train_gene_expr_recon_loss: 21174746.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14777495.1832; train_global_loss: 38894388.4885; train_optim_loss: 38894388.4885; val_kl_reg_loss: 123568.8698; val_edge_recon_loss: 2823819.9000; val_gene_expr_recon_loss: 21044638.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14715945.0667; val_global_loss: 38707972.5333; val_optim_loss: 38707972.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9447; val_auprc_score: 0.9348; val_best_acc_score: 0.8802; val_best_f1_score: 0.8848; train_kl_reg_loss: 121525.0194; train_edge_recon_loss: 2795570.6069; train_gene_expr_recon_loss: 21096903.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14732694.7939; train_global_loss: 38746693.8626; train_optim_loss: 38746693.8626; val_kl_reg_loss: 116240.2109; val_edge_recon_loss: 2824914.9167; val_gene_expr_recon_loss: 21037118.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14783170.1333; val_global_loss: 38761444.0000; val_optim_loss: 38761444.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9474; val_auprc_score: 0.9366; val_best_acc_score: 0.8859; val_best_f1_score: 0.8899; train_kl_reg_loss: 117739.7035; train_edge_recon_loss: 2774237.2844; train_gene_expr_recon_loss: 21044427.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14698464.8473; train_global_loss: 38634868.8244; train_optim_loss: 38634868.8244; val_kl_reg_loss: 113430.8604; val_edge_recon_loss: 2798094.8833; val_gene_expr_recon_loss: 20919580.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14651403.8000; val_global_loss: 38482509.8667; val_optim_loss: 38482509.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9532; val_auprc_score: 0.9444; val_best_acc_score: 0.8897; val_best_f1_score: 0.8927; train_kl_reg_loss: 115051.9651; train_edge_recon_loss: 2773996.9561; train_gene_expr_recon_loss: 21006456.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14690137.7786; train_global_loss: 38585642.6565; train_optim_loss: 38585642.6565; val_kl_reg_loss: 112316.3807; val_edge_recon_loss: 2790535.7000; val_gene_expr_recon_loss: 20963374.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14727848.8667; val_global_loss: 38594075.7333; val_optim_loss: 38594075.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9550; val_auprc_score: 0.9446; val_best_acc_score: 0.8946; val_best_f1_score: 0.8982; train_kl_reg_loss: 111964.2323; train_edge_recon_loss: 2768825.8855; train_gene_expr_recon_loss: 20943378.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14662382.5878; train_global_loss: 38486551.0229; train_optim_loss: 38486551.0229; val_kl_reg_loss: 108650.6948; val_edge_recon_loss: 2793414.0667; val_gene_expr_recon_loss: 20805248.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14605081.6667; val_global_loss: 38312394.4000; val_optim_loss: 38312394.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9603; val_auprc_score: 0.9503; val_best_acc_score: 0.9045; val_best_f1_score: 0.9067; train_kl_reg_loss: 109486.7742; train_edge_recon_loss: 2750448.8836; train_gene_expr_recon_loss: 20880677.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14633132.6870; train_global_loss: 38373746.1679; train_optim_loss: 38373746.1679; val_kl_reg_loss: 109438.2469; val_edge_recon_loss: 2752361.3000; val_gene_expr_recon_loss: 20811585.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14589998.6667; val_global_loss: 38263382.9333; val_optim_loss: 38263382.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9610; val_auprc_score: 0.9510; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 107273.0772; train_edge_recon_loss: 2755344.9943; train_gene_expr_recon_loss: 20841622.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14602191.0534; train_global_loss: 38306431.8168; train_optim_loss: 38306431.8168; val_kl_reg_loss: 108153.5526; val_edge_recon_loss: 2754888.9833; val_gene_expr_recon_loss: 20695161.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14560332.1333; val_global_loss: 38118536.8000; val_optim_loss: 38118536.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9651; val_auprc_score: 0.9574; val_best_acc_score: 0.9103; val_best_f1_score: 0.9120; train_kl_reg_loss: 105189.5695; train_edge_recon_loss: 2741177.1374; train_gene_expr_recon_loss: 20773455.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14572691.4275; train_global_loss: 38192514.0763; train_optim_loss: 38192514.0763; val_kl_reg_loss: 102626.7646; val_edge_recon_loss: 2757378.4333; val_gene_expr_recon_loss: 20751919.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14587838.6000; val_global_loss: 38199763.7333; val_optim_loss: 38199763.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9681; val_auprc_score: 0.9591; val_best_acc_score: 0.9177; val_best_f1_score: 0.9203; train_kl_reg_loss: 101657.5727; train_edge_recon_loss: 2740180.3149; train_gene_expr_recon_loss: 20780813.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14579595.9542; train_global_loss: 38202247.3282; train_optim_loss: 38202247.3282; val_kl_reg_loss: 102034.3531; val_edge_recon_loss: 2741626.7833; val_gene_expr_recon_loss: 20650643.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14486990.2000; val_global_loss: 37981294.9333; val_optim_loss: 37981294.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9686; val_auprc_score: 0.9596; val_best_acc_score: 0.9150; val_best_f1_score: 0.9177; train_kl_reg_loss: 100412.1498; train_edge_recon_loss: 2732323.7519; train_gene_expr_recon_loss: 20729669.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14563936.6794; train_global_loss: 38126341.6489; train_optim_loss: 38126341.6489; val_kl_reg_loss: 97885.6792; val_edge_recon_loss: 2747260.9167; val_gene_expr_recon_loss: 20662804.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14500588.0667; val_global_loss: 38008538.9333; val_optim_loss: 38008538.9333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9711; val_auprc_score: 0.9640; val_best_acc_score: 0.9181; val_best_f1_score: 0.9201; train_kl_reg_loss: 98410.3062; train_edge_recon_loss: 2726301.2634; train_gene_expr_recon_loss: 20718592.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14570937.0076; train_global_loss: 38114240.9771; train_optim_loss: 38114240.9771; val_kl_reg_loss: 96983.4990; val_edge_recon_loss: 2728089.9167; val_gene_expr_recon_loss: 20531747.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14461360.1333; val_global_loss: 37818180.8000; val_optim_loss: 37818180.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9737; val_auprc_score: 0.9677; val_best_acc_score: 0.9256; val_best_f1_score: 0.9274; train_kl_reg_loss: 96467.4580; train_edge_recon_loss: 2725481.7977; train_gene_expr_recon_loss: 20691033.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14558441.5344; train_global_loss: 38071423.8473; train_optim_loss: 38071423.8473; val_kl_reg_loss: 95628.5672; val_edge_recon_loss: 2724969.9000; val_gene_expr_recon_loss: 20624329.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14568137.4000; val_global_loss: 38013065.8667; val_optim_loss: 38013065.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9719; val_auprc_score: 0.9647; val_best_acc_score: 0.9206; val_best_f1_score: 0.9227; train_kl_reg_loss: 95074.8721; train_edge_recon_loss: 2720940.6164; train_gene_expr_recon_loss: 20630932.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14521542.7786; train_global_loss: 37968490.2901; train_optim_loss: 37968490.2901; val_kl_reg_loss: 91640.9500; val_edge_recon_loss: 2740011.8333; val_gene_expr_recon_loss: 20572045.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14527920.6667; val_global_loss: 37931618.4000; val_optim_loss: 37931618.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9724; val_auprc_score: 0.9663; val_best_acc_score: 0.9224; val_best_f1_score: 0.9244; train_kl_reg_loss: 93415.4736; train_edge_recon_loss: 2720569.1679; train_gene_expr_recon_loss: 20603642.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14511532.2977; train_global_loss: 37929159.9389; train_optim_loss: 37929159.9389; val_kl_reg_loss: 93367.3068; val_edge_recon_loss: 2739426.3500; val_gene_expr_recon_loss: 20514275.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14502335.8000; val_global_loss: 37849405.0667; val_optim_loss: 37849405.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9758; val_auprc_score: 0.9694; val_best_acc_score: 0.9283; val_best_f1_score: 0.9307; train_kl_reg_loss: 93684.9810; train_edge_recon_loss: 2732314.7004; train_gene_expr_recon_loss: 20959781.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14699737.5954; train_global_loss: 38485518.6260; train_optim_loss: 38485518.6260; val_kl_reg_loss: 67993.7698; val_edge_recon_loss: 2728145.0333; val_gene_expr_recon_loss: 20810253.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14578407.5333; val_global_loss: 38184799.4667; val_optim_loss: 38184799.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9741; val_auprc_score: 0.9671; val_best_acc_score: 0.9244; val_best_f1_score: 0.9268; train_kl_reg_loss: 94938.4886; train_edge_recon_loss: 2720029.3836; train_gene_expr_recon_loss: 20898555.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14657180.7099; train_global_loss: 38370704.0611; train_optim_loss: 38370704.0611; val_kl_reg_loss: 69738.2359; val_edge_recon_loss: 2747239.5333; val_gene_expr_recon_loss: 20863124.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14675618.0000; val_global_loss: 38355720.8000; val_optim_loss: 38355720.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9761; val_auprc_score: 0.9723; val_best_acc_score: 0.9223; val_best_f1_score: 0.9241; train_kl_reg_loss: 95197.9708; train_edge_recon_loss: 2725970.2519; train_gene_expr_recon_loss: 20892377.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14649958.3130; train_global_loss: 38363504.4580; train_optim_loss: 38363504.4580; val_kl_reg_loss: 69093.0260; val_edge_recon_loss: 2732679.2500; val_gene_expr_recon_loss: 20829913.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14596837.6667; val_global_loss: 38228522.9333; val_optim_loss: 38228522.9333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9741; val_auprc_score: 0.9693; val_best_acc_score: 0.9216; val_best_f1_score: 0.9248; train_kl_reg_loss: 94253.4203; train_edge_recon_loss: 2721822.3855; train_gene_expr_recon_loss: 20904869.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14647863.9389; train_global_loss: 38368809.1298; train_optim_loss: 38368809.1298; val_kl_reg_loss: 69317.1859; val_edge_recon_loss: 2726208.3667; val_gene_expr_recon_loss: 20808221.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14607489.8000; val_global_loss: 38211237.0667; val_optim_loss: 38211237.0667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9727; val_auprc_score: 0.9652; val_best_acc_score: 0.9201; val_best_f1_score: 0.9227; train_kl_reg_loss: 94059.7672; train_edge_recon_loss: 2713727.2004; train_gene_expr_recon_loss: 20872553.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14634079.7328; train_global_loss: 38314419.6031; train_optim_loss: 38314419.6031; val_kl_reg_loss: 69139.7417; val_edge_recon_loss: 2739041.5833; val_gene_expr_recon_loss: 20740824.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14513990.4667; val_global_loss: 38062997.3333; val_optim_loss: 38062997.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 45 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9716
val AUPRC score: 0.9659
val best accuracy score: 0.9178
val best F1 score: 0.9192
val target rna MSE score: 1.0466
val source rna MSE score: 13.3211
val target atac MSE score: 0.3403
val source atac MSE score: 2.8185
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
