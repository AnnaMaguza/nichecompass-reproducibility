[True]
Run timestamp: 10102023_132428_279.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_279']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6949; val_auprc_score: 0.6769; val_best_acc_score: 0.5083; val_best_f1_score: 0.6702; train_kl_reg_loss: 86598.3257; train_edge_recon_loss: 766137.3220; train_gene_expr_recon_loss: 22887145.2121; train_masked_gp_l1_reg_loss: 37621.9654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3968500.3902; train_chrom_access_recon_loss: 11432305.0455; train_global_loss: 39178308.3030; train_optim_loss: 39178308.3030; val_kl_reg_loss: 106740.5459; val_edge_recon_loss: 812970.1172; val_gene_expr_recon_loss: 21601106.0000; val_masked_gp_l1_reg_loss: 41235.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2586304.7500; val_chrom_access_recon_loss: 11142375.2500; val_global_loss: 36290732.0000; val_optim_loss: 36290732.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7317; val_auprc_score: 0.7137; val_best_acc_score: 0.6112; val_best_f1_score: 0.7060; train_kl_reg_loss: 101957.8965; train_edge_recon_loss: 755653.1723; train_gene_expr_recon_loss: 21189602.7273; train_masked_gp_l1_reg_loss: 41521.8902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1620671.8201; train_chrom_access_recon_loss: 10972899.8333; train_global_loss: 34682307.3333; train_optim_loss: 34682307.3333; val_kl_reg_loss: 98248.6387; val_edge_recon_loss: 811391.3672; val_gene_expr_recon_loss: 21265156.2500; val_masked_gp_l1_reg_loss: 41954.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 916558.1250; val_chrom_access_recon_loss: 11110553.0000; val_global_loss: 34243861.5000; val_optim_loss: 34243861.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8081; val_auprc_score: 0.7829; val_best_acc_score: 0.7211; val_best_f1_score: 0.7207; train_kl_reg_loss: 88148.9330; train_edge_recon_loss: 742193.8134; train_gene_expr_recon_loss: 20971055.7576; train_masked_gp_l1_reg_loss: 42642.8388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 622908.3755; train_chrom_access_recon_loss: 10885558.5000; train_global_loss: 33352508.5152; train_optim_loss: 33352508.5152; val_kl_reg_loss: 83263.8340; val_edge_recon_loss: 801823.9688; val_gene_expr_recon_loss: 21076799.5000; val_masked_gp_l1_reg_loss: 43560.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 424316.9688; val_chrom_access_recon_loss: 10997746.8750; val_global_loss: 33427510.0000; val_optim_loss: 33427510.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8555; val_auprc_score: 0.8311; val_best_acc_score: 0.7832; val_best_f1_score: 0.7969; train_kl_reg_loss: 78417.7163; train_edge_recon_loss: 728318.8617; train_gene_expr_recon_loss: 20819984.1818; train_masked_gp_l1_reg_loss: 44557.5018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 336001.8281; train_chrom_access_recon_loss: 10820116.5758; train_global_loss: 32827396.4545; train_optim_loss: 32827396.4545; val_kl_reg_loss: 77125.0293; val_edge_recon_loss: 767730.4453; val_gene_expr_recon_loss: 20940338.2500; val_masked_gp_l1_reg_loss: 45624.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 269639.3438; val_chrom_access_recon_loss: 10925629.0000; val_global_loss: 33026086.7500; val_optim_loss: 33026086.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8697; val_auprc_score: 0.8361; val_best_acc_score: 0.7982; val_best_f1_score: 0.8168; train_kl_reg_loss: 73887.2364; train_edge_recon_loss: 701185.8125; train_gene_expr_recon_loss: 20667250.5152; train_masked_gp_l1_reg_loss: 46569.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231799.8364; train_chrom_access_recon_loss: 10752594.3485; train_global_loss: 32473287.1212; train_optim_loss: 32473287.1212; val_kl_reg_loss: 76373.1221; val_edge_recon_loss: 690414.3203; val_gene_expr_recon_loss: 20783492.5000; val_masked_gp_l1_reg_loss: 47723.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201467.1719; val_chrom_access_recon_loss: 10950459.7500; val_global_loss: 32749931.5000; val_optim_loss: 32749931.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8872; val_auprc_score: 0.8584; val_best_acc_score: 0.8154; val_best_f1_score: 0.8327; train_kl_reg_loss: 80609.9621; train_edge_recon_loss: 654411.1098; train_gene_expr_recon_loss: 20546599.1818; train_masked_gp_l1_reg_loss: 48709.8127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180437.2675; train_chrom_access_recon_loss: 10698052.7121; train_global_loss: 32208820.0909; train_optim_loss: 32208820.0909; val_kl_reg_loss: 84263.2734; val_edge_recon_loss: 637688.7109; val_gene_expr_recon_loss: 20839759.5000; val_masked_gp_l1_reg_loss: 49757.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161875.7812; val_chrom_access_recon_loss: 10981984.7500; val_global_loss: 32755330.0000; val_optim_loss: 32755330.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8936; val_auprc_score: 0.8633; val_best_acc_score: 0.8189; val_best_f1_score: 0.8382; train_kl_reg_loss: 81022.7637; train_edge_recon_loss: 637720.8144; train_gene_expr_recon_loss: 20439236.7576; train_masked_gp_l1_reg_loss: 50709.2904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148839.9384; train_chrom_access_recon_loss: 10649343.0303; train_global_loss: 32006872.5152; train_optim_loss: 32006872.5152; val_kl_reg_loss: 80524.3164; val_edge_recon_loss: 631512.4609; val_gene_expr_recon_loss: 20621114.2500; val_masked_gp_l1_reg_loss: 51723.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137774.2188; val_chrom_access_recon_loss: 10824338.8750; val_global_loss: 32346987.7500; val_optim_loss: 32346987.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8975; val_auprc_score: 0.8704; val_best_acc_score: 0.8289; val_best_f1_score: 0.8434; train_kl_reg_loss: 79242.3543; train_edge_recon_loss: 623907.9706; train_gene_expr_recon_loss: 20346230.9394; train_masked_gp_l1_reg_loss: 52457.6718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128440.5375; train_chrom_access_recon_loss: 10606490.6515; train_global_loss: 31836770.1818; train_optim_loss: 31836770.1818; val_kl_reg_loss: 77770.7891; val_edge_recon_loss: 624527.3438; val_gene_expr_recon_loss: 20490182.7500; val_masked_gp_l1_reg_loss: 53350.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120730.3359; val_chrom_access_recon_loss: 10850600.6250; val_global_loss: 32217161.2500; val_optim_loss: 32217161.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8994; val_auprc_score: 0.8614; val_best_acc_score: 0.8313; val_best_f1_score: 0.8471; train_kl_reg_loss: 77447.8385; train_edge_recon_loss: 616695.6534; train_gene_expr_recon_loss: 20254390.9091; train_masked_gp_l1_reg_loss: 54023.4270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114880.5638; train_chrom_access_recon_loss: 10557092.4697; train_global_loss: 31674530.9091; train_optim_loss: 31674530.9091; val_kl_reg_loss: 76301.2871; val_edge_recon_loss: 615137.7422; val_gene_expr_recon_loss: 20539510.5000; val_masked_gp_l1_reg_loss: 54663.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109786.1953; val_chrom_access_recon_loss: 10782894.8750; val_global_loss: 32178294.0000; val_optim_loss: 32178294.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9067; val_auprc_score: 0.8767; val_best_acc_score: 0.8412; val_best_f1_score: 0.8526; train_kl_reg_loss: 75795.9877; train_edge_recon_loss: 611241.4735; train_gene_expr_recon_loss: 20184266.1212; train_masked_gp_l1_reg_loss: 55312.4563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105685.9715; train_chrom_access_recon_loss: 10518346.1970; train_global_loss: 31550648.3939; train_optim_loss: 31550648.3939; val_kl_reg_loss: 73473.0205; val_edge_recon_loss: 609447.2891; val_gene_expr_recon_loss: 20270810.7500; val_masked_gp_l1_reg_loss: 56128.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102515.2891; val_chrom_access_recon_loss: 10574566.6250; val_global_loss: 31686941.7500; val_optim_loss: 31686941.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9185; val_auprc_score: 0.8939; val_best_acc_score: 0.8517; val_best_f1_score: 0.8623; train_kl_reg_loss: 73518.4566; train_edge_recon_loss: 609099.6269; train_gene_expr_recon_loss: 20110925.1818; train_masked_gp_l1_reg_loss: 56753.9353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99559.7978; train_chrom_access_recon_loss: 10486445.5758; train_global_loss: 31436302.5758; train_optim_loss: 31436302.5758; val_kl_reg_loss: 73119.4219; val_edge_recon_loss: 602297.2969; val_gene_expr_recon_loss: 20422468.5000; val_masked_gp_l1_reg_loss: 57274.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97356.2969; val_chrom_access_recon_loss: 10667657.7500; val_global_loss: 31920173.2500; val_optim_loss: 31920173.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9118; val_auprc_score: 0.8867; val_best_acc_score: 0.8375; val_best_f1_score: 0.8510; train_kl_reg_loss: 72259.4652; train_edge_recon_loss: 604416.7661; train_gene_expr_recon_loss: 20047261.4242; train_masked_gp_l1_reg_loss: 57791.7248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94910.2847; train_chrom_access_recon_loss: 10444265.3333; train_global_loss: 31320904.6667; train_optim_loss: 31320904.6667; val_kl_reg_loss: 71901.4561; val_edge_recon_loss: 608616.1875; val_gene_expr_recon_loss: 20182895.2500; val_masked_gp_l1_reg_loss: 58398.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93500.2422; val_chrom_access_recon_loss: 10580018.8750; val_global_loss: 31595329.7500; val_optim_loss: 31595329.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9157; val_auprc_score: 0.8944; val_best_acc_score: 0.8509; val_best_f1_score: 0.8611; train_kl_reg_loss: 70531.3131; train_edge_recon_loss: 602680.5720; train_gene_expr_recon_loss: 19968101.9697; train_masked_gp_l1_reg_loss: 58950.1450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91864.0496; train_chrom_access_recon_loss: 10402818.5455; train_global_loss: 31194946.5455; train_optim_loss: 31194946.5455; val_kl_reg_loss: 68461.5723; val_edge_recon_loss: 605386.7266; val_gene_expr_recon_loss: 20060299.2500; val_masked_gp_l1_reg_loss: 59471.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90803.8750; val_chrom_access_recon_loss: 10565447.2500; val_global_loss: 31449871.0000; val_optim_loss: 31449871.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9252; val_auprc_score: 0.9058; val_best_acc_score: 0.8581; val_best_f1_score: 0.8678; train_kl_reg_loss: 69089.9799; train_edge_recon_loss: 601390.9375; train_gene_expr_recon_loss: 19906283.8788; train_masked_gp_l1_reg_loss: 59864.4912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89711.3848; train_chrom_access_recon_loss: 10358149.5455; train_global_loss: 31084490.0909; train_optim_loss: 31084490.0909; val_kl_reg_loss: 69267.8457; val_edge_recon_loss: 608563.4688; val_gene_expr_recon_loss: 19789835.5000; val_masked_gp_l1_reg_loss: 60210.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88990.2109; val_chrom_access_recon_loss: 10418904.2500; val_global_loss: 31035770.7500; val_optim_loss: 31035770.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9299; val_auprc_score: 0.9126; val_best_acc_score: 0.8598; val_best_f1_score: 0.8698; train_kl_reg_loss: 67735.8246; train_edge_recon_loss: 600137.7509; train_gene_expr_recon_loss: 19858363.8182; train_masked_gp_l1_reg_loss: 60747.0123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88650.2740; train_chrom_access_recon_loss: 10326038.1364; train_global_loss: 31001672.7273; train_optim_loss: 31001672.7273; val_kl_reg_loss: 66386.3569; val_edge_recon_loss: 599561.8125; val_gene_expr_recon_loss: 19907380.5000; val_masked_gp_l1_reg_loss: 61248.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88328.5859; val_chrom_access_recon_loss: 10449141.1250; val_global_loss: 31172046.0000; val_optim_loss: 31172046.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9326; val_auprc_score: 0.9139; val_best_acc_score: 0.8705; val_best_f1_score: 0.8785; train_kl_reg_loss: 67020.3917; train_edge_recon_loss: 593459.2528; train_gene_expr_recon_loss: 19785420.0303; train_masked_gp_l1_reg_loss: 61618.3378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88311.0542; train_chrom_access_recon_loss: 10291198.9091; train_global_loss: 30887027.9394; train_optim_loss: 30887027.9394; val_kl_reg_loss: 64237.2124; val_edge_recon_loss: 597457.1797; val_gene_expr_recon_loss: 19909659.5000; val_masked_gp_l1_reg_loss: 62178.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88258.9766; val_chrom_access_recon_loss: 10487474.1250; val_global_loss: 31209263.7500; val_optim_loss: 31209263.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9394; val_auprc_score: 0.9208; val_best_acc_score: 0.8769; val_best_f1_score: 0.8845; train_kl_reg_loss: 66263.4439; train_edge_recon_loss: 594178.8570; train_gene_expr_recon_loss: 19733893.4545; train_masked_gp_l1_reg_loss: 62513.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87973.1773; train_chrom_access_recon_loss: 10252178.2727; train_global_loss: 30797000.8485; train_optim_loss: 30797000.8485; val_kl_reg_loss: 65168.8491; val_edge_recon_loss: 594959.2578; val_gene_expr_recon_loss: 19979194.5000; val_masked_gp_l1_reg_loss: 62977.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87774.7344; val_chrom_access_recon_loss: 10468976.3750; val_global_loss: 31259051.5000; val_optim_loss: 31259051.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9430; val_auprc_score: 0.9276; val_best_acc_score: 0.8842; val_best_f1_score: 0.8897; train_kl_reg_loss: 65327.6841; train_edge_recon_loss: 591875.7604; train_gene_expr_recon_loss: 19669022.8182; train_masked_gp_l1_reg_loss: 63277.6336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87187.2274; train_chrom_access_recon_loss: 10205480.4394; train_global_loss: 30682171.4242; train_optim_loss: 30682171.4242; val_kl_reg_loss: 64926.8149; val_edge_recon_loss: 595167.4141; val_gene_expr_recon_loss: 19904421.2500; val_masked_gp_l1_reg_loss: 63696.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87178.3203; val_chrom_access_recon_loss: 10371041.8750; val_global_loss: 31086431.5000; val_optim_loss: 31086431.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9392; val_auprc_score: 0.9200; val_best_acc_score: 0.8826; val_best_f1_score: 0.8897; train_kl_reg_loss: 65047.1100; train_edge_recon_loss: 589829.3381; train_gene_expr_recon_loss: 19643049.1212; train_masked_gp_l1_reg_loss: 63167.2366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70213.8001; train_chrom_access_recon_loss: 10169129.7576; train_global_loss: 30600436.4545; train_optim_loss: 30600436.4545; val_kl_reg_loss: 66250.4351; val_edge_recon_loss: 587822.6172; val_gene_expr_recon_loss: 19797705.0000; val_masked_gp_l1_reg_loss: 62850.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64873.6875; val_chrom_access_recon_loss: 10405226.0000; val_global_loss: 30984728.2500; val_optim_loss: 30984728.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9390; val_auprc_score: 0.9219; val_best_acc_score: 0.8796; val_best_f1_score: 0.8855; train_kl_reg_loss: 65711.6754; train_edge_recon_loss: 590556.8911; train_gene_expr_recon_loss: 19632524.6364; train_masked_gp_l1_reg_loss: 62806.5374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64173.8638; train_chrom_access_recon_loss: 10170735.6515; train_global_loss: 30586509.4242; train_optim_loss: 30586509.4242; val_kl_reg_loss: 66169.9941; val_edge_recon_loss: 593340.6797; val_gene_expr_recon_loss: 19880258.2500; val_masked_gp_l1_reg_loss: 62771.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63699.6133; val_chrom_access_recon_loss: 10417243.6250; val_global_loss: 31083485.0000; val_optim_loss: 31083485.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9368; val_auprc_score: 0.9170; val_best_acc_score: 0.8778; val_best_f1_score: 0.8846; train_kl_reg_loss: 65936.9817; train_edge_recon_loss: 587816.0568; train_gene_expr_recon_loss: 19610652.8182; train_masked_gp_l1_reg_loss: 62777.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63366.3441; train_chrom_access_recon_loss: 10147968.7424; train_global_loss: 30538518.6970; train_optim_loss: 30538518.6970; val_kl_reg_loss: 66336.1309; val_edge_recon_loss: 595450.7734; val_gene_expr_recon_loss: 19854359.7500; val_masked_gp_l1_reg_loss: 62794.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63157.3984; val_chrom_access_recon_loss: 10366777.6250; val_global_loss: 31008876.5000; val_optim_loss: 31008876.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9328; val_auprc_score: 0.9093; val_best_acc_score: 0.8737; val_best_f1_score: 0.8820; train_kl_reg_loss: 65834.6667; train_edge_recon_loss: 588228.8220; train_gene_expr_recon_loss: 19626678.4242; train_masked_gp_l1_reg_loss: 62825.8988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62879.9144; train_chrom_access_recon_loss: 10151880.2879; train_global_loss: 30558327.9697; train_optim_loss: 30558327.9697; val_kl_reg_loss: 66810.3711; val_edge_recon_loss: 593951.2734; val_gene_expr_recon_loss: 19860647.7500; val_masked_gp_l1_reg_loss: 62856.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62697.6914; val_chrom_access_recon_loss: 10450683.5000; val_global_loss: 31097646.5000; val_optim_loss: 31097646.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9430; val_auprc_score: 0.9232; val_best_acc_score: 0.8898; val_best_f1_score: 0.8956; train_kl_reg_loss: 65900.8401; train_edge_recon_loss: 588344.9261; train_gene_expr_recon_loss: 19600154.0000; train_masked_gp_l1_reg_loss: 62898.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62464.0940; train_chrom_access_recon_loss: 10141003.8182; train_global_loss: 30520766.2424; train_optim_loss: 30520766.2424; val_kl_reg_loss: 66065.7764; val_edge_recon_loss: 583145.0078; val_gene_expr_recon_loss: 19778179.0000; val_masked_gp_l1_reg_loss: 62936.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62241.1836; val_chrom_access_recon_loss: 10325833.2500; val_global_loss: 30878400.7500; val_optim_loss: 30878400.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9227; val_best_acc_score: 0.8767; val_best_f1_score: 0.8844; train_kl_reg_loss: 65820.7337; train_edge_recon_loss: 586998.1420; train_gene_expr_recon_loss: 19601726.6364; train_masked_gp_l1_reg_loss: 62961.0471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61981.5845; train_chrom_access_recon_loss: 10147004.3939; train_global_loss: 30526492.6364; train_optim_loss: 30526492.6364; val_kl_reg_loss: 66227.8721; val_edge_recon_loss: 591879.4766; val_gene_expr_recon_loss: 19703023.5000; val_masked_gp_l1_reg_loss: 63007.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61885.7500; val_chrom_access_recon_loss: 10271924.2500; val_global_loss: 30757949.0000; val_optim_loss: 30757949.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9407; val_auprc_score: 0.9244; val_best_acc_score: 0.8810; val_best_f1_score: 0.8879; train_kl_reg_loss: 65787.5675; train_edge_recon_loss: 587532.7557; train_gene_expr_recon_loss: 19591412.9091; train_masked_gp_l1_reg_loss: 63056.8620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61671.8159; train_chrom_access_recon_loss: 10131344.6061; train_global_loss: 30500806.5455; train_optim_loss: 30500806.5455; val_kl_reg_loss: 66359.5879; val_edge_recon_loss: 594705.3281; val_gene_expr_recon_loss: 19816595.0000; val_masked_gp_l1_reg_loss: 63086.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61543.5078; val_chrom_access_recon_loss: 10390110.2500; val_global_loss: 30992400.0000; val_optim_loss: 30992400.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9420; val_auprc_score: 0.9247; val_best_acc_score: 0.8786; val_best_f1_score: 0.8845; train_kl_reg_loss: 65608.2511; train_edge_recon_loss: 588132.3731; train_gene_expr_recon_loss: 19610301.1212; train_masked_gp_l1_reg_loss: 63125.6705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61315.3005; train_chrom_access_recon_loss: 10145734.5303; train_global_loss: 30534217.0606; train_optim_loss: 30534217.0606; val_kl_reg_loss: 65843.2241; val_edge_recon_loss: 593572.8047; val_gene_expr_recon_loss: 19747911.7500; val_masked_gp_l1_reg_loss: 63179.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61151.0820; val_chrom_access_recon_loss: 10326492.8750; val_global_loss: 30858153.2500; val_optim_loss: 30858153.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9426; val_auprc_score: 0.9244; val_best_acc_score: 0.8804; val_best_f1_score: 0.8867; train_kl_reg_loss: 65493.8243; train_edge_recon_loss: 589199.8788; train_gene_expr_recon_loss: 19572593.3939; train_masked_gp_l1_reg_loss: 63219.8327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60946.0092; train_chrom_access_recon_loss: 10114769.7424; train_global_loss: 30466222.6667; train_optim_loss: 30466222.6667; val_kl_reg_loss: 66062.6313; val_edge_recon_loss: 591330.6250; val_gene_expr_recon_loss: 19788425.0000; val_masked_gp_l1_reg_loss: 63281.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60830.9609; val_chrom_access_recon_loss: 10314173.3750; val_global_loss: 30884104.0000; val_optim_loss: 30884104.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9380; val_auprc_score: 0.9163; val_best_acc_score: 0.8818; val_best_f1_score: 0.8876; train_kl_reg_loss: 65364.6632; train_edge_recon_loss: 588417.1714; train_gene_expr_recon_loss: 19587452.0303; train_masked_gp_l1_reg_loss: 63320.2523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60646.7053; train_chrom_access_recon_loss: 10128826.4697; train_global_loss: 30494027.3939; train_optim_loss: 30494027.3939; val_kl_reg_loss: 65957.8262; val_edge_recon_loss: 592345.6875; val_gene_expr_recon_loss: 19895840.7500; val_masked_gp_l1_reg_loss: 63360.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60521.5859; val_chrom_access_recon_loss: 10400181.6250; val_global_loss: 31078208.0000; val_optim_loss: 31078208.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9432; val_auprc_score: 0.9243; val_best_acc_score: 0.8872; val_best_f1_score: 0.8919; train_kl_reg_loss: 65271.7521; train_edge_recon_loss: 587857.3949; train_gene_expr_recon_loss: 19577991.0000; train_masked_gp_l1_reg_loss: 63303.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58736.9522; train_chrom_access_recon_loss: 10118335.1212; train_global_loss: 30471495.6667; train_optim_loss: 30471495.6667; val_kl_reg_loss: 66281.7192; val_edge_recon_loss: 591864.3906; val_gene_expr_recon_loss: 19890902.5000; val_masked_gp_l1_reg_loss: 63263.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58113.3242; val_chrom_access_recon_loss: 10352116.7500; val_global_loss: 31022543.5000; val_optim_loss: 31022543.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9317; val_auprc_score: 0.9058; val_best_acc_score: 0.8791; val_best_f1_score: 0.8851; train_kl_reg_loss: 65253.5231; train_edge_recon_loss: 586130.0691; train_gene_expr_recon_loss: 19572062.6970; train_masked_gp_l1_reg_loss: 63253.4061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58001.1407; train_chrom_access_recon_loss: 10113654.2273; train_global_loss: 30458355.2121; train_optim_loss: 30458355.2121; val_kl_reg_loss: 65815.3921; val_edge_recon_loss: 596898.1016; val_gene_expr_recon_loss: 19830472.7500; val_masked_gp_l1_reg_loss: 63245.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57922.7266; val_chrom_access_recon_loss: 10351381.7500; val_global_loss: 30965735.7500; val_optim_loss: 30965735.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9472; val_auprc_score: 0.9366; val_best_acc_score: 0.8858; val_best_f1_score: 0.8908; train_kl_reg_loss: 65295.2534; train_edge_recon_loss: 587319.0758; train_gene_expr_recon_loss: 19568087.1515; train_masked_gp_l1_reg_loss: 63243.9789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57877.5819; train_chrom_access_recon_loss: 10114880.5455; train_global_loss: 30456703.8788; train_optim_loss: 30456703.8788; val_kl_reg_loss: 66080.9385; val_edge_recon_loss: 590862.4219; val_gene_expr_recon_loss: 19860780.5000; val_masked_gp_l1_reg_loss: 63244.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57837.3945; val_chrom_access_recon_loss: 10429304.3750; val_global_loss: 31068110.5000; val_optim_loss: 31068110.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9411; val_auprc_score: 0.9235; val_best_acc_score: 0.8804; val_best_f1_score: 0.8862; train_kl_reg_loss: 65392.2430; train_edge_recon_loss: 584532.5189; train_gene_expr_recon_loss: 19566129.2727; train_masked_gp_l1_reg_loss: 63246.4731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57802.6178; train_chrom_access_recon_loss: 10112186.5758; train_global_loss: 30449289.5758; train_optim_loss: 30449289.5758; val_kl_reg_loss: 65851.2607; val_edge_recon_loss: 596101.2109; val_gene_expr_recon_loss: 19726067.7500; val_masked_gp_l1_reg_loss: 63247.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57775.9102; val_chrom_access_recon_loss: 10297612.2500; val_global_loss: 30806656.2500; val_optim_loss: 30806656.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 29 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9307
val AUPRC score: 0.9099
val best accuracy score: 0.8732
val best F1 score: 0.8816
val target rna MSE score: 1.3108
val source rna MSE score: 0.8247
val target atac MSE score: 0.3324
val source atac MSE score: 0.1313
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
