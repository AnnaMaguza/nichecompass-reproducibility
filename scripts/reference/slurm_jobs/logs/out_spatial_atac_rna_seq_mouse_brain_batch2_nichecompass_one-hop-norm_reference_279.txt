[True]
Run timestamp: 07092023_060126_279.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_279']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 984 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4613, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7395; val_auprc_score: 0.7683; val_best_acc_score: 0.5353; val_best_f1_score: 0.6786; train_kl_reg_loss: 59561.4624; train_edge_recon_loss: 3552628.3779; train_gene_expr_recon_loss: 15180950.6107; train_masked_gp_l1_reg_loss: 41247.3428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4268780.0661; train_chrom_access_recon_loss: 5742907.9275; train_global_loss: 28846075.6794; train_optim_loss: 28846075.6794; val_kl_reg_loss: 93619.7167; val_edge_recon_loss: 4062749.7000; val_gene_expr_recon_loss: 14270486.2667; val_masked_gp_l1_reg_loss: 39429.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 321733.0625; val_chrom_access_recon_loss: 5555671.2667; val_global_loss: 24343690.8000; val_optim_loss: 24343690.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7741; val_auprc_score: 0.7897; val_best_acc_score: 0.6545; val_best_f1_score: 0.7259; train_kl_reg_loss: 89003.8812; train_edge_recon_loss: 3519144.7844; train_gene_expr_recon_loss: 13981663.2137; train_masked_gp_l1_reg_loss: 38680.8885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224023.6601; train_chrom_access_recon_loss: 5486839.1641; train_global_loss: 23339355.4962; train_optim_loss: 23339355.4962; val_kl_reg_loss: 84581.8370; val_edge_recon_loss: 4052272.4500; val_gene_expr_recon_loss: 13937113.6667; val_masked_gp_l1_reg_loss: 38828.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177947.7656; val_chrom_access_recon_loss: 5450656.2333; val_global_loss: 23741400.2667; val_optim_loss: 23741400.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8061; val_auprc_score: 0.8075; val_best_acc_score: 0.7173; val_best_f1_score: 0.7373; train_kl_reg_loss: 79439.5997; train_edge_recon_loss: 3504344.9008; train_gene_expr_recon_loss: 13740994.1374; train_masked_gp_l1_reg_loss: 39414.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152266.1917; train_chrom_access_recon_loss: 5409857.3855; train_global_loss: 22926316.2901; train_optim_loss: 22926316.2901; val_kl_reg_loss: 74240.2188; val_edge_recon_loss: 3988938.2833; val_gene_expr_recon_loss: 13757845.4667; val_masked_gp_l1_reg_loss: 40477.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137116.3125; val_chrom_access_recon_loss: 5409465.2333; val_global_loss: 23408083.3333; val_optim_loss: 23408083.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8043; val_auprc_score: 0.8152; val_best_acc_score: 0.7079; val_best_f1_score: 0.7457; train_kl_reg_loss: 71305.0783; train_edge_recon_loss: 3324502.6813; train_gene_expr_recon_loss: 13558067.6947; train_masked_gp_l1_reg_loss: 42010.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126552.7750; train_chrom_access_recon_loss: 5351546.7137; train_global_loss: 22473985.4504; train_optim_loss: 22473985.4504; val_kl_reg_loss: 86646.4828; val_edge_recon_loss: 3201223.5667; val_gene_expr_recon_loss: 13657529.0667; val_masked_gp_l1_reg_loss: 43751.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119692.7578; val_chrom_access_recon_loss: 5352150.0333; val_global_loss: 22460993.2000; val_optim_loss: 22460993.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8394; val_auprc_score: 0.8432; val_best_acc_score: 0.7387; val_best_f1_score: 0.7660; train_kl_reg_loss: 94930.9856; train_edge_recon_loss: 3057384.9542; train_gene_expr_recon_loss: 13418962.6412; train_masked_gp_l1_reg_loss: 45443.0730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114573.1283; train_chrom_access_recon_loss: 5296599.4351; train_global_loss: 22027894.3053; train_optim_loss: 22027894.3053; val_kl_reg_loss: 99421.1479; val_edge_recon_loss: 3076012.0167; val_gene_expr_recon_loss: 13441491.9333; val_masked_gp_l1_reg_loss: 47027.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110865.0156; val_chrom_access_recon_loss: 5325225.0000; val_global_loss: 22100043.7333; val_optim_loss: 22100043.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8678; val_auprc_score: 0.8699; val_best_acc_score: 0.7767; val_best_f1_score: 0.7773; train_kl_reg_loss: 96079.4034; train_edge_recon_loss: 2994735.6527; train_gene_expr_recon_loss: 13297456.7099; train_masked_gp_l1_reg_loss: 48380.5293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108144.3372; train_chrom_access_recon_loss: 5252215.4580; train_global_loss: 21797012.0916; train_optim_loss: 21797012.0916; val_kl_reg_loss: 90628.6693; val_edge_recon_loss: 3008252.8167; val_gene_expr_recon_loss: 13343414.7333; val_masked_gp_l1_reg_loss: 49749.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105892.4453; val_chrom_access_recon_loss: 5251449.0667; val_global_loss: 21849386.4000; val_optim_loss: 21849386.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8911; val_auprc_score: 0.8841; val_best_acc_score: 0.8089; val_best_f1_score: 0.8156; train_kl_reg_loss: 89344.1934; train_edge_recon_loss: 2967684.5515; train_gene_expr_recon_loss: 13187605.0000; train_masked_gp_l1_reg_loss: 50684.0891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103508.9236; train_chrom_access_recon_loss: 5208897.3931; train_global_loss: 21607724.2290; train_optim_loss: 21607724.2290; val_kl_reg_loss: 78619.2422; val_edge_recon_loss: 2958873.2333; val_gene_expr_recon_loss: 13275975.8667; val_masked_gp_l1_reg_loss: 51691.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102791.4219; val_chrom_access_recon_loss: 5224916.7333; val_global_loss: 21692868.1333; val_optim_loss: 21692868.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9268; val_auprc_score: 0.9144; val_best_acc_score: 0.8601; val_best_f1_score: 0.8689; train_kl_reg_loss: 88666.4298; train_edge_recon_loss: 2845993.4332; train_gene_expr_recon_loss: 13092776.8015; train_masked_gp_l1_reg_loss: 52747.3475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102407.6982; train_chrom_access_recon_loss: 5170335.8626; train_global_loss: 21352927.5878; train_optim_loss: 21352927.5878; val_kl_reg_loss: 93894.5635; val_edge_recon_loss: 2820487.5667; val_gene_expr_recon_loss: 13179937.1333; val_masked_gp_l1_reg_loss: 53890.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101887.8750; val_chrom_access_recon_loss: 5178935.8333; val_global_loss: 21429032.9333; val_optim_loss: 21429032.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9321; val_auprc_score: 0.9199; val_best_acc_score: 0.8665; val_best_f1_score: 0.8723; train_kl_reg_loss: 93856.7188; train_edge_recon_loss: 2797817.2004; train_gene_expr_recon_loss: 12999907.7252; train_masked_gp_l1_reg_loss: 54796.0042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100734.1937; train_chrom_access_recon_loss: 5134182.0649; train_global_loss: 21181294.0000; train_optim_loss: 21181294.0000; val_kl_reg_loss: 88737.0432; val_edge_recon_loss: 2819510.1667; val_gene_expr_recon_loss: 13090558.6667; val_masked_gp_l1_reg_loss: 55736.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99993.1641; val_chrom_access_recon_loss: 5134891.3333; val_global_loss: 21289426.4000; val_optim_loss: 21289426.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9308; val_auprc_score: 0.9151; val_best_acc_score: 0.8692; val_best_f1_score: 0.8762; train_kl_reg_loss: 92187.4651; train_edge_recon_loss: 2795801.9332; train_gene_expr_recon_loss: 12937932.9466; train_masked_gp_l1_reg_loss: 56395.6131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99088.7892; train_chrom_access_recon_loss: 5109151.2137; train_global_loss: 21090558.0000; train_optim_loss: 21090558.0000; val_kl_reg_loss: 90802.8766; val_edge_recon_loss: 2825133.9667; val_gene_expr_recon_loss: 13042035.6000; val_masked_gp_l1_reg_loss: 57112.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98174.0859; val_chrom_access_recon_loss: 5113725.9333; val_global_loss: 21226985.4667; val_optim_loss: 21226985.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9307; val_auprc_score: 0.9111; val_best_acc_score: 0.8721; val_best_f1_score: 0.8787; train_kl_reg_loss: 90782.3573; train_edge_recon_loss: 2791046.7634; train_gene_expr_recon_loss: 12849811.9160; train_masked_gp_l1_reg_loss: 57735.7217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98766.6139; train_chrom_access_recon_loss: 5073923.8931; train_global_loss: 20962067.1450; train_optim_loss: 20962067.1450; val_kl_reg_loss: 87248.9979; val_edge_recon_loss: 2787254.4000; val_gene_expr_recon_loss: 12937189.0000; val_masked_gp_l1_reg_loss: 58540.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99583.2344; val_chrom_access_recon_loss: 5090123.3667; val_global_loss: 21059938.9333; val_optim_loss: 21059938.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9387; val_auprc_score: 0.9251; val_best_acc_score: 0.8797; val_best_f1_score: 0.8865; train_kl_reg_loss: 87721.9498; train_edge_recon_loss: 2781774.9809; train_gene_expr_recon_loss: 12803854.5878; train_masked_gp_l1_reg_loss: 59072.7753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100315.8132; train_chrom_access_recon_loss: 5054977.4046; train_global_loss: 20887717.4809; train_optim_loss: 20887717.4809; val_kl_reg_loss: 85987.2177; val_edge_recon_loss: 2778003.1333; val_gene_expr_recon_loss: 12873742.0667; val_masked_gp_l1_reg_loss: 59584.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101938.7344; val_chrom_access_recon_loss: 5050021.8667; val_global_loss: 20949277.3333; val_optim_loss: 20949277.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9360; val_auprc_score: 0.9200; val_best_acc_score: 0.8793; val_best_f1_score: 0.8858; train_kl_reg_loss: 86366.3349; train_edge_recon_loss: 2771209.0038; train_gene_expr_recon_loss: 12731966.7557; train_masked_gp_l1_reg_loss: 60162.4390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102881.6650; train_chrom_access_recon_loss: 5028727.6489; train_global_loss: 20781313.6794; train_optim_loss: 20781313.6794; val_kl_reg_loss: 84321.9401; val_edge_recon_loss: 2795819.0500; val_gene_expr_recon_loss: 12859355.4667; val_masked_gp_l1_reg_loss: 60644.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103903.5938; val_chrom_access_recon_loss: 5052189.9667; val_global_loss: 20956234.4000; val_optim_loss: 20956234.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9385; val_auprc_score: 0.9260; val_best_acc_score: 0.8813; val_best_f1_score: 0.8882; train_kl_reg_loss: 84311.6109; train_edge_recon_loss: 2766794.6355; train_gene_expr_recon_loss: 12686850.4275; train_masked_gp_l1_reg_loss: 61091.7191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104653.9883; train_chrom_access_recon_loss: 5010728.9466; train_global_loss: 20714431.3282; train_optim_loss: 20714431.3282; val_kl_reg_loss: 82721.0495; val_edge_recon_loss: 2785169.5500; val_gene_expr_recon_loss: 12730621.4000; val_masked_gp_l1_reg_loss: 61547.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105657.6875; val_chrom_access_recon_loss: 5010746.1667; val_global_loss: 20776464.1333; val_optim_loss: 20776464.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9388; val_auprc_score: 0.9189; val_best_acc_score: 0.8856; val_best_f1_score: 0.8918; train_kl_reg_loss: 83232.1596; train_edge_recon_loss: 2762915.5935; train_gene_expr_recon_loss: 12627880.2672; train_masked_gp_l1_reg_loss: 61957.0671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106401.2792; train_chrom_access_recon_loss: 4991209.5115; train_global_loss: 20633595.9542; train_optim_loss: 20633595.9542; val_kl_reg_loss: 82072.8354; val_edge_recon_loss: 2777387.0833; val_gene_expr_recon_loss: 12732728.8000; val_masked_gp_l1_reg_loss: 62260.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106880.8125; val_chrom_access_recon_loss: 5026255.8333; val_global_loss: 20787586.2667; val_optim_loss: 20787586.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9429; val_auprc_score: 0.9256; val_best_acc_score: 0.8901; val_best_f1_score: 0.8949; train_kl_reg_loss: 81807.6029; train_edge_recon_loss: 2755770.6183; train_gene_expr_recon_loss: 12586439.9008; train_masked_gp_l1_reg_loss: 62700.9783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107778.4277; train_chrom_access_recon_loss: 4973482.2786; train_global_loss: 20567979.7252; train_optim_loss: 20567979.7252; val_kl_reg_loss: 79766.3870; val_edge_recon_loss: 2764609.7333; val_gene_expr_recon_loss: 12642448.4000; val_masked_gp_l1_reg_loss: 63147.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107671.7031; val_chrom_access_recon_loss: 4978202.4333; val_global_loss: 20635846.0000; val_optim_loss: 20635846.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9455; val_auprc_score: 0.9347; val_best_acc_score: 0.8860; val_best_f1_score: 0.8910; train_kl_reg_loss: 81722.6914; train_edge_recon_loss: 2745095.0172; train_gene_expr_recon_loss: 12552747.1450; train_masked_gp_l1_reg_loss: 63495.8322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108580.7533; train_chrom_access_recon_loss: 4959463.7977; train_global_loss: 20511105.3435; train_optim_loss: 20511105.3435; val_kl_reg_loss: 80769.5630; val_edge_recon_loss: 2762730.7333; val_gene_expr_recon_loss: 12655439.4667; val_masked_gp_l1_reg_loss: 63920.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109499.8359; val_chrom_access_recon_loss: 4979233.6333; val_global_loss: 20651593.4667; val_optim_loss: 20651593.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9471; val_auprc_score: 0.9348; val_best_acc_score: 0.8859; val_best_f1_score: 0.8930; train_kl_reg_loss: 82051.2838; train_edge_recon_loss: 2749196.6317; train_gene_expr_recon_loss: 12499897.4885; train_masked_gp_l1_reg_loss: 64244.6685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108965.5756; train_chrom_access_recon_loss: 4941210.3397; train_global_loss: 20445565.9389; train_optim_loss: 20445565.9389; val_kl_reg_loss: 82386.9031; val_edge_recon_loss: 2756491.4667; val_gene_expr_recon_loss: 12581110.0000; val_masked_gp_l1_reg_loss: 64499.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108100.2734; val_chrom_access_recon_loss: 4967700.0333; val_global_loss: 20560287.4667; val_optim_loss: 20560287.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9503; val_auprc_score: 0.9392; val_best_acc_score: 0.8925; val_best_f1_score: 0.8972; train_kl_reg_loss: 81107.9635; train_edge_recon_loss: 2734130.5000; train_gene_expr_recon_loss: 12476184.0534; train_masked_gp_l1_reg_loss: 64883.0080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108988.2352; train_chrom_access_recon_loss: 4930696.2481; train_global_loss: 20395989.9695; train_optim_loss: 20395989.9695; val_kl_reg_loss: 78651.4307; val_edge_recon_loss: 2753612.9167; val_gene_expr_recon_loss: 12546477.6667; val_masked_gp_l1_reg_loss: 65154.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109472.1172; val_chrom_access_recon_loss: 4956691.4667; val_global_loss: 20510059.6000; val_optim_loss: 20510059.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9535; val_auprc_score: 0.9427; val_best_acc_score: 0.8946; val_best_f1_score: 0.9001; train_kl_reg_loss: 80883.5152; train_edge_recon_loss: 2731434.7099; train_gene_expr_recon_loss: 12434548.9389; train_masked_gp_l1_reg_loss: 65458.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108992.6563; train_chrom_access_recon_loss: 4917409.7710; train_global_loss: 20338728.2443; train_optim_loss: 20338728.2443; val_kl_reg_loss: 79871.0802; val_edge_recon_loss: 2722774.0000; val_gene_expr_recon_loss: 12567084.9333; val_masked_gp_l1_reg_loss: 65900.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109931.8984; val_chrom_access_recon_loss: 4940071.3667; val_global_loss: 20485634.4000; val_optim_loss: 20485634.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9545; val_auprc_score: 0.9419; val_best_acc_score: 0.8975; val_best_f1_score: 0.9027; train_kl_reg_loss: 79983.2779; train_edge_recon_loss: 2732552.2099; train_gene_expr_recon_loss: 12423359.5420; train_masked_gp_l1_reg_loss: 66160.9160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109169.1438; train_chrom_access_recon_loss: 4904601.4924; train_global_loss: 20315826.5038; train_optim_loss: 20315826.5038; val_kl_reg_loss: 79886.2125; val_edge_recon_loss: 2723892.9000; val_gene_expr_recon_loss: 12531905.8667; val_masked_gp_l1_reg_loss: 66417.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108466.3828; val_chrom_access_recon_loss: 4937812.5333; val_global_loss: 20448381.4667; val_optim_loss: 20448381.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9520; val_auprc_score: 0.9382; val_best_acc_score: 0.8965; val_best_f1_score: 0.9015; train_kl_reg_loss: 79505.7656; train_edge_recon_loss: 2717888.0057; train_gene_expr_recon_loss: 12393638.1298; train_masked_gp_l1_reg_loss: 66667.8550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108823.0877; train_chrom_access_recon_loss: 4893995.6603; train_global_loss: 20260518.5496; train_optim_loss: 20260518.5496; val_kl_reg_loss: 80808.4260; val_edge_recon_loss: 2740452.3500; val_gene_expr_recon_loss: 12508804.2000; val_masked_gp_l1_reg_loss: 66950.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109640.4766; val_chrom_access_recon_loss: 4919850.5667; val_global_loss: 20426505.4667; val_optim_loss: 20426505.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9541; val_auprc_score: 0.9421; val_best_acc_score: 0.8959; val_best_f1_score: 0.9004; train_kl_reg_loss: 78885.8353; train_edge_recon_loss: 2721963.0840; train_gene_expr_recon_loss: 12365990.3511; train_masked_gp_l1_reg_loss: 67236.3367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109266.4091; train_chrom_access_recon_loss: 4883111.0267; train_global_loss: 20226453.1298; train_optim_loss: 20226453.1298; val_kl_reg_loss: 79218.4875; val_edge_recon_loss: 2727915.5667; val_gene_expr_recon_loss: 12459712.5333; val_masked_gp_l1_reg_loss: 67571.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108571.6328; val_chrom_access_recon_loss: 4906987.0333; val_global_loss: 20349976.4000; val_optim_loss: 20349976.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9602; val_auprc_score: 0.9502; val_best_acc_score: 0.9011; val_best_f1_score: 0.9063; train_kl_reg_loss: 78031.4828; train_edge_recon_loss: 2712384.7805; train_gene_expr_recon_loss: 12351218.3206; train_masked_gp_l1_reg_loss: 67794.9577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109042.7557; train_chrom_access_recon_loss: 4879254.8435; train_global_loss: 20197727.0840; train_optim_loss: 20197727.0840; val_kl_reg_loss: 79008.9135; val_edge_recon_loss: 2712616.6167; val_gene_expr_recon_loss: 12482598.8667; val_masked_gp_l1_reg_loss: 68133.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109710.2422; val_chrom_access_recon_loss: 4903844.3667; val_global_loss: 20355911.7333; val_optim_loss: 20355911.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9594; val_auprc_score: 0.9463; val_best_acc_score: 0.8988; val_best_f1_score: 0.9043; train_kl_reg_loss: 78132.2958; train_edge_recon_loss: 2714069.0344; train_gene_expr_recon_loss: 12326288.9466; train_masked_gp_l1_reg_loss: 68391.8810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109343.5143; train_chrom_access_recon_loss: 4865723.1718; train_global_loss: 20161948.8702; train_optim_loss: 20161948.8702; val_kl_reg_loss: 77959.7891; val_edge_recon_loss: 2738883.6833; val_gene_expr_recon_loss: 12454942.8667; val_masked_gp_l1_reg_loss: 68707.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109811.7500; val_chrom_access_recon_loss: 4900866.8000; val_global_loss: 20351172.1333; val_optim_loss: 20351172.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9641; val_auprc_score: 0.9543; val_best_acc_score: 0.9061; val_best_f1_score: 0.9106; train_kl_reg_loss: 81408.7609; train_edge_recon_loss: 2727608.7824; train_gene_expr_recon_loss: 12028145.9084; train_masked_gp_l1_reg_loss: 67485.1728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108208.9670; train_chrom_access_recon_loss: 4764074.1107; train_global_loss: 19776931.7863; train_optim_loss: 19776931.7863; val_kl_reg_loss: 57520.8773; val_edge_recon_loss: 2714189.6167; val_gene_expr_recon_loss: 12150515.3333; val_masked_gp_l1_reg_loss: 67127.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108521.6641; val_chrom_access_recon_loss: 4777820.3667; val_global_loss: 19875695.4667; val_optim_loss: 19875695.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9616; val_auprc_score: 0.9501; val_best_acc_score: 0.9050; val_best_f1_score: 0.9087; train_kl_reg_loss: 82480.1310; train_edge_recon_loss: 2711424.2958; train_gene_expr_recon_loss: 11988685.3740; train_masked_gp_l1_reg_loss: 66963.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108881.5908; train_chrom_access_recon_loss: 4746988.8893; train_global_loss: 19705423.5878; train_optim_loss: 19705423.5878; val_kl_reg_loss: 60117.6596; val_edge_recon_loss: 2717268.3000; val_gene_expr_recon_loss: 12088366.1333; val_masked_gp_l1_reg_loss: 66912.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109948.1328; val_chrom_access_recon_loss: 4750073.6000; val_global_loss: 19792685.4667; val_optim_loss: 19792685.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9664; val_auprc_score: 0.9577; val_best_acc_score: 0.9126; val_best_f1_score: 0.9159; train_kl_reg_loss: 79039.4077; train_edge_recon_loss: 2703712.0763; train_gene_expr_recon_loss: 11952885.8931; train_masked_gp_l1_reg_loss: 66894.3316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109046.7298; train_chrom_access_recon_loss: 4724858.0000; train_global_loss: 19636436.2901; train_optim_loss: 19636436.2901; val_kl_reg_loss: 62452.7253; val_edge_recon_loss: 2703703.3167; val_gene_expr_recon_loss: 12042816.1333; val_masked_gp_l1_reg_loss: 66795.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108493.1172; val_chrom_access_recon_loss: 4729043.5667; val_global_loss: 19713304.9333; val_optim_loss: 19713304.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9683; val_auprc_score: 0.9598; val_best_acc_score: 0.9150; val_best_f1_score: 0.9185; train_kl_reg_loss: 77174.6648; train_edge_recon_loss: 2700800.3760; train_gene_expr_recon_loss: 11913882.0076; train_masked_gp_l1_reg_loss: 66694.7138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108610.7765; train_chrom_access_recon_loss: 4708615.4218; train_global_loss: 19575777.8931; train_optim_loss: 19575777.8931; val_kl_reg_loss: 64919.2352; val_edge_recon_loss: 2696607.0000; val_gene_expr_recon_loss: 11965968.6000; val_masked_gp_l1_reg_loss: 66653.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109656.3984; val_chrom_access_recon_loss: 4709941.0333; val_global_loss: 19613746.1333; val_optim_loss: 19613746.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9675; val_auprc_score: 0.9554; val_best_acc_score: 0.9185; val_best_f1_score: 0.9214; train_kl_reg_loss: 74835.3915; train_edge_recon_loss: 2697762.9141; train_gene_expr_recon_loss: 11885925.5954; train_masked_gp_l1_reg_loss: 66513.2194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108349.0531; train_chrom_access_recon_loss: 4703349.6031; train_global_loss: 19536735.8168; train_optim_loss: 19536735.8168; val_kl_reg_loss: 65348.6169; val_edge_recon_loss: 2699175.7833; val_gene_expr_recon_loss: 12014205.2000; val_masked_gp_l1_reg_loss: 66382.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107778.5938; val_chrom_access_recon_loss: 4731435.2333; val_global_loss: 19684325.7333; val_optim_loss: 19684325.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9692; val_auprc_score: 0.9596; val_best_acc_score: 0.9185; val_best_f1_score: 0.9221; train_kl_reg_loss: 73979.5550; train_edge_recon_loss: 2691232.4141; train_gene_expr_recon_loss: 11866863.6031; train_masked_gp_l1_reg_loss: 66300.9631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107937.7648; train_chrom_access_recon_loss: 4693796.9084; train_global_loss: 19500111.1908; train_optim_loss: 19500111.1908; val_kl_reg_loss: 64382.3701; val_edge_recon_loss: 2703221.2833; val_gene_expr_recon_loss: 11939723.7333; val_masked_gp_l1_reg_loss: 66230.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107492.6016; val_chrom_access_recon_loss: 4695868.9333; val_global_loss: 19576920.5333; val_optim_loss: 19576920.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9681; val_auprc_score: 0.9582; val_best_acc_score: 0.9206; val_best_f1_score: 0.9239; train_kl_reg_loss: 72652.2774; train_edge_recon_loss: 2692103.7328; train_gene_expr_recon_loss: 11845211.6794; train_masked_gp_l1_reg_loss: 66172.9026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107816.0687; train_chrom_access_recon_loss: 4689728.9885; train_global_loss: 19473685.6336; train_optim_loss: 19473685.6336; val_kl_reg_loss: 64737.6609; val_edge_recon_loss: 2697253.4333; val_gene_expr_recon_loss: 11951794.6000; val_masked_gp_l1_reg_loss: 66169.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107734.7109; val_chrom_access_recon_loss: 4730205.7667; val_global_loss: 19617896.4000; val_optim_loss: 19617896.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9678; val_auprc_score: 0.9559; val_best_acc_score: 0.9201; val_best_f1_score: 0.9234; train_kl_reg_loss: 72046.4129; train_edge_recon_loss: 2690031.5897; train_gene_expr_recon_loss: 11833339.0916; train_masked_gp_l1_reg_loss: 66132.5075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107524.2691; train_chrom_access_recon_loss: 4684924.3588; train_global_loss: 19453998.3664; train_optim_loss: 19453998.3664; val_kl_reg_loss: 65336.7844; val_edge_recon_loss: 2719832.6833; val_gene_expr_recon_loss: 11958452.9333; val_masked_gp_l1_reg_loss: 66093.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107690.0469; val_chrom_access_recon_loss: 4714490.9000; val_global_loss: 19631896.1333; val_optim_loss: 19631896.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9734; val_auprc_score: 0.9667; val_best_acc_score: 0.9248; val_best_f1_score: 0.9265; train_kl_reg_loss: 71394.3609; train_edge_recon_loss: 2687780.1966; train_gene_expr_recon_loss: 11815397.1756; train_masked_gp_l1_reg_loss: 66063.8349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107378.7193; train_chrom_access_recon_loss: 4682602.0725; train_global_loss: 19430616.2137; train_optim_loss: 19430616.2137; val_kl_reg_loss: 66128.2956; val_edge_recon_loss: 2695829.2333; val_gene_expr_recon_loss: 11950618.0000; val_masked_gp_l1_reg_loss: 66016.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107850.3203; val_chrom_access_recon_loss: 4709619.1667; val_global_loss: 19596060.6667; val_optim_loss: 19596060.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9721; val_auprc_score: 0.9643; val_best_acc_score: 0.9283; val_best_f1_score: 0.9309; train_kl_reg_loss: 70422.5156; train_edge_recon_loss: 2684417.7805; train_gene_expr_recon_loss: 11802162.0992; train_masked_gp_l1_reg_loss: 66047.8207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107261.5929; train_chrom_access_recon_loss: 4676708.3492; train_global_loss: 19407020.1527; train_optim_loss: 19407020.1527; val_kl_reg_loss: 66680.5979; val_edge_recon_loss: 2697242.5833; val_gene_expr_recon_loss: 11951577.7333; val_masked_gp_l1_reg_loss: 66116.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107458.6562; val_chrom_access_recon_loss: 4703695.5333; val_global_loss: 19592772.4000; val_optim_loss: 19592772.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9739; val_auprc_score: 0.9647; val_best_acc_score: 0.9293; val_best_f1_score: 0.9315; train_kl_reg_loss: 72069.5979; train_edge_recon_loss: 2681366.3912; train_gene_expr_recon_loss: 11785623.0840; train_masked_gp_l1_reg_loss: 65689.9218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81133.9031; train_chrom_access_recon_loss: 4670259.1870; train_global_loss: 19356142.0763; train_optim_loss: 19356142.0763; val_kl_reg_loss: 68146.6323; val_edge_recon_loss: 2696237.4667; val_gene_expr_recon_loss: 11901704.9333; val_masked_gp_l1_reg_loss: 65513.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78085.2344; val_chrom_access_recon_loss: 4698126.5333; val_global_loss: 19507814.4000; val_optim_loss: 19507814.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9745; val_auprc_score: 0.9689; val_best_acc_score: 0.9235; val_best_f1_score: 0.9260; train_kl_reg_loss: 72668.7987; train_edge_recon_loss: 2681633.3740; train_gene_expr_recon_loss: 11783696.3588; train_masked_gp_l1_reg_loss: 65450.6577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77706.7631; train_chrom_access_recon_loss: 4666868.5344; train_global_loss: 19348024.5344; train_optim_loss: 19348024.5344; val_kl_reg_loss: 68959.1807; val_edge_recon_loss: 2700905.6333; val_gene_expr_recon_loss: 11938438.6667; val_masked_gp_l1_reg_loss: 65394.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77297.3047; val_chrom_access_recon_loss: 4706583.3000; val_global_loss: 19557578.8000; val_optim_loss: 19557578.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9735; val_auprc_score: 0.9668; val_best_acc_score: 0.9258; val_best_f1_score: 0.9295; train_kl_reg_loss: 73371.4240; train_edge_recon_loss: 2679354.3302; train_gene_expr_recon_loss: 11791157.9924; train_masked_gp_l1_reg_loss: 65365.4816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77071.5072; train_chrom_access_recon_loss: 4673945.6527; train_global_loss: 19360266.4733; train_optim_loss: 19360266.4733; val_kl_reg_loss: 69062.1755; val_edge_recon_loss: 2689688.2500; val_gene_expr_recon_loss: 11905945.6667; val_masked_gp_l1_reg_loss: 65333.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76890.8438; val_chrom_access_recon_loss: 4702227.1667; val_global_loss: 19509147.3333; val_optim_loss: 19509147.3333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9716; val_auprc_score: 0.9616; val_best_acc_score: 0.9251; val_best_f1_score: 0.9284; train_kl_reg_loss: 73796.7643; train_edge_recon_loss: 2674578.5076; train_gene_expr_recon_loss: 11784515.0458; train_masked_gp_l1_reg_loss: 65320.6495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76799.5797; train_chrom_access_recon_loss: 4667351.5897; train_global_loss: 19342362.2290; train_optim_loss: 19342362.2290; val_kl_reg_loss: 69058.2615; val_edge_recon_loss: 2700941.3000; val_gene_expr_recon_loss: 11857956.2000; val_masked_gp_l1_reg_loss: 65295.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76505.9609; val_chrom_access_recon_loss: 4689170.5000; val_global_loss: 19458927.3333; val_optim_loss: 19458927.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9771; val_auprc_score: 0.9715; val_best_acc_score: 0.9320; val_best_f1_score: 0.9342; train_kl_reg_loss: 73555.2879; train_edge_recon_loss: 2678136.0954; train_gene_expr_recon_loss: 11787550.0916; train_masked_gp_l1_reg_loss: 65277.8299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76305.2749; train_chrom_access_recon_loss: 4670925.8511; train_global_loss: 19351750.3664; train_optim_loss: 19351750.3664; val_kl_reg_loss: 70544.8578; val_edge_recon_loss: 2681541.4500; val_gene_expr_recon_loss: 11905512.7333; val_masked_gp_l1_reg_loss: 65261.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76224.3281; val_chrom_access_recon_loss: 4692115.4667; val_global_loss: 19491199.4667; val_optim_loss: 19491199.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9771; val_auprc_score: 0.9710; val_best_acc_score: 0.9326; val_best_f1_score: 0.9342; train_kl_reg_loss: 73932.4978; train_edge_recon_loss: 2675786.1813; train_gene_expr_recon_loss: 11783073.0458; train_masked_gp_l1_reg_loss: 65256.6987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76068.4272; train_chrom_access_recon_loss: 4670756.1908; train_global_loss: 19344873.0076; train_optim_loss: 19344873.0076; val_kl_reg_loss: 69740.4984; val_edge_recon_loss: 2693770.0167; val_gene_expr_recon_loss: 11839167.0000; val_masked_gp_l1_reg_loss: 65235.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75910.2344; val_chrom_access_recon_loss: 4669077.4667; val_global_loss: 19412900.0000; val_optim_loss: 19412900.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9752; val_auprc_score: 0.9662; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 73191.3323; train_edge_recon_loss: 2683666.7500; train_gene_expr_recon_loss: 11780613.8855; train_masked_gp_l1_reg_loss: 65229.3503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75802.9785; train_chrom_access_recon_loss: 4669796.6221; train_global_loss: 19348300.9618; train_optim_loss: 19348300.9618; val_kl_reg_loss: 69829.7437; val_edge_recon_loss: 2680541.3333; val_gene_expr_recon_loss: 11925237.9333; val_masked_gp_l1_reg_loss: 65214.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75721.5859; val_chrom_access_recon_loss: 4701959.1667; val_global_loss: 19518504.4000; val_optim_loss: 19518504.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9754; val_auprc_score: 0.9681; val_best_acc_score: 0.9328; val_best_f1_score: 0.9354; train_kl_reg_loss: 73358.0549; train_edge_recon_loss: 2678756.0592; train_gene_expr_recon_loss: 11780848.0305; train_masked_gp_l1_reg_loss: 65212.9972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75650.2207; train_chrom_access_recon_loss: 4669932.0534; train_global_loss: 19343757.5115; train_optim_loss: 19343757.5115; val_kl_reg_loss: 70065.9661; val_edge_recon_loss: 2683860.7000; val_gene_expr_recon_loss: 11873305.5333; val_masked_gp_l1_reg_loss: 65196.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75270.2969; val_chrom_access_recon_loss: 4682411.0000; val_global_loss: 19450109.4667; val_optim_loss: 19450109.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9744; val_auprc_score: 0.9668; val_best_acc_score: 0.9278; val_best_f1_score: 0.9307; train_kl_reg_loss: 73567.9046; train_edge_recon_loss: 2683915.8798; train_gene_expr_recon_loss: 11779458.9237; train_masked_gp_l1_reg_loss: 65192.6791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75263.4618; train_chrom_access_recon_loss: 4669052.7405; train_global_loss: 19346451.5725; train_optim_loss: 19346451.5725; val_kl_reg_loss: 70053.2578; val_edge_recon_loss: 2704622.8333; val_gene_expr_recon_loss: 11898253.6667; val_masked_gp_l1_reg_loss: 65180.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75091.3203; val_chrom_access_recon_loss: 4710391.9000; val_global_loss: 19523593.2000; val_optim_loss: 19523593.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9750; val_auprc_score: 0.9667; val_best_acc_score: 0.9299; val_best_f1_score: 0.9324; train_kl_reg_loss: 73873.6272; train_edge_recon_loss: 2680163.7385; train_gene_expr_recon_loss: 11782226.1832; train_masked_gp_l1_reg_loss: 65173.3665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75159.1203; train_chrom_access_recon_loss: 4669344.9084; train_global_loss: 19345940.9466; train_optim_loss: 19345940.9466; val_kl_reg_loss: 69997.2380; val_edge_recon_loss: 2688869.0667; val_gene_expr_recon_loss: 11892914.0667; val_masked_gp_l1_reg_loss: 65158.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75184.0156; val_chrom_access_recon_loss: 4691807.3667; val_global_loss: 19483929.4667; val_optim_loss: 19483929.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9762; val_auprc_score: 0.9668; val_best_acc_score: 0.9274; val_best_f1_score: 0.9301; train_kl_reg_loss: 73426.9863; train_edge_recon_loss: 2680909.3950; train_gene_expr_recon_loss: 11776872.9160; train_masked_gp_l1_reg_loss: 65112.6457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72219.2432; train_chrom_access_recon_loss: 4666626.3626; train_global_loss: 19335167.5267; train_optim_loss: 19335167.5267; val_kl_reg_loss: 70622.4859; val_edge_recon_loss: 2685799.5333; val_gene_expr_recon_loss: 11867960.0000; val_masked_gp_l1_reg_loss: 65091.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71862.5625; val_chrom_access_recon_loss: 4677735.9000; val_global_loss: 19439072.0000; val_optim_loss: 19439072.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9761; val_auprc_score: 0.9641; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 73525.7865; train_edge_recon_loss: 2674240.2882; train_gene_expr_recon_loss: 11774401.8855; train_masked_gp_l1_reg_loss: 65081.6832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71806.3459; train_chrom_access_recon_loss: 4670675.3321; train_global_loss: 19329731.2977; train_optim_loss: 19329731.2977; val_kl_reg_loss: 70402.5318; val_edge_recon_loss: 2672654.1833; val_gene_expr_recon_loss: 11856762.2667; val_masked_gp_l1_reg_loss: 65071.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71753.1719; val_chrom_access_recon_loss: 4705246.6667; val_global_loss: 19441890.2667; val_optim_loss: 19441890.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9746; val_auprc_score: 0.9679; val_best_acc_score: 0.9293; val_best_f1_score: 0.9314; train_kl_reg_loss: 73527.6772; train_edge_recon_loss: 2677311.2710; train_gene_expr_recon_loss: 11768554.4580; train_masked_gp_l1_reg_loss: 65066.9432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71688.9230; train_chrom_access_recon_loss: 4662477.5038; train_global_loss: 19318626.7939; train_optim_loss: 19318626.7939; val_kl_reg_loss: 70227.5255; val_edge_recon_loss: 2677592.5000; val_gene_expr_recon_loss: 11847966.9333; val_masked_gp_l1_reg_loss: 65060.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71663.3281; val_chrom_access_recon_loss: 4676484.9000; val_global_loss: 19408995.7333; val_optim_loss: 19408995.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9762; val_auprc_score: 0.9671; val_best_acc_score: 0.9328; val_best_f1_score: 0.9350; train_kl_reg_loss: 73444.0013; train_edge_recon_loss: 2671221.8187; train_gene_expr_recon_loss: 11775183.6336; train_masked_gp_l1_reg_loss: 65057.6811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71625.7651; train_chrom_access_recon_loss: 4666257.4084; train_global_loss: 19322790.4122; train_optim_loss: 19322790.4122; val_kl_reg_loss: 69774.7734; val_edge_recon_loss: 2676772.7167; val_gene_expr_recon_loss: 11879158.2667; val_masked_gp_l1_reg_loss: 65054.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71607.3750; val_chrom_access_recon_loss: 4678715.8333; val_global_loss: 19441082.6667; val_optim_loss: 19441082.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9761; val_auprc_score: 0.9699; val_best_acc_score: 0.9298; val_best_f1_score: 0.9328; train_kl_reg_loss: 73466.7211; train_edge_recon_loss: 2678017.2595; train_gene_expr_recon_loss: 11779876.3969; train_masked_gp_l1_reg_loss: 65051.6639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71586.7668; train_chrom_access_recon_loss: 4670672.7824; train_global_loss: 19338671.6183; train_optim_loss: 19338671.6183; val_kl_reg_loss: 70648.6458; val_edge_recon_loss: 2678142.5833; val_gene_expr_recon_loss: 11893132.0000; val_masked_gp_l1_reg_loss: 65048.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71568.3594; val_chrom_access_recon_loss: 4714505.0000; val_global_loss: 19493045.4667; val_optim_loss: 19493045.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9766; val_auprc_score: 0.9690; val_best_acc_score: 0.9337; val_best_f1_score: 0.9360; train_kl_reg_loss: 73679.8596; train_edge_recon_loss: 2675040.2653; train_gene_expr_recon_loss: 11767256.5191; train_masked_gp_l1_reg_loss: 65046.4119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71538.9946; train_chrom_access_recon_loss: 4664822.7443; train_global_loss: 19317384.8855; train_optim_loss: 19317384.8855; val_kl_reg_loss: 70506.4818; val_edge_recon_loss: 2676262.8667; val_gene_expr_recon_loss: 11922864.4667; val_masked_gp_l1_reg_loss: 65043.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71517.6562; val_chrom_access_recon_loss: 4693678.8000; val_global_loss: 19499874.5333; val_optim_loss: 19499874.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9760; val_auprc_score: 0.9692; val_best_acc_score: 0.9274; val_best_f1_score: 0.9298; train_kl_reg_loss: 73450.2889; train_edge_recon_loss: 2676696.6927; train_gene_expr_recon_loss: 11770736.7939; train_masked_gp_l1_reg_loss: 65041.6634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71511.3044; train_chrom_access_recon_loss: 4664690.0802; train_global_loss: 19322126.8244; train_optim_loss: 19322126.8244; val_kl_reg_loss: 70258.3609; val_edge_recon_loss: 2683724.8500; val_gene_expr_recon_loss: 11925943.2000; val_masked_gp_l1_reg_loss: 65039.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71494.5859; val_chrom_access_recon_loss: 4722645.6333; val_global_loss: 19539106.1333; val_optim_loss: 19539106.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9727; val_auprc_score: 0.9651; val_best_acc_score: 0.9254; val_best_f1_score: 0.9283; train_kl_reg_loss: 73229.4189; train_edge_recon_loss: 2675410.2328; train_gene_expr_recon_loss: 11763015.6260; train_masked_gp_l1_reg_loss: 65035.0884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71208.6792; train_chrom_access_recon_loss: 4665104.4809; train_global_loss: 19313003.4504; train_optim_loss: 19313003.4504; val_kl_reg_loss: 70129.4328; val_edge_recon_loss: 2704441.2000; val_gene_expr_recon_loss: 11882978.6000; val_masked_gp_l1_reg_loss: 65032.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71177.0781; val_chrom_access_recon_loss: 4694367.3667; val_global_loss: 19488126.5333; val_optim_loss: 19488126.5333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9754; val_auprc_score: 0.9666; val_best_acc_score: 0.9298; val_best_f1_score: 0.9327; train_kl_reg_loss: 73290.1925; train_edge_recon_loss: 2686012.6355; train_gene_expr_recon_loss: 11770753.5649; train_masked_gp_l1_reg_loss: 65031.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71170.8766; train_chrom_access_recon_loss: 4666838.4924; train_global_loss: 19333097.6641; train_optim_loss: 19333097.6641; val_kl_reg_loss: 70161.0500; val_edge_recon_loss: 2678507.4667; val_gene_expr_recon_loss: 11889020.3333; val_masked_gp_l1_reg_loss: 65031.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71165.3516; val_chrom_access_recon_loss: 4692540.0000; val_global_loss: 19466424.8000; val_optim_loss: 19466424.8000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9764; val_auprc_score: 0.9684; val_best_acc_score: 0.9324; val_best_f1_score: 0.9347; train_kl_reg_loss: 73335.9642; train_edge_recon_loss: 2682858.1985; train_gene_expr_recon_loss: 11775372.1450; train_masked_gp_l1_reg_loss: 65030.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71163.1616; train_chrom_access_recon_loss: 4667003.7634; train_global_loss: 19334763.8473; train_optim_loss: 19334763.8473; val_kl_reg_loss: 70053.6156; val_edge_recon_loss: 2687118.5667; val_gene_expr_recon_loss: 11846671.0667; val_masked_gp_l1_reg_loss: 65029.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71158.3828; val_chrom_access_recon_loss: 4682057.0667; val_global_loss: 19422088.4000; val_optim_loss: 19422088.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9761; val_auprc_score: 0.9695; val_best_acc_score: 0.9293; val_best_f1_score: 0.9319; train_kl_reg_loss: 73344.0863; train_edge_recon_loss: 2674508.7366; train_gene_expr_recon_loss: 11764739.4427; train_masked_gp_l1_reg_loss: 65029.4604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71154.9173; train_chrom_access_recon_loss: 4661003.3779; train_global_loss: 19309779.9847; train_optim_loss: 19309779.9847; val_kl_reg_loss: 70518.6531; val_edge_recon_loss: 2702619.7333; val_gene_expr_recon_loss: 11890074.4667; val_masked_gp_l1_reg_loss: 65028.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71152.2812; val_chrom_access_recon_loss: 4689967.5667; val_global_loss: 19489361.0667; val_optim_loss: 19489361.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 36 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9751
val AUPRC score: 0.9666
val best accuracy score: 0.9302
val best F1 score: 0.9326
val target rna MSE score: 1.0723
val source rna MSE score: 0.3113
val target atac MSE score: 0.5049
val source atac MSE score: 0.0829
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
