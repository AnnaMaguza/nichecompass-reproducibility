[True]
Run timestamp: 07082023_202149_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9054; val_auprc_score: 0.9170; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 15758.8891; train_edge_recon_loss: 350451.5868; train_gene_expr_recon_loss: 629309.0625; train_masked_gp_l1_reg_loss: 8778.1154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266998.9618; train_global_loss: 1271296.6111; train_optim_loss: 1271296.6111; val_kl_reg_loss: 9943.7285; val_edge_recon_loss: 406504.3125; val_gene_expr_recon_loss: 597779.5625; val_masked_gp_l1_reg_loss: 7417.6958; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 265789.6875; val_global_loss: 1287435.0000; val_optim_loss: 1287435.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8867; val_auprc_score: 0.8946; val_best_acc_score: 0.5143; val_best_f1_score: 0.6730; train_kl_reg_loss: 12483.9163; train_edge_recon_loss: 356429.1667; train_gene_expr_recon_loss: 564233.8403; train_masked_gp_l1_reg_loss: 6976.3341; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261668.8681; train_global_loss: 1201792.1250; train_optim_loss: 1201792.1250; val_kl_reg_loss: 17300.9531; val_edge_recon_loss: 406441.3125; val_gene_expr_recon_loss: 547813.3750; val_masked_gp_l1_reg_loss: 6644.9468; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 261281.2031; val_global_loss: 1239481.7500; val_optim_loss: 1239481.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8798; val_auprc_score: 0.8803; val_best_acc_score: 0.5372; val_best_f1_score: 0.6833; train_kl_reg_loss: 16658.2738; train_edge_recon_loss: 358447.2118; train_gene_expr_recon_loss: 523400.6597; train_masked_gp_l1_reg_loss: 6679.7782; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257384.3281; train_global_loss: 1162570.2778; train_optim_loss: 1162570.2778; val_kl_reg_loss: 17776.1836; val_edge_recon_loss: 406309.2500; val_gene_expr_recon_loss: 516242.2812; val_masked_gp_l1_reg_loss: 6750.1895; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257355.4688; val_global_loss: 1204433.3750; val_optim_loss: 1204433.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8677; val_auprc_score: 0.8691; val_best_acc_score: 0.6001; val_best_f1_score: 0.7118; train_kl_reg_loss: 18506.1168; train_edge_recon_loss: 358572.9931; train_gene_expr_recon_loss: 498537.1285; train_masked_gp_l1_reg_loss: 6714.8397; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253849.9427; train_global_loss: 1136181.0417; train_optim_loss: 1136181.0417; val_kl_reg_loss: 17896.5488; val_edge_recon_loss: 405890.9062; val_gene_expr_recon_loss: 495368.3438; val_masked_gp_l1_reg_loss: 6629.4209; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254426.3438; val_global_loss: 1180211.6250; val_optim_loss: 1180211.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8819; val_auprc_score: 0.8787; val_best_acc_score: 0.7172; val_best_f1_score: 0.7727; train_kl_reg_loss: 19397.3711; train_edge_recon_loss: 358081.5556; train_gene_expr_recon_loss: 479544.7951; train_masked_gp_l1_reg_loss: 6561.8850; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252208.9045; train_global_loss: 1115794.4861; train_optim_loss: 1115794.4861; val_kl_reg_loss: 18420.8750; val_edge_recon_loss: 404659.5312; val_gene_expr_recon_loss: 479806.5625; val_masked_gp_l1_reg_loss: 6473.8213; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252184.4219; val_global_loss: 1161545.2500; val_optim_loss: 1161545.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8808; val_auprc_score: 0.8761; val_best_acc_score: 0.7959; val_best_f1_score: 0.8141; train_kl_reg_loss: 19532.7999; train_edge_recon_loss: 357528.8542; train_gene_expr_recon_loss: 469256.1562; train_masked_gp_l1_reg_loss: 6415.8033; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249426.6198; train_global_loss: 1102160.2222; train_optim_loss: 1102160.2222; val_kl_reg_loss: 18444.1094; val_edge_recon_loss: 402162.9375; val_gene_expr_recon_loss: 468830.7500; val_masked_gp_l1_reg_loss: 6346.8647; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250476.2500; val_global_loss: 1146261.0000; val_optim_loss: 1146261.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8873; val_auprc_score: 0.8796; val_best_acc_score: 0.7983; val_best_f1_score: 0.7857; train_kl_reg_loss: 19599.7880; train_edge_recon_loss: 356525.6597; train_gene_expr_recon_loss: 458240.5104; train_masked_gp_l1_reg_loss: 6314.7610; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246684.3872; train_global_loss: 1087365.1111; train_optim_loss: 1087365.1111; val_kl_reg_loss: 20958.5312; val_edge_recon_loss: 396620.5938; val_gene_expr_recon_loss: 459744.5625; val_masked_gp_l1_reg_loss: 6270.9688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249039.1875; val_global_loss: 1132633.7500; val_optim_loss: 1132633.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9085; val_auprc_score: 0.8931; val_best_acc_score: 0.8306; val_best_f1_score: 0.8357; train_kl_reg_loss: 19521.7945; train_edge_recon_loss: 353232.8229; train_gene_expr_recon_loss: 453394.9931; train_masked_gp_l1_reg_loss: 6257.0151; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246253.8177; train_global_loss: 1078660.4583; train_optim_loss: 1078660.4583; val_kl_reg_loss: 17477.3223; val_edge_recon_loss: 375907.9375; val_gene_expr_recon_loss: 457017.1562; val_masked_gp_l1_reg_loss: 6239.5791; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248269.1875; val_global_loss: 1104911.1250; val_optim_loss: 1104911.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9076; val_auprc_score: 0.8882; val_best_acc_score: 0.8301; val_best_f1_score: 0.8349; train_kl_reg_loss: 18924.0106; train_edge_recon_loss: 340877.4201; train_gene_expr_recon_loss: 448429.9028; train_masked_gp_l1_reg_loss: 6252.9719; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245786.8194; train_global_loss: 1060271.1181; train_optim_loss: 1060271.1181; val_kl_reg_loss: 21125.7305; val_edge_recon_loss: 332973.9062; val_gene_expr_recon_loss: 457915.8750; val_masked_gp_l1_reg_loss: 6264.4771; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247930.8281; val_global_loss: 1066210.8750; val_optim_loss: 1066210.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9011; val_auprc_score: 0.8845; val_best_acc_score: 0.8139; val_best_f1_score: 0.8261; train_kl_reg_loss: 26662.9946; train_edge_recon_loss: 316744.9653; train_gene_expr_recon_loss: 448811.8819; train_masked_gp_l1_reg_loss: 6300.3986; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245356.0573; train_global_loss: 1043876.2847; train_optim_loss: 1043876.2847; val_kl_reg_loss: 30654.5918; val_edge_recon_loss: 310837.9688; val_gene_expr_recon_loss: 453037.0000; val_masked_gp_l1_reg_loss: 6342.4761; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247043.0625; val_global_loss: 1047915.1250; val_optim_loss: 1047915.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9113; val_auprc_score: 0.8961; val_best_acc_score: 0.8266; val_best_f1_score: 0.8376; train_kl_reg_loss: 27811.2895; train_edge_recon_loss: 309612.7535; train_gene_expr_recon_loss: 443499.4201; train_masked_gp_l1_reg_loss: 6380.7592; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244822.1806; train_global_loss: 1032126.4236; train_optim_loss: 1032126.4236; val_kl_reg_loss: 25857.6836; val_edge_recon_loss: 308561.7188; val_gene_expr_recon_loss: 450876.1250; val_masked_gp_l1_reg_loss: 6425.8965; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246251.8594; val_global_loss: 1037973.2500; val_optim_loss: 1037973.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9191; val_auprc_score: 0.8966; val_best_acc_score: 0.8409; val_best_f1_score: 0.8506; train_kl_reg_loss: 27657.8286; train_edge_recon_loss: 304767.0382; train_gene_expr_recon_loss: 443046.5521; train_masked_gp_l1_reg_loss: 6468.0359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244774.8194; train_global_loss: 1026714.2708; train_optim_loss: 1026714.2708; val_kl_reg_loss: 26219.6309; val_edge_recon_loss: 303344.5938; val_gene_expr_recon_loss: 447246.7500; val_masked_gp_l1_reg_loss: 6508.8193; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245331.5625; val_global_loss: 1028651.3750; val_optim_loss: 1028651.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9287; val_auprc_score: 0.9033; val_best_acc_score: 0.8631; val_best_f1_score: 0.8691; train_kl_reg_loss: 26701.5484; train_edge_recon_loss: 302026.2500; train_gene_expr_recon_loss: 440490.2951; train_masked_gp_l1_reg_loss: 6541.2142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243405.9965; train_global_loss: 1019165.3056; train_optim_loss: 1019165.3056; val_kl_reg_loss: 26599.5625; val_edge_recon_loss: 300577.5938; val_gene_expr_recon_loss: 444398.1250; val_masked_gp_l1_reg_loss: 6569.2061; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244617.7969; val_global_loss: 1022762.2500; val_optim_loss: 1022762.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9370; val_auprc_score: 0.9226; val_best_acc_score: 0.8688; val_best_f1_score: 0.8751; train_kl_reg_loss: 26614.2237; train_edge_recon_loss: 299510.0104; train_gene_expr_recon_loss: 436263.1458; train_masked_gp_l1_reg_loss: 6602.7601; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242330.6076; train_global_loss: 1011320.7569; train_optim_loss: 1011320.7569; val_kl_reg_loss: 26336.6816; val_edge_recon_loss: 298841.5938; val_gene_expr_recon_loss: 443179.0625; val_masked_gp_l1_reg_loss: 6637.0659; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244400.7500; val_global_loss: 1019395.1875; val_optim_loss: 1019395.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9417; val_auprc_score: 0.9236; val_best_acc_score: 0.8814; val_best_f1_score: 0.8867; train_kl_reg_loss: 26886.2450; train_edge_recon_loss: 296259.9236; train_gene_expr_recon_loss: 435354.4792; train_masked_gp_l1_reg_loss: 6665.8157; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241439.0677; train_global_loss: 1006605.5556; train_optim_loss: 1006605.5556; val_kl_reg_loss: 26664.4336; val_edge_recon_loss: 295402.3750; val_gene_expr_recon_loss: 440588.3125; val_masked_gp_l1_reg_loss: 6690.3730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243705.2812; val_global_loss: 1013050.7500; val_optim_loss: 1013050.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9457; val_auprc_score: 0.9289; val_best_acc_score: 0.8870; val_best_f1_score: 0.8932; train_kl_reg_loss: 26882.8422; train_edge_recon_loss: 294323.9583; train_gene_expr_recon_loss: 432026.1701; train_masked_gp_l1_reg_loss: 6719.9584; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241384.0035; train_global_loss: 1001336.9306; train_optim_loss: 1001336.9306; val_kl_reg_loss: 26199.5430; val_edge_recon_loss: 294874.5938; val_gene_expr_recon_loss: 438492.1250; val_masked_gp_l1_reg_loss: 6740.2715; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242995.7344; val_global_loss: 1009302.2500; val_optim_loss: 1009302.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9497; val_auprc_score: 0.9328; val_best_acc_score: 0.8933; val_best_f1_score: 0.8972; train_kl_reg_loss: 26831.7029; train_edge_recon_loss: 293474.4062; train_gene_expr_recon_loss: 431468.5625; train_masked_gp_l1_reg_loss: 6763.5844; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240574.9861; train_global_loss: 999113.2222; train_optim_loss: 999113.2222; val_kl_reg_loss: 27821.3887; val_edge_recon_loss: 292822.3750; val_gene_expr_recon_loss: 436565.3125; val_masked_gp_l1_reg_loss: 6784.7437; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242341.1875; val_global_loss: 1006335.0000; val_optim_loss: 1006335.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9547; val_auprc_score: 0.9380; val_best_acc_score: 0.8989; val_best_f1_score: 0.9035; train_kl_reg_loss: 27333.8824; train_edge_recon_loss: 291419.2917; train_gene_expr_recon_loss: 427417.2986; train_masked_gp_l1_reg_loss: 6807.8166; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240456.4479; train_global_loss: 993434.7292; train_optim_loss: 993434.7292; val_kl_reg_loss: 26339.1641; val_edge_recon_loss: 290366.9375; val_gene_expr_recon_loss: 435973.6875; val_masked_gp_l1_reg_loss: 6827.5947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241991.8750; val_global_loss: 1001499.2500; val_optim_loss: 1001499.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9531; val_auprc_score: 0.9371; val_best_acc_score: 0.8975; val_best_f1_score: 0.9021; train_kl_reg_loss: 26598.6111; train_edge_recon_loss: 291759.0382; train_gene_expr_recon_loss: 426240.3056; train_masked_gp_l1_reg_loss: 6845.6902; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239782.7240; train_global_loss: 991226.3681; train_optim_loss: 991226.3681; val_kl_reg_loss: 26527.0391; val_edge_recon_loss: 291883.4375; val_gene_expr_recon_loss: 433913.1875; val_masked_gp_l1_reg_loss: 6863.3516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241234.5000; val_global_loss: 1000421.5000; val_optim_loss: 1000421.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9580; val_auprc_score: 0.9409; val_best_acc_score: 0.9051; val_best_f1_score: 0.9087; train_kl_reg_loss: 26550.5961; train_edge_recon_loss: 291175.4965; train_gene_expr_recon_loss: 426418.2847; train_masked_gp_l1_reg_loss: 6883.0550; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238766.2292; train_global_loss: 989793.6389; train_optim_loss: 989793.6389; val_kl_reg_loss: 26464.5156; val_edge_recon_loss: 290512.2188; val_gene_expr_recon_loss: 432897.3750; val_masked_gp_l1_reg_loss: 6903.0054; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241489.7188; val_global_loss: 998266.8750; val_optim_loss: 998266.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9592; val_auprc_score: 0.9438; val_best_acc_score: 0.9045; val_best_f1_score: 0.9090; train_kl_reg_loss: 26268.6678; train_edge_recon_loss: 290131.3542; train_gene_expr_recon_loss: 423847.9271; train_masked_gp_l1_reg_loss: 6933.3058; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238483.8090; train_global_loss: 985665.0417; train_optim_loss: 985665.0417; val_kl_reg_loss: 25866.9766; val_edge_recon_loss: 288241.7812; val_gene_expr_recon_loss: 433394.3125; val_masked_gp_l1_reg_loss: 6954.7114; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241194.8281; val_global_loss: 995652.5625; val_optim_loss: 995652.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9641; val_auprc_score: 0.9523; val_best_acc_score: 0.9092; val_best_f1_score: 0.9127; train_kl_reg_loss: 26461.5948; train_edge_recon_loss: 288931.1875; train_gene_expr_recon_loss: 424642.9062; train_masked_gp_l1_reg_loss: 6973.8823; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239052.0469; train_global_loss: 986061.6181; train_optim_loss: 986061.6181; val_kl_reg_loss: 25955.9688; val_edge_recon_loss: 289013.4062; val_gene_expr_recon_loss: 430362.8125; val_masked_gp_l1_reg_loss: 6995.3716; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240192.8906; val_global_loss: 992520.4375; val_optim_loss: 992520.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9650; val_auprc_score: 0.9559; val_best_acc_score: 0.9120; val_best_f1_score: 0.9136; train_kl_reg_loss: 25967.7767; train_edge_recon_loss: 289078.2743; train_gene_expr_recon_loss: 421258.7257; train_masked_gp_l1_reg_loss: 7021.2154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237745.4549; train_global_loss: 981071.4514; train_optim_loss: 981071.4514; val_kl_reg_loss: 26019.4609; val_edge_recon_loss: 289152.2500; val_gene_expr_recon_loss: 428974.9375; val_masked_gp_l1_reg_loss: 7032.3672; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239804.3438; val_global_loss: 990983.3750; val_optim_loss: 990983.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9631; val_auprc_score: 0.9469; val_best_acc_score: 0.9135; val_best_f1_score: 0.9166; train_kl_reg_loss: 25956.9123; train_edge_recon_loss: 288527.5903; train_gene_expr_recon_loss: 420655.5660; train_masked_gp_l1_reg_loss: 7046.2324; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237682.3003; train_global_loss: 979868.5972; train_optim_loss: 979868.5972; val_kl_reg_loss: 26025.0938; val_edge_recon_loss: 288230.9375; val_gene_expr_recon_loss: 427707.8125; val_masked_gp_l1_reg_loss: 7059.8906; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239465.3125; val_global_loss: 988489.0625; val_optim_loss: 988489.0625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9673; val_auprc_score: 0.9559; val_best_acc_score: 0.9159; val_best_f1_score: 0.9191; train_kl_reg_loss: 25912.8320; train_edge_recon_loss: 287976.4861; train_gene_expr_recon_loss: 419388.0035; train_masked_gp_l1_reg_loss: 7081.7971; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237214.3715; train_global_loss: 977573.4931; train_optim_loss: 977573.4931; val_kl_reg_loss: 25848.7812; val_edge_recon_loss: 287446.9375; val_gene_expr_recon_loss: 427482.1875; val_masked_gp_l1_reg_loss: 7095.8926; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239171.2812; val_global_loss: 987045.0000; val_optim_loss: 987045.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9654; val_auprc_score: 0.9536; val_best_acc_score: 0.9105; val_best_f1_score: 0.9137; train_kl_reg_loss: 27560.6810; train_edge_recon_loss: 297775.2257; train_gene_expr_recon_loss: 427940.9792; train_masked_gp_l1_reg_loss: 7125.0741; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239038.1840; train_global_loss: 999440.1458; train_optim_loss: 999440.1458; val_kl_reg_loss: 16866.8633; val_edge_recon_loss: 294318.1875; val_gene_expr_recon_loss: 437444.1250; val_masked_gp_l1_reg_loss: 7131.8320; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240679.0781; val_global_loss: 996440.0625; val_optim_loss: 996440.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9663; val_auprc_score: 0.9534; val_best_acc_score: 0.9115; val_best_f1_score: 0.9149; train_kl_reg_loss: 24754.2648; train_edge_recon_loss: 292020.0590; train_gene_expr_recon_loss: 426626.9826; train_masked_gp_l1_reg_loss: 7132.6836; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237450.5799; train_global_loss: 987984.5625; train_optim_loss: 987984.5625; val_kl_reg_loss: 19090.6621; val_edge_recon_loss: 291301.4062; val_gene_expr_recon_loss: 434306.0000; val_masked_gp_l1_reg_loss: 7135.6470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240283.7188; val_global_loss: 992117.3750; val_optim_loss: 992117.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9702; val_auprc_score: 0.9601; val_best_acc_score: 0.9175; val_best_f1_score: 0.9202; train_kl_reg_loss: 24132.6871; train_edge_recon_loss: 287059.9306; train_gene_expr_recon_loss: 427626.8958; train_masked_gp_l1_reg_loss: 7141.5271; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239015.5451; train_global_loss: 984976.5764; train_optim_loss: 984976.5764; val_kl_reg_loss: 20183.7715; val_edge_recon_loss: 287712.5000; val_gene_expr_recon_loss: 433093.2500; val_masked_gp_l1_reg_loss: 7141.9092; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239943.4531; val_global_loss: 988074.8750; val_optim_loss: 988074.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9690; val_auprc_score: 0.9558; val_best_acc_score: 0.9169; val_best_f1_score: 0.9199; train_kl_reg_loss: 23291.8312; train_edge_recon_loss: 286810.5694; train_gene_expr_recon_loss: 425003.9757; train_masked_gp_l1_reg_loss: 7145.5209; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238475.0000; train_global_loss: 980726.9236; train_optim_loss: 980726.9236; val_kl_reg_loss: 21145.6016; val_edge_recon_loss: 287130.4375; val_gene_expr_recon_loss: 432577.5938; val_masked_gp_l1_reg_loss: 7145.7964; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239604.1250; val_global_loss: 987603.5625; val_optim_loss: 987603.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9654; val_best_acc_score: 0.9258; val_best_f1_score: 0.9286; train_kl_reg_loss: 23476.0705; train_edge_recon_loss: 284842.2500; train_gene_expr_recon_loss: 422502.9097; train_masked_gp_l1_reg_loss: 7113.6547; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238155.1806; train_global_loss: 976090.0625; train_optim_loss: 976090.0625; val_kl_reg_loss: 21464.4863; val_edge_recon_loss: 285312.4062; val_gene_expr_recon_loss: 431130.0000; val_masked_gp_l1_reg_loss: 7082.8979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239428.5938; val_global_loss: 984418.3750; val_optim_loss: 984418.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9708; val_auprc_score: 0.9586; val_best_acc_score: 0.9247; val_best_f1_score: 0.9265; train_kl_reg_loss: 23509.6367; train_edge_recon_loss: 285455.0417; train_gene_expr_recon_loss: 421889.0833; train_masked_gp_l1_reg_loss: 7074.5037; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238018.9965; train_global_loss: 975947.2361; train_optim_loss: 975947.2361; val_kl_reg_loss: 21318.5879; val_edge_recon_loss: 286154.6562; val_gene_expr_recon_loss: 431710.1562; val_masked_gp_l1_reg_loss: 7061.5942; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239507.5000; val_global_loss: 985752.5000; val_optim_loss: 985752.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9698; val_auprc_score: 0.9598; val_best_acc_score: 0.9196; val_best_f1_score: 0.9232; train_kl_reg_loss: 23335.6100; train_edge_recon_loss: 285044.1562; train_gene_expr_recon_loss: 422221.3264; train_masked_gp_l1_reg_loss: 7055.0793; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237598.0365; train_global_loss: 975254.2014; train_optim_loss: 975254.2014; val_kl_reg_loss: 21320.9199; val_edge_recon_loss: 287390.4062; val_gene_expr_recon_loss: 431031.6562; val_masked_gp_l1_reg_loss: 7047.7002; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239345.8750; val_global_loss: 986136.5625; val_optim_loss: 986136.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9731; val_auprc_score: 0.9633; val_best_acc_score: 0.9245; val_best_f1_score: 0.9276; train_kl_reg_loss: 23243.7042; train_edge_recon_loss: 285492.5208; train_gene_expr_recon_loss: 422060.1493; train_masked_gp_l1_reg_loss: 7043.5771; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237009.7465; train_global_loss: 974849.7083; train_optim_loss: 974849.7083; val_kl_reg_loss: 21210.1777; val_edge_recon_loss: 286387.8750; val_gene_expr_recon_loss: 431368.5625; val_masked_gp_l1_reg_loss: 7039.0488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239369.6719; val_global_loss: 985375.3750; val_optim_loss: 985375.3750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9703; val_auprc_score: 0.9610; val_best_acc_score: 0.9213; val_best_f1_score: 0.9238; train_kl_reg_loss: 23143.5625; train_edge_recon_loss: 285270.9410; train_gene_expr_recon_loss: 421834.8715; train_masked_gp_l1_reg_loss: 7037.0772; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236834.4670; train_global_loss: 974120.9306; train_optim_loss: 974120.9306; val_kl_reg_loss: 21332.0430; val_edge_recon_loss: 287331.8750; val_gene_expr_recon_loss: 430951.9062; val_masked_gp_l1_reg_loss: 7034.2393; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239326.3750; val_global_loss: 985976.4375; val_optim_loss: 985976.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9701; val_auprc_score: 0.9565; val_best_acc_score: 0.9209; val_best_f1_score: 0.9243; train_kl_reg_loss: 23205.2700; train_edge_recon_loss: 285505.3333; train_gene_expr_recon_loss: 421762.2153; train_masked_gp_l1_reg_loss: 7030.6235; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236736.8594; train_global_loss: 974240.2847; train_optim_loss: 974240.2847; val_kl_reg_loss: 21314.1328; val_edge_recon_loss: 287178.9688; val_gene_expr_recon_loss: 430913.4375; val_masked_gp_l1_reg_loss: 7027.1035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239207.0781; val_global_loss: 985640.6875; val_optim_loss: 985640.6875
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9713; val_auprc_score: 0.9615; val_best_acc_score: 0.9233; val_best_f1_score: 0.9262; train_kl_reg_loss: 23156.0100; train_edge_recon_loss: 285467.5521; train_gene_expr_recon_loss: 419840.9444; train_masked_gp_l1_reg_loss: 7026.3103; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237155.1858; train_global_loss: 972646.0069; train_optim_loss: 972646.0069; val_kl_reg_loss: 21285.1426; val_edge_recon_loss: 285585.0312; val_gene_expr_recon_loss: 430998.9375; val_masked_gp_l1_reg_loss: 7024.9316; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239302.7656; val_global_loss: 984196.8125; val_optim_loss: 984196.8125
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9702; val_auprc_score: 0.9586; val_best_acc_score: 0.9194; val_best_f1_score: 0.9222; train_kl_reg_loss: 23207.9913; train_edge_recon_loss: 285189.4340; train_gene_expr_recon_loss: 422497.1632; train_masked_gp_l1_reg_loss: 7024.1955; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237938.7882; train_global_loss: 975857.5764; train_optim_loss: 975857.5764; val_kl_reg_loss: 21287.6582; val_edge_recon_loss: 286636.8438; val_gene_expr_recon_loss: 431058.2188; val_masked_gp_l1_reg_loss: 7023.3599; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239281.9062; val_global_loss: 985288.0000; val_optim_loss: 985288.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9679; val_auprc_score: 0.9573; val_best_acc_score: 0.9185; val_best_f1_score: 0.9215; train_kl_reg_loss: 23012.2157; train_edge_recon_loss: 285868.7604; train_gene_expr_recon_loss: 419315.6181; train_masked_gp_l1_reg_loss: 7022.9070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237184.5139; train_global_loss: 972404.0139; train_optim_loss: 972404.0139; val_kl_reg_loss: 21224.6680; val_edge_recon_loss: 287672.5938; val_gene_expr_recon_loss: 431116.8125; val_masked_gp_l1_reg_loss: 7022.3809; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239311.1875; val_global_loss: 986347.6250; val_optim_loss: 986347.6250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9750; val_auprc_score: 0.9658; val_best_acc_score: 0.9281; val_best_f1_score: 0.9306; train_kl_reg_loss: 23021.3405; train_edge_recon_loss: 284850.5451; train_gene_expr_recon_loss: 418689.4132; train_masked_gp_l1_reg_loss: 7022.0779; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236307.5451; train_global_loss: 969890.9375; train_optim_loss: 969890.9375; val_kl_reg_loss: 21235.7344; val_edge_recon_loss: 285042.3125; val_gene_expr_recon_loss: 431095.8750; val_masked_gp_l1_reg_loss: 7021.6875; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239327.2656; val_global_loss: 983722.8750; val_optim_loss: 983722.8750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9724; val_auprc_score: 0.9623; val_best_acc_score: 0.9254; val_best_f1_score: 0.9283; train_kl_reg_loss: 23100.8832; train_edge_recon_loss: 285342.8715; train_gene_expr_recon_loss: 422490.6319; train_masked_gp_l1_reg_loss: 7021.4494; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237463.6892; train_global_loss: 975419.5278; train_optim_loss: 975419.5278; val_kl_reg_loss: 21203.9395; val_edge_recon_loss: 285613.6562; val_gene_expr_recon_loss: 431023.8125; val_masked_gp_l1_reg_loss: 7021.1592; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239280.7656; val_global_loss: 984143.3125; val_optim_loss: 984143.3125
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9727; val_auprc_score: 0.9626; val_best_acc_score: 0.9268; val_best_f1_score: 0.9297; train_kl_reg_loss: 23056.4768; train_edge_recon_loss: 284417.4236; train_gene_expr_recon_loss: 421022.1597; train_masked_gp_l1_reg_loss: 7020.9851; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236623.5747; train_global_loss: 972140.6250; train_optim_loss: 972140.6250; val_kl_reg_loss: 21223.8008; val_edge_recon_loss: 286758.2812; val_gene_expr_recon_loss: 431001.0000; val_masked_gp_l1_reg_loss: 7020.7646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239285.1875; val_global_loss: 985289.0625; val_optim_loss: 985289.0625
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9704; val_auprc_score: 0.9612; val_best_acc_score: 0.9235; val_best_f1_score: 0.9267; train_kl_reg_loss: 23044.6832; train_edge_recon_loss: 285135.8021; train_gene_expr_recon_loss: 420656.1146; train_masked_gp_l1_reg_loss: 7020.6425; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236230.0260; train_global_loss: 972087.2847; train_optim_loss: 972087.2847; val_kl_reg_loss: 21204.8457; val_edge_recon_loss: 286295.2188; val_gene_expr_recon_loss: 431033.4375; val_masked_gp_l1_reg_loss: 7020.4614; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239282.7656; val_global_loss: 984836.6875; val_optim_loss: 984836.6875
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9721; val_auprc_score: 0.9614; val_best_acc_score: 0.9216; val_best_f1_score: 0.9238; train_kl_reg_loss: 23067.7072; train_edge_recon_loss: 285706.0278; train_gene_expr_recon_loss: 420874.8854; train_masked_gp_l1_reg_loss: 7020.3214; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237382.6406; train_global_loss: 974051.5903; train_optim_loss: 974051.5903; val_kl_reg_loss: 21244.4219; val_edge_recon_loss: 287436.7188; val_gene_expr_recon_loss: 431028.9688; val_masked_gp_l1_reg_loss: 7020.1313; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239327.2031; val_global_loss: 986057.4375; val_optim_loss: 986057.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9738; val_auprc_score: 0.9652; val_best_acc_score: 0.9287; val_best_f1_score: 0.9314; train_kl_reg_loss: 23131.5089; train_edge_recon_loss: 285251.7257; train_gene_expr_recon_loss: 422814.6806; train_masked_gp_l1_reg_loss: 7019.8015; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237842.5694; train_global_loss: 976060.2778; train_optim_loss: 976060.2778; val_kl_reg_loss: 21234.8477; val_edge_recon_loss: 284647.5625; val_gene_expr_recon_loss: 431009.5625; val_masked_gp_l1_reg_loss: 7019.4932; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239295.5312; val_global_loss: 983207.0000; val_optim_loss: 983207.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9725; val_auprc_score: 0.9639; val_best_acc_score: 0.9229; val_best_f1_score: 0.9258; train_kl_reg_loss: 23082.0938; train_edge_recon_loss: 285051.3056; train_gene_expr_recon_loss: 421725.8576; train_masked_gp_l1_reg_loss: 7019.4207; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237243.3889; train_global_loss: 974122.0833; train_optim_loss: 974122.0833; val_kl_reg_loss: 21230.3789; val_edge_recon_loss: 286410.8125; val_gene_expr_recon_loss: 431006.6250; val_masked_gp_l1_reg_loss: 7019.3022; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239294.2656; val_global_loss: 984961.3750; val_optim_loss: 984961.3750
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9741; val_auprc_score: 0.9649; val_best_acc_score: 0.9263; val_best_f1_score: 0.9292; train_kl_reg_loss: 23084.0751; train_edge_recon_loss: 285504.4861; train_gene_expr_recon_loss: 421155.7118; train_masked_gp_l1_reg_loss: 7019.2396; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236539.9427; train_global_loss: 973303.4931; train_optim_loss: 973303.4931; val_kl_reg_loss: 21294.0645; val_edge_recon_loss: 287162.5625; val_gene_expr_recon_loss: 431025.5000; val_masked_gp_l1_reg_loss: 7019.1704; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239330.2031; val_global_loss: 985831.5000; val_optim_loss: 985831.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9734; val_auprc_score: 0.9664; val_best_acc_score: 0.9237; val_best_f1_score: 0.9258; train_kl_reg_loss: 23126.3403; train_edge_recon_loss: 284707.6562; train_gene_expr_recon_loss: 423440.7188; train_masked_gp_l1_reg_loss: 7019.1292; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238461.4983; train_global_loss: 976755.3472; train_optim_loss: 976755.3472; val_kl_reg_loss: 21223.0898; val_edge_recon_loss: 287356.1250; val_gene_expr_recon_loss: 431010.4375; val_masked_gp_l1_reg_loss: 7019.0859; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239292.0469; val_global_loss: 985900.7500; val_optim_loss: 985900.7500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9726; val_auprc_score: 0.9623; val_best_acc_score: 0.9258; val_best_f1_score: 0.9287; train_kl_reg_loss: 23064.4245; train_edge_recon_loss: 285120.0139; train_gene_expr_recon_loss: 419947.0625; train_masked_gp_l1_reg_loss: 7019.0627; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237176.9931; train_global_loss: 972327.5694; train_optim_loss: 972327.5694; val_kl_reg_loss: 21244.2324; val_edge_recon_loss: 284859.3125; val_gene_expr_recon_loss: 431019.8750; val_masked_gp_l1_reg_loss: 7019.0283; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239306.1719; val_global_loss: 983448.5625; val_optim_loss: 983448.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9709; val_auprc_score: 0.9588; val_best_acc_score: 0.9224; val_best_f1_score: 0.9255; train_kl_reg_loss: 23067.2797; train_edge_recon_loss: 285363.5382; train_gene_expr_recon_loss: 421632.1632; train_masked_gp_l1_reg_loss: 7018.9908; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237844.9444; train_global_loss: 974926.9028; train_optim_loss: 974926.9028; val_kl_reg_loss: 21256.8008; val_edge_recon_loss: 287744.3438; val_gene_expr_recon_loss: 431013.2812; val_masked_gp_l1_reg_loss: 7018.9551; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239295.1250; val_global_loss: 986328.5000; val_optim_loss: 986328.5000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9730; val_auprc_score: 0.9634; val_best_acc_score: 0.9250; val_best_f1_score: 0.9280; train_kl_reg_loss: 23161.6684; train_edge_recon_loss: 285807.6979; train_gene_expr_recon_loss: 424752.4965; train_masked_gp_l1_reg_loss: 7018.9465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238756.5278; train_global_loss: 979497.3125; train_optim_loss: 979497.3125; val_kl_reg_loss: 21268.2148; val_edge_recon_loss: 285624.3125; val_gene_expr_recon_loss: 431014.4375; val_masked_gp_l1_reg_loss: 7018.9316; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239278.0469; val_global_loss: 984204.0000; val_optim_loss: 984204.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9730; val_auprc_score: 0.9636; val_best_acc_score: 0.9250; val_best_f1_score: 0.9280; train_kl_reg_loss: 23099.6141; train_edge_recon_loss: 284481.6840; train_gene_expr_recon_loss: 422501.0382; train_masked_gp_l1_reg_loss: 7018.9244; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238068.5451; train_global_loss: 975169.8264; train_optim_loss: 975169.8264; val_kl_reg_loss: 21247.9922; val_edge_recon_loss: 286302.5938; val_gene_expr_recon_loss: 431010.1250; val_masked_gp_l1_reg_loss: 7018.9160; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239287.0156; val_global_loss: 984866.6875; val_optim_loss: 984866.6875
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9724; val_auprc_score: 0.9640; val_best_acc_score: 0.9275; val_best_f1_score: 0.9303; train_kl_reg_loss: 23096.1274; train_edge_recon_loss: 285816.3819; train_gene_expr_recon_loss: 423168.8611; train_masked_gp_l1_reg_loss: 7018.9110; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236784.4097; train_global_loss: 975884.7014; train_optim_loss: 975884.7014; val_kl_reg_loss: 21207.2188; val_edge_recon_loss: 284163.9375; val_gene_expr_recon_loss: 431014.0312; val_masked_gp_l1_reg_loss: 7018.9053; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239309.2969; val_global_loss: 982713.3750; val_optim_loss: 982713.3750
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9739; val_auprc_score: 0.9675; val_best_acc_score: 0.9247; val_best_f1_score: 0.9272; train_kl_reg_loss: 23111.4134; train_edge_recon_loss: 285567.7986; train_gene_expr_recon_loss: 421276.9688; train_masked_gp_l1_reg_loss: 7018.9028; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237161.4757; train_global_loss: 974136.5278; train_optim_loss: 974136.5278; val_kl_reg_loss: 21231.7285; val_edge_recon_loss: 285831.7500; val_gene_expr_recon_loss: 431004.1250; val_masked_gp_l1_reg_loss: 7018.8989; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239254.5000; val_global_loss: 984341.0000; val_optim_loss: 984341.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9741; val_auprc_score: 0.9656; val_best_acc_score: 0.9241; val_best_f1_score: 0.9269; train_kl_reg_loss: 23130.9301; train_edge_recon_loss: 285366.8472; train_gene_expr_recon_loss: 421112.8021; train_masked_gp_l1_reg_loss: 7018.8965; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237298.7448; train_global_loss: 973928.2014; train_optim_loss: 973928.2014; val_kl_reg_loss: 21224.5508; val_edge_recon_loss: 286184.6562; val_gene_expr_recon_loss: 431010.2188; val_masked_gp_l1_reg_loss: 7018.8936; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239279.3906; val_global_loss: 984717.6875; val_optim_loss: 984717.6875
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9737; val_auprc_score: 0.9653; val_best_acc_score: 0.9256; val_best_f1_score: 0.9286; train_kl_reg_loss: 23091.5328; train_edge_recon_loss: 285560.9410; train_gene_expr_recon_loss: 420317.4514; train_masked_gp_l1_reg_loss: 7018.8911; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236644.1667; train_global_loss: 972632.9583; train_optim_loss: 972632.9583; val_kl_reg_loss: 21226.3848; val_edge_recon_loss: 285250.1875; val_gene_expr_recon_loss: 431016.1562; val_masked_gp_l1_reg_loss: 7018.8887; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239300.5312; val_global_loss: 983812.1250; val_optim_loss: 983812.1250
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9705; val_auprc_score: 0.9611; val_best_acc_score: 0.9220; val_best_f1_score: 0.9254; train_kl_reg_loss: 23065.4553; train_edge_recon_loss: 284996.4826; train_gene_expr_recon_loss: 421009.3681; train_masked_gp_l1_reg_loss: 7018.8862; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237776.6250; train_global_loss: 973866.8125; train_optim_loss: 973866.8125; val_kl_reg_loss: 21217.3867; val_edge_recon_loss: 286950.9062; val_gene_expr_recon_loss: 431015.1250; val_masked_gp_l1_reg_loss: 7018.8843; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239295.8281; val_global_loss: 985498.0625; val_optim_loss: 985498.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9693; val_auprc_score: 0.9581; val_best_acc_score: 0.9202; val_best_f1_score: 0.9232; train_kl_reg_loss: 23091.8062; train_edge_recon_loss: 284700.6806; train_gene_expr_recon_loss: 421290.6493; train_masked_gp_l1_reg_loss: 7018.8799; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236314.0174; train_global_loss: 972416.0278; train_optim_loss: 972416.0278; val_kl_reg_loss: 21217.8359; val_edge_recon_loss: 288327.2500; val_gene_expr_recon_loss: 431009.9375; val_masked_gp_l1_reg_loss: 7018.8750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239284.2500; val_global_loss: 986858.1250; val_optim_loss: 986858.1250
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9718; val_auprc_score: 0.9633; val_best_acc_score: 0.9206; val_best_f1_score: 0.9230; train_kl_reg_loss: 23047.5280; train_edge_recon_loss: 285621.7778; train_gene_expr_recon_loss: 421462.5729; train_masked_gp_l1_reg_loss: 7018.8746; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237420.4392; train_global_loss: 974571.2014; train_optim_loss: 974571.2014; val_kl_reg_loss: 21229.1621; val_edge_recon_loss: 285529.6250; val_gene_expr_recon_loss: 431043.6875; val_masked_gp_l1_reg_loss: 7018.8730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239364.9219; val_global_loss: 984186.3125; val_optim_loss: 984186.3125
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9709; val_auprc_score: 0.9581; val_best_acc_score: 0.9247; val_best_f1_score: 0.9277; train_kl_reg_loss: 23032.0263; train_edge_recon_loss: 285857.3576; train_gene_expr_recon_loss: 421401.8264; train_masked_gp_l1_reg_loss: 7018.8722; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236382.2917; train_global_loss: 973692.3819; train_optim_loss: 973692.3819; val_kl_reg_loss: 21240.4883; val_edge_recon_loss: 286372.4688; val_gene_expr_recon_loss: 431007.0625; val_masked_gp_l1_reg_loss: 7018.8716; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239274.3438; val_global_loss: 984913.2500; val_optim_loss: 984913.2500
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9697; val_auprc_score: 0.9579; val_best_acc_score: 0.9224; val_best_f1_score: 0.9257; train_kl_reg_loss: 23089.9188; train_edge_recon_loss: 285967.5382; train_gene_expr_recon_loss: 422480.3368; train_masked_gp_l1_reg_loss: 7018.8706; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237582.7951; train_global_loss: 976139.4653; train_optim_loss: 976139.4653; val_kl_reg_loss: 21239.2324; val_edge_recon_loss: 286169.9062; val_gene_expr_recon_loss: 431000.4375; val_masked_gp_l1_reg_loss: 7018.8701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239266.4375; val_global_loss: 984694.8750; val_optim_loss: 984694.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 32 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9769
val AUPRC score: 0.9679
val best accuracy score: 0.9289
val best F1 score: 0.9315
val target rna MSE score: 0.4420
val source rna MSE score: 0.2550
val target atac MSE score: 0.1349
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
