[True]
Run timestamp: 07092023_012447_230.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_230']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 26065 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 30568, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6850; val_auprc_score: 0.6772; val_best_acc_score: 0.5038; val_best_f1_score: 0.6667; train_kl_reg_loss: 51459.4560; train_edge_recon_loss: 3591833.8409; train_gene_expr_recon_loss: 17110446.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1512673.0814; train_chrom_access_recon_loss: 59273610.8485; train_global_loss: 81540023.1515; train_optim_loss: 81540023.1515; val_kl_reg_loss: 147785.6973; val_edge_recon_loss: 4064534.4062; val_gene_expr_recon_loss: 15113438.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1206587.2500; val_chrom_access_recon_loss: 56059711.0000; val_global_loss: 76592057.0000; val_optim_loss: 76592057.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6807; val_auprc_score: 0.6780; val_best_acc_score: 0.5188; val_best_f1_score: 0.6702; train_kl_reg_loss: 133992.3512; train_edge_recon_loss: 3591409.4545; train_gene_expr_recon_loss: 14894409.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 906483.7689; train_chrom_access_recon_loss: 55906315.1515; train_global_loss: 75432610.4242; train_optim_loss: 75432610.4242; val_kl_reg_loss: 126667.1748; val_edge_recon_loss: 4063541.5625; val_gene_expr_recon_loss: 14749583.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 643592.3125; val_chrom_access_recon_loss: 55263805.0000; val_global_loss: 74847189.0000; val_optim_loss: 74847189.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7823; val_auprc_score: 0.7604; val_best_acc_score: 0.6891; val_best_f1_score: 0.7443; train_kl_reg_loss: 135751.4851; train_edge_recon_loss: 3544836.3674; train_gene_expr_recon_loss: 14647003.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 485863.5218; train_chrom_access_recon_loss: 55315676.9091; train_global_loss: 74129132.6061; train_optim_loss: 74129132.6061; val_kl_reg_loss: 129215.7197; val_edge_recon_loss: 4053198.8750; val_gene_expr_recon_loss: 14559844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 362751.2812; val_chrom_access_recon_loss: 54398434.5000; val_global_loss: 73503444.0000; val_optim_loss: 73503444.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8309; val_auprc_score: 0.8025; val_best_acc_score: 0.7214; val_best_f1_score: 0.7719; train_kl_reg_loss: 121244.9490; train_edge_recon_loss: 3531611.7765; train_gene_expr_recon_loss: 14544100.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 293659.4160; train_chrom_access_recon_loss: 55017456.8485; train_global_loss: 73508073.0909; train_optim_loss: 73508073.0909; val_kl_reg_loss: 112982.5732; val_edge_recon_loss: 3989291.1875; val_gene_expr_recon_loss: 14465730.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238266.8906; val_chrom_access_recon_loss: 53921015.5000; val_global_loss: 72727286.0000; val_optim_loss: 72727286.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8598; val_auprc_score: 0.8232; val_best_acc_score: 0.7851; val_best_f1_score: 0.8091; train_kl_reg_loss: 103906.6938; train_edge_recon_loss: 3492989.9773; train_gene_expr_recon_loss: 14425679.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204397.7732; train_chrom_access_recon_loss: 54640781.2121; train_global_loss: 72867754.5455; train_optim_loss: 72867754.5455; val_kl_reg_loss: 90490.8311; val_edge_recon_loss: 3670100.5312; val_gene_expr_recon_loss: 14388525.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175940.6094; val_chrom_access_recon_loss: 53692220.5000; val_global_loss: 72017276.0000; val_optim_loss: 72017276.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8457; val_auprc_score: 0.7923; val_best_acc_score: 0.7851; val_best_f1_score: 0.8037; train_kl_reg_loss: 89872.8394; train_edge_recon_loss: 3232153.8106; train_gene_expr_recon_loss: 14354173.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155836.3023; train_chrom_access_recon_loss: 54412096.3636; train_global_loss: 72244133.6970; train_optim_loss: 72244133.6970; val_kl_reg_loss: 110419.3740; val_edge_recon_loss: 3026015.1562; val_gene_expr_recon_loss: 14380198.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138409.5781; val_chrom_access_recon_loss: 54241060.5000; val_global_loss: 71896104.0000; val_optim_loss: 71896104.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8317; val_auprc_score: 0.7892; val_best_acc_score: 0.7719; val_best_f1_score: 0.8009; train_kl_reg_loss: 123275.4469; train_edge_recon_loss: 2997979.7500; train_gene_expr_recon_loss: 14275083.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125619.6411; train_chrom_access_recon_loss: 54199233.8182; train_global_loss: 71721191.3939; train_optim_loss: 71721191.3939; val_kl_reg_loss: 123984.3721; val_edge_recon_loss: 3037280.9375; val_gene_expr_recon_loss: 14347769.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114574.1250; val_chrom_access_recon_loss: 53861071.0000; val_global_loss: 71484681.0000; val_optim_loss: 71484681.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8486; val_auprc_score: 0.8034; val_best_acc_score: 0.7883; val_best_f1_score: 0.8126; train_kl_reg_loss: 125964.5069; train_edge_recon_loss: 2956248.1061; train_gene_expr_recon_loss: 14200578.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105924.3719; train_chrom_access_recon_loss: 53947664.2424; train_global_loss: 71336379.8788; train_optim_loss: 71336379.8788; val_kl_reg_loss: 126956.6816; val_edge_recon_loss: 2940121.3125; val_gene_expr_recon_loss: 14231121.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98645.2969; val_chrom_access_recon_loss: 53014091.5000; val_global_loss: 70410935.0000; val_optim_loss: 70410935.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8590; val_auprc_score: 0.8223; val_best_acc_score: 0.7982; val_best_f1_score: 0.8246; train_kl_reg_loss: 124243.8162; train_edge_recon_loss: 2921753.2008; train_gene_expr_recon_loss: 14142971.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92714.6467; train_chrom_access_recon_loss: 53748133.0909; train_global_loss: 71029816.5455; train_optim_loss: 71029816.5455; val_kl_reg_loss: 118603.2451; val_edge_recon_loss: 2890966.7812; val_gene_expr_recon_loss: 14145159.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87738.2344; val_chrom_access_recon_loss: 52541775.0000; val_global_loss: 69784242.0000; val_optim_loss: 69784242.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8567; val_auprc_score: 0.8128; val_best_acc_score: 0.8074; val_best_f1_score: 0.8313; train_kl_reg_loss: 122718.1360; train_edge_recon_loss: 2894263.3788; train_gene_expr_recon_loss: 14084291.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83600.6624; train_chrom_access_recon_loss: 53509863.2727; train_global_loss: 70694737.0909; train_optim_loss: 70694737.0909; val_kl_reg_loss: 118508.9453; val_edge_recon_loss: 2884470.8438; val_gene_expr_recon_loss: 13994344.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79719.9922; val_chrom_access_recon_loss: 52386799.5000; val_global_loss: 69463844.0000; val_optim_loss: 69463844.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8640; val_auprc_score: 0.8236; val_best_acc_score: 0.8031; val_best_f1_score: 0.8277; train_kl_reg_loss: 121032.3414; train_edge_recon_loss: 2868891.5417; train_gene_expr_recon_loss: 14028654.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76756.5608; train_chrom_access_recon_loss: 53295849.0909; train_global_loss: 70391183.8788; train_optim_loss: 70391183.8788; val_kl_reg_loss: 119315.8291; val_edge_recon_loss: 2866073.5938; val_gene_expr_recon_loss: 14144053.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74230.8750; val_chrom_access_recon_loss: 53409698.5000; val_global_loss: 70613371.0000; val_optim_loss: 70613371.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8634; val_auprc_score: 0.8238; val_best_acc_score: 0.8023; val_best_f1_score: 0.8280; train_kl_reg_loss: 120012.2429; train_edge_recon_loss: 2868468.8220; train_gene_expr_recon_loss: 13975729.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71909.2074; train_chrom_access_recon_loss: 53119920.1212; train_global_loss: 70156039.7576; train_optim_loss: 70156039.7576; val_kl_reg_loss: 113896.0381; val_edge_recon_loss: 2891524.7812; val_gene_expr_recon_loss: 13892763.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69833.1641; val_chrom_access_recon_loss: 52426357.5000; val_global_loss: 69394374.5000; val_optim_loss: 69394374.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8647; val_auprc_score: 0.8236; val_best_acc_score: 0.7985; val_best_f1_score: 0.8228; train_kl_reg_loss: 117743.7069; train_edge_recon_loss: 2843989.4242; train_gene_expr_recon_loss: 13933128.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68060.9315; train_chrom_access_recon_loss: 52935545.6970; train_global_loss: 69898468.7879; train_optim_loss: 69898468.7879; val_kl_reg_loss: 117071.1699; val_edge_recon_loss: 2894104.0625; val_gene_expr_recon_loss: 14070577.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66391.3594; val_chrom_access_recon_loss: 53085336.0000; val_global_loss: 70233481.0000; val_optim_loss: 70233481.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8746; val_auprc_score: 0.8457; val_best_acc_score: 0.8036; val_best_f1_score: 0.8253; train_kl_reg_loss: 116026.0836; train_edge_recon_loss: 2839779.4583; train_gene_expr_recon_loss: 13877784.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65141.2359; train_chrom_access_recon_loss: 52710744.7273; train_global_loss: 69609475.7576; train_optim_loss: 69609475.7576; val_kl_reg_loss: 115869.4902; val_edge_recon_loss: 2880699.3750; val_gene_expr_recon_loss: 13961412.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63862.3594; val_chrom_access_recon_loss: 52648014.5000; val_global_loss: 69669858.0000; val_optim_loss: 69669858.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8717; val_auprc_score: 0.8387; val_best_acc_score: 0.7998; val_best_f1_score: 0.8249; train_kl_reg_loss: 113828.9411; train_edge_recon_loss: 2829854.1174; train_gene_expr_recon_loss: 13837722.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62714.2481; train_chrom_access_recon_loss: 52537384.5455; train_global_loss: 69381504.4848; train_optim_loss: 69381504.4848; val_kl_reg_loss: 111785.0664; val_edge_recon_loss: 2886014.2812; val_gene_expr_recon_loss: 14005537.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61817.1133; val_chrom_access_recon_loss: 52619706.0000; val_global_loss: 69684862.0000; val_optim_loss: 69684862.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8892; val_auprc_score: 0.8669; val_best_acc_score: 0.8106; val_best_f1_score: 0.8325; train_kl_reg_loss: 113011.1096; train_edge_recon_loss: 2814489.2386; train_gene_expr_recon_loss: 13805400.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60706.1521; train_chrom_access_recon_loss: 52422997.6970; train_global_loss: 69216604.3636; train_optim_loss: 69216604.3636; val_kl_reg_loss: 110543.7617; val_edge_recon_loss: 2876513.6875; val_gene_expr_recon_loss: 13754415.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59932.7773; val_chrom_access_recon_loss: 51996455.5000; val_global_loss: 68797859.5000; val_optim_loss: 68797859.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8913; val_auprc_score: 0.8663; val_best_acc_score: 0.8130; val_best_f1_score: 0.8309; train_kl_reg_loss: 109039.0456; train_edge_recon_loss: 2805168.9470; train_gene_expr_recon_loss: 13766833.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59141.2586; train_chrom_access_recon_loss: 52229162.9091; train_global_loss: 68969345.8788; train_optim_loss: 68969345.8788; val_kl_reg_loss: 107302.8730; val_edge_recon_loss: 2866992.5312; val_gene_expr_recon_loss: 13699650.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58655.3789; val_chrom_access_recon_loss: 51475257.0000; val_global_loss: 68207858.5000; val_optim_loss: 68207858.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8942; val_auprc_score: 0.8704; val_best_acc_score: 0.8157; val_best_f1_score: 0.8299; train_kl_reg_loss: 108020.7348; train_edge_recon_loss: 2811975.0189; train_gene_expr_recon_loss: 13730716.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57993.9711; train_chrom_access_recon_loss: 52045294.5455; train_global_loss: 68754001.0909; train_optim_loss: 68754001.0909; val_kl_reg_loss: 104896.1328; val_edge_recon_loss: 2882710.5938; val_gene_expr_recon_loss: 13711069.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57274.3672; val_chrom_access_recon_loss: 51301479.0000; val_global_loss: 68057431.0000; val_optim_loss: 68057431.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9064; val_auprc_score: 0.8735; val_best_acc_score: 0.8409; val_best_f1_score: 0.8534; train_kl_reg_loss: 106239.0997; train_edge_recon_loss: 2794390.8258; train_gene_expr_recon_loss: 13690841.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56757.0803; train_chrom_access_recon_loss: 51856525.4545; train_global_loss: 68504754.3636; train_optim_loss: 68504754.3636; val_kl_reg_loss: 102070.8916; val_edge_recon_loss: 2803265.2188; val_gene_expr_recon_loss: 13734172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56417.0391; val_chrom_access_recon_loss: 51235687.5000; val_global_loss: 67931613.0000; val_optim_loss: 67931613.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9115; val_auprc_score: 0.8796; val_best_acc_score: 0.8493; val_best_f1_score: 0.8607; train_kl_reg_loss: 105086.5285; train_edge_recon_loss: 2781863.1856; train_gene_expr_recon_loss: 13657487.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55837.3821; train_chrom_access_recon_loss: 51701425.2727; train_global_loss: 68301700.2424; train_optim_loss: 68301700.2424; val_kl_reg_loss: 103870.1846; val_edge_recon_loss: 2824639.1562; val_gene_expr_recon_loss: 13747802.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55341.5391; val_chrom_access_recon_loss: 51397097.0000; val_global_loss: 68128751.5000; val_optim_loss: 68128751.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9169; val_auprc_score: 0.8879; val_best_acc_score: 0.8592; val_best_f1_score: 0.8711; train_kl_reg_loss: 105417.1340; train_edge_recon_loss: 2764898.8636; train_gene_expr_recon_loss: 13626936.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55050.1262; train_chrom_access_recon_loss: 51529107.7576; train_global_loss: 68081409.9394; train_optim_loss: 68081409.9394; val_kl_reg_loss: 101904.2451; val_edge_recon_loss: 2790848.4062; val_gene_expr_recon_loss: 13608781.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54630.4023; val_chrom_access_recon_loss: 50978579.0000; val_global_loss: 67534744.0000; val_optim_loss: 67534744.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9253; val_auprc_score: 0.9001; val_best_acc_score: 0.8684; val_best_f1_score: 0.8780; train_kl_reg_loss: 104677.4794; train_edge_recon_loss: 2764499.4015; train_gene_expr_recon_loss: 13592489.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54321.7654; train_chrom_access_recon_loss: 51342720.6667; train_global_loss: 67858708.4242; train_optim_loss: 67858708.4242; val_kl_reg_loss: 103122.7285; val_edge_recon_loss: 2776636.3438; val_gene_expr_recon_loss: 13617105.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53960.7305; val_chrom_access_recon_loss: 50891025.5000; val_global_loss: 67441851.0000; val_optim_loss: 67441851.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9250; val_auprc_score: 0.8953; val_best_acc_score: 0.8686; val_best_f1_score: 0.8769; train_kl_reg_loss: 104134.9895; train_edge_recon_loss: 2759520.0758; train_gene_expr_recon_loss: 13563359.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53786.4306; train_chrom_access_recon_loss: 51185823.5758; train_global_loss: 67666624.3030; train_optim_loss: 67666624.3030; val_kl_reg_loss: 102569.5195; val_edge_recon_loss: 2817450.1875; val_gene_expr_recon_loss: 13622320.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53600.9961; val_chrom_access_recon_loss: 50750305.5000; val_global_loss: 67346247.5000; val_optim_loss: 67346247.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9207; val_auprc_score: 0.8888; val_best_acc_score: 0.8651; val_best_f1_score: 0.8744; train_kl_reg_loss: 102498.9439; train_edge_recon_loss: 2748615.8447; train_gene_expr_recon_loss: 13539095.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53248.3598; train_chrom_access_recon_loss: 51102050.7879; train_global_loss: 67545509.6364; train_optim_loss: 67545509.6364; val_kl_reg_loss: 102586.1260; val_edge_recon_loss: 2788934.0000; val_gene_expr_recon_loss: 13598786.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53154.2227; val_chrom_access_recon_loss: 51075927.0000; val_global_loss: 67619388.0000; val_optim_loss: 67619388.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9282; val_auprc_score: 0.8990; val_best_acc_score: 0.8740; val_best_f1_score: 0.8832; train_kl_reg_loss: 102813.1209; train_edge_recon_loss: 2737334.9735; train_gene_expr_recon_loss: 13510817.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52802.3420; train_chrom_access_recon_loss: 50858449.0303; train_global_loss: 67262217.4545; train_optim_loss: 67262217.4545; val_kl_reg_loss: 102524.4043; val_edge_recon_loss: 2796368.4062; val_gene_expr_recon_loss: 13521123.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52603.2656; val_chrom_access_recon_loss: 50816526.0000; val_global_loss: 67289145.0000; val_optim_loss: 67289145.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9274; val_auprc_score: 0.8997; val_best_acc_score: 0.8743; val_best_f1_score: 0.8818; train_kl_reg_loss: 101600.9143; train_edge_recon_loss: 2740416.7841; train_gene_expr_recon_loss: 13487732.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52437.6988; train_chrom_access_recon_loss: 50700285.1515; train_global_loss: 67082472.8485; train_optim_loss: 67082472.8485; val_kl_reg_loss: 101138.0586; val_edge_recon_loss: 2805803.4688; val_gene_expr_recon_loss: 13634211.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52410.4375; val_chrom_access_recon_loss: 50907367.5000; val_global_loss: 67500931.5000; val_optim_loss: 67500931.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9369; val_auprc_score: 0.9098; val_best_acc_score: 0.8880; val_best_f1_score: 0.8950; train_kl_reg_loss: 101700.3742; train_edge_recon_loss: 2730924.9167; train_gene_expr_recon_loss: 13461417.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52213.6103; train_chrom_access_recon_loss: 50607363.5152; train_global_loss: 66953619.5758; train_optim_loss: 66953619.5758; val_kl_reg_loss: 101164.7061; val_edge_recon_loss: 2743018.4375; val_gene_expr_recon_loss: 13535783.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52136.5898; val_chrom_access_recon_loss: 50679093.5000; val_global_loss: 67111196.5000; val_optim_loss: 67111196.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9432; val_auprc_score: 0.9190; val_best_acc_score: 0.8872; val_best_f1_score: 0.8946; train_kl_reg_loss: 100007.5470; train_edge_recon_loss: 2732492.4356; train_gene_expr_recon_loss: 13446618.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51914.1497; train_chrom_access_recon_loss: 50454761.6970; train_global_loss: 66785794.3030; train_optim_loss: 66785794.3030; val_kl_reg_loss: 97150.3809; val_edge_recon_loss: 2737218.2812; val_gene_expr_recon_loss: 13553797.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51798.4023; val_chrom_access_recon_loss: 50623281.0000; val_global_loss: 67063246.0000; val_optim_loss: 67063246.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9378; val_auprc_score: 0.9150; val_best_acc_score: 0.8847; val_best_f1_score: 0.8917; train_kl_reg_loss: 99485.3110; train_edge_recon_loss: 2726970.4545; train_gene_expr_recon_loss: 13418832.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51666.3854; train_chrom_access_recon_loss: 50248604.7273; train_global_loss: 66545559.7576; train_optim_loss: 66545559.7576; val_kl_reg_loss: 98214.6504; val_edge_recon_loss: 2733772.1875; val_gene_expr_recon_loss: 13367750.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51481.4023; val_chrom_access_recon_loss: 50114678.5000; val_global_loss: 66365896.0000; val_optim_loss: 66365896.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9441; val_auprc_score: 0.9184; val_best_acc_score: 0.8944; val_best_f1_score: 0.8988; train_kl_reg_loss: 98309.3524; train_edge_recon_loss: 2734239.1364; train_gene_expr_recon_loss: 13406636.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51399.9378; train_chrom_access_recon_loss: 50130830.1818; train_global_loss: 66421414.4242; train_optim_loss: 66421414.4242; val_kl_reg_loss: 95843.5547; val_edge_recon_loss: 2739265.8438; val_gene_expr_recon_loss: 13431280.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51499.5859; val_chrom_access_recon_loss: 50290699.0000; val_global_loss: 66608588.5000; val_optim_loss: 66608588.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9338; val_auprc_score: 0.9031; val_best_acc_score: 0.8850; val_best_f1_score: 0.8889; train_kl_reg_loss: 97267.5328; train_edge_recon_loss: 2722315.7500; train_gene_expr_recon_loss: 13385342.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51328.6726; train_chrom_access_recon_loss: 50043239.5758; train_global_loss: 66299493.6364; train_optim_loss: 66299493.6364; val_kl_reg_loss: 96175.9189; val_edge_recon_loss: 2774460.5000; val_gene_expr_recon_loss: 13337084.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51080.5859; val_chrom_access_recon_loss: 50206790.0000; val_global_loss: 66465592.0000; val_optim_loss: 66465592.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9413; val_auprc_score: 0.9164; val_best_acc_score: 0.8893; val_best_f1_score: 0.8950; train_kl_reg_loss: 96259.6422; train_edge_recon_loss: 2731033.7803; train_gene_expr_recon_loss: 13358248.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51125.9666; train_chrom_access_recon_loss: 49850334.0606; train_global_loss: 66087001.2121; train_optim_loss: 66087001.2121; val_kl_reg_loss: 96107.0459; val_edge_recon_loss: 2742477.1562; val_gene_expr_recon_loss: 13283987.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50958.0000; val_chrom_access_recon_loss: 49642657.0000; val_global_loss: 65816187.5000; val_optim_loss: 65816187.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9388; val_auprc_score: 0.9174; val_best_acc_score: 0.8839; val_best_f1_score: 0.8899; train_kl_reg_loss: 96328.1228; train_edge_recon_loss: 2732339.0038; train_gene_expr_recon_loss: 13337779.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50923.6556; train_chrom_access_recon_loss: 49688157.6364; train_global_loss: 65905528.1818; train_optim_loss: 65905528.1818; val_kl_reg_loss: 93705.5068; val_edge_recon_loss: 2776743.5312; val_gene_expr_recon_loss: 13510886.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50956.3008; val_chrom_access_recon_loss: 50178025.0000; val_global_loss: 66610317.0000; val_optim_loss: 66610317.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9502; val_auprc_score: 0.9337; val_best_acc_score: 0.8960; val_best_f1_score: 0.9000; train_kl_reg_loss: 94746.1394; train_edge_recon_loss: 2714900.4318; train_gene_expr_recon_loss: 13317650.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51000.3477; train_chrom_access_recon_loss: 49573223.0909; train_global_loss: 65751520.3030; train_optim_loss: 65751520.3030; val_kl_reg_loss: 96262.0596; val_edge_recon_loss: 2755200.2812; val_gene_expr_recon_loss: 13370954.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50817.7578; val_chrom_access_recon_loss: 50123128.5000; val_global_loss: 66396363.5000; val_optim_loss: 66396363.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9490; val_auprc_score: 0.9261; val_best_acc_score: 0.8998; val_best_f1_score: 0.9035; train_kl_reg_loss: 95140.1439; train_edge_recon_loss: 2721624.3788; train_gene_expr_recon_loss: 13324422.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50790.3875; train_chrom_access_recon_loss: 49531704.1818; train_global_loss: 65723681.7576; train_optim_loss: 65723681.7576; val_kl_reg_loss: 94019.6777; val_edge_recon_loss: 2748644.5000; val_gene_expr_recon_loss: 13404061.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50736.7109; val_chrom_access_recon_loss: 49755723.5000; val_global_loss: 66053186.0000; val_optim_loss: 66053186.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9472; val_auprc_score: 0.9275; val_best_acc_score: 0.8958; val_best_f1_score: 0.9018; train_kl_reg_loss: 94608.8022; train_edge_recon_loss: 2717224.6098; train_gene_expr_recon_loss: 13296607.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50697.6911; train_chrom_access_recon_loss: 49372020.6061; train_global_loss: 65531159.3333; train_optim_loss: 65531159.3333; val_kl_reg_loss: 94007.5713; val_edge_recon_loss: 2747142.7812; val_gene_expr_recon_loss: 13220720.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50614.6250; val_chrom_access_recon_loss: 49369732.0000; val_global_loss: 65482217.5000; val_optim_loss: 65482217.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9497; val_auprc_score: 0.9279; val_best_acc_score: 0.9014; val_best_f1_score: 0.9062; train_kl_reg_loss: 93877.1432; train_edge_recon_loss: 2721604.2841; train_gene_expr_recon_loss: 13285872.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50592.5024; train_chrom_access_recon_loss: 49251986.9091; train_global_loss: 65403933.0909; train_optim_loss: 65403933.0909; val_kl_reg_loss: 92272.1426; val_edge_recon_loss: 2734738.6250; val_gene_expr_recon_loss: 13240447.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50803.2344; val_chrom_access_recon_loss: 49587752.0000; val_global_loss: 65706013.5000; val_optim_loss: 65706013.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9530; val_auprc_score: 0.9329; val_best_acc_score: 0.9068; val_best_f1_score: 0.9105; train_kl_reg_loss: 93708.9953; train_edge_recon_loss: 2716038.4242; train_gene_expr_recon_loss: 13276565.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50629.7894; train_chrom_access_recon_loss: 49191071.9394; train_global_loss: 65328014.7273; train_optim_loss: 65328014.7273; val_kl_reg_loss: 93007.7256; val_edge_recon_loss: 2746431.1250; val_gene_expr_recon_loss: 13289198.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50631.2734; val_chrom_access_recon_loss: 49706372.0000; val_global_loss: 65885640.5000; val_optim_loss: 65885640.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9580; val_auprc_score: 0.9411; val_best_acc_score: 0.9092; val_best_f1_score: 0.9136; train_kl_reg_loss: 93627.6186; train_edge_recon_loss: 2715177.1780; train_gene_expr_recon_loss: 13264143.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50550.8728; train_chrom_access_recon_loss: 49079759.2121; train_global_loss: 65203258.7273; train_optim_loss: 65203258.7273; val_kl_reg_loss: 91737.6709; val_edge_recon_loss: 2737336.7188; val_gene_expr_recon_loss: 13182676.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50764.5742; val_chrom_access_recon_loss: 49497459.5000; val_global_loss: 65559975.5000; val_optim_loss: 65559975.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9499; val_auprc_score: 0.9279; val_best_acc_score: 0.9068; val_best_f1_score: 0.9112; train_kl_reg_loss: 92770.0671; train_edge_recon_loss: 2706003.4962; train_gene_expr_recon_loss: 13240391.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50714.0572; train_chrom_access_recon_loss: 48991109.0303; train_global_loss: 65080988.6667; train_optim_loss: 65080988.6667; val_kl_reg_loss: 92346.6484; val_edge_recon_loss: 2750680.3125; val_gene_expr_recon_loss: 13336278.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50515.9102; val_chrom_access_recon_loss: 49829362.0000; val_global_loss: 66059183.5000; val_optim_loss: 66059183.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9540; val_auprc_score: 0.9382; val_best_acc_score: 0.9006; val_best_f1_score: 0.9055; train_kl_reg_loss: 93049.9289; train_edge_recon_loss: 2697551.9015; train_gene_expr_recon_loss: 13226834.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43265.0978; train_chrom_access_recon_loss: 48823246.6061; train_global_loss: 64883948.2424; train_optim_loss: 64883948.2424; val_kl_reg_loss: 94331.9307; val_edge_recon_loss: 2764886.4375; val_gene_expr_recon_loss: 13341070.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40671.4375; val_chrom_access_recon_loss: 49428165.5000; val_global_loss: 65669125.5000; val_optim_loss: 65669125.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9543; val_auprc_score: 0.9329; val_best_acc_score: 0.9095; val_best_f1_score: 0.9138; train_kl_reg_loss: 94437.2093; train_edge_recon_loss: 2705276.5379; train_gene_expr_recon_loss: 13220705.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40325.4023; train_chrom_access_recon_loss: 48804905.1515; train_global_loss: 64865650.3030; train_optim_loss: 64865650.3030; val_kl_reg_loss: 94417.4121; val_edge_recon_loss: 2737888.3438; val_gene_expr_recon_loss: 13202741.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40107.0586; val_chrom_access_recon_loss: 49122361.5000; val_global_loss: 65197516.0000; val_optim_loss: 65197516.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9521; val_auprc_score: 0.9332; val_best_acc_score: 0.9087; val_best_f1_score: 0.9123; train_kl_reg_loss: 94689.7927; train_edge_recon_loss: 2700342.7083; train_gene_expr_recon_loss: 13216307.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39992.1721; train_chrom_access_recon_loss: 48775696.1212; train_global_loss: 64827028.5455; train_optim_loss: 64827028.5455; val_kl_reg_loss: 94684.0117; val_edge_recon_loss: 2743796.1875; val_gene_expr_recon_loss: 13144084.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39879.3164; val_chrom_access_recon_loss: 48964907.5000; val_global_loss: 64987352.0000; val_optim_loss: 64987352.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9510; val_auprc_score: 0.9362; val_best_acc_score: 0.9009; val_best_f1_score: 0.9067; train_kl_reg_loss: 94713.7042; train_edge_recon_loss: 2701864.7652; train_gene_expr_recon_loss: 13209378.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39769.6141; train_chrom_access_recon_loss: 48734093.8788; train_global_loss: 64779820.0606; train_optim_loss: 64779820.0606; val_kl_reg_loss: 94455.7236; val_edge_recon_loss: 2759134.0625; val_gene_expr_recon_loss: 13344446.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39669.8594; val_chrom_access_recon_loss: 49729372.0000; val_global_loss: 65967079.0000; val_optim_loss: 65967079.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9552; val_auprc_score: 0.9357; val_best_acc_score: 0.9049; val_best_f1_score: 0.9093; train_kl_reg_loss: 94563.1265; train_edge_recon_loss: 2699550.1288; train_gene_expr_recon_loss: 13213223.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39614.0406; train_chrom_access_recon_loss: 48741461.7576; train_global_loss: 64788412.0000; train_optim_loss: 64788412.0000; val_kl_reg_loss: 94049.8164; val_edge_recon_loss: 2730414.8125; val_gene_expr_recon_loss: 13292137.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39534.6250; val_chrom_access_recon_loss: 49661192.0000; val_global_loss: 65817329.0000; val_optim_loss: 65817329.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9609; val_auprc_score: 0.9475; val_best_acc_score: 0.9130; val_best_f1_score: 0.9175; train_kl_reg_loss: 94579.6950; train_edge_recon_loss: 2705647.5985; train_gene_expr_recon_loss: 13210797.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39480.7603; train_chrom_access_recon_loss: 48741626.1818; train_global_loss: 64792131.8182; train_optim_loss: 64792131.8182; val_kl_reg_loss: 94488.4727; val_edge_recon_loss: 2717891.6875; val_gene_expr_recon_loss: 13196570.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39456.9258; val_chrom_access_recon_loss: 48756253.0000; val_global_loss: 64804661.5000; val_optim_loss: 64804661.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9585; val_auprc_score: 0.9448; val_best_acc_score: 0.9135; val_best_f1_score: 0.9176; train_kl_reg_loss: 94741.7539; train_edge_recon_loss: 2701930.6932; train_gene_expr_recon_loss: 13201340.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39384.3394; train_chrom_access_recon_loss: 48659228.6061; train_global_loss: 64696626.3636; train_optim_loss: 64696626.3636; val_kl_reg_loss: 94841.7754; val_edge_recon_loss: 2732372.6250; val_gene_expr_recon_loss: 13338062.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39347.9297; val_chrom_access_recon_loss: 49675456.0000; val_global_loss: 65880080.5000; val_optim_loss: 65880080.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9543; val_auprc_score: 0.9404; val_best_acc_score: 0.9065; val_best_f1_score: 0.9108; train_kl_reg_loss: 94928.3200; train_edge_recon_loss: 2696247.4015; train_gene_expr_recon_loss: 13205588.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39282.5806; train_chrom_access_recon_loss: 48705977.8182; train_global_loss: 64742024.3030; train_optim_loss: 64742024.3030; val_kl_reg_loss: 95301.7383; val_edge_recon_loss: 2782256.5625; val_gene_expr_recon_loss: 13359888.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39212.6641; val_chrom_access_recon_loss: 49460553.0000; val_global_loss: 65737211.5000; val_optim_loss: 65737211.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9576; val_auprc_score: 0.9435; val_best_acc_score: 0.9095; val_best_f1_score: 0.9141; train_kl_reg_loss: 94718.0143; train_edge_recon_loss: 2703283.5455; train_gene_expr_recon_loss: 13206396.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39189.8751; train_chrom_access_recon_loss: 48687257.8182; train_global_loss: 64730845.3939; train_optim_loss: 64730845.3939; val_kl_reg_loss: 94710.4658; val_edge_recon_loss: 2748842.4375; val_gene_expr_recon_loss: 13300281.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39134.8320; val_chrom_access_recon_loss: 49739251.0000; val_global_loss: 65922220.5000; val_optim_loss: 65922220.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9592; val_auprc_score: 0.9419; val_best_acc_score: 0.9159; val_best_f1_score: 0.9184; train_kl_reg_loss: 94683.0232; train_edge_recon_loss: 2703304.8144; train_gene_expr_recon_loss: 13199571.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39066.9407; train_chrom_access_recon_loss: 48659767.5758; train_global_loss: 64696394.0606; train_optim_loss: 64696394.0606; val_kl_reg_loss: 95451.9199; val_edge_recon_loss: 2720570.0938; val_gene_expr_recon_loss: 13398604.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39050.2109; val_chrom_access_recon_loss: 50125741.5000; val_global_loss: 66379418.5000; val_optim_loss: 66379418.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9575; val_auprc_score: 0.9349; val_best_acc_score: 0.9164; val_best_f1_score: 0.9190; train_kl_reg_loss: 94435.7340; train_edge_recon_loss: 2696025.0947; train_gene_expr_recon_loss: 13208036.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38293.2760; train_chrom_access_recon_loss: 48698704.7273; train_global_loss: 64735495.2121; train_optim_loss: 64735495.2121; val_kl_reg_loss: 95075.6504; val_edge_recon_loss: 2735993.9375; val_gene_expr_recon_loss: 13360020.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38015.6289; val_chrom_access_recon_loss: 49566695.0000; val_global_loss: 65795801.0000; val_optim_loss: 65795801.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9567; val_auprc_score: 0.9436; val_best_acc_score: 0.9108; val_best_f1_score: 0.9139; train_kl_reg_loss: 94479.7385; train_edge_recon_loss: 2702699.6364; train_gene_expr_recon_loss: 13204346.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37971.3063; train_chrom_access_recon_loss: 48654486.1212; train_global_loss: 64693983.0909; train_optim_loss: 64693983.0909; val_kl_reg_loss: 95498.6631; val_edge_recon_loss: 2750184.4375; val_gene_expr_recon_loss: 13365664.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37942.8789; val_chrom_access_recon_loss: 49503652.0000; val_global_loss: 65752942.5000; val_optim_loss: 65752942.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9584; val_auprc_score: 0.9427; val_best_acc_score: 0.9097; val_best_f1_score: 0.9141; train_kl_reg_loss: 94475.3862; train_edge_recon_loss: 2700225.7462; train_gene_expr_recon_loss: 13202784.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37924.2955; train_chrom_access_recon_loss: 48652320.3030; train_global_loss: 64687730.3030; train_optim_loss: 64687730.3030; val_kl_reg_loss: 94599.8145; val_edge_recon_loss: 2716300.2812; val_gene_expr_recon_loss: 13309830.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37910.2266; val_chrom_access_recon_loss: 48997590.5000; val_global_loss: 65156230.5000; val_optim_loss: 65156230.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9564; val_auprc_score: 0.9410; val_best_acc_score: 0.9078; val_best_f1_score: 0.9113; train_kl_reg_loss: 94524.7521; train_edge_recon_loss: 2702208.1439; train_gene_expr_recon_loss: 13200361.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37896.3190; train_chrom_access_recon_loss: 48663602.1212; train_global_loss: 64698592.5455; train_optim_loss: 64698592.5455; val_kl_reg_loss: 94725.4189; val_edge_recon_loss: 2751254.6875; val_gene_expr_recon_loss: 13272432.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37885.9102; val_chrom_access_recon_loss: 49512851.5000; val_global_loss: 65669150.5000; val_optim_loss: 65669150.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 74 min 32 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9570
val AUPRC score: 0.9399
val best accuracy score: 0.9078
val best F1 score: 0.9113
val target rna MSE score: 0.9637
val source rna MSE score: 0.3645
val target atac MSE score: 0.1244
val source atac MSE score: 0.0269
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
