[True]
Run timestamp: 27072023_032156_140.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_140']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8772; val_auprc_score: 0.9764; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 492594.1556; train_edge_recon_loss: 10944119.0465; train_gene_expr_recon_loss: 31888825.1814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43325538.2605; train_optim_loss: 43325538.2605; val_kl_reg_loss: 277180.8685; val_edge_recon_loss: 11802346.7083; val_gene_expr_recon_loss: 24617720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36697247.3333; val_optim_loss: 36697247.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8555; val_auprc_score: 0.9718; val_best_acc_score: 0.8619; val_best_f1_score: 0.9253; train_kl_reg_loss: 306966.0133; train_edge_recon_loss: 10656821.9302; train_gene_expr_recon_loss: 23826907.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34790695.3581; train_optim_loss: 34790695.3581; val_kl_reg_loss: 217784.4974; val_edge_recon_loss: 11650868.9167; val_gene_expr_recon_loss: 23250254.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35118907.5833; val_optim_loss: 35118907.5833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8372; val_auprc_score: 0.9692; val_best_acc_score: 0.8617; val_best_f1_score: 0.9249; train_kl_reg_loss: 192451.6083; train_edge_recon_loss: 10577475.8186; train_gene_expr_recon_loss: 21626638.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32396565.8605; train_optim_loss: 32396565.8605; val_kl_reg_loss: 74391.3216; val_edge_recon_loss: 11712567.9167; val_gene_expr_recon_loss: 11153481.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22940440.5833; val_optim_loss: 22940440.5833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8218; val_auprc_score: 0.9644; val_best_acc_score: 0.8646; val_best_f1_score: 0.9266; train_kl_reg_loss: 81555.9215; train_edge_recon_loss: 10503338.7814; train_gene_expr_recon_loss: 10489133.4930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21074028.2047; train_optim_loss: 21074028.2047; val_kl_reg_loss: 105069.2357; val_edge_recon_loss: 11459471.4167; val_gene_expr_recon_loss: 10135014.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21699554.9167; val_optim_loss: 21699554.9167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8191; val_auprc_score: 0.9588; val_best_acc_score: 0.8822; val_best_f1_score: 0.9347; train_kl_reg_loss: 109398.2131; train_edge_recon_loss: 10394195.1186; train_gene_expr_recon_loss: 9742448.5163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20246041.9163; train_optim_loss: 20246041.9163; val_kl_reg_loss: 78570.1540; val_edge_recon_loss: 11072759.2500; val_gene_expr_recon_loss: 9540069.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20691399.3333; val_optim_loss: 20691399.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8265; val_auprc_score: 0.9587; val_best_acc_score: 0.8845; val_best_f1_score: 0.9359; train_kl_reg_loss: 89530.7400; train_edge_recon_loss: 9701212.0651; train_gene_expr_recon_loss: 9392912.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19183655.3302; train_optim_loss: 19183655.3302; val_kl_reg_loss: 104859.2646; val_edge_recon_loss: 9283986.5417; val_gene_expr_recon_loss: 9278975.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18667821.4167; val_optim_loss: 18667821.4167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8281; val_auprc_score: 0.9595; val_best_acc_score: 0.8860; val_best_f1_score: 0.9367; train_kl_reg_loss: 139940.9044; train_edge_recon_loss: 8932026.1535; train_gene_expr_recon_loss: 9142121.5628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18214088.7581; train_optim_loss: 18214088.7581; val_kl_reg_loss: 156340.1003; val_edge_recon_loss: 9103945.5833; val_gene_expr_recon_loss: 9037137.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18297422.9583; val_optim_loss: 18297422.9583
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8315; val_auprc_score: 0.9592; val_best_acc_score: 0.8903; val_best_f1_score: 0.9387; train_kl_reg_loss: 170251.1975; train_edge_recon_loss: 8821675.8163; train_gene_expr_recon_loss: 8935143.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17927070.2884; train_optim_loss: 17927070.2884; val_kl_reg_loss: 170384.3926; val_edge_recon_loss: 9027625.2708; val_gene_expr_recon_loss: 8857327.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18055337.1667; val_optim_loss: 18055337.1667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8399; val_auprc_score: 0.9616; val_best_acc_score: 0.8972; val_best_f1_score: 0.9424; train_kl_reg_loss: 170433.9302; train_edge_recon_loss: 8680469.6023; train_gene_expr_recon_loss: 8768154.1488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17619057.6465; train_optim_loss: 17619057.6465; val_kl_reg_loss: 160030.8652; val_edge_recon_loss: 8918150.4583; val_gene_expr_recon_loss: 8711559.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17789741.1667; val_optim_loss: 17789741.1667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8474; val_auprc_score: 0.9639; val_best_acc_score: 0.9028; val_best_f1_score: 0.9455; train_kl_reg_loss: 158146.9796; train_edge_recon_loss: 8635320.0093; train_gene_expr_recon_loss: 8629580.4930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17423047.4465; train_optim_loss: 17423047.4465; val_kl_reg_loss: 144879.3021; val_edge_recon_loss: 8811782.0833; val_gene_expr_recon_loss: 8582431.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17539093.1667; val_optim_loss: 17539093.1667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8474; val_auprc_score: 0.9638; val_best_acc_score: 0.9069; val_best_f1_score: 0.9477; train_kl_reg_loss: 146091.7539; train_edge_recon_loss: 8529823.5349; train_gene_expr_recon_loss: 8500564.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17176479.3349; train_optim_loss: 17176479.3349; val_kl_reg_loss: 135488.5990; val_edge_recon_loss: 8689980.4792; val_gene_expr_recon_loss: 8447558.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17273028.1667; val_optim_loss: 17273028.1667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8459; val_auprc_score: 0.9648; val_best_acc_score: 0.9058; val_best_f1_score: 0.9471; train_kl_reg_loss: 131996.1651; train_edge_recon_loss: 8637989.8000; train_gene_expr_recon_loss: 8373672.3209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17143658.2093; train_optim_loss: 17143658.2093; val_kl_reg_loss: 119146.7389; val_edge_recon_loss: 8616650.9583; val_gene_expr_recon_loss: 8326277.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17062075.1250; val_optim_loss: 17062075.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8538; val_auprc_score: 0.9648; val_best_acc_score: 0.9042; val_best_f1_score: 0.9460; train_kl_reg_loss: 120666.6454; train_edge_recon_loss: 8524865.1023; train_gene_expr_recon_loss: 8254548.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16900080.6977; train_optim_loss: 16900080.6977; val_kl_reg_loss: 113084.3216; val_edge_recon_loss: 8700690.3333; val_gene_expr_recon_loss: 8215161.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17028935.7083; val_optim_loss: 17028935.7083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8642; val_auprc_score: 0.9662; val_best_acc_score: 0.9073; val_best_f1_score: 0.9475; train_kl_reg_loss: 114669.6592; train_edge_recon_loss: 8251851.0930; train_gene_expr_recon_loss: 8145942.3349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16512463.0791; train_optim_loss: 16512463.0791; val_kl_reg_loss: 105795.8906; val_edge_recon_loss: 8572681.7500; val_gene_expr_recon_loss: 8103689.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16782167.2500; val_optim_loss: 16782167.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8866; val_auprc_score: 0.9733; val_best_acc_score: 0.9078; val_best_f1_score: 0.9479; train_kl_reg_loss: 109889.8291; train_edge_recon_loss: 8350593.3791; train_gene_expr_recon_loss: 8039713.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16500197.0093; train_optim_loss: 16500197.0093; val_kl_reg_loss: 108363.0156; val_edge_recon_loss: 8256396.8542; val_gene_expr_recon_loss: 8013649.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16378408.9167; val_optim_loss: 16378408.9167
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8856; val_auprc_score: 0.9733; val_best_acc_score: 0.9089; val_best_f1_score: 0.9481; train_kl_reg_loss: 107296.5729; train_edge_recon_loss: 8226254.7744; train_gene_expr_recon_loss: 7947496.4349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16281047.7674; train_optim_loss: 16281047.7674; val_kl_reg_loss: 99549.4697; val_edge_recon_loss: 8259428.5417; val_gene_expr_recon_loss: 7923083.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16282061.0000; val_optim_loss: 16282061.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8937; val_auprc_score: 0.9761; val_best_acc_score: 0.9088; val_best_f1_score: 0.9481; train_kl_reg_loss: 100884.1508; train_edge_recon_loss: 8176444.2116; train_gene_expr_recon_loss: 7865884.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16143212.9302; train_optim_loss: 16143212.9302; val_kl_reg_loss: 93538.7132; val_edge_recon_loss: 8177030.2708; val_gene_expr_recon_loss: 7843343.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16113912.1250; val_optim_loss: 16113912.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8989; val_auprc_score: 0.9767; val_best_acc_score: 0.9106; val_best_f1_score: 0.9487; train_kl_reg_loss: 93589.3927; train_edge_recon_loss: 8125963.4186; train_gene_expr_recon_loss: 7789892.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16009445.1442; train_optim_loss: 16009445.1442; val_kl_reg_loss: 84784.0036; val_edge_recon_loss: 8267387.6042; val_gene_expr_recon_loss: 7774214.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16126386.4583; val_optim_loss: 16126386.4583
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9127; val_auprc_score: 0.9804; val_best_acc_score: 0.9147; val_best_f1_score: 0.9510; train_kl_reg_loss: 86792.5362; train_edge_recon_loss: 8008014.1047; train_gene_expr_recon_loss: 7713169.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15807976.1674; train_optim_loss: 15807976.1674; val_kl_reg_loss: 82033.5348; val_edge_recon_loss: 8180998.2500; val_gene_expr_recon_loss: 7695903.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15958935.5417; val_optim_loss: 15958935.5417
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9064; val_auprc_score: 0.9778; val_best_acc_score: 0.9126; val_best_f1_score: 0.9498; train_kl_reg_loss: 81662.3532; train_edge_recon_loss: 8039205.0047; train_gene_expr_recon_loss: 7643341.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15764208.6837; train_optim_loss: 15764208.6837; val_kl_reg_loss: 77013.6501; val_edge_recon_loss: 8322641.0208; val_gene_expr_recon_loss: 7628218.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16027872.9167; val_optim_loss: 16027872.9167
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9183; val_auprc_score: 0.9819; val_best_acc_score: 0.9183; val_best_f1_score: 0.9527; train_kl_reg_loss: 76640.2847; train_edge_recon_loss: 7990998.2302; train_gene_expr_recon_loss: 7580903.1070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15648541.6000; train_optim_loss: 15648541.6000; val_kl_reg_loss: 69167.7734; val_edge_recon_loss: 8084368.3125; val_gene_expr_recon_loss: 7576863.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15730399.1250; val_optim_loss: 15730399.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9275; val_auprc_score: 0.9838; val_best_acc_score: 0.9204; val_best_f1_score: 0.9540; train_kl_reg_loss: 67935.3440; train_edge_recon_loss: 8006733.3070; train_gene_expr_recon_loss: 7526569.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15601238.0837; train_optim_loss: 15601238.0837; val_kl_reg_loss: 62636.8045; val_edge_recon_loss: 8292775.1250; val_gene_expr_recon_loss: 7518962.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15874374.2917; val_optim_loss: 15874374.2917
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9275; val_auprc_score: 0.9826; val_best_acc_score: 0.9208; val_best_f1_score: 0.9539; train_kl_reg_loss: 61437.8492; train_edge_recon_loss: 7928471.3140; train_gene_expr_recon_loss: 7479847.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15469756.7209; train_optim_loss: 15469756.7209; val_kl_reg_loss: 58502.6444; val_edge_recon_loss: 8245369.8542; val_gene_expr_recon_loss: 7477575.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15781447.7500; val_optim_loss: 15781447.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9289; val_auprc_score: 0.9841; val_best_acc_score: 0.9252; val_best_f1_score: 0.9571; train_kl_reg_loss: 58465.2605; train_edge_recon_loss: 7895077.9558; train_gene_expr_recon_loss: 7422841.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15376384.5953; train_optim_loss: 15376384.5953; val_kl_reg_loss: 55710.9893; val_edge_recon_loss: 7896325.2083; val_gene_expr_recon_loss: 7420906.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15372943.0000; val_optim_loss: 15372943.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9254; val_auprc_score: 0.9831; val_best_acc_score: 0.9243; val_best_f1_score: 0.9563; train_kl_reg_loss: 56285.4485; train_edge_recon_loss: 7788637.2884; train_gene_expr_recon_loss: 7374433.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15219356.6047; train_optim_loss: 15219356.6047; val_kl_reg_loss: 51751.8188; val_edge_recon_loss: 7905462.0208; val_gene_expr_recon_loss: 7386281.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15343495.2917; val_optim_loss: 15343495.2917
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9389; val_auprc_score: 0.9866; val_best_acc_score: 0.9322; val_best_f1_score: 0.9610; train_kl_reg_loss: 57973.5575; train_edge_recon_loss: 7931066.5349; train_gene_expr_recon_loss: 7445500.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15434540.3023; train_optim_loss: 15434540.3023; val_kl_reg_loss: 14444.5667; val_edge_recon_loss: 7804758.6875; val_gene_expr_recon_loss: 7431879.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15251082.7083; val_optim_loss: 15251082.7083
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9402; val_auprc_score: 0.9862; val_best_acc_score: 0.9321; val_best_f1_score: 0.9609; train_kl_reg_loss: 52814.6370; train_edge_recon_loss: 7819181.8302; train_gene_expr_recon_loss: 7388708.9605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15260705.3721; train_optim_loss: 15260705.3721; val_kl_reg_loss: 13189.4738; val_edge_recon_loss: 7902721.0000; val_gene_expr_recon_loss: 7409610.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15325520.9583; val_optim_loss: 15325520.9583
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9474; val_auprc_score: 0.9882; val_best_acc_score: 0.9383; val_best_f1_score: 0.9643; train_kl_reg_loss: 47447.6839; train_edge_recon_loss: 7813393.3419; train_gene_expr_recon_loss: 7349014.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15209855.7535; train_optim_loss: 15209855.7535; val_kl_reg_loss: 11980.1671; val_edge_recon_loss: 8042652.4792; val_gene_expr_recon_loss: 7366041.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15420674.3750; val_optim_loss: 15420674.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9510; val_auprc_score: 0.9892; val_best_acc_score: 0.9414; val_best_f1_score: 0.9660; train_kl_reg_loss: 42378.9405; train_edge_recon_loss: 7827114.4558; train_gene_expr_recon_loss: 7321926.4256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15191419.8093; train_optim_loss: 15191419.8093; val_kl_reg_loss: 10972.9199; val_edge_recon_loss: 7848792.5000; val_gene_expr_recon_loss: 7332493.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15192258.5833; val_optim_loss: 15192258.5833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9540; val_auprc_score: 0.9896; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 37464.5622; train_edge_recon_loss: 7733896.6860; train_gene_expr_recon_loss: 7293272.9256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15064634.1721; train_optim_loss: 15064634.1721; val_kl_reg_loss: 11439.7356; val_edge_recon_loss: 7711620.5208; val_gene_expr_recon_loss: 7306455.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15029515.4167; val_optim_loss: 15029515.4167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9523; val_auprc_score: 0.9890; val_best_acc_score: 0.9440; val_best_f1_score: 0.9680; train_kl_reg_loss: 34750.4925; train_edge_recon_loss: 7730328.8488; train_gene_expr_recon_loss: 7267492.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15032572.2093; train_optim_loss: 15032572.2093; val_kl_reg_loss: 11235.0693; val_edge_recon_loss: 7567714.3125; val_gene_expr_recon_loss: 7269765.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14848715.1250; val_optim_loss: 14848715.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9560; val_auprc_score: 0.9900; val_best_acc_score: 0.9462; val_best_f1_score: 0.9689; train_kl_reg_loss: 32655.1297; train_edge_recon_loss: 7664971.4047; train_gene_expr_recon_loss: 7243404.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14941031.4140; train_optim_loss: 14941031.4140; val_kl_reg_loss: 11401.1148; val_edge_recon_loss: 7695812.1667; val_gene_expr_recon_loss: 7255401.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14962614.4583; val_optim_loss: 14962614.4583
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9553; val_auprc_score: 0.9904; val_best_acc_score: 0.9472; val_best_f1_score: 0.9696; train_kl_reg_loss: 30576.3584; train_edge_recon_loss: 7646803.2791; train_gene_expr_recon_loss: 7217530.5140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14894910.1488; train_optim_loss: 14894910.1488; val_kl_reg_loss: 11283.1281; val_edge_recon_loss: 7717753.9792; val_gene_expr_recon_loss: 7237506.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14966543.2500; val_optim_loss: 14966543.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9548; val_auprc_score: 0.9896; val_best_acc_score: 0.9460; val_best_f1_score: 0.9688; train_kl_reg_loss: 28235.9180; train_edge_recon_loss: 7621932.7930; train_gene_expr_recon_loss: 7201452.8163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14851621.5163; train_optim_loss: 14851621.5163; val_kl_reg_loss: 11167.5914; val_edge_recon_loss: 7800162.0833; val_gene_expr_recon_loss: 7219354.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15030684.6250; val_optim_loss: 15030684.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9578; val_auprc_score: 0.9895; val_best_acc_score: 0.9460; val_best_f1_score: 0.9685; train_kl_reg_loss: 26519.0034; train_edge_recon_loss: 7649564.1000; train_gene_expr_recon_loss: 7189152.1907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14865235.3116; train_optim_loss: 14865235.3116; val_kl_reg_loss: 10668.8108; val_edge_recon_loss: 8087428.5000; val_gene_expr_recon_loss: 7212222.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15310319.9167; val_optim_loss: 15310319.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9591; val_auprc_score: 0.9903; val_best_acc_score: 0.9504; val_best_f1_score: 0.9711; train_kl_reg_loss: 25890.1421; train_edge_recon_loss: 7746458.4256; train_gene_expr_recon_loss: 7157836.9209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14930185.4884; train_optim_loss: 14930185.4884; val_kl_reg_loss: 10748.4085; val_edge_recon_loss: 7725457.3750; val_gene_expr_recon_loss: 7189044.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14925250.1250; val_optim_loss: 14925250.1250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9584; val_auprc_score: 0.9898; val_best_acc_score: 0.9484; val_best_f1_score: 0.9701; train_kl_reg_loss: 26015.2276; train_edge_recon_loss: 7700084.9326; train_gene_expr_recon_loss: 7153385.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14879485.5163; train_optim_loss: 14879485.5163; val_kl_reg_loss: 10850.3116; val_edge_recon_loss: 7822821.8333; val_gene_expr_recon_loss: 7186999.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15020671.9167; val_optim_loss: 15020671.9167
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9604; val_auprc_score: 0.9912; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 26000.5181; train_edge_recon_loss: 7610747.1279; train_gene_expr_recon_loss: 7150087.3186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14786834.9767; train_optim_loss: 14786834.9767; val_kl_reg_loss: 10835.7784; val_edge_recon_loss: 7586143.5625; val_gene_expr_recon_loss: 7183613.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14780592.8750; val_optim_loss: 14780592.8750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9569; val_auprc_score: 0.9900; val_best_acc_score: 0.9522; val_best_f1_score: 0.9725; train_kl_reg_loss: 25975.3823; train_edge_recon_loss: 7584803.3256; train_gene_expr_recon_loss: 7149493.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14760271.9953; train_optim_loss: 14760271.9953; val_kl_reg_loss: 10914.3030; val_edge_recon_loss: 7647382.2292; val_gene_expr_recon_loss: 7180400.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14838696.6250; val_optim_loss: 14838696.6250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9586; val_auprc_score: 0.9903; val_best_acc_score: 0.9512; val_best_f1_score: 0.9718; train_kl_reg_loss: 25674.3636; train_edge_recon_loss: 7667371.6163; train_gene_expr_recon_loss: 7141267.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14834313.8791; train_optim_loss: 14834313.8791; val_kl_reg_loss: 10725.2479; val_edge_recon_loss: 7769253.6250; val_gene_expr_recon_loss: 7176146.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14956125.2083; val_optim_loss: 14956125.2083
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9638; val_auprc_score: 0.9914; val_best_acc_score: 0.9527; val_best_f1_score: 0.9726; train_kl_reg_loss: 25216.0293; train_edge_recon_loss: 7654099.9070; train_gene_expr_recon_loss: 7143997.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14823313.5116; train_optim_loss: 14823313.5116; val_kl_reg_loss: 10629.2620; val_edge_recon_loss: 7845188.2917; val_gene_expr_recon_loss: 7172487.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15028305.2917; val_optim_loss: 15028305.2917
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9607; val_auprc_score: 0.9915; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 24774.1915; train_edge_recon_loss: 7704409.3023; train_gene_expr_recon_loss: 7141243.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14870427.0326; train_optim_loss: 14870427.0326; val_kl_reg_loss: 10650.7529; val_edge_recon_loss: 7631183.5000; val_gene_expr_recon_loss: 7175850.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14817684.7500; val_optim_loss: 14817684.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9563; val_auprc_score: 0.9894; val_best_acc_score: 0.9496; val_best_f1_score: 0.9709; train_kl_reg_loss: 24578.2309; train_edge_recon_loss: 7623423.6605; train_gene_expr_recon_loss: 7139053.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14787055.2465; train_optim_loss: 14787055.2465; val_kl_reg_loss: 10632.5398; val_edge_recon_loss: 7837019.5417; val_gene_expr_recon_loss: 7174713.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15022365.5833; val_optim_loss: 15022365.5833
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9601; val_auprc_score: 0.9899; val_best_acc_score: 0.9529; val_best_f1_score: 0.9729; train_kl_reg_loss: 24487.7881; train_edge_recon_loss: 7700451.3651; train_gene_expr_recon_loss: 7136462.6558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14861401.8465; train_optim_loss: 14861401.8465; val_kl_reg_loss: 10603.1960; val_edge_recon_loss: 7624445.9583; val_gene_expr_recon_loss: 7160882.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14795931.8333; val_optim_loss: 14795931.8333
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9606; val_auprc_score: 0.9905; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 24507.5962; train_edge_recon_loss: 7621063.5163; train_gene_expr_recon_loss: 7133027.8837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14778598.9953; train_optim_loss: 14778598.9953; val_kl_reg_loss: 10672.6059; val_edge_recon_loss: 7776257.9792; val_gene_expr_recon_loss: 7172400.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14959330.9167; val_optim_loss: 14959330.9167
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9599; val_auprc_score: 0.9904; val_best_acc_score: 0.9510; val_best_f1_score: 0.9716; train_kl_reg_loss: 24468.9651; train_edge_recon_loss: 7730145.5047; train_gene_expr_recon_loss: 7138320.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14892934.7442; train_optim_loss: 14892934.7442; val_kl_reg_loss: 10654.8652; val_edge_recon_loss: 7687128.8125; val_gene_expr_recon_loss: 7170146.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14867929.8750; val_optim_loss: 14867929.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 24 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9583
Val AUPRC score: 0.9899
Val best accuracy score: 0.9501
Val best F1 score: 0.9711
Val gene expr MSE score: 78092.2629
Val cat covariate0 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
