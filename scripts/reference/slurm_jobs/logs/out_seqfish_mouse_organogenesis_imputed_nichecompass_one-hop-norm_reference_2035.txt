[True]
Run timestamp: 21072023_200919_2035.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '24', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2035']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 635067
Number of validation edges: 70562
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9045; val_auprc_score: 0.9804; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 682193.3959; train_edge_recon_loss: 11712726.2834; train_gene_expr_recon_loss: 305275965.0886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317670885.2303; train_optim_loss: 317670885.2303; val_kl_reg_loss: 505074.7346; val_edge_recon_loss: 11938888.0000; val_gene_expr_recon_loss: 250300463.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262744425.7391; val_optim_loss: 262744425.7391
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8850; val_auprc_score: 0.9766; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 354969.5644; train_edge_recon_loss: 11763711.3704; train_gene_expr_recon_loss: 276992606.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 289111287.7166; train_optim_loss: 289111287.7166; val_kl_reg_loss: 57145.2736; val_edge_recon_loss: 12045451.3043; val_gene_expr_recon_loss: 107641493.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 119744090.3188; val_optim_loss: 119744090.3188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8717; val_auprc_score: 0.9737; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 208874.0525; train_edge_recon_loss: 10543651.8744; train_gene_expr_recon_loss: 95194507.9678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 105947033.9452; train_optim_loss: 105947033.9452; val_kl_reg_loss: 224055.8827; val_edge_recon_loss: 11990512.3768; val_gene_expr_recon_loss: 92155404.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 104369972.6377; val_optim_loss: 104369972.6377
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.9746; val_best_acc_score: 0.8759; val_best_f1_score: 0.9319; train_kl_reg_loss: 245987.6042; train_edge_recon_loss: 10436411.1747; train_gene_expr_recon_loss: 90455536.5539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101137935.4203; train_optim_loss: 101137935.4203; val_kl_reg_loss: 229415.7294; val_edge_recon_loss: 11856881.4783; val_gene_expr_recon_loss: 89086921.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101173218.5507; val_optim_loss: 101173218.5507
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8600; val_auprc_score: 0.9699; val_best_acc_score: 0.8790; val_best_f1_score: 0.9335; train_kl_reg_loss: 233452.2440; train_edge_recon_loss: 10442909.1948; train_gene_expr_recon_loss: 87761093.5008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98437454.8921; train_optim_loss: 98437454.8921; val_kl_reg_loss: 222757.3034; val_edge_recon_loss: 11838278.6957; val_gene_expr_recon_loss: 86646694.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98707730.6667; val_optim_loss: 98707730.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8695; val_auprc_score: 0.9702; val_best_acc_score: 0.8966; val_best_f1_score: 0.9418; train_kl_reg_loss: 211603.5528; train_edge_recon_loss: 10403798.9694; train_gene_expr_recon_loss: 85380550.1449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95995952.7601; train_optim_loss: 95995952.7601; val_kl_reg_loss: 185610.3415; val_edge_recon_loss: 11355397.6087; val_gene_expr_recon_loss: 84412731.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95953739.1304; val_optim_loss: 95953739.1304
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8766; val_auprc_score: 0.9707; val_best_acc_score: 0.9008; val_best_f1_score: 0.9438; train_kl_reg_loss: 170292.7710; train_edge_recon_loss: 10237236.2303; train_gene_expr_recon_loss: 83384221.2689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93791750.2866; train_optim_loss: 93791750.2866; val_kl_reg_loss: 148432.9493; val_edge_recon_loss: 10763162.2754; val_gene_expr_recon_loss: 82575116.4058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93486711.6522; val_optim_loss: 93486711.6522
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8798; val_auprc_score: 0.9708; val_best_acc_score: 0.9048; val_best_f1_score: 0.9460; train_kl_reg_loss: 144965.6849; train_edge_recon_loss: 9735076.3519; train_gene_expr_recon_loss: 81553230.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91433272.3736; train_optim_loss: 91433272.3736; val_kl_reg_loss: 147045.9697; val_edge_recon_loss: 9781441.9710; val_gene_expr_recon_loss: 80778907.3623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90707395.0145; val_optim_loss: 90707395.0145
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8807; val_auprc_score: 0.9712; val_best_acc_score: 0.9039; val_best_f1_score: 0.9455; train_kl_reg_loss: 160899.7138; train_edge_recon_loss: 9331836.9396; train_gene_expr_recon_loss: 80137212.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89629949.6940; train_optim_loss: 89629949.6940; val_kl_reg_loss: 178892.9665; val_edge_recon_loss: 9279430.3478; val_gene_expr_recon_loss: 79632164.2899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89090487.8841; val_optim_loss: 89090487.8841
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8871; val_auprc_score: 0.9739; val_best_acc_score: 0.9057; val_best_f1_score: 0.9468; train_kl_reg_loss: 196515.0353; train_edge_recon_loss: 9020781.6973; train_gene_expr_recon_loss: 78968391.8325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88185688.6441; train_optim_loss: 88185688.6441; val_kl_reg_loss: 206678.9441; val_edge_recon_loss: 8927521.3333; val_gene_expr_recon_loss: 78557192.3478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87691392.1159; val_optim_loss: 87691392.1159
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8882; val_auprc_score: 0.9740; val_best_acc_score: 0.9088; val_best_f1_score: 0.9486; train_kl_reg_loss: 209919.5484; train_edge_recon_loss: 8776258.8889; train_gene_expr_recon_loss: 77992982.8921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86979161.3269; train_optim_loss: 86979161.3269; val_kl_reg_loss: 204206.8666; val_edge_recon_loss: 8771916.5870; val_gene_expr_recon_loss: 77596311.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86572434.2029; val_optim_loss: 86572434.2029
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8964; val_auprc_score: 0.9767; val_best_acc_score: 0.9130; val_best_f1_score: 0.9510; train_kl_reg_loss: 199430.5943; train_edge_recon_loss: 8574654.1224; train_gene_expr_recon_loss: 77197961.7262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85972046.3510; train_optim_loss: 85972046.3510; val_kl_reg_loss: 190985.4869; val_edge_recon_loss: 8550239.2319; val_gene_expr_recon_loss: 76913799.3043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85655024.0000; val_optim_loss: 85655024.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9133; val_auprc_score: 0.9809; val_best_acc_score: 0.9162; val_best_f1_score: 0.9525; train_kl_reg_loss: 183479.7403; train_edge_recon_loss: 8492512.7544; train_gene_expr_recon_loss: 76600098.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85276091.2850; train_optim_loss: 85276091.2850; val_kl_reg_loss: 173790.4271; val_edge_recon_loss: 8496121.3406; val_gene_expr_recon_loss: 76273348.6377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84943260.1739; val_optim_loss: 84943260.1739
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9234; val_auprc_score: 0.9829; val_best_acc_score: 0.9222; val_best_f1_score: 0.9553; train_kl_reg_loss: 166181.6610; train_edge_recon_loss: 8379537.4348; train_gene_expr_recon_loss: 76130832.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84676551.4203; train_optim_loss: 84676551.4203; val_kl_reg_loss: 160255.2826; val_edge_recon_loss: 8512318.9565; val_gene_expr_recon_loss: 76026372.2899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84698946.4348; val_optim_loss: 84698946.4348
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9269; val_auprc_score: 0.9840; val_best_acc_score: 0.9254; val_best_f1_score: 0.9574; train_kl_reg_loss: 140099.6760; train_edge_recon_loss: 8573632.9388; train_gene_expr_recon_loss: 77514150.3124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86227883.0531; train_optim_loss: 86227883.0531; val_kl_reg_loss: 84730.6993; val_edge_recon_loss: 8521631.7174; val_gene_expr_recon_loss: 77225129.7391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85831492.2899; val_optim_loss: 85831492.2899
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9293; val_auprc_score: 0.9847; val_best_acc_score: 0.9261; val_best_f1_score: 0.9579; train_kl_reg_loss: 103980.3428; train_edge_recon_loss: 8353251.2585; train_gene_expr_recon_loss: 76171335.9742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84628567.5362; train_optim_loss: 84628567.5362; val_kl_reg_loss: 114399.5819; val_edge_recon_loss: 8371913.5797; val_gene_expr_recon_loss: 75644319.4203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84130632.4638; val_optim_loss: 84130632.4638
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9355; val_auprc_score: 0.9861; val_best_acc_score: 0.9296; val_best_f1_score: 0.9598; train_kl_reg_loss: 113955.5798; train_edge_recon_loss: 8229529.8084; train_gene_expr_recon_loss: 75585230.1449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83928715.5684; train_optim_loss: 83928715.5684; val_kl_reg_loss: 115455.9317; val_edge_recon_loss: 8195201.2174; val_gene_expr_recon_loss: 75371981.5652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83682638.7246; val_optim_loss: 83682638.7246
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9407; val_auprc_score: 0.9872; val_best_acc_score: 0.9319; val_best_f1_score: 0.9611; train_kl_reg_loss: 112143.3979; train_edge_recon_loss: 8138893.0998; train_gene_expr_recon_loss: 75315842.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83566878.8148; train_optim_loss: 83566878.8148; val_kl_reg_loss: 105416.8034; val_edge_recon_loss: 8142832.1957; val_gene_expr_recon_loss: 75191734.6087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83439983.8841; val_optim_loss: 83439983.8841
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9464; val_auprc_score: 0.9879; val_best_acc_score: 0.9370; val_best_f1_score: 0.9638; train_kl_reg_loss: 106139.3312; train_edge_recon_loss: 8100095.1304; train_gene_expr_recon_loss: 75094904.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83301138.7826; train_optim_loss: 83301138.7826; val_kl_reg_loss: 112777.1912; val_edge_recon_loss: 8121086.6087; val_gene_expr_recon_loss: 76655342.1449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84889205.5652; val_optim_loss: 84889205.5652
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9535; val_auprc_score: 0.9894; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 99320.8252; train_edge_recon_loss: 8041521.6393; train_gene_expr_recon_loss: 75038742.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83179585.1208; train_optim_loss: 83179585.1208; val_kl_reg_loss: 100744.6739; val_edge_recon_loss: 8064975.2609; val_gene_expr_recon_loss: 75054073.7391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83219794.0870; val_optim_loss: 83219794.0870
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9582; val_auprc_score: 0.9903; val_best_acc_score: 0.9454; val_best_f1_score: 0.9684; train_kl_reg_loss: 94243.3110; train_edge_recon_loss: 7986876.1240; train_gene_expr_recon_loss: 74915045.5523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82996164.8438; train_optim_loss: 82996164.8438; val_kl_reg_loss: 94337.2020; val_edge_recon_loss: 7999681.2174; val_gene_expr_recon_loss: 75020123.9420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83114142.7246; val_optim_loss: 83114142.7246
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9606; val_auprc_score: 0.9908; val_best_acc_score: 0.9501; val_best_f1_score: 0.9712; train_kl_reg_loss: 90150.4959; train_edge_recon_loss: 7962878.1280; train_gene_expr_recon_loss: 74775676.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82828705.2882; train_optim_loss: 82828705.2882; val_kl_reg_loss: 86716.8339; val_edge_recon_loss: 7824429.8116; val_gene_expr_recon_loss: 74813727.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82724873.7391; val_optim_loss: 82724873.7391
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9626; val_auprc_score: 0.9911; val_best_acc_score: 0.9525; val_best_f1_score: 0.9725; train_kl_reg_loss: 87729.9881; train_edge_recon_loss: 7900452.3325; train_gene_expr_recon_loss: 74751416.9404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82739599.2915; train_optim_loss: 82739599.2915; val_kl_reg_loss: 88322.4672; val_edge_recon_loss: 7920978.6522; val_gene_expr_recon_loss: 74421182.9565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82430484.2899; val_optim_loss: 82430484.2899
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9665; val_auprc_score: 0.9921; val_best_acc_score: 0.9540; val_best_f1_score: 0.9733; train_kl_reg_loss: 85238.4979; train_edge_recon_loss: 7893929.4002; train_gene_expr_recon_loss: 74901909.5266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82881077.2689; train_optim_loss: 82881077.2689; val_kl_reg_loss: 80605.8056; val_edge_recon_loss: 7853945.7391; val_gene_expr_recon_loss: 73050237.7971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 80984789.1014; val_optim_loss: 80984789.1014
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9654; val_auprc_score: 0.9922; val_best_acc_score: 0.9545; val_best_f1_score: 0.9736; train_kl_reg_loss: 83202.6501; train_edge_recon_loss: 7898549.4227; train_gene_expr_recon_loss: 75112563.9936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83094316.2254; train_optim_loss: 83094316.2254; val_kl_reg_loss: 78803.7973; val_edge_recon_loss: 7862529.7391; val_gene_expr_recon_loss: 73929791.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81871125.9130; val_optim_loss: 81871125.9130
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9663; val_auprc_score: 0.9922; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 97021.8287; train_edge_recon_loss: 8089707.1771; train_gene_expr_recon_loss: 76096906.6280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84283635.4783; train_optim_loss: 84283635.4783; val_kl_reg_loss: 29497.6790; val_edge_recon_loss: 8005749.4348; val_gene_expr_recon_loss: 74097507.1304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82132753.9710; val_optim_loss: 82132753.9710
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9689; val_auprc_score: 0.9928; val_best_acc_score: 0.9579; val_best_f1_score: 0.9756; train_kl_reg_loss: 103698.4293; train_edge_recon_loss: 7994330.0974; train_gene_expr_recon_loss: 76089524.9147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84187553.3784; train_optim_loss: 84187553.3784; val_kl_reg_loss: 30573.5212; val_edge_recon_loss: 8018336.0725; val_gene_expr_recon_loss: 70858561.8551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 78907470.9565; val_optim_loss: 78907470.9565
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9626; val_auprc_score: 0.9913; val_best_acc_score: 0.9519; val_best_f1_score: 0.9722; train_kl_reg_loss: 138993.9547; train_edge_recon_loss: 8088562.1779; train_gene_expr_recon_loss: 79838864.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88066420.2770; train_optim_loss: 88066420.2770; val_kl_reg_loss: 32512.2412; val_edge_recon_loss: 8036676.2319; val_gene_expr_recon_loss: 85913864.4638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93983052.9855; val_optim_loss: 93983052.9855
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9656; val_auprc_score: 0.9919; val_best_acc_score: 0.9530; val_best_f1_score: 0.9728; train_kl_reg_loss: 130596.1228; train_edge_recon_loss: 8082937.2842; train_gene_expr_recon_loss: 81492166.1063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89705699.6329; train_optim_loss: 89705699.6329; val_kl_reg_loss: 31383.0419; val_edge_recon_loss: 7992580.8116; val_gene_expr_recon_loss: 93147650.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101171614.4928; val_optim_loss: 101171614.4928
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9663; val_auprc_score: 0.9922; val_best_acc_score: 0.9556; val_best_f1_score: 0.9742; train_kl_reg_loss: 113135.3840; train_edge_recon_loss: 7978535.1345; train_gene_expr_recon_loss: 86153584.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94245254.8277; train_optim_loss: 94245254.8277; val_kl_reg_loss: 31512.6610; val_edge_recon_loss: 7959991.5507; val_gene_expr_recon_loss: 93058989.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101050493.6812; val_optim_loss: 101050493.6812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9651; val_auprc_score: 0.9919; val_best_acc_score: 0.9563; val_best_f1_score: 0.9746; train_kl_reg_loss: 96251.9656; train_edge_recon_loss: 7945600.0588; train_gene_expr_recon_loss: 89458255.2850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97500107.2206; train_optim_loss: 97500107.2206; val_kl_reg_loss: 30384.9945; val_edge_recon_loss: 7917943.5725; val_gene_expr_recon_loss: 92292245.5652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100240574.1449; val_optim_loss: 100240574.1449

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9683; val_auprc_score: 0.9929; val_best_acc_score: 0.9571; val_best_f1_score: 0.9752; train_kl_reg_loss: 88876.9331; train_edge_recon_loss: 7937796.2182; train_gene_expr_recon_loss: 96102727.1626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104129400.3221; train_optim_loss: 104129400.3221; val_kl_reg_loss: 30967.3255; val_edge_recon_loss: 7934484.0217; val_gene_expr_recon_loss: 93231769.0435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101197220.2899; val_optim_loss: 101197220.2899
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9677; val_auprc_score: 0.9923; val_best_acc_score: 0.9584; val_best_f1_score: 0.9758; train_kl_reg_loss: 87826.1042; train_edge_recon_loss: 7904779.6200; train_gene_expr_recon_loss: 93202315.6715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101194921.5201; train_optim_loss: 101194921.5201; val_kl_reg_loss: 29976.3519; val_edge_recon_loss: 7915336.6812; val_gene_expr_recon_loss: 100757300.6377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108702612.9855; val_optim_loss: 108702612.9855
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9682; val_auprc_score: 0.9925; val_best_acc_score: 0.9600; val_best_f1_score: 0.9767; train_kl_reg_loss: 86224.5355; train_edge_recon_loss: 7913729.0934; train_gene_expr_recon_loss: 91014256.6184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99014210.2995; train_optim_loss: 99014210.2995; val_kl_reg_loss: 28547.8357; val_edge_recon_loss: 7890995.6304; val_gene_expr_recon_loss: 94391219.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 102310763.2464; val_optim_loss: 102310763.2464
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9680; val_auprc_score: 0.9927; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 84176.0482; train_edge_recon_loss: 7918037.5604; train_gene_expr_recon_loss: 95753792.5217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103756006.2093; train_optim_loss: 103756006.2093; val_kl_reg_loss: 28754.2921; val_edge_recon_loss: 7914666.6304; val_gene_expr_recon_loss: 83171608.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91115029.7971; val_optim_loss: 91115029.7971

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 473 min 6 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9669
Val AUPRC score: 0.9923
Val best accuracy score: 0.9572
Val best F1 score: 0.9752
Val gene expr MSE score: 7560.5815
Val cat covariate0 mean sim diff: -0.0047

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
