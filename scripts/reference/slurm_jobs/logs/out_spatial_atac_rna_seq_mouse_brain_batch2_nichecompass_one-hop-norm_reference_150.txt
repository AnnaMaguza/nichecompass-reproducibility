[True]
Run timestamp: 07082023_220426_150.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_150']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8873; val_auprc_score: 0.9016; val_best_acc_score: 0.5372; val_best_f1_score: 0.6833; train_kl_reg_loss: 20642.4690; train_edge_recon_loss: 3473696.0833; train_gene_expr_recon_loss: 1251942.7639; train_masked_gp_l1_reg_loss: 8453.2534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167109.8785; train_chrom_access_recon_loss: 728684.8438; train_global_loss: 5650529.1667; train_optim_loss: 5650529.1667; val_kl_reg_loss: 7285.9751; val_edge_recon_loss: 4062749.7500; val_gene_expr_recon_loss: 1073915.2500; val_masked_gp_l1_reg_loss: 6766.3550; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162120.2500; val_chrom_access_recon_loss: 504018.8438; val_global_loss: 5816857.0000; val_optim_loss: 5816857.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8780; val_auprc_score: 0.8895; val_best_acc_score: 0.5279; val_best_f1_score: 0.6789; train_kl_reg_loss: 9573.6502; train_edge_recon_loss: 3475142.1111; train_gene_expr_recon_loss: 976551.7431; train_masked_gp_l1_reg_loss: 6083.5605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158971.8906; train_chrom_access_recon_loss: 490579.7500; train_global_loss: 5116902.7222; train_optim_loss: 5116902.7222; val_kl_reg_loss: 13513.5430; val_edge_recon_loss: 4063596.5000; val_gene_expr_recon_loss: 866025.0625; val_masked_gp_l1_reg_loss: 5469.1631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155010.8750; val_chrom_access_recon_loss: 477998.5000; val_global_loss: 5581613.5000; val_optim_loss: 5581613.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8756; val_auprc_score: 0.8909; val_best_acc_score: 0.5437; val_best_f1_score: 0.6852; train_kl_reg_loss: 14470.6086; train_edge_recon_loss: 3478261.8056; train_gene_expr_recon_loss: 844929.9514; train_masked_gp_l1_reg_loss: 5351.9300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151456.4566; train_chrom_access_recon_loss: 468938.3924; train_global_loss: 4963409.0556; train_optim_loss: 4963409.0556; val_kl_reg_loss: 11741.2363; val_edge_recon_loss: 4062331.5000; val_gene_expr_recon_loss: 812880.5000; val_masked_gp_l1_reg_loss: 5293.2817; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146699.8281; val_chrom_access_recon_loss: 461675.8438; val_global_loss: 5500622.5000; val_optim_loss: 5500622.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8876; val_auprc_score: 0.8972; val_best_acc_score: 0.5571; val_best_f1_score: 0.6902; train_kl_reg_loss: 16204.4559; train_edge_recon_loss: 3478019.3333; train_gene_expr_recon_loss: 801369.8194; train_masked_gp_l1_reg_loss: 5259.4438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142518.7083; train_chrom_access_recon_loss: 458847.4861; train_global_loss: 4902219.4444; train_optim_loss: 4902219.4444; val_kl_reg_loss: 16232.7461; val_edge_recon_loss: 4059901.7500; val_gene_expr_recon_loss: 774437.6875; val_masked_gp_l1_reg_loss: 5224.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137102.9062; val_chrom_access_recon_loss: 456932.7500; val_global_loss: 5449832.0000; val_optim_loss: 5449832.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8927; val_auprc_score: 0.8900; val_best_acc_score: 0.6753; val_best_f1_score: 0.7495; train_kl_reg_loss: 17980.4455; train_edge_recon_loss: 3478603.2500; train_gene_expr_recon_loss: 770063.5764; train_masked_gp_l1_reg_loss: 5257.7168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132565.6207; train_chrom_access_recon_loss: 455107.1736; train_global_loss: 4859577.6667; train_optim_loss: 4859577.6667; val_kl_reg_loss: 17155.4531; val_edge_recon_loss: 4053234.7500; val_gene_expr_recon_loss: 750575.8125; val_masked_gp_l1_reg_loss: 5315.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126839.8594; val_chrom_access_recon_loss: 453272.6562; val_global_loss: 5406393.5000; val_optim_loss: 5406393.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8895; val_auprc_score: 0.8824; val_best_acc_score: 0.7850; val_best_f1_score: 0.8122; train_kl_reg_loss: 18192.7661; train_edge_recon_loss: 3478039.1389; train_gene_expr_recon_loss: 747513.4931; train_masked_gp_l1_reg_loss: 5387.8895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122250.2231; train_chrom_access_recon_loss: 451198.4688; train_global_loss: 4822581.9444; train_optim_loss: 4822581.9444; val_kl_reg_loss: 19967.4336; val_edge_recon_loss: 4036260.0000; val_gene_expr_recon_loss: 732571.7500; val_masked_gp_l1_reg_loss: 5473.1880; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116544.8047; val_chrom_access_recon_loss: 450671.8125; val_global_loss: 5361489.0000; val_optim_loss: 5361489.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8783; val_auprc_score: 0.8721; val_best_acc_score: 0.8029; val_best_f1_score: 0.7986; train_kl_reg_loss: 19352.5056; train_edge_recon_loss: 3476492.3611; train_gene_expr_recon_loss: 735839.4028; train_masked_gp_l1_reg_loss: 5555.8490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112062.8229; train_chrom_access_recon_loss: 450027.2500; train_global_loss: 4799330.1111; train_optim_loss: 4799330.1111; val_kl_reg_loss: 17366.6445; val_edge_recon_loss: 3988900.2500; val_gene_expr_recon_loss: 721218.8750; val_masked_gp_l1_reg_loss: 5643.8745; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106536.2109; val_chrom_access_recon_loss: 448770.6562; val_global_loss: 5288436.5000; val_optim_loss: 5288436.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8625; val_auprc_score: 0.8501; val_best_acc_score: 0.7828; val_best_f1_score: 0.7933; train_kl_reg_loss: 16713.6077; train_edge_recon_loss: 3461490.1389; train_gene_expr_recon_loss: 727870.8403; train_masked_gp_l1_reg_loss: 5723.6474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102276.8932; train_chrom_access_recon_loss: 448600.7778; train_global_loss: 4762675.7778; train_optim_loss: 4762675.7778; val_kl_reg_loss: 12269.5371; val_edge_recon_loss: 3764483.0000; val_gene_expr_recon_loss: 719571.3750; val_masked_gp_l1_reg_loss: 5814.1157; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97073.3125; val_chrom_access_recon_loss: 447832.9062; val_global_loss: 5047044.5000; val_optim_loss: 5047044.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8534; val_auprc_score: 0.8448; val_best_acc_score: 0.7661; val_best_f1_score: 0.7856; train_kl_reg_loss: 10073.0444; train_edge_recon_loss: 3324965.4444; train_gene_expr_recon_loss: 738029.8681; train_masked_gp_l1_reg_loss: 5917.8264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93168.4991; train_chrom_access_recon_loss: 449238.1424; train_global_loss: 4621392.8889; train_optim_loss: 4621392.8889; val_kl_reg_loss: 11885.8438; val_edge_recon_loss: 3108787.2500; val_gene_expr_recon_loss: 757217.8750; val_masked_gp_l1_reg_loss: 6053.9072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88484.1406; val_chrom_access_recon_loss: 450850.5000; val_global_loss: 4423280.0000; val_optim_loss: 4423280.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8698; val_auprc_score: 0.8569; val_best_acc_score: 0.7720; val_best_f1_score: 0.7918; train_kl_reg_loss: 25364.0352; train_edge_recon_loss: 2948952.8889; train_gene_expr_recon_loss: 766954.7639; train_masked_gp_l1_reg_loss: 6222.9859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85010.1597; train_chrom_access_recon_loss: 451378.7292; train_global_loss: 4283883.5556; train_optim_loss: 4283883.5556; val_kl_reg_loss: 44305.6562; val_edge_recon_loss: 2878348.2500; val_gene_expr_recon_loss: 753096.0000; val_masked_gp_l1_reg_loss: 6407.8252; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80760.5625; val_chrom_access_recon_loss: 450878.0312; val_global_loss: 4213796.5000; val_optim_loss: 4213796.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8859; val_auprc_score: 0.8694; val_best_acc_score: 0.7906; val_best_f1_score: 0.8087; train_kl_reg_loss: 49640.2956; train_edge_recon_loss: 2859303.6389; train_gene_expr_recon_loss: 740839.7986; train_masked_gp_l1_reg_loss: 6467.6808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77530.7543; train_chrom_access_recon_loss: 448718.6319; train_global_loss: 4182500.6667; train_optim_loss: 4182500.6667; val_kl_reg_loss: 47363.5625; val_edge_recon_loss: 2847916.5000; val_gene_expr_recon_loss: 730123.6250; val_masked_gp_l1_reg_loss: 6513.3525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73628.2812; val_chrom_access_recon_loss: 447279.8438; val_global_loss: 4152824.7500; val_optim_loss: 4152824.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9077; val_auprc_score: 0.8826; val_best_acc_score: 0.8374; val_best_f1_score: 0.8458; train_kl_reg_loss: 41142.6784; train_edge_recon_loss: 2829697.5556; train_gene_expr_recon_loss: 731961.5694; train_masked_gp_l1_reg_loss: 6527.8060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70734.4679; train_chrom_access_recon_loss: 448200.9062; train_global_loss: 4128265.0000; train_optim_loss: 4128265.0000; val_kl_reg_loss: 31923.1992; val_edge_recon_loss: 2795951.2500; val_gene_expr_recon_loss: 735627.0000; val_masked_gp_l1_reg_loss: 6543.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67240.1094; val_chrom_access_recon_loss: 447357.6250; val_global_loss: 4084642.0000; val_optim_loss: 4084642.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9242; val_auprc_score: 0.9018; val_best_acc_score: 0.8580; val_best_f1_score: 0.8672; train_kl_reg_loss: 32256.3568; train_edge_recon_loss: 2759307.4444; train_gene_expr_recon_loss: 736311.8194; train_masked_gp_l1_reg_loss: 6569.0415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64688.3806; train_chrom_access_recon_loss: 444922.7014; train_global_loss: 4044055.6667; train_optim_loss: 4044055.6667; val_kl_reg_loss: 35349.3359; val_edge_recon_loss: 2764814.0000; val_gene_expr_recon_loss: 731489.2500; val_masked_gp_l1_reg_loss: 6581.9780; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61635.3594; val_chrom_access_recon_loss: 446514.6562; val_global_loss: 4046384.5000; val_optim_loss: 4046384.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9317; val_auprc_score: 0.9094; val_best_acc_score: 0.8715; val_best_f1_score: 0.8791; train_kl_reg_loss: 39994.4596; train_edge_recon_loss: 2738120.1667; train_gene_expr_recon_loss: 728935.5833; train_masked_gp_l1_reg_loss: 6608.3338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59399.5859; train_chrom_access_recon_loss: 443753.1146; train_global_loss: 4016811.2222; train_optim_loss: 4016811.2222; val_kl_reg_loss: 43645.4453; val_edge_recon_loss: 2729876.7500; val_gene_expr_recon_loss: 720647.4375; val_masked_gp_l1_reg_loss: 6651.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56717.5625; val_chrom_access_recon_loss: 444682.0938; val_global_loss: 4002220.7500; val_optim_loss: 4002220.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9286; val_auprc_score: 0.9064; val_best_acc_score: 0.8692; val_best_f1_score: 0.8768; train_kl_reg_loss: 44791.0799; train_edge_recon_loss: 2739859.1389; train_gene_expr_recon_loss: 721109.0347; train_masked_gp_l1_reg_loss: 6675.3346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54724.9306; train_chrom_access_recon_loss: 443758.7014; train_global_loss: 4010918.2500; train_optim_loss: 4010918.2500; val_kl_reg_loss: 43415.0234; val_edge_recon_loss: 2760534.5000; val_gene_expr_recon_loss: 716331.6250; val_masked_gp_l1_reg_loss: 6698.3174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52316.5625; val_chrom_access_recon_loss: 443620.2500; val_global_loss: 4022916.0000; val_optim_loss: 4022916.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9353; val_auprc_score: 0.9104; val_best_acc_score: 0.8797; val_best_f1_score: 0.8861; train_kl_reg_loss: 43962.1489; train_edge_recon_loss: 2736063.4167; train_gene_expr_recon_loss: 719201.6875; train_masked_gp_l1_reg_loss: 6711.7719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50548.3446; train_chrom_access_recon_loss: 444636.6736; train_global_loss: 4001124.0833; train_optim_loss: 4001124.0833; val_kl_reg_loss: 43137.4688; val_edge_recon_loss: 2719437.7500; val_gene_expr_recon_loss: 709689.1250; val_masked_gp_l1_reg_loss: 6737.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48406.0938; val_chrom_access_recon_loss: 442645.5625; val_global_loss: 3970053.5000; val_optim_loss: 3970053.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9394; val_auprc_score: 0.9206; val_best_acc_score: 0.8783; val_best_f1_score: 0.8870; train_kl_reg_loss: 43683.3164; train_edge_recon_loss: 2724597.1667; train_gene_expr_recon_loss: 713203.0833; train_masked_gp_l1_reg_loss: 6752.6795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46829.7648; train_chrom_access_recon_loss: 443715.8611; train_global_loss: 3978781.8889; train_optim_loss: 3978781.8889; val_kl_reg_loss: 42968.8672; val_edge_recon_loss: 2761131.7500; val_gene_expr_recon_loss: 706077.8125; val_masked_gp_l1_reg_loss: 6761.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44913.6641; val_chrom_access_recon_loss: 441747.8125; val_global_loss: 4003601.2500; val_optim_loss: 4003601.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9445; val_auprc_score: 0.9254; val_best_acc_score: 0.8851; val_best_f1_score: 0.8926; train_kl_reg_loss: 42961.9774; train_edge_recon_loss: 2721456.8611; train_gene_expr_recon_loss: 710984.1806; train_masked_gp_l1_reg_loss: 6786.2848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43496.8047; train_chrom_access_recon_loss: 441993.5069; train_global_loss: 3967679.6111; train_optim_loss: 3967679.6111; val_kl_reg_loss: 40277.2969; val_edge_recon_loss: 2735263.7500; val_gene_expr_recon_loss: 704879.5000; val_masked_gp_l1_reg_loss: 6808.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41777.6797; val_chrom_access_recon_loss: 441131.3125; val_global_loss: 3970138.2500; val_optim_loss: 3970138.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9466; val_auprc_score: 0.9242; val_best_acc_score: 0.8880; val_best_f1_score: 0.8953; train_kl_reg_loss: 39589.3190; train_edge_recon_loss: 2734614.6389; train_gene_expr_recon_loss: 708177.3819; train_masked_gp_l1_reg_loss: 6831.0426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40522.9657; train_chrom_access_recon_loss: 440579.7257; train_global_loss: 3970315.0278; train_optim_loss: 3970315.0278; val_kl_reg_loss: 37110.9297; val_edge_recon_loss: 2750947.2500; val_gene_expr_recon_loss: 702953.8125; val_masked_gp_l1_reg_loss: 6855.5854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38999.8555; val_chrom_access_recon_loss: 440343.1562; val_global_loss: 3977210.5000; val_optim_loss: 3977210.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9539; val_auprc_score: 0.9394; val_best_acc_score: 0.8983; val_best_f1_score: 0.9020; train_kl_reg_loss: 38232.6953; train_edge_recon_loss: 2713247.7222; train_gene_expr_recon_loss: 705949.3889; train_masked_gp_l1_reg_loss: 6879.9652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37873.4918; train_chrom_access_recon_loss: 439852.2535; train_global_loss: 3942035.5000; train_optim_loss: 3942035.5000; val_kl_reg_loss: 40262.8438; val_edge_recon_loss: 2713362.2500; val_gene_expr_recon_loss: 698924.7500; val_masked_gp_l1_reg_loss: 6910.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36514.3203; val_chrom_access_recon_loss: 439946.5938; val_global_loss: 3935921.0000; val_optim_loss: 3935921.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9544; val_auprc_score: 0.9345; val_best_acc_score: 0.9015; val_best_f1_score: 0.9066; train_kl_reg_loss: 40805.5525; train_edge_recon_loss: 2716442.2778; train_gene_expr_recon_loss: 705522.7083; train_masked_gp_l1_reg_loss: 6945.7113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35510.4314; train_chrom_access_recon_loss: 440181.7118; train_global_loss: 3945408.3889; train_optim_loss: 3945408.3889; val_kl_reg_loss: 38634.3750; val_edge_recon_loss: 2715892.2500; val_gene_expr_recon_loss: 699061.3750; val_masked_gp_l1_reg_loss: 6987.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34282.1523; val_chrom_access_recon_loss: 439002.5938; val_global_loss: 3933860.7500; val_optim_loss: 3933860.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9566; val_auprc_score: 0.9385; val_best_acc_score: 0.9003; val_best_f1_score: 0.9046; train_kl_reg_loss: 38765.9488; train_edge_recon_loss: 2711318.0833; train_gene_expr_recon_loss: 700288.5556; train_masked_gp_l1_reg_loss: 7018.1000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33377.1035; train_chrom_access_recon_loss: 438656.4167; train_global_loss: 3929424.2778; train_optim_loss: 3929424.2778; val_kl_reg_loss: 37209.6797; val_edge_recon_loss: 2719468.5000; val_gene_expr_recon_loss: 694566.3750; val_masked_gp_l1_reg_loss: 7047.9658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32267.1973; val_chrom_access_recon_loss: 438459.8750; val_global_loss: 3929019.5000; val_optim_loss: 3929019.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9575; val_auprc_score: 0.9412; val_best_acc_score: 0.9058; val_best_f1_score: 0.9103; train_kl_reg_loss: 37616.0187; train_edge_recon_loss: 2705358.8889; train_gene_expr_recon_loss: 697905.5903; train_masked_gp_l1_reg_loss: 7077.4197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31441.2112; train_chrom_access_recon_loss: 436562.5451; train_global_loss: 3915961.7222; train_optim_loss: 3915961.7222; val_kl_reg_loss: 36690.0977; val_edge_recon_loss: 2724706.5000; val_gene_expr_recon_loss: 695492.0625; val_masked_gp_l1_reg_loss: 7099.6431; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30435.5176; val_chrom_access_recon_loss: 437657.1250; val_global_loss: 3932081.0000; val_optim_loss: 3932081.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9662; val_auprc_score: 0.9530; val_best_acc_score: 0.9158; val_best_f1_score: 0.9196; train_kl_reg_loss: 38726.7565; train_edge_recon_loss: 2696019.5000; train_gene_expr_recon_loss: 703065.7708; train_masked_gp_l1_reg_loss: 7124.8535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29702.1304; train_chrom_access_recon_loss: 439719.1493; train_global_loss: 3914358.1667; train_optim_loss: 3914358.1667; val_kl_reg_loss: 37422.7656; val_edge_recon_loss: 2685671.5000; val_gene_expr_recon_loss: 692403.1875; val_masked_gp_l1_reg_loss: 7151.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28800.5547; val_chrom_access_recon_loss: 437105.6250; val_global_loss: 3888555.0000; val_optim_loss: 3888555.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9618; val_auprc_score: 0.9447; val_best_acc_score: 0.9124; val_best_f1_score: 0.9170; train_kl_reg_loss: 37069.1289; train_edge_recon_loss: 2694048.1667; train_gene_expr_recon_loss: 696143.7222; train_masked_gp_l1_reg_loss: 7190.5397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28136.1643; train_chrom_access_recon_loss: 436792.7361; train_global_loss: 3899380.4444; train_optim_loss: 3899380.4444; val_kl_reg_loss: 36040.3359; val_edge_recon_loss: 2695846.7500; val_gene_expr_recon_loss: 692054.0000; val_masked_gp_l1_reg_loss: 7225.2563; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27324.3184; val_chrom_access_recon_loss: 436549.4062; val_global_loss: 3895040.0000; val_optim_loss: 3895040.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9659; val_auprc_score: 0.9530; val_best_acc_score: 0.9139; val_best_f1_score: 0.9189; train_kl_reg_loss: 35195.4227; train_edge_recon_loss: 2690281.6389; train_gene_expr_recon_loss: 1051412.3125; train_masked_gp_l1_reg_loss: 7284.2807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26462.7713; train_chrom_access_recon_loss: 461355.7326; train_global_loss: 4271992.1667; train_optim_loss: 4271992.1667; val_kl_reg_loss: 15828.0918; val_edge_recon_loss: 2689453.0000; val_gene_expr_recon_loss: 1031115.7500; val_masked_gp_l1_reg_loss: 7328.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25251.5430; val_chrom_access_recon_loss: 461994.3750; val_global_loss: 4230971.5000; val_optim_loss: 4230971.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9647; val_auprc_score: 0.9497; val_best_acc_score: 0.9132; val_best_f1_score: 0.9165; train_kl_reg_loss: 31354.6580; train_edge_recon_loss: 2678992.8333; train_gene_expr_recon_loss: 1041332.2222; train_masked_gp_l1_reg_loss: 7385.6473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24205.3787; train_chrom_access_recon_loss: 460808.0208; train_global_loss: 4244078.7222; train_optim_loss: 4244078.7222; val_kl_reg_loss: 15395.1230; val_edge_recon_loss: 2671787.2500; val_gene_expr_recon_loss: 1033474.7500; val_masked_gp_l1_reg_loss: 7448.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22898.6504; val_chrom_access_recon_loss: 462005.4062; val_global_loss: 4213009.5000; val_optim_loss: 4213009.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9675; val_auprc_score: 0.9569; val_best_acc_score: 0.9153; val_best_f1_score: 0.9183; train_kl_reg_loss: 29860.4219; train_edge_recon_loss: 2673084.4167; train_gene_expr_recon_loss: 1038987.1597; train_masked_gp_l1_reg_loss: 7498.4265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21902.5178; train_chrom_access_recon_loss: 460054.4549; train_global_loss: 4231387.3889; train_optim_loss: 4231387.3889; val_kl_reg_loss: 15149.3398; val_edge_recon_loss: 2666449.7500; val_gene_expr_recon_loss: 1027741.3750; val_masked_gp_l1_reg_loss: 7559.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20696.6191; val_chrom_access_recon_loss: 460921.5000; val_global_loss: 4198518.0000; val_optim_loss: 4198518.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9641; val_auprc_score: 0.9477; val_best_acc_score: 0.9116; val_best_f1_score: 0.9156; train_kl_reg_loss: 28271.3368; train_edge_recon_loss: 2658644.8611; train_gene_expr_recon_loss: 1030524.4861; train_masked_gp_l1_reg_loss: 7532.5929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20505.0805; train_chrom_access_recon_loss: 459179.9271; train_global_loss: 4204658.3333; train_optim_loss: 4204658.3333; val_kl_reg_loss: 15360.0957; val_edge_recon_loss: 2691474.5000; val_gene_expr_recon_loss: 1026037.7500; val_masked_gp_l1_reg_loss: 7505.4194; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20295.2422; val_chrom_access_recon_loss: 460928.1875; val_global_loss: 4221601.0000; val_optim_loss: 4221601.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9666; val_auprc_score: 0.9524; val_best_acc_score: 0.9185; val_best_f1_score: 0.9214; train_kl_reg_loss: 27991.0686; train_edge_recon_loss: 2665732.2222; train_gene_expr_recon_loss: 1030676.1250; train_masked_gp_l1_reg_loss: 7499.9207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20167.0903; train_chrom_access_recon_loss: 460939.6354; train_global_loss: 4213006.1111; train_optim_loss: 4213006.1111; val_kl_reg_loss: 15002.2480; val_edge_recon_loss: 2655661.0000; val_gene_expr_recon_loss: 1027176.2500; val_masked_gp_l1_reg_loss: 7491.4590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20001.8535; val_chrom_access_recon_loss: 461019.5312; val_global_loss: 4186352.2500; val_optim_loss: 4186352.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9674; val_auprc_score: 0.9552; val_best_acc_score: 0.9148; val_best_f1_score: 0.9188; train_kl_reg_loss: 27456.6293; train_edge_recon_loss: 2656428.1944; train_gene_expr_recon_loss: 1035315.3958; train_masked_gp_l1_reg_loss: 7487.2504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19882.5786; train_chrom_access_recon_loss: 459551.3264; train_global_loss: 4206121.3056; train_optim_loss: 4206121.3056; val_kl_reg_loss: 14992.2422; val_edge_recon_loss: 2678232.2500; val_gene_expr_recon_loss: 1026224.8125; val_masked_gp_l1_reg_loss: 7483.2236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19737.0703; val_chrom_access_recon_loss: 460896.1875; val_global_loss: 4207565.5000; val_optim_loss: 4207565.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9668; val_auprc_score: 0.9568; val_best_acc_score: 0.9163; val_best_f1_score: 0.9204; train_kl_reg_loss: 27393.1131; train_edge_recon_loss: 2661022.9722; train_gene_expr_recon_loss: 1037453.2986; train_masked_gp_l1_reg_loss: 7482.4892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19628.0898; train_chrom_access_recon_loss: 461846.8472; train_global_loss: 4214826.7500; train_optim_loss: 4214826.7500; val_kl_reg_loss: 14999.2314; val_edge_recon_loss: 2667720.2500; val_gene_expr_recon_loss: 1026351.0625; val_masked_gp_l1_reg_loss: 7482.8276; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19498.9336; val_chrom_access_recon_loss: 460913.7188; val_global_loss: 4196966.0000; val_optim_loss: 4196966.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9600
val AUPRC score: 0.9430
val best accuracy score: 0.9069
val best F1 score: 0.9107
val target rna MSE score: 3.7720
val source rna MSE score: 3.5003
val target atac MSE score: 0.1343
val source atac MSE score: 0.0220
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
