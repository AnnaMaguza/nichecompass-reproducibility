[True]
Run timestamp: 26072023_040113_150.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_150']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9168; val_auprc_score: 0.9275; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 21089.0353; train_edge_recon_loss: 34720843.1111; train_gene_expr_recon_loss: 31062366.6667; train_masked_gp_l1_reg_loss: 1924.7164; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1088650.0278; train_global_loss: 66894873.7778; train_optim_loss: 66894873.7778; val_kl_reg_loss: 204332.3906; val_edge_recon_loss: 40651312.0000; val_gene_expr_recon_loss: 29325098.0000; val_masked_gp_l1_reg_loss: 1974.6368; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1093459.2500; val_global_loss: 71276176.0000; val_optim_loss: 71276176.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9114; val_auprc_score: 0.9201; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 90958.4822; train_edge_recon_loss: 34886264.4444; train_gene_expr_recon_loss: 28966147.7778; train_masked_gp_l1_reg_loss: 2071.6932; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1087384.8125; train_global_loss: 65032826.2222; train_optim_loss: 65032826.2222; val_kl_reg_loss: 121612.6406; val_edge_recon_loss: 40654404.0000; val_gene_expr_recon_loss: 27575946.0000; val_masked_gp_l1_reg_loss: 2223.7136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1078549.1250; val_global_loss: 69432736.0000; val_optim_loss: 69432736.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8996; val_auprc_score: 0.9131; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 130435.2786; train_edge_recon_loss: 34773988.8889; train_gene_expr_recon_loss: 26717822.8889; train_masked_gp_l1_reg_loss: 2372.0390; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047886.6736; train_global_loss: 62672505.7778; train_optim_loss: 62672505.7778; val_kl_reg_loss: 237171.9375; val_edge_recon_loss: 40654224.0000; val_gene_expr_recon_loss: 25967062.0000; val_masked_gp_l1_reg_loss: 2559.3774; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1062588.7500; val_global_loss: 67923608.0000; val_optim_loss: 67923608.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8975; val_auprc_score: 0.9061; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 207296.2786; train_edge_recon_loss: 34809573.7778; train_gene_expr_recon_loss: 25411817.3333; train_masked_gp_l1_reg_loss: 2685.8416; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033104.7917; train_global_loss: 61464477.7778; train_optim_loss: 61464477.7778; val_kl_reg_loss: 139164.0938; val_edge_recon_loss: 40653828.0000; val_gene_expr_recon_loss: 24599610.0000; val_masked_gp_l1_reg_loss: 2823.4912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046274.8750; val_global_loss: 66441700.0000; val_optim_loss: 66441700.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8943; val_auprc_score: 0.9057; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 252410.8125; train_edge_recon_loss: 34813000.4444; train_gene_expr_recon_loss: 23985234.0000; train_masked_gp_l1_reg_loss: 2902.3939; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016794.6111; train_global_loss: 60070342.2222; train_optim_loss: 60070342.2222; val_kl_reg_loss: 225020.6094; val_edge_recon_loss: 40653388.0000; val_gene_expr_recon_loss: 23480648.0000; val_masked_gp_l1_reg_loss: 2981.1157; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032591.7500; val_global_loss: 65394628.0000; val_optim_loss: 65394628.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8915; val_auprc_score: 0.8959; val_best_acc_score: 0.5119; val_best_f1_score: 0.6719; train_kl_reg_loss: 308397.2083; train_edge_recon_loss: 34821792.8889; train_gene_expr_recon_loss: 23131757.1111; train_masked_gp_l1_reg_loss: 3017.9952; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009156.6458; train_global_loss: 59274121.3333; train_optim_loss: 59274121.3333; val_kl_reg_loss: 262172.1875; val_edge_recon_loss: 40648456.0000; val_gene_expr_recon_loss: 22716154.0000; val_masked_gp_l1_reg_loss: 3052.5728; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024869.1875; val_global_loss: 64654704.0000; val_optim_loss: 64654704.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8916; val_auprc_score: 0.8952; val_best_acc_score: 0.5167; val_best_f1_score: 0.6739; train_kl_reg_loss: 334086.8472; train_edge_recon_loss: 34813890.6667; train_gene_expr_recon_loss: 22386816.6667; train_masked_gp_l1_reg_loss: 3070.3638; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992429.4097; train_global_loss: 58530294.2222; train_optim_loss: 58530294.2222; val_kl_reg_loss: 312766.4375; val_edge_recon_loss: 40643084.0000; val_gene_expr_recon_loss: 22144380.0000; val_masked_gp_l1_reg_loss: 3089.1233; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014335.9375; val_global_loss: 64117656.0000; val_optim_loss: 64117656.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8947; val_auprc_score: 0.8965; val_best_acc_score: 0.5274; val_best_f1_score: 0.6783; train_kl_reg_loss: 360510.0694; train_edge_recon_loss: 34817478.6667; train_gene_expr_recon_loss: 21866297.7778; train_masked_gp_l1_reg_loss: 3100.7786; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986664.3819; train_global_loss: 58034050.2222; train_optim_loss: 58034050.2222; val_kl_reg_loss: 301074.6875; val_edge_recon_loss: 40633016.0000; val_gene_expr_recon_loss: 21798558.0000; val_masked_gp_l1_reg_loss: 3114.9043; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011671.1875; val_global_loss: 63747436.0000; val_optim_loss: 63747436.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8991; val_auprc_score: 0.8995; val_best_acc_score: 0.5528; val_best_f1_score: 0.6901; train_kl_reg_loss: 346294.4722; train_edge_recon_loss: 34855216.4444; train_gene_expr_recon_loss: 21685845.3333; train_masked_gp_l1_reg_loss: 3125.2638; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986554.3333; train_global_loss: 57877036.0000; train_optim_loss: 57877036.0000; val_kl_reg_loss: 275041.4688; val_edge_recon_loss: 40621408.0000; val_gene_expr_recon_loss: 21565708.0000; val_masked_gp_l1_reg_loss: 3137.5803; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008454.7500; val_global_loss: 63473748.0000; val_optim_loss: 63473748.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9055; val_auprc_score: 0.9030; val_best_acc_score: 0.5986; val_best_f1_score: 0.7125; train_kl_reg_loss: 345283.7465; train_edge_recon_loss: 34838899.1111; train_gene_expr_recon_loss: 21273696.0000; train_masked_gp_l1_reg_loss: 3148.3223; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979413.8681; train_global_loss: 57440440.4444; train_optim_loss: 57440440.4444; val_kl_reg_loss: 275887.6562; val_edge_recon_loss: 40598156.0000; val_gene_expr_recon_loss: 21432504.0000; val_masked_gp_l1_reg_loss: 3160.6790; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006761.3125; val_global_loss: 63316468.0000; val_optim_loss: 63316468.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9011; val_auprc_score: 0.8931; val_best_acc_score: 0.6459; val_best_f1_score: 0.7368; train_kl_reg_loss: 331293.6771; train_edge_recon_loss: 34863485.7778; train_gene_expr_recon_loss: 21231163.5556; train_masked_gp_l1_reg_loss: 3170.9896; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978933.0694; train_global_loss: 57408047.1111; train_optim_loss: 57408047.1111; val_kl_reg_loss: 262196.1875; val_edge_recon_loss: 40568848.0000; val_gene_expr_recon_loss: 21335602.0000; val_masked_gp_l1_reg_loss: 3184.3518; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004659.8750; val_global_loss: 63174492.0000; val_optim_loss: 63174492.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9077; val_auprc_score: 0.9018; val_best_acc_score: 0.6993; val_best_f1_score: 0.7655; train_kl_reg_loss: 308358.5417; train_edge_recon_loss: 34854126.2222; train_gene_expr_recon_loss: 21089106.4444; train_masked_gp_l1_reg_loss: 3195.8314; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977057.8681; train_global_loss: 57231845.3333; train_optim_loss: 57231845.3333; val_kl_reg_loss: 245573.9688; val_edge_recon_loss: 40529396.0000; val_gene_expr_recon_loss: 21254346.0000; val_masked_gp_l1_reg_loss: 3210.9233; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001314.0000; val_global_loss: 63033840.0000; val_optim_loss: 63033840.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9063; val_auprc_score: 0.8990; val_best_acc_score: 0.7575; val_best_f1_score: 0.7985; train_kl_reg_loss: 310426.6962; train_edge_recon_loss: 34829598.6667; train_gene_expr_recon_loss: 21047790.2222; train_masked_gp_l1_reg_loss: 3222.4023; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971969.4653; train_global_loss: 57163008.4444; train_optim_loss: 57163008.4444; val_kl_reg_loss: 252908.2344; val_edge_recon_loss: 40439784.0000; val_gene_expr_recon_loss: 21173406.0000; val_masked_gp_l1_reg_loss: 3236.7700; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1000161.1875; val_global_loss: 62869492.0000; val_optim_loss: 62869492.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9042; val_auprc_score: 0.8938; val_best_acc_score: 0.8022; val_best_f1_score: 0.8239; train_kl_reg_loss: 291179.2917; train_edge_recon_loss: 34823296.8889; train_gene_expr_recon_loss: 20978068.8889; train_masked_gp_l1_reg_loss: 3248.5935; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969970.1389; train_global_loss: 57065764.0000; train_optim_loss: 57065764.0000; val_kl_reg_loss: 241982.0938; val_edge_recon_loss: 40293156.0000; val_gene_expr_recon_loss: 21128506.0000; val_masked_gp_l1_reg_loss: 3263.5876; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999411.6250; val_global_loss: 62666324.0000; val_optim_loss: 62666324.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9078; val_auprc_score: 0.8990; val_best_acc_score: 0.8266; val_best_f1_score: 0.8343; train_kl_reg_loss: 284108.0885; train_edge_recon_loss: 34790598.6667; train_gene_expr_recon_loss: 20951268.6667; train_masked_gp_l1_reg_loss: 3277.0728; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976010.5000; train_global_loss: 57005263.1111; train_optim_loss: 57005263.1111; val_kl_reg_loss: 208320.4375; val_edge_recon_loss: 40063700.0000; val_gene_expr_recon_loss: 21089826.0000; val_masked_gp_l1_reg_loss: 3294.3469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997887.6875; val_global_loss: 62363032.0000; val_optim_loss: 62363032.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9011; val_auprc_score: 0.8886; val_best_acc_score: 0.8149; val_best_f1_score: 0.8065; train_kl_reg_loss: 256398.0816; train_edge_recon_loss: 34780068.8889; train_gene_expr_recon_loss: 20953332.0000; train_masked_gp_l1_reg_loss: 3307.4717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973045.0278; train_global_loss: 56966150.2222; train_optim_loss: 56966150.2222; val_kl_reg_loss: 199045.8906; val_edge_recon_loss: 39475768.0000; val_gene_expr_recon_loss: 21065950.0000; val_masked_gp_l1_reg_loss: 3322.8516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998201.6875; val_global_loss: 61742284.0000; val_optim_loss: 61742284.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9108; val_auprc_score: 0.8971; val_best_acc_score: 0.8228; val_best_f1_score: 0.8393; train_kl_reg_loss: 223256.1719; train_edge_recon_loss: 34627356.0000; train_gene_expr_recon_loss: 20981786.8889; train_masked_gp_l1_reg_loss: 3335.4098; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974847.3125; train_global_loss: 56810580.8889; train_optim_loss: 56810580.8889; val_kl_reg_loss: 146411.7031; val_edge_recon_loss: 38043852.0000; val_gene_expr_recon_loss: 21095868.0000; val_masked_gp_l1_reg_loss: 3349.8364; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997639.4375; val_global_loss: 60287120.0000; val_optim_loss: 60287120.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8991; val_auprc_score: 0.8818; val_best_acc_score: 0.8155; val_best_f1_score: 0.8306; train_kl_reg_loss: 142154.6502; train_edge_recon_loss: 34019377.5556; train_gene_expr_recon_loss: 21229860.8889; train_masked_gp_l1_reg_loss: 3364.9248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978441.5347; train_global_loss: 56373197.7778; train_optim_loss: 56373197.7778; val_kl_reg_loss: 80656.0625; val_edge_recon_loss: 34232588.0000; val_gene_expr_recon_loss: 21459068.0000; val_masked_gp_l1_reg_loss: 3386.8115; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004015.0625; val_global_loss: 56779716.0000; val_optim_loss: 56779716.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8843; val_auprc_score: 0.8680; val_best_acc_score: 0.7874; val_best_f1_score: 0.8047; train_kl_reg_loss: 67475.0191; train_edge_recon_loss: 31440282.4444; train_gene_expr_recon_loss: 21584043.7778; train_masked_gp_l1_reg_loss: 3419.6345; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981992.4167; train_global_loss: 54077211.5556; train_optim_loss: 54077211.5556; val_kl_reg_loss: 81308.9219; val_edge_recon_loss: 29903724.0000; val_gene_expr_recon_loss: 22151478.0000; val_masked_gp_l1_reg_loss: 3473.7358; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016034.1250; val_global_loss: 53156020.0000; val_optim_loss: 53156020.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8800; val_auprc_score: 0.8637; val_best_acc_score: 0.7960; val_best_f1_score: 0.7936; train_kl_reg_loss: 128518.5295; train_edge_recon_loss: 29491020.6667; train_gene_expr_recon_loss: 21705660.4444; train_masked_gp_l1_reg_loss: 3527.0409; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982358.4861; train_global_loss: 52311084.4444; train_optim_loss: 52311084.4444; val_kl_reg_loss: 180045.4375; val_edge_recon_loss: 29338110.0000; val_gene_expr_recon_loss: 21583748.0000; val_masked_gp_l1_reg_loss: 3585.8086; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015277.9375; val_global_loss: 52120764.0000; val_optim_loss: 52120764.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8838; val_auprc_score: 0.8664; val_best_acc_score: 0.8087; val_best_f1_score: 0.8094; train_kl_reg_loss: 219568.9306; train_edge_recon_loss: 29206818.4444; train_gene_expr_recon_loss: 21240456.0000; train_masked_gp_l1_reg_loss: 3619.6487; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981133.3889; train_global_loss: 51651596.0000; train_optim_loss: 51651596.0000; val_kl_reg_loss: 253978.7656; val_edge_recon_loss: 28966370.0000; val_gene_expr_recon_loss: 21246418.0000; val_masked_gp_l1_reg_loss: 3656.2275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011154.1250; val_global_loss: 51481580.0000; val_optim_loss: 51481580.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8790; val_auprc_score: 0.8621; val_best_acc_score: 0.7996; val_best_f1_score: 0.8032; train_kl_reg_loss: 281547.4861; train_edge_recon_loss: 28796315.1111; train_gene_expr_recon_loss: 21012912.6667; train_masked_gp_l1_reg_loss: 3678.7120; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018810.6528; train_global_loss: 51113264.8889; train_optim_loss: 51113264.8889; val_kl_reg_loss: 296192.7500; val_edge_recon_loss: 29214830.0000; val_gene_expr_recon_loss: 21110056.0000; val_masked_gp_l1_reg_loss: 3702.0044; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1000644.1250; val_global_loss: 51625428.0000; val_optim_loss: 51625428.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8899; val_auprc_score: 0.8754; val_best_acc_score: 0.8045; val_best_f1_score: 0.8076; train_kl_reg_loss: 304613.9826; train_edge_recon_loss: 28654805.5556; train_gene_expr_recon_loss: 20959075.7778; train_masked_gp_l1_reg_loss: 3716.2714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978367.3125; train_global_loss: 50900579.5556; train_optim_loss: 50900579.5556; val_kl_reg_loss: 297741.6250; val_edge_recon_loss: 28902730.0000; val_gene_expr_recon_loss: 21071876.0000; val_masked_gp_l1_reg_loss: 3733.3076; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997309.1875; val_global_loss: 51273388.0000; val_optim_loss: 51273388.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8946; val_auprc_score: 0.8779; val_best_acc_score: 0.8073; val_best_f1_score: 0.8226; train_kl_reg_loss: 305588.5278; train_edge_recon_loss: 28770626.8889; train_gene_expr_recon_loss: 20801134.2222; train_masked_gp_l1_reg_loss: 3747.3189; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024349.8125; train_global_loss: 50905447.1111; train_optim_loss: 50905447.1111; val_kl_reg_loss: 292941.7500; val_edge_recon_loss: 28572258.0000; val_gene_expr_recon_loss: 21055074.0000; val_masked_gp_l1_reg_loss: 3762.4795; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998875.5625; val_global_loss: 50922912.0000; val_optim_loss: 50922912.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8981; val_auprc_score: 0.8869; val_best_acc_score: 0.8088; val_best_f1_score: 0.8123; train_kl_reg_loss: 289016.1840; train_edge_recon_loss: 28659668.8889; train_gene_expr_recon_loss: 20758308.2222; train_masked_gp_l1_reg_loss: 3772.6891; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972255.8819; train_global_loss: 50683022.6667; train_optim_loss: 50683022.6667; val_kl_reg_loss: 283127.0000; val_edge_recon_loss: 28714476.0000; val_gene_expr_recon_loss: 21031050.0000; val_masked_gp_l1_reg_loss: 3785.0784; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 995987.8125; val_global_loss: 51028428.0000; val_optim_loss: 51028428.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9129; val_auprc_score: 0.8986; val_best_acc_score: 0.8305; val_best_f1_score: 0.8411; train_kl_reg_loss: 323703.3646; train_edge_recon_loss: 29906967.5556; train_gene_expr_recon_loss: 21622246.2222; train_masked_gp_l1_reg_loss: 3808.8741; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980224.8472; train_global_loss: 52836951.1111; train_optim_loss: 52836951.1111; val_kl_reg_loss: 54521.2188; val_edge_recon_loss: 29236346.0000; val_gene_expr_recon_loss: 21792236.0000; val_masked_gp_l1_reg_loss: 3854.0383; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008935.2500; val_global_loss: 52095896.0000; val_optim_loss: 52095896.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9065; val_auprc_score: 0.8870; val_best_acc_score: 0.8234; val_best_f1_score: 0.8352; train_kl_reg_loss: 439181.1111; train_edge_recon_loss: 29168084.8889; train_gene_expr_recon_loss: 21634607.5556; train_masked_gp_l1_reg_loss: 3899.1777; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979387.6875; train_global_loss: 52225159.1111; train_optim_loss: 52225159.1111; val_kl_reg_loss: 70049.2969; val_edge_recon_loss: 28922334.0000; val_gene_expr_recon_loss: 21745904.0000; val_masked_gp_l1_reg_loss: 3953.9302; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009280.1250; val_global_loss: 51751520.0000; val_optim_loss: 51751520.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9120; val_auprc_score: 0.8976; val_best_acc_score: 0.8277; val_best_f1_score: 0.8383; train_kl_reg_loss: 493565.8194; train_edge_recon_loss: 28712640.0000; train_gene_expr_recon_loss: 21497309.3333; train_masked_gp_l1_reg_loss: 3993.4824; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984213.6736; train_global_loss: 51691722.2222; train_optim_loss: 51691722.2222; val_kl_reg_loss: 85027.9531; val_edge_recon_loss: 28640502.0000; val_gene_expr_recon_loss: 21585492.0000; val_masked_gp_l1_reg_loss: 4038.4746; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006035.0625; val_global_loss: 51321100.0000; val_optim_loss: 51321100.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9143; val_auprc_score: 0.8966; val_best_acc_score: 0.8343; val_best_f1_score: 0.8423; train_kl_reg_loss: 499938.0104; train_edge_recon_loss: 28620623.3333; train_gene_expr_recon_loss: 21411059.3333; train_masked_gp_l1_reg_loss: 4041.4443; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983295.8889; train_global_loss: 51518957.7778; train_optim_loss: 51518957.7778; val_kl_reg_loss: 86361.2031; val_edge_recon_loss: 28622364.0000; val_gene_expr_recon_loss: 21509794.0000; val_masked_gp_l1_reg_loss: 4044.7048; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003808.2500; val_global_loss: 51226372.0000; val_optim_loss: 51226372.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9057; val_auprc_score: 0.8876; val_best_acc_score: 0.8258; val_best_f1_score: 0.8371; train_kl_reg_loss: 497757.1632; train_edge_recon_loss: 28558576.8889; train_gene_expr_recon_loss: 21403097.3333; train_masked_gp_l1_reg_loss: 4046.8085; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982306.2083; train_global_loss: 51445783.5556; train_optim_loss: 51445783.5556; val_kl_reg_loss: 87030.1328; val_edge_recon_loss: 28813302.0000; val_gene_expr_recon_loss: 21496884.0000; val_masked_gp_l1_reg_loss: 4049.2678; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1002926.5625; val_global_loss: 51404192.0000; val_optim_loss: 51404192.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9073; val_auprc_score: 0.8861; val_best_acc_score: 0.8310; val_best_f1_score: 0.8408; train_kl_reg_loss: 487081.5972; train_edge_recon_loss: 28658729.1111; train_gene_expr_recon_loss: 21268648.6667; train_masked_gp_l1_reg_loss: 4051.0938; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975834.1944; train_global_loss: 51394344.8889; train_optim_loss: 51394344.8889; val_kl_reg_loss: 87327.6406; val_edge_recon_loss: 28494764.0000; val_gene_expr_recon_loss: 21497636.0000; val_masked_gp_l1_reg_loss: 4053.4058; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005110.3750; val_global_loss: 51088892.0000; val_optim_loss: 51088892.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9084; val_auprc_score: 0.8870; val_best_acc_score: 0.8296; val_best_f1_score: 0.8382; train_kl_reg_loss: 487114.4062; train_edge_recon_loss: 28574155.7778; train_gene_expr_recon_loss: 21248051.1111; train_masked_gp_l1_reg_loss: 4055.2515; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978744.6389; train_global_loss: 51292120.4444; train_optim_loss: 51292120.4444; val_kl_reg_loss: 87739.6562; val_edge_recon_loss: 28766242.0000; val_gene_expr_recon_loss: 21478106.0000; val_masked_gp_l1_reg_loss: 4057.5864; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003775.1250; val_global_loss: 51339920.0000; val_optim_loss: 51339920.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 34 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9104
Val AUPRC score: 0.8931
Val best accuracy score: 0.8305
Val best F1 score: 0.8425
Val gene expr MSE score: 0.5536
Val chrom access MSE score: 0.0914
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
