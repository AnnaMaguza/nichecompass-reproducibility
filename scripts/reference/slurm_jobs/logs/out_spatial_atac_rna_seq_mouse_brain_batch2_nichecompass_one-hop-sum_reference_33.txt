[True]
Run timestamp: 10082023_201037_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7225; val_auprc_score: 0.7523; val_best_acc_score: 0.5043; val_best_f1_score: 0.6684; train_kl_reg_loss: 77727.7710; train_edge_recon_loss: 3792993.3550; train_gene_expr_recon_loss: 27621658.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16476039.0000; train_global_loss: 47968418.2290; train_optim_loss: 47968418.2290; val_kl_reg_loss: 162643.4448; val_edge_recon_loss: 4064906.1167; val_gene_expr_recon_loss: 23855885.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15682567.5333; val_global_loss: 43766002.6667; val_optim_loss: 43766002.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7256; val_auprc_score: 0.7578; val_best_acc_score: 0.6209; val_best_f1_score: 0.6872; train_kl_reg_loss: 144696.9751; train_edge_recon_loss: 3626460.0057; train_gene_expr_recon_loss: 23013980.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15540726.5573; train_global_loss: 42325863.9389; train_optim_loss: 42325863.9389; val_kl_reg_loss: 163391.3990; val_edge_recon_loss: 4055046.9333; val_gene_expr_recon_loss: 22544158.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15319060.4000; val_global_loss: 42081658.1333; val_optim_loss: 42081658.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7809; val_auprc_score: 0.7994; val_best_acc_score: 0.7002; val_best_f1_score: 0.7108; train_kl_reg_loss: 153265.3783; train_edge_recon_loss: 3548460.0076; train_gene_expr_recon_loss: 22269604.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15318796.4427; train_global_loss: 41290125.9542; train_optim_loss: 41290125.9542; val_kl_reg_loss: 145735.6031; val_edge_recon_loss: 4018973.0167; val_gene_expr_recon_loss: 22255103.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15230971.8000; val_global_loss: 41650784.2667; val_optim_loss: 41650784.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8677; val_auprc_score: 0.8620; val_best_acc_score: 0.7838; val_best_f1_score: 0.8011; train_kl_reg_loss: 129161.4714; train_edge_recon_loss: 3504612.4790; train_gene_expr_recon_loss: 22044388.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15228201.0229; train_global_loss: 40906363.0534; train_optim_loss: 40906363.0534; val_kl_reg_loss: 122590.4578; val_edge_recon_loss: 3646066.2500; val_gene_expr_recon_loss: 22003203.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15093181.8000; val_global_loss: 40865041.6000; val_optim_loss: 40865041.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8715; val_auprc_score: 0.8588; val_best_acc_score: 0.7771; val_best_f1_score: 0.7996; train_kl_reg_loss: 133290.6011; train_edge_recon_loss: 3144063.9962; train_gene_expr_recon_loss: 21879126.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15147851.8855; train_global_loss: 40304333.6489; train_optim_loss: 40304333.6489; val_kl_reg_loss: 167075.2448; val_edge_recon_loss: 3010801.2667; val_gene_expr_recon_loss: 21830134.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15042742.4667; val_global_loss: 40050754.1333; val_optim_loss: 40050754.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8851; val_auprc_score: 0.8709; val_best_acc_score: 0.8052; val_best_f1_score: 0.8202; train_kl_reg_loss: 149060.9598; train_edge_recon_loss: 2993826.6393; train_gene_expr_recon_loss: 21767015.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15093808.1908; train_global_loss: 40003711.5115; train_optim_loss: 40003711.5115; val_kl_reg_loss: 148825.8854; val_edge_recon_loss: 2992908.0833; val_gene_expr_recon_loss: 21741656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14957389.3333; val_global_loss: 39840779.2000; val_optim_loss: 39840779.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8841; val_auprc_score: 0.8712; val_best_acc_score: 0.8036; val_best_f1_score: 0.8237; train_kl_reg_loss: 145860.2017; train_edge_recon_loss: 2931313.5802; train_gene_expr_recon_loss: 21634040.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15019788.2214; train_global_loss: 39731002.1985; train_optim_loss: 39731002.1985; val_kl_reg_loss: 147460.7104; val_edge_recon_loss: 2952344.9000; val_gene_expr_recon_loss: 21606192.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14878150.6000; val_global_loss: 39584148.8000; val_optim_loss: 39584148.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9045; val_auprc_score: 0.8868; val_best_acc_score: 0.8278; val_best_f1_score: 0.8444; train_kl_reg_loss: 140168.8446; train_edge_recon_loss: 2903368.6145; train_gene_expr_recon_loss: 21512119.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14962288.7481; train_global_loss: 39517945.4656; train_optim_loss: 39517945.4656; val_kl_reg_loss: 138442.5083; val_edge_recon_loss: 2892646.6500; val_gene_expr_recon_loss: 21427974.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14747282.5333; val_global_loss: 39206346.9333; val_optim_loss: 39206346.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9113; val_auprc_score: 0.8946; val_best_acc_score: 0.8324; val_best_f1_score: 0.8468; train_kl_reg_loss: 138078.1943; train_edge_recon_loss: 2871723.6927; train_gene_expr_recon_loss: 21394281.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14889209.0305; train_global_loss: 39293292.0611; train_optim_loss: 39293292.0611; val_kl_reg_loss: 130366.9151; val_edge_recon_loss: 2868754.0500; val_gene_expr_recon_loss: 21380014.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14797922.6000; val_global_loss: 39177058.4000; val_optim_loss: 39177058.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9204; val_auprc_score: 0.9073; val_best_acc_score: 0.8433; val_best_f1_score: 0.8560; train_kl_reg_loss: 132218.3302; train_edge_recon_loss: 2856538.0725; train_gene_expr_recon_loss: 21315263.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14854369.5878; train_global_loss: 39158389.7099; train_optim_loss: 39158389.7099; val_kl_reg_loss: 135644.6760; val_edge_recon_loss: 2849376.4833; val_gene_expr_recon_loss: 21283960.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14755625.3333; val_global_loss: 39024606.6667; val_optim_loss: 39024606.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9308; val_auprc_score: 0.9175; val_best_acc_score: 0.8593; val_best_f1_score: 0.8689; train_kl_reg_loss: 130584.6963; train_edge_recon_loss: 2823018.4466; train_gene_expr_recon_loss: 21232609.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14810375.2672; train_global_loss: 38996588.1221; train_optim_loss: 38996588.1221; val_kl_reg_loss: 124945.0427; val_edge_recon_loss: 2822287.9167; val_gene_expr_recon_loss: 21221454.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14685619.6000; val_global_loss: 38854306.6667; val_optim_loss: 38854306.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9339; val_auprc_score: 0.9186; val_best_acc_score: 0.8646; val_best_f1_score: 0.8729; train_kl_reg_loss: 127393.2177; train_edge_recon_loss: 2817675.5439; train_gene_expr_recon_loss: 21158184.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14771294.1145; train_global_loss: 38874547.4198; train_optim_loss: 38874547.4198; val_kl_reg_loss: 126661.9255; val_edge_recon_loss: 2816381.4667; val_gene_expr_recon_loss: 21163583.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14652284.1333; val_global_loss: 38758911.7333; val_optim_loss: 38758911.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9434; val_auprc_score: 0.9336; val_best_acc_score: 0.8750; val_best_f1_score: 0.8813; train_kl_reg_loss: 123474.8516; train_edge_recon_loss: 2805838.1584; train_gene_expr_recon_loss: 21079716.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14716043.2977; train_global_loss: 38725072.9771; train_optim_loss: 38725072.9771; val_kl_reg_loss: 121988.9427; val_edge_recon_loss: 2813342.1667; val_gene_expr_recon_loss: 21132046.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14658611.4000; val_global_loss: 38725989.8667; val_optim_loss: 38725989.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9442; val_auprc_score: 0.9317; val_best_acc_score: 0.8771; val_best_f1_score: 0.8830; train_kl_reg_loss: 120955.6161; train_edge_recon_loss: 2800091.2099; train_gene_expr_recon_loss: 21025615.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14702283.5115; train_global_loss: 38648946.3206; train_optim_loss: 38648946.3206; val_kl_reg_loss: 120668.1750; val_edge_recon_loss: 2803159.9500; val_gene_expr_recon_loss: 21084880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14634137.6667; val_global_loss: 38642846.1333; val_optim_loss: 38642846.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9471; val_auprc_score: 0.9349; val_best_acc_score: 0.8847; val_best_f1_score: 0.8898; train_kl_reg_loss: 117020.4921; train_edge_recon_loss: 2778741.5210; train_gene_expr_recon_loss: 20985084.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14686985.0687; train_global_loss: 38567831.5420; train_optim_loss: 38567831.5420; val_kl_reg_loss: 118133.1734; val_edge_recon_loss: 2789127.9667; val_gene_expr_recon_loss: 20888383.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14526659.6667; val_global_loss: 38322304.0000; val_optim_loss: 38322304.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9541; val_auprc_score: 0.9414; val_best_acc_score: 0.8921; val_best_f1_score: 0.8975; train_kl_reg_loss: 114225.2487; train_edge_recon_loss: 2768394.1813; train_gene_expr_recon_loss: 20925503.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14652442.7481; train_global_loss: 38460565.1298; train_optim_loss: 38460565.1298; val_kl_reg_loss: 110747.7833; val_edge_recon_loss: 2769843.8500; val_gene_expr_recon_loss: 20923279.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14554091.7333; val_global_loss: 38357962.9333; val_optim_loss: 38357962.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9546; val_auprc_score: 0.9449; val_best_acc_score: 0.8929; val_best_f1_score: 0.8988; train_kl_reg_loss: 111013.5691; train_edge_recon_loss: 2768075.4714; train_gene_expr_recon_loss: 20907603.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14654356.7023; train_global_loss: 38441049.2824; train_optim_loss: 38441049.2824; val_kl_reg_loss: 108127.2026; val_edge_recon_loss: 2770586.9667; val_gene_expr_recon_loss: 20886365.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14530353.5333; val_global_loss: 38295433.8667; val_optim_loss: 38295433.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9580; val_auprc_score: 0.9502; val_best_acc_score: 0.8985; val_best_f1_score: 0.9029; train_kl_reg_loss: 108402.3315; train_edge_recon_loss: 2754200.6336; train_gene_expr_recon_loss: 20846416.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14615343.4809; train_global_loss: 38324363.6336; train_optim_loss: 38324363.6336; val_kl_reg_loss: 105757.3995; val_edge_recon_loss: 2765453.9500; val_gene_expr_recon_loss: 20907406.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14546530.5333; val_global_loss: 38325148.2667; val_optim_loss: 38325148.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9582; val_auprc_score: 0.9478; val_best_acc_score: 0.9020; val_best_f1_score: 0.9064; train_kl_reg_loss: 104928.5450; train_edge_recon_loss: 2751644.8855; train_gene_expr_recon_loss: 20811483.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14600569.7710; train_global_loss: 38268626.3817; train_optim_loss: 38268626.3817; val_kl_reg_loss: 104162.4172; val_edge_recon_loss: 2756386.9333; val_gene_expr_recon_loss: 20803953.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14460550.4000; val_global_loss: 38125052.5333; val_optim_loss: 38125052.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9567; val_auprc_score: 0.9462; val_best_acc_score: 0.8987; val_best_f1_score: 0.9032; train_kl_reg_loss: 102434.6652; train_edge_recon_loss: 2746541.7691; train_gene_expr_recon_loss: 20804074.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14604622.4733; train_global_loss: 38257673.8931; train_optim_loss: 38257673.8931; val_kl_reg_loss: 103797.9823; val_edge_recon_loss: 2764250.8333; val_gene_expr_recon_loss: 20798177.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14487884.2000; val_global_loss: 38154109.8667; val_optim_loss: 38154109.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9647; val_auprc_score: 0.9553; val_best_acc_score: 0.9100; val_best_f1_score: 0.9142; train_kl_reg_loss: 100790.6084; train_edge_recon_loss: 2735395.1412; train_gene_expr_recon_loss: 20760760.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14586006.0000; train_global_loss: 38182952.5191; train_optim_loss: 38182952.5191; val_kl_reg_loss: 98011.9156; val_edge_recon_loss: 2746841.0833; val_gene_expr_recon_loss: 20740986.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14432876.9333; val_global_loss: 38018716.8000; val_optim_loss: 38018716.8000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9654; val_auprc_score: 0.9548; val_best_acc_score: 0.9146; val_best_f1_score: 0.9173; train_kl_reg_loss: 98168.5021; train_edge_recon_loss: 2737236.6889; train_gene_expr_recon_loss: 20718385.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14554893.0916; train_global_loss: 38108683.6336; train_optim_loss: 38108683.6336; val_kl_reg_loss: 99609.8734; val_edge_recon_loss: 2740494.2500; val_gene_expr_recon_loss: 20679035.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14387550.2000; val_global_loss: 37906689.3333; val_optim_loss: 37906689.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9687; val_auprc_score: 0.9598; val_best_acc_score: 0.9185; val_best_f1_score: 0.9213; train_kl_reg_loss: 96900.8956; train_edge_recon_loss: 2722952.0687; train_gene_expr_recon_loss: 20703157.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14555540.7252; train_global_loss: 38078550.8092; train_optim_loss: 38078550.8092; val_kl_reg_loss: 96855.4438; val_edge_recon_loss: 2733194.0833; val_gene_expr_recon_loss: 20693879.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14412919.6667; val_global_loss: 37936848.5333; val_optim_loss: 37936848.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9667; val_auprc_score: 0.9591; val_best_acc_score: 0.9132; val_best_f1_score: 0.9170; train_kl_reg_loss: 94988.6918; train_edge_recon_loss: 2726944.6584; train_gene_expr_recon_loss: 20648460.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14527097.8473; train_global_loss: 37997491.5725; train_optim_loss: 37997491.5725; val_kl_reg_loss: 94167.1708; val_edge_recon_loss: 2741416.7333; val_gene_expr_recon_loss: 20747706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14490153.4000; val_global_loss: 38073443.7333; val_optim_loss: 38073443.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9685; val_auprc_score: 0.9575; val_best_acc_score: 0.9200; val_best_f1_score: 0.9231; train_kl_reg_loss: 93255.6879; train_edge_recon_loss: 2721638.1908; train_gene_expr_recon_loss: 20655240.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14552563.2977; train_global_loss: 38022697.2214; train_optim_loss: 38022697.2214; val_kl_reg_loss: 92240.9594; val_edge_recon_loss: 2721314.0333; val_gene_expr_recon_loss: 20709059.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14441503.3333; val_global_loss: 37964117.6000; val_optim_loss: 37964117.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9460; val_auprc_score: 0.9357; val_best_acc_score: 0.8798; val_best_f1_score: 0.8849; train_kl_reg_loss: 117110.3650; train_edge_recon_loss: 2883904.4599; train_gene_expr_recon_loss: 24026446.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15165949.3206; train_global_loss: 42193410.9924; train_optim_loss: 42193410.9924; val_kl_reg_loss: 16877.1764; val_edge_recon_loss: 2830964.1667; val_gene_expr_recon_loss: 24078227.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15084391.7333; val_global_loss: 42010460.2667; val_optim_loss: 42010460.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9471; val_auprc_score: 0.9352; val_best_acc_score: 0.8828; val_best_f1_score: 0.8902; train_kl_reg_loss: 95771.0317; train_edge_recon_loss: 2813195.5458; train_gene_expr_recon_loss: 24086630.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15177516.5878; train_global_loss: 42173113.7710; train_optim_loss: 42173113.7710; val_kl_reg_loss: 17093.3024; val_edge_recon_loss: 2802950.7167; val_gene_expr_recon_loss: 23994231.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15002976.0000; val_global_loss: 41817251.7333; val_optim_loss: 41817251.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9442; val_auprc_score: 0.9333; val_best_acc_score: 0.8770; val_best_f1_score: 0.8832; train_kl_reg_loss: 89758.4708; train_edge_recon_loss: 2802419.0840; train_gene_expr_recon_loss: 24012199.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15134274.9924; train_global_loss: 42038652.3664; train_optim_loss: 42038652.3664; val_kl_reg_loss: 17564.8359; val_edge_recon_loss: 2821611.9667; val_gene_expr_recon_loss: 24020115.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15049008.6000; val_global_loss: 41908301.6000; val_optim_loss: 41908301.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9492; val_auprc_score: 0.9369; val_best_acc_score: 0.8886; val_best_f1_score: 0.8936; train_kl_reg_loss: 84852.4328; train_edge_recon_loss: 2789105.7977; train_gene_expr_recon_loss: 24025804.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15164954.6336; train_global_loss: 42064717.0992; train_optim_loss: 42064717.0992; val_kl_reg_loss: 18185.4268; val_edge_recon_loss: 2788685.3667; val_gene_expr_recon_loss: 24044210.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15081072.1333; val_global_loss: 41932153.3333; val_optim_loss: 41932153.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9516; val_auprc_score: 0.9425; val_best_acc_score: 0.8863; val_best_f1_score: 0.8916; train_kl_reg_loss: 80105.6667; train_edge_recon_loss: 2784811.3664; train_gene_expr_recon_loss: 23993205.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15164558.2214; train_global_loss: 42022680.8855; train_optim_loss: 42022680.8855; val_kl_reg_loss: 18870.0689; val_edge_recon_loss: 2768699.4167; val_gene_expr_recon_loss: 24117933.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15101559.4000; val_global_loss: 42007061.8667; val_optim_loss: 42007061.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 15 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9620
val AUPRC score: 0.9540
val best accuracy score: 0.9054
val best F1 score: 0.9089
val target rna MSE score: 1.7264
val source rna MSE score: 48.7016
val target atac MSE score: 0.3561
val source atac MSE score: 3.1042
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
