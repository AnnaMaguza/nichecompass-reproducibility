[True]
Run timestamp: 26072023_232802_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8796; val_auprc_score: 0.9751; val_best_acc_score: 0.8472; val_best_f1_score: 0.9173; train_kl_reg_loss: 145802.8249; train_edge_recon_loss: 1120333.8270; train_gene_expr_recon_loss: 3030920.7698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4297057.4337; train_optim_loss: 4297057.4337; val_kl_reg_loss: 105790.3896; val_edge_recon_loss: 1240923.6849; val_gene_expr_recon_loss: 1398193.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2744907.3125; val_optim_loss: 2744907.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8694; val_auprc_score: 0.9742; val_best_acc_score: 0.8555; val_best_f1_score: 0.9219; train_kl_reg_loss: 74020.6561; train_edge_recon_loss: 1085351.3654; train_gene_expr_recon_loss: 1125770.1058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2285142.1320; train_optim_loss: 2285142.1320; val_kl_reg_loss: 56704.4308; val_edge_recon_loss: 1193577.9479; val_gene_expr_recon_loss: 1058926.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2309208.8542; val_optim_loss: 2309208.8542
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8504; val_auprc_score: 0.9713; val_best_acc_score: 0.8680; val_best_f1_score: 0.9274; train_kl_reg_loss: 57624.3180; train_edge_recon_loss: 1072861.3544; train_gene_expr_recon_loss: 1038241.1939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2168726.8762; train_optim_loss: 2168726.8762; val_kl_reg_loss: 52344.9674; val_edge_recon_loss: 1161145.5781; val_gene_expr_recon_loss: 1002986.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2216476.5312; val_optim_loss: 2216476.5312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8463; val_auprc_score: 0.9673; val_best_acc_score: 0.8731; val_best_f1_score: 0.9289; train_kl_reg_loss: 44736.5441; train_edge_recon_loss: 1049696.8674; train_gene_expr_recon_loss: 999766.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2094200.3349; train_optim_loss: 2094200.3349; val_kl_reg_loss: 37119.5916; val_edge_recon_loss: 1145410.4297; val_gene_expr_recon_loss: 970653.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2153183.8646; val_optim_loss: 2153183.8646
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8507; val_auprc_score: 0.9656; val_best_acc_score: 0.8860; val_best_f1_score: 0.9367; train_kl_reg_loss: 37533.7990; train_edge_recon_loss: 1015217.3968; train_gene_expr_recon_loss: 960070.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2012821.2535; train_optim_loss: 2012821.2535; val_kl_reg_loss: 36947.8040; val_edge_recon_loss: 973655.2344; val_gene_expr_recon_loss: 943885.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1954488.6875; val_optim_loss: 1954488.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8443; val_auprc_score: 0.9627; val_best_acc_score: 0.8911; val_best_f1_score: 0.9391; train_kl_reg_loss: 43607.8523; train_edge_recon_loss: 914940.4741; train_gene_expr_recon_loss: 932847.1904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1891395.5145; train_optim_loss: 1891395.5145; val_kl_reg_loss: 42819.0034; val_edge_recon_loss: 928373.9661; val_gene_expr_recon_loss: 917041.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1888234.6615; val_optim_loss: 1888234.6615
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8556; val_auprc_score: 0.9666; val_best_acc_score: 0.8971; val_best_f1_score: 0.9423; train_kl_reg_loss: 41975.4329; train_edge_recon_loss: 885892.9805; train_gene_expr_recon_loss: 906994.3599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1834862.7773; train_optim_loss: 1834862.7773; val_kl_reg_loss: 38838.0309; val_edge_recon_loss: 909376.6354; val_gene_expr_recon_loss: 893657.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1841871.7083; val_optim_loss: 1841871.7083
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8661; val_auprc_score: 0.9701; val_best_acc_score: 0.9054; val_best_f1_score: 0.9470; train_kl_reg_loss: 37332.5029; train_edge_recon_loss: 867864.5224; train_gene_expr_recon_loss: 886665.1965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1791862.2279; train_optim_loss: 1791862.2279; val_kl_reg_loss: 32903.5577; val_edge_recon_loss: 853226.0260; val_gene_expr_recon_loss: 875920.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1762050.2083; val_optim_loss: 1762050.2083
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8757; val_auprc_score: 0.9721; val_best_acc_score: 0.9073; val_best_f1_score: 0.9476; train_kl_reg_loss: 33421.5289; train_edge_recon_loss: 861894.4907; train_gene_expr_recon_loss: 869736.6672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1765052.6895; train_optim_loss: 1765052.6895; val_kl_reg_loss: 31096.2991; val_edge_recon_loss: 851224.9583; val_gene_expr_recon_loss: 858275.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1740596.2812; val_optim_loss: 1740596.2812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8854; val_auprc_score: 0.9739; val_best_acc_score: 0.9069; val_best_f1_score: 0.9468; train_kl_reg_loss: 30111.4326; train_edge_recon_loss: 840366.4265; train_gene_expr_recon_loss: 853824.3907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1724302.2500; train_optim_loss: 1724302.2500; val_kl_reg_loss: 27155.7676; val_edge_recon_loss: 844239.8880; val_gene_expr_recon_loss: 844149.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1715545.3906; val_optim_loss: 1715545.3906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9034; val_auprc_score: 0.9782; val_best_acc_score: 0.9151; val_best_f1_score: 0.9516; train_kl_reg_loss: 26680.3860; train_edge_recon_loss: 829514.9049; train_gene_expr_recon_loss: 839798.4985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1695993.7878; train_optim_loss: 1695993.7878; val_kl_reg_loss: 24872.2133; val_edge_recon_loss: 830701.2708; val_gene_expr_recon_loss: 831567.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1687140.7188; val_optim_loss: 1687140.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9083; val_auprc_score: 0.9794; val_best_acc_score: 0.9229; val_best_f1_score: 0.9559; train_kl_reg_loss: 23896.0065; train_edge_recon_loss: 811593.2695; train_gene_expr_recon_loss: 826201.3145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1661690.5878; train_optim_loss: 1661690.5878; val_kl_reg_loss: 22265.5134; val_edge_recon_loss: 838713.0417; val_gene_expr_recon_loss: 817392.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1678370.7708; val_optim_loss: 1678370.7708
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9213; val_auprc_score: 0.9824; val_best_acc_score: 0.9246; val_best_f1_score: 0.9566; train_kl_reg_loss: 21310.0631; train_edge_recon_loss: 811078.3584; train_gene_expr_recon_loss: 813592.8599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1645981.2860; train_optim_loss: 1645981.2860; val_kl_reg_loss: 17871.5151; val_edge_recon_loss: 834548.8073; val_gene_expr_recon_loss: 806372.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1658793.2708; val_optim_loss: 1658793.2708
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9268; val_auprc_score: 0.9825; val_best_acc_score: 0.9273; val_best_f1_score: 0.9581; train_kl_reg_loss: 18740.0822; train_edge_recon_loss: 803209.6965; train_gene_expr_recon_loss: 802549.1520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1624498.9273; train_optim_loss: 1624498.9273; val_kl_reg_loss: 17135.8710; val_edge_recon_loss: 817709.7474; val_gene_expr_recon_loss: 794094.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1628939.8177; val_optim_loss: 1628939.8177
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9336; val_auprc_score: 0.9857; val_best_acc_score: 0.9248; val_best_f1_score: 0.9567; train_kl_reg_loss: 16227.2933; train_edge_recon_loss: 804493.3797; train_gene_expr_recon_loss: 792423.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1613144.4866; train_optim_loss: 1613144.4866; val_kl_reg_loss: 14187.1922; val_edge_recon_loss: 802168.9479; val_gene_expr_recon_loss: 786108.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1602465.0833; val_optim_loss: 1602465.0833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9321; val_auprc_score: 0.9841; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 14371.9104; train_edge_recon_loss: 788539.4971; train_gene_expr_recon_loss: 783329.1439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1586240.5552; train_optim_loss: 1586240.5552; val_kl_reg_loss: 13925.5298; val_edge_recon_loss: 811669.2630; val_gene_expr_recon_loss: 776794.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1602389.2396; val_optim_loss: 1602389.2396
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9417; val_auprc_score: 0.9873; val_best_acc_score: 0.9302; val_best_f1_score: 0.9595; train_kl_reg_loss: 13114.1234; train_edge_recon_loss: 780035.4317; train_gene_expr_recon_loss: 774924.9956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1568074.5547; train_optim_loss: 1568074.5547; val_kl_reg_loss: 11507.2699; val_edge_recon_loss: 810162.4401; val_gene_expr_recon_loss: 769477.0443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1591146.7552; val_optim_loss: 1591146.7552
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9525; val_auprc_score: 0.9900; val_best_acc_score: 0.9341; val_best_f1_score: 0.9617; train_kl_reg_loss: 12399.1808; train_edge_recon_loss: 782230.3299; train_gene_expr_recon_loss: 767039.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1561668.9843; train_optim_loss: 1561668.9843; val_kl_reg_loss: 11922.8538; val_edge_recon_loss: 796275.8672; val_gene_expr_recon_loss: 760959.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1569158.1094; val_optim_loss: 1569158.1094
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9498; val_auprc_score: 0.9887; val_best_acc_score: 0.9377; val_best_f1_score: 0.9637; train_kl_reg_loss: 11962.2127; train_edge_recon_loss: 787718.7439; train_gene_expr_recon_loss: 759849.7084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1559530.6628; train_optim_loss: 1559530.6628; val_kl_reg_loss: 11519.0613; val_edge_recon_loss: 804271.0312; val_gene_expr_recon_loss: 755809.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1571599.9115; val_optim_loss: 1571599.9115
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9505; val_auprc_score: 0.9889; val_best_acc_score: 0.9360; val_best_f1_score: 0.9629; train_kl_reg_loss: 11657.3930; train_edge_recon_loss: 770665.2913; train_gene_expr_recon_loss: 753949.5730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1536272.2581; train_optim_loss: 1536272.2581; val_kl_reg_loss: 10998.9691; val_edge_recon_loss: 793201.0703; val_gene_expr_recon_loss: 749964.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554164.9115; val_optim_loss: 1554164.9115
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9541; val_auprc_score: 0.9894; val_best_acc_score: 0.9397; val_best_f1_score: 0.9650; train_kl_reg_loss: 11574.9465; train_edge_recon_loss: 774851.8791; train_gene_expr_recon_loss: 748192.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1534619.5779; train_optim_loss: 1534619.5779; val_kl_reg_loss: 11482.5005; val_edge_recon_loss: 807934.6641; val_gene_expr_recon_loss: 743848.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1563265.3802; val_optim_loss: 1563265.3802
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9486; val_auprc_score: 0.9888; val_best_acc_score: 0.9400; val_best_f1_score: 0.9652; train_kl_reg_loss: 11471.8325; train_edge_recon_loss: 771850.3026; train_gene_expr_recon_loss: 743806.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1527128.1558; train_optim_loss: 1527128.1558; val_kl_reg_loss: 11130.7229; val_edge_recon_loss: 789675.0807; val_gene_expr_recon_loss: 740103.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1540909.3646; val_optim_loss: 1540909.3646
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9520; val_auprc_score: 0.9890; val_best_acc_score: 0.9426; val_best_f1_score: 0.9666; train_kl_reg_loss: 11395.4782; train_edge_recon_loss: 778336.0558; train_gene_expr_recon_loss: 739095.5712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528827.1006; train_optim_loss: 1528827.1006; val_kl_reg_loss: 10728.4929; val_edge_recon_loss: 810999.2630; val_gene_expr_recon_loss: 735666.2135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1557393.9635; val_optim_loss: 1557393.9635
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9546; val_auprc_score: 0.9887; val_best_acc_score: 0.9424; val_best_f1_score: 0.9669; train_kl_reg_loss: 11188.9213; train_edge_recon_loss: 774354.0047; train_gene_expr_recon_loss: 734749.5892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520292.5116; train_optim_loss: 1520292.5116; val_kl_reg_loss: 10633.4628; val_edge_recon_loss: 772169.1120; val_gene_expr_recon_loss: 730055.3464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512857.9271; val_optim_loss: 1512857.9271
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9569; val_auprc_score: 0.9892; val_best_acc_score: 0.9441; val_best_f1_score: 0.9676; train_kl_reg_loss: 10979.2624; train_edge_recon_loss: 779988.7840; train_gene_expr_recon_loss: 731054.7128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1522022.7605; train_optim_loss: 1522022.7605; val_kl_reg_loss: 10999.8135; val_edge_recon_loss: 785146.2734; val_gene_expr_recon_loss: 727078.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1523224.5990; val_optim_loss: 1523224.5990
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9553; val_auprc_score: 0.9888; val_best_acc_score: 0.9478; val_best_f1_score: 0.9697; train_kl_reg_loss: 9818.4919; train_edge_recon_loss: 771965.8767; train_gene_expr_recon_loss: 733971.1555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1515755.5262; train_optim_loss: 1515755.5262; val_kl_reg_loss: 6368.0452; val_edge_recon_loss: 788927.1120; val_gene_expr_recon_loss: 729982.3073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1525277.4635; val_optim_loss: 1525277.4635
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9586; val_auprc_score: 0.9903; val_best_acc_score: 0.9471; val_best_f1_score: 0.9694; train_kl_reg_loss: 8925.1554; train_edge_recon_loss: 767590.2035; train_gene_expr_recon_loss: 729461.2613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505976.6180; train_optim_loss: 1505976.6180; val_kl_reg_loss: 5968.3438; val_edge_recon_loss: 784079.0651; val_gene_expr_recon_loss: 726589.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516636.5312; val_optim_loss: 1516636.5312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9579; val_auprc_score: 0.9905; val_best_acc_score: 0.9494; val_best_f1_score: 0.9707; train_kl_reg_loss: 8313.4885; train_edge_recon_loss: 771373.4953; train_gene_expr_recon_loss: 726908.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506595.6907; train_optim_loss: 1506595.6907; val_kl_reg_loss: 5693.1800; val_edge_recon_loss: 783887.1328; val_gene_expr_recon_loss: 725135.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514715.4688; val_optim_loss: 1514715.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9566; val_auprc_score: 0.9895; val_best_acc_score: 0.9493; val_best_f1_score: 0.9706; train_kl_reg_loss: 8087.3753; train_edge_recon_loss: 767247.2265; train_gene_expr_recon_loss: 723771.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499106.4378; train_optim_loss: 1499106.4378; val_kl_reg_loss: 5875.1094; val_edge_recon_loss: 778237.4922; val_gene_expr_recon_loss: 722918.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507030.9479; val_optim_loss: 1507030.9479
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9573; val_auprc_score: 0.9888; val_best_acc_score: 0.9501; val_best_f1_score: 0.9709; train_kl_reg_loss: 7984.5781; train_edge_recon_loss: 770241.8805; train_gene_expr_recon_loss: 723334.2297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501560.6936; train_optim_loss: 1501560.6936; val_kl_reg_loss: 5717.2992; val_edge_recon_loss: 778291.0208; val_gene_expr_recon_loss: 721468.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1505477.1302; val_optim_loss: 1505477.1302
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9624; val_auprc_score: 0.9912; val_best_acc_score: 0.9526; val_best_f1_score: 0.9724; train_kl_reg_loss: 7961.6934; train_edge_recon_loss: 771269.9058; train_gene_expr_recon_loss: 723158.2892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1502389.8936; train_optim_loss: 1502389.8936; val_kl_reg_loss: 5792.3732; val_edge_recon_loss: 791331.1250; val_gene_expr_recon_loss: 721403.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1518526.6250; val_optim_loss: 1518526.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9602; val_auprc_score: 0.9908; val_best_acc_score: 0.9512; val_best_f1_score: 0.9717; train_kl_reg_loss: 7875.0960; train_edge_recon_loss: 764786.7794; train_gene_expr_recon_loss: 722487.0422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495148.9169; train_optim_loss: 1495148.9169; val_kl_reg_loss: 5729.8307; val_edge_recon_loss: 767303.0990; val_gene_expr_recon_loss: 721451.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494484.0417; val_optim_loss: 1494484.0417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9612; val_auprc_score: 0.9906; val_best_acc_score: 0.9518; val_best_f1_score: 0.9720; train_kl_reg_loss: 7790.5697; train_edge_recon_loss: 768575.7677; train_gene_expr_recon_loss: 722310.2942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1498676.6250; train_optim_loss: 1498676.6250; val_kl_reg_loss: 5606.3877; val_edge_recon_loss: 780410.2135; val_gene_expr_recon_loss: 721052.4349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507069.0417; val_optim_loss: 1507069.0417
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9629; val_auprc_score: 0.9917; val_best_acc_score: 0.9505; val_best_f1_score: 0.9714; train_kl_reg_loss: 7804.6244; train_edge_recon_loss: 768086.6192; train_gene_expr_recon_loss: 721904.7872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497796.0273; train_optim_loss: 1497796.0273; val_kl_reg_loss: 5640.5734; val_edge_recon_loss: 785670.7708; val_gene_expr_recon_loss: 720697.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512008.6771; val_optim_loss: 1512008.6771
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9591; val_auprc_score: 0.9905; val_best_acc_score: 0.9513; val_best_f1_score: 0.9719; train_kl_reg_loss: 7668.0461; train_edge_recon_loss: 767372.8390; train_gene_expr_recon_loss: 721705.1965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1496746.0843; train_optim_loss: 1496746.0843; val_kl_reg_loss: 5544.3250; val_edge_recon_loss: 769456.9010; val_gene_expr_recon_loss: 719457.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494458.8281; val_optim_loss: 1494458.8281
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9594; val_auprc_score: 0.9905; val_best_acc_score: 0.9542; val_best_f1_score: 0.9736; train_kl_reg_loss: 7630.0380; train_edge_recon_loss: 768938.1765; train_gene_expr_recon_loss: 721087.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497655.7541; train_optim_loss: 1497655.7541; val_kl_reg_loss: 5658.8637; val_edge_recon_loss: 762183.4375; val_gene_expr_recon_loss: 720288.4505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488130.7500; val_optim_loss: 1488130.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9639; val_auprc_score: 0.9919; val_best_acc_score: 0.9542; val_best_f1_score: 0.9734; train_kl_reg_loss: 7600.8166; train_edge_recon_loss: 766634.2363; train_gene_expr_recon_loss: 720684.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1494919.5302; train_optim_loss: 1494919.5302; val_kl_reg_loss: 5577.0459; val_edge_recon_loss: 771399.6016; val_gene_expr_recon_loss: 718789.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1495765.9167; val_optim_loss: 1495765.9167
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9589; val_auprc_score: 0.9900; val_best_acc_score: 0.9515; val_best_f1_score: 0.9719; train_kl_reg_loss: 7486.0051; train_edge_recon_loss: 763054.1680; train_gene_expr_recon_loss: 720676.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491216.5657; train_optim_loss: 1491216.5657; val_kl_reg_loss: 5607.1674; val_edge_recon_loss: 788852.1042; val_gene_expr_recon_loss: 719103.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513562.3854; val_optim_loss: 1513562.3854
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9627; val_auprc_score: 0.9914; val_best_acc_score: 0.9525; val_best_f1_score: 0.9724; train_kl_reg_loss: 7443.3306; train_edge_recon_loss: 761579.2305; train_gene_expr_recon_loss: 720194.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489217.3831; train_optim_loss: 1489217.3831; val_kl_reg_loss: 5596.2143; val_edge_recon_loss: 789899.8984; val_gene_expr_recon_loss: 718277.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513773.4948; val_optim_loss: 1513773.4948
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9622; val_auprc_score: 0.9910; val_best_acc_score: 0.9530; val_best_f1_score: 0.9727; train_kl_reg_loss: 7316.1743; train_edge_recon_loss: 763288.5311; train_gene_expr_recon_loss: 719914.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490519.5047; train_optim_loss: 1490519.5047; val_kl_reg_loss: 5429.9496; val_edge_recon_loss: 786159.3802; val_gene_expr_recon_loss: 718358.0026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509947.3333; val_optim_loss: 1509947.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9607; val_auprc_score: 0.9908; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 7194.4436; train_edge_recon_loss: 763858.9259; train_gene_expr_recon_loss: 719273.0863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490326.4605; train_optim_loss: 1490326.4605; val_kl_reg_loss: 5444.8628; val_edge_recon_loss: 771791.8490; val_gene_expr_recon_loss: 717945.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1495182.6302; val_optim_loss: 1495182.6302
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9677; val_auprc_score: 0.9928; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 7246.1375; train_edge_recon_loss: 763260.2026; train_gene_expr_recon_loss: 719328.4110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489834.7500; train_optim_loss: 1489834.7500; val_kl_reg_loss: 5458.5762; val_edge_recon_loss: 772904.3568; val_gene_expr_recon_loss: 717724.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1496087.2083; val_optim_loss: 1496087.2083
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9654; val_auprc_score: 0.9921; val_best_acc_score: 0.9533; val_best_f1_score: 0.9729; train_kl_reg_loss: 7242.7622; train_edge_recon_loss: 772929.4631; train_gene_expr_recon_loss: 718972.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499144.4331; train_optim_loss: 1499144.4331; val_kl_reg_loss: 5466.3979; val_edge_recon_loss: 786325.6484; val_gene_expr_recon_loss: 717729.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509521.4271; val_optim_loss: 1509521.4271
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9580; val_auprc_score: 0.9902; val_best_acc_score: 0.9514; val_best_f1_score: 0.9719; train_kl_reg_loss: 7220.7611; train_edge_recon_loss: 760637.3073; train_gene_expr_recon_loss: 719187.5355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1487045.6017; train_optim_loss: 1487045.6017; val_kl_reg_loss: 5460.8126; val_edge_recon_loss: 771403.7526; val_gene_expr_recon_loss: 717566.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494431.3802; val_optim_loss: 1494431.3802

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 0 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9610
Val AUPRC score: 0.9913
Val best accuracy score: 0.9528
Val best F1 score: 0.9727
Val gene expr MSE score: 69865.9723
Val cat covariate0 mean sim diff: -0.0040

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
