[True]
Run timestamp: 01082023_090838_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9021; val_auprc_score: 0.9800; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 21873.6784; train_edge_recon_loss: 109517.4601; train_gene_expr_recon_loss: 62396618.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59238.1186; train_global_loss: 62587247.2593; train_optim_loss: 62587247.2593; val_kl_reg_loss: 56666.2734; val_edge_recon_loss: 118649.8945; val_gene_expr_recon_loss: 42351738.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54948.5859; val_global_loss: 42582002.0000; val_optim_loss: 42582002.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8857; val_auprc_score: 0.9736; val_best_acc_score: 0.8463; val_best_f1_score: 0.9168; train_kl_reg_loss: 127164.2731; train_edge_recon_loss: 118231.6069; train_gene_expr_recon_loss: 38935170.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51554.9690; train_global_loss: 39232120.8889; train_optim_loss: 39232120.8889; val_kl_reg_loss: 155627.2500; val_edge_recon_loss: 124983.4375; val_gene_expr_recon_loss: 35666804.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48345.3516; val_global_loss: 35995759.3333; val_optim_loss: 35995759.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8702; val_auprc_score: 0.9714; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 173693.8423; train_edge_recon_loss: 118465.6933; train_gene_expr_recon_loss: 31876474.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45881.5510; train_global_loss: 32214515.8889; train_optim_loss: 32214515.8889; val_kl_reg_loss: 175747.8646; val_edge_recon_loss: 119644.7760; val_gene_expr_recon_loss: 27928004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43622.8672; val_global_loss: 28267018.6667; val_optim_loss: 28267018.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8623; val_auprc_score: 0.9696; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 182296.8466; train_edge_recon_loss: 119547.2323; train_gene_expr_recon_loss: 25693927.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41909.3439; train_global_loss: 26037680.4074; train_optim_loss: 26037680.4074; val_kl_reg_loss: 172221.5833; val_edge_recon_loss: 121378.5143; val_gene_expr_recon_loss: 24063995.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40343.6602; val_global_loss: 24397939.0000; val_optim_loss: 24397939.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8448; val_auprc_score: 0.9666; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 171474.6256; train_edge_recon_loss: 120005.1425; train_gene_expr_recon_loss: 23372047.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39263.6683; train_global_loss: 23702791.2963; train_optim_loss: 23702791.2963; val_kl_reg_loss: 157234.9792; val_edge_recon_loss: 119326.7057; val_gene_expr_recon_loss: 22806418.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38373.3242; val_global_loss: 23121354.0000; val_optim_loss: 23121354.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8396; val_auprc_score: 0.9675; val_best_acc_score: 0.8623; val_best_f1_score: 0.9257; train_kl_reg_loss: 155251.1282; train_edge_recon_loss: 119394.0819; train_gene_expr_recon_loss: 22561887.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37991.4519; train_global_loss: 22874524.2963; train_optim_loss: 22874524.2963; val_kl_reg_loss: 141888.8802; val_edge_recon_loss: 115294.8268; val_gene_expr_recon_loss: 22311113.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37824.4297; val_global_loss: 22606121.3333; val_optim_loss: 22606121.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8315; val_auprc_score: 0.9637; val_best_acc_score: 0.8600; val_best_f1_score: 0.9238; train_kl_reg_loss: 140449.3747; train_edge_recon_loss: 119695.6876; train_gene_expr_recon_loss: 22136428.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37805.3739; train_global_loss: 22434378.9630; train_optim_loss: 22434378.9630; val_kl_reg_loss: 129070.7799; val_edge_recon_loss: 121700.3711; val_gene_expr_recon_loss: 21966732.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37789.8594; val_global_loss: 22255293.0000; val_optim_loss: 22255293.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8335; val_auprc_score: 0.9652; val_best_acc_score: 0.8747; val_best_f1_score: 0.9314; train_kl_reg_loss: 128310.2979; train_edge_recon_loss: 119425.8659; train_gene_expr_recon_loss: 21837280.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37773.3351; train_global_loss: 22122789.9630; train_optim_loss: 22122789.9630; val_kl_reg_loss: 118656.1393; val_edge_recon_loss: 116102.5990; val_gene_expr_recon_loss: 21664008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37754.9375; val_global_loss: 21936520.6667; val_optim_loss: 21936520.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8307; val_auprc_score: 0.9635; val_best_acc_score: 0.8743; val_best_f1_score: 0.9298; train_kl_reg_loss: 118553.8168; train_edge_recon_loss: 118400.2837; train_gene_expr_recon_loss: 21599236.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37735.8115; train_global_loss: 21873926.7778; train_optim_loss: 21873926.7778; val_kl_reg_loss: 110132.6693; val_edge_recon_loss: 119473.9128; val_gene_expr_recon_loss: 21464640.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37715.4922; val_global_loss: 21731962.6667; val_optim_loss: 21731962.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8328; val_auprc_score: 0.9633; val_best_acc_score: 0.8694; val_best_f1_score: 0.9276; train_kl_reg_loss: 110590.7261; train_edge_recon_loss: 118209.2601; train_gene_expr_recon_loss: 21387611.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37694.4463; train_global_loss: 21654106.4074; train_optim_loss: 21654106.4074; val_kl_reg_loss: 103619.0156; val_edge_recon_loss: 119227.0143; val_gene_expr_recon_loss: 21247864.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37671.5742; val_global_loss: 21508383.0000; val_optim_loss: 21508383.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8416; val_auprc_score: 0.9656; val_best_acc_score: 0.8746; val_best_f1_score: 0.9312; train_kl_reg_loss: 104121.2093; train_edge_recon_loss: 119052.4605; train_gene_expr_recon_loss: 21198191.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37648.7958; train_global_loss: 21459014.1111; train_optim_loss: 21459014.1111; val_kl_reg_loss: 97329.6042; val_edge_recon_loss: 119751.7227; val_gene_expr_recon_loss: 21111781.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37624.1055; val_global_loss: 21366486.3333; val_optim_loss: 21366486.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8425; val_auprc_score: 0.9652; val_best_acc_score: 0.8769; val_best_f1_score: 0.9320; train_kl_reg_loss: 98614.3594; train_edge_recon_loss: 118388.5919; train_gene_expr_recon_loss: 21020659.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37599.5707; train_global_loss: 21275261.7037; train_optim_loss: 21275261.7037; val_kl_reg_loss: 92549.0208; val_edge_recon_loss: 121654.5469; val_gene_expr_recon_loss: 20885332.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37573.3984; val_global_loss: 21137109.6667; val_optim_loss: 21137109.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8466; val_auprc_score: 0.9675; val_best_acc_score: 0.8795; val_best_f1_score: 0.9334; train_kl_reg_loss: 93937.4637; train_edge_recon_loss: 119439.3611; train_gene_expr_recon_loss: 20847890.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37547.8423; train_global_loss: 21098815.4074; train_optim_loss: 21098815.4074; val_kl_reg_loss: 88560.1029; val_edge_recon_loss: 115518.9870; val_gene_expr_recon_loss: 20728717.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37521.5664; val_global_loss: 20970319.0000; val_optim_loss: 20970319.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8468; val_auprc_score: 0.9663; val_best_acc_score: 0.8773; val_best_f1_score: 0.9326; train_kl_reg_loss: 89888.2776; train_edge_recon_loss: 118314.5327; train_gene_expr_recon_loss: 20694902.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37495.0880; train_global_loss: 20940600.2593; train_optim_loss: 20940600.2593; val_kl_reg_loss: 84785.7370; val_edge_recon_loss: 117198.7643; val_gene_expr_recon_loss: 20603532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37467.2891; val_global_loss: 20842984.6667; val_optim_loss: 20842984.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8503; val_auprc_score: 0.9687; val_best_acc_score: 0.8815; val_best_f1_score: 0.9348; train_kl_reg_loss: 86490.1803; train_edge_recon_loss: 116436.2846; train_gene_expr_recon_loss: 20541125.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37440.7946; train_global_loss: 20781492.8148; train_optim_loss: 20781492.8148; val_kl_reg_loss: 81893.6029; val_edge_recon_loss: 113343.3125; val_gene_expr_recon_loss: 20450167.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37413.7578; val_global_loss: 20682818.6667; val_optim_loss: 20682818.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8595; val_auprc_score: 0.9711; val_best_acc_score: 0.8800; val_best_f1_score: 0.9336; train_kl_reg_loss: 83377.8203; train_edge_recon_loss: 118726.8882; train_gene_expr_recon_loss: 20402277.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37387.6372; train_global_loss: 20641769.4444; train_optim_loss: 20641769.4444; val_kl_reg_loss: 79067.6693; val_edge_recon_loss: 114169.2344; val_gene_expr_recon_loss: 20295472.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37361.4062; val_global_loss: 20526071.6667; val_optim_loss: 20526071.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8639; val_auprc_score: 0.9715; val_best_acc_score: 0.8774; val_best_f1_score: 0.9325; train_kl_reg_loss: 80676.3438; train_edge_recon_loss: 117220.1981; train_gene_expr_recon_loss: 20262315.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37336.4066; train_global_loss: 20497547.9259; train_optim_loss: 20497547.9259; val_kl_reg_loss: 76495.5951; val_edge_recon_loss: 115777.0768; val_gene_expr_recon_loss: 20132843.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37311.0469; val_global_loss: 20362427.6667; val_optim_loss: 20362427.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8731; val_auprc_score: 0.9719; val_best_acc_score: 0.8741; val_best_f1_score: 0.9296; train_kl_reg_loss: 78266.2138; train_edge_recon_loss: 117260.2396; train_gene_expr_recon_loss: 20127749.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37288.8061; train_global_loss: 20360564.4444; train_optim_loss: 20360564.4444; val_kl_reg_loss: 74674.0391; val_edge_recon_loss: 121374.9453; val_gene_expr_recon_loss: 20001165.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37267.2461; val_global_loss: 20234482.6667; val_optim_loss: 20234482.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8752; val_auprc_score: 0.9746; val_best_acc_score: 0.8804; val_best_f1_score: 0.9342; train_kl_reg_loss: 75955.6991; train_edge_recon_loss: 116149.6484; train_gene_expr_recon_loss: 19998801.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37248.7556; train_global_loss: 20228155.9259; train_optim_loss: 20228155.9259; val_kl_reg_loss: 72545.4297; val_edge_recon_loss: 112959.8099; val_gene_expr_recon_loss: 19901703.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37230.5039; val_global_loss: 20124438.6667; val_optim_loss: 20124438.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8759; val_auprc_score: 0.9733; val_best_acc_score: 0.8817; val_best_f1_score: 0.9337; train_kl_reg_loss: 73847.9278; train_edge_recon_loss: 116480.4392; train_gene_expr_recon_loss: 19871672.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37215.9285; train_global_loss: 20099216.8519; train_optim_loss: 20099216.8519; val_kl_reg_loss: 70331.4193; val_edge_recon_loss: 114796.8229; val_gene_expr_recon_loss: 19772245.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37201.3047; val_global_loss: 19994575.0000; val_optim_loss: 19994575.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8811; val_auprc_score: 0.9750; val_best_acc_score: 0.8841; val_best_f1_score: 0.9348; train_kl_reg_loss: 71891.6234; train_edge_recon_loss: 116755.3306; train_gene_expr_recon_loss: 19746479.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37190.5987; train_global_loss: 19972317.0370; train_optim_loss: 19972317.0370; val_kl_reg_loss: 68207.1523; val_edge_recon_loss: 114846.2591; val_gene_expr_recon_loss: 19666024.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37180.8125; val_global_loss: 19886257.3333; val_optim_loss: 19886257.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8850; val_auprc_score: 0.9766; val_best_acc_score: 0.8843; val_best_f1_score: 0.9349; train_kl_reg_loss: 70064.3643; train_edge_recon_loss: 115432.2222; train_gene_expr_recon_loss: 19629134.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37172.1266; train_global_loss: 19851802.7407; train_optim_loss: 19851802.7407; val_kl_reg_loss: 66707.4440; val_edge_recon_loss: 113512.6888; val_gene_expr_recon_loss: 19549917.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37164.5742; val_global_loss: 19767301.3333; val_optim_loss: 19767301.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8855; val_auprc_score: 0.9762; val_best_acc_score: 0.8809; val_best_f1_score: 0.9326; train_kl_reg_loss: 68334.4625; train_edge_recon_loss: 114983.8900; train_gene_expr_recon_loss: 19506193.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37160.0999; train_global_loss: 19726671.8889; train_optim_loss: 19726671.8889; val_kl_reg_loss: 65121.8320; val_edge_recon_loss: 116773.7812; val_gene_expr_recon_loss: 19390992.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37156.3906; val_global_loss: 19610043.6667; val_optim_loss: 19610043.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8867; val_auprc_score: 0.9757; val_best_acc_score: 0.8856; val_best_f1_score: 0.9349; train_kl_reg_loss: 66750.2046; train_edge_recon_loss: 116076.1348; train_gene_expr_recon_loss: 19396402.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37153.1350; train_global_loss: 19616381.8889; train_optim_loss: 19616381.8889; val_kl_reg_loss: 63761.1029; val_edge_recon_loss: 116692.8893; val_gene_expr_recon_loss: 19277237.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37149.4375; val_global_loss: 19494841.6667; val_optim_loss: 19494841.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8915; val_auprc_score: 0.9773; val_best_acc_score: 0.8876; val_best_f1_score: 0.9359; train_kl_reg_loss: 65228.4133; train_edge_recon_loss: 114561.7663; train_gene_expr_recon_loss: 19285988.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37147.2501; train_global_loss: 19502925.6667; train_optim_loss: 19502925.6667; val_kl_reg_loss: 62545.9740; val_edge_recon_loss: 116499.8659; val_gene_expr_recon_loss: 19194342.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37144.3828; val_global_loss: 19410532.6667; val_optim_loss: 19410532.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8705; val_auprc_score: 0.9746; val_best_acc_score: 0.8711; val_best_f1_score: 0.9285; train_kl_reg_loss: 34498.5017; train_edge_recon_loss: 114749.3384; train_gene_expr_recon_loss: 38717623.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37109.1181; train_global_loss: 38903980.5185; train_optim_loss: 38903980.5185; val_kl_reg_loss: 40551.1100; val_edge_recon_loss: 116774.3034; val_gene_expr_recon_loss: 34603068.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37061.5000; val_global_loss: 34797454.6667; val_optim_loss: 34797454.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8828; val_auprc_score: 0.9764; val_best_acc_score: 0.8751; val_best_f1_score: 0.9295; train_kl_reg_loss: 47834.8126; train_edge_recon_loss: 118348.8186; train_gene_expr_recon_loss: 32268264.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37011.7840; train_global_loss: 32471460.1852; train_optim_loss: 32471460.1852; val_kl_reg_loss: 50681.2682; val_edge_recon_loss: 118263.2435; val_gene_expr_recon_loss: 30001780.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36959.7344; val_global_loss: 30207685.0000; val_optim_loss: 30207685.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8772; val_auprc_score: 0.9738; val_best_acc_score: 0.8782; val_best_f1_score: 0.9310; train_kl_reg_loss: 53976.2276; train_edge_recon_loss: 117994.1900; train_gene_expr_recon_loss: 28256994.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36908.3730; train_global_loss: 28465873.0370; train_optim_loss: 28465873.0370; val_kl_reg_loss: 53051.4108; val_edge_recon_loss: 118730.5339; val_gene_expr_recon_loss: 26637636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36854.6250; val_global_loss: 26846272.3333; val_optim_loss: 26846272.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8788; val_auprc_score: 0.9741; val_best_acc_score: 0.8790; val_best_f1_score: 0.9322; train_kl_reg_loss: 55034.8061; train_edge_recon_loss: 117562.4633; train_gene_expr_recon_loss: 25477021.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36801.6871; train_global_loss: 25686419.8519; train_optim_loss: 25686419.8519; val_kl_reg_loss: 52855.8698; val_edge_recon_loss: 118683.4401; val_gene_expr_recon_loss: 24383406.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36746.2500; val_global_loss: 24591692.3333; val_optim_loss: 24591692.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8789; val_auprc_score: 0.9751; val_best_acc_score: 0.8808; val_best_f1_score: 0.9335; train_kl_reg_loss: 54743.7352; train_edge_recon_loss: 116700.2666; train_gene_expr_recon_loss: 24337045.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36724.7613; train_global_loss: 24545214.4074; train_optim_loss: 24545214.4074; val_kl_reg_loss: 52733.7845; val_edge_recon_loss: 115809.4961; val_gene_expr_recon_loss: 24220542.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36715.6641; val_global_loss: 24425801.6667; val_optim_loss: 24425801.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8829; val_auprc_score: 0.9744; val_best_acc_score: 0.8810; val_best_f1_score: 0.9333; train_kl_reg_loss: 54612.5771; train_edge_recon_loss: 116683.5524; train_gene_expr_recon_loss: 24187517.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36709.8923; train_global_loss: 24395523.3704; train_optim_loss: 24395523.3704; val_kl_reg_loss: 52604.6322; val_edge_recon_loss: 118314.9753; val_gene_expr_recon_loss: 24077445.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36703.9492; val_global_loss: 24285068.3333; val_optim_loss: 24285068.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8778; val_auprc_score: 0.9742; val_best_acc_score: 0.8798; val_best_f1_score: 0.9328; train_kl_reg_loss: 54489.4162; train_edge_recon_loss: 118048.2875; train_gene_expr_recon_loss: 24046934.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36698.1088; train_global_loss: 24256170.3333; train_optim_loss: 24256170.3333; val_kl_reg_loss: 52340.6055; val_edge_recon_loss: 116305.5430; val_gene_expr_recon_loss: 23898192.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36692.0312; val_global_loss: 24103530.0000; val_optim_loss: 24103530.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8860; val_auprc_score: 0.9763; val_best_acc_score: 0.8824; val_best_f1_score: 0.9341; train_kl_reg_loss: 54368.1661; train_edge_recon_loss: 116755.1617; train_gene_expr_recon_loss: 23911534.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36685.9632; train_global_loss: 24119343.5556; train_optim_loss: 24119343.5556; val_kl_reg_loss: 52335.4082; val_edge_recon_loss: 116242.1393; val_gene_expr_recon_loss: 23784525.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36679.5938; val_global_loss: 23989783.0000; val_optim_loss: 23989783.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 50 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8949
val AUPRC score: 0.9771
val best accuracy score: 0.8850
val best F1 score: 0.9342
val target rna MSE score: 24.3360
val source rna MSE score: 89.6324
Val cat covariate0 mean sim diff: -0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
