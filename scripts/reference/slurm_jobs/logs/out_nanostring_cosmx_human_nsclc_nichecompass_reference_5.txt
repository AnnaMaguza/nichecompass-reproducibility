[True, False, True]
Run timestamp: 03092023_002440_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8855; val_auprc_score: 0.9798; val_best_acc_score: 0.9114; val_best_f1_score: 0.9510; train_kl_reg_loss: 19467.3161; train_edge_recon_loss: 733953.0290; train_cat_covariates_contrastive_loss: 952893.4407; train_gene_expr_recon_loss: 2575492.5418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58450.0592; train_global_loss: 4340256.3836; train_optim_loss: 4340256.3836; val_kl_reg_loss: 21474.5475; val_edge_recon_loss: 733765.9019; val_cat_covariates_contrastive_loss: 954285.1208; val_gene_expr_recon_loss: 2210216.3746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13983.6787; val_global_loss: 3933725.6967; val_optim_loss: 3933725.6967
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8997; val_auprc_score: 0.9819; val_best_acc_score: 0.9164; val_best_f1_score: 0.9534; train_kl_reg_loss: 23218.1146; train_edge_recon_loss: 708377.5409; train_cat_covariates_contrastive_loss: 955431.6986; train_gene_expr_recon_loss: 2077184.8980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14199.6131; train_global_loss: 3778411.8644; train_optim_loss: 3778411.8644; val_kl_reg_loss: 24564.5850; val_edge_recon_loss: 738170.5873; val_cat_covariates_contrastive_loss: 954361.7115; val_gene_expr_recon_loss: 1988720.5817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14728.8564; val_global_loss: 3720546.2150; val_optim_loss: 3720546.2150
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9080; val_auprc_score: 0.9836; val_best_acc_score: 0.9162; val_best_f1_score: 0.9532; train_kl_reg_loss: 24314.8761; train_edge_recon_loss: 702284.4177; train_cat_covariates_contrastive_loss: 955068.3437; train_gene_expr_recon_loss: 1958938.5667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14639.4636; train_global_loss: 3655245.6709; train_optim_loss: 3655245.6709; val_kl_reg_loss: 24314.7411; val_edge_recon_loss: 727599.5492; val_cat_covariates_contrastive_loss: 955063.9504; val_gene_expr_recon_loss: 1931867.1573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14681.7500; val_global_loss: 3653527.1442; val_optim_loss: 3653527.1442
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9191; val_auprc_score: 0.9858; val_best_acc_score: 0.9241; val_best_f1_score: 0.9577; train_kl_reg_loss: 24955.5572; train_edge_recon_loss: 702916.6007; train_cat_covariates_contrastive_loss: 955034.6385; train_gene_expr_recon_loss: 1918210.4664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15065.0172; train_global_loss: 3616182.2814; train_optim_loss: 3616182.2814; val_kl_reg_loss: 25582.3319; val_edge_recon_loss: 716558.0133; val_cat_covariates_contrastive_loss: 955449.3647; val_gene_expr_recon_loss: 1905261.5079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15529.2100; val_global_loss: 3618380.4712; val_optim_loss: 3618380.4712
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9126; val_auprc_score: 0.9844; val_best_acc_score: 0.9247; val_best_f1_score: 0.9579; train_kl_reg_loss: 25405.2564; train_edge_recon_loss: 698200.5356; train_cat_covariates_contrastive_loss: 955022.4683; train_gene_expr_recon_loss: 1893070.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15571.0931; train_global_loss: 3587269.7222; train_optim_loss: 3587269.7222; val_kl_reg_loss: 26576.1046; val_edge_recon_loss: 718798.4294; val_cat_covariates_contrastive_loss: 953396.9344; val_gene_expr_recon_loss: 1884197.8300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15917.7080; val_global_loss: 3598887.0481; val_optim_loss: 3598887.0481
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9163; val_auprc_score: 0.9847; val_best_acc_score: 0.9243; val_best_f1_score: 0.9577; train_kl_reg_loss: 25856.7168; train_edge_recon_loss: 699880.7002; train_cat_covariates_contrastive_loss: 955061.5422; train_gene_expr_recon_loss: 1875297.4888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15898.6983; train_global_loss: 3571995.1480; train_optim_loss: 3571995.1480; val_kl_reg_loss: 26570.7297; val_edge_recon_loss: 729612.7690; val_cat_covariates_contrastive_loss: 954334.5079; val_gene_expr_recon_loss: 1866168.4952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15792.5205; val_global_loss: 3592479.0096; val_optim_loss: 3592479.0096
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9167; val_auprc_score: 0.9848; val_best_acc_score: 0.9260; val_best_f1_score: 0.9586; train_kl_reg_loss: 26169.1895; train_edge_recon_loss: 700858.9782; train_cat_covariates_contrastive_loss: 955041.7612; train_gene_expr_recon_loss: 1862155.0793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15974.1308; train_global_loss: 3560199.1376; train_optim_loss: 3560199.1376; val_kl_reg_loss: 27258.9747; val_edge_recon_loss: 719461.5291; val_cat_covariates_contrastive_loss: 952984.4974; val_gene_expr_recon_loss: 1858178.0354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15893.0508; val_global_loss: 3573776.0245; val_optim_loss: 3573776.0245
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9206; val_auprc_score: 0.9859; val_best_acc_score: 0.9234; val_best_f1_score: 0.9572; train_kl_reg_loss: 26510.1629; train_edge_recon_loss: 699340.5135; train_cat_covariates_contrastive_loss: 955095.7464; train_gene_expr_recon_loss: 1852006.4371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16041.6080; train_global_loss: 3548994.4702; train_optim_loss: 3548994.4702; val_kl_reg_loss: 26351.4519; val_edge_recon_loss: 719872.1440; val_cat_covariates_contrastive_loss: 957625.4989; val_gene_expr_recon_loss: 1854268.7076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16213.5049; val_global_loss: 3574331.3077; val_optim_loss: 3574331.3077
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9213; val_auprc_score: 0.9862; val_best_acc_score: 0.9203; val_best_f1_score: 0.9554; train_kl_reg_loss: 26762.1251; train_edge_recon_loss: 698920.3159; train_cat_covariates_contrastive_loss: 955180.3336; train_gene_expr_recon_loss: 1843039.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16067.6027; train_global_loss: 3539970.2999; train_optim_loss: 3539970.2999; val_kl_reg_loss: 25988.2064; val_edge_recon_loss: 718963.7625; val_cat_covariates_contrastive_loss: 957399.5468; val_gene_expr_recon_loss: 1837149.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16378.2637; val_global_loss: 3555879.5970; val_optim_loss: 3555879.5970
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9240; val_auprc_score: 0.9863; val_best_acc_score: 0.9278; val_best_f1_score: 0.9595; train_kl_reg_loss: 26896.2170; train_edge_recon_loss: 701362.9240; train_cat_covariates_contrastive_loss: 955220.0599; train_gene_expr_recon_loss: 1835492.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16116.7238; train_global_loss: 3535088.5879; train_optim_loss: 3535088.5879; val_kl_reg_loss: 27571.5840; val_edge_recon_loss: 715730.3066; val_cat_covariates_contrastive_loss: 954485.9473; val_gene_expr_recon_loss: 1837782.5406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16050.7168; val_global_loss: 3551621.1320; val_optim_loss: 3551621.1320
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9159; val_auprc_score: 0.9845; val_best_acc_score: 0.9231; val_best_f1_score: 0.9570; train_kl_reg_loss: 26966.7143; train_edge_recon_loss: 697455.1998; train_cat_covariates_contrastive_loss: 955010.1366; train_gene_expr_recon_loss: 1829554.2189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16124.3259; train_global_loss: 3525110.5946; train_optim_loss: 3525110.5946; val_kl_reg_loss: 27345.1137; val_edge_recon_loss: 726838.3169; val_cat_covariates_contrastive_loss: 953247.6785; val_gene_expr_recon_loss: 1837716.9454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16146.4639; val_global_loss: 3561294.5524; val_optim_loss: 3561294.5524
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9181; val_auprc_score: 0.9849; val_best_acc_score: 0.9251; val_best_f1_score: 0.9581; train_kl_reg_loss: 27046.6354; train_edge_recon_loss: 698936.7336; train_cat_covariates_contrastive_loss: 955067.8624; train_gene_expr_recon_loss: 1826358.8538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16128.7592; train_global_loss: 3523538.8488; train_optim_loss: 3523538.8488; val_kl_reg_loss: 27291.3120; val_edge_recon_loss: 730598.0529; val_cat_covariates_contrastive_loss: 954115.3730; val_gene_expr_recon_loss: 1825957.8728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15970.6973; val_global_loss: 3553933.3680; val_optim_loss: 3553933.3680
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9184; val_auprc_score: 0.9853; val_best_acc_score: 0.9235; val_best_f1_score: 0.9571; train_kl_reg_loss: 27127.0866; train_edge_recon_loss: 696305.5419; train_cat_covariates_contrastive_loss: 955082.0476; train_gene_expr_recon_loss: 1820807.5399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16159.8247; train_global_loss: 3515482.0428; train_optim_loss: 3515482.0428; val_kl_reg_loss: 27475.2949; val_edge_recon_loss: 717608.9878; val_cat_covariates_contrastive_loss: 954246.8210; val_gene_expr_recon_loss: 1817843.8851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16208.4482; val_global_loss: 3533383.4851; val_optim_loss: 3533383.4851
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9147; val_auprc_score: 0.9842; val_best_acc_score: 0.9242; val_best_f1_score: 0.9576; train_kl_reg_loss: 27291.4126; train_edge_recon_loss: 699137.5588; train_cat_covariates_contrastive_loss: 955266.3893; train_gene_expr_recon_loss: 1823449.7572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16268.0431; train_global_loss: 3521413.1629; train_optim_loss: 3521413.1629; val_kl_reg_loss: 28796.1783; val_edge_recon_loss: 719091.5118; val_cat_covariates_contrastive_loss: 951859.7561; val_gene_expr_recon_loss: 1823164.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16313.9150; val_global_loss: 3539225.9502; val_optim_loss: 3539225.9502
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9103; val_auprc_score: 0.9834; val_best_acc_score: 0.9251; val_best_f1_score: 0.9581; train_kl_reg_loss: 27357.1272; train_edge_recon_loss: 697651.8428; train_cat_covariates_contrastive_loss: 954904.9007; train_gene_expr_recon_loss: 1813043.1748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16304.9425; train_global_loss: 3509261.9875; train_optim_loss: 3509261.9875; val_kl_reg_loss: 29717.5022; val_edge_recon_loss: 720711.8287; val_cat_covariates_contrastive_loss: 951012.0852; val_gene_expr_recon_loss: 1817372.6517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16431.6777; val_global_loss: 3535245.8217; val_optim_loss: 3535245.8217
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9149; val_auprc_score: 0.9843; val_best_acc_score: 0.9227; val_best_f1_score: 0.9567; train_kl_reg_loss: 27445.3293; train_edge_recon_loss: 698969.0086; train_cat_covariates_contrastive_loss: 955238.3177; train_gene_expr_recon_loss: 1811007.0553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16298.1081; train_global_loss: 3508957.8193; train_optim_loss: 3508957.8193; val_kl_reg_loss: 28246.2229; val_edge_recon_loss: 722123.0540; val_cat_covariates_contrastive_loss: 952934.3031; val_gene_expr_recon_loss: 1811082.3339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16586.9082; val_global_loss: 3530972.9135; val_optim_loss: 3530972.9135
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9131; val_auprc_score: 0.9837; val_best_acc_score: 0.9244; val_best_f1_score: 0.9576; train_kl_reg_loss: 27439.3760; train_edge_recon_loss: 697043.7218; train_cat_covariates_contrastive_loss: 955106.0408; train_gene_expr_recon_loss: 1807098.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16379.7343; train_global_loss: 3503067.0652; train_optim_loss: 3503067.0652; val_kl_reg_loss: 28204.3206; val_edge_recon_loss: 722732.4338; val_cat_covariates_contrastive_loss: 952143.2799; val_gene_expr_recon_loss: 1812008.7255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16422.7402; val_global_loss: 3531511.5140; val_optim_loss: 3531511.5140
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9278; val_auprc_score: 0.9875; val_best_acc_score: 0.9212; val_best_f1_score: 0.9558; train_kl_reg_loss: 27469.4720; train_edge_recon_loss: 698892.5915; train_cat_covariates_contrastive_loss: 955038.9064; train_gene_expr_recon_loss: 1804609.3249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16366.6933; train_global_loss: 3502376.9863; train_optim_loss: 3502376.9863; val_kl_reg_loss: 26310.4443; val_edge_recon_loss: 722256.3973; val_cat_covariates_contrastive_loss: 958912.9524; val_gene_expr_recon_loss: 1805806.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16420.8965; val_global_loss: 3529707.4799; val_optim_loss: 3529707.4799
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9206; val_auprc_score: 0.9852; val_best_acc_score: 0.9265; val_best_f1_score: 0.9588; train_kl_reg_loss: 27400.7952; train_edge_recon_loss: 698582.0809; train_cat_covariates_contrastive_loss: 954888.2576; train_gene_expr_recon_loss: 1804434.2705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16405.8465; train_global_loss: 3501711.2508; train_optim_loss: 3501711.2508; val_kl_reg_loss: 27542.3552; val_edge_recon_loss: 719787.5367; val_cat_covariates_contrastive_loss: 953724.4878; val_gene_expr_recon_loss: 1804824.0691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16372.3486; val_global_loss: 3522250.6941; val_optim_loss: 3522250.6941
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9353; val_auprc_score: 0.9889; val_best_acc_score: 0.9304; val_best_f1_score: 0.9610; train_kl_reg_loss: 27522.7331; train_edge_recon_loss: 695232.5176; train_cat_covariates_contrastive_loss: 954957.9736; train_gene_expr_recon_loss: 1799770.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16454.5444; train_global_loss: 3493938.2103; train_optim_loss: 3493938.2103; val_kl_reg_loss: 27215.6593; val_edge_recon_loss: 703310.7415; val_cat_covariates_contrastive_loss: 961699.3462; val_gene_expr_recon_loss: 1804859.8387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16552.4961; val_global_loss: 3513638.0900; val_optim_loss: 3513638.0900
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9190; val_auprc_score: 0.9854; val_best_acc_score: 0.9244; val_best_f1_score: 0.9576; train_kl_reg_loss: 24634.0095; train_edge_recon_loss: 700556.3929; train_cat_covariates_contrastive_loss: 954482.9736; train_gene_expr_recon_loss: 2083471.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17381.9164; train_global_loss: 3780527.2244; train_optim_loss: 3780527.2244; val_kl_reg_loss: 19982.0319; val_edge_recon_loss: 724118.0938; val_cat_covariates_contrastive_loss: 949474.9017; val_gene_expr_recon_loss: 2327941.3855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16405.3066; val_global_loss: 4037921.6696; val_optim_loss: 4037921.6696
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9148; val_auprc_score: 0.9840; val_best_acc_score: 0.9212; val_best_f1_score: 0.9558; train_kl_reg_loss: 24282.0023; train_edge_recon_loss: 696311.6590; train_cat_covariates_contrastive_loss: 952931.7772; train_gene_expr_recon_loss: 2070780.8322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16701.6382; train_global_loss: 3761007.9076; train_optim_loss: 3761007.9076; val_kl_reg_loss: 26622.4310; val_edge_recon_loss: 722032.5064; val_cat_covariates_contrastive_loss: 951573.6073; val_gene_expr_recon_loss: 1945805.2408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16757.7441; val_global_loss: 3662791.5253; val_optim_loss: 3662791.5253
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9213; val_auprc_score: 0.9857; val_best_acc_score: 0.9275; val_best_f1_score: 0.9594; train_kl_reg_loss: 26217.8563; train_edge_recon_loss: 694478.1126; train_cat_covariates_contrastive_loss: 953817.0482; train_gene_expr_recon_loss: 1898948.5034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16600.1964; train_global_loss: 3590061.7198; train_optim_loss: 3590061.7198; val_kl_reg_loss: 27760.3943; val_edge_recon_loss: 714320.1186; val_cat_covariates_contrastive_loss: 951125.7338; val_gene_expr_recon_loss: 1861622.9314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16421.3027; val_global_loss: 3571250.4266; val_optim_loss: 3571250.4266
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9246; val_auprc_score: 0.9862; val_best_acc_score: 0.9263; val_best_f1_score: 0.9587; train_kl_reg_loss: 26917.1322; train_edge_recon_loss: 694151.3556; train_cat_covariates_contrastive_loss: 954251.3233; train_gene_expr_recon_loss: 1840318.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16539.2967; train_global_loss: 3532177.2447; train_optim_loss: 3532177.2447; val_kl_reg_loss: 27201.7535; val_edge_recon_loss: 722818.8566; val_cat_covariates_contrastive_loss: 954030.1652; val_gene_expr_recon_loss: 1834274.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16623.4199; val_global_loss: 3554948.5997; val_optim_loss: 3554948.5997

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9270; val_auprc_score: 0.9868; val_best_acc_score: 0.9282; val_best_f1_score: 0.9598; train_kl_reg_loss: 27899.6835; train_edge_recon_loss: 692412.4215; train_cat_covariates_contrastive_loss: 954195.6175; train_gene_expr_recon_loss: 1789630.4461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8052.6345; train_global_loss: 3472190.8030; train_optim_loss: 3472190.8030; val_kl_reg_loss: 28068.5243; val_edge_recon_loss: 717859.3274; val_cat_covariates_contrastive_loss: 953839.3770; val_gene_expr_recon_loss: 1790726.8370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8049.2686; val_global_loss: 3498543.3129; val_optim_loss: 3498543.3129
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9100; val_auprc_score: 0.9836; val_best_acc_score: 0.9213; val_best_f1_score: 0.9561; train_kl_reg_loss: 23241.5491; train_edge_recon_loss: 701924.1862; train_cat_covariates_contrastive_loss: 950676.5579; train_gene_expr_recon_loss: 1643358.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6496.4118; train_global_loss: 3325696.9091; train_optim_loss: 3325696.9091; val_kl_reg_loss: 20011.1260; val_edge_recon_loss: 725791.3641; val_cat_covariates_contrastive_loss: 950601.0345; val_gene_expr_recon_loss: 1620691.5721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5760.7305; val_global_loss: 3322855.8479; val_optim_loss: 3322855.8479
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9128; val_auprc_score: 0.9843; val_best_acc_score: 0.9226; val_best_f1_score: 0.9568; train_kl_reg_loss: 22549.2735; train_edge_recon_loss: 700933.9263; train_cat_covariates_contrastive_loss: 951484.0715; train_gene_expr_recon_loss: 1605181.7462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5720.4821; train_global_loss: 3285869.5025; train_optim_loss: 3285869.5025; val_kl_reg_loss: 20225.0588; val_edge_recon_loss: 720725.7297; val_cat_covariates_contrastive_loss: 950838.5951; val_gene_expr_recon_loss: 1594008.4187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5682.4160; val_global_loss: 3291480.2998; val_optim_loss: 3291480.2998
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9135; val_auprc_score: 0.9843; val_best_acc_score: 0.9218; val_best_f1_score: 0.9564; train_kl_reg_loss: 22129.7007; train_edge_recon_loss: 697299.1487; train_cat_covariates_contrastive_loss: 951863.7380; train_gene_expr_recon_loss: 1583761.6915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5681.1156; train_global_loss: 3260735.3935; train_optim_loss: 3260735.3935; val_kl_reg_loss: 19768.9293; val_edge_recon_loss: 719364.3851; val_cat_covariates_contrastive_loss: 952783.7334; val_gene_expr_recon_loss: 1576647.4410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5670.1611; val_global_loss: 3274234.7421; val_optim_loss: 3274234.7421
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9171; val_auprc_score: 0.9851; val_best_acc_score: 0.9251; val_best_f1_score: 0.9582; train_kl_reg_loss: 21753.3879; train_edge_recon_loss: 697680.6760; train_cat_covariates_contrastive_loss: 951776.4193; train_gene_expr_recon_loss: 1570183.3258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5660.9112; train_global_loss: 3247054.7178; train_optim_loss: 3247054.7178; val_kl_reg_loss: 20497.8498; val_edge_recon_loss: 713333.0785; val_cat_covariates_contrastive_loss: 951049.6617; val_gene_expr_recon_loss: 1565302.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5602.1328; val_global_loss: 3255785.6163; val_optim_loss: 3255785.6163
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9159; val_auprc_score: 0.9850; val_best_acc_score: 0.9241; val_best_f1_score: 0.9576; train_kl_reg_loss: 21551.3968; train_edge_recon_loss: 696674.0017; train_cat_covariates_contrastive_loss: 951813.3648; train_gene_expr_recon_loss: 1560338.1918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5639.8021; train_global_loss: 3236016.7576; train_optim_loss: 3236016.7576; val_kl_reg_loss: 20303.9506; val_edge_recon_loss: 713498.3783; val_cat_covariates_contrastive_loss: 952556.7620; val_gene_expr_recon_loss: 1558547.6748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5633.1875; val_global_loss: 3250540.0122; val_optim_loss: 3250540.0122
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9184; val_auprc_score: 0.9853; val_best_acc_score: 0.9267; val_best_f1_score: 0.9590; train_kl_reg_loss: 21479.6610; train_edge_recon_loss: 696539.3516; train_cat_covariates_contrastive_loss: 951792.6418; train_gene_expr_recon_loss: 1543812.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5637.6673; train_global_loss: 3219262.0891; train_optim_loss: 3219262.0891; val_kl_reg_loss: 20512.5541; val_edge_recon_loss: 715020.8468; val_cat_covariates_contrastive_loss: 951430.7786; val_gene_expr_recon_loss: 1537985.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5670.2544; val_global_loss: 3230620.4196; val_optim_loss: 3230620.4196
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9169; val_auprc_score: 0.9847; val_best_acc_score: 0.9257; val_best_f1_score: 0.9584; train_kl_reg_loss: 21289.2129; train_edge_recon_loss: 693956.1371; train_cat_covariates_contrastive_loss: 951863.4460; train_gene_expr_recon_loss: 1535195.2816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5645.0043; train_global_loss: 3207949.0836; train_optim_loss: 3207949.0836; val_kl_reg_loss: 20564.8337; val_edge_recon_loss: 716225.3665; val_cat_covariates_contrastive_loss: 951206.0125; val_gene_expr_recon_loss: 1535300.7150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5598.3716; val_global_loss: 3228895.1827; val_optim_loss: 3228895.1827
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9163; val_auprc_score: 0.9845; val_best_acc_score: 0.9237; val_best_f1_score: 0.9573; train_kl_reg_loss: 21121.0154; train_edge_recon_loss: 695455.2787; train_cat_covariates_contrastive_loss: 951636.3434; train_gene_expr_recon_loss: 1530970.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5647.7783; train_global_loss: 3204831.2625; train_optim_loss: 3204831.2625; val_kl_reg_loss: 20315.7550; val_edge_recon_loss: 723483.1774; val_cat_covariates_contrastive_loss: 951237.3086; val_gene_expr_recon_loss: 1529732.9961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5646.7510; val_global_loss: 3230415.9904; val_optim_loss: 3230415.9904
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9143; val_auprc_score: 0.9842; val_best_acc_score: 0.9263; val_best_f1_score: 0.9589; train_kl_reg_loss: 21006.7808; train_edge_recon_loss: 695971.3522; train_cat_covariates_contrastive_loss: 951755.4241; train_gene_expr_recon_loss: 1526334.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5649.8208; train_global_loss: 3200717.6281; train_optim_loss: 3200717.6281; val_kl_reg_loss: 20553.9907; val_edge_recon_loss: 716598.1115; val_cat_covariates_contrastive_loss: 950932.8112; val_gene_expr_recon_loss: 1525872.9454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5638.8799; val_global_loss: 3219596.8671; val_optim_loss: 3219596.8671
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9169; val_auprc_score: 0.9848; val_best_acc_score: 0.9241; val_best_f1_score: 0.9575; train_kl_reg_loss: 20874.9216; train_edge_recon_loss: 694883.8484; train_cat_covariates_contrastive_loss: 951660.3386; train_gene_expr_recon_loss: 1523007.0197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5653.8300; train_global_loss: 3196079.9617; train_optim_loss: 3196079.9617; val_kl_reg_loss: 20486.7236; val_edge_recon_loss: 725694.6927; val_cat_covariates_contrastive_loss: 950983.6442; val_gene_expr_recon_loss: 1524320.2522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5648.9580; val_global_loss: 3227134.3199; val_optim_loss: 3227134.3199
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9177; val_auprc_score: 0.9849; val_best_acc_score: 0.9246; val_best_f1_score: 0.9578; train_kl_reg_loss: 20759.5719; train_edge_recon_loss: 694363.7177; train_cat_covariates_contrastive_loss: 951613.7554; train_gene_expr_recon_loss: 1520035.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5649.7272; train_global_loss: 3192422.1604; train_optim_loss: 3192422.1604; val_kl_reg_loss: 20374.5657; val_edge_recon_loss: 716729.6767; val_cat_covariates_contrastive_loss: 951056.7996; val_gene_expr_recon_loss: 1520496.4253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5647.1118; val_global_loss: 3214304.4659; val_optim_loss: 3214304.4659
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9181; val_auprc_score: 0.9853; val_best_acc_score: 0.9262; val_best_f1_score: 0.9588; train_kl_reg_loss: 20714.9061; train_edge_recon_loss: 693691.4229; train_cat_covariates_contrastive_loss: 951516.8937; train_gene_expr_recon_loss: 1518680.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5656.2737; train_global_loss: 3190259.7040; train_optim_loss: 3190259.7040; val_kl_reg_loss: 20182.5943; val_edge_recon_loss: 713014.1722; val_cat_covariates_contrastive_loss: 951453.6292; val_gene_expr_recon_loss: 1519107.6949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5656.4146; val_global_loss: 3209414.5900; val_optim_loss: 3209414.5900
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9194; val_auprc_score: 0.9855; val_best_acc_score: 0.9257; val_best_f1_score: 0.9584; train_kl_reg_loss: 20666.2773; train_edge_recon_loss: 693808.0782; train_cat_covariates_contrastive_loss: 951486.7527; train_gene_expr_recon_loss: 1516315.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5662.9644; train_global_loss: 3187939.6984; train_optim_loss: 3187939.6984; val_kl_reg_loss: 19813.5251; val_edge_recon_loss: 711429.0064; val_cat_covariates_contrastive_loss: 951918.3285; val_gene_expr_recon_loss: 1517277.5328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5639.0156; val_global_loss: 3206077.3907; val_optim_loss: 3206077.3907
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9210; val_auprc_score: 0.9858; val_best_acc_score: 0.9259; val_best_f1_score: 0.9585; train_kl_reg_loss: 20530.1796; train_edge_recon_loss: 696344.1941; train_cat_covariates_contrastive_loss: 951441.3350; train_gene_expr_recon_loss: 1514800.2427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5670.9101; train_global_loss: 3188786.8612; train_optim_loss: 3188786.8612; val_kl_reg_loss: 20214.2366; val_edge_recon_loss: 720450.0824; val_cat_covariates_contrastive_loss: 950797.1733; val_gene_expr_recon_loss: 1515999.8497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5687.4463; val_global_loss: 3213148.8497; val_optim_loss: 3213148.8497
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9203; val_auprc_score: 0.9856; val_best_acc_score: 0.9261; val_best_f1_score: 0.9587; train_kl_reg_loss: 20472.1695; train_edge_recon_loss: 695553.4659; train_cat_covariates_contrastive_loss: 951443.6123; train_gene_expr_recon_loss: 1513860.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5669.3115; train_global_loss: 3186999.0555; train_optim_loss: 3186999.0555; val_kl_reg_loss: 19776.3005; val_edge_recon_loss: 712095.7483; val_cat_covariates_contrastive_loss: 951724.5328; val_gene_expr_recon_loss: 1513659.0778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5696.4238; val_global_loss: 3202952.1600; val_optim_loss: 3202952.1600
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9210; val_auprc_score: 0.9858; val_best_acc_score: 0.9249; val_best_f1_score: 0.9580; train_kl_reg_loss: 20361.2576; train_edge_recon_loss: 694382.3299; train_cat_covariates_contrastive_loss: 951411.7794; train_gene_expr_recon_loss: 1511933.6682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5673.6186; train_global_loss: 3183762.6522; train_optim_loss: 3183762.6522; val_kl_reg_loss: 19569.9471; val_edge_recon_loss: 717914.9111; val_cat_covariates_contrastive_loss: 952696.2384; val_gene_expr_recon_loss: 1512919.3191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5706.9766; val_global_loss: 3208807.4196; val_optim_loss: 3208807.4196
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9224; val_auprc_score: 0.9858; val_best_acc_score: 0.9273; val_best_f1_score: 0.9593; train_kl_reg_loss: 20376.2472; train_edge_recon_loss: 694117.4188; train_cat_covariates_contrastive_loss: 951275.6891; train_gene_expr_recon_loss: 1509743.9376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5669.7706; train_global_loss: 3181183.0588; train_optim_loss: 3181183.0588; val_kl_reg_loss: 20298.9242; val_edge_recon_loss: 722322.6104; val_cat_covariates_contrastive_loss: 950902.1003; val_gene_expr_recon_loss: 1511035.3392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5679.7925; val_global_loss: 3210238.7281; val_optim_loss: 3210238.7281
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9218; val_auprc_score: 0.9856; val_best_acc_score: 0.9277; val_best_f1_score: 0.9595; train_kl_reg_loss: 20310.7821; train_edge_recon_loss: 694666.0330; train_cat_covariates_contrastive_loss: 951264.5949; train_gene_expr_recon_loss: 1508062.9883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5676.5001; train_global_loss: 3179980.8961; train_optim_loss: 3179980.8961; val_kl_reg_loss: 20048.0815; val_edge_recon_loss: 716548.0424; val_cat_covariates_contrastive_loss: 950850.7769; val_gene_expr_recon_loss: 1509680.1814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5659.7241; val_global_loss: 3202786.8313; val_optim_loss: 3202786.8313
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9207; val_auprc_score: 0.9857; val_best_acc_score: 0.9258; val_best_f1_score: 0.9586; train_kl_reg_loss: 20261.5552; train_edge_recon_loss: 695079.5746; train_cat_covariates_contrastive_loss: 951337.4147; train_gene_expr_recon_loss: 1507009.0855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5669.4502; train_global_loss: 3179357.0822; train_optim_loss: 3179357.0822; val_kl_reg_loss: 20051.5343; val_edge_recon_loss: 711550.7017; val_cat_covariates_contrastive_loss: 950670.6112; val_gene_expr_recon_loss: 1509146.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5640.9712; val_global_loss: 3197059.9423; val_optim_loss: 3197059.9423
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9214; val_auprc_score: 0.9859; val_best_acc_score: 0.9278; val_best_f1_score: 0.9596; train_kl_reg_loss: 20247.4966; train_edge_recon_loss: 690949.7034; train_cat_covariates_contrastive_loss: 951156.3714; train_gene_expr_recon_loss: 1505733.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5665.6025; train_global_loss: 3173753.0147; train_optim_loss: 3173753.0147; val_kl_reg_loss: 20008.2210; val_edge_recon_loss: 705904.5653; val_cat_covariates_contrastive_loss: 951137.6888; val_gene_expr_recon_loss: 1504992.5240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5667.5728; val_global_loss: 3187710.4974; val_optim_loss: 3187710.4974
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9194; val_auprc_score: 0.9852; val_best_acc_score: 0.9263; val_best_f1_score: 0.9588; train_kl_reg_loss: 20116.5362; train_edge_recon_loss: 691878.5266; train_cat_covariates_contrastive_loss: 951144.0322; train_gene_expr_recon_loss: 1504529.9559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5671.4362; train_global_loss: 3173340.4864; train_optim_loss: 3173340.4864; val_kl_reg_loss: 19990.5578; val_edge_recon_loss: 713890.9288; val_cat_covariates_contrastive_loss: 950640.3245; val_gene_expr_recon_loss: 1504716.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5695.6479; val_global_loss: 3194934.5061; val_optim_loss: 3194934.5061
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9217; val_auprc_score: 0.9859; val_best_acc_score: 0.9265; val_best_f1_score: 0.9589; train_kl_reg_loss: 20067.3630; train_edge_recon_loss: 695364.4639; train_cat_covariates_contrastive_loss: 951151.9345; train_gene_expr_recon_loss: 1502842.6687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5673.4122; train_global_loss: 3175099.8393; train_optim_loss: 3175099.8393; val_kl_reg_loss: 19680.9825; val_edge_recon_loss: 713831.0502; val_cat_covariates_contrastive_loss: 951868.3038; val_gene_expr_recon_loss: 1503015.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5676.3481; val_global_loss: 3194072.3995; val_optim_loss: 3194072.3995
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9199; val_auprc_score: 0.9852; val_best_acc_score: 0.9256; val_best_f1_score: 0.9583; train_kl_reg_loss: 20067.6905; train_edge_recon_loss: 693066.1870; train_cat_covariates_contrastive_loss: 951112.9641; train_gene_expr_recon_loss: 1501868.4396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5668.7740; train_global_loss: 3171784.0569; train_optim_loss: 3171784.0569; val_kl_reg_loss: 19795.9954; val_edge_recon_loss: 722951.4049; val_cat_covariates_contrastive_loss: 950539.2113; val_gene_expr_recon_loss: 1502052.5621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5692.7900; val_global_loss: 3201031.9222; val_optim_loss: 3201031.9222
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9222; val_auprc_score: 0.9858; val_best_acc_score: 0.9274; val_best_f1_score: 0.9593; train_kl_reg_loss: 20006.0484; train_edge_recon_loss: 692338.0292; train_cat_covariates_contrastive_loss: 951106.4604; train_gene_expr_recon_loss: 1501106.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5665.7351; train_global_loss: 3170222.6752; train_optim_loss: 3170222.6752; val_kl_reg_loss: 19758.4801; val_edge_recon_loss: 716473.6040; val_cat_covariates_contrastive_loss: 950195.5326; val_gene_expr_recon_loss: 1503311.2723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5665.1133; val_global_loss: 3195403.8864; val_optim_loss: 3195403.8864

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9211; val_auprc_score: 0.9855; val_best_acc_score: 0.9261; val_best_f1_score: 0.9585; train_kl_reg_loss: 20024.4678; train_edge_recon_loss: 691952.0016; train_cat_covariates_contrastive_loss: 950867.0559; train_gene_expr_recon_loss: 1497531.7756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4938.1689; train_global_loss: 3165313.4716; train_optim_loss: 3165313.4716; val_kl_reg_loss: 19831.5341; val_edge_recon_loss: 720828.9620; val_cat_covariates_contrastive_loss: 950973.2139; val_gene_expr_recon_loss: 1499566.6958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4932.5049; val_global_loss: 3196132.8995; val_optim_loss: 3196132.8995
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9223; val_auprc_score: 0.9858; val_best_acc_score: 0.9268; val_best_f1_score: 0.9590; train_kl_reg_loss: 20081.7103; train_edge_recon_loss: 691295.6616; train_cat_covariates_contrastive_loss: 950794.7279; train_gene_expr_recon_loss: 1496674.1209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4935.5329; train_global_loss: 3163781.7560; train_optim_loss: 3163781.7560; val_kl_reg_loss: 19883.5349; val_edge_recon_loss: 715579.3950; val_cat_covariates_contrastive_loss: 950484.8247; val_gene_expr_recon_loss: 1499838.2295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4930.0527; val_global_loss: 3190715.9851; val_optim_loss: 3190715.9851
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9201; val_auprc_score: 0.9855; val_best_acc_score: 0.9270; val_best_f1_score: 0.9592; train_kl_reg_loss: 20065.3747; train_edge_recon_loss: 690503.1834; train_cat_covariates_contrastive_loss: 950881.2201; train_gene_expr_recon_loss: 1496988.4136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4936.4727; train_global_loss: 3163374.6633; train_optim_loss: 3163374.6633; val_kl_reg_loss: 19887.3397; val_edge_recon_loss: 714897.3859; val_cat_covariates_contrastive_loss: 950913.9808; val_gene_expr_recon_loss: 1499564.8239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4936.3950; val_global_loss: 3190200.0367; val_optim_loss: 3190200.0367
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9232; val_auprc_score: 0.9861; val_best_acc_score: 0.9278; val_best_f1_score: 0.9595; train_kl_reg_loss: 20028.8169; train_edge_recon_loss: 693657.8870; train_cat_covariates_contrastive_loss: 950787.9107; train_gene_expr_recon_loss: 1496319.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4938.8609; train_global_loss: 3165732.7242; train_optim_loss: 3165732.7242; val_kl_reg_loss: 19734.9916; val_edge_recon_loss: 710361.6354; val_cat_covariates_contrastive_loss: 951252.3335; val_gene_expr_recon_loss: 1499650.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4931.2847; val_global_loss: 3185930.2281; val_optim_loss: 3185930.2281
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9231; val_auprc_score: 0.9862; val_best_acc_score: 0.9266; val_best_f1_score: 0.9589; train_kl_reg_loss: 19986.0749; train_edge_recon_loss: 693404.1038; train_cat_covariates_contrastive_loss: 950925.7280; train_gene_expr_recon_loss: 1496445.8599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4942.5648; train_global_loss: 3165704.3346; train_optim_loss: 3165704.3346; val_kl_reg_loss: 19711.3019; val_edge_recon_loss: 713970.9745; val_cat_covariates_contrastive_loss: 950877.2974; val_gene_expr_recon_loss: 1499202.3300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4933.4316; val_global_loss: 3188695.4135; val_optim_loss: 3188695.4135
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9223; val_auprc_score: 0.9858; val_best_acc_score: 0.9271; val_best_f1_score: 0.9592; train_kl_reg_loss: 19978.5529; train_edge_recon_loss: 693525.8373; train_cat_covariates_contrastive_loss: 951081.2217; train_gene_expr_recon_loss: 1496183.2131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4938.4977; train_global_loss: 3165707.3204; train_optim_loss: 3165707.3204; val_kl_reg_loss: 19752.8306; val_edge_recon_loss: 716844.1467; val_cat_covariates_contrastive_loss: 951220.2279; val_gene_expr_recon_loss: 1498405.3575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4939.7554; val_global_loss: 3191162.3138; val_optim_loss: 3191162.3138
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9217; val_auprc_score: 0.9858; val_best_acc_score: 0.9277; val_best_f1_score: 0.9596; train_kl_reg_loss: 20037.7595; train_edge_recon_loss: 692171.1002; train_cat_covariates_contrastive_loss: 950751.9101; train_gene_expr_recon_loss: 1495847.8968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4936.7563; train_global_loss: 3163745.4203; train_optim_loss: 3163745.4203; val_kl_reg_loss: 19811.1919; val_edge_recon_loss: 709320.8138; val_cat_covariates_contrastive_loss: 950918.4493; val_gene_expr_recon_loss: 1498024.6425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4940.8071; val_global_loss: 3183015.8488; val_optim_loss: 3183015.8488
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9198; val_auprc_score: 0.9852; val_best_acc_score: 0.9258; val_best_f1_score: 0.9585; train_kl_reg_loss: 19998.1398; train_edge_recon_loss: 692515.9509; train_cat_covariates_contrastive_loss: 950888.1682; train_gene_expr_recon_loss: 1495951.8104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4937.2272; train_global_loss: 3164291.2990; train_optim_loss: 3164291.2990; val_kl_reg_loss: 19786.0384; val_edge_recon_loss: 722540.3333; val_cat_covariates_contrastive_loss: 950849.3940; val_gene_expr_recon_loss: 1498714.2382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4939.4985; val_global_loss: 3196829.5026; val_optim_loss: 3196829.5026
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9242; val_auprc_score: 0.9863; val_best_acc_score: 0.9265; val_best_f1_score: 0.9587; train_kl_reg_loss: 19988.3135; train_edge_recon_loss: 692090.3075; train_cat_covariates_contrastive_loss: 950698.9009; train_gene_expr_recon_loss: 1495763.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4937.1621; train_global_loss: 3163477.7020; train_optim_loss: 3163477.7020; val_kl_reg_loss: 19705.1204; val_edge_recon_loss: 721018.6635; val_cat_covariates_contrastive_loss: 950815.6149; val_gene_expr_recon_loss: 1498743.8741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4926.2100; val_global_loss: 3195209.5262; val_optim_loss: 3195209.5262
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9225; val_auprc_score: 0.9860; val_best_acc_score: 0.9265; val_best_f1_score: 0.9588; train_kl_reg_loss: 19987.3986; train_edge_recon_loss: 691831.4158; train_cat_covariates_contrastive_loss: 950856.2176; train_gene_expr_recon_loss: 1495987.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4935.0776; train_global_loss: 3163597.6004; train_optim_loss: 3163597.6004; val_kl_reg_loss: 19657.7673; val_edge_recon_loss: 717268.8776; val_cat_covariates_contrastive_loss: 951415.8169; val_gene_expr_recon_loss: 1497348.5656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4933.6519; val_global_loss: 3190624.7736; val_optim_loss: 3190624.7736
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9210; val_auprc_score: 0.9855; val_best_acc_score: 0.9268; val_best_f1_score: 0.9591; train_kl_reg_loss: 19945.0857; train_edge_recon_loss: 693566.9111; train_cat_covariates_contrastive_loss: 950812.3524; train_gene_expr_recon_loss: 1495881.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4939.2203; train_global_loss: 3165144.7921; train_optim_loss: 3165144.7921; val_kl_reg_loss: 19640.8199; val_edge_recon_loss: 714760.9272; val_cat_covariates_contrastive_loss: 951464.3510; val_gene_expr_recon_loss: 1497438.2601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4952.4336; val_global_loss: 3188256.8514; val_optim_loss: 3188256.8514

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9234; val_auprc_score: 0.9861; val_best_acc_score: 0.9274; val_best_f1_score: 0.9594; train_kl_reg_loss: 19922.7159; train_edge_recon_loss: 692266.0350; train_cat_covariates_contrastive_loss: 950897.3733; train_gene_expr_recon_loss: 1494519.1376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4867.4614; train_global_loss: 3162472.7179; train_optim_loss: 3162472.7179; val_kl_reg_loss: 19714.3722; val_edge_recon_loss: 713247.9939; val_cat_covariates_contrastive_loss: 950744.8003; val_gene_expr_recon_loss: 1497821.9873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4860.5181; val_global_loss: 3186389.6399; val_optim_loss: 3186389.6399
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9238; val_auprc_score: 0.9861; val_best_acc_score: 0.9280; val_best_f1_score: 0.9596; train_kl_reg_loss: 19925.2537; train_edge_recon_loss: 694439.6900; train_cat_covariates_contrastive_loss: 950940.3118; train_gene_expr_recon_loss: 1495251.5689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4860.4592; train_global_loss: 3165417.2856; train_optim_loss: 3165417.2856; val_kl_reg_loss: 19737.6646; val_edge_recon_loss: 712381.9819; val_cat_covariates_contrastive_loss: 950686.8623; val_gene_expr_recon_loss: 1497156.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4858.4434; val_global_loss: 3184821.8252; val_optim_loss: 3184821.8252
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9210; val_auprc_score: 0.9856; val_best_acc_score: 0.9273; val_best_f1_score: 0.9593; train_kl_reg_loss: 19952.4457; train_edge_recon_loss: 693809.7258; train_cat_covariates_contrastive_loss: 950834.6067; train_gene_expr_recon_loss: 1494951.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4858.4794; train_global_loss: 3164407.1962; train_optim_loss: 3164407.1962; val_kl_reg_loss: 19711.8644; val_edge_recon_loss: 712566.5262; val_cat_covariates_contrastive_loss: 950915.9854; val_gene_expr_recon_loss: 1499467.8352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4858.3906; val_global_loss: 3187520.7089; val_optim_loss: 3187520.7089
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9231; val_auprc_score: 0.9859; val_best_acc_score: 0.9275; val_best_f1_score: 0.9594; train_kl_reg_loss: 19921.9660; train_edge_recon_loss: 690413.9263; train_cat_covariates_contrastive_loss: 950782.2484; train_gene_expr_recon_loss: 1495114.8877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4859.6032; train_global_loss: 3161092.6308; train_optim_loss: 3161092.6308; val_kl_reg_loss: 19675.0882; val_edge_recon_loss: 715230.2927; val_cat_covariates_contrastive_loss: 951342.6930; val_gene_expr_recon_loss: 1498397.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4858.8999; val_global_loss: 3189504.8051; val_optim_loss: 3189504.8051

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1546 min 46 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.8731
val AUPRC score: 0.9678
val best accuracy score: 0.9191
val best F1 score: 0.9545
val target rna MSE score: 0.2563
val source rna MSE score: 0.1623
Val cat covariate0 mean sim diff: -0.0017
Val cat covariate1 mean sim diff: -0.0631
Val cat covariate2 mean sim diff: -0.0014

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
