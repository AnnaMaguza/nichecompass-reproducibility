[True, False, True]
Run timestamp: 05092023_121353_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9233; val_auprc_score: 0.9865; val_best_acc_score: 0.9253; val_best_f1_score: 0.9582; train_kl_reg_loss: 15822.2211; train_edge_recon_loss: 719584.8717; train_cat_covariates_contrastive_loss: 100176.5582; train_gene_expr_recon_loss: 2536378.6300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58798.4409; train_global_loss: 3430760.7185; train_optim_loss: 3430760.7185; val_kl_reg_loss: 15906.9997; val_edge_recon_loss: 721576.5184; val_cat_covariates_contrastive_loss: 100136.9980; val_gene_expr_recon_loss: 2201023.1670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15401.4521; val_global_loss: 3054045.1906; val_optim_loss: 3054045.1906
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9320; val_auprc_score: 0.9882; val_best_acc_score: 0.9302; val_best_f1_score: 0.9609; train_kl_reg_loss: 17369.5043; train_edge_recon_loss: 690947.1441; train_cat_covariates_contrastive_loss: 100181.5189; train_gene_expr_recon_loss: 2068070.6862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15671.9095; train_global_loss: 2892240.7629; train_optim_loss: 2892240.7629; val_kl_reg_loss: 18349.4854; val_edge_recon_loss: 710257.3715; val_cat_covariates_contrastive_loss: 100960.5895; val_gene_expr_recon_loss: 1993431.2002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15719.5361; val_global_loss: 2838718.1434; val_optim_loss: 2838718.1434
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9351; val_auprc_score: 0.9885; val_best_acc_score: 0.9306; val_best_f1_score: 0.9609; train_kl_reg_loss: 18915.2386; train_edge_recon_loss: 691105.4453; train_cat_covariates_contrastive_loss: 100190.8872; train_gene_expr_recon_loss: 1956183.7290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15881.9094; train_global_loss: 2782277.2058; train_optim_loss: 2782277.2058; val_kl_reg_loss: 19260.5777; val_edge_recon_loss: 716337.0418; val_cat_covariates_contrastive_loss: 100638.7546; val_gene_expr_recon_loss: 1929625.7797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15981.2979; val_global_loss: 2781843.3934; val_optim_loss: 2781843.3934
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9364; val_auprc_score: 0.9887; val_best_acc_score: 0.9327; val_best_f1_score: 0.9622; train_kl_reg_loss: 19841.1818; train_edge_recon_loss: 688966.3346; train_cat_covariates_contrastive_loss: 100362.7839; train_gene_expr_recon_loss: 1911322.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16068.8496; train_global_loss: 2736561.3857; train_optim_loss: 2736561.3857; val_kl_reg_loss: 20155.7061; val_edge_recon_loss: 710381.9755; val_cat_covariates_contrastive_loss: 100151.7985; val_gene_expr_recon_loss: 1898743.1486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16146.1025; val_global_loss: 2745578.6311; val_optim_loss: 2745578.6311
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9374; val_auprc_score: 0.9887; val_best_acc_score: 0.9337; val_best_f1_score: 0.9626; train_kl_reg_loss: 20554.2441; train_edge_recon_loss: 687884.3356; train_cat_covariates_contrastive_loss: 100421.6556; train_gene_expr_recon_loss: 1887626.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16124.3017; train_global_loss: 2712610.6872; train_optim_loss: 2712610.6872; val_kl_reg_loss: 20994.3281; val_edge_recon_loss: 709462.0944; val_cat_covariates_contrastive_loss: 100378.5673; val_gene_expr_recon_loss: 1883223.0087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16031.0840; val_global_loss: 2730089.0061; val_optim_loss: 2730089.0061
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9389; val_auprc_score: 0.9890; val_best_acc_score: 0.9334; val_best_f1_score: 0.9624; train_kl_reg_loss: 21113.8049; train_edge_recon_loss: 689704.6334; train_cat_covariates_contrastive_loss: 100518.6914; train_gene_expr_recon_loss: 1870368.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16221.6957; train_global_loss: 2697927.5484; train_optim_loss: 2697927.5484; val_kl_reg_loss: 21054.5605; val_edge_recon_loss: 714116.0278; val_cat_covariates_contrastive_loss: 100958.9732; val_gene_expr_recon_loss: 1867042.6853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16282.1006; val_global_loss: 2719454.2552; val_optim_loss: 2719454.2552
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9379; val_auprc_score: 0.9886; val_best_acc_score: 0.9348; val_best_f1_score: 0.9632; train_kl_reg_loss: 21618.3773; train_edge_recon_loss: 687186.2465; train_cat_covariates_contrastive_loss: 100620.6916; train_gene_expr_recon_loss: 1857787.0587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16254.2713; train_global_loss: 2683466.6457; train_optim_loss: 2683466.6457; val_kl_reg_loss: 21917.8544; val_edge_recon_loss: 712382.5363; val_cat_covariates_contrastive_loss: 100287.1239; val_gene_expr_recon_loss: 1858231.1115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16250.6924; val_global_loss: 2709069.3663; val_optim_loss: 2709069.3663
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9404; val_auprc_score: 0.9893; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 22152.5480; train_edge_recon_loss: 690662.2386; train_cat_covariates_contrastive_loss: 100810.4291; train_gene_expr_recon_loss: 1857446.8539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16253.7765; train_global_loss: 2687325.8443; train_optim_loss: 2687325.8443; val_kl_reg_loss: 22534.8767; val_edge_recon_loss: 711480.4071; val_cat_covariates_contrastive_loss: 100886.6274; val_gene_expr_recon_loss: 1860408.9738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16319.5264; val_global_loss: 2711630.3846; val_optim_loss: 2711630.3846
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9403; val_auprc_score: 0.9892; val_best_acc_score: 0.9362; val_best_f1_score: 0.9640; train_kl_reg_loss: 22471.4171; train_edge_recon_loss: 690344.1976; train_cat_covariates_contrastive_loss: 100867.1446; train_gene_expr_recon_loss: 1838399.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16332.7940; train_global_loss: 2668414.6048; train_optim_loss: 2668414.6048; val_kl_reg_loss: 22603.9816; val_edge_recon_loss: 711881.7262; val_cat_covariates_contrastive_loss: 100632.9326; val_gene_expr_recon_loss: 1839185.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16338.0283; val_global_loss: 2690642.0122; val_optim_loss: 2690642.0122
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9396; val_auprc_score: 0.9891; val_best_acc_score: 0.9353; val_best_f1_score: 0.9635; train_kl_reg_loss: 23059.4949; train_edge_recon_loss: 689938.3785; train_cat_covariates_contrastive_loss: 100937.8976; train_gene_expr_recon_loss: 1833218.4169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16492.5334; train_global_loss: 2663646.7234; train_optim_loss: 2663646.7234; val_kl_reg_loss: 23108.5299; val_edge_recon_loss: 714526.2449; val_cat_covariates_contrastive_loss: 100960.2328; val_gene_expr_recon_loss: 1844379.5721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16642.3262; val_global_loss: 2699616.8304; val_optim_loss: 2699616.8304
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9438; val_auprc_score: 0.9900; val_best_acc_score: 0.9384; val_best_f1_score: 0.9653; train_kl_reg_loss: 25224.5492; train_edge_recon_loss: 688466.7883; train_cat_covariates_contrastive_loss: 101047.2486; train_gene_expr_recon_loss: 1850275.9782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16555.6100; train_global_loss: 2681570.1756; train_optim_loss: 2681570.1756; val_kl_reg_loss: 24526.1842; val_edge_recon_loss: 705897.8076; val_cat_covariates_contrastive_loss: 101220.9435; val_gene_expr_recon_loss: 1827784.7496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16399.3164; val_global_loss: 2675828.9379; val_optim_loss: 2675828.9379
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9444; val_auprc_score: 0.9901; val_best_acc_score: 0.9380; val_best_f1_score: 0.9650; train_kl_reg_loss: 24670.6128; train_edge_recon_loss: 687744.2164; train_cat_covariates_contrastive_loss: 101153.3174; train_gene_expr_recon_loss: 1821919.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16597.2394; train_global_loss: 2652084.5259; train_optim_loss: 2652084.5259; val_kl_reg_loss: 24220.4301; val_edge_recon_loss: 709302.7992; val_cat_covariates_contrastive_loss: 101809.7366; val_gene_expr_recon_loss: 1828147.1473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16670.0547; val_global_loss: 2680150.1145; val_optim_loss: 2680150.1145
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9442; val_auprc_score: 0.9898; val_best_acc_score: 0.9379; val_best_f1_score: 0.9649; train_kl_reg_loss: 1185413.1245; train_edge_recon_loss: 697678.6617; train_cat_covariates_contrastive_loss: 100502.4827; train_gene_expr_recon_loss: 2125884.7075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17709.8297; train_global_loss: 4127188.8416; train_optim_loss: 4127188.8416; val_kl_reg_loss: 25427.5678; val_edge_recon_loss: 710402.3684; val_cat_covariates_contrastive_loss: 101276.9629; val_gene_expr_recon_loss: 1925570.1018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16839.6895; val_global_loss: 2779516.7544; val_optim_loss: 2779516.7544
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9431; val_auprc_score: 0.9897; val_best_acc_score: 0.9375; val_best_f1_score: 0.9647; train_kl_reg_loss: 71134.3554; train_edge_recon_loss: 689735.9429; train_cat_covariates_contrastive_loss: 101441.5378; train_gene_expr_recon_loss: 1898894.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16760.4953; train_global_loss: 2777967.1640; train_optim_loss: 2777967.1640; val_kl_reg_loss: 26547.6251; val_edge_recon_loss: 714720.7576; val_cat_covariates_contrastive_loss: 102189.8747; val_gene_expr_recon_loss: 1864361.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16637.2852; val_global_loss: 2724457.1302; val_optim_loss: 2724457.1302
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9442; val_auprc_score: 0.9899; val_best_acc_score: 0.9392; val_best_f1_score: 0.9658; train_kl_reg_loss: 26754.4011; train_edge_recon_loss: 691290.2577; train_cat_covariates_contrastive_loss: 101714.6156; train_gene_expr_recon_loss: 1842744.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16663.1405; train_global_loss: 2679167.3365; train_optim_loss: 2679167.3365; val_kl_reg_loss: 26685.7751; val_edge_recon_loss: 710794.7831; val_cat_covariates_contrastive_loss: 102361.3263; val_gene_expr_recon_loss: 1835360.6604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16771.2266; val_global_loss: 2691973.7928; val_optim_loss: 2691973.7928

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9432; val_auprc_score: 0.9897; val_best_acc_score: 0.9392; val_best_f1_score: 0.9657; train_kl_reg_loss: 26355.5862; train_edge_recon_loss: 689722.9425; train_cat_covariates_contrastive_loss: 101679.4307; train_gene_expr_recon_loss: 1802720.3175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8099.1603; train_global_loss: 2628577.4353; train_optim_loss: 2628577.4353; val_kl_reg_loss: 26510.0080; val_edge_recon_loss: 709363.3545; val_cat_covariates_contrastive_loss: 101816.2686; val_gene_expr_recon_loss: 1808372.5634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8037.5586; val_global_loss: 2654099.6914; val_optim_loss: 2654099.6914
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9457; val_auprc_score: 0.9901; val_best_acc_score: 0.9391; val_best_f1_score: 0.9657; train_kl_reg_loss: 26218.1208; train_edge_recon_loss: 688279.8236; train_cat_covariates_contrastive_loss: 101698.0798; train_gene_expr_recon_loss: 1796156.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8047.8797; train_global_loss: 2620400.5836; train_optim_loss: 2620400.5836; val_kl_reg_loss: 26166.0399; val_edge_recon_loss: 714765.7406; val_cat_covariates_contrastive_loss: 101820.8460; val_gene_expr_recon_loss: 1803219.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8113.3062; val_global_loss: 2654084.9519; val_optim_loss: 2654084.9519
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9451; val_auprc_score: 0.9901; val_best_acc_score: 0.9395; val_best_f1_score: 0.9658; train_kl_reg_loss: 26008.9166; train_edge_recon_loss: 686372.4825; train_cat_covariates_contrastive_loss: 101652.0820; train_gene_expr_recon_loss: 1791335.2205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8064.7869; train_global_loss: 2613433.4908; train_optim_loss: 2613433.4908; val_kl_reg_loss: 26015.6377; val_edge_recon_loss: 707479.6944; val_cat_covariates_contrastive_loss: 101831.6251; val_gene_expr_recon_loss: 1799619.8156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8127.2305; val_global_loss: 2643074.0236; val_optim_loss: 2643074.0236
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9455; val_auprc_score: 0.9901; val_best_acc_score: 0.9401; val_best_f1_score: 0.9662; train_kl_reg_loss: 25832.6813; train_edge_recon_loss: 683800.9366; train_cat_covariates_contrastive_loss: 101609.7016; train_gene_expr_recon_loss: 1788783.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8088.7656; train_global_loss: 2608115.6074; train_optim_loss: 2608115.6074; val_kl_reg_loss: 26129.4641; val_edge_recon_loss: 711379.9028; val_cat_covariates_contrastive_loss: 101474.2280; val_gene_expr_recon_loss: 1796214.1464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8090.3999; val_global_loss: 2643288.2386; val_optim_loss: 2643288.2386
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9459; val_auprc_score: 0.9901; val_best_acc_score: 0.9394; val_best_f1_score: 0.9658; train_kl_reg_loss: 25652.0811; train_edge_recon_loss: 684511.8240; train_cat_covariates_contrastive_loss: 101575.8666; train_gene_expr_recon_loss: 1785949.3195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8116.0263; train_global_loss: 2605805.1183; train_optim_loss: 2605805.1183; val_kl_reg_loss: 25629.7505; val_edge_recon_loss: 712067.3720; val_cat_covariates_contrastive_loss: 101720.8056; val_gene_expr_recon_loss: 1793756.5542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8133.0317; val_global_loss: 2641307.4843; val_optim_loss: 2641307.4843
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9456; val_auprc_score: 0.9900; val_best_acc_score: 0.9395; val_best_f1_score: 0.9658; train_kl_reg_loss: 25346.6462; train_edge_recon_loss: 689022.0475; train_cat_covariates_contrastive_loss: 101500.1041; train_gene_expr_recon_loss: 1782685.9959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8175.5815; train_global_loss: 2606730.3766; train_optim_loss: 2606730.3766; val_kl_reg_loss: 25235.9649; val_edge_recon_loss: 715866.7950; val_cat_covariates_contrastive_loss: 101567.9905; val_gene_expr_recon_loss: 1791676.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8213.2490; val_global_loss: 2642560.7535; val_optim_loss: 2642560.7535
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9459; val_auprc_score: 0.9902; val_best_acc_score: 0.9393; val_best_f1_score: 0.9657; train_kl_reg_loss: 25027.7826; train_edge_recon_loss: 686802.9754; train_cat_covariates_contrastive_loss: 101469.1063; train_gene_expr_recon_loss: 1780637.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8203.9749; train_global_loss: 2602141.3241; train_optim_loss: 2602141.3241; val_kl_reg_loss: 25106.0291; val_edge_recon_loss: 712364.5836; val_cat_covariates_contrastive_loss: 101474.3020; val_gene_expr_recon_loss: 1788382.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8270.2598; val_global_loss: 2635597.3698; val_optim_loss: 2635597.3698
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9449; val_auprc_score: 0.9899; val_best_acc_score: 0.9395; val_best_f1_score: 0.9659; train_kl_reg_loss: 24752.9918; train_edge_recon_loss: 685879.8334; train_cat_covariates_contrastive_loss: 101391.7369; train_gene_expr_recon_loss: 1778503.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8243.9541; train_global_loss: 2598772.2237; train_optim_loss: 2598772.2237; val_kl_reg_loss: 24793.6370; val_edge_recon_loss: 714483.1372; val_cat_covariates_contrastive_loss: 101500.8946; val_gene_expr_recon_loss: 1788001.4663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8212.9775; val_global_loss: 2636992.1329; val_optim_loss: 2636992.1329
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9462; val_auprc_score: 0.9903; val_best_acc_score: 0.9400; val_best_f1_score: 0.9662; train_kl_reg_loss: 24544.4335; train_edge_recon_loss: 686231.4422; train_cat_covariates_contrastive_loss: 101360.3027; train_gene_expr_recon_loss: 1776866.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8286.3520; train_global_loss: 2597288.8962; train_optim_loss: 2597288.8962; val_kl_reg_loss: 24623.9562; val_edge_recon_loss: 707982.0722; val_cat_covariates_contrastive_loss: 101795.9659; val_gene_expr_recon_loss: 1786346.3300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8333.6162; val_global_loss: 2629081.8182; val_optim_loss: 2629081.8182
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9474; val_auprc_score: 0.9903; val_best_acc_score: 0.9405; val_best_f1_score: 0.9663; train_kl_reg_loss: 24362.4827; train_edge_recon_loss: 688313.2774; train_cat_covariates_contrastive_loss: 101348.3082; train_gene_expr_recon_loss: 1775230.4600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8322.7414; train_global_loss: 2597577.2735; train_optim_loss: 2597577.2735; val_kl_reg_loss: 24405.2806; val_edge_recon_loss: 715576.2915; val_cat_covariates_contrastive_loss: 101537.9078; val_gene_expr_recon_loss: 1782594.9572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8312.0039; val_global_loss: 2632426.4353; val_optim_loss: 2632426.4353
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9378; val_auprc_score: 0.9885; val_best_acc_score: 0.9350; val_best_f1_score: 0.9634; train_kl_reg_loss: 23561.8110; train_edge_recon_loss: 692496.4129; train_cat_covariates_contrastive_loss: 101106.3364; train_gene_expr_recon_loss: 1672145.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7225.6126; train_global_loss: 2496536.0162; train_optim_loss: 2496536.0162; val_kl_reg_loss: 18495.5473; val_edge_recon_loss: 713973.3942; val_cat_covariates_contrastive_loss: 100922.5904; val_gene_expr_recon_loss: 1674233.1958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6849.8989; val_global_loss: 2514474.7238; val_optim_loss: 2514474.7238
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9370; val_auprc_score: 0.9881; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 22871.7936; train_edge_recon_loss: 693662.3049; train_cat_covariates_contrastive_loss: 100932.4999; train_gene_expr_recon_loss: 1665074.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6808.2584; train_global_loss: 2489349.3370; train_optim_loss: 2489349.3370; val_kl_reg_loss: 19024.0382; val_edge_recon_loss: 720616.7244; val_cat_covariates_contrastive_loss: 100858.9967; val_gene_expr_recon_loss: 1670823.4353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6829.6143; val_global_loss: 2518152.6949; val_optim_loss: 2518152.6949
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9401; val_auprc_score: 0.9891; val_best_acc_score: 0.9353; val_best_f1_score: 0.9635; train_kl_reg_loss: 21688.5549; train_edge_recon_loss: 689025.6866; train_cat_covariates_contrastive_loss: 100834.2233; train_gene_expr_recon_loss: 1660303.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6808.6575; train_global_loss: 2478660.9563; train_optim_loss: 2478660.9563; val_kl_reg_loss: 19415.1037; val_edge_recon_loss: 712659.9897; val_cat_covariates_contrastive_loss: 100908.1355; val_gene_expr_recon_loss: 1666938.0774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6812.5474; val_global_loss: 2506733.8068; val_optim_loss: 2506733.8068
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9392; val_auprc_score: 0.9888; val_best_acc_score: 0.9351; val_best_f1_score: 0.9634; train_kl_reg_loss: 21122.7600; train_edge_recon_loss: 688589.6001; train_cat_covariates_contrastive_loss: 100788.2646; train_gene_expr_recon_loss: 1654219.7371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6827.2362; train_global_loss: 2471547.6023; train_optim_loss: 2471547.6023; val_kl_reg_loss: 19690.2269; val_edge_recon_loss: 717492.8955; val_cat_covariates_contrastive_loss: 100770.6752; val_gene_expr_recon_loss: 1648861.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6829.8311; val_global_loss: 2493644.7946; val_optim_loss: 2493644.7946
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9428; val_auprc_score: 0.9896; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 20838.1258; train_edge_recon_loss: 686994.3033; train_cat_covariates_contrastive_loss: 100775.7735; train_gene_expr_recon_loss: 1640823.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6849.1282; train_global_loss: 2456280.8748; train_optim_loss: 2456280.8748; val_kl_reg_loss: 19725.5047; val_edge_recon_loss: 713316.9252; val_cat_covariates_contrastive_loss: 101041.1295; val_gene_expr_recon_loss: 1647461.0232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6849.9658; val_global_loss: 2488394.5769; val_optim_loss: 2488394.5769
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9397; val_auprc_score: 0.9889; val_best_acc_score: 0.9369; val_best_f1_score: 0.9644; train_kl_reg_loss: 20746.5581; train_edge_recon_loss: 687685.3581; train_cat_covariates_contrastive_loss: 100750.0286; train_gene_expr_recon_loss: 1636397.0193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6870.9842; train_global_loss: 2452449.9482; train_optim_loss: 2452449.9482; val_kl_reg_loss: 19909.7602; val_edge_recon_loss: 710618.5155; val_cat_covariates_contrastive_loss: 100717.8852; val_gene_expr_recon_loss: 1642017.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6860.6230; val_global_loss: 2480123.8462; val_optim_loss: 2480123.8462
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9897; val_best_acc_score: 0.9375; val_best_f1_score: 0.9648; train_kl_reg_loss: 20560.5110; train_edge_recon_loss: 685086.0098; train_cat_covariates_contrastive_loss: 100705.4145; train_gene_expr_recon_loss: 1633993.7655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6885.4216; train_global_loss: 2447231.1182; train_optim_loss: 2447231.1182; val_kl_reg_loss: 19727.4700; val_edge_recon_loss: 712085.7165; val_cat_covariates_contrastive_loss: 100903.2108; val_gene_expr_recon_loss: 1640820.6294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6909.4058; val_global_loss: 2480446.5297; val_optim_loss: 2480446.5297
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9420; val_auprc_score: 0.9893; val_best_acc_score: 0.9377; val_best_f1_score: 0.9649; train_kl_reg_loss: 20417.9172; train_edge_recon_loss: 688165.9011; train_cat_covariates_contrastive_loss: 100706.0693; train_gene_expr_recon_loss: 1631343.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6904.5482; train_global_loss: 2447538.4021; train_optim_loss: 2447538.4021; val_kl_reg_loss: 19765.5932; val_edge_recon_loss: 711813.0164; val_cat_covariates_contrastive_loss: 100524.5986; val_gene_expr_recon_loss: 1638706.2417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6919.8784; val_global_loss: 2477729.4449; val_optim_loss: 2477729.4449
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9430; val_auprc_score: 0.9896; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 20402.7018; train_edge_recon_loss: 687809.0134; train_cat_covariates_contrastive_loss: 100735.2396; train_gene_expr_recon_loss: 1628581.9048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6921.0257; train_global_loss: 2444449.8867; train_optim_loss: 2444449.8867; val_kl_reg_loss: 20020.5140; val_edge_recon_loss: 713807.2406; val_cat_covariates_contrastive_loss: 100666.2971; val_gene_expr_recon_loss: 1638464.8759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6938.4175; val_global_loss: 2479897.4353; val_optim_loss: 2479897.4353
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9442; val_auprc_score: 0.9899; val_best_acc_score: 0.9387; val_best_f1_score: 0.9653; train_kl_reg_loss: 20326.9891; train_edge_recon_loss: 687511.4589; train_cat_covariates_contrastive_loss: 100698.5537; train_gene_expr_recon_loss: 1627720.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6947.9714; train_global_loss: 2443205.0488; train_optim_loss: 2443205.0488; val_kl_reg_loss: 19907.2410; val_edge_recon_loss: 708439.8353; val_cat_covariates_contrastive_loss: 100761.5295; val_gene_expr_recon_loss: 1637795.2316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6976.0371; val_global_loss: 2473879.8427; val_optim_loss: 2473879.8427
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9421; val_auprc_score: 0.9894; val_best_acc_score: 0.9369; val_best_f1_score: 0.9645; train_kl_reg_loss: 20226.7785; train_edge_recon_loss: 686357.1985; train_cat_covariates_contrastive_loss: 100668.6467; train_gene_expr_recon_loss: 1625381.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6955.9040; train_global_loss: 2439589.8385; train_optim_loss: 2439589.8385; val_kl_reg_loss: 20016.0959; val_edge_recon_loss: 710699.9759; val_cat_covariates_contrastive_loss: 100401.3022; val_gene_expr_recon_loss: 1633440.0341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6914.7754; val_global_loss: 2471472.1530; val_optim_loss: 2471472.1530
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9438; val_auprc_score: 0.9897; val_best_acc_score: 0.9375; val_best_f1_score: 0.9647; train_kl_reg_loss: 20404.2476; train_edge_recon_loss: 686860.7904; train_cat_covariates_contrastive_loss: 100628.9003; train_gene_expr_recon_loss: 1624306.6724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6969.4982; train_global_loss: 2439170.1062; train_optim_loss: 2439170.1062; val_kl_reg_loss: 20099.4391; val_edge_recon_loss: 718772.7037; val_cat_covariates_contrastive_loss: 100568.4074; val_gene_expr_recon_loss: 1633427.0437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6970.2319; val_global_loss: 2479837.8400; val_optim_loss: 2479837.8400
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9424; val_auprc_score: 0.9894; val_best_acc_score: 0.9382; val_best_f1_score: 0.9652; train_kl_reg_loss: 20181.5526; train_edge_recon_loss: 687117.3334; train_cat_covariates_contrastive_loss: 100634.1992; train_gene_expr_recon_loss: 1622609.4904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6969.1563; train_global_loss: 2437511.7321; train_optim_loss: 2437511.7321; val_kl_reg_loss: 19775.0640; val_edge_recon_loss: 713057.7002; val_cat_covariates_contrastive_loss: 100769.7624; val_gene_expr_recon_loss: 1631710.3352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7005.3447; val_global_loss: 2472318.1084; val_optim_loss: 2472318.1084
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9429; val_auprc_score: 0.9894; val_best_acc_score: 0.9379; val_best_f1_score: 0.9650; train_kl_reg_loss: 20098.4361; train_edge_recon_loss: 685954.1421; train_cat_covariates_contrastive_loss: 100609.5248; train_gene_expr_recon_loss: 1620479.1940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6996.4954; train_global_loss: 2434137.7954; train_optim_loss: 2434137.7954; val_kl_reg_loss: 19628.5491; val_edge_recon_loss: 716545.1681; val_cat_covariates_contrastive_loss: 100735.7571; val_gene_expr_recon_loss: 1628618.2976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7055.0288; val_global_loss: 2472582.7762; val_optim_loss: 2472582.7762
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9429; val_auprc_score: 0.9896; val_best_acc_score: 0.9380; val_best_f1_score: 0.9651; train_kl_reg_loss: 20083.1461; train_edge_recon_loss: 686217.0428; train_cat_covariates_contrastive_loss: 100581.1529; train_gene_expr_recon_loss: 1619131.8288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6999.8870; train_global_loss: 2433013.0567; train_optim_loss: 2433013.0567; val_kl_reg_loss: 19963.4681; val_edge_recon_loss: 706305.7407; val_cat_covariates_contrastive_loss: 100699.5128; val_gene_expr_recon_loss: 1628025.1997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6941.9282; val_global_loss: 2461935.9126; val_optim_loss: 2461935.9126
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9437; val_auprc_score: 0.9898; val_best_acc_score: 0.9382; val_best_f1_score: 0.9651; train_kl_reg_loss: 20042.7592; train_edge_recon_loss: 687547.3539; train_cat_covariates_contrastive_loss: 100590.6789; train_gene_expr_recon_loss: 1617589.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6993.4600; train_global_loss: 2432763.5286; train_optim_loss: 2432763.5286; val_kl_reg_loss: 19633.2215; val_edge_recon_loss: 707040.7153; val_cat_covariates_contrastive_loss: 100628.6479; val_gene_expr_recon_loss: 1627450.9987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7049.2021; val_global_loss: 2461802.8392; val_optim_loss: 2461802.8392
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9426; val_auprc_score: 0.9895; val_best_acc_score: 0.9379; val_best_f1_score: 0.9651; train_kl_reg_loss: 19996.5306; train_edge_recon_loss: 684982.9155; train_cat_covariates_contrastive_loss: 100586.4267; train_gene_expr_recon_loss: 1616873.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7000.5327; train_global_loss: 2429439.7513; train_optim_loss: 2429439.7513; val_kl_reg_loss: 19728.4770; val_edge_recon_loss: 706148.7281; val_cat_covariates_contrastive_loss: 100741.2504; val_gene_expr_recon_loss: 1625741.2373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7036.6118; val_global_loss: 2459396.1923; val_optim_loss: 2459396.1923
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9416; val_auprc_score: 0.9893; val_best_acc_score: 0.9381; val_best_f1_score: 0.9651; train_kl_reg_loss: 20011.8258; train_edge_recon_loss: 686229.4643; train_cat_covariates_contrastive_loss: 100552.8922; train_gene_expr_recon_loss: 1616397.8642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7017.6013; train_global_loss: 2430209.6499; train_optim_loss: 2430209.6499; val_kl_reg_loss: 19927.2147; val_edge_recon_loss: 703749.1368; val_cat_covariates_contrastive_loss: 100603.3924; val_gene_expr_recon_loss: 1625336.2155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7006.7393; val_global_loss: 2456622.7072; val_optim_loss: 2456622.7072
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9427; val_auprc_score: 0.9895; val_best_acc_score: 0.9373; val_best_f1_score: 0.9646; train_kl_reg_loss: 20125.2286; train_edge_recon_loss: 685561.3035; train_cat_covariates_contrastive_loss: 100468.2572; train_gene_expr_recon_loss: 1615231.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7025.4431; train_global_loss: 2428411.6250; train_optim_loss: 2428411.6250; val_kl_reg_loss: 19938.9762; val_edge_recon_loss: 711857.0778; val_cat_covariates_contrastive_loss: 100408.5116; val_gene_expr_recon_loss: 1623766.0459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7042.9087; val_global_loss: 2463013.6119; val_optim_loss: 2463013.6119
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9415; val_auprc_score: 0.9893; val_best_acc_score: 0.9377; val_best_f1_score: 0.9649; train_kl_reg_loss: 19811.6272; train_edge_recon_loss: 685907.5121; train_cat_covariates_contrastive_loss: 100424.8176; train_gene_expr_recon_loss: 1614345.8298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7029.9942; train_global_loss: 2427519.7785; train_optim_loss: 2427519.7785; val_kl_reg_loss: 19944.4100; val_edge_recon_loss: 706850.4988; val_cat_covariates_contrastive_loss: 100308.9629; val_gene_expr_recon_loss: 1624958.6469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6991.8916; val_global_loss: 2459054.5201; val_optim_loss: 2459054.5201
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9442; val_auprc_score: 0.9897; val_best_acc_score: 0.9385; val_best_f1_score: 0.9653; train_kl_reg_loss: 19811.3535; train_edge_recon_loss: 686490.9967; train_cat_covariates_contrastive_loss: 100479.1160; train_gene_expr_recon_loss: 1614409.8890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7036.8037; train_global_loss: 2428228.1604; train_optim_loss: 2428228.1604; val_kl_reg_loss: 19629.1706; val_edge_recon_loss: 711568.2255; val_cat_covariates_contrastive_loss: 100664.3081; val_gene_expr_recon_loss: 1624514.5415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7038.2695; val_global_loss: 2463414.4930; val_optim_loss: 2463414.4930
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9438; val_auprc_score: 0.9896; val_best_acc_score: 0.9387; val_best_f1_score: 0.9654; train_kl_reg_loss: 19714.2542; train_edge_recon_loss: 688644.2654; train_cat_covariates_contrastive_loss: 100414.5719; train_gene_expr_recon_loss: 1613205.8543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7040.5044; train_global_loss: 2429019.4471; train_optim_loss: 2429019.4471; val_kl_reg_loss: 19598.6928; val_edge_recon_loss: 710682.3542; val_cat_covariates_contrastive_loss: 100512.6751; val_gene_expr_recon_loss: 1622229.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7048.4648; val_global_loss: 2460071.4038; val_optim_loss: 2460071.4038

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9446; val_auprc_score: 0.9900; val_best_acc_score: 0.9392; val_best_f1_score: 0.9657; train_kl_reg_loss: 19719.0410; train_edge_recon_loss: 686250.9802; train_cat_covariates_contrastive_loss: 100348.6619; train_gene_expr_recon_loss: 1609463.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6268.0701; train_global_loss: 2422050.1344; train_optim_loss: 2422050.1344; val_kl_reg_loss: 19561.6746; val_edge_recon_loss: 702769.4465; val_cat_covariates_contrastive_loss: 100406.2695; val_gene_expr_recon_loss: 1619816.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6245.8208; val_global_loss: 2448799.4825; val_optim_loss: 2448799.4825
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9470; val_auprc_score: 0.9906; val_best_acc_score: 0.9393; val_best_f1_score: 0.9658; train_kl_reg_loss: 19712.8869; train_edge_recon_loss: 687881.1733; train_cat_covariates_contrastive_loss: 100381.4101; train_gene_expr_recon_loss: 1608574.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6249.0110; train_global_loss: 2422798.8577; train_optim_loss: 2422798.8577; val_kl_reg_loss: 19534.6929; val_edge_recon_loss: 703660.7886; val_cat_covariates_contrastive_loss: 100547.6491; val_gene_expr_recon_loss: 1619272.2863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6262.8726; val_global_loss: 2449278.1678; val_optim_loss: 2449278.1678
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9433; val_auprc_score: 0.9897; val_best_acc_score: 0.9377; val_best_f1_score: 0.9648; train_kl_reg_loss: 19668.0369; train_edge_recon_loss: 684496.2467; train_cat_covariates_contrastive_loss: 100389.2333; train_gene_expr_recon_loss: 1608379.6828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6258.5861; train_global_loss: 2419191.7852; train_optim_loss: 2419191.7852; val_kl_reg_loss: 19530.5688; val_edge_recon_loss: 714179.7513; val_cat_covariates_contrastive_loss: 100542.2038; val_gene_expr_recon_loss: 1619655.0813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6252.6753; val_global_loss: 2460160.3453; val_optim_loss: 2460160.3453
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9442; val_auprc_score: 0.9898; val_best_acc_score: 0.9380; val_best_f1_score: 0.9650; train_kl_reg_loss: 19637.6806; train_edge_recon_loss: 683853.7522; train_cat_covariates_contrastive_loss: 100384.6570; train_gene_expr_recon_loss: 1608021.4412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6264.9404; train_global_loss: 2418162.4729; train_optim_loss: 2418162.4729; val_kl_reg_loss: 19496.4294; val_edge_recon_loss: 712685.0878; val_cat_covariates_contrastive_loss: 100557.4044; val_gene_expr_recon_loss: 1619402.4729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6256.2856; val_global_loss: 2458397.6469; val_optim_loss: 2458397.6469
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9442; val_auprc_score: 0.9898; val_best_acc_score: 0.9390; val_best_f1_score: 0.9656; train_kl_reg_loss: 19654.2342; train_edge_recon_loss: 686215.5753; train_cat_covariates_contrastive_loss: 100388.5630; train_gene_expr_recon_loss: 1608580.7711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6263.2197; train_global_loss: 2421102.3658; train_optim_loss: 2421102.3658; val_kl_reg_loss: 19543.6145; val_edge_recon_loss: 706229.6428; val_cat_covariates_contrastive_loss: 100478.8049; val_gene_expr_recon_loss: 1618630.4707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6262.5933; val_global_loss: 2451145.0323; val_optim_loss: 2451145.0323

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9438; val_auprc_score: 0.9897; val_best_acc_score: 0.9383; val_best_f1_score: 0.9651; train_kl_reg_loss: 19666.4181; train_edge_recon_loss: 684698.2970; train_cat_covariates_contrastive_loss: 100389.9011; train_gene_expr_recon_loss: 1608220.6405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6173.8894; train_global_loss: 2419149.1427; train_optim_loss: 2419149.1427; val_kl_reg_loss: 19527.2055; val_edge_recon_loss: 711021.9294; val_cat_covariates_contrastive_loss: 100438.8864; val_gene_expr_recon_loss: 1618164.9633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6169.2412; val_global_loss: 2455322.2203; val_optim_loss: 2455322.2203
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9446; val_auprc_score: 0.9900; val_best_acc_score: 0.9386; val_best_f1_score: 0.9654; train_kl_reg_loss: 19661.9727; train_edge_recon_loss: 685597.5198; train_cat_covariates_contrastive_loss: 100374.9298; train_gene_expr_recon_loss: 1607726.3901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6168.5498; train_global_loss: 2419529.3629; train_optim_loss: 2419529.3629; val_kl_reg_loss: 19524.7390; val_edge_recon_loss: 706188.9468; val_cat_covariates_contrastive_loss: 100542.8249; val_gene_expr_recon_loss: 1618797.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6169.9595; val_global_loss: 2451224.3846; val_optim_loss: 2451224.3846
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9443; val_auprc_score: 0.9899; val_best_acc_score: 0.9389; val_best_f1_score: 0.9655; train_kl_reg_loss: 19653.3198; train_edge_recon_loss: 684246.4336; train_cat_covariates_contrastive_loss: 100380.9123; train_gene_expr_recon_loss: 1607892.8921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6171.0600; train_global_loss: 2418344.6206; train_optim_loss: 2418344.6206; val_kl_reg_loss: 19507.8415; val_edge_recon_loss: 702007.3212; val_cat_covariates_contrastive_loss: 100545.1013; val_gene_expr_recon_loss: 1618013.8820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6169.8525; val_global_loss: 2446243.8960; val_optim_loss: 2446243.8960
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9449; val_auprc_score: 0.9900; val_best_acc_score: 0.9384; val_best_f1_score: 0.9652; train_kl_reg_loss: 19642.0254; train_edge_recon_loss: 686027.5185; train_cat_covariates_contrastive_loss: 100403.0261; train_gene_expr_recon_loss: 1607900.0675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6169.5547; train_global_loss: 2420142.1955; train_optim_loss: 2420142.1955; val_kl_reg_loss: 19491.7336; val_edge_recon_loss: 711071.5878; val_cat_covariates_contrastive_loss: 100496.0077; val_gene_expr_recon_loss: 1618552.9659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6169.6548; val_global_loss: 2455782.0411; val_optim_loss: 2455782.0411
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9438; val_auprc_score: 0.9897; val_best_acc_score: 0.9395; val_best_f1_score: 0.9659; train_kl_reg_loss: 19630.3765; train_edge_recon_loss: 685359.9319; train_cat_covariates_contrastive_loss: 100355.5070; train_gene_expr_recon_loss: 1607524.9163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6171.1002; train_global_loss: 2419041.8301; train_optim_loss: 2419041.8301; val_kl_reg_loss: 19497.1602; val_edge_recon_loss: 706592.7179; val_cat_covariates_contrastive_loss: 100398.0279; val_gene_expr_recon_loss: 1617000.9292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6173.6230; val_global_loss: 2449662.3400; val_optim_loss: 2449662.3400
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9433; val_auprc_score: 0.9895; val_best_acc_score: 0.9383; val_best_f1_score: 0.9652; train_kl_reg_loss: 19625.5223; train_edge_recon_loss: 684153.0894; train_cat_covariates_contrastive_loss: 100328.1441; train_gene_expr_recon_loss: 1607617.2867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6173.1360; train_global_loss: 2417897.1794; train_optim_loss: 2417897.1794; val_kl_reg_loss: 19482.8816; val_edge_recon_loss: 712630.8012; val_cat_covariates_contrastive_loss: 100526.4110; val_gene_expr_recon_loss: 1618483.1110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6172.7129; val_global_loss: 2457295.9510; val_optim_loss: 2457295.9510
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9440; val_auprc_score: 0.9899; val_best_acc_score: 0.9390; val_best_f1_score: 0.9656; train_kl_reg_loss: 19618.9454; train_edge_recon_loss: 685847.0079; train_cat_covariates_contrastive_loss: 100311.3024; train_gene_expr_recon_loss: 1607379.5025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6174.4762; train_global_loss: 2419331.2364; train_optim_loss: 2419331.2364; val_kl_reg_loss: 19480.5913; val_edge_recon_loss: 704719.1416; val_cat_covariates_contrastive_loss: 100259.4272; val_gene_expr_recon_loss: 1617401.1503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6174.5225; val_global_loss: 2448034.8129; val_optim_loss: 2448034.8129

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9447; val_auprc_score: 0.9899; val_best_acc_score: 0.9388; val_best_f1_score: 0.9655; train_kl_reg_loss: 19610.2567; train_edge_recon_loss: 686766.4410; train_cat_covariates_contrastive_loss: 100412.4728; train_gene_expr_recon_loss: 1607451.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6165.8366; train_global_loss: 2420406.3718; train_optim_loss: 2420406.3718; val_kl_reg_loss: 19484.4808; val_edge_recon_loss: 709508.1248; val_cat_covariates_contrastive_loss: 100503.2857; val_gene_expr_recon_loss: 1617881.6840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.8247; val_global_loss: 2453543.3199; val_optim_loss: 2453543.3199
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9433; val_auprc_score: 0.9896; val_best_acc_score: 0.9384; val_best_f1_score: 0.9652; train_kl_reg_loss: 19614.7087; train_edge_recon_loss: 684589.7929; train_cat_covariates_contrastive_loss: 100436.4360; train_gene_expr_recon_loss: 1607851.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6165.7590; train_global_loss: 2418657.9929; train_optim_loss: 2418657.9929; val_kl_reg_loss: 19480.9789; val_edge_recon_loss: 711152.0870; val_cat_covariates_contrastive_loss: 100396.5780; val_gene_expr_recon_loss: 1617946.4952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.7822; val_global_loss: 2455141.8942; val_optim_loss: 2455141.8942
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9443; val_auprc_score: 0.9899; val_best_acc_score: 0.9385; val_best_f1_score: 0.9653; train_kl_reg_loss: 19609.9240; train_edge_recon_loss: 686650.1492; train_cat_covariates_contrastive_loss: 100432.0752; train_gene_expr_recon_loss: 1607730.6277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6165.6842; train_global_loss: 2420588.4745; train_optim_loss: 2420588.4745; val_kl_reg_loss: 19486.8919; val_edge_recon_loss: 705965.1643; val_cat_covariates_contrastive_loss: 100554.0284; val_gene_expr_recon_loss: 1618251.7906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.4805; val_global_loss: 2450423.3715; val_optim_loss: 2450423.3715
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9435; val_auprc_score: 0.9897; val_best_acc_score: 0.9386; val_best_f1_score: 0.9654; train_kl_reg_loss: 19614.3556; train_edge_recon_loss: 686011.3449; train_cat_covariates_contrastive_loss: 100420.9642; train_gene_expr_recon_loss: 1607151.8920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6165.5714; train_global_loss: 2419364.1034; train_optim_loss: 2419364.1034; val_kl_reg_loss: 19480.5668; val_edge_recon_loss: 708935.9104; val_cat_covariates_contrastive_loss: 100395.4027; val_gene_expr_recon_loss: 1618585.0245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6165.4780; val_global_loss: 2453562.4091; val_optim_loss: 2453562.4091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1198 min 50 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9267
val AUPRC score: 0.9832
val best accuracy score: 0.9357
val best F1 score: 0.9638
val target rna MSE score: 0.4823
val source rna MSE score: 0.1285
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0510
Val cat covariate2 mean sim diff: 0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
