[True]
Run timestamp: 10102023_125614_271.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_271']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6517; val_auprc_score: 0.6409; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 55465.1336; train_edge_recon_loss: 749735.6297; train_gene_expr_recon_loss: 23248670.4848; train_masked_gp_l1_reg_loss: 61960.3860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6082843.7273; train_chrom_access_recon_loss: 11558181.4697; train_global_loss: 41756856.9091; train_optim_loss: 41756856.9091; val_kl_reg_loss: 56473.0112; val_edge_recon_loss: 813167.2344; val_gene_expr_recon_loss: 21695616.5000; val_masked_gp_l1_reg_loss: 73093.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3403383.7500; val_chrom_access_recon_loss: 10949371.8750; val_global_loss: 36991107.0000; val_optim_loss: 36991107.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7022; val_auprc_score: 0.6784; val_best_acc_score: 0.5809; val_best_f1_score: 0.6970; train_kl_reg_loss: 73700.6011; train_edge_recon_loss: 752278.9735; train_gene_expr_recon_loss: 21441163.7879; train_masked_gp_l1_reg_loss: 74954.9184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1884089.4309; train_chrom_access_recon_loss: 11068796.8182; train_global_loss: 35294984.5455; train_optim_loss: 35294984.5455; val_kl_reg_loss: 74297.6094; val_edge_recon_loss: 812139.0625; val_gene_expr_recon_loss: 21189459.7500; val_masked_gp_l1_reg_loss: 74603.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 931177.7500; val_chrom_access_recon_loss: 10843438.1250; val_global_loss: 33925117.2500; val_optim_loss: 33925117.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7061; val_auprc_score: 0.6855; val_best_acc_score: 0.6193; val_best_f1_score: 0.7014; train_kl_reg_loss: 73141.6863; train_edge_recon_loss: 741060.3362; train_gene_expr_recon_loss: 21089880.5758; train_masked_gp_l1_reg_loss: 74923.3365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 631807.1217; train_chrom_access_recon_loss: 10967222.5303; train_global_loss: 33578035.4242; train_optim_loss: 33578035.4242; val_kl_reg_loss: 72110.2080; val_edge_recon_loss: 811154.7969; val_gene_expr_recon_loss: 20961583.2500; val_masked_gp_l1_reg_loss: 75276.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 434141.5938; val_chrom_access_recon_loss: 10755429.6250; val_global_loss: 33109695.7500; val_optim_loss: 33109695.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7846; val_auprc_score: 0.7637; val_best_acc_score: 0.7160; val_best_f1_score: 0.7212; train_kl_reg_loss: 69723.0182; train_edge_recon_loss: 734239.6042; train_gene_expr_recon_loss: 20898048.9394; train_masked_gp_l1_reg_loss: 75489.3984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 342544.8556; train_chrom_access_recon_loss: 10893158.9697; train_global_loss: 33013204.6667; train_optim_loss: 33013204.6667; val_kl_reg_loss: 65783.4292; val_edge_recon_loss: 806759.5938; val_gene_expr_recon_loss: 20887669.2500; val_masked_gp_l1_reg_loss: 75559.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 276610.7188; val_chrom_access_recon_loss: 10755053.2500; val_global_loss: 32867435.7500; val_optim_loss: 32867435.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8491; val_auprc_score: 0.8186; val_best_acc_score: 0.7077; val_best_f1_score: 0.7636; train_kl_reg_loss: 65669.7702; train_edge_recon_loss: 729143.7121; train_gene_expr_recon_loss: 20759808.9697; train_masked_gp_l1_reg_loss: 76030.4794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240802.5817; train_chrom_access_recon_loss: 10830962.3939; train_global_loss: 32702418.0000; train_optim_loss: 32702418.0000; val_kl_reg_loss: 62785.9590; val_edge_recon_loss: 796632.2109; val_gene_expr_recon_loss: 20586253.5000; val_masked_gp_l1_reg_loss: 76243.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213176.3906; val_chrom_access_recon_loss: 10614312.3750; val_global_loss: 32349404.2500; val_optim_loss: 32349404.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8750; val_auprc_score: 0.8448; val_best_acc_score: 0.8060; val_best_f1_score: 0.8168; train_kl_reg_loss: 62505.8121; train_edge_recon_loss: 720617.7992; train_gene_expr_recon_loss: 20616733.6667; train_masked_gp_l1_reg_loss: 76661.3825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197332.7536; train_chrom_access_recon_loss: 10759165.3939; train_global_loss: 32433016.9394; train_optim_loss: 32433016.9394; val_kl_reg_loss: 64845.1333; val_edge_recon_loss: 775548.7812; val_gene_expr_recon_loss: 20737882.5000; val_masked_gp_l1_reg_loss: 77017.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185116.9375; val_chrom_access_recon_loss: 10734818.1250; val_global_loss: 32575229.0000; val_optim_loss: 32575229.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8849; val_auprc_score: 0.8515; val_best_acc_score: 0.8100; val_best_f1_score: 0.8280; train_kl_reg_loss: 59363.1752; train_edge_recon_loss: 703340.5985; train_gene_expr_recon_loss: 20494293.1212; train_masked_gp_l1_reg_loss: 77454.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176526.7848; train_chrom_access_recon_loss: 10698288.4242; train_global_loss: 32209266.7879; train_optim_loss: 32209266.7879; val_kl_reg_loss: 58982.6572; val_edge_recon_loss: 707391.7812; val_gene_expr_recon_loss: 20382769.7500; val_masked_gp_l1_reg_loss: 78115.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169385.0938; val_chrom_access_recon_loss: 10570891.7500; val_global_loss: 31967538.2500; val_optim_loss: 31967538.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8978; val_auprc_score: 0.8725; val_best_acc_score: 0.8238; val_best_f1_score: 0.8360; train_kl_reg_loss: 66327.8336; train_edge_recon_loss: 656096.3561; train_gene_expr_recon_loss: 20393260.8485; train_masked_gp_l1_reg_loss: 78954.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162276.6761; train_chrom_access_recon_loss: 10662381.2424; train_global_loss: 32019297.0909; train_optim_loss: 32019297.0909; val_kl_reg_loss: 73834.3750; val_edge_recon_loss: 637870.5547; val_gene_expr_recon_loss: 20269259.7500; val_masked_gp_l1_reg_loss: 79984.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156698.6719; val_chrom_access_recon_loss: 10458135.5000; val_global_loss: 31675782.5000; val_optim_loss: 31675782.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8920; val_auprc_score: 0.8625; val_best_acc_score: 0.8213; val_best_f1_score: 0.8390; train_kl_reg_loss: 74258.6214; train_edge_recon_loss: 628508.7254; train_gene_expr_recon_loss: 20300741.2727; train_masked_gp_l1_reg_loss: 80717.2979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151701.8577; train_chrom_access_recon_loss: 10626134.8030; train_global_loss: 31862062.5455; train_optim_loss: 31862062.5455; val_kl_reg_loss: 75258.7891; val_edge_recon_loss: 627914.9688; val_gene_expr_recon_loss: 20319621.0000; val_masked_gp_l1_reg_loss: 81619.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146927.5312; val_chrom_access_recon_loss: 10437247.5000; val_global_loss: 31688590.5000; val_optim_loss: 31688590.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8970; val_auprc_score: 0.8651; val_best_acc_score: 0.8291; val_best_f1_score: 0.8410; train_kl_reg_loss: 74164.1971; train_edge_recon_loss: 623060.0814; train_gene_expr_recon_loss: 20207641.3333; train_masked_gp_l1_reg_loss: 82002.8042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142940.0405; train_chrom_access_recon_loss: 10577524.1970; train_global_loss: 31707332.7576; train_optim_loss: 31707332.7576; val_kl_reg_loss: 72297.7344; val_edge_recon_loss: 624457.4375; val_gene_expr_recon_loss: 20361080.0000; val_masked_gp_l1_reg_loss: 82594.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139302.6719; val_chrom_access_recon_loss: 10570789.0000; val_global_loss: 31850520.0000; val_optim_loss: 31850520.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9036; val_auprc_score: 0.8738; val_best_acc_score: 0.8364; val_best_f1_score: 0.8511; train_kl_reg_loss: 73559.5006; train_edge_recon_loss: 615387.2377; train_gene_expr_recon_loss: 20127349.0606; train_masked_gp_l1_reg_loss: 82935.0006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135211.4273; train_chrom_access_recon_loss: 10533687.6364; train_global_loss: 31568129.9394; train_optim_loss: 31568129.9394; val_kl_reg_loss: 74109.4316; val_edge_recon_loss: 617466.3750; val_gene_expr_recon_loss: 20191273.5000; val_masked_gp_l1_reg_loss: 83579.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132767.5781; val_chrom_access_recon_loss: 10385286.5000; val_global_loss: 31484484.0000; val_optim_loss: 31484484.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9058; val_auprc_score: 0.8769; val_best_acc_score: 0.8323; val_best_f1_score: 0.8491; train_kl_reg_loss: 72788.7151; train_edge_recon_loss: 613553.2367; train_gene_expr_recon_loss: 20053219.1818; train_masked_gp_l1_reg_loss: 83794.3178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129523.3232; train_chrom_access_recon_loss: 10504415.0606; train_global_loss: 31457294.0000; train_optim_loss: 31457294.0000; val_kl_reg_loss: 71857.3877; val_edge_recon_loss: 609945.3125; val_gene_expr_recon_loss: 20123093.7500; val_masked_gp_l1_reg_loss: 84073.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126527.0234; val_chrom_access_recon_loss: 10385373.0000; val_global_loss: 31400871.2500; val_optim_loss: 31400871.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9100; val_auprc_score: 0.8832; val_best_acc_score: 0.8391; val_best_f1_score: 0.8552; train_kl_reg_loss: 71523.6777; train_edge_recon_loss: 609059.3381; train_gene_expr_recon_loss: 19990437.3030; train_masked_gp_l1_reg_loss: 84450.2560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124713.6194; train_chrom_access_recon_loss: 10465630.4394; train_global_loss: 31345814.7273; train_optim_loss: 31345814.7273; val_kl_reg_loss: 69842.9849; val_edge_recon_loss: 612446.5391; val_gene_expr_recon_loss: 19963904.7500; val_masked_gp_l1_reg_loss: 84692.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122495.6797; val_chrom_access_recon_loss: 10292691.1250; val_global_loss: 31146073.0000; val_optim_loss: 31146073.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9135; val_auprc_score: 0.8881; val_best_acc_score: 0.8471; val_best_f1_score: 0.8593; train_kl_reg_loss: 70730.8679; train_edge_recon_loss: 607890.6837; train_gene_expr_recon_loss: 19932539.2727; train_masked_gp_l1_reg_loss: 85000.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120617.7193; train_chrom_access_recon_loss: 10449463.0303; train_global_loss: 31266242.2121; train_optim_loss: 31266242.2121; val_kl_reg_loss: 70136.4424; val_edge_recon_loss: 603527.2891; val_gene_expr_recon_loss: 20003424.5000; val_masked_gp_l1_reg_loss: 85290.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119455.2812; val_chrom_access_recon_loss: 10373393.0000; val_global_loss: 31255227.0000; val_optim_loss: 31255227.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9089; val_auprc_score: 0.8800; val_best_acc_score: 0.8450; val_best_f1_score: 0.8570; train_kl_reg_loss: 70084.0011; train_edge_recon_loss: 605498.1648; train_gene_expr_recon_loss: 19860867.6970; train_masked_gp_l1_reg_loss: 85524.0270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118289.4131; train_chrom_access_recon_loss: 10389959.2121; train_global_loss: 31130222.6364; train_optim_loss: 31130222.6364; val_kl_reg_loss: 69938.1084; val_edge_recon_loss: 608929.9531; val_gene_expr_recon_loss: 19678798.7500; val_masked_gp_l1_reg_loss: 85899.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117475.8672; val_chrom_access_recon_loss: 10270890.5000; val_global_loss: 30831933.0000; val_optim_loss: 30831933.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9165; val_auprc_score: 0.8923; val_best_acc_score: 0.8528; val_best_f1_score: 0.8659; train_kl_reg_loss: 69554.1317; train_edge_recon_loss: 600001.1051; train_gene_expr_recon_loss: 19801036.4848; train_masked_gp_l1_reg_loss: 86049.1164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116522.4680; train_chrom_access_recon_loss: 10365846.2879; train_global_loss: 31039009.4848; train_optim_loss: 31039009.4848; val_kl_reg_loss: 70171.7578; val_edge_recon_loss: 611671.1406; val_gene_expr_recon_loss: 19738718.5000; val_masked_gp_l1_reg_loss: 86253.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115503.5547; val_chrom_access_recon_loss: 10231831.8750; val_global_loss: 30854152.0000; val_optim_loss: 30854152.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9318; val_auprc_score: 0.9162; val_best_acc_score: 0.8659; val_best_f1_score: 0.8749; train_kl_reg_loss: 68563.6697; train_edge_recon_loss: 602395.0246; train_gene_expr_recon_loss: 19748945.9394; train_masked_gp_l1_reg_loss: 86458.3002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114717.4064; train_chrom_access_recon_loss: 10331294.1667; train_global_loss: 30952374.7273; train_optim_loss: 30952374.7273; val_kl_reg_loss: 67787.4541; val_edge_recon_loss: 599745.6953; val_gene_expr_recon_loss: 19916357.5000; val_masked_gp_l1_reg_loss: 86734.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114366.6719; val_chrom_access_recon_loss: 10396230.6250; val_global_loss: 31181221.2500; val_optim_loss: 31181221.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9278; val_auprc_score: 0.9108; val_best_acc_score: 0.8641; val_best_f1_score: 0.8714; train_kl_reg_loss: 67821.1822; train_edge_recon_loss: 600107.6136; train_gene_expr_recon_loss: 19694660.0909; train_masked_gp_l1_reg_loss: 86830.8954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113134.1855; train_chrom_access_recon_loss: 10306165.5455; train_global_loss: 30868719.4242; train_optim_loss: 30868719.4242; val_kl_reg_loss: 68310.7148; val_edge_recon_loss: 603064.1719; val_gene_expr_recon_loss: 19600100.5000; val_masked_gp_l1_reg_loss: 87087.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113284.7891; val_chrom_access_recon_loss: 10222342.7500; val_global_loss: 30694190.5000; val_optim_loss: 30694190.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9304; val_auprc_score: 0.9064; val_best_acc_score: 0.8686; val_best_f1_score: 0.8755; train_kl_reg_loss: 67486.8927; train_edge_recon_loss: 597065.7443; train_gene_expr_recon_loss: 19658708.0000; train_masked_gp_l1_reg_loss: 87317.0523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112176.9414; train_chrom_access_recon_loss: 10272267.3030; train_global_loss: 30795021.9091; train_optim_loss: 30795021.9091; val_kl_reg_loss: 66486.5615; val_edge_recon_loss: 603108.3672; val_gene_expr_recon_loss: 19713643.2500; val_masked_gp_l1_reg_loss: 87553.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111651.7109; val_chrom_access_recon_loss: 10169300.6250; val_global_loss: 30751744.7500; val_optim_loss: 30751744.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9374; val_auprc_score: 0.9167; val_best_acc_score: 0.8732; val_best_f1_score: 0.8805; train_kl_reg_loss: 66865.5336; train_edge_recon_loss: 594957.9716; train_gene_expr_recon_loss: 19604857.3939; train_masked_gp_l1_reg_loss: 87712.5051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110434.8969; train_chrom_access_recon_loss: 10237849.3939; train_global_loss: 30702678.0303; train_optim_loss: 30702678.0303; val_kl_reg_loss: 68317.0869; val_edge_recon_loss: 598242.9453; val_gene_expr_recon_loss: 19810614.7500; val_masked_gp_l1_reg_loss: 87907.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110462.9141; val_chrom_access_recon_loss: 10206532.5000; val_global_loss: 30882077.2500; val_optim_loss: 30882077.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9289; val_auprc_score: 0.9075; val_best_acc_score: 0.8614; val_best_f1_score: 0.8728; train_kl_reg_loss: 66712.1616; train_edge_recon_loss: 591803.3295; train_gene_expr_recon_loss: 19557732.0303; train_masked_gp_l1_reg_loss: 88113.1368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109230.9057; train_chrom_access_recon_loss: 10213443.4394; train_global_loss: 30627034.9697; train_optim_loss: 30627034.9697; val_kl_reg_loss: 66985.2764; val_edge_recon_loss: 602177.9219; val_gene_expr_recon_loss: 19659849.2500; val_masked_gp_l1_reg_loss: 88398.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108548.4375; val_chrom_access_recon_loss: 10162705.8750; val_global_loss: 30688664.0000; val_optim_loss: 30688664.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9385; val_auprc_score: 0.9079; val_best_acc_score: 0.8804; val_best_f1_score: 0.8882; train_kl_reg_loss: 65619.8617; train_edge_recon_loss: 595030.5331; train_gene_expr_recon_loss: 19531500.3636; train_masked_gp_l1_reg_loss: 88533.1914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107599.1486; train_chrom_access_recon_loss: 10186991.3485; train_global_loss: 30575274.6364; train_optim_loss: 30575274.6364; val_kl_reg_loss: 66800.3926; val_edge_recon_loss: 591069.5312; val_gene_expr_recon_loss: 19510761.7500; val_masked_gp_l1_reg_loss: 88790.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107540.7266; val_chrom_access_recon_loss: 10018169.2500; val_global_loss: 30383131.2500; val_optim_loss: 30383131.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9424; val_auprc_score: 0.9211; val_best_acc_score: 0.8794; val_best_f1_score: 0.8839; train_kl_reg_loss: 65398.0661; train_edge_recon_loss: 593196.6951; train_gene_expr_recon_loss: 19480580.9394; train_masked_gp_l1_reg_loss: 88930.2307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106718.3469; train_chrom_access_recon_loss: 10153150.9848; train_global_loss: 30487975.1515; train_optim_loss: 30487975.1515; val_kl_reg_loss: 64751.4199; val_edge_recon_loss: 598191.5312; val_gene_expr_recon_loss: 19695926.2500; val_masked_gp_l1_reg_loss: 89049.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106194.9375; val_chrom_access_recon_loss: 10134699.0000; val_global_loss: 30688812.5000; val_optim_loss: 30688812.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9403; val_auprc_score: 0.9198; val_best_acc_score: 0.8780; val_best_f1_score: 0.8845; train_kl_reg_loss: 64985.8148; train_edge_recon_loss: 590141.6913; train_gene_expr_recon_loss: 19453813.4545; train_masked_gp_l1_reg_loss: 89347.7533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105569.7365; train_chrom_access_recon_loss: 10118644.3485; train_global_loss: 30422502.6667; train_optim_loss: 30422502.6667; val_kl_reg_loss: 64627.9863; val_edge_recon_loss: 595677.6641; val_gene_expr_recon_loss: 19678938.7500; val_masked_gp_l1_reg_loss: 89470.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105174.3047; val_chrom_access_recon_loss: 10166424.0000; val_global_loss: 30700312.2500; val_optim_loss: 30700312.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9457; val_auprc_score: 0.9276; val_best_acc_score: 0.8829; val_best_f1_score: 0.8882; train_kl_reg_loss: 64536.6145; train_edge_recon_loss: 591170.0180; train_gene_expr_recon_loss: 19409327.5455; train_masked_gp_l1_reg_loss: 89619.5206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104543.9180; train_chrom_access_recon_loss: 10090357.5606; train_global_loss: 30349555.1212; train_optim_loss: 30349555.1212; val_kl_reg_loss: 64783.9297; val_edge_recon_loss: 594912.3828; val_gene_expr_recon_loss: 19436253.0000; val_masked_gp_l1_reg_loss: 89927.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104002.0547; val_chrom_access_recon_loss: 10017757.6250; val_global_loss: 30307636.5000; val_optim_loss: 30307636.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8819; val_auprc_score: 0.8445; val_best_acc_score: 0.8143; val_best_f1_score: 0.8314; train_kl_reg_loss: 44234.8424; train_edge_recon_loss: 724419.1761; train_gene_expr_recon_loss: 18361426.1515; train_masked_gp_l1_reg_loss: 90516.5898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111508.8585; train_chrom_access_recon_loss: 9584133.6970; train_global_loss: 28916239.3333; train_optim_loss: 28916239.3333; val_kl_reg_loss: 37039.9307; val_edge_recon_loss: 781106.5312; val_gene_expr_recon_loss: 18183987.2500; val_masked_gp_l1_reg_loss: 92026.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129877.7188; val_chrom_access_recon_loss: 9356983.3750; val_global_loss: 28581020.7500; val_optim_loss: 28581020.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8758; val_auprc_score: 0.8390; val_best_acc_score: 0.8082; val_best_f1_score: 0.8324; train_kl_reg_loss: 24997.4754; train_edge_recon_loss: 749435.0492; train_gene_expr_recon_loss: 18107102.5152; train_masked_gp_l1_reg_loss: 91839.1063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130565.9966; train_chrom_access_recon_loss: 9456687.0455; train_global_loss: 28560627.1212; train_optim_loss: 28560627.1212; val_kl_reg_loss: 19548.0994; val_edge_recon_loss: 764459.3984; val_gene_expr_recon_loss: 18075642.7500; val_masked_gp_l1_reg_loss: 91503.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129698.7188; val_chrom_access_recon_loss: 9334963.2500; val_global_loss: 28415815.7500; val_optim_loss: 28415815.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8702; val_auprc_score: 0.8316; val_best_acc_score: 0.8047; val_best_f1_score: 0.8275; train_kl_reg_loss: 19366.3452; train_edge_recon_loss: 739803.2386; train_gene_expr_recon_loss: 18086606.2727; train_masked_gp_l1_reg_loss: 91696.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132804.4878; train_chrom_access_recon_loss: 9453703.1212; train_global_loss: 28523980.2727; train_optim_loss: 28523980.2727; val_kl_reg_loss: 17936.4241; val_edge_recon_loss: 758024.1406; val_gene_expr_recon_loss: 18110924.5000; val_masked_gp_l1_reg_loss: 91009.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133644.2031; val_chrom_access_recon_loss: 9387247.8750; val_global_loss: 28498786.5000; val_optim_loss: 28498786.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8786; val_auprc_score: 0.8510; val_best_acc_score: 0.8092; val_best_f1_score: 0.8296; train_kl_reg_loss: 22271.1375; train_edge_recon_loss: 719289.7481; train_gene_expr_recon_loss: 17983550.3333; train_masked_gp_l1_reg_loss: 89397.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133333.1089; train_chrom_access_recon_loss: 9424342.3333; train_global_loss: 28372183.6970; train_optim_loss: 28372183.6970; val_kl_reg_loss: 17725.1377; val_edge_recon_loss: 736393.3516; val_gene_expr_recon_loss: 17928255.5000; val_masked_gp_l1_reg_loss: 87694.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131360.0000; val_chrom_access_recon_loss: 9275889.5000; val_global_loss: 28177317.2500; val_optim_loss: 28177317.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8638; val_auprc_score: 0.8215; val_best_acc_score: 0.8039; val_best_f1_score: 0.8288; train_kl_reg_loss: 23156.2473; train_edge_recon_loss: 701063.8125; train_gene_expr_recon_loss: 17913923.1818; train_masked_gp_l1_reg_loss: 86911.8820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130049.1007; train_chrom_access_recon_loss: 9387087.3788; train_global_loss: 28242191.6667; train_optim_loss: 28242191.6667; val_kl_reg_loss: 19212.8298; val_edge_recon_loss: 705369.1953; val_gene_expr_recon_loss: 18080628.0000; val_masked_gp_l1_reg_loss: 85612.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127601.4609; val_chrom_access_recon_loss: 9383768.0000; val_global_loss: 28402192.0000; val_optim_loss: 28402192.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8703; val_auprc_score: 0.8327; val_best_acc_score: 0.8127; val_best_f1_score: 0.8359; train_kl_reg_loss: 26301.3258; train_edge_recon_loss: 671118.0928; train_gene_expr_recon_loss: 17847650.4242; train_masked_gp_l1_reg_loss: 84638.4132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125116.1342; train_chrom_access_recon_loss: 9362320.4545; train_global_loss: 28117144.9091; train_optim_loss: 28117144.9091; val_kl_reg_loss: 21218.5654; val_edge_recon_loss: 664718.4375; val_gene_expr_recon_loss: 17871377.7500; val_masked_gp_l1_reg_loss: 83819.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122883.1875; val_chrom_access_recon_loss: 9177189.0000; val_global_loss: 27941207.0000; val_optim_loss: 27941207.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8681; val_auprc_score: 0.8281; val_best_acc_score: 0.8055; val_best_f1_score: 0.8310; train_kl_reg_loss: 29444.5200; train_edge_recon_loss: 643194.0066; train_gene_expr_recon_loss: 17815809.8182; train_masked_gp_l1_reg_loss: 83026.8481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120816.6884; train_chrom_access_recon_loss: 9345805.6818; train_global_loss: 28038097.4242; train_optim_loss: 28038097.4242; val_kl_reg_loss: 26174.4646; val_edge_recon_loss: 631817.6797; val_gene_expr_recon_loss: 17866387.2500; val_masked_gp_l1_reg_loss: 82330.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119795.0391; val_chrom_access_recon_loss: 9256171.8750; val_global_loss: 27982677.0000; val_optim_loss: 27982677.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8654; val_auprc_score: 0.8229; val_best_acc_score: 0.8009; val_best_f1_score: 0.8233; train_kl_reg_loss: 33846.8583; train_edge_recon_loss: 620465.6458; train_gene_expr_recon_loss: 17768690.3030; train_masked_gp_l1_reg_loss: 81627.2224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117492.9122; train_chrom_access_recon_loss: 9324677.5909; train_global_loss: 27946800.3333; train_optim_loss: 27946800.3333; val_kl_reg_loss: 30504.7256; val_edge_recon_loss: 619193.9531; val_gene_expr_recon_loss: 17842253.5000; val_masked_gp_l1_reg_loss: 80907.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115746.5703; val_chrom_access_recon_loss: 9215085.8750; val_global_loss: 27903692.2500; val_optim_loss: 27903692.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8654; val_auprc_score: 0.8261; val_best_acc_score: 0.8023; val_best_f1_score: 0.8260; train_kl_reg_loss: 37093.8249; train_edge_recon_loss: 611885.9309; train_gene_expr_recon_loss: 17763354.8939; train_masked_gp_l1_reg_loss: 80285.8067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114184.2763; train_chrom_access_recon_loss: 9324945.3636; train_global_loss: 27931750.0606; train_optim_loss: 27931750.0606; val_kl_reg_loss: 34899.6938; val_edge_recon_loss: 608714.8203; val_gene_expr_recon_loss: 17661238.2500; val_masked_gp_l1_reg_loss: 79709.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112756.9844; val_chrom_access_recon_loss: 9196124.2500; val_global_loss: 27693443.5000; val_optim_loss: 27693443.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8673; val_auprc_score: 0.8271; val_best_acc_score: 0.8028; val_best_f1_score: 0.8276; train_kl_reg_loss: 38856.8298; train_edge_recon_loss: 605358.6657; train_gene_expr_recon_loss: 17714645.6970; train_masked_gp_l1_reg_loss: 79075.5813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111593.4736; train_chrom_access_recon_loss: 9301977.3182; train_global_loss: 27851507.5455; train_optim_loss: 27851507.5455; val_kl_reg_loss: 36135.7026; val_edge_recon_loss: 611648.8984; val_gene_expr_recon_loss: 17686638.0000; val_masked_gp_l1_reg_loss: 78567.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110562.6094; val_chrom_access_recon_loss: 9142067.0000; val_global_loss: 27665619.5000; val_optim_loss: 27665619.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8691; val_auprc_score: 0.8388; val_best_acc_score: 0.8031; val_best_f1_score: 0.8279; train_kl_reg_loss: 39898.0752; train_edge_recon_loss: 601897.5057; train_gene_expr_recon_loss: 17687944.5152; train_masked_gp_l1_reg_loss: 77917.7728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109104.2204; train_chrom_access_recon_loss: 9272916.2273; train_global_loss: 27789678.3939; train_optim_loss: 27789678.3939; val_kl_reg_loss: 37042.1226; val_edge_recon_loss: 600294.9219; val_gene_expr_recon_loss: 17717506.7500; val_masked_gp_l1_reg_loss: 77338.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108007.5391; val_chrom_access_recon_loss: 9160636.3750; val_global_loss: 27700826.7500; val_optim_loss: 27700826.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8737; val_auprc_score: 0.8421; val_best_acc_score: 0.8036; val_best_f1_score: 0.8300; train_kl_reg_loss: 40764.5614; train_edge_recon_loss: 599679.5900; train_gene_expr_recon_loss: 17664298.2121; train_masked_gp_l1_reg_loss: 76764.3776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107020.2287; train_chrom_access_recon_loss: 9255618.6061; train_global_loss: 27744145.4545; train_optim_loss: 27744145.4545; val_kl_reg_loss: 37877.8921; val_edge_recon_loss: 599201.7969; val_gene_expr_recon_loss: 17609880.2500; val_masked_gp_l1_reg_loss: 76180.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106588.9141; val_chrom_access_recon_loss: 9108578.5000; val_global_loss: 27538306.5000; val_optim_loss: 27538306.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8724; val_auprc_score: 0.8428; val_best_acc_score: 0.7993; val_best_f1_score: 0.8223; train_kl_reg_loss: 40946.8721; train_edge_recon_loss: 596972.8191; train_gene_expr_recon_loss: 17666766.4242; train_masked_gp_l1_reg_loss: 75790.5249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105364.0807; train_chrom_access_recon_loss: 9264514.6212; train_global_loss: 27750355.3636; train_optim_loss: 27750355.3636; val_kl_reg_loss: 39231.3901; val_edge_recon_loss: 605255.8047; val_gene_expr_recon_loss: 17482976.3750; val_masked_gp_l1_reg_loss: 75389.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104585.8672; val_chrom_access_recon_loss: 9124083.2500; val_global_loss: 27431523.5000; val_optim_loss: 27431523.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8751; val_auprc_score: 0.8417; val_best_acc_score: 0.7955; val_best_f1_score: 0.8224; train_kl_reg_loss: 41656.7649; train_edge_recon_loss: 594855.4044; train_gene_expr_recon_loss: 17631650.0606; train_masked_gp_l1_reg_loss: 74983.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103744.7257; train_chrom_access_recon_loss: 9248463.2727; train_global_loss: 27695353.3030; train_optim_loss: 27695353.3030; val_kl_reg_loss: 38467.0791; val_edge_recon_loss: 604264.1250; val_gene_expr_recon_loss: 17675488.2500; val_masked_gp_l1_reg_loss: 74574.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103121.2969; val_chrom_access_recon_loss: 9173760.2500; val_global_loss: 27669676.0000; val_optim_loss: 27669676.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8847; val_auprc_score: 0.8494; val_best_acc_score: 0.8138; val_best_f1_score: 0.8334; train_kl_reg_loss: 41192.0600; train_edge_recon_loss: 598605.5814; train_gene_expr_recon_loss: 17625659.5152; train_masked_gp_l1_reg_loss: 74248.8723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102342.5292; train_chrom_access_recon_loss: 9245621.0455; train_global_loss: 27687669.6364; train_optim_loss: 27687669.6364; val_kl_reg_loss: 39617.3521; val_edge_recon_loss: 595428.8047; val_gene_expr_recon_loss: 17615535.0000; val_masked_gp_l1_reg_loss: 73996.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101860.0469; val_chrom_access_recon_loss: 9106505.2500; val_global_loss: 27532942.0000; val_optim_loss: 27532942.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8801; val_auprc_score: 0.8474; val_best_acc_score: 0.8122; val_best_f1_score: 0.8345; train_kl_reg_loss: 42148.9174; train_edge_recon_loss: 593161.7330; train_gene_expr_recon_loss: 17616230.6818; train_masked_gp_l1_reg_loss: 73618.6103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101232.5979; train_chrom_access_recon_loss: 9242369.7424; train_global_loss: 27668762.1515; train_optim_loss: 27668762.1515; val_kl_reg_loss: 40603.1567; val_edge_recon_loss: 595801.4219; val_gene_expr_recon_loss: 17619335.5000; val_masked_gp_l1_reg_loss: 73394.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100369.4375; val_chrom_access_recon_loss: 9152845.2500; val_global_loss: 27582349.7500; val_optim_loss: 27582349.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8861; val_auprc_score: 0.8615; val_best_acc_score: 0.8087; val_best_f1_score: 0.8320; train_kl_reg_loss: 42088.5153; train_edge_recon_loss: 594020.6600; train_gene_expr_recon_loss: 17570815.0000; train_masked_gp_l1_reg_loss: 73131.4142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100028.7029; train_chrom_access_recon_loss: 9213643.0303; train_global_loss: 27593727.1818; train_optim_loss: 27593727.1818; val_kl_reg_loss: 40851.7017; val_edge_recon_loss: 604071.8047; val_gene_expr_recon_loss: 17685617.7500; val_masked_gp_l1_reg_loss: 72893.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99760.7266; val_chrom_access_recon_loss: 9113488.2500; val_global_loss: 27616683.5000; val_optim_loss: 27616683.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8878; val_auprc_score: 0.8552; val_best_acc_score: 0.8119; val_best_f1_score: 0.8344; train_kl_reg_loss: 42964.9440; train_edge_recon_loss: 594437.9650; train_gene_expr_recon_loss: 17598156.2121; train_masked_gp_l1_reg_loss: 72297.3510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83426.2634; train_chrom_access_recon_loss: 9319466.8939; train_global_loss: 27710749.4848; train_optim_loss: 27710749.4848; val_kl_reg_loss: 42403.5654; val_edge_recon_loss: 592054.1953; val_gene_expr_recon_loss: 17755235.7500; val_masked_gp_l1_reg_loss: 71984.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78807.2344; val_chrom_access_recon_loss: 9236207.1250; val_global_loss: 27776692.7500; val_optim_loss: 27776692.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8860; val_auprc_score: 0.8587; val_best_acc_score: 0.8117; val_best_f1_score: 0.8327; train_kl_reg_loss: 43659.3046; train_edge_recon_loss: 592595.6629; train_gene_expr_recon_loss: 17559540.5758; train_masked_gp_l1_reg_loss: 71878.4257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77608.2178; train_chrom_access_recon_loss: 9217915.7121; train_global_loss: 27563198.0606; train_optim_loss: 27563198.0606; val_kl_reg_loss: 42512.9487; val_edge_recon_loss: 596435.3203; val_gene_expr_recon_loss: 17649932.7500; val_masked_gp_l1_reg_loss: 71803.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76788.2969; val_chrom_access_recon_loss: 9147197.0000; val_global_loss: 27584670.2500; val_optim_loss: 27584670.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8905; val_auprc_score: 0.8610; val_best_acc_score: 0.8165; val_best_f1_score: 0.8385; train_kl_reg_loss: 43714.6279; train_edge_recon_loss: 590803.3703; train_gene_expr_recon_loss: 17550059.8788; train_masked_gp_l1_reg_loss: 71740.1116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76287.0898; train_chrom_access_recon_loss: 9205051.1061; train_global_loss: 27537656.4242; train_optim_loss: 27537656.4242; val_kl_reg_loss: 42704.0381; val_edge_recon_loss: 590874.3125; val_gene_expr_recon_loss: 17626102.2500; val_masked_gp_l1_reg_loss: 71679.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75836.8203; val_chrom_access_recon_loss: 9149055.3750; val_global_loss: 27556252.5000; val_optim_loss: 27556252.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8870; val_auprc_score: 0.8627; val_best_acc_score: 0.8103; val_best_f1_score: 0.8327; train_kl_reg_loss: 43822.9136; train_edge_recon_loss: 592840.1222; train_gene_expr_recon_loss: 17553701.1515; train_masked_gp_l1_reg_loss: 71632.5265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75586.6435; train_chrom_access_recon_loss: 9207249.0152; train_global_loss: 27544832.3333; train_optim_loss: 27544832.3333; val_kl_reg_loss: 43316.5034; val_edge_recon_loss: 589898.7891; val_gene_expr_recon_loss: 17545226.0000; val_masked_gp_l1_reg_loss: 71586.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75323.8359; val_chrom_access_recon_loss: 9191968.1250; val_global_loss: 27517319.2500; val_optim_loss: 27517319.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 6 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.8710
val AUPRC score: 0.8368
val best accuracy score: 0.8012
val best F1 score: 0.8268
val target rna MSE score: 1.6655
val source rna MSE score: 0.9553
val target atac MSE score: 0.3252
val source atac MSE score: 0.1545
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
