[True]
Run timestamp: 07092023_051023_271.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_271']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19031 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21756, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8191; val_auprc_score: 0.8383; val_best_acc_score: 0.6068; val_best_f1_score: 0.7093; train_kl_reg_loss: 77229.3735; train_edge_recon_loss: 3584146.2462; train_gene_expr_recon_loss: 12841086.6565; train_masked_gp_l1_reg_loss: 32552.0229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3137077.1465; train_chrom_access_recon_loss: 42930303.9389; train_global_loss: 62602395.5115; train_optim_loss: 62602395.5115; val_kl_reg_loss: 123886.4250; val_edge_recon_loss: 4059575.5167; val_gene_expr_recon_loss: 11839749.6000; val_masked_gp_l1_reg_loss: 28657.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 283950.5625; val_chrom_access_recon_loss: 41121758.9333; val_global_loss: 57457578.9333; val_optim_loss: 57457578.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8786; val_auprc_score: 0.8766; val_best_acc_score: 0.7854; val_best_f1_score: 0.7987; train_kl_reg_loss: 110432.7897; train_edge_recon_loss: 3519251.6336; train_gene_expr_recon_loss: 11786526.3511; train_masked_gp_l1_reg_loss: 28037.8871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190932.6392; train_chrom_access_recon_loss: 41042337.7710; train_global_loss: 56677519.1145; train_optim_loss: 56677519.1145; val_kl_reg_loss: 84492.3000; val_edge_recon_loss: 3634768.0667; val_gene_expr_recon_loss: 11656611.0000; val_masked_gp_l1_reg_loss: 28799.6855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148328.6406; val_chrom_access_recon_loss: 40893961.6000; val_global_loss: 56446962.1333; val_optim_loss: 56446962.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8678; val_auprc_score: 0.8547; val_best_acc_score: 0.7859; val_best_f1_score: 0.8059; train_kl_reg_loss: 113032.5289; train_edge_recon_loss: 3085811.7939; train_gene_expr_recon_loss: 11601510.1069; train_masked_gp_l1_reg_loss: 30206.7462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132663.3071; train_chrom_access_recon_loss: 40499000.7634; train_global_loss: 55462225.2824; train_optim_loss: 55462225.2824; val_kl_reg_loss: 119485.1620; val_edge_recon_loss: 2990668.5000; val_gene_expr_recon_loss: 11502624.7333; val_masked_gp_l1_reg_loss: 31404.3340; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120472.3594; val_chrom_access_recon_loss: 40455642.6667; val_global_loss: 55220297.3333; val_optim_loss: 55220297.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8855; val_auprc_score: 0.8694; val_best_acc_score: 0.8058; val_best_f1_score: 0.8265; train_kl_reg_loss: 120820.1172; train_edge_recon_loss: 2948037.5057; train_gene_expr_recon_loss: 11464862.5344; train_masked_gp_l1_reg_loss: 32498.6848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113624.5022; train_chrom_access_recon_loss: 40103257.2214; train_global_loss: 54783100.5496; train_optim_loss: 54783100.5496; val_kl_reg_loss: 116002.1958; val_edge_recon_loss: 2921553.1167; val_gene_expr_recon_loss: 11403728.8000; val_masked_gp_l1_reg_loss: 33536.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108359.7891; val_chrom_access_recon_loss: 40127625.0667; val_global_loss: 54710805.6000; val_optim_loss: 54710805.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8848; val_auprc_score: 0.8677; val_best_acc_score: 0.8084; val_best_f1_score: 0.8322; train_kl_reg_loss: 114143.6524; train_edge_recon_loss: 2890583.1279; train_gene_expr_recon_loss: 11346376.2595; train_masked_gp_l1_reg_loss: 34460.6010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105020.8062; train_chrom_access_recon_loss: 39736759.1145; train_global_loss: 54227343.5115; train_optim_loss: 54227343.5115; val_kl_reg_loss: 115551.8479; val_edge_recon_loss: 2891046.8167; val_gene_expr_recon_loss: 11249422.6667; val_masked_gp_l1_reg_loss: 35503.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102304.0078; val_chrom_access_recon_loss: 39899169.3333; val_global_loss: 54292997.8667; val_optim_loss: 54292997.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8984; val_auprc_score: 0.8818; val_best_acc_score: 0.8131; val_best_f1_score: 0.8337; train_kl_reg_loss: 112483.7710; train_edge_recon_loss: 2856271.9866; train_gene_expr_recon_loss: 11250981.4046; train_masked_gp_l1_reg_loss: 36227.2304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99368.9156; train_chrom_access_recon_loss: 39410050.4733; train_global_loss: 53765383.8168; train_optim_loss: 53765383.8168; val_kl_reg_loss: 111693.0109; val_edge_recon_loss: 2887723.4667; val_gene_expr_recon_loss: 11130859.7333; val_masked_gp_l1_reg_loss: 36982.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97466.6484; val_chrom_access_recon_loss: 39218756.8000; val_global_loss: 53483482.6667; val_optim_loss: 53483482.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9227; val_auprc_score: 0.9078; val_best_acc_score: 0.8477; val_best_f1_score: 0.8580; train_kl_reg_loss: 109438.8030; train_edge_recon_loss: 2827405.7061; train_gene_expr_recon_loss: 11176423.1908; train_masked_gp_l1_reg_loss: 37799.0322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95415.6172; train_chrom_access_recon_loss: 39186533.7710; train_global_loss: 53433016.2443; train_optim_loss: 53433016.2443; val_kl_reg_loss: 104487.2760; val_edge_recon_loss: 2819346.0833; val_gene_expr_recon_loss: 11068174.3333; val_masked_gp_l1_reg_loss: 38695.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94140.7578; val_chrom_access_recon_loss: 39060629.0667; val_global_loss: 53185473.3333; val_optim_loss: 53185473.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9326; val_auprc_score: 0.9140; val_best_acc_score: 0.8684; val_best_f1_score: 0.8765; train_kl_reg_loss: 106218.8846; train_edge_recon_loss: 2796455.0057; train_gene_expr_recon_loss: 11090796.8397; train_masked_gp_l1_reg_loss: 39339.3852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92703.8000; train_chrom_access_recon_loss: 38884092.7023; train_global_loss: 53009606.6565; train_optim_loss: 53009606.6565; val_kl_reg_loss: 108459.1922; val_edge_recon_loss: 2774143.1833; val_gene_expr_recon_loss: 11012488.2667; val_masked_gp_l1_reg_loss: 40011.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91437.3359; val_chrom_access_recon_loss: 38883765.0667; val_global_loss: 52910303.7333; val_optim_loss: 52910303.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9346; val_auprc_score: 0.9183; val_best_acc_score: 0.8701; val_best_f1_score: 0.8787; train_kl_reg_loss: 106088.3509; train_edge_recon_loss: 2781292.5172; train_gene_expr_recon_loss: 11018154.0458; train_masked_gp_l1_reg_loss: 40767.2797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90536.6834; train_chrom_access_recon_loss: 38586952.6718; train_global_loss: 52623791.7252; train_optim_loss: 52623791.7252; val_kl_reg_loss: 104564.5281; val_edge_recon_loss: 2784659.5167; val_gene_expr_recon_loss: 10888863.3333; val_masked_gp_l1_reg_loss: 41465.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89736.7969; val_chrom_access_recon_loss: 38378532.8000; val_global_loss: 52287821.8667; val_optim_loss: 52287821.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9457; val_auprc_score: 0.9286; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 104205.1654; train_edge_recon_loss: 2759532.8531; train_gene_expr_recon_loss: 10960093.1756; train_masked_gp_l1_reg_loss: 42063.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88860.0670; train_chrom_access_recon_loss: 38334957.9542; train_global_loss: 52289712.8244; train_optim_loss: 52289712.8244; val_kl_reg_loss: 105051.6089; val_edge_recon_loss: 2755344.1167; val_gene_expr_recon_loss: 10876925.4667; val_masked_gp_l1_reg_loss: 42728.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88178.5234; val_chrom_access_recon_loss: 38447914.6667; val_global_loss: 52316143.4667; val_optim_loss: 52316143.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9436; val_auprc_score: 0.9289; val_best_acc_score: 0.8779; val_best_f1_score: 0.8860; train_kl_reg_loss: 101172.0246; train_edge_recon_loss: 2751998.9103; train_gene_expr_recon_loss: 10891191.8321; train_masked_gp_l1_reg_loss: 43403.0810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87679.9221; train_chrom_access_recon_loss: 38057884.0611; train_global_loss: 51933329.8626; train_optim_loss: 51933329.8626; val_kl_reg_loss: 102457.2932; val_edge_recon_loss: 2773799.1167; val_gene_expr_recon_loss: 10816613.4667; val_masked_gp_l1_reg_loss: 44041.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87132.5703; val_chrom_access_recon_loss: 38029419.2000; val_global_loss: 51853462.9333; val_optim_loss: 51853462.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9444; val_auprc_score: 0.9301; val_best_acc_score: 0.8818; val_best_f1_score: 0.8900; train_kl_reg_loss: 100625.9305; train_edge_recon_loss: 2736430.0553; train_gene_expr_recon_loss: 10850241.0840; train_masked_gp_l1_reg_loss: 44475.2113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86689.4600; train_chrom_access_recon_loss: 37878147.9389; train_global_loss: 51696609.7710; train_optim_loss: 51696609.7710; val_kl_reg_loss: 100007.5229; val_edge_recon_loss: 2761663.2333; val_gene_expr_recon_loss: 10760771.8000; val_masked_gp_l1_reg_loss: 44989.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86409.1953; val_chrom_access_recon_loss: 37919484.2667; val_global_loss: 51673325.0667; val_optim_loss: 51673325.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9528; val_auprc_score: 0.9420; val_best_acc_score: 0.8919; val_best_f1_score: 0.8981; train_kl_reg_loss: 98003.0645; train_edge_recon_loss: 2741647.7500; train_gene_expr_recon_loss: 10803118.9771; train_masked_gp_l1_reg_loss: 45442.7909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85836.6022; train_chrom_access_recon_loss: 37639537.2214; train_global_loss: 51413586.2901; train_optim_loss: 51413586.2901; val_kl_reg_loss: 96282.4005; val_edge_recon_loss: 2741741.1000; val_gene_expr_recon_loss: 10760003.0000; val_masked_gp_l1_reg_loss: 45982.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85602.9219; val_chrom_access_recon_loss: 37771597.0667; val_global_loss: 51501208.5333; val_optim_loss: 51501208.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9591; val_auprc_score: 0.9494; val_best_acc_score: 0.9010; val_best_f1_score: 0.9052; train_kl_reg_loss: 95944.3581; train_edge_recon_loss: 2730977.4771; train_gene_expr_recon_loss: 10762812.9771; train_masked_gp_l1_reg_loss: 46435.6788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85587.9685; train_chrom_access_recon_loss: 37435198.5344; train_global_loss: 51156956.8855; train_optim_loss: 51156956.8855; val_kl_reg_loss: 97868.1755; val_edge_recon_loss: 2734668.9167; val_gene_expr_recon_loss: 10713010.6667; val_masked_gp_l1_reg_loss: 46831.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85250.0625; val_chrom_access_recon_loss: 37630227.7333; val_global_loss: 51307857.3333; val_optim_loss: 51307857.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9576; val_auprc_score: 0.9469; val_best_acc_score: 0.8980; val_best_f1_score: 0.9033; train_kl_reg_loss: 94266.4986; train_edge_recon_loss: 2727264.4790; train_gene_expr_recon_loss: 10727675.6565; train_masked_gp_l1_reg_loss: 47261.8488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85204.7037; train_chrom_access_recon_loss: 37241202.8397; train_global_loss: 50922876.0305; train_optim_loss: 50922876.0305; val_kl_reg_loss: 94330.8505; val_edge_recon_loss: 2753134.0833; val_gene_expr_recon_loss: 10668253.1333; val_masked_gp_l1_reg_loss: 47806.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84761.8672; val_chrom_access_recon_loss: 37550020.2667; val_global_loss: 51198306.6667; val_optim_loss: 51198306.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9660; val_auprc_score: 0.9565; val_best_acc_score: 0.9101; val_best_f1_score: 0.9135; train_kl_reg_loss: 93675.0328; train_edge_recon_loss: 2716557.6698; train_gene_expr_recon_loss: 10680834.5420; train_masked_gp_l1_reg_loss: 48126.6310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84892.9390; train_chrom_access_recon_loss: 36974592.4122; train_global_loss: 50598679.0840; train_optim_loss: 50598679.0840; val_kl_reg_loss: 95731.0437; val_edge_recon_loss: 2716815.3333; val_gene_expr_recon_loss: 10631835.9333; val_masked_gp_l1_reg_loss: 48555.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84959.3047; val_chrom_access_recon_loss: 37320101.0667; val_global_loss: 50897997.3333; val_optim_loss: 50897997.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9678; val_auprc_score: 0.9583; val_best_acc_score: 0.9122; val_best_f1_score: 0.9173; train_kl_reg_loss: 92189.9611; train_edge_recon_loss: 2717116.8416; train_gene_expr_recon_loss: 10656051.2824; train_masked_gp_l1_reg_loss: 48914.3099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84739.8009; train_chrom_access_recon_loss: 36848110.1679; train_global_loss: 50447122.0763; train_optim_loss: 50447122.0763; val_kl_reg_loss: 89826.4182; val_edge_recon_loss: 2725105.6833; val_gene_expr_recon_loss: 10558419.4000; val_masked_gp_l1_reg_loss: 49262.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84786.3438; val_chrom_access_recon_loss: 36819165.8667; val_global_loss: 50326566.4000; val_optim_loss: 50326566.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9700; val_auprc_score: 0.9582; val_best_acc_score: 0.9206; val_best_f1_score: 0.9233; train_kl_reg_loss: 91286.9662; train_edge_recon_loss: 2711031.2538; train_gene_expr_recon_loss: 10630052.2214; train_masked_gp_l1_reg_loss: 49587.8987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84652.0566; train_chrom_access_recon_loss: 36681554.8092; train_global_loss: 50248165.1908; train_optim_loss: 50248165.1908; val_kl_reg_loss: 90840.7505; val_edge_recon_loss: 2704301.6000; val_gene_expr_recon_loss: 10572605.8667; val_masked_gp_l1_reg_loss: 49893.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84841.1406; val_chrom_access_recon_loss: 36874472.8000; val_global_loss: 50376955.7333; val_optim_loss: 50376955.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9701; val_auprc_score: 0.9631; val_best_acc_score: 0.9179; val_best_f1_score: 0.9197; train_kl_reg_loss: 90393.7595; train_edge_recon_loss: 2709047.0649; train_gene_expr_recon_loss: 10608654.6336; train_masked_gp_l1_reg_loss: 50281.7914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84665.5199; train_chrom_access_recon_loss: 36509037.4351; train_global_loss: 50052080.3053; train_optim_loss: 50052080.3053; val_kl_reg_loss: 92677.1766; val_edge_recon_loss: 2724826.6667; val_gene_expr_recon_loss: 10571347.8000; val_masked_gp_l1_reg_loss: 50662.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84960.5625; val_chrom_access_recon_loss: 36957825.8667; val_global_loss: 50482301.6000; val_optim_loss: 50482301.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9724; val_auprc_score: 0.9637; val_best_acc_score: 0.9260; val_best_f1_score: 0.9287; train_kl_reg_loss: 89952.6951; train_edge_recon_loss: 2706547.6317; train_gene_expr_recon_loss: 10579810.0992; train_masked_gp_l1_reg_loss: 50918.8530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84813.5961; train_chrom_access_recon_loss: 36364830.0458; train_global_loss: 49876872.8244; train_optim_loss: 49876872.8244; val_kl_reg_loss: 89040.9818; val_edge_recon_loss: 2710224.2667; val_gene_expr_recon_loss: 10493453.7333; val_masked_gp_l1_reg_loss: 51202.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85319.0625; val_chrom_access_recon_loss: 36471617.3333; val_global_loss: 49900858.6667; val_optim_loss: 49900858.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9761; val_auprc_score: 0.9704; val_best_acc_score: 0.9247; val_best_f1_score: 0.9267; train_kl_reg_loss: 88757.7508; train_edge_recon_loss: 2703756.0401; train_gene_expr_recon_loss: 10554497.6107; train_masked_gp_l1_reg_loss: 51547.0531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84975.5750; train_chrom_access_recon_loss: 36200607.6336; train_global_loss: 49684141.9237; train_optim_loss: 49684141.9237; val_kl_reg_loss: 88054.4344; val_edge_recon_loss: 2720817.1333; val_gene_expr_recon_loss: 10510565.3333; val_masked_gp_l1_reg_loss: 51742.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85055.0859; val_chrom_access_recon_loss: 36571963.4667; val_global_loss: 50028198.6667; val_optim_loss: 50028198.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9786; val_auprc_score: 0.9716; val_best_acc_score: 0.9310; val_best_f1_score: 0.9325; train_kl_reg_loss: 89255.2835; train_edge_recon_loss: 2696629.5057; train_gene_expr_recon_loss: 10534123.5420; train_masked_gp_l1_reg_loss: 52040.2290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85111.4952; train_chrom_access_recon_loss: 36069257.7405; train_global_loss: 49526417.4656; train_optim_loss: 49526417.4656; val_kl_reg_loss: 88066.2797; val_edge_recon_loss: 2717763.9667; val_gene_expr_recon_loss: 10455952.0667; val_masked_gp_l1_reg_loss: 52324.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85167.8828; val_chrom_access_recon_loss: 36505202.9333; val_global_loss: 49904477.3333; val_optim_loss: 49904477.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9790; val_auprc_score: 0.9752; val_best_acc_score: 0.9299; val_best_f1_score: 0.9314; train_kl_reg_loss: 88716.5715; train_edge_recon_loss: 2701027.2347; train_gene_expr_recon_loss: 10519546.9771; train_masked_gp_l1_reg_loss: 52546.6857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85152.3025; train_chrom_access_recon_loss: 35974834.9618; train_global_loss: 49421824.7328; train_optim_loss: 49421824.7328; val_kl_reg_loss: 86439.1094; val_edge_recon_loss: 2710157.1333; val_gene_expr_recon_loss: 10472296.0000; val_masked_gp_l1_reg_loss: 52715.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85437.5938; val_chrom_access_recon_loss: 36362491.4667; val_global_loss: 49769536.5333; val_optim_loss: 49769536.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9814; val_auprc_score: 0.9779; val_best_acc_score: 0.9361; val_best_f1_score: 0.9381; train_kl_reg_loss: 89086.7591; train_edge_recon_loss: 2693427.8702; train_gene_expr_recon_loss: 10489874.5267; train_masked_gp_l1_reg_loss: 52967.1170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85245.0006; train_chrom_access_recon_loss: 35821287.2214; train_global_loss: 49231888.4580; train_optim_loss: 49231888.4580; val_kl_reg_loss: 88892.2714; val_edge_recon_loss: 2699161.2500; val_gene_expr_recon_loss: 10434128.9333; val_masked_gp_l1_reg_loss: 53234.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85404.6641; val_chrom_access_recon_loss: 36155673.0667; val_global_loss: 49516494.1333; val_optim_loss: 49516494.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9812; val_auprc_score: 0.9770; val_best_acc_score: 0.9386; val_best_f1_score: 0.9406; train_kl_reg_loss: 88142.1697; train_edge_recon_loss: 2694699.7748; train_gene_expr_recon_loss: 10486646.5267; train_masked_gp_l1_reg_loss: 53451.5494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85348.5623; train_chrom_access_recon_loss: 35753115.3588; train_global_loss: 49161404.1221; train_optim_loss: 49161404.1221; val_kl_reg_loss: 87290.8687; val_edge_recon_loss: 2714666.4833; val_gene_expr_recon_loss: 10403491.2667; val_masked_gp_l1_reg_loss: 53567.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85208.3750; val_chrom_access_recon_loss: 36205540.5333; val_global_loss: 49549764.5333; val_optim_loss: 49549764.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9813; val_auprc_score: 0.9751; val_best_acc_score: 0.9364; val_best_f1_score: 0.9382; train_kl_reg_loss: 90527.0867; train_edge_recon_loss: 2699031.8664; train_gene_expr_recon_loss: 10313357.3664; train_masked_gp_l1_reg_loss: 51540.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83867.4692; train_chrom_access_recon_loss: 35909715.7863; train_global_loss: 49148040.5191; train_optim_loss: 49148040.5191; val_kl_reg_loss: 68228.4917; val_edge_recon_loss: 2707660.8833; val_gene_expr_recon_loss: 10263968.3333; val_masked_gp_l1_reg_loss: 50737.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83998.0469; val_chrom_access_recon_loss: 35919336.8000; val_global_loss: 49093930.4000; val_optim_loss: 49093930.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9829; val_auprc_score: 0.9767; val_best_acc_score: 0.9421; val_best_f1_score: 0.9435; train_kl_reg_loss: 88648.0793; train_edge_recon_loss: 2699307.6622; train_gene_expr_recon_loss: 10278680.5725; train_masked_gp_l1_reg_loss: 50655.2691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83871.9046; train_chrom_access_recon_loss: 35733198.3969; train_global_loss: 48934361.9237; train_optim_loss: 48934361.9237; val_kl_reg_loss: 67506.4990; val_edge_recon_loss: 2693574.5667; val_gene_expr_recon_loss: 10239658.4667; val_masked_gp_l1_reg_loss: 50592.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83828.3828; val_chrom_access_recon_loss: 35907724.2667; val_global_loss: 49042884.8000; val_optim_loss: 49042884.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9810; val_auprc_score: 0.9737; val_best_acc_score: 0.9380; val_best_f1_score: 0.9397; train_kl_reg_loss: 87019.9166; train_edge_recon_loss: 2697956.6374; train_gene_expr_recon_loss: 10264338.3435; train_masked_gp_l1_reg_loss: 50549.6585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83891.0264; train_chrom_access_recon_loss: 35648140.0153; train_global_loss: 48831895.8473; train_optim_loss: 48831895.8473; val_kl_reg_loss: 68853.4896; val_edge_recon_loss: 2713466.6667; val_gene_expr_recon_loss: 10247164.3333; val_masked_gp_l1_reg_loss: 50569.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83624.0859; val_chrom_access_recon_loss: 35787558.9333; val_global_loss: 48951236.5333; val_optim_loss: 48951236.5333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9870; val_auprc_score: 0.9843; val_best_acc_score: 0.9469; val_best_f1_score: 0.9478; train_kl_reg_loss: 84644.6316; train_edge_recon_loss: 2686017.4676; train_gene_expr_recon_loss: 10238586.9771; train_masked_gp_l1_reg_loss: 50607.2764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83822.0484; train_chrom_access_recon_loss: 35538938.1527; train_global_loss: 48682616.5802; train_optim_loss: 48682616.5802; val_kl_reg_loss: 69708.0042; val_edge_recon_loss: 2686707.1167; val_gene_expr_recon_loss: 10210263.4000; val_masked_gp_l1_reg_loss: 50678.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84175.7578; val_chrom_access_recon_loss: 35742635.7333; val_global_loss: 48844168.5333; val_optim_loss: 48844168.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9820; val_auprc_score: 0.9763; val_best_acc_score: 0.9391; val_best_f1_score: 0.9409; train_kl_reg_loss: 83837.0141; train_edge_recon_loss: 2677070.9389; train_gene_expr_recon_loss: 10236610.7939; train_masked_gp_l1_reg_loss: 50719.5146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83831.6886; train_chrom_access_recon_loss: 35520838.0458; train_global_loss: 48652908.0916; train_optim_loss: 48652908.0916; val_kl_reg_loss: 70664.3229; val_edge_recon_loss: 2711632.1000; val_gene_expr_recon_loss: 10125937.7333; val_masked_gp_l1_reg_loss: 50723.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83728.3281; val_chrom_access_recon_loss: 35375501.8667; val_global_loss: 48418186.9333; val_optim_loss: 48418186.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9848; val_auprc_score: 0.9805; val_best_acc_score: 0.9512; val_best_f1_score: 0.9522; train_kl_reg_loss: 81819.1581; train_edge_recon_loss: 2677861.0382; train_gene_expr_recon_loss: 10217685.2519; train_masked_gp_l1_reg_loss: 50855.4759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83731.1333; train_chrom_access_recon_loss: 35431749.3435; train_global_loss: 48543701.4351; train_optim_loss: 48543701.4351; val_kl_reg_loss: 72983.8427; val_edge_recon_loss: 2694499.8000; val_gene_expr_recon_loss: 10180454.1333; val_masked_gp_l1_reg_loss: 50923.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83672.3125; val_chrom_access_recon_loss: 35382082.4000; val_global_loss: 48464616.5333; val_optim_loss: 48464616.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9861; val_auprc_score: 0.9832; val_best_acc_score: 0.9492; val_best_f1_score: 0.9506; train_kl_reg_loss: 80977.8366; train_edge_recon_loss: 2682399.1622; train_gene_expr_recon_loss: 10212888.8015; train_masked_gp_l1_reg_loss: 51011.9242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83735.5764; train_chrom_access_recon_loss: 35400518.6718; train_global_loss: 48511532.0305; train_optim_loss: 48511532.0305; val_kl_reg_loss: 71657.9839; val_edge_recon_loss: 2669662.1333; val_gene_expr_recon_loss: 10180789.0000; val_masked_gp_l1_reg_loss: 51066.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83489.5938; val_chrom_access_recon_loss: 35568848.8000; val_global_loss: 48625513.8667; val_optim_loss: 48625513.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9851; val_auprc_score: 0.9799; val_best_acc_score: 0.9491; val_best_f1_score: 0.9503; train_kl_reg_loss: 79908.4209; train_edge_recon_loss: 2667477.3454; train_gene_expr_recon_loss: 10198656.1145; train_masked_gp_l1_reg_loss: 51147.9490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83643.9934; train_chrom_access_recon_loss: 35339063.0687; train_global_loss: 48419896.8550; train_optim_loss: 48419896.8550; val_kl_reg_loss: 74219.3229; val_edge_recon_loss: 2691383.0667; val_gene_expr_recon_loss: 10171331.0000; val_masked_gp_l1_reg_loss: 51270.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83862.6719; val_chrom_access_recon_loss: 35458212.6667; val_global_loss: 48530279.2000; val_optim_loss: 48530279.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9858; val_auprc_score: 0.9808; val_best_acc_score: 0.9493; val_best_f1_score: 0.9504; train_kl_reg_loss: 79525.6570; train_edge_recon_loss: 2670936.0305; train_gene_expr_recon_loss: 10185065.6031; train_masked_gp_l1_reg_loss: 51338.6995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83588.0122; train_chrom_access_recon_loss: 35254469.5267; train_global_loss: 48324923.5420; train_optim_loss: 48324923.5420; val_kl_reg_loss: 72279.3229; val_edge_recon_loss: 2671159.0167; val_gene_expr_recon_loss: 10138028.4000; val_masked_gp_l1_reg_loss: 51375.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83561.6016; val_chrom_access_recon_loss: 35084397.8667; val_global_loss: 48100802.1333; val_optim_loss: 48100802.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9860; val_auprc_score: 0.9814; val_best_acc_score: 0.9500; val_best_f1_score: 0.9512; train_kl_reg_loss: 78651.3265; train_edge_recon_loss: 2671164.1546; train_gene_expr_recon_loss: 10176365.0687; train_masked_gp_l1_reg_loss: 51431.1729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83611.5295; train_chrom_access_recon_loss: 35215599.7863; train_global_loss: 48276822.8092; train_optim_loss: 48276822.8092; val_kl_reg_loss: 72661.1958; val_edge_recon_loss: 2684619.5667; val_gene_expr_recon_loss: 10143679.6000; val_masked_gp_l1_reg_loss: 51550.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83539.3906; val_chrom_access_recon_loss: 35183125.2000; val_global_loss: 48219175.7333; val_optim_loss: 48219175.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9874; val_auprc_score: 0.9839; val_best_acc_score: 0.9546; val_best_f1_score: 0.9557; train_kl_reg_loss: 78552.8680; train_edge_recon_loss: 2674982.1794; train_gene_expr_recon_loss: 10173922.8626; train_masked_gp_l1_reg_loss: 51625.8611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83620.4806; train_chrom_access_recon_loss: 35219150.7328; train_global_loss: 48281854.9618; train_optim_loss: 48281854.9618; val_kl_reg_loss: 73518.7714; val_edge_recon_loss: 2683697.1667; val_gene_expr_recon_loss: 10133922.8667; val_masked_gp_l1_reg_loss: 51683.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83554.9609; val_chrom_access_recon_loss: 35237820.5333; val_global_loss: 48264198.4000; val_optim_loss: 48264198.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9866; val_auprc_score: 0.9805; val_best_acc_score: 0.9520; val_best_f1_score: 0.9531; train_kl_reg_loss: 77398.3616; train_edge_recon_loss: 2663999.6584; train_gene_expr_recon_loss: 10161580.6183; train_masked_gp_l1_reg_loss: 51777.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83550.1907; train_chrom_access_recon_loss: 35155329.1145; train_global_loss: 48193635.7252; train_optim_loss: 48193635.7252; val_kl_reg_loss: 73393.2094; val_edge_recon_loss: 2678244.6000; val_gene_expr_recon_loss: 10125290.8667; val_masked_gp_l1_reg_loss: 51838.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83815.7188; val_chrom_access_recon_loss: 35353779.4667; val_global_loss: 48366362.6667; val_optim_loss: 48366362.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9874; val_auprc_score: 0.9831; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 76684.9287; train_edge_recon_loss: 2671342.2023; train_gene_expr_recon_loss: 10157478.6641; train_masked_gp_l1_reg_loss: 51950.1474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83730.3222; train_chrom_access_recon_loss: 35142592.2595; train_global_loss: 48183778.2595; train_optim_loss: 48183778.2595; val_kl_reg_loss: 72861.2854; val_edge_recon_loss: 2672355.4667; val_gene_expr_recon_loss: 10099768.2667; val_masked_gp_l1_reg_loss: 52022.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83423.9766; val_chrom_access_recon_loss: 35098868.0000; val_global_loss: 48079300.2667; val_optim_loss: 48079300.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9878; val_auprc_score: 0.9853; val_best_acc_score: 0.9538; val_best_f1_score: 0.9544; train_kl_reg_loss: 76987.0501; train_edge_recon_loss: 2669551.3912; train_gene_expr_recon_loss: 10144803.3817; train_masked_gp_l1_reg_loss: 52036.6232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83574.7629; train_chrom_access_recon_loss: 35063744.4885; train_global_loss: 48090697.7710; train_optim_loss: 48090697.7710; val_kl_reg_loss: 72368.8417; val_edge_recon_loss: 2677137.6000; val_gene_expr_recon_loss: 10101648.7333; val_masked_gp_l1_reg_loss: 52176.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83894.7344; val_chrom_access_recon_loss: 35093985.7333; val_global_loss: 48081212.5333; val_optim_loss: 48081212.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9880; val_auprc_score: 0.9840; val_best_acc_score: 0.9565; val_best_f1_score: 0.9573; train_kl_reg_loss: 76395.7498; train_edge_recon_loss: 2668708.2710; train_gene_expr_recon_loss: 10139715.4427; train_masked_gp_l1_reg_loss: 52235.5389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83711.8981; train_chrom_access_recon_loss: 35039972.1679; train_global_loss: 48060739.0229; train_optim_loss: 48060739.0229; val_kl_reg_loss: 72710.3474; val_edge_recon_loss: 2680228.0833; val_gene_expr_recon_loss: 10081282.0667; val_masked_gp_l1_reg_loss: 52288.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84020.5469; val_chrom_access_recon_loss: 35071297.8667; val_global_loss: 48041828.5333; val_optim_loss: 48041828.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9875; val_auprc_score: 0.9808; val_best_acc_score: 0.9576; val_best_f1_score: 0.9585; train_kl_reg_loss: 76467.2503; train_edge_recon_loss: 2666439.8721; train_gene_expr_recon_loss: 10128392.6412; train_masked_gp_l1_reg_loss: 52375.2618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83774.9945; train_chrom_access_recon_loss: 34984605.8779; train_global_loss: 47992055.7557; train_optim_loss: 47992055.7557; val_kl_reg_loss: 71890.4042; val_edge_recon_loss: 2664082.3667; val_gene_expr_recon_loss: 10082759.0000; val_masked_gp_l1_reg_loss: 52432.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83768.5625; val_chrom_access_recon_loss: 35105186.0000; val_global_loss: 48060118.6667; val_optim_loss: 48060118.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9890; val_auprc_score: 0.9861; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 75711.3439; train_edge_recon_loss: 2666428.9466; train_gene_expr_recon_loss: 10122993.2901; train_masked_gp_l1_reg_loss: 52464.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83878.0313; train_chrom_access_recon_loss: 34976617.9847; train_global_loss: 47978094.0153; train_optim_loss: 47978094.0153; val_kl_reg_loss: 73698.1375; val_edge_recon_loss: 2668761.6167; val_gene_expr_recon_loss: 10058720.4000; val_masked_gp_l1_reg_loss: 52527.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84018.9531; val_chrom_access_recon_loss: 35031801.0667; val_global_loss: 47969527.2000; val_optim_loss: 47969527.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9906; val_auprc_score: 0.9884; val_best_acc_score: 0.9620; val_best_f1_score: 0.9628; train_kl_reg_loss: 75041.8622; train_edge_recon_loss: 2664463.2634; train_gene_expr_recon_loss: 10113406.5496; train_masked_gp_l1_reg_loss: 52551.6994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83874.2701; train_chrom_access_recon_loss: 34951972.4885; train_global_loss: 47941310.0763; train_optim_loss: 47941310.0763; val_kl_reg_loss: 71892.7479; val_edge_recon_loss: 2664945.6333; val_gene_expr_recon_loss: 10101154.7333; val_masked_gp_l1_reg_loss: 52582.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83580.0078; val_chrom_access_recon_loss: 35115369.7333; val_global_loss: 48089525.6000; val_optim_loss: 48089525.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9900; val_auprc_score: 0.9863; val_best_acc_score: 0.9612; val_best_f1_score: 0.9621; train_kl_reg_loss: 74942.1911; train_edge_recon_loss: 2663186.0038; train_gene_expr_recon_loss: 10112150.8015; train_masked_gp_l1_reg_loss: 52623.3755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83758.0108; train_chrom_access_recon_loss: 34915122.2901; train_global_loss: 47901782.5954; train_optim_loss: 47901782.5954; val_kl_reg_loss: 73034.7578; val_edge_recon_loss: 2666053.7000; val_gene_expr_recon_loss: 10026843.8000; val_masked_gp_l1_reg_loss: 52713.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83548.6016; val_chrom_access_recon_loss: 34800506.1333; val_global_loss: 47702700.8000; val_optim_loss: 47702700.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9899; val_auprc_score: 0.9882; val_best_acc_score: 0.9578; val_best_f1_score: 0.9588; train_kl_reg_loss: 74601.6388; train_edge_recon_loss: 2662467.9809; train_gene_expr_recon_loss: 10102306.3511; train_masked_gp_l1_reg_loss: 52777.8485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83821.6958; train_chrom_access_recon_loss: 34903215.6794; train_global_loss: 47879191.3282; train_optim_loss: 47879191.3282; val_kl_reg_loss: 70981.6042; val_edge_recon_loss: 2678951.4167; val_gene_expr_recon_loss: 10060764.6667; val_masked_gp_l1_reg_loss: 52779.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84074.5469; val_chrom_access_recon_loss: 35037200.8000; val_global_loss: 47984753.8667; val_optim_loss: 47984753.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9896; val_auprc_score: 0.9855; val_best_acc_score: 0.9584; val_best_f1_score: 0.9593; train_kl_reg_loss: 74095.7436; train_edge_recon_loss: 2663970.6031; train_gene_expr_recon_loss: 10092318.3511; train_masked_gp_l1_reg_loss: 52811.3305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83842.4523; train_chrom_access_recon_loss: 34876332.1374; train_global_loss: 47843370.6870; train_optim_loss: 47843370.6870; val_kl_reg_loss: 69535.7063; val_edge_recon_loss: 2690207.3333; val_gene_expr_recon_loss: 10087409.2000; val_masked_gp_l1_reg_loss: 52901.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83849.2734; val_chrom_access_recon_loss: 35051987.4667; val_global_loss: 48035889.6000; val_optim_loss: 48035889.6000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9886; val_auprc_score: 0.9839; val_best_acc_score: 0.9598; val_best_f1_score: 0.9610; train_kl_reg_loss: 74112.9503; train_edge_recon_loss: 2664134.1469; train_gene_expr_recon_loss: 10085347.2824; train_masked_gp_l1_reg_loss: 52931.4228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83959.1579; train_chrom_access_recon_loss: 34848822.3664; train_global_loss: 47809307.1450; train_optim_loss: 47809307.1450; val_kl_reg_loss: 70628.5146; val_edge_recon_loss: 2670766.2333; val_gene_expr_recon_loss: 10080387.6000; val_masked_gp_l1_reg_loss: 52992.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83753.8438; val_chrom_access_recon_loss: 35068320.8000; val_global_loss: 48026849.3333; val_optim_loss: 48026849.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9884; val_auprc_score: 0.9849; val_best_acc_score: 0.9598; val_best_f1_score: 0.9608; train_kl_reg_loss: 74146.1299; train_edge_recon_loss: 2662960.7882; train_gene_expr_recon_loss: 10078427.7481; train_masked_gp_l1_reg_loss: 53016.0675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84065.2186; train_chrom_access_recon_loss: 34820844.5344; train_global_loss: 47773460.1527; train_optim_loss: 47773460.1527; val_kl_reg_loss: 70893.2651; val_edge_recon_loss: 2670064.7667; val_gene_expr_recon_loss: 10026251.8667; val_masked_gp_l1_reg_loss: 53076.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84303.2422; val_chrom_access_recon_loss: 34877885.6000; val_global_loss: 47782474.4000; val_optim_loss: 47782474.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9897; val_auprc_score: 0.9852; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 74436.4684; train_edge_recon_loss: 2657887.2958; train_gene_expr_recon_loss: 10066224.3969; train_masked_gp_l1_reg_loss: 52715.4646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65629.5445; train_chrom_access_recon_loss: 34794532.6718; train_global_loss: 47711425.7405; train_optim_loss: 47711425.7405; val_kl_reg_loss: 72254.1245; val_edge_recon_loss: 2675989.3000; val_gene_expr_recon_loss: 10027795.2000; val_masked_gp_l1_reg_loss: 52557.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63946.8281; val_chrom_access_recon_loss: 34877862.6667; val_global_loss: 47770405.8667; val_optim_loss: 47770405.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9891; val_auprc_score: 0.9847; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 75068.1473; train_edge_recon_loss: 2658303.5782; train_gene_expr_recon_loss: 10063258.6031; train_masked_gp_l1_reg_loss: 52495.7726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63729.1225; train_chrom_access_recon_loss: 34780320.8702; train_global_loss: 47693176.0000; train_optim_loss: 47693176.0000; val_kl_reg_loss: 72405.3354; val_edge_recon_loss: 2668677.1333; val_gene_expr_recon_loss: 10080970.4667; val_masked_gp_l1_reg_loss: 52449.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63594.7109; val_chrom_access_recon_loss: 35089073.8667; val_global_loss: 48027170.9333; val_optim_loss: 48027170.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9891; val_auprc_score: 0.9867; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 75420.3004; train_edge_recon_loss: 2658038.7958; train_gene_expr_recon_loss: 10062469.7176; train_masked_gp_l1_reg_loss: 52422.1237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63365.4305; train_chrom_access_recon_loss: 34779220.5802; train_global_loss: 47690937.0382; train_optim_loss: 47690937.0382; val_kl_reg_loss: 73171.4219; val_edge_recon_loss: 2674546.2000; val_gene_expr_recon_loss: 10063328.3333; val_masked_gp_l1_reg_loss: 52401.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63307.8359; val_chrom_access_recon_loss: 34946786.2667; val_global_loss: 47873541.6000; val_optim_loss: 47873541.6000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9896; val_auprc_score: 0.9849; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 75571.8107; train_edge_recon_loss: 2656202.0458; train_gene_expr_recon_loss: 10059880.6565; train_masked_gp_l1_reg_loss: 52388.0122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63145.4286; train_chrom_access_recon_loss: 34760942.3664; train_global_loss: 47668130.4122; train_optim_loss: 47668130.4122; val_kl_reg_loss: 73187.0953; val_edge_recon_loss: 2676175.7167; val_gene_expr_recon_loss: 10037299.9333; val_masked_gp_l1_reg_loss: 52378.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63053.5586; val_chrom_access_recon_loss: 34939478.9333; val_global_loss: 47841574.6667; val_optim_loss: 47841574.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 122 min 8 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9882
val AUPRC score: 0.9828
val best accuracy score: 0.9562
val best F1 score: 0.9574
val target rna MSE score: 1.3949
val source rna MSE score: 0.4805
val target atac MSE score: 0.1212
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
