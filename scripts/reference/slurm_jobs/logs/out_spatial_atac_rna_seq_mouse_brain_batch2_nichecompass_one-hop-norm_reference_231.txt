[True]
Run timestamp: 07092023_014232_231.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_231']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1131 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5649, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7563; val_auprc_score: 0.7793; val_best_acc_score: 0.5274; val_best_f1_score: 0.6771; train_kl_reg_loss: 71937.6082; train_edge_recon_loss: 3564912.7481; train_gene_expr_recon_loss: 16807829.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1161465.8077; train_chrom_access_recon_loss: 6606223.6870; train_global_loss: 28212369.0687; train_optim_loss: 28212369.0687; val_kl_reg_loss: 115483.7292; val_edge_recon_loss: 4063334.3667; val_gene_expr_recon_loss: 15773458.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 604278.6250; val_chrom_access_recon_loss: 6422891.9333; val_global_loss: 26979446.0000; val_optim_loss: 26979446.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7975; val_auprc_score: 0.8121; val_best_acc_score: 0.7105; val_best_f1_score: 0.7260; train_kl_reg_loss: 95204.2110; train_edge_recon_loss: 3517799.1622; train_gene_expr_recon_loss: 15553346.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 361365.4893; train_chrom_access_recon_loss: 6329487.9924; train_global_loss: 25857203.6947; train_optim_loss: 25857203.6947; val_kl_reg_loss: 78147.7203; val_edge_recon_loss: 4015867.5833; val_gene_expr_recon_loss: 15500132.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211827.0000; val_chrom_access_recon_loss: 6335075.0667; val_global_loss: 26141050.0000; val_optim_loss: 26141050.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8351; val_auprc_score: 0.8332; val_best_acc_score: 0.7354; val_best_f1_score: 0.7719; train_kl_reg_loss: 78614.6284; train_edge_recon_loss: 3369188.3989; train_gene_expr_recon_loss: 15328865.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154030.9258; train_chrom_access_recon_loss: 6251719.6641; train_global_loss: 25182419.5115; train_optim_loss: 25182419.5115; val_kl_reg_loss: 86894.9391; val_edge_recon_loss: 3141275.9333; val_gene_expr_recon_loss: 15321511.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115912.9844; val_chrom_access_recon_loss: 6239835.0000; val_global_loss: 24905429.3333; val_optim_loss: 24905429.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8670; val_auprc_score: 0.8604; val_best_acc_score: 0.7627; val_best_f1_score: 0.7917; train_kl_reg_loss: 101237.9829; train_edge_recon_loss: 3005916.5916; train_gene_expr_recon_loss: 15150094.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97176.7047; train_chrom_access_recon_loss: 6179439.3397; train_global_loss: 24533864.5191; train_optim_loss: 24533864.5191; val_kl_reg_loss: 96255.0891; val_edge_recon_loss: 2952827.8833; val_gene_expr_recon_loss: 15109515.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82389.2422; val_chrom_access_recon_loss: 6189378.5667; val_global_loss: 24430367.0667; val_optim_loss: 24430367.0667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8964; val_auprc_score: 0.8875; val_best_acc_score: 0.8030; val_best_f1_score: 0.8169; train_kl_reg_loss: 100801.8277; train_edge_recon_loss: 2936268.0897; train_gene_expr_recon_loss: 14978812.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73249.3825; train_chrom_access_recon_loss: 6116043.2252; train_global_loss: 24205174.5344; train_optim_loss: 24205174.5344; val_kl_reg_loss: 96794.4906; val_edge_recon_loss: 2923073.2667; val_gene_expr_recon_loss: 14980044.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66405.0234; val_chrom_access_recon_loss: 6121898.8000; val_global_loss: 24188217.0667; val_optim_loss: 24188217.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9123; val_auprc_score: 0.8968; val_best_acc_score: 0.8331; val_best_f1_score: 0.8451; train_kl_reg_loss: 88690.0496; train_edge_recon_loss: 2893409.7118; train_gene_expr_recon_loss: 14843923.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61964.2204; train_chrom_access_recon_loss: 6063404.8092; train_global_loss: 23951391.9237; train_optim_loss: 23951391.9237; val_kl_reg_loss: 85273.1969; val_edge_recon_loss: 2857762.2000; val_gene_expr_recon_loss: 14837397.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58283.1172; val_chrom_access_recon_loss: 6071322.5667; val_global_loss: 23910039.4667; val_optim_loss: 23910039.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9262; val_auprc_score: 0.9114; val_best_acc_score: 0.8569; val_best_f1_score: 0.8655; train_kl_reg_loss: 83216.9921; train_edge_recon_loss: 2848755.9695; train_gene_expr_recon_loss: 14724170.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55489.6384; train_chrom_access_recon_loss: 6011041.6069; train_global_loss: 23722674.5191; train_optim_loss: 23722674.5191; val_kl_reg_loss: 80527.5708; val_edge_recon_loss: 2842645.0167; val_gene_expr_recon_loss: 14749166.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53049.1445; val_chrom_access_recon_loss: 6014521.3667; val_global_loss: 23739910.6667; val_optim_loss: 23739910.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9345; val_auprc_score: 0.9210; val_best_acc_score: 0.8667; val_best_f1_score: 0.8748; train_kl_reg_loss: 83866.1211; train_edge_recon_loss: 2803687.3435; train_gene_expr_recon_loss: 14622314.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51177.2684; train_chrom_access_recon_loss: 5971591.7672; train_global_loss: 23532636.9466; train_optim_loss: 23532636.9466; val_kl_reg_loss: 91896.0781; val_edge_recon_loss: 2788992.4000; val_gene_expr_recon_loss: 14618738.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49759.4219; val_chrom_access_recon_loss: 5982066.1333; val_global_loss: 23531453.0667; val_optim_loss: 23531453.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9439; val_auprc_score: 0.9273; val_best_acc_score: 0.8818; val_best_f1_score: 0.8862; train_kl_reg_loss: 83909.7923; train_edge_recon_loss: 2774851.7805; train_gene_expr_recon_loss: 14529687.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48696.5923; train_chrom_access_recon_loss: 5931482.4084; train_global_loss: 23368628.2137; train_optim_loss: 23368628.2137; val_kl_reg_loss: 81148.4380; val_edge_recon_loss: 2766433.6167; val_gene_expr_recon_loss: 14543640.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48139.3359; val_chrom_access_recon_loss: 5945179.7333; val_global_loss: 23384542.6667; val_optim_loss: 23384542.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9459; val_auprc_score: 0.9306; val_best_acc_score: 0.8875; val_best_f1_score: 0.8918; train_kl_reg_loss: 82275.1961; train_edge_recon_loss: 2763258.3244; train_gene_expr_recon_loss: 14455036.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47015.8986; train_chrom_access_recon_loss: 5893004.0573; train_global_loss: 23240589.4046; train_optim_loss: 23240589.4046; val_kl_reg_loss: 78374.6099; val_edge_recon_loss: 2751320.9000; val_gene_expr_recon_loss: 14435437.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46030.8789; val_chrom_access_recon_loss: 5888901.4000; val_global_loss: 23200064.1333; val_optim_loss: 23200064.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9486; val_auprc_score: 0.9333; val_best_acc_score: 0.8899; val_best_f1_score: 0.8952; train_kl_reg_loss: 81322.6409; train_edge_recon_loss: 2743023.4943; train_gene_expr_recon_loss: 14379769.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45672.5441; train_chrom_access_recon_loss: 5863701.9656; train_global_loss: 23113490.5191; train_optim_loss: 23113490.5191; val_kl_reg_loss: 79844.2458; val_edge_recon_loss: 2742691.9500; val_gene_expr_recon_loss: 14413482.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45467.7109; val_chrom_access_recon_loss: 5892611.0000; val_global_loss: 23174098.2667; val_optim_loss: 23174098.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9480; val_auprc_score: 0.9355; val_best_acc_score: 0.8925; val_best_f1_score: 0.8981; train_kl_reg_loss: 79080.6469; train_edge_recon_loss: 2733830.4065; train_gene_expr_recon_loss: 14305170.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44666.9192; train_chrom_access_recon_loss: 5828567.8817; train_global_loss: 22991316.2901; train_optim_loss: 22991316.2901; val_kl_reg_loss: 76562.0385; val_edge_recon_loss: 2743558.8000; val_gene_expr_recon_loss: 14324728.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44584.8281; val_chrom_access_recon_loss: 5824507.1000; val_global_loss: 23013940.5333; val_optim_loss: 23013940.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9516; val_auprc_score: 0.9379; val_best_acc_score: 0.8921; val_best_f1_score: 0.8975; train_kl_reg_loss: 76420.7429; train_edge_recon_loss: 2726696.4695; train_gene_expr_recon_loss: 14253530.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43807.1379; train_chrom_access_recon_loss: 5805727.5076; train_global_loss: 22906182.5496; train_optim_loss: 22906182.5496; val_kl_reg_loss: 75162.1219; val_edge_recon_loss: 2719408.5167; val_gene_expr_recon_loss: 14248736.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43690.1055; val_chrom_access_recon_loss: 5839050.3333; val_global_loss: 22926047.0667; val_optim_loss: 22926047.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9537; val_auprc_score: 0.9405; val_best_acc_score: 0.8980; val_best_f1_score: 0.9012; train_kl_reg_loss: 74721.4262; train_edge_recon_loss: 2726345.8244; train_gene_expr_recon_loss: 14194862.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42919.5310; train_chrom_access_recon_loss: 5783652.2519; train_global_loss: 22822501.2977; train_optim_loss: 22822501.2977; val_kl_reg_loss: 73592.0432; val_edge_recon_loss: 2714317.3500; val_gene_expr_recon_loss: 14232819.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42488.6367; val_chrom_access_recon_loss: 5811928.7333; val_global_loss: 22875146.5333; val_optim_loss: 22875146.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9512; val_auprc_score: 0.9369; val_best_acc_score: 0.8906; val_best_f1_score: 0.8955; train_kl_reg_loss: 73234.4849; train_edge_recon_loss: 2710707.7595; train_gene_expr_recon_loss: 14137471.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42245.5751; train_chrom_access_recon_loss: 5754531.4885; train_global_loss: 22718190.7176; train_optim_loss: 22718190.7176; val_kl_reg_loss: 71277.9333; val_edge_recon_loss: 2725721.0833; val_gene_expr_recon_loss: 14171005.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42002.4180; val_chrom_access_recon_loss: 5770690.2333; val_global_loss: 22780696.4000; val_optim_loss: 22780696.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9576; val_auprc_score: 0.9496; val_best_acc_score: 0.8949; val_best_f1_score: 0.8986; train_kl_reg_loss: 70075.7894; train_edge_recon_loss: 2711538.5420; train_gene_expr_recon_loss: 14106052.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41769.0589; train_chrom_access_recon_loss: 5741548.4695; train_global_loss: 22670984.5649; train_optim_loss: 22670984.5649; val_kl_reg_loss: 68614.3146; val_edge_recon_loss: 2718936.9667; val_gene_expr_recon_loss: 14164233.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41899.3242; val_chrom_access_recon_loss: 5786241.7000; val_global_loss: 22779926.0000; val_optim_loss: 22779926.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9610; val_auprc_score: 0.9478; val_best_acc_score: 0.9025; val_best_f1_score: 0.9054; train_kl_reg_loss: 67926.3988; train_edge_recon_loss: 2704708.5916; train_gene_expr_recon_loss: 14050106.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41457.8401; train_chrom_access_recon_loss: 5718255.5916; train_global_loss: 22582454.3053; train_optim_loss: 22582454.3053; val_kl_reg_loss: 69159.1979; val_edge_recon_loss: 2703775.6667; val_gene_expr_recon_loss: 14060201.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41107.0664; val_chrom_access_recon_loss: 5723894.6667; val_global_loss: 22598138.5333; val_optim_loss: 22598138.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9623; val_auprc_score: 0.9491; val_best_acc_score: 0.9115; val_best_f1_score: 0.9148; train_kl_reg_loss: 67133.5607; train_edge_recon_loss: 2709443.9122; train_gene_expr_recon_loss: 14020348.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41057.8279; train_chrom_access_recon_loss: 5703911.0000; train_global_loss: 22541894.9313; train_optim_loss: 22541894.9313; val_kl_reg_loss: 67371.7609; val_edge_recon_loss: 2697858.7500; val_gene_expr_recon_loss: 14090454.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41037.5234; val_chrom_access_recon_loss: 5721147.2333; val_global_loss: 22617870.1333; val_optim_loss: 22617870.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9659; val_auprc_score: 0.9593; val_best_acc_score: 0.9097; val_best_f1_score: 0.9127; train_kl_reg_loss: 66551.4978; train_edge_recon_loss: 2695289.2519; train_gene_expr_recon_loss: 13970893.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40779.3021; train_chrom_access_recon_loss: 5685890.8206; train_global_loss: 22459404.0916; train_optim_loss: 22459404.0916; val_kl_reg_loss: 66624.7818; val_edge_recon_loss: 2693038.5667; val_gene_expr_recon_loss: 14039312.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40419.1289; val_chrom_access_recon_loss: 5732866.4000; val_global_loss: 22572262.0000; val_optim_loss: 22572262.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9624; val_auprc_score: 0.9482; val_best_acc_score: 0.9078; val_best_f1_score: 0.9109; train_kl_reg_loss: 65600.4270; train_edge_recon_loss: 2689674.5153; train_gene_expr_recon_loss: 13942060.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40351.4539; train_chrom_access_recon_loss: 5671012.2061; train_global_loss: 22408699.5267; train_optim_loss: 22408699.5267; val_kl_reg_loss: 63988.6693; val_edge_recon_loss: 2710485.7833; val_gene_expr_recon_loss: 13941211.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40239.4062; val_chrom_access_recon_loss: 5675081.9667; val_global_loss: 22431007.3333; val_optim_loss: 22431007.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9633; val_auprc_score: 0.9523; val_best_acc_score: 0.9108; val_best_f1_score: 0.9143; train_kl_reg_loss: 63807.0497; train_edge_recon_loss: 2692688.0515; train_gene_expr_recon_loss: 13922835.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40188.0867; train_chrom_access_recon_loss: 5657700.5229; train_global_loss: 22377219.0840; train_optim_loss: 22377219.0840; val_kl_reg_loss: 63260.1039; val_edge_recon_loss: 2706720.2500; val_gene_expr_recon_loss: 13963407.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40131.9609; val_chrom_access_recon_loss: 5689094.1000; val_global_loss: 22462613.3333; val_optim_loss: 22462613.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9673; val_auprc_score: 0.9568; val_best_acc_score: 0.9182; val_best_f1_score: 0.9203; train_kl_reg_loss: 62317.6262; train_edge_recon_loss: 2685457.8664; train_gene_expr_recon_loss: 13881086.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40072.9076; train_chrom_access_recon_loss: 5640891.4351; train_global_loss: 22309826.6718; train_optim_loss: 22309826.6718; val_kl_reg_loss: 61805.3242; val_edge_recon_loss: 2700174.5500; val_gene_expr_recon_loss: 13974526.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39815.9336; val_chrom_access_recon_loss: 5701174.9667; val_global_loss: 22477497.6000; val_optim_loss: 22477497.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9685; val_auprc_score: 0.9589; val_best_acc_score: 0.9186; val_best_f1_score: 0.9213; train_kl_reg_loss: 61941.7501; train_edge_recon_loss: 2686970.3569; train_gene_expr_recon_loss: 13864201.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39861.2292; train_chrom_access_recon_loss: 5632737.3244; train_global_loss: 22285711.9237; train_optim_loss: 22285711.9237; val_kl_reg_loss: 61617.3466; val_edge_recon_loss: 2688845.8167; val_gene_expr_recon_loss: 13905977.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39612.8906; val_chrom_access_recon_loss: 5672230.0333; val_global_loss: 22368283.2000; val_optim_loss: 22368283.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9710; val_auprc_score: 0.9619; val_best_acc_score: 0.9196; val_best_f1_score: 0.9231; train_kl_reg_loss: 61968.0800; train_edge_recon_loss: 2680764.6870; train_gene_expr_recon_loss: 13824304.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39795.0833; train_chrom_access_recon_loss: 5619025.0840; train_global_loss: 22225857.6794; train_optim_loss: 22225857.6794; val_kl_reg_loss: 62638.1698; val_edge_recon_loss: 2685082.5833; val_gene_expr_recon_loss: 13907688.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39600.6133; val_chrom_access_recon_loss: 5661105.1667; val_global_loss: 22356115.4667; val_optim_loss: 22356115.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9708; val_auprc_score: 0.9640; val_best_acc_score: 0.9214; val_best_f1_score: 0.9242; train_kl_reg_loss: 60352.7413; train_edge_recon_loss: 2675334.1126; train_gene_expr_recon_loss: 13804021.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39619.1901; train_chrom_access_recon_loss: 5608802.0458; train_global_loss: 22188129.5573; train_optim_loss: 22188129.5573; val_kl_reg_loss: 61133.3250; val_edge_recon_loss: 2684719.9833; val_gene_expr_recon_loss: 13877620.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39962.9922; val_chrom_access_recon_loss: 5651190.2667; val_global_loss: 22314627.2000; val_optim_loss: 22314627.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9702; val_auprc_score: 0.9598; val_best_acc_score: 0.9254; val_best_f1_score: 0.9278; train_kl_reg_loss: 59897.3213; train_edge_recon_loss: 2676097.4637; train_gene_expr_recon_loss: 13798813.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39846.4072; train_chrom_access_recon_loss: 5602707.3664; train_global_loss: 22177362.5344; train_optim_loss: 22177362.5344; val_kl_reg_loss: 57438.2193; val_edge_recon_loss: 2704422.3667; val_gene_expr_recon_loss: 13806657.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39485.9297; val_chrom_access_recon_loss: 5611874.7667; val_global_loss: 22219879.2000; val_optim_loss: 22219879.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9729; val_auprc_score: 0.9651; val_best_acc_score: 0.9266; val_best_f1_score: 0.9289; train_kl_reg_loss: 59188.2864; train_edge_recon_loss: 2666862.6374; train_gene_expr_recon_loss: 13762338.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39611.0921; train_chrom_access_recon_loss: 5585757.4580; train_global_loss: 22113758.0000; train_optim_loss: 22113758.0000; val_kl_reg_loss: 58831.7763; val_edge_recon_loss: 2679780.2333; val_gene_expr_recon_loss: 13820462.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39598.3945; val_chrom_access_recon_loss: 5614992.5333; val_global_loss: 22213664.6667; val_optim_loss: 22213664.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9743; val_auprc_score: 0.9672; val_best_acc_score: 0.9285; val_best_f1_score: 0.9309; train_kl_reg_loss: 59066.9466; train_edge_recon_loss: 2669264.4656; train_gene_expr_recon_loss: 13746055.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39712.9425; train_chrom_access_recon_loss: 5579979.5038; train_global_loss: 22094079.1603; train_optim_loss: 22094079.1603; val_kl_reg_loss: 59677.0932; val_edge_recon_loss: 2666111.7833; val_gene_expr_recon_loss: 13857051.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39782.5078; val_chrom_access_recon_loss: 5662822.7000; val_global_loss: 22285446.2667; val_optim_loss: 22285446.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9727; val_auprc_score: 0.9619; val_best_acc_score: 0.9278; val_best_f1_score: 0.9305; train_kl_reg_loss: 58148.1427; train_edge_recon_loss: 2666699.3760; train_gene_expr_recon_loss: 13720907.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39787.7388; train_chrom_access_recon_loss: 5566093.1145; train_global_loss: 22051635.4504; train_optim_loss: 22051635.4504; val_kl_reg_loss: 58177.0659; val_edge_recon_loss: 2680988.4333; val_gene_expr_recon_loss: 13847165.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39675.4375; val_chrom_access_recon_loss: 5615777.4333; val_global_loss: 22241783.8667; val_optim_loss: 22241783.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9762; val_auprc_score: 0.9680; val_best_acc_score: 0.9299; val_best_f1_score: 0.9327; train_kl_reg_loss: 57803.5147; train_edge_recon_loss: 2661427.4103; train_gene_expr_recon_loss: 13717596.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39847.2666; train_chrom_access_recon_loss: 5564762.2290; train_global_loss: 22041437.1298; train_optim_loss: 22041437.1298; val_kl_reg_loss: 58686.3357; val_edge_recon_loss: 2662947.8000; val_gene_expr_recon_loss: 13806841.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40290.4727; val_chrom_access_recon_loss: 5607401.7000; val_global_loss: 22176167.6000; val_optim_loss: 22176167.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9776; val_auprc_score: 0.9688; val_best_acc_score: 0.9352; val_best_f1_score: 0.9364; train_kl_reg_loss: 57143.0801; train_edge_recon_loss: 2666590.4198; train_gene_expr_recon_loss: 13695536.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40011.8180; train_chrom_access_recon_loss: 5557627.7290; train_global_loss: 22016909.2366; train_optim_loss: 22016909.2366; val_kl_reg_loss: 54413.2552; val_edge_recon_loss: 2668697.7167; val_gene_expr_recon_loss: 13804587.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40212.8125; val_chrom_access_recon_loss: 5617460.3667; val_global_loss: 22185371.2000; val_optim_loss: 22185371.2000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9780; val_auprc_score: 0.9724; val_best_acc_score: 0.9348; val_best_f1_score: 0.9372; train_kl_reg_loss: 55873.4373; train_edge_recon_loss: 2664834.8206; train_gene_expr_recon_loss: 13671948.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40239.2702; train_chrom_access_recon_loss: 5544904.0496; train_global_loss: 21977800.6565; train_optim_loss: 21977800.6565; val_kl_reg_loss: 55806.1297; val_edge_recon_loss: 2681930.6167; val_gene_expr_recon_loss: 13809967.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40321.6719; val_chrom_access_recon_loss: 5619138.5000; val_global_loss: 22207164.8000; val_optim_loss: 22207164.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9803; val_auprc_score: 0.9765; val_best_acc_score: 0.9371; val_best_f1_score: 0.9381; train_kl_reg_loss: 55628.9278; train_edge_recon_loss: 2666647.7748; train_gene_expr_recon_loss: 13673599.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40273.5394; train_chrom_access_recon_loss: 5539058.6145; train_global_loss: 21975208.6870; train_optim_loss: 21975208.6870; val_kl_reg_loss: 55921.2232; val_edge_recon_loss: 2676233.7000; val_gene_expr_recon_loss: 13732289.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40266.9531; val_chrom_access_recon_loss: 5588919.6667; val_global_loss: 22093630.8000; val_optim_loss: 22093630.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9786; val_auprc_score: 0.9723; val_best_acc_score: 0.9360; val_best_f1_score: 0.9382; train_kl_reg_loss: 55277.1051; train_edge_recon_loss: 2662212.7844; train_gene_expr_recon_loss: 13643394.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40386.1543; train_chrom_access_recon_loss: 5526354.4466; train_global_loss: 21927624.5954; train_optim_loss: 21927624.5954; val_kl_reg_loss: 54059.1901; val_edge_recon_loss: 2670850.5833; val_gene_expr_recon_loss: 13748921.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40285.1133; val_chrom_access_recon_loss: 5584699.5667; val_global_loss: 22098815.8667; val_optim_loss: 22098815.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9796; val_auprc_score: 0.9725; val_best_acc_score: 0.9394; val_best_f1_score: 0.9408; train_kl_reg_loss: 54830.9764; train_edge_recon_loss: 2663362.1202; train_gene_expr_recon_loss: 13629388.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40548.4320; train_chrom_access_recon_loss: 5515595.8893; train_global_loss: 21903726.0458; train_optim_loss: 21903726.0458; val_kl_reg_loss: 54540.1081; val_edge_recon_loss: 2663485.4500; val_gene_expr_recon_loss: 13719258.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40834.4805; val_chrom_access_recon_loss: 5574265.7333; val_global_loss: 22052383.4667; val_optim_loss: 22052383.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9803; val_auprc_score: 0.9767; val_best_acc_score: 0.9360; val_best_f1_score: 0.9381; train_kl_reg_loss: 54575.7920; train_edge_recon_loss: 2659051.0324; train_gene_expr_recon_loss: 13624642.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40809.7654; train_chrom_access_recon_loss: 5515812.6298; train_global_loss: 21894891.9389; train_optim_loss: 21894891.9389; val_kl_reg_loss: 55278.9341; val_edge_recon_loss: 2672935.7500; val_gene_expr_recon_loss: 13705900.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40745.0859; val_chrom_access_recon_loss: 5586636.5000; val_global_loss: 22061497.2000; val_optim_loss: 22061497.2000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9814; val_auprc_score: 0.9769; val_best_acc_score: 0.9387; val_best_f1_score: 0.9407; train_kl_reg_loss: 53818.0526; train_edge_recon_loss: 2652337.6374; train_gene_expr_recon_loss: 13603427.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40908.4282; train_chrom_access_recon_loss: 5504762.5611; train_global_loss: 21855254.1679; train_optim_loss: 21855254.1679; val_kl_reg_loss: 54084.3232; val_edge_recon_loss: 2663515.8333; val_gene_expr_recon_loss: 13766411.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41260.5234; val_chrom_access_recon_loss: 5579316.4667; val_global_loss: 22104588.6667; val_optim_loss: 22104588.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9815; val_auprc_score: 0.9743; val_best_acc_score: 0.9402; val_best_f1_score: 0.9423; train_kl_reg_loss: 53576.2794; train_edge_recon_loss: 2653692.4561; train_gene_expr_recon_loss: 13607316.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41257.0547; train_chrom_access_recon_loss: 5500526.5992; train_global_loss: 21856368.9924; train_optim_loss: 21856368.9924; val_kl_reg_loss: 53212.3740; val_edge_recon_loss: 2674540.3667; val_gene_expr_recon_loss: 13781551.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41561.3398; val_chrom_access_recon_loss: 5585336.5000; val_global_loss: 22136201.4667; val_optim_loss: 22136201.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9834; val_auprc_score: 0.9779; val_best_acc_score: 0.9427; val_best_f1_score: 0.9444; train_kl_reg_loss: 53522.3567; train_edge_recon_loss: 2654227.5859; train_gene_expr_recon_loss: 13586828.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41469.1563; train_chrom_access_recon_loss: 5489735.2290; train_global_loss: 21825782.8244; train_optim_loss: 21825782.8244; val_kl_reg_loss: 53776.5716; val_edge_recon_loss: 2658253.5167; val_gene_expr_recon_loss: 13648458.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41606.8047; val_chrom_access_recon_loss: 5558587.6000; val_global_loss: 21960682.4000; val_optim_loss: 21960682.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9815; val_auprc_score: 0.9756; val_best_acc_score: 0.9396; val_best_f1_score: 0.9420; train_kl_reg_loss: 53382.4161; train_edge_recon_loss: 2657520.2805; train_gene_expr_recon_loss: 13576960.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41620.2402; train_chrom_access_recon_loss: 5482437.0992; train_global_loss: 21811920.4733; train_optim_loss: 21811920.4733; val_kl_reg_loss: 53166.0839; val_edge_recon_loss: 2671565.9500; val_gene_expr_recon_loss: 13758092.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41527.6992; val_chrom_access_recon_loss: 5569873.6000; val_global_loss: 22094226.5333; val_optim_loss: 22094226.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9829; val_auprc_score: 0.9774; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 53172.5796; train_edge_recon_loss: 2653428.1145; train_gene_expr_recon_loss: 13566928.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41802.6762; train_chrom_access_recon_loss: 5479935.0802; train_global_loss: 21795267.3893; train_optim_loss: 21795267.3893; val_kl_reg_loss: 51327.9771; val_edge_recon_loss: 2673471.1667; val_gene_expr_recon_loss: 13719567.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41828.8398; val_chrom_access_recon_loss: 5554741.5333; val_global_loss: 22040936.5333; val_optim_loss: 22040936.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9812; val_auprc_score: 0.9758; val_best_acc_score: 0.9419; val_best_f1_score: 0.9435; train_kl_reg_loss: 52986.8502; train_edge_recon_loss: 2654537.8645; train_gene_expr_recon_loss: 13561763.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41979.5546; train_chrom_access_recon_loss: 5474755.3588; train_global_loss: 21786023.2214; train_optim_loss: 21786023.2214; val_kl_reg_loss: 54808.6995; val_edge_recon_loss: 2661982.1833; val_gene_expr_recon_loss: 13630614.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42065.9688; val_chrom_access_recon_loss: 5516209.4000; val_global_loss: 21905680.6667; val_optim_loss: 21905680.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9857; val_auprc_score: 0.9831; val_best_acc_score: 0.9470; val_best_f1_score: 0.9482; train_kl_reg_loss: 52534.2903; train_edge_recon_loss: 2647174.2920; train_gene_expr_recon_loss: 13541354.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42076.6076; train_chrom_access_recon_loss: 5462414.3321; train_global_loss: 21745554.2443; train_optim_loss: 21745554.2443; val_kl_reg_loss: 52992.9852; val_edge_recon_loss: 2645800.7167; val_gene_expr_recon_loss: 13705412.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42405.5781; val_chrom_access_recon_loss: 5551391.0667; val_global_loss: 21998003.8667; val_optim_loss: 21998003.8667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9883; val_auprc_score: 0.9862; val_best_acc_score: 0.9520; val_best_f1_score: 0.9533; train_kl_reg_loss: 52105.9190; train_edge_recon_loss: 2654830.6393; train_gene_expr_recon_loss: 13539030.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42313.0857; train_chrom_access_recon_loss: 5459761.1832; train_global_loss: 21748041.5115; train_optim_loss: 21748041.5115; val_kl_reg_loss: 52214.2281; val_edge_recon_loss: 2638461.4500; val_gene_expr_recon_loss: 13664646.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42500.8984; val_chrom_access_recon_loss: 5527525.9333; val_global_loss: 21925348.4000; val_optim_loss: 21925348.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9838; val_auprc_score: 0.9772; val_best_acc_score: 0.9440; val_best_f1_score: 0.9452; train_kl_reg_loss: 52513.1532; train_edge_recon_loss: 2644864.9943; train_gene_expr_recon_loss: 13533009.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42455.4431; train_chrom_access_recon_loss: 5452589.0191; train_global_loss: 21725431.9389; train_optim_loss: 21725431.9389; val_kl_reg_loss: 51179.3497; val_edge_recon_loss: 2665868.7500; val_gene_expr_recon_loss: 13708586.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42719.2305; val_chrom_access_recon_loss: 5540823.5333; val_global_loss: 22009177.0667; val_optim_loss: 22009177.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9852; val_auprc_score: 0.9777; val_best_acc_score: 0.9466; val_best_f1_score: 0.9476; train_kl_reg_loss: 51606.4736; train_edge_recon_loss: 2654072.5057; train_gene_expr_recon_loss: 13523018.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42676.9620; train_chrom_access_recon_loss: 5446190.0000; train_global_loss: 21717564.6718; train_optim_loss: 21717564.6718; val_kl_reg_loss: 51835.2438; val_edge_recon_loss: 2656779.9500; val_gene_expr_recon_loss: 13652066.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43315.3516; val_chrom_access_recon_loss: 5540618.2333; val_global_loss: 21944614.8000; val_optim_loss: 21944614.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9849; val_auprc_score: 0.9781; val_best_acc_score: 0.9481; val_best_f1_score: 0.9491; train_kl_reg_loss: 52282.1659; train_edge_recon_loss: 2650559.8531; train_gene_expr_recon_loss: 13495878.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35455.5024; train_chrom_access_recon_loss: 5433340.3092; train_global_loss: 21667516.2748; train_optim_loss: 21667516.2748; val_kl_reg_loss: 53250.9591; val_edge_recon_loss: 2652672.2167; val_gene_expr_recon_loss: 13677686.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33810.6797; val_chrom_access_recon_loss: 5537251.0667; val_global_loss: 21954671.7333; val_optim_loss: 21954671.7333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9860; val_auprc_score: 0.9837; val_best_acc_score: 0.9465; val_best_f1_score: 0.9476; train_kl_reg_loss: 53131.5855; train_edge_recon_loss: 2641800.3969; train_gene_expr_recon_loss: 13481838.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33488.9731; train_chrom_access_recon_loss: 5429241.3435; train_global_loss: 21639500.5802; train_optim_loss: 21639500.5802; val_kl_reg_loss: 53215.9320; val_edge_recon_loss: 2656882.3000; val_gene_expr_recon_loss: 13610814.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33270.6953; val_chrom_access_recon_loss: 5518936.0333; val_global_loss: 21873119.3333; val_optim_loss: 21873119.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9836; val_auprc_score: 0.9794; val_best_acc_score: 0.9449; val_best_f1_score: 0.9461; train_kl_reg_loss: 53350.3258; train_edge_recon_loss: 2652003.2824; train_gene_expr_recon_loss: 13479546.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33112.2984; train_chrom_access_recon_loss: 5426150.1450; train_global_loss: 21644162.9160; train_optim_loss: 21644162.9160; val_kl_reg_loss: 53202.8135; val_edge_recon_loss: 2665562.1167; val_gene_expr_recon_loss: 13698245.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32995.7852; val_chrom_access_recon_loss: 5537145.3667; val_global_loss: 21987151.2000; val_optim_loss: 21987151.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9855; val_auprc_score: 0.9825; val_best_acc_score: 0.9473; val_best_f1_score: 0.9484; train_kl_reg_loss: 53433.9981; train_edge_recon_loss: 2642719.9599; train_gene_expr_recon_loss: 13481372.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32888.2948; train_chrom_access_recon_loss: 5422976.3130; train_global_loss: 21633390.9466; train_optim_loss: 21633390.9466; val_kl_reg_loss: 53296.9609; val_edge_recon_loss: 2657569.3000; val_gene_expr_recon_loss: 13659990.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32833.2383; val_chrom_access_recon_loss: 5527654.5667; val_global_loss: 21931344.4000; val_optim_loss: 21931344.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9866; val_auprc_score: 0.9833; val_best_acc_score: 0.9500; val_best_f1_score: 0.9509; train_kl_reg_loss: 53572.9725; train_edge_recon_loss: 2646625.5057; train_gene_expr_recon_loss: 13468883.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32742.4150; train_chrom_access_recon_loss: 5419110.7634; train_global_loss: 21620934.6412; train_optim_loss: 21620934.6412; val_kl_reg_loss: 53935.1685; val_edge_recon_loss: 2642656.0000; val_gene_expr_recon_loss: 13719864.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32699.9141; val_chrom_access_recon_loss: 5540686.5000; val_global_loss: 21989842.0000; val_optim_loss: 21989842.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9818; val_best_acc_score: 0.9485; val_best_f1_score: 0.9496; train_kl_reg_loss: 53750.7860; train_edge_recon_loss: 2643984.2824; train_gene_expr_recon_loss: 13486197.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32633.8490; train_chrom_access_recon_loss: 5426022.5534; train_global_loss: 21642588.7023; train_optim_loss: 21642588.7023; val_kl_reg_loss: 53637.3833; val_edge_recon_loss: 2651773.5833; val_gene_expr_recon_loss: 13650593.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32566.1309; val_chrom_access_recon_loss: 5562413.8667; val_global_loss: 21950984.4000; val_optim_loss: 21950984.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9864; val_auprc_score: 0.9806; val_best_acc_score: 0.9528; val_best_f1_score: 0.9540; train_kl_reg_loss: 53645.7082; train_edge_recon_loss: 2646000.0592; train_gene_expr_recon_loss: 13476360.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31796.9752; train_chrom_access_recon_loss: 5424803.3511; train_global_loss: 21632606.1527; train_optim_loss: 21632606.1527; val_kl_reg_loss: 53857.0034; val_edge_recon_loss: 2637419.2167; val_gene_expr_recon_loss: 13593394.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31641.9551; val_chrom_access_recon_loss: 5488876.5667; val_global_loss: 21805188.9333; val_optim_loss: 21805188.9333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9846; val_auprc_score: 0.9809; val_best_acc_score: 0.9460; val_best_f1_score: 0.9471; train_kl_reg_loss: 53747.2212; train_edge_recon_loss: 2638340.9809; train_gene_expr_recon_loss: 13475084.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31609.8136; train_chrom_access_recon_loss: 5423910.8626; train_global_loss: 21622692.8092; train_optim_loss: 21622692.8092; val_kl_reg_loss: 54137.6018; val_edge_recon_loss: 2654652.1833; val_gene_expr_recon_loss: 13653385.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31581.7500; val_chrom_access_recon_loss: 5526710.9333; val_global_loss: 21920468.2667; val_optim_loss: 21920468.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9846; val_auprc_score: 0.9798; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 53787.6992; train_edge_recon_loss: 2648249.8550; train_gene_expr_recon_loss: 13476737.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31561.0506; train_chrom_access_recon_loss: 5418731.5878; train_global_loss: 21629067.2519; train_optim_loss: 21629067.2519; val_kl_reg_loss: 53936.0068; val_edge_recon_loss: 2676268.2667; val_gene_expr_recon_loss: 13670898.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31550.8242; val_chrom_access_recon_loss: 5522763.6667; val_global_loss: 21955417.6000; val_optim_loss: 21955417.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9851; val_best_acc_score: 0.9501; val_best_f1_score: 0.9514; train_kl_reg_loss: 53718.4594; train_edge_recon_loss: 2647085.9943; train_gene_expr_recon_loss: 13466239.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31534.6915; train_chrom_access_recon_loss: 5415329.2748; train_global_loss: 21613908.0916; train_optim_loss: 21613908.0916; val_kl_reg_loss: 54000.2734; val_edge_recon_loss: 2642293.1667; val_gene_expr_recon_loss: 13690022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31521.1543; val_chrom_access_recon_loss: 5531323.3667; val_global_loss: 21949160.2667; val_optim_loss: 21949160.2667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9863; val_auprc_score: 0.9832; val_best_acc_score: 0.9465; val_best_f1_score: 0.9471; train_kl_reg_loss: 53866.7244; train_edge_recon_loss: 2645273.2996; train_gene_expr_recon_loss: 13474271.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31508.1671; train_chrom_access_recon_loss: 5421502.0802; train_global_loss: 21626421.7252; train_optim_loss: 21626421.7252; val_kl_reg_loss: 53821.1719; val_edge_recon_loss: 2661845.7167; val_gene_expr_recon_loss: 13668257.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31500.1211; val_chrom_access_recon_loss: 5516070.8333; val_global_loss: 21931495.2000; val_optim_loss: 21931495.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9854; val_auprc_score: 0.9823; val_best_acc_score: 0.9481; val_best_f1_score: 0.9492; train_kl_reg_loss: 53750.1840; train_edge_recon_loss: 2643556.3969; train_gene_expr_recon_loss: 13471743.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31422.9820; train_chrom_access_recon_loss: 5426710.5802; train_global_loss: 21627183.6183; train_optim_loss: 21627183.6183; val_kl_reg_loss: 54059.9490; val_edge_recon_loss: 2659955.9667; val_gene_expr_recon_loss: 13655121.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31406.8477; val_chrom_access_recon_loss: 5524439.8000; val_global_loss: 21924984.1333; val_optim_loss: 21924984.1333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9855; val_auprc_score: 0.9826; val_best_acc_score: 0.9448; val_best_f1_score: 0.9460; train_kl_reg_loss: 53826.7125; train_edge_recon_loss: 2646540.4160; train_gene_expr_recon_loss: 13475111.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31403.3820; train_chrom_access_recon_loss: 5417472.9847; train_global_loss: 21624354.8855; train_optim_loss: 21624354.8855; val_kl_reg_loss: 53863.0411; val_edge_recon_loss: 2655692.6167; val_gene_expr_recon_loss: 13611007.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31400.3672; val_chrom_access_recon_loss: 5514979.9667; val_global_loss: 21866943.2000; val_optim_loss: 21866943.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9863; val_auprc_score: 0.9819; val_best_acc_score: 0.9472; val_best_f1_score: 0.9487; train_kl_reg_loss: 53781.2390; train_edge_recon_loss: 2644137.1718; train_gene_expr_recon_loss: 13466616.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31397.9916; train_chrom_access_recon_loss: 5420804.7214; train_global_loss: 21616738.0763; train_optim_loss: 21616738.0763; val_kl_reg_loss: 54069.1560; val_edge_recon_loss: 2661327.2167; val_gene_expr_recon_loss: 13670741.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31396.1914; val_chrom_access_recon_loss: 5527906.1667; val_global_loss: 21945439.6000; val_optim_loss: 21945439.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9878; val_auprc_score: 0.9856; val_best_acc_score: 0.9503; val_best_f1_score: 0.9512; train_kl_reg_loss: 53798.8353; train_edge_recon_loss: 2648737.1947; train_gene_expr_recon_loss: 13473310.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31394.7931; train_chrom_access_recon_loss: 5420246.6336; train_global_loss: 21627487.5878; train_optim_loss: 21627487.5878; val_kl_reg_loss: 53929.6862; val_edge_recon_loss: 2643887.7167; val_gene_expr_recon_loss: 13681259.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31393.0664; val_chrom_access_recon_loss: 5539808.1667; val_global_loss: 21950277.4667; val_optim_loss: 21950277.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 84 min 14 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9860
val AUPRC score: 0.9830
val best accuracy score: 0.9480
val best F1 score: 0.9490
val target rna MSE score: 0.7850
val source rna MSE score: 0.1456
val target atac MSE score: 0.5120
val source atac MSE score: 0.0751
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
