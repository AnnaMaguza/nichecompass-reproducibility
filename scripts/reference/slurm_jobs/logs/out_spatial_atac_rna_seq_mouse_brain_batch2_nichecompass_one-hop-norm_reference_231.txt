[True]
Run timestamp: 10102023_101814_231.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_231']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7234; val_auprc_score: 0.6846; val_best_acc_score: 0.5005; val_best_f1_score: 0.6668; train_kl_reg_loss: 96051.4469; train_edge_recon_loss: 768419.7822; train_gene_expr_recon_loss: 22983565.1212; train_masked_gp_l1_reg_loss: 34451.8861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4005166.0000; train_chrom_access_recon_loss: 6889106.8333; train_global_loss: 34776761.0303; train_optim_loss: 34776761.0303; val_kl_reg_loss: 114011.7354; val_edge_recon_loss: 813017.3906; val_gene_expr_recon_loss: 21566726.5000; val_masked_gp_l1_reg_loss: 36047.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2659620.5000; val_chrom_access_recon_loss: 6583680.2500; val_global_loss: 31773104.0000; val_optim_loss: 31773104.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7322; val_auprc_score: 0.7057; val_best_acc_score: 0.6330; val_best_f1_score: 0.7174; train_kl_reg_loss: 106878.6578; train_edge_recon_loss: 754885.2794; train_gene_expr_recon_loss: 21207629.7576; train_masked_gp_l1_reg_loss: 36843.1816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1709302.1004; train_chrom_access_recon_loss: 6594457.3636; train_global_loss: 30409996.3636; train_optim_loss: 30409996.3636; val_kl_reg_loss: 107237.8994; val_edge_recon_loss: 811539.9062; val_gene_expr_recon_loss: 21144582.5000; val_masked_gp_l1_reg_loss: 37807.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1003485.5000; val_chrom_access_recon_loss: 6560484.2500; val_global_loss: 29665138.7500; val_optim_loss: 29665138.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8139; val_auprc_score: 0.7961; val_best_acc_score: 0.7260; val_best_f1_score: 0.7238; train_kl_reg_loss: 90220.3571; train_edge_recon_loss: 741212.7453; train_gene_expr_recon_loss: 21019224.6970; train_masked_gp_l1_reg_loss: 38795.0223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 689794.8007; train_chrom_access_recon_loss: 6551493.6970; train_global_loss: 29130741.2727; train_optim_loss: 29130741.2727; val_kl_reg_loss: 86189.0801; val_edge_recon_loss: 803082.0859; val_gene_expr_recon_loss: 21072330.2500; val_masked_gp_l1_reg_loss: 39949.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 468335.8125; val_chrom_access_recon_loss: 6521105.2500; val_global_loss: 28990992.7500; val_optim_loss: 28990992.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8720; val_auprc_score: 0.8399; val_best_acc_score: 0.8023; val_best_f1_score: 0.8190; train_kl_reg_loss: 78781.9876; train_edge_recon_loss: 729236.9934; train_gene_expr_recon_loss: 20854940.1212; train_masked_gp_l1_reg_loss: 41198.9840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 362291.4257; train_chrom_access_recon_loss: 6502893.3561; train_global_loss: 28569342.8485; train_optim_loss: 28569342.8485; val_kl_reg_loss: 72469.0508; val_edge_recon_loss: 766308.4688; val_gene_expr_recon_loss: 21098532.5000; val_masked_gp_l1_reg_loss: 42586.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 284298.8438; val_chrom_access_recon_loss: 6504248.5625; val_global_loss: 28768442.5000; val_optim_loss: 28768442.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8963; val_auprc_score: 0.8643; val_best_acc_score: 0.8299; val_best_f1_score: 0.8410; train_kl_reg_loss: 74851.8729; train_edge_recon_loss: 690598.0142; train_gene_expr_recon_loss: 20712894.7273; train_masked_gp_l1_reg_loss: 44061.1504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246230.9103; train_chrom_access_recon_loss: 6460810.3939; train_global_loss: 28229447.0606; train_optim_loss: 28229447.0606; val_kl_reg_loss: 84130.6562; val_edge_recon_loss: 658481.4922; val_gene_expr_recon_loss: 20724128.2500; val_masked_gp_l1_reg_loss: 45489.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214925.6875; val_chrom_access_recon_loss: 6402738.8125; val_global_loss: 28129895.2500; val_optim_loss: 28129895.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9007; val_auprc_score: 0.8725; val_best_acc_score: 0.8337; val_best_f1_score: 0.8466; train_kl_reg_loss: 85709.9782; train_edge_recon_loss: 637806.6686; train_gene_expr_recon_loss: 20592237.6061; train_masked_gp_l1_reg_loss: 46740.5437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193899.0374; train_chrom_access_recon_loss: 6439955.2576; train_global_loss: 27996348.8485; train_optim_loss: 27996348.8485; val_kl_reg_loss: 82406.5840; val_edge_recon_loss: 639609.9297; val_gene_expr_recon_loss: 20692952.7500; val_masked_gp_l1_reg_loss: 48189.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175527.4688; val_chrom_access_recon_loss: 6411509.1250; val_global_loss: 28050196.0000; val_optim_loss: 28050196.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9051; val_auprc_score: 0.8816; val_best_acc_score: 0.8358; val_best_f1_score: 0.8449; train_kl_reg_loss: 84724.4787; train_edge_recon_loss: 623030.4432; train_gene_expr_recon_loss: 20442080.6667; train_masked_gp_l1_reg_loss: 49233.2420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161123.0502; train_chrom_access_recon_loss: 6395401.6364; train_global_loss: 27755593.4545; train_optim_loss: 27755593.4545; val_kl_reg_loss: 81657.3057; val_edge_recon_loss: 632823.3359; val_gene_expr_recon_loss: 20670372.5000; val_masked_gp_l1_reg_loss: 50366.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148777.7188; val_chrom_access_recon_loss: 6443046.8125; val_global_loss: 28027043.7500; val_optim_loss: 28027043.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9106; val_auprc_score: 0.8901; val_best_acc_score: 0.8391; val_best_f1_score: 0.8505; train_kl_reg_loss: 80750.6046; train_edge_recon_loss: 618644.8343; train_gene_expr_recon_loss: 20375692.6061; train_masked_gp_l1_reg_loss: 51255.3920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139810.9986; train_chrom_access_recon_loss: 6383437.0530; train_global_loss: 27649591.5758; train_optim_loss: 27649591.5758; val_kl_reg_loss: 77687.9072; val_edge_recon_loss: 621864.7891; val_gene_expr_recon_loss: 20448667.5000; val_masked_gp_l1_reg_loss: 52266.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132397.5625; val_chrom_access_recon_loss: 6270326.8750; val_global_loss: 27603210.7500; val_optim_loss: 27603210.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9144; val_auprc_score: 0.8877; val_best_acc_score: 0.8471; val_best_f1_score: 0.8554; train_kl_reg_loss: 78771.8008; train_edge_recon_loss: 610129.2424; train_gene_expr_recon_loss: 20280671.3636; train_masked_gp_l1_reg_loss: 53014.9325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126995.4608; train_chrom_access_recon_loss: 6349863.7652; train_global_loss: 27499446.7273; train_optim_loss: 27499446.7273; val_kl_reg_loss: 76786.8154; val_edge_recon_loss: 619951.1719; val_gene_expr_recon_loss: 20420210.0000; val_masked_gp_l1_reg_loss: 53893.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121812.5938; val_chrom_access_recon_loss: 6403800.7500; val_global_loss: 27696455.0000; val_optim_loss: 27696455.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9214; val_auprc_score: 0.8960; val_best_acc_score: 0.8563; val_best_f1_score: 0.8669; train_kl_reg_loss: 76408.0932; train_edge_recon_loss: 607685.0407; train_gene_expr_recon_loss: 20200522.5152; train_masked_gp_l1_reg_loss: 54523.4586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117909.8703; train_chrom_access_recon_loss: 6330639.9318; train_global_loss: 27387688.9091; train_optim_loss: 27387688.9091; val_kl_reg_loss: 75530.8281; val_edge_recon_loss: 613683.5703; val_gene_expr_recon_loss: 20374706.5000; val_masked_gp_l1_reg_loss: 55277.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114856.2188; val_chrom_access_recon_loss: 6325274.3750; val_global_loss: 27559329.2500; val_optim_loss: 27559329.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9232; val_auprc_score: 0.9005; val_best_acc_score: 0.8546; val_best_f1_score: 0.8612; train_kl_reg_loss: 74548.8781; train_edge_recon_loss: 602296.2917; train_gene_expr_recon_loss: 20111812.7576; train_masked_gp_l1_reg_loss: 55949.4032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111057.0897; train_chrom_access_recon_loss: 6304783.5606; train_global_loss: 27260447.8788; train_optim_loss: 27260447.8788; val_kl_reg_loss: 75947.8311; val_edge_recon_loss: 605723.4297; val_gene_expr_recon_loss: 20162674.7500; val_masked_gp_l1_reg_loss: 56605.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108028.4922; val_chrom_access_recon_loss: 6279344.4375; val_global_loss: 27288324.2500; val_optim_loss: 27288324.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9280; val_auprc_score: 0.8996; val_best_acc_score: 0.8643; val_best_f1_score: 0.8734; train_kl_reg_loss: 72269.6495; train_edge_recon_loss: 600064.5294; train_gene_expr_recon_loss: 20069384.3939; train_masked_gp_l1_reg_loss: 57236.5201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105305.9184; train_chrom_access_recon_loss: 6288017.9924; train_global_loss: 27192279.1515; train_optim_loss: 27192279.1515; val_kl_reg_loss: 69579.7383; val_edge_recon_loss: 603586.6016; val_gene_expr_recon_loss: 20100224.7500; val_masked_gp_l1_reg_loss: 57960.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103837.2812; val_chrom_access_recon_loss: 6266668.1875; val_global_loss: 27201857.5000; val_optim_loss: 27201857.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9346; val_auprc_score: 0.9174; val_best_acc_score: 0.8692; val_best_f1_score: 0.8730; train_kl_reg_loss: 70783.2781; train_edge_recon_loss: 598227.7604; train_gene_expr_recon_loss: 19976127.0909; train_masked_gp_l1_reg_loss: 58515.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101287.4776; train_chrom_access_recon_loss: 6258526.4167; train_global_loss: 27063467.4545; train_optim_loss: 27063467.4545; val_kl_reg_loss: 67023.8926; val_edge_recon_loss: 601944.9609; val_gene_expr_recon_loss: 20171515.5000; val_masked_gp_l1_reg_loss: 59030.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98811.3672; val_chrom_access_recon_loss: 6296980.0000; val_global_loss: 27295306.0000; val_optim_loss: 27295306.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9353; val_auprc_score: 0.9165; val_best_acc_score: 0.8764; val_best_f1_score: 0.8808; train_kl_reg_loss: 69073.4918; train_edge_recon_loss: 596243.4659; train_gene_expr_recon_loss: 19916388.4848; train_masked_gp_l1_reg_loss: 59557.7963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97051.6538; train_chrom_access_recon_loss: 6238621.5227; train_global_loss: 26976936.3333; train_optim_loss: 26976936.3333; val_kl_reg_loss: 67549.9966; val_edge_recon_loss: 598030.0000; val_gene_expr_recon_loss: 19949365.2500; val_masked_gp_l1_reg_loss: 60158.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96196.6562; val_chrom_access_recon_loss: 6223608.8125; val_global_loss: 26994908.2500; val_optim_loss: 26994908.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9377; val_auprc_score: 0.9117; val_best_acc_score: 0.8802; val_best_f1_score: 0.8832; train_kl_reg_loss: 68401.1951; train_edge_recon_loss: 591765.5218; train_gene_expr_recon_loss: 19858511.1212; train_masked_gp_l1_reg_loss: 60742.8859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94502.9290; train_chrom_access_recon_loss: 6210988.8561; train_global_loss: 26884912.3939; train_optim_loss: 26884912.3939; val_kl_reg_loss: 68609.0244; val_edge_recon_loss: 598834.7266; val_gene_expr_recon_loss: 20031024.0000; val_masked_gp_l1_reg_loss: 61264.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93621.0938; val_chrom_access_recon_loss: 6178510.8750; val_global_loss: 27031865.0000; val_optim_loss: 27031865.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9382; val_auprc_score: 0.9165; val_best_acc_score: 0.8748; val_best_f1_score: 0.8795; train_kl_reg_loss: 66980.1980; train_edge_recon_loss: 591416.4138; train_gene_expr_recon_loss: 19786888.0000; train_masked_gp_l1_reg_loss: 61756.2347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92345.1753; train_chrom_access_recon_loss: 6191823.0000; train_global_loss: 26791209.0606; train_optim_loss: 26791209.0606; val_kl_reg_loss: 64407.8833; val_edge_recon_loss: 599926.1953; val_gene_expr_recon_loss: 20015875.0000; val_masked_gp_l1_reg_loss: 62416.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91252.9297; val_chrom_access_recon_loss: 6189744.4375; val_global_loss: 27023621.5000; val_optim_loss: 27023621.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9471; val_auprc_score: 0.9348; val_best_acc_score: 0.8847; val_best_f1_score: 0.8900; train_kl_reg_loss: 65713.4592; train_edge_recon_loss: 589669.8371; train_gene_expr_recon_loss: 19743465.7879; train_masked_gp_l1_reg_loss: 62846.7238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90117.1889; train_chrom_access_recon_loss: 6176815.6818; train_global_loss: 26728628.4242; train_optim_loss: 26728628.4242; val_kl_reg_loss: 66825.9707; val_edge_recon_loss: 594405.9375; val_gene_expr_recon_loss: 19870512.0000; val_masked_gp_l1_reg_loss: 63434.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89898.6016; val_chrom_access_recon_loss: 6183862.0000; val_global_loss: 26868937.5000; val_optim_loss: 26868937.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9475; val_auprc_score: 0.9263; val_best_acc_score: 0.8941; val_best_f1_score: 0.8967; train_kl_reg_loss: 64595.7442; train_edge_recon_loss: 589298.3816; train_gene_expr_recon_loss: 19698028.3636; train_masked_gp_l1_reg_loss: 63945.3792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89004.7885; train_chrom_access_recon_loss: 6153135.1288; train_global_loss: 26658007.5152; train_optim_loss: 26658007.5152; val_kl_reg_loss: 63719.7983; val_edge_recon_loss: 587883.1406; val_gene_expr_recon_loss: 19821466.0000; val_masked_gp_l1_reg_loss: 64414.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87947.8828; val_chrom_access_recon_loss: 6133063.0000; val_global_loss: 26758494.0000; val_optim_loss: 26758494.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9474; val_auprc_score: 0.9307; val_best_acc_score: 0.8898; val_best_f1_score: 0.8943; train_kl_reg_loss: 64041.6283; train_edge_recon_loss: 585604.1023; train_gene_expr_recon_loss: 19626047.9697; train_masked_gp_l1_reg_loss: 64998.2572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87473.3181; train_chrom_access_recon_loss: 6123434.0303; train_global_loss: 26551599.4545; train_optim_loss: 26551599.4545; val_kl_reg_loss: 62919.4897; val_edge_recon_loss: 590756.7734; val_gene_expr_recon_loss: 19912885.0000; val_masked_gp_l1_reg_loss: 65638.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87395.3516; val_chrom_access_recon_loss: 6137634.4375; val_global_loss: 26857229.5000; val_optim_loss: 26857229.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9509; val_auprc_score: 0.9310; val_best_acc_score: 0.8939; val_best_f1_score: 0.8973; train_kl_reg_loss: 62931.7083; train_edge_recon_loss: 585413.9110; train_gene_expr_recon_loss: 19601780.4848; train_masked_gp_l1_reg_loss: 66167.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86799.1165; train_chrom_access_recon_loss: 6112851.2727; train_global_loss: 26515943.9697; train_optim_loss: 26515943.9697; val_kl_reg_loss: 63195.9121; val_edge_recon_loss: 588746.2734; val_gene_expr_recon_loss: 19749115.2500; val_masked_gp_l1_reg_loss: 66654.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86232.7891; val_chrom_access_recon_loss: 6082268.2500; val_global_loss: 26636211.2500; val_optim_loss: 26636211.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9498; val_auprc_score: 0.9317; val_best_acc_score: 0.8920; val_best_f1_score: 0.8950; train_kl_reg_loss: 62682.5368; train_edge_recon_loss: 584478.2623; train_gene_expr_recon_loss: 19512947.3333; train_masked_gp_l1_reg_loss: 67148.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85791.2953; train_chrom_access_recon_loss: 6082975.7803; train_global_loss: 26396023.2727; train_optim_loss: 26396023.2727; val_kl_reg_loss: 62022.8374; val_edge_recon_loss: 587261.4297; val_gene_expr_recon_loss: 19720919.0000; val_masked_gp_l1_reg_loss: 67691.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85749.9609; val_chrom_access_recon_loss: 6093762.7500; val_global_loss: 26617408.0000; val_optim_loss: 26617408.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9522; val_auprc_score: 0.9351; val_best_acc_score: 0.8944; val_best_f1_score: 0.8984; train_kl_reg_loss: 61776.5411; train_edge_recon_loss: 582476.4223; train_gene_expr_recon_loss: 19472093.3939; train_masked_gp_l1_reg_loss: 68270.2305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85602.1600; train_chrom_access_recon_loss: 6065775.0303; train_global_loss: 26335993.7576; train_optim_loss: 26335993.7576; val_kl_reg_loss: 60846.9463; val_edge_recon_loss: 593104.9688; val_gene_expr_recon_loss: 19680796.2500; val_masked_gp_l1_reg_loss: 68988.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85592.3984; val_chrom_access_recon_loss: 6050269.9375; val_global_loss: 26539597.7500; val_optim_loss: 26539597.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9485; val_auprc_score: 0.9285; val_best_acc_score: 0.8890; val_best_f1_score: 0.8926; train_kl_reg_loss: 60905.7204; train_edge_recon_loss: 582357.1847; train_gene_expr_recon_loss: 19412201.2121; train_masked_gp_l1_reg_loss: 69558.6276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85538.4130; train_chrom_access_recon_loss: 6042725.2045; train_global_loss: 26253286.2121; train_optim_loss: 26253286.2121; val_kl_reg_loss: 59904.5840; val_edge_recon_loss: 593243.4453; val_gene_expr_recon_loss: 19583603.2500; val_masked_gp_l1_reg_loss: 70239.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85327.6406; val_chrom_access_recon_loss: 6062602.1875; val_global_loss: 26454921.5000; val_optim_loss: 26454921.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9530; val_auprc_score: 0.9321; val_best_acc_score: 0.8998; val_best_f1_score: 0.9027; train_kl_reg_loss: 60038.3403; train_edge_recon_loss: 583224.9972; train_gene_expr_recon_loss: 19358192.5455; train_masked_gp_l1_reg_loss: 70784.1188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85193.8606; train_chrom_access_recon_loss: 6017226.7727; train_global_loss: 26174660.5455; train_optim_loss: 26174660.5455; val_kl_reg_loss: 60698.7900; val_edge_recon_loss: 585368.7969; val_gene_expr_recon_loss: 19593975.7500; val_masked_gp_l1_reg_loss: 71488.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85626.1953; val_chrom_access_recon_loss: 6021698.8125; val_global_loss: 26418856.5000; val_optim_loss: 26418856.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9557; val_auprc_score: 0.9391; val_best_acc_score: 0.9025; val_best_f1_score: 0.9072; train_kl_reg_loss: 59393.0034; train_edge_recon_loss: 584373.0189; train_gene_expr_recon_loss: 19308684.1212; train_masked_gp_l1_reg_loss: 72125.6033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85483.4233; train_chrom_access_recon_loss: 5999981.4773; train_global_loss: 26110040.7879; train_optim_loss: 26110040.7879; val_kl_reg_loss: 58340.3599; val_edge_recon_loss: 584026.3125; val_gene_expr_recon_loss: 19497256.2500; val_masked_gp_l1_reg_loss: 72698.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85448.5469; val_chrom_access_recon_loss: 5977960.6250; val_global_loss: 26275729.5000; val_optim_loss: 26275729.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9539; val_auprc_score: 0.9399; val_best_acc_score: 0.8971; val_best_f1_score: 0.9005; train_kl_reg_loss: 58863.3817; train_edge_recon_loss: 583062.2737; train_gene_expr_recon_loss: 19250909.9091; train_masked_gp_l1_reg_loss: 73383.9949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85625.2259; train_chrom_access_recon_loss: 5980303.3561; train_global_loss: 26032147.9091; train_optim_loss: 26032147.9091; val_kl_reg_loss: 58663.9878; val_edge_recon_loss: 588739.2500; val_gene_expr_recon_loss: 19619620.0000; val_masked_gp_l1_reg_loss: 74096.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85009.6797; val_chrom_access_recon_loss: 6072625.3125; val_global_loss: 26498754.5000; val_optim_loss: 26498754.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9543; val_auprc_score: 0.9368; val_best_acc_score: 0.9025; val_best_f1_score: 0.9046; train_kl_reg_loss: 58509.1765; train_edge_recon_loss: 581652.7358; train_gene_expr_recon_loss: 19197335.9697; train_masked_gp_l1_reg_loss: 74759.5752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85327.0363; train_chrom_access_recon_loss: 5955201.0152; train_global_loss: 25952785.1818; train_optim_loss: 25952785.1818; val_kl_reg_loss: 59240.6899; val_edge_recon_loss: 586222.4141; val_gene_expr_recon_loss: 19423881.7500; val_masked_gp_l1_reg_loss: 75492.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85470.8750; val_chrom_access_recon_loss: 6012274.6875; val_global_loss: 26242582.0000; val_optim_loss: 26242582.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9490; val_auprc_score: 0.9303; val_best_acc_score: 0.8955; val_best_f1_score: 0.8986; train_kl_reg_loss: 58663.9549; train_edge_recon_loss: 581124.4962; train_gene_expr_recon_loss: 19141881.3939; train_masked_gp_l1_reg_loss: 76216.4482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85669.5849; train_chrom_access_recon_loss: 5935371.9318; train_global_loss: 25878927.8485; train_optim_loss: 25878927.8485; val_kl_reg_loss: 58425.1362; val_edge_recon_loss: 588387.1094; val_gene_expr_recon_loss: 19582239.2500; val_masked_gp_l1_reg_loss: 76847.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85366.4062; val_chrom_access_recon_loss: 5992566.4375; val_global_loss: 26383831.5000; val_optim_loss: 26383831.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9518; val_auprc_score: 0.9313; val_best_acc_score: 0.8998; val_best_f1_score: 0.9034; train_kl_reg_loss: 58162.9374; train_edge_recon_loss: 582721.5767; train_gene_expr_recon_loss: 19097064.3939; train_masked_gp_l1_reg_loss: 77573.9594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85889.3008; train_chrom_access_recon_loss: 5924469.1364; train_global_loss: 25825881.2121; train_optim_loss: 25825881.2121; val_kl_reg_loss: 57638.7568; val_edge_recon_loss: 580438.4844; val_gene_expr_recon_loss: 19327124.0000; val_masked_gp_l1_reg_loss: 78269.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85876.2578; val_chrom_access_recon_loss: 6003672.4375; val_global_loss: 26133019.5000; val_optim_loss: 26133019.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9524; val_auprc_score: 0.9373; val_best_acc_score: 0.8998; val_best_f1_score: 0.9022; train_kl_reg_loss: 58313.5868; train_edge_recon_loss: 581706.6837; train_gene_expr_recon_loss: 19040919.7879; train_masked_gp_l1_reg_loss: 78897.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85930.4097; train_chrom_access_recon_loss: 5904981.1591; train_global_loss: 25750748.5758; train_optim_loss: 25750748.5758; val_kl_reg_loss: 58187.2192; val_edge_recon_loss: 591295.0469; val_gene_expr_recon_loss: 19260632.2500; val_masked_gp_l1_reg_loss: 79580.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86330.9062; val_chrom_access_recon_loss: 5964132.2500; val_global_loss: 26040156.2500; val_optim_loss: 26040156.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9483; val_auprc_score: 0.9281; val_best_acc_score: 0.8949; val_best_f1_score: 0.9004; train_kl_reg_loss: 58255.1798; train_edge_recon_loss: 582443.9763; train_gene_expr_recon_loss: 18989124.1818; train_masked_gp_l1_reg_loss: 80207.3578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86282.4062; train_chrom_access_recon_loss: 5886828.0152; train_global_loss: 25683141.2121; train_optim_loss: 25683141.2121; val_kl_reg_loss: 59317.7983; val_edge_recon_loss: 588136.2422; val_gene_expr_recon_loss: 19447406.5000; val_masked_gp_l1_reg_loss: 80831.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86151.7734; val_chrom_access_recon_loss: 6064360.6875; val_global_loss: 26326205.2500; val_optim_loss: 26326205.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9482; val_auprc_score: 0.9295; val_best_acc_score: 0.8949; val_best_f1_score: 0.9011; train_kl_reg_loss: 58682.4625; train_edge_recon_loss: 582102.5189; train_gene_expr_recon_loss: 18931655.1212; train_masked_gp_l1_reg_loss: 81430.7389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86244.6955; train_chrom_access_recon_loss: 5873903.9167; train_global_loss: 25614019.4242; train_optim_loss: 25614019.4242; val_kl_reg_loss: 59250.5757; val_edge_recon_loss: 592726.2422; val_gene_expr_recon_loss: 19400529.2500; val_masked_gp_l1_reg_loss: 81993.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86564.0234; val_chrom_access_recon_loss: 5965247.9375; val_global_loss: 26186312.0000; val_optim_loss: 26186312.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9526; val_auprc_score: 0.9342; val_best_acc_score: 0.8982; val_best_f1_score: 0.9026; train_kl_reg_loss: 58642.6223; train_edge_recon_loss: 581495.4830; train_gene_expr_recon_loss: 18854033.4848; train_masked_gp_l1_reg_loss: 82567.7264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86324.5251; train_chrom_access_recon_loss: 5847039.0758; train_global_loss: 25510102.9394; train_optim_loss: 25510102.9394; val_kl_reg_loss: 59418.6772; val_edge_recon_loss: 591309.9922; val_gene_expr_recon_loss: 19163659.5000; val_masked_gp_l1_reg_loss: 83215.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86317.3125; val_chrom_access_recon_loss: 5933155.3125; val_global_loss: 25917077.7500; val_optim_loss: 25917077.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9505; val_auprc_score: 0.9326; val_best_acc_score: 0.8968; val_best_f1_score: 0.9024; train_kl_reg_loss: 58625.6761; train_edge_recon_loss: 583580.0227; train_gene_expr_recon_loss: 18808463.1212; train_masked_gp_l1_reg_loss: 83814.0964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86246.2305; train_chrom_access_recon_loss: 5832362.6742; train_global_loss: 25453091.7273; train_optim_loss: 25453091.7273; val_kl_reg_loss: 59632.7305; val_edge_recon_loss: 585870.9609; val_gene_expr_recon_loss: 19234966.0000; val_masked_gp_l1_reg_loss: 84336.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86635.4219; val_chrom_access_recon_loss: 5932132.3125; val_global_loss: 25983573.7500; val_optim_loss: 25983573.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9520; val_auprc_score: 0.9358; val_best_acc_score: 0.8982; val_best_f1_score: 0.9026; train_kl_reg_loss: 58843.6806; train_edge_recon_loss: 583287.7964; train_gene_expr_recon_loss: 18750208.2727; train_masked_gp_l1_reg_loss: 84889.3248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86286.1203; train_chrom_access_recon_loss: 5820378.8106; train_global_loss: 25383894.0909; train_optim_loss: 25383894.0909; val_kl_reg_loss: 58294.3340; val_edge_recon_loss: 587353.7188; val_gene_expr_recon_loss: 19170572.5000; val_masked_gp_l1_reg_loss: 85388.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86840.0781; val_chrom_access_recon_loss: 5890613.1250; val_global_loss: 25879062.0000; val_optim_loss: 25879062.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9560; val_auprc_score: 0.9416; val_best_acc_score: 0.8992; val_best_f1_score: 0.9042; train_kl_reg_loss: 59139.6387; train_edge_recon_loss: 582086.1922; train_gene_expr_recon_loss: 18706377.6061; train_masked_gp_l1_reg_loss: 85929.1444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86452.7876; train_chrom_access_recon_loss: 5806200.0606; train_global_loss: 25326185.1212; train_optim_loss: 25326185.1212; val_kl_reg_loss: 59855.5195; val_edge_recon_loss: 585956.4844; val_gene_expr_recon_loss: 19247525.5000; val_masked_gp_l1_reg_loss: 86411.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86673.2266; val_chrom_access_recon_loss: 5938062.2500; val_global_loss: 26004486.0000; val_optim_loss: 26004486.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9518; val_auprc_score: 0.9370; val_best_acc_score: 0.8984; val_best_f1_score: 0.9034; train_kl_reg_loss: 59719.4606; train_edge_recon_loss: 581305.9754; train_gene_expr_recon_loss: 18682859.4848; train_masked_gp_l1_reg_loss: 86925.1977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86471.0870; train_chrom_access_recon_loss: 5798715.9697; train_global_loss: 25295997.3939; train_optim_loss: 25295997.3939; val_kl_reg_loss: 60173.5933; val_edge_recon_loss: 588394.4922; val_gene_expr_recon_loss: 19160791.2500; val_masked_gp_l1_reg_loss: 87478.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86976.1250; val_chrom_access_recon_loss: 5935365.3750; val_global_loss: 25919178.7500; val_optim_loss: 25919178.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9580; val_auprc_score: 0.9438; val_best_acc_score: 0.9049; val_best_f1_score: 0.9100; train_kl_reg_loss: 59702.8439; train_edge_recon_loss: 582668.3722; train_gene_expr_recon_loss: 18627222.7576; train_masked_gp_l1_reg_loss: 87982.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86718.4808; train_chrom_access_recon_loss: 5780601.1818; train_global_loss: 25224896.0606; train_optim_loss: 25224896.0606; val_kl_reg_loss: 59875.6411; val_edge_recon_loss: 582718.2188; val_gene_expr_recon_loss: 19159640.2500; val_masked_gp_l1_reg_loss: 88469.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86485.7500; val_chrom_access_recon_loss: 5898492.4375; val_global_loss: 25875683.0000; val_optim_loss: 25875683.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9522; val_auprc_score: 0.9349; val_best_acc_score: 0.8955; val_best_f1_score: 0.9005; train_kl_reg_loss: 60056.0568; train_edge_recon_loss: 581857.1619; train_gene_expr_recon_loss: 18570162.4545; train_masked_gp_l1_reg_loss: 88898.6553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86662.0273; train_chrom_access_recon_loss: 5769363.3636; train_global_loss: 25156999.7273; train_optim_loss: 25156999.7273; val_kl_reg_loss: 60539.3511; val_edge_recon_loss: 588459.7344; val_gene_expr_recon_loss: 19212416.0000; val_masked_gp_l1_reg_loss: 89254.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86742.8750; val_chrom_access_recon_loss: 5961451.8750; val_global_loss: 25998862.7500; val_optim_loss: 25998862.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9499; val_auprc_score: 0.9284; val_best_acc_score: 0.8968; val_best_f1_score: 0.9005; train_kl_reg_loss: 63395.0865; train_edge_recon_loss: 583141.1051; train_gene_expr_recon_loss: 18602621.2424; train_masked_gp_l1_reg_loss: 89801.2118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87094.2652; train_chrom_access_recon_loss: 5778743.0000; train_global_loss: 25204796.1212; train_optim_loss: 25204796.1212; val_kl_reg_loss: 61612.2466; val_edge_recon_loss: 592009.2031; val_gene_expr_recon_loss: 18921670.2500; val_masked_gp_l1_reg_loss: 89997.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87464.3438; val_chrom_access_recon_loss: 5823180.6875; val_global_loss: 25575934.7500; val_optim_loss: 25575934.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9412; val_auprc_score: 0.9207; val_best_acc_score: 0.8864; val_best_f1_score: 0.8921; train_kl_reg_loss: 4655753.7477; train_edge_recon_loss: 605869.4422; train_gene_expr_recon_loss: 18998117.4545; train_masked_gp_l1_reg_loss: 89823.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91961.4611; train_chrom_access_recon_loss: 5929899.3864; train_global_loss: 30371424.8788; train_optim_loss: 30371424.8788; val_kl_reg_loss: 66335.1602; val_edge_recon_loss: 618755.4141; val_gene_expr_recon_loss: 19511903.5000; val_masked_gp_l1_reg_loss: 88108.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98523.8516; val_chrom_access_recon_loss: 6156018.6875; val_global_loss: 26539644.7500; val_optim_loss: 26539644.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9345; val_auprc_score: 0.9061; val_best_acc_score: 0.8804; val_best_f1_score: 0.8877; train_kl_reg_loss: 67877.3435; train_edge_recon_loss: 605887.7311; train_gene_expr_recon_loss: 19243263.1515; train_masked_gp_l1_reg_loss: 84928.6680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105025.7462; train_chrom_access_recon_loss: 6084494.2803; train_global_loss: 26191476.7273; train_optim_loss: 26191476.7273; val_kl_reg_loss: 68484.3999; val_edge_recon_loss: 609593.0859; val_gene_expr_recon_loss: 19334075.5000; val_masked_gp_l1_reg_loss: 81620.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96951.8125; val_chrom_access_recon_loss: 5995738.8750; val_global_loss: 26186463.7500; val_optim_loss: 26186463.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9439; val_auprc_score: 0.9218; val_best_acc_score: 0.8901; val_best_f1_score: 0.8968; train_kl_reg_loss: 70007.9492; train_edge_recon_loss: 593684.5445; train_gene_expr_recon_loss: 19061630.4545; train_masked_gp_l1_reg_loss: 80522.9854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92291.4422; train_chrom_access_recon_loss: 5968463.5076; train_global_loss: 25866600.7879; train_optim_loss: 25866600.7879; val_kl_reg_loss: 73530.4502; val_edge_recon_loss: 597891.2969; val_gene_expr_recon_loss: 19322945.2500; val_masked_gp_l1_reg_loss: 80454.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92080.9531; val_chrom_access_recon_loss: 5946435.1250; val_global_loss: 26113336.5000; val_optim_loss: 26113336.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9224; val_auprc_score: 0.8961; val_best_acc_score: 0.8665; val_best_f1_score: 0.8710; train_kl_reg_loss: 19036681680.5475; train_edge_recon_loss: 608459.4470; train_gene_expr_recon_loss: 19556863.0909; train_masked_gp_l1_reg_loss: 79633.7454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92491.5844; train_chrom_access_recon_loss: 6058163.5076; train_global_loss: 19063077363.3636; train_optim_loss: 19063077363.3636; val_kl_reg_loss: 133805.0234; val_edge_recon_loss: 721309.1172; val_gene_expr_recon_loss: 20040685.7500; val_masked_gp_l1_reg_loss: 79107.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106595.6875; val_chrom_access_recon_loss: 6246367.6250; val_global_loss: 27327871.5000; val_optim_loss: 27327871.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9289; val_auprc_score: 0.9082; val_best_acc_score: 0.8697; val_best_f1_score: 0.8784; train_kl_reg_loss: 224599.3891; train_edge_recon_loss: 679751.1098; train_gene_expr_recon_loss: 19445353.0606; train_masked_gp_l1_reg_loss: 77751.8965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84472.3176; train_chrom_access_recon_loss: 6070676.1439; train_global_loss: 26582603.5455; train_optim_loss: 26582603.5455; val_kl_reg_loss: 73111.2734; val_edge_recon_loss: 659016.8594; val_gene_expr_recon_loss: 19096905.2500; val_masked_gp_l1_reg_loss: 76594.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75503.3047; val_chrom_access_recon_loss: 5957773.1875; val_global_loss: 25938904.5000; val_optim_loss: 25938904.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9293; val_auprc_score: 0.9023; val_best_acc_score: 0.8724; val_best_f1_score: 0.8802; train_kl_reg_loss: 71302.1236; train_edge_recon_loss: 640987.2178; train_gene_expr_recon_loss: 19177721.8182; train_masked_gp_l1_reg_loss: 76014.1437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73475.9169; train_chrom_access_recon_loss: 6000001.7576; train_global_loss: 26039502.8485; train_optim_loss: 26039502.8485; val_kl_reg_loss: 67748.7285; val_edge_recon_loss: 636343.0938; val_gene_expr_recon_loss: 19172435.2500; val_masked_gp_l1_reg_loss: 75522.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71897.3281; val_chrom_access_recon_loss: 5924601.5625; val_global_loss: 25948549.0000; val_optim_loss: 25948549.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9286; val_auprc_score: 0.8984; val_best_acc_score: 0.8700; val_best_f1_score: 0.8780; train_kl_reg_loss: 70232.4339; train_edge_recon_loss: 624197.4583; train_gene_expr_recon_loss: 19256646.9394; train_masked_gp_l1_reg_loss: 75236.8479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70766.7417; train_chrom_access_recon_loss: 5976154.8106; train_global_loss: 26073235.4545; train_optim_loss: 26073235.4545; val_kl_reg_loss: 67004.3281; val_edge_recon_loss: 630349.7500; val_gene_expr_recon_loss: 19362111.5000; val_masked_gp_l1_reg_loss: 74977.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69844.6562; val_chrom_access_recon_loss: 6006113.9375; val_global_loss: 26210400.5000; val_optim_loss: 26210400.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9349; val_auprc_score: 0.9100; val_best_acc_score: 0.8794; val_best_f1_score: 0.8864; train_kl_reg_loss: 76907.1824; train_edge_recon_loss: 617620.4915; train_gene_expr_recon_loss: 19133836.5152; train_masked_gp_l1_reg_loss: 74758.4435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69131.6606; train_chrom_access_recon_loss: 5945563.2576; train_global_loss: 25917817.3636; train_optim_loss: 25917817.3636; val_kl_reg_loss: 65522.4692; val_edge_recon_loss: 618397.9297; val_gene_expr_recon_loss: 19332079.0000; val_masked_gp_l1_reg_loss: 74554.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68395.9297; val_chrom_access_recon_loss: 5973242.8750; val_global_loss: 26132192.2500; val_optim_loss: 26132192.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 55 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9509
val AUPRC score: 0.9363
val best accuracy score: 0.8947
val best F1 score: 0.8995
val target rna MSE score: 1.3453
val source rna MSE score: 0.7271
val target atac MSE score: 0.3338
val source atac MSE score: 0.1277
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
