[True]
Run timestamp: 10082023_214310_62.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_62']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6774; val_auprc_score: 0.7273; val_best_acc_score: 0.5016; val_best_f1_score: 0.6670; train_kl_reg_loss: 97696.2732; train_edge_recon_loss: 3712938.0019; train_gene_expr_recon_loss: 45734810.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1395431.5630; train_global_loss: 50940876.1832; train_optim_loss: 50940876.1832; val_kl_reg_loss: 179853.8057; val_edge_recon_loss: 4065347.5833; val_gene_expr_recon_loss: 39493080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1344114.2667; val_global_loss: 45082395.7333; val_optim_loss: 45082395.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7510; val_auprc_score: 0.7709; val_best_acc_score: 0.5705; val_best_f1_score: 0.6958; train_kl_reg_loss: 165606.8704; train_edge_recon_loss: 3627361.1565; train_gene_expr_recon_loss: 38349471.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1283679.8721; train_global_loss: 43426119.6336; train_optim_loss: 43426119.6336; val_kl_reg_loss: 173560.7083; val_edge_recon_loss: 4061653.7000; val_gene_expr_recon_loss: 37739586.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1315446.6833; val_global_loss: 43290247.4667; val_optim_loss: 43290247.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8209; val_auprc_score: 0.8255; val_best_acc_score: 0.7150; val_best_f1_score: 0.7544; train_kl_reg_loss: 165543.9070; train_edge_recon_loss: 3558523.2405; train_gene_expr_recon_loss: 37156296.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1265281.5887; train_global_loss: 42145644.7328; train_optim_loss: 42145644.7328; val_kl_reg_loss: 152999.4021; val_edge_recon_loss: 4046735.9000; val_gene_expr_recon_loss: 37172590.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1307214.1917; val_global_loss: 42679540.5333; val_optim_loss: 42679540.5333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8833; val_auprc_score: 0.8772; val_best_acc_score: 0.7575; val_best_f1_score: 0.7966; train_kl_reg_loss: 147426.4847; train_edge_recon_loss: 3536768.7805; train_gene_expr_recon_loss: 36730445.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1256520.1641; train_global_loss: 41671160.2443; train_optim_loss: 41671160.2443; val_kl_reg_loss: 141381.8563; val_edge_recon_loss: 3946903.4333; val_gene_expr_recon_loss: 36822923.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1294382.7417; val_global_loss: 42205590.9333; val_optim_loss: 42205590.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8775; val_auprc_score: 0.8667; val_best_acc_score: 0.7890; val_best_f1_score: 0.8068; train_kl_reg_loss: 124523.5854; train_edge_recon_loss: 3454057.0611; train_gene_expr_recon_loss: 36398984.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1249447.2777; train_global_loss: 41227011.9084; train_optim_loss: 41227011.9084; val_kl_reg_loss: 109508.3021; val_edge_recon_loss: 3407085.0667; val_gene_expr_recon_loss: 36429914.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1288116.5500; val_global_loss: 41234624.0000; val_optim_loss: 41234624.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8844; val_auprc_score: 0.8735; val_best_acc_score: 0.7866; val_best_f1_score: 0.8038; train_kl_reg_loss: 138248.2081; train_edge_recon_loss: 3110861.4733; train_gene_expr_recon_loss: 36212490.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1245446.2290; train_global_loss: 40707046.8702; train_optim_loss: 40707046.8702; val_kl_reg_loss: 151001.5802; val_edge_recon_loss: 3029269.1000; val_gene_expr_recon_loss: 36296924.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1287545.9833; val_global_loss: 40764741.3333; val_optim_loss: 40764741.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9022; val_auprc_score: 0.8921; val_best_acc_score: 0.8170; val_best_f1_score: 0.8307; train_kl_reg_loss: 155469.9593; train_edge_recon_loss: 3002210.0706; train_gene_expr_recon_loss: 35985008.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1239885.6498; train_global_loss: 40382574.3206; train_optim_loss: 40382574.3206; val_kl_reg_loss: 154624.7385; val_edge_recon_loss: 2992934.6667; val_gene_expr_recon_loss: 36077517.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1280632.3250; val_global_loss: 40505709.0667; val_optim_loss: 40505709.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9063; val_auprc_score: 0.8960; val_best_acc_score: 0.8242; val_best_f1_score: 0.8329; train_kl_reg_loss: 149983.0645; train_edge_recon_loss: 2972533.5515; train_gene_expr_recon_loss: 35738487.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1234081.3197; train_global_loss: 40095085.0687; train_optim_loss: 40095085.0687; val_kl_reg_loss: 145119.9917; val_edge_recon_loss: 2988924.8833; val_gene_expr_recon_loss: 36076726.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1279639.1583; val_global_loss: 40490409.3333; val_optim_loss: 40490409.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9111; val_auprc_score: 0.8950; val_best_acc_score: 0.8309; val_best_f1_score: 0.8427; train_kl_reg_loss: 143846.7347; train_edge_recon_loss: 2929632.3340; train_gene_expr_recon_loss: 35558284.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1229733.9342; train_global_loss: 39861497.2824; train_optim_loss: 39861497.2824; val_kl_reg_loss: 144680.8125; val_edge_recon_loss: 2923501.1167; val_gene_expr_recon_loss: 35779105.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1271485.5333; val_global_loss: 40118772.5333; val_optim_loss: 40118772.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9213; val_auprc_score: 0.9082; val_best_acc_score: 0.8468; val_best_f1_score: 0.8567; train_kl_reg_loss: 142625.5287; train_edge_recon_loss: 2896569.0267; train_gene_expr_recon_loss: 35461937.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227326.8760; train_global_loss: 39728459.2366; train_optim_loss: 39728459.2366; val_kl_reg_loss: 140176.2792; val_edge_recon_loss: 2896586.4667; val_gene_expr_recon_loss: 35666506.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1269233.4833; val_global_loss: 39972502.4000; val_optim_loss: 39972502.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9220; val_auprc_score: 0.9110; val_best_acc_score: 0.8434; val_best_f1_score: 0.8557; train_kl_reg_loss: 138427.5784; train_edge_recon_loss: 2882677.8435; train_gene_expr_recon_loss: 35277510.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222800.6250; train_global_loss: 39521416.2748; train_optim_loss: 39521416.2748; val_kl_reg_loss: 141545.5802; val_edge_recon_loss: 2883020.5833; val_gene_expr_recon_loss: 35515721.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1263722.9417; val_global_loss: 39804010.1333; val_optim_loss: 39804010.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9272; val_auprc_score: 0.9122; val_best_acc_score: 0.8556; val_best_f1_score: 0.8649; train_kl_reg_loss: 136754.0142; train_edge_recon_loss: 2855563.1126; train_gene_expr_recon_loss: 35190048.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220291.6145; train_global_loss: 39402657.6489; train_optim_loss: 39402657.6489; val_kl_reg_loss: 135616.3281; val_edge_recon_loss: 2854844.4833; val_gene_expr_recon_loss: 35475943.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1268780.8167; val_global_loss: 39735184.5333; val_optim_loss: 39735184.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9292; val_auprc_score: 0.9159; val_best_acc_score: 0.8560; val_best_f1_score: 0.8646; train_kl_reg_loss: 132358.8308; train_edge_recon_loss: 2850714.0115; train_gene_expr_recon_loss: 35105514.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218229.2710; train_global_loss: 39306816.4275; train_optim_loss: 39306816.4275; val_kl_reg_loss: 131425.7375; val_edge_recon_loss: 2859839.4833; val_gene_expr_recon_loss: 35368597.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1257342.5083; val_global_loss: 39617205.8667; val_optim_loss: 39617205.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9383; val_auprc_score: 0.9262; val_best_acc_score: 0.8708; val_best_f1_score: 0.8766; train_kl_reg_loss: 129509.4205; train_edge_recon_loss: 2833212.1336; train_gene_expr_recon_loss: 34991825.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1215798.8006; train_global_loss: 39170345.8321; train_optim_loss: 39170345.8321; val_kl_reg_loss: 126976.2734; val_edge_recon_loss: 2819418.1000; val_gene_expr_recon_loss: 35176674.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1256878.3083; val_global_loss: 39379946.9333; val_optim_loss: 39379946.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9428; val_auprc_score: 0.9317; val_best_acc_score: 0.8735; val_best_f1_score: 0.8811; train_kl_reg_loss: 124282.4937; train_edge_recon_loss: 2824395.8721; train_gene_expr_recon_loss: 34870528.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212719.4828; train_global_loss: 39031925.9542; train_optim_loss: 39031925.9542; val_kl_reg_loss: 119402.3240; val_edge_recon_loss: 2815991.7500; val_gene_expr_recon_loss: 35163842.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1251620.4083; val_global_loss: 39350856.5333; val_optim_loss: 39350856.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9396; val_auprc_score: 0.9296; val_best_acc_score: 0.8686; val_best_f1_score: 0.8756; train_kl_reg_loss: 121552.4209; train_edge_recon_loss: 2809328.0248; train_gene_expr_recon_loss: 34731036.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208219.2920; train_global_loss: 38870136.7939; train_optim_loss: 38870136.7939; val_kl_reg_loss: 119906.6885; val_edge_recon_loss: 2830651.2667; val_gene_expr_recon_loss: 35069129.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1253802.8083; val_global_loss: 39273491.2000; val_optim_loss: 39273491.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9508; val_auprc_score: 0.9433; val_best_acc_score: 0.8844; val_best_f1_score: 0.8893; train_kl_reg_loss: 117607.7031; train_edge_recon_loss: 2802469.2137; train_gene_expr_recon_loss: 34714683.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1209889.6746; train_global_loss: 38844650.6260; train_optim_loss: 38844650.6260; val_kl_reg_loss: 118087.1005; val_edge_recon_loss: 2777684.1833; val_gene_expr_recon_loss: 34885134.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248092.7500; val_global_loss: 39028997.6000; val_optim_loss: 39028997.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9530; val_auprc_score: 0.9463; val_best_acc_score: 0.8857; val_best_f1_score: 0.8897; train_kl_reg_loss: 116211.6032; train_edge_recon_loss: 2794352.6050; train_gene_expr_recon_loss: 34659521.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208245.1031; train_global_loss: 38778330.5344; train_optim_loss: 38778330.5344; val_kl_reg_loss: 114881.1010; val_edge_recon_loss: 2793201.7333; val_gene_expr_recon_loss: 34901446.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1253564.0083; val_global_loss: 39063092.8000; val_optim_loss: 39063092.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9504; val_auprc_score: 0.9404; val_best_acc_score: 0.8860; val_best_f1_score: 0.8907; train_kl_reg_loss: 112098.2372; train_edge_recon_loss: 2776883.7405; train_gene_expr_recon_loss: 34626420.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207860.7872; train_global_loss: 38723263.6336; train_optim_loss: 38723263.6336; val_kl_reg_loss: 112879.2922; val_edge_recon_loss: 2801683.3500; val_gene_expr_recon_loss: 34813222.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1250324.1000; val_global_loss: 38978108.8000; val_optim_loss: 38978108.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9526; val_auprc_score: 0.9448; val_best_acc_score: 0.8890; val_best_f1_score: 0.8940; train_kl_reg_loss: 111215.3369; train_edge_recon_loss: 2774574.1927; train_gene_expr_recon_loss: 34535128.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1206398.1479; train_global_loss: 38627316.6412; train_optim_loss: 38627316.6412; val_kl_reg_loss: 111663.5745; val_edge_recon_loss: 2794614.6667; val_gene_expr_recon_loss: 34888016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1250877.4250; val_global_loss: 39045172.0000; val_optim_loss: 39045172.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9594; val_auprc_score: 0.9516; val_best_acc_score: 0.8995; val_best_f1_score: 0.9041; train_kl_reg_loss: 110000.1947; train_edge_recon_loss: 2762628.2786; train_gene_expr_recon_loss: 34502696.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1205805.0448; train_global_loss: 38581130.2595; train_optim_loss: 38581130.2595; val_kl_reg_loss: 109078.3078; val_edge_recon_loss: 2763299.5167; val_gene_expr_recon_loss: 34795264.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1251797.4667; val_global_loss: 38919440.0000; val_optim_loss: 38919440.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9587; val_auprc_score: 0.9496; val_best_acc_score: 0.8979; val_best_f1_score: 0.9015; train_kl_reg_loss: 107809.8200; train_edge_recon_loss: 2752038.8282; train_gene_expr_recon_loss: 34476450.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1206539.3597; train_global_loss: 38542839.1145; train_optim_loss: 38542839.1145; val_kl_reg_loss: 108001.8323; val_edge_recon_loss: 2774108.0000; val_gene_expr_recon_loss: 34803903.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1250296.0417; val_global_loss: 38936309.3333; val_optim_loss: 38936309.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9635; val_auprc_score: 0.9559; val_best_acc_score: 0.9041; val_best_f1_score: 0.9077; train_kl_reg_loss: 106449.6597; train_edge_recon_loss: 2749756.2538; train_gene_expr_recon_loss: 34389520.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1202801.6393; train_global_loss: 38448528.8855; train_optim_loss: 38448528.8855; val_kl_reg_loss: 103487.2495; val_edge_recon_loss: 2745204.4000; val_gene_expr_recon_loss: 34658701.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1242697.6500; val_global_loss: 38750090.9333; val_optim_loss: 38750090.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9655; val_auprc_score: 0.9596; val_best_acc_score: 0.9093; val_best_f1_score: 0.9118; train_kl_reg_loss: 104260.4497; train_edge_recon_loss: 2749596.1966; train_gene_expr_recon_loss: 34372542.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1203984.4065; train_global_loss: 38430383.3588; train_optim_loss: 38430383.3588; val_kl_reg_loss: 104838.8271; val_edge_recon_loss: 2740960.6333; val_gene_expr_recon_loss: 34828456.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1249499.2750; val_global_loss: 38923755.4667; val_optim_loss: 38923755.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9650; val_auprc_score: 0.9548; val_best_acc_score: 0.9086; val_best_f1_score: 0.9112; train_kl_reg_loss: 103230.7657; train_edge_recon_loss: 2737108.5477; train_gene_expr_recon_loss: 34314059.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1203019.1240; train_global_loss: 38357417.7099; train_optim_loss: 38357417.7099; val_kl_reg_loss: 103816.9172; val_edge_recon_loss: 2758273.4000; val_gene_expr_recon_loss: 34524847.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1241684.5083; val_global_loss: 38628622.4000; val_optim_loss: 38628622.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9625; val_auprc_score: 0.9515; val_best_acc_score: 0.9064; val_best_f1_score: 0.9097; train_kl_reg_loss: 111687.8520; train_edge_recon_loss: 2790445.7786; train_gene_expr_recon_loss: 35517621.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1238626.2414; train_global_loss: 39658380.8855; train_optim_loss: 39658380.8855; val_kl_reg_loss: 59004.0510; val_edge_recon_loss: 2798502.8500; val_gene_expr_recon_loss: 35753746.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1274323.6167; val_global_loss: 39885577.8667; val_optim_loss: 39885577.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9664; val_auprc_score: 0.9561; val_best_acc_score: 0.9151; val_best_f1_score: 0.9169; train_kl_reg_loss: 111456.1791; train_edge_recon_loss: 2768297.7557; train_gene_expr_recon_loss: 35393792.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227238.1469; train_global_loss: 39500784.9160; train_optim_loss: 39500784.9160; val_kl_reg_loss: 61387.8607; val_edge_recon_loss: 2765893.6667; val_gene_expr_recon_loss: 35689769.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1268771.6167; val_global_loss: 39785822.4000; val_optim_loss: 39785822.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9670; val_auprc_score: 0.9564; val_best_acc_score: 0.9185; val_best_f1_score: 0.9207; train_kl_reg_loss: 104309.9190; train_edge_recon_loss: 2743816.2805; train_gene_expr_recon_loss: 35350471.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1225450.4370; train_global_loss: 39424048.0916; train_optim_loss: 39424048.0916; val_kl_reg_loss: 61854.0219; val_edge_recon_loss: 2738527.2000; val_gene_expr_recon_loss: 35611355.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1264335.1500; val_global_loss: 39676072.5333; val_optim_loss: 39676072.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9711; val_auprc_score: 0.9642; val_best_acc_score: 0.9193; val_best_f1_score: 0.9223; train_kl_reg_loss: 99735.4022; train_edge_recon_loss: 2739327.9008; train_gene_expr_recon_loss: 35247583.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222533.7968; train_global_loss: 39309180.5191; train_optim_loss: 39309180.5191; val_kl_reg_loss: 64623.3346; val_edge_recon_loss: 2752166.7000; val_gene_expr_recon_loss: 35497373.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1264490.3000; val_global_loss: 39578654.4000; val_optim_loss: 39578654.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9672; val_auprc_score: 0.9585; val_best_acc_score: 0.9136; val_best_f1_score: 0.9168; train_kl_reg_loss: 97254.3240; train_edge_recon_loss: 2728991.7748; train_gene_expr_recon_loss: 35145891.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220177.5973; train_global_loss: 39192315.3893; train_optim_loss: 39192315.3893; val_kl_reg_loss: 66462.6974; val_edge_recon_loss: 2741454.9833; val_gene_expr_recon_loss: 35309936.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1256679.3250; val_global_loss: 39374534.4000; val_optim_loss: 39374534.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9671; val_auprc_score: 0.9569; val_best_acc_score: 0.9192; val_best_f1_score: 0.9214; train_kl_reg_loss: 97921.2725; train_edge_recon_loss: 2730776.8664; train_gene_expr_recon_loss: 35163496.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1221152.1698; train_global_loss: 39213346.7176; train_optim_loss: 39213346.7176; val_kl_reg_loss: 67248.7922; val_edge_recon_loss: 2748066.5833; val_gene_expr_recon_loss: 35518988.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1261831.3500; val_global_loss: 39596134.9333; val_optim_loss: 39596134.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9683; val_auprc_score: 0.9609; val_best_acc_score: 0.9140; val_best_f1_score: 0.9175; train_kl_reg_loss: 97429.8865; train_edge_recon_loss: 2726582.1756; train_gene_expr_recon_loss: 35100941.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218870.2863; train_global_loss: 39143823.2977; train_optim_loss: 39143823.2977; val_kl_reg_loss: 67762.7042; val_edge_recon_loss: 2733493.9833; val_gene_expr_recon_loss: 35458969.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1262570.2833; val_global_loss: 39522796.2667; val_optim_loss: 39522796.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9702; val_auprc_score: 0.9625; val_best_acc_score: 0.9158; val_best_f1_score: 0.9193; train_kl_reg_loss: 96797.7258; train_edge_recon_loss: 2732493.4294; train_gene_expr_recon_loss: 35120945.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219377.5258; train_global_loss: 39169614.5038; train_optim_loss: 39169614.5038; val_kl_reg_loss: 68163.3719; val_edge_recon_loss: 2731196.2000; val_gene_expr_recon_loss: 35520111.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1264936.0000; val_global_loss: 39584408.0000; val_optim_loss: 39584408.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 49 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9689
val AUPRC score: 0.9624
val best accuracy score: 0.9162
val best F1 score: 0.9186
val target rna MSE score: 1.2020
val source rna MSE score: 21.7591
val target atac MSE score: 0.6357
val source atac MSE score: 8.5921
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
