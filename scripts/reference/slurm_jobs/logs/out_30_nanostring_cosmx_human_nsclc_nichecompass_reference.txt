[True, False, True]
Run timestamp: 06102023_213457_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.0', '--lambda_gene_expr_recon', '3000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9173; val_auprc_score: 0.9821; val_best_acc_score: 0.9140; val_best_f1_score: 0.9509; train_kl_reg_loss: 12163.3470; train_edge_recon_loss: 816905.8508; train_gene_expr_recon_loss: 2735860.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564929.6262; train_optim_loss: 3564929.6262; val_kl_reg_loss: 13480.4668; val_edge_recon_loss: 828529.3031; val_gene_expr_recon_loss: 2430026.1093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272035.8816; val_optim_loss: 3272035.8816
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9345; val_auprc_score: 0.9858; val_best_acc_score: 0.9239; val_best_f1_score: 0.9564; train_kl_reg_loss: 14348.7390; train_edge_recon_loss: 794629.1369; train_gene_expr_recon_loss: 2283801.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3092779.8433; train_optim_loss: 3092779.8433; val_kl_reg_loss: 15381.7599; val_edge_recon_loss: 822917.9793; val_gene_expr_recon_loss: 2183271.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3021571.0729; val_optim_loss: 3021571.0729
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9453; val_auprc_score: 0.9882; val_best_acc_score: 0.9322; val_best_f1_score: 0.9609; train_kl_reg_loss: 15668.7259; train_edge_recon_loss: 786142.8143; train_gene_expr_recon_loss: 2134180.8998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2935992.4391; train_optim_loss: 2935992.4391; val_kl_reg_loss: 16210.1539; val_edge_recon_loss: 814002.4327; val_gene_expr_recon_loss: 2103029.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2933242.0273; val_optim_loss: 2933242.0273
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9477; val_auprc_score: 0.9886; val_best_acc_score: 0.9344; val_best_f1_score: 0.9622; train_kl_reg_loss: 16589.8361; train_edge_recon_loss: 785568.8925; train_gene_expr_recon_loss: 2081546.7798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2883705.5088; train_optim_loss: 2883705.5088; val_kl_reg_loss: 17032.5888; val_edge_recon_loss: 810127.3689; val_gene_expr_recon_loss: 2067514.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2894674.1093; val_optim_loss: 2894674.1093
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9473; val_auprc_score: 0.9887; val_best_acc_score: 0.9333; val_best_f1_score: 0.9616; train_kl_reg_loss: 17068.8180; train_edge_recon_loss: 784618.8943; train_gene_expr_recon_loss: 2053232.5609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2854920.2744; train_optim_loss: 2854920.2744; val_kl_reg_loss: 17466.0974; val_edge_recon_loss: 820902.4089; val_gene_expr_recon_loss: 2048552.6371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2886921.1397; val_optim_loss: 2886921.1397
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9462; val_auprc_score: 0.9882; val_best_acc_score: 0.9338; val_best_f1_score: 0.9618; train_kl_reg_loss: 17512.8814; train_edge_recon_loss: 783407.7969; train_gene_expr_recon_loss: 2036136.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2837056.9072; train_optim_loss: 2837056.9072; val_kl_reg_loss: 17859.9511; val_edge_recon_loss: 814214.7523; val_gene_expr_recon_loss: 2034104.5324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2866179.2308; val_optim_loss: 2866179.2308
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9500; val_auprc_score: 0.9893; val_best_acc_score: 0.9366; val_best_f1_score: 0.9635; train_kl_reg_loss: 17806.2626; train_edge_recon_loss: 784849.0752; train_gene_expr_recon_loss: 2020939.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2823594.7638; train_optim_loss: 2823594.7638; val_kl_reg_loss: 18078.9593; val_edge_recon_loss: 805445.0848; val_gene_expr_recon_loss: 2023625.1847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2847149.2277; val_optim_loss: 2847149.2277
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9473; val_auprc_score: 0.9884; val_best_acc_score: 0.9349; val_best_f1_score: 0.9624; train_kl_reg_loss: 18193.1572; train_edge_recon_loss: 785002.9068; train_gene_expr_recon_loss: 2010873.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2814069.6137; train_optim_loss: 2814069.6137; val_kl_reg_loss: 18383.2760; val_edge_recon_loss: 816150.2540; val_gene_expr_recon_loss: 2009491.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2844025.0253; val_optim_loss: 2844025.0253
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9520; val_auprc_score: 0.9897; val_best_acc_score: 0.9376; val_best_f1_score: 0.9639; train_kl_reg_loss: 18445.3760; train_edge_recon_loss: 784512.1539; train_gene_expr_recon_loss: 1998399.5650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2801357.0938; train_optim_loss: 2801357.0938; val_kl_reg_loss: 18880.8792; val_edge_recon_loss: 811704.3993; val_gene_expr_recon_loss: 1996154.9661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2826740.2551; val_optim_loss: 2826740.2551
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9494; val_auprc_score: 0.9889; val_best_acc_score: 0.9362; val_best_f1_score: 0.9632; train_kl_reg_loss: 18745.5519; train_edge_recon_loss: 780759.8687; train_gene_expr_recon_loss: 1990280.2068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789785.6271; train_optim_loss: 2789785.6271; val_kl_reg_loss: 18838.5832; val_edge_recon_loss: 812587.3677; val_gene_expr_recon_loss: 1993374.0040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2824799.9484; val_optim_loss: 2824799.9484
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9511; val_auprc_score: 0.9894; val_best_acc_score: 0.9388; val_best_f1_score: 0.9647; train_kl_reg_loss: 19040.0688; train_edge_recon_loss: 783473.6066; train_gene_expr_recon_loss: 1981518.0379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2784031.7167; train_optim_loss: 2784031.7167; val_kl_reg_loss: 19279.3505; val_edge_recon_loss: 807884.4706; val_gene_expr_recon_loss: 1987668.7313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814832.5486; val_optim_loss: 2814832.5486
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9540; val_auprc_score: 0.9902; val_best_acc_score: 0.9390; val_best_f1_score: 0.9649; train_kl_reg_loss: 19427.1834; train_edge_recon_loss: 784690.1733; train_gene_expr_recon_loss: 2011554.6617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2815672.0194; train_optim_loss: 2815672.0194; val_kl_reg_loss: 19805.4564; val_edge_recon_loss: 806725.9615; val_gene_expr_recon_loss: 1992838.4899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2819369.9130; val_optim_loss: 2819369.9130
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9526; val_auprc_score: 0.9897; val_best_acc_score: 0.9395; val_best_f1_score: 0.9650; train_kl_reg_loss: 19820.1448; train_edge_recon_loss: 783866.5531; train_gene_expr_recon_loss: 1973774.5343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2777461.2297; train_optim_loss: 2777461.2297; val_kl_reg_loss: 19644.5334; val_edge_recon_loss: 815926.1359; val_gene_expr_recon_loss: 1974138.5202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2809709.1832; val_optim_loss: 2809709.1832
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9544; val_auprc_score: 0.9902; val_best_acc_score: 0.9397; val_best_f1_score: 0.9651; train_kl_reg_loss: 19612.2301; train_edge_recon_loss: 784769.6873; train_gene_expr_recon_loss: 1965816.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2770198.7520; train_optim_loss: 2770198.7520; val_kl_reg_loss: 19956.0923; val_edge_recon_loss: 816245.4064; val_gene_expr_recon_loss: 1973736.1837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2809937.6852; val_optim_loss: 2809937.6852
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9554; val_auprc_score: 0.9903; val_best_acc_score: 0.9415; val_best_f1_score: 0.9663; train_kl_reg_loss: 19863.9645; train_edge_recon_loss: 784310.9926; train_gene_expr_recon_loss: 1962847.9602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2767022.9165; train_optim_loss: 2767022.9165; val_kl_reg_loss: 19484.8272; val_edge_recon_loss: 807559.8345; val_gene_expr_recon_loss: 1963948.3052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2790992.9636; val_optim_loss: 2790992.9636
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9517; val_auprc_score: 0.9894; val_best_acc_score: 0.9398; val_best_f1_score: 0.9652; train_kl_reg_loss: 19912.6483; train_edge_recon_loss: 782568.0250; train_gene_expr_recon_loss: 1958485.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2760965.8350; train_optim_loss: 2760965.8350; val_kl_reg_loss: 20289.9133; val_edge_recon_loss: 812861.2695; val_gene_expr_recon_loss: 1966007.9124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2799159.0800; val_optim_loss: 2799159.0800
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9551; val_auprc_score: 0.9902; val_best_acc_score: 0.9409; val_best_f1_score: 0.9658; train_kl_reg_loss: 20002.9669; train_edge_recon_loss: 782237.0205; train_gene_expr_recon_loss: 1955197.3079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2757437.2931; train_optim_loss: 2757437.2931; val_kl_reg_loss: 20128.4387; val_edge_recon_loss: 813778.4415; val_gene_expr_recon_loss: 1957894.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2791801.7621; val_optim_loss: 2791801.7621
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9504; val_auprc_score: 0.9890; val_best_acc_score: 0.9379; val_best_f1_score: 0.9641; train_kl_reg_loss: 16850.1637; train_edge_recon_loss: 792133.4985; train_gene_expr_recon_loss: 2426209.4473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235193.1102; train_optim_loss: 3235193.1102; val_kl_reg_loss: 18338.6674; val_edge_recon_loss: 814915.2586; val_gene_expr_recon_loss: 2122260.1235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2955514.0557; val_optim_loss: 2955514.0557
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9554; val_auprc_score: 0.9904; val_best_acc_score: 0.9417; val_best_f1_score: 0.9663; train_kl_reg_loss: 18909.3449; train_edge_recon_loss: 780239.7044; train_gene_expr_recon_loss: 2057172.2293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2856321.2787; train_optim_loss: 2856321.2787; val_kl_reg_loss: 19448.7345; val_edge_recon_loss: 807537.1225; val_gene_expr_recon_loss: 2024414.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2851399.9980; val_optim_loss: 2851399.9980

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9563; val_auprc_score: 0.9905; val_best_acc_score: 0.9420; val_best_f1_score: 0.9665; train_kl_reg_loss: 19113.5096; train_edge_recon_loss: 780922.8414; train_gene_expr_recon_loss: 1990359.8274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2790396.1816; train_optim_loss: 2790396.1816; val_kl_reg_loss: 19241.9940; val_edge_recon_loss: 809867.2113; val_gene_expr_recon_loss: 1993380.9565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2822490.1609; val_optim_loss: 2822490.1609
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9570; val_auprc_score: 0.9907; val_best_acc_score: 0.9431; val_best_f1_score: 0.9672; train_kl_reg_loss: 19227.2160; train_edge_recon_loss: 780999.7114; train_gene_expr_recon_loss: 1977008.2086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2777235.1332; train_optim_loss: 2777235.1332; val_kl_reg_loss: 19422.3750; val_edge_recon_loss: 801558.5820; val_gene_expr_recon_loss: 1981283.0400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802263.9939; val_optim_loss: 2802263.9939
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9580; val_auprc_score: 0.9912; val_best_acc_score: 0.9431; val_best_f1_score: 0.9671; train_kl_reg_loss: 19182.1196; train_edge_recon_loss: 777424.9738; train_gene_expr_recon_loss: 1963158.8665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2759765.9624; train_optim_loss: 2759765.9624; val_kl_reg_loss: 19383.6046; val_edge_recon_loss: 806379.2745; val_gene_expr_recon_loss: 1965770.0992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2791532.9727; val_optim_loss: 2791532.9727
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9588; val_auprc_score: 0.9910; val_best_acc_score: 0.9436; val_best_f1_score: 0.9673; train_kl_reg_loss: 19196.6744; train_edge_recon_loss: 778980.6523; train_gene_expr_recon_loss: 1948385.1856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2746562.5137; train_optim_loss: 2746562.5137; val_kl_reg_loss: 19427.6074; val_edge_recon_loss: 813836.3396; val_gene_expr_recon_loss: 1951208.3583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2784472.3016; val_optim_loss: 2784472.3016
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9580; val_auprc_score: 0.9910; val_best_acc_score: 0.9428; val_best_f1_score: 0.9668; train_kl_reg_loss: 19299.2209; train_edge_recon_loss: 779919.1851; train_gene_expr_recon_loss: 1936831.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2736050.3478; train_optim_loss: 2736050.3478; val_kl_reg_loss: 19389.2941; val_edge_recon_loss: 817387.7654; val_gene_expr_recon_loss: 1939866.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2776643.6022; val_optim_loss: 2776643.6022
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9601; val_auprc_score: 0.9915; val_best_acc_score: 0.9432; val_best_f1_score: 0.9670; train_kl_reg_loss: 19245.1780; train_edge_recon_loss: 779152.6199; train_gene_expr_recon_loss: 1928255.6521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2726653.4534; train_optim_loss: 2726653.4534; val_kl_reg_loss: 19318.9562; val_edge_recon_loss: 814241.9593; val_gene_expr_recon_loss: 1934970.9631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2768531.8775; val_optim_loss: 2768531.8775
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9544; val_auprc_score: 0.9901; val_best_acc_score: 0.9406; val_best_f1_score: 0.9657; train_kl_reg_loss: 17121.5455; train_edge_recon_loss: 785481.5587; train_gene_expr_recon_loss: 1757511.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2560114.9810; train_optim_loss: 2560114.9810; val_kl_reg_loss: 9672.2835; val_edge_recon_loss: 819538.4398; val_gene_expr_recon_loss: 1740575.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2569786.3674; val_optim_loss: 2569786.3674
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9535; val_auprc_score: 0.9901; val_best_acc_score: 0.9395; val_best_f1_score: 0.9651; train_kl_reg_loss: 16715.4297; train_edge_recon_loss: 784159.3718; train_gene_expr_recon_loss: 1723375.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2524250.0896; train_optim_loss: 2524250.0896; val_kl_reg_loss: 9654.9203; val_edge_recon_loss: 811283.4094; val_gene_expr_recon_loss: 1707334.6923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2528273.0223; val_optim_loss: 2528273.0223
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9533; val_auprc_score: 0.9898; val_best_acc_score: 0.9395; val_best_f1_score: 0.9650; train_kl_reg_loss: 15534.1886; train_edge_recon_loss: 780991.1965; train_gene_expr_recon_loss: 1695631.8390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2492157.2279; train_optim_loss: 2492157.2279; val_kl_reg_loss: 10119.7890; val_edge_recon_loss: 817967.8036; val_gene_expr_recon_loss: 1695428.8618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2523516.4524; val_optim_loss: 2523516.4524
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9544; val_auprc_score: 0.9901; val_best_acc_score: 0.9402; val_best_f1_score: 0.9654; train_kl_reg_loss: 14204.0454; train_edge_recon_loss: 784031.8901; train_gene_expr_recon_loss: 1686425.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2484661.2401; train_optim_loss: 2484661.2401; val_kl_reg_loss: 10526.7309; val_edge_recon_loss: 820584.8778; val_gene_expr_recon_loss: 1689767.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2520879.0891; val_optim_loss: 2520879.0891
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9545; val_auprc_score: 0.9903; val_best_acc_score: 0.9412; val_best_f1_score: 0.9661; train_kl_reg_loss: 13331.6895; train_edge_recon_loss: 780040.0723; train_gene_expr_recon_loss: 1680667.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2474038.7893; train_optim_loss: 2474038.7893; val_kl_reg_loss: 10636.2924; val_edge_recon_loss: 800281.5628; val_gene_expr_recon_loss: 1683158.8851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2494076.7368; val_optim_loss: 2494076.7368
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9548; val_auprc_score: 0.9903; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 12979.0371; train_edge_recon_loss: 781592.6002; train_gene_expr_recon_loss: 1674666.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2469237.7976; train_optim_loss: 2469237.7976; val_kl_reg_loss: 10872.0077; val_edge_recon_loss: 807627.1303; val_gene_expr_recon_loss: 1679059.8305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2497558.9706; val_optim_loss: 2497558.9706
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9546; val_auprc_score: 0.9900; val_best_acc_score: 0.9404; val_best_f1_score: 0.9655; train_kl_reg_loss: 12833.3372; train_edge_recon_loss: 782962.6317; train_gene_expr_recon_loss: 1669535.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2465331.2556; train_optim_loss: 2465331.2556; val_kl_reg_loss: 10946.2576; val_edge_recon_loss: 816182.2776; val_gene_expr_recon_loss: 1669020.7460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2496149.2844; val_optim_loss: 2496149.2844
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9572; val_auprc_score: 0.9908; val_best_acc_score: 0.9417; val_best_f1_score: 0.9662; train_kl_reg_loss: 12727.3686; train_edge_recon_loss: 780615.4404; train_gene_expr_recon_loss: 1662631.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2455974.4156; train_optim_loss: 2455974.4156; val_kl_reg_loss: 11237.3805; val_edge_recon_loss: 809584.0908; val_gene_expr_recon_loss: 1666819.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2487640.7733; val_optim_loss: 2487640.7733
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9551; val_auprc_score: 0.9903; val_best_acc_score: 0.9406; val_best_f1_score: 0.9657; train_kl_reg_loss: 12532.0297; train_edge_recon_loss: 778568.2720; train_gene_expr_recon_loss: 1659196.1051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2450296.4073; train_optim_loss: 2450296.4073; val_kl_reg_loss: 11367.3823; val_edge_recon_loss: 811221.3763; val_gene_expr_recon_loss: 1662832.1791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2485420.9383; val_optim_loss: 2485420.9383
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9563; val_auprc_score: 0.9905; val_best_acc_score: 0.9420; val_best_f1_score: 0.9664; train_kl_reg_loss: 12473.9612; train_edge_recon_loss: 781656.1846; train_gene_expr_recon_loss: 1656076.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2450206.9402; train_optim_loss: 2450206.9402; val_kl_reg_loss: 11584.7305; val_edge_recon_loss: 805359.1931; val_gene_expr_recon_loss: 1660153.2237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477097.1528; val_optim_loss: 2477097.1528
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9556; val_auprc_score: 0.9904; val_best_acc_score: 0.9413; val_best_f1_score: 0.9661; train_kl_reg_loss: 12438.1634; train_edge_recon_loss: 779975.2862; train_gene_expr_recon_loss: 1653634.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2446047.8701; train_optim_loss: 2446047.8701; val_kl_reg_loss: 11771.5737; val_edge_recon_loss: 806347.3712; val_gene_expr_recon_loss: 1657349.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2475468.5870; val_optim_loss: 2475468.5870
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9578; val_auprc_score: 0.9910; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 12409.6000; train_edge_recon_loss: 777647.6603; train_gene_expr_recon_loss: 1651956.4264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2442013.6855; train_optim_loss: 2442013.6855; val_kl_reg_loss: 11812.3960; val_edge_recon_loss: 807053.6822; val_gene_expr_recon_loss: 1658200.9216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477066.9939; val_optim_loss: 2477066.9939
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9575; val_auprc_score: 0.9910; val_best_acc_score: 0.9424; val_best_f1_score: 0.9668; train_kl_reg_loss: 12378.2900; train_edge_recon_loss: 779429.3676; train_gene_expr_recon_loss: 1651175.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2442983.0146; train_optim_loss: 2442983.0146; val_kl_reg_loss: 11768.4660; val_edge_recon_loss: 798460.0531; val_gene_expr_recon_loss: 1657446.2864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2467674.8138; val_optim_loss: 2467674.8138
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9562; val_auprc_score: 0.9905; val_best_acc_score: 0.9419; val_best_f1_score: 0.9665; train_kl_reg_loss: 12322.7976; train_edge_recon_loss: 778581.1923; train_gene_expr_recon_loss: 1649080.7375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2439984.7281; train_optim_loss: 2439984.7281; val_kl_reg_loss: 11790.9223; val_edge_recon_loss: 810301.1253; val_gene_expr_recon_loss: 1655572.4124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477664.4565; val_optim_loss: 2477664.4565
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9572; val_auprc_score: 0.9907; val_best_acc_score: 0.9421; val_best_f1_score: 0.9665; train_kl_reg_loss: 12331.3714; train_edge_recon_loss: 777818.4547; train_gene_expr_recon_loss: 1647119.2762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2437269.1045; train_optim_loss: 2437269.1045; val_kl_reg_loss: 11944.5946; val_edge_recon_loss: 807239.4765; val_gene_expr_recon_loss: 1653361.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2472545.5547; val_optim_loss: 2472545.5547
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9568; val_auprc_score: 0.9906; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 12358.9642; train_edge_recon_loss: 776343.7707; train_gene_expr_recon_loss: 1645576.0016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2434278.7331; train_optim_loss: 2434278.7331; val_kl_reg_loss: 12097.9914; val_edge_recon_loss: 810139.7748; val_gene_expr_recon_loss: 1651934.1554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2474171.9211; val_optim_loss: 2474171.9211
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9567; val_auprc_score: 0.9908; val_best_acc_score: 0.9431; val_best_f1_score: 0.9671; train_kl_reg_loss: 12351.7845; train_edge_recon_loss: 779454.3033; train_gene_expr_recon_loss: 1643621.9977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2435428.0869; train_optim_loss: 2435428.0869; val_kl_reg_loss: 12084.6894; val_edge_recon_loss: 801845.3178; val_gene_expr_recon_loss: 1649005.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2462935.7217; val_optim_loss: 2462935.7217
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9585; val_auprc_score: 0.9911; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 12353.4670; train_edge_recon_loss: 779582.0823; train_gene_expr_recon_loss: 1642856.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2434792.0864; train_optim_loss: 2434792.0864; val_kl_reg_loss: 12001.0865; val_edge_recon_loss: 813471.2308; val_gene_expr_recon_loss: 1650467.2794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2475939.6012; val_optim_loss: 2475939.6012
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9565; val_auprc_score: 0.9906; val_best_acc_score: 0.9420; val_best_f1_score: 0.9664; train_kl_reg_loss: 12354.1664; train_edge_recon_loss: 776295.7590; train_gene_expr_recon_loss: 1642160.0239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2430809.9470; train_optim_loss: 2430809.9470; val_kl_reg_loss: 12018.4678; val_edge_recon_loss: 812029.0273; val_gene_expr_recon_loss: 1647729.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2471776.6913; val_optim_loss: 2471776.6913
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9556; val_auprc_score: 0.9904; val_best_acc_score: 0.9415; val_best_f1_score: 0.9662; train_kl_reg_loss: 12415.1058; train_edge_recon_loss: 778823.1867; train_gene_expr_recon_loss: 1640348.9822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2431587.2745; train_optim_loss: 2431587.2745; val_kl_reg_loss: 12051.8526; val_edge_recon_loss: 808734.9608; val_gene_expr_recon_loss: 1647008.7844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2467795.6083; val_optim_loss: 2467795.6083
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9578; val_auprc_score: 0.9908; val_best_acc_score: 0.9432; val_best_f1_score: 0.9670; train_kl_reg_loss: 12365.7481; train_edge_recon_loss: 778370.0635; train_gene_expr_recon_loss: 1640066.7340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2430802.5469; train_optim_loss: 2430802.5469; val_kl_reg_loss: 12086.0888; val_edge_recon_loss: 812084.0873; val_gene_expr_recon_loss: 1647853.9499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2472024.1255; val_optim_loss: 2472024.1255

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9581; val_auprc_score: 0.9909; val_best_acc_score: 0.9429; val_best_f1_score: 0.9669; train_kl_reg_loss: 12334.8084; train_edge_recon_loss: 778731.3750; train_gene_expr_recon_loss: 1637153.8159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2428219.9950; train_optim_loss: 2428219.9950; val_kl_reg_loss: 12077.8901; val_edge_recon_loss: 809174.4671; val_gene_expr_recon_loss: 1642060.8507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2463313.2055; val_optim_loss: 2463313.2055
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9561; val_auprc_score: 0.9902; val_best_acc_score: 0.9427; val_best_f1_score: 0.9668; train_kl_reg_loss: 12323.5518; train_edge_recon_loss: 776397.7866; train_gene_expr_recon_loss: 1636843.5014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2425564.8388; train_optim_loss: 2425564.8388; val_kl_reg_loss: 12050.3627; val_edge_recon_loss: 812139.1622; val_gene_expr_recon_loss: 1644614.4803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2468804.0071; val_optim_loss: 2468804.0071
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9569; val_auprc_score: 0.9907; val_best_acc_score: 0.9429; val_best_f1_score: 0.9669; train_kl_reg_loss: 12307.6042; train_edge_recon_loss: 777841.1484; train_gene_expr_recon_loss: 1636305.6975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2426454.4492; train_optim_loss: 2426454.4492; val_kl_reg_loss: 12052.0375; val_edge_recon_loss: 807269.4706; val_gene_expr_recon_loss: 1644034.5435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2463356.0526; val_optim_loss: 2463356.0526
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9567; val_auprc_score: 0.9907; val_best_acc_score: 0.9428; val_best_f1_score: 0.9670; train_kl_reg_loss: 12299.1177; train_edge_recon_loss: 776269.6731; train_gene_expr_recon_loss: 1636122.9956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424691.7863; train_optim_loss: 2424691.7863; val_kl_reg_loss: 12043.0264; val_edge_recon_loss: 806636.3462; val_gene_expr_recon_loss: 1643246.2991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2461925.6721; val_optim_loss: 2461925.6721
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9571; val_auprc_score: 0.9906; val_best_acc_score: 0.9427; val_best_f1_score: 0.9669; train_kl_reg_loss: 12286.2753; train_edge_recon_loss: 780560.6744; train_gene_expr_recon_loss: 1635773.8185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2428620.7662; train_optim_loss: 2428620.7662; val_kl_reg_loss: 12046.0177; val_edge_recon_loss: 805605.6026; val_gene_expr_recon_loss: 1644679.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2462331.1933; val_optim_loss: 2462331.1933
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9583; val_auprc_score: 0.9909; val_best_acc_score: 0.9435; val_best_f1_score: 0.9673; train_kl_reg_loss: 12295.3763; train_edge_recon_loss: 776719.8846; train_gene_expr_recon_loss: 1636177.3753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2425192.6355; train_optim_loss: 2425192.6355; val_kl_reg_loss: 12062.6106; val_edge_recon_loss: 814034.9691; val_gene_expr_recon_loss: 1644358.4919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2470456.0729; val_optim_loss: 2470456.0729
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9587; val_auprc_score: 0.9909; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 12287.6502; train_edge_recon_loss: 777499.0190; train_gene_expr_recon_loss: 1636179.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2425965.7670; train_optim_loss: 2425965.7670; val_kl_reg_loss: 12059.3822; val_edge_recon_loss: 808217.2642; val_gene_expr_recon_loss: 1642499.5066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2462776.1609; val_optim_loss: 2462776.1609
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9587; val_auprc_score: 0.9911; val_best_acc_score: 0.9432; val_best_f1_score: 0.9671; train_kl_reg_loss: 12295.1961; train_edge_recon_loss: 777979.6834; train_gene_expr_recon_loss: 1636171.2863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2426446.1664; train_optim_loss: 2426446.1664; val_kl_reg_loss: 12067.0939; val_edge_recon_loss: 807682.5941; val_gene_expr_recon_loss: 1641623.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2461372.9636; val_optim_loss: 2461372.9636
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9579; val_auprc_score: 0.9909; val_best_acc_score: 0.9435; val_best_f1_score: 0.9673; train_kl_reg_loss: 12292.2493; train_edge_recon_loss: 779624.9066; train_gene_expr_recon_loss: 1635729.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2427646.5065; train_optim_loss: 2427646.5065; val_kl_reg_loss: 12085.7587; val_edge_recon_loss: 805132.2257; val_gene_expr_recon_loss: 1644823.2799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2462041.2621; val_optim_loss: 2462041.2621
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9908; val_best_acc_score: 0.9439; val_best_f1_score: 0.9676; train_kl_reg_loss: 12277.2480; train_edge_recon_loss: 777467.1078; train_gene_expr_recon_loss: 1635041.2574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424785.6135; train_optim_loss: 2424785.6135; val_kl_reg_loss: 12074.0580; val_edge_recon_loss: 798133.9486; val_gene_expr_recon_loss: 1642051.1857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2452259.1913; val_optim_loss: 2452259.1913
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9573; val_auprc_score: 0.9906; val_best_acc_score: 0.9431; val_best_f1_score: 0.9671; train_kl_reg_loss: 12275.3593; train_edge_recon_loss: 780138.7584; train_gene_expr_recon_loss: 1634977.9127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2427392.0299; train_optim_loss: 2427392.0299; val_kl_reg_loss: 12095.3135; val_edge_recon_loss: 805429.5433; val_gene_expr_recon_loss: 1642304.5931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2459829.4504; val_optim_loss: 2459829.4504
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9572; val_auprc_score: 0.9907; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 12281.3296; train_edge_recon_loss: 777041.6783; train_gene_expr_recon_loss: 1634931.4695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424254.4760; train_optim_loss: 2424254.4760; val_kl_reg_loss: 12074.1632; val_edge_recon_loss: 813454.4881; val_gene_expr_recon_loss: 1642414.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2467943.0536; val_optim_loss: 2467943.0536
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9593; val_auprc_score: 0.9914; val_best_acc_score: 0.9449; val_best_f1_score: 0.9682; train_kl_reg_loss: 12278.9669; train_edge_recon_loss: 775747.8875; train_gene_expr_recon_loss: 1635127.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2423154.7116; train_optim_loss: 2423154.7116; val_kl_reg_loss: 12088.3982; val_edge_recon_loss: 795822.2391; val_gene_expr_recon_loss: 1642834.3381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2450744.9706; val_optim_loss: 2450744.9706
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9594; val_auprc_score: 0.9913; val_best_acc_score: 0.9438; val_best_f1_score: 0.9676; train_kl_reg_loss: 12299.1551; train_edge_recon_loss: 777413.7441; train_gene_expr_recon_loss: 1634853.9294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424566.8283; train_optim_loss: 2424566.8283; val_kl_reg_loss: 12119.2529; val_edge_recon_loss: 803986.1518; val_gene_expr_recon_loss: 1640632.7804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2456738.1832; val_optim_loss: 2456738.1832
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9584; val_auprc_score: 0.9911; val_best_acc_score: 0.9439; val_best_f1_score: 0.9675; train_kl_reg_loss: 12296.7038; train_edge_recon_loss: 778542.6653; train_gene_expr_recon_loss: 1635141.6442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2425981.0137; train_optim_loss: 2425981.0137; val_kl_reg_loss: 12106.3607; val_edge_recon_loss: 801343.2406; val_gene_expr_recon_loss: 1640575.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2454024.9464; val_optim_loss: 2454024.9464
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9569; val_auprc_score: 0.9908; val_best_acc_score: 0.9427; val_best_f1_score: 0.9668; train_kl_reg_loss: 12292.9965; train_edge_recon_loss: 776341.8843; train_gene_expr_recon_loss: 1634482.8167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2423117.6973; train_optim_loss: 2423117.6973; val_kl_reg_loss: 12101.2790; val_edge_recon_loss: 802566.9140; val_gene_expr_recon_loss: 1640848.9428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2455517.1316; val_optim_loss: 2455517.1316
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9574; val_auprc_score: 0.9907; val_best_acc_score: 0.9430; val_best_f1_score: 0.9671; train_kl_reg_loss: 12282.1928; train_edge_recon_loss: 777654.7684; train_gene_expr_recon_loss: 1634414.6935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424351.6558; train_optim_loss: 2424351.6558; val_kl_reg_loss: 12108.7569; val_edge_recon_loss: 803711.6959; val_gene_expr_recon_loss: 1642304.9742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2458125.4241; val_optim_loss: 2458125.4241

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9576; val_auprc_score: 0.9909; val_best_acc_score: 0.9427; val_best_f1_score: 0.9669; train_kl_reg_loss: 12283.3006; train_edge_recon_loss: 776845.2105; train_gene_expr_recon_loss: 1634104.5589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2423233.0702; train_optim_loss: 2423233.0702; val_kl_reg_loss: 12108.9885; val_edge_recon_loss: 809831.0104; val_gene_expr_recon_loss: 1641084.1538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2463024.1569; val_optim_loss: 2463024.1569
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9585; val_auprc_score: 0.9912; val_best_acc_score: 0.9427; val_best_f1_score: 0.9669; train_kl_reg_loss: 12280.9332; train_edge_recon_loss: 777002.3579; train_gene_expr_recon_loss: 1633892.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2423175.6714; train_optim_loss: 2423175.6714; val_kl_reg_loss: 12103.7410; val_edge_recon_loss: 805123.4901; val_gene_expr_recon_loss: 1641739.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2458966.7925; val_optim_loss: 2458966.7925
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9563; val_auprc_score: 0.9906; val_best_acc_score: 0.9429; val_best_f1_score: 0.9670; train_kl_reg_loss: 12279.9185; train_edge_recon_loss: 775791.8087; train_gene_expr_recon_loss: 1634026.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2422098.5034; train_optim_loss: 2422098.5034; val_kl_reg_loss: 12101.2264; val_edge_recon_loss: 807493.5132; val_gene_expr_recon_loss: 1640774.4555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2460369.1893; val_optim_loss: 2460369.1893
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9580; val_auprc_score: 0.9911; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 12281.5796; train_edge_recon_loss: 777789.0066; train_gene_expr_recon_loss: 1634017.0218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2424087.6088; train_optim_loss: 2424087.6088; val_kl_reg_loss: 12101.3500; val_edge_recon_loss: 800241.8844; val_gene_expr_recon_loss: 1640888.7161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2453231.9443; val_optim_loss: 2453231.9443

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 863 min 3 sec.
Using best model state, which was in epoch 59.

--- MODEL EVALUATION ---
val AUROC score: 0.9582
val AUPRC score: 0.9910
val best accuracy score: 0.9435
val best F1 score: 0.9673
val target rna MSE score: 0.3100
val source rna MSE score: 0.1670
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0633
Val cat covariate2 mean sim diff: -0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
