[True]
Run timestamp: 27072023_012500_110.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_110']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8600; val_auprc_score: 0.9747; val_best_acc_score: 0.8663; val_best_f1_score: 0.9276; train_kl_reg_loss: 146294.8610; train_edge_recon_loss: 10420383.1186; train_gene_expr_recon_loss: 2004421.5988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12571099.5814; train_optim_loss: 12571099.5814; val_kl_reg_loss: 70135.8496; val_edge_recon_loss: 11454675.2083; val_gene_expr_recon_loss: 1266800.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12791611.2500; val_optim_loss: 12791611.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8191; val_auprc_score: 0.9593; val_best_acc_score: 0.8747; val_best_f1_score: 0.9303; train_kl_reg_loss: 70919.9122; train_edge_recon_loss: 10397699.4698; train_gene_expr_recon_loss: 1203022.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11671641.8884; train_optim_loss: 11671641.8884; val_kl_reg_loss: 51476.4648; val_edge_recon_loss: 11550756.9167; val_gene_expr_recon_loss: 1136251.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12738485.2083; val_optim_loss: 12738485.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8368; val_auprc_score: 0.9612; val_best_acc_score: 0.8959; val_best_f1_score: 0.9416; train_kl_reg_loss: 66213.1123; train_edge_recon_loss: 8990355.2767; train_gene_expr_recon_loss: 1162379.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10218948.1256; train_optim_loss: 10218948.1256; val_kl_reg_loss: 90886.3206; val_edge_recon_loss: 8971850.2917; val_gene_expr_recon_loss: 1071066.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10133803.1667; val_optim_loss: 10133803.1667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8485; val_auprc_score: 0.9654; val_best_acc_score: 0.9070; val_best_f1_score: 0.9479; train_kl_reg_loss: 85377.2843; train_edge_recon_loss: 8617302.4977; train_gene_expr_recon_loss: 1045726.0462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9748405.8395; train_optim_loss: 9748405.8395; val_kl_reg_loss: 75013.6084; val_edge_recon_loss: 8452045.9792; val_gene_expr_recon_loss: 1022405.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9549465.5208; val_optim_loss: 9549465.5208
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8837; val_auprc_score: 0.9741; val_best_acc_score: 0.8973; val_best_f1_score: 0.9416; train_kl_reg_loss: 68974.5709; train_edge_recon_loss: 8286341.0674; train_gene_expr_recon_loss: 990201.8706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9345517.5093; train_optim_loss: 9345517.5093; val_kl_reg_loss: 62789.8390; val_edge_recon_loss: 8532928.0208; val_gene_expr_recon_loss: 969402.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9565120.1875; val_optim_loss: 9565120.1875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8966; val_auprc_score: 0.9754; val_best_acc_score: 0.8977; val_best_f1_score: 0.9413; train_kl_reg_loss: 63876.7889; train_edge_recon_loss: 8162280.4930; train_gene_expr_recon_loss: 941234.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9167391.9047; train_optim_loss: 9167391.9047; val_kl_reg_loss: 58275.2863; val_edge_recon_loss: 8519162.9375; val_gene_expr_recon_loss: 921413.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9498851.5208; val_optim_loss: 9498851.5208
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9049; val_auprc_score: 0.9777; val_best_acc_score: 0.9030; val_best_f1_score: 0.9441; train_kl_reg_loss: 54204.9840; train_edge_recon_loss: 8197500.5837; train_gene_expr_recon_loss: 909649.1968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9161354.7349; train_optim_loss: 9161354.7349; val_kl_reg_loss: 45694.2467; val_edge_recon_loss: 8310287.2917; val_gene_expr_recon_loss: 894697.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9250678.5833; val_optim_loss: 9250678.5833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9127; val_auprc_score: 0.9805; val_best_acc_score: 0.9115; val_best_f1_score: 0.9499; train_kl_reg_loss: 40822.6160; train_edge_recon_loss: 8029430.6628; train_gene_expr_recon_loss: 887894.2116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8958147.4767; train_optim_loss: 8958147.4767; val_kl_reg_loss: 32479.4266; val_edge_recon_loss: 8020637.3542; val_gene_expr_recon_loss: 874931.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8928048.6042; val_optim_loss: 8928048.6042
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9261; val_auprc_score: 0.9840; val_best_acc_score: 0.9196; val_best_f1_score: 0.9537; train_kl_reg_loss: 35324.0622; train_edge_recon_loss: 7910454.5977; train_gene_expr_recon_loss: 866440.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8812219.6047; train_optim_loss: 8812219.6047; val_kl_reg_loss: 33932.7329; val_edge_recon_loss: 8077030.8125; val_gene_expr_recon_loss: 853457.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8964421.3542; val_optim_loss: 8964421.3542
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9204; val_auprc_score: 0.9822; val_best_acc_score: 0.9188; val_best_f1_score: 0.9533; train_kl_reg_loss: 33917.1860; train_edge_recon_loss: 7852484.3326; train_gene_expr_recon_loss: 845332.6811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8731734.2349; train_optim_loss: 8731734.2349; val_kl_reg_loss: 30743.3529; val_edge_recon_loss: 8077035.9583; val_gene_expr_recon_loss: 837164.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8944943.7500; val_optim_loss: 8944943.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9244; val_auprc_score: 0.9842; val_best_acc_score: 0.9183; val_best_f1_score: 0.9532; train_kl_reg_loss: 33239.6673; train_edge_recon_loss: 7908819.5953; train_gene_expr_recon_loss: 827333.9872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8769393.2279; train_optim_loss: 8769393.2279; val_kl_reg_loss: 27192.0247; val_edge_recon_loss: 7928180.6458; val_gene_expr_recon_loss: 820304.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8775677.1458; val_optim_loss: 8775677.1458
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9263; val_auprc_score: 0.9838; val_best_acc_score: 0.9220; val_best_f1_score: 0.9552; train_kl_reg_loss: 26867.2496; train_edge_recon_loss: 7880651.4581; train_gene_expr_recon_loss: 815238.0012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8722756.7116; train_optim_loss: 8722756.7116; val_kl_reg_loss: 25121.7614; val_edge_recon_loss: 7908151.1458; val_gene_expr_recon_loss: 809903.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8743176.4792; val_optim_loss: 8743176.4792
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9293; val_auprc_score: 0.9840; val_best_acc_score: 0.9234; val_best_f1_score: 0.9561; train_kl_reg_loss: 26551.5985; train_edge_recon_loss: 7840599.6674; train_gene_expr_recon_loss: 804746.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8671897.4372; train_optim_loss: 8671897.4372; val_kl_reg_loss: 21761.9692; val_edge_recon_loss: 7899478.2292; val_gene_expr_recon_loss: 799689.7370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8720929.8958; val_optim_loss: 8720929.8958
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9338; val_auprc_score: 0.9849; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 25907.5431; train_edge_recon_loss: 7734606.2349; train_gene_expr_recon_loss: 794153.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8554667.3395; train_optim_loss: 8554667.3395; val_kl_reg_loss: 23169.8786; val_edge_recon_loss: 7796565.7917; val_gene_expr_recon_loss: 789763.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8609499.5208; val_optim_loss: 8609499.5208
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9342; val_auprc_score: 0.9851; val_best_acc_score: 0.9292; val_best_f1_score: 0.9592; train_kl_reg_loss: 25969.3600; train_edge_recon_loss: 7768692.2116; train_gene_expr_recon_loss: 785440.2922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8580101.8558; train_optim_loss: 8580101.8558; val_kl_reg_loss: 26267.5622; val_edge_recon_loss: 8101141.9792; val_gene_expr_recon_loss: 782706.4635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8910115.9583; val_optim_loss: 8910115.9583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9422; val_auprc_score: 0.9865; val_best_acc_score: 0.9312; val_best_f1_score: 0.9601; train_kl_reg_loss: 24722.5656; train_edge_recon_loss: 7763970.5372; train_gene_expr_recon_loss: 777823.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8566517.0953; train_optim_loss: 8566517.0953; val_kl_reg_loss: 21233.4322; val_edge_recon_loss: 8151603.5208; val_gene_expr_recon_loss: 774744.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8947581.9583; val_optim_loss: 8947581.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9389; val_auprc_score: 0.9860; val_best_acc_score: 0.9331; val_best_f1_score: 0.9617; train_kl_reg_loss: 22437.9174; train_edge_recon_loss: 7789208.5558; train_gene_expr_recon_loss: 772481.1183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8584127.5744; train_optim_loss: 8584127.5744; val_kl_reg_loss: 22460.2124; val_edge_recon_loss: 7736199.5417; val_gene_expr_recon_loss: 770214.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8528874.4583; val_optim_loss: 8528874.4583
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9426; val_auprc_score: 0.9860; val_best_acc_score: 0.9371; val_best_f1_score: 0.9637; train_kl_reg_loss: 22623.6785; train_edge_recon_loss: 7792368.9326; train_gene_expr_recon_loss: 766887.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8581879.8302; train_optim_loss: 8581879.8302; val_kl_reg_loss: 23261.1933; val_edge_recon_loss: 8011254.7917; val_gene_expr_recon_loss: 762767.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8797283.6250; val_optim_loss: 8797283.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9466; val_auprc_score: 0.9876; val_best_acc_score: 0.9378; val_best_f1_score: 0.9640; train_kl_reg_loss: 22830.6069; train_edge_recon_loss: 7655372.5209; train_gene_expr_recon_loss: 761250.4058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8439453.5256; train_optim_loss: 8439453.5256; val_kl_reg_loss: 20073.3337; val_edge_recon_loss: 8015646.3958; val_gene_expr_recon_loss: 758699.6068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8794419.3542; val_optim_loss: 8794419.3542
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9479; val_auprc_score: 0.9880; val_best_acc_score: 0.9349; val_best_f1_score: 0.9625; train_kl_reg_loss: 21016.7221; train_edge_recon_loss: 7744599.6186; train_gene_expr_recon_loss: 756685.7555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522302.0907; train_optim_loss: 8522302.0907; val_kl_reg_loss: 22222.1371; val_edge_recon_loss: 8167525.8958; val_gene_expr_recon_loss: 754488.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8944236.9583; val_optim_loss: 8944236.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9519; val_auprc_score: 0.9883; val_best_acc_score: 0.9426; val_best_f1_score: 0.9669; train_kl_reg_loss: 21966.7691; train_edge_recon_loss: 7718063.8209; train_gene_expr_recon_loss: 751935.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8491965.8186; train_optim_loss: 8491965.8186; val_kl_reg_loss: 21663.2228; val_edge_recon_loss: 7806931.0000; val_gene_expr_recon_loss: 750781.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8579375.8542; val_optim_loss: 8579375.8542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9557; val_auprc_score: 0.9896; val_best_acc_score: 0.9455; val_best_f1_score: 0.9684; train_kl_reg_loss: 20538.1782; train_edge_recon_loss: 7639093.4070; train_gene_expr_recon_loss: 746764.5049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8406396.0558; train_optim_loss: 8406396.0558; val_kl_reg_loss: 19276.2852; val_edge_recon_loss: 7974195.6250; val_gene_expr_recon_loss: 746839.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8740311.3542; val_optim_loss: 8740311.3542
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9500; val_auprc_score: 0.9882; val_best_acc_score: 0.9443; val_best_f1_score: 0.9681; train_kl_reg_loss: 20024.4079; train_edge_recon_loss: 7684908.6674; train_gene_expr_recon_loss: 746084.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8451017.2628; train_optim_loss: 8451017.2628; val_kl_reg_loss: 18669.0168; val_edge_recon_loss: 7725819.2292; val_gene_expr_recon_loss: 746138.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8490627.0833; val_optim_loss: 8490627.0833
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9559; val_auprc_score: 0.9890; val_best_acc_score: 0.9428; val_best_f1_score: 0.9667; train_kl_reg_loss: 19536.6612; train_edge_recon_loss: 7591884.9721; train_gene_expr_recon_loss: 745567.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8356989.2372; train_optim_loss: 8356989.2372; val_kl_reg_loss: 19170.5077; val_edge_recon_loss: 8119683.3750; val_gene_expr_recon_loss: 745621.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8884475.8542; val_optim_loss: 8884475.8542
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9541; val_auprc_score: 0.9894; val_best_acc_score: 0.9440; val_best_f1_score: 0.9676; train_kl_reg_loss: 19057.2330; train_edge_recon_loss: 7685464.0395; train_gene_expr_recon_loss: 745187.7509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8449709.0070; train_optim_loss: 8449709.0070; val_kl_reg_loss: 18150.5844; val_edge_recon_loss: 7875446.9167; val_gene_expr_recon_loss: 745752.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8639349.6875; val_optim_loss: 8639349.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9561; val_auprc_score: 0.9901; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 18723.9758; train_edge_recon_loss: 7874820.4698; train_gene_expr_recon_loss: 744786.0860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8638330.4930; train_optim_loss: 8638330.4930; val_kl_reg_loss: 18536.0187; val_edge_recon_loss: 7678418.7500; val_gene_expr_recon_loss: 744560.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8441514.8333; val_optim_loss: 8441514.8333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9554; val_auprc_score: 0.9902; val_best_acc_score: 0.9452; val_best_f1_score: 0.9684; train_kl_reg_loss: 18527.0752; train_edge_recon_loss: 7729077.9209; train_gene_expr_recon_loss: 744235.3195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8491840.3256; train_optim_loss: 8491840.3256; val_kl_reg_loss: 17664.5672; val_edge_recon_loss: 7768755.1042; val_gene_expr_recon_loss: 744509.8932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8530929.5417; val_optim_loss: 8530929.5417
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9548; val_auprc_score: 0.9894; val_best_acc_score: 0.9406; val_best_f1_score: 0.9658; train_kl_reg_loss: 18270.5388; train_edge_recon_loss: 7690780.6488; train_gene_expr_recon_loss: 743842.9398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8452894.1419; train_optim_loss: 8452894.1419; val_kl_reg_loss: 17976.0771; val_edge_recon_loss: 7978445.6667; val_gene_expr_recon_loss: 744677.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8741099.6458; val_optim_loss: 8741099.6458
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9585; val_auprc_score: 0.9912; val_best_acc_score: 0.9451; val_best_f1_score: 0.9683; train_kl_reg_loss: 18547.7324; train_edge_recon_loss: 7638485.6767; train_gene_expr_recon_loss: 743039.4869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8400072.8767; train_optim_loss: 8400072.8767; val_kl_reg_loss: 17729.1108; val_edge_recon_loss: 7739971.8542; val_gene_expr_recon_loss: 743046.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8500747.7500; val_optim_loss: 8500747.7500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9607; val_auprc_score: 0.9911; val_best_acc_score: 0.9469; val_best_f1_score: 0.9693; train_kl_reg_loss: 18072.7168; train_edge_recon_loss: 7631010.6349; train_gene_expr_recon_loss: 742179.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8391262.5140; train_optim_loss: 8391262.5140; val_kl_reg_loss: 17985.2249; val_edge_recon_loss: 7817833.7708; val_gene_expr_recon_loss: 742323.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8578142.9167; val_optim_loss: 8578142.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9514; val_auprc_score: 0.9886; val_best_acc_score: 0.9436; val_best_f1_score: 0.9674; train_kl_reg_loss: 18425.4665; train_edge_recon_loss: 7579128.5930; train_gene_expr_recon_loss: 741626.3985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8339180.4953; train_optim_loss: 8339180.4953; val_kl_reg_loss: 17841.7087; val_edge_recon_loss: 7875042.5625; val_gene_expr_recon_loss: 742290.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8635175.1875; val_optim_loss: 8635175.1875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9558; val_auprc_score: 0.9896; val_best_acc_score: 0.9464; val_best_f1_score: 0.9691; train_kl_reg_loss: 18373.4011; train_edge_recon_loss: 7602228.7674; train_gene_expr_recon_loss: 741449.3116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8362051.4791; train_optim_loss: 8362051.4791; val_kl_reg_loss: 17861.7546; val_edge_recon_loss: 7832716.5000; val_gene_expr_recon_loss: 742836.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8593414.6042; val_optim_loss: 8593414.6042
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9594; val_auprc_score: 0.9910; val_best_acc_score: 0.9478; val_best_f1_score: 0.9699; train_kl_reg_loss: 18412.2511; train_edge_recon_loss: 7617689.4186; train_gene_expr_recon_loss: 741429.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8377531.2977; train_optim_loss: 8377531.2977; val_kl_reg_loss: 17812.9347; val_edge_recon_loss: 7634914.1250; val_gene_expr_recon_loss: 740857.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8393584.5833; val_optim_loss: 8393584.5833
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9639; val_auprc_score: 0.9913; val_best_acc_score: 0.9490; val_best_f1_score: 0.9704; train_kl_reg_loss: 18287.5803; train_edge_recon_loss: 7607797.1791; train_gene_expr_recon_loss: 741296.3677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8367381.1535; train_optim_loss: 8367381.1535; val_kl_reg_loss: 17719.6382; val_edge_recon_loss: 7822104.8333; val_gene_expr_recon_loss: 741858.6198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8581682.9167; val_optim_loss: 8581682.9167
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9551; val_auprc_score: 0.9899; val_best_acc_score: 0.9439; val_best_f1_score: 0.9677; train_kl_reg_loss: 18245.4752; train_edge_recon_loss: 7713498.2698; train_gene_expr_recon_loss: 741036.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8472780.4628; train_optim_loss: 8472780.4628; val_kl_reg_loss: 17828.7442; val_edge_recon_loss: 7676336.1875; val_gene_expr_recon_loss: 741808.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8435973.2708; val_optim_loss: 8435973.2708
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9552; val_auprc_score: 0.9898; val_best_acc_score: 0.9460; val_best_f1_score: 0.9687; train_kl_reg_loss: 18293.9487; train_edge_recon_loss: 7712681.8116; train_gene_expr_recon_loss: 741194.7125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8472170.4372; train_optim_loss: 8472170.4372; val_kl_reg_loss: 17750.6053; val_edge_recon_loss: 7829951.5417; val_gene_expr_recon_loss: 741757.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8589459.8750; val_optim_loss: 8589459.8750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9550; val_auprc_score: 0.9896; val_best_acc_score: 0.9467; val_best_f1_score: 0.9693; train_kl_reg_loss: 18301.8317; train_edge_recon_loss: 7645430.3605; train_gene_expr_recon_loss: 741172.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8404904.4326; train_optim_loss: 8404904.4326; val_kl_reg_loss: 17770.2511; val_edge_recon_loss: 7764975.7500; val_gene_expr_recon_loss: 741902.4036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8524648.5000; val_optim_loss: 8524648.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9576; val_auprc_score: 0.9902; val_best_acc_score: 0.9471; val_best_f1_score: 0.9692; train_kl_reg_loss: 18317.7545; train_edge_recon_loss: 7637365.2372; train_gene_expr_recon_loss: 741022.5093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8396705.5279; train_optim_loss: 8396705.5279; val_kl_reg_loss: 17754.4622; val_edge_recon_loss: 7870729.6667; val_gene_expr_recon_loss: 741796.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8630281.0000; val_optim_loss: 8630281.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9560; val_auprc_score: 0.9890; val_best_acc_score: 0.9472; val_best_f1_score: 0.9694; train_kl_reg_loss: 18324.5439; train_edge_recon_loss: 7698324.8047; train_gene_expr_recon_loss: 741045.9791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8457695.3140; train_optim_loss: 8457695.3140; val_kl_reg_loss: 17770.4466; val_edge_recon_loss: 7764392.2917; val_gene_expr_recon_loss: 741405.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8523568.6042; val_optim_loss: 8523568.6042
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9606; val_auprc_score: 0.9911; val_best_acc_score: 0.9472; val_best_f1_score: 0.9694; train_kl_reg_loss: 18316.1478; train_edge_recon_loss: 7665179.7349; train_gene_expr_recon_loss: 740971.8942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8424467.7465; train_optim_loss: 8424467.7465; val_kl_reg_loss: 17801.4761; val_edge_recon_loss: 7707205.2708; val_gene_expr_recon_loss: 741044.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8466051.2083; val_optim_loss: 8466051.2083
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9602; val_auprc_score: 0.9909; val_best_acc_score: 0.9468; val_best_f1_score: 0.9690; train_kl_reg_loss: 18317.7091; train_edge_recon_loss: 7679124.6651; train_gene_expr_recon_loss: 741192.5041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8438634.8419; train_optim_loss: 8438634.8419; val_kl_reg_loss: 17793.9185; val_edge_recon_loss: 8021096.3542; val_gene_expr_recon_loss: 742770.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8781660.4375; val_optim_loss: 8781660.4375

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 21 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9556
Val AUPRC score: 0.9890
Val best accuracy score: 0.9457
Val best F1 score: 0.9685
Val gene expr MSE score: 23509.2084
Val cat covariate0 mean sim diff: -0.0032

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
