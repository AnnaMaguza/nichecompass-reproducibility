[True, False, True]
Run timestamp: 30092023_102136_105.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_105']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9129; val_auprc_score: 0.9808; val_best_acc_score: 0.9127; val_best_f1_score: 0.9502; train_kl_reg_loss: 13133.8287; train_edge_recon_loss: 820601.5469; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 2703643.3641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3537378.7382; train_optim_loss: 3537378.7382; val_kl_reg_loss: 13640.1846; val_edge_recon_loss: 833757.8434; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 2381259.2298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3228657.2632; val_optim_loss: 3228657.2632
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9299; val_auprc_score: 0.9846; val_best_acc_score: 0.9214; val_best_f1_score: 0.9548; train_kl_reg_loss: 14508.5435; train_edge_recon_loss: 791342.8246; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 2235488.7629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3041340.1321; train_optim_loss: 3041340.1321; val_kl_reg_loss: 16016.7893; val_edge_recon_loss: 830231.1541; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 2129870.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2976118.0253; val_optim_loss: 2976118.0253
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9403; val_auprc_score: 0.9871; val_best_acc_score: 0.9288; val_best_f1_score: 0.9590; train_kl_reg_loss: 16299.5364; train_edge_recon_loss: 786876.1785; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 2082253.6270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2885429.3424; train_optim_loss: 2885429.3424; val_kl_reg_loss: 16842.8532; val_edge_recon_loss: 820241.2447; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 2049277.2186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2886361.3158; val_optim_loss: 2886361.3158
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9418; val_auprc_score: 0.9872; val_best_acc_score: 0.9309; val_best_f1_score: 0.9601; train_kl_reg_loss: 17201.9069; train_edge_recon_loss: 786401.3264; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 2022366.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2825969.7853; train_optim_loss: 2825969.7853; val_kl_reg_loss: 17345.0668; val_edge_recon_loss: 821579.6323; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 2007999.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2846924.2055; val_optim_loss: 2846924.2055
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9430; val_auprc_score: 0.9877; val_best_acc_score: 0.9313; val_best_f1_score: 0.9604; train_kl_reg_loss: 17728.4666; train_edge_recon_loss: 786207.6012; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1990760.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2794696.4380; train_optim_loss: 2794696.4380; val_kl_reg_loss: 17898.4405; val_edge_recon_loss: 817570.0405; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1979983.1847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815451.6609; val_optim_loss: 2815451.6609
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9449; val_auprc_score: 0.9882; val_best_acc_score: 0.9320; val_best_f1_score: 0.9608; train_kl_reg_loss: 18176.4201; train_edge_recon_loss: 782859.9359; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1967629.6001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768665.9570; train_optim_loss: 2768665.9570; val_kl_reg_loss: 18360.9463; val_edge_recon_loss: 816861.1002; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1960411.0471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2795633.0901; val_optim_loss: 2795633.0901
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9459; val_auprc_score: 0.9884; val_best_acc_score: 0.9341; val_best_f1_score: 0.9620; train_kl_reg_loss: 18569.3243; train_edge_recon_loss: 784386.7005; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1949611.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2752567.8422; train_optim_loss: 2752567.8422; val_kl_reg_loss: 19081.0318; val_edge_recon_loss: 813123.1070; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1944283.2257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2776487.3634; val_optim_loss: 2776487.3634
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9466; val_auprc_score: 0.9885; val_best_acc_score: 0.9337; val_best_f1_score: 0.9617; train_kl_reg_loss: 18918.1719; train_edge_recon_loss: 781173.8802; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1934270.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2734362.2001; train_optim_loss: 2734362.2001; val_kl_reg_loss: 19081.5033; val_edge_recon_loss: 812159.8023; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1931619.4028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2762860.7085; val_optim_loss: 2762860.7085
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9496; val_auprc_score: 0.9893; val_best_acc_score: 0.9366; val_best_f1_score: 0.9634; train_kl_reg_loss: 19336.7400; train_edge_recon_loss: 785363.9378; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1924388.8955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2729089.5720; train_optim_loss: 2729089.5720; val_kl_reg_loss: 19479.5142; val_edge_recon_loss: 812632.8750; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1923758.9732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755871.3563; val_optim_loss: 2755871.3563
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9491; val_auprc_score: 0.9888; val_best_acc_score: 0.9367; val_best_f1_score: 0.9636; train_kl_reg_loss: 19561.4871; train_edge_recon_loss: 784705.4356; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1912522.4151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2716789.3387; train_optim_loss: 2716789.3387; val_kl_reg_loss: 19497.5417; val_edge_recon_loss: 817032.3201; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1918917.0896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755446.9464; val_optim_loss: 2755446.9464
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9512; val_auprc_score: 0.9895; val_best_acc_score: 0.9362; val_best_f1_score: 0.9631; train_kl_reg_loss: 19800.5462; train_edge_recon_loss: 786245.8646; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1906252.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2712298.9665; train_optim_loss: 2712298.9665; val_kl_reg_loss: 20026.6026; val_edge_recon_loss: 821748.8338; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1908443.5582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2750218.9848; val_optim_loss: 2750218.9848
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9499; val_auprc_score: 0.9892; val_best_acc_score: 0.9367; val_best_f1_score: 0.9635; train_kl_reg_loss: 20071.6867; train_edge_recon_loss: 786994.0694; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1898817.0635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2705882.8193; train_optim_loss: 2705882.8193; val_kl_reg_loss: 20284.7022; val_edge_recon_loss: 813873.1447; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1900760.0127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2734917.8613; val_optim_loss: 2734917.8613
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9494; val_auprc_score: 0.9892; val_best_acc_score: 0.9366; val_best_f1_score: 0.9635; train_kl_reg_loss: 20221.8058; train_edge_recon_loss: 784809.6488; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1892404.0989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2697435.5531; train_optim_loss: 2697435.5531; val_kl_reg_loss: 20026.5977; val_edge_recon_loss: 819353.4403; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1892444.8178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2731824.8502; val_optim_loss: 2731824.8502
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9523; val_auprc_score: 0.9898; val_best_acc_score: 0.9378; val_best_f1_score: 0.9641; train_kl_reg_loss: 20436.3129; train_edge_recon_loss: 787989.5583; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1887723.1926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2696149.0644; train_optim_loss: 2696149.0644; val_kl_reg_loss: 20714.6139; val_edge_recon_loss: 813248.2546; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1887323.3209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2721286.1913; val_optim_loss: 2721286.1913
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9525; val_auprc_score: 0.9899; val_best_acc_score: 0.9382; val_best_f1_score: 0.9644; train_kl_reg_loss: 20617.3208; train_edge_recon_loss: 784767.7410; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1883134.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2688519.7785; train_optim_loss: 2688519.7785; val_kl_reg_loss: 20936.9552; val_edge_recon_loss: 808588.4484; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1886069.0622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2715594.4626; val_optim_loss: 2715594.4626
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9514; val_auprc_score: 0.9893; val_best_acc_score: 0.9386; val_best_f1_score: 0.9645; train_kl_reg_loss: 20786.7698; train_edge_recon_loss: 783854.5679; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1879329.3141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2683970.6509; train_optim_loss: 2683970.6509; val_kl_reg_loss: 21123.6557; val_edge_recon_loss: 819870.0752; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1887348.4732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2728342.2004; val_optim_loss: 2728342.2004
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9527; val_auprc_score: 0.9897; val_best_acc_score: 0.9394; val_best_f1_score: 0.9650; train_kl_reg_loss: 21187.2228; train_edge_recon_loss: 785434.5966; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1876396.9889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2683018.8076; train_optim_loss: 2683018.8076; val_kl_reg_loss: 20886.7892; val_edge_recon_loss: 818427.2589; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1892778.3057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2732092.3563; val_optim_loss: 2732092.3563
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9518; val_auprc_score: 0.9896; val_best_acc_score: 0.9379; val_best_f1_score: 0.9641; train_kl_reg_loss: 21133.3651; train_edge_recon_loss: 786324.5628; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1873921.3457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2681379.2743; train_optim_loss: 2681379.2743; val_kl_reg_loss: 21461.2810; val_edge_recon_loss: 816357.1065; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1875746.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2713564.6832; val_optim_loss: 2713564.6832
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9533; val_auprc_score: 0.9899; val_best_acc_score: 0.9392; val_best_f1_score: 0.9649; train_kl_reg_loss: 21164.8521; train_edge_recon_loss: 783585.8595; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1868111.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2672862.4831; train_optim_loss: 2672862.4831; val_kl_reg_loss: 21395.2053; val_edge_recon_loss: 816161.2986; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1870973.2718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2708529.7652; val_optim_loss: 2708529.7652
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9531; val_auprc_score: 0.9899; val_best_acc_score: 0.9398; val_best_f1_score: 0.9652; train_kl_reg_loss: 21256.5559; train_edge_recon_loss: 784944.9901; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1868496.2889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2674697.8371; train_optim_loss: 2674697.8371; val_kl_reg_loss: 21928.2354; val_edge_recon_loss: 818388.0754; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1873609.2009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2713925.5152; val_optim_loss: 2713925.5152
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9536; val_auprc_score: 0.9901; val_best_acc_score: 0.9395; val_best_f1_score: 0.9651; train_kl_reg_loss: 21373.3749; train_edge_recon_loss: 785125.4843; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1865511.7976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2672010.6595; train_optim_loss: 2672010.6595; val_kl_reg_loss: 21542.2974; val_edge_recon_loss: 814603.6313; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1874431.1640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2710577.0901; val_optim_loss: 2710577.0901
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9549; val_auprc_score: 0.9905; val_best_acc_score: 0.9405; val_best_f1_score: 0.9657; train_kl_reg_loss: 21424.6655; train_edge_recon_loss: 784042.7714; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1863459.0782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2668926.5133; train_optim_loss: 2668926.5133; val_kl_reg_loss: 21650.1430; val_edge_recon_loss: 810756.5719; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1870232.7419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2702639.4524; val_optim_loss: 2702639.4524
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9551; val_auprc_score: 0.9905; val_best_acc_score: 0.9404; val_best_f1_score: 0.9656; train_kl_reg_loss: 21445.2978; train_edge_recon_loss: 785953.0910; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1860233.8210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2667632.2107; train_optim_loss: 2667632.2107; val_kl_reg_loss: 21522.6074; val_edge_recon_loss: 813451.8259; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1869428.9965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2704403.4342; val_optim_loss: 2704403.4342
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9547; val_auprc_score: 0.9904; val_best_acc_score: 0.9416; val_best_f1_score: 0.9663; train_kl_reg_loss: 21452.0582; train_edge_recon_loss: 784938.6068; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1859416.5053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2665807.1709; train_optim_loss: 2665807.1709; val_kl_reg_loss: 21462.8986; val_edge_recon_loss: 810130.3894; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1867619.9317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2699213.2227; val_optim_loss: 2699213.2227
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9527; val_auprc_score: 0.9898; val_best_acc_score: 0.9399; val_best_f1_score: 0.9653; train_kl_reg_loss: 21928.9286; train_edge_recon_loss: 785326.4749; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1935450.8335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2742706.2388; train_optim_loss: 2742706.2388; val_kl_reg_loss: 22705.6152; val_edge_recon_loss: 806476.3163; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1929939.2525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2759121.1862; val_optim_loss: 2759121.1862
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9525; val_auprc_score: 0.9899; val_best_acc_score: 0.9388; val_best_f1_score: 0.9647; train_kl_reg_loss: 22744.6288; train_edge_recon_loss: 788744.5743; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1873844.0784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2685333.2829; train_optim_loss: 2685333.2829; val_kl_reg_loss: 18870.9973; val_edge_recon_loss: 806828.4656; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1860789.6695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2686489.1387; val_optim_loss: 2686489.1387
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9518; val_auprc_score: 0.9896; val_best_acc_score: 0.9391; val_best_f1_score: 0.9649; train_kl_reg_loss: 21252.5616; train_edge_recon_loss: 787648.8358; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1856364.7185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2665266.1164; train_optim_loss: 2665266.1164; val_kl_reg_loss: 19989.7153; val_edge_recon_loss: 805594.5104; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1867847.7308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2693431.9575; val_optim_loss: 2693431.9575
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9541; val_auprc_score: 0.9900; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 20921.0829; train_edge_recon_loss: 785465.2825; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1854160.2681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2660546.6305; train_optim_loss: 2660546.6305; val_kl_reg_loss: 20002.1396; val_edge_recon_loss: 817186.1807; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1858563.5870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2695751.9049; val_optim_loss: 2695751.9049
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9541; val_auprc_score: 0.9902; val_best_acc_score: 0.9409; val_best_f1_score: 0.9659; train_kl_reg_loss: 20795.7095; train_edge_recon_loss: 784284.5080; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1852179.2436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2657259.4611; train_optim_loss: 2657259.4611; val_kl_reg_loss: 20529.9100; val_edge_recon_loss: 814352.0281; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1859486.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2694368.2328; val_optim_loss: 2694368.2328
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9550; val_auprc_score: 0.9903; val_best_acc_score: 0.9416; val_best_f1_score: 0.9663; train_kl_reg_loss: 21265.8921; train_edge_recon_loss: 784942.7215; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1849475.5905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2655684.2007; train_optim_loss: 2655684.2007; val_kl_reg_loss: 21120.7572; val_edge_recon_loss: 812017.0731; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1855576.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2688714.5223; val_optim_loss: 2688714.5223

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9564; val_auprc_score: 0.9907; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 20733.5701; train_edge_recon_loss: 781222.2244; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1819328.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2621283.9583; train_optim_loss: 2621283.9583; val_kl_reg_loss: 20092.8921; val_edge_recon_loss: 803466.4284; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1827007.0030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2650566.3168; val_optim_loss: 2650566.3168
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9566; val_auprc_score: 0.9907; val_best_acc_score: 0.9430; val_best_f1_score: 0.9671; train_kl_reg_loss: 20390.3843; train_edge_recon_loss: 782958.4969; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1814917.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2618266.1190; train_optim_loss: 2618266.1190; val_kl_reg_loss: 19978.4820; val_edge_recon_loss: 807961.7366; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1824177.0638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2652117.2905; val_optim_loss: 2652117.2905
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9560; val_auprc_score: 0.9904; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 20135.9151; train_edge_recon_loss: 782862.2365; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1813625.3786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616623.5285; train_optim_loss: 2616623.5285; val_kl_reg_loss: 19813.7107; val_edge_recon_loss: 810194.5144; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1826630.5025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2656638.7298; val_optim_loss: 2656638.7298
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9566; val_auprc_score: 0.9906; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 20009.4939; train_edge_recon_loss: 783650.5388; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1812367.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616027.0988; train_optim_loss: 2616027.0988; val_kl_reg_loss: 19829.0279; val_edge_recon_loss: 812881.0949; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1822055.6817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2654765.8026; val_optim_loss: 2654765.8026
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9575; val_auprc_score: 0.9908; val_best_acc_score: 0.9439; val_best_f1_score: 0.9676; train_kl_reg_loss: 19849.8871; train_edge_recon_loss: 781588.3417; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1811332.4899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2612770.7191; train_optim_loss: 2612770.7191; val_kl_reg_loss: 19726.5221; val_edge_recon_loss: 814973.3535; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1823434.7783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2658134.6559; val_optim_loss: 2658134.6559

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9570; val_auprc_score: 0.9906; val_best_acc_score: 0.9424; val_best_f1_score: 0.9666; train_kl_reg_loss: 19718.8521; train_edge_recon_loss: 781759.4015; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1808512.6449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2609990.8971; train_optim_loss: 2609990.8971; val_kl_reg_loss: 19641.5562; val_edge_recon_loss: 821507.1457; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1820077.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2661226.1174; val_optim_loss: 2661226.1174
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9582; val_auprc_score: 0.9911; val_best_acc_score: 0.9429; val_best_f1_score: 0.9670; train_kl_reg_loss: 19692.3981; train_edge_recon_loss: 780286.1871; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806707.1056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606685.6903; train_optim_loss: 2606685.6903; val_kl_reg_loss: 19634.7491; val_edge_recon_loss: 815553.4327; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1820189.3163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2655377.4970; val_optim_loss: 2655377.4970
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9588; val_auprc_score: 0.9912; val_best_acc_score: 0.9440; val_best_f1_score: 0.9676; train_kl_reg_loss: 19656.3972; train_edge_recon_loss: 779404.7402; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806552.7298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605613.8655; train_optim_loss: 2605613.8655; val_kl_reg_loss: 19553.9750; val_edge_recon_loss: 807486.7659; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1819986.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647027.3583; val_optim_loss: 2647027.3583
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9583; val_auprc_score: 0.9911; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 19607.5556; train_edge_recon_loss: 782307.6049; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806269.6488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2608184.8108; train_optim_loss: 2608184.8108; val_kl_reg_loss: 19558.5901; val_edge_recon_loss: 812098.6652; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1817701.3117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2649358.5628; val_optim_loss: 2649358.5628
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9580; val_auprc_score: 0.9912; val_best_acc_score: 0.9430; val_best_f1_score: 0.9670; train_kl_reg_loss: 19623.0339; train_edge_recon_loss: 781395.8564; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806657.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2607676.3215; train_optim_loss: 2607676.3215; val_kl_reg_loss: 19563.5231; val_edge_recon_loss: 809850.3259; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1817796.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647210.1255; val_optim_loss: 2647210.1255
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9585; val_auprc_score: 0.9912; val_best_acc_score: 0.9437; val_best_f1_score: 0.9674; train_kl_reg_loss: 19600.7096; train_edge_recon_loss: 782838.3934; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806378.9002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2608818.0034; train_optim_loss: 2608818.0034; val_kl_reg_loss: 19543.0001; val_edge_recon_loss: 810702.1073; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1821423.6488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2651668.7540; val_optim_loss: 2651668.7540
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9583; val_auprc_score: 0.9912; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 19589.6024; train_edge_recon_loss: 778397.9304; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806201.1468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2604188.6825; train_optim_loss: 2604188.6825; val_kl_reg_loss: 19534.2120; val_edge_recon_loss: 803018.9168; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1820264.7454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2642817.8796; val_optim_loss: 2642817.8796
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9582; val_auprc_score: 0.9909; val_best_acc_score: 0.9432; val_best_f1_score: 0.9671; train_kl_reg_loss: 19579.1284; train_edge_recon_loss: 780746.3145; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806081.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606407.3370; train_optim_loss: 2606407.3370; val_kl_reg_loss: 19545.2023; val_edge_recon_loss: 810523.6587; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1820128.0602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2650196.9150; val_optim_loss: 2650196.9150
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9577; val_auprc_score: 0.9909; val_best_acc_score: 0.9430; val_best_f1_score: 0.9671; train_kl_reg_loss: 19587.5880; train_edge_recon_loss: 780593.0141; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1805627.1642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605807.7668; train_optim_loss: 2605807.7668; val_kl_reg_loss: 19533.0072; val_edge_recon_loss: 816118.2310; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1817853.0830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2653504.3209; val_optim_loss: 2653504.3209
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9584; val_auprc_score: 0.9911; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 19553.4659; train_edge_recon_loss: 780589.1214; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806103.3018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606245.8880; train_optim_loss: 2606245.8880; val_kl_reg_loss: 19500.1911; val_edge_recon_loss: 808143.0714; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1819044.3451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2646687.6002; val_optim_loss: 2646687.6002
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9591; val_auprc_score: 0.9912; val_best_acc_score: 0.9440; val_best_f1_score: 0.9675; train_kl_reg_loss: 19527.3212; train_edge_recon_loss: 782672.4995; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1805673.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2607873.0605; train_optim_loss: 2607873.0605; val_kl_reg_loss: 19504.2643; val_edge_recon_loss: 815900.4896; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1819576.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2654980.9150; val_optim_loss: 2654980.9150

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9586; val_auprc_score: 0.9912; val_best_acc_score: 0.9438; val_best_f1_score: 0.9675; train_kl_reg_loss: 19524.5577; train_edge_recon_loss: 779136.2996; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806081.1753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2604742.0306; train_optim_loss: 2604742.0306; val_kl_reg_loss: 19489.7123; val_edge_recon_loss: 813432.5266; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1818149.4322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2651071.6690; val_optim_loss: 2651071.6690
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9584; val_auprc_score: 0.9910; val_best_acc_score: 0.9436; val_best_f1_score: 0.9674; train_kl_reg_loss: 19520.9263; train_edge_recon_loss: 780977.1858; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1805374.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605872.7464; train_optim_loss: 2605872.7464; val_kl_reg_loss: 19484.3142; val_edge_recon_loss: 809970.3444; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1818121.1584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647575.8168; val_optim_loss: 2647575.8168
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9594; val_auprc_score: 0.9914; val_best_acc_score: 0.9435; val_best_f1_score: 0.9673; train_kl_reg_loss: 19518.2659; train_edge_recon_loss: 779094.8263; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1805905.7729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2604518.8646; train_optim_loss: 2604518.8646; val_kl_reg_loss: 19484.8636; val_edge_recon_loss: 810305.4937; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1817310.6118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647100.9646; val_optim_loss: 2647100.9646
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9582; val_auprc_score: 0.9911; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 19519.8403; train_edge_recon_loss: 779634.1438; train_cat_covariates_contrastive_loss: 0.0000; train_gene_expr_recon_loss: 1806228.7943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605382.7781; train_optim_loss: 2605382.7781; val_kl_reg_loss: 19480.9959; val_edge_recon_loss: 812382.7920; val_cat_covariates_contrastive_loss: 0.0000; val_gene_expr_recon_loss: 1819662.1776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2651525.9656; val_optim_loss: 2651525.9656

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 547 min 22 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9576
val AUPRC score: 0.9910
val best accuracy score: 0.9431
val best F1 score: 0.9671
val target rna MSE score: 0.4295
val source rna MSE score: 0.1196
Val cat covariate0 mean sim diff: -0.0009
Val cat covariate1 mean sim diff: -0.0628
Val cat covariate2 mean sim diff: 0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
