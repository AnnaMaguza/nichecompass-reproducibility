[True]
Run timestamp: 10102023_070807_181.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_181']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7820; val_auprc_score: 0.7986; val_best_acc_score: 0.5496; val_best_f1_score: 0.6858; train_kl_reg_loss: 70299.2841; train_edge_recon_loss: 748975.2047; train_gene_expr_recon_loss: 22141417.8626; train_masked_gp_l1_reg_loss: 41595.9915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2934036.1613; train_chrom_access_recon_loss: 2226260.7605; train_global_loss: 28162585.2672; train_optim_loss: 28162585.2672; val_kl_reg_loss: 85262.2380; val_edge_recon_loss: 812383.3375; val_gene_expr_recon_loss: 21132190.9333; val_masked_gp_l1_reg_loss: 45222.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1114425.2500; val_chrom_access_recon_loss: 2174010.5083; val_global_loss: 25363494.9333; val_optim_loss: 25363494.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8734; val_auprc_score: 0.8783; val_best_acc_score: 0.7511; val_best_f1_score: 0.7765; train_kl_reg_loss: 68982.0748; train_edge_recon_loss: 729363.5448; train_gene_expr_recon_loss: 20895951.8626; train_masked_gp_l1_reg_loss: 46696.5389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 597020.7242; train_chrom_access_recon_loss: 2156032.7920; train_global_loss: 24494047.6183; train_optim_loss: 24494047.6183; val_kl_reg_loss: 55533.6732; val_edge_recon_loss: 785080.1792; val_gene_expr_recon_loss: 20887998.1333; val_masked_gp_l1_reg_loss: 48552.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 324387.5312; val_chrom_access_recon_loss: 2169838.1000; val_global_loss: 24271389.6000; val_optim_loss: 24271389.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9109; val_auprc_score: 0.9022; val_best_acc_score: 0.8282; val_best_f1_score: 0.8380; train_kl_reg_loss: 62420.8325; train_edge_recon_loss: 686784.5186; train_gene_expr_recon_loss: 20594518.9160; train_masked_gp_l1_reg_loss: 50421.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 248383.0476; train_chrom_access_recon_loss: 2130073.4485; train_global_loss: 23772602.3969; train_optim_loss: 23772602.3969; val_kl_reg_loss: 70386.8630; val_edge_recon_loss: 651300.6458; val_gene_expr_recon_loss: 20546225.8667; val_masked_gp_l1_reg_loss: 52493.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199974.5938; val_chrom_access_recon_loss: 2131593.7750; val_global_loss: 23651975.0667; val_optim_loss: 23651975.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9228; val_auprc_score: 0.9120; val_best_acc_score: 0.8456; val_best_f1_score: 0.8560; train_kl_reg_loss: 70043.7886; train_edge_recon_loss: 623576.5725; train_gene_expr_recon_loss: 20327148.9466; train_masked_gp_l1_reg_loss: 54275.8061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171164.9166; train_chrom_access_recon_loss: 2106501.6956; train_global_loss: 23352711.6183; train_optim_loss: 23352711.6183; val_kl_reg_loss: 70345.8198; val_edge_recon_loss: 614157.2958; val_gene_expr_recon_loss: 20290130.1333; val_masked_gp_l1_reg_loss: 56140.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149837.3906; val_chrom_access_recon_loss: 2105921.6167; val_global_loss: 23286532.9333; val_optim_loss: 23286532.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9402; val_auprc_score: 0.9293; val_best_acc_score: 0.8662; val_best_f1_score: 0.8732; train_kl_reg_loss: 67647.3630; train_edge_recon_loss: 609969.7753; train_gene_expr_recon_loss: 20141912.2595; train_masked_gp_l1_reg_loss: 57400.7120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136351.6193; train_chrom_access_recon_loss: 2089771.1355; train_global_loss: 23103052.9466; train_optim_loss: 23103052.9466; val_kl_reg_loss: 69308.1151; val_edge_recon_loss: 602520.2708; val_gene_expr_recon_loss: 20235288.8000; val_masked_gp_l1_reg_loss: 58820.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127321.8047; val_chrom_access_recon_loss: 2105964.4417; val_global_loss: 23199224.0000; val_optim_loss: 23199224.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9479; val_auprc_score: 0.9393; val_best_acc_score: 0.8791; val_best_f1_score: 0.8839; train_kl_reg_loss: 65155.0861; train_edge_recon_loss: 600134.4656; train_gene_expr_recon_loss: 19983995.5725; train_masked_gp_l1_reg_loss: 59807.8112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118892.6799; train_chrom_access_recon_loss: 2076192.1126; train_global_loss: 22904177.7710; train_optim_loss: 22904177.7710; val_kl_reg_loss: 65210.2198; val_edge_recon_loss: 596691.5208; val_gene_expr_recon_loss: 20070045.4667; val_masked_gp_l1_reg_loss: 60776.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112345.5859; val_chrom_access_recon_loss: 2090991.2167; val_global_loss: 22996060.6667; val_optim_loss: 22996060.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9528; val_auprc_score: 0.9452; val_best_acc_score: 0.8856; val_best_f1_score: 0.8905; train_kl_reg_loss: 63038.8643; train_edge_recon_loss: 593403.7462; train_gene_expr_recon_loss: 19860411.9389; train_masked_gp_l1_reg_loss: 61663.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108121.6790; train_chrom_access_recon_loss: 2063194.1307; train_global_loss: 22749833.8015; train_optim_loss: 22749833.8015; val_kl_reg_loss: 62525.4328; val_edge_recon_loss: 591286.0750; val_gene_expr_recon_loss: 19841055.4667; val_masked_gp_l1_reg_loss: 62543.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105289.2422; val_chrom_access_recon_loss: 2068875.6833; val_global_loss: 22731576.1333; val_optim_loss: 22731576.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9563; val_auprc_score: 0.9503; val_best_acc_score: 0.8901; val_best_f1_score: 0.8927; train_kl_reg_loss: 61726.7663; train_edge_recon_loss: 587762.1784; train_gene_expr_recon_loss: 19717194.9008; train_masked_gp_l1_reg_loss: 63267.5517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101521.1270; train_chrom_access_recon_loss: 2048454.1632; train_global_loss: 22579926.5954; train_optim_loss: 22579926.5954; val_kl_reg_loss: 61879.0745; val_edge_recon_loss: 589040.6500; val_gene_expr_recon_loss: 19734024.0000; val_masked_gp_l1_reg_loss: 63930.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100148.2734; val_chrom_access_recon_loss: 2047582.8167; val_global_loss: 22596604.5333; val_optim_loss: 22596604.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9617; val_auprc_score: 0.9555; val_best_acc_score: 0.8988; val_best_f1_score: 0.9037; train_kl_reg_loss: 59995.8605; train_edge_recon_loss: 585703.6302; train_gene_expr_recon_loss: 19601172.2748; train_masked_gp_l1_reg_loss: 64618.0512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97703.1548; train_chrom_access_recon_loss: 2037815.9781; train_global_loss: 22447009.1145; train_optim_loss: 22447009.1145; val_kl_reg_loss: 59794.2182; val_edge_recon_loss: 582283.4458; val_gene_expr_recon_loss: 19672972.9333; val_masked_gp_l1_reg_loss: 65325.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97039.7344; val_chrom_access_recon_loss: 2044169.5500; val_global_loss: 22521586.0000; val_optim_loss: 22521586.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9605; val_auprc_score: 0.9510; val_best_acc_score: 0.9037; val_best_f1_score: 0.9059; train_kl_reg_loss: 58883.8827; train_edge_recon_loss: 582565.8302; train_gene_expr_recon_loss: 19510972.3511; train_masked_gp_l1_reg_loss: 65805.9102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95426.9255; train_chrom_access_recon_loss: 2027368.4265; train_global_loss: 22341023.5878; train_optim_loss: 22341023.5878; val_kl_reg_loss: 58429.8680; val_edge_recon_loss: 582987.9000; val_gene_expr_recon_loss: 19441434.1333; val_masked_gp_l1_reg_loss: 66402.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95951.3594; val_chrom_access_recon_loss: 2022288.4833; val_global_loss: 22267494.5333; val_optim_loss: 22267494.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9603; val_auprc_score: 0.9511; val_best_acc_score: 0.9050; val_best_f1_score: 0.9078; train_kl_reg_loss: 57574.3883; train_edge_recon_loss: 581618.0382; train_gene_expr_recon_loss: 19407238.7634; train_masked_gp_l1_reg_loss: 66870.3251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94138.1117; train_chrom_access_recon_loss: 2017334.0172; train_global_loss: 22224773.6489; train_optim_loss: 22224773.6489; val_kl_reg_loss: 58080.5005; val_edge_recon_loss: 579782.9250; val_gene_expr_recon_loss: 19481202.1333; val_masked_gp_l1_reg_loss: 67434.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93802.1484; val_chrom_access_recon_loss: 2033177.3417; val_global_loss: 22313478.9333; val_optim_loss: 22313478.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9651; val_auprc_score: 0.9579; val_best_acc_score: 0.9039; val_best_f1_score: 0.9084; train_kl_reg_loss: 56561.0387; train_edge_recon_loss: 579900.0587; train_gene_expr_recon_loss: 19314546.2290; train_masked_gp_l1_reg_loss: 67785.8815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92727.1035; train_chrom_access_recon_loss: 2007151.1708; train_global_loss: 22118671.5573; train_optim_loss: 22118671.5573; val_kl_reg_loss: 55201.1333; val_edge_recon_loss: 580860.1333; val_gene_expr_recon_loss: 19422189.0667; val_masked_gp_l1_reg_loss: 68349.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92013.2188; val_chrom_access_recon_loss: 2033003.0667; val_global_loss: 22251617.4667; val_optim_loss: 22251617.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9672; val_auprc_score: 0.9623; val_best_acc_score: 0.9099; val_best_f1_score: 0.9119; train_kl_reg_loss: 55742.5626; train_edge_recon_loss: 577566.8173; train_gene_expr_recon_loss: 19250653.3893; train_masked_gp_l1_reg_loss: 68746.4096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91303.3063; train_chrom_access_recon_loss: 2000583.1135; train_global_loss: 22044595.4962; train_optim_loss: 22044595.4962; val_kl_reg_loss: 54708.8279; val_edge_recon_loss: 578042.8458; val_gene_expr_recon_loss: 19281843.6000; val_masked_gp_l1_reg_loss: 69184.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90755.5859; val_chrom_access_recon_loss: 2008622.1667; val_global_loss: 22083157.6000; val_optim_loss: 22083157.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9687; val_auprc_score: 0.9576; val_best_acc_score: 0.9186; val_best_f1_score: 0.9212; train_kl_reg_loss: 54749.5073; train_edge_recon_loss: 576617.8359; train_gene_expr_recon_loss: 19183612.3664; train_masked_gp_l1_reg_loss: 69584.4029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90164.6562; train_chrom_access_recon_loss: 1994557.3034; train_global_loss: 21969286.1069; train_optim_loss: 21969286.1069; val_kl_reg_loss: 53805.9563; val_edge_recon_loss: 573022.8208; val_gene_expr_recon_loss: 19233446.4000; val_masked_gp_l1_reg_loss: 70042.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89700.1797; val_chrom_access_recon_loss: 1992669.6167; val_global_loss: 22012686.6667; val_optim_loss: 22012686.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9707; val_auprc_score: 0.9639; val_best_acc_score: 0.9214; val_best_f1_score: 0.9234; train_kl_reg_loss: 54434.7723; train_edge_recon_loss: 573042.3392; train_gene_expr_recon_loss: 19107407.6794; train_masked_gp_l1_reg_loss: 70494.9335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88745.5632; train_chrom_access_recon_loss: 1985032.9447; train_global_loss: 21879158.1527; train_optim_loss: 21879158.1527; val_kl_reg_loss: 53640.0148; val_edge_recon_loss: 568944.0375; val_gene_expr_recon_loss: 19083279.8667; val_masked_gp_l1_reg_loss: 71063.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88899.3359; val_chrom_access_recon_loss: 1985634.7333; val_global_loss: 21851462.6667; val_optim_loss: 21851462.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9709; val_auprc_score: 0.9639; val_best_acc_score: 0.9236; val_best_f1_score: 0.9260; train_kl_reg_loss: 53544.2880; train_edge_recon_loss: 572899.2309; train_gene_expr_recon_loss: 19056910.6107; train_masked_gp_l1_reg_loss: 71551.6239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88014.2814; train_chrom_access_recon_loss: 1980167.3368; train_global_loss: 21823087.5267; train_optim_loss: 21823087.5267; val_kl_reg_loss: 52478.1784; val_edge_recon_loss: 575172.4208; val_gene_expr_recon_loss: 19138390.6667; val_masked_gp_l1_reg_loss: 72051.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87152.5781; val_chrom_access_recon_loss: 1987113.9750; val_global_loss: 21912358.6667; val_optim_loss: 21912358.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9722; val_auprc_score: 0.9676; val_best_acc_score: 0.9179; val_best_f1_score: 0.9202; train_kl_reg_loss: 53105.5692; train_edge_recon_loss: 572269.8726; train_gene_expr_recon_loss: 18973051.2366; train_masked_gp_l1_reg_loss: 72584.4555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86889.7320; train_chrom_access_recon_loss: 1971843.5601; train_global_loss: 21729744.4427; train_optim_loss: 21729744.4427; val_kl_reg_loss: 51282.7714; val_edge_recon_loss: 576944.6958; val_gene_expr_recon_loss: 19074332.2667; val_masked_gp_l1_reg_loss: 73072.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87122.6250; val_chrom_access_recon_loss: 1981129.9000; val_global_loss: 21843884.0000; val_optim_loss: 21843884.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9750; val_auprc_score: 0.9698; val_best_acc_score: 0.9236; val_best_f1_score: 0.9265; train_kl_reg_loss: 52248.0318; train_edge_recon_loss: 571040.6436; train_gene_expr_recon_loss: 18926023.9389; train_masked_gp_l1_reg_loss: 73749.7836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86612.9495; train_chrom_access_recon_loss: 1966651.2261; train_global_loss: 21676326.4427; train_optim_loss: 21676326.4427; val_kl_reg_loss: 52589.7453; val_edge_recon_loss: 572074.6167; val_gene_expr_recon_loss: 19057055.6000; val_masked_gp_l1_reg_loss: 74335.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86376.4375; val_chrom_access_recon_loss: 1979181.3083; val_global_loss: 21821613.0667; val_optim_loss: 21821613.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9718; val_auprc_score: 0.9628; val_best_acc_score: 0.9189; val_best_f1_score: 0.9210; train_kl_reg_loss: 51770.8658; train_edge_recon_loss: 571028.8845; train_gene_expr_recon_loss: 18862260.0763; train_masked_gp_l1_reg_loss: 75046.8869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85978.0280; train_chrom_access_recon_loss: 1962051.7357; train_global_loss: 21608136.3664; train_optim_loss: 21608136.3664; val_kl_reg_loss: 51046.6479; val_edge_recon_loss: 574701.6833; val_gene_expr_recon_loss: 19015221.7333; val_masked_gp_l1_reg_loss: 75702.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86757.6562; val_chrom_access_recon_loss: 1969260.4667; val_global_loss: 21772690.5333; val_optim_loss: 21772690.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9735; val_auprc_score: 0.9629; val_best_acc_score: 0.9240; val_best_f1_score: 0.9259; train_kl_reg_loss: 51321.8100; train_edge_recon_loss: 570593.2552; train_gene_expr_recon_loss: 18801095.6794; train_masked_gp_l1_reg_loss: 76398.8136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86380.7893; train_chrom_access_recon_loss: 1958393.6050; train_global_loss: 21544184.0153; train_optim_loss: 21544184.0153; val_kl_reg_loss: 51234.3503; val_edge_recon_loss: 573171.2042; val_gene_expr_recon_loss: 18924315.6000; val_masked_gp_l1_reg_loss: 77152.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86415.0859; val_chrom_access_recon_loss: 1967301.9833; val_global_loss: 21679591.2000; val_optim_loss: 21679591.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9724; val_auprc_score: 0.9632; val_best_acc_score: 0.9228; val_best_f1_score: 0.9256; train_kl_reg_loss: 51170.3673; train_edge_recon_loss: 569535.6298; train_gene_expr_recon_loss: 18756168.0763; train_masked_gp_l1_reg_loss: 77822.0325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86201.9416; train_chrom_access_recon_loss: 1954539.7013; train_global_loss: 21495437.8168; train_optim_loss: 21495437.8168; val_kl_reg_loss: 50060.8081; val_edge_recon_loss: 572590.0500; val_gene_expr_recon_loss: 18894696.0000; val_masked_gp_l1_reg_loss: 78507.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86764.0312; val_chrom_access_recon_loss: 1980992.2500; val_global_loss: 21663611.3333; val_optim_loss: 21663611.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9684; val_auprc_score: 0.9579; val_best_acc_score: 0.9178; val_best_f1_score: 0.9211; train_kl_reg_loss: 51154.9555; train_edge_recon_loss: 569114.0892; train_gene_expr_recon_loss: 18713854.2748; train_masked_gp_l1_reg_loss: 79132.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86615.9961; train_chrom_access_recon_loss: 1950909.5878; train_global_loss: 21450780.9313; train_optim_loss: 21450780.9313; val_kl_reg_loss: 51308.4396; val_edge_recon_loss: 575812.2667; val_gene_expr_recon_loss: 18829877.2000; val_masked_gp_l1_reg_loss: 79832.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87328.6016; val_chrom_access_recon_loss: 1958531.5917; val_global_loss: 21582689.4667; val_optim_loss: 21582689.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9698; val_auprc_score: 0.9605; val_best_acc_score: 0.9170; val_best_f1_score: 0.9199; train_kl_reg_loss: 51022.7402; train_edge_recon_loss: 568898.1221; train_gene_expr_recon_loss: 18619952.2748; train_masked_gp_l1_reg_loss: 80425.8156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87026.3271; train_chrom_access_recon_loss: 1944620.6851; train_global_loss: 21351946.0153; train_optim_loss: 21351946.0153; val_kl_reg_loss: 50746.5052; val_edge_recon_loss: 572027.2500; val_gene_expr_recon_loss: 18806981.4667; val_masked_gp_l1_reg_loss: 81046.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86845.2031; val_chrom_access_recon_loss: 1964468.0750; val_global_loss: 21562115.0667; val_optim_loss: 21562115.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9698; val_auprc_score: 0.9619; val_best_acc_score: 0.9220; val_best_f1_score: 0.9249; train_kl_reg_loss: 50840.1845; train_edge_recon_loss: 570258.2448; train_gene_expr_recon_loss: 18580630.3969; train_masked_gp_l1_reg_loss: 81699.0261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87207.8963; train_chrom_access_recon_loss: 1942864.1059; train_global_loss: 21313499.9084; train_optim_loss: 21313499.9084; val_kl_reg_loss: 49731.3362; val_edge_recon_loss: 575286.8792; val_gene_expr_recon_loss: 18830425.7333; val_masked_gp_l1_reg_loss: 82205.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88027.0000; val_chrom_access_recon_loss: 1972668.5167; val_global_loss: 21598344.1333; val_optim_loss: 21598344.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9695; val_auprc_score: 0.9622; val_best_acc_score: 0.9174; val_best_f1_score: 0.9206; train_kl_reg_loss: 51189.5755; train_edge_recon_loss: 569679.3893; train_gene_expr_recon_loss: 18543462.9008; train_masked_gp_l1_reg_loss: 82811.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87563.8436; train_chrom_access_recon_loss: 1939823.7987; train_global_loss: 21274531.0534; train_optim_loss: 21274531.0534; val_kl_reg_loss: 51620.6443; val_edge_recon_loss: 574076.0083; val_gene_expr_recon_loss: 18720838.6667; val_masked_gp_l1_reg_loss: 83328.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88836.2031; val_chrom_access_recon_loss: 1952734.6417; val_global_loss: 21471434.1333; val_optim_loss: 21471434.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9689; val_auprc_score: 0.9601; val_best_acc_score: 0.9184; val_best_f1_score: 0.9221; train_kl_reg_loss: 51237.8382; train_edge_recon_loss: 570092.4294; train_gene_expr_recon_loss: 18488394.7634; train_masked_gp_l1_reg_loss: 83749.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88190.1333; train_chrom_access_recon_loss: 1937984.1947; train_global_loss: 21219648.7786; train_optim_loss: 21219648.7786; val_kl_reg_loss: 50639.5740; val_edge_recon_loss: 572246.0125; val_gene_expr_recon_loss: 18689614.5333; val_masked_gp_l1_reg_loss: 84041.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88596.5000; val_chrom_access_recon_loss: 1946308.7583; val_global_loss: 21431446.6667; val_optim_loss: 21431446.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9676; val_auprc_score: 0.9579; val_best_acc_score: 0.9157; val_best_f1_score: 0.9188; train_kl_reg_loss: 51947.9769; train_edge_recon_loss: 570695.7099; train_gene_expr_recon_loss: 18430678.2137; train_masked_gp_l1_reg_loss: 84310.5376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88619.8087; train_chrom_access_recon_loss: 1935521.2672; train_global_loss: 21161773.4351; train_optim_loss: 21161773.4351; val_kl_reg_loss: 54112.7607; val_edge_recon_loss: 572859.0125; val_gene_expr_recon_loss: 18619735.3333; val_masked_gp_l1_reg_loss: 84698.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89868.3359; val_chrom_access_recon_loss: 1950121.1667; val_global_loss: 21371394.4000; val_optim_loss: 21371394.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9679; val_auprc_score: 0.9593; val_best_acc_score: 0.9147; val_best_f1_score: 0.9185; train_kl_reg_loss: 52312.9942; train_edge_recon_loss: 570843.4590; train_gene_expr_recon_loss: 18379484.4427; train_masked_gp_l1_reg_loss: 84921.7823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89397.5677; train_chrom_access_recon_loss: 1932132.7662; train_global_loss: 21109092.9160; train_optim_loss: 21109092.9160; val_kl_reg_loss: 52407.3956; val_edge_recon_loss: 576553.6000; val_gene_expr_recon_loss: 18593580.8000; val_masked_gp_l1_reg_loss: 85125.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90161.4219; val_chrom_access_recon_loss: 1941320.1167; val_global_loss: 21339149.7333; val_optim_loss: 21339149.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9699; val_auprc_score: 0.9617; val_best_acc_score: 0.9235; val_best_f1_score: 0.9261; train_kl_reg_loss: 52418.4538; train_edge_recon_loss: 573205.6016; train_gene_expr_recon_loss: 18326905.4275; train_masked_gp_l1_reg_loss: 85561.2731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89730.3869; train_chrom_access_recon_loss: 1926146.8235; train_global_loss: 21053967.8168; train_optim_loss: 21053967.8168; val_kl_reg_loss: 52863.5281; val_edge_recon_loss: 576260.1500; val_gene_expr_recon_loss: 18541520.9333; val_masked_gp_l1_reg_loss: 85809.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91248.0312; val_chrom_access_recon_loss: 1950034.2000; val_global_loss: 21297736.6667; val_optim_loss: 21297736.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9703; val_auprc_score: 0.9638; val_best_acc_score: 0.9189; val_best_f1_score: 0.9219; train_kl_reg_loss: 52852.4542; train_edge_recon_loss: 572783.2672; train_gene_expr_recon_loss: 18264401.6031; train_masked_gp_l1_reg_loss: 86195.9509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90950.0474; train_chrom_access_recon_loss: 1924682.2471; train_global_loss: 20991865.4809; train_optim_loss: 20991865.4809; val_kl_reg_loss: 54156.8148; val_edge_recon_loss: 576792.5542; val_gene_expr_recon_loss: 18491212.4000; val_masked_gp_l1_reg_loss: 86532.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91813.1641; val_chrom_access_recon_loss: 1933967.3500; val_global_loss: 21234475.2000; val_optim_loss: 21234475.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9653; val_auprc_score: 0.9554; val_best_acc_score: 0.9157; val_best_f1_score: 0.9178; train_kl_reg_loss: 53700.8206; train_edge_recon_loss: 571821.5000; train_gene_expr_recon_loss: 18235370.1832; train_masked_gp_l1_reg_loss: 86734.9336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91652.0700; train_chrom_access_recon_loss: 1922627.0439; train_global_loss: 20961906.4733; train_optim_loss: 20961906.4733; val_kl_reg_loss: 52774.0156; val_edge_recon_loss: 577775.1125; val_gene_expr_recon_loss: 18536513.3333; val_masked_gp_l1_reg_loss: 86877.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92259.1797; val_chrom_access_recon_loss: 1943035.5417; val_global_loss: 21289235.8667; val_optim_loss: 21289235.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9616; val_auprc_score: 0.9499; val_best_acc_score: 0.9100; val_best_f1_score: 0.9144; train_kl_reg_loss: 53907.9186; train_edge_recon_loss: 571823.8473; train_gene_expr_recon_loss: 18196622.3053; train_masked_gp_l1_reg_loss: 87226.9207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92627.7437; train_chrom_access_recon_loss: 1921259.4552; train_global_loss: 20923468.1985; train_optim_loss: 20923468.1985; val_kl_reg_loss: 54517.8409; val_edge_recon_loss: 579578.9125; val_gene_expr_recon_loss: 18491779.3333; val_masked_gp_l1_reg_loss: 87373.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94547.4297; val_chrom_access_recon_loss: 1947624.9500; val_global_loss: 21255423.0667; val_optim_loss: 21255423.0667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8372; val_auprc_score: 0.8488; val_best_acc_score: 0.7513; val_best_f1_score: 0.7530; train_kl_reg_loss: 140478271224.3317; train_edge_recon_loss: 682294.8364; train_gene_expr_recon_loss: 23220547.2519; train_masked_gp_l1_reg_loss: 90449.8630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 210367.2477; train_chrom_access_recon_loss: 2381977.9561; train_global_loss: 140504847081.8168; train_optim_loss: 140504847081.8168; val_kl_reg_loss: 551137.8125; val_edge_recon_loss: 789193.4042; val_gene_expr_recon_loss: 20037601.4667; val_masked_gp_l1_reg_loss: 105658.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 443296.3750; val_chrom_access_recon_loss: 2184049.1417; val_global_loss: 24110935.8667; val_optim_loss: 24110935.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8559; val_auprc_score: 0.8651; val_best_acc_score: 0.7654; val_best_f1_score: 0.7801; train_kl_reg_loss: 18224273.2610; train_edge_recon_loss: 777051.7686; train_gene_expr_recon_loss: 19563147.7405; train_masked_gp_l1_reg_loss: 95580.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232023.8767; train_chrom_access_recon_loss: 2031566.9036; train_global_loss: 40923643.5878; train_optim_loss: 40923643.5878; val_kl_reg_loss: 585646.1729; val_edge_recon_loss: 767293.5792; val_gene_expr_recon_loss: 19394624.1333; val_masked_gp_l1_reg_loss: 87936.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151438.8594; val_chrom_access_recon_loss: 2000737.3500; val_global_loss: 22987675.2000; val_optim_loss: 22987675.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8672; val_auprc_score: 0.8696; val_best_acc_score: 0.7808; val_best_f1_score: 0.7936; train_kl_reg_loss: 5863107653.0312; train_edge_recon_loss: 759005.6746; train_gene_expr_recon_loss: 19192781.1450; train_masked_gp_l1_reg_loss: 86888.7999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116481.1311; train_chrom_access_recon_loss: 1969757.0229; train_global_loss: 5885232816.7634; train_optim_loss: 5885232816.7634; val_kl_reg_loss: 166057.1885; val_edge_recon_loss: 753879.7458; val_gene_expr_recon_loss: 19274262.4000; val_masked_gp_l1_reg_loss: 86100.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108434.6719; val_chrom_access_recon_loss: 1968473.3667; val_global_loss: 22357206.8000; val_optim_loss: 22357206.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8704; val_auprc_score: 0.8735; val_best_acc_score: 0.7816; val_best_f1_score: 0.7970; train_kl_reg_loss: 148921.0497; train_edge_recon_loss: 736308.6288; train_gene_expr_recon_loss: 19198736.4580; train_masked_gp_l1_reg_loss: 85588.9800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105649.5121; train_chrom_access_recon_loss: 1963021.5677; train_global_loss: 22238226.1069; train_optim_loss: 22238226.1069; val_kl_reg_loss: 133794.0068; val_edge_recon_loss: 731175.7458; val_gene_expr_recon_loss: 19165874.2667; val_masked_gp_l1_reg_loss: 85170.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103921.0781; val_chrom_access_recon_loss: 1969111.1333; val_global_loss: 22189047.0667; val_optim_loss: 22189047.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8879; val_auprc_score: 0.8865; val_best_acc_score: 0.8003; val_best_f1_score: 0.8124; train_kl_reg_loss: 5317057.5906; train_edge_recon_loss: 714023.1388; train_gene_expr_recon_loss: 19076709.8626; train_masked_gp_l1_reg_loss: 84826.7258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101965.4939; train_chrom_access_recon_loss: 1954322.7891; train_global_loss: 27248905.9084; train_optim_loss: 27248905.9084; val_kl_reg_loss: 123873.2120; val_edge_recon_loss: 709337.3958; val_gene_expr_recon_loss: 19184869.6000; val_masked_gp_l1_reg_loss: 84448.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100668.3672; val_chrom_access_recon_loss: 1973118.2917; val_global_loss: 22176314.5333; val_optim_loss: 22176314.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8897; val_auprc_score: 0.8886; val_best_acc_score: 0.7983; val_best_f1_score: 0.8139; train_kl_reg_loss: 114515.9432; train_edge_recon_loss: 693849.1813; train_gene_expr_recon_loss: 19118129.5420; train_masked_gp_l1_reg_loss: 84093.6462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98892.9440; train_chrom_access_recon_loss: 1956289.3950; train_global_loss: 22065770.7023; train_optim_loss: 22065770.7023; val_kl_reg_loss: 242290.8177; val_edge_recon_loss: 694278.4250; val_gene_expr_recon_loss: 19322833.0667; val_masked_gp_l1_reg_loss: 83795.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97573.8984; val_chrom_access_recon_loss: 1980683.4250; val_global_loss: 22421455.8667; val_optim_loss: 22421455.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 45 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9688
val AUPRC score: 0.9608
val best accuracy score: 0.9201
val best F1 score: 0.9233
val target rna MSE score: 1.1251
val source rna MSE score: 0.4246
val target atac MSE score: 0.3447
val source atac MSE score: 0.1040
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
