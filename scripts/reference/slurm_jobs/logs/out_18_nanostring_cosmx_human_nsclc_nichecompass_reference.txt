[True, False, True]
Run timestamp: 05102023_213300_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '15', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 48, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 48, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8960; val_auprc_score: 0.9817; val_best_acc_score: 0.9225; val_best_f1_score: 0.9573; train_kl_reg_loss: 14665.9071; train_edge_recon_loss: 638367.8464; train_cat_covariates_contrastive_loss: 948387.2641; train_gene_expr_recon_loss: 2763279.1941; train_masked_gp_l1_reg_loss: 11008.1240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29121.2152; train_global_loss: 4404829.5538; train_optim_loss: 4404829.5538; val_kl_reg_loss: 19174.2792; val_edge_recon_loss: 648711.5632; val_cat_covariates_contrastive_loss: 948522.9394; val_gene_expr_recon_loss: 2526776.7785; val_masked_gp_l1_reg_loss: 12074.3916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16342.8877; val_global_loss: 4171603.0532; val_optim_loss: 4171603.0532
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8996; val_auprc_score: 0.9815; val_best_acc_score: 0.9267; val_best_f1_score: 0.9594; train_kl_reg_loss: 20544.7767; train_edge_recon_loss: 623423.4188; train_cat_covariates_contrastive_loss: 951090.4259; train_gene_expr_recon_loss: 2391865.9447; train_masked_gp_l1_reg_loss: 15449.9720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17419.9823; train_global_loss: 4019794.5200; train_optim_loss: 4019794.5200; val_kl_reg_loss: 23114.5213; val_edge_recon_loss: 641684.9594; val_cat_covariates_contrastive_loss: 950399.6543; val_gene_expr_recon_loss: 2309298.7623; val_masked_gp_l1_reg_loss: 17945.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17981.6836; val_global_loss: 3960425.3966; val_optim_loss: 3960425.3966
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9160; val_auprc_score: 0.9850; val_best_acc_score: 0.9283; val_best_f1_score: 0.9603; train_kl_reg_loss: 23089.8189; train_edge_recon_loss: 620752.2054; train_cat_covariates_contrastive_loss: 952155.5423; train_gene_expr_recon_loss: 2267515.7730; train_masked_gp_l1_reg_loss: 19398.9578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18358.3602; train_global_loss: 3901270.6581; train_optim_loss: 3901270.6581; val_kl_reg_loss: 23791.6647; val_edge_recon_loss: 641380.4675; val_cat_covariates_contrastive_loss: 953496.2375; val_gene_expr_recon_loss: 2240590.9861; val_masked_gp_l1_reg_loss: 20304.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18350.5957; val_global_loss: 3897914.3441; val_optim_loss: 3897914.3441
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9207; val_auprc_score: 0.9859; val_best_acc_score: 0.9306; val_best_f1_score: 0.9614; train_kl_reg_loss: 24572.3937; train_edge_recon_loss: 622076.4644; train_cat_covariates_contrastive_loss: 952739.1166; train_gene_expr_recon_loss: 2219147.3319; train_masked_gp_l1_reg_loss: 21086.2073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18556.4152; train_global_loss: 3858177.9299; train_optim_loss: 3858177.9299; val_kl_reg_loss: 23854.4426; val_edge_recon_loss: 641684.0031; val_cat_covariates_contrastive_loss: 956646.1150; val_gene_expr_recon_loss: 2201447.3754; val_masked_gp_l1_reg_loss: 21616.5410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18672.9180; val_global_loss: 3863921.4367; val_optim_loss: 3863921.4367
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9209; val_auprc_score: 0.9857; val_best_acc_score: 0.9323; val_best_f1_score: 0.9624; train_kl_reg_loss: 26117.8070; train_edge_recon_loss: 617770.1230; train_cat_covariates_contrastive_loss: 953335.3395; train_gene_expr_recon_loss: 2188528.3767; train_masked_gp_l1_reg_loss: 21887.4225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18784.9393; train_global_loss: 3826424.0092; train_optim_loss: 3826424.0092; val_kl_reg_loss: 25989.0734; val_edge_recon_loss: 641907.3965; val_cat_covariates_contrastive_loss: 955353.5162; val_gene_expr_recon_loss: 2177356.0640; val_masked_gp_l1_reg_loss: 22075.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18826.8672; val_global_loss: 3841508.7994; val_optim_loss: 3841508.7994
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9206; val_auprc_score: 0.9851; val_best_acc_score: 0.9322; val_best_f1_score: 0.9623; train_kl_reg_loss: 27373.3297; train_edge_recon_loss: 618535.6226; train_cat_covariates_contrastive_loss: 953789.3197; train_gene_expr_recon_loss: 2167900.4990; train_masked_gp_l1_reg_loss: 22336.0472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18881.0457; train_global_loss: 3808815.8645; train_optim_loss: 3808815.8645; val_kl_reg_loss: 29771.7389; val_edge_recon_loss: 643327.3426; val_cat_covariates_contrastive_loss: 952160.6215; val_gene_expr_recon_loss: 2162135.7238; val_masked_gp_l1_reg_loss: 22535.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18921.9180; val_global_loss: 3828853.1736; val_optim_loss: 3828853.1736
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9188; val_auprc_score: 0.9847; val_best_acc_score: 0.9331; val_best_f1_score: 0.9627; train_kl_reg_loss: 28288.7578; train_edge_recon_loss: 618709.3632; train_cat_covariates_contrastive_loss: 954050.4590; train_gene_expr_recon_loss: 2151253.4814; train_masked_gp_l1_reg_loss: 22734.4316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18978.6055; train_global_loss: 3794015.0982; train_optim_loss: 3794015.0982; val_kl_reg_loss: 29098.2268; val_edge_recon_loss: 643200.5289; val_cat_covariates_contrastive_loss: 952461.0548; val_gene_expr_recon_loss: 2145187.8310; val_masked_gp_l1_reg_loss: 22817.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19050.8242; val_global_loss: 3811815.6412; val_optim_loss: 3811815.6412
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9252; val_auprc_score: 0.9865; val_best_acc_score: 0.9355; val_best_f1_score: 0.9642; train_kl_reg_loss: 28102.8157; train_edge_recon_loss: 620659.2551; train_cat_covariates_contrastive_loss: 953673.4795; train_gene_expr_recon_loss: 2224639.6308; train_masked_gp_l1_reg_loss: 38394.8582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20038.9311; train_global_loss: 3885508.9745; train_optim_loss: 3885508.9745; val_kl_reg_loss: 29676.5163; val_edge_recon_loss: 637974.4322; val_cat_covariates_contrastive_loss: 954603.5621; val_gene_expr_recon_loss: 2155077.7562; val_masked_gp_l1_reg_loss: 25309.1035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18941.6562; val_global_loss: 3821583.0123; val_optim_loss: 3821583.0123
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9204; val_auprc_score: 0.9856; val_best_acc_score: 0.9323; val_best_f1_score: 0.9622; train_kl_reg_loss: 29912.5788; train_edge_recon_loss: 619215.4205; train_cat_covariates_contrastive_loss: 954829.1324; train_gene_expr_recon_loss: 2138762.5730; train_masked_gp_l1_reg_loss: 23123.5494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19044.9392; train_global_loss: 3784888.1943; train_optim_loss: 3784888.1943; val_kl_reg_loss: 30830.0249; val_edge_recon_loss: 633707.7567; val_cat_covariates_contrastive_loss: 954145.6381; val_gene_expr_recon_loss: 2133889.0270; val_masked_gp_l1_reg_loss: 22813.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19078.7637; val_global_loss: 3794464.9468; val_optim_loss: 3794464.9468
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9184; val_auprc_score: 0.9843; val_best_acc_score: 0.9364; val_best_f1_score: 0.9647; train_kl_reg_loss: 30601.3654; train_edge_recon_loss: 617774.0015; train_cat_covariates_contrastive_loss: 954722.5886; train_gene_expr_recon_loss: 2124301.1049; train_masked_gp_l1_reg_loss: 23262.1367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19213.5723; train_global_loss: 3769874.7710; train_optim_loss: 3769874.7710; val_kl_reg_loss: 32937.7828; val_edge_recon_loss: 648572.0270; val_cat_covariates_contrastive_loss: 954093.6761; val_gene_expr_recon_loss: 2151561.1076; val_masked_gp_l1_reg_loss: 24438.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19850.0586; val_global_loss: 3831453.3441; val_optim_loss: 3831453.3441
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9236; val_auprc_score: 0.9857; val_best_acc_score: 0.9351; val_best_f1_score: 0.9639; train_kl_reg_loss: 31332.0036; train_edge_recon_loss: 619463.9959; train_cat_covariates_contrastive_loss: 955234.1269; train_gene_expr_recon_loss: 2115576.6557; train_masked_gp_l1_reg_loss: 24015.6066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19338.3322; train_global_loss: 3764960.7282; train_optim_loss: 3764960.7282; val_kl_reg_loss: 32428.3477; val_edge_recon_loss: 639592.8220; val_cat_covariates_contrastive_loss: 953676.7413; val_gene_expr_recon_loss: 2119368.0648; val_masked_gp_l1_reg_loss: 24337.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19429.5859; val_global_loss: 3788832.7230; val_optim_loss: 3788832.7230
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9180; val_auprc_score: 0.9839; val_best_acc_score: 0.9359; val_best_f1_score: 0.9644; train_kl_reg_loss: 32230.1914; train_edge_recon_loss: 617436.3688; train_cat_covariates_contrastive_loss: 955392.9247; train_gene_expr_recon_loss: 2107546.6192; train_masked_gp_l1_reg_loss: 24227.1569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19393.8885; train_global_loss: 3756227.1510; train_optim_loss: 3756227.1510; val_kl_reg_loss: 33887.2711; val_edge_recon_loss: 648151.2970; val_cat_covariates_contrastive_loss: 951989.0538; val_gene_expr_recon_loss: 2105811.3661; val_masked_gp_l1_reg_loss: 24420.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19389.2578; val_global_loss: 3783648.9931; val_optim_loss: 3783648.9931
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9204; val_auprc_score: 0.9851; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 32835.9146; train_edge_recon_loss: 621380.2748; train_cat_covariates_contrastive_loss: 955196.2193; train_gene_expr_recon_loss: 2156965.2848; train_masked_gp_l1_reg_loss: 35964.6420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20362.4457; train_global_loss: 3822704.7787; train_optim_loss: 3822704.7787; val_kl_reg_loss: 35434.5227; val_edge_recon_loss: 639825.1492; val_cat_covariates_contrastive_loss: 953782.8046; val_gene_expr_recon_loss: 2132099.4630; val_masked_gp_l1_reg_loss: 36188.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19306.9102; val_global_loss: 3816637.4429; val_optim_loss: 3816637.4429
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9285; val_auprc_score: 0.9870; val_best_acc_score: 0.9354; val_best_f1_score: 0.9640; train_kl_reg_loss: 34732.5873; train_edge_recon_loss: 619610.3505; train_cat_covariates_contrastive_loss: 955910.0700; train_gene_expr_recon_loss: 2110919.0464; train_masked_gp_l1_reg_loss: 27505.6522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19376.5735; train_global_loss: 3768054.2798; train_optim_loss: 3768054.2798; val_kl_reg_loss: 33838.7479; val_edge_recon_loss: 637572.3608; val_cat_covariates_contrastive_loss: 958403.7560; val_gene_expr_recon_loss: 2107829.4506; val_masked_gp_l1_reg_loss: 25218.6465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19451.5684; val_global_loss: 3782314.5687; val_optim_loss: 3782314.5687
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9150; val_auprc_score: 0.9835; val_best_acc_score: 0.9307; val_best_f1_score: 0.9614; train_kl_reg_loss: 34848.4286; train_edge_recon_loss: 618813.9760; train_cat_covariates_contrastive_loss: 956413.6833; train_gene_expr_recon_loss: 2101400.2675; train_masked_gp_l1_reg_loss: 24402.9734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19389.2053; train_global_loss: 3755268.5307; train_optim_loss: 3755268.5307; val_kl_reg_loss: 37140.9583; val_edge_recon_loss: 646754.9687; val_cat_covariates_contrastive_loss: 952912.5980; val_gene_expr_recon_loss: 2095864.4417; val_masked_gp_l1_reg_loss: 24378.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19407.4395; val_global_loss: 3776459.2191; val_optim_loss: 3776459.2191
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9218; val_auprc_score: 0.9857; val_best_acc_score: 0.9341; val_best_f1_score: 0.9634; train_kl_reg_loss: 33826.8144; train_edge_recon_loss: 626721.2033; train_cat_covariates_contrastive_loss: 955310.3449; train_gene_expr_recon_loss: 2302944.2903; train_masked_gp_l1_reg_loss: 60526.4893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24818.7600; train_global_loss: 4004147.9035; train_optim_loss: 4004147.9035; val_kl_reg_loss: 33531.3815; val_edge_recon_loss: 635407.1019; val_cat_covariates_contrastive_loss: 955568.3366; val_gene_expr_recon_loss: 2219677.6921; val_masked_gp_l1_reg_loss: 60529.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19786.6113; val_global_loss: 3924500.2670; val_optim_loss: 3924500.2670
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9266; val_auprc_score: 0.9866; val_best_acc_score: 0.9363; val_best_f1_score: 0.9646; train_kl_reg_loss: 36050.9559; train_edge_recon_loss: 619432.9301; train_cat_covariates_contrastive_loss: 956612.4936; train_gene_expr_recon_loss: 2148565.7779; train_masked_gp_l1_reg_loss: 37249.3954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19116.2560; train_global_loss: 3817027.8081; train_optim_loss: 3817027.8081; val_kl_reg_loss: 36028.0105; val_edge_recon_loss: 636504.0721; val_cat_covariates_contrastive_loss: 957948.1707; val_gene_expr_recon_loss: 2115583.6593; val_masked_gp_l1_reg_loss: 26724.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19104.3242; val_global_loss: 3791892.9205; val_optim_loss: 3791892.9205
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9271; val_auprc_score: 0.9865; val_best_acc_score: 0.9371; val_best_f1_score: 0.9650; train_kl_reg_loss: 38772.8697; train_edge_recon_loss: 621490.8154; train_cat_covariates_contrastive_loss: 957154.7780; train_gene_expr_recon_loss: 2109677.9094; train_masked_gp_l1_reg_loss: 24624.5686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19262.7271; train_global_loss: 3770983.6696; train_optim_loss: 3770983.6696; val_kl_reg_loss: 38092.5960; val_edge_recon_loss: 641302.1502; val_cat_covariates_contrastive_loss: 956936.6375; val_gene_expr_recon_loss: 2103190.9178; val_masked_gp_l1_reg_loss: 23531.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19214.6191; val_global_loss: 3782268.5502; val_optim_loss: 3782268.5502
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9211; val_auprc_score: 0.9852; val_best_acc_score: 0.9342; val_best_f1_score: 0.9634; train_kl_reg_loss: 177158.5713; train_edge_recon_loss: 661069.2441; train_cat_covariates_contrastive_loss: 958064.1100; train_gene_expr_recon_loss: 3239522.7432; train_masked_gp_l1_reg_loss: 97080.8633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57239.1912; train_global_loss: 5190134.7273; train_optim_loss: 5190134.7273; val_kl_reg_loss: 183975.9820; val_edge_recon_loss: 646514.4470; val_cat_covariates_contrastive_loss: 959931.2905; val_gene_expr_recon_loss: 2178728.1933; val_masked_gp_l1_reg_loss: 53117.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30252.5000; val_global_loss: 4052520.1721; val_optim_loss: 4052520.1721

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9227; val_auprc_score: 0.9855; val_best_acc_score: 0.9344; val_best_f1_score: 0.9635; train_kl_reg_loss: 48447.2727; train_edge_recon_loss: 617183.4075; train_cat_covariates_contrastive_loss: 958874.8209; train_gene_expr_recon_loss: 2154245.2039; train_masked_gp_l1_reg_loss: 48069.7252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25518.9182; train_global_loss: 3852339.3525; train_optim_loss: 3852339.3525; val_kl_reg_loss: 46060.2934; val_edge_recon_loss: 640240.9668; val_cat_covariates_contrastive_loss: 958085.4306; val_gene_expr_recon_loss: 2148351.0779; val_masked_gp_l1_reg_loss: 42531.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23099.5508; val_global_loss: 3858368.5239; val_optim_loss: 3858368.5239
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9264; val_auprc_score: 0.9864; val_best_acc_score: 0.9363; val_best_f1_score: 0.9645; train_kl_reg_loss: 44557.5197; train_edge_recon_loss: 618536.4546; train_cat_covariates_contrastive_loss: 958956.7654; train_gene_expr_recon_loss: 2134564.2650; train_masked_gp_l1_reg_loss: 35259.9319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20065.9292; train_global_loss: 3811940.8597; train_optim_loss: 3811940.8597; val_kl_reg_loss: 43727.3152; val_edge_recon_loss: 640390.2411; val_cat_covariates_contrastive_loss: 960094.4691; val_gene_expr_recon_loss: 2128033.4468; val_masked_gp_l1_reg_loss: 28315.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17184.7969; val_global_loss: 3817745.9707; val_optim_loss: 3817745.9707
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9211; val_auprc_score: 0.9849; val_best_acc_score: 0.9352; val_best_f1_score: 0.9640; train_kl_reg_loss: 43674.0785; train_edge_recon_loss: 619524.9049; train_cat_covariates_contrastive_loss: 959218.4159; train_gene_expr_recon_loss: 2116703.1965; train_masked_gp_l1_reg_loss: 24256.6677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15384.2099; train_global_loss: 3778761.4714; train_optim_loss: 3778761.4714; val_kl_reg_loss: 44804.8571; val_edge_recon_loss: 643984.1000; val_cat_covariates_contrastive_loss: 957080.0801; val_gene_expr_recon_loss: 2111511.0760; val_masked_gp_l1_reg_loss: 21702.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14222.3193; val_global_loss: 3793304.6134; val_optim_loss: 3793304.6134
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9260; val_auprc_score: 0.9862; val_best_acc_score: 0.9366; val_best_f1_score: 0.9647; train_kl_reg_loss: 42800.3743; train_edge_recon_loss: 615834.6139; train_cat_covariates_contrastive_loss: 958902.5780; train_gene_expr_recon_loss: 2101742.3648; train_masked_gp_l1_reg_loss: 20913.9714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13856.4492; train_global_loss: 3754050.3534; train_optim_loss: 3754050.3534; val_kl_reg_loss: 43122.0579; val_edge_recon_loss: 636207.5721; val_cat_covariates_contrastive_loss: 957472.7496; val_gene_expr_recon_loss: 2099953.4267; val_masked_gp_l1_reg_loss: 20540.2949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13650.1816; val_global_loss: 3770946.3040; val_optim_loss: 3770946.3040
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9266; val_auprc_score: 0.9864; val_best_acc_score: 0.9360; val_best_f1_score: 0.9644; train_kl_reg_loss: 41539.8424; train_edge_recon_loss: 617630.4806; train_cat_covariates_contrastive_loss: 958738.7919; train_gene_expr_recon_loss: 2091322.8714; train_masked_gp_l1_reg_loss: 20475.1229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13634.4772; train_global_loss: 3743341.5844; train_optim_loss: 3743341.5844; val_kl_reg_loss: 40935.2235; val_edge_recon_loss: 636867.6294; val_cat_covariates_contrastive_loss: 958075.5804; val_gene_expr_recon_loss: 2090561.2955; val_masked_gp_l1_reg_loss: 20483.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13616.3457; val_global_loss: 3760538.9776; val_optim_loss: 3760538.9776
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9288; val_auprc_score: 0.9867; val_best_acc_score: 0.9365; val_best_f1_score: 0.9645; train_kl_reg_loss: 40885.1658; train_edge_recon_loss: 617464.9959; train_cat_covariates_contrastive_loss: 958413.4258; train_gene_expr_recon_loss: 2084076.0101; train_masked_gp_l1_reg_loss: 20585.5270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13646.3362; train_global_loss: 3735071.4614; train_optim_loss: 3735071.4614; val_kl_reg_loss: 39532.5215; val_edge_recon_loss: 643759.9105; val_cat_covariates_contrastive_loss: 958387.5376; val_gene_expr_recon_loss: 2086003.1925; val_masked_gp_l1_reg_loss: 20681.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13683.5566; val_global_loss: 3762048.4066; val_optim_loss: 3762048.4066
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9110; val_auprc_score: 0.9840; val_best_acc_score: 0.9294; val_best_f1_score: 0.9609; train_kl_reg_loss: 28067.9615; train_edge_recon_loss: 623737.5854; train_cat_covariates_contrastive_loss: 953889.0791; train_gene_expr_recon_loss: 1965693.3047; train_masked_gp_l1_reg_loss: 20636.5691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16552.6416; train_global_loss: 3608577.1360; train_optim_loss: 3608577.1360; val_kl_reg_loss: 13484.0532; val_edge_recon_loss: 638630.3954; val_cat_covariates_contrastive_loss: 952410.7452; val_gene_expr_recon_loss: 1925191.5478; val_masked_gp_l1_reg_loss: 18121.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14327.8438; val_global_loss: 3562165.4938; val_optim_loss: 3562165.4938
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9166; val_auprc_score: 0.9847; val_best_acc_score: 0.9304; val_best_f1_score: 0.9614; train_kl_reg_loss: 21218.5576; train_edge_recon_loss: 617962.5257; train_cat_covariates_contrastive_loss: 951303.6516; train_gene_expr_recon_loss: 1912194.3731; train_masked_gp_l1_reg_loss: 15227.8171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13500.9920; train_global_loss: 3531407.9176; train_optim_loss: 3531407.9176; val_kl_reg_loss: 13696.9014; val_edge_recon_loss: 643317.4333; val_cat_covariates_contrastive_loss: 951929.7101; val_gene_expr_recon_loss: 1904396.6196; val_masked_gp_l1_reg_loss: 12445.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12781.5410; val_global_loss: 3538567.1605; val_optim_loss: 3538567.1605
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9137; val_auprc_score: 0.9838; val_best_acc_score: 0.9304; val_best_f1_score: 0.9614; train_kl_reg_loss: 19372.7292; train_edge_recon_loss: 617138.1461; train_cat_covariates_contrastive_loss: 950404.5257; train_gene_expr_recon_loss: 1896901.9467; train_masked_gp_l1_reg_loss: 10657.1478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12293.7930; train_global_loss: 3506768.2911; train_optim_loss: 3506768.2911; val_kl_reg_loss: 14393.4532; val_edge_recon_loss: 645646.8325; val_cat_covariates_contrastive_loss: 950004.5141; val_gene_expr_recon_loss: 1896613.9595; val_masked_gp_l1_reg_loss: 9400.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11916.2188; val_global_loss: 3527975.7569; val_optim_loss: 3527975.7569
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9200; val_auprc_score: 0.9850; val_best_acc_score: 0.9330; val_best_f1_score: 0.9628; train_kl_reg_loss: 17535.2963; train_edge_recon_loss: 614482.9614; train_cat_covariates_contrastive_loss: 950109.0706; train_gene_expr_recon_loss: 1888805.9379; train_masked_gp_l1_reg_loss: 8983.7325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11709.4355; train_global_loss: 3491626.4364; train_optim_loss: 3491626.4364; val_kl_reg_loss: 14193.0670; val_edge_recon_loss: 641425.2949; val_cat_covariates_contrastive_loss: 949983.9327; val_gene_expr_recon_loss: 1887313.5085; val_masked_gp_l1_reg_loss: 8850.0537; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11623.5215; val_global_loss: 3513389.3025; val_optim_loss: 3513389.3025
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9212; val_auprc_score: 0.9855; val_best_acc_score: 0.9335; val_best_f1_score: 0.9630; train_kl_reg_loss: 16677.0073; train_edge_recon_loss: 613916.7771; train_cat_covariates_contrastive_loss: 949797.6281; train_gene_expr_recon_loss: 1883522.2599; train_masked_gp_l1_reg_loss: 8914.6312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11679.0664; train_global_loss: 3484507.3676; train_optim_loss: 3484507.3676; val_kl_reg_loss: 14468.2826; val_edge_recon_loss: 636062.2254; val_cat_covariates_contrastive_loss: 949035.1850; val_gene_expr_recon_loss: 1882776.4965; val_masked_gp_l1_reg_loss: 8981.2842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11696.1387; val_global_loss: 3503019.6883; val_optim_loss: 3503019.6883
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9203; val_auprc_score: 0.9849; val_best_acc_score: 0.9335; val_best_f1_score: 0.9630; train_kl_reg_loss: 16434.1416; train_edge_recon_loss: 611923.1899; train_cat_covariates_contrastive_loss: 949656.7200; train_gene_expr_recon_loss: 1878786.8887; train_masked_gp_l1_reg_loss: 9054.2952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11757.1599; train_global_loss: 3477612.3984; train_optim_loss: 3477612.3984; val_kl_reg_loss: 14286.5033; val_edge_recon_loss: 640540.9401; val_cat_covariates_contrastive_loss: 949906.4298; val_gene_expr_recon_loss: 1879600.7747; val_masked_gp_l1_reg_loss: 9122.4482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11792.0254; val_global_loss: 3505249.1535; val_optim_loss: 3505249.1535
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9249; val_auprc_score: 0.9859; val_best_acc_score: 0.9348; val_best_f1_score: 0.9637; train_kl_reg_loss: 33936.1685; train_edge_recon_loss: 611777.9233; train_cat_covariates_contrastive_loss: 949543.7202; train_gene_expr_recon_loss: 1875047.3473; train_masked_gp_l1_reg_loss: 9170.8647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11811.1794; train_global_loss: 3491287.2066; train_optim_loss: 3491287.2066; val_kl_reg_loss: 14260.9959; val_edge_recon_loss: 642699.2932; val_cat_covariates_contrastive_loss: 949993.4518; val_gene_expr_recon_loss: 1874863.9564; val_masked_gp_l1_reg_loss: 9229.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11846.3926; val_global_loss: 3502893.9506; val_optim_loss: 3502893.9506
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9244; val_auprc_score: 0.9864; val_best_acc_score: 0.9334; val_best_f1_score: 0.9629; train_kl_reg_loss: 574438.7137; train_edge_recon_loss: 611330.2081; train_cat_covariates_contrastive_loss: 949459.3090; train_gene_expr_recon_loss: 1872170.4928; train_masked_gp_l1_reg_loss: 9267.5201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11855.3025; train_global_loss: 4028521.5607; train_optim_loss: 4028521.5607; val_kl_reg_loss: 14259.9301; val_edge_recon_loss: 636348.3188; val_cat_covariates_contrastive_loss: 950318.9257; val_gene_expr_recon_loss: 1872967.9884; val_masked_gp_l1_reg_loss: 9308.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11865.7139; val_global_loss: 3495069.1628; val_optim_loss: 3495069.1628
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9224; val_auprc_score: 0.9851; val_best_acc_score: 0.9345; val_best_f1_score: 0.9635; train_kl_reg_loss: 15565.8239; train_edge_recon_loss: 613288.3038; train_cat_covariates_contrastive_loss: 949262.4533; train_gene_expr_recon_loss: 1868943.2975; train_masked_gp_l1_reg_loss: 9345.6825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11895.5362; train_global_loss: 3468301.1028; train_optim_loss: 3468301.1028; val_kl_reg_loss: 14320.8103; val_edge_recon_loss: 642760.4188; val_cat_covariates_contrastive_loss: 948778.4728; val_gene_expr_recon_loss: 1869973.8557; val_masked_gp_l1_reg_loss: 9392.9121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11922.9688; val_global_loss: 3497149.5617; val_optim_loss: 3497149.5617
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9231; val_auprc_score: 0.9860; val_best_acc_score: 0.9334; val_best_f1_score: 0.9629; train_kl_reg_loss: 15425.3759; train_edge_recon_loss: 611640.7698; train_cat_covariates_contrastive_loss: 949116.6510; train_gene_expr_recon_loss: 1865987.3913; train_masked_gp_l1_reg_loss: 9422.9601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11921.9426; train_global_loss: 3463515.0925; train_optim_loss: 3463515.0925; val_kl_reg_loss: 14401.2623; val_edge_recon_loss: 633882.3696; val_cat_covariates_contrastive_loss: 949682.0069; val_gene_expr_recon_loss: 1868704.0278; val_masked_gp_l1_reg_loss: 9461.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11926.2422; val_global_loss: 3488057.6744; val_optim_loss: 3488057.6744
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9218; val_auprc_score: 0.9854; val_best_acc_score: 0.9342; val_best_f1_score: 0.9634; train_kl_reg_loss: 16169.3439; train_edge_recon_loss: 609520.4516; train_cat_covariates_contrastive_loss: 949383.8491; train_gene_expr_recon_loss: 1864666.7823; train_masked_gp_l1_reg_loss: 9497.2882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11956.6214; train_global_loss: 3461194.3337; train_optim_loss: 3461194.3337; val_kl_reg_loss: 14043.2362; val_edge_recon_loss: 635466.9019; val_cat_covariates_contrastive_loss: 948801.8756; val_gene_expr_recon_loss: 1865478.0637; val_masked_gp_l1_reg_loss: 9544.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11996.7217; val_global_loss: 3485331.0725; val_optim_loss: 3485331.0725
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9245; val_auprc_score: 0.9861; val_best_acc_score: 0.9351; val_best_f1_score: 0.9639; train_kl_reg_loss: 192811.5488; train_edge_recon_loss: 611358.0412; train_cat_covariates_contrastive_loss: 949423.4494; train_gene_expr_recon_loss: 1862033.6123; train_masked_gp_l1_reg_loss: 9583.7681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12003.8631; train_global_loss: 3637214.2773; train_optim_loss: 3637214.2773; val_kl_reg_loss: 13906.3524; val_edge_recon_loss: 630335.9193; val_cat_covariates_contrastive_loss: 949640.3389; val_gene_expr_recon_loss: 1860736.7998; val_masked_gp_l1_reg_loss: 9620.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12021.7842; val_global_loss: 3476261.4151; val_optim_loss: 3476261.4151
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9241; val_auprc_score: 0.9858; val_best_acc_score: 0.9344; val_best_f1_score: 0.9636; train_kl_reg_loss: 15195.6359; train_edge_recon_loss: 611973.8472; train_cat_covariates_contrastive_loss: 949133.4786; train_gene_expr_recon_loss: 1860331.9124; train_masked_gp_l1_reg_loss: 9656.8141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12020.8494; train_global_loss: 3458312.5327; train_optim_loss: 3458312.5327; val_kl_reg_loss: 14022.6302; val_edge_recon_loss: 637002.2501; val_cat_covariates_contrastive_loss: 949067.8816; val_gene_expr_recon_loss: 1860260.8858; val_masked_gp_l1_reg_loss: 9687.7979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12016.7988; val_global_loss: 3482058.1489; val_optim_loss: 3482058.1489
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9256; val_auprc_score: 0.9862; val_best_acc_score: 0.9349; val_best_f1_score: 0.9639; train_kl_reg_loss: 15091.3741; train_edge_recon_loss: 610557.5513; train_cat_covariates_contrastive_loss: 949351.6736; train_gene_expr_recon_loss: 1857268.8497; train_masked_gp_l1_reg_loss: 9731.8201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12053.0991; train_global_loss: 3454054.3731; train_optim_loss: 3454054.3731; val_kl_reg_loss: 13351.0764; val_edge_recon_loss: 632864.1608; val_cat_covariates_contrastive_loss: 949721.8343; val_gene_expr_recon_loss: 1858540.1755; val_masked_gp_l1_reg_loss: 9770.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12061.5049; val_global_loss: 3476309.5023; val_optim_loss: 3476309.5023
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9257; val_auprc_score: 0.9863; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 40892721.9157; train_edge_recon_loss: 611178.7689; train_cat_covariates_contrastive_loss: 949530.4036; train_gene_expr_recon_loss: 1854450.1784; train_masked_gp_l1_reg_loss: 9806.6953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12077.0685; train_global_loss: 44329763.7249; train_optim_loss: 44329763.7249; val_kl_reg_loss: 12749.9728; val_edge_recon_loss: 633900.3586; val_cat_covariates_contrastive_loss: 949806.5239; val_gene_expr_recon_loss: 1855508.3800; val_masked_gp_l1_reg_loss: 9846.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12084.1787; val_global_loss: 3473895.9838; val_optim_loss: 3473895.9838
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9274; val_auprc_score: 0.9866; val_best_acc_score: 0.9361; val_best_f1_score: 0.9644; train_kl_reg_loss: 15002.1081; train_edge_recon_loss: 611349.8418; train_cat_covariates_contrastive_loss: 949356.3586; train_gene_expr_recon_loss: 1851625.5519; train_masked_gp_l1_reg_loss: 9879.6690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12093.7000; train_global_loss: 3449307.2316; train_optim_loss: 3449307.2316; val_kl_reg_loss: 13166.0823; val_edge_recon_loss: 635882.8597; val_cat_covariates_contrastive_loss: 949289.0349; val_gene_expr_recon_loss: 1851396.3264; val_masked_gp_l1_reg_loss: 9914.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12092.6357; val_global_loss: 3471741.5463; val_optim_loss: 3471741.5463
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9222; val_auprc_score: 0.9854; val_best_acc_score: 0.9350; val_best_f1_score: 0.9639; train_kl_reg_loss: 15134.9270; train_edge_recon_loss: 611437.3078; train_cat_covariates_contrastive_loss: 949893.6211; train_gene_expr_recon_loss: 1847628.5497; train_masked_gp_l1_reg_loss: 9949.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12088.1538; train_global_loss: 3446131.8389; train_optim_loss: 3446131.8389; val_kl_reg_loss: 12173.9313; val_edge_recon_loss: 633303.8199; val_cat_covariates_contrastive_loss: 949205.4030; val_gene_expr_recon_loss: 1847894.4448; val_masked_gp_l1_reg_loss: 9983.2949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12085.1572; val_global_loss: 3464646.0949; val_optim_loss: 3464646.0949
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9228; val_auprc_score: 0.9856; val_best_acc_score: 0.9357; val_best_f1_score: 0.9643; train_kl_reg_loss: 14707.1330; train_edge_recon_loss: 611797.2115; train_cat_covariates_contrastive_loss: 949450.9362; train_gene_expr_recon_loss: 1844449.7923; train_masked_gp_l1_reg_loss: 10019.8772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12093.3283; train_global_loss: 3442518.2859; train_optim_loss: 3442518.2859; val_kl_reg_loss: 12657.9979; val_edge_recon_loss: 634867.9186; val_cat_covariates_contrastive_loss: 949303.2502; val_gene_expr_recon_loss: 1845782.8083; val_masked_gp_l1_reg_loss: 10049.9668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12076.6709; val_global_loss: 3464738.7238; val_optim_loss: 3464738.7238
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9266; val_auprc_score: 0.9864; val_best_acc_score: 0.9352; val_best_f1_score: 0.9639; train_kl_reg_loss: 14830.2844; train_edge_recon_loss: 613787.5394; train_cat_covariates_contrastive_loss: 949150.4529; train_gene_expr_recon_loss: 1842439.7326; train_masked_gp_l1_reg_loss: 10066.9001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12077.0524; train_global_loss: 3442351.9627; train_optim_loss: 3442351.9627; val_kl_reg_loss: 12717.7118; val_edge_recon_loss: 634990.0593; val_cat_covariates_contrastive_loss: 949299.0704; val_gene_expr_recon_loss: 1844805.4302; val_masked_gp_l1_reg_loss: 10083.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12093.0498; val_global_loss: 3463989.0262; val_optim_loss: 3463989.0262
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9240; val_auprc_score: 0.9858; val_best_acc_score: 0.9340; val_best_f1_score: 0.9633; train_kl_reg_loss: 14177.7293; train_edge_recon_loss: 610986.4727; train_cat_covariates_contrastive_loss: 948957.0238; train_gene_expr_recon_loss: 1840703.5029; train_masked_gp_l1_reg_loss: 10108.1749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12077.4981; train_global_loss: 3437010.4003; train_optim_loss: 3437010.4003; val_kl_reg_loss: 12726.1748; val_edge_recon_loss: 632262.0664; val_cat_covariates_contrastive_loss: 948789.7431; val_gene_expr_recon_loss: 1842477.2650; val_masked_gp_l1_reg_loss: 10134.9443; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12064.0947; val_global_loss: 3458454.2562; val_optim_loss: 3458454.2562
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9237; val_auprc_score: 0.9857; val_best_acc_score: 0.9349; val_best_f1_score: 0.9638; train_kl_reg_loss: 14103.7183; train_edge_recon_loss: 611044.8084; train_cat_covariates_contrastive_loss: 948683.3840; train_gene_expr_recon_loss: 1838895.4539; train_masked_gp_l1_reg_loss: 10144.8223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12055.6416; train_global_loss: 3434927.8275; train_optim_loss: 3434927.8275; val_kl_reg_loss: 12889.3123; val_edge_recon_loss: 636452.9361; val_cat_covariates_contrastive_loss: 948997.8129; val_gene_expr_recon_loss: 1841587.1273; val_masked_gp_l1_reg_loss: 10166.6426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12040.0273; val_global_loss: 3462133.9429; val_optim_loss: 3462133.9429
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9260; val_auprc_score: 0.9863; val_best_acc_score: 0.9363; val_best_f1_score: 0.9646; train_kl_reg_loss: 13989.1867; train_edge_recon_loss: 610562.1021; train_cat_covariates_contrastive_loss: 948654.1940; train_gene_expr_recon_loss: 1837635.3558; train_masked_gp_l1_reg_loss: 10171.3874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12047.7018; train_global_loss: 3433059.9232; train_optim_loss: 3433059.9232; val_kl_reg_loss: 13016.7581; val_edge_recon_loss: 636902.3664; val_cat_covariates_contrastive_loss: 949305.3405; val_gene_expr_recon_loss: 1839920.9074; val_masked_gp_l1_reg_loss: 10183.0645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12040.8574; val_global_loss: 3461369.1258; val_optim_loss: 3461369.1258
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9281; val_auprc_score: 0.9867; val_best_acc_score: 0.9372; val_best_f1_score: 0.9651; train_kl_reg_loss: 13887.9621; train_edge_recon_loss: 609910.1534; train_cat_covariates_contrastive_loss: 948627.4154; train_gene_expr_recon_loss: 1837506.9641; train_masked_gp_l1_reg_loss: 10195.0823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12049.4274; train_global_loss: 3432177.0052; train_optim_loss: 3432177.0052; val_kl_reg_loss: 13232.6865; val_edge_recon_loss: 632510.9320; val_cat_covariates_contrastive_loss: 949171.3328; val_gene_expr_recon_loss: 1838755.6929; val_masked_gp_l1_reg_loss: 10206.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12042.4336; val_global_loss: 3455919.1412; val_optim_loss: 3455919.1412
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9274; val_auprc_score: 0.9867; val_best_acc_score: 0.9349; val_best_f1_score: 0.9638; train_kl_reg_loss: 14097.4645; train_edge_recon_loss: 609524.0657; train_cat_covariates_contrastive_loss: 948495.5639; train_gene_expr_recon_loss: 1836327.9599; train_masked_gp_l1_reg_loss: 10220.5525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12038.2551; train_global_loss: 3430703.8640; train_optim_loss: 3430703.8640; val_kl_reg_loss: 12897.0150; val_edge_recon_loss: 636179.5537; val_cat_covariates_contrastive_loss: 949059.1032; val_gene_expr_recon_loss: 1838744.0498; val_masked_gp_l1_reg_loss: 10229.2783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12020.4697; val_global_loss: 3459129.4691; val_optim_loss: 3459129.4691
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9263; val_auprc_score: 0.9863; val_best_acc_score: 0.9354; val_best_f1_score: 0.9640; train_kl_reg_loss: 13925.0077; train_edge_recon_loss: 610507.4958; train_cat_covariates_contrastive_loss: 948450.1320; train_gene_expr_recon_loss: 1835429.3087; train_masked_gp_l1_reg_loss: 10238.5852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12034.9454; train_global_loss: 3430585.4746; train_optim_loss: 3430585.4746; val_kl_reg_loss: 13216.7533; val_edge_recon_loss: 636126.2098; val_cat_covariates_contrastive_loss: 948642.9601; val_gene_expr_recon_loss: 1837317.4271; val_masked_gp_l1_reg_loss: 10245.7725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12041.9092; val_global_loss: 3457591.1019; val_optim_loss: 3457591.1019
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9229; val_auprc_score: 0.9856; val_best_acc_score: 0.9346; val_best_f1_score: 0.9636; train_kl_reg_loss: 14102.4790; train_edge_recon_loss: 610004.4568; train_cat_covariates_contrastive_loss: 948661.0330; train_gene_expr_recon_loss: 1834706.5054; train_masked_gp_l1_reg_loss: 10261.2122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12049.9330; train_global_loss: 3429785.6186; train_optim_loss: 3429785.6186; val_kl_reg_loss: 13615.6006; val_edge_recon_loss: 632593.5703; val_cat_covariates_contrastive_loss: 947620.1294; val_gene_expr_recon_loss: 1835857.3264; val_masked_gp_l1_reg_loss: 10273.9404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12054.0127; val_global_loss: 3452014.6265; val_optim_loss: 3452014.6265
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9252; val_auprc_score: 0.9862; val_best_acc_score: 0.9360; val_best_f1_score: 0.9644; train_kl_reg_loss: 16030.9521; train_edge_recon_loss: 610624.7624; train_cat_covariates_contrastive_loss: 948562.3122; train_gene_expr_recon_loss: 1833540.8346; train_masked_gp_l1_reg_loss: 10288.0763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12058.6899; train_global_loss: 3431105.6262; train_optim_loss: 3431105.6262; val_kl_reg_loss: 13141.2097; val_edge_recon_loss: 630140.7415; val_cat_covariates_contrastive_loss: 948486.8121; val_gene_expr_recon_loss: 1834423.8769; val_masked_gp_l1_reg_loss: 10304.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12062.0225; val_global_loss: 3448558.6412; val_optim_loss: 3448558.6412
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9254; val_auprc_score: 0.9863; val_best_acc_score: 0.9356; val_best_f1_score: 0.9641; train_kl_reg_loss: 13922.8240; train_edge_recon_loss: 610118.1823; train_cat_covariates_contrastive_loss: 948405.7325; train_gene_expr_recon_loss: 1832972.5810; train_masked_gp_l1_reg_loss: 10317.7732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12055.1477; train_global_loss: 3427792.2413; train_optim_loss: 3427792.2413; val_kl_reg_loss: 13325.7156; val_edge_recon_loss: 630847.1726; val_cat_covariates_contrastive_loss: 948404.1769; val_gene_expr_recon_loss: 1833924.2704; val_masked_gp_l1_reg_loss: 10330.0029; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12060.7529; val_global_loss: 3448892.0965; val_optim_loss: 3448892.0965
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9266; val_auprc_score: 0.9864; val_best_acc_score: 0.9367; val_best_f1_score: 0.9647; train_kl_reg_loss: 13916.9281; train_edge_recon_loss: 608806.4565; train_cat_covariates_contrastive_loss: 948369.6989; train_gene_expr_recon_loss: 1832064.9309; train_masked_gp_l1_reg_loss: 10341.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12050.3246; train_global_loss: 3425549.4154; train_optim_loss: 3425549.4154; val_kl_reg_loss: 13486.8051; val_edge_recon_loss: 631674.0228; val_cat_covariates_contrastive_loss: 948217.7195; val_gene_expr_recon_loss: 1833903.8684; val_masked_gp_l1_reg_loss: 10353.9463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12055.8789; val_global_loss: 3449692.4167; val_optim_loss: 3449692.4167
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9279; val_auprc_score: 0.9867; val_best_acc_score: 0.9359; val_best_f1_score: 0.9643; train_kl_reg_loss: 13844.7089; train_edge_recon_loss: 609689.2211; train_cat_covariates_contrastive_loss: 948348.9297; train_gene_expr_recon_loss: 1831140.9703; train_masked_gp_l1_reg_loss: 10362.7724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12048.4264; train_global_loss: 3425435.0259; train_optim_loss: 3425435.0259; val_kl_reg_loss: 13463.1180; val_edge_recon_loss: 632571.5116; val_cat_covariates_contrastive_loss: 948388.5802; val_gene_expr_recon_loss: 1834321.0285; val_masked_gp_l1_reg_loss: 10373.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12035.1680; val_global_loss: 3451153.2330; val_optim_loss: 3451153.2330
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9276; val_auprc_score: 0.9866; val_best_acc_score: 0.9359; val_best_f1_score: 0.9643; train_kl_reg_loss: 15154.6037; train_edge_recon_loss: 611787.1707; train_cat_covariates_contrastive_loss: 948300.8037; train_gene_expr_recon_loss: 1831419.9760; train_masked_gp_l1_reg_loss: 10381.6649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12051.3493; train_global_loss: 3429095.5685; train_optim_loss: 3429095.5685; val_kl_reg_loss: 13433.8125; val_edge_recon_loss: 632243.8535; val_cat_covariates_contrastive_loss: 948185.9286; val_gene_expr_recon_loss: 1833653.7411; val_masked_gp_l1_reg_loss: 10397.1426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12066.9844; val_global_loss: 3449981.5895; val_optim_loss: 3449981.5895

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9272; val_auprc_score: 0.9864; val_best_acc_score: 0.9363; val_best_f1_score: 0.9647; train_kl_reg_loss: 13896.3440; train_edge_recon_loss: 611411.0414; train_cat_covariates_contrastive_loss: 948196.2780; train_gene_expr_recon_loss: 1829514.9332; train_masked_gp_l1_reg_loss: 10292.9162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11734.0317; train_global_loss: 3425045.5401; train_optim_loss: 3425045.5401; val_kl_reg_loss: 13499.1979; val_edge_recon_loss: 632566.9858; val_cat_covariates_contrastive_loss: 948916.0307; val_gene_expr_recon_loss: 1833122.6941; val_masked_gp_l1_reg_loss: 10294.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11705.8428; val_global_loss: 3450104.9090; val_optim_loss: 3450104.9090
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9271; val_auprc_score: 0.9863; val_best_acc_score: 0.9359; val_best_f1_score: 0.9644; train_kl_reg_loss: 13874.9413; train_edge_recon_loss: 609487.8641; train_cat_covariates_contrastive_loss: 948190.5226; train_gene_expr_recon_loss: 1829442.4755; train_masked_gp_l1_reg_loss: 10297.6177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11700.7086; train_global_loss: 3422994.1283; train_optim_loss: 3422994.1283; val_kl_reg_loss: 13445.0894; val_edge_recon_loss: 634345.3633; val_cat_covariates_contrastive_loss: 947952.1049; val_gene_expr_recon_loss: 1833140.5112; val_masked_gp_l1_reg_loss: 10300.0537; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11695.7969; val_global_loss: 3450878.8133; val_optim_loss: 3450878.8133
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9265; val_auprc_score: 0.9862; val_best_acc_score: 0.9363; val_best_f1_score: 0.9645; train_kl_reg_loss: 13875.3294; train_edge_recon_loss: 610316.4784; train_cat_covariates_contrastive_loss: 948168.6831; train_gene_expr_recon_loss: 1829600.1120; train_masked_gp_l1_reg_loss: 10302.4162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11695.3950; train_global_loss: 3423958.4179; train_optim_loss: 3423958.4179; val_kl_reg_loss: 13342.4168; val_edge_recon_loss: 634221.8875; val_cat_covariates_contrastive_loss: 949436.4570; val_gene_expr_recon_loss: 1832460.2211; val_masked_gp_l1_reg_loss: 10303.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11691.4980; val_global_loss: 3451456.4823; val_optim_loss: 3451456.4823
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9241; val_auprc_score: 0.9858; val_best_acc_score: 0.9359; val_best_f1_score: 0.9643; train_kl_reg_loss: 13897.3685; train_edge_recon_loss: 610352.4418; train_cat_covariates_contrastive_loss: 948265.1685; train_gene_expr_recon_loss: 1829573.1651; train_masked_gp_l1_reg_loss: 10307.1173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11688.8527; train_global_loss: 3424084.1147; train_optim_loss: 3424084.1147; val_kl_reg_loss: 13539.2258; val_edge_recon_loss: 633143.2610; val_cat_covariates_contrastive_loss: 947636.4539; val_gene_expr_recon_loss: 1832030.3449; val_masked_gp_l1_reg_loss: 10309.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11689.5801; val_global_loss: 3448348.5502; val_optim_loss: 3448348.5502
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9269; val_auprc_score: 0.9862; val_best_acc_score: 0.9353; val_best_f1_score: 0.9640; train_kl_reg_loss: 13847.8921; train_edge_recon_loss: 612404.4289; train_cat_covariates_contrastive_loss: 948259.4022; train_gene_expr_recon_loss: 1828731.3756; train_masked_gp_l1_reg_loss: 10311.5486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11691.4567; train_global_loss: 3425246.0991; train_optim_loss: 3425246.0991; val_kl_reg_loss: 13304.8684; val_edge_recon_loss: 636353.3498; val_cat_covariates_contrastive_loss: 948458.9591; val_gene_expr_recon_loss: 1832603.8765; val_masked_gp_l1_reg_loss: 10314.6270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11692.5439; val_global_loss: 3452728.3025; val_optim_loss: 3452728.3025
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9278; val_auprc_score: 0.9866; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 13789.6787; train_edge_recon_loss: 610644.4432; train_cat_covariates_contrastive_loss: 948197.9083; train_gene_expr_recon_loss: 1829037.0926; train_masked_gp_l1_reg_loss: 10316.8410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11694.7993; train_global_loss: 3423680.7616; train_optim_loss: 3423680.7616; val_kl_reg_loss: 13377.4790; val_edge_recon_loss: 633819.1232; val_cat_covariates_contrastive_loss: 948552.0968; val_gene_expr_recon_loss: 1830937.9985; val_masked_gp_l1_reg_loss: 10319.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11695.3838; val_global_loss: 3448701.6921; val_optim_loss: 3448701.6921
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9280; val_auprc_score: 0.9866; val_best_acc_score: 0.9360; val_best_f1_score: 0.9643; train_kl_reg_loss: 13855.9702; train_edge_recon_loss: 611489.8459; train_cat_covariates_contrastive_loss: 948339.9956; train_gene_expr_recon_loss: 1829404.2309; train_masked_gp_l1_reg_loss: 10321.4962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11695.0509; train_global_loss: 3425106.5900; train_optim_loss: 3425106.5900; val_kl_reg_loss: 13413.3167; val_edge_recon_loss: 631325.2415; val_cat_covariates_contrastive_loss: 948002.1362; val_gene_expr_recon_loss: 1831290.6671; val_masked_gp_l1_reg_loss: 10322.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11702.2061; val_global_loss: 3446056.6042; val_optim_loss: 3446056.6042
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9280; val_auprc_score: 0.9867; val_best_acc_score: 0.9360; val_best_f1_score: 0.9644; train_kl_reg_loss: 13792.2342; train_edge_recon_loss: 610096.9202; train_cat_covariates_contrastive_loss: 948197.3500; train_gene_expr_recon_loss: 1829130.8451; train_masked_gp_l1_reg_loss: 10325.5514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11698.8062; train_global_loss: 3423241.7075; train_optim_loss: 3423241.7075; val_kl_reg_loss: 13320.7578; val_edge_recon_loss: 632159.9689; val_cat_covariates_contrastive_loss: 948454.7421; val_gene_expr_recon_loss: 1830650.7238; val_masked_gp_l1_reg_loss: 10328.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11697.6133; val_global_loss: 3446611.6906; val_optim_loss: 3446611.6906
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9283; val_auprc_score: 0.9866; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 13795.9244; train_edge_recon_loss: 609553.8290; train_cat_covariates_contrastive_loss: 948119.3006; train_gene_expr_recon_loss: 1829071.8663; train_masked_gp_l1_reg_loss: 10330.2435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11698.4013; train_global_loss: 3422569.5666; train_optim_loss: 3422569.5666; val_kl_reg_loss: 13355.3735; val_edge_recon_loss: 637591.3160; val_cat_covariates_contrastive_loss: 947880.8758; val_gene_expr_recon_loss: 1832135.8399; val_masked_gp_l1_reg_loss: 10332.7324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11692.5820; val_global_loss: 3452988.6543; val_optim_loss: 3452988.6543
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9277; val_auprc_score: 0.9864; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 13789.9327; train_edge_recon_loss: 611600.4373; train_cat_covariates_contrastive_loss: 948314.1303; train_gene_expr_recon_loss: 1828540.0939; train_masked_gp_l1_reg_loss: 10333.7896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11696.7811; train_global_loss: 3424275.1643; train_optim_loss: 3424275.1643; val_kl_reg_loss: 13389.7072; val_edge_recon_loss: 637468.2374; val_cat_covariates_contrastive_loss: 948138.7616; val_gene_expr_recon_loss: 1829582.8885; val_masked_gp_l1_reg_loss: 10335.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11701.8154; val_global_loss: 3450617.1011; val_optim_loss: 3450617.1011
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9291; val_auprc_score: 0.9870; val_best_acc_score: 0.9366; val_best_f1_score: 0.9647; train_kl_reg_loss: 13796.9027; train_edge_recon_loss: 607663.3042; train_cat_covariates_contrastive_loss: 948185.5358; train_gene_expr_recon_loss: 1828519.4657; train_masked_gp_l1_reg_loss: 10337.2362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11700.2096; train_global_loss: 3420202.6571; train_optim_loss: 3420202.6571; val_kl_reg_loss: 13395.0089; val_edge_recon_loss: 625527.8090; val_cat_covariates_contrastive_loss: 947749.4819; val_gene_expr_recon_loss: 1830668.1551; val_masked_gp_l1_reg_loss: 10339.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11701.2891; val_global_loss: 3439380.9599; val_optim_loss: 3439380.9599
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9258; val_auprc_score: 0.9861; val_best_acc_score: 0.9361; val_best_f1_score: 0.9645; train_kl_reg_loss: 13771.5426; train_edge_recon_loss: 608822.8864; train_cat_covariates_contrastive_loss: 948150.3554; train_gene_expr_recon_loss: 1828633.8937; train_masked_gp_l1_reg_loss: 10340.2536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11699.8267; train_global_loss: 3421418.7580; train_optim_loss: 3421418.7580; val_kl_reg_loss: 13456.0723; val_edge_recon_loss: 635858.0546; val_cat_covariates_contrastive_loss: 948241.7243; val_gene_expr_recon_loss: 1830936.9421; val_masked_gp_l1_reg_loss: 10341.9346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11700.4004; val_global_loss: 3450535.3002; val_optim_loss: 3450535.3002
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9274; val_auprc_score: 0.9863; val_best_acc_score: 0.9364; val_best_f1_score: 0.9645; train_kl_reg_loss: 13823.3482; train_edge_recon_loss: 607557.5548; train_cat_covariates_contrastive_loss: 948170.7598; train_gene_expr_recon_loss: 1829042.4240; train_masked_gp_l1_reg_loss: 10343.5176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11701.2530; train_global_loss: 3420638.8539; train_optim_loss: 3420638.8539; val_kl_reg_loss: 13385.4707; val_edge_recon_loss: 635663.6884; val_cat_covariates_contrastive_loss: 948171.3615; val_gene_expr_recon_loss: 1835969.1655; val_masked_gp_l1_reg_loss: 10346.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11712.5918; val_global_loss: 3455248.4306; val_optim_loss: 3455248.4306
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9290; val_auprc_score: 0.9869; val_best_acc_score: 0.9368; val_best_f1_score: 0.9649; train_kl_reg_loss: 13704.8434; train_edge_recon_loss: 610052.8396; train_cat_covariates_contrastive_loss: 948098.3928; train_gene_expr_recon_loss: 1832087.1443; train_masked_gp_l1_reg_loss: 10350.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11716.6125; train_global_loss: 3426009.8757; train_optim_loss: 3426009.8757; val_kl_reg_loss: 13322.0613; val_edge_recon_loss: 626457.3710; val_cat_covariates_contrastive_loss: 947720.3559; val_gene_expr_recon_loss: 1833706.2195; val_masked_gp_l1_reg_loss: 10353.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11706.6895; val_global_loss: 3443265.7569; val_optim_loss: 3443265.7569
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9273; val_auprc_score: 0.9864; val_best_acc_score: 0.9359; val_best_f1_score: 0.9643; train_kl_reg_loss: 13880.1920; train_edge_recon_loss: 610705.0259; train_cat_covariates_contrastive_loss: 948151.1612; train_gene_expr_recon_loss: 1831342.1727; train_masked_gp_l1_reg_loss: 10356.2231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11691.4278; train_global_loss: 3426126.1999; train_optim_loss: 3426126.1999; val_kl_reg_loss: 13340.5123; val_edge_recon_loss: 632646.3278; val_cat_covariates_contrastive_loss: 947643.6377; val_gene_expr_recon_loss: 1833429.9074; val_masked_gp_l1_reg_loss: 10357.8994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11676.7246; val_global_loss: 3449095.1265; val_optim_loss: 3449095.1265

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9268; val_auprc_score: 0.9863; val_best_acc_score: 0.9359; val_best_f1_score: 0.9644; train_kl_reg_loss: 13723.4636; train_edge_recon_loss: 609265.4626; train_cat_covariates_contrastive_loss: 948043.8475; train_gene_expr_recon_loss: 1830906.9826; train_masked_gp_l1_reg_loss: 10347.7740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11642.6461; train_global_loss: 3423930.1796; train_optim_loss: 3423930.1796; val_kl_reg_loss: 13304.5035; val_edge_recon_loss: 633128.9446; val_cat_covariates_contrastive_loss: 948221.0814; val_gene_expr_recon_loss: 1833206.8476; val_masked_gp_l1_reg_loss: 10347.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11636.2949; val_global_loss: 3449845.6273; val_optim_loss: 3449845.6273
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9279; val_auprc_score: 0.9867; val_best_acc_score: 0.9365; val_best_f1_score: 0.9647; train_kl_reg_loss: 13717.2955; train_edge_recon_loss: 610983.9962; train_cat_covariates_contrastive_loss: 948188.1249; train_gene_expr_recon_loss: 1831260.3525; train_masked_gp_l1_reg_loss: 10348.1645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11634.1395; train_global_loss: 3426132.1022; train_optim_loss: 3426132.1022; val_kl_reg_loss: 13340.4924; val_edge_recon_loss: 632135.8172; val_cat_covariates_contrastive_loss: 947837.5841; val_gene_expr_recon_loss: 1832524.3476; val_masked_gp_l1_reg_loss: 10348.4316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11632.1523; val_global_loss: 3447818.9884; val_optim_loss: 3447818.9884
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9272; val_auprc_score: 0.9864; val_best_acc_score: 0.9353; val_best_f1_score: 0.9639; train_kl_reg_loss: 13717.1719; train_edge_recon_loss: 608548.4723; train_cat_covariates_contrastive_loss: 948201.5364; train_gene_expr_recon_loss: 1830697.8671; train_masked_gp_l1_reg_loss: 10348.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11630.5365; train_global_loss: 3423144.3363; train_optim_loss: 3423144.3363; val_kl_reg_loss: 13328.8191; val_edge_recon_loss: 641360.1830; val_cat_covariates_contrastive_loss: 948248.8736; val_gene_expr_recon_loss: 1833872.9969; val_masked_gp_l1_reg_loss: 10349.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11628.8057; val_global_loss: 3458788.6235; val_optim_loss: 3458788.6235
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.9288; val_auprc_score: 0.9868; val_best_acc_score: 0.9365; val_best_f1_score: 0.9647; train_kl_reg_loss: 13683.7509; train_edge_recon_loss: 612073.6056; train_cat_covariates_contrastive_loss: 947925.9884; train_gene_expr_recon_loss: 1830542.8801; train_masked_gp_l1_reg_loss: 10349.3254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11627.1105; train_global_loss: 3426202.6542; train_optim_loss: 3426202.6542; val_kl_reg_loss: 13283.1420; val_edge_recon_loss: 635865.3014; val_cat_covariates_contrastive_loss: 948142.0895; val_gene_expr_recon_loss: 1832009.3904; val_masked_gp_l1_reg_loss: 10349.6240; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11624.7148; val_global_loss: 3451274.1752; val_optim_loss: 3451274.1752

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1060 min 39 sec.
Using best model state, which was in epoch 67.

--- MODEL EVALUATION ---
val AUROC score: 0.9073
val AUPRC score: 0.9795
val best accuracy score: 0.9336
val best F1 score: 0.9631
val target rna MSE score: 0.4172
val source rna MSE score: 0.1827
Val cat covariate0 mean sim diff: -0.0024
Val cat covariate1 mean sim diff: -0.0474
Val cat covariate2 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
