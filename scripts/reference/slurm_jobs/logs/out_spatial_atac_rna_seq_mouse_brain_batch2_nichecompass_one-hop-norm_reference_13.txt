[True]
Run timestamp: 10082023_124106_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2602, n_latent: 2602, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7811; val_auprc_score: 0.7958; val_best_acc_score: 0.6202; val_best_f1_score: 0.7159; train_kl_reg_loss: 145185.0304; train_edge_recon_loss: 3597533.8588; train_gene_expr_recon_loss: 9268492.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551028.8607; train_global_loss: 14562240.4580; train_optim_loss: 14562240.4580; val_kl_reg_loss: 172490.3917; val_edge_recon_loss: 4059231.2667; val_gene_expr_recon_loss: 8401690.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1507506.4833; val_global_loss: 14140918.8000; val_optim_loss: 14140918.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8483; val_auprc_score: 0.8492; val_best_acc_score: 0.7576; val_best_f1_score: 0.7754; train_kl_reg_loss: 138720.9887; train_edge_recon_loss: 3526128.1069; train_gene_expr_recon_loss: 8366641.6908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1470322.3168; train_global_loss: 13501813.0916; train_optim_loss: 13501813.0916; val_kl_reg_loss: 111591.1667; val_edge_recon_loss: 3548853.3167; val_gene_expr_recon_loss: 8252084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1484373.2417; val_global_loss: 13396901.6667; val_optim_loss: 13396901.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8624; val_auprc_score: 0.8642; val_best_acc_score: 0.7688; val_best_f1_score: 0.7779; train_kl_reg_loss: 140757.6487; train_edge_recon_loss: 3155965.1260; train_gene_expr_recon_loss: 8263037.0954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1455845.3340; train_global_loss: 13015605.2137; train_optim_loss: 13015605.2137; val_kl_reg_loss: 137471.8036; val_edge_recon_loss: 3084126.4333; val_gene_expr_recon_loss: 8176408.9667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1469762.6667; val_global_loss: 12867769.8667; val_optim_loss: 12867769.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9190; val_auprc_score: 0.9091; val_best_acc_score: 0.8441; val_best_f1_score: 0.8476; train_kl_reg_loss: 131166.7482; train_edge_recon_loss: 3011476.6393; train_gene_expr_recon_loss: 8161098.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1441038.1240; train_global_loss: 12744779.7634; train_optim_loss: 12744779.7634; val_kl_reg_loss: 124884.4187; val_edge_recon_loss: 2942772.4000; val_gene_expr_recon_loss: 8080025.3667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1468078.9417; val_global_loss: 12615761.0667; val_optim_loss: 12615761.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9364; val_auprc_score: 0.9249; val_best_acc_score: 0.8704; val_best_f1_score: 0.8779; train_kl_reg_loss: 134609.6025; train_edge_recon_loss: 2861456.4332; train_gene_expr_recon_loss: 8075797.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1427167.9189; train_global_loss: 12499031.8473; train_optim_loss: 12499031.8473; val_kl_reg_loss: 133572.7333; val_edge_recon_loss: 2819306.3667; val_gene_expr_recon_loss: 7995327.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1444588.8500; val_global_loss: 12392795.8667; val_optim_loss: 12392795.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9369; val_auprc_score: 0.9236; val_best_acc_score: 0.8732; val_best_f1_score: 0.8805; train_kl_reg_loss: 129293.7803; train_edge_recon_loss: 2825142.3683; train_gene_expr_recon_loss: 7998336.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1414144.6231; train_global_loss: 12366916.9847; train_optim_loss: 12366916.9847; val_kl_reg_loss: 120483.9583; val_edge_recon_loss: 2839767.7000; val_gene_expr_recon_loss: 7899909.9667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1431648.4000; val_global_loss: 12291810.0667; val_optim_loss: 12291810.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9371; val_auprc_score: 0.9220; val_best_acc_score: 0.8760; val_best_f1_score: 0.8834; train_kl_reg_loss: 120909.5283; train_edge_recon_loss: 2810263.9218; train_gene_expr_recon_loss: 7936511.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1404141.8655; train_global_loss: 12271826.5038; train_optim_loss: 12271826.5038; val_kl_reg_loss: 112523.8354; val_edge_recon_loss: 2820544.1167; val_gene_expr_recon_loss: 7878857.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1424498.2500; val_global_loss: 12236423.4000; val_optim_loss: 12236423.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9439; val_auprc_score: 0.9292; val_best_acc_score: 0.8836; val_best_f1_score: 0.8881; train_kl_reg_loss: 113356.7183; train_edge_recon_loss: 2791724.9084; train_gene_expr_recon_loss: 7884165.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1408794.9036; train_global_loss: 12198042.0763; train_optim_loss: 12198042.0763; val_kl_reg_loss: 112858.7833; val_edge_recon_loss: 2788463.1833; val_gene_expr_recon_loss: 7836643.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1423648.2583; val_global_loss: 12161614.0000; val_optim_loss: 12161614.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9439; val_auprc_score: 0.9303; val_best_acc_score: 0.8835; val_best_f1_score: 0.8883; train_kl_reg_loss: 109055.2432; train_edge_recon_loss: 2786348.9714; train_gene_expr_recon_loss: 7831950.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1387269.8473; train_global_loss: 12114624.4656; train_optim_loss: 12114624.4656; val_kl_reg_loss: 109209.7286; val_edge_recon_loss: 2791462.2333; val_gene_expr_recon_loss: 7793101.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1412611.3333; val_global_loss: 12106384.6667; val_optim_loss: 12106384.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9501; val_auprc_score: 0.9384; val_best_acc_score: 0.8919; val_best_f1_score: 0.8978; train_kl_reg_loss: 105736.8358; train_edge_recon_loss: 2770882.4046; train_gene_expr_recon_loss: 7795540.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1379119.5124; train_global_loss: 12051279.2366; train_optim_loss: 12051279.2366; val_kl_reg_loss: 105258.7651; val_edge_recon_loss: 2751814.5000; val_gene_expr_recon_loss: 7747168.2333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1401549.7250; val_global_loss: 12005791.2000; val_optim_loss: 12005791.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9442; val_auprc_score: 0.9278; val_best_acc_score: 0.8852; val_best_f1_score: 0.8899; train_kl_reg_loss: 102182.9971; train_edge_recon_loss: 2758080.0534; train_gene_expr_recon_loss: 7754070.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1371242.0534; train_global_loss: 11985575.2901; train_optim_loss: 11985575.2901; val_kl_reg_loss: 99852.5135; val_edge_recon_loss: 2780496.8333; val_gene_expr_recon_loss: 7705343.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1391114.5500; val_global_loss: 11976807.0667; val_optim_loss: 11976807.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9519; val_auprc_score: 0.9394; val_best_acc_score: 0.8976; val_best_f1_score: 0.9022; train_kl_reg_loss: 99453.0088; train_edge_recon_loss: 2755118.3855; train_gene_expr_recon_loss: 7719779.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1364607.1174; train_global_loss: 11938958.3511; train_optim_loss: 11938958.3511; val_kl_reg_loss: 98198.6307; val_edge_recon_loss: 2744697.0333; val_gene_expr_recon_loss: 7640711.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1386794.3500; val_global_loss: 11870401.5333; val_optim_loss: 11870401.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9509; val_auprc_score: 0.9373; val_best_acc_score: 0.8923; val_best_f1_score: 0.8976; train_kl_reg_loss: 95195.9742; train_edge_recon_loss: 2744643.9580; train_gene_expr_recon_loss: 7685381.7748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1357971.9170; train_global_loss: 11883193.5802; train_optim_loss: 11883193.5802; val_kl_reg_loss: 90657.1000; val_edge_recon_loss: 2760647.9667; val_gene_expr_recon_loss: 7657411.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1387219.7000; val_global_loss: 11895936.4667; val_optim_loss: 11895936.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9541; val_auprc_score: 0.9404; val_best_acc_score: 0.8981; val_best_f1_score: 0.9027; train_kl_reg_loss: 92355.4292; train_edge_recon_loss: 2735085.8416; train_gene_expr_recon_loss: 7655768.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1352868.9962; train_global_loss: 11836078.8550; train_optim_loss: 11836078.8550; val_kl_reg_loss: 93184.8115; val_edge_recon_loss: 2747634.9500; val_gene_expr_recon_loss: 7602238.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1374454.1917; val_global_loss: 11817512.6000; val_optim_loss: 11817512.6000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9600; val_auprc_score: 0.9524; val_best_acc_score: 0.8998; val_best_f1_score: 0.9030; train_kl_reg_loss: 89948.3219; train_edge_recon_loss: 2729531.3989; train_gene_expr_recon_loss: 7628390.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1348019.5782; train_global_loss: 11795890.2824; train_optim_loss: 11795890.2824; val_kl_reg_loss: 89406.1948; val_edge_recon_loss: 2736061.7000; val_gene_expr_recon_loss: 7585534.3667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1367729.4083; val_global_loss: 11778731.7333; val_optim_loss: 11778731.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9553; val_auprc_score: 0.9417; val_best_acc_score: 0.8961; val_best_f1_score: 0.8991; train_kl_reg_loss: 88843.6232; train_edge_recon_loss: 2724869.7634; train_gene_expr_recon_loss: 7595353.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1342875.3597; train_global_loss: 11751941.8015; train_optim_loss: 11751941.8015; val_kl_reg_loss: 89511.2635; val_edge_recon_loss: 2758408.7833; val_gene_expr_recon_loss: 7543926.2333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1363158.0500; val_global_loss: 11755004.4000; val_optim_loss: 11755004.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9647; val_auprc_score: 0.9553; val_best_acc_score: 0.9051; val_best_f1_score: 0.9095; train_kl_reg_loss: 87447.5958; train_edge_recon_loss: 2706561.3874; train_gene_expr_recon_loss: 7566089.3626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1338736.1355; train_global_loss: 11698834.5038; train_optim_loss: 11698834.5038; val_kl_reg_loss: 87570.0266; val_edge_recon_loss: 2715411.2500; val_gene_expr_recon_loss: 7555221.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1362717.8167; val_global_loss: 11720920.2000; val_optim_loss: 11720920.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9640; val_auprc_score: 0.9554; val_best_acc_score: 0.9085; val_best_f1_score: 0.9118; train_kl_reg_loss: 84764.5754; train_edge_recon_loss: 2715064.7271; train_gene_expr_recon_loss: 7541543.3473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1334177.0115; train_global_loss: 11675549.6947; train_optim_loss: 11675549.6947; val_kl_reg_loss: 82487.2385; val_edge_recon_loss: 2722716.9667; val_gene_expr_recon_loss: 7525695.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1360562.9917; val_global_loss: 11691462.6667; val_optim_loss: 11691462.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9686; val_auprc_score: 0.9617; val_best_acc_score: 0.9159; val_best_f1_score: 0.9182; train_kl_reg_loss: 82916.9078; train_edge_recon_loss: 2706371.1698; train_gene_expr_recon_loss: 7516855.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1329845.8865; train_global_loss: 11635989.7481; train_optim_loss: 11635989.7481; val_kl_reg_loss: 79774.8250; val_edge_recon_loss: 2704126.5833; val_gene_expr_recon_loss: 7522336.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1355772.3500; val_global_loss: 11662010.0000; val_optim_loss: 11662010.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9663; val_auprc_score: 0.9551; val_best_acc_score: 0.9132; val_best_f1_score: 0.9142; train_kl_reg_loss: 82348.2725; train_edge_recon_loss: 2698917.2271; train_gene_expr_recon_loss: 7491026.3015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1325762.7137; train_global_loss: 11598054.5725; train_optim_loss: 11598054.5725; val_kl_reg_loss: 80659.5958; val_edge_recon_loss: 2705245.4167; val_gene_expr_recon_loss: 7475650.7667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1348469.3833; val_global_loss: 11610025.1333; val_optim_loss: 11610025.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9697; val_auprc_score: 0.9630; val_best_acc_score: 0.9162; val_best_f1_score: 0.9193; train_kl_reg_loss: 80310.9549; train_edge_recon_loss: 2697766.1565; train_gene_expr_recon_loss: 7468908.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1322356.0582; train_global_loss: 11569342.0000; train_optim_loss: 11569342.0000; val_kl_reg_loss: 81539.1875; val_edge_recon_loss: 2715869.1000; val_gene_expr_recon_loss: 7480155.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1349144.8417; val_global_loss: 11626708.8667; val_optim_loss: 11626708.8667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9710; val_auprc_score: 0.9646; val_best_acc_score: 0.9163; val_best_f1_score: 0.9199; train_kl_reg_loss: 79612.4177; train_edge_recon_loss: 2691245.5897; train_gene_expr_recon_loss: 7445515.7290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1318675.3950; train_global_loss: 11535049.1450; train_optim_loss: 11535049.1450; val_kl_reg_loss: 77325.3677; val_edge_recon_loss: 2718855.3667; val_gene_expr_recon_loss: 7453405.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1349954.6917; val_global_loss: 11599541.2000; val_optim_loss: 11599541.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9768; val_auprc_score: 0.9724; val_best_acc_score: 0.9259; val_best_f1_score: 0.9274; train_kl_reg_loss: 77944.5755; train_edge_recon_loss: 2692044.7099; train_gene_expr_recon_loss: 7423923.3550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1316426.3655; train_global_loss: 11510339.0076; train_optim_loss: 11510339.0076; val_kl_reg_loss: 77013.7745; val_edge_recon_loss: 2695311.4500; val_gene_expr_recon_loss: 7482004.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1347937.4250; val_global_loss: 11602266.8667; val_optim_loss: 11602266.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9733; val_auprc_score: 0.9647; val_best_acc_score: 0.9248; val_best_f1_score: 0.9269; train_kl_reg_loss: 76796.5274; train_edge_recon_loss: 2687365.3321; train_gene_expr_recon_loss: 7409877.0420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1312573.8674; train_global_loss: 11486612.7863; train_optim_loss: 11486612.7863; val_kl_reg_loss: 78788.0125; val_edge_recon_loss: 2694912.1000; val_gene_expr_recon_loss: 7434394.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1340411.6250; val_global_loss: 11548506.8000; val_optim_loss: 11548506.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9764; val_auprc_score: 0.9716; val_best_acc_score: 0.9270; val_best_f1_score: 0.9297; train_kl_reg_loss: 75456.9426; train_edge_recon_loss: 2686567.7347; train_gene_expr_recon_loss: 7383792.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1309461.0983; train_global_loss: 11455278.2290; train_optim_loss: 11455278.2290; val_kl_reg_loss: 73023.8052; val_edge_recon_loss: 2708755.3167; val_gene_expr_recon_loss: 7437225.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1341850.3333; val_global_loss: 11560854.8667; val_optim_loss: 11560854.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9758; val_auprc_score: 0.9691; val_best_acc_score: 0.9258; val_best_f1_score: 0.9271; train_kl_reg_loss: 76511.0360; train_edge_recon_loss: 2698658.1908; train_gene_expr_recon_loss: 7654264.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1360430.5811; train_global_loss: 11789864.1985; train_optim_loss: 11789864.1985; val_kl_reg_loss: 47935.0117; val_edge_recon_loss: 2686841.3833; val_gene_expr_recon_loss: 7663766.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1383582.9750; val_global_loss: 11782126.2667; val_optim_loss: 11782126.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9747; val_auprc_score: 0.9677; val_best_acc_score: 0.9236; val_best_f1_score: 0.9257; train_kl_reg_loss: 71930.9320; train_edge_recon_loss: 2693232.1947; train_gene_expr_recon_loss: 7689297.6603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1368494.5735; train_global_loss: 11822955.3817; train_optim_loss: 11822955.3817; val_kl_reg_loss: 42637.0844; val_edge_recon_loss: 2698090.8500; val_gene_expr_recon_loss: 7740294.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1418921.3000; val_global_loss: 11899944.0000; val_optim_loss: 11899944.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9715; val_auprc_score: 0.9637; val_best_acc_score: 0.9216; val_best_f1_score: 0.9244; train_kl_reg_loss: 71307.7684; train_edge_recon_loss: 2694310.6164; train_gene_expr_recon_loss: 7851350.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1401646.8712; train_global_loss: 12018615.6336; train_optim_loss: 12018615.6336; val_kl_reg_loss: 24804.1035; val_edge_recon_loss: 2733513.2667; val_gene_expr_recon_loss: 8011790.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1436293.5833; val_global_loss: 12206401.4000; val_optim_loss: 12206401.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9735; val_auprc_score: 0.9660; val_best_acc_score: 0.9221; val_best_f1_score: 0.9250; train_kl_reg_loss: 79570.2507; train_edge_recon_loss: 2716352.0553; train_gene_expr_recon_loss: 8092608.1260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1413128.8655; train_global_loss: 12301659.2977; train_optim_loss: 12301659.2977; val_kl_reg_loss: 23606.5901; val_edge_recon_loss: 2723072.1167; val_gene_expr_recon_loss: 8090491.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1439040.3917; val_global_loss: 12276210.9333; val_optim_loss: 12276210.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9651; val_best_acc_score: 0.9227; val_best_f1_score: 0.9240; train_kl_reg_loss: 81647.0219; train_edge_recon_loss: 2707930.2156; train_gene_expr_recon_loss: 8102764.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1413912.3683; train_global_loss: 12306254.0534; train_optim_loss: 12306254.0534; val_kl_reg_loss: 25257.2292; val_edge_recon_loss: 2720380.1000; val_gene_expr_recon_loss: 8061953.0333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1440183.1083; val_global_loss: 12247773.6000; val_optim_loss: 12247773.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9748; val_auprc_score: 0.9671; val_best_acc_score: 0.9266; val_best_f1_score: 0.9281; train_kl_reg_loss: 80376.3840; train_edge_recon_loss: 2708512.8378; train_gene_expr_recon_loss: 8100659.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1412102.1317; train_global_loss: 12301650.7099; train_optim_loss: 12301650.7099; val_kl_reg_loss: 23759.1016; val_edge_recon_loss: 2710367.8000; val_gene_expr_recon_loss: 8083472.3667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1443123.3083; val_global_loss: 12260722.6667; val_optim_loss: 12260722.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9743; val_auprc_score: 0.9686; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 80388.9185; train_edge_recon_loss: 2715119.4542; train_gene_expr_recon_loss: 8111515.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1412100.4943; train_global_loss: 12319124.0687; train_optim_loss: 12319124.0687; val_kl_reg_loss: 23018.6350; val_edge_recon_loss: 2731285.1000; val_gene_expr_recon_loss: 8121834.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1431926.5000; val_global_loss: 12308064.9333; val_optim_loss: 12308064.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 19 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9748
val AUPRC score: 0.9699
val best accuracy score: 0.9247
val best F1 score: 0.9266
val target rna MSE score: 0.7727
val source rna MSE score: 0.2615
val target atac MSE score: 0.5942
val source atac MSE score: 0.1432
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
