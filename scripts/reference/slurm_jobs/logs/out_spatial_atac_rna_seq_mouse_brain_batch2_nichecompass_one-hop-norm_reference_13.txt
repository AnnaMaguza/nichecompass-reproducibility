[True]
Run timestamp: 07082023_172658_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9161; val_auprc_score: 0.9219; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 25331.4500; train_edge_recon_loss: 36320.7105; train_gene_expr_recon_loss: 652338.0903; train_masked_gp_l1_reg_loss: 8796.4784; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 801483.9236; train_global_loss: 1524270.6528; train_optim_loss: 1524270.6528; val_kl_reg_loss: 20015.0332; val_edge_recon_loss: 40659.8906; val_gene_expr_recon_loss: 578460.4375; val_masked_gp_l1_reg_loss: 7685.7832; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 781098.4375; val_global_loss: 1427919.6250; val_optim_loss: 1427919.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9110; val_auprc_score: 0.9141; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 26998.9516; train_edge_recon_loss: 39299.2331; train_gene_expr_recon_loss: 553218.7569; train_masked_gp_l1_reg_loss: 7368.6842; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 776348.3750; train_global_loss: 1403234.0000; train_optim_loss: 1403234.0000; val_kl_reg_loss: 29071.4258; val_edge_recon_loss: 40658.8320; val_gene_expr_recon_loss: 531518.7500; val_masked_gp_l1_reg_loss: 7109.4912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 763659.1250; val_global_loss: 1372017.6250; val_optim_loss: 1372017.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8896; val_auprc_score: 0.8912; val_best_acc_score: 0.5172; val_best_f1_score: 0.6744; train_kl_reg_loss: 29539.4288; train_edge_recon_loss: 39306.3529; train_gene_expr_recon_loss: 516463.3333; train_masked_gp_l1_reg_loss: 7098.8714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 764147.1389; train_global_loss: 1356555.1111; train_optim_loss: 1356555.1111; val_kl_reg_loss: 27873.8633; val_edge_recon_loss: 40644.0430; val_gene_expr_recon_loss: 498500.1562; val_masked_gp_l1_reg_loss: 7095.9453; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 752039.0625; val_global_loss: 1326153.0000; val_optim_loss: 1326153.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8690; val_auprc_score: 0.8668; val_best_acc_score: 0.5474; val_best_f1_score: 0.6879; train_kl_reg_loss: 28073.9466; train_edge_recon_loss: 39258.6832; train_gene_expr_recon_loss: 488356.8333; train_masked_gp_l1_reg_loss: 7044.1187; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 752551.0486; train_global_loss: 1315284.6389; train_optim_loss: 1315284.6389; val_kl_reg_loss: 28817.4668; val_edge_recon_loss: 40625.4062; val_gene_expr_recon_loss: 480170.1875; val_masked_gp_l1_reg_loss: 6946.1108; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 742740.1875; val_global_loss: 1299299.3750; val_optim_loss: 1299299.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8585; val_auprc_score: 0.8491; val_best_acc_score: 0.6126; val_best_f1_score: 0.7184; train_kl_reg_loss: 29153.1968; train_edge_recon_loss: 39224.7023; train_gene_expr_recon_loss: 469574.3715; train_masked_gp_l1_reg_loss: 6816.7930; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 745077.8958; train_global_loss: 1289846.9583; train_optim_loss: 1289846.9583; val_kl_reg_loss: 28411.3828; val_edge_recon_loss: 40575.6875; val_gene_expr_recon_loss: 466219.5625; val_masked_gp_l1_reg_loss: 6646.2119; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735796.3750; val_global_loss: 1277649.2500; val_optim_loss: 1277649.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8464; val_auprc_score: 0.8365; val_best_acc_score: 0.6583; val_best_f1_score: 0.7398; train_kl_reg_loss: 29585.1319; train_edge_recon_loss: 39203.8286; train_gene_expr_recon_loss: 460642.5382; train_masked_gp_l1_reg_loss: 6526.2156; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 739447.9514; train_global_loss: 1275405.6528; train_optim_loss: 1275405.6528; val_kl_reg_loss: 28622.5449; val_edge_recon_loss: 40510.9023; val_gene_expr_recon_loss: 455396.4375; val_masked_gp_l1_reg_loss: 6375.5430; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 729794.7500; val_global_loss: 1260700.2500; val_optim_loss: 1260700.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8592; val_auprc_score: 0.8484; val_best_acc_score: 0.6888; val_best_f1_score: 0.7546; train_kl_reg_loss: 30094.3021; train_edge_recon_loss: 39233.3602; train_gene_expr_recon_loss: 451088.4132; train_masked_gp_l1_reg_loss: 6279.9014; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735044.5347; train_global_loss: 1261740.5139; train_optim_loss: 1261740.5139; val_kl_reg_loss: 29707.9492; val_edge_recon_loss: 40477.3516; val_gene_expr_recon_loss: 446567.2500; val_masked_gp_l1_reg_loss: 6163.1206; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723790.3125; val_global_loss: 1246706.0000; val_optim_loss: 1246706.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8725; val_auprc_score: 0.8656; val_best_acc_score: 0.7309; val_best_f1_score: 0.7780; train_kl_reg_loss: 31093.9510; train_edge_recon_loss: 39266.1975; train_gene_expr_recon_loss: 440732.8507; train_masked_gp_l1_reg_loss: 6087.0554; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726064.4097; train_global_loss: 1243244.4444; train_optim_loss: 1243244.4444; val_kl_reg_loss: 30845.0508; val_edge_recon_loss: 40424.9805; val_gene_expr_recon_loss: 439550.4375; val_masked_gp_l1_reg_loss: 5996.4268; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718592.0625; val_global_loss: 1235409.0000; val_optim_loss: 1235409.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8745; val_auprc_score: 0.8684; val_best_acc_score: 0.7577; val_best_f1_score: 0.7926; train_kl_reg_loss: 31293.0302; train_edge_recon_loss: 39245.6359; train_gene_expr_recon_loss: 436217.8264; train_masked_gp_l1_reg_loss: 5943.3653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 720239.9722; train_global_loss: 1232939.8472; train_optim_loss: 1232939.8472; val_kl_reg_loss: 31203.1055; val_edge_recon_loss: 40355.8750; val_gene_expr_recon_loss: 434228.7500; val_masked_gp_l1_reg_loss: 5881.8730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714064.6875; val_global_loss: 1225734.2500; val_optim_loss: 1225734.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8835; val_auprc_score: 0.8766; val_best_acc_score: 0.7914; val_best_f1_score: 0.8120; train_kl_reg_loss: 31616.4223; train_edge_recon_loss: 39222.0556; train_gene_expr_recon_loss: 432945.1354; train_masked_gp_l1_reg_loss: 5852.4019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718278.5764; train_global_loss: 1227914.6111; train_optim_loss: 1227914.6111; val_kl_reg_loss: 29868.9648; val_edge_recon_loss: 40282.4570; val_gene_expr_recon_loss: 430999.3125; val_masked_gp_l1_reg_loss: 5813.9971; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710950.5625; val_global_loss: 1217915.2500; val_optim_loss: 1217915.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8858; val_auprc_score: 0.8791; val_best_acc_score: 0.7955; val_best_f1_score: 0.8121; train_kl_reg_loss: 31376.7567; train_edge_recon_loss: 39199.1124; train_gene_expr_recon_loss: 426920.6528; train_masked_gp_l1_reg_loss: 5790.9469; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713733.9722; train_global_loss: 1217021.4722; train_optim_loss: 1217021.4722; val_kl_reg_loss: 30460.4316; val_edge_recon_loss: 40247.1953; val_gene_expr_recon_loss: 426890.6875; val_masked_gp_l1_reg_loss: 5761.2349; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707467.7500; val_global_loss: 1210827.2500; val_optim_loss: 1210827.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8938; val_auprc_score: 0.8899; val_best_acc_score: 0.8154; val_best_f1_score: 0.8236; train_kl_reg_loss: 31493.9351; train_edge_recon_loss: 39198.6107; train_gene_expr_recon_loss: 423462.8229; train_masked_gp_l1_reg_loss: 5745.1673; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712947.6042; train_global_loss: 1212848.1250; train_optim_loss: 1212848.1250; val_kl_reg_loss: 28352.7227; val_edge_recon_loss: 40188.5859; val_gene_expr_recon_loss: 425729.4375; val_masked_gp_l1_reg_loss: 5724.4688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705308.9375; val_global_loss: 1205304.1250; val_optim_loss: 1205304.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9023; val_auprc_score: 0.8972; val_best_acc_score: 0.8259; val_best_f1_score: 0.8312; train_kl_reg_loss: 30998.8743; train_edge_recon_loss: 39179.9813; train_gene_expr_recon_loss: 423030.1146; train_masked_gp_l1_reg_loss: 5716.5748; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 707014.0417; train_global_loss: 1205939.5833; train_optim_loss: 1205939.5833; val_kl_reg_loss: 28690.4414; val_edge_recon_loss: 40162.1328; val_gene_expr_recon_loss: 422648.5625; val_masked_gp_l1_reg_loss: 5699.7051; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702415.8750; val_global_loss: 1199616.7500; val_optim_loss: 1199616.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9063; val_auprc_score: 0.9016; val_best_acc_score: 0.8376; val_best_f1_score: 0.8401; train_kl_reg_loss: 30701.9347; train_edge_recon_loss: 39170.5664; train_gene_expr_recon_loss: 418815.1910; train_masked_gp_l1_reg_loss: 5696.2490; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703965.4444; train_global_loss: 1198349.3889; train_optim_loss: 1198349.3889; val_kl_reg_loss: 28593.5430; val_edge_recon_loss: 40173.7031; val_gene_expr_recon_loss: 420178.3125; val_masked_gp_l1_reg_loss: 5686.4307; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699773.4375; val_global_loss: 1194405.5000; val_optim_loss: 1194405.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9132; val_auprc_score: 0.9073; val_best_acc_score: 0.8472; val_best_f1_score: 0.8466; train_kl_reg_loss: 30447.7949; train_edge_recon_loss: 39149.5564; train_gene_expr_recon_loss: 417760.0451; train_masked_gp_l1_reg_loss: 5683.1683; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704446.4444; train_global_loss: 1197487.0139; train_optim_loss: 1197487.0139; val_kl_reg_loss: 28166.0996; val_edge_recon_loss: 40101.0977; val_gene_expr_recon_loss: 418535.2500; val_masked_gp_l1_reg_loss: 5672.0889; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697860.3750; val_global_loss: 1190334.8750; val_optim_loss: 1190334.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9187; val_auprc_score: 0.9111; val_best_acc_score: 0.8506; val_best_f1_score: 0.8479; train_kl_reg_loss: 30092.2467; train_edge_recon_loss: 39116.6641; train_gene_expr_recon_loss: 413959.8889; train_masked_gp_l1_reg_loss: 5671.6962; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700564.9236; train_global_loss: 1189405.4028; train_optim_loss: 1189405.4028; val_kl_reg_loss: 27682.5703; val_edge_recon_loss: 40068.6328; val_gene_expr_recon_loss: 416889.7188; val_masked_gp_l1_reg_loss: 5662.5420; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 695979.2500; val_global_loss: 1186282.7500; val_optim_loss: 1186282.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9292; val_auprc_score: 0.9238; val_best_acc_score: 0.8537; val_best_f1_score: 0.8490; train_kl_reg_loss: 29678.5729; train_edge_recon_loss: 39083.5113; train_gene_expr_recon_loss: 414001.8681; train_masked_gp_l1_reg_loss: 5661.7475; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698708.1875; train_global_loss: 1187133.8750; train_optim_loss: 1187133.8750; val_kl_reg_loss: 27686.8750; val_edge_recon_loss: 40023.0039; val_gene_expr_recon_loss: 415067.9375; val_masked_gp_l1_reg_loss: 5658.9458; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693706.6250; val_global_loss: 1182143.3750; val_optim_loss: 1182143.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9308; val_auprc_score: 0.9215; val_best_acc_score: 0.8566; val_best_f1_score: 0.8508; train_kl_reg_loss: 29418.4158; train_edge_recon_loss: 39032.6567; train_gene_expr_recon_loss: 412192.5556; train_masked_gp_l1_reg_loss: 5661.3234; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695456.7639; train_global_loss: 1181761.7222; train_optim_loss: 1181761.7222; val_kl_reg_loss: 27961.5977; val_edge_recon_loss: 39989.6445; val_gene_expr_recon_loss: 413299.3125; val_masked_gp_l1_reg_loss: 5656.9268; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 691442.5625; val_global_loss: 1178350.0000; val_optim_loss: 1178350.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9356; val_auprc_score: 0.9294; val_best_acc_score: 0.8572; val_best_f1_score: 0.8502; train_kl_reg_loss: 29121.7457; train_edge_recon_loss: 38997.1780; train_gene_expr_recon_loss: 409854.4826; train_masked_gp_l1_reg_loss: 5659.6801; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694726.8125; train_global_loss: 1178359.9167; train_optim_loss: 1178359.9167; val_kl_reg_loss: 27509.5605; val_edge_recon_loss: 39936.2930; val_gene_expr_recon_loss: 412159.7188; val_masked_gp_l1_reg_loss: 5660.4370; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689835.5000; val_global_loss: 1175101.5000; val_optim_loss: 1175101.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9358; val_auprc_score: 0.9281; val_best_acc_score: 0.8533; val_best_f1_score: 0.8460; train_kl_reg_loss: 28767.3641; train_edge_recon_loss: 38949.6059; train_gene_expr_recon_loss: 408757.1181; train_masked_gp_l1_reg_loss: 5664.3466; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694149.8819; train_global_loss: 1176288.3056; train_optim_loss: 1176288.3056; val_kl_reg_loss: 27777.5586; val_edge_recon_loss: 39916.7148; val_gene_expr_recon_loss: 410729.9375; val_masked_gp_l1_reg_loss: 5662.2520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687668.9375; val_global_loss: 1171755.3750; val_optim_loss: 1171755.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9407; val_auprc_score: 0.9335; val_best_acc_score: 0.8546; val_best_f1_score: 0.8437; train_kl_reg_loss: 28443.9755; train_edge_recon_loss: 38908.8520; train_gene_expr_recon_loss: 408115.6771; train_masked_gp_l1_reg_loss: 5666.3488; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 689774.4583; train_global_loss: 1170909.3194; train_optim_loss: 1170909.3194; val_kl_reg_loss: 26395.4043; val_edge_recon_loss: 39846.9805; val_gene_expr_recon_loss: 410429.8750; val_masked_gp_l1_reg_loss: 5665.5640; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686485.6250; val_global_loss: 1168823.5000; val_optim_loss: 1168823.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9415; val_auprc_score: 0.9359; val_best_acc_score: 0.8508; val_best_f1_score: 0.8404; train_kl_reg_loss: 28028.0788; train_edge_recon_loss: 38862.2435; train_gene_expr_recon_loss: 408128.8472; train_masked_gp_l1_reg_loss: 5668.1938; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688125.3681; train_global_loss: 1168812.7361; train_optim_loss: 1168812.7361; val_kl_reg_loss: 27005.8906; val_edge_recon_loss: 39823.7891; val_gene_expr_recon_loss: 408764.6250; val_masked_gp_l1_reg_loss: 5666.0425; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 684509.3750; val_global_loss: 1165769.7500; val_optim_loss: 1165769.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9453; val_auprc_score: 0.9397; val_best_acc_score: 0.8499; val_best_f1_score: 0.8360; train_kl_reg_loss: 27800.0221; train_edge_recon_loss: 38817.9909; train_gene_expr_recon_loss: 408166.0417; train_masked_gp_l1_reg_loss: 5677.6900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690156.7708; train_global_loss: 1170618.5139; train_optim_loss: 1170618.5139; val_kl_reg_loss: 26393.5254; val_edge_recon_loss: 39772.6875; val_gene_expr_recon_loss: 408105.6250; val_masked_gp_l1_reg_loss: 5683.2725; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 683054.5625; val_global_loss: 1163009.7500; val_optim_loss: 1163009.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9496; val_auprc_score: 0.9454; val_best_acc_score: 0.8484; val_best_f1_score: 0.8469; train_kl_reg_loss: 27314.1562; train_edge_recon_loss: 38778.9852; train_gene_expr_recon_loss: 406046.8611; train_masked_gp_l1_reg_loss: 5696.6939; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684667.9167; train_global_loss: 1162504.6111; train_optim_loss: 1162504.6111; val_kl_reg_loss: 25924.4453; val_edge_recon_loss: 39713.7773; val_gene_expr_recon_loss: 407352.6875; val_masked_gp_l1_reg_loss: 5700.4399; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 682008.6875; val_global_loss: 1160700.0000; val_optim_loss: 1160700.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9510; val_auprc_score: 0.9462; val_best_acc_score: 0.8459; val_best_f1_score: 0.8473; train_kl_reg_loss: 27082.4920; train_edge_recon_loss: 38747.4722; train_gene_expr_recon_loss: 406197.1910; train_masked_gp_l1_reg_loss: 5704.6518; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 685855.4444; train_global_loss: 1163587.2639; train_optim_loss: 1163587.2639; val_kl_reg_loss: 25784.9922; val_edge_recon_loss: 39700.6055; val_gene_expr_recon_loss: 406471.5000; val_masked_gp_l1_reg_loss: 5707.5488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 680591.8750; val_global_loss: 1158256.5000; val_optim_loss: 1158256.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9464; val_auprc_score: 0.9400; val_best_acc_score: 0.8754; val_best_f1_score: 0.8815; train_kl_reg_loss: 26092.1506; train_edge_recon_loss: 40146.4002; train_gene_expr_recon_loss: 413416.7604; train_masked_gp_l1_reg_loss: 5721.2391; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690452.2083; train_global_loss: 1175828.7778; train_optim_loss: 1175828.7778; val_kl_reg_loss: 22462.5938; val_edge_recon_loss: 40317.8438; val_gene_expr_recon_loss: 414228.0938; val_masked_gp_l1_reg_loss: 5719.2500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 688537.5000; val_global_loss: 1171265.2500; val_optim_loss: 1171265.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9431; val_auprc_score: 0.9379; val_best_acc_score: 0.8723; val_best_f1_score: 0.8788; train_kl_reg_loss: 24220.1122; train_edge_recon_loss: 40198.1376; train_gene_expr_recon_loss: 413120.2222; train_masked_gp_l1_reg_loss: 5707.9042; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 692868.3611; train_global_loss: 1176114.7778; train_optim_loss: 1176114.7778; val_kl_reg_loss: 21732.9727; val_edge_recon_loss: 40312.2109; val_gene_expr_recon_loss: 412961.2500; val_masked_gp_l1_reg_loss: 5688.6260; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687605.6875; val_global_loss: 1168300.7500; val_optim_loss: 1168300.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9485; val_auprc_score: 0.9426; val_best_acc_score: 0.8826; val_best_f1_score: 0.8852; train_kl_reg_loss: 23249.7181; train_edge_recon_loss: 40152.4887; train_gene_expr_recon_loss: 409837.8611; train_masked_gp_l1_reg_loss: 5681.7753; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 692266.2014; train_global_loss: 1171188.0694; train_optim_loss: 1171188.0694; val_kl_reg_loss: 20530.4570; val_edge_recon_loss: 40204.5977; val_gene_expr_recon_loss: 412824.3125; val_masked_gp_l1_reg_loss: 5667.7754; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687049.8125; val_global_loss: 1166277.0000; val_optim_loss: 1166277.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9519; val_auprc_score: 0.9493; val_best_acc_score: 0.8804; val_best_f1_score: 0.8821; train_kl_reg_loss: 22501.2027; train_edge_recon_loss: 40075.6693; train_gene_expr_recon_loss: 409381.7743; train_masked_gp_l1_reg_loss: 5661.6918; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 685599.9861; train_global_loss: 1163220.3333; train_optim_loss: 1163220.3333; val_kl_reg_loss: 20652.1133; val_edge_recon_loss: 40176.5469; val_gene_expr_recon_loss: 411490.0312; val_masked_gp_l1_reg_loss: 5650.0596; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685854.0625; val_global_loss: 1163822.7500; val_optim_loss: 1163822.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9463; val_auprc_score: 0.9418; val_best_acc_score: 0.8720; val_best_f1_score: 0.8749; train_kl_reg_loss: 22244.2910; train_edge_recon_loss: 40051.9588; train_gene_expr_recon_loss: 410892.4236; train_masked_gp_l1_reg_loss: 5619.0400; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690302.2778; train_global_loss: 1169109.9722; train_optim_loss: 1169109.9722; val_kl_reg_loss: 20926.4883; val_edge_recon_loss: 40180.7227; val_gene_expr_recon_loss: 411062.8125; val_masked_gp_l1_reg_loss: 5590.7979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685526.0625; val_global_loss: 1163286.8750; val_optim_loss: 1163286.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9480; val_auprc_score: 0.9444; val_best_acc_score: 0.8771; val_best_f1_score: 0.8791; train_kl_reg_loss: 22090.8900; train_edge_recon_loss: 40053.8546; train_gene_expr_recon_loss: 408345.2292; train_masked_gp_l1_reg_loss: 5582.4539; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687164.3472; train_global_loss: 1163236.7917; train_optim_loss: 1163236.7917; val_kl_reg_loss: 20842.6602; val_edge_recon_loss: 40179.1367; val_gene_expr_recon_loss: 410951.6875; val_masked_gp_l1_reg_loss: 5569.7896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685366.6875; val_global_loss: 1162910.0000; val_optim_loss: 1162910.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9455; val_auprc_score: 0.9377; val_best_acc_score: 0.8758; val_best_f1_score: 0.8779; train_kl_reg_loss: 22098.0922; train_edge_recon_loss: 40053.2478; train_gene_expr_recon_loss: 409032.0000; train_masked_gp_l1_reg_loss: 5563.1298; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687899.6528; train_global_loss: 1164646.1111; train_optim_loss: 1164646.1111; val_kl_reg_loss: 20747.6504; val_edge_recon_loss: 40179.1133; val_gene_expr_recon_loss: 410990.8750; val_masked_gp_l1_reg_loss: 5555.4390; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685286.8750; val_global_loss: 1162760.0000; val_optim_loss: 1162760.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9536; val_auprc_score: 0.9490; val_best_acc_score: 0.8852; val_best_f1_score: 0.8860; train_kl_reg_loss: 22044.8722; train_edge_recon_loss: 40046.1619; train_gene_expr_recon_loss: 410415.7431; train_masked_gp_l1_reg_loss: 5550.9767; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695086.4792; train_global_loss: 1173144.2500; train_optim_loss: 1173144.2500; val_kl_reg_loss: 20685.3203; val_edge_recon_loss: 40167.5273; val_gene_expr_recon_loss: 410951.1875; val_masked_gp_l1_reg_loss: 5546.1353; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 685205.6250; val_global_loss: 1162555.7500; val_optim_loss: 1162555.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9484
val AUPRC score: 0.9450
val best accuracy score: 0.8777
val best F1 score: 0.8809
val target rna MSE score: 0.4714
val source rna MSE score: 0.2825
val target atac MSE score: 0.1327
val source atac MSE score: 0.0174
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
