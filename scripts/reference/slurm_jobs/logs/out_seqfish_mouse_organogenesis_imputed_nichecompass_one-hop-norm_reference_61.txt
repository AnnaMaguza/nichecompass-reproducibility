[True]
Run timestamp: 26072023_223148_61.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_61']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8682; val_auprc_score: 0.9744; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 208589.1981; train_edge_recon_loss: 1138169.8349; train_gene_expr_recon_loss: 2331371.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3678130.6814; train_optim_loss: 3678130.6814; val_kl_reg_loss: 110538.1663; val_edge_recon_loss: 1202917.8724; val_gene_expr_recon_loss: 1393653.3177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2707109.3438; val_optim_loss: 2707109.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8567; val_auprc_score: 0.9719; val_best_acc_score: 0.8571; val_best_f1_score: 0.9225; train_kl_reg_loss: 85373.9108; train_edge_recon_loss: 1113165.8163; train_gene_expr_recon_loss: 1448745.7581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2647285.4860; train_optim_loss: 2647285.4860; val_kl_reg_loss: 46225.2031; val_edge_recon_loss: 1208733.3099; val_gene_expr_recon_loss: 1114641.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2369600.2292; val_optim_loss: 2369600.2292
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8417; val_auprc_score: 0.9699; val_best_acc_score: 0.8624; val_best_f1_score: 0.9246; train_kl_reg_loss: 53451.9719; train_edge_recon_loss: 1070225.1308; train_gene_expr_recon_loss: 1070721.3453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2194398.4494; train_optim_loss: 2194398.4494; val_kl_reg_loss: 44689.3726; val_edge_recon_loss: 1166582.7943; val_gene_expr_recon_loss: 1022817.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2234090.0000; val_optim_loss: 2234090.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8181; val_auprc_score: 0.9624; val_best_acc_score: 0.8646; val_best_f1_score: 0.9261; train_kl_reg_loss: 41395.3762; train_edge_recon_loss: 1044329.6038; train_gene_expr_recon_loss: 1018604.0343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2104329.0122; train_optim_loss: 2104329.0122; val_kl_reg_loss: 36043.6875; val_edge_recon_loss: 1158557.3568; val_gene_expr_recon_loss: 987016.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2181617.1406; val_optim_loss: 2181617.1406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8290; val_auprc_score: 0.9609; val_best_acc_score: 0.8786; val_best_f1_score: 0.9330; train_kl_reg_loss: 35020.1535; train_edge_recon_loss: 1028907.1116; train_gene_expr_recon_loss: 973914.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2037841.5372; train_optim_loss: 2037841.5372; val_kl_reg_loss: 29236.8097; val_edge_recon_loss: 1061308.9115; val_gene_expr_recon_loss: 952867.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2043413.7083; val_optim_loss: 2043413.7083
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8542; val_auprc_score: 0.9632; val_best_acc_score: 0.8850; val_best_f1_score: 0.9355; train_kl_reg_loss: 34965.8751; train_edge_recon_loss: 943197.3823; train_gene_expr_recon_loss: 945058.5587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1923221.8186; train_optim_loss: 1923221.8186; val_kl_reg_loss: 38011.5213; val_edge_recon_loss: 956444.2786; val_gene_expr_recon_loss: 928548.9661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1923004.7656; val_optim_loss: 1923004.7656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8580; val_auprc_score: 0.9656; val_best_acc_score: 0.8995; val_best_f1_score: 0.9433; train_kl_reg_loss: 37890.2928; train_edge_recon_loss: 876532.2047; train_gene_expr_recon_loss: 920151.5730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1834574.0750; train_optim_loss: 1834574.0750; val_kl_reg_loss: 35351.6126; val_edge_recon_loss: 896099.4089; val_gene_expr_recon_loss: 905320.4714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1836771.4948; val_optim_loss: 1836771.4948
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8638; val_auprc_score: 0.9683; val_best_acc_score: 0.9095; val_best_f1_score: 0.9492; train_kl_reg_loss: 34053.0191; train_edge_recon_loss: 859861.4610; train_gene_expr_recon_loss: 898715.9773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1792630.4599; train_optim_loss: 1792630.4599; val_kl_reg_loss: 30069.7047; val_edge_recon_loss: 831105.1797; val_gene_expr_recon_loss: 886029.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1747204.6510; val_optim_loss: 1747204.6510
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8744; val_auprc_score: 0.9701; val_best_acc_score: 0.9049; val_best_f1_score: 0.9460; train_kl_reg_loss: 29086.2026; train_edge_recon_loss: 847070.9483; train_gene_expr_recon_loss: 880472.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1756630.1419; train_optim_loss: 1756630.1419; val_kl_reg_loss: 27011.3437; val_edge_recon_loss: 873632.1484; val_gene_expr_recon_loss: 868658.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1769302.0312; val_optim_loss: 1769302.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8826; val_auprc_score: 0.9712; val_best_acc_score: 0.9067; val_best_f1_score: 0.9471; train_kl_reg_loss: 25403.7617; train_edge_recon_loss: 832705.3782; train_gene_expr_recon_loss: 864347.4686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1722456.6064; train_optim_loss: 1722456.6064; val_kl_reg_loss: 22175.4870; val_edge_recon_loss: 844143.2917; val_gene_expr_recon_loss: 853886.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1720205.6302; val_optim_loss: 1720205.6302
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8939; val_auprc_score: 0.9768; val_best_acc_score: 0.9073; val_best_f1_score: 0.9473; train_kl_reg_loss: 21427.0997; train_edge_recon_loss: 823754.5326; train_gene_expr_recon_loss: 849186.6645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1694368.2983; train_optim_loss: 1694368.2983; val_kl_reg_loss: 19184.9711; val_edge_recon_loss: 830439.2839; val_gene_expr_recon_loss: 839213.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1688837.4896; val_optim_loss: 1688837.4896
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8936; val_auprc_score: 0.9767; val_best_acc_score: 0.9062; val_best_f1_score: 0.9467; train_kl_reg_loss: 18467.2820; train_edge_recon_loss: 821570.2026; train_gene_expr_recon_loss: 835597.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1675635.0378; train_optim_loss: 1675635.0378; val_kl_reg_loss: 16718.8131; val_edge_recon_loss: 813889.5443; val_gene_expr_recon_loss: 826838.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1657446.4896; val_optim_loss: 1657446.4896
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9046; val_auprc_score: 0.9781; val_best_acc_score: 0.9068; val_best_f1_score: 0.9467; train_kl_reg_loss: 15793.8604; train_edge_recon_loss: 814657.6549; train_gene_expr_recon_loss: 822958.8767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1653410.3913; train_optim_loss: 1653410.3913; val_kl_reg_loss: 14495.5479; val_edge_recon_loss: 840633.2005; val_gene_expr_recon_loss: 815136.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1670265.5729; val_optim_loss: 1670265.5729
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9195; val_auprc_score: 0.9825; val_best_acc_score: 0.9175; val_best_f1_score: 0.9530; train_kl_reg_loss: 13961.4280; train_edge_recon_loss: 805246.5311; train_gene_expr_recon_loss: 811365.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1630573.6581; train_optim_loss: 1630573.6581; val_kl_reg_loss: 12393.0025; val_edge_recon_loss: 800564.4089; val_gene_expr_recon_loss: 805546.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1618504.0781; val_optim_loss: 1618504.0781
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9310; val_auprc_score: 0.9849; val_best_acc_score: 0.9231; val_best_f1_score: 0.9557; train_kl_reg_loss: 12683.0014; train_edge_recon_loss: 797070.2401; train_gene_expr_recon_loss: 800925.0849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1610678.3273; train_optim_loss: 1610678.3273; val_kl_reg_loss: 11386.8714; val_edge_recon_loss: 790398.2161; val_gene_expr_recon_loss: 795164.8177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1596949.9062; val_optim_loss: 1596949.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9419; val_auprc_score: 0.9868; val_best_acc_score: 0.9261; val_best_f1_score: 0.9571; train_kl_reg_loss: 11789.7546; train_edge_recon_loss: 787744.8154; train_gene_expr_recon_loss: 791473.1567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1591007.7291; train_optim_loss: 1591007.7291; val_kl_reg_loss: 11480.0037; val_edge_recon_loss: 808393.1901; val_gene_expr_recon_loss: 786149.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1606022.6979; val_optim_loss: 1606022.6979
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9443; val_auprc_score: 0.9875; val_best_acc_score: 0.9287; val_best_f1_score: 0.9583; train_kl_reg_loss: 11697.2697; train_edge_recon_loss: 782034.1105; train_gene_expr_recon_loss: 782206.8483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1575938.2262; train_optim_loss: 1575938.2262; val_kl_reg_loss: 11335.1440; val_edge_recon_loss: 815065.2344; val_gene_expr_recon_loss: 777978.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1604379.0365; val_optim_loss: 1604379.0365
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9451; val_auprc_score: 0.9878; val_best_acc_score: 0.9311; val_best_f1_score: 0.9600; train_kl_reg_loss: 11439.5363; train_edge_recon_loss: 778040.5305; train_gene_expr_recon_loss: 774642.6977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1564122.7686; train_optim_loss: 1564122.7686; val_kl_reg_loss: 10575.2452; val_edge_recon_loss: 791251.5234; val_gene_expr_recon_loss: 771066.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1572893.5365; val_optim_loss: 1572893.5365
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9474; val_auprc_score: 0.9878; val_best_acc_score: 0.9366; val_best_f1_score: 0.9631; train_kl_reg_loss: 11424.2162; train_edge_recon_loss: 780128.3049; train_gene_expr_recon_loss: 767169.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1558722.3262; train_optim_loss: 1558722.3262; val_kl_reg_loss: 11136.1084; val_edge_recon_loss: 797905.0807; val_gene_expr_recon_loss: 762999.8177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1572041.0052; val_optim_loss: 1572041.0052
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9531; val_auprc_score: 0.9895; val_best_acc_score: 0.9382; val_best_f1_score: 0.9642; train_kl_reg_loss: 10949.5857; train_edge_recon_loss: 777412.9102; train_gene_expr_recon_loss: 760445.5427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1548808.0448; train_optim_loss: 1548808.0448; val_kl_reg_loss: 10815.0819; val_edge_recon_loss: 779436.5964; val_gene_expr_recon_loss: 757872.0599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1548123.7448; val_optim_loss: 1548123.7448
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9519; val_auprc_score: 0.9887; val_best_acc_score: 0.9395; val_best_f1_score: 0.9645; train_kl_reg_loss: 10825.7728; train_edge_recon_loss: 774996.6593; train_gene_expr_recon_loss: 754421.3084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1540243.7384; train_optim_loss: 1540243.7384; val_kl_reg_loss: 10773.8181; val_edge_recon_loss: 802458.3203; val_gene_expr_recon_loss: 750654.5443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1563886.6927; val_optim_loss: 1563886.6927
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9522; val_auprc_score: 0.9887; val_best_acc_score: 0.9400; val_best_f1_score: 0.9653; train_kl_reg_loss: 10780.2159; train_edge_recon_loss: 773548.4669; train_gene_expr_recon_loss: 748663.3067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1532991.9913; train_optim_loss: 1532991.9913; val_kl_reg_loss: 10196.9573; val_edge_recon_loss: 773023.4479; val_gene_expr_recon_loss: 745892.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1529112.6875; val_optim_loss: 1529112.6875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9564; val_auprc_score: 0.9900; val_best_acc_score: 0.9447; val_best_f1_score: 0.9678; train_kl_reg_loss: 10833.8053; train_edge_recon_loss: 776449.4686; train_gene_expr_recon_loss: 743633.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1530916.8256; train_optim_loss: 1530916.8256; val_kl_reg_loss: 10818.0647; val_edge_recon_loss: 798169.7292; val_gene_expr_recon_loss: 741832.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1550820.3594; val_optim_loss: 1550820.3594
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9553; val_auprc_score: 0.9898; val_best_acc_score: 0.9442; val_best_f1_score: 0.9678; train_kl_reg_loss: 10656.4972; train_edge_recon_loss: 771711.7709; train_gene_expr_recon_loss: 738651.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1521019.6907; train_optim_loss: 1521019.6907; val_kl_reg_loss: 10577.9395; val_edge_recon_loss: 775124.8724; val_gene_expr_recon_loss: 736943.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522646.0625; val_optim_loss: 1522646.0625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9536; val_auprc_score: 0.9897; val_best_acc_score: 0.9418; val_best_f1_score: 0.9661; train_kl_reg_loss: 10858.8052; train_edge_recon_loss: 779675.8948; train_gene_expr_recon_loss: 734696.8744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1525231.5797; train_optim_loss: 1525231.5797; val_kl_reg_loss: 10430.0345; val_edge_recon_loss: 795725.8698; val_gene_expr_recon_loss: 732424.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1538580.8021; val_optim_loss: 1538580.8021
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9595; val_auprc_score: 0.9905; val_best_acc_score: 0.9503; val_best_f1_score: 0.9712; train_kl_reg_loss: 10829.0506; train_edge_recon_loss: 773330.0910; train_gene_expr_recon_loss: 730735.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514894.2907; train_optim_loss: 1514894.2907; val_kl_reg_loss: 8126.0555; val_edge_recon_loss: 766612.0729; val_gene_expr_recon_loss: 729139.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1503878.0677; val_optim_loss: 1503878.0677
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9609; val_auprc_score: 0.9908; val_best_acc_score: 0.9488; val_best_f1_score: 0.9703; train_kl_reg_loss: 10538.7157; train_edge_recon_loss: 768126.5128; train_gene_expr_recon_loss: 727199.9433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505865.1727; train_optim_loss: 1505865.1727; val_kl_reg_loss: 8104.3278; val_edge_recon_loss: 786593.2135; val_gene_expr_recon_loss: 725357.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520055.2344; val_optim_loss: 1520055.2344
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9561; val_auprc_score: 0.9894; val_best_acc_score: 0.9486; val_best_f1_score: 0.9701; train_kl_reg_loss: 10335.4052; train_edge_recon_loss: 774200.5965; train_gene_expr_recon_loss: 723662.9907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1508198.9936; train_optim_loss: 1508198.9936; val_kl_reg_loss: 8110.5231; val_edge_recon_loss: 781827.3099; val_gene_expr_recon_loss: 722535.9193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512473.7604; val_optim_loss: 1512473.7604
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9617; val_auprc_score: 0.9916; val_best_acc_score: 0.9475; val_best_f1_score: 0.9695; train_kl_reg_loss: 10173.9320; train_edge_recon_loss: 772764.1462; train_gene_expr_recon_loss: 720656.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503594.8326; train_optim_loss: 1503594.8326; val_kl_reg_loss: 7887.2691; val_edge_recon_loss: 806711.5599; val_gene_expr_recon_loss: 719692.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1534290.8646; val_optim_loss: 1534290.8646
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9641; val_auprc_score: 0.9914; val_best_acc_score: 0.9522; val_best_f1_score: 0.9723; train_kl_reg_loss: 10148.5872; train_edge_recon_loss: 765918.5235; train_gene_expr_recon_loss: 718061.0235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1494128.1308; train_optim_loss: 1494128.1308; val_kl_reg_loss: 8268.9995; val_edge_recon_loss: 778150.6849; val_gene_expr_recon_loss: 716075.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502494.8490; val_optim_loss: 1502494.8490
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9638; val_auprc_score: 0.9914; val_best_acc_score: 0.9547; val_best_f1_score: 0.9737; train_kl_reg_loss: 10011.6720; train_edge_recon_loss: 776243.7305; train_gene_expr_recon_loss: 715403.8631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501659.2645; train_optim_loss: 1501659.2645; val_kl_reg_loss: 7954.9753; val_edge_recon_loss: 772958.5000; val_gene_expr_recon_loss: 713800.9661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494714.4531; val_optim_loss: 1494714.4531
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9648; val_auprc_score: 0.9919; val_best_acc_score: 0.9524; val_best_f1_score: 0.9724; train_kl_reg_loss: 9901.5417; train_edge_recon_loss: 769160.2942; train_gene_expr_recon_loss: 712816.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491878.5820; train_optim_loss: 1491878.5820; val_kl_reg_loss: 8302.7635; val_edge_recon_loss: 778427.7812; val_gene_expr_recon_loss: 711331.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498061.7552; val_optim_loss: 1498061.7552
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9603; val_auprc_score: 0.9908; val_best_acc_score: 0.9527; val_best_f1_score: 0.9725; train_kl_reg_loss: 9597.0482; train_edge_recon_loss: 770088.9648; train_gene_expr_recon_loss: 710905.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490591.2471; train_optim_loss: 1490591.2471; val_kl_reg_loss: 8035.9362; val_edge_recon_loss: 782884.4167; val_gene_expr_recon_loss: 709276.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1500196.9583; val_optim_loss: 1500196.9583
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9687; val_auprc_score: 0.9924; val_best_acc_score: 0.9559; val_best_f1_score: 0.9745; train_kl_reg_loss: 9703.3508; train_edge_recon_loss: 772079.8927; train_gene_expr_recon_loss: 708679.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490463.2140; train_optim_loss: 1490463.2140; val_kl_reg_loss: 8261.9868; val_edge_recon_loss: 777589.5729; val_gene_expr_recon_loss: 707716.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1493568.0938; val_optim_loss: 1493568.0938
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9646; val_auprc_score: 0.9916; val_best_acc_score: 0.9583; val_best_f1_score: 0.9758; train_kl_reg_loss: 9557.3970; train_edge_recon_loss: 770785.0744; train_gene_expr_recon_loss: 706398.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1486741.2721; train_optim_loss: 1486741.2721; val_kl_reg_loss: 7703.4817; val_edge_recon_loss: 787887.2057; val_gene_expr_recon_loss: 707221.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502811.9896; val_optim_loss: 1502811.9896
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9665; val_auprc_score: 0.9916; val_best_acc_score: 0.9573; val_best_f1_score: 0.9751; train_kl_reg_loss: 9323.0817; train_edge_recon_loss: 766727.6773; train_gene_expr_recon_loss: 705447.7038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1481498.4674; train_optim_loss: 1481498.4674; val_kl_reg_loss: 8038.9076; val_edge_recon_loss: 792775.6953; val_gene_expr_recon_loss: 705141.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1505955.6875; val_optim_loss: 1505955.6875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9616; val_auprc_score: 0.9908; val_best_acc_score: 0.9548; val_best_f1_score: 0.9737; train_kl_reg_loss: 9238.1128; train_edge_recon_loss: 770310.6658; train_gene_expr_recon_loss: 703368.9767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1482917.7558; train_optim_loss: 1482917.7558; val_kl_reg_loss: 7855.5145; val_edge_recon_loss: 791701.8724; val_gene_expr_recon_loss: 702998.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502555.4062; val_optim_loss: 1502555.4062
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9686; val_auprc_score: 0.9927; val_best_acc_score: 0.9575; val_best_f1_score: 0.9754; train_kl_reg_loss: 9191.8240; train_edge_recon_loss: 770021.8110; train_gene_expr_recon_loss: 701946.9869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1481160.6244; train_optim_loss: 1481160.6244; val_kl_reg_loss: 7790.5262; val_edge_recon_loss: 765614.1380; val_gene_expr_recon_loss: 701949.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1475354.6146; val_optim_loss: 1475354.6146
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9685; val_auprc_score: 0.9929; val_best_acc_score: 0.9596; val_best_f1_score: 0.9765; train_kl_reg_loss: 9131.9771; train_edge_recon_loss: 772424.7424; train_gene_expr_recon_loss: 701040.0808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1482596.8023; train_optim_loss: 1482596.8023; val_kl_reg_loss: 7632.3535; val_edge_recon_loss: 780852.2005; val_gene_expr_recon_loss: 700208.4427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488693.0052; val_optim_loss: 1488693.0052
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9670; val_auprc_score: 0.9923; val_best_acc_score: 0.9589; val_best_f1_score: 0.9761; train_kl_reg_loss: 8900.5546; train_edge_recon_loss: 764881.9413; train_gene_expr_recon_loss: 699080.5401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1472863.0360; train_optim_loss: 1472863.0360; val_kl_reg_loss: 7742.9722; val_edge_recon_loss: 773308.9714; val_gene_expr_recon_loss: 699312.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1480364.2240; val_optim_loss: 1480364.2240
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9678; val_auprc_score: 0.9921; val_best_acc_score: 0.9581; val_best_f1_score: 0.9755; train_kl_reg_loss: 8810.1860; train_edge_recon_loss: 761733.4154; train_gene_expr_recon_loss: 697974.4988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1468518.0983; train_optim_loss: 1468518.0983; val_kl_reg_loss: 7875.2066; val_edge_recon_loss: 791555.2240; val_gene_expr_recon_loss: 699054.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498484.5573; val_optim_loss: 1498484.5573
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9714; val_auprc_score: 0.9935; val_best_acc_score: 0.9592; val_best_f1_score: 0.9763; train_kl_reg_loss: 8802.4441; train_edge_recon_loss: 771952.1581; train_gene_expr_recon_loss: 697559.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478314.5674; train_optim_loss: 1478314.5674; val_kl_reg_loss: 7877.5001; val_edge_recon_loss: 792449.1901; val_gene_expr_recon_loss: 696833.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1497160.6510; val_optim_loss: 1497160.6510

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9667; val_auprc_score: 0.9922; val_best_acc_score: 0.9602; val_best_f1_score: 0.9769; train_kl_reg_loss: 8922.3951; train_edge_recon_loss: 765403.0462; train_gene_expr_recon_loss: 694345.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1468671.1622; train_optim_loss: 1468671.1622; val_kl_reg_loss: 7872.4253; val_edge_recon_loss: 764016.0755; val_gene_expr_recon_loss: 693684.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1465572.8125; val_optim_loss: 1465572.8125
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9692; val_auprc_score: 0.9931; val_best_acc_score: 0.9581; val_best_f1_score: 0.9758; train_kl_reg_loss: 8848.1007; train_edge_recon_loss: 767328.2759; train_gene_expr_recon_loss: 693729.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1469906.2000; train_optim_loss: 1469906.2000; val_kl_reg_loss: 7902.2521; val_edge_recon_loss: 759211.8464; val_gene_expr_recon_loss: 694381.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1461495.8125; val_optim_loss: 1461495.8125
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9659; val_auprc_score: 0.9920; val_best_acc_score: 0.9611; val_best_f1_score: 0.9775; train_kl_reg_loss: 8766.4949; train_edge_recon_loss: 759091.2616; train_gene_expr_recon_loss: 693574.9177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1461432.6762; train_optim_loss: 1461432.6762; val_kl_reg_loss: 7851.5443; val_edge_recon_loss: 761224.7656; val_gene_expr_recon_loss: 694127.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1463203.4271; val_optim_loss: 1463203.4271
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9626; val_auprc_score: 0.9909; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 8727.1722; train_edge_recon_loss: 760349.8797; train_gene_expr_recon_loss: 693879.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1462956.4029; train_optim_loss: 1462956.4029; val_kl_reg_loss: 7888.0217; val_edge_recon_loss: 784163.2943; val_gene_expr_recon_loss: 695193.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1487244.7708; val_optim_loss: 1487244.7708
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9647; val_auprc_score: 0.9911; val_best_acc_score: 0.9576; val_best_f1_score: 0.9753; train_kl_reg_loss: 8726.6316; train_edge_recon_loss: 763825.1959; train_gene_expr_recon_loss: 693537.0785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1466088.9029; train_optim_loss: 1466088.9029; val_kl_reg_loss: 7880.9392; val_edge_recon_loss: 795976.2109; val_gene_expr_recon_loss: 694160.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498017.8073; val_optim_loss: 1498017.8073
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9718; val_auprc_score: 0.9939; val_best_acc_score: 0.9605; val_best_f1_score: 0.9771; train_kl_reg_loss: 8703.8169; train_edge_recon_loss: 767824.7148; train_gene_expr_recon_loss: 693394.5735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1469923.1064; train_optim_loss: 1469923.1064; val_kl_reg_loss: 7818.7876; val_edge_recon_loss: 775567.2969; val_gene_expr_recon_loss: 693403.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1476789.1875; val_optim_loss: 1476789.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9675; val_auprc_score: 0.9924; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 8682.8608; train_edge_recon_loss: 759767.7398; train_gene_expr_recon_loss: 693083.6448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1461534.2442; train_optim_loss: 1461534.2442; val_kl_reg_loss: 7845.7534; val_edge_recon_loss: 776125.4505; val_gene_expr_recon_loss: 694870.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1478841.2292; val_optim_loss: 1478841.2292
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9671; val_auprc_score: 0.9921; val_best_acc_score: 0.9577; val_best_f1_score: 0.9754; train_kl_reg_loss: 8705.4372; train_edge_recon_loss: 759534.1445; train_gene_expr_recon_loss: 692823.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1461063.0308; train_optim_loss: 1461063.0308; val_kl_reg_loss: 7853.7041; val_edge_recon_loss: 778768.0781; val_gene_expr_recon_loss: 693249.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1479871.2552; val_optim_loss: 1479871.2552
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9682; val_auprc_score: 0.9919; val_best_acc_score: 0.9591; val_best_f1_score: 0.9761; train_kl_reg_loss: 8707.6825; train_edge_recon_loss: 755632.8424; train_gene_expr_recon_loss: 693125.3544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1457465.8843; train_optim_loss: 1457465.8843; val_kl_reg_loss: 7838.3528; val_edge_recon_loss: 798333.4505; val_gene_expr_recon_loss: 693572.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1499744.4948; val_optim_loss: 1499744.4948
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9620; val_auprc_score: 0.9906; val_best_acc_score: 0.9574; val_best_f1_score: 0.9752; train_kl_reg_loss: 8660.7380; train_edge_recon_loss: 761652.2125; train_gene_expr_recon_loss: 692950.7887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1463263.7308; train_optim_loss: 1463263.7308; val_kl_reg_loss: 7817.5595; val_edge_recon_loss: 789808.1589; val_gene_expr_recon_loss: 694548.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492173.9844; val_optim_loss: 1492173.9844

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 30 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9705
Val AUPRC score: 0.9928
Val best accuracy score: 0.9608
Val best F1 score: 0.9772
Val gene expr MSE score: 171390.6374
Val cat covariate0 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
