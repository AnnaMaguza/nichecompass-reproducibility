[True]
Run timestamp: 01082023_085904_61.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_61']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8981; val_auprc_score: 0.9800; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 272495.3421; train_edge_recon_loss: 117541.9184; train_gene_expr_recon_loss: 49237322.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59159.4967; train_global_loss: 49686518.8889; train_optim_loss: 49686518.8889; val_kl_reg_loss: 411618.0312; val_edge_recon_loss: 115812.3828; val_gene_expr_recon_loss: 42083345.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54998.7109; val_global_loss: 42665775.3333; val_optim_loss: 42665775.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8743; val_auprc_score: 0.9741; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 405598.8819; train_edge_recon_loss: 119076.8287; train_gene_expr_recon_loss: 37307884.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51710.2977; train_global_loss: 37884270.7037; train_optim_loss: 37884270.7037; val_kl_reg_loss: 379188.7865; val_edge_recon_loss: 121339.1159; val_gene_expr_recon_loss: 32638236.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48535.5508; val_global_loss: 33187300.3333; val_optim_loss: 33187300.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8592; val_auprc_score: 0.9718; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 378737.2946; train_edge_recon_loss: 119920.5926; train_gene_expr_recon_loss: 30471286.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45897.5754; train_global_loss: 31015841.2963; train_optim_loss: 31015841.2963; val_kl_reg_loss: 326646.7344; val_edge_recon_loss: 116945.7552; val_gene_expr_recon_loss: 29504096.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43392.1641; val_global_loss: 29991081.6667; val_optim_loss: 29991081.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8474; val_auprc_score: 0.9684; val_best_acc_score: 0.8639; val_best_f1_score: 0.9260; train_kl_reg_loss: 330229.4670; train_edge_recon_loss: 119299.7357; train_gene_expr_recon_loss: 28955892.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41451.0503; train_global_loss: 29446872.8889; train_optim_loss: 29446872.8889; val_kl_reg_loss: 294154.4896; val_edge_recon_loss: 119333.8867; val_gene_expr_recon_loss: 28558151.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39688.1289; val_global_loss: 29011328.0000; val_optim_loss: 29011328.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8387; val_auprc_score: 0.9665; val_best_acc_score: 0.8798; val_best_f1_score: 0.9335; train_kl_reg_loss: 278741.7717; train_edge_recon_loss: 119454.6978; train_gene_expr_recon_loss: 28386081.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38493.0501; train_global_loss: 28822770.6667; train_optim_loss: 28822770.6667; val_kl_reg_loss: 246045.7005; val_edge_recon_loss: 118320.7878; val_gene_expr_recon_loss: 28178653.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37510.0469; val_global_loss: 28580530.0000; val_optim_loss: 28580530.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8447; val_auprc_score: 0.9669; val_best_acc_score: 0.8706; val_best_f1_score: 0.9269; train_kl_reg_loss: 237713.2173; train_edge_recon_loss: 119046.1479; train_gene_expr_recon_loss: 28055345.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37061.8095; train_global_loss: 28449167.0000; train_optim_loss: 28449167.0000; val_kl_reg_loss: 213473.3385; val_edge_recon_loss: 119707.5000; val_gene_expr_recon_loss: 27884000.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36841.7422; val_global_loss: 28254023.6667; val_optim_loss: 28254023.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8503; val_auprc_score: 0.9683; val_best_acc_score: 0.8748; val_best_f1_score: 0.9315; train_kl_reg_loss: 208581.0009; train_edge_recon_loss: 117444.2309; train_gene_expr_recon_loss: 27763032.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36794.2138; train_global_loss: 28125851.4815; train_optim_loss: 28125851.4815; val_kl_reg_loss: 189772.7240; val_edge_recon_loss: 117236.3997; val_gene_expr_recon_loss: 27591927.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36752.9844; val_global_loss: 27935688.3333; val_optim_loss: 27935688.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8626; val_auprc_score: 0.9708; val_best_acc_score: 0.8762; val_best_f1_score: 0.9316; train_kl_reg_loss: 186459.6444; train_edge_recon_loss: 117866.9339; train_gene_expr_recon_loss: 27504782.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36714.9970; train_global_loss: 27845823.7778; train_optim_loss: 27845823.7778; val_kl_reg_loss: 170198.5703; val_edge_recon_loss: 120314.6120; val_gene_expr_recon_loss: 27375963.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36675.7266; val_global_loss: 27703152.3333; val_optim_loss: 27703152.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8591; val_auprc_score: 0.9691; val_best_acc_score: 0.8753; val_best_f1_score: 0.9306; train_kl_reg_loss: 168189.0616; train_edge_recon_loss: 119025.6665; train_gene_expr_recon_loss: 27257515.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36638.6646; train_global_loss: 27581369.1111; train_optim_loss: 27581369.1111; val_kl_reg_loss: 150964.6354; val_edge_recon_loss: 120540.8737; val_gene_expr_recon_loss: 27106747.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36600.3867; val_global_loss: 27414852.6667; val_optim_loss: 27414852.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8723; val_auprc_score: 0.9725; val_best_acc_score: 0.8786; val_best_f1_score: 0.9315; train_kl_reg_loss: 106531.8932; train_edge_recon_loss: 119329.5330; train_gene_expr_recon_loss: 23835915.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36588.4010; train_global_loss: 24098365.1111; train_optim_loss: 24098365.1111; val_kl_reg_loss: 104829.6068; val_edge_recon_loss: 119172.0807; val_gene_expr_recon_loss: 22904823.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36577.4648; val_global_loss: 23165403.0000; val_optim_loss: 23165403.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8731; val_auprc_score: 0.9733; val_best_acc_score: 0.8814; val_best_f1_score: 0.9344; train_kl_reg_loss: 114299.5055; train_edge_recon_loss: 117114.9999; train_gene_expr_recon_loss: 22782794.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36545.5953; train_global_loss: 23050754.6667; train_optim_loss: 23050754.6667; val_kl_reg_loss: 111176.7070; val_edge_recon_loss: 115062.9518; val_gene_expr_recon_loss: 22670708.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36513.9531; val_global_loss: 22933462.6667; val_optim_loss: 22933462.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8803; val_auprc_score: 0.9740; val_best_acc_score: 0.8883; val_best_f1_score: 0.9378; train_kl_reg_loss: 114621.6335; train_edge_recon_loss: 117394.8218; train_gene_expr_recon_loss: 22564249.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36485.4138; train_global_loss: 22832751.1111; train_optim_loss: 22832751.1111; val_kl_reg_loss: 109701.3099; val_edge_recon_loss: 114830.3568; val_gene_expr_recon_loss: 22447457.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36456.5547; val_global_loss: 22708445.0000; val_optim_loss: 22708445.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8801; val_auprc_score: 0.9736; val_best_acc_score: 0.8824; val_best_f1_score: 0.9342; train_kl_reg_loss: 111711.4219; train_edge_recon_loss: 116891.0203; train_gene_expr_recon_loss: 22370888.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36428.8064; train_global_loss: 22635919.5556; train_optim_loss: 22635919.5556; val_kl_reg_loss: 105275.8372; val_edge_recon_loss: 119613.7214; val_gene_expr_recon_loss: 22285203.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36400.2695; val_global_loss: 22546493.3333; val_optim_loss: 22546493.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8858; val_auprc_score: 0.9753; val_best_acc_score: 0.8836; val_best_f1_score: 0.9345; train_kl_reg_loss: 108193.6195; train_edge_recon_loss: 116161.0029; train_gene_expr_recon_loss: 22189900.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36374.3479; train_global_loss: 22450629.7407; train_optim_loss: 22450629.7407; val_kl_reg_loss: 102680.0911; val_edge_recon_loss: 120910.4779; val_gene_expr_recon_loss: 22057450.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36347.2812; val_global_loss: 22317389.6667; val_optim_loss: 22317389.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8799; val_auprc_score: 0.9737; val_best_acc_score: 0.8842; val_best_f1_score: 0.9349; train_kl_reg_loss: 104665.2743; train_edge_recon_loss: 117783.5286; train_gene_expr_recon_loss: 22024183.8148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36320.2888; train_global_loss: 22282953.0370; train_optim_loss: 22282953.0370; val_kl_reg_loss: 99975.5625; val_edge_recon_loss: 117923.4922; val_gene_expr_recon_loss: 21920367.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36292.5469; val_global_loss: 22174558.3333; val_optim_loss: 22174558.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8885; val_auprc_score: 0.9768; val_best_acc_score: 0.8894; val_best_f1_score: 0.9376; train_kl_reg_loss: 101318.7250; train_edge_recon_loss: 116313.3053; train_gene_expr_recon_loss: 21860948.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36266.5528; train_global_loss: 22114846.5926; train_optim_loss: 22114846.5926; val_kl_reg_loss: 96226.4336; val_edge_recon_loss: 115512.2031; val_gene_expr_recon_loss: 21753890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36238.5703; val_global_loss: 22001866.6667; val_optim_loss: 22001866.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8930; val_auprc_score: 0.9769; val_best_acc_score: 0.8910; val_best_f1_score: 0.9382; train_kl_reg_loss: 98155.9967; train_edge_recon_loss: 116205.5181; train_gene_expr_recon_loss: 21704690.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36209.4040; train_global_loss: 21955261.2593; train_optim_loss: 21955261.2593; val_kl_reg_loss: 93027.6107; val_edge_recon_loss: 116593.0573; val_gene_expr_recon_loss: 21617350.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36177.5547; val_global_loss: 21863148.6667; val_optim_loss: 21863148.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8984; val_auprc_score: 0.9783; val_best_acc_score: 0.8935; val_best_f1_score: 0.9396; train_kl_reg_loss: 95268.3527; train_edge_recon_loss: 115237.3371; train_gene_expr_recon_loss: 21556857.8148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36145.4451; train_global_loss: 21803508.9259; train_optim_loss: 21803508.9259; val_kl_reg_loss: 91094.0898; val_edge_recon_loss: 114751.5625; val_gene_expr_recon_loss: 21479609.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36110.9297; val_global_loss: 21721565.3333; val_optim_loss: 21721565.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9036; val_auprc_score: 0.9796; val_best_acc_score: 0.8968; val_best_f1_score: 0.9411; train_kl_reg_loss: 92607.5462; train_edge_recon_loss: 115525.8349; train_gene_expr_recon_loss: 21410755.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36077.5131; train_global_loss: 21654966.2222; train_optim_loss: 21654966.2222; val_kl_reg_loss: 87952.1615; val_edge_recon_loss: 115190.9349; val_gene_expr_recon_loss: 21333270.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36042.0078; val_global_loss: 21572455.0000; val_optim_loss: 21572455.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9069; val_auprc_score: 0.9800; val_best_acc_score: 0.8985; val_best_f1_score: 0.9416; train_kl_reg_loss: 90094.8401; train_edge_recon_loss: 115901.0100; train_gene_expr_recon_loss: 21273282.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36007.1717; train_global_loss: 21515284.9630; train_optim_loss: 21515284.9630; val_kl_reg_loss: 85770.0404; val_edge_recon_loss: 118333.7500; val_gene_expr_recon_loss: 21199050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35970.8125; val_global_loss: 21439124.0000; val_optim_loss: 21439124.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9073; val_auprc_score: 0.9798; val_best_acc_score: 0.9009; val_best_f1_score: 0.9431; train_kl_reg_loss: 87765.6441; train_edge_recon_loss: 114285.2714; train_gene_expr_recon_loss: 21138178.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35934.5605; train_global_loss: 21376163.7407; train_optim_loss: 21376163.7407; val_kl_reg_loss: 83431.2839; val_edge_recon_loss: 114535.4688; val_gene_expr_recon_loss: 21061682.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35896.7383; val_global_loss: 21295545.0000; val_optim_loss: 21295545.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9142; val_auprc_score: 0.9816; val_best_acc_score: 0.9039; val_best_f1_score: 0.9445; train_kl_reg_loss: 85510.3986; train_edge_recon_loss: 115367.3205; train_gene_expr_recon_loss: 21013625.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35861.5448; train_global_loss: 21250364.5926; train_optim_loss: 21250364.5926; val_kl_reg_loss: 81162.5872; val_edge_recon_loss: 115535.6263; val_gene_expr_recon_loss: 20941088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35824.2266; val_global_loss: 21173610.0000; val_optim_loss: 21173610.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9154; val_auprc_score: 0.9827; val_best_acc_score: 0.9057; val_best_f1_score: 0.9455; train_kl_reg_loss: 82717.7153; train_edge_recon_loss: 114167.3367; train_gene_expr_recon_loss: 20878100.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35788.5453; train_global_loss: 21110774.6296; train_optim_loss: 21110774.6296; val_kl_reg_loss: 75744.5013; val_edge_recon_loss: 112829.1159; val_gene_expr_recon_loss: 20601027.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35751.0977; val_global_loss: 20825353.3333; val_optim_loss: 20825353.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8881; val_auprc_score: 0.9763; val_best_acc_score: 0.8627; val_best_f1_score: 0.9247; train_kl_reg_loss: 844019.1897; train_edge_recon_loss: 116489.6522; train_gene_expr_recon_loss: 116003268.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36038.0814; train_global_loss: 116999813.3333; train_optim_loss: 116999813.3333; val_kl_reg_loss: 505153.7448; val_edge_recon_loss: 122765.8893; val_gene_expr_recon_loss: 48748856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36280.3359; val_global_loss: 49413055.3333; val_optim_loss: 49413055.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8828; val_auprc_score: 0.9758; val_best_acc_score: 0.8671; val_best_f1_score: 0.9266; train_kl_reg_loss: 381707.2691; train_edge_recon_loss: 120667.7214; train_gene_expr_recon_loss: 41284664.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36127.4758; train_global_loss: 41823167.1111; train_optim_loss: 41823167.1111; val_kl_reg_loss: 278822.5208; val_edge_recon_loss: 121217.5365; val_gene_expr_recon_loss: 36818123.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35976.7305; val_global_loss: 37254139.3333; val_optim_loss: 37254139.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8692; val_auprc_score: 0.9724; val_best_acc_score: 0.8760; val_best_f1_score: 0.9302; train_kl_reg_loss: 254002.0917; train_edge_recon_loss: 119604.3666; train_gene_expr_recon_loss: 34857981.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35879.8638; train_global_loss: 35267468.0741; train_optim_loss: 35267468.0741; val_kl_reg_loss: 222874.0911; val_edge_recon_loss: 119523.6549; val_gene_expr_recon_loss: 34075057.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35794.3828; val_global_loss: 34453251.3333; val_optim_loss: 34453251.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8717; val_auprc_score: 0.9739; val_best_acc_score: 0.8792; val_best_f1_score: 0.9312; train_kl_reg_loss: 204210.0263; train_edge_recon_loss: 119651.1545; train_gene_expr_recon_loss: 34119617.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35730.5915; train_global_loss: 34479209.1852; train_optim_loss: 34479209.1852; val_kl_reg_loss: 171305.2266; val_edge_recon_loss: 116762.9310; val_gene_expr_recon_loss: 33327689.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35665.8047; val_global_loss: 33651421.6667; val_optim_loss: 33651421.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8728; val_auprc_score: 0.9734; val_best_acc_score: 0.8770; val_best_f1_score: 0.9298; train_kl_reg_loss: 176666.6059; train_edge_recon_loss: 119673.8856; train_gene_expr_recon_loss: 33327674.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35643.7420; train_global_loss: 33659658.7778; train_optim_loss: 33659658.7778; val_kl_reg_loss: 169818.9193; val_edge_recon_loss: 119123.9740; val_gene_expr_recon_loss: 33252358.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35634.3438; val_global_loss: 33576936.0000; val_optim_loss: 33576936.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8785; val_auprc_score: 0.9743; val_best_acc_score: 0.8800; val_best_f1_score: 0.9312; train_kl_reg_loss: 175528.3545; train_edge_recon_loss: 117568.2562; train_gene_expr_recon_loss: 33282496.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35628.5043; train_global_loss: 33611221.0000; train_optim_loss: 33611221.0000; val_kl_reg_loss: 168643.9479; val_edge_recon_loss: 119606.8789; val_gene_expr_recon_loss: 33230765.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35622.6211; val_global_loss: 33554638.0000; val_optim_loss: 33554638.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8743; val_auprc_score: 0.9743; val_best_acc_score: 0.8822; val_best_f1_score: 0.9327; train_kl_reg_loss: 174241.3168; train_edge_recon_loss: 118094.5454; train_gene_expr_recon_loss: 33221884.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35616.9982; train_global_loss: 33549837.4444; train_optim_loss: 33549837.4444; val_kl_reg_loss: 167301.1797; val_edge_recon_loss: 116085.5755; val_gene_expr_recon_loss: 33160049.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35611.1680; val_global_loss: 33479048.0000; val_optim_loss: 33479048.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8803; val_auprc_score: 0.9765; val_best_acc_score: 0.8831; val_best_f1_score: 0.9333; train_kl_reg_loss: 172773.3976; train_edge_recon_loss: 118805.7070; train_gene_expr_recon_loss: 33109901.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35605.4810; train_global_loss: 33437085.8148; train_optim_loss: 33437085.8148; val_kl_reg_loss: 166221.1641; val_edge_recon_loss: 113737.6549; val_gene_expr_recon_loss: 33061735.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35599.5312; val_global_loss: 33377294.3333; val_optim_loss: 33377294.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 33 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9188
val AUPRC score: 0.9818
val best accuracy score: 0.9073
val best F1 score: 0.9461
val target rna MSE score: 14.9335
val source rna MSE score: 4.7444
Val cat covariate0 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
