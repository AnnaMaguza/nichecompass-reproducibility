[True]
Run timestamp: 10082023_211131_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7394; val_auprc_score: 0.7672; val_best_acc_score: 0.5034; val_best_f1_score: 0.6679; train_kl_reg_loss: 107061.0884; train_edge_recon_loss: 3791898.7844; train_gene_expr_recon_loss: 28367177.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28437515.3740; train_global_loss: 60703652.3664; train_optim_loss: 60703652.3664; val_kl_reg_loss: 245538.8917; val_edge_recon_loss: 4064694.1167; val_gene_expr_recon_loss: 23890728.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25866629.0667; val_global_loss: 54067590.4000; val_optim_loss: 54067590.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7517; val_auprc_score: 0.7827; val_best_acc_score: 0.6513; val_best_f1_score: 0.7068; train_kl_reg_loss: 148431.2492; train_edge_recon_loss: 3633481.7290; train_gene_expr_recon_loss: 23059425.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25890081.5267; train_global_loss: 52731420.1221; train_optim_loss: 52731420.1221; val_kl_reg_loss: 156645.1990; val_edge_recon_loss: 4052137.8000; val_gene_expr_recon_loss: 22346581.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25342257.3333; val_global_loss: 51897622.4000; val_optim_loss: 51897622.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8195; val_auprc_score: 0.8323; val_best_acc_score: 0.7082; val_best_f1_score: 0.7456; train_kl_reg_loss: 159970.6448; train_edge_recon_loss: 3551537.5706; train_gene_expr_recon_loss: 22206835.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25540555.9695; train_global_loss: 51458899.8473; train_optim_loss: 51458899.8473; val_kl_reg_loss: 134594.7583; val_edge_recon_loss: 3971960.7667; val_gene_expr_recon_loss: 21992477.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25022816.6667; val_global_loss: 51121849.8667; val_optim_loss: 51121849.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8948; val_auprc_score: 0.8854; val_best_acc_score: 0.8153; val_best_f1_score: 0.8274; train_kl_reg_loss: 132719.4061; train_edge_recon_loss: 3489085.0706; train_gene_expr_recon_loss: 22011771.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25417633.1908; train_global_loss: 51051209.3740; train_optim_loss: 51051209.3740; val_kl_reg_loss: 115461.6042; val_edge_recon_loss: 3551814.1500; val_gene_expr_recon_loss: 21793108.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24912234.4000; val_global_loss: 50372619.2000; val_optim_loss: 50372619.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8985; val_auprc_score: 0.8895; val_best_acc_score: 0.8096; val_best_f1_score: 0.8215; train_kl_reg_loss: 140890.4822; train_edge_recon_loss: 3114306.0515; train_gene_expr_recon_loss: 21858106.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25257115.2672; train_global_loss: 50370418.3206; train_optim_loss: 50370418.3206; val_kl_reg_loss: 160490.5667; val_edge_recon_loss: 2987490.6833; val_gene_expr_recon_loss: 21725173.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24836354.5333; val_global_loss: 49709509.8667; val_optim_loss: 49709509.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9102; val_auprc_score: 0.8983; val_best_acc_score: 0.8313; val_best_f1_score: 0.8445; train_kl_reg_loss: 160600.7895; train_edge_recon_loss: 2966583.5267; train_gene_expr_recon_loss: 21751839.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25169443.7099; train_global_loss: 50048467.0229; train_optim_loss: 50048467.0229; val_kl_reg_loss: 157177.0354; val_edge_recon_loss: 2957748.8000; val_gene_expr_recon_loss: 21607804.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24781913.0667; val_global_loss: 49504643.2000; val_optim_loss: 49504643.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9179; val_auprc_score: 0.9077; val_best_acc_score: 0.8424; val_best_f1_score: 0.8509; train_kl_reg_loss: 156159.3000; train_edge_recon_loss: 2917384.2290; train_gene_expr_recon_loss: 21622026.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25065774.4885; train_global_loss: 49761344.3969; train_optim_loss: 49761344.3969; val_kl_reg_loss: 151906.3250; val_edge_recon_loss: 2913051.9500; val_gene_expr_recon_loss: 21418175.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24599740.6667; val_global_loss: 49082873.8667; val_optim_loss: 49082873.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9214; val_auprc_score: 0.9104; val_best_acc_score: 0.8459; val_best_f1_score: 0.8566; train_kl_reg_loss: 150449.2016; train_edge_recon_loss: 2899789.6164; train_gene_expr_recon_loss: 21501791.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24934125.5573; train_global_loss: 49486155.6947; train_optim_loss: 49486155.6947; val_kl_reg_loss: 145535.9240; val_edge_recon_loss: 2888458.9333; val_gene_expr_recon_loss: 21402262.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24636114.4000; val_global_loss: 49072371.4667; val_optim_loss: 49072371.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9331; val_auprc_score: 0.9231; val_best_acc_score: 0.8638; val_best_f1_score: 0.8684; train_kl_reg_loss: 145261.4435; train_edge_recon_loss: 2872259.4542; train_gene_expr_recon_loss: 21416451.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24863444.4580; train_global_loss: 49297416.8855; train_optim_loss: 49297416.8855; val_kl_reg_loss: 144520.8917; val_edge_recon_loss: 2859474.3833; val_gene_expr_recon_loss: 21266344.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24473571.8667; val_global_loss: 48743912.0000; val_optim_loss: 48743912.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9342; val_auprc_score: 0.9247; val_best_acc_score: 0.8670; val_best_f1_score: 0.8733; train_kl_reg_loss: 140579.5703; train_edge_recon_loss: 2842910.1202; train_gene_expr_recon_loss: 21313312.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24764748.7176; train_global_loss: 49061550.6565; train_optim_loss: 49061550.6565; val_kl_reg_loss: 140169.4198; val_edge_recon_loss: 2855125.5333; val_gene_expr_recon_loss: 21147942.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24299688.1333; val_global_loss: 48442925.3333; val_optim_loss: 48442925.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9397; val_auprc_score: 0.9266; val_best_acc_score: 0.8752; val_best_f1_score: 0.8814; train_kl_reg_loss: 137494.1146; train_edge_recon_loss: 2831535.3073; train_gene_expr_recon_loss: 21236487.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24702395.1450; train_global_loss: 48907911.9389; train_optim_loss: 48907911.9389; val_kl_reg_loss: 132858.6818; val_edge_recon_loss: 2832333.0000; val_gene_expr_recon_loss: 21136610.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24346980.9333; val_global_loss: 48448783.2000; val_optim_loss: 48448783.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9440; val_auprc_score: 0.9341; val_best_acc_score: 0.8775; val_best_f1_score: 0.8829; train_kl_reg_loss: 132737.3042; train_edge_recon_loss: 2819198.1240; train_gene_expr_recon_loss: 21169337.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24637521.1145; train_global_loss: 48758794.4122; train_optim_loss: 48758794.4122; val_kl_reg_loss: 132101.1896; val_edge_recon_loss: 2821727.2167; val_gene_expr_recon_loss: 21064840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24380496.6667; val_global_loss: 48399165.3333; val_optim_loss: 48399165.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9469; val_auprc_score: 0.9373; val_best_acc_score: 0.8841; val_best_f1_score: 0.8899; train_kl_reg_loss: 128663.2891; train_edge_recon_loss: 2808648.5095; train_gene_expr_recon_loss: 21111996.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24566012.1527; train_global_loss: 48615319.8779; train_optim_loss: 48615319.8779; val_kl_reg_loss: 128609.1323; val_edge_recon_loss: 2836197.3667; val_gene_expr_recon_loss: 20938046.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24112972.6667; val_global_loss: 48015825.6000; val_optim_loss: 48015825.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9475; val_auprc_score: 0.9363; val_best_acc_score: 0.8837; val_best_f1_score: 0.8890; train_kl_reg_loss: 125641.6601; train_edge_recon_loss: 2789873.0573; train_gene_expr_recon_loss: 21067815.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24538816.9618; train_global_loss: 48522146.4427; train_optim_loss: 48522146.4427; val_kl_reg_loss: 125575.7552; val_edge_recon_loss: 2801022.4167; val_gene_expr_recon_loss: 21004948.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24237318.8000; val_global_loss: 48168865.8667; val_optim_loss: 48168865.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9538; val_auprc_score: 0.9442; val_best_acc_score: 0.8914; val_best_f1_score: 0.8954; train_kl_reg_loss: 124110.8464; train_edge_recon_loss: 2783894.2672; train_gene_expr_recon_loss: 20999357.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24480184.3053; train_global_loss: 48387547.1756; train_optim_loss: 48387547.1756; val_kl_reg_loss: 118591.3062; val_edge_recon_loss: 2785839.3500; val_gene_expr_recon_loss: 20958851.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24115961.7333; val_global_loss: 47979244.2667; val_optim_loss: 47979244.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9597; val_auprc_score: 0.9521; val_best_acc_score: 0.8985; val_best_f1_score: 0.9035; train_kl_reg_loss: 120294.4988; train_edge_recon_loss: 2776330.3817; train_gene_expr_recon_loss: 20966264.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24428711.6947; train_global_loss: 48291600.7023; train_optim_loss: 48291600.7023; val_kl_reg_loss: 121810.7495; val_edge_recon_loss: 2770137.0167; val_gene_expr_recon_loss: 20906801.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24146994.8000; val_global_loss: 47945744.8000; val_optim_loss: 47945744.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9627; val_auprc_score: 0.9571; val_best_acc_score: 0.9027; val_best_f1_score: 0.9056; train_kl_reg_loss: 118125.6568; train_edge_recon_loss: 2769195.9656; train_gene_expr_recon_loss: 20899010.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24384131.2061; train_global_loss: 48170463.3282; train_optim_loss: 48170463.3282; val_kl_reg_loss: 114615.3990; val_edge_recon_loss: 2773530.8833; val_gene_expr_recon_loss: 20865067.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24083648.8000; val_global_loss: 47836861.8667; val_optim_loss: 47836861.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9604; val_auprc_score: 0.9513; val_best_acc_score: 0.9027; val_best_f1_score: 0.9066; train_kl_reg_loss: 115155.8558; train_edge_recon_loss: 2756207.5038; train_gene_expr_recon_loss: 20867785.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24364773.3130; train_global_loss: 48103922.0458; train_optim_loss: 48103922.0458; val_kl_reg_loss: 112344.6401; val_edge_recon_loss: 2768679.5167; val_gene_expr_recon_loss: 20784805.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23991538.5333; val_global_loss: 47657368.2667; val_optim_loss: 47657368.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9660; val_auprc_score: 0.9593; val_best_acc_score: 0.9086; val_best_f1_score: 0.9112; train_kl_reg_loss: 111702.6492; train_edge_recon_loss: 2747727.8607; train_gene_expr_recon_loss: 20842556.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24353360.5802; train_global_loss: 48055347.7557; train_optim_loss: 48055347.7557; val_kl_reg_loss: 111123.8161; val_edge_recon_loss: 2751905.7000; val_gene_expr_recon_loss: 20762812.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23968455.3333; val_global_loss: 47594297.0667; val_optim_loss: 47594297.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9634; val_auprc_score: 0.9553; val_best_acc_score: 0.9037; val_best_f1_score: 0.9068; train_kl_reg_loss: 109585.6094; train_edge_recon_loss: 2749387.9637; train_gene_expr_recon_loss: 20789184.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24299682.9466; train_global_loss: 47947840.9160; train_optim_loss: 47947840.9160; val_kl_reg_loss: 108527.1354; val_edge_recon_loss: 2796207.0333; val_gene_expr_recon_loss: 20698274.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23926870.8000; val_global_loss: 47529880.5333; val_optim_loss: 47529880.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9691; val_auprc_score: 0.9610; val_best_acc_score: 0.9154; val_best_f1_score: 0.9184; train_kl_reg_loss: 106768.6474; train_edge_recon_loss: 2746551.1145; train_gene_expr_recon_loss: 20763360.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24277419.9695; train_global_loss: 47894099.8779; train_optim_loss: 47894099.8779; val_kl_reg_loss: 106620.4172; val_edge_recon_loss: 2724536.1000; val_gene_expr_recon_loss: 20632750.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23864165.7333; val_global_loss: 47328073.3333; val_optim_loss: 47328073.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9731; val_auprc_score: 0.9680; val_best_acc_score: 0.9205; val_best_f1_score: 0.9226; train_kl_reg_loss: 105917.3358; train_edge_recon_loss: 2724221.1947; train_gene_expr_recon_loss: 20716488.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24221297.0076; train_global_loss: 47767923.6947; train_optim_loss: 47767923.6947; val_kl_reg_loss: 104795.8578; val_edge_recon_loss: 2735545.3833; val_gene_expr_recon_loss: 20606083.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23794743.8667; val_global_loss: 47241168.0000; val_optim_loss: 47241168.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9738; val_auprc_score: 0.9665; val_best_acc_score: 0.9225; val_best_f1_score: 0.9243; train_kl_reg_loss: 104314.2341; train_edge_recon_loss: 2721425.8607; train_gene_expr_recon_loss: 20708289.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24241098.4580; train_global_loss: 47775128.6718; train_optim_loss: 47775128.6718; val_kl_reg_loss: 100977.9380; val_edge_recon_loss: 2728448.9167; val_gene_expr_recon_loss: 20735920.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23952132.0000; val_global_loss: 47517479.2000; val_optim_loss: 47517479.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9754; val_auprc_score: 0.9699; val_best_acc_score: 0.9281; val_best_f1_score: 0.9304; train_kl_reg_loss: 102146.3390; train_edge_recon_loss: 2719707.2443; train_gene_expr_recon_loss: 20684720.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24228179.6489; train_global_loss: 47734753.7099; train_optim_loss: 47734753.7099; val_kl_reg_loss: 101483.5734; val_edge_recon_loss: 2730090.5167; val_gene_expr_recon_loss: 20626733.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23870703.8667; val_global_loss: 47329011.2000; val_optim_loss: 47329011.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9754; val_auprc_score: 0.9678; val_best_acc_score: 0.9259; val_best_f1_score: 0.9284; train_kl_reg_loss: 100156.0234; train_edge_recon_loss: 2723739.2405; train_gene_expr_recon_loss: 20620309.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24156059.2672; train_global_loss: 47600264.2443; train_optim_loss: 47600264.2443; val_kl_reg_loss: 99436.2365; val_edge_recon_loss: 2730284.0833; val_gene_expr_recon_loss: 20552540.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23751713.0667; val_global_loss: 47133973.3333; val_optim_loss: 47133973.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9651; val_auprc_score: 0.9579; val_best_acc_score: 0.9080; val_best_f1_score: 0.9112; train_kl_reg_loss: 126951.1209; train_edge_recon_loss: 2840203.7767; train_gene_expr_recon_loss: 22924071.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25017538.9924; train_global_loss: 50908765.2519; train_optim_loss: 50908765.2519; val_kl_reg_loss: 18048.2707; val_edge_recon_loss: 2830874.9333; val_gene_expr_recon_loss: 24107064.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25006162.1333; val_global_loss: 51962149.6000; val_optim_loss: 51962149.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9589; val_auprc_score: 0.9468; val_best_acc_score: 0.9006; val_best_f1_score: 0.9028; train_kl_reg_loss: 101982.8737; train_edge_recon_loss: 2795090.4828; train_gene_expr_recon_loss: 24184372.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25297134.0153; train_global_loss: 52378579.5725; train_optim_loss: 52378579.5725; val_kl_reg_loss: 14968.0391; val_edge_recon_loss: 2748819.7167; val_gene_expr_recon_loss: 23960328.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24879340.9333; val_global_loss: 51603457.3333; val_optim_loss: 51603457.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9288; val_auprc_score: 0.9099; val_best_acc_score: 0.8657; val_best_f1_score: 0.8745; train_kl_reg_loss: 63924.0331; train_edge_recon_loss: 2744645.2576; train_gene_expr_recon_loss: 23905367.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25244156.3511; train_global_loss: 51958093.5878; train_optim_loss: 51958093.5878; val_kl_reg_loss: 16537.2999; val_edge_recon_loss: 2813758.2000; val_gene_expr_recon_loss: 23595896.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24738282.0000; val_global_loss: 51164473.3333; val_optim_loss: 51164473.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9359; val_auprc_score: 0.9179; val_best_acc_score: 0.8743; val_best_f1_score: 0.8811; train_kl_reg_loss: 51370.8739; train_edge_recon_loss: 2756106.8760; train_gene_expr_recon_loss: 23653063.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25170262.0153; train_global_loss: 51630802.8397; train_optim_loss: 51630802.8397; val_kl_reg_loss: 19845.6897; val_edge_recon_loss: 2741428.5500; val_gene_expr_recon_loss: 23465181.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24785816.9333; val_global_loss: 51012272.8000; val_optim_loss: 51012272.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9326; val_auprc_score: 0.9125; val_best_acc_score: 0.8689; val_best_f1_score: 0.8784; train_kl_reg_loss: 41994.5646; train_edge_recon_loss: 2744219.4790; train_gene_expr_recon_loss: 23498890.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25107781.1603; train_global_loss: 51392885.9237; train_optim_loss: 51392885.9237; val_kl_reg_loss: 21548.0762; val_edge_recon_loss: 2748423.8500; val_gene_expr_recon_loss: 23546828.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24896586.2667; val_global_loss: 51213386.4000; val_optim_loss: 51213386.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9339; val_auprc_score: 0.9099; val_best_acc_score: 0.8763; val_best_f1_score: 0.8838; train_kl_reg_loss: 42515.2080; train_edge_recon_loss: 2738533.0191; train_gene_expr_recon_loss: 23494008.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25103928.8244; train_global_loss: 51378985.7710; train_optim_loss: 51378985.7710; val_kl_reg_loss: 22327.9298; val_edge_recon_loss: 2742550.7333; val_gene_expr_recon_loss: 23457185.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24765980.4000; val_global_loss: 50988044.8000; val_optim_loss: 50988044.8000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9354; val_auprc_score: 0.9150; val_best_acc_score: 0.8727; val_best_f1_score: 0.8805; train_kl_reg_loss: 42139.4670; train_edge_recon_loss: 2732393.6260; train_gene_expr_recon_loss: 23472341.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25102434.1374; train_global_loss: 51349308.6718; train_optim_loss: 51349308.6718; val_kl_reg_loss: 23039.4445; val_edge_recon_loss: 2728128.3000; val_gene_expr_recon_loss: 23384767.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24730768.9333; val_global_loss: 50866704.0000; val_optim_loss: 50866704.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9353; val_auprc_score: 0.9159; val_best_acc_score: 0.8754; val_best_f1_score: 0.8830; train_kl_reg_loss: 41928.9360; train_edge_recon_loss: 2735950.4809; train_gene_expr_recon_loss: 23471896.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25126546.6718; train_global_loss: 51376322.2290; train_optim_loss: 51376322.2290; val_kl_reg_loss: 23389.9520; val_edge_recon_loss: 2718599.6833; val_gene_expr_recon_loss: 23290573.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24657577.6000; val_global_loss: 50690140.0000; val_optim_loss: 50690140.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 11 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9724
val AUPRC score: 0.9667
val best accuracy score: 0.9210
val best F1 score: 0.9228
val target rna MSE score: 1.3194
val source rna MSE score: 22.0790
val target atac MSE score: 0.3457
val source atac MSE score: 3.0380
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
