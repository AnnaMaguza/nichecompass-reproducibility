[True]
Run timestamp: 26072023_032404_116.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_116']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9619; val_auprc_score: 0.9649; val_best_acc_score: 0.7498; val_best_f1_score: 0.7982; train_kl_reg_loss: 1648.2317; train_edge_recon_loss: 34653141.3333; train_gene_expr_recon_loss: 317477.0000; train_masked_gp_l1_reg_loss: 1530.6195; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10824167.6667; train_global_loss: 45797963.5556; train_optim_loss: 45797963.5556; val_kl_reg_loss: 385.2935; val_edge_recon_loss: 39966740.0000; val_gene_expr_recon_loss: 315541.0312; val_masked_gp_l1_reg_loss: 1193.0549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10756303.0000; val_global_loss: 51040160.0000; val_optim_loss: 51040160.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9105; val_auprc_score: 0.8994; val_best_acc_score: 0.8278; val_best_f1_score: 0.8378; train_kl_reg_loss: 599.7963; train_edge_recon_loss: 34446317.3333; train_gene_expr_recon_loss: 312553.6944; train_masked_gp_l1_reg_loss: 1039.5355; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10766281.4444; train_global_loss: 45526791.1111; train_optim_loss: 45526791.1111; val_kl_reg_loss: 1148.3649; val_edge_recon_loss: 34026300.0000; val_gene_expr_recon_loss: 309956.5938; val_masked_gp_l1_reg_loss: 921.5264; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10698582.0000; val_global_loss: 45036904.0000; val_optim_loss: 45036904.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8675; val_auprc_score: 0.8596; val_best_acc_score: 0.7724; val_best_f1_score: 0.7913; train_kl_reg_loss: 5236.5066; train_edge_recon_loss: 31110093.7778; train_gene_expr_recon_loss: 310845.9931; train_masked_gp_l1_reg_loss: 942.3871; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10715503.0000; train_global_loss: 42142621.7778; train_optim_loss: 42142621.7778; val_kl_reg_loss: 17559.0039; val_edge_recon_loss: 29030854.0000; val_gene_expr_recon_loss: 310095.8438; val_masked_gp_l1_reg_loss: 997.0020; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10679158.0000; val_global_loss: 40038664.0000; val_optim_loss: 40038664.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8773; val_auprc_score: 0.8591; val_best_acc_score: 0.7902; val_best_f1_score: 0.8059; train_kl_reg_loss: 28215.0165; train_edge_recon_loss: 28363341.1111; train_gene_expr_recon_loss: 309319.7257; train_masked_gp_l1_reg_loss: 990.1565; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10737464.2222; train_global_loss: 39439330.2222; train_optim_loss: 39439330.2222; val_kl_reg_loss: 40406.6641; val_edge_recon_loss: 28625798.0000; val_gene_expr_recon_loss: 304290.4062; val_masked_gp_l1_reg_loss: 977.3625; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10617858.0000; val_global_loss: 39589328.0000; val_optim_loss: 39589328.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9057; val_auprc_score: 0.8801; val_best_acc_score: 0.8356; val_best_f1_score: 0.8449; train_kl_reg_loss: 43733.8776; train_edge_recon_loss: 27749635.1111; train_gene_expr_recon_loss: 301337.5938; train_masked_gp_l1_reg_loss: 987.9158; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10668889.4444; train_global_loss: 38764583.5556; train_optim_loss: 38764583.5556; val_kl_reg_loss: 45243.4844; val_edge_recon_loss: 27841430.0000; val_gene_expr_recon_loss: 293183.7500; val_masked_gp_l1_reg_loss: 999.3106; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10573150.0000; val_global_loss: 38754008.0000; val_optim_loss: 38754008.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9201; val_auprc_score: 0.8942; val_best_acc_score: 0.8614; val_best_f1_score: 0.8686; train_kl_reg_loss: 49928.4674; train_edge_recon_loss: 27289556.8889; train_gene_expr_recon_loss: 293633.5417; train_masked_gp_l1_reg_loss: 1014.9540; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10593955.1111; train_global_loss: 38228088.8889; train_optim_loss: 38228088.8889; val_kl_reg_loss: 50505.0391; val_edge_recon_loss: 27301646.0000; val_gene_expr_recon_loss: 290677.8750; val_masked_gp_l1_reg_loss: 1041.3646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10529424.0000; val_global_loss: 38173296.0000; val_optim_loss: 38173296.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9282; val_auprc_score: 0.9075; val_best_acc_score: 0.8700; val_best_f1_score: 0.8774; train_kl_reg_loss: 53201.4722; train_edge_recon_loss: 27096220.0000; train_gene_expr_recon_loss: 289700.4271; train_masked_gp_l1_reg_loss: 1070.0666; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10581126.7778; train_global_loss: 38021318.2222; train_optim_loss: 38021318.2222; val_kl_reg_loss: 51946.7969; val_edge_recon_loss: 27177072.0000; val_gene_expr_recon_loss: 285706.5312; val_masked_gp_l1_reg_loss: 1100.7314; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10466175.0000; val_global_loss: 37982000.0000; val_optim_loss: 37982000.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9293; val_auprc_score: 0.9084; val_best_acc_score: 0.8676; val_best_f1_score: 0.8754; train_kl_reg_loss: 54096.1011; train_edge_recon_loss: 27036287.3333; train_gene_expr_recon_loss: 283389.8472; train_masked_gp_l1_reg_loss: 1128.5679; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10463125.6667; train_global_loss: 37838027.1111; train_optim_loss: 37838027.1111; val_kl_reg_loss: 52001.1953; val_edge_recon_loss: 27056044.0000; val_gene_expr_recon_loss: 282546.2812; val_masked_gp_l1_reg_loss: 1163.7365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10416143.0000; val_global_loss: 37807900.0000; val_optim_loss: 37807900.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9361; val_auprc_score: 0.9174; val_best_acc_score: 0.8746; val_best_f1_score: 0.8819; train_kl_reg_loss: 53038.6272; train_edge_recon_loss: 27011078.4444; train_gene_expr_recon_loss: 281186.3576; train_masked_gp_l1_reg_loss: 1195.0096; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10394230.7778; train_global_loss: 37740728.4444; train_optim_loss: 37740728.4444; val_kl_reg_loss: 50099.6562; val_edge_recon_loss: 27022108.0000; val_gene_expr_recon_loss: 278107.2812; val_masked_gp_l1_reg_loss: 1230.6869; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10393211.0000; val_global_loss: 37744756.0000; val_optim_loss: 37744756.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9386; val_auprc_score: 0.9193; val_best_acc_score: 0.8787; val_best_f1_score: 0.8846; train_kl_reg_loss: 51810.1033; train_edge_recon_loss: 26956740.2222; train_gene_expr_recon_loss: 277283.8993; train_masked_gp_l1_reg_loss: 1262.4923; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10387457.8889; train_global_loss: 37674555.1111; train_optim_loss: 37674555.1111; val_kl_reg_loss: 48422.4258; val_edge_recon_loss: 27220422.0000; val_gene_expr_recon_loss: 274261.9688; val_masked_gp_l1_reg_loss: 1297.2249; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10334708.0000; val_global_loss: 37879112.0000; val_optim_loss: 37879112.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9445; val_auprc_score: 0.9267; val_best_acc_score: 0.8832; val_best_f1_score: 0.8895; train_kl_reg_loss: 50284.5000; train_edge_recon_loss: 26917175.5556; train_gene_expr_recon_loss: 273963.7153; train_masked_gp_l1_reg_loss: 1326.7920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10303412.2222; train_global_loss: 37546163.5556; train_optim_loss: 37546163.5556; val_kl_reg_loss: 47629.9141; val_edge_recon_loss: 27106952.0000; val_gene_expr_recon_loss: 270932.3438; val_masked_gp_l1_reg_loss: 1363.5801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10298483.0000; val_global_loss: 37725360.0000; val_optim_loss: 37725360.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9539; val_auprc_score: 0.9390; val_best_acc_score: 0.8979; val_best_f1_score: 0.9024; train_kl_reg_loss: 48970.2765; train_edge_recon_loss: 26847291.1111; train_gene_expr_recon_loss: 270600.5920; train_masked_gp_l1_reg_loss: 1396.0302; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10301689.2222; train_global_loss: 37469947.5556; train_optim_loss: 37469947.5556; val_kl_reg_loss: 47221.2422; val_edge_recon_loss: 26769214.0000; val_gene_expr_recon_loss: 269001.4375; val_masked_gp_l1_reg_loss: 1429.4065; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10280292.0000; val_global_loss: 37367160.0000; val_optim_loss: 37367160.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9590; val_auprc_score: 0.9449; val_best_acc_score: 0.9078; val_best_f1_score: 0.9113; train_kl_reg_loss: 48848.6020; train_edge_recon_loss: 26749339.3333; train_gene_expr_recon_loss: 268194.9132; train_masked_gp_l1_reg_loss: 1451.1670; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10251736.6667; train_global_loss: 37319571.1111; train_optim_loss: 37319571.1111; val_kl_reg_loss: 46443.3125; val_edge_recon_loss: 26628080.0000; val_gene_expr_recon_loss: 267239.7188; val_masked_gp_l1_reg_loss: 1476.5115; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10266137.0000; val_global_loss: 37209376.0000; val_optim_loss: 37209376.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9584; val_auprc_score: 0.9434; val_best_acc_score: 0.9046; val_best_f1_score: 0.9096; train_kl_reg_loss: 49036.5508; train_edge_recon_loss: 26596184.4444; train_gene_expr_recon_loss: 268196.1250; train_masked_gp_l1_reg_loss: 1495.6106; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10335869.8889; train_global_loss: 37250782.6667; train_optim_loss: 37250782.6667; val_kl_reg_loss: 47212.9609; val_edge_recon_loss: 26736682.0000; val_gene_expr_recon_loss: 265184.4062; val_masked_gp_l1_reg_loss: 1520.3550; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10239992.0000; val_global_loss: 37290592.0000; val_optim_loss: 37290592.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9625; val_auprc_score: 0.9508; val_best_acc_score: 0.9080; val_best_f1_score: 0.9114; train_kl_reg_loss: 50698.0200; train_edge_recon_loss: 26580418.2222; train_gene_expr_recon_loss: 264638.4740; train_masked_gp_l1_reg_loss: 1542.3321; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10218155.4444; train_global_loss: 37115452.0000; train_optim_loss: 37115452.0000; val_kl_reg_loss: 49661.6797; val_edge_recon_loss: 26538116.0000; val_gene_expr_recon_loss: 264175.9375; val_masked_gp_l1_reg_loss: 1571.2172; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10230620.0000; val_global_loss: 37084144.0000; val_optim_loss: 37084144.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9645; val_auprc_score: 0.9532; val_best_acc_score: 0.9142; val_best_f1_score: 0.9183; train_kl_reg_loss: 54357.6962; train_edge_recon_loss: 26510586.2222; train_gene_expr_recon_loss: 262527.0660; train_masked_gp_l1_reg_loss: 1603.6533; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10227634.0000; train_global_loss: 37056708.8889; train_optim_loss: 37056708.8889; val_kl_reg_loss: 54174.0781; val_edge_recon_loss: 26558322.0000; val_gene_expr_recon_loss: 263041.0312; val_masked_gp_l1_reg_loss: 1633.7031; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10195531.0000; val_global_loss: 37072704.0000; val_optim_loss: 37072704.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9656; val_auprc_score: 0.9553; val_best_acc_score: 0.9170; val_best_f1_score: 0.9198; train_kl_reg_loss: 56580.5113; train_edge_recon_loss: 26455972.0000; train_gene_expr_recon_loss: 260715.0208; train_masked_gp_l1_reg_loss: 1660.2003; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10186049.3333; train_global_loss: 36960977.3333; train_optim_loss: 36960977.3333; val_kl_reg_loss: 54548.8516; val_edge_recon_loss: 26544658.0000; val_gene_expr_recon_loss: 259143.4062; val_masked_gp_l1_reg_loss: 1693.1780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10153928.0000; val_global_loss: 37013972.0000; val_optim_loss: 37013972.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9623; val_auprc_score: 0.9461; val_best_acc_score: 0.9174; val_best_f1_score: 0.9210; train_kl_reg_loss: 57296.7257; train_edge_recon_loss: 26446161.1111; train_gene_expr_recon_loss: 257455.2378; train_masked_gp_l1_reg_loss: 1718.8600; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10109943.3333; train_global_loss: 36872575.5556; train_optim_loss: 36872575.5556; val_kl_reg_loss: 55203.1562; val_edge_recon_loss: 26703888.0000; val_gene_expr_recon_loss: 257306.1406; val_masked_gp_l1_reg_loss: 1745.0479; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10137913.0000; val_global_loss: 37156056.0000; val_optim_loss: 37156056.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9639; val_auprc_score: 0.9469; val_best_acc_score: 0.9214; val_best_f1_score: 0.9246; train_kl_reg_loss: 58243.6797; train_edge_recon_loss: 26411330.2222; train_gene_expr_recon_loss: 256360.3646; train_masked_gp_l1_reg_loss: 1766.2434; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10112931.6667; train_global_loss: 36840632.0000; train_optim_loss: 36840632.0000; val_kl_reg_loss: 55887.5195; val_edge_recon_loss: 26507902.0000; val_gene_expr_recon_loss: 257911.4688; val_masked_gp_l1_reg_loss: 1793.3945; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10122168.0000; val_global_loss: 36945664.0000; val_optim_loss: 36945664.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9645; val_auprc_score: 0.9505; val_best_acc_score: 0.9217; val_best_f1_score: 0.9254; train_kl_reg_loss: 58712.3507; train_edge_recon_loss: 26432940.2222; train_gene_expr_recon_loss: 254377.5764; train_masked_gp_l1_reg_loss: 1813.4102; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10081215.0000; train_global_loss: 36829058.6667; train_optim_loss: 36829058.6667; val_kl_reg_loss: 57156.6211; val_edge_recon_loss: 26625154.0000; val_gene_expr_recon_loss: 253928.5156; val_masked_gp_l1_reg_loss: 1836.7451; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10069816.0000; val_global_loss: 37007888.0000; val_optim_loss: 37007888.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9654; val_auprc_score: 0.9474; val_best_acc_score: 0.9223; val_best_f1_score: 0.9260; train_kl_reg_loss: 60629.3520; train_edge_recon_loss: 26430592.2222; train_gene_expr_recon_loss: 251491.0556; train_masked_gp_l1_reg_loss: 1861.3489; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10060446.2222; train_global_loss: 36805020.4444; train_optim_loss: 36805020.4444; val_kl_reg_loss: 58606.0312; val_edge_recon_loss: 26479310.0000; val_gene_expr_recon_loss: 253073.5312; val_masked_gp_l1_reg_loss: 1887.7729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10054969.0000; val_global_loss: 36847848.0000; val_optim_loss: 36847848.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9678; val_auprc_score: 0.9532; val_best_acc_score: 0.9247; val_best_f1_score: 0.9280; train_kl_reg_loss: 63119.5990; train_edge_recon_loss: 26362863.5556; train_gene_expr_recon_loss: 250113.3021; train_masked_gp_l1_reg_loss: 1906.8334; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10018769.6667; train_global_loss: 36696772.4444; train_optim_loss: 36696772.4444; val_kl_reg_loss: 61111.5469; val_edge_recon_loss: 26503032.0000; val_gene_expr_recon_loss: 250973.3750; val_masked_gp_l1_reg_loss: 1927.3815; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10039879.0000; val_global_loss: 36856924.0000; val_optim_loss: 36856924.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9694; val_auprc_score: 0.9589; val_best_acc_score: 0.9259; val_best_f1_score: 0.9290; train_kl_reg_loss: 63433.5095; train_edge_recon_loss: 26378752.6667; train_gene_expr_recon_loss: 248642.0017; train_masked_gp_l1_reg_loss: 1944.7980; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10015175.4444; train_global_loss: 36707948.8889; train_optim_loss: 36707948.8889; val_kl_reg_loss: 61574.3203; val_edge_recon_loss: 26432968.0000; val_gene_expr_recon_loss: 249431.2188; val_masked_gp_l1_reg_loss: 1968.4731; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10003692.0000; val_global_loss: 36749632.0000; val_optim_loss: 36749632.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9679; val_auprc_score: 0.9528; val_best_acc_score: 0.9258; val_best_f1_score: 0.9281; train_kl_reg_loss: 63199.7830; train_edge_recon_loss: 26370737.5556; train_gene_expr_recon_loss: 247342.2812; train_masked_gp_l1_reg_loss: 1983.0640; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9983418.8889; train_global_loss: 36666681.3333; train_optim_loss: 36666681.3333; val_kl_reg_loss: 60939.8125; val_edge_recon_loss: 26543594.0000; val_gene_expr_recon_loss: 249386.3750; val_masked_gp_l1_reg_loss: 2000.7009; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10023710.0000; val_global_loss: 36879632.0000; val_optim_loss: 36879632.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9682; val_auprc_score: 0.9548; val_best_acc_score: 0.9275; val_best_f1_score: 0.9303; train_kl_reg_loss: 64914.2344; train_edge_recon_loss: 26382858.6667; train_gene_expr_recon_loss: 247011.3889; train_masked_gp_l1_reg_loss: 2019.2448; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9973749.5556; train_global_loss: 36670553.3333; train_optim_loss: 36670553.3333; val_kl_reg_loss: 63100.8047; val_edge_recon_loss: 26418236.0000; val_gene_expr_recon_loss: 248823.1406; val_masked_gp_l1_reg_loss: 2033.1655; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9993847.0000; val_global_loss: 36726040.0000; val_optim_loss: 36726040.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9708; val_auprc_score: 0.9588; val_best_acc_score: 0.9301; val_best_f1_score: 0.9320; train_kl_reg_loss: 67466.8290; train_edge_recon_loss: 26373996.6667; train_gene_expr_recon_loss: 246726.8646; train_masked_gp_l1_reg_loss: 2048.2779; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9955536.1111; train_global_loss: 36645775.5556; train_optim_loss: 36645775.5556; val_kl_reg_loss: 65330.0000; val_edge_recon_loss: 26438158.0000; val_gene_expr_recon_loss: 245987.9844; val_masked_gp_l1_reg_loss: 2065.2388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9947063.0000; val_global_loss: 36698604.0000; val_optim_loss: 36698604.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9585; val_best_acc_score: 0.9256; val_best_f1_score: 0.9287; train_kl_reg_loss: 67392.3789; train_edge_recon_loss: 26337171.3333; train_gene_expr_recon_loss: 244101.7569; train_masked_gp_l1_reg_loss: 2082.6979; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9948208.0000; train_global_loss: 36598956.8889; train_optim_loss: 36598956.8889; val_kl_reg_loss: 64366.0391; val_edge_recon_loss: 26454210.0000; val_gene_expr_recon_loss: 245252.6562; val_masked_gp_l1_reg_loss: 2095.5239; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9944244.0000; val_global_loss: 36710168.0000; val_optim_loss: 36710168.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9702; val_auprc_score: 0.9593; val_best_acc_score: 0.9250; val_best_f1_score: 0.9286; train_kl_reg_loss: 68850.3798; train_edge_recon_loss: 26336404.8889; train_gene_expr_recon_loss: 243161.4427; train_masked_gp_l1_reg_loss: 2109.7539; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9967531.4444; train_global_loss: 36618057.3333; train_optim_loss: 36618057.3333; val_kl_reg_loss: 66272.9297; val_edge_recon_loss: 26543722.0000; val_gene_expr_recon_loss: 245183.5312; val_masked_gp_l1_reg_loss: 2120.9038; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9941829.0000; val_global_loss: 36799128.0000; val_optim_loss: 36799128.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9730; val_auprc_score: 0.9619; val_best_acc_score: 0.9301; val_best_f1_score: 0.9332; train_kl_reg_loss: 69132.5911; train_edge_recon_loss: 26335275.3333; train_gene_expr_recon_loss: 242598.7622; train_masked_gp_l1_reg_loss: 2134.0895; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9878598.8889; train_global_loss: 36527739.5556; train_optim_loss: 36527739.5556; val_kl_reg_loss: 66716.8750; val_edge_recon_loss: 26489866.0000; val_gene_expr_recon_loss: 242173.7031; val_masked_gp_l1_reg_loss: 2143.9954; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9893144.0000; val_global_loss: 36694044.0000; val_optim_loss: 36694044.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9736; val_auprc_score: 0.9616; val_best_acc_score: 0.9316; val_best_f1_score: 0.9349; train_kl_reg_loss: 69400.6128; train_edge_recon_loss: 26263674.6667; train_gene_expr_recon_loss: 239552.1840; train_masked_gp_l1_reg_loss: 2159.6873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9833957.7778; train_global_loss: 36408744.8889; train_optim_loss: 36408744.8889; val_kl_reg_loss: 67546.9375; val_edge_recon_loss: 26297852.0000; val_gene_expr_recon_loss: 243802.8438; val_masked_gp_l1_reg_loss: 2172.5901; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9909402.0000; val_global_loss: 36520776.0000; val_optim_loss: 36520776.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9713; val_auprc_score: 0.9592; val_best_acc_score: 0.9294; val_best_f1_score: 0.9324; train_kl_reg_loss: 70240.9705; train_edge_recon_loss: 26368365.7778; train_gene_expr_recon_loss: 239538.1719; train_masked_gp_l1_reg_loss: 2181.8850; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9870518.0000; train_global_loss: 36550844.4444; train_optim_loss: 36550844.4444; val_kl_reg_loss: 67850.0312; val_edge_recon_loss: 26591378.0000; val_gene_expr_recon_loss: 240575.8281; val_masked_gp_l1_reg_loss: 2190.4658; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9880264.0000; val_global_loss: 36782256.0000; val_optim_loss: 36782256.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9705; val_auprc_score: 0.9585; val_best_acc_score: 0.9282; val_best_f1_score: 0.9304; train_kl_reg_loss: 70609.3793; train_edge_recon_loss: 26303783.7778; train_gene_expr_recon_loss: 239163.7812; train_masked_gp_l1_reg_loss: 2202.5991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9884953.3333; train_global_loss: 36500712.4444; train_optim_loss: 36500712.4444; val_kl_reg_loss: 68663.7812; val_edge_recon_loss: 26459220.0000; val_gene_expr_recon_loss: 239476.4531; val_masked_gp_l1_reg_loss: 2212.2849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9862712.0000; val_global_loss: 36632284.0000; val_optim_loss: 36632284.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9749; val_auprc_score: 0.9658; val_best_acc_score: 0.9312; val_best_f1_score: 0.9332; train_kl_reg_loss: 71550.4280; train_edge_recon_loss: 26350693.7778; train_gene_expr_recon_loss: 237815.1753; train_masked_gp_l1_reg_loss: 2223.1919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9879458.2222; train_global_loss: 36541740.8889; train_optim_loss: 36541740.8889; val_kl_reg_loss: 69262.1406; val_edge_recon_loss: 26426786.0000; val_gene_expr_recon_loss: 239587.8281; val_masked_gp_l1_reg_loss: 2234.3259; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9859227.0000; val_global_loss: 36597096.0000; val_optim_loss: 36597096.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9743; val_auprc_score: 0.9612; val_best_acc_score: 0.9333; val_best_f1_score: 0.9357; train_kl_reg_loss: 71565.9766; train_edge_recon_loss: 26249691.5556; train_gene_expr_recon_loss: 237808.0451; train_masked_gp_l1_reg_loss: 2244.8046; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9799937.3333; train_global_loss: 36361248.0000; train_optim_loss: 36361248.0000; val_kl_reg_loss: 69235.3750; val_edge_recon_loss: 26456544.0000; val_gene_expr_recon_loss: 237368.3281; val_masked_gp_l1_reg_loss: 2253.9429; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9827484.0000; val_global_loss: 36592888.0000; val_optim_loss: 36592888.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9724; val_auprc_score: 0.9611; val_best_acc_score: 0.9285; val_best_f1_score: 0.9316; train_kl_reg_loss: 71875.8872; train_edge_recon_loss: 26324197.3333; train_gene_expr_recon_loss: 235535.0399; train_masked_gp_l1_reg_loss: 2251.1370; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9830792.7778; train_global_loss: 36464652.4444; train_optim_loss: 36464652.4444; val_kl_reg_loss: 69031.2969; val_edge_recon_loss: 26525866.0000; val_gene_expr_recon_loss: 238724.2812; val_masked_gp_l1_reg_loss: 2245.2439; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9841121.0000; val_global_loss: 36676988.0000; val_optim_loss: 36676988.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9720; val_auprc_score: 0.9591; val_best_acc_score: 0.9321; val_best_f1_score: 0.9350; train_kl_reg_loss: 71129.3507; train_edge_recon_loss: 26231696.2222; train_gene_expr_recon_loss: 235824.9549; train_masked_gp_l1_reg_loss: 2242.9595; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9769484.4444; train_global_loss: 36310377.7778; train_optim_loss: 36310377.7778; val_kl_reg_loss: 69397.1406; val_edge_recon_loss: 26364068.0000; val_gene_expr_recon_loss: 238128.3281; val_masked_gp_l1_reg_loss: 2240.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9846962.0000; val_global_loss: 36520796.0000; val_optim_loss: 36520796.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9738; val_auprc_score: 0.9640; val_best_acc_score: 0.9295; val_best_f1_score: 0.9322; train_kl_reg_loss: 72508.3516; train_edge_recon_loss: 26277093.5556; train_gene_expr_recon_loss: 236500.0139; train_masked_gp_l1_reg_loss: 2238.7923; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9852341.0000; train_global_loss: 36440682.2222; train_optim_loss: 36440682.2222; val_kl_reg_loss: 69467.3984; val_edge_recon_loss: 26683870.0000; val_gene_expr_recon_loss: 237794.0312; val_masked_gp_l1_reg_loss: 2236.4478; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9834903.0000; val_global_loss: 36828272.0000; val_optim_loss: 36828272.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9747; val_auprc_score: 0.9638; val_best_acc_score: 0.9332; val_best_f1_score: 0.9362; train_kl_reg_loss: 72393.6155; train_edge_recon_loss: 26272195.7778; train_gene_expr_recon_loss: 235907.7448; train_masked_gp_l1_reg_loss: 2236.2439; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9826131.3333; train_global_loss: 36408864.4444; train_optim_loss: 36408864.4444; val_kl_reg_loss: 69588.1250; val_edge_recon_loss: 26340816.0000; val_gene_expr_recon_loss: 237928.6250; val_masked_gp_l1_reg_loss: 2235.6677; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9846714.0000; val_global_loss: 36497280.0000; val_optim_loss: 36497280.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9765; val_auprc_score: 0.9662; val_best_acc_score: 0.9361; val_best_f1_score: 0.9380; train_kl_reg_loss: 72385.9905; train_edge_recon_loss: 26155478.8889; train_gene_expr_recon_loss: 237680.6111; train_masked_gp_l1_reg_loss: 2235.5271; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840804.5556; train_global_loss: 36308585.7778; train_optim_loss: 36308585.7778; val_kl_reg_loss: 69573.4062; val_edge_recon_loss: 26309720.0000; val_gene_expr_recon_loss: 238193.9375; val_masked_gp_l1_reg_loss: 2235.0330; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9852414.0000; val_global_loss: 36472136.0000; val_optim_loss: 36472136.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9774; val_auprc_score: 0.9684; val_best_acc_score: 0.9324; val_best_f1_score: 0.9346; train_kl_reg_loss: 72636.7266; train_edge_recon_loss: 26204964.6667; train_gene_expr_recon_loss: 235889.4288; train_masked_gp_l1_reg_loss: 2235.4019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9809281.8889; train_global_loss: 36325008.4444; train_optim_loss: 36325008.4444; val_kl_reg_loss: 69316.4219; val_edge_recon_loss: 26358726.0000; val_gene_expr_recon_loss: 237741.0312; val_masked_gp_l1_reg_loss: 2235.4465; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9831472.0000; val_global_loss: 36499492.0000; val_optim_loss: 36499492.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9740; val_auprc_score: 0.9638; val_best_acc_score: 0.9326; val_best_f1_score: 0.9348; train_kl_reg_loss: 72626.3359; train_edge_recon_loss: 26295362.6667; train_gene_expr_recon_loss: 236312.2257; train_masked_gp_l1_reg_loss: 2236.0860; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9860917.0000; train_global_loss: 36467453.7778; train_optim_loss: 36467453.7778; val_kl_reg_loss: 69912.5156; val_edge_recon_loss: 26338092.0000; val_gene_expr_recon_loss: 237936.3906; val_masked_gp_l1_reg_loss: 2236.4514; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9840036.0000; val_global_loss: 36488212.0000; val_optim_loss: 36488212.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9750; val_auprc_score: 0.9618; val_best_acc_score: 0.9334; val_best_f1_score: 0.9362; train_kl_reg_loss: 72705.8898; train_edge_recon_loss: 26347532.6667; train_gene_expr_recon_loss: 236550.3976; train_masked_gp_l1_reg_loss: 2237.2476; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9825171.2222; train_global_loss: 36484197.3333; train_optim_loss: 36484197.3333; val_kl_reg_loss: 69586.6562; val_edge_recon_loss: 26220832.0000; val_gene_expr_recon_loss: 237605.4219; val_masked_gp_l1_reg_loss: 2237.7402; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9832106.0000; val_global_loss: 36362368.0000; val_optim_loss: 36362368.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9757; val_auprc_score: 0.9655; val_best_acc_score: 0.9349; val_best_f1_score: 0.9375; train_kl_reg_loss: 72980.3003; train_edge_recon_loss: 26258458.4444; train_gene_expr_recon_loss: 235839.4583; train_masked_gp_l1_reg_loss: 2238.5743; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9867632.5556; train_global_loss: 36437149.7778; train_optim_loss: 36437149.7778; val_kl_reg_loss: 70118.7891; val_edge_recon_loss: 26268140.0000; val_gene_expr_recon_loss: 237560.9844; val_masked_gp_l1_reg_loss: 2239.2485; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9843169.0000; val_global_loss: 36421228.0000; val_optim_loss: 36421228.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9731; val_auprc_score: 0.9612; val_best_acc_score: 0.9302; val_best_f1_score: 0.9333; train_kl_reg_loss: 72744.8203; train_edge_recon_loss: 26227911.5556; train_gene_expr_recon_loss: 235726.6649; train_masked_gp_l1_reg_loss: 2239.9552; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816327.1111; train_global_loss: 36354950.6667; train_optim_loss: 36354950.6667; val_kl_reg_loss: 69981.6797; val_edge_recon_loss: 26395840.0000; val_gene_expr_recon_loss: 237431.3438; val_masked_gp_l1_reg_loss: 2240.6602; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9824449.0000; val_global_loss: 36529944.0000; val_optim_loss: 36529944.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9757; val_auprc_score: 0.9613; val_best_acc_score: 0.9334; val_best_f1_score: 0.9362; train_kl_reg_loss: 72624.0182; train_edge_recon_loss: 26262219.5556; train_gene_expr_recon_loss: 235835.8889; train_masked_gp_l1_reg_loss: 2242.1714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9812439.1111; train_global_loss: 36385360.0000; train_optim_loss: 36385360.0000; val_kl_reg_loss: 69879.0703; val_edge_recon_loss: 26283568.0000; val_gene_expr_recon_loss: 237600.3594; val_masked_gp_l1_reg_loss: 2242.8977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9825103.0000; val_global_loss: 36418392.0000; val_optim_loss: 36418392.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9763; val_auprc_score: 0.9658; val_best_acc_score: 0.9336; val_best_f1_score: 0.9363; train_kl_reg_loss: 72830.4618; train_edge_recon_loss: 26221556.4444; train_gene_expr_recon_loss: 236128.6076; train_masked_gp_l1_reg_loss: 2243.7854; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9774782.7778; train_global_loss: 36307542.2222; train_optim_loss: 36307542.2222; val_kl_reg_loss: 69996.7344; val_edge_recon_loss: 26285008.0000; val_gene_expr_recon_loss: 237280.6094; val_masked_gp_l1_reg_loss: 2244.5667; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9832588.0000; val_global_loss: 36427116.0000; val_optim_loss: 36427116.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9758; val_auprc_score: 0.9682; val_best_acc_score: 0.9341; val_best_f1_score: 0.9368; train_kl_reg_loss: 73052.8733; train_edge_recon_loss: 26221169.3333; train_gene_expr_recon_loss: 234446.6128; train_masked_gp_l1_reg_loss: 2244.4281; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840385.2222; train_global_loss: 36371297.7778; train_optim_loss: 36371297.7778; val_kl_reg_loss: 70203.7188; val_edge_recon_loss: 26479044.0000; val_gene_expr_recon_loss: 237438.0469; val_masked_gp_l1_reg_loss: 2244.0396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9847844.0000; val_global_loss: 36636776.0000; val_optim_loss: 36636776.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9752; val_auprc_score: 0.9651; val_best_acc_score: 0.9338; val_best_f1_score: 0.9365; train_kl_reg_loss: 73044.3924; train_edge_recon_loss: 26293411.3333; train_gene_expr_recon_loss: 237151.1198; train_masked_gp_l1_reg_loss: 2243.6959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9842167.4444; train_global_loss: 36448019.1111; train_optim_loss: 36448019.1111; val_kl_reg_loss: 70154.3281; val_edge_recon_loss: 26364676.0000; val_gene_expr_recon_loss: 237517.4062; val_masked_gp_l1_reg_loss: 2243.2800; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823910.0000; val_global_loss: 36498504.0000; val_optim_loss: 36498504.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9772; val_auprc_score: 0.9694; val_best_acc_score: 0.9361; val_best_f1_score: 0.9386; train_kl_reg_loss: 72975.0451; train_edge_recon_loss: 26289153.7778; train_gene_expr_recon_loss: 235491.1302; train_masked_gp_l1_reg_loss: 2243.0353; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9829742.0000; train_global_loss: 36429604.8889; train_optim_loss: 36429604.8889; val_kl_reg_loss: 70534.1094; val_edge_recon_loss: 26230088.0000; val_gene_expr_recon_loss: 237732.3281; val_masked_gp_l1_reg_loss: 2242.7544; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9842692.0000; val_global_loss: 36383288.0000; val_optim_loss: 36383288.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9770; val_auprc_score: 0.9648; val_best_acc_score: 0.9376; val_best_f1_score: 0.9399; train_kl_reg_loss: 72681.8802; train_edge_recon_loss: 26285295.1111; train_gene_expr_recon_loss: 235148.8646; train_masked_gp_l1_reg_loss: 2242.6303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9787402.7778; train_global_loss: 36382771.1111; train_optim_loss: 36382771.1111; val_kl_reg_loss: 70326.7188; val_edge_recon_loss: 26156196.0000; val_gene_expr_recon_loss: 237697.3750; val_masked_gp_l1_reg_loss: 2242.4849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9836307.0000; val_global_loss: 36302768.0000; val_optim_loss: 36302768.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9733; val_auprc_score: 0.9612; val_best_acc_score: 0.9286; val_best_f1_score: 0.9316; train_kl_reg_loss: 73031.8342; train_edge_recon_loss: 26252440.6667; train_gene_expr_recon_loss: 235898.2969; train_masked_gp_l1_reg_loss: 2242.4493; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9797358.6667; train_global_loss: 36360972.0000; train_optim_loss: 36360972.0000; val_kl_reg_loss: 70914.3906; val_edge_recon_loss: 26360198.0000; val_gene_expr_recon_loss: 237604.0625; val_masked_gp_l1_reg_loss: 2242.3364; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9847072.0000; val_global_loss: 36518032.0000; val_optim_loss: 36518032.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9731; val_auprc_score: 0.9614; val_best_acc_score: 0.9295; val_best_f1_score: 0.9327; train_kl_reg_loss: 73240.4809; train_edge_recon_loss: 26265491.7778; train_gene_expr_recon_loss: 235797.6927; train_masked_gp_l1_reg_loss: 2242.2376; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9830533.8889; train_global_loss: 36407304.8889; train_optim_loss: 36407304.8889; val_kl_reg_loss: 70164.5000; val_edge_recon_loss: 26536878.0000; val_gene_expr_recon_loss: 237345.5781; val_masked_gp_l1_reg_loss: 2242.1062; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9830739.0000; val_global_loss: 36677368.0000; val_optim_loss: 36677368.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9764; val_auprc_score: 0.9671; val_best_acc_score: 0.9338; val_best_f1_score: 0.9365; train_kl_reg_loss: 73049.2457; train_edge_recon_loss: 26200589.5556; train_gene_expr_recon_loss: 236891.6528; train_masked_gp_l1_reg_loss: 2242.0326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9808895.2222; train_global_loss: 36321667.1111; train_optim_loss: 36321667.1111; val_kl_reg_loss: 70519.0781; val_edge_recon_loss: 26500348.0000; val_gene_expr_recon_loss: 237539.8750; val_masked_gp_l1_reg_loss: 2241.9419; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9844750.0000; val_global_loss: 36655400.0000; val_optim_loss: 36655400.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9721; val_auprc_score: 0.9580; val_best_acc_score: 0.9340; val_best_f1_score: 0.9367; train_kl_reg_loss: 73475.0521; train_edge_recon_loss: 26204703.5556; train_gene_expr_recon_loss: 236282.2448; train_masked_gp_l1_reg_loss: 2241.9638; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9830938.2222; train_global_loss: 36347641.7778; train_optim_loss: 36347641.7778; val_kl_reg_loss: 70330.0625; val_edge_recon_loss: 26300934.0000; val_gene_expr_recon_loss: 237482.7344; val_masked_gp_l1_reg_loss: 2241.9512; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9834476.0000; val_global_loss: 36445464.0000; val_optim_loss: 36445464.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9739; val_auprc_score: 0.9629; val_best_acc_score: 0.9357; val_best_f1_score: 0.9382; train_kl_reg_loss: 73023.4583; train_edge_recon_loss: 26275365.5556; train_gene_expr_recon_loss: 235961.0538; train_masked_gp_l1_reg_loss: 2241.9295; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9845816.5556; train_global_loss: 36432408.8889; train_optim_loss: 36432408.8889; val_kl_reg_loss: 70348.1406; val_edge_recon_loss: 26201714.0000; val_gene_expr_recon_loss: 237315.6562; val_masked_gp_l1_reg_loss: 2241.8875; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9830042.0000; val_global_loss: 36341664.0000; val_optim_loss: 36341664.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9763; val_auprc_score: 0.9677; val_best_acc_score: 0.9341; val_best_f1_score: 0.9368; train_kl_reg_loss: 73338.7040; train_edge_recon_loss: 26082989.1111; train_gene_expr_recon_loss: 236582.0573; train_masked_gp_l1_reg_loss: 2241.8547; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9859417.7778; train_global_loss: 36254569.3333; train_optim_loss: 36254569.3333; val_kl_reg_loss: 70102.1719; val_edge_recon_loss: 26312778.0000; val_gene_expr_recon_loss: 237302.7969; val_masked_gp_l1_reg_loss: 2241.8142; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9822366.0000; val_global_loss: 36444792.0000; val_optim_loss: 36444792.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9754; val_auprc_score: 0.9651; val_best_acc_score: 0.9344; val_best_f1_score: 0.9370; train_kl_reg_loss: 72899.5712; train_edge_recon_loss: 26248889.5556; train_gene_expr_recon_loss: 236175.9028; train_masked_gp_l1_reg_loss: 2241.7912; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9836473.5556; train_global_loss: 36396681.3333; train_optim_loss: 36396681.3333; val_kl_reg_loss: 70361.5000; val_edge_recon_loss: 26337778.0000; val_gene_expr_recon_loss: 237352.2188; val_masked_gp_l1_reg_loss: 2241.7603; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9834803.0000; val_global_loss: 36482536.0000; val_optim_loss: 36482536.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9745; val_auprc_score: 0.9622; val_best_acc_score: 0.9314; val_best_f1_score: 0.9337; train_kl_reg_loss: 72753.7682; train_edge_recon_loss: 26186154.2222; train_gene_expr_recon_loss: 236285.0938; train_masked_gp_l1_reg_loss: 2241.7348; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9778773.1111; train_global_loss: 36276208.0000; train_optim_loss: 36276208.0000; val_kl_reg_loss: 70157.5312; val_edge_recon_loss: 26293442.0000; val_gene_expr_recon_loss: 237281.7031; val_masked_gp_l1_reg_loss: 2241.7073; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9821993.0000; val_global_loss: 36425116.0000; val_optim_loss: 36425116.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 36 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
Val AUROC score: 0.9759
Val AUPRC score: 0.9670
Val best accuracy score: 0.9353
Val best F1 score: 0.9379
Val gene expr MSE score: 0.5936
Val chrom access MSE score: 0.0881
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
