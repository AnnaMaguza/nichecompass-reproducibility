[True]
Run timestamp: 07082023_210236_116.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_116']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8717; val_auprc_score: 0.8839; val_best_acc_score: 0.5348; val_best_f1_score: 0.6822; train_kl_reg_loss: 147523.3490; train_edge_recon_loss: 3479207.9167; train_gene_expr_recon_loss: 1275478.6944; train_masked_gp_l1_reg_loss: 16405.5534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119030.2604; train_chrom_access_recon_loss: 2956872.0139; train_global_loss: 7994517.7778; train_optim_loss: 7994517.7778; val_kl_reg_loss: 45658.1172; val_edge_recon_loss: 4062937.2500; val_gene_expr_recon_loss: 1141427.0000; val_masked_gp_l1_reg_loss: 12605.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116568.2344; val_chrom_access_recon_loss: 1918446.3750; val_global_loss: 7297642.5000; val_optim_loss: 7297642.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8639; val_auprc_score: 0.8784; val_best_acc_score: 0.6025; val_best_f1_score: 0.7125; train_kl_reg_loss: 40841.0098; train_edge_recon_loss: 3484785.0833; train_gene_expr_recon_loss: 1071651.3889; train_masked_gp_l1_reg_loss: 11316.7918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115047.4010; train_chrom_access_recon_loss: 1689612.8056; train_global_loss: 6413254.5000; train_optim_loss: 6413254.5000; val_kl_reg_loss: 57313.4062; val_edge_recon_loss: 4058209.0000; val_gene_expr_recon_loss: 986523.4375; val_masked_gp_l1_reg_loss: 10237.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113272.6562; val_chrom_access_recon_loss: 1552349.5000; val_global_loss: 6777906.0000; val_optim_loss: 6777906.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8514; val_auprc_score: 0.8616; val_best_acc_score: 0.6617; val_best_f1_score: 0.7406; train_kl_reg_loss: 31155.6165; train_edge_recon_loss: 3481936.6667; train_gene_expr_recon_loss: 949605.0833; train_masked_gp_l1_reg_loss: 10100.4734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112002.1345; train_chrom_access_recon_loss: 1489487.9583; train_global_loss: 6074287.8889; train_optim_loss: 6074287.8889; val_kl_reg_loss: 32335.9609; val_edge_recon_loss: 4052987.5000; val_gene_expr_recon_loss: 904844.8125; val_masked_gp_l1_reg_loss: 9936.9287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110449.1328; val_chrom_access_recon_loss: 1453671.5000; val_global_loss: 6564226.0000; val_optim_loss: 6564226.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8315; val_auprc_score: 0.8340; val_best_acc_score: 0.7158; val_best_f1_score: 0.7638; train_kl_reg_loss: 26916.7496; train_edge_recon_loss: 3484099.5556; train_gene_expr_recon_loss: 894067.1736; train_masked_gp_l1_reg_loss: 9691.7779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109210.2344; train_chrom_access_recon_loss: 1428160.3889; train_global_loss: 5952145.9444; train_optim_loss: 5952145.9444; val_kl_reg_loss: 35073.6875; val_edge_recon_loss: 4041469.5000; val_gene_expr_recon_loss: 863707.0625; val_masked_gp_l1_reg_loss: 9403.3066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107639.4062; val_chrom_access_recon_loss: 1424243.7500; val_global_loss: 6481537.0000; val_optim_loss: 6481537.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8219; val_auprc_score: 0.8197; val_best_acc_score: 0.7377; val_best_f1_score: 0.7558; train_kl_reg_loss: 23802.6949; train_edge_recon_loss: 3480485.8611; train_gene_expr_recon_loss: 852396.7569; train_masked_gp_l1_reg_loss: 9235.5982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106320.7170; train_chrom_access_recon_loss: 1407157.6250; train_global_loss: 5879399.1111; train_optim_loss: 5879399.1111; val_kl_reg_loss: 20105.0352; val_edge_recon_loss: 4014754.5000; val_gene_expr_recon_loss: 836109.1250; val_masked_gp_l1_reg_loss: 9040.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104609.8828; val_chrom_access_recon_loss: 1396748.1250; val_global_loss: 6381366.5000; val_optim_loss: 6381366.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8187; val_auprc_score: 0.8035; val_best_acc_score: 0.7229; val_best_f1_score: 0.7716; train_kl_reg_loss: 20016.3878; train_edge_recon_loss: 3474293.3333; train_gene_expr_recon_loss: 826169.3125; train_masked_gp_l1_reg_loss: 8934.2662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103140.0634; train_chrom_access_recon_loss: 1377468.0556; train_global_loss: 5810021.2222; train_optim_loss: 5810021.2222; val_kl_reg_loss: 18066.2344; val_edge_recon_loss: 3944919.7500; val_gene_expr_recon_loss: 815075.6250; val_masked_gp_l1_reg_loss: 8821.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101242.0469; val_chrom_access_recon_loss: 1383955.6250; val_global_loss: 6272081.0000; val_optim_loss: 6272081.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8253; val_auprc_score: 0.7936; val_best_acc_score: 0.7575; val_best_f1_score: 0.7850; train_kl_reg_loss: 15057.9320; train_edge_recon_loss: 3445594.1667; train_gene_expr_recon_loss: 803429.1319; train_masked_gp_l1_reg_loss: 8756.0460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99636.3576; train_chrom_access_recon_loss: 1367634.0833; train_global_loss: 5740107.6111; train_optim_loss: 5740107.6111; val_kl_reg_loss: 11614.0938; val_edge_recon_loss: 3607824.7500; val_gene_expr_recon_loss: 811809.0000; val_masked_gp_l1_reg_loss: 8656.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97576.4062; val_chrom_access_recon_loss: 1379862.0000; val_global_loss: 5917343.0000; val_optim_loss: 5917343.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8394; val_auprc_score: 0.8236; val_best_acc_score: 0.7545; val_best_f1_score: 0.7822; train_kl_reg_loss: 9934.1960; train_edge_recon_loss: 3213953.4722; train_gene_expr_recon_loss: 826983.2083; train_masked_gp_l1_reg_loss: 8537.6679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95870.0078; train_chrom_access_recon_loss: 1369064.9167; train_global_loss: 5524343.3333; train_optim_loss: 5524343.3333; val_kl_reg_loss: 14000.5234; val_edge_recon_loss: 2996217.2500; val_gene_expr_recon_loss: 851826.8750; val_masked_gp_l1_reg_loss: 8361.9268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93733.1094; val_chrom_access_recon_loss: 1386800.1250; val_global_loss: 5350939.5000; val_optim_loss: 5350939.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8586; val_auprc_score: 0.8387; val_best_acc_score: 0.7684; val_best_f1_score: 0.7918; train_kl_reg_loss: 20303.9071; train_edge_recon_loss: 2933451.6111; train_gene_expr_recon_loss: 829748.0764; train_masked_gp_l1_reg_loss: 8251.9871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92060.8594; train_chrom_access_recon_loss: 1366506.3194; train_global_loss: 5250322.7778; train_optim_loss: 5250322.7778; val_kl_reg_loss: 28204.9883; val_edge_recon_loss: 2910173.2500; val_gene_expr_recon_loss: 813971.1250; val_masked_gp_l1_reg_loss: 8144.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89990.4531; val_chrom_access_recon_loss: 1375814.2500; val_global_loss: 5226298.0000; val_optim_loss: 5226298.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8770; val_auprc_score: 0.8625; val_best_acc_score: 0.7925; val_best_f1_score: 0.7992; train_kl_reg_loss: 35091.5681; train_edge_recon_loss: 2894758.5833; train_gene_expr_recon_loss: 796891.3681; train_masked_gp_l1_reg_loss: 8074.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88325.3125; train_chrom_access_recon_loss: 1361170.4444; train_global_loss: 5184311.5000; train_optim_loss: 5184311.5000; val_kl_reg_loss: 38734.0391; val_edge_recon_loss: 2894615.5000; val_gene_expr_recon_loss: 784677.1250; val_masked_gp_l1_reg_loss: 8002.3262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86228.1250; val_chrom_access_recon_loss: 1363378.0000; val_global_loss: 5175635.0000; val_optim_loss: 5175635.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8880; val_auprc_score: 0.8677; val_best_acc_score: 0.8056; val_best_f1_score: 0.8127; train_kl_reg_loss: 40098.0508; train_edge_recon_loss: 2867233.3889; train_gene_expr_recon_loss: 769465.9028; train_masked_gp_l1_reg_loss: 7989.6681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84557.1936; train_chrom_access_recon_loss: 1345664.0694; train_global_loss: 5115008.2222; train_optim_loss: 5115008.2222; val_kl_reg_loss: 40925.2422; val_edge_recon_loss: 2846358.0000; val_gene_expr_recon_loss: 768033.0000; val_masked_gp_l1_reg_loss: 7924.7944; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82465.7188; val_chrom_access_recon_loss: 1357591.3750; val_global_loss: 5103298.0000; val_optim_loss: 5103298.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8891; val_auprc_score: 0.8660; val_best_acc_score: 0.8088; val_best_f1_score: 0.8241; train_kl_reg_loss: 41012.4071; train_edge_recon_loss: 2838742.5000; train_gene_expr_recon_loss: 755258.0764; train_masked_gp_l1_reg_loss: 7868.2490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80801.4592; train_chrom_access_recon_loss: 1341966.1250; train_global_loss: 5065648.7778; train_optim_loss: 5065648.7778; val_kl_reg_loss: 39752.1406; val_edge_recon_loss: 2827329.0000; val_gene_expr_recon_loss: 760060.0000; val_masked_gp_l1_reg_loss: 7815.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78729.2969; val_chrom_access_recon_loss: 1353579.0000; val_global_loss: 5067265.0000; val_optim_loss: 5067265.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8936; val_auprc_score: 0.8650; val_best_acc_score: 0.8169; val_best_f1_score: 0.8311; train_kl_reg_loss: 40358.1146; train_edge_recon_loss: 2812600.7500; train_gene_expr_recon_loss: 743437.8889; train_masked_gp_l1_reg_loss: 7804.2855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77102.6424; train_chrom_access_recon_loss: 1331364.4583; train_global_loss: 5012668.1667; train_optim_loss: 5012668.1667; val_kl_reg_loss: 39904.8125; val_edge_recon_loss: 2821074.7500; val_gene_expr_recon_loss: 750053.8750; val_masked_gp_l1_reg_loss: 7809.2842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75087.8594; val_chrom_access_recon_loss: 1349012.5000; val_global_loss: 5042943.0000; val_optim_loss: 5042943.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9045; val_auprc_score: 0.8761; val_best_acc_score: 0.8407; val_best_f1_score: 0.8538; train_kl_reg_loss: 40640.4575; train_edge_recon_loss: 2794540.9167; train_gene_expr_recon_loss: 737590.7153; train_masked_gp_l1_reg_loss: 7811.5151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73526.4236; train_chrom_access_recon_loss: 1328444.6528; train_global_loss: 4982554.6111; train_optim_loss: 4982554.6111; val_kl_reg_loss: 40502.6211; val_edge_recon_loss: 2766161.5000; val_gene_expr_recon_loss: 744830.4375; val_masked_gp_l1_reg_loss: 7812.2944; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71611.7656; val_chrom_access_recon_loss: 1345427.6250; val_global_loss: 4976346.0000; val_optim_loss: 4976346.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9108; val_auprc_score: 0.8854; val_best_acc_score: 0.8471; val_best_f1_score: 0.8591; train_kl_reg_loss: 42077.7431; train_edge_recon_loss: 2751924.1389; train_gene_expr_recon_loss: 733345.0486; train_masked_gp_l1_reg_loss: 7815.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70146.8958; train_chrom_access_recon_loss: 1328795.9444; train_global_loss: 4934105.2222; train_optim_loss: 4934105.2222; val_kl_reg_loss: 42029.5547; val_edge_recon_loss: 2788607.7500; val_gene_expr_recon_loss: 740282.3750; val_masked_gp_l1_reg_loss: 7815.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68356.2109; val_chrom_access_recon_loss: 1342458.8750; val_global_loss: 4989550.0000; val_optim_loss: 4989550.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9239; val_auprc_score: 0.9040; val_best_acc_score: 0.8581; val_best_f1_score: 0.8662; train_kl_reg_loss: 43706.9874; train_edge_recon_loss: 2748056.0556; train_gene_expr_recon_loss: 731047.2778; train_masked_gp_l1_reg_loss: 7833.7947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66998.4792; train_chrom_access_recon_loss: 1323839.4861; train_global_loss: 4921482.1667; train_optim_loss: 4921482.1667; val_kl_reg_loss: 42567.2227; val_edge_recon_loss: 2748224.7500; val_gene_expr_recon_loss: 733413.6250; val_masked_gp_l1_reg_loss: 7871.1748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65333.7500; val_chrom_access_recon_loss: 1338556.0000; val_global_loss: 4935966.5000; val_optim_loss: 4935966.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9340; val_auprc_score: 0.9165; val_best_acc_score: 0.8665; val_best_f1_score: 0.8756; train_kl_reg_loss: 43526.3086; train_edge_recon_loss: 2741875.4167; train_gene_expr_recon_loss: 728856.7500; train_masked_gp_l1_reg_loss: 7906.1735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64058.0890; train_chrom_access_recon_loss: 1323481.0556; train_global_loss: 4909703.7778; train_optim_loss: 4909703.7778; val_kl_reg_loss: 41984.4648; val_edge_recon_loss: 2724891.2500; val_gene_expr_recon_loss: 727807.1875; val_masked_gp_l1_reg_loss: 7945.7314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62504.2617; val_chrom_access_recon_loss: 1335267.8750; val_global_loss: 4900401.0000; val_optim_loss: 4900401.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9394; val_auprc_score: 0.9224; val_best_acc_score: 0.8704; val_best_f1_score: 0.8788; train_kl_reg_loss: 42001.1176; train_edge_recon_loss: 2722152.9167; train_gene_expr_recon_loss: 723446.3056; train_masked_gp_l1_reg_loss: 7976.3057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61315.3533; train_chrom_access_recon_loss: 1317821.6111; train_global_loss: 4874713.6111; train_optim_loss: 4874713.6111; val_kl_reg_loss: 40864.9062; val_edge_recon_loss: 2743545.5000; val_gene_expr_recon_loss: 725598.7500; val_masked_gp_l1_reg_loss: 8006.9819; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59856.0625; val_chrom_access_recon_loss: 1332283.7500; val_global_loss: 4910156.0000; val_optim_loss: 4910156.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9508; val_auprc_score: 0.9368; val_best_acc_score: 0.8866; val_best_f1_score: 0.8921; train_kl_reg_loss: 41102.5226; train_edge_recon_loss: 2720982.3611; train_gene_expr_recon_loss: 717975.4167; train_masked_gp_l1_reg_loss: 8042.6148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58746.7148; train_chrom_access_recon_loss: 1319341.0833; train_global_loss: 4866190.7222; train_optim_loss: 4866190.7222; val_kl_reg_loss: 39849.8125; val_edge_recon_loss: 2705836.5000; val_gene_expr_recon_loss: 720522.9375; val_masked_gp_l1_reg_loss: 8081.9912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57385.2656; val_chrom_access_recon_loss: 1330254.3750; val_global_loss: 4861931.0000; val_optim_loss: 4861931.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9573; val_auprc_score: 0.9450; val_best_acc_score: 0.8980; val_best_f1_score: 0.9033; train_kl_reg_loss: 40181.9323; train_edge_recon_loss: 2714532.5833; train_gene_expr_recon_loss: 713922.0694; train_masked_gp_l1_reg_loss: 8124.3184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56339.6667; train_chrom_access_recon_loss: 1317513.5833; train_global_loss: 4850614.1111; train_optim_loss: 4850614.1111; val_kl_reg_loss: 38190.3359; val_edge_recon_loss: 2700954.0000; val_gene_expr_recon_loss: 721285.8750; val_masked_gp_l1_reg_loss: 8165.9302; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55052.9453; val_chrom_access_recon_loss: 1329095.5000; val_global_loss: 4852744.5000; val_optim_loss: 4852744.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9611; val_auprc_score: 0.9486; val_best_acc_score: 0.9050; val_best_f1_score: 0.9095; train_kl_reg_loss: 38266.5408; train_edge_recon_loss: 2700837.9167; train_gene_expr_recon_loss: 711293.3750; train_masked_gp_l1_reg_loss: 8215.4815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54068.5560; train_chrom_access_recon_loss: 1313679.5000; train_global_loss: 4826361.4444; train_optim_loss: 4826361.4444; val_kl_reg_loss: 37746.0547; val_edge_recon_loss: 2700320.7500; val_gene_expr_recon_loss: 716866.7500; val_masked_gp_l1_reg_loss: 8257.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52864.8516; val_chrom_access_recon_loss: 1325815.8750; val_global_loss: 4841871.5000; val_optim_loss: 4841871.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9636; val_auprc_score: 0.9497; val_best_acc_score: 0.9138; val_best_f1_score: 0.9173; train_kl_reg_loss: 38586.4210; train_edge_recon_loss: 2685457.9722; train_gene_expr_recon_loss: 708692.2986; train_masked_gp_l1_reg_loss: 8290.9919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51941.9540; train_chrom_access_recon_loss: 1303427.9028; train_global_loss: 4796397.6111; train_optim_loss: 4796397.6111; val_kl_reg_loss: 38651.9258; val_edge_recon_loss: 2677793.2500; val_gene_expr_recon_loss: 715694.3750; val_masked_gp_l1_reg_loss: 8326.1221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50809.2617; val_chrom_access_recon_loss: 1324093.7500; val_global_loss: 4815368.5000; val_optim_loss: 4815368.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9636; val_auprc_score: 0.9488; val_best_acc_score: 0.9150; val_best_f1_score: 0.9176; train_kl_reg_loss: 40601.7261; train_edge_recon_loss: 2668029.2500; train_gene_expr_recon_loss: 707448.8194; train_masked_gp_l1_reg_loss: 8363.1879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49945.6762; train_chrom_access_recon_loss: 1311240.6528; train_global_loss: 4785629.2778; train_optim_loss: 4785629.2778; val_kl_reg_loss: 40125.8906; val_edge_recon_loss: 2687191.2500; val_gene_expr_recon_loss: 711277.3750; val_masked_gp_l1_reg_loss: 8412.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48880.2344; val_chrom_access_recon_loss: 1322111.8750; val_global_loss: 4817999.5000; val_optim_loss: 4817999.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9658; val_auprc_score: 0.9553; val_best_acc_score: 0.9143; val_best_f1_score: 0.9181; train_kl_reg_loss: 42307.0148; train_edge_recon_loss: 2673244.5556; train_gene_expr_recon_loss: 706030.1250; train_masked_gp_l1_reg_loss: 8455.2660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48059.2804; train_chrom_access_recon_loss: 1307783.0278; train_global_loss: 4785879.2222; train_optim_loss: 4785879.2222; val_kl_reg_loss: 41723.4531; val_edge_recon_loss: 2696671.0000; val_gene_expr_recon_loss: 708576.5625; val_masked_gp_l1_reg_loss: 8499.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47044.8516; val_chrom_access_recon_loss: 1319307.8750; val_global_loss: 4821823.5000; val_optim_loss: 4821823.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9683; val_auprc_score: 0.9540; val_best_acc_score: 0.9193; val_best_f1_score: 0.9226; train_kl_reg_loss: 42990.4648; train_edge_recon_loss: 2674844.6111; train_gene_expr_recon_loss: 702158.7778; train_masked_gp_l1_reg_loss: 8535.4257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46268.8880; train_chrom_access_recon_loss: 1305337.0694; train_global_loss: 4780135.2778; train_optim_loss: 4780135.2778; val_kl_reg_loss: 41639.7773; val_edge_recon_loss: 2675643.5000; val_gene_expr_recon_loss: 706304.3750; val_masked_gp_l1_reg_loss: 8570.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45309.1992; val_chrom_access_recon_loss: 1316783.3750; val_global_loss: 4794250.5000; val_optim_loss: 4794250.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9719; val_auprc_score: 0.9635; val_best_acc_score: 0.9258; val_best_f1_score: 0.9285; train_kl_reg_loss: 41113.5651; train_edge_recon_loss: 2675154.2778; train_gene_expr_recon_loss: 975386.7361; train_masked_gp_l1_reg_loss: 8628.9192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44402.1159; train_chrom_access_recon_loss: 1374178.4583; train_global_loss: 5118864.1667; train_optim_loss: 5118864.1667; val_kl_reg_loss: 25882.1484; val_edge_recon_loss: 2677538.5000; val_gene_expr_recon_loss: 982201.8750; val_masked_gp_l1_reg_loss: 8705.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43183.9609; val_chrom_access_recon_loss: 1388599.6250; val_global_loss: 5126111.5000; val_optim_loss: 5126111.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9725; val_auprc_score: 0.9654; val_best_acc_score: 0.9210; val_best_f1_score: 0.9246; train_kl_reg_loss: 38962.9510; train_edge_recon_loss: 2662363.7222; train_gene_expr_recon_loss: 971115.8264; train_masked_gp_l1_reg_loss: 8791.8178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42161.4089; train_chrom_access_recon_loss: 1373876.0417; train_global_loss: 5097271.8333; train_optim_loss: 5097271.8333; val_kl_reg_loss: 25419.3164; val_edge_recon_loss: 2669564.0000; val_gene_expr_recon_loss: 975277.8750; val_masked_gp_l1_reg_loss: 8901.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40888.4648; val_chrom_access_recon_loss: 1385615.7500; val_global_loss: 5105667.0000; val_optim_loss: 5105667.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9751; val_auprc_score: 0.9661; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 36551.2331; train_edge_recon_loss: 2662639.3889; train_gene_expr_recon_loss: 956936.5139; train_masked_gp_l1_reg_loss: 9004.5246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39899.4479; train_chrom_access_recon_loss: 1369473.0556; train_global_loss: 5074504.0000; train_optim_loss: 5074504.0000; val_kl_reg_loss: 24630.5391; val_edge_recon_loss: 2660815.0000; val_gene_expr_recon_loss: 968742.6875; val_masked_gp_l1_reg_loss: 9116.6006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38686.4023; val_chrom_access_recon_loss: 1382556.1250; val_global_loss: 5084547.5000; val_optim_loss: 5084547.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9738; val_auprc_score: 0.9648; val_best_acc_score: 0.9293; val_best_f1_score: 0.9313; train_kl_reg_loss: 35072.8754; train_edge_recon_loss: 2662375.2222; train_gene_expr_recon_loss: 955785.6736; train_masked_gp_l1_reg_loss: 9197.4026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37759.9089; train_chrom_access_recon_loss: 1368921.7778; train_global_loss: 5069112.8889; train_optim_loss: 5069112.8889; val_kl_reg_loss: 24729.3691; val_edge_recon_loss: 2689658.5000; val_gene_expr_recon_loss: 966881.8750; val_masked_gp_l1_reg_loss: 9298.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36632.9609; val_chrom_access_recon_loss: 1381300.2500; val_global_loss: 5108501.5000; val_optim_loss: 5108501.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9745; val_auprc_score: 0.9664; val_best_acc_score: 0.9293; val_best_f1_score: 0.9316; train_kl_reg_loss: 34531.2817; train_edge_recon_loss: 2651563.6667; train_gene_expr_recon_loss: 958846.7847; train_masked_gp_l1_reg_loss: 9248.6906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36510.6628; train_chrom_access_recon_loss: 1365568.3750; train_global_loss: 5056269.4444; train_optim_loss: 5056269.4444; val_kl_reg_loss: 24560.5781; val_edge_recon_loss: 2688014.7500; val_gene_expr_recon_loss: 966333.7500; val_masked_gp_l1_reg_loss: 9201.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36361.4492; val_chrom_access_recon_loss: 1381017.7500; val_global_loss: 5105490.0000; val_optim_loss: 5105490.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9747; val_auprc_score: 0.9661; val_best_acc_score: 0.9324; val_best_f1_score: 0.9342; train_kl_reg_loss: 34345.9948; train_edge_recon_loss: 2656935.8611; train_gene_expr_recon_loss: 955997.5625; train_masked_gp_l1_reg_loss: 9193.9805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36254.0707; train_chrom_access_recon_loss: 1364981.5556; train_global_loss: 5057709.0000; train_optim_loss: 5057709.0000; val_kl_reg_loss: 24479.8672; val_edge_recon_loss: 2662150.7500; val_gene_expr_recon_loss: 965992.7500; val_masked_gp_l1_reg_loss: 9180.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36119.5664; val_chrom_access_recon_loss: 1380968.0000; val_global_loss: 5078892.0000; val_optim_loss: 5078892.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9695; val_best_acc_score: 0.9330; val_best_f1_score: 0.9349; train_kl_reg_loss: 34125.1089; train_edge_recon_loss: 2655055.7500; train_gene_expr_recon_loss: 957046.7708; train_masked_gp_l1_reg_loss: 9177.8800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36017.8021; train_chrom_access_recon_loss: 1362665.2639; train_global_loss: 5054088.5556; train_optim_loss: 5054088.5556; val_kl_reg_loss: 24495.5312; val_edge_recon_loss: 2668048.5000; val_gene_expr_recon_loss: 965824.8750; val_masked_gp_l1_reg_loss: 9174.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35892.2734; val_chrom_access_recon_loss: 1381086.7500; val_global_loss: 5084523.0000; val_optim_loss: 5084523.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9769; val_auprc_score: 0.9679; val_best_acc_score: 0.9345; val_best_f1_score: 0.9363; train_kl_reg_loss: 34024.4280; train_edge_recon_loss: 2651100.3333; train_gene_expr_recon_loss: 952800.9931; train_masked_gp_l1_reg_loss: 9175.6595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35794.5773; train_chrom_access_recon_loss: 1366746.0278; train_global_loss: 5049642.1111; train_optim_loss: 5049642.1111; val_kl_reg_loss: 24351.0000; val_edge_recon_loss: 2672018.5000; val_gene_expr_recon_loss: 965647.2500; val_masked_gp_l1_reg_loss: 9178.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35675.7148; val_chrom_access_recon_loss: 1380827.5000; val_global_loss: 5087698.0000; val_optim_loss: 5087698.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9701
val AUPRC score: 0.9608
val best accuracy score: 0.9177
val best F1 score: 0.9211
val target rna MSE score: 4.4739
val source rna MSE score: 3.3043
val target atac MSE score: 0.1387
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
