[True]
Run timestamp: 10102023_024247_116.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_116']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6832; val_auprc_score: 0.6583; val_best_acc_score: 0.5038; val_best_f1_score: 0.6680; train_kl_reg_loss: 40933.5887; train_edge_recon_loss: 3523499.6402; train_gene_expr_recon_loss: 14152020.3333; train_masked_gp_l1_reg_loss: 94477.3919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2965997.2519; train_chrom_access_recon_loss: 4976993.9318; train_global_loss: 25753922.0303; train_optim_loss: 25753922.0303; val_kl_reg_loss: 92889.1973; val_edge_recon_loss: 4065015.1562; val_gene_expr_recon_loss: 12904562.2500; val_masked_gp_l1_reg_loss: 83136.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1635666.5000; val_chrom_access_recon_loss: 4769160.6250; val_global_loss: 23550429.2500; val_optim_loss: 23550429.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6659; val_auprc_score: 0.6445; val_best_acc_score: 0.5615; val_best_f1_score: 0.6870; train_kl_reg_loss: 88613.5159; train_edge_recon_loss: 3519858.3068; train_gene_expr_recon_loss: 12876464.4242; train_masked_gp_l1_reg_loss: 78073.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 885221.5450; train_chrom_access_recon_loss: 4728990.3333; train_global_loss: 22177221.7273; train_optim_loss: 22177221.7273; val_kl_reg_loss: 100163.7998; val_edge_recon_loss: 4061866.6250; val_gene_expr_recon_loss: 12680484.3750; val_masked_gp_l1_reg_loss: 75142.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 425920.1562; val_chrom_access_recon_loss: 4707300.1875; val_global_loss: 22050877.5000; val_optim_loss: 22050877.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7257; val_auprc_score: 0.7013; val_best_acc_score: 0.6591; val_best_f1_score: 0.6988; train_kl_reg_loss: 85815.4825; train_edge_recon_loss: 3513269.3826; train_gene_expr_recon_loss: 12720519.8333; train_masked_gp_l1_reg_loss: 74694.3912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 286842.5069; train_chrom_access_recon_loss: 4693476.3333; train_global_loss: 21374617.6667; train_optim_loss: 21374617.6667; val_kl_reg_loss: 73805.5840; val_edge_recon_loss: 4046119.7500; val_gene_expr_recon_loss: 12585176.2500; val_masked_gp_l1_reg_loss: 74705.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196492.7188; val_chrom_access_recon_loss: 4728079.0000; val_global_loss: 21704378.5000; val_optim_loss: 21704378.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8074; val_auprc_score: 0.7842; val_best_acc_score: 0.7335; val_best_f1_score: 0.7553; train_kl_reg_loss: 75190.4431; train_edge_recon_loss: 3499948.4621; train_gene_expr_recon_loss: 12620942.6364; train_masked_gp_l1_reg_loss: 75706.1696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157134.5188; train_chrom_access_recon_loss: 4663925.5606; train_global_loss: 21092847.8485; train_optim_loss: 21092847.8485; val_kl_reg_loss: 63940.9434; val_edge_recon_loss: 3845939.8438; val_gene_expr_recon_loss: 12420333.7500; val_masked_gp_l1_reg_loss: 77311.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128279.0234; val_chrom_access_recon_loss: 4603145.0625; val_global_loss: 21138950.7500; val_optim_loss: 21138950.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8407; val_auprc_score: 0.8121; val_best_acc_score: 0.7606; val_best_f1_score: 0.7920; train_kl_reg_loss: 65869.1779; train_edge_recon_loss: 3266926.5833; train_gene_expr_recon_loss: 12566036.7727; train_masked_gp_l1_reg_loss: 80837.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113405.9530; train_chrom_access_recon_loss: 4639676.8030; train_global_loss: 20732752.9091; train_optim_loss: 20732752.9091; val_kl_reg_loss: 87111.3232; val_edge_recon_loss: 3074580.9375; val_gene_expr_recon_loss: 12355081.1250; val_masked_gp_l1_reg_loss: 85688.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102732.9219; val_chrom_access_recon_loss: 4629710.9375; val_global_loss: 20334905.2500; val_optim_loss: 20334905.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8781; val_auprc_score: 0.8464; val_best_acc_score: 0.8066; val_best_f1_score: 0.8246; train_kl_reg_loss: 100768.4536; train_edge_recon_loss: 2914181.7841; train_gene_expr_recon_loss: 12495401.5303; train_masked_gp_l1_reg_loss: 87456.3187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95805.4991; train_chrom_access_recon_loss: 4620604.6288; train_global_loss: 20314218.0909; train_optim_loss: 20314218.0909; val_kl_reg_loss: 98513.7158; val_edge_recon_loss: 2856685.6875; val_gene_expr_recon_loss: 12296471.7500; val_masked_gp_l1_reg_loss: 88891.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91144.8281; val_chrom_access_recon_loss: 4569115.5000; val_global_loss: 20000824.0000; val_optim_loss: 20000824.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8817; val_auprc_score: 0.8455; val_best_acc_score: 0.8130; val_best_f1_score: 0.8317; train_kl_reg_loss: 99960.8343; train_edge_recon_loss: 2860175.6364; train_gene_expr_recon_loss: 12406241.8333; train_masked_gp_l1_reg_loss: 89993.5356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86632.2900; train_chrom_access_recon_loss: 4592983.5682; train_global_loss: 20135987.6364; train_optim_loss: 20135987.6364; val_kl_reg_loss: 96007.5361; val_edge_recon_loss: 2842216.7188; val_gene_expr_recon_loss: 12203490.0000; val_masked_gp_l1_reg_loss: 91148.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83011.6328; val_chrom_access_recon_loss: 4578601.8125; val_global_loss: 19894475.7500; val_optim_loss: 19894475.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8869; val_auprc_score: 0.8561; val_best_acc_score: 0.8189; val_best_f1_score: 0.8386; train_kl_reg_loss: 97267.9750; train_edge_recon_loss: 2849168.7045; train_gene_expr_recon_loss: 12342673.7576; train_masked_gp_l1_reg_loss: 92455.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80488.6319; train_chrom_access_recon_loss: 4573769.5530; train_global_loss: 20035823.9091; train_optim_loss: 20035823.9091; val_kl_reg_loss: 93023.9717; val_edge_recon_loss: 2874110.1875; val_gene_expr_recon_loss: 12081388.5000; val_masked_gp_l1_reg_loss: 93789.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78396.8906; val_chrom_access_recon_loss: 4511434.0625; val_global_loss: 19732142.5000; val_optim_loss: 19732142.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8861; val_auprc_score: 0.8503; val_best_acc_score: 0.8192; val_best_f1_score: 0.8403; train_kl_reg_loss: 92263.8954; train_edge_recon_loss: 2832415.9621; train_gene_expr_recon_loss: 12283705.8485; train_masked_gp_l1_reg_loss: 94806.1125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76283.5451; train_chrom_access_recon_loss: 4555957.4924; train_global_loss: 19935432.7576; train_optim_loss: 19935432.7576; val_kl_reg_loss: 88602.9102; val_edge_recon_loss: 2868756.5312; val_gene_expr_recon_loss: 12041401.7500; val_masked_gp_l1_reg_loss: 95878.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74732.9844; val_chrom_access_recon_loss: 4510625.3125; val_global_loss: 19679997.2500; val_optim_loss: 19679997.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8930; val_auprc_score: 0.8593; val_best_acc_score: 0.8256; val_best_f1_score: 0.8431; train_kl_reg_loss: 95072.9535; train_edge_recon_loss: 2810085.8220; train_gene_expr_recon_loss: 12232337.7879; train_masked_gp_l1_reg_loss: 97015.6841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73187.7953; train_chrom_access_recon_loss: 4537806.7424; train_global_loss: 19845506.6970; train_optim_loss: 19845506.6970; val_kl_reg_loss: 94201.6016; val_edge_recon_loss: 2851708.4062; val_gene_expr_recon_loss: 12011469.8750; val_masked_gp_l1_reg_loss: 97882.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71963.0469; val_chrom_access_recon_loss: 4492214.2500; val_global_loss: 19619439.0000; val_optim_loss: 19619439.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8921; val_auprc_score: 0.8566; val_best_acc_score: 0.8278; val_best_f1_score: 0.8405; train_kl_reg_loss: 95313.4933; train_edge_recon_loss: 2800984.7992; train_gene_expr_recon_loss: 12184781.6212; train_masked_gp_l1_reg_loss: 98516.9281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70673.5353; train_chrom_access_recon_loss: 4523447.9848; train_global_loss: 19773718.3939; train_optim_loss: 19773718.3939; val_kl_reg_loss: 97623.0654; val_edge_recon_loss: 2836680.1875; val_gene_expr_recon_loss: 12059816.2500; val_masked_gp_l1_reg_loss: 99209.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69578.1562; val_chrom_access_recon_loss: 4539713.5625; val_global_loss: 19702620.0000; val_optim_loss: 19702620.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8981; val_auprc_score: 0.8572; val_best_acc_score: 0.8358; val_best_f1_score: 0.8474; train_kl_reg_loss: 94227.9276; train_edge_recon_loss: 2788952.8636; train_gene_expr_recon_loss: 12130803.4848; train_masked_gp_l1_reg_loss: 99930.0682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68773.4634; train_chrom_access_recon_loss: 4502852.9621; train_global_loss: 19685540.8485; train_optim_loss: 19685540.8485; val_kl_reg_loss: 93380.0166; val_edge_recon_loss: 2834515.4062; val_gene_expr_recon_loss: 12160108.1250; val_masked_gp_l1_reg_loss: 100603.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68174.9297; val_chrom_access_recon_loss: 4540616.0000; val_global_loss: 19797397.7500; val_optim_loss: 19797397.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8967; val_auprc_score: 0.8664; val_best_acc_score: 0.8305; val_best_f1_score: 0.8450; train_kl_reg_loss: 93711.6720; train_edge_recon_loss: 2782041.9848; train_gene_expr_recon_loss: 12093778.9242; train_masked_gp_l1_reg_loss: 101020.8737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67391.4458; train_chrom_access_recon_loss: 4492600.3636; train_global_loss: 19630545.3030; train_optim_loss: 19630545.3030; val_kl_reg_loss: 91909.7168; val_edge_recon_loss: 2839065.0938; val_gene_expr_recon_loss: 11875089.0000; val_masked_gp_l1_reg_loss: 101546.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67163.9688; val_chrom_access_recon_loss: 4477856.7500; val_global_loss: 19452631.5000; val_optim_loss: 19452631.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9079; val_auprc_score: 0.8765; val_best_acc_score: 0.8471; val_best_f1_score: 0.8583; train_kl_reg_loss: 90934.5339; train_edge_recon_loss: 2780337.3068; train_gene_expr_recon_loss: 12048777.0000; train_masked_gp_l1_reg_loss: 101974.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66271.6117; train_chrom_access_recon_loss: 4476430.2576; train_global_loss: 19564725.3333; train_optim_loss: 19564725.3333; val_kl_reg_loss: 89308.2744; val_edge_recon_loss: 2811582.4688; val_gene_expr_recon_loss: 11801752.8750; val_masked_gp_l1_reg_loss: 102425.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65771.8125; val_chrom_access_recon_loss: 4420860.7500; val_global_loss: 19291700.7500; val_optim_loss: 19291700.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9162; val_auprc_score: 0.8896; val_best_acc_score: 0.8503; val_best_f1_score: 0.8614; train_kl_reg_loss: 90193.5421; train_edge_recon_loss: 2776678.6402; train_gene_expr_recon_loss: 12020950.0000; train_masked_gp_l1_reg_loss: 102887.3622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65423.1367; train_chrom_access_recon_loss: 4466302.1591; train_global_loss: 19522434.8485; train_optim_loss: 19522434.8485; val_kl_reg_loss: 91464.9648; val_edge_recon_loss: 2802917.4062; val_gene_expr_recon_loss: 11910899.3750; val_masked_gp_l1_reg_loss: 103216.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65042.1562; val_chrom_access_recon_loss: 4420095.0000; val_global_loss: 19393636.0000; val_optim_loss: 19393636.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9122; val_auprc_score: 0.8815; val_best_acc_score: 0.8485; val_best_f1_score: 0.8576; train_kl_reg_loss: 89971.0440; train_edge_recon_loss: 2769469.7803; train_gene_expr_recon_loss: 11991893.1667; train_masked_gp_l1_reg_loss: 103638.1658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64875.8205; train_chrom_access_recon_loss: 4453602.3030; train_global_loss: 19473450.3333; train_optim_loss: 19473450.3333; val_kl_reg_loss: 89057.9131; val_edge_recon_loss: 2833435.1562; val_gene_expr_recon_loss: 11808340.2500; val_masked_gp_l1_reg_loss: 103832.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64754.2227; val_chrom_access_recon_loss: 4407570.7500; val_global_loss: 19306991.2500; val_optim_loss: 19306991.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9223; val_auprc_score: 0.8946; val_best_acc_score: 0.8608; val_best_f1_score: 0.8702; train_kl_reg_loss: 88371.6880; train_edge_recon_loss: 2765212.5303; train_gene_expr_recon_loss: 11954221.3182; train_masked_gp_l1_reg_loss: 104445.2601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64881.6908; train_chrom_access_recon_loss: 4438716.8220; train_global_loss: 19415849.3333; train_optim_loss: 19415849.3333; val_kl_reg_loss: 87223.4414; val_edge_recon_loss: 2777954.8125; val_gene_expr_recon_loss: 11880592.2500; val_masked_gp_l1_reg_loss: 105173.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65008.5742; val_chrom_access_recon_loss: 4441365.6875; val_global_loss: 19357318.0000; val_optim_loss: 19357318.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9211; val_auprc_score: 0.8951; val_best_acc_score: 0.8630; val_best_f1_score: 0.8694; train_kl_reg_loss: 89121.5685; train_edge_recon_loss: 2746774.3598; train_gene_expr_recon_loss: 11923307.2576; train_masked_gp_l1_reg_loss: 105122.0595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64565.7697; train_chrom_access_recon_loss: 4430237.5189; train_global_loss: 19359128.4848; train_optim_loss: 19359128.4848; val_kl_reg_loss: 89286.4619; val_edge_recon_loss: 2812382.2812; val_gene_expr_recon_loss: 11679367.2500; val_masked_gp_l1_reg_loss: 105489.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64517.4453; val_chrom_access_recon_loss: 4391769.1250; val_global_loss: 19142811.2500; val_optim_loss: 19142811.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9262; val_auprc_score: 0.9014; val_best_acc_score: 0.8670; val_best_f1_score: 0.8752; train_kl_reg_loss: 87644.9633; train_edge_recon_loss: 2747837.5947; train_gene_expr_recon_loss: 11896364.2273; train_masked_gp_l1_reg_loss: 105706.8853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64380.8796; train_chrom_access_recon_loss: 4419876.7652; train_global_loss: 19321811.4545; train_optim_loss: 19321811.4545; val_kl_reg_loss: 87296.4121; val_edge_recon_loss: 2764513.0625; val_gene_expr_recon_loss: 11755345.1250; val_masked_gp_l1_reg_loss: 106093.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64535.8906; val_chrom_access_recon_loss: 4391251.9375; val_global_loss: 19169035.5000; val_optim_loss: 19169035.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9358; val_auprc_score: 0.9150; val_best_acc_score: 0.8804; val_best_f1_score: 0.8872; train_kl_reg_loss: 86518.0762; train_edge_recon_loss: 2739180.1023; train_gene_expr_recon_loss: 11867872.3636; train_masked_gp_l1_reg_loss: 106281.4289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64260.4151; train_chrom_access_recon_loss: 4408663.6629; train_global_loss: 19272776.0909; train_optim_loss: 19272776.0909; val_kl_reg_loss: 86538.0156; val_edge_recon_loss: 2725779.7188; val_gene_expr_recon_loss: 11689213.8750; val_masked_gp_l1_reg_loss: 106661.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64155.8359; val_chrom_access_recon_loss: 4353006.6875; val_global_loss: 19025356.5000; val_optim_loss: 19025356.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9336; val_auprc_score: 0.9062; val_best_acc_score: 0.8726; val_best_f1_score: 0.8804; train_kl_reg_loss: 86917.0666; train_edge_recon_loss: 2741551.8068; train_gene_expr_recon_loss: 11834477.3788; train_masked_gp_l1_reg_loss: 106834.3936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63651.3194; train_chrom_access_recon_loss: 4396070.9167; train_global_loss: 19229502.7576; train_optim_loss: 19229502.7576; val_kl_reg_loss: 85104.6396; val_edge_recon_loss: 2778646.4062; val_gene_expr_recon_loss: 11681481.2500; val_masked_gp_l1_reg_loss: 107148.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63445.2070; val_chrom_access_recon_loss: 4374840.1875; val_global_loss: 19090665.0000; val_optim_loss: 19090665.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9296; val_auprc_score: 0.8990; val_best_acc_score: 0.8716; val_best_f1_score: 0.8770; train_kl_reg_loss: 84404.1699; train_edge_recon_loss: 2734074.0682; train_gene_expr_recon_loss: 11803379.2273; train_masked_gp_l1_reg_loss: 107286.8810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63430.7212; train_chrom_access_recon_loss: 4382791.0985; train_global_loss: 19175366.1212; train_optim_loss: 19175366.1212; val_kl_reg_loss: 84246.3359; val_edge_recon_loss: 2800164.0625; val_gene_expr_recon_loss: 11674502.3750; val_masked_gp_l1_reg_loss: 107668.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63131.0195; val_chrom_access_recon_loss: 4398401.2500; val_global_loss: 19128114.5000; val_optim_loss: 19128114.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9427; val_auprc_score: 0.9252; val_best_acc_score: 0.8823; val_best_f1_score: 0.8872; train_kl_reg_loss: 85631.6544; train_edge_recon_loss: 2734943.1970; train_gene_expr_recon_loss: 11786619.8485; train_masked_gp_l1_reg_loss: 107845.7243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62809.9879; train_chrom_access_recon_loss: 4375823.6364; train_global_loss: 19153673.9091; train_optim_loss: 19153673.9091; val_kl_reg_loss: 84455.4326; val_edge_recon_loss: 2756534.9062; val_gene_expr_recon_loss: 11736214.2500; val_masked_gp_l1_reg_loss: 108199.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63073.6523; val_chrom_access_recon_loss: 4369170.1875; val_global_loss: 19117649.0000; val_optim_loss: 19117649.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9426; val_auprc_score: 0.9227; val_best_acc_score: 0.8826; val_best_f1_score: 0.8877; train_kl_reg_loss: 84960.5481; train_edge_recon_loss: 2722189.8371; train_gene_expr_recon_loss: 11775442.7121; train_masked_gp_l1_reg_loss: 108474.4931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62721.5762; train_chrom_access_recon_loss: 4368508.5606; train_global_loss: 19122297.8182; train_optim_loss: 19122297.8182; val_kl_reg_loss: 83607.8652; val_edge_recon_loss: 2751558.9062; val_gene_expr_recon_loss: 11672067.2500; val_masked_gp_l1_reg_loss: 108586.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62484.3008; val_chrom_access_recon_loss: 4319508.3125; val_global_loss: 18997812.2500; val_optim_loss: 18997812.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9429; val_auprc_score: 0.9252; val_best_acc_score: 0.8826; val_best_f1_score: 0.8886; train_kl_reg_loss: 85828.0656; train_edge_recon_loss: 2713615.7955; train_gene_expr_recon_loss: 11741120.5909; train_masked_gp_l1_reg_loss: 108831.5863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62081.2908; train_chrom_access_recon_loss: 4358045.6742; train_global_loss: 19069522.9091; train_optim_loss: 19069522.9091; val_kl_reg_loss: 85557.2871; val_edge_recon_loss: 2755430.3125; val_gene_expr_recon_loss: 11487637.7500; val_masked_gp_l1_reg_loss: 109174.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62007.3789; val_chrom_access_recon_loss: 4299598.3125; val_global_loss: 18799405.5000; val_optim_loss: 18799405.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9438; val_auprc_score: 0.9262; val_best_acc_score: 0.8834; val_best_f1_score: 0.8905; train_kl_reg_loss: 104398.2152; train_edge_recon_loss: 2804754.7992; train_gene_expr_recon_loss: 11115354.1364; train_masked_gp_l1_reg_loss: 108954.9066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60402.9622; train_chrom_access_recon_loss: 4202208.2197; train_global_loss: 18396073.2727; train_optim_loss: 18396073.2727; val_kl_reg_loss: 42698.2471; val_edge_recon_loss: 2773759.1875; val_gene_expr_recon_loss: 11028602.8750; val_masked_gp_l1_reg_loss: 109064.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60754.0469; val_chrom_access_recon_loss: 4164696.1562; val_global_loss: 18179574.2500; val_optim_loss: 18179574.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9464; val_auprc_score: 0.9282; val_best_acc_score: 0.8874; val_best_f1_score: 0.8909; train_kl_reg_loss: 94736.7900; train_edge_recon_loss: 2746830.9659; train_gene_expr_recon_loss: 11062081.3333; train_masked_gp_l1_reg_loss: 108974.3581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60849.2633; train_chrom_access_recon_loss: 4157323.5795; train_global_loss: 18230796.3030; train_optim_loss: 18230796.3030; val_kl_reg_loss: 48311.4302; val_edge_recon_loss: 2780499.7188; val_gene_expr_recon_loss: 10904392.2500; val_masked_gp_l1_reg_loss: 109017.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61254.3320; val_chrom_access_recon_loss: 4126791.6562; val_global_loss: 18030266.5000; val_optim_loss: 18030266.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9390; val_auprc_score: 0.9107; val_best_acc_score: 0.8802; val_best_f1_score: 0.8858; train_kl_reg_loss: 84866.6703; train_edge_recon_loss: 2724633.7803; train_gene_expr_recon_loss: 11045900.4091; train_masked_gp_l1_reg_loss: 108637.5772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60906.8337; train_chrom_access_recon_loss: 4148696.3371; train_global_loss: 18173641.5455; train_optim_loss: 18173641.5455; val_kl_reg_loss: 53122.4600; val_edge_recon_loss: 2750460.6562; val_gene_expr_recon_loss: 10888304.3750; val_masked_gp_l1_reg_loss: 108412.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60892.7930; val_chrom_access_recon_loss: 4086594.7500; val_global_loss: 17947787.7500; val_optim_loss: 17947787.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9425; val_auprc_score: 0.9202; val_best_acc_score: 0.8869; val_best_f1_score: 0.8925; train_kl_reg_loss: 78105.0638; train_edge_recon_loss: 2721183.7500; train_gene_expr_recon_loss: 11027636.5758; train_masked_gp_l1_reg_loss: 108079.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60744.3761; train_chrom_access_recon_loss: 4142198.7462; train_global_loss: 18137948.4242; train_optim_loss: 18137948.4242; val_kl_reg_loss: 55636.0996; val_edge_recon_loss: 2747942.6875; val_gene_expr_recon_loss: 10794891.1250; val_masked_gp_l1_reg_loss: 107696.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60766.8359; val_chrom_access_recon_loss: 4080428.0000; val_global_loss: 17847361.6250; val_optim_loss: 17847361.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9460; val_auprc_score: 0.9277; val_best_acc_score: 0.8888; val_best_f1_score: 0.8950; train_kl_reg_loss: 75075.2588; train_edge_recon_loss: 2713938.5871; train_gene_expr_recon_loss: 10993875.1970; train_masked_gp_l1_reg_loss: 107295.8647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60341.3008; train_chrom_access_recon_loss: 4130620.5530; train_global_loss: 18081146.8182; train_optim_loss: 18081146.8182; val_kl_reg_loss: 58346.8022; val_edge_recon_loss: 2750264.5625; val_gene_expr_recon_loss: 10870742.2500; val_masked_gp_l1_reg_loss: 106861.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60061.4102; val_chrom_access_recon_loss: 4123949.3750; val_global_loss: 17970226.0000; val_optim_loss: 17970226.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9470; val_auprc_score: 0.9200; val_best_acc_score: 0.8984; val_best_f1_score: 0.9006; train_kl_reg_loss: 69987.2779; train_edge_recon_loss: 2713775.6515; train_gene_expr_recon_loss: 10985146.0455; train_masked_gp_l1_reg_loss: 106454.3013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59835.0937; train_chrom_access_recon_loss: 4128239.5341; train_global_loss: 18063438.0909; train_optim_loss: 18063438.0909; val_kl_reg_loss: 58342.4805; val_edge_recon_loss: 2733303.3125; val_gene_expr_recon_loss: 10850801.1250; val_masked_gp_l1_reg_loss: 106088.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59691.3203; val_chrom_access_recon_loss: 4086967.0938; val_global_loss: 17895194.0000; val_optim_loss: 17895194.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9472; val_auprc_score: 0.9264; val_best_acc_score: 0.8912; val_best_f1_score: 0.8950; train_kl_reg_loss: 70279.6941; train_edge_recon_loss: 2704233.6174; train_gene_expr_recon_loss: 10974937.1364; train_masked_gp_l1_reg_loss: 105860.7517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59296.4373; train_chrom_access_recon_loss: 4122519.5947; train_global_loss: 18037127.2121; train_optim_loss: 18037127.2121; val_kl_reg_loss: 62073.3926; val_edge_recon_loss: 2736549.4375; val_gene_expr_recon_loss: 10839638.3750; val_masked_gp_l1_reg_loss: 105513.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59029.2109; val_chrom_access_recon_loss: 4087872.2188; val_global_loss: 17890676.2500; val_optim_loss: 17890676.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9425; val_auprc_score: 0.9207; val_best_acc_score: 0.8866; val_best_f1_score: 0.8906; train_kl_reg_loss: 70144.4377; train_edge_recon_loss: 2704433.3977; train_gene_expr_recon_loss: 10954435.6212; train_masked_gp_l1_reg_loss: 105045.6122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58674.9262; train_chrom_access_recon_loss: 4117785.7652; train_global_loss: 18010519.7273; train_optim_loss: 18010519.7273; val_kl_reg_loss: 62667.6353; val_edge_recon_loss: 2755132.3750; val_gene_expr_recon_loss: 10834846.3750; val_masked_gp_l1_reg_loss: 104732.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58466.7500; val_chrom_access_recon_loss: 4087120.6250; val_global_loss: 17902967.2500; val_optim_loss: 17902967.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9396; val_auprc_score: 0.9147; val_best_acc_score: 0.8839; val_best_f1_score: 0.8890; train_kl_reg_loss: 69635.2675; train_edge_recon_loss: 2707708.4167; train_gene_expr_recon_loss: 10934743.3788; train_masked_gp_l1_reg_loss: 102965.7173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50774.8846; train_chrom_access_recon_loss: 4103519.0758; train_global_loss: 17969346.7879; train_optim_loss: 17969346.7879; val_kl_reg_loss: 62531.0117; val_edge_recon_loss: 2764855.5938; val_gene_expr_recon_loss: 10882450.6250; val_masked_gp_l1_reg_loss: 102318.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48945.7461; val_chrom_access_recon_loss: 4127978.8125; val_global_loss: 17989081.2500; val_optim_loss: 17989081.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9507; val_auprc_score: 0.9332; val_best_acc_score: 0.8949; val_best_f1_score: 0.8980; train_kl_reg_loss: 70177.5787; train_edge_recon_loss: 2703611.2197; train_gene_expr_recon_loss: 10930087.8182; train_masked_gp_l1_reg_loss: 102192.3441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48652.2190; train_chrom_access_recon_loss: 4101050.8144; train_global_loss: 17955771.9394; train_optim_loss: 17955771.9394; val_kl_reg_loss: 62863.3950; val_edge_recon_loss: 2715030.6562; val_gene_expr_recon_loss: 10832704.8750; val_masked_gp_l1_reg_loss: 102095.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48448.2422; val_chrom_access_recon_loss: 4088758.2812; val_global_loss: 17849901.2500; val_optim_loss: 17849901.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9461; val_auprc_score: 0.9268; val_best_acc_score: 0.8896; val_best_f1_score: 0.8946; train_kl_reg_loss: 71602.3175; train_edge_recon_loss: 2705398.9394; train_gene_expr_recon_loss: 10929610.3636; train_masked_gp_l1_reg_loss: 102033.2841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48249.8079; train_chrom_access_recon_loss: 4102703.3977; train_global_loss: 17959598.2121; train_optim_loss: 17959598.2121; val_kl_reg_loss: 64330.6572; val_edge_recon_loss: 2731872.9062; val_gene_expr_recon_loss: 10862691.1250; val_masked_gp_l1_reg_loss: 101978.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48131.7188; val_chrom_access_recon_loss: 4084448.0625; val_global_loss: 17893454.0000; val_optim_loss: 17893454.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9441; val_auprc_score: 0.9219; val_best_acc_score: 0.8896; val_best_f1_score: 0.8951; train_kl_reg_loss: 71889.0266; train_edge_recon_loss: 2695531.0644; train_gene_expr_recon_loss: 10914138.8485; train_masked_gp_l1_reg_loss: 101929.2634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48026.6576; train_chrom_access_recon_loss: 4098465.5833; train_global_loss: 17929980.6970; train_optim_loss: 17929980.6970; val_kl_reg_loss: 64337.1870; val_edge_recon_loss: 2723852.0000; val_gene_expr_recon_loss: 10790308.3750; val_masked_gp_l1_reg_loss: 101898.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47900.5508; val_chrom_access_recon_loss: 4088252.8438; val_global_loss: 17816550.7500; val_optim_loss: 17816550.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9453; val_auprc_score: 0.9216; val_best_acc_score: 0.8928; val_best_f1_score: 0.8971; train_kl_reg_loss: 71281.1225; train_edge_recon_loss: 2698023.8106; train_gene_expr_recon_loss: 10920384.7121; train_masked_gp_l1_reg_loss: 101869.9478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47828.4131; train_chrom_access_recon_loss: 4101556.3902; train_global_loss: 17940944.3636; train_optim_loss: 17940944.3636; val_kl_reg_loss: 64121.1235; val_edge_recon_loss: 2750817.0312; val_gene_expr_recon_loss: 10863155.3750; val_masked_gp_l1_reg_loss: 101838.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47754.6406; val_chrom_access_recon_loss: 4133442.7188; val_global_loss: 17961129.2500; val_optim_loss: 17961129.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9452; val_auprc_score: 0.9179; val_best_acc_score: 0.8933; val_best_f1_score: 0.8971; train_kl_reg_loss: 71448.6078; train_edge_recon_loss: 2696705.5985; train_gene_expr_recon_loss: 10912712.5000; train_masked_gp_l1_reg_loss: 101800.6384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47638.6123; train_chrom_access_recon_loss: 4100732.8826; train_global_loss: 17931038.8788; train_optim_loss: 17931038.8788; val_kl_reg_loss: 64776.4043; val_edge_recon_loss: 2734352.1875; val_gene_expr_recon_loss: 10676386.5000; val_masked_gp_l1_reg_loss: 101754.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47534.1055; val_chrom_access_recon_loss: 4078709.4688; val_global_loss: 17703512.5000; val_optim_loss: 17703512.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9464; val_auprc_score: 0.9217; val_best_acc_score: 0.8928; val_best_f1_score: 0.8981; train_kl_reg_loss: 72001.5497; train_edge_recon_loss: 2695799.0720; train_gene_expr_recon_loss: 10911493.8485; train_masked_gp_l1_reg_loss: 101725.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47447.5466; train_chrom_access_recon_loss: 4096548.8258; train_global_loss: 17925016.3939; train_optim_loss: 17925016.3939; val_kl_reg_loss: 64607.2217; val_edge_recon_loss: 2719825.8438; val_gene_expr_recon_loss: 10734738.1250; val_masked_gp_l1_reg_loss: 101683.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47366.9531; val_chrom_access_recon_loss: 4061841.3438; val_global_loss: 17730062.7500; val_optim_loss: 17730062.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9472; val_auprc_score: 0.9274; val_best_acc_score: 0.8915; val_best_f1_score: 0.8946; train_kl_reg_loss: 72164.1842; train_edge_recon_loss: 2698481.2652; train_gene_expr_recon_loss: 10906907.7576; train_masked_gp_l1_reg_loss: 101650.1310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47308.9872; train_chrom_access_recon_loss: 4094301.6780; train_global_loss: 17920814.0909; train_optim_loss: 17920814.0909; val_kl_reg_loss: 65382.3369; val_edge_recon_loss: 2749123.6250; val_gene_expr_recon_loss: 10726719.6250; val_masked_gp_l1_reg_loss: 101586.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47197.7773; val_chrom_access_recon_loss: 4029998.7812; val_global_loss: 17720009.2500; val_optim_loss: 17720009.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9489; val_auprc_score: 0.9314; val_best_acc_score: 0.8955; val_best_f1_score: 0.8987; train_kl_reg_loss: 72053.9612; train_edge_recon_loss: 2691587.6023; train_gene_expr_recon_loss: 10913026.3030; train_masked_gp_l1_reg_loss: 101542.7404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47147.3314; train_chrom_access_recon_loss: 4094349.3030; train_global_loss: 17919707.3030; train_optim_loss: 17919707.3030; val_kl_reg_loss: 65276.0640; val_edge_recon_loss: 2721596.6875; val_gene_expr_recon_loss: 10743286.6250; val_masked_gp_l1_reg_loss: 101504.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47076.7227; val_chrom_access_recon_loss: 4077859.3438; val_global_loss: 17756600.0000; val_optim_loss: 17756600.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9474; val_auprc_score: 0.9200; val_best_acc_score: 0.8955; val_best_f1_score: 0.9003; train_kl_reg_loss: 71908.6765; train_edge_recon_loss: 2696135.4015; train_gene_expr_recon_loss: 10907743.1818; train_masked_gp_l1_reg_loss: 101471.0869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46971.2725; train_chrom_access_recon_loss: 4097035.7917; train_global_loss: 17921265.5455; train_optim_loss: 17921265.5455; val_kl_reg_loss: 65388.9302; val_edge_recon_loss: 2729884.1875; val_gene_expr_recon_loss: 10741478.6250; val_masked_gp_l1_reg_loss: 101418.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46876.0859; val_chrom_access_recon_loss: 4073160.2812; val_global_loss: 17758207.0000; val_optim_loss: 17758207.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9490; val_auprc_score: 0.9251; val_best_acc_score: 0.8971; val_best_f1_score: 0.9006; train_kl_reg_loss: 71632.7951; train_edge_recon_loss: 2693124.1250; train_gene_expr_recon_loss: 10897732.3182; train_masked_gp_l1_reg_loss: 101241.6430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46072.1887; train_chrom_access_recon_loss: 4095013.5720; train_global_loss: 17904816.4848; train_optim_loss: 17904816.4848; val_kl_reg_loss: 65344.8315; val_edge_recon_loss: 2742776.4062; val_gene_expr_recon_loss: 10717725.6250; val_masked_gp_l1_reg_loss: 101170.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45887.1602; val_chrom_access_recon_loss: 4060972.1562; val_global_loss: 17733877.5000; val_optim_loss: 17733877.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9466; val_auprc_score: 0.9243; val_best_acc_score: 0.8995; val_best_f1_score: 0.9029; train_kl_reg_loss: 71697.4361; train_edge_recon_loss: 2699732.1591; train_gene_expr_recon_loss: 10898860.4545; train_masked_gp_l1_reg_loss: 101151.2615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45852.0630; train_chrom_access_recon_loss: 4093747.9848; train_global_loss: 17911041.3636; train_optim_loss: 17911041.3636; val_kl_reg_loss: 66033.2222; val_edge_recon_loss: 2739364.1875; val_gene_expr_recon_loss: 10790905.5000; val_masked_gp_l1_reg_loss: 101133.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45820.4102; val_chrom_access_recon_loss: 4114331.1875; val_global_loss: 17857587.0000; val_optim_loss: 17857587.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9473; val_auprc_score: 0.9296; val_best_acc_score: 0.8909; val_best_f1_score: 0.8928; train_kl_reg_loss: 71744.9885; train_edge_recon_loss: 2699347.9621; train_gene_expr_recon_loss: 10911622.1212; train_masked_gp_l1_reg_loss: 101122.0728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45799.2998; train_chrom_access_recon_loss: 4100996.1818; train_global_loss: 17930632.6970; train_optim_loss: 17930632.6970; val_kl_reg_loss: 66244.2202; val_edge_recon_loss: 2742724.7812; val_gene_expr_recon_loss: 10817333.1250; val_masked_gp_l1_reg_loss: 101113.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45775.6523; val_chrom_access_recon_loss: 4117871.5312; val_global_loss: 17891063.0000; val_optim_loss: 17891063.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9513; val_auprc_score: 0.9308; val_best_acc_score: 0.8976; val_best_f1_score: 0.9013; train_kl_reg_loss: 71860.9210; train_edge_recon_loss: 2688602.6818; train_gene_expr_recon_loss: 10901131.3636; train_masked_gp_l1_reg_loss: 101106.9053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45761.1038; train_chrom_access_recon_loss: 4095810.2652; train_global_loss: 17904273.1212; train_optim_loss: 17904273.1212; val_kl_reg_loss: 65377.5688; val_edge_recon_loss: 2712112.4062; val_gene_expr_recon_loss: 10789757.6250; val_masked_gp_l1_reg_loss: 101100.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45745.3477; val_chrom_access_recon_loss: 4061374.3438; val_global_loss: 17775466.7500; val_optim_loss: 17775466.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 52 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9510
val AUPRC score: 0.9309
val best accuracy score: 0.8979
val best F1 score: 0.9001
val target rna MSE score: 1.5041
val source rna MSE score: 0.7834
val target atac MSE score: 0.4746
val source atac MSE score: 0.1973
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
